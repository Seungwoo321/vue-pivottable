"use strict";var Ig=Object.defineProperty,Og=Object.defineProperties;var Dg=Object.getOwnPropertyDescriptors;var xd=Object.getOwnPropertySymbols;var zg=Object.prototype.hasOwnProperty,Rg=Object.prototype.propertyIsEnumerable;var bd=(et,$e,r)=>$e in et?Ig(et,$e,{enumerable:!0,configurable:!0,writable:!0,value:r}):et[$e]=r,ul=(et,$e)=>{for(var r in $e||($e={}))zg.call($e,r)&&bd(et,r,$e[r]);if(xd)for(var r of xd($e))Rg.call($e,r)&&bd(et,r,$e[r]);return et},gf=(et,$e)=>Og(et,Dg($e));Object.defineProperty(exports,"__esModule",{value:!0});exports[Symbol.toStringTag]="Module";const Fg=function(et,$e,r){const O=String(et).split(".");let B=O[0];const t=O.length>1?r+O[1]:"",d=/(\d+)(\d{3})/;for(;d.test(B);)B=B.replace(d,`$1${$e}$2`);return B+t},mf=function(et){const r=Object.assign({},{digitsAfterDecimal:2,scaler:1,thousandsSep:",",decimalSep:".",prefix:"",suffix:""},et);return function(O){if(isNaN(O)||!isFinite(O))return"";const B=Fg((r.scaler*O).toFixed(r.digitsAfterDecimal),r.thousandsSep,r.decimalSep);return`${r.prefix}${B}${r.suffix}`}},_d=/(\d+)|(\D+)/g,vf=/\d/,wd=/^0/,su=(et,$e)=>{if($e!==null&&et===null)return-1;if(et!==null&&$e===null)return 1;if(typeof et=="number"&&isNaN(et))return-1;if(typeof $e=="number"&&isNaN($e))return 1;const r=Number(et),O=Number($e);if(r<O)return-1;if(r>O)return 1;if(typeof et=="number"&&typeof $e!="number")return-1;if(typeof $e=="number"&&typeof et!="number")return 1;if(typeof et=="number"&&typeof $e=="number")return 0;if(isNaN(O)&&!isNaN(r))return-1;if(isNaN(r)&&!isNaN(O))return 1;let B=String(et),t=String($e);if(B===t)return 0;if(!vf.test(B)||!vf.test(t))return B>t?1:-1;for(B=B.match(_d),t=t.match(_d);B.length&&t.length;){const d=B.shift(),m=t.shift();if(d!==m)return vf.test(d)&&vf.test(m)?d.replace(wd,".0")-m.replace(wd,".0"):d>m?1:-1}return B.length-t.length},Td=function(et){const $e={},r={};for(const O in et){const B=et[O];$e[B]=O,typeof B=="string"&&(r[B.toLowerCase()]=O)}return function(O,B){return O in $e&&B in $e?$e[O]-$e[B]:O in $e?-1:B in $e?1:O in r&&B in r?r[O]-r[B]:O in r?-1:B in r?1:su(O,B)}},yf=function(et,$e){if(et){if(typeof et=="function"){const r=et($e);if(typeof r=="function")return r}else if($e in et)return et[$e]}return su},ks=mf(),gc=mf({digitsAfterDecimal:0}),lu=mf({digitsAfterDecimal:1,scaler:100,suffix:"%"}),bo={count(et=gc){return()=>function(){return{count:0,push(){this.count++},value(){return this.count},format:et}}},uniques(et,$e=gc){return function([r]){return function(){return{uniq:[],push(O){Array.from(this.uniq).includes(O[r])||this.uniq.push(O[r])},value(){return et(this.uniq)},format:$e,numInputs:typeof r!="undefined"?0:1}}}},sum(et=ks){return function([$e]){return function(){return{sum:0,push(r){isNaN(parseFloat(r[$e]))||(this.sum+=parseFloat(r[$e]))},value(){return this.sum},format:et,numInputs:typeof $e!="undefined"?0:1}}}},extremes(et,$e=ks){return function([r]){return function(O){return{val:null,sorter:yf(typeof O!="undefined"?O.sorters:null,r),push(B){let t=B[r];["min","max"].includes(et)&&(t=parseFloat(t),isNaN(t)||(this.val=Math[et](t,this.val!==null?this.val:t))),et==="first"&&this.sorter(t,this.val!==null?this.val:t)<=0&&(this.val=t),et==="last"&&this.sorter(t,this.val!==null?this.val:t)>=0&&(this.val=t)},value(){return this.val},format(B){return isNaN(B)?B:$e(B)},numInputs:typeof r!="undefined"?0:1}}}},quantile(et,$e=ks){return function([r]){return function(){return{vals:[],push(O){const B=parseFloat(O[r]);isNaN(B)||this.vals.push(B)},value(){if(this.vals.length===0)return null;this.vals.sort((B,t)=>B-t);const O=(this.vals.length-1)*et;return(this.vals[Math.floor(O)]+this.vals[Math.ceil(O)])/2},format:$e,numInputs:typeof r!="undefined"?0:1}}}},runningStat(et="mean",$e=1,r=ks){return function([O]){return function(){return{n:0,m:0,s:0,push(B){const t=parseFloat(B[O]);if(isNaN(t))return;this.n+=1,this.n===1&&(this.m=t);const d=this.m+(t-this.m)/this.n;this.s=this.s+(t-this.m)*(t-d),this.m=d},value(){if(et==="mean")return this.n===0?0/0:this.m;if(this.n<=$e)return 0;switch(et){case"var":return this.s/(this.n-$e);case"stdev":return Math.sqrt(this.s/(this.n-$e));default:throw new Error("unknown mode for runningStat")}},format:r,numInputs:typeof O!="undefined"?0:1}}}},sumOverSum(et=ks){return function([$e,r]){return function(){return{sumNum:0,sumDenom:0,push(O){isNaN(parseFloat(O[$e]))||(this.sumNum+=parseFloat(O[$e])),isNaN(parseFloat(O[r]))||(this.sumDenom+=parseFloat(O[r]))},value(){return this.sumNum/this.sumDenom},format:et,numInputs:typeof $e!="undefined"&&typeof r!="undefined"?0:2}}}},fractionOf(et,$e="total",r=lu){return(...O)=>function(B,t,d){return{selector:{total:[[],[]],row:[t,[]],col:[[],d]}[$e],inner:et(...Array.from(O||[]))(B,t,d),push(m){this.inner.push(m)},format:r,value(){return this.inner.value()/B.getAggregator(...Array.from(this.selector||[])).inner.value()},numInputs:et(...Array.from(O||[]))().numInputs}}}};bo.countUnique=et=>bo.uniques($e=>$e.length,et);bo.listUnique=et=>bo.uniques($e=>$e.join(et),$e=>$e);bo.max=et=>bo.extremes("max",et);bo.min=et=>bo.extremes("min",et);bo.first=et=>bo.extremes("first",et);bo.last=et=>bo.extremes("last",et);bo.median=et=>bo.quantile(.5,et);bo.average=et=>bo.runningStat("mean",1,et);bo.var=(et,$e)=>bo.runningStat("var",et,$e);bo.stdev=(et,$e)=>bo.runningStat("stdev",et,$e);const uu=(et=>({Count:et.count(gc),"Count Unique Values":et.countUnique(gc),"List Unique Values":et.listUnique(", "),Sum:et.sum(ks),"Integer Sum":et.sum(gc),Average:et.average(ks),Median:et.median(ks),"Sample Variance":et.var(1,ks),"Sample Standard Deviation":et.stdev(1,ks),Minimum:et.min(ks),Maximum:et.max(ks),First:et.first(ks),Last:et.last(ks),"Sum over Sum":et.sumOverSum(ks),"Sum as Fraction of Total":et.fractionOf(et.sum(),"total",lu),"Sum as Fraction of Rows":et.fractionOf(et.sum(),"row",lu),"Sum as Fraction of Columns":et.fractionOf(et.sum(),"col",lu),"Count as Fraction of Total":et.fractionOf(et.count(),"total",lu),"Count as Fraction of Rows":et.fractionOf(et.count(),"row",lu),"Count as Fraction of Columns":et.fractionOf(et.count(),"col",lu)}))(bo),Bg={en:{aggregators:uu,localeStrings:{renderError:"An error occurred rendering the PivotTable results.",computeError:"An error occurred computing the PivotTable results.",uiRenderError:"An error occurred rendering the PivotTable UI.",selectAll:"Select All",selectNone:"Select None",tooMany:"(too many to list)",filterResults:"Filter values",apply:"Apply",cancel:"Cancel",totals:"Totals",vs:"vs",by:"by"}}},Ng=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],jg=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],mc=et=>`0${et}`.substr(-2,2),Ug={bin(et,$e){return r=>r[et]-r[et]%$e},dateFormat(et,$e,r=!1,O=Ng,B=jg){const t=r?"UTC":"";return function(d){const m=new Date(Date.parse(d[et]));return isNaN(m)?"":$e.replace(/%(.)/g,function(p,e){switch(e){case"y":return m[`get${t}FullYear`]();case"m":return mc(m[`get${t}Month`]()+1);case"n":return O[m[`get${t}Month`]()];case"d":return mc(m[`get${t}Date`]());case"w":return B[m[`get${t}Day`]()];case"x":return m[`get${t}Day`]();case"H":return mc(m[`get${t}Hours`]());case"M":return mc(m[`get${t}Minutes`]());case"S":return mc(m[`get${t}Seconds`]());default:return`%${e}`}})}}};class Ps{constructor($e={}){this.props=Object.assign({},Ps.defaultProps,$e),this.aggregator=this.props.aggregators[this.props.aggregatorName](this.props.vals),this.tree={},this.rowKeys=[],this.colKeys=[],this.rowTotals={},this.colTotals={},this.allTotal=this.aggregator(this,[],[]),this.sorted=!1,this.filteredData=[],Ps.forEachRecord(this.props.data,this.props.derivedAttributes,r=>{this.filter(r)&&(this.filteredData.push(r),this.processRecord(r))})}filter($e){for(const r in this.props.valueFilter)if($e[r]in this.props.valueFilter[r])return!1;return!0}forEachMatchingRecord($e,r){return Ps.forEachRecord(this.props.data,this.props.derivedAttributes,O=>{if(!!this.filter(O)){for(const B in $e)if($e[B]!==(B in O?O[B]:"null"))return;r(O)}})}arrSort($e){let r;const O=(()=>{const B=[];for(r of Array.from($e))B.push(yf(this.props.sorters,r));return B})();return function(B,t){for(const d of Object.keys(O||{})){const p=O[d](B[d],t[d]);if(p!==0)return p}return 0}}sortKeys(){if(!this.sorted){this.sorted=!0;const $e=(r,O)=>this.getAggregator(r,O).value();switch(this.props.rowOrder){case"value_a_to_z":this.rowKeys.sort((r,O)=>su($e(r,[]),$e(O,[])));break;case"value_z_to_a":this.rowKeys.sort((r,O)=>-su($e(r,[]),$e(O,[])));break;default:this.rowKeys.sort(this.arrSort(this.props.rows))}switch(this.props.colOrder){case"value_a_to_z":this.colKeys.sort((r,O)=>su($e([],r),$e([],O)));break;case"value_z_to_a":this.colKeys.sort((r,O)=>-su($e([],r),$e([],O)));break;default:this.colKeys.sort(this.arrSort(this.props.cols))}}}getFilteredData(){return this.filteredData}getColKeys(){return this.sortKeys(),this.colKeys}getRowKeys(){return this.sortKeys(),this.rowKeys}processRecord($e){const r=[],O=[];for(const d of Array.from(this.props.cols))r.push(d in $e?$e[d]:"null");for(const d of Array.from(this.props.rows))O.push(d in $e?$e[d]:"null");const B=O.join(String.fromCharCode(0)),t=r.join(String.fromCharCode(0));this.allTotal.push($e),O.length!==0&&(this.rowTotals[B]||(this.rowKeys.push(O),this.rowTotals[B]=this.aggregator(this,O,[])),this.rowTotals[B].push($e)),r.length!==0&&(this.colTotals[t]||(this.colKeys.push(r),this.colTotals[t]=this.aggregator(this,[],r)),this.colTotals[t].push($e)),r.length!==0&&O.length!==0&&(this.tree[B]||(this.tree[B]={}),this.tree[B][t]||(this.tree[B][t]=this.aggregator(this,O,r)),this.tree[B][t].push($e))}getAggregator($e,r){let O;const B=$e.join(String.fromCharCode(0)),t=r.join(String.fromCharCode(0));return $e.length===0&&r.length===0?O=this.allTotal:$e.length===0?O=this.colTotals[t]:r.length===0?O=this.rowTotals[B]:O=this.tree[B][t],O||{value(){return null},format(){return""}}}}Ps.forEachRecord=function(et,$e,r){let O,B;if(Object.getOwnPropertyNames($e).length===0?O=r:O=function(t){for(const d in $e){const m=$e[d](t);m!==null&&(t[d]=m)}return r(t)},typeof et=="function")return et(O);if(Array.isArray(et))return Array.isArray(et[0])?(()=>{const t=[];for(const d of Object.keys(et||{})){const m=et[d];if(d>0){B={};for(const p of Object.keys(et[0]||{})){const e=et[0][p];B[e]=m[p]}t.push(O(B))}}return t})():(()=>{const t=[];for(B of Array.from(et))t.push(O(B));return t})();throw new Error("unknown input format")};Ps.defaultProps={aggregators:uu,cols:[],rows:[],vals:[],aggregatorName:"Count",sorters:{},valueFilter:{},rowOrder:"key_a_to_z",colOrder:"key_a_to_z",derivedAttributes:{}};var Uu={props:{data:{type:[Array,Object,Function],required:!0},aggregators:{type:Object,default:function(){return uu}},aggregatorName:String,cols:{type:Array,default:function(){return[]}},heatmapMode:String,tableColorScaleGenerator:{type:Function},tableOptions:{type:Object,default:function(){return{}}},renderers:Function,rendererName:{type:String,default:"Table"},rowTotal:{type:Boolean,default:!0},colTotal:{type:Boolean,default:!0},rows:{type:Array,default:function(){return[]}},vals:{type:Array,default:function(){return[]}},attributes:{type:Array,default:function(){return[]}},valueFilter:{type:Object,default:function(){return{}}},sorters:{type:[Function,Object],default:function(){return{}}},derivedAttributes:{type:[Function,Object],default:function(){return{}}},rowOrder:{type:String,default:"key_a_to_z",validator:function(et){return["key_a_to_z","value_a_to_z","value_z_to_a"].indexOf(et)!==-1}},colOrder:{type:String,default:"key_a_to_z",validator:function(et){return["key_a_to_z","value_a_to_z","value_z_to_a"].indexOf(et)!==-1}},tableMaxWidth:{type:Number,default:0,validator:function(et){return et>=0}}}};function Vg(et){const $e=Math.min.apply(Math,et),r=Math.max.apply(Math,et);return O=>{const B=255-Math.round(255*(O-$e)/(r-$e));return{backgroundColor:`rgb(255,${B},${B})`}}}function xf(et={}){return{name:et.name,mixins:[Uu],props:{heatmapMode:String,tableColorScaleGenerator:{type:Function,default:Vg},tableOptions:{type:Object,default:function(){return{}}}},methods:{spanSize(r,O,B){let t;if(O!==0){let m,p,e=!0;for(t=0,p=B,m=p>=0;m?t<=p:t>=p;m?t++:t--)r[O-1][t]!==r[O][t]&&(e=!1);if(e)return-1}let d=0;for(;O+d<r.length;){let m,p,e=!1;for(t=0,p=B,m=p>=0;m?t<=p:t>=p;m?t++:t--)r[O][t]!==r[O+d][t]&&(e=!0);if(e)break;d++}return d}},render(r){const O=new Ps(this.$props),B=O.props.cols,t=O.props.rows,d=O.getRowKeys(),m=O.getColKeys(),p=O.getAggregator([],[]);let e=()=>{},f=()=>{},u=()=>{};if(et.heatmapMode){const l=this.tableColorScaleGenerator,o=m.map(c=>O.getAggregator([],c).value());f=l(o);const i=d.map(c=>O.getAggregator(c,[]).value());if(u=l(i),et.heatmapMode==="full"){const c=[];d.map(a=>m.map(g=>c.push(O.getAggregator(a,g).value())));const n=l(c);e=(a,g,h)=>n(h)}else if(et.heatmapMode==="row"){const c={};d.map(n=>{const a=m.map(g=>O.getAggregator(n,g).value());c[n]=l(a)}),e=(n,a,g)=>c[n](g)}else if(et.heatmapMode==="col"){const c={};m.map(n=>{const a=d.map(g=>O.getAggregator(g,n).value());c[n]=l(a)}),e=(n,a,g)=>c[a](g)}}const s=this.tableOptions&&this.tableOptions.clickCallback?(l,o,i)=>{const c={};for(const n of Object.keys(B||{})){const a=B[n];i[n]!==null&&(c[a]=i[n])}for(const n of Object.keys(t||{})){const a=t[n];o[n]!==null&&(c[a]=o[n])}return n=>this.tableOptions.clickCallback(n,l,c,O)}:null;return r("table",{staticClass:["pvtTable"]},[r("thead",[B.map((l,o)=>r("tr",{attrs:{key:`colAttrs${o}`}},[o===0&&t.length!==0?r("th",{attrs:{colSpan:t.length,rowSpan:B.length}}):void 0,r("th",{staticClass:["pvtAxisLabel"]},l),m.map((i,c)=>{const n=this.spanSize(m,c,o);return n===-1?null:r("th",{staticClass:["pvtColLabel"],attrs:{key:`colKey${c}`,colSpan:n,rowSpan:o===B.length-1&&t.length!==0?2:1}},i[o])}),o===0&&this.rowTotal?r("th",{staticClass:["pvtTotalLabel"],attrs:{rowSpan:B.length+(t.length===0?0:1)}},"Totals"):void 0])),t.length!==0?r("tr",[t.map((l,o)=>r("th",{staticClass:["pvtAxisLabel"],attrs:{key:`rowAttr${o}`}},l)),this.rowTotal?r("th",{staticClass:["pvtTotalLabel"]},B.length===0?"Totals":null):B.length===0?void 0:r("th",{staticClass:["pvtTotalLabel"]},null)]):void 0]),r("tbody",[d.map((l,o)=>{const i=O.getAggregator(l,[]);return r("tr",{attrs:{key:`rowKeyRow${o}`}},[l.map((c,n)=>{const a=this.spanSize(d,o,n);return a===-1?null:r("th",{staticClass:["pvtRowLabel"],attrs:{key:`rowKeyLabel${o}-${n}`,rowSpan:a,colSpan:n===t.length-1&&B.length!==0?2:1}},c)}),m.map((c,n)=>{const a=O.getAggregator(l,c);return r("td",{staticClass:["pvVal"],style:e(l,c,a.value()),attrs:{key:`pvtVal${o}-${n}`},on:s?{click:s(a.value(),l,c)}:{}},a.format(a.value()))}),this.rowTotal?r("td",{staticClass:["pvtTotal"],style:u(i.value()),on:s?{click:s(i.value(),l,[null])}:{}},i.format(i.value())):void 0])}),r("tr",[this.colTotal?r("th",{staticClass:["pvtTotalLabel"],attrs:{colSpan:t.length+(B.length===0?0:1)}},"Totals"):void 0,this.colTotal?m.map((l,o)=>{const i=O.getAggregator([],l);return r("td",{staticClass:["pvtTotal"],style:f(i.value()),attrs:{key:`total${o}`},on:s?{click:s(i.value(),[null],l)}:{}},i.format(i.value()))}):void 0,this.colTotal&&this.rowTotal?r("td",{staticClass:["pvtGrandTotal"],on:s?{click:s(p.value(),[null],[null])}:{}},p.format(p.value())):void 0])])])}}}const Hg={name:"tsv-export-renderers",mixins:[Uu],render(et){const $e=new Ps(this.$props),r=$e.getRowKeys(),O=$e.getColKeys();r.length===0&&r.push([]),O.length===0&&O.push([]);const B=$e.props.rows.map(d=>d);O.length===1&&O[0].length===0?B.push(this.aggregatorName):O.map(d=>B.push(d.join("-")));const t=r.map(d=>{const m=d.map(p=>p);return O.map(p=>{const e=$e.getAggregator(d,p).value();m.push(e||"")}),m});return t.unshift(B),et("textarea",{style:{width:"100%",height:`${window.innerHeight/2}px`},attrs:{readOnly:!0},domProps:{value:t.map(d=>d.join("	")).join(`
`)}})}};var bf={Table:xf({name:"vue-table"}),"Table Heatmap":xf({heatmapMode:"full",name:"vue-table-heatmap"}),"Table Col Heatmap":xf({heatmapMode:"col",name:"vue-table-col-heatmap"}),"Table Row Heatmap":xf({heatmapMode:"row",name:"vue-table-col-heatmap"}),"Expor Table TSV":Hg},_f={name:"vue-pivottable",mixins:[Uu],computed:{defaultRenderers(){return bf[this.rendererName in bf?this.rendererName:Object.keys(bf)[0]]}},methods:{createPivottable(et){const $e=this.$props;return et(this.renderers||this.defaultRenderers,{props:$e})},createWrapperContainer(et){return et("div",{style:{display:"block","overflow-x":"auto","max-width":`${this.tableMaxWidth}px`}},[this.createPivottable(et)])}},render(et){return this.tableMaxWidth>0?this.createWrapperContainer(et):this.createPivottable(et)}},Gg={name:"draggable-attribute",props:{open:{type:Boolean,default:!1},sortable:{type:Boolean,default:!0},draggable:{type:Boolean,default:!0},name:{type:String,required:!0},attrValues:{type:Object,required:!1},valueFilter:{type:Object,default:function(){return{}}},sorter:{type:Function,required:!0},menuLimit:Number,zIndex:Number,unused:Boolean},data(){return{filterText:"",attribute:"",values:[],filter:{}}},computed:{disabled(){return!this.sortable&&!this.draggable},sortonly(){return this.sortable&&!this.draggable}},methods:{setValuesInFilter(et,$e){const r=$e.reduce((O,B)=>(O[B]=!0,O),{});this.$emit("update:filter",{attribute:et,valueFilter:r})},addValuesToFilter(et,$e){const r=$e.reduce((O,B)=>(O[B]=!0,O),ul({},this.valueFilter));this.$emit("update:filter",{attribute:et,valueFilter:r})},removeValuesFromFilter(et,$e){const r=$e.reduce((O,B)=>(O[B]&&delete O[B],O),ul({},this.valueFilter));this.$emit("update:filter",{attribute:et,valueFilter:r})},moveFilterBoxToTop(et){this.$emit("moveToTop:filterbox",{attribute:et})},toggleValue(et){et in this.valueFilter?this.removeValuesFromFilter(this.name,[et]):this.addValuesToFilter(this.name,[et])},matchesFilter(et){return et.toLowerCase().trim().includes(this.filterText.toLowerCase().trim())},selectOnly(et,$e){et.stopPropagation(),this.value=$e,this.setValuesInFilter(this.name,Object.keys(this.attrValues).filter(r=>r!==$e))},getFilterBox(et){const $e=Object.keys(this.attrValues).length<this.menuLimit,r=Object.keys(this.attrValues),O=r.filter(this.matchesFilter.bind(this)).sort(this.sorter);return et("div",{staticClass:["pvtFilterBox"],style:{display:"block",cursor:"initial",zIndex:this.zIndex},on:{click:()=>this.moveFilterBoxToTop(this.name)}},[et("div",{staticClass:"pvtSearchContainer"},[$e||et("p","too many values to show"),$e&&et("input",{staticClass:["pvtSearch"],attrs:{type:"text",placeholder:"Filter Values"},domProps:{value:this.filterText},on:{input:B=>{this.filterText=B.target.value,this.$emit("input",B.target.value)}}}),et("a",{staticClass:["pvtFilterTextClear"],on:{click:()=>{this.filterText=""}}}),et("a",{staticClass:["pvtButton"],attrs:{role:"button"},on:{click:()=>this.removeValuesFromFilter(this.name,Object.keys(this.attrValues).filter(this.matchesFilter.bind(this)))}},`Select ${r.length===O.length?"All":O.length}`),et("a",{staticClass:["pvtButton"],attrs:{role:"button"},on:{click:()=>this.addValuesToFilter(this.name,Object.keys(this.attrValues).filter(this.matchesFilter.bind(this)))}},`Deselect ${r.length===O.length?"All":O.length}`)]),$e&&et("div",{staticClass:["pvtCheckContainer"]},[...O.map(B=>{const t=!(B in this.valueFilter);return et("p",{class:{selected:t},attrs:{key:B},on:{click:()=>this.toggleValue(B)}},[et("input",{attrs:{type:"checkbox"},domProps:{checked:t}}),B,et("a",{staticClass:["pvtOnly"],on:{click:d=>this.selectOnly(d,B)}},"only"),et("a",{staticClass:["pvtOnlySpacer"]})])})])])},toggleFilterBox(){this.openFilterBox(this.name,!this.open),this.moveFilterBoxToTop(this.name)},openFilterBox(et,$e){this.$emit("open:filterbox",{attribute:et,open:$e})}},render(et){const $e=Object.keys(this.valueFilter).length!==0?"pvtFilteredAttribute":"",r=this.$scopedSlots.pvtAttr;return et("li",{attrs:{"data-id":this.disabled?void 0:this.name}},[et("span",{staticClass:["pvtAttr "+$e],class:{sortonly:this.sortonly,disabled:this.disabled}},[r?r({name:this.name}):this.name,!this.disabled&&!this.unused?et("span",{staticClass:["pvtTriangle"],on:{click:this.toggleFilterBox.bind(this)}},"  \u25BE"):void 0,this.open?this.getFilterBox(et):void 0])])}},Ah={props:["values","changeValue"],methods:{handleChange(et){const $e=et.target.value;this.$emit("input",$e)}},render(et){return et("select",{staticClass:["pvtDropdown"],attrs:{value:this.value},on:{change:this.handleChange}},[this.values.map($e=>et("option",{attrs:{value:$e}},$e))])}},qg=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Yg(et){return et&&et.__esModule&&Object.prototype.hasOwnProperty.call(et,"default")?et.default:et}function Wg(et){if(et.__esModule)return et;var $e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(et).forEach(function(r){var O=Object.getOwnPropertyDescriptor(et,r);Object.defineProperty($e,r,O.get?O:{enumerable:!0,get:function(){return et[r]}})}),$e}var kd={exports:{}};/**!
 * Sortable 1.10.2
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function wf(et){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?wf=function($e){return typeof $e}:wf=function($e){return $e&&typeof Symbol=="function"&&$e.constructor===Symbol&&$e!==Symbol.prototype?"symbol":typeof $e},wf(et)}function Xg(et,$e,r){return $e in et?Object.defineProperty(et,$e,{value:r,enumerable:!0,configurable:!0,writable:!0}):et[$e]=r,et}function Ys(){return Ys=Object.assign||function(et){for(var $e=1;$e<arguments.length;$e++){var r=arguments[$e];for(var O in r)Object.prototype.hasOwnProperty.call(r,O)&&(et[O]=r[O])}return et},Ys.apply(this,arguments)}function Vl(et){for(var $e=1;$e<arguments.length;$e++){var r=arguments[$e]!=null?arguments[$e]:{},O=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(O=O.concat(Object.getOwnPropertySymbols(r).filter(function(B){return Object.getOwnPropertyDescriptor(r,B).enumerable}))),O.forEach(function(B){Xg(et,B,r[B])})}return et}function Zg(et,$e){if(et==null)return{};var r={},O=Object.keys(et),B,t;for(t=0;t<O.length;t++)B=O[t],!($e.indexOf(B)>=0)&&(r[B]=et[B]);return r}function Kg(et,$e){if(et==null)return{};var r=Zg(et,$e),O,B;if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(et);for(B=0;B<t.length;B++)O=t[B],!($e.indexOf(O)>=0)&&(!Object.prototype.propertyIsEnumerable.call(et,O)||(r[O]=et[O]))}return r}function Jg(et){return $g(et)||Qg(et)||em()}function $g(et){if(Array.isArray(et)){for(var $e=0,r=new Array(et.length);$e<et.length;$e++)r[$e]=et[$e];return r}}function Qg(et){if(Symbol.iterator in Object(et)||Object.prototype.toString.call(et)==="[object Arguments]")return Array.from(et)}function em(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var tm="1.10.2";function Ll(et){if(typeof window!="undefined"&&window.navigator)return!!navigator.userAgent.match(et)}var Pl=Ll(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),vc=Ll(/Edge/i),Ad=Ll(/firefox/i),Mh=Ll(/safari/i)&&!Ll(/chrome/i)&&!Ll(/android/i),Md=Ll(/iP(ad|od|hone)/i),rm=Ll(/chrome/i)&&Ll(/android/i),Sd={capture:!1,passive:!1};function fi(et,$e,r){et.addEventListener($e,r,!Pl&&Sd)}function ni(et,$e,r){et.removeEventListener($e,r,!Pl&&Sd)}function Tf(et,$e){if(!!$e){if($e[0]===">"&&($e=$e.substring(1)),et)try{if(et.matches)return et.matches($e);if(et.msMatchesSelector)return et.msMatchesSelector($e);if(et.webkitMatchesSelector)return et.webkitMatchesSelector($e)}catch(r){return!1}return!1}}function nm(et){return et.host&&et!==document&&et.host.nodeType?et.host:et.parentNode}function cl(et,$e,r,O){if(et){r=r||document;do{if($e!=null&&($e[0]===">"?et.parentNode===r&&Tf(et,$e):Tf(et,$e))||O&&et===r)return et;if(et===r)break}while(et=nm(et))}return null}var Ed=/\s+/g;function go(et,$e,r){if(et&&$e)if(et.classList)et.classList[r?"add":"remove"]($e);else{var O=(" "+et.className+" ").replace(Ed," ").replace(" "+$e+" "," ");et.className=(O+(r?" "+$e:"")).replace(Ed," ")}}function wa(et,$e,r){var O=et&&et.style;if(O){if(r===void 0)return document.defaultView&&document.defaultView.getComputedStyle?r=document.defaultView.getComputedStyle(et,""):et.currentStyle&&(r=et.currentStyle),$e===void 0?r:r[$e];!($e in O)&&$e.indexOf("webkit")===-1&&($e="-webkit-"+$e),O[$e]=r+(typeof r=="string"?"":"px")}}function cu(et,$e){var r="";if(typeof et=="string")r=et;else do{var O=wa(et,"transform");O&&O!=="none"&&(r=O+" "+r)}while(!$e&&(et=et.parentNode));var B=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return B&&new B(r)}function Cd(et,$e,r){if(et){var O=et.getElementsByTagName($e),B=0,t=O.length;if(r)for(;B<t;B++)r(O[B],B);return O}return[]}function wl(){var et=document.scrollingElement;return et||document.documentElement}function _o(et,$e,r,O,B){if(!(!et.getBoundingClientRect&&et!==window)){var t,d,m,p,e,f,u;if(et!==window&&et!==wl()?(t=et.getBoundingClientRect(),d=t.top,m=t.left,p=t.bottom,e=t.right,f=t.height,u=t.width):(d=0,m=0,p=window.innerHeight,e=window.innerWidth,f=window.innerHeight,u=window.innerWidth),($e||r)&&et!==window&&(B=B||et.parentNode,!Pl))do if(B&&B.getBoundingClientRect&&(wa(B,"transform")!=="none"||r&&wa(B,"position")!=="static")){var s=B.getBoundingClientRect();d-=s.top+parseInt(wa(B,"border-top-width")),m-=s.left+parseInt(wa(B,"border-left-width")),p=d+t.height,e=m+t.width;break}while(B=B.parentNode);if(O&&et!==window){var l=cu(B||et),o=l&&l.a,i=l&&l.d;l&&(d/=i,m/=o,u/=o,f/=i,p=d+f,e=m+u)}return{top:d,left:m,bottom:p,right:e,width:u,height:f}}}function Ld(et,$e,r){for(var O=Hl(et,!0),B=_o(et)[$e];O;){var t=_o(O)[r],d=void 0;if(r==="top"||r==="left"?d=B>=t:d=B<=t,!d)return O;if(O===wl())break;O=Hl(O,!1)}return!1}function kf(et,$e,r){for(var O=0,B=0,t=et.children;B<t.length;){if(t[B].style.display!=="none"&&t[B]!==Ia.ghost&&t[B]!==Ia.dragged&&cl(t[B],r.draggable,et,!1)){if(O===$e)return t[B];O++}B++}return null}function Sh(et,$e){for(var r=et.lastElementChild;r&&(r===Ia.ghost||wa(r,"display")==="none"||$e&&!Tf(r,$e));)r=r.previousElementSibling;return r||null}function wo(et,$e){var r=0;if(!et||!et.parentNode)return-1;for(;et=et.previousElementSibling;)et.nodeName.toUpperCase()!=="TEMPLATE"&&et!==Ia.clone&&(!$e||Tf(et,$e))&&r++;return r}function Pd(et){var $e=0,r=0,O=wl();if(et)do{var B=cu(et),t=B.a,d=B.d;$e+=et.scrollLeft*t,r+=et.scrollTop*d}while(et!==O&&(et=et.parentNode));return[$e,r]}function am(et,$e){for(var r in et)if(!!et.hasOwnProperty(r)){for(var O in $e)if($e.hasOwnProperty(O)&&$e[O]===et[r][O])return Number(r)}return-1}function Hl(et,$e){if(!et||!et.getBoundingClientRect)return wl();var r=et,O=!1;do if(r.clientWidth<r.scrollWidth||r.clientHeight<r.scrollHeight){var B=wa(r);if(r.clientWidth<r.scrollWidth&&(B.overflowX=="auto"||B.overflowX=="scroll")||r.clientHeight<r.scrollHeight&&(B.overflowY=="auto"||B.overflowY=="scroll")){if(!r.getBoundingClientRect||r===document.body)return wl();if(O||$e)return r;O=!0}}while(r=r.parentNode);return wl()}function im(et,$e){if(et&&$e)for(var r in $e)$e.hasOwnProperty(r)&&(et[r]=$e[r]);return et}function Eh(et,$e){return Math.round(et.top)===Math.round($e.top)&&Math.round(et.left)===Math.round($e.left)&&Math.round(et.height)===Math.round($e.height)&&Math.round(et.width)===Math.round($e.width)}var yc;function Id(et,$e){return function(){if(!yc){var r=arguments,O=this;r.length===1?et.call(O,r[0]):et.apply(O,r),yc=setTimeout(function(){yc=void 0},$e)}}}function om(){clearTimeout(yc),yc=void 0}function Od(et,$e,r){et.scrollLeft+=$e,et.scrollTop+=r}function Ch(et){var $e=window.Polymer,r=window.jQuery||window.Zepto;return $e&&$e.dom?$e.dom(et).cloneNode(!0):r?r(et).clone(!0)[0]:et.cloneNode(!0)}function Dd(et,$e){wa(et,"position","absolute"),wa(et,"top",$e.top),wa(et,"left",$e.left),wa(et,"width",$e.width),wa(et,"height",$e.height)}function Lh(et){wa(et,"position",""),wa(et,"top",""),wa(et,"left",""),wa(et,"width",""),wa(et,"height","")}var ds="Sortable"+new Date().getTime();function sm(){var et=[],$e;return{captureAnimationState:function(){if(et=[],!!this.options.animation){var O=[].slice.call(this.el.children);O.forEach(function(B){if(!(wa(B,"display")==="none"||B===Ia.ghost)){et.push({target:B,rect:_o(B)});var t=Vl({},et[et.length-1].rect);if(B.thisAnimationDuration){var d=cu(B,!0);d&&(t.top-=d.f,t.left-=d.e)}B.fromRect=t}})}},addAnimationState:function(O){et.push(O)},removeAnimationState:function(O){et.splice(am(et,{target:O}),1)},animateAll:function(O){var B=this;if(!this.options.animation){clearTimeout($e),typeof O=="function"&&O();return}var t=!1,d=0;et.forEach(function(m){var p=0,e=m.target,f=e.fromRect,u=_o(e),s=e.prevFromRect,l=e.prevToRect,o=m.rect,i=cu(e,!0);i&&(u.top-=i.f,u.left-=i.e),e.toRect=u,e.thisAnimationDuration&&Eh(s,u)&&!Eh(f,u)&&(o.top-u.top)/(o.left-u.left)==(f.top-u.top)/(f.left-u.left)&&(p=um(o,s,l,B.options)),Eh(u,f)||(e.prevFromRect=f,e.prevToRect=u,p||(p=B.options.animation),B.animate(e,o,u,p)),p&&(t=!0,d=Math.max(d,p),clearTimeout(e.animationResetTimer),e.animationResetTimer=setTimeout(function(){e.animationTime=0,e.prevFromRect=null,e.fromRect=null,e.prevToRect=null,e.thisAnimationDuration=null},p),e.thisAnimationDuration=p)}),clearTimeout($e),t?$e=setTimeout(function(){typeof O=="function"&&O()},d):typeof O=="function"&&O(),et=[]},animate:function(O,B,t,d){if(d){wa(O,"transition",""),wa(O,"transform","");var m=cu(this.el),p=m&&m.a,e=m&&m.d,f=(B.left-t.left)/(p||1),u=(B.top-t.top)/(e||1);O.animatingX=!!f,O.animatingY=!!u,wa(O,"transform","translate3d("+f+"px,"+u+"px,0)"),lm(O),wa(O,"transition","transform "+d+"ms"+(this.options.easing?" "+this.options.easing:"")),wa(O,"transform","translate3d(0,0,0)"),typeof O.animated=="number"&&clearTimeout(O.animated),O.animated=setTimeout(function(){wa(O,"transition",""),wa(O,"transform",""),O.animated=!1,O.animatingX=!1,O.animatingY=!1},d)}}}}function lm(et){return et.offsetWidth}function um(et,$e,r,O){return Math.sqrt(Math.pow($e.top-et.top,2)+Math.pow($e.left-et.left,2))/Math.sqrt(Math.pow($e.top-r.top,2)+Math.pow($e.left-r.left,2))*O.animation}var xc=[],Ph={initializeByDefault:!0},bc={mount:function($e){for(var r in Ph)Ph.hasOwnProperty(r)&&!(r in $e)&&($e[r]=Ph[r]);xc.push($e)},pluginEvent:function($e,r,O){var B=this;this.eventCanceled=!1,O.cancel=function(){B.eventCanceled=!0};var t=$e+"Global";xc.forEach(function(d){!r[d.pluginName]||(r[d.pluginName][t]&&r[d.pluginName][t](Vl({sortable:r},O)),r.options[d.pluginName]&&r[d.pluginName][$e]&&r[d.pluginName][$e](Vl({sortable:r},O)))})},initializePlugins:function($e,r,O,B){xc.forEach(function(m){var p=m.pluginName;if(!(!$e.options[p]&&!m.initializeByDefault)){var e=new m($e,r,$e.options);e.sortable=$e,e.options=$e.options,$e[p]=e,Ys(O,e.defaults)}});for(var t in $e.options)if(!!$e.options.hasOwnProperty(t)){var d=this.modifyOption($e,t,$e.options[t]);typeof d!="undefined"&&($e.options[t]=d)}},getEventProperties:function($e,r){var O={};return xc.forEach(function(B){typeof B.eventProperties=="function"&&Ys(O,B.eventProperties.call(r[B.pluginName],$e))}),O},modifyOption:function($e,r,O){var B;return xc.forEach(function(t){!$e[t.pluginName]||t.optionListeners&&typeof t.optionListeners[r]=="function"&&(B=t.optionListeners[r].call($e[t.pluginName],O))}),B}};function _c(et){var $e=et.sortable,r=et.rootEl,O=et.name,B=et.targetEl,t=et.cloneEl,d=et.toEl,m=et.fromEl,p=et.oldIndex,e=et.newIndex,f=et.oldDraggableIndex,u=et.newDraggableIndex,s=et.originalEvent,l=et.putSortable,o=et.extraEventProperties;if($e=$e||r&&r[ds],!!$e){var i,c=$e.options,n="on"+O.charAt(0).toUpperCase()+O.substr(1);window.CustomEvent&&!Pl&&!vc?i=new CustomEvent(O,{bubbles:!0,cancelable:!0}):(i=document.createEvent("Event"),i.initEvent(O,!0,!0)),i.to=d||r,i.from=m||r,i.item=B||r,i.clone=t,i.oldIndex=p,i.newIndex=e,i.oldDraggableIndex=f,i.newDraggableIndex=u,i.originalEvent=s,i.pullMode=l?l.lastPutMode:void 0;var a=Vl({},o,bc.getEventProperties(O,$e));for(var g in a)i[g]=a[g];r&&r.dispatchEvent(i),c[n]&&c[n].call($e,i)}}var Is=function($e,r){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},B=O.evt,t=Kg(O,["evt"]);bc.pluginEvent.bind(Ia)($e,r,Vl({dragEl:aa,parentEl:Bo,ghostEl:Ha,rootEl:mo,nextEl:fu,lastDownEl:Af,cloneEl:To,cloneHidden:Gl,dragStarted:Tc,putSortable:ls,activeSortable:Ia.active,originalEvent:B,oldIndex:Vu,oldDraggableIndex:wc,newIndex:Ns,newDraggableIndex:ql,hideGhostForTarget:Ud,unhideGhostForTarget:Vd,cloneNowHidden:function(){Gl=!0},cloneNowShown:function(){Gl=!1},dispatchSortableEvent:function(m){As({sortable:r,name:m,originalEvent:B})}},t))};function As(et){_c(Vl({putSortable:ls,cloneEl:To,targetEl:aa,rootEl:mo,oldIndex:Vu,oldDraggableIndex:wc,newIndex:Ns,newDraggableIndex:ql},et))}var aa,Bo,Ha,mo,fu,Af,To,Gl,Vu,Ns,wc,ql,Mf,ls,Hu=!1,Sf=!1,Ef=[],hu,fl,Ih,Oh,zd,Rd,Tc,Gu,kc,Ac=!1,Cf=!1,Lf,gs,Dh=[],zh=!1,Pf=[],If=typeof document!="undefined",Of=Md,Fd=vc||Pl?"cssFloat":"float",cm=If&&!rm&&!Md&&"draggable"in document.createElement("div"),Bd=function(){if(!!If){if(Pl)return!1;var et=document.createElement("x");return et.style.cssText="pointer-events:auto",et.style.pointerEvents==="auto"}}(),Nd=function($e,r){var O=wa($e),B=parseInt(O.width)-parseInt(O.paddingLeft)-parseInt(O.paddingRight)-parseInt(O.borderLeftWidth)-parseInt(O.borderRightWidth),t=kf($e,0,r),d=kf($e,1,r),m=t&&wa(t),p=d&&wa(d),e=m&&parseInt(m.marginLeft)+parseInt(m.marginRight)+_o(t).width,f=p&&parseInt(p.marginLeft)+parseInt(p.marginRight)+_o(d).width;if(O.display==="flex")return O.flexDirection==="column"||O.flexDirection==="column-reverse"?"vertical":"horizontal";if(O.display==="grid")return O.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(t&&m.float&&m.float!=="none"){var u=m.float==="left"?"left":"right";return d&&(p.clear==="both"||p.clear===u)?"vertical":"horizontal"}return t&&(m.display==="block"||m.display==="flex"||m.display==="table"||m.display==="grid"||e>=B&&O[Fd]==="none"||d&&O[Fd]==="none"&&e+f>B)?"vertical":"horizontal"},fm=function($e,r,O){var B=O?$e.left:$e.top,t=O?$e.right:$e.bottom,d=O?$e.width:$e.height,m=O?r.left:r.top,p=O?r.right:r.bottom,e=O?r.width:r.height;return B===m||t===p||B+d/2===m+e/2},hm=function($e,r){var O;return Ef.some(function(B){if(!Sh(B)){var t=_o(B),d=B[ds].options.emptyInsertThreshold,m=$e>=t.left-d&&$e<=t.right+d,p=r>=t.top-d&&r<=t.bottom+d;if(d&&m&&p)return O=B}}),O},jd=function($e){function r(t,d){return function(m,p,e,f){var u=m.options.group.name&&p.options.group.name&&m.options.group.name===p.options.group.name;if(t==null&&(d||u))return!0;if(t==null||t===!1)return!1;if(d&&t==="clone")return t;if(typeof t=="function")return r(t(m,p,e,f),d)(m,p,e,f);var s=(d?m:p).options.group.name;return t===!0||typeof t=="string"&&t===s||t.join&&t.indexOf(s)>-1}}var O={},B=$e.group;(!B||wf(B)!="object")&&(B={name:B}),O.name=B.name,O.checkPull=r(B.pull,!0),O.checkPut=r(B.put),O.revertClone=B.revertClone,$e.group=O},Ud=function(){!Bd&&Ha&&wa(Ha,"display","none")},Vd=function(){!Bd&&Ha&&wa(Ha,"display","")};If&&document.addEventListener("click",function(et){if(Sf)return et.preventDefault(),et.stopPropagation&&et.stopPropagation(),et.stopImmediatePropagation&&et.stopImmediatePropagation(),Sf=!1,!1},!0);var pu=function($e){if(aa){$e=$e.touches?$e.touches[0]:$e;var r=hm($e.clientX,$e.clientY);if(r){var O={};for(var B in $e)$e.hasOwnProperty(B)&&(O[B]=$e[B]);O.target=O.rootEl=r,O.preventDefault=void 0,O.stopPropagation=void 0,r[ds]._onDragOver(O)}}},pm=function($e){aa&&aa.parentNode[ds]._isOutsideThisEl($e.target)};function Ia(et,$e){if(!(et&&et.nodeType&&et.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(et));this.el=et,this.options=$e=Ys({},$e),et[ds]=this;var r={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(et.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Nd(et,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(d,m){d.setData("Text",m.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Ia.supportPointer!==!1&&"PointerEvent"in window,emptyInsertThreshold:5};bc.initializePlugins(this,et,r);for(var O in r)!(O in $e)&&($e[O]=r[O]);jd($e);for(var B in this)B.charAt(0)==="_"&&typeof this[B]=="function"&&(this[B]=this[B].bind(this));this.nativeDraggable=$e.forceFallback?!1:cm,this.nativeDraggable&&(this.options.touchStartThreshold=1),$e.supportPointer?fi(et,"pointerdown",this._onTapStart):(fi(et,"mousedown",this._onTapStart),fi(et,"touchstart",this._onTapStart)),this.nativeDraggable&&(fi(et,"dragover",this),fi(et,"dragenter",this)),Ef.push(this.el),$e.store&&$e.store.get&&this.sort($e.store.get(this)||[]),Ys(this,sm())}Ia.prototype={constructor:Ia,_isOutsideThisEl:function($e){!this.el.contains($e)&&$e!==this.el&&(Gu=null)},_getDirection:function($e,r){return typeof this.options.direction=="function"?this.options.direction.call(this,$e,r,aa):this.options.direction},_onTapStart:function($e){if(!!$e.cancelable){var r=this,O=this.el,B=this.options,t=B.preventOnFilter,d=$e.type,m=$e.touches&&$e.touches[0]||$e.pointerType&&$e.pointerType==="touch"&&$e,p=(m||$e).target,e=$e.target.shadowRoot&&($e.path&&$e.path[0]||$e.composedPath&&$e.composedPath()[0])||p,f=B.filter;if(bm(O),!aa&&!(/mousedown|pointerdown/.test(d)&&$e.button!==0||B.disabled)&&!e.isContentEditable&&(p=cl(p,B.draggable,O,!1),!(p&&p.animated)&&Af!==p)){if(Vu=wo(p),wc=wo(p,B.draggable),typeof f=="function"){if(f.call(this,$e,p,this)){As({sortable:r,rootEl:e,name:"filter",targetEl:p,toEl:O,fromEl:O}),Is("filter",r,{evt:$e}),t&&$e.cancelable&&$e.preventDefault();return}}else if(f&&(f=f.split(",").some(function(u){if(u=cl(e,u.trim(),O,!1),u)return As({sortable:r,rootEl:u,name:"filter",targetEl:p,fromEl:O,toEl:O}),Is("filter",r,{evt:$e}),!0}),f)){t&&$e.cancelable&&$e.preventDefault();return}B.handle&&!cl(e,B.handle,O,!1)||this._prepareDragStart($e,m,p)}}},_prepareDragStart:function($e,r,O){var B=this,t=B.el,d=B.options,m=t.ownerDocument,p;if(O&&!aa&&O.parentNode===t){var e=_o(O);if(mo=t,aa=O,Bo=aa.parentNode,fu=aa.nextSibling,Af=O,Mf=d.group,Ia.dragged=aa,hu={target:aa,clientX:(r||$e).clientX,clientY:(r||$e).clientY},zd=hu.clientX-e.left,Rd=hu.clientY-e.top,this._lastX=(r||$e).clientX,this._lastY=(r||$e).clientY,aa.style["will-change"]="all",p=function(){if(Is("delayEnded",B,{evt:$e}),Ia.eventCanceled){B._onDrop();return}B._disableDelayedDragEvents(),!Ad&&B.nativeDraggable&&(aa.draggable=!0),B._triggerDragStart($e,r),As({sortable:B,name:"choose",originalEvent:$e}),go(aa,d.chosenClass,!0)},d.ignore.split(",").forEach(function(f){Cd(aa,f.trim(),Fh)}),fi(m,"dragover",pu),fi(m,"mousemove",pu),fi(m,"touchmove",pu),fi(m,"mouseup",B._onDrop),fi(m,"touchend",B._onDrop),fi(m,"touchcancel",B._onDrop),Ad&&this.nativeDraggable&&(this.options.touchStartThreshold=4,aa.draggable=!0),Is("delayStart",this,{evt:$e}),d.delay&&(!d.delayOnTouchOnly||r)&&(!this.nativeDraggable||!(vc||Pl))){if(Ia.eventCanceled){this._onDrop();return}fi(m,"mouseup",B._disableDelayedDrag),fi(m,"touchend",B._disableDelayedDrag),fi(m,"touchcancel",B._disableDelayedDrag),fi(m,"mousemove",B._delayedDragTouchMoveHandler),fi(m,"touchmove",B._delayedDragTouchMoveHandler),d.supportPointer&&fi(m,"pointermove",B._delayedDragTouchMoveHandler),B._dragStartTimer=setTimeout(p,d.delay)}else p()}},_delayedDragTouchMoveHandler:function($e){var r=$e.touches?$e.touches[0]:$e;Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){aa&&Fh(aa),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var $e=this.el.ownerDocument;ni($e,"mouseup",this._disableDelayedDrag),ni($e,"touchend",this._disableDelayedDrag),ni($e,"touchcancel",this._disableDelayedDrag),ni($e,"mousemove",this._delayedDragTouchMoveHandler),ni($e,"touchmove",this._delayedDragTouchMoveHandler),ni($e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function($e,r){r=r||$e.pointerType=="touch"&&$e,!this.nativeDraggable||r?this.options.supportPointer?fi(document,"pointermove",this._onTouchMove):r?fi(document,"touchmove",this._onTouchMove):fi(document,"mousemove",this._onTouchMove):(fi(aa,"dragend",this),fi(mo,"dragstart",this._onDragStart));try{document.selection?Df(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(O){}},_dragStarted:function($e,r){if(Hu=!1,mo&&aa){Is("dragStarted",this,{evt:r}),this.nativeDraggable&&fi(document,"dragover",pm);var O=this.options;!$e&&go(aa,O.dragClass,!1),go(aa,O.ghostClass,!0),Ia.active=this,$e&&this._appendGhost(),As({sortable:this,name:"start",originalEvent:r})}else this._nulling()},_emulateDragOver:function(){if(fl){this._lastX=fl.clientX,this._lastY=fl.clientY,Ud();for(var $e=document.elementFromPoint(fl.clientX,fl.clientY),r=$e;$e&&$e.shadowRoot&&($e=$e.shadowRoot.elementFromPoint(fl.clientX,fl.clientY),$e!==r);)r=$e;if(aa.parentNode[ds]._isOutsideThisEl($e),r)do{if(r[ds]){var O=void 0;if(O=r[ds]._onDragOver({clientX:fl.clientX,clientY:fl.clientY,target:$e,rootEl:r}),O&&!this.options.dragoverBubble)break}$e=r}while(r=r.parentNode);Vd()}},_onTouchMove:function($e){if(hu){var r=this.options,O=r.fallbackTolerance,B=r.fallbackOffset,t=$e.touches?$e.touches[0]:$e,d=Ha&&cu(Ha,!0),m=Ha&&d&&d.a,p=Ha&&d&&d.d,e=Of&&gs&&Pd(gs),f=(t.clientX-hu.clientX+B.x)/(m||1)+(e?e[0]-Dh[0]:0)/(m||1),u=(t.clientY-hu.clientY+B.y)/(p||1)+(e?e[1]-Dh[1]:0)/(p||1);if(!Ia.active&&!Hu){if(O&&Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))<O)return;this._onDragStart($e,!0)}if(Ha){d?(d.e+=f-(Ih||0),d.f+=u-(Oh||0)):d={a:1,b:0,c:0,d:1,e:f,f:u};var s="matrix(".concat(d.a,",").concat(d.b,",").concat(d.c,",").concat(d.d,",").concat(d.e,",").concat(d.f,")");wa(Ha,"webkitTransform",s),wa(Ha,"mozTransform",s),wa(Ha,"msTransform",s),wa(Ha,"transform",s),Ih=f,Oh=u,fl=t}$e.cancelable&&$e.preventDefault()}},_appendGhost:function(){if(!Ha){var $e=this.options.fallbackOnBody?document.body:mo,r=_o(aa,!0,Of,!0,$e),O=this.options;if(Of){for(gs=$e;wa(gs,"position")==="static"&&wa(gs,"transform")==="none"&&gs!==document;)gs=gs.parentNode;gs!==document.body&&gs!==document.documentElement?(gs===document&&(gs=wl()),r.top+=gs.scrollTop,r.left+=gs.scrollLeft):gs=wl(),Dh=Pd(gs)}Ha=aa.cloneNode(!0),go(Ha,O.ghostClass,!1),go(Ha,O.fallbackClass,!0),go(Ha,O.dragClass,!0),wa(Ha,"transition",""),wa(Ha,"transform",""),wa(Ha,"box-sizing","border-box"),wa(Ha,"margin",0),wa(Ha,"top",r.top),wa(Ha,"left",r.left),wa(Ha,"width",r.width),wa(Ha,"height",r.height),wa(Ha,"opacity","0.8"),wa(Ha,"position",Of?"absolute":"fixed"),wa(Ha,"zIndex","100000"),wa(Ha,"pointerEvents","none"),Ia.ghost=Ha,$e.appendChild(Ha),wa(Ha,"transform-origin",zd/parseInt(Ha.style.width)*100+"% "+Rd/parseInt(Ha.style.height)*100+"%")}},_onDragStart:function($e,r){var O=this,B=$e.dataTransfer,t=O.options;if(Is("dragStart",this,{evt:$e}),Ia.eventCanceled){this._onDrop();return}Is("setupClone",this),Ia.eventCanceled||(To=Ch(aa),To.draggable=!1,To.style["will-change"]="",this._hideClone(),go(To,this.options.chosenClass,!1),Ia.clone=To),O.cloneId=Df(function(){Is("clone",O),!Ia.eventCanceled&&(O.options.removeCloneOnHide||mo.insertBefore(To,aa),O._hideClone(),As({sortable:O,name:"clone"}))}),!r&&go(aa,t.dragClass,!0),r?(Sf=!0,O._loopId=setInterval(O._emulateDragOver,50)):(ni(document,"mouseup",O._onDrop),ni(document,"touchend",O._onDrop),ni(document,"touchcancel",O._onDrop),B&&(B.effectAllowed="move",t.setData&&t.setData.call(O,B,aa)),fi(document,"drop",O),wa(aa,"transform","translateZ(0)")),Hu=!0,O._dragStartId=Df(O._dragStarted.bind(O,r,$e)),fi(document,"selectstart",O),Tc=!0,Mh&&wa(document.body,"user-select","none")},_onDragOver:function($e){var r=this.el,O=$e.target,B,t,d,m=this.options,p=m.group,e=Ia.active,f=Mf===p,u=m.sort,s=ls||e,l,o=this,i=!1;if(zh)return;function c(P,D){Is(P,o,Vl({evt:$e,isOwner:f,axis:l?"vertical":"horizontal",revert:d,dragRect:B,targetRect:t,canSort:u,fromSortable:s,target:O,completed:a,onMove:function(U,q){return Rh(mo,r,aa,B,U,_o(U),$e,q)},changed:g},D))}function n(){c("dragOverAnimationCapture"),o.captureAnimationState(),o!==s&&s.captureAnimationState()}function a(P){return c("dragOverCompleted",{insertion:P}),P&&(f?e._hideClone():e._showClone(o),o!==s&&(go(aa,ls?ls.options.ghostClass:e.options.ghostClass,!1),go(aa,m.ghostClass,!0)),ls!==o&&o!==Ia.active?ls=o:o===Ia.active&&ls&&(ls=null),s===o&&(o._ignoreWhileAnimating=O),o.animateAll(function(){c("dragOverAnimationComplete"),o._ignoreWhileAnimating=null}),o!==s&&(s.animateAll(),s._ignoreWhileAnimating=null)),(O===aa&&!aa.animated||O===r&&!O.animated)&&(Gu=null),!m.dragoverBubble&&!$e.rootEl&&O!==document&&(aa.parentNode[ds]._isOutsideThisEl($e.target),!P&&pu($e)),!m.dragoverBubble&&$e.stopPropagation&&$e.stopPropagation(),i=!0}function g(){Ns=wo(aa),ql=wo(aa,m.draggable),As({sortable:o,name:"change",toEl:r,newIndex:Ns,newDraggableIndex:ql,originalEvent:$e})}if($e.preventDefault!==void 0&&$e.cancelable&&$e.preventDefault(),O=cl(O,m.draggable,r,!0),c("dragOver"),Ia.eventCanceled)return i;if(aa.contains($e.target)||O.animated&&O.animatingX&&O.animatingY||o._ignoreWhileAnimating===O)return a(!1);if(Sf=!1,e&&!m.disabled&&(f?u||(d=!mo.contains(aa)):ls===this||(this.lastPutMode=Mf.checkPull(this,e,aa,$e))&&p.checkPut(this,e,aa,$e))){if(l=this._getDirection($e,O)==="vertical",B=_o(aa),c("dragOverValid"),Ia.eventCanceled)return i;if(d)return Bo=mo,n(),this._hideClone(),c("revert"),Ia.eventCanceled||(fu?mo.insertBefore(aa,fu):mo.appendChild(aa)),a(!0);var h=Sh(r,m.draggable);if(!h||mm($e,l,this)&&!h.animated){if(h===aa)return a(!1);if(h&&r===$e.target&&(O=h),O&&(t=_o(O)),Rh(mo,r,aa,B,O,t,$e,!!O)!==!1)return n(),r.appendChild(aa),Bo=r,g(),a(!0)}else if(O.parentNode===r){t=_o(O);var y=0,v,_=aa.parentNode!==r,x=!fm(aa.animated&&aa.toRect||B,O.animated&&O.toRect||t,l),T=l?"top":"left",A=Ld(O,"top","top")||Ld(aa,"top","top"),S=A?A.scrollTop:void 0;Gu!==O&&(v=t[T],Ac=!1,Cf=!x&&m.invertSwap||_),y=vm($e,O,t,l,x?1:m.swapThreshold,m.invertedSwapThreshold==null?m.swapThreshold:m.invertedSwapThreshold,Cf,Gu===O);var w;if(y!==0){var C=wo(aa);do C-=y,w=Bo.children[C];while(w&&(wa(w,"display")==="none"||w===Ha))}if(y===0||w===O)return a(!1);Gu=O,kc=y;var k=O.nextElementSibling,L=!1;L=y===1;var M=Rh(mo,r,aa,B,O,t,$e,L);if(M!==!1)return(M===1||M===-1)&&(L=M===1),zh=!0,setTimeout(gm,30),n(),L&&!k?r.appendChild(aa):O.parentNode.insertBefore(aa,L?k:O),A&&Od(A,0,S-A.scrollTop),Bo=aa.parentNode,v!==void 0&&!Cf&&(Lf=Math.abs(v-_o(O)[T])),g(),a(!0)}if(r.contains(aa))return a(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){ni(document,"mousemove",this._onTouchMove),ni(document,"touchmove",this._onTouchMove),ni(document,"pointermove",this._onTouchMove),ni(document,"dragover",pu),ni(document,"mousemove",pu),ni(document,"touchmove",pu)},_offUpEvents:function(){var $e=this.el.ownerDocument;ni($e,"mouseup",this._onDrop),ni($e,"touchend",this._onDrop),ni($e,"pointerup",this._onDrop),ni($e,"touchcancel",this._onDrop),ni(document,"selectstart",this)},_onDrop:function($e){var r=this.el,O=this.options;if(Ns=wo(aa),ql=wo(aa,O.draggable),Is("drop",this,{evt:$e}),Bo=aa&&aa.parentNode,Ns=wo(aa),ql=wo(aa,O.draggable),Ia.eventCanceled){this._nulling();return}Hu=!1,Cf=!1,Ac=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Bh(this.cloneId),Bh(this._dragStartId),this.nativeDraggable&&(ni(document,"drop",this),ni(r,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Mh&&wa(document.body,"user-select",""),wa(aa,"transform",""),$e&&(Tc&&($e.cancelable&&$e.preventDefault(),!O.dropBubble&&$e.stopPropagation()),Ha&&Ha.parentNode&&Ha.parentNode.removeChild(Ha),(mo===Bo||ls&&ls.lastPutMode!=="clone")&&To&&To.parentNode&&To.parentNode.removeChild(To),aa&&(this.nativeDraggable&&ni(aa,"dragend",this),Fh(aa),aa.style["will-change"]="",Tc&&!Hu&&go(aa,ls?ls.options.ghostClass:this.options.ghostClass,!1),go(aa,this.options.chosenClass,!1),As({sortable:this,name:"unchoose",toEl:Bo,newIndex:null,newDraggableIndex:null,originalEvent:$e}),mo!==Bo?(Ns>=0&&(As({rootEl:Bo,name:"add",toEl:Bo,fromEl:mo,originalEvent:$e}),As({sortable:this,name:"remove",toEl:Bo,originalEvent:$e}),As({rootEl:Bo,name:"sort",toEl:Bo,fromEl:mo,originalEvent:$e}),As({sortable:this,name:"sort",toEl:Bo,originalEvent:$e})),ls&&ls.save()):Ns!==Vu&&Ns>=0&&(As({sortable:this,name:"update",toEl:Bo,originalEvent:$e}),As({sortable:this,name:"sort",toEl:Bo,originalEvent:$e})),Ia.active&&((Ns==null||Ns===-1)&&(Ns=Vu,ql=wc),As({sortable:this,name:"end",toEl:Bo,originalEvent:$e}),this.save()))),this._nulling()},_nulling:function(){Is("nulling",this),mo=aa=Bo=Ha=fu=To=Af=Gl=hu=fl=Tc=Ns=ql=Vu=wc=Gu=kc=ls=Mf=Ia.dragged=Ia.ghost=Ia.clone=Ia.active=null,Pf.forEach(function($e){$e.checked=!0}),Pf.length=Ih=Oh=0},handleEvent:function($e){switch($e.type){case"drop":case"dragend":this._onDrop($e);break;case"dragenter":case"dragover":aa&&(this._onDragOver($e),dm($e));break;case"selectstart":$e.preventDefault();break}},toArray:function(){for(var $e=[],r,O=this.el.children,B=0,t=O.length,d=this.options;B<t;B++)r=O[B],cl(r,d.draggable,this.el,!1)&&$e.push(r.getAttribute(d.dataIdAttr)||xm(r));return $e},sort:function($e){var r={},O=this.el;this.toArray().forEach(function(B,t){var d=O.children[t];cl(d,this.options.draggable,O,!1)&&(r[B]=d)},this),$e.forEach(function(B){r[B]&&(O.removeChild(r[B]),O.appendChild(r[B]))})},save:function(){var $e=this.options.store;$e&&$e.set&&$e.set(this)},closest:function($e,r){return cl($e,r||this.options.draggable,this.el,!1)},option:function($e,r){var O=this.options;if(r===void 0)return O[$e];var B=bc.modifyOption(this,$e,r);typeof B!="undefined"?O[$e]=B:O[$e]=r,$e==="group"&&jd(O)},destroy:function(){Is("destroy",this);var $e=this.el;$e[ds]=null,ni($e,"mousedown",this._onTapStart),ni($e,"touchstart",this._onTapStart),ni($e,"pointerdown",this._onTapStart),this.nativeDraggable&&(ni($e,"dragover",this),ni($e,"dragenter",this)),Array.prototype.forEach.call($e.querySelectorAll("[draggable]"),function(r){r.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Ef.splice(Ef.indexOf(this.el),1),this.el=$e=null},_hideClone:function(){if(!Gl){if(Is("hideClone",this),Ia.eventCanceled)return;wa(To,"display","none"),this.options.removeCloneOnHide&&To.parentNode&&To.parentNode.removeChild(To),Gl=!0}},_showClone:function($e){if($e.lastPutMode!=="clone"){this._hideClone();return}if(Gl){if(Is("showClone",this),Ia.eventCanceled)return;mo.contains(aa)&&!this.options.group.revertClone?mo.insertBefore(To,aa):fu?mo.insertBefore(To,fu):mo.appendChild(To),this.options.group.revertClone&&this.animate(aa,To),wa(To,"display",""),Gl=!1}}};function dm(et){et.dataTransfer&&(et.dataTransfer.dropEffect="move"),et.cancelable&&et.preventDefault()}function Rh(et,$e,r,O,B,t,d,m){var p,e=et[ds],f=e.options.onMove,u;return window.CustomEvent&&!Pl&&!vc?p=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(p=document.createEvent("Event"),p.initEvent("move",!0,!0)),p.to=$e,p.from=et,p.dragged=r,p.draggedRect=O,p.related=B||$e,p.relatedRect=t||_o($e),p.willInsertAfter=m,p.originalEvent=d,et.dispatchEvent(p),f&&(u=f.call(e,p,d)),u}function Fh(et){et.draggable=!1}function gm(){zh=!1}function mm(et,$e,r){var O=_o(Sh(r.el,r.options.draggable)),B=10;return $e?et.clientX>O.right+B||et.clientX<=O.right&&et.clientY>O.bottom&&et.clientX>=O.left:et.clientX>O.right&&et.clientY>O.top||et.clientX<=O.right&&et.clientY>O.bottom+B}function vm(et,$e,r,O,B,t,d,m){var p=O?et.clientY:et.clientX,e=O?r.height:r.width,f=O?r.top:r.left,u=O?r.bottom:r.right,s=!1;if(!d){if(m&&Lf<e*B){if(!Ac&&(kc===1?p>f+e*t/2:p<u-e*t/2)&&(Ac=!0),Ac)s=!0;else if(kc===1?p<f+Lf:p>u-Lf)return-kc}else if(p>f+e*(1-B)/2&&p<u-e*(1-B)/2)return ym($e)}return s=s||d,s&&(p<f+e*t/2||p>u-e*t/2)?p>f+e/2?1:-1:0}function ym(et){return wo(aa)<wo(et)?1:-1}function xm(et){for(var $e=et.tagName+et.className+et.src+et.href+et.textContent,r=$e.length,O=0;r--;)O+=$e.charCodeAt(r);return O.toString(36)}function bm(et){Pf.length=0;for(var $e=et.getElementsByTagName("input"),r=$e.length;r--;){var O=$e[r];O.checked&&Pf.push(O)}}function Df(et){return setTimeout(et,0)}function Bh(et){return clearTimeout(et)}If&&fi(document,"touchmove",function(et){(Ia.active||Hu)&&et.cancelable&&et.preventDefault()});Ia.utils={on:fi,off:ni,css:wa,find:Cd,is:function($e,r){return!!cl($e,r,$e,!1)},extend:im,throttle:Id,closest:cl,toggleClass:go,clone:Ch,index:wo,nextTick:Df,cancelNextTick:Bh,detectDirection:Nd,getChild:kf};Ia.get=function(et){return et[ds]};Ia.mount=function(){for(var et=arguments.length,$e=new Array(et),r=0;r<et;r++)$e[r]=arguments[r];$e[0].constructor===Array&&($e=$e[0]),$e.forEach(function(O){if(!O.prototype||!O.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(O));O.utils&&(Ia.utils=Vl({},Ia.utils,O.utils)),bc.mount(O)})};Ia.create=function(et,$e){return new Ia(et,$e)};Ia.version=tm;var No=[],Mc,Nh,jh=!1,Uh,Vh,zf,Sc;function _m(){function et(){this.defaults={scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var $e in this)$e.charAt(0)==="_"&&typeof this[$e]=="function"&&(this[$e]=this[$e].bind(this))}return et.prototype={dragStarted:function(r){var O=r.originalEvent;this.sortable.nativeDraggable?fi(document,"dragover",this._handleAutoScroll):this.options.supportPointer?fi(document,"pointermove",this._handleFallbackAutoScroll):O.touches?fi(document,"touchmove",this._handleFallbackAutoScroll):fi(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(r){var O=r.originalEvent;!this.options.dragOverBubble&&!O.rootEl&&this._handleAutoScroll(O)},drop:function(){this.sortable.nativeDraggable?ni(document,"dragover",this._handleAutoScroll):(ni(document,"pointermove",this._handleFallbackAutoScroll),ni(document,"touchmove",this._handleFallbackAutoScroll),ni(document,"mousemove",this._handleFallbackAutoScroll)),Hd(),Rf(),om()},nulling:function(){zf=Nh=Mc=jh=Sc=Uh=Vh=null,No.length=0},_handleFallbackAutoScroll:function(r){this._handleAutoScroll(r,!0)},_handleAutoScroll:function(r,O){var B=this,t=(r.touches?r.touches[0]:r).clientX,d=(r.touches?r.touches[0]:r).clientY,m=document.elementFromPoint(t,d);if(zf=r,O||vc||Pl||Mh){Hh(r,this.options,m,O);var p=Hl(m,!0);jh&&(!Sc||t!==Uh||d!==Vh)&&(Sc&&Hd(),Sc=setInterval(function(){var e=Hl(document.elementFromPoint(t,d),!0);e!==p&&(p=e,Rf()),Hh(r,B.options,e,O)},10),Uh=t,Vh=d)}else{if(!this.options.bubbleScroll||Hl(m,!0)===wl()){Rf();return}Hh(r,this.options,Hl(m,!1),!1)}}},Ys(et,{pluginName:"scroll",initializeByDefault:!0})}function Rf(){No.forEach(function(et){clearInterval(et.pid)}),No=[]}function Hd(){clearInterval(Sc)}var Hh=Id(function(et,$e,r,O){if(!!$e.scroll){var B=(et.touches?et.touches[0]:et).clientX,t=(et.touches?et.touches[0]:et).clientY,d=$e.scrollSensitivity,m=$e.scrollSpeed,p=wl(),e=!1,f;Nh!==r&&(Nh=r,Rf(),Mc=$e.scroll,f=$e.scrollFn,Mc===!0&&(Mc=Hl(r,!0)));var u=0,s=Mc;do{var l=s,o=_o(l),i=o.top,c=o.bottom,n=o.left,a=o.right,g=o.width,h=o.height,y=void 0,v=void 0,_=l.scrollWidth,x=l.scrollHeight,T=wa(l),A=l.scrollLeft,S=l.scrollTop;l===p?(y=g<_&&(T.overflowX==="auto"||T.overflowX==="scroll"||T.overflowX==="visible"),v=h<x&&(T.overflowY==="auto"||T.overflowY==="scroll"||T.overflowY==="visible")):(y=g<_&&(T.overflowX==="auto"||T.overflowX==="scroll"),v=h<x&&(T.overflowY==="auto"||T.overflowY==="scroll"));var w=y&&(Math.abs(a-B)<=d&&A+g<_)-(Math.abs(n-B)<=d&&!!A),C=v&&(Math.abs(c-t)<=d&&S+h<x)-(Math.abs(i-t)<=d&&!!S);if(!No[u])for(var k=0;k<=u;k++)No[k]||(No[k]={});(No[u].vx!=w||No[u].vy!=C||No[u].el!==l)&&(No[u].el=l,No[u].vx=w,No[u].vy=C,clearInterval(No[u].pid),(w!=0||C!=0)&&(e=!0,No[u].pid=setInterval(function(){O&&this.layer===0&&Ia.active._onTouchMove(zf);var L=No[this.layer].vy?No[this.layer].vy*m:0,M=No[this.layer].vx?No[this.layer].vx*m:0;typeof f=="function"&&f.call(Ia.dragged.parentNode[ds],M,L,et,zf,No[this.layer].el)!=="continue"||Od(No[this.layer].el,M,L)}.bind({layer:u}),24))),u++}while($e.bubbleScroll&&s!==p&&(s=Hl(s,!1)));jh=e}},30),Gd=function($e){var r=$e.originalEvent,O=$e.putSortable,B=$e.dragEl,t=$e.activeSortable,d=$e.dispatchSortableEvent,m=$e.hideGhostForTarget,p=$e.unhideGhostForTarget;if(!!r){var e=O||t;m();var f=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:r,u=document.elementFromPoint(f.clientX,f.clientY);p(),e&&!e.el.contains(u)&&(d("spill"),this.onSpill({dragEl:B,putSortable:O}))}};function Gh(){}Gh.prototype={startIndex:null,dragStart:function($e){var r=$e.oldDraggableIndex;this.startIndex=r},onSpill:function($e){var r=$e.dragEl,O=$e.putSortable;this.sortable.captureAnimationState(),O&&O.captureAnimationState();var B=kf(this.sortable.el,this.startIndex,this.options);B?this.sortable.el.insertBefore(r,B):this.sortable.el.appendChild(r),this.sortable.animateAll(),O&&O.animateAll()},drop:Gd};Ys(Gh,{pluginName:"revertOnSpill"});function qh(){}qh.prototype={onSpill:function($e){var r=$e.dragEl,O=$e.putSortable,B=O||this.sortable;B.captureAnimationState(),r.parentNode&&r.parentNode.removeChild(r),B.animateAll()},drop:Gd};Ys(qh,{pluginName:"removeOnSpill"});var Ws;function wm(){function et(){this.defaults={swapClass:"sortable-swap-highlight"}}return et.prototype={dragStart:function(r){var O=r.dragEl;Ws=O},dragOverValid:function(r){var O=r.completed,B=r.target,t=r.onMove,d=r.activeSortable,m=r.changed,p=r.cancel;if(!!d.options.swap){var e=this.sortable.el,f=this.options;if(B&&B!==e){var u=Ws;t(B)!==!1?(go(B,f.swapClass,!0),Ws=B):Ws=null,u&&u!==Ws&&go(u,f.swapClass,!1)}m(),O(!0),p()}},drop:function(r){var O=r.activeSortable,B=r.putSortable,t=r.dragEl,d=B||this.sortable,m=this.options;Ws&&go(Ws,m.swapClass,!1),Ws&&(m.swap||B&&B.options.swap)&&t!==Ws&&(d.captureAnimationState(),d!==O&&O.captureAnimationState(),Tm(t,Ws),d.animateAll(),d!==O&&O.animateAll())},nulling:function(){Ws=null}},Ys(et,{pluginName:"swap",eventProperties:function(){return{swapItem:Ws}}})}function Tm(et,$e){var r=et.parentNode,O=$e.parentNode,B,t;!r||!O||r.isEqualNode($e)||O.isEqualNode(et)||(B=wo(et),t=wo($e),r.isEqualNode(O)&&B<t&&t++,r.insertBefore($e,r.children[B]),O.insertBefore(et,O.children[t]))}var Na=[],js=[],Ec,hl,Cc=!1,Us=!1,qu=!1,Wi,Lc,Ff;function km(){function et($e){for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));$e.options.supportPointer?fi(document,"pointerup",this._deselectMultiDrag):(fi(document,"mouseup",this._deselectMultiDrag),fi(document,"touchend",this._deselectMultiDrag)),fi(document,"keydown",this._checkKeyDown),fi(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(B,t){var d="";Na.length&&hl===$e?Na.forEach(function(m,p){d+=(p?", ":"")+m.textContent}):d=t.textContent,B.setData("Text",d)}}}return et.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(r){var O=r.dragEl;Wi=O},delayEnded:function(){this.isMultiDrag=~Na.indexOf(Wi)},setupClone:function(r){var O=r.sortable,B=r.cancel;if(!!this.isMultiDrag){for(var t=0;t<Na.length;t++)js.push(Ch(Na[t])),js[t].sortableIndex=Na[t].sortableIndex,js[t].draggable=!1,js[t].style["will-change"]="",go(js[t],this.options.selectedClass,!1),Na[t]===Wi&&go(js[t],this.options.chosenClass,!1);O._hideClone(),B()}},clone:function(r){var O=r.sortable,B=r.rootEl,t=r.dispatchSortableEvent,d=r.cancel;!this.isMultiDrag||this.options.removeCloneOnHide||Na.length&&hl===O&&(qd(!0,B),t("clone"),d())},showClone:function(r){var O=r.cloneNowShown,B=r.rootEl,t=r.cancel;!this.isMultiDrag||(qd(!1,B),js.forEach(function(d){wa(d,"display","")}),O(),Ff=!1,t())},hideClone:function(r){var O=this;r.sortable;var B=r.cloneNowHidden,t=r.cancel;!this.isMultiDrag||(js.forEach(function(d){wa(d,"display","none"),O.options.removeCloneOnHide&&d.parentNode&&d.parentNode.removeChild(d)}),B(),Ff=!0,t())},dragStartGlobal:function(r){r.sortable,!this.isMultiDrag&&hl&&hl.multiDrag._deselectMultiDrag(),Na.forEach(function(O){O.sortableIndex=wo(O)}),Na=Na.sort(function(O,B){return O.sortableIndex-B.sortableIndex}),qu=!0},dragStarted:function(r){var O=this,B=r.sortable;if(!!this.isMultiDrag){if(this.options.sort&&(B.captureAnimationState(),this.options.animation)){Na.forEach(function(d){d!==Wi&&wa(d,"position","absolute")});var t=_o(Wi,!1,!0,!0);Na.forEach(function(d){d!==Wi&&Dd(d,t)}),Us=!0,Cc=!0}B.animateAll(function(){Us=!1,Cc=!1,O.options.animation&&Na.forEach(function(d){Lh(d)}),O.options.sort&&Bf()})}},dragOver:function(r){var O=r.target,B=r.completed,t=r.cancel;Us&&~Na.indexOf(O)&&(B(!1),t())},revert:function(r){var O=r.fromSortable,B=r.rootEl,t=r.sortable,d=r.dragRect;Na.length>1&&(Na.forEach(function(m){t.addAnimationState({target:m,rect:Us?_o(m):d}),Lh(m),m.fromRect=d,O.removeAnimationState(m)}),Us=!1,Am(!this.options.removeCloneOnHide,B))},dragOverCompleted:function(r){var O=r.sortable,B=r.isOwner,t=r.insertion,d=r.activeSortable,m=r.parentEl,p=r.putSortable,e=this.options;if(t){if(B&&d._hideClone(),Cc=!1,e.animation&&Na.length>1&&(Us||!B&&!d.options.sort&&!p)){var f=_o(Wi,!1,!0,!0);Na.forEach(function(s){s!==Wi&&(Dd(s,f),m.appendChild(s))}),Us=!0}if(!B)if(Us||Bf(),Na.length>1){var u=Ff;d._showClone(O),d.options.animation&&!Ff&&u&&js.forEach(function(s){d.addAnimationState({target:s,rect:Lc}),s.fromRect=Lc,s.thisAnimationDuration=null})}else d._showClone(O)}},dragOverAnimationCapture:function(r){var O=r.dragRect,B=r.isOwner,t=r.activeSortable;if(Na.forEach(function(m){m.thisAnimationDuration=null}),t.options.animation&&!B&&t.multiDrag.isMultiDrag){Lc=Ys({},O);var d=cu(Wi,!0);Lc.top-=d.f,Lc.left-=d.e}},dragOverAnimationComplete:function(){Us&&(Us=!1,Bf())},drop:function(r){var O=r.originalEvent,B=r.rootEl,t=r.parentEl,d=r.sortable,m=r.dispatchSortableEvent,p=r.oldIndex,e=r.putSortable,f=e||this.sortable;if(!!O){var u=this.options,s=t.children;if(!qu)if(u.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),go(Wi,u.selectedClass,!~Na.indexOf(Wi)),~Na.indexOf(Wi))Na.splice(Na.indexOf(Wi),1),Ec=null,_c({sortable:d,rootEl:B,name:"deselect",targetEl:Wi,originalEvt:O});else{if(Na.push(Wi),_c({sortable:d,rootEl:B,name:"select",targetEl:Wi,originalEvt:O}),O.shiftKey&&Ec&&d.el.contains(Ec)){var l=wo(Ec),o=wo(Wi);if(~l&&~o&&l!==o){var i,c;for(o>l?(c=l,i=o):(c=o,i=l+1);c<i;c++)~Na.indexOf(s[c])||(go(s[c],u.selectedClass,!0),Na.push(s[c]),_c({sortable:d,rootEl:B,name:"select",targetEl:s[c],originalEvt:O}))}}else Ec=Wi;hl=f}if(qu&&this.isMultiDrag){if((t[ds].options.sort||t!==B)&&Na.length>1){var n=_o(Wi),a=wo(Wi,":not(."+this.options.selectedClass+")");if(!Cc&&u.animation&&(Wi.thisAnimationDuration=null),f.captureAnimationState(),!Cc&&(u.animation&&(Wi.fromRect=n,Na.forEach(function(h){if(h.thisAnimationDuration=null,h!==Wi){var y=Us?_o(h):n;h.fromRect=y,f.addAnimationState({target:h,rect:y})}})),Bf(),Na.forEach(function(h){s[a]?t.insertBefore(h,s[a]):t.appendChild(h),a++}),p===wo(Wi))){var g=!1;Na.forEach(function(h){if(h.sortableIndex!==wo(h)){g=!0;return}}),g&&m("update")}Na.forEach(function(h){Lh(h)}),f.animateAll()}hl=f}(B===t||e&&e.lastPutMode!=="clone")&&js.forEach(function(h){h.parentNode&&h.parentNode.removeChild(h)})}},nullingGlobal:function(){this.isMultiDrag=qu=!1,js.length=0},destroyGlobal:function(){this._deselectMultiDrag(),ni(document,"pointerup",this._deselectMultiDrag),ni(document,"mouseup",this._deselectMultiDrag),ni(document,"touchend",this._deselectMultiDrag),ni(document,"keydown",this._checkKeyDown),ni(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(r){if(!(typeof qu!="undefined"&&qu)&&hl===this.sortable&&!(r&&cl(r.target,this.options.draggable,this.sortable.el,!1))&&!(r&&r.button!==0))for(;Na.length;){var O=Na[0];go(O,this.options.selectedClass,!1),Na.shift(),_c({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:O,originalEvt:r})}},_checkKeyDown:function(r){r.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(r){r.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},Ys(et,{pluginName:"multiDrag",utils:{select:function(r){var O=r.parentNode[ds];!O||!O.options.multiDrag||~Na.indexOf(r)||(hl&&hl!==O&&(hl.multiDrag._deselectMultiDrag(),hl=O),go(r,O.options.selectedClass,!0),Na.push(r))},deselect:function(r){var O=r.parentNode[ds],B=Na.indexOf(r);!O||!O.options.multiDrag||!~B||(go(r,O.options.selectedClass,!1),Na.splice(B,1))}},eventProperties:function(){var r=this,O=[],B=[];return Na.forEach(function(t){O.push({multiDragElement:t,index:t.sortableIndex});var d;Us&&t!==Wi?d=-1:Us?d=wo(t,":not(."+r.options.selectedClass+")"):d=wo(t),B.push({multiDragElement:t,index:d})}),{items:Jg(Na),clones:[].concat(js),oldIndicies:O,newIndicies:B}},optionListeners:{multiDragKey:function(r){return r=r.toLowerCase(),r==="ctrl"?r="Control":r.length>1&&(r=r.charAt(0).toUpperCase()+r.substr(1)),r}}})}function Am(et,$e){Na.forEach(function(r,O){var B=$e.children[r.sortableIndex+(et?Number(O):0)];B?$e.insertBefore(r,B):$e.appendChild(r)})}function qd(et,$e){js.forEach(function(r,O){var B=$e.children[r.sortableIndex+(et?Number(O):0)];B?$e.insertBefore(r,B):$e.appendChild(r)})}function Bf(){Na.forEach(function(et){et!==Wi&&et.parentNode&&et.parentNode.removeChild(et)})}Ia.mount(new _m);Ia.mount(qh,Gh);var Mm=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ia,MultiDrag:km,Sortable:Ia,Swap:wm}),Sm=Wg(Mm);(function(et,$e){(function(O,B){et.exports=B(Sm)})(typeof self!="undefined"?self:qg,function(r){return function(O){var B={};function t(d){if(B[d])return B[d].exports;var m=B[d]={i:d,l:!1,exports:{}};return O[d].call(m.exports,m,m.exports,t),m.l=!0,m.exports}return t.m=O,t.c=B,t.d=function(d,m,p){t.o(d,m)||Object.defineProperty(d,m,{enumerable:!0,get:p})},t.r=function(d){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(d,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(d,"__esModule",{value:!0})},t.t=function(d,m){if(m&1&&(d=t(d)),m&8||m&4&&typeof d=="object"&&d&&d.__esModule)return d;var p=Object.create(null);if(t.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:d}),m&2&&typeof d!="string")for(var e in d)t.d(p,e,function(f){return d[f]}.bind(null,e));return p},t.n=function(d){var m=d&&d.__esModule?function(){return d.default}:function(){return d};return t.d(m,"a",m),m},t.o=function(d,m){return Object.prototype.hasOwnProperty.call(d,m)},t.p="",t(t.s="fb15")}({"01f9":function(O,B,t){var d=t("2d00"),m=t("5ca1"),p=t("2aba"),e=t("32e9"),f=t("84f2"),u=t("41a0"),s=t("7f20"),l=t("38fd"),o=t("2b4c")("iterator"),i=!([].keys&&"next"in[].keys()),c="@@iterator",n="keys",a="values",g=function(){return this};O.exports=function(h,y,v,_,x,T,A){u(v,y,_);var S=function(K){if(!i&&K in L)return L[K];switch(K){case n:return function(){return new v(this,K)};case a:return function(){return new v(this,K)}}return function(){return new v(this,K)}},w=y+" Iterator",C=x==a,k=!1,L=h.prototype,M=L[o]||L[c]||x&&L[x],P=M||S(x),D=x?C?S("entries"):P:void 0,N=y=="Array"&&L.entries||M,U,q,X;if(N&&(X=l(N.call(new h)),X!==Object.prototype&&X.next&&(s(X,w,!0),!d&&typeof X[o]!="function"&&e(X,o,g))),C&&M&&M.name!==a&&(k=!0,P=function(){return M.call(this)}),(!d||A)&&(i||k||!L[o])&&e(L,o,P),f[y]=P,f[w]=g,x)if(U={values:C?P:S(a),keys:T?P:S(n),entries:D},A)for(q in U)q in L||p(L,q,U[q]);else m(m.P+m.F*(i||k),y,U);return U}},"02f4":function(O,B,t){var d=t("4588"),m=t("be13");O.exports=function(p){return function(e,f){var u=String(m(e)),s=d(f),l=u.length,o,i;return s<0||s>=l?p?"":void 0:(o=u.charCodeAt(s),o<55296||o>56319||s+1===l||(i=u.charCodeAt(s+1))<56320||i>57343?p?u.charAt(s):o:p?u.slice(s,s+2):(o-55296<<10)+(i-56320)+65536)}}},"0390":function(O,B,t){var d=t("02f4")(!0);O.exports=function(m,p,e){return p+(e?d(m,p).length:1)}},"0bfb":function(O,B,t){var d=t("cb7c");O.exports=function(){var m=d(this),p="";return m.global&&(p+="g"),m.ignoreCase&&(p+="i"),m.multiline&&(p+="m"),m.unicode&&(p+="u"),m.sticky&&(p+="y"),p}},"0d58":function(O,B,t){var d=t("ce10"),m=t("e11e");O.exports=Object.keys||function(e){return d(e,m)}},"1495":function(O,B,t){var d=t("86cc"),m=t("cb7c"),p=t("0d58");O.exports=t("9e1e")?Object.defineProperties:function(f,u){m(f);for(var s=p(u),l=s.length,o=0,i;l>o;)d.f(f,i=s[o++],u[i]);return f}},"214f":function(O,B,t){t("b0c5");var d=t("2aba"),m=t("32e9"),p=t("79e5"),e=t("be13"),f=t("2b4c"),u=t("520a"),s=f("species"),l=!p(function(){var i=/./;return i.exec=function(){var c=[];return c.groups={a:"7"},c},"".replace(i,"$<a>")!=="7"}),o=function(){var i=/(?:)/,c=i.exec;i.exec=function(){return c.apply(this,arguments)};var n="ab".split(i);return n.length===2&&n[0]==="a"&&n[1]==="b"}();O.exports=function(i,c,n){var a=f(i),g=!p(function(){var T={};return T[a]=function(){return 7},""[i](T)!=7}),h=g?!p(function(){var T=!1,A=/a/;return A.exec=function(){return T=!0,null},i==="split"&&(A.constructor={},A.constructor[s]=function(){return A}),A[a](""),!T}):void 0;if(!g||!h||i==="replace"&&!l||i==="split"&&!o){var y=/./[a],v=n(e,a,""[i],function(A,S,w,C,k){return S.exec===u?g&&!k?{done:!0,value:y.call(S,w,C)}:{done:!0,value:A.call(w,S,C)}:{done:!1}}),_=v[0],x=v[1];d(String.prototype,i,_),m(RegExp.prototype,a,c==2?function(T,A){return x.call(T,this,A)}:function(T){return x.call(T,this)})}}},"230e":function(O,B,t){var d=t("d3f4"),m=t("7726").document,p=d(m)&&d(m.createElement);O.exports=function(e){return p?m.createElement(e):{}}},"23c6":function(O,B,t){var d=t("2d95"),m=t("2b4c")("toStringTag"),p=d(function(){return arguments}())=="Arguments",e=function(f,u){try{return f[u]}catch(s){}};O.exports=function(f){var u,s,l;return f===void 0?"Undefined":f===null?"Null":typeof(s=e(u=Object(f),m))=="string"?s:p?d(u):(l=d(u))=="Object"&&typeof u.callee=="function"?"Arguments":l}},"2621":function(O,B){B.f=Object.getOwnPropertySymbols},"2aba":function(O,B,t){var d=t("7726"),m=t("32e9"),p=t("69a8"),e=t("ca5a")("src"),f=t("fa5b"),u="toString",s=(""+f).split(u);t("8378").inspectSource=function(l){return f.call(l)},(O.exports=function(l,o,i,c){var n=typeof i=="function";n&&(p(i,"name")||m(i,"name",o)),l[o]!==i&&(n&&(p(i,e)||m(i,e,l[o]?""+l[o]:s.join(String(o)))),l===d?l[o]=i:c?l[o]?l[o]=i:m(l,o,i):(delete l[o],m(l,o,i)))})(Function.prototype,u,function(){return typeof this=="function"&&this[e]||f.call(this)})},"2aeb":function(O,B,t){var d=t("cb7c"),m=t("1495"),p=t("e11e"),e=t("613b")("IE_PROTO"),f=function(){},u="prototype",s=function(){var l=t("230e")("iframe"),o=p.length,i="<",c=">",n;for(l.style.display="none",t("fab2").appendChild(l),l.src="javascript:",n=l.contentWindow.document,n.open(),n.write(i+"script"+c+"document.F=Object"+i+"/script"+c),n.close(),s=n.F;o--;)delete s[u][p[o]];return s()};O.exports=Object.create||function(o,i){var c;return o!==null?(f[u]=d(o),c=new f,f[u]=null,c[e]=o):c=s(),i===void 0?c:m(c,i)}},"2b4c":function(O,B,t){var d=t("5537")("wks"),m=t("ca5a"),p=t("7726").Symbol,e=typeof p=="function",f=O.exports=function(u){return d[u]||(d[u]=e&&p[u]||(e?p:m)("Symbol."+u))};f.store=d},"2d00":function(O,B){O.exports=!1},"2d95":function(O,B){var t={}.toString;O.exports=function(d){return t.call(d).slice(8,-1)}},"2fdb":function(O,B,t){var d=t("5ca1"),m=t("d2c8"),p="includes";d(d.P+d.F*t("5147")(p),"String",{includes:function(f){return!!~m(this,f,p).indexOf(f,arguments.length>1?arguments[1]:void 0)}})},"32e9":function(O,B,t){var d=t("86cc"),m=t("4630");O.exports=t("9e1e")?function(p,e,f){return d.f(p,e,m(1,f))}:function(p,e,f){return p[e]=f,p}},"38fd":function(O,B,t){var d=t("69a8"),m=t("4bf8"),p=t("613b")("IE_PROTO"),e=Object.prototype;O.exports=Object.getPrototypeOf||function(f){return f=m(f),d(f,p)?f[p]:typeof f.constructor=="function"&&f instanceof f.constructor?f.constructor.prototype:f instanceof Object?e:null}},"41a0":function(O,B,t){var d=t("2aeb"),m=t("4630"),p=t("7f20"),e={};t("32e9")(e,t("2b4c")("iterator"),function(){return this}),O.exports=function(f,u,s){f.prototype=d(e,{next:m(1,s)}),p(f,u+" Iterator")}},"456d":function(O,B,t){var d=t("4bf8"),m=t("0d58");t("5eda")("keys",function(){return function(e){return m(d(e))}})},"4588":function(O,B){var t=Math.ceil,d=Math.floor;O.exports=function(m){return isNaN(m=+m)?0:(m>0?d:t)(m)}},"4630":function(O,B){O.exports=function(t,d){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:d}}},"4bf8":function(O,B,t){var d=t("be13");O.exports=function(m){return Object(d(m))}},"5147":function(O,B,t){var d=t("2b4c")("match");O.exports=function(m){var p=/./;try{"/./"[m](p)}catch(e){try{return p[d]=!1,!"/./"[m](p)}catch(f){}}return!0}},"520a":function(O,B,t){var d=t("0bfb"),m=RegExp.prototype.exec,p=String.prototype.replace,e=m,f="lastIndex",u=function(){var o=/a/,i=/b*/g;return m.call(o,"a"),m.call(i,"a"),o[f]!==0||i[f]!==0}(),s=/()??/.exec("")[1]!==void 0,l=u||s;l&&(e=function(i){var c=this,n,a,g,h;return s&&(a=new RegExp("^"+c.source+"$(?!\\s)",d.call(c))),u&&(n=c[f]),g=m.call(c,i),u&&g&&(c[f]=c.global?g.index+g[0].length:n),s&&g&&g.length>1&&p.call(g[0],a,function(){for(h=1;h<arguments.length-2;h++)arguments[h]===void 0&&(g[h]=void 0)}),g}),O.exports=e},"52a7":function(O,B){B.f={}.propertyIsEnumerable},"5537":function(O,B,t){var d=t("8378"),m=t("7726"),p="__core-js_shared__",e=m[p]||(m[p]={});(O.exports=function(f,u){return e[f]||(e[f]=u!==void 0?u:{})})("versions",[]).push({version:d.version,mode:t("2d00")?"pure":"global",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})},"5ca1":function(O,B,t){var d=t("7726"),m=t("8378"),p=t("32e9"),e=t("2aba"),f=t("9b43"),u="prototype",s=function(l,o,i){var c=l&s.F,n=l&s.G,a=l&s.S,g=l&s.P,h=l&s.B,y=n?d:a?d[o]||(d[o]={}):(d[o]||{})[u],v=n?m:m[o]||(m[o]={}),_=v[u]||(v[u]={}),x,T,A,S;n&&(i=o);for(x in i)T=!c&&y&&y[x]!==void 0,A=(T?y:i)[x],S=h&&T?f(A,d):g&&typeof A=="function"?f(Function.call,A):A,y&&e(y,x,A,l&s.U),v[x]!=A&&p(v,x,S),g&&_[x]!=A&&(_[x]=A)};d.core=m,s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,O.exports=s},"5eda":function(O,B,t){var d=t("5ca1"),m=t("8378"),p=t("79e5");O.exports=function(e,f){var u=(m.Object||{})[e]||Object[e],s={};s[e]=f(u),d(d.S+d.F*p(function(){u(1)}),"Object",s)}},"5f1b":function(O,B,t){var d=t("23c6"),m=RegExp.prototype.exec;O.exports=function(p,e){var f=p.exec;if(typeof f=="function"){var u=f.call(p,e);if(typeof u!="object")throw new TypeError("RegExp exec method returned something other than an Object or null");return u}if(d(p)!=="RegExp")throw new TypeError("RegExp#exec called on incompatible receiver");return m.call(p,e)}},"613b":function(O,B,t){var d=t("5537")("keys"),m=t("ca5a");O.exports=function(p){return d[p]||(d[p]=m(p))}},"626a":function(O,B,t){var d=t("2d95");O.exports=Object("z").propertyIsEnumerable(0)?Object:function(m){return d(m)=="String"?m.split(""):Object(m)}},"6762":function(O,B,t){var d=t("5ca1"),m=t("c366")(!0);d(d.P,"Array",{includes:function(e){return m(this,e,arguments.length>1?arguments[1]:void 0)}}),t("9c6c")("includes")},"6821":function(O,B,t){var d=t("626a"),m=t("be13");O.exports=function(p){return d(m(p))}},"69a8":function(O,B){var t={}.hasOwnProperty;O.exports=function(d,m){return t.call(d,m)}},"6a99":function(O,B,t){var d=t("d3f4");O.exports=function(m,p){if(!d(m))return m;var e,f;if(p&&typeof(e=m.toString)=="function"&&!d(f=e.call(m))||typeof(e=m.valueOf)=="function"&&!d(f=e.call(m))||!p&&typeof(e=m.toString)=="function"&&!d(f=e.call(m)))return f;throw TypeError("Can't convert object to primitive value")}},"7333":function(O,B,t){var d=t("0d58"),m=t("2621"),p=t("52a7"),e=t("4bf8"),f=t("626a"),u=Object.assign;O.exports=!u||t("79e5")(function(){var s={},l={},o=Symbol(),i="abcdefghijklmnopqrst";return s[o]=7,i.split("").forEach(function(c){l[c]=c}),u({},s)[o]!=7||Object.keys(u({},l)).join("")!=i})?function(l,o){for(var i=e(l),c=arguments.length,n=1,a=m.f,g=p.f;c>n;)for(var h=f(arguments[n++]),y=a?d(h).concat(a(h)):d(h),v=y.length,_=0,x;v>_;)g.call(h,x=y[_++])&&(i[x]=h[x]);return i}:u},"7726":function(O,B){var t=O.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=t)},"77f1":function(O,B,t){var d=t("4588"),m=Math.max,p=Math.min;O.exports=function(e,f){return e=d(e),e<0?m(e+f,0):p(e,f)}},"79e5":function(O,B){O.exports=function(t){try{return!!t()}catch(d){return!0}}},"7f20":function(O,B,t){var d=t("86cc").f,m=t("69a8"),p=t("2b4c")("toStringTag");O.exports=function(e,f,u){e&&!m(e=u?e:e.prototype,p)&&d(e,p,{configurable:!0,value:f})}},"8378":function(O,B){var t=O.exports={version:"2.6.5"};typeof __e=="number"&&(__e=t)},"84f2":function(O,B){O.exports={}},"86cc":function(O,B,t){var d=t("cb7c"),m=t("c69a"),p=t("6a99"),e=Object.defineProperty;B.f=t("9e1e")?Object.defineProperty:function(u,s,l){if(d(u),s=p(s,!0),d(l),m)try{return e(u,s,l)}catch(o){}if("get"in l||"set"in l)throw TypeError("Accessors not supported!");return"value"in l&&(u[s]=l.value),u}},"9b43":function(O,B,t){var d=t("d8e8");O.exports=function(m,p,e){if(d(m),p===void 0)return m;switch(e){case 1:return function(f){return m.call(p,f)};case 2:return function(f,u){return m.call(p,f,u)};case 3:return function(f,u,s){return m.call(p,f,u,s)}}return function(){return m.apply(p,arguments)}}},"9c6c":function(O,B,t){var d=t("2b4c")("unscopables"),m=Array.prototype;m[d]==null&&t("32e9")(m,d,{}),O.exports=function(p){m[d][p]=!0}},"9def":function(O,B,t){var d=t("4588"),m=Math.min;O.exports=function(p){return p>0?m(d(p),9007199254740991):0}},"9e1e":function(O,B,t){O.exports=!t("79e5")(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},a352:function(O,B){O.exports=r},a481:function(O,B,t){var d=t("cb7c"),m=t("4bf8"),p=t("9def"),e=t("4588"),f=t("0390"),u=t("5f1b"),s=Math.max,l=Math.min,o=Math.floor,i=/\$([$&`']|\d\d?|<[^>]*>)/g,c=/\$([$&`']|\d\d?)/g,n=function(a){return a===void 0?a:String(a)};t("214f")("replace",2,function(a,g,h,y){return[function(x,T){var A=a(this),S=x==null?void 0:x[g];return S!==void 0?S.call(x,A,T):h.call(String(A),x,T)},function(_,x){var T=y(h,_,this,x);if(T.done)return T.value;var A=d(_),S=String(this),w=typeof x=="function";w||(x=String(x));var C=A.global;if(C){var k=A.unicode;A.lastIndex=0}for(var L=[];;){var M=u(A,S);if(M===null||(L.push(M),!C))break;var P=String(M[0]);P===""&&(A.lastIndex=f(S,p(A.lastIndex),k))}for(var D="",N=0,U=0;U<L.length;U++){M=L[U];for(var q=String(M[0]),X=s(l(e(M.index),S.length),0),K=[],Z=1;Z<M.length;Z++)K.push(n(M[Z]));var H=M.groups;if(w){var Y=[q].concat(K,X,S);H!==void 0&&Y.push(H);var $=String(x.apply(void 0,Y))}else $=v(q,S,X,K,H,x);X>=N&&(D+=S.slice(N,X)+$,N=X+q.length)}return D+S.slice(N)}];function v(_,x,T,A,S,w){var C=T+_.length,k=A.length,L=c;return S!==void 0&&(S=m(S),L=i),h.call(w,L,function(M,P){var D;switch(P.charAt(0)){case"$":return"$";case"&":return _;case"`":return x.slice(0,T);case"'":return x.slice(C);case"<":D=S[P.slice(1,-1)];break;default:var N=+P;if(N===0)return M;if(N>k){var U=o(N/10);return U===0?M:U<=k?A[U-1]===void 0?P.charAt(1):A[U-1]+P.charAt(1):M}D=A[N-1]}return D===void 0?"":D})}})},aae3:function(O,B,t){var d=t("d3f4"),m=t("2d95"),p=t("2b4c")("match");O.exports=function(e){var f;return d(e)&&((f=e[p])!==void 0?!!f:m(e)=="RegExp")}},ac6a:function(O,B,t){for(var d=t("cadf"),m=t("0d58"),p=t("2aba"),e=t("7726"),f=t("32e9"),u=t("84f2"),s=t("2b4c"),l=s("iterator"),o=s("toStringTag"),i=u.Array,c={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},n=m(c),a=0;a<n.length;a++){var g=n[a],h=c[g],y=e[g],v=y&&y.prototype,_;if(v&&(v[l]||f(v,l,i),v[o]||f(v,o,g),u[g]=i,h))for(_ in d)v[_]||p(v,_,d[_],!0)}},b0c5:function(O,B,t){var d=t("520a");t("5ca1")({target:"RegExp",proto:!0,forced:d!==/./.exec},{exec:d})},be13:function(O,B){O.exports=function(t){if(t==null)throw TypeError("Can't call method on  "+t);return t}},c366:function(O,B,t){var d=t("6821"),m=t("9def"),p=t("77f1");O.exports=function(e){return function(f,u,s){var l=d(f),o=m(l.length),i=p(s,o),c;if(e&&u!=u){for(;o>i;)if(c=l[i++],c!=c)return!0}else for(;o>i;i++)if((e||i in l)&&l[i]===u)return e||i||0;return!e&&-1}}},c649:function(O,B,t){(function(d){t.d(B,"c",function(){return l}),t.d(B,"a",function(){return u}),t.d(B,"b",function(){return p}),t.d(B,"d",function(){return s}),t("a481");function m(){return typeof window!="undefined"?window.console:d.console}var p=m();function e(o){var i=Object.create(null);return function(n){var a=i[n];return a||(i[n]=o(n))}}var f=/-(\w)/g,u=e(function(o){return o.replace(f,function(i,c){return c?c.toUpperCase():""})});function s(o){o.parentElement!==null&&o.parentElement.removeChild(o)}function l(o,i,c){var n=c===0?o.children[0]:o.children[c-1].nextSibling;o.insertBefore(i,n)}}).call(this,t("c8ba"))},c69a:function(O,B,t){O.exports=!t("9e1e")&&!t("79e5")(function(){return Object.defineProperty(t("230e")("div"),"a",{get:function(){return 7}}).a!=7})},c8ba:function(O,B){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(d){typeof window=="object"&&(t=window)}O.exports=t},ca5a:function(O,B){var t=0,d=Math.random();O.exports=function(m){return"Symbol(".concat(m===void 0?"":m,")_",(++t+d).toString(36))}},cadf:function(O,B,t){var d=t("9c6c"),m=t("d53b"),p=t("84f2"),e=t("6821");O.exports=t("01f9")(Array,"Array",function(f,u){this._t=e(f),this._i=0,this._k=u},function(){var f=this._t,u=this._k,s=this._i++;return!f||s>=f.length?(this._t=void 0,m(1)):u=="keys"?m(0,s):u=="values"?m(0,f[s]):m(0,[s,f[s]])},"values"),p.Arguments=p.Array,d("keys"),d("values"),d("entries")},cb7c:function(O,B,t){var d=t("d3f4");O.exports=function(m){if(!d(m))throw TypeError(m+" is not an object!");return m}},ce10:function(O,B,t){var d=t("69a8"),m=t("6821"),p=t("c366")(!1),e=t("613b")("IE_PROTO");O.exports=function(f,u){var s=m(f),l=0,o=[],i;for(i in s)i!=e&&d(s,i)&&o.push(i);for(;u.length>l;)d(s,i=u[l++])&&(~p(o,i)||o.push(i));return o}},d2c8:function(O,B,t){var d=t("aae3"),m=t("be13");O.exports=function(p,e,f){if(d(e))throw TypeError("String#"+f+" doesn't accept regex!");return String(m(p))}},d3f4:function(O,B){O.exports=function(t){return typeof t=="object"?t!==null:typeof t=="function"}},d53b:function(O,B){O.exports=function(t,d){return{value:d,done:!!t}}},d8e8:function(O,B){O.exports=function(t){if(typeof t!="function")throw TypeError(t+" is not a function!");return t}},e11e:function(O,B){O.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},f559:function(O,B,t){var d=t("5ca1"),m=t("9def"),p=t("d2c8"),e="startsWith",f=""[e];d(d.P+d.F*t("5147")(e),"String",{startsWith:function(s){var l=p(this,s,e),o=m(Math.min(arguments.length>1?arguments[1]:void 0,l.length)),i=String(s);return f?f.call(l,i,o):l.slice(o,o+i.length)===i}})},f6fd:function(O,B){(function(t){var d="currentScript",m=t.getElementsByTagName("script");d in t||Object.defineProperty(t,d,{get:function(){try{throw new Error}catch(f){var p,e=(/.*at [^\(]*\((.*):.+:.+\)$/ig.exec(f.stack)||[!1])[1];for(p in m)if(m[p].src==e||m[p].readyState=="interactive")return m[p];return null}}})})(document)},f751:function(O,B,t){var d=t("5ca1");d(d.S+d.F,"Object",{assign:t("7333")})},fa5b:function(O,B,t){O.exports=t("5537")("native-function-to-string",Function.toString)},fab2:function(O,B,t){var d=t("7726").document;O.exports=d&&d.documentElement},fb15:function(O,B,t){if(t.r(B),typeof window!="undefined"){t("f6fd");var d;(d=window.document.currentScript)&&(d=d.src.match(/(.+\/)[^/]+\.js(\?.*)?$/))&&(t.p=d[1])}t("f751"),t("f559"),t("ac6a"),t("cadf"),t("456d");function m(q){if(Array.isArray(q))return q}function p(q,X){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(q)))){var K=[],Z=!0,H=!1,Y=void 0;try{for(var $=q[Symbol.iterator](),z;!(Z=(z=$.next()).done)&&(K.push(z.value),!(X&&K.length===X));Z=!0);}catch(j){H=!0,Y=j}finally{try{!Z&&$.return!=null&&$.return()}finally{if(H)throw Y}}return K}}function e(q,X){(X==null||X>q.length)&&(X=q.length);for(var K=0,Z=new Array(X);K<X;K++)Z[K]=q[K];return Z}function f(q,X){if(!!q){if(typeof q=="string")return e(q,X);var K=Object.prototype.toString.call(q).slice(8,-1);if(K==="Object"&&q.constructor&&(K=q.constructor.name),K==="Map"||K==="Set")return Array.from(q);if(K==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(K))return e(q,X)}}function u(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s(q,X){return m(q)||p(q,X)||f(q,X)||u()}t("6762"),t("2fdb");function l(q){if(Array.isArray(q))return e(q)}function o(q){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(q))return Array.from(q)}function i(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c(q){return l(q)||o(q)||f(q)||i()}var n=t("a352"),a=t.n(n),g=t("c649");function h(q,X,K){return K===void 0||(q=q||{},q[X]=K),q}function y(q,X){return q.map(function(K){return K.elm}).indexOf(X)}function v(q,X,K,Z){if(!q)return[];var H=q.map(function(z){return z.elm}),Y=X.length-Z,$=c(X).map(function(z,j){return j>=Y?H.length:H.indexOf(z)});return K?$.filter(function(z){return z!==-1}):$}function _(q,X){var K=this;this.$nextTick(function(){return K.$emit(q.toLowerCase(),X)})}function x(q){var X=this;return function(K){X.realList!==null&&X["onDrag"+q](K),_.call(X,q,K)}}function T(q){return["transition-group","TransitionGroup"].includes(q)}function A(q){if(!q||q.length!==1)return!1;var X=s(q,1),K=X[0].componentOptions;return K?T(K.tag):!1}function S(q,X,K){return q[K]||(X[K]?X[K]():void 0)}function w(q,X,K){var Z=0,H=0,Y=S(X,K,"header");Y&&(Z=Y.length,q=q?[].concat(c(Y),c(q)):c(Y));var $=S(X,K,"footer");return $&&(H=$.length,q=q?[].concat(c(q),c($)):c($)),{children:q,headerOffset:Z,footerOffset:H}}function C(q,X){var K=null,Z=function(W,ee){K=h(K,W,ee)},H=Object.keys(q).filter(function(j){return j==="id"||j.startsWith("data-")}).reduce(function(j,W){return j[W]=q[W],j},{});if(Z("attrs",H),!X)return K;var Y=X.on,$=X.props,z=X.attrs;return Z("on",Y),Z("props",$),Object.assign(K.attrs,z),K}var k=["Start","Add","Remove","Update","End"],L=["Choose","Unchoose","Sort","Filter","Clone"],M=["Move"].concat(k,L).map(function(q){return"on"+q}),P=null,D={options:Object,list:{type:Array,required:!1,default:null},value:{type:Array,required:!1,default:null},noTransitionOnDrag:{type:Boolean,default:!1},clone:{type:Function,default:function(X){return X}},element:{type:String,default:"div"},tag:{type:String,default:null},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},N={name:"draggable",inheritAttrs:!1,props:D,data:function(){return{transitionMode:!1,noneFunctionalComponentMode:!1}},render:function(X){var K=this.$slots.default;this.transitionMode=A(K);var Z=w(K,this.$slots,this.$scopedSlots),H=Z.children,Y=Z.headerOffset,$=Z.footerOffset;this.headerOffset=Y,this.footerOffset=$;var z=C(this.$attrs,this.componentData);return X(this.getTag(),z,H)},created:function(){this.list!==null&&this.value!==null&&g.b.error("Value and list props are mutually exclusive! Please set one or another."),this.element!=="div"&&g.b.warn("Element props is deprecated please use tag props instead. See https://github.com/SortableJS/Vue.Draggable/blob/master/documentation/migrate.md#element-props"),this.options!==void 0&&g.b.warn("Options props is deprecated, add sortable options directly as vue.draggable item, or use v-bind. See https://github.com/SortableJS/Vue.Draggable/blob/master/documentation/migrate.md#options-props")},mounted:function(){var X=this;if(this.noneFunctionalComponentMode=this.getTag().toLowerCase()!==this.$el.nodeName.toLowerCase()&&!this.getIsFunctional(),this.noneFunctionalComponentMode&&this.transitionMode)throw new Error("Transition-group inside component is not supported. Please alter tag value or remove transition-group. Current tag value: ".concat(this.getTag()));var K={};k.forEach(function(Y){K["on"+Y]=x.call(X,Y)}),L.forEach(function(Y){K["on"+Y]=_.bind(X,Y)});var Z=Object.keys(this.$attrs).reduce(function(Y,$){return Y[Object(g.a)($)]=X.$attrs[$],Y},{}),H=Object.assign({},this.options,Z,K,{onMove:function($,z){return X.onDragMove($,z)}});!("draggable"in H)&&(H.draggable=">*"),this._sortable=new a.a(this.rootContainer,H),this.computeIndexes()},beforeDestroy:function(){this._sortable!==void 0&&this._sortable.destroy()},computed:{rootContainer:function(){return this.transitionMode?this.$el.children[0]:this.$el},realList:function(){return this.list?this.list:this.value}},watch:{options:{handler:function(X){this.updateOptions(X)},deep:!0},$attrs:{handler:function(X){this.updateOptions(X)},deep:!0},realList:function(){this.computeIndexes()}},methods:{getIsFunctional:function(){var X=this._vnode.fnOptions;return X&&X.functional},getTag:function(){return this.tag||this.element},updateOptions:function(X){for(var K in X){var Z=Object(g.a)(K);M.indexOf(Z)===-1&&this._sortable.option(Z,X[K])}},getChildrenNodes:function(){if(this.noneFunctionalComponentMode)return this.$children[0].$slots.default;var X=this.$slots.default;return this.transitionMode?X[0].child.$slots.default:X},computeIndexes:function(){var X=this;this.$nextTick(function(){X.visibleIndexes=v(X.getChildrenNodes(),X.rootContainer.children,X.transitionMode,X.footerOffset)})},getUnderlyingVm:function(X){var K=y(this.getChildrenNodes()||[],X);if(K===-1)return null;var Z=this.realList[K];return{index:K,element:Z}},getUnderlyingPotencialDraggableComponent:function(X){var K=X.__vue__;return!K||!K.$options||!T(K.$options._componentTag)?!("realList"in K)&&K.$children.length===1&&"realList"in K.$children[0]?K.$children[0]:K:K.$parent},emitChanges:function(X){var K=this;this.$nextTick(function(){K.$emit("change",X)})},alterList:function(X){if(this.list){X(this.list);return}var K=c(this.value);X(K),this.$emit("input",K)},spliceList:function(){var X=arguments,K=function(H){return H.splice.apply(H,c(X))};this.alterList(K)},updatePosition:function(X,K){var Z=function(Y){return Y.splice(K,0,Y.splice(X,1)[0])};this.alterList(Z)},getRelatedContextFromMoveEvent:function(X){var K=X.to,Z=X.related,H=this.getUnderlyingPotencialDraggableComponent(K);if(!H)return{component:H};var Y=H.realList,$={list:Y,component:H};if(K!==Z&&Y&&H.getUnderlyingVm){var z=H.getUnderlyingVm(Z);if(z)return Object.assign(z,$)}return $},getVmIndex:function(X){var K=this.visibleIndexes,Z=K.length;return X>Z-1?Z:K[X]},getComponent:function(){return this.$slots.default[0].componentInstance},resetTransitionData:function(X){if(!(!this.noTransitionOnDrag||!this.transitionMode)){var K=this.getChildrenNodes();K[X].data=null;var Z=this.getComponent();Z.children=[],Z.kept=void 0}},onDragStart:function(X){this.context=this.getUnderlyingVm(X.item),X.item._underlying_vm_=this.clone(this.context.element),P=X.item},onDragAdd:function(X){var K=X.item._underlying_vm_;if(K!==void 0){Object(g.d)(X.item);var Z=this.getVmIndex(X.newIndex);this.spliceList(Z,0,K),this.computeIndexes();var H={element:K,newIndex:Z};this.emitChanges({added:H})}},onDragRemove:function(X){if(Object(g.c)(this.rootContainer,X.item,X.oldIndex),X.pullMode==="clone"){Object(g.d)(X.clone);return}var K=this.context.index;this.spliceList(K,1);var Z={element:this.context.element,oldIndex:K};this.resetTransitionData(K),this.emitChanges({removed:Z})},onDragUpdate:function(X){Object(g.d)(X.item),Object(g.c)(X.from,X.item,X.oldIndex);var K=this.context.index,Z=this.getVmIndex(X.newIndex);this.updatePosition(K,Z);var H={element:this.context.element,oldIndex:K,newIndex:Z};this.emitChanges({moved:H})},updateProperty:function(X,K){X.hasOwnProperty(K)&&(X[K]+=this.headerOffset)},computeFutureIndex:function(X,K){if(!X.element)return 0;var Z=c(K.to.children).filter(function(z){return z.style.display!=="none"}),H=Z.indexOf(K.related),Y=X.component.getVmIndex(H),$=Z.indexOf(P)!==-1;return $||!K.willInsertAfter?Y:Y+1},onDragMove:function(X,K){var Z=this.move;if(!Z||!this.realList)return!0;var H=this.getRelatedContextFromMoveEvent(X),Y=this.context,$=this.computeFutureIndex(H,X);Object.assign(Y,{futureIndex:$});var z=Object.assign({},X,{relatedContext:H,draggedContext:Y});return Z(z,K)},onDragEnd:function(){this.computeIndexes(),P=null}}};typeof window!="undefined"&&"Vue"in window&&window.Vue.component("draggable",N);var U=N;B.default=U}}).default})})(kd);var Em=Yg(kd.exports),Cm=Object.defineProperty,Lm=Object.defineProperties,Pm=Object.getOwnPropertyDescriptors,Yd=Object.getOwnPropertySymbols,Im=Object.prototype.hasOwnProperty,Om=Object.prototype.propertyIsEnumerable,Wd=(et,$e,r)=>$e in et?Cm(et,$e,{enumerable:!0,configurable:!0,writable:!0,value:r}):et[$e]=r,Nf=(et,$e)=>{for(var r in $e||($e={}))Im.call($e,r)&&Wd(et,r,$e[r]);if(Yd)for(var r of Yd($e))Om.call($e,r)&&Wd(et,r,$e[r]);return et},Dm=(et,$e)=>Lm(et,Pm($e)),Xi=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function zm(et){return et&&et.__esModule&&Object.prototype.hasOwnProperty.call(et,"default")?et.default:et}function jf(et){throw new Error('Could not dynamically require "'+et+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Xd={exports:{}};(function(et,$e){(function(r){et.exports=r()})(function(){return function r(O,B,t){function d(e,f){if(!B[e]){if(!O[e]){var u=typeof jf=="function"&&jf;if(!f&&u)return u(e,!0);if(m)return m(e,!0);var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}var l=B[e]={exports:{}};O[e][0].call(l.exports,function(o){return d(O[e][1][o]||o)},l,l.exports,r,O,B,t)}return B[e].exports}for(var m=typeof jf=="function"&&jf,p=0;p<t.length;p++)d(t[p]);return d}({1:[function(r,O,B){var t=r("../src/lib"),d={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid transparent;border-left-color:#69738a;margin-top:8px;margin-right:-30px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:#fff;","X .select-outline-2":"stroke:#000;stroke-dasharray:2px 2px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var m in d){var p=m.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");t.addStyleRule(p,d[m])}},{"../src/lib":787}],2:[function(r,O,B){O.exports=r("../src/transforms/aggregate")},{"../src/transforms/aggregate":1383}],3:[function(r,O,B){O.exports=r("../src/traces/bar")},{"../src/traces/bar":933}],4:[function(r,O,B){O.exports=r("../src/traces/barpolar")},{"../src/traces/barpolar":946}],5:[function(r,O,B){O.exports=r("../src/traces/box")},{"../src/traces/box":956}],6:[function(r,O,B){O.exports=r("../src/components/calendars")},{"../src/components/calendars":648}],7:[function(r,O,B){O.exports=r("../src/traces/candlestick")},{"../src/traces/candlestick":965}],8:[function(r,O,B){O.exports=r("../src/traces/carpet")},{"../src/traces/carpet":984}],9:[function(r,O,B){O.exports=r("../src/traces/choropleth")},{"../src/traces/choropleth":998}],10:[function(r,O,B){O.exports=r("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":1005}],11:[function(r,O,B){O.exports=r("../src/traces/cone")},{"../src/traces/cone":1011}],12:[function(r,O,B){O.exports=r("../src/traces/contour")},{"../src/traces/contour":1026}],13:[function(r,O,B){O.exports=r("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":1037}],14:[function(r,O,B){O.exports=r("../src/core")},{"../src/core":765}],15:[function(r,O,B){O.exports=r("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":1045}],16:[function(r,O,B){O.exports=r("../src/transforms/filter")},{"../src/transforms/filter":1384}],17:[function(r,O,B){O.exports=r("../src/traces/funnel")},{"../src/traces/funnel":1055}],18:[function(r,O,B){O.exports=r("../src/traces/funnelarea")},{"../src/traces/funnelarea":1064}],19:[function(r,O,B){O.exports=r("../src/transforms/groupby")},{"../src/transforms/groupby":1385}],20:[function(r,O,B){O.exports=r("../src/traces/heatmap")},{"../src/traces/heatmap":1077}],21:[function(r,O,B){O.exports=r("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":1087}],22:[function(r,O,B){O.exports=r("../src/traces/histogram")},{"../src/traces/histogram":1099}],23:[function(r,O,B){O.exports=r("../src/traces/histogram2d")},{"../src/traces/histogram2d":1105}],24:[function(r,O,B){O.exports=r("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":1109}],25:[function(r,O,B){O.exports=r("../src/traces/icicle")},{"../src/traces/icicle":1115}],26:[function(r,O,B){O.exports=r("../src/traces/image")},{"../src/traces/image":1128}],27:[function(r,O,B){var t=r("./core");t.register([r("./bar"),r("./box"),r("./heatmap"),r("./histogram"),r("./histogram2d"),r("./histogram2dcontour"),r("./contour"),r("./scatterternary"),r("./violin"),r("./funnel"),r("./waterfall"),r("./image"),r("./pie"),r("./sunburst"),r("./treemap"),r("./icicle"),r("./funnelarea"),r("./scatter3d"),r("./surface"),r("./isosurface"),r("./volume"),r("./mesh3d"),r("./cone"),r("./streamtube"),r("./scattergeo"),r("./choropleth"),r("./scattergl"),r("./splom"),r("./pointcloud"),r("./heatmapgl"),r("./parcoords"),r("./parcats"),r("./scattermapbox"),r("./choroplethmapbox"),r("./densitymapbox"),r("./sankey"),r("./indicator"),r("./table"),r("./carpet"),r("./scattercarpet"),r("./contourcarpet"),r("./ohlc"),r("./candlestick"),r("./scatterpolar"),r("./scatterpolargl"),r("./barpolar"),r("./aggregate"),r("./filter"),r("./groupby"),r("./sort"),r("./calendars")]),O.exports=t},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scatterternary":44,"./sort":45,"./splom":46,"./streamtube":47,"./sunburst":48,"./surface":49,"./table":50,"./treemap":51,"./violin":52,"./volume":53,"./waterfall":54}],28:[function(r,O,B){O.exports=r("../src/traces/indicator")},{"../src/traces/indicator":1136}],29:[function(r,O,B){O.exports=r("../src/traces/isosurface")},{"../src/traces/isosurface":1142}],30:[function(r,O,B){O.exports=r("../src/traces/mesh3d")},{"../src/traces/mesh3d":1147}],31:[function(r,O,B){O.exports=r("../src/traces/ohlc")},{"../src/traces/ohlc":1152}],32:[function(r,O,B){O.exports=r("../src/traces/parcats")},{"../src/traces/parcats":1161}],33:[function(r,O,B){O.exports=r("../src/traces/parcoords")},{"../src/traces/parcoords":1171}],34:[function(r,O,B){O.exports=r("../src/traces/pie")},{"../src/traces/pie":1182}],35:[function(r,O,B){O.exports=r("../src/traces/pointcloud")},{"../src/traces/pointcloud":1191}],36:[function(r,O,B){O.exports=r("../src/traces/sankey")},{"../src/traces/sankey":1197}],37:[function(r,O,B){O.exports=r("../src/traces/scatter3d")},{"../src/traces/scatter3d":1235}],38:[function(r,O,B){O.exports=r("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":1242}],39:[function(r,O,B){O.exports=r("../src/traces/scattergeo")},{"../src/traces/scattergeo":1250}],40:[function(r,O,B){O.exports=r("../src/traces/scattergl")},{"../src/traces/scattergl":1263}],41:[function(r,O,B){O.exports=r("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1273}],42:[function(r,O,B){O.exports=r("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1281}],43:[function(r,O,B){O.exports=r("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1288}],44:[function(r,O,B){O.exports=r("../src/traces/scatterternary")},{"../src/traces/scatterternary":1296}],45:[function(r,O,B){O.exports=r("../src/transforms/sort")},{"../src/transforms/sort":1387}],46:[function(r,O,B){O.exports=r("../src/traces/splom")},{"../src/traces/splom":1305}],47:[function(r,O,B){O.exports=r("../src/traces/streamtube")},{"../src/traces/streamtube":1313}],48:[function(r,O,B){O.exports=r("../src/traces/sunburst")},{"../src/traces/sunburst":1321}],49:[function(r,O,B){O.exports=r("../src/traces/surface")},{"../src/traces/surface":1330}],50:[function(r,O,B){O.exports=r("../src/traces/table")},{"../src/traces/table":1338}],51:[function(r,O,B){O.exports=r("../src/traces/treemap")},{"../src/traces/treemap":1349}],52:[function(r,O,B){O.exports=r("../src/traces/violin")},{"../src/traces/violin":1362}],53:[function(r,O,B){O.exports=r("../src/traces/volume")},{"../src/traces/volume":1370}],54:[function(r,O,B){O.exports=r("../src/traces/waterfall")},{"../src/traces/waterfall":1378}],55:[function(r,O,B){O.exports=function(f){var u=(f=f||{}).eye||[0,0,1],s=f.center||[0,0,0],l=f.up||[0,1,0],o=f.distanceLimits||[0,1/0],i=f.mode||"turntable",c=t(),n=d(),a=m();return c.setDistanceLimits(o[0],o[1]),c.lookAt(0,u,s,l),n.setDistanceLimits(o[0],o[1]),n.lookAt(0,u,s,l),a.setDistanceLimits(o[0],o[1]),a.lookAt(0,u,s,l),new p({turntable:c,orbit:n,matrix:a},i)};var t=r("turntable-camera-controller"),d=r("orbit-camera-controller"),m=r("matrix-camera-controller");function p(f,u){this._controllerNames=Object.keys(f),this._controllerList=this._controllerNames.map(function(s){return f[s]}),this._mode=u,this._active=f[u],this._active||(this._mode="turntable",this._active=f.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var e=p.prototype;e.flush=function(f){for(var u=this._controllerList,s=0;s<u.length;++s)u[s].flush(f)},e.idle=function(f){for(var u=this._controllerList,s=0;s<u.length;++s)u[s].idle(f)},e.lookAt=function(f,u,s,l){for(var o=this._controllerList,i=0;i<o.length;++i)o[i].lookAt(f,u,s,l)},e.rotate=function(f,u,s,l){for(var o=this._controllerList,i=0;i<o.length;++i)o[i].rotate(f,u,s,l)},e.pan=function(f,u,s,l){for(var o=this._controllerList,i=0;i<o.length;++i)o[i].pan(f,u,s,l)},e.translate=function(f,u,s,l){for(var o=this._controllerList,i=0;i<o.length;++i)o[i].translate(f,u,s,l)},e.setMatrix=function(f,u){for(var s=this._controllerList,l=0;l<s.length;++l)s[l].setMatrix(f,u)},e.setDistanceLimits=function(f,u){for(var s=this._controllerList,l=0;l<s.length;++l)s[l].setDistanceLimits(f,u)},e.setDistance=function(f,u){for(var s=this._controllerList,l=0;l<s.length;++l)s[l].setDistance(f,u)},e.recalcMatrix=function(f){this._active.recalcMatrix(f)},e.getDistance=function(f){return this._active.getDistance(f)},e.getDistanceLimits=function(f){return this._active.getDistanceLimits(f)},e.lastT=function(){return this._active.lastT()},e.setMode=function(f){if(f!==this._mode){var u=this._controllerNames.indexOf(f);if(!(u<0)){var s=this._active,l=this._controllerList[u],o=Math.max(s.lastT(),l.lastT());s.recalcMatrix(o),l.setMatrix(o,s.computedMatrix),this._active=l,this._mode=f,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},e.getMode=function(){return this._mode}},{"matrix-camera-controller":457,"orbit-camera-controller":478,"turntable-camera-controller":587}],56:[function(r,O,B){(function(t,d){typeof B=="object"&&O!==void 0?d(B,r("d3-array"),r("d3-collection"),r("d3-shape"),r("elementary-circuits-directed-graph")):d(t.d3=t.d3||{},t.d3,t.d3,t.d3,null)})(this,function(t,d,m,p,e){function f(ie){return ie.target.depth}function u(ie,ae){return ie.sourceLinks.length?ie.depth:ae-1}function s(ie){return function(){return ie}}e=e&&e.hasOwnProperty("default")?e.default:e;var l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ie){return typeof ie}:function(ie){return ie&&typeof Symbol=="function"&&ie.constructor===Symbol&&ie!==Symbol.prototype?"symbol":typeof ie};function o(ie,ae){return c(ie.source,ae.source)||ie.index-ae.index}function i(ie,ae){return c(ie.target,ae.target)||ie.index-ae.index}function c(ie,ae){return ie.partOfCycle===ae.partOfCycle?ie.y0-ae.y0:ie.circularLinkType==="top"||ae.circularLinkType==="bottom"?-1:1}function n(ie){return ie.value}function a(ie){return(ie.y0+ie.y1)/2}function g(ie){return a(ie.source)}function h(ie){return a(ie.target)}function y(ie){return ie.index}function v(ie){return ie.nodes}function _(ie){return ie.links}function x(ie,ae){var he=ie.get(ae);if(!he)throw new Error("missing: "+ae);return he}function T(ie,ae){return ae(ie)}function A(ie,ae,he){var se=0;if(he===null){for(var de=[],ue=0;ue<ie.links.length;ue++){var ve=ie.links[ue],ke=ve.source.index,Ee=ve.target.index;de[ke]||(de[ke]=[]),de[Ee]||(de[Ee]=[]),de[ke].indexOf(Ee)===-1&&de[ke].push(Ee)}var be=e(de);be.sort(function(ge,we){return ge.length-we.length});var xe={};for(ue=0;ue<be.length;ue++){var ce=be[ue].slice(-2);xe[ce[0]]||(xe[ce[0]]={}),xe[ce[0]][ce[1]]=!0}ie.links.forEach(function(ge){var we=ge.target.index,Me=ge.source.index;we===Me||xe[Me]&&xe[Me][we]?(ge.circular=!0,ge.circularLinkID=se,se+=1):ge.circular=!1})}else ie.links.forEach(function(ge){ge.source[he]<ge.target[he]?ge.circular=!1:(ge.circular=!0,ge.circularLinkID=se,se+=1)})}function S(ie,ae){var he=0,se=0;ie.links.forEach(function(de){de.circular&&(de.source.circularLinkType||de.target.circularLinkType?de.circularLinkType=de.source.circularLinkType?de.source.circularLinkType:de.target.circularLinkType:de.circularLinkType=he<se?"top":"bottom",de.circularLinkType=="top"?he+=1:se+=1,ie.nodes.forEach(function(ue){T(ue,ae)!=T(de.source,ae)&&T(ue,ae)!=T(de.target,ae)||(ue.circularLinkType=de.circularLinkType)}))}),ie.links.forEach(function(de){de.circular&&(de.source.circularLinkType==de.target.circularLinkType&&(de.circularLinkType=de.source.circularLinkType),Q(de,ae)&&(de.circularLinkType=de.source.circularLinkType))})}function w(ie){var ae=Math.abs(ie.y1-ie.y0),he=Math.abs(ie.target.x0-ie.source.x1);return Math.atan(he/ae)}function C(ie,ae){var he=0;ie.sourceLinks.forEach(function(de){he=de.circular&&!Q(de,ae)?he+1:he});var se=0;return ie.targetLinks.forEach(function(de){se=de.circular&&!Q(de,ae)?se+1:se}),he+se}function k(ie){var ae=ie.source.sourceLinks,he=0;ae.forEach(function(ue){he=ue.circular?he+1:he});var se=ie.target.targetLinks,de=0;return se.forEach(function(ue){de=ue.circular?de+1:de}),!(he>1||de>1)}function L(ie,ae,he){return ie.sort(P),ie.forEach(function(se,de){var ue,ve,ke=0;if(Q(se,he)&&k(se))se.circularPathData.verticalBuffer=ke+se.width/2;else{for(var Ee=0;Ee<de;Ee++)if(ue=ie[de],ve=ie[Ee],!(ue.source.column<ve.target.column||ue.target.column>ve.source.column)){var be=ie[Ee].circularPathData.verticalBuffer+ie[Ee].width/2+ae;ke=be>ke?be:ke}se.circularPathData.verticalBuffer=ke+se.width/2}}),ie}function M(ie,ae,he,se){var de=d.min(ie.links,function(ue){return ue.source.y0});ie.links.forEach(function(ue){ue.circular&&(ue.circularPathData={})}),L(ie.links.filter(function(ue){return ue.circularLinkType=="top"}),ae,se),L(ie.links.filter(function(ue){return ue.circularLinkType=="bottom"}),ae,se),ie.links.forEach(function(ue){if(ue.circular){if(ue.circularPathData.arcRadius=ue.width+10,ue.circularPathData.leftNodeBuffer=5,ue.circularPathData.rightNodeBuffer=5,ue.circularPathData.sourceWidth=ue.source.x1-ue.source.x0,ue.circularPathData.sourceX=ue.source.x0+ue.circularPathData.sourceWidth,ue.circularPathData.targetX=ue.target.x0,ue.circularPathData.sourceY=ue.y0,ue.circularPathData.targetY=ue.y1,Q(ue,se)&&k(ue))ue.circularPathData.leftSmallArcRadius=10+ue.width/2,ue.circularPathData.leftLargeArcRadius=10+ue.width/2,ue.circularPathData.rightSmallArcRadius=10+ue.width/2,ue.circularPathData.rightLargeArcRadius=10+ue.width/2,ue.circularLinkType=="bottom"?(ue.circularPathData.verticalFullExtent=ue.source.y1+25+ue.circularPathData.verticalBuffer,ue.circularPathData.verticalLeftInnerExtent=ue.circularPathData.verticalFullExtent-ue.circularPathData.leftLargeArcRadius,ue.circularPathData.verticalRightInnerExtent=ue.circularPathData.verticalFullExtent-ue.circularPathData.rightLargeArcRadius):(ue.circularPathData.verticalFullExtent=ue.source.y0-25-ue.circularPathData.verticalBuffer,ue.circularPathData.verticalLeftInnerExtent=ue.circularPathData.verticalFullExtent+ue.circularPathData.leftLargeArcRadius,ue.circularPathData.verticalRightInnerExtent=ue.circularPathData.verticalFullExtent+ue.circularPathData.rightLargeArcRadius);else{var ve=ue.source.column,ke=ue.circularLinkType,Ee=ie.links.filter(function(ce){return ce.source.column==ve&&ce.circularLinkType==ke});ue.circularLinkType=="bottom"?Ee.sort(N):Ee.sort(D);var be=0;Ee.forEach(function(ce,ge){ce.circularLinkID==ue.circularLinkID&&(ue.circularPathData.leftSmallArcRadius=10+ue.width/2+be,ue.circularPathData.leftLargeArcRadius=10+ue.width/2+ge*ae+be),be+=ce.width}),ve=ue.target.column,Ee=ie.links.filter(function(ce){return ce.target.column==ve&&ce.circularLinkType==ke}),ue.circularLinkType=="bottom"?Ee.sort(q):Ee.sort(U),be=0,Ee.forEach(function(ce,ge){ce.circularLinkID==ue.circularLinkID&&(ue.circularPathData.rightSmallArcRadius=10+ue.width/2+be,ue.circularPathData.rightLargeArcRadius=10+ue.width/2+ge*ae+be),be+=ce.width}),ue.circularLinkType=="bottom"?(ue.circularPathData.verticalFullExtent=Math.max(he,ue.source.y1,ue.target.y1)+25+ue.circularPathData.verticalBuffer,ue.circularPathData.verticalLeftInnerExtent=ue.circularPathData.verticalFullExtent-ue.circularPathData.leftLargeArcRadius,ue.circularPathData.verticalRightInnerExtent=ue.circularPathData.verticalFullExtent-ue.circularPathData.rightLargeArcRadius):(ue.circularPathData.verticalFullExtent=de-25-ue.circularPathData.verticalBuffer,ue.circularPathData.verticalLeftInnerExtent=ue.circularPathData.verticalFullExtent+ue.circularPathData.leftLargeArcRadius,ue.circularPathData.verticalRightInnerExtent=ue.circularPathData.verticalFullExtent+ue.circularPathData.rightLargeArcRadius)}ue.circularPathData.leftInnerExtent=ue.circularPathData.sourceX+ue.circularPathData.leftNodeBuffer,ue.circularPathData.rightInnerExtent=ue.circularPathData.targetX-ue.circularPathData.rightNodeBuffer,ue.circularPathData.leftFullExtent=ue.circularPathData.sourceX+ue.circularPathData.leftLargeArcRadius+ue.circularPathData.leftNodeBuffer,ue.circularPathData.rightFullExtent=ue.circularPathData.targetX-ue.circularPathData.rightLargeArcRadius-ue.circularPathData.rightNodeBuffer}if(ue.circular)ue.path=function(ce){var ge="";return ge=ce.circularLinkType=="top"?"M"+ce.circularPathData.sourceX+" "+ce.circularPathData.sourceY+" L"+ce.circularPathData.leftInnerExtent+" "+ce.circularPathData.sourceY+" A"+ce.circularPathData.leftLargeArcRadius+" "+ce.circularPathData.leftSmallArcRadius+" 0 0 0 "+ce.circularPathData.leftFullExtent+" "+(ce.circularPathData.sourceY-ce.circularPathData.leftSmallArcRadius)+" L"+ce.circularPathData.leftFullExtent+" "+ce.circularPathData.verticalLeftInnerExtent+" A"+ce.circularPathData.leftLargeArcRadius+" "+ce.circularPathData.leftLargeArcRadius+" 0 0 0 "+ce.circularPathData.leftInnerExtent+" "+ce.circularPathData.verticalFullExtent+" L"+ce.circularPathData.rightInnerExtent+" "+ce.circularPathData.verticalFullExtent+" A"+ce.circularPathData.rightLargeArcRadius+" "+ce.circularPathData.rightLargeArcRadius+" 0 0 0 "+ce.circularPathData.rightFullExtent+" "+ce.circularPathData.verticalRightInnerExtent+" L"+ce.circularPathData.rightFullExtent+" "+(ce.circularPathData.targetY-ce.circularPathData.rightSmallArcRadius)+" A"+ce.circularPathData.rightLargeArcRadius+" "+ce.circularPathData.rightSmallArcRadius+" 0 0 0 "+ce.circularPathData.rightInnerExtent+" "+ce.circularPathData.targetY+" L"+ce.circularPathData.targetX+" "+ce.circularPathData.targetY:"M"+ce.circularPathData.sourceX+" "+ce.circularPathData.sourceY+" L"+ce.circularPathData.leftInnerExtent+" "+ce.circularPathData.sourceY+" A"+ce.circularPathData.leftLargeArcRadius+" "+ce.circularPathData.leftSmallArcRadius+" 0 0 1 "+ce.circularPathData.leftFullExtent+" "+(ce.circularPathData.sourceY+ce.circularPathData.leftSmallArcRadius)+" L"+ce.circularPathData.leftFullExtent+" "+ce.circularPathData.verticalLeftInnerExtent+" A"+ce.circularPathData.leftLargeArcRadius+" "+ce.circularPathData.leftLargeArcRadius+" 0 0 1 "+ce.circularPathData.leftInnerExtent+" "+ce.circularPathData.verticalFullExtent+" L"+ce.circularPathData.rightInnerExtent+" "+ce.circularPathData.verticalFullExtent+" A"+ce.circularPathData.rightLargeArcRadius+" "+ce.circularPathData.rightLargeArcRadius+" 0 0 1 "+ce.circularPathData.rightFullExtent+" "+ce.circularPathData.verticalRightInnerExtent+" L"+ce.circularPathData.rightFullExtent+" "+(ce.circularPathData.targetY+ce.circularPathData.rightSmallArcRadius)+" A"+ce.circularPathData.rightLargeArcRadius+" "+ce.circularPathData.rightSmallArcRadius+" 0 0 1 "+ce.circularPathData.rightInnerExtent+" "+ce.circularPathData.targetY+" L"+ce.circularPathData.targetX+" "+ce.circularPathData.targetY,ge}(ue);else{var xe=p.linkHorizontal().source(function(ce){return[ce.source.x0+(ce.source.x1-ce.source.x0),ce.y0]}).target(function(ce){return[ce.target.x0,ce.y1]});ue.path=xe(ue)}})}function P(ie,ae){return X(ie)==X(ae)?ie.circularLinkType=="bottom"?N(ie,ae):D(ie,ae):X(ae)-X(ie)}function D(ie,ae){return ie.y0-ae.y0}function N(ie,ae){return ae.y0-ie.y0}function U(ie,ae){return ie.y1-ae.y1}function q(ie,ae){return ae.y1-ie.y1}function X(ie){return ie.target.column-ie.source.column}function K(ie){return ie.target.x0-ie.source.x1}function Z(ie,ae){var he=w(ie),se=K(ae)/Math.tan(he);return J(ie)=="up"?ie.y1+se:ie.y1-se}function H(ie,ae){var he=w(ie),se=K(ae)/Math.tan(he);return J(ie)=="up"?ie.y1-se:ie.y1+se}function Y(ie,ae,he,se){ie.links.forEach(function(de){if(!de.circular&&de.target.column-de.source.column>1){var ue=de.source.column+1,ve=de.target.column-1,ke=1,Ee=ve-ue+1;for(ke=1;ue<=ve;ue++,ke++)ie.nodes.forEach(function(be){if(be.column==ue){var xe,ce=ke/(Ee+1),ge=Math.pow(1-ce,3),we=3*ce*Math.pow(1-ce,2),Me=3*Math.pow(ce,2)*(1-ce),Se=Math.pow(ce,3),ze=ge*de.y0+we*de.y0+Me*de.y1+Se*de.y1,Fe=ze-de.width/2,Ye=ze+de.width/2;Fe>be.y0&&Fe<be.y1?(xe=be.y1-Fe+10,xe=be.circularLinkType=="bottom"?xe:-xe,be=z(be,xe,ae,he),ie.nodes.forEach(function(rt){T(rt,se)!=T(be,se)&&rt.column==be.column&&$(be,rt)&&z(rt,xe,ae,he)})):(Ye>be.y0&&Ye<be.y1||Fe<be.y0&&Ye>be.y1)&&(xe=Ye-be.y0+10,be=z(be,xe,ae,he),ie.nodes.forEach(function(rt){T(rt,se)!=T(be,se)&&rt.column==be.column&&rt.y0<be.y1&&rt.y1>be.y1&&z(rt,xe,ae,he)}))}})}})}function $(ie,ae){return ie.y0>ae.y0&&ie.y0<ae.y1||ie.y1>ae.y0&&ie.y1<ae.y1||ie.y0<ae.y0&&ie.y1>ae.y1}function z(ie,ae,he,se){return ie.y0+ae>=he&&ie.y1+ae<=se&&(ie.y0=ie.y0+ae,ie.y1=ie.y1+ae,ie.targetLinks.forEach(function(de){de.y1=de.y1+ae}),ie.sourceLinks.forEach(function(de){de.y0=de.y0+ae})),ie}function j(ie,ae,he,se){ie.nodes.forEach(function(de){se&&de.y+(de.y1-de.y0)>ae&&(de.y=de.y-(de.y+(de.y1-de.y0)-ae));var ue=ie.links.filter(function(Ee){return T(Ee.source,he)==T(de,he)}),ve=ue.length;ve>1&&ue.sort(function(Ee,be){if(!Ee.circular&&!be.circular){if(Ee.target.column==be.target.column||!ee(Ee,be))return Ee.y1-be.y1;if(Ee.target.column>be.target.column){var xe=H(be,Ee);return Ee.y1-xe}if(be.target.column>Ee.target.column)return H(Ee,be)-be.y1}return Ee.circular&&!be.circular?Ee.circularLinkType=="top"?-1:1:be.circular&&!Ee.circular?be.circularLinkType=="top"?1:-1:Ee.circular&&be.circular?Ee.circularLinkType===be.circularLinkType&&Ee.circularLinkType=="top"?Ee.target.column===be.target.column?Ee.target.y1-be.target.y1:be.target.column-Ee.target.column:Ee.circularLinkType===be.circularLinkType&&Ee.circularLinkType=="bottom"?Ee.target.column===be.target.column?be.target.y1-Ee.target.y1:Ee.target.column-be.target.column:Ee.circularLinkType=="top"?-1:1:void 0});var ke=de.y0;ue.forEach(function(Ee){Ee.y0=ke+Ee.width/2,ke+=Ee.width}),ue.forEach(function(Ee,be){if(Ee.circularLinkType=="bottom"){for(var xe=be+1,ce=0;xe<ve;xe++)ce+=ue[xe].width;Ee.y0=de.y1-ce-Ee.width/2}})})}function W(ie,ae,he){ie.nodes.forEach(function(se){var de=ie.links.filter(function(ke){return T(ke.target,he)==T(se,he)}),ue=de.length;ue>1&&de.sort(function(ke,Ee){if(!ke.circular&&!Ee.circular){if(ke.source.column==Ee.source.column||!ee(ke,Ee))return ke.y0-Ee.y0;if(Ee.source.column<ke.source.column){var be=Z(Ee,ke);return ke.y0-be}if(ke.source.column<Ee.source.column)return Z(ke,Ee)-Ee.y0}return ke.circular&&!Ee.circular?ke.circularLinkType=="top"?-1:1:Ee.circular&&!ke.circular?Ee.circularLinkType=="top"?1:-1:ke.circular&&Ee.circular?ke.circularLinkType===Ee.circularLinkType&&ke.circularLinkType=="top"?ke.source.column===Ee.source.column?ke.source.y1-Ee.source.y1:ke.source.column-Ee.source.column:ke.circularLinkType===Ee.circularLinkType&&ke.circularLinkType=="bottom"?ke.source.column===Ee.source.column?ke.source.y1-Ee.source.y1:Ee.source.column-ke.source.column:ke.circularLinkType=="top"?-1:1:void 0});var ve=se.y0;de.forEach(function(ke){ke.y1=ve+ke.width/2,ve+=ke.width}),de.forEach(function(ke,Ee){if(ke.circularLinkType=="bottom"){for(var be=Ee+1,xe=0;be<ue;be++)xe+=de[be].width;ke.y1=se.y1-xe-ke.width/2}})})}function ee(ie,ae){return J(ie)==J(ae)}function J(ie){return ie.y0-ie.y1>0?"up":"down"}function Q(ie,ae){return T(ie.source,ae)==T(ie.target,ae)}function te(ie,ae,he){var se=ie.nodes,de=ie.links,ue=!1,ve=!1;if(de.forEach(function(be){be.circularLinkType=="top"?ue=!0:be.circularLinkType=="bottom"&&(ve=!0)}),ue==0||ve==0){var ke=d.min(se,function(be){return be.y0}),Ee=(he-ae)/(d.max(se,function(be){return be.y1})-ke);se.forEach(function(be){var xe=(be.y1-be.y0)*Ee;be.y0=(be.y0-ke)*Ee,be.y1=be.y0+xe}),de.forEach(function(be){be.y0=(be.y0-ke)*Ee,be.y1=(be.y1-ke)*Ee,be.width=be.width*Ee})}}t.sankeyCircular=function(){var ie,ae,he=0,se=0,de=1,ue=1,ve=24,ke=y,Ee=u,be=v,xe=_,ce=32,ge=2,we=null;function Me(){var Oe={nodes:be.apply(null,arguments),links:xe.apply(null,arguments)};Se(Oe),A(Oe,ke,we),ze(Oe),Fe(Oe),S(Oe,ke),Ye(Oe,ce,ke),rt(Oe);for(var je=4,We=0;We<je;We++)j(Oe,ue,ke),W(Oe,ue,ke),Y(Oe,se,ue,ke),j(Oe,ue,ke),W(Oe,ue,ke);return te(Oe,se,ue),M(Oe,ge,ue,ke),Oe}function Se(Oe){Oe.nodes.forEach(function(We,qe){We.index=qe,We.sourceLinks=[],We.targetLinks=[]});var je=m.map(Oe.nodes,ke);return Oe.links.forEach(function(We,qe){We.index=qe;var Qe=We.source,st=We.target;(Qe===void 0?"undefined":l(Qe))!=="object"&&(Qe=We.source=x(je,Qe)),(st===void 0?"undefined":l(st))!=="object"&&(st=We.target=x(je,st)),Qe.sourceLinks.push(We),st.targetLinks.push(We)}),Oe}function ze(Oe){Oe.nodes.forEach(function(je){je.partOfCycle=!1,je.value=Math.max(d.sum(je.sourceLinks,n),d.sum(je.targetLinks,n)),je.sourceLinks.forEach(function(We){We.circular&&(je.partOfCycle=!0,je.circularLinkType=We.circularLinkType)}),je.targetLinks.forEach(function(We){We.circular&&(je.partOfCycle=!0,je.circularLinkType=We.circularLinkType)})})}function Fe(Oe){var je,We,qe;for(je=Oe.nodes,We=[],qe=0;je.length;++qe,je=We,We=[])je.forEach(function(Qe){Qe.depth=qe,Qe.sourceLinks.forEach(function(st){We.indexOf(st.target)<0&&!st.circular&&We.push(st.target)})});for(je=Oe.nodes,We=[],qe=0;je.length;++qe,je=We,We=[])je.forEach(function(Qe){Qe.height=qe,Qe.targetLinks.forEach(function(st){We.indexOf(st.source)<0&&!st.circular&&We.push(st.source)})});Oe.nodes.forEach(function(Qe){Qe.column=Math.floor(Ee.call(null,Qe,qe))})}function Ye(Oe,je,We){var qe=m.nest().key(function(kt){return kt.column}).sortKeys(d.ascending).entries(Oe.nodes).map(function(kt){return kt.values});(function(kt){if(ae){var at=1/0;qe.forEach(function(tr){var Ue=ue*ae/(tr.length+1);at=Ue<at?Ue:at}),ie=at}var tt=d.min(qe,function(tr){return(ue-se-(tr.length-1)*ie)/d.sum(tr,n)});tt*=.3,Oe.links.forEach(function(tr){tr.width=tr.value*tt});var _t=function(tr){var Ue=0,He=0,Be=0,Ke=0,_e=d.max(tr.nodes,function(Ce){return Ce.column});return tr.links.forEach(function(Ce){Ce.circular&&(Ce.circularLinkType=="top"?Ue+=Ce.width:He+=Ce.width,Ce.target.column==0&&(Ke+=Ce.width),Ce.source.column==_e&&(Be+=Ce.width))}),{top:Ue=Ue>0?Ue+25+10:Ue,bottom:He=He>0?He+25+10:He,left:Ke=Ke>0?Ke+25+10:Ke,right:Be=Be>0?Be+25+10:Be}}(Oe),er=function(tr,Ue){var He=d.max(tr.nodes,function(Le){return Le.column}),Be=de-he,Ke=ue-se,_e=Be/(Be+Ue.right+Ue.left),Ce=Ke/(Ke+Ue.top+Ue.bottom);return he=he*_e+Ue.left,de=Ue.right==0?de:de*_e,se=se*Ce+Ue.top,ue*=Ce,tr.nodes.forEach(function(Le){Le.x0=he+Le.column*((de-he-ve)/He),Le.x1=Le.x0+ve}),Ce}(Oe,_t);tt*=er,Oe.links.forEach(function(tr){tr.width=tr.value*tt}),qe.forEach(function(tr){var Ue=tr.length;tr.forEach(function(He,Be){He.depth==qe.length-1&&Ue==1||He.depth==0&&Ue==1?(He.y0=ue/2-He.value*tt,He.y1=He.y0+He.value*tt):He.partOfCycle?C(He,kt)==0?(He.y0=ue/2+Be,He.y1=He.y0+He.value*tt):He.circularLinkType=="top"?(He.y0=se+Be,He.y1=He.y0+He.value*tt):(He.y0=ue-He.value*tt-Be,He.y1=He.y0+He.value*tt):_t.top==0||_t.bottom==0?(He.y0=(ue-se)/Ue*Be,He.y1=He.y0+He.value*tt):(He.y0=(ue-se)/2-Ue/2+Be,He.y1=He.y0+He.value*tt)})})})(We),Pt();for(var Qe=1,st=je;st>0;--st)ct(Qe*=.99,We),Pt();function ct(kt,at){var tt=qe.length;qe.forEach(function(_t){var er=_t.length,tr=_t[0].depth;_t.forEach(function(Ue){var He;if((Ue.sourceLinks.length||Ue.targetLinks.length)&&!(Ue.partOfCycle&&C(Ue,at)>0))if(tr==0&&er==1)He=Ue.y1-Ue.y0,Ue.y0=ue/2-He/2,Ue.y1=ue/2+He/2;else if(tr==tt-1&&er==1)He=Ue.y1-Ue.y0,Ue.y0=ue/2-He/2,Ue.y1=ue/2+He/2;else{var Be=d.mean(Ue.sourceLinks,h),Ke=d.mean(Ue.targetLinks,g),_e=((Be&&Ke?(Be+Ke)/2:Be||Ke)-a(Ue))*kt;Ue.y0+=_e,Ue.y1+=_e}})})}function Pt(){qe.forEach(function(kt){var at,tt,_t,er=se,tr=kt.length;for(kt.sort(c),_t=0;_t<tr;++_t)(tt=er-(at=kt[_t]).y0)>0&&(at.y0+=tt,at.y1+=tt),er=at.y1+ie;if((tt=er-ie-ue)>0)for(er=at.y0-=tt,at.y1-=tt,_t=tr-2;_t>=0;--_t)(tt=(at=kt[_t]).y1+ie-er)>0&&(at.y0-=tt,at.y1-=tt),er=at.y0})}}function rt(Oe){Oe.nodes.forEach(function(je){je.sourceLinks.sort(i),je.targetLinks.sort(o)}),Oe.nodes.forEach(function(je){var We=je.y0,qe=We,Qe=je.y1,st=Qe;je.sourceLinks.forEach(function(ct){ct.circular?(ct.y0=Qe-ct.width/2,Qe-=ct.width):(ct.y0=We+ct.width/2,We+=ct.width)}),je.targetLinks.forEach(function(ct){ct.circular?(ct.y1=st-ct.width/2,st-=ct.width):(ct.y1=qe+ct.width/2,qe+=ct.width)})})}return Me.nodeId=function(Oe){return arguments.length?(ke=typeof Oe=="function"?Oe:s(Oe),Me):ke},Me.nodeAlign=function(Oe){return arguments.length?(Ee=typeof Oe=="function"?Oe:s(Oe),Me):Ee},Me.nodeWidth=function(Oe){return arguments.length?(ve=+Oe,Me):ve},Me.nodePadding=function(Oe){return arguments.length?(ie=+Oe,Me):ie},Me.nodes=function(Oe){return arguments.length?(be=typeof Oe=="function"?Oe:s(Oe),Me):be},Me.links=function(Oe){return arguments.length?(xe=typeof Oe=="function"?Oe:s(Oe),Me):xe},Me.size=function(Oe){return arguments.length?(he=se=0,de=+Oe[0],ue=+Oe[1],Me):[de-he,ue-se]},Me.extent=function(Oe){return arguments.length?(he=+Oe[0][0],de=+Oe[1][0],se=+Oe[0][1],ue=+Oe[1][1],Me):[[he,se],[de,ue]]},Me.iterations=function(Oe){return arguments.length?(ce=+Oe,Me):ce},Me.circularLinkGap=function(Oe){return arguments.length?(ge=+Oe,Me):ge},Me.nodePaddingRatio=function(Oe){return arguments.length?(ae=+Oe,Me):ae},Me.sortNodes=function(Oe){return arguments.length?(we=Oe,Me):we},Me.update=function(Oe){return S(Oe,ke),rt(Oe),Oe.links.forEach(function(je){je.circular&&(je.circularLinkType=je.y0+je.y1<ue?"top":"bottom",je.source.circularLinkType=je.circularLinkType,je.target.circularLinkType=je.circularLinkType)}),j(Oe,ue,ke,!1),W(Oe,ue,ke),M(Oe,ge,ue,ke),Oe},Me},t.sankeyCenter=function(ie){return ie.targetLinks.length?ie.depth:ie.sourceLinks.length?d.min(ie.sourceLinks,f)-1:0},t.sankeyLeft=function(ie){return ie.depth},t.sankeyRight=function(ie,ae){return ae-1-ie.height},t.sankeyJustify=u,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":159,"d3-collection":160,"d3-shape":171,"elementary-circuits-directed-graph":185}],57:[function(r,O,B){(function(t,d){typeof B=="object"&&O!==void 0?d(B,r("d3-array"),r("d3-collection"),r("d3-shape")):d(t.d3=t.d3||{},t.d3,t.d3,t.d3)})(this,function(t,d,m,p){function e(T){return T.target.depth}function f(T,A){return T.sourceLinks.length?T.depth:A-1}function u(T){return function(){return T}}function s(T,A){return o(T.source,A.source)||T.index-A.index}function l(T,A){return o(T.target,A.target)||T.index-A.index}function o(T,A){return T.y0-A.y0}function i(T){return T.value}function c(T){return(T.y0+T.y1)/2}function n(T){return c(T.source)*T.value}function a(T){return c(T.target)*T.value}function g(T){return T.index}function h(T){return T.nodes}function y(T){return T.links}function v(T,A){var S=T.get(A);if(!S)throw new Error("missing: "+A);return S}function _(T){return[T.source.x1,T.y0]}function x(T){return[T.target.x0,T.y1]}t.sankey=function(){var T=0,A=0,S=1,w=1,C=24,k=8,L=g,M=f,P=h,D=y,N=32;function U(){var Y={nodes:P.apply(null,arguments),links:D.apply(null,arguments)};return q(Y),X(Y),K(Y),Z(Y),H(Y),Y}function q(Y){Y.nodes.forEach(function(z,j){z.index=j,z.sourceLinks=[],z.targetLinks=[]});var $=m.map(Y.nodes,L);Y.links.forEach(function(z,j){z.index=j;var W=z.source,ee=z.target;typeof W!="object"&&(W=z.source=v($,W)),typeof ee!="object"&&(ee=z.target=v($,ee)),W.sourceLinks.push(z),ee.targetLinks.push(z)})}function X(Y){Y.nodes.forEach(function($){$.value=Math.max(d.sum($.sourceLinks,i),d.sum($.targetLinks,i))})}function K(Y){var $,z,j;for($=Y.nodes,z=[],j=0;$.length;++j,$=z,z=[])$.forEach(function(ee){ee.depth=j,ee.sourceLinks.forEach(function(J){z.indexOf(J.target)<0&&z.push(J.target)})});for($=Y.nodes,z=[],j=0;$.length;++j,$=z,z=[])$.forEach(function(ee){ee.height=j,ee.targetLinks.forEach(function(J){z.indexOf(J.source)<0&&z.push(J.source)})});var W=(S-T-C)/(j-1);Y.nodes.forEach(function(ee){ee.x1=(ee.x0=T+Math.max(0,Math.min(j-1,Math.floor(M.call(null,ee,j))))*W)+C})}function Z(Y){var $=m.nest().key(function(Q){return Q.x0}).sortKeys(d.ascending).entries(Y.nodes).map(function(Q){return Q.values});(function(){var Q=d.max($,function(ae){return ae.length}),te=2/3*(w-A)/(Q-1);k>te&&(k=te);var ie=d.min($,function(ae){return(w-A-(ae.length-1)*k)/d.sum(ae,i)});$.forEach(function(ae){ae.forEach(function(he,se){he.y1=(he.y0=se)+he.value*ie})}),Y.links.forEach(function(ae){ae.width=ae.value*ie})})(),J();for(var z=1,j=N;j>0;--j)ee(z*=.99),J(),W(z),J();function W(Q){$.forEach(function(te){te.forEach(function(ie){if(ie.targetLinks.length){var ae=(d.sum(ie.targetLinks,n)/d.sum(ie.targetLinks,i)-c(ie))*Q;ie.y0+=ae,ie.y1+=ae}})})}function ee(Q){$.slice().reverse().forEach(function(te){te.forEach(function(ie){if(ie.sourceLinks.length){var ae=(d.sum(ie.sourceLinks,a)/d.sum(ie.sourceLinks,i)-c(ie))*Q;ie.y0+=ae,ie.y1+=ae}})})}function J(){$.forEach(function(Q){var te,ie,ae,he=A,se=Q.length;for(Q.sort(o),ae=0;ae<se;++ae)(ie=he-(te=Q[ae]).y0)>0&&(te.y0+=ie,te.y1+=ie),he=te.y1+k;if((ie=he-k-w)>0)for(he=te.y0-=ie,te.y1-=ie,ae=se-2;ae>=0;--ae)(ie=(te=Q[ae]).y1+k-he)>0&&(te.y0-=ie,te.y1-=ie),he=te.y0})}}function H(Y){Y.nodes.forEach(function($){$.sourceLinks.sort(l),$.targetLinks.sort(s)}),Y.nodes.forEach(function($){var z=$.y0,j=z;$.sourceLinks.forEach(function(W){W.y0=z+W.width/2,z+=W.width}),$.targetLinks.forEach(function(W){W.y1=j+W.width/2,j+=W.width})})}return U.update=function(Y){return H(Y),Y},U.nodeId=function(Y){return arguments.length?(L=typeof Y=="function"?Y:u(Y),U):L},U.nodeAlign=function(Y){return arguments.length?(M=typeof Y=="function"?Y:u(Y),U):M},U.nodeWidth=function(Y){return arguments.length?(C=+Y,U):C},U.nodePadding=function(Y){return arguments.length?(k=+Y,U):k},U.nodes=function(Y){return arguments.length?(P=typeof Y=="function"?Y:u(Y),U):P},U.links=function(Y){return arguments.length?(D=typeof Y=="function"?Y:u(Y),U):D},U.size=function(Y){return arguments.length?(T=A=0,S=+Y[0],w=+Y[1],U):[S-T,w-A]},U.extent=function(Y){return arguments.length?(T=+Y[0][0],S=+Y[1][0],A=+Y[0][1],w=+Y[1][1],U):[[T,A],[S,w]]},U.iterations=function(Y){return arguments.length?(N=+Y,U):N},U},t.sankeyCenter=function(T){return T.targetLinks.length?T.depth:T.sourceLinks.length?d.min(T.sourceLinks,e)-1:0},t.sankeyLeft=function(T){return T.depth},t.sankeyRight=function(T,A){return A-1-T.height},t.sankeyJustify=f,t.sankeyLinkHorizontal=function(){return p.linkHorizontal().source(_).target(x)},Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":159,"d3-collection":160,"d3-shape":171}],58:[function(r,O,B){(function(){var t={version:"3.8.0"},d=[].slice,m=function(oe){return d.call(oe)},p=self.document;function e(oe){return oe&&(oe.ownerDocument||oe.document||oe).documentElement}function f(oe){return oe&&(oe.ownerDocument&&oe.ownerDocument.defaultView||oe.document&&oe||oe.defaultView)}if(p)try{m(p.documentElement.childNodes)[0].nodeType}catch(oe){m=function(E){for(var R=E.length,F=new Array(R);R--;)F[R]=E[R];return F}}if(Date.now||(Date.now=function(){return+new Date}),p)try{p.createElement("DIV").style.setProperty("opacity",0,"")}catch(oe){var u=this.Element.prototype,s=u.setAttribute,l=u.setAttributeNS,o=this.CSSStyleDeclaration.prototype,i=o.setProperty;u.setAttribute=function(E,R){s.call(this,E,R+"")},u.setAttributeNS=function(E,R,F){l.call(this,E,R,F+"")},o.setProperty=function(E,R,F){i.call(this,E,R+"",F)}}function c(oe,E){return oe<E?-1:oe>E?1:oe>=E?0:NaN}function n(oe){return oe===null?NaN:+oe}function a(oe){return!isNaN(oe)}function g(oe){return{left:function(E,R,F,V){for(arguments.length<3&&(F=0),arguments.length<4&&(V=E.length);F<V;){var ne=F+V>>>1;oe(E[ne],R)<0?F=ne+1:V=ne}return F},right:function(E,R,F,V){for(arguments.length<3&&(F=0),arguments.length<4&&(V=E.length);F<V;){var ne=F+V>>>1;oe(E[ne],R)>0?V=ne:F=ne+1}return F}}}t.ascending=c,t.descending=function(oe,E){return E<oe?-1:E>oe?1:E>=oe?0:NaN},t.min=function(oe,E){var R,F,V=-1,ne=oe.length;if(arguments.length===1){for(;++V<ne;)if((F=oe[V])!=null&&F>=F){R=F;break}for(;++V<ne;)(F=oe[V])!=null&&R>F&&(R=F)}else{for(;++V<ne;)if((F=E.call(oe,oe[V],V))!=null&&F>=F){R=F;break}for(;++V<ne;)(F=E.call(oe,oe[V],V))!=null&&R>F&&(R=F)}return R},t.max=function(oe,E){var R,F,V=-1,ne=oe.length;if(arguments.length===1){for(;++V<ne;)if((F=oe[V])!=null&&F>=F){R=F;break}for(;++V<ne;)(F=oe[V])!=null&&F>R&&(R=F)}else{for(;++V<ne;)if((F=E.call(oe,oe[V],V))!=null&&F>=F){R=F;break}for(;++V<ne;)(F=E.call(oe,oe[V],V))!=null&&F>R&&(R=F)}return R},t.extent=function(oe,E){var R,F,V,ne=-1,le=oe.length;if(arguments.length===1){for(;++ne<le;)if((F=oe[ne])!=null&&F>=F){R=V=F;break}for(;++ne<le;)(F=oe[ne])!=null&&(R>F&&(R=F),V<F&&(V=F))}else{for(;++ne<le;)if((F=E.call(oe,oe[ne],ne))!=null&&F>=F){R=V=F;break}for(;++ne<le;)(F=E.call(oe,oe[ne],ne))!=null&&(R>F&&(R=F),V<F&&(V=F))}return[R,V]},t.sum=function(oe,E){var R,F=0,V=oe.length,ne=-1;if(arguments.length===1)for(;++ne<V;)a(R=+oe[ne])&&(F+=R);else for(;++ne<V;)a(R=+E.call(oe,oe[ne],ne))&&(F+=R);return F},t.mean=function(oe,E){var R,F=0,V=oe.length,ne=-1,le=V;if(arguments.length===1)for(;++ne<V;)a(R=n(oe[ne]))?F+=R:--le;else for(;++ne<V;)a(R=n(E.call(oe,oe[ne],ne)))?F+=R:--le;if(le)return F/le},t.quantile=function(oe,E){var R=(oe.length-1)*E+1,F=Math.floor(R),V=+oe[F-1],ne=R-F;return ne?V+ne*(oe[F]-V):V},t.median=function(oe,E){var R,F=[],V=oe.length,ne=-1;if(arguments.length===1)for(;++ne<V;)a(R=n(oe[ne]))&&F.push(R);else for(;++ne<V;)a(R=n(E.call(oe,oe[ne],ne)))&&F.push(R);if(F.length)return t.quantile(F.sort(c),.5)},t.variance=function(oe,E){var R,F,V=oe.length,ne=0,le=0,pe=-1,ye=0;if(arguments.length===1)for(;++pe<V;)a(R=n(oe[pe]))&&(le+=(F=R-ne)*(R-(ne+=F/++ye)));else for(;++pe<V;)a(R=n(E.call(oe,oe[pe],pe)))&&(le+=(F=R-ne)*(R-(ne+=F/++ye)));if(ye>1)return le/(ye-1)},t.deviation=function(){var oe=t.variance.apply(this,arguments);return oe&&Math.sqrt(oe)};var h=g(c);function y(oe){return oe.length}t.bisectLeft=h.left,t.bisect=t.bisectRight=h.right,t.bisector=function(oe){return g(oe.length===1?function(E,R){return c(oe(E),R)}:oe)},t.shuffle=function(oe,E,R){(ne=arguments.length)<3&&(R=oe.length,ne<2&&(E=0));for(var F,V,ne=R-E;ne;)V=Math.random()*ne--|0,F=oe[ne+E],oe[ne+E]=oe[V+E],oe[V+E]=F;return oe},t.permute=function(oe,E){for(var R=E.length,F=new Array(R);R--;)F[R]=oe[E[R]];return F},t.pairs=function(oe){for(var E=0,R=oe.length-1,F=oe[0],V=new Array(R<0?0:R);E<R;)V[E]=[F,F=oe[++E]];return V},t.transpose=function(oe){if(!(V=oe.length))return[];for(var E=-1,R=t.min(oe,y),F=new Array(R);++E<R;)for(var V,ne=-1,le=F[E]=new Array(V);++ne<V;)le[ne]=oe[ne][E];return F},t.zip=function(){return t.transpose(arguments)},t.keys=function(oe){var E=[];for(var R in oe)E.push(R);return E},t.values=function(oe){var E=[];for(var R in oe)E.push(oe[R]);return E},t.entries=function(oe){var E=[];for(var R in oe)E.push({key:R,value:oe[R]});return E},t.merge=function(oe){for(var E,R,F,V=oe.length,ne=-1,le=0;++ne<V;)le+=oe[ne].length;for(R=new Array(le);--V>=0;)for(E=(F=oe[V]).length;--E>=0;)R[--le]=F[E];return R};var v=Math.abs;function _(oe){for(var E=1;oe*E%1;)E*=10;return E}function x(oe,E){for(var R in E)Object.defineProperty(oe.prototype,R,{value:E[R],enumerable:!1})}function T(){this._=Object.create(null)}t.range=function(oe,E,R){if(arguments.length<3&&(R=1,arguments.length<2&&(E=oe,oe=0)),(E-oe)/R==1/0)throw new Error("infinite range");var F,V=[],ne=_(v(R)),le=-1;if(oe*=ne,E*=ne,(R*=ne)<0)for(;(F=oe+R*++le)>E;)V.push(F/ne);else for(;(F=oe+R*++le)<E;)V.push(F/ne);return V},t.map=function(oe,E){var R=new T;if(oe instanceof T)oe.forEach(function(pe,ye){R.set(pe,ye)});else if(Array.isArray(oe)){var F,V=-1,ne=oe.length;if(arguments.length===1)for(;++V<ne;)R.set(V,oe[V]);else for(;++V<ne;)R.set(E.call(oe,F=oe[V],V),F)}else for(var le in oe)R.set(le,oe[le]);return R};function A(oe){return(oe+="")=="__proto__"||oe[0]==="\0"?"\0"+oe:oe}function S(oe){return(oe+="")[0]==="\0"?oe.slice(1):oe}function w(oe){return A(oe)in this._}function C(oe){return(oe=A(oe))in this._&&delete this._[oe]}function k(){var oe=[];for(var E in this._)oe.push(S(E));return oe}function L(){var oe=0;for(var E in this._)++oe;return oe}function M(){for(var oe in this._)return!1;return!0}function P(){this._=Object.create(null)}function D(oe){return oe}function N(oe,E,R){return function(){var F=R.apply(E,arguments);return F===E?oe:F}}function U(oe,E){if(E in oe)return E;E=E.charAt(0).toUpperCase()+E.slice(1);for(var R=0,F=q.length;R<F;++R){var V=q[R]+E;if(V in oe)return V}}x(T,{has:w,get:function(oe){return this._[A(oe)]},set:function(oe,E){return this._[A(oe)]=E},remove:C,keys:k,values:function(){var oe=[];for(var E in this._)oe.push(this._[E]);return oe},entries:function(){var oe=[];for(var E in this._)oe.push({key:S(E),value:this._[E]});return oe},size:L,empty:M,forEach:function(oe){for(var E in this._)oe.call(this,S(E),this._[E])}}),t.nest=function(){var oe,E,R={},F=[],V=[];function ne(le,pe,ye){if(ye>=F.length)return E?E.call(R,pe):oe?pe.sort(oe):pe;for(var Te,Ne,Ge,nt,bt=-1,Ct=pe.length,Tt=F[ye++],At=new T;++bt<Ct;)(nt=At.get(Te=Tt(Ne=pe[bt])))?nt.push(Ne):At.set(Te,[Ne]);return le?(Ne=le(),Ge=function(yt,Ft){Ne.set(yt,ne(le,Ft,ye))}):(Ne={},Ge=function(yt,Ft){Ne[yt]=ne(le,Ft,ye)}),At.forEach(Ge),Ne}return R.map=function(le,pe){return ne(pe,le,0)},R.entries=function(le){return function pe(ye,Te){if(Te>=F.length)return ye;var Ne=[],Ge=V[Te++];return ye.forEach(function(nt,bt){Ne.push({key:nt,values:pe(bt,Te)})}),Ge?Ne.sort(function(nt,bt){return Ge(nt.key,bt.key)}):Ne}(ne(t.map,le,0),0)},R.key=function(le){return F.push(le),R},R.sortKeys=function(le){return V[F.length-1]=le,R},R.sortValues=function(le){return oe=le,R},R.rollup=function(le){return E=le,R},R},t.set=function(oe){var E=new P;if(oe)for(var R=0,F=oe.length;R<F;++R)E.add(oe[R]);return E},x(P,{has:w,add:function(oe){return this._[A(oe+="")]=!0,oe},remove:C,values:k,size:L,empty:M,forEach:function(oe){for(var E in this._)oe.call(this,S(E))}}),t.behavior={},t.rebind=function(oe,E){for(var R,F=1,V=arguments.length;++F<V;)oe[R=arguments[F]]=N(oe,E,E[R]);return oe};var q=["webkit","ms","moz","Moz","o","O"];function X(){}function K(){}function Z(oe){var E=[],R=new T;function F(){for(var V,ne=E,le=-1,pe=ne.length;++le<pe;)(V=ne[le].on)&&V.apply(this,arguments);return oe}return F.on=function(V,ne){var le,pe=R.get(V);return arguments.length<2?pe&&pe.on:(pe&&(pe.on=null,E=E.slice(0,le=E.indexOf(pe)).concat(E.slice(le+1)),R.remove(V)),ne&&E.push(R.set(V,{on:ne})),oe)},F}function H(){t.event.preventDefault()}function Y(){for(var oe,E=t.event;oe=E.sourceEvent;)E=oe;return E}function $(oe){for(var E=new K,R=0,F=arguments.length;++R<F;)E[arguments[R]]=Z(E);return E.of=function(V,ne){return function(le){try{var pe=le.sourceEvent=t.event;le.target=oe,t.event=le,E[le.type].apply(V,ne)}finally{t.event=pe}}},E}t.dispatch=function(){for(var oe=new K,E=-1,R=arguments.length;++E<R;)oe[arguments[E]]=Z(oe);return oe},K.prototype.on=function(oe,E){var R=oe.indexOf("."),F="";if(R>=0&&(F=oe.slice(R+1),oe=oe.slice(0,R)),oe)return arguments.length<2?this[oe].on(F):this[oe].on(F,E);if(arguments.length===2){if(E==null)for(oe in this)this.hasOwnProperty(oe)&&this[oe].on(F,null);return this}},t.event=null,t.requote=function(oe){return oe.replace(z,"\\$&")};var z=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,j=function(oe,E){for(var R in E)oe[R]=E[R]};function W(oe){return j(oe,te),oe}var ee=function(oe,E){return E.querySelector(oe)},J=function(oe,E){return E.querySelectorAll(oe)},Q=function(oe,E){var R=oe.matches||oe[U(oe,"matchesSelector")];return(Q=function(F,V){return R.call(F,V)})(oe,E)};typeof Sizzle=="function"&&(ee=function(oe,E){return Sizzle(oe,E)[0]||null},J=Sizzle,Q=Sizzle.matchesSelector),t.selection=function(){return t.select(p.documentElement)};var te=t.selection.prototype=[];function ie(oe){return typeof oe=="function"?oe:function(){return ee(oe,this)}}function ae(oe){return typeof oe=="function"?oe:function(){return J(oe,this)}}te.select=function(oe){var E,R,F,V,ne=[];oe=ie(oe);for(var le=-1,pe=this.length;++le<pe;){ne.push(E=[]),E.parentNode=(F=this[le]).parentNode;for(var ye=-1,Te=F.length;++ye<Te;)(V=F[ye])?(E.push(R=oe.call(V,V.__data__,ye,le)),R&&"__data__"in V&&(R.__data__=V.__data__)):E.push(null)}return W(ne)},te.selectAll=function(oe){var E,R,F=[];oe=ae(oe);for(var V=-1,ne=this.length;++V<ne;)for(var le=this[V],pe=-1,ye=le.length;++pe<ye;)(R=le[pe])&&(F.push(E=m(oe.call(R,R.__data__,pe,V))),E.parentNode=R);return W(F)};var he="http://www.w3.org/1999/xhtml",se={svg:"http://www.w3.org/2000/svg",xhtml:he,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function de(oe,E){return oe=t.ns.qualify(oe),E==null?oe.local?function(){this.removeAttributeNS(oe.space,oe.local)}:function(){this.removeAttribute(oe)}:typeof E=="function"?oe.local?function(){var R=E.apply(this,arguments);R==null?this.removeAttributeNS(oe.space,oe.local):this.setAttributeNS(oe.space,oe.local,R)}:function(){var R=E.apply(this,arguments);R==null?this.removeAttribute(oe):this.setAttribute(oe,R)}:oe.local?function(){this.setAttributeNS(oe.space,oe.local,E)}:function(){this.setAttribute(oe,E)}}function ue(oe){return oe.trim().replace(/\s+/g," ")}function ve(oe){return new RegExp("(?:^|\\s+)"+t.requote(oe)+"(?:\\s+|$)","g")}function ke(oe){return(oe+"").trim().split(/^|\s+/)}function Ee(oe,E){var R=(oe=ke(oe).map(be)).length;return typeof E=="function"?function(){for(var F=-1,V=E.apply(this,arguments);++F<R;)oe[F](this,V)}:function(){for(var F=-1;++F<R;)oe[F](this,E)}}function be(oe){var E=ve(oe);return function(R,F){if(V=R.classList)return F?V.add(oe):V.remove(oe);var V=R.getAttribute("class")||"";F?(E.lastIndex=0,E.test(V)||R.setAttribute("class",ue(V+" "+oe))):R.setAttribute("class",ue(V.replace(E," ")))}}function xe(oe,E,R){return E==null?function(){this.style.removeProperty(oe)}:typeof E=="function"?function(){var F=E.apply(this,arguments);F==null?this.style.removeProperty(oe):this.style.setProperty(oe,F,R)}:function(){this.style.setProperty(oe,E,R)}}function ce(oe,E){return E==null?function(){delete this[oe]}:typeof E=="function"?function(){var R=E.apply(this,arguments);R==null?delete this[oe]:this[oe]=R}:function(){this[oe]=E}}function ge(oe){return typeof oe=="function"?oe:(oe=t.ns.qualify(oe)).local?function(){return this.ownerDocument.createElementNS(oe.space,oe.local)}:function(){var E=this.ownerDocument,R=this.namespaceURI;return R===he&&E.documentElement.namespaceURI===he?E.createElement(oe):E.createElementNS(R,oe)}}function we(){var oe=this.parentNode;oe&&oe.removeChild(this)}function Me(oe){return{__data__:oe}}function Se(oe){return function(){return Q(this,oe)}}function ze(oe){return arguments.length||(oe=c),function(E,R){return E&&R?oe(E.__data__,R.__data__):!E-!R}}function Fe(oe,E){for(var R=0,F=oe.length;R<F;R++)for(var V,ne=oe[R],le=0,pe=ne.length;le<pe;le++)(V=ne[le])&&E(V,le,R);return oe}function Ye(oe){return j(oe,rt),oe}t.ns={prefix:se,qualify:function(oe){var E=oe.indexOf(":"),R=oe;return E>=0&&(R=oe.slice(0,E))!=="xmlns"&&(oe=oe.slice(E+1)),se.hasOwnProperty(R)?{space:se[R],local:oe}:oe}},te.attr=function(oe,E){if(arguments.length<2){if(typeof oe=="string"){var R=this.node();return(oe=t.ns.qualify(oe)).local?R.getAttributeNS(oe.space,oe.local):R.getAttribute(oe)}for(E in oe)this.each(de(E,oe[E]));return this}return this.each(de(oe,E))},te.classed=function(oe,E){if(arguments.length<2){if(typeof oe=="string"){var R=this.node(),F=(oe=ke(oe)).length,V=-1;if(E=R.classList){for(;++V<F;)if(!E.contains(oe[V]))return!1}else for(E=R.getAttribute("class");++V<F;)if(!ve(oe[V]).test(E))return!1;return!0}for(E in oe)this.each(Ee(E,oe[E]));return this}return this.each(Ee(oe,E))},te.style=function(oe,E,R){var F=arguments.length;if(F<3){if(typeof oe!="string"){for(R in F<2&&(E=""),oe)this.each(xe(R,oe[R],E));return this}if(F<2){var V=this.node();return f(V).getComputedStyle(V,null).getPropertyValue(oe)}R=""}return this.each(xe(oe,E,R))},te.property=function(oe,E){if(arguments.length<2){if(typeof oe=="string")return this.node()[oe];for(E in oe)this.each(ce(E,oe[E]));return this}return this.each(ce(oe,E))},te.text=function(oe){return arguments.length?this.each(typeof oe=="function"?function(){var E=oe.apply(this,arguments);this.textContent=E==null?"":E}:oe==null?function(){this.textContent=""}:function(){this.textContent=oe}):this.node().textContent},te.html=function(oe){return arguments.length?this.each(typeof oe=="function"?function(){var E=oe.apply(this,arguments);this.innerHTML=E==null?"":E}:oe==null?function(){this.innerHTML=""}:function(){this.innerHTML=oe}):this.node().innerHTML},te.append=function(oe){return oe=ge(oe),this.select(function(){return this.appendChild(oe.apply(this,arguments))})},te.insert=function(oe,E){return oe=ge(oe),E=ie(E),this.select(function(){return this.insertBefore(oe.apply(this,arguments),E.apply(this,arguments)||null)})},te.remove=function(){return this.each(we)},te.data=function(oe,E){var R,F,V=-1,ne=this.length;if(!arguments.length){for(oe=new Array(ne=(R=this[0]).length);++V<ne;)(F=R[V])&&(oe[V]=F.__data__);return oe}function le(Ne,Ge){var nt,bt,Ct,Tt=Ne.length,At=Ge.length,yt=Math.min(Tt,At),Ft=new Array(At),zt=new Array(At),jt=new Array(Tt);if(E){var rr,hr=new T,Ar=new Array(Tt);for(nt=-1;++nt<Tt;)(bt=Ne[nt])&&(hr.has(rr=E.call(bt,bt.__data__,nt))?jt[nt]=bt:hr.set(rr,bt),Ar[nt]=rr);for(nt=-1;++nt<At;)(bt=hr.get(rr=E.call(Ge,Ct=Ge[nt],nt)))?bt!==!0&&(Ft[nt]=bt,bt.__data__=Ct):zt[nt]=Me(Ct),hr.set(rr,!0);for(nt=-1;++nt<Tt;)nt in Ar&&hr.get(Ar[nt])!==!0&&(jt[nt]=Ne[nt])}else{for(nt=-1;++nt<yt;)bt=Ne[nt],Ct=Ge[nt],bt?(bt.__data__=Ct,Ft[nt]=bt):zt[nt]=Me(Ct);for(;nt<At;++nt)zt[nt]=Me(Ge[nt]);for(;nt<Tt;++nt)jt[nt]=Ne[nt]}zt.update=Ft,zt.parentNode=Ft.parentNode=jt.parentNode=Ne.parentNode,pe.push(zt),ye.push(Ft),Te.push(jt)}var pe=Ye([]),ye=W([]),Te=W([]);if(typeof oe=="function")for(;++V<ne;)le(R=this[V],oe.call(R,R.parentNode.__data__,V));else for(;++V<ne;)le(R=this[V],oe);return ye.enter=function(){return pe},ye.exit=function(){return Te},ye},te.datum=function(oe){return arguments.length?this.property("__data__",oe):this.property("__data__")},te.filter=function(oe){var E,R,F,V=[];typeof oe!="function"&&(oe=Se(oe));for(var ne=0,le=this.length;ne<le;ne++){V.push(E=[]),E.parentNode=(R=this[ne]).parentNode;for(var pe=0,ye=R.length;pe<ye;pe++)(F=R[pe])&&oe.call(F,F.__data__,pe,ne)&&E.push(F)}return W(V)},te.order=function(){for(var oe=-1,E=this.length;++oe<E;)for(var R,F=this[oe],V=F.length-1,ne=F[V];--V>=0;)(R=F[V])&&(ne&&ne!==R.nextSibling&&ne.parentNode.insertBefore(R,ne),ne=R);return this},te.sort=function(oe){oe=ze.apply(this,arguments);for(var E=-1,R=this.length;++E<R;)this[E].sort(oe);return this.order()},te.each=function(oe){return Fe(this,function(E,R,F){oe.call(E,E.__data__,R,F)})},te.call=function(oe){var E=m(arguments);return oe.apply(E[0]=this,E),this},te.empty=function(){return!this.node()},te.node=function(){for(var oe=0,E=this.length;oe<E;oe++)for(var R=this[oe],F=0,V=R.length;F<V;F++){var ne=R[F];if(ne)return ne}return null},te.size=function(){var oe=0;return Fe(this,function(){++oe}),oe};var rt=[];function Oe(oe){var E,R;return function(F,V,ne){var le,pe=oe[ne].update,ye=pe.length;for(ne!=R&&(R=ne,E=0),V>=E&&(E=V+1);!(le=pe[E])&&++E<ye;);return le}}function je(oe,E,R){var F="__on"+oe,V=oe.indexOf("."),ne=qe;V>0&&(oe=oe.slice(0,V));var le=We.get(oe);function pe(){var ye=this[F];ye&&(this.removeEventListener(oe,ye,ye.$),delete this[F])}return le&&(oe=le,ne=Qe),V?E?function(){var ye=ne(E,m(arguments));pe.call(this),this.addEventListener(oe,this[F]=ye,ye.$=R),ye._=E}:pe:E?X:function(){var ye,Te=new RegExp("^__on([^.]+)"+t.requote(oe)+"$");for(var Ne in this)if(ye=Ne.match(Te)){var Ge=this[Ne];this.removeEventListener(ye[1],Ge,Ge.$),delete this[Ne]}}}t.selection.enter=Ye,t.selection.enter.prototype=rt,rt.append=te.append,rt.empty=te.empty,rt.node=te.node,rt.call=te.call,rt.size=te.size,rt.select=function(oe){for(var E,R,F,V,ne,le=[],pe=-1,ye=this.length;++pe<ye;){F=(V=this[pe]).update,le.push(E=[]),E.parentNode=V.parentNode;for(var Te=-1,Ne=V.length;++Te<Ne;)(ne=V[Te])?(E.push(F[Te]=R=oe.call(V.parentNode,ne.__data__,Te,pe)),R.__data__=ne.__data__):E.push(null)}return W(le)},rt.insert=function(oe,E){return arguments.length<2&&(E=Oe(this)),te.insert.call(this,oe,E)},t.select=function(oe){var E;return typeof oe=="string"?(E=[ee(oe,p)]).parentNode=p.documentElement:(E=[oe]).parentNode=e(oe),W([E])},t.selectAll=function(oe){var E;return typeof oe=="string"?(E=m(J(oe,p))).parentNode=p.documentElement:(E=m(oe)).parentNode=null,W([E])},te.on=function(oe,E,R){var F=arguments.length;if(F<3){if(typeof oe!="string"){for(R in F<2&&(E=!1),oe)this.each(je(R,oe[R],E));return this}if(F<2)return(F=this.node()["__on"+oe])&&F._;R=!1}return this.each(je(oe,E,R))};var We=t.map({mouseenter:"mouseover",mouseleave:"mouseout"});function qe(oe,E){return function(R){var F=t.event;t.event=R,E[0]=this.__data__;try{oe.apply(this,E)}finally{t.event=F}}}function Qe(oe,E){var R=qe(oe,E);return function(F){var V=F.relatedTarget;V&&(V===this||8&V.compareDocumentPosition(this))||R.call(this,F)}}p&&We.forEach(function(oe){"on"+oe in p&&We.remove(oe)});var st,ct=0;function Pt(oe){var E=".dragsuppress-"+ ++ct,R="click"+E,F=t.select(f(oe)).on("touchmove"+E,H).on("dragstart"+E,H).on("selectstart"+E,H);if(st==null&&(st=!("onselectstart"in oe)&&U(oe.style,"userSelect")),st){var V=e(oe).style,ne=V[st];V[st]="none"}return function(le){if(F.on(E,null),st&&(V[st]=ne),le){var pe=function(){F.on(R,null)};F.on(R,function(){H(),pe()},!0),setTimeout(pe,0)}}}t.mouse=function(oe){return at(oe,Y())};var kt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function at(oe,E){E.changedTouches&&(E=E.changedTouches[0]);var R=oe.ownerSVGElement||oe;if(R.createSVGPoint){var F=R.createSVGPoint();if(kt<0){var V=f(oe);if(V.scrollX||V.scrollY){var ne=(R=t.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();kt=!(ne.f||ne.e),R.remove()}}return kt?(F.x=E.pageX,F.y=E.pageY):(F.x=E.clientX,F.y=E.clientY),[(F=F.matrixTransform(oe.getScreenCTM().inverse())).x,F.y]}var le=oe.getBoundingClientRect();return[E.clientX-le.left-oe.clientLeft,E.clientY-le.top-oe.clientTop]}function tt(){return t.event.changedTouches[0].identifier}t.touch=function(oe,E,R){if(arguments.length<3&&(R=E,E=Y().changedTouches),E){for(var F,V=0,ne=E.length;V<ne;++V)if((F=E[V]).identifier===R)return at(oe,F)}},t.behavior.drag=function(){var oe=$(V,"drag","dragstart","dragend"),E=null,R=ne(X,t.mouse,f,"mousemove","mouseup"),F=ne(tt,t.touch,D,"touchmove","touchend");function V(){this.on("mousedown.drag",R).on("touchstart.drag",F)}function ne(le,pe,ye,Te,Ne){return function(){var Ge,nt=this,bt=t.event.target.correspondingElement||t.event.target,Ct=nt.parentNode,Tt=oe.of(nt,arguments),At=0,yt=le(),Ft=".drag"+(yt==null?"":"-"+yt),zt=t.select(ye(bt)).on(Te+Ft,hr).on(Ne+Ft,Ar),jt=Pt(bt),rr=pe(Ct,yt);function hr(){var kr,Kr,Zr=pe(Ct,yt);Zr&&(kr=Zr[0]-rr[0],Kr=Zr[1]-rr[1],At|=kr|Kr,rr=Zr,Tt({type:"drag",x:Zr[0]+Ge[0],y:Zr[1]+Ge[1],dx:kr,dy:Kr}))}function Ar(){pe(Ct,yt)&&(zt.on(Te+Ft,null).on(Ne+Ft,null),jt(At),Tt({type:"dragend"}))}Ge=E?[(Ge=E.apply(nt,arguments)).x-rr[0],Ge.y-rr[1]]:[0,0],Tt({type:"dragstart"})}}return V.origin=function(le){return arguments.length?(E=le,V):E},t.rebind(V,oe,"on")},t.touches=function(oe,E){return arguments.length<2&&(E=Y().touches),E?m(E).map(function(R){var F=at(oe,R);return F.identifier=R.identifier,F}):[]};var _t=1e-6,er=Math.PI,tr=2*er,Ue=tr-_t,He=er/2,Be=er/180,Ke=180/er;function _e(oe){return oe>1?He:oe<-1?-He:Math.asin(oe)}function Ce(oe){return((oe=Math.exp(oe))+1/oe)/2}var Le=Math.SQRT2;t.interpolateZoom=function(oe,E){var R,F,V=oe[0],ne=oe[1],le=oe[2],pe=E[0],ye=E[1],Te=E[2],Ne=pe-V,Ge=ye-ne,nt=Ne*Ne+Ge*Ge;if(nt<1e-12)F=Math.log(Te/le)/Le,R=function(Ft){return[V+Ft*Ne,ne+Ft*Ge,le*Math.exp(Le*Ft*F)]};else{var bt=Math.sqrt(nt),Ct=(Te*Te-le*le+4*nt)/(2*le*2*bt),Tt=(Te*Te-le*le-4*nt)/(2*Te*2*bt),At=Math.log(Math.sqrt(Ct*Ct+1)-Ct),yt=Math.log(Math.sqrt(Tt*Tt+1)-Tt);F=(yt-At)/Le,R=function(Ft){var zt,jt=Ft*F,rr=Ce(At),hr=le/(2*bt)*(rr*(zt=Le*jt+At,((zt=Math.exp(2*zt))-1)/(zt+1))-function(Ar){return((Ar=Math.exp(Ar))-1/Ar)/2}(At));return[V+hr*Ne,ne+hr*Ge,le*rr/Ce(Le*jt+At)]}}return R.duration=1e3*F,R},t.behavior.zoom=function(){var oe,E,R,F,V,ne,le,pe,ye,Te={x:0,y:0,k:1},Ne=[960,500],Ge=ht,nt=250,bt=0,Ct="mousedown.zoom",Tt="mousemove.zoom",At="mouseup.zoom",yt="touchstart.zoom",Ft=$(zt,"zoomstart","zoom","zoomend");function zt(Ur){Ur.on(Ct,sn).on(Xe+".zoom",Wn).on("dblclick.zoom",ua).on(yt,Un)}function jt(Ur){return[(Ur[0]-Te.x)/Te.k,(Ur[1]-Te.y)/Te.k]}function rr(Ur){Te.k=Math.max(Ge[0],Math.min(Ge[1],Ur))}function hr(Ur,kn){kn=function(Xn){return[Xn[0]*Te.k+Te.x,Xn[1]*Te.k+Te.y]}(kn),Te.x+=Ur[0]-kn[0],Te.y+=Ur[1]-kn[1]}function Ar(Ur,kn,Xn,Gn){Ur.__chart__={x:Te.x,y:Te.y,k:Te.k},rr(Math.pow(2,Gn)),hr(E=kn,Xn),Ur=t.select(Ur),nt>0&&(Ur=Ur.transition().duration(nt)),Ur.call(zt.event)}function kr(){le&&le.domain(ne.range().map(function(Ur){return(Ur-Te.x)/Te.k}).map(ne.invert)),ye&&ye.domain(pe.range().map(function(Ur){return(Ur-Te.y)/Te.k}).map(pe.invert))}function Kr(Ur){bt++||Ur({type:"zoomstart"})}function Zr(Ur){kr(),Ur({type:"zoom",scale:Te.k,translate:[Te.x,Te.y]})}function hn(Ur){--bt||(Ur({type:"zoomend"}),E=null)}function sn(){var Ur=this,kn=Ft.of(Ur,arguments),Xn=0,Gn=t.select(f(Ur)).on(Tt,Ma).on(At,Kn),ea=jt(t.mouse(Ur)),fa=Pt(Ur);function Ma(){Xn=1,hr(t.mouse(Ur),ea),Zr(kn)}function Kn(){Gn.on(Tt,null).on(At,null),fa(Xn),hn(kn)}$s.call(Ur),Kr(kn)}function Un(){var Ur,kn=this,Xn=Ft.of(kn,arguments),Gn={},ea=0,fa=".zoom-"+t.event.changedTouches[0].identifier,Ma="touchmove"+fa,Kn="touchend"+fa,xa=[],ma=t.select(kn),La=Pt(kn);function ba(){var zi=t.touches(kn);return Ur=Te.k,zi.forEach(function(Ri){Ri.identifier in Gn&&(Gn[Ri.identifier]=jt(Ri))}),zi}function Pa(){var zi=t.event.target;t.select(zi).on(Ma,Ua).on(Kn,di),xa.push(zi);for(var Ri=t.event.changedTouches,pi=0,Ei=Ri.length;pi<Ei;++pi)Gn[Ri[pi].identifier]=null;var xi=ba(),Lo=Date.now();if(xi.length===1){if(Lo-V<500){var Ki=xi[0];Ar(kn,Ki,Gn[Ki.identifier],Math.floor(Math.log(Te.k)/Math.LN2)+1),H()}V=Lo}else if(xi.length>1){Ki=xi[0];var Zo=xi[1],qs=Ki[0]-Zo[0],yl=Ki[1]-Zo[1];ea=qs*qs+yl*yl}}function Ua(){var zi,Ri,pi,Ei,xi=t.touches(kn);$s.call(kn);for(var Lo=0,Ki=xi.length;Lo<Ki;++Lo,Ei=null)if(pi=xi[Lo],Ei=Gn[pi.identifier]){if(Ri)break;zi=pi,Ri=Ei}if(Ei){var Zo=(Zo=pi[0]-zi[0])*Zo+(Zo=pi[1]-zi[1])*Zo,qs=ea&&Math.sqrt(Zo/ea);zi=[(zi[0]+pi[0])/2,(zi[1]+pi[1])/2],Ri=[(Ri[0]+Ei[0])/2,(Ri[1]+Ei[1])/2],rr(qs*Ur)}V=null,hr(zi,Ri),Zr(Xn)}function di(){if(t.event.touches.length){for(var zi=t.event.changedTouches,Ri=0,pi=zi.length;Ri<pi;++Ri)delete Gn[zi[Ri].identifier];for(var Ei in Gn)return void ba()}t.selectAll(xa).on(fa,null),ma.on(Ct,sn).on(yt,Un),La(),hn(Xn)}Pa(),Kr(Xn),ma.on(Ct,null).on(yt,Pa)}function Wn(){var Ur=Ft.of(this,arguments);F?clearTimeout(F):($s.call(this),oe=jt(E=R||t.mouse(this)),Kr(Ur)),F=setTimeout(function(){F=null,hn(Ur)},50),H(),rr(Math.pow(2,.002*Pe())*Te.k),hr(E,oe),Zr(Ur)}function ua(){var Ur=t.mouse(this),kn=Math.log(Te.k)/Math.LN2;Ar(this,Ur,jt(Ur),t.event.shiftKey?Math.ceil(kn)-1:Math.floor(kn)+1)}return Xe||(Xe="onwheel"in p?(Pe=function(){return-t.event.deltaY*(t.event.deltaMode?120:1)},"wheel"):"onmousewheel"in p?(Pe=function(){return t.event.wheelDelta},"mousewheel"):(Pe=function(){return-t.event.detail},"MozMousePixelScroll")),zt.event=function(Ur){Ur.each(function(){var kn=Ft.of(this,arguments),Xn=Te;Rs?t.select(this).transition().each("start.zoom",function(){Te=this.__chart__||{x:0,y:0,k:1},Kr(kn)}).tween("zoom:zoom",function(){var Gn=Ne[0],ea=Ne[1],fa=E?E[0]:Gn/2,Ma=E?E[1]:ea/2,Kn=t.interpolateZoom([(fa-Te.x)/Te.k,(Ma-Te.y)/Te.k,Gn/Te.k],[(fa-Xn.x)/Xn.k,(Ma-Xn.y)/Xn.k,Gn/Xn.k]);return function(xa){var ma=Kn(xa),La=Gn/ma[2];this.__chart__=Te={x:fa-ma[0]*La,y:Ma-ma[1]*La,k:La},Zr(kn)}}).each("interrupt.zoom",function(){hn(kn)}).each("end.zoom",function(){hn(kn)}):(this.__chart__=Te,Kr(kn),Zr(kn),hn(kn))})},zt.translate=function(Ur){return arguments.length?(Te={x:+Ur[0],y:+Ur[1],k:Te.k},kr(),zt):[Te.x,Te.y]},zt.scale=function(Ur){return arguments.length?(Te={x:Te.x,y:Te.y,k:null},rr(+Ur),kr(),zt):Te.k},zt.scaleExtent=function(Ur){return arguments.length?(Ge=Ur==null?ht:[+Ur[0],+Ur[1]],zt):Ge},zt.center=function(Ur){return arguments.length?(R=Ur&&[+Ur[0],+Ur[1]],zt):R},zt.size=function(Ur){return arguments.length?(Ne=Ur&&[+Ur[0],+Ur[1]],zt):Ne},zt.duration=function(Ur){return arguments.length?(nt=+Ur,zt):nt},zt.x=function(Ur){return arguments.length?(le=Ur,ne=Ur.copy(),Te={x:0,y:0,k:1},zt):le},zt.y=function(Ur){return arguments.length?(ye=Ur,pe=Ur.copy(),Te={x:0,y:0,k:1},zt):ye},t.rebind(zt,Ft,"on")};var Pe,Xe,ht=[0,1/0];function Mt(){}function pt(oe,E,R){return this instanceof pt?(this.h=+oe,this.s=+E,void(this.l=+R)):arguments.length<2?oe instanceof pt?new pt(oe.h,oe.s,oe.l):dr(""+oe,vr,pt):new pt(oe,E,R)}t.color=Mt,Mt.prototype.toString=function(){return this.rgb()+""},t.hsl=pt;var Lt=pt.prototype=new Mt;function vt(oe,E,R){var F,V;function ne(le){return Math.round(255*function(pe){return pe>360?pe-=360:pe<0&&(pe+=360),pe<60?F+(V-F)*pe/60:pe<180?V:pe<240?F+(V-F)*(240-pe)/60:F}(le))}return oe=isNaN(oe)?0:(oe%=360)<0?oe+360:oe,E=isNaN(E)||E<0?0:E>1?1:E,F=2*(R=R<0?0:R>1?1:R)-(V=R<=.5?R*(1+E):R+E-R*E),new Gt(ne(oe+120),ne(oe),ne(oe-120))}function Dt(oe,E,R){return this instanceof Dt?(this.h=+oe,this.c=+E,void(this.l=+R)):arguments.length<2?oe instanceof Dt?new Dt(oe.h,oe.c,oe.l):Ie(oe instanceof St?oe.l:(oe=ur((oe=t.rgb(oe)).r,oe.g,oe.b)).l,oe.a,oe.b):new Dt(oe,E,R)}Lt.brighter=function(oe){return oe=Math.pow(.7,arguments.length?oe:1),new pt(this.h,this.s,this.l/oe)},Lt.darker=function(oe){return oe=Math.pow(.7,arguments.length?oe:1),new pt(this.h,this.s,oe*this.l)},Lt.rgb=function(){return vt(this.h,this.s,this.l)},t.hcl=Dt;var xt=Dt.prototype=new Mt;function it(oe,E,R){return isNaN(oe)&&(oe=0),isNaN(E)&&(E=0),new St(R,Math.cos(oe*=Be)*E,Math.sin(oe)*E)}function St(oe,E,R){return this instanceof St?(this.l=+oe,this.a=+E,void(this.b=+R)):arguments.length<2?oe instanceof St?new St(oe.l,oe.a,oe.b):oe instanceof Dt?it(oe.h,oe.c,oe.l):ur((oe=Gt(oe)).r,oe.g,oe.b):new St(oe,E,R)}xt.brighter=function(oe){return new Dt(this.h,this.c,Math.min(100,this.l+Nt*(arguments.length?oe:1)))},xt.darker=function(oe){return new Dt(this.h,this.c,Math.max(0,this.l-Nt*(arguments.length?oe:1)))},xt.rgb=function(){return it(this.h,this.c,this.l).rgb()},t.lab=St;var Nt=18,Ut=St.prototype=new Mt;function Qt(oe,E,R){var F=(oe+16)/116,V=F+E/500,ne=F-R/200;return new Gt(Ot(3.2404542*(V=.95047*lt(V))-1.5371385*(F=1*lt(F))-.4985314*(ne=1.08883*lt(ne))),Ot(-.969266*V+1.8760108*F+.041556*ne),Ot(.0556434*V-.2040259*F+1.0572252*ne))}function Ie(oe,E,R){return oe>0?new Dt(Math.atan2(R,E)*Ke,Math.sqrt(E*E+R*R),oe):new Dt(NaN,NaN,oe)}function lt(oe){return oe>.206893034?oe*oe*oe:(oe-4/29)/7.787037}function wt(oe){return oe>.008856?Math.pow(oe,1/3):7.787037*oe+4/29}function Ot(oe){return Math.round(255*(oe<=.00304?12.92*oe:1.055*Math.pow(oe,1/2.4)-.055))}function Gt(oe,E,R){return this instanceof Gt?(this.r=~~oe,this.g=~~E,void(this.b=~~R)):arguments.length<2?oe instanceof Gt?new Gt(oe.r,oe.g,oe.b):dr(""+oe,Gt,vt):new Gt(oe,E,R)}function ir(oe){return new Gt(oe>>16,oe>>8&255,255&oe)}function Xt(oe){return ir(oe)+""}Ut.brighter=function(oe){return new St(Math.min(100,this.l+Nt*(arguments.length?oe:1)),this.a,this.b)},Ut.darker=function(oe){return new St(Math.max(0,this.l-Nt*(arguments.length?oe:1)),this.a,this.b)},Ut.rgb=function(){return Qt(this.l,this.a,this.b)},t.rgb=Gt;var Kt=Gt.prototype=new Mt;function or(oe){return oe<16?"0"+Math.max(0,oe).toString(16):Math.min(255,oe).toString(16)}function dr(oe,E,R){var F,V,ne,le=0,pe=0,ye=0;if(F=/([a-z]+)\((.*)\)/.exec(oe=oe.toLowerCase()))switch(V=F[2].split(","),F[1]){case"hsl":return R(parseFloat(V[0]),parseFloat(V[1])/100,parseFloat(V[2])/100);case"rgb":return E(br(V[0]),br(V[1]),br(V[2]))}return(ne=Rr.get(oe))?E(ne.r,ne.g,ne.b):(oe==null||oe.charAt(0)!=="#"||isNaN(ne=parseInt(oe.slice(1),16))||(oe.length===4?(le=(3840&ne)>>4,le|=le>>4,pe=240&ne,pe|=pe>>4,ye=15&ne,ye|=ye<<4):oe.length===7&&(le=(16711680&ne)>>16,pe=(65280&ne)>>8,ye=255&ne)),E(le,pe,ye))}function vr(oe,E,R){var F,V,ne=Math.min(oe/=255,E/=255,R/=255),le=Math.max(oe,E,R),pe=le-ne,ye=(le+ne)/2;return pe?(V=ye<.5?pe/(le+ne):pe/(2-le-ne),F=oe==le?(E-R)/pe+(E<R?6:0):E==le?(R-oe)/pe+2:(oe-E)/pe+4,F*=60):(F=NaN,V=ye>0&&ye<1?0:F),new pt(F,V,ye)}function ur(oe,E,R){var F=wt((.4124564*(oe=pr(oe))+.3575761*(E=pr(E))+.1804375*(R=pr(R)))/.95047),V=wt((.2126729*oe+.7151522*E+.072175*R)/1);return St(116*V-16,500*(F-V),200*(V-wt((.0193339*oe+.119192*E+.9503041*R)/1.08883)))}function pr(oe){return(oe/=255)<=.04045?oe/12.92:Math.pow((oe+.055)/1.055,2.4)}function br(oe){var E=parseFloat(oe);return oe.charAt(oe.length-1)==="%"?Math.round(2.55*E):E}Kt.brighter=function(oe){oe=Math.pow(.7,arguments.length?oe:1);var E=this.r,R=this.g,F=this.b,V=30;return E||R||F?(E&&E<V&&(E=V),R&&R<V&&(R=V),F&&F<V&&(F=V),new Gt(Math.min(255,E/oe),Math.min(255,R/oe),Math.min(255,F/oe))):new Gt(V,V,V)},Kt.darker=function(oe){return new Gt((oe=Math.pow(.7,arguments.length?oe:1))*this.r,oe*this.g,oe*this.b)},Kt.hsl=function(){return vr(this.r,this.g,this.b)},Kt.toString=function(){return"#"+or(this.r)+or(this.g)+or(this.b)};var Rr=t.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function _r(oe){return typeof oe=="function"?oe:function(){return oe}}function jr(oe){return function(E,R,F){return arguments.length===2&&typeof R=="function"&&(F=R,R=null),$r(E,R,oe,F)}}function $r(oe,E,R,F){var V={},ne=t.dispatch("beforesend","progress","load","error"),le={},pe=new XMLHttpRequest,ye=null;function Te(){var Ne,Ge=pe.status;if(!Ge&&function(nt){var bt=nt.responseType;return bt&&bt!=="text"?nt.response:nt.responseText}(pe)||Ge>=200&&Ge<300||Ge===304){try{Ne=R.call(V,pe)}catch(nt){return void ne.error.call(V,nt)}ne.load.call(V,Ne)}else ne.error.call(V,pe)}return self.XDomainRequest&&!("withCredentials"in pe)&&/^(http(s)?:)?\/\//.test(oe)&&(pe=new XDomainRequest),"onload"in pe?pe.onload=pe.onerror=Te:pe.onreadystatechange=function(){pe.readyState>3&&Te()},pe.onprogress=function(Ne){var Ge=t.event;t.event=Ne;try{ne.progress.call(V,pe)}finally{t.event=Ge}},V.header=function(Ne,Ge){return Ne=(Ne+"").toLowerCase(),arguments.length<2?le[Ne]:(Ge==null?delete le[Ne]:le[Ne]=Ge+"",V)},V.mimeType=function(Ne){return arguments.length?(E=Ne==null?null:Ne+"",V):E},V.responseType=function(Ne){return arguments.length?(ye=Ne,V):ye},V.response=function(Ne){return R=Ne,V},["get","post"].forEach(function(Ne){V[Ne]=function(){return V.send.apply(V,[Ne].concat(m(arguments)))}}),V.send=function(Ne,Ge,nt){if(arguments.length===2&&typeof Ge=="function"&&(nt=Ge,Ge=null),pe.open(Ne,oe,!0),E==null||"accept"in le||(le.accept=E+",*/*"),pe.setRequestHeader)for(var bt in le)pe.setRequestHeader(bt,le[bt]);return E!=null&&pe.overrideMimeType&&pe.overrideMimeType(E),ye!=null&&(pe.responseType=ye),nt!=null&&V.on("error",nt).on("load",function(Ct){nt(null,Ct)}),ne.beforesend.call(V,pe),pe.send(Ge==null?null:Ge),V},V.abort=function(){return pe.abort(),V},t.rebind(V,ne,"on"),F==null?V:V.get(function(Ne){return Ne.length===1?function(Ge,nt){Ne(Ge==null?nt:null)}:Ne}(F))}Rr.forEach(function(oe,E){Rr.set(oe,ir(E))}),t.functor=_r,t.xhr=jr(D),t.dsv=function(oe,E){var R=new RegExp('["'+oe+`
]`),F=oe.charCodeAt(0);function V(Te,Ne,Ge){arguments.length<3&&(Ge=Ne,Ne=null);var nt=$r(Te,E,Ne==null?ne:le(Ne),Ge);return nt.row=function(bt){return arguments.length?nt.response((Ne=bt)==null?ne:le(bt)):Ne},nt}function ne(Te){return V.parse(Te.responseText)}function le(Te){return function(Ne){return V.parse(Ne.responseText,Te)}}function pe(Te){return Te.map(ye).join(oe)}function ye(Te){return R.test(Te)?'"'+Te.replace(/\"/g,'""')+'"':Te}return V.parse=function(Te,Ne){var Ge;return V.parseRows(Te,function(nt,bt){if(Ge)return Ge(nt,bt-1);var Ct=function(Tt){for(var At={},yt=nt.length,Ft=0;Ft<yt;++Ft)At[nt[Ft]]=Tt[Ft];return At};Ge=Ne?function(Tt,At){return Ne(Ct(Tt),At)}:Ct})},V.parseRows=function(Te,Ne){var Ge,nt,bt={},Ct={},Tt=[],At=Te.length,yt=0,Ft=0;function zt(){if(yt>=At)return Ct;if(nt)return nt=!1,bt;var rr=yt;if(Te.charCodeAt(rr)===34){for(var hr=rr;hr++<At;)if(Te.charCodeAt(hr)===34){if(Te.charCodeAt(hr+1)!==34)break;++hr}return yt=hr+2,(Ar=Te.charCodeAt(hr+1))===13?(nt=!0,Te.charCodeAt(hr+2)===10&&++yt):Ar===10&&(nt=!0),Te.slice(rr+1,hr).replace(/""/g,'"')}for(;yt<At;){var Ar,kr=1;if((Ar=Te.charCodeAt(yt++))===10)nt=!0;else if(Ar===13)nt=!0,Te.charCodeAt(yt)===10&&(++yt,++kr);else if(Ar!==F)continue;return Te.slice(rr,yt-kr)}return Te.slice(rr)}for(;(Ge=zt())!==Ct;){for(var jt=[];Ge!==bt&&Ge!==Ct;)jt.push(Ge),Ge=zt();Ne&&(jt=Ne(jt,Ft++))==null||Tt.push(jt)}return Tt},V.format=function(Te){if(Array.isArray(Te[0]))return V.formatRows(Te);var Ne=new P,Ge=[];return Te.forEach(function(nt){for(var bt in nt)Ne.has(bt)||Ge.push(Ne.add(bt))}),[Ge.map(ye).join(oe)].concat(Te.map(function(nt){return Ge.map(function(bt){return ye(nt[bt])}).join(oe)})).join(`
`)},V.formatRows=function(Te){return Te.map(pe).join(`
`)},V},t.csv=t.dsv(",","text/csv"),t.tsv=t.dsv("	","text/tab-separated-values");var pn,In,On,Sn,an=this[U(this,"requestAnimationFrame")]||function(oe){setTimeout(oe,17)};function Nr(oe,E,R){var F=arguments.length;F<2&&(E=0),F<3&&(R=Date.now());var V=R+E,ne={c:oe,t:V,n:null};return In?In.n=ne:pn=ne,In=ne,On||(Sn=clearTimeout(Sn),On=1,an(Pr)),ne}function Pr(){var oe=en(),E=tn()-oe;E>24?(isFinite(E)&&(clearTimeout(Sn),Sn=setTimeout(Pr,E)),On=0):(On=1,an(Pr))}function en(){for(var oe=Date.now(),E=pn;E;)oe>=E.t&&E.c(oe-E.t)&&(E.c=null),E=E.n;return oe}function tn(){for(var oe,E=pn,R=1/0;E;)E.c?(E.t<R&&(R=E.t),E=(oe=E).n):E=oe?oe.n=E.n:pn=E.n;return In=oe,R}function Qr(oe){return oe[0]}function rn(oe){return oe[1]}function An(oe){for(var E,R,F,V=oe.length,ne=[0,1],le=2,pe=2;pe<V;pe++){for(;le>1&&(E=oe[ne[le-2]],R=oe[ne[le-1]],F=oe[pe],(R[0]-E[0])*(F[1]-E[1])-(R[1]-E[1])*(F[0]-E[0])<=0);)--le;ne[le++]=pe}return ne.slice(0,le)}function En(oe,E){return oe[0]-E[0]||oe[1]-E[1]}t.timer=function(){Nr.apply(this,arguments)},t.timer.flush=function(){en(),tn()},t.round=function(oe,E){return E?Math.round(oe*(E=Math.pow(10,E)))/E:Math.round(oe)},t.geom={},t.geom.hull=function(oe){var E=Qr,R=rn;if(arguments.length)return F(oe);function F(V){if(V.length<3)return[];var ne,le=_r(E),pe=_r(R),ye=V.length,Te=[],Ne=[];for(ne=0;ne<ye;ne++)Te.push([+le.call(this,V[ne],ne),+pe.call(this,V[ne],ne),ne]);for(Te.sort(En),ne=0;ne<ye;ne++)Ne.push([Te[ne][0],-Te[ne][1]]);var Ge=An(Te),nt=An(Ne),bt=nt[0]===Ge[0],Ct=nt[nt.length-1]===Ge[Ge.length-1],Tt=[];for(ne=Ge.length-1;ne>=0;--ne)Tt.push(V[Te[Ge[ne]][2]]);for(ne=+bt;ne<nt.length-Ct;++ne)Tt.push(V[Te[nt[ne]][2]]);return Tt}return F.x=function(V){return arguments.length?(E=V,F):E},F.y=function(V){return arguments.length?(R=V,F):R},F},t.geom.polygon=function(oe){return j(oe,Bn),oe};var Bn=t.geom.polygon.prototype=[];function Jt(oe,E,R){return(R[0]-E[0])*(oe[1]-E[1])<(R[1]-E[1])*(oe[0]-E[0])}function It(oe,E,R,F){var V=oe[0],ne=R[0],le=E[0]-V,pe=F[0]-ne,ye=oe[1],Te=R[1],Ne=E[1]-ye,Ge=F[1]-Te,nt=(pe*(ye-Te)-Ge*(V-ne))/(Ge*le-pe*Ne);return[V+nt*le,ye+nt*Ne]}function qt(oe){var E=oe[0],R=oe[oe.length-1];return!(E[0]-R[0]||E[1]-R[1])}Bn.area=function(){for(var oe,E=-1,R=this.length,F=this[R-1],V=0;++E<R;)oe=F,F=this[E],V+=oe[1]*F[0]-oe[0]*F[1];return .5*V},Bn.centroid=function(oe){var E,R,F=-1,V=this.length,ne=0,le=0,pe=this[V-1];for(arguments.length||(oe=-1/(6*this.area()));++F<V;)E=pe,pe=this[F],R=E[0]*pe[1]-pe[0]*E[1],ne+=(E[0]+pe[0])*R,le+=(E[1]+pe[1])*R;return[ne*oe,le*oe]},Bn.clip=function(oe){for(var E,R,F,V,ne,le,pe=qt(oe),ye=-1,Te=this.length-qt(this),Ne=this[Te-1];++ye<Te;){for(E=oe.slice(),oe.length=0,V=this[ye],ne=E[(F=E.length-pe)-1],R=-1;++R<F;)Jt(le=E[R],Ne,V)?(Jt(ne,Ne,V)||oe.push(It(ne,le,Ne,V)),oe.push(le)):Jt(ne,Ne,V)&&oe.push(It(ne,le,Ne,V)),ne=le;pe&&oe.push(oe[0]),Ne=V}return oe};var fr,Tr,Gr,Vr,xr,wr=[],Sr=[];function Mr(){li(this),this.edge=this.site=this.circle=null}function Ir(oe){var E=wr.pop()||new Mr;return E.site=oe,E}function qr(oe){Pn(oe),Gr.remove(oe),wr.push(oe),li(oe)}function cn(oe){var E=oe.circle,R=E.x,F=E.cy,V={x:R,y:F},ne=oe.P,le=oe.N,pe=[oe];qr(oe);for(var ye=ne;ye.circle&&v(R-ye.circle.x)<_t&&v(F-ye.circle.cy)<_t;)ne=ye.P,pe.unshift(ye),qr(ye),ye=ne;pe.unshift(ye),Pn(ye);for(var Te=le;Te.circle&&v(R-Te.circle.x)<_t&&v(F-Te.circle.cy)<_t;)le=Te.N,pe.push(Te),qr(Te),Te=le;pe.push(Te),Pn(Te);var Ne,Ge=pe.length;for(Ne=1;Ne<Ge;++Ne)Te=pe[Ne],ye=pe[Ne-1],pa(Te.edge,ye.site,Te.site,V);ye=pe[0],(Te=pe[Ge-1]).edge=yn(ye.site,Te.site,null,V),dn(ye),dn(Te)}function _n(oe){for(var E,R,F,V,ne=oe.x,le=oe.y,pe=Gr._;pe;)if((F=Jr(pe,le)-ne)>_t)pe=pe.L;else{if(!((V=ne-bn(pe,le))>_t)){F>-_t?(E=pe.P,R=pe):V>-_t?(E=pe,R=pe.N):E=R=pe;break}if(!pe.R){E=pe;break}pe=pe.R}var ye=Ir(oe);if(Gr.insert(E,ye),E||R){if(E===R)return Pn(E),R=Ir(E.site),Gr.insert(ye,R),ye.edge=R.edge=yn(E.site,ye.site),dn(E),void dn(R);if(R){Pn(E),Pn(R);var Te=E.site,Ne=Te.x,Ge=Te.y,nt=oe.x-Ne,bt=oe.y-Ge,Ct=R.site,Tt=Ct.x-Ne,At=Ct.y-Ge,yt=2*(nt*At-bt*Tt),Ft=nt*nt+bt*bt,zt=Tt*Tt+At*At,jt={x:(At*Ft-bt*zt)/yt+Ne,y:(nt*zt-Tt*Ft)/yt+Ge};pa(R.edge,Te,Ct,jt),ye.edge=yn(Te,oe,null,jt),R.edge=yn(oe,Ct,null,jt),dn(E),dn(R)}else ye.edge=yn(E.site,ye.site)}}function Jr(oe,E){var R=oe.site,F=R.x,V=R.y,ne=V-E;if(!ne)return F;var le=oe.P;if(!le)return-1/0;var pe=(R=le.site).x,ye=R.y,Te=ye-E;if(!Te)return pe;var Ne=pe-F,Ge=1/ne-1/Te,nt=Ne/Te;return Ge?(-nt+Math.sqrt(nt*nt-2*Ge*(Ne*Ne/(-2*Te)-ye+Te/2+V-ne/2)))/Ge+F:(F+pe)/2}function bn(oe,E){var R=oe.N;if(R)return Jr(R,E);var F=oe.site;return F.y===E?F.x:1/0}function Dr(oe){this.site=oe,this.edges=[]}function Wr(oe,E){return E.angle-oe.angle}function vn(){li(this),this.x=this.y=this.arc=this.site=this.cy=null}function dn(oe){var E=oe.P,R=oe.N;if(E&&R){var F=E.site,V=oe.site,ne=R.site;if(F!==ne){var le=V.x,pe=V.y,ye=F.x-le,Te=F.y-pe,Ne=ne.x-le,Ge=2*(ye*(At=ne.y-pe)-Te*Ne);if(!(Ge>=-1e-12)){var nt=ye*ye+Te*Te,bt=Ne*Ne+At*At,Ct=(At*nt-Te*bt)/Ge,Tt=(ye*bt-Ne*nt)/Ge,At=Tt+pe,yt=Sr.pop()||new vn;yt.arc=oe,yt.site=V,yt.x=Ct+le,yt.y=At+Math.sqrt(Ct*Ct+Tt*Tt),yt.cy=At,oe.circle=yt;for(var Ft=null,zt=xr._;zt;)if(yt.y<zt.y||yt.y===zt.y&&yt.x<=zt.x){if(!zt.L){Ft=zt.P;break}zt=zt.L}else{if(!zt.R){Ft=zt;break}zt=zt.R}xr.insert(Ft,yt),Ft||(Vr=yt)}}}}function Pn(oe){var E=oe.circle;E&&(E.P||(Vr=E.N),xr.remove(E),Sr.push(E),li(E),oe.circle=null)}function sa(oe,E){var R=oe.b;if(R)return!0;var F,V,ne=oe.a,le=E[0][0],pe=E[1][0],ye=E[0][1],Te=E[1][1],Ne=oe.l,Ge=oe.r,nt=Ne.x,bt=Ne.y,Ct=Ge.x,Tt=Ge.y,At=(nt+Ct)/2,yt=(bt+Tt)/2;if(Tt===bt){if(At<le||At>=pe)return;if(nt>Ct){if(ne){if(ne.y>=Te)return}else ne={x:At,y:ye};R={x:At,y:Te}}else{if(ne){if(ne.y<ye)return}else ne={x:At,y:Te};R={x:At,y:ye}}}else if(V=yt-(F=(nt-Ct)/(Tt-bt))*At,F<-1||F>1)if(nt>Ct){if(ne){if(ne.y>=Te)return}else ne={x:(ye-V)/F,y:ye};R={x:(Te-V)/F,y:Te}}else{if(ne){if(ne.y<ye)return}else ne={x:(Te-V)/F,y:Te};R={x:(ye-V)/F,y:ye}}else if(bt<Tt){if(ne){if(ne.x>=pe)return}else ne={x:le,y:F*le+V};R={x:pe,y:F*pe+V}}else{if(ne){if(ne.x<le)return}else ne={x:pe,y:F*pe+V};R={x:le,y:F*le+V}}return oe.a=ne,oe.b=R,!0}function Yn(oe,E){this.l=oe,this.r=E,this.a=this.b=null}function yn(oe,E,R,F){var V=new Yn(oe,E);return fr.push(V),R&&pa(V,oe,E,R),F&&pa(V,E,oe,F),Tr[oe.i].edges.push(new Qa(V,oe,E)),Tr[E.i].edges.push(new Qa(V,E,oe)),V}function ra(oe,E,R){var F=new Yn(oe,null);return F.a=E,F.b=R,fr.push(F),F}function pa(oe,E,R,F){oe.a||oe.b?oe.l===R?oe.b=F:oe.a=F:(oe.a=F,oe.l=E,oe.r=R)}function Qa(oe,E,R){var F=oe.a,V=oe.b;this.edge=oe,this.site=E,this.angle=R?Math.atan2(R.y-E.y,R.x-E.x):oe.l===E?Math.atan2(V.x-F.x,F.y-V.y):Math.atan2(F.x-V.x,V.y-F.y)}function Fi(){this._=null}function li(oe){oe.U=oe.C=oe.L=oe.R=oe.P=oe.N=null}function ki(oe,E){var R=E,F=E.R,V=R.U;V?V.L===R?V.L=F:V.R=F:oe._=F,F.U=V,R.U=F,R.R=F.L,R.R&&(R.R.U=R),F.L=R}function Ea(oe,E){var R=E,F=E.L,V=R.U;V?V.L===R?V.L=F:V.R=F:oe._=F,F.U=V,R.U=F,R.L=F.R,R.L&&(R.L.U=R),F.R=R}function Ga(oe){for(;oe.L;)oe=oe.L;return oe}function ko(oe,E){var R,F,V,ne=oe.sort(Qo).pop();for(fr=[],Tr=new Array(oe.length),Gr=new Fi,xr=new Fi;;)if(V=Vr,ne&&(!V||ne.y<V.y||ne.y===V.y&&ne.x<V.x))ne.x===R&&ne.y===F||(Tr[ne.i]=new Dr(ne),_n(ne),R=ne.x,F=ne.y),ne=oe.pop();else{if(!V)break;cn(V.arc)}E&&(function(pe){for(var ye,Te,Ne,Ge,nt,bt=fr,Ct=(Te=pe[0][0],Ne=pe[0][1],Ge=pe[1][0],nt=pe[1][1],function(At){var yt,Ft=At.a,zt=At.b,jt=Ft.x,rr=Ft.y,hr=0,Ar=1,kr=zt.x-jt,Kr=zt.y-rr;if(yt=Te-jt,kr||!(yt>0)){if(yt/=kr,kr<0){if(yt<hr)return;yt<Ar&&(Ar=yt)}else if(kr>0){if(yt>Ar)return;yt>hr&&(hr=yt)}if(yt=Ge-jt,kr||!(yt<0)){if(yt/=kr,kr<0){if(yt>Ar)return;yt>hr&&(hr=yt)}else if(kr>0){if(yt<hr)return;yt<Ar&&(Ar=yt)}if(yt=Ne-rr,Kr||!(yt>0)){if(yt/=Kr,Kr<0){if(yt<hr)return;yt<Ar&&(Ar=yt)}else if(Kr>0){if(yt>Ar)return;yt>hr&&(hr=yt)}if(yt=nt-rr,Kr||!(yt<0)){if(yt/=Kr,Kr<0){if(yt>Ar)return;yt>hr&&(hr=yt)}else if(Kr>0){if(yt<hr)return;yt<Ar&&(Ar=yt)}return hr>0&&(At.a={x:jt+hr*kr,y:rr+hr*Kr}),Ar<1&&(At.b={x:jt+Ar*kr,y:rr+Ar*Kr}),At}}}}}),Tt=bt.length;Tt--;)(!sa(ye=bt[Tt],pe)||!Ct(ye)||v(ye.a.x-ye.b.x)<_t&&v(ye.a.y-ye.b.y)<_t)&&(ye.a=ye.b=null,bt.splice(Tt,1))}(E),function(pe){for(var ye,Te,Ne,Ge,nt,bt,Ct,Tt,At,yt,Ft=pe[0][0],zt=pe[1][0],jt=pe[0][1],rr=pe[1][1],hr=Tr,Ar=hr.length;Ar--;)if((nt=hr[Ar])&&nt.prepare())for(Tt=(Ct=nt.edges).length,bt=0;bt<Tt;)Ne=(yt=Ct[bt].end()).x,Ge=yt.y,ye=(At=Ct[++bt%Tt].start()).x,Te=At.y,(v(Ne-ye)>_t||v(Ge-Te)>_t)&&(Ct.splice(bt,0,new Qa(ra(nt.site,yt,v(Ne-Ft)<_t&&rr-Ge>_t?{x:Ft,y:v(ye-Ft)<_t?Te:rr}:v(Ge-rr)<_t&&zt-Ne>_t?{x:v(Te-rr)<_t?ye:zt,y:rr}:v(Ne-zt)<_t&&Ge-jt>_t?{x:zt,y:v(ye-zt)<_t?Te:jt}:v(Ge-jt)<_t&&Ne-Ft>_t?{x:v(Te-jt)<_t?ye:Ft,y:jt}:null),nt.site,null)),++Tt)}(E));var le={cells:Tr,edges:fr};return Gr=xr=fr=Tr=null,le}function Qo(oe,E){return E.y-oe.y||E.x-oe.x}Dr.prototype.prepare=function(){for(var oe,E=this.edges,R=E.length;R--;)(oe=E[R].edge).b&&oe.a||E.splice(R,1);return E.sort(Wr),E.length},Qa.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Fi.prototype={insert:function(oe,E){var R,F,V;if(oe){if(E.P=oe,E.N=oe.N,oe.N&&(oe.N.P=E),oe.N=E,oe.R){for(oe=oe.R;oe.L;)oe=oe.L;oe.L=E}else oe.R=E;R=oe}else this._?(oe=Ga(this._),E.P=null,E.N=oe,oe.P=oe.L=E,R=oe):(E.P=E.N=null,this._=E,R=null);for(E.L=E.R=null,E.U=R,E.C=!0,oe=E;R&&R.C;)R===(F=R.U).L?(V=F.R)&&V.C?(R.C=V.C=!1,F.C=!0,oe=F):(oe===R.R&&(ki(this,R),R=(oe=R).U),R.C=!1,F.C=!0,Ea(this,F)):(V=F.L)&&V.C?(R.C=V.C=!1,F.C=!0,oe=F):(oe===R.L&&(Ea(this,R),R=(oe=R).U),R.C=!1,F.C=!0,ki(this,F)),R=oe.U;this._.C=!1},remove:function(oe){oe.N&&(oe.N.P=oe.P),oe.P&&(oe.P.N=oe.N),oe.N=oe.P=null;var E,R,F,V=oe.U,ne=oe.L,le=oe.R;if(R=ne?le?Ga(le):ne:le,V?V.L===oe?V.L=R:V.R=R:this._=R,ne&&le?(F=R.C,R.C=oe.C,R.L=ne,ne.U=R,R!==le?(V=R.U,R.U=oe.U,oe=R.R,V.L=oe,R.R=le,le.U=R):(R.U=V,V=R,oe=R.R)):(F=oe.C,oe=R),oe&&(oe.U=V),!F)if(oe&&oe.C)oe.C=!1;else{do{if(oe===this._)break;if(oe===V.L){if((E=V.R).C&&(E.C=!1,V.C=!0,ki(this,V),E=V.R),E.L&&E.L.C||E.R&&E.R.C){E.R&&E.R.C||(E.L.C=!1,E.C=!0,Ea(this,E),E=V.R),E.C=V.C,V.C=E.R.C=!1,ki(this,V),oe=this._;break}}else if((E=V.L).C&&(E.C=!1,V.C=!0,Ea(this,V),E=V.L),E.L&&E.L.C||E.R&&E.R.C){E.L&&E.L.C||(E.R.C=!1,E.C=!0,ki(this,E),E=V.L),E.C=V.C,V.C=E.L.C=!1,Ea(this,V),oe=this._;break}E.C=!0,oe=V,V=V.U}while(!oe.C);oe&&(oe.C=!1)}}},t.geom.voronoi=function(oe){var E=Qr,R=rn,F=E,V=R,ne=us;if(oe)return le(oe);function le(ye){var Te=new Array(ye.length),Ne=ne[0][0],Ge=ne[0][1],nt=ne[1][0],bt=ne[1][1];return ko(pe(ye),ne).cells.forEach(function(Ct,Tt){var At=Ct.edges,yt=Ct.site;(Te[Tt]=At.length?At.map(function(Ft){var zt=Ft.start();return[zt.x,zt.y]}):yt.x>=Ne&&yt.x<=nt&&yt.y>=Ge&&yt.y<=bt?[[Ne,bt],[nt,bt],[nt,Ge],[Ne,Ge]]:[]).point=ye[Tt]}),Te}function pe(ye){return ye.map(function(Te,Ne){return{x:Math.round(F(Te,Ne)/_t)*_t,y:Math.round(V(Te,Ne)/_t)*_t,i:Ne}})}return le.links=function(ye){return ko(pe(ye)).edges.filter(function(Te){return Te.l&&Te.r}).map(function(Te){return{source:ye[Te.l.i],target:ye[Te.r.i]}})},le.triangles=function(ye){var Te=[];return ko(pe(ye)).cells.forEach(function(Ne,Ge){for(var nt,bt,Ct,Tt,At=Ne.site,yt=Ne.edges.sort(Wr),Ft=-1,zt=yt.length,jt=yt[zt-1].edge,rr=jt.l===At?jt.r:jt.l;++Ft<zt;)nt=rr,rr=(jt=yt[Ft].edge).l===At?jt.r:jt.l,Ge<nt.i&&Ge<rr.i&&(Ct=nt,Tt=rr,((bt=At).x-Tt.x)*(Ct.y-bt.y)-(bt.x-Ct.x)*(Tt.y-bt.y)<0)&&Te.push([ye[Ge],ye[nt.i],ye[rr.i]])}),Te},le.x=function(ye){return arguments.length?(F=_r(E=ye),le):E},le.y=function(ye){return arguments.length?(V=_r(R=ye),le):R},le.clipExtent=function(ye){return arguments.length?(ne=ye==null?us:ye,le):ne===us?null:ne},le.size=function(ye){return arguments.length?le.clipExtent(ye&&[[0,0],ye]):ne===us?null:ne&&ne[1]},le};var us=[[-1e6,-1e6],[1e6,1e6]];function $i(oe){return oe.x}function to(oe){return oe.y}function es(oe,E,R,F,V,ne){if(!oe(E,R,F,V,ne)){var le=.5*(R+V),pe=.5*(F+ne),ye=E.nodes;ye[0]&&es(oe,ye[0],R,F,le,pe),ye[1]&&es(oe,ye[1],le,F,V,pe),ye[2]&&es(oe,ye[2],R,pe,le,ne),ye[3]&&es(oe,ye[3],le,pe,V,ne)}}function Wa(oe,E,R,F,V,ne,le){var pe,ye=1/0;return function Te(Ne,Ge,nt,bt,Ct){if(!(Ge>ne||nt>le||bt<F||Ct<V)){if(Tt=Ne.point){var Tt,At=E-Ne.x,yt=R-Ne.y,Ft=At*At+yt*yt;if(Ft<ye){var zt=Math.sqrt(ye=Ft);F=E-zt,V=R-zt,ne=E+zt,le=R+zt,pe=Tt}}for(var jt=Ne.nodes,rr=.5*(Ge+bt),hr=.5*(nt+Ct),Ar=(R>=hr)<<1|E>=rr,kr=Ar+4;Ar<kr;++Ar)if(Ne=jt[3&Ar])switch(3&Ar){case 0:Te(Ne,Ge,nt,rr,hr);break;case 1:Te(Ne,rr,nt,bt,hr);break;case 2:Te(Ne,Ge,hr,rr,Ct);break;case 3:Te(Ne,rr,hr,bt,Ct)}}}(oe,F,V,ne,le),pe}function jo(oe,E){oe=t.rgb(oe),E=t.rgb(E);var R=oe.r,F=oe.g,V=oe.b,ne=E.r-R,le=E.g-F,pe=E.b-V;return function(ye){return"#"+or(Math.round(R+ne*ye))+or(Math.round(F+le*ye))+or(Math.round(V+pe*ye))}}function Ao(oe,E){var R,F={},V={};for(R in oe)R in E?F[R]=Ui(oe[R],E[R]):V[R]=oe[R];for(R in E)R in oe||(V[R]=E[R]);return function(ne){for(R in F)V[R]=F[R](ne);return V}}function Ai(oe,E){return oe=+oe,E=+E,function(R){return oe*(1-R)+E*R}}function ro(oe,E){var R,F,V,ne=Mo.lastIndex=zo.lastIndex=0,le=-1,pe=[],ye=[];for(oe+="",E+="";(R=Mo.exec(oe))&&(F=zo.exec(E));)(V=F.index)>ne&&(V=E.slice(ne,V),pe[le]?pe[le]+=V:pe[++le]=V),(R=R[0])===(F=F[0])?pe[le]?pe[le]+=F:pe[++le]=F:(pe[++le]=null,ye.push({i:le,x:Ai(R,F)})),ne=zo.lastIndex;return ne<E.length&&(V=E.slice(ne),pe[le]?pe[le]+=V:pe[++le]=V),pe.length<2?ye[0]?(E=ye[0].x,function(Te){return E(Te)+""}):function(){return E}:(E=ye.length,function(Te){for(var Ne,Ge=0;Ge<E;++Ge)pe[(Ne=ye[Ge]).i]=Ne.x(Te);return pe.join("")})}t.geom.delaunay=function(oe){return t.geom.voronoi().triangles(oe)},t.geom.quadtree=function(oe,E,R,F,V){var ne,le=Qr,pe=rn;if(ne=arguments.length)return le=$i,pe=to,ne===3&&(V=R,F=E,R=E=0),ye(oe);function ye(Te){var Ne,Ge,nt,bt,Ct,Tt,At,yt,Ft,zt=_r(le),jt=_r(pe);if(E!=null)Tt=E,At=R,yt=F,Ft=V;else if(yt=Ft=-(Tt=At=1/0),Ge=[],nt=[],Ct=Te.length,ne)for(bt=0;bt<Ct;++bt)(Ne=Te[bt]).x<Tt&&(Tt=Ne.x),Ne.y<At&&(At=Ne.y),Ne.x>yt&&(yt=Ne.x),Ne.y>Ft&&(Ft=Ne.y),Ge.push(Ne.x),nt.push(Ne.y);else for(bt=0;bt<Ct;++bt){var rr=+zt(Ne=Te[bt],bt),hr=+jt(Ne,bt);rr<Tt&&(Tt=rr),hr<At&&(At=hr),rr>yt&&(yt=rr),hr>Ft&&(Ft=hr),Ge.push(rr),nt.push(hr)}var Ar=yt-Tt,kr=Ft-At;function Kr(sn,Un,Wn,ua,Ur,kn,Xn,Gn){if(!isNaN(Wn)&&!isNaN(ua))if(sn.leaf){var ea=sn.x,fa=sn.y;if(ea!=null)if(v(ea-Wn)+v(fa-ua)<.01)Zr(sn,Un,Wn,ua,Ur,kn,Xn,Gn);else{var Ma=sn.point;sn.x=sn.y=sn.point=null,Zr(sn,Ma,ea,fa,Ur,kn,Xn,Gn),Zr(sn,Un,Wn,ua,Ur,kn,Xn,Gn)}else sn.x=Wn,sn.y=ua,sn.point=Un}else Zr(sn,Un,Wn,ua,Ur,kn,Xn,Gn)}function Zr(sn,Un,Wn,ua,Ur,kn,Xn,Gn){var ea=.5*(Ur+Xn),fa=.5*(kn+Gn),Ma=Wn>=ea,Kn=ua>=fa,xa=Kn<<1|Ma;sn.leaf=!1,Ma?Ur=ea:Xn=ea,Kn?kn=fa:Gn=fa,Kr(sn=sn.nodes[xa]||(sn.nodes[xa]={leaf:!0,nodes:[],point:null,x:null,y:null}),Un,Wn,ua,Ur,kn,Xn,Gn)}Ar>kr?Ft=At+Ar:yt=Tt+kr;var hn={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(sn){Kr(hn,sn,+zt(sn,++bt),+jt(sn,bt),Tt,At,yt,Ft)},visit:function(sn){es(sn,hn,Tt,At,yt,Ft)},find:function(sn){return Wa(hn,sn[0],sn[1],Tt,At,yt,Ft)}};if(bt=-1,E==null){for(;++bt<Ct;)Kr(hn,Te[bt],Ge[bt],nt[bt],Tt,At,yt,Ft);--bt}else Te.forEach(hn.add);return Ge=nt=Te=Ne=null,hn}return ye.x=function(Te){return arguments.length?(le=Te,ye):le},ye.y=function(Te){return arguments.length?(pe=Te,ye):pe},ye.extent=function(Te){return arguments.length?(Te==null?E=R=F=V=null:(E=+Te[0][0],R=+Te[0][1],F=+Te[1][0],V=+Te[1][1]),ye):E==null?null:[[E,R],[F,V]]},ye.size=function(Te){return arguments.length?(Te==null?E=R=F=V=null:(E=R=0,F=+Te[0],V=+Te[1]),ye):E==null?null:[F-E,V-R]},ye},t.interpolateRgb=jo,t.interpolateObject=Ao,t.interpolateNumber=Ai,t.interpolateString=ro;var Mo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zo=new RegExp(Mo.source,"g");function Ui(oe,E){for(var R,F=t.interpolators.length;--F>=0&&!(R=t.interpolators[F](oe,E)););return R}function vi(oe,E){var R,F=[],V=[],ne=oe.length,le=E.length,pe=Math.min(oe.length,E.length);for(R=0;R<pe;++R)F.push(Ui(oe[R],E[R]));for(;R<ne;++R)V[R]=oe[R];for(;R<le;++R)V[R]=E[R];return function(ye){for(R=0;R<pe;++R)V[R]=F[R](ye);return V}}t.interpolate=Ui,t.interpolators=[function(oe,E){var R=typeof E;return(R==="string"?Rr.has(E.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(E)?jo:ro:E instanceof Mt?jo:Array.isArray(E)?vi:R==="object"&&isNaN(E)?Ao:Ai)(oe,E)}],t.interpolateArray=vi;var Qi=function(){return D},Vs=t.map({linear:Qi,poly:function(oe){return function(E){return Math.pow(E,oe)}},quad:function(){return Zs},cubic:function(){return Ks},sin:function(){return Js},exp:function(){return Uo},circle:function(){return Vo},elastic:function(oe,E){var R;return arguments.length<2&&(E=.45),arguments.length?R=E/tr*Math.asin(1/oe):(oe=1,R=E/4),function(F){return 1+oe*Math.pow(2,-10*F)*Math.sin((F-R)*tr/E)}},back:function(oe){return oe||(oe=1.70158),function(E){return E*E*((oe+1)*E-oe)}},bounce:function(){return ts}}),Xs=t.map({in:D,out:Os,"in-out":ms,"out-in":function(oe){return ms(Os(oe))}});function Xa(oe){return function(E){return E<=0?0:E>=1?1:oe(E)}}function Os(oe){return function(E){return 1-oe(1-E)}}function ms(oe){return function(E){return .5*(E<.5?oe(2*E):2-oe(2-2*E))}}function Zs(oe){return oe*oe}function Ks(oe){return oe*oe*oe}function Hs(oe){if(oe<=0)return 0;if(oe>=1)return 1;var E=oe*oe,R=E*oe;return 4*(oe<.5?R:3*(oe-E)+R-.75)}function Js(oe){return 1-Math.cos(oe*He)}function Uo(oe){return Math.pow(2,10*(oe-1))}function Vo(oe){return 1-Math.sqrt(1-oe*oe)}function ts(oe){return oe<1/2.75?7.5625*oe*oe:oe<2/2.75?7.5625*(oe-=1.5/2.75)*oe+.75:oe<2.5/2.75?7.5625*(oe-=2.25/2.75)*oe+.9375:7.5625*(oe-=2.625/2.75)*oe+.984375}function rs(oe,E){return E-=oe,function(R){return Math.round(oe+E*R)}}function ns(oe){var E,R,F,V=[oe.a,oe.b],ne=[oe.c,oe.d],le=So(V),pe=vs(V,ne),ye=So(((E=ne)[0]+=(F=-pe)*(R=V)[0],E[1]+=F*R[1],E))||0;V[0]*ne[1]<ne[0]*V[1]&&(V[0]*=-1,V[1]*=-1,le*=-1,pe*=-1),this.rotate=(le?Math.atan2(V[1],V[0]):Math.atan2(-ne[0],ne[1]))*Ke,this.translate=[oe.e,oe.f],this.scale=[le,ye],this.skew=ye?Math.atan2(pe,ye)*Ke:0}function vs(oe,E){return oe[0]*E[0]+oe[1]*E[1]}function So(oe){var E=Math.sqrt(vs(oe,oe));return E&&(oe[0]/=E,oe[1]/=E),E}t.ease=function(oe){var E=oe.indexOf("-"),R=E>=0?oe.slice(0,E):oe,F=E>=0?oe.slice(E+1):"in";return R=Vs.get(R)||Qi,Xa((F=Xs.get(F)||D)(R.apply(null,d.call(arguments,1))))},t.interpolateHcl=function(oe,E){oe=t.hcl(oe),E=t.hcl(E);var R=oe.h,F=oe.c,V=oe.l,ne=E.h-R,le=E.c-F,pe=E.l-V;return isNaN(le)&&(le=0,F=isNaN(F)?E.c:F),isNaN(ne)?(ne=0,R=isNaN(R)?E.h:R):ne>180?ne-=360:ne<-180&&(ne+=360),function(ye){return it(R+ne*ye,F+le*ye,V+pe*ye)+""}},t.interpolateHsl=function(oe,E){oe=t.hsl(oe),E=t.hsl(E);var R=oe.h,F=oe.s,V=oe.l,ne=E.h-R,le=E.s-F,pe=E.l-V;return isNaN(le)&&(le=0,F=isNaN(F)?E.s:F),isNaN(ne)?(ne=0,R=isNaN(R)?E.h:R):ne>180?ne-=360:ne<-180&&(ne+=360),function(ye){return vt(R+ne*ye,F+le*ye,V+pe*ye)+""}},t.interpolateLab=function(oe,E){oe=t.lab(oe),E=t.lab(E);var R=oe.l,F=oe.a,V=oe.b,ne=E.l-R,le=E.a-F,pe=E.b-V;return function(ye){return Qt(R+ne*ye,F+le*ye,V+pe*ye)+""}},t.interpolateRound=rs,t.transform=function(oe){var E=p.createElementNS(t.ns.prefix.svg,"g");return(t.transform=function(R){if(R!=null){E.setAttribute("transform",R);var F=E.transform.baseVal.consolidate()}return new ns(F?F.matrix:Ds)})(oe)},ns.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Ds={a:1,b:0,c:0,d:1,e:0,f:0};function vo(oe){return oe.length?oe.pop()+",":""}function as(oe,E){var R=[],F=[];return oe=t.transform(oe),E=t.transform(E),function(V,ne,le,pe){if(V[0]!==ne[0]||V[1]!==ne[1]){var ye=le.push("translate(",null,",",null,")");pe.push({i:ye-4,x:Ai(V[0],ne[0])},{i:ye-2,x:Ai(V[1],ne[1])})}else(ne[0]||ne[1])&&le.push("translate("+ne+")")}(oe.translate,E.translate,R,F),function(V,ne,le,pe){V!==ne?(V-ne>180?ne+=360:ne-V>180&&(V+=360),pe.push({i:le.push(vo(le)+"rotate(",null,")")-2,x:Ai(V,ne)})):ne&&le.push(vo(le)+"rotate("+ne+")")}(oe.rotate,E.rotate,R,F),function(V,ne,le,pe){V!==ne?pe.push({i:le.push(vo(le)+"skewX(",null,")")-2,x:Ai(V,ne)}):ne&&le.push(vo(le)+"skewX("+ne+")")}(oe.skew,E.skew,R,F),function(V,ne,le,pe){if(V[0]!==ne[0]||V[1]!==ne[1]){var ye=le.push(vo(le)+"scale(",null,",",null,")");pe.push({i:ye-4,x:Ai(V[0],ne[0])},{i:ye-2,x:Ai(V[1],ne[1])})}else ne[0]===1&&ne[1]===1||le.push(vo(le)+"scale("+ne+")")}(oe.scale,E.scale,R,F),oe=E=null,function(V){for(var ne,le=-1,pe=F.length;++le<pe;)R[(ne=F[le]).i]=ne.x(V);return R.join("")}}function zs(oe,E){return E=(E-=oe=+oe)||1/E,function(R){return(R-oe)/E}}function Ho(oe,E){return E=(E-=oe=+oe)||1/E,function(R){return Math.max(0,Math.min(1,(R-oe)/E))}}function qa(oe){for(var E=oe.source,R=oe.target,F=function(le,pe){if(le===pe)return le;for(var ye=Re(le),Te=Re(pe),Ne=ye.pop(),Ge=Te.pop(),nt=null;Ne===Ge;)nt=Ne,Ne=ye.pop(),Ge=Te.pop();return nt}(E,R),V=[E];E!==F;)E=E.parent,V.push(E);for(var ne=V.length;R!==F;)V.splice(ne,0,R),R=R.parent;return V}function Re(oe){for(var E=[],R=oe.parent;R!=null;)E.push(oe),oe=R,R=R.parent;return E.push(oe),E}function Ve(oe){oe.fixed|=2}function Je(oe){oe.fixed&=-7}function ot(oe){oe.fixed|=4,oe.px=oe.x,oe.py=oe.y}function mt(oe){oe.fixed&=-5}t.interpolateTransform=as,t.layout={},t.layout.bundle=function(){return function(oe){for(var E=[],R=-1,F=oe.length;++R<F;)E.push(qa(oe[R]));return E}},t.layout.chord=function(){var oe,E,R,F,V,ne,le,pe={},ye=0;function Te(){var Ge,nt,bt,Ct,Tt,At={},yt=[],Ft=t.range(F),zt=[];for(oe=[],E=[],Ge=0,Ct=-1;++Ct<F;){for(nt=0,Tt=-1;++Tt<F;)nt+=R[Ct][Tt];yt.push(nt),zt.push(t.range(F)),Ge+=nt}for(V&&Ft.sort(function(hn,sn){return V(yt[hn],yt[sn])}),ne&&zt.forEach(function(hn,sn){hn.sort(function(Un,Wn){return ne(R[sn][Un],R[sn][Wn])})}),Ge=(tr-ye*F)/Ge,nt=0,Ct=-1;++Ct<F;){for(bt=nt,Tt=-1;++Tt<F;){var jt=Ft[Ct],rr=zt[jt][Tt],hr=R[jt][rr],Ar=nt,kr=nt+=hr*Ge;At[jt+"-"+rr]={index:jt,subindex:rr,startAngle:Ar,endAngle:kr,value:hr}}E[jt]={index:jt,startAngle:bt,endAngle:nt,value:yt[jt]},nt+=ye}for(Ct=-1;++Ct<F;)for(Tt=Ct-1;++Tt<F;){var Kr=At[Ct+"-"+Tt],Zr=At[Tt+"-"+Ct];(Kr.value||Zr.value)&&oe.push(Kr.value<Zr.value?{source:Zr,target:Kr}:{source:Kr,target:Zr})}le&&Ne()}function Ne(){oe.sort(function(Ge,nt){return le((Ge.source.value+Ge.target.value)/2,(nt.source.value+nt.target.value)/2)})}return pe.matrix=function(Ge){return arguments.length?(F=(R=Ge)&&R.length,oe=E=null,pe):R},pe.padding=function(Ge){return arguments.length?(ye=Ge,oe=E=null,pe):ye},pe.sortGroups=function(Ge){return arguments.length?(V=Ge,oe=E=null,pe):V},pe.sortSubgroups=function(Ge){return arguments.length?(ne=Ge,oe=null,pe):ne},pe.sortChords=function(Ge){return arguments.length?(le=Ge,oe&&Ne(),pe):le},pe.chords=function(){return oe||Te(),oe},pe.groups=function(){return E||Te(),E},pe},t.layout.force=function(){var oe,E,R,F,V,ne,le={},pe=t.dispatch("start","tick","end"),ye=[1,1],Te=.9,Ne=dt,Ge=Et,nt=-30,bt=Zt,Ct=.1,Tt=.64,At=[],yt=[];function Ft(jt){return function(rr,hr,Ar,kr){if(rr.point!==jt){var Kr=rr.cx-jt.x,Zr=rr.cy-jt.y,hn=kr-hr,sn=Kr*Kr+Zr*Zr;if(hn*hn/Tt<sn){if(sn<bt){var Un=rr.charge/sn;jt.px-=Kr*Un,jt.py-=Zr*Un}return!0}rr.point&&sn&&sn<bt&&(Un=rr.pointCharge/sn,jt.px-=Kr*Un,jt.py-=Zr*Un)}return!rr.charge}}function zt(jt){jt.px=t.event.x,jt.py=t.event.y,le.resume()}return le.tick=function(){if((R*=.99)<.005)return oe=null,pe.end({type:"end",alpha:R=0}),!0;var jt,rr,hr,Ar,kr,Kr,Zr,hn,sn,Un=At.length,Wn=yt.length;for(rr=0;rr<Wn;++rr)Ar=(hr=yt[rr]).source,(Kr=(hn=(kr=hr.target).x-Ar.x)*hn+(sn=kr.y-Ar.y)*sn)&&(hn*=Kr=R*V[rr]*((Kr=Math.sqrt(Kr))-F[rr])/Kr,sn*=Kr,kr.x-=hn*(Zr=Ar.weight+kr.weight?Ar.weight/(Ar.weight+kr.weight):.5),kr.y-=sn*Zr,Ar.x+=hn*(Zr=1-Zr),Ar.y+=sn*Zr);if((Zr=R*Ct)&&(hn=ye[0]/2,sn=ye[1]/2,rr=-1,Zr))for(;++rr<Un;)(hr=At[rr]).x+=(hn-hr.x)*Zr,hr.y+=(sn-hr.y)*Zr;if(nt)for(function ua(Ur,kn,Xn){var Gn=0,ea=0;if(Ur.charge=0,!Ur.leaf)for(var fa,Ma=Ur.nodes,Kn=Ma.length,xa=-1;++xa<Kn;)(fa=Ma[xa])!=null&&(ua(fa,kn,Xn),Ur.charge+=fa.charge,Gn+=fa.charge*fa.cx,ea+=fa.charge*fa.cy);if(Ur.point){Ur.leaf||(Ur.point.x+=Math.random()-.5,Ur.point.y+=Math.random()-.5);var ma=kn*Xn[Ur.point.index];Ur.charge+=Ur.pointCharge=ma,Gn+=ma*Ur.point.x,ea+=ma*Ur.point.y}Ur.cx=Gn/Ur.charge,Ur.cy=ea/Ur.charge}(jt=t.geom.quadtree(At),R,ne),rr=-1;++rr<Un;)(hr=At[rr]).fixed||jt.visit(Ft(hr));for(rr=-1;++rr<Un;)(hr=At[rr]).fixed?(hr.x=hr.px,hr.y=hr.py):(hr.x-=(hr.px-(hr.px=hr.x))*Te,hr.y-=(hr.py-(hr.py=hr.y))*Te);pe.tick({type:"tick",alpha:R})},le.nodes=function(jt){return arguments.length?(At=jt,le):At},le.links=function(jt){return arguments.length?(yt=jt,le):yt},le.size=function(jt){return arguments.length?(ye=jt,le):ye},le.linkDistance=function(jt){return arguments.length?(Ne=typeof jt=="function"?jt:+jt,le):Ne},le.distance=le.linkDistance,le.linkStrength=function(jt){return arguments.length?(Ge=typeof jt=="function"?jt:+jt,le):Ge},le.friction=function(jt){return arguments.length?(Te=+jt,le):Te},le.charge=function(jt){return arguments.length?(nt=typeof jt=="function"?jt:+jt,le):nt},le.chargeDistance=function(jt){return arguments.length?(bt=jt*jt,le):Math.sqrt(bt)},le.gravity=function(jt){return arguments.length?(Ct=+jt,le):Ct},le.theta=function(jt){return arguments.length?(Tt=jt*jt,le):Math.sqrt(Tt)},le.alpha=function(jt){return arguments.length?(jt=+jt,R?jt>0?R=jt:(oe.c=null,oe.t=NaN,oe=null,pe.end({type:"end",alpha:R=0})):jt>0&&(pe.start({type:"start",alpha:R=jt}),oe=Nr(le.tick)),le):R},le.start=function(){var jt,rr,hr,Ar=At.length,kr=yt.length,Kr=ye[0],Zr=ye[1];for(jt=0;jt<Ar;++jt)(hr=At[jt]).index=jt,hr.weight=0;for(jt=0;jt<kr;++jt)typeof(hr=yt[jt]).source=="number"&&(hr.source=At[hr.source]),typeof hr.target=="number"&&(hr.target=At[hr.target]),++hr.source.weight,++hr.target.weight;for(jt=0;jt<Ar;++jt)hr=At[jt],isNaN(hr.x)&&(hr.x=hn("x",Kr)),isNaN(hr.y)&&(hr.y=hn("y",Zr)),isNaN(hr.px)&&(hr.px=hr.x),isNaN(hr.py)&&(hr.py=hr.y);if(F=[],typeof Ne=="function")for(jt=0;jt<kr;++jt)F[jt]=+Ne.call(this,yt[jt],jt);else for(jt=0;jt<kr;++jt)F[jt]=Ne;if(V=[],typeof Ge=="function")for(jt=0;jt<kr;++jt)V[jt]=+Ge.call(this,yt[jt],jt);else for(jt=0;jt<kr;++jt)V[jt]=Ge;if(ne=[],typeof nt=="function")for(jt=0;jt<Ar;++jt)ne[jt]=+nt.call(this,At[jt],jt);else for(jt=0;jt<Ar;++jt)ne[jt]=nt;function hn(sn,Un){if(!rr){for(rr=new Array(Ar),kn=0;kn<Ar;++kn)rr[kn]=[];for(kn=0;kn<kr;++kn){var Wn=yt[kn];rr[Wn.source.index].push(Wn.target),rr[Wn.target.index].push(Wn.source)}}for(var ua,Ur=rr[jt],kn=-1,Xn=Ur.length;++kn<Xn;)if(!isNaN(ua=Ur[kn][sn]))return ua;return Math.random()*Un}return le.resume()},le.resume=function(){return le.alpha(.1)},le.stop=function(){return le.alpha(0)},le.drag=function(){if(E||(E=t.behavior.drag().origin(D).on("dragstart.force",Ve).on("drag.force",zt).on("dragend.force",Je)),!arguments.length)return E;this.on("mouseover.force",ot).on("mouseout.force",mt).call(E)},t.rebind(le,pe,"on")};var dt=20,Et=1,Zt=1/0;function $t(oe,E){return t.rebind(oe,E,"sort","children","value"),oe.nodes=oe,oe.links=Or,oe}function Yt(oe,E){for(var R=[oe];(oe=R.pop())!=null;)if(E(oe),(V=oe.children)&&(F=V.length))for(var F,V;--F>=0;)R.push(V[F])}function nr(oe,E){for(var R=[oe],F=[];(oe=R.pop())!=null;)if(F.push(oe),(ne=oe.children)&&(V=ne.length))for(var V,ne,le=-1;++le<V;)R.push(ne[le]);for(;(oe=F.pop())!=null;)E(oe)}function cr(oe){return oe.children}function mr(oe){return oe.value}function yr(oe,E){return E.value-oe.value}function Or(oe){return t.merge(oe.map(function(E){return(E.children||[]).map(function(R){return{source:E,target:R}})}))}t.layout.hierarchy=function(){var oe=yr,E=cr,R=mr;function F(V){var ne,le=[V],pe=[];for(V.depth=0;(ne=le.pop())!=null;)if(pe.push(ne),(Te=E.call(F,ne,ne.depth))&&(ye=Te.length)){for(var ye,Te,Ne;--ye>=0;)le.push(Ne=Te[ye]),Ne.parent=ne,Ne.depth=ne.depth+1;R&&(ne.value=0),ne.children=Te}else R&&(ne.value=+R.call(F,ne,ne.depth)||0),delete ne.children;return nr(V,function(Ge){var nt,bt;oe&&(nt=Ge.children)&&nt.sort(oe),R&&(bt=Ge.parent)&&(bt.value+=Ge.value)}),pe}return F.sort=function(V){return arguments.length?(oe=V,F):oe},F.children=function(V){return arguments.length?(E=V,F):E},F.value=function(V){return arguments.length?(R=V,F):R},F.revalue=function(V){return R&&(Yt(V,function(ne){ne.children&&(ne.value=0)}),nr(V,function(ne){var le;ne.children||(ne.value=+R.call(F,ne,ne.depth)||0),(le=ne.parent)&&(le.value+=ne.value)})),V},F},t.layout.partition=function(){var oe=t.layout.hierarchy(),E=[1,1];function R(F,V){var ne=oe.call(this,F,V);return function le(pe,ye,Te,Ne){var Ge=pe.children;if(pe.x=ye,pe.y=pe.depth*Ne,pe.dx=Te,pe.dy=Ne,Ge&&(nt=Ge.length)){var nt,bt,Ct,Tt=-1;for(Te=pe.value?Te/pe.value:0;++Tt<nt;)le(bt=Ge[Tt],ye,Ct=bt.value*Te,Ne),ye+=Ct}}(ne[0],0,E[0],E[1]/function le(pe){var ye=pe.children,Te=0;if(ye&&(Ne=ye.length))for(var Ne,Ge=-1;++Ge<Ne;)Te=Math.max(Te,le(ye[Ge]));return 1+Te}(ne[0])),ne}return R.size=function(F){return arguments.length?(E=F,R):E},$t(R,oe)},t.layout.pie=function(){var oe=Number,E=nn,R=0,F=tr,V=0;function ne(le){var pe,ye=le.length,Te=le.map(function(Ft,zt){return+oe.call(ne,Ft,zt)}),Ne=+(typeof R=="function"?R.apply(this,arguments):R),Ge=(typeof F=="function"?F.apply(this,arguments):F)-Ne,nt=Math.min(Math.abs(Ge)/ye,+(typeof V=="function"?V.apply(this,arguments):V)),bt=nt*(Ge<0?-1:1),Ct=t.sum(Te),Tt=Ct?(Ge-ye*bt)/Ct:0,At=t.range(ye),yt=[];return E!=null&&At.sort(E===nn?function(Ft,zt){return Te[zt]-Te[Ft]}:function(Ft,zt){return E(le[Ft],le[zt])}),At.forEach(function(Ft){yt[Ft]={data:le[Ft],value:pe=Te[Ft],startAngle:Ne,endAngle:Ne+=pe*Tt+bt,padAngle:nt}}),yt}return ne.value=function(le){return arguments.length?(oe=le,ne):oe},ne.sort=function(le){return arguments.length?(E=le,ne):E},ne.startAngle=function(le){return arguments.length?(R=le,ne):R},ne.endAngle=function(le){return arguments.length?(F=le,ne):F},ne.padAngle=function(le){return arguments.length?(V=le,ne):V},ne};var nn={};function gn(oe){return oe.x}function Cn(oe){return oe.y}function Dn(oe,E,R){oe.y0=E,oe.y=R}t.layout.stack=function(){var oe=D,E=ga,R=ka,F=Dn,V=gn,ne=Cn;function le(pe,ye){if(!(nt=pe.length))return pe;var Te=pe.map(function(Ft,zt){return oe.call(le,Ft,zt)}),Ne=Te.map(function(Ft){return Ft.map(function(zt,jt){return[V.call(le,zt,jt),ne.call(le,zt,jt)]})}),Ge=E.call(le,Ne,ye);Te=t.permute(Te,Ge),Ne=t.permute(Ne,Ge);var nt,bt,Ct,Tt,At=R.call(le,Ne,ye),yt=Te[0].length;for(Ct=0;Ct<yt;++Ct)for(F.call(le,Te[0][Ct],Tt=At[Ct],Ne[0][Ct][1]),bt=1;bt<nt;++bt)F.call(le,Te[bt][Ct],Tt+=Ne[bt-1][Ct][1],Ne[bt][Ct][1]);return pe}return le.values=function(pe){return arguments.length?(oe=pe,le):oe},le.order=function(pe){return arguments.length?(E=typeof pe=="function"?pe:Hn.get(pe)||ga,le):E},le.offset=function(pe){return arguments.length?(R=typeof pe=="function"?pe:zn.get(pe)||ka,le):R},le.x=function(pe){return arguments.length?(V=pe,le):V},le.y=function(pe){return arguments.length?(ne=pe,le):ne},le.out=function(pe){return arguments.length?(F=pe,le):F},le};var Hn=t.map({"inside-out":function(oe){var E,R,F=oe.length,V=oe.map(Ba),ne=oe.map(Fa),le=t.range(F).sort(function(Ge,nt){return V[Ge]-V[nt]}),pe=0,ye=0,Te=[],Ne=[];for(E=0;E<F;++E)R=le[E],pe<ye?(pe+=ne[R],Te.push(R)):(ye+=ne[R],Ne.push(R));return Ne.reverse().concat(Te)},reverse:function(oe){return t.range(oe.length).reverse()},default:ga}),zn=t.map({silhouette:function(oe){var E,R,F,V=oe.length,ne=oe[0].length,le=[],pe=0,ye=[];for(R=0;R<ne;++R){for(E=0,F=0;E<V;E++)F+=oe[E][R][1];F>pe&&(pe=F),le.push(F)}for(R=0;R<ne;++R)ye[R]=(pe-le[R])/2;return ye},wiggle:function(oe){var E,R,F,V,ne,le,pe,ye,Te,Ne=oe.length,Ge=oe[0],nt=Ge.length,bt=[];for(bt[0]=ye=Te=0,R=1;R<nt;++R){for(E=0,V=0;E<Ne;++E)V+=oe[E][R][1];for(E=0,ne=0,pe=Ge[R][0]-Ge[R-1][0];E<Ne;++E){for(F=0,le=(oe[E][R][1]-oe[E][R-1][1])/(2*pe);F<E;++F)le+=(oe[F][R][1]-oe[F][R-1][1])/pe;ne+=le*oe[E][R][1]}bt[R]=ye-=V?ne/V*pe:0,ye<Te&&(Te=ye)}for(R=0;R<nt;++R)bt[R]-=Te;return bt},expand:function(oe){var E,R,F,V=oe.length,ne=oe[0].length,le=1/V,pe=[];for(R=0;R<ne;++R){for(E=0,F=0;E<V;E++)F+=oe[E][R][1];if(F)for(E=0;E<V;E++)oe[E][R][1]/=F;else for(E=0;E<V;E++)oe[E][R][1]=le}for(R=0;R<ne;++R)pe[R]=0;return pe},zero:ka});function ga(oe){return t.range(oe.length)}function ka(oe){for(var E=-1,R=oe[0].length,F=[];++E<R;)F[E]=0;return F}function Ba(oe){for(var E,R=1,F=0,V=oe[0][1],ne=oe.length;R<ne;++R)(E=oe[R][1])>V&&(F=R,V=E);return F}function Fa(oe){return oe.reduce(ja,0)}function ja(oe,E){return oe+E[1]}function Mi(oe,E){return wi(oe,Math.ceil(Math.log(E.length)/Math.LN2+1))}function wi(oe,E){for(var R=-1,F=+oe[0],V=(oe[1]-F)/E,ne=[];++R<=E;)ne[R]=V*R+F;return ne}function ui(oe){return[t.min(oe),t.max(oe)]}function ci(oe,E){return oe.value-E.value}function Ti(oe,E){var R=oe._pack_next;oe._pack_next=E,E._pack_prev=oe,E._pack_next=R,R._pack_prev=E}function Vi(oe,E){oe._pack_next=E,E._pack_prev=oe}function no(oe,E){var R=E.x-oe.x,F=E.y-oe.y,V=oe.r+E.r;return .999*V*V>R*R+F*F}function ao(oe){if((E=oe.children)&&(ye=E.length)){var E,R,F,V,ne,le,pe,ye,Te=1/0,Ne=-1/0,Ge=1/0,nt=-1/0;if(E.forEach(io),(R=E[0]).x=-R.r,R.y=0,zt(R),ye>1&&((F=E[1]).x=F.r,F.y=0,zt(F),ye>2))for(Oa(R,F,V=E[2]),zt(V),Ti(R,V),R._pack_prev=V,Ti(V,F),F=R._pack_next,ne=3;ne<ye;ne++){Oa(R,F,V=E[ne]);var bt=0,Ct=1,Tt=1;for(le=F._pack_next;le!==F;le=le._pack_next,Ct++)if(no(le,V)){bt=1;break}if(bt==1)for(pe=R._pack_prev;pe!==le._pack_prev&&!no(pe,V);pe=pe._pack_prev,Tt++);bt?(Ct<Tt||Ct==Tt&&F.r<R.r?Vi(R,F=le):Vi(R=pe,F),ne--):(Ti(R,V),F=V,zt(V))}var At=(Te+Ne)/2,yt=(Ge+nt)/2,Ft=0;for(ne=0;ne<ye;ne++)(V=E[ne]).x-=At,V.y-=yt,Ft=Math.max(Ft,V.r+Math.sqrt(V.x*V.x+V.y*V.y));oe.r=Ft,E.forEach(oo)}function zt(jt){Te=Math.min(jt.x-jt.r,Te),Ne=Math.max(jt.x+jt.r,Ne),Ge=Math.min(jt.y-jt.r,Ge),nt=Math.max(jt.y+jt.r,nt)}}function io(oe){oe._pack_next=oe._pack_prev=oe}function oo(oe){delete oe._pack_next,delete oe._pack_prev}function Oa(oe,E,R){var F=oe.r+R.r,V=E.x-oe.x,ne=E.y-oe.y;if(F&&(V||ne)){var le=E.r+R.r,pe=V*V+ne*ne,ye=.5+((F*=F)-(le*=le))/(2*pe),Te=Math.sqrt(Math.max(0,2*le*(F+pe)-(F-=pe)*F-le*le))/(2*pe);R.x=oe.x+ye*V+Te*ne,R.y=oe.y+ye*ne-Te*V}else R.x=oe.x+F,R.y=oe.y}function ft(oe,E){return oe.parent==E.parent?1:2}function Rt(oe){var E=oe.children;return E.length?E[0]:oe.t}function sr(oe){var E,R=oe.children;return(E=R.length)?R[E-1]:oe.t}function Vt(oe,E,R){var F=R/(E.i-oe.i);E.c-=F,E.s+=R,oe.c+=F,E.z+=R,E.m+=R}function lr(oe,E,R){return oe.a.parent===E.parent?oe.a:R}function Lr(oe){return{x:oe.x,y:oe.y,dx:oe.dx,dy:oe.dy}}function zr(oe,E){var R=oe.x+E[3],F=oe.y+E[0],V=oe.dx-E[1]-E[3],ne=oe.dy-E[0]-E[2];return V<0&&(R+=V/2,V=0),ne<0&&(F+=ne/2,ne=0),{x:R,y:F,dx:V,dy:ne}}function Yr(oe){var E=oe[0],R=oe[oe.length-1];return E<R?[E,R]:[R,E]}function ln(oe){return oe.rangeExtent?oe.rangeExtent():Yr(oe.range())}function on(oe,E,R,F){var V=R(oe[0],oe[1]),ne=F(E[0],E[1]);return function(le){return ne(V(le))}}function mn(oe,E){var R,F=0,V=oe.length-1,ne=oe[F],le=oe[V];return le<ne&&(R=F,F=V,V=R,R=ne,ne=le,le=R),oe[F]=E.floor(ne),oe[V]=E.ceil(le),oe}function wn(oe){return oe?{floor:function(E){return Math.floor(E/oe)*oe},ceil:function(E){return Math.ceil(E/oe)*oe}}:un}t.layout.histogram=function(){var oe=!0,E=Number,R=ui,F=Mi;function V(ne,le){for(var pe,ye,Te=[],Ne=ne.map(E,this),Ge=R.call(this,Ne,le),nt=F.call(this,Ge,Ne,le),bt=(le=-1,Ne.length),Ct=nt.length-1,Tt=oe?1:1/bt;++le<Ct;)(pe=Te[le]=[]).dx=nt[le+1]-(pe.x=nt[le]),pe.y=0;if(Ct>0)for(le=-1;++le<bt;)(ye=Ne[le])>=Ge[0]&&ye<=Ge[1]&&((pe=Te[t.bisect(nt,ye,1,Ct)-1]).y+=Tt,pe.push(ne[le]));return Te}return V.value=function(ne){return arguments.length?(E=ne,V):E},V.range=function(ne){return arguments.length?(R=_r(ne),V):R},V.bins=function(ne){return arguments.length?(F=typeof ne=="number"?function(le){return wi(le,ne)}:_r(ne),V):F},V.frequency=function(ne){return arguments.length?(oe=!!ne,V):oe},V},t.layout.pack=function(){var oe,E=t.layout.hierarchy().sort(ci),R=0,F=[1,1];function V(ne,le){var pe=E.call(this,ne,le),ye=pe[0],Te=F[0],Ne=F[1],Ge=oe==null?Math.sqrt:typeof oe=="function"?oe:function(){return oe};if(ye.x=ye.y=0,nr(ye,function(bt){bt.r=+Ge(bt.value)}),nr(ye,ao),R){var nt=R*(oe?1:Math.max(2*ye.r/Te,2*ye.r/Ne))/2;nr(ye,function(bt){bt.r+=nt}),nr(ye,ao),nr(ye,function(bt){bt.r-=nt})}return function bt(Ct,Tt,At,yt){var Ft=Ct.children;if(Ct.x=Tt+=yt*Ct.x,Ct.y=At+=yt*Ct.y,Ct.r*=yt,Ft)for(var zt=-1,jt=Ft.length;++zt<jt;)bt(Ft[zt],Tt,At,yt)}(ye,Te/2,Ne/2,oe?1:1/Math.max(2*ye.r/Te,2*ye.r/Ne)),pe}return V.size=function(ne){return arguments.length?(F=ne,V):F},V.radius=function(ne){return arguments.length?(oe=ne==null||typeof ne=="function"?ne:+ne,V):oe},V.padding=function(ne){return arguments.length?(R=+ne,V):R},$t(V,E)},t.layout.tree=function(){var oe=t.layout.hierarchy().sort(null).value(null),E=ft,R=[1,1],F=null;function V(ye,Te){var Ne=oe.call(this,ye,Te),Ge=Ne[0],nt=function(zt){for(var jt,rr={A:null,children:[zt]},hr=[rr];(jt=hr.pop())!=null;)for(var Ar,kr=jt.children,Kr=0,Zr=kr.length;Kr<Zr;++Kr)hr.push((kr[Kr]=Ar={_:kr[Kr],parent:jt,children:(Ar=kr[Kr].children)&&Ar.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:Kr}).a=Ar);return rr.children[0]}(Ge);if(nr(nt,ne),nt.parent.m=-nt.z,Yt(nt,le),F)Yt(Ge,pe);else{var bt=Ge,Ct=Ge,Tt=Ge;Yt(Ge,function(zt){zt.x<bt.x&&(bt=zt),zt.x>Ct.x&&(Ct=zt),zt.depth>Tt.depth&&(Tt=zt)});var At=E(bt,Ct)/2-bt.x,yt=R[0]/(Ct.x+E(Ct,bt)/2+At),Ft=R[1]/(Tt.depth||1);Yt(Ge,function(zt){zt.x=(zt.x+At)*yt,zt.y=zt.depth*Ft})}return Ne}function ne(ye){var Te=ye.children,Ne=ye.parent.children,Ge=ye.i?Ne[ye.i-1]:null;if(Te.length){(function(bt){for(var Ct,Tt=0,At=0,yt=bt.children,Ft=yt.length;--Ft>=0;)(Ct=yt[Ft]).z+=Tt,Ct.m+=Tt,Tt+=Ct.s+(At+=Ct.c)})(ye);var nt=(Te[0].z+Te[Te.length-1].z)/2;Ge?(ye.z=Ge.z+E(ye._,Ge._),ye.m=ye.z-nt):ye.z=nt}else Ge&&(ye.z=Ge.z+E(ye._,Ge._));ye.parent.A=function(bt,Ct,Tt){if(Ct){for(var At,yt=bt,Ft=bt,zt=Ct,jt=yt.parent.children[0],rr=yt.m,hr=Ft.m,Ar=zt.m,kr=jt.m;zt=sr(zt),yt=Rt(yt),zt&&yt;)jt=Rt(jt),(Ft=sr(Ft)).a=bt,(At=zt.z+Ar-yt.z-rr+E(zt._,yt._))>0&&(Vt(lr(zt,bt,Tt),bt,At),rr+=At,hr+=At),Ar+=zt.m,rr+=yt.m,kr+=jt.m,hr+=Ft.m;zt&&!sr(Ft)&&(Ft.t=zt,Ft.m+=Ar-hr),yt&&!Rt(jt)&&(jt.t=yt,jt.m+=rr-kr,Tt=bt)}return Tt}(ye,Ge,ye.parent.A||Ne[0])}function le(ye){ye._.x=ye.z+ye.parent.m,ye.m+=ye.parent.m}function pe(ye){ye.x*=R[0],ye.y=ye.depth*R[1]}return V.separation=function(ye){return arguments.length?(E=ye,V):E},V.size=function(ye){return arguments.length?(F=(R=ye)==null?pe:null,V):F?null:R},V.nodeSize=function(ye){return arguments.length?(F=(R=ye)==null?null:pe,V):F?R:null},$t(V,oe)},t.layout.cluster=function(){var oe=t.layout.hierarchy().sort(null).value(null),E=ft,R=[1,1],F=!1;function V(ne,le){var pe,ye=oe.call(this,ne,le),Te=ye[0],Ne=0;nr(Te,function(Tt){var At=Tt.children;At&&At.length?(Tt.x=function(yt){return yt.reduce(function(Ft,zt){return Ft+zt.x},0)/yt.length}(At),Tt.y=function(yt){return 1+t.max(yt,function(Ft){return Ft.y})}(At)):(Tt.x=pe?Ne+=E(Tt,pe):0,Tt.y=0,pe=Tt)});var Ge=function Tt(At){var yt=At.children;return yt&&yt.length?Tt(yt[0]):At}(Te),nt=function Tt(At){var yt,Ft=At.children;return Ft&&(yt=Ft.length)?Tt(Ft[yt-1]):At}(Te),bt=Ge.x-E(Ge,nt)/2,Ct=nt.x+E(nt,Ge)/2;return nr(Te,F?function(Tt){Tt.x=(Tt.x-Te.x)*R[0],Tt.y=(Te.y-Tt.y)*R[1]}:function(Tt){Tt.x=(Tt.x-bt)/(Ct-bt)*R[0],Tt.y=(1-(Te.y?Tt.y/Te.y:1))*R[1]}),ye}return V.separation=function(ne){return arguments.length?(E=ne,V):E},V.size=function(ne){return arguments.length?(F=(R=ne)==null,V):F?null:R},V.nodeSize=function(ne){return arguments.length?(F=(R=ne)!=null,V):F?R:null},$t(V,oe)},t.layout.treemap=function(){var oe,E=t.layout.hierarchy(),R=Math.round,F=[1,1],V=null,ne=Lr,le=!1,pe="squarify",ye=.5*(1+Math.sqrt(5));function Te(Tt,At){for(var yt,Ft,zt=-1,jt=Tt.length;++zt<jt;)Ft=(yt=Tt[zt]).value*(At<0?0:At),yt.area=isNaN(Ft)||Ft<=0?0:Ft}function Ne(Tt){var At=Tt.children;if(At&&At.length){var yt,Ft,zt,jt=ne(Tt),rr=[],hr=At.slice(),Ar=1/0,kr=pe==="slice"?jt.dx:pe==="dice"?jt.dy:pe==="slice-dice"?1&Tt.depth?jt.dy:jt.dx:Math.min(jt.dx,jt.dy);for(Te(hr,jt.dx*jt.dy/Tt.value),rr.area=0;(zt=hr.length)>0;)rr.push(yt=hr[zt-1]),rr.area+=yt.area,pe!=="squarify"||(Ft=nt(rr,kr))<=Ar?(hr.pop(),Ar=Ft):(rr.area-=rr.pop().area,bt(rr,kr,jt,!1),kr=Math.min(jt.dx,jt.dy),rr.length=rr.area=0,Ar=1/0);rr.length&&(bt(rr,kr,jt,!0),rr.length=rr.area=0),At.forEach(Ne)}}function Ge(Tt){var At=Tt.children;if(At&&At.length){var yt,Ft=ne(Tt),zt=At.slice(),jt=[];for(Te(zt,Ft.dx*Ft.dy/Tt.value),jt.area=0;yt=zt.pop();)jt.push(yt),jt.area+=yt.area,yt.z!=null&&(bt(jt,yt.z?Ft.dx:Ft.dy,Ft,!zt.length),jt.length=jt.area=0);At.forEach(Ge)}}function nt(Tt,At){for(var yt,Ft=Tt.area,zt=0,jt=1/0,rr=-1,hr=Tt.length;++rr<hr;)(yt=Tt[rr].area)&&(yt<jt&&(jt=yt),yt>zt&&(zt=yt));return At*=At,(Ft*=Ft)?Math.max(At*zt*ye/Ft,Ft/(At*jt*ye)):1/0}function bt(Tt,At,yt,Ft){var zt,jt=-1,rr=Tt.length,hr=yt.x,Ar=yt.y,kr=At?R(Tt.area/At):0;if(At==yt.dx){for((Ft||kr>yt.dy)&&(kr=yt.dy);++jt<rr;)(zt=Tt[jt]).x=hr,zt.y=Ar,zt.dy=kr,hr+=zt.dx=Math.min(yt.x+yt.dx-hr,kr?R(zt.area/kr):0);zt.z=!0,zt.dx+=yt.x+yt.dx-hr,yt.y+=kr,yt.dy-=kr}else{for((Ft||kr>yt.dx)&&(kr=yt.dx);++jt<rr;)(zt=Tt[jt]).x=hr,zt.y=Ar,zt.dx=kr,Ar+=zt.dy=Math.min(yt.y+yt.dy-Ar,kr?R(zt.area/kr):0);zt.z=!1,zt.dy+=yt.y+yt.dy-Ar,yt.x+=kr,yt.dx-=kr}}function Ct(Tt){var At=oe||E(Tt),yt=At[0];return yt.x=yt.y=0,yt.value?(yt.dx=F[0],yt.dy=F[1]):yt.dx=yt.dy=0,oe&&E.revalue(yt),Te([yt],yt.dx*yt.dy/yt.value),(oe?Ge:Ne)(yt),le&&(oe=At),At}return Ct.size=function(Tt){return arguments.length?(F=Tt,Ct):F},Ct.padding=function(Tt){if(!arguments.length)return V;function At(zt){var jt=Tt.call(Ct,zt,zt.depth);return jt==null?Lr(zt):zr(zt,typeof jt=="number"?[jt,jt,jt,jt]:jt)}function yt(zt){return zr(zt,Tt)}var Ft;return ne=(V=Tt)==null?Lr:(Ft=typeof Tt)=="function"?At:(Ft==="number"&&(Tt=[Tt,Tt,Tt,Tt]),yt),Ct},Ct.round=function(Tt){return arguments.length?(R=Tt?Math.round:Number,Ct):R!=Number},Ct.sticky=function(Tt){return arguments.length?(le=Tt,oe=null,Ct):le},Ct.ratio=function(Tt){return arguments.length?(ye=Tt,Ct):ye},Ct.mode=function(Tt){return arguments.length?(pe=Tt+"",Ct):pe},$t(Ct,E)},t.random={normal:function(oe,E){var R=arguments.length;return R<2&&(E=1),R<1&&(oe=0),function(){var F,V,ne;do ne=(F=2*Math.random()-1)*F+(V=2*Math.random()-1)*V;while(!ne||ne>1);return oe+E*F*Math.sqrt(-2*Math.log(ne)/ne)}},logNormal:function(){var oe=t.random.normal.apply(t,arguments);return function(){return Math.exp(oe())}},bates:function(oe){var E=t.random.irwinHall(oe);return function(){return E()/oe}},irwinHall:function(oe){return function(){for(var E=0,R=0;R<oe;R++)E+=Math.random();return E}}},t.scale={};var un={floor:D,ceil:D};function Tn(oe,E,R,F){var V=[],ne=[],le=0,pe=Math.min(oe.length,E.length)-1;for(oe[pe]<oe[0]&&(oe=oe.slice().reverse(),E=E.slice().reverse());++le<=pe;)V.push(R(oe[le-1],oe[le])),ne.push(F(E[le-1],E[le]));return function(ye){var Te=t.bisect(oe,ye,1,pe)-1;return ne[Te](V[Te](ye))}}function Rn(oe,E){return t.rebind(oe,E,"range","rangeRound","interpolate","clamp")}function Vn(oe,E){return mn(oe,wn(ta(oe,E)[2])),mn(oe,wn(ta(oe,E)[2])),oe}function ta(oe,E){E==null&&(E=10);var R=Yr(oe),F=R[1]-R[0],V=Math.pow(10,Math.floor(Math.log(F/E)/Math.LN10)),ne=E/F*V;return ne<=.15?V*=10:ne<=.35?V*=5:ne<=.75&&(V*=2),R[0]=Math.ceil(R[0]/V)*V,R[1]=Math.floor(R[1]/V)*V+.5*V,R[2]=V,R}function Xr(oe,E){return t.range.apply(t,ta(oe,E))}t.scale.linear=function(){return function oe(E,R,F,V){var ne,le;function pe(){var Te=Math.min(E.length,R.length)>2?Tn:on,Ne=V?Ho:zs;return ne=Te(E,R,Ne,F),le=Te(R,E,Ne,Ui),ye}function ye(Te){return ne(Te)}return ye.invert=function(Te){return le(Te)},ye.domain=function(Te){return arguments.length?(E=Te.map(Number),pe()):E},ye.range=function(Te){return arguments.length?(R=Te,pe()):R},ye.rangeRound=function(Te){return ye.range(Te).interpolate(rs)},ye.clamp=function(Te){return arguments.length?(V=Te,pe()):V},ye.interpolate=function(Te){return arguments.length?(F=Te,pe()):F},ye.ticks=function(Te){return Xr(E,Te)},ye.tickFormat=function(Te,Ne){return d3_scale_linearTickFormat(E,Te,Ne)},ye.nice=function(Te){return Vn(E,Te),pe()},ye.copy=function(){return oe(E,R,F,V)},pe()}([0,1],[0,1],Ui,!1)},t.scale.log=function(){return function oe(E,R,F,V){function ne(ye){return(F?Math.log(ye<0?0:ye):-Math.log(ye>0?0:-ye))/Math.log(R)}function le(ye){return F?Math.pow(R,ye):-Math.pow(R,-ye)}function pe(ye){return E(ne(ye))}return pe.invert=function(ye){return le(E.invert(ye))},pe.domain=function(ye){return arguments.length?(F=ye[0]>=0,E.domain((V=ye.map(Number)).map(ne)),pe):V},pe.base=function(ye){return arguments.length?(R=+ye,E.domain(V.map(ne)),pe):R},pe.nice=function(){var ye=mn(V.map(ne),F?Math:$n);return E.domain(ye),V=ye.map(le),pe},pe.ticks=function(){var ye=Yr(V),Te=[],Ne=ye[0],Ge=ye[1],nt=Math.floor(ne(Ne)),bt=Math.ceil(ne(Ge)),Ct=R%1?2:R;if(isFinite(bt-nt)){if(F){for(;nt<bt;nt++)for(var Tt=1;Tt<Ct;Tt++)Te.push(le(nt)*Tt);Te.push(le(nt))}else for(Te.push(le(nt));nt++<bt;)for(Tt=Ct-1;Tt>0;Tt--)Te.push(le(nt)*Tt);for(nt=0;Te[nt]<Ne;nt++);for(bt=Te.length;Te[bt-1]>Ge;bt--);Te=Te.slice(nt,bt)}return Te},pe.copy=function(){return oe(E.copy(),R,F,V)},Rn(pe,E)}(t.scale.linear().domain([0,1]),10,!0,[1,10])};var $n={floor:function(oe){return-Math.ceil(-oe)},ceil:function(oe){return-Math.floor(-oe)}};function Ln(oe){return function(E){return E<0?-Math.pow(-E,oe):Math.pow(E,oe)}}t.scale.pow=function(){return function oe(E,R,F){var V=Ln(R),ne=Ln(1/R);function le(pe){return E(V(pe))}return le.invert=function(pe){return ne(E.invert(pe))},le.domain=function(pe){return arguments.length?(E.domain((F=pe.map(Number)).map(V)),le):F},le.ticks=function(pe){return Xr(F,pe)},le.tickFormat=function(pe,ye){return d3_scale_linearTickFormat(F,pe,ye)},le.nice=function(pe){return le.domain(Vn(F,pe))},le.exponent=function(pe){return arguments.length?(V=Ln(R=pe),ne=Ln(1/R),E.domain(F.map(V)),le):R},le.copy=function(){return oe(E.copy(),R,F)},Rn(le,E)}(t.scale.linear(),1,[0,1])},t.scale.sqrt=function(){return t.scale.pow().exponent(.5)},t.scale.ordinal=function(){return function oe(E,R){var F,V,ne;function le(ye){return V[((F.get(ye)||(R.t==="range"?F.set(ye,E.push(ye)):NaN))-1)%V.length]}function pe(ye,Te){return t.range(E.length).map(function(Ne){return ye+Te*Ne})}return le.domain=function(ye){if(!arguments.length)return E;E=[],F=new T;for(var Te,Ne=-1,Ge=ye.length;++Ne<Ge;)F.has(Te=ye[Ne])||F.set(Te,E.push(Te));return le[R.t].apply(le,R.a)},le.range=function(ye){return arguments.length?(V=ye,ne=0,R={t:"range",a:arguments},le):V},le.rangePoints=function(ye,Te){arguments.length<2&&(Te=0);var Ne=ye[0],Ge=ye[1],nt=E.length<2?(Ne=(Ne+Ge)/2,0):(Ge-Ne)/(E.length-1+Te);return V=pe(Ne+nt*Te/2,nt),ne=0,R={t:"rangePoints",a:arguments},le},le.rangeRoundPoints=function(ye,Te){arguments.length<2&&(Te=0);var Ne=ye[0],Ge=ye[1],nt=E.length<2?(Ne=Ge=Math.round((Ne+Ge)/2),0):(Ge-Ne)/(E.length-1+Te)|0;return V=pe(Ne+Math.round(nt*Te/2+(Ge-Ne-(E.length-1+Te)*nt)/2),nt),ne=0,R={t:"rangeRoundPoints",a:arguments},le},le.rangeBands=function(ye,Te,Ne){arguments.length<2&&(Te=0),arguments.length<3&&(Ne=Te);var Ge=ye[1]<ye[0],nt=ye[Ge-0],bt=ye[1-Ge],Ct=(bt-nt)/(E.length-Te+2*Ne);return V=pe(nt+Ct*Ne,Ct),Ge&&V.reverse(),ne=Ct*(1-Te),R={t:"rangeBands",a:arguments},le},le.rangeRoundBands=function(ye,Te,Ne){arguments.length<2&&(Te=0),arguments.length<3&&(Ne=Te);var Ge=ye[1]<ye[0],nt=ye[Ge-0],bt=ye[1-Ge],Ct=Math.floor((bt-nt)/(E.length-Te+2*Ne));return V=pe(nt+Math.round((bt-nt-(E.length-Te)*Ct)/2),Ct),Ge&&V.reverse(),ne=Math.round(Ct*(1-Te)),R={t:"rangeRoundBands",a:arguments},le},le.rangeBand=function(){return ne},le.rangeExtent=function(){return Yr(R.a[0])},le.copy=function(){return oe(E,R)},le.domain(E)}([],{t:"range",a:[[]]})},t.scale.category10=function(){return t.scale.ordinal().range(jn)},t.scale.category20=function(){return t.scale.ordinal().range(Jn)},t.scale.category20b=function(){return t.scale.ordinal().range(Ta)},t.scale.category20c=function(){return t.scale.ordinal().range(Ca)};var jn=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Xt),Jn=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Xt),Ta=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Xt),Ca=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Xt);function Mn(){return 0}t.scale.quantile=function(){return function oe(E,R){var F;function V(){var le=0,pe=R.length;for(F=[];++le<pe;)F[le-1]=t.quantile(E,le/pe);return ne}function ne(le){if(!isNaN(le=+le))return R[t.bisect(F,le)]}return ne.domain=function(le){return arguments.length?(E=le.map(n).filter(a).sort(c),V()):E},ne.range=function(le){return arguments.length?(R=le,V()):R},ne.quantiles=function(){return F},ne.invertExtent=function(le){return(le=R.indexOf(le))<0?[NaN,NaN]:[le>0?F[le-1]:E[0],le<F.length?F[le]:E[E.length-1]]},ne.copy=function(){return oe(E,R)},V()}([],[])},t.scale.quantize=function(){return function oe(E,R,F){var V,ne;function le(ye){return F[Math.max(0,Math.min(ne,Math.floor(V*(ye-E))))]}function pe(){return V=F.length/(R-E),ne=F.length-1,le}return le.domain=function(ye){return arguments.length?(E=+ye[0],R=+ye[ye.length-1],pe()):[E,R]},le.range=function(ye){return arguments.length?(F=ye,pe()):F},le.invertExtent=function(ye){return[ye=(ye=F.indexOf(ye))<0?NaN:ye/V+E,ye+1/V]},le.copy=function(){return oe(E,R,F)},pe()}(0,1,[0,1])},t.scale.threshold=function(){return function oe(E,R){function F(V){if(V<=V)return R[t.bisect(E,V)]}return F.domain=function(V){return arguments.length?(E=V,F):E},F.range=function(V){return arguments.length?(R=V,F):R},F.invertExtent=function(V){return V=R.indexOf(V),[E[V-1],E[V]]},F.copy=function(){return oe(E,R)},F}([.5],[0,1])},t.scale.identity=function(){return function oe(E){function R(F){return+F}return R.invert=R,R.domain=R.range=function(F){return arguments.length?(E=F.map(R),R):E},R.ticks=function(F){return Xr(E,F)},R.tickFormat=function(F,V){return d3_scale_linearTickFormat(E,F,V)},R.copy=function(){return oe(E)},R}([0,1])},t.svg={},t.svg.arc=function(){var oe=Sa,E=da,R=Mn,F=Da,V=za,ne=Aa,le=ti;function pe(){var Te=Math.max(0,+oe.apply(this,arguments)),Ne=Math.max(0,+E.apply(this,arguments)),Ge=V.apply(this,arguments)-He,nt=ne.apply(this,arguments)-He,bt=Math.abs(nt-Ge),Ct=Ge>nt?0:1;if(Ne<Te&&(Tt=Ne,Ne=Te,Te=Tt),bt>=Ue)return ye(Ne,Ct)+(Te?ye(Te,1-Ct):"")+"Z";var Tt,At,yt,Ft,zt,jt,rr,hr,Ar,kr,Kr,Zr,hn=0,sn=0,Un=[];if((Ft=(+le.apply(this,arguments)||0)/2)&&(yt=F===Da?Math.sqrt(Te*Te+Ne*Ne):+F.apply(this,arguments),Ct||(sn*=-1),Ne&&(sn=_e(yt/Ne*Math.sin(Ft))),Te&&(hn=_e(yt/Te*Math.sin(Ft)))),Ne){zt=Ne*Math.cos(Ge+sn),jt=Ne*Math.sin(Ge+sn),rr=Ne*Math.cos(nt-sn),hr=Ne*Math.sin(nt-sn);var Wn=Math.abs(nt-Ge-2*sn)<=er?0:1;if(sn&&Qn(zt,jt,rr,hr)===Ct^Wn){var ua=(Ge+nt)/2;zt=Ne*Math.cos(ua),jt=Ne*Math.sin(ua),rr=hr=null}}else zt=jt=0;if(Te){Ar=Te*Math.cos(nt-hn),kr=Te*Math.sin(nt-hn),Kr=Te*Math.cos(Ge+hn),Zr=Te*Math.sin(Ge+hn);var Ur=Math.abs(Ge-nt+2*hn)<=er?0:1;if(hn&&Qn(Ar,kr,Kr,Zr)===1-Ct^Ur){var kn=(Ge+nt)/2;Ar=Te*Math.cos(kn),kr=Te*Math.sin(kn),Kr=Zr=null}}else Ar=kr=0;if(bt>_t&&(Tt=Math.min(Math.abs(Ne-Te)/2,+R.apply(this,arguments)))>.001){At=Te<Ne^Ct?0:1;var Xn=Tt,Gn=Tt;if(bt<er){var ea=Kr==null?[Ar,kr]:rr==null?[zt,jt]:It([zt,jt],[Kr,Zr],[rr,hr],[Ar,kr]),fa=zt-ea[0],Ma=jt-ea[1],Kn=rr-ea[0],xa=hr-ea[1],ma=1/Math.sin(Math.acos((fa*Kn+Ma*xa)/(Math.sqrt(fa*fa+Ma*Ma)*Math.sqrt(Kn*Kn+xa*xa)))/2),La=Math.sqrt(ea[0]*ea[0]+ea[1]*ea[1]);Gn=Math.min(Tt,(Te-La)/(ma-1)),Xn=Math.min(Tt,(Ne-La)/(ma+1))}if(rr!=null){var ba=Za(Kr==null?[Ar,kr]:[Kr,Zr],[zt,jt],Ne,Xn,Ct),Pa=Za([rr,hr],[Ar,kr],Ne,Xn,Ct);Tt===Xn?Un.push("M",ba[0],"A",Xn,",",Xn," 0 0,",At," ",ba[1],"A",Ne,",",Ne," 0 ",1-Ct^Qn(ba[1][0],ba[1][1],Pa[1][0],Pa[1][1]),",",Ct," ",Pa[1],"A",Xn,",",Xn," 0 0,",At," ",Pa[0]):Un.push("M",ba[0],"A",Xn,",",Xn," 0 1,",At," ",Pa[0])}else Un.push("M",zt,",",jt);if(Kr!=null){var Ua=Za([zt,jt],[Kr,Zr],Te,-Gn,Ct),di=Za([Ar,kr],rr==null?[zt,jt]:[rr,hr],Te,-Gn,Ct);Tt===Gn?Un.push("L",di[0],"A",Gn,",",Gn," 0 0,",At," ",di[1],"A",Te,",",Te," 0 ",Ct^Qn(di[1][0],di[1][1],Ua[1][0],Ua[1][1]),",",1-Ct," ",Ua[1],"A",Gn,",",Gn," 0 0,",At," ",Ua[0]):Un.push("L",di[0],"A",Gn,",",Gn," 0 0,",At," ",Ua[0])}else Un.push("L",Ar,",",kr)}else Un.push("M",zt,",",jt),rr!=null&&Un.push("A",Ne,",",Ne," 0 ",Wn,",",Ct," ",rr,",",hr),Un.push("L",Ar,",",kr),Kr!=null&&Un.push("A",Te,",",Te," 0 ",Ur,",",1-Ct," ",Kr,",",Zr);return Un.push("Z"),Un.join("")}function ye(Te,Ne){return"M0,"+Te+"A"+Te+","+Te+" 0 1,"+Ne+" 0,"+-Te+"A"+Te+","+Te+" 0 1,"+Ne+" 0,"+Te}return pe.innerRadius=function(Te){return arguments.length?(oe=_r(Te),pe):oe},pe.outerRadius=function(Te){return arguments.length?(E=_r(Te),pe):E},pe.cornerRadius=function(Te){return arguments.length?(R=_r(Te),pe):R},pe.padRadius=function(Te){return arguments.length?(F=Te==Da?Da:_r(Te),pe):F},pe.startAngle=function(Te){return arguments.length?(V=_r(Te),pe):V},pe.endAngle=function(Te){return arguments.length?(ne=_r(Te),pe):ne},pe.padAngle=function(Te){return arguments.length?(le=_r(Te),pe):le},pe.centroid=function(){var Te=(+oe.apply(this,arguments)+ +E.apply(this,arguments))/2,Ne=(+V.apply(this,arguments)+ +ne.apply(this,arguments))/2-He;return[Math.cos(Ne)*Te,Math.sin(Ne)*Te]},pe};var Da="auto";function Sa(oe){return oe.innerRadius}function da(oe){return oe.outerRadius}function za(oe){return oe.startAngle}function Aa(oe){return oe.endAngle}function ti(oe){return oe&&oe.padAngle}function Qn(oe,E,R,F){return(oe-R)*E-(E-F)*oe>0?0:1}function Za(oe,E,R,F,V){var ne=oe[0]-E[0],le=oe[1]-E[1],pe=(V?F:-F)/Math.sqrt(ne*ne+le*le),ye=pe*le,Te=-pe*ne,Ne=oe[0]+ye,Ge=oe[1]+Te,nt=E[0]+ye,bt=E[1]+Te,Ct=(Ne+nt)/2,Tt=(Ge+bt)/2,At=nt-Ne,yt=bt-Ge,Ft=At*At+yt*yt,zt=R-F,jt=Ne*bt-nt*Ge,rr=(yt<0?-1:1)*Math.sqrt(Math.max(0,zt*zt*Ft-jt*jt)),hr=(jt*yt-At*rr)/Ft,Ar=(-jt*At-yt*rr)/Ft,kr=(jt*yt+At*rr)/Ft,Kr=(-jt*At+yt*rr)/Ft,Zr=hr-Ct,hn=Ar-Tt,sn=kr-Ct,Un=Kr-Tt;return Zr*Zr+hn*hn>sn*sn+Un*Un&&(hr=kr,Ar=Kr),[[hr-ye,Ar-Te],[hr*R/zt,Ar*R/zt]]}function Hi(){return!0}function cs(oe){var E=Qr,R=rn,F=Hi,V=Eo,ne=V.key,le=.7;function pe(ye){var Te,Ne=[],Ge=[],nt=-1,bt=ye.length,Ct=_r(E),Tt=_r(R);function At(){Ne.push("M",V(oe(Ge),le))}for(;++nt<bt;)F.call(this,Te=ye[nt],nt)?Ge.push([+Ct.call(this,Te,nt),+Tt.call(this,Te,nt)]):Ge.length&&(At(),Ge=[]);return Ge.length&&At(),Ne.length?Ne.join(""):null}return pe.x=function(ye){return arguments.length?(E=ye,pe):E},pe.y=function(ye){return arguments.length?(R=ye,pe):R},pe.defined=function(ye){return arguments.length?(F=ye,pe):F},pe.interpolate=function(ye){return arguments.length?(ne=typeof ye=="function"?V=ye:(V=Xo.get(ye)||Eo).key,pe):ne},pe.tension=function(ye){return arguments.length?(le=ye,pe):le},pe}t.svg.line=function(){return cs(D)};var Xo=t.map({linear:Eo,"linear-closed":va,step:function(oe){for(var E=0,R=oe.length,F=oe[0],V=[F[0],",",F[1]];++E<R;)V.push("H",(F[0]+(F=oe[E])[0])/2,"V",F[1]);return R>1&&V.push("H",F[0]),V.join("")},"step-before":yi,"step-after":Co,basis:Zi,"basis-open":function(oe){if(oe.length<4)return Eo(oe);for(var E,R=[],F=-1,V=oe.length,ne=[0],le=[0];++F<3;)E=oe[F],ne.push(E[0]),le.push(E[1]);for(R.push(ai(so,ne)+","+ai(so,le)),--F;++F<V;)E=oe[F],ne.shift(),ne.push(E[0]),le.shift(),le.push(E[1]),Ms(R,ne,le);return R.join("")},"basis-closed":function(oe){for(var E,R,F=-1,V=oe.length,ne=V+4,le=[],pe=[];++F<4;)R=oe[F%V],le.push(R[0]),pe.push(R[1]);for(E=[ai(so,le),",",ai(so,pe)],--F;++F<ne;)R=oe[F%V],le.shift(),le.push(R[0]),pe.shift(),pe.push(R[1]),Ms(E,le,pe);return E.join("")},bundle:function(oe,E){var R=oe.length-1;if(R)for(var F,V,ne=oe[0][0],le=oe[0][1],pe=oe[R][0]-ne,ye=oe[R][1]-le,Te=-1;++Te<=R;)F=oe[Te],V=Te/R,F[0]=E*F[0]+(1-E)*(ne+V*pe),F[1]=E*F[1]+(1-E)*(le+V*ye);return Zi(oe)},cardinal:function(oe,E){return oe.length<3?Eo(oe):oe[0]+Ka(oe,Si(oe,E))},"cardinal-open":function(oe,E){return oe.length<4?Eo(oe):oe[1]+Ka(oe.slice(1,-1),Si(oe,E))},"cardinal-closed":function(oe,E){return oe.length<3?va(oe):oe[0]+Ka((oe.push(oe[0]),oe),Si([oe[oe.length-2]].concat(oe,[oe[1]]),E))},monotone:function(oe){return oe.length<3?Eo(oe):oe[0]+Ka(oe,function(E){for(var R,F,V,ne,le=[],pe=function(Ne){for(var Ge=0,nt=Ne.length-1,bt=[],Ct=Ne[0],Tt=Ne[1],At=bt[0]=ys(Ct,Tt);++Ge<nt;)bt[Ge]=(At+(At=ys(Ct=Tt,Tt=Ne[Ge+1])))/2;return bt[Ge]=At,bt}(E),ye=-1,Te=E.length-1;++ye<Te;)R=ys(E[ye],E[ye+1]),v(R)<_t?pe[ye]=pe[ye+1]=0:(F=pe[ye]/R,V=pe[ye+1]/R,(ne=F*F+V*V)>9&&(ne=3*R/Math.sqrt(ne),pe[ye]=ne*F,pe[ye+1]=ne*V));for(ye=-1;++ye<=Te;)ne=(E[Math.min(Te,ye+1)][0]-E[Math.max(0,ye-1)][0])/(6*(1+pe[ye]*pe[ye])),le.push([ne||0,pe[ye]*ne||0]);return le}(oe))}});function Eo(oe){return oe.length>1?oe.join("L"):oe+"Z"}function va(oe){return oe.join("L")+"Z"}function yi(oe){for(var E=0,R=oe.length,F=oe[0],V=[F[0],",",F[1]];++E<R;)V.push("V",(F=oe[E])[1],"H",F[0]);return V.join("")}function Co(oe){for(var E=0,R=oe.length,F=oe[0],V=[F[0],",",F[1]];++E<R;)V.push("H",(F=oe[E])[0],"V",F[1]);return V.join("")}function Ka(oe,E){if(E.length<1||oe.length!=E.length&&oe.length!=E.length+2)return Eo(oe);var R=oe.length!=E.length,F="",V=oe[0],ne=oe[1],le=E[0],pe=le,ye=1;if(R&&(F+="Q"+(ne[0]-2*le[0]/3)+","+(ne[1]-2*le[1]/3)+","+ne[0]+","+ne[1],V=oe[1],ye=2),E.length>1){pe=E[1],ne=oe[ye],ye++,F+="C"+(V[0]+le[0])+","+(V[1]+le[1])+","+(ne[0]-pe[0])+","+(ne[1]-pe[1])+","+ne[0]+","+ne[1];for(var Te=2;Te<E.length;Te++,ye++)ne=oe[ye],pe=E[Te],F+="S"+(ne[0]-pe[0])+","+(ne[1]-pe[1])+","+ne[0]+","+ne[1]}if(R){var Ne=oe[ye];F+="Q"+(ne[0]+2*pe[0]/3)+","+(ne[1]+2*pe[1]/3)+","+Ne[0]+","+Ne[1]}return F}function Si(oe,E){for(var R,F=[],V=(1-E)/2,ne=oe[0],le=oe[1],pe=1,ye=oe.length;++pe<ye;)R=ne,ne=le,le=oe[pe],F.push([V*(le[0]-R[0]),V*(le[1]-R[1])]);return F}function Zi(oe){if(oe.length<3)return Eo(oe);var E=1,R=oe.length,F=oe[0],V=F[0],ne=F[1],le=[V,V,V,(F=oe[1])[0]],pe=[ne,ne,ne,F[1]],ye=[V,",",ne,"L",ai(so,le),",",ai(so,pe)];for(oe.push(oe[R-1]);++E<=R;)F=oe[E],le.shift(),le.push(F[0]),pe.shift(),pe.push(F[1]),Ms(ye,le,pe);return oe.pop(),ye.push("L",F),ye.join("")}function ai(oe,E){return oe[0]*E[0]+oe[1]*E[1]+oe[2]*E[2]+oe[3]*E[3]}Xo.forEach(function(oe,E){E.key=oe,E.closed=/-closed$/.test(oe)});var yo=[0,2/3,1/3,0],ii=[0,1/3,2/3,0],so=[0,1/6,2/3,1/6];function Ms(oe,E,R){oe.push("C",ai(yo,E),",",ai(yo,R),",",ai(ii,E),",",ai(ii,R),",",ai(so,E),",",ai(so,R))}function ys(oe,E){return(E[1]-oe[1])/(E[0]-oe[0])}function pl(oe){for(var E,R,F,V=-1,ne=oe.length;++V<ne;)R=(E=oe[V])[0],F=E[1]-He,E[0]=R*Math.cos(F),E[1]=R*Math.sin(F);return oe}function Bi(oe){var E=Qr,R=Qr,F=0,V=rn,ne=Hi,le=Eo,pe=le.key,ye=le,Te="L",Ne=.7;function Ge(nt){var bt,Ct,Tt,At=[],yt=[],Ft=[],zt=-1,jt=nt.length,rr=_r(E),hr=_r(F),Ar=E===R?function(){return Ct}:_r(R),kr=F===V?function(){return Tt}:_r(V);function Kr(){At.push("M",le(oe(Ft),Ne),Te,ye(oe(yt.reverse()),Ne),"Z")}for(;++zt<jt;)ne.call(this,bt=nt[zt],zt)?(yt.push([Ct=+rr.call(this,bt,zt),Tt=+hr.call(this,bt,zt)]),Ft.push([+Ar.call(this,bt,zt),+kr.call(this,bt,zt)])):yt.length&&(Kr(),yt=[],Ft=[]);return yt.length&&Kr(),At.length?At.join(""):null}return Ge.x=function(nt){return arguments.length?(E=R=nt,Ge):R},Ge.x0=function(nt){return arguments.length?(E=nt,Ge):E},Ge.x1=function(nt){return arguments.length?(R=nt,Ge):R},Ge.y=function(nt){return arguments.length?(F=V=nt,Ge):V},Ge.y0=function(nt){return arguments.length?(F=nt,Ge):F},Ge.y1=function(nt){return arguments.length?(V=nt,Ge):V},Ge.defined=function(nt){return arguments.length?(ne=nt,Ge):ne},Ge.interpolate=function(nt){return arguments.length?(pe=typeof nt=="function"?le=nt:(le=Xo.get(nt)||Eo).key,ye=le.reverse||le,Te=le.closed?"M":"L",Ge):pe},Ge.tension=function(nt){return arguments.length?(Ne=nt,Ge):Ne},Ge}function dl(oe){return oe.source}function Ni(oe){return oe.target}function xs(oe){return oe.radius}function la(oe){return[oe.x,oe.y]}function ya(oe){return function(){var E=oe.apply(this,arguments),R=E[0],F=E[1]-He;return[R*Math.cos(F),R*Math.sin(F)]}}function ml(){return 64}function vl(){return"circle"}function bs(oe){var E=Math.sqrt(oe/er);return"M0,"+E+"A"+E+","+E+" 0 1,1 0,"+-E+"A"+E+","+E+" 0 1,1 0,"+E+"Z"}t.svg.line.radial=function(){var oe=cs(pl);return oe.radius=oe.x,delete oe.x,oe.angle=oe.y,delete oe.y,oe},yi.reverse=Co,Co.reverse=yi,t.svg.area=function(){return Bi(D)},t.svg.area.radial=function(){var oe=Bi(pl);return oe.radius=oe.x,delete oe.x,oe.innerRadius=oe.x0,delete oe.x0,oe.outerRadius=oe.x1,delete oe.x1,oe.angle=oe.y,delete oe.y,oe.startAngle=oe.y0,delete oe.y0,oe.endAngle=oe.y1,delete oe.y1,oe},t.svg.chord=function(){var oe=dl,E=Ni,R=xs,F=za,V=Aa;function ne(Te,Ne){var Ge,nt,bt=le(this,oe,Te,Ne),Ct=le(this,E,Te,Ne);return"M"+bt.p0+pe(bt.r,bt.p1,bt.a1-bt.a0)+(nt=Ct,((Ge=bt).a0==nt.a0&&Ge.a1==nt.a1?ye(bt.r,bt.p1,bt.r,bt.p0):ye(bt.r,bt.p1,Ct.r,Ct.p0)+pe(Ct.r,Ct.p1,Ct.a1-Ct.a0)+ye(Ct.r,Ct.p1,bt.r,bt.p0))+"Z")}function le(Te,Ne,Ge,nt){var bt=Ne.call(Te,Ge,nt),Ct=R.call(Te,bt,nt),Tt=F.call(Te,bt,nt)-He,At=V.call(Te,bt,nt)-He;return{r:Ct,a0:Tt,a1:At,p0:[Ct*Math.cos(Tt),Ct*Math.sin(Tt)],p1:[Ct*Math.cos(At),Ct*Math.sin(At)]}}function pe(Te,Ne,Ge){return"A"+Te+","+Te+" 0 "+ +(Ge>er)+",1 "+Ne}function ye(Te,Ne,Ge,nt){return"Q 0,0 "+nt}return ne.radius=function(Te){return arguments.length?(R=_r(Te),ne):R},ne.source=function(Te){return arguments.length?(oe=_r(Te),ne):oe},ne.target=function(Te){return arguments.length?(E=_r(Te),ne):E},ne.startAngle=function(Te){return arguments.length?(F=_r(Te),ne):F},ne.endAngle=function(Te){return arguments.length?(V=_r(Te),ne):V},ne},t.svg.diagonal=function(){var oe=dl,E=Ni,R=la;function F(V,ne){var le=oe.call(this,V,ne),pe=E.call(this,V,ne),ye=(le.y+pe.y)/2,Te=[le,{x:le.x,y:ye},{x:pe.x,y:ye},pe];return"M"+(Te=Te.map(R))[0]+"C"+Te[1]+" "+Te[2]+" "+Te[3]}return F.source=function(V){return arguments.length?(oe=_r(V),F):oe},F.target=function(V){return arguments.length?(E=_r(V),F):E},F.projection=function(V){return arguments.length?(R=V,F):R},F},t.svg.diagonal.radial=function(){var oe=t.svg.diagonal(),E=la,R=oe.projection;return oe.projection=function(F){return arguments.length?R(ya(E=F)):E},oe},t.svg.symbol=function(){var oe=vl,E=ml;function R(F,V){return(Go.get(oe.call(this,F,V))||bs)(E.call(this,F,V))}return R.type=function(F){return arguments.length?(oe=_r(F),R):oe},R.size=function(F){return arguments.length?(E=_r(F),R):E},R};var Go=t.map({circle:bs,cross:function(oe){var E=Math.sqrt(oe/5)/2;return"M"+-3*E+","+-E+"H"+-E+"V"+-3*E+"H"+E+"V"+-E+"H"+3*E+"V"+E+"H"+E+"V"+3*E+"H"+-E+"V"+E+"H"+-3*E+"Z"},diamond:function(oe){var E=Math.sqrt(oe/(2*Il)),R=E*Il;return"M0,"+-E+"L"+R+",0 0,"+E+" "+-R+",0Z"},square:function(oe){var E=Math.sqrt(oe)/2;return"M"+-E+","+-E+"L"+E+","+-E+" "+E+","+E+" "+-E+","+E+"Z"},"triangle-down":function(oe){var E=Math.sqrt(oe/is),R=E*is/2;return"M0,"+R+"L"+E+","+-R+" "+-E+","+-R+"Z"},"triangle-up":function(oe){var E=Math.sqrt(oe/is),R=E*is/2;return"M0,"+-R+"L"+E+","+R+" "+-E+","+R+"Z"}});t.svg.symbolTypes=Go.keys();var is=Math.sqrt(3),Il=Math.tan(30*Be);te.transition=function(oe){for(var E,R,F=Rs||++Fs,V=el(oe),ne=[],le=Ss||{time:Date.now(),ease:Hs,delay:0,duration:250},pe=-1,ye=this.length;++pe<ye;){ne.push(E=[]);for(var Te=this[pe],Ne=-1,Ge=Te.length;++Ne<Ge;)(R=Te[Ne])&&Es(R,Ne,V,F,le),E.push(R)}return oi(ne,V,F)},te.interrupt=function(oe){return this.each(oe==null?$s:Ja(el(oe)))};var $s=Ja(el());function Ja(oe){return function(){var E,R,F;(E=this[oe])&&(F=E[R=E.active])&&(F.timer.c=null,F.timer.t=NaN,--E.count?delete E[R]:delete this[oe],E.active+=.5,F.event&&F.event.interrupt.call(this,this.__data__,F.index))}}function oi(oe,E,R){return j(oe,Di),oe.namespace=E,oe.id=R,oe}var Rs,Ss,Di=[],Fs=0;function Qs(oe,E,R,F){var V=oe.id,ne=oe.namespace;return Fe(oe,typeof R=="function"?function(le,pe,ye){le[ne][V].tween.set(E,F(R.call(le,le.__data__,pe,ye)))}:(R=F(R),function(le){le[ne][V].tween.set(E,R)}))}function Gs(oe){return oe==null&&(oe=""),function(){this.textContent=oe}}function el(oe){return oe==null?"__transition__":"__transition_"+oe+"__"}function Es(oe,E,R,F,V){var ne,le,pe,ye,Te,Ne=oe[R]||(oe[R]={active:0,count:0}),Ge=Ne[F];function nt(Ct){var Tt=Ne.active,At=Ne[Tt];for(var yt in At&&(At.timer.c=null,At.timer.t=NaN,--Ne.count,delete Ne[Tt],At.event&&At.event.interrupt.call(oe,oe.__data__,At.index)),Ne)if(+yt<F){var Ft=Ne[yt];Ft.timer.c=null,Ft.timer.t=NaN,--Ne.count,delete Ne[yt]}le.c=bt,Nr(function(){return le.c&&bt(Ct||1)&&(le.c=null,le.t=NaN),1},0,ne),Ne.active=F,Ge.event&&Ge.event.start.call(oe,oe.__data__,E),Te=[],Ge.tween.forEach(function(zt,jt){(jt=jt.call(oe,oe.__data__,E))&&Te.push(jt)}),ye=Ge.ease,pe=Ge.duration}function bt(Ct){for(var Tt=Ct/pe,At=ye(Tt),yt=Te.length;yt>0;)Te[--yt].call(oe,At);if(Tt>=1)return Ge.event&&Ge.event.end.call(oe,oe.__data__,E),--Ne.count?delete Ne[F]:delete oe[R],1}Ge||(ne=V.time,le=Nr(function(Ct){var Tt=Ge.delay;if(le.t=Tt+ne,Tt<=Ct)return nt(Ct-Tt);le.c=nt},0,ne),Ge=Ne[F]={tween:new T,time:ne,timer:le,delay:V.delay,duration:V.duration,ease:V.ease,index:E},V=null,++Ne.count)}Di.call=te.call,Di.empty=te.empty,Di.node=te.node,Di.size=te.size,t.transition=function(oe,E){return oe&&oe.transition?Rs?oe.transition(E):oe:t.selection().transition(oe)},t.transition.prototype=Di,Di.select=function(oe){var E,R,F,V=this.id,ne=this.namespace,le=[];oe=ie(oe);for(var pe=-1,ye=this.length;++pe<ye;){le.push(E=[]);for(var Te=this[pe],Ne=-1,Ge=Te.length;++Ne<Ge;)(F=Te[Ne])&&(R=oe.call(F,F.__data__,Ne,pe))?("__data__"in F&&(R.__data__=F.__data__),Es(R,Ne,ne,V,F[ne][V]),E.push(R)):E.push(null)}return oi(le,ne,V)},Di.selectAll=function(oe){var E,R,F,V,ne,le=this.id,pe=this.namespace,ye=[];oe=ae(oe);for(var Te=-1,Ne=this.length;++Te<Ne;)for(var Ge=this[Te],nt=-1,bt=Ge.length;++nt<bt;)if(F=Ge[nt]){ne=F[pe][le],R=oe.call(F,F.__data__,nt,Te),ye.push(E=[]);for(var Ct=-1,Tt=R.length;++Ct<Tt;)(V=R[Ct])&&Es(V,Ct,pe,le,ne),E.push(V)}return oi(ye,pe,le)},Di.filter=function(oe){var E,R,F=[];typeof oe!="function"&&(oe=Se(oe));for(var V=0,ne=this.length;V<ne;V++){F.push(E=[]);for(var le,pe=0,ye=(le=this[V]).length;pe<ye;pe++)(R=le[pe])&&oe.call(R,R.__data__,pe,V)&&E.push(R)}return oi(F,this.namespace,this.id)},Di.tween=function(oe,E){var R=this.id,F=this.namespace;return arguments.length<2?this.node()[F][R].tween.get(oe):Fe(this,E==null?function(V){V[F][R].tween.remove(oe)}:function(V){V[F][R].tween.set(oe,E)})},Di.attr=function(oe,E){if(arguments.length<2){for(E in oe)this.attr(E,oe[E]);return this}var R=oe=="transform"?as:Ui,F=t.ns.qualify(oe);function V(){this.removeAttribute(F)}function ne(){this.removeAttributeNS(F.space,F.local)}function le(ye){return ye==null?V:(ye+="",function(){var Te,Ne=this.getAttribute(F);return Ne!==ye&&(Te=R(Ne,ye),function(Ge){this.setAttribute(F,Te(Ge))})})}function pe(ye){return ye==null?ne:(ye+="",function(){var Te,Ne=this.getAttributeNS(F.space,F.local);return Ne!==ye&&(Te=R(Ne,ye),function(Ge){this.setAttributeNS(F.space,F.local,Te(Ge))})})}return Qs(this,"attr."+oe,E,F.local?pe:le)},Di.attrTween=function(oe,E){var R=t.ns.qualify(oe);return this.tween("attr."+oe,R.local?function(F,V){var ne=E.call(this,F,V,this.getAttributeNS(R.space,R.local));return ne&&function(le){this.setAttributeNS(R.space,R.local,ne(le))}}:function(F,V){var ne=E.call(this,F,V,this.getAttribute(R));return ne&&function(le){this.setAttribute(R,ne(le))}})},Di.style=function(oe,E,R){var F=arguments.length;if(F<3){if(typeof oe!="string"){for(R in F<2&&(E=""),oe)this.style(R,oe[R],E);return this}R=""}function V(){this.style.removeProperty(oe)}function ne(le){return le==null?V:(le+="",function(){var pe,ye=f(this).getComputedStyle(this,null).getPropertyValue(oe);return ye!==le&&(pe=Ui(ye,le),function(Te){this.style.setProperty(oe,pe(Te),R)})})}return Qs(this,"style."+oe,E,ne)},Di.styleTween=function(oe,E,R){function F(V,ne){var le=E.call(this,V,ne,f(this).getComputedStyle(this,null).getPropertyValue(oe));return le&&function(pe){this.style.setProperty(oe,le(pe),R)}}return arguments.length<3&&(R=""),this.tween("style."+oe,F)},Di.text=function(oe){return Qs(this,"text",oe,Gs)},Di.remove=function(){var oe=this.namespace;return this.each("end.transition",function(){var E;this[oe].count<2&&(E=this.parentNode)&&E.removeChild(this)})},Di.ease=function(oe){var E=this.id,R=this.namespace;return arguments.length<1?this.node()[R][E].ease:(typeof oe!="function"&&(oe=t.ease.apply(t,arguments)),Fe(this,function(F){F[R][E].ease=oe}))},Di.delay=function(oe){var E=this.id,R=this.namespace;return arguments.length<1?this.node()[R][E].delay:Fe(this,typeof oe=="function"?function(F,V,ne){F[R][E].delay=+oe.call(F,F.__data__,V,ne)}:(oe=+oe,function(F){F[R][E].delay=oe}))},Di.duration=function(oe){var E=this.id,R=this.namespace;return arguments.length<1?this.node()[R][E].duration:Fe(this,typeof oe=="function"?function(F,V,ne){F[R][E].duration=Math.max(1,oe.call(F,F.__data__,V,ne))}:(oe=Math.max(1,oe),function(F){F[R][E].duration=oe}))},Di.each=function(oe,E){var R=this.id,F=this.namespace;if(arguments.length<2){var V=Ss,ne=Rs;try{Rs=R,Fe(this,function(le,pe,ye){Ss=le[F][R],oe.call(le,le.__data__,pe,ye)})}finally{Ss=V,Rs=ne}}else Fe(this,function(le){var pe=le[F][R];(pe.event||(pe.event=t.dispatch("start","end","interrupt"))).on(oe,E)});return this},Di.transition=function(){for(var oe,E,R,F=this.id,V=++Fs,ne=this.namespace,le=[],pe=0,ye=this.length;pe<ye;pe++){le.push(oe=[]);for(var Te,Ne=0,Ge=(Te=this[pe]).length;Ne<Ge;Ne++)(E=Te[Ne])&&Es(E,Ne,ne,V,{time:(R=E[ne][F]).time,ease:R.ease,delay:R.delay+R.duration,duration:R.duration}),oe.push(E)}return oi(le,ne,V)},t.svg.axis=function(){var oe,E=t.scale.linear(),R=Ol,F=6,V=6,ne=3,le=[10],pe=null;function ye(Te){Te.each(function(){var Ne,Ge=t.select(this),nt=this.__chart__||E,bt=this.__chart__=E.copy(),Ct=pe==null?bt.ticks?bt.ticks.apply(bt,le):bt.domain():pe,Tt=oe==null?bt.tickFormat?bt.tickFormat.apply(bt,le):D:oe,At=Ge.selectAll(".tick").data(Ct,bt),yt=At.enter().insert("g",".domain").attr("class","tick").style("opacity",_t),Ft=t.transition(At.exit()).style("opacity",_t).remove(),zt=t.transition(At.order()).style("opacity",1),jt=Math.max(F,0)+ne,rr=ln(bt),hr=Ge.selectAll(".domain").data([0]),Ar=(hr.enter().append("path").attr("class","domain"),t.transition(hr));yt.append("line"),yt.append("text");var kr,Kr,Zr,hn,sn=yt.select("line"),Un=zt.select("line"),Wn=At.select("text").text(Tt),ua=yt.select("text"),Ur=zt.select("text"),kn=R==="top"||R==="left"?-1:1;if(R==="bottom"||R==="top"?(Ne=Bs,kr="x",Zr="y",Kr="x2",hn="y2",Wn.attr("dy",kn<0?"0em":".71em").style("text-anchor","middle"),Ar.attr("d","M"+rr[0]+","+kn*V+"V0H"+rr[1]+"V"+kn*V)):(Ne=Dl,kr="y",Zr="x",Kr="y2",hn="x2",Wn.attr("dy",".32em").style("text-anchor",kn<0?"end":"start"),Ar.attr("d","M"+kn*V+","+rr[0]+"H0V"+rr[1]+"H"+kn*V)),sn.attr(hn,kn*F),ua.attr(Zr,kn*jt),Un.attr(Kr,0).attr(hn,kn*F),Ur.attr(kr,0).attr(Zr,kn*jt),bt.rangeBand){var Xn=bt,Gn=Xn.rangeBand()/2;nt=bt=function(ea){return Xn(ea)+Gn}}else nt.rangeBand?nt=bt:Ft.call(Ne,bt,nt);yt.call(Ne,nt,bt),zt.call(Ne,bt,bt)})}return ye.scale=function(Te){return arguments.length?(E=Te,ye):E},ye.orient=function(Te){return arguments.length?(R=Te in Xl?Te+"":Ol,ye):R},ye.ticks=function(){return arguments.length?(le=m(arguments),ye):le},ye.tickValues=function(Te){return arguments.length?(pe=Te,ye):pe},ye.tickFormat=function(Te){return arguments.length?(oe=Te,ye):oe},ye.tickSize=function(Te){var Ne=arguments.length;return Ne?(F=+Te,V=+arguments[Ne-1],ye):F},ye.innerTickSize=function(Te){return arguments.length?(F=+Te,ye):F},ye.outerTickSize=function(Te){return arguments.length?(V=+Te,ye):V},ye.tickPadding=function(Te){return arguments.length?(ne=+Te,ye):ne},ye.tickSubdivide=function(){return arguments.length&&ye},ye};var Ol="bottom",Xl={top:1,right:1,bottom:1,left:1};function Bs(oe,E,R){oe.attr("transform",function(F){var V=E(F);return"translate("+(isFinite(V)?V:R(F))+",0)"})}function Dl(oe,E,R){oe.attr("transform",function(F){var V=E(F);return"translate(0,"+(isFinite(V)?V:R(F))+")"})}t.svg.brush=function(){var oe,E,R=$(Ne,"brushstart","brush","brushend"),F=null,V=null,ne=[0,0],le=[0,0],pe=!0,ye=!0,Te=lo[0];function Ne(Tt){Tt.each(function(){var At=t.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",Ct).on("touchstart.brush",Ct),yt=At.selectAll(".background").data([0]);yt.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),At.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var Ft=At.selectAll(".resize").data(Te,D);Ft.exit().remove(),Ft.enter().append("g").attr("class",function(hr){return"resize "+hr}).style("cursor",function(hr){return tl[hr]}).append("rect").attr("x",function(hr){return/[ew]$/.test(hr)?-3:null}).attr("y",function(hr){return/^[ns]/.test(hr)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),Ft.style("display",Ne.empty()?"none":null);var zt,jt=t.transition(At),rr=t.transition(yt);F&&(zt=ln(F),rr.attr("x",zt[0]).attr("width",zt[1]-zt[0]),nt(jt)),V&&(zt=ln(V),rr.attr("y",zt[0]).attr("height",zt[1]-zt[0]),bt(jt)),Ge(jt)})}function Ge(Tt){Tt.selectAll(".resize").attr("transform",function(At){return"translate("+ne[+/e$/.test(At)]+","+le[+/^s/.test(At)]+")"})}function nt(Tt){Tt.select(".extent").attr("x",ne[0]),Tt.selectAll(".extent,.n>rect,.s>rect").attr("width",ne[1]-ne[0])}function bt(Tt){Tt.select(".extent").attr("y",le[0]),Tt.selectAll(".extent,.e>rect,.w>rect").attr("height",le[1]-le[0])}function Ct(){var Tt,At,yt=this,Ft=t.select(t.event.target),zt=R.of(yt,arguments),jt=t.select(yt),rr=Ft.datum(),hr=!/^(n|s)$/.test(rr)&&F,Ar=!/^(e|w)$/.test(rr)&&V,kr=Ft.classed("extent"),Kr=Pt(yt),Zr=t.mouse(yt),hn=t.select(f(yt)).on("keydown.brush",Wn).on("keyup.brush",ua);if(t.event.changedTouches?hn.on("touchmove.brush",Ur).on("touchend.brush",Xn):hn.on("mousemove.brush",Ur).on("mouseup.brush",Xn),jt.interrupt().selectAll("*").interrupt(),kr)Zr[0]=ne[0]-Zr[0],Zr[1]=le[0]-Zr[1];else if(rr){var sn=+/w$/.test(rr),Un=+/^n/.test(rr);At=[ne[1-sn]-Zr[0],le[1-Un]-Zr[1]],Zr[0]=ne[sn],Zr[1]=le[Un]}else t.event.altKey&&(Tt=Zr.slice());function Wn(){t.event.keyCode==32&&(kr||(Tt=null,Zr[0]-=ne[1],Zr[1]-=le[1],kr=2),H())}function ua(){t.event.keyCode==32&&kr==2&&(Zr[0]+=ne[1],Zr[1]+=le[1],kr=0,H())}function Ur(){var Gn=t.mouse(yt),ea=!1;At&&(Gn[0]+=At[0],Gn[1]+=At[1]),kr||(t.event.altKey?(Tt||(Tt=[(ne[0]+ne[1])/2,(le[0]+le[1])/2]),Zr[0]=ne[+(Gn[0]<Tt[0])],Zr[1]=le[+(Gn[1]<Tt[1])]):Tt=null),hr&&kn(Gn,F,0)&&(nt(jt),ea=!0),Ar&&kn(Gn,V,1)&&(bt(jt),ea=!0),ea&&(Ge(jt),zt({type:"brush",mode:kr?"move":"resize"}))}function kn(Gn,ea,fa){var Ma,Kn,xa=ln(ea),ma=xa[0],La=xa[1],ba=Zr[fa],Pa=fa?le:ne,Ua=Pa[1]-Pa[0];if(kr&&(ma-=ba,La-=Ua+ba),Ma=(fa?ye:pe)?Math.max(ma,Math.min(La,Gn[fa])):Gn[fa],kr?Kn=(Ma+=ba)+Ua:(Tt&&(ba=Math.max(ma,Math.min(La,2*Tt[fa]-Ma))),ba<Ma?(Kn=Ma,Ma=ba):Kn=ba),Pa[0]!=Ma||Pa[1]!=Kn)return fa?E=null:oe=null,Pa[0]=Ma,Pa[1]=Kn,!0}function Xn(){Ur(),jt.style("pointer-events","all").selectAll(".resize").style("display",Ne.empty()?"none":null),t.select("body").style("cursor",null),hn.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),Kr(),zt({type:"brushend"})}jt.style("pointer-events","none").selectAll(".resize").style("display",null),t.select("body").style("cursor",Ft.style("cursor")),zt({type:"brushstart"}),Ur()}return Ne.event=function(Tt){Tt.each(function(){var At=R.of(this,arguments),yt={x:ne,y:le,i:oe,j:E},Ft=this.__chart__||yt;this.__chart__=yt,Rs?t.select(this).transition().each("start.brush",function(){oe=Ft.i,E=Ft.j,ne=Ft.x,le=Ft.y,At({type:"brushstart"})}).tween("brush:brush",function(){var zt=vi(ne,yt.x),jt=vi(le,yt.y);return oe=E=null,function(rr){ne=yt.x=zt(rr),le=yt.y=jt(rr),At({type:"brush",mode:"resize"})}}).each("end.brush",function(){oe=yt.i,E=yt.j,At({type:"brush",mode:"resize"}),At({type:"brushend"})}):(At({type:"brushstart"}),At({type:"brush",mode:"resize"}),At({type:"brushend"}))})},Ne.x=function(Tt){return arguments.length?(Te=lo[!(F=Tt)<<1|!V],Ne):F},Ne.y=function(Tt){return arguments.length?(Te=lo[!F<<1|!(V=Tt)],Ne):V},Ne.clamp=function(Tt){return arguments.length?(F&&V?(pe=!!Tt[0],ye=!!Tt[1]):F?pe=!!Tt:V&&(ye=!!Tt),Ne):F&&V?[pe,ye]:F?pe:V?ye:null},Ne.extent=function(Tt){var At,yt,Ft,zt,jt;return arguments.length?(F&&(At=Tt[0],yt=Tt[1],V&&(At=At[0],yt=yt[0]),oe=[At,yt],F.invert&&(At=F(At),yt=F(yt)),yt<At&&(jt=At,At=yt,yt=jt),At==ne[0]&&yt==ne[1]||(ne=[At,yt])),V&&(Ft=Tt[0],zt=Tt[1],F&&(Ft=Ft[1],zt=zt[1]),E=[Ft,zt],V.invert&&(Ft=V(Ft),zt=V(zt)),zt<Ft&&(jt=Ft,Ft=zt,zt=jt),Ft==le[0]&&zt==le[1]||(le=[Ft,zt])),Ne):(F&&(oe?(At=oe[0],yt=oe[1]):(At=ne[0],yt=ne[1],F.invert&&(At=F.invert(At),yt=F.invert(yt)),yt<At&&(jt=At,At=yt,yt=jt))),V&&(E?(Ft=E[0],zt=E[1]):(Ft=le[0],zt=le[1],V.invert&&(Ft=V.invert(Ft),zt=V.invert(zt)),zt<Ft&&(jt=Ft,Ft=zt,zt=jt))),F&&V?[[At,Ft],[yt,zt]]:F?[At,yt]:V&&[Ft,zt])},Ne.clear=function(){return Ne.empty()||(ne=[0,0],le=[0,0],oe=E=null),Ne},Ne.empty=function(){return!!F&&ne[0]==ne[1]||!!V&&le[0]==le[1]},t.rebind(Ne,R,"on")};var tl={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},lo=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];function Zl(oe){return JSON.parse(oe.responseText)}function Kl(oe){var E=p.createRange();return E.selectNode(p.body),E.createContextualFragment(oe.responseText)}t.text=jr(function(oe){return oe.responseText}),t.json=function(oe,E){return $r(oe,"application/json",Zl,E)},t.html=function(oe,E){return $r(oe,"text/html",Kl,E)},t.xml=jr(function(oe){return oe.responseXML}),typeof O=="object"&&O.exports?O.exports=t:this.d3=t}).apply(self)},{}],59:[function(r,O,B){O.exports=r("./quad")},{"./quad":60}],60:[function(r,O,B){var t=r("binary-search-bounds"),d=r("clamp"),m=r("parse-rect"),p=r("array-bounds"),e=r("pick-by-alias"),f=r("defined"),u=r("flatten-vertex-data"),s=r("is-obj"),l=r("dtype"),o=r("math-log2");function i(c,n){for(var a=n[0],g=n[1],h=1/(n[2]-a),y=1/(n[3]-g),v=new Array(c.length),_=0,x=c.length/2;_<x;_++)v[2*_]=d((c[2*_]-a)*h,0,1),v[2*_+1]=d((c[2*_+1]-g)*y,0,1);return v}O.exports=function(c,n){n||(n={}),c=u(c,"float64"),n=e(n,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var a=f(n.maxDepth,255),g=f(n.bounds,p(c,2));g[0]===g[2]&&g[2]++,g[1]===g[3]&&g[3]++;var h,y=i(c,g),v=c.length>>>1;n.dtype||(n.dtype="array"),typeof n.dtype=="string"?h=new(l(n.dtype))(v):n.dtype&&(h=n.dtype,Array.isArray(h)&&(h.length=v));for(var _=0;_<v;++_)h[_]=_;var x=[],T=[],A=[],S=[];(function U(q,X,K,Z,H,Y){if(!Z.length)return null;var $=x[H]||(x[H]=[]),z=A[H]||(A[H]=[]),j=T[H]||(T[H]=[]),W=$.length;if(++H>a||Y>1073741824){for(var ee=0;ee<Z.length;ee++)$.push(Z[ee]),z.push(Y),j.push(null,null,null,null);return W}if($.push(Z[0]),z.push(Y),Z.length<=1)return j.push(null,null,null,null),W;for(var J=.5*K,Q=q+J,te=X+J,ie=[],ae=[],he=[],se=[],de=1,ue=Z.length;de<ue;de++){var ve=Z[de],ke=y[2*ve],Ee=y[2*ve+1];ke<Q?Ee<te?ie.push(ve):ae.push(ve):Ee<te?he.push(ve):se.push(ve)}return Y<<=2,j.push(U(q,X,J,ie,H,Y),U(q,te,J,ae,H,Y+1),U(Q,X,J,he,H,Y+2),U(Q,te,J,se,H,Y+3)),W})(0,0,1,h,0,1);for(var w=0,C=0;C<x.length;C++){var k=x[C];if(h.set)h.set(k,w);else for(var L=0,M=k.length;L<M;L++)h[L+w]=k[L];var P=w+x[C].length;S[C]=[w,P],w=P}return h.range=function(){for(var U,q=[],X=arguments.length;X--;)q[X]=arguments[X];if(s(q[q.length-1])){var K=q.pop();q.length||K.x==null&&K.l==null&&K.left==null||(q=[K],U={}),U=e(K,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else U={};q.length||(q=g);var Z=m.apply(void 0,q),H=[Math.min(Z.x,Z.x+Z.width),Math.min(Z.y,Z.y+Z.height),Math.max(Z.x,Z.x+Z.width),Math.max(Z.y,Z.y+Z.height)],Y=H[0],$=H[1],z=H[2],j=H[3],W=i([Y,$,z,j],g),ee=W[0],J=W[1],Q=W[2],te=W[3],ie=f(U.level,x.length);if(U.d!=null){var ae;typeof U.d=="number"?ae=[U.d,U.d]:U.d.length&&(ae=U.d),ie=Math.min(Math.max(Math.ceil(-o(Math.abs(ae[0])/(g[2]-g[0]))),Math.ceil(-o(Math.abs(ae[1])/(g[3]-g[1])))),ie)}if(ie=Math.min(ie,x.length),U.lod)return D(ee,J,Q,te,ie);var he=[];function se(ue,ve,ke,Ee,be,xe){if(be!==null&&xe!==null&&!(ee>ue+ke||J>ve+ke||Q<ue||te<ve||Ee>=ie||be===xe)){var ce=x[Ee];xe===void 0&&(xe=ce.length);for(var ge=be;ge<xe;ge++){var we=ce[ge],Me=c[2*we],Se=c[2*we+1];Me>=Y&&Me<=z&&Se>=$&&Se<=j&&he.push(we)}var ze=T[Ee],Fe=ze[4*be+0],Ye=ze[4*be+1],rt=ze[4*be+2],Oe=ze[4*be+3],je=de(ze,be+1),We=.5*ke,qe=Ee+1;se(ue,ve,We,qe,Fe,Ye||rt||Oe||je),se(ue,ve+We,We,qe,Ye,rt||Oe||je),se(ue+We,ve,We,qe,rt,Oe||je),se(ue+We,ve+We,We,qe,Oe,je)}}function de(ue,ve){for(var ke=null,Ee=0;ke===null;)if(ke=ue[4*ve+Ee],++Ee>ue.length)return null;return ke}return se(0,0,1,0,0,1),he},h;function D(U,q,X,K,Z){for(var H=[],Y=0;Y<Z;Y++){var $=A[Y],z=S[Y][0],j=N(U,q,Y),W=N(X,K,Y),ee=t.ge($,j),J=t.gt($,W,ee,$.length-1);H[Y]=[ee+z,J+z]}return H}function N(U,q,X){for(var K=1,Z=.5,H=.5,Y=.5,$=0;$<X;$++)K<<=2,K+=U<Z?q<H?0:1:q<H?2:3,Y*=.5,Z+=U<Z?-Y:Y,H+=q<H?-Y:Y;return K}}},{"array-bounds":76,"binary-search-bounds":103,clamp:126,defined:176,dtype:181,"flatten-vertex-data":248,"is-obj":446,"math-log2":456,"parse-rect":481,"pick-by-alias":485}],61:[function(r,O,B){Object.defineProperty(B,"__esModule",{value:!0});var t=r("@turf/meta");function d(e){var f=0;if(e&&e.length>0){f+=Math.abs(m(e[0]));for(var u=1;u<e.length;u++)f-=Math.abs(m(e[u]))}return f}function m(e){var f,u,s,l,o,i,c=0,n=e.length;if(n>2){for(i=0;i<n;i++)i===n-2?(s=n-2,l=n-1,o=0):i===n-1?(s=n-1,l=0,o=1):(s=i,l=i+1,o=i+2),f=e[s],u=e[l],c+=(p(e[o][0])-p(f[0]))*Math.sin(p(u[1]));c=6378137*c*6378137/2}return c}function p(e){return e*Math.PI/180}B.default=function(e){return t.geomReduce(e,function(f,u){return f+function(s){var l,o=0;switch(s.type){case"Polygon":return d(s.coordinates);case"MultiPolygon":for(l=0;l<s.coordinates.length;l++)o+=d(s.coordinates[l]);return o;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(u)},0)}},{"@turf/meta":63}],62:[function(r,O,B){function t(n,a,g){g===void 0&&(g={});var h={type:"Feature"};return(g.id===0||g.id)&&(h.id=g.id),g.bbox&&(h.bbox=g.bbox),h.properties=a||{},h.geometry=n,h}function d(n,a,g){if(g===void 0&&(g={}),!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!c(n[0])||!c(n[1]))throw new Error("coordinates must contain numbers");return t({type:"Point",coordinates:n},a,g)}function m(n,a,g){g===void 0&&(g={});for(var h=0,y=n;h<y.length;h++){var v=y[h];if(v.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var _=0;_<v[v.length-1].length;_++)if(v[v.length-1][_]!==v[0][_])throw new Error("First and last Position are not equivalent.")}return t({type:"Polygon",coordinates:n},a,g)}function p(n,a,g){if(g===void 0&&(g={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");return t({type:"LineString",coordinates:n},a,g)}function e(n,a){a===void 0&&(a={});var g={type:"FeatureCollection"};return a.id&&(g.id=a.id),a.bbox&&(g.bbox=a.bbox),g.features=n,g}function f(n,a,g){return g===void 0&&(g={}),t({type:"MultiLineString",coordinates:n},a,g)}function u(n,a,g){return g===void 0&&(g={}),t({type:"MultiPoint",coordinates:n},a,g)}function s(n,a,g){return g===void 0&&(g={}),t({type:"MultiPolygon",coordinates:n},a,g)}function l(n,a){a===void 0&&(a="kilometers");var g=B.factors[a];if(!g)throw new Error(a+" units is invalid");return n*g}function o(n,a){a===void 0&&(a="kilometers");var g=B.factors[a];if(!g)throw new Error(a+" units is invalid");return n/g}function i(n){return 180*(n%(2*Math.PI))/Math.PI}function c(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}Object.defineProperty(B,"__esModule",{value:!0}),B.earthRadius=63710088e-1,B.factors={centimeters:100*B.earthRadius,centimetres:100*B.earthRadius,degrees:B.earthRadius/111325,feet:3.28084*B.earthRadius,inches:39.37*B.earthRadius,kilometers:B.earthRadius/1e3,kilometres:B.earthRadius/1e3,meters:B.earthRadius,metres:B.earthRadius,miles:B.earthRadius/1609.344,millimeters:1e3*B.earthRadius,millimetres:1e3*B.earthRadius,nauticalmiles:B.earthRadius/1852,radians:1,yards:1.0936*B.earthRadius},B.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/B.earthRadius,yards:1.0936133},B.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},B.feature=t,B.geometry=function(n,a,g){switch(n){case"Point":return d(a).geometry;case"LineString":return p(a).geometry;case"Polygon":return m(a).geometry;case"MultiPoint":return u(a).geometry;case"MultiLineString":return f(a).geometry;case"MultiPolygon":return s(a).geometry;default:throw new Error(n+" is invalid")}},B.point=d,B.points=function(n,a,g){return g===void 0&&(g={}),e(n.map(function(h){return d(h,a)}),g)},B.polygon=m,B.polygons=function(n,a,g){return g===void 0&&(g={}),e(n.map(function(h){return m(h,a)}),g)},B.lineString=p,B.lineStrings=function(n,a,g){return g===void 0&&(g={}),e(n.map(function(h){return p(h,a)}),g)},B.featureCollection=e,B.multiLineString=f,B.multiPoint=u,B.multiPolygon=s,B.geometryCollection=function(n,a,g){return g===void 0&&(g={}),t({type:"GeometryCollection",geometries:n},a,g)},B.round=function(n,a){if(a===void 0&&(a=0),a&&!(a>=0))throw new Error("precision must be a positive number");var g=Math.pow(10,a||0);return Math.round(n*g)/g},B.radiansToLength=l,B.lengthToRadians=o,B.lengthToDegrees=function(n,a){return i(o(n,a))},B.bearingToAzimuth=function(n){var a=n%360;return a<0&&(a+=360),a},B.radiansToDegrees=i,B.degreesToRadians=function(n){return n%360*Math.PI/180},B.convertLength=function(n,a,g){if(a===void 0&&(a="kilometers"),g===void 0&&(g="kilometers"),!(n>=0))throw new Error("length must be a positive number");return l(o(n,a),g)},B.convertArea=function(n,a,g){if(a===void 0&&(a="meters"),g===void 0&&(g="kilometers"),!(n>=0))throw new Error("area must be a positive number");var h=B.areaFactors[a];if(!h)throw new Error("invalid original units");var y=B.areaFactors[g];if(!y)throw new Error("invalid final units");return n/h*y},B.isNumber=c,B.isObject=function(n){return!!n&&n.constructor===Object},B.validateBBox=function(n){if(!n)throw new Error("bbox is required");if(!Array.isArray(n))throw new Error("bbox must be an Array");if(n.length!==4&&n.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");n.forEach(function(a){if(!c(a))throw new Error("bbox must only contain numbers")})},B.validateId=function(n){if(!n)throw new Error("id is required");if(["string","number"].indexOf(typeof n)===-1)throw new Error("id must be a number or a string")}},{}],63:[function(r,O,B){Object.defineProperty(B,"__esModule",{value:!0});var t=r("@turf/helpers");function d(l,o,i){if(l!==null)for(var c,n,a,g,h,y,v,_,x=0,T=0,A=l.type,S=A==="FeatureCollection",w=A==="Feature",C=S?l.features.length:1,k=0;k<C;k++){h=(_=!!(v=S?l.features[k].geometry:w?l.geometry:l)&&v.type==="GeometryCollection")?v.geometries.length:1;for(var L=0;L<h;L++){var M=0,P=0;if((g=_?v.geometries[L]:v)!==null){y=g.coordinates;var D=g.type;switch(x=!i||D!=="Polygon"&&D!=="MultiPolygon"?0:1,D){case null:break;case"Point":if(o(y,T,k,M,P)===!1)return!1;T++,M++;break;case"LineString":case"MultiPoint":for(c=0;c<y.length;c++){if(o(y[c],T,k,M,P)===!1)return!1;T++,D==="MultiPoint"&&M++}D==="LineString"&&M++;break;case"Polygon":case"MultiLineString":for(c=0;c<y.length;c++){for(n=0;n<y[c].length-x;n++){if(o(y[c][n],T,k,M,P)===!1)return!1;T++}D==="MultiLineString"&&M++,D==="Polygon"&&P++}D==="Polygon"&&M++;break;case"MultiPolygon":for(c=0;c<y.length;c++){for(P=0,n=0;n<y[c].length;n++){for(a=0;a<y[c][n].length-x;a++){if(o(y[c][n][a],T,k,M,P)===!1)return!1;T++}P++}M++}break;case"GeometryCollection":for(c=0;c<g.geometries.length;c++)if(d(g.geometries[c],o,i)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function m(l,o){var i;switch(l.type){case"FeatureCollection":for(i=0;i<l.features.length&&o(l.features[i].properties,i)!==!1;i++);break;case"Feature":o(l.properties,0)}}function p(l,o){if(l.type==="Feature")o(l,0);else if(l.type==="FeatureCollection")for(var i=0;i<l.features.length&&o(l.features[i],i)!==!1;i++);}function e(l,o){var i,c,n,a,g,h,y,v,_,x,T=0,A=l.type==="FeatureCollection",S=l.type==="Feature",w=A?l.features.length:1;for(i=0;i<w;i++){for(h=A?l.features[i].geometry:S?l.geometry:l,v=A?l.features[i].properties:S?l.properties:{},_=A?l.features[i].bbox:S?l.bbox:void 0,x=A?l.features[i].id:S?l.id:void 0,g=(y=!!h&&h.type==="GeometryCollection")?h.geometries.length:1,n=0;n<g;n++)if((a=y?h.geometries[n]:h)!==null)switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(o(a,T,v,_,x)===!1)return!1;break;case"GeometryCollection":for(c=0;c<a.geometries.length;c++)if(o(a.geometries[c],T,v,_,x)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(o(null,T,v,_,x)===!1)return!1;T++}}function f(l,o){e(l,function(i,c,n,a,g){var h,y=i===null?null:i.type;switch(y){case null:case"Point":case"LineString":case"Polygon":return o(t.feature(i,n,{bbox:a,id:g}),c,0)!==!1&&void 0}switch(y){case"MultiPoint":h="Point";break;case"MultiLineString":h="LineString";break;case"MultiPolygon":h="Polygon"}for(var v=0;v<i.coordinates.length;v++){var _={type:h,coordinates:i.coordinates[v]};if(o(t.feature(_,n),c,v)===!1)return!1}})}function u(l,o){f(l,function(i,c,n){var a=0;if(i.geometry){var g=i.geometry.type;if(g!=="Point"&&g!=="MultiPoint"){var h,y=0,v=0,_=0;return d(i,function(x,T,A,S,w){if(h===void 0||c>y||S>v||w>_)return h=x,y=c,v=S,_=w,void(a=0);var C=t.lineString([h,x],i.properties);if(o(C,c,n,w,a)===!1)return!1;a++,h=x})!==!1&&void 0}}})}function s(l,o){if(!l)throw new Error("geojson is required");f(l,function(i,c,n){if(i.geometry!==null){var a=i.geometry.type,g=i.geometry.coordinates;switch(a){case"LineString":if(o(i,c,n,0,0)===!1)return!1;break;case"Polygon":for(var h=0;h<g.length;h++)if(o(t.lineString(g[h],i.properties),c,n,h)===!1)return!1}}})}B.coordEach=d,B.coordReduce=function(l,o,i,c){var n=i;return d(l,function(a,g,h,y,v){n=g===0&&i===void 0?a:o(n,a,g,h,y,v)},c),n},B.propEach=m,B.propReduce=function(l,o,i){var c=i;return m(l,function(n,a){c=a===0&&i===void 0?n:o(c,n,a)}),c},B.featureEach=p,B.featureReduce=function(l,o,i){var c=i;return p(l,function(n,a){c=a===0&&i===void 0?n:o(c,n,a)}),c},B.coordAll=function(l){var o=[];return d(l,function(i){o.push(i)}),o},B.geomEach=e,B.geomReduce=function(l,o,i){var c=i;return e(l,function(n,a,g,h,y){c=a===0&&i===void 0?n:o(c,n,a,g,h,y)}),c},B.flattenEach=f,B.flattenReduce=function(l,o,i){var c=i;return f(l,function(n,a,g){c=a===0&&g===0&&i===void 0?n:o(c,n,a,g)}),c},B.segmentEach=u,B.segmentReduce=function(l,o,i){var c=i,n=!1;return u(l,function(a,g,h,y,v){c=n===!1&&i===void 0?a:o(c,a,g,h,y,v),n=!0}),c},B.lineEach=s,B.lineReduce=function(l,o,i){var c=i;return s(l,function(n,a,g,h){c=a===0&&i===void 0?n:o(c,n,a,g,h)}),c},B.findSegment=function(l,o){if(o=o||{},!t.isObject(o))throw new Error("options is invalid");var i,c=o.featureIndex||0,n=o.multiFeatureIndex||0,a=o.geometryIndex||0,g=o.segmentIndex||0,h=o.properties;switch(l.type){case"FeatureCollection":c<0&&(c=l.features.length+c),h=h||l.features[c].properties,i=l.features[c].geometry;break;case"Feature":h=h||l.properties,i=l.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=l;break;default:throw new Error("geojson is invalid")}if(i===null)return null;var y=i.coordinates;switch(i.type){case"Point":case"MultiPoint":return null;case"LineString":return g<0&&(g=y.length+g-1),t.lineString([y[g],y[g+1]],h,o);case"Polygon":return a<0&&(a=y.length+a),g<0&&(g=y[a].length+g-1),t.lineString([y[a][g],y[a][g+1]],h,o);case"MultiLineString":return n<0&&(n=y.length+n),g<0&&(g=y[n].length+g-1),t.lineString([y[n][g],y[n][g+1]],h,o);case"MultiPolygon":return n<0&&(n=y.length+n),a<0&&(a=y[n].length+a),g<0&&(g=y[n][a].length-g-1),t.lineString([y[n][a][g],y[n][a][g+1]],h,o)}throw new Error("geojson is invalid")},B.findPoint=function(l,o){if(o=o||{},!t.isObject(o))throw new Error("options is invalid");var i,c=o.featureIndex||0,n=o.multiFeatureIndex||0,a=o.geometryIndex||0,g=o.coordIndex||0,h=o.properties;switch(l.type){case"FeatureCollection":c<0&&(c=l.features.length+c),h=h||l.features[c].properties,i=l.features[c].geometry;break;case"Feature":h=h||l.properties,i=l.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=l;break;default:throw new Error("geojson is invalid")}if(i===null)return null;var y=i.coordinates;switch(i.type){case"Point":return t.point(y,h,o);case"MultiPoint":return n<0&&(n=y.length+n),t.point(y[n],h,o);case"LineString":return g<0&&(g=y.length+g),t.point(y[g],h,o);case"Polygon":return a<0&&(a=y.length+a),g<0&&(g=y[a].length+g),t.point(y[a][g],h,o);case"MultiLineString":return n<0&&(n=y.length+n),g<0&&(g=y[n].length+g),t.point(y[n][g],h,o);case"MultiPolygon":return n<0&&(n=y.length+n),a<0&&(a=y[n].length+a),g<0&&(g=y[n][a].length-g),t.point(y[n][a][g],h,o)}throw new Error("geojson is invalid")}},{"@turf/helpers":62}],64:[function(r,O,B){Object.defineProperty(B,"__esModule",{value:!0});var t=r("@turf/meta");function d(m){var p=[1/0,1/0,-1/0,-1/0];return t.coordEach(m,function(e){p[0]>e[0]&&(p[0]=e[0]),p[1]>e[1]&&(p[1]=e[1]),p[2]<e[0]&&(p[2]=e[0]),p[3]<e[1]&&(p[3]=e[1])}),p}d.default=d,B.default=d},{"@turf/meta":66}],65:[function(r,O,B){arguments[4][62][0].apply(B,arguments)},{dup:62}],66:[function(r,O,B){arguments[4][63][0].apply(B,arguments)},{"@turf/helpers":65,dup:63}],67:[function(r,O,B){Object.defineProperty(B,"__esModule",{value:!0});var t=r("@turf/meta"),d=r("@turf/helpers");B.default=function(m,p){p===void 0&&(p={});var e=0,f=0,u=0;return t.coordEach(m,function(s){e+=s[0],f+=s[1],u++}),d.point([e/u,f/u],p.properties)}},{"@turf/helpers":68,"@turf/meta":69}],68:[function(r,O,B){function t(n,a,g){g===void 0&&(g={});var h={type:"Feature"};return(g.id===0||g.id)&&(h.id=g.id),g.bbox&&(h.bbox=g.bbox),h.properties=a||{},h.geometry=n,h}function d(n,a,g){return g===void 0&&(g={}),t({type:"Point",coordinates:n},a,g)}function m(n,a,g){g===void 0&&(g={});for(var h=0,y=n;h<y.length;h++){var v=y[h];if(v.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var _=0;_<v[v.length-1].length;_++)if(v[v.length-1][_]!==v[0][_])throw new Error("First and last Position are not equivalent.")}return t({type:"Polygon",coordinates:n},a,g)}function p(n,a,g){if(g===void 0&&(g={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");return t({type:"LineString",coordinates:n},a,g)}function e(n,a){a===void 0&&(a={});var g={type:"FeatureCollection"};return a.id&&(g.id=a.id),a.bbox&&(g.bbox=a.bbox),g.features=n,g}function f(n,a,g){return g===void 0&&(g={}),t({type:"MultiLineString",coordinates:n},a,g)}function u(n,a,g){return g===void 0&&(g={}),t({type:"MultiPoint",coordinates:n},a,g)}function s(n,a,g){return g===void 0&&(g={}),t({type:"MultiPolygon",coordinates:n},a,g)}function l(n,a){a===void 0&&(a="kilometers");var g=B.factors[a];if(!g)throw new Error(a+" units is invalid");return n*g}function o(n,a){a===void 0&&(a="kilometers");var g=B.factors[a];if(!g)throw new Error(a+" units is invalid");return n/g}function i(n){return 180*(n%(2*Math.PI))/Math.PI}function c(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)&&!/^\s*$/.test(n)}Object.defineProperty(B,"__esModule",{value:!0}),B.earthRadius=63710088e-1,B.factors={centimeters:100*B.earthRadius,centimetres:100*B.earthRadius,degrees:B.earthRadius/111325,feet:3.28084*B.earthRadius,inches:39.37*B.earthRadius,kilometers:B.earthRadius/1e3,kilometres:B.earthRadius/1e3,meters:B.earthRadius,metres:B.earthRadius,miles:B.earthRadius/1609.344,millimeters:1e3*B.earthRadius,millimetres:1e3*B.earthRadius,nauticalmiles:B.earthRadius/1852,radians:1,yards:B.earthRadius/1.0936},B.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/B.earthRadius,yards:1/1.0936},B.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},B.feature=t,B.geometry=function(n,a,g){switch(n){case"Point":return d(a).geometry;case"LineString":return p(a).geometry;case"Polygon":return m(a).geometry;case"MultiPoint":return u(a).geometry;case"MultiLineString":return f(a).geometry;case"MultiPolygon":return s(a).geometry;default:throw new Error(n+" is invalid")}},B.point=d,B.points=function(n,a,g){return g===void 0&&(g={}),e(n.map(function(h){return d(h,a)}),g)},B.polygon=m,B.polygons=function(n,a,g){return g===void 0&&(g={}),e(n.map(function(h){return m(h,a)}),g)},B.lineString=p,B.lineStrings=function(n,a,g){return g===void 0&&(g={}),e(n.map(function(h){return p(h,a)}),g)},B.featureCollection=e,B.multiLineString=f,B.multiPoint=u,B.multiPolygon=s,B.geometryCollection=function(n,a,g){return g===void 0&&(g={}),t({type:"GeometryCollection",geometries:n},a,g)},B.round=function(n,a){if(a===void 0&&(a=0),a&&!(a>=0))throw new Error("precision must be a positive number");var g=Math.pow(10,a||0);return Math.round(n*g)/g},B.radiansToLength=l,B.lengthToRadians=o,B.lengthToDegrees=function(n,a){return i(o(n,a))},B.bearingToAzimuth=function(n){var a=n%360;return a<0&&(a+=360),a},B.radiansToDegrees=i,B.degreesToRadians=function(n){return n%360*Math.PI/180},B.convertLength=function(n,a,g){if(a===void 0&&(a="kilometers"),g===void 0&&(g="kilometers"),!(n>=0))throw new Error("length must be a positive number");return l(o(n,a),g)},B.convertArea=function(n,a,g){if(a===void 0&&(a="meters"),g===void 0&&(g="kilometers"),!(n>=0))throw new Error("area must be a positive number");var h=B.areaFactors[a];if(!h)throw new Error("invalid original units");var y=B.areaFactors[g];if(!y)throw new Error("invalid final units");return n/h*y},B.isNumber=c,B.isObject=function(n){return!!n&&n.constructor===Object},B.validateBBox=function(n){if(!n)throw new Error("bbox is required");if(!Array.isArray(n))throw new Error("bbox must be an Array");if(n.length!==4&&n.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");n.forEach(function(a){if(!c(a))throw new Error("bbox must only contain numbers")})},B.validateId=function(n){if(!n)throw new Error("id is required");if(["string","number"].indexOf(typeof n)===-1)throw new Error("id must be a number or a string")},B.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},B.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},B.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},B.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},B.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},B.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},B.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],69:[function(r,O,B){Object.defineProperty(B,"__esModule",{value:!0});var t=r("@turf/helpers");function d(l,o,i){if(l!==null)for(var c,n,a,g,h,y,v,_,x=0,T=0,A=l.type,S=A==="FeatureCollection",w=A==="Feature",C=S?l.features.length:1,k=0;k<C;k++){h=(_=!!(v=S?l.features[k].geometry:w?l.geometry:l)&&v.type==="GeometryCollection")?v.geometries.length:1;for(var L=0;L<h;L++){var M=0,P=0;if((g=_?v.geometries[L]:v)!==null){y=g.coordinates;var D=g.type;switch(x=!i||D!=="Polygon"&&D!=="MultiPolygon"?0:1,D){case null:break;case"Point":if(o(y,T,k,M,P)===!1)return!1;T++,M++;break;case"LineString":case"MultiPoint":for(c=0;c<y.length;c++){if(o(y[c],T,k,M,P)===!1)return!1;T++,D==="MultiPoint"&&M++}D==="LineString"&&M++;break;case"Polygon":case"MultiLineString":for(c=0;c<y.length;c++){for(n=0;n<y[c].length-x;n++){if(o(y[c][n],T,k,M,P)===!1)return!1;T++}D==="MultiLineString"&&M++,D==="Polygon"&&P++}D==="Polygon"&&M++;break;case"MultiPolygon":for(c=0;c<y.length;c++){for(P=0,n=0;n<y[c].length;n++){for(a=0;a<y[c][n].length-x;a++){if(o(y[c][n][a],T,k,M,P)===!1)return!1;T++}P++}M++}break;case"GeometryCollection":for(c=0;c<g.geometries.length;c++)if(d(g.geometries[c],o,i)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function m(l,o){var i;switch(l.type){case"FeatureCollection":for(i=0;i<l.features.length&&o(l.features[i].properties,i)!==!1;i++);break;case"Feature":o(l.properties,0)}}function p(l,o){if(l.type==="Feature")o(l,0);else if(l.type==="FeatureCollection")for(var i=0;i<l.features.length&&o(l.features[i],i)!==!1;i++);}function e(l,o){var i,c,n,a,g,h,y,v,_,x,T=0,A=l.type==="FeatureCollection",S=l.type==="Feature",w=A?l.features.length:1;for(i=0;i<w;i++){for(h=A?l.features[i].geometry:S?l.geometry:l,v=A?l.features[i].properties:S?l.properties:{},_=A?l.features[i].bbox:S?l.bbox:void 0,x=A?l.features[i].id:S?l.id:void 0,g=(y=!!h&&h.type==="GeometryCollection")?h.geometries.length:1,n=0;n<g;n++)if((a=y?h.geometries[n]:h)!==null)switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(o(a,T,v,_,x)===!1)return!1;break;case"GeometryCollection":for(c=0;c<a.geometries.length;c++)if(o(a.geometries[c],T,v,_,x)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(o(null,T,v,_,x)===!1)return!1;T++}}function f(l,o){e(l,function(i,c,n,a,g){var h,y=i===null?null:i.type;switch(y){case null:case"Point":case"LineString":case"Polygon":return o(t.feature(i,n,{bbox:a,id:g}),c,0)!==!1&&void 0}switch(y){case"MultiPoint":h="Point";break;case"MultiLineString":h="LineString";break;case"MultiPolygon":h="Polygon"}for(var v=0;v<i.coordinates.length;v++){var _={type:h,coordinates:i.coordinates[v]};if(o(t.feature(_,n),c,v)===!1)return!1}})}function u(l,o){f(l,function(i,c,n){var a=0;if(i.geometry){var g=i.geometry.type;if(g!=="Point"&&g!=="MultiPoint"){var h,y=0,v=0,_=0;return d(i,function(x,T,A,S,w){if(h===void 0||c>y||S>v||w>_)return h=x,y=c,v=S,_=w,void(a=0);var C=t.lineString([h,x],i.properties);if(o(C,c,n,w,a)===!1)return!1;a++,h=x})!==!1&&void 0}}})}function s(l,o){if(!l)throw new Error("geojson is required");f(l,function(i,c,n){if(i.geometry!==null){var a=i.geometry.type,g=i.geometry.coordinates;switch(a){case"LineString":if(o(i,c,n,0,0)===!1)return!1;break;case"Polygon":for(var h=0;h<g.length;h++)if(o(t.lineString(g[h],i.properties),c,n,h)===!1)return!1}}})}B.coordEach=d,B.coordReduce=function(l,o,i,c){var n=i;return d(l,function(a,g,h,y,v){n=g===0&&i===void 0?a:o(n,a,g,h,y,v)},c),n},B.propEach=m,B.propReduce=function(l,o,i){var c=i;return m(l,function(n,a){c=a===0&&i===void 0?n:o(c,n,a)}),c},B.featureEach=p,B.featureReduce=function(l,o,i){var c=i;return p(l,function(n,a){c=a===0&&i===void 0?n:o(c,n,a)}),c},B.coordAll=function(l){var o=[];return d(l,function(i){o.push(i)}),o},B.geomEach=e,B.geomReduce=function(l,o,i){var c=i;return e(l,function(n,a,g,h,y){c=a===0&&i===void 0?n:o(c,n,a,g,h,y)}),c},B.flattenEach=f,B.flattenReduce=function(l,o,i){var c=i;return f(l,function(n,a,g){c=a===0&&g===0&&i===void 0?n:o(c,n,a,g)}),c},B.segmentEach=u,B.segmentReduce=function(l,o,i){var c=i,n=!1;return u(l,function(a,g,h,y,v){c=n===!1&&i===void 0?a:o(c,a,g,h,y,v),n=!0}),c},B.lineEach=s,B.lineReduce=function(l,o,i){var c=i;return s(l,function(n,a,g,h){c=a===0&&i===void 0?n:o(c,n,a,g,h)}),c},B.findSegment=function(l,o){if(o=o||{},!t.isObject(o))throw new Error("options is invalid");var i,c=o.featureIndex||0,n=o.multiFeatureIndex||0,a=o.geometryIndex||0,g=o.segmentIndex||0,h=o.properties;switch(l.type){case"FeatureCollection":c<0&&(c=l.features.length+c),h=h||l.features[c].properties,i=l.features[c].geometry;break;case"Feature":h=h||l.properties,i=l.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=l;break;default:throw new Error("geojson is invalid")}if(i===null)return null;var y=i.coordinates;switch(i.type){case"Point":case"MultiPoint":return null;case"LineString":return g<0&&(g=y.length+g-1),t.lineString([y[g],y[g+1]],h,o);case"Polygon":return a<0&&(a=y.length+a),g<0&&(g=y[a].length+g-1),t.lineString([y[a][g],y[a][g+1]],h,o);case"MultiLineString":return n<0&&(n=y.length+n),g<0&&(g=y[n].length+g-1),t.lineString([y[n][g],y[n][g+1]],h,o);case"MultiPolygon":return n<0&&(n=y.length+n),a<0&&(a=y[n].length+a),g<0&&(g=y[n][a].length-g-1),t.lineString([y[n][a][g],y[n][a][g+1]],h,o)}throw new Error("geojson is invalid")},B.findPoint=function(l,o){if(o=o||{},!t.isObject(o))throw new Error("options is invalid");var i,c=o.featureIndex||0,n=o.multiFeatureIndex||0,a=o.geometryIndex||0,g=o.coordIndex||0,h=o.properties;switch(l.type){case"FeatureCollection":c<0&&(c=l.features.length+c),h=h||l.features[c].properties,i=l.features[c].geometry;break;case"Feature":h=h||l.properties,i=l.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=l;break;default:throw new Error("geojson is invalid")}if(i===null)return null;var y=i.coordinates;switch(i.type){case"Point":return t.point(y,h,o);case"MultiPoint":return n<0&&(n=y.length+n),t.point(y[n],h,o);case"LineString":return g<0&&(g=y.length+g),t.point(y[g],h,o);case"Polygon":return a<0&&(a=y.length+a),g<0&&(g=y[a].length+g),t.point(y[a][g],h,o);case"MultiLineString":return n<0&&(n=y.length+n),g<0&&(g=y[n].length+g),t.point(y[n][g],h,o);case"MultiPolygon":return n<0&&(n=y.length+n),a<0&&(a=y[n].length+a),g<0&&(g=y[n][a].length-g),t.point(y[n][a][g],h,o)}throw new Error("geojson is invalid")}},{"@turf/helpers":68}],70:[function(r,O,B){var t=typeof WeakMap=="undefined"?r("weak-map"):WeakMap,d=r("gl-buffer"),m=r("gl-vao"),p=new t;O.exports=function(e){var f=p.get(e),u=f&&(f._triangleBuffer.handle||f._triangleBuffer.buffer);if(!u||!e.isBuffer(u)){var s=d(e,new Float32Array([-1,-1,-1,4,4,-1]));(f=m(e,[{buffer:s,type:e.FLOAT,size:2}]))._triangleBuffer=s,p.set(e,f)}f.bind(),e.drawArrays(e.TRIANGLES,0,3),f.unbind()}},{"gl-buffer":261,"gl-vao":353,"weak-map":609}],71:[function(r,O,B){O.exports=function(t){var d=0,m=0,p=0,e=0;return t.map(function(f){var u=(f=f.slice())[0],s=u.toUpperCase();if(u!=s)switch(f[0]=s,u){case"a":f[6]+=p,f[7]+=e;break;case"v":f[1]+=e;break;case"h":f[1]+=p;break;default:for(var l=1;l<f.length;)f[l++]+=p,f[l++]+=e}switch(s){case"Z":p=d,e=m;break;case"H":p=f[1];break;case"V":e=f[1];break;case"M":p=d=f[1],e=m=f[2];break;default:p=f[f.length-2],e=f[f.length-1]}return f})}},{}],72:[function(r,O,B){var t=r("pad-left");O.exports=function(d,m,p){m=typeof m=="number"?m:1,p=p||": ";var e=d.split(/\r?\n/),f=String(e.length+m-1).length;return e.map(function(u,s){var l=s+m,o=String(l).length;return t(l,f-o)+p+u}).join(`
`)}},{"pad-left":479}],73:[function(r,O,B){O.exports=function(m){var p=m.length;if(p===0)return[];if(p===1)return[0];for(var e=m[0].length,f=[m[0]],u=[0],s=1;s<p;++s)if(f.push(m[s]),d(f,e)){if(u.push(s),u.length===e+1)return u}else f.pop();return u};var t=r("robust-orientation");function d(m,p){for(var e=new Array(p+1),f=0;f<m.length;++f)e[f]=m[f];for(f=0;f<=m.length;++f){for(var u=m.length;u<=p;++u){for(var s=new Array(p),l=0;l<p;++l)s[l]=Math.pow(u+1-f,l);e[u]=s}if(t.apply(void 0,e))return!0}return!1}},{"robust-orientation":534}],74:[function(r,O,B){O.exports=function(m,p){return t(p).filter(function(e){for(var f=new Array(e.length),u=0;u<e.length;++u)f[u]=p[e[u]];return d(f)*m<1})};var t=r("delaunay-triangulate"),d=r("circumradius")},{circumradius:125,"delaunay-triangulate":177}],75:[function(r,O,B){O.exports=function(m,p){return d(t(m,p))};var t=r("alpha-complex"),d=r("simplicial-complex-boundary")},{"alpha-complex":74,"simplicial-complex-boundary":542}],76:[function(r,O,B){O.exports=function(t,d){if(!t||t.length==null)throw Error("Argument should be an array");d=d==null?1:Math.floor(d);for(var m=Array(2*d),p=0;p<d;p++){for(var e=-1/0,f=1/0,u=p,s=t.length;u<s;u+=d)t[u]>e&&(e=t[u]),t[u]<f&&(f=t[u]);m[p]=f,m[d+p]=e}return m}},{}],77:[function(r,O,B){O.exports=function(t,d,m){if(typeof Array.prototype.findIndex=="function")return t.findIndex(d,m);if(typeof d!="function")throw new TypeError("predicate must be a function");var p=Object(t),e=p.length;if(e===0)return-1;for(var f=0;f<e;f++)if(d.call(m,p[f],f,p))return f;return-1}},{}],78:[function(r,O,B){var t=r("array-bounds");O.exports=function(d,m,p){if(!d||d.length==null)throw Error("Argument should be an array");m==null&&(m=1),p==null&&(p=t(d,m));for(var e=0;e<m;e++){var f=p[m+e],u=p[e],s=e,l=d.length;if(f===1/0&&u===-1/0)for(s=e;s<l;s+=m)d[s]=d[s]===f?1:d[s]===u?0:.5;else if(f===1/0)for(s=e;s<l;s+=m)d[s]=d[s]===f?1:0;else if(u===-1/0)for(s=e;s<l;s+=m)d[s]=d[s]===u?0:1;else{var o=f-u;for(s=e;s<l;s+=m)isNaN(d[s])||(d[s]=o===0?.5:(d[s]-u)/o)}}return d}},{"array-bounds":76}],79:[function(r,O,B){O.exports=function(t,d){var m=typeof t=="number",p=typeof d=="number";m&&!p?(d=t,t=0):m||p||(t=0,d=0);var e=(d|=0)-(t|=0);if(e<0)throw new Error("array length must be positive");for(var f=new Array(e),u=0,s=t;u<e;u++,s++)f[u]=s;return f}},{}],80:[function(r,O,B){(function(t){(function(){var d=r("object-assign");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function m(S,w){if(S===w)return 0;for(var C=S.length,k=w.length,L=0,M=Math.min(C,k);L<M;++L)if(S[L]!==w[L]){C=S[L],k=w[L];break}return C<k?-1:k<C?1:0}function p(S){return t.Buffer&&typeof t.Buffer.isBuffer=="function"?t.Buffer.isBuffer(S):!(S==null||!S._isBuffer)}var e=r("util/"),f=Object.prototype.hasOwnProperty,u=Array.prototype.slice,s=function(){}.name==="foo";function l(S){return Object.prototype.toString.call(S)}function o(S){return!p(S)&&typeof t.ArrayBuffer=="function"&&(typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(S):!!S&&(S instanceof DataView||!!(S.buffer&&S.buffer instanceof ArrayBuffer)))}var i=O.exports=y,c=/\s*function\s+([^\(\s]*)\s*/;function n(S){if(e.isFunction(S)){if(s)return S.name;var w=S.toString().match(c);return w&&w[1]}}function a(S,w){return typeof S=="string"?S.length<w?S:S.slice(0,w):S}function g(S){if(s||!e.isFunction(S))return e.inspect(S);var w=n(S);return"[Function"+(w?": "+w:"")+"]"}function h(S,w,C,k,L){throw new i.AssertionError({message:C,actual:S,expected:w,operator:k,stackStartFunction:L})}function y(S,w){S||h(S,!0,w,"==",i.ok)}function v(S,w,C,k){if(S===w)return!0;if(p(S)&&p(w))return m(S,w)===0;if(e.isDate(S)&&e.isDate(w))return S.getTime()===w.getTime();if(e.isRegExp(S)&&e.isRegExp(w))return S.source===w.source&&S.global===w.global&&S.multiline===w.multiline&&S.lastIndex===w.lastIndex&&S.ignoreCase===w.ignoreCase;if(S!==null&&typeof S=="object"||w!==null&&typeof w=="object"){if(o(S)&&o(w)&&l(S)===l(w)&&!(S instanceof Float32Array||S instanceof Float64Array))return m(new Uint8Array(S.buffer),new Uint8Array(w.buffer))===0;if(p(S)!==p(w))return!1;var L=(k=k||{actual:[],expected:[]}).actual.indexOf(S);return L!==-1&&L===k.expected.indexOf(w)||(k.actual.push(S),k.expected.push(w),function(M,P,D,N){if(M==null||P==null)return!1;if(e.isPrimitive(M)||e.isPrimitive(P))return M===P;if(D&&Object.getPrototypeOf(M)!==Object.getPrototypeOf(P))return!1;var U=_(M),q=_(P);if(U&&!q||!U&&q)return!1;if(U)return M=u.call(M),P=u.call(P),v(M,P,D);var X,K,Z=A(M),H=A(P);if(Z.length!==H.length)return!1;for(Z.sort(),H.sort(),K=Z.length-1;K>=0;K--)if(Z[K]!==H[K])return!1;for(K=Z.length-1;K>=0;K--)if(X=Z[K],!v(M[X],P[X],D,N))return!1;return!0}(S,w,C,k))}return C?S===w:S==w}function _(S){return Object.prototype.toString.call(S)=="[object Arguments]"}function x(S,w){if(!S||!w)return!1;if(Object.prototype.toString.call(w)=="[object RegExp]")return w.test(S);try{if(S instanceof w)return!0}catch(C){}return!Error.isPrototypeOf(w)&&w.call({},S)===!0}function T(S,w,C,k){var L;if(typeof w!="function")throw new TypeError('"block" argument must be a function');typeof C=="string"&&(k=C,C=null),L=function(D){var N;try{D()}catch(U){N=U}return N}(w),k=(C&&C.name?" ("+C.name+").":".")+(k?" "+k:"."),S&&!L&&h(L,C,"Missing expected exception"+k);var M=typeof k=="string",P=!S&&L&&!C;if((!S&&e.isError(L)&&M&&x(L,C)||P)&&h(L,C,"Got unwanted exception"+k),S&&L&&C&&!x(L,C)||!S&&L)throw L}i.AssertionError=function(S){this.name="AssertionError",this.actual=S.actual,this.expected=S.expected,this.operator=S.operator,S.message?(this.message=S.message,this.generatedMessage=!1):(this.message=function(D){return a(g(D.actual),128)+" "+D.operator+" "+a(g(D.expected),128)}(this),this.generatedMessage=!0);var w=S.stackStartFunction||h;if(Error.captureStackTrace)Error.captureStackTrace(this,w);else{var C=new Error;if(C.stack){var k=C.stack,L=n(w),M=k.indexOf(`
`+L);if(M>=0){var P=k.indexOf(`
`,M+1);k=k.substring(P+1)}this.stack=k}}},e.inherits(i.AssertionError,Error),i.fail=h,i.ok=y,i.equal=function(S,w,C){S!=w&&h(S,w,C,"==",i.equal)},i.notEqual=function(S,w,C){S==w&&h(S,w,C,"!=",i.notEqual)},i.deepEqual=function(S,w,C){v(S,w,!1)||h(S,w,C,"deepEqual",i.deepEqual)},i.deepStrictEqual=function(S,w,C){v(S,w,!0)||h(S,w,C,"deepStrictEqual",i.deepStrictEqual)},i.notDeepEqual=function(S,w,C){v(S,w,!1)&&h(S,w,C,"notDeepEqual",i.notDeepEqual)},i.notDeepStrictEqual=function S(w,C,k){v(w,C,!0)&&h(w,C,k,"notDeepStrictEqual",S)},i.strictEqual=function(S,w,C){S!==w&&h(S,w,C,"===",i.strictEqual)},i.notStrictEqual=function(S,w,C){S===w&&h(S,w,C,"!==",i.notStrictEqual)},i.throws=function(S,w,C){T(!0,S,w,C)},i.doesNotThrow=function(S,w,C){T(!1,S,w,C)},i.ifError=function(S){if(S)throw S},i.strict=d(function S(w,C){w||h(w,!0,C,"==",S)},i,{equal:i.strictEqual,deepEqual:i.deepStrictEqual,notEqual:i.notStrictEqual,notDeepEqual:i.notDeepStrictEqual}),i.strict.strict=i.strict;var A=Object.keys||function(S){var w=[];for(var C in S)f.call(S,C)&&w.push(C);return w}}).call(this)}).call(this,typeof Xi!="undefined"?Xi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"object-assign":476,"util/":83}],81:[function(r,O,B){typeof Object.create=="function"?O.exports=function(t,d){t.super_=d,t.prototype=Object.create(d.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:O.exports=function(t,d){t.super_=d;var m=function(){};m.prototype=d.prototype,t.prototype=new m,t.prototype.constructor=t}},{}],82:[function(r,O,B){O.exports=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}},{}],83:[function(r,O,B){(function(t,d){(function(){var m=/%[sdj%]/g;B.format=function(M){if(!h(M)){for(var P=[],D=0;D<arguments.length;D++)P.push(f(arguments[D]));return P.join(" ")}D=1;for(var N=arguments,U=N.length,q=String(M).replace(m,function(K){if(K==="%%")return"%";if(D>=U)return K;switch(K){case"%s":return String(N[D++]);case"%d":return Number(N[D++]);case"%j":try{return JSON.stringify(N[D++])}catch(Z){return"[Circular]"}default:return K}}),X=N[D];D<U;X=N[++D])a(X)||!_(X)?q+=" "+X:q+=" "+f(X);return q},B.deprecate=function(M,P){if(y(d.process))return function(){return B.deprecate(M,P).apply(this,arguments)};if(t.noDeprecation===!0)return M;var D=!1;return function(){if(!D){if(t.throwDeprecation)throw new Error(P);t.traceDeprecation?console.trace(P):console.error(P),D=!0}return M.apply(this,arguments)}};var p,e={};function f(M,P){var D={seen:[],stylize:s};return arguments.length>=3&&(D.depth=arguments[2]),arguments.length>=4&&(D.colors=arguments[3]),n(P)?D.showHidden=P:P&&B._extend(D,P),y(D.showHidden)&&(D.showHidden=!1),y(D.depth)&&(D.depth=2),y(D.colors)&&(D.colors=!1),y(D.customInspect)&&(D.customInspect=!0),D.colors&&(D.stylize=u),l(D,M,D.depth)}function u(M,P){var D=f.styles[P];return D?"["+f.colors[D][0]+"m"+M+"["+f.colors[D][1]+"m":M}function s(M,P){return M}function l(M,P,D){if(M.customInspect&&P&&A(P.inspect)&&P.inspect!==B.inspect&&(!P.constructor||P.constructor.prototype!==P)){var N=P.inspect(D,M);return h(N)||(N=l(M,N,D)),N}var U=function(z,j){if(y(j))return z.stylize("undefined","undefined");if(h(j)){var W="'"+JSON.stringify(j).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return z.stylize(W,"string")}if(g(j))return z.stylize(""+j,"number");if(n(j))return z.stylize(""+j,"boolean");if(a(j))return z.stylize("null","null")}(M,P);if(U)return U;var q=Object.keys(P),X=function(z){var j={};return z.forEach(function(W,ee){j[W]=!0}),j}(q);if(M.showHidden&&(q=Object.getOwnPropertyNames(P)),T(P)&&(q.indexOf("message")>=0||q.indexOf("description")>=0))return o(P);if(q.length===0){if(A(P)){var K=P.name?": "+P.name:"";return M.stylize("[Function"+K+"]","special")}if(v(P))return M.stylize(RegExp.prototype.toString.call(P),"regexp");if(x(P))return M.stylize(Date.prototype.toString.call(P),"date");if(T(P))return o(P)}var Z,H="",Y=!1,$=["{","}"];return c(P)&&(Y=!0,$=["[","]"]),A(P)&&(H=" [Function"+(P.name?": "+P.name:"")+"]"),v(P)&&(H=" "+RegExp.prototype.toString.call(P)),x(P)&&(H=" "+Date.prototype.toUTCString.call(P)),T(P)&&(H=" "+o(P)),q.length!==0||Y&&P.length!=0?D<0?v(P)?M.stylize(RegExp.prototype.toString.call(P),"regexp"):M.stylize("[Object]","special"):(M.seen.push(P),Z=Y?function(z,j,W,ee,J){for(var Q=[],te=0,ie=j.length;te<ie;++te)L(j,String(te))?Q.push(i(z,j,W,ee,String(te),!0)):Q.push("");return J.forEach(function(ae){ae.match(/^\d+$/)||Q.push(i(z,j,W,ee,ae,!0))}),Q}(M,P,D,X,q):q.map(function(z){return i(M,P,D,X,z,Y)}),M.seen.pop(),function(z,j,W){return z.reduce(function(ee,J){return J.indexOf(`
`)>=0,ee+J.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?W[0]+(j===""?"":j+`
 `)+" "+z.join(`,
  `)+" "+W[1]:W[0]+j+" "+z.join(", ")+" "+W[1]}(Z,H,$)):$[0]+H+$[1]}function o(M){return"["+Error.prototype.toString.call(M)+"]"}function i(M,P,D,N,U,q){var X,K,Z;if((Z=Object.getOwnPropertyDescriptor(P,U)||{value:P[U]}).get?K=Z.set?M.stylize("[Getter/Setter]","special"):M.stylize("[Getter]","special"):Z.set&&(K=M.stylize("[Setter]","special")),L(N,U)||(X="["+U+"]"),K||(M.seen.indexOf(Z.value)<0?(K=a(D)?l(M,Z.value,null):l(M,Z.value,D-1)).indexOf(`
`)>-1&&(K=q?K.split(`
`).map(function(H){return"  "+H}).join(`
`).substr(2):`
`+K.split(`
`).map(function(H){return"   "+H}).join(`
`)):K=M.stylize("[Circular]","special")),y(X)){if(q&&U.match(/^\d+$/))return K;(X=JSON.stringify(""+U)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(X=X.substr(1,X.length-2),X=M.stylize(X,"name")):(X=X.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),X=M.stylize(X,"string"))}return X+": "+K}function c(M){return Array.isArray(M)}function n(M){return typeof M=="boolean"}function a(M){return M===null}function g(M){return typeof M=="number"}function h(M){return typeof M=="string"}function y(M){return M===void 0}function v(M){return _(M)&&S(M)==="[object RegExp]"}function _(M){return typeof M=="object"&&M!==null}function x(M){return _(M)&&S(M)==="[object Date]"}function T(M){return _(M)&&(S(M)==="[object Error]"||M instanceof Error)}function A(M){return typeof M=="function"}function S(M){return Object.prototype.toString.call(M)}function w(M){return M<10?"0"+M.toString(10):M.toString(10)}B.debuglog=function(M){if(y(p)&&(p=t.env.NODE_DEBUG||""),M=M.toUpperCase(),!e[M])if(new RegExp("\\b"+M+"\\b","i").test(p)){var P=t.pid;e[M]=function(){var D=B.format.apply(B,arguments);console.error("%s %d: %s",M,P,D)}}else e[M]=function(){};return e[M]},B.inspect=f,f.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},f.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},B.isArray=c,B.isBoolean=n,B.isNull=a,B.isNullOrUndefined=function(M){return M==null},B.isNumber=g,B.isString=h,B.isSymbol=function(M){return typeof M=="symbol"},B.isUndefined=y,B.isRegExp=v,B.isObject=_,B.isDate=x,B.isError=T,B.isFunction=A,B.isPrimitive=function(M){return M===null||typeof M=="boolean"||typeof M=="number"||typeof M=="string"||typeof M=="symbol"||M===void 0},B.isBuffer=r("./support/isBuffer");var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function k(){var M=new Date,P=[w(M.getHours()),w(M.getMinutes()),w(M.getSeconds())].join(":");return[M.getDate(),C[M.getMonth()],P].join(" ")}function L(M,P){return Object.prototype.hasOwnProperty.call(M,P)}B.log=function(){console.log("%s - %s",k(),B.format.apply(B,arguments))},B.inherits=r("inherits"),B._extend=function(M,P){if(!P||!_(P))return M;for(var D=Object.keys(P),N=D.length;N--;)M[D[N]]=P[D[N]];return M}}).call(this)}).call(this,r("_process"),typeof Xi!="undefined"?Xi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./support/isBuffer":82,_process:514,inherits:81}],84:[function(r,O,B){O.exports=function(t){return atob(t)}},{}],85:[function(r,O,B){O.exports=function(m,p){for(var e=p.length,f=new Array(e+1),u=0;u<e;++u){for(var s=new Array(e+1),l=0;l<=e;++l)s[l]=m[l][u];f[u]=s}for(f[e]=new Array(e+1),u=0;u<=e;++u)f[e][u]=1;var o=new Array(e+1);for(u=0;u<e;++u)o[u]=p[u];o[e]=1;var i=t(f,o),c=d(i[e+1]);c===0&&(c=1);var n=new Array(e+1);for(u=0;u<=e;++u)n[u]=d(i[u])/c;return n};var t=r("robust-linear-solve");function d(m){for(var p=0,e=0;e<m.length;++e)p+=m[e];return p}},{"robust-linear-solve":533}],86:[function(r,O,B){B.byteLength=function(l){var o=u(l),i=o[0],c=o[1];return 3*(i+c)/4-c},B.toByteArray=function(l){var o,i,c=u(l),n=c[0],a=c[1],g=new m(function(v,_,x){return 3*(_+x)/4-x}(0,n,a)),h=0,y=a>0?n-4:n;for(i=0;i<y;i+=4)o=d[l.charCodeAt(i)]<<18|d[l.charCodeAt(i+1)]<<12|d[l.charCodeAt(i+2)]<<6|d[l.charCodeAt(i+3)],g[h++]=o>>16&255,g[h++]=o>>8&255,g[h++]=255&o;return a===2&&(o=d[l.charCodeAt(i)]<<2|d[l.charCodeAt(i+1)]>>4,g[h++]=255&o),a===1&&(o=d[l.charCodeAt(i)]<<10|d[l.charCodeAt(i+1)]<<4|d[l.charCodeAt(i+2)]>>2,g[h++]=o>>8&255,g[h++]=255&o),g},B.fromByteArray=function(l){for(var o,i=l.length,c=i%3,n=[],a=0,g=i-c;a<g;a+=16383)n.push(s(l,a,a+16383>g?g:a+16383));return c===1?(o=l[i-1],n.push(t[o>>2]+t[o<<4&63]+"==")):c===2&&(o=(l[i-2]<<8)+l[i-1],n.push(t[o>>10]+t[o>>4&63]+t[o<<2&63]+"=")),n.join("")};for(var t=[],d=[],m=typeof Uint8Array!="undefined"?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,f=p.length;e<f;++e)t[e]=p[e],d[p.charCodeAt(e)]=e;function u(l){var o=l.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=l.indexOf("=");return i===-1&&(i=o),[i,i===o?0:4-i%4]}function s(l,o,i){for(var c,n,a=[],g=o;g<i;g+=3)c=(l[g]<<16&16711680)+(l[g+1]<<8&65280)+(255&l[g+2]),a.push(t[(n=c)>>18&63]+t[n>>12&63]+t[n>>6&63]+t[63&n]);return a.join("")}d["-".charCodeAt(0)]=62,d["_".charCodeAt(0)]=63},{}],87:[function(r,O,B){var t=r("./lib/rationalize");O.exports=function(d,m){return t(d[0].mul(m[1]).add(m[0].mul(d[1])),d[1].mul(m[1]))}},{"./lib/rationalize":97}],88:[function(r,O,B){O.exports=function(t,d){return t[0].mul(d[1]).cmp(d[0].mul(t[1]))}},{}],89:[function(r,O,B){var t=r("./lib/rationalize");O.exports=function(d,m){return t(d[0].mul(m[1]),d[1].mul(m[0]))}},{"./lib/rationalize":97}],90:[function(r,O,B){var t=r("./is-rat"),d=r("./lib/is-bn"),m=r("./lib/num-to-bn"),p=r("./lib/str-to-bn"),e=r("./lib/rationalize"),f=r("./div");O.exports=function u(s,l){if(t(s))return l?f(s,u(l)):[s[0].clone(),s[1].clone()];var o,i,c=0;if(d(s))o=s.clone();else if(typeof s=="string")o=p(s);else{if(s===0)return[m(0),m(1)];if(s===Math.floor(s))o=m(s);else{for(;s!==Math.floor(s);)s*=Math.pow(2,256),c-=256;o=m(s)}}if(t(l))o.mul(l[1]),i=l[0].clone();else if(d(l))i=l.clone();else if(typeof l=="string")i=p(l);else if(l)if(l===Math.floor(l))i=m(l);else{for(;l!==Math.floor(l);)l*=Math.pow(2,256),c+=256;i=m(l)}else i=m(1);return c>0?o=o.ushln(c):c<0&&(i=i.ushln(-c)),e(o,i)}},{"./div":89,"./is-rat":91,"./lib/is-bn":95,"./lib/num-to-bn":96,"./lib/rationalize":97,"./lib/str-to-bn":98}],91:[function(r,O,B){var t=r("./lib/is-bn");O.exports=function(d){return Array.isArray(d)&&d.length===2&&t(d[0])&&t(d[1])}},{"./lib/is-bn":95}],92:[function(r,O,B){var t=r("bn.js");O.exports=function(d){return d.cmp(new t(0))}},{"bn.js":106}],93:[function(r,O,B){var t=r("./bn-sign");O.exports=function(d){var m=d.length,p=d.words,e=0;if(m===1)e=p[0];else if(m===2)e=p[0]+67108864*p[1];else for(var f=0;f<m;f++){var u=p[f];e+=u*Math.pow(67108864,f)}return t(d)*e}},{"./bn-sign":92}],94:[function(r,O,B){var t=r("double-bits"),d=r("bit-twiddle").countTrailingZeros;O.exports=function(m){var p=d(t.lo(m));if(p<32)return p;var e=d(t.hi(m));return e>20?52:e+32}},{"bit-twiddle":104,"double-bits":179}],95:[function(r,O,B){r("bn.js"),O.exports=function(t){return t&&typeof t=="object"&&Boolean(t.words)}},{"bn.js":106}],96:[function(r,O,B){var t=r("bn.js"),d=r("double-bits");O.exports=function(m){var p=d.exponent(m);return p<52?new t(m):new t(m*Math.pow(2,52-p)).ushln(p-52)}},{"bn.js":106,"double-bits":179}],97:[function(r,O,B){var t=r("./num-to-bn"),d=r("./bn-sign");O.exports=function(m,p){var e=d(m),f=d(p);if(e===0)return[t(0),t(1)];if(f===0)return[t(0),t(0)];f<0&&(m=m.neg(),p=p.neg());var u=m.gcd(p);return u.cmpn(1)?[m.div(u),p.div(u)]:[m,p]}},{"./bn-sign":92,"./num-to-bn":96}],98:[function(r,O,B){var t=r("bn.js");O.exports=function(d){return new t(d)}},{"bn.js":106}],99:[function(r,O,B){var t=r("./lib/rationalize");O.exports=function(d,m){return t(d[0].mul(m[0]),d[1].mul(m[1]))}},{"./lib/rationalize":97}],100:[function(r,O,B){var t=r("./lib/bn-sign");O.exports=function(d){return t(d[0])*t(d[1])}},{"./lib/bn-sign":92}],101:[function(r,O,B){var t=r("./lib/rationalize");O.exports=function(d,m){return t(d[0].mul(m[1]).sub(d[1].mul(m[0])),d[1].mul(m[1]))}},{"./lib/rationalize":97}],102:[function(r,O,B){var t=r("./lib/bn-to-num"),d=r("./lib/ctz");O.exports=function(m){var p=m[0],e=m[1];if(p.cmpn(0)===0)return 0;var f=p.abs().divmod(e.abs()),u=f.div,s=t(u),l=f.mod,o=p.negative!==e.negative?-1:1;if(l.cmpn(0)===0)return o*s;if(s){var i=d(s)+4,c=t(l.ushln(i).divRound(e));return o*(s+c*Math.pow(2,-i))}var n=e.bitLength()-l.bitLength()+53;return c=t(l.ushln(n).divRound(e)),n<1023?o*c*Math.pow(2,-n):(c*=Math.pow(2,-1023),o*c*Math.pow(2,1023-n))}},{"./lib/bn-to-num":93,"./lib/ctz":94}],103:[function(r,O,B){function t(u,s,l,o,i){for(var c=i+1;o<=i;){var n=o+i>>>1,a=u[n];(l!==void 0?l(a,s):a-s)>=0?(c=n,i=n-1):o=n+1}return c}function d(u,s,l,o,i){for(var c=i+1;o<=i;){var n=o+i>>>1,a=u[n];(l!==void 0?l(a,s):a-s)>0?(c=n,i=n-1):o=n+1}return c}function m(u,s,l,o,i){for(var c=o-1;o<=i;){var n=o+i>>>1,a=u[n];(l!==void 0?l(a,s):a-s)<0?(c=n,o=n+1):i=n-1}return c}function p(u,s,l,o,i){for(var c=o-1;o<=i;){var n=o+i>>>1,a=u[n];(l!==void 0?l(a,s):a-s)<=0?(c=n,o=n+1):i=n-1}return c}function e(u,s,l,o,i){for(;o<=i;){var c=o+i>>>1,n=u[c],a=l!==void 0?l(n,s):n-s;if(a===0)return c;a<=0?o=c+1:i=c-1}return-1}function f(u,s,l,o,i,c){return typeof l=="function"?c(u,s,l,o===void 0?0:0|o,i===void 0?u.length-1:0|i):c(u,s,void 0,l===void 0?0:0|l,o===void 0?u.length-1:0|o)}O.exports={ge:function(u,s,l,o,i){return f(u,s,l,o,i,t)},gt:function(u,s,l,o,i){return f(u,s,l,o,i,d)},lt:function(u,s,l,o,i){return f(u,s,l,o,i,m)},le:function(u,s,l,o,i){return f(u,s,l,o,i,p)},eq:function(u,s,l,o,i){return f(u,s,l,o,i,e)}}},{}],104:[function(r,O,B){function t(m){var p=32;return(m&=-m)&&p--,65535&m&&(p-=16),16711935&m&&(p-=8),252645135&m&&(p-=4),858993459&m&&(p-=2),1431655765&m&&(p-=1),p}B.INT_BITS=32,B.INT_MAX=2147483647,B.INT_MIN=-1<<31,B.sign=function(m){return(m>0)-(m<0)},B.abs=function(m){var p=m>>31;return(m^p)-p},B.min=function(m,p){return p^(m^p)&-(m<p)},B.max=function(m,p){return m^(m^p)&-(m<p)},B.isPow2=function(m){return!(m&m-1||!m)},B.log2=function(m){var p,e;return p=(m>65535)<<4,p|=e=((m>>>=p)>255)<<3,p|=e=((m>>>=e)>15)<<2,(p|=e=((m>>>=e)>3)<<1)|(m>>>=e)>>1},B.log10=function(m){return m>=1e9?9:m>=1e8?8:m>=1e7?7:m>=1e6?6:m>=1e5?5:m>=1e4?4:m>=1e3?3:m>=100?2:m>=10?1:0},B.popCount=function(m){return 16843009*((m=(858993459&(m-=m>>>1&1431655765))+(m>>>2&858993459))+(m>>>4)&252645135)>>>24},B.countTrailingZeros=t,B.nextPow2=function(m){return m+=m===0,--m,m|=m>>>1,m|=m>>>2,m|=m>>>4,m|=m>>>8,(m|=m>>>16)+1},B.prevPow2=function(m){return m|=m>>>1,m|=m>>>2,m|=m>>>4,m|=m>>>8,(m|=m>>>16)-(m>>>1)},B.parity=function(m){return m^=m>>>16,m^=m>>>8,m^=m>>>4,27030>>>(m&=15)&1};var d=new Array(256);(function(m){for(var p=0;p<256;++p){var e=p,f=p,u=7;for(e>>>=1;e;e>>>=1)f<<=1,f|=1&e,--u;m[p]=f<<u&255}})(d),B.reverse=function(m){return d[255&m]<<24|d[m>>>8&255]<<16|d[m>>>16&255]<<8|d[m>>>24&255]},B.interleave2=function(m,p){return(m=1431655765&((m=858993459&((m=252645135&((m=16711935&((m&=65535)|m<<8))|m<<4))|m<<2))|m<<1))|(p=1431655765&((p=858993459&((p=252645135&((p=16711935&((p&=65535)|p<<8))|p<<4))|p<<2))|p<<1))<<1},B.deinterleave2=function(m,p){return(m=65535&((m=16711935&((m=252645135&((m=858993459&((m=m>>>p&1431655765)|m>>>1))|m>>>2))|m>>>4))|m>>>16))<<16>>16},B.interleave3=function(m,p,e){return m=1227133513&((m=3272356035&((m=251719695&((m=4278190335&((m&=1023)|m<<16))|m<<8))|m<<4))|m<<2),(m|=(p=1227133513&((p=3272356035&((p=251719695&((p=4278190335&((p&=1023)|p<<16))|p<<8))|p<<4))|p<<2))<<1)|(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<2},B.deinterleave3=function(m,p){return(m=1023&((m=4278190335&((m=251719695&((m=3272356035&((m=m>>>p&1227133513)|m>>>2))|m>>>4))|m>>>8))|m>>>16))<<22>>22},B.nextCombination=function(m){var p=m|m-1;return p+1|(~p&-~p)-1>>>t(m)+1}},{}],105:[function(r,O,B){var t=r("clamp");O.exports=function(e,f){f||(f={});var u,s,l,o,i,c,n,a,g,h,y,v=f.cutoff==null?.25:f.cutoff,_=f.radius==null?8:f.radius,x=f.channel||0;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!f.width||!f.height)throw Error("For raw data width and height should be provided by options");u=f.width,s=f.height,o=e,c=f.stride?f.stride:Math.floor(e.length/u/s)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(n=(a=e).getContext("2d"),u=a.width,s=a.height,g=n.getImageData(0,0,u,s),o=g.data,c=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(a=e.canvas,n=e,u=a.width,s=a.height,g=n.getImageData(0,0,u,s),o=g.data,c=4):window.ImageData&&e instanceof window.ImageData&&(g=e,u=e.width,s=e.height,o=g.data,c=4);if(l=Math.max(u,s),window.Uint8ClampedArray&&o instanceof window.Uint8ClampedArray||window.Uint8Array&&o instanceof window.Uint8Array)for(i=o,o=Array(u*s),h=0,y=i.length;h<y;h++)o[h]=i[h*c+x]/255;else if(c!==1)throw Error("Raw data can have only 1 value per pixel");var T=Array(u*s),A=Array(u*s),S=Array(l),w=Array(l),C=Array(l+1),k=Array(l);for(h=0,y=u*s;h<y;h++){var L=o[h];T[h]=L===1?0:L===0?d:Math.pow(Math.max(0,.5-L),2),A[h]=L===1?d:L===0?0:Math.pow(Math.max(0,L-.5),2)}m(T,u,s,S,w,k,C),m(A,u,s,S,w,k,C);var M=window.Float32Array?new Float32Array(u*s):new Array(u*s);for(h=0,y=u*s;h<y;h++)M[h]=t(1-((T[h]-A[h])/_+v),0,1);return M};var d=1e20;function m(e,f,u,s,l,o,i){for(var c=0;c<f;c++){for(var n=0;n<u;n++)s[n]=e[n*f+c];for(p(s,l,o,i,u),n=0;n<u;n++)e[n*f+c]=l[n]}for(n=0;n<u;n++){for(c=0;c<f;c++)s[c]=e[n*f+c];for(p(s,l,o,i,f),c=0;c<f;c++)e[n*f+c]=Math.sqrt(l[c])}}function p(e,f,u,s,l){u[0]=0,s[0]=-d,s[1]=+d;for(var o=1,i=0;o<l;o++){for(var c=(e[o]+o*o-(e[u[i]]+u[i]*u[i]))/(2*o-2*u[i]);c<=s[i];)i--,c=(e[o]+o*o-(e[u[i]]+u[i]*u[i]))/(2*o-2*u[i]);u[++i]=o,s[i]=c,s[i+1]=+d}for(o=0,i=0;o<l;o++){for(;s[i+1]<o;)i++;f[o]=(o-u[i])*(o-u[i])+e[u[i]]}}},{clamp:126}],106:[function(r,O,B){(function(t,d){function m(w,C){if(!w)throw new Error(C||"Assertion failed")}function p(w,C){w.super_=C;var k=function(){};k.prototype=C.prototype,w.prototype=new k,w.prototype.constructor=w}function e(w,C,k){if(e.isBN(w))return w;this.negative=0,this.words=null,this.length=0,this.red=null,w!==null&&(C!=="le"&&C!=="be"||(k=C,C=10),this._init(w||0,C||10,k||"be"))}var f;typeof t=="object"?t.exports=e:d.BN=e,e.BN=e,e.wordSize=26;try{f=r("buffer").Buffer}catch(w){}function u(w,C,k){for(var L=0,M=Math.min(w.length,k),P=C;P<M;P++){var D=w.charCodeAt(P)-48;L<<=4,L|=D>=49&&D<=54?D-49+10:D>=17&&D<=22?D-17+10:15&D}return L}function s(w,C,k,L){for(var M=0,P=Math.min(w.length,k),D=C;D<P;D++){var N=w.charCodeAt(D)-48;M*=L,M+=N>=49?N-49+10:N>=17?N-17+10:N}return M}e.isBN=function(w){return w instanceof e||w!==null&&typeof w=="object"&&w.constructor.wordSize===e.wordSize&&Array.isArray(w.words)},e.max=function(w,C){return w.cmp(C)>0?w:C},e.min=function(w,C){return w.cmp(C)<0?w:C},e.prototype._init=function(w,C,k){if(typeof w=="number")return this._initNumber(w,C,k);if(typeof w=="object")return this._initArray(w,C,k);C==="hex"&&(C=16),m(C===(0|C)&&C>=2&&C<=36);var L=0;(w=w.toString().replace(/\s+/g,""))[0]==="-"&&L++,C===16?this._parseHex(w,L):this._parseBase(w,C,L),w[0]==="-"&&(this.negative=1),this.strip(),k==="le"&&this._initArray(this.toArray(),C,k)},e.prototype._initNumber=function(w,C,k){w<0&&(this.negative=1,w=-w),w<67108864?(this.words=[67108863&w],this.length=1):w<4503599627370496?(this.words=[67108863&w,w/67108864&67108863],this.length=2):(m(w<9007199254740992),this.words=[67108863&w,w/67108864&67108863,1],this.length=3),k==="le"&&this._initArray(this.toArray(),C,k)},e.prototype._initArray=function(w,C,k){if(m(typeof w.length=="number"),w.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(w.length/3),this.words=new Array(this.length);for(var L=0;L<this.length;L++)this.words[L]=0;var M,P,D=0;if(k==="be")for(L=w.length-1,M=0;L>=0;L-=3)P=w[L]|w[L-1]<<8|w[L-2]<<16,this.words[M]|=P<<D&67108863,this.words[M+1]=P>>>26-D&67108863,(D+=24)>=26&&(D-=26,M++);else if(k==="le")for(L=0,M=0;L<w.length;L+=3)P=w[L]|w[L+1]<<8|w[L+2]<<16,this.words[M]|=P<<D&67108863,this.words[M+1]=P>>>26-D&67108863,(D+=24)>=26&&(D-=26,M++);return this.strip()},e.prototype._parseHex=function(w,C){this.length=Math.ceil((w.length-C)/6),this.words=new Array(this.length);for(var k=0;k<this.length;k++)this.words[k]=0;var L,M,P=0;for(k=w.length-6,L=0;k>=C;k-=6)M=u(w,k,k+6),this.words[L]|=M<<P&67108863,this.words[L+1]|=M>>>26-P&4194303,(P+=24)>=26&&(P-=26,L++);k+6!==C&&(M=u(w,C,k+6),this.words[L]|=M<<P&67108863,this.words[L+1]|=M>>>26-P&4194303),this.strip()},e.prototype._parseBase=function(w,C,k){this.words=[0],this.length=1;for(var L=0,M=1;M<=67108863;M*=C)L++;L--,M=M/C|0;for(var P=w.length-k,D=P%L,N=Math.min(P,P-D)+k,U=0,q=k;q<N;q+=L)U=s(w,q,q+L,C),this.imuln(M),this.words[0]+U<67108864?this.words[0]+=U:this._iaddn(U);if(D!==0){var X=1;for(U=s(w,q,w.length,C),q=0;q<D;q++)X*=C;this.imuln(X),this.words[0]+U<67108864?this.words[0]+=U:this._iaddn(U)}},e.prototype.copy=function(w){w.words=new Array(this.length);for(var C=0;C<this.length;C++)w.words[C]=this.words[C];w.length=this.length,w.negative=this.negative,w.red=this.red},e.prototype.clone=function(){var w=new e(null);return this.copy(w),w},e.prototype._expand=function(w){for(;this.length<w;)this.words[this.length++]=0;return this},e.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},e.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},e.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],o=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],i=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function c(w,C,k){k.negative=C.negative^w.negative;var L=w.length+C.length|0;k.length=L,L=L-1|0;var M=0|w.words[0],P=0|C.words[0],D=M*P,N=67108863&D,U=D/67108864|0;k.words[0]=N;for(var q=1;q<L;q++){for(var X=U>>>26,K=67108863&U,Z=Math.min(q,C.length-1),H=Math.max(0,q-w.length+1);H<=Z;H++){var Y=q-H|0;X+=(D=(M=0|w.words[Y])*(P=0|C.words[H])+K)/67108864|0,K=67108863&D}k.words[q]=0|K,U=0|X}return U!==0?k.words[q]=0|U:k.length--,k.strip()}e.prototype.toString=function(w,C){var k;if(C=0|C||1,(w=w||10)===16||w==="hex"){k="";for(var L=0,M=0,P=0;P<this.length;P++){var D=this.words[P],N=(16777215&(D<<L|M)).toString(16);k=(M=D>>>24-L&16777215)!=0||P!==this.length-1?l[6-N.length]+N+k:N+k,(L+=2)>=26&&(L-=26,P--)}for(M!==0&&(k=M.toString(16)+k);k.length%C!=0;)k="0"+k;return this.negative!==0&&(k="-"+k),k}if(w===(0|w)&&w>=2&&w<=36){var U=o[w],q=i[w];k="";var X=this.clone();for(X.negative=0;!X.isZero();){var K=X.modn(q).toString(w);k=(X=X.idivn(q)).isZero()?K+k:l[U-K.length]+K+k}for(this.isZero()&&(k="0"+k);k.length%C!=0;)k="0"+k;return this.negative!==0&&(k="-"+k),k}m(!1,"Base should be between 2 and 36")},e.prototype.toNumber=function(){var w=this.words[0];return this.length===2?w+=67108864*this.words[1]:this.length===3&&this.words[2]===1?w+=4503599627370496+67108864*this.words[1]:this.length>2&&m(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-w:w},e.prototype.toJSON=function(){return this.toString(16)},e.prototype.toBuffer=function(w,C){return m(f!==void 0),this.toArrayLike(f,w,C)},e.prototype.toArray=function(w,C){return this.toArrayLike(Array,w,C)},e.prototype.toArrayLike=function(w,C,k){var L=this.byteLength(),M=k||Math.max(1,L);m(L<=M,"byte array longer than desired length"),m(M>0,"Requested array length <= 0"),this.strip();var P,D,N=C==="le",U=new w(M),q=this.clone();if(N){for(D=0;!q.isZero();D++)P=q.andln(255),q.iushrn(8),U[D]=P;for(;D<M;D++)U[D]=0}else{for(D=0;D<M-L;D++)U[D]=0;for(D=0;!q.isZero();D++)P=q.andln(255),q.iushrn(8),U[M-D-1]=P}return U},Math.clz32?e.prototype._countBits=function(w){return 32-Math.clz32(w)}:e.prototype._countBits=function(w){var C=w,k=0;return C>=4096&&(k+=13,C>>>=13),C>=64&&(k+=7,C>>>=7),C>=8&&(k+=4,C>>>=4),C>=2&&(k+=2,C>>>=2),k+C},e.prototype._zeroBits=function(w){if(w===0)return 26;var C=w,k=0;return(8191&C)==0&&(k+=13,C>>>=13),(127&C)==0&&(k+=7,C>>>=7),(15&C)==0&&(k+=4,C>>>=4),(3&C)==0&&(k+=2,C>>>=2),(1&C)==0&&k++,k},e.prototype.bitLength=function(){var w=this.words[this.length-1],C=this._countBits(w);return 26*(this.length-1)+C},e.prototype.zeroBits=function(){if(this.isZero())return 0;for(var w=0,C=0;C<this.length;C++){var k=this._zeroBits(this.words[C]);if(w+=k,k!==26)break}return w},e.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},e.prototype.toTwos=function(w){return this.negative!==0?this.abs().inotn(w).iaddn(1):this.clone()},e.prototype.fromTwos=function(w){return this.testn(w-1)?this.notn(w).iaddn(1).ineg():this.clone()},e.prototype.isNeg=function(){return this.negative!==0},e.prototype.neg=function(){return this.clone().ineg()},e.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},e.prototype.iuor=function(w){for(;this.length<w.length;)this.words[this.length++]=0;for(var C=0;C<w.length;C++)this.words[C]=this.words[C]|w.words[C];return this.strip()},e.prototype.ior=function(w){return m((this.negative|w.negative)==0),this.iuor(w)},e.prototype.or=function(w){return this.length>w.length?this.clone().ior(w):w.clone().ior(this)},e.prototype.uor=function(w){return this.length>w.length?this.clone().iuor(w):w.clone().iuor(this)},e.prototype.iuand=function(w){var C;C=this.length>w.length?w:this;for(var k=0;k<C.length;k++)this.words[k]=this.words[k]&w.words[k];return this.length=C.length,this.strip()},e.prototype.iand=function(w){return m((this.negative|w.negative)==0),this.iuand(w)},e.prototype.and=function(w){return this.length>w.length?this.clone().iand(w):w.clone().iand(this)},e.prototype.uand=function(w){return this.length>w.length?this.clone().iuand(w):w.clone().iuand(this)},e.prototype.iuxor=function(w){var C,k;this.length>w.length?(C=this,k=w):(C=w,k=this);for(var L=0;L<k.length;L++)this.words[L]=C.words[L]^k.words[L];if(this!==C)for(;L<C.length;L++)this.words[L]=C.words[L];return this.length=C.length,this.strip()},e.prototype.ixor=function(w){return m((this.negative|w.negative)==0),this.iuxor(w)},e.prototype.xor=function(w){return this.length>w.length?this.clone().ixor(w):w.clone().ixor(this)},e.prototype.uxor=function(w){return this.length>w.length?this.clone().iuxor(w):w.clone().iuxor(this)},e.prototype.inotn=function(w){m(typeof w=="number"&&w>=0);var C=0|Math.ceil(w/26),k=w%26;this._expand(C),k>0&&C--;for(var L=0;L<C;L++)this.words[L]=67108863&~this.words[L];return k>0&&(this.words[L]=~this.words[L]&67108863>>26-k),this.strip()},e.prototype.notn=function(w){return this.clone().inotn(w)},e.prototype.setn=function(w,C){m(typeof w=="number"&&w>=0);var k=w/26|0,L=w%26;return this._expand(k+1),this.words[k]=C?this.words[k]|1<<L:this.words[k]&~(1<<L),this.strip()},e.prototype.iadd=function(w){var C,k,L;if(this.negative!==0&&w.negative===0)return this.negative=0,C=this.isub(w),this.negative^=1,this._normSign();if(this.negative===0&&w.negative!==0)return w.negative=0,C=this.isub(w),w.negative=1,C._normSign();this.length>w.length?(k=this,L=w):(k=w,L=this);for(var M=0,P=0;P<L.length;P++)C=(0|k.words[P])+(0|L.words[P])+M,this.words[P]=67108863&C,M=C>>>26;for(;M!==0&&P<k.length;P++)C=(0|k.words[P])+M,this.words[P]=67108863&C,M=C>>>26;if(this.length=k.length,M!==0)this.words[this.length]=M,this.length++;else if(k!==this)for(;P<k.length;P++)this.words[P]=k.words[P];return this},e.prototype.add=function(w){var C;return w.negative!==0&&this.negative===0?(w.negative=0,C=this.sub(w),w.negative^=1,C):w.negative===0&&this.negative!==0?(this.negative=0,C=w.sub(this),this.negative=1,C):this.length>w.length?this.clone().iadd(w):w.clone().iadd(this)},e.prototype.isub=function(w){if(w.negative!==0){w.negative=0;var C=this.iadd(w);return w.negative=1,C._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(w),this.negative=1,this._normSign();var k,L,M=this.cmp(w);if(M===0)return this.negative=0,this.length=1,this.words[0]=0,this;M>0?(k=this,L=w):(k=w,L=this);for(var P=0,D=0;D<L.length;D++)P=(C=(0|k.words[D])-(0|L.words[D])+P)>>26,this.words[D]=67108863&C;for(;P!==0&&D<k.length;D++)P=(C=(0|k.words[D])+P)>>26,this.words[D]=67108863&C;if(P===0&&D<k.length&&k!==this)for(;D<k.length;D++)this.words[D]=k.words[D];return this.length=Math.max(this.length,D),k!==this&&(this.negative=1),this.strip()},e.prototype.sub=function(w){return this.clone().isub(w)};var n=function(w,C,k){var L,M,P,D=w.words,N=C.words,U=k.words,q=0,X=0|D[0],K=8191&X,Z=X>>>13,H=0|D[1],Y=8191&H,$=H>>>13,z=0|D[2],j=8191&z,W=z>>>13,ee=0|D[3],J=8191&ee,Q=ee>>>13,te=0|D[4],ie=8191&te,ae=te>>>13,he=0|D[5],se=8191&he,de=he>>>13,ue=0|D[6],ve=8191&ue,ke=ue>>>13,Ee=0|D[7],be=8191&Ee,xe=Ee>>>13,ce=0|D[8],ge=8191&ce,we=ce>>>13,Me=0|D[9],Se=8191&Me,ze=Me>>>13,Fe=0|N[0],Ye=8191&Fe,rt=Fe>>>13,Oe=0|N[1],je=8191&Oe,We=Oe>>>13,qe=0|N[2],Qe=8191&qe,st=qe>>>13,ct=0|N[3],Pt=8191&ct,kt=ct>>>13,at=0|N[4],tt=8191&at,_t=at>>>13,er=0|N[5],tr=8191&er,Ue=er>>>13,He=0|N[6],Be=8191&He,Ke=He>>>13,_e=0|N[7],Ce=8191&_e,Le=_e>>>13,Pe=0|N[8],Xe=8191&Pe,ht=Pe>>>13,Mt=0|N[9],pt=8191&Mt,Lt=Mt>>>13;k.negative=w.negative^C.negative,k.length=19;var vt=(q+(L=Math.imul(K,Ye))|0)+((8191&(M=(M=Math.imul(K,rt))+Math.imul(Z,Ye)|0))<<13)|0;q=((P=Math.imul(Z,rt))+(M>>>13)|0)+(vt>>>26)|0,vt&=67108863,L=Math.imul(Y,Ye),M=(M=Math.imul(Y,rt))+Math.imul($,Ye)|0,P=Math.imul($,rt);var Dt=(q+(L=L+Math.imul(K,je)|0)|0)+((8191&(M=(M=M+Math.imul(K,We)|0)+Math.imul(Z,je)|0))<<13)|0;q=((P=P+Math.imul(Z,We)|0)+(M>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,L=Math.imul(j,Ye),M=(M=Math.imul(j,rt))+Math.imul(W,Ye)|0,P=Math.imul(W,rt),L=L+Math.imul(Y,je)|0,M=(M=M+Math.imul(Y,We)|0)+Math.imul($,je)|0,P=P+Math.imul($,We)|0;var xt=(q+(L=L+Math.imul(K,Qe)|0)|0)+((8191&(M=(M=M+Math.imul(K,st)|0)+Math.imul(Z,Qe)|0))<<13)|0;q=((P=P+Math.imul(Z,st)|0)+(M>>>13)|0)+(xt>>>26)|0,xt&=67108863,L=Math.imul(J,Ye),M=(M=Math.imul(J,rt))+Math.imul(Q,Ye)|0,P=Math.imul(Q,rt),L=L+Math.imul(j,je)|0,M=(M=M+Math.imul(j,We)|0)+Math.imul(W,je)|0,P=P+Math.imul(W,We)|0,L=L+Math.imul(Y,Qe)|0,M=(M=M+Math.imul(Y,st)|0)+Math.imul($,Qe)|0,P=P+Math.imul($,st)|0;var it=(q+(L=L+Math.imul(K,Pt)|0)|0)+((8191&(M=(M=M+Math.imul(K,kt)|0)+Math.imul(Z,Pt)|0))<<13)|0;q=((P=P+Math.imul(Z,kt)|0)+(M>>>13)|0)+(it>>>26)|0,it&=67108863,L=Math.imul(ie,Ye),M=(M=Math.imul(ie,rt))+Math.imul(ae,Ye)|0,P=Math.imul(ae,rt),L=L+Math.imul(J,je)|0,M=(M=M+Math.imul(J,We)|0)+Math.imul(Q,je)|0,P=P+Math.imul(Q,We)|0,L=L+Math.imul(j,Qe)|0,M=(M=M+Math.imul(j,st)|0)+Math.imul(W,Qe)|0,P=P+Math.imul(W,st)|0,L=L+Math.imul(Y,Pt)|0,M=(M=M+Math.imul(Y,kt)|0)+Math.imul($,Pt)|0,P=P+Math.imul($,kt)|0;var St=(q+(L=L+Math.imul(K,tt)|0)|0)+((8191&(M=(M=M+Math.imul(K,_t)|0)+Math.imul(Z,tt)|0))<<13)|0;q=((P=P+Math.imul(Z,_t)|0)+(M>>>13)|0)+(St>>>26)|0,St&=67108863,L=Math.imul(se,Ye),M=(M=Math.imul(se,rt))+Math.imul(de,Ye)|0,P=Math.imul(de,rt),L=L+Math.imul(ie,je)|0,M=(M=M+Math.imul(ie,We)|0)+Math.imul(ae,je)|0,P=P+Math.imul(ae,We)|0,L=L+Math.imul(J,Qe)|0,M=(M=M+Math.imul(J,st)|0)+Math.imul(Q,Qe)|0,P=P+Math.imul(Q,st)|0,L=L+Math.imul(j,Pt)|0,M=(M=M+Math.imul(j,kt)|0)+Math.imul(W,Pt)|0,P=P+Math.imul(W,kt)|0,L=L+Math.imul(Y,tt)|0,M=(M=M+Math.imul(Y,_t)|0)+Math.imul($,tt)|0,P=P+Math.imul($,_t)|0;var Nt=(q+(L=L+Math.imul(K,tr)|0)|0)+((8191&(M=(M=M+Math.imul(K,Ue)|0)+Math.imul(Z,tr)|0))<<13)|0;q=((P=P+Math.imul(Z,Ue)|0)+(M>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,L=Math.imul(ve,Ye),M=(M=Math.imul(ve,rt))+Math.imul(ke,Ye)|0,P=Math.imul(ke,rt),L=L+Math.imul(se,je)|0,M=(M=M+Math.imul(se,We)|0)+Math.imul(de,je)|0,P=P+Math.imul(de,We)|0,L=L+Math.imul(ie,Qe)|0,M=(M=M+Math.imul(ie,st)|0)+Math.imul(ae,Qe)|0,P=P+Math.imul(ae,st)|0,L=L+Math.imul(J,Pt)|0,M=(M=M+Math.imul(J,kt)|0)+Math.imul(Q,Pt)|0,P=P+Math.imul(Q,kt)|0,L=L+Math.imul(j,tt)|0,M=(M=M+Math.imul(j,_t)|0)+Math.imul(W,tt)|0,P=P+Math.imul(W,_t)|0,L=L+Math.imul(Y,tr)|0,M=(M=M+Math.imul(Y,Ue)|0)+Math.imul($,tr)|0,P=P+Math.imul($,Ue)|0;var Ut=(q+(L=L+Math.imul(K,Be)|0)|0)+((8191&(M=(M=M+Math.imul(K,Ke)|0)+Math.imul(Z,Be)|0))<<13)|0;q=((P=P+Math.imul(Z,Ke)|0)+(M>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,L=Math.imul(be,Ye),M=(M=Math.imul(be,rt))+Math.imul(xe,Ye)|0,P=Math.imul(xe,rt),L=L+Math.imul(ve,je)|0,M=(M=M+Math.imul(ve,We)|0)+Math.imul(ke,je)|0,P=P+Math.imul(ke,We)|0,L=L+Math.imul(se,Qe)|0,M=(M=M+Math.imul(se,st)|0)+Math.imul(de,Qe)|0,P=P+Math.imul(de,st)|0,L=L+Math.imul(ie,Pt)|0,M=(M=M+Math.imul(ie,kt)|0)+Math.imul(ae,Pt)|0,P=P+Math.imul(ae,kt)|0,L=L+Math.imul(J,tt)|0,M=(M=M+Math.imul(J,_t)|0)+Math.imul(Q,tt)|0,P=P+Math.imul(Q,_t)|0,L=L+Math.imul(j,tr)|0,M=(M=M+Math.imul(j,Ue)|0)+Math.imul(W,tr)|0,P=P+Math.imul(W,Ue)|0,L=L+Math.imul(Y,Be)|0,M=(M=M+Math.imul(Y,Ke)|0)+Math.imul($,Be)|0,P=P+Math.imul($,Ke)|0;var Qt=(q+(L=L+Math.imul(K,Ce)|0)|0)+((8191&(M=(M=M+Math.imul(K,Le)|0)+Math.imul(Z,Ce)|0))<<13)|0;q=((P=P+Math.imul(Z,Le)|0)+(M>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,L=Math.imul(ge,Ye),M=(M=Math.imul(ge,rt))+Math.imul(we,Ye)|0,P=Math.imul(we,rt),L=L+Math.imul(be,je)|0,M=(M=M+Math.imul(be,We)|0)+Math.imul(xe,je)|0,P=P+Math.imul(xe,We)|0,L=L+Math.imul(ve,Qe)|0,M=(M=M+Math.imul(ve,st)|0)+Math.imul(ke,Qe)|0,P=P+Math.imul(ke,st)|0,L=L+Math.imul(se,Pt)|0,M=(M=M+Math.imul(se,kt)|0)+Math.imul(de,Pt)|0,P=P+Math.imul(de,kt)|0,L=L+Math.imul(ie,tt)|0,M=(M=M+Math.imul(ie,_t)|0)+Math.imul(ae,tt)|0,P=P+Math.imul(ae,_t)|0,L=L+Math.imul(J,tr)|0,M=(M=M+Math.imul(J,Ue)|0)+Math.imul(Q,tr)|0,P=P+Math.imul(Q,Ue)|0,L=L+Math.imul(j,Be)|0,M=(M=M+Math.imul(j,Ke)|0)+Math.imul(W,Be)|0,P=P+Math.imul(W,Ke)|0,L=L+Math.imul(Y,Ce)|0,M=(M=M+Math.imul(Y,Le)|0)+Math.imul($,Ce)|0,P=P+Math.imul($,Le)|0;var Ie=(q+(L=L+Math.imul(K,Xe)|0)|0)+((8191&(M=(M=M+Math.imul(K,ht)|0)+Math.imul(Z,Xe)|0))<<13)|0;q=((P=P+Math.imul(Z,ht)|0)+(M>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,L=Math.imul(Se,Ye),M=(M=Math.imul(Se,rt))+Math.imul(ze,Ye)|0,P=Math.imul(ze,rt),L=L+Math.imul(ge,je)|0,M=(M=M+Math.imul(ge,We)|0)+Math.imul(we,je)|0,P=P+Math.imul(we,We)|0,L=L+Math.imul(be,Qe)|0,M=(M=M+Math.imul(be,st)|0)+Math.imul(xe,Qe)|0,P=P+Math.imul(xe,st)|0,L=L+Math.imul(ve,Pt)|0,M=(M=M+Math.imul(ve,kt)|0)+Math.imul(ke,Pt)|0,P=P+Math.imul(ke,kt)|0,L=L+Math.imul(se,tt)|0,M=(M=M+Math.imul(se,_t)|0)+Math.imul(de,tt)|0,P=P+Math.imul(de,_t)|0,L=L+Math.imul(ie,tr)|0,M=(M=M+Math.imul(ie,Ue)|0)+Math.imul(ae,tr)|0,P=P+Math.imul(ae,Ue)|0,L=L+Math.imul(J,Be)|0,M=(M=M+Math.imul(J,Ke)|0)+Math.imul(Q,Be)|0,P=P+Math.imul(Q,Ke)|0,L=L+Math.imul(j,Ce)|0,M=(M=M+Math.imul(j,Le)|0)+Math.imul(W,Ce)|0,P=P+Math.imul(W,Le)|0,L=L+Math.imul(Y,Xe)|0,M=(M=M+Math.imul(Y,ht)|0)+Math.imul($,Xe)|0,P=P+Math.imul($,ht)|0;var lt=(q+(L=L+Math.imul(K,pt)|0)|0)+((8191&(M=(M=M+Math.imul(K,Lt)|0)+Math.imul(Z,pt)|0))<<13)|0;q=((P=P+Math.imul(Z,Lt)|0)+(M>>>13)|0)+(lt>>>26)|0,lt&=67108863,L=Math.imul(Se,je),M=(M=Math.imul(Se,We))+Math.imul(ze,je)|0,P=Math.imul(ze,We),L=L+Math.imul(ge,Qe)|0,M=(M=M+Math.imul(ge,st)|0)+Math.imul(we,Qe)|0,P=P+Math.imul(we,st)|0,L=L+Math.imul(be,Pt)|0,M=(M=M+Math.imul(be,kt)|0)+Math.imul(xe,Pt)|0,P=P+Math.imul(xe,kt)|0,L=L+Math.imul(ve,tt)|0,M=(M=M+Math.imul(ve,_t)|0)+Math.imul(ke,tt)|0,P=P+Math.imul(ke,_t)|0,L=L+Math.imul(se,tr)|0,M=(M=M+Math.imul(se,Ue)|0)+Math.imul(de,tr)|0,P=P+Math.imul(de,Ue)|0,L=L+Math.imul(ie,Be)|0,M=(M=M+Math.imul(ie,Ke)|0)+Math.imul(ae,Be)|0,P=P+Math.imul(ae,Ke)|0,L=L+Math.imul(J,Ce)|0,M=(M=M+Math.imul(J,Le)|0)+Math.imul(Q,Ce)|0,P=P+Math.imul(Q,Le)|0,L=L+Math.imul(j,Xe)|0,M=(M=M+Math.imul(j,ht)|0)+Math.imul(W,Xe)|0,P=P+Math.imul(W,ht)|0;var wt=(q+(L=L+Math.imul(Y,pt)|0)|0)+((8191&(M=(M=M+Math.imul(Y,Lt)|0)+Math.imul($,pt)|0))<<13)|0;q=((P=P+Math.imul($,Lt)|0)+(M>>>13)|0)+(wt>>>26)|0,wt&=67108863,L=Math.imul(Se,Qe),M=(M=Math.imul(Se,st))+Math.imul(ze,Qe)|0,P=Math.imul(ze,st),L=L+Math.imul(ge,Pt)|0,M=(M=M+Math.imul(ge,kt)|0)+Math.imul(we,Pt)|0,P=P+Math.imul(we,kt)|0,L=L+Math.imul(be,tt)|0,M=(M=M+Math.imul(be,_t)|0)+Math.imul(xe,tt)|0,P=P+Math.imul(xe,_t)|0,L=L+Math.imul(ve,tr)|0,M=(M=M+Math.imul(ve,Ue)|0)+Math.imul(ke,tr)|0,P=P+Math.imul(ke,Ue)|0,L=L+Math.imul(se,Be)|0,M=(M=M+Math.imul(se,Ke)|0)+Math.imul(de,Be)|0,P=P+Math.imul(de,Ke)|0,L=L+Math.imul(ie,Ce)|0,M=(M=M+Math.imul(ie,Le)|0)+Math.imul(ae,Ce)|0,P=P+Math.imul(ae,Le)|0,L=L+Math.imul(J,Xe)|0,M=(M=M+Math.imul(J,ht)|0)+Math.imul(Q,Xe)|0,P=P+Math.imul(Q,ht)|0;var Ot=(q+(L=L+Math.imul(j,pt)|0)|0)+((8191&(M=(M=M+Math.imul(j,Lt)|0)+Math.imul(W,pt)|0))<<13)|0;q=((P=P+Math.imul(W,Lt)|0)+(M>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,L=Math.imul(Se,Pt),M=(M=Math.imul(Se,kt))+Math.imul(ze,Pt)|0,P=Math.imul(ze,kt),L=L+Math.imul(ge,tt)|0,M=(M=M+Math.imul(ge,_t)|0)+Math.imul(we,tt)|0,P=P+Math.imul(we,_t)|0,L=L+Math.imul(be,tr)|0,M=(M=M+Math.imul(be,Ue)|0)+Math.imul(xe,tr)|0,P=P+Math.imul(xe,Ue)|0,L=L+Math.imul(ve,Be)|0,M=(M=M+Math.imul(ve,Ke)|0)+Math.imul(ke,Be)|0,P=P+Math.imul(ke,Ke)|0,L=L+Math.imul(se,Ce)|0,M=(M=M+Math.imul(se,Le)|0)+Math.imul(de,Ce)|0,P=P+Math.imul(de,Le)|0,L=L+Math.imul(ie,Xe)|0,M=(M=M+Math.imul(ie,ht)|0)+Math.imul(ae,Xe)|0,P=P+Math.imul(ae,ht)|0;var Gt=(q+(L=L+Math.imul(J,pt)|0)|0)+((8191&(M=(M=M+Math.imul(J,Lt)|0)+Math.imul(Q,pt)|0))<<13)|0;q=((P=P+Math.imul(Q,Lt)|0)+(M>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,L=Math.imul(Se,tt),M=(M=Math.imul(Se,_t))+Math.imul(ze,tt)|0,P=Math.imul(ze,_t),L=L+Math.imul(ge,tr)|0,M=(M=M+Math.imul(ge,Ue)|0)+Math.imul(we,tr)|0,P=P+Math.imul(we,Ue)|0,L=L+Math.imul(be,Be)|0,M=(M=M+Math.imul(be,Ke)|0)+Math.imul(xe,Be)|0,P=P+Math.imul(xe,Ke)|0,L=L+Math.imul(ve,Ce)|0,M=(M=M+Math.imul(ve,Le)|0)+Math.imul(ke,Ce)|0,P=P+Math.imul(ke,Le)|0,L=L+Math.imul(se,Xe)|0,M=(M=M+Math.imul(se,ht)|0)+Math.imul(de,Xe)|0,P=P+Math.imul(de,ht)|0;var ir=(q+(L=L+Math.imul(ie,pt)|0)|0)+((8191&(M=(M=M+Math.imul(ie,Lt)|0)+Math.imul(ae,pt)|0))<<13)|0;q=((P=P+Math.imul(ae,Lt)|0)+(M>>>13)|0)+(ir>>>26)|0,ir&=67108863,L=Math.imul(Se,tr),M=(M=Math.imul(Se,Ue))+Math.imul(ze,tr)|0,P=Math.imul(ze,Ue),L=L+Math.imul(ge,Be)|0,M=(M=M+Math.imul(ge,Ke)|0)+Math.imul(we,Be)|0,P=P+Math.imul(we,Ke)|0,L=L+Math.imul(be,Ce)|0,M=(M=M+Math.imul(be,Le)|0)+Math.imul(xe,Ce)|0,P=P+Math.imul(xe,Le)|0,L=L+Math.imul(ve,Xe)|0,M=(M=M+Math.imul(ve,ht)|0)+Math.imul(ke,Xe)|0,P=P+Math.imul(ke,ht)|0;var Xt=(q+(L=L+Math.imul(se,pt)|0)|0)+((8191&(M=(M=M+Math.imul(se,Lt)|0)+Math.imul(de,pt)|0))<<13)|0;q=((P=P+Math.imul(de,Lt)|0)+(M>>>13)|0)+(Xt>>>26)|0,Xt&=67108863,L=Math.imul(Se,Be),M=(M=Math.imul(Se,Ke))+Math.imul(ze,Be)|0,P=Math.imul(ze,Ke),L=L+Math.imul(ge,Ce)|0,M=(M=M+Math.imul(ge,Le)|0)+Math.imul(we,Ce)|0,P=P+Math.imul(we,Le)|0,L=L+Math.imul(be,Xe)|0,M=(M=M+Math.imul(be,ht)|0)+Math.imul(xe,Xe)|0,P=P+Math.imul(xe,ht)|0;var Kt=(q+(L=L+Math.imul(ve,pt)|0)|0)+((8191&(M=(M=M+Math.imul(ve,Lt)|0)+Math.imul(ke,pt)|0))<<13)|0;q=((P=P+Math.imul(ke,Lt)|0)+(M>>>13)|0)+(Kt>>>26)|0,Kt&=67108863,L=Math.imul(Se,Ce),M=(M=Math.imul(Se,Le))+Math.imul(ze,Ce)|0,P=Math.imul(ze,Le),L=L+Math.imul(ge,Xe)|0,M=(M=M+Math.imul(ge,ht)|0)+Math.imul(we,Xe)|0,P=P+Math.imul(we,ht)|0;var or=(q+(L=L+Math.imul(be,pt)|0)|0)+((8191&(M=(M=M+Math.imul(be,Lt)|0)+Math.imul(xe,pt)|0))<<13)|0;q=((P=P+Math.imul(xe,Lt)|0)+(M>>>13)|0)+(or>>>26)|0,or&=67108863,L=Math.imul(Se,Xe),M=(M=Math.imul(Se,ht))+Math.imul(ze,Xe)|0,P=Math.imul(ze,ht);var dr=(q+(L=L+Math.imul(ge,pt)|0)|0)+((8191&(M=(M=M+Math.imul(ge,Lt)|0)+Math.imul(we,pt)|0))<<13)|0;q=((P=P+Math.imul(we,Lt)|0)+(M>>>13)|0)+(dr>>>26)|0,dr&=67108863;var vr=(q+(L=Math.imul(Se,pt))|0)+((8191&(M=(M=Math.imul(Se,Lt))+Math.imul(ze,pt)|0))<<13)|0;return q=((P=Math.imul(ze,Lt))+(M>>>13)|0)+(vr>>>26)|0,vr&=67108863,U[0]=vt,U[1]=Dt,U[2]=xt,U[3]=it,U[4]=St,U[5]=Nt,U[6]=Ut,U[7]=Qt,U[8]=Ie,U[9]=lt,U[10]=wt,U[11]=Ot,U[12]=Gt,U[13]=ir,U[14]=Xt,U[15]=Kt,U[16]=or,U[17]=dr,U[18]=vr,q!==0&&(U[19]=q,k.length++),k};function a(w,C,k){return new g().mulp(w,C,k)}function g(w,C){this.x=w,this.y=C}Math.imul||(n=c),e.prototype.mulTo=function(w,C){var k=this.length+w.length;return this.length===10&&w.length===10?n(this,w,C):k<63?c(this,w,C):k<1024?function(L,M,P){P.negative=M.negative^L.negative,P.length=L.length+M.length;for(var D=0,N=0,U=0;U<P.length-1;U++){var q=N;N=0;for(var X=67108863&D,K=Math.min(U,M.length-1),Z=Math.max(0,U-L.length+1);Z<=K;Z++){var H=U-Z,Y=(0|L.words[H])*(0|M.words[Z]),$=67108863&Y;X=67108863&($=$+X|0),N+=(q=(q=q+(Y/67108864|0)|0)+($>>>26)|0)>>>26,q&=67108863}P.words[U]=X,D=q,q=N}return D!==0?P.words[U]=D:P.length--,P.strip()}(this,w,C):a(this,w,C)},g.prototype.makeRBT=function(w){for(var C=new Array(w),k=e.prototype._countBits(w)-1,L=0;L<w;L++)C[L]=this.revBin(L,k,w);return C},g.prototype.revBin=function(w,C,k){if(w===0||w===k-1)return w;for(var L=0,M=0;M<C;M++)L|=(1&w)<<C-M-1,w>>=1;return L},g.prototype.permute=function(w,C,k,L,M,P){for(var D=0;D<P;D++)L[D]=C[w[D]],M[D]=k[w[D]]},g.prototype.transform=function(w,C,k,L,M,P){this.permute(P,w,C,k,L,M);for(var D=1;D<M;D<<=1)for(var N=D<<1,U=Math.cos(2*Math.PI/N),q=Math.sin(2*Math.PI/N),X=0;X<M;X+=N)for(var K=U,Z=q,H=0;H<D;H++){var Y=k[X+H],$=L[X+H],z=k[X+H+D],j=L[X+H+D],W=K*z-Z*j;j=K*j+Z*z,z=W,k[X+H]=Y+z,L[X+H]=$+j,k[X+H+D]=Y-z,L[X+H+D]=$-j,H!==N&&(W=U*K-q*Z,Z=U*Z+q*K,K=W)}},g.prototype.guessLen13b=function(w,C){var k=1|Math.max(C,w),L=1&k,M=0;for(k=k/2|0;k;k>>>=1)M++;return 1<<M+1+L},g.prototype.conjugate=function(w,C,k){if(!(k<=1))for(var L=0;L<k/2;L++){var M=w[L];w[L]=w[k-L-1],w[k-L-1]=M,M=C[L],C[L]=-C[k-L-1],C[k-L-1]=-M}},g.prototype.normalize13b=function(w,C){for(var k=0,L=0;L<C/2;L++){var M=8192*Math.round(w[2*L+1]/C)+Math.round(w[2*L]/C)+k;w[L]=67108863&M,k=M<67108864?0:M/67108864|0}return w},g.prototype.convert13b=function(w,C,k,L){for(var M=0,P=0;P<C;P++)M+=0|w[P],k[2*P]=8191&M,M>>>=13,k[2*P+1]=8191&M,M>>>=13;for(P=2*C;P<L;++P)k[P]=0;m(M===0),m((-8192&M)==0)},g.prototype.stub=function(w){for(var C=new Array(w),k=0;k<w;k++)C[k]=0;return C},g.prototype.mulp=function(w,C,k){var L=2*this.guessLen13b(w.length,C.length),M=this.makeRBT(L),P=this.stub(L),D=new Array(L),N=new Array(L),U=new Array(L),q=new Array(L),X=new Array(L),K=new Array(L),Z=k.words;Z.length=L,this.convert13b(w.words,w.length,D,L),this.convert13b(C.words,C.length,q,L),this.transform(D,P,N,U,L,M),this.transform(q,P,X,K,L,M);for(var H=0;H<L;H++){var Y=N[H]*X[H]-U[H]*K[H];U[H]=N[H]*K[H]+U[H]*X[H],N[H]=Y}return this.conjugate(N,U,L),this.transform(N,U,Z,P,L,M),this.conjugate(Z,P,L),this.normalize13b(Z,L),k.negative=w.negative^C.negative,k.length=w.length+C.length,k.strip()},e.prototype.mul=function(w){var C=new e(null);return C.words=new Array(this.length+w.length),this.mulTo(w,C)},e.prototype.mulf=function(w){var C=new e(null);return C.words=new Array(this.length+w.length),a(this,w,C)},e.prototype.imul=function(w){return this.clone().mulTo(w,this)},e.prototype.imuln=function(w){m(typeof w=="number"),m(w<67108864);for(var C=0,k=0;k<this.length;k++){var L=(0|this.words[k])*w,M=(67108863&L)+(67108863&C);C>>=26,C+=L/67108864|0,C+=M>>>26,this.words[k]=67108863&M}return C!==0&&(this.words[k]=C,this.length++),this},e.prototype.muln=function(w){return this.clone().imuln(w)},e.prototype.sqr=function(){return this.mul(this)},e.prototype.isqr=function(){return this.imul(this.clone())},e.prototype.pow=function(w){var C=function(P){for(var D=new Array(P.bitLength()),N=0;N<D.length;N++){var U=N/26|0,q=N%26;D[N]=(P.words[U]&1<<q)>>>q}return D}(w);if(C.length===0)return new e(1);for(var k=this,L=0;L<C.length&&C[L]===0;L++,k=k.sqr());if(++L<C.length)for(var M=k.sqr();L<C.length;L++,M=M.sqr())C[L]!==0&&(k=k.mul(M));return k},e.prototype.iushln=function(w){m(typeof w=="number"&&w>=0);var C,k=w%26,L=(w-k)/26,M=67108863>>>26-k<<26-k;if(k!==0){var P=0;for(C=0;C<this.length;C++){var D=this.words[C]&M,N=(0|this.words[C])-D<<k;this.words[C]=N|P,P=D>>>26-k}P&&(this.words[C]=P,this.length++)}if(L!==0){for(C=this.length-1;C>=0;C--)this.words[C+L]=this.words[C];for(C=0;C<L;C++)this.words[C]=0;this.length+=L}return this.strip()},e.prototype.ishln=function(w){return m(this.negative===0),this.iushln(w)},e.prototype.iushrn=function(w,C,k){var L;m(typeof w=="number"&&w>=0),L=C?(C-C%26)/26:0;var M=w%26,P=Math.min((w-M)/26,this.length),D=67108863^67108863>>>M<<M,N=k;if(L-=P,L=Math.max(0,L),N){for(var U=0;U<P;U++)N.words[U]=this.words[U];N.length=P}if(P!==0)if(this.length>P)for(this.length-=P,U=0;U<this.length;U++)this.words[U]=this.words[U+P];else this.words[0]=0,this.length=1;var q=0;for(U=this.length-1;U>=0&&(q!==0||U>=L);U--){var X=0|this.words[U];this.words[U]=q<<26-M|X>>>M,q=X&D}return N&&q!==0&&(N.words[N.length++]=q),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},e.prototype.ishrn=function(w,C,k){return m(this.negative===0),this.iushrn(w,C,k)},e.prototype.shln=function(w){return this.clone().ishln(w)},e.prototype.ushln=function(w){return this.clone().iushln(w)},e.prototype.shrn=function(w){return this.clone().ishrn(w)},e.prototype.ushrn=function(w){return this.clone().iushrn(w)},e.prototype.testn=function(w){m(typeof w=="number"&&w>=0);var C=w%26,k=(w-C)/26,L=1<<C;return!(this.length<=k)&&!!(this.words[k]&L)},e.prototype.imaskn=function(w){m(typeof w=="number"&&w>=0);var C=w%26,k=(w-C)/26;if(m(this.negative===0,"imaskn works only with positive numbers"),this.length<=k)return this;if(C!==0&&k++,this.length=Math.min(k,this.length),C!==0){var L=67108863^67108863>>>C<<C;this.words[this.length-1]&=L}return this.strip()},e.prototype.maskn=function(w){return this.clone().imaskn(w)},e.prototype.iaddn=function(w){return m(typeof w=="number"),m(w<67108864),w<0?this.isubn(-w):this.negative!==0?this.length===1&&(0|this.words[0])<w?(this.words[0]=w-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(w),this.negative=1,this):this._iaddn(w)},e.prototype._iaddn=function(w){this.words[0]+=w;for(var C=0;C<this.length&&this.words[C]>=67108864;C++)this.words[C]-=67108864,C===this.length-1?this.words[C+1]=1:this.words[C+1]++;return this.length=Math.max(this.length,C+1),this},e.prototype.isubn=function(w){if(m(typeof w=="number"),m(w<67108864),w<0)return this.iaddn(-w);if(this.negative!==0)return this.negative=0,this.iaddn(w),this.negative=1,this;if(this.words[0]-=w,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var C=0;C<this.length&&this.words[C]<0;C++)this.words[C]+=67108864,this.words[C+1]-=1;return this.strip()},e.prototype.addn=function(w){return this.clone().iaddn(w)},e.prototype.subn=function(w){return this.clone().isubn(w)},e.prototype.iabs=function(){return this.negative=0,this},e.prototype.abs=function(){return this.clone().iabs()},e.prototype._ishlnsubmul=function(w,C,k){var L,M,P=w.length+k;this._expand(P);var D=0;for(L=0;L<w.length;L++){M=(0|this.words[L+k])+D;var N=(0|w.words[L])*C;D=((M-=67108863&N)>>26)-(N/67108864|0),this.words[L+k]=67108863&M}for(;L<this.length-k;L++)D=(M=(0|this.words[L+k])+D)>>26,this.words[L+k]=67108863&M;if(D===0)return this.strip();for(m(D===-1),D=0,L=0;L<this.length;L++)D=(M=-(0|this.words[L])+D)>>26,this.words[L]=67108863&M;return this.negative=1,this.strip()},e.prototype._wordDiv=function(w,C){var k=(this.length,w.length),L=this.clone(),M=w,P=0|M.words[M.length-1];(k=26-this._countBits(P))!=0&&(M=M.ushln(k),L.iushln(k),P=0|M.words[M.length-1]);var D,N=L.length-M.length;if(C!=="mod"){(D=new e(null)).length=N+1,D.words=new Array(D.length);for(var U=0;U<D.length;U++)D.words[U]=0}var q=L.clone()._ishlnsubmul(M,1,N);q.negative===0&&(L=q,D&&(D.words[N]=1));for(var X=N-1;X>=0;X--){var K=67108864*(0|L.words[M.length+X])+(0|L.words[M.length+X-1]);for(K=Math.min(K/P|0,67108863),L._ishlnsubmul(M,K,X);L.negative!==0;)K--,L.negative=0,L._ishlnsubmul(M,1,X),L.isZero()||(L.negative^=1);D&&(D.words[X]=K)}return D&&D.strip(),L.strip(),C!=="div"&&k!==0&&L.iushrn(k),{div:D||null,mod:L}},e.prototype.divmod=function(w,C,k){return m(!w.isZero()),this.isZero()?{div:new e(0),mod:new e(0)}:this.negative!==0&&w.negative===0?(P=this.neg().divmod(w,C),C!=="mod"&&(L=P.div.neg()),C!=="div"&&(M=P.mod.neg(),k&&M.negative!==0&&M.iadd(w)),{div:L,mod:M}):this.negative===0&&w.negative!==0?(P=this.divmod(w.neg(),C),C!=="mod"&&(L=P.div.neg()),{div:L,mod:P.mod}):(this.negative&w.negative)!=0?(P=this.neg().divmod(w.neg(),C),C!=="div"&&(M=P.mod.neg(),k&&M.negative!==0&&M.isub(w)),{div:P.div,mod:M}):w.length>this.length||this.cmp(w)<0?{div:new e(0),mod:this}:w.length===1?C==="div"?{div:this.divn(w.words[0]),mod:null}:C==="mod"?{div:null,mod:new e(this.modn(w.words[0]))}:{div:this.divn(w.words[0]),mod:new e(this.modn(w.words[0]))}:this._wordDiv(w,C);var L,M,P},e.prototype.div=function(w){return this.divmod(w,"div",!1).div},e.prototype.mod=function(w){return this.divmod(w,"mod",!1).mod},e.prototype.umod=function(w){return this.divmod(w,"mod",!0).mod},e.prototype.divRound=function(w){var C=this.divmod(w);if(C.mod.isZero())return C.div;var k=C.div.negative!==0?C.mod.isub(w):C.mod,L=w.ushrn(1),M=w.andln(1),P=k.cmp(L);return P<0||M===1&&P===0?C.div:C.div.negative!==0?C.div.isubn(1):C.div.iaddn(1)},e.prototype.modn=function(w){m(w<=67108863);for(var C=(1<<26)%w,k=0,L=this.length-1;L>=0;L--)k=(C*k+(0|this.words[L]))%w;return k},e.prototype.idivn=function(w){m(w<=67108863);for(var C=0,k=this.length-1;k>=0;k--){var L=(0|this.words[k])+67108864*C;this.words[k]=L/w|0,C=L%w}return this.strip()},e.prototype.divn=function(w){return this.clone().idivn(w)},e.prototype.egcd=function(w){m(w.negative===0),m(!w.isZero());var C=this,k=w.clone();C=C.negative!==0?C.umod(w):C.clone();for(var L=new e(1),M=new e(0),P=new e(0),D=new e(1),N=0;C.isEven()&&k.isEven();)C.iushrn(1),k.iushrn(1),++N;for(var U=k.clone(),q=C.clone();!C.isZero();){for(var X=0,K=1;(C.words[0]&K)==0&&X<26;++X,K<<=1);if(X>0)for(C.iushrn(X);X-- >0;)(L.isOdd()||M.isOdd())&&(L.iadd(U),M.isub(q)),L.iushrn(1),M.iushrn(1);for(var Z=0,H=1;(k.words[0]&H)==0&&Z<26;++Z,H<<=1);if(Z>0)for(k.iushrn(Z);Z-- >0;)(P.isOdd()||D.isOdd())&&(P.iadd(U),D.isub(q)),P.iushrn(1),D.iushrn(1);C.cmp(k)>=0?(C.isub(k),L.isub(P),M.isub(D)):(k.isub(C),P.isub(L),D.isub(M))}return{a:P,b:D,gcd:k.iushln(N)}},e.prototype._invmp=function(w){m(w.negative===0),m(!w.isZero());var C=this,k=w.clone();C=C.negative!==0?C.umod(w):C.clone();for(var L,M=new e(1),P=new e(0),D=k.clone();C.cmpn(1)>0&&k.cmpn(1)>0;){for(var N=0,U=1;(C.words[0]&U)==0&&N<26;++N,U<<=1);if(N>0)for(C.iushrn(N);N-- >0;)M.isOdd()&&M.iadd(D),M.iushrn(1);for(var q=0,X=1;(k.words[0]&X)==0&&q<26;++q,X<<=1);if(q>0)for(k.iushrn(q);q-- >0;)P.isOdd()&&P.iadd(D),P.iushrn(1);C.cmp(k)>=0?(C.isub(k),M.isub(P)):(k.isub(C),P.isub(M))}return(L=C.cmpn(1)===0?M:P).cmpn(0)<0&&L.iadd(w),L},e.prototype.gcd=function(w){if(this.isZero())return w.abs();if(w.isZero())return this.abs();var C=this.clone(),k=w.clone();C.negative=0,k.negative=0;for(var L=0;C.isEven()&&k.isEven();L++)C.iushrn(1),k.iushrn(1);for(;;){for(;C.isEven();)C.iushrn(1);for(;k.isEven();)k.iushrn(1);var M=C.cmp(k);if(M<0){var P=C;C=k,k=P}else if(M===0||k.cmpn(1)===0)break;C.isub(k)}return k.iushln(L)},e.prototype.invm=function(w){return this.egcd(w).a.umod(w)},e.prototype.isEven=function(){return(1&this.words[0])==0},e.prototype.isOdd=function(){return(1&this.words[0])==1},e.prototype.andln=function(w){return this.words[0]&w},e.prototype.bincn=function(w){m(typeof w=="number");var C=w%26,k=(w-C)/26,L=1<<C;if(this.length<=k)return this._expand(k+1),this.words[k]|=L,this;for(var M=L,P=k;M!==0&&P<this.length;P++){var D=0|this.words[P];M=(D+=M)>>>26,D&=67108863,this.words[P]=D}return M!==0&&(this.words[P]=M,this.length++),this},e.prototype.isZero=function(){return this.length===1&&this.words[0]===0},e.prototype.cmpn=function(w){var C,k=w<0;if(this.negative!==0&&!k)return-1;if(this.negative===0&&k)return 1;if(this.strip(),this.length>1)C=1;else{k&&(w=-w),m(w<=67108863,"Number is too big");var L=0|this.words[0];C=L===w?0:L<w?-1:1}return this.negative!==0?0|-C:C},e.prototype.cmp=function(w){if(this.negative!==0&&w.negative===0)return-1;if(this.negative===0&&w.negative!==0)return 1;var C=this.ucmp(w);return this.negative!==0?0|-C:C},e.prototype.ucmp=function(w){if(this.length>w.length)return 1;if(this.length<w.length)return-1;for(var C=0,k=this.length-1;k>=0;k--){var L=0|this.words[k],M=0|w.words[k];if(L!==M){L<M?C=-1:L>M&&(C=1);break}}return C},e.prototype.gtn=function(w){return this.cmpn(w)===1},e.prototype.gt=function(w){return this.cmp(w)===1},e.prototype.gten=function(w){return this.cmpn(w)>=0},e.prototype.gte=function(w){return this.cmp(w)>=0},e.prototype.ltn=function(w){return this.cmpn(w)===-1},e.prototype.lt=function(w){return this.cmp(w)===-1},e.prototype.lten=function(w){return this.cmpn(w)<=0},e.prototype.lte=function(w){return this.cmp(w)<=0},e.prototype.eqn=function(w){return this.cmpn(w)===0},e.prototype.eq=function(w){return this.cmp(w)===0},e.red=function(w){return new A(w)},e.prototype.toRed=function(w){return m(!this.red,"Already a number in reduction context"),m(this.negative===0,"red works only with positives"),w.convertTo(this)._forceRed(w)},e.prototype.fromRed=function(){return m(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},e.prototype._forceRed=function(w){return this.red=w,this},e.prototype.forceRed=function(w){return m(!this.red,"Already a number in reduction context"),this._forceRed(w)},e.prototype.redAdd=function(w){return m(this.red,"redAdd works only with red numbers"),this.red.add(this,w)},e.prototype.redIAdd=function(w){return m(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,w)},e.prototype.redSub=function(w){return m(this.red,"redSub works only with red numbers"),this.red.sub(this,w)},e.prototype.redISub=function(w){return m(this.red,"redISub works only with red numbers"),this.red.isub(this,w)},e.prototype.redShl=function(w){return m(this.red,"redShl works only with red numbers"),this.red.shl(this,w)},e.prototype.redMul=function(w){return m(this.red,"redMul works only with red numbers"),this.red._verify2(this,w),this.red.mul(this,w)},e.prototype.redIMul=function(w){return m(this.red,"redMul works only with red numbers"),this.red._verify2(this,w),this.red.imul(this,w)},e.prototype.redSqr=function(){return m(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},e.prototype.redISqr=function(){return m(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},e.prototype.redSqrt=function(){return m(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},e.prototype.redInvm=function(){return m(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},e.prototype.redNeg=function(){return m(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},e.prototype.redPow=function(w){return m(this.red&&!w.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,w)};var h={k256:null,p224:null,p192:null,p25519:null};function y(w,C){this.name=w,this.p=new e(C,16),this.n=this.p.bitLength(),this.k=new e(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){y.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function _(){y.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function x(){y.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function T(){y.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function A(w){if(typeof w=="string"){var C=e._prime(w);this.m=C.p,this.prime=C}else m(w.gtn(1),"modulus must be greater than 1"),this.m=w,this.prime=null}function S(w){A.call(this,w),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new e(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}y.prototype._tmp=function(){var w=new e(null);return w.words=new Array(Math.ceil(this.n/13)),w},y.prototype.ireduce=function(w){var C,k=w;do this.split(k,this.tmp),C=(k=(k=this.imulK(k)).iadd(this.tmp)).bitLength();while(C>this.n);var L=C<this.n?-1:k.ucmp(this.p);return L===0?(k.words[0]=0,k.length=1):L>0?k.isub(this.p):k.strip(),k},y.prototype.split=function(w,C){w.iushrn(this.n,0,C)},y.prototype.imulK=function(w){return w.imul(this.k)},p(v,y),v.prototype.split=function(w,C){for(var k=Math.min(w.length,9),L=0;L<k;L++)C.words[L]=w.words[L];if(C.length=k,w.length<=9)return w.words[0]=0,void(w.length=1);var M=w.words[9];for(C.words[C.length++]=4194303&M,L=10;L<w.length;L++){var P=0|w.words[L];w.words[L-10]=(4194303&P)<<4|M>>>22,M=P}M>>>=22,w.words[L-10]=M,M===0&&w.length>10?w.length-=10:w.length-=9},v.prototype.imulK=function(w){w.words[w.length]=0,w.words[w.length+1]=0,w.length+=2;for(var C=0,k=0;k<w.length;k++){var L=0|w.words[k];C+=977*L,w.words[k]=67108863&C,C=64*L+(C/67108864|0)}return w.words[w.length-1]===0&&(w.length--,w.words[w.length-1]===0&&w.length--),w},p(_,y),p(x,y),p(T,y),T.prototype.imulK=function(w){for(var C=0,k=0;k<w.length;k++){var L=19*(0|w.words[k])+C,M=67108863&L;L>>>=26,w.words[k]=M,C=L}return C!==0&&(w.words[w.length++]=C),w},e._prime=function(w){if(h[w])return h[w];var C;if(w==="k256")C=new v;else if(w==="p224")C=new _;else if(w==="p192")C=new x;else{if(w!=="p25519")throw new Error("Unknown prime "+w);C=new T}return h[w]=C,C},A.prototype._verify1=function(w){m(w.negative===0,"red works only with positives"),m(w.red,"red works only with red numbers")},A.prototype._verify2=function(w,C){m((w.negative|C.negative)==0,"red works only with positives"),m(w.red&&w.red===C.red,"red works only with red numbers")},A.prototype.imod=function(w){return this.prime?this.prime.ireduce(w)._forceRed(this):w.umod(this.m)._forceRed(this)},A.prototype.neg=function(w){return w.isZero()?w.clone():this.m.sub(w)._forceRed(this)},A.prototype.add=function(w,C){this._verify2(w,C);var k=w.add(C);return k.cmp(this.m)>=0&&k.isub(this.m),k._forceRed(this)},A.prototype.iadd=function(w,C){this._verify2(w,C);var k=w.iadd(C);return k.cmp(this.m)>=0&&k.isub(this.m),k},A.prototype.sub=function(w,C){this._verify2(w,C);var k=w.sub(C);return k.cmpn(0)<0&&k.iadd(this.m),k._forceRed(this)},A.prototype.isub=function(w,C){this._verify2(w,C);var k=w.isub(C);return k.cmpn(0)<0&&k.iadd(this.m),k},A.prototype.shl=function(w,C){return this._verify1(w),this.imod(w.ushln(C))},A.prototype.imul=function(w,C){return this._verify2(w,C),this.imod(w.imul(C))},A.prototype.mul=function(w,C){return this._verify2(w,C),this.imod(w.mul(C))},A.prototype.isqr=function(w){return this.imul(w,w.clone())},A.prototype.sqr=function(w){return this.mul(w,w)},A.prototype.sqrt=function(w){if(w.isZero())return w.clone();var C=this.m.andln(3);if(m(C%2==1),C===3){var k=this.m.add(new e(1)).iushrn(2);return this.pow(w,k)}for(var L=this.m.subn(1),M=0;!L.isZero()&&L.andln(1)===0;)M++,L.iushrn(1);m(!L.isZero());var P=new e(1).toRed(this),D=P.redNeg(),N=this.m.subn(1).iushrn(1),U=this.m.bitLength();for(U=new e(2*U*U).toRed(this);this.pow(U,N).cmp(D)!==0;)U.redIAdd(D);for(var q=this.pow(U,L),X=this.pow(w,L.addn(1).iushrn(1)),K=this.pow(w,L),Z=M;K.cmp(P)!==0;){for(var H=K,Y=0;H.cmp(P)!==0;Y++)H=H.redSqr();m(Y<Z);var $=this.pow(q,new e(1).iushln(Z-Y-1));X=X.redMul($),q=$.redSqr(),K=K.redMul(q),Z=Y}return X},A.prototype.invm=function(w){var C=w._invmp(this.m);return C.negative!==0?(C.negative=0,this.imod(C).redNeg()):this.imod(C)},A.prototype.pow=function(w,C){if(C.isZero())return new e(1).toRed(this);if(C.cmpn(1)===0)return w.clone();var k=new Array(16);k[0]=new e(1).toRed(this),k[1]=w;for(var L=2;L<k.length;L++)k[L]=this.mul(k[L-1],w);var M=k[0],P=0,D=0,N=C.bitLength()%26;for(N===0&&(N=26),L=C.length-1;L>=0;L--){for(var U=C.words[L],q=N-1;q>=0;q--){var X=U>>q&1;M!==k[0]&&(M=this.sqr(M)),X!==0||P!==0?(P<<=1,P|=X,(++D==4||L===0&&q===0)&&(M=this.mul(M,k[P]),D=0,P=0)):D=0}N=26}return M},A.prototype.convertTo=function(w){var C=w.umod(this.m);return C===w?C.clone():C},A.prototype.convertFrom=function(w){var C=w.clone();return C.red=null,C},e.mont=function(w){return new S(w)},p(S,A),S.prototype.convertTo=function(w){return this.imod(w.ushln(this.shift))},S.prototype.convertFrom=function(w){var C=this.imod(w.mul(this.rinv));return C.red=null,C},S.prototype.imul=function(w,C){if(w.isZero()||C.isZero())return w.words[0]=0,w.length=1,w;var k=w.imul(C),L=k.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),M=k.isub(L).iushrn(this.shift),P=M;return M.cmp(this.m)>=0?P=M.isub(this.m):M.cmpn(0)<0&&(P=M.iadd(this.m)),P._forceRed(this)},S.prototype.mul=function(w,C){if(w.isZero()||C.isZero())return new e(0)._forceRed(this);var k=w.mul(C),L=k.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),M=k.isub(L).iushrn(this.shift),P=M;return M.cmp(this.m)>=0?P=M.isub(this.m):M.cmpn(0)<0&&(P=M.iadd(this.m)),P._forceRed(this)},S.prototype.invm=function(w){return this.imod(w._invmp(this.m).mul(this.r2))._forceRed(this)}})(O===void 0||O,this)},{buffer:115}],107:[function(r,O,B){O.exports=function(t){var d,m,p,e=t.length,f=0;for(d=0;d<e;++d)f+=t[d].length;var u=new Array(f),s=0;for(d=0;d<e;++d){var l=t[d],o=l.length;for(m=0;m<o;++m){var i=u[s++]=new Array(o-1),c=0;for(p=0;p<o;++p)p!==m&&(i[c++]=l[p]);if(1&m){var n=i[1];i[1]=i[0],i[0]=n}}}return u}},{}],108:[function(r,O,B){O.exports=function(i,c,n){switch(arguments.length){case 1:return l(i);case 2:return typeof c=="function"?u(i,i,c,!0):o(i,c);case 3:return u(i,c,n,!1);default:throw new Error("box-intersect: Invalid arguments")}};var t,d=r("typedarray-pool"),m=r("./lib/sweep"),p=r("./lib/intersect");function e(i,c){for(var n=0;n<i;++n)if(!(c[n]<=c[n+i]))return!0;return!1}function f(i,c,n,a){for(var g=0,h=0,y=0,v=i.length;y<v;++y){var _=i[y];if(!e(c,_)){for(var x=0;x<2*c;++x)n[g++]=_[x];a[h++]=y}}return h}function u(i,c,n,a){var g=i.length,h=c.length;if(!(g<=0||h<=0)){var y=i[0].length>>>1;if(!(y<=0)){var v,_=d.mallocDouble(2*y*g),x=d.mallocInt32(g);if((g=f(i,y,_,x))>0){if(y===1&&a)m.init(g),v=m.sweepComplete(y,n,0,g,_,x,0,g,_,x);else{var T=d.mallocDouble(2*y*h),A=d.mallocInt32(h);(h=f(c,y,T,A))>0&&(m.init(g+h),v=y===1?m.sweepBipartite(y,n,0,g,_,x,0,h,T,A):p(y,n,a,g,_,x,h,T,A),d.free(T),d.free(A))}d.free(_),d.free(x)}return v}}}function s(i,c){t.push([i,c])}function l(i){return t=[],u(i,i,s,!0),t}function o(i,c){return t=[],u(i,c,s,!1),t}},{"./lib/intersect":110,"./lib/sweep":114,"typedarray-pool":601}],109:[function(r,O,B){function t(d){return d?function(m,p,e,f,u,s,l,o,i,c,n){return u-f>i-o?function(a,g,h,y,v,_,x,T,A,S,w){for(var C=2*a,k=y,L=C*y;k<v;++k,L+=C){var M=_[g+L],P=_[g+L+a],D=x[k];e:for(var N=T,U=C*T;N<A;++N,U+=C){var q=S[g+U],X=S[g+U+a],K=w[N];if(!(X<M||P<q)){for(var Z=g+1;Z<a;++Z){var H=_[Z+L],Y=_[Z+a+L],$=S[Z+U],z=S[Z+a+U];if(Y<$||z<H)continue e}var j=h(D,K);if(j!==void 0)return j}}}}(m,p,e,f,u,s,l,o,i,c,n):function(a,g,h,y,v,_,x,T,A,S,w){for(var C=2*a,k=T,L=C*T;k<A;++k,L+=C){var M=S[g+L],P=S[g+L+a],D=w[k];e:for(var N=y,U=C*y;N<v;++N,U+=C){var q=_[g+U],X=_[g+U+a],K=x[N];if(!(P<q||X<M)){for(var Z=g+1;Z<a;++Z){var H=_[Z+U],Y=_[Z+a+U],$=S[Z+L],z=S[Z+a+L];if(Y<$||z<H)continue e}var j=h(K,D);if(j!==void 0)return j}}}}(m,p,e,f,u,s,l,o,i,c,n)}:function(m,p,e,f,u,s,l,o,i,c,n,a){return s-u>c-i?f?function(g,h,y,v,_,x,T,A,S,w,C){for(var k=2*g,L=v,M=k*v;L<_;++L,M+=k){var P=x[h+M],D=x[h+M+g],N=T[L];e:for(var U=A,q=k*A;U<S;++U,q+=k){var X=w[h+q],K=C[U];if(!(X<=P||D<X)){for(var Z=h+1;Z<g;++Z){var H=x[Z+M],Y=x[Z+g+M],$=w[Z+q],z=w[Z+g+q];if(Y<$||z<H)continue e}var j=y(K,N);if(j!==void 0)return j}}}}(m,p,e,u,s,l,o,i,c,n,a):function(g,h,y,v,_,x,T,A,S,w,C){for(var k=2*g,L=v,M=k*v;L<_;++L,M+=k){var P=x[h+M],D=x[h+M+g],N=T[L];e:for(var U=A,q=k*A;U<S;++U,q+=k){var X=w[h+q],K=C[U];if(!(X<P||D<X)){for(var Z=h+1;Z<g;++Z){var H=x[Z+M],Y=x[Z+g+M],$=w[Z+q],z=w[Z+g+q];if(Y<$||z<H)continue e}var j=y(N,K);if(j!==void 0)return j}}}}(m,p,e,u,s,l,o,i,c,n,a):f?function(g,h,y,v,_,x,T,A,S,w,C){for(var k=2*g,L=A,M=k*A;L<S;++L,M+=k){var P=w[h+M],D=C[L];e:for(var N=v,U=k*v;N<_;++N,U+=k){var q=x[h+U],X=x[h+U+g],K=T[N];if(!(P<=q||X<P)){for(var Z=h+1;Z<g;++Z){var H=x[Z+U],Y=x[Z+g+U],$=w[Z+M],z=w[Z+g+M];if(Y<$||z<H)continue e}var j=y(D,K);if(j!==void 0)return j}}}}(m,p,e,u,s,l,o,i,c,n,a):function(g,h,y,v,_,x,T,A,S,w,C){for(var k=2*g,L=A,M=k*A;L<S;++L,M+=k){var P=w[h+M],D=C[L];e:for(var N=v,U=k*v;N<_;++N,U+=k){var q=x[h+U],X=x[h+U+g],K=T[N];if(!(P<q||X<P)){for(var Z=h+1;Z<g;++Z){var H=x[Z+U],Y=x[Z+g+U],$=w[Z+M],z=w[Z+g+M];if(Y<$||z<H)continue e}var j=y(K,D);if(j!==void 0)return j}}}}(m,p,e,u,s,l,o,i,c,n,a)}}B.partial=t(!1),B.full=t(!0)},{}],110:[function(r,O,B){O.exports=function(x,T,A,S,w,C,k,L,M){(function(be,xe){var ce=8*d.log2(xe+1)*(be+1)|0,ge=d.nextPow2(6*ce);g.length<ge&&(t.free(g),g=t.mallocInt32(ge));var we=d.nextPow2(2*ce);h.length<we&&(t.free(h),h=t.mallocDouble(we))})(x,S+k);var P,D=0,N=2*x;for(y(D++,0,0,S,0,k,A?16:0,-1/0,1/0),A||y(D++,0,0,k,0,S,1,-1/0,1/0);D>0;){var U=6*(D-=1),q=g[U],X=g[U+1],K=g[U+2],Z=g[U+3],H=g[U+4],Y=g[U+5],$=2*D,z=h[$],j=h[$+1],W=1&Y,ee=!!(16&Y),J=w,Q=C,te=L,ie=M;if(W&&(J=L,Q=M,te=w,ie=C),!(2&Y&&(K=i(x,q,X,K,J,Q,j),X>=K)||4&Y&&(X=c(x,q,X,K,J,Q,z))>=K)){var ae=K-X,he=H-Z;if(ee){if(x*ae*(ae+he)<1<<22){if((P=f.scanComplete(x,q,T,X,K,J,Q,Z,H,te,ie))!==void 0)return P;continue}}else{if(x*Math.min(ae,he)<128){if((P=p(x,q,T,W,X,K,J,Q,Z,H,te,ie))!==void 0)return P;continue}if(x*ae*he<1<<22){if((P=f.scanBipartite(x,q,T,W,X,K,J,Q,Z,H,te,ie))!==void 0)return P;continue}}var se=l(x,q,X,K,J,Q,z,j);if(X<se)if(x*(se-X)<128){if((P=e(x,q+1,T,X,se,J,Q,Z,H,te,ie))!==void 0)return P}else if(q===x-2){if((P=W?f.sweepBipartite(x,T,Z,H,te,ie,X,se,J,Q):f.sweepBipartite(x,T,X,se,J,Q,Z,H,te,ie))!==void 0)return P}else y(D++,q+1,X,se,Z,H,W,-1/0,1/0),y(D++,q+1,Z,H,X,se,1^W,-1/0,1/0);if(se<K){var de=u(x,q,Z,H,te,ie),ue=te[N*de+q],ve=o(x,q,de,H,te,ie,ue);if(ve<H&&y(D++,q,se,K,ve,H,(4|W)+(ee?16:0),ue,j),Z<de&&y(D++,q,se,K,Z,de,(2|W)+(ee?16:0),z,ue),de+1===ve){if((P=ee?_(x,q,T,se,K,J,Q,de,te,ie[de]):v(x,q,T,W,se,K,J,Q,de,te,ie[de]))!==void 0)return P}else if(de<ve){var ke;if(ee){if(ke=n(x,q,se,K,J,Q,ue),se<ke){var Ee=o(x,q,se,ke,J,Q,ue);if(q===x-2){if(se<Ee&&(P=f.sweepComplete(x,T,se,Ee,J,Q,de,ve,te,ie))!==void 0||Ee<ke&&(P=f.sweepBipartite(x,T,Ee,ke,J,Q,de,ve,te,ie))!==void 0)return P}else se<Ee&&y(D++,q+1,se,Ee,de,ve,16,-1/0,1/0),Ee<ke&&(y(D++,q+1,Ee,ke,de,ve,0,-1/0,1/0),y(D++,q+1,de,ve,Ee,ke,1,-1/0,1/0))}}else ke=W?a(x,q,se,K,J,Q,ue):n(x,q,se,K,J,Q,ue),se<ke&&(q===x-2?P=W?f.sweepBipartite(x,T,de,ve,te,ie,se,ke,J,Q):f.sweepBipartite(x,T,se,ke,J,Q,de,ve,te,ie):(y(D++,q+1,se,ke,de,ve,W,-1/0,1/0),y(D++,q+1,de,ve,se,ke,1^W,-1/0,1/0)))}}}}};var t=r("typedarray-pool"),d=r("bit-twiddle"),m=r("./brute"),p=m.partial,e=m.full,f=r("./sweep"),u=r("./median"),s=r("./partition"),l=s("!(lo>=p0)&&!(p1>=hi)"),o=s("lo===p0"),i=s("lo<p0"),c=s("hi<=p0"),n=s("lo<=p0&&p0<=hi"),a=s("lo<p0&&p0<=hi"),g=t.mallocInt32(1024),h=t.mallocDouble(1024);function y(x,T,A,S,w,C,k,L,M){var P=6*x;g[P]=T,g[P+1]=A,g[P+2]=S,g[P+3]=w,g[P+4]=C,g[P+5]=k;var D=2*x;h[D]=L,h[D+1]=M}function v(x,T,A,S,w,C,k,L,M,P,D){var N=2*x,U=M*N,q=P[U+T];e:for(var X=w,K=w*N;X<C;++X,K+=N){var Z=k[K+T],H=k[K+T+x];if(!(q<Z||H<q)&&(!S||q!==Z)){for(var Y,$=L[X],z=T+1;z<x;++z){Z=k[K+z],H=k[K+z+x];var j=P[U+z],W=P[U+z+x];if(H<j||W<Z)continue e}if((Y=S?A(D,$):A($,D))!==void 0)return Y}}}function _(x,T,A,S,w,C,k,L,M,P){var D=2*x,N=L*D,U=M[N+T];e:for(var q=S,X=S*D;q<w;++q,X+=D){var K=k[q];if(K!==P){var Z=C[X+T],H=C[X+T+x];if(!(U<Z||H<U)){for(var Y=T+1;Y<x;++Y){Z=C[X+Y],H=C[X+Y+x];var $=M[N+Y],z=M[N+Y+x];if(H<$||z<Z)continue e}var j=A(K,P);if(j!==void 0)return j}}}}},{"./brute":109,"./median":111,"./partition":112,"./sweep":114,"bit-twiddle":104,"typedarray-pool":601}],111:[function(r,O,B){O.exports=function(m,p,e,f,u,s){if(f<=e+1)return e;for(var l=e,o=f,i=f+e>>>1,c=2*m,n=i,a=u[c*i+p];l<o;){if(o-l<8){d(m,p,l,o,u,s),a=u[c*i+p];break}var g=o-l,h=Math.random()*g+l|0,y=u[c*h+p],v=Math.random()*g+l|0,_=u[c*v+p],x=Math.random()*g+l|0,T=u[c*x+p];y<=_?T>=_?(n=v,a=_):y>=T?(n=h,a=y):(n=x,a=T):_>=T?(n=v,a=_):T>=y?(n=h,a=y):(n=x,a=T);for(var A=c*(o-1),S=c*n,w=0;w<c;++w,++A,++S){var C=u[A];u[A]=u[S],u[S]=C}var k=s[o-1];for(s[o-1]=s[n],s[n]=k,n=t(m,p,l,o-1,u,s,a),A=c*(o-1),S=c*n,w=0;w<c;++w,++A,++S)C=u[A],u[A]=u[S],u[S]=C;if(k=s[o-1],s[o-1]=s[n],s[n]=k,i<n){for(o=n-1;l<o&&u[c*(o-1)+p]===a;)o-=1;o+=1}else{if(!(n<i))break;for(l=n+1;l<o&&u[c*l+p]===a;)l+=1}}return t(m,p,e,i,u,s,u[c*i+p])};var t=r("./partition")("lo<p0");function d(m,p,e,f,u,s){for(var l=2*m,o=l*(e+1)+p,i=e+1;i<f;++i,o+=l)for(var c=u[o],n=i,a=l*(i-1);n>e&&u[a+p]>c;--n,a-=l){for(var g=a,h=a+l,y=0;y<l;++y,++g,++h){var v=u[g];u[g]=u[h],u[h]=v}var _=s[n];s[n]=s[n-1],s[n-1]=_}}},{"./partition":112}],112:[function(r,O,B){O.exports=function(d){return t[d]};var t={"lo===p0":function(d,m,p,e,f,u,s){for(var l=2*d,o=l*p,i=o,c=p,n=m,a=p;e>a;++a,o+=l)if(f[o+n]===s)if(c===a)c+=1,i+=l;else{for(var g=0;l>g;++g){var h=f[o+g];f[o+g]=f[i],f[i++]=h}var y=u[a];u[a]=u[c],u[c++]=y}return c},"lo<p0":function(d,m,p,e,f,u,s){for(var l=2*d,o=l*p,i=o,c=p,n=m,a=p;e>a;++a,o+=l)if(f[o+n]<s)if(c===a)c+=1,i+=l;else{for(var g=0;l>g;++g){var h=f[o+g];f[o+g]=f[i],f[i++]=h}var y=u[a];u[a]=u[c],u[c++]=y}return c},"lo<=p0":function(d,m,p,e,f,u,s){for(var l=2*d,o=l*p,i=o,c=p,n=d+m,a=p;e>a;++a,o+=l)if(f[o+n]<=s)if(c===a)c+=1,i+=l;else{for(var g=0;l>g;++g){var h=f[o+g];f[o+g]=f[i],f[i++]=h}var y=u[a];u[a]=u[c],u[c++]=y}return c},"hi<=p0":function(d,m,p,e,f,u,s){for(var l=2*d,o=l*p,i=o,c=p,n=d+m,a=p;e>a;++a,o+=l)if(f[o+n]<=s)if(c===a)c+=1,i+=l;else{for(var g=0;l>g;++g){var h=f[o+g];f[o+g]=f[i],f[i++]=h}var y=u[a];u[a]=u[c],u[c++]=y}return c},"lo<p0&&p0<=hi":function(d,m,p,e,f,u,s){for(var l=2*d,o=l*p,i=o,c=p,n=m,a=d+m,g=p;e>g;++g,o+=l){var h=f[o+n],y=f[o+a];if(h<s&&s<=y)if(c===g)c+=1,i+=l;else{for(var v=0;l>v;++v){var _=f[o+v];f[o+v]=f[i],f[i++]=_}var x=u[g];u[g]=u[c],u[c++]=x}}return c},"lo<=p0&&p0<=hi":function(d,m,p,e,f,u,s){for(var l=2*d,o=l*p,i=o,c=p,n=m,a=d+m,g=p;e>g;++g,o+=l){var h=f[o+n],y=f[o+a];if(h<=s&&s<=y)if(c===g)c+=1,i+=l;else{for(var v=0;l>v;++v){var _=f[o+v];f[o+v]=f[i],f[i++]=_}var x=u[g];u[g]=u[c],u[c++]=x}}return c},"!(lo>=p0)&&!(p1>=hi)":function(d,m,p,e,f,u,s,l){for(var o=2*d,i=o*p,c=i,n=p,a=m,g=d+m,h=p;e>h;++h,i+=o){var y=f[i+a],v=f[i+g];if(!(y>=s||l>=v))if(n===h)n+=1,c+=o;else{for(var _=0;o>_;++_){var x=f[i+_];f[i+_]=f[c],f[c++]=x}var T=u[h];u[h]=u[n],u[n++]=T}}return n}}},{}],113:[function(r,O,B){O.exports=function(s,l){l<=128?t(0,l-1,s):function o(i,c,n){var a=(c-i+1)/6|0,g=i+a,h=c-a,y=i+c>>1,v=y-a,_=y+a,x=g,T=v,A=y,S=_,w=h,C=i+1,k=c-1,L=0;f(x,T,n)&&(L=x,x=T,T=L),f(S,w,n)&&(L=S,S=w,w=L),f(x,A,n)&&(L=x,x=A,A=L),f(T,A,n)&&(L=T,T=A,A=L),f(x,S,n)&&(L=x,x=S,S=L),f(A,S,n)&&(L=A,A=S,S=L),f(T,w,n)&&(L=T,T=w,w=L),f(T,A,n)&&(L=T,T=A,A=L),f(S,w,n)&&(L=S,S=w,w=L);for(var M=n[2*T],P=n[2*T+1],D=n[2*S],N=n[2*S+1],U=2*x,q=2*A,X=2*w,K=2*g,Z=2*y,H=2*h,Y=0;Y<2;++Y){var $=n[U+Y],z=n[q+Y],j=n[X+Y];n[K+Y]=$,n[Z+Y]=z,n[H+Y]=j}m(v,i,n),m(_,c,n);for(var W=C;W<=k;++W)if(u(W,M,P,n))W!==C&&d(W,C,n),++C;else if(!u(W,D,N,n))for(;;){if(u(k,D,N,n)){u(k,M,P,n)?(p(W,C,k,n),++C,--k):(d(W,k,n),--k);break}if(--k<W)break}e(i,C-1,M,P,n),e(c,k+1,D,N,n),C-2-i<=32?t(i,C-2,n):o(i,C-2,n),c-(k+2)<=32?t(k+2,c,n):o(k+2,c,n),k-C<=32?t(C,k,n):o(C,k,n)}(0,l-1,s)};function t(s,l,o){for(var i=2*(s+1),c=s+1;c<=l;++c){for(var n=o[i++],a=o[i++],g=c,h=i-2;g-- >s;){var y=o[h-2],v=o[h-1];if(y<n||y===n&&v<a)break;o[h]=y,o[h+1]=v,h-=2}o[h]=n,o[h+1]=a}}function d(s,l,o){l*=2;var i=o[s*=2],c=o[s+1];o[s]=o[l],o[s+1]=o[l+1],o[l]=i,o[l+1]=c}function m(s,l,o){l*=2,o[s*=2]=o[l],o[s+1]=o[l+1]}function p(s,l,o,i){l*=2,o*=2;var c=i[s*=2],n=i[s+1];i[s]=i[l],i[s+1]=i[l+1],i[l]=i[o],i[l+1]=i[o+1],i[o]=c,i[o+1]=n}function e(s,l,o,i,c){l*=2,c[s*=2]=c[l],c[l]=o,c[s+1]=c[l+1],c[l+1]=i}function f(s,l,o){l*=2;var i=o[s*=2],c=o[l];return!(i<c)&&(i!==c||o[s+1]>o[l+1])}function u(s,l,o,i){var c=i[s*=2];return c<l||c===l&&i[s+1]<o}},{}],114:[function(r,O,B){O.exports={init:function(n){var a=d.nextPow2(n);p.length<a&&(t.free(p),p=t.mallocInt32(a)),e.length<a&&(t.free(e),e=t.mallocInt32(a)),f.length<a&&(t.free(f),f=t.mallocInt32(a)),u.length<a&&(t.free(u),u=t.mallocInt32(a)),s.length<a&&(t.free(s),s=t.mallocInt32(a)),l.length<a&&(t.free(l),l=t.mallocInt32(a));var g=8*a;o.length<g&&(t.free(o),o=t.mallocDouble(g))},sweepBipartite:function(n,a,g,h,y,v,_,x,T,A){for(var S=0,w=2*n,C=n-1,k=w-1,L=g;L<h;++L){var M=v[L],P=w*L;o[S++]=y[P+C],o[S++]=-(M+1),o[S++]=y[P+k],o[S++]=M}for(L=_;L<x;++L){M=A[L]+(1<<28);var D=w*L;o[S++]=T[D+C],o[S++]=-M,o[S++]=T[D+k],o[S++]=M}var N=S>>>1;m(o,N);var U=0,q=0;for(L=0;L<N;++L){var X=0|o[2*L+1];if(X>=1<<28)i(f,u,q--,X=X-(1<<28)|0);else if(X>=0)i(p,e,U--,X);else if(X<=-(1<<28)){X=-X-(1<<28)|0;for(var K=0;K<U;++K)if((Z=a(p[K],X))!==void 0)return Z;c(f,u,q++,X)}else{for(X=-X-1|0,K=0;K<q;++K){var Z;if((Z=a(X,f[K]))!==void 0)return Z}c(p,e,U++,X)}}},sweepComplete:function(n,a,g,h,y,v,_,x,T,A){for(var S=0,w=2*n,C=n-1,k=w-1,L=g;L<h;++L){var M=v[L]+1<<1,P=w*L;o[S++]=y[P+C],o[S++]=-M,o[S++]=y[P+k],o[S++]=M}for(L=_;L<x;++L){M=A[L]+1<<1;var D=w*L;o[S++]=T[D+C],o[S++]=1|-M,o[S++]=T[D+k],o[S++]=1|M}var N=S>>>1;m(o,N);var U=0,q=0,X=0;for(L=0;L<N;++L){var K=0|o[2*L+1],Z=1&K;if(L<N-1&&K>>1==o[2*L+3]>>1&&(Z=2,L+=1),K<0){for(var H=-(K>>1)-1,Y=0;Y<X;++Y)if(($=a(s[Y],H))!==void 0)return $;if(Z!==0){for(Y=0;Y<U;++Y)if(($=a(p[Y],H))!==void 0)return $}if(Z!==1)for(Y=0;Y<q;++Y){var $;if(($=a(f[Y],H))!==void 0)return $}Z===0?c(p,e,U++,H):Z===1?c(f,u,q++,H):Z===2&&c(s,l,X++,H)}else H=(K>>1)-1,Z===0?i(p,e,U--,H):Z===1?i(f,u,q--,H):Z===2&&i(s,l,X--,H)}},scanBipartite:function(n,a,g,h,y,v,_,x,T,A,S,w){var C=0,k=2*n,L=a,M=a+n,P=1,D=1;h?D=1<<28:P=1<<28;for(var N=y;N<v;++N){var U=N+P,q=k*N;o[C++]=_[q+L],o[C++]=-U,o[C++]=_[q+M],o[C++]=U}for(N=T;N<A;++N){U=N+D;var X=k*N;o[C++]=S[X+L],o[C++]=-U}var K=C>>>1;m(o,K);var Z=0;for(N=0;N<K;++N){var H=0|o[2*N+1];if(H<0){var Y=!1;if((U=-H)>=1<<28?(Y=!h,U-=1<<28):(Y=!!h,U-=1),Y)c(p,e,Z++,U);else{var $=w[U],z=k*U,j=S[z+a+1],W=S[z+a+1+n];e:for(var ee=0;ee<Z;++ee){var J=p[ee],Q=k*J;if(!(W<_[Q+a+1]||_[Q+a+1+n]<j)){for(var te=a+2;te<n;++te)if(S[z+te+n]<_[Q+te]||_[Q+te+n]<S[z+te])continue e;var ie,ae=x[J];if((ie=h?g($,ae):g(ae,$))!==void 0)return ie}}}}else i(p,e,Z--,H-P)}},scanComplete:function(n,a,g,h,y,v,_,x,T,A,S){for(var w=0,C=2*n,k=a,L=a+n,M=h;M<y;++M){var P=M+(1<<28),D=C*M;o[w++]=v[D+k],o[w++]=-P,o[w++]=v[D+L],o[w++]=P}for(M=x;M<T;++M){P=M+1;var N=C*M;o[w++]=A[N+k],o[w++]=-P}var U=w>>>1;m(o,U);var q=0;for(M=0;M<U;++M){var X=0|o[2*M+1];if(X<0)if((P=-X)>=1<<28)p[q++]=P-(1<<28);else{var K=S[P-=1],Z=C*P,H=A[Z+a+1],Y=A[Z+a+1+n];e:for(var $=0;$<q;++$){var z=p[$],j=_[z];if(j===K)break;var W=C*z;if(!(Y<v[W+a+1]||v[W+a+1+n]<H)){for(var ee=a+2;ee<n;++ee)if(A[Z+ee+n]<v[W+ee]||v[W+ee+n]<A[Z+ee])continue e;var J=g(j,K);if(J!==void 0)return J}}}else{for(P=X-(1<<28),$=q-1;$>=0;--$)if(p[$]===P){for(ee=$+1;ee<q;++ee)p[ee-1]=p[ee];break}--q}}}};var t=r("typedarray-pool"),d=r("bit-twiddle"),m=r("./sort"),p=t.mallocInt32(1024),e=t.mallocInt32(1024),f=t.mallocInt32(1024),u=t.mallocInt32(1024),s=t.mallocInt32(1024),l=t.mallocInt32(1024),o=t.mallocDouble(8192);function i(n,a,g,h){var y=a[h],v=n[g-1];n[y]=v,a[v]=y}function c(n,a,g,h){n[g]=h,a[h]=g}},{"./sort":113,"bit-twiddle":104,"typedarray-pool":601}],115:[function(r,O,B){},{}],116:[function(r,O,B){var t,d=typeof Reflect=="object"?Reflect:null,m=d&&typeof d.apply=="function"?d.apply:function(g,h,y){return Function.prototype.apply.call(g,h,y)};t=d&&typeof d.ownKeys=="function"?d.ownKeys:Object.getOwnPropertySymbols?function(g){return Object.getOwnPropertyNames(g).concat(Object.getOwnPropertySymbols(g))}:function(g){return Object.getOwnPropertyNames(g)};var p=Number.isNaN||function(g){return g!=g};function e(){e.init.call(this)}O.exports=e,O.exports.once=function(g,h){return new Promise(function(y,v){function _(){x!==void 0&&g.removeListener("error",x),y([].slice.call(arguments))}var x;h!=="error"&&(x=function(T){g.removeListener(h,_),v(T)},g.once("error",x)),g.once(h,_)})},e.EventEmitter=e,e.prototype._events=void 0,e.prototype._eventsCount=0,e.prototype._maxListeners=void 0;var f=10;function u(g){if(typeof g!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof g)}function s(g){return g._maxListeners===void 0?e.defaultMaxListeners:g._maxListeners}function l(g,h,y,v){var _,x,T,A;if(u(y),(x=g._events)===void 0?(x=g._events=Object.create(null),g._eventsCount=0):(x.newListener!==void 0&&(g.emit("newListener",h,y.listener?y.listener:y),x=g._events),T=x[h]),T===void 0)T=x[h]=y,++g._eventsCount;else if(typeof T=="function"?T=x[h]=v?[y,T]:[T,y]:v?T.unshift(y):T.push(y),(_=s(g))>0&&T.length>_&&!T.warned){T.warned=!0;var S=new Error("Possible EventEmitter memory leak detected. "+T.length+" "+String(h)+" listeners added. Use emitter.setMaxListeners() to increase limit");S.name="MaxListenersExceededWarning",S.emitter=g,S.type=h,S.count=T.length,A=S,console&&console.warn&&console.warn(A)}return g}function o(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function i(g,h,y){var v={fired:!1,wrapFn:void 0,target:g,type:h,listener:y},_=o.bind(v);return _.listener=y,v.wrapFn=_,_}function c(g,h,y){var v=g._events;if(v===void 0)return[];var _=v[h];return _===void 0?[]:typeof _=="function"?y?[_.listener||_]:[_]:y?function(x){for(var T=new Array(x.length),A=0;A<T.length;++A)T[A]=x[A].listener||x[A];return T}(_):a(_,_.length)}function n(g){var h=this._events;if(h!==void 0){var y=h[g];if(typeof y=="function")return 1;if(y!==void 0)return y.length}return 0}function a(g,h){for(var y=new Array(h),v=0;v<h;++v)y[v]=g[v];return y}Object.defineProperty(e,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(g){if(typeof g!="number"||g<0||p(g))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+g+".");f=g}}),e.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},e.prototype.setMaxListeners=function(g){if(typeof g!="number"||g<0||p(g))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+g+".");return this._maxListeners=g,this},e.prototype.getMaxListeners=function(){return s(this)},e.prototype.emit=function(g){for(var h=[],y=1;y<arguments.length;y++)h.push(arguments[y]);var v=g==="error",_=this._events;if(_!==void 0)v=v&&_.error===void 0;else if(!v)return!1;if(v){var x;if(h.length>0&&(x=h[0]),x instanceof Error)throw x;var T=new Error("Unhandled error."+(x?" ("+x.message+")":""));throw T.context=x,T}var A=_[g];if(A===void 0)return!1;if(typeof A=="function")m(A,this,h);else{var S=A.length,w=a(A,S);for(y=0;y<S;++y)m(w[y],this,h)}return!0},e.prototype.addListener=function(g,h){return l(this,g,h,!1)},e.prototype.on=e.prototype.addListener,e.prototype.prependListener=function(g,h){return l(this,g,h,!0)},e.prototype.once=function(g,h){return u(h),this.on(g,i(this,g,h)),this},e.prototype.prependOnceListener=function(g,h){return u(h),this.prependListener(g,i(this,g,h)),this},e.prototype.removeListener=function(g,h){var y,v,_,x,T;if(u(h),(v=this._events)===void 0)return this;if((y=v[g])===void 0)return this;if(y===h||y.listener===h)--this._eventsCount==0?this._events=Object.create(null):(delete v[g],v.removeListener&&this.emit("removeListener",g,y.listener||h));else if(typeof y!="function"){for(_=-1,x=y.length-1;x>=0;x--)if(y[x]===h||y[x].listener===h){T=y[x].listener,_=x;break}if(_<0)return this;_===0?y.shift():function(A,S){for(;S+1<A.length;S++)A[S]=A[S+1];A.pop()}(y,_),y.length===1&&(v[g]=y[0]),v.removeListener!==void 0&&this.emit("removeListener",g,T||h)}return this},e.prototype.off=e.prototype.removeListener,e.prototype.removeAllListeners=function(g){var h,y,v;if((y=this._events)===void 0)return this;if(y.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):y[g]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete y[g]),this;if(arguments.length===0){var _,x=Object.keys(y);for(v=0;v<x.length;++v)(_=x[v])!=="removeListener"&&this.removeAllListeners(_);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(h=y[g])=="function")this.removeListener(g,h);else if(h!==void 0)for(v=h.length-1;v>=0;v--)this.removeListener(g,h[v]);return this},e.prototype.listeners=function(g){return c(this,g,!0)},e.prototype.rawListeners=function(g){return c(this,g,!1)},e.listenerCount=function(g,h){return typeof g.listenerCount=="function"?g.listenerCount(h):n.call(g,h)},e.prototype.listenerCount=n,e.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},{}],117:[function(r,O,B){(function(t){(function(){var d=r("base64-js"),m=r("ieee754");B.Buffer=e,B.SlowBuffer=function(z){return+z!=z&&(z=0),e.alloc(+z)},B.INSPECT_MAX_BYTES=50;function p(z){if(z>2147483647)throw new RangeError('The value "'+z+'" is invalid for option "size"');var j=new Uint8Array(z);return j.__proto__=e.prototype,j}function e(z,j,W){if(typeof z=="number"){if(typeof j=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return s(z)}return f(z,j,W)}function f(z,j,W){if(typeof z=="string")return function(Q,te){if(typeof te=="string"&&te!==""||(te="utf8"),!e.isEncoding(te))throw new TypeError("Unknown encoding: "+te);var ie=0|i(Q,te),ae=p(ie),he=ae.write(Q,te);return he!==ie&&(ae=ae.slice(0,he)),ae}(z,j);if(ArrayBuffer.isView(z))return l(z);if(z==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof z);if(Y(z,ArrayBuffer)||z&&Y(z.buffer,ArrayBuffer))return function(Q,te,ie){if(te<0||Q.byteLength<te)throw new RangeError('"offset" is outside of buffer bounds');if(Q.byteLength<te+(ie||0))throw new RangeError('"length" is outside of buffer bounds');var ae;return ae=te===void 0&&ie===void 0?new Uint8Array(Q):ie===void 0?new Uint8Array(Q,te):new Uint8Array(Q,te,ie),ae.__proto__=e.prototype,ae}(z,j,W);if(typeof z=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ee=z.valueOf&&z.valueOf();if(ee!=null&&ee!==z)return e.from(ee,j,W);var J=function(Q){if(e.isBuffer(Q)){var te=0|o(Q.length),ie=p(te);return ie.length===0||Q.copy(ie,0,0,te),ie}if(Q.length!==void 0)return typeof Q.length!="number"||$(Q.length)?p(0):l(Q);if(Q.type==="Buffer"&&Array.isArray(Q.data))return l(Q.data)}(z);if(J)return J;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof z[Symbol.toPrimitive]=="function")return e.from(z[Symbol.toPrimitive]("string"),j,W);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof z)}function u(z){if(typeof z!="number")throw new TypeError('"size" argument must be of type number');if(z<0)throw new RangeError('The value "'+z+'" is invalid for option "size"')}function s(z){return u(z),p(z<0?0:0|o(z))}function l(z){for(var j=z.length<0?0:0|o(z.length),W=p(j),ee=0;ee<j;ee+=1)W[ee]=255&z[ee];return W}function o(z){if(z>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|z}function i(z,j){if(e.isBuffer(z))return z.length;if(ArrayBuffer.isView(z)||Y(z,ArrayBuffer))return z.byteLength;if(typeof z!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof z);var W=z.length,ee=arguments.length>2&&arguments[2]===!0;if(!ee&&W===0)return 0;for(var J=!1;;)switch(j){case"ascii":case"latin1":case"binary":return W;case"utf8":case"utf-8":return K(z).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*W;case"hex":return W>>>1;case"base64":return Z(z).length;default:if(J)return ee?-1:K(z).length;j=(""+j).toLowerCase(),J=!0}}function c(z,j,W){var ee=!1;if((j===void 0||j<0)&&(j=0),j>this.length||((W===void 0||W>this.length)&&(W=this.length),W<=0)||(W>>>=0)<=(j>>>=0))return"";for(z||(z="utf8");;)switch(z){case"hex":return k(this,j,W);case"utf8":case"utf-8":return S(this,j,W);case"ascii":return w(this,j,W);case"latin1":case"binary":return C(this,j,W);case"base64":return A(this,j,W);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,j,W);default:if(ee)throw new TypeError("Unknown encoding: "+z);z=(z+"").toLowerCase(),ee=!0}}function n(z,j,W){var ee=z[j];z[j]=z[W],z[W]=ee}function a(z,j,W,ee,J){if(z.length===0)return-1;if(typeof W=="string"?(ee=W,W=0):W>2147483647?W=2147483647:W<-2147483648&&(W=-2147483648),$(W=+W)&&(W=J?0:z.length-1),W<0&&(W=z.length+W),W>=z.length){if(J)return-1;W=z.length-1}else if(W<0){if(!J)return-1;W=0}if(typeof j=="string"&&(j=e.from(j,ee)),e.isBuffer(j))return j.length===0?-1:g(z,j,W,ee,J);if(typeof j=="number")return j&=255,typeof Uint8Array.prototype.indexOf=="function"?J?Uint8Array.prototype.indexOf.call(z,j,W):Uint8Array.prototype.lastIndexOf.call(z,j,W):g(z,[j],W,ee,J);throw new TypeError("val must be string, number or Buffer")}function g(z,j,W,ee,J){var Q,te=1,ie=z.length,ae=j.length;if(ee!==void 0&&((ee=String(ee).toLowerCase())==="ucs2"||ee==="ucs-2"||ee==="utf16le"||ee==="utf-16le")){if(z.length<2||j.length<2)return-1;te=2,ie/=2,ae/=2,W/=2}function he(ve,ke){return te===1?ve[ke]:ve.readUInt16BE(ke*te)}if(J){var se=-1;for(Q=W;Q<ie;Q++)if(he(z,Q)===he(j,se===-1?0:Q-se)){if(se===-1&&(se=Q),Q-se+1===ae)return se*te}else se!==-1&&(Q-=Q-se),se=-1}else for(W+ae>ie&&(W=ie-ae),Q=W;Q>=0;Q--){for(var de=!0,ue=0;ue<ae;ue++)if(he(z,Q+ue)!==he(j,ue)){de=!1;break}if(de)return Q}return-1}function h(z,j,W,ee){W=Number(W)||0;var J=z.length-W;ee?(ee=Number(ee))>J&&(ee=J):ee=J;var Q=j.length;ee>Q/2&&(ee=Q/2);for(var te=0;te<ee;++te){var ie=parseInt(j.substr(2*te,2),16);if($(ie))return te;z[W+te]=ie}return te}function y(z,j,W,ee){return H(K(j,z.length-W),z,W,ee)}function v(z,j,W,ee){return H(function(J){for(var Q=[],te=0;te<J.length;++te)Q.push(255&J.charCodeAt(te));return Q}(j),z,W,ee)}function _(z,j,W,ee){return v(z,j,W,ee)}function x(z,j,W,ee){return H(Z(j),z,W,ee)}function T(z,j,W,ee){return H(function(J,Q){for(var te,ie,ae,he=[],se=0;se<J.length&&!((Q-=2)<0);++se)te=J.charCodeAt(se),ie=te>>8,ae=te%256,he.push(ae),he.push(ie);return he}(j,z.length-W),z,W,ee)}function A(z,j,W){return j===0&&W===z.length?d.fromByteArray(z):d.fromByteArray(z.slice(j,W))}function S(z,j,W){W=Math.min(z.length,W);for(var ee=[],J=j;J<W;){var Q,te,ie,ae,he=z[J],se=null,de=he>239?4:he>223?3:he>191?2:1;if(J+de<=W)switch(de){case 1:he<128&&(se=he);break;case 2:(192&(Q=z[J+1]))==128&&(ae=(31&he)<<6|63&Q)>127&&(se=ae);break;case 3:Q=z[J+1],te=z[J+2],(192&Q)==128&&(192&te)==128&&(ae=(15&he)<<12|(63&Q)<<6|63&te)>2047&&(ae<55296||ae>57343)&&(se=ae);break;case 4:Q=z[J+1],te=z[J+2],ie=z[J+3],(192&Q)==128&&(192&te)==128&&(192&ie)==128&&(ae=(15&he)<<18|(63&Q)<<12|(63&te)<<6|63&ie)>65535&&ae<1114112&&(se=ae)}se===null?(se=65533,de=1):se>65535&&(se-=65536,ee.push(se>>>10&1023|55296),se=56320|1023&se),ee.push(se),J+=de}return function(ue){var ve=ue.length;if(ve<=4096)return String.fromCharCode.apply(String,ue);for(var ke="",Ee=0;Ee<ve;)ke+=String.fromCharCode.apply(String,ue.slice(Ee,Ee+=4096));return ke}(ee)}B.kMaxLength=2147483647,e.TYPED_ARRAY_SUPPORT=function(){try{var z=new Uint8Array(1);return z.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},z.foo()===42}catch(j){return!1}}(),e.TYPED_ARRAY_SUPPORT||typeof console=="undefined"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}}),typeof Symbol!="undefined"&&Symbol.species!=null&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(z,j,W){return f(z,j,W)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(z,j,W){return function(ee,J,Q){return u(ee),ee<=0?p(ee):J!==void 0?typeof Q=="string"?p(ee).fill(J,Q):p(ee).fill(J):p(ee)}(z,j,W)},e.allocUnsafe=function(z){return s(z)},e.allocUnsafeSlow=function(z){return s(z)},e.isBuffer=function(z){return z!=null&&z._isBuffer===!0&&z!==e.prototype},e.compare=function(z,j){if(Y(z,Uint8Array)&&(z=e.from(z,z.offset,z.byteLength)),Y(j,Uint8Array)&&(j=e.from(j,j.offset,j.byteLength)),!e.isBuffer(z)||!e.isBuffer(j))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(z===j)return 0;for(var W=z.length,ee=j.length,J=0,Q=Math.min(W,ee);J<Q;++J)if(z[J]!==j[J]){W=z[J],ee=j[J];break}return W<ee?-1:ee<W?1:0},e.isEncoding=function(z){switch(String(z).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(z,j){if(!Array.isArray(z))throw new TypeError('"list" argument must be an Array of Buffers');if(z.length===0)return e.alloc(0);var W;if(j===void 0)for(j=0,W=0;W<z.length;++W)j+=z[W].length;var ee=e.allocUnsafe(j),J=0;for(W=0;W<z.length;++W){var Q=z[W];if(Y(Q,Uint8Array)&&(Q=e.from(Q)),!e.isBuffer(Q))throw new TypeError('"list" argument must be an Array of Buffers');Q.copy(ee,J),J+=Q.length}return ee},e.byteLength=i,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var z=this.length;if(z%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var j=0;j<z;j+=2)n(this,j,j+1);return this},e.prototype.swap32=function(){var z=this.length;if(z%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var j=0;j<z;j+=4)n(this,j,j+3),n(this,j+1,j+2);return this},e.prototype.swap64=function(){var z=this.length;if(z%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var j=0;j<z;j+=8)n(this,j,j+7),n(this,j+1,j+6),n(this,j+2,j+5),n(this,j+3,j+4);return this},e.prototype.toString=function(){var z=this.length;return z===0?"":arguments.length===0?S(this,0,z):c.apply(this,arguments)},e.prototype.toLocaleString=e.prototype.toString,e.prototype.equals=function(z){if(!e.isBuffer(z))throw new TypeError("Argument must be a Buffer");return this===z||e.compare(this,z)===0},e.prototype.inspect=function(){var z="",j=B.INSPECT_MAX_BYTES;return z=this.toString("hex",0,j).replace(/(.{2})/g,"$1 ").trim(),this.length>j&&(z+=" ... "),"<Buffer "+z+">"},e.prototype.compare=function(z,j,W,ee,J){if(Y(z,Uint8Array)&&(z=e.from(z,z.offset,z.byteLength)),!e.isBuffer(z))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof z);if(j===void 0&&(j=0),W===void 0&&(W=z?z.length:0),ee===void 0&&(ee=0),J===void 0&&(J=this.length),j<0||W>z.length||ee<0||J>this.length)throw new RangeError("out of range index");if(ee>=J&&j>=W)return 0;if(ee>=J)return-1;if(j>=W)return 1;if(this===z)return 0;for(var Q=(J>>>=0)-(ee>>>=0),te=(W>>>=0)-(j>>>=0),ie=Math.min(Q,te),ae=this.slice(ee,J),he=z.slice(j,W),se=0;se<ie;++se)if(ae[se]!==he[se]){Q=ae[se],te=he[se];break}return Q<te?-1:te<Q?1:0},e.prototype.includes=function(z,j,W){return this.indexOf(z,j,W)!==-1},e.prototype.indexOf=function(z,j,W){return a(this,z,j,W,!0)},e.prototype.lastIndexOf=function(z,j,W){return a(this,z,j,W,!1)},e.prototype.write=function(z,j,W,ee){if(j===void 0)ee="utf8",W=this.length,j=0;else if(W===void 0&&typeof j=="string")ee=j,W=this.length,j=0;else{if(!isFinite(j))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");j>>>=0,isFinite(W)?(W>>>=0,ee===void 0&&(ee="utf8")):(ee=W,W=void 0)}var J=this.length-j;if((W===void 0||W>J)&&(W=J),z.length>0&&(W<0||j<0)||j>this.length)throw new RangeError("Attempt to write outside buffer bounds");ee||(ee="utf8");for(var Q=!1;;)switch(ee){case"hex":return h(this,z,j,W);case"utf8":case"utf-8":return y(this,z,j,W);case"ascii":return v(this,z,j,W);case"latin1":case"binary":return _(this,z,j,W);case"base64":return x(this,z,j,W);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,z,j,W);default:if(Q)throw new TypeError("Unknown encoding: "+ee);ee=(""+ee).toLowerCase(),Q=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function w(z,j,W){var ee="";W=Math.min(z.length,W);for(var J=j;J<W;++J)ee+=String.fromCharCode(127&z[J]);return ee}function C(z,j,W){var ee="";W=Math.min(z.length,W);for(var J=j;J<W;++J)ee+=String.fromCharCode(z[J]);return ee}function k(z,j,W){var ee=z.length;(!j||j<0)&&(j=0),(!W||W<0||W>ee)&&(W=ee);for(var J="",Q=j;Q<W;++Q)J+=X(z[Q]);return J}function L(z,j,W){for(var ee=z.slice(j,W),J="",Q=0;Q<ee.length;Q+=2)J+=String.fromCharCode(ee[Q]+256*ee[Q+1]);return J}function M(z,j,W){if(z%1!=0||z<0)throw new RangeError("offset is not uint");if(z+j>W)throw new RangeError("Trying to access beyond buffer length")}function P(z,j,W,ee,J,Q){if(!e.isBuffer(z))throw new TypeError('"buffer" argument must be a Buffer instance');if(j>J||j<Q)throw new RangeError('"value" argument is out of bounds');if(W+ee>z.length)throw new RangeError("Index out of range")}function D(z,j,W,ee,J,Q){if(W+ee>z.length)throw new RangeError("Index out of range");if(W<0)throw new RangeError("Index out of range")}function N(z,j,W,ee,J){return j=+j,W>>>=0,J||D(z,0,W,4),m.write(z,j,W,ee,23,4),W+4}function U(z,j,W,ee,J){return j=+j,W>>>=0,J||D(z,0,W,8),m.write(z,j,W,ee,52,8),W+8}e.prototype.slice=function(z,j){var W=this.length;(z=~~z)<0?(z+=W)<0&&(z=0):z>W&&(z=W),(j=j===void 0?W:~~j)<0?(j+=W)<0&&(j=0):j>W&&(j=W),j<z&&(j=z);var ee=this.subarray(z,j);return ee.__proto__=e.prototype,ee},e.prototype.readUIntLE=function(z,j,W){z>>>=0,j>>>=0,W||M(z,j,this.length);for(var ee=this[z],J=1,Q=0;++Q<j&&(J*=256);)ee+=this[z+Q]*J;return ee},e.prototype.readUIntBE=function(z,j,W){z>>>=0,j>>>=0,W||M(z,j,this.length);for(var ee=this[z+--j],J=1;j>0&&(J*=256);)ee+=this[z+--j]*J;return ee},e.prototype.readUInt8=function(z,j){return z>>>=0,j||M(z,1,this.length),this[z]},e.prototype.readUInt16LE=function(z,j){return z>>>=0,j||M(z,2,this.length),this[z]|this[z+1]<<8},e.prototype.readUInt16BE=function(z,j){return z>>>=0,j||M(z,2,this.length),this[z]<<8|this[z+1]},e.prototype.readUInt32LE=function(z,j){return z>>>=0,j||M(z,4,this.length),(this[z]|this[z+1]<<8|this[z+2]<<16)+16777216*this[z+3]},e.prototype.readUInt32BE=function(z,j){return z>>>=0,j||M(z,4,this.length),16777216*this[z]+(this[z+1]<<16|this[z+2]<<8|this[z+3])},e.prototype.readIntLE=function(z,j,W){z>>>=0,j>>>=0,W||M(z,j,this.length);for(var ee=this[z],J=1,Q=0;++Q<j&&(J*=256);)ee+=this[z+Q]*J;return ee>=(J*=128)&&(ee-=Math.pow(2,8*j)),ee},e.prototype.readIntBE=function(z,j,W){z>>>=0,j>>>=0,W||M(z,j,this.length);for(var ee=j,J=1,Q=this[z+--ee];ee>0&&(J*=256);)Q+=this[z+--ee]*J;return Q>=(J*=128)&&(Q-=Math.pow(2,8*j)),Q},e.prototype.readInt8=function(z,j){return z>>>=0,j||M(z,1,this.length),128&this[z]?-1*(255-this[z]+1):this[z]},e.prototype.readInt16LE=function(z,j){z>>>=0,j||M(z,2,this.length);var W=this[z]|this[z+1]<<8;return 32768&W?4294901760|W:W},e.prototype.readInt16BE=function(z,j){z>>>=0,j||M(z,2,this.length);var W=this[z+1]|this[z]<<8;return 32768&W?4294901760|W:W},e.prototype.readInt32LE=function(z,j){return z>>>=0,j||M(z,4,this.length),this[z]|this[z+1]<<8|this[z+2]<<16|this[z+3]<<24},e.prototype.readInt32BE=function(z,j){return z>>>=0,j||M(z,4,this.length),this[z]<<24|this[z+1]<<16|this[z+2]<<8|this[z+3]},e.prototype.readFloatLE=function(z,j){return z>>>=0,j||M(z,4,this.length),m.read(this,z,!0,23,4)},e.prototype.readFloatBE=function(z,j){return z>>>=0,j||M(z,4,this.length),m.read(this,z,!1,23,4)},e.prototype.readDoubleLE=function(z,j){return z>>>=0,j||M(z,8,this.length),m.read(this,z,!0,52,8)},e.prototype.readDoubleBE=function(z,j){return z>>>=0,j||M(z,8,this.length),m.read(this,z,!1,52,8)},e.prototype.writeUIntLE=function(z,j,W,ee){z=+z,j>>>=0,W>>>=0,ee||P(this,z,j,W,Math.pow(2,8*W)-1,0);var J=1,Q=0;for(this[j]=255&z;++Q<W&&(J*=256);)this[j+Q]=z/J&255;return j+W},e.prototype.writeUIntBE=function(z,j,W,ee){z=+z,j>>>=0,W>>>=0,ee||P(this,z,j,W,Math.pow(2,8*W)-1,0);var J=W-1,Q=1;for(this[j+J]=255&z;--J>=0&&(Q*=256);)this[j+J]=z/Q&255;return j+W},e.prototype.writeUInt8=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,1,255,0),this[j]=255&z,j+1},e.prototype.writeUInt16LE=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,2,65535,0),this[j]=255&z,this[j+1]=z>>>8,j+2},e.prototype.writeUInt16BE=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,2,65535,0),this[j]=z>>>8,this[j+1]=255&z,j+2},e.prototype.writeUInt32LE=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,4,4294967295,0),this[j+3]=z>>>24,this[j+2]=z>>>16,this[j+1]=z>>>8,this[j]=255&z,j+4},e.prototype.writeUInt32BE=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,4,4294967295,0),this[j]=z>>>24,this[j+1]=z>>>16,this[j+2]=z>>>8,this[j+3]=255&z,j+4},e.prototype.writeIntLE=function(z,j,W,ee){if(z=+z,j>>>=0,!ee){var J=Math.pow(2,8*W-1);P(this,z,j,W,J-1,-J)}var Q=0,te=1,ie=0;for(this[j]=255&z;++Q<W&&(te*=256);)z<0&&ie===0&&this[j+Q-1]!==0&&(ie=1),this[j+Q]=(z/te>>0)-ie&255;return j+W},e.prototype.writeIntBE=function(z,j,W,ee){if(z=+z,j>>>=0,!ee){var J=Math.pow(2,8*W-1);P(this,z,j,W,J-1,-J)}var Q=W-1,te=1,ie=0;for(this[j+Q]=255&z;--Q>=0&&(te*=256);)z<0&&ie===0&&this[j+Q+1]!==0&&(ie=1),this[j+Q]=(z/te>>0)-ie&255;return j+W},e.prototype.writeInt8=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,1,127,-128),z<0&&(z=255+z+1),this[j]=255&z,j+1},e.prototype.writeInt16LE=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,2,32767,-32768),this[j]=255&z,this[j+1]=z>>>8,j+2},e.prototype.writeInt16BE=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,2,32767,-32768),this[j]=z>>>8,this[j+1]=255&z,j+2},e.prototype.writeInt32LE=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,4,2147483647,-2147483648),this[j]=255&z,this[j+1]=z>>>8,this[j+2]=z>>>16,this[j+3]=z>>>24,j+4},e.prototype.writeInt32BE=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,4,2147483647,-2147483648),z<0&&(z=4294967295+z+1),this[j]=z>>>24,this[j+1]=z>>>16,this[j+2]=z>>>8,this[j+3]=255&z,j+4},e.prototype.writeFloatLE=function(z,j,W){return N(this,z,j,!0,W)},e.prototype.writeFloatBE=function(z,j,W){return N(this,z,j,!1,W)},e.prototype.writeDoubleLE=function(z,j,W){return U(this,z,j,!0,W)},e.prototype.writeDoubleBE=function(z,j,W){return U(this,z,j,!1,W)},e.prototype.copy=function(z,j,W,ee){if(!e.isBuffer(z))throw new TypeError("argument should be a Buffer");if(W||(W=0),ee||ee===0||(ee=this.length),j>=z.length&&(j=z.length),j||(j=0),ee>0&&ee<W&&(ee=W),ee===W||z.length===0||this.length===0)return 0;if(j<0)throw new RangeError("targetStart out of bounds");if(W<0||W>=this.length)throw new RangeError("Index out of range");if(ee<0)throw new RangeError("sourceEnd out of bounds");ee>this.length&&(ee=this.length),z.length-j<ee-W&&(ee=z.length-j+W);var J=ee-W;if(this===z&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(j,W,ee);else if(this===z&&W<j&&j<ee)for(var Q=J-1;Q>=0;--Q)z[Q+j]=this[Q+W];else Uint8Array.prototype.set.call(z,this.subarray(W,ee),j);return J},e.prototype.fill=function(z,j,W,ee){if(typeof z=="string"){if(typeof j=="string"?(ee=j,j=0,W=this.length):typeof W=="string"&&(ee=W,W=this.length),ee!==void 0&&typeof ee!="string")throw new TypeError("encoding must be a string");if(typeof ee=="string"&&!e.isEncoding(ee))throw new TypeError("Unknown encoding: "+ee);if(z.length===1){var J=z.charCodeAt(0);(ee==="utf8"&&J<128||ee==="latin1")&&(z=J)}}else typeof z=="number"&&(z&=255);if(j<0||this.length<j||this.length<W)throw new RangeError("Out of range index");if(W<=j)return this;var Q;if(j>>>=0,W=W===void 0?this.length:W>>>0,z||(z=0),typeof z=="number")for(Q=j;Q<W;++Q)this[Q]=z;else{var te=e.isBuffer(z)?z:e.from(z,ee),ie=te.length;if(ie===0)throw new TypeError('The value "'+z+'" is invalid for argument "value"');for(Q=0;Q<W-j;++Q)this[Q+j]=te[Q%ie]}return this};var q=/[^+/0-9A-Za-z-_]/g;function X(z){return z<16?"0"+z.toString(16):z.toString(16)}function K(z,j){var W;j=j||1/0;for(var ee=z.length,J=null,Q=[],te=0;te<ee;++te){if((W=z.charCodeAt(te))>55295&&W<57344){if(!J){if(W>56319){(j-=3)>-1&&Q.push(239,191,189);continue}if(te+1===ee){(j-=3)>-1&&Q.push(239,191,189);continue}J=W;continue}if(W<56320){(j-=3)>-1&&Q.push(239,191,189),J=W;continue}W=65536+(J-55296<<10|W-56320)}else J&&(j-=3)>-1&&Q.push(239,191,189);if(J=null,W<128){if((j-=1)<0)break;Q.push(W)}else if(W<2048){if((j-=2)<0)break;Q.push(W>>6|192,63&W|128)}else if(W<65536){if((j-=3)<0)break;Q.push(W>>12|224,W>>6&63|128,63&W|128)}else{if(!(W<1114112))throw new Error("Invalid code point");if((j-=4)<0)break;Q.push(W>>18|240,W>>12&63|128,W>>6&63|128,63&W|128)}}return Q}function Z(z){return d.toByteArray(function(j){if((j=(j=j.split("=")[0]).trim().replace(q,"")).length<2)return"";for(;j.length%4!=0;)j+="=";return j}(z))}function H(z,j,W,ee){for(var J=0;J<ee&&!(J+W>=j.length||J>=z.length);++J)j[J+W]=z[J];return J}function Y(z,j){return z instanceof j||z!=null&&z.constructor!=null&&z.constructor.name!=null&&z.constructor.name===j.name}function $(z){return z!=z}}).call(this)}).call(this,r("buffer").Buffer)},{"base64-js":86,buffer:117,ieee754:437}],118:[function(r,O,B){var t=r("./lib/monotone"),d=r("./lib/triangulation"),m=r("./lib/delaunay"),p=r("./lib/filter");function e(s){return[Math.min(s[0],s[1]),Math.max(s[0],s[1])]}function f(s,l){return s[0]-l[0]||s[1]-l[1]}function u(s,l,o){return l in s?s[l]:o}O.exports=function(s,l,o){Array.isArray(l)?(o=o||{},l=l||[]):(o=l||{},l=[]);var i=!!u(o,"delaunay",!0),c=!!u(o,"interior",!0),n=!!u(o,"exterior",!0),a=!!u(o,"infinity",!1);if(!c&&!n||s.length===0)return[];var g=t(s,l);if(i||c!==n||a){for(var h=d(s.length,function(_){return _.map(e).sort(f)}(l)),y=0;y<g.length;++y){var v=g[y];h.addTriangle(v[0],v[1],v[2])}return i&&m(s,h),n?c?a?p(h,0,a):h.cells():p(h,1,a):p(h,-1)}return g}},{"./lib/delaunay":119,"./lib/filter":120,"./lib/monotone":121,"./lib/triangulation":122}],119:[function(r,O,B){var t=r("robust-in-sphere")[4];r("binary-search-bounds");function d(m,p,e,f,u,s){var l=p.opposite(f,u);if(!(l<0)){if(u<f){var o=f;f=u,u=o,o=s,s=l,l=o}p.isConstraint(f,u)||t(m[f],m[u],m[s],m[l])<0&&e.push(f,u)}}O.exports=function(m,p){for(var e=[],f=m.length,u=p.stars,s=0;s<f;++s)for(var l=u[s],o=1;o<l.length;o+=2)if(!((a=l[o])<s)&&!p.isConstraint(s,a)){for(var i=l[o-1],c=-1,n=1;n<l.length;n+=2)if(l[n-1]===a){c=l[n];break}c<0||t(m[s],m[a],m[i],m[c])<0&&e.push(s,a)}for(;e.length>0;){for(var a=e.pop(),g=(s=e.pop(),i=-1,c=-1,l=u[s],1);g<l.length;g+=2){var h=l[g-1],y=l[g];h===a?c=y:y===a&&(i=h)}i<0||c<0||t(m[s],m[a],m[i],m[c])>=0||(p.flip(s,a),d(m,p,e,i,s,c),d(m,p,e,s,c,i),d(m,p,e,c,a,i),d(m,p,e,a,i,c))}}},{"binary-search-bounds":103,"robust-in-sphere":532}],120:[function(r,O,B){var t,d=r("binary-search-bounds");function m(e,f,u,s,l,o,i){this.cells=e,this.neighbor=f,this.flags=s,this.constraint=u,this.active=l,this.next=o,this.boundary=i}function p(e,f){return e[0]-f[0]||e[1]-f[1]||e[2]-f[2]}O.exports=function(e,f,u){var s=function(T,A){for(var S=T.cells(),w=S.length,C=0;C<w;++C){var k=(Z=S[C])[0],L=Z[1],M=Z[2];L<M?L<k&&(Z[0]=L,Z[1]=M,Z[2]=k):M<k&&(Z[0]=M,Z[1]=k,Z[2]=L)}S.sort(p);var P=new Array(w);for(C=0;C<P.length;++C)P[C]=0;var D=[],N=[],U=new Array(3*w),q=new Array(3*w),X=null;A&&(X=[]);var K=new m(S,U,q,P,D,N,X);for(C=0;C<w;++C)for(var Z=S[C],H=0;H<3;++H){k=Z[H],L=Z[(H+1)%3];var Y=U[3*C+H]=K.locate(L,k,T.opposite(L,k)),$=q[3*C+H]=T.isConstraint(k,L);Y<0&&($?N.push(C):(D.push(C),P[C]=1),A&&X.push([L,k,-1]))}return K}(e,u);if(f===0)return u?s.cells.concat(s.boundary):s.cells;for(var l=1,o=s.active,i=s.next,c=s.flags,n=s.cells,a=s.constraint,g=s.neighbor;o.length>0||i.length>0;){for(;o.length>0;){var h=o.pop();if(c[h]!==-l){c[h]=l,n[h];for(var y=0;y<3;++y){var v=g[3*h+y];v>=0&&c[v]===0&&(a[3*h+y]?i.push(v):(o.push(v),c[v]=l))}}}var _=i;i=o,o=_,i.length=0,l=-l}var x=function(T,A,S){for(var w=0,C=0;C<T.length;++C)A[C]===S&&(T[w++]=T[C]);return T.length=w,T}(n,c,f);return u?x.concat(s.boundary):x},m.prototype.locate=(t=[0,0,0],function(e,f,u){var s=e,l=f,o=u;return f<u?f<e&&(s=f,l=u,o=e):u<e&&(s=u,l=e,o=f),s<0?-1:(t[0]=s,t[1]=l,t[2]=o,d.eq(this.cells,t,p))})},{"binary-search-bounds":103}],121:[function(r,O,B){var t=r("binary-search-bounds"),d=r("robust-orientation")[3];function m(i,c,n,a,g){this.a=i,this.b=c,this.idx=n,this.lowerIds=a,this.upperIds=g}function p(i,c,n,a){this.a=i,this.b=c,this.type=n,this.idx=a}function e(i,c){var n=i.a[0]-c.a[0]||i.a[1]-c.a[1]||i.type-c.type;return n||(i.type!==0&&(n=d(i.a,i.b,c.b))?n:i.idx-c.idx)}function f(i,c){return d(i.a,i.b,c)}function u(i,c,n,a,g){for(var h=t.lt(c,a,f),y=t.gt(c,a,f),v=h;v<y;++v){for(var _=c[v],x=_.lowerIds,T=x.length;T>1&&d(n[x[T-2]],n[x[T-1]],a)>0;)i.push([x[T-1],x[T-2],g]),T-=1;x.length=T,x.push(g);var A=_.upperIds;for(T=A.length;T>1&&d(n[A[T-2]],n[A[T-1]],a)<0;)i.push([A[T-2],A[T-1],g]),T-=1;A.length=T,A.push(g)}}function s(i,c){var n;return(n=i.a[0]<c.a[0]?d(i.a,i.b,c.a):d(c.b,c.a,i.a))?n:(n=c.b[0]<i.b[0]?d(i.a,i.b,c.b):d(c.b,c.a,i.b))||i.idx-c.idx}function l(i,c,n){var a=t.le(i,n,s),g=i[a],h=g.upperIds,y=h[h.length-1];g.upperIds=[y],i.splice(a+1,0,new m(n.a,n.b,n.idx,[y],h))}function o(i,c,n){var a=n.a;n.a=n.b,n.b=a;var g=t.eq(i,n,s),h=i[g];i[g-1].upperIds=h.upperIds,i.splice(g,1)}O.exports=function(i,c){for(var n=i.length,a=c.length,g=[],h=0;h<n;++h)g.push(new p(i[h],null,0,h));for(h=0;h<a;++h){var y=c[h],v=i[y[0]],_=i[y[1]];v[0]<_[0]?g.push(new p(v,_,2,h),new p(_,v,1,h)):v[0]>_[0]&&g.push(new p(_,v,2,h),new p(v,_,1,h))}g.sort(e);for(var x=g[0].a[0]-(1+Math.abs(g[0].a[0]))*Math.pow(2,-52),T=[new m([x,1],[x,0],-1,[],[],[],[])],A=[],S=(h=0,g.length);h<S;++h){var w=g[h],C=w.type;C===0?u(A,T,i,w.a,w.idx):C===2?l(T,i,w):o(T,i,w)}return A}},{"binary-search-bounds":103,"robust-orientation":534}],122:[function(r,O,B){var t=r("binary-search-bounds");function d(e,f){this.stars=e,this.edges=f}O.exports=function(e,f){for(var u=new Array(e),s=0;s<e;++s)u[s]=[];return new d(u,f)};var m=d.prototype;function p(e,f,u){for(var s=1,l=e.length;s<l;s+=2)if(e[s-1]===f&&e[s]===u)return e[s-1]=e[l-2],e[s]=e[l-1],void(e.length=l-2)}m.isConstraint=function(){var e=[0,0];function f(u,s){return u[0]-s[0]||u[1]-s[1]}return function(u,s){return e[0]=Math.min(u,s),e[1]=Math.max(u,s),t.eq(this.edges,e,f)>=0}}(),m.removeTriangle=function(e,f,u){var s=this.stars;p(s[e],f,u),p(s[f],u,e),p(s[u],e,f)},m.addTriangle=function(e,f,u){var s=this.stars;s[e].push(f,u),s[f].push(u,e),s[u].push(e,f)},m.opposite=function(e,f){for(var u=this.stars[f],s=1,l=u.length;s<l;s+=2)if(u[s]===e)return u[s-1];return-1},m.flip=function(e,f){var u=this.opposite(e,f),s=this.opposite(f,e);this.removeTriangle(e,f,u),this.removeTriangle(f,e,s),this.addTriangle(e,s,u),this.addTriangle(f,u,s)},m.edges=function(){for(var e=this.stars,f=[],u=0,s=e.length;u<s;++u)for(var l=e[u],o=0,i=l.length;o<i;o+=2)f.push([l[o],l[o+1]]);return f},m.cells=function(){for(var e=this.stars,f=[],u=0,s=e.length;u<s;++u)for(var l=e[u],o=0,i=l.length;o<i;o+=2){var c=l[o],n=l[o+1];u<Math.min(c,n)&&f.push([u,c,n])}return f}},{"binary-search-bounds":103}],123:[function(r,O,B){O.exports=function(t){for(var d=1,m=1;m<t.length;++m)for(var p=0;p<m;++p)if(t[m]<t[p])d=-d;else if(t[p]===t[m])return 0;return d}},{}],124:[function(r,O,B){var t=r("dup"),d=r("robust-linear-solve");function m(f,u){for(var s=0,l=f.length,o=0;o<l;++o)s+=f[o]*u[o];return s}function p(f){var u=f.length;if(u===0)return[];f[0].length;var s=t([f.length+1,f.length+1],1),l=t([f.length+1],1);s[u][u]=0;for(var o=0;o<u;++o){for(var i=0;i<=o;++i)s[i][o]=s[o][i]=2*m(f[o],f[i]);l[o]=m(f[o],f[o])}var c=d(s,l),n=0,a=c[u+1];for(o=0;o<a.length;++o)n+=a[o];var g=new Array(u);for(o=0;o<u;++o){a=c[o];var h=0;for(i=0;i<a.length;++i)h+=a[i];g[o]=h/n}return g}function e(f){if(f.length===0)return[];for(var u=f[0].length,s=t([u]),l=p(f),o=0;o<f.length;++o)for(var i=0;i<u;++i)s[i]+=f[o][i]*l[o];return s}e.barycenetric=p,O.exports=e},{dup:182,"robust-linear-solve":533}],125:[function(r,O,B){O.exports=function(d){for(var m=t(d),p=0,e=0;e<d.length;++e)for(var f=d[e],u=0;u<m.length;++u)p+=Math.pow(f[u]-m[u],2);return Math.sqrt(p/d.length)};var t=r("circumcenter")},{circumcenter:124}],126:[function(r,O,B){O.exports=function(t,d,m){return d<m?t<d?d:t>m?m:t:t<m?m:t>d?d:t}},{}],127:[function(r,O,B){O.exports=function(y,v,_){var x;if(_){x=v;for(var T=new Array(v.length),A=0;A<v.length;++A){var S=v[A];T[A]=[S[0],S[1],_[A]]}v=T}for(var w=function(C,k,L){var M=c(C,[],i(C));return g(k,M,L),!!M}(y,v,!!_);h(y,v,!!_);)w=!0;if(_&&w)for(x.length=0,_.length=0,A=0;A<v.length;++A)S=v[A],x.push([S[0],S[1]]),_.push(S[2]);return w};var t=r("union-find"),d=r("box-intersect"),m=r("robust-segment-intersect"),p=r("big-rat"),e=r("big-rat/cmp"),f=r("big-rat/to-float"),u=r("rat-vec"),s=r("nextafter"),l=r("./lib/rat-seg-intersect");function o(y){var v=f(y);return[s(v,-1/0),s(v,1/0)]}function i(y){for(var v=new Array(y.length),_=0;_<y.length;++_){var x=y[_];v[_]=[s(x[0],-1/0),s(x[1],-1/0),s(x[0],1/0),s(x[1],1/0)]}return v}function c(y,v,_){for(var x=v.length,T=new t(x),A=[],S=0;S<v.length;++S){var w=v[S],C=o(w[0]),k=o(w[1]);A.push([s(C[0],-1/0),s(k[0],-1/0),s(C[1],1/0),s(k[1],1/0)])}d(A,function(N,U){T.link(N,U)});var L=!0,M=new Array(x);for(S=0;S<x;++S)(D=T.find(S))!==S&&(L=!1,y[D]=[Math.min(y[S][0],y[D][0]),Math.min(y[S][1],y[D][1])]);if(L)return null;var P=0;for(S=0;S<x;++S){var D;(D=T.find(S))===S?(M[S]=P,y[P++]=y[S]):M[S]=-1}for(y.length=P,S=0;S<x;++S)M[S]<0&&(M[S]=M[T.find(S)]);return M}function n(y,v){return y[0]-v[0]||y[1]-v[1]}function a(y,v){var _=y[0]-v[0]||y[1]-v[1];return _||(y[2]<v[2]?-1:y[2]>v[2]?1:0)}function g(y,v,_){if(y.length!==0){if(v)for(var x=0;x<y.length;++x){var T=v[(S=y[x])[0]],A=v[S[1]];S[0]=Math.min(T,A),S[1]=Math.max(T,A)}else for(x=0;x<y.length;++x){var S;T=(S=y[x])[0],A=S[1],S[0]=Math.min(T,A),S[1]=Math.max(T,A)}_?y.sort(a):y.sort(n);var w=1;for(x=1;x<y.length;++x){var C=y[x-1],k=y[x];(k[0]!==C[0]||k[1]!==C[1]||_&&k[2]!==C[2])&&(y[w++]=k)}y.length=w}}function h(y,v,_){var x=function(C,k){for(var L=new Array(k.length),M=0;M<k.length;++M){var P=k[M],D=C[P[0]],N=C[P[1]];L[M]=[s(Math.min(D[0],N[0]),-1/0),s(Math.min(D[1],N[1]),-1/0),s(Math.max(D[0],N[0]),1/0),s(Math.max(D[1],N[1]),1/0)]}return L}(y,v),T=function(C,k,L){var M=[];return d(L,function(P,D){var N=k[P],U=k[D];if(N[0]!==U[0]&&N[0]!==U[1]&&N[1]!==U[0]&&N[1]!==U[1]){var q=C[N[0]],X=C[N[1]],K=C[U[0]],Z=C[U[1]];m(q,X,K,Z)&&M.push([P,D])}}),M}(y,v,x),A=i(y),S=function(C,k,L,M){var P=[];return d(L,M,function(D,N){var U=k[D];if(U[0]!==N&&U[1]!==N){var q=C[N],X=C[U[0]],K=C[U[1]];m(X,K,q,q)&&P.push([D,N])}}),P}(y,v,x,A),w=c(y,function(C,k,L,M,P){var D,N,U=C.map(function(he){return[p(he[0]),p(he[1])]});for(D=0;D<L.length;++D){var q=L[D];N=q[0];var X=q[1],K=k[N],Z=k[X],H=l(u(C[K[0]]),u(C[K[1]]),u(C[Z[0]]),u(C[Z[1]]));if(H){var Y=C.length;C.push([f(H[0]),f(H[1])]),U.push(H),M.push([N,Y],[X,Y])}}for(M.sort(function(he,se){if(he[0]!==se[0])return he[0]-se[0];var de=U[he[1]],ue=U[se[1]];return e(de[0],ue[0])||e(de[1],ue[1])}),D=M.length-1;D>=0;--D){var $=k[N=(ie=M[D])[0]],z=$[0],j=$[1],W=C[z],ee=C[j];if((W[0]-ee[0]||W[1]-ee[1])<0){var J=z;z=j,j=J}$[0]=z;var Q,te=$[1]=ie[1];for(P&&(Q=$[2]);D>0&&M[D-1][0]===N;){var ie,ae=(ie=M[--D])[1];P?k.push([te,ae,Q]):k.push([te,ae]),te=ae}P?k.push([te,j,Q]):k.push([te,j])}return U}(y,v,T,S,_));return g(v,w,_),!!w||T.length>0||S.length>0}},{"./lib/rat-seg-intersect":128,"big-rat":90,"big-rat/cmp":88,"big-rat/to-float":102,"box-intersect":108,nextafter:473,"rat-vec":518,"robust-segment-intersect":537,"union-find":602}],128:[function(r,O,B){O.exports=function(l,o,i,c){var n=e(o,l),a=e(c,i),g=s(n,a);if(p(g)===0)return null;var h=e(l,i),y=s(a,h),v=d(y,g),_=u(n,v);return f(l,_)};var t=r("big-rat/mul"),d=r("big-rat/div"),m=r("big-rat/sub"),p=r("big-rat/sign"),e=r("rat-vec/sub"),f=r("rat-vec/add"),u=r("rat-vec/muls");function s(l,o){return m(t(l[0],o[1]),t(l[1],o[0]))}},{"big-rat/div":89,"big-rat/mul":99,"big-rat/sign":100,"big-rat/sub":101,"rat-vec/add":517,"rat-vec/muls":519,"rat-vec/sub":520}],129:[function(r,O,B){var t=r("clamp");function d(m,p){p==null&&(p=!0);var e=m[0],f=m[1],u=m[2],s=m[3];return s==null&&(s=p?1:255),p&&(e*=255,f*=255,u*=255,s*=255),16777216*(e=255&t(e,0,255))+((f=255&t(f,0,255))<<16)+((u=255&t(u,0,255))<<8)+(s=255&t(s,0,255))}O.exports=d,O.exports.to=d,O.exports.from=function(m,p){var e=(m=+m)>>>24,f=(16711680&m)>>>16,u=(65280&m)>>>8,s=255&m;return p===!1?[e,f,u,s]:[e/255,f/255,u/255,s/255]}},{clamp:126}],130:[function(r,O,B){O.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],131:[function(r,O,B){var t=r("color-rgba"),d=r("clamp"),m=r("dtype");O.exports=function(p,e){e!=="float"&&e||(e="array"),e==="uint"&&(e="uint8"),e==="uint_clamped"&&(e="uint8_clamped");var f=new(m(e))(4),u=e!=="uint8"&&e!=="uint8_clamped";return p.length&&typeof p!="string"||((p=t(p))[0]/=255,p[1]/=255,p[2]/=255),function(s){return s instanceof Uint8Array||s instanceof Uint8ClampedArray||!!(Array.isArray(s)&&(s[0]>1||s[0]===0)&&(s[1]>1||s[1]===0)&&(s[2]>1||s[2]===0)&&(!s[3]||s[3]>1))}(p)?(f[0]=p[0],f[1]=p[1],f[2]=p[2],f[3]=p[3]!=null?p[3]:255,u&&(f[0]/=255,f[1]/=255,f[2]/=255,f[3]/=255),f):(u?(f[0]=p[0],f[1]=p[1],f[2]=p[2],f[3]=p[3]!=null?p[3]:1):(f[0]=d(Math.floor(255*p[0]),0,255),f[1]=d(Math.floor(255*p[1]),0,255),f[2]=d(Math.floor(255*p[2]),0,255),f[3]=p[3]==null?255:d(Math.floor(255*p[3]),0,255)),f)}},{clamp:126,"color-rgba":133,dtype:181}],132:[function(r,O,B){(function(t){(function(){var d=r("color-name"),m=r("is-plain-obj"),p=r("defined");O.exports=function(f){var u,s,l=[],o=1;if(typeof f=="string")if(d[f])l=d[f].slice(),s="rgb";else if(f==="transparent")o=0,s="rgb",l=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(f)){var i=(a=f.slice(1)).length;o=1,i<=4?(l=[parseInt(a[0]+a[0],16),parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16)],i===4&&(o=parseInt(a[3]+a[3],16)/255)):(l=[parseInt(a[0]+a[1],16),parseInt(a[2]+a[3],16),parseInt(a[4]+a[5],16)],i===8&&(o=parseInt(a[6]+a[7],16)/255)),l[0]||(l[0]=0),l[1]||(l[1]=0),l[2]||(l[2]=0),s="rgb"}else if(u=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(f)){var c=u[1],n=c==="rgb",a=c.replace(/a$/,"");s=a,i=a==="cmyk"?4:a==="gray"?1:3,l=u[2].trim().split(/\s*,\s*/).map(function(h,y){if(/%$/.test(h))return y===i?parseFloat(h)/100:a==="rgb"?255*parseFloat(h)/100:parseFloat(h);if(a[y]==="h"){if(/deg$/.test(h))return parseFloat(h);if(e[h]!==void 0)return e[h]}return parseFloat(h)}),c===a&&l.push(1),o=n||l[i]===void 0?1:l[i],l=l.slice(0,i)}else f.length>10&&/[0-9](?:\s|\/)/.test(f)&&(l=f.match(/([0-9]+)/g).map(function(h){return parseFloat(h)}),s=f.match(/([a-z])/gi).join("").toLowerCase());else if(isNaN(f))if(m(f)){var g=p(f.r,f.red,f.R,null);g!==null?(s="rgb",l=[g,p(f.g,f.green,f.G),p(f.b,f.blue,f.B)]):(s="hsl",l=[p(f.h,f.hue,f.H),p(f.s,f.saturation,f.S),p(f.l,f.lightness,f.L,f.b,f.brightness)]),o=p(f.a,f.alpha,f.opacity,1),f.opacity!=null&&(o/=100)}else(Array.isArray(f)||t.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(f))&&(l=[f[0],f[1],f[2]],s="rgb",o=f.length===4?f[3]:1);else s="rgb",l=[f>>>16,(65280&f)>>>8,255&f];return{space:s,values:l,alpha:o}};var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this)}).call(this,typeof Xi!="undefined"?Xi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"color-name":130,defined:176,"is-plain-obj":447}],133:[function(r,O,B){var t=r("color-parse"),d=r("color-space/hsl"),m=r("clamp");O.exports=function(p){var e,f=t(p);return f.space?((e=Array(3))[0]=m(f.values[0],0,255),e[1]=m(f.values[1],0,255),e[2]=m(f.values[2],0,255),f.space[0]==="h"&&(e=d.rgb(e)),e.push(m(f.alpha,0,1)),e):[]}},{clamp:126,"color-parse":132,"color-space/hsl":134}],134:[function(r,O,B){var t=r("./rgb");O.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(d){var m,p,e,f,u,s=d[0]/360,l=d[1]/100,o=d[2]/100;if(l===0)return[u=255*o,u,u];m=2*o-(p=o<.5?o*(1+l):o+l-o*l),f=[0,0,0];for(var i=0;i<3;i++)(e=s+1/3*-(i-1))<0?e++:e>1&&e--,u=6*e<1?m+6*(p-m)*e:2*e<1?p:3*e<2?m+(p-m)*(2/3-e)*6:m,f[i]=255*u;return f}},t.hsl=function(d){var m,p,e=d[0]/255,f=d[1]/255,u=d[2]/255,s=Math.min(e,f,u),l=Math.max(e,f,u),o=l-s;return l===s?m=0:e===l?m=(f-u)/o:f===l?m=2+(u-e)/o:u===l&&(m=4+(e-f)/o),(m=Math.min(60*m,360))<0&&(m+=360),p=(s+l)/2,[m,100*(l===s?0:p<=.5?o/(l+s):o/(2-l-s)),100*p]}},{"./rgb":135}],135:[function(r,O,B){O.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],136:[function(r,O,B){O.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],137:[function(r,O,B){var t=r("./colorScale"),d=r("lerp");function m(f){return[f[0]/255,f[1]/255,f[2]/255,f[3]]}function p(f){for(var u,s="#",l=0;l<3;++l)s+=("00"+(u=(u=f[l]).toString(16))).substr(u.length);return s}function e(f){return"rgba("+f.join(",")+")"}O.exports=function(f){var u,s,l,o,i,c,n,a,g,h;if(f||(f={}),a=(f.nshades||72)-1,n=f.format||"hex",(c=f.colormap)||(c="jet"),typeof c=="string"){if(c=c.toLowerCase(),!t[c])throw Error(c+" not a supported colorscale");i=t[c]}else{if(!Array.isArray(c))throw Error("unsupported colormap option",c);i=c.slice()}if(i.length>a+1)throw new Error(c+" map requires nshades to be at least size "+i.length);g=Array.isArray(f.alpha)?f.alpha.length!==2?[1,1]:f.alpha.slice():typeof f.alpha=="number"?[f.alpha,f.alpha]:[1,1],u=i.map(function(T){return Math.round(T.index*a)}),g[0]=Math.min(Math.max(g[0],0),1),g[1]=Math.min(Math.max(g[1],0),1);var y=i.map(function(T,A){var S=i[A].index,w=i[A].rgb.slice();return w.length===4&&w[3]>=0&&w[3]<=1||(w[3]=g[0]+(g[1]-g[0])*S),w}),v=[];for(h=0;h<u.length-1;++h){o=u[h+1]-u[h],s=y[h],l=y[h+1];for(var _=0;_<o;_++){var x=_/o;v.push([Math.round(d(s[0],l[0],x)),Math.round(d(s[1],l[1],x)),Math.round(d(s[2],l[2],x)),d(s[3],l[3],x)])}}return v.push(i[i.length-1].rgb.concat(g[1])),n==="hex"?v=v.map(p):n==="rgbaString"?v=v.map(e):n==="float"&&(v=v.map(m)),v}},{"./colorScale":136,lerp:450}],138:[function(r,O,B){O.exports=function(u,s,l,o){var i=t(s,l,o);if(i===0){var c=d(t(u,s,l)),n=d(t(u,s,o));if(c===n){if(c===0){var a=f(u,s,l),g=f(u,s,o);return a===g?0:a?1:-1}return 0}return n===0?c>0||f(u,s,o)?-1:1:c===0?n>0||f(u,s,l)?1:-1:d(n-c)}var h=t(u,s,l);return h>0?i>0&&t(u,s,o)>0?1:-1:h<0?i>0||t(u,s,o)>0?1:-1:t(u,s,o)>0||f(u,s,l)?1:-1};var t=r("robust-orientation"),d=r("signum"),m=r("two-sum"),p=r("robust-product"),e=r("robust-sum");function f(u,s,l){var o=m(u[0],-s[0]),i=m(u[1],-s[1]),c=m(l[0],-s[0]),n=m(l[1],-s[1]),a=e(p(o,c),p(i,n));return a[a.length-1]>=0}},{"robust-orientation":534,"robust-product":535,"robust-sum":539,signum:541,"two-sum":589}],139:[function(r,O,B){O.exports=function(m,p){var e=m.length,f=m.length-p.length;if(f)return f;switch(e){case 0:return 0;case 1:return m[0]-p[0];case 2:return m[0]+m[1]-p[0]-p[1]||t(m[0],m[1])-t(p[0],p[1]);case 3:var u=m[0]+m[1],s=p[0]+p[1];if(f=u+m[2]-(s+p[2]))return f;var l=t(m[0],m[1]),o=t(p[0],p[1]);return t(l,m[2])-t(o,p[2])||t(l+m[2],u)-t(o+p[2],s);case 4:var i=m[0],c=m[1],n=m[2],a=m[3],g=p[0],h=p[1],y=p[2],v=p[3];return i+c+n+a-(g+h+y+v)||t(i,c,n,a)-t(g,h,y,v,g)||t(i+c,i+n,i+a,c+n,c+a,n+a)-t(g+h,g+y,g+v,h+y,h+v,y+v)||t(i+c+n,i+c+a,i+n+a,c+n+a)-t(g+h+y,g+h+v,g+y+v,h+y+v);default:for(var _=m.slice().sort(d),x=p.slice().sort(d),T=0;T<e;++T)if(f=_[T]-x[T])return f;return 0}};var t=Math.min;function d(m,p){return m-p}},{}],140:[function(r,O,B){var t=r("compare-cell"),d=r("cell-orientation");O.exports=function(m,p){return t(m,p)||d(m)-d(p)}},{"cell-orientation":123,"compare-cell":139}],141:[function(r,O,B){var t=r("./lib/ch1d"),d=r("./lib/ch2d"),m=r("./lib/chnd");O.exports=function(p){var e=p.length;if(e===0)return[];if(e===1)return[[0]];var f=p[0].length;return f===0?[]:f===1?t(p):f===2?d(p):m(p,f)}},{"./lib/ch1d":142,"./lib/ch2d":143,"./lib/chnd":144}],142:[function(r,O,B){O.exports=function(t){for(var d=0,m=0,p=1;p<t.length;++p)t[p][0]<t[d][0]&&(d=p),t[p][0]>t[m][0]&&(m=p);return d<m?[[d],[m]]:d>m?[[m],[d]]:[[d]]}},{}],143:[function(r,O,B){O.exports=function(d){var m=t(d),p=m.length;if(p<=2)return[];for(var e=new Array(p),f=m[p-1],u=0;u<p;++u){var s=m[u];e[u]=[f,s],f=s}return e};var t=r("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":458}],144:[function(r,O,B){O.exports=function(m,p){try{return t(m,!0)}catch(u){var e=d(m);if(e.length<=p)return[];var f=function(s,l){for(var o=s.length,i=new Array(o),c=0;c<l.length;++c)i[c]=s[l[c]];var n=l.length;for(c=0;c<o;++c)l.indexOf(c)<0&&(i[n++]=s[c]);return i}(m,e);return function(s,l){for(var o=s.length,i=l.length,c=0;c<o;++c)for(var n=s[c],a=0;a<n.length;++a){var g=n[a];if(g<i)n[a]=l[g];else{g-=i;for(var h=0;h<i;++h)g>=l[h]&&(g+=1);n[a]=g}}return s}(t(f,!0),e)}};var t=r("incremental-convex-hull"),d=r("affine-hull")},{"affine-hull":73,"incremental-convex-hull":438}],145:[function(r,O,B){O.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xE7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xE9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xE9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xE3)o.?tom(e|\xE9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],146:[function(r,O,B){O.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],147:[function(r,O,B){O.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],148:[function(r,O,B){O.exports=["normal","italic","oblique"]},{}],149:[function(r,O,B){O.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],150:[function(r,O,B){O.exports={parse:r("./parse"),stringify:r("./stringify")}},{"./parse":152,"./stringify":153}],151:[function(r,O,B){var t=r("css-font-size-keywords");O.exports={isSize:function(d){return/^[\d\.]/.test(d)||d.indexOf("/")!==-1||t.indexOf(d)!==-1}}},{"css-font-size-keywords":146}],152:[function(r,O,B){var t=r("unquote"),d=r("css-global-keywords"),m=r("css-system-font-keywords"),p=r("css-font-weight-keywords"),e=r("css-font-style-keywords"),f=r("css-font-stretch-keywords"),u=r("string-split-by"),s=r("./lib/util").isSize;O.exports=o;var l=o.cache={};function o(c){if(typeof c!="string")throw new Error("Font argument must be a string.");if(l[c])return l[c];if(c==="")throw new Error("Cannot parse an empty string.");if(m.indexOf(c)!==-1)return l[c]={system:c};for(var n,a={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},g=u(c,/\s+/);n=g.shift();){if(d.indexOf(n)!==-1)return["style","variant","weight","stretch"].forEach(function(y){a[y]=n}),l[c]=a;if(e.indexOf(n)===-1)if(n!=="normal"&&n!=="small-caps")if(f.indexOf(n)===-1){if(p.indexOf(n)===-1){if(s(n)){var h=u(n,"/");if(a.size=h[0],h[1]!=null?a.lineHeight=i(h[1]):g[0]==="/"&&(g.shift(),a.lineHeight=i(g.shift())),!g.length)throw new Error("Missing required font-family.");return a.family=u(g.join(" "),/\s*,\s*/).map(t),l[c]=a}throw new Error("Unknown or unsupported font token: "+n)}a.weight=n}else a.stretch=n;else a.variant=n;else a.style=n}throw new Error("Missing required font-size.")}function i(c){var n=parseFloat(c);return n.toString()===c?n:c}},{"./lib/util":151,"css-font-stretch-keywords":147,"css-font-style-keywords":148,"css-font-weight-keywords":149,"css-global-keywords":154,"css-system-font-keywords":155,"string-split-by":574,unquote:604}],153:[function(r,O,B){var t=r("pick-by-alias"),d=r("./lib/util").isSize,m=n(r("css-global-keywords")),p=n(r("css-system-font-keywords")),e=n(r("css-font-weight-keywords")),f=n(r("css-font-style-keywords")),u=n(r("css-font-stretch-keywords")),s={normal:1,"small-caps":1},l={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},o="1rem",i="serif";function c(a,g){if(a&&!g[a]&&!m[a])throw Error("Unknown keyword `"+a+"`");return a}function n(a){for(var g={},h=0;h<a.length;h++)g[a[h]]=1;return g}O.exports=function(a){if((a=t(a,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"})).system)return a.system&&c(a.system,p),a.system;if(c(a.style,f),c(a.variant,s),c(a.weight,e),c(a.stretch,u),a.size==null&&(a.size=o),typeof a.size=="number"&&(a.size+="px"),!d)throw Error("Bad size value `"+a.size+"`");a.family||(a.family=i),Array.isArray(a.family)&&(a.family.length||(a.family=[i]),a.family=a.family.map(function(h){return l[h]?h:'"'+h+'"'}).join(", "));var g=[];return g.push(a.style),a.variant!==a.style&&g.push(a.variant),a.weight!==a.variant&&a.weight!==a.style&&g.push(a.weight),a.stretch!==a.weight&&a.stretch!==a.variant&&a.stretch!==a.style&&g.push(a.stretch),g.push(a.size+(a.lineHeight==null||a.lineHeight==="normal"||a.lineHeight+""=="1"?"":"/"+a.lineHeight)),g.push(a.family),g.filter(Boolean).join(" ")}},{"./lib/util":151,"css-font-stretch-keywords":147,"css-font-style-keywords":148,"css-font-weight-keywords":149,"css-global-keywords":154,"css-system-font-keywords":155,"pick-by-alias":485}],154:[function(r,O,B){O.exports=["inherit","initial","unset"]},{}],155:[function(r,O,B){O.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],156:[function(r,O,B){O.exports=function(t,d,m,p,e,f){var u=e-1,s=e*e,l=u*u,o=(1+2*e)*l,i=e*l,c=s*(3-2*e),n=s*u;if(t.length){f||(f=new Array(t.length));for(var a=t.length-1;a>=0;--a)f[a]=o*t[a]+i*d[a]+c*m[a]+n*p[a];return f}return o*t+i*d+c*m+n*p},O.exports.derivative=function(t,d,m,p,e,f){var u=6*e*e-6*e,s=3*e*e-4*e+1,l=-6*e*e+6*e,o=3*e*e-2*e;if(t.length){f||(f=new Array(t.length));for(var i=t.length-1;i>=0;--i)f[i]=u*t[i]+s*d[i]+l*m[i]+o*p[i];return f}return u*t+s*d+l*m[i]+o*p}},{}],157:[function(r,O,B){var t,d=r("type/value/is"),m=r("type/value/ensure"),p=r("type/plain-function/ensure"),e=r("es5-ext/object/copy"),f=r("es5-ext/object/normalize-options"),u=r("es5-ext/object/map"),s=Function.prototype.bind,l=Object.defineProperty,o=Object.prototype.hasOwnProperty;t=function(i,c,n){var a,g=m(c)&&p(c.value);return delete(a=e(c)).writable,delete a.value,a.get=function(){return!n.overwriteDefinition&&o.call(this,i)?g:(c.value=s.call(g,n.resolveContext?n.resolveContext(this):this),l(this,i,c),this[i])},a},O.exports=function(i){var c=f(arguments[1]);return d(c.resolveContext)&&p(c.resolveContext),u(i,function(n,a){return t(a,n,c)})}},{"es5-ext/object/copy":202,"es5-ext/object/map":210,"es5-ext/object/normalize-options":211,"type/plain-function/ensure":595,"type/value/ensure":599,"type/value/is":600}],158:[function(r,O,B){var t=r("type/value/is"),d=r("type/plain-function/is"),m=r("es5-ext/object/assign"),p=r("es5-ext/object/normalize-options"),e=r("es5-ext/string/#/contains");(O.exports=function(f,u){var s,l,o,i,c;return arguments.length<2||typeof f!="string"?(i=u,u=f,f=null):i=arguments[2],t(f)?(s=e.call(f,"c"),l=e.call(f,"e"),o=e.call(f,"w")):(s=o=!0,l=!1),c={value:u,configurable:s,enumerable:l,writable:o},i?m(p(i),c):c}).gs=function(f,u,s){var l,o,i,c;return typeof f!="string"?(i=s,s=u,u=f,f=null):i=arguments[3],t(u)?d(u)?t(s)?d(s)||(i=s,s=void 0):s=void 0:(i=u,u=s=void 0):u=void 0,t(f)?(l=e.call(f,"c"),o=e.call(f,"e")):(l=!0,o=!1),c={get:u,set:s,configurable:l,enumerable:o},i?m(p(i),c):c}},{"es5-ext/object/assign":199,"es5-ext/object/normalize-options":211,"es5-ext/string/#/contains":218,"type/plain-function/is":596,"type/value/is":600}],159:[function(r,O,B){(function(t,d){d(typeof B=="object"&&O!==void 0?B:t.d3=t.d3||{})})(this,function(t){function d(M,P){return M<P?-1:M>P?1:M>=P?0:NaN}function m(M){var P;return M.length===1&&(P=M,M=function(D,N){return d(P(D),N)}),{left:function(D,N,U,q){for(U==null&&(U=0),q==null&&(q=D.length);U<q;){var X=U+q>>>1;M(D[X],N)<0?U=X+1:q=X}return U},right:function(D,N,U,q){for(U==null&&(U=0),q==null&&(q=D.length);U<q;){var X=U+q>>>1;M(D[X],N)>0?q=X:U=X+1}return U}}}var p=m(d),e=p.right,f=p.left;function u(M,P){return[M,P]}function s(M){return M===null?NaN:+M}function l(M,P){var D,N,U=M.length,q=0,X=-1,K=0,Z=0;if(P==null)for(;++X<U;)isNaN(D=s(M[X]))||(Z+=(N=D-K)*(D-(K+=N/++q)));else for(;++X<U;)isNaN(D=s(P(M[X],X,M)))||(Z+=(N=D-K)*(D-(K+=N/++q)));if(q>1)return Z/(q-1)}function o(M,P){var D=l(M,P);return D&&Math.sqrt(D)}function i(M,P){var D,N,U,q=M.length,X=-1;if(P==null){for(;++X<q;)if((D=M[X])!=null&&D>=D)for(N=U=D;++X<q;)(D=M[X])!=null&&(N>D&&(N=D),U<D&&(U=D))}else for(;++X<q;)if((D=P(M[X],X,M))!=null&&D>=D)for(N=U=D;++X<q;)(D=P(M[X],X,M))!=null&&(N>D&&(N=D),U<D&&(U=D));return[N,U]}var c=Array.prototype,n=c.slice,a=c.map;function g(M){return function(){return M}}function h(M){return M}function y(M,P,D){M=+M,P=+P,D=(U=arguments.length)<2?(P=M,M=0,1):U<3?1:+D;for(var N=-1,U=0|Math.max(0,Math.ceil((P-M)/D)),q=new Array(U);++N<U;)q[N]=M+N*D;return q}var v=Math.sqrt(50),_=Math.sqrt(10),x=Math.sqrt(2);function T(M,P,D){var N=(P-M)/Math.max(0,D),U=Math.floor(Math.log(N)/Math.LN10),q=N/Math.pow(10,U);return U>=0?(q>=v?10:q>=_?5:q>=x?2:1)*Math.pow(10,U):-Math.pow(10,-U)/(q>=v?10:q>=_?5:q>=x?2:1)}function A(M,P,D){var N=Math.abs(P-M)/Math.max(0,D),U=Math.pow(10,Math.floor(Math.log(N)/Math.LN10)),q=N/U;return q>=v?U*=10:q>=_?U*=5:q>=x&&(U*=2),P<M?-U:U}function S(M){return Math.ceil(Math.log(M.length)/Math.LN2)+1}function w(M,P,D){if(D==null&&(D=s),N=M.length){if((P=+P)<=0||N<2)return+D(M[0],0,M);if(P>=1)return+D(M[N-1],N-1,M);var N,U=(N-1)*P,q=Math.floor(U),X=+D(M[q],q,M);return X+(+D(M[q+1],q+1,M)-X)*(U-q)}}function C(M,P){var D,N,U=M.length,q=-1;if(P==null){for(;++q<U;)if((D=M[q])!=null&&D>=D)for(N=D;++q<U;)(D=M[q])!=null&&N>D&&(N=D)}else for(;++q<U;)if((D=P(M[q],q,M))!=null&&D>=D)for(N=D;++q<U;)(D=P(M[q],q,M))!=null&&N>D&&(N=D);return N}function k(M){if(!(U=M.length))return[];for(var P=-1,D=C(M,L),N=new Array(D);++P<D;)for(var U,q=-1,X=N[P]=new Array(U);++q<U;)X[q]=M[q][P];return N}function L(M){return M.length}t.bisect=e,t.bisectRight=e,t.bisectLeft=f,t.ascending=d,t.bisector=m,t.cross=function(M,P,D){var N,U,q,X,K=M.length,Z=P.length,H=new Array(K*Z);for(D==null&&(D=u),N=q=0;N<K;++N)for(X=M[N],U=0;U<Z;++U,++q)H[q]=D(X,P[U]);return H},t.descending=function(M,P){return P<M?-1:P>M?1:P>=M?0:NaN},t.deviation=o,t.extent=i,t.histogram=function(){var M=h,P=i,D=S;function N(U){var q,X,K=U.length,Z=new Array(K);for(q=0;q<K;++q)Z[q]=M(U[q],q,U);var H=P(Z),Y=H[0],$=H[1],z=D(Z,Y,$);Array.isArray(z)||(z=A(Y,$,z),z=y(Math.ceil(Y/z)*z,$,z));for(var j=z.length;z[0]<=Y;)z.shift(),--j;for(;z[j-1]>$;)z.pop(),--j;var W,ee=new Array(j+1);for(q=0;q<=j;++q)(W=ee[q]=[]).x0=q>0?z[q-1]:Y,W.x1=q<j?z[q]:$;for(q=0;q<K;++q)Y<=(X=Z[q])&&X<=$&&ee[e(z,X,0,j)].push(U[q]);return ee}return N.value=function(U){return arguments.length?(M=typeof U=="function"?U:g(U),N):M},N.domain=function(U){return arguments.length?(P=typeof U=="function"?U:g([U[0],U[1]]),N):P},N.thresholds=function(U){return arguments.length?(D=typeof U=="function"?U:Array.isArray(U)?g(n.call(U)):g(U),N):D},N},t.thresholdFreedmanDiaconis=function(M,P,D){return M=a.call(M,s).sort(d),Math.ceil((D-P)/(2*(w(M,.75)-w(M,.25))*Math.pow(M.length,-1/3)))},t.thresholdScott=function(M,P,D){return Math.ceil((D-P)/(3.5*o(M)*Math.pow(M.length,-1/3)))},t.thresholdSturges=S,t.max=function(M,P){var D,N,U=M.length,q=-1;if(P==null){for(;++q<U;)if((D=M[q])!=null&&D>=D)for(N=D;++q<U;)(D=M[q])!=null&&D>N&&(N=D)}else for(;++q<U;)if((D=P(M[q],q,M))!=null&&D>=D)for(N=D;++q<U;)(D=P(M[q],q,M))!=null&&D>N&&(N=D);return N},t.mean=function(M,P){var D,N=M.length,U=N,q=-1,X=0;if(P==null)for(;++q<N;)isNaN(D=s(M[q]))?--U:X+=D;else for(;++q<N;)isNaN(D=s(P(M[q],q,M)))?--U:X+=D;if(U)return X/U},t.median=function(M,P){var D,N=M.length,U=-1,q=[];if(P==null)for(;++U<N;)isNaN(D=s(M[U]))||q.push(D);else for(;++U<N;)isNaN(D=s(P(M[U],U,M)))||q.push(D);return w(q.sort(d),.5)},t.merge=function(M){for(var P,D,N,U=M.length,q=-1,X=0;++q<U;)X+=M[q].length;for(D=new Array(X);--U>=0;)for(P=(N=M[U]).length;--P>=0;)D[--X]=N[P];return D},t.min=C,t.pairs=function(M,P){P==null&&(P=u);for(var D=0,N=M.length-1,U=M[0],q=new Array(N<0?0:N);D<N;)q[D]=P(U,U=M[++D]);return q},t.permute=function(M,P){for(var D=P.length,N=new Array(D);D--;)N[D]=M[P[D]];return N},t.quantile=w,t.range=y,t.scan=function(M,P){if(D=M.length){var D,N,U=0,q=0,X=M[q];for(P==null&&(P=d);++U<D;)(P(N=M[U],X)<0||P(X,X)!==0)&&(X=N,q=U);return P(X,X)===0?q:void 0}},t.shuffle=function(M,P,D){for(var N,U,q=(D==null?M.length:D)-(P=P==null?0:+P);q;)U=Math.random()*q--|0,N=M[q+P],M[q+P]=M[U+P],M[U+P]=N;return M},t.sum=function(M,P){var D,N=M.length,U=-1,q=0;if(P==null)for(;++U<N;)(D=+M[U])&&(q+=D);else for(;++U<N;)(D=+P(M[U],U,M))&&(q+=D);return q},t.ticks=function(M,P,D){var N,U,q,X,K=-1;if(D=+D,(M=+M)==(P=+P)&&D>0)return[M];if((N=P<M)&&(U=M,M=P,P=U),(X=T(M,P,D))===0||!isFinite(X))return[];if(X>0)for(M=Math.ceil(M/X),P=Math.floor(P/X),q=new Array(U=Math.ceil(P-M+1));++K<U;)q[K]=(M+K)*X;else for(M=Math.floor(M*X),P=Math.ceil(P*X),q=new Array(U=Math.ceil(M-P+1));++K<U;)q[K]=(M-K)/X;return N&&q.reverse(),q},t.tickIncrement=T,t.tickStep=A,t.transpose=k,t.variance=l,t.zip=function(){return k(arguments)},Object.defineProperty(t,"__esModule",{value:!0})})},{}],160:[function(r,O,B){(function(t,d){d(typeof B=="object"&&O!==void 0?B:t.d3=t.d3||{})})(this,function(t){function d(){}function m(i,c){var n=new d;if(i instanceof d)i.each(function(v,_){n.set(_,v)});else if(Array.isArray(i)){var a,g=-1,h=i.length;if(c==null)for(;++g<h;)n.set(g,i[g]);else for(;++g<h;)n.set(c(a=i[g],g,i),a)}else if(i)for(var y in i)n.set(y,i[y]);return n}function p(){return{}}function e(i,c,n){i[c]=n}function f(){return m()}function u(i,c,n){i.set(c,n)}function s(){}d.prototype=m.prototype={constructor:d,has:function(i){return"$"+i in this},get:function(i){return this["$"+i]},set:function(i,c){return this["$"+i]=c,this},remove:function(i){var c="$"+i;return c in this&&delete this[c]},clear:function(){for(var i in this)i[0]==="$"&&delete this[i]},keys:function(){var i=[];for(var c in this)c[0]==="$"&&i.push(c.slice(1));return i},values:function(){var i=[];for(var c in this)c[0]==="$"&&i.push(this[c]);return i},entries:function(){var i=[];for(var c in this)c[0]==="$"&&i.push({key:c.slice(1),value:this[c]});return i},size:function(){var i=0;for(var c in this)c[0]==="$"&&++i;return i},empty:function(){for(var i in this)if(i[0]==="$")return!1;return!0},each:function(i){for(var c in this)c[0]==="$"&&i(this[c],c.slice(1),this)}};var l=m.prototype;function o(i,c){var n=new s;if(i instanceof s)i.each(function(h){n.add(h)});else if(i){var a=-1,g=i.length;if(c==null)for(;++a<g;)n.add(i[a]);else for(;++a<g;)n.add(c(i[a],a,i))}return n}s.prototype=o.prototype={constructor:s,has:l.has,add:function(i){return this["$"+(i+="")]=i,this},remove:l.remove,clear:l.clear,values:l.keys,size:l.size,empty:l.empty,each:l.each},t.nest=function(){var i,c,n,a=[],g=[];function h(y,v,_,x){if(v>=a.length)return i!=null&&y.sort(i),c!=null?c(y):y;for(var T,A,S,w=-1,C=y.length,k=a[v++],L=m(),M=_();++w<C;)(S=L.get(T=k(A=y[w])+""))?S.push(A):L.set(T,[A]);return L.each(function(P,D){x(M,D,h(P,v,_,x))}),M}return n={object:function(y){return h(y,0,p,e)},map:function(y){return h(y,0,f,u)},entries:function(y){return function v(_,x){if(++x>a.length)return _;var T,A=g[x-1];return c!=null&&x>=a.length?T=_.entries():(T=[],_.each(function(S,w){T.push({key:w,values:v(S,x)})})),A!=null?T.sort(function(S,w){return A(S.key,w.key)}):T}(h(y,0,f,u),0)},key:function(y){return a.push(y),n},sortKeys:function(y){return g[a.length-1]=y,n},sortValues:function(y){return i=y,n},rollup:function(y){return c=y,n}}},t.set=o,t.map=m,t.keys=function(i){var c=[];for(var n in i)c.push(n);return c},t.values=function(i){var c=[];for(var n in i)c.push(i[n]);return c},t.entries=function(i){var c=[];for(var n in i)c.push({key:n,value:i[n]});return c},Object.defineProperty(t,"__esModule",{value:!0})})},{}],161:[function(r,O,B){(function(t,d){d(typeof B=="object"&&O!==void 0?B:(t=t||self).d3=t.d3||{})})(this,function(t){function d(ce,ge,we){ce.prototype=ge.prototype=we,we.constructor=ce}function m(ce,ge){var we=Object.create(ce.prototype);for(var Me in ge)we[Me]=ge[Me];return we}function p(){}var e="\\s*([+-]?\\d+)\\s*",f="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",u="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",s=/^#([0-9a-f]{3,8})$/,l=new RegExp("^rgb\\("+[e,e,e]+"\\)$"),o=new RegExp("^rgb\\("+[u,u,u]+"\\)$"),i=new RegExp("^rgba\\("+[e,e,e,f]+"\\)$"),c=new RegExp("^rgba\\("+[u,u,u,f]+"\\)$"),n=new RegExp("^hsl\\("+[f,u,u]+"\\)$"),a=new RegExp("^hsla\\("+[f,u,u,f]+"\\)$"),g={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function h(){return this.rgb().formatHex()}function y(){return this.rgb().formatRgb()}function v(ce){var ge,we;return ce=(ce+"").trim().toLowerCase(),(ge=s.exec(ce))?(we=ge[1].length,ge=parseInt(ge[1],16),we===6?_(ge):we===3?new S(ge>>8&15|ge>>4&240,ge>>4&15|240&ge,(15&ge)<<4|15&ge,1):we===8?x(ge>>24&255,ge>>16&255,ge>>8&255,(255&ge)/255):we===4?x(ge>>12&15|ge>>8&240,ge>>8&15|ge>>4&240,ge>>4&15|240&ge,((15&ge)<<4|15&ge)/255):null):(ge=l.exec(ce))?new S(ge[1],ge[2],ge[3],1):(ge=o.exec(ce))?new S(255*ge[1]/100,255*ge[2]/100,255*ge[3]/100,1):(ge=i.exec(ce))?x(ge[1],ge[2],ge[3],ge[4]):(ge=c.exec(ce))?x(255*ge[1]/100,255*ge[2]/100,255*ge[3]/100,ge[4]):(ge=n.exec(ce))?L(ge[1],ge[2]/100,ge[3]/100,1):(ge=a.exec(ce))?L(ge[1],ge[2]/100,ge[3]/100,ge[4]):g.hasOwnProperty(ce)?_(g[ce]):ce==="transparent"?new S(NaN,NaN,NaN,0):null}function _(ce){return new S(ce>>16&255,ce>>8&255,255&ce,1)}function x(ce,ge,we,Me){return Me<=0&&(ce=ge=we=NaN),new S(ce,ge,we,Me)}function T(ce){return ce instanceof p||(ce=v(ce)),ce?new S((ce=ce.rgb()).r,ce.g,ce.b,ce.opacity):new S}function A(ce,ge,we,Me){return arguments.length===1?T(ce):new S(ce,ge,we,Me==null?1:Me)}function S(ce,ge,we,Me){this.r=+ce,this.g=+ge,this.b=+we,this.opacity=+Me}function w(){return"#"+k(this.r)+k(this.g)+k(this.b)}function C(){var ce=this.opacity;return((ce=isNaN(ce)?1:Math.max(0,Math.min(1,ce)))===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(ce===1?")":", "+ce+")")}function k(ce){return((ce=Math.max(0,Math.min(255,Math.round(ce)||0)))<16?"0":"")+ce.toString(16)}function L(ce,ge,we,Me){return Me<=0?ce=ge=we=NaN:we<=0||we>=1?ce=ge=NaN:ge<=0&&(ce=NaN),new D(ce,ge,we,Me)}function M(ce){if(ce instanceof D)return new D(ce.h,ce.s,ce.l,ce.opacity);if(ce instanceof p||(ce=v(ce)),!ce)return new D;if(ce instanceof D)return ce;var ge=(ce=ce.rgb()).r/255,we=ce.g/255,Me=ce.b/255,Se=Math.min(ge,we,Me),ze=Math.max(ge,we,Me),Fe=NaN,Ye=ze-Se,rt=(ze+Se)/2;return Ye?(Fe=ge===ze?(we-Me)/Ye+6*(we<Me):we===ze?(Me-ge)/Ye+2:(ge-we)/Ye+4,Ye/=rt<.5?ze+Se:2-ze-Se,Fe*=60):Ye=rt>0&&rt<1?0:Fe,new D(Fe,Ye,rt,ce.opacity)}function P(ce,ge,we,Me){return arguments.length===1?M(ce):new D(ce,ge,we,Me==null?1:Me)}function D(ce,ge,we,Me){this.h=+ce,this.s=+ge,this.l=+we,this.opacity=+Me}function N(ce,ge,we){return 255*(ce<60?ge+(we-ge)*ce/60:ce<180?we:ce<240?ge+(we-ge)*(240-ce)/60:ge)}d(p,v,{copy:function(ce){return Object.assign(new this.constructor,this,ce)},displayable:function(){return this.rgb().displayable()},hex:h,formatHex:h,formatHsl:function(){return M(this).formatHsl()},formatRgb:y,toString:y}),d(S,A,m(p,{brighter:function(ce){return ce=ce==null?1/.7:Math.pow(1/.7,ce),new S(this.r*ce,this.g*ce,this.b*ce,this.opacity)},darker:function(ce){return ce=ce==null?.7:Math.pow(.7,ce),new S(this.r*ce,this.g*ce,this.b*ce,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:w,formatHex:w,formatRgb:C,toString:C})),d(D,P,m(p,{brighter:function(ce){return ce=ce==null?1/.7:Math.pow(1/.7,ce),new D(this.h,this.s,this.l*ce,this.opacity)},darker:function(ce){return ce=ce==null?.7:Math.pow(.7,ce),new D(this.h,this.s,this.l*ce,this.opacity)},rgb:function(){var ce=this.h%360+360*(this.h<0),ge=isNaN(ce)||isNaN(this.s)?0:this.s,we=this.l,Me=we+(we<.5?we:1-we)*ge,Se=2*we-Me;return new S(N(ce>=240?ce-240:ce+120,Se,Me),N(ce,Se,Me),N(ce<120?ce+240:ce-120,Se,Me),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var ce=this.opacity;return((ce=isNaN(ce)?1:Math.max(0,Math.min(1,ce)))===1?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(ce===1?")":", "+ce+")")}}));var U=Math.PI/180,q=180/Math.PI,X=6/29,K=3*X*X;function Z(ce){if(ce instanceof Y)return new Y(ce.l,ce.a,ce.b,ce.opacity);if(ce instanceof Q)return te(ce);ce instanceof S||(ce=T(ce));var ge,we,Me=W(ce.r),Se=W(ce.g),ze=W(ce.b),Fe=$((.2225045*Me+.7168786*Se+.0606169*ze)/1);return Me===Se&&Se===ze?ge=we=Fe:(ge=$((.4360747*Me+.3850649*Se+.1430804*ze)/.96422),we=$((.0139322*Me+.0971045*Se+.7141733*ze)/.82521)),new Y(116*Fe-16,500*(ge-Fe),200*(Fe-we),ce.opacity)}function H(ce,ge,we,Me){return arguments.length===1?Z(ce):new Y(ce,ge,we,Me==null?1:Me)}function Y(ce,ge,we,Me){this.l=+ce,this.a=+ge,this.b=+we,this.opacity=+Me}function $(ce){return ce>.008856451679035631?Math.pow(ce,1/3):ce/K+4/29}function z(ce){return ce>X?ce*ce*ce:K*(ce-4/29)}function j(ce){return 255*(ce<=.0031308?12.92*ce:1.055*Math.pow(ce,1/2.4)-.055)}function W(ce){return(ce/=255)<=.04045?ce/12.92:Math.pow((ce+.055)/1.055,2.4)}function ee(ce){if(ce instanceof Q)return new Q(ce.h,ce.c,ce.l,ce.opacity);if(ce instanceof Y||(ce=Z(ce)),ce.a===0&&ce.b===0)return new Q(NaN,0<ce.l&&ce.l<100?0:NaN,ce.l,ce.opacity);var ge=Math.atan2(ce.b,ce.a)*q;return new Q(ge<0?ge+360:ge,Math.sqrt(ce.a*ce.a+ce.b*ce.b),ce.l,ce.opacity)}function J(ce,ge,we,Me){return arguments.length===1?ee(ce):new Q(ce,ge,we,Me==null?1:Me)}function Q(ce,ge,we,Me){this.h=+ce,this.c=+ge,this.l=+we,this.opacity=+Me}function te(ce){if(isNaN(ce.h))return new Y(ce.l,0,0,ce.opacity);var ge=ce.h*U;return new Y(ce.l,Math.cos(ge)*ce.c,Math.sin(ge)*ce.c,ce.opacity)}d(Y,H,m(p,{brighter:function(ce){return new Y(this.l+18*(ce==null?1:ce),this.a,this.b,this.opacity)},darker:function(ce){return new Y(this.l-18*(ce==null?1:ce),this.a,this.b,this.opacity)},rgb:function(){var ce=(this.l+16)/116,ge=isNaN(this.a)?ce:ce+this.a/500,we=isNaN(this.b)?ce:ce-this.b/200;return new S(j(3.1338561*(ge=.96422*z(ge))-1.6168667*(ce=1*z(ce))-.4906146*(we=.82521*z(we))),j(-.9787684*ge+1.9161415*ce+.033454*we),j(.0719453*ge-.2289914*ce+1.4052427*we),this.opacity)}})),d(Q,J,m(p,{brighter:function(ce){return new Q(this.h,this.c,this.l+18*(ce==null?1:ce),this.opacity)},darker:function(ce){return new Q(this.h,this.c,this.l-18*(ce==null?1:ce),this.opacity)},rgb:function(){return te(this).rgb()}}));var ie=-.14861,ae=1.78277,he=-.29227,se=-.90649,de=1.97294,ue=de*se,ve=de*ae,ke=ae*he-se*ie;function Ee(ce){if(ce instanceof xe)return new xe(ce.h,ce.s,ce.l,ce.opacity);ce instanceof S||(ce=T(ce));var ge=ce.r/255,we=ce.g/255,Me=ce.b/255,Se=(ke*Me+ue*ge-ve*we)/(ke+ue-ve),ze=Me-Se,Fe=(de*(we-Se)-he*ze)/se,Ye=Math.sqrt(Fe*Fe+ze*ze)/(de*Se*(1-Se)),rt=Ye?Math.atan2(Fe,ze)*q-120:NaN;return new xe(rt<0?rt+360:rt,Ye,Se,ce.opacity)}function be(ce,ge,we,Me){return arguments.length===1?Ee(ce):new xe(ce,ge,we,Me==null?1:Me)}function xe(ce,ge,we,Me){this.h=+ce,this.s=+ge,this.l=+we,this.opacity=+Me}d(xe,be,m(p,{brighter:function(ce){return ce=ce==null?1/.7:Math.pow(1/.7,ce),new xe(this.h,this.s,this.l*ce,this.opacity)},darker:function(ce){return ce=ce==null?.7:Math.pow(.7,ce),new xe(this.h,this.s,this.l*ce,this.opacity)},rgb:function(){var ce=isNaN(this.h)?0:(this.h+120)*U,ge=+this.l,we=isNaN(this.s)?0:this.s*ge*(1-ge),Me=Math.cos(ce),Se=Math.sin(ce);return new S(255*(ge+we*(ie*Me+ae*Se)),255*(ge+we*(he*Me+se*Se)),255*(ge+we*(de*Me)),this.opacity)}})),t.color=v,t.cubehelix=be,t.gray=function(ce,ge){return new Y(ce,0,0,ge==null?1:ge)},t.hcl=J,t.hsl=P,t.lab=H,t.lch=function(ce,ge,we,Me){return arguments.length===1?ee(ce):new Q(we,ge,ce,Me==null?1:Me)},t.rgb=A,Object.defineProperty(t,"__esModule",{value:!0})})},{}],162:[function(r,O,B){(function(t,d){d(typeof B=="object"&&O!==void 0?B:(t=t||self).d3=t.d3||{})})(this,function(t){var d={value:function(){}};function m(){for(var s,l=0,o=arguments.length,i={};l<o;++l){if(!(s=arguments[l]+"")||s in i||/[\s.]/.test(s))throw new Error("illegal type: "+s);i[s]=[]}return new p(i)}function p(s){this._=s}function e(s,l){return s.trim().split(/^|\s+/).map(function(o){var i="",c=o.indexOf(".");if(c>=0&&(i=o.slice(c+1),o=o.slice(0,c)),o&&!l.hasOwnProperty(o))throw new Error("unknown type: "+o);return{type:o,name:i}})}function f(s,l){for(var o,i=0,c=s.length;i<c;++i)if((o=s[i]).name===l)return o.value}function u(s,l,o){for(var i=0,c=s.length;i<c;++i)if(s[i].name===l){s[i]=d,s=s.slice(0,i).concat(s.slice(i+1));break}return o!=null&&s.push({name:l,value:o}),s}p.prototype=m.prototype={constructor:p,on:function(s,l){var o,i=this._,c=e(s+"",i),n=-1,a=c.length;if(!(arguments.length<2)){if(l!=null&&typeof l!="function")throw new Error("invalid callback: "+l);for(;++n<a;)if(o=(s=c[n]).type)i[o]=u(i[o],s.name,l);else if(l==null)for(o in i)i[o]=u(i[o],s.name,null);return this}for(;++n<a;)if((o=(s=c[n]).type)&&(o=f(i[o],s.name)))return o},copy:function(){var s={},l=this._;for(var o in l)s[o]=l[o].slice();return new p(s)},call:function(s,l){if((o=arguments.length-2)>0)for(var o,i,c=new Array(o),n=0;n<o;++n)c[n]=arguments[n+2];if(!this._.hasOwnProperty(s))throw new Error("unknown type: "+s);for(n=0,o=(i=this._[s]).length;n<o;++n)i[n].value.apply(l,c)},apply:function(s,l,o){if(!this._.hasOwnProperty(s))throw new Error("unknown type: "+s);for(var i=this._[s],c=0,n=i.length;c<n;++c)i[c].value.apply(l,o)}},t.dispatch=m,Object.defineProperty(t,"__esModule",{value:!0})})},{}],163:[function(r,O,B){(function(t,d){typeof B=="object"&&O!==void 0?d(B,r("d3-quadtree"),r("d3-collection"),r("d3-dispatch"),r("d3-timer")):d(t.d3=t.d3||{},t.d3,t.d3,t.d3,t.d3)})(this,function(t,d,m,p,e){function f(g){return function(){return g}}function u(){return 1e-6*(Math.random()-.5)}function s(g){return g.x+g.vx}function l(g){return g.y+g.vy}function o(g){return g.index}function i(g,h){var y=g.get(h);if(!y)throw new Error("missing: "+h);return y}function c(g){return g.x}function n(g){return g.y}var a=Math.PI*(3-Math.sqrt(5));t.forceCenter=function(g,h){var y;function v(){var _,x,T=y.length,A=0,S=0;for(_=0;_<T;++_)A+=(x=y[_]).x,S+=x.y;for(A=A/T-g,S=S/T-h,_=0;_<T;++_)(x=y[_]).x-=A,x.y-=S}return g==null&&(g=0),h==null&&(h=0),v.initialize=function(_){y=_},v.x=function(_){return arguments.length?(g=+_,v):g},v.y=function(_){return arguments.length?(h=+_,v):h},v},t.forceCollide=function(g){var h,y,v=1,_=1;function x(){for(var S,w,C,k,L,M,P,D=h.length,N=0;N<_;++N)for(w=d.quadtree(h,s,l).visitAfter(T),S=0;S<D;++S)C=h[S],M=y[C.index],P=M*M,k=C.x+C.vx,L=C.y+C.vy,w.visit(U);function U(q,X,K,Z,H){var Y=q.data,$=q.r,z=M+$;if(!Y)return X>k+z||Z<k-z||K>L+z||H<L-z;if(Y.index>C.index){var j=k-Y.x-Y.vx,W=L-Y.y-Y.vy,ee=j*j+W*W;ee<z*z&&(j===0&&(ee+=(j=u())*j),W===0&&(ee+=(W=u())*W),ee=(z-(ee=Math.sqrt(ee)))/ee*v,C.vx+=(j*=ee)*(z=($*=$)/(P+$)),C.vy+=(W*=ee)*z,Y.vx-=j*(z=1-z),Y.vy-=W*z)}}}function T(S){if(S.data)return S.r=y[S.data.index];for(var w=S.r=0;w<4;++w)S[w]&&S[w].r>S.r&&(S.r=S[w].r)}function A(){if(h){var S,w,C=h.length;for(y=new Array(C),S=0;S<C;++S)w=h[S],y[w.index]=+g(w,S,h)}}return typeof g!="function"&&(g=f(g==null?1:+g)),x.initialize=function(S){h=S,A()},x.iterations=function(S){return arguments.length?(_=+S,x):_},x.strength=function(S){return arguments.length?(v=+S,x):v},x.radius=function(S){return arguments.length?(g=typeof S=="function"?S:f(+S),A(),x):g},x},t.forceLink=function(g){var h,y,v,_,x,T=o,A=function(P){return 1/Math.min(_[P.source.index],_[P.target.index])},S=f(30),w=1;function C(P){for(var D=0,N=g.length;D<w;++D)for(var U,q,X,K,Z,H,Y,$=0;$<N;++$)q=(U=g[$]).source,K=(X=U.target).x+X.vx-q.x-q.vx||u(),Z=X.y+X.vy-q.y-q.vy||u(),K*=H=((H=Math.sqrt(K*K+Z*Z))-y[$])/H*P*h[$],Z*=H,X.vx-=K*(Y=x[$]),X.vy-=Z*Y,q.vx+=K*(Y=1-Y),q.vy+=Z*Y}function k(){if(v){var P,D,N=v.length,U=g.length,q=m.map(v,T);for(P=0,_=new Array(N);P<U;++P)(D=g[P]).index=P,typeof D.source!="object"&&(D.source=i(q,D.source)),typeof D.target!="object"&&(D.target=i(q,D.target)),_[D.source.index]=(_[D.source.index]||0)+1,_[D.target.index]=(_[D.target.index]||0)+1;for(P=0,x=new Array(U);P<U;++P)D=g[P],x[P]=_[D.source.index]/(_[D.source.index]+_[D.target.index]);h=new Array(U),L(),y=new Array(U),M()}}function L(){if(v)for(var P=0,D=g.length;P<D;++P)h[P]=+A(g[P],P,g)}function M(){if(v)for(var P=0,D=g.length;P<D;++P)y[P]=+S(g[P],P,g)}return g==null&&(g=[]),C.initialize=function(P){v=P,k()},C.links=function(P){return arguments.length?(g=P,k(),C):g},C.id=function(P){return arguments.length?(T=P,C):T},C.iterations=function(P){return arguments.length?(w=+P,C):w},C.strength=function(P){return arguments.length?(A=typeof P=="function"?P:f(+P),L(),C):A},C.distance=function(P){return arguments.length?(S=typeof P=="function"?P:f(+P),M(),C):S},C},t.forceManyBody=function(){var g,h,y,v,_=f(-30),x=1,T=1/0,A=.81;function S(L){var M,P=g.length,D=d.quadtree(g,c,n).visitAfter(C);for(y=L,M=0;M<P;++M)h=g[M],D.visit(k)}function w(){if(g){var L,M,P=g.length;for(v=new Array(P),L=0;L<P;++L)M=g[L],v[M.index]=+_(M,L,g)}}function C(L){var M,P,D,N,U,q=0,X=0;if(L.length){for(D=N=U=0;U<4;++U)(M=L[U])&&(P=Math.abs(M.value))&&(q+=M.value,X+=P,D+=P*M.x,N+=P*M.y);L.x=D/X,L.y=N/X}else{(M=L).x=M.data.x,M.y=M.data.y;do q+=v[M.data.index];while(M=M.next)}L.value=q}function k(L,M,P,D){if(!L.value)return!0;var N=L.x-h.x,U=L.y-h.y,q=D-M,X=N*N+U*U;if(q*q/A<X)return X<T&&(N===0&&(X+=(N=u())*N),U===0&&(X+=(U=u())*U),X<x&&(X=Math.sqrt(x*X)),h.vx+=N*L.value*y/X,h.vy+=U*L.value*y/X),!0;if(!(L.length||X>=T)){(L.data!==h||L.next)&&(N===0&&(X+=(N=u())*N),U===0&&(X+=(U=u())*U),X<x&&(X=Math.sqrt(x*X)));do L.data!==h&&(q=v[L.data.index]*y/X,h.vx+=N*q,h.vy+=U*q);while(L=L.next)}}return S.initialize=function(L){g=L,w()},S.strength=function(L){return arguments.length?(_=typeof L=="function"?L:f(+L),w(),S):_},S.distanceMin=function(L){return arguments.length?(x=L*L,S):Math.sqrt(x)},S.distanceMax=function(L){return arguments.length?(T=L*L,S):Math.sqrt(T)},S.theta=function(L){return arguments.length?(A=L*L,S):Math.sqrt(A)},S},t.forceRadial=function(g,h,y){var v,_,x,T=f(.1);function A(w){for(var C=0,k=v.length;C<k;++C){var L=v[C],M=L.x-h||1e-6,P=L.y-y||1e-6,D=Math.sqrt(M*M+P*P),N=(x[C]-D)*_[C]*w/D;L.vx+=M*N,L.vy+=P*N}}function S(){if(v){var w,C=v.length;for(_=new Array(C),x=new Array(C),w=0;w<C;++w)x[w]=+g(v[w],w,v),_[w]=isNaN(x[w])?0:+T(v[w],w,v)}}return typeof g!="function"&&(g=f(+g)),h==null&&(h=0),y==null&&(y=0),A.initialize=function(w){v=w,S()},A.strength=function(w){return arguments.length?(T=typeof w=="function"?w:f(+w),S(),A):T},A.radius=function(w){return arguments.length?(g=typeof w=="function"?w:f(+w),S(),A):g},A.x=function(w){return arguments.length?(h=+w,A):h},A.y=function(w){return arguments.length?(y=+w,A):y},A},t.forceSimulation=function(g){var h,y=1,v=.001,_=1-Math.pow(v,1/300),x=0,T=.6,A=m.map(),S=e.timer(C),w=p.dispatch("tick","end");function C(){k(),w.call("tick",h),y<v&&(S.stop(),w.call("end",h))}function k(P){var D,N,U=g.length;P===void 0&&(P=1);for(var q=0;q<P;++q)for(y+=(x-y)*_,A.each(function(X){X(y)}),D=0;D<U;++D)(N=g[D]).fx==null?N.x+=N.vx*=T:(N.x=N.fx,N.vx=0),N.fy==null?N.y+=N.vy*=T:(N.y=N.fy,N.vy=0);return h}function L(){for(var P,D=0,N=g.length;D<N;++D){if((P=g[D]).index=D,P.fx!=null&&(P.x=P.fx),P.fy!=null&&(P.y=P.fy),isNaN(P.x)||isNaN(P.y)){var U=10*Math.sqrt(D),q=D*a;P.x=U*Math.cos(q),P.y=U*Math.sin(q)}(isNaN(P.vx)||isNaN(P.vy))&&(P.vx=P.vy=0)}}function M(P){return P.initialize&&P.initialize(g),P}return g==null&&(g=[]),L(),h={tick:k,restart:function(){return S.restart(C),h},stop:function(){return S.stop(),h},nodes:function(P){return arguments.length?(g=P,L(),A.each(M),h):g},alpha:function(P){return arguments.length?(y=+P,h):y},alphaMin:function(P){return arguments.length?(v=+P,h):v},alphaDecay:function(P){return arguments.length?(_=+P,h):+_},alphaTarget:function(P){return arguments.length?(x=+P,h):x},velocityDecay:function(P){return arguments.length?(T=1-P,h):1-T},force:function(P,D){return arguments.length>1?(D==null?A.remove(P):A.set(P,M(D)),h):A.get(P)},find:function(P,D,N){var U,q,X,K,Z,H=0,Y=g.length;for(N==null?N=1/0:N*=N,H=0;H<Y;++H)(X=(U=P-(K=g[H]).x)*U+(q=D-K.y)*q)<N&&(Z=K,N=X);return Z},on:function(P,D){return arguments.length>1?(w.on(P,D),h):w.on(P)}}},t.forceX=function(g){var h,y,v,_=f(.1);function x(A){for(var S,w=0,C=h.length;w<C;++w)(S=h[w]).vx+=(v[w]-S.x)*y[w]*A}function T(){if(h){var A,S=h.length;for(y=new Array(S),v=new Array(S),A=0;A<S;++A)y[A]=isNaN(v[A]=+g(h[A],A,h))?0:+_(h[A],A,h)}}return typeof g!="function"&&(g=f(g==null?0:+g)),x.initialize=function(A){h=A,T()},x.strength=function(A){return arguments.length?(_=typeof A=="function"?A:f(+A),T(),x):_},x.x=function(A){return arguments.length?(g=typeof A=="function"?A:f(+A),T(),x):g},x},t.forceY=function(g){var h,y,v,_=f(.1);function x(A){for(var S,w=0,C=h.length;w<C;++w)(S=h[w]).vy+=(v[w]-S.y)*y[w]*A}function T(){if(h){var A,S=h.length;for(y=new Array(S),v=new Array(S),A=0;A<S;++A)y[A]=isNaN(v[A]=+g(h[A],A,h))?0:+_(h[A],A,h)}}return typeof g!="function"&&(g=f(g==null?0:+g)),x.initialize=function(A){h=A,T()},x.strength=function(A){return arguments.length?(_=typeof A=="function"?A:f(+A),T(),x):_},x.y=function(A){return arguments.length?(g=typeof A=="function"?A:f(+A),T(),x):g},x},Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-collection":160,"d3-dispatch":162,"d3-quadtree":170,"d3-timer":175}],164:[function(r,O,B){(function(t,d){d(typeof B=="object"&&O!==void 0?B:(t=typeof globalThis!="undefined"?globalThis:t||self).d3=t.d3||{})})(this,function(t){function d(h,y){if((v=(h=y?h.toExponential(y-1):h.toExponential()).indexOf("e"))<0)return null;var v,_=h.slice(0,v);return[_.length>1?_[0]+_.slice(2):_,+h.slice(v+1)]}function m(h){return(h=d(Math.abs(h)))?h[1]:NaN}var p,e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function f(h){if(!(y=e.exec(h)))throw new Error("invalid format: "+h);var y;return new u({fill:y[1],align:y[2],sign:y[3],symbol:y[4],zero:y[5],width:y[6],comma:y[7],precision:y[8]&&y[8].slice(1),trim:y[9],type:y[10]})}function u(h){this.fill=h.fill===void 0?" ":h.fill+"",this.align=h.align===void 0?">":h.align+"",this.sign=h.sign===void 0?"-":h.sign+"",this.symbol=h.symbol===void 0?"":h.symbol+"",this.zero=!!h.zero,this.width=h.width===void 0?void 0:+h.width,this.comma=!!h.comma,this.precision=h.precision===void 0?void 0:+h.precision,this.trim=!!h.trim,this.type=h.type===void 0?"":h.type+""}function s(h,y){var v=d(h,y);if(!v)return h+"";var _=v[0],x=v[1];return x<0?"0."+new Array(-x).join("0")+_:_.length>x+1?_.slice(0,x+1)+"."+_.slice(x+1):_+new Array(x-_.length+2).join("0")}f.prototype=u.prototype,u.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,0|this.width))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var l={"%":function(h,y){return(100*h).toFixed(y)},b:function(h){return Math.round(h).toString(2)},c:function(h){return h+""},d:function(h){return Math.abs(h=Math.round(h))>=1e21?h.toLocaleString("en").replace(/,/g,""):h.toString(10)},e:function(h,y){return h.toExponential(y)},f:function(h,y){return h.toFixed(y)},g:function(h,y){return h.toPrecision(y)},o:function(h){return Math.round(h).toString(8)},p:function(h,y){return s(100*h,y)},r:s,s:function(h,y){var v=d(h,y);if(!v)return h+"";var _=v[0],x=v[1],T=x-(p=3*Math.max(-8,Math.min(8,Math.floor(x/3))))+1,A=_.length;return T===A?_:T>A?_+new Array(T-A+1).join("0"):T>0?_.slice(0,T)+"."+_.slice(T):"0."+new Array(1-T).join("0")+d(h,Math.max(0,y+T-1))[0]},X:function(h){return Math.round(h).toString(16).toUpperCase()},x:function(h){return Math.round(h).toString(16)}};function o(h){return h}var i,c=Array.prototype.map,n=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function a(h){var y,v,_=h.grouping===void 0||h.thousands===void 0?o:(y=c.call(h.grouping,Number),v=h.thousands+"",function(M,P){for(var D=M.length,N=[],U=0,q=y[0],X=0;D>0&&q>0&&(X+q+1>P&&(q=Math.max(1,P-X)),N.push(M.substring(D-=q,D+q)),!((X+=q+1)>P));)q=y[U=(U+1)%y.length];return N.reverse().join(v)}),x=h.currency===void 0?"":h.currency[0]+"",T=h.currency===void 0?"":h.currency[1]+"",A=h.decimal===void 0?".":h.decimal+"",S=h.numerals===void 0?o:function(M){return function(P){return P.replace(/[0-9]/g,function(D){return M[+D]})}}(c.call(h.numerals,String)),w=h.percent===void 0?"%":h.percent+"",C=h.minus===void 0?"-":h.minus+"",k=h.nan===void 0?"NaN":h.nan+"";function L(M){var P=(M=f(M)).fill,D=M.align,N=M.sign,U=M.symbol,q=M.zero,X=M.width,K=M.comma,Z=M.precision,H=M.trim,Y=M.type;Y==="n"?(K=!0,Y="g"):l[Y]||(Z===void 0&&(Z=12),H=!0,Y="g"),(q||P==="0"&&D==="=")&&(q=!0,P="0",D="=");var $=U==="$"?x:U==="#"&&/[boxX]/.test(Y)?"0"+Y.toLowerCase():"",z=U==="$"?T:/[%p]/.test(Y)?w:"",j=l[Y],W=/[defgprs%]/.test(Y);function ee(J){var Q,te,ie,ae=$,he=z;if(Y==="c")he=j(J)+he,J="";else{var se=(J=+J)<0||1/J<0;if(J=isNaN(J)?k:j(Math.abs(J),Z),H&&(J=function(ve){e:for(var ke,Ee=ve.length,be=1,xe=-1;be<Ee;++be)switch(ve[be]){case".":xe=ke=be;break;case"0":xe===0&&(xe=be),ke=be;break;default:if(!+ve[be])break e;xe>0&&(xe=0)}return xe>0?ve.slice(0,xe)+ve.slice(ke+1):ve}(J)),se&&+J==0&&N!=="+"&&(se=!1),ae=(se?N==="("?N:C:N==="-"||N==="("?"":N)+ae,he=(Y==="s"?n[8+p/3]:"")+he+(se&&N==="("?")":""),W){for(Q=-1,te=J.length;++Q<te;)if(48>(ie=J.charCodeAt(Q))||ie>57){he=(ie===46?A+J.slice(Q+1):J.slice(Q))+he,J=J.slice(0,Q);break}}}K&&!q&&(J=_(J,1/0));var de=ae.length+J.length+he.length,ue=de<X?new Array(X-de+1).join(P):"";switch(K&&q&&(J=_(ue+J,ue.length?X-he.length:1/0),ue=""),D){case"<":J=ae+J+he+ue;break;case"=":J=ae+ue+J+he;break;case"^":J=ue.slice(0,de=ue.length>>1)+ae+J+he+ue.slice(de);break;default:J=ue+ae+J+he}return S(J)}return Z=Z===void 0?6:/[gprs]/.test(Y)?Math.max(1,Math.min(21,Z)):Math.max(0,Math.min(20,Z)),ee.toString=function(){return M+""},ee}return{format:L,formatPrefix:function(M,P){var D=L(((M=f(M)).type="f",M)),N=3*Math.max(-8,Math.min(8,Math.floor(m(P)/3))),U=Math.pow(10,-N),q=n[8+N/3];return function(X){return D(U*X)+q}}}}function g(h){return i=a(h),t.format=i.format,t.formatPrefix=i.formatPrefix,i}g({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),t.FormatSpecifier=u,t.formatDefaultLocale=g,t.formatLocale=a,t.formatSpecifier=f,t.precisionFixed=function(h){return Math.max(0,-m(Math.abs(h)))},t.precisionPrefix=function(h,y){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(m(y)/3)))-m(Math.abs(h)))},t.precisionRound=function(h,y){return h=Math.abs(h),y=Math.abs(y)-h,Math.max(0,m(y)-m(h))+1},Object.defineProperty(t,"__esModule",{value:!0})})},{}],165:[function(r,O,B){(function(t,d){typeof B=="object"&&O!==void 0?d(B,r("d3-geo"),r("d3-array")):d(t.d3=t.d3||{},t.d3,t.d3)})(this,function(t,d,m){var p=Math.abs,e=Math.atan,f=Math.atan2,u=Math.cos,s=Math.exp,l=Math.floor,o=Math.log,i=Math.max,c=Math.min,n=Math.pow,a=Math.round,g=Math.sign||function(Re){return Re>0?1:Re<0?-1:0},h=Math.sin,y=Math.tan,v=1e-6,_=Math.PI,x=_/2,T=_/4,A=Math.SQRT1_2,S=D(2),w=D(_),C=2*_,k=180/_,L=_/180;function M(Re){return Re>1?x:Re<-1?-x:Math.asin(Re)}function P(Re){return Re>1?0:Re<-1?_:Math.acos(Re)}function D(Re){return Re>0?Math.sqrt(Re):0}function N(Re){return(s(Re)-s(-Re))/2}function U(Re){return(s(Re)+s(-Re))/2}function q(Re){var Ve=y(Re/2),Je=2*o(u(Re/2))/(Ve*Ve);function ot(mt,dt){var Et=u(mt),Zt=u(dt),$t=h(dt),Yt=Zt*Et,nr=-((1-Yt?o((1+Yt)/2)/(1-Yt):-.5)+Je/(1+Yt));return[nr*Zt*h(mt),nr*$t]}return ot.invert=function(mt,dt){var Et,Zt=D(mt*mt+dt*dt),$t=-Re/2,Yt=50;if(!Zt)return[0,0];do{var nr=$t/2,cr=u(nr),mr=h(nr),yr=mr/cr,Or=-o(p(cr));$t-=Et=(2/yr*Or-Je*yr-Zt)/(-Or/(mr*mr)+1-Je/(2*cr*cr))*(cr<0?.7:1)}while(p(Et)>v&&--Yt>0);var nn=h($t);return[f(mt*nn,Zt*u($t)),M(dt*nn/Zt)]},ot}function X(Re,Ve){var Je=u(Ve),ot=function(mt){return mt?mt/Math.sin(mt):1}(P(Je*u(Re/=2)));return[2*Je*h(Re)*ot,h(Ve)*ot]}function K(Re){var Ve=h(Re),Je=u(Re),ot=Re>=0?1:-1,mt=y(ot*Re),dt=(1+Ve-Je)/2;function Et(Zt,$t){var Yt=u($t),nr=u(Zt/=2);return[(1+Yt)*h(Zt),(ot*$t>-f(nr,mt)-.001?0:10*-ot)+dt+h($t)*Je-(1+Yt)*Ve*nr]}return Et.invert=function(Zt,$t){var Yt=0,nr=0,cr=50;do{var mr=u(Yt),yr=h(Yt),Or=u(nr),nn=h(nr),gn=1+Or,Cn=gn*yr-Zt,Dn=dt+nn*Je-gn*Ve*mr-$t,Hn=gn*mr/2,zn=-yr*nn,ga=Ve*gn*yr/2,ka=Je*Or+Ve*mr*nn,Ba=zn*ga-ka*Hn,Fa=(Dn*zn-Cn*ka)/Ba/2,ja=(Cn*ga-Dn*Hn)/Ba;p(ja)>2&&(ja/=2),Yt-=Fa,nr-=ja}while((p(Fa)>v||p(ja)>v)&&--cr>0);return ot*nr>-f(u(Yt),mt)-.001?[2*Yt,nr]:null},Et}function Z(Re,Ve){var Je=y(Ve/2),ot=D(1-Je*Je),mt=1+ot*u(Re/=2),dt=h(Re)*ot/mt,Et=Je/mt,Zt=dt*dt,$t=Et*Et;return[4/3*dt*(3+Zt-3*$t),4/3*Et*(3+3*Zt-$t)]}X.invert=function(Re,Ve){if(!(Re*Re+4*Ve*Ve>_*_+v)){var Je=Re,ot=Ve,mt=25;do{var dt,Et=h(Je),Zt=h(Je/2),$t=u(Je/2),Yt=h(ot),nr=u(ot),cr=h(2*ot),mr=Yt*Yt,yr=nr*nr,Or=Zt*Zt,nn=1-yr*$t*$t,gn=nn?P(nr*$t)*D(dt=1/nn):dt=0,Cn=2*gn*nr*Zt-Re,Dn=gn*Yt-Ve,Hn=dt*(yr*Or+gn*nr*$t*mr),zn=dt*(.5*Et*cr-2*gn*Yt*Zt),ga=.25*dt*(cr*Zt-gn*Yt*yr*Et),ka=dt*(mr*$t+gn*Or*nr),Ba=zn*ga-ka*Hn;if(!Ba)break;var Fa=(Dn*zn-Cn*ka)/Ba,ja=(Cn*ga-Dn*Hn)/Ba;Je-=Fa,ot-=ja}while((p(Fa)>v||p(ja)>v)&&--mt>0);return[Je,ot]}},Z.invert=function(Re,Ve){if(Ve*=3/8,!(Re*=3/8)&&p(Ve)>1)return null;var Je=1+Re*Re+Ve*Ve,ot=D((Je-D(Je*Je-4*Ve*Ve))/2),mt=M(ot)/3,dt=ot?function(Yt){return o(Yt+D(Yt*Yt-1))}(p(Ve/ot))/3:function(Yt){return o(Yt+D(Yt*Yt+1))}(p(Re))/3,Et=u(mt),Zt=U(dt),$t=Zt*Zt-Et*Et;return[2*g(Re)*f(N(dt)*Et,.25-$t),2*g(Ve)*f(Zt*h(mt),.25+$t)]};var H=D(8),Y=o(1+S);function $(Re,Ve){var Je=p(Ve);return Je<T?[Re,o(y(T+Ve/2))]:[Re*u(Je)*(2*S-1/h(Je)),g(Ve)*(2*S*(Je-T)-o(y(Je/2)))]}function z(Re){var Ve=2*_/Re;function Je(ot,mt){var dt=d.geoAzimuthalEquidistantRaw(ot,mt);if(p(ot)>x){var Et=f(dt[1],dt[0]),Zt=D(dt[0]*dt[0]+dt[1]*dt[1]),$t=Ve*a((Et-x)/Ve)+x,Yt=f(h(Et-=$t),2-u(Et));Et=$t+M(_/Zt*h(Yt))-Yt,dt[0]=Zt*u(Et),dt[1]=Zt*h(Et)}return dt}return Je.invert=function(ot,mt){var dt=D(ot*ot+mt*mt);if(dt>x){var Et=f(mt,ot),Zt=Ve*a((Et-x)/Ve)+x,$t=Et>Zt?-1:1,Yt=dt*u(Zt-Et),nr=1/y($t*P((Yt-_)/D(_*(_-2*Yt)+dt*dt)));Et=Zt+2*e((nr+$t*D(nr*nr-3))/3),ot=dt*u(Et),mt=dt*h(Et)}return d.geoAzimuthalEquidistantRaw.invert(ot,mt)},Je}function j(Re,Ve){if(arguments.length<2&&(Ve=Re),Ve===1)return d.geoAzimuthalEqualAreaRaw;if(Ve===1/0)return W;function Je(ot,mt){var dt=d.geoAzimuthalEqualAreaRaw(ot/Ve,mt);return dt[0]*=Re,dt}return Je.invert=function(ot,mt){var dt=d.geoAzimuthalEqualAreaRaw.invert(ot/Re,mt);return dt[0]*=Ve,dt},Je}function W(Re,Ve){return[Re*u(Ve)/u(Ve/=2),2*h(Ve)]}function ee(Re,Ve,Je){var ot,mt,dt,Et=100;Je=Je===void 0?0:+Je,Ve=+Ve;do(mt=Re(Je))===(dt=Re(Je+v))&&(dt=mt+v),Je-=ot=-1*v*(mt-Ve)/(mt-dt);while(Et-- >0&&p(ot)>v);return Et<0?NaN:Je}function J(Re,Ve,Je){return Ve===void 0&&(Ve=40),Je===void 0&&(Je=1e-12),function(ot,mt,dt,Et){var Zt,$t,Yt;dt=dt===void 0?0:+dt,Et=Et===void 0?0:+Et;for(var nr=0;nr<Ve;nr++){var cr=Re(dt,Et),mr=cr[0]-ot,yr=cr[1]-mt;if(p(mr)<Je&&p(yr)<Je)break;var Or=mr*mr+yr*yr;if(Or>Zt)dt-=$t/=2,Et-=Yt/=2;else{Zt=Or;var nn=(dt>0?-1:1)*Je,gn=(Et>0?-1:1)*Je,Cn=Re(dt+nn,Et),Dn=Re(dt,Et+gn),Hn=(Cn[0]-cr[0])/nn,zn=(Cn[1]-cr[1])/nn,ga=(Dn[0]-cr[0])/gn,ka=(Dn[1]-cr[1])/gn,Ba=ka*Hn-zn*ga,Fa=(p(Ba)<.5?.5:1)/Ba;if(dt+=$t=(yr*ga-mr*ka)*Fa,Et+=Yt=(mr*zn-yr*Hn)*Fa,p($t)<Je&&p(Yt)<Je)break}}return[dt,Et]}}function Q(){var Re=j(1.68,2);function Ve(Je,ot){if(Je+ot<-1.4){var mt=(Je-ot+1.6)*(Je+ot+1.4)/8;Je+=mt,ot-=.8*mt*h(ot+_/2)}var dt=Re(Je,ot),Et=(1-u(Je*ot))/12;return dt[1]<0&&(dt[0]*=1+Et),dt[1]>0&&(dt[1]*=1+Et/1.5*dt[0]*dt[0]),dt}return Ve.invert=J(Ve),Ve}function te(Re,Ve){var Je,ot=Re*h(Ve),mt=30;do Ve-=Je=(Ve+h(Ve)-ot)/(1+u(Ve));while(p(Je)>v&&--mt>0);return Ve/2}function ie(Re,Ve,Je){function ot(mt,dt){return[Re*mt*u(dt=te(Je,dt)),Ve*h(dt)]}return ot.invert=function(mt,dt){return dt=M(dt/Ve),[mt/(Re*u(dt)),M((2*dt+h(2*dt))/Je)]},ot}$.invert=function(Re,Ve){if((ot=p(Ve))<Y)return[Re,2*e(s(Ve))-x];var Je,ot,mt=T,dt=25;do{var Et=u(mt/2),Zt=y(mt/2);mt-=Je=(H*(mt-T)-o(Zt)-ot)/(H-Et*Et/(2*Zt))}while(p(Je)>1e-12&&--dt>0);return[Re/(u(mt)*(H-1/h(mt))),g(Ve)*mt]},W.invert=function(Re,Ve){var Je=2*M(Ve/2);return[Re*u(Je/2)/u(Je),Je]};var ae=ie(S/x,S,_),he=2.00276,se=1.11072;function de(Re,Ve){var Je=te(_,Ve);return[he*Re/(1/u(Ve)+se/u(Je)),(Ve+S*h(Je))/he]}function ue(Re){var Ve=0,Je=d.geoProjectionMutator(Re),ot=Je(Ve);return ot.parallel=function(mt){return arguments.length?Je(Ve=mt*L):Ve*k},ot}function ve(Re,Ve){return[Re*u(Ve),Ve]}function ke(Re){if(!Re)return ve;var Ve=1/y(Re);function Je(ot,mt){var dt=Ve+Re-mt,Et=dt&&ot*u(mt)/dt;return[dt*h(Et),Ve-dt*u(Et)]}return Je.invert=function(ot,mt){var dt=D(ot*ot+(mt=Ve-mt)*mt),Et=Ve+Re-dt;return[dt/u(Et)*f(ot,mt),Et]},Je}function Ee(Re){function Ve(Je,ot){var mt=x-ot,dt=mt&&Je*Re*h(mt)/mt;return[mt*h(dt)/Re,x-mt*u(dt)]}return Ve.invert=function(Je,ot){var mt=Je*Re,dt=x-ot,Et=D(mt*mt+dt*dt),Zt=f(mt,dt);return[(Et?Et/h(Et):1)*Zt/Re,x-Et]},Ve}de.invert=function(Re,Ve){var Je,ot,mt=he*Ve,dt=Ve<0?-T:T,Et=25;do ot=mt-S*h(dt),dt-=Je=(h(2*dt)+2*dt-_*h(ot))/(2*u(2*dt)+2+_*u(ot)*S*u(dt));while(p(Je)>v&&--Et>0);return ot=mt-S*h(dt),[Re*(1/u(ot)+se/u(dt))/he,ot]},ve.invert=function(Re,Ve){return[Re/u(Ve),Ve]};var be=ie(1,4/_,_);function xe(Re,Ve,Je,ot,mt,dt){var Et,Zt=u(dt);if(p(Re)>1||p(dt)>1)Et=P(Je*mt+Ve*ot*Zt);else{var $t=h(Re/2),Yt=h(dt/2);Et=2*M(D($t*$t+Ve*ot*Yt*Yt))}return p(Et)>v?[Et,f(ot*h(dt),Ve*mt-Je*ot*Zt)]:[0,0]}function ce(Re,Ve,Je){return P((Re*Re+Ve*Ve-Je*Je)/(2*Re*Ve))}function ge(Re){return Re-2*_*l((Re+_)/(2*_))}function we(Re,Ve,Je){for(var ot,mt=[[Re[0],Re[1],h(Re[1]),u(Re[1])],[Ve[0],Ve[1],h(Ve[1]),u(Ve[1])],[Je[0],Je[1],h(Je[1]),u(Je[1])]],dt=mt[2],Et=0;Et<3;++Et,dt=ot)ot=mt[Et],dt.v=xe(ot[1]-dt[1],dt[3],dt[2],ot[3],ot[2],ot[0]-dt[0]),dt.point=[0,0];var Zt=ce(mt[0].v[0],mt[2].v[0],mt[1].v[0]),$t=ce(mt[0].v[0],mt[1].v[0],mt[2].v[0]),Yt=_-Zt;mt[2].point[1]=0,mt[0].point[0]=-(mt[1].point[0]=mt[0].v[0]/2);var nr=[mt[2].point[0]=mt[0].point[0]+mt[2].v[0]*u(Zt),2*(mt[0].point[1]=mt[1].point[1]=mt[2].v[0]*h(Zt))];return function(cr,mr){var yr,Or=h(mr),nn=u(mr),gn=new Array(3);for(yr=0;yr<3;++yr){var Cn=mt[yr];if(gn[yr]=xe(mr-Cn[1],Cn[3],Cn[2],nn,Or,cr-Cn[0]),!gn[yr][0])return Cn.point;gn[yr][1]=ge(gn[yr][1]-Cn.v[1])}var Dn=nr.slice();for(yr=0;yr<3;++yr){var Hn=yr==2?0:yr+1,zn=ce(mt[yr].v[0],gn[yr][0],gn[Hn][0]);gn[yr][1]<0&&(zn=-zn),yr?yr==1?(zn=$t-zn,Dn[0]-=gn[yr][0]*u(zn),Dn[1]-=gn[yr][0]*h(zn)):(zn=Yt-zn,Dn[0]+=gn[yr][0]*u(zn),Dn[1]+=gn[yr][0]*h(zn)):(Dn[0]+=gn[yr][0]*u(zn),Dn[1]-=gn[yr][0]*h(zn))}return Dn[0]/=3,Dn[1]/=3,Dn}}function Me(Re){return Re[0]*=L,Re[1]*=L,Re}function Se(Re,Ve,Je){var ot=d.geoCentroid({type:"MultiPoint",coordinates:[Re,Ve,Je]}),mt=[-ot[0],-ot[1]],dt=d.geoRotation(mt),Et=we(Me(dt(Re)),Me(dt(Ve)),Me(dt(Je)));Et.invert=J(Et);var Zt=d.geoProjection(Et).rotate(mt),$t=Zt.center;return delete Zt.rotate,Zt.center=function(Yt){return arguments.length?$t(dt(Yt)):dt.invert($t())},Zt.clipAngle(90)}function ze(Re,Ve){var Je=D(1-h(Ve));return[2/w*Re*Je,w*(1-Je)]}function Fe(Re){var Ve=y(Re);function Je(ot,mt){return[ot,(ot?ot/h(ot):1)*(h(mt)*u(ot)-Ve*u(mt))]}return Je.invert=Ve?function(ot,mt){ot&&(mt*=h(ot)/ot);var dt=u(ot);return[ot,2*f(D(dt*dt+Ve*Ve-mt*mt)-dt,Ve-mt)]}:function(ot,mt){return[ot,M(ot?mt*y(ot)/ot:mt)]},Je}ze.invert=function(Re,Ve){var Je=(Je=Ve/w-1)*Je;return[Je>0?Re*D(_/Je)/2:0,M(1-Je)]};var Ye=D(3);function rt(Re,Ve){return[Ye*Re*(2*u(2*Ve/3)-1)/w,Ye*w*h(Ve/3)]}function Oe(Re){var Ve=u(Re);function Je(ot,mt){return[ot*Ve,h(mt)/Ve]}return Je.invert=function(ot,mt){return[ot/Ve,M(mt*Ve)]},Je}function je(Re){var Ve=u(Re);function Je(ot,mt){return[ot*Ve,(1+Ve)*y(mt/2)]}return Je.invert=function(ot,mt){return[ot/Ve,2*e(mt/(1+Ve))]},Je}function We(Re,Ve){var Je=D(8/(3*_));return[Je*Re*(1-p(Ve)/_),Je*Ve]}function qe(Re,Ve){var Je=D(4-3*h(p(Ve)));return[2/D(6*_)*Re*Je,g(Ve)*D(2*_/3)*(2-Je)]}function Qe(Re,Ve){var Je=D(_*(4+_));return[2/Je*Re*(1+D(1-4*Ve*Ve/(_*_))),4/Je*Ve]}function st(Re,Ve){var Je=(2+x)*h(Ve);Ve/=2;for(var ot=0,mt=1/0;ot<10&&p(mt)>v;ot++){var dt=u(Ve);Ve-=mt=(Ve+h(Ve)*(dt+2)-Je)/(2*dt*(1+dt))}return[2/D(_*(4+_))*Re*(1+u(Ve)),2*D(_/(4+_))*h(Ve)]}function ct(Re,Ve){return[Re*(1+u(Ve))/D(2+_),2*Ve/D(2+_)]}function Pt(Re,Ve){for(var Je=(1+x)*h(Ve),ot=0,mt=1/0;ot<10&&p(mt)>v;ot++)Ve-=mt=(Ve+h(Ve)-Je)/(1+u(Ve));return Je=D(2+_),[Re*(1+u(Ve))/Je,2*Ve/Je]}rt.invert=function(Re,Ve){var Je=3*M(Ve/(Ye*w));return[w*Re/(Ye*(2*u(2*Je/3)-1)),Je]},We.invert=function(Re,Ve){var Je=D(8/(3*_)),ot=Ve/Je;return[Re/(Je*(1-p(ot)/_)),ot]},qe.invert=function(Re,Ve){var Je=2-p(Ve)/D(2*_/3);return[Re*D(6*_)/(2*Je),g(Ve)*M((4-Je*Je)/3)]},Qe.invert=function(Re,Ve){var Je=D(_*(4+_))/2;return[Re*Je/(1+D(1-Ve*Ve*(4+_)/(4*_))),Ve*Je/2]},st.invert=function(Re,Ve){var Je=Ve*D((4+_)/_)/2,ot=M(Je),mt=u(ot);return[Re/(2/D(_*(4+_))*(1+mt)),M((ot+Je*(mt+2))/(2+x))]},ct.invert=function(Re,Ve){var Je=D(2+_),ot=Ve*Je/2;return[Je*Re/(1+u(ot)),ot]},Pt.invert=function(Re,Ve){var Je=1+x,ot=D(Je/2);return[2*Re*ot/(1+u(Ve*=ot)),M((Ve+h(Ve))/Je)]};var kt=3+2*S;function at(Re,Ve){var Je=h(Re/=2),ot=u(Re),mt=D(u(Ve)),dt=u(Ve/=2),Et=h(Ve)/(dt+S*ot*mt),Zt=D(2/(1+Et*Et)),$t=D((S*dt+(ot+Je)*mt)/(S*dt+(ot-Je)*mt));return[kt*(Zt*($t-1/$t)-2*o($t)),kt*(Zt*Et*($t+1/$t)-2*e(Et))]}at.invert=function(Re,Ve){if(!(Je=Z.invert(Re/1.2,1.065*Ve)))return null;var Je,ot=Je[0],mt=Je[1],dt=20;Re/=kt,Ve/=kt;do{var Et=ot/2,Zt=mt/2,$t=h(Et),Yt=u(Et),nr=h(Zt),cr=u(Zt),mr=u(mt),yr=D(mr),Or=nr/(cr+S*Yt*yr),nn=Or*Or,gn=D(2/(1+nn)),Cn=(S*cr+(Yt+$t)*yr)/(S*cr+(Yt-$t)*yr),Dn=D(Cn),Hn=Dn-1/Dn,zn=Dn+1/Dn,ga=gn*Hn-2*o(Dn)-Re,ka=gn*Or*zn-2*e(Or)-Ve,Ba=nr&&A*yr*$t*nn/nr,Fa=(S*Yt*cr+yr)/(2*(cr+S*Yt*yr)*(cr+S*Yt*yr)*yr),ja=-.5*Or*gn*gn*gn,Mi=ja*Ba,wi=ja*Fa,ui=(ui=2*cr+S*yr*(Yt-$t))*ui*Dn,ci=(S*Yt*cr*yr+mr)/ui,Ti=-S*$t*nr/(yr*ui),Vi=Hn*Mi-2*ci/Dn+gn*(ci+ci/Cn),no=Hn*wi-2*Ti/Dn+gn*(Ti+Ti/Cn),ao=Or*zn*Mi-2*Ba/(1+nn)+gn*zn*Ba+gn*Or*(ci-ci/Cn),io=Or*zn*wi-2*Fa/(1+nn)+gn*zn*Fa+gn*Or*(Ti-Ti/Cn),oo=no*ao-io*Vi;if(!oo)break;var Oa=(ka*no-ga*io)/oo,ft=(ga*ao-ka*Vi)/oo;ot-=Oa,mt=i(-x,c(x,mt-ft))}while((p(Oa)>v||p(ft)>v)&&--dt>0);return p(p(mt)-x)<v?[0,mt]:dt&&[ot,mt]};var tt=u(35*L);function _t(Re,Ve){var Je=y(Ve/2);return[Re*tt*D(1-Je*Je),(1+tt)*Je]}function er(Re,Ve){var Je=Ve/2,ot=u(Je);return[2*Re/w*u(Ve)*ot*ot,w*y(Je)]}function tr(Re){var Ve=1-Re,Je=mt(_,0)[0]-mt(-_,0)[0],ot=D(2*(mt(0,x)[1]-mt(0,-x)[1])/Je);function mt(Zt,$t){var Yt=u($t),nr=h($t);return[Yt/(Ve+Re*Yt)*Zt,Ve*$t+Re*nr]}function dt(Zt,$t){var Yt=mt(Zt,$t);return[Yt[0]*ot,Yt[1]/ot]}function Et(Zt){return dt(0,Zt)[1]}return dt.invert=function(Zt,$t){var Yt=ee(Et,$t);return[Zt/ot*(Re+Ve/u(Yt)),Yt]},dt}function Ue(Re){return[Re[0]/2,M(y(Re[1]/2*L))*k]}function He(Re){return[2*Re[0],2*e(h(Re[1]*L))*k]}function Be(Re,Ve){var Je=2*_/Ve,ot=Re*Re;function mt(dt,Et){var Zt=d.geoAzimuthalEquidistantRaw(dt,Et),$t=Zt[0],Yt=Zt[1],nr=$t*$t+Yt*Yt;if(nr>ot){var cr=D(nr),mr=f(Yt,$t),yr=Je*a(mr/Je),Or=mr-yr,nn=Re*u(Or),gn=(Re*h(Or)-Or*h(nn))/(x-nn),Cn=Ke(Or,gn),Dn=(_-Re)/_e(Cn,nn,_);$t=cr;var Hn,zn=50;do $t-=Hn=(Re+_e(Cn,nn,$t)*Dn-cr)/(Cn($t)*Dn);while(p(Hn)>v&&--zn>0);Yt=Or*h($t),$t<x&&(Yt-=gn*($t-x));var ga=h(yr),ka=u(yr);Zt[0]=$t*ka-Yt*ga,Zt[1]=$t*ga+Yt*ka}return Zt}return mt.invert=function(dt,Et){var Zt=dt*dt+Et*Et;if(Zt>ot){var $t=D(Zt),Yt=f(Et,dt),nr=Je*a(Yt/Je),cr=Yt-nr;dt=$t*u(cr),Et=$t*h(cr);for(var mr=dt-x,yr=h(dt),Or=Et/yr,nn=dt<x?1/0:0,gn=10;;){var Cn=Re*h(Or),Dn=Re*u(Or),Hn=h(Dn),zn=x-Dn,ga=(Cn-Or*Hn)/zn,ka=Ke(Or,ga);if(p(nn)<1e-12||!--gn)break;Or-=nn=(Or*yr-ga*mr-Et)/(yr-2*mr*(zn*(Dn+Or*Cn*u(Dn)-Hn)-Cn*(Cn-Or*Hn))/(zn*zn))}dt=($t=Re+_e(ka,Dn,dt)*(_-Re)/_e(ka,Dn,_))*u(Yt=nr+Or),Et=$t*h(Yt)}return d.geoAzimuthalEquidistantRaw.invert(dt,Et)},mt}function Ke(Re,Ve){return function(Je){var ot=Re*u(Je);return Je<x&&(ot-=Ve),D(1+ot*ot)}}function _e(Re,Ve,Je){for(var ot=(Je-Ve)/50,mt=Re(Ve)+Re(Je),dt=1,Et=Ve;dt<50;++dt)mt+=2*Re(Et+=ot);return .5*mt*ot}function Ce(Re,Ve,Je,ot,mt,dt,Et,Zt){function $t(Yt,nr){if(!nr)return[Re*Yt/_,0];var cr=nr*nr,mr=Re+cr*(Ve+cr*(Je+cr*ot)),yr=nr*(mt-1+cr*(dt-Zt+cr*Et)),Or=(mr*mr+yr*yr)/(2*yr),nn=Yt*M(mr/Or)/_;return[Or*h(nn),nr*(1+cr*Zt)+Or*(1-u(nn))]}return arguments.length<8&&(Zt=0),$t.invert=function(Yt,nr){var cr,mr,yr=_*Yt/Re,Or=nr,nn=50;do{var gn=Or*Or,Cn=Re+gn*(Ve+gn*(Je+gn*ot)),Dn=Or*(mt-1+gn*(dt-Zt+gn*Et)),Hn=Cn*Cn+Dn*Dn,zn=2*Dn,ga=Hn/zn,ka=ga*ga,Ba=M(Cn/ga)/_,Fa=yr*Ba,ja=Cn*Cn,Mi=(2*Ve+gn*(4*Je+6*gn*ot))*Or,wi=mt+gn*(3*dt+5*gn*Et),ui=(2*(Cn*Mi+Dn*(wi-1))*zn-Hn*(2*(wi-1)))/(zn*zn),ci=u(Fa),Ti=h(Fa),Vi=ga*ci,no=ga*Ti,ao=yr/_*(1/D(1-ja/ka))*(Mi*ga-Cn*ui)/ka,io=no-Yt,oo=Or*(1+gn*Zt)+ga-Vi-nr,Oa=ui*Ti+Vi*ao,ft=Vi*Ba,Rt=1+ui-(ui*ci-no*ao),sr=no*Ba,Vt=Oa*sr-Rt*ft;if(!Vt)break;yr-=cr=(oo*Oa-io*Rt)/Vt,Or-=mr=(io*sr-oo*ft)/Vt}while((p(cr)>v||p(mr)>v)&&--nn>0);return[yr,Or]},$t}_t.invert=function(Re,Ve){var Je=Ve/(1+tt);return[Re&&Re/(tt*D(1-Je*Je)),2*e(Je)]},er.invert=function(Re,Ve){var Je=e(Ve/w),ot=u(Je),mt=2*Je;return[Re*w/2/(u(mt)*ot*ot),mt]};var Le=Ce(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555),Pe=Ce(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742),Xe=Ce(5/6*_,-.62636,-.0344,0,1.3493,-.05524,0,.045);function ht(Re,Ve){var Je=Re*Re,ot=Ve*Ve;return[Re*(1-.162388*ot)*(.87-952426e-9*Je*Je),Ve*(1+ot/12)]}ht.invert=function(Re,Ve){var Je,ot=Re,mt=Ve,dt=50;do{var Et=mt*mt;mt-=Je=(mt*(1+Et/12)-Ve)/(1+Et/4)}while(p(Je)>v&&--dt>0);dt=50,Re/=1-.162388*Et;do{var Zt=(Zt=ot*ot)*Zt;ot-=Je=(ot*(.87-952426e-9*Zt)-Re)/(.87-.00476213*Zt)}while(p(Je)>v&&--dt>0);return[ot,mt]};var Mt=Ce(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function pt(Re){var Ve=Re(x,0)[0]-Re(-x,0)[0];function Je(ot,mt){var dt=ot>0?-.5:.5,Et=Re(ot+dt*_,mt);return Et[0]-=dt*Ve,Et}return Re.invert&&(Je.invert=function(ot,mt){var dt=ot>0?-.5:.5,Et=Re.invert(ot+dt*Ve,mt),Zt=Et[0]-dt*_;return Zt<-_?Zt+=2*_:Zt>_&&(Zt-=2*_),Et[0]=Zt,Et}),Je}function Lt(Re,Ve){var Je=g(Re),ot=g(Ve),mt=u(Ve),dt=u(Re)*mt,Et=h(Re)*mt,Zt=h(ot*Ve);Re=p(f(Et,Zt)),Ve=M(dt),p(Re-x)>v&&(Re%=x);var $t=function(Yt,nr){if(nr===x)return[0,0];var cr,mr,yr=h(nr),Or=yr*yr,nn=Or*Or,gn=1+nn,Cn=1+3*nn,Dn=1-nn,Hn=M(1/D(gn)),zn=Dn+Or*gn*Hn,ga=(1-yr)/zn,ka=D(ga),Ba=ga*gn,Fa=D(Ba),ja=ka*Dn;if(Yt===0)return[0,-(ja+Or*Fa)];var Mi,wi=u(nr),ui=1/wi,ci=2*yr*wi,Ti=(-zn*wi-(-3*Or+Hn*Cn)*ci*(1-yr))/(zn*zn),Vi=-ui*ci,no=-ui*(Or*gn*Ti+ga*Cn*ci),ao=-2*ui*(Dn*(.5*Ti/ka)-2*Or*ka*ci),io=4*Yt/_;if(Yt>.222*_||nr<_/4&&Yt>.175*_){if(cr=(ja+Or*D(Ba*(1+nn)-ja*ja))/(1+nn),Yt>_/4)return[cr,cr];var oo=cr,Oa=.5*cr;cr=.5*(Oa+oo),mr=50;do{var ft=D(Ba-cr*cr),Rt=cr*(ao+Vi*ft)+no*M(cr/Fa)-io;if(!Rt)break;Rt<0?Oa=cr:oo=cr,cr=.5*(Oa+oo)}while(p(oo-Oa)>v&&--mr>0)}else{cr=v,mr=25;do{var sr=cr*cr,Vt=D(Ba-sr),lr=ao+Vi*Vt,Lr=cr*lr+no*M(cr/Fa)-io,zr=lr+(no-Vi*sr)/Vt;cr-=Mi=Vt?Lr/zr:0}while(p(Mi)>v&&--mr>0)}return[cr,-ja-Or*D(Ba-cr*cr)]}(Re>_/4?x-Re:Re,Ve);return Re>_/4&&(Zt=$t[0],$t[0]=-$t[1],$t[1]=-Zt),$t[0]*=Je,$t[1]*=-ot,$t}function vt(Re,Ve){var Je,ot,mt,dt,Et,Zt;if(Ve<v)return[(dt=h(Re))-(Je=Ve*(Re-dt*(ot=u(Re)))/4)*ot,ot+Je*dt,1-Ve*dt*dt/2,Re-Je];if(Ve>=1-v)return Je=(1-Ve)/4,mt=1/(ot=U(Re)),[(dt=((Zt=s(2*(Zt=Re)))-1)/(Zt+1))+Je*((Et=ot*N(Re))-Re)/(ot*ot),mt-Je*dt*mt*(Et-Re),mt+Je*dt*mt*(Et+Re),2*e(s(Re))-x+Je*(Et-Re)/ot];var $t=[1,0,0,0,0,0,0,0,0],Yt=[D(Ve),0,0,0,0,0,0,0,0],nr=0;for(ot=D(1-Ve),Et=1;p(Yt[nr]/$t[nr])>v&&nr<8;)Je=$t[nr++],Yt[nr]=(Je-ot)/2,$t[nr]=(Je+ot)/2,ot=D(Je*ot),Et*=2;mt=Et*$t[nr]*Re;do mt=(M(dt=Yt[nr]*h(ot=mt)/$t[nr])+mt)/2;while(--nr);return[h(mt),dt=u(mt),dt/u(mt-ot),mt]}function Dt(Re,Ve){if(!Ve)return Re;if(Ve===1)return o(y(Re/2+T));for(var Je=1,ot=D(1-Ve),mt=D(Ve),dt=0;p(mt)>v;dt++){if(Re%_){var Et=e(ot*y(Re)/Je);Et<0&&(Et+=_),Re+=Et+~~(Re/_)*_}else Re+=Re;mt=(Je+ot)/2,ot=D(Je*ot),mt=((Je=mt)-ot)/2}return Re/(n(2,dt)*Je)}function xt(Re,Ve){var Je=(S-1)/(S+1),ot=D(1-Je*Je),mt=Dt(x,ot*ot),dt=o(y(_/4+p(Ve)/2)),Et=s(-1*dt)/D(Je),Zt=function(Yt,nr){var cr=Yt*Yt,mr=nr+1,yr=1-cr-nr*nr;return[.5*((Yt>=0?x:-x)-f(yr,2*Yt)),-.25*o(yr*yr+4*cr)+.5*o(mr*mr+cr)]}(Et*u(-1*Re),Et*h(-1*Re)),$t=function(Yt,nr,cr){var mr=p(Yt),yr=N(p(nr));if(mr){var Or=1/h(mr),nn=1/(y(mr)*y(mr)),gn=-(nn+cr*(yr*yr*Or*Or)-1+cr),Cn=(-gn+D(gn*gn-4*((cr-1)*nn)))/2;return[Dt(e(1/D(Cn)),cr)*g(Yt),Dt(e(D((Cn/nn-1)/cr)),1-cr)*g(nr)]}return[0,Dt(e(yr),1-cr)*g(nr)]}(Zt[0],Zt[1],ot*ot);return[-$t[1],(Ve>=0?1:-1)*(.5*mt-$t[0])]}function it(Re){var Ve=h(Re),Je=u(Re),ot=St(Re);function mt(dt,Et){var Zt=ot(dt,Et);dt=Zt[0],Et=Zt[1];var $t=h(Et),Yt=u(Et),nr=u(dt),cr=P(Ve*$t+Je*Yt*nr),mr=h(cr),yr=p(mr)>v?cr/mr:1;return[yr*Je*h(dt),(p(dt)>x?yr:-yr)*(Ve*Yt-Je*$t*nr)]}return ot.invert=St(-Re),mt.invert=function(dt,Et){var Zt=D(dt*dt+Et*Et),$t=-h(Zt),Yt=u(Zt),nr=Zt*Yt,cr=-Et*$t,mr=Zt*Ve,yr=D(nr*nr+cr*cr-mr*mr),Or=f(nr*mr+cr*yr,cr*mr-nr*yr),nn=(Zt>x?-1:1)*f(dt*$t,Zt*u(Or)*Yt+Et*h(Or)*$t);return ot.invert(nn,Or)},mt}function St(Re){var Ve=h(Re),Je=u(Re);return function(ot,mt){var dt=u(mt),Et=u(ot)*dt,Zt=h(ot)*dt,$t=h(mt);return[f(Zt,Et*Je-$t*Ve),M($t*Je+Et*Ve)]}}Lt.invert=function(Re,Ve){p(Re)>1&&(Re=2*g(Re)-Re),p(Ve)>1&&(Ve=2*g(Ve)-Ve);var Je=g(Re),ot=g(Ve),mt=-Je*Re,dt=-ot*Ve,Et=dt/mt<1,Zt=function(cr,mr){for(var yr=0,Or=1,nn=.5,gn=50;;){var Cn=nn*nn,Dn=D(nn),Hn=M(1/D(1+Cn)),zn=1-Cn+nn*(1+Cn)*Hn,ga=(1-Dn)/zn,ka=D(ga),Ba=ga*(1+Cn),Fa=ka*(1-Cn),ja=D(Ba-cr*cr),Mi=mr+Fa+nn*ja;if(p(Or-yr)<1e-12||--gn==0||Mi===0)break;Mi>0?yr=nn:Or=nn,nn=.5*(yr+Or)}if(!gn)return null;var wi=M(Dn),ui=u(wi),ci=1/ui,Ti=2*Dn*ui,Vi=(-zn*ui-(-3*nn+Hn*(1+3*Cn))*Ti*(1-Dn))/(zn*zn);return[_/4*(cr*(-2*ci*(.5*Vi/ka*(1-Cn)-2*nn*ka*Ti)+-ci*Ti*ja)+-ci*(nn*(1+Cn)*Vi+ga*(1+3*Cn)*Ti)*M(cr/D(Ba))),wi]}(Et?dt:mt,Et?mt:dt),$t=Zt[0],Yt=Zt[1],nr=u(Yt);return Et&&($t=-x-$t),[Je*(f(h($t)*nr,-h(Yt))+_),ot*M(u($t)*nr)]},xt.invert=function(Re,Ve){var Je,ot,mt,dt,Et,Zt,$t=(S-1)/(S+1),Yt=D(1-$t*$t),nr=Dt(x,Yt*Yt),cr=(ot=-Re,mt=Yt*Yt,(Je=.5*nr-Ve)?(dt=vt(Je,mt),ot?(Zt=(Et=vt(ot,1-mt))[1]*Et[1]+mt*dt[0]*dt[0]*Et[0]*Et[0],[[dt[0]*Et[2]/Zt,dt[1]*dt[2]*Et[0]*Et[1]/Zt],[dt[1]*Et[1]/Zt,-dt[0]*dt[2]*Et[0]*Et[2]/Zt],[dt[2]*Et[1]*Et[2]/Zt,-mt*dt[0]*dt[1]*Et[0]/Zt]]):[[dt[0],0],[dt[1],0],[dt[2],0]]):[[0,(Et=vt(ot,1-mt))[0]/Et[1]],[1/Et[1],0],[Et[2]/Et[1],0]]),mr=function(yr,Or){var nn=Or[0]*Or[0]+Or[1]*Or[1];return[(yr[0]*Or[0]+yr[1]*Or[1])/nn,(yr[1]*Or[0]-yr[0]*Or[1])/nn]}(cr[0],cr[1]);return[f(mr[1],mr[0])/-1,2*e(s(-.5*o($t*mr[0]*mr[0]+$t*mr[1]*mr[1])))-x]};var Nt=M(1-1/3)*k,Ut=Oe(0);function Qt(Re){var Ve=Nt*L,Je=ze(_,Ve)[0]-ze(-_,Ve)[0],ot=Ut(0,Ve)[1],mt=ze(0,Ve)[1],dt=w-mt,Et=C/Re,Zt=4/C,$t=ot+dt*dt*4/C;function Yt(nr,cr){var mr,yr=p(cr);if(yr>Ve){var Or=c(Re-1,i(0,l((nr+_)/Et)));(mr=ze(nr+=_*(Re-1)/Re-Or*Et,yr))[0]=mr[0]*C/Je-C*(Re-1)/(2*Re)+Or*C/Re,mr[1]=ot+4*(mr[1]-mt)*dt/C,cr<0&&(mr[1]=-mr[1])}else mr=Ut(nr,cr);return mr[0]*=Zt,mr[1]/=$t,mr}return Yt.invert=function(nr,cr){nr/=Zt;var mr=p(cr*=$t);if(mr>ot){var yr=c(Re-1,i(0,l((nr+_)/Et)));nr=(nr+_*(Re-1)/Re-yr*Et)*Je/C;var Or=ze.invert(nr,.25*(mr-ot)*C/dt+mt);return Or[0]-=_*(Re-1)/Re-yr*Et,cr<0&&(Or[1]=-Or[1]),Or}return Ut.invert(nr,cr)},Yt}function Ie(Re,Ve){return[Re,1&Ve?90-v:Nt]}function lt(Re,Ve){return[Re,1&Ve?-90+v:-Nt]}function wt(Re){return[Re[0]*(1-v),Re[1]]}function Ot(Re){var Ve,Je=1+Re,ot=M(h(1/Je)),mt=2*D(_/(Ve=_+4*ot*Je)),dt=.5*mt*(Je+D(Re*(2+Re))),Et=Re*Re,Zt=Je*Je;function $t(Yt,nr){var cr,mr,yr=1-h(nr);if(yr&&yr<2){var Or,nn=x-nr,gn=25;do{var Cn=h(nn),Dn=u(nn),Hn=ot+f(Cn,Je-Dn),zn=1+Zt-2*Je*Dn;nn-=Or=(nn-Et*ot-Je*Cn+zn*Hn-.5*yr*Ve)/(2*Je*Cn*Hn)}while(p(Or)>1e-12&&--gn>0);cr=mt*D(zn),mr=Yt*Hn/_}else cr=mt*(Re+yr),mr=Yt*ot/_;return[cr*h(mr),dt-cr*u(mr)]}return $t.invert=function(Yt,nr){var cr=Yt*Yt+(nr-=dt)*nr,mr=(1+Zt-cr/(mt*mt))/(2*Je),yr=P(mr),Or=h(yr),nn=ot+f(Or,Je-mr);return[M(Yt/D(cr))*_/nn,M(1-2*(yr-Et*ot-Je*Or+(1+Zt-2*Je*mr)*nn)/Ve)]},$t}function Gt(Re,Ve){return Ve>-.7109889596207567?((Re=ae(Re,Ve))[1]+=.0528035274542,Re):ve(Re,Ve)}function ir(Re,Ve){return p(Ve)>.7109889596207567?((Re=ae(Re,Ve))[1]-=Ve>0?.0528035274542:-.0528035274542,Re):ve(Re,Ve)}function Xt(Re,Ve,Je,ot){var mt=D(4*_/(2*Je+(1+Re-Ve/2)*h(2*Je)+(Re+Ve)/2*h(4*Je)+Ve/2*h(6*Je))),dt=D(ot*h(Je)*D((1+Re*u(2*Je)+Ve*u(4*Je))/(1+Re+Ve))),Et=Je*$t(1);function Zt(cr){return D(1+Re*u(2*cr)+Ve*u(4*cr))}function $t(cr){var mr=cr*Je;return(2*mr+(1+Re-Ve/2)*h(2*mr)+(Re+Ve)/2*h(4*mr)+Ve/2*h(6*mr))/Je}function Yt(cr){return Zt(cr)*h(cr)}var nr=function(cr,mr){var yr=Je*ee($t,Et*h(mr)/Je,mr/_);isNaN(yr)&&(yr=Je*g(mr));var Or=mt*Zt(yr);return[Or*dt*cr/_*u(yr),Or/dt*h(yr)]};return nr.invert=function(cr,mr){var yr=ee(Yt,mr*dt/mt);return[cr*_/(u(yr)*mt*dt*Zt(yr)),M(Je*$t(yr/Je)/Et)]},Je===0&&(mt=D(ot/_),(nr=function(cr,mr){return[cr*mt,h(mr)/mt]}).invert=function(cr,mr){return[cr/mt,M(mr*mt)]}),nr}function Kt(Re,Ve,Je,ot,mt){ot===void 0&&(ot=1e-8),mt===void 0&&(mt=20);var dt=Re(Ve),Et=Re(.5*(Ve+Je)),Zt=Re(Je);return function $t(Yt,nr,cr,mr,yr,Or,nn,gn,Cn,Dn,Hn){if(Hn.nanEncountered)return NaN;var zn,ga,ka,Ba,Fa,ja,Mi,wi,ui,ci;if(ga=Yt(nr+.25*(zn=cr-nr)),ka=Yt(cr-.25*zn),isNaN(ga))Hn.nanEncountered=!0;else{if(!isNaN(ka))return ci=((ja=(Ba=zn*(mr+4*ga+yr)/12)+(Fa=zn*(yr+4*ka+Or)/12))-nn)/15,Dn>Cn?(Hn.maxDepthCount++,ja+ci):Math.abs(ci)<gn?ja+ci:(wi=$t(Yt,nr,Mi=nr+.5*zn,mr,ga,yr,Ba,.5*gn,Cn,Dn+1,Hn),isNaN(wi)?(Hn.nanEncountered=!0,NaN):(ui=$t(Yt,Mi,cr,yr,ka,Or,Fa,.5*gn,Cn,Dn+1,Hn),isNaN(ui)?(Hn.nanEncountered=!0,NaN):wi+ui));Hn.nanEncountered=!0}}(Re,Ve,Je,dt,Et,Zt,(dt+4*Et+Zt)*(Je-Ve)/6,ot,mt,1,{maxDepthCount:0,nanEncountered:!1})}function or(Re,Ve,Je){function ot(yr){return Re+(1-Re)*n(1-n(yr,Ve),1/Ve)}function mt(yr){return Kt(ot,0,yr,1e-4)}for(var dt=1/mt(1),Et=1e3,Zt=(1+1e-8)*dt,$t=[],Yt=0;Yt<=Et;Yt++)$t.push(mt(Yt/Et)*Zt);function nr(yr){var Or=0,nn=Et,gn=500;do $t[gn]>yr?nn=gn:Or=gn,gn=Or+nn>>1;while(gn>Or);var Cn=$t[gn+1]-$t[gn];return Cn&&(Cn=(yr-$t[gn+1])/Cn),(gn+1+Cn)/Et}var cr=2*nr(1)/_*dt/Je,mr=function(yr,Or){var nn=nr(p(h(Or))),gn=ot(nn)*yr;return nn/=cr,[gn,Or>=0?nn:-nn]};return mr.invert=function(yr,Or){var nn;return p(Or*=cr)<1&&(nn=g(Or)*M(mt(p(Or))*dt)),[yr/ot(p(Or)),nn]},mr}function dr(Re,Ve){return p(Re[0]-Ve[0])<v&&p(Re[1]-Ve[1])<v}function vr(Re,Ve){for(var Je,ot,mt,dt=-1,Et=Re.length,Zt=Re[0],$t=[];++dt<Et;){ot=((Je=Re[dt])[0]-Zt[0])/Ve,mt=(Je[1]-Zt[1])/Ve;for(var Yt=0;Yt<Ve;++Yt)$t.push([Zt[0]+Yt*ot,Zt[1]+Yt*mt]);Zt=Je}return $t.push(Je),$t}function ur(Re){var Ve,Je,ot,mt,dt,Et,Zt,$t=[],Yt=Re[0].length;for(Zt=0;Zt<Yt;++Zt)Je=(Ve=Re[0][Zt])[0][0],ot=Ve[0][1],mt=Ve[1][1],dt=Ve[2][0],Et=Ve[2][1],$t.push(vr([[Je+v,ot+v],[Je+v,mt-v],[dt-v,mt-v],[dt-v,Et+v]],30));for(Zt=Re[1].length-1;Zt>=0;--Zt)Je=(Ve=Re[1][Zt])[0][0],ot=Ve[0][1],mt=Ve[1][1],dt=Ve[2][0],Et=Ve[2][1],$t.push(vr([[dt-v,Et-v],[dt-v,mt+v],[Je+v,mt+v],[Je+v,ot-v]],30));return{type:"Polygon",coordinates:[m.merge($t)]}}function pr(Re,Ve,Je){var ot,mt;function dt($t,Yt){for(var nr=Yt<0?-1:1,cr=Ve[+(Yt<0)],mr=0,yr=cr.length-1;mr<yr&&$t>cr[mr][2][0];++mr);var Or=Re($t-cr[mr][1][0],Yt);return Or[0]+=Re(cr[mr][1][0],nr*Yt>nr*cr[mr][0][1]?cr[mr][0][1]:Yt)[0],Or}Je?dt.invert=Je(dt):Re.invert&&(dt.invert=function($t,Yt){for(var nr=mt[+(Yt<0)],cr=Ve[+(Yt<0)],mr=0,yr=nr.length;mr<yr;++mr){var Or=nr[mr];if(Or[0][0]<=$t&&$t<Or[1][0]&&Or[0][1]<=Yt&&Yt<Or[1][1]){var nn=Re.invert($t-Re(cr[mr][1][0],0)[0],Yt);return nn[0]+=cr[mr][1][0],dr(dt(nn[0],nn[1]),[$t,Yt])?nn:null}}});var Et=d.geoProjection(dt),Zt=Et.stream;return Et.stream=function($t){var Yt=Et.rotate(),nr=Zt($t),cr=(Et.rotate([0,0]),Zt($t));return Et.rotate(Yt),nr.sphere=function(){d.geoStream(ot,cr)},nr},Et.lobes=function($t){return arguments.length?(ot=ur($t),Ve=$t.map(function(Yt){return Yt.map(function(nr){return[[nr[0][0]*L,nr[0][1]*L],[nr[1][0]*L,nr[1][1]*L],[nr[2][0]*L,nr[2][1]*L]]})}),mt=Ve.map(function(Yt){return Yt.map(function(nr){var cr,mr=Re(nr[0][0],nr[0][1])[0],yr=Re(nr[2][0],nr[2][1])[0],Or=Re(nr[1][0],nr[0][1])[1],nn=Re(nr[1][0],nr[1][1])[1];return Or>nn&&(cr=Or,Or=nn,nn=cr),[[mr,Or],[yr,nn]]})}),Et):Ve.map(function(Yt){return Yt.map(function(nr){return[[nr[0][0]*k,nr[0][1]*k],[nr[1][0]*k,nr[1][1]*k],[nr[2][0]*k,nr[2][1]*k]]})})},Ve!=null&&Et.lobes(Ve),Et}Gt.invert=function(Re,Ve){return Ve>-.7109889596207567?ae.invert(Re,Ve-.0528035274542):ve.invert(Re,Ve)},ir.invert=function(Re,Ve){return p(Ve)>.7109889596207567?ae.invert(Re,Ve+(Ve>0?.0528035274542:-.0528035274542)):ve.invert(Re,Ve)};var br=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],Rr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],_r=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],jr=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]],$r=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]],pn=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function In(Re,Ve){return[3/C*Re*D(_*_/3-Ve*Ve),Ve]}function On(Re){function Ve(Je,ot){if(p(p(ot)-x)<v)return[0,ot<0?-2:2];var mt=h(ot),dt=n((1+mt)/(1-mt),Re/2),Et=.5*(dt+1/dt)+u(Je*=Re);return[2*h(Je)/Et,(dt-1/dt)/Et]}return Ve.invert=function(Je,ot){var mt=p(ot);if(p(mt-2)<v)return Je?null:[0,g(ot)*x];if(mt>2)return null;var dt=(Je/=2)*Je,Et=(ot/=2)*ot,Zt=2*ot/(1+dt+Et);return Zt=n((1+Zt)/(1-Zt),1/Re),[f(2*Je,1-dt-Et)/Re,M((Zt-1)/(Zt+1))]},Ve}In.invert=function(Re,Ve){return[C/3*Re/D(_*_/3-Ve*Ve),Ve]};var Sn=_/S;function an(Re,Ve){return[Re*(1+D(u(Ve)))/2,Ve/(u(Ve/2)*u(Re/6))]}function Nr(Re,Ve){var Je=Re*Re,ot=Ve*Ve;return[Re*(.975534+ot*(-.0143059*Je-.119161+-.0547009*ot)),Ve*(1.00384+Je*(.0802894+-.02855*ot+199025e-9*Je)+ot*(.0998909+-.0491032*ot))]}function Pr(Re,Ve){return[h(Re)/u(Ve),y(Ve)*u(Re)]}function en(Re){var Ve=u(Re),Je=y(T+Re/2);function ot(mt,dt){var Et=dt-Re,Zt=p(Et)<v?mt*Ve:p(Zt=T+dt/2)<v||p(p(Zt)-x)<v?0:mt*Et/o(y(Zt)/Je);return[Zt,Et]}return ot.invert=function(mt,dt){var Et,Zt=dt+Re;return[p(dt)<v?mt/Ve:p(Et=T+Zt/2)<v||p(p(Et)-x)<v?0:mt*o(y(Et)/Je)/dt,Zt]},ot}function tn(Re,Ve){return[Re,1.25*o(y(T+.4*Ve))]}function Qr(Re){var Ve=Re.length-1;function Je(ot,mt){for(var dt,Et=u(mt),Zt=2/(1+Et*u(ot)),$t=Zt*Et*h(ot),Yt=Zt*h(mt),nr=Ve,cr=Re[nr],mr=cr[0],yr=cr[1];--nr>=0;)mr=(cr=Re[nr])[0]+$t*(dt=mr)-Yt*yr,yr=cr[1]+$t*yr+Yt*dt;return[mr=$t*(dt=mr)-Yt*yr,yr=$t*yr+Yt*dt]}return Je.invert=function(ot,mt){var dt=20,Et=ot,Zt=mt;do{for(var $t,Yt=Ve,nr=Re[Yt],cr=nr[0],mr=nr[1],yr=0,Or=0;--Yt>=0;)yr=cr+Et*($t=yr)-Zt*Or,Or=mr+Et*Or+Zt*$t,cr=(nr=Re[Yt])[0]+Et*($t=cr)-Zt*mr,mr=nr[1]+Et*mr+Zt*$t;var nn,gn,Cn=(yr=cr+Et*($t=yr)-Zt*Or)*yr+(Or=mr+Et*Or+Zt*$t)*Or;Et-=nn=((cr=Et*($t=cr)-Zt*mr-ot)*yr+(mr=Et*mr+Zt*$t-mt)*Or)/Cn,Zt-=gn=(mr*yr-cr*Or)/Cn}while(p(nn)+p(gn)>1e-12&&--dt>0);if(dt){var Dn=D(Et*Et+Zt*Zt),Hn=2*e(.5*Dn),zn=h(Hn);return[f(Et*zn,Dn*u(Hn)),Dn?M(Zt*zn/Dn):0]}},Je}an.invert=function(Re,Ve){var Je=p(Re),ot=p(Ve),mt=v,dt=x;ot<Sn?dt*=ot/Sn:mt+=6*P(Sn/ot);for(var Et=0;Et<25;Et++){var Zt=h(dt),$t=D(u(dt)),Yt=h(dt/2),nr=u(dt/2),cr=h(mt/6),mr=u(mt/6),yr=.5*mt*(1+$t)-Je,Or=dt/(nr*mr)-ot,nn=$t?-.25*mt*Zt/$t:0,gn=.5*(1+$t),Cn=(1+.5*dt*Yt/nr)/(nr*mr),Dn=dt/nr*(cr/6)/(mr*mr),Hn=nn*Dn-Cn*gn,zn=(yr*Dn-Or*gn)/Hn,ga=(Or*nn-yr*Cn)/Hn;if(dt-=zn,mt-=ga,p(zn)<v&&p(ga)<v)break}return[Re<0?-mt:mt,Ve<0?-dt:dt]},Nr.invert=function(Re,Ve){var Je=g(Re)*_,ot=Ve/2,mt=50;do{var dt=Je*Je,Et=ot*ot,Zt=Je*ot,$t=Je*(.975534+Et*(-.0143059*dt-.119161+-.0547009*Et))-Re,Yt=ot*(1.00384+dt*(.0802894+-.02855*Et+199025e-9*dt)+Et*(.0998909+-.0491032*Et))-Ve,nr=.975534-Et*(.119161+3*dt*.0143059+.0547009*Et),cr=-Zt*(.238322+.2188036*Et+.0286118*dt),mr=Zt*(.1605788+7961e-7*dt+-.0571*Et),yr=1.00384+dt*(.0802894+199025e-9*dt)+Et*(3*(.0998909-.02855*dt)-.245516*Et),Or=cr*mr-yr*nr,nn=(Yt*cr-$t*yr)/Or,gn=($t*mr-Yt*nr)/Or;Je-=nn,ot-=gn}while((p(nn)>v||p(gn)>v)&&--mt>0);return mt&&[Je,ot]},Pr.invert=function(Re,Ve){var Je=Re*Re,ot=Ve*Ve+1,mt=Je+ot,dt=Re?A*D((mt-D(mt*mt-4*Je))/Je):1/D(ot);return[M(Re*dt),g(Ve)*P(dt)]},tn.invert=function(Re,Ve){return[Re,2.5*e(s(.8*Ve))-.625*_]};var rn=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],An=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],En=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],Bn=[[.9245,0],[0,0],[.01943,0]],Jt=[[.721316,0],[0,0],[-.00881625,-.00617325]];function It(Re,Ve){var Je=d.geoProjection(Qr(Re)).rotate(Ve).clipAngle(90),ot=d.geoRotation(Ve),mt=Je.center;return delete Je.rotate,Je.center=function(dt){return arguments.length?mt(ot(dt)):ot.invert(mt())},Je}var qt=D(6),fr=D(7);function Tr(Re,Ve){var Je=M(7*h(Ve)/(3*qt));return[qt*Re*(2*u(2*Je/3)-1)/fr,9*h(Je/3)/fr]}function Gr(Re,Ve){for(var Je,ot=(1+A)*h(Ve),mt=Ve,dt=0;dt<25&&(mt-=Je=(h(mt/2)+h(mt)-ot)/(.5*u(mt/2)+u(mt)),!(p(Je)<v));dt++);return[Re*(1+2*u(mt)/u(mt/2))/(3*S),2*D(3)*h(mt/2)/D(2+S)]}function Vr(Re,Ve){for(var Je,ot=D(6/(4+_)),mt=(1+_/4)*h(Ve),dt=Ve/2,Et=0;Et<25&&(dt-=Je=(dt/2+h(dt)-mt)/(.5+u(dt)),!(p(Je)<v));Et++);return[ot*(.5+u(dt))*Re/1.5,ot*dt]}function xr(Re,Ve){var Je=Ve*Ve,ot=Je*Je,mt=Je*ot;return[Re*(.84719-.13063*Je+mt*mt*(.05494*Je-.04515-.02326*ot+.00331*mt)),Ve*(1.01183+ot*ot*(.01926*Je-.02625-.00396*ot))]}function wr(Re,Ve){return[Re*(1+u(Ve))/2,2*(Ve-y(Ve/2))]}Tr.invert=function(Re,Ve){var Je=3*M(Ve*fr/9);return[Re*fr/(qt*(2*u(2*Je/3)-1)),M(3*h(Je)*qt/7)]},Gr.invert=function(Re,Ve){var Je=Ve*D(2+S)/(2*D(3)),ot=2*M(Je);return[3*S*Re/(1+2*u(ot)/u(ot/2)),M((Je+h(ot))/(1+A))]},Vr.invert=function(Re,Ve){var Je=D(6/(4+_)),ot=Ve/Je;return p(p(ot)-x)<v&&(ot=ot<0?-x:x),[1.5*Re/(Je*(.5+u(ot))),M((ot/2+h(ot))/(1+_/4))]},xr.invert=function(Re,Ve){var Je,ot,mt,dt,Et=Ve,Zt=25;do Et-=Je=(Et*(1.01183+(mt=(ot=Et*Et)*ot)*mt*(.01926*ot-.02625-.00396*mt))-Ve)/(1.01183+mt*mt*(.21186*ot-.23625+-.05148*mt));while(p(Je)>1e-12&&--Zt>0);return[Re/(.84719-.13063*(ot=Et*Et)+(dt=ot*(mt=ot*ot))*dt*(.05494*ot-.04515-.02326*mt+.00331*dt)),Et]},wr.invert=function(Re,Ve){for(var Je=Ve/2,ot=0,mt=1/0;ot<10&&p(mt)>v;++ot){var dt=u(Ve/2);Ve-=mt=(Ve-y(Ve/2)-Je)/(1-.5/(dt*dt))}return[2*Re/(1+u(Ve)),Ve]};var Sr=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function Mr(Re,Ve){var Je=h(Ve),ot=u(Ve),mt=g(Re);if(Re===0||p(Ve)===x)return[0,Ve];if(Ve===0)return[Re,0];if(p(Re)===x)return[Re*ot,x*Je];var dt=_/(2*Re)-2*Re/_,Et=2*Ve/_,Zt=(1-Et*Et)/(Je-Et),$t=dt*dt,Yt=Zt*Zt,nr=1+$t/Yt,cr=1+Yt/$t,mr=(dt*Je/Zt-dt/2)/nr,yr=(Yt*Je/$t+Zt/2)/cr,Or=yr*yr-(Yt*Je*Je/$t+Zt*Je-1)/cr;return[x*(mr+D(mr*mr+ot*ot/nr)*mt),x*(yr+D(Or<0?0:Or)*g(-Ve*dt)*mt)]}Mr.invert=function(Re,Ve){var Je=(Re/=x)*Re,ot=Je+(Ve/=x)*Ve,mt=_*_;return[Re?(ot-1+D((1-ot)*(1-ot)+4*Je))/(2*Re)*x:0,ee(function(dt){return ot*(_*h(dt)-2*dt)*_+4*dt*dt*(Ve-h(dt))+2*_*dt-mt*Ve},0)]};function Ir(Re,Ve){var Je=Ve*Ve;return[Re,Ve*(1.0148+Je*Je*(.23185+Je*(.02406*Je-.14499)))]}function qr(Re,Ve){if(p(Ve)<v)return[Re,0];var Je=y(Ve),ot=Re*h(Ve);return[h(ot)/Je,Ve+(1-u(ot))/Je]}function cn(Re,Ve){var Je=Jr(Re[1],Re[0]),ot=Jr(Ve[1],Ve[0]),mt=function(Et,Zt){return f(Et[0]*Zt[1]-Et[1]*Zt[0],Et[0]*Zt[0]+Et[1]*Zt[1])}(Je,ot),dt=bn(Je)/bn(ot);return _n([1,0,Re[0][0],0,1,Re[0][1]],_n([dt,0,0,0,dt,0],_n([u(mt),h(mt),0,-h(mt),u(mt),0],[1,0,-Ve[0][0],0,1,-Ve[0][1]])))}function _n(Re,Ve){return[Re[0]*Ve[0]+Re[1]*Ve[3],Re[0]*Ve[1]+Re[1]*Ve[4],Re[0]*Ve[2]+Re[1]*Ve[5]+Re[2],Re[3]*Ve[0]+Re[4]*Ve[3],Re[3]*Ve[1]+Re[4]*Ve[4],Re[3]*Ve[2]+Re[4]*Ve[5]+Re[5]]}function Jr(Re,Ve){return[Re[0]-Ve[0],Re[1]-Ve[1]]}function bn(Re){return D(Re[0]*Re[0]+Re[1]*Re[1])}function Dr(Re,Ve,Je){function ot(Et,Zt){var $t,Yt=Ve(Et,Zt),nr=Yt.project([Et*k,Zt*k]);return($t=Yt.transform)?[$t[0]*nr[0]+$t[1]*nr[1]+$t[2],-($t[3]*nr[0]+$t[4]*nr[1]+$t[5])]:(nr[1]=-nr[1],nr)}(function Et(Zt,$t){if(Zt.edges=function(Or){for(var nn=Or.length,gn=[],Cn=Or[nn-1],Dn=0;Dn<nn;++Dn)gn.push([Cn,Cn=Or[Dn]]);return gn}(Zt.face),$t.face){var Yt=Zt.shared=function(Or,nn){for(var gn,Cn,Dn=Or.length,Hn=null,zn=0;zn<Dn;++zn){gn=Or[zn];for(var ga=nn.length;--ga>=0;)if(Cn=nn[ga],gn[0]===Cn[0]&&gn[1]===Cn[1]){if(Hn)return[Hn,gn];Hn=gn}}}(Zt.face,$t.face),nr=cn(Yt.map($t.project),Yt.map(Zt.project));Zt.transform=$t.transform?_n($t.transform,nr):nr;for(var cr=$t.edges,mr=0,yr=cr.length;mr<yr;++mr)Wr(Yt[0],cr[mr][1])&&Wr(Yt[1],cr[mr][0])&&(cr[mr]=Zt),Wr(Yt[0],cr[mr][0])&&Wr(Yt[1],cr[mr][1])&&(cr[mr]=Zt);for(cr=Zt.edges,mr=0,yr=cr.length;mr<yr;++mr)Wr(Yt[0],cr[mr][0])&&Wr(Yt[1],cr[mr][1])&&(cr[mr]=$t),Wr(Yt[0],cr[mr][1])&&Wr(Yt[1],cr[mr][0])&&(cr[mr]=$t)}else Zt.transform=$t.transform;return Zt.children&&Zt.children.forEach(function(Or){Et(Or,Zt)}),Zt})(Re,{transform:null}),vn(Re)&&(ot.invert=function(Et,Zt){var $t=function Yt(nr,cr){var mr=nr.project.invert,yr=nr.transform,Or=cr;if(yr&&(yr=function(Hn){var zn=1/(Hn[0]*Hn[4]-Hn[1]*Hn[3]);return[zn*Hn[4],-zn*Hn[1],zn*(Hn[1]*Hn[5]-Hn[2]*Hn[4]),-zn*Hn[3],zn*Hn[0],zn*(Hn[2]*Hn[3]-Hn[0]*Hn[5])]}(yr),Or=[yr[0]*Or[0]+yr[1]*Or[1]+yr[2],yr[3]*Or[0]+yr[4]*Or[1]+yr[5]]),mr&&nr===function(Hn){return Ve(Hn[0]*L,Hn[1]*L)}(nn=mr(Or)))return nn;for(var nn,gn=nr.children,Cn=0,Dn=gn&&gn.length;Cn<Dn;++Cn)if(nn=Yt(gn[Cn],cr))return nn}(Re,[Et,-Zt]);return $t&&($t[0]*=L,$t[1]*=L,$t)});var mt=d.geoProjection(ot),dt=mt.stream;return mt.stream=function(Et){var Zt=mt.rotate(),$t=dt(Et),Yt=(mt.rotate([0,0]),dt(Et));return mt.rotate(Zt),$t.sphere=function(){Yt.polygonStart(),Yt.lineStart(),function nr(cr,mr,yr){var Or,nn,gn=mr.edges,Cn=gn.length,Dn={type:"MultiPoint",coordinates:mr.face},Hn=mr.face.filter(function(Mi){return p(Mi[1])!==90}),zn=d.geoBounds({type:"MultiPoint",coordinates:Hn}),ga=!1,ka=-1,Ba=zn[1][0]-zn[0][0],Fa=Ba===180||Ba===360?[(zn[0][0]+zn[1][0])/2,(zn[0][1]+zn[1][1])/2]:d.geoCentroid(Dn);if(yr)for(;++ka<Cn&&gn[ka]!==yr;);++ka;for(var ja=0;ja<Cn;++ja)nn=gn[(ja+ka)%Cn],Array.isArray(nn)?(ga||(cr.point((Or=d.geoInterpolate(nn[0],Fa)(v))[0],Or[1]),ga=!0),cr.point((Or=d.geoInterpolate(nn[1],Fa)(v))[0],Or[1])):(ga=!1,nn!==yr&&nr(cr,nn,mr))}(Yt,Re),Yt.lineEnd(),Yt.polygonEnd()},$t},mt.angle(Je==null?-30:Je*k)}function Wr(Re,Ve){return Re&&Ve&&Re[0]===Ve[0]&&Re[1]===Ve[1]}function vn(Re){return Re.project.invert||Re.children&&Re.children.some(vn)}Ir.invert=function(Re,Ve){Ve>1.790857183?Ve=1.790857183:Ve<-1.790857183&&(Ve=-1.790857183);var Je,ot=Ve;do{var mt=ot*ot;ot-=Je=(ot*(1.0148+mt*mt*(.23185+mt*(.02406*mt-.14499)))-Ve)/(1.0148+mt*mt*(5*.23185+mt*(.21654*mt-1.01493)))}while(p(Je)>v);return[Re,ot]},qr.invert=function(Re,Ve){if(p(Ve)<v)return[Re,0];var Je,ot=Re*Re+Ve*Ve,mt=.5*Ve,dt=10;do{var Et=y(mt),Zt=1/u(mt),$t=ot-2*Ve*mt+mt*mt;mt-=Je=(Et*$t+2*(mt-Ve))/(2+$t*Zt*Zt+2*(mt-Ve)*Et)}while(p(Je)>v&&--dt>0);return Et=y(mt),[(p(Ve)<p(mt+1/Et)?M(Re*Et):g(Ve)*g(Re)*(P(p(Re*Et))+x))/h(mt),mt]};var dn=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],Pn=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(Re){return Re.map(function(Ve){return dn[Ve]})}),sa=2/D(3);function Yn(Re,Ve){var Je=ze(Re,Ve);return[Je[0]*sa,Je[1]]}function yn(Re,Ve){for(var Je=0,ot=Re.length,mt=0;Je<ot;++Je)mt+=Re[Je]*Ve[Je];return mt}function ra(Re){return[f(Re[1],Re[0])*k,M(i(-1,c(1,Re[2])))*k]}function pa(Re){var Ve=Re[0]*L,Je=Re[1]*L,ot=u(Je);return[ot*u(Ve),ot*h(Ve),h(Je)]}function Qa(){}function Fi(Re,Ve){return{type:"FeatureCollection",features:Re.features.map(function(Je){return li(Je,Ve)})}}function li(Re,Ve){return{type:"Feature",id:Re.id,properties:Re.properties,geometry:ki(Re.geometry,Ve)}}function ki(Re,Ve){if(!Re)return null;if(Re.type==="GeometryCollection")return function(ot,mt){return{type:"GeometryCollection",geometries:ot.geometries.map(function(dt){return ki(dt,mt)})}}(Re,Ve);var Je;switch(Re.type){case"Point":case"MultiPoint":Je=ko;break;case"LineString":case"MultiLineString":Je=Qo;break;case"Polygon":case"MultiPolygon":case"Sphere":Je=us;break;default:return null}return d.geoStream(Re,Ve(Je)),Je.result()}Yn.invert=function(Re,Ve){return ze.invert(Re/sa,Ve)};var Ea=[],Ga=[],ko={point:function(Re,Ve){Ea.push([Re,Ve])},result:function(){var Re=Ea.length?Ea.length<2?{type:"Point",coordinates:Ea[0]}:{type:"MultiPoint",coordinates:Ea}:null;return Ea=[],Re}},Qo={lineStart:Qa,point:function(Re,Ve){Ea.push([Re,Ve])},lineEnd:function(){Ea.length&&(Ga.push(Ea),Ea=[])},result:function(){var Re=Ga.length?Ga.length<2?{type:"LineString",coordinates:Ga[0]}:{type:"MultiLineString",coordinates:Ga}:null;return Ga=[],Re}},us={polygonStart:Qa,lineStart:Qa,point:function(Re,Ve){Ea.push([Re,Ve])},lineEnd:function(){var Re=Ea.length;if(Re){do Ea.push(Ea[0].slice());while(++Re<4);Ga.push(Ea),Ea=[]}},polygonEnd:Qa,result:function(){if(!Ga.length)return null;var Re=[],Ve=[];return Ga.forEach(function(Je){(function(ot){if((mt=ot.length)<4)return!1;for(var mt,dt=0,Et=ot[mt-1][1]*ot[0][0]-ot[mt-1][0]*ot[0][1];++dt<mt;)Et+=ot[dt-1][1]*ot[dt][0]-ot[dt-1][0]*ot[dt][1];return Et<=0})(Je)?Re.push([Je]):Ve.push(Je)}),Ve.forEach(function(Je){var ot=Je[0];Re.some(function(mt){if(function(dt,Et){for(var Zt=Et[0],$t=Et[1],Yt=!1,nr=0,cr=dt.length,mr=cr-1;nr<cr;mr=nr++){var yr=dt[nr],Or=yr[0],nn=yr[1],gn=dt[mr],Cn=gn[0],Dn=gn[1];nn>$t^Dn>$t&&Zt<(Cn-Or)*($t-nn)/(Dn-nn)+Or&&(Yt=!Yt)}return Yt}(mt[0],ot))return mt.push(Je),!0})||Re.push([Je])}),Ga=[],Re.length?Re.length>1?{type:"MultiPolygon",coordinates:Re}:{type:"Polygon",coordinates:Re[0]}:null}};function $i(Re){var Ve=Re(x,0)[0]-Re(-x,0)[0];function Je(ot,mt){var dt=p(ot)<x,Et=Re(dt?ot:ot>0?ot-_:ot+_,mt),Zt=(Et[0]-Et[1])*A,$t=(Et[0]+Et[1])*A;if(dt)return[Zt,$t];var Yt=Ve*A,nr=Zt>0^$t>0?-1:1;return[nr*Zt-g($t)*Yt,nr*$t-g(Zt)*Yt]}return Re.invert&&(Je.invert=function(ot,mt){var dt=(ot+mt)*A,Et=(mt-ot)*A,Zt=p(dt)<.5*Ve&&p(Et)<.5*Ve;if(!Zt){var $t=Ve*A,Yt=dt>0^Et>0?-1:1,nr=-Yt*ot+(Et>0?1:-1)*$t,cr=-Yt*mt+(dt>0?1:-1)*$t;dt=(-nr-cr)*A,Et=(nr-cr)*A}var mr=Re.invert(dt,Et);return Zt||(mr[0]+=dt>0?_:-_),mr}),d.geoProjection(Je).rotate([-90,-90,45]).clipAngle(179.999)}function to(){return $i(xt).scale(111.48)}function es(Re){var Ve=h(Re);function Je(ot,mt){var dt=Ve?y(ot*Ve/2)/Ve:ot/2;if(!mt)return[2*dt,-Re];var Et=2*e(dt*h(mt)),Zt=1/y(mt);return[h(Et)*Zt,mt+(1-u(Et))*Zt-Re]}return Je.invert=function(ot,mt){if(p(mt+=Re)<v)return[Ve?2*e(Ve*ot/2)/Ve:ot,0];var dt,Et=ot*ot+mt*mt,Zt=0,$t=10;do{var Yt=y(Zt),nr=1/u(Zt),cr=Et-2*mt*Zt+Zt*Zt;Zt-=dt=(Yt*cr+2*(Zt-mt))/(2+cr*nr*nr+2*(Zt-mt)*Yt)}while(p(dt)>v&&--$t>0);var mr=ot*(Yt=y(Zt)),yr=y(p(mt)<p(Zt+1/Yt)?.5*M(mr):.5*P(mr)+_/4)/h(Zt);return[Ve?2*e(Ve*yr)/Ve:2*yr,Zt]},Je}var Wa=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function jo(Re,Ve){var Je,ot=c(18,36*p(Ve)/_),mt=l(ot),dt=ot-mt,Et=(Je=Wa[mt])[0],Zt=Je[1],$t=(Je=Wa[++mt])[0],Yt=Je[1],nr=(Je=Wa[c(19,++mt)])[0],cr=Je[1];return[Re*($t+dt*(nr-Et)/2+dt*dt*(nr-2*$t+Et)/2),(Ve>0?x:-x)*(Yt+dt*(cr-Zt)/2+dt*dt*(cr-2*Yt+Zt)/2)]}function Ao(Re,Ve){var Je=function(Et){function Zt($t,Yt){var nr=u(Yt),cr=(Et-1)/(Et-nr*u($t));return[cr*nr*h($t),cr*h(Yt)]}return Zt.invert=function($t,Yt){var nr=$t*$t+Yt*Yt,cr=D(nr),mr=(Et-D(1-nr*(Et+1)/(Et-1)))/((Et-1)/cr+cr/(Et-1));return[f($t*mr,cr*D(1-mr*mr)),cr?M(Yt*mr/cr):0]},Zt}(Re);if(!Ve)return Je;var ot=u(Ve),mt=h(Ve);function dt(Et,Zt){var $t=Je(Et,Zt),Yt=$t[1],nr=Yt*mt/(Re-1)+ot;return[$t[0]*ot/nr,Yt/nr]}return dt.invert=function(Et,Zt){var $t=(Re-1)/(Re-1-Zt*mt);return Je.invert($t*Et,$t*Zt*ot)},dt}Wa.forEach(function(Re){Re[1]*=1.0144}),jo.invert=function(Re,Ve){var Je=Ve/x,ot=90*Je,mt=c(18,p(ot/5)),dt=i(0,l(mt));do{var Et=Wa[dt][1],Zt=Wa[dt+1][1],$t=Wa[c(19,dt+2)][1],Yt=$t-Et,nr=$t-2*Zt+Et,cr=2*(p(Je)-Zt)/Yt,mr=nr/Yt,yr=cr*(1-mr*cr*(1-2*mr*cr));if(yr>=0||dt===1){ot=(Ve>=0?5:-5)*(yr+mt);var Or,nn=50;do yr=(mt=c(18,p(ot)/5))-(dt=l(mt)),Et=Wa[dt][1],Zt=Wa[dt+1][1],$t=Wa[c(19,dt+2)][1],ot-=(Or=(Ve>=0?x:-x)*(Zt+yr*($t-Et)/2+yr*yr*($t-2*Zt+Et)/2)-Ve)*k;while(p(Or)>1e-12&&--nn>0);break}}while(--dt>=0);var gn=Wa[dt][0],Cn=Wa[dt+1][0],Dn=Wa[c(19,dt+2)][0];return[Re/(Cn+yr*(Dn-gn)/2+yr*yr*(Dn-2*Cn+gn)/2),ot*L]};var Ai=-179.9999,ro=179.9999,Mo=-89.9999;function zo(Re){return Re.length>0}function Ui(Re){return Re===-90||Re===90?[0,Re]:[-180,(Ve=Re,Math.floor(1e4*Ve)/1e4)];var Ve}function vi(Re){var Ve=Re[0],Je=Re[1],ot=!1;return Ve<=Ai?(Ve=-180,ot=!0):Ve>=ro&&(Ve=180,ot=!0),Je<=Mo?(Je=-90,ot=!0):Je>=89.9999&&(Je=90,ot=!0),ot?[Ve,Je]:Re}function Qi(Re){return Re.map(vi)}function Vs(Re,Ve,Je){for(var ot=0,mt=Re.length;ot<mt;++ot){var dt=Re[ot].slice();Je.push({index:-1,polygon:Ve,ring:dt});for(var Et=0,Zt=dt.length;Et<Zt;++Et){var $t=dt[Et],Yt=$t[0],nr=$t[1];if(Yt<=Ai||Yt>=ro||nr<=Mo||nr>=89.9999){dt[Et]=vi($t);for(var cr=Et+1;cr<Zt;++cr){var mr=dt[cr],yr=mr[0],Or=mr[1];if(yr>Ai&&yr<ro&&Or>Mo&&Or<89.9999)break}if(cr===Et+1)continue;if(Et){var nn={index:-1,polygon:Ve,ring:dt.slice(0,Et+1)};nn.ring[nn.ring.length-1]=Ui(nr),Je[Je.length-1]=nn}else Je.pop();if(cr>=Zt)break;Je.push({index:-1,polygon:Ve,ring:dt=dt.slice(cr-1)}),dt[0]=Ui(dt[0][1]),Et=-1,Zt=dt.length}}}}function Xs(Re){var Ve,Je,ot,mt,dt,Et,Zt=Re.length,$t={},Yt={};for(Ve=0;Ve<Zt;++Ve)ot=(Je=Re[Ve]).ring[0],dt=Je.ring[Je.ring.length-1],ot[0]!==dt[0]||ot[1]!==dt[1]?(Je.index=Ve,$t[ot]=Yt[dt]=Je):(Je.polygon.push(Je.ring),Re[Ve]=null);for(Ve=0;Ve<Zt;++Ve)if(Je=Re[Ve]){if(ot=Je.ring[0],dt=Je.ring[Je.ring.length-1],mt=Yt[ot],Et=$t[dt],delete $t[ot],delete Yt[dt],ot[0]===dt[0]&&ot[1]===dt[1]){Je.polygon.push(Je.ring);continue}mt?(delete Yt[ot],delete $t[mt.ring[0]],mt.ring.pop(),Re[mt.index]=null,Je={index:-1,polygon:mt.polygon,ring:mt.ring.concat(Je.ring)},mt===Et?Je.polygon.push(Je.ring):(Je.index=Zt++,Re.push($t[Je.ring[0]]=Yt[Je.ring[Je.ring.length-1]]=Je))):Et?(delete $t[dt],delete Yt[Et.ring[Et.ring.length-1]],Je.ring.pop(),Je={index:Zt++,polygon:Et.polygon,ring:Je.ring.concat(Et.ring)},Re[Et.index]=null,Re.push($t[Je.ring[0]]=Yt[Je.ring[Je.ring.length-1]]=Je)):(Je.ring.push(Je.ring[0]),Je.polygon.push(Je.ring))}}function Xa(Re){var Ve={type:"Feature",geometry:Os(Re.geometry)};return Re.id!=null&&(Ve.id=Re.id),Re.bbox!=null&&(Ve.bbox=Re.bbox),Re.properties!=null&&(Ve.properties=Re.properties),Ve}function Os(Re){if(Re==null)return Re;var Ve,Je,ot,mt;switch(Re.type){case"GeometryCollection":Ve={type:"GeometryCollection",geometries:Re.geometries.map(Os)};break;case"Point":Ve={type:"Point",coordinates:vi(Re.coordinates)};break;case"MultiPoint":case"LineString":Ve={type:Re.type,coordinates:Qi(Re.coordinates)};break;case"MultiLineString":Ve={type:"MultiLineString",coordinates:Re.coordinates.map(Qi)};break;case"Polygon":var dt=[];Vs(Re.coordinates,dt,Je=[]),Xs(Je),Ve={type:"Polygon",coordinates:dt};break;case"MultiPolygon":Je=[],ot=-1,mt=Re.coordinates.length;for(var Et=new Array(mt);++ot<mt;)Vs(Re.coordinates[ot],Et[ot]=[],Je);Xs(Je),Ve={type:"MultiPolygon",coordinates:Et.filter(zo)};break;default:return Re}return Re.bbox!=null&&(Ve.bbox=Re.bbox),Ve}function ms(Re,Ve){var Je=y(Ve/2),ot=h(T*Je);return[Re*(.74482-.34588*ot*ot),1.70711*Je]}function Zs(Re,Ve,Je){var ot=d.geoInterpolate(Ve,Je),mt=ot(.5),dt=d.geoRotation([-mt[0],-mt[1]])(Ve),Et=ot.distance/2,Zt=-M(h(dt[1]*L)/h(Et)),$t=[-mt[0],-mt[1],-(dt[0]>0?_-Zt:Zt)*k],Yt=d.geoProjection(Re(Et)).rotate($t),nr=d.geoRotation($t),cr=Yt.center;return delete Yt.rotate,Yt.center=function(mr){return arguments.length?cr(nr(mr)):nr.invert(cr())},Yt.clipAngle(90)}function Ks(Re){var Ve=u(Re);function Je(ot,mt){var dt=d.geoGnomonicRaw(ot,mt);return dt[0]*=Ve,dt}return Je.invert=function(ot,mt){return d.geoGnomonicRaw.invert(ot/Ve,mt)},Je}function Hs(Re,Ve){return Zs(Ks,Re,Ve)}function Js(Re){if(!(Re*=2))return d.geoAzimuthalEquidistantRaw;var Ve=-Re/2,Je=-Ve,ot=Re*Re,mt=y(Je),dt=.5/h(Je);function Et(Zt,$t){var Yt=P(u($t)*u(Zt-Ve)),nr=P(u($t)*u(Zt-Je));return[((Yt*=Yt)-(nr*=nr))/(2*Re),($t<0?-1:1)*D(4*ot*nr-(ot-Yt+nr)*(ot-Yt+nr))/(2*Re)]}return Et.invert=function(Zt,$t){var Yt,nr,cr=$t*$t,mr=u(D(cr+(Yt=Zt+Ve)*Yt)),yr=u(D(cr+(Yt=Zt+Je)*Yt));return[f(nr=mr-yr,Yt=(mr+yr)*mt),($t<0?-1:1)*P(D(Yt*Yt+nr*nr)*dt)]},Et}function Uo(Re,Ve){return Zs(Js,Re,Ve)}function Vo(Re,Ve){if(p(Ve)<v)return[Re,0];var Je=p(Ve/x),ot=M(Je);if(p(Re)<v||p(p(Ve)-x)<v)return[0,g(Ve)*_*y(ot/2)];var mt=u(ot),dt=p(_/Re-Re/_)/2,Et=dt*dt,Zt=mt/(Je+mt-1),$t=Zt*(2/Je-1),Yt=$t*$t,nr=Yt+Et,cr=Zt-Yt,mr=Et+Zt;return[g(Re)*_*(dt*cr+D(Et*cr*cr-nr*(Zt*Zt-Yt)))/nr,g(Ve)*_*($t*mr-dt*D((Et+1)*nr-mr*mr))/nr]}function ts(Re,Ve){if(p(Ve)<v)return[Re,0];var Je=p(Ve/x),ot=M(Je);if(p(Re)<v||p(p(Ve)-x)<v)return[0,g(Ve)*_*y(ot/2)];var mt=u(ot),dt=p(_/Re-Re/_)/2,Et=dt*dt,Zt=mt*(D(1+Et)-dt*mt)/(1+Et*Je*Je);return[g(Re)*_*Zt,g(Ve)*_*D(1-Zt*(2*dt+Zt))]}function rs(Re,Ve){if(p(Ve)<v)return[Re,0];var Je=Ve/x,ot=M(Je);if(p(Re)<v||p(p(Ve)-x)<v)return[0,_*y(ot/2)];var mt=(_/Re-Re/_)/2,dt=Je/(1+u(ot));return[_*(g(Re)*D(mt*mt+1-dt*dt)-mt),_*dt]}function ns(Re,Ve){if(!Ve)return[Re,0];var Je=p(Ve);if(!Re||Je===x)return[0,Ve];var ot=Je/x,mt=ot*ot,dt=(8*ot-mt*(mt+2)-5)/(2*mt*(ot-1)),Et=dt*dt,Zt=ot*dt,$t=mt+Et+2*Zt,Yt=ot+3*dt,nr=Re/x,cr=nr+1/nr,mr=g(p(Re)-x)*D(cr*cr-4),yr=mr*mr,Or=(mr*($t+Et-1)+2*D($t*(mt+Et*yr-1)+(1-mt)*(mt*(Yt*Yt+4*Et)+12*Zt*Et+4*Et*Et)))/(4*$t+yr);return[g(Re)*x*Or,g(Ve)*x*D(1+mr*p(Or)-Or*Or)]}function vs(Re,Ve,Je,ot){var mt=_/3;Re=i(Re,v),Ve=i(Ve,v),Re=c(Re,x),Ve=c(Ve,_-v),Je=i(Je,0),Je=c(Je,100-v);var dt=(ot=i(ot,v))/100,Et=P((Je/100+1)*u(mt))/mt,Zt=h(Re)/h(Et*x),$t=Ve/_,Yt=D(dt*h(Re/2)/h(Ve/2));return function(nr,cr,mr,yr,Or){function nn(gn,Cn){var Dn=mr*h(yr*Cn),Hn=D(1-Dn*Dn),zn=D(2/(1+Hn*u(gn*=Or)));return[nr*Hn*zn*h(gn),cr*Dn*zn]}return nn.invert=function(gn,Cn){var Dn=gn/nr,Hn=Cn/cr,zn=D(Dn*Dn+Hn*Hn),ga=2*M(zn/2);return[f(gn*y(ga),nr*zn)/Or,zn&&M(Cn*h(ga)/(cr*mr*zn))/yr]},nn}(Yt/D($t*Zt*Et),1/(Yt*D($t*Zt*Et)),Zt,Et,$t)}function So(){var Re=65*L,Ve=60*L,Je=20,ot=200,mt=d.geoProjectionMutator(vs),dt=mt(Re,Ve,Je,ot);return dt.poleline=function(Et){return arguments.length?mt(Re=+Et*L,Ve,Je,ot):Re*k},dt.parallels=function(Et){return arguments.length?mt(Re,Ve=+Et*L,Je,ot):Ve*k},dt.inflation=function(Et){return arguments.length?mt(Re,Ve,Je=+Et,ot):Je},dt.ratio=function(Et){return arguments.length?mt(Re,Ve,Je,ot=+Et):ot},dt.scale(163.775)}ms.invert=function(Re,Ve){var Je=Ve/1.70711,ot=h(T*Je);return[Re/(.74482-.34588*ot*ot),2*e(Je)]},Vo.invert=function(Re,Ve){if(p(Ve)<v)return[Re,0];if(p(Re)<v)return[0,x*h(2*e(Ve/_))];var Je=(Re/=_)*Re,ot=(Ve/=_)*Ve,mt=Je+ot,dt=mt*mt,Et=-p(Ve)*(1+mt),Zt=Et-2*ot+Je,$t=-2*Et+1+2*ot+dt,Yt=ot/$t+(2*Zt*Zt*Zt/($t*$t*$t)-9*Et*Zt/($t*$t))/27,nr=(Et-Zt*Zt/(3*$t))/$t,cr=2*D(-nr/3),mr=P(3*Yt/(nr*cr))/3;return[_*(mt-1+D(1+2*(Je-ot)+dt))/(2*Re),g(Ve)*_*(-cr*u(mr+_/3)-Zt/(3*$t))]},ts.invert=function(Re,Ve){if(!Re)return[0,x*h(2*e(Ve/_))];var Je=p(Re/_),ot=(1-Je*Je-(Ve/=_)*Ve)/(2*Je),mt=D(ot*ot+1);return[g(Re)*_*(mt-ot),g(Ve)*x*h(2*f(D((1-2*ot*Je)*(ot+mt)-Je),D(mt+ot+Je)))]},rs.invert=function(Re,Ve){if(!Ve)return[Re,0];var Je=Ve/_,ot=(_*_*(1-Je*Je)-Re*Re)/(2*_*Re);return[Re?_*(g(Re)*D(ot*ot+1)-ot):0,x*h(2*e(Je))]},ns.invert=function(Re,Ve){var Je;if(!Re||!Ve)return[Re,Ve];Ve/=_;var ot=g(Re)*Re/x,mt=(ot*ot-1+4*Ve*Ve)/p(ot),dt=mt*mt,Et=2*Ve,Zt=50;do{var $t=Et*Et,Yt=(8*Et-$t*($t+2)-5)/(2*$t*(Et-1)),nr=(3*Et-$t*Et-10)/(2*$t*Et),cr=Yt*Yt,mr=Et*Yt,yr=Et+Yt,Or=yr*yr,nn=Et+3*Yt,gn=-2*yr*(4*mr*cr+(1-4*$t+3*$t*$t)*(1+nr)+cr*(14*$t-6-dt+(8*$t-8-2*dt)*nr)+mr*(12*$t-8+(10*$t-10-dt)*nr)),Cn=D(Or*($t+cr*dt-1)+(1-$t)*($t*(nn*nn+4*cr)+cr*(12*mr+4*cr)));Et-=Je=(mt*(Or+cr-1)+2*Cn-ot*(4*Or+dt))/(mt*(2*Yt*nr+2*yr*(1+nr))+gn/Cn-8*yr*(mt*(-1+cr+Or)+2*Cn)*(1+nr)/(dt+4*Or))}while(Je>v&&--Zt>0);return[g(Re)*(D(mt*mt+4)+mt)*_/4,x*Et]};var Ds=4*_+3*D(3),vo=2*D(2*_*D(3)/Ds),as=ie(vo*D(3)/_,vo,Ds/6);function zs(Re,Ve){return[Re*D(1-3*Ve*Ve/(_*_)),Ve]}function Ho(Re,Ve){var Je=u(Ve),ot=u(Re)*Je,mt=1-ot,dt=u(Re=f(h(Re)*Je,-h(Ve))),Et=h(Re);return[Et*(Je=D(1-ot*ot))-dt*mt,-dt*Je-Et*mt]}function qa(Re,Ve){var Je=X(Re,Ve);return[(Je[0]+Re/x)/2,(Je[1]+Ve)/2]}zs.invert=function(Re,Ve){return[Re/D(1-3*Ve*Ve/(_*_)),Ve]},Ho.invert=function(Re,Ve){var Je=(Re*Re+Ve*Ve)/-2,ot=D(-Je*(2+Je)),mt=Ve*Je+Re*ot,dt=Re*Je-Ve*ot,Et=D(dt*dt+mt*mt);return[f(ot*mt,Et*(1+Je)),Et?-M(ot*dt/Et):0]},qa.invert=function(Re,Ve){var Je=Re,ot=Ve,mt=25;do{var dt,Et=u(ot),Zt=h(ot),$t=h(2*ot),Yt=Zt*Zt,nr=Et*Et,cr=h(Je),mr=u(Je/2),yr=h(Je/2),Or=yr*yr,nn=1-nr*mr*mr,gn=nn?P(Et*mr)*D(dt=1/nn):dt=0,Cn=.5*(2*gn*Et*yr+Je/x)-Re,Dn=.5*(gn*Zt+ot)-Ve,Hn=.5*dt*(nr*Or+gn*Et*mr*Yt)+.5/x,zn=dt*(cr*$t/4-gn*Zt*yr),ga=.125*dt*($t*yr-gn*Zt*nr*cr),ka=.5*dt*(Yt*mr+gn*Or*Et)+.5,Ba=zn*ga-ka*Hn,Fa=(Dn*zn-Cn*ka)/Ba,ja=(Cn*ga-Dn*Hn)/Ba;Je-=Fa,ot-=ja}while((p(Fa)>v||p(ja)>v)&&--mt>0);return[Je,ot]},t.geoNaturalEarth=d.geoNaturalEarth1,t.geoNaturalEarthRaw=d.geoNaturalEarth1Raw,t.geoAiry=function(){var Re=x,Ve=d.geoProjectionMutator(q),Je=Ve(Re);return Je.radius=function(ot){return arguments.length?Ve(Re=ot*L):Re*k},Je.scale(179.976).clipAngle(147)},t.geoAiryRaw=q,t.geoAitoff=function(){return d.geoProjection(X).scale(152.63)},t.geoAitoffRaw=X,t.geoArmadillo=function(){var Re=20*L,Ve=Re>=0?1:-1,Je=y(Ve*Re),ot=d.geoProjectionMutator(K),mt=ot(Re),dt=mt.stream;return mt.parallel=function(Et){return arguments.length?(Je=y((Ve=(Re=Et*L)>=0?1:-1)*Re),ot(Re)):Re*k},mt.stream=function(Et){var Zt=mt.rotate(),$t=dt(Et),Yt=(mt.rotate([0,0]),dt(Et)),nr=mt.precision();return mt.rotate(Zt),$t.sphere=function(){Yt.polygonStart(),Yt.lineStart();for(var cr=-180*Ve;Ve*cr<180;cr+=90*Ve)Yt.point(cr,90*Ve);if(Re)for(;Ve*(cr-=3*Ve*nr)>=-180;)Yt.point(cr,Ve*-f(u(cr*L/2),Je)*k);Yt.lineEnd(),Yt.polygonEnd()},$t},mt.scale(218.695).center([0,28.0974])},t.geoArmadilloRaw=K,t.geoAugust=function(){return d.geoProjection(Z).scale(66.1603)},t.geoAugustRaw=Z,t.geoBaker=function(){return d.geoProjection($).scale(112.314)},t.geoBakerRaw=$,t.geoBerghaus=function(){var Re=5,Ve=d.geoProjectionMutator(z),Je=Ve(Re),ot=Je.stream,mt=-u(.01*L),dt=h(.01*L);return Je.lobes=function(Et){return arguments.length?Ve(Re=+Et):Re},Je.stream=function(Et){var Zt=Je.rotate(),$t=ot(Et),Yt=(Je.rotate([0,0]),ot(Et));return Je.rotate(Zt),$t.sphere=function(){Yt.polygonStart(),Yt.lineStart();for(var nr=0,cr=360/Re,mr=2*_/Re,yr=90-180/Re,Or=x;nr<Re;++nr,yr-=cr,Or-=mr)Yt.point(f(dt*u(Or),mt)*k,M(dt*h(Or))*k),yr<-90?(Yt.point(-90,-180-yr-.01),Yt.point(-90,-180-yr+.01)):(Yt.point(90,yr+.01),Yt.point(90,yr-.01));Yt.lineEnd(),Yt.polygonEnd()},$t},Je.scale(87.8076).center([0,17.1875]).clipAngle(179.999)},t.geoBerghausRaw=z,t.geoBertin1953=function(){return d.geoProjection(Q()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])},t.geoBertin1953Raw=Q,t.geoBoggs=function(){return d.geoProjection(de).scale(160.857)},t.geoBoggsRaw=de,t.geoBonne=function(){return ue(ke).scale(123.082).center([0,26.1441]).parallel(45)},t.geoBonneRaw=ke,t.geoBottomley=function(){var Re=.5,Ve=d.geoProjectionMutator(Ee),Je=Ve(Re);return Je.fraction=function(ot){return arguments.length?Ve(Re=+ot):Re},Je.scale(158.837)},t.geoBottomleyRaw=Ee,t.geoBromley=function(){return d.geoProjection(be).scale(152.63)},t.geoBromleyRaw=be,t.geoChamberlin=Se,t.geoChamberlinRaw=we,t.geoChamberlinAfrica=function(){return Se([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])},t.geoCollignon=function(){return d.geoProjection(ze).scale(95.6464).center([0,30])},t.geoCollignonRaw=ze,t.geoCraig=function(){return ue(Fe).scale(249.828).clipAngle(90)},t.geoCraigRaw=Fe,t.geoCraster=function(){return d.geoProjection(rt).scale(156.19)},t.geoCrasterRaw=rt,t.geoCylindricalEqualArea=function(){return ue(Oe).parallel(38.58).scale(195.044)},t.geoCylindricalEqualAreaRaw=Oe,t.geoCylindricalStereographic=function(){return ue(je).scale(124.75)},t.geoCylindricalStereographicRaw=je,t.geoEckert1=function(){return d.geoProjection(We).scale(165.664)},t.geoEckert1Raw=We,t.geoEckert2=function(){return d.geoProjection(qe).scale(165.664)},t.geoEckert2Raw=qe,t.geoEckert3=function(){return d.geoProjection(Qe).scale(180.739)},t.geoEckert3Raw=Qe,t.geoEckert4=function(){return d.geoProjection(st).scale(180.739)},t.geoEckert4Raw=st,t.geoEckert5=function(){return d.geoProjection(ct).scale(173.044)},t.geoEckert5Raw=ct,t.geoEckert6=function(){return d.geoProjection(Pt).scale(173.044)},t.geoEckert6Raw=Pt,t.geoEisenlohr=function(){return d.geoProjection(at).scale(62.5271)},t.geoEisenlohrRaw=at,t.geoFahey=function(){return d.geoProjection(_t).scale(137.152)},t.geoFaheyRaw=_t,t.geoFoucaut=function(){return d.geoProjection(er).scale(135.264)},t.geoFoucautRaw=er,t.geoFoucautSinusoidal=function(){var Re=.5,Ve=d.geoProjectionMutator(tr),Je=Ve(Re);return Je.alpha=function(ot){return arguments.length?Ve(Re=+ot):Re},Je.scale(168.725)},t.geoFoucautSinusoidalRaw=tr,t.geoGilbert=function(Re){Re==null&&(Re=d.geoOrthographic);var Ve=Re(),Je=d.geoEquirectangular().scale(k).precision(0).clipAngle(null).translate([0,0]);function ot(dt){return Ve(Ue(dt))}function mt(dt){ot[dt]=function(){return arguments.length?(Ve[dt].apply(Ve,arguments),ot):Ve[dt]()}}return Ve.invert&&(ot.invert=function(dt){return He(Ve.invert(dt))}),ot.stream=function(dt){var Et=Ve.stream(dt),Zt=Je.stream({point:function($t,Yt){Et.point($t/2,M(y(-Yt/2*L))*k)},lineStart:function(){Et.lineStart()},lineEnd:function(){Et.lineEnd()},polygonStart:function(){Et.polygonStart()},polygonEnd:function(){Et.polygonEnd()}});return Zt.sphere=Et.sphere,Zt},ot.rotate=function(dt){return arguments.length?(Je.rotate(dt),ot):Je.rotate()},ot.center=function(dt){return arguments.length?(Ve.center(Ue(dt)),ot):He(Ve.center())},mt("angle"),mt("clipAngle"),mt("clipExtent"),mt("fitExtent"),mt("fitHeight"),mt("fitSize"),mt("fitWidth"),mt("scale"),mt("translate"),mt("precision"),ot.scale(249.5)},t.geoGingery=function(){var Re=6,Ve=30*L,Je=u(Ve),ot=h(Ve),mt=d.geoProjectionMutator(Be),dt=mt(Ve,Re),Et=dt.stream,Zt=-u(.01*L),$t=h(.01*L);return dt.radius=function(Yt){return arguments.length?(Je=u(Ve=Yt*L),ot=h(Ve),mt(Ve,Re)):Ve*k},dt.lobes=function(Yt){return arguments.length?mt(Ve,Re=+Yt):Re},dt.stream=function(Yt){var nr=dt.rotate(),cr=Et(Yt),mr=(dt.rotate([0,0]),Et(Yt));return dt.rotate(nr),cr.sphere=function(){mr.polygonStart(),mr.lineStart();for(var yr=0,Or=2*_/Re,nn=0;yr<Re;++yr,nn-=Or)mr.point(f($t*u(nn),Zt)*k,M($t*h(nn))*k),mr.point(f(ot*u(nn-Or/2),Je)*k,M(ot*h(nn-Or/2))*k);mr.lineEnd(),mr.polygonEnd()},cr},dt.rotate([90,-40]).scale(91.7095).clipAngle(179.999)},t.geoGingeryRaw=Be,t.geoGinzburg4=function(){return d.geoProjection(Le).scale(149.995)},t.geoGinzburg4Raw=Le,t.geoGinzburg5=function(){return d.geoProjection(Pe).scale(153.93)},t.geoGinzburg5Raw=Pe,t.geoGinzburg6=function(){return d.geoProjection(Xe).scale(130.945)},t.geoGinzburg6Raw=Xe,t.geoGinzburg8=function(){return d.geoProjection(ht).scale(131.747)},t.geoGinzburg8Raw=ht,t.geoGinzburg9=function(){return d.geoProjection(Mt).scale(131.087)},t.geoGinzburg9Raw=Mt,t.geoGringorten=function(){return d.geoProjection(pt(Lt)).scale(239.75)},t.geoGringortenRaw=Lt,t.geoGuyou=function(){return d.geoProjection(pt(xt)).scale(151.496)},t.geoGuyouRaw=xt,t.geoHammer=function(){var Re=2,Ve=d.geoProjectionMutator(j),Je=Ve(Re);return Je.coefficient=function(ot){return arguments.length?Ve(Re=+ot):Re},Je.scale(169.529)},t.geoHammerRaw=j,t.geoHammerRetroazimuthal=function(){var Re=0,Ve=d.geoProjectionMutator(it),Je=Ve(Re),ot=Je.rotate,mt=Je.stream,dt=d.geoCircle();return Je.parallel=function(Et){if(!arguments.length)return Re*k;var Zt=Je.rotate();return Ve(Re=Et*L).rotate(Zt)},Je.rotate=function(Et){return arguments.length?(ot.call(Je,[Et[0],Et[1]-Re*k]),dt.center([-Et[0],-Et[1]]),Je):((Et=ot.call(Je))[1]+=Re*k,Et)},Je.stream=function(Et){return(Et=mt(Et)).sphere=function(){Et.polygonStart();var Zt,$t=dt.radius(89.99)().coordinates[0],Yt=$t.length-1,nr=-1;for(Et.lineStart();++nr<Yt;)Et.point((Zt=$t[nr])[0],Zt[1]);for(Et.lineEnd(),Yt=($t=dt.radius(90.01)().coordinates[0]).length-1,Et.lineStart();--nr>=0;)Et.point((Zt=$t[nr])[0],Zt[1]);Et.lineEnd(),Et.polygonEnd()},Et},Je.scale(79.4187).parallel(45).clipAngle(179.999)},t.geoHammerRetroazimuthalRaw=it,t.geoHealpix=function(){var Re=4,Ve=d.geoProjectionMutator(Qt),Je=Ve(Re),ot=Je.stream;return Je.lobes=function(mt){return arguments.length?Ve(Re=+mt):Re},Je.stream=function(mt){var dt=Je.rotate(),Et=ot(mt),Zt=(Je.rotate([0,0]),ot(mt));return Je.rotate(dt),Et.sphere=function(){var $t,Yt;d.geoStream(($t=180/Re,Yt=[].concat(m.range(-180,180+$t/2,$t).map(Ie),m.range(180,-180-$t/2,-$t).map(lt)),{type:"Polygon",coordinates:[$t===180?Yt.map(wt):Yt]}),Zt)},Et},Je.scale(239.75)},t.geoHealpixRaw=Qt,t.geoHill=function(){var Re=1,Ve=d.geoProjectionMutator(Ot),Je=Ve(Re);return Je.ratio=function(ot){return arguments.length?Ve(Re=+ot):Re},Je.scale(167.774).center([0,18.67])},t.geoHillRaw=Ot,t.geoHomolosine=function(){return d.geoProjection(ir).scale(152.63)},t.geoHomolosineRaw=ir,t.geoHufnagel=function(){var Re=1,Ve=0,Je=45*L,ot=2,mt=d.geoProjectionMutator(Xt),dt=mt(Re,Ve,Je,ot);return dt.a=function(Et){return arguments.length?mt(Re=+Et,Ve,Je,ot):Re},dt.b=function(Et){return arguments.length?mt(Re,Ve=+Et,Je,ot):Ve},dt.psiMax=function(Et){return arguments.length?mt(Re,Ve,Je=+Et*L,ot):Je*k},dt.ratio=function(Et){return arguments.length?mt(Re,Ve,Je,ot=+Et):ot},dt.scale(180.739)},t.geoHufnagelRaw=Xt,t.geoHyperelliptical=function(){var Re=0,Ve=2.5,Je=1.183136,ot=d.geoProjectionMutator(or),mt=ot(Re,Ve,Je);return mt.alpha=function(dt){return arguments.length?ot(Re=+dt,Ve,Je):Re},mt.k=function(dt){return arguments.length?ot(Re,Ve=+dt,Je):Ve},mt.gamma=function(dt){return arguments.length?ot(Re,Ve,Je=+dt):Je},mt.scale(152.63)},t.geoHyperellipticalRaw=or,t.geoInterrupt=pr,t.geoInterruptedBoggs=function(){return pr(de,br).scale(160.857)},t.geoInterruptedHomolosine=function(){return pr(ir,Rr).scale(152.63)},t.geoInterruptedMollweide=function(){return pr(ae,_r).scale(169.529)},t.geoInterruptedMollweideHemispheres=function(){return pr(ae,jr).scale(169.529).rotate([20,0])},t.geoInterruptedSinuMollweide=function(){return pr(Gt,$r,J).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},t.geoInterruptedSinusoidal=function(){return pr(ve,pn).scale(152.63).rotate([-20,0])},t.geoKavrayskiy7=function(){return d.geoProjection(In).scale(158.837)},t.geoKavrayskiy7Raw=In,t.geoLagrange=function(){var Re=.5,Ve=d.geoProjectionMutator(On),Je=Ve(Re);return Je.spacing=function(ot){return arguments.length?Ve(Re=+ot):Re},Je.scale(124.75)},t.geoLagrangeRaw=On,t.geoLarrivee=function(){return d.geoProjection(an).scale(97.2672)},t.geoLarriveeRaw=an,t.geoLaskowski=function(){return d.geoProjection(Nr).scale(139.98)},t.geoLaskowskiRaw=Nr,t.geoLittrow=function(){return d.geoProjection(Pr).scale(144.049).clipAngle(89.999)},t.geoLittrowRaw=Pr,t.geoLoximuthal=function(){return ue(en).parallel(40).scale(158.837)},t.geoLoximuthalRaw=en,t.geoMiller=function(){return d.geoProjection(tn).scale(108.318)},t.geoMillerRaw=tn,t.geoModifiedStereographic=It,t.geoModifiedStereographicRaw=Qr,t.geoModifiedStereographicAlaska=function(){return It(rn,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)},t.geoModifiedStereographicGs48=function(){return It(An,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])},t.geoModifiedStereographicGs50=function(){return It(En,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])},t.geoModifiedStereographicMiller=function(){return It(Bn,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)},t.geoModifiedStereographicLee=function(){return It(Jt,[165,10]).scale(250).clipAngle(130).center([-165,-10])},t.geoMollweide=function(){return d.geoProjection(ae).scale(169.529)},t.geoMollweideRaw=ae,t.geoMtFlatPolarParabolic=function(){return d.geoProjection(Tr).scale(164.859)},t.geoMtFlatPolarParabolicRaw=Tr,t.geoMtFlatPolarQuartic=function(){return d.geoProjection(Gr).scale(188.209)},t.geoMtFlatPolarQuarticRaw=Gr,t.geoMtFlatPolarSinusoidal=function(){return d.geoProjection(Vr).scale(166.518)},t.geoMtFlatPolarSinusoidalRaw=Vr,t.geoNaturalEarth2=function(){return d.geoProjection(xr).scale(175.295)},t.geoNaturalEarth2Raw=xr,t.geoNellHammer=function(){return d.geoProjection(wr).scale(152.63)},t.geoNellHammerRaw=wr,t.geoInterruptedQuarticAuthalic=function(){return pr(j(1/0),Sr).rotate([20,0]).scale(152.63)},t.geoNicolosi=function(){return d.geoProjection(Mr).scale(127.267)},t.geoNicolosiRaw=Mr,t.geoPatterson=function(){return d.geoProjection(Ir).scale(139.319)},t.geoPattersonRaw=Ir,t.geoPolyconic=function(){return d.geoProjection(qr).scale(103.74)},t.geoPolyconicRaw=qr,t.geoPolyhedral=Dr,t.geoPolyhedralButterfly=function(Re){Re=Re||function(Je){var ot=d.geoCentroid({type:"MultiPoint",coordinates:Je});return d.geoGnomonic().scale(1).translate([0,0]).rotate([-ot[0],-ot[1]])};var Ve=Pn.map(function(Je){return{face:Je,project:Re(Je)}});return[-1,0,0,1,0,1,4,5].forEach(function(Je,ot){var mt=Ve[Je];mt&&(mt.children||(mt.children=[])).push(Ve[ot])}),Dr(Ve[0],function(Je,ot){return Ve[Je<-_/2?ot<0?6:4:Je<0?ot<0?2:0:Je<_/2?ot<0?3:1:ot<0?7:5]}).angle(-30).scale(101.858).center([0,45])},t.geoPolyhedralCollignon=function(Re){Re=Re||function(Je){var ot=d.geoCentroid({type:"MultiPoint",coordinates:Je});return d.geoProjection(Yn).translate([0,0]).scale(1).rotate(ot[1]>0?[-ot[0],0]:[180-ot[0],180])};var Ve=Pn.map(function(Je){return{face:Je,project:Re(Je)}});return[-1,0,0,1,0,1,4,5].forEach(function(Je,ot){var mt=Ve[Je];mt&&(mt.children||(mt.children=[])).push(Ve[ot])}),Dr(Ve[0],function(Je,ot){return Ve[Je<-_/2?ot<0?6:4:Je<0?ot<0?2:0:Je<_/2?ot<0?3:1:ot<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])},t.geoPolyhedralWaterman=function(Re){Re=Re||function(dt){var Et=dt.length===6?d.geoCentroid({type:"MultiPoint",coordinates:dt}):dt[0];return d.geoGnomonic().scale(1).translate([0,0]).rotate([-Et[0],-Et[1]])};var Ve=Pn.map(function(dt){for(var Et,Zt=dt.map(pa),$t=Zt.length,Yt=Zt[$t-1],nr=[],cr=0;cr<$t;++cr)Et=Zt[cr],nr.push(ra([.9486832980505138*Yt[0]+.31622776601683794*Et[0],.9486832980505138*Yt[1]+.31622776601683794*Et[1],.9486832980505138*Yt[2]+.31622776601683794*Et[2]]),ra([.9486832980505138*Et[0]+.31622776601683794*Yt[0],.9486832980505138*Et[1]+.31622776601683794*Yt[1],.9486832980505138*Et[2]+.31622776601683794*Yt[2]])),Yt=Et;return nr}),Je=[],ot=[-1,0,0,1,0,1,4,5];Ve.forEach(function(dt,Et){for(var Zt,$t,Yt=Pn[Et],nr=Yt.length,cr=Je[Et]=[],mr=0;mr<nr;++mr)Ve.push([Yt[mr],dt[(2*mr+2)%(2*nr)],dt[(2*mr+1)%(2*nr)]]),ot.push(Et),cr.push((Zt=pa(dt[(2*mr+2)%(2*nr)]),$t=pa(dt[(2*mr+1)%(2*nr)]),[Zt[1]*$t[2]-Zt[2]*$t[1],Zt[2]*$t[0]-Zt[0]*$t[2],Zt[0]*$t[1]-Zt[1]*$t[0]]))});var mt=Ve.map(function(dt){return{project:Re(dt),face:dt}});return ot.forEach(function(dt,Et){var Zt=mt[dt];Zt&&(Zt.children||(Zt.children=[])).push(mt[Et])}),Dr(mt[0],function(dt,Et){var Zt=u(Et),$t=[Zt*u(dt),Zt*h(dt),h(Et)],Yt=dt<-_/2?Et<0?6:4:dt<0?Et<0?2:0:dt<_/2?Et<0?3:1:Et<0?7:5,nr=Je[Yt];return mt[yn(nr[0],$t)<0?8+3*Yt:yn(nr[1],$t)<0?8+3*Yt+1:yn(nr[2],$t)<0?8+3*Yt+2:Yt]}).angle(-30).scale(110.625).center([0,45])},t.geoProject=function(Re,Ve){var Je,ot=Ve.stream;if(!ot)throw new Error("invalid projection");switch(Re&&Re.type){case"Feature":Je=li;break;case"FeatureCollection":Je=Fi;break;default:Je=ki}return Je(Re,ot)},t.geoGringortenQuincuncial=function(){return $i(Lt).scale(176.423)},t.geoPeirceQuincuncial=to,t.geoPierceQuincuncial=to,t.geoQuantize=function(Re,Ve){if(!(0<=(Ve=+Ve)&&Ve<=20))throw new Error("invalid digits");function Je(Yt){var nr=Yt.length,cr=2,mr=new Array(nr);for(mr[0]=+Yt[0].toFixed(Ve),mr[1]=+Yt[1].toFixed(Ve);cr<nr;)mr[cr]=Yt[cr],++cr;return mr}function ot(Yt){return Yt.map(Je)}function mt(Yt){for(var nr=Je(Yt[0]),cr=[nr],mr=1;mr<Yt.length;mr++){var yr=Je(Yt[mr]);(yr.length>2||yr[0]!=nr[0]||yr[1]!=nr[1])&&(cr.push(yr),nr=yr)}return cr.length===1&&Yt.length>1&&cr.push(Je(Yt[Yt.length-1])),cr}function dt(Yt){return Yt.map(mt)}function Et(Yt){if(Yt==null)return Yt;var nr;switch(Yt.type){case"GeometryCollection":nr={type:"GeometryCollection",geometries:Yt.geometries.map(Et)};break;case"Point":nr={type:"Point",coordinates:Je(Yt.coordinates)};break;case"MultiPoint":nr={type:Yt.type,coordinates:ot(Yt.coordinates)};break;case"LineString":nr={type:Yt.type,coordinates:mt(Yt.coordinates)};break;case"MultiLineString":case"Polygon":nr={type:Yt.type,coordinates:dt(Yt.coordinates)};break;case"MultiPolygon":nr={type:"MultiPolygon",coordinates:Yt.coordinates.map(dt)};break;default:return Yt}return Yt.bbox!=null&&(nr.bbox=Yt.bbox),nr}function Zt(Yt){var nr={type:"Feature",properties:Yt.properties,geometry:Et(Yt.geometry)};return Yt.id!=null&&(nr.id=Yt.id),Yt.bbox!=null&&(nr.bbox=Yt.bbox),nr}if(Re!=null)switch(Re.type){case"Feature":return Zt(Re);case"FeatureCollection":var $t={type:"FeatureCollection",features:Re.features.map(Zt)};return Re.bbox!=null&&($t.bbox=Re.bbox),$t;default:return Et(Re)}return Re},t.geoQuincuncial=$i,t.geoRectangularPolyconic=function(){return ue(es).scale(131.215)},t.geoRectangularPolyconicRaw=es,t.geoRobinson=function(){return d.geoProjection(jo).scale(152.63)},t.geoRobinsonRaw=jo,t.geoSatellite=function(){var Re=2,Ve=0,Je=d.geoProjectionMutator(Ao),ot=Je(Re,Ve);return ot.distance=function(mt){return arguments.length?Je(Re=+mt,Ve):Re},ot.tilt=function(mt){return arguments.length?Je(Re,Ve=mt*L):Ve*k},ot.scale(432.147).clipAngle(P(1/Re)*k-1e-6)},t.geoSatelliteRaw=Ao,t.geoSinuMollweide=function(){return d.geoProjection(Gt).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},t.geoSinuMollweideRaw=Gt,t.geoSinusoidal=function(){return d.geoProjection(ve).scale(152.63)},t.geoSinusoidalRaw=ve,t.geoStitch=function(Re){if(Re==null)return Re;switch(Re.type){case"Feature":return Xa(Re);case"FeatureCollection":var Ve={type:"FeatureCollection",features:Re.features.map(Xa)};return Re.bbox!=null&&(Ve.bbox=Re.bbox),Ve;default:return Os(Re)}},t.geoTimes=function(){return d.geoProjection(ms).scale(146.153)},t.geoTimesRaw=ms,t.geoTwoPointAzimuthal=Hs,t.geoTwoPointAzimuthalRaw=Ks,t.geoTwoPointAzimuthalUsa=function(){return Hs([-158,21.5],[-77,39]).clipAngle(60).scale(400)},t.geoTwoPointEquidistant=Uo,t.geoTwoPointEquidistantRaw=Js,t.geoTwoPointEquidistantUsa=function(){return Uo([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)},t.geoVanDerGrinten=function(){return d.geoProjection(Vo).scale(79.4183)},t.geoVanDerGrintenRaw=Vo,t.geoVanDerGrinten2=function(){return d.geoProjection(ts).scale(79.4183)},t.geoVanDerGrinten2Raw=ts,t.geoVanDerGrinten3=function(){return d.geoProjection(rs).scale(79.4183)},t.geoVanDerGrinten3Raw=rs,t.geoVanDerGrinten4=function(){return d.geoProjection(ns).scale(127.16)},t.geoVanDerGrinten4Raw=ns,t.geoWagner=So,t.geoWagner7=function(){return So().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)},t.geoWagnerRaw=vs,t.geoWagner4=function(){return d.geoProjection(as).scale(176.84)},t.geoWagner4Raw=as,t.geoWagner6=function(){return d.geoProjection(zs).scale(152.63)},t.geoWagner6Raw=zs,t.geoWiechel=function(){return d.geoProjection(Ho).rotate([0,-90,45]).scale(124.75).clipAngle(179.999)},t.geoWiechelRaw=Ho,t.geoWinkel3=function(){return d.geoProjection(qa).scale(158.837)},t.geoWinkel3Raw=qa,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":159,"d3-geo":166}],166:[function(r,O,B){(function(t,d){typeof B=="object"&&O!==void 0?d(B,r("d3-array")):d((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,d){function m(){return new p}function p(){this.reset()}p.prototype={constructor:p,reset:function(){this.s=this.t=0},add:function(ft){f(e,ft,this.t),f(this,e.s,this.s),this.s?this.t+=e.t:this.s=e.t},valueOf:function(){return this.s}};var e=new p;function f(ft,Rt,sr){var Vt=ft.s=Rt+sr,lr=Vt-Rt,Lr=Vt-lr;ft.t=Rt-Lr+(sr-lr)}var u=1e-6,s=Math.PI,l=s/2,o=s/4,i=2*s,c=180/s,n=s/180,a=Math.abs,g=Math.atan,h=Math.atan2,y=Math.cos,v=Math.ceil,_=Math.exp,x=Math.log,T=Math.pow,A=Math.sin,S=Math.sign||function(ft){return ft>0?1:ft<0?-1:0},w=Math.sqrt,C=Math.tan;function k(ft){return ft>1?0:ft<-1?s:Math.acos(ft)}function L(ft){return ft>1?l:ft<-1?-l:Math.asin(ft)}function M(ft){return(ft=A(ft/2))*ft}function P(){}function D(ft,Rt){ft&&U.hasOwnProperty(ft.type)&&U[ft.type](ft,Rt)}var N={Feature:function(ft,Rt){D(ft.geometry,Rt)},FeatureCollection:function(ft,Rt){for(var sr=ft.features,Vt=-1,lr=sr.length;++Vt<lr;)D(sr[Vt].geometry,Rt)}},U={Sphere:function(ft,Rt){Rt.sphere()},Point:function(ft,Rt){ft=ft.coordinates,Rt.point(ft[0],ft[1],ft[2])},MultiPoint:function(ft,Rt){for(var sr=ft.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)ft=sr[Vt],Rt.point(ft[0],ft[1],ft[2])},LineString:function(ft,Rt){q(ft.coordinates,Rt,0)},MultiLineString:function(ft,Rt){for(var sr=ft.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)q(sr[Vt],Rt,0)},Polygon:function(ft,Rt){X(ft.coordinates,Rt)},MultiPolygon:function(ft,Rt){for(var sr=ft.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)X(sr[Vt],Rt)},GeometryCollection:function(ft,Rt){for(var sr=ft.geometries,Vt=-1,lr=sr.length;++Vt<lr;)D(sr[Vt],Rt)}};function q(ft,Rt,sr){var Vt,lr=-1,Lr=ft.length-sr;for(Rt.lineStart();++lr<Lr;)Vt=ft[lr],Rt.point(Vt[0],Vt[1],Vt[2]);Rt.lineEnd()}function X(ft,Rt){var sr=-1,Vt=ft.length;for(Rt.polygonStart();++sr<Vt;)q(ft[sr],Rt,1);Rt.polygonEnd()}function K(ft,Rt){ft&&N.hasOwnProperty(ft.type)?N[ft.type](ft,Rt):D(ft,Rt)}var Z,H,Y,$,z,j=m(),W=m(),ee={point:P,lineStart:P,lineEnd:P,polygonStart:function(){j.reset(),ee.lineStart=J,ee.lineEnd=Q},polygonEnd:function(){var ft=+j;W.add(ft<0?i+ft:ft),this.lineStart=this.lineEnd=this.point=P},sphere:function(){W.add(i)}};function J(){ee.point=te}function Q(){ie(Z,H)}function te(ft,Rt){ee.point=ie,Z=ft,H=Rt,Y=ft*=n,$=y(Rt=(Rt*=n)/2+o),z=A(Rt)}function ie(ft,Rt){var sr=(ft*=n)-Y,Vt=sr>=0?1:-1,lr=Vt*sr,Lr=y(Rt=(Rt*=n)/2+o),zr=A(Rt),Yr=z*zr,ln=$*Lr+Yr*y(lr),on=Yr*Vt*A(lr);j.add(h(on,ln)),Y=ft,$=Lr,z=zr}function ae(ft){return[h(ft[1],ft[0]),L(ft[2])]}function he(ft){var Rt=ft[0],sr=ft[1],Vt=y(sr);return[Vt*y(Rt),Vt*A(Rt),A(sr)]}function se(ft,Rt){return ft[0]*Rt[0]+ft[1]*Rt[1]+ft[2]*Rt[2]}function de(ft,Rt){return[ft[1]*Rt[2]-ft[2]*Rt[1],ft[2]*Rt[0]-ft[0]*Rt[2],ft[0]*Rt[1]-ft[1]*Rt[0]]}function ue(ft,Rt){ft[0]+=Rt[0],ft[1]+=Rt[1],ft[2]+=Rt[2]}function ve(ft,Rt){return[ft[0]*Rt,ft[1]*Rt,ft[2]*Rt]}function ke(ft){var Rt=w(ft[0]*ft[0]+ft[1]*ft[1]+ft[2]*ft[2]);ft[0]/=Rt,ft[1]/=Rt,ft[2]/=Rt}var Ee,be,xe,ce,ge,we,Me,Se,ze,Fe,Ye,rt,Oe,je,We,qe,Qe,st,ct,Pt,kt,at,tt,_t,er,tr,Ue=m(),He={point:Be,lineStart:_e,lineEnd:Ce,polygonStart:function(){He.point=Le,He.lineStart=Pe,He.lineEnd=Xe,Ue.reset(),ee.polygonStart()},polygonEnd:function(){ee.polygonEnd(),He.point=Be,He.lineStart=_e,He.lineEnd=Ce,j<0?(Ee=-(xe=180),be=-(ce=90)):Ue>u?ce=90:Ue<-u&&(be=-90),Fe[0]=Ee,Fe[1]=xe},sphere:function(){Ee=-(xe=180),be=-(ce=90)}};function Be(ft,Rt){ze.push(Fe=[Ee=ft,xe=ft]),Rt<be&&(be=Rt),Rt>ce&&(ce=Rt)}function Ke(ft,Rt){var sr=he([ft*n,Rt*n]);if(Se){var Vt=de(Se,sr),lr=de([Vt[1],-Vt[0],0],Vt);ke(lr),lr=ae(lr);var Lr,zr=ft-ge,Yr=zr>0?1:-1,ln=lr[0]*c*Yr,on=a(zr)>180;on^(Yr*ge<ln&&ln<Yr*ft)?(Lr=lr[1]*c)>ce&&(ce=Lr):on^(Yr*ge<(ln=(ln+360)%360-180)&&ln<Yr*ft)?(Lr=-lr[1]*c)<be&&(be=Lr):(Rt<be&&(be=Rt),Rt>ce&&(ce=Rt)),on?ft<ge?ht(Ee,ft)>ht(Ee,xe)&&(xe=ft):ht(ft,xe)>ht(Ee,xe)&&(Ee=ft):xe>=Ee?(ft<Ee&&(Ee=ft),ft>xe&&(xe=ft)):ft>ge?ht(Ee,ft)>ht(Ee,xe)&&(xe=ft):ht(ft,xe)>ht(Ee,xe)&&(Ee=ft)}else ze.push(Fe=[Ee=ft,xe=ft]);Rt<be&&(be=Rt),Rt>ce&&(ce=Rt),Se=sr,ge=ft}function _e(){He.point=Ke}function Ce(){Fe[0]=Ee,Fe[1]=xe,He.point=Be,Se=null}function Le(ft,Rt){if(Se){var sr=ft-ge;Ue.add(a(sr)>180?sr+(sr>0?360:-360):sr)}else we=ft,Me=Rt;ee.point(ft,Rt),Ke(ft,Rt)}function Pe(){ee.lineStart()}function Xe(){Le(we,Me),ee.lineEnd(),a(Ue)>u&&(Ee=-(xe=180)),Fe[0]=Ee,Fe[1]=xe,Se=null}function ht(ft,Rt){return(Rt-=ft)<0?Rt+360:Rt}function Mt(ft,Rt){return ft[0]-Rt[0]}function pt(ft,Rt){return ft[0]<=ft[1]?ft[0]<=Rt&&Rt<=ft[1]:Rt<ft[0]||ft[1]<Rt}var Lt={sphere:P,point:vt,lineStart:xt,lineEnd:Nt,polygonStart:function(){Lt.lineStart=Ut,Lt.lineEnd=Qt},polygonEnd:function(){Lt.lineStart=xt,Lt.lineEnd=Nt}};function vt(ft,Rt){ft*=n;var sr=y(Rt*=n);Dt(sr*y(ft),sr*A(ft),A(Rt))}function Dt(ft,Rt,sr){++Ye,Oe+=(ft-Oe)/Ye,je+=(Rt-je)/Ye,We+=(sr-We)/Ye}function xt(){Lt.point=it}function it(ft,Rt){ft*=n;var sr=y(Rt*=n);_t=sr*y(ft),er=sr*A(ft),tr=A(Rt),Lt.point=St,Dt(_t,er,tr)}function St(ft,Rt){ft*=n;var sr=y(Rt*=n),Vt=sr*y(ft),lr=sr*A(ft),Lr=A(Rt),zr=h(w((zr=er*Lr-tr*lr)*zr+(zr=tr*Vt-_t*Lr)*zr+(zr=_t*lr-er*Vt)*zr),_t*Vt+er*lr+tr*Lr);rt+=zr,qe+=zr*(_t+(_t=Vt)),Qe+=zr*(er+(er=lr)),st+=zr*(tr+(tr=Lr)),Dt(_t,er,tr)}function Nt(){Lt.point=vt}function Ut(){Lt.point=Ie}function Qt(){lt(at,tt),Lt.point=vt}function Ie(ft,Rt){at=ft,tt=Rt,ft*=n,Rt*=n,Lt.point=lt;var sr=y(Rt);_t=sr*y(ft),er=sr*A(ft),tr=A(Rt),Dt(_t,er,tr)}function lt(ft,Rt){ft*=n;var sr=y(Rt*=n),Vt=sr*y(ft),lr=sr*A(ft),Lr=A(Rt),zr=er*Lr-tr*lr,Yr=tr*Vt-_t*Lr,ln=_t*lr-er*Vt,on=w(zr*zr+Yr*Yr+ln*ln),mn=L(on),wn=on&&-mn/on;ct+=wn*zr,Pt+=wn*Yr,kt+=wn*ln,rt+=mn,qe+=mn*(_t+(_t=Vt)),Qe+=mn*(er+(er=lr)),st+=mn*(tr+(tr=Lr)),Dt(_t,er,tr)}function wt(ft){return function(){return ft}}function Ot(ft,Rt){function sr(Vt,lr){return Vt=ft(Vt,lr),Rt(Vt[0],Vt[1])}return ft.invert&&Rt.invert&&(sr.invert=function(Vt,lr){return(Vt=Rt.invert(Vt,lr))&&ft.invert(Vt[0],Vt[1])}),sr}function Gt(ft,Rt){return[a(ft)>s?ft+Math.round(-ft/i)*i:ft,Rt]}function ir(ft,Rt,sr){return(ft%=i)?Rt||sr?Ot(Kt(ft),or(Rt,sr)):Kt(ft):Rt||sr?or(Rt,sr):Gt}function Xt(ft){return function(Rt,sr){return[(Rt+=ft)>s?Rt-i:Rt<-s?Rt+i:Rt,sr]}}function Kt(ft){var Rt=Xt(ft);return Rt.invert=Xt(-ft),Rt}function or(ft,Rt){var sr=y(ft),Vt=A(ft),lr=y(Rt),Lr=A(Rt);function zr(Yr,ln){var on=y(ln),mn=y(Yr)*on,wn=A(Yr)*on,un=A(ln),Tn=un*sr+mn*Vt;return[h(wn*lr-Tn*Lr,mn*sr-un*Vt),L(Tn*lr+wn*Lr)]}return zr.invert=function(Yr,ln){var on=y(ln),mn=y(Yr)*on,wn=A(Yr)*on,un=A(ln),Tn=un*lr-wn*Lr;return[h(wn*lr+un*Lr,mn*sr+Tn*Vt),L(Tn*sr-mn*Vt)]},zr}function dr(ft){function Rt(sr){return(sr=ft(sr[0]*n,sr[1]*n))[0]*=c,sr[1]*=c,sr}return ft=ir(ft[0]*n,ft[1]*n,ft.length>2?ft[2]*n:0),Rt.invert=function(sr){return(sr=ft.invert(sr[0]*n,sr[1]*n))[0]*=c,sr[1]*=c,sr},Rt}function vr(ft,Rt,sr,Vt,lr,Lr){if(sr){var zr=y(Rt),Yr=A(Rt),ln=Vt*sr;lr==null?(lr=Rt+Vt*i,Lr=Rt-ln/2):(lr=ur(zr,lr),Lr=ur(zr,Lr),(Vt>0?lr<Lr:lr>Lr)&&(lr+=Vt*i));for(var on,mn=lr;Vt>0?mn>Lr:mn<Lr;mn-=ln)on=ae([zr,-Yr*y(mn),-Yr*A(mn)]),ft.point(on[0],on[1])}}function ur(ft,Rt){(Rt=he(Rt))[0]-=ft,ke(Rt);var sr=k(-Rt[1]);return((-Rt[2]<0?-sr:sr)+i-u)%i}function pr(){var ft,Rt=[];return{point:function(sr,Vt,lr){ft.push([sr,Vt,lr])},lineStart:function(){Rt.push(ft=[])},lineEnd:P,rejoin:function(){Rt.length>1&&Rt.push(Rt.pop().concat(Rt.shift()))},result:function(){var sr=Rt;return Rt=[],ft=null,sr}}}function br(ft,Rt){return a(ft[0]-Rt[0])<u&&a(ft[1]-Rt[1])<u}function Rr(ft,Rt,sr,Vt){this.x=ft,this.z=Rt,this.o=sr,this.e=Vt,this.v=!1,this.n=this.p=null}function _r(ft,Rt,sr,Vt,lr){var Lr,zr,Yr=[],ln=[];if(ft.forEach(function(Rn){if(!((Vn=Rn.length-1)<=0)){var Vn,ta,Xr=Rn[0],$n=Rn[Vn];if(br(Xr,$n)){if(!Xr[2]&&!$n[2]){for(lr.lineStart(),Lr=0;Lr<Vn;++Lr)lr.point((Xr=Rn[Lr])[0],Xr[1]);return void lr.lineEnd()}$n[0]+=2*u}Yr.push(ta=new Rr(Xr,Rn,null,!0)),ln.push(ta.o=new Rr(Xr,null,ta,!1)),Yr.push(ta=new Rr($n,Rn,null,!1)),ln.push(ta.o=new Rr($n,null,ta,!0))}}),Yr.length){for(ln.sort(Rt),jr(Yr),jr(ln),Lr=0,zr=ln.length;Lr<zr;++Lr)ln[Lr].e=sr=!sr;for(var on,mn,wn=Yr[0];;){for(var un=wn,Tn=!0;un.v;)if((un=un.n)===wn)return;on=un.z,lr.lineStart();do{if(un.v=un.o.v=!0,un.e){if(Tn)for(Lr=0,zr=on.length;Lr<zr;++Lr)lr.point((mn=on[Lr])[0],mn[1]);else Vt(un.x,un.n.x,1,lr);un=un.n}else{if(Tn)for(on=un.p.z,Lr=on.length-1;Lr>=0;--Lr)lr.point((mn=on[Lr])[0],mn[1]);else Vt(un.x,un.p.x,-1,lr);un=un.p}on=(un=un.o).z,Tn=!Tn}while(!un.v);lr.lineEnd()}}}function jr(ft){if(Rt=ft.length){for(var Rt,sr,Vt=0,lr=ft[0];++Vt<Rt;)lr.n=sr=ft[Vt],sr.p=lr,lr=sr;lr.n=sr=ft[0],sr.p=lr}}Gt.invert=Gt;var $r=m();function pn(ft){return a(ft[0])<=s?ft[0]:S(ft[0])*((a(ft[0])+s)%i-s)}function In(ft,Rt){var sr=pn(Rt),Vt=Rt[1],lr=A(Vt),Lr=[A(sr),-y(sr),0],zr=0,Yr=0;$r.reset(),lr===1?Vt=l+u:lr===-1&&(Vt=-l-u);for(var ln=0,on=ft.length;ln<on;++ln)if(wn=(mn=ft[ln]).length)for(var mn,wn,un=mn[wn-1],Tn=pn(un),Rn=un[1]/2+o,Vn=A(Rn),ta=y(Rn),Xr=0;Xr<wn;++Xr,Tn=Ln,Vn=Jn,ta=Ta,un=$n){var $n=mn[Xr],Ln=pn($n),jn=$n[1]/2+o,Jn=A(jn),Ta=y(jn),Ca=Ln-Tn,Mn=Ca>=0?1:-1,Da=Mn*Ca,Sa=Da>s,da=Vn*Jn;if($r.add(h(da*Mn*A(Da),ta*Ta+da*y(Da))),zr+=Sa?Ca+Mn*i:Ca,Sa^Tn>=sr^Ln>=sr){var za=de(he(un),he($n));ke(za);var Aa=de(Lr,za);ke(Aa);var ti=(Sa^Ca>=0?-1:1)*L(Aa[2]);(Vt>ti||Vt===ti&&(za[0]||za[1]))&&(Yr+=Sa^Ca>=0?1:-1)}}return(zr<-u||zr<u&&$r<-u)^1&Yr}function On(ft,Rt,sr,Vt){return function(lr){var Lr,zr,Yr,ln=Rt(lr),on=pr(),mn=Rt(on),wn=!1,un={point:Tn,lineStart:Vn,lineEnd:ta,polygonStart:function(){un.point=Xr,un.lineStart=$n,un.lineEnd=Ln,zr=[],Lr=[]},polygonEnd:function(){un.point=Tn,un.lineStart=Vn,un.lineEnd=ta,zr=d.merge(zr);var jn=In(Lr,Vt);zr.length?(wn||(lr.polygonStart(),wn=!0),_r(zr,an,jn,sr,lr)):jn&&(wn||(lr.polygonStart(),wn=!0),lr.lineStart(),sr(null,null,1,lr),lr.lineEnd()),wn&&(lr.polygonEnd(),wn=!1),zr=Lr=null},sphere:function(){lr.polygonStart(),lr.lineStart(),sr(null,null,1,lr),lr.lineEnd(),lr.polygonEnd()}};function Tn(jn,Jn){ft(jn,Jn)&&lr.point(jn,Jn)}function Rn(jn,Jn){ln.point(jn,Jn)}function Vn(){un.point=Rn,ln.lineStart()}function ta(){un.point=Tn,ln.lineEnd()}function Xr(jn,Jn){Yr.push([jn,Jn]),mn.point(jn,Jn)}function $n(){mn.lineStart(),Yr=[]}function Ln(){Xr(Yr[0][0],Yr[0][1]),mn.lineEnd();var jn,Jn,Ta,Ca,Mn=mn.clean(),Da=on.result(),Sa=Da.length;if(Yr.pop(),Lr.push(Yr),Yr=null,Sa)if(1&Mn){if((Jn=(Ta=Da[0]).length-1)>0){for(wn||(lr.polygonStart(),wn=!0),lr.lineStart(),jn=0;jn<Jn;++jn)lr.point((Ca=Ta[jn])[0],Ca[1]);lr.lineEnd()}}else Sa>1&&2&Mn&&Da.push(Da.pop().concat(Da.shift())),zr.push(Da.filter(Sn))}return un}}function Sn(ft){return ft.length>1}function an(ft,Rt){return((ft=ft.x)[0]<0?ft[1]-l-u:l-ft[1])-((Rt=Rt.x)[0]<0?Rt[1]-l-u:l-Rt[1])}var Nr=On(function(){return!0},function(ft){var Rt,sr=NaN,Vt=NaN,lr=NaN;return{lineStart:function(){ft.lineStart(),Rt=1},point:function(Lr,zr){var Yr=Lr>0?s:-s,ln=a(Lr-sr);a(ln-s)<u?(ft.point(sr,Vt=(Vt+zr)/2>0?l:-l),ft.point(lr,Vt),ft.lineEnd(),ft.lineStart(),ft.point(Yr,Vt),ft.point(Lr,Vt),Rt=0):lr!==Yr&&ln>=s&&(a(sr-lr)<u&&(sr-=lr*u),a(Lr-Yr)<u&&(Lr-=Yr*u),Vt=function(on,mn,wn,un){var Tn,Rn,Vn=A(on-wn);return a(Vn)>u?g((A(mn)*(Rn=y(un))*A(wn)-A(un)*(Tn=y(mn))*A(on))/(Tn*Rn*Vn)):(mn+un)/2}(sr,Vt,Lr,zr),ft.point(lr,Vt),ft.lineEnd(),ft.lineStart(),ft.point(Yr,Vt),Rt=0),ft.point(sr=Lr,Vt=zr),lr=Yr},lineEnd:function(){ft.lineEnd(),sr=Vt=NaN},clean:function(){return 2-Rt}}},function(ft,Rt,sr,Vt){var lr;if(ft==null)lr=sr*l,Vt.point(-s,lr),Vt.point(0,lr),Vt.point(s,lr),Vt.point(s,0),Vt.point(s,-lr),Vt.point(0,-lr),Vt.point(-s,-lr),Vt.point(-s,0),Vt.point(-s,lr);else if(a(ft[0]-Rt[0])>u){var Lr=ft[0]<Rt[0]?s:-s;lr=sr*Lr/2,Vt.point(-Lr,lr),Vt.point(0,lr),Vt.point(Lr,lr)}else Vt.point(Rt[0],Rt[1])},[-s,-l]);function Pr(ft){var Rt=y(ft),sr=6*n,Vt=Rt>0,lr=a(Rt)>u;function Lr(ln,on){return y(ln)*y(on)>Rt}function zr(ln,on,mn){var wn=[1,0,0],un=de(he(ln),he(on)),Tn=se(un,un),Rn=un[0],Vn=Tn-Rn*Rn;if(!Vn)return!mn&&ln;var ta=Rt*Tn/Vn,Xr=-Rt*Rn/Vn,$n=de(wn,un),Ln=ve(wn,ta);ue(Ln,ve(un,Xr));var jn=$n,Jn=se(Ln,jn),Ta=se(jn,jn),Ca=Jn*Jn-Ta*(se(Ln,Ln)-1);if(!(Ca<0)){var Mn=w(Ca),Da=ve(jn,(-Jn-Mn)/Ta);if(ue(Da,Ln),Da=ae(Da),!mn)return Da;var Sa,da=ln[0],za=on[0],Aa=ln[1],ti=on[1];za<da&&(Sa=da,da=za,za=Sa);var Qn=za-da,Za=a(Qn-s)<u;if(!Za&&ti<Aa&&(Sa=Aa,Aa=ti,ti=Sa),Za||Qn<u?Za?Aa+ti>0^Da[1]<(a(Da[0]-da)<u?Aa:ti):Aa<=Da[1]&&Da[1]<=ti:Qn>s^(da<=Da[0]&&Da[0]<=za)){var Hi=ve(jn,(-Jn+Mn)/Ta);return ue(Hi,Ln),[Da,ae(Hi)]}}}function Yr(ln,on){var mn=Vt?ft:s-ft,wn=0;return ln<-mn?wn|=1:ln>mn&&(wn|=2),on<-mn?wn|=4:on>mn&&(wn|=8),wn}return On(Lr,function(ln){var on,mn,wn,un,Tn;return{lineStart:function(){un=wn=!1,Tn=1},point:function(Rn,Vn){var ta,Xr=[Rn,Vn],$n=Lr(Rn,Vn),Ln=Vt?$n?0:Yr(Rn,Vn):$n?Yr(Rn+(Rn<0?s:-s),Vn):0;if(!on&&(un=wn=$n)&&ln.lineStart(),$n!==wn&&(!(ta=zr(on,Xr))||br(on,ta)||br(Xr,ta))&&(Xr[2]=1),$n!==wn)Tn=0,$n?(ln.lineStart(),ta=zr(Xr,on),ln.point(ta[0],ta[1])):(ta=zr(on,Xr),ln.point(ta[0],ta[1],2),ln.lineEnd()),on=ta;else if(lr&&on&&Vt^$n){var jn;Ln&mn||!(jn=zr(Xr,on,!0))||(Tn=0,Vt?(ln.lineStart(),ln.point(jn[0][0],jn[0][1]),ln.point(jn[1][0],jn[1][1]),ln.lineEnd()):(ln.point(jn[1][0],jn[1][1]),ln.lineEnd(),ln.lineStart(),ln.point(jn[0][0],jn[0][1],3)))}!$n||on&&br(on,Xr)||ln.point(Xr[0],Xr[1]),on=Xr,wn=$n,mn=Ln},lineEnd:function(){wn&&ln.lineEnd(),on=null},clean:function(){return Tn|(un&&wn)<<1}}},function(ln,on,mn,wn){vr(wn,ft,sr,mn,ln,on)},Vt?[0,-ft]:[-s,ft-s])}function en(ft,Rt,sr,Vt){function lr(on,mn){return ft<=on&&on<=sr&&Rt<=mn&&mn<=Vt}function Lr(on,mn,wn,un){var Tn=0,Rn=0;if(on==null||(Tn=zr(on,wn))!==(Rn=zr(mn,wn))||ln(on,mn)<0^wn>0)do un.point(Tn===0||Tn===3?ft:sr,Tn>1?Vt:Rt);while((Tn=(Tn+wn+4)%4)!==Rn);else un.point(mn[0],mn[1])}function zr(on,mn){return a(on[0]-ft)<u?mn>0?0:3:a(on[0]-sr)<u?mn>0?2:1:a(on[1]-Rt)<u?mn>0?1:0:mn>0?3:2}function Yr(on,mn){return ln(on.x,mn.x)}function ln(on,mn){var wn=zr(on,1),un=zr(mn,1);return wn!==un?wn-un:wn===0?mn[1]-on[1]:wn===1?on[0]-mn[0]:wn===2?on[1]-mn[1]:mn[0]-on[0]}return function(on){var mn,wn,un,Tn,Rn,Vn,ta,Xr,$n,Ln,jn,Jn=on,Ta=pr(),Ca={point:Mn,lineStart:function(){Ca.point=Da,wn&&wn.push(un=[]),Ln=!0,$n=!1,ta=Xr=NaN},lineEnd:function(){mn&&(Da(Tn,Rn),Vn&&$n&&Ta.rejoin(),mn.push(Ta.result())),Ca.point=Mn,$n&&Jn.lineEnd()},polygonStart:function(){Jn=Ta,mn=[],wn=[],jn=!0},polygonEnd:function(){var Sa=function(){for(var Aa=0,ti=0,Qn=wn.length;ti<Qn;++ti)for(var Za,Hi,cs=wn[ti],Xo=1,Eo=cs.length,va=cs[0],yi=va[0],Co=va[1];Xo<Eo;++Xo)Za=yi,Hi=Co,va=cs[Xo],yi=va[0],Co=va[1],Hi<=Vt?Co>Vt&&(yi-Za)*(Vt-Hi)>(Co-Hi)*(ft-Za)&&++Aa:Co<=Vt&&(yi-Za)*(Vt-Hi)<(Co-Hi)*(ft-Za)&&--Aa;return Aa}(),da=jn&&Sa,za=(mn=d.merge(mn)).length;(da||za)&&(on.polygonStart(),da&&(on.lineStart(),Lr(null,null,1,on),on.lineEnd()),za&&_r(mn,Yr,Sa,Lr,on),on.polygonEnd()),Jn=on,mn=wn=un=null}};function Mn(Sa,da){lr(Sa,da)&&Jn.point(Sa,da)}function Da(Sa,da){var za=lr(Sa,da);if(wn&&un.push([Sa,da]),Ln)Tn=Sa,Rn=da,Vn=za,Ln=!1,za&&(Jn.lineStart(),Jn.point(Sa,da));else if(za&&$n)Jn.point(Sa,da);else{var Aa=[ta=Math.max(-1e9,Math.min(1e9,ta)),Xr=Math.max(-1e9,Math.min(1e9,Xr))],ti=[Sa=Math.max(-1e9,Math.min(1e9,Sa)),da=Math.max(-1e9,Math.min(1e9,da))];(function(Qn,Za,Hi,cs,Xo,Eo){var va,yi=Qn[0],Co=Qn[1],Ka=0,Si=1,Zi=Za[0]-yi,ai=Za[1]-Co;if(va=Hi-yi,Zi||!(va>0)){if(va/=Zi,Zi<0){if(va<Ka)return;va<Si&&(Si=va)}else if(Zi>0){if(va>Si)return;va>Ka&&(Ka=va)}if(va=Xo-yi,Zi||!(va<0)){if(va/=Zi,Zi<0){if(va>Si)return;va>Ka&&(Ka=va)}else if(Zi>0){if(va<Ka)return;va<Si&&(Si=va)}if(va=cs-Co,ai||!(va>0)){if(va/=ai,ai<0){if(va<Ka)return;va<Si&&(Si=va)}else if(ai>0){if(va>Si)return;va>Ka&&(Ka=va)}if(va=Eo-Co,ai||!(va<0)){if(va/=ai,ai<0){if(va>Si)return;va>Ka&&(Ka=va)}else if(ai>0){if(va<Ka)return;va<Si&&(Si=va)}return Ka>0&&(Qn[0]=yi+Ka*Zi,Qn[1]=Co+Ka*ai),Si<1&&(Za[0]=yi+Si*Zi,Za[1]=Co+Si*ai),!0}}}}})(Aa,ti,ft,Rt,sr,Vt)?($n||(Jn.lineStart(),Jn.point(Aa[0],Aa[1])),Jn.point(ti[0],ti[1]),za||Jn.lineEnd(),jn=!1):za&&(Jn.lineStart(),Jn.point(Sa,da),jn=!1)}ta=Sa,Xr=da,$n=za}return Ca}}var tn,Qr,rn,An=m(),En={sphere:P,point:P,lineStart:function(){En.point=Jt,En.lineEnd=Bn},lineEnd:P,polygonStart:P,polygonEnd:P};function Bn(){En.point=En.lineEnd=P}function Jt(ft,Rt){tn=ft*=n,Qr=A(Rt*=n),rn=y(Rt),En.point=It}function It(ft,Rt){ft*=n;var sr=A(Rt*=n),Vt=y(Rt),lr=a(ft-tn),Lr=y(lr),zr=Vt*A(lr),Yr=rn*sr-Qr*Vt*Lr,ln=Qr*sr+rn*Vt*Lr;An.add(h(w(zr*zr+Yr*Yr),ln)),tn=ft,Qr=sr,rn=Vt}function qt(ft){return An.reset(),K(ft,En),+An}var fr=[null,null],Tr={type:"LineString",coordinates:fr};function Gr(ft,Rt){return fr[0]=ft,fr[1]=Rt,qt(Tr)}var Vr={Feature:function(ft,Rt){return wr(ft.geometry,Rt)},FeatureCollection:function(ft,Rt){for(var sr=ft.features,Vt=-1,lr=sr.length;++Vt<lr;)if(wr(sr[Vt].geometry,Rt))return!0;return!1}},xr={Sphere:function(){return!0},Point:function(ft,Rt){return Sr(ft.coordinates,Rt)},MultiPoint:function(ft,Rt){for(var sr=ft.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)if(Sr(sr[Vt],Rt))return!0;return!1},LineString:function(ft,Rt){return Mr(ft.coordinates,Rt)},MultiLineString:function(ft,Rt){for(var sr=ft.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)if(Mr(sr[Vt],Rt))return!0;return!1},Polygon:function(ft,Rt){return Ir(ft.coordinates,Rt)},MultiPolygon:function(ft,Rt){for(var sr=ft.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)if(Ir(sr[Vt],Rt))return!0;return!1},GeometryCollection:function(ft,Rt){for(var sr=ft.geometries,Vt=-1,lr=sr.length;++Vt<lr;)if(wr(sr[Vt],Rt))return!0;return!1}};function wr(ft,Rt){return!(!ft||!xr.hasOwnProperty(ft.type))&&xr[ft.type](ft,Rt)}function Sr(ft,Rt){return Gr(ft,Rt)===0}function Mr(ft,Rt){for(var sr,Vt,lr,Lr=0,zr=ft.length;Lr<zr;Lr++){if((Vt=Gr(ft[Lr],Rt))===0||Lr>0&&(lr=Gr(ft[Lr],ft[Lr-1]))>0&&sr<=lr&&Vt<=lr&&(sr+Vt-lr)*(1-Math.pow((sr-Vt)/lr,2))<1e-12*lr)return!0;sr=Vt}return!1}function Ir(ft,Rt){return!!In(ft.map(qr),cn(Rt))}function qr(ft){return(ft=ft.map(cn)).pop(),ft}function cn(ft){return[ft[0]*n,ft[1]*n]}function _n(ft,Rt,sr){var Vt=d.range(ft,Rt-u,sr).concat(Rt);return function(lr){return Vt.map(function(Lr){return[lr,Lr]})}}function Jr(ft,Rt,sr){var Vt=d.range(ft,Rt-u,sr).concat(Rt);return function(lr){return Vt.map(function(Lr){return[Lr,lr]})}}function bn(){var ft,Rt,sr,Vt,lr,Lr,zr,Yr,ln,on,mn,wn,un=10,Tn=un,Rn=90,Vn=360,ta=2.5;function Xr(){return{type:"MultiLineString",coordinates:$n()}}function $n(){return d.range(v(Vt/Rn)*Rn,sr,Rn).map(mn).concat(d.range(v(Yr/Vn)*Vn,zr,Vn).map(wn)).concat(d.range(v(Rt/un)*un,ft,un).filter(function(Ln){return a(Ln%Rn)>u}).map(ln)).concat(d.range(v(Lr/Tn)*Tn,lr,Tn).filter(function(Ln){return a(Ln%Vn)>u}).map(on))}return Xr.lines=function(){return $n().map(function(Ln){return{type:"LineString",coordinates:Ln}})},Xr.outline=function(){return{type:"Polygon",coordinates:[mn(Vt).concat(wn(zr).slice(1),mn(sr).reverse().slice(1),wn(Yr).reverse().slice(1))]}},Xr.extent=function(Ln){return arguments.length?Xr.extentMajor(Ln).extentMinor(Ln):Xr.extentMinor()},Xr.extentMajor=function(Ln){return arguments.length?(Vt=+Ln[0][0],sr=+Ln[1][0],Yr=+Ln[0][1],zr=+Ln[1][1],Vt>sr&&(Ln=Vt,Vt=sr,sr=Ln),Yr>zr&&(Ln=Yr,Yr=zr,zr=Ln),Xr.precision(ta)):[[Vt,Yr],[sr,zr]]},Xr.extentMinor=function(Ln){return arguments.length?(Rt=+Ln[0][0],ft=+Ln[1][0],Lr=+Ln[0][1],lr=+Ln[1][1],Rt>ft&&(Ln=Rt,Rt=ft,ft=Ln),Lr>lr&&(Ln=Lr,Lr=lr,lr=Ln),Xr.precision(ta)):[[Rt,Lr],[ft,lr]]},Xr.step=function(Ln){return arguments.length?Xr.stepMajor(Ln).stepMinor(Ln):Xr.stepMinor()},Xr.stepMajor=function(Ln){return arguments.length?(Rn=+Ln[0],Vn=+Ln[1],Xr):[Rn,Vn]},Xr.stepMinor=function(Ln){return arguments.length?(un=+Ln[0],Tn=+Ln[1],Xr):[un,Tn]},Xr.precision=function(Ln){return arguments.length?(ta=+Ln,ln=_n(Lr,lr,90),on=Jr(Rt,ft,ta),mn=_n(Yr,zr,90),wn=Jr(Vt,sr,ta),Xr):ta},Xr.extentMajor([[-180,-90+u],[180,90-u]]).extentMinor([[-180,-80-u],[180,80+u]])}function Dr(ft){return ft}var Wr,vn,dn,Pn,sa=m(),Yn=m(),yn={point:P,lineStart:P,lineEnd:P,polygonStart:function(){yn.lineStart=ra,yn.lineEnd=Fi},polygonEnd:function(){yn.lineStart=yn.lineEnd=yn.point=P,sa.add(a(Yn)),Yn.reset()},result:function(){var ft=sa/2;return sa.reset(),ft}};function ra(){yn.point=pa}function pa(ft,Rt){yn.point=Qa,Wr=dn=ft,vn=Pn=Rt}function Qa(ft,Rt){Yn.add(Pn*ft-dn*Rt),dn=ft,Pn=Rt}function Fi(){Qa(Wr,vn)}var li=1/0,ki=li,Ea=-li,Ga=Ea,ko={point:function(ft,Rt){ft<li&&(li=ft),ft>Ea&&(Ea=ft),Rt<ki&&(ki=Rt),Rt>Ga&&(Ga=Rt)},lineStart:P,lineEnd:P,polygonStart:P,polygonEnd:P,result:function(){var ft=[[li,ki],[Ea,Ga]];return Ea=Ga=-(ki=li=1/0),ft}},Qo,us,$i,to,es=0,Wa=0,jo=0,Ao=0,Ai=0,ro=0,Mo=0,zo=0,Ui=0,vi={point:Qi,lineStart:Vs,lineEnd:Os,polygonStart:function(){vi.lineStart=ms,vi.lineEnd=Zs},polygonEnd:function(){vi.point=Qi,vi.lineStart=Vs,vi.lineEnd=Os},result:function(){var ft=Ui?[Mo/Ui,zo/Ui]:ro?[Ao/ro,Ai/ro]:jo?[es/jo,Wa/jo]:[NaN,NaN];return es=Wa=jo=Ao=Ai=ro=Mo=zo=Ui=0,ft}};function Qi(ft,Rt){es+=ft,Wa+=Rt,++jo}function Vs(){vi.point=Xs}function Xs(ft,Rt){vi.point=Xa,Qi($i=ft,to=Rt)}function Xa(ft,Rt){var sr=ft-$i,Vt=Rt-to,lr=w(sr*sr+Vt*Vt);Ao+=lr*($i+ft)/2,Ai+=lr*(to+Rt)/2,ro+=lr,Qi($i=ft,to=Rt)}function Os(){vi.point=Qi}function ms(){vi.point=Ks}function Zs(){Hs(Qo,us)}function Ks(ft,Rt){vi.point=Hs,Qi(Qo=$i=ft,us=to=Rt)}function Hs(ft,Rt){var sr=ft-$i,Vt=Rt-to,lr=w(sr*sr+Vt*Vt);Ao+=lr*($i+ft)/2,Ai+=lr*(to+Rt)/2,ro+=lr,Mo+=(lr=to*ft-$i*Rt)*($i+ft),zo+=lr*(to+Rt),Ui+=3*lr,Qi($i=ft,to=Rt)}function Js(ft){this._context=ft}Js.prototype={_radius:4.5,pointRadius:function(ft){return this._radius=ft,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(ft,Rt){switch(this._point){case 0:this._context.moveTo(ft,Rt),this._point=1;break;case 1:this._context.lineTo(ft,Rt);break;default:this._context.moveTo(ft+this._radius,Rt),this._context.arc(ft,Rt,this._radius,0,i)}},result:P};var Uo,Vo,ts,rs,ns,vs=m(),So={point:P,lineStart:function(){So.point=Ds},lineEnd:function(){Uo&&vo(Vo,ts),So.point=P},polygonStart:function(){Uo=!0},polygonEnd:function(){Uo=null},result:function(){var ft=+vs;return vs.reset(),ft}};function Ds(ft,Rt){So.point=vo,Vo=rs=ft,ts=ns=Rt}function vo(ft,Rt){rs-=ft,ns-=Rt,vs.add(w(rs*rs+ns*ns)),rs=ft,ns=Rt}function as(){this._string=[]}function zs(ft){return"m0,"+ft+"a"+ft+","+ft+" 0 1,1 0,"+-2*ft+"a"+ft+","+ft+" 0 1,1 0,"+2*ft+"z"}function Ho(ft){return function(Rt){var sr=new qa;for(var Vt in ft)sr[Vt]=ft[Vt];return sr.stream=Rt,sr}}function qa(){}function Re(ft,Rt,sr){var Vt=ft.clipExtent&&ft.clipExtent();return ft.scale(150).translate([0,0]),Vt!=null&&ft.clipExtent(null),K(sr,ft.stream(ko)),Rt(ko.result()),Vt!=null&&ft.clipExtent(Vt),ft}function Ve(ft,Rt,sr){return Re(ft,function(Vt){var lr=Rt[1][0]-Rt[0][0],Lr=Rt[1][1]-Rt[0][1],zr=Math.min(lr/(Vt[1][0]-Vt[0][0]),Lr/(Vt[1][1]-Vt[0][1])),Yr=+Rt[0][0]+(lr-zr*(Vt[1][0]+Vt[0][0]))/2,ln=+Rt[0][1]+(Lr-zr*(Vt[1][1]+Vt[0][1]))/2;ft.scale(150*zr).translate([Yr,ln])},sr)}function Je(ft,Rt,sr){return Ve(ft,[[0,0],Rt],sr)}function ot(ft,Rt,sr){return Re(ft,function(Vt){var lr=+Rt,Lr=lr/(Vt[1][0]-Vt[0][0]),zr=(lr-Lr*(Vt[1][0]+Vt[0][0]))/2,Yr=-Lr*Vt[0][1];ft.scale(150*Lr).translate([zr,Yr])},sr)}function mt(ft,Rt,sr){return Re(ft,function(Vt){var lr=+Rt,Lr=lr/(Vt[1][1]-Vt[0][1]),zr=-Lr*Vt[0][0],Yr=(lr-Lr*(Vt[1][1]+Vt[0][1]))/2;ft.scale(150*Lr).translate([zr,Yr])},sr)}as.prototype={_radius:4.5,_circle:zs(4.5),pointRadius:function(ft){return(ft=+ft)!==this._radius&&(this._radius=ft,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(ft,Rt){switch(this._point){case 0:this._string.push("M",ft,",",Rt),this._point=1;break;case 1:this._string.push("L",ft,",",Rt);break;default:this._circle==null&&(this._circle=zs(this._radius)),this._string.push("M",ft,",",Rt,this._circle)}},result:function(){if(this._string.length){var ft=this._string.join("");return this._string=[],ft}return null}},qa.prototype={constructor:qa,point:function(ft,Rt){this.stream.point(ft,Rt)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var dt=y(30*n);function Et(ft,Rt){return+Rt?function(sr,Vt){function lr(Lr,zr,Yr,ln,on,mn,wn,un,Tn,Rn,Vn,ta,Xr,$n){var Ln=wn-Lr,jn=un-zr,Jn=Ln*Ln+jn*jn;if(Jn>4*Vt&&Xr--){var Ta=ln+Rn,Ca=on+Vn,Mn=mn+ta,Da=w(Ta*Ta+Ca*Ca+Mn*Mn),Sa=L(Mn/=Da),da=a(a(Mn)-1)<u||a(Yr-Tn)<u?(Yr+Tn)/2:h(Ca,Ta),za=sr(da,Sa),Aa=za[0],ti=za[1],Qn=Aa-Lr,Za=ti-zr,Hi=jn*Qn-Ln*Za;(Hi*Hi/Jn>Vt||a((Ln*Qn+jn*Za)/Jn-.5)>.3||ln*Rn+on*Vn+mn*ta<dt)&&(lr(Lr,zr,Yr,ln,on,mn,Aa,ti,da,Ta/=Da,Ca/=Da,Mn,Xr,$n),$n.point(Aa,ti),lr(Aa,ti,da,Ta,Ca,Mn,wn,un,Tn,Rn,Vn,ta,Xr,$n))}}return function(Lr){var zr,Yr,ln,on,mn,wn,un,Tn,Rn,Vn,ta,Xr,$n={point:Ln,lineStart:jn,lineEnd:Ta,polygonStart:function(){Lr.polygonStart(),$n.lineStart=Ca},polygonEnd:function(){Lr.polygonEnd(),$n.lineStart=jn}};function Ln(Sa,da){Sa=sr(Sa,da),Lr.point(Sa[0],Sa[1])}function jn(){Tn=NaN,$n.point=Jn,Lr.lineStart()}function Jn(Sa,da){var za=he([Sa,da]),Aa=sr(Sa,da);lr(Tn,Rn,un,Vn,ta,Xr,Tn=Aa[0],Rn=Aa[1],un=Sa,Vn=za[0],ta=za[1],Xr=za[2],16,Lr),Lr.point(Tn,Rn)}function Ta(){$n.point=Ln,Lr.lineEnd()}function Ca(){jn(),$n.point=Mn,$n.lineEnd=Da}function Mn(Sa,da){Jn(zr=Sa,da),Yr=Tn,ln=Rn,on=Vn,mn=ta,wn=Xr,$n.point=Jn}function Da(){lr(Tn,Rn,un,Vn,ta,Xr,Yr,ln,zr,on,mn,wn,16,Lr),$n.lineEnd=Ta,Ta()}return $n}}(ft,Rt):function(sr){return Ho({point:function(Vt,lr){Vt=sr(Vt,lr),this.stream.point(Vt[0],Vt[1])}})}(ft)}var Zt=Ho({point:function(ft,Rt){this.stream.point(ft*n,Rt*n)}});function $t(ft,Rt,sr,Vt,lr){function Lr(zr,Yr){return[Rt+ft*(zr*=Vt),sr-ft*(Yr*=lr)]}return Lr.invert=function(zr,Yr){return[(zr-Rt)/ft*Vt,(sr-Yr)/ft*lr]},Lr}function Yt(ft,Rt,sr,Vt,lr,Lr){var zr=y(Lr),Yr=A(Lr),ln=zr*ft,on=Yr*ft,mn=zr/ft,wn=Yr/ft,un=(Yr*sr-zr*Rt)/ft,Tn=(Yr*Rt+zr*sr)/ft;function Rn(Vn,ta){return[ln*(Vn*=Vt)-on*(ta*=lr)+Rt,sr-on*Vn-ln*ta]}return Rn.invert=function(Vn,ta){return[Vt*(mn*Vn-wn*ta+un),lr*(Tn-wn*Vn-mn*ta)]},Rn}function nr(ft){return cr(function(){return ft})()}function cr(ft){var Rt,sr,Vt,lr,Lr,zr,Yr,ln,on,mn,wn=150,un=480,Tn=250,Rn=0,Vn=0,ta=0,Xr=0,$n=0,Ln=0,jn=1,Jn=1,Ta=null,Ca=Nr,Mn=null,Da=Dr,Sa=.5;function da(Qn){return ln(Qn[0]*n,Qn[1]*n)}function za(Qn){return(Qn=ln.invert(Qn[0],Qn[1]))&&[Qn[0]*c,Qn[1]*c]}function Aa(){var Qn=Yt(wn,0,0,jn,Jn,Ln).apply(null,Rt(Rn,Vn)),Za=(Ln?Yt:$t)(wn,un-Qn[0],Tn-Qn[1],jn,Jn,Ln);return sr=ir(ta,Xr,$n),Yr=Ot(Rt,Za),ln=Ot(sr,Yr),zr=Et(Yr,Sa),ti()}function ti(){return on=mn=null,da}return da.stream=function(Qn){return on&&mn===Qn?on:on=Zt(function(Za){return Ho({point:function(Hi,cs){var Xo=Za(Hi,cs);return this.stream.point(Xo[0],Xo[1])}})}(sr)(Ca(zr(Da(mn=Qn)))))},da.preclip=function(Qn){return arguments.length?(Ca=Qn,Ta=void 0,ti()):Ca},da.postclip=function(Qn){return arguments.length?(Da=Qn,Mn=Vt=lr=Lr=null,ti()):Da},da.clipAngle=function(Qn){return arguments.length?(Ca=+Qn?Pr(Ta=Qn*n):(Ta=null,Nr),ti()):Ta*c},da.clipExtent=function(Qn){return arguments.length?(Da=Qn==null?(Mn=Vt=lr=Lr=null,Dr):en(Mn=+Qn[0][0],Vt=+Qn[0][1],lr=+Qn[1][0],Lr=+Qn[1][1]),ti()):Mn==null?null:[[Mn,Vt],[lr,Lr]]},da.scale=function(Qn){return arguments.length?(wn=+Qn,Aa()):wn},da.translate=function(Qn){return arguments.length?(un=+Qn[0],Tn=+Qn[1],Aa()):[un,Tn]},da.center=function(Qn){return arguments.length?(Rn=Qn[0]%360*n,Vn=Qn[1]%360*n,Aa()):[Rn*c,Vn*c]},da.rotate=function(Qn){return arguments.length?(ta=Qn[0]%360*n,Xr=Qn[1]%360*n,$n=Qn.length>2?Qn[2]%360*n:0,Aa()):[ta*c,Xr*c,$n*c]},da.angle=function(Qn){return arguments.length?(Ln=Qn%360*n,Aa()):Ln*c},da.reflectX=function(Qn){return arguments.length?(jn=Qn?-1:1,Aa()):jn<0},da.reflectY=function(Qn){return arguments.length?(Jn=Qn?-1:1,Aa()):Jn<0},da.precision=function(Qn){return arguments.length?(zr=Et(Yr,Sa=Qn*Qn),ti()):w(Sa)},da.fitExtent=function(Qn,Za){return Ve(da,Qn,Za)},da.fitSize=function(Qn,Za){return Je(da,Qn,Za)},da.fitWidth=function(Qn,Za){return ot(da,Qn,Za)},da.fitHeight=function(Qn,Za){return mt(da,Qn,Za)},function(){return Rt=ft.apply(this,arguments),da.invert=Rt.invert&&za,Aa()}}function mr(ft){var Rt=0,sr=s/3,Vt=cr(ft),lr=Vt(Rt,sr);return lr.parallels=function(Lr){return arguments.length?Vt(Rt=Lr[0]*n,sr=Lr[1]*n):[Rt*c,sr*c]},lr}function yr(ft,Rt){var sr=A(ft),Vt=(sr+A(Rt))/2;if(a(Vt)<u)return function(Yr){var ln=y(Yr);function on(mn,wn){return[mn*ln,A(wn)/ln]}return on.invert=function(mn,wn){return[mn/ln,L(wn*ln)]},on}(ft);var lr=1+sr*(2*Vt-sr),Lr=w(lr)/Vt;function zr(Yr,ln){var on=w(lr-2*Vt*A(ln))/Vt;return[on*A(Yr*=Vt),Lr-on*y(Yr)]}return zr.invert=function(Yr,ln){var on=Lr-ln,mn=h(Yr,a(on))*S(on);return on*Vt<0&&(mn-=s*S(Yr)*S(on)),[mn/Vt,L((lr-(Yr*Yr+on*on)*Vt*Vt)/(2*Vt))]},zr}function Or(){return mr(yr).scale(155.424).center([0,33.6442])}function nn(){return Or().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function gn(ft){return function(Rt,sr){var Vt=y(Rt),lr=y(sr),Lr=ft(Vt*lr);return[Lr*lr*A(Rt),Lr*A(sr)]}}function Cn(ft){return function(Rt,sr){var Vt=w(Rt*Rt+sr*sr),lr=ft(Vt),Lr=A(lr),zr=y(lr);return[h(Rt*Lr,Vt*zr),L(Vt&&sr*Lr/Vt)]}}var Dn=gn(function(ft){return w(2/(1+ft))});Dn.invert=Cn(function(ft){return 2*L(ft/2)});var Hn=gn(function(ft){return(ft=k(ft))&&ft/A(ft)});function zn(ft,Rt){return[ft,x(C((l+Rt)/2))]}function ga(ft){var Rt,sr,Vt,lr=nr(ft),Lr=lr.center,zr=lr.scale,Yr=lr.translate,ln=lr.clipExtent,on=null;function mn(){var wn=s*zr(),un=lr(dr(lr.rotate()).invert([0,0]));return ln(on==null?[[un[0]-wn,un[1]-wn],[un[0]+wn,un[1]+wn]]:ft===zn?[[Math.max(un[0]-wn,on),Rt],[Math.min(un[0]+wn,sr),Vt]]:[[on,Math.max(un[1]-wn,Rt)],[sr,Math.min(un[1]+wn,Vt)]])}return lr.scale=function(wn){return arguments.length?(zr(wn),mn()):zr()},lr.translate=function(wn){return arguments.length?(Yr(wn),mn()):Yr()},lr.center=function(wn){return arguments.length?(Lr(wn),mn()):Lr()},lr.clipExtent=function(wn){return arguments.length?(wn==null?on=Rt=sr=Vt=null:(on=+wn[0][0],Rt=+wn[0][1],sr=+wn[1][0],Vt=+wn[1][1]),mn()):on==null?null:[[on,Rt],[sr,Vt]]},mn()}function ka(ft){return C((l+ft)/2)}function Ba(ft,Rt){var sr=y(ft),Vt=ft===Rt?A(ft):x(sr/y(Rt))/x(ka(Rt)/ka(ft)),lr=sr*T(ka(ft),Vt)/Vt;if(!Vt)return zn;function Lr(zr,Yr){lr>0?Yr<-l+u&&(Yr=-l+u):Yr>l-u&&(Yr=l-u);var ln=lr/T(ka(Yr),Vt);return[ln*A(Vt*zr),lr-ln*y(Vt*zr)]}return Lr.invert=function(zr,Yr){var ln=lr-Yr,on=S(Vt)*w(zr*zr+ln*ln),mn=h(zr,a(ln))*S(ln);return ln*Vt<0&&(mn-=s*S(zr)*S(ln)),[mn/Vt,2*g(T(lr/on,1/Vt))-l]},Lr}function Fa(ft,Rt){return[ft,Rt]}function ja(ft,Rt){var sr=y(ft),Vt=ft===Rt?A(ft):(sr-y(Rt))/(Rt-ft),lr=sr/Vt+ft;if(a(Vt)<u)return Fa;function Lr(zr,Yr){var ln=lr-Yr,on=Vt*zr;return[ln*A(on),lr-ln*y(on)]}return Lr.invert=function(zr,Yr){var ln=lr-Yr,on=h(zr,a(ln))*S(ln);return ln*Vt<0&&(on-=s*S(zr)*S(ln)),[on/Vt,lr-S(Vt)*w(zr*zr+ln*ln)]},Lr}Hn.invert=Cn(function(ft){return ft}),zn.invert=function(ft,Rt){return[ft,2*g(_(Rt))-l]},Fa.invert=Fa;var Mi=1.340264,wi=-.081106,ui=893e-6,ci=.003796,Ti=w(3)/2;function Vi(ft,Rt){var sr=L(Ti*A(Rt)),Vt=sr*sr,lr=Vt*Vt*Vt;return[ft*y(sr)/(Ti*(Mi+3*wi*Vt+lr*(7*ui+9*ci*Vt))),sr*(Mi+wi*Vt+lr*(ui+ci*Vt))]}function no(ft,Rt){var sr=y(Rt),Vt=y(ft)*sr;return[sr*A(ft)/Vt,A(Rt)/Vt]}function ao(ft,Rt){var sr=Rt*Rt,Vt=sr*sr;return[ft*(.8707-.131979*sr+Vt*(Vt*(.003971*sr-.001529*Vt)-.013791)),Rt*(1.007226+sr*(.015085+Vt*(.028874*sr-.044475-.005916*Vt)))]}function io(ft,Rt){return[y(Rt)*A(ft),A(Rt)]}function oo(ft,Rt){var sr=y(Rt),Vt=1+y(ft)*sr;return[sr*A(ft)/Vt,A(Rt)/Vt]}function Oa(ft,Rt){return[x(C((l+Rt)/2)),-ft]}Vi.invert=function(ft,Rt){for(var sr,Vt=Rt,lr=Vt*Vt,Lr=lr*lr*lr,zr=0;zr<12&&(Lr=(lr=(Vt-=sr=(Vt*(Mi+wi*lr+Lr*(ui+ci*lr))-Rt)/(Mi+3*wi*lr+Lr*(7*ui+9*ci*lr)))*Vt)*lr*lr,!(a(sr)<1e-12));++zr);return[Ti*ft*(Mi+3*wi*lr+Lr*(7*ui+9*ci*lr))/y(Vt),L(A(Vt)/Ti)]},no.invert=Cn(g),ao.invert=function(ft,Rt){var sr,Vt=Rt,lr=25;do{var Lr=Vt*Vt,zr=Lr*Lr;Vt-=sr=(Vt*(1.007226+Lr*(.015085+zr*(.028874*Lr-.044475-.005916*zr)))-Rt)/(1.007226+Lr*(.045255+zr*(.259866*Lr-.311325-.005916*11*zr)))}while(a(sr)>u&&--lr>0);return[ft/(.8707+(Lr=Vt*Vt)*(Lr*(Lr*Lr*Lr*(.003971-.001529*Lr)-.013791)-.131979)),Vt]},io.invert=Cn(L),oo.invert=Cn(function(ft){return 2*g(ft)}),Oa.invert=function(ft,Rt){return[-Rt,2*g(_(ft))-l]},t.geoAlbers=nn,t.geoAlbersUsa=function(){var ft,Rt,sr,Vt,lr,Lr,zr=nn(),Yr=Or().rotate([154,0]).center([-2,58.5]).parallels([55,65]),ln=Or().rotate([157,0]).center([-3,19.9]).parallels([8,18]),on={point:function(un,Tn){Lr=[un,Tn]}};function mn(un){var Tn=un[0],Rn=un[1];return Lr=null,sr.point(Tn,Rn),Lr||(Vt.point(Tn,Rn),Lr)||(lr.point(Tn,Rn),Lr)}function wn(){return ft=Rt=null,mn}return mn.invert=function(un){var Tn=zr.scale(),Rn=zr.translate(),Vn=(un[0]-Rn[0])/Tn,ta=(un[1]-Rn[1])/Tn;return(ta>=.12&&ta<.234&&Vn>=-.425&&Vn<-.214?Yr:ta>=.166&&ta<.234&&Vn>=-.214&&Vn<-.115?ln:zr).invert(un)},mn.stream=function(un){return ft&&Rt===un?ft:(Tn=[zr.stream(Rt=un),Yr.stream(un),ln.stream(un)],Rn=Tn.length,ft={point:function(Vn,ta){for(var Xr=-1;++Xr<Rn;)Tn[Xr].point(Vn,ta)},sphere:function(){for(var Vn=-1;++Vn<Rn;)Tn[Vn].sphere()},lineStart:function(){for(var Vn=-1;++Vn<Rn;)Tn[Vn].lineStart()},lineEnd:function(){for(var Vn=-1;++Vn<Rn;)Tn[Vn].lineEnd()},polygonStart:function(){for(var Vn=-1;++Vn<Rn;)Tn[Vn].polygonStart()},polygonEnd:function(){for(var Vn=-1;++Vn<Rn;)Tn[Vn].polygonEnd()}});var Tn,Rn},mn.precision=function(un){return arguments.length?(zr.precision(un),Yr.precision(un),ln.precision(un),wn()):zr.precision()},mn.scale=function(un){return arguments.length?(zr.scale(un),Yr.scale(.35*un),ln.scale(un),mn.translate(zr.translate())):zr.scale()},mn.translate=function(un){if(!arguments.length)return zr.translate();var Tn=zr.scale(),Rn=+un[0],Vn=+un[1];return sr=zr.translate(un).clipExtent([[Rn-.455*Tn,Vn-.238*Tn],[Rn+.455*Tn,Vn+.238*Tn]]).stream(on),Vt=Yr.translate([Rn-.307*Tn,Vn+.201*Tn]).clipExtent([[Rn-.425*Tn+u,Vn+.12*Tn+u],[Rn-.214*Tn-u,Vn+.234*Tn-u]]).stream(on),lr=ln.translate([Rn-.205*Tn,Vn+.212*Tn]).clipExtent([[Rn-.214*Tn+u,Vn+.166*Tn+u],[Rn-.115*Tn-u,Vn+.234*Tn-u]]).stream(on),wn()},mn.fitExtent=function(un,Tn){return Ve(mn,un,Tn)},mn.fitSize=function(un,Tn){return Je(mn,un,Tn)},mn.fitWidth=function(un,Tn){return ot(mn,un,Tn)},mn.fitHeight=function(un,Tn){return mt(mn,un,Tn)},mn.scale(1070)},t.geoArea=function(ft){return W.reset(),K(ft,ee),2*W},t.geoAzimuthalEqualArea=function(){return nr(Dn).scale(124.75).clipAngle(179.999)},t.geoAzimuthalEqualAreaRaw=Dn,t.geoAzimuthalEquidistant=function(){return nr(Hn).scale(79.4188).clipAngle(179.999)},t.geoAzimuthalEquidistantRaw=Hn,t.geoBounds=function(ft){var Rt,sr,Vt,lr,Lr,zr,Yr;if(ce=xe=-(Ee=be=1/0),ze=[],K(ft,He),sr=ze.length){for(ze.sort(Mt),Rt=1,Lr=[Vt=ze[0]];Rt<sr;++Rt)pt(Vt,(lr=ze[Rt])[0])||pt(Vt,lr[1])?(ht(Vt[0],lr[1])>ht(Vt[0],Vt[1])&&(Vt[1]=lr[1]),ht(lr[0],Vt[1])>ht(Vt[0],Vt[1])&&(Vt[0]=lr[0])):Lr.push(Vt=lr);for(zr=-1/0,Rt=0,Vt=Lr[sr=Lr.length-1];Rt<=sr;Vt=lr,++Rt)lr=Lr[Rt],(Yr=ht(Vt[1],lr[0]))>zr&&(zr=Yr,Ee=lr[0],xe=Vt[1])}return ze=Fe=null,Ee===1/0||be===1/0?[[NaN,NaN],[NaN,NaN]]:[[Ee,be],[xe,ce]]},t.geoCentroid=function(ft){Ye=rt=Oe=je=We=qe=Qe=st=ct=Pt=kt=0,K(ft,Lt);var Rt=ct,sr=Pt,Vt=kt,lr=Rt*Rt+sr*sr+Vt*Vt;return lr<1e-12&&(Rt=qe,sr=Qe,Vt=st,rt<u&&(Rt=Oe,sr=je,Vt=We),(lr=Rt*Rt+sr*sr+Vt*Vt)<1e-12)?[NaN,NaN]:[h(sr,Rt)*c,L(Vt/w(lr))*c]},t.geoCircle=function(){var ft,Rt,sr=wt([0,0]),Vt=wt(90),lr=wt(6),Lr={point:function(Yr,ln){ft.push(Yr=Rt(Yr,ln)),Yr[0]*=c,Yr[1]*=c}};function zr(){var Yr=sr.apply(this,arguments),ln=Vt.apply(this,arguments)*n,on=lr.apply(this,arguments)*n;return ft=[],Rt=ir(-Yr[0]*n,-Yr[1]*n,0).invert,vr(Lr,ln,on,1),Yr={type:"Polygon",coordinates:[ft]},ft=Rt=null,Yr}return zr.center=function(Yr){return arguments.length?(sr=typeof Yr=="function"?Yr:wt([+Yr[0],+Yr[1]]),zr):sr},zr.radius=function(Yr){return arguments.length?(Vt=typeof Yr=="function"?Yr:wt(+Yr),zr):Vt},zr.precision=function(Yr){return arguments.length?(lr=typeof Yr=="function"?Yr:wt(+Yr),zr):lr},zr},t.geoClipAntimeridian=Nr,t.geoClipCircle=Pr,t.geoClipExtent=function(){var ft,Rt,sr,Vt=0,lr=0,Lr=960,zr=500;return sr={stream:function(Yr){return ft&&Rt===Yr?ft:ft=en(Vt,lr,Lr,zr)(Rt=Yr)},extent:function(Yr){return arguments.length?(Vt=+Yr[0][0],lr=+Yr[0][1],Lr=+Yr[1][0],zr=+Yr[1][1],ft=Rt=null,sr):[[Vt,lr],[Lr,zr]]}}},t.geoClipRectangle=en,t.geoConicConformal=function(){return mr(Ba).scale(109.5).parallels([30,30])},t.geoConicConformalRaw=Ba,t.geoConicEqualArea=Or,t.geoConicEqualAreaRaw=yr,t.geoConicEquidistant=function(){return mr(ja).scale(131.154).center([0,13.9389])},t.geoConicEquidistantRaw=ja,t.geoContains=function(ft,Rt){return(ft&&Vr.hasOwnProperty(ft.type)?Vr[ft.type]:wr)(ft,Rt)},t.geoDistance=Gr,t.geoEqualEarth=function(){return nr(Vi).scale(177.158)},t.geoEqualEarthRaw=Vi,t.geoEquirectangular=function(){return nr(Fa).scale(152.63)},t.geoEquirectangularRaw=Fa,t.geoGnomonic=function(){return nr(no).scale(144.049).clipAngle(60)},t.geoGnomonicRaw=no,t.geoGraticule=bn,t.geoGraticule10=function(){return bn()()},t.geoIdentity=function(){var ft,Rt,sr,Vt,lr,Lr,zr,Yr=1,ln=0,on=0,mn=1,wn=1,un=0,Tn=null,Rn=1,Vn=1,ta=Ho({point:function(jn,Jn){var Ta=Ln([jn,Jn]);this.stream.point(Ta[0],Ta[1])}}),Xr=Dr;function $n(){return Rn=Yr*mn,Vn=Yr*wn,Lr=zr=null,Ln}function Ln(jn){var Jn=jn[0]*Rn,Ta=jn[1]*Vn;if(un){var Ca=Ta*ft-Jn*Rt;Jn=Jn*ft+Ta*Rt,Ta=Ca}return[Jn+ln,Ta+on]}return Ln.invert=function(jn){var Jn=jn[0]-ln,Ta=jn[1]-on;if(un){var Ca=Ta*ft+Jn*Rt;Jn=Jn*ft-Ta*Rt,Ta=Ca}return[Jn/Rn,Ta/Vn]},Ln.stream=function(jn){return Lr&&zr===jn?Lr:Lr=ta(Xr(zr=jn))},Ln.postclip=function(jn){return arguments.length?(Xr=jn,Tn=sr=Vt=lr=null,$n()):Xr},Ln.clipExtent=function(jn){return arguments.length?(Xr=jn==null?(Tn=sr=Vt=lr=null,Dr):en(Tn=+jn[0][0],sr=+jn[0][1],Vt=+jn[1][0],lr=+jn[1][1]),$n()):Tn==null?null:[[Tn,sr],[Vt,lr]]},Ln.scale=function(jn){return arguments.length?(Yr=+jn,$n()):Yr},Ln.translate=function(jn){return arguments.length?(ln=+jn[0],on=+jn[1],$n()):[ln,on]},Ln.angle=function(jn){return arguments.length?(Rt=A(un=jn%360*n),ft=y(un),$n()):un*c},Ln.reflectX=function(jn){return arguments.length?(mn=jn?-1:1,$n()):mn<0},Ln.reflectY=function(jn){return arguments.length?(wn=jn?-1:1,$n()):wn<0},Ln.fitExtent=function(jn,Jn){return Ve(Ln,jn,Jn)},Ln.fitSize=function(jn,Jn){return Je(Ln,jn,Jn)},Ln.fitWidth=function(jn,Jn){return ot(Ln,jn,Jn)},Ln.fitHeight=function(jn,Jn){return mt(Ln,jn,Jn)},Ln},t.geoInterpolate=function(ft,Rt){var sr=ft[0]*n,Vt=ft[1]*n,lr=Rt[0]*n,Lr=Rt[1]*n,zr=y(Vt),Yr=A(Vt),ln=y(Lr),on=A(Lr),mn=zr*y(sr),wn=zr*A(sr),un=ln*y(lr),Tn=ln*A(lr),Rn=2*L(w(M(Lr-Vt)+zr*ln*M(lr-sr))),Vn=A(Rn),ta=Rn?function(Xr){var $n=A(Xr*=Rn)/Vn,Ln=A(Rn-Xr)/Vn,jn=Ln*mn+$n*un,Jn=Ln*wn+$n*Tn,Ta=Ln*Yr+$n*on;return[h(Jn,jn)*c,h(Ta,w(jn*jn+Jn*Jn))*c]}:function(){return[sr*c,Vt*c]};return ta.distance=Rn,ta},t.geoLength=qt,t.geoMercator=function(){return ga(zn).scale(961/i)},t.geoMercatorRaw=zn,t.geoNaturalEarth1=function(){return nr(ao).scale(175.295)},t.geoNaturalEarth1Raw=ao,t.geoOrthographic=function(){return nr(io).scale(249.5).clipAngle(90+u)},t.geoOrthographicRaw=io,t.geoPath=function(ft,Rt){var sr,Vt,lr=4.5;function Lr(zr){return zr&&(typeof lr=="function"&&Vt.pointRadius(+lr.apply(this,arguments)),K(zr,sr(Vt))),Vt.result()}return Lr.area=function(zr){return K(zr,sr(yn)),yn.result()},Lr.measure=function(zr){return K(zr,sr(So)),So.result()},Lr.bounds=function(zr){return K(zr,sr(ko)),ko.result()},Lr.centroid=function(zr){return K(zr,sr(vi)),vi.result()},Lr.projection=function(zr){return arguments.length?(sr=zr==null?(ft=null,Dr):(ft=zr).stream,Lr):ft},Lr.context=function(zr){return arguments.length?(Vt=zr==null?(Rt=null,new as):new Js(Rt=zr),typeof lr!="function"&&Vt.pointRadius(lr),Lr):Rt},Lr.pointRadius=function(zr){return arguments.length?(lr=typeof zr=="function"?zr:(Vt.pointRadius(+zr),+zr),Lr):lr},Lr.projection(ft).context(Rt)},t.geoProjection=nr,t.geoProjectionMutator=cr,t.geoRotation=dr,t.geoStereographic=function(){return nr(oo).scale(250).clipAngle(142)},t.geoStereographicRaw=oo,t.geoStream=K,t.geoTransform=function(ft){return{stream:Ho(ft)}},t.geoTransverseMercator=function(){var ft=ga(Oa),Rt=ft.center,sr=ft.rotate;return ft.center=function(Vt){return arguments.length?Rt([-Vt[1],Vt[0]]):[(Vt=Rt())[1],-Vt[0]]},ft.rotate=function(Vt){return arguments.length?sr([Vt[0],Vt[1],Vt.length>2?Vt[2]+90:90]):[(Vt=sr())[0],Vt[1],Vt[2]-90]},sr([0,0,90]).scale(159.155)},t.geoTransverseMercatorRaw=Oa,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":159}],167:[function(r,O,B){(function(t,d){d(typeof B=="object"&&O!==void 0?B:(t=t||self).d3=t.d3||{})})(this,function(t){function d(se,de){return se.parent===de.parent?1:2}function m(se,de){return se+de.x}function p(se,de){return Math.max(se,de.y)}function e(se){var de=0,ue=se.children,ve=ue&&ue.length;if(ve)for(;--ve>=0;)de+=ue[ve].value;else de=1;se.value=de}function f(se,de){var ue,ve,ke,Ee,be,xe=new o(se),ce=+se.value&&(xe.value=se.value),ge=[xe];for(de==null&&(de=u);ue=ge.pop();)if(ce&&(ue.value=+ue.data.value),(ke=de(ue.data))&&(be=ke.length))for(ue.children=new Array(be),Ee=be-1;Ee>=0;--Ee)ge.push(ve=ue.children[Ee]=new o(ke[Ee])),ve.parent=ue,ve.depth=ue.depth+1;return xe.eachBefore(l)}function u(se){return se.children}function s(se){se.data=se.data.data}function l(se){var de=0;do se.height=de;while((se=se.parent)&&se.height<++de)}function o(se){this.data=se,this.depth=this.height=0,this.parent=null}o.prototype=f.prototype={constructor:o,count:function(){return this.eachAfter(e)},each:function(se){var de,ue,ve,ke,Ee=this,be=[Ee];do for(de=be.reverse(),be=[];Ee=de.pop();)if(se(Ee),ue=Ee.children)for(ve=0,ke=ue.length;ve<ke;++ve)be.push(ue[ve]);while(be.length);return this},eachAfter:function(se){for(var de,ue,ve,ke=this,Ee=[ke],be=[];ke=Ee.pop();)if(be.push(ke),de=ke.children)for(ue=0,ve=de.length;ue<ve;++ue)Ee.push(de[ue]);for(;ke=be.pop();)se(ke);return this},eachBefore:function(se){for(var de,ue,ve=this,ke=[ve];ve=ke.pop();)if(se(ve),de=ve.children)for(ue=de.length-1;ue>=0;--ue)ke.push(de[ue]);return this},sum:function(se){return this.eachAfter(function(de){for(var ue=+se(de.data)||0,ve=de.children,ke=ve&&ve.length;--ke>=0;)ue+=ve[ke].value;de.value=ue})},sort:function(se){return this.eachBefore(function(de){de.children&&de.children.sort(se)})},path:function(se){for(var de=this,ue=function(Ee,be){if(Ee===be)return Ee;var xe=Ee.ancestors(),ce=be.ancestors(),ge=null;for(Ee=xe.pop(),be=ce.pop();Ee===be;)ge=Ee,Ee=xe.pop(),be=ce.pop();return ge}(de,se),ve=[de];de!==ue;)de=de.parent,ve.push(de);for(var ke=ve.length;se!==ue;)ve.splice(ke,0,se),se=se.parent;return ve},ancestors:function(){for(var se=this,de=[se];se=se.parent;)de.push(se);return de},descendants:function(){var se=[];return this.each(function(de){se.push(de)}),se},leaves:function(){var se=[];return this.eachBefore(function(de){de.children||se.push(de)}),se},links:function(){var se=this,de=[];return se.each(function(ue){ue!==se&&de.push({source:ue.parent,target:ue})}),de},copy:function(){return f(this).eachBefore(s)}};var i=Array.prototype.slice;function c(se){for(var de,ue,ve=0,ke=(se=function(be){for(var xe,ce,ge=be.length;ge;)ce=Math.random()*ge--|0,xe=be[ge],be[ge]=be[ce],be[ce]=xe;return be}(i.call(se))).length,Ee=[];ve<ke;)de=se[ve],ue&&g(ue,de)?++ve:(ue=y(Ee=n(Ee,de)),ve=0);return ue}function n(se,de){var ue,ve;if(h(de,se))return[de];for(ue=0;ue<se.length;++ue)if(a(de,se[ue])&&h(v(se[ue],de),se))return[se[ue],de];for(ue=0;ue<se.length-1;++ue)for(ve=ue+1;ve<se.length;++ve)if(a(v(se[ue],se[ve]),de)&&a(v(se[ue],de),se[ve])&&a(v(se[ve],de),se[ue])&&h(_(se[ue],se[ve],de),se))return[se[ue],se[ve],de];throw new Error}function a(se,de){var ue=se.r-de.r,ve=de.x-se.x,ke=de.y-se.y;return ue<0||ue*ue<ve*ve+ke*ke}function g(se,de){var ue=se.r-de.r+1e-6,ve=de.x-se.x,ke=de.y-se.y;return ue>0&&ue*ue>ve*ve+ke*ke}function h(se,de){for(var ue=0;ue<de.length;++ue)if(!g(se,de[ue]))return!1;return!0}function y(se){switch(se.length){case 1:return{x:(de=se[0]).x,y:de.y,r:de.r};case 2:return v(se[0],se[1]);case 3:return _(se[0],se[1],se[2])}var de}function v(se,de){var ue=se.x,ve=se.y,ke=se.r,Ee=de.x,be=de.y,xe=de.r,ce=Ee-ue,ge=be-ve,we=xe-ke,Me=Math.sqrt(ce*ce+ge*ge);return{x:(ue+Ee+ce/Me*we)/2,y:(ve+be+ge/Me*we)/2,r:(Me+ke+xe)/2}}function _(se,de,ue){var ve=se.x,ke=se.y,Ee=se.r,be=de.x,xe=de.y,ce=de.r,ge=ue.x,we=ue.y,Me=ue.r,Se=ve-be,ze=ve-ge,Fe=ke-xe,Ye=ke-we,rt=ce-Ee,Oe=Me-Ee,je=ve*ve+ke*ke-Ee*Ee,We=je-be*be-xe*xe+ce*ce,qe=je-ge*ge-we*we+Me*Me,Qe=ze*Fe-Se*Ye,st=(Fe*qe-Ye*We)/(2*Qe)-ve,ct=(Ye*rt-Fe*Oe)/Qe,Pt=(ze*We-Se*qe)/(2*Qe)-ke,kt=(Se*Oe-ze*rt)/Qe,at=ct*ct+kt*kt-1,tt=2*(Ee+st*ct+Pt*kt),_t=st*st+Pt*Pt-Ee*Ee,er=-(at?(tt+Math.sqrt(tt*tt-4*at*_t))/(2*at):_t/tt);return{x:ve+st+ct*er,y:ke+Pt+kt*er,r:er}}function x(se,de,ue){var ve,ke,Ee,be,xe=se.x-de.x,ce=se.y-de.y,ge=xe*xe+ce*ce;ge?(ke=de.r+ue.r,ke*=ke,be=se.r+ue.r,ke>(be*=be)?(ve=(ge+be-ke)/(2*ge),Ee=Math.sqrt(Math.max(0,be/ge-ve*ve)),ue.x=se.x-ve*xe-Ee*ce,ue.y=se.y-ve*ce+Ee*xe):(ve=(ge+ke-be)/(2*ge),Ee=Math.sqrt(Math.max(0,ke/ge-ve*ve)),ue.x=de.x+ve*xe-Ee*ce,ue.y=de.y+ve*ce+Ee*xe)):(ue.x=de.x+ue.r,ue.y=de.y)}function T(se,de){var ue=se.r+de.r-1e-6,ve=de.x-se.x,ke=de.y-se.y;return ue>0&&ue*ue>ve*ve+ke*ke}function A(se){var de=se._,ue=se.next._,ve=de.r+ue.r,ke=(de.x*ue.r+ue.x*de.r)/ve,Ee=(de.y*ue.r+ue.y*de.r)/ve;return ke*ke+Ee*Ee}function S(se){this._=se,this.next=null,this.previous=null}function w(se){if(!(ke=se.length))return 0;var de,ue,ve,ke,Ee,be,xe,ce,ge,we,Me;if((de=se[0]).x=0,de.y=0,!(ke>1))return de.r;if(ue=se[1],de.x=-ue.r,ue.x=de.r,ue.y=0,!(ke>2))return de.r+ue.r;x(ue,de,ve=se[2]),de=new S(de),ue=new S(ue),ve=new S(ve),de.next=ve.previous=ue,ue.next=de.previous=ve,ve.next=ue.previous=de;e:for(xe=3;xe<ke;++xe){x(de._,ue._,ve=se[xe]),ve=new S(ve),ce=ue.next,ge=de.previous,we=ue._.r,Me=de._.r;do if(we<=Me){if(T(ce._,ve._)){ue=ce,de.next=ue,ue.previous=de,--xe;continue e}we+=ce._.r,ce=ce.next}else{if(T(ge._,ve._)){(de=ge).next=ue,ue.previous=de,--xe;continue e}Me+=ge._.r,ge=ge.previous}while(ce!==ge.next);for(ve.previous=de,ve.next=ue,de.next=ue.previous=ue=ve,Ee=A(de);(ve=ve.next)!==ue;)(be=A(ve))<Ee&&(de=ve,Ee=be);ue=de.next}for(de=[ue._],ve=ue;(ve=ve.next)!==ue;)de.push(ve._);for(ve=c(de),xe=0;xe<ke;++xe)(de=se[xe]).x-=ve.x,de.y-=ve.y;return ve.r}function C(se){return se==null?null:k(se)}function k(se){if(typeof se!="function")throw new Error;return se}function L(){return 0}function M(se){return function(){return se}}function P(se){return Math.sqrt(se.value)}function D(se){return function(de){de.children||(de.r=Math.max(0,+se(de)||0))}}function N(se,de){return function(ue){if(ve=ue.children){var ve,ke,Ee,be=ve.length,xe=se(ue)*de||0;if(xe)for(ke=0;ke<be;++ke)ve[ke].r+=xe;if(Ee=w(ve),xe)for(ke=0;ke<be;++ke)ve[ke].r-=xe;ue.r=Ee+xe}}}function U(se){return function(de){var ue=de.parent;de.r*=se,ue&&(de.x=ue.x+se*de.x,de.y=ue.y+se*de.y)}}function q(se){se.x0=Math.round(se.x0),se.y0=Math.round(se.y0),se.x1=Math.round(se.x1),se.y1=Math.round(se.y1)}function X(se,de,ue,ve,ke){for(var Ee,be=se.children,xe=-1,ce=be.length,ge=se.value&&(ve-de)/se.value;++xe<ce;)(Ee=be[xe]).y0=ue,Ee.y1=ke,Ee.x0=de,Ee.x1=de+=Ee.value*ge}var K={depth:-1},Z={};function H(se){return se.id}function Y(se){return se.parentId}function $(se,de){return se.parent===de.parent?1:2}function z(se){var de=se.children;return de?de[0]:se.t}function j(se){var de=se.children;return de?de[de.length-1]:se.t}function W(se,de,ue){var ve=ue/(de.i-se.i);de.c-=ve,de.s+=ue,se.c+=ve,de.z+=ue,de.m+=ue}function ee(se,de,ue){return se.a.parent===de.parent?se.a:ue}function J(se,de){this._=se,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=de}function Q(se,de,ue,ve,ke){for(var Ee,be=se.children,xe=-1,ce=be.length,ge=se.value&&(ke-ue)/se.value;++xe<ce;)(Ee=be[xe]).x0=de,Ee.x1=ve,Ee.y0=ue,Ee.y1=ue+=Ee.value*ge}J.prototype=Object.create(o.prototype);var te=(1+Math.sqrt(5))/2;function ie(se,de,ue,ve,ke,Ee){for(var be,xe,ce,ge,we,Me,Se,ze,Fe,Ye,rt,Oe=[],je=de.children,We=0,qe=0,Qe=je.length,st=de.value;We<Qe;){ce=ke-ue,ge=Ee-ve;do we=je[qe++].value;while(!we&&qe<Qe);for(Me=Se=we,rt=we*we*(Ye=Math.max(ge/ce,ce/ge)/(st*se)),Fe=Math.max(Se/rt,rt/Me);qe<Qe;++qe){if(we+=xe=je[qe].value,xe<Me&&(Me=xe),xe>Se&&(Se=xe),rt=we*we*Ye,(ze=Math.max(Se/rt,rt/Me))>Fe){we-=xe;break}Fe=ze}Oe.push(be={value:we,dice:ce<ge,children:je.slice(We,qe)}),be.dice?X(be,ue,ve,ke,st?ve+=ge*we/st:Ee):Q(be,ue,ve,st?ue+=ce*we/st:ke,Ee),st-=we,We=qe}return Oe}var ae=function se(de){function ue(ve,ke,Ee,be,xe){ie(de,ve,ke,Ee,be,xe)}return ue.ratio=function(ve){return se((ve=+ve)>1?ve:1)},ue}(te),he=function se(de){function ue(ve,ke,Ee,be,xe){if((ce=ve._squarify)&&ce.ratio===de)for(var ce,ge,we,Me,Se,ze=-1,Fe=ce.length,Ye=ve.value;++ze<Fe;){for(we=(ge=ce[ze]).children,Me=ge.value=0,Se=we.length;Me<Se;++Me)ge.value+=we[Me].value;ge.dice?X(ge,ke,Ee,be,Ee+=(xe-Ee)*ge.value/Ye):Q(ge,ke,Ee,ke+=(be-ke)*ge.value/Ye,xe),Ye-=ge.value}else ve._squarify=ce=ie(de,ve,ke,Ee,be,xe),ce.ratio=de}return ue.ratio=function(ve){return se((ve=+ve)>1?ve:1)},ue}(te);t.cluster=function(){var se=d,de=1,ue=1,ve=!1;function ke(Ee){var be,xe=0;Ee.eachAfter(function(Se){var ze=Se.children;ze?(Se.x=function(Fe){return Fe.reduce(m,0)/Fe.length}(ze),Se.y=function(Fe){return 1+Fe.reduce(p,0)}(ze)):(Se.x=be?xe+=se(Se,be):0,Se.y=0,be=Se)});var ce=function(Se){for(var ze;ze=Se.children;)Se=ze[0];return Se}(Ee),ge=function(Se){for(var ze;ze=Se.children;)Se=ze[ze.length-1];return Se}(Ee),we=ce.x-se(ce,ge)/2,Me=ge.x+se(ge,ce)/2;return Ee.eachAfter(ve?function(Se){Se.x=(Se.x-Ee.x)*de,Se.y=(Ee.y-Se.y)*ue}:function(Se){Se.x=(Se.x-we)/(Me-we)*de,Se.y=(1-(Ee.y?Se.y/Ee.y:1))*ue})}return ke.separation=function(Ee){return arguments.length?(se=Ee,ke):se},ke.size=function(Ee){return arguments.length?(ve=!1,de=+Ee[0],ue=+Ee[1],ke):ve?null:[de,ue]},ke.nodeSize=function(Ee){return arguments.length?(ve=!0,de=+Ee[0],ue=+Ee[1],ke):ve?[de,ue]:null},ke},t.hierarchy=f,t.pack=function(){var se=null,de=1,ue=1,ve=L;function ke(Ee){return Ee.x=de/2,Ee.y=ue/2,se?Ee.eachBefore(D(se)).eachAfter(N(ve,.5)).eachBefore(U(1)):Ee.eachBefore(D(P)).eachAfter(N(L,1)).eachAfter(N(ve,Ee.r/Math.min(de,ue))).eachBefore(U(Math.min(de,ue)/(2*Ee.r))),Ee}return ke.radius=function(Ee){return arguments.length?(se=C(Ee),ke):se},ke.size=function(Ee){return arguments.length?(de=+Ee[0],ue=+Ee[1],ke):[de,ue]},ke.padding=function(Ee){return arguments.length?(ve=typeof Ee=="function"?Ee:M(+Ee),ke):ve},ke},t.packEnclose=c,t.packSiblings=function(se){return w(se),se},t.partition=function(){var se=1,de=1,ue=0,ve=!1;function ke(Ee){var be=Ee.height+1;return Ee.x0=Ee.y0=ue,Ee.x1=se,Ee.y1=de/be,Ee.eachBefore(function(xe,ce){return function(ge){ge.children&&X(ge,ge.x0,xe*(ge.depth+1)/ce,ge.x1,xe*(ge.depth+2)/ce);var we=ge.x0,Me=ge.y0,Se=ge.x1-ue,ze=ge.y1-ue;Se<we&&(we=Se=(we+Se)/2),ze<Me&&(Me=ze=(Me+ze)/2),ge.x0=we,ge.y0=Me,ge.x1=Se,ge.y1=ze}}(de,be)),ve&&Ee.eachBefore(q),Ee}return ke.round=function(Ee){return arguments.length?(ve=!!Ee,ke):ve},ke.size=function(Ee){return arguments.length?(se=+Ee[0],de=+Ee[1],ke):[se,de]},ke.padding=function(Ee){return arguments.length?(ue=+Ee,ke):ue},ke},t.stratify=function(){var se=H,de=Y;function ue(ve){var ke,Ee,be,xe,ce,ge,we,Me=ve.length,Se=new Array(Me),ze={};for(Ee=0;Ee<Me;++Ee)ke=ve[Ee],ce=Se[Ee]=new o(ke),(ge=se(ke,Ee,ve))!=null&&(ge+="")&&(ze[we="$"+(ce.id=ge)]=we in ze?Z:ce);for(Ee=0;Ee<Me;++Ee)if(ce=Se[Ee],(ge=de(ve[Ee],Ee,ve))!=null&&(ge+="")){if(!(xe=ze["$"+ge]))throw new Error("missing: "+ge);if(xe===Z)throw new Error("ambiguous: "+ge);xe.children?xe.children.push(ce):xe.children=[ce],ce.parent=xe}else{if(be)throw new Error("multiple roots");be=ce}if(!be)throw new Error("no root");if(be.parent=K,be.eachBefore(function(Fe){Fe.depth=Fe.parent.depth+1,--Me}).eachBefore(l),be.parent=null,Me>0)throw new Error("cycle");return be}return ue.id=function(ve){return arguments.length?(se=k(ve),ue):se},ue.parentId=function(ve){return arguments.length?(de=k(ve),ue):de},ue},t.tree=function(){var se=$,de=1,ue=1,ve=null;function ke(ce){var ge=function(Oe){for(var je,We,qe,Qe,st,ct=new J(Oe,0),Pt=[ct];je=Pt.pop();)if(qe=je._.children)for(je.children=new Array(st=qe.length),Qe=st-1;Qe>=0;--Qe)Pt.push(We=je.children[Qe]=new J(qe[Qe],Qe)),We.parent=je;return(ct.parent=new J(null,0)).children=[ct],ct}(ce);if(ge.eachAfter(Ee),ge.parent.m=-ge.z,ge.eachBefore(be),ve)ce.eachBefore(xe);else{var we=ce,Me=ce,Se=ce;ce.eachBefore(function(Oe){Oe.x<we.x&&(we=Oe),Oe.x>Me.x&&(Me=Oe),Oe.depth>Se.depth&&(Se=Oe)});var ze=we===Me?1:se(we,Me)/2,Fe=ze-we.x,Ye=de/(Me.x+ze+Fe),rt=ue/(Se.depth||1);ce.eachBefore(function(Oe){Oe.x=(Oe.x+Fe)*Ye,Oe.y=Oe.depth*rt})}return ce}function Ee(ce){var ge=ce.children,we=ce.parent.children,Me=ce.i?we[ce.i-1]:null;if(ge){(function(ze){for(var Fe,Ye=0,rt=0,Oe=ze.children,je=Oe.length;--je>=0;)(Fe=Oe[je]).z+=Ye,Fe.m+=Ye,Ye+=Fe.s+(rt+=Fe.c)})(ce);var Se=(ge[0].z+ge[ge.length-1].z)/2;Me?(ce.z=Me.z+se(ce._,Me._),ce.m=ce.z-Se):ce.z=Se}else Me&&(ce.z=Me.z+se(ce._,Me._));ce.parent.A=function(ze,Fe,Ye){if(Fe){for(var rt,Oe=ze,je=ze,We=Fe,qe=Oe.parent.children[0],Qe=Oe.m,st=je.m,ct=We.m,Pt=qe.m;We=j(We),Oe=z(Oe),We&&Oe;)qe=z(qe),(je=j(je)).a=ze,(rt=We.z+ct-Oe.z-Qe+se(We._,Oe._))>0&&(W(ee(We,ze,Ye),ze,rt),Qe+=rt,st+=rt),ct+=We.m,Qe+=Oe.m,Pt+=qe.m,st+=je.m;We&&!j(je)&&(je.t=We,je.m+=ct-st),Oe&&!z(qe)&&(qe.t=Oe,qe.m+=Qe-Pt,Ye=ze)}return Ye}(ce,Me,ce.parent.A||we[0])}function be(ce){ce._.x=ce.z+ce.parent.m,ce.m+=ce.parent.m}function xe(ce){ce.x*=de,ce.y=ce.depth*ue}return ke.separation=function(ce){return arguments.length?(se=ce,ke):se},ke.size=function(ce){return arguments.length?(ve=!1,de=+ce[0],ue=+ce[1],ke):ve?null:[de,ue]},ke.nodeSize=function(ce){return arguments.length?(ve=!0,de=+ce[0],ue=+ce[1],ke):ve?[de,ue]:null},ke},t.treemap=function(){var se=ae,de=!1,ue=1,ve=1,ke=[0],Ee=L,be=L,xe=L,ce=L,ge=L;function we(Se){return Se.x0=Se.y0=0,Se.x1=ue,Se.y1=ve,Se.eachBefore(Me),ke=[0],de&&Se.eachBefore(q),Se}function Me(Se){var ze=ke[Se.depth],Fe=Se.x0+ze,Ye=Se.y0+ze,rt=Se.x1-ze,Oe=Se.y1-ze;rt<Fe&&(Fe=rt=(Fe+rt)/2),Oe<Ye&&(Ye=Oe=(Ye+Oe)/2),Se.x0=Fe,Se.y0=Ye,Se.x1=rt,Se.y1=Oe,Se.children&&(ze=ke[Se.depth+1]=Ee(Se)/2,Fe+=ge(Se)-ze,Ye+=be(Se)-ze,(rt-=xe(Se)-ze)<Fe&&(Fe=rt=(Fe+rt)/2),(Oe-=ce(Se)-ze)<Ye&&(Ye=Oe=(Ye+Oe)/2),se(Se,Fe,Ye,rt,Oe))}return we.round=function(Se){return arguments.length?(de=!!Se,we):de},we.size=function(Se){return arguments.length?(ue=+Se[0],ve=+Se[1],we):[ue,ve]},we.tile=function(Se){return arguments.length?(se=k(Se),we):se},we.padding=function(Se){return arguments.length?we.paddingInner(Se).paddingOuter(Se):we.paddingInner()},we.paddingInner=function(Se){return arguments.length?(Ee=typeof Se=="function"?Se:M(+Se),we):Ee},we.paddingOuter=function(Se){return arguments.length?we.paddingTop(Se).paddingRight(Se).paddingBottom(Se).paddingLeft(Se):we.paddingTop()},we.paddingTop=function(Se){return arguments.length?(be=typeof Se=="function"?Se:M(+Se),we):be},we.paddingRight=function(Se){return arguments.length?(xe=typeof Se=="function"?Se:M(+Se),we):xe},we.paddingBottom=function(Se){return arguments.length?(ce=typeof Se=="function"?Se:M(+Se),we):ce},we.paddingLeft=function(Se){return arguments.length?(ge=typeof Se=="function"?Se:M(+Se),we):ge},we},t.treemapBinary=function(se,de,ue,ve,ke){var Ee,be,xe=se.children,ce=xe.length,ge=new Array(ce+1);for(ge[0]=be=Ee=0;Ee<ce;++Ee)ge[Ee+1]=be+=xe[Ee].value;(function we(Me,Se,ze,Fe,Ye,rt,Oe){if(Me>=Se-1){var je=xe[Me];return je.x0=Fe,je.y0=Ye,je.x1=rt,void(je.y1=Oe)}for(var We=ge[Me],qe=ze/2+We,Qe=Me+1,st=Se-1;Qe<st;){var ct=Qe+st>>>1;ge[ct]<qe?Qe=ct+1:st=ct}qe-ge[Qe-1]<ge[Qe]-qe&&Me+1<Qe&&--Qe;var Pt=ge[Qe]-We,kt=ze-Pt;if(rt-Fe>Oe-Ye){var at=(Fe*kt+rt*Pt)/ze;we(Me,Qe,Pt,Fe,Ye,at,Oe),we(Qe,Se,kt,at,Ye,rt,Oe)}else{var tt=(Ye*kt+Oe*Pt)/ze;we(Me,Qe,Pt,Fe,Ye,rt,tt),we(Qe,Se,kt,Fe,tt,rt,Oe)}})(0,ce,se.value,de,ue,ve,ke)},t.treemapDice=X,t.treemapResquarify=he,t.treemapSlice=Q,t.treemapSliceDice=function(se,de,ue,ve,ke){(1&se.depth?Q:X)(se,de,ue,ve,ke)},t.treemapSquarify=ae,Object.defineProperty(t,"__esModule",{value:!0})})},{}],168:[function(r,O,B){(function(t,d){typeof B=="object"&&O!==void 0?d(B,r("d3-color")):d((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,d){function m(te,ie,ae,he,se){var de=te*te,ue=de*te;return((1-3*te+3*de-ue)*ie+(4-6*de+3*ue)*ae+(1+3*te+3*de-3*ue)*he+ue*se)/6}function p(te){var ie=te.length-1;return function(ae){var he=ae<=0?ae=0:ae>=1?(ae=1,ie-1):Math.floor(ae*ie),se=te[he],de=te[he+1],ue=he>0?te[he-1]:2*se-de,ve=he<ie-1?te[he+2]:2*de-se;return m((ae-he/ie)*ie,ue,se,de,ve)}}function e(te){var ie=te.length;return function(ae){var he=Math.floor(((ae%=1)<0?++ae:ae)*ie),se=te[(he+ie-1)%ie],de=te[he%ie],ue=te[(he+1)%ie],ve=te[(he+2)%ie];return m((ae-he/ie)*ie,se,de,ue,ve)}}function f(te){return function(){return te}}function u(te,ie){return function(ae){return te+ae*ie}}function s(te,ie){var ae=ie-te;return ae?u(te,ae>180||ae<-180?ae-360*Math.round(ae/360):ae):f(isNaN(te)?ie:te)}function l(te){return(te=+te)==1?o:function(ie,ae){return ae-ie?function(he,se,de){return he=Math.pow(he,de),se=Math.pow(se,de)-he,de=1/de,function(ue){return Math.pow(he+ue*se,de)}}(ie,ae,te):f(isNaN(ie)?ae:ie)}}function o(te,ie){var ae=ie-te;return ae?u(te,ae):f(isNaN(te)?ie:te)}var i=function te(ie){var ae=l(ie);function he(se,de){var ue=ae((se=d.rgb(se)).r,(de=d.rgb(de)).r),ve=ae(se.g,de.g),ke=ae(se.b,de.b),Ee=o(se.opacity,de.opacity);return function(be){return se.r=ue(be),se.g=ve(be),se.b=ke(be),se.opacity=Ee(be),se+""}}return he.gamma=te,he}(1);function c(te){return function(ie){var ae,he,se=ie.length,de=new Array(se),ue=new Array(se),ve=new Array(se);for(ae=0;ae<se;++ae)he=d.rgb(ie[ae]),de[ae]=he.r||0,ue[ae]=he.g||0,ve[ae]=he.b||0;return de=te(de),ue=te(ue),ve=te(ve),he.opacity=1,function(ke){return he.r=de(ke),he.g=ue(ke),he.b=ve(ke),he+""}}}var n=c(p),a=c(e);function g(te,ie){ie||(ie=[]);var ae,he=te?Math.min(ie.length,te.length):0,se=ie.slice();return function(de){for(ae=0;ae<he;++ae)se[ae]=te[ae]*(1-de)+ie[ae]*de;return se}}function h(te){return ArrayBuffer.isView(te)&&!(te instanceof DataView)}function y(te,ie){var ae,he=ie?ie.length:0,se=te?Math.min(he,te.length):0,de=new Array(se),ue=new Array(he);for(ae=0;ae<se;++ae)de[ae]=w(te[ae],ie[ae]);for(;ae<he;++ae)ue[ae]=ie[ae];return function(ve){for(ae=0;ae<se;++ae)ue[ae]=de[ae](ve);return ue}}function v(te,ie){var ae=new Date;return te=+te,ie=+ie,function(he){return ae.setTime(te*(1-he)+ie*he),ae}}function _(te,ie){return te=+te,ie=+ie,function(ae){return te*(1-ae)+ie*ae}}function x(te,ie){var ae,he={},se={};for(ae in te!==null&&typeof te=="object"||(te={}),ie!==null&&typeof ie=="object"||(ie={}),ie)ae in te?he[ae]=w(te[ae],ie[ae]):se[ae]=ie[ae];return function(de){for(ae in he)se[ae]=he[ae](de);return se}}var T=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,A=new RegExp(T.source,"g");function S(te,ie){var ae,he,se,de=T.lastIndex=A.lastIndex=0,ue=-1,ve=[],ke=[];for(te+="",ie+="";(ae=T.exec(te))&&(he=A.exec(ie));)(se=he.index)>de&&(se=ie.slice(de,se),ve[ue]?ve[ue]+=se:ve[++ue]=se),(ae=ae[0])===(he=he[0])?ve[ue]?ve[ue]+=he:ve[++ue]=he:(ve[++ue]=null,ke.push({i:ue,x:_(ae,he)})),de=A.lastIndex;return de<ie.length&&(se=ie.slice(de),ve[ue]?ve[ue]+=se:ve[++ue]=se),ve.length<2?ke[0]?function(Ee){return function(be){return Ee(be)+""}}(ke[0].x):function(Ee){return function(){return Ee}}(ie):(ie=ke.length,function(Ee){for(var be,xe=0;xe<ie;++xe)ve[(be=ke[xe]).i]=be.x(Ee);return ve.join("")})}function w(te,ie){var ae,he=typeof ie;return ie==null||he==="boolean"?f(ie):(he==="number"?_:he==="string"?(ae=d.color(ie))?(ie=ae,i):S:ie instanceof d.color?i:ie instanceof Date?v:h(ie)?g:Array.isArray(ie)?y:typeof ie.valueOf!="function"&&typeof ie.toString!="function"||isNaN(ie)?x:_)(te,ie)}var C,k,L,M,P=180/Math.PI,D={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function N(te,ie,ae,he,se,de){var ue,ve,ke;return(ue=Math.sqrt(te*te+ie*ie))&&(te/=ue,ie/=ue),(ke=te*ae+ie*he)&&(ae-=te*ke,he-=ie*ke),(ve=Math.sqrt(ae*ae+he*he))&&(ae/=ve,he/=ve,ke/=ve),te*he<ie*ae&&(te=-te,ie=-ie,ke=-ke,ue=-ue),{translateX:se,translateY:de,rotate:Math.atan2(ie,te)*P,skewX:Math.atan(ke)*P,scaleX:ue,scaleY:ve}}function U(te,ie,ae,he){function se(de){return de.length?de.pop()+" ":""}return function(de,ue){var ve=[],ke=[];return de=te(de),ue=te(ue),function(Ee,be,xe,ce,ge,we){if(Ee!==xe||be!==ce){var Me=ge.push("translate(",null,ie,null,ae);we.push({i:Me-4,x:_(Ee,xe)},{i:Me-2,x:_(be,ce)})}else(xe||ce)&&ge.push("translate("+xe+ie+ce+ae)}(de.translateX,de.translateY,ue.translateX,ue.translateY,ve,ke),function(Ee,be,xe,ce){Ee!==be?(Ee-be>180?be+=360:be-Ee>180&&(Ee+=360),ce.push({i:xe.push(se(xe)+"rotate(",null,he)-2,x:_(Ee,be)})):be&&xe.push(se(xe)+"rotate("+be+he)}(de.rotate,ue.rotate,ve,ke),function(Ee,be,xe,ce){Ee!==be?ce.push({i:xe.push(se(xe)+"skewX(",null,he)-2,x:_(Ee,be)}):be&&xe.push(se(xe)+"skewX("+be+he)}(de.skewX,ue.skewX,ve,ke),function(Ee,be,xe,ce,ge,we){if(Ee!==xe||be!==ce){var Me=ge.push(se(ge)+"scale(",null,",",null,")");we.push({i:Me-4,x:_(Ee,xe)},{i:Me-2,x:_(be,ce)})}else xe===1&&ce===1||ge.push(se(ge)+"scale("+xe+","+ce+")")}(de.scaleX,de.scaleY,ue.scaleX,ue.scaleY,ve,ke),de=ue=null,function(Ee){for(var be,xe=-1,ce=ke.length;++xe<ce;)ve[(be=ke[xe]).i]=be.x(Ee);return ve.join("")}}}var q=U(function(te){return te==="none"?D:(C||(C=document.createElement("DIV"),k=document.documentElement,L=document.defaultView),C.style.transform=te,te=L.getComputedStyle(k.appendChild(C),null).getPropertyValue("transform"),k.removeChild(C),N(+(te=te.slice(7,-1).split(","))[0],+te[1],+te[2],+te[3],+te[4],+te[5]))},"px, ","px)","deg)"),X=U(function(te){return te==null?D:(M||(M=document.createElementNS("http://www.w3.org/2000/svg","g")),M.setAttribute("transform",te),(te=M.transform.baseVal.consolidate())?N((te=te.matrix).a,te.b,te.c,te.d,te.e,te.f):D)},", ",")",")"),K=Math.SQRT2;function Z(te){return((te=Math.exp(te))+1/te)/2}function H(te){return function(ie,ae){var he=te((ie=d.hsl(ie)).h,(ae=d.hsl(ae)).h),se=o(ie.s,ae.s),de=o(ie.l,ae.l),ue=o(ie.opacity,ae.opacity);return function(ve){return ie.h=he(ve),ie.s=se(ve),ie.l=de(ve),ie.opacity=ue(ve),ie+""}}}var Y=H(s),$=H(o);function z(te){return function(ie,ae){var he=te((ie=d.hcl(ie)).h,(ae=d.hcl(ae)).h),se=o(ie.c,ae.c),de=o(ie.l,ae.l),ue=o(ie.opacity,ae.opacity);return function(ve){return ie.h=he(ve),ie.c=se(ve),ie.l=de(ve),ie.opacity=ue(ve),ie+""}}}var j=z(s),W=z(o);function ee(te){return function ie(ae){function he(se,de){var ue=te((se=d.cubehelix(se)).h,(de=d.cubehelix(de)).h),ve=o(se.s,de.s),ke=o(se.l,de.l),Ee=o(se.opacity,de.opacity);return function(be){return se.h=ue(be),se.s=ve(be),se.l=ke(Math.pow(be,ae)),se.opacity=Ee(be),se+""}}return ae=+ae,he.gamma=ie,he}(1)}var J=ee(s),Q=ee(o);t.interpolate=w,t.interpolateArray=function(te,ie){return(h(ie)?g:y)(te,ie)},t.interpolateBasis=p,t.interpolateBasisClosed=e,t.interpolateCubehelix=J,t.interpolateCubehelixLong=Q,t.interpolateDate=v,t.interpolateDiscrete=function(te){var ie=te.length;return function(ae){return te[Math.max(0,Math.min(ie-1,Math.floor(ae*ie)))]}},t.interpolateHcl=j,t.interpolateHclLong=W,t.interpolateHsl=Y,t.interpolateHslLong=$,t.interpolateHue=function(te,ie){var ae=s(+te,+ie);return function(he){var se=ae(he);return se-360*Math.floor(se/360)}},t.interpolateLab=function(te,ie){var ae=o((te=d.lab(te)).l,(ie=d.lab(ie)).l),he=o(te.a,ie.a),se=o(te.b,ie.b),de=o(te.opacity,ie.opacity);return function(ue){return te.l=ae(ue),te.a=he(ue),te.b=se(ue),te.opacity=de(ue),te+""}},t.interpolateNumber=_,t.interpolateNumberArray=g,t.interpolateObject=x,t.interpolateRgb=i,t.interpolateRgbBasis=n,t.interpolateRgbBasisClosed=a,t.interpolateRound=function(te,ie){return te=+te,ie=+ie,function(ae){return Math.round(te*(1-ae)+ie*ae)}},t.interpolateString=S,t.interpolateTransformCss=q,t.interpolateTransformSvg=X,t.interpolateZoom=function(te,ie){var ae,he,se=te[0],de=te[1],ue=te[2],ve=ie[0],ke=ie[1],Ee=ie[2],be=ve-se,xe=ke-de,ce=be*be+xe*xe;if(ce<1e-12)he=Math.log(Ee/ue)/K,ae=function(Fe){return[se+Fe*be,de+Fe*xe,ue*Math.exp(K*Fe*he)]};else{var ge=Math.sqrt(ce),we=(Ee*Ee-ue*ue+4*ce)/(2*ue*2*ge),Me=(Ee*Ee-ue*ue-4*ce)/(2*Ee*2*ge),Se=Math.log(Math.sqrt(we*we+1)-we),ze=Math.log(Math.sqrt(Me*Me+1)-Me);he=(ze-Se)/K,ae=function(Fe){var Ye,rt=Fe*he,Oe=Z(Se),je=ue/(2*ge)*(Oe*(Ye=K*rt+Se,((Ye=Math.exp(2*Ye))-1)/(Ye+1))-function(We){return((We=Math.exp(We))-1/We)/2}(Se));return[se+je*be,de+je*xe,ue*Oe/Z(K*rt+Se)]}}return ae.duration=1e3*he,ae},t.piecewise=function(te,ie){for(var ae=0,he=ie.length-1,se=ie[0],de=new Array(he<0?0:he);ae<he;)de[ae]=te(se,se=ie[++ae]);return function(ue){var ve=Math.max(0,Math.min(he-1,Math.floor(ue*=he)));return de[ve](ue-ve)}},t.quantize=function(te,ie){for(var ae=new Array(ie),he=0;he<ie;++he)ae[he]=te(he/(ie-1));return ae},Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-color":161}],169:[function(r,O,B){(function(t,d){d(typeof B=="object"&&O!==void 0?B:(t=t||self).d3=t.d3||{})})(this,function(t){var d=Math.PI,m=2*d,p=m-1e-6;function e(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function f(){return new e}e.prototype=f.prototype={constructor:e,moveTo:function(u,s){this._+="M"+(this._x0=this._x1=+u)+","+(this._y0=this._y1=+s)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(u,s){this._+="L"+(this._x1=+u)+","+(this._y1=+s)},quadraticCurveTo:function(u,s,l,o){this._+="Q"+ +u+","+ +s+","+(this._x1=+l)+","+(this._y1=+o)},bezierCurveTo:function(u,s,l,o,i,c){this._+="C"+ +u+","+ +s+","+ +l+","+ +o+","+(this._x1=+i)+","+(this._y1=+c)},arcTo:function(u,s,l,o,i){u=+u,s=+s,l=+l,o=+o,i=+i;var c=this._x1,n=this._y1,a=l-u,g=o-s,h=c-u,y=n-s,v=h*h+y*y;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=u)+","+(this._y1=s);else if(v>1e-6)if(Math.abs(y*a-g*h)>1e-6&&i){var _=l-c,x=o-n,T=a*a+g*g,A=_*_+x*x,S=Math.sqrt(T),w=Math.sqrt(v),C=i*Math.tan((d-Math.acos((T+v-A)/(2*S*w)))/2),k=C/w,L=C/S;Math.abs(k-1)>1e-6&&(this._+="L"+(u+k*h)+","+(s+k*y)),this._+="A"+i+","+i+",0,0,"+ +(y*_>h*x)+","+(this._x1=u+L*a)+","+(this._y1=s+L*g)}else this._+="L"+(this._x1=u)+","+(this._y1=s)},arc:function(u,s,l,o,i,c){u=+u,s=+s,c=!!c;var n=(l=+l)*Math.cos(o),a=l*Math.sin(o),g=u+n,h=s+a,y=1^c,v=c?o-i:i-o;if(l<0)throw new Error("negative radius: "+l);this._x1===null?this._+="M"+g+","+h:(Math.abs(this._x1-g)>1e-6||Math.abs(this._y1-h)>1e-6)&&(this._+="L"+g+","+h),l&&(v<0&&(v=v%m+m),v>p?this._+="A"+l+","+l+",0,1,"+y+","+(u-n)+","+(s-a)+"A"+l+","+l+",0,1,"+y+","+(this._x1=g)+","+(this._y1=h):v>1e-6&&(this._+="A"+l+","+l+",0,"+ +(v>=d)+","+y+","+(this._x1=u+l*Math.cos(i))+","+(this._y1=s+l*Math.sin(i))))},rect:function(u,s,l,o){this._+="M"+(this._x0=this._x1=+u)+","+(this._y0=this._y1=+s)+"h"+ +l+"v"+ +o+"h"+-l+"Z"},toString:function(){return this._}},t.path=f,Object.defineProperty(t,"__esModule",{value:!0})})},{}],170:[function(r,O,B){(function(t,d){d(typeof B=="object"&&O!==void 0?B:(t=t||self).d3=t.d3||{})})(this,function(t){function d(o,i,c,n){if(isNaN(i)||isNaN(c))return o;var a,g,h,y,v,_,x,T,A,S=o._root,w={data:n},C=o._x0,k=o._y0,L=o._x1,M=o._y1;if(!S)return o._root=w,o;for(;S.length;)if((_=i>=(g=(C+L)/2))?C=g:L=g,(x=c>=(h=(k+M)/2))?k=h:M=h,a=S,!(S=S[T=x<<1|_]))return a[T]=w,o;if(y=+o._x.call(null,S.data),v=+o._y.call(null,S.data),i===y&&c===v)return w.next=S,a?a[T]=w:o._root=w,o;do a=a?a[T]=new Array(4):o._root=new Array(4),(_=i>=(g=(C+L)/2))?C=g:L=g,(x=c>=(h=(k+M)/2))?k=h:M=h;while((T=x<<1|_)==(A=(v>=h)<<1|y>=g));return a[A]=S,a[T]=w,o}function m(o,i,c,n,a){this.node=o,this.x0=i,this.y0=c,this.x1=n,this.y1=a}function p(o){return o[0]}function e(o){return o[1]}function f(o,i,c){var n=new u(i==null?p:i,c==null?e:c,NaN,NaN,NaN,NaN);return o==null?n:n.addAll(o)}function u(o,i,c,n,a,g){this._x=o,this._y=i,this._x0=c,this._y0=n,this._x1=a,this._y1=g,this._root=void 0}function s(o){for(var i={data:o.data},c=i;o=o.next;)c=c.next={data:o.data};return i}var l=f.prototype=u.prototype;l.copy=function(){var o,i,c=new u(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return c;if(!n.length)return c._root=s(n),c;for(o=[{source:n,target:c._root=new Array(4)}];n=o.pop();)for(var a=0;a<4;++a)(i=n.source[a])&&(i.length?o.push({source:i,target:n.target[a]=new Array(4)}):n.target[a]=s(i));return c},l.add=function(o){var i=+this._x.call(null,o),c=+this._y.call(null,o);return d(this.cover(i,c),i,c,o)},l.addAll=function(o){var i,c,n,a,g=o.length,h=new Array(g),y=new Array(g),v=1/0,_=1/0,x=-1/0,T=-1/0;for(c=0;c<g;++c)isNaN(n=+this._x.call(null,i=o[c]))||isNaN(a=+this._y.call(null,i))||(h[c]=n,y[c]=a,n<v&&(v=n),n>x&&(x=n),a<_&&(_=a),a>T&&(T=a));if(v>x||_>T)return this;for(this.cover(v,_).cover(x,T),c=0;c<g;++c)d(this,h[c],y[c],o[c]);return this},l.cover=function(o,i){if(isNaN(o=+o)||isNaN(i=+i))return this;var c=this._x0,n=this._y0,a=this._x1,g=this._y1;if(isNaN(c))a=(c=Math.floor(o))+1,g=(n=Math.floor(i))+1;else{for(var h,y,v=a-c,_=this._root;c>o||o>=a||n>i||i>=g;)switch(y=(i<n)<<1|o<c,(h=new Array(4))[y]=_,_=h,v*=2,y){case 0:a=c+v,g=n+v;break;case 1:c=a-v,g=n+v;break;case 2:a=c+v,n=g-v;break;case 3:c=a-v,n=g-v}this._root&&this._root.length&&(this._root=_)}return this._x0=c,this._y0=n,this._x1=a,this._y1=g,this},l.data=function(){var o=[];return this.visit(function(i){if(!i.length)do o.push(i.data);while(i=i.next)}),o},l.extent=function(o){return arguments.length?this.cover(+o[0][0],+o[0][1]).cover(+o[1][0],+o[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},l.find=function(o,i,c){var n,a,g,h,y,v,_,x=this._x0,T=this._y0,A=this._x1,S=this._y1,w=[],C=this._root;for(C&&w.push(new m(C,x,T,A,S)),c==null?c=1/0:(x=o-c,T=i-c,A=o+c,S=i+c,c*=c);v=w.pop();)if(!(!(C=v.node)||(a=v.x0)>A||(g=v.y0)>S||(h=v.x1)<x||(y=v.y1)<T))if(C.length){var k=(a+h)/2,L=(g+y)/2;w.push(new m(C[3],k,L,h,y),new m(C[2],a,L,k,y),new m(C[1],k,g,h,L),new m(C[0],a,g,k,L)),(_=(i>=L)<<1|o>=k)&&(v=w[w.length-1],w[w.length-1]=w[w.length-1-_],w[w.length-1-_]=v)}else{var M=o-+this._x.call(null,C.data),P=i-+this._y.call(null,C.data),D=M*M+P*P;if(D<c){var N=Math.sqrt(c=D);x=o-N,T=i-N,A=o+N,S=i+N,n=C.data}}return n},l.remove=function(o){if(isNaN(g=+this._x.call(null,o))||isNaN(h=+this._y.call(null,o)))return this;var i,c,n,a,g,h,y,v,_,x,T,A,S=this._root,w=this._x0,C=this._y0,k=this._x1,L=this._y1;if(!S)return this;if(S.length)for(;;){if((_=g>=(y=(w+k)/2))?w=y:k=y,(x=h>=(v=(C+L)/2))?C=v:L=v,i=S,!(S=S[T=x<<1|_]))return this;if(!S.length)break;(i[T+1&3]||i[T+2&3]||i[T+3&3])&&(c=i,A=T)}for(;S.data!==o;)if(n=S,!(S=S.next))return this;return(a=S.next)&&delete S.next,n?(a?n.next=a:delete n.next,this):i?(a?i[T]=a:delete i[T],(S=i[0]||i[1]||i[2]||i[3])&&S===(i[3]||i[2]||i[1]||i[0])&&!S.length&&(c?c[A]=S:this._root=S),this):(this._root=a,this)},l.removeAll=function(o){for(var i=0,c=o.length;i<c;++i)this.remove(o[i]);return this},l.root=function(){return this._root},l.size=function(){var o=0;return this.visit(function(i){if(!i.length)do++o;while(i=i.next)}),o},l.visit=function(o){var i,c,n,a,g,h,y=[],v=this._root;for(v&&y.push(new m(v,this._x0,this._y0,this._x1,this._y1));i=y.pop();)if(!o(v=i.node,n=i.x0,a=i.y0,g=i.x1,h=i.y1)&&v.length){var _=(n+g)/2,x=(a+h)/2;(c=v[3])&&y.push(new m(c,_,x,g,h)),(c=v[2])&&y.push(new m(c,n,x,_,h)),(c=v[1])&&y.push(new m(c,_,a,g,x)),(c=v[0])&&y.push(new m(c,n,a,_,x))}return this},l.visitAfter=function(o){var i,c=[],n=[];for(this._root&&c.push(new m(this._root,this._x0,this._y0,this._x1,this._y1));i=c.pop();){var a=i.node;if(a.length){var g,h=i.x0,y=i.y0,v=i.x1,_=i.y1,x=(h+v)/2,T=(y+_)/2;(g=a[0])&&c.push(new m(g,h,y,x,T)),(g=a[1])&&c.push(new m(g,x,y,v,T)),(g=a[2])&&c.push(new m(g,h,T,x,_)),(g=a[3])&&c.push(new m(g,x,T,v,_))}n.push(i)}for(;i=n.pop();)o(i.node,i.x0,i.y0,i.x1,i.y1);return this},l.x=function(o){return arguments.length?(this._x=o,this):this._x},l.y=function(o){return arguments.length?(this._y=o,this):this._y},t.quadtree=f,Object.defineProperty(t,"__esModule",{value:!0})})},{}],171:[function(r,O,B){(function(t,d){typeof B=="object"&&O!==void 0?d(B,r("d3-path")):d((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,d){function m(Ie){return function(){return Ie}}var p=Math.abs,e=Math.atan2,f=Math.cos,u=Math.max,s=Math.min,l=Math.sin,o=Math.sqrt,i=Math.PI,c=i/2,n=2*i;function a(Ie){return Ie>1?0:Ie<-1?i:Math.acos(Ie)}function g(Ie){return Ie>=1?c:Ie<=-1?-c:Math.asin(Ie)}function h(Ie){return Ie.innerRadius}function y(Ie){return Ie.outerRadius}function v(Ie){return Ie.startAngle}function _(Ie){return Ie.endAngle}function x(Ie){return Ie&&Ie.padAngle}function T(Ie,lt,wt,Ot,Gt,ir,Xt,Kt){var or=wt-Ie,dr=Ot-lt,vr=Xt-Gt,ur=Kt-ir,pr=ur*or-vr*dr;if(!(pr*pr<1e-12))return[Ie+(pr=(vr*(lt-ir)-ur*(Ie-Gt))/pr)*or,lt+pr*dr]}function A(Ie,lt,wt,Ot,Gt,ir,Xt){var Kt=Ie-wt,or=lt-Ot,dr=(Xt?ir:-ir)/o(Kt*Kt+or*or),vr=dr*or,ur=-dr*Kt,pr=Ie+vr,br=lt+ur,Rr=wt+vr,_r=Ot+ur,jr=(pr+Rr)/2,$r=(br+_r)/2,pn=Rr-pr,In=_r-br,On=pn*pn+In*In,Sn=Gt-ir,an=pr*_r-Rr*br,Nr=(In<0?-1:1)*o(u(0,Sn*Sn*On-an*an)),Pr=(an*In-pn*Nr)/On,en=(-an*pn-In*Nr)/On,tn=(an*In+pn*Nr)/On,Qr=(-an*pn+In*Nr)/On,rn=Pr-jr,An=en-$r,En=tn-jr,Bn=Qr-$r;return rn*rn+An*An>En*En+Bn*Bn&&(Pr=tn,en=Qr),{cx:Pr,cy:en,x01:-vr,y01:-ur,x11:Pr*(Gt/Sn-1),y11:en*(Gt/Sn-1)}}function S(Ie){this._context=Ie}function w(Ie){return new S(Ie)}function C(Ie){return Ie[0]}function k(Ie){return Ie[1]}function L(){var Ie=C,lt=k,wt=m(!0),Ot=null,Gt=w,ir=null;function Xt(Kt){var or,dr,vr,ur=Kt.length,pr=!1;for(Ot==null&&(ir=Gt(vr=d.path())),or=0;or<=ur;++or)!(or<ur&&wt(dr=Kt[or],or,Kt))===pr&&((pr=!pr)?ir.lineStart():ir.lineEnd()),pr&&ir.point(+Ie(dr,or,Kt),+lt(dr,or,Kt));if(vr)return ir=null,vr+""||null}return Xt.x=function(Kt){return arguments.length?(Ie=typeof Kt=="function"?Kt:m(+Kt),Xt):Ie},Xt.y=function(Kt){return arguments.length?(lt=typeof Kt=="function"?Kt:m(+Kt),Xt):lt},Xt.defined=function(Kt){return arguments.length?(wt=typeof Kt=="function"?Kt:m(!!Kt),Xt):wt},Xt.curve=function(Kt){return arguments.length?(Gt=Kt,Ot!=null&&(ir=Gt(Ot)),Xt):Gt},Xt.context=function(Kt){return arguments.length?(Kt==null?Ot=ir=null:ir=Gt(Ot=Kt),Xt):Ot},Xt}function M(){var Ie=C,lt=null,wt=m(0),Ot=k,Gt=m(!0),ir=null,Xt=w,Kt=null;function or(vr){var ur,pr,br,Rr,_r,jr=vr.length,$r=!1,pn=new Array(jr),In=new Array(jr);for(ir==null&&(Kt=Xt(_r=d.path())),ur=0;ur<=jr;++ur){if(!(ur<jr&&Gt(Rr=vr[ur],ur,vr))===$r)if($r=!$r)pr=ur,Kt.areaStart(),Kt.lineStart();else{for(Kt.lineEnd(),Kt.lineStart(),br=ur-1;br>=pr;--br)Kt.point(pn[br],In[br]);Kt.lineEnd(),Kt.areaEnd()}$r&&(pn[ur]=+Ie(Rr,ur,vr),In[ur]=+wt(Rr,ur,vr),Kt.point(lt?+lt(Rr,ur,vr):pn[ur],Ot?+Ot(Rr,ur,vr):In[ur]))}if(_r)return Kt=null,_r+""||null}function dr(){return L().defined(Gt).curve(Xt).context(ir)}return or.x=function(vr){return arguments.length?(Ie=typeof vr=="function"?vr:m(+vr),lt=null,or):Ie},or.x0=function(vr){return arguments.length?(Ie=typeof vr=="function"?vr:m(+vr),or):Ie},or.x1=function(vr){return arguments.length?(lt=vr==null?null:typeof vr=="function"?vr:m(+vr),or):lt},or.y=function(vr){return arguments.length?(wt=typeof vr=="function"?vr:m(+vr),Ot=null,or):wt},or.y0=function(vr){return arguments.length?(wt=typeof vr=="function"?vr:m(+vr),or):wt},or.y1=function(vr){return arguments.length?(Ot=vr==null?null:typeof vr=="function"?vr:m(+vr),or):Ot},or.lineX0=or.lineY0=function(){return dr().x(Ie).y(wt)},or.lineY1=function(){return dr().x(Ie).y(Ot)},or.lineX1=function(){return dr().x(lt).y(wt)},or.defined=function(vr){return arguments.length?(Gt=typeof vr=="function"?vr:m(!!vr),or):Gt},or.curve=function(vr){return arguments.length?(Xt=vr,ir!=null&&(Kt=Xt(ir)),or):Xt},or.context=function(vr){return arguments.length?(vr==null?ir=Kt=null:Kt=Xt(ir=vr),or):ir},or}function P(Ie,lt){return lt<Ie?-1:lt>Ie?1:lt>=Ie?0:NaN}function D(Ie){return Ie}S.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,lt){switch(Ie=+Ie,lt=+lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,lt):this._context.moveTo(Ie,lt);break;case 1:this._point=2;default:this._context.lineTo(Ie,lt)}}};var N=q(w);function U(Ie){this._curve=Ie}function q(Ie){function lt(wt){return new U(Ie(wt))}return lt._curve=Ie,lt}function X(Ie){var lt=Ie.curve;return Ie.angle=Ie.x,delete Ie.x,Ie.radius=Ie.y,delete Ie.y,Ie.curve=function(wt){return arguments.length?lt(q(wt)):lt()._curve},Ie}function K(){return X(L().curve(N))}function Z(){var Ie=M().curve(N),lt=Ie.curve,wt=Ie.lineX0,Ot=Ie.lineX1,Gt=Ie.lineY0,ir=Ie.lineY1;return Ie.angle=Ie.x,delete Ie.x,Ie.startAngle=Ie.x0,delete Ie.x0,Ie.endAngle=Ie.x1,delete Ie.x1,Ie.radius=Ie.y,delete Ie.y,Ie.innerRadius=Ie.y0,delete Ie.y0,Ie.outerRadius=Ie.y1,delete Ie.y1,Ie.lineStartAngle=function(){return X(wt())},delete Ie.lineX0,Ie.lineEndAngle=function(){return X(Ot())},delete Ie.lineX1,Ie.lineInnerRadius=function(){return X(Gt())},delete Ie.lineY0,Ie.lineOuterRadius=function(){return X(ir())},delete Ie.lineY1,Ie.curve=function(Xt){return arguments.length?lt(q(Xt)):lt()._curve},Ie}function H(Ie,lt){return[(lt=+lt)*Math.cos(Ie-=Math.PI/2),lt*Math.sin(Ie)]}U.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(Ie,lt){this._curve.point(lt*Math.sin(Ie),lt*-Math.cos(Ie))}};var Y=Array.prototype.slice;function $(Ie){return Ie.source}function z(Ie){return Ie.target}function j(Ie){var lt=$,wt=z,Ot=C,Gt=k,ir=null;function Xt(){var Kt,or=Y.call(arguments),dr=lt.apply(this,or),vr=wt.apply(this,or);if(ir||(ir=Kt=d.path()),Ie(ir,+Ot.apply(this,(or[0]=dr,or)),+Gt.apply(this,or),+Ot.apply(this,(or[0]=vr,or)),+Gt.apply(this,or)),Kt)return ir=null,Kt+""||null}return Xt.source=function(Kt){return arguments.length?(lt=Kt,Xt):lt},Xt.target=function(Kt){return arguments.length?(wt=Kt,Xt):wt},Xt.x=function(Kt){return arguments.length?(Ot=typeof Kt=="function"?Kt:m(+Kt),Xt):Ot},Xt.y=function(Kt){return arguments.length?(Gt=typeof Kt=="function"?Kt:m(+Kt),Xt):Gt},Xt.context=function(Kt){return arguments.length?(ir=Kt==null?null:Kt,Xt):ir},Xt}function W(Ie,lt,wt,Ot,Gt){Ie.moveTo(lt,wt),Ie.bezierCurveTo(lt=(lt+Ot)/2,wt,lt,Gt,Ot,Gt)}function ee(Ie,lt,wt,Ot,Gt){Ie.moveTo(lt,wt),Ie.bezierCurveTo(lt,wt=(wt+Gt)/2,Ot,wt,Ot,Gt)}function J(Ie,lt,wt,Ot,Gt){var ir=H(lt,wt),Xt=H(lt,wt=(wt+Gt)/2),Kt=H(Ot,wt),or=H(Ot,Gt);Ie.moveTo(ir[0],ir[1]),Ie.bezierCurveTo(Xt[0],Xt[1],Kt[0],Kt[1],or[0],or[1])}var Q={draw:function(Ie,lt){var wt=Math.sqrt(lt/i);Ie.moveTo(wt,0),Ie.arc(0,0,wt,0,n)}},te={draw:function(Ie,lt){var wt=Math.sqrt(lt/5)/2;Ie.moveTo(-3*wt,-wt),Ie.lineTo(-wt,-wt),Ie.lineTo(-wt,-3*wt),Ie.lineTo(wt,-3*wt),Ie.lineTo(wt,-wt),Ie.lineTo(3*wt,-wt),Ie.lineTo(3*wt,wt),Ie.lineTo(wt,wt),Ie.lineTo(wt,3*wt),Ie.lineTo(-wt,3*wt),Ie.lineTo(-wt,wt),Ie.lineTo(-3*wt,wt),Ie.closePath()}},ie=Math.sqrt(1/3),ae=2*ie,he={draw:function(Ie,lt){var wt=Math.sqrt(lt/ae),Ot=wt*ie;Ie.moveTo(0,-wt),Ie.lineTo(Ot,0),Ie.lineTo(0,wt),Ie.lineTo(-Ot,0),Ie.closePath()}},se=Math.sin(i/10)/Math.sin(7*i/10),de=Math.sin(n/10)*se,ue=-Math.cos(n/10)*se,ve={draw:function(Ie,lt){var wt=Math.sqrt(.8908130915292852*lt),Ot=de*wt,Gt=ue*wt;Ie.moveTo(0,-wt),Ie.lineTo(Ot,Gt);for(var ir=1;ir<5;++ir){var Xt=n*ir/5,Kt=Math.cos(Xt),or=Math.sin(Xt);Ie.lineTo(or*wt,-Kt*wt),Ie.lineTo(Kt*Ot-or*Gt,or*Ot+Kt*Gt)}Ie.closePath()}},ke={draw:function(Ie,lt){var wt=Math.sqrt(lt),Ot=-wt/2;Ie.rect(Ot,Ot,wt,wt)}},Ee=Math.sqrt(3),be={draw:function(Ie,lt){var wt=-Math.sqrt(lt/(3*Ee));Ie.moveTo(0,2*wt),Ie.lineTo(-Ee*wt,-wt),Ie.lineTo(Ee*wt,-wt),Ie.closePath()}},xe=-.5,ce=Math.sqrt(3)/2,ge=1/Math.sqrt(12),we=3*(ge/2+1),Me={draw:function(Ie,lt){var wt=Math.sqrt(lt/we),Ot=wt/2,Gt=wt*ge,ir=Ot,Xt=wt*ge+wt,Kt=-ir,or=Xt;Ie.moveTo(Ot,Gt),Ie.lineTo(ir,Xt),Ie.lineTo(Kt,or),Ie.lineTo(xe*Ot-ce*Gt,ce*Ot+xe*Gt),Ie.lineTo(xe*ir-ce*Xt,ce*ir+xe*Xt),Ie.lineTo(xe*Kt-ce*or,ce*Kt+xe*or),Ie.lineTo(xe*Ot+ce*Gt,xe*Gt-ce*Ot),Ie.lineTo(xe*ir+ce*Xt,xe*Xt-ce*ir),Ie.lineTo(xe*Kt+ce*or,xe*or-ce*Kt),Ie.closePath()}},Se=[Q,te,he,ke,ve,be,Me];function ze(){}function Fe(Ie,lt,wt){Ie._context.bezierCurveTo((2*Ie._x0+Ie._x1)/3,(2*Ie._y0+Ie._y1)/3,(Ie._x0+2*Ie._x1)/3,(Ie._y0+2*Ie._y1)/3,(Ie._x0+4*Ie._x1+lt)/6,(Ie._y0+4*Ie._y1+wt)/6)}function Ye(Ie){this._context=Ie}function rt(Ie){this._context=Ie}function Oe(Ie){this._context=Ie}function je(Ie,lt){this._basis=new Ye(Ie),this._beta=lt}Ye.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Fe(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,lt){switch(Ie=+Ie,lt=+lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,lt):this._context.moveTo(Ie,lt);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Fe(this,Ie,lt)}this._x0=this._x1,this._x1=Ie,this._y0=this._y1,this._y1=lt}},rt.prototype={areaStart:ze,areaEnd:ze,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(Ie,lt){switch(Ie=+Ie,lt=+lt,this._point){case 0:this._point=1,this._x2=Ie,this._y2=lt;break;case 1:this._point=2,this._x3=Ie,this._y3=lt;break;case 2:this._point=3,this._x4=Ie,this._y4=lt,this._context.moveTo((this._x0+4*this._x1+Ie)/6,(this._y0+4*this._y1+lt)/6);break;default:Fe(this,Ie,lt)}this._x0=this._x1,this._x1=Ie,this._y0=this._y1,this._y1=lt}},Oe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,lt){switch(Ie=+Ie,lt=+lt,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var wt=(this._x0+4*this._x1+Ie)/6,Ot=(this._y0+4*this._y1+lt)/6;this._line?this._context.lineTo(wt,Ot):this._context.moveTo(wt,Ot);break;case 3:this._point=4;default:Fe(this,Ie,lt)}this._x0=this._x1,this._x1=Ie,this._y0=this._y1,this._y1=lt}},je.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var Ie=this._x,lt=this._y,wt=Ie.length-1;if(wt>0)for(var Ot,Gt=Ie[0],ir=lt[0],Xt=Ie[wt]-Gt,Kt=lt[wt]-ir,or=-1;++or<=wt;)Ot=or/wt,this._basis.point(this._beta*Ie[or]+(1-this._beta)*(Gt+Ot*Xt),this._beta*lt[or]+(1-this._beta)*(ir+Ot*Kt));this._x=this._y=null,this._basis.lineEnd()},point:function(Ie,lt){this._x.push(+Ie),this._y.push(+lt)}};var We=function Ie(lt){function wt(Ot){return lt===1?new Ye(Ot):new je(Ot,lt)}return wt.beta=function(Ot){return Ie(+Ot)},wt}(.85);function qe(Ie,lt,wt){Ie._context.bezierCurveTo(Ie._x1+Ie._k*(Ie._x2-Ie._x0),Ie._y1+Ie._k*(Ie._y2-Ie._y0),Ie._x2+Ie._k*(Ie._x1-lt),Ie._y2+Ie._k*(Ie._y1-wt),Ie._x2,Ie._y2)}function Qe(Ie,lt){this._context=Ie,this._k=(1-lt)/6}Qe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:qe(this,this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,lt){switch(Ie=+Ie,lt=+lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,lt):this._context.moveTo(Ie,lt);break;case 1:this._point=2,this._x1=Ie,this._y1=lt;break;case 2:this._point=3;default:qe(this,Ie,lt)}this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var st=function Ie(lt){function wt(Ot){return new Qe(Ot,lt)}return wt.tension=function(Ot){return Ie(+Ot)},wt}(0);function ct(Ie,lt){this._context=Ie,this._k=(1-lt)/6}ct.prototype={areaStart:ze,areaEnd:ze,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ie,lt){switch(Ie=+Ie,lt=+lt,this._point){case 0:this._point=1,this._x3=Ie,this._y3=lt;break;case 1:this._point=2,this._context.moveTo(this._x4=Ie,this._y4=lt);break;case 2:this._point=3,this._x5=Ie,this._y5=lt;break;default:qe(this,Ie,lt)}this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var Pt=function Ie(lt){function wt(Ot){return new ct(Ot,lt)}return wt.tension=function(Ot){return Ie(+Ot)},wt}(0);function kt(Ie,lt){this._context=Ie,this._k=(1-lt)/6}kt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,lt){switch(Ie=+Ie,lt=+lt,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:qe(this,Ie,lt)}this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var at=function Ie(lt){function wt(Ot){return new kt(Ot,lt)}return wt.tension=function(Ot){return Ie(+Ot)},wt}(0);function tt(Ie,lt,wt){var Ot=Ie._x1,Gt=Ie._y1,ir=Ie._x2,Xt=Ie._y2;if(Ie._l01_a>1e-12){var Kt=2*Ie._l01_2a+3*Ie._l01_a*Ie._l12_a+Ie._l12_2a,or=3*Ie._l01_a*(Ie._l01_a+Ie._l12_a);Ot=(Ot*Kt-Ie._x0*Ie._l12_2a+Ie._x2*Ie._l01_2a)/or,Gt=(Gt*Kt-Ie._y0*Ie._l12_2a+Ie._y2*Ie._l01_2a)/or}if(Ie._l23_a>1e-12){var dr=2*Ie._l23_2a+3*Ie._l23_a*Ie._l12_a+Ie._l12_2a,vr=3*Ie._l23_a*(Ie._l23_a+Ie._l12_a);ir=(ir*dr+Ie._x1*Ie._l23_2a-lt*Ie._l12_2a)/vr,Xt=(Xt*dr+Ie._y1*Ie._l23_2a-wt*Ie._l12_2a)/vr}Ie._context.bezierCurveTo(Ot,Gt,ir,Xt,Ie._x2,Ie._y2)}function _t(Ie,lt){this._context=Ie,this._alpha=lt}_t.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,lt){if(Ie=+Ie,lt=+lt,this._point){var wt=this._x2-Ie,Ot=this._y2-lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(wt*wt+Ot*Ot,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,lt):this._context.moveTo(Ie,lt);break;case 1:this._point=2;break;case 2:this._point=3;default:tt(this,Ie,lt)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var er=function Ie(lt){function wt(Ot){return lt?new _t(Ot,lt):new Qe(Ot,0)}return wt.alpha=function(Ot){return Ie(+Ot)},wt}(.5);function tr(Ie,lt){this._context=Ie,this._alpha=lt}tr.prototype={areaStart:ze,areaEnd:ze,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ie,lt){if(Ie=+Ie,lt=+lt,this._point){var wt=this._x2-Ie,Ot=this._y2-lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(wt*wt+Ot*Ot,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=Ie,this._y3=lt;break;case 1:this._point=2,this._context.moveTo(this._x4=Ie,this._y4=lt);break;case 2:this._point=3,this._x5=Ie,this._y5=lt;break;default:tt(this,Ie,lt)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var Ue=function Ie(lt){function wt(Ot){return lt?new tr(Ot,lt):new ct(Ot,0)}return wt.alpha=function(Ot){return Ie(+Ot)},wt}(.5);function He(Ie,lt){this._context=Ie,this._alpha=lt}He.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,lt){if(Ie=+Ie,lt=+lt,this._point){var wt=this._x2-Ie,Ot=this._y2-lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(wt*wt+Ot*Ot,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:tt(this,Ie,lt)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var Be=function Ie(lt){function wt(Ot){return lt?new He(Ot,lt):new kt(Ot,0)}return wt.alpha=function(Ot){return Ie(+Ot)},wt}(.5);function Ke(Ie){this._context=Ie}function _e(Ie){return Ie<0?-1:1}function Ce(Ie,lt,wt){var Ot=Ie._x1-Ie._x0,Gt=lt-Ie._x1,ir=(Ie._y1-Ie._y0)/(Ot||Gt<0&&-0),Xt=(wt-Ie._y1)/(Gt||Ot<0&&-0),Kt=(ir*Gt+Xt*Ot)/(Ot+Gt);return(_e(ir)+_e(Xt))*Math.min(Math.abs(ir),Math.abs(Xt),.5*Math.abs(Kt))||0}function Le(Ie,lt){var wt=Ie._x1-Ie._x0;return wt?(3*(Ie._y1-Ie._y0)/wt-lt)/2:lt}function Pe(Ie,lt,wt){var Ot=Ie._x0,Gt=Ie._y0,ir=Ie._x1,Xt=Ie._y1,Kt=(ir-Ot)/3;Ie._context.bezierCurveTo(Ot+Kt,Gt+Kt*lt,ir-Kt,Xt-Kt*wt,ir,Xt)}function Xe(Ie){this._context=Ie}function ht(Ie){this._context=new Mt(Ie)}function Mt(Ie){this._context=Ie}function pt(Ie){this._context=Ie}function Lt(Ie){var lt,wt,Ot=Ie.length-1,Gt=new Array(Ot),ir=new Array(Ot),Xt=new Array(Ot);for(Gt[0]=0,ir[0]=2,Xt[0]=Ie[0]+2*Ie[1],lt=1;lt<Ot-1;++lt)Gt[lt]=1,ir[lt]=4,Xt[lt]=4*Ie[lt]+2*Ie[lt+1];for(Gt[Ot-1]=2,ir[Ot-1]=7,Xt[Ot-1]=8*Ie[Ot-1]+Ie[Ot],lt=1;lt<Ot;++lt)wt=Gt[lt]/ir[lt-1],ir[lt]-=wt,Xt[lt]-=wt*Xt[lt-1];for(Gt[Ot-1]=Xt[Ot-1]/ir[Ot-1],lt=Ot-2;lt>=0;--lt)Gt[lt]=(Xt[lt]-Gt[lt+1])/ir[lt];for(ir[Ot-1]=(Ie[Ot]+Gt[Ot-1])/2,lt=0;lt<Ot-1;++lt)ir[lt]=2*Ie[lt+1]-Gt[lt+1];return[Gt,ir]}function vt(Ie,lt){this._context=Ie,this._t=lt}function Dt(Ie,lt){if((Gt=Ie.length)>1)for(var wt,Ot,Gt,ir=1,Xt=Ie[lt[0]],Kt=Xt.length;ir<Gt;++ir)for(Ot=Xt,Xt=Ie[lt[ir]],wt=0;wt<Kt;++wt)Xt[wt][1]+=Xt[wt][0]=isNaN(Ot[wt][1])?Ot[wt][0]:Ot[wt][1]}function xt(Ie){for(var lt=Ie.length,wt=new Array(lt);--lt>=0;)wt[lt]=lt;return wt}function it(Ie,lt){return Ie[lt]}function St(Ie){var lt=Ie.map(Nt);return xt(Ie).sort(function(wt,Ot){return lt[wt]-lt[Ot]})}function Nt(Ie){for(var lt,wt=-1,Ot=0,Gt=Ie.length,ir=-1/0;++wt<Gt;)(lt=+Ie[wt][1])>ir&&(ir=lt,Ot=wt);return Ot}function Ut(Ie){var lt=Ie.map(Qt);return xt(Ie).sort(function(wt,Ot){return lt[wt]-lt[Ot]})}function Qt(Ie){for(var lt,wt=0,Ot=-1,Gt=Ie.length;++Ot<Gt;)(lt=+Ie[Ot][1])&&(wt+=lt);return wt}Ke.prototype={areaStart:ze,areaEnd:ze,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(Ie,lt){Ie=+Ie,lt=+lt,this._point?this._context.lineTo(Ie,lt):(this._point=1,this._context.moveTo(Ie,lt))}},Xe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Pe(this,this._t0,Le(this,this._t0))}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,lt){var wt=NaN;if(lt=+lt,(Ie=+Ie)!==this._x1||lt!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,lt):this._context.moveTo(Ie,lt);break;case 1:this._point=2;break;case 2:this._point=3,Pe(this,Le(this,wt=Ce(this,Ie,lt)),wt);break;default:Pe(this,this._t0,wt=Ce(this,Ie,lt))}this._x0=this._x1,this._x1=Ie,this._y0=this._y1,this._y1=lt,this._t0=wt}}},(ht.prototype=Object.create(Xe.prototype)).point=function(Ie,lt){Xe.prototype.point.call(this,lt,Ie)},Mt.prototype={moveTo:function(Ie,lt){this._context.moveTo(lt,Ie)},closePath:function(){this._context.closePath()},lineTo:function(Ie,lt){this._context.lineTo(lt,Ie)},bezierCurveTo:function(Ie,lt,wt,Ot,Gt,ir){this._context.bezierCurveTo(lt,Ie,Ot,wt,ir,Gt)}},pt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var Ie=this._x,lt=this._y,wt=Ie.length;if(wt)if(this._line?this._context.lineTo(Ie[0],lt[0]):this._context.moveTo(Ie[0],lt[0]),wt===2)this._context.lineTo(Ie[1],lt[1]);else for(var Ot=Lt(Ie),Gt=Lt(lt),ir=0,Xt=1;Xt<wt;++ir,++Xt)this._context.bezierCurveTo(Ot[0][ir],Gt[0][ir],Ot[1][ir],Gt[1][ir],Ie[Xt],lt[Xt]);(this._line||this._line!==0&&wt===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(Ie,lt){this._x.push(+Ie),this._y.push(+lt)}},vt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(Ie,lt){switch(Ie=+Ie,lt=+lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,lt):this._context.moveTo(Ie,lt);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,lt),this._context.lineTo(Ie,lt);else{var wt=this._x*(1-this._t)+Ie*this._t;this._context.lineTo(wt,this._y),this._context.lineTo(wt,lt)}}this._x=Ie,this._y=lt}},t.arc=function(){var Ie=h,lt=y,wt=m(0),Ot=null,Gt=v,ir=_,Xt=x,Kt=null;function or(){var dr,vr,ur=+Ie.apply(this,arguments),pr=+lt.apply(this,arguments),br=Gt.apply(this,arguments)-c,Rr=ir.apply(this,arguments)-c,_r=p(Rr-br),jr=Rr>br;if(Kt||(Kt=dr=d.path()),pr<ur&&(vr=pr,pr=ur,ur=vr),pr>1e-12)if(_r>n-1e-12)Kt.moveTo(pr*f(br),pr*l(br)),Kt.arc(0,0,pr,br,Rr,!jr),ur>1e-12&&(Kt.moveTo(ur*f(Rr),ur*l(Rr)),Kt.arc(0,0,ur,Rr,br,jr));else{var $r,pn,In=br,On=Rr,Sn=br,an=Rr,Nr=_r,Pr=_r,en=Xt.apply(this,arguments)/2,tn=en>1e-12&&(Ot?+Ot.apply(this,arguments):o(ur*ur+pr*pr)),Qr=s(p(pr-ur)/2,+wt.apply(this,arguments)),rn=Qr,An=Qr;if(tn>1e-12){var En=g(tn/ur*l(en)),Bn=g(tn/pr*l(en));(Nr-=2*En)>1e-12?(Sn+=En*=jr?1:-1,an-=En):(Nr=0,Sn=an=(br+Rr)/2),(Pr-=2*Bn)>1e-12?(In+=Bn*=jr?1:-1,On-=Bn):(Pr=0,In=On=(br+Rr)/2)}var Jt=pr*f(In),It=pr*l(In),qt=ur*f(an),fr=ur*l(an);if(Qr>1e-12){var Tr,Gr=pr*f(On),Vr=pr*l(On),xr=ur*f(Sn),wr=ur*l(Sn);if(_r<i&&(Tr=T(Jt,It,xr,wr,Gr,Vr,qt,fr))){var Sr=Jt-Tr[0],Mr=It-Tr[1],Ir=Gr-Tr[0],qr=Vr-Tr[1],cn=1/l(a((Sr*Ir+Mr*qr)/(o(Sr*Sr+Mr*Mr)*o(Ir*Ir+qr*qr)))/2),_n=o(Tr[0]*Tr[0]+Tr[1]*Tr[1]);rn=s(Qr,(ur-_n)/(cn-1)),An=s(Qr,(pr-_n)/(cn+1))}}Pr>1e-12?An>1e-12?($r=A(xr,wr,Jt,It,pr,An,jr),pn=A(Gr,Vr,qt,fr,pr,An,jr),Kt.moveTo($r.cx+$r.x01,$r.cy+$r.y01),An<Qr?Kt.arc($r.cx,$r.cy,An,e($r.y01,$r.x01),e(pn.y01,pn.x01),!jr):(Kt.arc($r.cx,$r.cy,An,e($r.y01,$r.x01),e($r.y11,$r.x11),!jr),Kt.arc(0,0,pr,e($r.cy+$r.y11,$r.cx+$r.x11),e(pn.cy+pn.y11,pn.cx+pn.x11),!jr),Kt.arc(pn.cx,pn.cy,An,e(pn.y11,pn.x11),e(pn.y01,pn.x01),!jr))):(Kt.moveTo(Jt,It),Kt.arc(0,0,pr,In,On,!jr)):Kt.moveTo(Jt,It),ur>1e-12&&Nr>1e-12?rn>1e-12?($r=A(qt,fr,Gr,Vr,ur,-rn,jr),pn=A(Jt,It,xr,wr,ur,-rn,jr),Kt.lineTo($r.cx+$r.x01,$r.cy+$r.y01),rn<Qr?Kt.arc($r.cx,$r.cy,rn,e($r.y01,$r.x01),e(pn.y01,pn.x01),!jr):(Kt.arc($r.cx,$r.cy,rn,e($r.y01,$r.x01),e($r.y11,$r.x11),!jr),Kt.arc(0,0,ur,e($r.cy+$r.y11,$r.cx+$r.x11),e(pn.cy+pn.y11,pn.cx+pn.x11),jr),Kt.arc(pn.cx,pn.cy,rn,e(pn.y11,pn.x11),e(pn.y01,pn.x01),!jr))):Kt.arc(0,0,ur,an,Sn,jr):Kt.lineTo(qt,fr)}else Kt.moveTo(0,0);if(Kt.closePath(),dr)return Kt=null,dr+""||null}return or.centroid=function(){var dr=(+Ie.apply(this,arguments)+ +lt.apply(this,arguments))/2,vr=(+Gt.apply(this,arguments)+ +ir.apply(this,arguments))/2-i/2;return[f(vr)*dr,l(vr)*dr]},or.innerRadius=function(dr){return arguments.length?(Ie=typeof dr=="function"?dr:m(+dr),or):Ie},or.outerRadius=function(dr){return arguments.length?(lt=typeof dr=="function"?dr:m(+dr),or):lt},or.cornerRadius=function(dr){return arguments.length?(wt=typeof dr=="function"?dr:m(+dr),or):wt},or.padRadius=function(dr){return arguments.length?(Ot=dr==null?null:typeof dr=="function"?dr:m(+dr),or):Ot},or.startAngle=function(dr){return arguments.length?(Gt=typeof dr=="function"?dr:m(+dr),or):Gt},or.endAngle=function(dr){return arguments.length?(ir=typeof dr=="function"?dr:m(+dr),or):ir},or.padAngle=function(dr){return arguments.length?(Xt=typeof dr=="function"?dr:m(+dr),or):Xt},or.context=function(dr){return arguments.length?(Kt=dr==null?null:dr,or):Kt},or},t.area=M,t.areaRadial=Z,t.curveBasis=function(Ie){return new Ye(Ie)},t.curveBasisClosed=function(Ie){return new rt(Ie)},t.curveBasisOpen=function(Ie){return new Oe(Ie)},t.curveBundle=We,t.curveCardinal=st,t.curveCardinalClosed=Pt,t.curveCardinalOpen=at,t.curveCatmullRom=er,t.curveCatmullRomClosed=Ue,t.curveCatmullRomOpen=Be,t.curveLinear=w,t.curveLinearClosed=function(Ie){return new Ke(Ie)},t.curveMonotoneX=function(Ie){return new Xe(Ie)},t.curveMonotoneY=function(Ie){return new ht(Ie)},t.curveNatural=function(Ie){return new pt(Ie)},t.curveStep=function(Ie){return new vt(Ie,.5)},t.curveStepAfter=function(Ie){return new vt(Ie,1)},t.curveStepBefore=function(Ie){return new vt(Ie,0)},t.line=L,t.lineRadial=K,t.linkHorizontal=function(){return j(W)},t.linkRadial=function(){var Ie=j(J);return Ie.angle=Ie.x,delete Ie.x,Ie.radius=Ie.y,delete Ie.y,Ie},t.linkVertical=function(){return j(ee)},t.pie=function(){var Ie=D,lt=P,wt=null,Ot=m(0),Gt=m(n),ir=m(0);function Xt(Kt){var or,dr,vr,ur,pr,br=Kt.length,Rr=0,_r=new Array(br),jr=new Array(br),$r=+Ot.apply(this,arguments),pn=Math.min(n,Math.max(-n,Gt.apply(this,arguments)-$r)),In=Math.min(Math.abs(pn)/br,ir.apply(this,arguments)),On=In*(pn<0?-1:1);for(or=0;or<br;++or)(pr=jr[_r[or]=or]=+Ie(Kt[or],or,Kt))>0&&(Rr+=pr);for(lt!=null?_r.sort(function(Sn,an){return lt(jr[Sn],jr[an])}):wt!=null&&_r.sort(function(Sn,an){return wt(Kt[Sn],Kt[an])}),or=0,vr=Rr?(pn-br*On)/Rr:0;or<br;++or,$r=ur)dr=_r[or],ur=$r+((pr=jr[dr])>0?pr*vr:0)+On,jr[dr]={data:Kt[dr],index:or,value:pr,startAngle:$r,endAngle:ur,padAngle:In};return jr}return Xt.value=function(Kt){return arguments.length?(Ie=typeof Kt=="function"?Kt:m(+Kt),Xt):Ie},Xt.sortValues=function(Kt){return arguments.length?(lt=Kt,wt=null,Xt):lt},Xt.sort=function(Kt){return arguments.length?(wt=Kt,lt=null,Xt):wt},Xt.startAngle=function(Kt){return arguments.length?(Ot=typeof Kt=="function"?Kt:m(+Kt),Xt):Ot},Xt.endAngle=function(Kt){return arguments.length?(Gt=typeof Kt=="function"?Kt:m(+Kt),Xt):Gt},Xt.padAngle=function(Kt){return arguments.length?(ir=typeof Kt=="function"?Kt:m(+Kt),Xt):ir},Xt},t.pointRadial=H,t.radialArea=Z,t.radialLine=K,t.stack=function(){var Ie=m([]),lt=xt,wt=Dt,Ot=it;function Gt(ir){var Xt,Kt,or=Ie.apply(this,arguments),dr=ir.length,vr=or.length,ur=new Array(vr);for(Xt=0;Xt<vr;++Xt){for(var pr,br=or[Xt],Rr=ur[Xt]=new Array(dr),_r=0;_r<dr;++_r)Rr[_r]=pr=[0,+Ot(ir[_r],br,_r,ir)],pr.data=ir[_r];Rr.key=br}for(Xt=0,Kt=lt(ur);Xt<vr;++Xt)ur[Kt[Xt]].index=Xt;return wt(ur,Kt),ur}return Gt.keys=function(ir){return arguments.length?(Ie=typeof ir=="function"?ir:m(Y.call(ir)),Gt):Ie},Gt.value=function(ir){return arguments.length?(Ot=typeof ir=="function"?ir:m(+ir),Gt):Ot},Gt.order=function(ir){return arguments.length?(lt=ir==null?xt:typeof ir=="function"?ir:m(Y.call(ir)),Gt):lt},Gt.offset=function(ir){return arguments.length?(wt=ir==null?Dt:ir,Gt):wt},Gt},t.stackOffsetDiverging=function(Ie,lt){if((Kt=Ie.length)>0)for(var wt,Ot,Gt,ir,Xt,Kt,or=0,dr=Ie[lt[0]].length;or<dr;++or)for(ir=Xt=0,wt=0;wt<Kt;++wt)(Gt=(Ot=Ie[lt[wt]][or])[1]-Ot[0])>0?(Ot[0]=ir,Ot[1]=ir+=Gt):Gt<0?(Ot[1]=Xt,Ot[0]=Xt+=Gt):(Ot[0]=0,Ot[1]=Gt)},t.stackOffsetExpand=function(Ie,lt){if((Ot=Ie.length)>0){for(var wt,Ot,Gt,ir=0,Xt=Ie[0].length;ir<Xt;++ir){for(Gt=wt=0;wt<Ot;++wt)Gt+=Ie[wt][ir][1]||0;if(Gt)for(wt=0;wt<Ot;++wt)Ie[wt][ir][1]/=Gt}Dt(Ie,lt)}},t.stackOffsetNone=Dt,t.stackOffsetSilhouette=function(Ie,lt){if((wt=Ie.length)>0){for(var wt,Ot=0,Gt=Ie[lt[0]],ir=Gt.length;Ot<ir;++Ot){for(var Xt=0,Kt=0;Xt<wt;++Xt)Kt+=Ie[Xt][Ot][1]||0;Gt[Ot][1]+=Gt[Ot][0]=-Kt/2}Dt(Ie,lt)}},t.stackOffsetWiggle=function(Ie,lt){if((Gt=Ie.length)>0&&(Ot=(wt=Ie[lt[0]]).length)>0){for(var wt,Ot,Gt,ir=0,Xt=1;Xt<Ot;++Xt){for(var Kt=0,or=0,dr=0;Kt<Gt;++Kt){for(var vr=Ie[lt[Kt]],ur=vr[Xt][1]||0,pr=(ur-(vr[Xt-1][1]||0))/2,br=0;br<Kt;++br){var Rr=Ie[lt[br]];pr+=(Rr[Xt][1]||0)-(Rr[Xt-1][1]||0)}or+=ur,dr+=pr*ur}wt[Xt-1][1]+=wt[Xt-1][0]=ir,or&&(ir-=dr/or)}wt[Xt-1][1]+=wt[Xt-1][0]=ir,Dt(Ie,lt)}},t.stackOrderAppearance=St,t.stackOrderAscending=Ut,t.stackOrderDescending=function(Ie){return Ut(Ie).reverse()},t.stackOrderInsideOut=function(Ie){var lt,wt,Ot=Ie.length,Gt=Ie.map(Qt),ir=St(Ie),Xt=0,Kt=0,or=[],dr=[];for(lt=0;lt<Ot;++lt)wt=ir[lt],Xt<Kt?(Xt+=Gt[wt],or.push(wt)):(Kt+=Gt[wt],dr.push(wt));return dr.reverse().concat(or)},t.stackOrderNone=xt,t.stackOrderReverse=function(Ie){return xt(Ie).reverse()},t.symbol=function(){var Ie=m(Q),lt=m(64),wt=null;function Ot(){var Gt;if(wt||(wt=Gt=d.path()),Ie.apply(this,arguments).draw(wt,+lt.apply(this,arguments)),Gt)return wt=null,Gt+""||null}return Ot.type=function(Gt){return arguments.length?(Ie=typeof Gt=="function"?Gt:m(Gt),Ot):Ie},Ot.size=function(Gt){return arguments.length?(lt=typeof Gt=="function"?Gt:m(+Gt),Ot):lt},Ot.context=function(Gt){return arguments.length?(wt=Gt==null?null:Gt,Ot):wt},Ot},t.symbolCircle=Q,t.symbolCross=te,t.symbolDiamond=he,t.symbolSquare=ke,t.symbolStar=ve,t.symbolTriangle=be,t.symbolWye=Me,t.symbols=Se,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-path":169}],172:[function(r,O,B){(function(t,d){typeof B=="object"&&O!==void 0?d(B,r("d3-time")):d((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,d){function m(at){if(0<=at.y&&at.y<100){var tt=new Date(-1,at.m,at.d,at.H,at.M,at.S,at.L);return tt.setFullYear(at.y),tt}return new Date(at.y,at.m,at.d,at.H,at.M,at.S,at.L)}function p(at){if(0<=at.y&&at.y<100){var tt=new Date(Date.UTC(-1,at.m,at.d,at.H,at.M,at.S,at.L));return tt.setUTCFullYear(at.y),tt}return new Date(Date.UTC(at.y,at.m,at.d,at.H,at.M,at.S,at.L))}function e(at,tt,_t){return{y:at,m:tt,d:_t,H:0,M:0,S:0,L:0}}function f(at){var tt=at.dateTime,_t=at.date,er=at.time,tr=at.periods,Ue=at.days,He=at.shortDays,Be=at.months,Ke=at.shortMonths,_e=a(tr),Ce=g(tr),Le=a(Ue),Pe=g(Ue),Xe=a(He),ht=g(He),Mt=a(Be),pt=g(Be),Lt=a(Ke),vt=g(Ke),Dt={a:function(Qt){return He[Qt.getDay()]},A:function(Qt){return Ue[Qt.getDay()]},b:function(Qt){return Ke[Qt.getMonth()]},B:function(Qt){return Be[Qt.getMonth()]},c:null,d:Z,e:Z,f:j,H,I:Y,j:$,L:z,m:W,M:ee,p:function(Qt){return tr[+(Qt.getHours()>=12)]},q:function(Qt){return 1+~~(Qt.getMonth()/3)},Q:Qe,s:st,S:J,u:Q,U:te,V:ie,w:ae,W:he,x:null,X:null,y:se,Y:de,Z:ue,"%":qe},xt={a:function(Qt){return He[Qt.getUTCDay()]},A:function(Qt){return Ue[Qt.getUTCDay()]},b:function(Qt){return Ke[Qt.getUTCMonth()]},B:function(Qt){return Be[Qt.getUTCMonth()]},c:null,d:ve,e:ve,f:ce,H:ke,I:Ee,j:be,L:xe,m:ge,M:we,p:function(Qt){return tr[+(Qt.getUTCHours()>=12)]},q:function(Qt){return 1+~~(Qt.getUTCMonth()/3)},Q:Qe,s:st,S:Me,u:Se,U:ze,V:Fe,w:Ye,W:rt,x:null,X:null,y:Oe,Y:je,Z:We,"%":qe},it={a:function(Qt,Ie,lt){var wt=Xe.exec(Ie.slice(lt));return wt?(Qt.w=ht[wt[0].toLowerCase()],lt+wt[0].length):-1},A:function(Qt,Ie,lt){var wt=Le.exec(Ie.slice(lt));return wt?(Qt.w=Pe[wt[0].toLowerCase()],lt+wt[0].length):-1},b:function(Qt,Ie,lt){var wt=Lt.exec(Ie.slice(lt));return wt?(Qt.m=vt[wt[0].toLowerCase()],lt+wt[0].length):-1},B:function(Qt,Ie,lt){var wt=Mt.exec(Ie.slice(lt));return wt?(Qt.m=pt[wt[0].toLowerCase()],lt+wt[0].length):-1},c:function(Qt,Ie,lt){return Ut(Qt,tt,Ie,lt)},d:k,e:k,f:U,H:M,I:M,j:L,L:N,m:C,M:P,p:function(Qt,Ie,lt){var wt=_e.exec(Ie.slice(lt));return wt?(Qt.p=Ce[wt[0].toLowerCase()],lt+wt[0].length):-1},q:w,Q:X,s:K,S:D,u:y,U:v,V:_,w:h,W:x,x:function(Qt,Ie,lt){return Ut(Qt,_t,Ie,lt)},X:function(Qt,Ie,lt){return Ut(Qt,er,Ie,lt)},y:A,Y:T,Z:S,"%":q};function St(Qt,Ie){return function(lt){var wt,Ot,Gt,ir=[],Xt=-1,Kt=0,or=Qt.length;for(lt instanceof Date||(lt=new Date(+lt));++Xt<or;)Qt.charCodeAt(Xt)===37&&(ir.push(Qt.slice(Kt,Xt)),(Ot=s[wt=Qt.charAt(++Xt)])!=null?wt=Qt.charAt(++Xt):Ot=wt==="e"?" ":"0",(Gt=Ie[wt])&&(wt=Gt(lt,Ot)),ir.push(wt),Kt=Xt+1);return ir.push(Qt.slice(Kt,Xt)),ir.join("")}}function Nt(Qt,Ie){return function(lt){var wt,Ot,Gt=e(1900,void 0,1);if(Ut(Gt,Qt,lt+="",0)!=lt.length)return null;if("Q"in Gt)return new Date(Gt.Q);if("s"in Gt)return new Date(1e3*Gt.s+("L"in Gt?Gt.L:0));if(Ie&&!("Z"in Gt)&&(Gt.Z=0),"p"in Gt&&(Gt.H=Gt.H%12+12*Gt.p),Gt.m===void 0&&(Gt.m="q"in Gt?Gt.q:0),"V"in Gt){if(Gt.V<1||Gt.V>53)return null;"w"in Gt||(Gt.w=1),"Z"in Gt?(Ot=(wt=p(e(Gt.y,0,1))).getUTCDay(),wt=Ot>4||Ot===0?d.utcMonday.ceil(wt):d.utcMonday(wt),wt=d.utcDay.offset(wt,7*(Gt.V-1)),Gt.y=wt.getUTCFullYear(),Gt.m=wt.getUTCMonth(),Gt.d=wt.getUTCDate()+(Gt.w+6)%7):(Ot=(wt=m(e(Gt.y,0,1))).getDay(),wt=Ot>4||Ot===0?d.timeMonday.ceil(wt):d.timeMonday(wt),wt=d.timeDay.offset(wt,7*(Gt.V-1)),Gt.y=wt.getFullYear(),Gt.m=wt.getMonth(),Gt.d=wt.getDate()+(Gt.w+6)%7)}else("W"in Gt||"U"in Gt)&&("w"in Gt||(Gt.w="u"in Gt?Gt.u%7:"W"in Gt?1:0),Ot="Z"in Gt?p(e(Gt.y,0,1)).getUTCDay():m(e(Gt.y,0,1)).getDay(),Gt.m=0,Gt.d="W"in Gt?(Gt.w+6)%7+7*Gt.W-(Ot+5)%7:Gt.w+7*Gt.U-(Ot+6)%7);return"Z"in Gt?(Gt.H+=Gt.Z/100|0,Gt.M+=Gt.Z%100,p(Gt)):m(Gt)}}function Ut(Qt,Ie,lt,wt){for(var Ot,Gt,ir=0,Xt=Ie.length,Kt=lt.length;ir<Xt;){if(wt>=Kt)return-1;if((Ot=Ie.charCodeAt(ir++))===37){if(Ot=Ie.charAt(ir++),!(Gt=it[Ot in s?Ie.charAt(ir++):Ot])||(wt=Gt(Qt,lt,wt))<0)return-1}else if(Ot!=lt.charCodeAt(wt++))return-1}return wt}return Dt.x=St(_t,Dt),Dt.X=St(er,Dt),Dt.c=St(tt,Dt),xt.x=St(_t,xt),xt.X=St(er,xt),xt.c=St(tt,xt),{format:function(Qt){var Ie=St(Qt+="",Dt);return Ie.toString=function(){return Qt},Ie},parse:function(Qt){var Ie=Nt(Qt+="",!1);return Ie.toString=function(){return Qt},Ie},utcFormat:function(Qt){var Ie=St(Qt+="",xt);return Ie.toString=function(){return Qt},Ie},utcParse:function(Qt){var Ie=Nt(Qt+="",!0);return Ie.toString=function(){return Qt},Ie}}}var u,s={"-":"",_:" ",0:"0"},l=/^\s*\d+/,o=/^%/,i=/[\\^$*+?|[\]().{}]/g;function c(at,tt,_t){var er=at<0?"-":"",tr=(er?-at:at)+"",Ue=tr.length;return er+(Ue<_t?new Array(_t-Ue+1).join(tt)+tr:tr)}function n(at){return at.replace(i,"\\$&")}function a(at){return new RegExp("^(?:"+at.map(n).join("|")+")","i")}function g(at){for(var tt={},_t=-1,er=at.length;++_t<er;)tt[at[_t].toLowerCase()]=_t;return tt}function h(at,tt,_t){var er=l.exec(tt.slice(_t,_t+1));return er?(at.w=+er[0],_t+er[0].length):-1}function y(at,tt,_t){var er=l.exec(tt.slice(_t,_t+1));return er?(at.u=+er[0],_t+er[0].length):-1}function v(at,tt,_t){var er=l.exec(tt.slice(_t,_t+2));return er?(at.U=+er[0],_t+er[0].length):-1}function _(at,tt,_t){var er=l.exec(tt.slice(_t,_t+2));return er?(at.V=+er[0],_t+er[0].length):-1}function x(at,tt,_t){var er=l.exec(tt.slice(_t,_t+2));return er?(at.W=+er[0],_t+er[0].length):-1}function T(at,tt,_t){var er=l.exec(tt.slice(_t,_t+4));return er?(at.y=+er[0],_t+er[0].length):-1}function A(at,tt,_t){var er=l.exec(tt.slice(_t,_t+2));return er?(at.y=+er[0]+(+er[0]>68?1900:2e3),_t+er[0].length):-1}function S(at,tt,_t){var er=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(tt.slice(_t,_t+6));return er?(at.Z=er[1]?0:-(er[2]+(er[3]||"00")),_t+er[0].length):-1}function w(at,tt,_t){var er=l.exec(tt.slice(_t,_t+1));return er?(at.q=3*er[0]-3,_t+er[0].length):-1}function C(at,tt,_t){var er=l.exec(tt.slice(_t,_t+2));return er?(at.m=er[0]-1,_t+er[0].length):-1}function k(at,tt,_t){var er=l.exec(tt.slice(_t,_t+2));return er?(at.d=+er[0],_t+er[0].length):-1}function L(at,tt,_t){var er=l.exec(tt.slice(_t,_t+3));return er?(at.m=0,at.d=+er[0],_t+er[0].length):-1}function M(at,tt,_t){var er=l.exec(tt.slice(_t,_t+2));return er?(at.H=+er[0],_t+er[0].length):-1}function P(at,tt,_t){var er=l.exec(tt.slice(_t,_t+2));return er?(at.M=+er[0],_t+er[0].length):-1}function D(at,tt,_t){var er=l.exec(tt.slice(_t,_t+2));return er?(at.S=+er[0],_t+er[0].length):-1}function N(at,tt,_t){var er=l.exec(tt.slice(_t,_t+3));return er?(at.L=+er[0],_t+er[0].length):-1}function U(at,tt,_t){var er=l.exec(tt.slice(_t,_t+6));return er?(at.L=Math.floor(er[0]/1e3),_t+er[0].length):-1}function q(at,tt,_t){var er=o.exec(tt.slice(_t,_t+1));return er?_t+er[0].length:-1}function X(at,tt,_t){var er=l.exec(tt.slice(_t));return er?(at.Q=+er[0],_t+er[0].length):-1}function K(at,tt,_t){var er=l.exec(tt.slice(_t));return er?(at.s=+er[0],_t+er[0].length):-1}function Z(at,tt){return c(at.getDate(),tt,2)}function H(at,tt){return c(at.getHours(),tt,2)}function Y(at,tt){return c(at.getHours()%12||12,tt,2)}function $(at,tt){return c(1+d.timeDay.count(d.timeYear(at),at),tt,3)}function z(at,tt){return c(at.getMilliseconds(),tt,3)}function j(at,tt){return z(at,tt)+"000"}function W(at,tt){return c(at.getMonth()+1,tt,2)}function ee(at,tt){return c(at.getMinutes(),tt,2)}function J(at,tt){return c(at.getSeconds(),tt,2)}function Q(at){var tt=at.getDay();return tt===0?7:tt}function te(at,tt){return c(d.timeSunday.count(d.timeYear(at)-1,at),tt,2)}function ie(at,tt){var _t=at.getDay();return at=_t>=4||_t===0?d.timeThursday(at):d.timeThursday.ceil(at),c(d.timeThursday.count(d.timeYear(at),at)+(d.timeYear(at).getDay()===4),tt,2)}function ae(at){return at.getDay()}function he(at,tt){return c(d.timeMonday.count(d.timeYear(at)-1,at),tt,2)}function se(at,tt){return c(at.getFullYear()%100,tt,2)}function de(at,tt){return c(at.getFullYear()%1e4,tt,4)}function ue(at){var tt=at.getTimezoneOffset();return(tt>0?"-":(tt*=-1,"+"))+c(tt/60|0,"0",2)+c(tt%60,"0",2)}function ve(at,tt){return c(at.getUTCDate(),tt,2)}function ke(at,tt){return c(at.getUTCHours(),tt,2)}function Ee(at,tt){return c(at.getUTCHours()%12||12,tt,2)}function be(at,tt){return c(1+d.utcDay.count(d.utcYear(at),at),tt,3)}function xe(at,tt){return c(at.getUTCMilliseconds(),tt,3)}function ce(at,tt){return xe(at,tt)+"000"}function ge(at,tt){return c(at.getUTCMonth()+1,tt,2)}function we(at,tt){return c(at.getUTCMinutes(),tt,2)}function Me(at,tt){return c(at.getUTCSeconds(),tt,2)}function Se(at){var tt=at.getUTCDay();return tt===0?7:tt}function ze(at,tt){return c(d.utcSunday.count(d.utcYear(at)-1,at),tt,2)}function Fe(at,tt){var _t=at.getUTCDay();return at=_t>=4||_t===0?d.utcThursday(at):d.utcThursday.ceil(at),c(d.utcThursday.count(d.utcYear(at),at)+(d.utcYear(at).getUTCDay()===4),tt,2)}function Ye(at){return at.getUTCDay()}function rt(at,tt){return c(d.utcMonday.count(d.utcYear(at)-1,at),tt,2)}function Oe(at,tt){return c(at.getUTCFullYear()%100,tt,2)}function je(at,tt){return c(at.getUTCFullYear()%1e4,tt,4)}function We(){return"+0000"}function qe(){return"%"}function Qe(at){return+at}function st(at){return Math.floor(+at/1e3)}function ct(at){return u=f(at),t.timeFormat=u.format,t.timeParse=u.parse,t.utcFormat=u.utcFormat,t.utcParse=u.utcParse,u}ct({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Pt=Date.prototype.toISOString?function(at){return at.toISOString()}:t.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),kt=+new Date("2000-01-01T00:00:00.000Z")?function(at){var tt=new Date(at);return isNaN(tt)?null:tt}:t.utcParse("%Y-%m-%dT%H:%M:%S.%LZ");t.isoFormat=Pt,t.isoParse=kt,t.timeFormatDefaultLocale=ct,t.timeFormatLocale=f,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-time":173}],173:[function(r,O,B){(function(t,d){d(typeof B=="object"&&O!==void 0?B:(t=t||self).d3=t.d3||{})})(this,function(t){var d=new Date,m=new Date;function p(ge,we,Me,Se){function ze(Fe){return ge(Fe=arguments.length===0?new Date:new Date(+Fe)),Fe}return ze.floor=function(Fe){return ge(Fe=new Date(+Fe)),Fe},ze.ceil=function(Fe){return ge(Fe=new Date(Fe-1)),we(Fe,1),ge(Fe),Fe},ze.round=function(Fe){var Ye=ze(Fe),rt=ze.ceil(Fe);return Fe-Ye<rt-Fe?Ye:rt},ze.offset=function(Fe,Ye){return we(Fe=new Date(+Fe),Ye==null?1:Math.floor(Ye)),Fe},ze.range=function(Fe,Ye,rt){var Oe,je=[];if(Fe=ze.ceil(Fe),rt=rt==null?1:Math.floor(rt),!(Fe<Ye&&rt>0))return je;do je.push(Oe=new Date(+Fe)),we(Fe,rt),ge(Fe);while(Oe<Fe&&Fe<Ye);return je},ze.filter=function(Fe){return p(function(Ye){if(Ye>=Ye)for(;ge(Ye),!Fe(Ye);)Ye.setTime(Ye-1)},function(Ye,rt){if(Ye>=Ye)if(rt<0)for(;++rt<=0;)for(;we(Ye,-1),!Fe(Ye););else for(;--rt>=0;)for(;we(Ye,1),!Fe(Ye););})},Me&&(ze.count=function(Fe,Ye){return d.setTime(+Fe),m.setTime(+Ye),ge(d),ge(m),Math.floor(Me(d,m))},ze.every=function(Fe){return Fe=Math.floor(Fe),isFinite(Fe)&&Fe>0?Fe>1?ze.filter(Se?function(Ye){return Se(Ye)%Fe==0}:function(Ye){return ze.count(0,Ye)%Fe==0}):ze:null}),ze}var e=p(function(){},function(ge,we){ge.setTime(+ge+we)},function(ge,we){return we-ge});e.every=function(ge){return ge=Math.floor(ge),isFinite(ge)&&ge>0?ge>1?p(function(we){we.setTime(Math.floor(we/ge)*ge)},function(we,Me){we.setTime(+we+Me*ge)},function(we,Me){return(Me-we)/ge}):e:null};var f=e.range,u=p(function(ge){ge.setTime(ge-ge.getMilliseconds())},function(ge,we){ge.setTime(+ge+1e3*we)},function(ge,we){return(we-ge)/1e3},function(ge){return ge.getUTCSeconds()}),s=u.range,l=p(function(ge){ge.setTime(ge-ge.getMilliseconds()-1e3*ge.getSeconds())},function(ge,we){ge.setTime(+ge+6e4*we)},function(ge,we){return(we-ge)/6e4},function(ge){return ge.getMinutes()}),o=l.range,i=p(function(ge){ge.setTime(ge-ge.getMilliseconds()-1e3*ge.getSeconds()-6e4*ge.getMinutes())},function(ge,we){ge.setTime(+ge+36e5*we)},function(ge,we){return(we-ge)/36e5},function(ge){return ge.getHours()}),c=i.range,n=p(function(ge){ge.setHours(0,0,0,0)},function(ge,we){ge.setDate(ge.getDate()+we)},function(ge,we){return(we-ge-6e4*(we.getTimezoneOffset()-ge.getTimezoneOffset()))/864e5},function(ge){return ge.getDate()-1}),a=n.range;function g(ge){return p(function(we){we.setDate(we.getDate()-(we.getDay()+7-ge)%7),we.setHours(0,0,0,0)},function(we,Me){we.setDate(we.getDate()+7*Me)},function(we,Me){return(Me-we-6e4*(Me.getTimezoneOffset()-we.getTimezoneOffset()))/6048e5})}var h=g(0),y=g(1),v=g(2),_=g(3),x=g(4),T=g(5),A=g(6),S=h.range,w=y.range,C=v.range,k=_.range,L=x.range,M=T.range,P=A.range,D=p(function(ge){ge.setDate(1),ge.setHours(0,0,0,0)},function(ge,we){ge.setMonth(ge.getMonth()+we)},function(ge,we){return we.getMonth()-ge.getMonth()+12*(we.getFullYear()-ge.getFullYear())},function(ge){return ge.getMonth()}),N=D.range,U=p(function(ge){ge.setMonth(0,1),ge.setHours(0,0,0,0)},function(ge,we){ge.setFullYear(ge.getFullYear()+we)},function(ge,we){return we.getFullYear()-ge.getFullYear()},function(ge){return ge.getFullYear()});U.every=function(ge){return isFinite(ge=Math.floor(ge))&&ge>0?p(function(we){we.setFullYear(Math.floor(we.getFullYear()/ge)*ge),we.setMonth(0,1),we.setHours(0,0,0,0)},function(we,Me){we.setFullYear(we.getFullYear()+Me*ge)}):null};var q=U.range,X=p(function(ge){ge.setUTCSeconds(0,0)},function(ge,we){ge.setTime(+ge+6e4*we)},function(ge,we){return(we-ge)/6e4},function(ge){return ge.getUTCMinutes()}),K=X.range,Z=p(function(ge){ge.setUTCMinutes(0,0,0)},function(ge,we){ge.setTime(+ge+36e5*we)},function(ge,we){return(we-ge)/36e5},function(ge){return ge.getUTCHours()}),H=Z.range,Y=p(function(ge){ge.setUTCHours(0,0,0,0)},function(ge,we){ge.setUTCDate(ge.getUTCDate()+we)},function(ge,we){return(we-ge)/864e5},function(ge){return ge.getUTCDate()-1}),$=Y.range;function z(ge){return p(function(we){we.setUTCDate(we.getUTCDate()-(we.getUTCDay()+7-ge)%7),we.setUTCHours(0,0,0,0)},function(we,Me){we.setUTCDate(we.getUTCDate()+7*Me)},function(we,Me){return(Me-we)/6048e5})}var j=z(0),W=z(1),ee=z(2),J=z(3),Q=z(4),te=z(5),ie=z(6),ae=j.range,he=W.range,se=ee.range,de=J.range,ue=Q.range,ve=te.range,ke=ie.range,Ee=p(function(ge){ge.setUTCDate(1),ge.setUTCHours(0,0,0,0)},function(ge,we){ge.setUTCMonth(ge.getUTCMonth()+we)},function(ge,we){return we.getUTCMonth()-ge.getUTCMonth()+12*(we.getUTCFullYear()-ge.getUTCFullYear())},function(ge){return ge.getUTCMonth()}),be=Ee.range,xe=p(function(ge){ge.setUTCMonth(0,1),ge.setUTCHours(0,0,0,0)},function(ge,we){ge.setUTCFullYear(ge.getUTCFullYear()+we)},function(ge,we){return we.getUTCFullYear()-ge.getUTCFullYear()},function(ge){return ge.getUTCFullYear()});xe.every=function(ge){return isFinite(ge=Math.floor(ge))&&ge>0?p(function(we){we.setUTCFullYear(Math.floor(we.getUTCFullYear()/ge)*ge),we.setUTCMonth(0,1),we.setUTCHours(0,0,0,0)},function(we,Me){we.setUTCFullYear(we.getUTCFullYear()+Me*ge)}):null};var ce=xe.range;t.timeDay=n,t.timeDays=a,t.timeFriday=T,t.timeFridays=M,t.timeHour=i,t.timeHours=c,t.timeInterval=p,t.timeMillisecond=e,t.timeMilliseconds=f,t.timeMinute=l,t.timeMinutes=o,t.timeMonday=y,t.timeMondays=w,t.timeMonth=D,t.timeMonths=N,t.timeSaturday=A,t.timeSaturdays=P,t.timeSecond=u,t.timeSeconds=s,t.timeSunday=h,t.timeSundays=S,t.timeThursday=x,t.timeThursdays=L,t.timeTuesday=v,t.timeTuesdays=C,t.timeWednesday=_,t.timeWednesdays=k,t.timeWeek=h,t.timeWeeks=S,t.timeYear=U,t.timeYears=q,t.utcDay=Y,t.utcDays=$,t.utcFriday=te,t.utcFridays=ve,t.utcHour=Z,t.utcHours=H,t.utcMillisecond=e,t.utcMilliseconds=f,t.utcMinute=X,t.utcMinutes=K,t.utcMonday=W,t.utcMondays=he,t.utcMonth=Ee,t.utcMonths=be,t.utcSaturday=ie,t.utcSaturdays=ke,t.utcSecond=u,t.utcSeconds=s,t.utcSunday=j,t.utcSundays=ae,t.utcThursday=Q,t.utcThursdays=ue,t.utcTuesday=ee,t.utcTuesdays=se,t.utcWednesday=J,t.utcWednesdays=de,t.utcWeek=j,t.utcWeeks=ae,t.utcYear=xe,t.utcYears=ce,Object.defineProperty(t,"__esModule",{value:!0})})},{}],174:[function(r,O,B){arguments[4][173][0].apply(B,arguments)},{dup:173}],175:[function(r,O,B){(function(t,d){d(typeof B=="object"&&O!==void 0?B:(t=t||self).d3=t.d3||{})})(this,function(t){var d,m,p=0,e=0,f=0,u=0,s=0,l=0,o=typeof performance=="object"&&performance.now?performance:Date,i=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(x){setTimeout(x,17)};function c(){return s||(i(n),s=o.now()+l)}function n(){s=0}function a(){this._call=this._time=this._next=null}function g(x,T,A){var S=new a;return S.restart(x,T,A),S}function h(){c(),++p;for(var x,T=d;T;)(x=s-T._time)>=0&&T._call.call(null,x),T=T._next;--p}function y(){s=(u=o.now())+l,p=e=0;try{h()}finally{p=0,function(){for(var x,T,A=d,S=1/0;A;)A._call?(S>A._time&&(S=A._time),x=A,A=A._next):(T=A._next,A._next=null,A=x?x._next=T:d=T);m=x,_(S)}(),s=0}}function v(){var x=o.now(),T=x-u;T>1e3&&(l-=T,u=x)}function _(x){p||(e&&(e=clearTimeout(e)),x-s>24?(x<1/0&&(e=setTimeout(y,x-o.now()-l)),f&&(f=clearInterval(f))):(f||(u=o.now(),f=setInterval(v,1e3)),p=1,i(y)))}a.prototype=g.prototype={constructor:a,restart:function(x,T,A){if(typeof x!="function")throw new TypeError("callback is not a function");A=(A==null?c():+A)+(T==null?0:+T),this._next||m===this||(m?m._next=this:d=this,m=this),this._call=x,this._time=A,_()},stop:function(){this._call&&(this._call=null,this._time=1/0,_())}},t.interval=function(x,T,A){var S=new a,w=T;return T==null?(S.restart(x,T,A),S):(T=+T,A=A==null?c():+A,S.restart(function C(k){k+=w,S.restart(C,w+=T,A),x(k)},T,A),S)},t.now=c,t.timeout=function(x,T,A){var S=new a;return T=T==null?0:+T,S.restart(function(w){S.stop(),x(w+T)},T,A),S},t.timer=g,t.timerFlush=h,Object.defineProperty(t,"__esModule",{value:!0})})},{}],176:[function(r,O,B){O.exports=function(){for(var t=0;t<arguments.length;t++)if(arguments[t]!==void 0)return arguments[t]}},{}],177:[function(r,O,B){var t=r("incremental-convex-hull"),d=r("uniq");function m(e,f){this.point=e,this.index=f}function p(e,f){for(var u=e.point,s=f.point,l=u.length,o=0;o<l;++o){var i=s[o]-u[o];if(i)return i}return 0}O.exports=function(e,f){var u=e.length;if(u===0)return[];var s=e[0].length;if(s<1)return[];if(s===1)return function(S,w,C){if(S===1)return C?[[-1,0]]:[];var k=w.map(function(N,U){return[N[0],U]});k.sort(function(N,U){return N[0]-U[0]});for(var L=new Array(S-1),M=1;M<S;++M){var P=k[M-1],D=k[M];L[M-1]=[P[1],D[1]]}return C&&L.push([-1,L[0][1]],[L[S-1][1],-1]),L}(u,e,f);for(var l=new Array(u),o=1,i=0;i<u;++i){for(var c=e[i],n=new Array(s+1),a=0,g=0;g<s;++g){var h=c[g];n[g]=h,a+=h*h}n[s]=a,l[i]=new m(n,i),o=Math.max(a,o)}d(l,p),u=l.length;var y=new Array(u+s+1),v=new Array(u+s+1),_=(s+1)*(s+1)*o,x=new Array(s+1);for(i=0;i<=s;++i)x[i]=0;for(x[s]=_,y[0]=x.slice(),v[0]=-1,i=0;i<=s;++i)(n=x.slice())[i]=1,y[i+1]=n,v[i+1]=-1;for(i=0;i<u;++i){var T=l[i];y[i+s+1]=T.point,v[i+s+1]=T.index}var A=t(y,!1);if(A=f?A.filter(function(S){for(var w=0,C=0;C<=s;++C){var k=v[S[C]];if(k<0&&++w>=2)return!1;S[C]=k}return!0}):A.filter(function(S){for(var w=0;w<=s;++w){var C=v[S[w]];if(C<0)return!1;S[w]=C}return!0}),1&s)for(i=0;i<A.length;++i)n=(T=A[i])[0],T[0]=T[1],T[1]=n;return A}},{"incremental-convex-hull":438,uniq:603}],178:[function(r,O,B){O.exports=m;var t=(m.canvas=document.createElement("canvas")).getContext("2d"),d=p([32,126]);function m(e,f){Array.isArray(e)&&(e=e.join(", "));var u,s={},l=16,o=.05;f&&(f.length===2&&typeof f[0]=="number"?u=p(f):Array.isArray(f)?u=f:(f.o?u=p(f.o):f.pairs&&(u=f.pairs),f.fontSize&&(l=f.fontSize),f.threshold!=null&&(o=f.threshold))),u||(u=d),t.font=l+"px "+e;for(var i=0;i<u.length;i++){var c=u[i],n=t.measureText(c[0]).width+t.measureText(c[1]).width,a=t.measureText(c).width;if(Math.abs(n-a)>l*o){var g=(a-n)/l;s[c]=1e3*g}}return s}function p(e){for(var f=[],u=e[0];u<=e[1];u++)for(var s=String.fromCharCode(u),l=e[0];l<e[1];l++){var o=s+String.fromCharCode(l);f.push(o)}return f}m.createPairs=p,m.ascii=d},{}],179:[function(r,O,B){(function(t){(function(){var d=!1;if(typeof Float64Array!="undefined"){var m=new Float64Array(1),p=new Uint32Array(m.buffer);m[0]=1,d=!0,p[1]===1072693248?(O.exports=function(f){return m[0]=f,[p[0],p[1]]},O.exports.pack=function(f,u){return p[0]=f,p[1]=u,m[0]},O.exports.lo=function(f){return m[0]=f,p[0]},O.exports.hi=function(f){return m[0]=f,p[1]}):p[0]===1072693248?(O.exports=function(f){return m[0]=f,[p[1],p[0]]},O.exports.pack=function(f,u){return p[1]=f,p[0]=u,m[0]},O.exports.lo=function(f){return m[0]=f,p[1]},O.exports.hi=function(f){return m[0]=f,p[0]}):d=!1}if(!d){var e=new t(8);O.exports=function(f){return e.writeDoubleLE(f,0,!0),[e.readUInt32LE(0,!0),e.readUInt32LE(4,!0)]},O.exports.pack=function(f,u){return e.writeUInt32LE(f,0,!0),e.writeUInt32LE(u,4,!0),e.readDoubleLE(0,!0)},O.exports.lo=function(f){return e.writeDoubleLE(f,0,!0),e.readUInt32LE(0,!0)},O.exports.hi=function(f){return e.writeDoubleLE(f,0,!0),e.readUInt32LE(4,!0)}}O.exports.sign=function(f){return O.exports.hi(f)>>>31},O.exports.exponent=function(f){return(O.exports.hi(f)<<1>>>21)-1023},O.exports.fraction=function(f){var u=O.exports.lo(f),s=O.exports.hi(f),l=1048575&s;return 2146435072&s&&(l+=1<<20),[u,l]},O.exports.denormalized=function(f){return!(2146435072&O.exports.hi(f))}}).call(this)}).call(this,r("buffer").Buffer)},{buffer:117}],180:[function(r,O,B){var t=r("abs-svg-path"),d=r("normalize-svg-path"),m={M:"moveTo",C:"bezierCurveTo"};O.exports=function(p,e){p.beginPath(),d(t(e)).forEach(function(f){var u=f[0],s=f.slice(1);p[m[u]].apply(p,s)}),p.closePath()}},{"abs-svg-path":71,"normalize-svg-path":474}],181:[function(r,O,B){O.exports=function(t){switch(t){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],182:[function(r,O,B){O.exports=function(t,d){switch(d===void 0&&(d=0),typeof t){case"number":if(t>0)return function(m,p){var e,f;for(e=new Array(m),f=0;f<m;++f)e[f]=p;return e}(0|t,d);break;case"object":if(typeof t.length=="number")return function m(p,e,f){var u=0|p[f];if(u<=0)return[];var s,l=new Array(u);if(f===p.length-1)for(s=0;s<u;++s)l[s]=e;else for(s=0;s<u;++s)l[s]=m(p,e,f+1);return l}(t,d,0)}return[]}},{}],183:[function(r,O,B){function t(L,M,P){P=P||2;var D,N,U,q,X,K,Z,H=M&&M.length,Y=H?M[0]*P:L.length,$=d(L,0,Y,P,!0),z=[];if(!$||$.next===$.prev)return z;if(H&&($=function(W,ee,J,Q){var te,ie,ae,he,se,de=[];for(te=0,ie=ee.length;te<ie;te++)ae=ee[te]*Q,he=te<ie-1?ee[te+1]*Q:W.length,(se=d(W,ae,he,Q,!1))===se.next&&(se.steiner=!0),de.push(n(se));for(de.sort(l),te=0;te<de.length;te++)o(de[te],J),J=m(J,J.next);return J}(L,M,$,P)),L.length>80*P){D=U=L[0],N=q=L[1];for(var j=P;j<Y;j+=P)(X=L[j])<D&&(D=X),(K=L[j+1])<N&&(N=K),X>U&&(U=X),K>q&&(q=K);Z=(Z=Math.max(U-D,q-N))!==0?1/Z:0}return p($,z,P,D,N,Z),z}function d(L,M,P,D,N){var U,q;if(N===k(L,M,P,D)>0)for(U=M;U<P;U+=D)q=S(U,L[U],L[U+1],q);else for(U=P-D;U>=M;U-=D)q=S(U,L[U],L[U+1],q);return q&&y(q,q.next)&&(w(q),q=q.next),q}function m(L,M){if(!L)return L;M||(M=L);var P,D=L;do if(P=!1,D.steiner||!y(D,D.next)&&h(D.prev,D,D.next)!==0)D=D.next;else{if(w(D),(D=M=D.prev)===D.next)break;P=!0}while(P||D!==M);return M}function p(L,M,P,D,N,U,q){if(L){!q&&U&&function(H,Y,$,z){var j=H;do j.z===null&&(j.z=c(j.x,j.y,Y,$,z)),j.prevZ=j.prev,j.nextZ=j.next,j=j.next;while(j!==H);j.prevZ.nextZ=null,j.prevZ=null,function(W){var ee,J,Q,te,ie,ae,he,se,de=1;do{for(J=W,W=null,ie=null,ae=0;J;){for(ae++,Q=J,he=0,ee=0;ee<de&&(he++,Q=Q.nextZ);ee++);for(se=de;he>0||se>0&&Q;)he!==0&&(se===0||!Q||J.z<=Q.z)?(te=J,J=J.nextZ,he--):(te=Q,Q=Q.nextZ,se--),ie?ie.nextZ=te:W=te,te.prevZ=ie,ie=te;J=Q}ie.nextZ=null,de*=2}while(ae>1)}(j)}(L,D,N,U);for(var X,K,Z=L;L.prev!==L.next;)if(X=L.prev,K=L.next,U?f(L,D,N,U):e(L))M.push(X.i/P),M.push(L.i/P),M.push(K.i/P),w(L),L=K.next,Z=K.next;else if((L=K)===Z){q?q===1?p(L=u(m(L),M,P),M,P,D,N,U,2):q===2&&s(L,M,P,D,N,U):p(m(L),M,P,D,N,U,1);break}}}function e(L){var M=L.prev,P=L,D=L.next;if(h(M,P,D)>=0)return!1;for(var N=L.next.next;N!==L.prev;){if(a(M.x,M.y,P.x,P.y,D.x,D.y,N.x,N.y)&&h(N.prev,N,N.next)>=0)return!1;N=N.next}return!0}function f(L,M,P,D){var N=L.prev,U=L,q=L.next;if(h(N,U,q)>=0)return!1;for(var X=N.x<U.x?N.x<q.x?N.x:q.x:U.x<q.x?U.x:q.x,K=N.y<U.y?N.y<q.y?N.y:q.y:U.y<q.y?U.y:q.y,Z=N.x>U.x?N.x>q.x?N.x:q.x:U.x>q.x?U.x:q.x,H=N.y>U.y?N.y>q.y?N.y:q.y:U.y>q.y?U.y:q.y,Y=c(X,K,M,P,D),$=c(Z,H,M,P,D),z=L.prevZ,j=L.nextZ;z&&z.z>=Y&&j&&j.z<=$;){if(z!==L.prev&&z!==L.next&&a(N.x,N.y,U.x,U.y,q.x,q.y,z.x,z.y)&&h(z.prev,z,z.next)>=0||(z=z.prevZ,j!==L.prev&&j!==L.next&&a(N.x,N.y,U.x,U.y,q.x,q.y,j.x,j.y)&&h(j.prev,j,j.next)>=0))return!1;j=j.nextZ}for(;z&&z.z>=Y;){if(z!==L.prev&&z!==L.next&&a(N.x,N.y,U.x,U.y,q.x,q.y,z.x,z.y)&&h(z.prev,z,z.next)>=0)return!1;z=z.prevZ}for(;j&&j.z<=$;){if(j!==L.prev&&j!==L.next&&a(N.x,N.y,U.x,U.y,q.x,q.y,j.x,j.y)&&h(j.prev,j,j.next)>=0)return!1;j=j.nextZ}return!0}function u(L,M,P){var D=L;do{var N=D.prev,U=D.next.next;!y(N,U)&&v(N,D,D.next,U)&&T(N,U)&&T(U,N)&&(M.push(N.i/P),M.push(D.i/P),M.push(U.i/P),w(D),w(D.next),D=L=U),D=D.next}while(D!==L);return m(D)}function s(L,M,P,D,N,U){var q=L;do{for(var X=q.next.next;X!==q.prev;){if(q.i!==X.i&&g(q,X)){var K=A(q,X);return q=m(q,q.next),K=m(K,K.next),p(q,M,P,D,N,U),void p(K,M,P,D,N,U)}X=X.next}q=q.next}while(q!==L)}function l(L,M){return L.x-M.x}function o(L,M){if(M=function(D,N){var U,q=N,X=D.x,K=D.y,Z=-1/0;do{if(K<=q.y&&K>=q.next.y&&q.next.y!==q.y){var H=q.x+(K-q.y)*(q.next.x-q.x)/(q.next.y-q.y);if(H<=X&&H>Z){if(Z=H,H===X){if(K===q.y)return q;if(K===q.next.y)return q.next}U=q.x<q.next.x?q:q.next}}q=q.next}while(q!==N);if(!U)return null;if(X===Z)return U;var Y,$=U,z=U.x,j=U.y,W=1/0;q=U;do X>=q.x&&q.x>=z&&X!==q.x&&a(K<j?X:Z,K,z,j,K<j?Z:X,K,q.x,q.y)&&(Y=Math.abs(K-q.y)/(X-q.x),T(q,D)&&(Y<W||Y===W&&(q.x>U.x||q.x===U.x&&i(U,q)))&&(U=q,W=Y)),q=q.next;while(q!==$);return U}(L,M)){var P=A(M,L);m(M,M.next),m(P,P.next)}}function i(L,M){return h(L.prev,L,M.prev)<0&&h(M.next,L,L.next)<0}function c(L,M,P,D,N){return(L=1431655765&((L=858993459&((L=252645135&((L=16711935&((L=32767*(L-P)*N)|L<<8))|L<<4))|L<<2))|L<<1))|(M=1431655765&((M=858993459&((M=252645135&((M=16711935&((M=32767*(M-D)*N)|M<<8))|M<<4))|M<<2))|M<<1))<<1}function n(L){var M=L,P=L;do(M.x<P.x||M.x===P.x&&M.y<P.y)&&(P=M),M=M.next;while(M!==L);return P}function a(L,M,P,D,N,U,q,X){return(N-q)*(M-X)-(L-q)*(U-X)>=0&&(L-q)*(D-X)-(P-q)*(M-X)>=0&&(P-q)*(U-X)-(N-q)*(D-X)>=0}function g(L,M){return L.next.i!==M.i&&L.prev.i!==M.i&&!function(P,D){var N=P;do{if(N.i!==P.i&&N.next.i!==P.i&&N.i!==D.i&&N.next.i!==D.i&&v(N,N.next,P,D))return!0;N=N.next}while(N!==P);return!1}(L,M)&&(T(L,M)&&T(M,L)&&function(P,D){var N=P,U=!1,q=(P.x+D.x)/2,X=(P.y+D.y)/2;do N.y>X!=N.next.y>X&&N.next.y!==N.y&&q<(N.next.x-N.x)*(X-N.y)/(N.next.y-N.y)+N.x&&(U=!U),N=N.next;while(N!==P);return U}(L,M)&&(h(L.prev,L,M.prev)||h(L,M.prev,M))||y(L,M)&&h(L.prev,L,L.next)>0&&h(M.prev,M,M.next)>0)}function h(L,M,P){return(M.y-L.y)*(P.x-M.x)-(M.x-L.x)*(P.y-M.y)}function y(L,M){return L.x===M.x&&L.y===M.y}function v(L,M,P,D){var N=x(h(L,M,P)),U=x(h(L,M,D)),q=x(h(P,D,L)),X=x(h(P,D,M));return N!==U&&q!==X||!(N!==0||!_(L,P,M))||!(U!==0||!_(L,D,M))||!(q!==0||!_(P,L,D))||!(X!==0||!_(P,M,D))}function _(L,M,P){return M.x<=Math.max(L.x,P.x)&&M.x>=Math.min(L.x,P.x)&&M.y<=Math.max(L.y,P.y)&&M.y>=Math.min(L.y,P.y)}function x(L){return L>0?1:L<0?-1:0}function T(L,M){return h(L.prev,L,L.next)<0?h(L,M,L.next)>=0&&h(L,L.prev,M)>=0:h(L,M,L.prev)<0||h(L,L.next,M)<0}function A(L,M){var P=new C(L.i,L.x,L.y),D=new C(M.i,M.x,M.y),N=L.next,U=M.prev;return L.next=M,M.prev=L,P.next=N,N.prev=P,D.next=P,P.prev=D,U.next=D,D.prev=U,D}function S(L,M,P,D){var N=new C(L,M,P);return D?(N.next=D.next,N.prev=D,D.next.prev=N,D.next=N):(N.prev=N,N.next=N),N}function w(L){L.next.prev=L.prev,L.prev.next=L.next,L.prevZ&&(L.prevZ.nextZ=L.nextZ),L.nextZ&&(L.nextZ.prevZ=L.prevZ)}function C(L,M,P){this.i=L,this.x=M,this.y=P,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function k(L,M,P,D){for(var N=0,U=M,q=P-D;U<P;U+=D)N+=(L[q]-L[U])*(L[U+1]+L[q+1]),q=U;return N}O.exports=t,O.exports.default=t,t.deviation=function(L,M,P,D){var N=M&&M.length,U=N?M[0]*P:L.length,q=Math.abs(k(L,0,U,P));if(N)for(var X=0,K=M.length;X<K;X++){var Z=M[X]*P,H=X<K-1?M[X+1]*P:L.length;q-=Math.abs(k(L,Z,H,P))}var Y=0;for(X=0;X<D.length;X+=3){var $=D[X]*P,z=D[X+1]*P,j=D[X+2]*P;Y+=Math.abs((L[$]-L[j])*(L[z+1]-L[$+1])-(L[$]-L[z])*(L[j+1]-L[$+1]))}return q===0&&Y===0?0:Math.abs((Y-q)/q)},t.flatten=function(L){for(var M=L[0][0].length,P={vertices:[],holes:[],dimensions:M},D=0,N=0;N<L.length;N++){for(var U=0;U<L[N].length;U++)for(var q=0;q<M;q++)P.vertices.push(L[N][U][q]);N>0&&(D+=L[N-1].length,P.holes.push(D))}return P}},{}],184:[function(r,O,B){O.exports=function(d,m){var p=d.length;if(typeof m!="number"){m=0;for(var e=0;e<p;++e){var f=d[e];m=Math.max(m,f[0],f[1])}m=1+(0|m)}m|=0;var u=new Array(m);for(e=0;e<m;++e)u[e]=[];for(e=0;e<p;++e)f=d[e],u[f[0]].push(f[1]),u[f[1]].push(f[0]);for(var s=0;s<m;++s)t(u[s],function(l,o){return l-o});return u};var t=r("uniq")},{uniq:603}],185:[function(r,O,B){var t=r("strongly-connected-components");O.exports=function(d,m){var p,e=[],f=[],u=[],s={},l=[];function o(v){var _,x,T=!1;for(f.push(v),u[v]=!0,_=0;_<l[v].length;_++)(x=l[v][_])===p?(i(p,f),T=!0):u[x]||(T=o(x));if(T)(function S(w){u[w]=!1,s.hasOwnProperty(w)&&Object.keys(s[w]).forEach(function(C){delete s[w][C],u[C]&&S(C)})})(v);else for(_=0;_<l[v].length;_++){x=l[v][_];var A=s[x];A||(A={},s[x]=A),A[x]=!0}return f.pop(),T}function i(v,_){var x=[].concat(_).concat(v);m?m(o):e.push(x)}function c(v){(function(C){for(var k=0;k<d.length;k++)k<C&&(d[k]=[]),d[k]=d[k].filter(function(L){return L>=C})})(v);for(var _,x=t(d).components.filter(function(C){return C.length>1}),T=1/0,A=0;A<x.length;A++)for(var S=0;S<x[A].length;S++)x[A][S]<T&&(T=x[A][S],_=A);var w=x[_];return!!w&&{leastVertex:T,adjList:d.map(function(C,k){return w.indexOf(k)===-1?[]:C.filter(function(L){return w.indexOf(L)!==-1})})}}p=0;for(var n=d.length;p<n;){var a=c(p);if(p=a.leastVertex,l=a.adjList){for(var g=0;g<l.length;g++)for(var h=0;h<l[g].length;h++){var y=l[g][h];u[+y]=!1,s[y]={}}o(p),p+=1}else p=n}return m?void 0:e}},{"strongly-connected-components":575}],186:[function(r,O,B){var t=r("../../object/valid-value");O.exports=function(){return t(this).length=0,this}},{"../../object/valid-value":217}],187:[function(r,O,B){O.exports=r("./is-implemented")()?Array.from:r("./shim")},{"./is-implemented":188,"./shim":189}],188:[function(r,O,B){O.exports=function(){var t,d,m=Array.from;return typeof m=="function"&&(d=m(t=["raz","dwa"]),Boolean(d&&d!==t&&d[1]==="dwa"))}},{}],189:[function(r,O,B){var t=r("es6-symbol").iterator,d=r("../../function/is-arguments"),m=r("../../function/is-function"),p=r("../../number/to-pos-integer"),e=r("../../object/valid-callable"),f=r("../../object/valid-value"),u=r("../../object/is-value"),s=r("../../string/is-string"),l=Array.isArray,o=Function.prototype.call,i={configurable:!0,enumerable:!0,writable:!0,value:null},c=Object.defineProperty;O.exports=function(n){var a,g,h,y,v,_,x,T,A,S,w=arguments[1],C=arguments[2];if(n=Object(f(n)),u(w)&&e(w),this&&this!==Array&&m(this))a=this;else{if(!w){if(d(n))return(v=n.length)!==1?Array.apply(null,n):((y=new Array(1))[0]=n[0],y);if(l(n)){for(y=new Array(v=n.length),g=0;g<v;++g)y[g]=n[g];return y}}y=[]}if(!l(n)){if((A=n[t])!==void 0){for(x=e(A).call(n),a&&(y=new a),T=x.next(),g=0;!T.done;)S=w?o.call(w,C,T.value,g):T.value,a?(i.value=S,c(y,g,i)):y[g]=S,T=x.next(),++g;v=g}else if(s(n)){for(v=n.length,a&&(y=new a),g=0,h=0;g<v;++g)S=n[g],g+1<v&&(_=S.charCodeAt(0))>=55296&&_<=56319&&(S+=n[++g]),S=w?o.call(w,C,S,h):S,a?(i.value=S,c(y,h,i)):y[h]=S,++h;v=h}}if(v===void 0)for(v=p(n.length),a&&(y=new a(v)),g=0;g<v;++g)S=w?o.call(w,C,n[g],g):n[g],a?(i.value=S,c(y,g,i)):y[g]=S;return a&&(i.value=null,y.length=v),y}},{"../../function/is-arguments":190,"../../function/is-function":191,"../../number/to-pos-integer":197,"../../object/is-value":206,"../../object/valid-callable":215,"../../object/valid-value":217,"../../string/is-string":221,"es6-symbol":230}],190:[function(r,O,B){var t=Object.prototype.toString,d=t.call(function(){return arguments}());O.exports=function(m){return t.call(m)===d}},{}],191:[function(r,O,B){var t=Object.prototype.toString,d=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);O.exports=function(m){return typeof m=="function"&&d(t.call(m))}},{}],192:[function(r,O,B){O.exports=function(){}},{}],193:[function(r,O,B){O.exports=r("./is-implemented")()?Math.sign:r("./shim")},{"./is-implemented":194,"./shim":195}],194:[function(r,O,B){O.exports=function(){var t=Math.sign;return typeof t=="function"&&t(10)===1&&t(-20)===-1}},{}],195:[function(r,O,B){O.exports=function(t){return t=Number(t),isNaN(t)||t===0?t:t>0?1:-1}},{}],196:[function(r,O,B){var t=r("../math/sign"),d=Math.abs,m=Math.floor;O.exports=function(p){return isNaN(p)?0:(p=Number(p))!==0&&isFinite(p)?t(p)*m(d(p)):p}},{"../math/sign":193}],197:[function(r,O,B){var t=r("./to-integer"),d=Math.max;O.exports=function(m){return d(0,t(m))}},{"./to-integer":196}],198:[function(r,O,B){var t=r("./valid-callable"),d=r("./valid-value"),m=Function.prototype.bind,p=Function.prototype.call,e=Object.keys,f=Object.prototype.propertyIsEnumerable;O.exports=function(u,s){return function(l,o){var i,c=arguments[2],n=arguments[3];return l=Object(d(l)),t(o),i=e(l),n&&i.sort(typeof n=="function"?m.call(n,l):void 0),typeof u!="function"&&(u=i[u]),p.call(u,i,function(a,g){return f.call(l,a)?p.call(o,c,l[a],a,l,g):s})}}},{"./valid-callable":215,"./valid-value":217}],199:[function(r,O,B){O.exports=r("./is-implemented")()?Object.assign:r("./shim")},{"./is-implemented":200,"./shim":201}],200:[function(r,O,B){O.exports=function(){var t,d=Object.assign;return typeof d=="function"&&(d(t={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},{}],201:[function(r,O,B){var t=r("../keys"),d=r("../valid-value"),m=Math.max;O.exports=function(p,e){var f,u,s,l=m(arguments.length,2);for(p=Object(d(p)),s=function(o){try{p[o]=e[o]}catch(i){f||(f=i)}},u=1;u<l;++u)t(e=arguments[u]).forEach(s);if(f!==void 0)throw f;return p}},{"../keys":207,"../valid-value":217}],202:[function(r,O,B){var t=r("../array/from"),d=r("./assign"),m=r("./valid-value");O.exports=function(p){var e=Object(m(p)),f=arguments[1],u=Object(arguments[2]);if(e!==p&&!f)return e;var s={};return f?t(f,function(l){(u.ensure||l in p)&&(s[l]=p[l])}):d(s,p),s}},{"../array/from":187,"./assign":199,"./valid-value":217}],203:[function(r,O,B){var t,d,m,p,e=Object.create;r("./set-prototype-of/is-implemented")()||(t=r("./set-prototype-of/shim")),O.exports=t?t.level!==1?e:(d={},m={},p={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(f){m[f]=f!=="__proto__"?p:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(d,m),Object.defineProperty(t,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:d}),function(f,u){return e(f===null?d:f,u)}):e},{"./set-prototype-of/is-implemented":213,"./set-prototype-of/shim":214}],204:[function(r,O,B){O.exports=r("./_iterate")("forEach")},{"./_iterate":198}],205:[function(r,O,B){var t=r("./is-value"),d={function:!0,object:!0};O.exports=function(m){return t(m)&&d[typeof m]||!1}},{"./is-value":206}],206:[function(r,O,B){var t=r("../function/noop")();O.exports=function(d){return d!==t&&d!==null}},{"../function/noop":192}],207:[function(r,O,B){O.exports=r("./is-implemented")()?Object.keys:r("./shim")},{"./is-implemented":208,"./shim":209}],208:[function(r,O,B){O.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},{}],209:[function(r,O,B){var t=r("../is-value"),d=Object.keys;O.exports=function(m){return d(t(m)?Object(m):m)}},{"../is-value":206}],210:[function(r,O,B){var t=r("./valid-callable"),d=r("./for-each"),m=Function.prototype.call;O.exports=function(p,e){var f={},u=arguments[2];return t(e),d(p,function(s,l,o,i){f[l]=m.call(e,u,s,l,o,i)}),f}},{"./for-each":204,"./valid-callable":215}],211:[function(r,O,B){var t=r("./is-value"),d=Array.prototype.forEach,m=Object.create,p=function(e,f){var u;for(u in e)f[u]=e[u]};O.exports=function(e){var f=m(null);return d.call(arguments,function(u){t(u)&&p(Object(u),f)}),f}},{"./is-value":206}],212:[function(r,O,B){O.exports=r("./is-implemented")()?Object.setPrototypeOf:r("./shim")},{"./is-implemented":213,"./shim":214}],213:[function(r,O,B){var t=Object.create,d=Object.getPrototypeOf,m={};O.exports=function(){var p=Object.setPrototypeOf,e=arguments[0]||t;return typeof p=="function"&&d(p(e(null),m))===m}},{}],214:[function(r,O,B){var t,d=r("../is-object"),m=r("../valid-value"),p=Object.prototype.isPrototypeOf,e=Object.defineProperty,f={configurable:!0,enumerable:!1,writable:!0,value:void 0};t=function(u,s){if(m(u),s===null||d(s))return u;throw new TypeError("Prototype must be null or an object")},O.exports=function(u){var s,l;return u?(u.level===2?u.set?(l=u.set,s=function(o,i){return l.call(t(o,i),i),o}):s=function(o,i){return t(o,i).__proto__=i,o}:s=function o(i,c){var n;return t(i,c),(n=p.call(o.nullPolyfill,i))&&delete o.nullPolyfill.__proto__,c===null&&(c=o.nullPolyfill),i.__proto__=c,n&&e(o.nullPolyfill,"__proto__",f),i},Object.defineProperty(s,"level",{configurable:!1,enumerable:!1,writable:!1,value:u.level})):null}(function(){var u,s=Object.create(null),l={},o=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(o){try{(u=o.set).call(s,l)}catch(i){}if(Object.getPrototypeOf(s)===l)return{set:u,level:2}}return s.__proto__=l,Object.getPrototypeOf(s)===l?{level:2}:((s={}).__proto__=l,Object.getPrototypeOf(s)===l&&{level:1})}()),r("../create")},{"../create":203,"../is-object":205,"../valid-value":217}],215:[function(r,O,B){O.exports=function(t){if(typeof t!="function")throw new TypeError(t+" is not a function");return t}},{}],216:[function(r,O,B){var t=r("./is-object");O.exports=function(d){if(!t(d))throw new TypeError(d+" is not an Object");return d}},{"./is-object":205}],217:[function(r,O,B){var t=r("./is-value");O.exports=function(d){if(!t(d))throw new TypeError("Cannot use null or undefined");return d}},{"./is-value":206}],218:[function(r,O,B){O.exports=r("./is-implemented")()?String.prototype.contains:r("./shim")},{"./is-implemented":219,"./shim":220}],219:[function(r,O,B){var t="razdwatrzy";O.exports=function(){return typeof t.contains=="function"&&t.contains("dwa")===!0&&t.contains("foo")===!1}},{}],220:[function(r,O,B){var t=String.prototype.indexOf;O.exports=function(d){return t.call(this,d,arguments[1])>-1}},{}],221:[function(r,O,B){var t=Object.prototype.toString,d=t.call("");O.exports=function(m){return typeof m=="string"||m&&typeof m=="object"&&(m instanceof String||t.call(m)===d)||!1}},{}],222:[function(r,O,B){var t=Object.create(null),d=Math.random;O.exports=function(){var m;do m=d().toString(36).slice(2);while(t[m]);return m}},{}],223:[function(r,O,B){var t,d=r("es5-ext/object/set-prototype-of"),m=r("es5-ext/string/#/contains"),p=r("d"),e=r("es6-symbol"),f=r("./"),u=Object.defineProperty;t=O.exports=function(s,l){if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");f.call(this,s),l=l?m.call(l,"key+value")?"key+value":m.call(l,"key")?"key":"value":"value",u(this,"__kind__",p("",l))},d&&d(t,f),delete t.prototype.constructor,t.prototype=Object.create(f.prototype,{_resolve:p(function(s){return this.__kind__==="value"?this.__list__[s]:this.__kind__==="key+value"?[s,this.__list__[s]]:s})}),u(t.prototype,e.toStringTag,p("c","Array Iterator"))},{"./":226,d:158,"es5-ext/object/set-prototype-of":212,"es5-ext/string/#/contains":218,"es6-symbol":230}],224:[function(r,O,B){var t=r("es5-ext/function/is-arguments"),d=r("es5-ext/object/valid-callable"),m=r("es5-ext/string/is-string"),p=r("./get"),e=Array.isArray,f=Function.prototype.call,u=Array.prototype.some;O.exports=function(s,l){var o,i,c,n,a,g,h,y,v=arguments[2];if(e(s)||t(s)?o="array":m(s)?o="string":s=p(s),d(l),c=function(){n=!0},o!=="array")if(o!=="string")for(i=s.next();!i.done;){if(f.call(l,v,i.value,c),n)return;i=s.next()}else for(g=s.length,a=0;a<g&&(h=s[a],a+1<g&&(y=h.charCodeAt(0))>=55296&&y<=56319&&(h+=s[++a]),f.call(l,v,h,c),!n);++a);else u.call(s,function(_){return f.call(l,v,_,c),n})}},{"./get":225,"es5-ext/function/is-arguments":190,"es5-ext/object/valid-callable":215,"es5-ext/string/is-string":221}],225:[function(r,O,B){var t=r("es5-ext/function/is-arguments"),d=r("es5-ext/string/is-string"),m=r("./array"),p=r("./string"),e=r("./valid-iterable"),f=r("es6-symbol").iterator;O.exports=function(u){return typeof e(u)[f]=="function"?u[f]():t(u)?new m(u):d(u)?new p(u):new m(u)}},{"./array":223,"./string":228,"./valid-iterable":229,"es5-ext/function/is-arguments":190,"es5-ext/string/is-string":221,"es6-symbol":230}],226:[function(r,O,B){var t,d=r("es5-ext/array/#/clear"),m=r("es5-ext/object/assign"),p=r("es5-ext/object/valid-callable"),e=r("es5-ext/object/valid-value"),f=r("d"),u=r("d/auto-bind"),s=r("es6-symbol"),l=Object.defineProperty,o=Object.defineProperties;O.exports=t=function(i,c){if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");o(this,{__list__:f("w",e(i)),__context__:f("w",c),__nextIndex__:f("w",0)}),c&&(p(c.on),c.on("_add",this._onAdd),c.on("_delete",this._onDelete),c.on("_clear",this._onClear))},delete t.prototype.constructor,o(t.prototype,m({_next:f(function(){var i;if(this.__list__)return this.__redo__&&(i=this.__redo__.shift())!==void 0?i:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:f(function(){return this._createResult(this._next())}),_createResult:f(function(i){return i===void 0?{done:!0,value:void 0}:{done:!1,value:this._resolve(i)}}),_resolve:f(function(i){return this.__list__[i]}),_unBind:f(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:f(function(){return"[object "+(this[s.toStringTag]||"Object")+"]"})},u({_onAdd:f(function(i){i>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(c,n){c>=i&&(this.__redo__[n]=++c)},this),this.__redo__.push(i)):l(this,"__redo__",f("c",[i])))}),_onDelete:f(function(i){var c;i>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&((c=this.__redo__.indexOf(i))!==-1&&this.__redo__.splice(c,1),this.__redo__.forEach(function(n,a){n>i&&(this.__redo__[a]=--n)},this)))}),_onClear:f(function(){this.__redo__&&d.call(this.__redo__),this.__nextIndex__=0})}))),l(t.prototype,s.iterator,f(function(){return this}))},{d:158,"d/auto-bind":157,"es5-ext/array/#/clear":186,"es5-ext/object/assign":199,"es5-ext/object/valid-callable":215,"es5-ext/object/valid-value":217,"es6-symbol":230}],227:[function(r,O,B){var t=r("es5-ext/function/is-arguments"),d=r("es5-ext/object/is-value"),m=r("es5-ext/string/is-string"),p=r("es6-symbol").iterator,e=Array.isArray;O.exports=function(f){return!!d(f)&&(!!e(f)||!!m(f)||!!t(f)||typeof f[p]=="function")}},{"es5-ext/function/is-arguments":190,"es5-ext/object/is-value":206,"es5-ext/string/is-string":221,"es6-symbol":230}],228:[function(r,O,B){var t,d=r("es5-ext/object/set-prototype-of"),m=r("d"),p=r("es6-symbol"),e=r("./"),f=Object.defineProperty;t=O.exports=function(u){if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");u=String(u),e.call(this,u),f(this,"__length__",m("",u.length))},d&&d(t,e),delete t.prototype.constructor,t.prototype=Object.create(e.prototype,{_next:m(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:m(function(u){var s,l=this.__list__[u];return this.__nextIndex__===this.__length__?l:(s=l.charCodeAt(0))>=55296&&s<=56319?l+this.__list__[this.__nextIndex__++]:l})}),f(t.prototype,p.toStringTag,m("c","String Iterator"))},{"./":226,d:158,"es5-ext/object/set-prototype-of":212,"es6-symbol":230}],229:[function(r,O,B){var t=r("./is-iterable");O.exports=function(d){if(!t(d))throw new TypeError(d+" is not iterable");return d}},{"./is-iterable":227}],230:[function(r,O,B){O.exports=r("./is-implemented")()?r("ext/global-this").Symbol:r("./polyfill")},{"./is-implemented":231,"./polyfill":236,"ext/global-this":243}],231:[function(r,O,B){var t=r("ext/global-this"),d={object:!0,symbol:!0};O.exports=function(){var m,p=t.Symbol;if(typeof p!="function")return!1;m=p("test symbol");try{String(m)}catch(e){return!1}return!!d[typeof p.iterator]&&!!d[typeof p.toPrimitive]&&!!d[typeof p.toStringTag]}},{"ext/global-this":243}],232:[function(r,O,B){O.exports=function(t){return!!t&&(typeof t=="symbol"||!!t.constructor&&t.constructor.name==="Symbol"&&t[t.constructor.toStringTag]==="Symbol")}},{}],233:[function(r,O,B){var t=r("d"),d=Object.create,m=Object.defineProperty,p=Object.prototype,e=d(null);O.exports=function(f){for(var u,s,l=0;e[f+(l||"")];)++l;return e[f+=l||""]=!0,m(p,u="@@"+f,t.gs(null,function(o){s||(s=!0,m(this,u,t(o)),s=!1)})),u}},{d:158}],234:[function(r,O,B){var t=r("d"),d=r("ext/global-this").Symbol;O.exports=function(m){return Object.defineProperties(m,{hasInstance:t("",d&&d.hasInstance||m("hasInstance")),isConcatSpreadable:t("",d&&d.isConcatSpreadable||m("isConcatSpreadable")),iterator:t("",d&&d.iterator||m("iterator")),match:t("",d&&d.match||m("match")),replace:t("",d&&d.replace||m("replace")),search:t("",d&&d.search||m("search")),species:t("",d&&d.species||m("species")),split:t("",d&&d.split||m("split")),toPrimitive:t("",d&&d.toPrimitive||m("toPrimitive")),toStringTag:t("",d&&d.toStringTag||m("toStringTag")),unscopables:t("",d&&d.unscopables||m("unscopables"))})}},{d:158,"ext/global-this":243}],235:[function(r,O,B){var t=r("d"),d=r("../../../validate-symbol"),m=Object.create(null);O.exports=function(p){return Object.defineProperties(p,{for:t(function(e){return m[e]?m[e]:m[e]=p(String(e))}),keyFor:t(function(e){var f;for(f in d(e),m)if(m[f]===e)return f})})}},{"../../../validate-symbol":237,d:158}],236:[function(r,O,B){var t,d,m,p=r("d"),e=r("./validate-symbol"),f=r("ext/global-this").Symbol,u=r("./lib/private/generate-name"),s=r("./lib/private/setup/standard-symbols"),l=r("./lib/private/setup/symbol-registry"),o=Object.create,i=Object.defineProperties,c=Object.defineProperty;if(typeof f=="function")try{String(f()),m=!0}catch(n){}else f=null;d=function(n){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return t(n)},O.exports=t=function n(a){var g;if(this instanceof n)throw new TypeError("Symbol is not a constructor");return m?f(a):(g=o(d.prototype),a=a===void 0?"":String(a),i(g,{__description__:p("",a),__name__:p("",u(a))}))},s(t),l(t),i(d.prototype,{constructor:p(t),toString:p("",function(){return this.__name__})}),i(t.prototype,{toString:p(function(){return"Symbol ("+e(this).__description__+")"}),valueOf:p(function(){return e(this)})}),c(t.prototype,t.toPrimitive,p("",function(){var n=e(this);return typeof n=="symbol"?n:n.toString()})),c(t.prototype,t.toStringTag,p("c","Symbol")),c(d.prototype,t.toStringTag,p("c",t.prototype[t.toStringTag])),c(d.prototype,t.toPrimitive,p("c",t.prototype[t.toPrimitive]))},{"./lib/private/generate-name":233,"./lib/private/setup/standard-symbols":234,"./lib/private/setup/symbol-registry":235,"./validate-symbol":237,d:158,"ext/global-this":243}],237:[function(r,O,B){var t=r("./is-symbol");O.exports=function(d){if(!t(d))throw new TypeError(d+" is not a symbol");return d}},{"./is-symbol":232}],238:[function(r,O,B){O.exports=r("./is-implemented")()?WeakMap:r("./polyfill")},{"./is-implemented":239,"./polyfill":241}],239:[function(r,O,B){O.exports=function(){var t,d;if(typeof WeakMap!="function")return!1;try{t=new WeakMap([[d={},"one"],[{},"two"],[{},"three"]])}catch(m){return!1}return String(t)==="[object WeakMap]"&&typeof t.set=="function"&&t.set({},1)===t&&typeof t.delete=="function"&&typeof t.has=="function"&&t.get(d)==="one"}},{}],240:[function(r,O,B){O.exports=typeof WeakMap=="function"&&Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"},{}],241:[function(r,O,B){var t,d=r("es5-ext/object/is-value"),m=r("es5-ext/object/set-prototype-of"),p=r("es5-ext/object/valid-object"),e=r("es5-ext/object/valid-value"),f=r("es5-ext/string/random-uniq"),u=r("d"),s=r("es6-iterator/get"),l=r("es6-iterator/for-of"),o=r("es6-symbol").toStringTag,i=r("./is-native-implemented"),c=Array.isArray,n=Object.defineProperty,a=Object.prototype.hasOwnProperty,g=Object.getPrototypeOf;O.exports=t=function(){var h,y=arguments[0];if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");return h=i&&m&&WeakMap!==t?m(new WeakMap,g(this)):this,d(y)&&(c(y)||(y=s(y))),n(h,"__weakMapData__",u("c","$weakMap$"+f())),y&&l(y,function(v){e(v),h.set(v[0],v[1])}),h},i&&(m&&m(t,WeakMap),t.prototype=Object.create(WeakMap.prototype,{constructor:u(t)})),Object.defineProperties(t.prototype,{delete:u(function(h){return!!a.call(p(h),this.__weakMapData__)&&(delete h[this.__weakMapData__],!0)}),get:u(function(h){if(a.call(p(h),this.__weakMapData__))return h[this.__weakMapData__]}),has:u(function(h){return a.call(p(h),this.__weakMapData__)}),set:u(function(h,y){return n(p(h),this.__weakMapData__,u("c",y)),this}),toString:u(function(){return"[object WeakMap]"})}),n(t.prototype,o,u("c","WeakMap"))},{"./is-native-implemented":240,d:158,"es5-ext/object/is-value":206,"es5-ext/object/set-prototype-of":212,"es5-ext/object/valid-object":216,"es5-ext/object/valid-value":217,"es5-ext/string/random-uniq":222,"es6-iterator/for-of":224,"es6-iterator/get":225,"es6-symbol":230}],242:[function(r,O,B){var t=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};O.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(d){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},{}],243:[function(r,O,B){O.exports=r("./is-implemented")()?globalThis:r("./implementation")},{"./implementation":242,"./is-implemented":244}],244:[function(r,O,B){O.exports=function(){return typeof globalThis=="object"&&!!globalThis&&globalThis.Array===Array}},{}],245:[function(r,O,B){O.exports=function(t,d,m){var p=d||0,e=m||1;return[[t[12]+t[0],t[13]+t[1],t[14]+t[2],t[15]+t[3]],[t[12]-t[0],t[13]-t[1],t[14]-t[2],t[15]-t[3]],[t[12]+t[4],t[13]+t[5],t[14]+t[6],t[15]+t[7]],[t[12]-t[4],t[13]-t[5],t[14]-t[6],t[15]-t[7]],[p*t[12]+t[8],p*t[13]+t[9],p*t[14]+t[10],p*t[15]+t[11]],[e*t[12]-t[8],e*t[13]-t[9],e*t[14]-t[10],e*t[15]-t[11]]]}},{}],246:[function(r,O,B){var t=r("is-string-blank");O.exports=function(d){var m=typeof d;if(m==="string"){var p=d;if((d=+d)==0&&t(p))return!1}else if(m!=="number")return!1;return d-d<1}},{"is-string-blank":448}],247:[function(r,O,B){O.exports=function(u,s,l){switch(arguments.length){case 0:return new p([0],[0],0);case 1:return typeof u=="number"?new p(o=f(u),o,0):new p(u,f(u.length),0);case 2:if(typeof s=="number"){var o=f(u.length);return new p(u,o,+s)}l=0;case 3:if(u.length!==s.length)throw new Error("state and velocity lengths must match");return new p(u,s,l)}};var t=r("cubic-hermite"),d=r("binary-search-bounds");function m(u,s,l){return Math.min(s,Math.max(u,l))}function p(u,s,l){this.dimension=u.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var o=0;o<this.dimension;++o)this.bounds[0][o]=-1/0,this.bounds[1][o]=1/0;this._state=u.slice().reverse(),this._velocity=s.slice().reverse(),this._time=[l],this._scratch=[u.slice(),u.slice(),u.slice(),u.slice(),u.slice()]}var e=p.prototype;function f(u){for(var s=new Array(u),l=0;l<u;++l)s[l]=0;return s}e.flush=function(u){var s=d.gt(this._time,u)-1;s<=0||(this._time.splice(0,s),this._state.splice(0,s*this.dimension),this._velocity.splice(0,s*this.dimension))},e.curve=function(u){var s=this._time,l=s.length,o=d.le(s,u),i=this._scratch[0],c=this._state,n=this._velocity,a=this.dimension,g=this.bounds;if(o<0)for(var h=a-1,y=0;y<a;++y,--h)i[y]=c[h];else if(o>=l-1){h=c.length-1;var v=u-s[l-1];for(y=0;y<a;++y,--h)i[y]=c[h]+v*n[h]}else{h=a*(o+1)-1;var _=s[o],x=s[o+1]-_||1,T=this._scratch[1],A=this._scratch[2],S=this._scratch[3],w=this._scratch[4],C=!0;for(y=0;y<a;++y,--h)T[y]=c[h],S[y]=n[h]*x,A[y]=c[h+a],w[y]=n[h+a]*x,C=C&&T[y]===A[y]&&S[y]===w[y]&&S[y]===0;if(C)for(y=0;y<a;++y)i[y]=T[y];else t(T,S,A,w,(u-_)/x,i)}var k=g[0],L=g[1];for(y=0;y<a;++y)i[y]=m(k[y],L[y],i[y]);return i},e.dcurve=function(u){var s=this._time,l=s.length,o=d.le(s,u),i=this._scratch[0],c=this._state,n=this._velocity,a=this.dimension;if(o>=l-1)for(var g=c.length-1,h=(s[l-1],0);h<a;++h,--g)i[h]=n[g];else{g=a*(o+1)-1;var y=s[o],v=s[o+1]-y||1,_=this._scratch[1],x=this._scratch[2],T=this._scratch[3],A=this._scratch[4],S=!0;for(h=0;h<a;++h,--g)_[h]=c[g],T[h]=n[g]*v,x[h]=c[g+a],A[h]=n[g+a]*v,S=S&&_[h]===x[h]&&T[h]===A[h]&&T[h]===0;if(S)for(h=0;h<a;++h)i[h]=0;else for(t.derivative(_,T,x,A,(u-y)/v,i),h=0;h<a;++h)i[h]/=v}return i},e.lastT=function(){var u=this._time;return u[u.length-1]},e.stable=function(){for(var u=this._velocity,s=u.length,l=this.dimension-1;l>=0;--l)if(u[--s])return!1;return!0},e.jump=function(u){var s=this.lastT(),l=this.dimension;if(!(u<s||arguments.length!==l+1)){var o=this._state,i=this._velocity,c=o.length-this.dimension,n=this.bounds,a=n[0],g=n[1];this._time.push(s,u);for(var h=0;h<2;++h)for(var y=0;y<l;++y)o.push(o[c++]),i.push(0);for(this._time.push(u),y=l;y>0;--y)o.push(m(a[y-1],g[y-1],arguments[y])),i.push(0)}},e.push=function(u){var s=this.lastT(),l=this.dimension;if(!(u<s||arguments.length!==l+1)){var o=this._state,i=this._velocity,c=o.length-this.dimension,n=u-s,a=this.bounds,g=a[0],h=a[1],y=n>1e-6?1/n:0;this._time.push(u);for(var v=l;v>0;--v){var _=m(g[v-1],h[v-1],arguments[v]);o.push(_),i.push((_-o[c++])*y)}}},e.set=function(u){var s=this.dimension;if(!(u<this.lastT()||arguments.length!==s+1)){var l=this._state,o=this._velocity,i=this.bounds,c=i[0],n=i[1];this._time.push(u);for(var a=s;a>0;--a)l.push(m(c[a-1],n[a-1],arguments[a])),o.push(0)}},e.move=function(u){var s=this.lastT(),l=this.dimension;if(!(u<=s||arguments.length!==l+1)){var o=this._state,i=this._velocity,c=o.length-this.dimension,n=this.bounds,a=n[0],g=n[1],h=u-s,y=h>1e-6?1/h:0;this._time.push(u);for(var v=l;v>0;--v){var _=arguments[v];o.push(m(a[v-1],g[v-1],o[c++]+_)),i.push(_*y)}}},e.idle=function(u){var s=this.lastT();if(!(u<s)){var l=this.dimension,o=this._state,i=this._velocity,c=o.length-l,n=this.bounds,a=n[0],g=n[1],h=u-s;this._time.push(u);for(var y=l-1;y>=0;--y)o.push(m(a[y],g[y],o[c]+h*i[c])),i.push(0),c+=1}}},{"binary-search-bounds":103,"cubic-hermite":156}],248:[function(r,O,B){var t=r("dtype");O.exports=function(d,m,p){if(!d)throw new TypeError("must specify data as first parameter");if(p=0|+(p||0),Array.isArray(d)&&d[0]&&typeof d[0][0]=="number"){var e,f,u,s,l=d[0].length,o=d.length*l;m&&typeof m!="string"||(m=new(t(m||"float32"))(o+p));var i=m.length-p;if(o!==i)throw new Error("source length "+o+" ("+l+"x"+d.length+") does not match destination length "+i);for(e=0,u=p;e<d.length;e++)for(f=0;f<l;f++)m[u++]=d[e][f]===null?NaN:d[e][f]}else if(m&&typeof m!="string")m.set(d,p);else{var c=t(m||"float32");if(Array.isArray(d)||m==="array")for(m=new c(d.length+p),e=0,u=p,s=m.length;u<s;u++,e++)m[u]=d[e]===null?NaN:d[e];else p===0?m=new c(d):(m=new c(d.length+p)).set(d,p)}return m}},{dtype:181}],249:[function(r,O,B){var t=r("css-font/stringify"),d=[32,126];O.exports=function(m){var p=(m=m||{}).shape?m.shape:m.canvas?[m.canvas.width,m.canvas.height]:[512,512],e=m.canvas||document.createElement("canvas"),f=m.font,u=typeof m.step=="number"?[m.step,m.step]:m.step||[32,32],s=m.chars||d;if(f&&typeof f!="string"&&(f=t(f)),Array.isArray(s)){if(s.length===2&&typeof s[0]=="number"&&typeof s[1]=="number"){for(var l=[],o=s[0],i=0;o<=s[1];o++)l[i++]=String.fromCharCode(o);s=l}}else s=String(s).split("");p=p.slice(),e.width=p[0],e.height=p[1];var c=e.getContext("2d");c.fillStyle="#000",c.fillRect(0,0,e.width,e.height),c.font=f,c.textAlign="center",c.textBaseline="middle",c.fillStyle="#fff";var n=u[0]/2,a=u[1]/2;for(o=0;o<s.length;o++)c.fillText(s[o],n,a),(n+=u[0])>p[0]-u[0]/2&&(n=u[0]/2,a+=u[1]);return e}},{"css-font/stringify":153}],250:[function(r,O,B){function t(e,f){f||(f={}),(typeof e=="string"||Array.isArray(e))&&(f.family=e);var u=Array.isArray(f.family)?f.family.join(", "):f.family;if(!u)throw Error("`family` must be defined");var s=f.size||f.fontSize||f.em||48,l=f.weight||f.fontWeight||"",o=(e=[f.style||f.fontStyle||"",l,s].join(" ")+"px "+u,f.origin||"top");if(t.cache[u]&&s<=t.cache[u].em)return d(t.cache[u],o);var i=f.canvas||t.canvas,c=i.getContext("2d"),n={upper:f.upper!==void 0?f.upper:"H",lower:f.lower!==void 0?f.lower:"x",descent:f.descent!==void 0?f.descent:"p",ascent:f.ascent!==void 0?f.ascent:"h",tittle:f.tittle!==void 0?f.tittle:"i",overshoot:f.overshoot!==void 0?f.overshoot:"O"},a=Math.ceil(1.5*s);i.height=a,i.width=.5*a,c.font=e;var g={top:0};c.clearRect(0,0,a,a),c.textBaseline="top",c.fillStyle="black",c.fillText("H",0,0);var h=m(c.getImageData(0,0,a,a));c.clearRect(0,0,a,a),c.textBaseline="bottom",c.fillText("H",0,a);var y=m(c.getImageData(0,0,a,a));g.lineHeight=g.bottom=a-y+h,c.clearRect(0,0,a,a),c.textBaseline="alphabetic",c.fillText("H",0,a);var v=a-m(c.getImageData(0,0,a,a))-1+h;g.baseline=g.alphabetic=v,c.clearRect(0,0,a,a),c.textBaseline="middle",c.fillText("H",0,.5*a);var _=m(c.getImageData(0,0,a,a));g.median=g.middle=a-_-1+h-.5*a,c.clearRect(0,0,a,a),c.textBaseline="hanging",c.fillText("H",0,.5*a);var x=m(c.getImageData(0,0,a,a));g.hanging=a-x-1+h-.5*a,c.clearRect(0,0,a,a),c.textBaseline="ideographic",c.fillText("H",0,a);var T=m(c.getImageData(0,0,a,a));if(g.ideographic=a-T-1+h,n.upper&&(c.clearRect(0,0,a,a),c.textBaseline="top",c.fillText(n.upper,0,0),g.upper=m(c.getImageData(0,0,a,a)),g.capHeight=g.baseline-g.upper),n.lower&&(c.clearRect(0,0,a,a),c.textBaseline="top",c.fillText(n.lower,0,0),g.lower=m(c.getImageData(0,0,a,a)),g.xHeight=g.baseline-g.lower),n.tittle&&(c.clearRect(0,0,a,a),c.textBaseline="top",c.fillText(n.tittle,0,0),g.tittle=m(c.getImageData(0,0,a,a))),n.ascent&&(c.clearRect(0,0,a,a),c.textBaseline="top",c.fillText(n.ascent,0,0),g.ascent=m(c.getImageData(0,0,a,a))),n.descent&&(c.clearRect(0,0,a,a),c.textBaseline="top",c.fillText(n.descent,0,0),g.descent=p(c.getImageData(0,0,a,a))),n.overshoot){c.clearRect(0,0,a,a),c.textBaseline="top",c.fillText(n.overshoot,0,0);var A=p(c.getImageData(0,0,a,a));g.overshoot=A-v}for(var S in g)g[S]/=s;return g.em=s,t.cache[u]=g,d(g,o)}function d(e,f){var u={};for(var s in typeof f=="string"&&(f=e[f]),e)s!=="em"&&(u[s]=e[s]-f);return u}function m(e){for(var f=e.height,u=e.data,s=3;s<u.length;s+=4)if(u[s]!==0)return Math.floor(.25*(s-3)/f)}function p(e){for(var f=e.height,u=e.data,s=u.length-1;s>0;s-=4)if(u[s]!==0)return Math.floor(.25*(s-3)/f)}O.exports=t,t.canvas=document.createElement("canvas"),t.cache={}},{}],251:[function(r,O,B){O.exports=function(a){return new e(a||n,null)};function t(a,g,h,y,v,_){this._color=a,this.key=g,this.value=h,this.left=y,this.right=v,this._count=_}function d(a){return new t(a._color,a.key,a.value,a.left,a.right,a._count)}function m(a,g){return new t(a,g.key,g.value,g.left,g.right,g._count)}function p(a){a._count=1+(a.left?a.left._count:0)+(a.right?a.right._count:0)}function e(a,g){this._compare=a,this.root=g}var f=e.prototype;function u(a,g){var h;return g.left&&(h=u(a,g.left))?h:(h=a(g.key,g.value))||(g.right?u(a,g.right):void 0)}function s(a,g,h,y){if(g(a,y.key)<=0){var v;if(y.left&&(v=s(a,g,h,y.left))||(v=h(y.key,y.value)))return v}if(y.right)return s(a,g,h,y.right)}function l(a,g,h,y,v){var _,x=h(a,v.key),T=h(g,v.key);if(x<=0&&(v.left&&(_=l(a,g,h,y,v.left))||T>0&&(_=y(v.key,v.value))))return _;if(T>0&&v.right)return l(a,g,h,y,v.right)}function o(a,g){this.tree=a,this._stack=g}Object.defineProperty(f,"keys",{get:function(){var a=[];return this.forEach(function(g,h){a.push(g)}),a}}),Object.defineProperty(f,"values",{get:function(){var a=[];return this.forEach(function(g,h){a.push(h)}),a}}),Object.defineProperty(f,"length",{get:function(){return this.root?this.root._count:0}}),f.insert=function(a,g){for(var h=this._compare,y=this.root,v=[],_=[];y;){var x=h(a,y.key);v.push(y),_.push(x),y=x<=0?y.left:y.right}v.push(new t(0,a,g,null,null,1));for(var T=v.length-2;T>=0;--T)y=v[T],_[T]<=0?v[T]=new t(y._color,y.key,y.value,v[T+1],y.right,y._count+1):v[T]=new t(y._color,y.key,y.value,y.left,v[T+1],y._count+1);for(T=v.length-1;T>1;--T){var A=v[T-1];if(y=v[T],A._color===1||y._color===1)break;var S=v[T-2];if(S.left===A)if(A.left===y){if(!(w=S.right)||w._color!==0){S._color=0,S.left=A.right,A._color=1,A.right=S,v[T-2]=A,v[T-1]=y,p(S),p(A),T>=3&&((C=v[T-3]).left===S?C.left=A:C.right=A);break}A._color=1,S.right=m(1,w),S._color=0,T-=1}else{if(!(w=S.right)||w._color!==0){A.right=y.left,S._color=0,S.left=y.right,y._color=1,y.left=A,y.right=S,v[T-2]=y,v[T-1]=A,p(S),p(A),p(y),T>=3&&((C=v[T-3]).left===S?C.left=y:C.right=y);break}A._color=1,S.right=m(1,w),S._color=0,T-=1}else if(A.right===y){if(!(w=S.left)||w._color!==0){S._color=0,S.right=A.left,A._color=1,A.left=S,v[T-2]=A,v[T-1]=y,p(S),p(A),T>=3&&((C=v[T-3]).right===S?C.right=A:C.left=A);break}A._color=1,S.left=m(1,w),S._color=0,T-=1}else{var w;if(!(w=S.left)||w._color!==0){var C;A.left=y.right,S._color=0,S.right=y.left,y._color=1,y.right=A,y.left=S,v[T-2]=y,v[T-1]=A,p(S),p(A),p(y),T>=3&&((C=v[T-3]).right===S?C.right=y:C.left=y);break}A._color=1,S.left=m(1,w),S._color=0,T-=1}}return v[0]._color=1,new e(h,v[0])},f.forEach=function(a,g,h){if(this.root)switch(arguments.length){case 1:return u(a,this.root);case 2:return s(g,this._compare,a,this.root);case 3:return this._compare(g,h)>=0?void 0:l(g,h,this._compare,a,this.root)}},Object.defineProperty(f,"begin",{get:function(){for(var a=[],g=this.root;g;)a.push(g),g=g.left;return new o(this,a)}}),Object.defineProperty(f,"end",{get:function(){for(var a=[],g=this.root;g;)a.push(g),g=g.right;return new o(this,a)}}),f.at=function(a){if(a<0)return new o(this,[]);for(var g=this.root,h=[];;){if(h.push(g),g.left){if(a<g.left._count){g=g.left;continue}a-=g.left._count}if(!a)return new o(this,h);if(a-=1,!g.right||a>=g.right._count)break;g=g.right}return new o(this,[])},f.ge=function(a){for(var g=this._compare,h=this.root,y=[],v=0;h;){var _=g(a,h.key);y.push(h),_<=0&&(v=y.length),h=_<=0?h.left:h.right}return y.length=v,new o(this,y)},f.gt=function(a){for(var g=this._compare,h=this.root,y=[],v=0;h;){var _=g(a,h.key);y.push(h),_<0&&(v=y.length),h=_<0?h.left:h.right}return y.length=v,new o(this,y)},f.lt=function(a){for(var g=this._compare,h=this.root,y=[],v=0;h;){var _=g(a,h.key);y.push(h),_>0&&(v=y.length),h=_<=0?h.left:h.right}return y.length=v,new o(this,y)},f.le=function(a){for(var g=this._compare,h=this.root,y=[],v=0;h;){var _=g(a,h.key);y.push(h),_>=0&&(v=y.length),h=_<0?h.left:h.right}return y.length=v,new o(this,y)},f.find=function(a){for(var g=this._compare,h=this.root,y=[];h;){var v=g(a,h.key);if(y.push(h),v===0)return new o(this,y);h=v<=0?h.left:h.right}return new o(this,[])},f.remove=function(a){var g=this.find(a);return g?g.remove():this},f.get=function(a){for(var g=this._compare,h=this.root;h;){var y=g(a,h.key);if(y===0)return h.value;h=y<=0?h.left:h.right}};var i=o.prototype;function c(a,g){a.key=g.key,a.value=g.value,a.left=g.left,a.right=g.right,a._color=g._color,a._count=g._count}function n(a,g){return a<g?-1:a>g?1:0}Object.defineProperty(i,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(i,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),i.clone=function(){return new o(this.tree,this._stack.slice())},i.remove=function(){var a=this._stack;if(a.length===0)return this.tree;var g=new Array(a.length),h=a[a.length-1];g[g.length-1]=new t(h._color,h.key,h.value,h.left,h.right,h._count);for(var y=a.length-2;y>=0;--y)(h=a[y]).left===a[y+1]?g[y]=new t(h._color,h.key,h.value,g[y+1],h.right,h._count):g[y]=new t(h._color,h.key,h.value,h.left,g[y+1],h._count);if((h=g[g.length-1]).left&&h.right){var v=g.length;for(h=h.left;h.right;)g.push(h),h=h.right;var _=g[v-1];for(g.push(new t(h._color,_.key,_.value,h.left,h.right,h._count)),g[v-1].key=h.key,g[v-1].value=h.value,y=g.length-2;y>=v;--y)h=g[y],g[y]=new t(h._color,h.key,h.value,h.left,g[y+1],h._count);g[v-1].left=g[v]}if((h=g[g.length-1])._color===0){var x=g[g.length-2];for(x.left===h?x.left=null:x.right===h&&(x.right=null),g.pop(),y=0;y<g.length;++y)g[y]._count--;return new e(this.tree._compare,g[0])}if(h.left||h.right){for(h.left?c(h,h.left):h.right&&c(h,h.right),h._color=1,y=0;y<g.length-1;++y)g[y]._count--;return new e(this.tree._compare,g[0])}if(g.length===1)return new e(this.tree._compare,null);for(y=0;y<g.length;++y)g[y]._count--;var T=g[g.length-2];return function(A){for(var S,w,C,k,L=A.length-1;L>=0;--L){if(S=A[L],L===0)return void(S._color=1);if((w=A[L-1]).left===S){if((C=w.right).right&&C.right._color===0)return k=(C=w.right=d(C)).right=d(C.right),w.right=C.left,C.left=w,C.right=k,C._color=w._color,S._color=1,w._color=1,k._color=1,p(w),p(C),L>1&&((M=A[L-2]).left===w?M.left=C:M.right=C),void(A[L-1]=C);if(C.left&&C.left._color===0)return k=(C=w.right=d(C)).left=d(C.left),w.right=k.left,C.left=k.right,k.left=w,k.right=C,k._color=w._color,w._color=1,C._color=1,S._color=1,p(w),p(C),p(k),L>1&&((M=A[L-2]).left===w?M.left=k:M.right=k),void(A[L-1]=k);if(C._color===1){if(w._color===0)return w._color=1,void(w.right=m(0,C));w.right=m(0,C);continue}C=d(C),w.right=C.left,C.left=w,C._color=w._color,w._color=0,p(w),p(C),L>1&&((M=A[L-2]).left===w?M.left=C:M.right=C),A[L-1]=C,A[L]=w,L+1<A.length?A[L+1]=S:A.push(S),L+=2}else{if((C=w.left).left&&C.left._color===0)return k=(C=w.left=d(C)).left=d(C.left),w.left=C.right,C.right=w,C.left=k,C._color=w._color,S._color=1,w._color=1,k._color=1,p(w),p(C),L>1&&((M=A[L-2]).right===w?M.right=C:M.left=C),void(A[L-1]=C);if(C.right&&C.right._color===0)return k=(C=w.left=d(C)).right=d(C.right),w.left=k.right,C.right=k.left,k.right=w,k.left=C,k._color=w._color,w._color=1,C._color=1,S._color=1,p(w),p(C),p(k),L>1&&((M=A[L-2]).right===w?M.right=k:M.left=k),void(A[L-1]=k);if(C._color===1){if(w._color===0)return w._color=1,void(w.left=m(0,C));w.left=m(0,C);continue}var M;C=d(C),w.left=C.right,C.right=w,C._color=w._color,w._color=0,p(w),p(C),L>1&&((M=A[L-2]).right===w?M.right=C:M.left=C),A[L-1]=C,A[L]=w,L+1<A.length?A[L+1]=S:A.push(S),L+=2}}}(g),T.left===h?T.left=null:T.right=null,new e(this.tree._compare,g[0])},Object.defineProperty(i,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(i,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(i,"index",{get:function(){var a=0,g=this._stack;if(g.length===0){var h=this.tree.root;return h?h._count:0}g[g.length-1].left&&(a=g[g.length-1].left._count);for(var y=g.length-2;y>=0;--y)g[y+1]===g[y].right&&(++a,g[y].left&&(a+=g[y].left._count));return a},enumerable:!0}),i.next=function(){var a=this._stack;if(a.length!==0){var g=a[a.length-1];if(g.right)for(g=g.right;g;)a.push(g),g=g.left;else for(a.pop();a.length>0&&a[a.length-1].right===g;)g=a[a.length-1],a.pop()}},Object.defineProperty(i,"hasNext",{get:function(){var a=this._stack;if(a.length===0)return!1;if(a[a.length-1].right)return!0;for(var g=a.length-1;g>0;--g)if(a[g-1].left===a[g])return!0;return!1}}),i.update=function(a){var g=this._stack;if(g.length===0)throw new Error("Can't update empty node!");var h=new Array(g.length),y=g[g.length-1];h[h.length-1]=new t(y._color,y.key,a,y.left,y.right,y._count);for(var v=g.length-2;v>=0;--v)(y=g[v]).left===g[v+1]?h[v]=new t(y._color,y.key,y.value,h[v+1],y.right,y._count):h[v]=new t(y._color,y.key,y.value,y.left,h[v+1],y._count);return new e(this.tree._compare,h[0])},i.prev=function(){var a=this._stack;if(a.length!==0){var g=a[a.length-1];if(g.left)for(g=g.left;g;)a.push(g),g=g.right;else for(a.pop();a.length>0&&a[a.length-1].left===g;)g=a[a.length-1],a.pop()}},Object.defineProperty(i,"hasPrev",{get:function(){var a=this._stack;if(a.length===0)return!1;if(a[a.length-1].left)return!0;for(var g=a.length-1;g>0;--g)if(a[g-1].right===a[g])return!0;return!1}})},{}],252:[function(r,O,B){O.exports=function(t,d){if(typeof t!="string")throw new TypeError("must specify type string");if(d=d||{},typeof document=="undefined"&&!d.canvas)return null;var m=d.canvas||document.createElement("canvas");typeof d.width=="number"&&(m.width=d.width),typeof d.height=="number"&&(m.height=d.height);var p,e=d;try{var f=[t];t.indexOf("webgl")===0&&f.push("experimental-"+t);for(var u=0;u<f.length;u++)if(p=m.getContext(f[u],e))return p}catch(s){p=null}return p||null}},{}],253:[function(r,O,B){O.exports=function(v,_){var x=new s(v);return x.update(_),x};var t=r("./lib/text.js"),d=r("./lib/lines.js"),m=r("./lib/background.js"),p=r("./lib/cube.js"),e=r("./lib/ticks.js"),f=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function u(v,_){return v[0]=_[0],v[1]=_[1],v[2]=_[2],v}function s(v){this.gl=v,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=m(v)}var l=s.prototype;function o(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}l.update=function(v){function _(N,U,q){if(q in v){var X,K=v[q],Z=this[q];(N?Array.isArray(K)&&Array.isArray(K[0]):Array.isArray(K))?this[q]=X=[U(K[0]),U(K[1]),U(K[2])]:this[q]=X=[U(K),U(K),U(K)];for(var H=0;H<3;++H)if(X[H]!==Z[H])return!0}return!1}v=v||{};var x,T=_.bind(this,!1,Number),A=_.bind(this,!1,Boolean),S=_.bind(this,!1,String),w=_.bind(this,!0,function(N){if(Array.isArray(N)){if(N.length===3)return[+N[0],+N[1],+N[2],1];if(N.length===4)return[+N[0],+N[1],+N[2],+N[3]]}return[0,0,0,1]}),C=!1,k=!1;if("bounds"in v)for(var L=v.bounds,M=0;M<2;++M)for(var P=0;P<3;++P)L[M][P]!==this.bounds[M][P]&&(k=!0),this.bounds[M][P]=L[M][P];if("ticks"in v)for(x=v.ticks,C=!0,this.autoTicks=!1,M=0;M<3;++M)this.tickSpacing[M]=0;else T("tickSpacing")&&(this.autoTicks=!0,k=!0);if(this._firstInit&&("ticks"in v||"tickSpacing"in v||(this.autoTicks=!0),k=!0,C=!0,this._firstInit=!1),k&&this.autoTicks&&(x=e.create(this.bounds,this.tickSpacing),C=!0),C){for(M=0;M<3;++M)x[M].sort(function(N,U){return N.x-U.x});e.equal(x,this.ticks)?C=!1:this.ticks=x}A("tickEnable"),S("tickFont")&&(C=!0),T("tickSize"),T("tickAngle"),T("tickPad"),w("tickColor");var D=S("labels");S("labelFont")&&(D=!0),A("labelEnable"),T("labelSize"),T("labelPad"),w("labelColor"),A("lineEnable"),A("lineMirror"),T("lineWidth"),w("lineColor"),A("lineTickEnable"),A("lineTickMirror"),T("lineTickLength"),T("lineTickWidth"),w("lineTickColor"),A("gridEnable"),T("gridWidth"),w("gridColor"),A("zeroEnable"),w("zeroLineColor"),T("zeroLineWidth"),A("backgroundEnable"),w("backgroundColor"),this._text?this._text&&(D||C)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=t(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&C&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=d(this.gl,this.bounds,this.ticks))};var i=[new o,new o,new o];function c(v,_,x,T,A){for(var S=v.primalOffset,w=v.primalMinor,C=v.mirrorOffset,k=v.mirrorMinor,L=T[_],M=0;M<3;++M)if(_!==M){var P=S,D=C,N=w,U=k;L&1<<M&&(P=C,D=S,N=k,U=w),P[M]=x[0][M],D[M]=x[1][M],A[M]>0?(N[M]=-1,U[M]=0):(N[M]=0,U[M]=1)}}var n=[0,0,0],a={model:f,view:f,projection:f,_ortho:!1};l.isOpaque=function(){return!0},l.isTransparent=function(){return!1},l.drawTransparent=function(v){};var g=[0,0,0],h=[0,0,0],y=[0,0,0];l.draw=function(v){v=v||a;for(var _=this.gl,x=v.model||f,T=v.view||f,A=v.projection||f,S=this.bounds,w=v._ortho||!1,C=p(x,T,A,S,w),k=C.cubeEdges,L=C.axis,M=T[12],P=T[13],D=T[14],N=T[15],U=(w?2:1)*this.pixelRatio*(A[3]*M+A[7]*P+A[11]*D+A[15]*N)/_.drawingBufferHeight,q=0;q<3;++q)this.lastCubeProps.cubeEdges[q]=k[q],this.lastCubeProps.axis[q]=L[q];var X=i;for(q=0;q<3;++q)c(i[q],q,this.bounds,k,L);_=this.gl;var K,Z=n;for(q=0;q<3;++q)this.backgroundEnable[q]?Z[q]=L[q]:Z[q]=0;for(this._background.draw(x,T,A,S,Z,this.backgroundColor),this._lines.bind(x,T,A,this),q=0;q<3;++q){var H=[0,0,0];L[q]>0?H[q]=S[1][q]:H[q]=S[0][q];for(var Y=0;Y<2;++Y){var $=(q+1+Y)%3,z=(q+1+(1^Y))%3;this.gridEnable[$]&&this._lines.drawGrid($,z,this.bounds,H,this.gridColor[$],this.gridWidth[$]*this.pixelRatio)}for(Y=0;Y<2;++Y)$=(q+1+Y)%3,z=(q+1+(1^Y))%3,this.zeroEnable[z]&&Math.min(S[0][z],S[1][z])<=0&&Math.max(S[0][z],S[1][z])>=0&&this._lines.drawZero($,z,this.bounds,H,this.zeroLineColor[z],this.zeroLineWidth[z]*this.pixelRatio)}for(q=0;q<3;++q){this.lineEnable[q]&&this._lines.drawAxisLine(q,this.bounds,X[q].primalOffset,this.lineColor[q],this.lineWidth[q]*this.pixelRatio),this.lineMirror[q]&&this._lines.drawAxisLine(q,this.bounds,X[q].mirrorOffset,this.lineColor[q],this.lineWidth[q]*this.pixelRatio);var j=u(g,X[q].primalMinor),W=u(h,X[q].mirrorMinor),ee=this.lineTickLength;for(Y=0;Y<3;++Y){var J=U/x[5*Y];j[Y]*=ee[Y]*J,W[Y]*=ee[Y]*J}this.lineTickEnable[q]&&this._lines.drawAxisTicks(q,X[q].primalOffset,j,this.lineTickColor[q],this.lineTickWidth[q]*this.pixelRatio),this.lineTickMirror[q]&&this._lines.drawAxisTicks(q,X[q].mirrorOffset,W,this.lineTickColor[q],this.lineTickWidth[q]*this.pixelRatio)}this._lines.unbind(),this._text.bind(x,T,A,this.pixelRatio);var Q,te;function ie(ve){(te=[0,0,0])[ve]=1}function ae(ve,ke,Ee){var be=(ve+1)%3,xe=(ve+2)%3,ce=ke[be],ge=ke[xe],we=Ee[be],Me=Ee[xe];ce>0&&Me>0||ce>0&&Me<0||ce<0&&Me>0||ce<0&&Me<0?ie(be):(ge>0&&we>0||ge>0&&we<0||ge<0&&we>0||ge<0&&we<0)&&ie(xe)}for(q=0;q<3;++q){var he=X[q].primalMinor,se=X[q].mirrorMinor,de=u(y,X[q].primalOffset);for(Y=0;Y<3;++Y)this.lineTickEnable[q]&&(de[Y]+=U*he[Y]*Math.max(this.lineTickLength[Y],0)/x[5*Y]);var ue=[0,0,0];if(ue[q]=1,this.tickEnable[q]){for(this.tickAngle[q]===-3600?(this.tickAngle[q]=0,this.tickAlign[q]="auto"):this.tickAlign[q]=-1,Q=1,(K=[this.tickAlign[q],.5,Q])[0]==="auto"?K[0]=0:K[0]=parseInt(""+K[0]),te=[0,0,0],ae(q,he,se),Y=0;Y<3;++Y)de[Y]+=U*he[Y]*this.tickPad[Y]/x[5*Y];this._text.drawTicks(q,this.tickSize[q],this.tickAngle[q],de,this.tickColor[q],ue,te,K)}if(this.labelEnable[q]){for(Q=0,te=[0,0,0],this.labels[q].length>4&&(ie(q),Q=1),(K=[this.labelAlign[q],.5,Q])[0]==="auto"?K[0]=0:K[0]=parseInt(""+K[0]),Y=0;Y<3;++Y)de[Y]+=U*he[Y]*this.labelPad[Y]/x[5*Y];de[q]+=.5*(S[0][q]+S[1][q]),this._text.drawLabel(q,this.labelSize[q],this.labelAngle[q],de,this.labelColor[q],[0,0,0],te,K)}}this._text.unbind()},l.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":254,"./lib/cube.js":255,"./lib/lines.js":256,"./lib/text.js":258,"./lib/ticks.js":259}],254:[function(r,O,B){O.exports=function(f){for(var u=[],s=[],l=0,o=0;o<3;++o)for(var i=(o+1)%3,c=(o+2)%3,n=[0,0,0],a=[0,0,0],g=-1;g<=1;g+=2){s.push(l,l+2,l+1,l+1,l+2,l+3),n[o]=g,a[o]=g;for(var h=-1;h<=1;h+=2){n[i]=h;for(var y=-1;y<=1;y+=2)n[c]=y,u.push(n[0],n[1],n[2],a[0],a[1],a[2]),l+=1}var v=i;i=c,c=v}var _=t(f,new Float32Array(u)),x=t(f,new Uint16Array(s),f.ELEMENT_ARRAY_BUFFER),T=d(f,[{buffer:_,type:f.FLOAT,size:3,offset:0,stride:24},{buffer:_,type:f.FLOAT,size:3,offset:12,stride:24}],x),A=m(f);return A.attributes.position.location=0,A.attributes.normal.location=1,new p(f,_,T,A)};var t=r("gl-buffer"),d=r("gl-vao"),m=r("./shaders").bg;function p(f,u,s,l){this.gl=f,this.buffer=u,this.vao=s,this.shader=l}var e=p.prototype;e.draw=function(f,u,s,l,o,i){for(var c=!1,n=0;n<3;++n)c=c||o[n];if(c){var a=this.gl;a.enable(a.POLYGON_OFFSET_FILL),a.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:f,view:u,projection:s,bounds:l,enable:o,colors:i},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),a.disable(a.POLYGON_OFFSET_FILL)}},e.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":257,"gl-buffer":261,"gl-vao":353}],255:[function(r,O,B){O.exports=function(h,y,v,_,x){d(e,y,h),d(e,v,e);for(var T=0,A=0;A<2;++A){s[2]=_[A][2];for(var S=0;S<2;++S){s[1]=_[S][1];for(var w=0;w<2;++w)s[0]=_[w][0],o(f[T],s,e),T+=1}}var C=-1;for(A=0;A<8;++A){for(var k=f[A][3],L=0;L<3;++L)u[A][L]=f[A][L]/k;x&&(u[A][2]*=-1),k<0&&(C<0||u[A][2]<u[C][2])&&(C=A)}if(C<0){C=0;for(var M=0;M<3;++M){for(var P=(M+2)%3,D=(M+1)%3,N=-1,U=-1,q=0;q<2;++q){var X=(Z=q<<M)+(q<<P)+(1-q<<D),K=Z+(1-q<<P)+(q<<D);p(u[Z],u[X],u[K],l)<0||(q?N=1:U=1)}if(N<0||U<0)U>N&&(C|=1<<M);else{for(q=0;q<2;++q){X=(Z=q<<M)+(q<<P)+(1-q<<D),K=Z+(1-q<<P)+(q<<D);var Z,H=c([f[Z],f[X],f[K],f[Z+(1<<P)+(1<<D)]]);q?N=H:U=H}U>N&&(C|=1<<M)}}}var Y=7^C,$=-1;for(A=0;A<8;++A)A!==C&&A!==Y&&($<0||u[$][1]>u[A][1])&&($=A);var z=-1;for(A=0;A<3;++A)(W=$^1<<A)!==C&&W!==Y&&(z<0&&(z=W),(D=u[W])[0]<u[z][0]&&(z=W));var j=-1;for(A=0;A<3;++A){var W;(W=$^1<<A)!==C&&W!==Y&&W!==z&&(j<0&&(j=W),(D=u[W])[0]>u[j][0]&&(j=W))}var ee=n;ee[0]=ee[1]=ee[2]=0,ee[t.log2(z^$)]=$&z,ee[t.log2($^j)]=$&j;var J=7^j;J===C||J===Y?(J=7^z,ee[t.log2(j^J)]=J&j):ee[t.log2(z^J)]=J&z;var Q=a,te=C;for(M=0;M<3;++M)Q[M]=te&1<<M?-1:1;return g};var t=r("bit-twiddle"),d=r("gl-mat4/multiply"),m=r("split-polygon"),p=r("robust-orientation"),e=new Array(16),f=new Array(8),u=new Array(8),s=new Array(3),l=[0,0,0];function o(h,y,v){for(var _=0;_<4;++_){h[_]=v[12+_];for(var x=0;x<3;++x)h[_]+=y[x]*v[4*x+_]}}(function(){for(var h=0;h<8;++h)f[h]=[1,1,1,1],u[h]=[1,1,1]})();var i=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function c(h){for(var y=0;y<i.length;++y)if((h=m.positive(h,i[y])).length<3)return 0;var v=h[0],_=v[0]/v[3],x=v[1]/v[3],T=0;for(y=1;y+1<h.length;++y){var A=h[y],S=h[y+1],w=A[0]/A[3]-_,C=A[1]/A[3]-x,k=S[0]/S[3]-_,L=S[1]/S[3]-x;T+=Math.abs(w*L-C*k)}return T}var n=[1,1,1],a=[0,0,0],g={cubeEdges:n,axis:a}},{"bit-twiddle":104,"gl-mat4/multiply":295,"robust-orientation":534,"split-polygon":552}],256:[function(r,O,B){O.exports=function(n,a,g){var h=[],y=[0,0,0],v=[0,0,0],_=[0,0,0],x=[0,0,0];h.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var T=0;T<3;++T){for(var A=h.length/3|0,S=0;S<g[T].length;++S){var w=+g[T][S].x;h.push(w,0,1,w,1,1,w,0,-1,w,0,-1,w,1,1,w,1,-1)}var C=h.length/3|0;y[T]=A,v[T]=C-A,A=h.length/3|0;for(var k=0;k<g[T].length;++k)w=+g[T][k].x,h.push(w,0,1,w,1,1,w,0,-1,w,0,-1,w,1,1,w,1,-1);C=h.length/3|0,_[T]=A,x[T]=C-A}var L=t(n,new Float32Array(h)),M=d(n,[{buffer:L,type:n.FLOAT,size:3,stride:0,offset:0}]),P=m(n);return P.attributes.position.location=0,new i(n,L,M,P,v,y,x,_)};var t=r("gl-buffer"),d=r("gl-vao"),m=r("./shaders").line,p=[0,0,0],e=[0,0,0],f=[0,0,0],u=[0,0,0],s=[1,1];function l(n){return n[0]=n[1]=n[2]=0,n}function o(n,a){return n[0]=a[0],n[1]=a[1],n[2]=a[2],n}function i(n,a,g,h,y,v,_,x){this.gl=n,this.vertBuffer=a,this.vao=g,this.shader=h,this.tickCount=y,this.tickOffset=v,this.gridCount=_,this.gridOffset=x}var c=i.prototype;c.bind=function(n,a,g){this.shader.bind(),this.shader.uniforms.model=n,this.shader.uniforms.view=a,this.shader.uniforms.projection=g,s[0]=this.gl.drawingBufferWidth,s[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=s,this.vao.bind()},c.unbind=function(){this.vao.unbind()},c.drawAxisLine=function(n,a,g,h,y){var v=l(e);this.shader.uniforms.majorAxis=e,v[n]=a[1][n]-a[0][n],this.shader.uniforms.minorAxis=v;var _,x=o(u,g);x[n]+=a[0][n],this.shader.uniforms.offset=x,this.shader.uniforms.lineWidth=y,this.shader.uniforms.color=h,(_=l(f))[(n+2)%3]=1,this.shader.uniforms.screenAxis=_,this.vao.draw(this.gl.TRIANGLES,6),(_=l(f))[(n+1)%3]=1,this.shader.uniforms.screenAxis=_,this.vao.draw(this.gl.TRIANGLES,6)},c.drawAxisTicks=function(n,a,g,h,y){if(this.tickCount[n]){var v=l(p);v[n]=1,this.shader.uniforms.majorAxis=v,this.shader.uniforms.offset=a,this.shader.uniforms.minorAxis=g,this.shader.uniforms.color=h,this.shader.uniforms.lineWidth=y;var _=l(f);_[n]=1,this.shader.uniforms.screenAxis=_,this.vao.draw(this.gl.TRIANGLES,this.tickCount[n],this.tickOffset[n])}},c.drawGrid=function(n,a,g,h,y,v){if(this.gridCount[n]){var _=l(e);_[a]=g[1][a]-g[0][a],this.shader.uniforms.minorAxis=_;var x=o(u,h);x[a]+=g[0][a],this.shader.uniforms.offset=x;var T=l(p);T[n]=1,this.shader.uniforms.majorAxis=T;var A=l(f);A[n]=1,this.shader.uniforms.screenAxis=A,this.shader.uniforms.lineWidth=v,this.shader.uniforms.color=y,this.vao.draw(this.gl.TRIANGLES,this.gridCount[n],this.gridOffset[n])}},c.drawZero=function(n,a,g,h,y,v){var _=l(e);this.shader.uniforms.majorAxis=_,_[n]=g[1][n]-g[0][n],this.shader.uniforms.minorAxis=_;var x=o(u,h);x[n]+=g[0][n],this.shader.uniforms.offset=x;var T=l(f);T[a]=1,this.shader.uniforms.screenAxis=T,this.shader.uniforms.lineWidth=v,this.shader.uniforms.color=y,this.vao.draw(this.gl.TRIANGLES,6)},c.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":257,"gl-buffer":261,"gl-vao":353}],257:[function(r,O,B){var t=r("glslify"),d=r("gl-shader"),m=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, majorAxis, minorAxis, screenAxis;
uniform float lineWidth;
uniform vec2 screenShape;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

void main() {
  vec3 major = position.x * majorAxis;
  vec3 minor = position.y * minorAxis;

  vec3 vPosition = major + minor + offset;
  vec3 pPosition = project(vPosition);
  vec3 offset = project(vPosition + screenAxis * position.z);

  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;

  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);
}
`]),p=t([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);B.line=function(l){return d(l,m,p,null,[{name:"position",type:"vec3"}])};var e=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, axis, alignDir, alignOpt;
uniform float scale, angle, pixelScale;
uniform vec2 resolution;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

float computeViewAngle(vec3 a, vec3 b) {
  vec3 A = project(a);
  vec3 B = project(b);

  return atan(
    (B.y - A.y) * resolution.y,
    (B.x - A.x) * resolution.x
  );
}

const float PI = 3.141592;
const float TWO_PI = 2.0 * PI;
const float HALF_PI = 0.5 * PI;
const float ONE_AND_HALF_PI = 1.5 * PI;

int option = int(floor(alignOpt.x + 0.001));
float hv_ratio =       alignOpt.y;
bool enableAlign =    (alignOpt.z != 0.0);

float mod_angle(float a) {
  return mod(a, PI);
}

float positive_angle(float a) {
  return mod_angle((a < 0.0) ?
    a + TWO_PI :
    a
  );
}

float look_upwards(float a) {
  float b = positive_angle(a);
  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?
    b - PI :
    b;
}

float look_horizontal_or_vertical(float a, float ratio) {
  // ratio controls the ratio between being horizontal to (vertical + horizontal)
  // if ratio is set to 0.5 then it is 50%, 50%.
  // when using a higher ratio e.g. 0.75 the result would
  // likely be more horizontal than vertical.

  float b = positive_angle(a);

  return
    (b < (      ratio) * HALF_PI) ? 0.0 :
    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :
    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :
    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :
                                    0.0;
}

float roundTo(float a, float b) {
  return float(b * floor((a + 0.5 * b) / b));
}

float look_round_n_directions(float a, int n) {
  float b = positive_angle(a);
  float div = TWO_PI / float(n);
  float c = roundTo(b, div);
  return look_upwards(c);
}

float applyAlignOption(float rawAngle, float delta) {
  return
    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions
    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical
    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis
    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards
    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal
                    rawAngle;                // otherwise return back raw input angle
}

bool isAxisTitle = (axis.x == 0.0) &&
                   (axis.y == 0.0) &&
                   (axis.z == 0.0);

void main() {
  //Compute world offset
  float axisDistance = position.z;
  vec3 dataPosition = axisDistance * axis + offset;

  float beta = angle; // i.e. user defined attributes for each tick

  float axisAngle;
  float clipAngle;
  float flip;

  if (enableAlign) {
    axisAngle = (isAxisTitle) ? HALF_PI :
                      computeViewAngle(dataPosition, dataPosition + axis);
    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);

    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;
    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;

    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),
                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;

    beta += applyAlignOption(clipAngle, flip * PI);
  }

  //Compute plane offset
  vec2 planeCoord = position.xy * pixelScale;

  mat2 planeXform = scale * mat2(
     cos(beta), sin(beta),
    -sin(beta), cos(beta)
  );

  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;

  //Compute clip position
  vec3 clipPosition = project(dataPosition);

  //Apply text offset in clip coordinates
  clipPosition += vec3(viewOffset, 0.0);

  //Done
  gl_Position = vec4(clipPosition, 1.0);
}`]),f=t([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);B.text=function(l){return d(l,e,f,null,[{name:"position",type:"vec3"}])};var u=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec3 normal;

uniform mat4 model, view, projection;
uniform vec3 enable;
uniform vec3 bounds[2];

varying vec3 colorChannel;

void main() {

  vec3 signAxis = sign(bounds[1] - bounds[0]);

  vec3 realNormal = signAxis * normal;

  if(dot(realNormal, enable) > 0.0) {
    vec3 minRange = min(bounds[0], bounds[1]);
    vec3 maxRange = max(bounds[0], bounds[1]);
    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));
    gl_Position = projection * view * model * vec4(nPosition, 1.0);
  } else {
    gl_Position = vec4(0,0,0,0);
  }

  colorChannel = abs(realNormal);
}`]),s=t([`precision highp float;
#define GLSLIFY 1

uniform vec4 colors[3];

varying vec3 colorChannel;

void main() {
  gl_FragColor = colorChannel.x * colors[0] +
                 colorChannel.y * colors[1] +
                 colorChannel.z * colors[2];
}`]);B.bg=function(l){return d(l,u,s,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":332,glslify:434}],258:[function(r,O,B){(function(t){(function(){O.exports=function(i,c,n,a,g,h){var y=d(i),v=m(i,[{buffer:y,size:3}]),_=e(i);_.attributes.position.location=0;var x=new s(i,_,y,v);return x.update(c,n,a,g,h),x};var d=r("gl-buffer"),m=r("gl-vao"),p=r("vectorize-text"),e=r("./shaders").text,f=window||t.global||{},u=f.__TEXT_CACHE||{};f.__TEXT_CACHE={};function s(i,c,n,a){this.gl=i,this.shader=c,this.buffer=n,this.vao=a,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var l=s.prototype,o=[0,0];l.bind=function(i,c,n,a){this.vao.bind(),this.shader.bind();var g=this.shader.uniforms;g.model=i,g.view=c,g.projection=n,g.pixelScale=a,o[0]=this.gl.drawingBufferWidth,o[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=o},l.unbind=function(){this.vao.unbind()},l.update=function(i,c,n,a,g){var h=[];function y(C,k,L,M,P,D){var N=u[L];N||(N=u[L]={});var U=N[k];U||(U=N[k]=function(j,W){try{return p(j,W)}catch(ee){return console.warn('error vectorizing text:"'+j+'" error:',ee),{cells:[],positions:[]}}}(k,{triangles:!0,font:L,textAlign:"center",textBaseline:"middle",lineSpacing:P,styletags:D}));for(var q=(M||12)/12,X=U.positions,K=U.cells,Z=0,H=K.length;Z<H;++Z)for(var Y=K[Z],$=2;$>=0;--$){var z=X[Y[$]];h.push(q*z[0],-q*z[1],C)}}for(var v=[0,0,0],_=[0,0,0],x=[0,0,0],T=[0,0,0],A={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},S=0;S<3;++S){x[S]=h.length/3|0,y(.5*(i[0][S]+i[1][S]),c[S],n[S],12,1.25,A),T[S]=(h.length/3|0)-x[S],v[S]=h.length/3|0;for(var w=0;w<a[S].length;++w)a[S][w].text&&y(a[S][w].x,a[S][w].text,a[S][w].font||g,a[S][w].fontSize||12,1.25,A);_[S]=(h.length/3|0)-v[S]}this.buffer.update(h),this.tickOffset=v,this.tickCount=_,this.labelOffset=x,this.labelCount=T},l.drawTicks=function(i,c,n,a,g,h,y,v){this.tickCount[i]&&(this.shader.uniforms.axis=h,this.shader.uniforms.color=g,this.shader.uniforms.angle=n,this.shader.uniforms.scale=c,this.shader.uniforms.offset=a,this.shader.uniforms.alignDir=y,this.shader.uniforms.alignOpt=v,this.vao.draw(this.gl.TRIANGLES,this.tickCount[i],this.tickOffset[i]))},l.drawLabel=function(i,c,n,a,g,h,y,v){this.labelCount[i]&&(this.shader.uniforms.axis=h,this.shader.uniforms.color=g,this.shader.uniforms.angle=n,this.shader.uniforms.scale=c,this.shader.uniforms.offset=a,this.shader.uniforms.alignDir=y,this.shader.uniforms.alignOpt=v,this.vao.draw(this.gl.TRIANGLES,this.labelCount[i],this.labelOffset[i]))},l.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this)}).call(this,r("_process"))},{"./shaders":257,_process:514,"gl-buffer":261,"gl-vao":353,"vectorize-text":607}],259:[function(r,O,B){function t(d,m){var p=d+"",e=p.indexOf("."),f=0;e>=0&&(f=p.length-e-1);var u=Math.pow(10,f),s=Math.round(d*m*u),l=s+"";if(l.indexOf("e")>=0)return l;var o=s/u,i=s%u;s<0?(o=0|-Math.ceil(o),i=0|-i):(o=0|Math.floor(o),i|=0);var c=""+o;if(s<0&&(c="-"+c),f){for(var n=""+i;n.length<f;)n="0"+n;return c+"."+n}return c}B.create=function(d,m){for(var p=[],e=0;e<3;++e){for(var f=[],u=(d[0][e],d[1][e],0);u*m[e]<=d[1][e];++u)f.push({x:u*m[e],text:t(m[e],u)});for(u=-1;u*m[e]>=d[0][e];--u)f.push({x:u*m[e],text:t(m[e],u)});p.push(f)}return p},B.equal=function(d,m){for(var p=0;p<3;++p){if(d[p].length!==m[p].length)return!1;for(var e=0;e<d[p].length;++e){var f=d[p][e],u=m[p][e];if(f.x!==u.x||f.text!==u.text||f.font!==u.font||f.fontColor!==u.fontColor||f.fontSize!==u.fontSize||f.dx!==u.dx||f.dy!==u.dy)return!1}}return!0}},{}],260:[function(r,O,B){O.exports=function(g,h,y,v,_){var x=h.model||u,T=h.view||u,A=h.projection||u,S=h._ortho||!1,w=g.bounds,C=(_=_||m(x,T,A,w,S)).axis;p(s,T,x),p(s,A,s);for(var k=n,L=0;L<3;++L)k[L].lo=1/0,k[L].hi=-1/0,k[L].pixelsPerDataUnit=1/0;var M=t(e(s,s));e(s,s);for(var P=0;P<3;++P){var D=(P+1)%3,N=(P+2)%3,U=a;e:for(L=0;L<2;++L){var q=[];if(C[P]<0!=!!L){U[P]=w[L][P];for(var X=0;X<2;++X){U[D]=w[X^L][D];for(var K=0;K<2;++K)U[N]=w[K^X^L][N],q.push(U.slice())}var Z=S?5:4;for(X=Z;X===Z;++X){if(q.length===0)continue e;q=d.positive(q,M[X])}for(X=0;X<q.length;++X){N=q[X];var H=c(a,s,N,y,v);for(K=0;K<3;++K)k[K].lo=Math.min(k[K].lo,N[K]),k[K].hi=Math.max(k[K].hi,N[K]),K!==P&&(k[K].pixelsPerDataUnit=Math.min(k[K].pixelsPerDataUnit,Math.abs(H[K])))}}}}return k};var t=r("extract-frustum-planes"),d=r("split-polygon"),m=r("./lib/cube.js"),p=r("gl-mat4/multiply"),e=r("gl-mat4/transpose"),f=r("gl-vec4/transformMat4"),u=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),s=new Float32Array(16);function l(g,h,y){this.lo=g,this.hi=h,this.pixelsPerDataUnit=y}var o=[0,0,0,1],i=[0,0,0,1];function c(g,h,y,v,_){for(var x=0;x<3;++x){for(var T=o,A=i,S=0;S<3;++S)A[S]=T[S]=y[S];A[3]=T[3]=1,A[x]+=1,f(A,A,h),A[3]<0&&(g[x]=1/0),T[x]-=1,f(T,T,h),T[3]<0&&(g[x]=1/0);var w=(T[0]/T[3]-A[0]/A[3])*v,C=(T[1]/T[3]-A[1]/A[3])*_;g[x]=.25*Math.sqrt(w*w+C*C)}return g}var n=[new l(1/0,-1/0,1/0),new l(1/0,-1/0,1/0),new l(1/0,-1/0,1/0)],a=[0,0,0]},{"./lib/cube.js":255,"extract-frustum-planes":245,"gl-mat4/multiply":295,"gl-mat4/transpose":306,"gl-vec4/transformMat4":424,"split-polygon":552}],261:[function(r,O,B){var t=r("typedarray-pool"),d=r("ndarray-ops"),m=r("ndarray"),p=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function e(l,o,i,c,n){this.gl=l,this.type=o,this.handle=i,this.length=c,this.usage=n}var f=e.prototype;function u(l,o,i,c,n,a){var g=n.length*n.BYTES_PER_ELEMENT;if(a<0)return l.bufferData(o,n,c),g;if(g+a>i)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return l.bufferSubData(o,a,n),i}function s(l,o){for(var i=t.malloc(l.length,o),c=l.length,n=0;n<c;++n)i[n]=l[n];return i}f.bind=function(){this.gl.bindBuffer(this.type,this.handle)},f.unbind=function(){this.gl.bindBuffer(this.type,null)},f.dispose=function(){this.gl.deleteBuffer(this.handle)},f.update=function(l,o){if(typeof o!="number"&&(o=-1),this.bind(),typeof l=="object"&&l.shape!==void 0){var i=l.dtype;if(p.indexOf(i)<0&&(i="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER&&(i=gl.getExtension("OES_element_index_uint")&&i!=="uint16"?"uint32":"uint16"),i===l.dtype&&function(g,h){for(var y=1,v=h.length-1;v>=0;--v){if(h[v]!==y)return!1;y*=g[v]}return!0}(l.shape,l.stride))l.offset===0&&l.data.length===l.shape[0]?this.length=u(this.gl,this.type,this.length,this.usage,l.data,o):this.length=u(this.gl,this.type,this.length,this.usage,l.data.subarray(l.offset,l.shape[0]),o);else{var c=t.malloc(l.size,i),n=m(c,l.shape);d.assign(n,l),this.length=u(this.gl,this.type,this.length,this.usage,o<0?c:c.subarray(0,l.size),o),t.free(c)}}else if(Array.isArray(l)){var a;a=this.type===this.gl.ELEMENT_ARRAY_BUFFER?s(l,"uint16"):s(l,"float32"),this.length=u(this.gl,this.type,this.length,this.usage,o<0?a:a.subarray(0,l.length),o),t.free(a)}else if(typeof l=="object"&&typeof l.length=="number")this.length=u(this.gl,this.type,this.length,this.usage,l,o);else{if(typeof l!="number"&&l!==void 0)throw new Error("gl-buffer: Invalid data type");if(o>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");(l|=0)<=0&&(l=1),this.gl.bufferData(this.type,0|l,this.usage),this.length=l}},O.exports=function(l,o,i,c){if(i=i||l.ARRAY_BUFFER,c=c||l.DYNAMIC_DRAW,i!==l.ARRAY_BUFFER&&i!==l.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(c!==l.DYNAMIC_DRAW&&c!==l.STATIC_DRAW&&c!==l.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var n=l.createBuffer(),a=new e(l,i,n,0,c);return a.update(o),a}},{ndarray:472,"ndarray-ops":467,"typedarray-pool":601}],262:[function(r,O,B){var t=r("gl-vec3");O.exports=function(m,p){var e=m.positions,f=m.vectors,u={positions:[],vertexIntensity:[],vertexIntensityBounds:m.vertexIntensityBounds,vectors:[],cells:[],coneOffset:m.coneOffset,colormap:m.colormap};if(m.positions.length===0)return p&&(p[0]=[0,0,0],p[1]=[0,0,0]),u;for(var s=0,l=1/0,o=-1/0,i=1/0,c=-1/0,n=1/0,a=-1/0,g=null,h=null,y=[],v=1/0,_=!1,x=0;x<e.length;x++){var T=e[x];l=Math.min(T[0],l),o=Math.max(T[0],o),i=Math.min(T[1],i),c=Math.max(T[1],c),n=Math.min(T[2],n),a=Math.max(T[2],a);var A=f[x];if(t.length(A)>s&&(s=t.length(A)),x){var S=2*t.distance(g,T)/(t.length(h)+t.length(A));S?(v=Math.min(v,S),_=!1):_=!0}_||(g=T,h=A),y.push(A)}var w=[l,i,n],C=[o,c,a];p&&(p[0]=w,p[1]=C),s===0&&(s=1);var k=1/s;isFinite(v)||(v=1),u.vectorScale=v;var L=m.coneSize||.5;m.absoluteConeSize&&(L=m.absoluteConeSize*k),u.coneScale=L,x=0;for(var M=0;x<e.length;x++)for(var P=(T=e[x])[0],D=T[1],N=T[2],U=y[x],q=t.length(U)*k,X=0;X<8;X++){u.positions.push([P,D,N,M++]),u.positions.push([P,D,N,M++]),u.positions.push([P,D,N,M++]),u.positions.push([P,D,N,M++]),u.positions.push([P,D,N,M++]),u.positions.push([P,D,N,M++]),u.vectors.push(U),u.vectors.push(U),u.vectors.push(U),u.vectors.push(U),u.vectors.push(U),u.vectors.push(U),u.vertexIntensity.push(q,q,q),u.vertexIntensity.push(q,q,q);var K=u.positions.length;u.cells.push([K-6,K-5,K-4],[K-3,K-2,K-1])}return u};var d=r("./lib/shaders");O.exports.createMesh=r("./create_mesh"),O.exports.createConeMesh=function(m,p){return O.exports.createMesh(m,p,{shaders:d,traceType:"cone"})}},{"./create_mesh":263,"./lib/shaders":264,"gl-vec3":372}],263:[function(r,O,B){var t=r("gl-shader"),d=r("gl-buffer"),m=r("gl-vao"),p=r("gl-texture2d"),e=r("gl-mat4/multiply"),f=r("gl-mat4/invert"),u=r("ndarray"),s=r("colormap"),l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function o(a,g,h,y,v,_,x,T,A,S,w){this.gl=a,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=g,this.dirty=!0,this.triShader=h,this.pickShader=y,this.trianglePositions=v,this.triangleVectors=_,this.triangleColors=T,this.triangleUVs=A,this.triangleIds=x,this.triangleVAO=S,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=w,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=l,this._view=l,this._projection=l,this._resolution=[1,1]}var i=o.prototype;function c(a,g){var h=t(a,g.meshShader.vertex,g.meshShader.fragment,null,g.meshShader.attributes);return h.attributes.position.location=0,h.attributes.color.location=2,h.attributes.uv.location=3,h.attributes.vector.location=4,h}function n(a,g){var h=t(a,g.pickShader.vertex,g.pickShader.fragment,null,g.pickShader.attributes);return h.attributes.position.location=0,h.attributes.id.location=1,h.attributes.vector.location=4,h}i.isOpaque=function(){return this.opacity>=1},i.isTransparent=function(){return this.opacity<1},i.pickSlots=1,i.setPickBase=function(a){this.pickId=a},i.update=function(a){a=a||{};var g=this.gl;this.dirty=!0,"lightPosition"in a&&(this.lightPosition=a.lightPosition),"opacity"in a&&(this.opacity=a.opacity),"ambient"in a&&(this.ambientLight=a.ambient),"diffuse"in a&&(this.diffuseLight=a.diffuse),"specular"in a&&(this.specularLight=a.specular),"roughness"in a&&(this.roughness=a.roughness),"fresnel"in a&&(this.fresnel=a.fresnel),a.tubeScale!==void 0&&(this.tubeScale=a.tubeScale),a.vectorScale!==void 0&&(this.vectorScale=a.vectorScale),a.coneScale!==void 0&&(this.coneScale=a.coneScale),a.coneOffset!==void 0&&(this.coneOffset=a.coneOffset),a.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=g.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=g.LINEAR,this.texture.setPixels(function($){for(var z=s({colormap:$,nshades:256,format:"rgba"}),j=new Uint8Array(1024),W=0;W<256;++W){for(var ee=z[W],J=0;J<3;++J)j[4*W+J]=ee[J];j[4*W+3]=255*ee[3]}return u(j,[256,256,4],[4,0,1])}(a.colormap)),this.texture.generateMipmap());var h=a.cells,y=a.positions,v=a.vectors;if(y&&h&&v){var _=[],x=[],T=[],A=[],S=[];this.cells=h,this.positions=y,this.vectors=v;var w=a.meshColor||[1,1,1,1],C=a.vertexIntensity,k=1/0,L=-1/0;if(C)if(a.vertexIntensityBounds)k=+a.vertexIntensityBounds[0],L=+a.vertexIntensityBounds[1];else for(var M=0;M<C.length;++M){var P=C[M];k=Math.min(k,P),L=Math.max(L,P)}else for(M=0;M<y.length;++M)P=y[M][2],k=Math.min(k,P),L=Math.max(L,P);for(this.intensity=C||function($){for(var z=$.length,j=new Array(z),W=0;W<z;++W)j[W]=$[W][2];return j}(y),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],M=0;M<y.length;++M)for(var D=y[M],N=0;N<3;++N)!isNaN(D[N])&&isFinite(D[N])&&(this.bounds[0][N]=Math.min(this.bounds[0][N],D[N]),this.bounds[1][N]=Math.max(this.bounds[1][N],D[N]));var U=0;e:for(M=0;M<h.length;++M){var q=h[M];switch(q.length){case 3:for(N=0;N<3;++N){D=y[K=q[N]];for(var X=0;X<3;++X)if(isNaN(D[X])||!isFinite(D[X]))continue e}for(N=0;N<3;++N){var K;D=y[K=q[2-N]],_.push(D[0],D[1],D[2],D[3]);var Z=v[K];x.push(Z[0],Z[1],Z[2],Z[3]||0);var H,Y=w;Y.length===3?T.push(Y[0],Y[1],Y[2],1):T.push(Y[0],Y[1],Y[2],Y[3]),H=C?[(C[K]-k)/(L-k),0]:[(D[2]-k)/(L-k),0],A.push(H[0],H[1]),S.push(M)}U+=1}}this.triangleCount=U,this.trianglePositions.update(_),this.triangleVectors.update(x),this.triangleColors.update(T),this.triangleUVs.update(A),this.triangleIds.update(new Uint32Array(S))}},i.drawTransparent=i.draw=function(a){a=a||{};for(var g=this.gl,h=a.model||l,y=a.view||l,v=a.projection||l,_=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],x=0;x<3;++x)_[0][x]=Math.max(_[0][x],this.clipBounds[0][x]),_[1][x]=Math.min(_[1][x],this.clipBounds[1][x]);var T={model:h,view:y,projection:v,inverseModel:l.slice(),clipBounds:_,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};T.inverseModel=f(T.inverseModel,T.model),g.disable(g.CULL_FACE),this.texture.bind(0);var A=new Array(16);for(e(A,T.view,T.model),e(A,T.projection,A),f(A,A),x=0;x<3;++x)T.eyePosition[x]=A[12+x]/A[15];var S=A[15];for(x=0;x<3;++x)S+=this.lightPosition[x]*A[4*x+3];for(x=0;x<3;++x){for(var w=A[12+x],C=0;C<3;++C)w+=A[4*C+x]*this.lightPosition[C];T.lightPosition[x]=w/S}if(this.triangleCount>0){var k=this.triShader;k.bind(),k.uniforms=T,this.triangleVAO.bind(),g.drawArrays(g.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},i.drawPick=function(a){a=a||{};for(var g=this.gl,h=a.model||l,y=a.view||l,v=a.projection||l,_=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],x=0;x<3;++x)_[0][x]=Math.max(_[0][x],this.clipBounds[0][x]),_[1][x]=Math.min(_[1][x],this.clipBounds[1][x]);this._model=[].slice.call(h),this._view=[].slice.call(y),this._projection=[].slice.call(v),this._resolution=[g.drawingBufferWidth,g.drawingBufferHeight];var T={model:h,view:y,projection:v,clipBounds:_,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},A=this.pickShader;A.bind(),A.uniforms=T,this.triangleCount>0&&(this.triangleVAO.bind(),g.drawArrays(g.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind())},i.pick=function(a){if(!a||a.id!==this.pickId)return null;var g=a.value[0]+256*a.value[1]+65536*a.value[2],h=this.cells[g],y=this.positions[h[1]].slice(0,3),v={position:y,dataCoordinate:y,index:Math.floor(h[1]/48)};return this.traceType==="cone"?v.index=Math.floor(h[1]/48):this.traceType==="streamtube"&&(v.intensity=this.intensity[h[1]],v.velocity=this.vectors[h[1]].slice(0,3),v.divergence=this.vectors[h[1]][3],v.index=g),v},i.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()},O.exports=function(a,g,h){var y=h.shaders;arguments.length===1&&(a=(g=a).gl);var v=c(a,y),_=n(a,y),x=p(a,u(new Uint8Array([255,255,255,255]),[1,1,4]));x.generateMipmap(),x.minFilter=a.LINEAR_MIPMAP_LINEAR,x.magFilter=a.LINEAR;var T=d(a),A=d(a),S=d(a),w=d(a),C=d(a),k=m(a,[{buffer:T,type:a.FLOAT,size:4},{buffer:C,type:a.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:S,type:a.FLOAT,size:4},{buffer:w,type:a.FLOAT,size:2},{buffer:A,type:a.FLOAT,size:4}]),L=new o(a,x,v,_,T,A,C,S,w,k,h.traceType||"cone");return L.update(g),L}},{colormap:137,"gl-buffer":261,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-shader":332,"gl-texture2d":348,"gl-vao":353,ndarray:472}],264:[function(r,O,B){var t=r("glslify"),d=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec3 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, coneScale, coneOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * conePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(conePosition, 1.0);
  vec4 t_position  = view * conePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = conePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),m=t([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),p=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float vectorScale, coneScale, coneOffset;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);
  gl_Position = projection * view * conePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),e=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);B.meshShader={vertex:d,fragment:m,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},B.pickShader={vertex:p,fragment:e,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:434}],265:[function(r,O,B){O.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],266:[function(r,O,B){var t=r("./1.0/numbers");O.exports=function(d){return t[d]}},{"./1.0/numbers":265}],267:[function(r,O,B){O.exports=function(o){var i=o.gl,c=t(i),n=d(i,[{buffer:c,type:i.FLOAT,size:3,offset:0,stride:40},{buffer:c,type:i.FLOAT,size:4,offset:12,stride:40},{buffer:c,type:i.FLOAT,size:3,offset:28,stride:40}]),a=m(i);a.attributes.position.location=0,a.attributes.color.location=1,a.attributes.offset.location=2;var g=new e(i,c,n,a);return g.update(o),g};var t=r("gl-buffer"),d=r("gl-vao"),m=r("./shaders/index"),p=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(o,i,c,n){this.gl=o,this.shader=n,this.buffer=i,this.vao=c,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var f=e.prototype;function u(o,i){for(var c=0;c<3;++c)o[0][c]=Math.min(o[0][c],i[c]),o[1][c]=Math.max(o[1][c],i[c])}f.isOpaque=function(){return!this.hasAlpha},f.isTransparent=function(){return this.hasAlpha},f.drawTransparent=f.draw=function(o){var i=this.gl,c=this.shader.uniforms;this.shader.bind();var n=c.view=o.view||p,a=c.projection=o.projection||p;c.model=o.model||p,c.clipBounds=this.clipBounds,c.opacity=this.opacity;var g=n[12],h=n[13],y=n[14],v=n[15],_=(o._ortho?2:1)*this.pixelRatio*(a[3]*g+a[7]*h+a[11]*y+a[15]*v)/i.drawingBufferHeight;this.vao.bind();for(var x=0;x<3;++x)i.lineWidth(this.lineWidth[x]*this.pixelRatio),c.capSize=this.capSize[x]*_,this.lineCount[x]&&i.drawArrays(i.LINES,this.lineOffset[x],this.lineCount[x]);this.vao.unbind()};var s=function(){for(var o=new Array(3),i=0;i<3;++i){for(var c=[],n=1;n<=2;++n)for(var a=-1;a<=1;a+=2){var g=[0,0,0];g[(n+i)%3]=a,c.push(g)}o[i]=c}return o}();function l(o,i,c,n){for(var a=s[n],g=0;g<a.length;++g){var h=a[g];o.push(i[0],i[1],i[2],c[0],c[1],c[2],c[3],h[0],h[1],h[2])}return a.length}f.update=function(o){"lineWidth"in(o=o||{})&&(this.lineWidth=o.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in o&&(this.capSize=o.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in o&&(this.opacity=+o.opacity,this.opacity<1&&(this.hasAlpha=!0));var i=o.color||[[0,0,0],[0,0,0],[0,0,0]],c=o.position,n=o.error;if(Array.isArray(i[0])||(i=[i,i,i]),c&&n){var a=[],g=c.length,h=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var y=0;y<3;++y){this.lineOffset[y]=h;e:for(var v=0;v<g;++v){for(var _=c[v],x=0;x<3;++x)if(isNaN(_[x])||!isFinite(_[x]))continue e;var T=n[v],A=i[y];if(Array.isArray(A[0])&&(A=i[v]),A.length===3?A=[A[0],A[1],A[2],1]:A.length===4&&(A=[A[0],A[1],A[2],A[3]],!this.hasAlpha&&A[3]<1&&(this.hasAlpha=!0)),!isNaN(T[0][y])&&!isNaN(T[1][y])){var S;T[0][y]<0&&((S=_.slice())[y]+=T[0][y],a.push(_[0],_[1],_[2],A[0],A[1],A[2],A[3],0,0,0,S[0],S[1],S[2],A[0],A[1],A[2],A[3],0,0,0),u(this.bounds,S),h+=2+l(a,S,A,y)),T[1][y]>0&&((S=_.slice())[y]+=T[1][y],a.push(_[0],_[1],_[2],A[0],A[1],A[2],A[3],0,0,0,S[0],S[1],S[2],A[0],A[1],A[2],A[3],0,0,0),u(this.bounds,S),h+=2+l(a,S,A,y))}}this.lineCount[y]=h-this.lineOffset[y]}this.buffer.update(a)}},f.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":269,"gl-buffer":261,"gl-vao":353}],268:[function(r,O,B){O.exports=function(t){typeof t=="string"&&(t=[t]);for(var d=[].slice.call(arguments,1),m=[],p=0;p<t.length-1;p++)m.push(t[p],d[p]||"");return m.push(t[p]),m.join("")}},{}],269:[function(r,O,B){var t=r("glslify"),d=r("gl-shader"),m=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, offset;
attribute vec4 color;
uniform mat4 model, view, projection;
uniform float capSize;
varying vec4 fragColor;
varying vec3 fragPosition;

void main() {
  vec4 worldPosition  = model * vec4(position, 1.0);
  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);
  gl_Position         = projection * view * worldPosition;
  fragColor           = color;
  fragPosition        = position;
}`]),p=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float opacity;
varying vec3 fragPosition;
varying vec4 fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  gl_FragColor = opacity * fragColor;
}`]);O.exports=function(e){return d(e,m,p,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":332,glslify:268}],270:[function(r,O,B){var t=r("gl-texture2d");O.exports=function(g,h,y,v){d||(d=g.FRAMEBUFFER_UNSUPPORTED,m=g.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,p=g.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,e=g.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var _=g.getExtension("WEBGL_draw_buffers");if(!f&&_&&function(k,L){var M=k.getParameter(L.MAX_COLOR_ATTACHMENTS_WEBGL);f=new Array(M+1);for(var P=0;P<=M;++P){for(var D=new Array(M),N=0;N<P;++N)D[N]=k.COLOR_ATTACHMENT0+N;for(N=P;N<M;++N)D[N]=k.NONE;f[P]=D}}(g,_),Array.isArray(h)&&(v=y,y=0|h[1],h=0|h[0]),typeof h!="number")throw new Error("gl-fbo: Missing shape parameter");var x=g.getParameter(g.MAX_RENDERBUFFER_SIZE);if(h<0||h>x||y<0||y>x)throw new Error("gl-fbo: Parameters are too large for FBO");var T=1;if("color"in(v=v||{})){if((T=Math.max(0|v.color,0))<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(T>1){if(!_)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(T>g.getParameter(_.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+T+" draw buffers")}}var A=g.UNSIGNED_BYTE,S=g.getExtension("OES_texture_float");if(v.float&&T>0){if(!S)throw new Error("gl-fbo: Context does not support floating point textures");A=g.FLOAT}else v.preferFloat&&T>0&&S&&(A=g.FLOAT);var w=!0;"depth"in v&&(w=!!v.depth);var C=!1;return"stencil"in v&&(C=!!v.stencil),new c(g,h,y,A,T,w,C,_)};var d,m,p,e,f=null;function u(g){return[g.getParameter(g.FRAMEBUFFER_BINDING),g.getParameter(g.RENDERBUFFER_BINDING),g.getParameter(g.TEXTURE_BINDING_2D)]}function s(g,h){g.bindFramebuffer(g.FRAMEBUFFER,h[0]),g.bindRenderbuffer(g.RENDERBUFFER,h[1]),g.bindTexture(g.TEXTURE_2D,h[2])}function l(g){switch(g){case d:throw new Error("gl-fbo: Framebuffer unsupported");case m:throw new Error("gl-fbo: Framebuffer incomplete attachment");case p:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case e:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function o(g,h,y,v,_,x){if(!v)return null;var T=t(g,h,y,_,v);return T.magFilter=g.NEAREST,T.minFilter=g.NEAREST,T.mipSamples=1,T.bind(),g.framebufferTexture2D(g.FRAMEBUFFER,x,g.TEXTURE_2D,T.handle,0),T}function i(g,h,y,v,_){var x=g.createRenderbuffer();return g.bindRenderbuffer(g.RENDERBUFFER,x),g.renderbufferStorage(g.RENDERBUFFER,v,h,y),g.framebufferRenderbuffer(g.FRAMEBUFFER,_,g.RENDERBUFFER,x),x}function c(g,h,y,v,_,x,T,A){this.gl=g,this._shape=[0|h,0|y],this._destroyed=!1,this._ext=A,this.color=new Array(_);for(var S=0;S<_;++S)this.color[S]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=v,this._useDepth=x,this._useStencil=T;var w=this,C=[0|h,0|y];Object.defineProperties(C,{0:{get:function(){return w._shape[0]},set:function(k){return w.width=k}},1:{get:function(){return w._shape[1]},set:function(k){return w.height=k}}}),this._shapeVector=C,function(k){var L=u(k.gl),M=k.gl,P=k.handle=M.createFramebuffer(),D=k._shape[0],N=k._shape[1],U=k.color.length,q=k._ext,X=k._useStencil,K=k._useDepth,Z=k._colorType;M.bindFramebuffer(M.FRAMEBUFFER,P);for(var H=0;H<U;++H)k.color[H]=o(M,D,N,Z,M.RGBA,M.COLOR_ATTACHMENT0+H);U===0?(k._color_rb=i(M,D,N,M.RGBA4,M.COLOR_ATTACHMENT0),q&&q.drawBuffersWEBGL(f[0])):U>1&&q.drawBuffersWEBGL(f[U]);var Y=M.getExtension("WEBGL_depth_texture");Y?X?k.depth=o(M,D,N,Y.UNSIGNED_INT_24_8_WEBGL,M.DEPTH_STENCIL,M.DEPTH_STENCIL_ATTACHMENT):K&&(k.depth=o(M,D,N,M.UNSIGNED_SHORT,M.DEPTH_COMPONENT,M.DEPTH_ATTACHMENT)):K&&X?k._depth_rb=i(M,D,N,M.DEPTH_STENCIL,M.DEPTH_STENCIL_ATTACHMENT):K?k._depth_rb=i(M,D,N,M.DEPTH_COMPONENT16,M.DEPTH_ATTACHMENT):X&&(k._depth_rb=i(M,D,N,M.STENCIL_INDEX,M.STENCIL_ATTACHMENT));var $=M.checkFramebufferStatus(M.FRAMEBUFFER);if($!==M.FRAMEBUFFER_COMPLETE){for(k._destroyed=!0,M.bindFramebuffer(M.FRAMEBUFFER,null),M.deleteFramebuffer(k.handle),k.handle=null,k.depth&&(k.depth.dispose(),k.depth=null),k._depth_rb&&(M.deleteRenderbuffer(k._depth_rb),k._depth_rb=null),H=0;H<k.color.length;++H)k.color[H].dispose(),k.color[H]=null;k._color_rb&&(M.deleteRenderbuffer(k._color_rb),k._color_rb=null),s(M,L),l($)}s(M,L)}(this)}var n=c.prototype;function a(g,h,y){if(g._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(g._shape[0]!==h||g._shape[1]!==y){var v=g.gl,_=v.getParameter(v.MAX_RENDERBUFFER_SIZE);if(h<0||h>_||y<0||y>_)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");g._shape[0]=h,g._shape[1]=y;for(var x=u(v),T=0;T<g.color.length;++T)g.color[T].shape=g._shape;g._color_rb&&(v.bindRenderbuffer(v.RENDERBUFFER,g._color_rb),v.renderbufferStorage(v.RENDERBUFFER,v.RGBA4,g._shape[0],g._shape[1])),g.depth&&(g.depth.shape=g._shape),g._depth_rb&&(v.bindRenderbuffer(v.RENDERBUFFER,g._depth_rb),g._useDepth&&g._useStencil?v.renderbufferStorage(v.RENDERBUFFER,v.DEPTH_STENCIL,g._shape[0],g._shape[1]):g._useDepth?v.renderbufferStorage(v.RENDERBUFFER,v.DEPTH_COMPONENT16,g._shape[0],g._shape[1]):g._useStencil&&v.renderbufferStorage(v.RENDERBUFFER,v.STENCIL_INDEX,g._shape[0],g._shape[1])),v.bindFramebuffer(v.FRAMEBUFFER,g.handle);var A=v.checkFramebufferStatus(v.FRAMEBUFFER);A!==v.FRAMEBUFFER_COMPLETE&&(g.dispose(),s(v,x),l(A)),s(v,x)}}Object.defineProperties(n,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(g){if(Array.isArray(g)||(g=[0|g,0|g]),g.length!==2)throw new Error("gl-fbo: Shape vector must be length 2");var h=0|g[0],y=0|g[1];return a(this,h,y),[h,y]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(g){return a(this,g|=0,this._shape[1]),g},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(g){return g|=0,a(this,this._shape[0],g),g},enumerable:!1}}),n.bind=function(){if(!this._destroyed){var g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,this.handle),g.viewport(0,0,this._shape[0],this._shape[1])}},n.dispose=function(){if(!this._destroyed){this._destroyed=!0;var g=this.gl;g.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(g.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var h=0;h<this.color.length;++h)this.color[h].dispose(),this.color[h]=null;this._color_rb&&(g.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":348}],271:[function(r,O,B){var t=r("sprintf-js").sprintf,d=r("gl-constants/lookup"),m=r("glsl-shader-name"),p=r("add-line-numbers");O.exports=function(e,f,u){var s=m(f)||"of unknown name (see npm glsl-shader-name)",l="unknown type";u!==void 0&&(l=u===d.FRAGMENT_SHADER?"fragment":"vertex");for(var o=t(`Error compiling %s shader %s:
`,l,s),i=t("%s%s",o,e),c=e.split(`
`),n={},a=0;a<c.length;a++){var g=c[a];if(g!==""&&g!=="\0"){var h=parseInt(g.split(":")[2]);if(isNaN(h))throw new Error(t("Could not parse error: %s",g));n[h]=g}}var y=p(f).split(`
`);for(a=0;a<y.length;a++)if(n[a+3]||n[a+2]||n[a+1]){var v=y[a];if(o+=v+`
`,n[a+1]){var _=n[a+1];_=_.substr(_.split(":",3).join(":").length+1).trim(),o+=t(`^^^ %s

`,_)}}return{long:o.trim(),short:i.trim()}}},{"add-line-numbers":72,"gl-constants/lookup":266,"glsl-shader-name":426,"sprintf-js":553}],272:[function(r,O,B){O.exports=function(i,c){var n=i.gl,a=p(n,f.vertex,f.fragment),g=p(n,f.pickVertex,f.pickFragment),h=e(n),y=e(n),v=e(n),_=e(n),x=new u(i,a,g,h,y,v,_);return x.update(c),i.addObject(x),x};var t=r("binary-search-bounds"),d=r("iota-array"),m=r("typedarray-pool"),p=r("gl-shader"),e=r("gl-buffer"),f=r("./lib/shaders");function u(i,c,n,a,g,h,y){this.plot=i,this.shader=c,this.pickShader=n,this.positionBuffer=a,this.weightBuffer=g,this.colorBuffer=h,this.idBuffer=y,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var s,l=u.prototype,o=[0,0,1,0,0,1,1,0,1,1,0,1];l.draw=(s=[1,0,0,0,1,0,0,0,1],function(){var i=this.plot,c=this.shader,n=this.bounds,a=this.numVertices;if(!(a<=0)){var g=i.gl,h=i.dataBox,y=n[2]-n[0],v=n[3]-n[1],_=h[2]-h[0],x=h[3]-h[1];s[0]=2*y/_,s[4]=2*v/x,s[6]=2*(n[0]-h[0])/_-1,s[7]=2*(n[1]-h[1])/x-1,c.bind();var T=c.uniforms;T.viewTransform=s,T.shape=this.shape;var A=c.attributes;this.positionBuffer.bind(),A.position.pointer(),this.weightBuffer.bind(),A.weight.pointer(g.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),A.color.pointer(g.UNSIGNED_BYTE,!0),g.drawArrays(g.TRIANGLES,0,a)}}),l.drawPick=function(){var i=[1,0,0,0,1,0,0,0,1],c=[0,0,0,0];return function(n){var a=this.plot,g=this.pickShader,h=this.bounds,y=this.numVertices;if(!(y<=0)){var v=a.gl,_=a.dataBox,x=h[2]-h[0],T=h[3]-h[1],A=_[2]-_[0],S=_[3]-_[1];i[0]=2*x/A,i[4]=2*T/S,i[6]=2*(h[0]-_[0])/A-1,i[7]=2*(h[1]-_[1])/S-1;for(var w=0;w<4;++w)c[w]=n>>8*w&255;this.pickOffset=n,g.bind();var C=g.uniforms;C.viewTransform=i,C.pickOffset=c,C.shape=this.shape;var k=g.attributes;return this.positionBuffer.bind(),k.position.pointer(),this.weightBuffer.bind(),k.weight.pointer(v.UNSIGNED_BYTE,!1),this.idBuffer.bind(),k.pickId.pointer(v.UNSIGNED_BYTE,!1),v.drawArrays(v.TRIANGLES,0,y),n+this.shape[0]*this.shape[1]}}}(),l.pick=function(i,c,n){var a=this.pickOffset,g=this.shape[0]*this.shape[1];if(n<a||n>=a+g)return null;var h=n-a,y=this.xData,v=this.yData;return{object:this,pointId:h,dataCoord:[y[h%this.shape[0]],v[h/this.shape[0]|0]]}},l.update=function(i){var c=(i=i||{}).shape||[0,0],n=i.x||d(c[0]),a=i.y||d(c[1]),g=i.z||new Float32Array(c[0]*c[1]),h=i.zsmooth!==!1;this.xData=n,this.yData=a;var y,v,_,x,T=i.colorLevels||[0],A=i.colorValues||[0,0,0,1],S=T.length,w=this.bounds;h?(y=w[0]=n[0],v=w[1]=a[0],_=w[2]=n[n.length-1],x=w[3]=a[a.length-1]):(y=w[0]=n[0]+(n[1]-n[0])/2,v=w[1]=a[0]+(a[1]-a[0])/2,_=w[2]=n[n.length-1]+(n[n.length-1]-n[n.length-2])/2,x=w[3]=a[a.length-1]+(a[a.length-1]-a[a.length-2])/2);var C=1/(_-y),k=1/(x-v),L=c[0],M=c[1];this.shape=[L,M];var P=(h?(L-1)*(M-1):L*M)*(o.length>>>1);this.numVertices=P;for(var D=m.mallocUint8(4*P),N=m.mallocFloat32(2*P),U=m.mallocUint8(2*P),q=m.mallocUint32(P),X=0,K=h?L-1:L,Z=h?M-1:M,H=0;H<Z;++H){var Y,$;h?(Y=k*(a[H]-v),$=k*(a[H+1]-v)):(Y=H<M-1?k*(a[H]-(a[H+1]-a[H])/2-v):k*(a[H]-(a[H]-a[H-1])/2-v),$=H<M-1?k*(a[H]+(a[H+1]-a[H])/2-v):k*(a[H]+(a[H]-a[H-1])/2-v));for(var z=0;z<K;++z){var j,W;h?(j=C*(n[z]-y),W=C*(n[z+1]-y)):(j=z<L-1?C*(n[z]-(n[z+1]-n[z])/2-y):C*(n[z]-(n[z]-n[z-1])/2-y),W=z<L-1?C*(n[z]+(n[z+1]-n[z])/2-y):C*(n[z]+(n[z]-n[z-1])/2-y));for(var ee=0;ee<o.length;ee+=2){var J,Q,te,ie,ae=o[ee],he=o[ee+1],se=g[h?(H+he)*L+(z+ae):H*L+z],de=t.le(T,se);if(de<0)J=A[0],Q=A[1],te=A[2],ie=A[3];else if(de===S-1)J=A[4*S-4],Q=A[4*S-3],te=A[4*S-2],ie=A[4*S-1];else{var ue=(se-T[de])/(T[de+1]-T[de]),ve=1-ue,ke=4*de,Ee=4*(de+1);J=ve*A[ke]+ue*A[Ee],Q=ve*A[ke+1]+ue*A[Ee+1],te=ve*A[ke+2]+ue*A[Ee+2],ie=ve*A[ke+3]+ue*A[Ee+3]}D[4*X]=255*J,D[4*X+1]=255*Q,D[4*X+2]=255*te,D[4*X+3]=255*ie,N[2*X]=.5*j+.5*W,N[2*X+1]=.5*Y+.5*$,U[2*X]=ae,U[2*X+1]=he,q[X]=H*L+z,X+=1}}}this.positionBuffer.update(N),this.weightBuffer.update(U),this.colorBuffer.update(D),this.idBuffer.update(q),m.free(N),m.free(D),m.free(U),m.free(q)},l.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":273,"binary-search-bounds":103,"gl-buffer":261,"gl-shader":332,"iota-array":441,"typedarray-pool":601}],273:[function(r,O,B){var t=r("glslify");O.exports={fragment:t([`precision lowp float;
#define GLSLIFY 1
varying vec4 fragColor;
void main() {
  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);
}
`]),vertex:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 color;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragColor;

void main() {
  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  fragColor = color;
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`]),pickFragment:t([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;
varying vec2 vWeight;

uniform vec2 shape;
uniform vec4 pickOffset;

void main() {
  vec2 d = step(.5, vWeight);
  vec4 id = fragId + pickOffset;
  id.x += d.x + d.y*shape.x;

  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  gl_FragColor = id/255.;
}
`]),pickVertex:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragId;
varying vec2 vWeight;

void main() {
  vWeight = weight;

  fragId = pickId;

  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`])}},{glslify:434}],274:[function(r,O,B){var t=r("glslify"),d=r("gl-shader"),m=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, nextPosition;
attribute float arcLength, lineWidth;
attribute vec4 color;

uniform vec2 screenShape;
uniform float pixelRatio;
uniform mat4 model, view, projection;

varying vec4 fragColor;
varying vec3 worldPosition;
varying float pixelArcLength;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  vec4 startPoint = project(position);
  vec4 endPoint   = project(nextPosition);

  vec2 A = startPoint.xy / startPoint.w;
  vec2 B =   endPoint.xy /   endPoint.w;

  float clipAngle = atan(
    (B.y - A.y) * screenShape.y,
    (B.x - A.x) * screenShape.x
  );

  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(
    sin(clipAngle),
    -cos(clipAngle)
  ) / screenShape;

  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);

  worldPosition = position;
  pixelArcLength = arcLength;
  fragColor = color;
}
`]),p=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3      clipBounds[2];
uniform sampler2D dashTexture;
uniform float     dashScale;
uniform float     opacity;

varying vec3    worldPosition;
varying float   pixelArcLength;
varying vec4    fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;
  if(dashWeight < 0.5) {
    discard;
  }
  gl_FragColor = fragColor * opacity;
}
`]),e=t([`precision highp float;
#define GLSLIFY 1

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl
vec4 packFloat(float v) {
  float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  float e = floor(log2(av));
  float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform float pickId;
uniform vec3 clipBounds[2];

varying vec3 worldPosition;
varying float pixelArcLength;
varying vec4 fragColor;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;

  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);
}`]),f=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];B.createShader=function(u){return d(u,m,p,null,f)},B.createPickShader=function(u){return d(u,m,e,null,f)}},{"gl-shader":332,glslify:276}],275:[function(r,O,B){O.exports=function(y){var v=y.gl||y.scene&&y.scene.gl,_=l(v);_.attributes.position.location=0,_.attributes.nextPosition.location=1,_.attributes.arcLength.location=2,_.attributes.lineWidth.location=3,_.attributes.color.location=4;var x=o(v);x.attributes.position.location=0,x.attributes.nextPosition.location=1,x.attributes.arcLength.location=2,x.attributes.lineWidth.location=3,x.attributes.color.location=4;for(var T=t(v),A=d(v,[{buffer:T,size:3,offset:0,stride:48},{buffer:T,size:3,offset:12,stride:48},{buffer:T,size:1,offset:24,stride:48},{buffer:T,size:1,offset:28,stride:48},{buffer:T,size:4,offset:32,stride:48}]),S=u(new Array(1024),[256,1,4]),w=0;w<1024;++w)S.data[w]=255;var C=m(v,S);C.wrap=v.REPEAT;var k=new g(v,_,x,T,A,C);return k.update(y),k};var t=r("gl-buffer"),d=r("gl-vao"),m=r("gl-texture2d"),p=new Uint8Array(4),e=new Float32Array(p.buffer),f=r("binary-search-bounds"),u=r("ndarray"),s=r("./lib/shaders"),l=s.createShader,o=s.createPickShader,i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function c(y,v){for(var _=0,x=0;x<3;++x){var T=y[x]-v[x];_+=T*T}return Math.sqrt(_)}function n(y){for(var v=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],_=0;_<3;++_)v[0][_]=Math.max(y[0][_],v[0][_]),v[1][_]=Math.min(y[1][_],v[1][_]);return v}function a(y,v,_,x){this.arcLength=y,this.position=v,this.index=_,this.dataCoordinate=x}function g(y,v,_,x,T,A){this.gl=y,this.shader=v,this.pickShader=_,this.buffer=x,this.vao=T,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=A,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var h=g.prototype;h.isTransparent=function(){return this.hasAlpha},h.isOpaque=function(){return!this.hasAlpha},h.pickSlots=1,h.setPickBase=function(y){this.pickId=y},h.drawTransparent=h.draw=function(y){if(this.vertexCount){var v=this.gl,_=this.shader,x=this.vao;_.bind(),_.uniforms={model:y.model||i,view:y.view||i,projection:y.projection||i,clipBounds:n(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[v.drawingBufferWidth,v.drawingBufferHeight],pixelRatio:this.pixelRatio},x.bind(),x.draw(v.TRIANGLE_STRIP,this.vertexCount),x.unbind()}},h.drawPick=function(y){if(this.vertexCount){var v=this.gl,_=this.pickShader,x=this.vao;_.bind(),_.uniforms={model:y.model||i,view:y.view||i,projection:y.projection||i,pickId:this.pickId,clipBounds:n(this.clipBounds),screenShape:[v.drawingBufferWidth,v.drawingBufferHeight],pixelRatio:this.pixelRatio},x.bind(),x.draw(v.TRIANGLE_STRIP,this.vertexCount),x.unbind()}},h.update=function(y){var v,_;this.dirty=!0;var x=!!y.connectGaps;"dashScale"in y&&(this.dashScale=y.dashScale),this.hasAlpha=!1,"opacity"in y&&(this.opacity=+y.opacity,this.opacity<1&&(this.hasAlpha=!0));var T=[],A=[],S=[],w=0,C=0,k=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],L=y.position||y.positions;if(L){var M=y.color||y.colors||[0,0,0,1],P=y.lineWidth||1,D=!1;e:for(v=1;v<L.length;++v){var N,U,q,X=L[v-1],K=L[v];for(A.push(w),S.push(X.slice()),_=0;_<3;++_){if(isNaN(X[_])||isNaN(K[_])||!isFinite(X[_])||!isFinite(K[_])){if(!x&&T.length>0){for(var Z=0;Z<24;++Z)T.push(T[T.length-12]);C+=2,D=!0}continue e}k[0][_]=Math.min(k[0][_],X[_],K[_]),k[1][_]=Math.max(k[1][_],X[_],K[_])}Array.isArray(M[0])?(N=M.length>v-1?M[v-1]:M.length>0?M[M.length-1]:[0,0,0,1],U=M.length>v?M[v]:M.length>0?M[M.length-1]:[0,0,0,1]):N=U=M,N.length===3&&(N=[N[0],N[1],N[2],1]),U.length===3&&(U=[U[0],U[1],U[2],1]),!this.hasAlpha&&N[3]<1&&(this.hasAlpha=!0),q=Array.isArray(P)?P.length>v-1?P[v-1]:P.length>0?P[P.length-1]:[0,0,0,1]:P;var H=w;if(w+=c(X,K),D){for(_=0;_<2;++_)T.push(X[0],X[1],X[2],K[0],K[1],K[2],H,q,N[0],N[1],N[2],N[3]);C+=2,D=!1}T.push(X[0],X[1],X[2],K[0],K[1],K[2],H,q,N[0],N[1],N[2],N[3],X[0],X[1],X[2],K[0],K[1],K[2],H,-q,N[0],N[1],N[2],N[3],K[0],K[1],K[2],X[0],X[1],X[2],w,-q,U[0],U[1],U[2],U[3],K[0],K[1],K[2],X[0],X[1],X[2],w,q,U[0],U[1],U[2],U[3]),C+=4}}if(this.buffer.update(T),A.push(w),S.push(L[L.length-1].slice()),this.bounds=k,this.vertexCount=C,this.points=S,this.arcLength=A,"dashes"in y){var Y=y.dashes.slice();for(Y.unshift(0),v=1;v<Y.length;++v)Y[v]=Y[v-1]+Y[v];var $=u(new Array(1024),[256,1,4]);for(v=0;v<256;++v){for(_=0;_<4;++_)$.set(v,0,_,0);1&f.le(Y,Y[Y.length-1]*v/255)?$.set(v,0,0,0):$.set(v,0,0,255)}this.texture.setPixels($)}},h.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},h.pick=function(y){if(!y||y.id!==this.pickId)return null;var v=function(L,M,P,D){return p[0]=D,p[1]=P,p[2]=M,p[3]=L,e[0]}(y.value[0],y.value[1],y.value[2],0),_=f.le(this.arcLength,v);if(_<0)return null;if(_===this.arcLength.length-1)return new a(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),_);for(var x=this.points[_],T=this.points[Math.min(_+1,this.points.length-1)],A=(v-this.arcLength[_])/(this.arcLength[_+1]-this.arcLength[_]),S=1-A,w=[0,0,0],C=0;C<3;++C)w[C]=S*x[C]+A*T[C];var k=Math.min(A<.5?_:_+1,this.points.length-1);return new a(v,w,k,this.points[k])}},{"./lib/shaders":274,"binary-search-bounds":103,"gl-buffer":261,"gl-texture2d":348,"gl-vao":353,ndarray:472}],276:[function(r,O,B){arguments[4][268][0].apply(B,arguments)},{dup:268}],277:[function(r,O,B){O.exports=function(t,d){var m=d[0],p=d[1],e=d[2],f=d[3],u=d[4],s=d[5],l=d[6],o=d[7],i=d[8],c=d[9],n=d[10],a=d[11],g=d[12],h=d[13],y=d[14],v=d[15];return t[0]=s*(n*v-a*y)-c*(l*v-o*y)+h*(l*a-o*n),t[1]=-(p*(n*v-a*y)-c*(e*v-f*y)+h*(e*a-f*n)),t[2]=p*(l*v-o*y)-s*(e*v-f*y)+h*(e*o-f*l),t[3]=-(p*(l*a-o*n)-s*(e*a-f*n)+c*(e*o-f*l)),t[4]=-(u*(n*v-a*y)-i*(l*v-o*y)+g*(l*a-o*n)),t[5]=m*(n*v-a*y)-i*(e*v-f*y)+g*(e*a-f*n),t[6]=-(m*(l*v-o*y)-u*(e*v-f*y)+g*(e*o-f*l)),t[7]=m*(l*a-o*n)-u*(e*a-f*n)+i*(e*o-f*l),t[8]=u*(c*v-a*h)-i*(s*v-o*h)+g*(s*a-o*c),t[9]=-(m*(c*v-a*h)-i*(p*v-f*h)+g*(p*a-f*c)),t[10]=m*(s*v-o*h)-u*(p*v-f*h)+g*(p*o-f*s),t[11]=-(m*(s*a-o*c)-u*(p*a-f*c)+i*(p*o-f*s)),t[12]=-(u*(c*y-n*h)-i*(s*y-l*h)+g*(s*n-l*c)),t[13]=m*(c*y-n*h)-i*(p*y-e*h)+g*(p*n-e*c),t[14]=-(m*(s*y-l*h)-u*(p*y-e*h)+g*(p*l-e*s)),t[15]=m*(s*n-l*c)-u*(p*n-e*c)+i*(p*l-e*s),t}},{}],278:[function(r,O,B){O.exports=function(t){var d=new Float32Array(16);return d[0]=t[0],d[1]=t[1],d[2]=t[2],d[3]=t[3],d[4]=t[4],d[5]=t[5],d[6]=t[6],d[7]=t[7],d[8]=t[8],d[9]=t[9],d[10]=t[10],d[11]=t[11],d[12]=t[12],d[13]=t[13],d[14]=t[14],d[15]=t[15],d}},{}],279:[function(r,O,B){O.exports=function(t,d){return t[0]=d[0],t[1]=d[1],t[2]=d[2],t[3]=d[3],t[4]=d[4],t[5]=d[5],t[6]=d[6],t[7]=d[7],t[8]=d[8],t[9]=d[9],t[10]=d[10],t[11]=d[11],t[12]=d[12],t[13]=d[13],t[14]=d[14],t[15]=d[15],t}},{}],280:[function(r,O,B){O.exports=function(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],281:[function(r,O,B){O.exports=function(t){var d=t[0],m=t[1],p=t[2],e=t[3],f=t[4],u=t[5],s=t[6],l=t[7],o=t[8],i=t[9],c=t[10],n=t[11],a=t[12],g=t[13],h=t[14],y=t[15];return(d*u-m*f)*(c*y-n*h)-(d*s-p*f)*(i*y-n*g)+(d*l-e*f)*(i*h-c*g)+(m*s-p*u)*(o*y-n*a)-(m*l-e*u)*(o*h-c*a)+(p*l-e*s)*(o*g-i*a)}},{}],282:[function(r,O,B){O.exports=function(t,d){var m=d[0],p=d[1],e=d[2],f=d[3],u=m+m,s=p+p,l=e+e,o=m*u,i=p*u,c=p*s,n=e*u,a=e*s,g=e*l,h=f*u,y=f*s,v=f*l;return t[0]=1-c-g,t[1]=i+v,t[2]=n-y,t[3]=0,t[4]=i-v,t[5]=1-o-g,t[6]=a+h,t[7]=0,t[8]=n+y,t[9]=a-h,t[10]=1-o-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],283:[function(r,O,B){O.exports=function(t,d,m){var p,e,f,u=m[0],s=m[1],l=m[2],o=Math.sqrt(u*u+s*s+l*l);return Math.abs(o)<1e-6?null:(u*=o=1/o,s*=o,l*=o,p=Math.sin(d),e=Math.cos(d),f=1-e,t[0]=u*u*f+e,t[1]=s*u*f+l*p,t[2]=l*u*f-s*p,t[3]=0,t[4]=u*s*f-l*p,t[5]=s*s*f+e,t[6]=l*s*f+u*p,t[7]=0,t[8]=u*l*f+s*p,t[9]=s*l*f-u*p,t[10]=l*l*f+e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}},{}],284:[function(r,O,B){O.exports=function(t,d,m){var p=d[0],e=d[1],f=d[2],u=d[3],s=p+p,l=e+e,o=f+f,i=p*s,c=p*l,n=p*o,a=e*l,g=e*o,h=f*o,y=u*s,v=u*l,_=u*o;return t[0]=1-(a+h),t[1]=c+_,t[2]=n-v,t[3]=0,t[4]=c-_,t[5]=1-(i+h),t[6]=g+y,t[7]=0,t[8]=n+v,t[9]=g-y,t[10]=1-(i+a),t[11]=0,t[12]=m[0],t[13]=m[1],t[14]=m[2],t[15]=1,t}},{}],285:[function(r,O,B){O.exports=function(t,d){return t[0]=d[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=d[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=d[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],286:[function(r,O,B){O.exports=function(t,d){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=d[0],t[13]=d[1],t[14]=d[2],t[15]=1,t}},{}],287:[function(r,O,B){O.exports=function(t,d){var m=Math.sin(d),p=Math.cos(d);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=p,t[6]=m,t[7]=0,t[8]=0,t[9]=-m,t[10]=p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],288:[function(r,O,B){O.exports=function(t,d){var m=Math.sin(d),p=Math.cos(d);return t[0]=p,t[1]=0,t[2]=-m,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=m,t[9]=0,t[10]=p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],289:[function(r,O,B){O.exports=function(t,d){var m=Math.sin(d),p=Math.cos(d);return t[0]=p,t[1]=m,t[2]=0,t[3]=0,t[4]=-m,t[5]=p,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],290:[function(r,O,B){O.exports=function(t,d,m,p,e,f,u){var s=1/(m-d),l=1/(e-p),o=1/(f-u);return t[0]=2*f*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*f*l,t[6]=0,t[7]=0,t[8]=(m+d)*s,t[9]=(e+p)*l,t[10]=(u+f)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=u*f*2*o,t[15]=0,t}},{}],291:[function(r,O,B){O.exports=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],292:[function(r,O,B){O.exports={create:r("./create"),clone:r("./clone"),copy:r("./copy"),identity:r("./identity"),transpose:r("./transpose"),invert:r("./invert"),adjoint:r("./adjoint"),determinant:r("./determinant"),multiply:r("./multiply"),translate:r("./translate"),scale:r("./scale"),rotate:r("./rotate"),rotateX:r("./rotateX"),rotateY:r("./rotateY"),rotateZ:r("./rotateZ"),fromRotation:r("./fromRotation"),fromRotationTranslation:r("./fromRotationTranslation"),fromScaling:r("./fromScaling"),fromTranslation:r("./fromTranslation"),fromXRotation:r("./fromXRotation"),fromYRotation:r("./fromYRotation"),fromZRotation:r("./fromZRotation"),fromQuat:r("./fromQuat"),frustum:r("./frustum"),perspective:r("./perspective"),perspectiveFromFieldOfView:r("./perspectiveFromFieldOfView"),ortho:r("./ortho"),lookAt:r("./lookAt"),str:r("./str")}},{"./adjoint":277,"./clone":278,"./copy":279,"./create":280,"./determinant":281,"./fromQuat":282,"./fromRotation":283,"./fromRotationTranslation":284,"./fromScaling":285,"./fromTranslation":286,"./fromXRotation":287,"./fromYRotation":288,"./fromZRotation":289,"./frustum":290,"./identity":291,"./invert":293,"./lookAt":294,"./multiply":295,"./ortho":296,"./perspective":297,"./perspectiveFromFieldOfView":298,"./rotate":299,"./rotateX":300,"./rotateY":301,"./rotateZ":302,"./scale":303,"./str":304,"./translate":305,"./transpose":306}],293:[function(r,O,B){O.exports=function(t,d){var m=d[0],p=d[1],e=d[2],f=d[3],u=d[4],s=d[5],l=d[6],o=d[7],i=d[8],c=d[9],n=d[10],a=d[11],g=d[12],h=d[13],y=d[14],v=d[15],_=m*s-p*u,x=m*l-e*u,T=m*o-f*u,A=p*l-e*s,S=p*o-f*s,w=e*o-f*l,C=i*h-c*g,k=i*y-n*g,L=i*v-a*g,M=c*y-n*h,P=c*v-a*h,D=n*v-a*y,N=_*D-x*P+T*M+A*L-S*k+w*C;return N?(N=1/N,t[0]=(s*D-l*P+o*M)*N,t[1]=(e*P-p*D-f*M)*N,t[2]=(h*w-y*S+v*A)*N,t[3]=(n*S-c*w-a*A)*N,t[4]=(l*L-u*D-o*k)*N,t[5]=(m*D-e*L+f*k)*N,t[6]=(y*T-g*w-v*x)*N,t[7]=(i*w-n*T+a*x)*N,t[8]=(u*P-s*L+o*C)*N,t[9]=(p*L-m*P-f*C)*N,t[10]=(g*S-h*T+v*_)*N,t[11]=(c*T-i*S-a*_)*N,t[12]=(s*k-u*M-l*C)*N,t[13]=(m*M-p*k+e*C)*N,t[14]=(h*x-g*A-y*_)*N,t[15]=(i*A-c*x+n*_)*N,t):null}},{}],294:[function(r,O,B){var t=r("./identity");O.exports=function(d,m,p,e){var f,u,s,l,o,i,c,n,a,g,h=m[0],y=m[1],v=m[2],_=e[0],x=e[1],T=e[2],A=p[0],S=p[1],w=p[2];return Math.abs(h-A)<1e-6&&Math.abs(y-S)<1e-6&&Math.abs(v-w)<1e-6?t(d):(c=h-A,n=y-S,a=v-w,g=1/Math.sqrt(c*c+n*n+a*a),f=x*(a*=g)-T*(n*=g),u=T*(c*=g)-_*a,s=_*n-x*c,(g=Math.sqrt(f*f+u*u+s*s))?(f*=g=1/g,u*=g,s*=g):(f=0,u=0,s=0),l=n*s-a*u,o=a*f-c*s,i=c*u-n*f,(g=Math.sqrt(l*l+o*o+i*i))?(l*=g=1/g,o*=g,i*=g):(l=0,o=0,i=0),d[0]=f,d[1]=l,d[2]=c,d[3]=0,d[4]=u,d[5]=o,d[6]=n,d[7]=0,d[8]=s,d[9]=i,d[10]=a,d[11]=0,d[12]=-(f*h+u*y+s*v),d[13]=-(l*h+o*y+i*v),d[14]=-(c*h+n*y+a*v),d[15]=1,d)}},{"./identity":291}],295:[function(r,O,B){O.exports=function(t,d,m){var p=d[0],e=d[1],f=d[2],u=d[3],s=d[4],l=d[5],o=d[6],i=d[7],c=d[8],n=d[9],a=d[10],g=d[11],h=d[12],y=d[13],v=d[14],_=d[15],x=m[0],T=m[1],A=m[2],S=m[3];return t[0]=x*p+T*s+A*c+S*h,t[1]=x*e+T*l+A*n+S*y,t[2]=x*f+T*o+A*a+S*v,t[3]=x*u+T*i+A*g+S*_,x=m[4],T=m[5],A=m[6],S=m[7],t[4]=x*p+T*s+A*c+S*h,t[5]=x*e+T*l+A*n+S*y,t[6]=x*f+T*o+A*a+S*v,t[7]=x*u+T*i+A*g+S*_,x=m[8],T=m[9],A=m[10],S=m[11],t[8]=x*p+T*s+A*c+S*h,t[9]=x*e+T*l+A*n+S*y,t[10]=x*f+T*o+A*a+S*v,t[11]=x*u+T*i+A*g+S*_,x=m[12],T=m[13],A=m[14],S=m[15],t[12]=x*p+T*s+A*c+S*h,t[13]=x*e+T*l+A*n+S*y,t[14]=x*f+T*o+A*a+S*v,t[15]=x*u+T*i+A*g+S*_,t}},{}],296:[function(r,O,B){O.exports=function(t,d,m,p,e,f,u){var s=1/(d-m),l=1/(p-e),o=1/(f-u);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*o,t[11]=0,t[12]=(d+m)*s,t[13]=(e+p)*l,t[14]=(u+f)*o,t[15]=1,t}},{}],297:[function(r,O,B){O.exports=function(t,d,m,p,e){var f=1/Math.tan(d/2),u=1/(p-e);return t[0]=f/m,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(e+p)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*e*p*u,t[15]=0,t}},{}],298:[function(r,O,B){O.exports=function(t,d,m,p){var e=Math.tan(d.upDegrees*Math.PI/180),f=Math.tan(d.downDegrees*Math.PI/180),u=Math.tan(d.leftDegrees*Math.PI/180),s=Math.tan(d.rightDegrees*Math.PI/180),l=2/(u+s),o=2/(e+f);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=-(u-s)*l*.5,t[9]=(e-f)*o*.5,t[10]=p/(m-p),t[11]=-1,t[12]=0,t[13]=0,t[14]=p*m/(m-p),t[15]=0,t}},{}],299:[function(r,O,B){O.exports=function(t,d,m,p){var e,f,u,s,l,o,i,c,n,a,g,h,y,v,_,x,T,A,S,w,C,k,L,M,P=p[0],D=p[1],N=p[2],U=Math.sqrt(P*P+D*D+N*N);return Math.abs(U)<1e-6?null:(P*=U=1/U,D*=U,N*=U,e=Math.sin(m),f=Math.cos(m),u=1-f,s=d[0],l=d[1],o=d[2],i=d[3],c=d[4],n=d[5],a=d[6],g=d[7],h=d[8],y=d[9],v=d[10],_=d[11],x=P*P*u+f,T=D*P*u+N*e,A=N*P*u-D*e,S=P*D*u-N*e,w=D*D*u+f,C=N*D*u+P*e,k=P*N*u+D*e,L=D*N*u-P*e,M=N*N*u+f,t[0]=s*x+c*T+h*A,t[1]=l*x+n*T+y*A,t[2]=o*x+a*T+v*A,t[3]=i*x+g*T+_*A,t[4]=s*S+c*w+h*C,t[5]=l*S+n*w+y*C,t[6]=o*S+a*w+v*C,t[7]=i*S+g*w+_*C,t[8]=s*k+c*L+h*M,t[9]=l*k+n*L+y*M,t[10]=o*k+a*L+v*M,t[11]=i*k+g*L+_*M,d!==t&&(t[12]=d[12],t[13]=d[13],t[14]=d[14],t[15]=d[15]),t)}},{}],300:[function(r,O,B){O.exports=function(t,d,m){var p=Math.sin(m),e=Math.cos(m),f=d[4],u=d[5],s=d[6],l=d[7],o=d[8],i=d[9],c=d[10],n=d[11];return d!==t&&(t[0]=d[0],t[1]=d[1],t[2]=d[2],t[3]=d[3],t[12]=d[12],t[13]=d[13],t[14]=d[14],t[15]=d[15]),t[4]=f*e+o*p,t[5]=u*e+i*p,t[6]=s*e+c*p,t[7]=l*e+n*p,t[8]=o*e-f*p,t[9]=i*e-u*p,t[10]=c*e-s*p,t[11]=n*e-l*p,t}},{}],301:[function(r,O,B){O.exports=function(t,d,m){var p=Math.sin(m),e=Math.cos(m),f=d[0],u=d[1],s=d[2],l=d[3],o=d[8],i=d[9],c=d[10],n=d[11];return d!==t&&(t[4]=d[4],t[5]=d[5],t[6]=d[6],t[7]=d[7],t[12]=d[12],t[13]=d[13],t[14]=d[14],t[15]=d[15]),t[0]=f*e-o*p,t[1]=u*e-i*p,t[2]=s*e-c*p,t[3]=l*e-n*p,t[8]=f*p+o*e,t[9]=u*p+i*e,t[10]=s*p+c*e,t[11]=l*p+n*e,t}},{}],302:[function(r,O,B){O.exports=function(t,d,m){var p=Math.sin(m),e=Math.cos(m),f=d[0],u=d[1],s=d[2],l=d[3],o=d[4],i=d[5],c=d[6],n=d[7];return d!==t&&(t[8]=d[8],t[9]=d[9],t[10]=d[10],t[11]=d[11],t[12]=d[12],t[13]=d[13],t[14]=d[14],t[15]=d[15]),t[0]=f*e+o*p,t[1]=u*e+i*p,t[2]=s*e+c*p,t[3]=l*e+n*p,t[4]=o*e-f*p,t[5]=i*e-u*p,t[6]=c*e-s*p,t[7]=n*e-l*p,t}},{}],303:[function(r,O,B){O.exports=function(t,d,m){var p=m[0],e=m[1],f=m[2];return t[0]=d[0]*p,t[1]=d[1]*p,t[2]=d[2]*p,t[3]=d[3]*p,t[4]=d[4]*e,t[5]=d[5]*e,t[6]=d[6]*e,t[7]=d[7]*e,t[8]=d[8]*f,t[9]=d[9]*f,t[10]=d[10]*f,t[11]=d[11]*f,t[12]=d[12],t[13]=d[13],t[14]=d[14],t[15]=d[15],t}},{}],304:[function(r,O,B){O.exports=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}},{}],305:[function(r,O,B){O.exports=function(t,d,m){var p,e,f,u,s,l,o,i,c,n,a,g,h=m[0],y=m[1],v=m[2];return d===t?(t[12]=d[0]*h+d[4]*y+d[8]*v+d[12],t[13]=d[1]*h+d[5]*y+d[9]*v+d[13],t[14]=d[2]*h+d[6]*y+d[10]*v+d[14],t[15]=d[3]*h+d[7]*y+d[11]*v+d[15]):(p=d[0],e=d[1],f=d[2],u=d[3],s=d[4],l=d[5],o=d[6],i=d[7],c=d[8],n=d[9],a=d[10],g=d[11],t[0]=p,t[1]=e,t[2]=f,t[3]=u,t[4]=s,t[5]=l,t[6]=o,t[7]=i,t[8]=c,t[9]=n,t[10]=a,t[11]=g,t[12]=p*h+s*y+c*v+d[12],t[13]=e*h+l*y+n*v+d[13],t[14]=f*h+o*y+a*v+d[14],t[15]=u*h+i*y+g*v+d[15]),t}},{}],306:[function(r,O,B){O.exports=function(t,d){if(t===d){var m=d[1],p=d[2],e=d[3],f=d[6],u=d[7],s=d[11];t[1]=d[4],t[2]=d[8],t[3]=d[12],t[4]=m,t[6]=d[9],t[7]=d[13],t[8]=p,t[9]=f,t[11]=d[14],t[12]=e,t[13]=u,t[14]=s}else t[0]=d[0],t[1]=d[4],t[2]=d[8],t[3]=d[12],t[4]=d[1],t[5]=d[5],t[6]=d[9],t[7]=d[13],t[8]=d[2],t[9]=d[6],t[10]=d[10],t[11]=d[14],t[12]=d[3],t[13]=d[7],t[14]=d[11],t[15]=d[15];return t}},{}],307:[function(r,O,B){var t=r("barycentric"),d=r("polytope-closest-point/lib/closest_point_2d.js");function m(f,u){for(var s=[0,0,0,0],l=0;l<4;++l)for(var o=0;o<4;++o)s[o]+=f[4*l+o]*u[l];return s}function p(f,u,s,l,o){for(var i=m(l,m(s,m(u,[f[0],f[1],f[2],1]))),c=0;c<3;++c)i[c]/=i[3];return[.5*o[0]*(1+i[0]),.5*o[1]*(1-i[1])]}function e(f,u){for(var s=[0,0,0],l=0;l<f.length;++l)for(var o=f[l],i=u[l],c=0;c<3;++c)s[c]+=i*o[c];return s}O.exports=function(f,u,s,l,o,i){if(f.length===1)return[0,f[0].slice()];for(var c=new Array(f.length),n=0;n<f.length;++n)c[n]=p(f[n],s,l,o,i);var a=0,g=1/0;for(n=0;n<c.length;++n){for(var h=0,y=0;y<2;++y)h+=Math.pow(c[n][y]-u[y],2);h<g&&(g=h,a=n)}var v=function(x,T){if(x.length===2){for(var A=0,S=0,w=0;w<2;++w)A+=Math.pow(T[w]-x[0][w],2),S+=Math.pow(T[w]-x[1][w],2);return A=Math.sqrt(A),S=Math.sqrt(S),A+S<1e-6?[1,0]:[S/(A+S),A/(S+A)]}if(x.length===3){var C=[0,0];return d(x[0],x[1],x[2],T,C),t(x,C)}return[]}(c,u),_=0;for(n=0;n<3;++n){if(v[n]<-.001||v[n]>1.0001)return null;_+=v[n]}return Math.abs(_-1)>.001?null:[a,e(f,v),v]}},{barycentric:85,"polytope-closest-point/lib/closest_point_2d.js":498}],308:[function(r,O,B){var t=r("glslify"),d=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, normal;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model
           , view
           , projection
           , inverseModel;
uniform vec3 eyePosition
           , lightPosition;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  gl_Position      = project(position);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * vec4(position , 1.0);
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  f_color          = color;
  f_data           = position;
  f_uv             = uv;
}
`]),m=t([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness
            , fresnel
            , kambient
            , kdiffuse
            , kspecular;
uniform sampler2D texture;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (f_color.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], f_data)
  ) discard;

  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d

  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * f_color.a;
}
`]),p=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model, view, projection;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_color = color;
  f_data  = position;
  f_uv    = uv;
}`]),e=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;

  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),f=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;
attribute float pointSize;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);
  } else {
    gl_Position = projection * view * model * vec4(position, 1.0);
  }
  gl_PointSize = pointSize;
  f_color = color;
  f_uv = uv;
}`]),u=t([`precision highp float;
#define GLSLIFY 1

uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);
  if(dot(pointR, pointR) > 0.25) {
    discard;
  }
  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),s=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 id;

uniform mat4 model, view, projection;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_id        = id;
  f_position  = position;
}`]),l=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]),o=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3  position;
attribute float pointSize;
attribute vec4  id;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);
  } else {
    gl_Position  = projection * view * model * vec4(position, 1.0);
    gl_PointSize = pointSize;
  }
  f_id         = id;
  f_position   = position;
}`]),i=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
}`]),c=t([`precision highp float;
#define GLSLIFY 1

uniform vec3 contourColor;

void main() {
  gl_FragColor = vec4(contourColor, 1.0);
}
`]);B.meshShader={vertex:d,fragment:m,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},B.wireShader={vertex:p,fragment:e,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},B.pointShader={vertex:f,fragment:u,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},B.pickShader={vertex:s,fragment:l,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},B.pointPickShader={vertex:o,fragment:l,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},B.contourShader={vertex:i,fragment:c,attributes:[{name:"position",type:"vec3"}]}},{glslify:434}],309:[function(r,O,B){var t=r("gl-shader"),d=r("gl-buffer"),m=r("gl-vao"),p=r("gl-texture2d"),e=r("normals"),f=r("gl-mat4/multiply"),u=r("gl-mat4/invert"),s=r("ndarray"),l=r("colormap"),o=r("simplicial-complex-contour"),i=r("typedarray-pool"),c=r("./lib/shaders"),n=r("./lib/closest-point"),a=c.meshShader,g=c.wireShader,h=c.pointShader,y=c.pickShader,v=c.pointPickShader,_=c.contourShader,x=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function T(D,N,U,q,X,K,Z,H,Y,$,z,j,W,ee,J,Q,te,ie,ae,he,se,de,ue,ve,ke,Ee,be){this.gl=D,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=N,this.dirty=!0,this.triShader=U,this.lineShader=q,this.pointShader=X,this.pickShader=K,this.pointPickShader=Z,this.contourShader=H,this.trianglePositions=Y,this.triangleColors=z,this.triangleNormals=W,this.triangleUVs=j,this.triangleIds=$,this.triangleVAO=ee,this.triangleCount=0,this.lineWidth=1,this.edgePositions=J,this.edgeColors=te,this.edgeUVs=ie,this.edgeIds=Q,this.edgeVAO=ae,this.edgeCount=0,this.pointPositions=he,this.pointColors=de,this.pointUVs=ue,this.pointSizes=ve,this.pointIds=se,this.pointVAO=ke,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=Ee,this.contourVAO=be,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=x,this._view=x,this._projection=x,this._resolution=[1,1]}var A=T.prototype;function S(D,N){if(!N||!N.length)return 1;for(var U=0;U<N.length;++U){if(N.length<2)return 1;if(N[U][0]===D)return N[U][1];if(N[U][0]>D&&U>0){var q=(N[U][0]-D)/(N[U][0]-N[U-1][0]);return N[U][1]*(1-q)+q*N[U-1][1]}}return 1}function w(D){var N=t(D,a.vertex,a.fragment);return N.attributes.position.location=0,N.attributes.color.location=2,N.attributes.uv.location=3,N.attributes.normal.location=4,N}function C(D){var N=t(D,g.vertex,g.fragment);return N.attributes.position.location=0,N.attributes.color.location=2,N.attributes.uv.location=3,N}function k(D){var N=t(D,h.vertex,h.fragment);return N.attributes.position.location=0,N.attributes.color.location=2,N.attributes.uv.location=3,N.attributes.pointSize.location=4,N}function L(D){var N=t(D,y.vertex,y.fragment);return N.attributes.position.location=0,N.attributes.id.location=1,N}function M(D){var N=t(D,v.vertex,v.fragment);return N.attributes.position.location=0,N.attributes.id.location=1,N.attributes.pointSize.location=4,N}function P(D){var N=t(D,_.vertex,_.fragment);return N.attributes.position.location=0,N}A.isOpaque=function(){return!this.hasAlpha},A.isTransparent=function(){return this.hasAlpha},A.pickSlots=1,A.setPickBase=function(D){this.pickId=D},A.highlight=function(D){if(D&&this.contourEnable){for(var N=o(this.cells,this.intensity,D.intensity),U=N.cells,q=N.vertexIds,X=N.vertexWeights,K=U.length,Z=i.mallocFloat32(6*K),H=0,Y=0;Y<K;++Y)for(var $=U[Y],z=0;z<2;++z){var j=$[0];$.length===2&&(j=$[z]);for(var W=q[j][0],ee=q[j][1],J=X[j],Q=1-J,te=this.positions[W],ie=this.positions[ee],ae=0;ae<3;++ae)Z[H++]=J*te[ae]+Q*ie[ae]}this.contourCount=H/3|0,this.contourPositions.update(Z.subarray(0,H)),i.free(Z)}else this.contourCount=0},A.update=function(D){D=D||{};var N=this.gl;this.dirty=!0,"contourEnable"in D&&(this.contourEnable=D.contourEnable),"contourColor"in D&&(this.contourColor=D.contourColor),"lineWidth"in D&&(this.lineWidth=D.lineWidth),"lightPosition"in D&&(this.lightPosition=D.lightPosition),this.hasAlpha=!1,"opacity"in D&&(this.opacity=D.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in D&&(this.opacityscale=D.opacityscale,this.hasAlpha=!0),"ambient"in D&&(this.ambientLight=D.ambient),"diffuse"in D&&(this.diffuseLight=D.diffuse),"specular"in D&&(this.specularLight=D.specular),"roughness"in D&&(this.roughness=D.roughness),"fresnel"in D&&(this.fresnel=D.fresnel),D.texture?(this.texture.dispose(),this.texture=p(N,D.texture)):D.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=N.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=N.LINEAR,this.texture.setPixels(function(at,tt){for(var _t=l({colormap:at,nshades:256,format:"rgba"}),er=new Uint8Array(1024),tr=0;tr<256;++tr){for(var Ue=_t[tr],He=0;He<3;++He)er[4*tr+He]=Ue[He];er[4*tr+3]=tt?255*S(tr/255,tt):255*Ue[3]}return s(er,[256,256,4],[4,0,1])}(D.colormap,this.opacityscale)),this.texture.generateMipmap());var U=D.cells,q=D.positions;if(q&&U){var X=[],K=[],Z=[],H=[],Y=[],$=[],z=[],j=[],W=[],ee=[],J=[],Q=[],te=[],ie=[];this.cells=U,this.positions=q;var ae=D.vertexNormals,he=D.cellNormals,se=D.vertexNormalsEpsilon===void 0?1e-6:D.vertexNormalsEpsilon,de=D.faceNormalsEpsilon===void 0?1e-6:D.faceNormalsEpsilon;D.useFacetNormals&&!he&&(he=e.faceNormals(U,q,de)),he||ae||(ae=e.vertexNormals(U,q,se));var ue=D.vertexColors,ve=D.cellColors,ke=D.meshColor||[1,1,1,1],Ee=D.vertexUVs,be=D.vertexIntensity,xe=D.cellUVs,ce=D.cellIntensity,ge=1/0,we=-1/0;if(!Ee&&!xe)if(be)if(D.vertexIntensityBounds)ge=+D.vertexIntensityBounds[0],we=+D.vertexIntensityBounds[1];else for(var Me=0;Me<be.length;++Me){var Se=be[Me];ge=Math.min(ge,Se),we=Math.max(we,Se)}else if(ce)if(D.cellIntensityBounds)ge=+D.cellIntensityBounds[0],we=+D.cellIntensityBounds[1];else for(Me=0;Me<ce.length;++Me)Se=ce[Me],ge=Math.min(ge,Se),we=Math.max(we,Se);else for(Me=0;Me<q.length;++Me)Se=q[Me][2],ge=Math.min(ge,Se),we=Math.max(we,Se);this.intensity=be||ce||function(at){for(var tt=at.length,_t=new Array(tt),er=0;er<tt;++er)_t[er]=at[er][2];return _t}(q),this.pickVertex=!(ce||ve);var ze=D.pointSizes,Fe=D.pointSize||1;for(this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],Me=0;Me<q.length;++Me)for(var Ye=q[Me],rt=0;rt<3;++rt)!isNaN(Ye[rt])&&isFinite(Ye[rt])&&(this.bounds[0][rt]=Math.min(this.bounds[0][rt],Ye[rt]),this.bounds[1][rt]=Math.max(this.bounds[1][rt],Ye[rt]));var Oe=0,je=0,We=0;e:for(Me=0;Me<U.length;++Me){var qe=U[Me];switch(qe.length){case 1:for(Ye=q[st=qe[0]],rt=0;rt<3;++rt)if(isNaN(Ye[rt])||!isFinite(Ye[rt]))continue e;ee.push(Ye[0],Ye[1],Ye[2]),ct=ue?ue[st]:ve?ve[Me]:ke,this.opacityscale&&be?K.push(ct[0],ct[1],ct[2],this.opacity*S((be[st]-ge)/(we-ge),this.opacityscale)):ct.length===3?J.push(ct[0],ct[1],ct[2],this.opacity):(J.push(ct[0],ct[1],ct[2],ct[3]*this.opacity),ct[3]<1&&(this.hasAlpha=!0)),Pt=Ee?Ee[st]:be?[(be[st]-ge)/(we-ge),0]:xe?xe[Me]:ce?[(ce[Me]-ge)/(we-ge),0]:[(Ye[2]-ge)/(we-ge),0],Q.push(Pt[0],Pt[1]),ze?te.push(ze[st]):te.push(Fe),ie.push(Me),We+=1;break;case 2:for(rt=0;rt<2;++rt){Ye=q[st=qe[rt]];for(var Qe=0;Qe<3;++Qe)if(isNaN(Ye[Qe])||!isFinite(Ye[Qe]))continue e}for(rt=0;rt<2;++rt)Ye=q[st=qe[rt]],$.push(Ye[0],Ye[1],Ye[2]),ct=ue?ue[st]:ve?ve[Me]:ke,this.opacityscale&&be?K.push(ct[0],ct[1],ct[2],this.opacity*S((be[st]-ge)/(we-ge),this.opacityscale)):ct.length===3?z.push(ct[0],ct[1],ct[2],this.opacity):(z.push(ct[0],ct[1],ct[2],ct[3]*this.opacity),ct[3]<1&&(this.hasAlpha=!0)),Pt=Ee?Ee[st]:be?[(be[st]-ge)/(we-ge),0]:xe?xe[Me]:ce?[(ce[Me]-ge)/(we-ge),0]:[(Ye[2]-ge)/(we-ge),0],j.push(Pt[0],Pt[1]),W.push(Me);je+=1;break;case 3:for(rt=0;rt<3;++rt)for(Ye=q[st=qe[rt]],Qe=0;Qe<3;++Qe)if(isNaN(Ye[Qe])||!isFinite(Ye[Qe]))continue e;for(rt=0;rt<3;++rt){var st,ct,Pt,kt;Ye=q[st=qe[2-rt]],X.push(Ye[0],Ye[1],Ye[2]),(ct=ue?ue[st]:ve?ve[Me]:ke)?this.opacityscale&&be?K.push(ct[0],ct[1],ct[2],this.opacity*S((be[st]-ge)/(we-ge),this.opacityscale)):ct.length===3?K.push(ct[0],ct[1],ct[2],this.opacity):(K.push(ct[0],ct[1],ct[2],ct[3]*this.opacity),ct[3]<1&&(this.hasAlpha=!0)):K.push(.5,.5,.5,1),Pt=Ee?Ee[st]:be?[(be[st]-ge)/(we-ge),0]:xe?xe[Me]:ce?[(ce[Me]-ge)/(we-ge),0]:[(Ye[2]-ge)/(we-ge),0],H.push(Pt[0],Pt[1]),kt=ae?ae[st]:he[Me],Z.push(kt[0],kt[1],kt[2]),Y.push(Me)}Oe+=1}}this.pointCount=We,this.edgeCount=je,this.triangleCount=Oe,this.pointPositions.update(ee),this.pointColors.update(J),this.pointUVs.update(Q),this.pointSizes.update(te),this.pointIds.update(new Uint32Array(ie)),this.edgePositions.update($),this.edgeColors.update(z),this.edgeUVs.update(j),this.edgeIds.update(new Uint32Array(W)),this.trianglePositions.update(X),this.triangleColors.update(K),this.triangleUVs.update(H),this.triangleNormals.update(Z),this.triangleIds.update(new Uint32Array(Y))}},A.drawTransparent=A.draw=function(D){D=D||{};for(var N=this.gl,U=D.model||x,q=D.view||x,X=D.projection||x,K=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],Z=0;Z<3;++Z)K[0][Z]=Math.max(K[0][Z],this.clipBounds[0][Z]),K[1][Z]=Math.min(K[1][Z],this.clipBounds[1][Z]);var H={model:U,view:q,projection:X,inverseModel:x.slice(),clipBounds:K,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};H.inverseModel=u(H.inverseModel,H.model),N.disable(N.CULL_FACE),this.texture.bind(0);var Y=new Array(16);for(f(Y,H.view,H.model),f(Y,H.projection,Y),u(Y,Y),Z=0;Z<3;++Z)H.eyePosition[Z]=Y[12+Z]/Y[15];var $,z=Y[15];for(Z=0;Z<3;++Z)z+=this.lightPosition[Z]*Y[4*Z+3];for(Z=0;Z<3;++Z){for(var j=Y[12+Z],W=0;W<3;++W)j+=Y[4*W+Z]*this.lightPosition[W];H.lightPosition[Z]=j/z}this.triangleCount>0&&(($=this.triShader).bind(),$.uniforms=H,this.triangleVAO.bind(),N.drawArrays(N.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&this.lineWidth>0&&(($=this.lineShader).bind(),$.uniforms=H,this.edgeVAO.bind(),N.lineWidth(this.lineWidth*this.pixelRatio),N.drawArrays(N.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&(($=this.pointShader).bind(),$.uniforms=H,this.pointVAO.bind(),N.drawArrays(N.POINTS,0,this.pointCount),this.pointVAO.unbind()),this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&(($=this.contourShader).bind(),$.uniforms=H,this.contourVAO.bind(),N.drawArrays(N.LINES,0,this.contourCount),this.contourVAO.unbind())},A.drawPick=function(D){D=D||{};for(var N=this.gl,U=D.model||x,q=D.view||x,X=D.projection||x,K=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],Z=0;Z<3;++Z)K[0][Z]=Math.max(K[0][Z],this.clipBounds[0][Z]),K[1][Z]=Math.min(K[1][Z],this.clipBounds[1][Z]);this._model=[].slice.call(U),this._view=[].slice.call(q),this._projection=[].slice.call(X),this._resolution=[N.drawingBufferWidth,N.drawingBufferHeight];var H,Y={model:U,view:q,projection:X,clipBounds:K,pickId:this.pickId/255};(H=this.pickShader).bind(),H.uniforms=Y,this.triangleCount>0&&(this.triangleVAO.bind(),N.drawArrays(N.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),N.lineWidth(this.lineWidth*this.pixelRatio),N.drawArrays(N.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((H=this.pointPickShader).bind(),H.uniforms=Y,this.pointVAO.bind(),N.drawArrays(N.POINTS,0,this.pointCount),this.pointVAO.unbind())},A.pick=function(D){if(!D||D.id!==this.pickId)return null;for(var N=D.value[0]+256*D.value[1]+65536*D.value[2],U=this.cells[N],q=this.positions,X=new Array(U.length),K=0;K<U.length;++K)X[K]=q[U[K]];var Z=D.coord[0],H=D.coord[1];if(!this.pickVertex){var Y=this.positions[U[0]],$=this.positions[U[1]],z=this.positions[U[2]],j=[(Y[0]+$[0]+z[0])/3,(Y[1]+$[1]+z[1])/3,(Y[2]+$[2]+z[2])/3];return{_cellCenter:!0,position:[Z,H],index:N,cell:U,cellId:N,intensity:this.intensity[N],dataCoordinate:j}}var W=n(X,[Z*this.pixelRatio,this._resolution[1]-H*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!W)return null;var ee=W[2],J=0;for(K=0;K<U.length;++K)J+=ee[K]*this.intensity[U[K]];return{position:W[1],index:U[W[0]],cell:U,cellId:N,intensity:J,dataCoordinate:this.positions[U[W[0]]]}},A.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},O.exports=function(D,N){arguments.length===1&&(D=(N=D).gl);var U=D.getExtension("OES_standard_derivatives")||D.getExtension("MOZ_OES_standard_derivatives")||D.getExtension("WEBKIT_OES_standard_derivatives");if(!U)throw new Error("derivatives not supported");var q=w(D),X=C(D),K=k(D),Z=L(D),H=M(D),Y=P(D),$=p(D,s(new Uint8Array([255,255,255,255]),[1,1,4]));$.generateMipmap(),$.minFilter=D.LINEAR_MIPMAP_LINEAR,$.magFilter=D.LINEAR;var z=d(D),j=d(D),W=d(D),ee=d(D),J=d(D),Q=m(D,[{buffer:z,type:D.FLOAT,size:3},{buffer:J,type:D.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:j,type:D.FLOAT,size:4},{buffer:W,type:D.FLOAT,size:2},{buffer:ee,type:D.FLOAT,size:3}]),te=d(D),ie=d(D),ae=d(D),he=d(D),se=m(D,[{buffer:te,type:D.FLOAT,size:3},{buffer:he,type:D.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ie,type:D.FLOAT,size:4},{buffer:ae,type:D.FLOAT,size:2}]),de=d(D),ue=d(D),ve=d(D),ke=d(D),Ee=d(D),be=m(D,[{buffer:de,type:D.FLOAT,size:3},{buffer:Ee,type:D.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ue,type:D.FLOAT,size:4},{buffer:ve,type:D.FLOAT,size:2},{buffer:ke,type:D.FLOAT,size:1}]),xe=d(D),ce=m(D,[{buffer:xe,type:D.FLOAT,size:3}]),ge=new T(D,$,q,X,K,Z,H,Y,z,J,j,W,ee,Q,te,he,ie,ae,se,de,Ee,ue,ve,ke,be,xe,ce);return ge.update(N),ge}},{"./lib/closest-point":307,"./lib/shaders":308,colormap:137,"gl-buffer":261,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-shader":332,"gl-texture2d":348,"gl-vao":353,ndarray:472,normals:475,"simplicial-complex-contour":543,"typedarray-pool":601}],310:[function(r,O,B){O.exports=function(s){var l=s.gl,o=t(l,[0,0,0,1,1,0,1,1]),i=d(l,m.boxVert,m.lineFrag);return new p(s,o,i)};var t=r("gl-buffer"),d=r("gl-shader"),m=r("./shaders");function p(s,l,o){this.plot=s,this.vbo=l,this.shader=o}var e,f,u=p.prototype;u.bind=function(){var s=this.shader;this.vbo.bind(),this.shader.bind(),s.attributes.coord.pointer(),s.uniforms.screenBox=this.plot.screenBox},u.drawBox=(e=[0,0],f=[0,0],function(s,l,o,i,c){var n=this.plot,a=this.shader,g=n.gl;e[0]=s,e[1]=l,f[0]=o,f[1]=i,a.uniforms.lo=e,a.uniforms.hi=f,a.uniforms.color=c,g.drawArrays(g.TRIANGLE_STRIP,0,4)}),u.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":313,"gl-buffer":261,"gl-shader":332}],311:[function(r,O,B){O.exports=function(n){var a=n.gl,g=t(a),h=d(a,p.gridVert,p.gridFrag),y=d(a,p.tickVert,p.gridFrag);return new e(n,g,h,y)};var t=r("gl-buffer"),d=r("gl-shader"),m=r("binary-search-bounds"),p=r("./shaders");function e(n,a,g,h){this.plot=n,this.vbo=a,this.shader=g,this.tickShader=h,this.ticks=[[],[]]}function f(n,a){return n-a}var u,s,l,o,i,c=e.prototype;c.draw=(u=[0,0],s=[0,0],l=[0,0],function(){for(var n=this.plot,a=this.vbo,g=this.shader,h=this.ticks,y=n.gl,v=n._tickBounds,_=n.dataBox,x=n.viewBox,T=n.gridLineWidth,A=n.gridLineColor,S=n.gridLineEnable,w=n.pixelRatio,C=0;C<2;++C){var k=v[C],L=v[C+2]-k,M=.5*(_[C+2]+_[C]),P=_[C+2]-_[C];s[C]=2*L/P,u[C]=2*(k-M)/P}g.bind(),a.bind(),g.attributes.dataCoord.pointer(),g.uniforms.dataShift=u,g.uniforms.dataScale=s;var D=0;for(C=0;C<2;++C){l[0]=l[1]=0,l[C]=1,g.uniforms.dataAxis=l,g.uniforms.lineWidth=T[C]/(x[C+2]-x[C])*w,g.uniforms.color=A[C];var N=6*h[C].length;S[C]&&N&&y.drawArrays(y.TRIANGLES,D,N),D+=N}}),c.drawTickMarks=function(){var n=[0,0],a=[0,0],g=[1,0],h=[0,1],y=[0,0],v=[0,0];return function(){for(var _=this.plot,x=this.vbo,T=this.tickShader,A=this.ticks,S=_.gl,w=_._tickBounds,C=_.dataBox,k=_.viewBox,L=_.pixelRatio,M=_.screenBox,P=M[2]-M[0],D=M[3]-M[1],N=k[2]-k[0],U=k[3]-k[1],q=0;q<2;++q){var X=w[q],K=w[q+2]-X,Z=.5*(C[q+2]+C[q]),H=C[q+2]-C[q];a[q]=2*K/H,n[q]=2*(X-Z)/H}a[0]*=N/P,n[0]*=N/P,a[1]*=U/D,n[1]*=U/D,T.bind(),x.bind(),T.attributes.dataCoord.pointer();var Y=T.uniforms;Y.dataShift=n,Y.dataScale=a;var $=_.tickMarkLength,z=_.tickMarkWidth,j=_.tickMarkColor,W=6*A[0].length,ee=Math.min(m.ge(A[0],(C[0]-w[0])/(w[2]-w[0]),f),A[0].length),J=Math.min(m.gt(A[0],(C[2]-w[0])/(w[2]-w[0]),f),A[0].length),Q=0+6*ee,te=6*Math.max(0,J-ee),ie=Math.min(m.ge(A[1],(C[1]-w[1])/(w[3]-w[1]),f),A[1].length),ae=Math.min(m.gt(A[1],(C[3]-w[1])/(w[3]-w[1]),f),A[1].length),he=W+6*ie,se=6*Math.max(0,ae-ie);y[0]=2*(k[0]-$[1])/P-1,y[1]=(k[3]+k[1])/D-1,v[0]=$[1]*L/P,v[1]=z[1]*L/D,se&&(Y.color=j[1],Y.tickScale=v,Y.dataAxis=h,Y.screenOffset=y,S.drawArrays(S.TRIANGLES,he,se)),y[0]=(k[2]+k[0])/P-1,y[1]=2*(k[1]-$[0])/D-1,v[0]=z[0]*L/P,v[1]=$[0]*L/D,te&&(Y.color=j[0],Y.tickScale=v,Y.dataAxis=g,Y.screenOffset=y,S.drawArrays(S.TRIANGLES,Q,te)),y[0]=2*(k[2]+$[3])/P-1,y[1]=(k[3]+k[1])/D-1,v[0]=$[3]*L/P,v[1]=z[3]*L/D,se&&(Y.color=j[3],Y.tickScale=v,Y.dataAxis=h,Y.screenOffset=y,S.drawArrays(S.TRIANGLES,he,se)),y[0]=(k[2]+k[0])/P-1,y[1]=2*(k[3]+$[2])/D-1,v[0]=z[2]*L/P,v[1]=$[2]*L/D,te&&(Y.color=j[2],Y.tickScale=v,Y.dataAxis=g,Y.screenOffset=y,S.drawArrays(S.TRIANGLES,Q,te))}}(),c.update=(o=[1,1,-1,-1,1,-1],i=[1,-1,1,1,-1,-1],function(n){for(var a=n.ticks,g=n.bounds,h=new Float32Array(18*(a[0].length+a[1].length)),y=(this.plot.zeroLineEnable,0),v=[[],[]],_=0;_<2;++_)for(var x=v[_],T=a[_],A=g[_],S=g[_+2],w=0;w<T.length;++w){var C=(T[w].x-A)/(S-A);x.push(C);for(var k=0;k<6;++k)h[y++]=C,h[y++]=o[k],h[y++]=i[k]}this.ticks=v,this.vbo.update(h)}),c.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":313,"binary-search-bounds":103,"gl-buffer":261,"gl-shader":332}],312:[function(r,O,B){O.exports=function(s){var l=s.gl,o=t(l,[-1,-1,-1,1,1,-1,1,1]),i=d(l,m.lineVert,m.lineFrag);return new p(s,o,i)};var t=r("gl-buffer"),d=r("gl-shader"),m=r("./shaders");function p(s,l,o){this.plot=s,this.vbo=l,this.shader=o}var e,f,u=p.prototype;u.bind=function(){var s=this.shader;this.vbo.bind(),this.shader.bind(),s.attributes.coord.pointer(),s.uniforms.screenBox=this.plot.screenBox},u.drawLine=(e=[0,0],f=[0,0],function(s,l,o,i,c,n){var a=this.plot,g=this.shader,h=a.gl;e[0]=s,e[1]=l,f[0]=o,f[1]=i,g.uniforms.start=e,g.uniforms.end=f,g.uniforms.width=c*a.pixelRatio,g.uniforms.color=n,h.drawArrays(h.TRIANGLE_STRIP,0,4)}),u.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":313,"gl-buffer":261,"gl-shader":332}],313:[function(r,O,B){var t=r("glslify"),d=t([`precision lowp float;
#define GLSLIFY 1
uniform vec4 color;
void main() {
  gl_FragColor = vec4(color.xyz * color.w, color.w);
}
`]);O.exports={lineVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 start, end;
uniform float width;

vec2 perp(vec2 v) {
  return vec2(v.y, -v.x);
}

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  vec2 delta = normalize(perp(start - end));
  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));
  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);
}
`]),lineFrag:d,textVert:t([`#define GLSLIFY 1
attribute vec3 textCoordinate;

uniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;
uniform float angle;

void main() {
  float dataOffset  = textCoordinate.z;
  vec2 glyphOffset  = textCoordinate.xy;
  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +
    glyphMatrix * glyphOffset * textScale + screenOffset;
  gl_Position = vec4(screenCoordinate, 0, 1);
}
`]),textFrag:d,gridVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale;
uniform float lineWidth;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;
  gl_Position = vec4(pos, 0, 1);
}
`]),gridFrag:d,boxVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 lo, hi;

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);
}
`]),tickVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);
}
`])}},{glslify:315}],314:[function(r,O,B){O.exports=function(a){var g=a.gl,h=t(g),y=d(g,e.textVert,e.textFrag);return new f(a,h,y)};var t=r("gl-buffer"),d=r("gl-shader"),m=r("text-cache"),p=r("binary-search-bounds"),e=r("./shaders");function f(a,g,h){this.plot=a,this.vbo=g,this.shader=h,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var u,s,l,o,i,c,n=f.prototype;n.drawTicks=(u=[0,0],s=[0,0],l=[0,0],function(a){var g=this.plot,h=this.shader,y=this.tickX[a],v=this.tickOffset[a],_=g.gl,x=g.viewBox,T=g.dataBox,A=g.screenBox,S=g.pixelRatio,w=g.tickEnable,C=g.tickPad,k=g.tickColor,L=g.tickAngle,M=g.labelEnable,P=g.labelPad,D=g.labelColor,N=g.labelAngle,U=this.labelOffset[a],q=this.labelCount[a],X=p.lt(y,T[a]),K=p.le(y,T[a+2]);u[0]=u[1]=0,u[a]=1,s[a]=(x[2+a]+x[a])/(A[2+a]-A[a])-1;var Z=2/A[2+(1^a)]-A[1^a];s[1^a]=Z*x[1^a]-1,w[a]&&(s[1^a]-=Z*S*C[a],X<K&&v[K]>v[X]&&(h.uniforms.dataAxis=u,h.uniforms.screenOffset=s,h.uniforms.color=k[a],h.uniforms.angle=L[a],_.drawArrays(_.TRIANGLES,v[X],v[K]-v[X]))),M[a]&&q&&(s[1^a]-=Z*S*P[a],h.uniforms.dataAxis=l,h.uniforms.screenOffset=s,h.uniforms.color=D[a],h.uniforms.angle=N[a],_.drawArrays(_.TRIANGLES,U,q)),s[1^a]=Z*x[2+(1^a)]-1,w[a+2]&&(s[1^a]+=Z*S*C[a+2],X<K&&v[K]>v[X]&&(h.uniforms.dataAxis=u,h.uniforms.screenOffset=s,h.uniforms.color=k[a+2],h.uniforms.angle=L[a+2],_.drawArrays(_.TRIANGLES,v[X],v[K]-v[X]))),M[a+2]&&q&&(s[1^a]+=Z*S*P[a+2],h.uniforms.dataAxis=l,h.uniforms.screenOffset=s,h.uniforms.color=D[a+2],h.uniforms.angle=N[a+2],_.drawArrays(_.TRIANGLES,U,q))}),n.drawTitle=function(){var a=[0,0],g=[0,0];return function(){var h=this.plot,y=this.shader,v=h.gl,_=h.screenBox,x=h.titleCenter,T=h.titleAngle,A=h.titleColor,S=h.pixelRatio;if(this.titleCount){for(var w=0;w<2;++w)g[w]=2*(x[w]*S-_[w])/(_[2+w]-_[w])-1;y.bind(),y.uniforms.dataAxis=a,y.uniforms.screenOffset=g,y.uniforms.angle=T,y.uniforms.color=A,v.drawArrays(v.TRIANGLES,this.titleOffset,this.titleCount)}}}(),n.bind=(o=[0,0],i=[0,0],c=[0,0],function(){var a=this.plot,g=this.shader,h=a._tickBounds,y=a.dataBox,v=a.screenBox,_=a.viewBox;g.bind();for(var x=0;x<2;++x){var T=h[x],A=h[x+2]-T,S=.5*(y[x+2]+y[x]),w=y[x+2]-y[x],C=_[x],k=_[x+2]-C,L=v[x],M=v[x+2]-L;i[x]=2*A/w*k/M,o[x]=2*(T-S)/w*k/M}c[1]=2*a.pixelRatio/(v[3]-v[1]),c[0]=c[1]*(v[3]-v[1])/(v[2]-v[0]),g.uniforms.dataScale=i,g.uniforms.dataShift=o,g.uniforms.textScale=c,this.vbo.bind(),g.attributes.textCoordinate.pointer()}),n.update=function(a){var g,h,y,v,_,x=[],T=a.ticks,A=a.bounds;for(_=0;_<2;++_){var S=[Math.floor(x.length/3)],w=[-1/0],C=T[_];for(g=0;g<C.length;++g){var k=C[g],L=k.x,M=k.text,P=k.font||"sans-serif";v=k.fontSize||12;for(var D=1/(A[_+2]-A[_]),N=A[_],U=M.split(`
`),q=0;q<U.length;q++)for(y=m(P,U[q]).data,h=0;h<y.length;h+=2)x.push(y[h]*v,-y[h+1]*v-q*v*1.2,(L-N)*D);S.push(Math.floor(x.length/3)),w.push(L)}this.tickOffset[_]=S,this.tickX[_]=w}for(_=0;_<2;++_){for(this.labelOffset[_]=Math.floor(x.length/3),y=m(a.labelFont[_],a.labels[_],{textAlign:"center"}).data,v=a.labelSize[_],g=0;g<y.length;g+=2)x.push(y[g]*v,-y[g+1]*v,0);this.labelCount[_]=Math.floor(x.length/3)-this.labelOffset[_]}for(this.titleOffset=Math.floor(x.length/3),y=m(a.titleFont,a.title).data,v=a.titleSize,g=0;g<y.length;g+=2)x.push(y[g]*v,-y[g+1]*v,0);this.titleCount=Math.floor(x.length/3)-this.titleOffset,this.vbo.update(x)},n.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":313,"binary-search-bounds":103,"gl-buffer":261,"gl-shader":332,"text-cache":581}],315:[function(r,O,B){arguments[4][268][0].apply(B,arguments)},{dup:268}],316:[function(r,O,B){O.exports=function(o){var i=o.gl,c=t(i,[i.drawingBufferWidth,i.drawingBufferHeight]),n=new f(i,c);return n.grid=d(n),n.text=m(n),n.line=p(n),n.box=e(n),n.update(o),n};var t=r("gl-select-static"),d=r("./lib/grid"),m=r("./lib/text"),p=r("./lib/line"),e=r("./lib/box");function f(o,i){this.gl=o,this.pickBuffer=i,this.screenBox=[0,0,o.drawingBufferWidth,o.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var u=f.prototype;function s(o){for(var i=o.slice(),c=0;c<i.length;++c)i[c]=i[c].slice();return i}function l(o,i){return o.x-i.x}u.setDirty=function(){this.dirty=this.pickDirty=!0},u.setOverlayDirty=function(){this.dirty=!0},u.nextDepthValue=function(){return this._depthCounter++/65536},u.draw=function(){var o=this.gl,i=this.screenBox,c=this.viewBox,n=this.dataBox,a=this.pixelRatio,g=this.grid,h=this.line,y=this.text,v=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){if(this.dirty=!1,o.bindFramebuffer(o.FRAMEBUFFER,null),o.enable(o.SCISSOR_TEST),o.disable(o.DEPTH_TEST),o.depthFunc(o.LESS),o.depthMask(!1),o.enable(o.BLEND),o.blendEquation(o.FUNC_ADD,o.FUNC_ADD),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA),this.borderColor){o.scissor(i[0],i[1],i[2]-i[0],i[3]-i[1]);var _=this.borderColor;o.clearColor(_[0]*_[3],_[1]*_[3],_[2]*_[3],_[3]),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT)}o.scissor(c[0],c[1],c[2]-c[0],c[3]-c[1]),o.viewport(c[0],c[1],c[2]-c[0],c[3]-c[1]);var x=this.backgroundColor;o.clearColor(x[0]*x[3],x[1]*x[3],x[2]*x[3],x[3]),o.clear(o.COLOR_BUFFER_BIT),g.draw();var T=this.zeroLineEnable,A=this.zeroLineColor,S=this.zeroLineWidth;if(T[0]||T[1]){h.bind();for(var w=0;w<2;++w)if(T[w]&&n[w]<=0&&n[w+2]>=0){var C=i[w]-n[w]*(i[w+2]-i[w])/(n[w+2]-n[w]);w===0?h.drawLine(C,i[1],C,i[3],S[w],A[w]):h.drawLine(i[0],C,i[2],C,S[w],A[w])}}for(w=0;w<v.length;++w)v[w].draw();o.viewport(i[0],i[1],i[2]-i[0],i[3]-i[1]),o.scissor(i[0],i[1],i[2]-i[0],i[3]-i[1]),this.grid.drawTickMarks(),h.bind();var k=this.borderLineEnable,L=this.borderLineWidth,M=this.borderLineColor;for(k[1]&&h.drawLine(c[0],c[1]-.5*L[1]*a,c[0],c[3]+.5*L[3]*a,L[1],M[1]),k[0]&&h.drawLine(c[0]-.5*L[0]*a,c[1],c[2]+.5*L[2]*a,c[1],L[0],M[0]),k[3]&&h.drawLine(c[2],c[1]-.5*L[1]*a,c[2],c[3]+.5*L[3]*a,L[3],M[3]),k[2]&&h.drawLine(c[0]-.5*L[0]*a,c[3],c[2]+.5*L[2]*a,c[3],L[2],M[2]),y.bind(),w=0;w<2;++w)y.drawTicks(w);this.titleEnable&&y.drawTitle();var P=this.overlays;for(w=0;w<P.length;++w)P[w].draw();o.disable(o.SCISSOR_TEST),o.disable(o.BLEND),o.depthMask(!0)}},u.drawPick=function(){if(!this.static){var o=this.pickBuffer;this.gl,this._pickTimeout=null,o.begin();for(var i=1,c=this.objects,n=0;n<c.length;++n)i=c[n].drawPick(i);o.end()}},u.pick=function(o,i){if(!this.static){var c=this.pixelRatio,n=this.pickPixelRatio,a=this.viewBox,g=0|Math.round((o-a[0]/c)*n),h=0|Math.round((i-a[1]/c)*n),y=this.pickBuffer.query(g,h,this.pickRadius);if(!y)return null;for(var v=y.id+(y.value[0]<<8)+(y.value[1]<<16)+(y.value[2]<<24),_=this.objects,x=0;x<_.length;++x){var T=_[x].pick(g,h,v);if(T)return T}return null}},u.setScreenBox=function(o){var i=this.screenBox,c=this.pixelRatio;i[0]=0|Math.round(o[0]*c),i[1]=0|Math.round(o[1]*c),i[2]=0|Math.round(o[2]*c),i[3]=0|Math.round(o[3]*c),this.setDirty()},u.setDataBox=function(o){var i=this.dataBox;(i[0]!==o[0]||i[1]!==o[1]||i[2]!==o[2]||i[3]!==o[3])&&(i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],this.setDirty())},u.setViewBox=function(o){var i=this.pixelRatio,c=this.viewBox;c[0]=0|Math.round(o[0]*i),c[1]=0|Math.round(o[1]*i),c[2]=0|Math.round(o[2]*i),c[3]=0|Math.round(o[3]*i);var n=this.pickPixelRatio;this.pickBuffer.shape=[0|Math.round((o[2]-o[0])*n),0|Math.round((o[3]-o[1])*n)],this.setDirty()},u.update=function(o){o=o||{};var i=this.gl;this.pixelRatio=o.pixelRatio||1;var c=this.pixelRatio;this.pickPixelRatio=Math.max(c,1),this.setScreenBox(o.screenBox||[0,0,i.drawingBufferWidth/c,i.drawingBufferHeight/c]),this.screenBox,this.setViewBox(o.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/c,.125*(this.screenBox[3]-this.screenBox[1])/c,.875*(this.screenBox[2]-this.screenBox[0])/c,.875*(this.screenBox[3]-this.screenBox[1])/c]);var n=this.viewBox,a=(n[2]-n[0])/(n[3]-n[1]);this.setDataBox(o.dataBox||[-10,-10/a,10,10/a]),this.borderColor=o.borderColor!==!1&&(o.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(o.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(o.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(o.gridLineWidth||[1,1]).slice(),this.gridLineColor=s(o.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(o.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(o.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=s(o.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(o.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(o.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=s(o.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(o.titleCenter||[.5*(n[0]+n[2])/c,(n[3]+120)/c]).slice(),this.titleEnable=!("titleEnable"in o)||!!o.titleEnable,this.titleAngle=o.titleAngle||0,this.titleColor=(o.titleColor||[0,0,0,1]).slice(),this.labelPad=(o.labelPad||[15,15,15,15]).slice(),this.labelAngle=(o.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(o.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=s(o.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(o.tickPad||[15,15,15,15]).slice(),this.tickAngle=(o.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(o.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=s(o.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(o.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(o.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=s(o.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var g=o.ticks||[[],[]],h=this._tickBounds;h[0]=h[1]=1/0,h[2]=h[3]=-1/0;for(var y=0;y<2;++y){var v=g[y].slice(0);v.length!==0&&(v.sort(l),h[y]=Math.min(h[y],v[0].x),h[y+2]=Math.max(h[y+2],v[v.length-1].x))}this.grid.update({bounds:h,ticks:g}),this.text.update({bounds:h,ticks:g,labels:o.labels||["x","y"],labelSize:o.labelSize||[12,12],labelFont:o.labelFont||["sans-serif","sans-serif"],title:o.title||"",titleSize:o.titleSize||18,titleFont:o.titleFont||"sans-serif"}),this.static=!!o.static,this.setDirty()},u.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var o=this.objects.length-1;o>=0;--o)this.objects[o].dispose();for(this.objects.length=0,o=this.overlays.length-1;o>=0;--o)this.overlays[o].dispose();this.overlays.length=0,this.gl=null},u.addObject=function(o){this.objects.indexOf(o)<0&&(this.objects.push(o),this.setDirty())},u.removeObject=function(o){for(var i=this.objects,c=0;c<i.length;++c)if(i[c]===o){i.splice(c,1),this.setDirty();break}},u.addOverlay=function(o){this.overlays.indexOf(o)<0&&(this.overlays.push(o),this.setOverlayDirty())},u.removeOverlay=function(o){for(var i=this.overlays,c=0;c<i.length;++c)if(i[c]===o){i.splice(c,1),this.setOverlayDirty();break}}},{"./lib/box":310,"./lib/grid":311,"./lib/line":312,"./lib/text":314,"gl-select-static":331}],317:[function(r,O,B){O.exports=function(u,s){u=u||document.body,s=s||{};var l=[.01,1/0];"distanceLimits"in s&&(l[0]=s.distanceLimits[0],l[1]=s.distanceLimits[1]),"zoomMin"in s&&(l[0]=s.zoomMin),"zoomMax"in s&&(l[1]=s.zoomMax);var o=d({center:s.center||[0,0,0],up:s.up||[0,1,0],eye:s.eye||[0,0,10],mode:s.mode||"orbit",distanceLimits:l}),i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=0,n=u.clientWidth,a=u.clientHeight,g={keyBindingMode:"rotate",enableWheel:!0,view:o,element:u,delay:s.delay||16,rotateSpeed:s.rotateSpeed||1,zoomSpeed:s.zoomSpeed||1,translateSpeed:s.translateSpeed||1,flipX:!!s.flipX,flipY:!!s.flipY,modes:o.modes,_ortho:s._ortho||s.projection&&s.projection.type==="orthographic"||!1,tick:function(){var h=t(),y=this.delay,v=h-2*y;o.idle(h-y),o.recalcMatrix(v),o.flush(h-(100+2*y));for(var _=!0,x=o.computedMatrix,T=0;T<16;++T)_=_&&i[T]===x[T],i[T]=x[T];var A=u.clientWidth===n&&u.clientHeight===a;return n=u.clientWidth,a=u.clientHeight,_?!A:(c=Math.exp(o.computedRadius[0]),!0)},lookAt:function(h,y,v){o.lookAt(o.lastT(),h,y,v)},rotate:function(h,y,v){o.rotate(o.lastT(),h,y,v)},pan:function(h,y,v){o.pan(o.lastT(),h,y,v)},translate:function(h,y,v){o.translate(o.lastT(),h,y,v)}};return Object.defineProperties(g,{matrix:{get:function(){return o.computedMatrix},set:function(h){return o.setMatrix(o.lastT(),h),o.computedMatrix},enumerable:!0},mode:{get:function(){return o.getMode()},set:function(h){var y=o.computedUp.slice(),v=o.computedEye.slice(),_=o.computedCenter.slice();if(o.setMode(h),h==="turntable"){var x=t();o._active.lookAt(x,v,_,y),o._active.lookAt(x+500,v,_,[0,0,1]),o._active.flush(x)}return o.getMode()},enumerable:!0},center:{get:function(){return o.computedCenter},set:function(h){return o.lookAt(o.lastT(),null,h),o.computedCenter},enumerable:!0},eye:{get:function(){return o.computedEye},set:function(h){return o.lookAt(o.lastT(),h),o.computedEye},enumerable:!0},up:{get:function(){return o.computedUp},set:function(h){return o.lookAt(o.lastT(),null,null,h),o.computedUp},enumerable:!0},distance:{get:function(){return c},set:function(h){return o.setDistance(o.lastT(),h),h},enumerable:!0},distanceLimits:{get:function(){return o.getDistanceLimits(l)},set:function(h){return o.setDistanceLimits(h),h},enumerable:!0}}),u.addEventListener("contextmenu",function(h){return h.preventDefault(),!1}),g._lastX=-1,g._lastY=-1,g._lastMods={shift:!1,control:!1,alt:!1,meta:!1},g.enableMouseListeners=function(){function h(y,v,_,x){var T=g.keyBindingMode;if(T!==!1){var A=T==="rotate",S=T==="pan",w=T==="zoom",C=!!x.control,k=!!x.alt,L=!!x.shift,M=!!(1&y),P=!!(2&y),D=!!(4&y),N=1/u.clientHeight,U=N*(v-g._lastX),q=N*(_-g._lastY),X=g.flipX?1:-1,K=g.flipY?1:-1,Z=Math.PI*g.rotateSpeed,H=t();if(g._lastX!==-1&&g._lastY!==-1&&((A&&M&&!C&&!k&&!L||M&&!C&&!k&&L)&&o.rotate(H,X*Z*U,-K*Z*q,0),(S&&M&&!C&&!k&&!L||P||M&&C&&!k&&!L)&&o.pan(H,-g.translateSpeed*U*c,g.translateSpeed*q*c,0),w&&M&&!C&&!k&&!L||D||M&&!C&&k&&!L)){var Y=-g.zoomSpeed*q/window.innerHeight*(H-o.lastT())*100;o.pan(H,0,0,c*(Math.exp(Y)-1))}return g._lastX=v,g._lastY=_,g._lastMods=x,!0}}g.mouseListener=m(u,h),u.addEventListener("touchstart",function(y){var v=e(y.changedTouches[0],u);h(0,v[0],v[1],g._lastMods),h(1,v[0],v[1],g._lastMods)},!!f&&{passive:!0}),u.addEventListener("touchmove",function(y){var v=e(y.changedTouches[0],u);h(1,v[0],v[1],g._lastMods),y.preventDefault()},!!f&&{passive:!1}),u.addEventListener("touchend",function(y){h(0,g._lastX,g._lastY,g._lastMods)},!!f&&{passive:!0}),g.wheelListener=p(u,function(y,v){if(g.keyBindingMode!==!1&&g.enableWheel){var _=g.flipX?1:-1,x=g.flipY?1:-1,T=t();if(Math.abs(y)>Math.abs(v))o.rotate(T,0,0,-y*_*Math.PI*g.rotateSpeed/window.innerWidth);else if(!g._ortho){var A=-g.zoomSpeed*x*v/window.innerHeight*(T-o.lastT())/20;o.pan(T,0,0,c*(Math.exp(A)-1))}}},!0)},g.enableMouseListeners(),g};var t=r("right-now"),d=r("3d-view"),m=r("mouse-change"),p=r("mouse-wheel"),e=r("mouse-event-offset"),f=r("has-passive-events")},{"3d-view":55,"has-passive-events":436,"mouse-change":459,"mouse-event-offset":460,"mouse-wheel":462,"right-now":528}],318:[function(r,O,B){var t=r("glslify"),d=r("gl-shader"),m=t([`precision mediump float;
#define GLSLIFY 1
attribute vec2 position;
varying vec2 uv;
void main() {
  uv = position;
  gl_Position = vec4(position, 0, 1);
}`]),p=t([`precision mediump float;
#define GLSLIFY 1

uniform sampler2D accumBuffer;
varying vec2 uv;

void main() {
  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));
  gl_FragColor = min(vec4(1,1,1,1), accum);
}`]);O.exports=function(e){return d(e,m,p,null,[{name:"position",type:"vec2"}])}},{"gl-shader":332,glslify:434}],319:[function(r,O,B){var t=r("./camera.js"),d=r("gl-axes3d"),m=r("gl-axes3d/properties"),p=r("gl-spikes3d"),e=r("gl-select-static"),f=r("gl-fbo"),u=r("a-big-triangle"),s=r("mouse-change"),l=r("gl-mat4/perspective"),o=r("gl-mat4/ortho"),i=r("./lib/shader"),c=r("is-mobile")({tablet:!0,featureDetect:!0});function n(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function a(h){var y=Math.round(Math.log(Math.abs(h))/Math.log(10));if(y<0){var v=Math.round(Math.pow(10,-y));return Math.ceil(h*v)/v}return y>0?(v=Math.round(Math.pow(10,y)),Math.ceil(h/v)*v):Math.ceil(h)}function g(h){return typeof h!="boolean"||h}O.exports={createScene:function(h){(h=h||{}).camera=h.camera||{};var y=h.canvas;y||(y=document.createElement("canvas"),h.container?h.container.appendChild(y):document.body.appendChild(y));var v=h.gl;if(v||(h.glOptions&&(c=!!h.glOptions.preserveDrawingBuffer),v=function(ae,he){var se=null;try{(se=ae.getContext("webgl",he))||(se=ae.getContext("experimental-webgl",he))}catch(de){return null}return se}(y,h.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:c})),!v)throw new Error("webgl not supported");var _=h.bounds||[[-10,-10,-10],[10,10,10]],x=new n,T=f(v,v.drawingBufferWidth,v.drawingBufferHeight,{preferFloat:!c}),A=i(v),S=h.cameraObject&&h.cameraObject._ortho===!0||h.camera.projection&&h.camera.projection.type==="orthographic"||!1,w={eye:h.camera.eye||[2,0,0],center:h.camera.center||[0,0,0],up:h.camera.up||[0,1,0],zoomMin:h.camera.zoomMax||.1,zoomMax:h.camera.zoomMin||100,mode:h.camera.mode||"turntable",_ortho:S},C=h.axes||{},k=d(v,C);k.enable=!C.disable;var L=h.spikes||{},M=p(v,L),P=[],D=[],N=[],U=[],q=!0,X=!0,K=new Array(16),Z=new Array(16),H={view:null,projection:K,model:Z,_ortho:!1},Y=(X=!0,[v.drawingBufferWidth,v.drawingBufferHeight]),$=h.cameraObject||t(y,w),z={gl:v,contextLost:!1,pixelRatio:h.pixelRatio||1,canvas:y,selection:x,camera:$,axes:k,axesPixels:null,spikes:M,bounds:_,objects:P,shape:Y,aspect:h.aspectRatio||[1,1,1],pickRadius:h.pickRadius||10,zNear:h.zNear||.01,zFar:h.zFar||1e3,fovy:h.fovy||Math.PI/4,clearColor:h.clearColor||[0,0,0,0],autoResize:g(h.autoResize),autoBounds:g(h.autoBounds),autoScale:!!h.autoScale,autoCenter:g(h.autoCenter),clipToBounds:g(h.clipToBounds),snapToData:!!h.snapToData,onselect:h.onselect||null,onrender:h.onrender||null,onclick:h.onclick||null,cameraParams:H,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(ae){this.aspect[0]=ae.x,this.aspect[1]=ae.y,this.aspect[2]=ae.z,X=!0},setBounds:function(ae,he){this.bounds[0][ae]=he.min,this.bounds[1][ae]=he.max},setClearColor:function(ae){this.clearColor=ae},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},j=[v.drawingBufferWidth/z.pixelRatio|0,v.drawingBufferHeight/z.pixelRatio|0];function W(){if(!z._stopped&&z.autoResize){var ae=y.parentNode,he=1,se=1;ae&&ae!==document.body?(he=ae.clientWidth,se=ae.clientHeight):(he=window.innerWidth,se=window.innerHeight);var de=0|Math.ceil(he*z.pixelRatio),ue=0|Math.ceil(se*z.pixelRatio);if(de!==y.width||ue!==y.height){y.width=de,y.height=ue;var ve=y.style;ve.position=ve.position||"absolute",ve.left="0px",ve.top="0px",ve.width=he+"px",ve.height=se+"px",q=!0}}}z.autoResize&&W();function ee(){for(var ae=P.length,he=U.length,se=0;se<he;++se)N[se]=0;e:for(se=0;se<ae;++se){var de=P[se],ue=de.pickSlots;if(ue){for(var ve=0;ve<he;++ve)if(N[ve]+ue<255){D[se]=ve,de.setPickBase(N[ve]+1),N[ve]+=ue;continue e}var ke=e(v,Y);D[se]=he,U.push(ke),N.push(ue),de.setPickBase(1),he+=1}else D[se]=-1}for(;he>0&&N[he-1]===0;)N.pop(),U.pop().dispose()}function J(){if(z.contextLost)return!0;v.isContextLost()&&(z.contextLost=!0,z.mouseListener.enabled=!1,z.selection.object=null,z.oncontextloss&&z.oncontextloss())}window.addEventListener("resize",W),z.update=function(ae){z._stopped||(q=!0,X=!0)},z.add=function(ae){z._stopped||(ae.axes=k,P.push(ae),D.push(-1),q=!0,X=!0,ee())},z.remove=function(ae){if(!z._stopped){var he=P.indexOf(ae);he<0||(P.splice(he,1),D.pop(),q=!0,X=!0,ee())}},z.dispose=function(){if(!z._stopped&&(z._stopped=!0,window.removeEventListener("resize",W),y.removeEventListener("webglcontextlost",J),z.mouseListener.enabled=!1,!z.contextLost)){k.dispose(),M.dispose();for(var ae=0;ae<P.length;++ae)P[ae].dispose();for(T.dispose(),ae=0;ae<U.length;++ae)U[ae].dispose();A.dispose(),v=null,k=null,M=null,P=[]}},z._mouseRotating=!1,z._prevButtons=0,z.enableMouseListeners=function(){z.mouseListener=s(y,function(ae,he,se){if(!z._stopped){var de=U.length,ue=P.length,ve=x.object;x.distance=1/0,x.mouse[0]=he,x.mouse[1]=se,x.object=null,x.screen=null,x.dataCoordinate=x.dataPosition=null;var ke=!1;if(ae&&z._prevButtons)z._mouseRotating=!0;else{z._mouseRotating&&(X=!0),z._mouseRotating=!1;for(var Ee=0;Ee<de;++Ee){var be=U[Ee].query(he,j[1]-se-1,z.pickRadius);if(be){if(be.distance>x.distance)continue;for(var xe=0;xe<ue;++xe){var ce=P[xe];if(D[xe]===Ee){var ge=ce.pick(be);ge&&(x.buttons=ae,x.screen=be.coord,x.distance=be.distance,x.object=ce,x.index=ge.distance,x.dataPosition=ge.position,x.dataCoordinate=ge.dataCoordinate,x.data=ge,ke=!0)}}}}}ve&&ve!==x.object&&(ve.highlight&&ve.highlight(null),q=!0),x.object&&(x.object.highlight&&x.object.highlight(x.data),q=!0),(ke=ke||x.object!==ve)&&z.onselect&&z.onselect(x),1&ae&&!(1&z._prevButtons)&&z.onclick&&z.onclick(x),z._prevButtons=ae}})},y.addEventListener("webglcontextlost",J);var Q=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],te=[Q[0].slice(),Q[1].slice()];function ie(){if(!J()){W();var ae=z.camera.tick();H.view=z.camera.matrix,q=q||ae,X=X||ae,k.pixelRatio=z.pixelRatio,M.pixelRatio=z.pixelRatio;var he=P.length,se=Q[0],de=Q[1];se[0]=se[1]=se[2]=1/0,de[0]=de[1]=de[2]=-1/0;for(var ue=0;ue<he;++ue){(Fe=P[ue]).pixelRatio=z.pixelRatio,Fe.axes=z.axes,q=q||!!Fe.dirty,X=X||!!Fe.dirty;var ve=Fe.bounds;if(ve)for(var ke=ve[0],Ee=ve[1],be=0;be<3;++be)se[be]=Math.min(se[be],ke[be]),de[be]=Math.max(de[be],Ee[be])}var xe=z.bounds;if(z.autoBounds)for(be=0;be<3;++be){if(de[be]<se[be])se[be]=-1,de[be]=1;else{se[be]===de[be]&&(se[be]-=1,de[be]+=1);var ce=.05*(de[be]-se[be]);se[be]=se[be]-ce,de[be]=de[be]+ce}xe[0][be]=se[be],xe[1][be]=de[be]}var ge=!1;for(be=0;be<3;++be)ge=ge||te[0][be]!==xe[0][be]||te[1][be]!==xe[1][be],te[0][be]=xe[0][be],te[1][be]=xe[1][be];if(X=X||ge,q=q||ge){if(ge){var we=[0,0,0];for(ue=0;ue<3;++ue)we[ue]=a((xe[1][ue]-xe[0][ue])/10);k.autoTicks?k.update({bounds:xe,tickSpacing:we}):k.update({bounds:xe})}var Me=v.drawingBufferWidth,Se=v.drawingBufferHeight;for(Y[0]=Me,Y[1]=Se,j[0]=0|Math.max(Me/z.pixelRatio,1),j[1]=0|Math.max(Se/z.pixelRatio,1),function(Ye,rt){var Oe=Ye.bounds,je=Ye.cameraParams,We=je.projection,qe=je.model,Qe=Ye.gl.drawingBufferWidth,st=Ye.gl.drawingBufferHeight,ct=Ye.zNear,Pt=Ye.zFar,kt=Ye.fovy,at=Qe/st;rt?(o(We,-at,at,-1,1,ct,Pt),je._ortho=!0):(l(We,kt,at,ct,Pt),je._ortho=!1);for(var tt=0;tt<16;++tt)qe[tt]=0;qe[15]=1;var _t=0;for(tt=0;tt<3;++tt)_t=Math.max(_t,Oe[1][tt]-Oe[0][tt]);for(tt=0;tt<3;++tt)Ye.autoScale?qe[5*tt]=Ye.aspect[tt]/(Oe[1][tt]-Oe[0][tt]):qe[5*tt]=1/_t,Ye.autoCenter&&(qe[12+tt]=.5*-qe[5*tt]*(Oe[0][tt]+Oe[1][tt]))}(z,S),ue=0;ue<he;++ue)(Fe=P[ue]).axesBounds=xe,z.clipToBounds&&(Fe.clipBounds=xe);x.object&&(z.snapToData?M.position=x.dataCoordinate:M.position=x.dataPosition,M.bounds=xe),X&&(X=!1,function(){if(!J()){v.colorMask(!0,!0,!0,!0),v.depthMask(!0),v.disable(v.BLEND),v.enable(v.DEPTH_TEST),v.depthFunc(v.LEQUAL);for(var Ye=P.length,rt=U.length,Oe=0;Oe<rt;++Oe){var je=U[Oe];je.shape=j,je.begin();for(var We=0;We<Ye;++We)if(D[We]===Oe){var qe=P[We];qe.drawPick&&(qe.pixelRatio=1,qe.drawPick(H))}je.end()}}}()),z.axesPixels=m(z.axes,H,Me,Se),z.onrender&&z.onrender(),v.bindFramebuffer(v.FRAMEBUFFER,null),v.viewport(0,0,Me,Se),z.clearRGBA(),v.depthMask(!0),v.colorMask(!0,!0,!0,!0),v.enable(v.DEPTH_TEST),v.depthFunc(v.LEQUAL),v.disable(v.BLEND),v.disable(v.CULL_FACE);var ze=!1;for(k.enable&&(ze=ze||k.isTransparent(),k.draw(H)),M.axes=k,x.object&&M.draw(H),v.disable(v.CULL_FACE),ue=0;ue<he;++ue)(Fe=P[ue]).axes=k,Fe.pixelRatio=z.pixelRatio,Fe.isOpaque&&Fe.isOpaque()&&Fe.draw(H),Fe.isTransparent&&Fe.isTransparent()&&(ze=!0);if(ze){for(T.shape=Y,T.bind(),v.clear(v.DEPTH_BUFFER_BIT),v.colorMask(!1,!1,!1,!1),v.depthMask(!0),v.depthFunc(v.LESS),k.enable&&k.isTransparent()&&k.drawTransparent(H),ue=0;ue<he;++ue)(Fe=P[ue]).isOpaque&&Fe.isOpaque()&&Fe.draw(H);for(v.enable(v.BLEND),v.blendEquation(v.FUNC_ADD),v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),v.colorMask(!0,!0,!0,!0),v.depthMask(!1),v.clearColor(0,0,0,0),v.clear(v.COLOR_BUFFER_BIT),k.isTransparent()&&k.drawTransparent(H),ue=0;ue<he;++ue){var Fe;(Fe=P[ue]).isTransparent&&Fe.isTransparent()&&Fe.drawTransparent(H)}v.bindFramebuffer(v.FRAMEBUFFER,null),v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),v.disable(v.DEPTH_TEST),A.bind(),T.color[0].bind(0),A.uniforms.accumBuffer=0,u(v),v.disable(v.BLEND)}for(q=!1,ue=0;ue<he;++ue)P[ue].dirty=!1}}}return z.enableMouseListeners(),function ae(){z._stopped||z.contextLost||(ie(),requestAnimationFrame(ae))}(),z.redraw=function(){z._stopped||(q=!0,ie())},z},createCamera:t}},{"./camera.js":317,"./lib/shader":318,"a-big-triangle":70,"gl-axes3d":253,"gl-axes3d/properties":260,"gl-fbo":270,"gl-mat4/ortho":296,"gl-mat4/perspective":297,"gl-select-static":331,"gl-spikes3d":341,"is-mobile":445,"mouse-change":459}],320:[function(r,O,B){var t=r("glslify");B.pointVertex=t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;

uniform mat3 matrix;
uniform float pointSize;
uniform float pointCloud;

highp float rand(vec2 co) {
  highp float a = 12.9898;
  highp float b = 78.233;
  highp float c = 43758.5453;
  highp float d = dot(co.xy, vec2(a, b));
  highp float e = mod(d, 3.14);
  return fract(sin(e) * c);
}

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
    // if we don't jitter the point size a bit, overall point cloud
    // saturation 'jumps' on zooming, which is disturbing and confusing
  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);
  if(pointCloud != 0.0) { // pointCloud is truthy
    // get the same square surface as circle would be
    gl_PointSize *= 0.886;
  }
}`]),B.pointFragment=t([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color, borderColor;
uniform float centerFraction;
uniform float pointCloud;

void main() {
  float radius;
  vec4 baseColor;
  if(pointCloud != 0.0) { // pointCloud is truthy
    if(centerFraction == 1.0) {
      gl_FragColor = color;
    } else {
      gl_FragColor = mix(borderColor, color, centerFraction);
    }
  } else {
    radius = length(2.0 * gl_PointCoord.xy - 1.0);
    if(radius > 1.0) {
      discard;
    }
    baseColor = mix(borderColor, color, step(radius, centerFraction));
    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);
  }
}
`]),B.pickVertex=t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;

uniform mat3 matrix;
uniform float pointSize;
uniform vec4 pickOffset;

varying vec4 fragId;

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
  gl_PointSize = pointSize;

  vec4 id = pickId + pickOffset;
  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  fragId = id;
}
`]),B.pickFragment=t([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;

void main() {
  float radius = length(2.0 * gl_PointCoord.xy - 1.0);
  if(radius > 1.0) {
    discard;
  }
  gl_FragColor = fragId / 255.0;
}
`])},{glslify:434}],321:[function(r,O,B){var t=r("gl-shader"),d=r("gl-buffer"),m=r("typedarray-pool"),p=r("./lib/shader");function e(l,o,i,c,n){this.plot=l,this.offsetBuffer=o,this.pickBuffer=i,this.shader=c,this.pickShader=n,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}O.exports=function(l,o){var i=l.gl,c=d(i),n=d(i),a=t(i,p.pointVertex,p.pointFragment),g=t(i,p.pickVertex,p.pickFragment),h=new e(l,c,n,a,g);return h.update(o),l.addObject(h),h};var f,u,s=e.prototype;s.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},s.update=function(l){var o;function i(v,_){return v in l?l[v]:_}l=l||{},this.sizeMin=i("sizeMin",.5),this.sizeMax=i("sizeMax",20),this.color=i("color",[1,0,0,1]).slice(),this.areaRatio=i("areaRatio",1),this.borderColor=i("borderColor",[0,0,0,1]).slice(),this.blend=i("blend",!1);var c=l.positions.length>>>1,n=l.positions instanceof Float32Array,a=l.idToIndex instanceof Int32Array&&l.idToIndex.length>=c,g=l.positions,h=n?g:m.mallocFloat32(g.length),y=a?l.idToIndex:m.mallocInt32(c);if(n||h.set(g),!a)for(h.set(g),o=0;o<c;o++)y[o]=o;this.points=g,this.offsetBuffer.update(h),this.pickBuffer.update(y),n||m.free(h),a||m.free(y),this.pointCount=c,this.pickOffset=0},s.unifiedDraw=(f=[1,0,0,0,1,0,0,0,1],u=[0,0,0,0],function(l){var o=l!==void 0,i=o?this.pickShader:this.shader,c=this.plot.gl,n=this.plot.dataBox;if(this.pointCount===0)return l;var a=n[2]-n[0],g=n[3]-n[1],h=function(x,T){var A,S=0,w=x.length>>>1;for(A=0;A<w;A++){var C=x[2*A],k=x[2*A+1];C>=T[0]&&C<=T[2]&&k>=T[1]&&k<=T[3]&&S++}return S}(this.points,n),y=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(h,.33333)));f[0]=2/a,f[4]=2/g,f[6]=-2*n[0]/a-1,f[7]=-2*n[1]/g-1,this.offsetBuffer.bind(),i.bind(),i.attributes.position.pointer(),i.uniforms.matrix=f,i.uniforms.color=this.color,i.uniforms.borderColor=this.borderColor,i.uniforms.pointCloud=y<5,i.uniforms.pointSize=y,i.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),o&&(u[0]=255&l,u[1]=l>>8&255,u[2]=l>>16&255,u[3]=l>>24&255,this.pickBuffer.bind(),i.attributes.pickId.pointer(c.UNSIGNED_BYTE),i.uniforms.pickOffset=u,this.pickOffset=l);var v=c.getParameter(c.BLEND),_=c.getParameter(c.DITHER);return v&&!this.blend&&c.disable(c.BLEND),_&&c.disable(c.DITHER),c.drawArrays(c.POINTS,0,this.pointCount),v&&!this.blend&&c.enable(c.BLEND),_&&c.enable(c.DITHER),l+this.pointCount}),s.draw=s.unifiedDraw,s.drawPick=s.unifiedDraw,s.pick=function(l,o,i){var c=this.pickOffset,n=this.pointCount;if(i<c||i>=c+n)return null;var a=i-c,g=this.points;return{object:this,pointId:a,dataCoord:[g[2*a],g[2*a+1]]}}},{"./lib/shader":320,"gl-buffer":261,"gl-shader":332,"typedarray-pool":601}],322:[function(r,O,B){O.exports=function(t,d,m,p){var e,f,u,s,l,o=d[0],i=d[1],c=d[2],n=d[3],a=m[0],g=m[1],h=m[2],y=m[3];return(f=o*a+i*g+c*h+n*y)<0&&(f=-f,a=-a,g=-g,h=-h,y=-y),1-f>1e-6?(e=Math.acos(f),u=Math.sin(e),s=Math.sin((1-p)*e)/u,l=Math.sin(p*e)/u):(s=1-p,l=p),t[0]=s*o+l*a,t[1]=s*i+l*g,t[2]=s*c+l*h,t[3]=s*n+l*y,t}},{}],323:[function(r,O,B){O.exports=function(t){return t||t===0?t.toString():""}},{}],324:[function(r,O,B){var t=r("vectorize-text");O.exports=function(m,p,e){var f=d[p];if(f||(f=d[p]={}),m in f)return f[m];var u={textAlign:"center",textBaseline:"middle",lineHeight:1,font:p,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},s=t(m,u);u.triangles=!1;var l,o,i=t(m,u);if(e&&e!==1){for(l=0;l<s.positions.length;++l)for(o=0;o<s.positions[l].length;++o)s.positions[l][o]/=e;for(l=0;l<i.positions.length;++l)for(o=0;o<i.positions[l].length;++o)i.positions[l][o]/=e}var c=[[1/0,1/0],[-1/0,-1/0]],n=i.positions.length;for(l=0;l<n;++l){var a=i.positions[l];for(o=0;o<2;++o)c[0][o]=Math.min(c[0][o],a[o]),c[1][o]=Math.max(c[1][o],a[o])}return f[m]=[s,i,c]};var d={}},{"vectorize-text":607}],325:[function(r,O,B){var t=r("gl-shader"),d=r("glslify"),m=d([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform vec4 highlightId;
uniform float highlightScale;
uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = 1.0;
    if(distance(highlightId, id) < 0.0001) {
      scale = highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1);
    vec4 viewPosition = view * worldPosition;
    viewPosition = viewPosition / viewPosition.w;
    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),p=d([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float highlightScale, pixelRatio;
uniform vec4 highlightId;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = pixelRatio;
    if(distance(highlightId.bgr, id.bgr) < 0.001) {
      scale *= highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1.0);
    vec4 viewPosition = view * worldPosition;
    vec4 clipPosition = projection * viewPosition;
    clipPosition /= clipPosition.w;

    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),e=d([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform float highlightScale;
uniform vec4 highlightId;
uniform vec3 axes[2];
uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float scale, pixelRatio;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float lscale = pixelRatio * scale;
    if(distance(highlightId, id) < 0.0001) {
      lscale *= highlightScale;
    }

    vec4 clipCenter   = projection * view * model * vec4(position, 1);
    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;
    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = dataPosition;
  }
}
`]),f=d([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float opacity;

varying vec4 interpColor;
varying vec3 dataCoordinate;

void main() {
  if (
    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||
    interpColor.a * opacity == 0.
  ) discard;
  gl_FragColor = interpColor * opacity;
}
`]),u=d([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float pickGroup;

varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;

  gl_FragColor = vec4(pickGroup, pickId.bgr);
}`]),s=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],l={vertex:m,fragment:f,attributes:s},o={vertex:p,fragment:f,attributes:s},i={vertex:e,fragment:f,attributes:s},c={vertex:m,fragment:u,attributes:s},n={vertex:p,fragment:u,attributes:s},a={vertex:e,fragment:u,attributes:s};function g(h,y){var v=t(h,y),_=v.attributes;return _.position.location=0,_.color.location=1,_.glyph.location=2,_.id.location=3,v}B.createPerspective=function(h){return g(h,l)},B.createOrtho=function(h){return g(h,o)},B.createProject=function(h){return g(h,i)},B.createPickPerspective=function(h){return g(h,c)},B.createPickOrtho=function(h){return g(h,n)},B.createPickProject=function(h){return g(h,a)}},{"gl-shader":332,glslify:326}],326:[function(r,O,B){arguments[4][268][0].apply(B,arguments)},{dup:268}],327:[function(r,O,B){var t=r("is-string-blank"),d=r("gl-buffer"),m=r("gl-vao"),p=r("typedarray-pool"),e=r("gl-mat4/multiply"),f=r("./lib/shaders"),u=r("./lib/glyphs"),s=r("./lib/get-simple-string"),l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function o(N,U){var q=N[0],X=N[1],K=N[2],Z=N[3];return N[0]=U[0]*q+U[4]*X+U[8]*K+U[12]*Z,N[1]=U[1]*q+U[5]*X+U[9]*K+U[13]*Z,N[2]=U[2]*q+U[6]*X+U[10]*K+U[14]*Z,N[3]=U[3]*q+U[7]*X+U[11]*K+U[15]*Z,N}function i(N,U,q,X){return o(X,X),o(X,X),o(X,X)}function c(N,U){this.index=N,this.dataCoordinate=this.position=U}function n(N){return N===!0||N>1?1:N}function a(N,U,q,X,K,Z,H,Y,$,z,j,W){this.gl=N,this.pixelRatio=1,this.shader=U,this.orthoShader=q,this.projectShader=X,this.pointBuffer=K,this.colorBuffer=Z,this.glyphBuffer=H,this.idBuffer=Y,this.vao=$,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=z,this.pickOrthoShader=j,this.pickProjectShader=W,this.points=[],this._selectResult=new c(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}O.exports=function(N){var U=N.gl,q=f.createPerspective(U),X=f.createOrtho(U),K=f.createProject(U),Z=f.createPickPerspective(U),H=f.createPickOrtho(U),Y=f.createPickProject(U),$=d(U),z=d(U),j=d(U),W=d(U),ee=m(U,[{buffer:$,size:3,type:U.FLOAT},{buffer:z,size:4,type:U.FLOAT},{buffer:j,size:2,type:U.FLOAT},{buffer:W,size:4,type:U.UNSIGNED_BYTE,normalized:!0}]),J=new a(U,q,X,K,$,z,j,W,ee,Z,H,Y);return J.update(N),J};var g=a.prototype;g.pickSlots=1,g.setPickBase=function(N){this.pickId=N},g.isTransparent=function(){if(this.hasAlpha)return!0;for(var N=0;N<3;++N)if(this.axesProject[N]&&this.projectHasAlpha)return!0;return!1},g.isOpaque=function(){if(!this.hasAlpha)return!0;for(var N=0;N<3;++N)if(this.axesProject[N]&&!this.projectHasAlpha)return!0;return!1};var h=[0,0],y=[0,0,0],v=[0,0,0],_=[0,0,0,1],x=[0,0,0,1],T=l.slice(),A=[0,0,0],S=[[0,0,0],[0,0,0]];function w(N){return N[0]=N[1]=N[2]=0,N}function C(N,U){return N[0]=U[0],N[1]=U[1],N[2]=U[2],N[3]=1,N}function k(N,U,q,X){return N[0]=U[0],N[1]=U[1],N[2]=U[2],N[q]=X,N}function L(N,U,q,X){var K,Z=U.axesProject,H=U.gl,Y=N.uniforms,$=q.model||l,z=q.view||l,j=q.projection||l,W=U.axesBounds,ee=function(xe){for(var ce=S,ge=0;ge<2;++ge)for(var we=0;we<3;++we)ce[ge][we]=Math.max(Math.min(xe[ge][we],1e8),-1e8);return ce}(U.clipBounds);K=U.axes&&U.axes.lastCubeProps?U.axes.lastCubeProps.axis:[1,1,1],h[0]=2/H.drawingBufferWidth,h[1]=2/H.drawingBufferHeight,N.bind(),Y.view=z,Y.projection=j,Y.screenSize=h,Y.highlightId=U.highlightId,Y.highlightScale=U.highlightScale,Y.clipBounds=ee,Y.pickGroup=U.pickId/255,Y.pixelRatio=X;for(var J=0;J<3;++J)if(Z[J]){Y.scale=U.projectScale[J],Y.opacity=U.projectOpacity[J];for(var Q=T,te=0;te<16;++te)Q[te]=0;for(te=0;te<4;++te)Q[5*te]=1;Q[5*J]=0,K[J]<0?Q[12+J]=W[0][J]:Q[12+J]=W[1][J],e(Q,$,Q),Y.model=Q;var ie=(J+1)%3,ae=(J+2)%3,he=w(y),se=w(v);he[ie]=1,se[ae]=1;var de=i(0,0,0,C(_,he)),ue=i(0,0,0,C(x,se));if(Math.abs(de[1])>Math.abs(ue[1])){var ve=de;de=ue,ue=ve,ve=he,he=se,se=ve;var ke=ie;ie=ae,ae=ke}de[0]<0&&(he[ie]=-1),ue[1]>0&&(se[ae]=-1);var Ee=0,be=0;for(te=0;te<4;++te)Ee+=Math.pow($[4*ie+te],2),be+=Math.pow($[4*ae+te],2);he[ie]/=Math.sqrt(Ee),se[ae]/=Math.sqrt(be),Y.axes[0]=he,Y.axes[1]=se,Y.fragClipBounds[0]=k(A,ee[0],J,-1e8),Y.fragClipBounds[1]=k(A,ee[1],J,1e8),U.vao.bind(),U.vao.draw(H.TRIANGLES,U.vertexCount),U.lineWidth>0&&(H.lineWidth(U.lineWidth*X),U.vao.draw(H.LINES,U.lineVertexCount,U.vertexCount)),U.vao.unbind()}}var M=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];function P(N,U,q,X,K,Z,H){var Y=q.gl;if((Z===q.projectHasAlpha||H)&&L(U,q,X,K),Z===q.hasAlpha||H){N.bind();var $=N.uniforms;$.model=X.model||l,$.view=X.view||l,$.projection=X.projection||l,h[0]=2/Y.drawingBufferWidth,h[1]=2/Y.drawingBufferHeight,$.screenSize=h,$.highlightId=q.highlightId,$.highlightScale=q.highlightScale,$.fragClipBounds=M,$.clipBounds=q.axes.bounds,$.opacity=q.opacity,$.pickGroup=q.pickId/255,$.pixelRatio=K,q.vao.bind(),q.vao.draw(Y.TRIANGLES,q.vertexCount),q.lineWidth>0&&(Y.lineWidth(q.lineWidth*K),q.vao.draw(Y.LINES,q.lineVertexCount,q.vertexCount)),q.vao.unbind()}}function D(N,U,q,X){var K;K=Array.isArray(N)?U<N.length?N[U]:void 0:N,K=s(K);var Z=!0;t(K)&&(K="\u25BC",Z=!1);var H=u(K,q,X);return{mesh:H[0],lines:H[1],bounds:H[2],visible:Z}}g.draw=function(N){P(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,N,this.pixelRatio,!1,!1)},g.drawTransparent=function(N){P(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,N,this.pixelRatio,!0,!1)},g.drawPick=function(N){P(this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader,this.pickProjectShader,this,N,1,!0,!0)},g.pick=function(N){if(!N||N.id!==this.pickId)return null;var U=N.value[2]+(N.value[1]<<8)+(N.value[0]<<16);if(U>=this.pointCount||U<0)return null;var q=this.points[U],X=this._selectResult;X.index=U;for(var K=0;K<3;++K)X.position[K]=X.dataCoordinate[K]=q[K];return X},g.highlight=function(N){if(N){var U=N.index,q=255&U,X=U>>8&255,K=U>>16&255;this.highlightId=[q/255,X/255,K/255,0]}else this.highlightId=[1,1,1,1]},g.update=function(N){if("perspective"in(N=N||{})&&(this.useOrtho=!N.perspective),"orthographic"in N&&(this.useOrtho=!!N.orthographic),"lineWidth"in N&&(this.lineWidth=N.lineWidth),"project"in N)if(Array.isArray(N.project))this.axesProject=N.project;else{var U=!!N.project;this.axesProject=[U,U,U]}if("projectScale"in N)if(Array.isArray(N.projectScale))this.projectScale=N.projectScale.slice();else{var q=+N.projectScale;this.projectScale=[q,q,q]}if(this.projectHasAlpha=!1,"projectOpacity"in N){Array.isArray(N.projectOpacity)?this.projectOpacity=N.projectOpacity.slice():(q=+N.projectOpacity,this.projectOpacity=[q,q,q]);for(var X=0;X<3;++X)this.projectOpacity[X]=n(this.projectOpacity[X]),this.projectOpacity[X]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in N&&(this.opacity=n(N.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var K,Z,H=N.position,Y=N.font||"normal",$=N.alignment||[0,0];if($.length===2)K=$[0],Z=$[1];else for(K=[],Z=[],X=0;X<$.length;++X)K[X]=$[X][0],Z[X]=$[X][1];var z=[1/0,1/0,1/0],j=[-1/0,-1/0,-1/0],W=N.glyph,ee=N.color,J=N.size,Q=N.angle,te=N.lineColor,ie=-1,ae=0,he=0,se=0;if(H.length){se=H.length;e:for(X=0;X<se;++X){for(var de=H[X],ue=0;ue<3;++ue)if(isNaN(de[ue])||!isFinite(de[ue]))continue e;var ve=(Oe=D(W,X,Y,this.pixelRatio)).mesh,ke=Oe.lines,Ee=Oe.bounds;ae+=3*ve.cells.length,he+=2*ke.edges.length}}var be=ae+he,xe=p.mallocFloat(3*be),ce=p.mallocFloat(4*be),ge=p.mallocFloat(2*be),we=p.mallocUint32(be);if(be>0){var Me=0,Se=ae,ze=[0,0,0,1],Fe=[0,0,0,1],Ye=Array.isArray(ee)&&Array.isArray(ee[0]),rt=Array.isArray(te)&&Array.isArray(te[0]);e:for(X=0;X<se;++X){for(ie+=1,de=H[X],ue=0;ue<3;++ue){if(isNaN(de[ue])||!isFinite(de[ue]))continue e;j[ue]=Math.max(j[ue],de[ue]),z[ue]=Math.min(z[ue],de[ue])}ve=(Oe=D(W,X,Y,this.pixelRatio)).mesh,ke=Oe.lines,Ee=Oe.bounds;var Oe,je=Oe.visible;if(je)if(Array.isArray(ee)){if((We=Ye?X<ee.length?ee[X]:[0,0,0,0]:ee).length===3){for(ue=0;ue<3;++ue)ze[ue]=We[ue];ze[3]=1}else if(We.length===4){for(ue=0;ue<4;++ue)ze[ue]=We[ue];!this.hasAlpha&&We[3]<1&&(this.hasAlpha=!0)}}else ze[0]=ze[1]=ze[2]=0,ze[3]=1;else ze=[1,1,1,0];if(je)if(Array.isArray(te)){var We;if((We=rt?X<te.length?te[X]:[0,0,0,0]:te).length===3){for(ue=0;ue<3;++ue)Fe[ue]=We[ue];Fe[ue]=1}else if(We.length===4){for(ue=0;ue<4;++ue)Fe[ue]=We[ue];!this.hasAlpha&&We[3]<1&&(this.hasAlpha=!0)}}else Fe[0]=Fe[1]=Fe[2]=0,Fe[3]=1;else Fe=[1,1,1,0];var qe=.5;je?Array.isArray(J)?qe=X<J.length?+J[X]:12:J?qe=+J:this.useOrtho&&(qe=12):qe=0;var Qe=0;Array.isArray(Q)?Qe=X<Q.length?+Q[X]:0:Q&&(Qe=+Q);var st=Math.cos(Qe),ct=Math.sin(Qe);for(de=H[X],ue=0;ue<3;++ue)j[ue]=Math.max(j[ue],de[ue]),z[ue]=Math.min(z[ue],de[ue]);var Pt=K,kt=Z;Pt=0,Array.isArray(K)?Pt=X<K.length?K[X]:0:K&&(Pt=K),kt=0,Array.isArray(Z)?kt=X<Z.length?Z[X]:0:Z&&(kt=Z);var at=[Pt*=Pt>0?1-Ee[0][0]:Pt<0?1+Ee[1][0]:1,kt*=kt>0?1-Ee[0][1]:kt<0?1+Ee[1][1]:1],tt=ve.cells||[],_t=ve.positions||[];for(ue=0;ue<tt.length;++ue)for(var er=tt[ue],tr=0;tr<3;++tr){for(var Ue=0;Ue<3;++Ue)xe[3*Me+Ue]=de[Ue];for(Ue=0;Ue<4;++Ue)ce[4*Me+Ue]=ze[Ue];we[Me]=ie;var He=_t[er[tr]];ge[2*Me]=qe*(st*He[0]-ct*He[1]+at[0]),ge[2*Me+1]=qe*(ct*He[0]+st*He[1]+at[1]),Me+=1}for(tt=ke.edges,_t=ke.positions,ue=0;ue<tt.length;++ue)for(er=tt[ue],tr=0;tr<2;++tr){for(Ue=0;Ue<3;++Ue)xe[3*Se+Ue]=de[Ue];for(Ue=0;Ue<4;++Ue)ce[4*Se+Ue]=Fe[Ue];we[Se]=ie,He=_t[er[tr]],ge[2*Se]=qe*(st*He[0]-ct*He[1]+at[0]),ge[2*Se+1]=qe*(ct*He[0]+st*He[1]+at[1]),Se+=1}}}this.bounds=[z,j],this.points=H,this.pointCount=H.length,this.vertexCount=ae,this.lineVertexCount=he,this.pointBuffer.update(xe),this.colorBuffer.update(ce),this.glyphBuffer.update(ge),this.idBuffer.update(we),p.free(xe),p.free(ce),p.free(ge),p.free(we)},g.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":323,"./lib/glyphs":324,"./lib/shaders":325,"gl-buffer":261,"gl-mat4/multiply":295,"gl-vao":353,"is-string-blank":448,"typedarray-pool":601}],328:[function(r,O,B){var t=r("glslify");B.boxVertex=t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 vertex;

uniform vec2 cornerA, cornerB;

void main() {
  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);
}
`]),B.boxFragment=t([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color;

void main() {
  gl_FragColor = color;
}
`])},{glslify:329}],329:[function(r,O,B){arguments[4][268][0].apply(B,arguments)},{dup:268}],330:[function(r,O,B){var t=r("gl-shader"),d=r("gl-buffer"),m=r("./lib/shaders");function p(f,u,s){this.plot=f,this.boxBuffer=u,this.boxShader=s,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}O.exports=function(f,u){var s=f.gl,l=d(s,[0,0,0,1,1,0,1,1]),o=t(s,m.boxVertex,m.boxFragment),i=new p(f,l,o);return i.update(u),f.addOverlay(i),i};var e=p.prototype;e.draw=function(){if(this.enabled){var f=this.plot,u=this.selectBox,s=this.borderWidth,l=(this.innerFill,this.innerColor),o=(this.outerFill,this.outerColor),i=this.borderColor,c=f.box,n=f.screenBox,a=f.dataBox,g=f.viewBox,h=f.pixelRatio,y=(u[0]-a[0])*(g[2]-g[0])/(a[2]-a[0])+g[0],v=(u[1]-a[1])*(g[3]-g[1])/(a[3]-a[1])+g[1],_=(u[2]-a[0])*(g[2]-g[0])/(a[2]-a[0])+g[0],x=(u[3]-a[1])*(g[3]-g[1])/(a[3]-a[1])+g[1];if(y=Math.max(y,g[0]),v=Math.max(v,g[1]),_=Math.min(_,g[2]),x=Math.min(x,g[3]),!(_<y||x<v)){c.bind();var T=n[2]-n[0],A=n[3]-n[1];if(this.outerFill&&(c.drawBox(0,0,T,v,o),c.drawBox(0,v,y,x,o),c.drawBox(0,x,T,A,o),c.drawBox(_,v,T,x,o)),this.innerFill&&c.drawBox(y,v,_,x,l),s>0){var S=s*h;c.drawBox(y-S,v-S,_+S,v+S,i),c.drawBox(y-S,x-S,_+S,x+S,i),c.drawBox(y-S,v-S,y+S,x+S,i),c.drawBox(_-S,v-S,_+S,x+S,i)}}}},e.update=function(f){f=f||{},this.innerFill=!!f.innerFill,this.outerFill=!!f.outerFill,this.innerColor=(f.innerColor||[0,0,0,.5]).slice(),this.outerColor=(f.outerColor||[0,0,0,.5]).slice(),this.borderColor=(f.borderColor||[0,0,0,1]).slice(),this.borderWidth=f.borderWidth||0,this.selectBox=(f.selectBox||this.selectBox).slice()},e.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":328,"gl-buffer":261,"gl-shader":332}],331:[function(r,O,B){O.exports=function(s,l){var o=l[0],i=l[1],c=t(s,o,i,{}),n=d.mallocUint8(o*i*4);return new f(s,c,n)};var t=r("gl-fbo"),d=r("typedarray-pool"),m=r("ndarray"),p=r("bit-twiddle").nextPow2;function e(s,l,o,i,c){this.coord=[s,l],this.id=o,this.value=i,this.distance=c}function f(s,l,o){this.gl=s,this.fbo=l,this.buffer=o,this._readTimeout=null;var i=this;this._readCallback=function(){i.gl&&(l.bind(),s.readPixels(0,0,l.shape[0],l.shape[1],s.RGBA,s.UNSIGNED_BYTE,i.buffer),i._readTimeout=null)}}var u=f.prototype;Object.defineProperty(u,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(s){if(this.gl){this.fbo.shape=s;var l=this.fbo.shape[0],o=this.fbo.shape[1];if(o*l*4>this.buffer.length){d.free(this.buffer);for(var i=this.buffer=d.mallocUint8(p(o*l*4)),c=0;c<o*l*4;++c)i[c]=255}return s}}}),u.begin=function(){var s=this.gl;this.shape,s&&(this.fbo.bind(),s.clearColor(1,1,1,1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT))},u.end=function(){var s=this.gl;s&&(s.bindFramebuffer(s.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},u.query=function(s,l,o){if(!this.gl)return null;var i=this.fbo.shape.slice();s|=0,l|=0,typeof o!="number"&&(o=1);var c=0|Math.min(Math.max(s-o,0),i[0]),n=0|Math.min(Math.max(s+o,0),i[0]),a=0|Math.min(Math.max(l-o,0),i[1]),g=0|Math.min(Math.max(l+o,0),i[1]);if(n<=c||g<=a)return null;var h=[n-c,g-a],y=m(this.buffer,[h[0],h[1],4],[4,4*i[0],1],4*(c+i[0]*a)),v=function(T,A,S){for(var w=1e8,C=-1,k=-1,L=T.shape[0],M=T.shape[1],P=0;P<L;P++)for(var D=0;D<M;D++){var N=T.get(P,D,0),U=T.get(P,D,1),q=T.get(P,D,2),X=T.get(P,D,3);if(N<255||U<255||q<255||X<255){var K=A-P,Z=S-D,H=K*K+Z*Z;H<w&&(w=H,C=P,k=D)}}return[C,k,w]}(y.hi(h[0],h[1],1),o,o),_=v[0],x=v[1];return _<0||Math.pow(this.radius,2)<v[2]?null:new e(_+c|0,x+a|0,y.get(_,x,0),[y.get(_,x,1),y.get(_,x,2),y.get(_,x,3)],Math.sqrt(v[2]))},u.dispose=function(){this.gl&&(this.fbo.dispose(),d.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":104,"gl-fbo":270,ndarray:472,"typedarray-pool":601}],332:[function(r,O,B){var t=r("./lib/create-uniforms"),d=r("./lib/create-attributes"),m=r("./lib/reflect"),p=r("./lib/shader-cache"),e=r("./lib/runtime-reflect"),f=r("./lib/GLError");function u(o){this.gl=o,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var s=u.prototype;function l(o,i){return o.name<i.name?-1:1}s.bind=function(){var o;this.program||this._relink();var i=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),c=this.gl.lastAttribCount;if(i>c)for(o=c;o<i;o++)this.gl.enableVertexAttribArray(o);else if(c>i)for(o=i;o<c;o++)this.gl.disableVertexAttribArray(o);this.gl.lastAttribCount=i,this.gl.useProgram(this.program)},s.dispose=function(){for(var o=this.gl.lastAttribCount,i=0;i<o;i++)this.gl.disableVertexAttribArray(i);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},s.update=function(o,i,c,n){if(!i||arguments.length===1){var a=o;o=a.vertex,i=a.fragment,c=a.uniforms,n=a.attributes}var g=this,h=g.gl,y=g._vref;g._vref=p.shader(h,h.VERTEX_SHADER,o),y&&y.dispose(),g.vertShader=g._vref.shader;var v=this._fref;if(g._fref=p.shader(h,h.FRAGMENT_SHADER,i),v&&v.dispose(),g.fragShader=g._fref.shader,!c||!n){var _=h.createProgram();if(h.attachShader(_,g.fragShader),h.attachShader(_,g.vertShader),h.linkProgram(_),!h.getProgramParameter(_,h.LINK_STATUS)){var x=h.getProgramInfoLog(_);throw new f(x,"Error linking program:"+x)}c=c||e.uniforms(h,_),n=n||e.attributes(h,_),h.deleteProgram(_)}(n=n.slice()).sort(l);var T,A=[],S=[],w=[];for(T=0;T<n.length;++T){var C=n[T];if(C.type.indexOf("mat")>=0){for(var k=0|C.type.charAt(C.type.length-1),L=new Array(k),M=0;M<k;++M)L[M]=w.length,S.push(C.name+"["+M+"]"),typeof C.location=="number"?w.push(C.location+M):Array.isArray(C.location)&&C.location.length===k&&typeof C.location[M]=="number"?w.push(0|C.location[M]):w.push(-1);A.push({name:C.name,type:C.type,locations:L})}else A.push({name:C.name,type:C.type,locations:[w.length]}),S.push(C.name),typeof C.location=="number"?w.push(0|C.location):w.push(-1)}var P=0;for(T=0;T<w.length;++T)if(w[T]<0){for(;w.indexOf(P)>=0;)P+=1;w[T]=P}var D=new Array(c.length);function N(){g.program=p.program(h,g._vref,g._fref,S,w);for(var U=0;U<c.length;++U)D[U]=h.getUniformLocation(g.program,c[U].name)}N(),g._relink=N,g.types={uniforms:m(c),attributes:m(n)},g.attributes=d(h,g,A,w),Object.defineProperty(g,"uniforms",t(h,g,c,D))},O.exports=function(o,i,c,n,a){var g=new u(o);return g.update(i,c,n,a),g}},{"./lib/GLError":333,"./lib/create-attributes":334,"./lib/create-uniforms":335,"./lib/reflect":336,"./lib/runtime-reflect":337,"./lib/shader-cache":338}],333:[function(r,O,B){function t(d,m,p){this.shortMessage=m||"",this.longMessage=p||"",this.rawError=d||"",this.message="gl-shader: "+(m||d||"")+(p?`
`+p:""),this.stack=new Error().stack}t.prototype=new Error,t.prototype.name="GLError",t.prototype.constructor=t,O.exports=t},{}],334:[function(r,O,B){O.exports=function(u,s,l,o){for(var i={},c=0,n=l.length;c<n;++c){var a=l[c],g=a.name,h=a.type,y=a.locations;switch(h){case"bool":case"int":case"float":e(u,s,y[0],o,1,i,g);break;default:if(h.indexOf("vec")>=0){if((v=h.charCodeAt(h.length-1)-48)<2||v>4)throw new t("","Invalid data type for attribute "+g+": "+h);e(u,s,y[0],o,v,i,g)}else{if(!(h.indexOf("mat")>=0))throw new t("","Unknown data type for attribute "+g+": "+h);var v;if((v=h.charCodeAt(h.length-1)-48)<2||v>4)throw new t("","Invalid data type for attribute "+g+": "+h);f(u,s,y,o,v,i,g)}}}return i};var t=r("./GLError");function d(u,s,l,o,i,c){this._gl=u,this._wrapper=s,this._index=l,this._locations=o,this._dimension=i,this._constFunc=c}var m=d.prototype;m.pointer=function(u,s,l,o){var i=this._gl,c=this._locations[this._index];i.vertexAttribPointer(c,this._dimension,u||i.FLOAT,!!s,l||0,o||0),i.enableVertexAttribArray(c)},m.set=function(u,s,l,o){return this._constFunc(this._locations[this._index],u,s,l,o)},Object.defineProperty(m,"location",{get:function(){return this._locations[this._index]},set:function(u){return u!==this._locations[this._index]&&(this._locations[this._index]=0|u,this._wrapper.program=null),0|u}});var p=[function(u,s,l){return l.length===void 0?u.vertexAttrib1f(s,l):u.vertexAttrib1fv(s,l)},function(u,s,l,o){return l.length===void 0?u.vertexAttrib2f(s,l,o):u.vertexAttrib2fv(s,l)},function(u,s,l,o,i){return l.length===void 0?u.vertexAttrib3f(s,l,o,i):u.vertexAttrib3fv(s,l)},function(u,s,l,o,i,c){return l.length===void 0?u.vertexAttrib4f(s,l,o,i,c):u.vertexAttrib4fv(s,l)}];function e(u,s,l,o,i,c,n){var a=p[i],g=new d(u,s,l,o,i,a);Object.defineProperty(c,n,{set:function(h){return u.disableVertexAttribArray(o[l]),a(u,o[l],h),h},get:function(){return g},enumerable:!0})}function f(u,s,l,o,i,c,n){for(var a=new Array(i),g=new Array(i),h=0;h<i;++h)e(u,s,l[h],o,i,a,h),g[h]=a[h];Object.defineProperty(a,"location",{set:function(_){if(Array.isArray(_))for(var x=0;x<i;++x)g[x].location=_[x];else for(x=0;x<i;++x)g[x].location=_+x;return _},get:function(){for(var _=new Array(i),x=0;x<i;++x)_[x]=o[l[x]];return _},enumerable:!0}),a.pointer=function(_,x,T,A){_=_||u.FLOAT,x=!!x,T=T||i*i,A=A||0;for(var S=0;S<i;++S){var w=o[l[S]];u.vertexAttribPointer(w,i,_,x,T,A+S*i),u.enableVertexAttribArray(w)}};var y=new Array(i),v=u["vertexAttrib"+i+"fv"];Object.defineProperty(c,n,{set:function(_){for(var x=0;x<i;++x){var T=o[l[x]];if(u.disableVertexAttribArray(T),Array.isArray(_[0]))v.call(u,T,_[x]);else{for(var A=0;A<i;++A)y[A]=_[i*x+A];v.call(u,T,y)}}return _},get:function(){return a},enumerable:!0})}},{"./GLError":333}],335:[function(r,O,B){var t=r("./reflect"),d=r("./GLError");function m(e){return function(){return e}}function p(e,f){for(var u=new Array(e),s=0;s<e;++s)u[s]=f;return u}O.exports=function(e,f,u,s){function l(n){return function(a){for(var g=function M(P,D){if(typeof D!="object")return[[P,D]];var N=[];for(var U in D){var q=D[U],X=P;parseInt(U)+""===U?X+="["+U+"]":X+="."+U,typeof q=="object"?N.push.apply(N,M(X,q)):N.push([X,q])}return N}("",n),h=0;h<g.length;++h){var y=g[h],v=y[0],_=y[1];if(s[_]){var x=a;if(typeof v=="string"&&(v.indexOf(".")===0||v.indexOf("[")===0)){var T=v;if(v.indexOf(".")===0&&(T=v.slice(1)),T.indexOf("]")===T.length-1){var A=T.indexOf("["),S=T.slice(0,A),w=T.slice(A+1,T.length-1);x=S?a[S][w]:a[w]}else x=a[T]}var C,k=u[_].type;switch(k){case"bool":case"int":case"sampler2D":case"samplerCube":e.uniform1i(s[_],x);break;case"float":e.uniform1f(s[_],x);break;default:var L=k.indexOf("vec");if(!(0<=L&&L<=1&&k.length===4+L)){if(k.indexOf("mat")===0&&k.length===4){if((C=k.charCodeAt(k.length-1)-48)<2||C>4)throw new d("","Invalid uniform dimension type for matrix "+name+": "+k);e["uniformMatrix"+C+"fv"](s[_],!1,x);break}throw new d("","Unknown uniform data type for "+name+": "+k)}if((C=k.charCodeAt(k.length-1)-48)<2||C>4)throw new d("","Invalid data type");switch(k.charAt(0)){case"b":case"i":e["uniform"+C+"iv"](s[_],x);break;case"v":e["uniform"+C+"fv"](s[_],x);break;default:throw new d("","Unrecognized data type for vector "+name+": "+k)}}}}}}function o(n,a,g){if(typeof g=="object"){var h=i(g);Object.defineProperty(n,a,{get:m(h),set:l(g),enumerable:!0,configurable:!1})}else s[g]?Object.defineProperty(n,a,{get:(y=g,function(v,_,x){return v.getUniform(_.program,x[y])}),set:l(g),enumerable:!0,configurable:!1}):n[a]=function(v){switch(v){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":case"float":return 0;default:var _=v.indexOf("vec");if(0<=_&&_<=1&&v.length===4+_){if((x=v.charCodeAt(v.length-1)-48)<2||x>4)throw new d("","Invalid data type");return v.charAt(0)==="b"?p(x,!1):p(x,0)}if(v.indexOf("mat")===0&&v.length===4){var x;if((x=v.charCodeAt(v.length-1)-48)<2||x>4)throw new d("","Invalid uniform dimension type for matrix "+name+": "+v);return p(x*x,0)}throw new d("","Unknown uniform data type for "+name+": "+v)}}(u[g].type);var y}function i(n){var a;if(Array.isArray(n)){a=new Array(n.length);for(var g=0;g<n.length;++g)o(a,g,n[g])}else for(var h in a={},n)o(a,h,n[h]);return a}var c=t(u,!0);return{get:m(i(c)),set:l(c),enumerable:!0,configurable:!0}}},{"./GLError":333,"./reflect":336}],336:[function(r,O,B){O.exports=function(t,d){for(var m={},p=0;p<t.length;++p)for(var e=t[p].name.split("."),f=m,u=0;u<e.length;++u){var s=e[u].split("[");if(s.length>1){s[0]in f||(f[s[0]]=[]),f=f[s[0]];for(var l=1;l<s.length;++l){var o=parseInt(s[l]);l<s.length-1||u<e.length-1?(o in f||(l<s.length-1?f[o]=[]:f[o]={}),f=f[o]):f[o]=d?p:t[p].type}}else u<e.length-1?(s[0]in f||(f[s[0]]={}),f=f[s[0]]):f[s[0]]=d?p:t[p].type}return m}},{}],337:[function(r,O,B){B.uniforms=function(p,e){for(var f=p.getProgramParameter(e,p.ACTIVE_UNIFORMS),u=[],s=0;s<f;++s){var l=p.getActiveUniform(e,s);if(l){var o=m(p,l.type);if(l.size>1)for(var i=0;i<l.size;++i)u.push({name:l.name.replace("[0]","["+i+"]"),type:o});else u.push({name:l.name,type:o})}}return u},B.attributes=function(p,e){for(var f=p.getProgramParameter(e,p.ACTIVE_ATTRIBUTES),u=[],s=0;s<f;++s){var l=p.getActiveAttrib(e,s);l&&u.push({name:l.name,type:m(p,l.type)})}return u};var t={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},d=null;function m(p,e){if(!d){var f=Object.keys(t);d={};for(var u=0;u<f.length;++u){var s=f[u];d[p[s]]=t[s]}}return d[e]}},{}],338:[function(r,O,B){B.shader=function(l,o,i){return s(l).getShaderReference(o,i)},B.program=function(l,o,i,c,n){return s(l).getProgram(o,i,c,n)};var t=r("./GLError"),d=r("gl-format-compiler-error"),m=new(typeof WeakMap=="undefined"?r("weakmap-shim"):WeakMap),p=0;function e(l,o,i,c,n,a,g){this.id=l,this.src=o,this.type=i,this.shader=c,this.count=a,this.programs=[],this.cache=g}function f(l){this.gl=l,this.shaders=[{},{}],this.programs={}}e.prototype.dispose=function(){if(--this.count==0){for(var l=this.cache,o=l.gl,i=this.programs,c=0,n=i.length;c<n;++c){var a=l.programs[i[c]];a&&(delete l.programs[c],o.deleteProgram(a))}o.deleteShader(this.shader),delete l.shaders[this.type===o.FRAGMENT_SHADER|0][this.src]}};var u=f.prototype;function s(l){var o=m.get(l);return o||(o=new f(l),m.set(l,o)),o}u.getShaderReference=function(l,o){var i=this.gl,c=this.shaders[l===i.FRAGMENT_SHADER|0],n=c[o];if(n&&i.isShader(n.shader))n.count+=1;else{var a=function(g,h,y){var v=g.createShader(h);if(g.shaderSource(v,y),g.compileShader(v),!g.getShaderParameter(v,g.COMPILE_STATUS)){var _=g.getShaderInfoLog(v);try{var x=d(_,y,h)}catch(T){throw console.warn("Failed to format compiler error: "+T),new t(_,`Error compiling shader:
`+_)}throw new t(_,x.short,x.long)}return v}(i,l,o);n=c[o]=new e(p++,o,l,a,[],1,this)}return n},u.getProgram=function(l,o,i,c){var n=[l.id,o.id,i.join(":"),c.join(":")].join("@"),a=this.programs[n];return a&&this.gl.isProgram(a)||(this.programs[n]=a=function(g,h,y,v,_){var x=g.createProgram();g.attachShader(x,h),g.attachShader(x,y);for(var T=0;T<v.length;++T)g.bindAttribLocation(x,_[T],v[T]);if(g.linkProgram(x),!g.getProgramParameter(x,g.LINK_STATUS)){var A=g.getProgramInfoLog(x);throw new t(A,"Error linking program: "+A)}return x}(this.gl,l.shader,o.shader,i,c),l.programs.push(n),o.programs.push(n)),a}},{"./GLError":333,"gl-format-compiler-error":271,"weakmap-shim":612}],339:[function(r,O,B){function t(m){this.plot=m,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}O.exports=function(m,p){var e=new t(m);return e.update(p),m.addOverlay(e),e};var d=t.prototype;d.update=function(m){m=m||{},this.enable=(m.enable||[!0,!0,!1,!1]).slice(),this.width=(m.width||[1,1,1,1]).slice(),this.color=(m.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(p){return p.slice()}),this.center=(m.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},d.draw=function(){var m=this.enable,p=this.width,e=this.color,f=this.center,u=this.plot,s=u.line,l=u.dataBox,o=u.viewBox;if(s.bind(),l[0]<=f[0]&&f[0]<=l[2]&&l[1]<=f[1]&&f[1]<=l[3]){var i=o[0]+(f[0]-l[0])/(l[2]-l[0])*(o[2]-o[0]),c=o[1]+(f[1]-l[1])/(l[3]-l[1])*(o[3]-o[1]);m[0]&&s.drawLine(i,c,o[0],c,p[0],e[0]),m[1]&&s.drawLine(i,c,i,o[1],p[1],e[1]),m[2]&&s.drawLine(i,c,o[2],c,p[2],e[2]),m[3]&&s.drawLine(i,c,i,o[3],p[3],e[3])}},d.dispose=function(){this.plot.removeOverlay(this)}},{}],340:[function(r,O,B){var t=r("glslify"),d=r("gl-shader"),m=t([`precision mediump float;
#define GLSLIFY 1

attribute vec3 position, color;
attribute float weight;

uniform mat4 model, view, projection;
uniform vec3 coordinates[3];
uniform vec4 colors[3];
uniform vec2 screenShape;
uniform float lineWidth;

varying vec4 fragColor;

void main() {
  vec3 vertexPosition = mix(coordinates[0],
    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));

  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);
  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;
  vec2 delta = weight * clipOffset * screenShape;
  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;

  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);
  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];
}
`]),p=t([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
  gl_FragColor = fragColor;
}`]);O.exports=function(e){return d(e,m,p,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":332,glslify:434}],341:[function(r,O,B){var t=r("gl-buffer"),d=r("gl-vao"),m=r("./shaders/index");O.exports=function(o,i){var c=[];function n(v,_,x,T,A,S){var w=[v,_,x,0,0,0,1];w[T+3]=1,w[T]=A,c.push.apply(c,w),w[6]=-1,c.push.apply(c,w),w[T]=S,c.push.apply(c,w),c.push.apply(c,w),w[6]=1,c.push.apply(c,w),w[T]=A,c.push.apply(c,w)}n(0,0,0,0,0,1),n(0,0,0,1,0,1),n(0,0,0,2,0,1),n(1,0,0,1,-1,1),n(1,0,0,2,-1,1),n(0,1,0,0,-1,1),n(0,1,0,2,-1,1),n(0,0,1,0,-1,1),n(0,0,1,1,-1,1);var a=t(o,c),g=d(o,[{type:o.FLOAT,buffer:a,size:3,offset:0,stride:28},{type:o.FLOAT,buffer:a,size:3,offset:12,stride:28},{type:o.FLOAT,buffer:a,size:1,offset:24,stride:28}]),h=m(o);h.attributes.position.location=0,h.attributes.color.location=1,h.attributes.weight.location=2;var y=new e(o,a,g,h);return y.update(i),y};var p=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(o,i,c,n){this.gl=o,this.buffer=i,this.vao=c,this.shader=n,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var f=e.prototype,u=[0,0,0],s=[0,0,0],l=[0,0];f.isTransparent=function(){return!1},f.drawTransparent=function(o){},f.draw=function(o){var i=this.gl,c=this.vao,n=this.shader;c.bind(),n.bind();var a,g=o.model||p,h=o.view||p,y=o.projection||p;this.axes&&(a=this.axes.lastCubeProps.axis);for(var v=u,_=s,x=0;x<3;++x)a&&a[x]<0?(v[x]=this.bounds[0][x],_[x]=this.bounds[1][x]):(v[x]=this.bounds[1][x],_[x]=this.bounds[0][x]);for(l[0]=i.drawingBufferWidth,l[1]=i.drawingBufferHeight,n.uniforms.model=g,n.uniforms.view=h,n.uniforms.projection=y,n.uniforms.coordinates=[this.position,v,_],n.uniforms.colors=this.colors,n.uniforms.screenShape=l,x=0;x<3;++x)n.uniforms.lineWidth=this.lineWidth[x]*this.pixelRatio,this.enabled[x]&&(c.draw(i.TRIANGLES,6,6*x),this.drawSides[x]&&c.draw(i.TRIANGLES,12,18+12*x));c.unbind()},f.update=function(o){o&&("bounds"in o&&(this.bounds=o.bounds),"position"in o&&(this.position=o.position),"lineWidth"in o&&(this.lineWidth=o.lineWidth),"colors"in o&&(this.colors=o.colors),"enabled"in o&&(this.enabled=o.enabled),"drawSides"in o&&(this.drawSides=o.drawSides))},f.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":340,"gl-buffer":261,"gl-vao":353}],342:[function(r,O,B){var t=r("glslify"),d=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, tubeScale;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * tubePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(tubePosition, 1.0);
  vec4 t_position  = view * tubePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = tubePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),m=t([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),p=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float tubeScale;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  gl_Position = projection * view * tubePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),e=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);B.meshShader={vertex:d,fragment:m,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},B.pickShader={vertex:p,fragment:e,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:343}],343:[function(r,O,B){arguments[4][268][0].apply(B,arguments)},{dup:268}],344:[function(r,O,B){var t=r("gl-vec3"),d=r("gl-vec4"),m=["xyz","xzy","yxz","yzx","zxy","zyx"],p=function(o,i,c,n){for(var a=0,g=0;g<o.length;g++)for(var h=o[g].velocities,y=0;y<h.length;y++)a=Math.max(a,t.length(h[y]));var v=o.map(function(M){return function(P,D,N,U){for(var q=P.points,X=P.velocities,K=P.divergences,Z=[],H=[],Y=[],$=[],z=[],j=[],W=0,ee=0,J=d.create(),Q=d.create(),te=0;te<q.length;te++){var ie=q[te],ae=X[te],he=K[te];D===0&&(he=.05*N),ee=t.length(ae)/U,J=d.create(),t.copy(J,ae),J[3]=he;for(var se=0;se<8;se++)z[se]=[ie[0],ie[1],ie[2],se];if($.length>0)for(se=0;se<8;se++){var de=(se+1)%8;Z.push($[se],z[se],z[de],z[de],$[de],$[se]),Y.push(Q,J,J,J,Q,Q),j.push(W,ee,ee,ee,W,W);var ue=Z.length;H.push([ue-6,ue-5,ue-4],[ue-3,ue-2,ue-1])}var ve=$;$=z,z=ve;var ke=Q;Q=J,J=ke;var Ee=W;W=ee,ee=Ee}return{positions:Z,cells:H,vectors:Y,vertexIntensity:j}}(M,c,n,a)}),_=[],x=[],T=[],A=[];for(g=0;g<v.length;g++){var S=v[g],w=_.length;for(_=_.concat(S.positions),T=T.concat(S.vectors),A=A.concat(S.vertexIntensity),y=0;y<S.cells.length;y++){var C=S.cells[y],k=[];x.push(k);for(var L=0;L<C.length;L++)k.push(C[L]+w)}}return{positions:_,cells:x,vectors:T,vertexIntensity:A,colormap:i}},e=function(o,i){var c,n=o.length;for(c=0;c<n;c++){var a=o[c];if(a===i)return c;if(a>i)return c-1}return c},f=function(o,i,c){return o<i?i:o>c?c:o},u=function(o){var i=1/0;o.sort(function(g,h){return g-h});for(var c=o.length,n=1;n<c;n++){var a=Math.abs(o[n]-o[n-1]);a<i&&(i=a)}return i};O.exports=function(o,i){var c=o.startingPositions,n=o.maxLength||1e3,a=o.tubeSize||1,g=o.absoluteTubeSize,h=o.gridFill||"+x+y+z",y={};h.indexOf("-x")!==-1&&(y.reversedX=!0),h.indexOf("-y")!==-1&&(y.reversedY=!0),h.indexOf("-z")!==-1&&(y.reversedZ=!0),y.filled=m.indexOf(h.replace(/-/g,"").replace(/\+/g,""));var v=o.getVelocity||function(te){return function(ie,ae,he){var se=ae.vectors,de=ae.meshgrid,ue=ie[0],ve=ie[1],ke=ie[2],Ee=de[0].length,be=de[1].length,xe=de[2].length,ce=e(de[0],ue),ge=e(de[1],ve),we=e(de[2],ke),Me=ce+1,Se=ge+1,ze=we+1;if(ce=f(ce,0,Ee-1),Me=f(Me,0,Ee-1),ge=f(ge,0,be-1),Se=f(Se,0,be-1),we=f(we,0,xe-1),ze=f(ze,0,xe-1),ce<0||ge<0||we<0||Me>Ee-1||Se>be-1||ze>xe-1)return t.create();var Fe,Ye,rt,Oe,je,We,qe=de[0][ce],Qe=de[0][Me],st=de[1][ge],ct=de[1][Se],Pt=de[2][we],kt=(ue-qe)/(Qe-qe),at=(ve-st)/(ct-st),tt=(ke-Pt)/(de[2][ze]-Pt);switch(isFinite(kt)||(kt=.5),isFinite(at)||(at=.5),isFinite(tt)||(tt=.5),he.reversedX&&(ce=Ee-1-ce,Me=Ee-1-Me),he.reversedY&&(ge=be-1-ge,Se=be-1-Se),he.reversedZ&&(we=xe-1-we,ze=xe-1-ze),he.filled){case 5:je=we,We=ze,rt=ge*xe,Oe=Se*xe,Fe=ce*xe*be,Ye=Me*xe*be;break;case 4:je=we,We=ze,Fe=ce*xe,Ye=Me*xe,rt=ge*xe*Ee,Oe=Se*xe*Ee;break;case 3:rt=ge,Oe=Se,je=we*be,We=ze*be,Fe=ce*be*xe,Ye=Me*be*xe;break;case 2:rt=ge,Oe=Se,Fe=ce*be,Ye=Me*be,je=we*be*Ee,We=ze*be*Ee;break;case 1:Fe=ce,Ye=Me,je=we*Ee,We=ze*Ee,rt=ge*Ee*xe,Oe=Se*Ee*xe;break;default:Fe=ce,Ye=Me,rt=ge*Ee,Oe=Se*Ee,je=we*Ee*be,We=ze*Ee*be}var _t=se[Fe+rt+je],er=se[Fe+rt+We],tr=se[Fe+Oe+je],Ue=se[Fe+Oe+We],He=se[Ye+rt+je],Be=se[Ye+rt+We],Ke=se[Ye+Oe+je],_e=se[Ye+Oe+We],Ce=t.create(),Le=t.create(),Pe=t.create(),Xe=t.create();t.lerp(Ce,_t,He,kt),t.lerp(Le,er,Be,kt),t.lerp(Pe,tr,Ke,kt),t.lerp(Xe,Ue,_e,kt);var ht=t.create(),Mt=t.create();t.lerp(ht,Ce,Pe,at),t.lerp(Mt,Le,Xe,at);var pt=t.create();return t.lerp(pt,ht,Mt,tt),pt}(te,o,y)},_=o.getDivergence||function(te,ie){var ae=t.create(),he=1e-4;t.add(ae,te,[he,0,0]);var se=v(ae);t.subtract(se,se,ie),t.scale(se,se,1/he),t.add(ae,te,[0,he,0]);var de=v(ae);t.subtract(de,de,ie),t.scale(de,de,1/he),t.add(ae,te,[0,0,he]);var ue=v(ae);return t.subtract(ue,ue,ie),t.scale(ue,ue,1/he),t.add(ae,se,de),t.add(ae,ae,ue),ae},x=[],T=i[0][0],A=i[0][1],S=i[0][2],w=i[1][0],C=i[1][1],k=i[1][2],L=function(te){var ie=te[0],ae=te[1],he=te[2];return!(ie<T||ie>w||ae<A||ae>C||he<S||he>k)},M=10*t.distance(i[0],i[1])/n,P=M*M,D=1,N=0,U=c.length;U>1&&(D=function(te){for(var ie=[],ae=[],he=[],se={},de={},ue={},ve=te.length,ke=0;ke<ve;ke++){var Ee=te[ke],be=Ee[0],xe=Ee[1],ce=Ee[2];se[be]||(ie.push(be),se[be]=!0),de[xe]||(ae.push(xe),de[xe]=!0),ue[ce]||(he.push(ce),ue[ce]=!0)}var ge=u(ie),we=u(ae),Me=u(he),Se=Math.min(ge,we,Me);return isFinite(Se)?Se:1}(c));for(var q=0;q<U;q++){var X=t.create();t.copy(X,c[q]);var K=[X],Z=[],H=v(X),Y=X;Z.push(H);var $=[],z=_(X,H),j=t.length(z);isFinite(j)&&j>N&&(N=j),$.push(j),x.push({points:K,velocities:Z,divergences:$});for(var W=0;W<100*n&&K.length<n&&L(X);){W++;var ee=t.clone(H),J=t.squaredLength(ee);if(J===0)break;J>P&&t.scale(ee,ee,M/Math.sqrt(J)),t.add(ee,ee,X),H=v(ee),t.squaredDistance(Y,ee)-P>-1e-4*P&&(K.push(ee),Y=ee,Z.push(H),z=_(ee,H),j=t.length(z),isFinite(j)&&j>N&&(N=j),$.push(j)),X=ee}}var Q=p(x,o.colormap,N,D);return g?Q.tubeScale=g:(N===0&&(N=1),Q.tubeScale=.5*a*D/N),Q};var s=r("./lib/shaders"),l=r("gl-cone3d").createMesh;O.exports.createTubeMesh=function(o,i){return l(o,i,{shaders:s,traceType:"streamtube"})}},{"./lib/shaders":342,"gl-cone3d":262,"gl-vec3":372,"gl-vec4":408}],345:[function(r,O,B){var t=r("gl-shader"),d=r("glslify"),m=d([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute vec3 f;
attribute vec3 normal;

uniform vec3 objectOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 lightPosition, eyePosition;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 localCoordinate = vec3(uv.zw, f.x);
  worldCoordinate = objectOffset + localCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);
  vec4 clipPosition = projection * view * worldPosition;
  gl_Position = clipPosition;
  kill = f.y;
  value = f.z;
  planeCoordinate = uv.xy;

  vColor = texture2D(colormap, vec2(value, value));

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * worldPosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  lightDirection = lightPosition - cameraCoordinate.xyz;
  eyeDirection   = eyePosition - cameraCoordinate.xyz;
  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);
}
`]),p=d([`precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float beckmannSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness) {
  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 lowerBound, upperBound;
uniform float contourTint;
uniform vec4 contourColor;
uniform sampler2D colormap;
uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform float vertexColor;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  if (
    kill > 0.0 ||
    vColor.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)
  ) discard;

  vec3 N = normalize(surfaceNormal);
  vec3 V = normalize(eyeDirection);
  vec3 L = normalize(lightDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  //decide how to interpolate color \u2014 in vertex or in fragment
  vec4 surfaceColor =
    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +
    step(.5, vertexColor) * vColor;

  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;
}
`]),e=d([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute float f;

uniform vec3 objectOffset;
uniform mat3 permutation;
uniform mat4 model, view, projection;
uniform float height, zOffset;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 dataCoordinate = permutation * vec3(uv.xy, height);
  worldCoordinate = objectOffset + dataCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);

  vec4 clipPosition = projection * view * worldPosition;
  clipPosition.z += zOffset;

  gl_Position = clipPosition;
  value = f + objectOffset.z;
  kill = -1.0;
  planeCoordinate = uv.zw;

  vColor = texture2D(colormap, vec2(value, value));

  //Don't do lighting for contours
  surfaceNormal   = vec3(1,0,0);
  eyeDirection    = vec3(0,1,0);
  lightDirection  = vec3(0,0,1);
}
`]),f=d([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec2 shape;
uniform vec3 clipBounds[2];
uniform float pickId;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 surfaceNormal;

vec2 splitFloat(float v) {
  float vh = 255.0 * v;
  float upper = floor(vh);
  float lower = fract(vh);
  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);
}

void main() {
  if ((kill > 0.0) ||
      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;

  vec2 ux = splitFloat(planeCoordinate.x / shape.x);
  vec2 uy = splitFloat(planeCoordinate.y / shape.y);
  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));
}
`]);B.createShader=function(u){var s=t(u,m,p,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return s.attributes.uv.location=0,s.attributes.f.location=1,s.attributes.normal.location=2,s},B.createPickShader=function(u){var s=t(u,m,f,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return s.attributes.uv.location=0,s.attributes.f.location=1,s.attributes.normal.location=2,s},B.createContourShader=function(u){var s=t(u,e,p,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return s.attributes.uv.location=0,s.attributes.f.location=1,s},B.createPickContourShader=function(u){var s=t(u,e,f,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return s.attributes.uv.location=0,s.attributes.f.location=1,s}},{"gl-shader":332,glslify:434}],346:[function(r,O,B){O.exports=function(H){var Y=H.gl,$=h(Y),z=v(Y),j=y(Y),W=_(Y),ee=d(Y),J=m(Y,[{buffer:ee,size:4,stride:40,offset:0},{buffer:ee,size:3,stride:40,offset:16},{buffer:ee,size:3,stride:40,offset:28}]),Q=d(Y),te=m(Y,[{buffer:Q,size:4,stride:20,offset:0},{buffer:Q,size:1,stride:20,offset:16}]),ie=d(Y),ae=m(Y,[{buffer:ie,size:2,type:Y.FLOAT}]),he=p(Y,1,256,Y.RGBA,Y.UNSIGNED_BYTE);he.minFilter=Y.LINEAR,he.magFilter=Y.LINEAR;var se=new w(Y,[0,0],[[0,0,0],[0,0,0]],$,z,ee,J,he,j,W,Q,te,ie,ae,[0,0,0]),de={levels:[[],[],[]]};for(var ue in H)de[ue]=H[ue];return de.colormap=de.colormap||"jet",se.update(de),se};var t=r("bit-twiddle"),d=r("gl-buffer"),m=r("gl-vao"),p=r("gl-texture2d"),e=r("typedarray-pool"),f=r("colormap"),u=r("ndarray-ops"),s=r("ndarray-pack"),l=r("ndarray"),o=r("surface-nets"),i=r("gl-mat4/multiply"),c=r("gl-mat4/invert"),n=r("binary-search-bounds"),a=r("ndarray-gradient"),g=r("./lib/shaders"),h=g.createShader,y=g.createContourShader,v=g.createPickShader,_=g.createPickContourShader,x=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],T=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],A=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function S(H,Y,$,z,j){this.position=H,this.index=Y,this.uv=$,this.level=z,this.dataCoordinate=j}(function(){for(var H=0;H<3;++H){var Y=A[H],$=(H+2)%3;Y[(H+1)%3+0]=1,Y[$+3]=1,Y[H+6]=1}})();function w(H,Y,$,z,j,W,ee,J,Q,te,ie,ae,he,se,de){this.gl=H,this.shape=Y,this.bounds=$,this.objectOffset=de,this.intensityBounds=[],this._shader=z,this._pickShader=j,this._coordinateBuffer=W,this._vao=ee,this._colorMap=J,this._contourShader=Q,this._contourPickShader=te,this._contourBuffer=ie,this._contourVAO=ae,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new S([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=he,this._dynamicVAO=se,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[l(e.mallocFloat(1024),[0,0]),l(e.mallocFloat(1024),[0,0]),l(e.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var C=w.prototype;C.genColormap=function(H,Y){var $=!1,z=s([f({colormap:H,nshades:256,format:"rgba"}).map(function(j,W){var ee=Y?function(J,Q){if(!Q||!Q.length)return 1;for(var te=0;te<Q.length;++te){if(Q.length<2)return 1;if(Q[te][0]===J)return Q[te][1];if(Q[te][0]>J&&te>0){var ie=(Q[te][0]-J)/(Q[te][0]-Q[te-1][0]);return Q[te][1]*(1-ie)+ie*Q[te-1][1]}}return 1}(W/255,Y):j[3];return ee<1&&($=!0),[j[0],j[1],j[2],255*ee]})]);return u.divseq(z,255),this.hasAlphaScale=$,z},C.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},C.isOpaque=function(){return!this.isTransparent()},C.pickSlots=1,C.setPickBase=function(H){this.pickId=H};var k=[0,0,0],L={showSurface:!1,showContour:!1,projections:[x.slice(),x.slice(),x.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function M(H,Y){var $,z,j,W=Y.axes&&Y.axes.lastCubeProps.axis||k,ee=Y.showSurface,J=Y.showContour;for($=0;$<3;++$)for(ee=ee||Y.surfaceProject[$],z=0;z<3;++z)J=J||Y.contourProject[$][z];for($=0;$<3;++$){var Q=L.projections[$];for(z=0;z<16;++z)Q[z]=0;for(z=0;z<4;++z)Q[5*z]=1;Q[5*$]=0,Q[12+$]=Y.axesBounds[+(W[$]>0)][$],i(Q,H.model,Q);var te=L.clipBounds[$];for(j=0;j<2;++j)for(z=0;z<3;++z)te[j][z]=H.clipBounds[j][z];te[0][$]=-1e8,te[1][$]=1e8}return L.showSurface=ee,L.showContour=J,L}var P={model:x,view:x,projection:x,inverseModel:x.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},D=x.slice(),N=[1,0,0,0,1,0,0,0,1];function U(H,Y){H=H||{};var $=this.gl;$.disable($.CULL_FACE),this._colorMap.bind(0);var z=P;z.model=H.model||x,z.view=H.view||x,z.projection=H.projection||x,z.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],z.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],z.objectOffset=this.objectOffset,z.contourColor=this.contourColor[0],z.inverseModel=c(z.inverseModel,z.model);for(var j=0;j<2;++j)for(var W=z.clipBounds[j],ee=0;ee<3;++ee)W[ee]=Math.min(Math.max(this.clipBounds[j][ee],-1e8),1e8);z.kambient=this.ambientLight,z.kdiffuse=this.diffuseLight,z.kspecular=this.specularLight,z.roughness=this.roughness,z.fresnel=this.fresnel,z.opacity=this.opacity,z.height=0,z.permutation=N,z.vertexColor=this.vertexColor;var J=D;for(i(J,z.view,z.model),i(J,z.projection,J),c(J,J),j=0;j<3;++j)z.eyePosition[j]=J[12+j]/J[15];var Q=J[15];for(j=0;j<3;++j)Q+=this.lightPosition[j]*J[4*j+3];for(j=0;j<3;++j){var te=J[12+j];for(ee=0;ee<3;++ee)te+=J[4*ee+j]*this.lightPosition[ee];z.lightPosition[j]=te/Q}var ie=M(z,this);if(ie.showSurface){for(this._shader.bind(),this._shader.uniforms=z,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw($.TRIANGLES,this._vertexCount),j=0;j<3;++j)this.surfaceProject[j]&&this.vertexCount&&(this._shader.uniforms.model=ie.projections[j],this._shader.uniforms.clipBounds=ie.clipBounds[j],this._vao.draw($.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ie.showContour){var ae=this._contourShader;z.kambient=1,z.kdiffuse=0,z.kspecular=0,z.opacity=1,ae.bind(),ae.uniforms=z;var he=this._contourVAO;for(he.bind(),j=0;j<3;++j)for(ae.uniforms.permutation=A[j],$.lineWidth(this.contourWidth[j]*this.pixelRatio),ee=0;ee<this.contourLevels[j].length;++ee)ee===this.highlightLevel[j]?(ae.uniforms.contourColor=this.highlightColor[j],ae.uniforms.contourTint=this.highlightTint[j]):ee!==0&&ee-1!==this.highlightLevel[j]||(ae.uniforms.contourColor=this.contourColor[j],ae.uniforms.contourTint=this.contourTint[j]),this._contourCounts[j][ee]&&(ae.uniforms.height=this.contourLevels[j][ee],he.draw($.LINES,this._contourCounts[j][ee],this._contourOffsets[j][ee]));for(j=0;j<3;++j)for(ae.uniforms.model=ie.projections[j],ae.uniforms.clipBounds=ie.clipBounds[j],ee=0;ee<3;++ee)if(this.contourProject[j][ee]){ae.uniforms.permutation=A[ee],$.lineWidth(this.contourWidth[ee]*this.pixelRatio);for(var se=0;se<this.contourLevels[ee].length;++se)se===this.highlightLevel[ee]?(ae.uniforms.contourColor=this.highlightColor[ee],ae.uniforms.contourTint=this.highlightTint[ee]):se!==0&&se-1!==this.highlightLevel[ee]||(ae.uniforms.contourColor=this.contourColor[ee],ae.uniforms.contourTint=this.contourTint[ee]),this._contourCounts[ee][se]&&(ae.uniforms.height=this.contourLevels[ee][se],he.draw($.LINES,this._contourCounts[ee][se],this._contourOffsets[ee][se]))}for(he.unbind(),(he=this._dynamicVAO).bind(),j=0;j<3;++j)if(this._dynamicCounts[j]!==0)for(ae.uniforms.model=z.model,ae.uniforms.clipBounds=z.clipBounds,ae.uniforms.permutation=A[j],$.lineWidth(this.dynamicWidth[j]*this.pixelRatio),ae.uniforms.contourColor=this.dynamicColor[j],ae.uniforms.contourTint=this.dynamicTint[j],ae.uniforms.height=this.dynamicLevel[j],he.draw($.LINES,this._dynamicCounts[j],this._dynamicOffsets[j]),ee=0;ee<3;++ee)this.contourProject[ee][j]&&(ae.uniforms.model=ie.projections[ee],ae.uniforms.clipBounds=ie.clipBounds[ee],he.draw($.LINES,this._dynamicCounts[j],this._dynamicOffsets[j]));he.unbind()}}C.draw=function(H){return U.call(this,H,!1)},C.drawTransparent=function(H){return U.call(this,H,!0)};var q={model:x,view:x,projection:x,inverseModel:x,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function X(H,Y){return Array.isArray(H)?[Y(H[0]),Y(H[1]),Y(H[2])]:[Y(H),Y(H),Y(H)]}function K(H){return Array.isArray(H)?H.length===3?[H[0],H[1],H[2],1]:[H[0],H[1],H[2],H[3]]:[0,0,0,1]}function Z(H){if(Array.isArray(H)){if(Array.isArray(H))return[K(H[0]),K(H[1]),K(H[2])];var Y=K(H);return[Y.slice(),Y.slice(),Y.slice()]}}C.drawPick=function(H){H=H||{};var Y=this.gl;Y.disable(Y.CULL_FACE);var $=q;$.model=H.model||x,$.view=H.view||x,$.projection=H.projection||x,$.shape=this._field[2].shape,$.pickId=this.pickId/255,$.lowerBound=this.bounds[0],$.upperBound=this.bounds[1],$.objectOffset=this.objectOffset,$.permutation=N;for(var z=0;z<2;++z)for(var j=$.clipBounds[z],W=0;W<3;++W)j[W]=Math.min(Math.max(this.clipBounds[z][W],-1e8),1e8);var ee=M($,this);if(ee.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=$,this._vao.bind(),this._vao.draw(Y.TRIANGLES,this._vertexCount),z=0;z<3;++z)this.surfaceProject[z]&&(this._pickShader.uniforms.model=ee.projections[z],this._pickShader.uniforms.clipBounds=ee.clipBounds[z],this._vao.draw(Y.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ee.showContour){var J=this._contourPickShader;J.bind(),J.uniforms=$;var Q=this._contourVAO;for(Q.bind(),W=0;W<3;++W)for(Y.lineWidth(this.contourWidth[W]*this.pixelRatio),J.uniforms.permutation=A[W],z=0;z<this.contourLevels[W].length;++z)this._contourCounts[W][z]&&(J.uniforms.height=this.contourLevels[W][z],Q.draw(Y.LINES,this._contourCounts[W][z],this._contourOffsets[W][z]));for(z=0;z<3;++z)for(J.uniforms.model=ee.projections[z],J.uniforms.clipBounds=ee.clipBounds[z],W=0;W<3;++W)if(this.contourProject[z][W]){J.uniforms.permutation=A[W],Y.lineWidth(this.contourWidth[W]*this.pixelRatio);for(var te=0;te<this.contourLevels[W].length;++te)this._contourCounts[W][te]&&(J.uniforms.height=this.contourLevels[W][te],Q.draw(Y.LINES,this._contourCounts[W][te],this._contourOffsets[W][te]))}Q.unbind()}},C.pick=function(H){if(!H||H.id!==this.pickId)return null;var Y=this._field[2].shape,$=this._pickResult,z=Y[0]*(H.value[0]+(H.value[2]>>4)/16)/255,j=Math.floor(z),W=z-j,ee=Y[1]*(H.value[1]+(15&H.value[2])/16)/255,J=Math.floor(ee),Q=ee-J;j+=1,J+=1;var te=$.position;te[0]=te[1]=te[2]=0;for(var ie=0;ie<2;++ie)for(var ae=ie?W:1-W,he=0;he<2;++he)for(var se=j+ie,de=J+he,ue=ae*(he?Q:1-Q),ve=0;ve<3;++ve)te[ve]+=this._field[ve].get(se,de)*ue;for(var ke=this._pickResult.level,Ee=0;Ee<3;++Ee)if(ke[Ee]=n.le(this.contourLevels[Ee],te[Ee]),ke[Ee]<0)this.contourLevels[Ee].length>0&&(ke[Ee]=0);else if(ke[Ee]<this.contourLevels[Ee].length-1){var be=this.contourLevels[Ee][ke[Ee]],xe=this.contourLevels[Ee][ke[Ee]+1];Math.abs(be-te[Ee])>Math.abs(xe-te[Ee])&&(ke[Ee]+=1)}for($.index[0]=W<.5?j:j+1,$.index[1]=Q<.5?J:J+1,$.uv[0]=z/Y[0],$.uv[1]=ee/Y[1],ve=0;ve<3;++ve)$.dataCoordinate[ve]=this._field[ve].get($.index[0],$.index[1]);return $},C.padField=function(H,Y){var $=Y.shape.slice(),z=H.shape.slice();u.assign(H.lo(1,1).hi($[0],$[1]),Y),u.assign(H.lo(1).hi($[0],1),Y.hi($[0],1)),u.assign(H.lo(1,z[1]-1).hi($[0],1),Y.lo(0,$[1]-1).hi($[0],1)),u.assign(H.lo(0,1).hi(1,$[1]),Y.hi(1)),u.assign(H.lo(z[0]-1,1).hi(1,$[1]),Y.lo($[0]-1)),H.set(0,0,Y.get(0,0)),H.set(0,z[1]-1,Y.get(0,$[1]-1)),H.set(z[0]-1,0,Y.get($[0]-1,0)),H.set(z[0]-1,z[1]-1,Y.get($[0]-1,$[1]-1))},C.update=function(H){H=H||{},this.objectOffset=H.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in H&&(this.contourWidth=X(H.contourWidth,Number)),"showContour"in H&&(this.showContour=X(H.showContour,Boolean)),"showSurface"in H&&(this.showSurface=!!H.showSurface),"contourTint"in H&&(this.contourTint=X(H.contourTint,Boolean)),"contourColor"in H&&(this.contourColor=Z(H.contourColor)),"contourProject"in H&&(this.contourProject=X(H.contourProject,function(wt){return X(wt,Boolean)})),"surfaceProject"in H&&(this.surfaceProject=H.surfaceProject),"dynamicColor"in H&&(this.dynamicColor=Z(H.dynamicColor)),"dynamicTint"in H&&(this.dynamicTint=X(H.dynamicTint,Number)),"dynamicWidth"in H&&(this.dynamicWidth=X(H.dynamicWidth,Number)),"opacity"in H&&(this.opacity=H.opacity),"opacityscale"in H&&(this.opacityscale=H.opacityscale),"colorBounds"in H&&(this.colorBounds=H.colorBounds),"vertexColor"in H&&(this.vertexColor=H.vertexColor?1:0),"colormap"in H&&this._colorMap.setPixels(this.genColormap(H.colormap,this.opacityscale));var Y=H.field||H.coords&&H.coords[2]||null,$=!1;if(Y||(Y=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in H||"coords"in H){var z=(Y.shape[0]+2)*(Y.shape[1]+2);z>this._field[2].data.length&&(e.freeFloat(this._field[2].data),this._field[2].data=e.mallocFloat(t.nextPow2(z))),this._field[2]=l(this._field[2].data,[Y.shape[0]+2,Y.shape[1]+2]),this.padField(this._field[2],Y),this.shape=Y.shape.slice();for(var j=this.shape,W=0;W<2;++W)this._field[2].size>this._field[W].data.length&&(e.freeFloat(this._field[W].data),this._field[W].data=e.mallocFloat(this._field[2].size)),this._field[W]=l(this._field[W].data,[j[0]+2,j[1]+2]);if(H.coords){var ee=H.coords;if(!Array.isArray(ee)||ee.length!==3)throw new Error("gl-surface: invalid coordinates for x/y");for(W=0;W<2;++W){var J=ee[W];for(he=0;he<2;++he)if(J.shape[he]!==j[he])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[W],J)}}else if(H.ticks){var Q=H.ticks;if(!Array.isArray(Q)||Q.length!==2)throw new Error("gl-surface: invalid ticks");for(W=0;W<2;++W){var te=Q[W];if((Array.isArray(te)||te.length)&&(te=l(te)),te.shape[0]!==j[W])throw new Error("gl-surface: invalid tick length");var ie=l(te.data,j);ie.stride[W]=te.stride[0],ie.stride[1^W]=0,this.padField(this._field[W],ie)}}else{for(W=0;W<2;++W){var ae=[0,0];ae[W]=1,this._field[W]=l(this._field[W].data,[j[0]+2,j[1]+2],ae,0)}this._field[0].set(0,0,0);for(var he=0;he<j[0];++he)this._field[0].set(he+1,0,he);for(this._field[0].set(j[0]+1,0,j[0]-1),this._field[1].set(0,0,0),he=0;he<j[1];++he)this._field[1].set(0,he+1,he);this._field[1].set(0,j[1]+1,j[1]-1)}var se=this._field,de=l(e.mallocFloat(3*se[2].size*2),[3,j[0]+2,j[1]+2,2]);for(W=0;W<3;++W)a(de.pick(W),se[W],"mirror");var ue=l(e.mallocFloat(3*se[2].size),[j[0]+2,j[1]+2,3]);for(W=0;W<j[0]+2;++W)for(he=0;he<j[1]+2;++he){var ve=de.get(0,W,he,0),ke=de.get(0,W,he,1),Ee=de.get(1,W,he,0),be=de.get(1,W,he,1),xe=de.get(2,W,he,0),ce=de.get(2,W,he,1),ge=Ee*ce-be*xe,we=xe*ke-ce*ve,Me=ve*be-ke*Ee,Se=Math.sqrt(ge*ge+we*we+Me*Me);Se<1e-8?(Se=Math.max(Math.abs(ge),Math.abs(we),Math.abs(Me)))<1e-8?(Me=1,we=ge=0,Se=1):Se=1/Se:Se=1/Math.sqrt(Se),ue.set(W,he,0,ge*Se),ue.set(W,he,1,we*Se),ue.set(W,he,2,Me*Se)}e.free(de.data);var ze=[1/0,1/0,1/0],Fe=[-1/0,-1/0,-1/0],Ye=1/0,rt=-1/0,Oe=(j[0]-1)*(j[1]-1)*6,je=e.mallocFloat(t.nextPow2(10*Oe)),We=0,qe=0;for(W=0;W<j[0]-1;++W)e:for(he=0;he<j[1]-1;++he){for(var Qe=0;Qe<2;++Qe)for(var st=0;st<2;++st)for(var ct=0;ct<3;++ct){var Pt=this._field[ct].get(1+W+Qe,1+he+st);if(isNaN(Pt)||!isFinite(Pt))continue e}for(ct=0;ct<6;++ct){var kt=W+T[ct][0],at=he+T[ct][1],tt=this._field[0].get(kt+1,at+1),_t=this._field[1].get(kt+1,at+1);Pt=this._field[2].get(kt+1,at+1),ge=ue.get(kt+1,at+1,0),we=ue.get(kt+1,at+1,1),Me=ue.get(kt+1,at+1,2),H.intensity&&(er=H.intensity.get(kt,at));var er=H.intensity?H.intensity.get(kt,at):Pt+this.objectOffset[2];je[We++]=kt,je[We++]=at,je[We++]=tt,je[We++]=_t,je[We++]=Pt,je[We++]=0,je[We++]=er,je[We++]=ge,je[We++]=we,je[We++]=Me,ze[0]=Math.min(ze[0],tt+this.objectOffset[0]),ze[1]=Math.min(ze[1],_t+this.objectOffset[1]),ze[2]=Math.min(ze[2],Pt+this.objectOffset[2]),Ye=Math.min(Ye,er),Fe[0]=Math.max(Fe[0],tt+this.objectOffset[0]),Fe[1]=Math.max(Fe[1],_t+this.objectOffset[1]),Fe[2]=Math.max(Fe[2],Pt+this.objectOffset[2]),rt=Math.max(rt,er),qe+=1}}for(H.intensityBounds&&(Ye=+H.intensityBounds[0],rt=+H.intensityBounds[1]),W=6;W<We;W+=10)je[W]=(je[W]-Ye)/(rt-Ye);this._vertexCount=qe,this._coordinateBuffer.update(je.subarray(0,We)),e.freeFloat(je),e.free(ue.data),this.bounds=[ze,Fe],this.intensity=H.intensity||this._field[2],this.intensityBounds[0]===Ye&&this.intensityBounds[1]===rt||($=!0),this.intensityBounds=[Ye,rt]}if("levels"in H){var tr=H.levels;for(tr=Array.isArray(tr[0])?tr.slice():[[],[],tr],W=0;W<3;++W)tr[W]=tr[W].slice(),tr[W].sort(function(wt,Ot){return wt-Ot});for(W=0;W<3;++W)for(he=0;he<tr[W].length;++he)tr[W][he]-=this.objectOffset[W];e:for(W=0;W<3;++W){if(tr[W].length!==this.contourLevels[W].length){$=!0;break}for(he=0;he<tr[W].length;++he)if(tr[W][he]!==this.contourLevels[W][he]){$=!0;break e}}this.contourLevels=tr}if($){se=this._field,j=this.shape;for(var Ue=[],He=0;He<3;++He){var Be=this.contourLevels[He],Ke=[],_e=[],Ce=[0,0,0];for(W=0;W<Be.length;++W){var Le=o(this._field[He],Be[W]);Ke.push(Ue.length/5|0),qe=0;e:for(he=0;he<Le.cells.length;++he){var Pe=Le.cells[he];for(ct=0;ct<2;++ct){var Xe=Le.positions[Pe[ct]],ht=Xe[0],Mt=0|Math.floor(ht),pt=ht-Mt,Lt=Xe[1],vt=0|Math.floor(Lt),Dt=Lt-vt,xt=!1;t:for(var it=0;it<3;++it){Ce[it]=0;var St=(He+it+1)%3;for(Qe=0;Qe<2;++Qe){var Nt=Qe?pt:1-pt;for(kt=0|Math.min(Math.max(Mt+Qe,0),j[0]),st=0;st<2;++st){var Ut=st?Dt:1-Dt;if(at=0|Math.min(Math.max(vt+st,0),j[1]),Pt=it<2?this._field[St].get(kt,at):(this.intensity.get(kt,at)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(Pt)||isNaN(Pt)){xt=!0;break t}var Qt=Nt*Ut;Ce[it]+=Qt*Pt}}}if(xt){if(ct>0){for(var Ie=0;Ie<5;++Ie)Ue.pop();qe-=1}continue e}Ue.push(Ce[0],Ce[1],Xe[0],Xe[1],Ce[2]),qe+=1}}_e.push(qe)}this._contourOffsets[He]=Ke,this._contourCounts[He]=_e}var lt=e.mallocFloat(Ue.length);for(W=0;W<Ue.length;++W)lt[W]=Ue[W];this._contourBuffer.update(lt),e.freeFloat(lt)}},C.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var H=0;H<3;++H)e.freeFloat(this._field[H].data)},C.highlight=function(H){var Y,$;if(!H)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(Y=0;Y<3;++Y)this.enableHighlight[Y]?this.highlightLevel[Y]=H.level[Y]:this.highlightLevel[Y]=-1;for($=this.snapToData?H.dataCoordinate:H.position,Y=0;Y<3;++Y)$[Y]-=this.objectOffset[Y];if(this.enableDynamic[0]&&$[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&$[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&$[2]!==this.dynamicLevel[2]){for(var z=0,j=this.shape,W=e.mallocFloat(12*j[0]*j[1]),ee=0;ee<3;++ee)if(this.enableDynamic[ee]){this.dynamicLevel[ee]=$[ee];var J=(ee+1)%3,Q=(ee+2)%3,te=this._field[ee],ie=this._field[J],ae=this._field[Q],he=o(te,$[ee]),se=he.cells,de=he.positions;for(this._dynamicOffsets[ee]=z,Y=0;Y<se.length;++Y)for(var ue=se[Y],ve=0;ve<2;++ve){var ke=de[ue[ve]],Ee=+ke[0],be=0|Ee,xe=0|Math.min(be+1,j[0]),ce=Ee-be,ge=1-ce,we=+ke[1],Me=0|we,Se=0|Math.min(Me+1,j[1]),ze=we-Me,Fe=1-ze,Ye=ge*Fe,rt=ge*ze,Oe=ce*Fe,je=ce*ze,We=Ye*ie.get(be,Me)+rt*ie.get(be,Se)+Oe*ie.get(xe,Me)+je*ie.get(xe,Se),qe=Ye*ae.get(be,Me)+rt*ae.get(be,Se)+Oe*ae.get(xe,Me)+je*ae.get(xe,Se);if(isNaN(We)||isNaN(qe)){ve&&(z-=1);break}W[2*z+0]=We,W[2*z+1]=qe,z+=1}this._dynamicCounts[ee]=z-this._dynamicOffsets[ee]}else this.dynamicLevel[ee]=NaN,this._dynamicCounts[ee]=0;this._dynamicBuffer.update(W.subarray(0,2*z)),e.freeFloat(W)}}},{"./lib/shaders":345,"binary-search-bounds":103,"bit-twiddle":104,colormap:137,"gl-buffer":261,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-texture2d":348,"gl-vao":353,ndarray:472,"ndarray-gradient":465,"ndarray-ops":467,"ndarray-pack":468,"surface-nets":576,"typedarray-pool":601}],347:[function(r,O,B){var t=r("css-font"),d=r("pick-by-alias"),m=r("regl"),p=r("gl-util/context"),e=r("es6-weak-map"),f=r("color-normalize"),u=r("font-atlas"),s=r("typedarray-pool"),l=r("parse-rect"),o=r("is-plain-obj"),i=r("parse-unit"),c=r("to-px"),n=r("detect-kerning"),a=r("object-assign"),g=r("font-measure"),h=r("flatten-vertex-data"),y=r("bit-twiddle").nextPow2,v=new e,_=!1;if(document.body){var x=document.body.appendChild(document.createElement("div"));x.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(x).fontStretch&&(_=!0),document.body.removeChild(x)}var T=function(A){(function(S){return typeof S=="function"&&S._gl&&S.prop&&S.texture&&S.buffer})(A)?(A={regl:A},this.gl=A.regl._gl):this.gl=p(A),this.shader=v.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=A.regl||m({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),v.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(o(A)?A:{})};T.prototype.createShader=function(){var A=this.regl,S=A({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:A.prop("count"),offset:A.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:A.this("sizeBuffer")},width:{offset:0,stride:8,buffer:A.this("sizeBuffer")},char:A.this("charBuffer"),position:A.this("position")},uniforms:{atlasSize:function(w,C){return[C.atlas.width,C.atlas.height]},atlasDim:function(w,C){return[C.atlas.cols,C.atlas.rows]},atlas:function(w,C){return C.atlas.texture},charStep:function(w,C){return C.atlas.step},em:function(w,C){return C.atlas.em},color:A.prop("color"),opacity:A.prop("opacity"),viewport:A.this("viewportArray"),scale:A.this("scale"),align:A.prop("align"),baseline:A.prop("baseline"),translate:A.this("translate"),positionOffset:A.prop("positionOffset")},primitive:"points",viewport:A.this("viewport"),vert:`
			precision highp float;
			attribute float width, charOffset, char;
			attribute vec2 position;
			uniform float fontSize, charStep, em, align, baseline;
			uniform vec4 viewport;
			uniform vec4 color;
			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;
			varying vec2 charCoord, charId;
			varying float charWidth;
			varying vec4 fontColor;
			void main () {
				vec2 offset = floor(em * (vec2(align + charOffset, baseline)
					+ vec2(positionOffset.x, -positionOffset.y)))
					/ (viewport.zw * scale.xy);

				vec2 position = (position + translate) * scale;
				position += offset * scale;

				charCoord = position * viewport.zw + viewport.xy;

				gl_Position = vec4(position * 2. - 1., 0, 1);

				gl_PointSize = charStep;

				charId.x = mod(char, atlasDim.x);
				charId.y = floor(char / atlasDim.x);

				charWidth = width * em;

				fontColor = color / 255.;
			}`,frag:`
			precision highp float;
			uniform float fontSize, charStep, opacity;
			uniform vec2 atlasSize;
			uniform vec4 viewport;
			uniform sampler2D atlas;
			varying vec4 fontColor;
			varying vec2 charCoord, charId;
			varying float charWidth;

			float lightness(vec4 color) {
				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
			}

			void main () {
				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;
				float halfCharStep = floor(charStep * .5 + .5);

				// invert y and shift by 1px (FF expecially needs that)
				uv.y = charStep - uv.y;

				// ignore points outside of character bounding box
				float halfCharWidth = ceil(charWidth * .5);
				if (floor(uv.x) > halfCharStep + halfCharWidth ||
					floor(uv.x) < halfCharStep - halfCharWidth) return;

				uv += charId * charStep;
				uv = uv / atlasSize;

				vec4 color = fontColor;
				vec4 mask = texture2D(atlas, uv);

				float maskY = lightness(mask);
				// float colorY = lightness(color);
				color.a *= maskY;
				color.a *= opacity;

				// color.a += .1;

				// antialiasing, see yiq color space y-channel formula
				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);

				gl_FragColor = color;
			}`});return{regl:A,draw:S,atlas:{}}},T.prototype.update=function(A){var S=this;if(typeof A=="string")A={text:A};else if(!A)return;(A=d(A,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0)).opacity!=null&&(Array.isArray(A.opacity)?this.opacity=A.opacity.map(function(ge){return parseFloat(ge)}):this.opacity=parseFloat(A.opacity)),A.viewport!=null&&(this.viewport=l(A.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),this.viewport==null&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),A.kerning!=null&&(this.kerning=A.kerning),A.offset!=null&&(typeof A.offset=="number"&&(A.offset=[A.offset,0]),this.positionOffset=h(A.offset)),A.direction&&(this.direction=A.direction),A.range&&(this.range=A.range,this.scale=[1/(A.range[2]-A.range[0]),1/(A.range[3]-A.range[1])],this.translate=[-A.range[0],-A.range[1]]),A.scale&&(this.scale=A.scale),A.translate&&(this.translate=A.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||A.font||(A.font=T.baseFontSize+"px sans-serif");var w,C=!1,k=!1;if(A.font&&(Array.isArray(A.font)?A.font:[A.font]).forEach(function(ge,we){if(typeof ge=="string")try{ge=t.parse(ge)}catch(rt){ge=t.parse(T.baseFontSize+"px "+ge)}else ge=t.parse(t.stringify(ge));var Me=t.stringify({size:T.baseFontSize,family:ge.family,stretch:_?ge.stretch:void 0,variant:ge.variant,weight:ge.weight,style:ge.style}),Se=i(ge.size),ze=Math.round(Se[0]*c(Se[1]));if(ze!==S.fontSize[we]&&(k=!0,S.fontSize[we]=ze),!(S.font[we]&&Me==S.font[we].baseString||(C=!0,S.font[we]=T.fonts[Me],S.font[we]))){var Fe=ge.family.join(", "),Ye=[ge.style];ge.style!=ge.variant&&Ye.push(ge.variant),ge.variant!=ge.weight&&Ye.push(ge.weight),_&&ge.weight!=ge.stretch&&Ye.push(ge.stretch),S.font[we]={baseString:Me,family:Fe,weight:ge.weight,stretch:ge.stretch,style:ge.style,variant:ge.variant,width:{},kerning:{},metrics:g(Fe,{origin:"top",fontSize:T.baseFontSize,fontStyle:Ye.join(" ")})},T.fonts[Me]=S.font[we]}}),(C||k)&&this.font.forEach(function(ge,we){var Me=t.stringify({size:S.fontSize[we],family:ge.family,stretch:_?ge.stretch:void 0,variant:ge.variant,weight:ge.weight,style:ge.style});if(S.fontAtlas[we]=S.shader.atlas[Me],!S.fontAtlas[we]){var Se=ge.metrics;S.shader.atlas[Me]=S.fontAtlas[we]={fontString:Me,step:2*Math.ceil(S.fontSize[we]*Se.bottom*.5),em:S.fontSize[we],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:S.regl.texture()}}A.text==null&&(A.text=S.text)}),typeof A.text=="string"&&A.position&&A.position.length>2){for(var L=Array(.5*A.position.length),M=0;M<L.length;M++)L[M]=A.text;A.text=L}if(A.text!=null||C){if(this.textOffsets=[0],Array.isArray(A.text)){this.count=A.text[0].length,this.counts=[this.count];for(var P=1;P<A.text.length;P++)this.textOffsets[P]=this.textOffsets[P-1]+A.text[P-1].length,this.count+=A.text[P].length,this.counts.push(A.text[P].length);this.text=A.text.join("")}else this.text=A.text,this.count=this.text.length,this.counts=[this.count];w=[],this.font.forEach(function(ge,we){T.atlasContext.font=ge.baseString;for(var Me=S.fontAtlas[we],Se=0;Se<S.text.length;Se++){var ze=S.text.charAt(Se);if(Me.ids[ze]==null&&(Me.ids[ze]=Me.chars.length,Me.chars.push(ze),w.push(ze)),ge.width[ze]==null&&(ge.width[ze]=T.atlasContext.measureText(ze).width/T.baseFontSize,S.kerning)){var Fe=[];for(var Ye in ge.width)Fe.push(Ye+ze,ze+Ye);a(ge.kerning,n(ge.family,{pairs:Fe}))}}})}if(A.position)if(A.position.length>2){for(var D=!A.position[0].length,N=s.mallocFloat(2*this.count),U=0,q=0;U<this.counts.length;U++){var X=this.counts[U];if(D)for(var K=0;K<X;K++)N[q++]=A.position[2*U],N[q++]=A.position[2*U+1];else for(var Z=0;Z<X;Z++)N[q++]=A.position[U][0],N[q++]=A.position[U][1]}this.position.call?this.position({type:"float",data:N}):this.position=this.regl.buffer({type:"float",data:N}),s.freeFloat(N)}else this.position.destroy&&this.position.destroy(),this.position={constant:A.position};if(A.text||C){var H=s.mallocUint8(this.count),Y=s.mallocFloat(2*this.count);this.textWidth=[];for(var $=0,z=0;$<this.counts.length;$++){for(var j=this.counts[$],W=this.font[$]||this.font[0],ee=this.fontAtlas[$]||this.fontAtlas[0],J=0;J<j;J++){var Q=this.text.charAt(z),te=this.text.charAt(z-1);if(H[z]=ee.ids[Q],Y[2*z]=W.width[Q],J){var ie=Y[2*z-2],ae=Y[2*z],he=Y[2*z-1]+.5*ie+.5*ae;if(this.kerning){var se=W.kerning[te+Q];se&&(he+=.001*se)}Y[2*z+1]=he}else Y[2*z+1]=.5*Y[2*z];z++}this.textWidth.push(Y.length?.5*Y[2*z-2]+Y[2*z-1]:0)}A.align||(A.align=this.align),this.charBuffer({data:H,type:"uint8",usage:"stream"}),this.sizeBuffer({data:Y,type:"float",usage:"stream"}),s.freeUint8(H),s.freeFloat(Y),w.length&&this.font.forEach(function(ge,we){var Me=S.fontAtlas[we],Se=Me.step,ze=Math.floor(T.maxAtlasSize/Se),Fe=Math.min(ze,Me.chars.length),Ye=Math.ceil(Me.chars.length/Fe),rt=y(Fe*Se),Oe=y(Ye*Se);Me.width=rt,Me.height=Oe,Me.rows=Ye,Me.cols=Fe,Me.em&&Me.texture({data:u({canvas:T.atlasCanvas,font:Me.fontString,chars:Me.chars,shape:[rt,Oe],step:[Se,Se]})})})}if(A.align&&(this.align=A.align,this.alignOffset=this.textWidth.map(function(ge,we){var Me=Array.isArray(S.align)?S.align.length>1?S.align[we]:S.align[0]:S.align;if(typeof Me=="number")return Me;switch(Me){case"right":case"end":return-ge;case"center":case"centre":case"middle":return .5*-ge}return 0})),this.baseline==null&&A.baseline==null&&(A.baseline=0),A.baseline!=null&&(this.baseline=A.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(ge,we){var Me=(S.font[we]||S.font[0]).metrics,Se=0;return Se+=.5*Me.bottom,Se+=typeof ge=="number"?ge-Me.baseline:-Me[ge],Se*=-1})),A.color!=null)if(A.color||(A.color="transparent"),typeof A.color!="string"&&isNaN(A.color)){var de;if(typeof A.color[0]=="number"&&A.color.length>this.counts.length){var ue=A.color.length;de=s.mallocUint8(ue);for(var ve=(A.color.subarray||A.color.slice).bind(A.color),ke=0;ke<ue;ke+=4)de.set(f(ve(ke,ke+4),"uint8"),ke)}else{var Ee=A.color.length;de=s.mallocUint8(4*Ee);for(var be=0;be<Ee;be++)de.set(f(A.color[be]||0,"uint8"),4*be)}this.color=de}else this.color=f(A.color,"uint8");if(A.position||A.text||A.color||A.baseline||A.align||A.font||A.offset||A.opacity)if(this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2){var xe=Math.max(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(xe);for(var ce=0;ce<this.batch.length;ce++)this.batch[ce]={count:this.counts.length>1?this.counts[ce]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[ce]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(4*ce,4*ce+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[ce]:this.opacity,baseline:this.baselineOffset[ce]!=null?this.baselineOffset[ce]:this.baselineOffset[0],align:this.align?this.alignOffset[ce]!=null?this.alignOffset[ce]:this.alignOffset[0]:0,atlas:this.fontAtlas[ce]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(2*ce,2*ce+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]},T.prototype.destroy=function(){},T.prototype.kerning=!0,T.prototype.position={constant:new Float32Array(2)},T.prototype.translate=null,T.prototype.scale=null,T.prototype.font=null,T.prototype.text="",T.prototype.positionOffset=[0,0],T.prototype.opacity=1,T.prototype.color=new Uint8Array([0,0,0,255]),T.prototype.alignOffset=[0,0],T.maxAtlasSize=1024,T.atlasCanvas=document.createElement("canvas"),T.atlasContext=T.atlasCanvas.getContext("2d",{alpha:!1}),T.baseFontSize=64,T.fonts={},O.exports=T},{"bit-twiddle":104,"color-normalize":131,"css-font":150,"detect-kerning":178,"es6-weak-map":238,"flatten-vertex-data":248,"font-atlas":249,"font-measure":250,"gl-util/context":349,"is-plain-obj":447,"object-assign":476,"parse-rect":481,"parse-unit":483,"pick-by-alias":485,regl:526,"to-px":585,"typedarray-pool":601}],348:[function(r,O,B){var t=r("ndarray"),d=r("ndarray-ops"),m=r("typedarray-pool");O.exports=function(v){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(p||u(v),typeof arguments[1]=="number")return g(v,arguments[1],arguments[2],arguments[3]||v.RGBA,arguments[4]||v.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return g(v,0|arguments[1][0],0|arguments[1][1],arguments[2]||v.RGBA,arguments[3]||v.UNSIGNED_BYTE);if(typeof arguments[1]=="object"){var _=arguments[1],x=s(_)?_:_.raw;if(x)return h(v,x,0|_.width,0|_.height,arguments[2]||v.RGBA,arguments[3]||v.UNSIGNED_BYTE);if(_.shape&&_.data&&_.stride)return y(v,_)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")};var p=null,e=null,f=null;function u(v){p=[v.LINEAR,v.NEAREST_MIPMAP_LINEAR,v.LINEAR_MIPMAP_NEAREST,v.LINEAR_MIPMAP_NEAREST],e=[v.NEAREST,v.LINEAR,v.NEAREST_MIPMAP_NEAREST,v.NEAREST_MIPMAP_LINEAR,v.LINEAR_MIPMAP_NEAREST,v.LINEAR_MIPMAP_LINEAR],f=[v.REPEAT,v.CLAMP_TO_EDGE,v.MIRRORED_REPEAT]}function s(v){return typeof HTMLCanvasElement!="undefined"&&v instanceof HTMLCanvasElement||typeof HTMLImageElement!="undefined"&&v instanceof HTMLImageElement||typeof HTMLVideoElement!="undefined"&&v instanceof HTMLVideoElement||typeof ImageData!="undefined"&&v instanceof ImageData}var l=function(v,_){d.muls(v,_,255)};function o(v,_,x){var T=v.gl,A=T.getParameter(T.MAX_TEXTURE_SIZE);if(_<0||_>A||x<0||x>A)throw new Error("gl-texture2d: Invalid texture size");return v._shape=[_,x],v.bind(),T.texImage2D(T.TEXTURE_2D,0,v.format,_,x,0,v.format,v.type,null),v._mipLevels=[0],v}function i(v,_,x,T,A,S){this.gl=v,this.handle=_,this.format=A,this.type=S,this._shape=[x,T],this._mipLevels=[0],this._magFilter=v.NEAREST,this._minFilter=v.NEAREST,this._wrapS=v.CLAMP_TO_EDGE,this._wrapT=v.CLAMP_TO_EDGE,this._anisoSamples=1;var w=this,C=[this._wrapS,this._wrapT];Object.defineProperties(C,[{get:function(){return w._wrapS},set:function(L){return w.wrapS=L}},{get:function(){return w._wrapT},set:function(L){return w.wrapT=L}}]),this._wrapVector=C;var k=[this._shape[0],this._shape[1]];Object.defineProperties(k,[{get:function(){return w._shape[0]},set:function(L){return w.width=L}},{get:function(){return w._shape[1]},set:function(L){return w.height=L}}]),this._shapeVector=k}var c=i.prototype;function n(v,_){return v.length===3?_[2]===1&&_[1]===v[0]*v[2]&&_[0]===v[2]:_[0]===1&&_[1]===v[0]}function a(v){var _=v.createTexture();return v.bindTexture(v.TEXTURE_2D,_),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),_}function g(v,_,x,T,A){var S=v.getParameter(v.MAX_TEXTURE_SIZE);if(_<0||_>S||x<0||x>S)throw new Error("gl-texture2d: Invalid texture shape");if(A===v.FLOAT&&!v.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var w=a(v);return v.texImage2D(v.TEXTURE_2D,0,T,_,x,0,T,A,null),new i(v,w,_,x,T,A)}function h(v,_,x,T,A,S){var w=a(v);return v.texImage2D(v.TEXTURE_2D,0,A,A,S,_),new i(v,w,x,T,A,S)}function y(v,_){var x=_.dtype,T=_.shape.slice(),A=v.getParameter(v.MAX_TEXTURE_SIZE);if(T[0]<0||T[0]>A||T[1]<0||T[1]>A)throw new Error("gl-texture2d: Invalid texture size");var S=n(T,_.stride.slice()),w=0;x==="float32"?w=v.FLOAT:x==="float64"?(w=v.FLOAT,S=!1,x="float32"):x==="uint8"?w=v.UNSIGNED_BYTE:(w=v.UNSIGNED_BYTE,S=!1,x="uint8");var C,k,L=0;if(T.length===2)L=v.LUMINANCE,T=[T[0],T[1],1],_=t(_.data,T,[_.stride[0],_.stride[1],1],_.offset);else{if(T.length!==3)throw new Error("gl-texture2d: Invalid shape for texture");if(T[2]===1)L=v.ALPHA;else if(T[2]===2)L=v.LUMINANCE_ALPHA;else if(T[2]===3)L=v.RGB;else{if(T[2]!==4)throw new Error("gl-texture2d: Invalid shape for pixel coords");L=v.RGBA}}w!==v.FLOAT||v.getExtension("OES_texture_float")||(w=v.UNSIGNED_BYTE,S=!1);var M=_.size;if(S)C=_.offset===0&&_.data.length===M?_.data:_.data.subarray(_.offset,_.offset+M);else{var P=[T[2],T[2]*T[0],1];k=m.malloc(M,x);var D=t(k,T,P,0);x!=="float32"&&x!=="float64"||w!==v.UNSIGNED_BYTE?d.assign(D,_):l(D,_),C=k.subarray(0,M)}var N=a(v);return v.texImage2D(v.TEXTURE_2D,0,L,T[0],T[1],0,L,w,C),S||m.free(k),new i(v,N,T[0],T[1],L,w)}Object.defineProperties(c,{minFilter:{get:function(){return this._minFilter},set:function(v){this.bind();var _=this.gl;if(this.type===_.FLOAT&&p.indexOf(v)>=0&&(_.getExtension("OES_texture_float_linear")||(v=_.NEAREST)),e.indexOf(v)<0)throw new Error("gl-texture2d: Unknown filter mode "+v);return _.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,v),this._minFilter=v}},magFilter:{get:function(){return this._magFilter},set:function(v){this.bind();var _=this.gl;if(this.type===_.FLOAT&&p.indexOf(v)>=0&&(_.getExtension("OES_texture_float_linear")||(v=_.NEAREST)),e.indexOf(v)<0)throw new Error("gl-texture2d: Unknown filter mode "+v);return _.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,v),this._magFilter=v}},mipSamples:{get:function(){return this._anisoSamples},set:function(v){var _=this._anisoSamples;if(this._anisoSamples=0|Math.max(v,1),_!==this._anisoSamples){var x=this.gl.getExtension("EXT_texture_filter_anisotropic");x&&this.gl.texParameterf(this.gl.TEXTURE_2D,x.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(v){if(this.bind(),f.indexOf(v)<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,v),this._wrapS=v}},wrapT:{get:function(){return this._wrapT},set:function(v){if(this.bind(),f.indexOf(v)<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,v),this._wrapT=v}},wrap:{get:function(){return this._wrapVector},set:function(v){if(Array.isArray(v)||(v=[v,v]),v.length!==2)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var _=0;_<2;++_)if(f.indexOf(v[_])<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);this._wrapS=v[0],this._wrapT=v[1];var x=this.gl;return this.bind(),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,this._wrapS),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,this._wrapT),v}},shape:{get:function(){return this._shapeVector},set:function(v){if(Array.isArray(v)){if(v.length!==2)throw new Error("gl-texture2d: Invalid texture shape")}else v=[0|v,0|v];return o(this,0|v[0],0|v[1]),[0|v[0],0|v[1]]}},width:{get:function(){return this._shape[0]},set:function(v){return o(this,v|=0,this._shape[1]),v}},height:{get:function(){return this._shape[1]},set:function(v){return v|=0,o(this,this._shape[0],v),v}}}),c.bind=function(v){var _=this.gl;return v!==void 0&&_.activeTexture(_.TEXTURE0+(0|v)),_.bindTexture(_.TEXTURE_2D,this.handle),v!==void 0?0|v:_.getParameter(_.ACTIVE_TEXTURE)-_.TEXTURE0},c.dispose=function(){this.gl.deleteTexture(this.handle)},c.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var v=Math.min(this._shape[0],this._shape[1]),_=0;v>0;++_,v>>>=1)this._mipLevels.indexOf(_)<0&&this._mipLevels.push(_)},c.setPixels=function(v,_,x,T){var A=this.gl;this.bind(),Array.isArray(_)?(T=x,x=0|_[1],_=0|_[0]):(_=_||0,x=x||0),T=T||0;var S=s(v)?v:v.raw;if(S)this._mipLevels.indexOf(T)<0?(A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,this.type,S),this._mipLevels.push(T)):A.texSubImage2D(A.TEXTURE_2D,T,_,x,this.format,this.type,S);else{if(!(v.shape&&v.stride&&v.data))throw new Error("gl-texture2d: Unsupported data type");if(v.shape.length<2||_+v.shape[1]>this._shape[1]>>>T||x+v.shape[0]>this._shape[0]>>>T||_<0||x<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");(function(w,C,k,L,M,P,D,N){var U=N.dtype,q=N.shape.slice();if(q.length<2||q.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var X=0,K=0,Z=n(q,N.stride.slice());if(U==="float32"?X=w.FLOAT:U==="float64"?(X=w.FLOAT,Z=!1,U="float32"):U==="uint8"?X=w.UNSIGNED_BYTE:(X=w.UNSIGNED_BYTE,Z=!1,U="uint8"),q.length===2)K=w.LUMINANCE,q=[q[0],q[1],1],N=t(N.data,q,[N.stride[0],N.stride[1],1],N.offset);else{if(q.length!==3)throw new Error("gl-texture2d: Invalid shape for texture");if(q[2]===1)K=w.ALPHA;else if(q[2]===2)K=w.LUMINANCE_ALPHA;else if(q[2]===3)K=w.RGB;else{if(q[2]!==4)throw new Error("gl-texture2d: Invalid shape for pixel coords");K=w.RGBA}q[2]}if(K!==w.LUMINANCE&&K!==w.ALPHA||M!==w.LUMINANCE&&M!==w.ALPHA||(K=M),K!==M)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var H=N.size,Y=D.indexOf(L)<0;if(Y&&D.push(L),X===P&&Z)N.offset===0&&N.data.length===H?Y?w.texImage2D(w.TEXTURE_2D,L,M,q[0],q[1],0,M,P,N.data):w.texSubImage2D(w.TEXTURE_2D,L,C,k,q[0],q[1],M,P,N.data):Y?w.texImage2D(w.TEXTURE_2D,L,M,q[0],q[1],0,M,P,N.data.subarray(N.offset,N.offset+H)):w.texSubImage2D(w.TEXTURE_2D,L,C,k,q[0],q[1],M,P,N.data.subarray(N.offset,N.offset+H));else{var $;$=P===w.FLOAT?m.mallocFloat32(H):m.mallocUint8(H);var z=t($,q,[q[2],q[2]*q[0],1]);X===w.FLOAT&&P===w.UNSIGNED_BYTE?l(z,N):d.assign(z,N),Y?w.texImage2D(w.TEXTURE_2D,L,M,q[0],q[1],0,M,P,$.subarray(0,H)):w.texSubImage2D(w.TEXTURE_2D,L,C,k,q[0],q[1],M,P,$.subarray(0,H)),P===w.FLOAT?m.freeFloat32($):m.freeUint8($)}})(A,_,x,T,this.format,this.type,this._mipLevels,v)}}},{ndarray:472,"ndarray-ops":467,"typedarray-pool":601}],349:[function(r,O,B){(function(t){(function(){var d=r("pick-by-alias");function m(f){if(f.container)if(f.container==document.body)document.body.style.width||(f.canvas.width=f.width||f.pixelRatio*t.innerWidth),document.body.style.height||(f.canvas.height=f.height||f.pixelRatio*t.innerHeight);else{var u=f.container.getBoundingClientRect();f.canvas.width=f.width||u.right-u.left,f.canvas.height=f.height||u.bottom-u.top}}function p(f){return typeof f.getContext=="function"&&"width"in f&&"height"in f}function e(){var f=document.createElement("canvas");return f.style.position="absolute",f.style.top=0,f.style.left=0,f}O.exports=function(f){var u;if(f?typeof f=="string"&&(f={container:f}):f={},p(f)?f={container:f}:f=typeof(u=f).nodeName=="string"&&typeof u.appendChild=="function"&&typeof u.getBoundingClientRect=="function"?{container:f}:function(l){return typeof l.drawArrays=="function"||typeof l.drawElements=="function"}(f)?{gl:f}:d(f,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),f.pixelRatio||(f.pixelRatio=t.pixelRatio||1),f.gl)return f.gl;if(f.canvas&&(f.container=f.canvas.parentNode),f.container){if(typeof f.container=="string"){var s=document.querySelector(f.container);if(!s)throw Error("Element "+f.container+" is not found");f.container=s}p(f.container)?(f.canvas=f.container,f.container=f.canvas.parentNode):f.canvas||(f.canvas=e(),f.container.appendChild(f.canvas),m(f))}else if(!f.canvas){if(typeof document=="undefined")throw Error("Not DOM environment. Use headless-gl.");f.container=document.body||document.documentElement,f.canvas=e(),f.container.appendChild(f.canvas),m(f)}return f.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(l){try{f.gl=f.canvas.getContext(l,f.attrs)}catch(o){}return f.gl}),f.gl}}).call(this)}).call(this,typeof Xi!="undefined"?Xi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"pick-by-alias":485}],350:[function(r,O,B){O.exports=function(t,d,m){d?d.bind():t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null);var p=0|t.getParameter(t.MAX_VERTEX_ATTRIBS);if(m){if(m.length>p)throw new Error("gl-vao: Too many vertex attributes");for(var e=0;e<m.length;++e){var f=m[e];if(f.buffer){var u=f.buffer,s=f.size||4,l=f.type||t.FLOAT,o=!!f.normalized,i=f.stride||0,c=f.offset||0;u.bind(),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,s,l,o,i,c)}else{if(typeof f=="number")t.vertexAttrib1f(e,f);else if(f.length===1)t.vertexAttrib1f(e,f[0]);else if(f.length===2)t.vertexAttrib2f(e,f[0],f[1]);else if(f.length===3)t.vertexAttrib3f(e,f[0],f[1],f[2]);else{if(f.length!==4)throw new Error("gl-vao: Invalid vertex attribute");t.vertexAttrib4f(e,f[0],f[1],f[2],f[3])}t.disableVertexAttribArray(e)}}for(;e<p;++e)t.disableVertexAttribArray(e)}else for(t.bindBuffer(t.ARRAY_BUFFER,null),e=0;e<p;++e)t.disableVertexAttribArray(e)}},{}],351:[function(r,O,B){var t=r("./do-bind.js");function d(m){this.gl=m,this._elements=null,this._attributes=null,this._elementsType=m.UNSIGNED_SHORT}d.prototype.bind=function(){t(this.gl,this._elements,this._attributes)},d.prototype.update=function(m,p,e){this._elements=p,this._attributes=m,this._elementsType=e||this.gl.UNSIGNED_SHORT},d.prototype.dispose=function(){},d.prototype.unbind=function(){},d.prototype.draw=function(m,p,e){e=e||0;var f=this.gl;this._elements?f.drawElements(m,p,this._elementsType,e):f.drawArrays(m,e,p)},O.exports=function(m){return new d(m)}},{"./do-bind.js":350}],352:[function(r,O,B){var t=r("./do-bind.js");function d(p,e,f,u,s,l){this.location=p,this.dimension=e,this.a=f,this.b=u,this.c=s,this.d=l}function m(p,e,f){this.gl=p,this._ext=e,this.handle=f,this._attribs=[],this._useElements=!1,this._elementsType=p.UNSIGNED_SHORT}d.prototype.bind=function(p){switch(this.dimension){case 1:p.vertexAttrib1f(this.location,this.a);break;case 2:p.vertexAttrib2f(this.location,this.a,this.b);break;case 3:p.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:p.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},m.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var p=0;p<this._attribs.length;++p)this._attribs[p].bind(this.gl)},m.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},m.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},m.prototype.update=function(p,e,f){if(this.bind(),t(this.gl,e,p),this.unbind(),this._attribs.length=0,p)for(var u=0;u<p.length;++u){var s=p[u];typeof s=="number"?this._attribs.push(new d(u,1,s)):Array.isArray(s)&&this._attribs.push(new d(u,s.length,s[0],s[1],s[2],s[3]))}this._useElements=!!e,this._elementsType=f||this.gl.UNSIGNED_SHORT},m.prototype.draw=function(p,e,f){f=f||0;var u=this.gl;this._useElements?u.drawElements(p,e,this._elementsType,f):u.drawArrays(p,f,e)},O.exports=function(p,e){return new m(p,e,e.createVertexArrayOES())}},{"./do-bind.js":350}],353:[function(r,O,B){var t=r("./lib/vao-native.js"),d=r("./lib/vao-emulated.js");function m(p){this.bindVertexArrayOES=p.bindVertexArray.bind(p),this.createVertexArrayOES=p.createVertexArray.bind(p),this.deleteVertexArrayOES=p.deleteVertexArray.bind(p)}O.exports=function(p,e,f,u){var s,l=p.createVertexArray?new m(p):p.getExtension("OES_vertex_array_object");return(s=l?t(p,l):d(p)).update(e,f,u),s}},{"./lib/vao-emulated.js":351,"./lib/vao-native.js":352}],354:[function(r,O,B){O.exports=function(t,d,m){return t[0]=d[0]+m[0],t[1]=d[1]+m[1],t[2]=d[2]+m[2],t}},{}],355:[function(r,O,B){O.exports=function(p,e){var f=t(p[0],p[1],p[2]),u=t(e[0],e[1],e[2]);d(f,f),d(u,u);var s=m(f,u);return s>1?0:Math.acos(s)};var t=r("./fromValues"),d=r("./normalize"),m=r("./dot")},{"./dot":365,"./fromValues":371,"./normalize":382}],356:[function(r,O,B){O.exports=function(t,d){return t[0]=Math.ceil(d[0]),t[1]=Math.ceil(d[1]),t[2]=Math.ceil(d[2]),t}},{}],357:[function(r,O,B){O.exports=function(t){var d=new Float32Array(3);return d[0]=t[0],d[1]=t[1],d[2]=t[2],d}},{}],358:[function(r,O,B){O.exports=function(t,d){return t[0]=d[0],t[1]=d[1],t[2]=d[2],t}},{}],359:[function(r,O,B){O.exports=function(){var t=new Float32Array(3);return t[0]=0,t[1]=0,t[2]=0,t}},{}],360:[function(r,O,B){O.exports=function(t,d,m){var p=d[0],e=d[1],f=d[2],u=m[0],s=m[1],l=m[2];return t[0]=e*l-f*s,t[1]=f*u-p*l,t[2]=p*s-e*u,t}},{}],361:[function(r,O,B){O.exports=r("./distance")},{"./distance":362}],362:[function(r,O,B){O.exports=function(t,d){var m=d[0]-t[0],p=d[1]-t[1],e=d[2]-t[2];return Math.sqrt(m*m+p*p+e*e)}},{}],363:[function(r,O,B){O.exports=r("./divide")},{"./divide":364}],364:[function(r,O,B){O.exports=function(t,d,m){return t[0]=d[0]/m[0],t[1]=d[1]/m[1],t[2]=d[2]/m[2],t}},{}],365:[function(r,O,B){O.exports=function(t,d){return t[0]*d[0]+t[1]*d[1]+t[2]*d[2]}},{}],366:[function(r,O,B){O.exports=1e-6},{}],367:[function(r,O,B){O.exports=function(d,m){var p=d[0],e=d[1],f=d[2],u=m[0],s=m[1],l=m[2];return Math.abs(p-u)<=t*Math.max(1,Math.abs(p),Math.abs(u))&&Math.abs(e-s)<=t*Math.max(1,Math.abs(e),Math.abs(s))&&Math.abs(f-l)<=t*Math.max(1,Math.abs(f),Math.abs(l))};var t=r("./epsilon")},{"./epsilon":366}],368:[function(r,O,B){O.exports=function(t,d){return t[0]===d[0]&&t[1]===d[1]&&t[2]===d[2]}},{}],369:[function(r,O,B){O.exports=function(t,d){return t[0]=Math.floor(d[0]),t[1]=Math.floor(d[1]),t[2]=Math.floor(d[2]),t}},{}],370:[function(r,O,B){O.exports=function(d,m,p,e,f,u){var s,l;for(m||(m=3),p||(p=0),l=e?Math.min(e*m+p,d.length):d.length,s=p;s<l;s+=m)t[0]=d[s],t[1]=d[s+1],t[2]=d[s+2],f(t,t,u),d[s]=t[0],d[s+1]=t[1],d[s+2]=t[2];return d};var t=r("./create")()},{"./create":359}],371:[function(r,O,B){O.exports=function(t,d,m){var p=new Float32Array(3);return p[0]=t,p[1]=d,p[2]=m,p}},{}],372:[function(r,O,B){O.exports={EPSILON:r("./epsilon"),create:r("./create"),clone:r("./clone"),angle:r("./angle"),fromValues:r("./fromValues"),copy:r("./copy"),set:r("./set"),equals:r("./equals"),exactEquals:r("./exactEquals"),add:r("./add"),subtract:r("./subtract"),sub:r("./sub"),multiply:r("./multiply"),mul:r("./mul"),divide:r("./divide"),div:r("./div"),min:r("./min"),max:r("./max"),floor:r("./floor"),ceil:r("./ceil"),round:r("./round"),scale:r("./scale"),scaleAndAdd:r("./scaleAndAdd"),distance:r("./distance"),dist:r("./dist"),squaredDistance:r("./squaredDistance"),sqrDist:r("./sqrDist"),length:r("./length"),len:r("./len"),squaredLength:r("./squaredLength"),sqrLen:r("./sqrLen"),negate:r("./negate"),inverse:r("./inverse"),normalize:r("./normalize"),dot:r("./dot"),cross:r("./cross"),lerp:r("./lerp"),random:r("./random"),transformMat4:r("./transformMat4"),transformMat3:r("./transformMat3"),transformQuat:r("./transformQuat"),rotateX:r("./rotateX"),rotateY:r("./rotateY"),rotateZ:r("./rotateZ"),forEach:r("./forEach")}},{"./add":354,"./angle":355,"./ceil":356,"./clone":357,"./copy":358,"./create":359,"./cross":360,"./dist":361,"./distance":362,"./div":363,"./divide":364,"./dot":365,"./epsilon":366,"./equals":367,"./exactEquals":368,"./floor":369,"./forEach":370,"./fromValues":371,"./inverse":373,"./len":374,"./length":375,"./lerp":376,"./max":377,"./min":378,"./mul":379,"./multiply":380,"./negate":381,"./normalize":382,"./random":383,"./rotateX":384,"./rotateY":385,"./rotateZ":386,"./round":387,"./scale":388,"./scaleAndAdd":389,"./set":390,"./sqrDist":391,"./sqrLen":392,"./squaredDistance":393,"./squaredLength":394,"./sub":395,"./subtract":396,"./transformMat3":397,"./transformMat4":398,"./transformQuat":399}],373:[function(r,O,B){O.exports=function(t,d){return t[0]=1/d[0],t[1]=1/d[1],t[2]=1/d[2],t}},{}],374:[function(r,O,B){O.exports=r("./length")},{"./length":375}],375:[function(r,O,B){O.exports=function(t){var d=t[0],m=t[1],p=t[2];return Math.sqrt(d*d+m*m+p*p)}},{}],376:[function(r,O,B){O.exports=function(t,d,m,p){var e=d[0],f=d[1],u=d[2];return t[0]=e+p*(m[0]-e),t[1]=f+p*(m[1]-f),t[2]=u+p*(m[2]-u),t}},{}],377:[function(r,O,B){O.exports=function(t,d,m){return t[0]=Math.max(d[0],m[0]),t[1]=Math.max(d[1],m[1]),t[2]=Math.max(d[2],m[2]),t}},{}],378:[function(r,O,B){O.exports=function(t,d,m){return t[0]=Math.min(d[0],m[0]),t[1]=Math.min(d[1],m[1]),t[2]=Math.min(d[2],m[2]),t}},{}],379:[function(r,O,B){O.exports=r("./multiply")},{"./multiply":380}],380:[function(r,O,B){O.exports=function(t,d,m){return t[0]=d[0]*m[0],t[1]=d[1]*m[1],t[2]=d[2]*m[2],t}},{}],381:[function(r,O,B){O.exports=function(t,d){return t[0]=-d[0],t[1]=-d[1],t[2]=-d[2],t}},{}],382:[function(r,O,B){O.exports=function(t,d){var m=d[0],p=d[1],e=d[2],f=m*m+p*p+e*e;return f>0&&(f=1/Math.sqrt(f),t[0]=d[0]*f,t[1]=d[1]*f,t[2]=d[2]*f),t}},{}],383:[function(r,O,B){O.exports=function(t,d){d=d||1;var m=2*Math.random()*Math.PI,p=2*Math.random()-1,e=Math.sqrt(1-p*p)*d;return t[0]=Math.cos(m)*e,t[1]=Math.sin(m)*e,t[2]=p*d,t}},{}],384:[function(r,O,B){O.exports=function(t,d,m,p){var e=m[1],f=m[2],u=d[1]-e,s=d[2]-f,l=Math.sin(p),o=Math.cos(p);return t[0]=d[0],t[1]=e+u*o-s*l,t[2]=f+u*l+s*o,t}},{}],385:[function(r,O,B){O.exports=function(t,d,m,p){var e=m[0],f=m[2],u=d[0]-e,s=d[2]-f,l=Math.sin(p),o=Math.cos(p);return t[0]=e+s*l+u*o,t[1]=d[1],t[2]=f+s*o-u*l,t}},{}],386:[function(r,O,B){O.exports=function(t,d,m,p){var e=m[0],f=m[1],u=d[0]-e,s=d[1]-f,l=Math.sin(p),o=Math.cos(p);return t[0]=e+u*o-s*l,t[1]=f+u*l+s*o,t[2]=d[2],t}},{}],387:[function(r,O,B){O.exports=function(t,d){return t[0]=Math.round(d[0]),t[1]=Math.round(d[1]),t[2]=Math.round(d[2]),t}},{}],388:[function(r,O,B){O.exports=function(t,d,m){return t[0]=d[0]*m,t[1]=d[1]*m,t[2]=d[2]*m,t}},{}],389:[function(r,O,B){O.exports=function(t,d,m,p){return t[0]=d[0]+m[0]*p,t[1]=d[1]+m[1]*p,t[2]=d[2]+m[2]*p,t}},{}],390:[function(r,O,B){O.exports=function(t,d,m,p){return t[0]=d,t[1]=m,t[2]=p,t}},{}],391:[function(r,O,B){O.exports=r("./squaredDistance")},{"./squaredDistance":393}],392:[function(r,O,B){O.exports=r("./squaredLength")},{"./squaredLength":394}],393:[function(r,O,B){O.exports=function(t,d){var m=d[0]-t[0],p=d[1]-t[1],e=d[2]-t[2];return m*m+p*p+e*e}},{}],394:[function(r,O,B){O.exports=function(t){var d=t[0],m=t[1],p=t[2];return d*d+m*m+p*p}},{}],395:[function(r,O,B){O.exports=r("./subtract")},{"./subtract":396}],396:[function(r,O,B){O.exports=function(t,d,m){return t[0]=d[0]-m[0],t[1]=d[1]-m[1],t[2]=d[2]-m[2],t}},{}],397:[function(r,O,B){O.exports=function(t,d,m){var p=d[0],e=d[1],f=d[2];return t[0]=p*m[0]+e*m[3]+f*m[6],t[1]=p*m[1]+e*m[4]+f*m[7],t[2]=p*m[2]+e*m[5]+f*m[8],t}},{}],398:[function(r,O,B){O.exports=function(t,d,m){var p=d[0],e=d[1],f=d[2],u=m[3]*p+m[7]*e+m[11]*f+m[15];return u=u||1,t[0]=(m[0]*p+m[4]*e+m[8]*f+m[12])/u,t[1]=(m[1]*p+m[5]*e+m[9]*f+m[13])/u,t[2]=(m[2]*p+m[6]*e+m[10]*f+m[14])/u,t}},{}],399:[function(r,O,B){O.exports=function(t,d,m){var p=d[0],e=d[1],f=d[2],u=m[0],s=m[1],l=m[2],o=m[3],i=o*p+s*f-l*e,c=o*e+l*p-u*f,n=o*f+u*e-s*p,a=-u*p-s*e-l*f;return t[0]=i*o+a*-u+c*-l-n*-s,t[1]=c*o+a*-s+n*-u-i*-l,t[2]=n*o+a*-l+i*-s-c*-u,t}},{}],400:[function(r,O,B){O.exports=function(t,d,m){return t[0]=d[0]+m[0],t[1]=d[1]+m[1],t[2]=d[2]+m[2],t[3]=d[3]+m[3],t}},{}],401:[function(r,O,B){O.exports=function(t){var d=new Float32Array(4);return d[0]=t[0],d[1]=t[1],d[2]=t[2],d[3]=t[3],d}},{}],402:[function(r,O,B){O.exports=function(t,d){return t[0]=d[0],t[1]=d[1],t[2]=d[2],t[3]=d[3],t}},{}],403:[function(r,O,B){O.exports=function(){var t=new Float32Array(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}},{}],404:[function(r,O,B){O.exports=function(t,d){var m=d[0]-t[0],p=d[1]-t[1],e=d[2]-t[2],f=d[3]-t[3];return Math.sqrt(m*m+p*p+e*e+f*f)}},{}],405:[function(r,O,B){O.exports=function(t,d,m){return t[0]=d[0]/m[0],t[1]=d[1]/m[1],t[2]=d[2]/m[2],t[3]=d[3]/m[3],t}},{}],406:[function(r,O,B){O.exports=function(t,d){return t[0]*d[0]+t[1]*d[1]+t[2]*d[2]+t[3]*d[3]}},{}],407:[function(r,O,B){O.exports=function(t,d,m,p){var e=new Float32Array(4);return e[0]=t,e[1]=d,e[2]=m,e[3]=p,e}},{}],408:[function(r,O,B){O.exports={create:r("./create"),clone:r("./clone"),fromValues:r("./fromValues"),copy:r("./copy"),set:r("./set"),add:r("./add"),subtract:r("./subtract"),multiply:r("./multiply"),divide:r("./divide"),min:r("./min"),max:r("./max"),scale:r("./scale"),scaleAndAdd:r("./scaleAndAdd"),distance:r("./distance"),squaredDistance:r("./squaredDistance"),length:r("./length"),squaredLength:r("./squaredLength"),negate:r("./negate"),inverse:r("./inverse"),normalize:r("./normalize"),dot:r("./dot"),lerp:r("./lerp"),random:r("./random"),transformMat4:r("./transformMat4"),transformQuat:r("./transformQuat")}},{"./add":400,"./clone":401,"./copy":402,"./create":403,"./distance":404,"./divide":405,"./dot":406,"./fromValues":407,"./inverse":409,"./length":410,"./lerp":411,"./max":412,"./min":413,"./multiply":414,"./negate":415,"./normalize":416,"./random":417,"./scale":418,"./scaleAndAdd":419,"./set":420,"./squaredDistance":421,"./squaredLength":422,"./subtract":423,"./transformMat4":424,"./transformQuat":425}],409:[function(r,O,B){O.exports=function(t,d){return t[0]=1/d[0],t[1]=1/d[1],t[2]=1/d[2],t[3]=1/d[3],t}},{}],410:[function(r,O,B){O.exports=function(t){var d=t[0],m=t[1],p=t[2],e=t[3];return Math.sqrt(d*d+m*m+p*p+e*e)}},{}],411:[function(r,O,B){O.exports=function(t,d,m,p){var e=d[0],f=d[1],u=d[2],s=d[3];return t[0]=e+p*(m[0]-e),t[1]=f+p*(m[1]-f),t[2]=u+p*(m[2]-u),t[3]=s+p*(m[3]-s),t}},{}],412:[function(r,O,B){O.exports=function(t,d,m){return t[0]=Math.max(d[0],m[0]),t[1]=Math.max(d[1],m[1]),t[2]=Math.max(d[2],m[2]),t[3]=Math.max(d[3],m[3]),t}},{}],413:[function(r,O,B){O.exports=function(t,d,m){return t[0]=Math.min(d[0],m[0]),t[1]=Math.min(d[1],m[1]),t[2]=Math.min(d[2],m[2]),t[3]=Math.min(d[3],m[3]),t}},{}],414:[function(r,O,B){O.exports=function(t,d,m){return t[0]=d[0]*m[0],t[1]=d[1]*m[1],t[2]=d[2]*m[2],t[3]=d[3]*m[3],t}},{}],415:[function(r,O,B){O.exports=function(t,d){return t[0]=-d[0],t[1]=-d[1],t[2]=-d[2],t[3]=-d[3],t}},{}],416:[function(r,O,B){O.exports=function(t,d){var m=d[0],p=d[1],e=d[2],f=d[3],u=m*m+p*p+e*e+f*f;return u>0&&(u=1/Math.sqrt(u),t[0]=m*u,t[1]=p*u,t[2]=e*u,t[3]=f*u),t}},{}],417:[function(r,O,B){var t=r("./normalize"),d=r("./scale");O.exports=function(m,p){return p=p||1,m[0]=Math.random(),m[1]=Math.random(),m[2]=Math.random(),m[3]=Math.random(),t(m,m),d(m,m,p),m}},{"./normalize":416,"./scale":418}],418:[function(r,O,B){O.exports=function(t,d,m){return t[0]=d[0]*m,t[1]=d[1]*m,t[2]=d[2]*m,t[3]=d[3]*m,t}},{}],419:[function(r,O,B){O.exports=function(t,d,m,p){return t[0]=d[0]+m[0]*p,t[1]=d[1]+m[1]*p,t[2]=d[2]+m[2]*p,t[3]=d[3]+m[3]*p,t}},{}],420:[function(r,O,B){O.exports=function(t,d,m,p,e){return t[0]=d,t[1]=m,t[2]=p,t[3]=e,t}},{}],421:[function(r,O,B){O.exports=function(t,d){var m=d[0]-t[0],p=d[1]-t[1],e=d[2]-t[2],f=d[3]-t[3];return m*m+p*p+e*e+f*f}},{}],422:[function(r,O,B){O.exports=function(t){var d=t[0],m=t[1],p=t[2],e=t[3];return d*d+m*m+p*p+e*e}},{}],423:[function(r,O,B){O.exports=function(t,d,m){return t[0]=d[0]-m[0],t[1]=d[1]-m[1],t[2]=d[2]-m[2],t[3]=d[3]-m[3],t}},{}],424:[function(r,O,B){O.exports=function(t,d,m){var p=d[0],e=d[1],f=d[2],u=d[3];return t[0]=m[0]*p+m[4]*e+m[8]*f+m[12]*u,t[1]=m[1]*p+m[5]*e+m[9]*f+m[13]*u,t[2]=m[2]*p+m[6]*e+m[10]*f+m[14]*u,t[3]=m[3]*p+m[7]*e+m[11]*f+m[15]*u,t}},{}],425:[function(r,O,B){O.exports=function(t,d,m){var p=d[0],e=d[1],f=d[2],u=m[0],s=m[1],l=m[2],o=m[3],i=o*p+s*f-l*e,c=o*e+l*p-u*f,n=o*f+u*e-s*p,a=-u*p-s*e-l*f;return t[0]=i*o+a*-u+c*-l-n*-s,t[1]=c*o+a*-s+n*-u-i*-l,t[2]=n*o+a*-l+i*-s-c*-u,t[3]=d[3],t}},{}],426:[function(r,O,B){var t=r("glsl-tokenizer"),d=r("atob-lite");O.exports=function(m){for(var p=Array.isArray(m)?m:t(m),e=0;e<p.length;e++){var f=p[e];if(f.type==="preprocessor"){var u=f.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(u&&u[2]){var s=u[1],l=u[2];return(s?d(l):l).trim()}}}}},{"atob-lite":84,"glsl-tokenizer":433}],427:[function(r,O,B){O.exports=function(u){var s,l,o,i=0,c=0,n=999,a=[],g=[],h=1,y=0,v=0,_=!1,x=!1,T="",A=m,S=t;(u=u||{}).version==="300 es"&&(A=e,S=p);var w={},C={};for(i=0;i<A.length;i++)w[A[i]]=!0;for(i=0;i<S.length;i++)C[S[i]]=!0;return function(H){return g=[],H!==null?function(Y){i=0,Y.toString&&(Y=Y.toString());var $;for(T+=Y.replace(/\r\n/g,`
`),o=T.length;s=T[i],i<o;){switch($=i,n){case 0:i=D();break;case 1:case 2:i=P();break;case 3:i=N();break;case 4:i=X();break;case 11:i=q();break;case 5:i=K();break;case 9999:i=Z();break;case 9:i=M();break;case 999:i=L()}if($!==i)switch(T[$]){case`
`:y=0,++h;break;default:++y}}return c+=i,T=T.slice(i),g}(H):function(Y){return a.length&&k(a.join("")),n=10,k("(eof)"),g}()};function k(H){H.length&&g.push({type:f[n],data:H,position:v,line:h,column:y})}function L(){return a=a.length?[]:a,l==="/"&&s==="*"?(v=c+i-1,n=0,l=s,i+1):l==="/"&&s==="/"?(v=c+i-1,n=1,l=s,i+1):s==="#"?(n=2,v=c+i,i):/\s/.test(s)?(n=9,v=c+i,i):(_=/\d/.test(s),x=/[^\w_]/.test(s),v=c+i,n=_?4:x?3:9999,i)}function M(){return/[^\s]/g.test(s)?(k(a.join("")),n=999,i):(a.push(s),l=s,i+1)}function P(){return s!=="\r"&&s!==`
`||l==="\\"?(a.push(s),l=s,i+1):(k(a.join("")),n=999,i)}function D(){return s==="/"&&l==="*"?(a.push(s),k(a.join("")),n=999,i+1):(a.push(s),l=s,i+1)}function N(){if(l==="."&&/\d/.test(s))return n=5,i;if(l==="/"&&s==="*")return n=0,i;if(l==="/"&&s==="/")return n=1,i;if(s==="."&&a.length){for(;U(a););return n=5,i}if(s===";"||s===")"||s==="("){if(a.length)for(;U(a););return k(s),n=999,i+1}var H=a.length===2&&s!=="=";if(/[\w_\d\s]/.test(s)||H){for(;U(a););return n=999,i}return a.push(s),l=s,i+1}function U(H){for(var Y,$,z=0;;){if(Y=d.indexOf(H.slice(0,H.length+z).join("")),$=d[Y],Y===-1){if(z--+H.length>0)continue;$=H.slice(0,1).join("")}return k($),v+=$.length,(a=a.slice($.length)).length}}function q(){return/[^a-fA-F0-9]/.test(s)?(k(a.join("")),n=999,i):(a.push(s),l=s,i+1)}function X(){return s==="."||/[eE]/.test(s)?(a.push(s),n=5,l=s,i+1):s==="x"&&a.length===1&&a[0]==="0"?(n=11,a.push(s),l=s,i+1):/[^\d]/.test(s)?(k(a.join("")),n=999,i):(a.push(s),l=s,i+1)}function K(){return s==="f"&&(a.push(s),l=s,i+=1),/[eE]/.test(s)?(a.push(s),l=s,i+1):(s!=="-"&&s!=="+"||!/[eE]/.test(l))&&/[^\d]/.test(s)?(k(a.join("")),n=999,i):(a.push(s),l=s,i+1)}function Z(){if(/[^\d\w_]/.test(s)){var H=a.join("");return n=C[H]?8:w[H]?7:6,k(a.join("")),n=999,i}return a.push(s),l=s,i+1}};var t=r("./lib/literals"),d=r("./lib/operators"),m=r("./lib/builtins"),p=r("./lib/literals-300es"),e=r("./lib/builtins-300es"),f=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":429,"./lib/builtins-300es":428,"./lib/literals":431,"./lib/literals-300es":430,"./lib/operators":432}],428:[function(r,O,B){var t=r("./builtins");t=t.slice().filter(function(d){return!/^(gl\_|texture)/.test(d)}),O.exports=t.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":429}],429:[function(r,O,B){O.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],430:[function(r,O,B){var t=r("./literals");O.exports=t.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":431}],431:[function(r,O,B){O.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],432:[function(r,O,B){O.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],433:[function(r,O,B){var t=r("./index");O.exports=function(d,m){var p=t(m),e=[];return e=(e=e.concat(p(d))).concat(p(null))}},{"./index":427}],434:[function(r,O,B){arguments[4][268][0].apply(B,arguments)},{dup:268}],435:[function(r,O,B){(function(t){(function(){var d,m=r("is-browser");d=typeof t.matchMedia=="function"?!t.matchMedia("(hover: none)").matches:m,O.exports=d}).call(this)}).call(this,typeof Xi!="undefined"?Xi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"is-browser":442}],436:[function(r,O,B){var t=r("is-browser");O.exports=t&&function(){var d=!1;try{var m=Object.defineProperty({},"passive",{get:function(){d=!0}});window.addEventListener("test",null,m),window.removeEventListener("test",null,m)}catch(p){d=!1}return d}()},{"is-browser":442}],437:[function(r,O,B){B.read=function(t,d,m,p,e){var f,u,s=8*e-p-1,l=(1<<s)-1,o=l>>1,i=-7,c=m?e-1:0,n=m?-1:1,a=t[d+c];for(c+=n,f=a&(1<<-i)-1,a>>=-i,i+=s;i>0;f=256*f+t[d+c],c+=n,i-=8);for(u=f&(1<<-i)-1,f>>=-i,i+=p;i>0;u=256*u+t[d+c],c+=n,i-=8);if(f===0)f=1-o;else{if(f===l)return u?NaN:1/0*(a?-1:1);u+=Math.pow(2,p),f-=o}return(a?-1:1)*u*Math.pow(2,f-p)},B.write=function(t,d,m,p,e,f){var u,s,l,o=8*f-e-1,i=(1<<o)-1,c=i>>1,n=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,a=p?0:f-1,g=p?1:-1,h=d<0||d===0&&1/d<0?1:0;for(d=Math.abs(d),isNaN(d)||d===1/0?(s=isNaN(d)?1:0,u=i):(u=Math.floor(Math.log(d)/Math.LN2),d*(l=Math.pow(2,-u))<1&&(u--,l*=2),(d+=u+c>=1?n/l:n*Math.pow(2,1-c))*l>=2&&(u++,l/=2),u+c>=i?(s=0,u=i):u+c>=1?(s=(d*l-1)*Math.pow(2,e),u+=c):(s=d*Math.pow(2,c-1)*Math.pow(2,e),u=0));e>=8;t[m+a]=255&s,a+=g,s/=256,e-=8);for(u=u<<e|s,o+=e;o>0;t[m+a]=255&u,a+=g,u/=256,o-=8);t[m+a-g]|=128*h}},{}],438:[function(r,O,B){O.exports=function(l,o){var i=l.length;if(i===0)throw new Error("Must have at least d+1 points");var c=l[0].length;if(i<=c)throw new Error("Must input at least d+1 points");var n=l.slice(0,c+1),a=t.apply(void 0,n);if(a===0)throw new Error("Input not in general position");for(var g=new Array(c+1),h=0;h<=c;++h)g[h]=h;a<0&&(g[0]=1,g[1]=0);var y=new m(g,new Array(c+1),!1),v=y.adjacent,_=new Array(c+2);for(h=0;h<=c;++h){for(var x=g.slice(),T=0;T<=c;++T)T===h&&(x[T]=-1);var A=x[0];x[0]=x[1],x[1]=A;var S=new m(x,new Array(c+1),!0);v[h]=S,_[h]=S}for(_[c+1]=y,h=0;h<=c;++h){x=v[h].vertices;var w=v[h].adjacent;for(T=0;T<=c;++T){var C=x[T];if(C<0)w[T]=y;else for(var k=0;k<=c;++k)v[k].vertices.indexOf(C)<0&&(w[T]=v[k])}}var L=new u(c,n,_),M=!!o;for(h=c+1;h<i;++h)L.insert(l[h],M);return L.boundary()};var t=r("robust-orientation"),d=r("simplicial-complex").compareCells;function m(l,o,i){this.vertices=l,this.adjacent=o,this.boundary=i,this.lastVisited=-1}function p(l,o,i){this.vertices=l,this.cell=o,this.index=i}function e(l,o){return d(l.vertices,o.vertices)}m.prototype.flip=function(){var l=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=l;var o=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=o};var f=[];function u(l,o,i){this.dimension=l,this.vertices=o,this.simplices=i,this.interior=i.filter(function(g){return!g.boundary}),this.tuple=new Array(l+1);for(var c=0;c<=l;++c)this.tuple[c]=this.vertices[c];var n,a=f[l];a||(a=f[l]=((n=t[l+1])||(n=t),function(g){return function(){var h=this.tuple;return g.apply(this,h)}}(n))),this.orient=a}var s=u.prototype;s.handleBoundaryDegeneracy=function(l,o){var i=this.dimension,c=this.vertices.length-1,n=this.tuple,a=this.vertices,g=[l];for(l.lastVisited=-c;g.length>0;)for(var h=(l=g.pop()).adjacent,y=0;y<=i;++y){var v=h[y];if(v.boundary&&!(v.lastVisited<=-c)){for(var _=v.vertices,x=0;x<=i;++x){var T=_[x];n[x]=T<0?o:a[T]}var A=this.orient();if(A>0)return v;v.lastVisited=-c,A===0&&g.push(v)}}return null},s.walk=function(l,o){var i=this.vertices.length-1,c=this.dimension,n=this.vertices,a=this.tuple,g=o?this.interior.length*Math.random()|0:this.interior.length-1,h=this.interior[g];e:for(;!h.boundary;){for(var y=h.vertices,v=h.adjacent,_=0;_<=c;++_)a[_]=n[y[_]];for(h.lastVisited=i,_=0;_<=c;++_){var x=v[_];if(!(x.lastVisited>=i)){var T=a[_];a[_]=l;var A=this.orient();if(a[_]=T,A<0){h=x;continue e}x.boundary?x.lastVisited=-i:x.lastVisited=i}}return}return h},s.addPeaks=function(l,o){var i=this.vertices.length-1,c=this.dimension,n=this.vertices,a=this.tuple,g=this.interior,h=this.simplices,y=[o];o.lastVisited=i,o.vertices[o.vertices.indexOf(-1)]=i,o.boundary=!1,g.push(o);for(var v=[];y.length>0;){var _=(o=y.pop()).vertices,x=o.adjacent,T=_.indexOf(i);if(!(T<0)){for(var A=0;A<=c;++A)if(A!==T){var S=x[A];if(S.boundary&&!(S.lastVisited>=i)){var w=S.vertices;if(S.lastVisited!==-i){for(var C=0,k=0;k<=c;++k)w[k]<0?(C=k,a[k]=l):a[k]=n[w[k]];if(this.orient()>0){w[C]=i,S.boundary=!1,g.push(S),y.push(S),S.lastVisited=i;continue}S.lastVisited=-i}var L=S.adjacent,M=_.slice(),P=x.slice(),D=new m(M,P,!0);h.push(D);var N=L.indexOf(o);if(!(N<0))for(L[N]=D,P[T]=S,M[A]=-1,P[A]=o,x[A]=D,D.flip(),k=0;k<=c;++k){var U=M[k];if(!(U<0||U===i)){for(var q=new Array(c-1),X=0,K=0;K<=c;++K){var Z=M[K];Z<0||K===k||(q[X++]=Z)}v.push(new p(q,D,k))}}}}}}for(v.sort(e),A=0;A+1<v.length;A+=2){var H=v[A],Y=v[A+1],$=H.index,z=Y.index;$<0||z<0||(H.cell.adjacent[H.index]=Y.cell,Y.cell.adjacent[Y.index]=H.cell)}},s.insert=function(l,o){var i=this.vertices;i.push(l);var c=this.walk(l,o);if(c){for(var n=this.dimension,a=this.tuple,g=0;g<=n;++g){var h=c.vertices[g];a[g]=h<0?l:i[h]}var y=this.orient(a);y<0||(y!==0||(c=this.handleBoundaryDegeneracy(c,l)))&&this.addPeaks(l,c)}},s.boundary=function(){for(var l=this.dimension,o=[],i=this.simplices,c=i.length,n=0;n<c;++n){var a=i[n];if(a.boundary){for(var g=new Array(l),h=a.vertices,y=0,v=0,_=0;_<=l;++_)h[_]>=0?g[y++]=h[_]:v=1&_;if(v===(1&l)){var x=g[0];g[0]=g[1],g[1]=x}o.push(g)}}return o}},{"robust-orientation":534,"simplicial-complex":545}],439:[function(r,O,B){typeof Object.create=="function"?O.exports=function(t,d){d&&(t.super_=d,t.prototype=Object.create(d.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:O.exports=function(t,d){if(d){t.super_=d;var m=function(){};m.prototype=d.prototype,t.prototype=new m,t.prototype.constructor=t}}},{}],440:[function(r,O,B){var t=r("binary-search-bounds");function d(y,v,_,x,T){this.mid=y,this.left=v,this.right=_,this.leftPoints=x,this.rightPoints=T,this.count=(v?v.count:0)+(_?_.count:0)+x.length}O.exports=function(y){return!y||y.length===0?new g(null):new g(a(y))};var m=d.prototype;function p(y,v){y.mid=v.mid,y.left=v.left,y.right=v.right,y.leftPoints=v.leftPoints,y.rightPoints=v.rightPoints,y.count=v.count}function e(y,v){var _=a(v);y.mid=_.mid,y.left=_.left,y.right=_.right,y.leftPoints=_.leftPoints,y.rightPoints=_.rightPoints,y.count=_.count}function f(y,v){var _=y.intervals([]);_.push(v),e(y,_)}function u(y,v){var _=y.intervals([]),x=_.indexOf(v);return x<0?0:(_.splice(x,1),e(y,_),1)}function s(y,v,_){for(var x=0;x<y.length&&y[x][0]<=v;++x){var T=_(y[x]);if(T)return T}}function l(y,v,_){for(var x=y.length-1;x>=0&&y[x][1]>=v;--x){var T=_(y[x]);if(T)return T}}function o(y,v){for(var _=0;_<y.length;++_){var x=v(y[_]);if(x)return x}}function i(y,v){return y-v}function c(y,v){var _=y[0]-v[0];return _||y[1]-v[1]}function n(y,v){var _=y[1]-v[1];return _||y[0]-v[0]}function a(y){if(y.length===0)return null;for(var v=[],_=0;_<y.length;++_)v.push(y[_][0],y[_][1]);v.sort(i);var x=v[v.length>>1],T=[],A=[],S=[];for(_=0;_<y.length;++_){var w=y[_];w[1]<x?T.push(w):x<w[0]?A.push(w):S.push(w)}var C=S,k=S.slice();return C.sort(c),k.sort(n),new d(x,a(T),a(A),C,k)}function g(y){this.root=y}m.intervals=function(y){return y.push.apply(y,this.leftPoints),this.left&&this.left.intervals(y),this.right&&this.right.intervals(y),y},m.insert=function(y){var v=this.count-this.leftPoints.length;if(this.count+=1,y[1]<this.mid)this.left?4*(this.left.count+1)>3*(v+1)?f(this,y):this.left.insert(y):this.left=a([y]);else if(y[0]>this.mid)this.right?4*(this.right.count+1)>3*(v+1)?f(this,y):this.right.insert(y):this.right=a([y]);else{var _=t.ge(this.leftPoints,y,c),x=t.ge(this.rightPoints,y,n);this.leftPoints.splice(_,0,y),this.rightPoints.splice(x,0,y)}},m.remove=function(y){var v=this.count-this.leftPoints;if(y[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(v-1)?u(this,y):(A=this.left.remove(y))===2?(this.left=null,this.count-=1,1):(A===1&&(this.count-=1),A):0;if(y[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(v-1)?u(this,y):(A=this.right.remove(y))===2?(this.right=null,this.count-=1,1):(A===1&&(this.count-=1),A):0;if(this.count===1)return this.leftPoints[0]===y?2:0;if(this.leftPoints.length===1&&this.leftPoints[0]===y){if(this.left&&this.right){for(var _=this,x=this.left;x.right;)_=x,x=x.right;if(_===this)x.right=this.right;else{var T=this.left,A=this.right;_.count-=x.count,_.right=x.left,x.left=T,x.right=A}p(this,x),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?p(this,this.left):p(this,this.right);return 1}for(T=t.ge(this.leftPoints,y,c);T<this.leftPoints.length&&this.leftPoints[T][0]===y[0];++T)if(this.leftPoints[T]===y){for(this.count-=1,this.leftPoints.splice(T,1),A=t.ge(this.rightPoints,y,n);A<this.rightPoints.length&&this.rightPoints[A][1]===y[1];++A)if(this.rightPoints[A]===y)return this.rightPoints.splice(A,1),1}return 0},m.queryPoint=function(y,v){if(y<this.mid)return this.left&&(_=this.left.queryPoint(y,v))?_:s(this.leftPoints,y,v);if(y>this.mid){var _;return this.right&&(_=this.right.queryPoint(y,v))?_:l(this.rightPoints,y,v)}return o(this.leftPoints,v)},m.queryInterval=function(y,v,_){var x;return y<this.mid&&this.left&&(x=this.left.queryInterval(y,v,_))||v>this.mid&&this.right&&(x=this.right.queryInterval(y,v,_))?x:v<this.mid?s(this.leftPoints,v,_):y>this.mid?l(this.rightPoints,y,_):o(this.leftPoints,_)};var h=g.prototype;h.insert=function(y){this.root?this.root.insert(y):this.root=new d(y[0],null,null,[y],[y])},h.remove=function(y){if(this.root){var v=this.root.remove(y);return v===2&&(this.root=null),v!==0}return!1},h.queryPoint=function(y,v){if(this.root)return this.root.queryPoint(y,v)},h.queryInterval=function(y,v,_){if(y<=v&&this.root)return this.root.queryInterval(y,v,_)},Object.defineProperty(h,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(h,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":103}],441:[function(r,O,B){O.exports=function(t){for(var d=new Array(t),m=0;m<t;++m)d[m]=m;return d}},{}],442:[function(r,O,B){O.exports=!0},{}],443:[function(r,O,B){function t(d){return!!d.constructor&&typeof d.constructor.isBuffer=="function"&&d.constructor.isBuffer(d)}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */O.exports=function(d){return d!=null&&(t(d)||function(m){return typeof m.readFloatLE=="function"&&typeof m.slice=="function"&&t(m.slice(0,0))}(d)||!!d._isBuffer)}},{}],444:[function(r,O,B){O.exports=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],445:[function(r,O,B){O.exports=m,O.exports.isMobile=m,O.exports.default=m;var t=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,d=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function m(p){p||(p={});var e=p.ua;if(e||typeof navigator=="undefined"||(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var f=p.tablet?d.test(e):t.test(e);return!f&&p.tablet&&p.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(f=!0),f}},{}],446:[function(r,O,B){O.exports=function(t){var d=typeof t;return t!==null&&(d==="object"||d==="function")}},{}],447:[function(r,O,B){var t=Object.prototype.toString;O.exports=function(d){var m;return t.call(d)==="[object Object]"&&((m=Object.getPrototypeOf(d))===null||m===Object.getPrototypeOf({}))}},{}],448:[function(r,O,B){O.exports=function(t){for(var d,m=t.length,p=0;p<m;p++)if(((d=t.charCodeAt(p))<9||d>13)&&d!==32&&d!==133&&d!==160&&d!==5760&&d!==6158&&(d<8192||d>8205)&&d!==8232&&d!==8233&&d!==8239&&d!==8287&&d!==8288&&d!==12288&&d!==65279)return!1;return!0}},{}],449:[function(r,O,B){O.exports=function(t){return typeof t=="string"&&(t=t.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(t)&&/[\dz]$/i.test(t)&&t.length>4))}},{}],450:[function(r,O,B){O.exports=function(t,d,m){return t*(1-m)+d*m}},{}],451:[function(r,O,B){(function(t,d){typeof B=="object"&&O!==void 0?O.exports=d():(t=t||self).mapboxgl=d()})(this,function(){var t,d,m;function p(e,f){if(t)if(d){var u="var sharedChunk = {}; ("+t+")(sharedChunk); ("+d+")(sharedChunk);",s={};t(s),(m=f(s)).workerUrl=window.URL.createObjectURL(new Blob([u],{type:"text/javascript"}))}else d=f;else t=f}return p(0,function(e){function f(b,I){return b(I={exports:{}},I.exports),I.exports}var u=s;function s(b,I,G,re){this.cx=3*b,this.bx=3*(G-b)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*I,this.by=3*(re-I)-this.cy,this.ay=1-this.cy-this.by,this.p1x=b,this.p1y=re,this.p2x=G,this.p2y=re}s.prototype.sampleCurveX=function(b){return((this.ax*b+this.bx)*b+this.cx)*b},s.prototype.sampleCurveY=function(b){return((this.ay*b+this.by)*b+this.cy)*b},s.prototype.sampleCurveDerivativeX=function(b){return(3*this.ax*b+2*this.bx)*b+this.cx},s.prototype.solveCurveX=function(b,I){var G,re,fe,me,Ae;for(I===void 0&&(I=1e-6),fe=b,Ae=0;Ae<8;Ae++){if(me=this.sampleCurveX(fe)-b,Math.abs(me)<I)return fe;var De=this.sampleCurveDerivativeX(fe);if(Math.abs(De)<1e-6)break;fe-=me/De}if((fe=b)<(G=0))return G;if(fe>(re=1))return re;for(;G<re;){if(me=this.sampleCurveX(fe),Math.abs(me-b)<I)return fe;b>me?G=fe:re=fe,fe=.5*(re-G)+G}return fe},s.prototype.solve=function(b,I){return this.sampleCurveY(this.solveCurveX(b,I))};var l=o;function o(b,I){this.x=b,this.y=I}function i(b,I,G,re){var fe=new u(b,I,G,re);return function(me){return fe.solve(me)}}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(b){return this.clone()._add(b)},sub:function(b){return this.clone()._sub(b)},multByPoint:function(b){return this.clone()._multByPoint(b)},divByPoint:function(b){return this.clone()._divByPoint(b)},mult:function(b){return this.clone()._mult(b)},div:function(b){return this.clone()._div(b)},rotate:function(b){return this.clone()._rotate(b)},rotateAround:function(b,I){return this.clone()._rotateAround(b,I)},matMult:function(b){return this.clone()._matMult(b)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(b){return this.x===b.x&&this.y===b.y},dist:function(b){return Math.sqrt(this.distSqr(b))},distSqr:function(b){var I=b.x-this.x,G=b.y-this.y;return I*I+G*G},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(b){return Math.atan2(this.y-b.y,this.x-b.x)},angleWith:function(b){return this.angleWithSep(b.x,b.y)},angleWithSep:function(b,I){return Math.atan2(this.x*I-this.y*b,this.x*b+this.y*I)},_matMult:function(b){var I=b[0]*this.x+b[1]*this.y,G=b[2]*this.x+b[3]*this.y;return this.x=I,this.y=G,this},_add:function(b){return this.x+=b.x,this.y+=b.y,this},_sub:function(b){return this.x-=b.x,this.y-=b.y,this},_mult:function(b){return this.x*=b,this.y*=b,this},_div:function(b){return this.x/=b,this.y/=b,this},_multByPoint:function(b){return this.x*=b.x,this.y*=b.y,this},_divByPoint:function(b){return this.x/=b.x,this.y/=b.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var b=this.y;return this.y=this.x,this.x=-b,this},_rotate:function(b){var I=Math.cos(b),G=Math.sin(b),re=I*this.x-G*this.y,fe=G*this.x+I*this.y;return this.x=re,this.y=fe,this},_rotateAround:function(b,I){var G=Math.cos(b),re=Math.sin(b),fe=I.x+G*(this.x-I.x)-re*(this.y-I.y),me=I.y+re*(this.x-I.x)+G*(this.y-I.y);return this.x=fe,this.y=me,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(b){return b instanceof o?b:Array.isArray(b)?new o(b[0],b[1]):b};var c=i(.25,.1,.25,1);function n(b,I,G){return Math.min(G,Math.max(I,b))}function a(b,I,G){var re=G-I,fe=((b-I)%re+re)%re+I;return fe===I?G:fe}function g(b){for(var I=[],G=arguments.length-1;G-- >0;)I[G]=arguments[G+1];for(var re=0,fe=I;re<fe.length;re+=1){var me=fe[re];for(var Ae in me)b[Ae]=me[Ae]}return b}var h=1;function y(){return h++}function v(){return function b(I){return I?(I^16*Math.random()>>I/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,b)}()}function _(b){return!!b&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(b)}function x(b,I){b.forEach(function(G){I[G]&&(I[G]=I[G].bind(I))})}function T(b,I){return b.indexOf(I,b.length-I.length)!==-1}function A(b,I,G){var re={};for(var fe in b)re[fe]=I.call(G||this,b[fe],fe,b);return re}function S(b,I,G){var re={};for(var fe in b)I.call(G||this,b[fe],fe,b)&&(re[fe]=b[fe]);return re}function w(b){return Array.isArray(b)?b.map(w):typeof b=="object"&&b?A(b,w):b}var C={};function k(b){C[b]||(typeof console!="undefined"&&console.warn(b),C[b]=!0)}function L(b,I,G){return(G.y-b.y)*(I.x-b.x)>(I.y-b.y)*(G.x-b.x)}function M(b){for(var I=0,G=0,re=b.length,fe=re-1,me=void 0,Ae=void 0;G<re;fe=G++)me=b[G],I+=((Ae=b[fe]).x-me.x)*(me.y+Ae.y);return I}function P(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function D(b){var I={};if(b.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(re,fe,me,Ae){var De=me||Ae;return I[fe]=!De||De.toLowerCase(),""}),I["max-age"]){var G=parseInt(I["max-age"],10);isNaN(G)?delete I["max-age"]:I["max-age"]=G}return I}var N=null;function U(b){if(N==null){var I=b.navigator?b.navigator.userAgent:null;N=!!b.safari||!(!I||!(/\b(iPad|iPhone|iPod)\b/.test(I)||I.match("Safari")&&!I.match("Chrome")))}return N}function q(b){try{var I=self[b];return I.setItem("_mapbox_test_",1),I.removeItem("_mapbox_test_"),!0}catch(G){return!1}}var X,K,Z,H,Y=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),$=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,z=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,j={now:Y,frame:function(b){var I=$(b);return{cancel:function(){return z(I)}}},getImageData:function(b,I){I===void 0&&(I=0);var G=self.document.createElement("canvas"),re=G.getContext("2d");if(!re)throw new Error("failed to create canvas 2d context");return G.width=b.width,G.height=b.height,re.drawImage(b,0,0,b.width,b.height),re.getImageData(-I,-I,b.width+2*I,b.height+2*I)},resolveURL:function(b){return X||(X=self.document.createElement("a")),X.href=b,X.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(K==null&&(K=self.matchMedia("(prefers-reduced-motion: reduce)")),K.matches)}},W={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ee={supported:!1,testSupport:function(b){J||!H||(Q?te(b):Z=b)}},J=!1,Q=!1;function te(b){var I=b.createTexture();b.bindTexture(b.TEXTURE_2D,I);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,H),b.isContextLost())return;ee.supported=!0}catch(G){}b.deleteTexture(I),J=!0}self.document&&((H=self.document.createElement("img")).onload=function(){Z&&te(Z),Z=null,Q=!0},H.onerror=function(){J=!0,Z=null},H.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ie="01",ae=function(b,I){this._transformRequestFn=b,this._customAccessToken=I,this._createSkuToken()};function he(b){return b.indexOf("mapbox:")===0}ae.prototype._createSkuToken=function(){var b=function(){for(var I="",G=0;G<10;G++)I+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ie,I].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=b.token,this._skuTokenExpiresAt=b.tokenExpiresAt},ae.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ae.prototype.transformRequest=function(b,I){return this._transformRequestFn&&this._transformRequestFn(b,I)||{url:b}},ae.prototype.normalizeStyleURL=function(b,I){if(!he(b))return b;var G=ve(b);return G.path="/styles/v1"+G.path,this._makeAPIURL(G,this._customAccessToken||I)},ae.prototype.normalizeGlyphsURL=function(b,I){if(!he(b))return b;var G=ve(b);return G.path="/fonts/v1"+G.path,this._makeAPIURL(G,this._customAccessToken||I)},ae.prototype.normalizeSourceURL=function(b,I){if(!he(b))return b;var G=ve(b);return G.path="/v4/"+G.authority+".json",G.params.push("secure"),this._makeAPIURL(G,this._customAccessToken||I)},ae.prototype.normalizeSpriteURL=function(b,I,G,re){var fe=ve(b);return he(b)?(fe.path="/styles/v1"+fe.path+"/sprite"+I+G,this._makeAPIURL(fe,this._customAccessToken||re)):(fe.path+=""+I+G,ke(fe))},ae.prototype.normalizeTileURL=function(b,I){if(this._isSkuTokenExpired()&&this._createSkuToken(),b&&!he(b))return b;var G=ve(b),re=j.devicePixelRatio>=2||I===512?"@2x":"",fe=ee.supported?".webp":"$1";G.path=G.path.replace(/(\.(png|jpg)\d*)(?=$)/,""+re+fe),G.path=G.path.replace(/^.+\/v4\//,"/"),G.path="/v4"+G.path;var me=this._customAccessToken||function(Ae){for(var De=0,Ze=Ae;De<Ze.length;De+=1){var ut=Ze[De].match(/^access_token=(.*)$/);if(ut)return ut[1]}return null}(G.params)||W.ACCESS_TOKEN;return W.REQUIRE_ACCESS_TOKEN&&me&&this._skuToken&&G.params.push("sku="+this._skuToken),this._makeAPIURL(G,me)},ae.prototype.canonicalizeTileURL=function(b,I){var G=ve(b);if(!G.path.match(/(^\/v4\/)/)||!G.path.match(/\.[\w]+$/))return b;var re="mapbox://tiles/";re+=G.path.replace("/v4/","");var fe=G.params;return I&&(fe=fe.filter(function(me){return!me.match(/^access_token=/)})),fe.length&&(re+="?"+fe.join("&")),re},ae.prototype.canonicalizeTileset=function(b,I){for(var G=!!I&&he(I),re=[],fe=0,me=b.tiles||[];fe<me.length;fe+=1){var Ae=me[fe];de(Ae)?re.push(this.canonicalizeTileURL(Ae,G)):re.push(Ae)}return re},ae.prototype._makeAPIURL=function(b,I){var G="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",re=ve(W.API_URL);if(b.protocol=re.protocol,b.authority=re.authority,re.path!=="/"&&(b.path=""+re.path+b.path),!W.REQUIRE_ACCESS_TOKEN)return ke(b);if(!(I=I||W.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+G);if(I[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+G);return b.params=b.params.filter(function(fe){return fe.indexOf("access_token")===-1}),b.params.push("access_token="+I),ke(b)};var se=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function de(b){return se.test(b)}var ue=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ve(b){var I=b.match(ue);if(!I)throw new Error("Unable to parse URL object");return{protocol:I[1],authority:I[2],path:I[3]||"/",params:I[4]?I[4].split("&"):[]}}function ke(b){var I=b.params.length?"?"+b.params.join("&"):"";return b.protocol+"://"+b.authority+b.path+I}function Ee(b){if(!b)return null;var I,G=b.split(".");if(!G||G.length!==3)return null;try{return JSON.parse((I=G[1],decodeURIComponent(self.atob(I).split("").map(function(re){return"%"+("00"+re.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch(re){return null}}var be=function(b){this.type=b,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};be.prototype.getStorageKey=function(b){var I,G=Ee(W.ACCESS_TOKEN),re="";return G&&G.u?(I=G.u,re=self.btoa(encodeURIComponent(I).replace(/%([0-9A-F]{2})/g,function(fe,me){return String.fromCharCode(Number("0x"+me))}))):re=W.ACCESS_TOKEN||"",b?"mapbox.eventData."+b+":"+re:"mapbox.eventData:"+re},be.prototype.fetchEventData=function(){var b=q("localStorage"),I=this.getStorageKey(),G=this.getStorageKey("uuid");if(b)try{var re=self.localStorage.getItem(I);re&&(this.eventData=JSON.parse(re));var fe=self.localStorage.getItem(G);fe&&(this.anonId=fe)}catch(me){k("Unable to read from LocalStorage")}},be.prototype.saveEventData=function(){var b=q("localStorage"),I=this.getStorageKey(),G=this.getStorageKey("uuid");if(b)try{self.localStorage.setItem(G,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(I,JSON.stringify(this.eventData))}catch(re){k("Unable to write to LocalStorage")}},be.prototype.processRequests=function(b){},be.prototype.postEvent=function(b,I,G,re){var fe=this;if(W.EVENTS_URL){var me=ve(W.EVENTS_URL);me.params.push("access_token="+(re||W.ACCESS_TOKEN||""));var Ae={event:this.type,created:new Date(b).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.10.1",skuId:ie,userId:this.anonId},De=I?g(Ae,I):Ae,Ze={url:ke(me),headers:{"Content-Type":"text/plain"},body:JSON.stringify([De])};this.pendingRequest=er(Ze,function(ut){fe.pendingRequest=null,G(ut),fe.saveEventData(),fe.processRequests(re)})}},be.prototype.queueRequest=function(b,I){this.queue.push(b),this.processRequests(I)};var xe,ce,ge=function(b){function I(){b.call(this,"map.load"),this.success={},this.skuToken=""}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.postMapLoadEvent=function(G,re,fe,me){this.skuToken=fe,(W.EVENTS_URL&&me||W.ACCESS_TOKEN&&Array.isArray(G)&&G.some(function(Ae){return he(Ae)||de(Ae)}))&&this.queueRequest({id:re,timestamp:Date.now()},me)},I.prototype.processRequests=function(G){var re=this;if(!this.pendingRequest&&this.queue.length!==0){var fe=this.queue.shift(),me=fe.id,Ae=fe.timestamp;me&&this.success[me]||(this.anonId||this.fetchEventData(),_(this.anonId)||(this.anonId=v()),this.postEvent(Ae,{skuToken:this.skuToken},function(De){De||me&&(re.success[me]=!0)},G))}},I}(be),we=new(function(b){function I(G){b.call(this,"appUserTurnstile"),this._customAccessToken=G}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.postTurnstileEvent=function(G,re){W.EVENTS_URL&&W.ACCESS_TOKEN&&Array.isArray(G)&&G.some(function(fe){return he(fe)||de(fe)})&&this.queueRequest(Date.now(),re)},I.prototype.processRequests=function(G){var re=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var fe=Ee(W.ACCESS_TOKEN),me=fe?fe.u:W.ACCESS_TOKEN,Ae=me!==this.eventData.tokenU;_(this.anonId)||(this.anonId=v(),Ae=!0);var De=this.queue.shift();if(this.eventData.lastSuccess){var Ze=new Date(this.eventData.lastSuccess),ut=new Date(De),gt=(De-this.eventData.lastSuccess)/864e5;Ae=Ae||gt>=1||gt<-1||Ze.getDate()!==ut.getDate()}else Ae=!0;if(!Ae)return this.processRequests();this.postEvent(De,{"enabled.telemetry":!1},function(Bt){Bt||(re.eventData.lastSuccess=De,re.eventData.tokenU=me)},G)}},I}(be)),Me=we.postTurnstileEvent.bind(we),Se=new ge,ze=Se.postMapLoadEvent.bind(Se),Fe=500,Ye=50;function rt(){self.caches&&!xe&&(xe=self.caches.open("mapbox-tiles"))}function Oe(b,I,G){if(rt(),xe){var re={status:I.status,statusText:I.statusText,headers:new self.Headers};I.headers.forEach(function(me,Ae){return re.headers.set(Ae,me)});var fe=D(I.headers.get("Cache-Control")||"");fe["no-store"]||(fe["max-age"]&&re.headers.set("Expires",new Date(G+1e3*fe["max-age"]).toUTCString()),new Date(re.headers.get("Expires")).getTime()-G<42e4||function(me,Ae){if(ce===void 0)try{new Response(new ReadableStream),ce=!0}catch(De){ce=!1}ce?Ae(me.body):me.blob().then(Ae)}(I,function(me){var Ae=new self.Response(me,re);rt(),xe&&xe.then(function(De){return De.put(je(b.url),Ae)}).catch(function(De){return k(De.message)})}))}}function je(b){var I=b.indexOf("?");return I<0?b:b.slice(0,I)}function We(b,I){if(rt(),!xe)return I(null);var G=je(b.url);xe.then(function(re){re.match(G).then(function(fe){var me=function(Ae){if(!Ae)return!1;var De=new Date(Ae.headers.get("Expires")||0),Ze=D(Ae.headers.get("Cache-Control")||"");return De>Date.now()&&!Ze["no-cache"]}(fe);re.delete(G),me&&re.put(G,fe.clone()),I(null,fe,me)}).catch(I)}).catch(I)}var qe,Qe=1/0;function st(){return qe==null&&(qe=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),qe}var ct={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ct);var Pt=function(b){function I(G,re,fe){re===401&&de(fe)&&(G+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),b.call(this,G),this.status=re,this.url=fe,this.name=this.constructor.name,this.message=G}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},I}(Error),kt=P()?function(){return self.worker&&self.worker.referrer}:function(){return(self.location.protocol==="blob:"?self.parent:self).location.href};function at(b,I){var G,re=new self.AbortController,fe=new self.Request(b.url,{method:b.method||"GET",body:b.body,credentials:b.credentials,headers:b.headers,referrer:kt(),signal:re.signal}),me=!1,Ae=!1,De=(G=fe.url).indexOf("sku=")>0&&de(G);b.type==="json"&&fe.headers.set("Accept","application/json");var Ze=function(gt,Bt,Wt){if(!Ae){if(gt&&gt.message!=="SecurityError"&&k(gt),Bt&&Wt)return ut(Bt);var Ht=Date.now();self.fetch(fe).then(function(ar){if(ar.ok){var gr=De?ar.clone():null;return ut(ar,gr,Ht)}return I(new Pt(ar.statusText,ar.status,b.url))}).catch(function(ar){ar.code!==20&&I(new Error(ar.message))})}},ut=function(gt,Bt,Wt){(b.type==="arrayBuffer"?gt.arrayBuffer():b.type==="json"?gt.json():gt.text()).then(function(Ht){Ae||(Bt&&Wt&&Oe(fe,Bt,Wt),me=!0,I(null,Ht,gt.headers.get("Cache-Control"),gt.headers.get("Expires")))}).catch(function(Ht){Ae||I(new Error(Ht.message))})};return De?We(fe,Ze):Ze(null,null),{cancel:function(){Ae=!0,me||re.abort()}}}var tt=function(b,I){if(G=b.url,!(/^file:/.test(G)||/^file:/.test(kt())&&!/^\w+:/.test(G))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return at(b,I);if(P()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",b,I,void 0,!0)}var G;return function(re,fe){var me=new self.XMLHttpRequest;for(var Ae in me.open(re.method||"GET",re.url,!0),re.type==="arrayBuffer"&&(me.responseType="arraybuffer"),re.headers)me.setRequestHeader(Ae,re.headers[Ae]);return re.type==="json"&&(me.responseType="text",me.setRequestHeader("Accept","application/json")),me.withCredentials=re.credentials==="include",me.onerror=function(){fe(new Error(me.statusText))},me.onload=function(){if((me.status>=200&&me.status<300||me.status===0)&&me.response!==null){var De=me.response;if(re.type==="json")try{De=JSON.parse(me.response)}catch(Ze){return fe(Ze)}fe(null,De,me.getResponseHeader("Cache-Control"),me.getResponseHeader("Expires"))}else fe(new Pt(me.statusText,me.status,re.url))},me.send(re.body),{cancel:function(){return me.abort()}}}(b,I)},_t=function(b,I){return tt(g(b,{type:"arrayBuffer"}),I)},er=function(b,I){return tt(g(b,{method:"POST"}),I)},tr,Ue;tr=[],Ue=0;var He=function(b,I){if(ee.supported&&(b.headers||(b.headers={}),b.headers.accept="image/webp,*/*"),Ue>=W.MAX_PARALLEL_IMAGE_REQUESTS){var G={requestParameters:b,callback:I,cancelled:!1,cancel:function(){this.cancelled=!0}};return tr.push(G),G}Ue++;var re=!1,fe=function(){if(!re)for(re=!0,Ue--;tr.length&&Ue<W.MAX_PARALLEL_IMAGE_REQUESTS;){var Ae=tr.shift(),De=Ae.requestParameters,Ze=Ae.callback;Ae.cancelled||(Ae.cancel=He(De,Ze).cancel)}},me=_t(b,function(Ae,De,Ze,ut){fe(),Ae?I(Ae):De&&(st()?function(gt,Bt){var Wt=new self.Blob([new Uint8Array(gt)],{type:"image/png"});self.createImageBitmap(Wt).then(function(Ht){Bt(null,Ht)}).catch(function(Ht){Bt(new Error("Could not load image because of "+Ht.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(De,I):function(gt,Bt,Wt,Ht){var ar=new self.Image,gr=self.URL;ar.onload=function(){Bt(null,ar),gr.revokeObjectURL(ar.src)},ar.onerror=function(){return Bt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Cr=new self.Blob([new Uint8Array(gt)],{type:"image/png"});ar.cacheControl=Wt,ar.expires=Ht,ar.src=gt.byteLength?gr.createObjectURL(Cr):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(De,I,Ze,ut))});return{cancel:function(){me.cancel(),fe()}}};function Be(b,I,G){G[b]&&G[b].indexOf(I)!==-1||(G[b]=G[b]||[],G[b].push(I))}function Ke(b,I,G){if(G&&G[b]){var re=G[b].indexOf(I);re!==-1&&G[b].splice(re,1)}}var _e=function(b,I){I===void 0&&(I={}),g(this,I),this.type=b},Ce=function(b){function I(G,re){re===void 0&&(re={}),b.call(this,"error",g({error:G},re))}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I}(_e),Le=function(){};Le.prototype.on=function(b,I){return this._listeners=this._listeners||{},Be(b,I,this._listeners),this},Le.prototype.off=function(b,I){return Ke(b,I,this._listeners),Ke(b,I,this._oneTimeListeners),this},Le.prototype.once=function(b,I){return this._oneTimeListeners=this._oneTimeListeners||{},Be(b,I,this._oneTimeListeners),this},Le.prototype.fire=function(b,I){typeof b=="string"&&(b=new _e(b,I||{}));var G=b.type;if(this.listens(G)){b.target=this;for(var re=0,fe=this._listeners&&this._listeners[G]?this._listeners[G].slice():[];re<fe.length;re+=1)fe[re].call(this,b);for(var me=0,Ae=this._oneTimeListeners&&this._oneTimeListeners[G]?this._oneTimeListeners[G].slice():[];me<Ae.length;me+=1){var De=Ae[me];Ke(G,De,this._oneTimeListeners),De.call(this,b)}var Ze=this._eventedParent;Ze&&(g(b,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),Ze.fire(b))}else b instanceof Ce&&console.error(b.error);return this},Le.prototype.listens=function(b){return this._listeners&&this._listeners[b]&&this._listeners[b].length>0||this._oneTimeListeners&&this._oneTimeListeners[b]&&this._oneTimeListeners[b].length>0||this._eventedParent&&this._eventedParent.listens(b)},Le.prototype.setEventedParent=function(b,I){return this._eventedParent=b,this._eventedParentData=I,this};var Pe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Xe=function(b,I,G,re){this.message=(b?b+": ":"")+G,re&&(this.identifier=re),I!=null&&I.__line__&&(this.line=I.__line__)};function ht(b){var I=b.key,G=b.value;return G?[new Xe(I,G,"constants have been deprecated as of v8")]:[]}function Mt(b){for(var I=[],G=arguments.length-1;G-- >0;)I[G]=arguments[G+1];for(var re=0,fe=I;re<fe.length;re+=1){var me=fe[re];for(var Ae in me)b[Ae]=me[Ae]}return b}function pt(b){return b instanceof Number||b instanceof String||b instanceof Boolean?b.valueOf():b}function Lt(b){if(Array.isArray(b))return b.map(Lt);if(b instanceof Object&&!(b instanceof Number||b instanceof String||b instanceof Boolean)){var I={};for(var G in b)I[G]=Lt(b[G]);return I}return pt(b)}var vt=function(b){function I(G,re){b.call(this,re),this.message=re,this.key=G}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I}(Error),Dt=function(b,I){I===void 0&&(I=[]),this.parent=b,this.bindings={};for(var G=0,re=I;G<re.length;G+=1){var fe=re[G],me=fe[0],Ae=fe[1];this.bindings[me]=Ae}};Dt.prototype.concat=function(b){return new Dt(this,b)},Dt.prototype.get=function(b){if(this.bindings[b])return this.bindings[b];if(this.parent)return this.parent.get(b);throw new Error(b+" not found in scope.")},Dt.prototype.has=function(b){return!!this.bindings[b]||!!this.parent&&this.parent.has(b)};var xt={kind:"null"},it={kind:"number"},St={kind:"string"},Nt={kind:"boolean"},Ut={kind:"color"},Qt={kind:"object"},Ie={kind:"value"},lt={kind:"collator"},wt={kind:"formatted"},Ot={kind:"resolvedImage"};function Gt(b,I){return{kind:"array",itemType:b,N:I}}function ir(b){if(b.kind==="array"){var I=ir(b.itemType);return typeof b.N=="number"?"array<"+I+", "+b.N+">":b.itemType.kind==="value"?"array":"array<"+I+">"}return b.kind}var Xt=[xt,it,St,Nt,Ut,wt,Qt,Gt(Ie),Ot];function Kt(b,I){if(I.kind==="error")return null;if(b.kind==="array"){if(I.kind==="array"&&(I.N===0&&I.itemType.kind==="value"||!Kt(b.itemType,I.itemType))&&(typeof b.N!="number"||b.N===I.N))return null}else{if(b.kind===I.kind)return null;if(b.kind==="value"){for(var G=0,re=Xt;G<re.length;G+=1)if(!Kt(re[G],I))return null}}return"Expected "+ir(b)+" but found "+ir(I)+" instead."}function or(b,I){return I.some(function(G){return G.kind===b.kind})}function dr(b,I){return I.some(function(G){return G==="null"?b===null:G==="array"?Array.isArray(b):G==="object"?b&&!Array.isArray(b)&&typeof b=="object":G===typeof b})}var vr=f(function(b,I){var G={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function re(Ze){return(Ze=Math.round(Ze))<0?0:Ze>255?255:Ze}function fe(Ze){return Ze<0?0:Ze>1?1:Ze}function me(Ze){return Ze[Ze.length-1]==="%"?re(parseFloat(Ze)/100*255):re(parseInt(Ze))}function Ae(Ze){return Ze[Ze.length-1]==="%"?fe(parseFloat(Ze)/100):fe(parseFloat(Ze))}function De(Ze,ut,gt){return gt<0?gt+=1:gt>1&&(gt-=1),6*gt<1?Ze+(ut-Ze)*gt*6:2*gt<1?ut:3*gt<2?Ze+(ut-Ze)*(2/3-gt)*6:Ze}try{I.parseCSSColor=function(Ze){var ut,gt=Ze.replace(/ /g,"").toLowerCase();if(gt in G)return G[gt].slice();if(gt[0]==="#")return gt.length===4?(ut=parseInt(gt.substr(1),16))>=0&&ut<=4095?[(3840&ut)>>4|(3840&ut)>>8,240&ut|(240&ut)>>4,15&ut|(15&ut)<<4,1]:null:gt.length===7&&(ut=parseInt(gt.substr(1),16))>=0&&ut<=16777215?[(16711680&ut)>>16,(65280&ut)>>8,255&ut,1]:null;var Bt=gt.indexOf("("),Wt=gt.indexOf(")");if(Bt!==-1&&Wt+1===gt.length){var Ht=gt.substr(0,Bt),ar=gt.substr(Bt+1,Wt-(Bt+1)).split(","),gr=1;switch(Ht){case"rgba":if(ar.length!==4)return null;gr=Ae(ar.pop());case"rgb":return ar.length!==3?null:[me(ar[0]),me(ar[1]),me(ar[2]),gr];case"hsla":if(ar.length!==4)return null;gr=Ae(ar.pop());case"hsl":if(ar.length!==3)return null;var Cr=(parseFloat(ar[0])%360+360)%360/360,Er=Ae(ar[1]),Fr=Ae(ar[2]),Br=Fr<=.5?Fr*(Er+1):Fr+Er-Fr*Er,Hr=2*Fr-Br;return[re(255*De(Hr,Br,Cr+1/3)),re(255*De(Hr,Br,Cr)),re(255*De(Hr,Br,Cr-1/3)),gr];default:return null}}return null}}catch(Ze){}}).parseCSSColor,ur=function(b,I,G,re){re===void 0&&(re=1),this.r=b,this.g=I,this.b=G,this.a=re};ur.parse=function(b){if(b){if(b instanceof ur)return b;if(typeof b=="string"){var I=vr(b);if(I)return new ur(I[0]/255*I[3],I[1]/255*I[3],I[2]/255*I[3],I[3])}}},ur.prototype.toString=function(){var b=this.toArray(),I=b[0],G=b[1],re=b[2],fe=b[3];return"rgba("+Math.round(I)+","+Math.round(G)+","+Math.round(re)+","+fe+")"},ur.prototype.toArray=function(){var b=this.r,I=this.g,G=this.b,re=this.a;return re===0?[0,0,0,0]:[255*b/re,255*I/re,255*G/re,re]},ur.black=new ur(0,0,0,1),ur.white=new ur(1,1,1,1),ur.transparent=new ur(0,0,0,0),ur.red=new ur(1,0,0,1);var pr=function(b,I,G){this.sensitivity=b?I?"variant":"case":I?"accent":"base",this.locale=G,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};pr.prototype.compare=function(b,I){return this.collator.compare(b,I)},pr.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var br=function(b,I,G,re,fe){this.text=b,this.image=I,this.scale=G,this.fontStack=re,this.textColor=fe},Rr=function(b){this.sections=b};Rr.fromString=function(b){return new Rr([new br(b,null,null,null,null)])},Rr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(b){return b.text.length!==0||b.image&&b.image.name.length!==0})},Rr.factory=function(b){return b instanceof Rr?b:Rr.fromString(b)},Rr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(b){return b.text}).join("")},Rr.prototype.serialize=function(){for(var b=["format"],I=0,G=this.sections;I<G.length;I+=1){var re=G[I];if(re.image)b.push(["image",re.image.name]);else{b.push(re.text);var fe={};re.fontStack&&(fe["text-font"]=["literal",re.fontStack.split(",")]),re.scale&&(fe["font-scale"]=re.scale),re.textColor&&(fe["text-color"]=["rgba"].concat(re.textColor.toArray())),b.push(fe)}}return b};var _r=function(b){this.name=b.name,this.available=b.available};function jr(b,I,G,re){return typeof b=="number"&&b>=0&&b<=255&&typeof I=="number"&&I>=0&&I<=255&&typeof G=="number"&&G>=0&&G<=255?re===void 0||typeof re=="number"&&re>=0&&re<=1?null:"Invalid rgba value ["+[b,I,G,re].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof re=="number"?[b,I,G,re]:[b,I,G]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function $r(b){if(b===null||typeof b=="string"||typeof b=="boolean"||typeof b=="number"||b instanceof ur||b instanceof pr||b instanceof Rr||b instanceof _r)return!0;if(Array.isArray(b)){for(var I=0,G=b;I<G.length;I+=1)if(!$r(G[I]))return!1;return!0}if(typeof b=="object"){for(var re in b)if(!$r(b[re]))return!1;return!0}return!1}function pn(b){if(b===null)return xt;if(typeof b=="string")return St;if(typeof b=="boolean")return Nt;if(typeof b=="number")return it;if(b instanceof ur)return Ut;if(b instanceof pr)return lt;if(b instanceof Rr)return wt;if(b instanceof _r)return Ot;if(Array.isArray(b)){for(var I,G=b.length,re=0,fe=b;re<fe.length;re+=1){var me=pn(fe[re]);if(I){if(I===me)continue;I=Ie;break}I=me}return Gt(I||Ie,G)}return Qt}function In(b){var I=typeof b;return b===null?"":I==="string"||I==="number"||I==="boolean"?String(b):b instanceof ur||b instanceof Rr||b instanceof _r?b.toString():JSON.stringify(b)}_r.prototype.toString=function(){return this.name},_r.fromString=function(b){return b?new _r({name:b,available:!1}):null},_r.prototype.serialize=function(){return["image",this.name]};var On=function(b,I){this.type=b,this.value=I};On.parse=function(b,I){if(b.length!==2)return I.error("'literal' expression requires exactly one argument, but found "+(b.length-1)+" instead.");if(!$r(b[1]))return I.error("invalid value");var G=b[1],re=pn(G),fe=I.expectedType;return re.kind!=="array"||re.N!==0||!fe||fe.kind!=="array"||typeof fe.N=="number"&&fe.N!==0||(re=fe),new On(re,G)},On.prototype.evaluate=function(){return this.value},On.prototype.eachChild=function(){},On.prototype.outputDefined=function(){return!0},On.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ur?["rgba"].concat(this.value.toArray()):this.value instanceof Rr?this.value.serialize():this.value};var Sn=function(b){this.name="ExpressionEvaluationError",this.message=b};Sn.prototype.toJSON=function(){return this.message};var an={string:St,number:it,boolean:Nt,object:Qt},Nr=function(b,I){this.type=b,this.args=I};Nr.parse=function(b,I){if(b.length<2)return I.error("Expected at least one argument.");var G,re=1,fe=b[0];if(fe==="array"){var me,Ae;if(b.length>2){var De=b[1];if(typeof De!="string"||!(De in an)||De==="object")return I.error('The item type argument of "array" must be one of string, number, boolean',1);me=an[De],re++}else me=Ie;if(b.length>3){if(b[2]!==null&&(typeof b[2]!="number"||b[2]<0||b[2]!==Math.floor(b[2])))return I.error('The length argument to "array" must be a positive integer literal',2);Ae=b[2],re++}G=Gt(me,Ae)}else G=an[fe];for(var Ze=[];re<b.length;re++){var ut=I.parse(b[re],re,Ie);if(!ut)return null;Ze.push(ut)}return new Nr(G,Ze)},Nr.prototype.evaluate=function(b){for(var I=0;I<this.args.length;I++){var G=this.args[I].evaluate(b);if(!Kt(this.type,pn(G)))return G;if(I===this.args.length-1)throw new Sn("Expected value to be of type "+ir(this.type)+", but found "+ir(pn(G))+" instead.")}return null},Nr.prototype.eachChild=function(b){this.args.forEach(b)},Nr.prototype.outputDefined=function(){return this.args.every(function(b){return b.outputDefined()})},Nr.prototype.serialize=function(){var b=this.type,I=[b.kind];if(b.kind==="array"){var G=b.itemType;if(G.kind==="string"||G.kind==="number"||G.kind==="boolean"){I.push(G.kind);var re=b.N;(typeof re=="number"||this.args.length>1)&&I.push(re)}}return I.concat(this.args.map(function(fe){return fe.serialize()}))};var Pr=function(b){this.type=wt,this.sections=b};Pr.parse=function(b,I){if(b.length<2)return I.error("Expected at least one argument.");var G=b[1];if(!Array.isArray(G)&&typeof G=="object")return I.error("First argument must be an image or text section.");for(var re=[],fe=!1,me=1;me<=b.length-1;++me){var Ae=b[me];if(fe&&typeof Ae=="object"&&!Array.isArray(Ae)){fe=!1;var De=null;if(Ae["font-scale"]&&!(De=I.parse(Ae["font-scale"],1,it)))return null;var Ze=null;if(Ae["text-font"]&&!(Ze=I.parse(Ae["text-font"],1,Gt(St))))return null;var ut=null;if(Ae["text-color"]&&!(ut=I.parse(Ae["text-color"],1,Ut)))return null;var gt=re[re.length-1];gt.scale=De,gt.font=Ze,gt.textColor=ut}else{var Bt=I.parse(b[me],1,Ie);if(!Bt)return null;var Wt=Bt.type.kind;if(Wt!=="string"&&Wt!=="value"&&Wt!=="null"&&Wt!=="resolvedImage")return I.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");fe=!0,re.push({content:Bt,scale:null,font:null,textColor:null})}}return new Pr(re)},Pr.prototype.evaluate=function(b){return new Rr(this.sections.map(function(I){var G=I.content.evaluate(b);return pn(G)===Ot?new br("",G,null,null,null):new br(In(G),null,I.scale?I.scale.evaluate(b):null,I.font?I.font.evaluate(b).join(","):null,I.textColor?I.textColor.evaluate(b):null)}))},Pr.prototype.eachChild=function(b){for(var I=0,G=this.sections;I<G.length;I+=1){var re=G[I];b(re.content),re.scale&&b(re.scale),re.font&&b(re.font),re.textColor&&b(re.textColor)}},Pr.prototype.outputDefined=function(){return!1},Pr.prototype.serialize=function(){for(var b=["format"],I=0,G=this.sections;I<G.length;I+=1){var re=G[I];b.push(re.content.serialize());var fe={};re.scale&&(fe["font-scale"]=re.scale.serialize()),re.font&&(fe["text-font"]=re.font.serialize()),re.textColor&&(fe["text-color"]=re.textColor.serialize()),b.push(fe)}return b};var en=function(b){this.type=Ot,this.input=b};en.parse=function(b,I){if(b.length!==2)return I.error("Expected two arguments.");var G=I.parse(b[1],1,St);return G?new en(G):I.error("No image name provided.")},en.prototype.evaluate=function(b){var I=this.input.evaluate(b),G=_r.fromString(I);return G&&b.availableImages&&(G.available=b.availableImages.indexOf(I)>-1),G},en.prototype.eachChild=function(b){b(this.input)},en.prototype.outputDefined=function(){return!1},en.prototype.serialize=function(){return["image",this.input.serialize()]};var tn={"to-boolean":Nt,"to-color":Ut,"to-number":it,"to-string":St},Qr=function(b,I){this.type=b,this.args=I};Qr.parse=function(b,I){if(b.length<2)return I.error("Expected at least one argument.");var G=b[0];if((G==="to-boolean"||G==="to-string")&&b.length!==2)return I.error("Expected one argument.");for(var re=tn[G],fe=[],me=1;me<b.length;me++){var Ae=I.parse(b[me],me,Ie);if(!Ae)return null;fe.push(Ae)}return new Qr(re,fe)},Qr.prototype.evaluate=function(b){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(b));if(this.type.kind==="color"){for(var I,G,re=0,fe=this.args;re<fe.length;re+=1){if(G=null,(I=fe[re].evaluate(b))instanceof ur)return I;if(typeof I=="string"){var me=b.parseColor(I);if(me)return me}else if(Array.isArray(I)&&!(G=I.length<3||I.length>4?"Invalid rbga value "+JSON.stringify(I)+": expected an array containing either three or four numeric values.":jr(I[0],I[1],I[2],I[3])))return new ur(I[0]/255,I[1]/255,I[2]/255,I[3])}throw new Sn(G||"Could not parse color from value '"+(typeof I=="string"?I:String(JSON.stringify(I)))+"'")}if(this.type.kind==="number"){for(var Ae=null,De=0,Ze=this.args;De<Ze.length;De+=1){if((Ae=Ze[De].evaluate(b))===null)return 0;var ut=Number(Ae);if(!isNaN(ut))return ut}throw new Sn("Could not convert "+JSON.stringify(Ae)+" to number.")}return this.type.kind==="formatted"?Rr.fromString(In(this.args[0].evaluate(b))):this.type.kind==="resolvedImage"?_r.fromString(In(this.args[0].evaluate(b))):In(this.args[0].evaluate(b))},Qr.prototype.eachChild=function(b){this.args.forEach(b)},Qr.prototype.outputDefined=function(){return this.args.every(function(b){return b.outputDefined()})},Qr.prototype.serialize=function(){if(this.type.kind==="formatted")return new Pr([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new en(this.args[0]).serialize();var b=["to-"+this.type.kind];return this.eachChild(function(I){b.push(I.serialize())}),b};var rn=["Unknown","Point","LineString","Polygon"],An=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};An.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},An.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?rn[this.feature.type]:this.feature.type:null},An.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},An.prototype.canonicalID=function(){return this.canonical},An.prototype.properties=function(){return this.feature&&this.feature.properties||{}},An.prototype.parseColor=function(b){var I=this._parseColorCache[b];return I||(I=this._parseColorCache[b]=ur.parse(b)),I};var En=function(b,I,G,re){this.name=b,this.type=I,this._evaluate=G,this.args=re};En.prototype.evaluate=function(b){return this._evaluate(b,this.args)},En.prototype.eachChild=function(b){this.args.forEach(b)},En.prototype.outputDefined=function(){return!1},En.prototype.serialize=function(){return[this.name].concat(this.args.map(function(b){return b.serialize()}))},En.parse=function(b,I){var G,re=b[0],fe=En.definitions[re];if(!fe)return I.error('Unknown expression "'+re+'". If you wanted a literal array, use ["literal", [...]].',0);for(var me=Array.isArray(fe)?fe[0]:fe.type,Ae=Array.isArray(fe)?[[fe[1],fe[2]]]:fe.overloads,De=Ae.filter(function(ia){var Zn=ia[0];return!Array.isArray(Zn)||Zn.length===b.length-1}),Ze=null,ut=0,gt=De;ut<gt.length;ut+=1){var Bt=gt[ut],Wt=Bt[0],Ht=Bt[1];Ze=new dn(I.registry,I.path,null,I.scope);for(var ar=[],gr=!1,Cr=1;Cr<b.length;Cr++){var Er=b[Cr],Fr=Array.isArray(Wt)?Wt[Cr-1]:Wt.type,Br=Ze.parse(Er,1+ar.length,Fr);if(!Br){gr=!0;break}ar.push(Br)}if(!gr)if(Array.isArray(Wt)&&Wt.length!==ar.length)Ze.error("Expected "+Wt.length+" arguments, but found "+ar.length+" instead.");else{for(var Hr=0;Hr<ar.length;Hr++){var fn=Array.isArray(Wt)?Wt[Hr]:Wt.type,xn=ar[Hr];Ze.concat(Hr+1).checkSubtype(fn,xn.type)}if(Ze.errors.length===0)return new En(re,me,Ht,ar)}}if(De.length===1)(G=I.errors).push.apply(G,Ze.errors);else{for(var Nn=(De.length?De:Ae).map(function(ia){var Zn,ha=ia[0];return Zn=ha,Array.isArray(Zn)?"("+Zn.map(ir).join(", ")+")":"("+ir(Zn.type)+"...)"}).join(" | "),Fn=[],qn=1;qn<b.length;qn++){var na=I.parse(b[qn],1+Fn.length);if(!na)return null;Fn.push(ir(na.type))}I.error("Expected arguments of type "+Nn+", but found ("+Fn.join(", ")+") instead.")}return null},En.register=function(b,I){for(var G in En.definitions=I,I)b[G]=En};var Bn=function(b,I,G){this.type=lt,this.locale=G,this.caseSensitive=b,this.diacriticSensitive=I};Bn.parse=function(b,I){if(b.length!==2)return I.error("Expected one argument.");var G=b[1];if(typeof G!="object"||Array.isArray(G))return I.error("Collator options argument must be an object.");var re=I.parse(G["case-sensitive"]!==void 0&&G["case-sensitive"],1,Nt);if(!re)return null;var fe=I.parse(G["diacritic-sensitive"]!==void 0&&G["diacritic-sensitive"],1,Nt);if(!fe)return null;var me=null;return G.locale&&!(me=I.parse(G.locale,1,St))?null:new Bn(re,fe,me)},Bn.prototype.evaluate=function(b){return new pr(this.caseSensitive.evaluate(b),this.diacriticSensitive.evaluate(b),this.locale?this.locale.evaluate(b):null)},Bn.prototype.eachChild=function(b){b(this.caseSensitive),b(this.diacriticSensitive),this.locale&&b(this.locale)},Bn.prototype.outputDefined=function(){return!1},Bn.prototype.serialize=function(){var b={};return b["case-sensitive"]=this.caseSensitive.serialize(),b["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(b.locale=this.locale.serialize()),["collator",b]};function Jt(b,I){b[0]=Math.min(b[0],I[0]),b[1]=Math.min(b[1],I[1]),b[2]=Math.max(b[2],I[0]),b[3]=Math.max(b[3],I[1])}function It(b,I){return!(b[0]<=I[0])&&!(b[2]>=I[2])&&!(b[1]<=I[1])&&!(b[3]>=I[3])}function qt(b,I){var G,re=(180+b[0])/360,fe=(G=b[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+G*Math.PI/360)))/360),me=Math.pow(2,I.z);return[Math.round(re*me*8192),Math.round(fe*me*8192)]}function fr(b,I,G){return I[1]>b[1]!=G[1]>b[1]&&b[0]<(G[0]-I[0])*(b[1]-I[1])/(G[1]-I[1])+I[0]}function Tr(b,I){for(var G,re,fe,me,Ae,De,Ze,ut=!1,gt=0,Bt=I.length;gt<Bt;gt++)for(var Wt=I[gt],Ht=0,ar=Wt.length;Ht<ar-1;Ht++){if(G=b,re=Wt[Ht],fe=Wt[Ht+1],me=void 0,Ae=void 0,De=void 0,Ze=void 0,me=G[0]-re[0],Ae=G[1]-re[1],De=G[0]-fe[0],Ze=G[1]-fe[1],me*Ze-De*Ae==0&&me*De<=0&&Ae*Ze<=0)return!1;fr(b,Wt[Ht],Wt[Ht+1])&&(ut=!ut)}return ut}function Gr(b,I){for(var G=0;G<I.length;G++)if(Tr(b,I[G]))return!0;return!1}function Vr(b,I,G,re){var fe=b[0]-G[0],me=b[1]-G[1],Ae=I[0]-G[0],De=I[1]-G[1],Ze=re[0]-G[0],ut=re[1]-G[1],gt=fe*ut-Ze*me,Bt=Ae*ut-Ze*De;return gt>0&&Bt<0||gt<0&&Bt>0}function xr(b,I,G){for(var re=0,fe=G;re<fe.length;re+=1)for(var me=fe[re],Ae=0;Ae<me.length-1;++Ae)if(De=b,Ze=I,ut=me[Ae],gt=me[Ae+1],Bt=void 0,Wt=void 0,Ht=void 0,ar=void 0,Ht=[Ze[0]-De[0],Ze[1]-De[1]],ar=[gt[0]-ut[0],gt[1]-ut[1]],(Bt=ar)[0]*(Wt=Ht)[1]-Bt[1]*Wt[0]!=0&&Vr(De,Ze,ut,gt)&&Vr(ut,gt,De,Ze))return!0;var De,Ze,ut,gt,Bt,Wt,Ht,ar;return!1}function wr(b,I){for(var G=0;G<b.length;++G)if(!Tr(b[G],I))return!1;for(var re=0;re<b.length-1;++re)if(xr(b[re],b[re+1],I))return!1;return!0}function Sr(b,I){for(var G=0;G<I.length;G++)if(wr(b,I[G]))return!0;return!1}function Mr(b,I,G){for(var re=[],fe=0;fe<b.length;fe++){for(var me=[],Ae=0;Ae<b[fe].length;Ae++){var De=qt(b[fe][Ae],G);Jt(I,De),me.push(De)}re.push(me)}return re}function Ir(b,I,G){for(var re=[],fe=0;fe<b.length;fe++){var me=Mr(b[fe],I,G);re.push(me)}return re}function qr(b,I,G,re){if(b[0]<G[0]||b[0]>G[2]){var fe=.5*re,me=b[0]-G[0]>fe?-re:G[0]-b[0]>fe?re:0;me===0&&(me=b[0]-G[2]>fe?-re:G[2]-b[0]>fe?re:0),b[0]+=me}Jt(I,b)}function cn(b,I,G,re){for(var fe=8192*Math.pow(2,re.z),me=[8192*re.x,8192*re.y],Ae=[],De=0,Ze=b;De<Ze.length;De+=1)for(var ut=0,gt=Ze[De];ut<gt.length;ut+=1){var Bt=gt[ut],Wt=[Bt.x+me[0],Bt.y+me[1]];qr(Wt,I,G,fe),Ae.push(Wt)}return Ae}function _n(b,I,G,re){for(var fe,me=8192*Math.pow(2,re.z),Ae=[8192*re.x,8192*re.y],De=[],Ze=0,ut=b;Ze<ut.length;Ze+=1){for(var gt=[],Bt=0,Wt=ut[Ze];Bt<Wt.length;Bt+=1){var Ht=Wt[Bt],ar=[Ht.x+Ae[0],Ht.y+Ae[1]];Jt(I,ar),gt.push(ar)}De.push(gt)}if(I[2]-I[0]<=me/2){(fe=I)[0]=fe[1]=1/0,fe[2]=fe[3]=-1/0;for(var gr=0,Cr=De;gr<Cr.length;gr+=1)for(var Er=0,Fr=Cr[gr];Er<Fr.length;Er+=1)qr(Fr[Er],I,G,me)}return De}var Jr=function(b,I){this.type=Nt,this.geojson=b,this.geometries=I};function bn(b){if(b instanceof En&&(b.name==="get"&&b.args.length===1||b.name==="feature-state"||b.name==="has"&&b.args.length===1||b.name==="properties"||b.name==="geometry-type"||b.name==="id"||/^filter-/.test(b.name))||b instanceof Jr)return!1;var I=!0;return b.eachChild(function(G){I&&!bn(G)&&(I=!1)}),I}function Dr(b){if(b instanceof En&&b.name==="feature-state")return!1;var I=!0;return b.eachChild(function(G){I&&!Dr(G)&&(I=!1)}),I}function Wr(b,I){if(b instanceof En&&I.indexOf(b.name)>=0)return!1;var G=!0;return b.eachChild(function(re){G&&!Wr(re,I)&&(G=!1)}),G}Jr.parse=function(b,I){if(b.length!==2)return I.error("'within' expression requires exactly one argument, but found "+(b.length-1)+" instead.");if($r(b[1])){var G=b[1];if(G.type==="FeatureCollection")for(var re=0;re<G.features.length;++re){var fe=G.features[re].geometry.type;if(fe==="Polygon"||fe==="MultiPolygon")return new Jr(G,G.features[re].geometry)}else if(G.type==="Feature"){var me=G.geometry.type;if(me==="Polygon"||me==="MultiPolygon")return new Jr(G,G.geometry)}else if(G.type==="Polygon"||G.type==="MultiPolygon")return new Jr(G,G)}return I.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Jr.prototype.evaluate=function(b){if(b.geometry()!=null&&b.canonicalID()!=null){if(b.geometryType()==="Point")return function(I,G){var re=[1/0,1/0,-1/0,-1/0],fe=[1/0,1/0,-1/0,-1/0],me=I.canonicalID();if(G.type==="Polygon"){var Ae=Mr(G.coordinates,fe,me),De=cn(I.geometry(),re,fe,me);if(!It(re,fe))return!1;for(var Ze=0,ut=De;Ze<ut.length;Ze+=1)if(!Tr(ut[Ze],Ae))return!1}if(G.type==="MultiPolygon"){var gt=Ir(G.coordinates,fe,me),Bt=cn(I.geometry(),re,fe,me);if(!It(re,fe))return!1;for(var Wt=0,Ht=Bt;Wt<Ht.length;Wt+=1)if(!Gr(Ht[Wt],gt))return!1}return!0}(b,this.geometries);if(b.geometryType()==="LineString")return function(I,G){var re=[1/0,1/0,-1/0,-1/0],fe=[1/0,1/0,-1/0,-1/0],me=I.canonicalID();if(G.type==="Polygon"){var Ae=Mr(G.coordinates,fe,me),De=_n(I.geometry(),re,fe,me);if(!It(re,fe))return!1;for(var Ze=0,ut=De;Ze<ut.length;Ze+=1)if(!wr(ut[Ze],Ae))return!1}if(G.type==="MultiPolygon"){var gt=Ir(G.coordinates,fe,me),Bt=_n(I.geometry(),re,fe,me);if(!It(re,fe))return!1;for(var Wt=0,Ht=Bt;Wt<Ht.length;Wt+=1)if(!Sr(Ht[Wt],gt))return!1}return!0}(b,this.geometries)}return!1},Jr.prototype.eachChild=function(){},Jr.prototype.outputDefined=function(){return!0},Jr.prototype.serialize=function(){return["within",this.geojson]};var vn=function(b,I){this.type=I.type,this.name=b,this.boundExpression=I};vn.parse=function(b,I){if(b.length!==2||typeof b[1]!="string")return I.error("'var' expression requires exactly one string literal argument.");var G=b[1];return I.scope.has(G)?new vn(G,I.scope.get(G)):I.error('Unknown variable "'+G+'". Make sure "'+G+'" has been bound in an enclosing "let" expression before using it.',1)},vn.prototype.evaluate=function(b){return this.boundExpression.evaluate(b)},vn.prototype.eachChild=function(){},vn.prototype.outputDefined=function(){return!1},vn.prototype.serialize=function(){return["var",this.name]};var dn=function(b,I,G,re,fe){I===void 0&&(I=[]),re===void 0&&(re=new Dt),fe===void 0&&(fe=[]),this.registry=b,this.path=I,this.key=I.map(function(me){return"["+me+"]"}).join(""),this.scope=re,this.errors=fe,this.expectedType=G};function Pn(b,I){for(var G,re,fe=b.length-1,me=0,Ae=fe,De=0;me<=Ae;)if(G=b[De=Math.floor((me+Ae)/2)],re=b[De+1],G<=I){if(De===fe||I<re)return De;me=De+1}else{if(!(G>I))throw new Sn("Input is not a number.");Ae=De-1}return 0}dn.prototype.parse=function(b,I,G,re,fe){return fe===void 0&&(fe={}),I?this.concat(I,G,re)._parse(b,fe):this._parse(b,fe)},dn.prototype._parse=function(b,I){function G(ut,gt,Bt){return Bt==="assert"?new Nr(gt,[ut]):Bt==="coerce"?new Qr(gt,[ut]):ut}if(b!==null&&typeof b!="string"&&typeof b!="boolean"&&typeof b!="number"||(b=["literal",b]),Array.isArray(b)){if(b.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var re=b[0];if(typeof re!="string")return this.error("Expression name must be a string, but found "+typeof re+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var fe=this.registry[re];if(fe){var me=fe.parse(b,this);if(!me)return null;if(this.expectedType){var Ae=this.expectedType,De=me.type;if(Ae.kind!=="string"&&Ae.kind!=="number"&&Ae.kind!=="boolean"&&Ae.kind!=="object"&&Ae.kind!=="array"||De.kind!=="value")if(Ae.kind!=="color"&&Ae.kind!=="formatted"&&Ae.kind!=="resolvedImage"||De.kind!=="value"&&De.kind!=="string"){if(this.checkSubtype(Ae,De))return null}else me=G(me,Ae,I.typeAnnotation||"coerce");else me=G(me,Ae,I.typeAnnotation||"assert")}if(!(me instanceof On)&&me.type.kind!=="resolvedImage"&&function ut(gt){if(gt instanceof vn)return ut(gt.boundExpression);if(gt instanceof En&&gt.name==="error"||gt instanceof Bn||gt instanceof Jr)return!1;var Bt=gt instanceof Qr||gt instanceof Nr,Wt=!0;return gt.eachChild(function(Ht){Wt=Bt?Wt&&ut(Ht):Wt&&Ht instanceof On}),Wt?bn(gt)&&Wr(gt,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}(me)){var Ze=new An;try{me=new On(me.type,me.evaluate(Ze))}catch(ut){return this.error(ut.message),null}}return me}return this.error('Unknown expression "'+re+'". If you wanted a literal array, use ["literal", [...]].',0)}return b===void 0?this.error("'undefined' value invalid. Use null instead."):typeof b=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof b+" instead.")},dn.prototype.concat=function(b,I,G){var re=typeof b=="number"?this.path.concat(b):this.path,fe=G?this.scope.concat(G):this.scope;return new dn(this.registry,re,I||null,fe,this.errors)},dn.prototype.error=function(b){for(var I=[],G=arguments.length-1;G-- >0;)I[G]=arguments[G+1];var re=""+this.key+I.map(function(fe){return"["+fe+"]"}).join("");this.errors.push(new vt(re,b))},dn.prototype.checkSubtype=function(b,I){var G=Kt(b,I);return G&&this.error(G),G};var sa=function(b,I,G){this.type=b,this.input=I,this.labels=[],this.outputs=[];for(var re=0,fe=G;re<fe.length;re+=1){var me=fe[re],Ae=me[0],De=me[1];this.labels.push(Ae),this.outputs.push(De)}};function Yn(b,I,G){return b*(1-G)+I*G}sa.parse=function(b,I){if(b.length-1<4)return I.error("Expected at least 4 arguments, but found only "+(b.length-1)+".");if((b.length-1)%2!=0)return I.error("Expected an even number of arguments.");var G=I.parse(b[1],1,it);if(!G)return null;var re=[],fe=null;I.expectedType&&I.expectedType.kind!=="value"&&(fe=I.expectedType);for(var me=1;me<b.length;me+=2){var Ae=me===1?-1/0:b[me],De=b[me+1],Ze=me,ut=me+1;if(typeof Ae!="number")return I.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Ze);if(re.length&&re[re.length-1][0]>=Ae)return I.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Ze);var gt=I.parse(De,ut,fe);if(!gt)return null;fe=fe||gt.type,re.push([Ae,gt])}return new sa(fe,G,re)},sa.prototype.evaluate=function(b){var I=this.labels,G=this.outputs;if(I.length===1)return G[0].evaluate(b);var re=this.input.evaluate(b);if(re<=I[0])return G[0].evaluate(b);var fe=I.length;return re>=I[fe-1]?G[fe-1].evaluate(b):G[Pn(I,re)].evaluate(b)},sa.prototype.eachChild=function(b){b(this.input);for(var I=0,G=this.outputs;I<G.length;I+=1)b(G[I])},sa.prototype.outputDefined=function(){return this.outputs.every(function(b){return b.outputDefined()})},sa.prototype.serialize=function(){for(var b=["step",this.input.serialize()],I=0;I<this.labels.length;I++)I>0&&b.push(this.labels[I]),b.push(this.outputs[I].serialize());return b};var yn=Object.freeze({__proto__:null,number:Yn,color:function(b,I,G){return new ur(Yn(b.r,I.r,G),Yn(b.g,I.g,G),Yn(b.b,I.b,G),Yn(b.a,I.a,G))},array:function(b,I,G){return b.map(function(re,fe){return Yn(re,I[fe],G)})}}),ra=6/29,pa=3*ra*ra,Qa=Math.PI/180,Fi=180/Math.PI;function li(b){return b>.008856451679035631?Math.pow(b,1/3):b/pa+4/29}function ki(b){return b>ra?b*b*b:pa*(b-4/29)}function Ea(b){return 255*(b<=.0031308?12.92*b:1.055*Math.pow(b,1/2.4)-.055)}function Ga(b){return(b/=255)<=.04045?b/12.92:Math.pow((b+.055)/1.055,2.4)}function ko(b){var I=Ga(b.r),G=Ga(b.g),re=Ga(b.b),fe=li((.4124564*I+.3575761*G+.1804375*re)/.95047),me=li((.2126729*I+.7151522*G+.072175*re)/1);return{l:116*me-16,a:500*(fe-me),b:200*(me-li((.0193339*I+.119192*G+.9503041*re)/1.08883)),alpha:b.a}}function Qo(b){var I=(b.l+16)/116,G=isNaN(b.a)?I:I+b.a/500,re=isNaN(b.b)?I:I-b.b/200;return I=1*ki(I),G=.95047*ki(G),re=1.08883*ki(re),new ur(Ea(3.2404542*G-1.5371385*I-.4985314*re),Ea(-.969266*G+1.8760108*I+.041556*re),Ea(.0556434*G-.2040259*I+1.0572252*re),b.alpha)}function us(b,I,G){var re=I-b;return b+G*(re>180||re<-180?re-360*Math.round(re/360):re)}var $i={forward:ko,reverse:Qo,interpolate:function(b,I,G){return{l:Yn(b.l,I.l,G),a:Yn(b.a,I.a,G),b:Yn(b.b,I.b,G),alpha:Yn(b.alpha,I.alpha,G)}}},to={forward:function(b){var I=ko(b),G=I.l,re=I.a,fe=I.b,me=Math.atan2(fe,re)*Fi;return{h:me<0?me+360:me,c:Math.sqrt(re*re+fe*fe),l:G,alpha:b.a}},reverse:function(b){var I=b.h*Qa,G=b.c;return Qo({l:b.l,a:Math.cos(I)*G,b:Math.sin(I)*G,alpha:b.alpha})},interpolate:function(b,I,G){return{h:us(b.h,I.h,G),c:Yn(b.c,I.c,G),l:Yn(b.l,I.l,G),alpha:Yn(b.alpha,I.alpha,G)}}},es=Object.freeze({__proto__:null,lab:$i,hcl:to}),Wa=function(b,I,G,re,fe){this.type=b,this.operator=I,this.interpolation=G,this.input=re,this.labels=[],this.outputs=[];for(var me=0,Ae=fe;me<Ae.length;me+=1){var De=Ae[me],Ze=De[0],ut=De[1];this.labels.push(Ze),this.outputs.push(ut)}};function jo(b,I,G,re){var fe=re-G,me=b-G;return fe===0?0:I===1?me/fe:(Math.pow(I,me)-1)/(Math.pow(I,fe)-1)}Wa.interpolationFactor=function(b,I,G,re){var fe=0;if(b.name==="exponential")fe=jo(I,b.base,G,re);else if(b.name==="linear")fe=jo(I,1,G,re);else if(b.name==="cubic-bezier"){var me=b.controlPoints;fe=new u(me[0],me[1],me[2],me[3]).solve(jo(I,1,G,re))}return fe},Wa.parse=function(b,I){var G=b[0],re=b[1],fe=b[2],me=b.slice(3);if(!Array.isArray(re)||re.length===0)return I.error("Expected an interpolation type expression.",1);if(re[0]==="linear")re={name:"linear"};else if(re[0]==="exponential"){var Ae=re[1];if(typeof Ae!="number")return I.error("Exponential interpolation requires a numeric base.",1,1);re={name:"exponential",base:Ae}}else{if(re[0]!=="cubic-bezier")return I.error("Unknown interpolation type "+String(re[0]),1,0);var De=re.slice(1);if(De.length!==4||De.some(function(Cr){return typeof Cr!="number"||Cr<0||Cr>1}))return I.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);re={name:"cubic-bezier",controlPoints:De}}if(b.length-1<4)return I.error("Expected at least 4 arguments, but found only "+(b.length-1)+".");if((b.length-1)%2!=0)return I.error("Expected an even number of arguments.");if(!(fe=I.parse(fe,2,it)))return null;var Ze=[],ut=null;G==="interpolate-hcl"||G==="interpolate-lab"?ut=Ut:I.expectedType&&I.expectedType.kind!=="value"&&(ut=I.expectedType);for(var gt=0;gt<me.length;gt+=2){var Bt=me[gt],Wt=me[gt+1],Ht=gt+3,ar=gt+4;if(typeof Bt!="number")return I.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Ht);if(Ze.length&&Ze[Ze.length-1][0]>=Bt)return I.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Ht);var gr=I.parse(Wt,ar,ut);if(!gr)return null;ut=ut||gr.type,Ze.push([Bt,gr])}return ut.kind==="number"||ut.kind==="color"||ut.kind==="array"&&ut.itemType.kind==="number"&&typeof ut.N=="number"?new Wa(ut,G,re,fe,Ze):I.error("Type "+ir(ut)+" is not interpolatable.")},Wa.prototype.evaluate=function(b){var I=this.labels,G=this.outputs;if(I.length===1)return G[0].evaluate(b);var re=this.input.evaluate(b);if(re<=I[0])return G[0].evaluate(b);var fe=I.length;if(re>=I[fe-1])return G[fe-1].evaluate(b);var me=Pn(I,re),Ae=I[me],De=I[me+1],Ze=Wa.interpolationFactor(this.interpolation,re,Ae,De),ut=G[me].evaluate(b),gt=G[me+1].evaluate(b);return this.operator==="interpolate"?yn[this.type.kind.toLowerCase()](ut,gt,Ze):this.operator==="interpolate-hcl"?to.reverse(to.interpolate(to.forward(ut),to.forward(gt),Ze)):$i.reverse($i.interpolate($i.forward(ut),$i.forward(gt),Ze))},Wa.prototype.eachChild=function(b){b(this.input);for(var I=0,G=this.outputs;I<G.length;I+=1)b(G[I])},Wa.prototype.outputDefined=function(){return this.outputs.every(function(b){return b.outputDefined()})},Wa.prototype.serialize=function(){var b;b=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var I=[this.operator,b,this.input.serialize()],G=0;G<this.labels.length;G++)I.push(this.labels[G],this.outputs[G].serialize());return I};var Ao=function(b,I){this.type=b,this.args=I};Ao.parse=function(b,I){if(b.length<2)return I.error("Expectected at least one argument.");var G=null,re=I.expectedType;re&&re.kind!=="value"&&(G=re);for(var fe=[],me=0,Ae=b.slice(1);me<Ae.length;me+=1){var De=Ae[me],Ze=I.parse(De,1+fe.length,G,void 0,{typeAnnotation:"omit"});if(!Ze)return null;G=G||Ze.type,fe.push(Ze)}var ut=re&&fe.some(function(gt){return Kt(re,gt.type)});return new Ao(ut?Ie:G,fe)},Ao.prototype.evaluate=function(b){for(var I,G=null,re=0,fe=0,me=this.args;fe<me.length&&(re++,(G=me[fe].evaluate(b))&&G instanceof _r&&!G.available&&(I||(I=G.name),G=null,re===this.args.length&&(G=I)),G===null);fe+=1);return G},Ao.prototype.eachChild=function(b){this.args.forEach(b)},Ao.prototype.outputDefined=function(){return this.args.every(function(b){return b.outputDefined()})},Ao.prototype.serialize=function(){var b=["coalesce"];return this.eachChild(function(I){b.push(I.serialize())}),b};var Ai=function(b,I){this.type=I.type,this.bindings=[].concat(b),this.result=I};Ai.prototype.evaluate=function(b){return this.result.evaluate(b)},Ai.prototype.eachChild=function(b){for(var I=0,G=this.bindings;I<G.length;I+=1)b(G[I][1]);b(this.result)},Ai.parse=function(b,I){if(b.length<4)return I.error("Expected at least 3 arguments, but found "+(b.length-1)+" instead.");for(var G=[],re=1;re<b.length-1;re+=2){var fe=b[re];if(typeof fe!="string")return I.error("Expected string, but found "+typeof fe+" instead.",re);if(/[^a-zA-Z0-9_]/.test(fe))return I.error("Variable names must contain only alphanumeric characters or '_'.",re);var me=I.parse(b[re+1],re+1);if(!me)return null;G.push([fe,me])}var Ae=I.parse(b[b.length-1],b.length-1,I.expectedType,G);return Ae?new Ai(G,Ae):null},Ai.prototype.outputDefined=function(){return this.result.outputDefined()},Ai.prototype.serialize=function(){for(var b=["let"],I=0,G=this.bindings;I<G.length;I+=1){var re=G[I],fe=re[0],me=re[1];b.push(fe,me.serialize())}return b.push(this.result.serialize()),b};var ro=function(b,I,G){this.type=b,this.index=I,this.input=G};ro.parse=function(b,I){if(b.length!==3)return I.error("Expected 2 arguments, but found "+(b.length-1)+" instead.");var G=I.parse(b[1],1,it),re=I.parse(b[2],2,Gt(I.expectedType||Ie));if(!G||!re)return null;var fe=re.type;return new ro(fe.itemType,G,re)},ro.prototype.evaluate=function(b){var I=this.index.evaluate(b),G=this.input.evaluate(b);if(I<0)throw new Sn("Array index out of bounds: "+I+" < 0.");if(I>=G.length)throw new Sn("Array index out of bounds: "+I+" > "+(G.length-1)+".");if(I!==Math.floor(I))throw new Sn("Array index must be an integer, but found "+I+" instead.");return G[I]},ro.prototype.eachChild=function(b){b(this.index),b(this.input)},ro.prototype.outputDefined=function(){return!1},ro.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Mo=function(b,I){this.type=Nt,this.needle=b,this.haystack=I};Mo.parse=function(b,I){if(b.length!==3)return I.error("Expected 2 arguments, but found "+(b.length-1)+" instead.");var G=I.parse(b[1],1,Ie),re=I.parse(b[2],2,Ie);return G&&re?or(G.type,[Nt,St,it,xt,Ie])?new Mo(G,re):I.error("Expected first argument to be of type boolean, string, number or null, but found "+ir(G.type)+" instead"):null},Mo.prototype.evaluate=function(b){var I=this.needle.evaluate(b),G=this.haystack.evaluate(b);if(!G)return!1;if(!dr(I,["boolean","string","number","null"]))throw new Sn("Expected first argument to be of type boolean, string, number or null, but found "+ir(pn(I))+" instead.");if(!dr(G,["string","array"]))throw new Sn("Expected second argument to be of type array or string, but found "+ir(pn(G))+" instead.");return G.indexOf(I)>=0},Mo.prototype.eachChild=function(b){b(this.needle),b(this.haystack)},Mo.prototype.outputDefined=function(){return!0},Mo.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var zo=function(b,I,G){this.type=it,this.needle=b,this.haystack=I,this.fromIndex=G};zo.parse=function(b,I){if(b.length<=2||b.length>=5)return I.error("Expected 3 or 4 arguments, but found "+(b.length-1)+" instead.");var G=I.parse(b[1],1,Ie),re=I.parse(b[2],2,Ie);if(!G||!re)return null;if(!or(G.type,[Nt,St,it,xt,Ie]))return I.error("Expected first argument to be of type boolean, string, number or null, but found "+ir(G.type)+" instead");if(b.length===4){var fe=I.parse(b[3],3,it);return fe?new zo(G,re,fe):null}return new zo(G,re)},zo.prototype.evaluate=function(b){var I=this.needle.evaluate(b),G=this.haystack.evaluate(b);if(!dr(I,["boolean","string","number","null"]))throw new Sn("Expected first argument to be of type boolean, string, number or null, but found "+ir(pn(I))+" instead.");if(!dr(G,["string","array"]))throw new Sn("Expected second argument to be of type array or string, but found "+ir(pn(G))+" instead.");if(this.fromIndex){var re=this.fromIndex.evaluate(b);return G.indexOf(I,re)}return G.indexOf(I)},zo.prototype.eachChild=function(b){b(this.needle),b(this.haystack),this.fromIndex&&b(this.fromIndex)},zo.prototype.outputDefined=function(){return!1},zo.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var b=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),b]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Ui=function(b,I,G,re,fe,me){this.inputType=b,this.type=I,this.input=G,this.cases=re,this.outputs=fe,this.otherwise=me};Ui.parse=function(b,I){if(b.length<5)return I.error("Expected at least 4 arguments, but found only "+(b.length-1)+".");if(b.length%2!=1)return I.error("Expected an even number of arguments.");var G,re;I.expectedType&&I.expectedType.kind!=="value"&&(re=I.expectedType);for(var fe={},me=[],Ae=2;Ae<b.length-1;Ae+=2){var De=b[Ae],Ze=b[Ae+1];Array.isArray(De)||(De=[De]);var ut=I.concat(Ae);if(De.length===0)return ut.error("Expected at least one branch label.");for(var gt=0,Bt=De;gt<Bt.length;gt+=1){var Wt=Bt[gt];if(typeof Wt!="number"&&typeof Wt!="string")return ut.error("Branch labels must be numbers or strings.");if(typeof Wt=="number"&&Math.abs(Wt)>Number.MAX_SAFE_INTEGER)return ut.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Wt=="number"&&Math.floor(Wt)!==Wt)return ut.error("Numeric branch labels must be integer values.");if(G){if(ut.checkSubtype(G,pn(Wt)))return null}else G=pn(Wt);if(fe[String(Wt)]!==void 0)return ut.error("Branch labels must be unique.");fe[String(Wt)]=me.length}var Ht=I.parse(Ze,Ae,re);if(!Ht)return null;re=re||Ht.type,me.push(Ht)}var ar=I.parse(b[1],1,Ie);if(!ar)return null;var gr=I.parse(b[b.length-1],b.length-1,re);return gr?ar.type.kind!=="value"&&I.concat(1).checkSubtype(G,ar.type)?null:new Ui(G,re,ar,fe,me,gr):null},Ui.prototype.evaluate=function(b){var I=this.input.evaluate(b);return(pn(I)===this.inputType&&this.outputs[this.cases[I]]||this.otherwise).evaluate(b)},Ui.prototype.eachChild=function(b){b(this.input),this.outputs.forEach(b),b(this.otherwise)},Ui.prototype.outputDefined=function(){return this.outputs.every(function(b){return b.outputDefined()})&&this.otherwise.outputDefined()},Ui.prototype.serialize=function(){for(var b=this,I=["match",this.input.serialize()],G=[],re={},fe=0,me=Object.keys(this.cases).sort();fe<me.length;fe+=1){var Ae=me[fe];(Bt=re[this.cases[Ae]])===void 0?(re[this.cases[Ae]]=G.length,G.push([this.cases[Ae],[Ae]])):G[Bt][1].push(Ae)}for(var De=function(Ht){return b.inputType.kind==="number"?Number(Ht):Ht},Ze=0,ut=G;Ze<ut.length;Ze+=1){var gt=ut[Ze],Bt=gt[0],Wt=gt[1];Wt.length===1?I.push(De(Wt[0])):I.push(Wt.map(De)),I.push(this.outputs[outputIndex$1].serialize())}return I.push(this.otherwise.serialize()),I};var vi=function(b,I,G){this.type=b,this.branches=I,this.otherwise=G};vi.parse=function(b,I){if(b.length<4)return I.error("Expected at least 3 arguments, but found only "+(b.length-1)+".");if(b.length%2!=0)return I.error("Expected an odd number of arguments.");var G;I.expectedType&&I.expectedType.kind!=="value"&&(G=I.expectedType);for(var re=[],fe=1;fe<b.length-1;fe+=2){var me=I.parse(b[fe],fe,Nt);if(!me)return null;var Ae=I.parse(b[fe+1],fe+1,G);if(!Ae)return null;re.push([me,Ae]),G=G||Ae.type}var De=I.parse(b[b.length-1],b.length-1,G);return De?new vi(G,re,De):null},vi.prototype.evaluate=function(b){for(var I=0,G=this.branches;I<G.length;I+=1){var re=G[I],fe=re[0],me=re[1];if(fe.evaluate(b))return me.evaluate(b)}return this.otherwise.evaluate(b)},vi.prototype.eachChild=function(b){for(var I=0,G=this.branches;I<G.length;I+=1){var re=G[I],fe=re[0],me=re[1];b(fe),b(me)}b(this.otherwise)},vi.prototype.outputDefined=function(){return this.branches.every(function(b){return b[0],b[1].outputDefined()})&&this.otherwise.outputDefined()},vi.prototype.serialize=function(){var b=["case"];return this.eachChild(function(I){b.push(I.serialize())}),b};var Qi=function(b,I,G,re){this.type=b,this.input=I,this.beginIndex=G,this.endIndex=re};function Vs(b,I){return b==="=="||b==="!="?I.kind==="boolean"||I.kind==="string"||I.kind==="number"||I.kind==="null"||I.kind==="value":I.kind==="string"||I.kind==="number"||I.kind==="value"}function Xs(b,I,G,re){return re.compare(I,G)===0}function Xa(b,I,G){var re=b!=="=="&&b!=="!=";return function(){function fe(me,Ae,De){this.type=Nt,this.lhs=me,this.rhs=Ae,this.collator=De,this.hasUntypedArgument=me.type.kind==="value"||Ae.type.kind==="value"}return fe.parse=function(me,Ae){if(me.length!==3&&me.length!==4)return Ae.error("Expected two or three arguments.");var De=me[0],Ze=Ae.parse(me[1],1,Ie);if(!Ze)return null;if(!Vs(De,Ze.type))return Ae.concat(1).error('"'+De+`" comparisons are not supported for type '`+ir(Ze.type)+"'.");var ut=Ae.parse(me[2],2,Ie);if(!ut)return null;if(!Vs(De,ut.type))return Ae.concat(2).error('"'+De+`" comparisons are not supported for type '`+ir(ut.type)+"'.");if(Ze.type.kind!==ut.type.kind&&Ze.type.kind!=="value"&&ut.type.kind!=="value")return Ae.error("Cannot compare types '"+ir(Ze.type)+"' and '"+ir(ut.type)+"'.");re&&(Ze.type.kind==="value"&&ut.type.kind!=="value"?Ze=new Nr(ut.type,[Ze]):Ze.type.kind!=="value"&&ut.type.kind==="value"&&(ut=new Nr(Ze.type,[ut])));var gt=null;if(me.length===4){if(Ze.type.kind!=="string"&&ut.type.kind!=="string"&&Ze.type.kind!=="value"&&ut.type.kind!=="value")return Ae.error("Cannot use collator to compare non-string types.");if(!(gt=Ae.parse(me[3],3,lt)))return null}return new fe(Ze,ut,gt)},fe.prototype.evaluate=function(me){var Ae=this.lhs.evaluate(me),De=this.rhs.evaluate(me);if(re&&this.hasUntypedArgument){var Ze=pn(Ae),ut=pn(De);if(Ze.kind!==ut.kind||Ze.kind!=="string"&&Ze.kind!=="number")throw new Sn('Expected arguments for "'+b+'" to be (string, string) or (number, number), but found ('+Ze.kind+", "+ut.kind+") instead.")}if(this.collator&&!re&&this.hasUntypedArgument){var gt=pn(Ae),Bt=pn(De);if(gt.kind!=="string"||Bt.kind!=="string")return I(me,Ae,De)}return this.collator?G(me,Ae,De,this.collator.evaluate(me)):I(me,Ae,De)},fe.prototype.eachChild=function(me){me(this.lhs),me(this.rhs),this.collator&&me(this.collator)},fe.prototype.outputDefined=function(){return!0},fe.prototype.serialize=function(){var me=[b];return this.eachChild(function(Ae){me.push(Ae.serialize())}),me},fe}()}Qi.parse=function(b,I){if(b.length<=2||b.length>=5)return I.error("Expected 3 or 4 arguments, but found "+(b.length-1)+" instead.");var G=I.parse(b[1],1,Ie),re=I.parse(b[2],2,it);if(!G||!re)return null;if(!or(G.type,[Gt(Ie),St,Ie]))return I.error("Expected first argument to be of type array or string, but found "+ir(G.type)+" instead");if(b.length===4){var fe=I.parse(b[3],3,it);return fe?new Qi(G.type,G,re,fe):null}return new Qi(G.type,G,re)},Qi.prototype.evaluate=function(b){var I=this.input.evaluate(b),G=this.beginIndex.evaluate(b);if(!dr(I,["string","array"]))throw new Sn("Expected first argument to be of type array or string, but found "+ir(pn(I))+" instead.");if(this.endIndex){var re=this.endIndex.evaluate(b);return I.slice(G,re)}return I.slice(G)},Qi.prototype.eachChild=function(b){b(this.input),b(this.beginIndex),this.endIndex&&b(this.endIndex)},Qi.prototype.outputDefined=function(){return!1},Qi.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var b=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),b]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Os=Xa("==",function(b,I,G){return I===G},Xs),ms=Xa("!=",function(b,I,G){return I!==G},function(b,I,G,re){return!Xs(0,I,G,re)}),Zs=Xa("<",function(b,I,G){return I<G},function(b,I,G,re){return re.compare(I,G)<0}),Ks=Xa(">",function(b,I,G){return I>G},function(b,I,G,re){return re.compare(I,G)>0}),Hs=Xa("<=",function(b,I,G){return I<=G},function(b,I,G,re){return re.compare(I,G)<=0}),Js=Xa(">=",function(b,I,G){return I>=G},function(b,I,G,re){return re.compare(I,G)>=0}),Uo=function(b,I,G,re,fe){this.type=St,this.number=b,this.locale=I,this.currency=G,this.minFractionDigits=re,this.maxFractionDigits=fe};Uo.parse=function(b,I){if(b.length!==3)return I.error("Expected two arguments.");var G=I.parse(b[1],1,it);if(!G)return null;var re=b[2];if(typeof re!="object"||Array.isArray(re))return I.error("NumberFormat options argument must be an object.");var fe=null;if(re.locale&&!(fe=I.parse(re.locale,1,St)))return null;var me=null;if(re.currency&&!(me=I.parse(re.currency,1,St)))return null;var Ae=null;if(re["min-fraction-digits"]&&!(Ae=I.parse(re["min-fraction-digits"],1,it)))return null;var De=null;return re["max-fraction-digits"]&&!(De=I.parse(re["max-fraction-digits"],1,it))?null:new Uo(G,fe,me,Ae,De)},Uo.prototype.evaluate=function(b){return new Intl.NumberFormat(this.locale?this.locale.evaluate(b):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(b):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(b):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(b):void 0}).format(this.number.evaluate(b))},Uo.prototype.eachChild=function(b){b(this.number),this.locale&&b(this.locale),this.currency&&b(this.currency),this.minFractionDigits&&b(this.minFractionDigits),this.maxFractionDigits&&b(this.maxFractionDigits)},Uo.prototype.outputDefined=function(){return!1},Uo.prototype.serialize=function(){var b={};return this.locale&&(b.locale=this.locale.serialize()),this.currency&&(b.currency=this.currency.serialize()),this.minFractionDigits&&(b["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(b["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),b]};var Vo=function(b){this.type=it,this.input=b};Vo.parse=function(b,I){if(b.length!==2)return I.error("Expected 1 argument, but found "+(b.length-1)+" instead.");var G=I.parse(b[1],1);return G?G.type.kind!=="array"&&G.type.kind!=="string"&&G.type.kind!=="value"?I.error("Expected argument of type string or array, but found "+ir(G.type)+" instead."):new Vo(G):null},Vo.prototype.evaluate=function(b){var I=this.input.evaluate(b);if(typeof I=="string"||Array.isArray(I))return I.length;throw new Sn("Expected value to be of type string or array, but found "+ir(pn(I))+" instead.")},Vo.prototype.eachChild=function(b){b(this.input)},Vo.prototype.outputDefined=function(){return!1},Vo.prototype.serialize=function(){var b=["length"];return this.eachChild(function(I){b.push(I.serialize())}),b};var ts={"==":Os,"!=":ms,">":Ks,"<":Zs,">=":Js,"<=":Hs,array:Nr,at:ro,boolean:Nr,case:vi,coalesce:Ao,collator:Bn,format:Pr,image:en,in:Mo,"index-of":zo,interpolate:Wa,"interpolate-hcl":Wa,"interpolate-lab":Wa,length:Vo,let:Ai,literal:On,match:Ui,number:Nr,"number-format":Uo,object:Nr,slice:Qi,step:sa,string:Nr,"to-boolean":Qr,"to-color":Qr,"to-number":Qr,"to-string":Qr,var:vn,within:Jr};function rs(b,I){var G=I[0],re=I[1],fe=I[2],me=I[3];G=G.evaluate(b),re=re.evaluate(b),fe=fe.evaluate(b);var Ae=me?me.evaluate(b):1,De=jr(G,re,fe,Ae);if(De)throw new Sn(De);return new ur(G/255*Ae,re/255*Ae,fe/255*Ae,Ae)}function ns(b,I){return b in I}function vs(b,I){var G=I[b];return G===void 0?null:G}function So(b){return{type:b}}function Ds(b){return{result:"success",value:b}}function vo(b){return{result:"error",value:b}}function as(b){return b["property-type"]==="data-driven"||b["property-type"]==="cross-faded-data-driven"}function zs(b){return!!b.expression&&b.expression.parameters.indexOf("zoom")>-1}function Ho(b){return!!b.expression&&b.expression.interpolated}function qa(b){return b instanceof Number?"number":b instanceof String?"string":b instanceof Boolean?"boolean":Array.isArray(b)?"array":b===null?"null":typeof b}function Re(b){return typeof b=="object"&&b!==null&&!Array.isArray(b)}function Ve(b){return b}function Je(b,I,G){return b!==void 0?b:I!==void 0?I:G!==void 0?G:void 0}function ot(b,I,G,re,fe){return Je(typeof G===fe?re[G]:void 0,b.default,I.default)}function mt(b,I,G){if(qa(G)!=="number")return Je(b.default,I.default);var re=b.stops.length;if(re===1||G<=b.stops[0][0])return b.stops[0][1];if(G>=b.stops[re-1][0])return b.stops[re-1][1];var fe=Pn(b.stops.map(function(me){return me[0]}),G);return b.stops[fe][1]}function dt(b,I,G){var re=b.base!==void 0?b.base:1;if(qa(G)!=="number")return Je(b.default,I.default);var fe=b.stops.length;if(fe===1||G<=b.stops[0][0])return b.stops[0][1];if(G>=b.stops[fe-1][0])return b.stops[fe-1][1];var me=Pn(b.stops.map(function(Bt){return Bt[0]}),G),Ae=function(Bt,Wt,Ht,ar){var gr=ar-Ht,Cr=Bt-Ht;return gr===0?0:Wt===1?Cr/gr:(Math.pow(Wt,Cr)-1)/(Math.pow(Wt,gr)-1)}(G,re,b.stops[me][0],b.stops[me+1][0]),De=b.stops[me][1],Ze=b.stops[me+1][1],ut=yn[I.type]||Ve;if(b.colorSpace&&b.colorSpace!=="rgb"){var gt=es[b.colorSpace];ut=function(Bt,Wt){return gt.reverse(gt.interpolate(gt.forward(Bt),gt.forward(Wt),Ae))}}return typeof De.evaluate=="function"?{evaluate:function(){for(var Bt=[],Wt=arguments.length;Wt--;)Bt[Wt]=arguments[Wt];var Ht=De.evaluate.apply(void 0,Bt),ar=Ze.evaluate.apply(void 0,Bt);if(Ht!==void 0&&ar!==void 0)return ut(Ht,ar,Ae)}}:ut(De,Ze,Ae)}function Et(b,I,G){return I.type==="color"?G=ur.parse(G):I.type==="formatted"?G=Rr.fromString(G.toString()):I.type==="resolvedImage"?G=_r.fromString(G.toString()):qa(G)===I.type||I.type==="enum"&&I.values[G]||(G=void 0),Je(G,b.default,I.default)}En.register(ts,{error:[{kind:"error"},[St],function(b,I){var G=I[0];throw new Sn(G.evaluate(b))}],typeof:[St,[Ie],function(b,I){return ir(pn(I[0].evaluate(b)))}],"to-rgba":[Gt(it,4),[Ut],function(b,I){return I[0].evaluate(b).toArray()}],rgb:[Ut,[it,it,it],rs],rgba:[Ut,[it,it,it,it],rs],has:{type:Nt,overloads:[[[St],function(b,I){return ns(I[0].evaluate(b),b.properties())}],[[St,Qt],function(b,I){var G=I[0],re=I[1];return ns(G.evaluate(b),re.evaluate(b))}]]},get:{type:Ie,overloads:[[[St],function(b,I){return vs(I[0].evaluate(b),b.properties())}],[[St,Qt],function(b,I){var G=I[0],re=I[1];return vs(G.evaluate(b),re.evaluate(b))}]]},"feature-state":[Ie,[St],function(b,I){return vs(I[0].evaluate(b),b.featureState||{})}],properties:[Qt,[],function(b){return b.properties()}],"geometry-type":[St,[],function(b){return b.geometryType()}],id:[Ie,[],function(b){return b.id()}],zoom:[it,[],function(b){return b.globals.zoom}],"heatmap-density":[it,[],function(b){return b.globals.heatmapDensity||0}],"line-progress":[it,[],function(b){return b.globals.lineProgress||0}],accumulated:[Ie,[],function(b){return b.globals.accumulated===void 0?null:b.globals.accumulated}],"+":[it,So(it),function(b,I){for(var G=0,re=0,fe=I;re<fe.length;re+=1)G+=fe[re].evaluate(b);return G}],"*":[it,So(it),function(b,I){for(var G=1,re=0,fe=I;re<fe.length;re+=1)G*=fe[re].evaluate(b);return G}],"-":{type:it,overloads:[[[it,it],function(b,I){var G=I[0],re=I[1];return G.evaluate(b)-re.evaluate(b)}],[[it],function(b,I){return-I[0].evaluate(b)}]]},"/":[it,[it,it],function(b,I){var G=I[0],re=I[1];return G.evaluate(b)/re.evaluate(b)}],"%":[it,[it,it],function(b,I){var G=I[0],re=I[1];return G.evaluate(b)%re.evaluate(b)}],ln2:[it,[],function(){return Math.LN2}],pi:[it,[],function(){return Math.PI}],e:[it,[],function(){return Math.E}],"^":[it,[it,it],function(b,I){var G=I[0],re=I[1];return Math.pow(G.evaluate(b),re.evaluate(b))}],sqrt:[it,[it],function(b,I){var G=I[0];return Math.sqrt(G.evaluate(b))}],log10:[it,[it],function(b,I){var G=I[0];return Math.log(G.evaluate(b))/Math.LN10}],ln:[it,[it],function(b,I){var G=I[0];return Math.log(G.evaluate(b))}],log2:[it,[it],function(b,I){var G=I[0];return Math.log(G.evaluate(b))/Math.LN2}],sin:[it,[it],function(b,I){var G=I[0];return Math.sin(G.evaluate(b))}],cos:[it,[it],function(b,I){var G=I[0];return Math.cos(G.evaluate(b))}],tan:[it,[it],function(b,I){var G=I[0];return Math.tan(G.evaluate(b))}],asin:[it,[it],function(b,I){var G=I[0];return Math.asin(G.evaluate(b))}],acos:[it,[it],function(b,I){var G=I[0];return Math.acos(G.evaluate(b))}],atan:[it,[it],function(b,I){var G=I[0];return Math.atan(G.evaluate(b))}],min:[it,So(it),function(b,I){return Math.min.apply(Math,I.map(function(G){return G.evaluate(b)}))}],max:[it,So(it),function(b,I){return Math.max.apply(Math,I.map(function(G){return G.evaluate(b)}))}],abs:[it,[it],function(b,I){var G=I[0];return Math.abs(G.evaluate(b))}],round:[it,[it],function(b,I){var G=I[0].evaluate(b);return G<0?-Math.round(-G):Math.round(G)}],floor:[it,[it],function(b,I){var G=I[0];return Math.floor(G.evaluate(b))}],ceil:[it,[it],function(b,I){var G=I[0];return Math.ceil(G.evaluate(b))}],"filter-==":[Nt,[St,Ie],function(b,I){var G=I[0],re=I[1];return b.properties()[G.value]===re.value}],"filter-id-==":[Nt,[Ie],function(b,I){var G=I[0];return b.id()===G.value}],"filter-type-==":[Nt,[St],function(b,I){var G=I[0];return b.geometryType()===G.value}],"filter-<":[Nt,[St,Ie],function(b,I){var G=I[0],re=I[1],fe=b.properties()[G.value],me=re.value;return typeof fe==typeof me&&fe<me}],"filter-id-<":[Nt,[Ie],function(b,I){var G=I[0],re=b.id(),fe=G.value;return typeof re==typeof fe&&re<fe}],"filter->":[Nt,[St,Ie],function(b,I){var G=I[0],re=I[1],fe=b.properties()[G.value],me=re.value;return typeof fe==typeof me&&fe>me}],"filter-id->":[Nt,[Ie],function(b,I){var G=I[0],re=b.id(),fe=G.value;return typeof re==typeof fe&&re>fe}],"filter-<=":[Nt,[St,Ie],function(b,I){var G=I[0],re=I[1],fe=b.properties()[G.value],me=re.value;return typeof fe==typeof me&&fe<=me}],"filter-id-<=":[Nt,[Ie],function(b,I){var G=I[0],re=b.id(),fe=G.value;return typeof re==typeof fe&&re<=fe}],"filter->=":[Nt,[St,Ie],function(b,I){var G=I[0],re=I[1],fe=b.properties()[G.value],me=re.value;return typeof fe==typeof me&&fe>=me}],"filter-id->=":[Nt,[Ie],function(b,I){var G=I[0],re=b.id(),fe=G.value;return typeof re==typeof fe&&re>=fe}],"filter-has":[Nt,[Ie],function(b,I){return I[0].value in b.properties()}],"filter-has-id":[Nt,[],function(b){return b.id()!==null&&b.id()!==void 0}],"filter-type-in":[Nt,[Gt(St)],function(b,I){return I[0].value.indexOf(b.geometryType())>=0}],"filter-id-in":[Nt,[Gt(Ie)],function(b,I){return I[0].value.indexOf(b.id())>=0}],"filter-in-small":[Nt,[St,Gt(Ie)],function(b,I){var G=I[0];return I[1].value.indexOf(b.properties()[G.value])>=0}],"filter-in-large":[Nt,[St,Gt(Ie)],function(b,I){var G=I[0],re=I[1];return function(fe,me,Ae,De){for(;Ae<=De;){var Ze=Ae+De>>1;if(me[Ze]===fe)return!0;me[Ze]>fe?De=Ze-1:Ae=Ze+1}return!1}(b.properties()[G.value],re.value,0,re.value.length-1)}],all:{type:Nt,overloads:[[[Nt,Nt],function(b,I){var G=I[0],re=I[1];return G.evaluate(b)&&re.evaluate(b)}],[So(Nt),function(b,I){for(var G=0,re=I;G<re.length;G+=1)if(!re[G].evaluate(b))return!1;return!0}]]},any:{type:Nt,overloads:[[[Nt,Nt],function(b,I){var G=I[0],re=I[1];return G.evaluate(b)||re.evaluate(b)}],[So(Nt),function(b,I){for(var G=0,re=I;G<re.length;G+=1)if(re[G].evaluate(b))return!0;return!1}]]},"!":[Nt,[Nt],function(b,I){return!I[0].evaluate(b)}],"is-supported-script":[Nt,[St],function(b,I){var G=I[0],re=b.globals&&b.globals.isSupportedScript;return!re||re(G.evaluate(b))}],upcase:[St,[St],function(b,I){return I[0].evaluate(b).toUpperCase()}],downcase:[St,[St],function(b,I){return I[0].evaluate(b).toLowerCase()}],concat:[St,So(Ie),function(b,I){return I.map(function(G){return In(G.evaluate(b))}).join("")}],"resolved-locale":[St,[lt],function(b,I){return I[0].evaluate(b).resolvedLocale()}]});var Zt=function(b,I){this.expression=b,this._warningHistory={},this._evaluator=new An,this._defaultValue=I?function(G){return G.type==="color"&&Re(G.default)?new ur(0,0,0,0):G.type==="color"?ur.parse(G.default)||null:G.default===void 0?null:G.default}(I):null,this._enumValues=I&&I.type==="enum"?I.values:null};function $t(b){return Array.isArray(b)&&b.length>0&&typeof b[0]=="string"&&b[0]in ts}function Yt(b,I){var G=new dn(ts,[],I?function(fe){var me={color:Ut,string:St,number:it,enum:St,boolean:Nt,formatted:wt,resolvedImage:Ot};return fe.type==="array"?Gt(me[fe.value]||Ie,fe.length):me[fe.type]}(I):void 0),re=G.parse(b,void 0,void 0,void 0,I&&I.type==="string"?{typeAnnotation:"coerce"}:void 0);return re?Ds(new Zt(re,I)):vo(G.errors)}Zt.prototype.evaluateWithoutErrorHandling=function(b,I,G,re,fe,me){return this._evaluator.globals=b,this._evaluator.feature=I,this._evaluator.featureState=G,this._evaluator.canonical=re,this._evaluator.availableImages=fe||null,this._evaluator.formattedSection=me,this.expression.evaluate(this._evaluator)},Zt.prototype.evaluate=function(b,I,G,re,fe,me){this._evaluator.globals=b,this._evaluator.feature=I||null,this._evaluator.featureState=G||null,this._evaluator.canonical=re,this._evaluator.availableImages=fe||null,this._evaluator.formattedSection=me||null;try{var Ae=this.expression.evaluate(this._evaluator);if(Ae==null||typeof Ae=="number"&&Ae!=Ae)return this._defaultValue;if(this._enumValues&&!(Ae in this._enumValues))throw new Sn("Expected value to be one of "+Object.keys(this._enumValues).map(function(De){return JSON.stringify(De)}).join(", ")+", but found "+JSON.stringify(Ae)+" instead.");return Ae}catch(De){return this._warningHistory[De.message]||(this._warningHistory[De.message]=!0,typeof console!="undefined"&&console.warn(De.message)),this._defaultValue}};var nr=function(b,I){this.kind=b,this._styleExpression=I,this.isStateDependent=b!=="constant"&&!Dr(I.expression)};nr.prototype.evaluateWithoutErrorHandling=function(b,I,G,re,fe,me){return this._styleExpression.evaluateWithoutErrorHandling(b,I,G,re,fe,me)},nr.prototype.evaluate=function(b,I,G,re,fe,me){return this._styleExpression.evaluate(b,I,G,re,fe,me)};var cr=function(b,I,G,re){this.kind=b,this.zoomStops=G,this._styleExpression=I,this.isStateDependent=b!=="camera"&&!Dr(I.expression),this.interpolationType=re};function mr(b,I){if((b=Yt(b,I)).result==="error")return b;var G=b.value.expression,re=bn(G);if(!re&&!as(I))return vo([new vt("","data expressions not supported")]);var fe=Wr(G,["zoom"]);if(!fe&&!zs(I))return vo([new vt("","zoom expressions not supported")]);var me=function De(Ze){var ut=null;if(Ze instanceof Ai)ut=De(Ze.result);else if(Ze instanceof Ao)for(var gt=0,Bt=Ze.args;gt<Bt.length;gt+=1){var Wt=Bt[gt];if(ut=De(Wt))break}else(Ze instanceof sa||Ze instanceof Wa)&&Ze.input instanceof En&&Ze.input.name==="zoom"&&(ut=Ze);return ut instanceof vt||Ze.eachChild(function(Ht){var ar=De(Ht);ar instanceof vt?ut=ar:!ut&&ar?ut=new vt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):ut&&ar&&ut!==ar&&(ut=new vt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),ut}(G);if(!me&&!fe)return vo([new vt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(me instanceof vt)return vo([me]);if(me instanceof Wa&&!Ho(I))return vo([new vt("",'"interpolate" expressions cannot be used with this property')]);if(!me)return Ds(new nr(re?"constant":"source",b.value));var Ae=me instanceof Wa?me.interpolation:void 0;return Ds(new cr(re?"camera":"composite",b.value,me.labels,Ae))}cr.prototype.evaluateWithoutErrorHandling=function(b,I,G,re,fe,me){return this._styleExpression.evaluateWithoutErrorHandling(b,I,G,re,fe,me)},cr.prototype.evaluate=function(b,I,G,re,fe,me){return this._styleExpression.evaluate(b,I,G,re,fe,me)},cr.prototype.interpolationFactor=function(b,I,G){return this.interpolationType?Wa.interpolationFactor(this.interpolationType,b,I,G):0};var yr=function(b,I){this._parameters=b,this._specification=I,Mt(this,function G(re,fe){var me,Ae,De,Ze=fe.type==="color",ut=re.stops&&typeof re.stops[0][0]=="object",gt=ut||re.property!==void 0,Bt=ut||!gt,Wt=re.type||(Ho(fe)?"exponential":"interval");if(Ze&&((re=Mt({},re)).stops&&(re.stops=re.stops.map(function(ia){return[ia[0],ur.parse(ia[1])]})),re.default?re.default=ur.parse(re.default):re.default=ur.parse(fe.default)),re.colorSpace&&re.colorSpace!=="rgb"&&!es[re.colorSpace])throw new Error("Unknown color space: "+re.colorSpace);if(Wt==="exponential")me=dt;else if(Wt==="interval")me=mt;else if(Wt==="categorical"){me=ot,Ae=Object.create(null);for(var Ht=0,ar=re.stops;Ht<ar.length;Ht+=1){var gr=ar[Ht];Ae[gr[0]]=gr[1]}De=typeof re.stops[0][0]}else{if(Wt!=="identity")throw new Error('Unknown function type "'+Wt+'"');me=Et}if(ut){for(var Cr={},Er=[],Fr=0;Fr<re.stops.length;Fr++){var Br=re.stops[Fr],Hr=Br[0].zoom;Cr[Hr]===void 0&&(Cr[Hr]={zoom:Hr,type:re.type,property:re.property,default:re.default,stops:[]},Er.push(Hr)),Cr[Hr].stops.push([Br[0].value,Br[1]])}for(var fn=[],xn=0,Nn=Er;xn<Nn.length;xn+=1){var Fn=Nn[xn];fn.push([Cr[Fn].zoom,G(Cr[Fn],fe)])}var qn={name:"linear"};return{kind:"composite",interpolationType:qn,interpolationFactor:Wa.interpolationFactor.bind(void 0,qn),zoomStops:fn.map(function(ia){return ia[0]}),evaluate:function(ia,Zn){var ha=ia.zoom;return dt({stops:fn,base:re.base},fe,ha).evaluate(ha,Zn)}}}if(Bt){var na=Wt==="exponential"?{name:"exponential",base:re.base!==void 0?re.base:1}:null;return{kind:"camera",interpolationType:na,interpolationFactor:Wa.interpolationFactor.bind(void 0,na),zoomStops:re.stops.map(function(ia){return ia[0]}),evaluate:function(ia){var Zn=ia.zoom;return me(re,fe,Zn,Ae,De)}}}return{kind:"source",evaluate:function(ia,Zn){var ha=Zn&&Zn.properties?Zn.properties[re.property]:void 0;return ha===void 0?Je(re.default,fe.default):me(re,fe,ha,Ae,De)}}}(this._parameters,this._specification))};function Or(b){var I=b.key,G=b.value,re=b.valueSpec||{},fe=b.objectElementValidators||{},me=b.style,Ae=b.styleSpec,De=[],Ze=qa(G);if(Ze!=="object")return[new Xe(I,G,"object expected, "+Ze+" found")];for(var ut in G){var gt=ut.split(".")[0],Bt=re[gt]||re["*"],Wt=void 0;if(fe[gt])Wt=fe[gt];else if(re[gt])Wt=sr;else if(fe["*"])Wt=fe["*"];else{if(!re["*"]){De.push(new Xe(I,G[ut],'unknown property "'+ut+'"'));continue}Wt=sr}De=De.concat(Wt({key:(I&&I+".")+ut,value:G[ut],valueSpec:Bt,style:me,styleSpec:Ae,object:G,objectKey:ut},G))}for(var Ht in re)fe[Ht]||re[Ht].required&&re[Ht].default===void 0&&G[Ht]===void 0&&De.push(new Xe(I,G,'missing required property "'+Ht+'"'));return De}function nn(b){var I=b.value,G=b.valueSpec,re=b.style,fe=b.styleSpec,me=b.key,Ae=b.arrayElementValidator||sr;if(qa(I)!=="array")return[new Xe(me,I,"array expected, "+qa(I)+" found")];if(G.length&&I.length!==G.length)return[new Xe(me,I,"array length "+G.length+" expected, length "+I.length+" found")];if(G["min-length"]&&I.length<G["min-length"])return[new Xe(me,I,"array length at least "+G["min-length"]+" expected, length "+I.length+" found")];var De={type:G.value,values:G.values};fe.$version<7&&(De.function=G.function),qa(G.value)==="object"&&(De=G.value);for(var Ze=[],ut=0;ut<I.length;ut++)Ze=Ze.concat(Ae({array:I,arrayIndex:ut,value:I[ut],valueSpec:De,style:re,styleSpec:fe,key:me+"["+ut+"]"}));return Ze}function gn(b){var I=b.key,G=b.value,re=b.valueSpec,fe=qa(G);return fe==="number"&&G!=G&&(fe="NaN"),fe!=="number"?[new Xe(I,G,"number expected, "+fe+" found")]:"minimum"in re&&G<re.minimum?[new Xe(I,G,G+" is less than the minimum value "+re.minimum)]:"maximum"in re&&G>re.maximum?[new Xe(I,G,G+" is greater than the maximum value "+re.maximum)]:[]}function Cn(b){var I,G,re,fe=b.valueSpec,me=pt(b.value.type),Ae={},De=me!=="categorical"&&b.value.property===void 0,Ze=!De,ut=qa(b.value.stops)==="array"&&qa(b.value.stops[0])==="array"&&qa(b.value.stops[0][0])==="object",gt=Or({key:b.key,value:b.value,valueSpec:b.styleSpec.function,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{stops:function(Ht){if(me==="identity")return[new Xe(Ht.key,Ht.value,'identity function may not have a "stops" property')];var ar=[],gr=Ht.value;return ar=ar.concat(nn({key:Ht.key,value:gr,valueSpec:Ht.valueSpec,style:Ht.style,styleSpec:Ht.styleSpec,arrayElementValidator:Bt})),qa(gr)==="array"&&gr.length===0&&ar.push(new Xe(Ht.key,gr,"array must have at least one stop")),ar},default:function(Ht){return sr({key:Ht.key,value:Ht.value,valueSpec:fe,style:Ht.style,styleSpec:Ht.styleSpec})}}});return me==="identity"&&De&&gt.push(new Xe(b.key,b.value,'missing required property "property"')),me==="identity"||b.value.stops||gt.push(new Xe(b.key,b.value,'missing required property "stops"')),me==="exponential"&&b.valueSpec.expression&&!Ho(b.valueSpec)&&gt.push(new Xe(b.key,b.value,"exponential functions not supported")),b.styleSpec.$version>=8&&(Ze&&!as(b.valueSpec)?gt.push(new Xe(b.key,b.value,"property functions not supported")):De&&!zs(b.valueSpec)&&gt.push(new Xe(b.key,b.value,"zoom functions not supported"))),me!=="categorical"&&!ut||b.value.property!==void 0||gt.push(new Xe(b.key,b.value,'"property" property is required')),gt;function Bt(Ht){var ar=[],gr=Ht.value,Cr=Ht.key;if(qa(gr)!=="array")return[new Xe(Cr,gr,"array expected, "+qa(gr)+" found")];if(gr.length!==2)return[new Xe(Cr,gr,"array length 2 expected, length "+gr.length+" found")];if(ut){if(qa(gr[0])!=="object")return[new Xe(Cr,gr,"object expected, "+qa(gr[0])+" found")];if(gr[0].zoom===void 0)return[new Xe(Cr,gr,"object stop key must have zoom")];if(gr[0].value===void 0)return[new Xe(Cr,gr,"object stop key must have value")];if(re&&re>pt(gr[0].zoom))return[new Xe(Cr,gr[0].zoom,"stop zoom values must appear in ascending order")];pt(gr[0].zoom)!==re&&(re=pt(gr[0].zoom),G=void 0,Ae={}),ar=ar.concat(Or({key:Cr+"[0]",value:gr[0],valueSpec:{zoom:{}},style:Ht.style,styleSpec:Ht.styleSpec,objectElementValidators:{zoom:gn,value:Wt}}))}else ar=ar.concat(Wt({key:Cr+"[0]",value:gr[0],valueSpec:{},style:Ht.style,styleSpec:Ht.styleSpec},gr));return $t(Lt(gr[1]))?ar.concat([new Xe(Cr+"[1]",gr[1],"expressions are not allowed in function stops.")]):ar.concat(sr({key:Cr+"[1]",value:gr[1],valueSpec:fe,style:Ht.style,styleSpec:Ht.styleSpec}))}function Wt(Ht,ar){var gr=qa(Ht.value),Cr=pt(Ht.value),Er=Ht.value!==null?Ht.value:ar;if(I){if(gr!==I)return[new Xe(Ht.key,Er,gr+" stop domain type must match previous stop domain type "+I)]}else I=gr;if(gr!=="number"&&gr!=="string"&&gr!=="boolean")return[new Xe(Ht.key,Er,"stop domain value must be a number, string, or boolean")];if(gr!=="number"&&me!=="categorical"){var Fr="number expected, "+gr+" found";return as(fe)&&me===void 0&&(Fr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Xe(Ht.key,Er,Fr)]}return me!=="categorical"||gr!=="number"||isFinite(Cr)&&Math.floor(Cr)===Cr?me!=="categorical"&&gr==="number"&&G!==void 0&&Cr<G?[new Xe(Ht.key,Er,"stop domain values must appear in ascending order")]:(G=Cr,me==="categorical"&&Cr in Ae?[new Xe(Ht.key,Er,"stop domain values must be unique")]:(Ae[Cr]=!0,[])):[new Xe(Ht.key,Er,"integer expected, found "+Cr)]}}function Dn(b){var I=(b.expressionContext==="property"?mr:Yt)(Lt(b.value),b.valueSpec);if(I.result==="error")return I.value.map(function(re){return new Xe(""+b.key+re.key,b.value,re.message)});var G=I.value.expression||I.value._styleExpression.expression;if(b.expressionContext==="property"&&b.propertyKey==="text-font"&&!G.outputDefined())return[new Xe(b.key,b.value,'Invalid data expression for "'+b.propertyKey+'". Output values must be contained as literals within the expression.')];if(b.expressionContext==="property"&&b.propertyType==="layout"&&!Dr(G))return[new Xe(b.key,b.value,'"feature-state" data expressions are not supported with layout properties.')];if(b.expressionContext==="filter"&&!Dr(G))return[new Xe(b.key,b.value,'"feature-state" data expressions are not supported with filters.')];if(b.expressionContext&&b.expressionContext.indexOf("cluster")===0){if(!Wr(G,["zoom","feature-state"]))return[new Xe(b.key,b.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(b.expressionContext==="cluster-initial"&&!bn(G))return[new Xe(b.key,b.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Hn(b){var I=b.key,G=b.value,re=b.valueSpec,fe=[];return Array.isArray(re.values)?re.values.indexOf(pt(G))===-1&&fe.push(new Xe(I,G,"expected one of ["+re.values.join(", ")+"], "+JSON.stringify(G)+" found")):Object.keys(re.values).indexOf(pt(G))===-1&&fe.push(new Xe(I,G,"expected one of ["+Object.keys(re.values).join(", ")+"], "+JSON.stringify(G)+" found")),fe}function zn(b){if(b===!0||b===!1)return!0;if(!Array.isArray(b)||b.length===0)return!1;switch(b[0]){case"has":return b.length>=2&&b[1]!=="$id"&&b[1]!=="$type";case"in":return b.length>=3&&(typeof b[1]!="string"||Array.isArray(b[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return b.length!==3||Array.isArray(b[1])||Array.isArray(b[2]);case"any":case"all":for(var I=0,G=b.slice(1);I<G.length;I+=1){var re=G[I];if(!zn(re)&&typeof re!="boolean")return!1}return!0;default:return!0}}yr.deserialize=function(b){return new yr(b._parameters,b._specification)},yr.serialize=function(b){return{_parameters:b._parameters,_specification:b._specification}};var ga={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ka(b){if(b==null)return{filter:function(){return!0},needGeometry:!1};zn(b)||(b=Fa(b));var I=Yt(b,ga);if(I.result==="error")throw new Error(I.value.map(function(G){return G.key+": "+G.message}).join(", "));return{filter:function(G,re,fe){return I.value.evaluate(G,re,{},fe)},needGeometry:function G(re){if(!Array.isArray(re))return!1;if(re[0]==="within")return!0;for(var fe=1;fe<re.length;fe++)if(G(re[fe]))return!0;return!1}(b)}}function Ba(b,I){return b<I?-1:b>I?1:0}function Fa(b){if(!b)return!0;var I,G=b[0];return b.length<=1?G!=="any":G==="=="?ja(b[1],b[2],"=="):G==="!="?ui(ja(b[1],b[2],"==")):G==="<"||G===">"||G==="<="||G===">="?ja(b[1],b[2],G):G==="any"?(I=b.slice(1),["any"].concat(I.map(Fa))):G==="all"?["all"].concat(b.slice(1).map(Fa)):G==="none"?["all"].concat(b.slice(1).map(Fa).map(ui)):G==="in"?Mi(b[1],b.slice(2)):G==="!in"?ui(Mi(b[1],b.slice(2))):G==="has"?wi(b[1]):G==="!has"?ui(wi(b[1])):G!=="within"||b}function ja(b,I,G){switch(b){case"$type":return["filter-type-"+G,I];case"$id":return["filter-id-"+G,I];default:return["filter-"+G,b,I]}}function Mi(b,I){if(I.length===0)return!1;switch(b){case"$type":return["filter-type-in",["literal",I]];case"$id":return["filter-id-in",["literal",I]];default:return I.length>200&&!I.some(function(G){return typeof G!=typeof I[0]})?["filter-in-large",b,["literal",I.sort(Ba)]]:["filter-in-small",b,["literal",I]]}}function wi(b){switch(b){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",b]}}function ui(b){return["!",b]}function ci(b){return zn(Lt(b.value))?Dn(Mt({},b,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function I(G){var re=G.value,fe=G.key;if(qa(re)!=="array")return[new Xe(fe,re,"array expected, "+qa(re)+" found")];var me,Ae=G.styleSpec,De=[];if(re.length<1)return[new Xe(fe,re,"filter array must have at least 1 element")];switch(De=De.concat(Hn({key:fe+"[0]",value:re[0],valueSpec:Ae.filter_operator,style:G.style,styleSpec:G.styleSpec})),pt(re[0])){case"<":case"<=":case">":case">=":re.length>=2&&pt(re[1])==="$type"&&De.push(new Xe(fe,re,'"$type" cannot be use with operator "'+re[0]+'"'));case"==":case"!=":re.length!==3&&De.push(new Xe(fe,re,'filter array for operator "'+re[0]+'" must have 3 elements'));case"in":case"!in":re.length>=2&&(me=qa(re[1]))!=="string"&&De.push(new Xe(fe+"[1]",re[1],"string expected, "+me+" found"));for(var Ze=2;Ze<re.length;Ze++)me=qa(re[Ze]),pt(re[1])==="$type"?De=De.concat(Hn({key:fe+"["+Ze+"]",value:re[Ze],valueSpec:Ae.geometry_type,style:G.style,styleSpec:G.styleSpec})):me!=="string"&&me!=="number"&&me!=="boolean"&&De.push(new Xe(fe+"["+Ze+"]",re[Ze],"string, number, or boolean expected, "+me+" found"));break;case"any":case"all":case"none":for(var ut=1;ut<re.length;ut++)De=De.concat(I({key:fe+"["+ut+"]",value:re[ut],style:G.style,styleSpec:G.styleSpec}));break;case"has":case"!has":me=qa(re[1]),re.length!==2?De.push(new Xe(fe,re,'filter array for "'+re[0]+'" operator must have 2 elements')):me!=="string"&&De.push(new Xe(fe+"[1]",re[1],"string expected, "+me+" found"));break;case"within":me=qa(re[1]),re.length!==2?De.push(new Xe(fe,re,'filter array for "'+re[0]+'" operator must have 2 elements')):me!=="object"&&De.push(new Xe(fe+"[1]",re[1],"object expected, "+me+" found"))}return De}(b)}function Ti(b,I){var G=b.key,re=b.style,fe=b.styleSpec,me=b.value,Ae=b.objectKey,De=fe[I+"_"+b.layerType];if(!De)return[];var Ze=Ae.match(/^(.*)-transition$/);if(I==="paint"&&Ze&&De[Ze[1]]&&De[Ze[1]].transition)return sr({key:G,value:me,valueSpec:fe.transition,style:re,styleSpec:fe});var ut,gt=b.valueSpec||De[Ae];if(!gt)return[new Xe(G,me,'unknown property "'+Ae+'"')];if(qa(me)==="string"&&as(gt)&&!gt.tokens&&(ut=/^{([^}]+)}$/.exec(me)))return[new Xe(G,me,'"'+Ae+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(ut[1])+" }`.")];var Bt=[];return b.layerType==="symbol"&&(Ae==="text-field"&&re&&!re.glyphs&&Bt.push(new Xe(G,me,'use of "text-field" requires a style "glyphs" property')),Ae==="text-font"&&Re(Lt(me))&&pt(me.type)==="identity"&&Bt.push(new Xe(G,me,'"text-font" does not support identity functions'))),Bt.concat(sr({key:b.key,value:me,valueSpec:gt,style:re,styleSpec:fe,expressionContext:"property",propertyType:I,propertyKey:Ae}))}function Vi(b){return Ti(b,"paint")}function no(b){return Ti(b,"layout")}function ao(b){var I=[],G=b.value,re=b.key,fe=b.style,me=b.styleSpec;G.type||G.ref||I.push(new Xe(re,G,'either "type" or "ref" is required'));var Ae,De=pt(G.type),Ze=pt(G.ref);if(G.id)for(var ut=pt(G.id),gt=0;gt<b.arrayIndex;gt++){var Bt=fe.layers[gt];pt(Bt.id)===ut&&I.push(new Xe(re,G.id,'duplicate layer id "'+G.id+'", previously used at line '+Bt.id.__line__))}if("ref"in G)["type","source","source-layer","filter","layout"].forEach(function(ar){ar in G&&I.push(new Xe(re,G[ar],'"'+ar+'" is prohibited for ref layers'))}),fe.layers.forEach(function(ar){pt(ar.id)===Ze&&(Ae=ar)}),Ae?Ae.ref?I.push(new Xe(re,G.ref,"ref cannot reference another ref layer")):De=pt(Ae.type):I.push(new Xe(re,G.ref,'ref layer "'+Ze+'" not found'));else if(De!=="background")if(G.source){var Wt=fe.sources&&fe.sources[G.source],Ht=Wt&&pt(Wt.type);Wt?Ht==="vector"&&De==="raster"?I.push(new Xe(re,G.source,'layer "'+G.id+'" requires a raster source')):Ht==="raster"&&De!=="raster"?I.push(new Xe(re,G.source,'layer "'+G.id+'" requires a vector source')):Ht!=="vector"||G["source-layer"]?Ht==="raster-dem"&&De!=="hillshade"?I.push(new Xe(re,G.source,"raster-dem source can only be used with layer type 'hillshade'.")):De!=="line"||!G.paint||!G.paint["line-gradient"]||Ht==="geojson"&&Wt.lineMetrics||I.push(new Xe(re,G,'layer "'+G.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):I.push(new Xe(re,G,'layer "'+G.id+'" must specify a "source-layer"')):I.push(new Xe(re,G.source,'source "'+G.source+'" not found'))}else I.push(new Xe(re,G,'missing required property "source"'));return I=I.concat(Or({key:re,value:G,valueSpec:me.layer,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return sr({key:re+".type",value:G.type,valueSpec:me.layer.type,style:b.style,styleSpec:b.styleSpec,object:G,objectKey:"type"})},filter:ci,layout:function(ar){return Or({layer:G,key:ar.key,value:ar.value,style:ar.style,styleSpec:ar.styleSpec,objectElementValidators:{"*":function(gr){return no(Mt({layerType:De},gr))}}})},paint:function(ar){return Or({layer:G,key:ar.key,value:ar.value,style:ar.style,styleSpec:ar.styleSpec,objectElementValidators:{"*":function(gr){return Vi(Mt({layerType:De},gr))}}})}}}))}function io(b){var I=b.value,G=b.key,re=qa(I);return re!=="string"?[new Xe(G,I,"string expected, "+re+" found")]:[]}var oo={promoteId:function(b){var I=b.key,G=b.value;if(qa(G)==="string")return io({key:I,value:G});var re=[];for(var fe in G)re.push.apply(re,io({key:I+"."+fe,value:G[fe]}));return re}};function Oa(b){var I=b.value,G=b.key,re=b.styleSpec,fe=b.style;if(!I.type)return[new Xe(G,I,'"type" is required')];var me,Ae=pt(I.type);switch(Ae){case"vector":case"raster":case"raster-dem":return me=Or({key:G,value:I,valueSpec:re["source_"+Ae.replace("-","_")],style:b.style,styleSpec:re,objectElementValidators:oo});case"geojson":if(me=Or({key:G,value:I,valueSpec:re.source_geojson,style:fe,styleSpec:re,objectElementValidators:oo}),I.cluster)for(var De in I.clusterProperties){var Ze=I.clusterProperties[De],ut=Ze[0],gt=Ze[1],Bt=typeof ut=="string"?[ut,["accumulated"],["get",De]]:ut;me.push.apply(me,Dn({key:G+"."+De+".map",value:gt,expressionContext:"cluster-map"})),me.push.apply(me,Dn({key:G+"."+De+".reduce",value:Bt,expressionContext:"cluster-reduce"}))}return me;case"video":return Or({key:G,value:I,valueSpec:re.source_video,style:fe,styleSpec:re});case"image":return Or({key:G,value:I,valueSpec:re.source_image,style:fe,styleSpec:re});case"canvas":return[new Xe(G,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Hn({key:G+".type",value:I.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:fe,styleSpec:re})}}function ft(b){var I=b.value,G=b.styleSpec,re=G.light,fe=b.style,me=[],Ae=qa(I);if(I===void 0)return me;if(Ae!=="object")return me=me.concat([new Xe("light",I,"object expected, "+Ae+" found")]);for(var De in I){var Ze=De.match(/^(.*)-transition$/);me=Ze&&re[Ze[1]]&&re[Ze[1]].transition?me.concat(sr({key:De,value:I[De],valueSpec:G.transition,style:fe,styleSpec:G})):re[De]?me.concat(sr({key:De,value:I[De],valueSpec:re[De],style:fe,styleSpec:G})):me.concat([new Xe(De,I[De],'unknown property "'+De+'"')])}return me}var Rt={"*":function(){return[]},array:nn,boolean:function(b){var I=b.value,G=b.key,re=qa(I);return re!=="boolean"?[new Xe(G,I,"boolean expected, "+re+" found")]:[]},number:gn,color:function(b){var I=b.key,G=b.value,re=qa(G);return re!=="string"?[new Xe(I,G,"color expected, "+re+" found")]:vr(G)===null?[new Xe(I,G,'color expected, "'+G+'" found')]:[]},constants:ht,enum:Hn,filter:ci,function:Cn,layer:ao,object:Or,source:Oa,light:ft,string:io,formatted:function(b){return io(b).length===0?[]:Dn(b)},resolvedImage:function(b){return io(b).length===0?[]:Dn(b)}};function sr(b){var I=b.value,G=b.valueSpec,re=b.styleSpec;return G.expression&&Re(pt(I))?Cn(b):G.expression&&$t(Lt(I))?Dn(b):G.type&&Rt[G.type]?Rt[G.type](b):Or(Mt({},b,{valueSpec:G.type?re[G.type]:G}))}function Vt(b){var I=b.value,G=b.key,re=io(b);return re.length||(I.indexOf("{fontstack}")===-1&&re.push(new Xe(G,I,'"glyphs" url must include a "{fontstack}" token')),I.indexOf("{range}")===-1&&re.push(new Xe(G,I,'"glyphs" url must include a "{range}" token'))),re}function lr(b,I){I===void 0&&(I=Pe);var G=[];return G=G.concat(sr({key:"",value:b,valueSpec:I.$root,styleSpec:I,style:b,objectElementValidators:{glyphs:Vt,"*":function(){return[]}}})),b.constants&&(G=G.concat(ht({key:"constants",value:b.constants,style:b,styleSpec:I}))),Lr(G)}function Lr(b){return[].concat(b).sort(function(I,G){return I.line-G.line})}function zr(b){return function(){for(var I=[],G=arguments.length;G--;)I[G]=arguments[G];return Lr(b.apply(this,I))}}lr.source=zr(Oa),lr.light=zr(ft),lr.layer=zr(ao),lr.filter=zr(ci),lr.paintProperty=zr(Vi),lr.layoutProperty=zr(no);var Yr=lr,ln=Yr.light,on=Yr.paintProperty,mn=Yr.layoutProperty;function wn(b,I){var G=!1;if(I&&I.length)for(var re=0,fe=I;re<fe.length;re+=1){var me=fe[re];b.fire(new Ce(new Error(me.message))),G=!0}return G}var un=Tn;function Tn(b,I,G){var re=this.cells=[];if(b instanceof ArrayBuffer){this.arrayBuffer=b;var fe=new Int32Array(this.arrayBuffer);b=fe[0],I=fe[1],G=fe[2],this.d=I+2*G;for(var me=0;me<this.d*this.d;me++){var Ae=fe[3+me],De=fe[3+me+1];re.push(Ae===De?null:fe.subarray(Ae,De))}var Ze=fe[3+re.length],ut=fe[3+re.length+1];this.keys=fe.subarray(Ze,ut),this.bboxes=fe.subarray(ut),this.insert=this._insertReadonly}else{this.d=I+2*G;for(var gt=0;gt<this.d*this.d;gt++)re.push([]);this.keys=[],this.bboxes=[]}this.n=I,this.extent=b,this.padding=G,this.scale=I/b,this.uid=0;var Bt=G/I*b;this.min=-Bt,this.max=b+Bt}Tn.prototype.insert=function(b,I,G,re,fe){this._forEachCell(I,G,re,fe,this._insertCell,this.uid++),this.keys.push(b),this.bboxes.push(I),this.bboxes.push(G),this.bboxes.push(re),this.bboxes.push(fe)},Tn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Tn.prototype._insertCell=function(b,I,G,re,fe,me){this.cells[fe].push(me)},Tn.prototype.query=function(b,I,G,re,fe){var me=this.min,Ae=this.max;if(b<=me&&I<=me&&Ae<=G&&Ae<=re&&!fe)return Array.prototype.slice.call(this.keys);var De=[];return this._forEachCell(b,I,G,re,this._queryCell,De,{},fe),De},Tn.prototype._queryCell=function(b,I,G,re,fe,me,Ae,De){var Ze=this.cells[fe];if(Ze!==null)for(var ut=this.keys,gt=this.bboxes,Bt=0;Bt<Ze.length;Bt++){var Wt=Ze[Bt];if(Ae[Wt]===void 0){var Ht=4*Wt;(De?De(gt[Ht+0],gt[Ht+1],gt[Ht+2],gt[Ht+3]):b<=gt[Ht+2]&&I<=gt[Ht+3]&&G>=gt[Ht+0]&&re>=gt[Ht+1])?(Ae[Wt]=!0,me.push(ut[Wt])):Ae[Wt]=!1}}},Tn.prototype._forEachCell=function(b,I,G,re,fe,me,Ae,De){for(var Ze=this._convertToCellCoord(b),ut=this._convertToCellCoord(I),gt=this._convertToCellCoord(G),Bt=this._convertToCellCoord(re),Wt=Ze;Wt<=gt;Wt++)for(var Ht=ut;Ht<=Bt;Ht++){var ar=this.d*Ht+Wt;if((!De||De(this._convertFromCellCoord(Wt),this._convertFromCellCoord(Ht),this._convertFromCellCoord(Wt+1),this._convertFromCellCoord(Ht+1)))&&fe.call(this,b,I,G,re,ar,me,Ae,De))return}},Tn.prototype._convertFromCellCoord=function(b){return(b-this.padding)/this.scale},Tn.prototype._convertToCellCoord=function(b){return Math.max(0,Math.min(this.d-1,Math.floor(b*this.scale)+this.padding))},Tn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var b=this.cells,I=3+this.cells.length+1+1,G=0,re=0;re<this.cells.length;re++)G+=this.cells[re].length;var fe=new Int32Array(I+G+this.keys.length+this.bboxes.length);fe[0]=this.extent,fe[1]=this.n,fe[2]=this.padding;for(var me=I,Ae=0;Ae<b.length;Ae++){var De=b[Ae];fe[3+Ae]=me,fe.set(De,me),me+=De.length}return fe[3+b.length]=me,fe.set(this.keys,me),me+=this.keys.length,fe[3+b.length+1]=me,fe.set(this.bboxes,me),me+=this.bboxes.length,fe.buffer};var Rn=self.ImageData,Vn=self.ImageBitmap,ta={};function Xr(b,I,G){G===void 0&&(G={}),Object.defineProperty(I,"_classRegistryKey",{value:b,writeable:!1}),ta[b]={klass:I,omit:G.omit||[],shallow:G.shallow||[]}}for(var $n in Xr("Object",Object),un.serialize=function(b,I){var G=b.toArrayBuffer();return I&&I.push(G),{buffer:G}},un.deserialize=function(b){return new un(b.buffer)},Xr("Grid",un),Xr("Color",ur),Xr("Error",Error),Xr("ResolvedImage",_r),Xr("StylePropertyFunction",yr),Xr("StyleExpression",Zt,{omit:["_evaluator"]}),Xr("ZoomDependentExpression",cr),Xr("ZoomConstantExpression",nr),Xr("CompoundExpression",En,{omit:["_evaluate"]}),ts)ts[$n]._classRegistryKey||Xr("Expression_"+$n,ts[$n]);function Ln(b){return b&&typeof ArrayBuffer!="undefined"&&(b instanceof ArrayBuffer||b.constructor&&b.constructor.name==="ArrayBuffer")}function jn(b){return Vn&&b instanceof Vn}function Jn(b,I){if(b==null||typeof b=="boolean"||typeof b=="number"||typeof b=="string"||b instanceof Boolean||b instanceof Number||b instanceof String||b instanceof Date||b instanceof RegExp)return b;if(Ln(b)||jn(b))return I&&I.push(b),b;if(ArrayBuffer.isView(b)){var G=b;return I&&I.push(G.buffer),G}if(b instanceof Rn)return I&&I.push(b.data.buffer),b;if(Array.isArray(b)){for(var re=[],fe=0,me=b;fe<me.length;fe+=1){var Ae=me[fe];re.push(Jn(Ae,I))}return re}if(typeof b=="object"){var De=b.constructor,Ze=De._classRegistryKey;if(!Ze)throw new Error("can't serialize object of unregistered class");var ut=De.serialize?De.serialize(b,I):{};if(!De.serialize){for(var gt in b)if(b.hasOwnProperty(gt)&&!(ta[Ze].omit.indexOf(gt)>=0)){var Bt=b[gt];ut[gt]=ta[Ze].shallow.indexOf(gt)>=0?Bt:Jn(Bt,I)}b instanceof Error&&(ut.message=b.message)}if(ut.$name)throw new Error("$name property is reserved for worker serialization logic.");return Ze!=="Object"&&(ut.$name=Ze),ut}throw new Error("can't serialize object of type "+typeof b)}function Ta(b){if(b==null||typeof b=="boolean"||typeof b=="number"||typeof b=="string"||b instanceof Boolean||b instanceof Number||b instanceof String||b instanceof Date||b instanceof RegExp||Ln(b)||jn(b)||ArrayBuffer.isView(b)||b instanceof Rn)return b;if(Array.isArray(b))return b.map(Ta);if(typeof b=="object"){var I=b.$name||"Object",G=ta[I].klass;if(!G)throw new Error("can't deserialize unregistered class "+I);if(G.deserialize)return G.deserialize(b);for(var re=Object.create(G.prototype),fe=0,me=Object.keys(b);fe<me.length;fe+=1){var Ae=me[fe];if(Ae!=="$name"){var De=b[Ae];re[Ae]=ta[I].shallow.indexOf(Ae)>=0?De:Ta(De)}}return re}throw new Error("can't deserialize object of type "+typeof b)}var Ca=function(){this.first=!0};Ca.prototype.update=function(b,I){var G=Math.floor(b);return this.first?(this.first=!1,this.lastIntegerZoom=G,this.lastIntegerZoomTime=0,this.lastZoom=b,this.lastFloorZoom=G,!0):(this.lastFloorZoom>G?(this.lastIntegerZoom=G+1,this.lastIntegerZoomTime=I):this.lastFloorZoom<G&&(this.lastIntegerZoom=G,this.lastIntegerZoomTime=I),b!==this.lastZoom&&(this.lastZoom=b,this.lastFloorZoom=G,!0))};var Mn={"Latin-1 Supplement":function(b){return b>=128&&b<=255},Arabic:function(b){return b>=1536&&b<=1791},"Arabic Supplement":function(b){return b>=1872&&b<=1919},"Arabic Extended-A":function(b){return b>=2208&&b<=2303},"Hangul Jamo":function(b){return b>=4352&&b<=4607},"Unified Canadian Aboriginal Syllabics":function(b){return b>=5120&&b<=5759},Khmer:function(b){return b>=6016&&b<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(b){return b>=6320&&b<=6399},"General Punctuation":function(b){return b>=8192&&b<=8303},"Letterlike Symbols":function(b){return b>=8448&&b<=8527},"Number Forms":function(b){return b>=8528&&b<=8591},"Miscellaneous Technical":function(b){return b>=8960&&b<=9215},"Control Pictures":function(b){return b>=9216&&b<=9279},"Optical Character Recognition":function(b){return b>=9280&&b<=9311},"Enclosed Alphanumerics":function(b){return b>=9312&&b<=9471},"Geometric Shapes":function(b){return b>=9632&&b<=9727},"Miscellaneous Symbols":function(b){return b>=9728&&b<=9983},"Miscellaneous Symbols and Arrows":function(b){return b>=11008&&b<=11263},"CJK Radicals Supplement":function(b){return b>=11904&&b<=12031},"Kangxi Radicals":function(b){return b>=12032&&b<=12255},"Ideographic Description Characters":function(b){return b>=12272&&b<=12287},"CJK Symbols and Punctuation":function(b){return b>=12288&&b<=12351},Hiragana:function(b){return b>=12352&&b<=12447},Katakana:function(b){return b>=12448&&b<=12543},Bopomofo:function(b){return b>=12544&&b<=12591},"Hangul Compatibility Jamo":function(b){return b>=12592&&b<=12687},Kanbun:function(b){return b>=12688&&b<=12703},"Bopomofo Extended":function(b){return b>=12704&&b<=12735},"CJK Strokes":function(b){return b>=12736&&b<=12783},"Katakana Phonetic Extensions":function(b){return b>=12784&&b<=12799},"Enclosed CJK Letters and Months":function(b){return b>=12800&&b<=13055},"CJK Compatibility":function(b){return b>=13056&&b<=13311},"CJK Unified Ideographs Extension A":function(b){return b>=13312&&b<=19903},"Yijing Hexagram Symbols":function(b){return b>=19904&&b<=19967},"CJK Unified Ideographs":function(b){return b>=19968&&b<=40959},"Yi Syllables":function(b){return b>=40960&&b<=42127},"Yi Radicals":function(b){return b>=42128&&b<=42191},"Hangul Jamo Extended-A":function(b){return b>=43360&&b<=43391},"Hangul Syllables":function(b){return b>=44032&&b<=55215},"Hangul Jamo Extended-B":function(b){return b>=55216&&b<=55295},"Private Use Area":function(b){return b>=57344&&b<=63743},"CJK Compatibility Ideographs":function(b){return b>=63744&&b<=64255},"Arabic Presentation Forms-A":function(b){return b>=64336&&b<=65023},"Vertical Forms":function(b){return b>=65040&&b<=65055},"CJK Compatibility Forms":function(b){return b>=65072&&b<=65103},"Small Form Variants":function(b){return b>=65104&&b<=65135},"Arabic Presentation Forms-B":function(b){return b>=65136&&b<=65279},"Halfwidth and Fullwidth Forms":function(b){return b>=65280&&b<=65519}};function Da(b){for(var I=0,G=b;I<G.length;I+=1)if(da(G[I].charCodeAt(0)))return!0;return!1}function Sa(b){return!Mn.Arabic(b)&&!Mn["Arabic Supplement"](b)&&!Mn["Arabic Extended-A"](b)&&!Mn["Arabic Presentation Forms-A"](b)&&!Mn["Arabic Presentation Forms-B"](b)}function da(b){return b===746||b===747||!(b<4352)&&(!!Mn["Bopomofo Extended"](b)||!!Mn.Bopomofo(b)||!(!Mn["CJK Compatibility Forms"](b)||b>=65097&&b<=65103)||!!Mn["CJK Compatibility Ideographs"](b)||!!Mn["CJK Compatibility"](b)||!!Mn["CJK Radicals Supplement"](b)||!!Mn["CJK Strokes"](b)||!(!Mn["CJK Symbols and Punctuation"](b)||b>=12296&&b<=12305||b>=12308&&b<=12319||b===12336)||!!Mn["CJK Unified Ideographs Extension A"](b)||!!Mn["CJK Unified Ideographs"](b)||!!Mn["Enclosed CJK Letters and Months"](b)||!!Mn["Hangul Compatibility Jamo"](b)||!!Mn["Hangul Jamo Extended-A"](b)||!!Mn["Hangul Jamo Extended-B"](b)||!!Mn["Hangul Jamo"](b)||!!Mn["Hangul Syllables"](b)||!!Mn.Hiragana(b)||!!Mn["Ideographic Description Characters"](b)||!!Mn.Kanbun(b)||!!Mn["Kangxi Radicals"](b)||!!Mn["Katakana Phonetic Extensions"](b)||!(!Mn.Katakana(b)||b===12540)||!(!Mn["Halfwidth and Fullwidth Forms"](b)||b===65288||b===65289||b===65293||b>=65306&&b<=65310||b===65339||b===65341||b===65343||b>=65371&&b<=65503||b===65507||b>=65512&&b<=65519)||!(!Mn["Small Form Variants"](b)||b>=65112&&b<=65118||b>=65123&&b<=65126)||!!Mn["Unified Canadian Aboriginal Syllabics"](b)||!!Mn["Unified Canadian Aboriginal Syllabics Extended"](b)||!!Mn["Vertical Forms"](b)||!!Mn["Yijing Hexagram Symbols"](b)||!!Mn["Yi Syllables"](b)||!!Mn["Yi Radicals"](b))}function za(b){return!(da(b)||function(I){return!(!Mn["Latin-1 Supplement"](I)||I!==167&&I!==169&&I!==174&&I!==177&&I!==188&&I!==189&&I!==190&&I!==215&&I!==247)||!(!Mn["General Punctuation"](I)||I!==8214&&I!==8224&&I!==8225&&I!==8240&&I!==8241&&I!==8251&&I!==8252&&I!==8258&&I!==8263&&I!==8264&&I!==8265&&I!==8273)||!!Mn["Letterlike Symbols"](I)||!!Mn["Number Forms"](I)||!(!Mn["Miscellaneous Technical"](I)||!(I>=8960&&I<=8967||I>=8972&&I<=8991||I>=8996&&I<=9e3||I===9003||I>=9085&&I<=9114||I>=9150&&I<=9165||I===9167||I>=9169&&I<=9179||I>=9186&&I<=9215))||!(!Mn["Control Pictures"](I)||I===9251)||!!Mn["Optical Character Recognition"](I)||!!Mn["Enclosed Alphanumerics"](I)||!!Mn["Geometric Shapes"](I)||!(!Mn["Miscellaneous Symbols"](I)||I>=9754&&I<=9759)||!(!Mn["Miscellaneous Symbols and Arrows"](I)||!(I>=11026&&I<=11055||I>=11088&&I<=11097||I>=11192&&I<=11243))||!!Mn["CJK Symbols and Punctuation"](I)||!!Mn.Katakana(I)||!!Mn["Private Use Area"](I)||!!Mn["CJK Compatibility Forms"](I)||!!Mn["Small Form Variants"](I)||!!Mn["Halfwidth and Fullwidth Forms"](I)||I===8734||I===8756||I===8757||I>=9984&&I<=10087||I>=10102&&I<=10131||I===65532||I===65533}(b))}function Aa(b){return b>=1424&&b<=2303||Mn["Arabic Presentation Forms-A"](b)||Mn["Arabic Presentation Forms-B"](b)}function ti(b,I){return!(!I&&Aa(b))&&!(b>=2304&&b<=3583||b>=3840&&b<=4255||Mn.Khmer(b))}function Qn(b){for(var I=0,G=b;I<G.length;I+=1)if(Aa(G[I].charCodeAt(0)))return!0;return!1}var Za="deferred",Hi="loading",cs="loaded",Xo="error",Eo=null,va="unavailable",yi=null,Co=function(b){b&&typeof b=="string"&&b.indexOf("NetworkError")>-1&&(va=Xo),Eo&&Eo(b)};function Ka(){Si.fire(new _e("pluginStateChange",{pluginStatus:va,pluginURL:yi}))}var Si=new Le,Zi=function(){return va},ai=function(){if(va!==Za||!yi)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");va=Hi,Ka(),yi&&_t({url:yi},function(b){b?Co(b):(va=cs,Ka())})},yo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return va===cs||yo.applyArabicShaping!=null},isLoading:function(){return va===Hi},setState:function(b){va=b.pluginStatus,yi=b.pluginURL},isParsed:function(){return yo.applyArabicShaping!=null&&yo.processBidirectionalText!=null&&yo.processStyledBidirectionalText!=null},getPluginURL:function(){return yi}},ii=function(b,I){this.zoom=b,I?(this.now=I.now,this.fadeDuration=I.fadeDuration,this.zoomHistory=I.zoomHistory,this.transition=I.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ca,this.transition={})};ii.prototype.isSupportedScript=function(b){return function(I,G){for(var re=0,fe=I;re<fe.length;re+=1)if(!ti(fe[re].charCodeAt(0),G))return!1;return!0}(b,yo.isLoaded())},ii.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ii.prototype.getCrossfadeParameters=function(){var b=this.zoom,I=b-Math.floor(b),G=this.crossFadingFactor();return b>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:I+(1-I)*G}:{fromScale:.5,toScale:1,t:1-(1-G)*I}};var so=function(b,I){this.property=b,this.value=I,this.expression=function(G,re){if(Re(G))return new yr(G,re);if($t(G)){var fe=mr(G,re);if(fe.result==="error")throw new Error(fe.value.map(function(Ae){return Ae.key+": "+Ae.message}).join(", "));return fe.value}var me=G;return typeof G=="string"&&re.type==="color"&&(me=ur.parse(G)),{kind:"constant",evaluate:function(){return me}}}(I===void 0?b.specification.default:I,b.specification)};so.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},so.prototype.possiblyEvaluate=function(b,I,G){return this.property.possiblyEvaluate(this,b,I,G)};var Ms=function(b){this.property=b,this.value=new so(b,void 0)};Ms.prototype.transitioned=function(b,I){return new pl(this.property,this.value,I,g({},b.transition,this.transition),b.now)},Ms.prototype.untransitioned=function(){return new pl(this.property,this.value,null,{},0)};var ys=function(b){this._properties=b,this._values=Object.create(b.defaultTransitionablePropertyValues)};ys.prototype.getValue=function(b){return w(this._values[b].value.value)},ys.prototype.setValue=function(b,I){this._values.hasOwnProperty(b)||(this._values[b]=new Ms(this._values[b].property)),this._values[b].value=new so(this._values[b].property,I===null?void 0:w(I))},ys.prototype.getTransition=function(b){return w(this._values[b].transition)},ys.prototype.setTransition=function(b,I){this._values.hasOwnProperty(b)||(this._values[b]=new Ms(this._values[b].property)),this._values[b].transition=w(I)||void 0},ys.prototype.serialize=function(){for(var b={},I=0,G=Object.keys(this._values);I<G.length;I+=1){var re=G[I],fe=this.getValue(re);fe!==void 0&&(b[re]=fe);var me=this.getTransition(re);me!==void 0&&(b[re+"-transition"]=me)}return b},ys.prototype.transitioned=function(b,I){for(var G=new Bi(this._properties),re=0,fe=Object.keys(this._values);re<fe.length;re+=1){var me=fe[re];G._values[me]=this._values[me].transitioned(b,I._values[me])}return G},ys.prototype.untransitioned=function(){for(var b=new Bi(this._properties),I=0,G=Object.keys(this._values);I<G.length;I+=1){var re=G[I];b._values[re]=this._values[re].untransitioned()}return b};var pl=function(b,I,G,re,fe){this.property=b,this.value=I,this.begin=fe+re.delay||0,this.end=this.begin+re.duration||0,b.specification.transition&&(re.delay||re.duration)&&(this.prior=G)};pl.prototype.possiblyEvaluate=function(b,I,G){var re=b.now||0,fe=this.value.possiblyEvaluate(b,I,G),me=this.prior;if(me){if(re>this.end)return this.prior=null,fe;if(this.value.isDataDriven())return this.prior=null,fe;if(re<this.begin)return me.possiblyEvaluate(b,I,G);var Ae=(re-this.begin)/(this.end-this.begin);return this.property.interpolate(me.possiblyEvaluate(b,I,G),fe,function(De){if(De<=0)return 0;if(De>=1)return 1;var Ze=De*De,ut=Ze*De;return 4*(De<.5?ut:3*(De-Ze)+ut-.75)}(Ae))}return fe};var Bi=function(b){this._properties=b,this._values=Object.create(b.defaultTransitioningPropertyValues)};Bi.prototype.possiblyEvaluate=function(b,I,G){for(var re=new xs(this._properties),fe=0,me=Object.keys(this._values);fe<me.length;fe+=1){var Ae=me[fe];re._values[Ae]=this._values[Ae].possiblyEvaluate(b,I,G)}return re},Bi.prototype.hasTransition=function(){for(var b=0,I=Object.keys(this._values);b<I.length;b+=1){var G=I[b];if(this._values[G].prior)return!0}return!1};var dl=function(b){this._properties=b,this._values=Object.create(b.defaultPropertyValues)};dl.prototype.getValue=function(b){return w(this._values[b].value)},dl.prototype.setValue=function(b,I){this._values[b]=new so(this._values[b].property,I===null?void 0:w(I))},dl.prototype.serialize=function(){for(var b={},I=0,G=Object.keys(this._values);I<G.length;I+=1){var re=G[I],fe=this.getValue(re);fe!==void 0&&(b[re]=fe)}return b},dl.prototype.possiblyEvaluate=function(b,I,G){for(var re=new xs(this._properties),fe=0,me=Object.keys(this._values);fe<me.length;fe+=1){var Ae=me[fe];re._values[Ae]=this._values[Ae].possiblyEvaluate(b,I,G)}return re};var Ni=function(b,I,G){this.property=b,this.value=I,this.parameters=G};Ni.prototype.isConstant=function(){return this.value.kind==="constant"},Ni.prototype.constantOr=function(b){return this.value.kind==="constant"?this.value.value:b},Ni.prototype.evaluate=function(b,I,G,re){return this.property.evaluate(this.value,this.parameters,b,I,G,re)};var xs=function(b){this._properties=b,this._values=Object.create(b.defaultPossiblyEvaluatedValues)};xs.prototype.get=function(b){return this._values[b]};var la=function(b){this.specification=b};la.prototype.possiblyEvaluate=function(b,I){return b.expression.evaluate(I)},la.prototype.interpolate=function(b,I,G){var re=yn[this.specification.type];return re?re(b,I,G):b};var ya=function(b,I){this.specification=b,this.overrides=I};ya.prototype.possiblyEvaluate=function(b,I,G,re){return b.expression.kind==="constant"||b.expression.kind==="camera"?new Ni(this,{kind:"constant",value:b.expression.evaluate(I,null,{},G,re)},I):new Ni(this,b.expression,I)},ya.prototype.interpolate=function(b,I,G){if(b.value.kind!=="constant"||I.value.kind!=="constant")return b;if(b.value.value===void 0||I.value.value===void 0)return new Ni(this,{kind:"constant",value:void 0},b.parameters);var re=yn[this.specification.type];return re?new Ni(this,{kind:"constant",value:re(b.value.value,I.value.value,G)},b.parameters):b},ya.prototype.evaluate=function(b,I,G,re,fe,me){return b.kind==="constant"?b.value:b.evaluate(I,G,re,fe,me)};var ml=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.possiblyEvaluate=function(G,re,fe,me){if(G.value===void 0)return new Ni(this,{kind:"constant",value:void 0},re);if(G.expression.kind==="constant"){var Ae=G.expression.evaluate(re,null,{},fe,me),De=G.property.specification.type==="resolvedImage"&&typeof Ae!="string"?Ae.name:Ae,Ze=this._calculate(De,De,De,re);return new Ni(this,{kind:"constant",value:Ze},re)}if(G.expression.kind==="camera"){var ut=this._calculate(G.expression.evaluate({zoom:re.zoom-1}),G.expression.evaluate({zoom:re.zoom}),G.expression.evaluate({zoom:re.zoom+1}),re);return new Ni(this,{kind:"constant",value:ut},re)}return new Ni(this,G.expression,re)},I.prototype.evaluate=function(G,re,fe,me,Ae,De){if(G.kind==="source"){var Ze=G.evaluate(re,fe,me,Ae,De);return this._calculate(Ze,Ze,Ze,re)}return G.kind==="composite"?this._calculate(G.evaluate({zoom:Math.floor(re.zoom)-1},fe,me),G.evaluate({zoom:Math.floor(re.zoom)},fe,me),G.evaluate({zoom:Math.floor(re.zoom)+1},fe,me),re):G.value},I.prototype._calculate=function(G,re,fe,me){return me.zoom>me.zoomHistory.lastIntegerZoom?{from:G,to:re}:{from:fe,to:re}},I.prototype.interpolate=function(G){return G},I}(ya),vl=function(b){this.specification=b};vl.prototype.possiblyEvaluate=function(b,I,G,re){if(b.value!==void 0){if(b.expression.kind==="constant"){var fe=b.expression.evaluate(I,null,{},G,re);return this._calculate(fe,fe,fe,I)}return this._calculate(b.expression.evaluate(new ii(Math.floor(I.zoom-1),I)),b.expression.evaluate(new ii(Math.floor(I.zoom),I)),b.expression.evaluate(new ii(Math.floor(I.zoom+1),I)),I)}},vl.prototype._calculate=function(b,I,G,re){return re.zoom>re.zoomHistory.lastIntegerZoom?{from:b,to:I}:{from:G,to:I}},vl.prototype.interpolate=function(b){return b};var bs=function(b){this.specification=b};bs.prototype.possiblyEvaluate=function(b,I,G,re){return!!b.expression.evaluate(I,null,{},G,re)},bs.prototype.interpolate=function(){return!1};var Go=function(b){for(var I in this.properties=b,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],b){var G=b[I];G.specification.overridable&&this.overridableProperties.push(I);var re=this.defaultPropertyValues[I]=new so(G,void 0),fe=this.defaultTransitionablePropertyValues[I]=new Ms(G);this.defaultTransitioningPropertyValues[I]=fe.untransitioned(),this.defaultPossiblyEvaluatedValues[I]=re.possiblyEvaluate({})}};Xr("DataDrivenProperty",ya),Xr("DataConstantProperty",la),Xr("CrossFadedDataDrivenProperty",ml),Xr("CrossFadedProperty",vl),Xr("ColorRampProperty",bs);var is=function(b){function I(G,re){if(b.call(this),this.id=G.id,this.type=G.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},G.type!=="custom"&&(G=G,this.metadata=G.metadata,this.minzoom=G.minzoom,this.maxzoom=G.maxzoom,G.type!=="background"&&(this.source=G.source,this.sourceLayer=G["source-layer"],this.filter=G.filter),re.layout&&(this._unevaluatedLayout=new dl(re.layout)),re.paint)){for(var fe in this._transitionablePaint=new ys(re.paint),G.paint)this.setPaintProperty(fe,G.paint[fe],{validate:!1});for(var me in G.layout)this.setLayoutProperty(me,G.layout[me],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new xs(re.paint)}}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},I.prototype.getLayoutProperty=function(G){return G==="visibility"?this.visibility:this._unevaluatedLayout.getValue(G)},I.prototype.setLayoutProperty=function(G,re,fe){if(fe===void 0&&(fe={}),re!=null){var me="layers."+this.id+".layout."+G;if(this._validate(mn,me,G,re,fe))return}G!=="visibility"?this._unevaluatedLayout.setValue(G,re):this.visibility=re},I.prototype.getPaintProperty=function(G){return T(G,"-transition")?this._transitionablePaint.getTransition(G.slice(0,-"-transition".length)):this._transitionablePaint.getValue(G)},I.prototype.setPaintProperty=function(G,re,fe){if(fe===void 0&&(fe={}),re!=null){var me="layers."+this.id+".paint."+G;if(this._validate(on,me,G,re,fe))return!1}if(T(G,"-transition"))return this._transitionablePaint.setTransition(G.slice(0,-"-transition".length),re||void 0),!1;var Ae=this._transitionablePaint._values[G],De=Ae.property.specification["property-type"]==="cross-faded-data-driven",Ze=Ae.value.isDataDriven(),ut=Ae.value;this._transitionablePaint.setValue(G,re),this._handleSpecialPaintPropertyUpdate(G);var gt=this._transitionablePaint._values[G].value;return gt.isDataDriven()||Ze||De||this._handleOverridablePaintPropertyUpdate(G,ut,gt)},I.prototype._handleSpecialPaintPropertyUpdate=function(G){},I.prototype._handleOverridablePaintPropertyUpdate=function(G,re,fe){return!1},I.prototype.isHidden=function(G){return!!(this.minzoom&&G<this.minzoom)||!!(this.maxzoom&&G>=this.maxzoom)||this.visibility==="none"},I.prototype.updateTransitions=function(G){this._transitioningPaint=this._transitionablePaint.transitioned(G,this._transitioningPaint)},I.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},I.prototype.recalculate=function(G,re){G.getCrossfadeParameters&&(this._crossfadeParameters=G.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(G,void 0,re)),this.paint=this._transitioningPaint.possiblyEvaluate(G,void 0,re)},I.prototype.serialize=function(){var G={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(G.layout=G.layout||{},G.layout.visibility=this.visibility),S(G,function(re,fe){return!(re===void 0||fe==="layout"&&!Object.keys(re).length||fe==="paint"&&!Object.keys(re).length)})},I.prototype._validate=function(G,re,fe,me,Ae){return Ae===void 0&&(Ae={}),(!Ae||Ae.validate!==!1)&&wn(this,G.call(Yr,{key:re,layerType:this.type,objectKey:fe,value:me,styleSpec:Pe,style:{glyphs:!0,sprite:!0}}))},I.prototype.is3D=function(){return!1},I.prototype.isTileClipped=function(){return!1},I.prototype.hasOffscreenPass=function(){return!1},I.prototype.resize=function(){},I.prototype.isStateDependent=function(){for(var G in this.paint._values){var re=this.paint.get(G);if(re instanceof Ni&&as(re.property.specification)&&(re.value.kind==="source"||re.value.kind==="composite")&&re.value.isStateDependent)return!0}return!1},I}(Le),Il={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},$s=function(b,I){this._structArray=b,this._pos1=I*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Ja=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function oi(b,I){I===void 0&&(I=1);var G=0,re=0;return{members:b.map(function(fe){var me,Ae=(me=fe.type,Il[me].BYTES_PER_ELEMENT),De=G=Rs(G,Math.max(I,Ae)),Ze=fe.components||1;return re=Math.max(re,Ae),G+=Ae*Ze,{name:fe.name,type:fe.type,components:Ze,offset:De}}),size:Rs(G,Math.max(re,I)),alignment:I}}function Rs(b,I){return Math.ceil(b/I)*I}Ja.serialize=function(b,I){return b._trim(),I&&(b.isTransferred=!0,I.push(b.arrayBuffer)),{length:b.length,arrayBuffer:b.arrayBuffer}},Ja.deserialize=function(b){var I=Object.create(this.prototype);return I.arrayBuffer=b.arrayBuffer,I.length=b.length,I.capacity=b.arrayBuffer.byteLength/I.bytesPerElement,I._refreshViews(),I},Ja.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Ja.prototype.clear=function(){this.length=0},Ja.prototype.resize=function(b){this.reserve(b),this.length=b},Ja.prototype.reserve=function(b){if(b>this.capacity){this.capacity=Math.max(b,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var I=this.uint8;this._refreshViews(),I&&this.uint8.set(I)}},Ja.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Ss=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re){var fe=this.length;return this.resize(fe+1),this.emplace(fe,G,re)},I.prototype.emplace=function(G,re,fe){var me=2*G;return this.int16[me+0]=re,this.int16[me+1]=fe,G},I}(Ja);Ss.prototype.bytesPerElement=4,Xr("StructArrayLayout2i4",Ss);var Di=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re,fe,me){var Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,G,re,fe,me)},I.prototype.emplace=function(G,re,fe,me,Ae){var De=4*G;return this.int16[De+0]=re,this.int16[De+1]=fe,this.int16[De+2]=me,this.int16[De+3]=Ae,G},I}(Ja);Di.prototype.bytesPerElement=8,Xr("StructArrayLayout4i8",Di);var Fs=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re,fe,me,Ae,De){var Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,G,re,fe,me,Ae,De)},I.prototype.emplace=function(G,re,fe,me,Ae,De,Ze){var ut=6*G;return this.int16[ut+0]=re,this.int16[ut+1]=fe,this.int16[ut+2]=me,this.int16[ut+3]=Ae,this.int16[ut+4]=De,this.int16[ut+5]=Ze,G},I}(Ja);Fs.prototype.bytesPerElement=12,Xr("StructArrayLayout2i4i12",Fs);var Qs=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re,fe,me,Ae,De){var Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,G,re,fe,me,Ae,De)},I.prototype.emplace=function(G,re,fe,me,Ae,De,Ze){var ut=4*G,gt=8*G;return this.int16[ut+0]=re,this.int16[ut+1]=fe,this.uint8[gt+4]=me,this.uint8[gt+5]=Ae,this.uint8[gt+6]=De,this.uint8[gt+7]=Ze,G},I}(Ja);Qs.prototype.bytesPerElement=8,Xr("StructArrayLayout2i4ub8",Qs);var Gs=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re,fe,me,Ae,De,Ze,ut,gt,Bt){var Wt=this.length;return this.resize(Wt+1),this.emplace(Wt,G,re,fe,me,Ae,De,Ze,ut,gt,Bt)},I.prototype.emplace=function(G,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt){var Ht=9*G,ar=18*G;return this.uint16[Ht+0]=re,this.uint16[Ht+1]=fe,this.uint16[Ht+2]=me,this.uint16[Ht+3]=Ae,this.uint16[Ht+4]=De,this.uint16[Ht+5]=Ze,this.uint16[Ht+6]=ut,this.uint16[Ht+7]=gt,this.uint8[ar+16]=Bt,this.uint8[ar+17]=Wt,G},I}(Ja);Gs.prototype.bytesPerElement=18,Xr("StructArrayLayout8ui2ub18",Gs);var el=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht){var ar=this.length;return this.resize(ar+1),this.emplace(ar,G,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht)},I.prototype.emplace=function(G,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar){var gr=12*G;return this.int16[gr+0]=re,this.int16[gr+1]=fe,this.int16[gr+2]=me,this.int16[gr+3]=Ae,this.uint16[gr+4]=De,this.uint16[gr+5]=Ze,this.uint16[gr+6]=ut,this.uint16[gr+7]=gt,this.int16[gr+8]=Bt,this.int16[gr+9]=Wt,this.int16[gr+10]=Ht,this.int16[gr+11]=ar,G},I}(Ja);el.prototype.bytesPerElement=24,Xr("StructArrayLayout4i4ui4i24",el);var Es=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re,fe){var me=this.length;return this.resize(me+1),this.emplace(me,G,re,fe)},I.prototype.emplace=function(G,re,fe,me){var Ae=3*G;return this.float32[Ae+0]=re,this.float32[Ae+1]=fe,this.float32[Ae+2]=me,G},I}(Ja);Es.prototype.bytesPerElement=12,Xr("StructArrayLayout3f12",Es);var Ol=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G){var re=this.length;return this.resize(re+1),this.emplace(re,G)},I.prototype.emplace=function(G,re){var fe=1*G;return this.uint32[fe+0]=re,G},I}(Ja);Ol.prototype.bytesPerElement=4,Xr("StructArrayLayout1ul4",Ol);var Xl=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re,fe,me,Ae,De,Ze,ut,gt){var Bt=this.length;return this.resize(Bt+1),this.emplace(Bt,G,re,fe,me,Ae,De,Ze,ut,gt)},I.prototype.emplace=function(G,re,fe,me,Ae,De,Ze,ut,gt,Bt){var Wt=10*G,Ht=5*G;return this.int16[Wt+0]=re,this.int16[Wt+1]=fe,this.int16[Wt+2]=me,this.int16[Wt+3]=Ae,this.int16[Wt+4]=De,this.int16[Wt+5]=Ze,this.uint32[Ht+3]=ut,this.uint16[Wt+8]=gt,this.uint16[Wt+9]=Bt,G},I}(Ja);Xl.prototype.bytesPerElement=20,Xr("StructArrayLayout6i1ul2ui20",Xl);var Bs=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re,fe,me,Ae,De){var Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,G,re,fe,me,Ae,De)},I.prototype.emplace=function(G,re,fe,me,Ae,De,Ze){var ut=6*G;return this.int16[ut+0]=re,this.int16[ut+1]=fe,this.int16[ut+2]=me,this.int16[ut+3]=Ae,this.int16[ut+4]=De,this.int16[ut+5]=Ze,G},I}(Ja);Bs.prototype.bytesPerElement=12,Xr("StructArrayLayout2i2i2i12",Bs);var Dl=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re,fe,me,Ae){var De=this.length;return this.resize(De+1),this.emplace(De,G,re,fe,me,Ae)},I.prototype.emplace=function(G,re,fe,me,Ae,De){var Ze=4*G,ut=8*G;return this.float32[Ze+0]=re,this.float32[Ze+1]=fe,this.float32[Ze+2]=me,this.int16[ut+6]=Ae,this.int16[ut+7]=De,G},I}(Ja);Dl.prototype.bytesPerElement=16,Xr("StructArrayLayout2f1f2i16",Dl);var tl=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re,fe,me){var Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,G,re,fe,me)},I.prototype.emplace=function(G,re,fe,me,Ae){var De=12*G,Ze=3*G;return this.uint8[De+0]=re,this.uint8[De+1]=fe,this.float32[Ze+1]=me,this.float32[Ze+2]=Ae,G},I}(Ja);tl.prototype.bytesPerElement=12,Xr("StructArrayLayout2ub2f12",tl);var lo=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re,fe){var me=this.length;return this.resize(me+1),this.emplace(me,G,re,fe)},I.prototype.emplace=function(G,re,fe,me){var Ae=3*G;return this.uint16[Ae+0]=re,this.uint16[Ae+1]=fe,this.uint16[Ae+2]=me,G},I}(Ja);lo.prototype.bytesPerElement=6,Xr("StructArrayLayout3ui6",lo);var Zl=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar,gr,Cr,Er,Fr){var Br=this.length;return this.resize(Br+1),this.emplace(Br,G,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar,gr,Cr,Er,Fr)},I.prototype.emplace=function(G,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar,gr,Cr,Er,Fr,Br){var Hr=24*G,fn=12*G,xn=48*G;return this.int16[Hr+0]=re,this.int16[Hr+1]=fe,this.uint16[Hr+2]=me,this.uint16[Hr+3]=Ae,this.uint32[fn+2]=De,this.uint32[fn+3]=Ze,this.uint32[fn+4]=ut,this.uint16[Hr+10]=gt,this.uint16[Hr+11]=Bt,this.uint16[Hr+12]=Wt,this.float32[fn+7]=Ht,this.float32[fn+8]=ar,this.uint8[xn+36]=gr,this.uint8[xn+37]=Cr,this.uint8[xn+38]=Er,this.uint32[fn+10]=Fr,this.int16[Hr+22]=Br,G},I}(Ja);Zl.prototype.bytesPerElement=48,Xr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Zl);var Kl=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar,gr,Cr,Er,Fr,Br,Hr,fn,xn,Nn,Fn,qn,na,ia,Zn,ha){var ca=this.length;return this.resize(ca+1),this.emplace(ca,G,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar,gr,Cr,Er,Fr,Br,Hr,fn,xn,Nn,Fn,qn,na,ia,Zn,ha)},I.prototype.emplace=function(G,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar,gr,Cr,Er,Fr,Br,Hr,fn,xn,Nn,Fn,qn,na,ia,Zn,ha,ca){var oa=34*G,$a=17*G;return this.int16[oa+0]=re,this.int16[oa+1]=fe,this.int16[oa+2]=me,this.int16[oa+3]=Ae,this.int16[oa+4]=De,this.int16[oa+5]=Ze,this.int16[oa+6]=ut,this.int16[oa+7]=gt,this.uint16[oa+8]=Bt,this.uint16[oa+9]=Wt,this.uint16[oa+10]=Ht,this.uint16[oa+11]=ar,this.uint16[oa+12]=gr,this.uint16[oa+13]=Cr,this.uint16[oa+14]=Er,this.uint16[oa+15]=Fr,this.uint16[oa+16]=Br,this.uint16[oa+17]=Hr,this.uint16[oa+18]=fn,this.uint16[oa+19]=xn,this.uint16[oa+20]=Nn,this.uint16[oa+21]=Fn,this.uint16[oa+22]=qn,this.uint32[$a+12]=na,this.float32[$a+13]=ia,this.float32[$a+14]=Zn,this.float32[$a+15]=ha,this.float32[$a+16]=ca,G},I}(Ja);Kl.prototype.bytesPerElement=68,Xr("StructArrayLayout8i15ui1ul4f68",Kl);var oe=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G){var re=this.length;return this.resize(re+1),this.emplace(re,G)},I.prototype.emplace=function(G,re){var fe=1*G;return this.float32[fe+0]=re,G},I}(Ja);oe.prototype.bytesPerElement=4,Xr("StructArrayLayout1f4",oe);var E=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re,fe){var me=this.length;return this.resize(me+1),this.emplace(me,G,re,fe)},I.prototype.emplace=function(G,re,fe,me){var Ae=3*G;return this.int16[Ae+0]=re,this.int16[Ae+1]=fe,this.int16[Ae+2]=me,G},I}(Ja);E.prototype.bytesPerElement=6,Xr("StructArrayLayout3i6",E);var R=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re,fe){var me=this.length;return this.resize(me+1),this.emplace(me,G,re,fe)},I.prototype.emplace=function(G,re,fe,me){var Ae=2*G,De=4*G;return this.uint32[Ae+0]=re,this.uint16[De+2]=fe,this.uint16[De+3]=me,G},I}(Ja);R.prototype.bytesPerElement=8,Xr("StructArrayLayout1ul2ui8",R);var F=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re){var fe=this.length;return this.resize(fe+1),this.emplace(fe,G,re)},I.prototype.emplace=function(G,re,fe){var me=2*G;return this.uint16[me+0]=re,this.uint16[me+1]=fe,G},I}(Ja);F.prototype.bytesPerElement=4,Xr("StructArrayLayout2ui4",F);var V=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G){var re=this.length;return this.resize(re+1),this.emplace(re,G)},I.prototype.emplace=function(G,re){var fe=1*G;return this.uint16[fe+0]=re,G},I}(Ja);V.prototype.bytesPerElement=2,Xr("StructArrayLayout1ui2",V);var ne=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re){var fe=this.length;return this.resize(fe+1),this.emplace(fe,G,re)},I.prototype.emplace=function(G,re,fe){var me=2*G;return this.float32[me+0]=re,this.float32[me+1]=fe,G},I}(Ja);ne.prototype.bytesPerElement=8,Xr("StructArrayLayout2f8",ne);var le=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},I.prototype.emplaceBack=function(G,re,fe,me){var Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,G,re,fe,me)},I.prototype.emplace=function(G,re,fe,me,Ae){var De=4*G;return this.float32[De+0]=re,this.float32[De+1]=fe,this.float32[De+2]=me,this.float32[De+3]=Ae,G},I}(Ja);le.prototype.bytesPerElement=16,Xr("StructArrayLayout4f16",le);var pe=function(b){function I(){b.apply(this,arguments)}b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I;var G={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return G.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},G.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},G.x1.get=function(){return this._structArray.int16[this._pos2+2]},G.y1.get=function(){return this._structArray.int16[this._pos2+3]},G.x2.get=function(){return this._structArray.int16[this._pos2+4]},G.y2.get=function(){return this._structArray.int16[this._pos2+5]},G.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},G.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},G.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},G.anchorPoint.get=function(){return new l(this.anchorPointX,this.anchorPointY)},Object.defineProperties(I.prototype,G),I}($s);pe.prototype.size=20;var ye=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.get=function(G){return new pe(this,G)},I}(Xl);Xr("CollisionBoxArray",ye);var Te=function(b){function I(){b.apply(this,arguments)}b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I;var G={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return G.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},G.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},G.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},G.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},G.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},G.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},G.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},G.segment.get=function(){return this._structArray.uint16[this._pos2+10]},G.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},G.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},G.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},G.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},G.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},G.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},G.placedOrientation.set=function(re){this._structArray.uint8[this._pos1+37]=re},G.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},G.hidden.set=function(re){this._structArray.uint8[this._pos1+38]=re},G.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},G.crossTileID.set=function(re){this._structArray.uint32[this._pos4+10]=re},G.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(I.prototype,G),I}($s);Te.prototype.size=48;var Ne=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.get=function(G){return new Te(this,G)},I}(Zl);Xr("PlacedSymbolArray",Ne);var Ge=function(b){function I(){b.apply(this,arguments)}b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I;var G={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return G.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},G.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},G.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},G.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},G.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},G.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},G.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},G.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},G.key.get=function(){return this._structArray.uint16[this._pos2+8]},G.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},G.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},G.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},G.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},G.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},G.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},G.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},G.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},G.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},G.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},G.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},G.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},G.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},G.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},G.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},G.crossTileID.set=function(re){this._structArray.uint32[this._pos4+12]=re},G.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},G.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},G.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},G.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(I.prototype,G),I}($s);Ge.prototype.size=68;var nt=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.get=function(G){return new Ge(this,G)},I}(Kl);Xr("SymbolInstanceArray",nt);var bt=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.getoffsetX=function(G){return this.float32[1*G+0]},I}(oe);Xr("GlyphOffsetArray",bt);var Ct=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.getx=function(G){return this.int16[3*G+0]},I.prototype.gety=function(G){return this.int16[3*G+1]},I.prototype.gettileUnitDistanceFromAnchor=function(G){return this.int16[3*G+2]},I}(E);Xr("SymbolLineVertexArray",Ct);var Tt=function(b){function I(){b.apply(this,arguments)}b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I;var G={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return G.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},G.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},G.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(I.prototype,G),I}($s);Tt.prototype.size=8;var At=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.get=function(G){return new Tt(this,G)},I}(R);Xr("FeatureIndexArray",At);var yt=oi([{name:"a_pos",components:2,type:"Int16"}],4).members,Ft=function(b){b===void 0&&(b=[]),this.segments=b};function zt(b,I){return 256*(b=n(Math.floor(b),0,255))+(I=n(Math.floor(I),0,255))}Ft.prototype.prepareSegment=function(b,I,G,re){var fe=this.segments[this.segments.length-1];return b>Ft.MAX_VERTEX_ARRAY_LENGTH&&k("Max vertices per segment is "+Ft.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+b),(!fe||fe.vertexLength+b>Ft.MAX_VERTEX_ARRAY_LENGTH||fe.sortKey!==re)&&(fe={vertexOffset:I.length,primitiveOffset:G.length,vertexLength:0,primitiveLength:0},re!==void 0&&(fe.sortKey=re),this.segments.push(fe)),fe},Ft.prototype.get=function(){return this.segments},Ft.prototype.destroy=function(){for(var b=0,I=this.segments;b<I.length;b+=1){var G=I[b];for(var re in G.vaos)G.vaos[re].destroy()}},Ft.simpleSegment=function(b,I,G,re){return new Ft([{vertexOffset:b,primitiveOffset:I,vertexLength:G,primitiveLength:re,vaos:{},sortKey:0}])},Ft.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Xr("SegmentVector",Ft);var jt=oi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),rr=f(function(b){b.exports=function(I,G){var re,fe,me,Ae,De,Ze,ut,gt;for(re=3&I.length,fe=I.length-re,me=G,De=3432918353,Ze=461845907,gt=0;gt<fe;)ut=255&I.charCodeAt(gt)|(255&I.charCodeAt(++gt))<<8|(255&I.charCodeAt(++gt))<<16|(255&I.charCodeAt(++gt))<<24,++gt,me=27492+(65535&(Ae=5*(65535&(me=(me^=ut=(65535&(ut=(ut=(65535&ut)*De+(((ut>>>16)*De&65535)<<16)&4294967295)<<15|ut>>>17))*Ze+(((ut>>>16)*Ze&65535)<<16)&4294967295)<<13|me>>>19))+((5*(me>>>16)&65535)<<16)&4294967295))+((58964+(Ae>>>16)&65535)<<16);switch(ut=0,re){case 3:ut^=(255&I.charCodeAt(gt+2))<<16;case 2:ut^=(255&I.charCodeAt(gt+1))<<8;case 1:me^=ut=(65535&(ut=(ut=(65535&(ut^=255&I.charCodeAt(gt)))*De+(((ut>>>16)*De&65535)<<16)&4294967295)<<15|ut>>>17))*Ze+(((ut>>>16)*Ze&65535)<<16)&4294967295}return me^=I.length,me=2246822507*(65535&(me^=me>>>16))+((2246822507*(me>>>16)&65535)<<16)&4294967295,me=3266489909*(65535&(me^=me>>>13))+((3266489909*(me>>>16)&65535)<<16)&4294967295,(me^=me>>>16)>>>0}}),hr=f(function(b){b.exports=function(I,G){for(var re,fe=I.length,me=G^fe,Ae=0;fe>=4;)re=1540483477*(65535&(re=255&I.charCodeAt(Ae)|(255&I.charCodeAt(++Ae))<<8|(255&I.charCodeAt(++Ae))<<16|(255&I.charCodeAt(++Ae))<<24))+((1540483477*(re>>>16)&65535)<<16),me=1540483477*(65535&me)+((1540483477*(me>>>16)&65535)<<16)^(re=1540483477*(65535&(re^=re>>>24))+((1540483477*(re>>>16)&65535)<<16)),fe-=4,++Ae;switch(fe){case 3:me^=(255&I.charCodeAt(Ae+2))<<16;case 2:me^=(255&I.charCodeAt(Ae+1))<<8;case 1:me=1540483477*(65535&(me^=255&I.charCodeAt(Ae)))+((1540483477*(me>>>16)&65535)<<16)}return me=1540483477*(65535&(me^=me>>>13))+((1540483477*(me>>>16)&65535)<<16),(me^=me>>>15)>>>0}}),Ar=rr,kr=rr,Kr=hr;Ar.murmur3=kr,Ar.murmur2=Kr;var Zr=function(){this.ids=[],this.positions=[],this.indexed=!1};Zr.prototype.add=function(b,I,G,re){this.ids.push(sn(b)),this.positions.push(I,G,re)},Zr.prototype.getPositions=function(b){for(var I=sn(b),G=0,re=this.ids.length-1;G<re;){var fe=G+re>>1;this.ids[fe]>=I?re=fe:G=fe+1}for(var me=[];this.ids[G]===I;){var Ae=this.positions[3*G],De=this.positions[3*G+1],Ze=this.positions[3*G+2];me.push({index:Ae,start:De,end:Ze}),G++}return me},Zr.serialize=function(b,I){var G=new Float64Array(b.ids),re=new Uint32Array(b.positions);return function fe(me,Ae,De,Ze){for(;De<Ze;){for(var ut=me[De+Ze>>1],gt=De-1,Bt=Ze+1;;){do gt++;while(me[gt]<ut);do Bt--;while(me[Bt]>ut);if(gt>=Bt)break;Un(me,gt,Bt),Un(Ae,3*gt,3*Bt),Un(Ae,3*gt+1,3*Bt+1),Un(Ae,3*gt+2,3*Bt+2)}Bt-De<Ze-Bt?(fe(me,Ae,De,Bt),De=Bt+1):(fe(me,Ae,Bt+1,Ze),Ze=Bt)}}(G,re,0,G.length-1),I&&I.push(G.buffer,re.buffer),{ids:G,positions:re}},Zr.deserialize=function(b){var I=new Zr;return I.ids=b.ids,I.positions=b.positions,I.indexed=!0,I};var hn=Math.pow(2,53)-1;function sn(b){var I=+b;return!isNaN(I)&&I<=hn?I:Ar(String(b))}function Un(b,I,G){var re=b[I];b[I]=b[G],b[G]=re}Xr("FeaturePositionMap",Zr);var Wn=function(b,I){this.gl=b.gl,this.location=I},ua=function(b){function I(G,re){b.call(this,G,re),this.current=0}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.set=function(G){this.current!==G&&(this.current=G,this.gl.uniform1i(this.location,G))},I}(Wn),Ur=function(b){function I(G,re){b.call(this,G,re),this.current=0}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.set=function(G){this.current!==G&&(this.current=G,this.gl.uniform1f(this.location,G))},I}(Wn),kn=function(b){function I(G,re){b.call(this,G,re),this.current=[0,0]}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.set=function(G){G[0]===this.current[0]&&G[1]===this.current[1]||(this.current=G,this.gl.uniform2f(this.location,G[0],G[1]))},I}(Wn),Xn=function(b){function I(G,re){b.call(this,G,re),this.current=[0,0,0]}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.set=function(G){G[0]===this.current[0]&&G[1]===this.current[1]&&G[2]===this.current[2]||(this.current=G,this.gl.uniform3f(this.location,G[0],G[1],G[2]))},I}(Wn),Gn=function(b){function I(G,re){b.call(this,G,re),this.current=[0,0,0,0]}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.set=function(G){G[0]===this.current[0]&&G[1]===this.current[1]&&G[2]===this.current[2]&&G[3]===this.current[3]||(this.current=G,this.gl.uniform4f(this.location,G[0],G[1],G[2],G[3]))},I}(Wn),ea=function(b){function I(G,re){b.call(this,G,re),this.current=ur.transparent}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.set=function(G){G.r===this.current.r&&G.g===this.current.g&&G.b===this.current.b&&G.a===this.current.a||(this.current=G,this.gl.uniform4f(this.location,G.r,G.g,G.b,G.a))},I}(Wn),fa=new Float32Array(16),Ma=function(b){function I(G,re){b.call(this,G,re),this.current=fa}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.set=function(G){if(G[12]!==this.current[12]||G[0]!==this.current[0])return this.current=G,void this.gl.uniformMatrix4fv(this.location,!1,G);for(var re=1;re<16;re++)if(G[re]!==this.current[re]){this.current=G,this.gl.uniformMatrix4fv(this.location,!1,G);break}},I}(Wn);function Kn(b){return[zt(255*b.r,255*b.g),zt(255*b.b,255*b.a)]}var xa=function(b,I,G){this.value=b,this.uniformNames=I.map(function(re){return"u_"+re}),this.type=G};xa.prototype.setUniform=function(b,I,G){b.set(G.constantOr(this.value))},xa.prototype.getBinding=function(b,I,G){return this.type==="color"?new ea(b,I):new Ur(b,I)};var ma=function(b,I){this.uniformNames=I.map(function(G){return"u_"+G}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ma.prototype.setConstantPatternPositions=function(b,I){this.pixelRatioFrom=I.pixelRatio,this.pixelRatioTo=b.pixelRatio,this.patternFrom=I.tlbr,this.patternTo=b.tlbr},ma.prototype.setUniform=function(b,I,G,re){var fe=re==="u_pattern_to"?this.patternTo:re==="u_pattern_from"?this.patternFrom:re==="u_pixel_ratio_to"?this.pixelRatioTo:re==="u_pixel_ratio_from"?this.pixelRatioFrom:null;fe&&b.set(fe)},ma.prototype.getBinding=function(b,I,G){return G.substr(0,9)==="u_pattern"?new Gn(b,I):new Ur(b,I)};var La=function(b,I,G,re){this.expression=b,this.type=G,this.maxValue=0,this.paintVertexAttributes=I.map(function(fe){return{name:"a_"+fe,type:"Float32",components:G==="color"?2:1,offset:0}}),this.paintVertexArray=new re};La.prototype.populatePaintArray=function(b,I,G,re,fe){var me=this.paintVertexArray.length,Ae=this.expression.evaluate(new ii(0),I,{},re,[],fe);this.paintVertexArray.resize(b),this._setPaintValue(me,b,Ae)},La.prototype.updatePaintArray=function(b,I,G,re){var fe=this.expression.evaluate({zoom:0},G,re);this._setPaintValue(b,I,fe)},La.prototype._setPaintValue=function(b,I,G){if(this.type==="color")for(var re=Kn(G),fe=b;fe<I;fe++)this.paintVertexArray.emplace(fe,re[0],re[1]);else{for(var me=b;me<I;me++)this.paintVertexArray.emplace(me,G);this.maxValue=Math.max(this.maxValue,Math.abs(G))}},La.prototype.upload=function(b){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=b.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},La.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var ba=function(b,I,G,re,fe,me){this.expression=b,this.uniformNames=I.map(function(Ae){return"u_"+Ae+"_t"}),this.type=G,this.useIntegerZoom=re,this.zoom=fe,this.maxValue=0,this.paintVertexAttributes=I.map(function(Ae){return{name:"a_"+Ae,type:"Float32",components:G==="color"?4:2,offset:0}}),this.paintVertexArray=new me};ba.prototype.populatePaintArray=function(b,I,G,re,fe){var me=this.expression.evaluate(new ii(this.zoom),I,{},re,[],fe),Ae=this.expression.evaluate(new ii(this.zoom+1),I,{},re,[],fe),De=this.paintVertexArray.length;this.paintVertexArray.resize(b),this._setPaintValue(De,b,me,Ae)},ba.prototype.updatePaintArray=function(b,I,G,re){var fe=this.expression.evaluate({zoom:this.zoom},G,re),me=this.expression.evaluate({zoom:this.zoom+1},G,re);this._setPaintValue(b,I,fe,me)},ba.prototype._setPaintValue=function(b,I,G,re){if(this.type==="color")for(var fe=Kn(G),me=Kn(re),Ae=b;Ae<I;Ae++)this.paintVertexArray.emplace(Ae,fe[0],fe[1],me[0],me[1]);else{for(var De=b;De<I;De++)this.paintVertexArray.emplace(De,G,re);this.maxValue=Math.max(this.maxValue,Math.abs(G),Math.abs(re))}},ba.prototype.upload=function(b){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=b.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ba.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ba.prototype.setUniform=function(b,I){var G=this.useIntegerZoom?Math.floor(I.zoom):I.zoom,re=n(this.expression.interpolationFactor(G,this.zoom,this.zoom+1),0,1);b.set(re)},ba.prototype.getBinding=function(b,I,G){return new Ur(b,I)};var Pa=function(b,I,G,re,fe,me){this.expression=b,this.type=I,this.useIntegerZoom=G,this.zoom=re,this.layerId=me,this.zoomInPaintVertexArray=new fe,this.zoomOutPaintVertexArray=new fe};Pa.prototype.populatePaintArray=function(b,I,G){var re=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(b),this.zoomOutPaintVertexArray.resize(b),this._setPaintValues(re,b,I.patterns&&I.patterns[this.layerId],G)},Pa.prototype.updatePaintArray=function(b,I,G,re,fe){this._setPaintValues(b,I,G.patterns&&G.patterns[this.layerId],fe)},Pa.prototype._setPaintValues=function(b,I,G,re){if(re&&G){var fe=G.min,me=G.mid,Ae=G.max,De=re[fe],Ze=re[me],ut=re[Ae];if(De&&Ze&&ut)for(var gt=b;gt<I;gt++)this.zoomInPaintVertexArray.emplace(gt,Ze.tl[0],Ze.tl[1],Ze.br[0],Ze.br[1],De.tl[0],De.tl[1],De.br[0],De.br[1],Ze.pixelRatio,De.pixelRatio),this.zoomOutPaintVertexArray.emplace(gt,Ze.tl[0],Ze.tl[1],Ze.br[0],Ze.br[1],ut.tl[0],ut.tl[1],ut.br[0],ut.br[1],Ze.pixelRatio,ut.pixelRatio)}},Pa.prototype.upload=function(b){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=b.createVertexBuffer(this.zoomInPaintVertexArray,jt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=b.createVertexBuffer(this.zoomOutPaintVertexArray,jt.members,this.expression.isStateDependent))},Pa.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ua=function(b,I,G,re){this.binders={},this.layoutAttributes=re,this._buffers=[];var fe=[];for(var me in b.paint._values)if(G(me)){var Ae=b.paint.get(me);if(Ae instanceof Ni&&as(Ae.property.specification)){var De=zi(me,b.type),Ze=Ae.value,ut=Ae.property.specification.type,gt=Ae.property.useIntegerZoom,Bt=Ae.property.specification["property-type"],Wt=Bt==="cross-faded"||Bt==="cross-faded-data-driven";if(Ze.kind==="constant")this.binders[me]=Wt?new ma(Ze.value,De):new xa(Ze.value,De,ut),fe.push("/u_"+me);else if(Ze.kind==="source"||Wt){var Ht=Ri(me,ut,"source");this.binders[me]=Wt?new Pa(Ze,ut,gt,I,Ht,b.id):new La(Ze,De,ut,Ht),fe.push("/a_"+me)}else{var ar=Ri(me,ut,"composite");this.binders[me]=new ba(Ze,De,ut,gt,I,ar),fe.push("/z_"+me)}}}this.cacheKey=fe.sort().join("")};Ua.prototype.getMaxValue=function(b){var I=this.binders[b];return I instanceof La||I instanceof ba?I.maxValue:0},Ua.prototype.populatePaintArrays=function(b,I,G,re,fe){for(var me in this.binders){var Ae=this.binders[me];(Ae instanceof La||Ae instanceof ba||Ae instanceof Pa)&&Ae.populatePaintArray(b,I,G,re,fe)}},Ua.prototype.setConstantPatternPositions=function(b,I){for(var G in this.binders){var re=this.binders[G];re instanceof ma&&re.setConstantPatternPositions(b,I)}},Ua.prototype.updatePaintArrays=function(b,I,G,re,fe){var me=!1;for(var Ae in b)for(var De=0,Ze=I.getPositions(Ae);De<Ze.length;De+=1){var ut=Ze[De],gt=G.feature(ut.index);for(var Bt in this.binders){var Wt=this.binders[Bt];if((Wt instanceof La||Wt instanceof ba||Wt instanceof Pa)&&Wt.expression.isStateDependent===!0){var Ht=re.paint.get(Bt);Wt.expression=Ht.value,Wt.updatePaintArray(ut.start,ut.end,gt,b[Ae],fe),me=!0}}}return me},Ua.prototype.defines=function(){var b=[];for(var I in this.binders){var G=this.binders[I];(G instanceof xa||G instanceof ma)&&b.push.apply(b,G.uniformNames.map(function(re){return"#define HAS_UNIFORM_"+re}))}return b},Ua.prototype.getPaintVertexBuffers=function(){return this._buffers},Ua.prototype.getUniforms=function(b,I){var G=[];for(var re in this.binders){var fe=this.binders[re];if(fe instanceof xa||fe instanceof ma||fe instanceof ba)for(var me=0,Ae=fe.uniformNames;me<Ae.length;me+=1){var De=Ae[me];if(I[De]){var Ze=fe.getBinding(b,I[De],De);G.push({name:De,property:re,binding:Ze})}}}return G},Ua.prototype.setUniforms=function(b,I,G,re){for(var fe=0,me=I;fe<me.length;fe+=1){var Ae=me[fe],De=Ae.name,Ze=Ae.property,ut=Ae.binding;this.binders[Ze].setUniform(ut,re,G.get(Ze),De)}},Ua.prototype.updatePaintBuffers=function(b){for(var I in this._buffers=[],this.binders){var G=this.binders[I];if(b&&G instanceof Pa){var re=b.fromScale===2?G.zoomInPaintVertexBuffer:G.zoomOutPaintVertexBuffer;re&&this._buffers.push(re)}else(G instanceof La||G instanceof ba)&&G.paintVertexBuffer&&this._buffers.push(G.paintVertexBuffer)}},Ua.prototype.upload=function(b){for(var I in this.binders){var G=this.binders[I];(G instanceof La||G instanceof ba||G instanceof Pa)&&G.upload(b)}this.updatePaintBuffers()},Ua.prototype.destroy=function(){for(var b in this.binders){var I=this.binders[b];(I instanceof La||I instanceof ba||I instanceof Pa)&&I.destroy()}};var di=function(b,I,G,re){re===void 0&&(re=function(){return!0}),this.programConfigurations={};for(var fe=0,me=I;fe<me.length;fe+=1){var Ae=me[fe];this.programConfigurations[Ae.id]=new Ua(Ae,G,re,b)}this.needsUpload=!1,this._featureMap=new Zr,this._bufferOffset=0};function zi(b,I){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[b]||[b.replace(I+"-","").replace(/-/g,"_")]}function Ri(b,I,G){var re={color:{source:ne,composite:le},number:{source:oe,composite:ne}},fe=function(me){return{"line-pattern":{source:Gs,composite:Gs},"fill-pattern":{source:Gs,composite:Gs},"fill-extrusion-pattern":{source:Gs,composite:Gs}}[me]}(b);return fe&&fe[G]||re[I][G]}di.prototype.populatePaintArrays=function(b,I,G,re,fe,me){for(var Ae in this.programConfigurations)this.programConfigurations[Ae].populatePaintArrays(b,I,re,fe,me);I.id!==void 0&&this._featureMap.add(I.id,G,this._bufferOffset,b),this._bufferOffset=b,this.needsUpload=!0},di.prototype.updatePaintArrays=function(b,I,G,re){for(var fe=0,me=G;fe<me.length;fe+=1){var Ae=me[fe];this.needsUpload=this.programConfigurations[Ae.id].updatePaintArrays(b,this._featureMap,I,Ae,re)||this.needsUpload}},di.prototype.get=function(b){return this.programConfigurations[b]},di.prototype.upload=function(b){if(this.needsUpload){for(var I in this.programConfigurations)this.programConfigurations[I].upload(b);this.needsUpload=!1}},di.prototype.destroy=function(){for(var b in this.programConfigurations)this.programConfigurations[b].destroy()},Xr("ConstantBinder",xa),Xr("CrossFadedConstantBinder",ma),Xr("SourceExpressionBinder",La),Xr("CrossFadedCompositeBinder",Pa),Xr("CompositeExpressionBinder",ba),Xr("ProgramConfiguration",Ua,{omit:["_buffers"]}),Xr("ProgramConfigurationSet",di);var pi,Ei=(pi=15,{min:-1*Math.pow(2,pi-1),max:Math.pow(2,pi-1)-1});function xi(b){for(var I=8192/b.extent,G=b.loadGeometry(),re=0;re<G.length;re++)for(var fe=G[re],me=0;me<fe.length;me++){var Ae=fe[me];Ae.x=Math.round(Ae.x*I),Ae.y=Math.round(Ae.y*I),(Ae.x<Ei.min||Ae.x>Ei.max||Ae.y<Ei.min||Ae.y>Ei.max)&&(k("Geometry exceeds allowed extent, reduce your vector tile buffer size"),Ae.x=n(Ae.x,Ei.min,Ei.max),Ae.y=n(Ae.y,Ei.min,Ei.max))}return G}function Lo(b,I,G,re,fe){b.emplaceBack(2*I+(re+1)/2,2*G+(fe+1)/2)}var Ki=function(b){this.zoom=b.zoom,this.overscaling=b.overscaling,this.layers=b.layers,this.layerIds=this.layers.map(function(I){return I.id}),this.index=b.index,this.hasPattern=!1,this.layoutVertexArray=new Ss,this.indexArray=new lo,this.segments=new Ft,this.programConfigurations=new di(yt,b.layers,b.zoom),this.stateDependentLayerIds=this.layers.filter(function(I){return I.isStateDependent()}).map(function(I){return I.id})};function Zo(b,I){for(var G=0;G<b.length;G++)if(_s(I,b[G]))return!0;for(var re=0;re<I.length;re++)if(_s(b,I[re]))return!0;return!!zl(b,I)}function qs(b,I,G){return!!_s(b,I)||!!Po(I,b,G)}function yl(b,I){if(b.length===1)return $l(I,b[0]);for(var G=0;G<I.length;G++)for(var re=I[G],fe=0;fe<re.length;fe++)if(_s(b,re[fe]))return!0;for(var me=0;me<b.length;me++)if($l(I,b[me]))return!0;for(var Ae=0;Ae<I.length;Ae++)if(zl(b,I[Ae]))return!0;return!1}function Jl(b,I,G){if(b.length>1){if(zl(b,I))return!0;for(var re=0;re<I.length;re++)if(Po(I[re],b,G))return!0}for(var fe=0;fe<b.length;fe++)if(Po(b[fe],I,G))return!0;return!1}function zl(b,I){if(b.length===0||I.length===0)return!1;for(var G=0;G<b.length-1;G++)for(var re=b[G],fe=b[G+1],me=0;me<I.length-1;me++)if(Rl(re,fe,I[me],I[me+1]))return!0;return!1}function Rl(b,I,G,re){return L(b,G,re)!==L(I,G,re)&&L(b,I,G)!==L(b,I,re)}function Po(b,I,G){var re=G*G;if(I.length===1)return b.distSqr(I[0])<re;for(var fe=1;fe<I.length;fe++)if(Tl(b,I[fe-1],I[fe])<re)return!0;return!1}function Tl(b,I,G){var re=I.distSqr(G);if(re===0)return b.distSqr(I);var fe=((b.x-I.x)*(G.x-I.x)+(b.y-I.y)*(G.y-I.y))/re;return fe<0?b.distSqr(I):fe>1?b.distSqr(G):b.distSqr(G.sub(I)._mult(fe)._add(I))}function $l(b,I){for(var G,re,fe,me=!1,Ae=0;Ae<b.length;Ae++)for(var De=0,Ze=(G=b[Ae]).length-1;De<G.length;Ze=De++)re=G[De],fe=G[Ze],re.y>I.y!=fe.y>I.y&&I.x<(fe.x-re.x)*(I.y-re.y)/(fe.y-re.y)+re.x&&(me=!me);return me}function _s(b,I){for(var G=!1,re=0,fe=b.length-1;re<b.length;fe=re++){var me=b[re],Ae=b[fe];me.y>I.y!=Ae.y>I.y&&I.x<(Ae.x-me.x)*(I.y-me.y)/(Ae.y-me.y)+me.x&&(G=!G)}return G}function Ql(b,I,G){var re=G[0],fe=G[2];if(b.x<re.x&&I.x<re.x||b.x>fe.x&&I.x>fe.x||b.y<re.y&&I.y<re.y||b.y>fe.y&&I.y>fe.y)return!1;var me=L(b,I,G[0]);return me!==L(b,I,G[1])||me!==L(b,I,G[2])||me!==L(b,I,G[3])}function Ci(b,I,G){var re=I.paint.get(b).value;return re.kind==="constant"?re.value:G.programConfigurations.get(I.id).getMaxValue(b)}function qo(b){return Math.sqrt(b[0]*b[0]+b[1]*b[1])}function Yo(b,I,G,re,fe){if(!I[0]&&!I[1])return b;var me=l.convert(I)._mult(fe);G==="viewport"&&me._rotate(-re);for(var Ae=[],De=0;De<b.length;De++){var Ze=b[De];Ae.push(Ze.sub(me))}return Ae}Ki.prototype.populate=function(b,I,G){var re=this.layers[0],fe=[],me=null;re.type==="circle"&&(me=re.layout.get("circle-sort-key"));for(var Ae=0,De=b;Ae<De.length;Ae+=1){var Ze=De[Ae],ut=Ze.feature,gt=Ze.id,Bt=Ze.index,Wt=Ze.sourceLayerIndex,Ht=this.layers[0]._featureFilter.needGeometry,ar={type:ut.type,id:gt,properties:ut.properties,geometry:Ht?xi(ut):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),ar,G)){Ht||(ar.geometry=xi(ut));var gr=me?me.evaluate(ar,{},G):void 0,Cr={id:gt,properties:ut.properties,type:ut.type,sourceLayerIndex:Wt,index:Bt,geometry:ar.geometry,patterns:{},sortKey:gr};fe.push(Cr)}}me&&fe.sort(function(qn,na){return qn.sortKey-na.sortKey});for(var Er=0,Fr=fe;Er<Fr.length;Er+=1){var Br=Fr[Er],Hr=Br,fn=Hr.geometry,xn=Hr.index,Nn=Hr.sourceLayerIndex,Fn=b[xn].feature;this.addFeature(Br,fn,xn,G),I.featureIndex.insert(Fn,fn,xn,Nn,this.index)}},Ki.prototype.update=function(b,I,G){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(b,I,this.stateDependentLayers,G)},Ki.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ki.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ki.prototype.upload=function(b){this.uploaded||(this.layoutVertexBuffer=b.createVertexBuffer(this.layoutVertexArray,yt),this.indexBuffer=b.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(b),this.uploaded=!0},Ki.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ki.prototype.addFeature=function(b,I,G,re){for(var fe=0,me=I;fe<me.length;fe+=1)for(var Ae=0,De=me[fe];Ae<De.length;Ae+=1){var Ze=De[Ae],ut=Ze.x,gt=Ze.y;if(!(ut<0||ut>=8192||gt<0||gt>=8192)){var Bt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,b.sortKey),Wt=Bt.vertexLength;Lo(this.layoutVertexArray,ut,gt,-1,-1),Lo(this.layoutVertexArray,ut,gt,1,-1),Lo(this.layoutVertexArray,ut,gt,1,1),Lo(this.layoutVertexArray,ut,gt,-1,1),this.indexArray.emplaceBack(Wt,Wt+1,Wt+2),this.indexArray.emplaceBack(Wt,Wt+3,Wt+2),Bt.vertexLength+=4,Bt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,b,G,{},re)},Xr("CircleBucket",Ki,{omit:["layers"]});var du=new Go({"circle-sort-key":new ya(Pe.layout_circle["circle-sort-key"])}),Uf={paint:new Go({"circle-radius":new ya(Pe.paint_circle["circle-radius"]),"circle-color":new ya(Pe.paint_circle["circle-color"]),"circle-blur":new ya(Pe.paint_circle["circle-blur"]),"circle-opacity":new ya(Pe.paint_circle["circle-opacity"]),"circle-translate":new la(Pe.paint_circle["circle-translate"]),"circle-translate-anchor":new la(Pe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new la(Pe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new la(Pe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ya(Pe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ya(Pe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ya(Pe.paint_circle["circle-stroke-opacity"])}),layout:du},fs=typeof Float32Array!="undefined"?Float32Array:Array;function Yu(b){return b[0]=1,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=1,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[10]=1,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,b}function eu(b,I,G){var re=I[0],fe=I[1],me=I[2],Ae=I[3],De=I[4],Ze=I[5],ut=I[6],gt=I[7],Bt=I[8],Wt=I[9],Ht=I[10],ar=I[11],gr=I[12],Cr=I[13],Er=I[14],Fr=I[15],Br=G[0],Hr=G[1],fn=G[2],xn=G[3];return b[0]=Br*re+Hr*De+fn*Bt+xn*gr,b[1]=Br*fe+Hr*Ze+fn*Wt+xn*Cr,b[2]=Br*me+Hr*ut+fn*Ht+xn*Er,b[3]=Br*Ae+Hr*gt+fn*ar+xn*Fr,Br=G[4],Hr=G[5],fn=G[6],xn=G[7],b[4]=Br*re+Hr*De+fn*Bt+xn*gr,b[5]=Br*fe+Hr*Ze+fn*Wt+xn*Cr,b[6]=Br*me+Hr*ut+fn*Ht+xn*Er,b[7]=Br*Ae+Hr*gt+fn*ar+xn*Fr,Br=G[8],Hr=G[9],fn=G[10],xn=G[11],b[8]=Br*re+Hr*De+fn*Bt+xn*gr,b[9]=Br*fe+Hr*Ze+fn*Wt+xn*Cr,b[10]=Br*me+Hr*ut+fn*Ht+xn*Er,b[11]=Br*Ae+Hr*gt+fn*ar+xn*Fr,Br=G[12],Hr=G[13],fn=G[14],xn=G[15],b[12]=Br*re+Hr*De+fn*Bt+xn*gr,b[13]=Br*fe+Hr*Ze+fn*Wt+xn*Cr,b[14]=Br*me+Hr*ut+fn*Ht+xn*Er,b[15]=Br*Ae+Hr*gt+fn*ar+xn*Fr,b}Math.hypot||(Math.hypot=function(){for(var b=arguments,I=0,G=arguments.length;G--;)I+=b[G]*b[G];return Math.sqrt(I)});var Vf=eu,kl,Hf=function(b,I,G){return b[0]=I[0]-G[0],b[1]=I[1]-G[1],b[2]=I[2]-G[2],b};kl=new fs(3),fs!=Float32Array&&(kl[0]=0,kl[1]=0,kl[2]=0);function gu(b,I,G){var re=I[0],fe=I[1],me=I[2],Ae=I[3];return b[0]=G[0]*re+G[4]*fe+G[8]*me+G[12]*Ae,b[1]=G[1]*re+G[5]*fe+G[9]*me+G[13]*Ae,b[2]=G[2]*re+G[6]*fe+G[10]*me+G[14]*Ae,b[3]=G[3]*re+G[7]*fe+G[11]*me+G[15]*Ae,b}(function(){(function(){var b=new fs(4);return fs!=Float32Array&&(b[0]=0,b[1]=0,b[2]=0,b[3]=0),b})()})();var Wu=function(b){var I=b[0],G=b[1];return I*I+G*G},t0=(function(){(function(){var b=new fs(2);return fs!=Float32Array&&(b[0]=0,b[1]=0),b})()}(),function(b){function I(G){b.call(this,G,Uf)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.createBucket=function(G){return new Ki(G)},I.prototype.queryRadius=function(G){var re=G;return Ci("circle-radius",this,re)+Ci("circle-stroke-width",this,re)+qo(this.paint.get("circle-translate"))},I.prototype.queryIntersectsFeature=function(G,re,fe,me,Ae,De,Ze,ut){for(var gt=Yo(G,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),De.angle,Ze),Bt=this.paint.get("circle-radius").evaluate(re,fe)+this.paint.get("circle-stroke-width").evaluate(re,fe),Wt=this.paint.get("circle-pitch-alignment")==="map",Ht=Wt?gt:function(Nn,Fn){return Nn.map(function(qn){return Wh(qn,Fn)})}(gt,ut),ar=Wt?Bt*Ze:Bt,gr=0,Cr=me;gr<Cr.length;gr+=1)for(var Er=0,Fr=Cr[gr];Er<Fr.length;Er+=1){var Br=Fr[Er],Hr=Wt?Br:Wh(Br,ut),fn=ar,xn=gu([],[Br.x,Br.y,0,1],ut);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?fn*=xn[3]/De.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(fn*=De.cameraToCenterDistance/xn[3]),qs(Ht,Hr,fn))return!0}return!1},I}(is));function Wh(b,I){var G=gu([],[b.x,b.y,0,1],I);return new l(G[0]/G[3],G[1]/G[3])}var Xh=function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I}(Ki);function Gf(b,I,G,re){var fe=I.width,me=I.height;if(re){if(re instanceof Uint8ClampedArray)re=new Uint8Array(re.buffer);else if(re.length!==fe*me*G)throw new RangeError("mismatched image size")}else re=new Uint8Array(fe*me*G);return b.width=fe,b.height=me,b.data=re,b}function Zh(b,I,G){var re=I.width,fe=I.height;if(re!==b.width||fe!==b.height){var me=Gf({},{width:re,height:fe},G);qf(b,me,{x:0,y:0},{x:0,y:0},{width:Math.min(b.width,re),height:Math.min(b.height,fe)},G),b.width=re,b.height=fe,b.data=me.data}}function qf(b,I,G,re,fe,me){if(fe.width===0||fe.height===0)return I;if(fe.width>b.width||fe.height>b.height||G.x>b.width-fe.width||G.y>b.height-fe.height)throw new RangeError("out of range source coordinates for image copy");if(fe.width>I.width||fe.height>I.height||re.x>I.width-fe.width||re.y>I.height-fe.height)throw new RangeError("out of range destination coordinates for image copy");for(var Ae=b.data,De=I.data,Ze=0;Ze<fe.height;Ze++)for(var ut=((G.y+Ze)*b.width+G.x)*me,gt=((re.y+Ze)*I.width+re.x)*me,Bt=0;Bt<fe.width*me;Bt++)De[gt+Bt]=Ae[ut+Bt];return I}Xr("HeatmapBucket",Xh,{omit:["layers"]});var tu=function(b,I){Gf(this,b,1,I)};tu.prototype.resize=function(b){Zh(this,b,1)},tu.prototype.clone=function(){return new tu({width:this.width,height:this.height},new Uint8Array(this.data))},tu.copy=function(b,I,G,re,fe){qf(b,I,G,re,fe,1)};var hs=function(b,I){Gf(this,b,4,I)};hs.prototype.resize=function(b){Zh(this,b,4)},hs.prototype.replace=function(b,I){I?this.data.set(b):b instanceof Uint8ClampedArray?this.data=new Uint8Array(b.buffer):this.data=b},hs.prototype.clone=function(){return new hs({width:this.width,height:this.height},new Uint8Array(this.data))},hs.copy=function(b,I,G,re,fe){qf(b,I,G,re,fe,4)},Xr("AlphaImage",tu),Xr("RGBAImage",hs);var r0={paint:new Go({"heatmap-radius":new ya(Pe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ya(Pe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new la(Pe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new bs(Pe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new la(Pe.paint_heatmap["heatmap-opacity"])})};function Kh(b,I){for(var G=new Uint8Array(1024),re={},fe=0,me=0;fe<256;fe++,me+=4){re[I]=fe/255;var Ae=b.evaluate(re);G[me+0]=Math.floor(255*Ae.r/Ae.a),G[me+1]=Math.floor(255*Ae.g/Ae.a),G[me+2]=Math.floor(255*Ae.b/Ae.a),G[me+3]=Math.floor(255*Ae.a)}return new hs({width:256,height:1},G)}var n0=function(b){function I(G){b.call(this,G,r0),this._updateColorRamp()}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.createBucket=function(G){return new Xh(G)},I.prototype._handleSpecialPaintPropertyUpdate=function(G){G==="heatmap-color"&&this._updateColorRamp()},I.prototype._updateColorRamp=function(){var G=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Kh(G,"heatmapDensity"),this.colorRampTexture=null},I.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},I.prototype.queryRadius=function(){return 0},I.prototype.queryIntersectsFeature=function(){return!1},I.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},I}(is),a0={paint:new Go({"hillshade-illumination-direction":new la(Pe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new la(Pe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new la(Pe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new la(Pe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new la(Pe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new la(Pe.paint_hillshade["hillshade-accent-color"])})},i0=function(b){function I(G){b.call(this,G,a0)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},I}(is),Jh=oi([{name:"a_pos",components:2,type:"Int16"}],4).members,Yf=Pc,o0=Pc;function Pc(b,I,G){G=G||2;var re,fe,me,Ae,De,Ze,ut,gt=I&&I.length,Bt=gt?I[0]*G:b.length,Wt=$h(b,0,Bt,G,!0),Ht=[];if(!Wt||Wt.next===Wt.prev)return Ht;if(gt&&(Wt=function(gr,Cr,Er,Fr){var Br,Hr,fn,xn,Nn,Fn=[];for(Br=0,Hr=Cr.length;Br<Hr;Br++)fn=Cr[Br]*Fr,xn=Br<Hr-1?Cr[Br+1]*Fr:gr.length,(Nn=$h(gr,fn,xn,Fr,!1))===Nn.next&&(Nn.steiner=!0),Fn.push(d0(Nn));for(Fn.sort(f0),Br=0;Br<Fn.length;Br++)h0(Fn[Br],Er),Er=Fl(Er,Er.next);return Er}(b,I,Wt,G)),b.length>80*G){re=me=b[0],fe=Ae=b[1];for(var ar=G;ar<Bt;ar+=G)(De=b[ar])<re&&(re=De),(Ze=b[ar+1])<fe&&(fe=Ze),De>me&&(me=De),Ze>Ae&&(Ae=Ze);ut=(ut=Math.max(me-re,Ae-fe))!==0?1/ut:0}return Xu(Wt,Ht,G,re,fe,ut),Ht}function $h(b,I,G,re,fe){var me,Ae;if(fe===Zf(b,I,G,re)>0)for(me=I;me<G;me+=re)Ae=tp(me,b[me],b[me+1],Ae);else for(me=G-re;me>=I;me-=re)Ae=tp(me,b[me],b[me+1],Ae);return Ae&&Ic(Ae,Ae.next)&&(Ku(Ae),Ae=Ae.next),Ae}function Fl(b,I){if(!b)return b;I||(I=b);var G,re=b;do if(G=!1,re.steiner||!Ic(re,re.next)&&uo(re.prev,re,re.next)!==0)re=re.next;else{if(Ku(re),(re=I=re.prev)===re.next)break;G=!0}while(G||re!==I);return I}function Xu(b,I,G,re,fe,me,Ae){if(b){!Ae&&me&&function(gt,Bt,Wt,Ht){var ar=gt;do ar.z===null&&(ar.z=Wf(ar.x,ar.y,Bt,Wt,Ht)),ar.prevZ=ar.prev,ar.nextZ=ar.next,ar=ar.next;while(ar!==gt);ar.prevZ.nextZ=null,ar.prevZ=null,function(gr){var Cr,Er,Fr,Br,Hr,fn,xn,Nn,Fn=1;do{for(Er=gr,gr=null,Hr=null,fn=0;Er;){for(fn++,Fr=Er,xn=0,Cr=0;Cr<Fn&&(xn++,Fr=Fr.nextZ);Cr++);for(Nn=Fn;xn>0||Nn>0&&Fr;)xn!==0&&(Nn===0||!Fr||Er.z<=Fr.z)?(Br=Er,Er=Er.nextZ,xn--):(Br=Fr,Fr=Fr.nextZ,Nn--),Hr?Hr.nextZ=Br:gr=Br,Br.prevZ=Hr,Hr=Br;Er=Fr}Hr.nextZ=null,Fn*=2}while(fn>1)}(ar)}(b,re,fe,me);for(var De,Ze,ut=b;b.prev!==b.next;)if(De=b.prev,Ze=b.next,me?l0(b,re,fe,me):s0(b))I.push(De.i/G),I.push(b.i/G),I.push(Ze.i/G),Ku(b),b=Ze.next,ut=Ze.next;else if((b=Ze)===ut){Ae?Ae===1?Xu(b=u0(Fl(b),I,G),I,G,re,fe,me,2):Ae===2&&c0(b,I,G,re,fe,me):Xu(Fl(b),I,G,re,fe,me,1);break}}}function s0(b){var I=b.prev,G=b,re=b.next;if(uo(I,G,re)>=0)return!1;for(var fe=b.next.next;fe!==b.prev;){if(mu(I.x,I.y,G.x,G.y,re.x,re.y,fe.x,fe.y)&&uo(fe.prev,fe,fe.next)>=0)return!1;fe=fe.next}return!0}function l0(b,I,G,re){var fe=b.prev,me=b,Ae=b.next;if(uo(fe,me,Ae)>=0)return!1;for(var De=fe.x<me.x?fe.x<Ae.x?fe.x:Ae.x:me.x<Ae.x?me.x:Ae.x,Ze=fe.y<me.y?fe.y<Ae.y?fe.y:Ae.y:me.y<Ae.y?me.y:Ae.y,ut=fe.x>me.x?fe.x>Ae.x?fe.x:Ae.x:me.x>Ae.x?me.x:Ae.x,gt=fe.y>me.y?fe.y>Ae.y?fe.y:Ae.y:me.y>Ae.y?me.y:Ae.y,Bt=Wf(De,Ze,I,G,re),Wt=Wf(ut,gt,I,G,re),Ht=b.prevZ,ar=b.nextZ;Ht&&Ht.z>=Bt&&ar&&ar.z<=Wt;){if(Ht!==b.prev&&Ht!==b.next&&mu(fe.x,fe.y,me.x,me.y,Ae.x,Ae.y,Ht.x,Ht.y)&&uo(Ht.prev,Ht,Ht.next)>=0||(Ht=Ht.prevZ,ar!==b.prev&&ar!==b.next&&mu(fe.x,fe.y,me.x,me.y,Ae.x,Ae.y,ar.x,ar.y)&&uo(ar.prev,ar,ar.next)>=0))return!1;ar=ar.nextZ}for(;Ht&&Ht.z>=Bt;){if(Ht!==b.prev&&Ht!==b.next&&mu(fe.x,fe.y,me.x,me.y,Ae.x,Ae.y,Ht.x,Ht.y)&&uo(Ht.prev,Ht,Ht.next)>=0)return!1;Ht=Ht.prevZ}for(;ar&&ar.z<=Wt;){if(ar!==b.prev&&ar!==b.next&&mu(fe.x,fe.y,me.x,me.y,Ae.x,Ae.y,ar.x,ar.y)&&uo(ar.prev,ar,ar.next)>=0)return!1;ar=ar.nextZ}return!0}function u0(b,I,G){var re=b;do{var fe=re.prev,me=re.next.next;!Ic(fe,me)&&Qh(fe,re,re.next,me)&&Zu(fe,me)&&Zu(me,fe)&&(I.push(fe.i/G),I.push(re.i/G),I.push(me.i/G),Ku(re),Ku(re.next),re=b=me),re=re.next}while(re!==b);return Fl(re)}function c0(b,I,G,re,fe,me){var Ae=b;do{for(var De=Ae.next.next;De!==Ae.prev;){if(Ae.i!==De.i&&g0(Ae,De)){var Ze=ep(Ae,De);return Ae=Fl(Ae,Ae.next),Ze=Fl(Ze,Ze.next),Xu(Ae,I,G,re,fe,me),void Xu(Ze,I,G,re,fe,me)}De=De.next}Ae=Ae.next}while(Ae!==b)}function f0(b,I){return b.x-I.x}function h0(b,I){if(I=function(re,fe){var me,Ae=fe,De=re.x,Ze=re.y,ut=-1/0;do{if(Ze<=Ae.y&&Ze>=Ae.next.y&&Ae.next.y!==Ae.y){var gt=Ae.x+(Ze-Ae.y)*(Ae.next.x-Ae.x)/(Ae.next.y-Ae.y);if(gt<=De&&gt>ut){if(ut=gt,gt===De){if(Ze===Ae.y)return Ae;if(Ze===Ae.next.y)return Ae.next}me=Ae.x<Ae.next.x?Ae:Ae.next}}Ae=Ae.next}while(Ae!==fe);if(!me)return null;if(De===ut)return me;var Bt,Wt=me,Ht=me.x,ar=me.y,gr=1/0;Ae=me;do De>=Ae.x&&Ae.x>=Ht&&De!==Ae.x&&mu(Ze<ar?De:ut,Ze,Ht,ar,Ze<ar?ut:De,Ze,Ae.x,Ae.y)&&(Bt=Math.abs(Ze-Ae.y)/(De-Ae.x),Zu(Ae,re)&&(Bt<gr||Bt===gr&&(Ae.x>me.x||Ae.x===me.x&&p0(me,Ae)))&&(me=Ae,gr=Bt)),Ae=Ae.next;while(Ae!==Wt);return me}(b,I)){var G=ep(I,b);Fl(I,I.next),Fl(G,G.next)}}function p0(b,I){return uo(b.prev,b,I.prev)<0&&uo(I.next,b,b.next)<0}function Wf(b,I,G,re,fe){return(b=1431655765&((b=858993459&((b=252645135&((b=16711935&((b=32767*(b-G)*fe)|b<<8))|b<<4))|b<<2))|b<<1))|(I=1431655765&((I=858993459&((I=252645135&((I=16711935&((I=32767*(I-re)*fe)|I<<8))|I<<4))|I<<2))|I<<1))<<1}function d0(b){var I=b,G=b;do(I.x<G.x||I.x===G.x&&I.y<G.y)&&(G=I),I=I.next;while(I!==b);return G}function mu(b,I,G,re,fe,me,Ae,De){return(fe-Ae)*(I-De)-(b-Ae)*(me-De)>=0&&(b-Ae)*(re-De)-(G-Ae)*(I-De)>=0&&(G-Ae)*(me-De)-(fe-Ae)*(re-De)>=0}function g0(b,I){return b.next.i!==I.i&&b.prev.i!==I.i&&!function(G,re){var fe=G;do{if(fe.i!==G.i&&fe.next.i!==G.i&&fe.i!==re.i&&fe.next.i!==re.i&&Qh(fe,fe.next,G,re))return!0;fe=fe.next}while(fe!==G);return!1}(b,I)&&(Zu(b,I)&&Zu(I,b)&&function(G,re){var fe=G,me=!1,Ae=(G.x+re.x)/2,De=(G.y+re.y)/2;do fe.y>De!=fe.next.y>De&&fe.next.y!==fe.y&&Ae<(fe.next.x-fe.x)*(De-fe.y)/(fe.next.y-fe.y)+fe.x&&(me=!me),fe=fe.next;while(fe!==G);return me}(b,I)&&(uo(b.prev,b,I.prev)||uo(b,I.prev,I))||Ic(b,I)&&uo(b.prev,b,b.next)>0&&uo(I.prev,I,I.next)>0)}function uo(b,I,G){return(I.y-b.y)*(G.x-I.x)-(I.x-b.x)*(G.y-I.y)}function Ic(b,I){return b.x===I.x&&b.y===I.y}function Qh(b,I,G,re){var fe=Dc(uo(b,I,G)),me=Dc(uo(b,I,re)),Ae=Dc(uo(G,re,b)),De=Dc(uo(G,re,I));return fe!==me&&Ae!==De||!(fe!==0||!Oc(b,G,I))||!(me!==0||!Oc(b,re,I))||!(Ae!==0||!Oc(G,b,re))||!(De!==0||!Oc(G,I,re))}function Oc(b,I,G){return I.x<=Math.max(b.x,G.x)&&I.x>=Math.min(b.x,G.x)&&I.y<=Math.max(b.y,G.y)&&I.y>=Math.min(b.y,G.y)}function Dc(b){return b>0?1:b<0?-1:0}function Zu(b,I){return uo(b.prev,b,b.next)<0?uo(b,I,b.next)>=0&&uo(b,b.prev,I)>=0:uo(b,I,b.prev)<0||uo(b,b.next,I)<0}function ep(b,I){var G=new Xf(b.i,b.x,b.y),re=new Xf(I.i,I.x,I.y),fe=b.next,me=I.prev;return b.next=I,I.prev=b,G.next=fe,fe.prev=G,re.next=G,G.prev=re,me.next=re,re.prev=me,re}function tp(b,I,G,re){var fe=new Xf(b,I,G);return re?(fe.next=re.next,fe.prev=re,re.next.prev=fe,re.next=fe):(fe.prev=fe,fe.next=fe),fe}function Ku(b){b.next.prev=b.prev,b.prev.next=b.next,b.prevZ&&(b.prevZ.nextZ=b.nextZ),b.nextZ&&(b.nextZ.prevZ=b.prevZ)}function Xf(b,I,G){this.i=b,this.x=I,this.y=G,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Zf(b,I,G,re){for(var fe=0,me=I,Ae=G-re;me<G;me+=re)fe+=(b[Ae]-b[me])*(b[me+1]+b[Ae+1]),Ae=me;return fe}function m0(b,I,G,re,fe){(function me(Ae,De,Ze,ut,gt){for(;ut>Ze;){if(ut-Ze>600){var Bt=ut-Ze+1,Wt=De-Ze+1,Ht=Math.log(Bt),ar=.5*Math.exp(2*Ht/3),gr=.5*Math.sqrt(Ht*ar*(Bt-ar)/Bt)*(Wt-Bt/2<0?-1:1),Cr=Math.max(Ze,Math.floor(De-Wt*ar/Bt+gr)),Er=Math.min(ut,Math.floor(De+(Bt-Wt)*ar/Bt+gr));me(Ae,De,Cr,Er,gt)}var Fr=Ae[De],Br=Ze,Hr=ut;for(Ju(Ae,Ze,De),gt(Ae[ut],Fr)>0&&Ju(Ae,Ze,ut);Br<Hr;){for(Ju(Ae,Br,Hr),Br++,Hr--;gt(Ae[Br],Fr)<0;)Br++;for(;gt(Ae[Hr],Fr)>0;)Hr--}gt(Ae[Ze],Fr)===0?Ju(Ae,Ze,Hr):(Hr++,Ju(Ae,Hr,ut)),Hr<=De&&(Ze=Hr+1),De<=Hr&&(ut=Hr-1)}})(b,I,G||0,re||b.length-1,fe||v0)}function Ju(b,I,G){var re=b[I];b[I]=b[G],b[G]=re}function v0(b,I){return b<I?-1:b>I?1:0}function Kf(b,I){var G=b.length;if(G<=1)return[b];for(var re,fe,me=[],Ae=0;Ae<G;Ae++){var De=M(b[Ae]);De!==0&&(b[Ae].area=Math.abs(De),fe===void 0&&(fe=De<0),fe===De<0?(re&&me.push(re),re=[b[Ae]]):re.push(b[Ae]))}if(re&&me.push(re),I>1)for(var Ze=0;Ze<me.length;Ze++)me[Ze].length<=I||(m0(me[Ze],I,1,me[Ze].length-1,y0),me[Ze]=me[Ze].slice(0,I));return me}function y0(b,I){return I.area-b.area}function Jf(b,I,G){for(var re=G.patternDependencies,fe=!1,me=0,Ae=I;me<Ae.length;me+=1){var De=Ae[me].paint.get(b+"-pattern");De.isConstant()||(fe=!0);var Ze=De.constantOr(null);Ze&&(fe=!0,re[Ze.to]=!0,re[Ze.from]=!0)}return fe}function $f(b,I,G,re,fe){for(var me=fe.patternDependencies,Ae=0,De=I;Ae<De.length;Ae+=1){var Ze=De[Ae],ut=Ze.paint.get(b+"-pattern").value;if(ut.kind!=="constant"){var gt=ut.evaluate({zoom:re-1},G,{},fe.availableImages),Bt=ut.evaluate({zoom:re},G,{},fe.availableImages),Wt=ut.evaluate({zoom:re+1},G,{},fe.availableImages);gt=gt&&gt.name?gt.name:gt,Bt=Bt&&Bt.name?Bt.name:Bt,Wt=Wt&&Wt.name?Wt.name:Wt,me[gt]=!0,me[Bt]=!0,me[Wt]=!0,G.patterns[Ze.id]={min:gt,mid:Bt,max:Wt}}}return G}Pc.deviation=function(b,I,G,re){var fe=I&&I.length,me=fe?I[0]*G:b.length,Ae=Math.abs(Zf(b,0,me,G));if(fe)for(var De=0,Ze=I.length;De<Ze;De++){var ut=I[De]*G,gt=De<Ze-1?I[De+1]*G:b.length;Ae-=Math.abs(Zf(b,ut,gt,G))}var Bt=0;for(De=0;De<re.length;De+=3){var Wt=re[De]*G,Ht=re[De+1]*G,ar=re[De+2]*G;Bt+=Math.abs((b[Wt]-b[ar])*(b[Ht+1]-b[Wt+1])-(b[Wt]-b[Ht])*(b[ar+1]-b[Wt+1]))}return Ae===0&&Bt===0?0:Math.abs((Bt-Ae)/Ae)},Pc.flatten=function(b){for(var I=b[0][0].length,G={vertices:[],holes:[],dimensions:I},re=0,fe=0;fe<b.length;fe++){for(var me=0;me<b[fe].length;me++)for(var Ae=0;Ae<I;Ae++)G.vertices.push(b[fe][me][Ae]);fe>0&&(re+=b[fe-1].length,G.holes.push(re))}return G},Yf.default=o0;var rl=function(b){this.zoom=b.zoom,this.overscaling=b.overscaling,this.layers=b.layers,this.layerIds=this.layers.map(function(I){return I.id}),this.index=b.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ss,this.indexArray=new lo,this.indexArray2=new F,this.programConfigurations=new di(Jh,b.layers,b.zoom),this.segments=new Ft,this.segments2=new Ft,this.stateDependentLayerIds=this.layers.filter(function(I){return I.isStateDependent()}).map(function(I){return I.id})};rl.prototype.populate=function(b,I,G){this.hasPattern=Jf("fill",this.layers,I);for(var re=this.layers[0].layout.get("fill-sort-key"),fe=[],me=0,Ae=b;me<Ae.length;me+=1){var De=Ae[me],Ze=De.feature,ut=De.id,gt=De.index,Bt=De.sourceLayerIndex,Wt=this.layers[0]._featureFilter.needGeometry,Ht={type:Ze.type,id:ut,properties:Ze.properties,geometry:Wt?xi(Ze):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),Ht,G)){Wt||(Ht.geometry=xi(Ze));var ar=re?re.evaluate(Ht,{},G,I.availableImages):void 0,gr={id:ut,properties:Ze.properties,type:Ze.type,sourceLayerIndex:Bt,index:gt,geometry:Ht.geometry,patterns:{},sortKey:ar};fe.push(gr)}}re&&fe.sort(function(qn,na){return qn.sortKey-na.sortKey});for(var Cr=0,Er=fe;Cr<Er.length;Cr+=1){var Fr=Er[Cr],Br=Fr,Hr=Br.geometry,fn=Br.index,xn=Br.sourceLayerIndex;if(this.hasPattern){var Nn=$f("fill",this.layers,Fr,this.zoom,I);this.patternFeatures.push(Nn)}else this.addFeature(Fr,Hr,fn,G,{});var Fn=b[fn].feature;I.featureIndex.insert(Fn,Hr,fn,xn,this.index)}},rl.prototype.update=function(b,I,G){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(b,I,this.stateDependentLayers,G)},rl.prototype.addFeatures=function(b,I,G){for(var re=0,fe=this.patternFeatures;re<fe.length;re+=1){var me=fe[re];this.addFeature(me,me.geometry,me.index,I,G)}},rl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},rl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},rl.prototype.upload=function(b){this.uploaded||(this.layoutVertexBuffer=b.createVertexBuffer(this.layoutVertexArray,Jh),this.indexBuffer=b.createIndexBuffer(this.indexArray),this.indexBuffer2=b.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(b),this.uploaded=!0},rl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},rl.prototype.addFeature=function(b,I,G,re,fe){for(var me=0,Ae=Kf(I,500);me<Ae.length;me+=1){for(var De=Ae[me],Ze=0,ut=0,gt=De;ut<gt.length;ut+=1)Ze+=gt[ut].length;for(var Bt=this.segments.prepareSegment(Ze,this.layoutVertexArray,this.indexArray),Wt=Bt.vertexLength,Ht=[],ar=[],gr=0,Cr=De;gr<Cr.length;gr+=1){var Er=Cr[gr];if(Er.length!==0){Er!==De[0]&&ar.push(Ht.length/2);var Fr=this.segments2.prepareSegment(Er.length,this.layoutVertexArray,this.indexArray2),Br=Fr.vertexLength;this.layoutVertexArray.emplaceBack(Er[0].x,Er[0].y),this.indexArray2.emplaceBack(Br+Er.length-1,Br),Ht.push(Er[0].x),Ht.push(Er[0].y);for(var Hr=1;Hr<Er.length;Hr++)this.layoutVertexArray.emplaceBack(Er[Hr].x,Er[Hr].y),this.indexArray2.emplaceBack(Br+Hr-1,Br+Hr),Ht.push(Er[Hr].x),Ht.push(Er[Hr].y);Fr.vertexLength+=Er.length,Fr.primitiveLength+=Er.length}}for(var fn=Yf(Ht,ar),xn=0;xn<fn.length;xn+=3)this.indexArray.emplaceBack(Wt+fn[xn],Wt+fn[xn+1],Wt+fn[xn+2]);Bt.vertexLength+=Ze,Bt.primitiveLength+=fn.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,b,G,fe,re)},Xr("FillBucket",rl,{omit:["layers","patternFeatures"]});var x0=new Go({"fill-sort-key":new ya(Pe.layout_fill["fill-sort-key"])}),b0={paint:new Go({"fill-antialias":new la(Pe.paint_fill["fill-antialias"]),"fill-opacity":new ya(Pe.paint_fill["fill-opacity"]),"fill-color":new ya(Pe.paint_fill["fill-color"]),"fill-outline-color":new ya(Pe.paint_fill["fill-outline-color"]),"fill-translate":new la(Pe.paint_fill["fill-translate"]),"fill-translate-anchor":new la(Pe.paint_fill["fill-translate-anchor"]),"fill-pattern":new ml(Pe.paint_fill["fill-pattern"])}),layout:x0},_0=function(b){function I(G){b.call(this,G,b0)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.recalculate=function(G,re){b.prototype.recalculate.call(this,G,re);var fe=this.paint._values["fill-outline-color"];fe.value.kind==="constant"&&fe.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},I.prototype.createBucket=function(G){return new rl(G)},I.prototype.queryRadius=function(){return qo(this.paint.get("fill-translate"))},I.prototype.queryIntersectsFeature=function(G,re,fe,me,Ae,De,Ze){return yl(Yo(G,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),De.angle,Ze),me)},I.prototype.isTileClipped=function(){return!0},I}(is),rp=oi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,np=vu;function vu(b,I,G,re,fe){this.properties={},this.extent=G,this.type=0,this._pbf=b,this._geometry=-1,this._keys=re,this._values=fe,b.readFields(w0,this,I)}function w0(b,I,G){b==1?I.id=G.readVarint():b==2?function(re,fe){for(var me=re.readVarint()+re.pos;re.pos<me;){var Ae=fe._keys[re.readVarint()],De=fe._values[re.readVarint()];fe.properties[Ae]=De}}(G,I):b==3?I.type=G.readVarint():b==4&&(I._geometry=G.pos)}function T0(b){for(var I,G,re=0,fe=0,me=b.length,Ae=me-1;fe<me;Ae=fe++)I=b[fe],re+=((G=b[Ae]).x-I.x)*(I.y+G.y);return re}vu.types=["Unknown","Point","LineString","Polygon"],vu.prototype.loadGeometry=function(){var b=this._pbf;b.pos=this._geometry;for(var I,G=b.readVarint()+b.pos,re=1,fe=0,me=0,Ae=0,De=[];b.pos<G;){if(fe<=0){var Ze=b.readVarint();re=7&Ze,fe=Ze>>3}if(fe--,re===1||re===2)me+=b.readSVarint(),Ae+=b.readSVarint(),re===1&&(I&&De.push(I),I=[]),I.push(new l(me,Ae));else{if(re!==7)throw new Error("unknown command "+re);I&&I.push(I[0].clone())}}return I&&De.push(I),De},vu.prototype.bbox=function(){var b=this._pbf;b.pos=this._geometry;for(var I=b.readVarint()+b.pos,G=1,re=0,fe=0,me=0,Ae=1/0,De=-1/0,Ze=1/0,ut=-1/0;b.pos<I;){if(re<=0){var gt=b.readVarint();G=7&gt,re=gt>>3}if(re--,G===1||G===2)(fe+=b.readSVarint())<Ae&&(Ae=fe),fe>De&&(De=fe),(me+=b.readSVarint())<Ze&&(Ze=me),me>ut&&(ut=me);else if(G!==7)throw new Error("unknown command "+G)}return[Ae,Ze,De,ut]},vu.prototype.toGeoJSON=function(b,I,G){var re,fe,me=this.extent*Math.pow(2,G),Ae=this.extent*b,De=this.extent*I,Ze=this.loadGeometry(),ut=vu.types[this.type];function gt(Ht){for(var ar=0;ar<Ht.length;ar++){var gr=Ht[ar],Cr=180-360*(gr.y+De)/me;Ht[ar]=[360*(gr.x+Ae)/me-180,360/Math.PI*Math.atan(Math.exp(Cr*Math.PI/180))-90]}}switch(this.type){case 1:var Bt=[];for(re=0;re<Ze.length;re++)Bt[re]=Ze[re][0];gt(Ze=Bt);break;case 2:for(re=0;re<Ze.length;re++)gt(Ze[re]);break;case 3:for(Ze=function(Ht){var ar=Ht.length;if(ar<=1)return[Ht];for(var gr,Cr,Er=[],Fr=0;Fr<ar;Fr++){var Br=T0(Ht[Fr]);Br!==0&&(Cr===void 0&&(Cr=Br<0),Cr===Br<0?(gr&&Er.push(gr),gr=[Ht[Fr]]):gr.push(Ht[Fr]))}return gr&&Er.push(gr),Er}(Ze),re=0;re<Ze.length;re++)for(fe=0;fe<Ze[re].length;fe++)gt(Ze[re][fe])}Ze.length===1?Ze=Ze[0]:ut="Multi"+ut;var Wt={type:"Feature",geometry:{type:ut,coordinates:Ze},properties:this.properties};return"id"in this&&(Wt.id=this.id),Wt};var ap=ip;function ip(b,I){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=b,this._keys=[],this._values=[],this._features=[],b.readFields(k0,this,I),this.length=this._features.length}function k0(b,I,G){b===15?I.version=G.readVarint():b===1?I.name=G.readString():b===5?I.extent=G.readVarint():b===2?I._features.push(G.pos):b===3?I._keys.push(G.readString()):b===4&&I._values.push(function(re){for(var fe=null,me=re.readVarint()+re.pos;re.pos<me;){var Ae=re.readVarint()>>3;fe=Ae===1?re.readString():Ae===2?re.readFloat():Ae===3?re.readDouble():Ae===4?re.readVarint64():Ae===5?re.readVarint():Ae===6?re.readSVarint():Ae===7?re.readBoolean():null}return fe}(G))}function A0(b,I,G){if(b===3){var re=new ap(G,G.readVarint()+G.pos);re.length&&(I[re.name]=re)}}ip.prototype.feature=function(b){if(b<0||b>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[b];var I=this._pbf.readVarint()+this._pbf.pos;return new np(this._pbf,I,this.extent,this._keys,this._values)};var yu={VectorTile:function(b,I){this.layers=b.readFields(A0,{},I)},VectorTileFeature:np,VectorTileLayer:ap},M0=yu.VectorTileFeature.types,Qf=Math.pow(2,13);function $u(b,I,G,re,fe,me,Ae,De){b.emplaceBack(I,G,2*Math.floor(re*Qf)+Ae,fe*Qf*2,me*Qf*2,Math.round(De))}var nl=function(b){this.zoom=b.zoom,this.overscaling=b.overscaling,this.layers=b.layers,this.layerIds=this.layers.map(function(I){return I.id}),this.index=b.index,this.hasPattern=!1,this.layoutVertexArray=new Fs,this.indexArray=new lo,this.programConfigurations=new di(rp,b.layers,b.zoom),this.segments=new Ft,this.stateDependentLayerIds=this.layers.filter(function(I){return I.isStateDependent()}).map(function(I){return I.id})};function S0(b,I){return b.x===I.x&&(b.x<0||b.x>8192)||b.y===I.y&&(b.y<0||b.y>8192)}function E0(b){return b.every(function(I){return I.x<0})||b.every(function(I){return I.x>8192})||b.every(function(I){return I.y<0})||b.every(function(I){return I.y>8192})}nl.prototype.populate=function(b,I,G){this.features=[],this.hasPattern=Jf("fill-extrusion",this.layers,I);for(var re=0,fe=b;re<fe.length;re+=1){var me=fe[re],Ae=me.feature,De=me.id,Ze=me.index,ut=me.sourceLayerIndex,gt=this.layers[0]._featureFilter.needGeometry,Bt={type:Ae.type,id:De,properties:Ae.properties,geometry:gt?xi(Ae):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),Bt,G)){var Wt={id:De,sourceLayerIndex:ut,index:Ze,geometry:gt?Bt.geometry:xi(Ae),properties:Ae.properties,type:Ae.type,patterns:{}};Ae.id!==void 0&&(Wt.id=Ae.id),this.hasPattern?this.features.push($f("fill-extrusion",this.layers,Wt,this.zoom,I)):this.addFeature(Wt,Wt.geometry,Ze,G,{}),I.featureIndex.insert(Ae,Wt.geometry,Ze,ut,this.index,!0)}}},nl.prototype.addFeatures=function(b,I,G){for(var re=0,fe=this.features;re<fe.length;re+=1){var me=fe[re],Ae=me.geometry;this.addFeature(me,Ae,me.index,I,G)}},nl.prototype.update=function(b,I,G){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(b,I,this.stateDependentLayers,G)},nl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},nl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},nl.prototype.upload=function(b){this.uploaded||(this.layoutVertexBuffer=b.createVertexBuffer(this.layoutVertexArray,rp),this.indexBuffer=b.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(b),this.uploaded=!0},nl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},nl.prototype.addFeature=function(b,I,G,re,fe){for(var me=0,Ae=Kf(I,500);me<Ae.length;me+=1){for(var De=Ae[me],Ze=0,ut=0,gt=De;ut<gt.length;ut+=1)Ze+=gt[ut].length;for(var Bt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Wt=0,Ht=De;Wt<Ht.length;Wt+=1){var ar=Ht[Wt];if(ar.length!==0&&!E0(ar))for(var gr=0,Cr=0;Cr<ar.length;Cr++){var Er=ar[Cr];if(Cr>=1){var Fr=ar[Cr-1];if(!S0(Er,Fr)){Bt.vertexLength+4>Ft.MAX_VERTEX_ARRAY_LENGTH&&(Bt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Br=Er.sub(Fr)._perp()._unit(),Hr=Fr.dist(Er);gr+Hr>32768&&(gr=0),$u(this.layoutVertexArray,Er.x,Er.y,Br.x,Br.y,0,0,gr),$u(this.layoutVertexArray,Er.x,Er.y,Br.x,Br.y,0,1,gr),gr+=Hr,$u(this.layoutVertexArray,Fr.x,Fr.y,Br.x,Br.y,0,0,gr),$u(this.layoutVertexArray,Fr.x,Fr.y,Br.x,Br.y,0,1,gr);var fn=Bt.vertexLength;this.indexArray.emplaceBack(fn,fn+2,fn+1),this.indexArray.emplaceBack(fn+1,fn+2,fn+3),Bt.vertexLength+=4,Bt.primitiveLength+=2}}}}if(Bt.vertexLength+Ze>Ft.MAX_VERTEX_ARRAY_LENGTH&&(Bt=this.segments.prepareSegment(Ze,this.layoutVertexArray,this.indexArray)),M0[b.type]==="Polygon"){for(var xn=[],Nn=[],Fn=Bt.vertexLength,qn=0,na=De;qn<na.length;qn+=1){var ia=na[qn];if(ia.length!==0){ia!==De[0]&&Nn.push(xn.length/2);for(var Zn=0;Zn<ia.length;Zn++){var ha=ia[Zn];$u(this.layoutVertexArray,ha.x,ha.y,0,0,1,1,0),xn.push(ha.x),xn.push(ha.y)}}}for(var ca=Yf(xn,Nn),oa=0;oa<ca.length;oa+=3)this.indexArray.emplaceBack(Fn+ca[oa],Fn+ca[oa+2],Fn+ca[oa+1]);Bt.primitiveLength+=ca.length/3,Bt.vertexLength+=Ze}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,b,G,fe,re)},Xr("FillExtrusionBucket",nl,{omit:["layers","features"]});var C0={paint:new Go({"fill-extrusion-opacity":new la(Pe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ya(Pe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new la(Pe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new la(Pe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ml(Pe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ya(Pe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ya(Pe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new la(Pe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},L0=function(b){function I(G){b.call(this,G,C0)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.createBucket=function(G){return new nl(G)},I.prototype.queryRadius=function(){return qo(this.paint.get("fill-extrusion-translate"))},I.prototype.is3D=function(){return!0},I.prototype.queryIntersectsFeature=function(G,re,fe,me,Ae,De,Ze,ut){var gt=Yo(G,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),De.angle,Ze),Bt=this.paint.get("fill-extrusion-height").evaluate(re,fe),Wt=this.paint.get("fill-extrusion-base").evaluate(re,fe),Ht=function(gr,Cr,Er,Fr){for(var Br=[],Hr=0,fn=gr;Hr<fn.length;Hr+=1){var xn=fn[Hr],Nn=[xn.x,xn.y,Fr,1];gu(Nn,Nn,Cr),Br.push(new l(Nn[0]/Nn[3],Nn[1]/Nn[3]))}return Br}(gt,ut,0,0),ar=function(gr,Cr,Er,Fr){for(var Br=[],Hr=[],fn=Fr[8]*Cr,xn=Fr[9]*Cr,Nn=Fr[10]*Cr,Fn=Fr[11]*Cr,qn=Fr[8]*Er,na=Fr[9]*Er,ia=Fr[10]*Er,Zn=Fr[11]*Er,ha=0,ca=gr;ha<ca.length;ha+=1){for(var oa=ca[ha],$a=[],Va=[],ri=0,_a=oa;ri<_a.length;ri+=1){var Ya=_a[ri],_i=Ya.x,gi=Ya.y,Pi=Fr[0]*_i+Fr[4]*gi+Fr[12],mi=Fr[1]*_i+Fr[5]*gi+Fr[13],ho=Fr[2]*_i+Fr[6]*gi+Fr[14],Ii=Fr[3]*_i+Fr[7]*gi+Fr[15],Wo=ho+Nn,Oo=Ii+Fn,Ro=Pi+qn,os=mi+na,Jo=ho+ia,po=Ii+Zn,Fo=new l((Pi+fn)/Oo,(mi+xn)/Oo);Fo.z=Wo/Oo,$a.push(Fo);var eo=new l(Ro/po,os/po);eo.z=Jo/po,Va.push(eo)}Br.push($a),Hr.push(Va)}return[Br,Hr]}(me,Wt,Bt,ut);return function(gr,Cr,Er){var Fr=1/0;yl(Er,Cr)&&(Fr=op(Er,Cr[0]));for(var Br=0;Br<Cr.length;Br++)for(var Hr=Cr[Br],fn=gr[Br],xn=0;xn<Hr.length-1;xn++){var Nn=Hr[xn],Fn=Hr[xn+1],qn=fn[xn],na=fn[xn+1],ia=[Nn,Fn,na,qn,Nn];Zo(Er,ia)&&(Fr=Math.min(Fr,op(Er,ia)))}return Fr!==1/0&&Fr}(ar[0],ar[1],Ht)},I}(is);function Qu(b,I){return b.x*I.x+b.y*I.y}function op(b,I){if(b.length===1){for(var G,re=0,fe=I[re++];!G||fe.equals(G);)if(!(G=I[re++]))return 1/0;for(;re<I.length;re++){var me=I[re],Ae=b[0],De=G.sub(fe),Ze=me.sub(fe),ut=Ae.sub(fe),gt=Qu(De,De),Bt=Qu(De,Ze),Wt=Qu(Ze,Ze),Ht=Qu(ut,De),ar=Qu(ut,Ze),gr=gt*Wt-Bt*Bt,Cr=(Wt*Ht-Bt*ar)/gr,Er=(gt*ar-Bt*Ht)/gr,Fr=1-Cr-Er,Br=fe.z*Fr+G.z*Cr+me.z*Er;if(isFinite(Br))return Br}return 1/0}for(var Hr=1/0,fn=0,xn=I;fn<xn.length;fn+=1){var Nn=xn[fn];Hr=Math.min(Hr,Nn.z)}return Hr}var sp=oi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,P0=yu.VectorTileFeature.types,I0=Math.cos(Math.PI/180*37.5),lp=Math.pow(2,14)/.5,ps=function(b){this.zoom=b.zoom,this.overscaling=b.overscaling,this.layers=b.layers,this.layerIds=this.layers.map(function(I){return I.id}),this.index=b.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Qs,this.indexArray=new lo,this.programConfigurations=new di(sp,b.layers,b.zoom),this.segments=new Ft,this.stateDependentLayerIds=this.layers.filter(function(I){return I.isStateDependent()}).map(function(I){return I.id})};ps.prototype.populate=function(b,I,G){this.hasPattern=Jf("line",this.layers,I);for(var re=this.layers[0].layout.get("line-sort-key"),fe=[],me=0,Ae=b;me<Ae.length;me+=1){var De=Ae[me],Ze=De.feature,ut=De.id,gt=De.index,Bt=De.sourceLayerIndex,Wt=this.layers[0]._featureFilter.needGeometry,Ht={type:Ze.type,id:ut,properties:Ze.properties,geometry:Wt?xi(Ze):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),Ht,G)){Wt||(Ht.geometry=xi(Ze));var ar=re?re.evaluate(Ht,{},G):void 0,gr={id:ut,properties:Ze.properties,type:Ze.type,sourceLayerIndex:Bt,index:gt,geometry:Ht.geometry,patterns:{},sortKey:ar};fe.push(gr)}}re&&fe.sort(function(qn,na){return qn.sortKey-na.sortKey});for(var Cr=0,Er=fe;Cr<Er.length;Cr+=1){var Fr=Er[Cr],Br=Fr,Hr=Br.geometry,fn=Br.index,xn=Br.sourceLayerIndex;if(this.hasPattern){var Nn=$f("line",this.layers,Fr,this.zoom,I);this.patternFeatures.push(Nn)}else this.addFeature(Fr,Hr,fn,G,{});var Fn=b[fn].feature;I.featureIndex.insert(Fn,Hr,fn,xn,this.index)}},ps.prototype.update=function(b,I,G){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(b,I,this.stateDependentLayers,G)},ps.prototype.addFeatures=function(b,I,G){for(var re=0,fe=this.patternFeatures;re<fe.length;re+=1){var me=fe[re];this.addFeature(me,me.geometry,me.index,I,G)}},ps.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ps.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ps.prototype.upload=function(b){this.uploaded||(this.layoutVertexBuffer=b.createVertexBuffer(this.layoutVertexArray,sp),this.indexBuffer=b.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(b),this.uploaded=!0},ps.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ps.prototype.addFeature=function(b,I,G,re,fe){for(var me=this.layers[0].layout,Ae=me.get("line-join").evaluate(b,{}),De=me.get("line-cap"),Ze=me.get("line-miter-limit"),ut=me.get("line-round-limit"),gt=0,Bt=I;gt<Bt.length;gt+=1){var Wt=Bt[gt];this.addLine(Wt,b,Ae,De,Ze,ut)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,b,G,fe,re)},ps.prototype.addLine=function(b,I,G,re,fe,me){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,I.properties&&I.properties.hasOwnProperty("mapbox_clip_start")&&I.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+I.properties.mapbox_clip_start,this.clipEnd=+I.properties.mapbox_clip_end;for(var Ae=0;Ae<b.length-1;Ae++)this.totalDistance+=b[Ae].dist(b[Ae+1]);this.updateScaledDistance()}for(var De=P0[I.type]==="Polygon",Ze=b.length;Ze>=2&&b[Ze-1].equals(b[Ze-2]);)Ze--;for(var ut=0;ut<Ze-1&&b[ut].equals(b[ut+1]);)ut++;if(!(Ze<(De?3:2))){G==="bevel"&&(fe=1.05);var gt,Bt=this.overscaling<=16?122880/(512*this.overscaling):0,Wt=this.segments.prepareSegment(10*Ze,this.layoutVertexArray,this.indexArray),Ht=void 0,ar=void 0,gr=void 0,Cr=void 0;this.e1=this.e2=-1,De&&(gt=b[Ze-2],Cr=b[ut].sub(gt)._unit()._perp());for(var Er=ut;Er<Ze;Er++)if(!(ar=Er===Ze-1?De?b[ut+1]:void 0:b[Er+1])||!b[Er].equals(ar)){Cr&&(gr=Cr),gt&&(Ht=gt),gt=b[Er],Cr=ar?ar.sub(gt)._unit()._perp():gr;var Fr=(gr=gr||Cr).add(Cr);Fr.x===0&&Fr.y===0||Fr._unit();var Br=gr.x*Cr.x+gr.y*Cr.y,Hr=Fr.x*Cr.x+Fr.y*Cr.y,fn=Hr!==0?1/Hr:1/0,xn=2*Math.sqrt(2-2*Hr),Nn=Hr<I0&&Ht&&ar,Fn=gr.x*Cr.y-gr.y*Cr.x>0;if(Nn&&Er>ut){var qn=gt.dist(Ht);if(qn>2*Bt){var na=gt.sub(gt.sub(Ht)._mult(Bt/qn)._round());this.updateDistance(Ht,na),this.addCurrentVertex(na,gr,0,0,Wt),Ht=na}}var ia=Ht&&ar,Zn=ia?G:De?"butt":re;if(ia&&Zn==="round"&&(fn<me?Zn="miter":fn<=2&&(Zn="fakeround")),Zn==="miter"&&fn>fe&&(Zn="bevel"),Zn==="bevel"&&(fn>2&&(Zn="flipbevel"),fn<fe&&(Zn="miter")),Ht&&this.updateDistance(Ht,gt),Zn==="miter")Fr._mult(fn),this.addCurrentVertex(gt,Fr,0,0,Wt);else if(Zn==="flipbevel"){if(fn>100)Fr=Cr.mult(-1);else{var ha=fn*gr.add(Cr).mag()/gr.sub(Cr).mag();Fr._perp()._mult(ha*(Fn?-1:1))}this.addCurrentVertex(gt,Fr,0,0,Wt),this.addCurrentVertex(gt,Fr.mult(-1),0,0,Wt)}else if(Zn==="bevel"||Zn==="fakeround"){var ca=-Math.sqrt(fn*fn-1),oa=Fn?ca:0,$a=Fn?0:ca;if(Ht&&this.addCurrentVertex(gt,gr,oa,$a,Wt),Zn==="fakeround")for(var Va=Math.round(180*xn/Math.PI/20),ri=1;ri<Va;ri++){var _a=ri/Va;if(_a!==.5){var Ya=_a-.5;_a+=_a*Ya*(_a-1)*((1.0904+Br*(Br*(3.55645-1.43519*Br)-3.2452))*Ya*Ya+(.848013+Br*(.215638*Br-1.06021)))}var _i=Cr.sub(gr)._mult(_a)._add(gr)._unit()._mult(Fn?-1:1);this.addHalfVertex(gt,_i.x,_i.y,!1,Fn,0,Wt)}ar&&this.addCurrentVertex(gt,Cr,-oa,-$a,Wt)}else if(Zn==="butt")this.addCurrentVertex(gt,Fr,0,0,Wt);else if(Zn==="square"){var gi=Ht?1:-1;this.addCurrentVertex(gt,Fr,gi,gi,Wt)}else Zn==="round"&&(Ht&&(this.addCurrentVertex(gt,gr,0,0,Wt),this.addCurrentVertex(gt,gr,1,1,Wt,!0)),ar&&(this.addCurrentVertex(gt,Cr,-1,-1,Wt,!0),this.addCurrentVertex(gt,Cr,0,0,Wt)));if(Nn&&Er<Ze-1){var Pi=gt.dist(ar);if(Pi>2*Bt){var mi=gt.add(ar.sub(gt)._mult(Bt/Pi)._round());this.updateDistance(gt,mi),this.addCurrentVertex(mi,Cr,0,0,Wt),gt=mi}}}}},ps.prototype.addCurrentVertex=function(b,I,G,re,fe,me){me===void 0&&(me=!1);var Ae=I.x+I.y*G,De=I.y-I.x*G,Ze=-I.x+I.y*re,ut=-I.y-I.x*re;this.addHalfVertex(b,Ae,De,me,!1,G,fe),this.addHalfVertex(b,Ze,ut,me,!0,-re,fe),this.distance>lp/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(b,I,G,re,fe,me))},ps.prototype.addHalfVertex=function(b,I,G,re,fe,me,Ae){var De=b.x,Ze=b.y,ut=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((De<<1)+(re?1:0),(Ze<<1)+(fe?1:0),Math.round(63*I)+128,Math.round(63*G)+128,1+(me===0?0:me<0?-1:1)|(63&ut)<<2,ut>>6);var gt=Ae.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,gt),Ae.primitiveLength++),fe?this.e2=gt:this.e1=gt},ps.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(lp-1):this.distance},ps.prototype.updateDistance=function(b,I){this.distance+=b.dist(I),this.updateScaledDistance()},Xr("LineBucket",ps,{omit:["layers","patternFeatures"]});var O0=new Go({"line-cap":new la(Pe.layout_line["line-cap"]),"line-join":new ya(Pe.layout_line["line-join"]),"line-miter-limit":new la(Pe.layout_line["line-miter-limit"]),"line-round-limit":new la(Pe.layout_line["line-round-limit"]),"line-sort-key":new ya(Pe.layout_line["line-sort-key"])}),up={paint:new Go({"line-opacity":new ya(Pe.paint_line["line-opacity"]),"line-color":new ya(Pe.paint_line["line-color"]),"line-translate":new la(Pe.paint_line["line-translate"]),"line-translate-anchor":new la(Pe.paint_line["line-translate-anchor"]),"line-width":new ya(Pe.paint_line["line-width"]),"line-gap-width":new ya(Pe.paint_line["line-gap-width"]),"line-offset":new ya(Pe.paint_line["line-offset"]),"line-blur":new ya(Pe.paint_line["line-blur"]),"line-dasharray":new vl(Pe.paint_line["line-dasharray"]),"line-pattern":new ml(Pe.paint_line["line-pattern"]),"line-gradient":new bs(Pe.paint_line["line-gradient"])}),layout:O0},cp=new(function(b){function I(){b.apply(this,arguments)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.possiblyEvaluate=function(G,re){return re=new ii(Math.floor(re.zoom),{now:re.now,fadeDuration:re.fadeDuration,zoomHistory:re.zoomHistory,transition:re.transition}),b.prototype.possiblyEvaluate.call(this,G,re)},I.prototype.evaluate=function(G,re,fe,me){return re=g({},re,{zoom:Math.floor(re.zoom)}),b.prototype.evaluate.call(this,G,re,fe,me)},I}(ya))(up.paint.properties["line-width"].specification);cp.useIntegerZoom=!0;var D0=function(b){function I(G){b.call(this,G,up)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype._handleSpecialPaintPropertyUpdate=function(G){G==="line-gradient"&&this._updateGradient()},I.prototype._updateGradient=function(){var G=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=Kh(G,"lineProgress"),this.gradientTexture=null},I.prototype.recalculate=function(G,re){b.prototype.recalculate.call(this,G,re),this.paint._values["line-floorwidth"]=cp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,G)},I.prototype.createBucket=function(G){return new ps(G)},I.prototype.queryRadius=function(G){var re=G,fe=fp(Ci("line-width",this,re),Ci("line-gap-width",this,re)),me=Ci("line-offset",this,re);return fe/2+Math.abs(me)+qo(this.paint.get("line-translate"))},I.prototype.queryIntersectsFeature=function(G,re,fe,me,Ae,De,Ze){var ut=Yo(G,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),De.angle,Ze),gt=Ze/2*fp(this.paint.get("line-width").evaluate(re,fe),this.paint.get("line-gap-width").evaluate(re,fe)),Bt=this.paint.get("line-offset").evaluate(re,fe);return Bt&&(me=function(Wt,Ht){for(var ar=[],gr=new l(0,0),Cr=0;Cr<Wt.length;Cr++){for(var Er=Wt[Cr],Fr=[],Br=0;Br<Er.length;Br++){var Hr=Er[Br-1],fn=Er[Br],xn=Er[Br+1],Nn=Br===0?gr:fn.sub(Hr)._unit()._perp(),Fn=Br===Er.length-1?gr:xn.sub(fn)._unit()._perp(),qn=Nn._add(Fn)._unit(),na=qn.x*Fn.x+qn.y*Fn.y;qn._mult(1/na),Fr.push(qn._mult(Ht)._add(fn))}ar.push(Fr)}return ar}(me,Bt*Ze)),function(Wt,Ht,ar){for(var gr=0;gr<Ht.length;gr++){var Cr=Ht[gr];if(Wt.length>=3){for(var Er=0;Er<Cr.length;Er++)if(_s(Wt,Cr[Er]))return!0}if(Jl(Wt,Cr,ar))return!0}return!1}(ut,me,gt)},I.prototype.isTileClipped=function(){return!0},I}(is);function fp(b,I){return I>0?I+2*b:b}var eh=oi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),z0=oi([{name:"a_projected_pos",components:3,type:"Float32"}],4),R0=(oi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),oi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),hp=(oi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),oi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),F0=oi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);oi([{name:"triangle",components:3,type:"Uint16"}]),oi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),oi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),oi([{type:"Float32",name:"offsetX"}]),oi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function B0(b,I,G){return b.sections.forEach(function(re){re.text=function(fe,me,Ae){var De=me.layout.get("text-transform").evaluate(Ae,{});return De==="uppercase"?fe=fe.toLocaleUpperCase():De==="lowercase"&&(fe=fe.toLocaleLowerCase()),yo.applyArabicShaping&&(fe=yo.applyArabicShaping(fe)),fe}(re.text,I,G)}),b}var ec={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},pp=function(b,I,G,re,fe){var me,Ae,De=8*fe-re-1,Ze=(1<<De)-1,ut=Ze>>1,gt=-7,Bt=G?fe-1:0,Wt=G?-1:1,Ht=b[I+Bt];for(Bt+=Wt,me=Ht&(1<<-gt)-1,Ht>>=-gt,gt+=De;gt>0;me=256*me+b[I+Bt],Bt+=Wt,gt-=8);for(Ae=me&(1<<-gt)-1,me>>=-gt,gt+=re;gt>0;Ae=256*Ae+b[I+Bt],Bt+=Wt,gt-=8);if(me===0)me=1-ut;else{if(me===Ze)return Ae?NaN:1/0*(Ht?-1:1);Ae+=Math.pow(2,re),me-=ut}return(Ht?-1:1)*Ae*Math.pow(2,me-re)},dp=function(b,I,G,re,fe,me){var Ae,De,Ze,ut=8*me-fe-1,gt=(1<<ut)-1,Bt=gt>>1,Wt=fe===23?Math.pow(2,-24)-Math.pow(2,-77):0,Ht=re?0:me-1,ar=re?1:-1,gr=I<0||I===0&&1/I<0?1:0;for(I=Math.abs(I),isNaN(I)||I===1/0?(De=isNaN(I)?1:0,Ae=gt):(Ae=Math.floor(Math.log(I)/Math.LN2),I*(Ze=Math.pow(2,-Ae))<1&&(Ae--,Ze*=2),(I+=Ae+Bt>=1?Wt/Ze:Wt*Math.pow(2,1-Bt))*Ze>=2&&(Ae++,Ze/=2),Ae+Bt>=gt?(De=0,Ae=gt):Ae+Bt>=1?(De=(I*Ze-1)*Math.pow(2,fe),Ae+=Bt):(De=I*Math.pow(2,Bt-1)*Math.pow(2,fe),Ae=0));fe>=8;b[G+Ht]=255&De,Ht+=ar,De/=256,fe-=8);for(Ae=Ae<<fe|De,ut+=fe;ut>0;b[G+Ht]=255&Ae,Ht+=ar,Ae/=256,ut-=8);b[G+Ht-ar]|=128*gr},zc=bi;function bi(b){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(b)?b:new Uint8Array(b||0),this.pos=0,this.type=0,this.length=this.buf.length}bi.Varint=0,bi.Fixed64=1,bi.Bytes=2,bi.Fixed32=5;var gp=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Al(b){return b.type===bi.Bytes?b.readVarint()+b.pos:b.pos+1}function xu(b,I,G){return G?4294967296*I+(b>>>0):4294967296*(I>>>0)+(b>>>0)}function mp(b,I,G){var re=I<=16383?1:I<=2097151?2:I<=268435455?3:Math.floor(Math.log(I)/(7*Math.LN2));G.realloc(re);for(var fe=G.pos-1;fe>=b;fe--)G.buf[fe+re]=G.buf[fe]}function N0(b,I){for(var G=0;G<b.length;G++)I.writeVarint(b[G])}function j0(b,I){for(var G=0;G<b.length;G++)I.writeSVarint(b[G])}function U0(b,I){for(var G=0;G<b.length;G++)I.writeFloat(b[G])}function V0(b,I){for(var G=0;G<b.length;G++)I.writeDouble(b[G])}function H0(b,I){for(var G=0;G<b.length;G++)I.writeBoolean(b[G])}function G0(b,I){for(var G=0;G<b.length;G++)I.writeFixed32(b[G])}function q0(b,I){for(var G=0;G<b.length;G++)I.writeSFixed32(b[G])}function Y0(b,I){for(var G=0;G<b.length;G++)I.writeFixed64(b[G])}function W0(b,I){for(var G=0;G<b.length;G++)I.writeSFixed64(b[G])}function Rc(b,I){return(b[I]|b[I+1]<<8|b[I+2]<<16)+16777216*b[I+3]}function bu(b,I,G){b[G]=I,b[G+1]=I>>>8,b[G+2]=I>>>16,b[G+3]=I>>>24}function vp(b,I){return(b[I]|b[I+1]<<8|b[I+2]<<16)+(b[I+3]<<24)}bi.prototype={destroy:function(){this.buf=null},readFields:function(b,I,G){for(G=G||this.length;this.pos<G;){var re=this.readVarint(),fe=re>>3,me=this.pos;this.type=7&re,b(fe,I,this),this.pos===me&&this.skip(re)}return I},readMessage:function(b,I){return this.readFields(b,I,this.readVarint()+this.pos)},readFixed32:function(){var b=Rc(this.buf,this.pos);return this.pos+=4,b},readSFixed32:function(){var b=vp(this.buf,this.pos);return this.pos+=4,b},readFixed64:function(){var b=Rc(this.buf,this.pos)+4294967296*Rc(this.buf,this.pos+4);return this.pos+=8,b},readSFixed64:function(){var b=Rc(this.buf,this.pos)+4294967296*vp(this.buf,this.pos+4);return this.pos+=8,b},readFloat:function(){var b=pp(this.buf,this.pos,!0,23,4);return this.pos+=4,b},readDouble:function(){var b=pp(this.buf,this.pos,!0,52,8);return this.pos+=8,b},readVarint:function(b){var I,G,re=this.buf;return I=127&(G=re[this.pos++]),G<128?I:(I|=(127&(G=re[this.pos++]))<<7,G<128?I:(I|=(127&(G=re[this.pos++]))<<14,G<128?I:(I|=(127&(G=re[this.pos++]))<<21,G<128?I:function(fe,me,Ae){var De,Ze,ut=Ae.buf;if(Ze=ut[Ae.pos++],De=(112&Ze)>>4,Ze<128||(Ze=ut[Ae.pos++],De|=(127&Ze)<<3,Ze<128)||(Ze=ut[Ae.pos++],De|=(127&Ze)<<10,Ze<128)||(Ze=ut[Ae.pos++],De|=(127&Ze)<<17,Ze<128)||(Ze=ut[Ae.pos++],De|=(127&Ze)<<24,Ze<128)||(Ze=ut[Ae.pos++],De|=(1&Ze)<<31,Ze<128))return xu(fe,De,me);throw new Error("Expected varint not more than 10 bytes")}(I|=(15&(G=re[this.pos]))<<28,b,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var b=this.readVarint();return b%2==1?(b+1)/-2:b/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var b=this.readVarint()+this.pos,I=this.pos;return this.pos=b,b-I>=12&&gp?function(G,re,fe){return gp.decode(G.subarray(re,fe))}(this.buf,I,b):function(G,re,fe){for(var me="",Ae=re;Ae<fe;){var De,Ze,ut,gt=G[Ae],Bt=null,Wt=gt>239?4:gt>223?3:gt>191?2:1;if(Ae+Wt>fe)break;Wt===1?gt<128&&(Bt=gt):Wt===2?(192&(De=G[Ae+1]))==128&&(Bt=(31&gt)<<6|63&De)<=127&&(Bt=null):Wt===3?(De=G[Ae+1],Ze=G[Ae+2],(192&De)==128&&(192&Ze)==128&&((Bt=(15&gt)<<12|(63&De)<<6|63&Ze)<=2047||Bt>=55296&&Bt<=57343)&&(Bt=null)):Wt===4&&(De=G[Ae+1],Ze=G[Ae+2],ut=G[Ae+3],(192&De)==128&&(192&Ze)==128&&(192&ut)==128&&((Bt=(15&gt)<<18|(63&De)<<12|(63&Ze)<<6|63&ut)<=65535||Bt>=1114112)&&(Bt=null)),Bt===null?(Bt=65533,Wt=1):Bt>65535&&(Bt-=65536,me+=String.fromCharCode(Bt>>>10&1023|55296),Bt=56320|1023&Bt),me+=String.fromCharCode(Bt),Ae+=Wt}return me}(this.buf,I,b)},readBytes:function(){var b=this.readVarint()+this.pos,I=this.buf.subarray(this.pos,b);return this.pos=b,I},readPackedVarint:function(b,I){if(this.type!==bi.Bytes)return b.push(this.readVarint(I));var G=Al(this);for(b=b||[];this.pos<G;)b.push(this.readVarint(I));return b},readPackedSVarint:function(b){if(this.type!==bi.Bytes)return b.push(this.readSVarint());var I=Al(this);for(b=b||[];this.pos<I;)b.push(this.readSVarint());return b},readPackedBoolean:function(b){if(this.type!==bi.Bytes)return b.push(this.readBoolean());var I=Al(this);for(b=b||[];this.pos<I;)b.push(this.readBoolean());return b},readPackedFloat:function(b){if(this.type!==bi.Bytes)return b.push(this.readFloat());var I=Al(this);for(b=b||[];this.pos<I;)b.push(this.readFloat());return b},readPackedDouble:function(b){if(this.type!==bi.Bytes)return b.push(this.readDouble());var I=Al(this);for(b=b||[];this.pos<I;)b.push(this.readDouble());return b},readPackedFixed32:function(b){if(this.type!==bi.Bytes)return b.push(this.readFixed32());var I=Al(this);for(b=b||[];this.pos<I;)b.push(this.readFixed32());return b},readPackedSFixed32:function(b){if(this.type!==bi.Bytes)return b.push(this.readSFixed32());var I=Al(this);for(b=b||[];this.pos<I;)b.push(this.readSFixed32());return b},readPackedFixed64:function(b){if(this.type!==bi.Bytes)return b.push(this.readFixed64());var I=Al(this);for(b=b||[];this.pos<I;)b.push(this.readFixed64());return b},readPackedSFixed64:function(b){if(this.type!==bi.Bytes)return b.push(this.readSFixed64());var I=Al(this);for(b=b||[];this.pos<I;)b.push(this.readSFixed64());return b},skip:function(b){var I=7&b;if(I===bi.Varint)for(;this.buf[this.pos++]>127;);else if(I===bi.Bytes)this.pos=this.readVarint()+this.pos;else if(I===bi.Fixed32)this.pos+=4;else{if(I!==bi.Fixed64)throw new Error("Unimplemented type: "+I);this.pos+=8}},writeTag:function(b,I){this.writeVarint(b<<3|I)},realloc:function(b){for(var I=this.length||16;I<this.pos+b;)I*=2;if(I!==this.length){var G=new Uint8Array(I);G.set(this.buf),this.buf=G,this.length=I}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(b){this.realloc(4),bu(this.buf,b,this.pos),this.pos+=4},writeSFixed32:function(b){this.realloc(4),bu(this.buf,b,this.pos),this.pos+=4},writeFixed64:function(b){this.realloc(8),bu(this.buf,-1&b,this.pos),bu(this.buf,Math.floor(b*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(b){this.realloc(8),bu(this.buf,-1&b,this.pos),bu(this.buf,Math.floor(b*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(b){(b=+b||0)>268435455||b<0?function(I,G){var re,fe;if(I>=0?(re=I%4294967296|0,fe=I/4294967296|0):(fe=~(-I/4294967296),4294967295^(re=~(-I%4294967296))?re=re+1|0:(re=0,fe=fe+1|0)),I>=18446744073709552e3||I<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");G.realloc(10),function(me,Ae,De){De.buf[De.pos++]=127&me|128,me>>>=7,De.buf[De.pos++]=127&me|128,me>>>=7,De.buf[De.pos++]=127&me|128,me>>>=7,De.buf[De.pos++]=127&me|128,me>>>=7,De.buf[De.pos]=127&me}(re,0,G),function(me,Ae){var De=(7&me)<<4;Ae.buf[Ae.pos++]|=De|((me>>>=3)?128:0),!!me&&(Ae.buf[Ae.pos++]=127&me|((me>>>=7)?128:0),!!me&&(Ae.buf[Ae.pos++]=127&me|((me>>>=7)?128:0),!!me&&(Ae.buf[Ae.pos++]=127&me|((me>>>=7)?128:0),!!me&&(Ae.buf[Ae.pos++]=127&me|((me>>>=7)?128:0),!!me&&(Ae.buf[Ae.pos++]=127&me)))))}(fe,G)}(b,this):(this.realloc(4),this.buf[this.pos++]=127&b|(b>127?128:0),b<=127||(this.buf[this.pos++]=127&(b>>>=7)|(b>127?128:0),b<=127||(this.buf[this.pos++]=127&(b>>>=7)|(b>127?128:0),b<=127||(this.buf[this.pos++]=b>>>7&127))))},writeSVarint:function(b){this.writeVarint(b<0?2*-b-1:2*b)},writeBoolean:function(b){this.writeVarint(Boolean(b))},writeString:function(b){b=String(b),this.realloc(4*b.length),this.pos++;var I=this.pos;this.pos=function(re,fe,me){for(var Ae,De,Ze=0;Ze<fe.length;Ze++){if((Ae=fe.charCodeAt(Ze))>55295&&Ae<57344){if(!De){Ae>56319||Ze+1===fe.length?(re[me++]=239,re[me++]=191,re[me++]=189):De=Ae;continue}if(Ae<56320){re[me++]=239,re[me++]=191,re[me++]=189,De=Ae;continue}Ae=De-55296<<10|Ae-56320|65536,De=null}else De&&(re[me++]=239,re[me++]=191,re[me++]=189,De=null);Ae<128?re[me++]=Ae:(Ae<2048?re[me++]=Ae>>6|192:(Ae<65536?re[me++]=Ae>>12|224:(re[me++]=Ae>>18|240,re[me++]=Ae>>12&63|128),re[me++]=Ae>>6&63|128),re[me++]=63&Ae|128)}return me}(this.buf,b,this.pos);var G=this.pos-I;G>=128&&mp(I,G,this),this.pos=I-1,this.writeVarint(G),this.pos+=G},writeFloat:function(b){this.realloc(4),dp(this.buf,b,this.pos,!0,23,4),this.pos+=4},writeDouble:function(b){this.realloc(8),dp(this.buf,b,this.pos,!0,52,8),this.pos+=8},writeBytes:function(b){var I=b.length;this.writeVarint(I),this.realloc(I);for(var G=0;G<I;G++)this.buf[this.pos++]=b[G]},writeRawMessage:function(b,I){this.pos++;var G=this.pos;b(I,this);var re=this.pos-G;re>=128&&mp(G,re,this),this.pos=G-1,this.writeVarint(re),this.pos+=re},writeMessage:function(b,I,G){this.writeTag(b,bi.Bytes),this.writeRawMessage(I,G)},writePackedVarint:function(b,I){I.length&&this.writeMessage(b,N0,I)},writePackedSVarint:function(b,I){I.length&&this.writeMessage(b,j0,I)},writePackedBoolean:function(b,I){I.length&&this.writeMessage(b,H0,I)},writePackedFloat:function(b,I){I.length&&this.writeMessage(b,U0,I)},writePackedDouble:function(b,I){I.length&&this.writeMessage(b,V0,I)},writePackedFixed32:function(b,I){I.length&&this.writeMessage(b,G0,I)},writePackedSFixed32:function(b,I){I.length&&this.writeMessage(b,q0,I)},writePackedFixed64:function(b,I){I.length&&this.writeMessage(b,Y0,I)},writePackedSFixed64:function(b,I){I.length&&this.writeMessage(b,W0,I)},writeBytesField:function(b,I){this.writeTag(b,bi.Bytes),this.writeBytes(I)},writeFixed32Field:function(b,I){this.writeTag(b,bi.Fixed32),this.writeFixed32(I)},writeSFixed32Field:function(b,I){this.writeTag(b,bi.Fixed32),this.writeSFixed32(I)},writeFixed64Field:function(b,I){this.writeTag(b,bi.Fixed64),this.writeFixed64(I)},writeSFixed64Field:function(b,I){this.writeTag(b,bi.Fixed64),this.writeSFixed64(I)},writeVarintField:function(b,I){this.writeTag(b,bi.Varint),this.writeVarint(I)},writeSVarintField:function(b,I){this.writeTag(b,bi.Varint),this.writeSVarint(I)},writeStringField:function(b,I){this.writeTag(b,bi.Bytes),this.writeString(I)},writeFloatField:function(b,I){this.writeTag(b,bi.Fixed32),this.writeFloat(I)},writeDoubleField:function(b,I){this.writeTag(b,bi.Fixed64),this.writeDouble(I)},writeBooleanField:function(b,I){this.writeVarintField(b,Boolean(I))}};function X0(b,I,G){b===1&&G.readMessage(Z0,I)}function Z0(b,I,G){if(b===3){var re=G.readMessage(K0,{}),fe=re.id,me=re.bitmap,Ae=re.width,De=re.height,Ze=re.left,ut=re.top,gt=re.advance;I.push({id:fe,bitmap:new tu({width:Ae+6,height:De+6},me),metrics:{width:Ae,height:De,left:Ze,top:ut,advance:gt}})}}function K0(b,I,G){b===1?I.id=G.readVarint():b===2?I.bitmap=G.readBytes():b===3?I.width=G.readVarint():b===4?I.height=G.readVarint():b===5?I.left=G.readSVarint():b===6?I.top=G.readSVarint():b===7&&(I.advance=G.readVarint())}function yp(b){for(var I=0,G=0,re=0,fe=b;re<fe.length;re+=1){var me=fe[re];I+=me.w*me.h,G=Math.max(G,me.w)}b.sort(function(gr,Cr){return Cr.h-gr.h});for(var Ae=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(I/.95)),G),h:1/0}],De=0,Ze=0,ut=0,gt=b;ut<gt.length;ut+=1)for(var Bt=gt[ut],Wt=Ae.length-1;Wt>=0;Wt--){var Ht=Ae[Wt];if(!(Bt.w>Ht.w||Bt.h>Ht.h)){if(Bt.x=Ht.x,Bt.y=Ht.y,Ze=Math.max(Ze,Bt.y+Bt.h),De=Math.max(De,Bt.x+Bt.w),Bt.w===Ht.w&&Bt.h===Ht.h){var ar=Ae.pop();Wt<Ae.length&&(Ae[Wt]=ar)}else Bt.h===Ht.h?(Ht.x+=Bt.w,Ht.w-=Bt.w):Bt.w===Ht.w?(Ht.y+=Bt.h,Ht.h-=Bt.h):(Ae.push({x:Ht.x+Bt.w,y:Ht.y,w:Ht.w-Bt.w,h:Bt.h}),Ht.y+=Bt.h,Ht.h-=Bt.h);break}}return{w:De,h:Ze,fill:I/(De*Ze)||0}}var Fc=function(b,I){var G=I.pixelRatio,re=I.version,fe=I.stretchX,me=I.stretchY,Ae=I.content;this.paddedRect=b,this.pixelRatio=G,this.stretchX=fe,this.stretchY=me,this.content=Ae,this.version=re},tc={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};tc.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},tc.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},tc.tlbr.get=function(){return this.tl.concat(this.br)},tc.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Fc.prototype,tc);var rc=function(b,I){var G={},re={};this.haveRenderCallbacks=[];var fe=[];this.addImages(b,G,fe),this.addImages(I,re,fe);var me=yp(fe),Ae=me.w,De=me.h,Ze=new hs({width:Ae||1,height:De||1});for(var ut in b){var gt=b[ut],Bt=G[ut].paddedRect;hs.copy(gt.data,Ze,{x:0,y:0},{x:Bt.x+1,y:Bt.y+1},gt.data)}for(var Wt in I){var Ht=I[Wt],ar=re[Wt].paddedRect,gr=ar.x+1,Cr=ar.y+1,Er=Ht.data.width,Fr=Ht.data.height;hs.copy(Ht.data,Ze,{x:0,y:0},{x:gr,y:Cr},Ht.data),hs.copy(Ht.data,Ze,{x:0,y:Fr-1},{x:gr,y:Cr-1},{width:Er,height:1}),hs.copy(Ht.data,Ze,{x:0,y:0},{x:gr,y:Cr+Fr},{width:Er,height:1}),hs.copy(Ht.data,Ze,{x:Er-1,y:0},{x:gr-1,y:Cr},{width:1,height:Fr}),hs.copy(Ht.data,Ze,{x:0,y:0},{x:gr+Er,y:Cr},{width:1,height:Fr})}this.image=Ze,this.iconPositions=G,this.patternPositions=re};rc.prototype.addImages=function(b,I,G){for(var re in b){var fe=b[re],me={x:0,y:0,w:fe.data.width+2,h:fe.data.height+2};G.push(me),I[re]=new Fc(me,fe),fe.hasRenderCallback&&this.haveRenderCallbacks.push(re)}},rc.prototype.patchUpdatedImages=function(b,I){for(var G in b.dispatchRenderCallbacks(this.haveRenderCallbacks),b.updatedImages)this.patchUpdatedImage(this.iconPositions[G],b.getImage(G),I),this.patchUpdatedImage(this.patternPositions[G],b.getImage(G),I)},rc.prototype.patchUpdatedImage=function(b,I,G){if(b&&I&&b.version!==I.version){b.version=I.version;var re=b.tl,fe=re[0],me=re[1];G.update(I.data,void 0,{x:fe,y:me})}},Xr("ImagePosition",Fc),Xr("ImageAtlas",rc);var Cs={horizontal:1,vertical:2,horizontalOnly:3},_u=function(){this.scale=1,this.fontStack="",this.imageName=null};_u.forText=function(b,I){var G=new _u;return G.scale=b||1,G.fontStack=I,G},_u.forImage=function(b){var I=new _u;return I.imageName=b,I};var Ko=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Bc(b,I,G,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar,gr){var Cr,Er=Ko.fromFeature(b,fe);Bt===Cs.vertical&&Er.verticalizePunctuation();var Fr=yo.processBidirectionalText,Br=yo.processStyledBidirectionalText;if(Fr&&Er.sections.length===1){Cr=[];for(var Hr=0,fn=Fr(Er.toString(),th(Er,ut,me,I,re,Ht,ar));Hr<fn.length;Hr+=1){var xn=fn[Hr],Nn=new Ko;Nn.text=xn,Nn.sections=Er.sections;for(var Fn=0;Fn<xn.length;Fn++)Nn.sectionIndex.push(0);Cr.push(Nn)}}else if(Br){Cr=[];for(var qn=0,na=Br(Er.text,Er.sectionIndex,th(Er,ut,me,I,re,Ht,ar));qn<na.length;qn+=1){var ia=na[qn],Zn=new Ko;Zn.text=ia[0],Zn.sectionIndex=ia[1],Zn.sections=Er.sections,Cr.push(Zn)}}else Cr=function(oa,$a){for(var Va=[],ri=oa.text,_a=0,Ya=0,_i=$a;Ya<_i.length;Ya+=1){var gi=_i[Ya];Va.push(oa.substring(_a,gi)),_a=gi}return _a<ri.length&&Va.push(oa.substring(_a,ri.length)),Va}(Er,th(Er,ut,me,I,re,Ht,ar));var ha=[],ca={positionedLines:ha,text:Er.toString(),top:gt[1],bottom:gt[1],left:gt[0],right:gt[0],writingMode:Bt,iconsInText:!1,verticalizable:!1};return function(oa,$a,Va,ri,_a,Ya,_i,gi,Pi,mi,ho,Ii){for(var Wo=0,Oo=-17,Ro=0,os=0,Jo=gi==="right"?1:gi==="left"?0:.5,po=0,Fo=0,eo=_a;Fo<eo.length;Fo+=1){var xo=eo[Fo];xo.trim();var Ra=xo.getMaxScale(),ei=24*(Ra-1),Gi={positionedGlyphs:[],lineOffset:0};oa.positionedLines[po]=Gi;var qi=Gi.positionedGlyphs,ji=0;if(xo.length()){for(var Oi=0;Oi<xo.length();Oi++){var si=xo.getSection(Oi),Yi=xo.getSectionIndex(Oi),ss=xo.getCharCode(Oi),Ts=0,$o=null,al=null,El=null,Do=24,il=!(Pi===Cs.horizontal||!ho&&!da(ss)||ho&&(Nc[ss]||(Nl=ss,Mn.Arabic(Nl)||Mn["Arabic Supplement"](Nl)||Mn["Arabic Extended-A"](Nl)||Mn["Arabic Presentation Forms-A"](Nl)||Mn["Arabic Presentation Forms-B"](Nl))));if(si.imageName){var ol=ri[si.imageName];if(!ol)continue;El=si.imageName,oa.iconsInText=oa.iconsInText||!0,al=ol.paddedRect;var sl=ol.displaySize;si.scale=24*si.scale/Ii,$o={width:sl[0],height:sl[1],left:1,top:-3,advance:il?sl[1]:sl[0]};var fh=24-sl[1]*si.scale;Ts=ei+fh,Do=$o.advance;var Cu=il?sl[0]*si.scale-24*Ra:sl[1]*si.scale-24*Ra;Cu>0&&Cu>ji&&(ji=Cu)}else{var Xc=Va[si.fontStack],iu=Xc&&Xc[ss];if(iu&&iu.rect)al=iu.rect,$o=iu.metrics;else{var Zc=$a[si.fontStack],Kc=Zc&&Zc[ss];if(!Kc)continue;$o=Kc.metrics}Ts=24*(Ra-si.scale)}il?(oa.verticalizable=!0,qi.push({glyph:ss,imageName:El,x:Wo,y:Oo+Ts,vertical:il,scale:si.scale,fontStack:si.fontStack,sectionIndex:Yi,metrics:$o,rect:al}),Wo+=Do*si.scale+mi):(qi.push({glyph:ss,imageName:El,x:Wo,y:Oo+Ts,vertical:il,scale:si.scale,fontStack:si.fontStack,sectionIndex:Yi,metrics:$o,rect:al}),Wo+=$o.advance*si.scale+mi)}if(qi.length!==0){var Jc=Wo-mi;Ro=Math.max(Jc,Ro),$0(qi,0,qi.length-1,Jo,ji)}Wo=0;var $c=Ya*Ra+ji;Gi.lineOffset=Math.max(ji,ei),Oo+=$c,os=Math.max($c,os),++po}else Oo+=Ya,++po}var Nl,Lu=Oo- -17,Qc=rh(_i),Pu=Qc.horizontalAlign,jl=Qc.verticalAlign;(function(ic,ef,tf,rf,oc,nf,sc,af,lc){var of=(ef-tf)*oc,Iu=0;Iu=nf!==sc?-af*rf- -17:(-rf*lc+.5)*sc;for(var Ou=0,Du=ic;Ou<Du.length;Ou+=1)for(var sf=Du[Ou],zu=0,uc=sf.positionedGlyphs;zu<uc.length;zu+=1){var Ru=uc[zu];Ru.x+=of,Ru.y+=Iu}})(oa.positionedLines,Jo,Pu,jl,Ro,os,Ya,Lu,_a.length),oa.top+=-jl*Lu,oa.bottom=oa.top+Lu,oa.left+=-Pu*Ro,oa.right=oa.left+Ro}(ca,I,G,re,Cr,Ae,De,Ze,Bt,ut,Wt,gr),!function(oa){for(var $a=0,Va=oa;$a<Va.length;$a+=1)if(Va[$a].positionedGlyphs.length!==0)return!1;return!0}(ha)&&ca}Ko.fromFeature=function(b,I){for(var G=new Ko,re=0;re<b.sections.length;re++){var fe=b.sections[re];fe.image?G.addImageSection(fe):G.addTextSection(fe,I)}return G},Ko.prototype.length=function(){return this.text.length},Ko.prototype.getSection=function(b){return this.sections[this.sectionIndex[b]]},Ko.prototype.getSectionIndex=function(b){return this.sectionIndex[b]},Ko.prototype.getCharCode=function(b){return this.text.charCodeAt(b)},Ko.prototype.verticalizePunctuation=function(){this.text=function(b){for(var I="",G=0;G<b.length;G++){var re=b.charCodeAt(G+1)||null,fe=b.charCodeAt(G-1)||null;(!re||!za(re)||ec[b[G+1]])&&(!fe||!za(fe)||ec[b[G-1]])&&ec[b[G]]?I+=ec[b[G]]:I+=b[G]}return I}(this.text)},Ko.prototype.trim=function(){for(var b=0,I=0;I<this.text.length&&Nc[this.text.charCodeAt(I)];I++)b++;for(var G=this.text.length,re=this.text.length-1;re>=0&&re>=b&&Nc[this.text.charCodeAt(re)];re--)G--;this.text=this.text.substring(b,G),this.sectionIndex=this.sectionIndex.slice(b,G)},Ko.prototype.substring=function(b,I){var G=new Ko;return G.text=this.text.substring(b,I),G.sectionIndex=this.sectionIndex.slice(b,I),G.sections=this.sections,G},Ko.prototype.toString=function(){return this.text},Ko.prototype.getMaxScale=function(){var b=this;return this.sectionIndex.reduce(function(I,G){return Math.max(I,b.sections[G].scale)},0)},Ko.prototype.addTextSection=function(b,I){this.text+=b.text,this.sections.push(_u.forText(b.scale,b.fontStack||I));for(var G=this.sections.length-1,re=0;re<b.text.length;++re)this.sectionIndex.push(G)},Ko.prototype.addImageSection=function(b){var I=b.image?b.image.name:"";if(I.length!==0){var G=this.getNextImageSectionCharCode();G?(this.text+=String.fromCharCode(G),this.sections.push(_u.forImage(I)),this.sectionIndex.push(this.sections.length-1)):k("Reached maximum number of images 6401")}else k("Can't add FormattedSection with an empty image.")},Ko.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Nc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ws={};function xp(b,I,G,re,fe,me){if(I.imageName){var Ae=re[I.imageName];return Ae?Ae.displaySize[0]*I.scale*24/me+fe:0}var De=G[I.fontStack],Ze=De&&De[b];return Ze?Ze.metrics.advance*I.scale+fe:0}function bp(b,I,G,re){var fe=Math.pow(b-I,2);return re?b<I?fe/2:2*fe:fe+Math.abs(G)*G}function J0(b,I,G){var re=0;return b===10&&(re-=1e4),G&&(re+=150),b!==40&&b!==65288||(re+=50),I!==41&&I!==65289||(re+=50),re}function _p(b,I,G,re,fe,me){for(var Ae=null,De=bp(I,G,fe,me),Ze=0,ut=re;Ze<ut.length;Ze+=1){var gt=ut[Ze],Bt=bp(I-gt.x,G,fe,me)+gt.badness;Bt<=De&&(Ae=gt,De=Bt)}return{index:b,x:I,priorBreak:Ae,badness:De}}function th(b,I,G,re,fe,me,Ae){if(me!=="point")return[];if(!b)return[];for(var De,Ze=[],ut=function(Cr,Er,Fr,Br,Hr,fn){for(var xn=0,Nn=0;Nn<Cr.length();Nn++){var Fn=Cr.getSection(Nn);xn+=xp(Cr.getCharCode(Nn),Fn,Br,Hr,Er,fn)}return xn/Math.max(1,Math.ceil(xn/Fr))}(b,I,G,re,fe,Ae),gt=b.text.indexOf("\u200B")>=0,Bt=0,Wt=0;Wt<b.length();Wt++){var Ht=b.getSection(Wt),ar=b.getCharCode(Wt);if(Nc[ar]||(Bt+=xp(ar,Ht,re,fe,I,Ae)),Wt<b.length()-1){var gr=!!(!((De=ar)<11904)&&(Mn["Bopomofo Extended"](De)||Mn.Bopomofo(De)||Mn["CJK Compatibility Forms"](De)||Mn["CJK Compatibility Ideographs"](De)||Mn["CJK Compatibility"](De)||Mn["CJK Radicals Supplement"](De)||Mn["CJK Strokes"](De)||Mn["CJK Symbols and Punctuation"](De)||Mn["CJK Unified Ideographs Extension A"](De)||Mn["CJK Unified Ideographs"](De)||Mn["Enclosed CJK Letters and Months"](De)||Mn["Halfwidth and Fullwidth Forms"](De)||Mn.Hiragana(De)||Mn["Ideographic Description Characters"](De)||Mn["Kangxi Radicals"](De)||Mn["Katakana Phonetic Extensions"](De)||Mn.Katakana(De)||Mn["Vertical Forms"](De)||Mn["Yi Radicals"](De)||Mn["Yi Syllables"](De)));(ws[ar]||gr||Ht.imageName)&&Ze.push(_p(Wt+1,Bt,ut,Ze,J0(ar,b.getCharCode(Wt+1),gr&&gt),!1))}}return function Cr(Er){return Er?Cr(Er.priorBreak).concat(Er.index):[]}(_p(b.length(),Bt,ut,Ze,0,!0))}function rh(b){var I=.5,G=.5;switch(b){case"right":case"top-right":case"bottom-right":I=1;break;case"left":case"top-left":case"bottom-left":I=0}switch(b){case"bottom":case"bottom-right":case"bottom-left":G=1;break;case"top":case"top-right":case"top-left":G=0}return{horizontalAlign:I,verticalAlign:G}}function $0(b,I,G,re,fe){if(re||fe)for(var me=b[G],Ae=me.metrics.advance*me.scale,De=(b[G].x+Ae)*re,Ze=I;Ze<=G;Ze++)b[Ze].x-=De,b[Ze].y+=fe}function wp(b,I,G,re,fe,me){var Ae,De=b.image;if(De.content){var Ze=De.content,ut=De.pixelRatio||1;Ae=[Ze[0]/ut,Ze[1]/ut,De.displaySize[0]-Ze[2]/ut,De.displaySize[1]-Ze[3]/ut]}var gt,Bt,Wt,Ht,ar=I.left*me,gr=I.right*me;G==="width"||G==="both"?(Ht=fe[0]+ar-re[3],Bt=fe[0]+gr+re[1]):Bt=(Ht=fe[0]+(ar+gr-De.displaySize[0])/2)+De.displaySize[0];var Cr=I.top*me,Er=I.bottom*me;return G==="height"||G==="both"?(gt=fe[1]+Cr-re[0],Wt=fe[1]+Er+re[2]):Wt=(gt=fe[1]+(Cr+Er-De.displaySize[1])/2)+De.displaySize[1],{image:De,top:gt,right:Bt,bottom:Wt,left:Ht,collisionPadding:Ae}}ws[10]=!0,ws[32]=!0,ws[38]=!0,ws[40]=!0,ws[41]=!0,ws[43]=!0,ws[45]=!0,ws[47]=!0,ws[173]=!0,ws[183]=!0,ws[8203]=!0,ws[8208]=!0,ws[8211]=!0,ws[8231]=!0;var wu=function(b){function I(G,re,fe,me){b.call(this,G,re),this.angle=fe,me!==void 0&&(this.segment=me)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.clone=function(){return new I(this.x,this.y,this.angle,this.segment)},I}(l);Xr("Anchor",wu);function nh(b,I){var G=I.expression;if(G.kind==="constant")return{kind:"constant",layoutSize:G.evaluate(new ii(b+1))};if(G.kind==="source")return{kind:"source"};for(var re=G.zoomStops,fe=G.interpolationType,me=0;me<re.length&&re[me]<=b;)me++;for(var Ae=me=Math.max(0,me-1);Ae<re.length&&re[Ae]<b+1;)Ae++;Ae=Math.min(re.length-1,Ae);var De=re[me],Ze=re[Ae];return G.kind==="composite"?{kind:"composite",minZoom:De,maxZoom:Ze,interpolationType:fe}:{kind:"camera",minZoom:De,maxZoom:Ze,minSize:G.evaluate(new ii(De)),maxSize:G.evaluate(new ii(Ze)),interpolationType:fe}}function Tp(b,I,G){var re=I.uSize,fe=I.uSizeT,me=G.lowerSize,Ae=G.upperSize;return b.kind==="source"?me/128:b.kind==="composite"?Yn(me/128,Ae/128,fe):re}function kp(b,I){var G=0,re=0;if(b.kind==="constant")re=b.layoutSize;else if(b.kind!=="source"){var fe=b.interpolationType,me=b.minZoom,Ae=b.maxZoom,De=fe?n(Wa.interpolationFactor(fe,I,me,Ae),0,1):0;b.kind==="camera"?re=Yn(b.minSize,b.maxSize,De):G=De}return{uSizeT:G,uSize:re}}var Q0=Object.freeze({__proto__:null,getSizeData:nh,evaluateSizeForFeature:Tp,evaluateSizeForZoom:kp,SIZE_PACK_FACTOR:128});function Ap(b,I,G,re,fe){if(I.segment===void 0)return!0;for(var me=I,Ae=I.segment+1,De=0;De>-G/2;){if(--Ae<0)return!1;De-=b[Ae].dist(me),me=b[Ae]}De+=b[Ae].dist(b[Ae+1]),Ae++;for(var Ze=[],ut=0;De<G/2;){var gt=b[Ae-1],Bt=b[Ae],Wt=b[Ae+1];if(!Wt)return!1;var Ht=gt.angleTo(Bt)-Bt.angleTo(Wt);for(Ht=Math.abs((Ht+3*Math.PI)%(2*Math.PI)-Math.PI),Ze.push({distance:De,angleDelta:Ht}),ut+=Ht;De-Ze[0].distance>re;)ut-=Ze.shift().angleDelta;if(ut>fe)return!1;Ae++,De+=Bt.dist(Wt)}return!0}function Mp(b){for(var I=0,G=0;G<b.length-1;G++)I+=b[G].dist(b[G+1]);return I}function Sp(b,I,G){return b?.6*I*G:0}function Ep(b,I){return Math.max(b?b.right-b.left:0,I?I.right-I.left:0)}function eg(b,I,G,re,fe,me){for(var Ae=Sp(G,fe,me),De=Ep(G,re)*me,Ze=0,ut=Mp(b)/2,gt=0;gt<b.length-1;gt++){var Bt=b[gt],Wt=b[gt+1],Ht=Bt.dist(Wt);if(Ze+Ht>ut){var ar=(ut-Ze)/Ht,gr=Yn(Bt.x,Wt.x,ar),Cr=Yn(Bt.y,Wt.y,ar),Er=new wu(gr,Cr,Wt.angleTo(Bt),gt);return Er._round(),!Ae||Ap(b,Er,De,Ae,I)?Er:void 0}Ze+=Ht}}function tg(b,I,G,re,fe,me,Ae,De,Ze){var ut=Sp(re,me,Ae),gt=Ep(re,fe),Bt=gt*Ae,Wt=b[0].x===0||b[0].x===Ze||b[0].y===0||b[0].y===Ze;return I-Bt<I/4&&(I=Bt+I/4),function Ht(ar,gr,Cr,Er,Fr,Br,Hr,fn,xn){for(var Nn=Br/2,Fn=Mp(ar),qn=0,na=gr-Cr,ia=[],Zn=0;Zn<ar.length-1;Zn++){for(var ha=ar[Zn],ca=ar[Zn+1],oa=ha.dist(ca),$a=ca.angleTo(ha);na+Cr<qn+oa;){var Va=((na+=Cr)-qn)/oa,ri=Yn(ha.x,ca.x,Va),_a=Yn(ha.y,ca.y,Va);if(ri>=0&&ri<xn&&_a>=0&&_a<xn&&na-Nn>=0&&na+Nn<=Fn){var Ya=new wu(ri,_a,$a,Zn);Ya._round(),Er&&!Ap(ar,Ya,Br,Er,Fr)||ia.push(Ya)}}qn+=oa}return fn||ia.length||Hr||(ia=Ht(ar,qn/2,Cr,Er,Fr,Br,Hr,!0,xn)),ia}(b,Wt?I/2*De%I:(gt/2+2*me)*Ae*De%I,I,ut,G,Bt,Wt,!1,Ze)}function Cp(b,I,G,re,fe){for(var me=[],Ae=0;Ae<b.length;Ae++)for(var De=b[Ae],Ze=void 0,ut=0;ut<De.length-1;ut++){var gt=De[ut],Bt=De[ut+1];gt.x<I&&Bt.x<I||(gt.x<I?gt=new l(I,gt.y+(Bt.y-gt.y)*((I-gt.x)/(Bt.x-gt.x)))._round():Bt.x<I&&(Bt=new l(I,gt.y+(Bt.y-gt.y)*((I-gt.x)/(Bt.x-gt.x)))._round()),gt.y<G&&Bt.y<G||(gt.y<G?gt=new l(gt.x+(Bt.x-gt.x)*((G-gt.y)/(Bt.y-gt.y)),G)._round():Bt.y<G&&(Bt=new l(gt.x+(Bt.x-gt.x)*((G-gt.y)/(Bt.y-gt.y)),G)._round()),gt.x>=re&&Bt.x>=re||(gt.x>=re?gt=new l(re,gt.y+(Bt.y-gt.y)*((re-gt.x)/(Bt.x-gt.x)))._round():Bt.x>=re&&(Bt=new l(re,gt.y+(Bt.y-gt.y)*((re-gt.x)/(Bt.x-gt.x)))._round()),gt.y>=fe&&Bt.y>=fe||(gt.y>=fe?gt=new l(gt.x+(Bt.x-gt.x)*((fe-gt.y)/(Bt.y-gt.y)),fe)._round():Bt.y>=fe&&(Bt=new l(gt.x+(Bt.x-gt.x)*((fe-gt.y)/(Bt.y-gt.y)),fe)._round()),Ze&&gt.equals(Ze[Ze.length-1])||(Ze=[gt],me.push(Ze)),Ze.push(Bt)))))}return me}function Lp(b,I,G,re){var fe=[],me=b.image,Ae=me.pixelRatio,De=me.paddedRect.w-2,Ze=me.paddedRect.h-2,ut=b.right-b.left,gt=b.bottom-b.top,Bt=me.stretchX||[[0,De]],Wt=me.stretchY||[[0,Ze]],Ht=function(Ya,_i){return Ya+_i[1]-_i[0]},ar=Bt.reduce(Ht,0),gr=Wt.reduce(Ht,0),Cr=De-ar,Er=Ze-gr,Fr=0,Br=ar,Hr=0,fn=gr,xn=0,Nn=Cr,Fn=0,qn=Er;if(me.content&&re){var na=me.content;Fr=jc(Bt,0,na[0]),Hr=jc(Wt,0,na[1]),Br=jc(Bt,na[0],na[2]),fn=jc(Wt,na[1],na[3]),xn=na[0]-Fr,Fn=na[1]-Hr,Nn=na[2]-na[0]-Br,qn=na[3]-na[1]-fn}var ia=function(Ya,_i,gi,Pi){var mi=Uc(Ya.stretch-Fr,Br,ut,b.left),ho=Vc(Ya.fixed-xn,Nn,Ya.stretch,ar),Ii=Uc(_i.stretch-Hr,fn,gt,b.top),Wo=Vc(_i.fixed-Fn,qn,_i.stretch,gr),Oo=Uc(gi.stretch-Fr,Br,ut,b.left),Ro=Vc(gi.fixed-xn,Nn,gi.stretch,ar),os=Uc(Pi.stretch-Hr,fn,gt,b.top),Jo=Vc(Pi.fixed-Fn,qn,Pi.stretch,gr),po=new l(mi,Ii),Fo=new l(Oo,Ii),eo=new l(Oo,os),xo=new l(mi,os),Ra=new l(ho/Ae,Wo/Ae),ei=new l(Ro/Ae,Jo/Ae),Gi=I*Math.PI/180;if(Gi){var qi=Math.sin(Gi),ji=Math.cos(Gi),Oi=[ji,-qi,qi,ji];po._matMult(Oi),Fo._matMult(Oi),xo._matMult(Oi),eo._matMult(Oi)}var si=Ya.stretch+Ya.fixed,Yi=gi.stretch+gi.fixed,ss=_i.stretch+_i.fixed,Ts=Pi.stretch+Pi.fixed;return{tl:po,tr:Fo,bl:xo,br:eo,tex:{x:me.paddedRect.x+1+si,y:me.paddedRect.y+1+ss,w:Yi-si,h:Ts-ss},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ra,pixelOffsetBR:ei,minFontScaleX:Nn/Ae/ut,minFontScaleY:qn/Ae/gt,isSDF:G}};if(re&&(me.stretchX||me.stretchY))for(var Zn=Pp(Bt,Cr,ar),ha=Pp(Wt,Er,gr),ca=0;ca<Zn.length-1;ca++)for(var oa=Zn[ca],$a=Zn[ca+1],Va=0;Va<ha.length-1;Va++){var ri=ha[Va],_a=ha[Va+1];fe.push(ia(oa,ri,$a,_a))}else fe.push(ia({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:De+1},{fixed:0,stretch:Ze+1}));return fe}function jc(b,I,G){for(var re=0,fe=0,me=b;fe<me.length;fe+=1){var Ae=me[fe];re+=Math.max(I,Math.min(G,Ae[1]))-Math.max(I,Math.min(G,Ae[0]))}return re}function Pp(b,I,G){for(var re=[{fixed:-1,stretch:0}],fe=0,me=b;fe<me.length;fe+=1){var Ae=me[fe],De=Ae[0],Ze=Ae[1],ut=re[re.length-1];re.push({fixed:De-ut.stretch,stretch:ut.stretch}),re.push({fixed:De-ut.stretch,stretch:ut.stretch+(Ze-De)})}return re.push({fixed:I+1,stretch:G}),re}function Uc(b,I,G,re){return b/I*G+re}function Vc(b,I,G,re){return b-I*G/re}var Hc=function(b,I,G,re,fe,me,Ae,De,Ze,ut){if(this.boxStartIndex=b.length,Ze){var gt=me.top,Bt=me.bottom,Wt=me.collisionPadding;Wt&&(gt-=Wt[1],Bt+=Wt[3]);var Ht=Bt-gt;Ht>0&&(Ht=Math.max(10,Ht),this.circleDiameter=Ht)}else{var ar=me.top*Ae-De,gr=me.bottom*Ae+De,Cr=me.left*Ae-De,Er=me.right*Ae+De,Fr=me.collisionPadding;if(Fr&&(Cr-=Fr[0]*Ae,ar-=Fr[1]*Ae,Er+=Fr[2]*Ae,gr+=Fr[3]*Ae),ut){var Br=new l(Cr,ar),Hr=new l(Er,ar),fn=new l(Cr,gr),xn=new l(Er,gr),Nn=ut*Math.PI/180;Br._rotate(Nn),Hr._rotate(Nn),fn._rotate(Nn),xn._rotate(Nn),Cr=Math.min(Br.x,Hr.x,fn.x,xn.x),Er=Math.max(Br.x,Hr.x,fn.x,xn.x),ar=Math.min(Br.y,Hr.y,fn.y,xn.y),gr=Math.max(Br.y,Hr.y,fn.y,xn.y)}b.emplaceBack(I.x,I.y,Cr,ar,Er,gr,G,re,fe)}this.boxEndIndex=b.length},Tu=function(b,I){if(b===void 0&&(b=[]),I===void 0&&(I=rg),this.data=b,this.length=this.data.length,this.compare=I,this.length>0)for(var G=(this.length>>1)-1;G>=0;G--)this._down(G)};function rg(b,I){return b<I?-1:b>I?1:0}function ng(b,I,G){I===void 0&&(I=1),G===void 0&&(G=!1);for(var re=1/0,fe=1/0,me=-1/0,Ae=-1/0,De=b[0],Ze=0;Ze<De.length;Ze++){var ut=De[Ze];(!Ze||ut.x<re)&&(re=ut.x),(!Ze||ut.y<fe)&&(fe=ut.y),(!Ze||ut.x>me)&&(me=ut.x),(!Ze||ut.y>Ae)&&(Ae=ut.y)}var gt=me-re,Bt=Ae-fe,Wt=Math.min(gt,Bt),Ht=Wt/2,ar=new Tu([],ag);if(Wt===0)return new l(re,fe);for(var gr=re;gr<me;gr+=Wt)for(var Cr=fe;Cr<Ae;Cr+=Wt)ar.push(new ku(gr+Ht,Cr+Ht,Ht,b));for(var Er=function(Hr){for(var fn=0,xn=0,Nn=0,Fn=Hr[0],qn=0,na=Fn.length,ia=na-1;qn<na;ia=qn++){var Zn=Fn[qn],ha=Fn[ia],ca=Zn.x*ha.y-ha.x*Zn.y;xn+=(Zn.x+ha.x)*ca,Nn+=(Zn.y+ha.y)*ca,fn+=3*ca}return new ku(xn/fn,Nn/fn,0,Hr)}(b),Fr=ar.length;ar.length;){var Br=ar.pop();(Br.d>Er.d||!Er.d)&&(Er=Br,G&&console.log("found best %d after %d probes",Math.round(1e4*Br.d)/1e4,Fr)),Br.max-Er.d<=I||(Ht=Br.h/2,ar.push(new ku(Br.p.x-Ht,Br.p.y-Ht,Ht,b)),ar.push(new ku(Br.p.x+Ht,Br.p.y-Ht,Ht,b)),ar.push(new ku(Br.p.x-Ht,Br.p.y+Ht,Ht,b)),ar.push(new ku(Br.p.x+Ht,Br.p.y+Ht,Ht,b)),Fr+=4)}return G&&(console.log("num probes: "+Fr),console.log("best distance: "+Er.d)),Er.p}function ag(b,I){return I.max-b.max}function ku(b,I,G,re){this.p=new l(b,I),this.h=G,this.d=function(fe,me){for(var Ae=!1,De=1/0,Ze=0;Ze<me.length;Ze++)for(var ut=me[Ze],gt=0,Bt=ut.length,Wt=Bt-1;gt<Bt;Wt=gt++){var Ht=ut[gt],ar=ut[Wt];Ht.y>fe.y!=ar.y>fe.y&&fe.x<(ar.x-Ht.x)*(fe.y-Ht.y)/(ar.y-Ht.y)+Ht.x&&(Ae=!Ae),De=Math.min(De,Tl(fe,Ht,ar))}return(Ae?1:-1)*Math.sqrt(De)}(this.p,re),this.max=this.d+this.h*Math.SQRT2}Tu.prototype.push=function(b){this.data.push(b),this.length++,this._up(this.length-1)},Tu.prototype.pop=function(){if(this.length!==0){var b=this.data[0],I=this.data.pop();return this.length--,this.length>0&&(this.data[0]=I,this._down(0)),b}},Tu.prototype.peek=function(){return this.data[0]},Tu.prototype._up=function(b){for(var I=this.data,G=this.compare,re=I[b];b>0;){var fe=b-1>>1,me=I[fe];if(G(re,me)>=0)break;I[b]=me,b=fe}I[b]=re},Tu.prototype._down=function(b){for(var I=this.data,G=this.compare,re=this.length>>1,fe=I[b];b<re;){var me=1+(b<<1),Ae=I[me],De=me+1;if(De<this.length&&G(I[De],Ae)<0&&(me=De,Ae=I[De]),G(Ae,fe)>=0)break;I[b]=Ae,b=me}I[b]=fe};var ah=Number.POSITIVE_INFINITY;function Ip(b,I){return I[1]!==ah?function(G,re,fe){var me=0,Ae=0;switch(re=Math.abs(re),fe=Math.abs(fe),G){case"top-right":case"top-left":case"top":Ae=fe-7;break;case"bottom-right":case"bottom-left":case"bottom":Ae=7-fe}switch(G){case"top-right":case"bottom-right":case"right":me=-re;break;case"top-left":case"bottom-left":case"left":me=re}return[me,Ae]}(b,I[0],I[1]):function(G,re){var fe=0,me=0;re<0&&(re=0);var Ae=re/Math.sqrt(2);switch(G){case"top-right":case"top-left":me=Ae-7;break;case"bottom-right":case"bottom-left":me=7-Ae;break;case"bottom":me=7-re;break;case"top":me=re-7}switch(G){case"top-right":case"bottom-right":fe=-Ae;break;case"top-left":case"bottom-left":fe=Ae;break;case"left":fe=re;break;case"right":fe=-re}return[fe,me]}(b,I[0])}function ih(b){switch(b){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Op(b,I,G,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar){var gr=function(Hr,fn,xn,Nn,Fn,qn,na,ia){for(var Zn=Nn.layout.get("text-rotate").evaluate(qn,{})*Math.PI/180,ha=[],ca=0,oa=fn.positionedLines;ca<oa.length;ca+=1)for(var $a=oa[ca],Va=0,ri=$a.positionedGlyphs;Va<ri.length;Va+=1){var _a=ri[Va];if(_a.rect){var Ya=_a.rect||{},_i=4,gi=!0,Pi=1,mi=0,ho=(Fn||ia)&&_a.vertical,Ii=_a.metrics.advance*_a.scale/2;if(ia&&fn.verticalizable){var Wo=24*(_a.scale-1),Oo=(24-_a.metrics.width*_a.scale)/2;mi=$a.lineOffset/2-(_a.imageName?-Oo:Wo)}if(_a.imageName){var Ro=na[_a.imageName];gi=Ro.sdf,_i=1/(Pi=Ro.pixelRatio)}var os=Fn?[_a.x+Ii,_a.y]:[0,0],Jo=Fn?[0,0]:[_a.x+Ii+xn[0],_a.y+xn[1]-mi],po=[0,0];ho&&(po=Jo,Jo=[0,0]);var Fo=(_a.metrics.left-_i)*_a.scale-Ii+Jo[0],eo=(-_a.metrics.top-_i)*_a.scale+Jo[1],xo=Fo+Ya.w*_a.scale/Pi,Ra=eo+Ya.h*_a.scale/Pi,ei=new l(Fo,eo),Gi=new l(xo,eo),qi=new l(Fo,Ra),ji=new l(xo,Ra);if(ho){var Oi=new l(-Ii,Ii- -17),si=-Math.PI/2,Yi=12-Ii,ss=_a.imageName?Yi:0,Ts=new l(22-Yi,-ss),$o=new(Function.prototype.bind.apply(l,[null].concat(po)));ei._rotateAround(si,Oi)._add(Ts)._add($o),Gi._rotateAround(si,Oi)._add(Ts)._add($o),qi._rotateAround(si,Oi)._add(Ts)._add($o),ji._rotateAround(si,Oi)._add(Ts)._add($o)}if(Zn){var al=Math.sin(Zn),El=Math.cos(Zn),Do=[El,-al,al,El];ei._matMult(Do),Gi._matMult(Do),qi._matMult(Do),ji._matMult(Do)}var il=new l(0,0),ol=new l(0,0);ha.push({tl:ei,tr:Gi,bl:qi,br:ji,tex:Ya,writingMode:fn.writingMode,glyphOffset:os,sectionIndex:_a.sectionIndex,isSDF:gi,pixelOffsetTL:il,pixelOffsetBR:ol,minFontScaleX:0,minFontScaleY:0})}}return ha}(0,G,De,fe,me,Ae,re,b.allowVerticalPlacement),Cr=b.textSizeData,Er=null;Cr.kind==="source"?(Er=[128*fe.layout.get("text-size").evaluate(Ae,{})])[0]>32640&&k(b.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Cr.kind==="composite"&&((Er=[128*Ht.compositeTextSizes[0].evaluate(Ae,{},ar),128*Ht.compositeTextSizes[1].evaluate(Ae,{},ar)])[0]>32640||Er[1]>32640)&&k(b.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),b.addSymbols(b.text,gr,Er,De,me,Ae,ut,I,Ze.lineStartIndex,Ze.lineLength,Wt,ar);for(var Fr=0,Br=gt;Fr<Br.length;Fr+=1)Bt[Br[Fr]]=b.text.placedSymbolArray.length-1;return 4*gr.length}function Dp(b){for(var I in b)return b[I];return null}function ig(b,I,G,re){var fe=b.compareText;if(I in fe){for(var me=fe[I],Ae=me.length-1;Ae>=0;Ae--)if(re.dist(me[Ae])<G)return!0}else fe[I]=[];return fe[I].push(re),!1}var og=yu.VectorTileFeature.types,sg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Gc(b,I,G,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt){var Ht=De?Math.min(32640,Math.round(De[0])):0,ar=De?Math.min(32640,Math.round(De[1])):0;b.emplaceBack(I,G,Math.round(32*re),Math.round(32*fe),me,Ae,(Ht<<1)+(Ze?1:0),ar,16*ut,16*gt,256*Bt,256*Wt)}function oh(b,I,G){b.emplaceBack(I.x,I.y,G),b.emplaceBack(I.x,I.y,G),b.emplaceBack(I.x,I.y,G),b.emplaceBack(I.x,I.y,G)}function lg(b){for(var I=0,G=b.sections;I<G.length;I+=1)if(Qn(G[I].text))return!0;return!1}var Au=function(b){this.layoutVertexArray=new el,this.indexArray=new lo,this.programConfigurations=b,this.segments=new Ft,this.dynamicLayoutVertexArray=new Es,this.opacityVertexArray=new Ol,this.placedSymbolArray=new Ne};Au.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Au.prototype.upload=function(b,I,G,re){this.isEmpty()||(G&&(this.layoutVertexBuffer=b.createVertexBuffer(this.layoutVertexArray,eh.members),this.indexBuffer=b.createIndexBuffer(this.indexArray,I),this.dynamicLayoutVertexBuffer=b.createVertexBuffer(this.dynamicLayoutVertexArray,z0.members,!0),this.opacityVertexBuffer=b.createVertexBuffer(this.opacityVertexArray,sg,!0),this.opacityVertexBuffer.itemSize=1),(G||re)&&this.programConfigurations.upload(b))},Au.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Xr("SymbolBuffers",Au);var nc=function(b,I,G){this.layoutVertexArray=new b,this.layoutAttributes=I,this.indexArray=new G,this.segments=new Ft,this.collisionVertexArray=new tl};nc.prototype.upload=function(b){this.layoutVertexBuffer=b.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=b.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=b.createVertexBuffer(this.collisionVertexArray,R0.members,!0)},nc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Xr("CollisionBuffers",nc);var hi=function(b){this.collisionBoxArray=b.collisionBoxArray,this.zoom=b.zoom,this.overscaling=b.overscaling,this.layers=b.layers,this.layerIds=this.layers.map(function(Ae){return Ae.id}),this.index=b.index,this.pixelRatio=b.pixelRatio,this.sourceLayerIndex=b.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Yu([]),this.placementViewportMatrix=Yu([]);var I=this.layers[0]._unevaluatedLayout._values;this.textSizeData=nh(this.zoom,I["text-size"]),this.iconSizeData=nh(this.zoom,I["icon-size"]);var G=this.layers[0].layout,re=G.get("symbol-sort-key"),fe=G.get("symbol-z-order");this.sortFeaturesByKey=fe!=="viewport-y"&&re.constantOr(1)!==void 0;var me=fe==="viewport-y"||fe==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=me&&(G.get("text-allow-overlap")||G.get("icon-allow-overlap")||G.get("text-ignore-placement")||G.get("icon-ignore-placement")),G.get("symbol-placement")==="point"&&(this.writingModes=G.get("text-writing-mode").map(function(Ae){return Cs[Ae]})),this.stateDependentLayerIds=this.layers.filter(function(Ae){return Ae.isStateDependent()}).map(function(Ae){return Ae.id}),this.sourceID=b.sourceID};hi.prototype.createArrays=function(){this.text=new Au(new di(eh.members,this.layers,this.zoom,function(b){return/^text/.test(b)})),this.icon=new Au(new di(eh.members,this.layers,this.zoom,function(b){return/^icon/.test(b)})),this.glyphOffsetArray=new bt,this.lineVertexArray=new Ct,this.symbolInstances=new nt},hi.prototype.calculateGlyphDependencies=function(b,I,G,re,fe){for(var me=0;me<b.length;me++)if(I[b.charCodeAt(me)]=!0,(G||re)&&fe){var Ae=ec[b.charAt(me)];Ae&&(I[Ae.charCodeAt(0)]=!0)}},hi.prototype.populate=function(b,I,G){var re=this.layers[0],fe=re.layout,me=fe.get("text-font"),Ae=fe.get("text-field"),De=fe.get("icon-image"),Ze=(Ae.value.kind!=="constant"||Ae.value.value instanceof Rr&&!Ae.value.value.isEmpty()||Ae.value.value.toString().length>0)&&(me.value.kind!=="constant"||me.value.value.length>0),ut=De.value.kind!=="constant"||!!De.value.value||Object.keys(De.parameters).length>0,gt=fe.get("symbol-sort-key");if(this.features=[],Ze||ut){for(var Bt=I.iconDependencies,Wt=I.glyphDependencies,Ht=I.availableImages,ar=new ii(this.zoom),gr=0,Cr=b;gr<Cr.length;gr+=1){var Er=Cr[gr],Fr=Er.feature,Br=Er.id,Hr=Er.index,fn=Er.sourceLayerIndex,xn=re._featureFilter.needGeometry,Nn={type:Fr.type,id:Br,properties:Fr.properties,geometry:xn?xi(Fr):[]};if(re._featureFilter.filter(ar,Nn,G)){xn||(Nn.geometry=xi(Fr));var Fn=void 0;if(Ze){var qn=re.getValueAndResolveTokens("text-field",Nn,G,Ht),na=Rr.factory(qn);lg(na)&&(this.hasRTLText=!0),(!this.hasRTLText||Zi()==="unavailable"||this.hasRTLText&&yo.isParsed())&&(Fn=B0(na,re,Nn))}var ia=void 0;if(ut){var Zn=re.getValueAndResolveTokens("icon-image",Nn,G,Ht);ia=Zn instanceof _r?Zn:_r.fromString(Zn)}if(Fn||ia){var ha=this.sortFeaturesByKey?gt.evaluate(Nn,{},G):void 0,ca={id:Br,text:Fn,icon:ia,index:Hr,sourceLayerIndex:fn,geometry:xi(Fr),properties:Fr.properties,type:og[Fr.type],sortKey:ha};if(this.features.push(ca),ia&&(Bt[ia.name]=!0),Fn){var oa=me.evaluate(Nn,{},G).join(","),$a=fe.get("text-rotation-alignment")==="map"&&fe.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Cs.vertical)>=0;for(var Va=0,ri=Fn.sections;Va<ri.length;Va+=1){var _a=ri[Va];if(_a.image)Bt[_a.image.name]=!0;else{var Ya=Da(Fn.toString()),_i=_a.fontStack||oa,gi=Wt[_i]=Wt[_i]||{};this.calculateGlyphDependencies(_a.text,gi,$a,this.allowVerticalPlacement,Ya)}}}}}}fe.get("symbol-placement")==="line"&&(this.features=function(Pi){var mi={},ho={},Ii=[],Wo=0;function Oo(ji){Ii.push(Pi[ji]),Wo++}function Ro(ji,Oi,si){var Yi=ho[ji];return delete ho[ji],ho[Oi]=Yi,Ii[Yi].geometry[0].pop(),Ii[Yi].geometry[0]=Ii[Yi].geometry[0].concat(si[0]),Yi}function os(ji,Oi,si){var Yi=mi[Oi];return delete mi[Oi],mi[ji]=Yi,Ii[Yi].geometry[0].shift(),Ii[Yi].geometry[0]=si[0].concat(Ii[Yi].geometry[0]),Yi}function Jo(ji,Oi,si){var Yi=si?Oi[0][Oi[0].length-1]:Oi[0][0];return ji+":"+Yi.x+":"+Yi.y}for(var po=0;po<Pi.length;po++){var Fo=Pi[po],eo=Fo.geometry,xo=Fo.text?Fo.text.toString():null;if(xo){var Ra=Jo(xo,eo),ei=Jo(xo,eo,!0);if(Ra in ho&&ei in mi&&ho[Ra]!==mi[ei]){var Gi=os(Ra,ei,eo),qi=Ro(Ra,ei,Ii[Gi].geometry);delete mi[Ra],delete ho[ei],ho[Jo(xo,Ii[qi].geometry,!0)]=qi,Ii[Gi].geometry=null}else Ra in ho?Ro(Ra,ei,eo):ei in mi?os(Ra,ei,eo):(Oo(po),mi[Ra]=Wo-1,ho[ei]=Wo-1)}else Oo(po)}return Ii.filter(function(ji){return ji.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Pi,mi){return Pi.sortKey-mi.sortKey})}},hi.prototype.update=function(b,I,G){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(b,I,this.layers,G),this.icon.programConfigurations.updatePaintArrays(b,I,this.layers,G))},hi.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},hi.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},hi.prototype.upload=function(b){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(b),this.iconCollisionBox.upload(b)),this.text.upload(b,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(b,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},hi.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},hi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},hi.prototype.addToLineVertexArray=function(b,I){var G=this.lineVertexArray.length;if(b.segment!==void 0){for(var re=b.dist(I[b.segment+1]),fe=b.dist(I[b.segment]),me={},Ae=b.segment+1;Ae<I.length;Ae++)me[Ae]={x:I[Ae].x,y:I[Ae].y,tileUnitDistanceFromAnchor:re},Ae<I.length-1&&(re+=I[Ae+1].dist(I[Ae]));for(var De=b.segment||0;De>=0;De--)me[De]={x:I[De].x,y:I[De].y,tileUnitDistanceFromAnchor:fe},De>0&&(fe+=I[De-1].dist(I[De]));for(var Ze=0;Ze<I.length;Ze++){var ut=me[Ze];this.lineVertexArray.emplaceBack(ut.x,ut.y,ut.tileUnitDistanceFromAnchor)}}return{lineStartIndex:G,lineLength:this.lineVertexArray.length-G}},hi.prototype.addSymbols=function(b,I,G,re,fe,me,Ae,De,Ze,ut,gt,Bt){for(var Wt=b.indexArray,Ht=b.layoutVertexArray,ar=b.segments.prepareSegment(4*I.length,Ht,Wt,me.sortKey),gr=this.glyphOffsetArray.length,Cr=ar.vertexLength,Er=this.allowVerticalPlacement&&Ae===Cs.vertical?Math.PI/2:0,Fr=me.text&&me.text.sections,Br=0;Br<I.length;Br++){var Hr=I[Br],fn=Hr.tl,xn=Hr.tr,Nn=Hr.bl,Fn=Hr.br,qn=Hr.tex,na=Hr.pixelOffsetTL,ia=Hr.pixelOffsetBR,Zn=Hr.minFontScaleX,ha=Hr.minFontScaleY,ca=Hr.glyphOffset,oa=Hr.isSDF,$a=Hr.sectionIndex,Va=ar.vertexLength,ri=ca[1];Gc(Ht,De.x,De.y,fn.x,ri+fn.y,qn.x,qn.y,G,oa,na.x,na.y,Zn,ha),Gc(Ht,De.x,De.y,xn.x,ri+xn.y,qn.x+qn.w,qn.y,G,oa,ia.x,na.y,Zn,ha),Gc(Ht,De.x,De.y,Nn.x,ri+Nn.y,qn.x,qn.y+qn.h,G,oa,na.x,ia.y,Zn,ha),Gc(Ht,De.x,De.y,Fn.x,ri+Fn.y,qn.x+qn.w,qn.y+qn.h,G,oa,ia.x,ia.y,Zn,ha),oh(b.dynamicLayoutVertexArray,De,Er),Wt.emplaceBack(Va,Va+1,Va+2),Wt.emplaceBack(Va+1,Va+2,Va+3),ar.vertexLength+=4,ar.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ca[0]),Br!==I.length-1&&$a===I[Br+1].sectionIndex||b.programConfigurations.populatePaintArrays(Ht.length,me,me.index,{},Bt,Fr&&Fr[$a])}b.placedSymbolArray.emplaceBack(De.x,De.y,gr,this.glyphOffsetArray.length-gr,Cr,Ze,ut,De.segment,G?G[0]:0,G?G[1]:0,re[0],re[1],Ae,0,!1,0,gt)},hi.prototype._addCollisionDebugVertex=function(b,I,G,re,fe,me){return I.emplaceBack(0,0),b.emplaceBack(G.x,G.y,re,fe,Math.round(me.x),Math.round(me.y))},hi.prototype.addCollisionDebugVertices=function(b,I,G,re,fe,me,Ae){var De=fe.segments.prepareSegment(4,fe.layoutVertexArray,fe.indexArray),Ze=De.vertexLength,ut=fe.layoutVertexArray,gt=fe.collisionVertexArray,Bt=Ae.anchorX,Wt=Ae.anchorY;this._addCollisionDebugVertex(ut,gt,me,Bt,Wt,new l(b,I)),this._addCollisionDebugVertex(ut,gt,me,Bt,Wt,new l(G,I)),this._addCollisionDebugVertex(ut,gt,me,Bt,Wt,new l(G,re)),this._addCollisionDebugVertex(ut,gt,me,Bt,Wt,new l(b,re)),De.vertexLength+=4;var Ht=fe.indexArray;Ht.emplaceBack(Ze,Ze+1),Ht.emplaceBack(Ze+1,Ze+2),Ht.emplaceBack(Ze+2,Ze+3),Ht.emplaceBack(Ze+3,Ze),De.primitiveLength+=4},hi.prototype.addDebugCollisionBoxes=function(b,I,G,re){for(var fe=b;fe<I;fe++){var me=this.collisionBoxArray.get(fe),Ae=me.x1,De=me.y1,Ze=me.x2,ut=me.y2;this.addCollisionDebugVertices(Ae,De,Ze,ut,re?this.textCollisionBox:this.iconCollisionBox,me.anchorPoint,G)}},hi.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new nc(Bs,hp.members,F),this.iconCollisionBox=new nc(Bs,hp.members,F);for(var b=0;b<this.symbolInstances.length;b++){var I=this.symbolInstances.get(b);this.addDebugCollisionBoxes(I.textBoxStartIndex,I.textBoxEndIndex,I,!0),this.addDebugCollisionBoxes(I.verticalTextBoxStartIndex,I.verticalTextBoxEndIndex,I,!0),this.addDebugCollisionBoxes(I.iconBoxStartIndex,I.iconBoxEndIndex,I,!1),this.addDebugCollisionBoxes(I.verticalIconBoxStartIndex,I.verticalIconBoxEndIndex,I,!1)}},hi.prototype._deserializeCollisionBoxesForSymbol=function(b,I,G,re,fe,me,Ae,De,Ze){for(var ut={},gt=I;gt<G;gt++){var Bt=b.get(gt);ut.textBox={x1:Bt.x1,y1:Bt.y1,x2:Bt.x2,y2:Bt.y2,anchorPointX:Bt.anchorPointX,anchorPointY:Bt.anchorPointY},ut.textFeatureIndex=Bt.featureIndex;break}for(var Wt=re;Wt<fe;Wt++){var Ht=b.get(Wt);ut.verticalTextBox={x1:Ht.x1,y1:Ht.y1,x2:Ht.x2,y2:Ht.y2,anchorPointX:Ht.anchorPointX,anchorPointY:Ht.anchorPointY},ut.verticalTextFeatureIndex=Ht.featureIndex;break}for(var ar=me;ar<Ae;ar++){var gr=b.get(ar);ut.iconBox={x1:gr.x1,y1:gr.y1,x2:gr.x2,y2:gr.y2,anchorPointX:gr.anchorPointX,anchorPointY:gr.anchorPointY},ut.iconFeatureIndex=gr.featureIndex;break}for(var Cr=De;Cr<Ze;Cr++){var Er=b.get(Cr);ut.verticalIconBox={x1:Er.x1,y1:Er.y1,x2:Er.x2,y2:Er.y2,anchorPointX:Er.anchorPointX,anchorPointY:Er.anchorPointY},ut.verticalIconFeatureIndex=Er.featureIndex;break}return ut},hi.prototype.deserializeCollisionBoxes=function(b){this.collisionArrays=[];for(var I=0;I<this.symbolInstances.length;I++){var G=this.symbolInstances.get(I);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(b,G.textBoxStartIndex,G.textBoxEndIndex,G.verticalTextBoxStartIndex,G.verticalTextBoxEndIndex,G.iconBoxStartIndex,G.iconBoxEndIndex,G.verticalIconBoxStartIndex,G.verticalIconBoxEndIndex))}},hi.prototype.hasTextData=function(){return this.text.segments.get().length>0},hi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},hi.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},hi.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},hi.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},hi.prototype.addIndicesForPlacedSymbol=function(b,I){for(var G=b.placedSymbolArray.get(I),re=G.vertexStartIndex+4*G.numGlyphs,fe=G.vertexStartIndex;fe<re;fe+=4)b.indexArray.emplaceBack(fe,fe+1,fe+2),b.indexArray.emplaceBack(fe+1,fe+2,fe+3)},hi.prototype.getSortedSymbolIndexes=function(b){if(this.sortedAngle===b&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var I=Math.sin(b),G=Math.cos(b),re=[],fe=[],me=[],Ae=0;Ae<this.symbolInstances.length;++Ae){me.push(Ae);var De=this.symbolInstances.get(Ae);re.push(0|Math.round(I*De.anchorX+G*De.anchorY)),fe.push(De.featureIndex)}return me.sort(function(Ze,ut){return re[Ze]-re[ut]||fe[ut]-fe[Ze]}),me},hi.prototype.addToSortKeyRanges=function(b,I){var G=this.sortKeyRanges[this.sortKeyRanges.length-1];G&&G.sortKey===I?G.symbolInstanceEnd=b+1:this.sortKeyRanges.push({sortKey:I,symbolInstanceStart:b,symbolInstanceEnd:b+1})},hi.prototype.sortFeatures=function(b){var I=this;if(this.sortFeaturesByY&&this.sortedAngle!==b&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(b),this.sortedAngle=b,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var G=0,re=this.symbolInstanceIndexes;G<re.length;G+=1){var fe=re[G],me=this.symbolInstances.get(fe);this.featureSortOrder.push(me.featureIndex),[me.rightJustifiedTextSymbolIndex,me.centerJustifiedTextSymbolIndex,me.leftJustifiedTextSymbolIndex].forEach(function(Ae,De,Ze){Ae>=0&&Ze.indexOf(Ae)===De&&I.addIndicesForPlacedSymbol(I.text,Ae)}),me.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,me.verticalPlacedTextSymbolIndex),me.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,me.placedIconSymbolIndex),me.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,me.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Xr("SymbolBucket",hi,{omit:["layers","collisionBoxArray","features","compareText"]}),hi.MAX_GLYPHS=65535,hi.addDynamicAttributes=oh;var ug=new Go({"symbol-placement":new la(Pe.layout_symbol["symbol-placement"]),"symbol-spacing":new la(Pe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new la(Pe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ya(Pe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new la(Pe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new la(Pe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new la(Pe.layout_symbol["icon-ignore-placement"]),"icon-optional":new la(Pe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new la(Pe.layout_symbol["icon-rotation-alignment"]),"icon-size":new ya(Pe.layout_symbol["icon-size"]),"icon-text-fit":new la(Pe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new la(Pe.layout_symbol["icon-text-fit-padding"]),"icon-image":new ya(Pe.layout_symbol["icon-image"]),"icon-rotate":new ya(Pe.layout_symbol["icon-rotate"]),"icon-padding":new la(Pe.layout_symbol["icon-padding"]),"icon-keep-upright":new la(Pe.layout_symbol["icon-keep-upright"]),"icon-offset":new ya(Pe.layout_symbol["icon-offset"]),"icon-anchor":new ya(Pe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new la(Pe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new la(Pe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new la(Pe.layout_symbol["text-rotation-alignment"]),"text-field":new ya(Pe.layout_symbol["text-field"]),"text-font":new ya(Pe.layout_symbol["text-font"]),"text-size":new ya(Pe.layout_symbol["text-size"]),"text-max-width":new ya(Pe.layout_symbol["text-max-width"]),"text-line-height":new la(Pe.layout_symbol["text-line-height"]),"text-letter-spacing":new ya(Pe.layout_symbol["text-letter-spacing"]),"text-justify":new ya(Pe.layout_symbol["text-justify"]),"text-radial-offset":new ya(Pe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new la(Pe.layout_symbol["text-variable-anchor"]),"text-anchor":new ya(Pe.layout_symbol["text-anchor"]),"text-max-angle":new la(Pe.layout_symbol["text-max-angle"]),"text-writing-mode":new la(Pe.layout_symbol["text-writing-mode"]),"text-rotate":new ya(Pe.layout_symbol["text-rotate"]),"text-padding":new la(Pe.layout_symbol["text-padding"]),"text-keep-upright":new la(Pe.layout_symbol["text-keep-upright"]),"text-transform":new ya(Pe.layout_symbol["text-transform"]),"text-offset":new ya(Pe.layout_symbol["text-offset"]),"text-allow-overlap":new la(Pe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new la(Pe.layout_symbol["text-ignore-placement"]),"text-optional":new la(Pe.layout_symbol["text-optional"])}),sh={paint:new Go({"icon-opacity":new ya(Pe.paint_symbol["icon-opacity"]),"icon-color":new ya(Pe.paint_symbol["icon-color"]),"icon-halo-color":new ya(Pe.paint_symbol["icon-halo-color"]),"icon-halo-width":new ya(Pe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ya(Pe.paint_symbol["icon-halo-blur"]),"icon-translate":new la(Pe.paint_symbol["icon-translate"]),"icon-translate-anchor":new la(Pe.paint_symbol["icon-translate-anchor"]),"text-opacity":new ya(Pe.paint_symbol["text-opacity"]),"text-color":new ya(Pe.paint_symbol["text-color"],{runtimeType:Ut,getOverride:function(b){return b.textColor},hasOverride:function(b){return!!b.textColor}}),"text-halo-color":new ya(Pe.paint_symbol["text-halo-color"]),"text-halo-width":new ya(Pe.paint_symbol["text-halo-width"]),"text-halo-blur":new ya(Pe.paint_symbol["text-halo-blur"]),"text-translate":new la(Pe.paint_symbol["text-translate"]),"text-translate-anchor":new la(Pe.paint_symbol["text-translate-anchor"])}),layout:ug},Mu=function(b){this.type=b.property.overrides?b.property.overrides.runtimeType:xt,this.defaultValue=b};Mu.prototype.evaluate=function(b){if(b.formattedSection){var I=this.defaultValue.property.overrides;if(I&&I.hasOverride(b.formattedSection))return I.getOverride(b.formattedSection)}return b.feature&&b.featureState?this.defaultValue.evaluate(b.feature,b.featureState):this.defaultValue.property.specification.default},Mu.prototype.eachChild=function(b){this.defaultValue.isConstant()||b(this.defaultValue.value._styleExpression.expression)},Mu.prototype.outputDefined=function(){return!1},Mu.prototype.serialize=function(){return null},Xr("FormatSectionOverride",Mu,{omit:["defaultValue"]});var cg=function(b){function I(G){b.call(this,G,sh)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.recalculate=function(G,re){if(b.prototype.recalculate.call(this,G,re),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var fe=this.layout.get("text-writing-mode");if(fe){for(var me=[],Ae=0,De=fe;Ae<De.length;Ae+=1){var Ze=De[Ae];me.indexOf(Ze)<0&&me.push(Ze)}this.layout._values["text-writing-mode"]=me}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},I.prototype.getValueAndResolveTokens=function(G,re,fe,me){var Ae=this.layout.get(G).evaluate(re,{},fe,me),De=this._unevaluatedLayout._values[G];return De.isDataDriven()||$t(De.value)||!Ae?Ae:function(Ze,ut){return ut.replace(/{([^{}]+)}/g,function(gt,Bt){return Bt in Ze?String(Ze[Bt]):""})}(re.properties,Ae)},I.prototype.createBucket=function(G){return new hi(G)},I.prototype.queryRadius=function(){return 0},I.prototype.queryIntersectsFeature=function(){return!1},I.prototype._setPaintOverrides=function(){for(var G=0,re=sh.paint.overridableProperties;G<re.length;G+=1){var fe=re[G];if(I.hasPaintOverride(this.layout,fe)){var me=this.paint.get(fe),Ae=new Mu(me),De=new Zt(Ae,me.property.specification),Ze=null;Ze=me.value.kind==="constant"||me.value.kind==="source"?new nr("source",De):new cr("composite",De,me.value.zoomStops,me.value._interpolationType),this.paint._values[fe]=new Ni(me.property,Ze,me.parameters)}}},I.prototype._handleOverridablePaintPropertyUpdate=function(G,re,fe){return!(!this.layout||re.isDataDriven()||fe.isDataDriven())&&I.hasPaintOverride(this.layout,G)},I.hasPaintOverride=function(G,re){var fe=G.get("text-field"),me=sh.paint.properties[re],Ae=!1,De=function(gt){for(var Bt=0,Wt=gt;Bt<Wt.length;Bt+=1){var Ht=Wt[Bt];if(me.overrides&&me.overrides.hasOverride(Ht))return void(Ae=!0)}};if(fe.value.kind==="constant"&&fe.value.value instanceof Rr)De(fe.value.value.sections);else if(fe.value.kind==="source"){var Ze=function(gt){if(!Ae)if(gt instanceof On&&pn(gt.value)===wt){var Bt=gt.value;De(Bt.sections)}else gt instanceof Pr?De(gt.sections):gt.eachChild(Ze)},ut=fe.value;ut._styleExpression&&Ze(ut._styleExpression.expression)}return Ae},I}(is),fg={paint:new Go({"background-color":new la(Pe.paint_background["background-color"]),"background-pattern":new vl(Pe.paint_background["background-pattern"]),"background-opacity":new la(Pe.paint_background["background-opacity"])})},hg=function(b){function I(G){b.call(this,G,fg)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I}(is),pg={paint:new Go({"raster-opacity":new la(Pe.paint_raster["raster-opacity"]),"raster-hue-rotate":new la(Pe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new la(Pe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new la(Pe.paint_raster["raster-brightness-max"]),"raster-saturation":new la(Pe.paint_raster["raster-saturation"]),"raster-contrast":new la(Pe.paint_raster["raster-contrast"]),"raster-resampling":new la(Pe.paint_raster["raster-resampling"]),"raster-fade-duration":new la(Pe.paint_raster["raster-fade-duration"])})},dg=function(b){function I(G){b.call(this,G,pg)}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I}(is),gg=function(b){function I(G){b.call(this,G,{}),this.implementation=G}return b&&(I.__proto__=b),I.prototype=Object.create(b&&b.prototype),I.prototype.constructor=I,I.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},I.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},I.prototype.recalculate=function(){},I.prototype.updateTransitions=function(){},I.prototype.hasTransition=function(){},I.prototype.serialize=function(){},I.prototype.onAdd=function(G){this.implementation.onAdd&&this.implementation.onAdd(G,G.painter.context.gl)},I.prototype.onRemove=function(G){this.implementation.onRemove&&this.implementation.onRemove(G,G.painter.context.gl)},I}(is),mg={circle:t0,heatmap:n0,hillshade:i0,fill:_0,"fill-extrusion":L0,line:D0,symbol:cg,background:hg,raster:dg},zp=self.HTMLImageElement,Rp=self.HTMLCanvasElement,Fp=self.HTMLVideoElement,Bp=self.ImageData,qc=self.ImageBitmap,ru=function(b,I,G,re){this.context=b,this.format=G,this.texture=b.gl.createTexture(),this.update(I,re)};ru.prototype.update=function(b,I,G){var re=b.width,fe=b.height,me=!(this.size&&this.size[0]===re&&this.size[1]===fe||G),Ae=this.context,De=Ae.gl;if(this.useMipmap=Boolean(I&&I.useMipmap),De.bindTexture(De.TEXTURE_2D,this.texture),Ae.pixelStoreUnpackFlipY.set(!1),Ae.pixelStoreUnpack.set(1),Ae.pixelStoreUnpackPremultiplyAlpha.set(this.format===De.RGBA&&(!I||I.premultiply!==!1)),me)this.size=[re,fe],b instanceof zp||b instanceof Rp||b instanceof Fp||b instanceof Bp||qc&&b instanceof qc?De.texImage2D(De.TEXTURE_2D,0,this.format,this.format,De.UNSIGNED_BYTE,b):De.texImage2D(De.TEXTURE_2D,0,this.format,re,fe,0,this.format,De.UNSIGNED_BYTE,b.data);else{var Ze=G||{x:0,y:0},ut=Ze.x,gt=Ze.y;b instanceof zp||b instanceof Rp||b instanceof Fp||b instanceof Bp||qc&&b instanceof qc?De.texSubImage2D(De.TEXTURE_2D,0,ut,gt,De.RGBA,De.UNSIGNED_BYTE,b):De.texSubImage2D(De.TEXTURE_2D,0,ut,gt,re,fe,De.RGBA,De.UNSIGNED_BYTE,b.data)}this.useMipmap&&this.isSizePowerOfTwo()&&De.generateMipmap(De.TEXTURE_2D)},ru.prototype.bind=function(b,I,G){var re=this.context.gl;re.bindTexture(re.TEXTURE_2D,this.texture),G!==re.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(G=re.LINEAR),b!==this.filter&&(re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MAG_FILTER,b),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MIN_FILTER,G||b),this.filter=b),I!==this.wrap&&(re.texParameteri(re.TEXTURE_2D,re.TEXTURE_WRAP_S,I),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_WRAP_T,I),this.wrap=I)},ru.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},ru.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var lh=function(b){var I=this;this._callback=b,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){I._triggered=!1,I._callback()})};lh.prototype.trigger=function(){var b=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){b._triggered=!1,b._callback()},0))},lh.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Su=function(b,I,G){this.target=b,this.parent=I,this.mapId=G,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},x(["receive","process"],this),this.invoker=new lh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=P()?b:self};function Np(b,I,G){var re=2*Math.PI*6378137/256/Math.pow(2,G);return[b*re-2*Math.PI*6378137/2,I*re-2*Math.PI*6378137/2]}Su.prototype.send=function(b,I,G,re,fe){var me=this;fe===void 0&&(fe=!1);var Ae=Math.round(1e18*Math.random()).toString(36).substring(0,10);G&&(this.callbacks[Ae]=G);var De=U(this.globalScope)?void 0:[];return this.target.postMessage({id:Ae,type:b,hasCallback:!!G,targetMapId:re,mustQueue:fe,sourceMapId:this.mapId,data:Jn(I,De)},De),{cancel:function(){G&&delete me.callbacks[Ae],me.target.postMessage({id:Ae,type:"<cancel>",targetMapId:re,sourceMapId:me.mapId})}}},Su.prototype.receive=function(b){var I=b.data,G=I.id;if(G&&(!I.targetMapId||this.mapId===I.targetMapId))if(I.type==="<cancel>"){delete this.tasks[G];var re=this.cancelCallbacks[G];delete this.cancelCallbacks[G],re&&re()}else P()||I.mustQueue?(this.tasks[G]=I,this.taskQueue.push(G),this.invoker.trigger()):this.processTask(G,I)},Su.prototype.process=function(){if(this.taskQueue.length){var b=this.taskQueue.shift(),I=this.tasks[b];delete this.tasks[b],this.taskQueue.length&&this.invoker.trigger(),I&&this.processTask(b,I)}},Su.prototype.processTask=function(b,I){var G=this;if(I.type==="<response>"){var re=this.callbacks[b];delete this.callbacks[b],re&&(I.error?re(Ta(I.error)):re(null,Ta(I.data)))}else{var fe=!1,me=U(this.globalScope)?void 0:[],Ae=I.hasCallback?function(gt,Bt){fe=!0,delete G.cancelCallbacks[b],G.target.postMessage({id:b,type:"<response>",sourceMapId:G.mapId,error:gt?Jn(gt):null,data:Jn(Bt,me)},me)}:function(gt){fe=!0},De=null,Ze=Ta(I.data);if(this.parent[I.type])De=this.parent[I.type](I.sourceMapId,Ze,Ae);else if(this.parent.getWorkerSource){var ut=I.type.split(".");De=this.parent.getWorkerSource(I.sourceMapId,ut[0],Ze.source)[ut[1]](Ze,Ae)}else Ae(new Error("Could not find function "+I.type));!fe&&De&&De.cancel&&(this.cancelCallbacks[b]=De.cancel)}},Su.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var co=function(b,I){b&&(I?this.setSouthWest(b).setNorthEast(I):b.length===4?this.setSouthWest([b[0],b[1]]).setNorthEast([b[2],b[3]]):this.setSouthWest(b[0]).setNorthEast(b[1]))};co.prototype.setNorthEast=function(b){return this._ne=b instanceof Li?new Li(b.lng,b.lat):Li.convert(b),this},co.prototype.setSouthWest=function(b){return this._sw=b instanceof Li?new Li(b.lng,b.lat):Li.convert(b),this},co.prototype.extend=function(b){var I,G,re=this._sw,fe=this._ne;if(b instanceof Li)I=b,G=b;else{if(!(b instanceof co)){if(Array.isArray(b)){if(b.length===4||b.every(Array.isArray)){var me=b;return this.extend(co.convert(me))}var Ae=b;return this.extend(Li.convert(Ae))}return this}if(I=b._sw,G=b._ne,!I||!G)return this}return re||fe?(re.lng=Math.min(I.lng,re.lng),re.lat=Math.min(I.lat,re.lat),fe.lng=Math.max(G.lng,fe.lng),fe.lat=Math.max(G.lat,fe.lat)):(this._sw=new Li(I.lng,I.lat),this._ne=new Li(G.lng,G.lat)),this},co.prototype.getCenter=function(){return new Li((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},co.prototype.getSouthWest=function(){return this._sw},co.prototype.getNorthEast=function(){return this._ne},co.prototype.getNorthWest=function(){return new Li(this.getWest(),this.getNorth())},co.prototype.getSouthEast=function(){return new Li(this.getEast(),this.getSouth())},co.prototype.getWest=function(){return this._sw.lng},co.prototype.getSouth=function(){return this._sw.lat},co.prototype.getEast=function(){return this._ne.lng},co.prototype.getNorth=function(){return this._ne.lat},co.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},co.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},co.prototype.isEmpty=function(){return!(this._sw&&this._ne)},co.prototype.contains=function(b){var I=Li.convert(b),G=I.lng,re=I.lat,fe=this._sw.lat<=re&&re<=this._ne.lat,me=this._sw.lng<=G&&G<=this._ne.lng;return this._sw.lng>this._ne.lng&&(me=this._sw.lng>=G&&G>=this._ne.lng),fe&&me},co.convert=function(b){return!b||b instanceof co?b:new co(b)};var Li=function(b,I){if(isNaN(b)||isNaN(I))throw new Error("Invalid LngLat object: ("+b+", "+I+")");if(this.lng=+b,this.lat=+I,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Li.prototype.wrap=function(){return new Li(a(this.lng,-180,180),this.lat)},Li.prototype.toArray=function(){return[this.lng,this.lat]},Li.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Li.prototype.distanceTo=function(b){var I=Math.PI/180,G=this.lat*I,re=b.lat*I,fe=Math.sin(G)*Math.sin(re)+Math.cos(G)*Math.cos(re)*Math.cos((b.lng-this.lng)*I);return 63710088e-1*Math.acos(Math.min(fe,1))},Li.prototype.toBounds=function(b){b===void 0&&(b=0);var I=360*b/40075017,G=I/Math.cos(Math.PI/180*this.lat);return new co(new Li(this.lng-G,this.lat-I),new Li(this.lng+G,this.lat+I))},Li.convert=function(b){if(b instanceof Li)return b;if(Array.isArray(b)&&(b.length===2||b.length===3))return new Li(Number(b[0]),Number(b[1]));if(!Array.isArray(b)&&typeof b=="object"&&b!==null)return new Li(Number("lng"in b?b.lng:b.lon),Number(b.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var jp=2*Math.PI*63710088e-1;function Up(b){return jp*Math.cos(b*Math.PI/180)}function Vp(b){return(180+b)/360}function Hp(b){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+b*Math.PI/360)))/360}function Gp(b,I){return b/Up(I)}function uh(b){var I=180-360*b;return 360/Math.PI*Math.atan(Math.exp(I*Math.PI/180))-90}var nu=function(b,I,G){G===void 0&&(G=0),this.x=+b,this.y=+I,this.z=+G};nu.fromLngLat=function(b,I){I===void 0&&(I=0);var G=Li.convert(b);return new nu(Vp(G.lng),Hp(G.lat),Gp(I,G.lat))},nu.prototype.toLngLat=function(){return new Li(360*this.x-180,uh(this.y))},nu.prototype.toAltitude=function(){return b=this.z,I=this.y,b*Up(uh(I));var b,I},nu.prototype.meterInMercatorCoordinateUnits=function(){return 1/jp*(b=uh(this.y),1/Math.cos(b*Math.PI/180));var b};var au=function(b,I,G){this.z=b,this.x=I,this.y=G,this.key=ac(0,b,b,I,G)};au.prototype.equals=function(b){return this.z===b.z&&this.x===b.x&&this.y===b.y},au.prototype.url=function(b,I){var G,re,fe,me,Ae,De=(G=this.x,re=this.y,fe=this.z,me=Np(256*G,256*(re=Math.pow(2,fe)-re-1),fe),Ae=Np(256*(G+1),256*(re+1),fe),me[0]+","+me[1]+","+Ae[0]+","+Ae[1]),Ze=function(ut,gt,Bt){for(var Wt,Ht="",ar=ut;ar>0;ar--)Ht+=(gt&(Wt=1<<ar-1)?1:0)+(Bt&Wt?2:0);return Ht}(this.z,this.x,this.y);return b[(this.x+this.y)%b.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(I==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",Ze).replace("{bbox-epsg-3857}",De)},au.prototype.getTilePoint=function(b){var I=Math.pow(2,this.z);return new l(8192*(b.x*I-this.x),8192*(b.y*I-this.y))},au.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var qp=function(b,I){this.wrap=b,this.canonical=I,this.key=ac(b,I.z,I.z,I.x,I.y)},fo=function(b,I,G,re,fe){this.overscaledZ=b,this.wrap=I,this.canonical=new au(G,+re,+fe),this.key=ac(I,b,G,re,fe)};function ac(b,I,G,re,fe){(b*=2)<0&&(b=-1*b-1);var me=1<<G;return(me*me*b+me*fe+re).toString(36)+G.toString(36)+I.toString(36)}fo.prototype.equals=function(b){return this.overscaledZ===b.overscaledZ&&this.wrap===b.wrap&&this.canonical.equals(b.canonical)},fo.prototype.scaledTo=function(b){var I=this.canonical.z-b;return b>this.canonical.z?new fo(b,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new fo(b,this.wrap,b,this.canonical.x>>I,this.canonical.y>>I)},fo.prototype.calculateScaledKey=function(b,I){var G=this.canonical.z-b;return b>this.canonical.z?ac(this.wrap*+I,b,this.canonical.z,this.canonical.x,this.canonical.y):ac(this.wrap*+I,b,b,this.canonical.x>>G,this.canonical.y>>G)},fo.prototype.isChildOf=function(b){if(b.wrap!==this.wrap)return!1;var I=this.canonical.z-b.canonical.z;return b.overscaledZ===0||b.overscaledZ<this.overscaledZ&&b.canonical.x===this.canonical.x>>I&&b.canonical.y===this.canonical.y>>I},fo.prototype.children=function(b){if(this.overscaledZ>=b)return[new fo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var I=this.canonical.z+1,G=2*this.canonical.x,re=2*this.canonical.y;return[new fo(I,this.wrap,I,G,re),new fo(I,this.wrap,I,G+1,re),new fo(I,this.wrap,I,G,re+1),new fo(I,this.wrap,I,G+1,re+1)]},fo.prototype.isLessThan=function(b){return this.wrap<b.wrap||!(this.wrap>b.wrap)&&(this.overscaledZ<b.overscaledZ||!(this.overscaledZ>b.overscaledZ)&&(this.canonical.x<b.canonical.x||!(this.canonical.x>b.canonical.x)&&this.canonical.y<b.canonical.y))},fo.prototype.wrapped=function(){return new fo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},fo.prototype.unwrapTo=function(b){return new fo(this.overscaledZ,b,this.canonical.z,this.canonical.x,this.canonical.y)},fo.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},fo.prototype.toUnwrapped=function(){return new qp(this.wrap,this.canonical)},fo.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},fo.prototype.getTilePoint=function(b){return this.canonical.getTilePoint(new nu(b.x-this.wrap,b.y))},Xr("CanonicalTileID",au),Xr("OverscaledTileID",fo,{omit:["posMatrix"]});var Ml=function(b,I,G){if(this.uid=b,I.height!==I.width)throw new RangeError("DEM tiles must be square");if(G&&G!=="mapbox"&&G!=="terrarium")return k('"'+G+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=I.height;var re=this.dim=I.height-2;this.data=new Uint32Array(I.data.buffer),this.encoding=G||"mapbox";for(var fe=0;fe<re;fe++)this.data[this._idx(-1,fe)]=this.data[this._idx(0,fe)],this.data[this._idx(re,fe)]=this.data[this._idx(re-1,fe)],this.data[this._idx(fe,-1)]=this.data[this._idx(fe,0)],this.data[this._idx(fe,re)]=this.data[this._idx(fe,re-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(re,-1)]=this.data[this._idx(re-1,0)],this.data[this._idx(-1,re)]=this.data[this._idx(0,re-1)],this.data[this._idx(re,re)]=this.data[this._idx(re-1,re-1)]};Ml.prototype.get=function(b,I){var G=new Uint8Array(this.data.buffer),re=4*this._idx(b,I);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(G[re],G[re+1],G[re+2])},Ml.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Ml.prototype._idx=function(b,I){if(b<-1||b>=this.dim+1||I<-1||I>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(I+1)*this.stride+(b+1)},Ml.prototype._unpackMapbox=function(b,I,G){return(256*b*256+256*I+G)/10-1e4},Ml.prototype._unpackTerrarium=function(b,I,G){return 256*b+I+G/256-32768},Ml.prototype.getPixels=function(){return new hs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Ml.prototype.backfillBorder=function(b,I,G){if(this.dim!==b.dim)throw new Error("dem dimension mismatch");var re=I*this.dim,fe=I*this.dim+this.dim,me=G*this.dim,Ae=G*this.dim+this.dim;switch(I){case-1:re=fe-1;break;case 1:fe=re+1}switch(G){case-1:me=Ae-1;break;case 1:Ae=me+1}for(var De=-I*this.dim,Ze=-G*this.dim,ut=me;ut<Ae;ut++)for(var gt=re;gt<fe;gt++)this.data[this._idx(gt,ut)]=b.data[this._idx(gt+De,ut+Ze)]},Xr("DEMData",Ml);var Yc=function(b){this._stringToNumber={},this._numberToString=[];for(var I=0;I<b.length;I++){var G=b[I];this._stringToNumber[G]=I,this._numberToString[I]=G}};Yc.prototype.encode=function(b){return this._stringToNumber[b]},Yc.prototype.decode=function(b){return this._numberToString[b]};var Wc=function(b,I,G,re,fe){this.type="Feature",this._vectorTileFeature=b,b._z=I,b._x=G,b._y=re,this.properties=b.properties,this.id=fe},ch={geometry:{configurable:!0}};ch.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},ch.geometry.set=function(b){this._geometry=b},Wc.prototype.toJSON=function(){var b={geometry:this.geometry};for(var I in this)I!=="_geometry"&&I!=="_vectorTileFeature"&&(b[I]=this[I]);return b},Object.defineProperties(Wc.prototype,ch);var Eu=function(){this.state={},this.stateChanges={},this.deletedStates={}};Eu.prototype.updateState=function(b,I,G){var re=String(I);if(this.stateChanges[b]=this.stateChanges[b]||{},this.stateChanges[b][re]=this.stateChanges[b][re]||{},g(this.stateChanges[b][re],G),this.deletedStates[b]===null)for(var fe in this.deletedStates[b]={},this.state[b])fe!==re&&(this.deletedStates[b][fe]=null);else if(this.deletedStates[b]&&this.deletedStates[b][re]===null)for(var me in this.deletedStates[b][re]={},this.state[b][re])G[me]||(this.deletedStates[b][re][me]=null);else for(var Ae in G)this.deletedStates[b]&&this.deletedStates[b][re]&&this.deletedStates[b][re][Ae]===null&&delete this.deletedStates[b][re][Ae]},Eu.prototype.removeFeatureState=function(b,I,G){if(this.deletedStates[b]!==null){var re=String(I);if(this.deletedStates[b]=this.deletedStates[b]||{},G&&I!==void 0)this.deletedStates[b][re]!==null&&(this.deletedStates[b][re]=this.deletedStates[b][re]||{},this.deletedStates[b][re][G]=null);else if(I!==void 0)if(this.stateChanges[b]&&this.stateChanges[b][re])for(G in this.deletedStates[b][re]={},this.stateChanges[b][re])this.deletedStates[b][re][G]=null;else this.deletedStates[b][re]=null;else this.deletedStates[b]=null}},Eu.prototype.getState=function(b,I){var G=String(I),re=this.state[b]||{},fe=this.stateChanges[b]||{},me=g({},re[G],fe[G]);if(this.deletedStates[b]===null)return{};if(this.deletedStates[b]){var Ae=this.deletedStates[b][I];if(Ae===null)return{};for(var De in Ae)delete me[De]}return me},Eu.prototype.initializeTileState=function(b,I){b.setFeatureState(this.state,I)},Eu.prototype.coalesceChanges=function(b,I){var G={};for(var re in this.stateChanges){this.state[re]=this.state[re]||{};var fe={};for(var me in this.stateChanges[re])this.state[re][me]||(this.state[re][me]={}),g(this.state[re][me],this.stateChanges[re][me]),fe[me]=this.state[re][me];G[re]=fe}for(var Ae in this.deletedStates){this.state[Ae]=this.state[Ae]||{};var De={};if(this.deletedStates[Ae]===null)for(var Ze in this.state[Ae])De[Ze]={},this.state[Ae][Ze]={};else for(var ut in this.deletedStates[Ae]){if(this.deletedStates[Ae][ut]===null)this.state[Ae][ut]={};else for(var gt=0,Bt=Object.keys(this.deletedStates[Ae][ut]);gt<Bt.length;gt+=1){var Wt=Bt[gt];delete this.state[Ae][ut][Wt]}De[ut]=this.state[Ae][ut]}G[Ae]=G[Ae]||{},g(G[Ae],De)}if(this.stateChanges={},this.deletedStates={},Object.keys(G).length!==0)for(var Ht in b)b[Ht].setFeatureState(G,I)};var Sl=function(b,I){this.tileID=b,this.x=b.canonical.x,this.y=b.canonical.y,this.z=b.canonical.z,this.grid=new un(8192,16,0),this.grid3D=new un(8192,16,0),this.featureIndexArray=new At,this.promoteId=I};function Yp(b,I,G,re,fe){return A(b,function(me,Ae){var De=I instanceof xs?I.get(Ae):null;return De&&De.evaluate?De.evaluate(G,re,fe):De})}function Wp(b){for(var I=1/0,G=1/0,re=-1/0,fe=-1/0,me=0,Ae=b;me<Ae.length;me+=1){var De=Ae[me];I=Math.min(I,De.x),G=Math.min(G,De.y),re=Math.max(re,De.x),fe=Math.max(fe,De.y)}return{minX:I,minY:G,maxX:re,maxY:fe}}function vg(b,I){return I-b}Sl.prototype.insert=function(b,I,G,re,fe,me){var Ae=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(G,re,fe);for(var De=me?this.grid3D:this.grid,Ze=0;Ze<I.length;Ze++){for(var ut=I[Ze],gt=[1/0,1/0,-1/0,-1/0],Bt=0;Bt<ut.length;Bt++){var Wt=ut[Bt];gt[0]=Math.min(gt[0],Wt.x),gt[1]=Math.min(gt[1],Wt.y),gt[2]=Math.max(gt[2],Wt.x),gt[3]=Math.max(gt[3],Wt.y)}gt[0]<8192&&gt[1]<8192&&gt[2]>=0&&gt[3]>=0&&De.insert(Ae,gt[0],gt[1],gt[2],gt[3])}},Sl.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new yu.VectorTile(new zc(this.rawTileData)).layers,this.sourceLayerCoder=new Yc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Sl.prototype.query=function(b,I,G,re){var fe=this;this.loadVTLayers();for(var me=b.params||{},Ae=8192/b.tileSize/b.scale,De=ka(me.filter),Ze=b.queryGeometry,ut=b.queryPadding*Ae,gt=Wp(Ze),Bt=this.grid.query(gt.minX-ut,gt.minY-ut,gt.maxX+ut,gt.maxY+ut),Wt=Wp(b.cameraQueryGeometry),Ht=this.grid3D.query(Wt.minX-ut,Wt.minY-ut,Wt.maxX+ut,Wt.maxY+ut,function(fn,xn,Nn,Fn){return function(qn,na,ia,Zn,ha){for(var ca=0,oa=qn;ca<oa.length;ca+=1){var $a=oa[ca];if(na<=$a.x&&ia<=$a.y&&Zn>=$a.x&&ha>=$a.y)return!0}var Va=[new l(na,ia),new l(na,ha),new l(Zn,ha),new l(Zn,ia)];if(qn.length>2){for(var ri=0,_a=Va;ri<_a.length;ri+=1)if(_s(qn,_a[ri]))return!0}for(var Ya=0;Ya<qn.length-1;Ya++)if(Ql(qn[Ya],qn[Ya+1],Va))return!0;return!1}(b.cameraQueryGeometry,fn-ut,xn-ut,Nn+ut,Fn+ut)}),ar=0,gr=Ht;ar<gr.length;ar+=1){var Cr=gr[ar];Bt.push(Cr)}Bt.sort(vg);for(var Er,Fr={},Br=function(fn){var xn=Bt[fn];if(xn!==Er){Er=xn;var Nn=fe.featureIndexArray.get(xn),Fn=null;fe.loadMatchingFeature(Fr,Nn.bucketIndex,Nn.sourceLayerIndex,Nn.featureIndex,De,me.layers,me.availableImages,I,G,re,function(qn,na,ia){return Fn||(Fn=xi(qn)),na.queryIntersectsFeature(Ze,qn,ia,Fn,fe.z,b.transform,Ae,b.pixelPosMatrix)})}},Hr=0;Hr<Bt.length;Hr++)Br(Hr);return Fr},Sl.prototype.loadMatchingFeature=function(b,I,G,re,fe,me,Ae,De,Ze,ut,gt){var Bt=this.bucketLayerIDs[I];if(!me||function(Nn,Fn){for(var qn=0;qn<Nn.length;qn++)if(Fn.indexOf(Nn[qn])>=0)return!0;return!1}(me,Bt)){var Wt=this.sourceLayerCoder.decode(G),Ht=this.vtLayers[Wt].feature(re);if(fe.filter(new ii(this.tileID.overscaledZ),Ht))for(var ar=this.getId(Ht,Wt),gr=0;gr<Bt.length;gr++){var Cr=Bt[gr];if(!(me&&me.indexOf(Cr)<0)){var Er=De[Cr];if(Er){var Fr={};ar!==void 0&&ut&&(Fr=ut.getState(Er.sourceLayer||"_geojsonTileLayer",ar));var Br=Ze[Cr];Br.paint=Yp(Br.paint,Er.paint,Ht,Fr,Ae),Br.layout=Yp(Br.layout,Er.layout,Ht,Fr,Ae);var Hr=!gt||gt(Ht,Er,Fr);if(Hr){var fn=new Wc(Ht,this.z,this.x,this.y,ar);fn.layer=Br;var xn=b[Cr];xn===void 0&&(xn=b[Cr]=[]),xn.push({featureIndex:re,feature:fn,intersectionZ:Hr})}}}}}},Sl.prototype.lookupSymbolFeatures=function(b,I,G,re,fe,me,Ae,De){var Ze={};this.loadVTLayers();for(var ut=ka(fe),gt=0,Bt=b;gt<Bt.length;gt+=1){var Wt=Bt[gt];this.loadMatchingFeature(Ze,G,re,Wt,ut,me,Ae,De,I)}return Ze},Sl.prototype.hasLayer=function(b){for(var I=0,G=this.bucketLayerIDs;I<G.length;I+=1)for(var re=0,fe=G[I];re<fe.length;re+=1)if(b===fe[re])return!0;return!1},Sl.prototype.getId=function(b,I){var G=b.id;if(this.promoteId){var re=typeof this.promoteId=="string"?this.promoteId:this.promoteId[I];typeof(G=b.properties[re])=="boolean"&&(G=Number(G))}return G},Xr("FeatureIndex",Sl,{omit:["rawTileData","sourceLayerCoder"]});var Io=function(b,I){this.tileID=b,this.uid=y(),this.uses=0,this.tileSize=I,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Io.prototype.registerFadeDuration=function(b){var I=b+this.timeAdded;I<j.now()||this.fadeEndTime&&I<this.fadeEndTime||(this.fadeEndTime=I)},Io.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Io.prototype.loadVectorData=function(b,I,G){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",b){for(var re in b.featureIndex&&(this.latestFeatureIndex=b.featureIndex,b.rawTileData?(this.latestRawTileData=b.rawTileData,this.latestFeatureIndex.rawTileData=b.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=b.collisionBoxArray,this.buckets=function(ut,gt){var Bt={};if(!gt)return Bt;for(var Wt=function(){var gr=ar[Ht],Cr=gr.layerIds.map(function(Hr){return gt.getLayer(Hr)}).filter(Boolean);if(Cr.length!==0){gr.layers=Cr,gr.stateDependentLayerIds&&(gr.stateDependentLayers=gr.stateDependentLayerIds.map(function(Hr){return Cr.filter(function(fn){return fn.id===Hr})[0]}));for(var Er=0,Fr=Cr;Er<Fr.length;Er+=1){var Br=Fr[Er];Bt[Br.id]=gr}}},Ht=0,ar=ut;Ht<ar.length;Ht+=1)Wt();return Bt}(b.buckets,I.style),this.hasSymbolBuckets=!1,this.buckets){var fe=this.buckets[re];if(fe instanceof hi){if(this.hasSymbolBuckets=!0,!G)break;fe.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var me in this.buckets){var Ae=this.buckets[me];if(Ae instanceof hi&&Ae.hasRTLText){this.hasRTLText=!0,yo.isLoading()||yo.isLoaded()||Zi()!=="deferred"||ai();break}}for(var De in this.queryPadding=0,this.buckets){var Ze=this.buckets[De];this.queryPadding=Math.max(this.queryPadding,I.style.getLayer(De).queryRadius(Ze))}b.imageAtlas&&(this.imageAtlas=b.imageAtlas),b.glyphAtlasImage&&(this.glyphAtlasImage=b.glyphAtlasImage)}else this.collisionBoxArray=new ye},Io.prototype.unloadVectorData=function(){for(var b in this.buckets)this.buckets[b].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Io.prototype.getBucket=function(b){return this.buckets[b.id]},Io.prototype.upload=function(b){for(var I in this.buckets){var G=this.buckets[I];G.uploadPending()&&G.upload(b)}var re=b.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ru(b,this.imageAtlas.image,re.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ru(b,this.glyphAtlasImage,re.ALPHA),this.glyphAtlasImage=null)},Io.prototype.prepare=function(b){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(b,this.imageAtlasTexture)},Io.prototype.queryRenderedFeatures=function(b,I,G,re,fe,me,Ae,De,Ze,ut){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:re,cameraQueryGeometry:fe,scale:me,tileSize:this.tileSize,pixelPosMatrix:ut,transform:De,params:Ae,queryPadding:this.queryPadding*Ze},b,I,G):{}},Io.prototype.querySourceFeatures=function(b,I){var G=this.latestFeatureIndex;if(G&&G.rawTileData){var re=G.loadVTLayers(),fe=I?I.sourceLayer:"",me=re._geojsonTileLayer||re[fe];if(me)for(var Ae=ka(I&&I.filter),De=this.tileID.canonical,Ze=De.z,ut=De.x,gt=De.y,Bt={z:Ze,x:ut,y:gt},Wt=0;Wt<me.length;Wt++){var Ht=me.feature(Wt);if(Ae.filter(new ii(this.tileID.overscaledZ),Ht)){var ar=G.getId(Ht,fe),gr=new Wc(Ht,Ze,ut,gt,ar);gr.tile=Bt,b.push(gr)}}}},Io.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Io.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Io.prototype.setExpiryData=function(b){var I=this.expirationTime;if(b.cacheControl){var G=D(b.cacheControl);G["max-age"]&&(this.expirationTime=Date.now()+1e3*G["max-age"])}else b.expires&&(this.expirationTime=new Date(b.expires).getTime());if(this.expirationTime){var re=Date.now(),fe=!1;if(this.expirationTime>re)fe=!1;else if(I)if(this.expirationTime<I)fe=!0;else{var me=this.expirationTime-I;me?this.expirationTime=re+Math.max(me,3e4):fe=!0}else fe=!0;fe?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Io.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Io.prototype.setFeatureState=function(b,I){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(b).length!==0){var G=this.latestFeatureIndex.loadVTLayers();for(var re in this.buckets)if(I.style.hasLayer(re)){var fe=this.buckets[re],me=fe.layers[0].sourceLayer||"_geojsonTileLayer",Ae=G[me],De=b[me];if(Ae&&De&&Object.keys(De).length!==0){fe.update(De,Ae,this.imageAtlas&&this.imageAtlas.patternPositions||{});var Ze=I&&I.style&&I.style.getLayer(re);Ze&&(this.queryPadding=Math.max(this.queryPadding,Ze.queryRadius(fe)))}}}},Io.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Io.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<j.now()},Io.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Io.prototype.setHoldDuration=function(b){this.symbolFadeHoldUntil=j.now()+b},Io.prototype.setDependencies=function(b,I){for(var G={},re=0,fe=I;re<fe.length;re+=1)G[fe[re]]=!0;this.dependencies[b]=G},Io.prototype.hasDependency=function(b,I){for(var G=0,re=b;G<re.length;G+=1){var fe=re[G],me=this.dependencies[fe];if(me){for(var Ae=0,De=I;Ae<De.length;Ae+=1)if(me[De[Ae]])return!0}}return!1};var Bl=self.performance,Xp=function(b){this._marks={start:[b.url,"start"].join("#"),end:[b.url,"end"].join("#"),measure:b.url.toString()},Bl.mark(this._marks.start)};Xp.prototype.finish=function(){Bl.mark(this._marks.end);var b=Bl.getEntriesByName(this._marks.measure);return b.length===0&&(Bl.measure(this._marks.measure,this._marks.start,this._marks.end),b=Bl.getEntriesByName(this._marks.measure),Bl.clearMarks(this._marks.start),Bl.clearMarks(this._marks.end),Bl.clearMeasures(this._marks.measure)),b},e.Actor=Su,e.AlphaImage=tu,e.CanonicalTileID=au,e.CollisionBoxArray=ye,e.Color=ur,e.DEMData=Ml,e.DataConstantProperty=la,e.DictionaryCoder=Yc,e.EXTENT=8192,e.ErrorEvent=Ce,e.EvaluationParameters=ii,e.Event=_e,e.Evented=Le,e.FeatureIndex=Sl,e.FillBucket=rl,e.FillExtrusionBucket=nl,e.ImageAtlas=rc,e.ImagePosition=Fc,e.LineBucket=ps,e.LngLat=Li,e.LngLatBounds=co,e.MercatorCoordinate=nu,e.ONE_EM=24,e.OverscaledTileID=fo,e.Point=l,e.Point$1=l,e.Properties=Go,e.Protobuf=zc,e.RGBAImage=hs,e.RequestManager=ae,e.RequestPerformance=Xp,e.ResourceType=ct,e.SegmentVector=Ft,e.SourceFeatureState=Eu,e.StructArrayLayout1ui2=V,e.StructArrayLayout2f1f2i16=Dl,e.StructArrayLayout2i4=Ss,e.StructArrayLayout3ui6=lo,e.StructArrayLayout4i8=Di,e.SymbolBucket=hi,e.Texture=ru,e.Tile=Io,e.Transitionable=ys,e.Uniform1f=Ur,e.Uniform1i=ua,e.Uniform2f=kn,e.Uniform3f=Xn,e.Uniform4f=Gn,e.UniformColor=ea,e.UniformMatrix4f=Ma,e.UnwrappedTileID=qp,e.ValidationError=Xe,e.WritingMode=Cs,e.ZoomHistory=Ca,e.add=function(b,I,G){return b[0]=I[0]+G[0],b[1]=I[1]+G[1],b[2]=I[2]+G[2],b},e.addDynamicAttributes=oh,e.asyncAll=function(b,I,G){if(!b.length)return G(null,[]);var re=b.length,fe=new Array(b.length),me=null;b.forEach(function(Ae,De){I(Ae,function(Ze,ut){Ze&&(me=Ze),fe[De]=ut,--re==0&&G(me,fe)})})},e.bezier=i,e.bindAll=x,e.browser=j,e.cacheEntryPossiblyAdded=function(b){++Qe>Ye&&(b.getActor().send("enforceCacheSizeLimit",Fe),Qe=0)},e.clamp=n,e.clearTileCache=function(b){var I=self.caches.delete("mapbox-tiles");b&&I.catch(b).then(function(){return b()})},e.clipLine=Cp,e.clone=function(b){var I=new fs(16);return I[0]=b[0],I[1]=b[1],I[2]=b[2],I[3]=b[3],I[4]=b[4],I[5]=b[5],I[6]=b[6],I[7]=b[7],I[8]=b[8],I[9]=b[9],I[10]=b[10],I[11]=b[11],I[12]=b[12],I[13]=b[13],I[14]=b[14],I[15]=b[15],I},e.clone$1=w,e.clone$2=function(b){var I=new fs(3);return I[0]=b[0],I[1]=b[1],I[2]=b[2],I},e.collisionCircleLayout=F0,e.config=W,e.create=function(){var b=new fs(16);return fs!=Float32Array&&(b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0),b[0]=1,b[5]=1,b[10]=1,b[15]=1,b},e.create$1=function(){var b=new fs(9);return fs!=Float32Array&&(b[1]=0,b[2]=0,b[3]=0,b[5]=0,b[6]=0,b[7]=0),b[0]=1,b[4]=1,b[8]=1,b},e.create$2=function(){var b=new fs(4);return fs!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b},e.createCommonjsModule=f,e.createExpression=Yt,e.createLayout=oi,e.createStyleLayer=function(b){return b.type==="custom"?new gg(b):new mg[b.type](b)},e.cross=function(b,I,G){var re=I[0],fe=I[1],me=I[2],Ae=G[0],De=G[1],Ze=G[2];return b[0]=fe*Ze-me*De,b[1]=me*Ae-re*Ze,b[2]=re*De-fe*Ae,b},e.deepEqual=function b(I,G){if(Array.isArray(I)){if(!Array.isArray(G)||I.length!==G.length)return!1;for(var re=0;re<I.length;re++)if(!b(I[re],G[re]))return!1;return!0}if(typeof I=="object"&&I!==null&&G!==null){if(typeof G!="object"||Object.keys(I).length!==Object.keys(G).length)return!1;for(var fe in I)if(!b(I[fe],G[fe]))return!1;return!0}return I===G},e.dot=function(b,I){return b[0]*I[0]+b[1]*I[1]+b[2]*I[2]},e.dot$1=function(b,I){return b[0]*I[0]+b[1]*I[1]+b[2]*I[2]+b[3]*I[3]},e.ease=c,e.emitValidationErrors=wn,e.endsWith=T,e.enforceCacheSizeLimit=function(b){rt(),xe&&xe.then(function(I){I.keys().then(function(G){for(var re=0;re<G.length-b;re++)I.delete(G[re])})})},e.evaluateSizeForFeature=Tp,e.evaluateSizeForZoom=kp,e.evaluateVariableOffset=Ip,e.evented=Si,e.extend=g,e.featureFilter=ka,e.filterObject=S,e.fromRotation=function(b,I){var G=Math.sin(I),re=Math.cos(I);return b[0]=re,b[1]=G,b[2]=0,b[3]=-G,b[4]=re,b[5]=0,b[6]=0,b[7]=0,b[8]=1,b},e.getAnchorAlignment=rh,e.getAnchorJustification=ih,e.getArrayBuffer=_t,e.getImage=He,e.getJSON=function(b,I){return tt(g(b,{type:"json"}),I)},e.getRTLTextPluginStatus=Zi,e.getReferrer=kt,e.getVideo=function(b,I){var G,re,fe=self.document.createElement("video");fe.muted=!0,fe.onloadstart=function(){I(null,fe)};for(var me=0;me<b.length;me++){var Ae=self.document.createElement("source");G=b[me],re=void 0,(re=self.document.createElement("a")).href=G,(re.protocol!==self.document.location.protocol||re.host!==self.document.location.host)&&(fe.crossOrigin="Anonymous"),Ae.src=b[me],fe.appendChild(Ae)}return{cancel:function(){}}},e.identity=Yu,e.invert=function(b,I){var G=I[0],re=I[1],fe=I[2],me=I[3],Ae=I[4],De=I[5],Ze=I[6],ut=I[7],gt=I[8],Bt=I[9],Wt=I[10],Ht=I[11],ar=I[12],gr=I[13],Cr=I[14],Er=I[15],Fr=G*De-re*Ae,Br=G*Ze-fe*Ae,Hr=G*ut-me*Ae,fn=re*Ze-fe*De,xn=re*ut-me*De,Nn=fe*ut-me*Ze,Fn=gt*gr-Bt*ar,qn=gt*Cr-Wt*ar,na=gt*Er-Ht*ar,ia=Bt*Cr-Wt*gr,Zn=Bt*Er-Ht*gr,ha=Wt*Er-Ht*Cr,ca=Fr*ha-Br*Zn+Hr*ia+fn*na-xn*qn+Nn*Fn;return ca?(ca=1/ca,b[0]=(De*ha-Ze*Zn+ut*ia)*ca,b[1]=(fe*Zn-re*ha-me*ia)*ca,b[2]=(gr*Nn-Cr*xn+Er*fn)*ca,b[3]=(Wt*xn-Bt*Nn-Ht*fn)*ca,b[4]=(Ze*na-Ae*ha-ut*qn)*ca,b[5]=(G*ha-fe*na+me*qn)*ca,b[6]=(Cr*Hr-ar*Nn-Er*Br)*ca,b[7]=(gt*Nn-Wt*Hr+Ht*Br)*ca,b[8]=(Ae*Zn-De*na+ut*Fn)*ca,b[9]=(re*na-G*Zn-me*Fn)*ca,b[10]=(ar*xn-gr*Hr+Er*Fr)*ca,b[11]=(Bt*Hr-gt*xn-Ht*Fr)*ca,b[12]=(De*qn-Ae*ia-Ze*Fn)*ca,b[13]=(G*ia-re*qn+fe*Fn)*ca,b[14]=(gr*Br-ar*fn-Cr*Fr)*ca,b[15]=(gt*fn-Bt*Br+Wt*Fr)*ca,b):null},e.isChar=Mn,e.isMapboxURL=he,e.keysDifference=function(b,I){var G=[];for(var re in b)re in I||G.push(re);return G},e.makeRequest=tt,e.mapObject=A,e.mercatorXfromLng=Vp,e.mercatorYfromLat=Hp,e.mercatorZfromAltitude=Gp,e.mul=Vf,e.multiply=eu,e.mvt=yu,e.normalize=function(b,I){var G=I[0],re=I[1],fe=I[2],me=G*G+re*re+fe*fe;return me>0&&(me=1/Math.sqrt(me)),b[0]=I[0]*me,b[1]=I[1]*me,b[2]=I[2]*me,b},e.number=Yn,e.offscreenCanvasSupported=st,e.ortho=function(b,I,G,re,fe,me,Ae){var De=1/(I-G),Ze=1/(re-fe),ut=1/(me-Ae);return b[0]=-2*De,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=-2*Ze,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[10]=2*ut,b[11]=0,b[12]=(I+G)*De,b[13]=(fe+re)*Ze,b[14]=(Ae+me)*ut,b[15]=1,b},e.parseGlyphPBF=function(b){return new zc(b).readFields(X0,[])},e.pbf=zc,e.performSymbolLayout=function(b,I,G,re,fe,me,Ae){b.createArrays();var De=512*b.overscaling;b.tilePixelRatio=8192/De,b.compareText={},b.iconsNeedLinear=!1;var Ze=b.layers[0].layout,ut=b.layers[0]._unevaluatedLayout._values,gt={};if(b.textSizeData.kind==="composite"){var Bt=b.textSizeData,Wt=Bt.minZoom,Ht=Bt.maxZoom;gt.compositeTextSizes=[ut["text-size"].possiblyEvaluate(new ii(Wt),Ae),ut["text-size"].possiblyEvaluate(new ii(Ht),Ae)]}if(b.iconSizeData.kind==="composite"){var ar=b.iconSizeData,gr=ar.minZoom,Cr=ar.maxZoom;gt.compositeIconSizes=[ut["icon-size"].possiblyEvaluate(new ii(gr),Ae),ut["icon-size"].possiblyEvaluate(new ii(Cr),Ae)]}gt.layoutTextSize=ut["text-size"].possiblyEvaluate(new ii(b.zoom+1),Ae),gt.layoutIconSize=ut["icon-size"].possiblyEvaluate(new ii(b.zoom+1),Ae),gt.textMaxSize=ut["text-size"].possiblyEvaluate(new ii(18));for(var Er=24*Ze.get("text-line-height"),Fr=Ze.get("text-rotation-alignment")==="map"&&Ze.get("symbol-placement")!=="point",Br=Ze.get("text-keep-upright"),Hr=Ze.get("text-size"),fn=function(){var Fn=Nn[xn],qn=Ze.get("text-font").evaluate(Fn,{},Ae).join(","),na=Hr.evaluate(Fn,{},Ae),ia=gt.layoutTextSize.evaluate(Fn,{},Ae),Zn=gt.layoutIconSize.evaluate(Fn,{},Ae),ha={horizontal:{},vertical:void 0},ca=Fn.text,oa=[0,0];if(ca){var $a=ca.toString(),Va=24*Ze.get("text-letter-spacing").evaluate(Fn,{},Ae),ri=function(Ra){for(var ei=0,Gi=Ra;ei<Gi.length;ei+=1)if(!Sa(Gi[ei].charCodeAt(0)))return!1;return!0}($a)?Va:0,_a=Ze.get("text-anchor").evaluate(Fn,{},Ae),Ya=Ze.get("text-variable-anchor");if(!Ya){var _i=Ze.get("text-radial-offset").evaluate(Fn,{},Ae);oa=_i?Ip(_a,[24*_i,ah]):Ze.get("text-offset").evaluate(Fn,{},Ae).map(function(Ra){return 24*Ra})}var gi=Fr?"center":Ze.get("text-justify").evaluate(Fn,{},Ae),Pi=Ze.get("symbol-placement"),mi=Pi==="point"?24*Ze.get("text-max-width").evaluate(Fn,{},Ae):0,ho=function(){b.allowVerticalPlacement&&Da($a)&&(ha.vertical=Bc(ca,I,G,fe,qn,mi,Er,_a,"left",ri,oa,Cs.vertical,!0,Pi,ia,na))};if(!Fr&&Ya){for(var Ii=gi==="auto"?Ya.map(function(Ra){return ih(Ra)}):[gi],Wo=!1,Oo=0;Oo<Ii.length;Oo++){var Ro=Ii[Oo];if(!ha.horizontal[Ro])if(Wo)ha.horizontal[Ro]=ha.horizontal[0];else{var os=Bc(ca,I,G,fe,qn,mi,Er,"center",Ro,ri,oa,Cs.horizontal,!1,Pi,ia,na);os&&(ha.horizontal[Ro]=os,Wo=os.positionedLines.length===1)}}ho()}else{gi==="auto"&&(gi=ih(_a));var Jo=Bc(ca,I,G,fe,qn,mi,Er,_a,gi,ri,oa,Cs.horizontal,!1,Pi,ia,na);Jo&&(ha.horizontal[gi]=Jo),ho(),Da($a)&&Fr&&Br&&(ha.vertical=Bc(ca,I,G,fe,qn,mi,Er,_a,gi,ri,oa,Cs.vertical,!1,Pi,ia,na))}}var po=void 0,Fo=!1;if(Fn.icon&&Fn.icon.name){var eo=re[Fn.icon.name];eo&&(po=function(Ra,ei,Gi){var qi=rh(Gi),ji=qi.horizontalAlign,Oi=qi.verticalAlign,si=ei[0],Yi=ei[1],ss=si-Ra.displaySize[0]*ji,Ts=ss+Ra.displaySize[0],$o=Yi-Ra.displaySize[1]*Oi;return{image:Ra,top:$o,bottom:$o+Ra.displaySize[1],left:ss,right:Ts}}(fe[Fn.icon.name],Ze.get("icon-offset").evaluate(Fn,{},Ae),Ze.get("icon-anchor").evaluate(Fn,{},Ae)),Fo=eo.sdf,b.sdfIcons===void 0?b.sdfIcons=eo.sdf:b.sdfIcons!==eo.sdf&&k("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(eo.pixelRatio!==b.pixelRatio||Ze.get("icon-rotate").constantOr(1)!==0)&&(b.iconsNeedLinear=!0))}var xo=Dp(ha.horizontal)||ha.vertical;b.iconsInText=!!xo&&xo.iconsInText,(xo||po)&&function(Ra,ei,Gi,qi,ji,Oi,si,Yi,ss,Ts,$o){var al=Oi.textMaxSize.evaluate(ei,{});al===void 0&&(al=si);var El,Do=Ra.layers[0].layout,il=Do.get("icon-offset").evaluate(ei,{},$o),ol=Dp(Gi.horizontal),sl=si/24,fh=Ra.tilePixelRatio*sl,Cu=Ra.tilePixelRatio*al/24,Xc=Ra.tilePixelRatio*Yi,iu=Ra.tilePixelRatio*Do.get("symbol-spacing"),Zc=Do.get("text-padding")*Ra.tilePixelRatio,Kc=Do.get("icon-padding")*Ra.tilePixelRatio,Jc=Do.get("text-max-angle")/180*Math.PI,$c=Do.get("text-rotation-alignment")==="map"&&Do.get("symbol-placement")!=="point",Nl=Do.get("icon-rotation-alignment")==="map"&&Do.get("symbol-placement")!=="point",Lu=Do.get("symbol-placement"),Qc=iu/2,Pu=Do.get("icon-text-fit");qi&&Pu!=="none"&&(Ra.allowVerticalPlacement&&Gi.vertical&&(El=wp(qi,Gi.vertical,Pu,Do.get("icon-text-fit-padding"),il,sl)),ol&&(qi=wp(qi,ol,Pu,Do.get("icon-text-fit-padding"),il,sl)));var jl=function(xg,cc){cc.x<0||cc.x>=8192||cc.y<0||cc.y>=8192||function(Ji,ll,bg,Ul,mh,$p,lf,xl,uf,fc,cf,ff,vh,Qp,hc,ed,td,rd,nd,ad,Ls,hf,id,bl,_g){var yh,ou,Fu,Bu,Nu,ju=Ji.addToLineVertexArray(ll,bg),od=0,sd=0,ld=0,ud=0,xh=-1,bh=-1,Cl={},cd=Ar(""),_h=0,wh=0;if(xl._unevaluatedLayout.getValue("text-radial-offset")===void 0?(yh=xl.layout.get("text-offset").evaluate(Ls,{},bl).map(function(dc){return 24*dc}),_h=yh[0],wh=yh[1]):(_h=24*xl.layout.get("text-radial-offset").evaluate(Ls,{},bl),wh=ah),Ji.allowVerticalPlacement&&Ul.vertical){var fd=xl.layout.get("text-rotate").evaluate(Ls,{},bl)+90,wg=Ul.vertical;Bu=new Hc(uf,ll,fc,cf,ff,wg,vh,Qp,hc,fd),lf&&(Nu=new Hc(uf,ll,fc,cf,ff,lf,td,rd,hc,fd))}if(mh){var Th=xl.layout.get("icon-rotate").evaluate(Ls,{}),hd=xl.layout.get("icon-text-fit")!=="none",pd=Lp(mh,Th,id,hd),kh=lf?Lp(lf,Th,id,hd):void 0;Fu=new Hc(uf,ll,fc,cf,ff,mh,td,rd,!1,Th),od=4*pd.length;var dd=Ji.iconSizeData,pc=null;dd.kind==="source"?(pc=[128*xl.layout.get("icon-size").evaluate(Ls,{})])[0]>32640&&k(Ji.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):dd.kind==="composite"&&((pc=[128*hf.compositeIconSizes[0].evaluate(Ls,{},bl),128*hf.compositeIconSizes[1].evaluate(Ls,{},bl)])[0]>32640||pc[1]>32640)&&k(Ji.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ji.addSymbols(Ji.icon,pd,pc,ad,nd,Ls,!1,ll,ju.lineStartIndex,ju.lineLength,-1,bl),xh=Ji.icon.placedSymbolArray.length-1,kh&&(sd=4*kh.length,Ji.addSymbols(Ji.icon,kh,pc,ad,nd,Ls,Cs.vertical,ll,ju.lineStartIndex,ju.lineLength,-1,bl),bh=Ji.icon.placedSymbolArray.length-1)}for(var gd in Ul.horizontal){var pf=Ul.horizontal[gd];if(!ou){cd=Ar(pf.text);var Tg=xl.layout.get("text-rotate").evaluate(Ls,{},bl);ou=new Hc(uf,ll,fc,cf,ff,pf,vh,Qp,hc,Tg)}var md=pf.positionedLines.length===1;if(ld+=Op(Ji,ll,pf,$p,xl,hc,Ls,ed,ju,Ul.vertical?Cs.horizontal:Cs.horizontalOnly,md?Object.keys(Ul.horizontal):[gd],Cl,xh,hf,bl),md)break}Ul.vertical&&(ud+=Op(Ji,ll,Ul.vertical,$p,xl,hc,Ls,ed,ju,Cs.vertical,["vertical"],Cl,bh,hf,bl));var kg=ou?ou.boxStartIndex:Ji.collisionBoxArray.length,Ag=ou?ou.boxEndIndex:Ji.collisionBoxArray.length,Mg=Bu?Bu.boxStartIndex:Ji.collisionBoxArray.length,Sg=Bu?Bu.boxEndIndex:Ji.collisionBoxArray.length,Eg=Fu?Fu.boxStartIndex:Ji.collisionBoxArray.length,Cg=Fu?Fu.boxEndIndex:Ji.collisionBoxArray.length,Lg=Nu?Nu.boxStartIndex:Ji.collisionBoxArray.length,Pg=Nu?Nu.boxEndIndex:Ji.collisionBoxArray.length,_l=-1,df=function(dc,yd){return dc&&dc.circleDiameter?Math.max(dc.circleDiameter,yd):yd};_l=df(ou,_l),_l=df(Bu,_l),_l=df(Fu,_l);var vd=(_l=df(Nu,_l))>-1?1:0;vd&&(_l*=_g/24),Ji.glyphOffsetArray.length>=hi.MAX_GLYPHS&&k("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ls.sortKey!==void 0&&Ji.addToSortKeyRanges(Ji.symbolInstances.length,Ls.sortKey),Ji.symbolInstances.emplaceBack(ll.x,ll.y,Cl.right>=0?Cl.right:-1,Cl.center>=0?Cl.center:-1,Cl.left>=0?Cl.left:-1,Cl.vertical||-1,xh,bh,cd,kg,Ag,Mg,Sg,Eg,Cg,Lg,Pg,fc,ld,ud,od,sd,vd,0,vh,_h,wh,_l)}(Ra,cc,xg,Gi,qi,ji,El,Ra.layers[0],Ra.collisionBoxArray,ei.index,ei.sourceLayerIndex,Ra.index,fh,Zc,$c,ss,Xc,Kc,Nl,il,ei,Oi,Ts,$o,si)};if(Lu==="line")for(var ic=0,ef=Cp(ei.geometry,0,0,8192,8192);ic<ef.length;ic+=1)for(var tf=ef[ic],rf=tg(tf,iu,Jc,Gi.vertical||ol,qi,24,Cu,Ra.overscaling,8192),oc=0,nf=rf;oc<nf.length;oc+=1){var sc=nf[oc],af=ol;af&&ig(Ra,af.text,Qc,sc)||jl(tf,sc)}else if(Lu==="line-center")for(var lc=0,of=ei.geometry;lc<of.length;lc+=1){var Iu=of[lc];if(Iu.length>1){var Ou=eg(Iu,Jc,Gi.vertical||ol,qi,24,Cu);Ou&&jl(Iu,Ou)}}else if(ei.type==="Polygon")for(var Du=0,sf=Kf(ei.geometry,0);Du<sf.length;Du+=1){var zu=sf[Du],uc=ng(zu,16);jl(zu[0],new wu(uc.x,uc.y,0))}else if(ei.type==="LineString")for(var Ru=0,Zp=ei.geometry;Ru<Zp.length;Ru+=1){var hh=Zp[Ru];jl(hh,new wu(hh[0].x,hh[0].y,0))}else if(ei.type==="Point")for(var ph=0,Kp=ei.geometry;ph<Kp.length;ph+=1)for(var yg=Kp[ph],dh=0,Jp=yg;dh<Jp.length;dh+=1){var gh=Jp[dh];jl([gh],new wu(gh.x,gh.y,0))}}(b,Fn,ha,po,re,gt,ia,Zn,oa,Fo,Ae)},xn=0,Nn=b.features;xn<Nn.length;xn+=1)fn();me&&b.generateCollisionDebugBuffers()},e.perspective=function(b,I,G,re,fe){var me,Ae=1/Math.tan(I/2);return b[0]=Ae/G,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=Ae,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[11]=-1,b[12]=0,b[13]=0,b[15]=0,fe!=null&&fe!==1/0?(me=1/(re-fe),b[10]=(fe+re)*me,b[14]=2*fe*re*me):(b[10]=-1,b[14]=-2*re),b},e.pick=function(b,I){for(var G={},re=0;re<I.length;re++){var fe=I[re];fe in b&&(G[fe]=b[fe])}return G},e.plugin=yo,e.polygonIntersectsPolygon=Zo,e.postMapLoadEvent=ze,e.postTurnstileEvent=Me,e.potpack=yp,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.register=Xr,e.registerForPluginStateChange=function(b){return b({pluginStatus:va,pluginURL:yi}),Si.on("pluginStateChange",b),b},e.rotate=function(b,I,G){var re=I[0],fe=I[1],me=I[2],Ae=I[3],De=Math.sin(G),Ze=Math.cos(G);return b[0]=re*Ze+me*De,b[1]=fe*Ze+Ae*De,b[2]=re*-De+me*Ze,b[3]=fe*-De+Ae*Ze,b},e.rotateX=function(b,I,G){var re=Math.sin(G),fe=Math.cos(G),me=I[4],Ae=I[5],De=I[6],Ze=I[7],ut=I[8],gt=I[9],Bt=I[10],Wt=I[11];return I!==b&&(b[0]=I[0],b[1]=I[1],b[2]=I[2],b[3]=I[3],b[12]=I[12],b[13]=I[13],b[14]=I[14],b[15]=I[15]),b[4]=me*fe+ut*re,b[5]=Ae*fe+gt*re,b[6]=De*fe+Bt*re,b[7]=Ze*fe+Wt*re,b[8]=ut*fe-me*re,b[9]=gt*fe-Ae*re,b[10]=Bt*fe-De*re,b[11]=Wt*fe-Ze*re,b},e.rotateZ=function(b,I,G){var re=Math.sin(G),fe=Math.cos(G),me=I[0],Ae=I[1],De=I[2],Ze=I[3],ut=I[4],gt=I[5],Bt=I[6],Wt=I[7];return I!==b&&(b[8]=I[8],b[9]=I[9],b[10]=I[10],b[11]=I[11],b[12]=I[12],b[13]=I[13],b[14]=I[14],b[15]=I[15]),b[0]=me*fe+ut*re,b[1]=Ae*fe+gt*re,b[2]=De*fe+Bt*re,b[3]=Ze*fe+Wt*re,b[4]=ut*fe-me*re,b[5]=gt*fe-Ae*re,b[6]=Bt*fe-De*re,b[7]=Wt*fe-Ze*re,b},e.scale=function(b,I,G){var re=G[0],fe=G[1],me=G[2];return b[0]=I[0]*re,b[1]=I[1]*re,b[2]=I[2]*re,b[3]=I[3]*re,b[4]=I[4]*fe,b[5]=I[5]*fe,b[6]=I[6]*fe,b[7]=I[7]*fe,b[8]=I[8]*me,b[9]=I[9]*me,b[10]=I[10]*me,b[11]=I[11]*me,b[12]=I[12],b[13]=I[13],b[14]=I[14],b[15]=I[15],b},e.scale$1=function(b,I,G){return b[0]=I[0]*G,b[1]=I[1]*G,b[2]=I[2]*G,b[3]=I[3]*G,b},e.scale$2=function(b,I,G){return b[0]=I[0]*G,b[1]=I[1]*G,b[2]=I[2]*G,b},e.setCacheLimits=function(b,I){Fe=b,Ye=I},e.setRTLTextPlugin=function(b,I,G){if(G===void 0&&(G=!1),va===Za||va===Hi||va===cs)throw new Error("setRTLTextPlugin cannot be called multiple times.");yi=j.resolveURL(b),va=Za,Eo=I,Ka(),G||ai()},e.sphericalToCartesian=function(b){var I=b[0],G=b[1],re=b[2];return G+=90,G*=Math.PI/180,re*=Math.PI/180,{x:I*Math.cos(G)*Math.sin(re),y:I*Math.sin(G)*Math.sin(re),z:I*Math.cos(re)}},e.sqrLen=Wu,e.styleSpec=Pe,e.sub=Hf,e.symbolSize=Q0,e.transformMat3=function(b,I,G){var re=I[0],fe=I[1],me=I[2];return b[0]=re*G[0]+fe*G[3]+me*G[6],b[1]=re*G[1]+fe*G[4]+me*G[7],b[2]=re*G[2]+fe*G[5]+me*G[8],b},e.transformMat4=gu,e.translate=function(b,I,G){var re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar,gr=G[0],Cr=G[1],Er=G[2];return I===b?(b[12]=I[0]*gr+I[4]*Cr+I[8]*Er+I[12],b[13]=I[1]*gr+I[5]*Cr+I[9]*Er+I[13],b[14]=I[2]*gr+I[6]*Cr+I[10]*Er+I[14],b[15]=I[3]*gr+I[7]*Cr+I[11]*Er+I[15]):(re=I[0],fe=I[1],me=I[2],Ae=I[3],De=I[4],Ze=I[5],ut=I[6],gt=I[7],Bt=I[8],Wt=I[9],Ht=I[10],ar=I[11],b[0]=re,b[1]=fe,b[2]=me,b[3]=Ae,b[4]=De,b[5]=Ze,b[6]=ut,b[7]=gt,b[8]=Bt,b[9]=Wt,b[10]=Ht,b[11]=ar,b[12]=re*gr+De*Cr+Bt*Er+I[12],b[13]=fe*gr+Ze*Cr+Wt*Er+I[13],b[14]=me*gr+ut*Cr+Ht*Er+I[14],b[15]=Ae*gr+gt*Cr+ar*Er+I[15]),b},e.triggerPluginCompletionEvent=Co,e.uniqueId=y,e.validateCustomStyleLayer=function(b){var I=[],G=b.id;return G===void 0&&I.push({message:"layers."+G+': missing required property "id"'}),b.render===void 0&&I.push({message:"layers."+G+': missing required method "render"'}),b.renderingMode&&b.renderingMode!=="2d"&&b.renderingMode!=="3d"&&I.push({message:"layers."+G+': property "renderingMode" must be either "2d" or "3d"'}),I},e.validateLight=ln,e.validateStyle=Yr,e.values=function(b){var I=[];for(var G in b)I.push(b[G]);return I},e.vectorTile=yu,e.version="1.10.1",e.warnOnce=k,e.webpSupported=ee,e.window=self,e.wrap=a}),p(0,function(e){function f(_e){var Ce=typeof _e;if(Ce==="number"||Ce==="boolean"||Ce==="string"||_e==null)return JSON.stringify(_e);if(Array.isArray(_e)){for(var Le="[",Pe=0,Xe=_e;Pe<Xe.length;Pe+=1)Le+=f(Xe[Pe])+",";return Le+"]"}for(var ht=Object.keys(_e).sort(),Mt="{",pt=0;pt<ht.length;pt++)Mt+=JSON.stringify(ht[pt])+":"+f(_e[ht[pt]])+",";return Mt+"}"}function u(_e){for(var Ce="",Le=0,Pe=e.refProperties;Le<Pe.length;Le+=1)Ce+="/"+f(_e[Pe[Le]]);return Ce}var s=function(_e){this.keyCache={},_e&&this.replace(_e)};s.prototype.replace=function(_e){this._layerConfigs={},this._layers={},this.update(_e,[])},s.prototype.update=function(_e,Ce){for(var Le=this,Pe=0,Xe=_e;Pe<Xe.length;Pe+=1){var ht=Xe[Pe];this._layerConfigs[ht.id]=ht;var Mt=this._layers[ht.id]=e.createStyleLayer(ht);Mt._featureFilter=e.featureFilter(Mt.filter),this.keyCache[ht.id]&&delete this.keyCache[ht.id]}for(var pt=0,Lt=Ce;pt<Lt.length;pt+=1){var vt=Lt[pt];delete this.keyCache[vt],delete this._layerConfigs[vt],delete this._layers[vt]}this.familiesBySource={};for(var Dt=0,xt=function(lt,wt){for(var Ot={},Gt=0;Gt<lt.length;Gt++){var ir=wt&&wt[lt[Gt].id]||u(lt[Gt]);wt&&(wt[lt[Gt].id]=ir);var Xt=Ot[ir];Xt||(Xt=Ot[ir]=[]),Xt.push(lt[Gt])}var Kt=[];for(var or in Ot)Kt.push(Ot[or]);return Kt}(e.values(this._layerConfigs),this.keyCache);Dt<xt.length;Dt+=1){var it=xt[Dt].map(function(lt){return Le._layers[lt.id]}),St=it[0];if(St.visibility!=="none"){var Nt=St.source||"",Ut=this.familiesBySource[Nt];Ut||(Ut=this.familiesBySource[Nt]={});var Qt=St.sourceLayer||"_geojsonTileLayer",Ie=Ut[Qt];Ie||(Ie=Ut[Qt]=[]),Ie.push(it)}}};var l=function(_e){var Ce={},Le=[];for(var Pe in _e){var Xe=_e[Pe],ht=Ce[Pe]={};for(var Mt in Xe){var pt=Xe[+Mt];if(pt&&pt.bitmap.width!==0&&pt.bitmap.height!==0){var Lt={x:0,y:0,w:pt.bitmap.width+2,h:pt.bitmap.height+2};Le.push(Lt),ht[Mt]={rect:Lt,metrics:pt.metrics}}}}var vt=e.potpack(Le),Dt=vt.w,xt=vt.h,it=new e.AlphaImage({width:Dt||1,height:xt||1});for(var St in _e){var Nt=_e[St];for(var Ut in Nt){var Qt=Nt[+Ut];if(Qt&&Qt.bitmap.width!==0&&Qt.bitmap.height!==0){var Ie=Ce[St][Ut].rect;e.AlphaImage.copy(Qt.bitmap,it,{x:0,y:0},{x:Ie.x+1,y:Ie.y+1},Qt.bitmap)}}}this.image=it,this.positions=Ce};e.register("GlyphAtlas",l);var o=function(_e){this.tileID=new e.OverscaledTileID(_e.tileID.overscaledZ,_e.tileID.wrap,_e.tileID.canonical.z,_e.tileID.canonical.x,_e.tileID.canonical.y),this.uid=_e.uid,this.zoom=_e.zoom,this.pixelRatio=_e.pixelRatio,this.tileSize=_e.tileSize,this.source=_e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=_e.showCollisionBoxes,this.collectResourceTiming=!!_e.collectResourceTiming,this.returnDependencies=!!_e.returnDependencies,this.promoteId=_e.promoteId};function i(_e,Ce,Le){for(var Pe=new e.EvaluationParameters(Ce),Xe=0,ht=_e;Xe<ht.length;Xe+=1)ht[Xe].recalculate(Pe,Le)}function c(_e,Ce){var Le=e.getArrayBuffer(_e.request,function(Pe,Xe,ht,Mt){Pe?Ce(Pe):Xe&&Ce(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(Xe)),rawData:Xe,cacheControl:ht,expires:Mt})});return function(){Le.cancel(),Ce()}}o.prototype.parse=function(_e,Ce,Le,Pe,Xe){var ht=this;this.status="parsing",this.data=_e,this.collisionBoxArray=new e.CollisionBoxArray;var Mt=new e.DictionaryCoder(Object.keys(_e.layers).sort()),pt=new e.FeatureIndex(this.tileID,this.promoteId);pt.bucketLayerIDs=[];var Lt,vt,Dt,xt,it={},St={featureIndex:pt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Le},Nt=Ce.familiesBySource[this.source];for(var Ut in Nt){var Qt=_e.layers[Ut];if(Qt){Qt.version===1&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+Ut+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ie=Mt.encode(Ut),lt=[],wt=0;wt<Qt.length;wt++){var Ot=Qt.feature(wt),Gt=pt.getId(Ot,Ut);lt.push({feature:Ot,id:Gt,index:wt,sourceLayerIndex:Ie})}for(var ir=0,Xt=Nt[Ut];ir<Xt.length;ir+=1){var Kt=Xt[ir],or=Kt[0];or.minzoom&&this.zoom<Math.floor(or.minzoom)||or.maxzoom&&this.zoom>=or.maxzoom||or.visibility!=="none"&&(i(Kt,this.zoom,Le),(it[or.id]=or.createBucket({index:pt.bucketLayerIDs.length,layers:Kt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ie,sourceID:this.source})).populate(lt,St,this.tileID.canonical),pt.bucketLayerIDs.push(Kt.map(function(br){return br.id})))}}}var dr=e.mapObject(St.glyphDependencies,function(br){return Object.keys(br).map(Number)});Object.keys(dr).length?Pe.send("getGlyphs",{uid:this.uid,stacks:dr},function(br,Rr){Lt||(Lt=br,vt=Rr,pr.call(ht))}):vt={};var vr=Object.keys(St.iconDependencies);vr.length?Pe.send("getImages",{icons:vr,source:this.source,tileID:this.tileID,type:"icons"},function(br,Rr){Lt||(Lt=br,Dt=Rr,pr.call(ht))}):Dt={};var ur=Object.keys(St.patternDependencies);function pr(){if(Lt)return Xe(Lt);if(vt&&Dt&&xt){var br=new l(vt),Rr=new e.ImageAtlas(Dt,xt);for(var _r in it){var jr=it[_r];jr instanceof e.SymbolBucket?(i(jr.layers,this.zoom,Le),e.performSymbolLayout(jr,vt,br.positions,Dt,Rr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):jr.hasPattern&&(jr instanceof e.LineBucket||jr instanceof e.FillBucket||jr instanceof e.FillExtrusionBucket)&&(i(jr.layers,this.zoom,Le),jr.addFeatures(St,this.tileID.canonical,Rr.patternPositions))}this.status="done",Xe(null,{buckets:e.values(it).filter(function($r){return!$r.isEmpty()}),featureIndex:pt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:br.image,imageAtlas:Rr,glyphMap:this.returnDependencies?vt:null,iconMap:this.returnDependencies?Dt:null,glyphPositions:this.returnDependencies?br.positions:null})}}ur.length?Pe.send("getImages",{icons:ur,source:this.source,tileID:this.tileID,type:"patterns"},function(br,Rr){Lt||(Lt=br,xt=Rr,pr.call(ht))}):xt={},pr.call(this)};var n=function(_e,Ce,Le,Pe){this.actor=_e,this.layerIndex=Ce,this.availableImages=Le,this.loadVectorData=Pe||c,this.loading={},this.loaded={}};n.prototype.loadTile=function(_e,Ce){var Le=this,Pe=_e.uid;this.loading||(this.loading={});var Xe=!!(_e&&_e.request&&_e.request.collectResourceTiming)&&new e.RequestPerformance(_e.request),ht=this.loading[Pe]=new o(_e);ht.abort=this.loadVectorData(_e,function(Mt,pt){if(delete Le.loading[Pe],Mt||!pt)return ht.status="done",Le.loaded[Pe]=ht,Ce(Mt);var Lt=pt.rawData,vt={};pt.expires&&(vt.expires=pt.expires),pt.cacheControl&&(vt.cacheControl=pt.cacheControl);var Dt={};if(Xe){var xt=Xe.finish();xt&&(Dt.resourceTiming=JSON.parse(JSON.stringify(xt)))}ht.vectorTile=pt.vectorTile,ht.parse(pt.vectorTile,Le.layerIndex,Le.availableImages,Le.actor,function(it,St){if(it||!St)return Ce(it);Ce(null,e.extend({rawTileData:Lt.slice(0)},St,vt,Dt))}),Le.loaded=Le.loaded||{},Le.loaded[Pe]=ht})},n.prototype.reloadTile=function(_e,Ce){var Le=this,Pe=this.loaded,Xe=_e.uid,ht=this;if(Pe&&Pe[Xe]){var Mt=Pe[Xe];Mt.showCollisionBoxes=_e.showCollisionBoxes;var pt=function(Lt,vt){var Dt=Mt.reloadCallback;Dt&&(delete Mt.reloadCallback,Mt.parse(Mt.vectorTile,ht.layerIndex,Le.availableImages,ht.actor,Dt)),Ce(Lt,vt)};Mt.status==="parsing"?Mt.reloadCallback=pt:Mt.status==="done"&&(Mt.vectorTile?Mt.parse(Mt.vectorTile,this.layerIndex,this.availableImages,this.actor,pt):pt())}},n.prototype.abortTile=function(_e,Ce){var Le=this.loading,Pe=_e.uid;Le&&Le[Pe]&&Le[Pe].abort&&(Le[Pe].abort(),delete Le[Pe]),Ce()},n.prototype.removeTile=function(_e,Ce){var Le=this.loaded,Pe=_e.uid;Le&&Le[Pe]&&delete Le[Pe],Ce()};var a=e.window.ImageBitmap,g=function(){this.loaded={}};g.prototype.loadTile=function(_e,Ce){var Le=_e.uid,Pe=_e.encoding,Xe=_e.rawImageData,ht=a&&Xe instanceof a?this.getImageData(Xe):Xe,Mt=new e.DEMData(Le,ht,Pe);this.loaded=this.loaded||{},this.loaded[Le]=Mt,Ce(null,Mt)},g.prototype.getImageData=function(_e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(_e.width,_e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=_e.width,this.offscreenCanvas.height=_e.height,this.offscreenCanvasContext.drawImage(_e,0,0,_e.width,_e.height);var Ce=this.offscreenCanvasContext.getImageData(-1,-1,_e.width+2,_e.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:Ce.width,height:Ce.height},Ce.data)},g.prototype.removeTile=function(_e){var Ce=this.loaded,Le=_e.uid;Ce&&Ce[Le]&&delete Ce[Le]};var h=function _e(Ce,Le){var Pe,Xe=Ce&&Ce.type;if(Xe==="FeatureCollection")for(Pe=0;Pe<Ce.features.length;Pe++)_e(Ce.features[Pe],Le);else if(Xe==="GeometryCollection")for(Pe=0;Pe<Ce.geometries.length;Pe++)_e(Ce.geometries[Pe],Le);else if(Xe==="Feature")_e(Ce.geometry,Le);else if(Xe==="Polygon")y(Ce.coordinates,Le);else if(Xe==="MultiPolygon")for(Pe=0;Pe<Ce.coordinates.length;Pe++)y(Ce.coordinates[Pe],Le);return Ce};function y(_e,Ce){if(_e.length!==0){v(_e[0],Ce);for(var Le=1;Le<_e.length;Le++)v(_e[Le],!Ce)}}function v(_e,Ce){for(var Le=0,Pe=0,Xe=_e.length,ht=Xe-1;Pe<Xe;ht=Pe++)Le+=(_e[Pe][0]-_e[ht][0])*(_e[ht][1]+_e[Pe][1]);Le>=0!=!!Ce&&_e.reverse()}var _=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,x=function(_e){this._feature=_e,this.extent=e.EXTENT,this.type=_e.type,this.properties=_e.tags,"id"in _e&&!isNaN(_e.id)&&(this.id=parseInt(_e.id,10))};x.prototype.loadGeometry=function(){if(this._feature.type===1){for(var _e=[],Ce=0,Le=this._feature.geometry;Ce<Le.length;Ce+=1){var Pe=Le[Ce];_e.push([new e.Point$1(Pe[0],Pe[1])])}return _e}for(var Xe=[],ht=0,Mt=this._feature.geometry;ht<Mt.length;ht+=1){for(var pt=[],Lt=0,vt=Mt[ht];Lt<vt.length;Lt+=1){var Dt=vt[Lt];pt.push(new e.Point$1(Dt[0],Dt[1]))}Xe.push(pt)}return Xe},x.prototype.toGeoJSON=function(_e,Ce,Le){return _.call(this,_e,Ce,Le)};var T=function(_e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=_e.length,this._features=_e};T.prototype.feature=function(_e){return new x(this._features[_e])};var A=e.vectorTile.VectorTileFeature,S=w;function w(_e,Ce){this.options=Ce||{},this.features=_e,this.length=_e.length}function C(_e,Ce){this.id=typeof _e.id=="number"?_e.id:void 0,this.type=_e.type,this.rawGeometry=_e.type===1?[_e.geometry]:_e.geometry,this.properties=_e.tags,this.extent=Ce||4096}w.prototype.feature=function(_e){return new C(this.features[_e],this.options.extent)},C.prototype.loadGeometry=function(){var _e=this.rawGeometry;this.geometry=[];for(var Ce=0;Ce<_e.length;Ce++){for(var Le=_e[Ce],Pe=[],Xe=0;Xe<Le.length;Xe++)Pe.push(new e.Point$1(Le[Xe][0],Le[Xe][1]));this.geometry.push(Pe)}return this.geometry},C.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var _e=this.geometry,Ce=1/0,Le=-1/0,Pe=1/0,Xe=-1/0,ht=0;ht<_e.length;ht++)for(var Mt=_e[ht],pt=0;pt<Mt.length;pt++){var Lt=Mt[pt];Ce=Math.min(Ce,Lt.x),Le=Math.max(Le,Lt.x),Pe=Math.min(Pe,Lt.y),Xe=Math.max(Xe,Lt.y)}return[Ce,Pe,Le,Xe]},C.prototype.toGeoJSON=A.prototype.toGeoJSON;var k=D,L=D,M=function(_e,Ce){Ce=Ce||{};var Le={};for(var Pe in _e)Le[Pe]=new S(_e[Pe].features,Ce),Le[Pe].name=Pe,Le[Pe].version=Ce.version,Le[Pe].extent=Ce.extent;return D({layers:Le})},P=S;function D(_e){var Ce=new e.pbf;return function(Le,Pe){for(var Xe in Le.layers)Pe.writeMessage(3,N,Le.layers[Xe])}(_e,Ce),Ce.finish()}function N(_e,Ce){var Le;Ce.writeVarintField(15,_e.version||1),Ce.writeStringField(1,_e.name||""),Ce.writeVarintField(5,_e.extent||4096);var Pe={keys:[],values:[],keycache:{},valuecache:{}};for(Le=0;Le<_e.length;Le++)Pe.feature=_e.feature(Le),Ce.writeMessage(2,U,Pe);var Xe=Pe.keys;for(Le=0;Le<Xe.length;Le++)Ce.writeStringField(3,Xe[Le]);var ht=Pe.values;for(Le=0;Le<ht.length;Le++)Ce.writeMessage(4,H,ht[Le])}function U(_e,Ce){var Le=_e.feature;Le.id!==void 0&&Ce.writeVarintField(1,Le.id),Ce.writeMessage(2,q,_e),Ce.writeVarintField(3,Le.type),Ce.writeMessage(4,Z,Le)}function q(_e,Ce){var Le=_e.feature,Pe=_e.keys,Xe=_e.values,ht=_e.keycache,Mt=_e.valuecache;for(var pt in Le.properties){var Lt=ht[pt];Lt===void 0&&(Pe.push(pt),Lt=Pe.length-1,ht[pt]=Lt),Ce.writeVarint(Lt);var vt=Le.properties[pt],Dt=typeof vt;Dt!=="string"&&Dt!=="boolean"&&Dt!=="number"&&(vt=JSON.stringify(vt));var xt=Dt+":"+vt,it=Mt[xt];it===void 0&&(Xe.push(vt),it=Xe.length-1,Mt[xt]=it),Ce.writeVarint(it)}}function X(_e,Ce){return(Ce<<3)+(7&_e)}function K(_e){return _e<<1^_e>>31}function Z(_e,Ce){for(var Le=_e.loadGeometry(),Pe=_e.type,Xe=0,ht=0,Mt=Le.length,pt=0;pt<Mt;pt++){var Lt=Le[pt],vt=1;Pe===1&&(vt=Lt.length),Ce.writeVarint(X(1,vt));for(var Dt=Pe===3?Lt.length-1:Lt.length,xt=0;xt<Dt;xt++){xt===1&&Pe!==1&&Ce.writeVarint(X(2,Dt-1));var it=Lt[xt].x-Xe,St=Lt[xt].y-ht;Ce.writeVarint(K(it)),Ce.writeVarint(K(St)),Xe+=it,ht+=St}Pe===3&&Ce.writeVarint(X(7,1))}}function H(_e,Ce){var Le=typeof _e;Le==="string"?Ce.writeStringField(1,_e):Le==="boolean"?Ce.writeBooleanField(7,_e):Le==="number"&&(_e%1!=0?Ce.writeDoubleField(3,_e):_e<0?Ce.writeSVarintField(6,_e):Ce.writeVarintField(5,_e))}function Y(_e,Ce,Le,Pe,Xe,ht){if(!(Xe-Pe<=Le)){var Mt=Pe+Xe>>1;(function pt(Lt,vt,Dt,xt,it,St){for(;it>xt;){if(it-xt>600){var Nt=it-xt+1,Ut=Dt-xt+1,Qt=Math.log(Nt),Ie=.5*Math.exp(2*Qt/3),lt=.5*Math.sqrt(Qt*Ie*(Nt-Ie)/Nt)*(Ut-Nt/2<0?-1:1),wt=Math.max(xt,Math.floor(Dt-Ut*Ie/Nt+lt)),Ot=Math.min(it,Math.floor(Dt+(Nt-Ut)*Ie/Nt+lt));pt(Lt,vt,Dt,wt,Ot,St)}var Gt=vt[2*Dt+St],ir=xt,Xt=it;for($(Lt,vt,xt,Dt),vt[2*it+St]>Gt&&$(Lt,vt,xt,it);ir<Xt;){for($(Lt,vt,ir,Xt),ir++,Xt--;vt[2*ir+St]<Gt;)ir++;for(;vt[2*Xt+St]>Gt;)Xt--}vt[2*xt+St]===Gt?$(Lt,vt,xt,Xt):(Xt++,$(Lt,vt,Xt,it)),Xt<=Dt&&(xt=Xt+1),Dt<=Xt&&(it=Xt-1)}})(_e,Ce,Mt,Pe,Xe,ht%2),Y(_e,Ce,Le,Pe,Mt-1,ht+1),Y(_e,Ce,Le,Mt+1,Xe,ht+1)}}function $(_e,Ce,Le,Pe){z(_e,Le,Pe),z(Ce,2*Le,2*Pe),z(Ce,2*Le+1,2*Pe+1)}function z(_e,Ce,Le){var Pe=_e[Ce];_e[Ce]=_e[Le],_e[Le]=Pe}function j(_e,Ce,Le,Pe){var Xe=_e-Le,ht=Ce-Pe;return Xe*Xe+ht*ht}k.fromVectorTileJs=L,k.fromGeojsonVt=M,k.GeoJSONWrapper=P;var W=function(_e){return _e[0]},ee=function(_e){return _e[1]},J=function(_e,Ce,Le,Pe,Xe){Ce===void 0&&(Ce=W),Le===void 0&&(Le=ee),Pe===void 0&&(Pe=64),Xe===void 0&&(Xe=Float64Array),this.nodeSize=Pe,this.points=_e;for(var ht=_e.length<65536?Uint16Array:Uint32Array,Mt=this.ids=new ht(_e.length),pt=this.coords=new Xe(2*_e.length),Lt=0;Lt<_e.length;Lt++)Mt[Lt]=Lt,pt[2*Lt]=Ce(_e[Lt]),pt[2*Lt+1]=Le(_e[Lt]);Y(Mt,pt,Pe,0,Mt.length-1,0)};J.prototype.range=function(_e,Ce,Le,Pe){return function(Xe,ht,Mt,pt,Lt,vt,Dt){for(var xt,it,St=[0,Xe.length-1,0],Nt=[];St.length;){var Ut=St.pop(),Qt=St.pop(),Ie=St.pop();if(Qt-Ie<=Dt)for(var lt=Ie;lt<=Qt;lt++)xt=ht[2*lt],it=ht[2*lt+1],xt>=Mt&&xt<=Lt&&it>=pt&&it<=vt&&Nt.push(Xe[lt]);else{var wt=Math.floor((Ie+Qt)/2);xt=ht[2*wt],it=ht[2*wt+1],xt>=Mt&&xt<=Lt&&it>=pt&&it<=vt&&Nt.push(Xe[wt]);var Ot=(Ut+1)%2;(Ut===0?Mt<=xt:pt<=it)&&(St.push(Ie),St.push(wt-1),St.push(Ot)),(Ut===0?Lt>=xt:vt>=it)&&(St.push(wt+1),St.push(Qt),St.push(Ot))}}return Nt}(this.ids,this.coords,_e,Ce,Le,Pe,this.nodeSize)},J.prototype.within=function(_e,Ce,Le){return function(Pe,Xe,ht,Mt,pt,Lt){for(var vt=[0,Pe.length-1,0],Dt=[],xt=pt*pt;vt.length;){var it=vt.pop(),St=vt.pop(),Nt=vt.pop();if(St-Nt<=Lt)for(var Ut=Nt;Ut<=St;Ut++)j(Xe[2*Ut],Xe[2*Ut+1],ht,Mt)<=xt&&Dt.push(Pe[Ut]);else{var Qt=Math.floor((Nt+St)/2),Ie=Xe[2*Qt],lt=Xe[2*Qt+1];j(Ie,lt,ht,Mt)<=xt&&Dt.push(Pe[Qt]);var wt=(it+1)%2;(it===0?ht-pt<=Ie:Mt-pt<=lt)&&(vt.push(Nt),vt.push(Qt-1),vt.push(wt)),(it===0?ht+pt>=Ie:Mt+pt>=lt)&&(vt.push(Qt+1),vt.push(St),vt.push(wt))}}return Dt}(this.ids,this.coords,_e,Ce,Le,this.nodeSize)};var Q={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(_e){return _e}},te=function(_e){this.options=ve(Object.create(Q),_e),this.trees=new Array(this.options.maxZoom+1)};function ie(_e,Ce,Le,Pe,Xe){return{x:_e,y:Ce,zoom:1/0,id:Le,parentId:-1,numPoints:Pe,properties:Xe}}function ae(_e,Ce){var Le=_e.geometry.coordinates,Pe=Le[0],Xe=Le[1];return{x:de(Pe),y:ue(Xe),zoom:1/0,index:Ce,parentId:-1}}function he(_e){return{type:"Feature",id:_e.id,properties:se(_e),geometry:{type:"Point",coordinates:[(Pe=_e.x,360*(Pe-.5)),(Ce=_e.y,Le=(180-360*Ce)*Math.PI/180,360*Math.atan(Math.exp(Le))/Math.PI-90)]}};var Ce,Le,Pe}function se(_e){var Ce=_e.numPoints,Le=Ce>=1e4?Math.round(Ce/1e3)+"k":Ce>=1e3?Math.round(Ce/100)/10+"k":Ce;return ve(ve({},_e.properties),{cluster:!0,cluster_id:_e.id,point_count:Ce,point_count_abbreviated:Le})}function de(_e){return _e/360+.5}function ue(_e){var Ce=Math.sin(_e*Math.PI/180),Le=.5-.25*Math.log((1+Ce)/(1-Ce))/Math.PI;return Le<0?0:Le>1?1:Le}function ve(_e,Ce){for(var Le in Ce)_e[Le]=Ce[Le];return _e}function ke(_e){return _e.x}function Ee(_e){return _e.y}function be(_e,Ce,Le,Pe,Xe,ht){var Mt=Xe-Le,pt=ht-Pe;if(Mt!==0||pt!==0){var Lt=((_e-Le)*Mt+(Ce-Pe)*pt)/(Mt*Mt+pt*pt);Lt>1?(Le=Xe,Pe=ht):Lt>0&&(Le+=Mt*Lt,Pe+=pt*Lt)}return(Mt=_e-Le)*Mt+(pt=Ce-Pe)*pt}function xe(_e,Ce,Le,Pe){var Xe={id:_e===void 0?null:_e,type:Ce,geometry:Le,tags:Pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ht){var Mt=ht.geometry,pt=ht.type;if(pt==="Point"||pt==="MultiPoint"||pt==="LineString")ce(ht,Mt);else if(pt==="Polygon"||pt==="MultiLineString")for(var Lt=0;Lt<Mt.length;Lt++)ce(ht,Mt[Lt]);else if(pt==="MultiPolygon")for(Lt=0;Lt<Mt.length;Lt++)for(var vt=0;vt<Mt[Lt].length;vt++)ce(ht,Mt[Lt][vt])}(Xe),Xe}function ce(_e,Ce){for(var Le=0;Le<Ce.length;Le+=3)_e.minX=Math.min(_e.minX,Ce[Le]),_e.minY=Math.min(_e.minY,Ce[Le+1]),_e.maxX=Math.max(_e.maxX,Ce[Le]),_e.maxY=Math.max(_e.maxY,Ce[Le+1])}function ge(_e,Ce,Le,Pe){if(Ce.geometry){var Xe=Ce.geometry.coordinates,ht=Ce.geometry.type,Mt=Math.pow(Le.tolerance/((1<<Le.maxZoom)*Le.extent),2),pt=[],Lt=Ce.id;if(Le.promoteId?Lt=Ce.properties[Le.promoteId]:Le.generateId&&(Lt=Pe||0),ht==="Point")we(Xe,pt);else if(ht==="MultiPoint")for(var vt=0;vt<Xe.length;vt++)we(Xe[vt],pt);else if(ht==="LineString")Me(Xe,pt,Mt,!1);else if(ht==="MultiLineString"){if(Le.lineMetrics){for(vt=0;vt<Xe.length;vt++)pt=[],Me(Xe[vt],pt,Mt,!1),_e.push(xe(Lt,"LineString",pt,Ce.properties));return}Se(Xe,pt,Mt,!1)}else if(ht==="Polygon")Se(Xe,pt,Mt,!0);else{if(ht!=="MultiPolygon"){if(ht==="GeometryCollection"){for(vt=0;vt<Ce.geometry.geometries.length;vt++)ge(_e,{id:Lt,geometry:Ce.geometry.geometries[vt],properties:Ce.properties},Le,Pe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(vt=0;vt<Xe.length;vt++){var Dt=[];Se(Xe[vt],Dt,Mt,!0),pt.push(Dt)}}_e.push(xe(Lt,ht,pt,Ce.properties))}}function we(_e,Ce){Ce.push(ze(_e[0])),Ce.push(Fe(_e[1])),Ce.push(0)}function Me(_e,Ce,Le,Pe){for(var Xe,ht,Mt=0,pt=0;pt<_e.length;pt++){var Lt=ze(_e[pt][0]),vt=Fe(_e[pt][1]);Ce.push(Lt),Ce.push(vt),Ce.push(0),pt>0&&(Mt+=Pe?(Xe*vt-Lt*ht)/2:Math.sqrt(Math.pow(Lt-Xe,2)+Math.pow(vt-ht,2))),Xe=Lt,ht=vt}var Dt=Ce.length-3;Ce[2]=1,function xt(it,St,Nt,Ut){for(var Qt,Ie=Ut,lt=Nt-St>>1,wt=Nt-St,Ot=it[St],Gt=it[St+1],ir=it[Nt],Xt=it[Nt+1],Kt=St+3;Kt<Nt;Kt+=3){var or=be(it[Kt],it[Kt+1],Ot,Gt,ir,Xt);if(or>Ie)Qt=Kt,Ie=or;else if(or===Ie){var dr=Math.abs(Kt-lt);dr<wt&&(Qt=Kt,wt=dr)}}Ie>Ut&&(Qt-St>3&&xt(it,St,Qt,Ut),it[Qt+2]=Ie,Nt-Qt>3&&xt(it,Qt,Nt,Ut))}(Ce,0,Dt,Le),Ce[Dt+2]=1,Ce.size=Math.abs(Mt),Ce.start=0,Ce.end=Ce.size}function Se(_e,Ce,Le,Pe){for(var Xe=0;Xe<_e.length;Xe++){var ht=[];Me(_e[Xe],ht,Le,Pe),Ce.push(ht)}}function ze(_e){return _e/360+.5}function Fe(_e){var Ce=Math.sin(_e*Math.PI/180),Le=.5-.25*Math.log((1+Ce)/(1-Ce))/Math.PI;return Le<0?0:Le>1?1:Le}function Ye(_e,Ce,Le,Pe,Xe,ht,Mt,pt){if(Pe/=Ce,ht>=(Le/=Ce)&&Mt<Pe)return _e;if(Mt<Le||ht>=Pe)return null;for(var Lt=[],vt=0;vt<_e.length;vt++){var Dt=_e[vt],xt=Dt.geometry,it=Dt.type,St=Xe===0?Dt.minX:Dt.minY,Nt=Xe===0?Dt.maxX:Dt.maxY;if(St>=Le&&Nt<Pe)Lt.push(Dt);else if(!(Nt<Le||St>=Pe)){var Ut=[];if(it==="Point"||it==="MultiPoint")rt(xt,Ut,Le,Pe,Xe);else if(it==="LineString")Oe(xt,Ut,Le,Pe,Xe,!1,pt.lineMetrics);else if(it==="MultiLineString")We(xt,Ut,Le,Pe,Xe,!1);else if(it==="Polygon")We(xt,Ut,Le,Pe,Xe,!0);else if(it==="MultiPolygon")for(var Qt=0;Qt<xt.length;Qt++){var Ie=[];We(xt[Qt],Ie,Le,Pe,Xe,!0),Ie.length&&Ut.push(Ie)}if(Ut.length){if(pt.lineMetrics&&it==="LineString"){for(Qt=0;Qt<Ut.length;Qt++)Lt.push(xe(Dt.id,it,Ut[Qt],Dt.tags));continue}it!=="LineString"&&it!=="MultiLineString"||(Ut.length===1?(it="LineString",Ut=Ut[0]):it="MultiLineString"),it!=="Point"&&it!=="MultiPoint"||(it=Ut.length===3?"Point":"MultiPoint"),Lt.push(xe(Dt.id,it,Ut,Dt.tags))}}}return Lt.length?Lt:null}function rt(_e,Ce,Le,Pe,Xe){for(var ht=0;ht<_e.length;ht+=3){var Mt=_e[ht+Xe];Mt>=Le&&Mt<=Pe&&(Ce.push(_e[ht]),Ce.push(_e[ht+1]),Ce.push(_e[ht+2]))}}function Oe(_e,Ce,Le,Pe,Xe,ht,Mt){for(var pt,Lt,vt=je(_e),Dt=Xe===0?Qe:st,xt=_e.start,it=0;it<_e.length-3;it+=3){var St=_e[it],Nt=_e[it+1],Ut=_e[it+2],Qt=_e[it+3],Ie=_e[it+4],lt=Xe===0?St:Nt,wt=Xe===0?Qt:Ie,Ot=!1;Mt&&(pt=Math.sqrt(Math.pow(St-Qt,2)+Math.pow(Nt-Ie,2))),lt<Le?wt>Le&&(Lt=Dt(vt,St,Nt,Qt,Ie,Le),Mt&&(vt.start=xt+pt*Lt)):lt>Pe?wt<Pe&&(Lt=Dt(vt,St,Nt,Qt,Ie,Pe),Mt&&(vt.start=xt+pt*Lt)):qe(vt,St,Nt,Ut),wt<Le&&lt>=Le&&(Lt=Dt(vt,St,Nt,Qt,Ie,Le),Ot=!0),wt>Pe&&lt<=Pe&&(Lt=Dt(vt,St,Nt,Qt,Ie,Pe),Ot=!0),!ht&&Ot&&(Mt&&(vt.end=xt+pt*Lt),Ce.push(vt),vt=je(_e)),Mt&&(xt+=pt)}var Gt=_e.length-3;St=_e[Gt],Nt=_e[Gt+1],Ut=_e[Gt+2],(lt=Xe===0?St:Nt)>=Le&&lt<=Pe&&qe(vt,St,Nt,Ut),Gt=vt.length-3,ht&&Gt>=3&&(vt[Gt]!==vt[0]||vt[Gt+1]!==vt[1])&&qe(vt,vt[0],vt[1],vt[2]),vt.length&&Ce.push(vt)}function je(_e){var Ce=[];return Ce.size=_e.size,Ce.start=_e.start,Ce.end=_e.end,Ce}function We(_e,Ce,Le,Pe,Xe,ht){for(var Mt=0;Mt<_e.length;Mt++)Oe(_e[Mt],Ce,Le,Pe,Xe,ht,!1)}function qe(_e,Ce,Le,Pe){_e.push(Ce),_e.push(Le),_e.push(Pe)}function Qe(_e,Ce,Le,Pe,Xe,ht){var Mt=(ht-Ce)/(Pe-Ce);return _e.push(ht),_e.push(Le+(Xe-Le)*Mt),_e.push(1),Mt}function st(_e,Ce,Le,Pe,Xe,ht){var Mt=(ht-Le)/(Xe-Le);return _e.push(Ce+(Pe-Ce)*Mt),_e.push(ht),_e.push(1),Mt}function ct(_e,Ce){for(var Le=[],Pe=0;Pe<_e.length;Pe++){var Xe,ht=_e[Pe],Mt=ht.type;if(Mt==="Point"||Mt==="MultiPoint"||Mt==="LineString")Xe=Pt(ht.geometry,Ce);else if(Mt==="MultiLineString"||Mt==="Polygon"){Xe=[];for(var pt=0;pt<ht.geometry.length;pt++)Xe.push(Pt(ht.geometry[pt],Ce))}else if(Mt==="MultiPolygon")for(Xe=[],pt=0;pt<ht.geometry.length;pt++){for(var Lt=[],vt=0;vt<ht.geometry[pt].length;vt++)Lt.push(Pt(ht.geometry[pt][vt],Ce));Xe.push(Lt)}Le.push(xe(ht.id,Mt,Xe,ht.tags))}return Le}function Pt(_e,Ce){var Le=[];Le.size=_e.size,_e.start!==void 0&&(Le.start=_e.start,Le.end=_e.end);for(var Pe=0;Pe<_e.length;Pe+=3)Le.push(_e[Pe]+Ce,_e[Pe+1],_e[Pe+2]);return Le}function kt(_e,Ce){if(_e.transformed)return _e;var Le,Pe,Xe,ht=1<<_e.z,Mt=_e.x,pt=_e.y;for(Le=0;Le<_e.features.length;Le++){var Lt=_e.features[Le],vt=Lt.geometry,Dt=Lt.type;if(Lt.geometry=[],Dt===1)for(Pe=0;Pe<vt.length;Pe+=2)Lt.geometry.push(at(vt[Pe],vt[Pe+1],Ce,ht,Mt,pt));else for(Pe=0;Pe<vt.length;Pe++){var xt=[];for(Xe=0;Xe<vt[Pe].length;Xe+=2)xt.push(at(vt[Pe][Xe],vt[Pe][Xe+1],Ce,ht,Mt,pt));Lt.geometry.push(xt)}}return _e.transformed=!0,_e}function at(_e,Ce,Le,Pe,Xe,ht){return[Math.round(Le*(_e*Pe-Xe)),Math.round(Le*(Ce*Pe-ht))]}function tt(_e,Ce,Le,Pe,Xe){for(var ht=Ce===Xe.maxZoom?0:Xe.tolerance/((1<<Ce)*Xe.extent),Mt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Le,y:Pe,z:Ce,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},pt=0;pt<_e.length;pt++){Mt.numFeatures++,_t(Mt,_e[pt],ht,Xe);var Lt=_e[pt].minX,vt=_e[pt].minY,Dt=_e[pt].maxX,xt=_e[pt].maxY;Lt<Mt.minX&&(Mt.minX=Lt),vt<Mt.minY&&(Mt.minY=vt),Dt>Mt.maxX&&(Mt.maxX=Dt),xt>Mt.maxY&&(Mt.maxY=xt)}return Mt}function _t(_e,Ce,Le,Pe){var Xe=Ce.geometry,ht=Ce.type,Mt=[];if(ht==="Point"||ht==="MultiPoint")for(var pt=0;pt<Xe.length;pt+=3)Mt.push(Xe[pt]),Mt.push(Xe[pt+1]),_e.numPoints++,_e.numSimplified++;else if(ht==="LineString")er(Mt,Xe,_e,Le,!1,!1);else if(ht==="MultiLineString"||ht==="Polygon")for(pt=0;pt<Xe.length;pt++)er(Mt,Xe[pt],_e,Le,ht==="Polygon",pt===0);else if(ht==="MultiPolygon")for(var Lt=0;Lt<Xe.length;Lt++){var vt=Xe[Lt];for(pt=0;pt<vt.length;pt++)er(Mt,vt[pt],_e,Le,!0,pt===0)}if(Mt.length){var Dt=Ce.tags||null;if(ht==="LineString"&&Pe.lineMetrics){for(var xt in Dt={},Ce.tags)Dt[xt]=Ce.tags[xt];Dt.mapbox_clip_start=Xe.start/Xe.size,Dt.mapbox_clip_end=Xe.end/Xe.size}var it={geometry:Mt,type:ht==="Polygon"||ht==="MultiPolygon"?3:ht==="LineString"||ht==="MultiLineString"?2:1,tags:Dt};Ce.id!==null&&(it.id=Ce.id),_e.features.push(it)}}function er(_e,Ce,Le,Pe,Xe,ht){var Mt=Pe*Pe;if(Pe>0&&Ce.size<(Xe?Mt:Pe))Le.numPoints+=Ce.length/3;else{for(var pt=[],Lt=0;Lt<Ce.length;Lt+=3)(Pe===0||Ce[Lt+2]>Mt)&&(Le.numSimplified++,pt.push(Ce[Lt]),pt.push(Ce[Lt+1])),Le.numPoints++;Xe&&function(vt,Dt){for(var xt=0,it=0,St=vt.length,Nt=St-2;it<St;Nt=it,it+=2)xt+=(vt[it]-vt[Nt])*(vt[it+1]+vt[Nt+1]);if(xt>0===Dt)for(it=0,St=vt.length;it<St/2;it+=2){var Ut=vt[it],Qt=vt[it+1];vt[it]=vt[St-2-it],vt[it+1]=vt[St-1-it],vt[St-2-it]=Ut,vt[St-1-it]=Qt}}(pt,ht),_e.push(pt)}}function tr(_e,Ce){var Le=(Ce=this.options=function(Xe,ht){for(var Mt in ht)Xe[Mt]=ht[Mt];return Xe}(Object.create(this.options),Ce)).debug;if(Le&&console.time("preprocess data"),Ce.maxZoom<0||Ce.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ce.promoteId&&Ce.generateId)throw new Error("promoteId and generateId cannot be used together.");var Pe=function(Xe,ht){var Mt=[];if(Xe.type==="FeatureCollection")for(var pt=0;pt<Xe.features.length;pt++)ge(Mt,Xe.features[pt],ht,pt);else Xe.type==="Feature"?ge(Mt,Xe,ht):ge(Mt,{geometry:Xe},ht);return Mt}(_e,Ce);this.tiles={},this.tileCoords=[],Le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ce.indexMaxZoom,Ce.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Pe=function(Xe,ht){var Mt=ht.buffer/ht.extent,pt=Xe,Lt=Ye(Xe,1,-1-Mt,Mt,0,-1,2,ht),vt=Ye(Xe,1,1-Mt,2+Mt,0,-1,2,ht);return(Lt||vt)&&(pt=Ye(Xe,1,-Mt,1+Mt,0,-1,2,ht)||[],Lt&&(pt=ct(Lt,1).concat(pt)),vt&&(pt=pt.concat(ct(vt,-1)))),pt}(Pe,Ce)).length&&this.splitTile(Pe,0,0,0),Le&&(Pe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ue(_e,Ce,Le){return 32*((1<<_e)*Le+Ce)+_e}function He(_e,Ce){var Le=_e.tileID.canonical;if(!this._geoJSONIndex)return Ce(null,null);var Pe=this._geoJSONIndex.getTile(Le.z,Le.x,Le.y);if(!Pe)return Ce(null,null);var Xe=new T(Pe.features),ht=k(Xe);ht.byteOffset===0&&ht.byteLength===ht.buffer.byteLength||(ht=new Uint8Array(ht)),Ce(null,{vectorTile:Xe,rawData:ht.buffer})}te.prototype.load=function(_e){var Ce=this.options,Le=Ce.log,Pe=Ce.minZoom,Xe=Ce.maxZoom,ht=Ce.nodeSize;Le&&console.time("total time");var Mt="prepare "+_e.length+" points";Le&&console.time(Mt),this.points=_e;for(var pt=[],Lt=0;Lt<_e.length;Lt++)_e[Lt].geometry&&pt.push(ae(_e[Lt],Lt));this.trees[Xe+1]=new J(pt,ke,Ee,ht,Float32Array),Le&&console.timeEnd(Mt);for(var vt=Xe;vt>=Pe;vt--){var Dt=+Date.now();pt=this._cluster(pt,vt),this.trees[vt]=new J(pt,ke,Ee,ht,Float32Array),Le&&console.log("z%d: %d clusters in %dms",vt,pt.length,+Date.now()-Dt)}return Le&&console.timeEnd("total time"),this},te.prototype.getClusters=function(_e,Ce){var Le=((_e[0]+180)%360+360)%360-180,Pe=Math.max(-90,Math.min(90,_e[1])),Xe=_e[2]===180?180:((_e[2]+180)%360+360)%360-180,ht=Math.max(-90,Math.min(90,_e[3]));if(_e[2]-_e[0]>=360)Le=-180,Xe=180;else if(Le>Xe){var Mt=this.getClusters([Le,Pe,180,ht],Ce),pt=this.getClusters([-180,Pe,Xe,ht],Ce);return Mt.concat(pt)}for(var Lt=this.trees[this._limitZoom(Ce)],vt=[],Dt=0,xt=Lt.range(de(Le),ue(ht),de(Xe),ue(Pe));Dt<xt.length;Dt+=1){var it=xt[Dt],St=Lt.points[it];vt.push(St.numPoints?he(St):this.points[St.index])}return vt},te.prototype.getChildren=function(_e){var Ce=this._getOriginId(_e),Le=this._getOriginZoom(_e),Pe="No cluster with the specified id.",Xe=this.trees[Le];if(!Xe)throw new Error(Pe);var ht=Xe.points[Ce];if(!ht)throw new Error(Pe);for(var Mt=this.options.radius/(this.options.extent*Math.pow(2,Le-1)),pt=[],Lt=0,vt=Xe.within(ht.x,ht.y,Mt);Lt<vt.length;Lt+=1){var Dt=vt[Lt],xt=Xe.points[Dt];xt.parentId===_e&&pt.push(xt.numPoints?he(xt):this.points[xt.index])}if(pt.length===0)throw new Error(Pe);return pt},te.prototype.getLeaves=function(_e,Ce,Le){Ce=Ce||10,Le=Le||0;var Pe=[];return this._appendLeaves(Pe,_e,Ce,Le,0),Pe},te.prototype.getTile=function(_e,Ce,Le){var Pe=this.trees[this._limitZoom(_e)],Xe=Math.pow(2,_e),ht=this.options,Mt=ht.extent,pt=ht.radius/Mt,Lt=(Le-pt)/Xe,vt=(Le+1+pt)/Xe,Dt={features:[]};return this._addTileFeatures(Pe.range((Ce-pt)/Xe,Lt,(Ce+1+pt)/Xe,vt),Pe.points,Ce,Le,Xe,Dt),Ce===0&&this._addTileFeatures(Pe.range(1-pt/Xe,Lt,1,vt),Pe.points,Xe,Le,Xe,Dt),Ce===Xe-1&&this._addTileFeatures(Pe.range(0,Lt,pt/Xe,vt),Pe.points,-1,Le,Xe,Dt),Dt.features.length?Dt:null},te.prototype.getClusterExpansionZoom=function(_e){for(var Ce=this._getOriginZoom(_e)-1;Ce<=this.options.maxZoom;){var Le=this.getChildren(_e);if(Ce++,Le.length!==1)break;_e=Le[0].properties.cluster_id}return Ce},te.prototype._appendLeaves=function(_e,Ce,Le,Pe,Xe){for(var ht=0,Mt=this.getChildren(Ce);ht<Mt.length;ht+=1){var pt=Mt[ht],Lt=pt.properties;if(Lt&&Lt.cluster?Xe+Lt.point_count<=Pe?Xe+=Lt.point_count:Xe=this._appendLeaves(_e,Lt.cluster_id,Le,Pe,Xe):Xe<Pe?Xe++:_e.push(pt),_e.length===Le)break}return Xe},te.prototype._addTileFeatures=function(_e,Ce,Le,Pe,Xe,ht){for(var Mt=0,pt=_e;Mt<pt.length;Mt+=1){var Lt=Ce[pt[Mt]],vt=Lt.numPoints,Dt={type:1,geometry:[[Math.round(this.options.extent*(Lt.x*Xe-Le)),Math.round(this.options.extent*(Lt.y*Xe-Pe))]],tags:vt?se(Lt):this.points[Lt.index].properties},xt=void 0;vt?xt=Lt.id:this.options.generateId?xt=Lt.index:this.points[Lt.index].id&&(xt=this.points[Lt.index].id),xt!==void 0&&(Dt.id=xt),ht.features.push(Dt)}},te.prototype._limitZoom=function(_e){return Math.max(this.options.minZoom,Math.min(_e,this.options.maxZoom+1))},te.prototype._cluster=function(_e,Ce){for(var Le=[],Pe=this.options,Xe=Pe.radius,ht=Pe.extent,Mt=Pe.reduce,pt=Xe/(ht*Math.pow(2,Ce)),Lt=0;Lt<_e.length;Lt++){var vt=_e[Lt];if(!(vt.zoom<=Ce)){vt.zoom=Ce;for(var Dt=this.trees[Ce+1],xt=Dt.within(vt.x,vt.y,pt),it=vt.numPoints||1,St=vt.x*it,Nt=vt.y*it,Ut=Mt&&it>1?this._map(vt,!0):null,Qt=(Lt<<5)+(Ce+1)+this.points.length,Ie=0,lt=xt;Ie<lt.length;Ie+=1){var wt=lt[Ie],Ot=Dt.points[wt];if(!(Ot.zoom<=Ce)){Ot.zoom=Ce;var Gt=Ot.numPoints||1;St+=Ot.x*Gt,Nt+=Ot.y*Gt,it+=Gt,Ot.parentId=Qt,Mt&&(Ut||(Ut=this._map(vt,!0)),Mt(Ut,this._map(Ot)))}}it===1?Le.push(vt):(vt.parentId=Qt,Le.push(ie(St/it,Nt/it,Qt,it,Ut)))}}return Le},te.prototype._getOriginId=function(_e){return _e-this.points.length>>5},te.prototype._getOriginZoom=function(_e){return(_e-this.points.length)%32},te.prototype._map=function(_e,Ce){if(_e.numPoints)return Ce?ve({},_e.properties):_e.properties;var Le=this.points[_e.index].properties,Pe=this.options.map(Le);return Ce&&Pe===Le?ve({},Pe):Pe},tr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},tr.prototype.splitTile=function(_e,Ce,Le,Pe,Xe,ht,Mt){for(var pt=[_e,Ce,Le,Pe],Lt=this.options,vt=Lt.debug;pt.length;){Pe=pt.pop(),Le=pt.pop(),Ce=pt.pop(),_e=pt.pop();var Dt=1<<Ce,xt=Ue(Ce,Le,Pe),it=this.tiles[xt];if(!it&&(vt>1&&console.time("creation"),it=this.tiles[xt]=tt(_e,Ce,Le,Pe,Lt),this.tileCoords.push({z:Ce,x:Le,y:Pe}),vt)){vt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ce,Le,Pe,it.numFeatures,it.numPoints,it.numSimplified),console.timeEnd("creation"));var St="z"+Ce;this.stats[St]=(this.stats[St]||0)+1,this.total++}if(it.source=_e,Xe){if(Ce===Lt.maxZoom||Ce===Xe)continue;var Nt=1<<Xe-Ce;if(Le!==Math.floor(ht/Nt)||Pe!==Math.floor(Mt/Nt))continue}else if(Ce===Lt.indexMaxZoom||it.numPoints<=Lt.indexMaxPoints)continue;if(it.source=null,_e.length!==0){vt>1&&console.time("clipping");var Ut,Qt,Ie,lt,wt,Ot,Gt=.5*Lt.buffer/Lt.extent,ir=.5-Gt,Xt=.5+Gt,Kt=1+Gt;Ut=Qt=Ie=lt=null,wt=Ye(_e,Dt,Le-Gt,Le+Xt,0,it.minX,it.maxX,Lt),Ot=Ye(_e,Dt,Le+ir,Le+Kt,0,it.minX,it.maxX,Lt),_e=null,wt&&(Ut=Ye(wt,Dt,Pe-Gt,Pe+Xt,1,it.minY,it.maxY,Lt),Qt=Ye(wt,Dt,Pe+ir,Pe+Kt,1,it.minY,it.maxY,Lt),wt=null),Ot&&(Ie=Ye(Ot,Dt,Pe-Gt,Pe+Xt,1,it.minY,it.maxY,Lt),lt=Ye(Ot,Dt,Pe+ir,Pe+Kt,1,it.minY,it.maxY,Lt),Ot=null),vt>1&&console.timeEnd("clipping"),pt.push(Ut||[],Ce+1,2*Le,2*Pe),pt.push(Qt||[],Ce+1,2*Le,2*Pe+1),pt.push(Ie||[],Ce+1,2*Le+1,2*Pe),pt.push(lt||[],Ce+1,2*Le+1,2*Pe+1)}}},tr.prototype.getTile=function(_e,Ce,Le){var Pe=this.options,Xe=Pe.extent,ht=Pe.debug;if(_e<0||_e>24)return null;var Mt=1<<_e,pt=Ue(_e,Ce=(Ce%Mt+Mt)%Mt,Le);if(this.tiles[pt])return kt(this.tiles[pt],Xe);ht>1&&console.log("drilling down to z%d-%d-%d",_e,Ce,Le);for(var Lt,vt=_e,Dt=Ce,xt=Le;!Lt&&vt>0;)vt--,Dt=Math.floor(Dt/2),xt=Math.floor(xt/2),Lt=this.tiles[Ue(vt,Dt,xt)];return Lt&&Lt.source?(ht>1&&console.log("found parent tile z%d-%d-%d",vt,Dt,xt),ht>1&&console.time("drilling down"),this.splitTile(Lt.source,vt,Dt,xt,_e,Ce,Le),ht>1&&console.timeEnd("drilling down"),this.tiles[pt]?kt(this.tiles[pt],Xe):null):null};var Be=function(_e){function Ce(Le,Pe,Xe,ht){_e.call(this,Le,Pe,Xe,He),ht&&(this.loadGeoJSON=ht)}return _e&&(Ce.__proto__=_e),Ce.prototype=Object.create(_e&&_e.prototype),Ce.prototype.constructor=Ce,Ce.prototype.loadData=function(Le,Pe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Pe,this._pendingLoadDataParams=Le,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Ce.prototype._loadData=function(){var Le=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Pe=this._pendingCallback,Xe=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ht=!!(Xe&&Xe.request&&Xe.request.collectResourceTiming)&&new e.RequestPerformance(Xe.request);this.loadGeoJSON(Xe,function(Mt,pt){if(Mt||!pt)return Pe(Mt);if(typeof pt!="object")return Pe(new Error("Input data given to '"+Xe.source+"' is not a valid GeoJSON object."));h(pt,!0);try{Le._geoJSONIndex=Xe.cluster?new te(function(Dt){var xt=Dt.superclusterOptions,it=Dt.clusterProperties;if(!it||!xt)return xt;for(var St={},Nt={},Ut={accumulated:null,zoom:0},Qt={properties:null},Ie=Object.keys(it),lt=0,wt=Ie;lt<wt.length;lt+=1){var Ot=wt[lt],Gt=it[Ot],ir=Gt[0],Xt=Gt[1],Kt=e.createExpression(Xt),or=e.createExpression(typeof ir=="string"?[ir,["accumulated"],["get",Ot]]:ir);St[Ot]=Kt.value,Nt[Ot]=or.value}return xt.map=function(dr){Qt.properties=dr;for(var vr={},ur=0,pr=Ie;ur<pr.length;ur+=1){var br=pr[ur];vr[br]=St[br].evaluate(Ut,Qt)}return vr},xt.reduce=function(dr,vr){Qt.properties=vr;for(var ur=0,pr=Ie;ur<pr.length;ur+=1){var br=pr[ur];Ut.accumulated=dr[br],dr[br]=Nt[br].evaluate(Ut,Qt)}},xt}(Xe)).load(pt.features):function(Dt,xt){return new tr(Dt,xt)}(pt,Xe.geojsonVtOptions)}catch(Dt){return Pe(Dt)}Le.loaded={};var Lt={};if(ht){var vt=ht.finish();vt&&(Lt.resourceTiming={},Lt.resourceTiming[Xe.source]=JSON.parse(JSON.stringify(vt)))}Pe(null,Lt)})}},Ce.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},Ce.prototype.reloadTile=function(Le,Pe){var Xe=this.loaded,ht=Le.uid;return Xe&&Xe[ht]?_e.prototype.reloadTile.call(this,Le,Pe):this.loadTile(Le,Pe)},Ce.prototype.loadGeoJSON=function(Le,Pe){if(Le.request)e.getJSON(Le.request,Pe);else{if(typeof Le.data!="string")return Pe(new Error("Input data given to '"+Le.source+"' is not a valid GeoJSON object."));try{return Pe(null,JSON.parse(Le.data))}catch(Xe){return Pe(new Error("Input data given to '"+Le.source+"' is not a valid GeoJSON object."))}}},Ce.prototype.removeSource=function(Le,Pe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Pe()},Ce.prototype.getClusterExpansionZoom=function(Le,Pe){try{Pe(null,this._geoJSONIndex.getClusterExpansionZoom(Le.clusterId))}catch(Xe){Pe(Xe)}},Ce.prototype.getClusterChildren=function(Le,Pe){try{Pe(null,this._geoJSONIndex.getChildren(Le.clusterId))}catch(Xe){Pe(Xe)}},Ce.prototype.getClusterLeaves=function(Le,Pe){try{Pe(null,this._geoJSONIndex.getLeaves(Le.clusterId,Le.limit,Le.offset))}catch(Xe){Pe(Xe)}},Ce}(n),Ke=function(_e){var Ce=this;this.self=_e,this.actor=new e.Actor(_e,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:n,geojson:Be},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(Le,Pe){if(Ce.workerSourceTypes[Le])throw new Error('Worker source with name "'+Le+'" already registered.');Ce.workerSourceTypes[Le]=Pe},this.self.registerRTLTextPlugin=function(Le){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=Le.applyArabicShaping,e.plugin.processBidirectionalText=Le.processBidirectionalText,e.plugin.processStyledBidirectionalText=Le.processStyledBidirectionalText}};return Ke.prototype.setReferrer=function(_e,Ce){this.referrer=Ce},Ke.prototype.setImages=function(_e,Ce,Le){for(var Pe in this.availableImages[_e]=Ce,this.workerSources[_e]){var Xe=this.workerSources[_e][Pe];for(var ht in Xe)Xe[ht].availableImages=Ce}Le()},Ke.prototype.setLayers=function(_e,Ce,Le){this.getLayerIndex(_e).replace(Ce),Le()},Ke.prototype.updateLayers=function(_e,Ce,Le){this.getLayerIndex(_e).update(Ce.layers,Ce.removedIds),Le()},Ke.prototype.loadTile=function(_e,Ce,Le){this.getWorkerSource(_e,Ce.type,Ce.source).loadTile(Ce,Le)},Ke.prototype.loadDEMTile=function(_e,Ce,Le){this.getDEMWorkerSource(_e,Ce.source).loadTile(Ce,Le)},Ke.prototype.reloadTile=function(_e,Ce,Le){this.getWorkerSource(_e,Ce.type,Ce.source).reloadTile(Ce,Le)},Ke.prototype.abortTile=function(_e,Ce,Le){this.getWorkerSource(_e,Ce.type,Ce.source).abortTile(Ce,Le)},Ke.prototype.removeTile=function(_e,Ce,Le){this.getWorkerSource(_e,Ce.type,Ce.source).removeTile(Ce,Le)},Ke.prototype.removeDEMTile=function(_e,Ce){this.getDEMWorkerSource(_e,Ce.source).removeTile(Ce)},Ke.prototype.removeSource=function(_e,Ce,Le){if(this.workerSources[_e]&&this.workerSources[_e][Ce.type]&&this.workerSources[_e][Ce.type][Ce.source]){var Pe=this.workerSources[_e][Ce.type][Ce.source];delete this.workerSources[_e][Ce.type][Ce.source],Pe.removeSource!==void 0?Pe.removeSource(Ce,Le):Le()}},Ke.prototype.loadWorkerSource=function(_e,Ce,Le){try{this.self.importScripts(Ce.url),Le()}catch(Pe){Le(Pe.toString())}},Ke.prototype.syncRTLPluginState=function(_e,Ce,Le){try{e.plugin.setState(Ce);var Pe=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&Pe!=null){this.self.importScripts(Pe);var Xe=e.plugin.isParsed();Le(Xe?void 0:new Error("RTL Text Plugin failed to import scripts from "+Pe),Xe)}}catch(ht){Le(ht.toString())}},Ke.prototype.getAvailableImages=function(_e){var Ce=this.availableImages[_e];return Ce||(Ce=[]),Ce},Ke.prototype.getLayerIndex=function(_e){var Ce=this.layerIndexes[_e];return Ce||(Ce=this.layerIndexes[_e]=new s),Ce},Ke.prototype.getWorkerSource=function(_e,Ce,Le){var Pe=this;if(this.workerSources[_e]||(this.workerSources[_e]={}),this.workerSources[_e][Ce]||(this.workerSources[_e][Ce]={}),!this.workerSources[_e][Ce][Le]){var Xe={send:function(ht,Mt,pt){Pe.actor.send(ht,Mt,pt,_e)}};this.workerSources[_e][Ce][Le]=new this.workerSourceTypes[Ce](Xe,this.getLayerIndex(_e),this.getAvailableImages(_e))}return this.workerSources[_e][Ce][Le]},Ke.prototype.getDEMWorkerSource=function(_e,Ce){return this.demWorkerSources[_e]||(this.demWorkerSources[_e]={}),this.demWorkerSources[_e][Ce]||(this.demWorkerSources[_e][Ce]=new g),this.demWorkerSources[_e][Ce]},Ke.prototype.enforceCacheSizeLimit=function(_e,Ce){e.enforceCacheSizeLimit(Ce)},typeof WorkerGlobalScope!="undefined"&&e.window!==void 0&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new Ke(e.window)),Ke}),p(0,function(e){var f=e.createCommonjsModule(function(E){function R(ne){return!F(ne)}function F(ne){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var le,pe,ye=new Blob([""],{type:"text/javascript"}),Te=URL.createObjectURL(ye);try{pe=new Worker(Te),le=!0}catch(Ne){le=!1}return pe&&pe.terminate(),URL.revokeObjectURL(Te),le}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var le=document.createElement("canvas");le.width=le.height=1;var pe=le.getContext("2d");if(!pe)return!1;var ye=pe.getImageData(0,0,1,1);return ye&&ye.width===le.width}()?function(le){return V[le]===void 0&&(V[le]=function(pe){var ye=function(Ne){var Ge=document.createElement("canvas"),nt=Object.create(R.webGLContextAttributes);return nt.failIfMajorPerformanceCaveat=Ne,Ge.probablySupportsContext?Ge.probablySupportsContext("webgl",nt)||Ge.probablySupportsContext("experimental-webgl",nt):Ge.supportsContext?Ge.supportsContext("webgl",nt)||Ge.supportsContext("experimental-webgl",nt):Ge.getContext("webgl",nt)||Ge.getContext("experimental-webgl",nt)}(pe);if(!ye)return!1;var Te=ye.createShader(ye.VERTEX_SHADER);return!Te||ye.isContextLost()?!1:(ye.shaderSource(Te,"void main() {}"),ye.compileShader(Te),ye.getShaderParameter(Te,ye.COMPILE_STATUS)===!0)}(le)),V[le]}(ne&&ne.failIfMajorPerformanceCaveat)?void 0:"insufficient WebGL support":"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support"}E.exports?E.exports=R:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=R,window.mapboxgl.notSupportedReason=F);var V={};R.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),u={create:function(E,R,F){var V=e.window.document.createElement(E);return R!==void 0&&(V.className=R),F&&F.appendChild(V),V},createNS:function(E,R){return e.window.document.createElementNS(E,R)}},s=e.window.document.documentElement.style;function l(E){if(!s)return E[0];for(var R=0;R<E.length;R++)if(E[R]in s)return E[R];return E[0]}var o,i=l(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);u.disableDrag=function(){s&&i&&(o=s[i],s[i]="none")},u.enableDrag=function(){s&&i&&(s[i]=o)};var c=l(["transform","WebkitTransform"]);u.setTransform=function(E,R){E.style[c]=R};var n=!1;try{var a=Object.defineProperty({},"passive",{get:function(){n=!0}});e.window.addEventListener("test",a,a),e.window.removeEventListener("test",a,a)}catch(E){n=!1}u.addEventListener=function(E,R,F,V){V===void 0&&(V={}),"passive"in V&&n?E.addEventListener(R,F,V):E.addEventListener(R,F,V.capture)},u.removeEventListener=function(E,R,F,V){V===void 0&&(V={}),"passive"in V&&n?E.removeEventListener(R,F,V):E.removeEventListener(R,F,V.capture)};var g=function(E){E.preventDefault(),E.stopPropagation(),e.window.removeEventListener("click",g,!0)};function h(E){var R=E.userImage;return R&&R.render&&R.render()?(E.data.replace(new Uint8Array(R.data.buffer)),!0):!1}u.suppressClick=function(){e.window.addEventListener("click",g,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",g,!0)},0)},u.mousePos=function(E,R){var F=E.getBoundingClientRect();return new e.Point(R.clientX-F.left-E.clientLeft,R.clientY-F.top-E.clientTop)},u.touchPos=function(E,R){for(var F=E.getBoundingClientRect(),V=[],ne=0;ne<R.length;ne++)V.push(new e.Point(R[ne].clientX-F.left-E.clientLeft,R[ne].clientY-F.top-E.clientTop));return V},u.mouseButton=function(E){return e.window.InstallTrigger!==void 0&&E.button===2&&E.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:E.button},u.remove=function(E){E.parentNode&&E.parentNode.removeChild(E)};var y=function(E){function R(){E.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.isLoaded=function(){return this.loaded},R.prototype.setLoaded=function(F){if(this.loaded!==F&&(this.loaded=F,F)){for(var V=0,ne=this.requestors;V<ne.length;V+=1){var le=ne[V],pe=le.ids,ye=le.callback;this._notify(pe,ye)}this.requestors=[]}},R.prototype.getImage=function(F){return this.images[F]},R.prototype.addImage=function(F,V){this._validate(F,V)&&(this.images[F]=V)},R.prototype._validate=function(F,V){var ne=!0;return this._validateStretch(V.stretchX,V.data&&V.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "stretchX" value'))),ne=!1),this._validateStretch(V.stretchY,V.data&&V.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "stretchY" value'))),ne=!1),this._validateContent(V.content,V)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "content" value'))),ne=!1),ne},R.prototype._validateStretch=function(F,V){if(!F)return!0;for(var ne=0,le=0,pe=F;le<pe.length;le+=1){var ye=pe[le];if(ye[0]<ne||ye[1]<ye[0]||V<ye[1])return!1;ne=ye[1]}return!0},R.prototype._validateContent=function(F,V){return!F||F.length===4&&!(F[0]<0||V.data.width<F[0])&&!(F[1]<0||V.data.height<F[1])&&!(F[2]<0||V.data.width<F[2])&&!(F[3]<0||V.data.height<F[3])&&!(F[2]<F[0])&&!(F[3]<F[1])},R.prototype.updateImage=function(F,V){var ne=this.images[F];V.version=ne.version+1,this.images[F]=V,this.updatedImages[F]=!0},R.prototype.removeImage=function(F){var V=this.images[F];delete this.images[F],delete this.patterns[F],V.userImage&&V.userImage.onRemove&&V.userImage.onRemove()},R.prototype.listImages=function(){return Object.keys(this.images)},R.prototype.getImages=function(F,V){var ne=!0;if(!this.isLoaded())for(var le=0,pe=F;le<pe.length;le+=1){var ye=pe[le];this.images[ye]||(ne=!1)}this.isLoaded()||ne?this._notify(F,V):this.requestors.push({ids:F,callback:V})},R.prototype._notify=function(F,V){for(var ne={},le=0,pe=F;le<pe.length;le+=1){var ye=pe[le];this.images[ye]||this.fire(new e.Event("styleimagemissing",{id:ye}));var Te=this.images[ye];Te?ne[ye]={data:Te.data.clone(),pixelRatio:Te.pixelRatio,sdf:Te.sdf,version:Te.version,stretchX:Te.stretchX,stretchY:Te.stretchY,content:Te.content,hasRenderCallback:Boolean(Te.userImage&&Te.userImage.render)}:e.warnOnce('Image "'+ye+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}V(null,ne)},R.prototype.getPixelSize=function(){var F=this.atlasImage;return{width:F.width,height:F.height}},R.prototype.getPattern=function(F){var V=this.patterns[F],ne=this.getImage(F);if(!ne)return null;if(V&&V.position.version===ne.version)return V.position;if(V)V.position.version=ne.version;else{var le={w:ne.data.width+2,h:ne.data.height+2,x:0,y:0},pe=new e.ImagePosition(le,ne);this.patterns[F]={bin:le,position:pe}}return this._updatePatternAtlas(),this.patterns[F].position},R.prototype.bind=function(F){var V=F.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(F,this.atlasImage,V.RGBA),this.atlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE)},R.prototype._updatePatternAtlas=function(){var F=[];for(var V in this.patterns)F.push(this.patterns[V].bin);var ne=e.potpack(F),le=ne.w,pe=ne.h,ye=this.atlasImage;for(var Te in ye.resize({width:le||1,height:pe||1}),this.patterns){var Ne=this.patterns[Te].bin,Ge=Ne.x+1,nt=Ne.y+1,bt=this.images[Te].data,Ct=bt.width,Tt=bt.height;e.RGBAImage.copy(bt,ye,{x:0,y:0},{x:Ge,y:nt},{width:Ct,height:Tt}),e.RGBAImage.copy(bt,ye,{x:0,y:Tt-1},{x:Ge,y:nt-1},{width:Ct,height:1}),e.RGBAImage.copy(bt,ye,{x:0,y:0},{x:Ge,y:nt+Tt},{width:Ct,height:1}),e.RGBAImage.copy(bt,ye,{x:Ct-1,y:0},{x:Ge-1,y:nt},{width:1,height:Tt}),e.RGBAImage.copy(bt,ye,{x:0,y:0},{x:Ge+Ct,y:nt},{width:1,height:Tt})}this.dirty=!0},R.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},R.prototype.dispatchRenderCallbacks=function(F){for(var V=0,ne=F;V<ne.length;V+=1){var le=ne[V];if(!this.callbackDispatchedThisFrame[le]){this.callbackDispatchedThisFrame[le]=!0;var pe=this.images[le];h(pe)&&this.updateImage(le,pe)}}},R}(e.Evented),v=T,_=T,x=1e20;function T(E,R,F,V,ne,le){this.fontSize=E||24,this.buffer=R===void 0?3:R,this.cutoff=V||.25,this.fontFamily=ne||"sans-serif",this.fontWeight=le||"normal",this.radius=F||8;var pe=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=pe,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(pe*pe),this.gridInner=new Float64Array(pe*pe),this.f=new Float64Array(pe),this.d=new Float64Array(pe),this.z=new Float64Array(pe+1),this.v=new Int16Array(pe),this.middle=Math.round(pe/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function A(E,R,F,V,ne,le,pe){for(var ye=0;ye<R;ye++){for(var Te=0;Te<F;Te++)V[Te]=E[Te*R+ye];for(S(V,ne,le,pe,F),Te=0;Te<F;Te++)E[Te*R+ye]=ne[Te]}for(Te=0;Te<F;Te++){for(ye=0;ye<R;ye++)V[ye]=E[Te*R+ye];for(S(V,ne,le,pe,R),ye=0;ye<R;ye++)E[Te*R+ye]=Math.sqrt(ne[ye])}}function S(E,R,F,V,ne){F[0]=0,V[0]=-x,V[1]=+x;for(var le=1,pe=0;le<ne;le++){for(var ye=(E[le]+le*le-(E[F[pe]]+F[pe]*F[pe]))/(2*le-2*F[pe]);ye<=V[pe];)pe--,ye=(E[le]+le*le-(E[F[pe]]+F[pe]*F[pe]))/(2*le-2*F[pe]);F[++pe]=le,V[pe]=ye,V[pe+1]=+x}for(le=0,pe=0;le<ne;le++){for(;V[pe+1]<le;)pe++;R[le]=(le-F[pe])*(le-F[pe])+E[F[pe]]}}T.prototype.draw=function(E){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(E,this.buffer,this.middle);for(var R=this.ctx.getImageData(0,0,this.size,this.size),F=new Uint8ClampedArray(this.size*this.size),V=0;V<this.size*this.size;V++){var ne=R.data[4*V+3]/255;this.gridOuter[V]=ne===1?0:ne===0?x:Math.pow(Math.max(0,.5-ne),2),this.gridInner[V]=ne===1?x:ne===0?0:Math.pow(Math.max(0,ne-.5),2)}for(A(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),A(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),V=0;V<this.size*this.size;V++){var le=this.gridOuter[V]-this.gridInner[V];F[V]=Math.max(0,Math.min(255,Math.round(255-255*(le/this.radius+this.cutoff))))}return F},v.default=_;var w=function(E,R){this.requestManager=E,this.localIdeographFontFamily=R,this.entries={}};w.prototype.setURL=function(E){this.url=E},w.prototype.getGlyphs=function(E,R){var F=this,V=[];for(var ne in E)for(var le=0,pe=E[ne];le<pe.length;le+=1){var ye=pe[le];V.push({stack:ne,id:ye})}e.asyncAll(V,function(Te,Ne){var Ge=Te.stack,nt=Te.id,bt=F.entries[Ge];bt||(bt=F.entries[Ge]={glyphs:{},requests:{},ranges:{}});var Ct=bt.glyphs[nt];if(Ct===void 0){if(Ct=F._tinySDF(bt,Ge,nt))return bt.glyphs[nt]=Ct,void Ne(null,{stack:Ge,id:nt,glyph:Ct});var Tt=Math.floor(nt/256);if(256*Tt>65535)Ne(new Error("glyphs > 65535 not supported"));else if(bt.ranges[Tt])Ne(null,{stack:Ge,id:nt,glyph:Ct});else{var At=bt.requests[Tt];At||(At=bt.requests[Tt]=[],w.loadGlyphRange(Ge,Tt,F.url,F.requestManager,function(yt,Ft){if(Ft){for(var zt in Ft)F._doesCharSupportLocalGlyph(+zt)||(bt.glyphs[+zt]=Ft[+zt]);bt.ranges[Tt]=!0}for(var jt=0,rr=At;jt<rr.length;jt+=1)(0,rr[jt])(yt,Ft);delete bt.requests[Tt]})),At.push(function(yt,Ft){yt?Ne(yt):Ft&&Ne(null,{stack:Ge,id:nt,glyph:Ft[nt]||null})})}}else Ne(null,{stack:Ge,id:nt,glyph:Ct})},function(Te,Ne){if(Te)R(Te);else if(Ne){for(var Ge={},nt=0,bt=Ne;nt<bt.length;nt+=1){var Ct=bt[nt],Tt=Ct.stack,At=Ct.id,yt=Ct.glyph;(Ge[Tt]||(Ge[Tt]={}))[At]=yt&&{id:yt.id,bitmap:yt.bitmap.clone(),metrics:yt.metrics}}R(null,Ge)}})},w.prototype._doesCharSupportLocalGlyph=function(E){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](E)||e.isChar["Hangul Syllables"](E)||e.isChar.Hiragana(E)||e.isChar.Katakana(E))},w.prototype._tinySDF=function(E,R,F){var V=this.localIdeographFontFamily;if(V&&this._doesCharSupportLocalGlyph(F)){var ne=E.tinySDF;if(!ne){var le="400";/bold/i.test(R)?le="900":/medium/i.test(R)?le="500":/light/i.test(R)&&(le="200"),ne=E.tinySDF=new w.TinySDF(24,3,8,.25,V,le)}return{id:F,bitmap:new e.AlphaImage({width:30,height:30},ne.draw(String.fromCharCode(F))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},w.loadGlyphRange=function(E,R,F,V,ne){var le=256*R,pe=le+255,ye=V.transformRequest(V.normalizeGlyphsURL(F).replace("{fontstack}",E).replace("{range}",le+"-"+pe),e.ResourceType.Glyphs);e.getArrayBuffer(ye,function(Te,Ne){if(Te)ne(Te);else if(Ne){for(var Ge={},nt=0,bt=e.parseGlyphPBF(Ne);nt<bt.length;nt+=1){var Ct=bt[nt];Ge[Ct.id]=Ct}ne(null,Ge)}})},w.TinySDF=v;var C=function(){this.specification=e.styleSpec.light.position};C.prototype.possiblyEvaluate=function(E,R){return e.sphericalToCartesian(E.expression.evaluate(R))},C.prototype.interpolate=function(E,R,F){return{x:e.number(E.x,R.x,F),y:e.number(E.y,R.y,F),z:e.number(E.z,R.z,F)}};var k=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new C,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),L=function(E){function R(F){E.call(this),this._transitionable=new e.Transitionable(k),this.setLight(F),this._transitioning=this._transitionable.untransitioned()}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getLight=function(){return this._transitionable.serialize()},R.prototype.setLight=function(F,V){if(V===void 0&&(V={}),!this._validate(e.validateLight,F,V))for(var ne in F){var le=F[ne];e.endsWith(ne,"-transition")?this._transitionable.setTransition(ne.slice(0,-"-transition".length),le):this._transitionable.setValue(ne,le)}},R.prototype.updateTransitions=function(F){this._transitioning=this._transitionable.transitioned(F,this._transitioning)},R.prototype.hasTransition=function(){return this._transitioning.hasTransition()},R.prototype.recalculate=function(F){this.properties=this._transitioning.possiblyEvaluate(F)},R.prototype._validate=function(F,V,ne){return(!ne||ne.validate!==!1)&&e.emitValidationErrors(this,F.call(e.validateStyle,e.extend({value:V,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},R}(e.Evented),M=function(E,R){this.width=E,this.height=R,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};M.prototype.getDash=function(E,R){var F=E.join(",")+String(R);return this.dashEntry[F]||(this.dashEntry[F]=this.addDash(E,R)),this.dashEntry[F]},M.prototype.getDashRanges=function(E,R,F){var V=[],ne=E.length%2==1?-E[E.length-1]*F:0,le=E[0]*F,pe=!0;V.push({left:ne,right:le,isDash:pe,zeroLength:E[0]===0});for(var ye=E[0],Te=1;Te<E.length;Te++){pe=!pe;var Ne=E[Te];ne=ye*F,le=(ye+=Ne)*F,V.push({left:ne,right:le,isDash:pe,zeroLength:Ne===0})}return V},M.prototype.addRoundDash=function(E,R,F){for(var V=R/2,ne=-F;ne<=F;ne++)for(var le=this.nextRow+F+ne,pe=this.width*le,ye=0,Te=E[ye],Ne=0;Ne<this.width;Ne++){Ne/Te.right>1&&(Te=E[++ye]);var Ge=Math.abs(Ne-Te.left),nt=Math.abs(Ne-Te.right),bt=Math.min(Ge,nt),Ct=void 0,Tt=ne/F*(V+1);if(Te.isDash){var At=V-Math.abs(Tt);Ct=Math.sqrt(bt*bt+At*At)}else Ct=V-Math.sqrt(bt*bt+Tt*Tt);this.data[pe+Ne]=Math.max(0,Math.min(255,Ct+128))}},M.prototype.addRegularDash=function(E){for(var R=E.length-1;R>=0;--R){var F=E[R],V=E[R+1];F.zeroLength?E.splice(R,1):V&&V.isDash===F.isDash&&(V.left=F.left,E.splice(R,1))}var ne=E[0],le=E[E.length-1];ne.isDash===le.isDash&&(ne.left=le.left-this.width,le.right=ne.right+this.width);for(var pe=this.width*this.nextRow,ye=0,Te=E[ye],Ne=0;Ne<this.width;Ne++){Ne/Te.right>1&&(Te=E[++ye]);var Ge=Math.abs(Ne-Te.left),nt=Math.abs(Ne-Te.right),bt=Math.min(Ge,nt),Ct=Te.isDash?bt:-bt;this.data[pe+Ne]=Math.max(0,Math.min(255,Ct+128))}},M.prototype.addDash=function(E,R){var F=R?7:0,V=2*F+1;if(this.nextRow+V>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var ne=0,le=0;le<E.length;le++)ne+=E[le];if(ne!==0){var pe=this.width/ne,ye=this.getDashRanges(E,this.width,pe);R?this.addRoundDash(ye,pe,F):this.addRegularDash(ye)}var Te={y:(this.nextRow+F+.5)/this.height,height:2*F/this.height,width:ne};return this.nextRow+=V,this.dirty=!0,Te},M.prototype.bind=function(E){var R=E.gl;this.texture?(R.bindTexture(R.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,R.texSubImage2D(R.TEXTURE_2D,0,0,0,this.width,this.height,R.ALPHA,R.UNSIGNED_BYTE,this.data))):(this.texture=R.createTexture(),R.bindTexture(R.TEXTURE_2D,this.texture),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_WRAP_S,R.REPEAT),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_WRAP_T,R.REPEAT),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MIN_FILTER,R.LINEAR),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MAG_FILTER,R.LINEAR),R.texImage2D(R.TEXTURE_2D,0,R.ALPHA,this.width,this.height,0,R.ALPHA,R.UNSIGNED_BYTE,this.data))};var P=function E(R,F){this.workerPool=R,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var V=this.workerPool.acquire(this.id),ne=0;ne<V.length;ne++){var le=V[ne],pe=new E.Actor(le,F,this.id);pe.name="Worker "+ne,this.actors.push(pe)}};function D(E,R,F){var V=function(ne,le){if(ne)return F(ne);if(le){var pe=e.pick(e.extend(le,E),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);le.vector_layers&&(pe.vectorLayers=le.vector_layers,pe.vectorLayerIds=pe.vectorLayers.map(function(ye){return ye.id})),pe.tiles=R.canonicalizeTileset(pe,E.url),F(null,pe)}};return E.url?e.getJSON(R.transformRequest(R.normalizeSourceURL(E.url),e.ResourceType.Source),V):e.browser.frame(function(){return V(null,E)})}P.prototype.broadcast=function(E,R,F){F=F||function(){},e.asyncAll(this.actors,function(V,ne){V.send(E,R,ne)},F)},P.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},P.prototype.remove=function(){this.actors.forEach(function(E){E.remove()}),this.actors=[],this.workerPool.release(this.id)},P.Actor=e.Actor;var N=function(E,R,F){this.bounds=e.LngLatBounds.convert(this.validateBounds(E)),this.minzoom=R||0,this.maxzoom=F||24};N.prototype.validateBounds=function(E){return Array.isArray(E)&&E.length===4?[Math.max(-180,E[0]),Math.max(-90,E[1]),Math.min(180,E[2]),Math.min(90,E[3])]:[-180,-90,180,90]},N.prototype.contains=function(E){var R=Math.pow(2,E.z),F=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*R),V=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*R),ne=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*R),le=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*R);return E.x>=F&&E.x<ne&&E.y>=V&&E.y<le};var U=function(E){function R(F,V,ne,le){if(E.call(this),this.id=F,this.dispatcher=ne,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(V,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},V),this._collectResourceTiming=V.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(le)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.load=function(){var F=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=D(this._options,this.map._requestManager,function(V,ne){F._tileJSONRequest=null,F._loaded=!0,V?F.fire(new e.ErrorEvent(V)):ne&&(e.extend(F,ne),ne.bounds&&(F.tileBounds=new N(ne.bounds,F.minzoom,F.maxzoom)),e.postTurnstileEvent(ne.tiles,F.map._requestManager._customAccessToken),e.postMapLoadEvent(ne.tiles,F.map._getMapId(),F.map._requestManager._skuToken,F.map._requestManager._customAccessToken),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},R.prototype.loaded=function(){return this._loaded},R.prototype.hasTile=function(F){return!this.tileBounds||this.tileBounds.contains(F.canonical)},R.prototype.onAdd=function(F){this.map=F,this.load()},R.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},R.prototype.serialize=function(){return e.extend({},this._options)},R.prototype.loadTile=function(F,V){var ne=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme)),le={request:this.map._requestManager.transformRequest(ne,e.ResourceType.Tile),uid:F.uid,tileID:F.tileID,zoom:F.tileID.overscaledZ,tileSize:this.tileSize*F.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function pe(ye,Te){return delete F.request,F.aborted?V(null):ye&&ye.status!==404?V(ye):(Te&&Te.resourceTiming&&(F.resourceTiming=Te.resourceTiming),this.map._refreshExpiredTiles&&Te&&F.setExpiryData(Te),F.loadVectorData(Te,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),V(null),void(F.reloadCallback&&(this.loadTile(F,F.reloadCallback),F.reloadCallback=null)))}le.request.collectResourceTiming=this._collectResourceTiming,F.actor&&F.state!=="expired"?F.state==="loading"?F.reloadCallback=V:F.request=F.actor.send("reloadTile",le,pe.bind(this)):(F.actor=this.dispatcher.getActor(),F.request=F.actor.send("loadTile",le,pe.bind(this)))},R.prototype.abortTile=function(F){F.request&&(F.request.cancel(),delete F.request),F.actor&&F.actor.send("abortTile",{uid:F.uid,type:this.type,source:this.id},void 0)},R.prototype.unloadTile=function(F){F.unloadVectorData(),F.actor&&F.actor.send("removeTile",{uid:F.uid,type:this.type,source:this.id},void 0)},R.prototype.hasTransition=function(){return!1},R}(e.Evented),q=function(E){function R(F,V,ne,le){E.call(this),this.id=F,this.dispatcher=ne,this.setEventedParent(le),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},V),e.extend(this,e.pick(V,["url","scheme","tileSize"]))}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.load=function(){var F=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=D(this._options,this.map._requestManager,function(V,ne){F._tileJSONRequest=null,F._loaded=!0,V?F.fire(new e.ErrorEvent(V)):ne&&(e.extend(F,ne),ne.bounds&&(F.tileBounds=new N(ne.bounds,F.minzoom,F.maxzoom)),e.postTurnstileEvent(ne.tiles),e.postMapLoadEvent(ne.tiles,F.map._getMapId(),F.map._requestManager._skuToken),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},R.prototype.loaded=function(){return this._loaded},R.prototype.onAdd=function(F){this.map=F,this.load()},R.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},R.prototype.serialize=function(){return e.extend({},this._options)},R.prototype.hasTile=function(F){return!this.tileBounds||this.tileBounds.contains(F.canonical)},R.prototype.loadTile=function(F,V){var ne=this,le=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);F.request=e.getImage(this.map._requestManager.transformRequest(le,e.ResourceType.Tile),function(pe,ye){if(delete F.request,F.aborted)F.state="unloaded",V(null);else if(pe)F.state="errored",V(pe);else if(ye){ne.map._refreshExpiredTiles&&F.setExpiryData(ye),delete ye.cacheControl,delete ye.expires;var Te=ne.map.painter.context,Ne=Te.gl;F.texture=ne.map.painter.getTileTexture(ye.width),F.texture?F.texture.update(ye,{useMipmap:!0}):(F.texture=new e.Texture(Te,ye,Ne.RGBA,{useMipmap:!0}),F.texture.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE,Ne.LINEAR_MIPMAP_NEAREST),Te.extTextureFilterAnisotropic&&Ne.texParameterf(Ne.TEXTURE_2D,Te.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Te.extTextureFilterAnisotropicMax)),F.state="loaded",e.cacheEntryPossiblyAdded(ne.dispatcher),V(null)}})},R.prototype.abortTile=function(F,V){F.request&&(F.request.cancel(),delete F.request),V()},R.prototype.unloadTile=function(F,V){F.texture&&this.map.painter.saveTileTexture(F.texture),V()},R.prototype.hasTransition=function(){return!1},R}(e.Evented),X=function(E){function R(F,V,ne,le){E.call(this,F,V,ne,le),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},V),this.encoding=V.encoding||"mapbox"}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},R.prototype.loadTile=function(F,V){var ne=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function le(pe,ye){pe&&(F.state="errored",V(pe)),ye&&(F.dem=ye,F.needsHillshadePrepare=!0,F.state="loaded",V(null))}F.request=e.getImage(this.map._requestManager.transformRequest(ne,e.ResourceType.Tile),function(pe,ye){if(delete F.request,F.aborted)F.state="unloaded",V(null);else if(pe)F.state="errored",V(pe);else if(ye){this.map._refreshExpiredTiles&&F.setExpiryData(ye),delete ye.cacheControl,delete ye.expires;var Te=e.window.ImageBitmap&&ye instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported()?ye:e.browser.getImageData(ye,1),Ne={uid:F.uid,coord:F.tileID,source:this.id,rawImageData:Te,encoding:this.encoding};F.actor&&F.state!=="expired"||(F.actor=this.dispatcher.getActor(),F.actor.send("loadDEMTile",Ne,le.bind(this)))}}.bind(this)),F.neighboringTiles=this._getNeighboringTiles(F.tileID)},R.prototype._getNeighboringTiles=function(F){var V=F.canonical,ne=Math.pow(2,V.z),le=(V.x-1+ne)%ne,pe=V.x===0?F.wrap-1:F.wrap,ye=(V.x+1+ne)%ne,Te=V.x+1===ne?F.wrap+1:F.wrap,Ne={};return Ne[new e.OverscaledTileID(F.overscaledZ,pe,V.z,le,V.y).key]={backfilled:!1},Ne[new e.OverscaledTileID(F.overscaledZ,Te,V.z,ye,V.y).key]={backfilled:!1},V.y>0&&(Ne[new e.OverscaledTileID(F.overscaledZ,pe,V.z,le,V.y-1).key]={backfilled:!1},Ne[new e.OverscaledTileID(F.overscaledZ,F.wrap,V.z,V.x,V.y-1).key]={backfilled:!1},Ne[new e.OverscaledTileID(F.overscaledZ,Te,V.z,ye,V.y-1).key]={backfilled:!1}),V.y+1<ne&&(Ne[new e.OverscaledTileID(F.overscaledZ,pe,V.z,le,V.y+1).key]={backfilled:!1},Ne[new e.OverscaledTileID(F.overscaledZ,F.wrap,V.z,V.x,V.y+1).key]={backfilled:!1},Ne[new e.OverscaledTileID(F.overscaledZ,Te,V.z,ye,V.y+1).key]={backfilled:!1}),Ne},R.prototype.unloadTile=function(F){F.demTexture&&this.map.painter.saveTileTexture(F.demTexture),F.fbo&&(F.fbo.destroy(),delete F.fbo),F.dem&&delete F.dem,delete F.neighboringTiles,F.state="unloaded",F.actor&&F.actor.send("removeDEMTile",{uid:F.uid,source:this.id})},R}(q),K=function(E){function R(F,V,ne,le){E.call(this),this.id=F,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=ne.getActor(),this.setEventedParent(le),this._data=V.data,this._options=e.extend({},V),this._collectResourceTiming=V.collectResourceTiming,this._resourceTiming=[],V.maxzoom!==void 0&&(this.maxzoom=V.maxzoom),V.type&&(this.type=V.type),V.attribution&&(this.attribution=V.attribution),this.promoteId=V.promoteId;var pe=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:V.cluster||!1,geojsonVtOptions:{buffer:(V.buffer!==void 0?V.buffer:128)*pe,tolerance:(V.tolerance!==void 0?V.tolerance:.375)*pe,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:V.lineMetrics||!1,generateId:V.generateId||!1},superclusterOptions:{maxZoom:V.clusterMaxZoom!==void 0?Math.min(V.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(V.clusterRadius||50)*pe,log:!1,generateId:V.generateId||!1},clusterProperties:V.clusterProperties},V.workerOptions)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.load=function(){var F=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(V){if(V)F.fire(new e.ErrorEvent(V));else{var ne={dataType:"source",sourceDataType:"metadata"};F._collectResourceTiming&&F._resourceTiming&&F._resourceTiming.length>0&&(ne.resourceTiming=F._resourceTiming,F._resourceTiming=[]),F.fire(new e.Event("data",ne))}})},R.prototype.onAdd=function(F){this.map=F,this.load()},R.prototype.setData=function(F){var V=this;return this._data=F,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(ne){if(ne)V.fire(new e.ErrorEvent(ne));else{var le={dataType:"source",sourceDataType:"content"};V._collectResourceTiming&&V._resourceTiming&&V._resourceTiming.length>0&&(le.resourceTiming=V._resourceTiming,V._resourceTiming=[]),V.fire(new e.Event("data",le))}}),this},R.prototype.getClusterExpansionZoom=function(F,V){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:F,source:this.id},V),this},R.prototype.getClusterChildren=function(F,V){return this.actor.send("geojson.getClusterChildren",{clusterId:F,source:this.id},V),this},R.prototype.getClusterLeaves=function(F,V,ne,le){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:F,limit:V,offset:ne},le),this},R.prototype._updateWorkerData=function(F){var V=this;this._loaded=!1;var ne=e.extend({},this.workerOptions),le=this._data;typeof le=="string"?(ne.request=this.map._requestManager.transformRequest(e.browser.resolveURL(le),e.ResourceType.Source),ne.request.collectResourceTiming=this._collectResourceTiming):ne.data=JSON.stringify(le),this.actor.send(this.type+".loadData",ne,function(pe,ye){V._removed||ye&&ye.abandoned||(V._loaded=!0,ye&&ye.resourceTiming&&ye.resourceTiming[V.id]&&(V._resourceTiming=ye.resourceTiming[V.id].slice(0)),V.actor.send(V.type+".coalesce",{source:ne.source},null),F(pe))})},R.prototype.loaded=function(){return this._loaded},R.prototype.loadTile=function(F,V){var ne=this,le=F.actor?"reloadTile":"loadTile";F.actor=this.actor;var pe={type:this.type,uid:F.uid,tileID:F.tileID,zoom:F.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};F.request=this.actor.send(le,pe,function(ye,Te){return delete F.request,F.unloadVectorData(),F.aborted?V(null):ye?V(ye):(F.loadVectorData(Te,ne.map.painter,le==="reloadTile"),V(null))})},R.prototype.abortTile=function(F){F.request&&(F.request.cancel(),delete F.request),F.aborted=!0},R.prototype.unloadTile=function(F){F.unloadVectorData(),this.actor.send("removeTile",{uid:F.uid,type:this.type,source:this.id})},R.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},R.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},R.prototype.hasTransition=function(){return!1},R}(e.Evented),Z=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),H=function(E){function R(F,V,ne,le){E.call(this),this.id=F,this.dispatcher=ne,this.coordinates=V.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(le),this.options=V}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.load=function(F,V){var ne=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(le,pe){ne._loaded=!0,le?ne.fire(new e.ErrorEvent(le)):pe&&(ne.image=pe,F&&(ne.coordinates=F),V&&V(),ne._finishLoading())})},R.prototype.loaded=function(){return this._loaded},R.prototype.updateImage=function(F){var V=this;return this.image&&F.url?(this.options.url=F.url,this.load(F.coordinates,function(){V.texture=null}),this):this},R.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},R.prototype.onAdd=function(F){this.map=F,this.load()},R.prototype.setCoordinates=function(F){var V=this;this.coordinates=F;var ne=F.map(e.MercatorCoordinate.fromLngLat);this.tileID=function(pe){for(var ye=1/0,Te=1/0,Ne=-1/0,Ge=-1/0,nt=0,bt=pe;nt<bt.length;nt+=1){var Ct=bt[nt];ye=Math.min(ye,Ct.x),Te=Math.min(Te,Ct.y),Ne=Math.max(Ne,Ct.x),Ge=Math.max(Ge,Ct.y)}var Tt=Ne-ye,At=Ge-Te,yt=Math.max(Tt,At),Ft=Math.max(0,Math.floor(-Math.log(yt)/Math.LN2)),zt=Math.pow(2,Ft);return new e.CanonicalTileID(Ft,Math.floor((ye+Ne)/2*zt),Math.floor((Te+Ge)/2*zt))}(ne),this.minzoom=this.maxzoom=this.tileID.z;var le=ne.map(function(pe){return V.tileID.getTilePoint(pe)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(le[0].x,le[0].y,0,0),this._boundsArray.emplaceBack(le[1].x,le[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(le[3].x,le[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(le[2].x,le[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},R.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var F=this.map.painter.context,V=F.gl;for(var ne in this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,Z.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(F,this.image,V.RGBA),this.texture.bind(V.LINEAR,V.CLAMP_TO_EDGE)),this.tiles){var le=this.tiles[ne];le.state!=="loaded"&&(le.state="loaded",le.texture=this.texture)}}},R.prototype.loadTile=function(F,V){this.tileID&&this.tileID.equals(F.tileID.canonical)?(this.tiles[String(F.tileID.wrap)]=F,F.buckets={},V(null)):(F.state="errored",V(null))},R.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},R.prototype.hasTransition=function(){return!1},R}(e.Evented),Y=function(E){function R(F,V,ne,le){E.call(this,F,V,ne,le),this.roundZoom=!0,this.type="video",this.options=V}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.load=function(){var F=this;this._loaded=!1;var V=this.options;this.urls=[];for(var ne=0,le=V.urls;ne<le.length;ne+=1){var pe=le[ne];this.urls.push(this.map._requestManager.transformRequest(pe,e.ResourceType.Source).url)}e.getVideo(this.urls,function(ye,Te){F._loaded=!0,ye?F.fire(new e.ErrorEvent(ye)):Te&&(F.video=Te,F.video.loop=!0,F.video.addEventListener("playing",function(){F.map.triggerRepaint()}),F.map&&F.video.play(),F._finishLoading())})},R.prototype.pause=function(){this.video&&this.video.pause()},R.prototype.play=function(){this.video&&this.video.play()},R.prototype.seek=function(F){if(this.video){var V=this.video.seekable;F<V.start(0)||F>V.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+V.start(0)+" and "+V.end(0)+"-second mark."))):this.video.currentTime=F}},R.prototype.getVideo=function(){return this.video},R.prototype.onAdd=function(F){this.map||(this.map=F,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},R.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var F=this.map.painter.context,V=F.gl;for(var ne in this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,Z.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(V.LINEAR,V.CLAMP_TO_EDGE),V.texSubImage2D(V.TEXTURE_2D,0,0,0,V.RGBA,V.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(F,this.video,V.RGBA),this.texture.bind(V.LINEAR,V.CLAMP_TO_EDGE)),this.tiles){var le=this.tiles[ne];le.state!=="loaded"&&(le.state="loaded",le.texture=this.texture)}}},R.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},R.prototype.hasTransition=function(){return this.video&&!this.video.paused},R}(H),$=function(E){function R(F,V,ne,le){E.call(this,F,V,ne,le),V.coordinates?Array.isArray(V.coordinates)&&V.coordinates.length===4&&!V.coordinates.some(function(pe){return!Array.isArray(pe)||pe.length!==2||pe.some(function(ye){return typeof ye!="number"})})||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'missing required property "coordinates"'))),V.animate&&typeof V.animate!="boolean"&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'optional "animate" property must be a boolean value'))),V.canvas?typeof V.canvas=="string"||V.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'missing required property "canvas"'))),this.options=V,this.animate=V.animate===void 0||V.animate}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},R.prototype.getCanvas=function(){return this.canvas},R.prototype.onAdd=function(F){this.map=F,this.load(),this.canvas&&this.animate&&this.play()},R.prototype.onRemove=function(){this.pause()},R.prototype.prepare=function(){var F=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,F=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,F=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var V=this.map.painter.context,ne=V.gl;for(var le in this.boundsBuffer||(this.boundsBuffer=V.createVertexBuffer(this._boundsArray,Z.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(F||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(V,this.canvas,ne.RGBA,{premultiply:!0}),this.tiles){var pe=this.tiles[le];pe.state!=="loaded"&&(pe.state="loaded",pe.texture=this.texture)}}},R.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},R.prototype.hasTransition=function(){return this._playing},R.prototype._hasInvalidDimensions=function(){for(var F=0,V=[this.canvas.width,this.canvas.height];F<V.length;F+=1){var ne=V[F];if(isNaN(ne)||ne<=0)return!0}return!1},R}(H),z={vector:U,raster:q,"raster-dem":X,geojson:K,video:Y,image:H,canvas:$};function j(E,R){var F=e.identity([]);return e.translate(F,F,[1,1,0]),e.scale(F,F,[.5*E.width,.5*E.height,1]),e.multiply(F,F,E.calculatePosMatrix(R.toUnwrapped()))}function W(E,R,F,V,ne,le){var pe=function(At,yt,Ft){if(At)for(var zt=0,jt=At;zt<jt.length;zt+=1){var rr=yt[jt[zt]];if(rr&&rr.source===Ft&&rr.type==="fill-extrusion")return!0}else for(var hr in yt){var Ar=yt[hr];if(Ar.source===Ft&&Ar.type==="fill-extrusion")return!0}return!1}(ne&&ne.layers,R,E.id),ye=le.maxPitchScaleFactor(),Te=E.tilesIn(V,ye,pe);Te.sort(ee);for(var Ne=[],Ge=0,nt=Te;Ge<nt.length;Ge+=1){var bt=nt[Ge];Ne.push({wrappedTileID:bt.tileID.wrapped().key,queryResults:bt.tile.queryRenderedFeatures(R,F,E._state,bt.queryGeometry,bt.cameraQueryGeometry,bt.scale,ne,le,ye,j(E.transform,bt.tileID))})}var Ct=function(At){for(var yt={},Ft={},zt=0,jt=At;zt<jt.length;zt+=1){var rr=jt[zt],hr=rr.queryResults,Ar=rr.wrappedTileID,kr=Ft[Ar]=Ft[Ar]||{};for(var Kr in hr)for(var Zr=hr[Kr],hn=kr[Kr]=kr[Kr]||{},sn=yt[Kr]=yt[Kr]||[],Un=0,Wn=Zr;Un<Wn.length;Un+=1){var ua=Wn[Un];hn[ua.featureIndex]||(hn[ua.featureIndex]=!0,sn.push(ua))}}return yt}(Ne);for(var Tt in Ct)Ct[Tt].forEach(function(At){var yt=At.feature,Ft=E.getFeatureState(yt.layer["source-layer"],yt.id);yt.source=yt.layer.source,yt.layer["source-layer"]&&(yt.sourceLayer=yt.layer["source-layer"]),yt.state=Ft});return Ct}function ee(E,R){var F=E.tileID,V=R.tileID;return F.overscaledZ-V.overscaledZ||F.canonical.y-V.canonical.y||F.wrap-V.wrap||F.canonical.x-V.canonical.x}var J=function(E,R){this.max=E,this.onRemove=R,this.reset()};J.prototype.reset=function(){for(var E in this.data)for(var R=0,F=this.data[E];R<F.length;R+=1){var V=F[R];V.timeout&&clearTimeout(V.timeout),this.onRemove(V.value)}return this.data={},this.order=[],this},J.prototype.add=function(E,R,F){var V=this,ne=E.wrapped().key;this.data[ne]===void 0&&(this.data[ne]=[]);var le={value:R,timeout:void 0};if(F!==void 0&&(le.timeout=setTimeout(function(){V.remove(E,le)},F)),this.data[ne].push(le),this.order.push(ne),this.order.length>this.max){var pe=this._getAndRemoveByKey(this.order[0]);pe&&this.onRemove(pe)}return this},J.prototype.has=function(E){return E.wrapped().key in this.data},J.prototype.getAndRemove=function(E){return this.has(E)?this._getAndRemoveByKey(E.wrapped().key):null},J.prototype._getAndRemoveByKey=function(E){var R=this.data[E].shift();return R.timeout&&clearTimeout(R.timeout),this.data[E].length===0&&delete this.data[E],this.order.splice(this.order.indexOf(E),1),R.value},J.prototype.getByKey=function(E){var R=this.data[E];return R?R[0].value:null},J.prototype.get=function(E){return this.has(E)?this.data[E.wrapped().key][0].value:null},J.prototype.remove=function(E,R){if(!this.has(E))return this;var F=E.wrapped().key,V=R===void 0?0:this.data[F].indexOf(R),ne=this.data[F][V];return this.data[F].splice(V,1),ne.timeout&&clearTimeout(ne.timeout),this.data[F].length===0&&delete this.data[F],this.onRemove(ne.value),this.order.splice(this.order.indexOf(F),1),this},J.prototype.setMaxSize=function(E){for(this.max=E;this.order.length>this.max;){var R=this._getAndRemoveByKey(this.order[0]);R&&this.onRemove(R)}return this},J.prototype.filter=function(E){var R=[];for(var F in this.data)for(var V=0,ne=this.data[F];V<ne.length;V+=1){var le=ne[V];E(le.value)||R.push(le)}for(var pe=0,ye=R;pe<ye.length;pe+=1){var Te=ye[pe];this.remove(Te.value.tileID,Te)}};var Q=function(E,R,F){this.context=E;var V=E.gl;this.buffer=V.createBuffer(),this.dynamicDraw=Boolean(F),this.context.unbindVAO(),E.bindElementBuffer.set(this.buffer),V.bufferData(V.ELEMENT_ARRAY_BUFFER,R.arrayBuffer,this.dynamicDraw?V.DYNAMIC_DRAW:V.STATIC_DRAW),this.dynamicDraw||delete R.arrayBuffer};Q.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Q.prototype.updateData=function(E){var R=this.context.gl;this.context.unbindVAO(),this.bind(),R.bufferSubData(R.ELEMENT_ARRAY_BUFFER,0,E.arrayBuffer)},Q.prototype.destroy=function(){var E=this.context.gl;this.buffer&&(E.deleteBuffer(this.buffer),delete this.buffer)};var te={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ie=function(E,R,F,V){this.length=R.length,this.attributes=F,this.itemSize=R.bytesPerElement,this.dynamicDraw=V,this.context=E;var ne=E.gl;this.buffer=ne.createBuffer(),E.bindVertexBuffer.set(this.buffer),ne.bufferData(ne.ARRAY_BUFFER,R.arrayBuffer,this.dynamicDraw?ne.DYNAMIC_DRAW:ne.STATIC_DRAW),this.dynamicDraw||delete R.arrayBuffer};ie.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ie.prototype.updateData=function(E){var R=this.context.gl;this.bind(),R.bufferSubData(R.ARRAY_BUFFER,0,E.arrayBuffer)},ie.prototype.enableAttributes=function(E,R){for(var F=0;F<this.attributes.length;F++){var V=this.attributes[F],ne=R.attributes[V.name];ne!==void 0&&E.enableVertexAttribArray(ne)}},ie.prototype.setVertexAttribPointers=function(E,R,F){for(var V=0;V<this.attributes.length;V++){var ne=this.attributes[V],le=R.attributes[ne.name];le!==void 0&&E.vertexAttribPointer(le,ne.components,E[te[ne.type]],!1,this.itemSize,ne.offset+this.itemSize*(F||0))}},ie.prototype.destroy=function(){var E=this.context.gl;this.buffer&&(E.deleteBuffer(this.buffer),delete this.buffer)};var ae=function(E){this.gl=E.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ae.prototype.get=function(){return this.current},ae.prototype.set=function(E){},ae.prototype.getDefault=function(){return this.default},ae.prototype.setDefault=function(){this.set(this.default)};var he=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return e.Color.transparent},R.prototype.set=function(F){var V=this.current;(F.r!==V.r||F.g!==V.g||F.b!==V.b||F.a!==V.a||this.dirty)&&(this.gl.clearColor(F.r,F.g,F.b,F.a),this.current=F,this.dirty=!1)},R}(ae),se=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return 1},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.clearDepth(F),this.current=F,this.dirty=!1)},R}(ae),de=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return 0},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.clearStencil(F),this.current=F,this.dirty=!1)},R}(ae),ue=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return[!0,!0,!0,!0]},R.prototype.set=function(F){var V=this.current;(F[0]!==V[0]||F[1]!==V[1]||F[2]!==V[2]||F[3]!==V[3]||this.dirty)&&(this.gl.colorMask(F[0],F[1],F[2],F[3]),this.current=F,this.dirty=!1)},R}(ae),ve=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!0},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.depthMask(F),this.current=F,this.dirty=!1)},R}(ae),ke=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return 255},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.stencilMask(F),this.current=F,this.dirty=!1)},R}(ae),Ee=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},R.prototype.set=function(F){var V=this.current;(F.func!==V.func||F.ref!==V.ref||F.mask!==V.mask||this.dirty)&&(this.gl.stencilFunc(F.func,F.ref,F.mask),this.current=F,this.dirty=!1)},R}(ae),be=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){var F=this.gl;return[F.KEEP,F.KEEP,F.KEEP]},R.prototype.set=function(F){var V=this.current;(F[0]!==V[0]||F[1]!==V[1]||F[2]!==V[2]||this.dirty)&&(this.gl.stencilOp(F[0],F[1],F[2]),this.current=F,this.dirty=!1)},R}(ae),xe=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;F?V.enable(V.STENCIL_TEST):V.disable(V.STENCIL_TEST),this.current=F,this.dirty=!1}},R}(ae),ce=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return[0,1]},R.prototype.set=function(F){var V=this.current;(F[0]!==V[0]||F[1]!==V[1]||this.dirty)&&(this.gl.depthRange(F[0],F[1]),this.current=F,this.dirty=!1)},R}(ae),ge=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;F?V.enable(V.DEPTH_TEST):V.disable(V.DEPTH_TEST),this.current=F,this.dirty=!1}},R}(ae),we=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.LESS},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.depthFunc(F),this.current=F,this.dirty=!1)},R}(ae),Me=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;F?V.enable(V.BLEND):V.disable(V.BLEND),this.current=F,this.dirty=!1}},R}(ae),Se=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){var F=this.gl;return[F.ONE,F.ZERO]},R.prototype.set=function(F){var V=this.current;(F[0]!==V[0]||F[1]!==V[1]||this.dirty)&&(this.gl.blendFunc(F[0],F[1]),this.current=F,this.dirty=!1)},R}(ae),ze=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return e.Color.transparent},R.prototype.set=function(F){var V=this.current;(F.r!==V.r||F.g!==V.g||F.b!==V.b||F.a!==V.a||this.dirty)&&(this.gl.blendColor(F.r,F.g,F.b,F.a),this.current=F,this.dirty=!1)},R}(ae),Fe=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.FUNC_ADD},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.blendEquation(F),this.current=F,this.dirty=!1)},R}(ae),Ye=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;F?V.enable(V.CULL_FACE):V.disable(V.CULL_FACE),this.current=F,this.dirty=!1}},R}(ae),rt=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.BACK},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.cullFace(F),this.current=F,this.dirty=!1)},R}(ae),Oe=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.CCW},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.frontFace(F),this.current=F,this.dirty=!1)},R}(ae),je=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.useProgram(F),this.current=F,this.dirty=!1)},R}(ae),We=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.TEXTURE0},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.activeTexture(F),this.current=F,this.dirty=!1)},R}(ae),qe=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){var F=this.gl;return[0,0,F.drawingBufferWidth,F.drawingBufferHeight]},R.prototype.set=function(F){var V=this.current;(F[0]!==V[0]||F[1]!==V[1]||F[2]!==V[2]||F[3]!==V[3]||this.dirty)&&(this.gl.viewport(F[0],F[1],F[2],F[3]),this.current=F,this.dirty=!1)},R}(ae),Qe=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;V.bindFramebuffer(V.FRAMEBUFFER,F),this.current=F,this.dirty=!1}},R}(ae),st=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;V.bindRenderbuffer(V.RENDERBUFFER,F),this.current=F,this.dirty=!1}},R}(ae),ct=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;V.bindTexture(V.TEXTURE_2D,F),this.current=F,this.dirty=!1}},R}(ae),Pt=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;V.bindBuffer(V.ARRAY_BUFFER,F),this.current=F,this.dirty=!1}},R}(ae),kt=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){var V=this.gl;V.bindBuffer(V.ELEMENT_ARRAY_BUFFER,F),this.current=F,this.dirty=!1},R}(ae),at=function(E){function R(F){E.call(this,F),this.vao=F.extVertexArrayObject}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){this.vao&&(F!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(F),this.current=F,this.dirty=!1)},R}(ae),tt=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return 4},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;V.pixelStorei(V.UNPACK_ALIGNMENT,F),this.current=F,this.dirty=!1}},R}(ae),_t=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;V.pixelStorei(V.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F),this.current=F,this.dirty=!1}},R}(ae),er=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;V.pixelStorei(V.UNPACK_FLIP_Y_WEBGL,F),this.current=F,this.dirty=!1}},R}(ae),tr=function(E){function R(F,V){E.call(this,F),this.context=F,this.parent=V}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R}(ae),Ue=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.setDirty=function(){this.dirty=!0},R.prototype.set=function(F){if(F!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var V=this.gl;V.framebufferTexture2D(V.FRAMEBUFFER,V.COLOR_ATTACHMENT0,V.TEXTURE_2D,F,0),this.current=F,this.dirty=!1}},R}(tr),He=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.set=function(F){if(F!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var V=this.gl;V.framebufferRenderbuffer(V.FRAMEBUFFER,V.DEPTH_ATTACHMENT,V.RENDERBUFFER,F),this.current=F,this.dirty=!1}},R}(tr),Be=function(E,R,F,V){this.context=E,this.width=R,this.height=F;var ne=E.gl,le=this.framebuffer=ne.createFramebuffer();this.colorAttachment=new Ue(E,le),V&&(this.depthAttachment=new He(E,le))};Be.prototype.destroy=function(){var E=this.context.gl,R=this.colorAttachment.get();if(R&&E.deleteTexture(R),this.depthAttachment){var F=this.depthAttachment.get();F&&E.deleteRenderbuffer(F)}E.deleteFramebuffer(this.framebuffer)};var Ke=function(E,R,F){this.func=E,this.mask=R,this.range=F};Ke.ReadOnly=!1,Ke.ReadWrite=!0,Ke.disabled=new Ke(519,Ke.ReadOnly,[0,1]);var _e=function(E,R,F,V,ne,le){this.test=E,this.ref=R,this.mask=F,this.fail=V,this.depthFail=ne,this.pass=le};_e.disabled=new _e({func:519,mask:0},0,0,7680,7680,7680);var Ce=function(E,R,F){this.blendFunction=E,this.blendColor=R,this.mask=F};Ce.disabled=new Ce(Ce.Replace=[1,0],e.Color.transparent,[!1,!1,!1,!1]),Ce.unblended=new Ce(Ce.Replace,e.Color.transparent,[!0,!0,!0,!0]),Ce.alphaBlended=new Ce([1,771],e.Color.transparent,[!0,!0,!0,!0]);var Le=function(E,R,F){this.enable=E,this.mode=R,this.frontFace=F};Le.disabled=new Le(!1,1029,2305),Le.backCCW=new Le(!0,1029,2305);var Pe=function(E){this.gl=E,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new he(this),this.clearDepth=new se(this),this.clearStencil=new de(this),this.colorMask=new ue(this),this.depthMask=new ve(this),this.stencilMask=new ke(this),this.stencilFunc=new Ee(this),this.stencilOp=new be(this),this.stencilTest=new xe(this),this.depthRange=new ce(this),this.depthTest=new ge(this),this.depthFunc=new we(this),this.blend=new Me(this),this.blendFunc=new Se(this),this.blendColor=new ze(this),this.blendEquation=new Fe(this),this.cullFace=new Ye(this),this.cullFaceSide=new rt(this),this.frontFace=new Oe(this),this.program=new je(this),this.activeTexture=new We(this),this.viewport=new qe(this),this.bindFramebuffer=new Qe(this),this.bindRenderbuffer=new st(this),this.bindTexture=new ct(this),this.bindVertexBuffer=new Pt(this),this.bindElementBuffer=new kt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new at(this),this.pixelStoreUnpack=new tt(this),this.pixelStoreUnpackPremultiplyAlpha=new _t(this),this.pixelStoreUnpackFlipY=new er(this),this.extTextureFilterAnisotropic=E.getExtension("EXT_texture_filter_anisotropic")||E.getExtension("MOZ_EXT_texture_filter_anisotropic")||E.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=E.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=E.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(E.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=E.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=E.getExtension("EXT_disjoint_timer_query")};Pe.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Pe.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Pe.prototype.createIndexBuffer=function(E,R){return new Q(this,E,R)},Pe.prototype.createVertexBuffer=function(E,R,F){return new ie(this,E,R,F)},Pe.prototype.createRenderbuffer=function(E,R,F){var V=this.gl,ne=V.createRenderbuffer();return this.bindRenderbuffer.set(ne),V.renderbufferStorage(V.RENDERBUFFER,E,R,F),this.bindRenderbuffer.set(null),ne},Pe.prototype.createFramebuffer=function(E,R,F){return new Be(this,E,R,F)},Pe.prototype.clear=function(E){var R=E.color,F=E.depth,V=this.gl,ne=0;R&&(ne|=V.COLOR_BUFFER_BIT,this.clearColor.set(R),this.colorMask.set([!0,!0,!0,!0])),F!==void 0&&(ne|=V.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(F),this.depthMask.set(!0)),V.clear(ne)},Pe.prototype.setCullFace=function(E){E.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(E.mode),this.frontFace.set(E.frontFace))},Pe.prototype.setDepthMode=function(E){E.func!==this.gl.ALWAYS||E.mask?(this.depthTest.set(!0),this.depthFunc.set(E.func),this.depthMask.set(E.mask),this.depthRange.set(E.range)):this.depthTest.set(!1)},Pe.prototype.setStencilMode=function(E){E.test.func!==this.gl.ALWAYS||E.mask?(this.stencilTest.set(!0),this.stencilMask.set(E.mask),this.stencilOp.set([E.fail,E.depthFail,E.pass]),this.stencilFunc.set({func:E.test.func,ref:E.ref,mask:E.test.mask})):this.stencilTest.set(!1)},Pe.prototype.setColorMode=function(E){e.deepEqual(E.blendFunction,Ce.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(E.blendFunction),this.blendColor.set(E.blendColor)),this.colorMask.set(E.mask)},Pe.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Xe=function(E){function R(F,V,ne){var le=this;E.call(this),this.id=F,this.dispatcher=ne,this.on("data",function(pe){pe.dataType==="source"&&pe.sourceDataType==="metadata"&&(le._sourceLoaded=!0),le._sourceLoaded&&!le._paused&&pe.dataType==="source"&&pe.sourceDataType==="content"&&(le.reload(),le.transform&&le.update(le.transform))}),this.on("error",function(){le._sourceErrored=!0}),this._source=function(pe,ye,Te,Ne){var Ge=new z[ye.type](pe,ye,Te,Ne);if(Ge.id!==pe)throw new Error("Expected Source id to be "+pe+" instead of "+Ge.id);return e.bindAll(["load","abort","unload","serialize","prepare"],Ge),Ge}(F,V,ne,this),this._tiles={},this._cache=new J(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.onAdd=function(F){this.map=F,this._maxTileCacheSize=F?F._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(F)},R.prototype.onRemove=function(F){this._source&&this._source.onRemove&&this._source.onRemove(F)},R.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var F in this._tiles){var V=this._tiles[F];if(V.state!=="loaded"&&V.state!=="errored")return!1}return!0},R.prototype.getSource=function(){return this._source},R.prototype.pause=function(){this._paused=!0},R.prototype.resume=function(){if(this._paused){var F=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,F&&this.reload(),this.transform&&this.update(this.transform)}},R.prototype._loadTile=function(F,V){return this._source.loadTile(F,V)},R.prototype._unloadTile=function(F){if(this._source.unloadTile)return this._source.unloadTile(F,function(){})},R.prototype._abortTile=function(F){if(this._source.abortTile)return this._source.abortTile(F,function(){})},R.prototype.serialize=function(){return this._source.serialize()},R.prototype.prepare=function(F){for(var V in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var ne=this._tiles[V];ne.upload(F),ne.prepare(this.map.style.imageManager)}},R.prototype.getIds=function(){return e.values(this._tiles).map(function(F){return F.tileID}).sort(ht).map(function(F){return F.key})},R.prototype.getRenderableIds=function(F){var V=this,ne=[];for(var le in this._tiles)this._isIdRenderable(le,F)&&ne.push(this._tiles[le]);return F?ne.sort(function(pe,ye){var Te=pe.tileID,Ne=ye.tileID,Ge=new e.Point(Te.canonical.x,Te.canonical.y)._rotate(V.transform.angle),nt=new e.Point(Ne.canonical.x,Ne.canonical.y)._rotate(V.transform.angle);return Te.overscaledZ-Ne.overscaledZ||nt.y-Ge.y||nt.x-Ge.x}).map(function(pe){return pe.tileID.key}):ne.map(function(pe){return pe.tileID}).sort(ht).map(function(pe){return pe.key})},R.prototype.hasRenderableParent=function(F){var V=this.findLoadedParent(F,0);return!!V&&this._isIdRenderable(V.tileID.key)},R.prototype._isIdRenderable=function(F,V){return this._tiles[F]&&this._tiles[F].hasData()&&!this._coveredTiles[F]&&(V||!this._tiles[F].holdingForFade())},R.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var F in this._cache.reset(),this._tiles)this._tiles[F].state!=="errored"&&this._reloadTile(F,"reloading")},R.prototype._reloadTile=function(F,V){var ne=this._tiles[F];ne&&(ne.state!=="loading"&&(ne.state=V),this._loadTile(ne,this._tileLoaded.bind(this,ne,F,V)))},R.prototype._tileLoaded=function(F,V,ne,le){if(le)return F.state="errored",void(le.status!==404?this._source.fire(new e.ErrorEvent(le,{tile:F})):this.update(this.transform));F.timeAdded=e.browser.now(),ne==="expired"&&(F.refreshedUponExpiration=!0),this._setTileReloadTimer(V,F),this.getSource().type==="raster-dem"&&F.dem&&this._backfillDEM(F),this._state.initializeTileState(F,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:F,coord:F.tileID}))},R.prototype._backfillDEM=function(F){for(var V=this.getRenderableIds(),ne=0;ne<V.length;ne++){var le=V[ne];if(F.neighboringTiles&&F.neighboringTiles[le]){var pe=this.getTileByID(le);ye(F,pe),ye(pe,F)}}function ye(Te,Ne){Te.needsHillshadePrepare=!0;var Ge=Ne.tileID.canonical.x-Te.tileID.canonical.x,nt=Ne.tileID.canonical.y-Te.tileID.canonical.y,bt=Math.pow(2,Te.tileID.canonical.z),Ct=Ne.tileID.key;Ge===0&&nt===0||Math.abs(nt)>1||(Math.abs(Ge)>1&&(Math.abs(Ge+bt)===1?Ge+=bt:Math.abs(Ge-bt)===1&&(Ge-=bt)),Ne.dem&&Te.dem&&(Te.dem.backfillBorder(Ne.dem,Ge,nt),Te.neighboringTiles&&Te.neighboringTiles[Ct]&&(Te.neighboringTiles[Ct].backfilled=!0)))}},R.prototype.getTile=function(F){return this.getTileByID(F.key)},R.prototype.getTileByID=function(F){return this._tiles[F]},R.prototype._retainLoadedChildren=function(F,V,ne,le){for(var pe in this._tiles){var ye=this._tiles[pe];if(!(le[pe]||!ye.hasData()||ye.tileID.overscaledZ<=V||ye.tileID.overscaledZ>ne)){for(var Te=ye.tileID;ye&&ye.tileID.overscaledZ>V+1;){var Ne=ye.tileID.scaledTo(ye.tileID.overscaledZ-1);(ye=this._tiles[Ne.key])&&ye.hasData()&&(Te=Ne)}for(var Ge=Te;Ge.overscaledZ>V;)if(F[(Ge=Ge.scaledTo(Ge.overscaledZ-1)).key]){le[Te.key]=Te;break}}}},R.prototype.findLoadedParent=function(F,V){if(F.key in this._loadedParentTiles){var ne=this._loadedParentTiles[F.key];return ne&&ne.tileID.overscaledZ>=V?ne:null}for(var le=F.overscaledZ-1;le>=V;le--){var pe=F.scaledTo(le),ye=this._getLoadedTile(pe);if(ye)return ye}},R.prototype._getLoadedTile=function(F){var V=this._tiles[F.key];return V&&V.hasData()?V:this._cache.getByKey(F.wrapped().key)},R.prototype.updateCacheSize=function(F){var V=(Math.ceil(F.width/this._source.tileSize)+1)*(Math.ceil(F.height/this._source.tileSize)+1),ne=Math.floor(5*V),le=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,ne):ne;this._cache.setMaxSize(le)},R.prototype.handleWrapJump=function(F){var V=(F-(this._prevLng===void 0?F:this._prevLng))/360,ne=Math.round(V);if(this._prevLng=F,ne){var le={};for(var pe in this._tiles){var ye=this._tiles[pe];ye.tileID=ye.tileID.unwrapTo(ye.tileID.wrap+ne),le[ye.tileID.key]=ye}for(var Te in this._tiles=le,this._timers)clearTimeout(this._timers[Te]),delete this._timers[Te];for(var Ne in this._tiles){var Ge=this._tiles[Ne];this._setTileReloadTimer(Ne,Ge)}}},R.prototype.update=function(F){var V=this;if(this.transform=F,this._sourceLoaded&&!this._paused){var ne;this.updateCacheSize(F),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?ne=F.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(kr){return new e.OverscaledTileID(kr.canonical.z,kr.wrap,kr.canonical.z,kr.canonical.x,kr.canonical.y)}):(ne=F.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(ne=ne.filter(function(kr){return V._source.hasTile(kr)}))):ne=[];var le=F.coveringZoomLevel(this._source),pe=Math.max(le-R.maxOverzooming,this._source.minzoom),ye=Math.max(le+R.maxUnderzooming,this._source.minzoom),Te=this._updateRetainedTiles(ne,le);if(Mt(this._source.type)){for(var Ne={},Ge={},nt=0,bt=Object.keys(Te);nt<bt.length;nt+=1){var Ct=bt[nt],Tt=Te[Ct],At=this._tiles[Ct];if(At&&!(At.fadeEndTime&&At.fadeEndTime<=e.browser.now())){var yt=this.findLoadedParent(Tt,pe);yt&&(this._addTile(yt.tileID),Ne[yt.tileID.key]=yt.tileID),Ge[Ct]=Tt}}for(var Ft in this._retainLoadedChildren(Ge,le,ye,Te),Ne)Te[Ft]||(this._coveredTiles[Ft]=!0,Te[Ft]=Ne[Ft])}for(var zt in Te)this._tiles[zt].clearFadeHold();for(var jt=0,rr=e.keysDifference(this._tiles,Te);jt<rr.length;jt+=1){var hr=rr[jt],Ar=this._tiles[hr];Ar.hasSymbolBuckets&&!Ar.holdingForFade()?Ar.setHoldDuration(this.map._fadeDuration):Ar.hasSymbolBuckets&&!Ar.symbolFadeFinished()||this._removeTile(hr)}this._updateLoadedParentTileCache()}},R.prototype.releaseSymbolFadeTiles=function(){for(var F in this._tiles)this._tiles[F].holdingForFade()&&this._removeTile(F)},R.prototype._updateRetainedTiles=function(F,V){for(var ne={},le={},pe=Math.max(V-R.maxOverzooming,this._source.minzoom),ye=Math.max(V+R.maxUnderzooming,this._source.minzoom),Te={},Ne=0,Ge=F;Ne<Ge.length;Ne+=1){var nt=Ge[Ne],bt=this._addTile(nt);ne[nt.key]=nt,bt.hasData()||V<this._source.maxzoom&&(Te[nt.key]=nt)}this._retainLoadedChildren(Te,V,ye,ne);for(var Ct=0,Tt=F;Ct<Tt.length;Ct+=1){var At=Tt[Ct],yt=this._tiles[At.key];if(!yt.hasData()){if(V+1>this._source.maxzoom){var Ft=At.children(this._source.maxzoom)[0],zt=this.getTile(Ft);if(zt&&zt.hasData()){ne[Ft.key]=Ft;continue}}else{var jt=At.children(this._source.maxzoom);if(ne[jt[0].key]&&ne[jt[1].key]&&ne[jt[2].key]&&ne[jt[3].key])continue}for(var rr=yt.wasRequested(),hr=At.overscaledZ-1;hr>=pe;--hr){var Ar=At.scaledTo(hr);if(le[Ar.key]||(le[Ar.key]=!0,!(yt=this.getTile(Ar))&&rr&&(yt=this._addTile(Ar)),yt&&(ne[Ar.key]=Ar,rr=yt.wasRequested(),yt.hasData())))break}}}return ne},R.prototype._updateLoadedParentTileCache=function(){for(var F in this._loadedParentTiles={},this._tiles){for(var V=[],ne=void 0,le=this._tiles[F].tileID;le.overscaledZ>0;){if(le.key in this._loadedParentTiles){ne=this._loadedParentTiles[le.key];break}V.push(le.key);var pe=le.scaledTo(le.overscaledZ-1);if(ne=this._getLoadedTile(pe))break;le=pe}for(var ye=0,Te=V;ye<Te.length;ye+=1){var Ne=Te[ye];this._loadedParentTiles[Ne]=ne}}},R.prototype._addTile=function(F){var V=this._tiles[F.key];if(V)return V;(V=this._cache.getAndRemove(F))&&(this._setTileReloadTimer(F.key,V),V.tileID=F,this._state.initializeTileState(V,this.map?this.map.painter:null),this._cacheTimers[F.key]&&(clearTimeout(this._cacheTimers[F.key]),delete this._cacheTimers[F.key],this._setTileReloadTimer(F.key,V)));var ne=Boolean(V);return ne||(V=new e.Tile(F,this._source.tileSize*F.overscaleFactor()),this._loadTile(V,this._tileLoaded.bind(this,V,F.key,V.state))),V?(V.uses++,this._tiles[F.key]=V,ne||this._source.fire(new e.Event("dataloading",{tile:V,coord:V.tileID,dataType:"source"})),V):null},R.prototype._setTileReloadTimer=function(F,V){var ne=this;F in this._timers&&(clearTimeout(this._timers[F]),delete this._timers[F]);var le=V.getExpiryTimeout();le&&(this._timers[F]=setTimeout(function(){ne._reloadTile(F,"expired"),delete ne._timers[F]},le))},R.prototype._removeTile=function(F){var V=this._tiles[F];V&&(V.uses--,delete this._tiles[F],this._timers[F]&&(clearTimeout(this._timers[F]),delete this._timers[F]),V.uses>0||(V.hasData()&&V.state!=="reloading"?this._cache.add(V.tileID,V,V.getExpiryTimeout()):(V.aborted=!0,this._abortTile(V),this._unloadTile(V))))},R.prototype.clearTiles=function(){for(var F in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(F);this._cache.reset()},R.prototype.tilesIn=function(F,V,ne){var le=this,pe=[],ye=this.transform;if(!ye)return pe;for(var Te=ne?ye.getCameraQueryGeometry(F):F,Ne=F.map(function(hr){return ye.pointCoordinate(hr)}),Ge=Te.map(function(hr){return ye.pointCoordinate(hr)}),nt=this.getIds(),bt=1/0,Ct=1/0,Tt=-1/0,At=-1/0,yt=0,Ft=Ge;yt<Ft.length;yt+=1){var zt=Ft[yt];bt=Math.min(bt,zt.x),Ct=Math.min(Ct,zt.y),Tt=Math.max(Tt,zt.x),At=Math.max(At,zt.y)}for(var jt=function(hr){var Ar=le._tiles[nt[hr]];if(!Ar.holdingForFade()){var kr=Ar.tileID,Kr=Math.pow(2,ye.zoom-Ar.tileID.overscaledZ),Zr=V*Ar.queryPadding*e.EXTENT/Ar.tileSize/Kr,hn=[kr.getTilePoint(new e.MercatorCoordinate(bt,Ct)),kr.getTilePoint(new e.MercatorCoordinate(Tt,At))];if(hn[0].x-Zr<e.EXTENT&&hn[0].y-Zr<e.EXTENT&&hn[1].x+Zr>=0&&hn[1].y+Zr>=0){var sn=Ne.map(function(Wn){return kr.getTilePoint(Wn)}),Un=Ge.map(function(Wn){return kr.getTilePoint(Wn)});pe.push({tile:Ar,tileID:kr,queryGeometry:sn,cameraQueryGeometry:Un,scale:Kr})}}},rr=0;rr<nt.length;rr++)jt(rr);return pe},R.prototype.getVisibleCoordinates=function(F){for(var V=this,ne=this.getRenderableIds(F).map(function(Te){return V._tiles[Te].tileID}),le=0,pe=ne;le<pe.length;le+=1){var ye=pe[le];ye.posMatrix=this.transform.calculatePosMatrix(ye.toUnwrapped())}return ne},R.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Mt(this._source.type))for(var F in this._tiles){var V=this._tiles[F];if(V.fadeEndTime!==void 0&&V.fadeEndTime>=e.browser.now())return!0}return!1},R.prototype.setFeatureState=function(F,V,ne){F=F||"_geojsonTileLayer",this._state.updateState(F,V,ne)},R.prototype.removeFeatureState=function(F,V,ne){F=F||"_geojsonTileLayer",this._state.removeFeatureState(F,V,ne)},R.prototype.getFeatureState=function(F,V){return F=F||"_geojsonTileLayer",this._state.getState(F,V)},R.prototype.setDependencies=function(F,V,ne){var le=this._tiles[F];le&&le.setDependencies(V,ne)},R.prototype.reloadTilesForDependencies=function(F,V){for(var ne in this._tiles)this._tiles[ne].hasDependency(F,V)&&this._reloadTile(ne,"reloading");this._cache.filter(function(le){return!le.hasDependency(F,V)})},R}(e.Evented);function ht(E,R){var F=Math.abs(2*E.wrap)-+(E.wrap<0),V=Math.abs(2*R.wrap)-+(R.wrap<0);return E.overscaledZ-R.overscaledZ||V-F||R.canonical.y-E.canonical.y||R.canonical.x-E.canonical.x}function Mt(E){return E==="raster"||E==="image"||E==="video"}function pt(){return new e.window.Worker(oe.workerUrl)}Xe.maxOverzooming=10,Xe.maxUnderzooming=3;var Lt="mapboxgl_preloaded_worker_pool",vt=function(){this.active={}};vt.prototype.acquire=function(E){if(!this.workers)for(this.workers=[];this.workers.length<vt.workerCount;)this.workers.push(new pt);return this.active[E]=!0,this.workers.slice()},vt.prototype.release=function(E){delete this.active[E],this.numActive()===0&&(this.workers.forEach(function(R){R.terminate()}),this.workers=null)},vt.prototype.isPreloaded=function(){return!!this.active[Lt]},vt.prototype.numActive=function(){return Object.keys(this.active).length};var Dt,xt=Math.floor(e.browser.hardwareConcurrency/2);function it(){return Dt||(Dt=new vt),Dt}function St(E,R){var F={};for(var V in E)V!=="ref"&&(F[V]=E[V]);return e.refProperties.forEach(function(ne){ne in R&&(F[ne]=R[ne])}),F}function Nt(E){E=E.slice();for(var R=Object.create(null),F=0;F<E.length;F++)R[E[F].id]=E[F];for(var V=0;V<E.length;V++)"ref"in E[V]&&(E[V]=St(E[V],R[E[V].ref]));return E}vt.workerCount=Math.max(Math.min(xt,6),1);var Ut={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Qt(E,R,F){F.push({command:Ut.addSource,args:[E,R[E]]})}function Ie(E,R,F){R.push({command:Ut.removeSource,args:[E]}),F[E]=!0}function lt(E,R,F,V){Ie(E,F,V),Qt(E,R,F)}function wt(E,R,F){var V;for(V in E[F])if(E[F].hasOwnProperty(V)&&V!=="data"&&!e.deepEqual(E[F][V],R[F][V]))return!1;for(V in R[F])if(R[F].hasOwnProperty(V)&&V!=="data"&&!e.deepEqual(E[F][V],R[F][V]))return!1;return!0}function Ot(E,R,F,V,ne,le){var pe;for(pe in R=R||{},E=E||{})E.hasOwnProperty(pe)&&(e.deepEqual(E[pe],R[pe])||F.push({command:le,args:[V,pe,R[pe],ne]}));for(pe in R)R.hasOwnProperty(pe)&&!E.hasOwnProperty(pe)&&(e.deepEqual(E[pe],R[pe])||F.push({command:le,args:[V,pe,R[pe],ne]}))}function Gt(E){return E.id}function ir(E,R){return E[R.id]=R,E}function Xt(E,R){if(!E)return[{command:Ut.setStyle,args:[R]}];var F=[];try{if(!e.deepEqual(E.version,R.version))return[{command:Ut.setStyle,args:[R]}];e.deepEqual(E.center,R.center)||F.push({command:Ut.setCenter,args:[R.center]}),e.deepEqual(E.zoom,R.zoom)||F.push({command:Ut.setZoom,args:[R.zoom]}),e.deepEqual(E.bearing,R.bearing)||F.push({command:Ut.setBearing,args:[R.bearing]}),e.deepEqual(E.pitch,R.pitch)||F.push({command:Ut.setPitch,args:[R.pitch]}),e.deepEqual(E.sprite,R.sprite)||F.push({command:Ut.setSprite,args:[R.sprite]}),e.deepEqual(E.glyphs,R.glyphs)||F.push({command:Ut.setGlyphs,args:[R.glyphs]}),e.deepEqual(E.transition,R.transition)||F.push({command:Ut.setTransition,args:[R.transition]}),e.deepEqual(E.light,R.light)||F.push({command:Ut.setLight,args:[R.light]});var V={},ne=[];(function(pe,ye,Te,Ne){var Ge;for(Ge in ye=ye||{},pe=pe||{})pe.hasOwnProperty(Ge)&&(ye.hasOwnProperty(Ge)||Ie(Ge,Te,Ne));for(Ge in ye)ye.hasOwnProperty(Ge)&&(pe.hasOwnProperty(Ge)?e.deepEqual(pe[Ge],ye[Ge])||(pe[Ge].type==="geojson"&&ye[Ge].type==="geojson"&&wt(pe,ye,Ge)?Te.push({command:Ut.setGeoJSONSourceData,args:[Ge,ye[Ge].data]}):lt(Ge,ye,Te,Ne)):Qt(Ge,ye,Te))})(E.sources,R.sources,ne,V);var le=[];E.layers&&E.layers.forEach(function(pe){V[pe.source]?F.push({command:Ut.removeLayer,args:[pe.id]}):le.push(pe)}),F=F.concat(ne),function(pe,ye,Te){ye=ye||[];var Ne,Ge,nt,bt,Ct,Tt,At,yt=(pe=pe||[]).map(Gt),Ft=ye.map(Gt),zt=pe.reduce(ir,{}),jt=ye.reduce(ir,{}),rr=yt.slice(),hr=Object.create(null);for(Ne=0,Ge=0;Ne<yt.length;Ne++)nt=yt[Ne],jt.hasOwnProperty(nt)?Ge++:(Te.push({command:Ut.removeLayer,args:[nt]}),rr.splice(rr.indexOf(nt,Ge),1));for(Ne=0,Ge=0;Ne<Ft.length;Ne++)nt=Ft[Ft.length-1-Ne],rr[rr.length-1-Ne]!==nt&&(zt.hasOwnProperty(nt)?(Te.push({command:Ut.removeLayer,args:[nt]}),rr.splice(rr.lastIndexOf(nt,rr.length-Ge),1)):Ge++,Tt=rr[rr.length-Ne],Te.push({command:Ut.addLayer,args:[jt[nt],Tt]}),rr.splice(rr.length-Ne,0,nt),hr[nt]=!0);for(Ne=0;Ne<Ft.length;Ne++)if(bt=zt[nt=Ft[Ne]],Ct=jt[nt],!hr[nt]&&!e.deepEqual(bt,Ct))if(e.deepEqual(bt.source,Ct.source)&&e.deepEqual(bt["source-layer"],Ct["source-layer"])&&e.deepEqual(bt.type,Ct.type)){for(At in Ot(bt.layout,Ct.layout,Te,nt,null,Ut.setLayoutProperty),Ot(bt.paint,Ct.paint,Te,nt,null,Ut.setPaintProperty),e.deepEqual(bt.filter,Ct.filter)||Te.push({command:Ut.setFilter,args:[nt,Ct.filter]}),e.deepEqual(bt.minzoom,Ct.minzoom)&&e.deepEqual(bt.maxzoom,Ct.maxzoom)||Te.push({command:Ut.setLayerZoomRange,args:[nt,Ct.minzoom,Ct.maxzoom]}),bt)bt.hasOwnProperty(At)&&At!=="layout"&&At!=="paint"&&At!=="filter"&&At!=="metadata"&&At!=="minzoom"&&At!=="maxzoom"&&(At.indexOf("paint.")===0?Ot(bt[At],Ct[At],Te,nt,At.slice(6),Ut.setPaintProperty):e.deepEqual(bt[At],Ct[At])||Te.push({command:Ut.setLayerProperty,args:[nt,At,Ct[At]]}));for(At in Ct)Ct.hasOwnProperty(At)&&!bt.hasOwnProperty(At)&&At!=="layout"&&At!=="paint"&&At!=="filter"&&At!=="metadata"&&At!=="minzoom"&&At!=="maxzoom"&&(At.indexOf("paint.")===0?Ot(bt[At],Ct[At],Te,nt,At.slice(6),Ut.setPaintProperty):e.deepEqual(bt[At],Ct[At])||Te.push({command:Ut.setLayerProperty,args:[nt,At,Ct[At]]}))}else Te.push({command:Ut.removeLayer,args:[nt]}),Tt=rr[rr.lastIndexOf(nt)+1],Te.push({command:Ut.addLayer,args:[Ct,Tt]})}(le,R.layers,F)}catch(pe){console.warn("Unable to compute style diff:",pe),F=[{command:Ut.setStyle,args:[R]}]}return F}var Kt=function(E,R){this.reset(E,R)};Kt.prototype.reset=function(E,R){this.points=E||[],this._distances=[0];for(var F=1;F<this.points.length;F++)this._distances[F]=this._distances[F-1]+this.points[F].dist(this.points[F-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(R||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Kt.prototype.lerp=function(E){if(this.points.length===1)return this.points[0];E=e.clamp(E,0,1);for(var R=1,F=this._distances[R],V=E*this.paddedLength+this.padding;F<V&&R<this._distances.length;)F=this._distances[++R];var ne=R-1,le=this._distances[ne],pe=F-le,ye=pe>0?(V-le)/pe:0;return this.points[ne].mult(1-ye).add(this.points[R].mult(ye))};var or=function(E,R,F){var V=this.boxCells=[],ne=this.circleCells=[];this.xCellCount=Math.ceil(E/F),this.yCellCount=Math.ceil(R/F);for(var le=0;le<this.xCellCount*this.yCellCount;le++)V.push([]),ne.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=E,this.height=R,this.xScale=this.xCellCount/E,this.yScale=this.yCellCount/R,this.boxUid=0,this.circleUid=0};function dr(E,R,F,V,ne){var le=e.create();return R?(e.scale(le,le,[1/ne,1/ne,1]),F||e.rotateZ(le,le,V.angle)):e.multiply(le,V.labelPlaneMatrix,E),le}function vr(E,R,F,V,ne){if(R){var le=e.clone(E);return e.scale(le,le,[ne,ne,1]),F||e.rotateZ(le,le,-V.angle),le}return V.glCoordMatrix}function ur(E,R){var F=[E.x,E.y,0,1];an(F,F,R);var V=F[3];return{point:new e.Point(F[0]/V,F[1]/V),signedDistanceFromCamera:V}}function pr(E,R){return .5+E/R*.5}function br(E,R){var F=E[0]/E[3],V=E[1]/E[3];return F>=-R[0]&&F<=R[0]&&V>=-R[1]&&V<=R[1]}function Rr(E,R,F,V,ne,le,pe,ye){var Te=V?E.textSizeData:E.iconSizeData,Ne=e.evaluateSizeForZoom(Te,F.transform.zoom),Ge=[256/F.width*2+1,256/F.height*2+1],nt=V?E.text.dynamicLayoutVertexArray:E.icon.dynamicLayoutVertexArray;nt.clear();for(var bt=E.lineVertexArray,Ct=V?E.text.placedSymbolArray:E.icon.placedSymbolArray,Tt=F.transform.width/F.transform.height,At=!1,yt=0;yt<Ct.length;yt++){var Ft=Ct.get(yt);if(Ft.hidden||Ft.writingMode===e.WritingMode.vertical&&!At)Sn(Ft.numGlyphs,nt);else{At=!1;var zt=[Ft.anchorX,Ft.anchorY,0,1];if(e.transformMat4(zt,zt,R),br(zt,Ge)){var jt=zt[3],rr=pr(F.transform.cameraToCenterDistance,jt),hr=e.evaluateSizeForFeature(Te,Ne,Ft),Ar=pe?hr/rr:hr*rr,kr=new e.Point(Ft.anchorX,Ft.anchorY),Kr=ur(kr,ne).point,Zr={},hn=$r(Ft,Ar,!1,ye,R,ne,le,E.glyphOffsetArray,bt,nt,Kr,kr,Zr,Tt);At=hn.useVertical,(hn.notEnoughRoom||At||hn.needsFlipping&&$r(Ft,Ar,!0,ye,R,ne,le,E.glyphOffsetArray,bt,nt,Kr,kr,Zr,Tt).notEnoughRoom)&&Sn(Ft.numGlyphs,nt)}else Sn(Ft.numGlyphs,nt)}}V?E.text.dynamicLayoutVertexBuffer.updateData(nt):E.icon.dynamicLayoutVertexBuffer.updateData(nt)}function _r(E,R,F,V,ne,le,pe,ye,Te,Ne,Ge){var nt=ye.glyphStartIndex+ye.numGlyphs,bt=ye.lineStartIndex,Ct=ye.lineStartIndex+ye.lineLength,Tt=R.getoffsetX(ye.glyphStartIndex),At=R.getoffsetX(nt-1),yt=In(E*Tt,F,V,ne,le,pe,ye.segment,bt,Ct,Te,Ne,Ge);if(!yt)return null;var Ft=In(E*At,F,V,ne,le,pe,ye.segment,bt,Ct,Te,Ne,Ge);return Ft?{first:yt,last:Ft}:null}function jr(E,R,F,V){return E===e.WritingMode.horizontal&&Math.abs(F.y-R.y)>Math.abs(F.x-R.x)*V?{useVertical:!0}:(E===e.WritingMode.vertical?R.y<F.y:R.x>F.x)?{needsFlipping:!0}:null}function $r(E,R,F,V,ne,le,pe,ye,Te,Ne,Ge,nt,bt,Ct){var Tt,At=R/24,yt=E.lineOffsetX*At,Ft=E.lineOffsetY*At;if(E.numGlyphs>1){var zt=E.glyphStartIndex+E.numGlyphs,jt=E.lineStartIndex,rr=E.lineStartIndex+E.lineLength,hr=_r(At,ye,yt,Ft,F,Ge,nt,E,Te,le,bt);if(!hr)return{notEnoughRoom:!0};var Ar=ur(hr.first.point,pe).point,kr=ur(hr.last.point,pe).point;if(V&&!F){var Kr=jr(E.writingMode,Ar,kr,Ct);if(Kr)return Kr}Tt=[hr.first];for(var Zr=E.glyphStartIndex+1;Zr<zt-1;Zr++)Tt.push(In(At*ye.getoffsetX(Zr),yt,Ft,F,Ge,nt,E.segment,jt,rr,Te,le,bt));Tt.push(hr.last)}else{if(V&&!F){var hn=ur(nt,ne).point,sn=E.lineStartIndex+E.segment+1,Un=new e.Point(Te.getx(sn),Te.gety(sn)),Wn=ur(Un,ne),ua=Wn.signedDistanceFromCamera>0?Wn.point:pn(nt,Un,hn,1,ne),Ur=jr(E.writingMode,hn,ua,Ct);if(Ur)return Ur}var kn=In(At*ye.getoffsetX(E.glyphStartIndex),yt,Ft,F,Ge,nt,E.segment,E.lineStartIndex,E.lineStartIndex+E.lineLength,Te,le,bt);if(!kn)return{notEnoughRoom:!0};Tt=[kn]}for(var Xn=0,Gn=Tt;Xn<Gn.length;Xn+=1){var ea=Gn[Xn];e.addDynamicAttributes(Ne,ea.point,ea.angle)}return{}}function pn(E,R,F,V,ne){var le=ur(E.add(E.sub(R)._unit()),ne).point,pe=F.sub(le);return F.add(pe._mult(V/pe.mag()))}function In(E,R,F,V,ne,le,pe,ye,Te,Ne,Ge,nt){var bt=V?E-R:E+R,Ct=bt>0?1:-1,Tt=0;V&&(Ct*=-1,Tt=Math.PI),Ct<0&&(Tt+=Math.PI);for(var At=Ct>0?ye+pe:ye+pe+1,yt=ne,Ft=ne,zt=0,jt=0,rr=Math.abs(bt),hr=[];zt+jt<=rr;){if((At+=Ct)<ye||At>=Te)return null;if(Ft=yt,hr.push(yt),(yt=nt[At])===void 0){var Ar=new e.Point(Ne.getx(At),Ne.gety(At)),kr=ur(Ar,Ge);if(kr.signedDistanceFromCamera>0)yt=nt[At]=kr.point;else{var Kr=At-Ct;yt=pn(zt===0?le:new e.Point(Ne.getx(Kr),Ne.gety(Kr)),Ar,Ft,rr-zt+1,Ge)}}zt+=jt,jt=Ft.dist(yt)}var Zr=(rr-zt)/jt,hn=yt.sub(Ft),sn=hn.mult(Zr)._add(Ft);sn._add(hn._unit()._perp()._mult(F*Ct));var Un=Tt+Math.atan2(yt.y-Ft.y,yt.x-Ft.x);return hr.push(sn),{point:sn,angle:Un,path:hr}}or.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},or.prototype.insert=function(E,R,F,V,ne){this._forEachCell(R,F,V,ne,this._insertBoxCell,this.boxUid++),this.boxKeys.push(E),this.bboxes.push(R),this.bboxes.push(F),this.bboxes.push(V),this.bboxes.push(ne)},or.prototype.insertCircle=function(E,R,F,V){this._forEachCell(R-V,F-V,R+V,F+V,this._insertCircleCell,this.circleUid++),this.circleKeys.push(E),this.circles.push(R),this.circles.push(F),this.circles.push(V)},or.prototype._insertBoxCell=function(E,R,F,V,ne,le){this.boxCells[ne].push(le)},or.prototype._insertCircleCell=function(E,R,F,V,ne,le){this.circleCells[ne].push(le)},or.prototype._query=function(E,R,F,V,ne,le){if(F<0||E>this.width||V<0||R>this.height)return!ne&&[];var pe=[];if(E<=0&&R<=0&&this.width<=F&&this.height<=V){if(ne)return!0;for(var ye=0;ye<this.boxKeys.length;ye++)pe.push({key:this.boxKeys[ye],x1:this.bboxes[4*ye],y1:this.bboxes[4*ye+1],x2:this.bboxes[4*ye+2],y2:this.bboxes[4*ye+3]});for(var Te=0;Te<this.circleKeys.length;Te++){var Ne=this.circles[3*Te],Ge=this.circles[3*Te+1],nt=this.circles[3*Te+2];pe.push({key:this.circleKeys[Te],x1:Ne-nt,y1:Ge-nt,x2:Ne+nt,y2:Ge+nt})}return le?pe.filter(le):pe}var bt={hitTest:ne,seenUids:{box:{},circle:{}}};return this._forEachCell(E,R,F,V,this._queryCell,pe,bt,le),ne?pe.length>0:pe},or.prototype._queryCircle=function(E,R,F,V,ne){var le=E-F,pe=E+F,ye=R-F,Te=R+F;if(pe<0||le>this.width||Te<0||ye>this.height)return!V&&[];var Ne=[],Ge={hitTest:V,circle:{x:E,y:R,radius:F},seenUids:{box:{},circle:{}}};return this._forEachCell(le,ye,pe,Te,this._queryCellCircle,Ne,Ge,ne),V?Ne.length>0:Ne},or.prototype.query=function(E,R,F,V,ne){return this._query(E,R,F,V,!1,ne)},or.prototype.hitTest=function(E,R,F,V,ne){return this._query(E,R,F,V,!0,ne)},or.prototype.hitTestCircle=function(E,R,F,V){return this._queryCircle(E,R,F,!0,V)},or.prototype._queryCell=function(E,R,F,V,ne,le,pe,ye){var Te=pe.seenUids,Ne=this.boxCells[ne];if(Ne!==null)for(var Ge=this.bboxes,nt=0,bt=Ne;nt<bt.length;nt+=1){var Ct=bt[nt];if(!Te.box[Ct]){Te.box[Ct]=!0;var Tt=4*Ct;if(E<=Ge[Tt+2]&&R<=Ge[Tt+3]&&F>=Ge[Tt+0]&&V>=Ge[Tt+1]&&(!ye||ye(this.boxKeys[Ct]))){if(pe.hitTest)return le.push(!0),!0;le.push({key:this.boxKeys[Ct],x1:Ge[Tt],y1:Ge[Tt+1],x2:Ge[Tt+2],y2:Ge[Tt+3]})}}}var At=this.circleCells[ne];if(At!==null)for(var yt=this.circles,Ft=0,zt=At;Ft<zt.length;Ft+=1){var jt=zt[Ft];if(!Te.circle[jt]){Te.circle[jt]=!0;var rr=3*jt;if(this._circleAndRectCollide(yt[rr],yt[rr+1],yt[rr+2],E,R,F,V)&&(!ye||ye(this.circleKeys[jt]))){if(pe.hitTest)return le.push(!0),!0;var hr=yt[rr],Ar=yt[rr+1],kr=yt[rr+2];le.push({key:this.circleKeys[jt],x1:hr-kr,y1:Ar-kr,x2:hr+kr,y2:Ar+kr})}}}},or.prototype._queryCellCircle=function(E,R,F,V,ne,le,pe,ye){var Te=pe.circle,Ne=pe.seenUids,Ge=this.boxCells[ne];if(Ge!==null)for(var nt=this.bboxes,bt=0,Ct=Ge;bt<Ct.length;bt+=1){var Tt=Ct[bt];if(!Ne.box[Tt]){Ne.box[Tt]=!0;var At=4*Tt;if(this._circleAndRectCollide(Te.x,Te.y,Te.radius,nt[At+0],nt[At+1],nt[At+2],nt[At+3])&&(!ye||ye(this.boxKeys[Tt])))return le.push(!0),!0}}var yt=this.circleCells[ne];if(yt!==null)for(var Ft=this.circles,zt=0,jt=yt;zt<jt.length;zt+=1){var rr=jt[zt];if(!Ne.circle[rr]){Ne.circle[rr]=!0;var hr=3*rr;if(this._circlesCollide(Ft[hr],Ft[hr+1],Ft[hr+2],Te.x,Te.y,Te.radius)&&(!ye||ye(this.circleKeys[rr])))return le.push(!0),!0}}},or.prototype._forEachCell=function(E,R,F,V,ne,le,pe,ye){for(var Te=this._convertToXCellCoord(E),Ne=this._convertToYCellCoord(R),Ge=this._convertToXCellCoord(F),nt=this._convertToYCellCoord(V),bt=Te;bt<=Ge;bt++)for(var Ct=Ne;Ct<=nt;Ct++){var Tt=this.xCellCount*Ct+bt;if(ne.call(this,E,R,F,V,Tt,le,pe,ye))return}},or.prototype._convertToXCellCoord=function(E){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(E*this.xScale)))},or.prototype._convertToYCellCoord=function(E){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(E*this.yScale)))},or.prototype._circlesCollide=function(E,R,F,V,ne,le){var pe=V-E,ye=ne-R,Te=F+le;return Te*Te>pe*pe+ye*ye},or.prototype._circleAndRectCollide=function(E,R,F,V,ne,le,pe){var ye=(le-V)/2,Te=Math.abs(E-(V+ye));if(Te>ye+F)return!1;var Ne=(pe-ne)/2,Ge=Math.abs(R-(ne+Ne));if(Ge>Ne+F)return!1;if(Te<=ye||Ge<=Ne)return!0;var nt=Te-ye,bt=Ge-Ne;return nt*nt+bt*bt<=F*F};var On=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Sn(E,R){for(var F=0;F<E;F++){var V=R.length;R.resize(V+4),R.float32.set(On,3*V)}}function an(E,R,F){var V=R[0],ne=R[1];return E[0]=F[0]*V+F[4]*ne+F[12],E[1]=F[1]*V+F[5]*ne+F[13],E[3]=F[3]*V+F[7]*ne+F[15],E}var Nr=function(E,R,F){R===void 0&&(R=new or(E.width+200,E.height+200,25)),F===void 0&&(F=new or(E.width+200,E.height+200,25)),this.transform=E,this.grid=R,this.ignoredGrid=F,this.pitchfactor=Math.cos(E._pitch)*E.cameraToCenterDistance,this.screenRightBoundary=E.width+100,this.screenBottomBoundary=E.height+100,this.gridRightBoundary=E.width+200,this.gridBottomBoundary=E.height+200};function Pr(E,R,F){return R*(e.EXTENT/(E.tileSize*Math.pow(2,F-E.tileID.overscaledZ)))}Nr.prototype.placeCollisionBox=function(E,R,F,V,ne){var le=this.projectAndGetPerspectiveRatio(V,E.anchorPointX,E.anchorPointY),pe=F*le.perspectiveRatio,ye=E.x1*pe+le.point.x,Te=E.y1*pe+le.point.y,Ne=E.x2*pe+le.point.x,Ge=E.y2*pe+le.point.y;return!this.isInsideGrid(ye,Te,Ne,Ge)||!R&&this.grid.hitTest(ye,Te,Ne,Ge,ne)?{box:[],offscreen:!1}:{box:[ye,Te,Ne,Ge],offscreen:this.isOffscreen(ye,Te,Ne,Ge)}},Nr.prototype.placeCollisionCircles=function(E,R,F,V,ne,le,pe,ye,Te,Ne,Ge,nt,bt){var Ct=[],Tt=new e.Point(R.anchorX,R.anchorY),At=ur(Tt,le),yt=pr(this.transform.cameraToCenterDistance,At.signedDistanceFromCamera),Ft=(Ne?ne/yt:ne*yt)/e.ONE_EM,zt=ur(Tt,pe).point,jt=_r(Ft,V,R.lineOffsetX*Ft,R.lineOffsetY*Ft,!1,zt,Tt,R,F,pe,{}),rr=!1,hr=!1,Ar=!0;if(jt){for(var kr=.5*nt*yt+bt,Kr=new e.Point(-100,-100),Zr=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),hn=new Kt,sn=jt.first,Un=jt.last,Wn=[],ua=sn.path.length-1;ua>=1;ua--)Wn.push(sn.path[ua]);for(var Ur=1;Ur<Un.path.length;Ur++)Wn.push(Un.path[Ur]);var kn=2.5*kr;if(ye){var Xn=Wn.map(function(Lo){return ur(Lo,ye)});Wn=Xn.some(function(Lo){return Lo.signedDistanceFromCamera<=0})?[]:Xn.map(function(Lo){return Lo.point})}var Gn=[];if(Wn.length>0){for(var ea=Wn[0].clone(),fa=Wn[0].clone(),Ma=1;Ma<Wn.length;Ma++)ea.x=Math.min(ea.x,Wn[Ma].x),ea.y=Math.min(ea.y,Wn[Ma].y),fa.x=Math.max(fa.x,Wn[Ma].x),fa.y=Math.max(fa.y,Wn[Ma].y);Gn=ea.x>=Kr.x&&fa.x<=Zr.x&&ea.y>=Kr.y&&fa.y<=Zr.y?[Wn]:fa.x<Kr.x||ea.x>Zr.x||fa.y<Kr.y||ea.y>Zr.y?[]:e.clipLine([Wn],Kr.x,Kr.y,Zr.x,Zr.y)}for(var Kn=0,xa=Gn;Kn<xa.length;Kn+=1){var ma=xa[Kn];hn.reset(ma,.25*kr);var La=0;La=hn.length<=.5*kr?1:Math.ceil(hn.paddedLength/kn)+1;for(var ba=0;ba<La;ba++){var Pa=ba/Math.max(La-1,1),Ua=hn.lerp(Pa),di=Ua.x+100,zi=Ua.y+100;Ct.push(di,zi,kr,0);var Ri=di-kr,pi=zi-kr,Ei=di+kr,xi=zi+kr;if(Ar=Ar&&this.isOffscreen(Ri,pi,Ei,xi),hr=hr||this.isInsideGrid(Ri,pi,Ei,xi),!E&&this.grid.hitTestCircle(di,zi,kr,Ge)&&(rr=!0,!Te))return{circles:[],offscreen:!1,collisionDetected:rr}}}}return{circles:!Te&&rr||!hr?[]:Ct,offscreen:Ar,collisionDetected:rr}},Nr.prototype.queryRenderedSymbols=function(E){if(E.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var R=[],F=1/0,V=1/0,ne=-1/0,le=-1/0,pe=0,ye=E;pe<ye.length;pe+=1){var Te=ye[pe],Ne=new e.Point(Te.x+100,Te.y+100);F=Math.min(F,Ne.x),V=Math.min(V,Ne.y),ne=Math.max(ne,Ne.x),le=Math.max(le,Ne.y),R.push(Ne)}for(var Ge={},nt={},bt=0,Ct=this.grid.query(F,V,ne,le).concat(this.ignoredGrid.query(F,V,ne,le));bt<Ct.length;bt+=1){var Tt=Ct[bt],At=Tt.key;if(Ge[At.bucketInstanceId]===void 0&&(Ge[At.bucketInstanceId]={}),!Ge[At.bucketInstanceId][At.featureIndex]){var yt=[new e.Point(Tt.x1,Tt.y1),new e.Point(Tt.x2,Tt.y1),new e.Point(Tt.x2,Tt.y2),new e.Point(Tt.x1,Tt.y2)];e.polygonIntersectsPolygon(R,yt)&&(Ge[At.bucketInstanceId][At.featureIndex]=!0,nt[At.bucketInstanceId]===void 0&&(nt[At.bucketInstanceId]=[]),nt[At.bucketInstanceId].push(At.featureIndex))}}return nt},Nr.prototype.insertCollisionBox=function(E,R,F,V,ne){var le={bucketInstanceId:F,featureIndex:V,collisionGroupID:ne};(R?this.ignoredGrid:this.grid).insert(le,E[0],E[1],E[2],E[3])},Nr.prototype.insertCollisionCircles=function(E,R,F,V,ne){for(var le=R?this.ignoredGrid:this.grid,pe={bucketInstanceId:F,featureIndex:V,collisionGroupID:ne},ye=0;ye<E.length;ye+=4)le.insertCircle(pe,E[ye],E[ye+1],E[ye+2])},Nr.prototype.projectAndGetPerspectiveRatio=function(E,R,F){var V=[R,F,0,1];return an(V,V,E),{point:new e.Point((V[0]/V[3]+1)/2*this.transform.width+100,(-V[1]/V[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/V[3]*.5}},Nr.prototype.isOffscreen=function(E,R,F,V){return F<100||E>=this.screenRightBoundary||V<100||R>this.screenBottomBoundary},Nr.prototype.isInsideGrid=function(E,R,F,V){return F>=0&&E<this.gridRightBoundary&&V>=0&&R<this.gridBottomBoundary},Nr.prototype.getViewportMatrix=function(){var E=e.identity([]);return e.translate(E,E,[-100,-100,0]),E};var en=function(E,R,F,V){this.opacity=E?Math.max(0,Math.min(1,E.opacity+(E.placed?R:-R))):V&&F?1:0,this.placed=F};en.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var tn=function(E,R,F,V,ne){this.text=new en(E?E.text:null,R,F,ne),this.icon=new en(E?E.icon:null,R,V,ne)};tn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Qr=function(E,R,F){this.text=E,this.icon=R,this.skipFade=F},rn=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},An=function(E,R,F,V,ne){this.bucketInstanceId=E,this.featureIndex=R,this.sourceLayerIndex=F,this.bucketIndex=V,this.tileID=ne},En=function(E){this.crossSourceCollisions=E,this.maxGroupID=0,this.collisionGroups={}};function Bn(E,R,F,V,ne){var le=e.getAnchorAlignment(E),pe=-(le.horizontalAlign-.5)*R,ye=-(le.verticalAlign-.5)*F,Te=e.evaluateVariableOffset(E,V);return new e.Point(pe+Te[0]*ne,ye+Te[1]*ne)}function Jt(E,R,F,V,ne,le){var pe=E.x1,ye=E.x2,Te=E.y1,Ne=E.y2,Ge=E.anchorPointX,nt=E.anchorPointY,bt=new e.Point(R,F);return V&&bt._rotate(ne?le:-le),{x1:pe+bt.x,y1:Te+bt.y,x2:ye+bt.x,y2:Ne+bt.y,anchorPointX:Ge,anchorPointY:nt}}En.prototype.get=function(E){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[E]){var R=++this.maxGroupID;this.collisionGroups[E]={ID:R,predicate:function(F){return F.collisionGroupID===R}}}return this.collisionGroups[E]};var It=function(E,R,F,V){this.transform=E.clone(),this.collisionIndex=new Nr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=R,this.retainedQueryData={},this.collisionGroups=new En(F),this.collisionCircleArrays={},this.prevPlacement=V,V&&(V.prevPlacement=void 0),this.placedOrientations={}};function qt(E,R,F,V,ne){E.emplaceBack(R?1:0,F?1:0,V||0,ne||0),E.emplaceBack(R?1:0,F?1:0,V||0,ne||0),E.emplaceBack(R?1:0,F?1:0,V||0,ne||0),E.emplaceBack(R?1:0,F?1:0,V||0,ne||0)}It.prototype.getBucketParts=function(E,R,F,V){var ne=F.getBucket(R),le=F.latestFeatureIndex;if(ne&&le&&R.id===ne.layerIds[0]){var pe=F.collisionBoxArray,ye=ne.layers[0].layout,Te=Math.pow(2,this.transform.zoom-F.tileID.overscaledZ),Ne=F.tileSize/e.EXTENT,Ge=this.transform.calculatePosMatrix(F.tileID.toUnwrapped()),nt=ye.get("text-pitch-alignment")==="map",bt=ye.get("text-rotation-alignment")==="map",Ct=Pr(F,1,this.transform.zoom),Tt=dr(Ge,nt,bt,this.transform,Ct),At=null;if(nt){var yt=vr(Ge,nt,bt,this.transform,Ct);At=e.multiply([],this.transform.labelPlaneMatrix,yt)}this.retainedQueryData[ne.bucketInstanceId]=new An(ne.bucketInstanceId,le,ne.sourceLayerIndex,ne.index,F.tileID);var Ft={bucket:ne,layout:ye,posMatrix:Ge,textLabelPlaneMatrix:Tt,labelToScreenMatrix:At,scale:Te,textPixelRatio:Ne,holdingForFade:F.holdingForFade(),collisionBoxArray:pe,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(ne.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(ne.sourceID)};if(V)for(var zt=0,jt=ne.sortKeyRanges;zt<jt.length;zt+=1){var rr=jt[zt],hr=rr.sortKey,Ar=rr.symbolInstanceStart,kr=rr.symbolInstanceEnd;E.push({sortKey:hr,symbolInstanceStart:Ar,symbolInstanceEnd:kr,parameters:Ft})}else E.push({symbolInstanceStart:0,symbolInstanceEnd:ne.symbolInstances.length,parameters:Ft})}},It.prototype.attemptAnchorPlacement=function(E,R,F,V,ne,le,pe,ye,Te,Ne,Ge,nt,bt,Ct,Tt){var At,yt=[nt.textOffset0,nt.textOffset1],Ft=Bn(E,F,V,yt,ne),zt=this.collisionIndex.placeCollisionBox(Jt(R,Ft.x,Ft.y,le,pe,this.transform.angle),Ge,ye,Te,Ne.predicate);if(!(Tt&&this.collisionIndex.placeCollisionBox(Jt(Tt,Ft.x,Ft.y,le,pe,this.transform.angle),Ge,ye,Te,Ne.predicate).box.length===0)&&zt.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[nt.crossTileID]&&this.prevPlacement.placements[nt.crossTileID]&&this.prevPlacement.placements[nt.crossTileID].text&&(At=this.prevPlacement.variableOffsets[nt.crossTileID].anchor),this.variableOffsets[nt.crossTileID]={textOffset:yt,width:F,height:V,anchor:E,textBoxScale:ne,prevAnchor:At},this.markUsedJustification(bt,E,nt,Ct),bt.allowVerticalPlacement&&(this.markUsedOrientation(bt,Ct,nt),this.placedOrientations[nt.crossTileID]=Ct),{shift:Ft,placedGlyphBoxes:zt}},It.prototype.placeLayerBucketPart=function(E,R,F){var V=this,ne=E.parameters,le=ne.bucket,pe=ne.layout,ye=ne.posMatrix,Te=ne.textLabelPlaneMatrix,Ne=ne.labelToScreenMatrix,Ge=ne.textPixelRatio,nt=ne.holdingForFade,bt=ne.collisionBoxArray,Ct=ne.partiallyEvaluatedTextSize,Tt=ne.collisionGroup,At=pe.get("text-optional"),yt=pe.get("icon-optional"),Ft=pe.get("text-allow-overlap"),zt=pe.get("icon-allow-overlap"),jt=pe.get("text-rotation-alignment")==="map",rr=pe.get("text-pitch-alignment")==="map",hr=pe.get("icon-text-fit")!=="none",Ar=pe.get("symbol-z-order")==="viewport-y",kr=Ft&&(zt||!le.hasIconData()||yt),Kr=zt&&(Ft||!le.hasTextData()||At);!le.collisionArrays&&bt&&le.deserializeCollisionBoxes(bt);var Zr=function(Ur,kn){if(!R[Ur.crossTileID])if(nt)V.placements[Ur.crossTileID]=new Qr(!1,!1,!1);else{var Xn,Gn=!1,ea=!1,fa=!0,Ma=null,Kn={box:null,offscreen:null},xa={box:null,offscreen:null},ma=null,La=null,ba=0,Pa=0,Ua=0;kn.textFeatureIndex?ba=kn.textFeatureIndex:Ur.useRuntimeCollisionCircles&&(ba=Ur.featureIndex),kn.verticalTextFeatureIndex&&(Pa=kn.verticalTextFeatureIndex);var di=kn.textBox;if(di){var zi=function(Ci){var qo=e.WritingMode.horizontal;if(le.allowVerticalPlacement&&!Ci&&V.prevPlacement){var Yo=V.prevPlacement.placedOrientations[Ur.crossTileID];Yo&&(V.placedOrientations[Ur.crossTileID]=Yo,qo=Yo,V.markUsedOrientation(le,qo,Ur))}return qo},Ri=function(Ci,qo){if(le.allowVerticalPlacement&&Ur.numVerticalGlyphVertices>0&&kn.verticalTextBox)for(var Yo=0,du=le.writingModes;Yo<du.length&&(du[Yo]===e.WritingMode.vertical?(Kn=qo(),xa=Kn):Kn=Ci(),!(Kn&&Kn.box&&Kn.box.length));Yo+=1);else Kn=Ci()};if(pe.get("text-variable-anchor")){var pi=pe.get("text-variable-anchor");if(V.prevPlacement&&V.prevPlacement.variableOffsets[Ur.crossTileID]){var Ei=V.prevPlacement.variableOffsets[Ur.crossTileID];pi.indexOf(Ei.anchor)>0&&(pi=pi.filter(function(Ci){return Ci!==Ei.anchor})).unshift(Ei.anchor)}var xi=function(Ci,qo,Yo){for(var du=Ci.x2-Ci.x1,Uf=Ci.y2-Ci.y1,fs=Ur.textBoxScale,Yu=hr&&!zt?qo:null,eu={box:[],offscreen:!1},Vf=Ft?2*pi.length:pi.length,kl=0;kl<Vf;++kl){var Hf=pi[kl%pi.length],gu=kl>=pi.length,Wu=V.attemptAnchorPlacement(Hf,Ci,du,Uf,fs,jt,rr,Ge,ye,Tt,gu,Ur,le,Yo,Yu);if(Wu&&(eu=Wu.placedGlyphBoxes)&&eu.box&&eu.box.length){Gn=!0,Ma=Wu.shift;break}}return eu};Ri(function(){return xi(di,kn.iconBox,e.WritingMode.horizontal)},function(){var Ci=kn.verticalTextBox,qo=Kn&&Kn.box&&Kn.box.length;return le.allowVerticalPlacement&&!qo&&Ur.numVerticalGlyphVertices>0&&Ci?xi(Ci,kn.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}}),Kn&&(Gn=Kn.box,fa=Kn.offscreen);var Lo=zi(Kn&&Kn.box);if(!Gn&&V.prevPlacement){var Ki=V.prevPlacement.variableOffsets[Ur.crossTileID];Ki&&(V.variableOffsets[Ur.crossTileID]=Ki,V.markUsedJustification(le,Ki.anchor,Ur,Lo))}}else{var Zo=function(Ci,qo){var Yo=V.collisionIndex.placeCollisionBox(Ci,Ft,Ge,ye,Tt.predicate);return Yo&&Yo.box&&Yo.box.length&&(V.markUsedOrientation(le,qo,Ur),V.placedOrientations[Ur.crossTileID]=qo),Yo};Ri(function(){return Zo(di,e.WritingMode.horizontal)},function(){var Ci=kn.verticalTextBox;return le.allowVerticalPlacement&&Ur.numVerticalGlyphVertices>0&&Ci?Zo(Ci,e.WritingMode.vertical):{box:null,offscreen:null}}),zi(Kn&&Kn.box&&Kn.box.length)}}if(Gn=(Xn=Kn)&&Xn.box&&Xn.box.length>0,fa=Xn&&Xn.offscreen,Ur.useRuntimeCollisionCircles){var qs=le.text.placedSymbolArray.get(Ur.centerJustifiedTextSymbolIndex),yl=e.evaluateSizeForFeature(le.textSizeData,Ct,qs),Jl=pe.get("text-padding"),zl=Ur.collisionCircleDiameter;ma=V.collisionIndex.placeCollisionCircles(Ft,qs,le.lineVertexArray,le.glyphOffsetArray,yl,ye,Te,Ne,F,rr,Tt.predicate,zl,Jl),Gn=Ft||ma.circles.length>0&&!ma.collisionDetected,fa=fa&&ma.offscreen}if(kn.iconFeatureIndex&&(Ua=kn.iconFeatureIndex),kn.iconBox){var Rl=function(Ci){var qo=hr&&Ma?Jt(Ci,Ma.x,Ma.y,jt,rr,V.transform.angle):Ci;return V.collisionIndex.placeCollisionBox(qo,zt,Ge,ye,Tt.predicate)};ea=xa&&xa.box&&xa.box.length&&kn.verticalIconBox?(La=Rl(kn.verticalIconBox)).box.length>0:(La=Rl(kn.iconBox)).box.length>0,fa=fa&&La.offscreen}var Po=At||Ur.numHorizontalGlyphVertices===0&&Ur.numVerticalGlyphVertices===0,Tl=yt||Ur.numIconVertices===0;if(Po||Tl?Tl?Po||(ea=ea&&Gn):Gn=ea&&Gn:ea=Gn=ea&&Gn,Gn&&Xn&&Xn.box&&(xa&&xa.box&&Pa?V.collisionIndex.insertCollisionBox(Xn.box,pe.get("text-ignore-placement"),le.bucketInstanceId,Pa,Tt.ID):V.collisionIndex.insertCollisionBox(Xn.box,pe.get("text-ignore-placement"),le.bucketInstanceId,ba,Tt.ID)),ea&&La&&V.collisionIndex.insertCollisionBox(La.box,pe.get("icon-ignore-placement"),le.bucketInstanceId,Ua,Tt.ID),ma&&(Gn&&V.collisionIndex.insertCollisionCircles(ma.circles,pe.get("text-ignore-placement"),le.bucketInstanceId,ba,Tt.ID),F)){var $l=le.bucketInstanceId,_s=V.collisionCircleArrays[$l];_s===void 0&&(_s=V.collisionCircleArrays[$l]=new rn);for(var Ql=0;Ql<ma.circles.length;Ql+=4)_s.circles.push(ma.circles[Ql+0]),_s.circles.push(ma.circles[Ql+1]),_s.circles.push(ma.circles[Ql+2]),_s.circles.push(ma.collisionDetected?1:0)}V.placements[Ur.crossTileID]=new Qr(Gn||kr,ea||Kr,fa||le.justReloaded),R[Ur.crossTileID]=!0}};if(Ar)for(var hn=le.getSortedSymbolIndexes(this.transform.angle),sn=hn.length-1;sn>=0;--sn){var Un=hn[sn];Zr(le.symbolInstances.get(Un),le.collisionArrays[Un])}else for(var Wn=E.symbolInstanceStart;Wn<E.symbolInstanceEnd;Wn++)Zr(le.symbolInstances.get(Wn),le.collisionArrays[Wn]);if(F&&le.bucketInstanceId in this.collisionCircleArrays){var ua=this.collisionCircleArrays[le.bucketInstanceId];e.invert(ua.invProjMatrix,ye),ua.viewportMatrix=this.collisionIndex.getViewportMatrix()}le.justReloaded=!1},It.prototype.markUsedJustification=function(E,R,F,V){var ne,le={left:F.leftJustifiedTextSymbolIndex,center:F.centerJustifiedTextSymbolIndex,right:F.rightJustifiedTextSymbolIndex};ne=V===e.WritingMode.vertical?F.verticalPlacedTextSymbolIndex:le[e.getAnchorJustification(R)];for(var pe=0,ye=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex,F.verticalPlacedTextSymbolIndex];pe<ye.length;pe+=1){var Te=ye[pe];Te>=0&&(E.text.placedSymbolArray.get(Te).crossTileID=ne>=0&&Te!==ne?0:F.crossTileID)}},It.prototype.markUsedOrientation=function(E,R,F){for(var V=R===e.WritingMode.horizontal||R===e.WritingMode.horizontalOnly?R:0,ne=R===e.WritingMode.vertical?R:0,le=0,pe=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex];le<pe.length;le+=1){var ye=pe[le];E.text.placedSymbolArray.get(ye).placedOrientation=V}F.verticalPlacedTextSymbolIndex&&(E.text.placedSymbolArray.get(F.verticalPlacedTextSymbolIndex).placedOrientation=ne)},It.prototype.commit=function(E){this.commitTime=E,this.zoomAtLastRecencyCheck=this.transform.zoom;var R=this.prevPlacement,F=!1;this.prevZoomAdjustment=R?R.zoomAdjustment(this.transform.zoom):0;var V=R?R.symbolFadeChange(E):1,ne=R?R.opacities:{},le=R?R.variableOffsets:{},pe=R?R.placedOrientations:{};for(var ye in this.placements){var Te=this.placements[ye],Ne=ne[ye];Ne?(this.opacities[ye]=new tn(Ne,V,Te.text,Te.icon),F=F||Te.text!==Ne.text.placed||Te.icon!==Ne.icon.placed):(this.opacities[ye]=new tn(null,V,Te.text,Te.icon,Te.skipFade),F=F||Te.text||Te.icon)}for(var Ge in ne){var nt=ne[Ge];if(!this.opacities[Ge]){var bt=new tn(nt,V,!1,!1);bt.isHidden()||(this.opacities[Ge]=bt,F=F||nt.text.placed||nt.icon.placed)}}for(var Ct in le)this.variableOffsets[Ct]||!this.opacities[Ct]||this.opacities[Ct].isHidden()||(this.variableOffsets[Ct]=le[Ct]);for(var Tt in pe)this.placedOrientations[Tt]||!this.opacities[Tt]||this.opacities[Tt].isHidden()||(this.placedOrientations[Tt]=pe[Tt]);F?this.lastPlacementChangeTime=E:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=R?R.lastPlacementChangeTime:E)},It.prototype.updateLayerOpacities=function(E,R){for(var F={},V=0,ne=R;V<ne.length;V+=1){var le=ne[V],pe=le.getBucket(E);pe&&le.latestFeatureIndex&&E.id===pe.layerIds[0]&&this.updateBucketOpacities(pe,F,le.collisionBoxArray)}},It.prototype.updateBucketOpacities=function(E,R,F){var V=this;E.hasTextData()&&E.text.opacityVertexArray.clear(),E.hasIconData()&&E.icon.opacityVertexArray.clear(),E.hasIconCollisionBoxData()&&E.iconCollisionBox.collisionVertexArray.clear(),E.hasTextCollisionBoxData()&&E.textCollisionBox.collisionVertexArray.clear();var ne=E.layers[0].layout,le=new tn(null,0,!1,!1,!0),pe=ne.get("text-allow-overlap"),ye=ne.get("icon-allow-overlap"),Te=ne.get("text-variable-anchor"),Ne=ne.get("text-rotation-alignment")==="map",Ge=ne.get("text-pitch-alignment")==="map",nt=ne.get("icon-text-fit")!=="none",bt=new tn(null,0,pe&&(ye||!E.hasIconData()||ne.get("icon-optional")),ye&&(pe||!E.hasTextData()||ne.get("text-optional")),!0);!E.collisionArrays&&F&&(E.hasIconCollisionBoxData()||E.hasTextCollisionBoxData())&&E.deserializeCollisionBoxes(F);for(var Ct=function(Ft,zt,jt){for(var rr=0;rr<zt/4;rr++)Ft.opacityVertexArray.emplaceBack(jt)},Tt=function(Ft){var zt=E.symbolInstances.get(Ft),jt=zt.numHorizontalGlyphVertices,rr=zt.numVerticalGlyphVertices,hr=zt.crossTileID,Ar=R[hr],kr=V.opacities[hr];Ar?kr=le:kr||(kr=bt,V.opacities[hr]=kr),R[hr]=!0;var Kr=jt>0||rr>0,Zr=zt.numIconVertices>0,hn=V.placedOrientations[zt.crossTileID],sn=hn===e.WritingMode.vertical,Un=hn===e.WritingMode.horizontal||hn===e.WritingMode.horizontalOnly;if(Kr){var Wn=Mr(kr.text),ua=sn?Ir:Wn;Ct(E.text,jt,ua);var Ur=Un?Ir:Wn;Ct(E.text,rr,Ur);var kn=kr.text.isHidden();[zt.rightJustifiedTextSymbolIndex,zt.centerJustifiedTextSymbolIndex,zt.leftJustifiedTextSymbolIndex].forEach(function(Ua){Ua>=0&&(E.text.placedSymbolArray.get(Ua).hidden=kn||sn?1:0)}),zt.verticalPlacedTextSymbolIndex>=0&&(E.text.placedSymbolArray.get(zt.verticalPlacedTextSymbolIndex).hidden=kn||Un?1:0);var Xn=V.variableOffsets[zt.crossTileID];Xn&&V.markUsedJustification(E,Xn.anchor,zt,hn);var Gn=V.placedOrientations[zt.crossTileID];Gn&&(V.markUsedJustification(E,"left",zt,Gn),V.markUsedOrientation(E,Gn,zt))}if(Zr){var ea=Mr(kr.icon),fa=!(nt&&zt.verticalPlacedIconSymbolIndex&&sn);if(zt.placedIconSymbolIndex>=0){var Ma=fa?ea:Ir;Ct(E.icon,zt.numIconVertices,Ma),E.icon.placedSymbolArray.get(zt.placedIconSymbolIndex).hidden=kr.icon.isHidden()}if(zt.verticalPlacedIconSymbolIndex>=0){var Kn=fa?Ir:ea;Ct(E.icon,zt.numVerticalIconVertices,Kn),E.icon.placedSymbolArray.get(zt.verticalPlacedIconSymbolIndex).hidden=kr.icon.isHidden()}}if(E.hasIconCollisionBoxData()||E.hasTextCollisionBoxData()){var xa=E.collisionArrays[Ft];if(xa){var ma=new e.Point(0,0);if(xa.textBox||xa.verticalTextBox){var La=!0;if(Te){var ba=V.variableOffsets[hr];ba?(ma=Bn(ba.anchor,ba.width,ba.height,ba.textOffset,ba.textBoxScale),Ne&&ma._rotate(Ge?V.transform.angle:-V.transform.angle)):La=!1}xa.textBox&&qt(E.textCollisionBox.collisionVertexArray,kr.text.placed,!La||sn,ma.x,ma.y),xa.verticalTextBox&&qt(E.textCollisionBox.collisionVertexArray,kr.text.placed,!La||Un,ma.x,ma.y)}var Pa=Boolean(!Un&&xa.verticalIconBox);xa.iconBox&&qt(E.iconCollisionBox.collisionVertexArray,kr.icon.placed,Pa,nt?ma.x:0,nt?ma.y:0),xa.verticalIconBox&&qt(E.iconCollisionBox.collisionVertexArray,kr.icon.placed,!Pa,nt?ma.x:0,nt?ma.y:0)}}},At=0;At<E.symbolInstances.length;At++)Tt(At);if(E.sortFeatures(this.transform.angle),this.retainedQueryData[E.bucketInstanceId]&&(this.retainedQueryData[E.bucketInstanceId].featureSortOrder=E.featureSortOrder),E.hasTextData()&&E.text.opacityVertexBuffer&&E.text.opacityVertexBuffer.updateData(E.text.opacityVertexArray),E.hasIconData()&&E.icon.opacityVertexBuffer&&E.icon.opacityVertexBuffer.updateData(E.icon.opacityVertexArray),E.hasIconCollisionBoxData()&&E.iconCollisionBox.collisionVertexBuffer&&E.iconCollisionBox.collisionVertexBuffer.updateData(E.iconCollisionBox.collisionVertexArray),E.hasTextCollisionBoxData()&&E.textCollisionBox.collisionVertexBuffer&&E.textCollisionBox.collisionVertexBuffer.updateData(E.textCollisionBox.collisionVertexArray),E.bucketInstanceId in this.collisionCircleArrays){var yt=this.collisionCircleArrays[E.bucketInstanceId];E.placementInvProjMatrix=yt.invProjMatrix,E.placementViewportMatrix=yt.viewportMatrix,E.collisionCircleArray=yt.circles,delete this.collisionCircleArrays[E.bucketInstanceId]}},It.prototype.symbolFadeChange=function(E){return this.fadeDuration===0?1:(E-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},It.prototype.zoomAdjustment=function(E){return Math.max(0,(this.transform.zoom-E)/1.5)},It.prototype.hasTransitions=function(E){return this.stale||E-this.lastPlacementChangeTime<this.fadeDuration},It.prototype.stillRecent=function(E,R){var F=this.zoomAtLastRecencyCheck===R?1-this.zoomAdjustment(R):1;return this.zoomAtLastRecencyCheck=R,this.commitTime+this.fadeDuration*F>E},It.prototype.setStale=function(){this.stale=!0};var fr=Math.pow(2,25),Tr=Math.pow(2,24),Gr=Math.pow(2,17),Vr=Math.pow(2,16),xr=Math.pow(2,9),wr=Math.pow(2,8),Sr=Math.pow(2,1);function Mr(E){if(E.opacity===0&&!E.placed)return 0;if(E.opacity===1&&E.placed)return 4294967295;var R=E.placed?1:0,F=Math.floor(127*E.opacity);return F*fr+R*Tr+F*Gr+R*Vr+F*xr+R*wr+F*Sr+R}var Ir=0,qr=function(E){this._sortAcrossTiles=E.layout.get("symbol-z-order")!=="viewport-y"&&E.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};qr.prototype.continuePlacement=function(E,R,F,V,ne){for(var le=this._bucketParts;this._currentTileIndex<E.length;){var pe=E[this._currentTileIndex];if(R.getBucketParts(le,V,pe,this._sortAcrossTiles),this._currentTileIndex++,ne())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,le.sort(function(Te,Ne){return Te.sortKey-Ne.sortKey}));this._currentPartIndex<le.length;){var ye=le[this._currentPartIndex];if(R.placeLayerBucketPart(ye,this._seenCrossTileIDs,F),this._currentPartIndex++,ne())return!0}return!1};var cn=function(E,R,F,V,ne,le,pe){this.placement=new It(E,ne,le,pe),this._currentPlacementIndex=R.length-1,this._forceFullPlacement=F,this._showCollisionBoxes=V,this._done=!1};cn.prototype.isDone=function(){return this._done},cn.prototype.continuePlacement=function(E,R,F){for(var V=this,ne=e.browser.now(),le=function(){var Te=e.browser.now()-ne;return!V._forceFullPlacement&&Te>2};this._currentPlacementIndex>=0;){var pe=R[E[this._currentPlacementIndex]],ye=this.placement.collisionIndex.transform.zoom;if(pe.type==="symbol"&&(!pe.minzoom||pe.minzoom<=ye)&&(!pe.maxzoom||pe.maxzoom>ye)){if(this._inProgressLayer||(this._inProgressLayer=new qr(pe)),this._inProgressLayer.continuePlacement(F[pe.source],this.placement,this._showCollisionBoxes,pe,le))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},cn.prototype.commit=function(E){return this.placement.commit(E),this.placement};var _n=512/e.EXTENT/2,Jr=function(E,R,F){this.tileID=E,this.indexedSymbolInstances={},this.bucketInstanceId=F;for(var V=0;V<R.length;V++){var ne=R.get(V),le=ne.key;this.indexedSymbolInstances[le]||(this.indexedSymbolInstances[le]=[]),this.indexedSymbolInstances[le].push({crossTileID:ne.crossTileID,coord:this.getScaledCoordinates(ne,E)})}};Jr.prototype.getScaledCoordinates=function(E,R){var F=R.canonical.z-this.tileID.canonical.z,V=_n/Math.pow(2,F);return{x:Math.floor((R.canonical.x*e.EXTENT+E.anchorX)*V),y:Math.floor((R.canonical.y*e.EXTENT+E.anchorY)*V)}},Jr.prototype.findMatches=function(E,R,F){for(var V=this.tileID.canonical.z<R.canonical.z?1:Math.pow(2,this.tileID.canonical.z-R.canonical.z),ne=0;ne<E.length;ne++){var le=E.get(ne);if(!le.crossTileID){var pe=this.indexedSymbolInstances[le.key];if(pe)for(var ye=this.getScaledCoordinates(le,R),Te=0,Ne=pe;Te<Ne.length;Te+=1){var Ge=Ne[Te];if(Math.abs(Ge.coord.x-ye.x)<=V&&Math.abs(Ge.coord.y-ye.y)<=V&&!F[Ge.crossTileID]){F[Ge.crossTileID]=!0,le.crossTileID=Ge.crossTileID;break}}}}};var bn=function(){this.maxCrossTileID=0};bn.prototype.generate=function(){return++this.maxCrossTileID};var Dr=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Dr.prototype.handleWrapJump=function(E){var R=Math.round((E-this.lng)/360);if(R!==0)for(var F in this.indexes){var V=this.indexes[F],ne={};for(var le in V){var pe=V[le];pe.tileID=pe.tileID.unwrapTo(pe.tileID.wrap+R),ne[pe.tileID.key]=pe}this.indexes[F]=ne}this.lng=E},Dr.prototype.addBucket=function(E,R,F){if(this.indexes[E.overscaledZ]&&this.indexes[E.overscaledZ][E.key]){if(this.indexes[E.overscaledZ][E.key].bucketInstanceId===R.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(E.overscaledZ,this.indexes[E.overscaledZ][E.key])}for(var V=0;V<R.symbolInstances.length;V++)R.symbolInstances.get(V).crossTileID=0;this.usedCrossTileIDs[E.overscaledZ]||(this.usedCrossTileIDs[E.overscaledZ]={});var ne=this.usedCrossTileIDs[E.overscaledZ];for(var le in this.indexes){var pe=this.indexes[le];if(Number(le)>E.overscaledZ)for(var ye in pe){var Te=pe[ye];Te.tileID.isChildOf(E)&&Te.findMatches(R.symbolInstances,E,ne)}else{var Ne=pe[E.scaledTo(Number(le)).key];Ne&&Ne.findMatches(R.symbolInstances,E,ne)}}for(var Ge=0;Ge<R.symbolInstances.length;Ge++){var nt=R.symbolInstances.get(Ge);nt.crossTileID||(nt.crossTileID=F.generate(),ne[nt.crossTileID]=!0)}return this.indexes[E.overscaledZ]===void 0&&(this.indexes[E.overscaledZ]={}),this.indexes[E.overscaledZ][E.key]=new Jr(E,R.symbolInstances,R.bucketInstanceId),!0},Dr.prototype.removeBucketCrossTileIDs=function(E,R){for(var F in R.indexedSymbolInstances)for(var V=0,ne=R.indexedSymbolInstances[F];V<ne.length;V+=1){var le=ne[V];delete this.usedCrossTileIDs[E][le.crossTileID]}},Dr.prototype.removeStaleBuckets=function(E){var R=!1;for(var F in this.indexes){var V=this.indexes[F];for(var ne in V)E[V[ne].bucketInstanceId]||(this.removeBucketCrossTileIDs(F,V[ne]),delete V[ne],R=!0)}return R};var Wr=function(){this.layerIndexes={},this.crossTileIDs=new bn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Wr.prototype.addLayer=function(E,R,F){var V=this.layerIndexes[E.id];V===void 0&&(V=this.layerIndexes[E.id]=new Dr);var ne=!1,le={};V.handleWrapJump(F);for(var pe=0,ye=R;pe<ye.length;pe+=1){var Te=ye[pe],Ne=Te.getBucket(E);Ne&&E.id===Ne.layerIds[0]&&(Ne.bucketInstanceId||(Ne.bucketInstanceId=++this.maxBucketInstanceId),V.addBucket(Te.tileID,Ne,this.crossTileIDs)&&(ne=!0),le[Ne.bucketInstanceId]=!0)}return V.removeStaleBuckets(le)&&(ne=!0),ne},Wr.prototype.pruneUnusedLayers=function(E){var R={};for(var F in E.forEach(function(V){R[V]=!0}),this.layerIndexes)R[F]||delete this.layerIndexes[F]};var vn=function(E,R){return e.emitValidationErrors(E,R&&R.filter(function(F){return F.identifier!=="source.canvas"}))},dn=e.pick(Ut,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Pn=e.pick(Ut,["setCenter","setZoom","setBearing","setPitch"]),sa=function(){var E={},R=e.styleSpec.$version;for(var F in e.styleSpec.$root){var V=e.styleSpec.$root[F];if(V.required){var ne=null;(ne=F==="version"?R:V.type==="array"?[]:{})!=null&&(E[F]=ne)}}return E}(),Yn=function(E){function R(F,V){var ne=this;V===void 0&&(V={}),E.call(this),this.map=F,this.dispatcher=new P(it(),this),this.imageManager=new y,this.imageManager.setEventedParent(this),this.glyphManager=new w(F._requestManager,V.localIdeographFontFamily),this.lineAtlas=new M(256,512),this.crossTileSymbolIndex=new Wr,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var le=this;this._rtlTextPluginCallback=R.registerForPluginStateChange(function(pe){var ye={pluginStatus:pe.pluginStatus,pluginURL:pe.pluginURL};le.dispatcher.broadcast("syncRTLPluginState",ye,function(Te,Ne){if(e.triggerPluginCompletionEvent(Te),Ne&&Ne.every(function(nt){return nt}))for(var Ge in le.sourceCaches)le.sourceCaches[Ge].reload()})}),this.on("data",function(pe){if(pe.dataType==="source"&&pe.sourceDataType==="metadata"){var ye=ne.sourceCaches[pe.sourceId];if(ye){var Te=ye.getSource();if(Te&&Te.vectorLayerIds)for(var Ne in ne._layers){var Ge=ne._layers[Ne];Ge.source===Te.id&&ne._validateLayer(Ge)}}}})}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.loadURL=function(F,V){var ne=this;V===void 0&&(V={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var le=typeof V.validate=="boolean"?V.validate:!e.isMapboxURL(F);F=this.map._requestManager.normalizeStyleURL(F,V.accessToken);var pe=this.map._requestManager.transformRequest(F,e.ResourceType.Style);this._request=e.getJSON(pe,function(ye,Te){ne._request=null,ye?ne.fire(new e.ErrorEvent(ye)):Te&&ne._load(Te,le)})},R.prototype.loadJSON=function(F,V){var ne=this;V===void 0&&(V={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){ne._request=null,ne._load(F,V.validate!==!1)})},R.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(sa,!1)},R.prototype._load=function(F,V){if(!V||!vn(this,e.validateStyle(F))){for(var ne in this._loaded=!0,this.stylesheet=F,F.sources)this.addSource(ne,F.sources[ne],{validate:!1});F.sprite?this._loadSprite(F.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(F.glyphs);var le=Nt(this.stylesheet.layers);this._order=le.map(function(Ne){return Ne.id}),this._layers={},this._serializedLayers={};for(var pe=0,ye=le;pe<ye.length;pe+=1){var Te=ye[pe];(Te=e.createStyleLayer(Te)).setEventedParent(this,{layer:{id:Te.id}}),this._layers[Te.id]=Te,this._serializedLayers[Te.id]=Te.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new L(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},R.prototype._loadSprite=function(F){var V=this;this._spriteRequest=function(ne,le,pe){var ye,Te,Ne,Ge=e.browser.devicePixelRatio>1?"@2x":"",nt=e.getJSON(le.transformRequest(le.normalizeSpriteURL(ne,Ge,".json"),e.ResourceType.SpriteJSON),function(Tt,At){nt=null,Ne||(Ne=Tt,ye=At,Ct())}),bt=e.getImage(le.transformRequest(le.normalizeSpriteURL(ne,Ge,".png"),e.ResourceType.SpriteImage),function(Tt,At){bt=null,Ne||(Ne=Tt,Te=At,Ct())});function Ct(){if(Ne)pe(Ne);else if(ye&&Te){var Tt=e.browser.getImageData(Te),At={};for(var yt in ye){var Ft=ye[yt],zt=Ft.width,jt=Ft.height,rr=Ft.x,hr=Ft.y,Ar=Ft.sdf,kr=Ft.pixelRatio,Kr=Ft.stretchX,Zr=Ft.stretchY,hn=Ft.content,sn=new e.RGBAImage({width:zt,height:jt});e.RGBAImage.copy(Tt,sn,{x:rr,y:hr},{x:0,y:0},{width:zt,height:jt}),At[yt]={data:sn,pixelRatio:kr,sdf:Ar,stretchX:Kr,stretchY:Zr,content:hn}}pe(null,At)}}return{cancel:function(){nt&&(nt.cancel(),nt=null),bt&&(bt.cancel(),bt=null)}}}(F,this.map._requestManager,function(ne,le){if(V._spriteRequest=null,ne)V.fire(new e.ErrorEvent(ne));else if(le)for(var pe in le)V.imageManager.addImage(pe,le[pe]);V.imageManager.setLoaded(!0),V._availableImages=V.imageManager.listImages(),V.dispatcher.broadcast("setImages",V._availableImages),V.fire(new e.Event("data",{dataType:"style"}))})},R.prototype._validateLayer=function(F){var V=this.sourceCaches[F.source];if(V){var ne=F.sourceLayer;if(ne){var le=V.getSource();(le.type==="geojson"||le.vectorLayerIds&&le.vectorLayerIds.indexOf(ne)===-1)&&this.fire(new e.ErrorEvent(new Error('Source layer "'+ne+'" does not exist on source "'+le.id+'" as specified by style layer "'+F.id+'"')))}}},R.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var F in this.sourceCaches)if(!this.sourceCaches[F].loaded())return!1;return!!this.imageManager.isLoaded()},R.prototype._serializeLayers=function(F){for(var V=[],ne=0,le=F;ne<le.length;ne+=1){var pe=le[ne],ye=this._layers[pe];ye.type!=="custom"&&V.push(ye.serialize())}return V},R.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var F in this.sourceCaches)if(this.sourceCaches[F].hasTransition())return!0;for(var V in this._layers)if(this._layers[V].hasTransition())return!0;return!1},R.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},R.prototype.update=function(F){if(this._loaded){var V=this._changed;if(this._changed){var ne=Object.keys(this._updatedLayers),le=Object.keys(this._removedLayers);for(var pe in(ne.length||le.length)&&this._updateWorkerLayers(ne,le),this._updatedSources){var ye=this._updatedSources[pe];ye==="reload"?this._reloadSource(pe):ye==="clear"&&this._clearSource(pe)}for(var Te in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Te].updateTransitions(F);this.light.updateTransitions(F),this._resetUpdates()}for(var Ne in this.sourceCaches)this.sourceCaches[Ne].used=!1;for(var Ge=0,nt=this._order;Ge<nt.length;Ge+=1){var bt=nt[Ge],Ct=this._layers[bt];Ct.recalculate(F,this._availableImages),!Ct.isHidden(F.zoom)&&Ct.source&&(this.sourceCaches[Ct.source].used=!0)}this.light.recalculate(F),this.z=F.zoom,V&&this.fire(new e.Event("data",{dataType:"style"}))}},R.prototype._updateTilesForChangedImages=function(){var F=Object.keys(this._changedImages);if(F.length){for(var V in this.sourceCaches)this.sourceCaches[V].reloadTilesForDependencies(["icons","patterns"],F);this._changedImages={}}},R.prototype._updateWorkerLayers=function(F,V){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(F),removedIds:V})},R.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},R.prototype.setState=function(F){var V=this;if(this._checkLoaded(),vn(this,e.validateStyle(F)))return!1;(F=e.clone$1(F)).layers=Nt(F.layers);var ne=Xt(this.serialize(),F).filter(function(pe){return!(pe.command in Pn)});if(ne.length===0)return!1;var le=ne.filter(function(pe){return!(pe.command in dn)});if(le.length>0)throw new Error("Unimplemented: "+le.map(function(pe){return pe.command}).join(", ")+".");return ne.forEach(function(pe){pe.command!=="setTransition"&&V[pe.command].apply(V,pe.args)}),this.stylesheet=F,!0},R.prototype.addImage=function(F,V){if(this.getImage(F))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(F,V),this._availableImages=this.imageManager.listImages(),this._changedImages[F]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},R.prototype.updateImage=function(F,V){this.imageManager.updateImage(F,V)},R.prototype.getImage=function(F){return this.imageManager.getImage(F)},R.prototype.removeImage=function(F){if(!this.getImage(F))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(F),this._availableImages=this.imageManager.listImages(),this._changedImages[F]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},R.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},R.prototype.addSource=function(F,V,ne){var le=this;if(ne===void 0&&(ne={}),this._checkLoaded(),this.sourceCaches[F]!==void 0)throw new Error("There is already a source with this ID");if(!V.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(V).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(V.type)>=0)||!this._validate(e.validateStyle.source,"sources."+F,V,null,ne)){this.map&&this.map._collectResourceTiming&&(V.collectResourceTiming=!0);var pe=this.sourceCaches[F]=new Xe(F,V,this.dispatcher);pe.style=this,pe.setEventedParent(this,function(){return{isSourceLoaded:le.loaded(),source:pe.serialize(),sourceId:F}}),pe.onAdd(this.map),this._changed=!0}},R.prototype.removeSource=function(F){if(this._checkLoaded(),this.sourceCaches[F]===void 0)throw new Error("There is no source with this ID");for(var V in this._layers)if(this._layers[V].source===F)return this.fire(new e.ErrorEvent(new Error('Source "'+F+'" cannot be removed while layer "'+V+'" is using it.')));var ne=this.sourceCaches[F];delete this.sourceCaches[F],delete this._updatedSources[F],ne.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:F})),ne.setEventedParent(null),ne.clearTiles(),ne.onRemove&&ne.onRemove(this.map),this._changed=!0},R.prototype.setGeoJSONSourceData=function(F,V){this._checkLoaded(),this.sourceCaches[F].getSource().setData(V),this._changed=!0},R.prototype.getSource=function(F){return this.sourceCaches[F]&&this.sourceCaches[F].getSource()},R.prototype.addLayer=function(F,V,ne){ne===void 0&&(ne={}),this._checkLoaded();var le=F.id;if(this.getLayer(le))this.fire(new e.ErrorEvent(new Error('Layer with id "'+le+'" already exists on this map')));else{var pe;if(F.type==="custom"){if(vn(this,e.validateCustomStyleLayer(F)))return;pe=e.createStyleLayer(F)}else{if(typeof F.source=="object"&&(this.addSource(le,F.source),F=e.clone$1(F),F=e.extend(F,{source:le})),this._validate(e.validateStyle.layer,"layers."+le,F,{arrayIndex:-1},ne))return;pe=e.createStyleLayer(F),this._validateLayer(pe),pe.setEventedParent(this,{layer:{id:le}}),this._serializedLayers[pe.id]=pe.serialize()}var ye=V?this._order.indexOf(V):this._order.length;if(V&&ye===-1)this.fire(new e.ErrorEvent(new Error('Layer with id "'+V+'" does not exist on this map.')));else{if(this._order.splice(ye,0,le),this._layerOrderChanged=!0,this._layers[le]=pe,this._removedLayers[le]&&pe.source&&pe.type!=="custom"){var Te=this._removedLayers[le];delete this._removedLayers[le],Te.type!==pe.type?this._updatedSources[pe.source]="clear":(this._updatedSources[pe.source]="reload",this.sourceCaches[pe.source].pause())}this._updateLayer(pe),pe.onAdd&&pe.onAdd(this.map)}}},R.prototype.moveLayer=function(F,V){if(this._checkLoaded(),this._changed=!0,this._layers[F]){if(F!==V){var ne=this._order.indexOf(F);this._order.splice(ne,1);var le=V?this._order.indexOf(V):this._order.length;V&&le===-1?this.fire(new e.ErrorEvent(new Error('Layer with id "'+V+'" does not exist on this map.'))):(this._order.splice(le,0,F),this._layerOrderChanged=!0)}}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be moved.")))},R.prototype.removeLayer=function(F){this._checkLoaded();var V=this._layers[F];if(V){V.setEventedParent(null);var ne=this._order.indexOf(F);this._order.splice(ne,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[F]=V,delete this._layers[F],delete this._serializedLayers[F],delete this._updatedLayers[F],delete this._updatedPaintProps[F],V.onRemove&&V.onRemove(this.map)}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be removed.")))},R.prototype.getLayer=function(F){return this._layers[F]},R.prototype.hasLayer=function(F){return F in this._layers},R.prototype.setLayerZoomRange=function(F,V,ne){this._checkLoaded();var le=this.getLayer(F);le?le.minzoom===V&&le.maxzoom===ne||(V!=null&&(le.minzoom=V),ne!=null&&(le.maxzoom=ne),this._updateLayer(le)):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot have zoom extent.")))},R.prototype.setFilter=function(F,V,ne){ne===void 0&&(ne={}),this._checkLoaded();var le=this.getLayer(F);if(le){if(!e.deepEqual(le.filter,V))return V==null?(le.filter=void 0,void this._updateLayer(le)):void(this._validate(e.validateStyle.filter,"layers."+le.id+".filter",V,null,ne)||(le.filter=e.clone$1(V),this._updateLayer(le)))}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be filtered.")))},R.prototype.getFilter=function(F){return e.clone$1(this.getLayer(F).filter)},R.prototype.setLayoutProperty=function(F,V,ne,le){le===void 0&&(le={}),this._checkLoaded();var pe=this.getLayer(F);pe?e.deepEqual(pe.getLayoutProperty(V),ne)||(pe.setLayoutProperty(V,ne,le),this._updateLayer(pe)):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be styled.")))},R.prototype.getLayoutProperty=function(F,V){var ne=this.getLayer(F);if(ne)return ne.getLayoutProperty(V);this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style.")))},R.prototype.setPaintProperty=function(F,V,ne,le){le===void 0&&(le={}),this._checkLoaded();var pe=this.getLayer(F);pe?e.deepEqual(pe.getPaintProperty(V),ne)||(pe.setPaintProperty(V,ne,le)&&this._updateLayer(pe),this._changed=!0,this._updatedPaintProps[F]=!0):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be styled.")))},R.prototype.getPaintProperty=function(F,V){return this.getLayer(F).getPaintProperty(V)},R.prototype.setFeatureState=function(F,V){this._checkLoaded();var ne=F.source,le=F.sourceLayer,pe=this.sourceCaches[ne];if(pe!==void 0){var ye=pe.getSource().type;ye==="geojson"&&le?this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):ye!=="vector"||le?(F.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),pe.setFeatureState(le,F.id,V)):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+ne+"' does not exist in the map's style.")))},R.prototype.removeFeatureState=function(F,V){this._checkLoaded();var ne=F.source,le=this.sourceCaches[ne];if(le!==void 0){var pe=le.getSource().type,ye=pe==="vector"?F.sourceLayer:void 0;pe!=="vector"||ye?V&&typeof F.id!="string"&&typeof F.id!="number"?this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):le.removeFeatureState(ye,F.id,V):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+ne+"' does not exist in the map's style.")))},R.prototype.getFeatureState=function(F){this._checkLoaded();var V=F.source,ne=F.sourceLayer,le=this.sourceCaches[V];if(le!==void 0){if(le.getSource().type!=="vector"||ne)return F.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),le.getFeatureState(ne,F.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+V+"' does not exist in the map's style.")))},R.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},R.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(F){return F.serialize()}),layers:this._serializeLayers(this._order)},function(F){return F!==void 0})},R.prototype._updateLayer=function(F){this._updatedLayers[F.id]=!0,F.source&&!this._updatedSources[F.source]&&this.sourceCaches[F.source].getSource().type!=="raster"&&(this._updatedSources[F.source]="reload",this.sourceCaches[F.source].pause()),this._changed=!0},R.prototype._flattenAndSortRenderedFeatures=function(F){for(var V=this,ne=function(hn){return V._layers[hn].type==="fill-extrusion"},le={},pe=[],ye=this._order.length-1;ye>=0;ye--){var Te=this._order[ye];if(ne(Te)){le[Te]=ye;for(var Ne=0,Ge=F;Ne<Ge.length;Ne+=1){var nt=Ge[Ne][Te];if(nt)for(var bt=0,Ct=nt;bt<Ct.length;bt+=1){var Tt=Ct[bt];pe.push(Tt)}}}}pe.sort(function(hn,sn){return sn.intersectionZ-hn.intersectionZ});for(var At=[],yt=this._order.length-1;yt>=0;yt--){var Ft=this._order[yt];if(ne(Ft))for(var zt=pe.length-1;zt>=0;zt--){var jt=pe[zt].feature;if(le[jt.layer.id]<yt)break;At.push(jt),pe.pop()}else for(var rr=0,hr=F;rr<hr.length;rr+=1){var Ar=hr[rr][Ft];if(Ar)for(var kr=0,Kr=Ar;kr<Kr.length;kr+=1){var Zr=Kr[kr];At.push(Zr.feature)}}}return At},R.prototype.queryRenderedFeatures=function(F,V,ne){V&&V.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",V.filter,null,V);var le={};if(V&&V.layers){if(!Array.isArray(V.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var pe=0,ye=V.layers;pe<ye.length;pe+=1){var Te=ye[pe],Ne=this._layers[Te];if(!Ne)return this.fire(new e.ErrorEvent(new Error("The layer '"+Te+"' does not exist in the map's style and cannot be queried for features."))),[];le[Ne.source]=!0}}var Ge=[];for(var nt in V.availableImages=this._availableImages,this.sourceCaches)V.layers&&!le[nt]||Ge.push(W(this.sourceCaches[nt],this._layers,this._serializedLayers,F,V,ne));return this.placement&&Ge.push(function(bt,Ct,Tt,At,yt,Ft,zt){for(var jt={},rr=Ft.queryRenderedSymbols(At),hr=[],Ar=0,kr=Object.keys(rr).map(Number);Ar<kr.length;Ar+=1){var Kr=kr[Ar];hr.push(zt[Kr])}hr.sort(ee);for(var Zr=function(){var ua=sn[hn],Ur=ua.featureIndex.lookupSymbolFeatures(rr[ua.bucketInstanceId],Ct,ua.bucketIndex,ua.sourceLayerIndex,yt.filter,yt.layers,yt.availableImages,bt);for(var kn in Ur){var Xn=jt[kn]=jt[kn]||[],Gn=Ur[kn];Gn.sort(function(Kn,xa){var ma=ua.featureSortOrder;if(ma){var La=ma.indexOf(Kn.featureIndex);return ma.indexOf(xa.featureIndex)-La}return xa.featureIndex-Kn.featureIndex});for(var ea=0,fa=Gn;ea<fa.length;ea+=1){var Ma=fa[ea];Xn.push(Ma)}}},hn=0,sn=hr;hn<sn.length;hn+=1)Zr();var Un=function(ua){jt[ua].forEach(function(Ur){var kn=Ur.feature,Xn=bt[ua],Gn=Tt[Xn.source].getFeatureState(kn.layer["source-layer"],kn.id);kn.source=kn.layer.source,kn.layer["source-layer"]&&(kn.sourceLayer=kn.layer["source-layer"]),kn.state=Gn})};for(var Wn in jt)Un(Wn);return jt}(this._layers,this._serializedLayers,this.sourceCaches,F,V,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Ge)},R.prototype.querySourceFeatures=function(F,V){V&&V.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",V.filter,null,V);var ne=this.sourceCaches[F];return ne?function(le,pe){for(var ye=le.getRenderableIds().map(function(Ct){return le.getTileByID(Ct)}),Te=[],Ne={},Ge=0;Ge<ye.length;Ge++){var nt=ye[Ge],bt=nt.tileID.canonical.key;Ne[bt]||(Ne[bt]=!0,nt.querySourceFeatures(Te,pe))}return Te}(ne,V):[]},R.prototype.addSourceType=function(F,V,ne){return R.getSourceType(F)?ne(new Error('A source type called "'+F+'" already exists.')):(R.setSourceType(F,V),V.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:F,url:V.workerSourceURL},ne):ne(null,null))},R.prototype.getLight=function(){return this.light.getLight()},R.prototype.setLight=function(F,V){V===void 0&&(V={}),this._checkLoaded();var ne=this.light.getLight(),le=!1;for(var pe in F)if(!e.deepEqual(F[pe],ne[pe])){le=!0;break}if(le){var ye={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(F,V),this.light.updateTransitions(ye)}},R.prototype._validate=function(F,V,ne,le,pe){return pe===void 0&&(pe={}),(!pe||pe.validate!==!1)&&vn(this,F.call(e.validateStyle,e.extend({key:V,style:this.serialize(),value:ne,styleSpec:e.styleSpec},le)))},R.prototype._remove=function(){for(var F in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[F].setEventedParent(null);for(var V in this.sourceCaches)this.sourceCaches[V].clearTiles(),this.sourceCaches[V].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},R.prototype._clearSource=function(F){this.sourceCaches[F].clearTiles()},R.prototype._reloadSource=function(F){this.sourceCaches[F].resume(),this.sourceCaches[F].reload()},R.prototype._updateSources=function(F){for(var V in this.sourceCaches)this.sourceCaches[V].update(F)},R.prototype._generateCollisionBoxes=function(){for(var F in this.sourceCaches)this._reloadSource(F)},R.prototype._updatePlacement=function(F,V,ne,le,pe){pe===void 0&&(pe=!1);for(var ye=!1,Te=!1,Ne={},Ge=0,nt=this._order;Ge<nt.length;Ge+=1){var bt=nt[Ge],Ct=this._layers[bt];if(Ct.type==="symbol"){if(!Ne[Ct.source]){var Tt=this.sourceCaches[Ct.source];Ne[Ct.source]=Tt.getRenderableIds(!0).map(function(rr){return Tt.getTileByID(rr)}).sort(function(rr,hr){return hr.tileID.overscaledZ-rr.tileID.overscaledZ||(rr.tileID.isLessThan(hr.tileID)?-1:1)})}var At=this.crossTileSymbolIndex.addLayer(Ct,Ne[Ct.source],F.center.lng);ye=ye||At}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((pe=pe||this._layerOrderChanged||ne===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),F.zoom))&&(this.pauseablePlacement=new cn(F,this._order,pe,V,ne,le,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ne),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),Te=!0),ye&&this.pauseablePlacement.placement.setStale()),Te||ye)for(var yt=0,Ft=this._order;yt<Ft.length;yt+=1){var zt=Ft[yt],jt=this._layers[zt];jt.type==="symbol"&&this.placement.updateLayerOpacities(jt,Ne[jt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now())},R.prototype._releaseSymbolFadeTiles=function(){for(var F in this.sourceCaches)this.sourceCaches[F].releaseSymbolFadeTiles()},R.prototype.getImages=function(F,V,ne){this.imageManager.getImages(V.icons,ne),this._updateTilesForChangedImages();var le=this.sourceCaches[V.source];le&&le.setDependencies(V.tileID.key,V.type,V.icons)},R.prototype.getGlyphs=function(F,V,ne){this.glyphManager.getGlyphs(V.stacks,ne)},R.prototype.getResource=function(F,V,ne){return e.makeRequest(V,ne)},R}(e.Evented);Yn.getSourceType=function(E){return z[E]},Yn.setSourceType=function(E,R){z[E]=R},Yn.registerForPluginStateChange=e.registerForPluginStateChange;var yn=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),ra=Xa(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),pa=Xa(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Qa=Xa(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Fi=Xa(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),li=Xa("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ki=Xa(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Ea=Xa(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ga=Xa("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),ko=Xa("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Qo=Xa("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),us=Xa(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),$i=Xa(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),to=Xa(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),es=Xa(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Wa=Xa(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),jo=Xa(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Ao=Xa(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Ai=Xa(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),ro=Xa(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Mo=Xa(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define MAX_LINE_DISTANCE 32767.0
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),zo=Xa(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Ui=Xa(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),vi=Xa(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Qi=Xa(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Vs=Xa(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Xs=Xa(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Xa(E,R){var F=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,V={};return{fragmentSource:E=E.replace(F,function(ne,le,pe,ye,Te){return V[Te]=!0,le==="define"?`
#ifndef HAS_UNIFORM_u_`+Te+`
varying `+pe+" "+ye+" "+Te+`;
#else
uniform `+pe+" "+ye+" u_"+Te+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Te+`
    `+pe+" "+ye+" "+Te+" = u_"+Te+`;
#endif
`}),vertexSource:R=R.replace(F,function(ne,le,pe,ye,Te){var Ne=ye==="float"?"vec2":"vec4",Ge=Te.match(/color/)?"color":Ne;return V[Te]?le==="define"?`
#ifndef HAS_UNIFORM_u_`+Te+`
uniform lowp float u_`+Te+`_t;
attribute `+pe+" "+Ne+" a_"+Te+`;
varying `+pe+" "+ye+" "+Te+`;
#else
uniform `+pe+" "+ye+" u_"+Te+`;
#endif
`:Ge==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+Te+" = a_"+Te+`;
#else
    `+pe+" "+ye+" "+Te+" = u_"+Te+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+Te+" = unpack_mix_"+Ge+"(a_"+Te+", u_"+Te+`_t);
#else
    `+pe+" "+ye+" "+Te+" = u_"+Te+`;
#endif
`:le==="define"?`
#ifndef HAS_UNIFORM_u_`+Te+`
uniform lowp float u_`+Te+`_t;
attribute `+pe+" "+Ne+" a_"+Te+`;
#else
uniform `+pe+" "+ye+" u_"+Te+`;
#endif
`:Ge==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+pe+" "+ye+" "+Te+" = a_"+Te+`;
#else
    `+pe+" "+ye+" "+Te+" = u_"+Te+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+pe+" "+ye+" "+Te+" = unpack_mix_"+Ge+"(a_"+Te+", u_"+Te+`_t);
#else
    `+pe+" "+ye+" "+Te+" = u_"+Te+`;
#endif
`})}}var Os=Object.freeze({__proto__:null,prelude:ra,background:pa,backgroundPattern:Qa,circle:Fi,clippingMask:li,heatmap:ki,heatmapTexture:Ea,collisionBox:Ga,collisionCircle:ko,debug:Qo,fill:us,fillOutline:$i,fillOutlinePattern:to,fillPattern:es,fillExtrusion:Wa,fillExtrusionPattern:jo,hillshadePrepare:Ao,hillshade:Ai,line:ro,lineGradient:Mo,linePattern:zo,lineSDF:Ui,raster:vi,symbolIcon:Qi,symbolSDF:Vs,symbolTextAndIcon:Xs}),ms=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};ms.prototype.bind=function(E,R,F,V,ne,le,pe,ye){this.context=E;for(var Te=this.boundPaintVertexBuffers.length!==V.length,Ne=0;!Te&&Ne<V.length;Ne++)this.boundPaintVertexBuffers[Ne]!==V[Ne]&&(Te=!0);var Ge=!this.vao||this.boundProgram!==R||this.boundLayoutVertexBuffer!==F||Te||this.boundIndexBuffer!==ne||this.boundVertexOffset!==le||this.boundDynamicVertexBuffer!==pe||this.boundDynamicVertexBuffer2!==ye;!E.extVertexArrayObject||Ge?this.freshBind(R,F,V,ne,le,pe,ye):(E.bindVertexArrayOES.set(this.vao),pe&&pe.bind(),ne&&ne.dynamicDraw&&ne.bind(),ye&&ye.bind())},ms.prototype.freshBind=function(E,R,F,V,ne,le,pe){var ye,Te=E.numAttributes,Ne=this.context,Ge=Ne.gl;if(Ne.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ne.extVertexArrayObject.createVertexArrayOES(),Ne.bindVertexArrayOES.set(this.vao),ye=0,this.boundProgram=E,this.boundLayoutVertexBuffer=R,this.boundPaintVertexBuffers=F,this.boundIndexBuffer=V,this.boundVertexOffset=ne,this.boundDynamicVertexBuffer=le,this.boundDynamicVertexBuffer2=pe;else{ye=Ne.currentNumAttributes||0;for(var nt=Te;nt<ye;nt++)Ge.disableVertexAttribArray(nt)}R.enableAttributes(Ge,E);for(var bt=0,Ct=F;bt<Ct.length;bt+=1)Ct[bt].enableAttributes(Ge,E);le&&le.enableAttributes(Ge,E),pe&&pe.enableAttributes(Ge,E),R.bind(),R.setVertexAttribPointers(Ge,E,ne);for(var Tt=0,At=F;Tt<At.length;Tt+=1){var yt=At[Tt];yt.bind(),yt.setVertexAttribPointers(Ge,E,ne)}le&&(le.bind(),le.setVertexAttribPointers(Ge,E,ne)),V&&V.bind(),pe&&(pe.bind(),pe.setVertexAttribPointers(Ge,E,ne)),Ne.currentNumAttributes=Te},ms.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Zs=function(E,R,F,V,ne){var le=E.gl;this.program=le.createProgram();var pe=F?F.defines():[];ne&&pe.push("#define OVERDRAW_INSPECTOR;");var ye=pe.concat(ra.fragmentSource,R.fragmentSource).join(`
`),Te=pe.concat(ra.vertexSource,R.vertexSource).join(`
`),Ne=le.createShader(le.FRAGMENT_SHADER);if(le.isContextLost())this.failedToCreate=!0;else{le.shaderSource(Ne,ye),le.compileShader(Ne),le.attachShader(this.program,Ne);var Ge=le.createShader(le.VERTEX_SHADER);if(le.isContextLost())this.failedToCreate=!0;else{le.shaderSource(Ge,Te),le.compileShader(Ge),le.attachShader(this.program,Ge);for(var nt=F?F.layoutAttributes:[],bt=0;bt<nt.length;bt++)le.bindAttribLocation(this.program,bt,nt[bt].name);le.linkProgram(this.program),le.deleteShader(Ge),le.deleteShader(Ne),this.numAttributes=le.getProgramParameter(this.program,le.ACTIVE_ATTRIBUTES),this.attributes={};for(var Ct={},Tt=0;Tt<this.numAttributes;Tt++){var At=le.getActiveAttrib(this.program,Tt);At&&(this.attributes[At.name]=le.getAttribLocation(this.program,At.name))}for(var yt=le.getProgramParameter(this.program,le.ACTIVE_UNIFORMS),Ft=0;Ft<yt;Ft++){var zt=le.getActiveUniform(this.program,Ft);zt&&(Ct[zt.name]=le.getUniformLocation(this.program,zt.name))}this.fixedUniforms=V(E,Ct),this.binderUniforms=F?F.getUniforms(E,Ct):[]}}};function Ks(E,R,F){var V=1/Pr(F,1,R.transform.tileZoom),ne=Math.pow(2,F.tileID.overscaledZ),le=F.tileSize*Math.pow(2,R.transform.tileZoom)/ne,pe=le*(F.tileID.canonical.x+F.tileID.wrap*ne),ye=le*F.tileID.canonical.y;return{u_image:0,u_texsize:F.imageAtlasTexture.size,u_scale:[V,E.fromScale,E.toScale],u_fade:E.t,u_pixel_coord_upper:[pe>>16,ye>>16],u_pixel_coord_lower:[65535&pe,65535&ye]}}Zs.prototype.draw=function(E,R,F,V,ne,le,pe,ye,Te,Ne,Ge,nt,bt,Ct,Tt,At){var yt,Ft=E.gl;if(!this.failedToCreate){for(var zt in E.program.set(this.program),E.setDepthMode(F),E.setStencilMode(V),E.setColorMode(ne),E.setCullFace(le),this.fixedUniforms)this.fixedUniforms[zt].set(pe[zt]);Ct&&Ct.setUniforms(E,this.binderUniforms,nt,{zoom:bt});for(var jt=(yt={},yt[Ft.LINES]=2,yt[Ft.TRIANGLES]=3,yt[Ft.LINE_STRIP]=1,yt)[R],rr=0,hr=Ge.get();rr<hr.length;rr+=1){var Ar=hr[rr],kr=Ar.vaos||(Ar.vaos={});(kr[ye]||(kr[ye]=new ms)).bind(E,this,Te,Ct?Ct.getPaintVertexBuffers():[],Ne,Ar.vertexOffset,Tt,At),Ft.drawElements(R,Ar.primitiveLength*jt,Ft.UNSIGNED_SHORT,Ar.primitiveOffset*jt*2)}}};var Hs=function(E,R,F,V){var ne=R.style.light,le=ne.properties.get("position"),pe=[le.x,le.y,le.z],ye=e.create$1();ne.properties.get("anchor")==="viewport"&&e.fromRotation(ye,-R.transform.angle),e.transformMat3(pe,pe,ye);var Te=ne.properties.get("color");return{u_matrix:E,u_lightpos:pe,u_lightintensity:ne.properties.get("intensity"),u_lightcolor:[Te.r,Te.g,Te.b],u_vertical_gradient:+F,u_opacity:V}},Js=function(E,R,F,V,ne,le,pe){return e.extend(Hs(E,R,F,V),Ks(le,R,pe),{u_height_factor:-Math.pow(2,ne.overscaledZ)/pe.tileSize/8})},Uo=function(E){return{u_matrix:E}},Vo=function(E,R,F,V){return e.extend(Uo(E),Ks(F,R,V))},ts=function(E,R){return{u_matrix:E,u_world:R}},rs=function(E,R,F,V,ne){return e.extend(Vo(E,R,F,V),{u_world:ne})},ns=function(E,R,F,V){var ne,le,pe=E.transform;if(V.paint.get("circle-pitch-alignment")==="map"){var ye=Pr(F,1,pe.zoom);ne=!0,le=[ye,ye]}else ne=!1,le=pe.pixelsToGLUnits;return{u_camera_to_center_distance:pe.cameraToCenterDistance,u_scale_with_map:+(V.paint.get("circle-pitch-scale")==="map"),u_matrix:E.translatePosMatrix(R.posMatrix,F,V.paint.get("circle-translate"),V.paint.get("circle-translate-anchor")),u_pitch_with_map:+ne,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:le}},vs=function(E,R,F){var V=Pr(F,1,R.zoom),ne=Math.pow(2,R.zoom-F.tileID.overscaledZ),le=F.tileID.overscaleFactor();return{u_matrix:E,u_camera_to_center_distance:R.cameraToCenterDistance,u_pixels_to_tile_units:V,u_extrude_scale:[R.pixelsToGLUnits[0]/(V*ne),R.pixelsToGLUnits[1]/(V*ne)],u_overscale_factor:le}},So=function(E,R,F){return{u_matrix:E,u_inv_matrix:R,u_camera_to_center_distance:F.cameraToCenterDistance,u_viewport_size:[F.width,F.height]}},Ds=function(E,R,F){return F===void 0&&(F=1),{u_matrix:E,u_color:R,u_overlay:0,u_overlay_scale:F}},vo=function(E){return{u_matrix:E}},as=function(E,R,F,V){return{u_matrix:E,u_extrude_scale:Pr(R,1,F),u_intensity:V}};function zs(E,R){var F=Math.pow(2,R.canonical.z),V=R.canonical.y;return[new e.MercatorCoordinate(0,V/F).toLngLat().lat,new e.MercatorCoordinate(0,(V+1)/F).toLngLat().lat]}var Ho=function(E,R,F){var V=E.transform;return{u_matrix:ot(E,R,F),u_ratio:1/Pr(R,1,V.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/V.pixelsToGLUnits[0],1/V.pixelsToGLUnits[1]]}},qa=function(E,R,F){return e.extend(Ho(E,R,F),{u_image:0})},Re=function(E,R,F,V){var ne=E.transform,le=Je(R,ne);return{u_matrix:ot(E,R,F),u_texsize:R.imageAtlasTexture.size,u_ratio:1/Pr(R,1,ne.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[le,V.fromScale,V.toScale],u_fade:V.t,u_units_to_pixels:[1/ne.pixelsToGLUnits[0],1/ne.pixelsToGLUnits[1]]}},Ve=function(E,R,F,V,ne){var le=E.transform,pe=E.lineAtlas,ye=Je(R,le),Te=F.layout.get("line-cap")==="round",Ne=pe.getDash(V.from,Te),Ge=pe.getDash(V.to,Te),nt=Ne.width*ne.fromScale,bt=Ge.width*ne.toScale;return e.extend(Ho(E,R,F),{u_patternscale_a:[ye/nt,-Ne.height/2],u_patternscale_b:[ye/bt,-Ge.height/2],u_sdfgamma:pe.width/(256*Math.min(nt,bt)*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ne.y,u_tex_y_b:Ge.y,u_mix:ne.t})};function Je(E,R){return 1/Pr(E,1,R.tileZoom)}function ot(E,R,F){return E.translatePosMatrix(R.tileID.posMatrix,R,F.paint.get("line-translate"),F.paint.get("line-translate-anchor"))}var mt=function(E,R,F,V,ne){return{u_matrix:E,u_tl_parent:R,u_scale_parent:F,u_buffer_scale:1,u_fade_t:V.mix,u_opacity:V.opacity*ne.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:ne.paint.get("raster-brightness-min"),u_brightness_high:ne.paint.get("raster-brightness-max"),u_saturation_factor:(pe=ne.paint.get("raster-saturation"),pe>0?1-1/(1.001-pe):-pe),u_contrast_factor:(le=ne.paint.get("raster-contrast"),le>0?1/(1-le):1+le),u_spin_weights:dt(ne.paint.get("raster-hue-rotate"))};var le,pe};function dt(E){E*=Math.PI/180;var R=Math.sin(E),F=Math.cos(E);return[(2*F+1)/3,(-Math.sqrt(3)*R-F+1)/3,(Math.sqrt(3)*R-F+1)/3]}var Et,Zt=function(E,R,F,V,ne,le,pe,ye,Te,Ne){var Ge=ne.transform;return{u_is_size_zoom_constant:+(E==="constant"||E==="source"),u_is_size_feature_constant:+(E==="constant"||E==="camera"),u_size_t:R?R.uSizeT:0,u_size:R?R.uSize:0,u_camera_to_center_distance:Ge.cameraToCenterDistance,u_pitch:Ge.pitch/360*2*Math.PI,u_rotate_symbol:+F,u_aspect_ratio:Ge.width/Ge.height,u_fade_change:ne.options.fadeDuration?ne.symbolFadeChange:1,u_matrix:le,u_label_plane_matrix:pe,u_coord_matrix:ye,u_is_text:+Te,u_pitch_with_map:+V,u_texsize:Ne,u_texture:0}},$t=function(E,R,F,V,ne,le,pe,ye,Te,Ne,Ge){var nt=ne.transform;return e.extend(Zt(E,R,F,V,ne,le,pe,ye,Te,Ne),{u_gamma_scale:V?Math.cos(nt._pitch)*nt.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+Ge})},Yt=function(E,R,F,V,ne,le,pe,ye,Te,Ne){return e.extend($t(E,R,F,V,ne,le,pe,ye,!0,Te,!0),{u_texsize_icon:Ne,u_texture_icon:1})},nr=function(E,R,F){return{u_matrix:E,u_opacity:R,u_color:F}},cr=function(E,R,F,V,ne,le){return e.extend(function(pe,ye,Te,Ne){var Ge=Te.imageManager.getPattern(pe.from.toString()),nt=Te.imageManager.getPattern(pe.to.toString()),bt=Te.imageManager.getPixelSize(),Ct=bt.width,Tt=bt.height,At=Math.pow(2,Ne.tileID.overscaledZ),yt=Ne.tileSize*Math.pow(2,Te.transform.tileZoom)/At,Ft=yt*(Ne.tileID.canonical.x+Ne.tileID.wrap*At),zt=yt*Ne.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Ge.tl,u_pattern_br_a:Ge.br,u_pattern_tl_b:nt.tl,u_pattern_br_b:nt.br,u_texsize:[Ct,Tt],u_mix:ye.t,u_pattern_size_a:Ge.displaySize,u_pattern_size_b:nt.displaySize,u_scale_a:ye.fromScale,u_scale_b:ye.toScale,u_tile_units_to_pixels:1/Pr(Ne,1,Te.transform.tileZoom),u_pixel_coord_upper:[Ft>>16,zt>>16],u_pixel_coord_lower:[65535&Ft,65535&zt]}}(V,le,F,ne),{u_matrix:E,u_opacity:R})},mr={fillExtrusion:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_lightpos:new e.Uniform3f(E,R.u_lightpos),u_lightintensity:new e.Uniform1f(E,R.u_lightintensity),u_lightcolor:new e.Uniform3f(E,R.u_lightcolor),u_vertical_gradient:new e.Uniform1f(E,R.u_vertical_gradient),u_opacity:new e.Uniform1f(E,R.u_opacity)}},fillExtrusionPattern:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_lightpos:new e.Uniform3f(E,R.u_lightpos),u_lightintensity:new e.Uniform1f(E,R.u_lightintensity),u_lightcolor:new e.Uniform3f(E,R.u_lightcolor),u_vertical_gradient:new e.Uniform1f(E,R.u_vertical_gradient),u_height_factor:new e.Uniform1f(E,R.u_height_factor),u_image:new e.Uniform1i(E,R.u_image),u_texsize:new e.Uniform2f(E,R.u_texsize),u_pixel_coord_upper:new e.Uniform2f(E,R.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(E,R.u_pixel_coord_lower),u_scale:new e.Uniform3f(E,R.u_scale),u_fade:new e.Uniform1f(E,R.u_fade),u_opacity:new e.Uniform1f(E,R.u_opacity)}},fill:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix)}},fillPattern:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_image:new e.Uniform1i(E,R.u_image),u_texsize:new e.Uniform2f(E,R.u_texsize),u_pixel_coord_upper:new e.Uniform2f(E,R.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(E,R.u_pixel_coord_lower),u_scale:new e.Uniform3f(E,R.u_scale),u_fade:new e.Uniform1f(E,R.u_fade)}},fillOutline:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_world:new e.Uniform2f(E,R.u_world)}},fillOutlinePattern:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_world:new e.Uniform2f(E,R.u_world),u_image:new e.Uniform1i(E,R.u_image),u_texsize:new e.Uniform2f(E,R.u_texsize),u_pixel_coord_upper:new e.Uniform2f(E,R.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(E,R.u_pixel_coord_lower),u_scale:new e.Uniform3f(E,R.u_scale),u_fade:new e.Uniform1f(E,R.u_fade)}},circle:function(E,R){return{u_camera_to_center_distance:new e.Uniform1f(E,R.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(E,R.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(E,R.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(E,R.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(E,R.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(E,R.u_matrix)}},collisionBox:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_camera_to_center_distance:new e.Uniform1f(E,R.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(E,R.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(E,R.u_extrude_scale),u_overscale_factor:new e.Uniform1f(E,R.u_overscale_factor)}},collisionCircle:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_inv_matrix:new e.UniformMatrix4f(E,R.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(E,R.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(E,R.u_viewport_size)}},debug:function(E,R){return{u_color:new e.UniformColor(E,R.u_color),u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_overlay:new e.Uniform1i(E,R.u_overlay),u_overlay_scale:new e.Uniform1f(E,R.u_overlay_scale)}},clippingMask:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix)}},heatmap:function(E,R){return{u_extrude_scale:new e.Uniform1f(E,R.u_extrude_scale),u_intensity:new e.Uniform1f(E,R.u_intensity),u_matrix:new e.UniformMatrix4f(E,R.u_matrix)}},heatmapTexture:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_world:new e.Uniform2f(E,R.u_world),u_image:new e.Uniform1i(E,R.u_image),u_color_ramp:new e.Uniform1i(E,R.u_color_ramp),u_opacity:new e.Uniform1f(E,R.u_opacity)}},hillshade:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_image:new e.Uniform1i(E,R.u_image),u_latrange:new e.Uniform2f(E,R.u_latrange),u_light:new e.Uniform2f(E,R.u_light),u_shadow:new e.UniformColor(E,R.u_shadow),u_highlight:new e.UniformColor(E,R.u_highlight),u_accent:new e.UniformColor(E,R.u_accent)}},hillshadePrepare:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_image:new e.Uniform1i(E,R.u_image),u_dimension:new e.Uniform2f(E,R.u_dimension),u_zoom:new e.Uniform1f(E,R.u_zoom),u_maxzoom:new e.Uniform1f(E,R.u_maxzoom),u_unpack:new e.Uniform4f(E,R.u_unpack)}},line:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_ratio:new e.Uniform1f(E,R.u_ratio),u_device_pixel_ratio:new e.Uniform1f(E,R.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(E,R.u_units_to_pixels)}},lineGradient:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_ratio:new e.Uniform1f(E,R.u_ratio),u_device_pixel_ratio:new e.Uniform1f(E,R.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(E,R.u_units_to_pixels),u_image:new e.Uniform1i(E,R.u_image)}},linePattern:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_texsize:new e.Uniform2f(E,R.u_texsize),u_ratio:new e.Uniform1f(E,R.u_ratio),u_device_pixel_ratio:new e.Uniform1f(E,R.u_device_pixel_ratio),u_image:new e.Uniform1i(E,R.u_image),u_units_to_pixels:new e.Uniform2f(E,R.u_units_to_pixels),u_scale:new e.Uniform3f(E,R.u_scale),u_fade:new e.Uniform1f(E,R.u_fade)}},lineSDF:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_ratio:new e.Uniform1f(E,R.u_ratio),u_device_pixel_ratio:new e.Uniform1f(E,R.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(E,R.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(E,R.u_patternscale_a),u_patternscale_b:new e.Uniform2f(E,R.u_patternscale_b),u_sdfgamma:new e.Uniform1f(E,R.u_sdfgamma),u_image:new e.Uniform1i(E,R.u_image),u_tex_y_a:new e.Uniform1f(E,R.u_tex_y_a),u_tex_y_b:new e.Uniform1f(E,R.u_tex_y_b),u_mix:new e.Uniform1f(E,R.u_mix)}},raster:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_tl_parent:new e.Uniform2f(E,R.u_tl_parent),u_scale_parent:new e.Uniform1f(E,R.u_scale_parent),u_buffer_scale:new e.Uniform1f(E,R.u_buffer_scale),u_fade_t:new e.Uniform1f(E,R.u_fade_t),u_opacity:new e.Uniform1f(E,R.u_opacity),u_image0:new e.Uniform1i(E,R.u_image0),u_image1:new e.Uniform1i(E,R.u_image1),u_brightness_low:new e.Uniform1f(E,R.u_brightness_low),u_brightness_high:new e.Uniform1f(E,R.u_brightness_high),u_saturation_factor:new e.Uniform1f(E,R.u_saturation_factor),u_contrast_factor:new e.Uniform1f(E,R.u_contrast_factor),u_spin_weights:new e.Uniform3f(E,R.u_spin_weights)}},symbolIcon:function(E,R){return{u_is_size_zoom_constant:new e.Uniform1i(E,R.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(E,R.u_is_size_feature_constant),u_size_t:new e.Uniform1f(E,R.u_size_t),u_size:new e.Uniform1f(E,R.u_size),u_camera_to_center_distance:new e.Uniform1f(E,R.u_camera_to_center_distance),u_pitch:new e.Uniform1f(E,R.u_pitch),u_rotate_symbol:new e.Uniform1i(E,R.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(E,R.u_aspect_ratio),u_fade_change:new e.Uniform1f(E,R.u_fade_change),u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(E,R.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(E,R.u_coord_matrix),u_is_text:new e.Uniform1i(E,R.u_is_text),u_pitch_with_map:new e.Uniform1i(E,R.u_pitch_with_map),u_texsize:new e.Uniform2f(E,R.u_texsize),u_texture:new e.Uniform1i(E,R.u_texture)}},symbolSDF:function(E,R){return{u_is_size_zoom_constant:new e.Uniform1i(E,R.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(E,R.u_is_size_feature_constant),u_size_t:new e.Uniform1f(E,R.u_size_t),u_size:new e.Uniform1f(E,R.u_size),u_camera_to_center_distance:new e.Uniform1f(E,R.u_camera_to_center_distance),u_pitch:new e.Uniform1f(E,R.u_pitch),u_rotate_symbol:new e.Uniform1i(E,R.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(E,R.u_aspect_ratio),u_fade_change:new e.Uniform1f(E,R.u_fade_change),u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(E,R.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(E,R.u_coord_matrix),u_is_text:new e.Uniform1i(E,R.u_is_text),u_pitch_with_map:new e.Uniform1i(E,R.u_pitch_with_map),u_texsize:new e.Uniform2f(E,R.u_texsize),u_texture:new e.Uniform1i(E,R.u_texture),u_gamma_scale:new e.Uniform1f(E,R.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(E,R.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(E,R.u_is_halo)}},symbolTextAndIcon:function(E,R){return{u_is_size_zoom_constant:new e.Uniform1i(E,R.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(E,R.u_is_size_feature_constant),u_size_t:new e.Uniform1f(E,R.u_size_t),u_size:new e.Uniform1f(E,R.u_size),u_camera_to_center_distance:new e.Uniform1f(E,R.u_camera_to_center_distance),u_pitch:new e.Uniform1f(E,R.u_pitch),u_rotate_symbol:new e.Uniform1i(E,R.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(E,R.u_aspect_ratio),u_fade_change:new e.Uniform1f(E,R.u_fade_change),u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(E,R.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(E,R.u_coord_matrix),u_is_text:new e.Uniform1i(E,R.u_is_text),u_pitch_with_map:new e.Uniform1i(E,R.u_pitch_with_map),u_texsize:new e.Uniform2f(E,R.u_texsize),u_texsize_icon:new e.Uniform2f(E,R.u_texsize_icon),u_texture:new e.Uniform1i(E,R.u_texture),u_texture_icon:new e.Uniform1i(E,R.u_texture_icon),u_gamma_scale:new e.Uniform1f(E,R.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(E,R.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(E,R.u_is_halo)}},background:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_opacity:new e.Uniform1f(E,R.u_opacity),u_color:new e.UniformColor(E,R.u_color)}},backgroundPattern:function(E,R){return{u_matrix:new e.UniformMatrix4f(E,R.u_matrix),u_opacity:new e.Uniform1f(E,R.u_opacity),u_image:new e.Uniform1i(E,R.u_image),u_pattern_tl_a:new e.Uniform2f(E,R.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(E,R.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(E,R.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(E,R.u_pattern_br_b),u_texsize:new e.Uniform2f(E,R.u_texsize),u_mix:new e.Uniform1f(E,R.u_mix),u_pattern_size_a:new e.Uniform2f(E,R.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(E,R.u_pattern_size_b),u_scale_a:new e.Uniform1f(E,R.u_scale_a),u_scale_b:new e.Uniform1f(E,R.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(E,R.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(E,R.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(E,R.u_tile_units_to_pixels)}}};function yr(E,R,F,V,ne,le,pe){for(var ye=E.context,Te=ye.gl,Ne=E.useProgram("collisionBox"),Ge=[],nt=0,bt=0,Ct=0;Ct<V.length;Ct++){var Tt=V[Ct],At=R.getTile(Tt),yt=At.getBucket(F);if(yt){var Ft=Tt.posMatrix;ne[0]===0&&ne[1]===0||(Ft=E.translatePosMatrix(Tt.posMatrix,At,ne,le));var zt=pe?yt.textCollisionBox:yt.iconCollisionBox,jt=yt.collisionCircleArray;if(jt.length>0){var rr=e.create(),hr=Ft;e.mul(rr,yt.placementInvProjMatrix,E.transform.glCoordMatrix),e.mul(rr,rr,yt.placementViewportMatrix),Ge.push({circleArray:jt,circleOffset:bt,transform:hr,invTransform:rr}),bt=nt+=jt.length/4}zt&&Ne.draw(ye,Te.LINES,Ke.disabled,_e.disabled,E.colorModeForRenderPass(),Le.disabled,vs(Ft,E.transform,At),F.id,zt.layoutVertexBuffer,zt.indexBuffer,zt.segments,null,E.transform.zoom,null,null,zt.collisionVertexBuffer)}}if(pe&&Ge.length){var Ar=E.useProgram("collisionCircle"),kr=new e.StructArrayLayout2f1f2i16;kr.resize(4*nt),kr._trim();for(var Kr=0,Zr=0,hn=Ge;Zr<hn.length;Zr+=1)for(var sn=hn[Zr],Un=0;Un<sn.circleArray.length/4;Un++){var Wn=4*Un,ua=sn.circleArray[Wn+0],Ur=sn.circleArray[Wn+1],kn=sn.circleArray[Wn+2],Xn=sn.circleArray[Wn+3];kr.emplace(Kr++,ua,Ur,kn,Xn,0),kr.emplace(Kr++,ua,Ur,kn,Xn,1),kr.emplace(Kr++,ua,Ur,kn,Xn,2),kr.emplace(Kr++,ua,Ur,kn,Xn,3)}(!Et||Et.length<2*nt)&&(Et=function(ma){var La=2*ma,ba=new e.StructArrayLayout3ui6;ba.resize(La),ba._trim();for(var Pa=0;Pa<La;Pa++){var Ua=6*Pa;ba.uint16[Ua+0]=4*Pa+0,ba.uint16[Ua+1]=4*Pa+1,ba.uint16[Ua+2]=4*Pa+2,ba.uint16[Ua+3]=4*Pa+2,ba.uint16[Ua+4]=4*Pa+3,ba.uint16[Ua+5]=4*Pa+0}return ba}(nt));for(var Gn=ye.createIndexBuffer(Et,!0),ea=ye.createVertexBuffer(kr,e.collisionCircleLayout.members,!0),fa=0,Ma=Ge;fa<Ma.length;fa+=1){var Kn=Ma[fa],xa=So(Kn.transform,Kn.invTransform,E.transform);Ar.draw(ye,Te.TRIANGLES,Ke.disabled,_e.disabled,E.colorModeForRenderPass(),Le.disabled,xa,F.id,ea,Gn,e.SegmentVector.simpleSegment(0,2*Kn.circleOffset,Kn.circleArray.length,Kn.circleArray.length/2),null,E.transform.zoom,null,null,null)}ea.destroy(),Gn.destroy()}}var Or=e.identity(new Float32Array(16));function nn(E,R,F,V,ne,le){var pe=e.getAnchorAlignment(E),ye=-(pe.horizontalAlign-.5)*R,Te=-(pe.verticalAlign-.5)*F,Ne=e.evaluateVariableOffset(E,V);return new e.Point((ye/ne+Ne[0])*le,(Te/ne+Ne[1])*le)}function gn(E,R,F,V,ne,le,pe,ye,Te,Ne,Ge){var nt=E.text.placedSymbolArray,bt=E.text.dynamicLayoutVertexArray,Ct=E.icon.dynamicLayoutVertexArray,Tt={};bt.clear();for(var At=0;At<nt.length;At++){var yt=nt.get(At),Ft=E.allowVerticalPlacement&&!yt.placedOrientation,zt=yt.hidden||!yt.crossTileID||Ft?null:V[yt.crossTileID];if(zt){var jt=new e.Point(yt.anchorX,yt.anchorY),rr=ur(jt,F?ye:pe),hr=pr(le.cameraToCenterDistance,rr.signedDistanceFromCamera),Ar=ne.evaluateSizeForFeature(E.textSizeData,Ne,yt)*hr/e.ONE_EM;F&&(Ar*=E.tilePixelRatio/Te);for(var kr=zt.width,Kr=zt.height,Zr=nn(zt.anchor,kr,Kr,zt.textOffset,zt.textBoxScale,Ar),hn=F?ur(jt.add(Zr),pe).point:rr.point.add(R?Zr.rotate(-le.angle):Zr),sn=E.allowVerticalPlacement&&yt.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,Un=0;Un<yt.numGlyphs;Un++)e.addDynamicAttributes(bt,hn,sn);Ge&&yt.associatedIconIndex>=0&&(Tt[yt.associatedIconIndex]={shiftedAnchor:hn,angle:sn})}else Sn(yt.numGlyphs,bt)}if(Ge){Ct.clear();for(var Wn=E.icon.placedSymbolArray,ua=0;ua<Wn.length;ua++){var Ur=Wn.get(ua);if(Ur.hidden)Sn(Ur.numGlyphs,Ct);else{var kn=Tt[ua];if(kn)for(var Xn=0;Xn<Ur.numGlyphs;Xn++)e.addDynamicAttributes(Ct,kn.shiftedAnchor,kn.angle);else Sn(Ur.numGlyphs,Ct)}}E.icon.dynamicLayoutVertexBuffer.updateData(Ct)}E.text.dynamicLayoutVertexBuffer.updateData(bt)}function Cn(E,R,F){return F.iconsInText&&R?"symbolTextAndIcon":E?"symbolSDF":"symbolIcon"}function Dn(E,R,F,V,ne,le,pe,ye,Te,Ne,Ge,nt){for(var bt=E.context,Ct=bt.gl,Tt=E.transform,At=ye==="map",yt=Te==="map",Ft=At&&F.layout.get("symbol-placement")!=="point",zt=At&&!yt&&!Ft,jt=F.layout.get("symbol-sort-key").constantOr(1)!==void 0,rr=E.depthModeForSublayer(0,Ke.ReadOnly),hr=F.layout.get("text-variable-anchor"),Ar=[],kr=0,Kr=V;kr<Kr.length;kr+=1){var Zr=Kr[kr],hn=R.getTile(Zr),sn=hn.getBucket(F);if(sn){var Un=ne?sn.text:sn.icon;if(Un&&Un.segments.get().length){var Wn=Un.programConfigurations.get(F.id),ua=ne||sn.sdfIcons,Ur=ne?sn.textSizeData:sn.iconSizeData,kn=yt||Tt.pitch!==0,Xn=E.useProgram(Cn(ua,ne,sn),Wn),Gn=e.evaluateSizeForZoom(Ur,Tt.zoom),ea=void 0,fa=[0,0],Ma=void 0,Kn=void 0,xa=null,ma=void 0;if(ne){if(Ma=hn.glyphAtlasTexture,Kn=Ct.LINEAR,ea=hn.glyphAtlasTexture.size,sn.iconsInText){fa=hn.imageAtlasTexture.size,xa=hn.imageAtlasTexture;var La=Ur.kind==="composite"||Ur.kind==="camera";ma=kn||E.options.rotating||E.options.zooming||La?Ct.LINEAR:Ct.NEAREST}}else{var ba=F.layout.get("icon-size").constantOr(0)!==1||sn.iconsNeedLinear;Ma=hn.imageAtlasTexture,Kn=ua||E.options.rotating||E.options.zooming||ba||kn?Ct.LINEAR:Ct.NEAREST,ea=hn.imageAtlasTexture.size}var Pa=Pr(hn,1,E.transform.zoom),Ua=dr(Zr.posMatrix,yt,At,E.transform,Pa),di=vr(Zr.posMatrix,yt,At,E.transform,Pa),zi=hr&&sn.hasTextData(),Ri=F.layout.get("icon-text-fit")!=="none"&&zi&&sn.hasIconData();Ft&&Rr(sn,Zr.posMatrix,E,ne,Ua,di,yt,Ne);var pi=E.translatePosMatrix(Zr.posMatrix,hn,le,pe),Ei=Ft||ne&&hr||Ri?Or:Ua,xi=E.translatePosMatrix(di,hn,le,pe,!0),Lo=ua&&F.paint.get(ne?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Ki={program:Xn,buffers:Un,uniformValues:ua?sn.iconsInText?Yt(Ur.kind,Gn,zt,yt,E,pi,Ei,xi,ea,fa):$t(Ur.kind,Gn,zt,yt,E,pi,Ei,xi,ne,ea,!0):Zt(Ur.kind,Gn,zt,yt,E,pi,Ei,xi,ne,ea),atlasTexture:Ma,atlasTextureIcon:xa,atlasInterpolation:Kn,atlasInterpolationIcon:ma,isSDF:ua,hasHalo:Lo};if(jt)for(var Zo=0,qs=Un.segments.get();Zo<qs.length;Zo+=1){var yl=qs[Zo];Ar.push({segments:new e.SegmentVector([yl]),sortKey:yl.sortKey,state:Ki})}else Ar.push({segments:Un.segments,sortKey:0,state:Ki})}}}jt&&Ar.sort(function($l,_s){return $l.sortKey-_s.sortKey});for(var Jl=0,zl=Ar;Jl<zl.length;Jl+=1){var Rl=zl[Jl],Po=Rl.state;if(bt.activeTexture.set(Ct.TEXTURE0),Po.atlasTexture.bind(Po.atlasInterpolation,Ct.CLAMP_TO_EDGE),Po.atlasTextureIcon&&(bt.activeTexture.set(Ct.TEXTURE1),Po.atlasTextureIcon&&Po.atlasTextureIcon.bind(Po.atlasInterpolationIcon,Ct.CLAMP_TO_EDGE)),Po.isSDF){var Tl=Po.uniformValues;Po.hasHalo&&(Tl.u_is_halo=1,Hn(Po.buffers,Rl.segments,F,E,Po.program,rr,Ge,nt,Tl)),Tl.u_is_halo=0}Hn(Po.buffers,Rl.segments,F,E,Po.program,rr,Ge,nt,Po.uniformValues)}}function Hn(E,R,F,V,ne,le,pe,ye,Te){var Ne=V.context,Ge=Ne.gl;ne.draw(Ne,Ge.TRIANGLES,le,pe,ye,Le.disabled,Te,F.id,E.layoutVertexBuffer,E.indexBuffer,R,F.paint,V.transform.zoom,E.programConfigurations.get(F.id),E.dynamicLayoutVertexBuffer,E.opacityVertexBuffer)}function zn(E,R,F,V,ne,le,pe){var ye,Te,Ne,Ge,nt,bt=E.context.gl,Ct=F.paint.get("fill-pattern"),Tt=Ct&&Ct.constantOr(1),At=F.getCrossfadeParameters();pe?(Te=Tt&&!F.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ye=bt.LINES):(Te=Tt?"fillPattern":"fill",ye=bt.TRIANGLES);for(var yt=0,Ft=V;yt<Ft.length;yt+=1){var zt=Ft[yt],jt=R.getTile(zt);if(!Tt||jt.patternsLoaded()){var rr=jt.getBucket(F);if(rr){var hr=rr.programConfigurations.get(F.id),Ar=E.useProgram(Te,hr);Tt&&(E.context.activeTexture.set(bt.TEXTURE0),jt.imageAtlasTexture.bind(bt.LINEAR,bt.CLAMP_TO_EDGE),hr.updatePaintBuffers(At));var kr=Ct.constantOr(null);if(kr&&jt.imageAtlas){var Kr=jt.imageAtlas,Zr=Kr.patternPositions[kr.to.toString()],hn=Kr.patternPositions[kr.from.toString()];Zr&&hn&&hr.setConstantPatternPositions(Zr,hn)}var sn=E.translatePosMatrix(zt.posMatrix,jt,F.paint.get("fill-translate"),F.paint.get("fill-translate-anchor"));if(pe){Ge=rr.indexBuffer2,nt=rr.segments2;var Un=[bt.drawingBufferWidth,bt.drawingBufferHeight];Ne=Te==="fillOutlinePattern"&&Tt?rs(sn,E,At,jt,Un):ts(sn,Un)}else Ge=rr.indexBuffer,nt=rr.segments,Ne=Tt?Vo(sn,E,At,jt):Uo(sn);Ar.draw(E.context,ye,ne,E.stencilModeForClipping(zt),le,Le.disabled,Ne,F.id,rr.layoutVertexBuffer,Ge,nt,F.paint,E.transform.zoom,hr)}}}}function ga(E,R,F,V,ne,le,pe){for(var ye=E.context,Te=ye.gl,Ne=F.paint.get("fill-extrusion-pattern"),Ge=Ne.constantOr(1),nt=F.getCrossfadeParameters(),bt=F.paint.get("fill-extrusion-opacity"),Ct=0,Tt=V;Ct<Tt.length;Ct+=1){var At=Tt[Ct],yt=R.getTile(At),Ft=yt.getBucket(F);if(Ft){var zt=Ft.programConfigurations.get(F.id),jt=E.useProgram(Ge?"fillExtrusionPattern":"fillExtrusion",zt);Ge&&(E.context.activeTexture.set(Te.TEXTURE0),yt.imageAtlasTexture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE),zt.updatePaintBuffers(nt));var rr=Ne.constantOr(null);if(rr&&yt.imageAtlas){var hr=yt.imageAtlas,Ar=hr.patternPositions[rr.to.toString()],kr=hr.patternPositions[rr.from.toString()];Ar&&kr&&zt.setConstantPatternPositions(Ar,kr)}var Kr=E.translatePosMatrix(At.posMatrix,yt,F.paint.get("fill-extrusion-translate"),F.paint.get("fill-extrusion-translate-anchor")),Zr=F.paint.get("fill-extrusion-vertical-gradient"),hn=Ge?Js(Kr,E,Zr,bt,At,nt,yt):Hs(Kr,E,Zr,bt);jt.draw(ye,ye.gl.TRIANGLES,ne,le,pe,Le.backCCW,hn,F.id,Ft.layoutVertexBuffer,Ft.indexBuffer,Ft.segments,F.paint,E.transform.zoom,zt)}}}function ka(E,R,F,V,ne,le){var pe=E.context,ye=pe.gl,Te=R.fbo;if(Te){var Ne=E.useProgram("hillshade");pe.activeTexture.set(ye.TEXTURE0),ye.bindTexture(ye.TEXTURE_2D,Te.colorAttachment.get());var Ge=function(nt,bt,Ct){var Tt=Ct.paint.get("hillshade-shadow-color"),At=Ct.paint.get("hillshade-highlight-color"),yt=Ct.paint.get("hillshade-accent-color"),Ft=Ct.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ct.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ft-=nt.transform.angle);var zt=!nt.options.moving;return{u_matrix:nt.transform.calculatePosMatrix(bt.tileID.toUnwrapped(),zt),u_image:0,u_latrange:zs(nt,bt.tileID),u_light:[Ct.paint.get("hillshade-exaggeration"),Ft],u_shadow:Tt,u_highlight:At,u_accent:yt}}(E,R,F);Ne.draw(pe,ye.TRIANGLES,V,ne,le,Le.disabled,Ge,F.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments)}}function Ba(E,R,F,V,ne,le,pe){var ye=E.context,Te=ye.gl,Ne=R.dem;if(Ne&&Ne.data){var Ge=Ne.dim,nt=Ne.stride,bt=Ne.getPixels();if(ye.activeTexture.set(Te.TEXTURE1),ye.pixelStoreUnpackPremultiplyAlpha.set(!1),R.demTexture=R.demTexture||E.getTileTexture(nt),R.demTexture){var Ct=R.demTexture;Ct.update(bt,{premultiply:!1}),Ct.bind(Te.NEAREST,Te.CLAMP_TO_EDGE)}else R.demTexture=new e.Texture(ye,bt,Te.RGBA,{premultiply:!1}),R.demTexture.bind(Te.NEAREST,Te.CLAMP_TO_EDGE);ye.activeTexture.set(Te.TEXTURE0);var Tt=R.fbo;if(!Tt){var At=new e.Texture(ye,{width:Ge,height:Ge,data:null},Te.RGBA);At.bind(Te.LINEAR,Te.CLAMP_TO_EDGE),(Tt=R.fbo=ye.createFramebuffer(Ge,Ge,!0)).colorAttachment.set(At.texture)}ye.bindFramebuffer.set(Tt.framebuffer),ye.viewport.set([0,0,Ge,Ge]),E.useProgram("hillshadePrepare").draw(ye,Te.TRIANGLES,ne,le,pe,Le.disabled,function(yt,Ft,zt){var jt=Ft.stride,rr=e.create();return e.ortho(rr,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(rr,rr,[0,-e.EXTENT,0]),{u_matrix:rr,u_image:1,u_dimension:[jt,jt],u_zoom:yt.overscaledZ,u_maxzoom:zt,u_unpack:Ft.getUnpackVector()}}(R.tileID,Ne,V),F.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments),R.needsHillshadePrepare=!1}}function Fa(E,R,F,V,ne){var le=V.paint.get("raster-fade-duration");if(le>0){var pe=e.browser.now(),ye=(pe-E.timeAdded)/le,Te=R?(pe-R.timeAdded)/le:-1,Ne=F.getSource(),Ge=ne.coveringZoomLevel({tileSize:Ne.tileSize,roundZoom:Ne.roundZoom}),nt=!R||Math.abs(R.tileID.overscaledZ-Ge)>Math.abs(E.tileID.overscaledZ-Ge),bt=nt&&E.refreshedUponExpiration?1:e.clamp(nt?ye:1-Te,0,1);return E.refreshedUponExpiration&&ye>=1&&(E.refreshedUponExpiration=!1),R?{opacity:1,mix:1-bt}:{opacity:bt,mix:0}}return{opacity:1,mix:0}}var ja=new e.Color(1,0,0,1),Mi=new e.Color(0,1,0,1),wi=new e.Color(0,0,1,1),ui=new e.Color(1,0,1,1),ci=new e.Color(0,1,1,1);function Ti(E){var R=E.transform.padding;Vi(E,E.transform.height-(R.top||0),3,ja),Vi(E,R.bottom||0,3,Mi),no(E,R.left||0,3,wi),no(E,E.transform.width-(R.right||0),3,ui);var F=E.transform.centerPoint;(function(V,ne,le,pe){ao(V,ne-1,le-10,2,20,pe),ao(V,ne-10,le-1,20,2,pe)})(E,F.x,E.transform.height-F.y,ci)}function Vi(E,R,F,V){ao(E,0,R+F/2,E.transform.width,F,V)}function no(E,R,F,V){ao(E,R-F/2,0,F,E.transform.height,V)}function ao(E,R,F,V,ne,le){var pe=E.context,ye=pe.gl;ye.enable(ye.SCISSOR_TEST),ye.scissor(R*e.browser.devicePixelRatio,F*e.browser.devicePixelRatio,V*e.browser.devicePixelRatio,ne*e.browser.devicePixelRatio),pe.clear({color:le}),ye.disable(ye.SCISSOR_TEST)}function io(E,R,F){var V=E.context,ne=V.gl,le=F.posMatrix,pe=E.useProgram("debug"),ye=Ke.disabled,Te=_e.disabled,Ne=E.colorModeForRenderPass();V.activeTexture.set(ne.TEXTURE0),E.emptyTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),pe.draw(V,ne.LINE_STRIP,ye,Te,Ne,Le.disabled,Ds(le,e.Color.red),"$debug",E.debugBuffer,E.tileBorderIndexBuffer,E.debugSegments);var Ge=R.getTileByID(F.key).latestRawTileData,nt=Ge&&Ge.byteLength||0,bt=Math.floor(nt/1024),Ct=R.getTile(F).tileSize,Tt=512/Math.min(Ct,512)*(F.overscaledZ/E.transform.zoom)*.5,At=F.canonical.toString();F.overscaledZ!==F.canonical.z&&(At+=" => "+F.overscaledZ),function(yt,Ft){yt.initDebugOverlayCanvas();var zt=yt.debugOverlayCanvas,jt=yt.context.gl,rr=yt.debugOverlayCanvas.getContext("2d");rr.clearRect(0,0,zt.width,zt.height),rr.shadowColor="white",rr.shadowBlur=2,rr.lineWidth=1.5,rr.strokeStyle="white",rr.textBaseline="top",rr.font="bold 36px Open Sans, sans-serif",rr.fillText(Ft,5,5),rr.strokeText(Ft,5,5),yt.debugOverlayTexture.update(zt),yt.debugOverlayTexture.bind(jt.LINEAR,jt.CLAMP_TO_EDGE)}(E,At+" "+bt+"kb"),pe.draw(V,ne.TRIANGLES,ye,Te,Ce.alphaBlended,Le.disabled,Ds(le,e.Color.transparent,Tt),"$debug",E.debugBuffer,E.quadTriangleIndexBuffer,E.debugSegments)}var oo={symbol:function(E,R,F,V,ne){if(E.renderPass==="translucent"){var le=_e.disabled,pe=E.colorModeForRenderPass();F.layout.get("text-variable-anchor")&&function(ye,Te,Ne,Ge,nt,bt,Ct){for(var Tt=Te.transform,At=nt==="map",yt=bt==="map",Ft=0,zt=ye;Ft<zt.length;Ft+=1){var jt=zt[Ft],rr=Ge.getTile(jt),hr=rr.getBucket(Ne);if(hr&&hr.text&&hr.text.segments.get().length){var Ar=hr.textSizeData,kr=e.evaluateSizeForZoom(Ar,Tt.zoom),Kr=Pr(rr,1,Te.transform.zoom),Zr=dr(jt.posMatrix,yt,At,Te.transform,Kr),hn=Ne.layout.get("icon-text-fit")!=="none"&&hr.hasIconData();if(kr){var sn=Math.pow(2,Tt.zoom-rr.tileID.overscaledZ);gn(hr,At,yt,Ct,e.symbolSize,Tt,Zr,jt.posMatrix,sn,kr,hn)}}}}(V,E,F,R,F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),ne),F.paint.get("icon-opacity").constantOr(1)!==0&&Dn(E,R,F,V,!1,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),F.layout.get("icon-rotation-alignment"),F.layout.get("icon-pitch-alignment"),F.layout.get("icon-keep-upright"),le,pe),F.paint.get("text-opacity").constantOr(1)!==0&&Dn(E,R,F,V,!0,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.layout.get("text-keep-upright"),le,pe),R.map.showCollisionBoxes&&(yr(E,R,F,V,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),!0),yr(E,R,F,V,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),!1))}},circle:function(E,R,F,V){if(E.renderPass==="translucent"){var ne=F.paint.get("circle-opacity"),le=F.paint.get("circle-stroke-width"),pe=F.paint.get("circle-stroke-opacity"),ye=F.layout.get("circle-sort-key").constantOr(1)!==void 0;if(ne.constantOr(1)!==0||le.constantOr(1)!==0&&pe.constantOr(1)!==0){for(var Te=E.context,Ne=Te.gl,Ge=E.depthModeForSublayer(0,Ke.ReadOnly),nt=_e.disabled,bt=E.colorModeForRenderPass(),Ct=[],Tt=0;Tt<V.length;Tt++){var At=V[Tt],yt=R.getTile(At),Ft=yt.getBucket(F);if(Ft){var zt=Ft.programConfigurations.get(F.id),jt={programConfiguration:zt,program:E.useProgram("circle",zt),layoutVertexBuffer:Ft.layoutVertexBuffer,indexBuffer:Ft.indexBuffer,uniformValues:ns(E,At,yt,F)};if(ye)for(var rr=0,hr=Ft.segments.get();rr<hr.length;rr+=1){var Ar=hr[rr];Ct.push({segments:new e.SegmentVector([Ar]),sortKey:Ar.sortKey,state:jt})}else Ct.push({segments:Ft.segments,sortKey:0,state:jt})}}ye&&Ct.sort(function(Xn,Gn){return Xn.sortKey-Gn.sortKey});for(var kr=0,Kr=Ct;kr<Kr.length;kr+=1){var Zr=Kr[kr],hn=Zr.state,sn=hn.programConfiguration,Un=hn.program,Wn=hn.layoutVertexBuffer,ua=hn.indexBuffer,Ur=hn.uniformValues,kn=Zr.segments;Un.draw(Te,Ne.TRIANGLES,Ge,nt,bt,Le.disabled,Ur,F.id,Wn,ua,kn,F.paint,E.transform.zoom,sn)}}}},heatmap:function(E,R,F,V){if(F.paint.get("heatmap-opacity")!==0)if(E.renderPass==="offscreen"){var ne=E.context,le=ne.gl,pe=_e.disabled,ye=new Ce([le.ONE,le.ONE],e.Color.transparent,[!0,!0,!0,!0]);(function(At,yt,Ft){var zt=At.gl;At.activeTexture.set(zt.TEXTURE1),At.viewport.set([0,0,yt.width/4,yt.height/4]);var jt=Ft.heatmapFbo;if(jt)zt.bindTexture(zt.TEXTURE_2D,jt.colorAttachment.get()),At.bindFramebuffer.set(jt.framebuffer);else{var rr=zt.createTexture();zt.bindTexture(zt.TEXTURE_2D,rr),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_WRAP_S,zt.CLAMP_TO_EDGE),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_WRAP_T,zt.CLAMP_TO_EDGE),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_MIN_FILTER,zt.LINEAR),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_MAG_FILTER,zt.LINEAR),jt=Ft.heatmapFbo=At.createFramebuffer(yt.width/4,yt.height/4,!1),function(hr,Ar,kr,Kr){var Zr=hr.gl,hn=hr.extRenderToTextureHalfFloat?hr.extTextureHalfFloat.HALF_FLOAT_OES:Zr.UNSIGNED_BYTE;Zr.texImage2D(Zr.TEXTURE_2D,0,Zr.RGBA,Ar.width/4,Ar.height/4,0,Zr.RGBA,hn,null),Kr.colorAttachment.set(kr)}(At,yt,rr,jt)}})(ne,E,F),ne.clear({color:e.Color.transparent});for(var Te=0;Te<V.length;Te++){var Ne=V[Te];if(!R.hasRenderableParent(Ne)){var Ge=R.getTile(Ne),nt=Ge.getBucket(F);if(nt){var bt=nt.programConfigurations.get(F.id),Ct=E.useProgram("heatmap",bt),Tt=E.transform.zoom;Ct.draw(ne,le.TRIANGLES,Ke.disabled,pe,ye,Le.disabled,as(Ne.posMatrix,Ge,Tt,F.paint.get("heatmap-intensity")),F.id,nt.layoutVertexBuffer,nt.indexBuffer,nt.segments,F.paint,E.transform.zoom,bt)}}}ne.viewport.set([0,0,E.width,E.height])}else E.renderPass==="translucent"&&(E.context.setColorMode(E.colorModeForRenderPass()),function(At,yt){var Ft=At.context,zt=Ft.gl,jt=yt.heatmapFbo;if(!!jt){Ft.activeTexture.set(zt.TEXTURE0),zt.bindTexture(zt.TEXTURE_2D,jt.colorAttachment.get()),Ft.activeTexture.set(zt.TEXTURE1);var rr=yt.colorRampTexture;rr||(rr=yt.colorRampTexture=new e.Texture(Ft,yt.colorRamp,zt.RGBA)),rr.bind(zt.LINEAR,zt.CLAMP_TO_EDGE),At.useProgram("heatmapTexture").draw(Ft,zt.TRIANGLES,Ke.disabled,_e.disabled,At.colorModeForRenderPass(),Le.disabled,function(hr,Ar,kr,Kr){var Zr=e.create();e.ortho(Zr,0,hr.width,hr.height,0,0,1);var hn=hr.context.gl;return{u_matrix:Zr,u_world:[hn.drawingBufferWidth,hn.drawingBufferHeight],u_image:kr,u_color_ramp:Kr,u_opacity:Ar.paint.get("heatmap-opacity")}}(At,yt,0,1),yt.id,At.viewportBuffer,At.quadTriangleIndexBuffer,At.viewportSegments,yt.paint,At.transform.zoom)}}(E,F))},line:function(E,R,F,V){if(E.renderPass==="translucent"){var ne=F.paint.get("line-opacity"),le=F.paint.get("line-width");if(ne.constantOr(1)!==0&&le.constantOr(1)!==0){var pe=E.depthModeForSublayer(0,Ke.ReadOnly),ye=E.colorModeForRenderPass(),Te=F.paint.get("line-dasharray"),Ne=F.paint.get("line-pattern"),Ge=Ne.constantOr(1),nt=F.paint.get("line-gradient"),bt=F.getCrossfadeParameters(),Ct=Ge?"linePattern":Te?"lineSDF":nt?"lineGradient":"line",Tt=E.context,At=Tt.gl,yt=!0;if(nt){Tt.activeTexture.set(At.TEXTURE0);var Ft=F.gradientTexture;if(!F.gradient)return;Ft||(Ft=F.gradientTexture=new e.Texture(Tt,F.gradient,At.RGBA)),Ft.bind(At.LINEAR,At.CLAMP_TO_EDGE)}for(var zt=0,jt=V;zt<jt.length;zt+=1){var rr=jt[zt],hr=R.getTile(rr);if(!Ge||hr.patternsLoaded()){var Ar=hr.getBucket(F);if(Ar){var kr=Ar.programConfigurations.get(F.id),Kr=E.context.program.get(),Zr=E.useProgram(Ct,kr),hn=yt||Zr.program!==Kr,sn=Ne.constantOr(null);if(sn&&hr.imageAtlas){var Un=hr.imageAtlas,Wn=Un.patternPositions[sn.to.toString()],ua=Un.patternPositions[sn.from.toString()];Wn&&ua&&kr.setConstantPatternPositions(Wn,ua)}var Ur=Ge?Re(E,hr,F,bt):Te?Ve(E,hr,F,Te,bt):nt?qa(E,hr,F):Ho(E,hr,F);Ge?(Tt.activeTexture.set(At.TEXTURE0),hr.imageAtlasTexture.bind(At.LINEAR,At.CLAMP_TO_EDGE),kr.updatePaintBuffers(bt)):Te&&(hn||E.lineAtlas.dirty)&&(Tt.activeTexture.set(At.TEXTURE0),E.lineAtlas.bind(Tt)),Zr.draw(Tt,At.TRIANGLES,pe,E.stencilModeForClipping(rr),ye,Le.disabled,Ur,F.id,Ar.layoutVertexBuffer,Ar.indexBuffer,Ar.segments,F.paint,E.transform.zoom,kr),yt=!1}}}}}},fill:function(E,R,F,V){var ne=F.paint.get("fill-color"),le=F.paint.get("fill-opacity");if(le.constantOr(1)!==0){var pe=E.colorModeForRenderPass(),ye=F.paint.get("fill-pattern"),Te=E.opaquePassEnabledForLayer()&&!ye.constantOr(1)&&ne.constantOr(e.Color.transparent).a===1&&le.constantOr(0)===1?"opaque":"translucent";if(E.renderPass===Te){var Ne=E.depthModeForSublayer(1,E.renderPass==="opaque"?Ke.ReadWrite:Ke.ReadOnly);zn(E,R,F,V,Ne,pe,!1)}if(E.renderPass==="translucent"&&F.paint.get("fill-antialias")){var Ge=E.depthModeForSublayer(F.getPaintProperty("fill-outline-color")?2:0,Ke.ReadOnly);zn(E,R,F,V,Ge,pe,!0)}}},"fill-extrusion":function(E,R,F,V){var ne=F.paint.get("fill-extrusion-opacity");if(ne!==0&&E.renderPass==="translucent"){var le=new Ke(E.context.gl.LEQUAL,Ke.ReadWrite,E.depthRangeFor3D);if(ne!==1||F.paint.get("fill-extrusion-pattern").constantOr(1))ga(E,R,F,V,le,_e.disabled,Ce.disabled),ga(E,R,F,V,le,E.stencilModeFor3D(),E.colorModeForRenderPass());else{var pe=E.colorModeForRenderPass();ga(E,R,F,V,le,_e.disabled,pe)}}},hillshade:function(E,R,F,V){if(E.renderPass==="offscreen"||E.renderPass==="translucent"){for(var ne=E.context,le=R.getSource().maxzoom,pe=E.depthModeForSublayer(0,Ke.ReadOnly),ye=E.colorModeForRenderPass(),Te=E.renderPass==="translucent"?E.stencilConfigForOverlap(V):[{},V],Ne=Te[0],Ge=0,nt=Te[1];Ge<nt.length;Ge+=1){var bt=nt[Ge],Ct=R.getTile(bt);Ct.needsHillshadePrepare&&E.renderPass==="offscreen"?Ba(E,Ct,F,le,pe,_e.disabled,ye):E.renderPass==="translucent"&&ka(E,Ct,F,pe,Ne[bt.overscaledZ],ye)}ne.viewport.set([0,0,E.width,E.height])}},raster:function(E,R,F,V){if(E.renderPass==="translucent"&&F.paint.get("raster-opacity")!==0&&V.length)for(var ne=E.context,le=ne.gl,pe=R.getSource(),ye=E.useProgram("raster"),Te=E.colorModeForRenderPass(),Ne=pe instanceof H?[{},V]:E.stencilConfigForOverlap(V),Ge=Ne[0],nt=Ne[1],bt=nt[nt.length-1].overscaledZ,Ct=!E.options.moving,Tt=0,At=nt;Tt<At.length;Tt+=1){var yt=At[Tt],Ft=E.depthModeForSublayer(yt.overscaledZ-bt,F.paint.get("raster-opacity")===1?Ke.ReadWrite:Ke.ReadOnly,le.LESS),zt=R.getTile(yt),jt=E.transform.calculatePosMatrix(yt.toUnwrapped(),Ct);zt.registerFadeDuration(F.paint.get("raster-fade-duration"));var rr=R.findLoadedParent(yt,0),hr=Fa(zt,rr,R,F,E.transform),Ar=void 0,kr=void 0,Kr=F.paint.get("raster-resampling")==="nearest"?le.NEAREST:le.LINEAR;ne.activeTexture.set(le.TEXTURE0),zt.texture.bind(Kr,le.CLAMP_TO_EDGE,le.LINEAR_MIPMAP_NEAREST),ne.activeTexture.set(le.TEXTURE1),rr?(rr.texture.bind(Kr,le.CLAMP_TO_EDGE,le.LINEAR_MIPMAP_NEAREST),Ar=Math.pow(2,rr.tileID.overscaledZ-zt.tileID.overscaledZ),kr=[zt.tileID.canonical.x*Ar%1,zt.tileID.canonical.y*Ar%1]):zt.texture.bind(Kr,le.CLAMP_TO_EDGE,le.LINEAR_MIPMAP_NEAREST);var Zr=mt(jt,kr||[0,0],Ar||1,hr,F);pe instanceof H?ye.draw(ne,le.TRIANGLES,Ft,_e.disabled,Te,Le.disabled,Zr,F.id,pe.boundsBuffer,E.quadTriangleIndexBuffer,pe.boundsSegments):ye.draw(ne,le.TRIANGLES,Ft,Ge[yt.overscaledZ],Te,Le.disabled,Zr,F.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments)}},background:function(E,R,F){var V=F.paint.get("background-color"),ne=F.paint.get("background-opacity");if(ne!==0){var le=E.context,pe=le.gl,ye=E.transform,Te=ye.tileSize,Ne=F.paint.get("background-pattern");if(!E.isPatternMissing(Ne)){var Ge=!Ne&&V.a===1&&ne===1&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass===Ge){var nt=_e.disabled,bt=E.depthModeForSublayer(0,Ge==="opaque"?Ke.ReadWrite:Ke.ReadOnly),Ct=E.colorModeForRenderPass(),Tt=E.useProgram(Ne?"backgroundPattern":"background"),At=ye.coveringTiles({tileSize:Te});Ne&&(le.activeTexture.set(pe.TEXTURE0),E.imageManager.bind(E.context));for(var yt=F.getCrossfadeParameters(),Ft=0,zt=At;Ft<zt.length;Ft+=1){var jt=zt[Ft],rr=E.transform.calculatePosMatrix(jt.toUnwrapped()),hr=Ne?cr(rr,ne,E,Ne,{tileID:jt,tileSize:Te},yt):nr(rr,ne,V);Tt.draw(le,pe.TRIANGLES,bt,nt,Ct,Le.disabled,hr,F.id,E.tileExtentBuffer,E.quadTriangleIndexBuffer,E.tileExtentSegments)}}}}},debug:function(E,R,F){for(var V=0;V<F.length;V++)io(E,R,F[V])},custom:function(E,R,F){var V=E.context,ne=F.implementation;if(E.renderPass==="offscreen"){var le=ne.prerender;le&&(E.setCustomLayerDefaults(),V.setColorMode(E.colorModeForRenderPass()),le.call(ne,V.gl,E.transform.customLayerMatrix()),V.setDirty(),E.setBaseState())}else if(E.renderPass==="translucent"){E.setCustomLayerDefaults(),V.setColorMode(E.colorModeForRenderPass()),V.setStencilMode(_e.disabled);var pe=ne.renderingMode==="3d"?new Ke(E.context.gl.LEQUAL,Ke.ReadWrite,E.depthRangeFor3D):E.depthModeForSublayer(0,Ke.ReadOnly);V.setDepthMode(pe),ne.render(V.gl,E.transform.customLayerMatrix()),V.setDirty(),E.setBaseState(),V.bindFramebuffer.set(null)}}},Oa=function(E,R){this.context=new Pe(E),this.transform=R,this._tileTextures={},this.setup(),this.numSublayers=Xe.maxUnderzooming+Xe.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Wr,this.gpuTimers={}};Oa.prototype.resize=function(E,R){if(this.width=E*e.browser.devicePixelRatio,this.height=R*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var F=0,V=this.style._order;F<V.length;F+=1){var ne=V[F];this.style._layers[ne].resize()}},Oa.prototype.setup=function(){var E=this.context,R=new e.StructArrayLayout2i4;R.emplaceBack(0,0),R.emplaceBack(e.EXTENT,0),R.emplaceBack(0,e.EXTENT),R.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=E.createVertexBuffer(R,yn.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var F=new e.StructArrayLayout2i4;F.emplaceBack(0,0),F.emplaceBack(e.EXTENT,0),F.emplaceBack(0,e.EXTENT),F.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=E.createVertexBuffer(F,yn.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var V=new e.StructArrayLayout4i8;V.emplaceBack(0,0,0,0),V.emplaceBack(e.EXTENT,0,e.EXTENT,0),V.emplaceBack(0,e.EXTENT,0,e.EXTENT),V.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=E.createVertexBuffer(V,Z.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var ne=new e.StructArrayLayout2i4;ne.emplaceBack(0,0),ne.emplaceBack(1,0),ne.emplaceBack(0,1),ne.emplaceBack(1,1),this.viewportBuffer=E.createVertexBuffer(ne,yn.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var le=new e.StructArrayLayout1ui2;le.emplaceBack(0),le.emplaceBack(1),le.emplaceBack(3),le.emplaceBack(2),le.emplaceBack(0),this.tileBorderIndexBuffer=E.createIndexBuffer(le);var pe=new e.StructArrayLayout3ui6;pe.emplaceBack(0,1,2),pe.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=E.createIndexBuffer(pe),this.emptyTexture=new e.Texture(E,{width:1,height:1,data:new Uint8Array([0,0,0,0])},E.gl.RGBA);var ye=this.context.gl;this.stencilClearMode=new _e({func:ye.ALWAYS,mask:0},0,255,ye.ZERO,ye.ZERO,ye.ZERO)},Oa.prototype.clearStencil=function(){var E=this.context,R=E.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var F=e.create();e.ortho(F,0,this.width,this.height,0,0,1),e.scale(F,F,[R.drawingBufferWidth,R.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(E,R.TRIANGLES,Ke.disabled,this.stencilClearMode,Ce.disabled,Le.disabled,vo(F),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Oa.prototype._renderTileClippingMasks=function(E,R){if(this.currentStencilSource!==E.source&&E.isTileClipped()&&R&&R.length){this.currentStencilSource=E.source;var F=this.context,V=F.gl;this.nextStencilID+R.length>256&&this.clearStencil(),F.setColorMode(Ce.disabled),F.setDepthMode(Ke.disabled);var ne=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var le=0,pe=R;le<pe.length;le+=1){var ye=pe[le],Te=this._tileClippingMaskIDs[ye.key]=this.nextStencilID++;ne.draw(F,V.TRIANGLES,Ke.disabled,new _e({func:V.ALWAYS,mask:0},Te,255,V.KEEP,V.KEEP,V.REPLACE),Ce.disabled,Le.disabled,vo(ye.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Oa.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var E=this.nextStencilID++,R=this.context.gl;return new _e({func:R.NOTEQUAL,mask:255},E,255,R.KEEP,R.KEEP,R.REPLACE)},Oa.prototype.stencilModeForClipping=function(E){var R=this.context.gl;return new _e({func:R.EQUAL,mask:255},this._tileClippingMaskIDs[E.key],0,R.KEEP,R.KEEP,R.REPLACE)},Oa.prototype.stencilConfigForOverlap=function(E){var R,F=this.context.gl,V=E.sort(function(Te,Ne){return Ne.overscaledZ-Te.overscaledZ}),ne=V[V.length-1].overscaledZ,le=V[0].overscaledZ-ne+1;if(le>1){this.currentStencilSource=void 0,this.nextStencilID+le>256&&this.clearStencil();for(var pe={},ye=0;ye<le;ye++)pe[ye+ne]=new _e({func:F.GEQUAL,mask:255},ye+this.nextStencilID,255,F.KEEP,F.KEEP,F.REPLACE);return this.nextStencilID+=le,[pe,V]}return[(R={},R[ne]=_e.disabled,R),V]},Oa.prototype.colorModeForRenderPass=function(){var E=this.context.gl;return this._showOverdrawInspector?new Ce([E.CONSTANT_COLOR,E.ONE],new e.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ce.unblended:Ce.alphaBlended},Oa.prototype.depthModeForSublayer=function(E,R,F){if(!this.opaquePassEnabledForLayer())return Ke.disabled;var V=1-((1+this.currentLayer)*this.numSublayers+E)*this.depthEpsilon;return new Ke(F||this.context.gl.LEQUAL,R,[V,V])},Oa.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Oa.prototype.render=function(E,R){var F=this;this.style=E,this.options=R,this.lineAtlas=E.lineAtlas,this.imageManager=E.imageManager,this.glyphManager=E.glyphManager,this.symbolFadeChange=E.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var V=this.style._order,ne=this.style.sourceCaches;for(var le in ne){var pe=ne[le];pe.used&&pe.prepare(this.context)}var ye,Te,Ne={},Ge={},nt={};for(var bt in ne){var Ct=ne[bt];Ne[bt]=Ct.getVisibleCoordinates(),Ge[bt]=Ne[bt].slice().reverse(),nt[bt]=Ct.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Tt=0;Tt<V.length;Tt++){var At=V[Tt];if(this.style._layers[At].is3D()){this.opaquePassCutoff=Tt;break}}this.renderPass="offscreen";for(var yt=0,Ft=V;yt<Ft.length;yt+=1){var zt=Ft[yt],jt=this.style._layers[zt];if(jt.hasOffscreenPass()&&!jt.isHidden(this.transform.zoom)){var rr=Ge[jt.source];(jt.type==="custom"||rr.length)&&this.renderLayer(this,ne[jt.source],jt,rr)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:R.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=R.showOverdrawInspector,this.depthRangeFor3D=[0,1-(E._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=V.length-1;this.currentLayer>=0;this.currentLayer--){var hr=this.style._layers[V[this.currentLayer]],Ar=ne[hr.source],kr=Ne[hr.source];this._renderTileClippingMasks(hr,kr),this.renderLayer(this,Ar,hr,kr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<V.length;this.currentLayer++){var Kr=this.style._layers[V[this.currentLayer]],Zr=ne[Kr.source],hn=(Kr.type==="symbol"?nt:Ge)[Kr.source];this._renderTileClippingMasks(Kr,Ne[Kr.source]),this.renderLayer(this,Zr,Kr,hn)}this.options.showTileBoundaries&&(e.values(this.style._layers).forEach(function(sn){sn.source&&!sn.isHidden(F.transform.zoom)&&(sn.source!==(Te&&Te.id)&&(Te=F.style.sourceCaches[sn.source]),(!ye||ye.getSource().maxzoom<Te.getSource().maxzoom)&&(ye=Te))}),ye&&oo.debug(this,ye,ye.getVisibleCoordinates())),this.options.showPadding&&Ti(this),this.context.setDefault()},Oa.prototype.renderLayer=function(E,R,F,V){F.isHidden(this.transform.zoom)||(F.type==="background"||F.type==="custom"||V.length)&&(this.id=F.id,this.gpuTimingStart(F),oo[F.type](E,R,F,V,this.style.placement.variableOffsets),this.gpuTimingEnd())},Oa.prototype.gpuTimingStart=function(E){if(this.options.gpuTiming){var R=this.context.extTimerQuery,F=this.gpuTimers[E.id];F||(F=this.gpuTimers[E.id]={calls:0,cpuTime:0,query:R.createQueryEXT()}),F.calls++,R.beginQueryEXT(R.TIME_ELAPSED_EXT,F.query)}},Oa.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var E=this.context.extTimerQuery;E.endQueryEXT(E.TIME_ELAPSED_EXT)}},Oa.prototype.collectGpuTimers=function(){var E=this.gpuTimers;return this.gpuTimers={},E},Oa.prototype.queryGpuTimers=function(E){var R={};for(var F in E){var V=E[F],ne=this.context.extTimerQuery,le=ne.getQueryObjectEXT(V.query,ne.QUERY_RESULT_EXT)/1e6;ne.deleteQueryEXT(V.query),R[F]=le}return R},Oa.prototype.translatePosMatrix=function(E,R,F,V,ne){if(!F[0]&&!F[1])return E;var le=ne?V==="map"?this.transform.angle:0:V==="viewport"?-this.transform.angle:0;if(le){var pe=Math.sin(le),ye=Math.cos(le);F=[F[0]*ye-F[1]*pe,F[0]*pe+F[1]*ye]}var Te=[ne?F[0]:Pr(R,F[0],this.transform.zoom),ne?F[1]:Pr(R,F[1],this.transform.zoom),0],Ne=new Float32Array(16);return e.translate(Ne,E,Te),Ne},Oa.prototype.saveTileTexture=function(E){var R=this._tileTextures[E.size[0]];R?R.push(E):this._tileTextures[E.size[0]]=[E]},Oa.prototype.getTileTexture=function(E){var R=this._tileTextures[E];return R&&R.length>0?R.pop():null},Oa.prototype.isPatternMissing=function(E){if(!E)return!1;if(!E.from||!E.to)return!0;var R=this.imageManager.getPattern(E.from.toString()),F=this.imageManager.getPattern(E.to.toString());return!R||!F},Oa.prototype.useProgram=function(E,R){this.cache=this.cache||{};var F=""+E+(R?R.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[F]||(this.cache[F]=new Zs(this.context,Os[E],R,mr[E],this._showOverdrawInspector)),this.cache[F]},Oa.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Oa.prototype.setBaseState=function(){var E=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(E.FUNC_ADD)},Oa.prototype.initDebugOverlayCanvas=function(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;var E=this.context.gl;this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,E.RGBA)}},Oa.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var ft=function(E,R){this.points=E,this.planes=R};ft.fromInvProjectionMatrix=function(E,R,F){var V=Math.pow(2,F),ne=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(pe){return e.transformMat4([],pe,E)}).map(function(pe){return e.scale$1([],pe,1/pe[3]/R*V)}),le=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(pe){var ye=e.sub([],ne[pe[0]],ne[pe[1]]),Te=e.sub([],ne[pe[2]],ne[pe[1]]),Ne=e.normalize([],e.cross([],ye,Te)),Ge=-e.dot(Ne,ne[pe[1]]);return Ne.concat(Ge)});return new ft(ne,le)};var Rt=function(E,R){this.min=E,this.max=R,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};Rt.prototype.quadrant=function(E){for(var R=[E%2==0,E<2],F=e.clone$2(this.min),V=e.clone$2(this.max),ne=0;ne<R.length;ne++)F[ne]=R[ne]?this.min[ne]:this.center[ne],V[ne]=R[ne]?this.center[ne]:this.max[ne];return V[2]=this.max[2],new Rt(F,V)},Rt.prototype.distanceX=function(E){return Math.max(Math.min(this.max[0],E[0]),this.min[0])-E[0]},Rt.prototype.distanceY=function(E){return Math.max(Math.min(this.max[1],E[1]),this.min[1])-E[1]},Rt.prototype.intersects=function(E){for(var R=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],F=!0,V=0;V<E.planes.length;V++){for(var ne=E.planes[V],le=0,pe=0;pe<R.length;pe++)le+=e.dot$1(ne,R[pe])>=0;if(le===0)return 0;le!==R.length&&(F=!1)}if(F)return 2;for(var ye=0;ye<3;ye++){for(var Te=Number.MAX_VALUE,Ne=-Number.MAX_VALUE,Ge=0;Ge<E.points.length;Ge++){var nt=E.points[Ge][ye]-this.min[ye];Te=Math.min(Te,nt),Ne=Math.max(Ne,nt)}if(Ne<0||Te>this.max[ye]-this.min[ye])return 0}return 1};var sr=function(E,R,F,V){if(E===void 0&&(E=0),R===void 0&&(R=0),F===void 0&&(F=0),V===void 0&&(V=0),isNaN(E)||E<0||isNaN(R)||R<0||isNaN(F)||F<0||isNaN(V)||V<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=E,this.bottom=R,this.left=F,this.right=V};sr.prototype.interpolate=function(E,R,F){return R.top!=null&&E.top!=null&&(this.top=e.number(E.top,R.top,F)),R.bottom!=null&&E.bottom!=null&&(this.bottom=e.number(E.bottom,R.bottom,F)),R.left!=null&&E.left!=null&&(this.left=e.number(E.left,R.left,F)),R.right!=null&&E.right!=null&&(this.right=e.number(E.right,R.right,F)),this},sr.prototype.getCenter=function(E,R){var F=e.clamp((this.left+E-this.right)/2,0,E),V=e.clamp((this.top+R-this.bottom)/2,0,R);return new e.Point(F,V)},sr.prototype.equals=function(E){return this.top===E.top&&this.bottom===E.bottom&&this.left===E.left&&this.right===E.right},sr.prototype.clone=function(){return new sr(this.top,this.bottom,this.left,this.right)},sr.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Vt=function(E,R,F,V,ne){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=ne===void 0||ne,this._minZoom=E||0,this._maxZoom=R||22,this._minPitch=F==null?0:F,this._maxPitch=V==null?60:V,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new sr,this._posMatrixCache={},this._alignedPosMatrixCache={}},lr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Vt.prototype.clone=function(){var E=new Vt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return E.tileSize=this.tileSize,E.latRange=this.latRange,E.width=this.width,E.height=this.height,E._center=this._center,E.zoom=this.zoom,E.angle=this.angle,E._fov=this._fov,E._pitch=this._pitch,E._unmodified=this._unmodified,E._edgeInsets=this._edgeInsets.clone(),E._calcMatrices(),E},lr.minZoom.get=function(){return this._minZoom},lr.minZoom.set=function(E){this._minZoom!==E&&(this._minZoom=E,this.zoom=Math.max(this.zoom,E))},lr.maxZoom.get=function(){return this._maxZoom},lr.maxZoom.set=function(E){this._maxZoom!==E&&(this._maxZoom=E,this.zoom=Math.min(this.zoom,E))},lr.minPitch.get=function(){return this._minPitch},lr.minPitch.set=function(E){this._minPitch!==E&&(this._minPitch=E,this.pitch=Math.max(this.pitch,E))},lr.maxPitch.get=function(){return this._maxPitch},lr.maxPitch.set=function(E){this._maxPitch!==E&&(this._maxPitch=E,this.pitch=Math.min(this.pitch,E))},lr.renderWorldCopies.get=function(){return this._renderWorldCopies},lr.renderWorldCopies.set=function(E){E===void 0?E=!0:E===null&&(E=!1),this._renderWorldCopies=E},lr.worldSize.get=function(){return this.tileSize*this.scale},lr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},lr.size.get=function(){return new e.Point(this.width,this.height)},lr.bearing.get=function(){return-this.angle/Math.PI*180},lr.bearing.set=function(E){var R=-e.wrap(E,-180,180)*Math.PI/180;this.angle!==R&&(this._unmodified=!1,this.angle=R,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},lr.pitch.get=function(){return this._pitch/Math.PI*180},lr.pitch.set=function(E){var R=e.clamp(E,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==R&&(this._unmodified=!1,this._pitch=R,this._calcMatrices())},lr.fov.get=function(){return this._fov/Math.PI*180},lr.fov.set=function(E){E=Math.max(.01,Math.min(60,E)),this._fov!==E&&(this._unmodified=!1,this._fov=E/180*Math.PI,this._calcMatrices())},lr.zoom.get=function(){return this._zoom},lr.zoom.set=function(E){var R=Math.min(Math.max(E,this.minZoom),this.maxZoom);this._zoom!==R&&(this._unmodified=!1,this._zoom=R,this.scale=this.zoomScale(R),this.tileZoom=Math.floor(R),this.zoomFraction=R-this.tileZoom,this._constrain(),this._calcMatrices())},lr.center.get=function(){return this._center},lr.center.set=function(E){E.lat===this._center.lat&&E.lng===this._center.lng||(this._unmodified=!1,this._center=E,this._constrain(),this._calcMatrices())},lr.padding.get=function(){return this._edgeInsets.toJSON()},lr.padding.set=function(E){this._edgeInsets.equals(E)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,E,1),this._calcMatrices())},lr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Vt.prototype.isPaddingEqual=function(E){return this._edgeInsets.equals(E)},Vt.prototype.interpolatePadding=function(E,R,F){this._unmodified=!1,this._edgeInsets.interpolate(E,R,F),this._constrain(),this._calcMatrices()},Vt.prototype.coveringZoomLevel=function(E){var R=(E.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/E.tileSize));return Math.max(0,R)},Vt.prototype.getVisibleUnwrappedCoordinates=function(E){var R=[new e.UnwrappedTileID(0,E)];if(this._renderWorldCopies)for(var F=this.pointCoordinate(new e.Point(0,0)),V=this.pointCoordinate(new e.Point(this.width,0)),ne=this.pointCoordinate(new e.Point(this.width,this.height)),le=this.pointCoordinate(new e.Point(0,this.height)),pe=Math.floor(Math.min(F.x,V.x,ne.x,le.x)),ye=Math.floor(Math.max(F.x,V.x,ne.x,le.x)),Te=pe-1;Te<=ye+1;Te++)Te!==0&&R.push(new e.UnwrappedTileID(Te,E));return R},Vt.prototype.coveringTiles=function(E){var R=this.coveringZoomLevel(E),F=R;if(E.minzoom!==void 0&&R<E.minzoom)return[];E.maxzoom!==void 0&&R>E.maxzoom&&(R=E.maxzoom);var V=e.MercatorCoordinate.fromLngLat(this.center),ne=Math.pow(2,R),le=[ne*V.x,ne*V.y,0],pe=ft.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,R),ye=E.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ye=R);var Te=function(hn){return{aabb:new Rt([hn*ne,0,0],[(hn+1)*ne,ne,0]),zoom:0,x:0,y:0,wrap:hn,fullyVisible:!1}},Ne=[],Ge=[],nt=R,bt=E.reparseOverscaled?F:R;if(this._renderWorldCopies)for(var Ct=1;Ct<=3;Ct++)Ne.push(Te(-Ct)),Ne.push(Te(Ct));for(Ne.push(Te(0));Ne.length>0;){var Tt=Ne.pop(),At=Tt.x,yt=Tt.y,Ft=Tt.fullyVisible;if(!Ft){var zt=Tt.aabb.intersects(pe);if(zt===0)continue;Ft=zt===2}var jt=Tt.aabb.distanceX(le),rr=Tt.aabb.distanceY(le),hr=Math.max(Math.abs(jt),Math.abs(rr)),Ar=3+(1<<nt-Tt.zoom)-2;if(Tt.zoom===nt||hr>Ar&&Tt.zoom>=ye)Ge.push({tileID:new e.OverscaledTileID(Tt.zoom===nt?bt:Tt.zoom,Tt.wrap,Tt.zoom,At,yt),distanceSq:e.sqrLen([le[0]-.5-At,le[1]-.5-yt])});else for(var kr=0;kr<4;kr++){var Kr=(At<<1)+kr%2,Zr=(yt<<1)+(kr>>1);Ne.push({aabb:Tt.aabb.quadrant(kr),zoom:Tt.zoom+1,x:Kr,y:Zr,wrap:Tt.wrap,fullyVisible:Ft})}}return Ge.sort(function(hn,sn){return hn.distanceSq-sn.distanceSq}).map(function(hn){return hn.tileID})},Vt.prototype.resize=function(E,R){this.width=E,this.height=R,this.pixelsToGLUnits=[2/E,-2/R],this._constrain(),this._calcMatrices()},lr.unmodified.get=function(){return this._unmodified},Vt.prototype.zoomScale=function(E){return Math.pow(2,E)},Vt.prototype.scaleZoom=function(E){return Math.log(E)/Math.LN2},Vt.prototype.project=function(E){var R=e.clamp(E.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(E.lng)*this.worldSize,e.mercatorYfromLat(R)*this.worldSize)},Vt.prototype.unproject=function(E){return new e.MercatorCoordinate(E.x/this.worldSize,E.y/this.worldSize).toLngLat()},lr.point.get=function(){return this.project(this.center)},Vt.prototype.setLocationAtPoint=function(E,R){var F=this.pointCoordinate(R),V=this.pointCoordinate(this.centerPoint),ne=this.locationCoordinate(E),le=new e.MercatorCoordinate(ne.x-(F.x-V.x),ne.y-(F.y-V.y));this.center=this.coordinateLocation(le),this._renderWorldCopies&&(this.center=this.center.wrap())},Vt.prototype.locationPoint=function(E){return this.coordinatePoint(this.locationCoordinate(E))},Vt.prototype.pointLocation=function(E){return this.coordinateLocation(this.pointCoordinate(E))},Vt.prototype.locationCoordinate=function(E){return e.MercatorCoordinate.fromLngLat(E)},Vt.prototype.coordinateLocation=function(E){return E.toLngLat()},Vt.prototype.pointCoordinate=function(E){var R=[E.x,E.y,0,1],F=[E.x,E.y,1,1];e.transformMat4(R,R,this.pixelMatrixInverse),e.transformMat4(F,F,this.pixelMatrixInverse);var V=R[3],ne=F[3],le=R[0]/V,pe=F[0]/ne,ye=R[1]/V,Te=F[1]/ne,Ne=R[2]/V,Ge=F[2]/ne,nt=Ne===Ge?0:(0-Ne)/(Ge-Ne);return new e.MercatorCoordinate(e.number(le,pe,nt)/this.worldSize,e.number(ye,Te,nt)/this.worldSize)},Vt.prototype.coordinatePoint=function(E){var R=[E.x*this.worldSize,E.y*this.worldSize,0,1];return e.transformMat4(R,R,this.pixelMatrix),new e.Point(R[0]/R[3],R[1]/R[3])},Vt.prototype.getBounds=function(){return new e.LngLatBounds().extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},Vt.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Vt.prototype.setMaxBounds=function(E){E?(this.lngRange=[E.getWest(),E.getEast()],this.latRange=[E.getSouth(),E.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Vt.prototype.calculatePosMatrix=function(E,R){R===void 0&&(R=!1);var F=E.key,V=R?this._alignedPosMatrixCache:this._posMatrixCache;if(V[F])return V[F];var ne=E.canonical,le=this.worldSize/this.zoomScale(ne.z),pe=ne.x+Math.pow(2,ne.z)*E.wrap,ye=e.identity(new Float64Array(16));return e.translate(ye,ye,[pe*le,ne.y*le,0]),e.scale(ye,ye,[le/e.EXTENT,le/e.EXTENT,1]),e.multiply(ye,R?this.alignedProjMatrix:this.projMatrix,ye),V[F]=new Float32Array(ye),V[F]},Vt.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Vt.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var E,R,F,V,ne=-90,le=90,pe=-180,ye=180,Te=this.size,Ne=this._unmodified;if(this.latRange){var Ge=this.latRange;ne=e.mercatorYfromLat(Ge[1])*this.worldSize,E=(le=e.mercatorYfromLat(Ge[0])*this.worldSize)-ne<Te.y?Te.y/(le-ne):0}if(this.lngRange){var nt=this.lngRange;pe=e.mercatorXfromLng(nt[0])*this.worldSize,R=(ye=e.mercatorXfromLng(nt[1])*this.worldSize)-pe<Te.x?Te.x/(ye-pe):0}var bt=this.point,Ct=Math.max(R||0,E||0);if(Ct)return this.center=this.unproject(new e.Point(R?(ye+pe)/2:bt.x,E?(le+ne)/2:bt.y)),this.zoom+=this.scaleZoom(Ct),this._unmodified=Ne,void(this._constraining=!1);if(this.latRange){var Tt=bt.y,At=Te.y/2;Tt-At<ne&&(V=ne+At),Tt+At>le&&(V=le-At)}if(this.lngRange){var yt=bt.x,Ft=Te.x/2;yt-Ft<pe&&(F=pe+Ft),yt+Ft>ye&&(F=ye-Ft)}F===void 0&&V===void 0||(this.center=this.unproject(new e.Point(F!==void 0?F:bt.x,V!==void 0?V:bt.y))),this._unmodified=Ne,this._constraining=!1}},Vt.prototype._calcMatrices=function(){if(this.height){var E=this._fov/2,R=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(E)*this.height;var F=Math.PI/2+this._pitch,V=this._fov*(.5+R.y/this.height),ne=Math.sin(V)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-F-V,.01,Math.PI-.01)),le=this.point,pe=le.x,ye=le.y,Te=1.01*(Math.cos(Math.PI/2-this._pitch)*ne+this.cameraToCenterDistance),Ne=this.height/50,Ge=new Float64Array(16);e.perspective(Ge,this._fov,this.width/this.height,Ne,Te),Ge[8]=2*-R.x/this.width,Ge[9]=2*R.y/this.height,e.scale(Ge,Ge,[1,-1,1]),e.translate(Ge,Ge,[0,0,-this.cameraToCenterDistance]),e.rotateX(Ge,Ge,this._pitch),e.rotateZ(Ge,Ge,this.angle),e.translate(Ge,Ge,[-pe,-ye,0]),this.mercatorMatrix=e.scale([],Ge,[this.worldSize,this.worldSize,this.worldSize]),e.scale(Ge,Ge,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Ge,this.invProjMatrix=e.invert([],this.projMatrix);var nt=this.width%2/2,bt=this.height%2/2,Ct=Math.cos(this.angle),Tt=Math.sin(this.angle),At=pe-Math.round(pe)+Ct*nt+Tt*bt,yt=ye-Math.round(ye)+Ct*bt+Tt*nt,Ft=new Float64Array(Ge);if(e.translate(Ft,Ft,[At>.5?At-1:At,yt>.5?yt-1:yt,0]),this.alignedProjMatrix=Ft,Ge=e.create(),e.scale(Ge,Ge,[this.width/2,-this.height/2,1]),e.translate(Ge,Ge,[1,-1,0]),this.labelPlaneMatrix=Ge,Ge=e.create(),e.scale(Ge,Ge,[1,-1,1]),e.translate(Ge,Ge,[-1,-1,0]),e.scale(Ge,Ge,[2/this.width,2/this.height,1]),this.glCoordMatrix=Ge,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Ge=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Ge,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Vt.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var E=this.pointCoordinate(new e.Point(0,0)),R=[E.x*this.worldSize,E.y*this.worldSize,0,1];return e.transformMat4(R,R,this.pixelMatrix)[3]/this.cameraToCenterDistance},Vt.prototype.getCameraPoint=function(){var E=this._pitch,R=Math.tan(E)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,R))},Vt.prototype.getCameraQueryGeometry=function(E){var R=this.getCameraPoint();if(E.length===1)return[E[0],R];for(var F=R.x,V=R.y,ne=R.x,le=R.y,pe=0,ye=E;pe<ye.length;pe+=1){var Te=ye[pe];F=Math.min(F,Te.x),V=Math.min(V,Te.y),ne=Math.max(ne,Te.x),le=Math.max(le,Te.y)}return[new e.Point(F,V),new e.Point(ne,V),new e.Point(ne,le),new e.Point(F,le),new e.Point(F,V)]},Object.defineProperties(Vt.prototype,lr);var Lr=function(E){var R,F,V,ne,le;this._hashName=E&&encodeURIComponent(E),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(R=this._updateHashUnthrottled.bind(this),F=300,V=!1,ne=null,le=function(){ne=null,V&&(R(),ne=setTimeout(le,F),V=!1)},function(){return V=!0,ne||le(),ne})};Lr.prototype.addTo=function(E){return this._map=E,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Lr.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Lr.prototype.getHashString=function(E){var R=this._map.getCenter(),F=Math.round(100*this._map.getZoom())/100,V=Math.ceil((F*Math.LN2+Math.log(512/360/.5))/Math.LN10),ne=Math.pow(10,V),le=Math.round(R.lng*ne)/ne,pe=Math.round(R.lat*ne)/ne,ye=this._map.getBearing(),Te=this._map.getPitch(),Ne="";if(Ne+=E?"/"+le+"/"+pe+"/"+F:F+"/"+pe+"/"+le,(ye||Te)&&(Ne+="/"+Math.round(10*ye)/10),Te&&(Ne+="/"+Math.round(Te)),this._hashName){var Ge=this._hashName,nt=!1,bt=e.window.location.hash.slice(1).split("&").map(function(Ct){var Tt=Ct.split("=")[0];return Tt===Ge?(nt=!0,Tt+"="+Ne):Ct}).filter(function(Ct){return Ct});return nt||bt.push(Ge+"="+Ne),"#"+bt.join("&")}return"#"+Ne},Lr.prototype._getCurrentHash=function(){var E,R=this,F=e.window.location.hash.replace("#","");return this._hashName?(F.split("&").map(function(V){return V.split("=")}).forEach(function(V){V[0]===R._hashName&&(E=V)}),(E&&E[1]||"").split("/")):F.split("/")},Lr.prototype._onHashChange=function(){var E=this._getCurrentHash();if(E.length>=3&&!E.some(function(F){return isNaN(F)})){var R=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(E[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+E[2],+E[1]],zoom:+E[0],bearing:R,pitch:+(E[4]||0)}),!0}return!1},Lr.prototype._updateHashUnthrottled=function(){var E=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",E)}catch(R){}};var zr={linearity:.3,easing:e.bezier(0,0,.3,1)},Yr=e.extend({deceleration:2500,maxSpeed:1400},zr),ln=e.extend({deceleration:20,maxSpeed:1400},zr),on=e.extend({deceleration:1e3,maxSpeed:360},zr),mn=e.extend({deceleration:1e3,maxSpeed:90},zr),wn=function(E){this._map=E,this.clear()};function un(E,R){(!E.duration||E.duration<R.duration)&&(E.duration=R.duration,E.easing=R.easing)}function Tn(E,R,F){var V=F.maxSpeed,ne=F.linearity,le=F.deceleration,pe=e.clamp(E*ne/(R/1e3),-V,V),ye=Math.abs(pe)/(le*ne);return{easing:F.easing,duration:1e3*ye,amount:pe*(ye/2)}}wn.prototype.clear=function(){this._inertiaBuffer=[]},wn.prototype.record=function(E){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:E})},wn.prototype._drainInertiaBuffer=function(){for(var E=this._inertiaBuffer,R=e.browser.now();E.length>0&&R-E[0].time>160;)E.shift()},wn.prototype._onMoveEnd=function(E){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var R={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},F=0,V=this._inertiaBuffer;F<V.length;F+=1){var ne=V[F].settings;R.zoom+=ne.zoomDelta||0,R.bearing+=ne.bearingDelta||0,R.pitch+=ne.pitchDelta||0,ne.panDelta&&R.pan._add(ne.panDelta),ne.around&&(R.around=ne.around),ne.pinchAround&&(R.pinchAround=ne.pinchAround)}var le=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,pe={};if(R.pan.mag()){var ye=Tn(R.pan.mag(),le,e.extend({},Yr,E||{}));pe.offset=R.pan.mult(ye.amount/R.pan.mag()),pe.center=this._map.transform.center,un(pe,ye)}if(R.zoom){var Te=Tn(R.zoom,le,ln);pe.zoom=this._map.transform.zoom+Te.amount,un(pe,Te)}if(R.bearing){var Ne=Tn(R.bearing,le,on);pe.bearing=this._map.transform.bearing+e.clamp(Ne.amount,-179,179),un(pe,Ne)}if(R.pitch){var Ge=Tn(R.pitch,le,mn);pe.pitch=this._map.transform.pitch+Ge.amount,un(pe,Ge)}if(pe.zoom||pe.bearing){var nt=R.pinchAround===void 0?R.around:R.pinchAround;pe.around=nt?this._map.unproject(nt):this._map.getCenter()}return this.clear(),e.extend(pe,{noMoveStart:!0})}};var Rn=function(E){function R(V,ne,le,pe){pe===void 0&&(pe={});var ye=u.mousePos(ne.getCanvasContainer(),le),Te=ne.unproject(ye);E.call(this,V,e.extend({point:ye,lngLat:Te,originalEvent:le},pe)),this._defaultPrevented=!1,this.target=ne}E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R;var F={defaultPrevented:{configurable:!0}};return R.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(R.prototype,F),R}(e.Event),Vn=function(E){function R(V,ne,le){var pe=V==="touchend"?le.changedTouches:le.touches,ye=u.touchPos(ne.getCanvasContainer(),pe),Te=ye.map(function(nt){return ne.unproject(nt)}),Ne=ye.reduce(function(nt,bt,Ct,Tt){return nt.add(bt.div(Tt.length))},new e.Point(0,0)),Ge=ne.unproject(Ne);E.call(this,V,{points:ye,point:Ne,lngLats:Te,lngLat:Ge,originalEvent:le}),this._defaultPrevented=!1}E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R;var F={defaultPrevented:{configurable:!0}};return R.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(R.prototype,F),R}(e.Event),ta=function(E){function R(V,ne,le){E.call(this,V,{originalEvent:le}),this._defaultPrevented=!1}E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R;var F={defaultPrevented:{configurable:!0}};return R.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(R.prototype,F),R}(e.Event),Xr=function(E,R){this._map=E,this._clickTolerance=R.clickTolerance};Xr.prototype.reset=function(){delete this._mousedownPos},Xr.prototype.wheel=function(E){return this._firePreventable(new ta(E.type,this._map,E))},Xr.prototype.mousedown=function(E,R){return this._mousedownPos=R,this._firePreventable(new Rn(E.type,this._map,E))},Xr.prototype.mouseup=function(E){this._map.fire(new Rn(E.type,this._map,E))},Xr.prototype.click=function(E,R){this._mousedownPos&&this._mousedownPos.dist(R)>=this._clickTolerance||this._map.fire(new Rn(E.type,this._map,E))},Xr.prototype.dblclick=function(E){return this._firePreventable(new Rn(E.type,this._map,E))},Xr.prototype.mouseover=function(E){this._map.fire(new Rn(E.type,this._map,E))},Xr.prototype.mouseout=function(E){this._map.fire(new Rn(E.type,this._map,E))},Xr.prototype.touchstart=function(E){return this._firePreventable(new Vn(E.type,this._map,E))},Xr.prototype.touchmove=function(E){this._map.fire(new Vn(E.type,this._map,E))},Xr.prototype.touchend=function(E){this._map.fire(new Vn(E.type,this._map,E))},Xr.prototype.touchcancel=function(E){this._map.fire(new Vn(E.type,this._map,E))},Xr.prototype._firePreventable=function(E){if(this._map.fire(E),E.defaultPrevented)return{}},Xr.prototype.isEnabled=function(){return!0},Xr.prototype.isActive=function(){return!1},Xr.prototype.enable=function(){},Xr.prototype.disable=function(){};var $n=function(E){this._map=E};$n.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},$n.prototype.mousemove=function(E){this._map.fire(new Rn(E.type,this._map,E))},$n.prototype.mousedown=function(){this._delayContextMenu=!0},$n.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Rn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},$n.prototype.contextmenu=function(E){this._delayContextMenu?this._contextMenuEvent=E:this._map.fire(new Rn(E.type,this._map,E)),this._map.listens("contextmenu")&&E.preventDefault()},$n.prototype.isEnabled=function(){return!0},$n.prototype.isActive=function(){return!1},$n.prototype.enable=function(){},$n.prototype.disable=function(){};var Ln=function(E,R){this._map=E,this._el=E.getCanvasContainer(),this._container=E.getContainer(),this._clickTolerance=R.clickTolerance||1};function jn(E,R){for(var F={},V=0;V<E.length;V++)F[E[V].identifier]=R[V];return F}Ln.prototype.isEnabled=function(){return!!this._enabled},Ln.prototype.isActive=function(){return!!this._active},Ln.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Ln.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ln.prototype.mousedown=function(E,R){this.isEnabled()&&E.shiftKey&&E.button===0&&(u.disableDrag(),this._startPos=this._lastPos=R,this._active=!0)},Ln.prototype.mousemoveWindow=function(E,R){if(this._active){var F=R;if(!(this._lastPos.equals(F)||!this._box&&F.dist(this._startPos)<this._clickTolerance)){var V=this._startPos;this._lastPos=F,this._box||(this._box=u.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",E));var ne=Math.min(V.x,F.x),le=Math.max(V.x,F.x),pe=Math.min(V.y,F.y),ye=Math.max(V.y,F.y);u.setTransform(this._box,"translate("+ne+"px,"+pe+"px)"),this._box.style.width=le-ne+"px",this._box.style.height=ye-pe+"px"}}},Ln.prototype.mouseupWindow=function(E,R){var F=this;if(this._active&&E.button===0){var V=this._startPos,ne=R;if(this.reset(),u.suppressClick(),V.x!==ne.x||V.y!==ne.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:E})),{cameraAnimation:function(le){return le.fitScreenCoordinates(V,ne,F._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",E)}},Ln.prototype.keydown=function(E){this._active&&E.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",E))},Ln.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(u.remove(this._box),this._box=null),u.enableDrag(),delete this._startPos,delete this._lastPos},Ln.prototype._fireEvent=function(E,R){return this._map.fire(new e.Event(E,{originalEvent:R}))};var Jn=function(E){this.reset(),this.numTouches=E.numTouches};Jn.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Jn.prototype.touchstart=function(E,R,F){(this.centroid||F.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=E.timeStamp),F.length===this.numTouches&&(this.centroid=function(V){for(var ne=new e.Point(0,0),le=0,pe=V;le<pe.length;le+=1){var ye=pe[le];ne._add(ye)}return ne.div(V.length)}(R),this.touches=jn(F,R)))},Jn.prototype.touchmove=function(E,R,F){if(!this.aborted&&this.centroid){var V=jn(F,R);for(var ne in this.touches){var le=this.touches[ne],pe=V[ne];(!pe||pe.dist(le)>30)&&(this.aborted=!0)}}},Jn.prototype.touchend=function(E,R,F){if((!this.centroid||E.timeStamp-this.startTime>500)&&(this.aborted=!0),F.length===0){var V=!this.aborted&&this.centroid;if(this.reset(),V)return V}};var Ta=function(E){this.singleTap=new Jn(E),this.numTaps=E.numTaps,this.reset()};Ta.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Ta.prototype.touchstart=function(E,R,F){this.singleTap.touchstart(E,R,F)},Ta.prototype.touchmove=function(E,R,F){this.singleTap.touchmove(E,R,F)},Ta.prototype.touchend=function(E,R,F){var V=this.singleTap.touchend(E,R,F);if(V){var ne=E.timeStamp-this.lastTime<500,le=!this.lastTap||this.lastTap.dist(V)<30;if(ne&&le||this.reset(),this.count++,this.lastTime=E.timeStamp,this.lastTap=V,this.count===this.numTaps)return this.reset(),V}};var Ca=function(){this._zoomIn=new Ta({numTouches:1,numTaps:2}),this._zoomOut=new Ta({numTouches:2,numTaps:1}),this.reset()};Ca.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Ca.prototype.touchstart=function(E,R,F){this._zoomIn.touchstart(E,R,F),this._zoomOut.touchstart(E,R,F)},Ca.prototype.touchmove=function(E,R,F){this._zoomIn.touchmove(E,R,F),this._zoomOut.touchmove(E,R,F)},Ca.prototype.touchend=function(E,R,F){var V=this,ne=this._zoomIn.touchend(E,R,F),le=this._zoomOut.touchend(E,R,F);return ne?(this._active=!0,E.preventDefault(),setTimeout(function(){return V.reset()},0),{cameraAnimation:function(pe){return pe.easeTo({duration:300,zoom:pe.getZoom()+1,around:pe.unproject(ne)},{originalEvent:E})}}):le?(this._active=!0,E.preventDefault(),setTimeout(function(){return V.reset()},0),{cameraAnimation:function(pe){return pe.easeTo({duration:300,zoom:pe.getZoom()-1,around:pe.unproject(le)},{originalEvent:E})}}):void 0},Ca.prototype.touchcancel=function(){this.reset()},Ca.prototype.enable=function(){this._enabled=!0},Ca.prototype.disable=function(){this._enabled=!1,this.reset()},Ca.prototype.isEnabled=function(){return this._enabled},Ca.prototype.isActive=function(){return this._active};var Mn=function(E){this.reset(),this._clickTolerance=E.clickTolerance||1};Mn.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Mn.prototype._correctButton=function(E,R){return!1},Mn.prototype._move=function(E,R){return{}},Mn.prototype.mousedown=function(E,R){if(!this._lastPoint){var F=u.mouseButton(E);this._correctButton(E,F)&&(this._lastPoint=R,this._eventButton=F)}},Mn.prototype.mousemoveWindow=function(E,R){var F=this._lastPoint;if(F&&(E.preventDefault(),this._moved||!(R.dist(F)<this._clickTolerance)))return this._moved=!0,this._lastPoint=R,this._move(F,R)},Mn.prototype.mouseupWindow=function(E){u.mouseButton(E)===this._eventButton&&(this._moved&&u.suppressClick(),this.reset())},Mn.prototype.enable=function(){this._enabled=!0},Mn.prototype.disable=function(){this._enabled=!1,this.reset()},Mn.prototype.isEnabled=function(){return this._enabled},Mn.prototype.isActive=function(){return this._active};var Da=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.mousedown=function(F,V){E.prototype.mousedown.call(this,F,V),this._lastPoint&&(this._active=!0)},R.prototype._correctButton=function(F,V){return V===0&&!F.ctrlKey},R.prototype._move=function(F,V){return{around:V,panDelta:V.sub(F)}},R}(Mn),Sa=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype._correctButton=function(F,V){return V===0&&F.ctrlKey||V===2},R.prototype._move=function(F,V){var ne=.8*(V.x-F.x);if(ne)return this._active=!0,{bearingDelta:ne}},R.prototype.contextmenu=function(F){F.preventDefault()},R}(Mn),da=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype._correctButton=function(F,V){return V===0&&F.ctrlKey||V===2},R.prototype._move=function(F,V){var ne=-.5*(V.y-F.y);if(ne)return this._active=!0,{pitchDelta:ne}},R.prototype.contextmenu=function(F){F.preventDefault()},R}(Mn),za=function(E){this._minTouches=1,this._clickTolerance=E.clickTolerance||1,this.reset()};za.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},za.prototype.touchstart=function(E,R,F){return this._calculateTransform(E,R,F)},za.prototype.touchmove=function(E,R,F){if(this._active)return E.preventDefault(),this._calculateTransform(E,R,F)},za.prototype.touchend=function(E,R,F){this._calculateTransform(E,R,F),this._active&&F.length<this._minTouches&&this.reset()},za.prototype.touchcancel=function(){this.reset()},za.prototype._calculateTransform=function(E,R,F){F.length>0&&(this._active=!0);var V=jn(F,R),ne=new e.Point(0,0),le=new e.Point(0,0),pe=0;for(var ye in V){var Te=V[ye],Ne=this._touches[ye];Ne&&(ne._add(Te),le._add(Te.sub(Ne)),pe++,V[ye]=Te)}if(this._touches=V,!(pe<this._minTouches)&&le.mag()){var Ge=le.div(pe);if(this._sum._add(Ge),!(this._sum.mag()<this._clickTolerance))return{around:ne.div(pe),panDelta:Ge}}},za.prototype.enable=function(){this._enabled=!0},za.prototype.disable=function(){this._enabled=!1,this.reset()},za.prototype.isEnabled=function(){return this._enabled},za.prototype.isActive=function(){return this._active};var Aa=function(){this.reset()};function ti(E,R,F){for(var V=0;V<E.length;V++)if(E[V].identifier===F)return R[V]}Aa.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Aa.prototype._start=function(E){},Aa.prototype._move=function(E,R,F){return{}},Aa.prototype.touchstart=function(E,R,F){this._firstTwoTouches||F.length<2||(this._firstTwoTouches=[F[0].identifier,F[1].identifier],this._start([R[0],R[1]]))},Aa.prototype.touchmove=function(E,R,F){if(this._firstTwoTouches){E.preventDefault();var V=this._firstTwoTouches,ne=V[0],le=V[1],pe=ti(F,R,ne),ye=ti(F,R,le);if(pe&&ye){var Te=this._aroundCenter?null:pe.add(ye).div(2);return this._move([pe,ye],Te,E)}}},Aa.prototype.touchend=function(E,R,F){if(this._firstTwoTouches){var V=this._firstTwoTouches,ne=V[0],le=V[1],pe=ti(F,R,ne),ye=ti(F,R,le);pe&&ye||(this._active&&u.suppressClick(),this.reset())}},Aa.prototype.touchcancel=function(){this.reset()},Aa.prototype.enable=function(E){this._enabled=!0,this._aroundCenter=!!E&&E.around==="center"},Aa.prototype.disable=function(){this._enabled=!1,this.reset()},Aa.prototype.isEnabled=function(){return this._enabled},Aa.prototype.isActive=function(){return this._active};function Qn(E,R){return Math.log(E/R)/Math.LN2}var Za=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.reset=function(){E.prototype.reset.call(this),delete this._distance,delete this._startDistance},R.prototype._start=function(F){this._startDistance=this._distance=F[0].dist(F[1])},R.prototype._move=function(F,V){var ne=this._distance;if(this._distance=F[0].dist(F[1]),this._active||!(Math.abs(Qn(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qn(this._distance,ne),pinchAround:V}},R}(Aa);function Hi(E,R){return 180*E.angleWith(R)/Math.PI}var cs=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.reset=function(){E.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},R.prototype._start=function(F){this._startVector=this._vector=F[0].sub(F[1]),this._minDiameter=F[0].dist(F[1])},R.prototype._move=function(F,V){var ne=this._vector;if(this._vector=F[0].sub(F[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Hi(this._vector,ne),pinchAround:V}},R.prototype._isBelowThreshold=function(F){this._minDiameter=Math.min(this._minDiameter,F.mag());var V=25/(Math.PI*this._minDiameter)*360,ne=Hi(F,this._startVector);return Math.abs(ne)<V},R}(Aa);function Xo(E){return Math.abs(E.y)>Math.abs(E.x)}var Eo=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.reset=function(){E.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},R.prototype._start=function(F){this._lastPoints=F,Xo(F[0].sub(F[1]))&&(this._valid=!1)},R.prototype._move=function(F,V,ne){var le=F[0].sub(this._lastPoints[0]),pe=F[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(le,pe,ne.timeStamp),this._valid)return this._lastPoints=F,this._active=!0,{pitchDelta:-.5*((le.y+pe.y)/2)}},R.prototype.gestureBeginsVertically=function(F,V,ne){if(this._valid!==void 0)return this._valid;var le=F.mag()>=2,pe=V.mag()>=2;if(le||pe){if(!le||!pe)return this._firstMove===void 0&&(this._firstMove=ne),ne-this._firstMove<100&&void 0;var ye=F.y>0==V.y>0;return Xo(F)&&Xo(V)&&ye}},R}(Aa),va={panStep:100,bearingStep:15,pitchStep:10},yi=function(){var E=va;this._panStep=E.panStep,this._bearingStep=E.bearingStep,this._pitchStep=E.pitchStep};function Co(E){return E*(2-E)}yi.prototype.reset=function(){this._active=!1},yi.prototype.keydown=function(E){var R=this;if(!(E.altKey||E.ctrlKey||E.metaKey)){var F=0,V=0,ne=0,le=0,pe=0;switch(E.keyCode){case 61:case 107:case 171:case 187:F=1;break;case 189:case 109:case 173:F=-1;break;case 37:E.shiftKey?V=-1:(E.preventDefault(),le=-1);break;case 39:E.shiftKey?V=1:(E.preventDefault(),le=1);break;case 38:E.shiftKey?ne=1:(E.preventDefault(),pe=-1);break;case 40:E.shiftKey?ne=-1:(E.preventDefault(),pe=1);break;default:return}return{cameraAnimation:function(ye){var Te=ye.getZoom();ye.easeTo({duration:300,easeId:"keyboardHandler",easing:Co,zoom:F?Math.round(Te)+F*(E.shiftKey?2:1):Te,bearing:ye.getBearing()+V*R._bearingStep,pitch:ye.getPitch()+ne*R._pitchStep,offset:[-le*R._panStep,-pe*R._panStep],center:ye.getCenter()},{originalEvent:E})}}}},yi.prototype.enable=function(){this._enabled=!0},yi.prototype.disable=function(){this._enabled=!1,this.reset()},yi.prototype.isEnabled=function(){return this._enabled},yi.prototype.isActive=function(){return this._active};var Ka=function(E,R){this._map=E,this._el=E.getCanvasContainer(),this._handler=R,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Ka.prototype.setZoomRate=function(E){this._defaultZoomRate=E},Ka.prototype.setWheelZoomRate=function(E){this._wheelZoomRate=E},Ka.prototype.isEnabled=function(){return!!this._enabled},Ka.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Ka.prototype.isZooming=function(){return!!this._zooming},Ka.prototype.enable=function(E){this.isEnabled()||(this._enabled=!0,this._aroundCenter=E&&E.around==="center")},Ka.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ka.prototype.wheel=function(E){if(this.isEnabled()){var R=E.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*E.deltaY:E.deltaY,F=e.browser.now(),V=F-(this._lastWheelEventTime||0);this._lastWheelEventTime=F,R!==0&&R%4.000244140625==0?this._type="wheel":R!==0&&Math.abs(R)<4?this._type="trackpad":V>400?(this._type=null,this._lastValue=R,this._timeout=setTimeout(this._onTimeout,40,E)):this._type||(this._type=Math.abs(V*R)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,R+=this._lastValue)),E.shiftKey&&R&&(R/=4),this._type&&(this._lastWheelEvent=E,this._delta-=R,this._active||this._start(E)),E.preventDefault()}},Ka.prototype._onTimeout=function(E){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(E)},Ka.prototype._start=function(E){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var R=u.mousePos(this._el,E);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(R)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Ka.prototype.renderFrame=function(){return this._onScrollFrame()},Ka.prototype._onScrollFrame=function(){var E=this;if(this._frameId&&(this._frameId=null,this.isActive())){var R=this._map.transform;if(this._delta!==0){var F=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,V=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&V!==0&&(V=1/V);var ne=typeof this._targetZoom=="number"?R.zoomScale(this._targetZoom):R.scale;this._targetZoom=Math.min(R.maxZoom,Math.max(R.minZoom,R.scaleZoom(ne*V))),this._type==="wheel"&&(this._startZoom=R.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var le,pe=typeof this._targetZoom=="number"?this._targetZoom:R.zoom,ye=this._startZoom,Te=this._easing,Ne=!1;if(this._type==="wheel"&&ye&&Te){var Ge=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),nt=Te(Ge);le=e.number(ye,pe,nt),Ge<1?this._frameId||(this._frameId=!0):Ne=!0}else le=pe,Ne=!0;return this._active=!0,Ne&&(this._active=!1,this._finishTimeout=setTimeout(function(){E._zooming=!1,E._handler._triggerRenderFrame(),delete E._targetZoom,delete E._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ne,zoomDelta:le-R.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Ka.prototype._smoothOutEasing=function(E){var R=e.ease;if(this._prevEase){var F=this._prevEase,V=(e.browser.now()-F.start)/F.duration,ne=F.easing(V+.01)-F.easing(V),le=.27/Math.sqrt(ne*ne+1e-4)*.01,pe=Math.sqrt(.0729-le*le);R=e.bezier(le,pe,.25,1)}return this._prevEase={start:e.browser.now(),duration:E,easing:R},R},Ka.prototype.reset=function(){this._active=!1};var Si=function(E,R){this._clickZoom=E,this._tapZoom=R};Si.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Si.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Si.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Si.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Zi=function(){this.reset()};Zi.prototype.reset=function(){this._active=!1},Zi.prototype.dblclick=function(E,R){return E.preventDefault(),{cameraAnimation:function(F){F.easeTo({duration:300,zoom:F.getZoom()+(E.shiftKey?-1:1),around:F.unproject(R)},{originalEvent:E})}}},Zi.prototype.enable=function(){this._enabled=!0},Zi.prototype.disable=function(){this._enabled=!1,this.reset()},Zi.prototype.isEnabled=function(){return this._enabled},Zi.prototype.isActive=function(){return this._active};var ai=function(){this._tap=new Ta({numTouches:1,numTaps:1}),this.reset()};ai.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ai.prototype.touchstart=function(E,R,F){this._swipePoint||(this._tapTime&&E.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?F.length>0&&(this._swipePoint=R[0],this._swipeTouch=F[0].identifier):this._tap.touchstart(E,R,F))},ai.prototype.touchmove=function(E,R,F){if(this._tapTime){if(this._swipePoint){if(F[0].identifier!==this._swipeTouch)return;var V=R[0],ne=V.y-this._swipePoint.y;return this._swipePoint=V,E.preventDefault(),this._active=!0,{zoomDelta:ne/128}}}else this._tap.touchmove(E,R,F)},ai.prototype.touchend=function(E,R,F){this._tapTime?this._swipePoint&&F.length===0&&this.reset():this._tap.touchend(E,R,F)&&(this._tapTime=E.timeStamp)},ai.prototype.touchcancel=function(){this.reset()},ai.prototype.enable=function(){this._enabled=!0},ai.prototype.disable=function(){this._enabled=!1,this.reset()},ai.prototype.isEnabled=function(){return this._enabled},ai.prototype.isActive=function(){return this._active};var yo=function(E,R,F){this._el=E,this._mousePan=R,this._touchPan=F};yo.prototype.enable=function(E){this._inertiaOptions=E||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},yo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},yo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},yo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ii=function(E,R,F){this._pitchWithRotate=E.pitchWithRotate,this._mouseRotate=R,this._mousePitch=F};ii.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ii.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ii.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ii.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var so=function(E,R,F,V){this._el=E,this._touchZoom=R,this._touchRotate=F,this._tapDragZoom=V,this._rotationDisabled=!1,this._enabled=!0};so.prototype.enable=function(E){this._touchZoom.enable(E),this._rotationDisabled||this._touchRotate.enable(E),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},so.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},so.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},so.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},so.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},so.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Ms=function(E){return E.zoom||E.drag||E.pitch||E.rotate},ys=function(E){function R(){E.apply(this,arguments)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R}(e.Event);function pl(E){return E.panDelta&&E.panDelta.mag()||E.zoomDelta||E.bearingDelta||E.pitchDelta}var Bi=function(E,R){this._map=E,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new wn(E),this._bearingSnap=R.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(R),e.bindAll(["handleEvent","handleWindowEvent"],this);var F=this._el;this._listeners=[[F,"touchstart",{passive:!1}],[F,"touchmove",{passive:!1}],[F,"touchend",void 0],[F,"touchcancel",void 0],[F,"mousedown",void 0],[F,"mousemove",void 0],[F,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[F,"mouseover",void 0],[F,"mouseout",void 0],[F,"dblclick",void 0],[F,"click",void 0],[F,"keydown",{capture:!1}],[F,"keyup",void 0],[F,"wheel",{passive:!1}],[F,"contextmenu",void 0],[e.window,"blur",void 0]];for(var V=0,ne=this._listeners;V<ne.length;V+=1){var le=ne[V],pe=le[0],ye=le[1],Te=le[2];u.addEventListener(pe,ye,pe===e.window.document?this.handleWindowEvent:this.handleEvent,Te)}};Bi.prototype.destroy=function(){for(var E=0,R=this._listeners;E<R.length;E+=1){var F=R[E],V=F[0],ne=F[1],le=F[2];u.removeEventListener(V,ne,V===e.window.document?this.handleWindowEvent:this.handleEvent,le)}},Bi.prototype._addDefaultHandlers=function(E){var R=this._map,F=R.getCanvasContainer();this._add("mapEvent",new Xr(R,E));var V=R.boxZoom=new Ln(R,E);this._add("boxZoom",V);var ne=new Ca,le=new Zi;R.doubleClickZoom=new Si(le,ne),this._add("tapZoom",ne),this._add("clickZoom",le);var pe=new ai;this._add("tapDragZoom",pe);var ye=R.touchPitch=new Eo;this._add("touchPitch",ye);var Te=new Sa(E),Ne=new da(E);R.dragRotate=new ii(E,Te,Ne),this._add("mouseRotate",Te,["mousePitch"]),this._add("mousePitch",Ne,["mouseRotate"]);var Ge=new Da(E),nt=new za(E);R.dragPan=new yo(F,Ge,nt),this._add("mousePan",Ge),this._add("touchPan",nt,["touchZoom","touchRotate"]);var bt=new cs,Ct=new Za;R.touchZoomRotate=new so(F,Ct,bt,pe),this._add("touchRotate",bt,["touchPan","touchZoom"]),this._add("touchZoom",Ct,["touchPan","touchRotate"]);var Tt=R.scrollZoom=new Ka(R,this);this._add("scrollZoom",Tt,["mousePan"]);var At=R.keyboard=new yi;this._add("keyboard",At),this._add("blockableMapEvent",new $n(R));for(var yt=0,Ft=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];yt<Ft.length;yt+=1){var zt=Ft[yt];E.interactive&&E[zt]&&R[zt].enable(E[zt])}},Bi.prototype._add=function(E,R,F){this._handlers.push({handlerName:E,handler:R,allowed:F}),this._handlersById[E]=R},Bi.prototype.stop=function(){if(!this._updatingCamera){for(var E=0,R=this._handlers;E<R.length;E+=1)R[E].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Bi.prototype.isActive=function(){for(var E=0,R=this._handlers;E<R.length;E+=1)if(R[E].handler.isActive())return!0;return!1},Bi.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Bi.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Bi.prototype.isMoving=function(){return Boolean(Ms(this._eventsInProgress))||this.isZooming()},Bi.prototype._blockedByActive=function(E,R,F){for(var V in E)if(V!==F&&(!R||R.indexOf(V)<0))return!0;return!1},Bi.prototype.handleWindowEvent=function(E){this.handleEvent(E,E.type+"Window")},Bi.prototype._getMapTouches=function(E){for(var R=[],F=0,V=E;F<V.length;F+=1){var ne=V[F],le=ne.target;this._el.contains(le)&&R.push(ne)}return R},Bi.prototype.handleEvent=function(E,R){if(E.type!=="blur"){this._updatingCamera=!0;for(var F=E.type==="renderFrame"?void 0:E,V={needsRenderFrame:!1},ne={},le={},pe=E.touches?this._getMapTouches(E.touches):void 0,ye=pe?u.touchPos(this._el,pe):u.mousePos(this._el,E),Te=0,Ne=this._handlers;Te<Ne.length;Te+=1){var Ge=Ne[Te],nt=Ge.handlerName,bt=Ge.handler,Ct=Ge.allowed;if(bt.isEnabled()){var Tt=void 0;this._blockedByActive(le,Ct,nt)?bt.reset():bt[R||E.type]&&(Tt=bt[R||E.type](E,ye,pe),this.mergeHandlerResult(V,ne,Tt,nt,F),Tt&&Tt.needsRenderFrame&&this._triggerRenderFrame()),(Tt||bt.isActive())&&(le[nt]=bt)}}var At={};for(var yt in this._previousActiveHandlers)le[yt]||(At[yt]=F);this._previousActiveHandlers=le,(Object.keys(At).length||pl(V))&&(this._changes.push([V,ne,At]),this._triggerRenderFrame()),(Object.keys(le).length||pl(V))&&this._map._stop(!0),this._updatingCamera=!1;var Ft=V.cameraAnimation;Ft&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],Ft(this._map))}else this.stop()},Bi.prototype.mergeHandlerResult=function(E,R,F,V,ne){if(F){e.extend(E,F);var le={handlerName:V,originalEvent:F.originalEvent||ne};F.zoomDelta!==void 0&&(R.zoom=le),F.panDelta!==void 0&&(R.drag=le),F.pitchDelta!==void 0&&(R.pitch=le),F.bearingDelta!==void 0&&(R.rotate=le)}},Bi.prototype._applyChanges=function(){for(var E={},R={},F={},V=0,ne=this._changes;V<ne.length;V+=1){var le=ne[V],pe=le[0],ye=le[1],Te=le[2];pe.panDelta&&(E.panDelta=(E.panDelta||new e.Point(0,0))._add(pe.panDelta)),pe.zoomDelta&&(E.zoomDelta=(E.zoomDelta||0)+pe.zoomDelta),pe.bearingDelta&&(E.bearingDelta=(E.bearingDelta||0)+pe.bearingDelta),pe.pitchDelta&&(E.pitchDelta=(E.pitchDelta||0)+pe.pitchDelta),pe.around!==void 0&&(E.around=pe.around),pe.pinchAround!==void 0&&(E.pinchAround=pe.pinchAround),pe.noInertia&&(E.noInertia=pe.noInertia),e.extend(R,ye),e.extend(F,Te)}this._updateMapTransform(E,R,F),this._changes=[]},Bi.prototype._updateMapTransform=function(E,R,F){var V=this._map,ne=V.transform;if(!pl(E))return this._fireEvents(R,F);var le=E.panDelta,pe=E.zoomDelta,ye=E.bearingDelta,Te=E.pitchDelta,Ne=E.around,Ge=E.pinchAround;Ge!==void 0&&(Ne=Ge),V._stop(!0),Ne=Ne||V.transform.centerPoint;var nt=ne.pointLocation(le?Ne.sub(le):Ne);ye&&(ne.bearing+=ye),Te&&(ne.pitch+=Te),pe&&(ne.zoom+=pe),ne.setLocationAtPoint(nt,Ne),this._map._update(),E.noInertia||this._inertia.record(E),this._fireEvents(R,F)},Bi.prototype._fireEvents=function(E,R){var F=this,V=Ms(this._eventsInProgress),ne=Ms(E),le={};for(var pe in E){var ye=E[pe].originalEvent;this._eventsInProgress[pe]||(le[pe+"start"]=ye),this._eventsInProgress[pe]=E[pe]}for(var Te in!V&&ne&&this._fireEvent("movestart",ne.originalEvent),le)this._fireEvent(Te,le[Te]);for(var Ne in E.rotate&&(this._bearingChanged=!0),ne&&this._fireEvent("move",ne.originalEvent),E){var Ge=E[Ne].originalEvent;this._fireEvent(Ne,Ge)}var nt,bt={};for(var Ct in this._eventsInProgress){var Tt=this._eventsInProgress[Ct],At=Tt.handlerName,yt=Tt.originalEvent;this._handlersById[At].isActive()||(delete this._eventsInProgress[Ct],nt=R[At]||yt,bt[Ct+"end"]=nt)}for(var Ft in bt)this._fireEvent(Ft,bt[Ft]);var zt=Ms(this._eventsInProgress);if((V||ne)&&!zt){this._updatingCamera=!0;var jt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),rr=function(hr){return hr!==0&&-F._bearingSnap<hr&&hr<F._bearingSnap};jt?(rr(jt.bearing||this._map.getBearing())&&(jt.bearing=0),this._map.easeTo(jt,{originalEvent:nt})):(this._map.fire(new e.Event("moveend",{originalEvent:nt})),rr(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Bi.prototype._fireEvent=function(E,R){this._map.fire(new e.Event(E,R?{originalEvent:R}:{}))},Bi.prototype._triggerRenderFrame=function(){var E=this;this._frameId===void 0&&(this._frameId=this._map._requestRenderFrame(function(R){delete E._frameId,E.handleEvent(new ys("renderFrame",{timeStamp:R})),E._applyChanges()}))};var dl=function(E){function R(F,V){E.call(this),this._moving=!1,this._zooming=!1,this.transform=F,this._bearingSnap=V.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},R.prototype.setCenter=function(F,V){return this.jumpTo({center:F},V)},R.prototype.panBy=function(F,V,ne){return F=e.Point.convert(F).mult(-1),this.panTo(this.transform.center,e.extend({offset:F},V),ne)},R.prototype.panTo=function(F,V,ne){return this.easeTo(e.extend({center:F},V),ne)},R.prototype.getZoom=function(){return this.transform.zoom},R.prototype.setZoom=function(F,V){return this.jumpTo({zoom:F},V),this},R.prototype.zoomTo=function(F,V,ne){return this.easeTo(e.extend({zoom:F},V),ne)},R.prototype.zoomIn=function(F,V){return this.zoomTo(this.getZoom()+1,F,V),this},R.prototype.zoomOut=function(F,V){return this.zoomTo(this.getZoom()-1,F,V),this},R.prototype.getBearing=function(){return this.transform.bearing},R.prototype.setBearing=function(F,V){return this.jumpTo({bearing:F},V),this},R.prototype.getPadding=function(){return this.transform.padding},R.prototype.setPadding=function(F,V){return this.jumpTo({padding:F},V),this},R.prototype.rotateTo=function(F,V,ne){return this.easeTo(e.extend({bearing:F},V),ne)},R.prototype.resetNorth=function(F,V){return this.rotateTo(0,e.extend({duration:1e3},F),V),this},R.prototype.resetNorthPitch=function(F,V){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},F),V),this},R.prototype.snapToNorth=function(F,V){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(F,V):this},R.prototype.getPitch=function(){return this.transform.pitch},R.prototype.setPitch=function(F,V){return this.jumpTo({pitch:F},V),this},R.prototype.cameraForBounds=function(F,V){return F=e.LngLatBounds.convert(F),this._cameraForBoxAndBearing(F.getNorthWest(),F.getSouthEast(),0,V)},R.prototype._cameraForBoxAndBearing=function(F,V,ne,le){var pe={top:0,bottom:0,right:0,left:0};if(typeof(le=e.extend({padding:pe,offset:[0,0],maxZoom:this.transform.maxZoom},le)).padding=="number"){var ye=le.padding;le.padding={top:ye,bottom:ye,right:ye,left:ye}}le.padding=e.extend(pe,le.padding);var Te=this.transform,Ne=Te.padding,Ge=Te.project(e.LngLat.convert(F)),nt=Te.project(e.LngLat.convert(V)),bt=Ge.rotate(-ne*Math.PI/180),Ct=nt.rotate(-ne*Math.PI/180),Tt=new e.Point(Math.max(bt.x,Ct.x),Math.max(bt.y,Ct.y)),At=new e.Point(Math.min(bt.x,Ct.x),Math.min(bt.y,Ct.y)),yt=Tt.sub(At),Ft=(Te.width-(Ne.left+Ne.right+le.padding.left+le.padding.right))/yt.x,zt=(Te.height-(Ne.top+Ne.bottom+le.padding.top+le.padding.bottom))/yt.y;if(!(zt<0||Ft<0)){var jt=Math.min(Te.scaleZoom(Te.scale*Math.min(Ft,zt)),le.maxZoom),rr=e.Point.convert(le.offset),hr=(le.padding.left-le.padding.right)/2,Ar=(le.padding.top-le.padding.bottom)/2,kr=new e.Point(rr.x+hr,rr.y+Ar).mult(Te.scale/Te.zoomScale(jt));return{center:Te.unproject(Ge.add(nt).div(2).sub(kr)),zoom:jt,bearing:ne}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},R.prototype.fitBounds=function(F,V,ne){return this._fitInternal(this.cameraForBounds(F,V),V,ne)},R.prototype.fitScreenCoordinates=function(F,V,ne,le,pe){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(F)),this.transform.pointLocation(e.Point.convert(V)),ne,le),le,pe)},R.prototype._fitInternal=function(F,V,ne){return F?(delete(V=e.extend(F,V)).padding,V.linear?this.easeTo(V,ne):this.flyTo(V,ne)):this},R.prototype.jumpTo=function(F,V){this.stop();var ne=this.transform,le=!1,pe=!1,ye=!1;return"zoom"in F&&ne.zoom!==+F.zoom&&(le=!0,ne.zoom=+F.zoom),F.center!==void 0&&(ne.center=e.LngLat.convert(F.center)),"bearing"in F&&ne.bearing!==+F.bearing&&(pe=!0,ne.bearing=+F.bearing),"pitch"in F&&ne.pitch!==+F.pitch&&(ye=!0,ne.pitch=+F.pitch),F.padding==null||ne.isPaddingEqual(F.padding)||(ne.padding=F.padding),this.fire(new e.Event("movestart",V)).fire(new e.Event("move",V)),le&&this.fire(new e.Event("zoomstart",V)).fire(new e.Event("zoom",V)).fire(new e.Event("zoomend",V)),pe&&this.fire(new e.Event("rotatestart",V)).fire(new e.Event("rotate",V)).fire(new e.Event("rotateend",V)),ye&&this.fire(new e.Event("pitchstart",V)).fire(new e.Event("pitch",V)).fire(new e.Event("pitchend",V)),this.fire(new e.Event("moveend",V))},R.prototype.easeTo=function(F,V){var ne=this;this._stop(!1,F.easeId),((F=e.extend({offset:[0,0],duration:500,easing:e.ease},F)).animate===!1||!F.essential&&e.browser.prefersReducedMotion)&&(F.duration=0);var le=this.transform,pe=this.getZoom(),ye=this.getBearing(),Te=this.getPitch(),Ne=this.getPadding(),Ge="zoom"in F?+F.zoom:pe,nt="bearing"in F?this._normalizeBearing(F.bearing,ye):ye,bt="pitch"in F?+F.pitch:Te,Ct="padding"in F?F.padding:le.padding,Tt=e.Point.convert(F.offset),At=le.centerPoint.add(Tt),yt=le.pointLocation(At),Ft=e.LngLat.convert(F.center||yt);this._normalizeCenter(Ft);var zt,jt,rr=le.project(yt),hr=le.project(Ft).sub(rr),Ar=le.zoomScale(Ge-pe);F.around&&(zt=e.LngLat.convert(F.around),jt=le.locationPoint(zt));var kr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Ge!==pe,this._rotating=this._rotating||ye!==nt,this._pitching=this._pitching||bt!==Te,this._padding=!le.isPaddingEqual(Ct),this._easeId=F.easeId,this._prepareEase(V,F.noMoveStart,kr),clearTimeout(this._easeEndTimeoutID),this._ease(function(Kr){if(ne._zooming&&(le.zoom=e.number(pe,Ge,Kr)),ne._rotating&&(le.bearing=e.number(ye,nt,Kr)),ne._pitching&&(le.pitch=e.number(Te,bt,Kr)),ne._padding&&(le.interpolatePadding(Ne,Ct,Kr),At=le.centerPoint.add(Tt)),zt)le.setLocationAtPoint(zt,jt);else{var Zr=le.zoomScale(le.zoom-pe),hn=Ge>pe?Math.min(2,Ar):Math.max(.5,Ar),sn=Math.pow(hn,1-Kr),Un=le.unproject(rr.add(hr.mult(Kr*sn)).mult(Zr));le.setLocationAtPoint(le.renderWorldCopies?Un.wrap():Un,At)}ne._fireMoveEvents(V)},function(Kr){ne._afterEase(V,Kr)},F),this},R.prototype._prepareEase=function(F,V,ne){ne===void 0&&(ne={}),this._moving=!0,V||ne.moving||this.fire(new e.Event("movestart",F)),this._zooming&&!ne.zooming&&this.fire(new e.Event("zoomstart",F)),this._rotating&&!ne.rotating&&this.fire(new e.Event("rotatestart",F)),this._pitching&&!ne.pitching&&this.fire(new e.Event("pitchstart",F))},R.prototype._fireMoveEvents=function(F){this.fire(new e.Event("move",F)),this._zooming&&this.fire(new e.Event("zoom",F)),this._rotating&&this.fire(new e.Event("rotate",F)),this._pitching&&this.fire(new e.Event("pitch",F))},R.prototype._afterEase=function(F,V){if(!this._easeId||!V||this._easeId!==V){delete this._easeId;var ne=this._zooming,le=this._rotating,pe=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,ne&&this.fire(new e.Event("zoomend",F)),le&&this.fire(new e.Event("rotateend",F)),pe&&this.fire(new e.Event("pitchend",F)),this.fire(new e.Event("moveend",F))}},R.prototype.flyTo=function(F,V){var ne=this;if(!F.essential&&e.browser.prefersReducedMotion){var le=e.pick(F,["center","zoom","bearing","pitch","around"]);return this.jumpTo(le,V)}this.stop(),F=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},F);var pe=this.transform,ye=this.getZoom(),Te=this.getBearing(),Ne=this.getPitch(),Ge=this.getPadding(),nt="zoom"in F?e.clamp(+F.zoom,pe.minZoom,pe.maxZoom):ye,bt="bearing"in F?this._normalizeBearing(F.bearing,Te):Te,Ct="pitch"in F?+F.pitch:Ne,Tt="padding"in F?F.padding:pe.padding,At=pe.zoomScale(nt-ye),yt=e.Point.convert(F.offset),Ft=pe.centerPoint.add(yt),zt=pe.pointLocation(Ft),jt=e.LngLat.convert(F.center||zt);this._normalizeCenter(jt);var rr=pe.project(zt),hr=pe.project(jt).sub(rr),Ar=F.curve,kr=Math.max(pe.width,pe.height),Kr=kr/At,Zr=hr.mag();if("minZoom"in F){var hn=e.clamp(Math.min(F.minZoom,ye,nt),pe.minZoom,pe.maxZoom),sn=kr/pe.zoomScale(hn-ye);Ar=Math.sqrt(sn/Zr*2)}var Un=Ar*Ar;function Wn(Kn){var xa=(Kr*Kr-kr*kr+(Kn?-1:1)*Un*Un*Zr*Zr)/(2*(Kn?Kr:kr)*Un*Zr);return Math.log(Math.sqrt(xa*xa+1)-xa)}function ua(Kn){return(Math.exp(Kn)-Math.exp(-Kn))/2}function Ur(Kn){return(Math.exp(Kn)+Math.exp(-Kn))/2}var kn=Wn(0),Xn=function(Kn){return Ur(kn)/Ur(kn+Ar*Kn)},Gn=function(Kn){return kr*((Ur(kn)*(ua(xa=kn+Ar*Kn)/Ur(xa))-ua(kn))/Un)/Zr;var xa},ea=(Wn(1)-kn)/Ar;if(Math.abs(Zr)<1e-6||!isFinite(ea)){if(Math.abs(kr-Kr)<1e-6)return this.easeTo(F,V);var fa=Kr<kr?-1:1;ea=Math.abs(Math.log(Kr/kr))/Ar,Gn=function(){return 0},Xn=function(Kn){return Math.exp(fa*Ar*Kn)}}if("duration"in F)F.duration=+F.duration;else{var Ma="screenSpeed"in F?+F.screenSpeed/Ar:+F.speed;F.duration=1e3*ea/Ma}return F.maxDuration&&F.duration>F.maxDuration&&(F.duration=0),this._zooming=!0,this._rotating=Te!==bt,this._pitching=Ct!==Ne,this._padding=!pe.isPaddingEqual(Tt),this._prepareEase(V,!1),this._ease(function(Kn){var xa=Kn*ea,ma=1/Xn(xa);pe.zoom=Kn===1?nt:ye+pe.scaleZoom(ma),ne._rotating&&(pe.bearing=e.number(Te,bt,Kn)),ne._pitching&&(pe.pitch=e.number(Ne,Ct,Kn)),ne._padding&&(pe.interpolatePadding(Ge,Tt,Kn),Ft=pe.centerPoint.add(yt));var La=Kn===1?jt:pe.unproject(rr.add(hr.mult(Gn(xa))).mult(ma));pe.setLocationAtPoint(pe.renderWorldCopies?La.wrap():La,Ft),ne._fireMoveEvents(V)},function(){return ne._afterEase(V)},F),this},R.prototype.isEasing=function(){return!!this._easeFrameId},R.prototype.stop=function(){return this._stop()},R.prototype._stop=function(F,V){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var ne=this._onEaseEnd;delete this._onEaseEnd,ne.call(this,V)}if(!F){var le=this.handlers;le&&le.stop()}return this},R.prototype._ease=function(F,V,ne){ne.animate===!1||ne.duration===0?(F(1),V()):(this._easeStart=e.browser.now(),this._easeOptions=ne,this._onEaseFrame=F,this._onEaseEnd=V,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},R.prototype._renderFrameCallback=function(){var F=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(F)),F<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},R.prototype._normalizeBearing=function(F,V){F=e.wrap(F,-180,180);var ne=Math.abs(F-V);return Math.abs(F-360-V)<ne&&(F-=360),Math.abs(F+360-V)<ne&&(F+=360),F},R.prototype._normalizeCenter=function(F){var V=this.transform;if(V.renderWorldCopies&&!V.lngRange){var ne=F.lng-V.center.lng;F.lng+=ne>180?-360:ne<-180?360:0}},R}(e.Evented),Ni=function(E){E===void 0&&(E={}),this.options=E,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Ni.prototype.getDefaultPosition=function(){return"bottom-right"},Ni.prototype.onAdd=function(E){var R=this.options&&this.options.compact;return this._map=E,this._container=u.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=u.create("div","mapboxgl-ctrl-attrib-inner",this._container),R&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),R===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ni.prototype.onRemove=function(){u.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ni.prototype._updateEditLink=function(){var E=this._editLink;E||(E=this._editLink=this._container.querySelector(".mapbox-improve-map"));var R=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(E){var F=R.reduce(function(V,ne,le){return ne.value&&(V+=ne.key+"="+ne.value+(le<R.length-1?"&":"")),V},"?");E.href=e.config.FEEDBACK_URL+"/"+F+(this._map._hash?this._map._hash.getHashString(!0):""),E.rel="noopener nofollow"}},Ni.prototype._updateData=function(E){!E||E.sourceDataType!=="metadata"&&E.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Ni.prototype._updateAttributions=function(){if(this._map.style){var E=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?E=E.concat(this.options.customAttribution.map(function(ye){return typeof ye!="string"?"":ye})):typeof this.options.customAttribution=="string"&&E.push(this.options.customAttribution)),this._map.style.stylesheet){var R=this._map.style.stylesheet;this.styleOwner=R.owner,this.styleId=R.id}var F=this._map.style.sourceCaches;for(var V in F){var ne=F[V];if(ne.used){var le=ne.getSource();le.attribution&&E.indexOf(le.attribution)<0&&E.push(le.attribution)}}E.sort(function(ye,Te){return ye.length-Te.length});var pe=(E=E.filter(function(ye,Te){for(var Ne=Te+1;Ne<E.length;Ne++)if(E[Ne].indexOf(ye)>=0)return!1;return!0})).join(" | ");pe!==this._attribHTML&&(this._attribHTML=pe,E.length?(this._innerContainer.innerHTML=pe,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Ni.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var xs=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};xs.prototype.onAdd=function(E){this._map=E,this._container=u.create("div","mapboxgl-ctrl");var R=u.create("a","mapboxgl-ctrl-logo");return R.target="_blank",R.rel="noopener nofollow",R.href="https://www.mapbox.com/",R.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),R.setAttribute("rel","noopener nofollow"),this._container.appendChild(R),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},xs.prototype.onRemove=function(){u.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},xs.prototype.getDefaultPosition=function(){return"bottom-left"},xs.prototype._updateLogo=function(E){E&&E.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},xs.prototype._logoRequired=function(){if(this._map.style){var E=this._map.style.sourceCaches;for(var R in E)if(E[R].getSource().mapbox_logo)return!0;return!1}},xs.prototype._updateCompact=function(){var E=this._container.children;if(E.length){var R=E[0];this._map.getCanvasContainer().offsetWidth<250?R.classList.add("mapboxgl-compact"):R.classList.remove("mapboxgl-compact")}};var la=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};la.prototype.add=function(E){var R=++this._id;return this._queue.push({callback:E,id:R,cancelled:!1}),R},la.prototype.remove=function(E){for(var R=this._currentlyRunning,F=0,V=R?this._queue.concat(R):this._queue;F<V.length;F+=1){var ne=V[F];if(ne.id===E)return void(ne.cancelled=!0)}},la.prototype.run=function(E){E===void 0&&(E=0);var R=this._currentlyRunning=this._queue;this._queue=[];for(var F=0,V=R;F<V.length;F+=1){var ne=V[F];if(!ne.cancelled&&(ne.callback(E),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},la.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ya={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},ml=e.window.HTMLImageElement,vl=e.window.HTMLElement,bs=e.window.ImageBitmap,Go={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},is=function(E){function R(V){var ne=this;if((V=e.extend({},Go,V)).minZoom!=null&&V.maxZoom!=null&&V.minZoom>V.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(V.minPitch!=null&&V.maxPitch!=null&&V.minPitch>V.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(V.minPitch!=null&&V.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(V.maxPitch!=null&&V.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var le=new Vt(V.minZoom,V.maxZoom,V.minPitch,V.maxPitch,V.renderWorldCopies);if(E.call(this,le,V),this._interactive=V.interactive,this._maxTileCacheSize=V.maxTileCacheSize,this._failIfMajorPerformanceCaveat=V.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=V.preserveDrawingBuffer,this._antialias=V.antialias,this._trackResize=V.trackResize,this._bearingSnap=V.bearingSnap,this._refreshExpiredTiles=V.refreshExpiredTiles,this._fadeDuration=V.fadeDuration,this._crossSourceCollisions=V.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=V.collectResourceTiming,this._renderTaskQueue=new la,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},ya,V.locale),this._requestManager=new e.RequestManager(V.transformRequest,V.accessToken),typeof V.container=="string"){if(this._container=e.window.document.getElementById(V.container),!this._container)throw new Error("Container '"+V.container+"' not found.")}else{if(!(V.container instanceof vl))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=V.container}if(V.maxBounds&&this.setMaxBounds(V.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return ne._update(!1)}),this.on("moveend",function(){return ne._update(!1)}),this.on("zoom",function(){return ne._update(!0)}),e.window!==void 0&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Bi(this,V);var pe=typeof V.hash=="string"&&V.hash||void 0;this._hash=V.hash&&new Lr(pe).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:V.center,zoom:V.zoom,bearing:V.bearing,pitch:V.pitch}),V.bounds&&(this.resize(),this.fitBounds(V.bounds,e.extend({},V.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=V.localIdeographFontFamily,V.style&&this.setStyle(V.style,{localIdeographFontFamily:V.localIdeographFontFamily}),V.attributionControl&&this.addControl(new Ni({customAttribution:V.customAttribution})),this.addControl(new xs,V.logoPosition),this.on("style.load",function(){ne.transform.unmodified&&ne.jumpTo(ne.style.stylesheet)}),this.on("data",function(ye){ne._update(ye.dataType==="style"),ne.fire(new e.Event(ye.dataType+"data",ye))}),this.on("dataloading",function(ye){ne.fire(new e.Event(ye.dataType+"dataloading",ye))})}E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R;var F={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return R.prototype._getMapId=function(){return this._mapId},R.prototype.addControl=function(V,ne){if(ne===void 0&&V.getDefaultPosition&&(ne=V.getDefaultPosition()),ne===void 0&&(ne="top-right"),!V||!V.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var le=V.onAdd(this);this._controls.push(V);var pe=this._controlPositions[ne];return ne.indexOf("bottom")!==-1?pe.insertBefore(le,pe.firstChild):pe.appendChild(le),this},R.prototype.removeControl=function(V){if(!V||!V.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var ne=this._controls.indexOf(V);return ne>-1&&this._controls.splice(ne,1),V.onRemove(this),this},R.prototype.resize=function(V){var ne=this._containerDimensions(),le=ne[0],pe=ne[1];this._resizeCanvas(le,pe),this.transform.resize(le,pe),this.painter.resize(le,pe);var ye=!this._moving;return ye&&(this.stop(),this.fire(new e.Event("movestart",V)).fire(new e.Event("move",V))),this.fire(new e.Event("resize",V)),ye&&this.fire(new e.Event("moveend",V)),this},R.prototype.getBounds=function(){return this.transform.getBounds()},R.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},R.prototype.setMaxBounds=function(V){return this.transform.setMaxBounds(e.LngLatBounds.convert(V)),this._update()},R.prototype.setMinZoom=function(V){if((V=V==null?-2:V)>=-2&&V<=this.transform.maxZoom)return this.transform.minZoom=V,this._update(),this.getZoom()<V&&this.setZoom(V),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},R.prototype.getMinZoom=function(){return this.transform.minZoom},R.prototype.setMaxZoom=function(V){if((V=V==null?22:V)>=this.transform.minZoom)return this.transform.maxZoom=V,this._update(),this.getZoom()>V&&this.setZoom(V),this;throw new Error("maxZoom must be greater than the current minZoom")},R.prototype.getMaxZoom=function(){return this.transform.maxZoom},R.prototype.setMinPitch=function(V){if((V=V==null?0:V)<0)throw new Error("minPitch must be greater than or equal to 0");if(V>=0&&V<=this.transform.maxPitch)return this.transform.minPitch=V,this._update(),this.getPitch()<V&&this.setPitch(V),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},R.prototype.getMinPitch=function(){return this.transform.minPitch},R.prototype.setMaxPitch=function(V){if((V=V==null?60:V)>60)throw new Error("maxPitch must be less than or equal to 60");if(V>=this.transform.minPitch)return this.transform.maxPitch=V,this._update(),this.getPitch()>V&&this.setPitch(V),this;throw new Error("maxPitch must be greater than the current minPitch")},R.prototype.getMaxPitch=function(){return this.transform.maxPitch},R.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},R.prototype.setRenderWorldCopies=function(V){return this.transform.renderWorldCopies=V,this._update()},R.prototype.project=function(V){return this.transform.locationPoint(e.LngLat.convert(V))},R.prototype.unproject=function(V){return this.transform.pointLocation(e.Point.convert(V))},R.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},R.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},R.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},R.prototype._createDelegatedListener=function(V,ne,le){var pe,ye=this;if(V==="mouseenter"||V==="mouseover"){var Te=!1;return{layer:ne,listener:le,delegates:{mousemove:function(Ge){var nt=ye.getLayer(ne)?ye.queryRenderedFeatures(Ge.point,{layers:[ne]}):[];nt.length?Te||(Te=!0,le.call(ye,new Rn(V,ye,Ge.originalEvent,{features:nt}))):Te=!1},mouseout:function(){Te=!1}}}}if(V==="mouseleave"||V==="mouseout"){var Ne=!1;return{layer:ne,listener:le,delegates:{mousemove:function(Ge){(ye.getLayer(ne)?ye.queryRenderedFeatures(Ge.point,{layers:[ne]}):[]).length?Ne=!0:Ne&&(Ne=!1,le.call(ye,new Rn(V,ye,Ge.originalEvent)))},mouseout:function(Ge){Ne&&(Ne=!1,le.call(ye,new Rn(V,ye,Ge.originalEvent)))}}}}return{layer:ne,listener:le,delegates:(pe={},pe[V]=function(Ge){var nt=ye.getLayer(ne)?ye.queryRenderedFeatures(Ge.point,{layers:[ne]}):[];nt.length&&(Ge.features=nt,le.call(ye,Ge),delete Ge.features)},pe)}},R.prototype.on=function(V,ne,le){if(le===void 0)return E.prototype.on.call(this,V,ne);var pe=this._createDelegatedListener(V,ne,le);for(var ye in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[V]=this._delegatedListeners[V]||[],this._delegatedListeners[V].push(pe),pe.delegates)this.on(ye,pe.delegates[ye]);return this},R.prototype.once=function(V,ne,le){if(le===void 0)return E.prototype.once.call(this,V,ne);var pe=this._createDelegatedListener(V,ne,le);for(var ye in pe.delegates)this.once(ye,pe.delegates[ye]);return this},R.prototype.off=function(V,ne,le){var pe=this;return le===void 0?E.prototype.off.call(this,V,ne):(this._delegatedListeners&&this._delegatedListeners[V]&&function(ye){for(var Te=ye[V],Ne=0;Ne<Te.length;Ne++){var Ge=Te[Ne];if(Ge.layer===ne&&Ge.listener===le){for(var nt in Ge.delegates)pe.off(nt,Ge.delegates[nt]);return Te.splice(Ne,1),pe}}}(this._delegatedListeners),this)},R.prototype.queryRenderedFeatures=function(V,ne){if(!this.style)return[];var le;if(ne!==void 0||V===void 0||V instanceof e.Point||Array.isArray(V)||(ne=V,V=void 0),ne=ne||{},(V=V||[[0,0],[this.transform.width,this.transform.height]])instanceof e.Point||typeof V[0]=="number")le=[e.Point.convert(V)];else{var pe=e.Point.convert(V[0]),ye=e.Point.convert(V[1]);le=[pe,new e.Point(ye.x,pe.y),ye,new e.Point(pe.x,ye.y),pe]}return this.style.queryRenderedFeatures(le,ne,this.transform)},R.prototype.querySourceFeatures=function(V,ne){return this.style.querySourceFeatures(V,ne)},R.prototype.setStyle=function(V,ne){return(ne=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},ne)).diff!==!1&&ne.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&V?(this._diffStyle(V,ne),this):(this._localIdeographFontFamily=ne.localIdeographFontFamily,this._updateStyle(V,ne))},R.prototype._getUIString=function(V){var ne=this._locale[V];if(ne==null)throw new Error("Missing UI string '"+V+"'");return ne},R.prototype._updateStyle=function(V,ne){return this.style&&(this.style.setEventedParent(null),this.style._remove()),V?(this.style=new Yn(this,ne||{}),this.style.setEventedParent(this,{style:this.style}),typeof V=="string"?this.style.loadURL(V):this.style.loadJSON(V),this):(delete this.style,this)},R.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Yn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},R.prototype._diffStyle=function(V,ne){var le=this;if(typeof V=="string"){var pe=this._requestManager.normalizeStyleURL(V),ye=this._requestManager.transformRequest(pe,e.ResourceType.Style);e.getJSON(ye,function(Te,Ne){Te?le.fire(new e.ErrorEvent(Te)):Ne&&le._updateDiff(Ne,ne)})}else typeof V=="object"&&this._updateDiff(V,ne)},R.prototype._updateDiff=function(V,ne){try{this.style.setState(V)&&this._update(!0)}catch(le){e.warnOnce("Unable to perform style diff: "+(le.message||le.error||le)+".  Rebuilding the style from scratch."),this._updateStyle(V,ne)}},R.prototype.getStyle=function(){if(this.style)return this.style.serialize()},R.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},R.prototype.addSource=function(V,ne){return this._lazyInitEmptyStyle(),this.style.addSource(V,ne),this._update(!0)},R.prototype.isSourceLoaded=function(V){var ne=this.style&&this.style.sourceCaches[V];if(ne!==void 0)return ne.loaded();this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+V+"'")))},R.prototype.areTilesLoaded=function(){var V=this.style&&this.style.sourceCaches;for(var ne in V){var le=V[ne]._tiles;for(var pe in le){var ye=le[pe];if(ye.state!=="loaded"&&ye.state!=="errored")return!1}}return!0},R.prototype.addSourceType=function(V,ne,le){return this._lazyInitEmptyStyle(),this.style.addSourceType(V,ne,le)},R.prototype.removeSource=function(V){return this.style.removeSource(V),this._update(!0)},R.prototype.getSource=function(V){return this.style.getSource(V)},R.prototype.addImage=function(V,ne,le){le===void 0&&(le={});var pe=le.pixelRatio;pe===void 0&&(pe=1);var ye=le.sdf;ye===void 0&&(ye=!1);var Te=le.stretchX,Ne=le.stretchY,Ge=le.content;if(this._lazyInitEmptyStyle(),ne instanceof ml||bs&&ne instanceof bs){var nt=e.browser.getImageData(ne),bt=nt.width,Ct=nt.height,Tt=nt.data;this.style.addImage(V,{data:new e.RGBAImage({width:bt,height:Ct},Tt),pixelRatio:pe,stretchX:Te,stretchY:Ne,content:Ge,sdf:ye,version:0})}else{if(ne.width===void 0||ne.height===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var At=ne.width,yt=ne.height,Ft=ne.data,zt=ne;this.style.addImage(V,{data:new e.RGBAImage({width:At,height:yt},new Uint8Array(Ft)),pixelRatio:pe,stretchX:Te,stretchY:Ne,content:Ge,sdf:ye,version:0,userImage:zt}),zt.onAdd&&zt.onAdd(this,V)}},R.prototype.updateImage=function(V,ne){var le=this.style.getImage(V);if(!le)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var pe=ne instanceof ml||bs&&ne instanceof bs?e.browser.getImageData(ne):ne,ye=pe.width,Te=pe.height,Ne=pe.data;if(ye===void 0||Te===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(ye!==le.data.width||Te!==le.data.height)return this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var Ge=!(ne instanceof ml||bs&&ne instanceof bs);le.data.replace(Ne,Ge),this.style.updateImage(V,le)},R.prototype.hasImage=function(V){return V?!!this.style.getImage(V):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},R.prototype.removeImage=function(V){this.style.removeImage(V)},R.prototype.loadImage=function(V,ne){e.getImage(this._requestManager.transformRequest(V,e.ResourceType.Image),ne)},R.prototype.listImages=function(){return this.style.listImages()},R.prototype.addLayer=function(V,ne){return this._lazyInitEmptyStyle(),this.style.addLayer(V,ne),this._update(!0)},R.prototype.moveLayer=function(V,ne){return this.style.moveLayer(V,ne),this._update(!0)},R.prototype.removeLayer=function(V){return this.style.removeLayer(V),this._update(!0)},R.prototype.getLayer=function(V){return this.style.getLayer(V)},R.prototype.setLayerZoomRange=function(V,ne,le){return this.style.setLayerZoomRange(V,ne,le),this._update(!0)},R.prototype.setFilter=function(V,ne,le){return le===void 0&&(le={}),this.style.setFilter(V,ne,le),this._update(!0)},R.prototype.getFilter=function(V){return this.style.getFilter(V)},R.prototype.setPaintProperty=function(V,ne,le,pe){return pe===void 0&&(pe={}),this.style.setPaintProperty(V,ne,le,pe),this._update(!0)},R.prototype.getPaintProperty=function(V,ne){return this.style.getPaintProperty(V,ne)},R.prototype.setLayoutProperty=function(V,ne,le,pe){return pe===void 0&&(pe={}),this.style.setLayoutProperty(V,ne,le,pe),this._update(!0)},R.prototype.getLayoutProperty=function(V,ne){return this.style.getLayoutProperty(V,ne)},R.prototype.setLight=function(V,ne){return ne===void 0&&(ne={}),this._lazyInitEmptyStyle(),this.style.setLight(V,ne),this._update(!0)},R.prototype.getLight=function(){return this.style.getLight()},R.prototype.setFeatureState=function(V,ne){return this.style.setFeatureState(V,ne),this._update()},R.prototype.removeFeatureState=function(V,ne){return this.style.removeFeatureState(V,ne),this._update()},R.prototype.getFeatureState=function(V){return this.style.getFeatureState(V)},R.prototype.getContainer=function(){return this._container},R.prototype.getCanvasContainer=function(){return this._canvasContainer},R.prototype.getCanvas=function(){return this._canvas},R.prototype._containerDimensions=function(){var V=0,ne=0;return this._container&&(V=this._container.clientWidth||400,ne=this._container.clientHeight||300),[V,ne]},R.prototype._detectMissingCSS=function(){e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},R.prototype._setupContainer=function(){var V=this._container;V.classList.add("mapboxgl-map"),(this._missingCSSCanary=u.create("div","mapboxgl-canary",V)).style.visibility="hidden",this._detectMissingCSS();var ne=this._canvasContainer=u.create("div","mapboxgl-canvas-container",V);this._interactive&&ne.classList.add("mapboxgl-interactive"),this._canvas=u.create("canvas","mapboxgl-canvas",ne),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var le=this._containerDimensions();this._resizeCanvas(le[0],le[1]);var pe=this._controlContainer=u.create("div","mapboxgl-control-container",V),ye=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Te){ye[Te]=u.create("div","mapboxgl-ctrl-"+Te,pe)})},R.prototype._resizeCanvas=function(V,ne){var le=e.browser.devicePixelRatio||1;this._canvas.width=le*V,this._canvas.height=le*ne,this._canvas.style.width=V+"px",this._canvas.style.height=ne+"px"},R.prototype._setupPainter=function(){var V=e.extend({},f.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),ne=this._canvas.getContext("webgl",V)||this._canvas.getContext("experimental-webgl",V);ne?(this.painter=new Oa(ne,this.transform),e.webpSupported.testSupport(ne)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))},R.prototype._contextLost=function(V){V.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:V}))},R.prototype._contextRestored=function(V){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:V}))},R.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},R.prototype._update=function(V){return this.style?(this._styleDirty=this._styleDirty||V,this._sourcesDirty=!0,this.triggerRepaint(),this):this},R.prototype._requestRenderFrame=function(V){return this._update(),this._renderTaskQueue.add(V)},R.prototype._cancelRenderFrame=function(V){this._renderTaskQueue.remove(V)},R.prototype._render=function(V){var ne,le=this,pe=0,ye=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(ne=ye.createQueryEXT(),ye.beginQueryEXT(ye.TIME_ELAPSED_EXT,ne),pe=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(V),!this._removed){var Te=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ne=this.transform.zoom,Ge=e.browser.now();this.style.zoomHistory.update(Ne,Ge);var nt=new e.EvaluationParameters(Ne,{now:Ge,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),bt=nt.crossFadingFactor();bt===1&&bt===this._crossFadingFactor||(Te=!0,this._crossFadingFactor=bt),this.style.update(nt)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||Te)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ct=e.browser.now()-pe;ye.endQueryEXT(ye.TIME_ELAPSED_EXT,ne),setTimeout(function(){var At=ye.getQueryObjectEXT(ne,ye.QUERY_RESULT_EXT)/1e6;ye.deleteQueryEXT(ne),le.fire(new e.Event("gpu-timing-frame",{cpuTime:Ct,gpuTime:At}))},50)}if(this.listens("gpu-timing-layer")){var Tt=this.painter.collectGpuTimers();setTimeout(function(){var At=le.painter.queryGpuTimers(Tt);le.fire(new e.Event("gpu-timing-layer",{layerTimes:At}))},50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},R.prototype.remove=function(){this._hash&&this._hash.remove();for(var V=0,ne=this._controls;V<ne.length;V+=1)ne[V].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),e.window!==void 0&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var le=this.painter.context.gl.getExtension("WEBGL_lose_context");le&&le.loseContext(),Il(this._canvasContainer),Il(this._controlContainer),Il(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},R.prototype.triggerRepaint=function(){var V=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(ne){V._frame=null,V._render(ne)}))},R.prototype._onWindowOnline=function(){this._update()},R.prototype._onWindowResize=function(V){this._trackResize&&this.resize({originalEvent:V})._update()},F.showTileBoundaries.get=function(){return!!this._showTileBoundaries},F.showTileBoundaries.set=function(V){this._showTileBoundaries!==V&&(this._showTileBoundaries=V,this._update())},F.showPadding.get=function(){return!!this._showPadding},F.showPadding.set=function(V){this._showPadding!==V&&(this._showPadding=V,this._update())},F.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},F.showCollisionBoxes.set=function(V){this._showCollisionBoxes!==V&&(this._showCollisionBoxes=V,V?this.style._generateCollisionBoxes():this._update())},F.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},F.showOverdrawInspector.set=function(V){this._showOverdrawInspector!==V&&(this._showOverdrawInspector=V,this._update())},F.repaint.get=function(){return!!this._repaint},F.repaint.set=function(V){this._repaint!==V&&(this._repaint=V,this.triggerRepaint())},F.vertices.get=function(){return!!this._vertices},F.vertices.set=function(V){this._vertices=V,this._update()},R.prototype._setCacheLimits=function(V,ne){e.setCacheLimits(V,ne)},F.version.get=function(){return e.version},Object.defineProperties(R.prototype,F),R}(dl);function Il(E){E.parentNode&&E.parentNode.removeChild(E)}var $s={showCompass:!0,showZoom:!0,visualizePitch:!1},Ja=function(E){var R=this;this.options=e.extend({},$s,E),this._container=u.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(F){return F.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(F){return R._map.zoomIn({},{originalEvent:F})}),u.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(F){return R._map.zoomOut({},{originalEvent:F})}),u.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(F){R.options.visualizePitch?R._map.resetNorthPitch({},{originalEvent:F}):R._map.resetNorth({},{originalEvent:F})}),this._compassIcon=u.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Ja.prototype._updateZoomButtons=function(){var E=this._map.getZoom();this._zoomInButton.disabled=E===this._map.getMaxZoom(),this._zoomOutButton.disabled=E===this._map.getMinZoom()},Ja.prototype._rotateCompassArrow=function(){var E=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=E},Ja.prototype.onAdd=function(E){return this._map=E,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new oi(this._map,this._compass,this.options.visualizePitch)),this._container},Ja.prototype.onRemove=function(){u.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Ja.prototype._createButton=function(E,R){var F=u.create("button",E,this._container);return F.type="button",F.addEventListener("click",R),F},Ja.prototype._setButtonTitle=function(E,R){var F=this._map._getUIString("NavigationControl."+R);E.title=F,E.setAttribute("aria-label",F)};var oi=function(E,R,F){F===void 0&&(F=!1),this._clickTolerance=10,this.element=R,this.mouseRotate=new Sa({clickTolerance:E.dragRotate._mouseRotate._clickTolerance}),this.map=E,F&&(this.mousePitch=new da({clickTolerance:E.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener(R,"mousedown",this.mousedown),u.addEventListener(R,"touchstart",this.touchstart,{passive:!1}),u.addEventListener(R,"touchmove",this.touchmove),u.addEventListener(R,"touchend",this.touchend),u.addEventListener(R,"touchcancel",this.reset)};function Rs(E,R,F){if(E=new e.LngLat(E.lng,E.lat),R){var V=new e.LngLat(E.lng-360,E.lat),ne=new e.LngLat(E.lng+360,E.lat),le=F.locationPoint(E).distSqr(R);F.locationPoint(V).distSqr(R)<le?E=V:F.locationPoint(ne).distSqr(R)<le&&(E=ne)}for(;Math.abs(E.lng-F.center.lng)>180;){var pe=F.locationPoint(E);if(pe.x>=0&&pe.y>=0&&pe.x<=F.width&&pe.y<=F.height)break;E.lng>F.center.lng?E.lng-=360:E.lng+=360}return E}oi.prototype.down=function(E,R){this.mouseRotate.mousedown(E,R),this.mousePitch&&this.mousePitch.mousedown(E,R),u.disableDrag()},oi.prototype.move=function(E,R){var F=this.map,V=this.mouseRotate.mousemoveWindow(E,R);if(V&&V.bearingDelta&&F.setBearing(F.getBearing()+V.bearingDelta),this.mousePitch){var ne=this.mousePitch.mousemoveWindow(E,R);ne&&ne.pitchDelta&&F.setPitch(F.getPitch()+ne.pitchDelta)}},oi.prototype.off=function(){var E=this.element;u.removeEventListener(E,"mousedown",this.mousedown),u.removeEventListener(E,"touchstart",this.touchstart,{passive:!1}),u.removeEventListener(E,"touchmove",this.touchmove),u.removeEventListener(E,"touchend",this.touchend),u.removeEventListener(E,"touchcancel",this.reset),this.offTemp()},oi.prototype.offTemp=function(){u.enableDrag(),u.removeEventListener(e.window,"mousemove",this.mousemove),u.removeEventListener(e.window,"mouseup",this.mouseup)},oi.prototype.mousedown=function(E){this.down(e.extend({},E,{ctrlKey:!0,preventDefault:function(){return E.preventDefault()}}),u.mousePos(this.element,E)),u.addEventListener(e.window,"mousemove",this.mousemove),u.addEventListener(e.window,"mouseup",this.mouseup)},oi.prototype.mousemove=function(E){this.move(E,u.mousePos(this.element,E))},oi.prototype.mouseup=function(E){this.mouseRotate.mouseupWindow(E),this.mousePitch&&this.mousePitch.mouseupWindow(E),this.offTemp()},oi.prototype.touchstart=function(E){E.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=u.touchPos(this.element,E.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return E.preventDefault()}},this._startPos))},oi.prototype.touchmove=function(E){E.targetTouches.length!==1?this.reset():(this._lastPos=u.touchPos(this.element,E.targetTouches)[0],this.move({preventDefault:function(){return E.preventDefault()}},this._lastPos))},oi.prototype.touchend=function(E){E.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},oi.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Ss={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Di(E,R,F){var V=E.classList;for(var ne in Ss)V.remove("mapboxgl-"+F+"-anchor-"+ne);V.add("mapboxgl-"+F+"-anchor-"+R)}var Fs,Qs=function(E){function R(F,V){var ne=this;if(E.call(this),(F instanceof e.window.HTMLElement||V)&&(F=e.extend({element:F},V)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=F&&F.anchor||"center",this._color=F&&F.color||"#3FB1CE",this._draggable=F&&F.draggable||!1,this._state="inactive",this._rotation=F&&F.rotation||0,this._rotationAlignment=F&&F.rotationAlignment||"auto",this._pitchAlignment=F&&F.pitchAlignment&&F.pitchAlignment!=="auto"?F.pitchAlignment:this._rotationAlignment,F&&F.element)this._element=F.element,this._offset=e.Point.convert(F&&F.offset||[0,0]);else{this._defaultMarker=!0,this._element=u.create("div"),this._element.setAttribute("aria-label","Map marker");var le=u.createNS("http://www.w3.org/2000/svg","svg");le.setAttributeNS(null,"display","block"),le.setAttributeNS(null,"height","41px"),le.setAttributeNS(null,"width","27px"),le.setAttributeNS(null,"viewBox","0 0 27 41");var pe=u.createNS("http://www.w3.org/2000/svg","g");pe.setAttributeNS(null,"stroke","none"),pe.setAttributeNS(null,"stroke-width","1"),pe.setAttributeNS(null,"fill","none"),pe.setAttributeNS(null,"fill-rule","evenodd");var ye=u.createNS("http://www.w3.org/2000/svg","g");ye.setAttributeNS(null,"fill-rule","nonzero");var Te=u.createNS("http://www.w3.org/2000/svg","g");Te.setAttributeNS(null,"transform","translate(3.0, 29.0)"),Te.setAttributeNS(null,"fill","#000000");for(var Ne=0,Ge=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Ne<Ge.length;Ne+=1){var nt=Ge[Ne],bt=u.createNS("http://www.w3.org/2000/svg","ellipse");bt.setAttributeNS(null,"opacity","0.04"),bt.setAttributeNS(null,"cx","10.5"),bt.setAttributeNS(null,"cy","5.80029008"),bt.setAttributeNS(null,"rx",nt.rx),bt.setAttributeNS(null,"ry",nt.ry),Te.appendChild(bt)}var Ct=u.createNS("http://www.w3.org/2000/svg","g");Ct.setAttributeNS(null,"fill",this._color);var Tt=u.createNS("http://www.w3.org/2000/svg","path");Tt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Ct.appendChild(Tt);var At=u.createNS("http://www.w3.org/2000/svg","g");At.setAttributeNS(null,"opacity","0.25"),At.setAttributeNS(null,"fill","#000000");var yt=u.createNS("http://www.w3.org/2000/svg","path");yt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),At.appendChild(yt);var Ft=u.createNS("http://www.w3.org/2000/svg","g");Ft.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ft.setAttributeNS(null,"fill","#FFFFFF");var zt=u.createNS("http://www.w3.org/2000/svg","g");zt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var jt=u.createNS("http://www.w3.org/2000/svg","circle");jt.setAttributeNS(null,"fill","#000000"),jt.setAttributeNS(null,"opacity","0.25"),jt.setAttributeNS(null,"cx","5.5"),jt.setAttributeNS(null,"cy","5.5"),jt.setAttributeNS(null,"r","5.4999962");var rr=u.createNS("http://www.w3.org/2000/svg","circle");rr.setAttributeNS(null,"fill","#FFFFFF"),rr.setAttributeNS(null,"cx","5.5"),rr.setAttributeNS(null,"cy","5.5"),rr.setAttributeNS(null,"r","5.4999962"),zt.appendChild(jt),zt.appendChild(rr),ye.appendChild(Te),ye.appendChild(Ct),ye.appendChild(At),ye.appendChild(Ft),ye.appendChild(zt),le.appendChild(ye),this._element.appendChild(le),this._offset=e.Point.convert(F&&F.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(hr){hr.preventDefault()}),this._element.addEventListener("mousedown",function(hr){hr.preventDefault()}),this._element.addEventListener("focus",function(){var hr=ne._map.getContainer();hr.scrollTop=0,hr.scrollLeft=0}),Di(this._element,this._anchor,"marker"),this._popup=null}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.addTo=function(F){return this.remove(),this._map=F,F.getCanvasContainer().appendChild(this._element),F.on("move",this._update),F.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},R.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),u.remove(this._element),this._popup&&this._popup.remove(),this},R.prototype.getLngLat=function(){return this._lngLat},R.prototype.setLngLat=function(F){return this._lngLat=e.LngLat.convert(F),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},R.prototype.getElement=function(){return this._element},R.prototype.setPopup=function(F){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),F){if(!("offset"in F.options)){var V=Math.sqrt(Math.pow(13.5,2)/2);F.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[V,-1*(24.6+V)],"bottom-right":[-V,-1*(24.6+V)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=F,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},R.prototype._onKeyPress=function(F){var V=F.code,ne=F.charCode||F.keyCode;V!=="Space"&&V!=="Enter"&&ne!==32&&ne!==13||this.togglePopup()},R.prototype._onMapClick=function(F){var V=F.originalEvent.target,ne=this._element;this._popup&&(V===ne||ne.contains(V))&&this.togglePopup()},R.prototype.getPopup=function(){return this._popup},R.prototype.togglePopup=function(){var F=this._popup;return F?(F.isOpen()?F.remove():F.addTo(this._map),this):this},R.prototype._update=function(F){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Rs(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var V="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?V="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(V="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var ne="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?ne="rotateX(0deg)":this._pitchAlignment==="map"&&(ne="rotateX("+this._map.getPitch()+"deg)"),F&&F.type!=="moveend"||(this._pos=this._pos.round()),u.setTransform(this._element,Ss[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+ne+" "+V)}},R.prototype.getOffset=function(){return this._offset},R.prototype.setOffset=function(F){return this._offset=e.Point.convert(F),this._update(),this},R.prototype._onMove=function(F){this._pos=F.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},R.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new e.Event("dragend")),this._state="inactive"},R.prototype._addDragHandler=function(F){this._element.contains(F.originalEvent.target)&&(F.preventDefault(),this._positionDelta=F.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},R.prototype.setDraggable=function(F){return this._draggable=!!F,this._map&&(F?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},R.prototype.isDraggable=function(){return this._draggable},R.prototype.setRotation=function(F){return this._rotation=F||0,this._update(),this},R.prototype.getRotation=function(){return this._rotation},R.prototype.setRotationAlignment=function(F){return this._rotationAlignment=F||"auto",this._update(),this},R.prototype.getRotationAlignment=function(){return this._rotationAlignment},R.prototype.setPitchAlignment=function(F){return this._pitchAlignment=F&&F!=="auto"?F:this._rotationAlignment,this._update(),this},R.prototype.getPitchAlignment=function(){return this._pitchAlignment},R}(e.Evented),Gs={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},el=0,Es=!1,Ol=function(E){function R(F){E.call(this),this.options=e.extend({},Gs,F),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.onAdd=function(F){var V;return this._map=F,this._container=u.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),V=this._setupUI,Fs!==void 0?V(Fs):e.window.navigator.permissions!==void 0?e.window.navigator.permissions.query({name:"geolocation"}).then(function(ne){Fs=ne.state!=="denied",V(Fs)}):(Fs=!!e.window.navigator.geolocation,V(Fs)),this._container},R.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),u.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,el=0,Es=!1},R.prototype._isOutOfMapMaxBounds=function(F){var V=this._map.getMaxBounds(),ne=F.coords;return V&&(ne.longitude<V.getWest()||ne.longitude>V.getEast()||ne.latitude<V.getSouth()||ne.latitude>V.getNorth())},R.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},R.prototype._onSuccess=function(F){if(this._map){if(this._isOutOfMapMaxBounds(F))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",F)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=F,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(F),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(F),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",F)),this._finish()}},R.prototype._updateCamera=function(F){var V=new e.LngLat(F.coords.longitude,F.coords.latitude),ne=F.coords.accuracy,le=this._map.getBearing(),pe=e.extend({bearing:le},this.options.fitBoundsOptions);this._map.fitBounds(V.toBounds(ne),pe,{geolocateSource:!0})},R.prototype._updateMarker=function(F){if(F){var V=new e.LngLat(F.coords.longitude,F.coords.latitude);this._accuracyCircleMarker.setLngLat(V).addTo(this._map),this._userLocationDotMarker.setLngLat(V).addTo(this._map),this._accuracy=F.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},R.prototype._updateCircleRadius=function(){var F=this._map._container.clientHeight/2,V=this._map.unproject([0,F]),ne=this._map.unproject([1,F]),le=V.distanceTo(ne),pe=Math.ceil(2*this._accuracy/le);this._circleElement.style.width=pe+"px",this._circleElement.style.height=pe+"px"},R.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},R.prototype._onError=function(F){if(this._map){if(this.options.trackUserLocation)if(F.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var V=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=V,this._geolocateButton.setAttribute("aria-label",V),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(F.code===3&&Es)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",F)),this._finish()}},R.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},R.prototype._setupUI=function(F){var V=this;if(this._container.addEventListener("contextmenu",function(pe){return pe.preventDefault()}),this._geolocateButton=u.create("button","mapboxgl-ctrl-geolocate",this._container),u.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",F===!1){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var ne=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=ne,this._geolocateButton.setAttribute("aria-label",ne)}else{var le=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=le,this._geolocateButton.setAttribute("aria-label",le)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=u.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Qs(this._dotElement),this._circleElement=u.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Qs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(pe){var ye=pe.originalEvent&&pe.originalEvent.type==="resize";pe.geolocateSource||V._watchState!=="ACTIVE_LOCK"||ye||(V._watchState="BACKGROUND",V._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),V._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),V.fire(new e.Event("trackuserlocationend")))})},R.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":el--,Es=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var F;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++el>1?(F={maximumAge:6e5,timeout:0},Es=!0):(F=this.options.positionOptions,Es=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,F)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},R.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},R}(e.Evented),Xl={maxWidth:100,unit:"metric"},Bs=function(E){this.options=e.extend({},Xl,E),e.bindAll(["_onMove","setUnit"],this)};function Dl(E,R,F){var V=F&&F.maxWidth||100,ne=E._container.clientHeight/2,le=E.unproject([0,ne]),pe=E.unproject([V,ne]),ye=le.distanceTo(pe);if(F&&F.unit==="imperial"){var Te=3.2808*ye;Te>5280?tl(R,V,Te/5280,E._getUIString("ScaleControl.Miles")):tl(R,V,Te,E._getUIString("ScaleControl.Feet"))}else F&&F.unit==="nautical"?tl(R,V,ye/1852,E._getUIString("ScaleControl.NauticalMiles")):ye>=1e3?tl(R,V,ye/1e3,E._getUIString("ScaleControl.Kilometers")):tl(R,V,ye,E._getUIString("ScaleControl.Meters"))}function tl(E,R,F,V){var ne,le,pe,ye=(ne=F,le=Math.pow(10,(""+Math.floor(ne)).length-1),pe=(pe=ne/le)>=10?10:pe>=5?5:pe>=3?3:pe>=2?2:pe>=1?1:function(Ne){var Ge=Math.pow(10,Math.ceil(-Math.log(Ne)/Math.LN10));return Math.round(Ne*Ge)/Ge}(pe),le*pe),Te=ye/F;E.style.width=R*Te+"px",E.innerHTML=ye+"&nbsp;"+V}Bs.prototype.getDefaultPosition=function(){return"bottom-left"},Bs.prototype._onMove=function(){Dl(this._map,this._container,this.options)},Bs.prototype.onAdd=function(E){return this._map=E,this._container=u.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",E.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Bs.prototype.onRemove=function(){u.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Bs.prototype.setUnit=function(E){this.options.unit=E,Dl(this._map,this._container,this.options)};var lo=function(E){this._fullscreen=!1,E&&E.container&&(E.container instanceof e.window.HTMLElement?this._container=E.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};lo.prototype.onAdd=function(E){return this._map=E,this._container||(this._container=this._map.getContainer()),this._controlContainer=u.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},lo.prototype.onRemove=function(){u.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},lo.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},lo.prototype._setupUI=function(){var E=this._fullscreenButton=u.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);u.create("span","mapboxgl-ctrl-icon",E).setAttribute("aria-hidden",!0),E.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},lo.prototype._updateTitle=function(){var E=this._getTitle();this._fullscreenButton.setAttribute("aria-label",E),this._fullscreenButton.title=E},lo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},lo.prototype._isFullscreen=function(){return this._fullscreen},lo.prototype._changeIcon=function(){(e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},lo.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Zl={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Kl=function(E){function R(F){E.call(this),this.options=e.extend(Object.create(Zl),F),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return E&&(R.__proto__=E),R.prototype=Object.create(E&&E.prototype),R.prototype.constructor=R,R.prototype.addTo=function(F){return this._map&&this.remove(),this._map=F,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},R.prototype.isOpen=function(){return!!this._map},R.prototype.remove=function(){return this._content&&u.remove(this._content),this._container&&(u.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},R.prototype.getLngLat=function(){return this._lngLat},R.prototype.setLngLat=function(F){return this._lngLat=e.LngLat.convert(F),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},R.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},R.prototype.getElement=function(){return this._container},R.prototype.setText=function(F){return this.setDOMContent(e.window.document.createTextNode(F))},R.prototype.setHTML=function(F){var V,ne=e.window.document.createDocumentFragment(),le=e.window.document.createElement("body");for(le.innerHTML=F;V=le.firstChild;)ne.appendChild(V);return this.setDOMContent(ne)},R.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},R.prototype.setMaxWidth=function(F){return this.options.maxWidth=F,this._update(),this},R.prototype.setDOMContent=function(F){return this._createContent(),this._content.appendChild(F),this._update(),this},R.prototype.addClassName=function(F){this._container&&this._container.classList.add(F)},R.prototype.removeClassName=function(F){this._container&&this._container.classList.remove(F)},R.prototype.toggleClassName=function(F){if(this._container)return this._container.classList.toggle(F)},R.prototype._createContent=function(){this._content&&u.remove(this._content),this._content=u.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=u.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},R.prototype._onMouseUp=function(F){this._update(F.point)},R.prototype._onMouseMove=function(F){this._update(F.point)},R.prototype._onDrag=function(F){this._update(F.point)},R.prototype._update=function(F){var V=this,ne=this._lngLat||this._trackPointer;if(this._map&&ne&&this._content&&(this._container||(this._container=u.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=u.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(bt){return V._container.classList.add(bt)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Rs(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||F)){var le=this._pos=this._trackPointer&&F?F:this._map.project(this._lngLat),pe=this.options.anchor,ye=function bt(Ct){if(Ct){if(typeof Ct=="number"){var Tt=Math.round(Math.sqrt(.5*Math.pow(Ct,2)));return{center:new e.Point(0,0),top:new e.Point(0,Ct),"top-left":new e.Point(Tt,Tt),"top-right":new e.Point(-Tt,Tt),bottom:new e.Point(0,-Ct),"bottom-left":new e.Point(Tt,-Tt),"bottom-right":new e.Point(-Tt,-Tt),left:new e.Point(Ct,0),right:new e.Point(-Ct,0)}}if(Ct instanceof e.Point||Array.isArray(Ct)){var At=e.Point.convert(Ct);return{center:At,top:At,"top-left":At,"top-right":At,bottom:At,"bottom-left":At,"bottom-right":At,left:At,right:At}}return{center:e.Point.convert(Ct.center||[0,0]),top:e.Point.convert(Ct.top||[0,0]),"top-left":e.Point.convert(Ct["top-left"]||[0,0]),"top-right":e.Point.convert(Ct["top-right"]||[0,0]),bottom:e.Point.convert(Ct.bottom||[0,0]),"bottom-left":e.Point.convert(Ct["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(Ct["bottom-right"]||[0,0]),left:e.Point.convert(Ct.left||[0,0]),right:e.Point.convert(Ct.right||[0,0])}}return bt(new e.Point(0,0))}(this.options.offset);if(!pe){var Te,Ne=this._container.offsetWidth,Ge=this._container.offsetHeight;Te=le.y+ye.bottom.y<Ge?["top"]:le.y>this._map.transform.height-Ge?["bottom"]:[],le.x<Ne/2?Te.push("left"):le.x>this._map.transform.width-Ne/2&&Te.push("right"),pe=Te.length===0?"bottom":Te.join("-")}var nt=le.add(ye[pe]).round();u.setTransform(this._container,Ss[pe]+" translate("+nt.x+"px,"+nt.y+"px)"),Di(this._container,pe,"popup")}},R.prototype._onClose=function(){this.remove()},R}(e.Evented),oe={version:e.version,supported:f,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:is,NavigationControl:Ja,GeolocateControl:Ol,AttributionControl:Ni,ScaleControl:Bs,FullscreenControl:lo,Popup:Kl,Marker:Qs,Style:Yn,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:function(){it().acquire(Lt)},clearPrewarmedResources:function(){var E=Dt;E&&(E.isPreloaded()&&E.numActive()===1?(E.release(Lt),Dt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(E){e.config.ACCESS_TOKEN=E},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(E){e.config.API_URL=E},get workerCount(){return vt.workerCount},set workerCount(E){vt.workerCount=E},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(E){e.config.MAX_PARALLEL_IMAGE_REQUESTS=E},clearStorage:function(E){e.clearTileCache(E)},workerUrl:""};return oe}),m})},{}],452:[function(r,O,B){var t=r("./normalize"),d=r("gl-mat4/create"),m=r("gl-mat4/clone"),p=r("gl-mat4/determinant"),e=r("gl-mat4/invert"),f=r("gl-mat4/transpose"),u={length:r("gl-vec3/length"),normalize:r("gl-vec3/normalize"),dot:r("gl-vec3/dot"),cross:r("gl-vec3/cross")},s=d(),l=d(),o=[0,0,0,0],i=[[0,0,0],[0,0,0],[0,0,0]],c=[0,0,0];function n(a,g,h,y,v){a[0]=g[0]*y+h[0]*v,a[1]=g[1]*y+h[1]*v,a[2]=g[2]*y+h[2]*v}O.exports=function(a,g,h,y,v,_){if(g||(g=[0,0,0]),h||(h=[0,0,0]),y||(y=[0,0,0]),v||(v=[0,0,0,1]),_||(_=[0,0,0,1]),!t(s,a)||(m(l,s),l[3]=0,l[7]=0,l[11]=0,l[15]=1,Math.abs(p(l)<1e-8)))return!1;var x,T,A,S,w,C,k,L=s[3],M=s[7],P=s[11],D=s[12],N=s[13],U=s[14],q=s[15];if(L!==0||M!==0||P!==0){if(o[0]=L,o[1]=M,o[2]=P,o[3]=q,!e(l,l))return!1;f(l,l),x=v,A=l,S=(T=o)[0],w=T[1],C=T[2],k=T[3],x[0]=A[0]*S+A[4]*w+A[8]*C+A[12]*k,x[1]=A[1]*S+A[5]*w+A[9]*C+A[13]*k,x[2]=A[2]*S+A[6]*w+A[10]*C+A[14]*k,x[3]=A[3]*S+A[7]*w+A[11]*C+A[15]*k}else v[0]=v[1]=v[2]=0,v[3]=1;if(g[0]=D,g[1]=N,g[2]=U,function(K,Z){K[0][0]=Z[0],K[0][1]=Z[1],K[0][2]=Z[2],K[1][0]=Z[4],K[1][1]=Z[5],K[1][2]=Z[6],K[2][0]=Z[8],K[2][1]=Z[9],K[2][2]=Z[10]}(i,s),h[0]=u.length(i[0]),u.normalize(i[0],i[0]),y[0]=u.dot(i[0],i[1]),n(i[1],i[1],i[0],1,-y[0]),h[1]=u.length(i[1]),u.normalize(i[1],i[1]),y[0]/=h[1],y[1]=u.dot(i[0],i[2]),n(i[2],i[2],i[0],1,-y[1]),y[2]=u.dot(i[1],i[2]),n(i[2],i[2],i[1],1,-y[2]),h[2]=u.length(i[2]),u.normalize(i[2],i[2]),y[1]/=h[2],y[2]/=h[2],u.cross(c,i[1],i[2]),u.dot(i[0],c)<0)for(var X=0;X<3;X++)h[X]*=-1,i[X][0]*=-1,i[X][1]*=-1,i[X][2]*=-1;return _[0]=.5*Math.sqrt(Math.max(1+i[0][0]-i[1][1]-i[2][2],0)),_[1]=.5*Math.sqrt(Math.max(1-i[0][0]+i[1][1]-i[2][2],0)),_[2]=.5*Math.sqrt(Math.max(1-i[0][0]-i[1][1]+i[2][2],0)),_[3]=.5*Math.sqrt(Math.max(1+i[0][0]+i[1][1]+i[2][2],0)),i[2][1]>i[1][2]&&(_[0]=-_[0]),i[0][2]>i[2][0]&&(_[1]=-_[1]),i[1][0]>i[0][1]&&(_[2]=-_[2]),!0}},{"./normalize":453,"gl-mat4/clone":278,"gl-mat4/create":280,"gl-mat4/determinant":281,"gl-mat4/invert":293,"gl-mat4/transpose":306,"gl-vec3/cross":360,"gl-vec3/dot":365,"gl-vec3/length":375,"gl-vec3/normalize":382}],453:[function(r,O,B){O.exports=function(t,d){var m=d[15];if(m===0)return!1;for(var p=1/m,e=0;e<16;e++)t[e]=d[e]*p;return!0}},{}],454:[function(r,O,B){var t=r("gl-vec3/lerp"),d=r("mat4-recompose"),m=r("mat4-decompose"),p=r("gl-mat4/determinant"),e=r("quat-slerp"),f=l(),u=l(),s=l();function l(){return{translate:o(),scale:o(1),skew:o(),perspective:[0,0,0,1],quaternion:[0,0,0,1]}}function o(i){return[i||0,i||0,i||0]}O.exports=function(i,c,n,a){if(p(c)===0||p(n)===0)return!1;var g=m(c,f.translate,f.scale,f.skew,f.perspective,f.quaternion),h=m(n,u.translate,u.scale,u.skew,u.perspective,u.quaternion);return!(!g||!h)&&(t(s.translate,f.translate,u.translate,a),t(s.skew,f.skew,u.skew,a),t(s.scale,f.scale,u.scale,a),t(s.perspective,f.perspective,u.perspective,a),e(s.quaternion,f.quaternion,u.quaternion,a),d(i,s.translate,s.scale,s.skew,s.perspective,s.quaternion),!0)}},{"gl-mat4/determinant":281,"gl-vec3/lerp":376,"mat4-decompose":452,"mat4-recompose":455,"quat-slerp":515}],455:[function(r,O,B){var t={identity:r("gl-mat4/identity"),translate:r("gl-mat4/translate"),multiply:r("gl-mat4/multiply"),create:r("gl-mat4/create"),scale:r("gl-mat4/scale"),fromRotationTranslation:r("gl-mat4/fromRotationTranslation")},d=(t.create(),t.create());O.exports=function(m,p,e,f,u,s){return t.identity(m),t.fromRotationTranslation(m,s,p),m[3]=u[0],m[7]=u[1],m[11]=u[2],m[15]=u[3],t.identity(d),f[2]!==0&&(d[9]=f[2],t.multiply(m,m,d)),f[1]!==0&&(d[9]=0,d[8]=f[1],t.multiply(m,m,d)),f[0]!==0&&(d[8]=0,d[4]=f[0],t.multiply(m,m,d)),t.scale(m,m,e),m}},{"gl-mat4/create":280,"gl-mat4/fromRotationTranslation":284,"gl-mat4/identity":291,"gl-mat4/multiply":295,"gl-mat4/scale":303,"gl-mat4/translate":305}],456:[function(r,O,B){O.exports=Math.log2||function(t){return Math.log(t)*Math.LOG2E}},{}],457:[function(r,O,B){var t=r("binary-search-bounds"),d=r("mat4-interpolate"),m=r("gl-mat4/invert"),p=r("gl-mat4/rotateX"),e=r("gl-mat4/rotateY"),f=r("gl-mat4/rotateZ"),u=r("gl-mat4/lookAt"),s=r("gl-mat4/translate"),l=(r("gl-mat4/scale"),r("gl-vec3/normalize")),o=[0,0,0];function i(a){this._components=a.slice(),this._time=[0],this.prevMatrix=a.slice(),this.nextMatrix=a.slice(),this.computedMatrix=a.slice(),this.computedInverse=a.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}O.exports=function(a){return new i((a=a||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};var c=i.prototype;c.recalcMatrix=function(a){var g=this._time,h=t.le(g,a),y=this.computedMatrix;if(!(h<0)){var v=this._components;if(h===g.length-1)for(var _=16*h,x=0;x<16;++x)y[x]=v[_++];else{var T=g[h+1]-g[h],A=(_=16*h,this.prevMatrix),S=!0;for(x=0;x<16;++x)A[x]=v[_++];var w=this.nextMatrix;for(x=0;x<16;++x)w[x]=v[_++],S=S&&A[x]===w[x];if(T<1e-6||S)for(x=0;x<16;++x)y[x]=A[x];else d(y,A,w,(a-g[h])/T)}var C=this.computedUp;C[0]=y[1],C[1]=y[5],C[2]=y[9],l(C,C);var k=this.computedInverse;m(k,y);var L=this.computedEye,M=k[15];L[0]=k[12]/M,L[1]=k[13]/M,L[2]=k[14]/M;var P=this.computedCenter,D=Math.exp(this.computedRadius[0]);for(x=0;x<3;++x)P[x]=L[x]-y[2+4*x]*D}},c.idle=function(a){if(!(a<this.lastT())){for(var g=this._components,h=g.length-16,y=0;y<16;++y)g.push(g[h++]);this._time.push(a)}},c.flush=function(a){var g=t.gt(this._time,a)-2;g<0||(this._time.splice(0,g),this._components.splice(0,16*g))},c.lastT=function(){return this._time[this._time.length-1]},c.lookAt=function(a,g,h,y){this.recalcMatrix(a),g=g||this.computedEye,h=h||o,y=y||this.computedUp,this.setMatrix(a,u(this.computedMatrix,g,h,y));for(var v=0,_=0;_<3;++_)v+=Math.pow(h[_]-g[_],2);v=Math.log(Math.sqrt(v)),this.computedRadius[0]=v},c.rotate=function(a,g,h,y){this.recalcMatrix(a);var v=this.computedInverse;g&&e(v,v,g),h&&p(v,v,h),y&&f(v,v,y),this.setMatrix(a,m(this.computedMatrix,v))};var n=[0,0,0];c.pan=function(a,g,h,y){n[0]=-(g||0),n[1]=-(h||0),n[2]=-(y||0),this.recalcMatrix(a);var v=this.computedInverse;s(v,v,n),this.setMatrix(a,m(v,v))},c.translate=function(a,g,h,y){n[0]=g||0,n[1]=h||0,n[2]=y||0,this.recalcMatrix(a);var v=this.computedMatrix;s(v,v,n),this.setMatrix(a,v)},c.setMatrix=function(a,g){if(!(a<this.lastT())){this._time.push(a);for(var h=0;h<16;++h)this._components.push(g[h])}},c.setDistance=function(a,g){this.computedRadius[0]=g},c.setDistanceLimits=function(a,g){var h=this._limits;h[0]=a,h[1]=g},c.getDistanceLimits=function(a){var g=this._limits;return a?(a[0]=g[0],a[1]=g[1],a):g}},{"binary-search-bounds":103,"gl-mat4/invert":293,"gl-mat4/lookAt":294,"gl-mat4/rotateX":300,"gl-mat4/rotateY":301,"gl-mat4/rotateZ":302,"gl-mat4/scale":303,"gl-mat4/translate":305,"gl-vec3/normalize":382,"mat4-interpolate":454}],458:[function(r,O,B){O.exports=function(d){var m=d.length;if(m<3){for(var p=new Array(m),e=0;e<m;++e)p[e]=e;return m===2&&d[0][0]===d[1][0]&&d[0][1]===d[1][1]?[0]:p}var f=new Array(m);for(e=0;e<m;++e)f[e]=e;f.sort(function(g,h){var y=d[g][0]-d[h][0];return y||d[g][1]-d[h][1]});var u=[f[0],f[1]],s=[f[0],f[1]];for(e=2;e<m;++e){for(var l=f[e],o=d[l],i=u.length;i>1&&t(d[u[i-2]],d[u[i-1]],o)<=0;)i-=1,u.pop();for(u.push(l),i=s.length;i>1&&t(d[s[i-2]],d[s[i-1]],o)>=0;)i-=1,s.pop();s.push(l)}p=new Array(s.length+u.length-2);for(var c=0,n=(e=0,u.length);e<n;++e)p[c++]=u[e];for(var a=s.length-2;a>0;--a)p[c++]=s[a];return p};var t=r("robust-orientation")[3]},{"robust-orientation":534}],459:[function(r,O,B){O.exports=function(d,m){m||(m=d,d=window);var p=0,e=0,f=0,u={shift:!1,alt:!1,control:!1,meta:!1},s=!1;function l(_){var x=!1;return"altKey"in _&&(x=x||_.altKey!==u.alt,u.alt=!!_.altKey),"shiftKey"in _&&(x=x||_.shiftKey!==u.shift,u.shift=!!_.shiftKey),"ctrlKey"in _&&(x=x||_.ctrlKey!==u.control,u.control=!!_.ctrlKey),"metaKey"in _&&(x=x||_.metaKey!==u.meta,u.meta=!!_.metaKey),x}function o(_,x){var T=t.x(x),A=t.y(x);"buttons"in x&&(_=0|x.buttons),(_!==p||T!==e||A!==f||l(x))&&(p=0|_,e=T||0,f=A||0,m&&m(p,e,f,u))}function i(_){o(0,_)}function c(){(p||e||f||u.shift||u.alt||u.meta||u.control)&&(e=f=0,p=0,u.shift=u.alt=u.control=u.meta=!1,m&&m(0,0,0,u))}function n(_){l(_)&&m&&m(p,e,f,u)}function a(_){t.buttons(_)===0?o(0,_):o(p,_)}function g(_){o(p|t.buttons(_),_)}function h(_){o(p&~t.buttons(_),_)}function y(){s||(s=!0,d.addEventListener("mousemove",a),d.addEventListener("mousedown",g),d.addEventListener("mouseup",h),d.addEventListener("mouseleave",i),d.addEventListener("mouseenter",i),d.addEventListener("mouseout",i),d.addEventListener("mouseover",i),d.addEventListener("blur",c),d.addEventListener("keyup",n),d.addEventListener("keydown",n),d.addEventListener("keypress",n),d!==window&&(window.addEventListener("blur",c),window.addEventListener("keyup",n),window.addEventListener("keydown",n),window.addEventListener("keypress",n)))}y();var v={element:d};return Object.defineProperties(v,{enabled:{get:function(){return s},set:function(_){_?y():function(){!s||(s=!1,d.removeEventListener("mousemove",a),d.removeEventListener("mousedown",g),d.removeEventListener("mouseup",h),d.removeEventListener("mouseleave",i),d.removeEventListener("mouseenter",i),d.removeEventListener("mouseout",i),d.removeEventListener("mouseover",i),d.removeEventListener("blur",c),d.removeEventListener("keyup",n),d.removeEventListener("keydown",n),d.removeEventListener("keypress",n),d!==window&&(window.removeEventListener("blur",c),window.removeEventListener("keyup",n),window.removeEventListener("keydown",n),window.removeEventListener("keypress",n)))}()},enumerable:!0},buttons:{get:function(){return p},enumerable:!0},x:{get:function(){return e},enumerable:!0},y:{get:function(){return f},enumerable:!0},mods:{get:function(){return u},enumerable:!0}}),v};var t=r("mouse-event")},{"mouse-event":461}],460:[function(r,O,B){var t={left:0,top:0};O.exports=function(d,m,p){m=m||d.currentTarget||d.srcElement,Array.isArray(p)||(p=[0,0]);var e=d.clientX||0,f=d.clientY||0,u=(s=m,s===window||s===document||s===document.body?t:s.getBoundingClientRect()),s;return p[0]=e-u.left,p[1]=f-u.top,p}},{}],461:[function(r,O,B){function t(d){return d.target||d.srcElement||window}B.buttons=function(d){if(typeof d=="object"){if("buttons"in d)return d.buttons;if("which"in d){if((m=d.which)===2)return 4;if(m===3)return 2;if(m>0)return 1<<m-1}else if("button"in d){var m;if((m=d.button)===1)return 4;if(m===2)return 2;if(m>=0)return 1<<m}}return 0},B.element=t,B.x=function(d){if(typeof d=="object"){if("offsetX"in d)return d.offsetX;var m=t(d).getBoundingClientRect();return d.clientX-m.left}return 0},B.y=function(d){if(typeof d=="object"){if("offsetY"in d)return d.offsetY;var m=t(d).getBoundingClientRect();return d.clientY-m.top}return 0}},{}],462:[function(r,O,B){var t=r("to-px");O.exports=function(d,m,p){typeof d=="function"&&(p=!!m,m=d,d=window);var e=t("ex",d),f=function(u){p&&u.preventDefault();var s=u.deltaX||0,l=u.deltaY||0,o=u.deltaZ||0,i=1;switch(u.deltaMode){case 1:i=e;break;case 2:i=window.innerHeight}if(l*=i,o*=i,(s*=i)||l||o)return m(s,l,o,u)};return d.addEventListener("wheel",f),f}},{"to-px":585}],463:[function(r,O,B){(function(t,d){(function(){/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/(function(m,p,e){p[m]=p[m]||e(),O!==void 0&&O.exports&&(O.exports=p[m])})("Promise",t!==void 0?t:this,function(){var m,p,e,f=Object.prototype.toString,u=d!==void 0?function(_){return d(_)}:setTimeout;try{Object.defineProperty({},"x",{}),m=function(_,x,T,A){return Object.defineProperty(_,x,{value:T,writable:!0,configurable:A!==!1})}}catch(_){m=function(x,T,A){return x[T]=A,x}}function s(_,x){e.add(_,x),p||(p=u(e.drain))}function l(_){var x,T=typeof _;return _==null||T!="object"&&T!="function"||(x=_.then),typeof x=="function"&&x}function o(){for(var _=0;_<this.chain.length;_++)i(this,this.state===1?this.chain[_].success:this.chain[_].failure,this.chain[_]);this.chain.length=0}function i(_,x,T){var A,S;try{x===!1?T.reject(_.msg):(A=x===!0?_.msg:x.call(void 0,_.msg))===T.promise?T.reject(TypeError("Promise-chain cycle")):(S=l(A))?S.call(A,T.resolve,T.reject):T.resolve(A)}catch(w){T.reject(w)}}function c(_){var x,T=this;if(!T.triggered){T.triggered=!0,T.def&&(T=T.def);try{(x=l(_))?s(function(){var A=new g(T);try{x.call(_,function(){c.apply(A,arguments)},function(){n.apply(A,arguments)})}catch(S){n.call(A,S)}}):(T.msg=_,T.state=1,T.chain.length>0&&s(o,T))}catch(A){n.call(new g(T),A)}}}function n(_){var x=this;x.triggered||(x.triggered=!0,x.def&&(x=x.def),x.msg=_,x.state=2,x.chain.length>0&&s(o,x))}function a(_,x,T,A){for(var S=0;S<x.length;S++)(function(w){_.resolve(x[w]).then(function(C){T(w,C)},A)})(S)}function g(_){this.def=_,this.triggered=!1}function h(_){this.promise=_,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function y(_){if(typeof _!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var x=new h(this);this.then=function(T,A){var S={success:typeof T!="function"||T,failure:typeof A=="function"&&A};return S.promise=new this.constructor(function(w,C){if(typeof w!="function"||typeof C!="function")throw TypeError("Not a function");S.resolve=w,S.reject=C}),x.chain.push(S),x.state!==0&&s(o,x),S.promise},this.catch=function(T){return this.then(void 0,T)};try{_.call(void 0,function(T){c.call(x,T)},function(T){n.call(x,T)})}catch(T){n.call(x,T)}}e=function(){var _,x,T;function A(S,w){this.fn=S,this.self=w,this.next=void 0}return{add:function(S,w){T=new A(S,w),x?x.next=T:_=T,x=T,T=void 0},drain:function(){var S=_;for(_=x=p=void 0;S;)S.fn.call(S.self),S=S.next}}}();var v=m({},"constructor",y,!1);return y.prototype=v,m(v,"__NPO__",0,!1),m(y,"resolve",function(_){return _&&typeof _=="object"&&_.__NPO__===1?_:new this(function(x,T){if(typeof x!="function"||typeof T!="function")throw TypeError("Not a function");x(_)})}),m(y,"reject",function(_){return new this(function(x,T){if(typeof x!="function"||typeof T!="function")throw TypeError("Not a function");T(_)})}),m(y,"all",function(_){var x=this;return f.call(_)!="[object Array]"?x.reject(TypeError("Not an array")):_.length===0?x.resolve([]):new x(function(T,A){if(typeof T!="function"||typeof A!="function")throw TypeError("Not a function");var S=_.length,w=Array(S),C=0;a(x,_,function(k,L){w[k]=L,++C===S&&T(w)},A)})}),m(y,"race",function(_){var x=this;return f.call(_)!="[object Array]"?x.reject(TypeError("Not an array")):new x(function(T,A){if(typeof T!="function"||typeof A!="function")throw TypeError("Not a function");a(x,_,function(S,w){T(w)},A)})}),y})}).call(this)}).call(this,typeof Xi!="undefined"?Xi:typeof self!="undefined"?self:typeof window!="undefined"?window:{},r("timers").setImmediate)},{timers:582}],464:[function(r,O,B){var t=r("typedarray-pool");O.exports=function(m){function p(i){throw new Error("ndarray-extract-contour: "+i)}typeof m!="object"&&p("Must specify arguments");var e=m.order;Array.isArray(e)||p("Must specify order");var f=m.arrayArguments||1;f<1&&p("Must have at least one array argument");var u=m.scalarArguments||0;u<0&&p("Scalar arg count must be > 0"),typeof m.vertex!="function"&&p("Must specify vertex creation function"),typeof m.cell!="function"&&p("Must specify cell creation function"),typeof m.phase!="function"&&p("Must specify phase function");for(var s=m.getters||[],l=new Array(f),o=0;o<f;++o)s.indexOf(o)>=0?l[o]=!0:l[o]=!1;return function(i,c,n,a,g,h){var y=[h,g].join(",");return(0,d[y])(i,c,n,t.mallocUint32,t.freeUint32)}(m.vertex,m.cell,m.phase,0,e,l)};var d={"false,0,1":function(m,p,e,f,u){return function(s,l,o,i){var c,n=0|s.shape[0],a=0|s.shape[1],g=s.data,h=0|s.offset,y=0|s.stride[0],v=0|s.stride[1],_=h,x=0|-y,T=0,A=0|-v,S=0,w=-y-v|0,C=0,k=0|y,L=v-y*n|0,M=0,P=0,D=0,N=2*n|0,U=f(N),q=f(N),X=0,K=0,Z=-1,H=-1,Y=0,$=0|-n,z=0|n,j=0,W=-n-1|0,ee=n-1|0,J=0,Q=0,te=0;for(M=0;M<n;++M)U[X++]=e(g[_],l,o,i),_+=k;if(_+=L,a>0){if(P=1,U[X++]=e(g[_],l,o,i),_+=k,n>0)for(M=1,c=g[_],K=U[X]=e(c,l,o,i),Y=U[X+Z],j=U[X+$],J=U[X+W],K===Y&&K===j&&K===J||(T=g[_+x],S=g[_+A],C=g[_+w],m(M,P,c,T,S,C,K,Y,j,J,l,o,i),Q=q[X]=D++),X+=1,_+=k,M=2;M<n;++M)c=g[_],K=U[X]=e(c,l,o,i),Y=U[X+Z],j=U[X+$],J=U[X+W],K===Y&&K===j&&K===J||(T=g[_+x],S=g[_+A],C=g[_+w],m(M,P,c,T,S,C,K,Y,j,J,l,o,i),Q=q[X]=D++,J!==Y&&p(q[X+Z],Q,C,T,J,Y,l,o,i)),X+=1,_+=k;for(_+=L,X=0,te=Z,Z=H,H=te,te=$,$=z,z=te,te=W,W=ee,ee=te,P=2;P<a;++P){if(U[X++]=e(g[_],l,o,i),_+=k,n>0)for(M=1,c=g[_],K=U[X]=e(c,l,o,i),Y=U[X+Z],j=U[X+$],J=U[X+W],K===Y&&K===j&&K===J||(T=g[_+x],S=g[_+A],C=g[_+w],m(M,P,c,T,S,C,K,Y,j,J,l,o,i),Q=q[X]=D++,J!==j&&p(q[X+$],Q,S,C,j,J,l,o,i)),X+=1,_+=k,M=2;M<n;++M)c=g[_],K=U[X]=e(c,l,o,i),Y=U[X+Z],j=U[X+$],J=U[X+W],K===Y&&K===j&&K===J||(T=g[_+x],S=g[_+A],C=g[_+w],m(M,P,c,T,S,C,K,Y,j,J,l,o,i),Q=q[X]=D++,J!==j&&p(q[X+$],Q,S,C,j,J,l,o,i),J!==Y&&p(q[X+Z],Q,C,T,J,Y,l,o,i)),X+=1,_+=k;1&P&&(X=0),te=Z,Z=H,H=te,te=$,$=z,z=te,te=W,W=ee,ee=te,_+=L}}u(q),u(U)}},"false,1,0":function(m,p,e,f,u){return function(s,l,o,i){var c,n=0|s.shape[0],a=0|s.shape[1],g=s.data,h=0|s.offset,y=0|s.stride[0],v=0|s.stride[1],_=h,x=0|-y,T=0,A=0|-v,S=0,w=-y-v|0,C=0,k=0|v,L=y-v*a|0,M=0,P=0,D=0,N=2*a|0,U=f(N),q=f(N),X=0,K=0,Z=-1,H=-1,Y=0,$=0|-a,z=0|a,j=0,W=-a-1|0,ee=a-1|0,J=0,Q=0,te=0;for(P=0;P<a;++P)U[X++]=e(g[_],l,o,i),_+=k;if(_+=L,n>0){if(M=1,U[X++]=e(g[_],l,o,i),_+=k,a>0)for(P=1,c=g[_],K=U[X]=e(c,l,o,i),j=U[X+$],Y=U[X+Z],J=U[X+W],K===j&&K===Y&&K===J||(T=g[_+x],S=g[_+A],C=g[_+w],m(M,P,c,T,S,C,K,j,Y,J,l,o,i),Q=q[X]=D++),X+=1,_+=k,P=2;P<a;++P)c=g[_],K=U[X]=e(c,l,o,i),j=U[X+$],Y=U[X+Z],J=U[X+W],K===j&&K===Y&&K===J||(T=g[_+x],S=g[_+A],C=g[_+w],m(M,P,c,T,S,C,K,j,Y,J,l,o,i),Q=q[X]=D++,J!==Y&&p(q[X+Z],Q,S,C,Y,J,l,o,i)),X+=1,_+=k;for(_+=L,X=0,te=$,$=z,z=te,te=Z,Z=H,H=te,te=W,W=ee,ee=te,M=2;M<n;++M){if(U[X++]=e(g[_],l,o,i),_+=k,a>0)for(P=1,c=g[_],K=U[X]=e(c,l,o,i),j=U[X+$],Y=U[X+Z],J=U[X+W],K===j&&K===Y&&K===J||(T=g[_+x],S=g[_+A],C=g[_+w],m(M,P,c,T,S,C,K,j,Y,J,l,o,i),Q=q[X]=D++,J!==j&&p(q[X+$],Q,C,T,J,j,l,o,i)),X+=1,_+=k,P=2;P<a;++P)c=g[_],K=U[X]=e(c,l,o,i),j=U[X+$],Y=U[X+Z],J=U[X+W],K===j&&K===Y&&K===J||(T=g[_+x],S=g[_+A],C=g[_+w],m(M,P,c,T,S,C,K,j,Y,J,l,o,i),Q=q[X]=D++,J!==Y&&p(q[X+Z],Q,S,C,Y,J,l,o,i),J!==j&&p(q[X+$],Q,C,T,J,j,l,o,i)),X+=1,_+=k;1&M&&(X=0),te=$,$=z,z=te,te=Z,Z=H,H=te,te=W,W=ee,ee=te,_+=L}}u(q),u(U)}}}},{"typedarray-pool":601}],465:[function(r,O,B){var t=r("dup"),d={zero:function(n,a,g,h){var y=n[0];h|=0;var v=0,_=g[0];for(v=0;v<y;++v)a[h]=0,h+=_},fdTemplate1:function(n,a,g,h,y,v,_){var x=n[0],T=g[0],A=-1*T,S=T;h|=0,_|=0;var w=0,C=T,k=v[0];for(w=0;w<x;++w)y[_]=.5*(a[h+A]-a[h+S]),h+=C,_+=k},fdTemplate2:function(n,a,g,h,y,v,_,x,T,A){var S=n[0],w=n[1],C=g[0],k=g[1],L=v[0],M=v[1],P=T[0],D=T[1],N=-1*C,U=C,q=-1*k,X=k;h|=0,_|=0,A|=0;var K=0,Z=0,H=k,Y=C-w*k,$=M,z=L-w*M,j=D,W=P-w*D;for(Z=0;Z<S;++Z){for(K=0;K<w;++K)y[_]=.5*(a[h+N]-a[h+U]),x[A]=.5*(a[h+q]-a[h+X]),h+=H,_+=$,A+=j;h+=Y,_+=z,A+=W}}},m={cdiff:function(n){var a={};return function(g,h,y){var v=g.dtype,_=g.order,x=h.dtype,T=h.order,A=y.dtype,S=y.order,w=[v,_.join(),x,T.join(),A,S.join()].join(),C=a[w];return C||(a[w]=C=n([v,_,x,T,A,S])),C(g.shape.slice(0),g.data,g.stride,0|g.offset,h.data,h.stride,0|h.offset,y.data,y.stride,0|y.offset)}},zero:function(n){var a={};return function(g){var h=g.dtype,y=g.order,v=[h,y.join()].join(),_=a[v];return _||(a[v]=_=n([h,y])),_(g.shape.slice(0),g.data,g.stride,0|g.offset)}},fdTemplate1:function(n){var a={};return function(g,h){var y=g.dtype,v=g.order,_=h.dtype,x=h.order,T=[y,v.join(),_,x.join()].join(),A=a[T];return A||(a[T]=A=n([y,v,_,x])),A(g.shape.slice(0),g.data,g.stride,0|g.offset,h.data,h.stride,0|h.offset)}},fdTemplate2:function(n){var a={};return function(g,h,y){var v=g.dtype,_=g.order,x=h.dtype,T=h.order,A=y.dtype,S=y.order,w=[v,_.join(),x,T.join(),A,S.join()].join(),C=a[w];return C||(a[w]=C=n([v,_,x,T,A,S])),C(g.shape.slice(0),g.data,g.stride,0|g.offset,h.data,h.stride,0|h.offset,y.data,y.stride,0|y.offset)}}};function p(n){return(0,m[n.funcName])(e.bind(void 0,n))}function e(n){return d[n.funcName]}function f(n){return p({funcName:n.funcName})}var u={},s={},l=f({funcName:"cdiff"}),o=f({funcName:"zero"});function i(n){return n in u?u[n]:u[n]=f({funcName:"fdTemplate"+n})}function c(n,a,g,h){return function(y,v){var _=v.shape.slice();return _[0]>2&&_[1]>2&&h(v.pick(-1,-1).lo(1,1).hi(_[0]-2,_[1]-2),y.pick(-1,-1,0).lo(1,1).hi(_[0]-2,_[1]-2),y.pick(-1,-1,1).lo(1,1).hi(_[0]-2,_[1]-2)),_[1]>2&&(g(v.pick(0,-1).lo(1).hi(_[1]-2),y.pick(0,-1,1).lo(1).hi(_[1]-2)),a(y.pick(0,-1,0).lo(1).hi(_[1]-2))),_[1]>2&&(g(v.pick(_[0]-1,-1).lo(1).hi(_[1]-2),y.pick(_[0]-1,-1,1).lo(1).hi(_[1]-2)),a(y.pick(_[0]-1,-1,0).lo(1).hi(_[1]-2))),_[0]>2&&(g(v.pick(-1,0).lo(1).hi(_[0]-2),y.pick(-1,0,0).lo(1).hi(_[0]-2)),a(y.pick(-1,0,1).lo(1).hi(_[0]-2))),_[0]>2&&(g(v.pick(-1,_[1]-1).lo(1).hi(_[0]-2),y.pick(-1,_[1]-1,0).lo(1).hi(_[0]-2)),a(y.pick(-1,_[1]-1,1).lo(1).hi(_[0]-2))),y.set(0,0,0,0),y.set(0,0,1,0),y.set(_[0]-1,0,0,0),y.set(_[0]-1,0,1,0),y.set(0,_[1]-1,0,0),y.set(0,_[1]-1,1,0),y.set(_[0]-1,_[1]-1,0,0),y.set(_[0]-1,_[1]-1,1,0),y}}O.exports=function(n,a,g){return Array.isArray(g)||(g=t(a.dimension,typeof g=="string"?g:"clamp")),a.size===0?n:a.dimension===0?(n.set(0),n):function(h){var y=h.join();if(T=s[y])return T;for(var v=h.length,_=[l,o],x=1;x<=v;++x)_.push(i(x));var T=c.apply(void 0,_);return s[y]=T,T}(g)(n,a)}},{dup:182}],466:[function(r,O,B){function t(e,f){var u=Math.floor(f),s=f-u,l=0<=u&&u<e.shape[0],o=0<=u+1&&u+1<e.shape[0];return(1-s)*(l?+e.get(u):0)+s*(o?+e.get(u+1):0)}function d(e,f,u){var s=Math.floor(f),l=f-s,o=0<=s&&s<e.shape[0],i=0<=s+1&&s+1<e.shape[0],c=Math.floor(u),n=u-c,a=0<=c&&c<e.shape[1],g=0<=c+1&&c+1<e.shape[1],h=o&&a?e.get(s,c):0,y=o&&g?e.get(s,c+1):0;return(1-n)*((1-l)*h+l*(i&&a?e.get(s+1,c):0))+n*((1-l)*y+l*(i&&g?e.get(s+1,c+1):0))}function m(e,f,u,s){var l=Math.floor(f),o=f-l,i=0<=l&&l<e.shape[0],c=0<=l+1&&l+1<e.shape[0],n=Math.floor(u),a=u-n,g=0<=n&&n<e.shape[1],h=0<=n+1&&n+1<e.shape[1],y=Math.floor(s),v=s-y,_=0<=y&&y<e.shape[2],x=0<=y+1&&y+1<e.shape[2],T=i&&g&&_?e.get(l,n,y):0,A=i&&h&&_?e.get(l,n+1,y):0,S=c&&g&&_?e.get(l+1,n,y):0,w=c&&h&&_?e.get(l+1,n+1,y):0,C=i&&g&&x?e.get(l,n,y+1):0,k=i&&h&&x?e.get(l,n+1,y+1):0;return(1-v)*((1-a)*((1-o)*T+o*S)+a*((1-o)*A+o*w))+v*((1-a)*((1-o)*C+o*(c&&g&&x?e.get(l+1,n,y+1):0))+a*((1-o)*k+o*(c&&h&&x?e.get(l+1,n+1,y+1):0)))}function p(e){var f,u,s=0|e.shape.length,l=new Array(s),o=new Array(s),i=new Array(s),c=new Array(s);for(f=0;f<s;++f)u=+arguments[f+1],l[f]=Math.floor(u),o[f]=u-l[f],i[f]=0<=l[f]&&l[f]<e.shape[f],c[f]=0<=l[f]+1&&l[f]+1<e.shape[f];var n,a,g,h=0;e:for(f=0;f<1<<s;++f){for(a=1,g=e.offset,n=0;n<s;++n)if(f&1<<n){if(!c[n])continue e;a*=o[n],g+=e.stride[n]*(l[n]+1)}else{if(!i[n])continue e;a*=1-o[n],g+=e.stride[n]*l[n]}h+=a*e.data[g]}return h}O.exports=function(e,f,u,s){switch(e.shape.length){case 0:return 0;case 1:return t(e,f);case 2:return d(e,f,u);case 3:return m(e,f,u,s);default:return p.apply(void 0,arguments)}},O.exports.d1=t,O.exports.d2=d,O.exports.d3=m},{}],467:[function(r,O,B){var t={"float64,2,1,0":function(){return function(f,u,s,l,o){var i=f[0],c=f[1],n=f[2],a=s[0],g=s[1],h=s[2];l|=0;var y=0,v=0,_=0,x=h,T=g-n*h,A=a-c*g;for(_=0;_<i;++_){for(v=0;v<c;++v){for(y=0;y<n;++y)u[l]/=o,l+=x;l+=T}l+=A}}},"uint8,2,0,1,float64,2,1,0":function(){return function(f,u,s,l,o,i,c,n){for(var a=f[0],g=f[1],h=f[2],y=s[0],v=s[1],_=s[2],x=i[0],T=i[1],A=i[2],S=l|=0,w=c|=0,C=0|f[0];C>0;){C<64?(a=C,C=0):(a=64,C-=64);for(var k=0|f[1];k>0;){k<64?(g=k,k=0):(g=64,k-=64),l=S+C*y+k*v,c=w+C*x+k*T;var L=0,M=0,P=0,D=_,N=y-h*_,U=v-a*y,q=A,X=x-h*A,K=T-a*x;for(P=0;P<g;++P){for(M=0;M<a;++M){for(L=0;L<h;++L)u[l]=o[c]*n,l+=D,c+=q;l+=N,c+=X}l+=U,c+=K}}}}},"float32,1,0,float32,1,0":function(){return function(f,u,s,l,o,i,c){var n=f[0],a=f[1],g=s[0],h=s[1],y=i[0],v=i[1];l|=0,c|=0;var _=0,x=0,T=h,A=g-a*h,S=v,w=y-a*v;for(x=0;x<n;++x){for(_=0;_<a;++_)u[l]=o[c],l+=T,c+=S;l+=A,c+=w}}},"float32,1,0,float32,0,1":function(){return function(f,u,s,l,o,i,c){for(var n=f[0],a=f[1],g=s[0],h=s[1],y=i[0],v=i[1],_=l|=0,x=c|=0,T=0|f[1];T>0;){T<64?(a=T,T=0):(a=64,T-=64);for(var A=0|f[0];A>0;){A<64?(n=A,A=0):(n=64,A-=64),l=_+T*h+A*g,c=x+T*v+A*y;var S=0,w=0,C=h,k=g-a*h,L=v,M=y-a*v;for(w=0;w<n;++w){for(S=0;S<a;++S)u[l]=o[c],l+=C,c+=L;l+=k,c+=M}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(f,u,s,l,o,i,c){for(var n=f[0],a=f[1],g=f[2],h=s[0],y=s[1],v=s[2],_=i[0],x=i[1],T=i[2],A=l|=0,S=c|=0,w=0|f[2];w>0;){w<64?(g=w,w=0):(g=64,w-=64);for(var C=0|f[0];C>0;){C<64?(n=C,C=0):(n=64,C-=64);for(var k=0|f[1];k>0;){k<64?(a=k,k=0):(a=64,k-=64),l=A+w*v+C*h+k*y,c=S+w*T+C*_+k*x;var L=0,M=0,P=0,D=v,N=h-g*v,U=y-n*h,q=T,X=_-g*T,K=x-n*_;for(P=0;P<a;++P){for(M=0;M<n;++M){for(L=0;L<g;++L)u[l]=o[c],l+=D,c+=q;l+=N,c+=X}l+=U,c+=K}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(f,u,s,l,o,i,c){var n=f[0],a=f[1],g=f[2],h=s[0],y=s[1],v=s[2],_=i[0],x=i[1],T=i[2];l|=0,c|=0;var A=0,S=0,w=0,C=v,k=h-g*v,L=y-n*h,M=T,P=_-g*T,D=x-n*_;for(w=0;w<a;++w){for(S=0;S<n;++S){for(A=0;A<g;++A)u[l]=o[c],l+=C,c+=M;l+=k,c+=P}l+=L,c+=D}}}},d=function(f,u){var s=u.join(",");return(0,t[s])()},m={mul:function(f){var u={};return function(s,l,o){var i=s.dtype,c=s.order,n=l.dtype,a=l.order,g=o.dtype,h=o.order,y=[i,c.join(),n,a.join(),g,h.join()].join(),v=u[y];return v||(u[y]=v=f([i,c,n,a,g,h])),v(s.shape.slice(0),s.data,s.stride,0|s.offset,l.data,l.stride,0|l.offset,o.data,o.stride,0|o.offset)}},muls:function(f){var u={};return function(s,l,o){var i=s.dtype,c=s.order,n=l.dtype,a=l.order,g=[i,c.join(),n,a.join()].join(),h=u[g];return h||(u[g]=h=f([i,c,n,a])),h(s.shape.slice(0),s.data,s.stride,0|s.offset,l.data,l.stride,0|l.offset,o)}},mulseq:function(f){var u={};return function(s,l){var o=s.dtype,i=s.order,c=[o,i.join()].join(),n=u[c];return n||(u[c]=n=f([o,i])),n(s.shape.slice(0),s.data,s.stride,0|s.offset,l)}},div:function(f){var u={};return function(s,l,o){var i=s.dtype,c=s.order,n=l.dtype,a=l.order,g=o.dtype,h=o.order,y=[i,c.join(),n,a.join(),g,h.join()].join(),v=u[y];return v||(u[y]=v=f([i,c,n,a,g,h])),v(s.shape.slice(0),s.data,s.stride,0|s.offset,l.data,l.stride,0|l.offset,o.data,o.stride,0|o.offset)}},divs:function(f){var u={};return function(s,l,o){var i=s.dtype,c=s.order,n=l.dtype,a=l.order,g=[i,c.join(),n,a.join()].join(),h=u[g];return h||(u[g]=h=f([i,c,n,a])),h(s.shape.slice(0),s.data,s.stride,0|s.offset,l.data,l.stride,0|l.offset,o)}},divseq:function(f){var u={};return function(s,l){var o=s.dtype,i=s.order,c=[o,i.join()].join(),n=u[c];return n||(u[c]=n=f([o,i])),n(s.shape.slice(0),s.data,s.stride,0|s.offset,l)}},assign:function(f){var u={};return function(s,l){var o=s.dtype,i=s.order,c=l.dtype,n=l.order,a=[o,i.join(),c,n.join()].join(),g=u[a];return g||(u[a]=g=f([o,i,c,n])),g(s.shape.slice(0),s.data,s.stride,0|s.offset,l.data,l.stride,0|l.offset)}}};function p(f){return u={funcName:f.funcName},(0,m[u.funcName])(d.bind(void 0,u));var u}var e={mul:"*",div:"/"};(function(){for(var f in e)B[f]=p({funcName:f}),B[f+"s"]=p({funcName:f+"s"}),B[f+"seq"]=p({funcName:f+"seq"})})(),B.assign=p({funcName:"assign"})},{}],468:[function(r,O,B){var t=r("ndarray"),d=r("./doConvert.js");O.exports=function(m,p){for(var e=[],f=m,u=1;Array.isArray(f);)e.push(f.length),u*=f.length,f=f[0];return e.length===0?t():(p||(p=t(new Float64Array(u),e)),d(p,m),p)}},{"./doConvert.js":469,ndarray:472}],469:[function(r,O,B){var t,d=function(){return function(m,p,e,f,u){var s=m[0],l=m[1],o=m[2],i=e[0],c=e[1],n=e[2],a=[0,0,0];f|=0;var g=0,h=0,y=0,v=n,_=c-o*n,x=i-l*c;for(y=0;y<s;++y){for(h=0;h<l;++h){for(g=0;g<o;++g){var T,A=u;for(T=0;T<a.length-1;++T)A=A[a[T]];p[f]=A[a[a.length-1]],f+=v,++a[2]}f+=_,a[2]-=o,++a[1]}f+=x,a[1]-=l,++a[0]}}};O.exports=(t={funcName:"convert"},function(m){var p={};return function(e,f){var u=e.dtype,s=e.order,l=[u,s.join()].join(),o=p[l];return o||(p[l]=o=m([u,s])),o(e.shape.slice(0),e.data,e.stride,0|e.offset,f)}}(d.bind(void 0,t)))},{}],470:[function(r,O,B){var t=r("typedarray-pool");function d(f){switch(f){case"uint32":return[t.mallocUint32,t.freeUint32];default:return null}}var m={"uint32,1,0":function(f,u){return function(s,l,o,i,c,n,a,g,h,y,v){var _,x,T,A,S,w,C,k,L=s*c+i,M=f(g);for(_=s+1;_<=l;++_){for(x=_,T=L+=c,S=0,w=L,A=0;A<g;++A)M[S++]=o[w],w+=h;e:for(;x-- >s;){S=0,w=T-c;t:for(A=0;A<g;++A){if((C=o[w])<(k=M[S]))break e;if(C>k)break t;w+=y,S+=v}for(S=T,w=T-c,A=0;A<g;++A)o[S]=o[w],S+=h,w+=h;T-=c}for(S=T,w=0,A=0;A<g;++A)o[S]=M[w++],S+=h}u(M)}}},p={"uint32,1,0":function(f,u,s){return function l(o,i,c,n,a,g,h,y,v,_,x){var T,A,S,w,C,k,L,M,P,D,N,U,q,X,K,Z,H,Y,$,z,j,W,ee,J,Q,te=(i-o+1)/6|0,ie=o+te,ae=i-te,he=o+i>>1,se=he-te,de=he+te,ue=ie,ve=se,ke=he,Ee=de,be=ae,xe=o+1,ce=i-1,ge=!0,we=0,Me=0,Se=0,ze=y,Fe=u(ze),Ye=u(ze);N=a*ue,U=a*ve,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=ue,ue=ve,ve=A;break e}if(Se<0)break e;Q+=_}N=a*Ee,U=a*be,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=Ee,Ee=be,be=A;break e}if(Se<0)break e;Q+=_}N=a*ue,U=a*ke,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=ue,ue=ke,ke=A;break e}if(Se<0)break e;Q+=_}N=a*ve,U=a*ke,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=ve,ve=ke,ke=A;break e}if(Se<0)break e;Q+=_}N=a*ue,U=a*Ee,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=ue,ue=Ee,Ee=A;break e}if(Se<0)break e;Q+=_}N=a*ke,U=a*Ee,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=ke,ke=Ee,Ee=A;break e}if(Se<0)break e;Q+=_}N=a*ve,U=a*be,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=ve,ve=be,be=A;break e}if(Se<0)break e;Q+=_}N=a*ve,U=a*ke,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=ve,ve=ke,ke=A;break e}if(Se<0)break e;Q+=_}N=a*Ee,U=a*be,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=Ee,Ee=be,be=A;break e}if(Se<0)break e;Q+=_}for(N=a*ue,U=a*ve,q=a*ke,X=a*Ee,K=a*be,Z=a*ie,H=a*he,Y=a*ae,J=0,Q=n,D=0;D<y;++D)L=N+Q,M=U+Q,P=q+Q,$=X+Q,z=K+Q,j=Z+Q,W=H+Q,ee=Y+Q,Fe[J]=c[M],Ye[J]=c[$],ge=ge&&Fe[J]===Ye[J],S=c[L],w=c[P],C=c[z],c[j]=S,c[W]=w,c[ee]=C,++J,Q+=v;for(N=a*se,U=a*o,Q=n,D=0;D<y;++D)M=U+Q,c[L=N+Q]=c[M],Q+=v;for(N=a*de,U=a*i,Q=n,D=0;D<y;++D)M=U+Q,c[L=N+Q]=c[M],Q+=v;if(ge)for(k=xe;k<=ce;++k){for(L=n+k*a,J=0,D=0;D<y&&(Se=c[L]-Fe[J])==0;++D)J+=x,L+=_;if(Se!==0)if(Se<0){if(k!==xe)for(N=a*k,U=a*xe,Q=n,D=0;D<y;++D)M=U+Q,T=c[L=N+Q],c[L]=c[M],c[M]=T,Q+=v;++xe}else for(;;){for(L=n+ce*a,J=0,D=0;D<y&&(Se=c[L]-Fe[J])==0;++D)J+=x,L+=_;if(!(Se>0)){if(Se<0){for(N=a*k,U=a*xe,q=a*ce,Q=n,D=0;D<y;++D)M=U+Q,P=q+Q,T=c[L=N+Q],c[L]=c[M],c[M]=c[P],c[P]=T,Q+=v;++xe,--ce;break}for(N=a*k,U=a*ce,Q=n,D=0;D<y;++D)M=U+Q,T=c[L=N+Q],c[L]=c[M],c[M]=T,Q+=v;--ce;break}ce--}}else for(k=xe;k<=ce;++k){for(L=n+k*a,J=0,D=0;D<y&&(we=c[L]-Fe[J])==0;++D)J+=x,L+=_;if(we<0){if(k!==xe)for(N=a*k,U=a*xe,Q=n,D=0;D<y;++D)M=U+Q,T=c[L=N+Q],c[L]=c[M],c[M]=T,Q+=v;++xe}else{for(L=n+k*a,J=0,D=0;D<y&&(Me=c[L]-Ye[J])==0;++D)J+=x,L+=_;if(Me>0)for(;;){for(L=n+ce*a,J=0,D=0;D<y&&(Se=c[L]-Ye[J])==0;++D)J+=x,L+=_;if(!(Se>0)){for(L=n+ce*a,J=0,D=0;D<y&&(Se=c[L]-Fe[J])==0;++D)J+=x,L+=_;if(Se<0){for(N=a*k,U=a*xe,q=a*ce,Q=n,D=0;D<y;++D)M=U+Q,P=q+Q,T=c[L=N+Q],c[L]=c[M],c[M]=c[P],c[P]=T,Q+=v;++xe,--ce}else{for(N=a*k,U=a*ce,Q=n,D=0;D<y;++D)M=U+Q,T=c[L=N+Q],c[L]=c[M],c[M]=T,Q+=v;--ce}break}if(--ce<k)break}}}for(N=a*o,U=a*(xe-1),J=0,Q=n,D=0;D<y;++D)M=U+Q,c[L=N+Q]=c[M],c[M]=Fe[J],++J,Q+=v;for(N=a*i,U=a*(ce+1),J=0,Q=n,D=0;D<y;++D)M=U+Q,c[L=N+Q]=c[M],c[M]=Ye[J],++J,Q+=v;if(xe-2-o<=32?f(o,xe-2,c,n,a,g,h,y,v,_,x):l(o,xe-2,c,n,a,g,h,y,v,_,x),i-(ce+2)<=32?f(ce+2,i,c,n,a,g,h,y,v,_,x):l(ce+2,i,c,n,a,g,h,y,v,_,x),ge)return s(Fe),void s(Ye);if(xe<ie&&ce>ae){e:for(;;){for(L=n+xe*a,J=0,Q=n,D=0;D<y;++D){if(c[L]!==Fe[J])break e;++J,L+=v}++xe}e:for(;;){for(L=n+ce*a,J=0,Q=n,D=0;D<y;++D){if(c[L]!==Ye[J])break e;++J,L+=v}--ce}for(k=xe;k<=ce;++k){for(L=n+k*a,J=0,D=0;D<y&&(we=c[L]-Fe[J])==0;++D)J+=x,L+=_;if(we===0){if(k!==xe)for(N=a*k,U=a*xe,Q=n,D=0;D<y;++D)M=U+Q,T=c[L=N+Q],c[L]=c[M],c[M]=T,Q+=v;++xe}else{for(L=n+k*a,J=0,D=0;D<y&&(Me=c[L]-Ye[J])==0;++D)J+=x,L+=_;if(Me===0)for(;;){for(L=n+ce*a,J=0,D=0;D<y&&(Se=c[L]-Ye[J])==0;++D)J+=x,L+=_;if(Se!==0){for(L=n+ce*a,J=0,D=0;D<y&&(Se=c[L]-Fe[J])==0;++D)J+=x,L+=_;if(Se<0){for(N=a*k,U=a*xe,q=a*ce,Q=n,D=0;D<y;++D)M=U+Q,P=q+Q,T=c[L=N+Q],c[L]=c[M],c[M]=c[P],c[P]=T,Q+=v;++xe,--ce}else{for(N=a*k,U=a*ce,Q=n,D=0;D<y;++D)M=U+Q,T=c[L=N+Q],c[L]=c[M],c[M]=T,Q+=v;--ce}break}if(--ce<k)break}}}}s(Fe),s(Ye),ce-xe<=32?f(xe,ce,c,n,a,g,h,y,v,_,x):l(xe,ce,c,n,a,g,h,y,v,_,x)}}},e={"uint32,1,0":function(f,u){return function(s){var l=s.data,o=0|s.offset,i=s.shape,c=s.stride,n=0|c[0],a=0|i[0],g=0|c[1],h=0|i[1],y=g,v=g;a<=32?f(0,a-1,l,o,n,g,a,h,y,v,1):u(0,a-1,l,o,n,g,a,h,y,v,1)}}};O.exports=function(f,u){var s=[u,f].join(","),l=e[s],o=function(c,n){var a=d(n),g=[n,c].join(","),h=m[g];return a?h(a[0],a[1]):h()}(f,u),i=function(c,n,a){var g=d(n),h=[n,c].join(","),y=p[h];return c.length>1&&g?y(a,g[0],g[1]):y(a)}(f,u,o);return l(o,i)}},{"typedarray-pool":601}],471:[function(r,O,B){var t=r("./lib/compile_sort.js"),d={};O.exports=function(m){var p=m.order,e=m.dtype,f=[p,e].join(":"),u=d[f];return u||(d[f]=u=t(p,e)),u(m),m}},{"./lib/compile_sort.js":470}],472:[function(r,O,B){var t=r("is-buffer"),d=typeof Float64Array!="undefined";function m(s,l){return s[0]-l[0]}function p(){var s,l=this.stride,o=new Array(l.length);for(s=0;s<o.length;++s)o[s]=[Math.abs(l[s]),s];o.sort(m);var i=new Array(o.length);for(s=0;s<i.length;++s)i[s]=o[s][1];return i}var e={T:function(s){function l(i){this.data=i}var o=l.prototype;return o.dtype=s,o.index=function(){return-1},o.size=0,o.dimension=-1,o.shape=o.stride=o.order=[],o.lo=o.hi=o.transpose=o.step=function(){return new l(this.data)},o.get=o.set=function(){},o.pick=function(){return null},function(i){return new l(i)}},0:function(s,l){function o(c,n){this.data=c,this.offset=n}var i=o.prototype;return i.dtype=s,i.index=function(){return this.offset},i.dimension=0,i.size=1,i.shape=i.stride=i.order=[],i.lo=i.hi=i.transpose=i.step=function(){return new o(this.data,this.offset)},i.pick=function(){return l(this.data)},i.valueOf=i.get=function(){return s==="generic"?this.data.get(this.offset):this.data[this.offset]},i.set=function(c){return s==="generic"?this.data.set(this.offset,c):this.data[this.offset]=c},function(c,n,a,g){return new o(c,g)}},1:function(s,l,o){function i(n,a,g,h){this.data=n,this.shape=[a],this.stride=[g],this.offset=0|h}var c=i.prototype;return c.dtype=s,c.dimension=1,Object.defineProperty(c,"size",{get:function(){return this.shape[0]}}),c.order=[0],c.set=function(n,a){return s==="generic"?this.data.set(this.offset+this.stride[0]*n,a):this.data[this.offset+this.stride[0]*n]=a},c.get=function(n){return s==="generic"?this.data.get(this.offset+this.stride[0]*n):this.data[this.offset+this.stride[0]*n]},c.index=function(n){return this.offset+this.stride[0]*n},c.hi=function(n){return new i(this.data,typeof n!="number"||n<0?this.shape[0]:0|n,this.stride[0],this.offset)},c.lo=function(n){var a=this.offset,g=0,h=this.shape[0],y=this.stride[0];return typeof n=="number"&&n>=0&&(a+=y*(g=0|n),h-=g),new i(this.data,h,y,a)},c.step=function(n){var a=this.shape[0],g=this.stride[0],h=this.offset,y=0,v=Math.ceil;return typeof n=="number"&&((y=0|n)<0?(h+=g*(a-1),a=v(-a/y)):a=v(a/y),g*=y),new i(this.data,a,g,h)},c.transpose=function(n){n=n===void 0?0:0|n;var a=this.shape,g=this.stride;return new i(this.data,a[n],g[n],this.offset)},c.pick=function(n){var a=[],g=[],h=this.offset;return typeof n=="number"&&n>=0?h=h+this.stride[0]*n|0:(a.push(this.shape[0]),g.push(this.stride[0])),(0,l[a.length+1])(this.data,a,g,h)},function(n,a,g,h){return new i(n,a[0],g[0],h)}},2:function(s,l,o){function i(n,a,g,h,y,v){this.data=n,this.shape=[a,g],this.stride=[h,y],this.offset=0|v}var c=i.prototype;return c.dtype=s,c.dimension=2,Object.defineProperty(c,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(c,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),c.set=function(n,a,g){return s==="generic"?this.data.set(this.offset+this.stride[0]*n+this.stride[1]*a,g):this.data[this.offset+this.stride[0]*n+this.stride[1]*a]=g},c.get=function(n,a){return s==="generic"?this.data.get(this.offset+this.stride[0]*n+this.stride[1]*a):this.data[this.offset+this.stride[0]*n+this.stride[1]*a]},c.index=function(n,a){return this.offset+this.stride[0]*n+this.stride[1]*a},c.hi=function(n,a){return new i(this.data,typeof n!="number"||n<0?this.shape[0]:0|n,typeof a!="number"||a<0?this.shape[1]:0|a,this.stride[0],this.stride[1],this.offset)},c.lo=function(n,a){var g=this.offset,h=0,y=this.shape[0],v=this.shape[1],_=this.stride[0],x=this.stride[1];return typeof n=="number"&&n>=0&&(g+=_*(h=0|n),y-=h),typeof a=="number"&&a>=0&&(g+=x*(h=0|a),v-=h),new i(this.data,y,v,_,x,g)},c.step=function(n,a){var g=this.shape[0],h=this.shape[1],y=this.stride[0],v=this.stride[1],_=this.offset,x=0,T=Math.ceil;return typeof n=="number"&&((x=0|n)<0?(_+=y*(g-1),g=T(-g/x)):g=T(g/x),y*=x),typeof a=="number"&&((x=0|a)<0?(_+=v*(h-1),h=T(-h/x)):h=T(h/x),v*=x),new i(this.data,g,h,y,v,_)},c.transpose=function(n,a){n=n===void 0?0:0|n,a=a===void 0?1:0|a;var g=this.shape,h=this.stride;return new i(this.data,g[n],g[a],h[n],h[a],this.offset)},c.pick=function(n,a){var g=[],h=[],y=this.offset;return typeof n=="number"&&n>=0?y=y+this.stride[0]*n|0:(g.push(this.shape[0]),h.push(this.stride[0])),typeof a=="number"&&a>=0?y=y+this.stride[1]*a|0:(g.push(this.shape[1]),h.push(this.stride[1])),(0,l[g.length+1])(this.data,g,h,y)},function(n,a,g,h){return new i(n,a[0],a[1],g[0],g[1],h)}},3:function(s,l,o){function i(n,a,g,h,y,v,_,x){this.data=n,this.shape=[a,g,h],this.stride=[y,v,_],this.offset=0|x}var c=i.prototype;return c.dtype=s,c.dimension=3,Object.defineProperty(c,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(c,"order",{get:function(){var n=Math.abs(this.stride[0]),a=Math.abs(this.stride[1]),g=Math.abs(this.stride[2]);return n>a?a>g?[2,1,0]:n>g?[1,2,0]:[1,0,2]:n>g?[2,0,1]:g>a?[0,1,2]:[0,2,1]}}),c.set=function(n,a,g,h){return s==="generic"?this.data.set(this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g,h):this.data[this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g]=h},c.get=function(n,a,g){return s==="generic"?this.data.get(this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g):this.data[this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g]},c.index=function(n,a,g){return this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g},c.hi=function(n,a,g){return new i(this.data,typeof n!="number"||n<0?this.shape[0]:0|n,typeof a!="number"||a<0?this.shape[1]:0|a,typeof g!="number"||g<0?this.shape[2]:0|g,this.stride[0],this.stride[1],this.stride[2],this.offset)},c.lo=function(n,a,g){var h=this.offset,y=0,v=this.shape[0],_=this.shape[1],x=this.shape[2],T=this.stride[0],A=this.stride[1],S=this.stride[2];return typeof n=="number"&&n>=0&&(h+=T*(y=0|n),v-=y),typeof a=="number"&&a>=0&&(h+=A*(y=0|a),_-=y),typeof g=="number"&&g>=0&&(h+=S*(y=0|g),x-=y),new i(this.data,v,_,x,T,A,S,h)},c.step=function(n,a,g){var h=this.shape[0],y=this.shape[1],v=this.shape[2],_=this.stride[0],x=this.stride[1],T=this.stride[2],A=this.offset,S=0,w=Math.ceil;return typeof n=="number"&&((S=0|n)<0?(A+=_*(h-1),h=w(-h/S)):h=w(h/S),_*=S),typeof a=="number"&&((S=0|a)<0?(A+=x*(y-1),y=w(-y/S)):y=w(y/S),x*=S),typeof g=="number"&&((S=0|g)<0?(A+=T*(v-1),v=w(-v/S)):v=w(v/S),T*=S),new i(this.data,h,y,v,_,x,T,A)},c.transpose=function(n,a,g){n=n===void 0?0:0|n,a=a===void 0?1:0|a,g=g===void 0?2:0|g;var h=this.shape,y=this.stride;return new i(this.data,h[n],h[a],h[g],y[n],y[a],y[g],this.offset)},c.pick=function(n,a,g){var h=[],y=[],v=this.offset;return typeof n=="number"&&n>=0?v=v+this.stride[0]*n|0:(h.push(this.shape[0]),y.push(this.stride[0])),typeof a=="number"&&a>=0?v=v+this.stride[1]*a|0:(h.push(this.shape[1]),y.push(this.stride[1])),typeof g=="number"&&g>=0?v=v+this.stride[2]*g|0:(h.push(this.shape[2]),y.push(this.stride[2])),(0,l[h.length+1])(this.data,h,y,v)},function(n,a,g,h){return new i(n,a[0],a[1],a[2],g[0],g[1],g[2],h)}},4:function(s,l,o){function i(n,a,g,h,y,v,_,x,T,A){this.data=n,this.shape=[a,g,h,y],this.stride=[v,_,x,T],this.offset=0|A}var c=i.prototype;return c.dtype=s,c.dimension=4,Object.defineProperty(c,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(c,"order",{get:o}),c.set=function(n,a,g,h,y){return s==="generic"?this.data.set(this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*h,y):this.data[this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*h]=y},c.get=function(n,a,g,h){return s==="generic"?this.data.get(this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*h):this.data[this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*h]},c.index=function(n,a,g,h){return this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*h},c.hi=function(n,a,g,h){return new i(this.data,typeof n!="number"||n<0?this.shape[0]:0|n,typeof a!="number"||a<0?this.shape[1]:0|a,typeof g!="number"||g<0?this.shape[2]:0|g,typeof h!="number"||h<0?this.shape[3]:0|h,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},c.lo=function(n,a,g,h){var y=this.offset,v=0,_=this.shape[0],x=this.shape[1],T=this.shape[2],A=this.shape[3],S=this.stride[0],w=this.stride[1],C=this.stride[2],k=this.stride[3];return typeof n=="number"&&n>=0&&(y+=S*(v=0|n),_-=v),typeof a=="number"&&a>=0&&(y+=w*(v=0|a),x-=v),typeof g=="number"&&g>=0&&(y+=C*(v=0|g),T-=v),typeof h=="number"&&h>=0&&(y+=k*(v=0|h),A-=v),new i(this.data,_,x,T,A,S,w,C,k,y)},c.step=function(n,a,g,h){var y=this.shape[0],v=this.shape[1],_=this.shape[2],x=this.shape[3],T=this.stride[0],A=this.stride[1],S=this.stride[2],w=this.stride[3],C=this.offset,k=0,L=Math.ceil;return typeof n=="number"&&((k=0|n)<0?(C+=T*(y-1),y=L(-y/k)):y=L(y/k),T*=k),typeof a=="number"&&((k=0|a)<0?(C+=A*(v-1),v=L(-v/k)):v=L(v/k),A*=k),typeof g=="number"&&((k=0|g)<0?(C+=S*(_-1),_=L(-_/k)):_=L(_/k),S*=k),typeof h=="number"&&((k=0|h)<0?(C+=w*(x-1),x=L(-x/k)):x=L(x/k),w*=k),new i(this.data,y,v,_,x,T,A,S,w,C)},c.transpose=function(n,a,g,h){n=n===void 0?0:0|n,a=a===void 0?1:0|a,g=g===void 0?2:0|g,h=h===void 0?3:0|h;var y=this.shape,v=this.stride;return new i(this.data,y[n],y[a],y[g],y[h],v[n],v[a],v[g],v[h],this.offset)},c.pick=function(n,a,g,h){var y=[],v=[],_=this.offset;return typeof n=="number"&&n>=0?_=_+this.stride[0]*n|0:(y.push(this.shape[0]),v.push(this.stride[0])),typeof a=="number"&&a>=0?_=_+this.stride[1]*a|0:(y.push(this.shape[1]),v.push(this.stride[1])),typeof g=="number"&&g>=0?_=_+this.stride[2]*g|0:(y.push(this.shape[2]),v.push(this.stride[2])),typeof h=="number"&&h>=0?_=_+this.stride[3]*h|0:(y.push(this.shape[3]),v.push(this.stride[3])),(0,l[y.length+1])(this.data,y,v,_)},function(n,a,g,h){return new i(n,a[0],a[1],a[2],a[3],g[0],g[1],g[2],g[3],h)}},5:function(s,l,o){function i(n,a,g,h,y,v,_,x,T,A,S,w){this.data=n,this.shape=[a,g,h,y,v],this.stride=[_,x,T,A,S],this.offset=0|w}var c=i.prototype;return c.dtype=s,c.dimension=5,Object.defineProperty(c,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(c,"order",{get:o}),c.set=function(n,a,g,h,y,v){return s==="generic"?this.data.set(this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*h+this.stride[4]*y,v):this.data[this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*h+this.stride[4]*y]=v},c.get=function(n,a,g,h,y){return s==="generic"?this.data.get(this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*h+this.stride[4]*y):this.data[this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*h+this.stride[4]*y]},c.index=function(n,a,g,h,y){return this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*h+this.stride[4]*y},c.hi=function(n,a,g,h,y){return new i(this.data,typeof n!="number"||n<0?this.shape[0]:0|n,typeof a!="number"||a<0?this.shape[1]:0|a,typeof g!="number"||g<0?this.shape[2]:0|g,typeof h!="number"||h<0?this.shape[3]:0|h,typeof y!="number"||y<0?this.shape[4]:0|y,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},c.lo=function(n,a,g,h,y){var v=this.offset,_=0,x=this.shape[0],T=this.shape[1],A=this.shape[2],S=this.shape[3],w=this.shape[4],C=this.stride[0],k=this.stride[1],L=this.stride[2],M=this.stride[3],P=this.stride[4];return typeof n=="number"&&n>=0&&(v+=C*(_=0|n),x-=_),typeof a=="number"&&a>=0&&(v+=k*(_=0|a),T-=_),typeof g=="number"&&g>=0&&(v+=L*(_=0|g),A-=_),typeof h=="number"&&h>=0&&(v+=M*(_=0|h),S-=_),typeof y=="number"&&y>=0&&(v+=P*(_=0|y),w-=_),new i(this.data,x,T,A,S,w,C,k,L,M,P,v)},c.step=function(n,a,g,h,y){var v=this.shape[0],_=this.shape[1],x=this.shape[2],T=this.shape[3],A=this.shape[4],S=this.stride[0],w=this.stride[1],C=this.stride[2],k=this.stride[3],L=this.stride[4],M=this.offset,P=0,D=Math.ceil;return typeof n=="number"&&((P=0|n)<0?(M+=S*(v-1),v=D(-v/P)):v=D(v/P),S*=P),typeof a=="number"&&((P=0|a)<0?(M+=w*(_-1),_=D(-_/P)):_=D(_/P),w*=P),typeof g=="number"&&((P=0|g)<0?(M+=C*(x-1),x=D(-x/P)):x=D(x/P),C*=P),typeof h=="number"&&((P=0|h)<0?(M+=k*(T-1),T=D(-T/P)):T=D(T/P),k*=P),typeof y=="number"&&((P=0|y)<0?(M+=L*(A-1),A=D(-A/P)):A=D(A/P),L*=P),new i(this.data,v,_,x,T,A,S,w,C,k,L,M)},c.transpose=function(n,a,g,h,y){n=n===void 0?0:0|n,a=a===void 0?1:0|a,g=g===void 0?2:0|g,h=h===void 0?3:0|h,y=y===void 0?4:0|y;var v=this.shape,_=this.stride;return new i(this.data,v[n],v[a],v[g],v[h],v[y],_[n],_[a],_[g],_[h],_[y],this.offset)},c.pick=function(n,a,g,h,y){var v=[],_=[],x=this.offset;return typeof n=="number"&&n>=0?x=x+this.stride[0]*n|0:(v.push(this.shape[0]),_.push(this.stride[0])),typeof a=="number"&&a>=0?x=x+this.stride[1]*a|0:(v.push(this.shape[1]),_.push(this.stride[1])),typeof g=="number"&&g>=0?x=x+this.stride[2]*g|0:(v.push(this.shape[2]),_.push(this.stride[2])),typeof h=="number"&&h>=0?x=x+this.stride[3]*h|0:(v.push(this.shape[3]),_.push(this.stride[3])),typeof y=="number"&&y>=0?x=x+this.stride[4]*y|0:(v.push(this.shape[4]),_.push(this.stride[4])),(0,l[v.length+1])(this.data,v,_,x)},function(n,a,g,h){return new i(n,a[0],a[1],a[2],a[3],a[4],g[0],g[1],g[2],g[3],g[4],h)}}};function f(s,l){var o=l===-1?"T":String(l),i=e[o];return l===-1?i(s):l===0?i(s,u[s][0]):i(s,u[s],p)}var u={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};O.exports=function(s,l,o,i){if(s===void 0)return(0,u.array[0])([]);typeof s=="number"&&(s=[s]),l===void 0&&(l=[s.length]);var c=l.length;if(o===void 0){o=new Array(c);for(var n=c-1,a=1;n>=0;--n)o[n]=a,a*=l[n]}if(i===void 0)for(i=0,n=0;n<c;++n)o[n]<0&&(i-=(l[n]-1)*o[n]);for(var g=function(y){if(t(y))return"buffer";if(d)switch(Object.prototype.toString.call(y)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(y)?"array":"generic"}(s),h=u[g];h.length<=c+1;)h.push(f(g,h.length-1));return(0,h[c+1])(s,l,o,i)}},{"is-buffer":443}],473:[function(r,O,B){var t=r("double-bits"),d=Math.pow(2,-1074);O.exports=function(m,p){if(isNaN(m)||isNaN(p))return NaN;if(m===p)return m;if(m===0)return p<0?-d:d;var e=t.hi(m),f=t.lo(m);return p>m==m>0?f===-1>>>0?(e+=1,f=0):f+=1:f===0?(f=-1>>>0,e-=1):f-=1,t.pack(f,e)}},{"double-bits":179}],474:[function(r,O,B){var t=Math.PI,d=u(120);function m(s,l,o,i){return["C",s,l,o,i,o,i]}function p(s,l,o,i,c,n){return["C",s/3+2/3*o,l/3+2/3*i,c/3+2/3*o,n/3+2/3*i,c,n]}function e(s,l,o,i,c,n,a,g,h,y){if(y)L=y[0],M=y[1],C=y[2],k=y[3];else{var v=f(s,l,-c);s=v.x,l=v.y;var _=(s-(g=(v=f(g,h,-c)).x))/2,x=(l-(h=v.y))/2,T=_*_/(o*o)+x*x/(i*i);T>1&&(o*=T=Math.sqrt(T),i*=T);var A=o*o,S=i*i,w=(n==a?-1:1)*Math.sqrt(Math.abs((A*S-A*x*x-S*_*_)/(A*x*x+S*_*_)));w==1/0&&(w=1);var C=w*o*x/i+(s+g)/2,k=w*-i*_/o+(l+h)/2,L=Math.asin(((l-k)/i).toFixed(9)),M=Math.asin(((h-k)/i).toFixed(9));(L=s<C?t-L:L)<0&&(L=2*t+L),(M=g<C?t-M:M)<0&&(M=2*t+M),a&&L>M&&(L-=2*t),!a&&M>L&&(M-=2*t)}if(Math.abs(M-L)>d){var P=M,D=g,N=h;M=L+d*(a&&M>L?1:-1);var U=e(g=C+o*Math.cos(M),h=k+i*Math.sin(M),o,i,c,0,a,D,N,[M,P,C,k])}var q=Math.tan((M-L)/4),X=4/3*o*q,K=4/3*i*q,Z=[2*s-(s+X*Math.sin(L)),2*l-(l-K*Math.cos(L)),g+X*Math.sin(M),h-K*Math.cos(M),g,h];if(y)return Z;U&&(Z=Z.concat(U));for(var H=0;H<Z.length;){var Y=f(Z[H],Z[H+1],c);Z[H++]=Y.x,Z[H++]=Y.y}return Z}function f(s,l,o){return{x:s*Math.cos(o)-l*Math.sin(o),y:s*Math.sin(o)+l*Math.cos(o)}}function u(s){return s*(t/180)}O.exports=function(s){for(var l,o=[],i=0,c=0,n=0,a=0,g=null,h=null,y=0,v=0,_=0,x=s.length;_<x;_++){var T=s[_],A=T[0];switch(A){case"M":n=T[1],a=T[2];break;case"A":(T=e(y,v,T[1],T[2],u(T[3]),T[4],T[5],T[6],T[7])).unshift("C"),T.length>7&&(o.push(T.splice(0,7)),T.unshift("C"));break;case"S":var S=y,w=v;l!="C"&&l!="S"||(S+=S-i,w+=w-c),T=["C",S,w,T[1],T[2],T[3],T[4]];break;case"T":l=="Q"||l=="T"?(g=2*y-g,h=2*v-h):(g=y,h=v),T=p(y,v,g,h,T[1],T[2]);break;case"Q":g=T[1],h=T[2],T=p(y,v,T[1],T[2],T[3],T[4]);break;case"L":T=m(y,v,T[1],T[2]);break;case"H":T=m(y,v,T[1],v);break;case"V":T=m(y,v,y,T[1]);break;case"Z":T=m(y,v,n,a)}l=A,y=T[T.length-2],v=T[T.length-1],T.length>4?(i=T[T.length-4],c=T[T.length-3]):(i=y,c=v),o.push(T)}return o}},{}],475:[function(r,O,B){B.vertexNormals=function(t,d,m){for(var p=d.length,e=new Array(p),f=m===void 0?1e-6:m,u=0;u<p;++u)e[u]=[0,0,0];for(u=0;u<t.length;++u)for(var s=t[u],l=0,o=s[s.length-1],i=s[0],c=0;c<s.length;++c){l=o,o=i,i=s[(c+1)%s.length];for(var n=d[l],a=d[o],g=d[i],h=new Array(3),y=0,v=new Array(3),_=0,x=0;x<3;++x)h[x]=n[x]-a[x],y+=h[x]*h[x],v[x]=g[x]-a[x],_+=v[x]*v[x];if(y*_>f){var T=e[o],A=1/Math.sqrt(y*_);for(x=0;x<3;++x){var S=(x+1)%3,w=(x+2)%3;T[x]+=A*(v[S]*h[w]-v[w]*h[S])}}}for(u=0;u<p;++u){T=e[u];var C=0;for(x=0;x<3;++x)C+=T[x]*T[x];if(C>f)for(A=1/Math.sqrt(C),x=0;x<3;++x)T[x]*=A;else for(x=0;x<3;++x)T[x]=0}return e},B.faceNormals=function(t,d,m){for(var p=t.length,e=new Array(p),f=m===void 0?1e-6:m,u=0;u<p;++u){for(var s=t[u],l=new Array(3),o=0;o<3;++o)l[o]=d[s[o]];var i=new Array(3),c=new Array(3);for(o=0;o<3;++o)i[o]=l[1][o]-l[0][o],c[o]=l[2][o]-l[0][o];var n=new Array(3),a=0;for(o=0;o<3;++o){var g=(o+1)%3,h=(o+2)%3;n[o]=i[g]*c[h]-i[h]*c[g],a+=n[o]*n[o]}for(a=a>f?1/Math.sqrt(a):0,o=0;o<3;++o)n[o]*=a;e[u]=n}return e}},{}],476:[function(r,O,B){var t=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable;function p(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}O.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var f={},u=0;u<10;u++)f["_"+String.fromCharCode(u)]=u;if(Object.getOwnPropertyNames(f).map(function(l){return f[l]}).join("")!=="0123456789")return!1;var s={};return"abcdefghijklmnopqrst".split("").forEach(function(l){s[l]=l}),Object.keys(Object.assign({},s)).join("")==="abcdefghijklmnopqrst"}catch(l){return!1}}()?Object.assign:function(e,f){for(var u,s,l=p(e),o=1;o<arguments.length;o++){for(var i in u=Object(arguments[o]))d.call(u,i)&&(l[i]=u[i]);if(t){s=t(u);for(var c=0;c<s.length;c++)m.call(u,s[c])&&(l[s[c]]=u[s[c]])}}return l}},{}],477:[function(r,O,B){O.exports=function(t,d,m,p,e,f,u,s,l,o){var i=d+f+o;if(c>0){var c=Math.sqrt(i+1);t[0]=.5*(u-l)/c,t[1]=.5*(s-p)/c,t[2]=.5*(m-f)/c,t[3]=.5*c}else{var n=Math.max(d,f,o);c=Math.sqrt(2*n-i+1),d>=n?(t[0]=.5*c,t[1]=.5*(e+m)/c,t[2]=.5*(s+p)/c,t[3]=.5*(u-l)/c):f>=n?(t[0]=.5*(m+e)/c,t[1]=.5*c,t[2]=.5*(l+u)/c,t[3]=.5*(s-p)/c):(t[0]=.5*(p+s)/c,t[1]=.5*(u+l)/c,t[2]=.5*c,t[3]=.5*(m-e)/c)}return t}},{}],478:[function(r,O,B){O.exports=function(i){var c=(i=i||{}).center||[0,0,0],n=i.rotation||[0,0,0,1],a=i.radius||1;c=[].slice.call(c,0,3),s(n=[].slice.call(n,0,4),n);var g=new l(n,c,Math.log(a));return g.setDistanceLimits(i.zoomMin,i.zoomMax),("eye"in i||"up"in i)&&g.lookAt(0,i.eye,i.center,i.up),g};var t=r("filtered-vector"),d=r("gl-mat4/lookAt"),m=r("gl-mat4/fromQuat"),p=r("gl-mat4/invert"),e=r("./lib/quatFromFrame");function f(i,c,n){return Math.sqrt(Math.pow(i,2)+Math.pow(c,2)+Math.pow(n,2))}function u(i,c,n,a){return Math.sqrt(Math.pow(i,2)+Math.pow(c,2)+Math.pow(n,2)+Math.pow(a,2))}function s(i,c){var n=c[0],a=c[1],g=c[2],h=c[3],y=u(n,a,g,h);y>1e-6?(i[0]=n/y,i[1]=a/y,i[2]=g/y,i[3]=h/y):(i[0]=i[1]=i[2]=0,i[3]=1)}function l(i,c,n){this.radius=t([n]),this.center=t(c),this.rotation=t(i),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var o=l.prototype;o.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},o.recalcMatrix=function(i){this.radius.curve(i),this.center.curve(i),this.rotation.curve(i);var c=this.computedRotation;s(c,c);var n=this.computedMatrix;m(n,c);var a=this.computedCenter,g=this.computedEye,h=this.computedUp,y=Math.exp(this.computedRadius[0]);g[0]=a[0]+y*n[2],g[1]=a[1]+y*n[6],g[2]=a[2]+y*n[10],h[0]=n[1],h[1]=n[5],h[2]=n[9];for(var v=0;v<3;++v){for(var _=0,x=0;x<3;++x)_+=n[v+4*x]*g[x];n[12+v]=-_}},o.getMatrix=function(i,c){this.recalcMatrix(i);var n=this.computedMatrix;if(c){for(var a=0;a<16;++a)c[a]=n[a];return c}return n},o.idle=function(i){this.center.idle(i),this.radius.idle(i),this.rotation.idle(i)},o.flush=function(i){this.center.flush(i),this.radius.flush(i),this.rotation.flush(i)},o.pan=function(i,c,n,a){c=c||0,n=n||0,a=a||0,this.recalcMatrix(i);var g=this.computedMatrix,h=g[1],y=g[5],v=g[9],_=f(h,y,v);h/=_,y/=_,v/=_;var x=g[0],T=g[4],A=g[8],S=x*h+T*y+A*v,w=f(x-=h*S,T-=y*S,A-=v*S);x/=w,T/=w,A/=w,g[2],g[6],g[10];var C=x*c+h*n,k=T*c+y*n,L=A*c+v*n;this.center.move(i,C,k,L);var M=Math.exp(this.computedRadius[0]);M=Math.max(1e-4,M+a),this.radius.set(i,Math.log(M))},o.rotate=function(i,c,n,a){this.recalcMatrix(i),c=c||0,n=n||0;var g=this.computedMatrix,h=g[0],y=g[4],v=g[8],_=g[1],x=g[5],T=g[9],A=g[2],S=g[6],w=g[10],C=c*h+n*_,k=c*y+n*x,L=c*v+n*T,M=-(S*L-w*k),P=-(w*C-A*L),D=-(A*k-S*C),N=Math.sqrt(Math.max(0,1-Math.pow(M,2)-Math.pow(P,2)-Math.pow(D,2))),U=u(M,P,D,N);U>1e-6?(M/=U,P/=U,D/=U,N/=U):(M=P=D=0,N=1);var q=this.computedRotation,X=q[0],K=q[1],Z=q[2],H=q[3],Y=X*N+H*M+K*D-Z*P,$=K*N+H*P+Z*M-X*D,z=Z*N+H*D+X*P-K*M,j=H*N-X*M-K*P-Z*D;if(a){M=A,P=S,D=w;var W=Math.sin(a)/f(M,P,D);M*=W,P*=W,D*=W,j=j*(N=Math.cos(c))-(Y=Y*N+j*M+$*D-z*P)*M-($=$*N+j*P+z*M-Y*D)*P-(z=z*N+j*D+Y*P-$*M)*D}var ee=u(Y,$,z,j);ee>1e-6?(Y/=ee,$/=ee,z/=ee,j/=ee):(Y=$=z=0,j=1),this.rotation.set(i,Y,$,z,j)},o.lookAt=function(i,c,n,a){this.recalcMatrix(i),n=n||this.computedCenter,c=c||this.computedEye,a=a||this.computedUp;var g=this.computedMatrix;d(g,c,n,a);var h=this.computedRotation;e(h,g[0],g[1],g[2],g[4],g[5],g[6],g[8],g[9],g[10]),s(h,h),this.rotation.set(i,h[0],h[1],h[2],h[3]);for(var y=0,v=0;v<3;++v)y+=Math.pow(n[v]-c[v],2);this.radius.set(i,.5*Math.log(Math.max(y,1e-6))),this.center.set(i,n[0],n[1],n[2])},o.translate=function(i,c,n,a){this.center.move(i,c||0,n||0,a||0)},o.setMatrix=function(i,c){var n=this.computedRotation;e(n,c[0],c[1],c[2],c[4],c[5],c[6],c[8],c[9],c[10]),s(n,n),this.rotation.set(i,n[0],n[1],n[2],n[3]);var a=this.computedMatrix;p(a,c);var g=a[15];if(Math.abs(g)>1e-6){var h=a[12]/g,y=a[13]/g,v=a[14]/g;this.recalcMatrix(i);var _=Math.exp(this.computedRadius[0]);this.center.set(i,h-a[2]*_,y-a[6]*_,v-a[10]*_),this.radius.idle(i)}else this.center.idle(i),this.radius.idle(i)},o.setDistance=function(i,c){c>0&&this.radius.set(i,Math.log(c))},o.setDistanceLimits=function(i,c){i=i>0?Math.log(i):-1/0,c=c>0?Math.log(c):1/0,c=Math.max(c,i),this.radius.bounds[0][0]=i,this.radius.bounds[1][0]=c},o.getDistanceLimits=function(i){var c=this.radius.bounds;return i?(i[0]=Math.exp(c[0][0]),i[1]=Math.exp(c[1][0]),i):[Math.exp(c[0][0]),Math.exp(c[1][0])]},o.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},o.fromJSON=function(i){var c=this.lastT(),n=i.center;n&&this.center.set(c,n[0],n[1],n[2]);var a=i.rotation;a&&this.rotation.set(c,a[0],a[1],a[2],a[3]);var g=i.distance;g&&g>0&&this.radius.set(c,Math.log(g)),this.setDistanceLimits(i.zoomMin,i.zoomMax)}},{"./lib/quatFromFrame":477,"filtered-vector":247,"gl-mat4/fromQuat":282,"gl-mat4/invert":293,"gl-mat4/lookAt":294}],479:[function(r,O,B){var t=r("repeat-string");O.exports=function(d,m,p){return t(p=p!==void 0?p+"":" ",m)+d}},{"repeat-string":527}],480:[function(r,O,B){function t(p,e){if(typeof p!="string")return[p];var f=[p];typeof e=="string"||Array.isArray(e)?e={brackets:e}:e||(e={});var u=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],s=e.escape||"___",l=!!e.flat;u.forEach(function(i){var c=new RegExp(["\\",i[0],"[^\\",i[0],"\\",i[1],"]*\\",i[1]].join("")),n=[];function a(g,h,y){var v=f.push(g.slice(i[0].length,-i[1].length))-1;return n.push(v),s+v+s}f.forEach(function(g,h){for(var y,v=0;g!=y;)if(y=g,g=g.replace(c,a),v++>1e4)throw Error("References have circular dependency. Please, check them.");f[h]=g}),n=n.reverse(),f=f.map(function(g){return n.forEach(function(h){g=g.replace(new RegExp("(\\"+s+h+"\\"+s+")","g"),i[0]+"$1"+i[1])}),g})});var o=new RegExp("\\"+s+"([0-9]+)\\"+s);return l?f:function i(c,n,a){for(var g,h=[],y=0;g=o.exec(c);){if(y++>1e4)throw Error("Circular references in parenthesis");h.push(c.slice(0,g.index)),h.push(i(n[g[1]],n)),c=c.slice(g.index+g[0].length)}return h.push(c),h}(f[0],f)}function d(p,e){if(e&&e.flat){var f,u=e&&e.escape||"___",s=p[0];if(!s)return"";for(var l=new RegExp("\\"+u+"([0-9]+)\\"+u),o=0;s!=f;){if(o++>1e4)throw Error("Circular references in "+p);f=s,s=s.replace(l,i)}return s}return p.reduce(function c(n,a){return Array.isArray(a)&&(a=a.reduce(c,"")),n+a},"");function i(c,n){if(p[n]==null)throw Error("Reference "+n+"is undefined");return p[n]}}function m(p,e){return Array.isArray(p)?d(p,e):t(p,e)}m.parse=t,m.stringify=d,O.exports=m},{}],481:[function(r,O,B){var t=r("pick-by-alias");O.exports=function(d){var m;return arguments.length>1&&(d=arguments),typeof d=="string"?d=d.split(/\s/).map(parseFloat):typeof d=="number"&&(d=[d]),d.length&&typeof d[0]=="number"?m=d.length===1?{width:d[0],height:d[0],x:0,y:0}:d.length===2?{width:d[0],height:d[1],x:0,y:0}:{x:d[0],y:d[1],width:d[2]-d[0]||0,height:d[3]-d[1]||0}:d&&(d=t(d,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),m={x:d.left||0,y:d.top||0},d.width==null?d.right?m.width=d.right-m.x:m.width=0:m.width=d.width,d.height==null?d.bottom?m.height=d.bottom-m.y:m.height=0:m.height=d.height),m}},{"pick-by-alias":485}],482:[function(r,O,B){O.exports=function(p){var e=[];return p.replace(d,function(f,u,s){var l=u.toLowerCase();for(s=function(o){var i=o.match(m);return i?i.map(Number):[]}(s),l=="m"&&s.length>2&&(e.push([u].concat(s.splice(0,2))),l="l",u=u=="m"?"l":"L");;){if(s.length==t[l])return s.unshift(u),e.push(s);if(s.length<t[l])throw new Error("malformed path data");e.push([u].concat(s.splice(0,t[l])))}}),e};var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},d=/([astvzqmhlc])([^astvzqmhlc]*)/gi,m=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},{}],483:[function(r,O,B){O.exports=function(t,d){d||(d=[0,""]),t=String(t);var m=parseFloat(t,10);return d[0]=m,d[1]=t.match(/[\d.\-\+]*\s*(.*)/)[1]||"",d}},{}],484:[function(r,O,B){(function(t){(function(){(function(){var d,m,p,e,f,u;typeof performance!="undefined"&&performance!==null&&performance.now?O.exports=function(){return performance.now()}:t!=null&&t.hrtime?(O.exports=function(){return(d()-f)/1e6},m=t.hrtime,e=(d=function(){var s;return 1e9*(s=m())[0]+s[1]})(),u=1e9*t.uptime(),f=e-u):Date.now?(O.exports=function(){return Date.now()-p},p=Date.now()):(O.exports=function(){return new Date().getTime()-p},p=new Date().getTime())}).call(this)}).call(this)}).call(this,r("_process"))},{_process:514}],485:[function(r,O,B){O.exports=function(m,p,e){var f,u,s={};if(typeof p=="string"&&(p=d(p)),Array.isArray(p)){var l={};for(u=0;u<p.length;u++)l[p[u]]=!0;p=l}for(f in p)p[f]=d(p[f]);var o={};for(f in p){var i=p[f];if(Array.isArray(i))for(u=0;u<i.length;u++){var c=i[u];if(e&&(o[c]=!0),c in m){if(s[f]=m[c],e)for(var n=u;n<i.length;n++)o[i[n]]=!0;break}}else f in m&&(p[f]&&(s[f]=m[f]),e&&(o[f]=!0))}if(e)for(f in m)o[f]||(s[f]=m[f]);return s};var t={};function d(m){return t[m]?t[m]:(typeof m=="string"&&(m=t[m]=m.split(/\s*,\s*|\s+/)),m)}},{}],486:[function(r,O,B){O.exports=function(d,m){for(var p=0|m.length,e=d.length,f=[new Array(p),new Array(p)],u=0;u<p;++u)f[0][u]=[],f[1][u]=[];for(u=0;u<e;++u){var s=d[u];f[0][s[0]].push(s),f[1][s[1]].push(s)}var l=[];for(u=0;u<p;++u)f[0][u].length+f[1][u].length===0&&l.push([u]);function o(y,v){var _=f[v][y[v]];_.splice(_.indexOf(y),1)}function i(y,v,_){for(var x,T,A,S=0;S<2;++S)if(f[S][v].length>0){x=f[S][v][0],A=S;break}T=x[1^A];for(var w=0;w<2;++w)for(var C=f[w][v],k=0;k<C.length;++k){var L=C[k],M=L[1^w];t(m[y],m[v],m[T],m[M])>0&&(x=L,T=M,A=w)}return _||x&&o(x,A),T}function c(y,v){var _=f[v][y][0],x=[y];o(_,v);for(var T=_[1^v];;){for(;T!==y;)x.push(T),T=i(x[x.length-2],T,!1);if(f[0][y].length+f[1][y].length===0)break;var A=x[x.length-1],S=y,w=x[1],C=i(A,S,!0);if(t(m[A],m[S],m[w],m[C])<0)break;x.push(y),T=i(A,S)}return x}function n(y,v){return v[1]===v[v.length-1]}for(u=0;u<p;++u)for(var a=0;a<2;++a){for(var g=[];f[a][u].length>0;){f[0][u].length;var h=c(u,a);n(0,h)?g.push.apply(g,h):(g.length>0&&l.push(g),g=h)}g.length>0&&l.push(g)}return l};var t=r("compare-angle")},{"compare-angle":138}],487:[function(r,O,B){O.exports=function(d,m){for(var p=t(d,m.length),e=new Array(m.length),f=new Array(m.length),u=[],s=0;s<m.length;++s){var l=p[s].length;f[s]=l,e[s]=!0,l<=1&&u.push(s)}for(;u.length>0;){var o=u.pop();e[o]=!1;var i=p[o];for(s=0;s<i.length;++s){var c=i[s];--f[c]==0&&u.push(c)}}var n=new Array(m.length),a=[];for(s=0;s<m.length;++s)e[s]?(o=a.length,n[s]=o,a.push(m[s])):n[s]=-1;var g=[];for(s=0;s<d.length;++s){var h=d[s];e[h[0]]&&e[h[1]]&&g.push([n[h[0]],n[h[1]]])}return[g,a]};var t=r("edges-to-adjacency-list")},{"edges-to-adjacency-list":184}],488:[function(r,O,B){O.exports=function(l,o){var i=u(l,o);l=i[0];for(var c=(o=i[1]).length,n=(l.length,t(l,o.length)),a=0;a<c;++a)if(n[a].length%2==1)throw new Error("planar-graph-to-polyline: graph must be manifold");var g=d(l,o),h=(g=g.filter(function(te){for(var ie=te.length,ae=[0],he=0;he<ie;++he){var se=o[te[he]],de=o[te[(he+1)%ie]],ue=p(-se[0],se[1]),ve=p(-se[0],de[1]),ke=p(de[0],se[1]),Ee=p(de[0],de[1]);ae=e(ae,e(e(ue,ve),e(ke,Ee)))}return ae[ae.length-1]>0})).length,y=new Array(h),v=new Array(h);for(a=0;a<h;++a){y[a]=a;var _=new Array(h),x=g[a].map(function(te){return o[te]}),T=m([x]),A=0;e:for(var S=0;S<h;++S)if(_[S]=0,a!==S){for(var w=(J=g[S]).length,C=0;C<w;++C){var k=T(o[J[C]]);if(k!==0){k<0&&(_[S]=1,A+=1);continue e}}_[S]=1,A+=1}v[a]=[A,a,_]}for(v.sort(function(te,ie){return ie[0]-te[0]}),a=0;a<h;++a){var L=(_=v[a])[1],M=_[2];for(S=0;S<h;++S)M[S]&&(y[S]=L)}var P=function(te){for(var ie=new Array(te),ae=0;ae<te;++ae)ie[ae]=[];return ie}(h);for(a=0;a<h;++a)P[a].push(y[a]),P[y[a]].push(a);var D={},N=s(c,!1);for(a=0;a<h;++a)for(w=(J=g[a]).length,S=0;S<w;++S){var U=J[S],q=J[(S+1)%w],X=Math.min(U,q)+":"+Math.max(U,q);if(X in D){var K=D[X];P[K].push(a),P[a].push(K),N[U]=N[q]=!0}else D[X]=a}function Z(te){for(var ie=te.length,ae=0;ae<ie;++ae)if(!N[te[ae]])return!1;return!0}var H=[],Y=s(h,-1);for(a=0;a<h;++a)y[a]!==a||Z(g[a])?Y[a]=-1:(H.push(a),Y[a]=0);for(i=[];H.length>0;){var $=H.pop(),z=P[$];f(z,function(te,ie){return te-ie});var j,W=z.length,ee=Y[$];if(ee===0){var J=g[$];j=[J]}for(a=0;a<W;++a){var Q=z[a];Y[Q]>=0||(Y[Q]=1^ee,H.push(Q),ee===0&&(Z(J=g[Q])||(J.reverse(),j.push(J))))}ee===0&&i.push(j)}return i};var t=r("edges-to-adjacency-list"),d=r("planar-dual"),m=r("point-in-big-polygon"),p=r("two-product"),e=r("robust-sum"),f=r("uniq"),u=r("./lib/trim-leaves");function s(l,o){for(var i=new Array(l),c=0;c<l;++c)i[c]=o;return i}},{"./lib/trim-leaves":487,"edges-to-adjacency-list":184,"planar-dual":486,"point-in-big-polygon":489,"robust-sum":539,"two-product":588,uniq:603}],489:[function(r,O,B){O.exports=function(s){for(var l=s.length,o=[],i=[],c=0;c<l;++c)for(var n=s[c],a=n.length,g=a-1,h=0;h<a;g=h++){var y=n[g],v=n[h];y[0]===v[0]?i.push([y,v]):o.push([y,v])}if(o.length===0)return i.length===0?u:(_=f(i),function(A){return _(A[0],A[1])?0:1});var _,x=d(o),T=function(A,S){return function(w){var C=p.le(S,w[0]);if(C<0)return 1;var k=A[C];if(!k){if(!(C>0&&S[C]===w[0]))return 1;k=A[C-1]}for(var L=1;k;){var M=k.key,P=t(w,M[0],M[1]);if(M[0][0]<M[1][0])if(P<0)k=k.left;else{if(!(P>0))return 0;L=-1,k=k.right}else if(P>0)k=k.left;else{if(!(P<0))return 0;L=1,k=k.right}}return L}}(x.slabs,x.coordinates);return i.length===0?T:function(A,S){return function(w){return A(w[0],w[1])?0:S(w)}}(f(i),T)};var t=r("robust-orientation")[3],d=r("slab-decomposition"),m=r("interval-tree-1d"),p=r("binary-search-bounds");function e(){return!0}function f(s){for(var l={},o=0;o<s.length;++o){var i=s[o],c=i[0][0],n=i[0][1],a=i[1][1],g=[Math.min(n,a),Math.max(n,a)];c in l?l[c].push(g):l[c]=[g]}var h={},y=Object.keys(l);for(o=0;o<y.length;++o){var v=l[y[o]];h[y[o]]=m(v)}return function(_){return function(x,T){var A=_[x];return!!A&&!!A.queryPoint(T,e)}}(h)}function u(s){return 1}},{"binary-search-bounds":103,"interval-tree-1d":440,"robust-orientation":534,"slab-decomposition":551}],490:[function(r,O,B){/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */var t,d=r("./lib/build-log"),m=r("./lib/epsilon"),p=r("./lib/intersecter"),e=r("./lib/segment-chainer"),f=r("./lib/segment-selector"),u=r("./lib/geojson"),s=!1,l=m();function o(i,c,n){var a=t.segments(i),g=t.segments(c),h=n(t.combine(a,g));return t.polygon(h)}t={buildLog:function(i){return i===!0?s=d():i===!1&&(s=!1),s!==!1&&s.list},epsilon:function(i){return l.epsilon(i)},segments:function(i){var c=p(!0,l,s);return i.regions.forEach(c.addRegion),{segments:c.calculate(i.inverted),inverted:i.inverted}},combine:function(i,c){return{combined:p(!1,l,s).calculate(i.segments,i.inverted,c.segments,c.inverted),inverted1:i.inverted,inverted2:c.inverted}},selectUnion:function(i){return{segments:f.union(i.combined,s),inverted:i.inverted1||i.inverted2}},selectIntersect:function(i){return{segments:f.intersect(i.combined,s),inverted:i.inverted1&&i.inverted2}},selectDifference:function(i){return{segments:f.difference(i.combined,s),inverted:i.inverted1&&!i.inverted2}},selectDifferenceRev:function(i){return{segments:f.differenceRev(i.combined,s),inverted:!i.inverted1&&i.inverted2}},selectXor:function(i){return{segments:f.xor(i.combined,s),inverted:i.inverted1!==i.inverted2}},polygon:function(i){return{regions:e(i.segments,l,s),inverted:i.inverted}},polygonFromGeoJSON:function(i){return u.toPolygon(t,i)},polygonToGeoJSON:function(i){return u.fromPolygon(t,l,i)},union:function(i,c){return o(i,c,t.selectUnion)},intersect:function(i,c){return o(i,c,t.selectIntersect)},difference:function(i,c){return o(i,c,t.selectDifference)},differenceRev:function(i,c){return o(i,c,t.selectDifferenceRev)},xor:function(i,c){return o(i,c,t.selectXor)}},typeof window=="object"&&(window.PolyBool=t),O.exports=t},{"./lib/build-log":491,"./lib/epsilon":492,"./lib/geojson":493,"./lib/intersecter":494,"./lib/segment-chainer":496,"./lib/segment-selector":497}],491:[function(r,O,B){O.exports=function(){var t,d=0,m=!1;function p(e,f){return t.list.push({type:e,data:f?JSON.parse(JSON.stringify(f)):void 0}),t}return t={list:[],segmentId:function(){return d++},checkIntersection:function(e,f){return p("check",{seg1:e,seg2:f})},segmentChop:function(e,f){return p("div_seg",{seg:e,pt:f}),p("chop",{seg:e,pt:f})},statusRemove:function(e){return p("pop_seg",{seg:e})},segmentUpdate:function(e){return p("seg_update",{seg:e})},segmentNew:function(e,f){return p("new_seg",{seg:e,primary:f})},segmentRemove:function(e){return p("rem_seg",{seg:e})},tempStatus:function(e,f,u){return p("temp_status",{seg:e,above:f,below:u})},rewind:function(e){return p("rewind",{seg:e})},status:function(e,f,u){return p("status",{seg:e,above:f,below:u})},vert:function(e){return e===m?t:(m=e,p("vert",{x:e}))},log:function(e){return typeof e!="string"&&(e=JSON.stringify(e,!1,"  ")),p("log",{txt:e})},reset:function(){return p("reset")},selected:function(e){return p("selected",{segs:e})},chainStart:function(e){return p("chain_start",{seg:e})},chainRemoveHead:function(e,f){return p("chain_rem_head",{index:e,pt:f})},chainRemoveTail:function(e,f){return p("chain_rem_tail",{index:e,pt:f})},chainNew:function(e,f){return p("chain_new",{pt1:e,pt2:f})},chainMatch:function(e){return p("chain_match",{index:e})},chainClose:function(e){return p("chain_close",{index:e})},chainAddHead:function(e,f){return p("chain_add_head",{index:e,pt:f})},chainAddTail:function(e,f){return p("chain_add_tail",{index:e,pt:f})},chainConnect:function(e,f){return p("chain_con",{index1:e,index2:f})},chainReverse:function(e){return p("chain_rev",{index:e})},chainJoin:function(e,f){return p("chain_join",{index1:e,index2:f})},done:function(){return p("done")}}}},{}],492:[function(r,O,B){O.exports=function(t){typeof t!="number"&&(t=1e-10);var d={epsilon:function(m){return typeof m=="number"&&(t=m),t},pointAboveOrOnLine:function(m,p,e){var f=p[0],u=p[1],s=e[0],l=e[1],o=m[0];return(s-f)*(m[1]-u)-(l-u)*(o-f)>=-t},pointBetween:function(m,p,e){var f=m[1]-p[1],u=e[0]-p[0],s=m[0]-p[0],l=e[1]-p[1],o=s*u+f*l;return!(o<t)&&!(o-(u*u+l*l)>-t)},pointsSameX:function(m,p){return Math.abs(m[0]-p[0])<t},pointsSameY:function(m,p){return Math.abs(m[1]-p[1])<t},pointsSame:function(m,p){return d.pointsSameX(m,p)&&d.pointsSameY(m,p)},pointsCompare:function(m,p){return d.pointsSameX(m,p)?d.pointsSameY(m,p)?0:m[1]<p[1]?-1:1:m[0]<p[0]?-1:1},pointsCollinear:function(m,p,e){var f=m[0]-p[0],u=m[1]-p[1],s=p[0]-e[0],l=p[1]-e[1];return Math.abs(f*l-s*u)<t},linesIntersect:function(m,p,e,f){var u=p[0]-m[0],s=p[1]-m[1],l=f[0]-e[0],o=f[1]-e[1],i=u*o-s*l;if(Math.abs(i)<t)return!1;var c=m[0]-e[0],n=m[1]-e[1],a=(l*n-o*c)/i,g=(u*n-s*c)/i,h={alongA:0,alongB:0,pt:[m[0]+a*u,m[1]+a*s]};return h.alongA=a<=-t?-2:a<t?-1:a-1<=-t?0:a-1<t?1:2,h.alongB=g<=-t?-2:g<t?-1:g-1<=-t?0:g-1<t?1:2,h},pointInsideRegion:function(m,p){for(var e=m[0],f=m[1],u=p[p.length-1][0],s=p[p.length-1][1],l=!1,o=0;o<p.length;o++){var i=p[o][0],c=p[o][1];c-f>t!=s-f>t&&(u-i)*(f-c)/(s-c)+i-e>t&&(l=!l),u=i,s=c}return l}};return d}},{}],493:[function(r,O,B){var t={toPolygon:function(d,m){function p(u){if(u.length<=0)return d.segments({inverted:!1,regions:[]});function s(i){var c=i.slice(0,i.length-1);return d.segments({inverted:!1,regions:[c]})}for(var l=s(u[0]),o=1;o<u.length;o++)l=d.selectDifference(d.combine(l,s(u[o])));return l}if(m.type==="Polygon")return d.polygon(p(m.coordinates));if(m.type==="MultiPolygon"){for(var e=d.segments({inverted:!1,regions:[]}),f=0;f<m.coordinates.length;f++)e=d.selectUnion(d.combine(e,p(m.coordinates[f])));return d.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(d,m,p){function e(g,h){return m.pointInsideRegion([.5*(g[0][0]+g[1][0]),.5*(g[0][1]+g[1][1])],h)}function f(g){return{region:g,children:[]}}p=d.polygon(d.segments(p));var u=f(null);function s(g,h){for(var y=0;y<g.children.length;y++)if(e(h,(_=g.children[y]).region))return void s(_,h);var v=f(h);for(y=0;y<g.children.length;y++){var _;e((_=g.children[y]).region,h)&&(v.children.push(_),g.children.splice(y,1),y--)}g.children.push(v)}for(var l=0;l<p.regions.length;l++){var o=p.regions[l];o.length<3||s(u,o)}function i(g,h){for(var y=0,v=g[g.length-1][0],_=g[g.length-1][1],x=[],T=0;T<g.length;T++){var A=g[T][0],S=g[T][1];x.push([A,S]),y+=S*v-A*_,v=A,_=S}return y<0!==h&&x.reverse(),x.push([x[0][0],x[0][1]]),x}var c=[];function n(g){var h=[i(g.region,!1)];c.push(h);for(var y=0;y<g.children.length;y++)h.push(a(g.children[y]))}function a(g){for(var h=0;h<g.children.length;h++)n(g.children[h]);return i(g.region,!0)}for(l=0;l<u.children.length;l++)n(u.children[l]);return c.length<=0?{type:"Polygon",coordinates:[]}:c.length==1?{type:"Polygon",coordinates:c[0]}:{type:"MultiPolygon",coordinates:c}}};O.exports=t},{}],494:[function(r,O,B){var t=r("./linked-list");O.exports=function(d,m,p){function e(i,c,n){return{id:p?p.segmentId():-1,start:i,end:c,myFill:{above:n.myFill.above,below:n.myFill.below},otherFill:null}}var f=t.create();function u(i,c){f.insertBefore(i,function(n){return function(a,g,h,y,v,_){var x=m.pointsCompare(g,v);return x!==0?x:m.pointsSame(h,_)?0:a!==y?a?1:-1:m.pointAboveOrOnLine(h,y?v:_,y?_:v)?1:-1}(i.isStart,i.pt,c,n.isStart,n.pt,n.other.pt)<0})}function s(i,c){var n=function(a,g){var h=t.node({isStart:!0,pt:a.start,seg:a,primary:g,other:null,status:null});return u(h,a.end),h}(i,c);return function(a,g,h){var y=t.node({isStart:!1,pt:g.end,seg:g,primary:h,other:a,status:null});a.other=y,u(y,a.pt)}(n,i,c),n}function l(i,c){var n=e(c,i.seg.end,i.seg);return function(a,g){p&&p.segmentChop(a.seg,g),a.other.remove(),a.seg.end=g,a.other.pt=g,u(a.other,a.pt)}(i,c),s(n,i.primary)}function o(i,c){var n=t.create();function a(k){return n.findTransition(function(L){var M,P,D,N,U,q;return M=k,P=L.ev,D=M.seg.start,N=M.seg.end,U=P.seg.start,q=P.seg.end,(m.pointsCollinear(D,U,q)?m.pointsCollinear(N,U,q)||m.pointAboveOrOnLine(N,U,q)?1:-1:m.pointAboveOrOnLine(D,U,q)?1:-1)>0})}function g(k,L){var M=k.seg,P=L.seg,D=M.start,N=M.end,U=P.start,q=P.end;p&&p.checkIntersection(M,P);var X=m.linesIntersect(D,N,U,q);if(X===!1){if(!m.pointsCollinear(D,N,U)||m.pointsSame(D,q)||m.pointsSame(N,U))return!1;var K=m.pointsSame(D,U),Z=m.pointsSame(N,q);if(K&&Z)return L;var H=!K&&m.pointBetween(D,U,q),Y=!Z&&m.pointBetween(N,U,q);if(K)return Y?l(L,N):l(k,q),L;H&&(Z||(Y?l(L,N):l(k,q)),l(L,D))}else X.alongA===0&&(X.alongB===-1?l(k,U):X.alongB===0?l(k,X.pt):X.alongB===1&&l(k,q)),X.alongB===0&&(X.alongA===-1?l(L,D):X.alongA===0?l(L,X.pt):X.alongA===1&&l(L,N));return!1}for(var h=[];!f.isEmpty();){var y=f.getHead();if(p&&p.vert(y.pt[0]),y.isStart){let k=function(){if(_){var L=g(y,_);if(L)return L}return!!x&&g(y,x)};p&&p.segmentNew(y.seg,y.primary);var v=a(y),_=v.before?v.before.ev:null,x=v.after?v.after.ev:null;p&&p.tempStatus(y.seg,!!_&&_.seg,!!x&&x.seg);var T,A=k();if(A){var S;d?(S=y.seg.myFill.below===null||y.seg.myFill.above!==y.seg.myFill.below)&&(A.seg.myFill.above=!A.seg.myFill.above):A.seg.otherFill=y.seg.myFill,p&&p.segmentUpdate(A.seg),y.other.remove(),y.remove()}if(f.getHead()!==y){p&&p.rewind(y.seg);continue}d?(S=y.seg.myFill.below===null||y.seg.myFill.above!==y.seg.myFill.below,y.seg.myFill.below=x?x.seg.myFill.above:i,y.seg.myFill.above=S?!y.seg.myFill.below:y.seg.myFill.below):y.seg.otherFill===null&&(T=x?y.primary===x.primary?x.seg.otherFill.above:x.seg.myFill.above:y.primary?c:i,y.seg.otherFill={above:T,below:T}),p&&p.status(y.seg,!!_&&_.seg,!!x&&x.seg),y.other.status=v.insert(t.node({ev:y}))}else{var w=y.status;if(w===null)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(n.exists(w.prev)&&n.exists(w.next)&&g(w.prev.ev,w.next.ev),p&&p.statusRemove(w.ev.seg),w.remove(),!y.primary){var C=y.seg.myFill;y.seg.myFill=y.seg.otherFill,y.seg.otherFill=C}h.push(y.seg)}f.getHead().remove()}return p&&p.done(),h}return d?{addRegion:function(i){for(var c,n,a,g=i[i.length-1],h=0;h<i.length;h++){c=g,g=i[h];var y=m.pointsCompare(c,g);y!==0&&s((n=y<0?c:g,a=y<0?g:c,{id:p?p.segmentId():-1,start:n,end:a,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(i){return o(i,!1)}}:{calculate:function(i,c,n,a){return i.forEach(function(g){s(e(g.start,g.end,g),!0)}),n.forEach(function(g){s(e(g.start,g.end,g),!1)}),o(c,a)}}}},{"./linked-list":495}],495:[function(r,O,B){O.exports={create:function(){var t={root:{root:!0,next:null},exists:function(d){return d!==null&&d!==t.root},isEmpty:function(){return t.root.next===null},getHead:function(){return t.root.next},insertBefore:function(d,m){for(var p=t.root,e=t.root.next;e!==null;){if(m(e))return d.prev=e.prev,d.next=e,e.prev.next=d,void(e.prev=d);p=e,e=e.next}p.next=d,d.prev=p,d.next=null},findTransition:function(d){for(var m=t.root,p=t.root.next;p!==null&&!d(p);)m=p,p=p.next;return{before:m===t.root?null:m,after:p,insert:function(e){return e.prev=m,e.next=p,m.next=e,p!==null&&(p.prev=e),e}}}};return t},node:function(t){return t.prev=null,t.next=null,t.remove=function(){t.prev.next=t.next,t.next&&(t.next.prev=t.prev),t.prev=null,t.next=null},t}}},{}],496:[function(r,O,B){O.exports=function(t,d,m){var p=[],e=[];return t.forEach(function(f){var u=f.start,s=f.end;if(d.pointsSame(u,s))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{m&&m.chainStart(f);for(var l={index:0,matches_head:!1,matches_pt1:!1},o={index:0,matches_head:!1,matches_pt1:!1},i=l,c=0;c<p.length;c++){var n=(v=p[c])[0],a=(v[1],v[v.length-1]);if(v[v.length-2],d.pointsSame(n,u)){if(k(c,!0,!0))break}else if(d.pointsSame(n,s)){if(k(c,!0,!1))break}else if(d.pointsSame(a,u)){if(k(c,!1,!0))break}else if(d.pointsSame(a,s)&&k(c,!1,!1))break}if(i===l)return p.push([u,s]),void(m&&m.chainNew(u,s));if(i===o){m&&m.chainMatch(l.index);var g=l.index,h=l.matches_pt1?s:u,y=l.matches_head,v=p[g],_=y?v[0]:v[v.length-1],x=y?v[1]:v[v.length-2],T=y?v[v.length-1]:v[0],A=y?v[v.length-2]:v[1];return d.pointsCollinear(x,_,h)&&(y?(m&&m.chainRemoveHead(l.index,h),v.shift()):(m&&m.chainRemoveTail(l.index,h),v.pop()),_=x),d.pointsSame(T,h)?(p.splice(g,1),d.pointsCollinear(A,T,_)&&(y?(m&&m.chainRemoveTail(l.index,_),v.pop()):(m&&m.chainRemoveHead(l.index,_),v.shift())),m&&m.chainClose(l.index),void e.push(v)):void(y?(m&&m.chainAddHead(l.index,h),v.unshift(h)):(m&&m.chainAddTail(l.index,h),v.push(h)))}var S=l.index,w=o.index;m&&m.chainConnect(S,w);var C=p[S].length<p[w].length;l.matches_head?o.matches_head?C?(L(S),M(S,w)):(L(w),M(w,S)):M(w,S):o.matches_head?M(S,w):C?(L(S),M(w,S)):(L(w),M(S,w))}function k(P,D,N){return i.index=P,i.matches_head=D,i.matches_pt1=N,i===l?(i=o,!1):(i=null,!0)}function L(P){m&&m.chainReverse(P),p[P].reverse()}function M(P,D){var N=p[P],U=p[D],q=N[N.length-1],X=N[N.length-2],K=U[0],Z=U[1];d.pointsCollinear(X,q,K)&&(m&&m.chainRemoveTail(P,q),N.pop(),q=X),d.pointsCollinear(q,K,Z)&&(m&&m.chainRemoveHead(D,K),U.shift()),m&&m.chainJoin(P,D),p[P]=N.concat(U),p.splice(D,1)}}),e}},{}],497:[function(r,O,B){function t(m,p,e){var f=[];return m.forEach(function(u){var s=(u.myFill.above?8:0)+(u.myFill.below?4:0)+(u.otherFill&&u.otherFill.above?2:0)+(u.otherFill&&u.otherFill.below?1:0);p[s]!==0&&f.push({id:e?e.segmentId():-1,start:u.start,end:u.end,myFill:{above:p[s]===1,below:p[s]===2},otherFill:null})}),e&&e.selected(f),f}var d={union:function(m,p){return t(m,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],p)},intersect:function(m,p){return t(m,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],p)},difference:function(m,p){return t(m,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],p)},differenceRev:function(m,p){return t(m,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],p)},xor:function(m,p){return t(m,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],p)}};O.exports=d},{}],498:[function(r,O,B){var t=new Float64Array(4),d=new Float64Array(4),m=new Float64Array(4);O.exports=function(p,e,f,u,s){t.length<u.length&&(t=new Float64Array(u.length),d=new Float64Array(u.length),m=new Float64Array(u.length));for(var l=0;l<u.length;++l)t[l]=p[l]-u[l],d[l]=e[l]-p[l],m[l]=f[l]-p[l];var o=0,i=0,c=0,n=0,a=0,g=0;for(l=0;l<u.length;++l){var h=d[l],y=m[l],v=t[l];o+=h*h,i+=h*y,c+=y*y,n+=v*h,a+=v*y,g+=v*v}var _,x,T,A,S,w=Math.abs(o*c-i*i),C=i*a-c*n,k=i*n-o*a;if(C+k<=w)if(C<0)k<0&&n<0?(k=0,-n>=o?(C=1,_=o+2*n+g):_=n*(C=-n/o)+g):(C=0,a>=0?(k=0,_=g):-a>=c?(k=1,_=c+2*a+g):_=a*(k=-a/c)+g);else if(k<0)k=0,n>=0?(C=0,_=g):-n>=o?(C=1,_=o+2*n+g):_=n*(C=-n/o)+g;else{var L=1/w;_=(C*=L)*(o*C+i*(k*=L)+2*n)+k*(i*C+c*k+2*a)+g}else C<0?(T=c+a)>(x=i+n)?(A=T-x)>=(S=o-2*i+c)?(C=1,k=0,_=o+2*n+g):_=(C=A/S)*(o*C+i*(k=1-C)+2*n)+k*(i*C+c*k+2*a)+g:(C=0,T<=0?(k=1,_=c+2*a+g):a>=0?(k=0,_=g):_=a*(k=-a/c)+g):k<0?(T=o+n)>(x=i+a)?(A=T-x)>=(S=o-2*i+c)?(k=1,C=0,_=c+2*a+g):_=(C=1-(k=A/S))*(o*C+i*k+2*n)+k*(i*C+c*k+2*a)+g:(k=0,T<=0?(C=1,_=o+2*n+g):n>=0?(C=0,_=g):_=n*(C=-n/o)+g):(A=c+a-i-n)<=0?(C=0,k=1,_=c+2*a+g):A>=(S=o-2*i+c)?(C=1,k=0,_=o+2*n+g):_=(C=A/S)*(o*C+i*(k=1-C)+2*n)+k*(i*C+c*k+2*a)+g;var M=1-C-k;for(l=0;l<u.length;++l)s[l]=M*p[l]+C*e[l]+k*f[l];return _<0?0:_}},{}],499:[function(r,O,B){var t=r("stream").Transform,d=r("stream-parser");function m(){t.call(this,{readableObjectMode:!0})}function p(e,f,u){Error.call(this),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=e,f&&(this.code=f),u&&(this.statusCode=u)}m.prototype=Object.create(t.prototype),m.prototype.constructor=m,d(m.prototype),B.ParserStream=m,B.sliceEq=function(e,f,u){for(var s=f,l=0;l<u.length;)if(e[s++]!==u[l++])return!1;return!0},B.str2arr=function(e,f){var u=[],s=0;if(f&&f==="hex")for(;s<e.length;)u.push(parseInt(e.slice(s,s+2),16)),s+=2;else for(;s<e.length;s++)u.push(255&e.charCodeAt(s));return u},B.readUInt16LE=function(e,f){return e[f]|e[f+1]<<8},B.readUInt16BE=function(e,f){return e[f+1]|e[f]<<8},B.readUInt32LE=function(e,f){return e[f]|e[f+1]<<8|e[f+2]<<16|16777216*e[f+3]},B.readUInt32BE=function(e,f){return e[f+3]|e[f+2]<<8|e[f+1]<<16|16777216*e[f]},p.prototype=Object.create(Error.prototype),p.prototype.constructor=p,B.ProbeError=p},{stream:554,"stream-parser":570}],500:[function(r,O,B){function t(p,e){var f=new Error(p);return f.code=e,f}function d(p){try{return decodeURIComponent(escape(p))}catch(e){return p}}function m(p,e,f){this.input=p.subarray(e,f),this.start=e;var u=String.fromCharCode.apply(null,this.input.subarray(0,4));if(u!=="II*\0"&&u!=="MM\0*")throw t("invalid TIFF signature","EBADDATA");this.big_endian=u[0]==="M"}m.prototype.each=function(p){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var f=this.ifds_to_read.shift();f.offset&&this.scan_ifd(f.id,f.offset,p)}},m.prototype.read_uint16=function(p){var e=this.input;if(p+2>e.length)throw t("unexpected EOF","EBADDATA");return this.big_endian?256*e[p]+e[p+1]:e[p]+256*e[p+1]},m.prototype.read_uint32=function(p){var e=this.input;if(p+4>e.length)throw t("unexpected EOF","EBADDATA");return this.big_endian?16777216*e[p]+65536*e[p+1]+256*e[p+2]+e[p+3]:e[p]+256*e[p+1]+65536*e[p+2]+16777216*e[p+3]},m.prototype.is_subifd_link=function(p,e){return p===0&&e===34665||p===0&&e===34853||p===34665&&e===40965},m.prototype.exif_format_length=function(p){switch(p){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},m.prototype.exif_format_read=function(p,e){var f;switch(p){case 1:case 2:return f=this.input[e];case 6:return(f=this.input[e])|33554430*(128&f);case 3:return f=this.read_uint16(e);case 8:return(f=this.read_uint16(e))|131070*(32768&f);case 4:return f=this.read_uint32(e);case 9:return 0|(f=this.read_uint32(e));case 5:case 10:case 11:case 12:case 7:default:return null}},m.prototype.scan_ifd=function(p,e,f){var u=this.read_uint16(e);e+=2;for(var s=0;s<u;s++){var l=this.read_uint16(e),o=this.read_uint16(e+2),i=this.read_uint32(e+4),c=this.exif_format_length(o),n=i*c,a=n<=4?e+8:this.read_uint32(e+8),g=!1;if(a+n>this.input.length)throw t("unexpected EOF","EBADDATA");for(var h=[],y=a,v=0;v<i;v++,y+=c){var _=this.exif_format_read(o,y);if(_===null){h=null;break}h.push(_)}if(Array.isArray(h)&&o===2&&(h=d(String.fromCharCode.apply(null,h)))&&h[h.length-1]==="\0"&&(h=h.slice(0,-1)),this.is_subifd_link(p,l)&&Array.isArray(h)&&Number.isInteger(h[0])&&h[0]>0&&(this.ifds_to_read.push({id:l,offset:h[0]}),g=!0),f({is_big_endian:this.big_endian,ifd:p,tag:l,format:o,count:i,entry_offset:e+this.start,data_length:n,data_offset:a+this.start,value:h,is_subifd_link:g})===!1)return void(this.aborted=!0);e+=12}p===0&&this.ifds_to_read.push({id:1,offset:this.read_uint32(e)})},O.exports.ExifParser=m,O.exports.get_orientation=function(p){var e=0;try{return new m(p,0,p.length).each(function(f){if(f.ifd===0&&f.tag===274&&Array.isArray(f.value))return e=f.value[0],!1}),e}catch(f){return-1}}},{}],501:[function(r,O,B){var t=r("./common").readUInt16BE,d=r("./common").readUInt32BE;function m(l,o){if(l.length<4+o)return null;var i=d(l,o);return l.length<i+o||i<8?null:{boxtype:String.fromCharCode.apply(null,l.slice(o+4,o+8)),data:l.slice(o+8,o+i),end:o+i}}function p(l,o){for(var i=0;;){var c=m(l,i);if(!c)break;switch(c.boxtype){case"ispe":o.sizes.push({width:d(c.data,4),height:d(c.data,8)});break;case"irot":o.transforms.push({type:"irot",value:3&c.data[0]});break;case"imir":o.transforms.push({type:"imir",value:1&c.data[0]})}i=c.end}}function e(l,o,i){for(var c=0,n=0;n<i;n++)c=256*c+(l[o+n]||0);return c}function f(l,o){for(var i=l[4]>>4&15,c=15&l[4],n=l[5]>>4&15,a=t(l,6),g=8,h=0;h<a;h++){var y=t(l,g),v=t(l,g+=2),_=e(l,g+=2,n),x=t(l,g+=n);if(g+=2,v===0&&x===1){var T=e(l,g,i),A=e(l,g+i,c);o.item_loc[y]={length:A,offset:T+_}}g+=x*(i+c)}}function u(l,o){for(var i=t(l,4),c=6,n=0;n<i;n++){var a=m(l,c);if(!a)break;if(a.boxtype==="infe"){for(var g=t(a.data,4),h="",y=8;y<a.data.length&&a.data[y];y++)h+=String.fromCharCode(a.data[y]);o.item_inf[h]=g}c=a.end}}function s(l,o){for(var i=0;;){var c=m(l,i);if(!c)break;c.boxtype==="ipco"&&p(c.data,o),i=c.end}}O.exports.unbox=m,O.exports.readSizeFromMeta=function(l){var o={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(function(y,v){for(var _=4;;){var x=m(y,_);if(!x)break;x.boxtype==="iprp"&&s(x.data,v),x.boxtype==="iloc"&&f(x.data,v),x.boxtype==="iinf"&&u(x.data,v),_=x.end}}(l,o),o.sizes.length){var i,c,n,a=(i=o.sizes,c=i.reduce(function(y,v){return y.width>v.width||y.width===v.width&&y.height>v.height?y:v}),n=i.reduce(function(y,v){return y.height>v.height||y.height===v.height&&y.width>v.width?y:v}),c.width>n.height||c.width===n.height&&c.height>n.width?c:n),g=1;o.transforms.forEach(function(y){var v={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},_={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if(y.type==="imir"&&(g=y.value===0?_[g]:v[g=v[g=_[g]]]),y.type==="irot")for(var x=0;x<y.value;x++)g=v[g]});var h=null;return o.item_inf.Exif&&(h=o.item_loc[o.item_inf.Exif]),{width:a.width,height:a.height,orientation:o.transforms.length?g:null,variants:o.sizes,exif_location:h}}},O.exports.getMimeType=function(l){var o=String.fromCharCode.apply(null,l.slice(0,4)),i={};i[o]=!0;for(var c=8;c<l.length;c+=4)i[String.fromCharCode.apply(null,l.slice(c,c+4))]=!0;if(i.mif1||i.msf1||i.miaf)return o==="avif"||o==="avis"||o==="avio"?{type:"avif",mime:"image/avif"}:o==="heic"||o==="heix"?{type:"heic",mime:"image/heic"}:o==="hevc"||o==="hevx"?{type:"heic",mime:"image/heic-sequence"}:i.avif||i.avis?{type:"avif",mime:"image/avif"}:i.heic||i.heix||i.hevc||i.hevx||i.heis?i.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":499}],502:[function(r,O,B){var t=r("../common").str2arr,d=r("../common").sliceEq,m=r("../common").readUInt32BE,p=r("../miaf_utils"),e=r("../exif_utils"),f=t("ftyp");O.exports=function(u){if(d(u,4,f)){var s=p.unbox(u,0);if(s){var l=p.getMimeType(s.data);if(l){for(var o,i=s.end;;){var c=p.unbox(u,i);if(!c)break;if(i=c.end,c.boxtype==="mdat")return;if(c.boxtype==="meta"){o=c.data;break}}if(o){var n=p.readSizeFromMeta(o);if(n){var a={width:n.width,height:n.height,type:l.type,mime:l.mime,wUnits:"px",hUnits:"px"};if(n.variants.length>1&&(a.variants=n.variants),n.orientation&&(a.orientation=n.orientation),n.exif_location&&n.exif_location.offset+n.exif_location.length<=u.length){var g=m(u,n.exif_location.offset),h=u.slice(n.exif_location.offset+g+4,n.exif_location.offset+n.exif_location.length),y=e.get_orientation(h);y>0&&(a.orientation=y)}return a}}}}}}},{"../common":499,"../exif_utils":500,"../miaf_utils":501}],503:[function(r,O,B){var t=r("../common").str2arr,d=r("../common").sliceEq,m=r("../common").readUInt16LE,p=t("BM");O.exports=function(e){if(!(e.length<26)&&d(e,0,p))return{width:m(e,18),height:m(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":499}],504:[function(r,O,B){var t=r("../common").str2arr,d=r("../common").sliceEq,m=r("../common").readUInt16LE,p=t("GIF87a"),e=t("GIF89a");O.exports=function(f){if(!(f.length<10)&&(d(f,0,p)||d(f,0,e)))return{width:m(f,6),height:m(f,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":499}],505:[function(r,O,B){var t=r("../common").readUInt16LE;O.exports=function(d){var m=t(d,0),p=t(d,2),e=t(d,4);if(m===0&&p===1&&e){for(var f=[],u={width:0,height:0},s=0;s<e;s++){var l=d[6+16*s]||256,o=d[6+16*s+1]||256,i={width:l,height:o};f.push(i),(l>u.width||o>u.height)&&(u=i)}return{width:u.width,height:u.height,variants:f,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":499}],506:[function(r,O,B){var t=r("../common").readUInt16BE,d=r("../common").str2arr,m=r("../common").sliceEq,p=r("../exif_utils"),e=d("Exif\0\0");O.exports=function(f){if(!(f.length<2)&&f[0]===255&&f[1]===216)for(var u=2;;){if(f.length-u<2||f[u++]!==255)return;for(var s,l,o=f[u++];o===255;)o=f[u++];if(208<=o&&o<=217||o===1)s=0;else{if(!(192<=o&&o<=254)||f.length-u<2)return;s=t(f,u)-2,u+=2}if(o===217||o===218)return;if(o===225&&s>=10&&m(f,u,e)&&(l=p.get_orientation(f.slice(u+6,u+s))),s>=5&&192<=o&&o<=207&&o!==196&&o!==200&&o!==204){if(f.length-u<s)return;var i={width:t(f,u+3),height:t(f,u+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return l>0&&(i.orientation=l),i}u+=s}}},{"../common":499,"../exif_utils":500}],507:[function(r,O,B){var t=r("../common").str2arr,d=r("../common").sliceEq,m=r("../common").readUInt32BE,p=t(`\x89PNG\r

`),e=t("IHDR");O.exports=function(f){if(!(f.length<24)&&d(f,0,p)&&d(f,12,e))return{width:m(f,16),height:m(f,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":499}],508:[function(r,O,B){var t=r("../common").str2arr,d=r("../common").sliceEq,m=r("../common").readUInt32BE,p=t("8BPS\0");O.exports=function(e){if(!(e.length<22)&&d(e,0,p))return{width:m(e,18),height:m(e,14),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":499}],509:[function(r,O,B){function t(l){return typeof l=="number"&&isFinite(l)&&l>0}var d=/<[-_.:a-zA-Z0-9][^>]*>/,m=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,p=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,e=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,f=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,u=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function s(l){return u.test(l)?l.match(u)[0]:"px"}O.exports=function(l){if(function(T){var A,S=0,w=T.length;for(T[0]===239&&T[1]===187&&T[2]===191&&(S=3);S<w&&((A=T[S])===32||A===9||A===13||A===10);)S++;return S!==w&&T[S]===60}(l)){for(var o="",i=0;i<l.length;i++)o+=String.fromCharCode(l[i]);var c=(o.match(d)||[""])[0];if(m.test(c)){var n=function(T){var A=T.match(p),S=T.match(e),w=T.match(f);return{width:A&&(A[1]||A[2]),height:S&&(S[1]||S[2]),viewbox:w&&(w[1]||w[2])}}(c),a=parseFloat(n.width),g=parseFloat(n.height);if(n.width&&n.height)return!t(a)||!t(g)?void 0:{width:a,height:g,type:"svg",mime:"image/svg+xml",wUnits:s(n.width),hUnits:s(n.height)};var h=(n.viewbox||"").split(" "),y={width:h[2],height:h[3]},v=parseFloat(y.width),_=parseFloat(y.height);if(t(v)&&t(_)&&s(y.width)===s(y.height)){var x=v/_;return n.width?t(a)?{width:a,height:a/x,type:"svg",mime:"image/svg+xml",wUnits:s(n.width),hUnits:s(n.width)}:void 0:n.height?t(g)?{width:g*x,height:g,type:"svg",mime:"image/svg+xml",wUnits:s(n.height),hUnits:s(n.height)}:void 0:{width:v,height:_,type:"svg",mime:"image/svg+xml",wUnits:s(y.width),hUnits:s(y.height)}}}}}},{}],510:[function(r,O,B){var t=r("../common").str2arr,d=r("../common").sliceEq,m=r("../common").readUInt16LE,p=r("../common").readUInt16BE,e=r("../common").readUInt32LE,f=r("../common").readUInt32BE,u=t("II*\0"),s=t("MM\0*");function l(c,n,a){return a?p(c,n):m(c,n)}function o(c,n,a){return a?f(c,n):e(c,n)}function i(c,n,a){var g=l(c,n+2,a);return o(c,n+4,a)!==1||g!==3&&g!==4?null:g===3?l(c,n+8,a):o(c,n+8,a)}O.exports=function(c){if(!(c.length<8)&&(d(c,0,u)||d(c,0,s))){var n=c[0]===77,a=o(c,4,n)-8;if(!(a<0)){var g=a+8;if(!(c.length-g<2)){var h=12*l(c,g+0,n);if(!(h<=0||(g+=2,c.length-g<h))){var y,v,_,x;for(y=0;y<h;y+=12)(x=l(c,g+y,n))===256?v=i(c,g+y,n):x===257&&(_=i(c,g+y,n));return v&&_?{width:v,height:_,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}:void 0}}}}}},{"../common":499}],511:[function(r,O,B){var t=r("../common").str2arr,d=r("../common").sliceEq,m=r("../common").readUInt16LE,p=r("../common").readUInt32LE,e=r("../exif_utils"),f=t("RIFF"),u=t("WEBP");function s(i,c){if(i[c+3]===157&&i[c+4]===1&&i[c+5]===42)return{width:16383&m(i,c+6),height:16383&m(i,c+8),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function l(i,c){if(i[c]===47){var n=p(i,c+1);return{width:1+(16383&n),height:1+(n>>14&16383),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function o(i,c){return{width:1+(i[c+6]<<16|i[c+5]<<8|i[c+4]),height:1+(i[c+9]<<c|i[c+8]<<8|i[c+7]),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}O.exports=function(i){if(!(i.length<16)&&(d(i,0,f)||d(i,8,u))){var c=12,n=null,a=0,g=p(i,4)+8;if(!(g>i.length)){for(;c+8<g;)if(i[c]!==0){var h=String.fromCharCode.apply(null,i.slice(c,c+4)),y=p(i,c+4);h==="VP8 "&&y>=10?n=n||s(i,c+8):h==="VP8L"&&y>=9?n=n||l(i,c+8):h==="VP8X"&&y>=10?n=n||o(i,c+8):h==="EXIF"&&(a=e.get_orientation(i.slice(c+8,c+8+y)),c=1/0),c+=8+y}else c++;if(n)return a>0&&(n.orientation=a),n}}}},{"../common":499,"../exif_utils":500}],512:[function(r,O,B){O.exports={avif:r("./parse_sync/avif"),bmp:r("./parse_sync/bmp"),gif:r("./parse_sync/gif"),ico:r("./parse_sync/ico"),jpeg:r("./parse_sync/jpeg"),png:r("./parse_sync/png"),psd:r("./parse_sync/psd"),svg:r("./parse_sync/svg"),tiff:r("./parse_sync/tiff"),webp:r("./parse_sync/webp")}},{"./parse_sync/avif":502,"./parse_sync/bmp":503,"./parse_sync/gif":504,"./parse_sync/ico":505,"./parse_sync/jpeg":506,"./parse_sync/png":507,"./parse_sync/psd":508,"./parse_sync/svg":509,"./parse_sync/tiff":510,"./parse_sync/webp":511}],513:[function(r,O,B){var t=r("./lib/parsers_sync");O.exports=function(d){return function(m){for(var p=Object.keys(t),e=0;e<p.length;e++){var f=t[p[e]](m);if(f)return f}return null}(d)},O.exports.parsers=t},{"./lib/parsers_sync":512}],514:[function(r,O,B){var t,d,m=O.exports={};function p(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function f(g){if(t===setTimeout)return setTimeout(g,0);if((t===p||!t)&&setTimeout)return t=setTimeout,setTimeout(g,0);try{return t(g,0)}catch(h){try{return t.call(null,g,0)}catch(y){return t.call(this,g,0)}}}(function(){try{t=typeof setTimeout=="function"?setTimeout:p}catch(g){t=p}try{d=typeof clearTimeout=="function"?clearTimeout:e}catch(g){d=e}})();var u,s=[],l=!1,o=-1;function i(){l&&u&&(l=!1,u.length?s=u.concat(s):o=-1,s.length&&c())}function c(){if(!l){var g=f(i);l=!0;for(var h=s.length;h;){for(u=s,s=[];++o<h;)u&&u[o].run();o=-1,h=s.length}u=null,l=!1,function(y){if(d===clearTimeout)return clearTimeout(y);if((d===e||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(y);try{d(y)}catch(v){try{return d.call(null,y)}catch(_){return d.call(this,y)}}}(g)}}function n(g,h){this.fun=g,this.array=h}function a(){}m.nextTick=function(g){var h=new Array(arguments.length-1);if(arguments.length>1)for(var y=1;y<arguments.length;y++)h[y-1]=arguments[y];s.push(new n(g,h)),s.length!==1||l||f(c)},n.prototype.run=function(){this.fun.apply(null,this.array)},m.title="browser",m.browser=!0,m.env={},m.argv=[],m.version="",m.versions={},m.on=a,m.addListener=a,m.once=a,m.off=a,m.removeListener=a,m.removeAllListeners=a,m.emit=a,m.prependListener=a,m.prependOnceListener=a,m.listeners=function(g){return[]},m.binding=function(g){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(g){throw new Error("process.chdir is not supported")},m.umask=function(){return 0}},{}],515:[function(r,O,B){O.exports=r("gl-quat/slerp")},{"gl-quat/slerp":322}],516:[function(r,O,B){(function(t){(function(){for(var d=r("performance-now"),m=typeof window=="undefined"?t:window,p=["moz","webkit"],e="AnimationFrame",f=m["request"+e],u=m["cancel"+e]||m["cancelRequest"+e],s=0;!f&&s<p.length;s++)f=m[p[s]+"Request"+e],u=m[p[s]+"Cancel"+e]||m[p[s]+"CancelRequest"+e];if(!f||!u){var l=0,o=0,i=[];f=function(c){if(i.length===0){var n=d(),a=Math.max(0,1e3/60-(n-l));l=a+n,setTimeout(function(){var g=i.slice(0);i.length=0;for(var h=0;h<g.length;h++)if(!g[h].cancelled)try{g[h].callback(l)}catch(y){setTimeout(function(){throw y},0)}},Math.round(a))}return i.push({handle:++o,callback:c,cancelled:!1}),o},u=function(c){for(var n=0;n<i.length;n++)i[n].handle===c&&(i[n].cancelled=!0)}}O.exports=function(c){return f.call(m,c)},O.exports.cancel=function(){u.apply(m,arguments)},O.exports.polyfill=function(c){c||(c=m),c.requestAnimationFrame=f,c.cancelAnimationFrame=u}}).call(this)}).call(this,typeof Xi!="undefined"?Xi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"performance-now":484}],517:[function(r,O,B){var t=r("big-rat/add");O.exports=function(d,m){for(var p=d.length,e=new Array(p),f=0;f<p;++f)e[f]=t(d[f],m[f]);return e}},{"big-rat/add":87}],518:[function(r,O,B){O.exports=function(d){for(var m=new Array(d.length),p=0;p<d.length;++p)m[p]=t(d[p]);return m};var t=r("big-rat")},{"big-rat":90}],519:[function(r,O,B){var t=r("big-rat"),d=r("big-rat/mul");O.exports=function(m,p){for(var e=t(p),f=m.length,u=new Array(f),s=0;s<f;++s)u[s]=d(m[s],e);return u}},{"big-rat":90,"big-rat/mul":99}],520:[function(r,O,B){var t=r("big-rat/sub");O.exports=function(d,m){for(var p=d.length,e=new Array(p),f=0;f<p;++f)e[f]=t(d[f],m[f]);return e}},{"big-rat/sub":101}],521:[function(r,O,B){var t=r("compare-cell"),d=r("compare-oriented-cell"),m=r("cell-orientation");O.exports=function(p){p.sort(d);for(var e=p.length,f=0,u=0;u<e;++u){var s=p[u],l=m(s);if(l!==0){if(f>0){var o=p[f-1];if(t(s,o)===0&&m(o)!==l){f-=1;continue}}p[f++]=s}}return p.length=f,p}},{"cell-orientation":123,"compare-cell":139,"compare-oriented-cell":140}],522:[function(r,O,B){var t=r("array-bounds"),d=r("color-normalize"),m=r("update-diff"),p=r("pick-by-alias"),e=r("object-assign"),f=r("flatten-vertex-data"),u=r("to-float32"),s=u.float32,l=u.fract32;O.exports=function(i,c){if(typeof i=="function"?(c||(c={}),c.regl=i):c=i,c.length&&(c.positions=c),!(i=c.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var n,a,g,h,y,v,_=i._gl,x={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},T=[];return h=i.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),a=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),g=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),y=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),v=i.buffer({usage:"static",type:"float",data:o}),C(c),n=i({vert:`
		precision highp float;

		attribute vec2 position, positionFract;
		attribute vec4 error;
		attribute vec4 color;

		attribute vec2 direction, lineOffset, capOffset;

		uniform vec4 viewport;
		uniform float lineWidth, capSize;
		uniform vec2 scale, scaleFract, translate, translateFract;

		varying vec4 fragColor;

		void main() {
			fragColor = color / 255.;

			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;

			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;

			vec2 position = position + dxy;

			vec2 pos = (position + translate) * scale
				+ (positionFract + translateFract) * scale
				+ (position + translate) * scaleFract
				+ (positionFract + translateFract) * scaleFract;

			pos += pixelOffset / viewport.zw;

			gl_Position = vec4(pos * 2. - 1., 0, 1);
		}
		`,frag:`
		precision highp float;

		varying vec4 fragColor;

		uniform float opacity;

		void main() {
			gl_FragColor = fragColor;
			gl_FragColor.a *= opacity;
		}
		`,uniforms:{range:i.prop("range"),lineWidth:i.prop("lineWidth"),capSize:i.prop("capSize"),opacity:i.prop("opacity"),scale:i.prop("scale"),translate:i.prop("translate"),scaleFract:i.prop("scaleFract"),translateFract:i.prop("translateFract"),viewport:function(L,M){return[M.viewport.x,M.viewport.y,L.viewportWidth,L.viewportHeight]}},attributes:{color:{buffer:h,offset:function(L,M){return 4*M.offset},divisor:1},position:{buffer:a,offset:function(L,M){return 8*M.offset},divisor:1},positionFract:{buffer:g,offset:function(L,M){return 8*M.offset},divisor:1},error:{buffer:y,offset:function(L,M){return 16*M.offset},divisor:1},direction:{buffer:v,stride:24,offset:0},lineOffset:{buffer:v,stride:24,offset:8},capOffset:{buffer:v,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:i.prop("viewport")},viewport:i.prop("viewport"),stencil:!1,instances:i.prop("count"),count:o.length}),e(A,{update:C,draw:S,destroy:k,regl:i,gl:_,canvas:_.canvas,groups:T}),A;function A(L){L?C(L):L===null&&k(),S()}function S(L){if(typeof L=="number")return w(L);L&&!Array.isArray(L)&&(L=[L]),i._refresh(),T.forEach(function(M,P){M&&(L&&(L[P]?M.draw=!0:M.draw=!1),M.draw?w(P):M.draw=!0)})}function w(L){typeof L=="number"&&(L=T[L]),L!=null&&L&&L.count&&L.color&&L.opacity&&L.positions&&L.positions.length>1&&(L.scaleRatio=[L.scale[0]*L.viewport.width,L.scale[1]*L.viewport.height],n(L),L.after&&L.after(L))}function C(L){if(L){L.length!=null?typeof L[0]=="number"&&(L=[{positions:L}]):Array.isArray(L)||(L=[L]);var M=0,P=0;if(A.groups=T=L.map(function(Z,H){var Y=T[H];return Z&&(typeof Z=="function"?Z={after:Z}:typeof Z[0]=="number"&&(Z={positions:Z}),Z=p(Z,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),Y||(T[H]=Y={id:H,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},Z=e({},x,Z)),m(Y,Z,[{lineWidth:function($){return .5*+$},capSize:function($){return .5*+$},opacity:parseFloat,errors:function($){return $=f($),P+=$.length,$},positions:function($,z){return $=f($,"float64"),z.count=Math.floor($.length/2),z.bounds=t($,2),z.offset=M,M+=z.count,$}},{color:function($,z){var j=z.count;if($||($="transparent"),!Array.isArray($)||typeof $[0]=="number"){var W=$;$=Array(j);for(var ee=0;ee<j;ee++)$[ee]=W}if($.length<j)throw Error("Not enough colors");for(var J=new Uint8Array(4*j),Q=0;Q<j;Q++){var te=d($[Q],"uint8");J.set(te,4*Q)}return J},range:function($,z,j){var W=z.bounds;return $||($=W),z.scale=[1/($[2]-$[0]),1/($[3]-$[1])],z.translate=[-$[0],-$[1]],z.scaleFract=l(z.scale),z.translateFract=l(z.translate),$},viewport:function($){var z;return Array.isArray($)?z={x:$[0],y:$[1],width:$[2]-$[0],height:$[3]-$[1]}:$?(z={x:$.x||$.left||0,y:$.y||$.top||0},$.right?z.width=$.right-z.x:z.width=$.w||$.width||0,$.bottom?z.height=$.bottom-z.y:z.height=$.h||$.height||0):z={x:0,y:0,width:_.drawingBufferWidth,height:_.drawingBufferHeight},z}}])),Y}),M||P){var D=T.reduce(function(Z,H,Y){return Z+(H?H.count:0)},0),N=new Float64Array(2*D),U=new Uint8Array(4*D),q=new Float32Array(4*D);T.forEach(function(Z,H){if(Z){var Y=Z.positions,$=Z.count,z=Z.offset,j=Z.color,W=Z.errors;$&&(U.set(j,4*z),q.set(W,4*z),N.set(Y,2*z))}});var X=s(N);a(X);var K=l(N,X);g(K),h(U),y(q)}}}function k(){a.destroy(),g.destroy(),h.destroy(),y.destroy(),v.destroy()}};var o=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":76,"color-normalize":131,"flatten-vertex-data":248,"object-assign":476,"pick-by-alias":485,"to-float32":584,"update-diff":605}],523:[function(r,O,B){var t=r("color-normalize"),d=r("array-bounds"),m=r("object-assign"),p=r("glslify"),e=r("pick-by-alias"),f=r("flatten-vertex-data"),u=r("earcut"),s=r("array-normalize"),l=r("to-float32"),o=l.float32,i=l.fract32,c=r("es6-weak-map"),n=r("parse-rect"),a=r("array-find-index");function g(h,y){if(!(this instanceof g))return new g(h,y);if(typeof h=="function"?(y||(y={}),y.regl=h):y=h,y.length&&(y.positions=y),!(h=y.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=h._gl,this.regl=h,this.passes=[],this.shaders=g.shaders.has(h)?g.shaders.get(h):g.shaders.set(h,g.createShaders(h)).get(h),this.update(y)}O.exports=g,g.dashMult=2,g.maxPatternLength=256,g.precisionThreshold=3e6,g.maxPoints=1e4,g.maxLines=2048,g.shaders=new c,g.createShaders=function(h){var y,v=h.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),_={primitive:"triangle strip",instances:h.prop("count"),count:4,offset:0,uniforms:{miterMode:function(T,A){return A.join==="round"?2:1},miterLimit:h.prop("miterLimit"),scale:h.prop("scale"),scaleFract:h.prop("scaleFract"),translateFract:h.prop("translateFract"),translate:h.prop("translate"),thickness:h.prop("thickness"),dashTexture:h.prop("dashTexture"),opacity:h.prop("opacity"),pixelRatio:h.context("pixelRatio"),id:h.prop("id"),dashLength:h.prop("dashLength"),viewport:function(T,A){return[A.viewport.x,A.viewport.y,T.viewportWidth,T.viewportHeight]},depth:h.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(T,A){return!A.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:h.prop("viewport")},viewport:h.prop("viewport")},x=h(m({vert:p([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;
attribute vec4 color;
attribute float lineEnd, lineTop;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;

varying vec4 fragColor;
varying vec2 tangent;

vec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {
	// the order is important
	return position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;
}

void main() {
	float lineStart = 1. - lineEnd;
	float lineOffset = lineTop * 2. - 1.;

	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);
	tangent = normalize(diff * scale * viewport.zw);
	vec2 normal = vec2(-tangent.y, tangent.x);

	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart
		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd

		+ thickness * normal * .5 * lineOffset / viewport.zw;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
}
`]),frag:p([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;

void main() {
	float alpha = 1.;

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:v,divisor:0,stride:8,offset:0},lineTop:{buffer:v,divisor:0,stride:8,offset:4},aCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:h.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:h.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:h.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},_));try{y=h(m({cull:{enable:!0,face:"back"},vert:p([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, nextCoord, prevCoord;
attribute vec4 aColor, bColor;
attribute float lineEnd, lineTop;

uniform vec2 scale, translate;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;
uniform float miterLimit, miterMode;

varying vec4 fragColor;
varying vec4 startCutoff, endCutoff;
varying vec2 tangent;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

const float REVERSE_THRESHOLD = -.875;
const float MIN_DIFF = 1e-6;

// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead
// TODO: precalculate dot products, normalize things beforehead etc.
// TODO: refactor to rectangular algorithm

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

bool isNaN( float val ){
  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}

void main() {
	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;

  vec2 adjustedScale;
  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;
  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;

  vec2 scaleRatio = adjustedScale * viewport.zw;
	vec2 normalWidth = thickness / scaleRatio;

	float lineStart = 1. - lineEnd;
	float lineBot = 1. - lineTop;

	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;

	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;

	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);
	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);

	vec2 prevDiff = aCoord - prevCoord;
	vec2 currDiff = bCoord - aCoord;
	vec2 nextDiff = nextCoord - bCoord;

	vec2 prevTangent = normalize(prevDiff * scaleRatio);
	vec2 currTangent = normalize(currDiff * scaleRatio);
	vec2 nextTangent = normalize(nextDiff * scaleRatio);

	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);
	vec2 currNormal = vec2(-currTangent.y, currTangent.x);
	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);

	vec2 startJoinDirection = normalize(prevTangent - currTangent);
	vec2 endJoinDirection = normalize(currTangent - nextTangent);

	// collapsed/unidirectional segment cases
	// FIXME: there should be more elegant solution
	vec2 prevTanDiff = abs(prevTangent - currTangent);
	vec2 nextTanDiff = abs(nextTangent - currTangent);
	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {
		startJoinDirection = currNormal;
	}
	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {
		endJoinDirection = currNormal;
	}
	if (aCoord == bCoord) {
		endJoinDirection = startJoinDirection;
		currNormal = prevNormal;
		currTangent = prevTangent;
	}

	tangent = currTangent;

	//calculate join shifts relative to normals
	float startJoinShift = dot(currNormal, startJoinDirection);
	float endJoinShift = dot(currNormal, endJoinDirection);

	float startMiterRatio = abs(1. / startJoinShift);
	float endMiterRatio = abs(1. / endJoinShift);

	vec2 startJoin = startJoinDirection * startMiterRatio;
	vec2 endJoin = endJoinDirection * endMiterRatio;

	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;
	startTopJoin = sign(startJoinShift) * startJoin * .5;
	startBotJoin = -startTopJoin;

	endTopJoin = sign(endJoinShift) * endJoin * .5;
	endBotJoin = -endTopJoin;

	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;
	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;
	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;
	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;

	//miter anti-clipping
	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));
	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));

	//prevent close to reverse direction switch
	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);
	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);

	if (prevReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);
		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {
		//handle miter clipping
		bTopCoord -= normalWidth * endTopJoin;
		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;
	}

	if (nextReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);
		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {
		//handle miter clipping
		aBotCoord -= normalWidth * startBotJoin;
		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;
	}

	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;
	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;

	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;
	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;

	//position is normalized 0..1 coord on the screen
	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;

	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;
	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;

	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);

	enableStartMiter = step(dot(currTangent, prevTangent), .5);
	enableEndMiter = step(dot(currTangent, nextTangent), .5);

	//bevel miter cutoffs
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}

	//round miter cutoffs
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}
}
`]),frag:p([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;
varying vec4 startCutoff, endCutoff;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

void main() {
	float alpha = 1., distToStart, distToEnd;
	float cutoff = thickness * .5;

	//bevel miter
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToStart + 1., 0.), 1.);
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToEnd + 1., 0.), 1.);
		}
	}

	// round miter
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < 0.) {
				float radius = length(gl_FragCoord.xy - startCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < 0.) {
				float radius = length(gl_FragCoord.xy - endCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}
	}

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:v,divisor:0,stride:8,offset:0},lineTop:{buffer:v,divisor:0,stride:8,offset:4},aColor:{buffer:h.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:h.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},_))}catch(T){y=x}return{fill:h({primitive:"triangle",elements:function(T,A){return A.triangles},offset:0,vert:p([`precision highp float;
#define GLSLIFY 1

attribute vec2 position, positionFract;

uniform vec4 color;
uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio, id;
uniform vec4 viewport;
uniform float opacity;

varying vec4 fragColor;

const float MAX_LINES = 256.;

void main() {
	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);

	vec2 position = position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
	fragColor.a *= opacity;
}
`]),frag:p([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
	gl_FragColor = fragColor;
}
`]),uniforms:{scale:h.prop("scale"),color:h.prop("fill"),scaleFract:h.prop("scaleFract"),translateFract:h.prop("translateFract"),translate:h.prop("translate"),opacity:h.prop("opacity"),pixelRatio:h.context("pixelRatio"),id:h.prop("id"),viewport:function(T,A){return[A.viewport.x,A.viewport.y,T.viewportWidth,T.viewportHeight]}},attributes:{position:{buffer:h.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:h.prop("positionFractBuffer"),stride:8,offset:8}},blend:_.blend,depth:{enable:!1},scissor:_.scissor,stencil:_.stencil,viewport:_.viewport}),rect:x,miter:y}},g.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},g.prototype.render=function(){for(var h,y=[],v=arguments.length;v--;)y[v]=arguments[v];y.length&&(h=this).update.apply(h,y),this.draw()},g.prototype.draw=function(){for(var h=this,y=[],v=arguments.length;v--;)y[v]=arguments[v];return(y.length?y:this.passes).forEach(function(_,x){var T;if(_&&Array.isArray(_))return(T=h).draw.apply(T,_);typeof _=="number"&&(_=h.passes[_]),_&&_.count>1&&_.opacity&&(h.regl._refresh(),_.fill&&_.triangles&&_.triangles.length>2&&h.shaders.fill(_),_.thickness&&(_.scale[0]*_.viewport.width>g.precisionThreshold||_.scale[1]*_.viewport.height>g.precisionThreshold||_.join==="rect"||!_.join&&(_.thickness<=2||_.count>=g.maxPoints)?h.shaders.rect(_):h.shaders.miter(_)))}),this},g.prototype.update=function(h){var y=this;if(h){h.length!=null?typeof h[0]=="number"&&(h=[{positions:h}]):Array.isArray(h)||(h=[h]);var v=this.regl,_=this.gl;if(h.forEach(function(w,C){var k=y.passes[C];if(w!==void 0)if(w!==null){if(typeof w[0]=="number"&&(w={positions:w}),w=e(w,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),k||(y.passes[C]=k={id:C,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:v.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:v.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:v.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:v.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},w=m({},g.defaults,w)),w.thickness!=null&&(k.thickness=parseFloat(w.thickness)),w.opacity!=null&&(k.opacity=parseFloat(w.opacity)),w.miterLimit!=null&&(k.miterLimit=parseFloat(w.miterLimit)),w.overlay!=null&&(k.overlay=!!w.overlay,C<g.maxLines&&(k.depth=2*(g.maxLines-1-C%g.maxLines)/g.maxLines-1)),w.join!=null&&(k.join=w.join),w.hole!=null&&(k.hole=w.hole),w.fill!=null&&(k.fill=w.fill?t(w.fill,"uint8"):null),w.viewport!=null&&(k.viewport=n(w.viewport)),k.viewport||(k.viewport=n([_.drawingBufferWidth,_.drawingBufferHeight])),w.close!=null&&(k.close=w.close),w.positions===null&&(w.positions=[]),w.positions){var L,M;if(w.positions.x&&w.positions.y){var P=w.positions.x,D=w.positions.y;M=k.count=Math.max(P.length,D.length),L=new Float64Array(2*M);for(var N=0;N<M;N++)L[2*N]=P[N],L[2*N+1]=D[N]}else L=f(w.positions,"float64"),M=k.count=Math.floor(L.length/2);var U=k.bounds=d(L,2);if(k.fill){for(var q=[],X={},K=0,Z=0,H=0,Y=k.count;Z<Y;Z++){var $=L[2*Z],z=L[2*Z+1];isNaN($)||isNaN(z)||$==null||z==null?($=L[2*K],z=L[2*K+1],X[Z]=K):K=Z,q[H++]=$,q[H++]=z}if(w.splitNull){k.count-1 in X||(X[k.count]=k.count-1);var j=Object.keys(X).map(Number).sort(function(_t,er){return _t-er}),W=[],ee=0,J=k.hole!=null?k.hole[0]:null;if(J!=null){var Q=a(j,function(_t){return _t>=J});(j=j.slice(0,Q)).push(J)}for(var te=function(_t){var er=q.slice(2*ee,2*j[_t]).concat(J?q.slice(2*J):[]),tr=(k.hole||[]).map(function(He){return He-J+(j[_t]-ee)}),Ue=u(er,tr);Ue=Ue.map(function(He){return He+ee+(He+ee<j[_t]?0:J-j[_t])}),W.push.apply(W,Ue),ee=j[_t]+1},ie=0;ie<j.length;ie++)te(ie);for(var ae=0,he=W.length;ae<he;ae++)X[W[ae]]!=null&&(W[ae]=X[W[ae]]);k.triangles=W}else{for(var se=u(q,k.hole||[]),de=0,ue=se.length;de<ue;de++)X[se[de]]!=null&&(se[de]=X[se[de]]);k.triangles=se}}var ve=new Float64Array(L);s(ve,2,U);var ke=new Float64Array(2*M+6);k.close?L[0]===L[2*M-2]&&L[1]===L[2*M-1]?(ke[0]=ve[2*M-4],ke[1]=ve[2*M-3]):(ke[0]=ve[2*M-2],ke[1]=ve[2*M-1]):(ke[0]=ve[0],ke[1]=ve[1]),ke.set(ve,2),k.close?L[0]===L[2*M-2]&&L[1]===L[2*M-1]?(ke[2*M+2]=ve[2],ke[2*M+3]=ve[3],k.count-=1):(ke[2*M+2]=ve[0],ke[2*M+3]=ve[1],ke[2*M+4]=ve[2],ke[2*M+5]=ve[3]):(ke[2*M+2]=ve[2*M-2],ke[2*M+3]=ve[2*M-1],ke[2*M+4]=ve[2*M-2],ke[2*M+5]=ve[2*M-1]);var Ee=o(ke);k.positionBuffer(Ee);var be=i(ke,Ee);k.positionFractBuffer(be)}if(w.range?k.range=w.range:k.range||(k.range=k.bounds),(w.range||w.positions)&&k.count){var xe=k.bounds,ce=xe[2]-xe[0],ge=xe[3]-xe[1],we=k.range[2]-k.range[0],Me=k.range[3]-k.range[1];k.scale=[ce/we,ge/Me],k.translate=[-k.range[0]/we+xe[0]/we||0,-k.range[1]/Me+xe[1]/Me||0],k.scaleFract=i(k.scale),k.translateFract=i(k.translate)}if(w.dashes){var Se,ze=0;if(!w.dashes||w.dashes.length<2)ze=1,Se=new Uint8Array([255,255,255,255,255,255,255,255]);else{ze=0;for(var Fe=0;Fe<w.dashes.length;++Fe)ze+=w.dashes[Fe];Se=new Uint8Array(ze*g.dashMult);for(var Ye=0,rt=255,Oe=0;Oe<2;Oe++)for(var je=0;je<w.dashes.length;++je){for(var We=0,qe=w.dashes[je]*g.dashMult*.5;We<qe;++We)Se[Ye++]=rt;rt^=255}}k.dashLength=ze,k.dashTexture({channels:1,data:Se,width:Se.length,height:1,mag:"linear",min:"linear"},0,0)}if(w.color){var Qe=k.count,st=w.color;st||(st="transparent");var ct=new Uint8Array(4*Qe+4);if(Array.isArray(st)&&typeof st[0]!="number"){for(var Pt=0;Pt<Qe;Pt++){var kt=t(st[Pt],"uint8");ct.set(kt,4*Pt)}ct.set(t(st[0],"uint8"),4*Qe)}else for(var at=t(st,"uint8"),tt=0;tt<Qe+1;tt++)ct.set(at,4*tt);k.colorBuffer({usage:"dynamic",type:"uint8",data:ct})}}else y.passes[C]=null}),h.length<this.passes.length){for(var x=h.length;x<this.passes.length;x++){var T=this.passes[x];T&&(T.colorBuffer.destroy(),T.positionBuffer.destroy(),T.dashTexture.destroy())}this.passes.length=h.length}for(var A=[],S=0;S<this.passes.length;S++)this.passes[S]!==null&&A.push(this.passes[S]);return this.passes=A,this}},g.prototype.destroy=function(){return this.passes.forEach(function(h){h.colorBuffer.destroy(),h.positionBuffer.destroy(),h.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":76,"array-find-index":77,"array-normalize":78,"color-normalize":131,earcut:183,"es6-weak-map":238,"flatten-vertex-data":248,glslify:434,"object-assign":476,"parse-rect":481,"pick-by-alias":485,"to-float32":584}],524:[function(r,O,B){function t(x,T){return function(A){if(Array.isArray(A))return A}(x)||function(A,S){var w=A==null?null:typeof Symbol!="undefined"&&A[Symbol.iterator]||A["@@iterator"];if(w!=null){var C,k,L=[],M=!0,P=!1;try{for(w=w.call(A);!(M=(C=w.next()).done)&&(L.push(C.value),!S||L.length!==S);M=!0);}catch(D){P=!0,k=D}finally{try{M||w.return==null||w.return()}finally{if(P)throw k}}return L}}(x,T)||m(x,T)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function d(x){return function(T){if(Array.isArray(T))return p(T)}(x)||function(T){if(typeof Symbol!="undefined"&&T[Symbol.iterator]!=null||T["@@iterator"]!=null)return Array.from(T)}(x)||m(x)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function m(x,T){if(x){if(typeof x=="string")return p(x,T);var A=Object.prototype.toString.call(x).slice(8,-1);return A==="Object"&&x.constructor&&(A=x.constructor.name),A==="Map"||A==="Set"?Array.from(x):A==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A)?p(x,T):void 0}}function p(x,T){(T==null||T>x.length)&&(T=x.length);for(var A=0,S=new Array(T);A<T;A++)S[A]=x[A];return S}var e=r("color-normalize"),f=r("array-bounds"),u=r("color-id"),s=r("@plotly/point-cluster"),l=r("object-assign"),o=r("glslify"),i=r("pick-by-alias"),c=r("update-diff"),n=r("flatten-vertex-data"),a=r("is-iexplorer"),g=r("to-float32"),h=r("parse-rect"),y=v;function v(x,T){var A=this;if(!(this instanceof v))return new v(x,T);typeof x=="function"?(T||(T={}),T.regl=x):(T=x,x=null),T&&T.length&&(T.positions=T);var S,w=(x=T.regl)._gl,C=[];this.tooManyColors=a,S=x.texture({data:new Uint8Array(1020),width:255,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),l(this,{regl:x,gl:w,groups:[],markerCache:[null],markerTextures:[null],palette:C,paletteIds:{},paletteTexture:S,maxColors:255,maxSize:100,canvas:w.canvas}),this.update(T);var k={uniforms:{constPointSize:!!T.constPointSize,opacity:x.prop("opacity"),paletteSize:function(P,D){return[A.tooManyColors?0:255,S.height]},pixelRatio:x.context("pixelRatio"),scale:x.prop("scale"),scaleFract:x.prop("scaleFract"),translate:x.prop("translate"),translateFract:x.prop("translateFract"),markerTexture:x.prop("markerTexture"),paletteTexture:S},attributes:{x:function(P,D){return D.xAttr||{buffer:D.positionBuffer,stride:8,offset:0}},y:function(P,D){return D.yAttr||{buffer:D.positionBuffer,stride:8,offset:4}},xFract:function(P,D){return D.xAttr?{constant:[0,0]}:{buffer:D.positionFractBuffer,stride:8,offset:0}},yFract:function(P,D){return D.yAttr?{constant:[0,0]}:{buffer:D.positionFractBuffer,stride:8,offset:4}},size:function(P,D){return D.size.length?{buffer:D.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(255*D.size/A.maxSize)]}},borderSize:function(P,D){return D.borderSize.length?{buffer:D.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(255*D.borderSize/A.maxSize)]}},colorId:function(P,D){return D.color.length?{buffer:D.colorBuffer,stride:A.tooManyColors?8:4,offset:0}:{constant:A.tooManyColors?C.slice(4*D.color,4*D.color+4):[D.color]}},borderColorId:function(P,D){return D.borderColor.length?{buffer:D.colorBuffer,stride:A.tooManyColors?8:4,offset:A.tooManyColors?4:2}:{constant:A.tooManyColors?C.slice(4*D.borderColor,4*D.borderColor+4):[D.borderColor]}},isActive:function(P,D){return D.activation===!0?{constant:[1]}:D.activation?D.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:x.prop("viewport")},viewport:x.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:x.prop("elements"),count:x.prop("count"),offset:x.prop("offset"),primitive:"points"},L=l({},k);L.frag=o([`precision highp float;
#define GLSLIFY 1

uniform float opacity;
uniform sampler2D markerTexture;

varying vec4 fragColor, fragBorderColor;
varying float fragWidth, fragBorderColorLevel, fragColorLevel;

float smoothStep(float x, float y) {
  return 1.0 / (1.0 + exp(50.0*(x - y)));
}

void main() {
  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;

  // max-distance alpha
  if (dist < 0.003) discard;

  // null-border case
  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {
    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);
    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);
  }
  else {
    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);
    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);

    vec4 color = fragBorderColor;
    color.a *= borderColorAmt;
    color = mix(color, fragColor, colorAmt);
    color.a *= opacity;

    gl_FragColor = color;
  }

}
`]),L.vert=o([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 scale, scaleFract, translate, translateFract, paletteSize;
uniform sampler2D paletteTexture;

const float maxSize = 100.;
const float borderLevel = .5;

varying vec4 fragColor, fragBorderColor;
varying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = 2. * size * pointSizeScale;
  fragPointSize = size * pixelRatio;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragColor = color;
  fragBorderColor = borderColor;
  fragWidth = 1. / gl_PointSize;

  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);
  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);
}`]),this.drawMarker=x(L);var M=l({},k);M.frag=o([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

uniform float opacity;

float smoothStep(float edge0, float edge1, float x) {
	float t;
	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
	return t * t * (3.0 - 2.0 * t);
}

void main() {
	float radius, alpha = 1.0, delta = fragWidth;

	radius = length(2.0 * gl_PointCoord.xy - 1.0);

	if (radius > 1.0 + delta) {
		discard;
	}

	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);

	float borderRadius = fragBorderRadius;
	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);
	vec4 color = mix(fragColor, fragBorderColor, ratio);
	color.a *= alpha * opacity;
	gl_FragColor = color;
}
`]),M.vert=o([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 paletteSize, scale, scaleFract, translate, translateFract;
uniform sampler2D paletteTexture;

const float maxSize = 100.;

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = (size + borderSize) * pointSizeScale;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);
  fragColor = color;
  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;
  fragWidth = 1. / gl_PointSize;
}
`]),a&&(M.frag=M.frag.replace("smoothstep","smoothStep"),L.frag=L.frag.replace("smoothstep","smoothStep")),this.drawCircle=x(M)}v.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},v.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},v.prototype.draw=function(){for(var x=this,T=arguments.length,A=new Array(T),S=0;S<T;S++)A[S]=arguments[S];var w=this.groups;if(A.length===1&&Array.isArray(A[0])&&(A[0][0]===null||Array.isArray(A[0][0]))&&(A=A[0]),this.regl._refresh(),A.length)for(var C=0;C<A.length;C++)this.drawItem(C,A[C]);else w.forEach(function(k,L){x.drawItem(L)});return this},v.prototype.drawItem=function(x,T){var A=this.groups,S=A[x];if(typeof T=="number"&&(x=T,S=A[T],T=null),S&&S.count&&S.opacity){S.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,S,T));for(var w=[],C=1;C<S.activation.length;C++)S.activation[C]&&(S.activation[C]===!0||S.activation[C].data.length)&&w.push.apply(w,d(this.getMarkerDrawOptions(C,S,T)));w.length&&this.drawMarker(w)}},v.prototype.getMarkerDrawOptions=function(x,T,A){var S=T.range,w=T.tree,C=T.viewport,k=T.activation,L=T.selectionBuffer,M=T.count;if(this.regl,!w)return A?[l({},T,{markerTexture:this.markerTextures[x],activation:k[x],count:A.length,elements:A,offset:0})]:[l({},T,{markerTexture:this.markerTextures[x],activation:k[x],offset:0})];var P=[],D=w.range(S,{lod:!0,px:[(S[2]-S[0])/C.width,(S[3]-S[1])/C.height]});if(A){for(var N=k[x].data,U=new Uint8Array(M),q=0;q<A.length;q++){var X=A[q];U[X]=N?N[X]:1}L.subdata(U)}for(var K=D.length;K--;){var Z=t(D[K],2),H=Z[0],Y=Z[1];P.push(l({},T,{markerTexture:this.markerTextures[x],activation:A?L:k[x],offset:H,count:Y-H}))}return P},v.prototype.update=function(){for(var x=this,T=arguments.length,A=new Array(T),S=0;S<T;S++)A[S]=arguments[S];if(A.length){A.length===1&&Array.isArray(A[0])&&(A=A[0]);var w=this.groups,C=this.gl,k=this.regl,L=this.maxSize,M=this.maxColors,P=this.palette;this.groups=w=A.map(function(D,N){var U=w[N];if(D===void 0)return U;D===null?D={positions:null}:typeof D=="function"?D={ondraw:D}:typeof D[0]=="number"&&(D={positions:D}),(D=i(D,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"})).positions===null&&(D.positions=[]),D.tooManyColors!=null&&(x.tooManyColors=D.tooManyColors),U||(w[N]=U={id:N,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:k.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:k.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:k.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:k.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:k.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},D=l({},v.defaults,D)),D.positions&&!("marker"in D)&&(D.marker=U.marker,delete U.marker),D.marker&&!("positions"in D)&&(D.positions=U.positions,delete U.positions);var q=0,X=0;if(c(U,D,[{snap:!0,size:function(ue,ve){return ue==null&&(ue=v.defaults.size),q+=ue&&ue.length?1:0,ue},borderSize:function(ue,ve){return ue==null&&(ue=v.defaults.borderSize),q+=ue&&ue.length?1:0,ue},opacity:parseFloat,color:function(ue,ve){return ue==null&&(ue=v.defaults.color),ue=x.updateColor(ue),X++,ue},borderColor:function(ue,ve){return ue==null&&(ue=v.defaults.borderColor),ue=x.updateColor(ue),X++,ue},bounds:function(ue,ve,ke){return"range"in ke||(ke.range=null),ue},positions:function(ue,ve,ke){var Ee=ve.snap,be=ve.positionBuffer,xe=ve.positionFractBuffer,ce=ve.selectionBuffer;if(ue.x||ue.y)return ue.x.length?ve.xAttr={buffer:k.buffer(ue.x),offset:0,stride:4,count:ue.x.length}:ve.xAttr={buffer:ue.x.buffer,offset:4*ue.x.offset||0,stride:4*(ue.x.stride||1),count:ue.x.count},ue.y.length?ve.yAttr={buffer:k.buffer(ue.y),offset:0,stride:4,count:ue.y.length}:ve.yAttr={buffer:ue.y.buffer,offset:4*ue.y.offset||0,stride:4*(ue.y.stride||1),count:ue.y.count},ve.count=Math.max(ve.xAttr.count,ve.yAttr.count),ue;ue=n(ue,"float64");var ge=ve.count=Math.floor(ue.length/2),we=ve.bounds=ge?f(ue,2):null;if(ke.range||ve.range||(delete ve.range,ke.range=we),ke.marker||ve.marker||(delete ve.marker,ke.marker=null),Ee&&(Ee===!0||ge>Ee)?ve.tree=s(ue,{bounds:we}):Ee&&Ee.length&&(ve.tree=Ee),ve.tree){var Me={primitive:"points",usage:"static",data:ve.tree,type:"uint32"};ve.elements?ve.elements(Me):ve.elements=k.elements(Me)}var Se=g.float32(ue);return be({data:Se,usage:"dynamic"}),xe({data:g.fract32(ue,Se),usage:"dynamic"}),ce({data:new Uint8Array(ge),type:"uint8",usage:"stream"}),ue}},{marker:function(ue,ve,ke){var Ee=ve.activation;if(Ee.forEach(function(Se){return Se&&Se.destroy&&Se.destroy()}),Ee.length=0,ue&&typeof ue[0]!="number"){for(var be=[],xe=0,ce=Math.min(ue.length,ve.count);xe<ce;xe++){var ge=x.addMarker(ue[xe]);be[ge]||(be[ge]=new Uint8Array(ve.count)),be[ge][xe]=1}for(var we=0;we<be.length;we++)if(be[we]){var Me={data:be[we],type:"uint8",usage:"static"};Ee[we]?Ee[we](Me):Ee[we]=k.buffer(Me),Ee[we].data=be[we]}}else Ee[x.addMarker(ue)]=!0;return ue},range:function(ue,ve,ke){var Ee=ve.bounds;if(Ee)return ue||(ue=Ee),ve.scale=[1/(ue[2]-ue[0]),1/(ue[3]-ue[1])],ve.translate=[-ue[0],-ue[1]],ve.scaleFract=g.fract(ve.scale),ve.translateFract=g.fract(ve.translate),ue},viewport:function(ue){return h(ue||[C.drawingBufferWidth,C.drawingBufferHeight])}}]),q){var K=U,Z=K.count,H=K.size,Y=K.borderSize,$=K.sizeBuffer,z=new Uint8Array(2*Z);if(H.length||Y.length)for(var j=0;j<Z;j++)z[2*j]=Math.round(255*(H[j]==null?H:H[j])/L),z[2*j+1]=Math.round(255*(Y[j]==null?Y:Y[j])/L);$({data:z,usage:"dynamic"})}if(X){var W,ee=U,J=ee.count,Q=ee.color,te=ee.borderColor,ie=ee.colorBuffer;if(x.tooManyColors){if(Q.length||te.length){W=new Uint8Array(8*J);for(var ae=0;ae<J;ae++){var he=Q[ae];W[8*ae]=P[4*he],W[8*ae+1]=P[4*he+1],W[8*ae+2]=P[4*he+2],W[8*ae+3]=P[4*he+3];var se=te[ae];W[8*ae+4]=P[4*se],W[8*ae+5]=P[4*se+1],W[8*ae+6]=P[4*se+2],W[8*ae+7]=P[4*se+3]}}}else if(Q.length||te.length){W=new Uint8Array(4*J+2);for(var de=0;de<J;de++)Q[de]!=null&&(W[4*de]=Q[de]%M,W[4*de+1]=Math.floor(Q[de]/M)),te[de]!=null&&(W[4*de+2]=te[de]%M,W[4*de+3]=Math.floor(te[de]/M))}ie({data:W||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return U})}},v.prototype.addMarker=function(x){var T,A=this.markerTextures,S=this.regl,w=this.markerCache,C=x==null?0:w.indexOf(x);if(C>=0)return C;if(x instanceof Uint8Array||x instanceof Uint8ClampedArray)T=x;else{T=new Uint8Array(x.length);for(var k=0,L=x.length;k<L;k++)T[k]=255*x[k]}var M=Math.floor(Math.sqrt(T.length));return C=A.length,w.push(x),A.push(S.texture({channels:1,data:T,radius:M,mag:"linear",min:"linear"})),C},v.prototype.updateColor=function(x){var T=this.paletteIds,A=this.palette,S=this.maxColors;Array.isArray(x)||(x=[x]);var w=[];if(typeof x[0]=="number"){var C=[];if(Array.isArray(x))for(var k=0;k<x.length;k+=4)C.push(x.slice(k,k+4));else for(var L=0;L<x.length;L+=4)C.push(x.subarray(L,L+4));x=C}for(var M=0;M<x.length;M++){var P=x[M];P=e(P,"uint8");var D=u(P,!1);if(T[D]==null){var N=A.length;T[D]=Math.floor(N/4),A[N]=P[0],A[N+1]=P[1],A[N+2]=P[2],A[N+3]=P[3]}w[M]=T[D]}return!this.tooManyColors&&A.length>4*S&&(this.tooManyColors=!0),this.updatePalette(A),w.length===1?w[0]:w},v.prototype.updatePalette=function(x){if(!this.tooManyColors){var T=this.maxColors,A=this.paletteTexture,S=Math.ceil(.25*x.length/T);if(S>1)for(var w=.25*(x=x.slice()).length%T;w<S*T;w++)x.push(0,0,0,0);A.height<S&&A.resize(T,S),A.subimage({width:Math.min(.25*x.length,T),height:S,data:x},0,0)}},v.prototype.destroy=function(){return this.groups.forEach(function(x){x.sizeBuffer.destroy(),x.positionBuffer.destroy(),x.positionFractBuffer.destroy(),x.colorBuffer.destroy(),x.activation.forEach(function(T){return T&&T.destroy&&T.destroy()}),x.selectionBuffer.destroy(),x.elements&&x.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(x){return x&&x.destroy&&x.destroy()}),this};var _=r("object-assign");O.exports=function(x,T){var A=new y(x,T),S=A.render.bind(A);return _(S,{render:S,update:A.update.bind(A),draw:A.draw.bind(A),destroy:A.destroy.bind(A),regl:A.regl,gl:A.gl,canvas:A.gl.canvas,groups:A.groups,markers:A.markerCache,palette:A.palette}),S}},{"@plotly/point-cluster":59,"array-bounds":76,"color-id":129,"color-normalize":131,"flatten-vertex-data":248,glslify:434,"is-iexplorer":444,"object-assign":476,"parse-rect":481,"pick-by-alias":485,"to-float32":584,"update-diff":605}],525:[function(r,O,B){var t=r("regl-scatter2d"),d=r("pick-by-alias"),m=r("array-bounds"),p=r("raf"),e=r("array-range"),f=r("parse-rect"),u=r("flatten-vertex-data");function s(c,n){if(!(this instanceof s))return new s(c,n);this.traces=[],this.passes={},this.regl=c,this.scatter=t(c),this.canvas=this.scatter.canvas}function l(c,n,a){return(c.id!=null?c.id:c)<<16|(255&n)<<8|255&a}function o(c,n,a){var g,h,y,v,_=c[n],x=c[a];return _.length>2?(_[0],_[2],g=_[1],h=_[3]):_.length?(g=_[0],h=_[1]):(_.x,g=_.y,_.x+_.width,h=_.y+_.height),x.length>2?(y=x[0],v=x[2],x[1],x[3]):x.length?(y=x[0],v=x[1]):(y=x.x,x.y,v=x.x+x.width,x.y+x.height),[y,g,v,h]}function i(c){if(typeof c=="number")return[c,c,c,c];if(c.length===2)return[c[0],c[1],c[0],c[1]];var n=f(c);return[n.x,n.y,n.x+n.width,n.y+n.height]}O.exports=s,s.prototype.render=function(){for(var c,n=this,a=[],g=arguments.length;g--;)a[g]=arguments[g];return a.length&&(c=this).update.apply(c,a),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?this.planned==null&&(this.planned=p(function(){n.draw(),n.dirty=!0,n.planned=null})):(this.draw(),this.dirty=!0,p(function(){n.dirty=!1})),this)},s.prototype.update=function(){for(var c,n=[],a=arguments.length;a--;)n[a]=arguments[a];if(n.length){for(var g=0;g<n.length;g++)this.updateItem(g,n[g]);this.traces=this.traces.filter(Boolean);for(var h=[],y=0,v=0;v<this.traces.length;v++){for(var _=this.traces[v],x=this.traces[v].passes,T=0;T<x.length;T++)h.push(this.passes[x[T]]);_.passOffset=y,y+=_.passes.length}return(c=this.scatter).update.apply(c,h),this}},s.prototype.updateItem=function(c,n){var a=this.regl;if(n===null)return this.traces[c]=null,this;if(!n)return this;var g,h=d(n,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),y=this.traces[c]||(this.traces[c]={id:c,buffer:a.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:f([a._gl.drawingBufferWidth,a._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(h.color!=null&&(y.color=h.color),h.size!=null&&(y.size=h.size),h.marker!=null&&(y.marker=h.marker),h.borderColor!=null&&(y.borderColor=h.borderColor),h.borderSize!=null&&(y.borderSize=h.borderSize),h.opacity!=null&&(y.opacity=h.opacity),h.viewport&&(y.viewport=f(h.viewport)),h.diagonal!=null&&(y.diagonal=h.diagonal),h.upper!=null&&(y.upper=h.upper),h.lower!=null&&(y.lower=h.lower),h.data){y.buffer(u(h.data)),y.columns=h.data.length,y.count=h.data[0].length,y.bounds=[];for(var v=0;v<y.columns;v++)y.bounds[v]=m(h.data[v],1)}h.range&&(y.range=h.range,g=y.range&&typeof y.range[0]!="number"),h.domain&&(y.domain=h.domain);var _=!1;h.padding!=null&&(Array.isArray(h.padding)&&h.padding.length===y.columns&&typeof h.padding[h.padding.length-1]=="number"?(y.padding=h.padding.map(i),_=!0):y.padding=i(h.padding));var x=y.columns,T=y.count,A=y.viewport.width,S=y.viewport.height,w=y.viewport.x,C=y.viewport.y,k=A/x,L=S/x;y.passes=[];for(var M=0;M<x;M++)for(var P=0;P<x;P++)if((y.diagonal||P!==M)&&(y.upper||!(M>P))&&(y.lower||!(M<P))){var D=l(y.id,M,P),N=this.passes[D]||(this.passes[D]={});if(h.data&&(h.transpose?N.positions={x:{buffer:y.buffer,offset:P,count:T,stride:x},y:{buffer:y.buffer,offset:M,count:T,stride:x}}:N.positions={x:{buffer:y.buffer,offset:P*T,count:T},y:{buffer:y.buffer,offset:M*T,count:T}},N.bounds=o(y.bounds,M,P)),h.domain||h.viewport||h.data){var U=_?o(y.padding,M,P):y.padding;if(y.domain){var q=o(y.domain,M,P),X=q[0],K=q[1],Z=q[2],H=q[3];N.viewport=[w+X*A+U[0],C+K*S+U[1],w+Z*A-U[2],C+H*S-U[3]]}else N.viewport=[w+P*k+k*U[0],C+M*L+L*U[1],w+(P+1)*k-k*U[2],C+(M+1)*L-L*U[3]]}h.color&&(N.color=y.color),h.size&&(N.size=y.size),h.marker&&(N.marker=y.marker),h.borderSize&&(N.borderSize=y.borderSize),h.borderColor&&(N.borderColor=y.borderColor),h.opacity&&(N.opacity=y.opacity),h.range&&(N.range=g?o(y.range,M,P):y.range||N.bounds),y.passes.push(D)}return this},s.prototype.draw=function(){for(var c,n=[],a=arguments.length;a--;)n[a]=arguments[a];if(n.length){for(var g=[],h=0;h<n.length;h++)if(typeof n[h]=="number"){var y=this.traces[n[h]],v=y.passes,_=y.passOffset;g.push.apply(g,e(_,_+v.length))}else if(n[h].length){var x=n[h],T=this.traces[h],A=T.passes,S=T.passOffset;A=A.map(function(w,C){g[S+C]=x})}(c=this.scatter).draw.apply(c,g)}else this.scatter.draw();return this},s.prototype.destroy=function(){return this.traces.forEach(function(c){c.buffer&&c.buffer.destroy&&c.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":76,"array-range":79,"flatten-vertex-data":248,"parse-rect":481,"pick-by-alias":485,raf:516,"regl-scatter2d":524}],526:[function(r,O,B){(function(t,d){typeof B=="object"&&O!==void 0?O.exports=d():t.createREGL=d()})(this,function(){function t(Be,Ke){this.id=W++,this.type=Be,this.data=Ke}function d(Be){return"["+function Ke(_e){if(_e.length===0)return[];var Ce=_e.charAt(0),Le=_e.charAt(_e.length-1);if(1<_e.length&&Ce===Le&&(Ce==='"'||Ce==="'"))return['"'+_e.substr(1,_e.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(Ce=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(_e))return Ke(_e.substr(0,Ce.index)).concat(Ke(Ce[1])).concat(Ke(_e.substr(Ce.index+Ce[0].length)));if((Ce=_e.split(".")).length===1)return['"'+_e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(_e=[],Le=0;Le<Ce.length;++Le)_e=_e.concat(Ke(Ce[Le]));return _e}(Be).join("][")+"]"}function m(Be){return typeof Be=="string"?Be.split():Be}function p(Be){return typeof Be=="string"?document.querySelector(Be):Be}function e(Be){var Ke,_e,Ce,Le,Pe=Be||{};Be={};var Xe=[],ht=[],Mt=typeof window=="undefined"?1:window.devicePixelRatio,pt=!1,Lt=function(Dt){},vt=function(){};if(typeof Pe=="string"?Ke=document.querySelector(Pe):typeof Pe=="object"&&(typeof Pe.nodeName=="string"&&typeof Pe.appendChild=="function"&&typeof Pe.getBoundingClientRect=="function"?Ke=Pe:typeof Pe.drawArrays=="function"||typeof Pe.drawElements=="function"?Ce=(Le=Pe).canvas:("gl"in Pe?Le=Pe.gl:"canvas"in Pe?Ce=p(Pe.canvas):"container"in Pe&&(_e=p(Pe.container)),"attributes"in Pe&&(Be=Pe.attributes),"extensions"in Pe&&(Xe=m(Pe.extensions)),"optionalExtensions"in Pe&&(ht=m(Pe.optionalExtensions)),"onDone"in Pe&&(Lt=Pe.onDone),"profile"in Pe&&(pt=!!Pe.profile),"pixelRatio"in Pe&&(Mt=+Pe.pixelRatio))),Ke&&(Ke.nodeName.toLowerCase()==="canvas"?Ce=Ke:_e=Ke),!Le){if(!Ce){if(!(Ke=function(Dt,xt,it){function St(){var Qt=window.innerWidth,Ie=window.innerHeight;Dt!==document.body&&(Qt=(Ie=Ut.getBoundingClientRect()).right-Ie.left,Ie=Ie.bottom-Ie.top),Ut.width=it*Qt,Ut.height=it*Ie}var Nt,Ut=document.createElement("canvas");return j(Ut.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),Dt.appendChild(Ut),Dt===document.body&&(Ut.style.position="absolute",j(Dt.style,{margin:0,padding:0})),Dt!==document.body&&typeof ResizeObserver=="function"?(Nt=new ResizeObserver(function(){setTimeout(St)})).observe(Dt):window.addEventListener("resize",St,!1),St(),{canvas:Ut,onDestroy:function(){Nt?Nt.disconnect():window.removeEventListener("resize",St),Dt.removeChild(Ut)}}}(_e||document.body,0,Mt)))return null;Ce=Ke.canvas,vt=Ke.onDestroy}Be.premultipliedAlpha===void 0&&(Be.premultipliedAlpha=!0),Le=function(Dt,xt){function it(St){try{return Dt.getContext(St,xt)}catch(Nt){return null}}return it("webgl")||it("experimental-webgl")||it("webgl-experimental")}(Ce,Be)}return Le?{gl:Le,canvas:Ce,container:_e,extensions:Xe,optionalExtensions:ht,pixelRatio:Mt,profile:pt,onDone:Lt,onDestroy:vt}:(vt(),Lt("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function f(Be,Ke){for(var _e=Array(Be),Ce=0;Ce<Be;++Ce)_e[Ce]=Ke(Ce);return _e}function u(Be){var Ke,_e;return Ke=(65535<Be)<<4,Ke|=_e=(255<(Be>>>=Ke))<<3,(Ke|=_e=(15<(Be>>>=_e))<<2)|(_e=(3<(Be>>>=_e))<<1)|Be>>>_e>>1}function s(){function Be(Ce){e:{for(var Le=16;268435456>=Le;Le*=16)if(Ce<=Le){Ce=Le;break e}Ce=0}return 0<(Le=_e[u(Ce)>>2]).length?Le.pop():new ArrayBuffer(Ce)}function Ke(Ce){_e[u(Ce.byteLength)>>2].push(Ce)}var _e=f(8,function(){return[]});return{alloc:Be,free:Ke,allocType:function(Ce,Le){var Pe=null;switch(Ce){case 5120:Pe=new Int8Array(Be(Le),0,Le);break;case 5121:Pe=new Uint8Array(Be(Le),0,Le);break;case 5122:Pe=new Int16Array(Be(2*Le),0,Le);break;case 5123:Pe=new Uint16Array(Be(2*Le),0,Le);break;case 5124:Pe=new Int32Array(Be(4*Le),0,Le);break;case 5125:Pe=new Uint32Array(Be(4*Le),0,Le);break;case 5126:Pe=new Float32Array(Be(4*Le),0,Le);break;default:return null}return Pe.length!==Le?Pe.subarray(0,Le):Pe},freeType:function(Ce){Ke(Ce.buffer)}}}function l(Be){return!!Be&&typeof Be=="object"&&Array.isArray(Be.shape)&&Array.isArray(Be.stride)&&typeof Be.offset=="number"&&Be.shape.length===Be.stride.length&&(Array.isArray(Be.data)||ae(Be.data))}function o(Be,Ke,_e,Ce,Le,Pe){for(var Xe=0;Xe<Ke;++Xe)for(var ht=Be[Xe],Mt=0;Mt<_e;++Mt)for(var pt=ht[Mt],Lt=0;Lt<Ce;++Lt)Le[Pe++]=pt[Lt]}function i(Be){return 0|de[Object.prototype.toString.call(Be)]}function c(Be,Ke){for(var _e=0;_e<Ke.length;++_e)Be[_e]=Ke[_e]}function n(Be,Ke,_e,Ce,Le,Pe,Xe){for(var ht=0,Mt=0;Mt<_e;++Mt)for(var pt=0;pt<Ce;++pt)Be[ht++]=Ke[Le*Mt+Pe*pt+Xe]}function a(Be,Ke,_e,Ce){function Le(vt){this.id=Mt++,this.buffer=Be.createBuffer(),this.type=vt,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,_e.profile&&(this.stats={size:0})}function Pe(vt,Dt,xt){vt.byteLength=Dt.byteLength,Be.bufferData(vt.type,Dt,xt)}function Xe(vt,Dt,xt,it,St,Nt){if(vt.usage=xt,Array.isArray(Dt)){if(vt.dtype=it||5126,0<Dt.length)if(Array.isArray(Dt[0])){St=Ee(Dt);for(var Ut=it=1;Ut<St.length;++Ut)it*=St[Ut];vt.dimension=it,Pe(vt,Dt=ke(Dt,St,vt.dtype),xt),Nt?vt.persistentData=Dt:te.freeType(Dt)}else typeof Dt[0]=="number"?(vt.dimension=St,c(St=te.allocType(vt.dtype,Dt.length),Dt),Pe(vt,St,xt),Nt?vt.persistentData=St:te.freeType(St)):ae(Dt[0])&&(vt.dimension=Dt[0].length,vt.dtype=it||i(Dt[0])||5126,Pe(vt,Dt=ke(Dt,[Dt.length,Dt[0].length],vt.dtype),xt),Nt?vt.persistentData=Dt:te.freeType(Dt))}else if(ae(Dt))vt.dtype=it||i(Dt),vt.dimension=St,Pe(vt,Dt,xt),Nt&&(vt.persistentData=new Uint8Array(new Uint8Array(Dt.buffer)));else if(l(Dt)){St=Dt.shape;var Qt=Dt.stride,Ie=(Ut=Dt.offset,0),lt=0,wt=0,Ot=0;St.length===1?(Ie=St[0],lt=1,wt=Qt[0],Ot=0):St.length===2&&(Ie=St[0],lt=St[1],wt=Qt[0],Ot=Qt[1]),vt.dtype=it||i(Dt.data)||5126,vt.dimension=lt,n(St=te.allocType(vt.dtype,Ie*lt),Dt.data,Ie,lt,wt,Ot,Ut),Pe(vt,St,xt),Nt?vt.persistentData=St:te.freeType(St)}else Dt instanceof ArrayBuffer&&(vt.dtype=5121,vt.dimension=St,Pe(vt,Dt,xt),Nt&&(vt.persistentData=new Uint8Array(new Uint8Array(Dt))))}function ht(vt){Ke.bufferCount--,Ce(vt),Be.deleteBuffer(vt.buffer),vt.buffer=null,delete pt[vt.id]}var Mt=0,pt={};Le.prototype.bind=function(){Be.bindBuffer(this.type,this.buffer)},Le.prototype.destroy=function(){ht(this)};var Lt=[];return _e.profile&&(Ke.getTotalBufferSize=function(){var vt=0;return Object.keys(pt).forEach(function(Dt){vt+=pt[Dt].stats.size}),vt}),{create:function(vt,Dt,xt,it){function St(Ut){var Qt=35044,Ie=null,lt=0,wt=0,Ot=1;return Array.isArray(Ut)||ae(Ut)||l(Ut)||Ut instanceof ArrayBuffer?Ie=Ut:typeof Ut=="number"?lt=0|Ut:Ut&&("data"in Ut&&(Ie=Ut.data),"usage"in Ut&&(Qt=ve[Ut.usage]),"type"in Ut&&(wt=ue[Ut.type]),"dimension"in Ut&&(Ot=0|Ut.dimension),"length"in Ut&&(lt=0|Ut.length)),Nt.bind(),Ie?Xe(Nt,Ie,Qt,wt,Ot,it):(lt&&Be.bufferData(Nt.type,lt,Qt),Nt.dtype=wt||5121,Nt.usage=Qt,Nt.dimension=Ot,Nt.byteLength=lt),_e.profile&&(Nt.stats.size=Nt.byteLength*be[Nt.dtype]),St}Ke.bufferCount++;var Nt=new Le(Dt);return pt[Nt.id]=Nt,xt||St(vt),St._reglType="buffer",St._buffer=Nt,St.subdata=function(Ut,Qt){var Ie,lt=0|(Qt||0);if(Nt.bind(),ae(Ut)||Ut instanceof ArrayBuffer)Be.bufferSubData(Nt.type,lt,Ut);else if(Array.isArray(Ut)){if(0<Ut.length)if(typeof Ut[0]=="number"){var wt=te.allocType(Nt.dtype,Ut.length);c(wt,Ut),Be.bufferSubData(Nt.type,lt,wt),te.freeType(wt)}else(Array.isArray(Ut[0])||ae(Ut[0]))&&(Ie=Ee(Ut),wt=ke(Ut,Ie,Nt.dtype),Be.bufferSubData(Nt.type,lt,wt),te.freeType(wt))}else if(l(Ut)){Ie=Ut.shape;var Ot=Ut.stride,Gt=wt=0,ir=0,Xt=0;Ie.length===1?(wt=Ie[0],Gt=1,ir=Ot[0],Xt=0):Ie.length===2&&(wt=Ie[0],Gt=Ie[1],ir=Ot[0],Xt=Ot[1]),Ie=Array.isArray(Ut.data)?Nt.dtype:i(Ut.data),n(Ie=te.allocType(Ie,wt*Gt),Ut.data,wt,Gt,ir,Xt,Ut.offset),Be.bufferSubData(Nt.type,lt,Ie),te.freeType(Ie)}return St},_e.profile&&(St.stats=Nt.stats),St.destroy=function(){ht(Nt)},St},createStream:function(vt,Dt){var xt=Lt.pop();return xt||(xt=new Le(vt)),xt.bind(),Xe(xt,Dt,35040,0,1,!1),xt},destroyStream:function(vt){Lt.push(vt)},clear:function(){he(pt).forEach(ht),Lt.forEach(ht)},getBuffer:function(vt){return vt&&vt._buffer instanceof Le?vt._buffer:null},restore:function(){he(pt).forEach(function(vt){vt.buffer=Be.createBuffer(),Be.bindBuffer(vt.type,vt.buffer),Be.bufferData(vt.type,vt.persistentData||vt.byteLength,vt.usage)})},_initBuffer:Xe}}function g(Be,Ke,_e,Ce){function Le(vt){this.id=Mt++,ht[this.id]=this,this.buffer=vt,this.primType=4,this.type=this.vertCount=0}function Pe(vt,Dt,xt,it,St,Nt,Ut){var Qt;if(vt.buffer.bind(),Dt?((Qt=Ut)||ae(Dt)&&(!l(Dt)||ae(Dt.data))||(Qt=Ke.oes_element_index_uint?5125:5123),_e._initBuffer(vt.buffer,Dt,xt,Qt,3)):(Be.bufferData(34963,Nt,xt),vt.buffer.dtype=Qt||5121,vt.buffer.usage=xt,vt.buffer.dimension=3,vt.buffer.byteLength=Nt),Qt=Ut,!Ut){switch(vt.buffer.dtype){case 5121:case 5120:Qt=5121;break;case 5123:case 5122:Qt=5123;break;case 5125:case 5124:Qt=5125}vt.buffer.dtype=Qt}vt.type=Qt,0>(Dt=St)&&(Dt=vt.buffer.byteLength,Qt===5123?Dt>>=1:Qt===5125&&(Dt>>=2)),vt.vertCount=Dt,Dt=it,0>it&&(Dt=4,(it=vt.buffer.dimension)===1&&(Dt=0),it===2&&(Dt=1),it===3&&(Dt=4)),vt.primType=Dt}function Xe(vt){Ce.elementsCount--,delete ht[vt.id],vt.buffer.destroy(),vt.buffer=null}var ht={},Mt=0,pt={uint8:5121,uint16:5123};Ke.oes_element_index_uint&&(pt.uint32=5125),Le.prototype.bind=function(){this.buffer.bind()};var Lt=[];return{create:function(vt,Dt){function xt(Nt){if(Nt)if(typeof Nt=="number")it(Nt),St.primType=4,St.vertCount=0|Nt,St.type=5121;else{var Ut=null,Qt=35044,Ie=-1,lt=-1,wt=0,Ot=0;Array.isArray(Nt)||ae(Nt)||l(Nt)?Ut=Nt:("data"in Nt&&(Ut=Nt.data),"usage"in Nt&&(Qt=ve[Nt.usage]),"primitive"in Nt&&(Ie=xe[Nt.primitive]),"count"in Nt&&(lt=0|Nt.count),"type"in Nt&&(Ot=pt[Nt.type]),"length"in Nt?wt=0|Nt.length:(wt=lt,Ot===5123||Ot===5122?wt*=2:Ot!==5125&&Ot!==5124||(wt*=4))),Pe(St,Ut,Qt,Ie,lt,wt,Ot)}else it(),St.primType=4,St.vertCount=0,St.type=5121;return xt}var it=_e.create(null,34963,!0),St=new Le(it._buffer);return Ce.elementsCount++,xt(vt),xt._reglType="elements",xt._elements=St,xt.subdata=function(Nt,Ut){return it.subdata(Nt,Ut),xt},xt.destroy=function(){Xe(St)},xt},createStream:function(vt){var Dt=Lt.pop();return Dt||(Dt=new Le(_e.create(null,34963,!0,!1)._buffer)),Pe(Dt,vt,35040,-1,-1,0,0),Dt},destroyStream:function(vt){Lt.push(vt)},getElements:function(vt){return typeof vt=="function"&&vt._elements instanceof Le?vt._elements:null},clear:function(){he(ht).forEach(Xe)}}}function h(Be){for(var Ke=te.allocType(5123,Be.length),_e=0;_e<Be.length;++_e)if(isNaN(Be[_e]))Ke[_e]=65535;else if(1/0===Be[_e])Ke[_e]=31744;else if(-1/0===Be[_e])Ke[_e]=64512;else{ce[0]=Be[_e];var Ce=(Pe=ge[0])>>>31<<15,Le=(Pe<<1>>>24)-127,Pe=Pe>>13&1023;Ke[_e]=-24>Le?Ce:-14>Le?Ce+(Pe+1024>>-14-Le):15<Le?Ce+31744:Ce+(Le+15<<10)+Pe}return Ke}function y(Be){return Array.isArray(Be)||ae(Be)}function v(Be){return"[object "+Be+"]"}function _(Be){return Array.isArray(Be)&&(Be.length===0||typeof Be[0]=="number")}function x(Be){return!(!Array.isArray(Be)||Be.length===0||!y(Be[0]))}function T(Be){return Object.prototype.toString.call(Be)}function A(Be){if(!Be)return!1;var Ke=T(Be);return 0<=We.indexOf(Ke)||_(Be)||x(Be)||l(Be)}function S(Be,Ke){Be.type===36193?(Be.data=h(Ke),te.freeType(Ke)):Be.data=Ke}function w(Be,Ke,_e,Ce,Le,Pe){if(Be=Qe[Be]!==void 0?Qe[Be]:Se[Be]*qe[Ke],Pe&&(Be*=6),Le){for(Ce=0;1<=_e;)Ce+=Be*_e*_e,_e/=2;return Ce}return Be*_e*Ce}function C(Be,Ke,_e,Ce,Le,Pe,Xe){function ht(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function Mt(Jt,It){Jt.internalformat=It.internalformat,Jt.format=It.format,Jt.type=It.type,Jt.compressed=It.compressed,Jt.premultiplyAlpha=It.premultiplyAlpha,Jt.flipY=It.flipY,Jt.unpackAlignment=It.unpackAlignment,Jt.colorSpace=It.colorSpace,Jt.width=It.width,Jt.height=It.height,Jt.channels=It.channels}function pt(Jt,It){if(typeof It=="object"&&It){"premultiplyAlpha"in It&&(Jt.premultiplyAlpha=It.premultiplyAlpha),"flipY"in It&&(Jt.flipY=It.flipY),"alignment"in It&&(Jt.unpackAlignment=It.alignment),"colorSpace"in It&&(Jt.colorSpace=Rr[It.colorSpace]),"type"in It&&(Jt.type=_r[It.type]);var qt=Jt.width,fr=Jt.height,Tr=Jt.channels,Gr=!1;"shape"in It?(qt=It.shape[0],fr=It.shape[1],It.shape.length===3&&(Tr=It.shape[2],Gr=!0)):("radius"in It&&(qt=fr=It.radius),"width"in It&&(qt=It.width),"height"in It&&(fr=It.height),"channels"in It&&(Tr=It.channels,Gr=!0)),Jt.width=0|qt,Jt.height=0|fr,Jt.channels=0|Tr,qt=!1,"format"in It&&(qt=It.format,fr=Jt.internalformat=jr[qt],Jt.format=en[fr],qt in _r&&!("type"in It)&&(Jt.type=_r[qt]),qt in $r&&(Jt.compressed=!0),qt=!0),!Gr&&qt?Jt.channels=Se[Jt.format]:Gr&&!qt&&Jt.channels!==Me[Jt.format]&&(Jt.format=Jt.internalformat=Me[Jt.channels])}}function Lt(Jt){Be.pixelStorei(37440,Jt.flipY),Be.pixelStorei(37441,Jt.premultiplyAlpha),Be.pixelStorei(37443,Jt.colorSpace),Be.pixelStorei(3317,Jt.unpackAlignment)}function vt(){ht.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Dt(Jt,It){var qt=null;if(A(It)?qt=It:It&&(pt(Jt,It),"x"in It&&(Jt.xOffset=0|It.x),"y"in It&&(Jt.yOffset=0|It.y),A(It.data)&&(qt=It.data)),It.copy){var fr=Le.viewportWidth,Tr=Le.viewportHeight;Jt.width=Jt.width||fr-Jt.xOffset,Jt.height=Jt.height||Tr-Jt.yOffset,Jt.needsCopy=!0}else if(qt){if(ae(qt))Jt.channels=Jt.channels||4,Jt.data=qt,"type"in It||Jt.type!==5121||(Jt.type=0|de[Object.prototype.toString.call(qt)]);else if(_(qt)){switch(Jt.channels=Jt.channels||4,Tr=(fr=qt).length,Jt.type){case 5121:case 5123:case 5125:case 5126:(Tr=te.allocType(Jt.type,Tr)).set(fr),Jt.data=Tr;break;case 36193:Jt.data=h(fr)}Jt.alignment=1,Jt.needsFree=!0}else if(l(qt)){fr=qt.data,Array.isArray(fr)||Jt.type!==5121||(Jt.type=0|de[Object.prototype.toString.call(fr)]),Tr=qt.shape;var Gr,Vr,xr,wr,Sr=qt.stride;Tr.length===3?(xr=Tr[2],wr=Sr[2]):wr=xr=1,Gr=Tr[0],Vr=Tr[1],Tr=Sr[0],Sr=Sr[1],Jt.alignment=1,Jt.width=Gr,Jt.height=Vr,Jt.channels=xr,Jt.format=Jt.internalformat=Me[xr],Jt.needsFree=!0,Gr=wr,qt=qt.offset,xr=Jt.width,wr=Jt.height,Vr=Jt.channels;for(var Mr=te.allocType(Jt.type===36193?5126:Jt.type,xr*wr*Vr),Ir=0,qr=0;qr<wr;++qr)for(var cn=0;cn<xr;++cn)for(var _n=0;_n<Vr;++_n)Mr[Ir++]=fr[Tr*cn+Sr*qr+Gr*_n+qt];S(Jt,Mr)}else if(T(qt)===ze||T(qt)===Fe||T(qt)===Ye)T(qt)===ze||T(qt)===Fe?Jt.element=qt:Jt.element=qt.canvas,Jt.width=Jt.element.width,Jt.height=Jt.element.height,Jt.channels=4;else if(T(qt)===rt)Jt.element=qt,Jt.width=qt.width,Jt.height=qt.height,Jt.channels=4;else if(T(qt)===Oe)Jt.element=qt,Jt.width=qt.naturalWidth,Jt.height=qt.naturalHeight,Jt.channels=4;else if(T(qt)===je)Jt.element=qt,Jt.width=qt.videoWidth,Jt.height=qt.videoHeight,Jt.channels=4;else if(x(qt)){for(fr=Jt.width||qt[0].length,Tr=Jt.height||qt.length,Sr=Jt.channels,Sr=y(qt[0][0])?Sr||qt[0][0].length:Sr||1,Gr=se.shape(qt),xr=1,wr=0;wr<Gr.length;++wr)xr*=Gr[wr];xr=te.allocType(Jt.type===36193?5126:Jt.type,xr),se.flatten(qt,Gr,"",xr),S(Jt,xr),Jt.alignment=1,Jt.width=fr,Jt.height=Tr,Jt.channels=Sr,Jt.format=Jt.internalformat=Me[Sr],Jt.needsFree=!0}}else Jt.width=Jt.width||1,Jt.height=Jt.height||1,Jt.channels=Jt.channels||4}function xt(Jt,It,qt,fr,Tr){var Gr=Jt.element,Vr=Jt.data,xr=Jt.internalformat,wr=Jt.format,Sr=Jt.type,Mr=Jt.width,Ir=Jt.height;Lt(Jt),Gr?Be.texSubImage2D(It,Tr,qt,fr,wr,Sr,Gr):Jt.compressed?Be.compressedTexSubImage2D(It,Tr,qt,fr,xr,Mr,Ir,Vr):Jt.needsCopy?(Ce(),Be.copyTexSubImage2D(It,Tr,qt,fr,Jt.xOffset,Jt.yOffset,Mr,Ir)):Be.texSubImage2D(It,Tr,qt,fr,Mr,Ir,wr,Sr,Vr)}function it(){return tn.pop()||new vt}function St(Jt){Jt.needsFree&&te.freeType(Jt.data),vt.call(Jt),tn.push(Jt)}function Nt(){ht.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function Ut(Jt,It,qt){var fr=Jt.images[0]=it();Jt.mipmask=1,fr.width=Jt.width=It,fr.height=Jt.height=qt,fr.channels=Jt.channels=4}function Qt(Jt,It){var qt=null;if(A(It))Mt(qt=Jt.images[0]=it(),Jt),Dt(qt,It),Jt.mipmask=1;else if(pt(Jt,It),Array.isArray(It.mipmap))for(var fr=It.mipmap,Tr=0;Tr<fr.length;++Tr)Mt(qt=Jt.images[Tr]=it(),Jt),qt.width>>=Tr,qt.height>>=Tr,Dt(qt,fr[Tr]),Jt.mipmask|=1<<Tr;else Mt(qt=Jt.images[0]=it(),Jt),Dt(qt,It),Jt.mipmask=1;Mt(Jt,Jt.images[0])}function Ie(Jt,It){for(var qt=Jt.images,fr=0;fr<qt.length&&qt[fr];++fr){var Tr=qt[fr],Gr=It,Vr=fr,xr=Tr.element,wr=Tr.data,Sr=Tr.internalformat,Mr=Tr.format,Ir=Tr.type,qr=Tr.width,cn=Tr.height;Lt(Tr),xr?Be.texImage2D(Gr,Vr,Mr,Mr,Ir,xr):Tr.compressed?Be.compressedTexImage2D(Gr,Vr,Sr,qr,cn,0,wr):Tr.needsCopy?(Ce(),Be.copyTexImage2D(Gr,Vr,Mr,Tr.xOffset,Tr.yOffset,qr,cn,0)):Be.texImage2D(Gr,Vr,Mr,qr,cn,0,Mr,Ir,wr||null)}}function lt(){var Jt=Qr.pop()||new Nt;ht.call(Jt);for(var It=Jt.mipmask=0;16>It;++It)Jt.images[It]=null;return Jt}function wt(Jt){for(var It=Jt.images,qt=0;qt<It.length;++qt)It[qt]&&St(It[qt]),It[qt]=null;Qr.push(Jt)}function Ot(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function Gt(Jt,It){"min"in It&&(Jt.minFilter=br[It.min],0<=we.indexOf(Jt.minFilter)&&!("faces"in It)&&(Jt.genMipmaps=!0)),"mag"in It&&(Jt.magFilter=pr[It.mag]);var qt=Jt.wrapS,fr=Jt.wrapT;if("wrap"in It){var Tr=It.wrap;typeof Tr=="string"?qt=fr=ur[Tr]:Array.isArray(Tr)&&(qt=ur[Tr[0]],fr=ur[Tr[1]])}else"wrapS"in It&&(qt=ur[It.wrapS]),"wrapT"in It&&(fr=ur[It.wrapT]);if(Jt.wrapS=qt,Jt.wrapT=fr,"anisotropic"in It&&(Jt.anisotropic=It.anisotropic),"mipmap"in It){switch(qt=!1,typeof It.mipmap){case"string":Jt.mipmapHint=vr[It.mipmap],qt=Jt.genMipmaps=!0;break;case"boolean":qt=Jt.genMipmaps=It.mipmap;break;case"object":Jt.genMipmaps=!1,qt=!0}!qt||"min"in It||(Jt.minFilter=9984)}}function ir(Jt,It){Be.texParameteri(It,10241,Jt.minFilter),Be.texParameteri(It,10240,Jt.magFilter),Be.texParameteri(It,10242,Jt.wrapS),Be.texParameteri(It,10243,Jt.wrapT),Ke.ext_texture_filter_anisotropic&&Be.texParameteri(It,34046,Jt.anisotropic),Jt.genMipmaps&&(Be.hint(33170,Jt.mipmapHint),Be.generateMipmap(It))}function Xt(Jt){ht.call(this),this.mipmask=0,this.internalformat=6408,this.id=rn++,this.refCount=1,this.target=Jt,this.texture=Be.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ot,Xe.profile&&(this.stats={size:0})}function Kt(Jt){Be.activeTexture(33984),Be.bindTexture(Jt.target,Jt.texture)}function or(){var Jt=Bn[0];Jt?Be.bindTexture(Jt.target,Jt.texture):Be.bindTexture(3553,null)}function dr(Jt){var It=Jt.texture,qt=Jt.unit,fr=Jt.target;0<=qt&&(Be.activeTexture(33984+qt),Be.bindTexture(fr,null),Bn[qt]=null),Be.deleteTexture(It),Jt.texture=null,Jt.params=null,Jt.pixels=null,Jt.refCount=0,delete An[Jt.id],Pe.textureCount--}var vr={"don't care":4352,"dont care":4352,nice:4354,fast:4353},ur={repeat:10497,clamp:33071,mirror:33648},pr={nearest:9728,linear:9729},br=j({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},pr),Rr={none:0,browser:37444},_r={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},jr={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},$r={};Ke.ext_srgb&&(jr.srgb=35904,jr.srgba=35906),Ke.oes_texture_float&&(_r.float32=_r.float=5126),Ke.oes_texture_half_float&&(_r.float16=_r["half float"]=36193),Ke.webgl_depth_texture&&(j(jr,{depth:6402,"depth stencil":34041}),j(_r,{uint16:5123,uint32:5125,"depth stencil":34042})),Ke.webgl_compressed_texture_s3tc&&j($r,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),Ke.webgl_compressed_texture_atc&&j($r,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),Ke.webgl_compressed_texture_pvrtc&&j($r,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),Ke.webgl_compressed_texture_etc1&&($r["rgb etc1"]=36196);var pn=Array.prototype.slice.call(Be.getParameter(34467));Object.keys($r).forEach(function(Jt){var It=$r[Jt];0<=pn.indexOf(It)&&(jr[Jt]=It)});var In=Object.keys(jr);_e.textureFormats=In;var On=[];Object.keys(jr).forEach(function(Jt){On[jr[Jt]]=Jt});var Sn=[];Object.keys(_r).forEach(function(Jt){Sn[_r[Jt]]=Jt});var an=[];Object.keys(pr).forEach(function(Jt){an[pr[Jt]]=Jt});var Nr=[];Object.keys(br).forEach(function(Jt){Nr[br[Jt]]=Jt});var Pr=[];Object.keys(ur).forEach(function(Jt){Pr[ur[Jt]]=Jt});var en=In.reduce(function(Jt,It){var qt=jr[It];return qt===6409||qt===6406||qt===6409||qt===6410||qt===6402||qt===34041||Ke.ext_srgb&&(qt===35904||qt===35906)?Jt[qt]=qt:qt===32855||0<=It.indexOf("rgba")?Jt[qt]=6408:Jt[qt]=6407,Jt},{}),tn=[],Qr=[],rn=0,An={},En=_e.maxTextureUnits,Bn=Array(En).map(function(){return null});return j(Xt.prototype,{bind:function(){this.bindCount+=1;var Jt=this.unit;if(0>Jt){for(var It=0;It<En;++It){var qt=Bn[It];if(qt){if(0<qt.bindCount)continue;qt.unit=-1}Bn[It]=this,Jt=It;break}Xe.profile&&Pe.maxTextureUnits<Jt+1&&(Pe.maxTextureUnits=Jt+1),this.unit=Jt,Be.activeTexture(33984+Jt),Be.bindTexture(this.target,this.texture)}return Jt},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&dr(this)}}),Xe.profile&&(Pe.getTotalTextureSize=function(){var Jt=0;return Object.keys(An).forEach(function(It){Jt+=An[It].stats.size}),Jt}),{create2D:function(Jt,It){function qt(Tr,Gr){var Vr=fr.texInfo;Ot.call(Vr);var xr=lt();return typeof Tr=="number"?Ut(xr,0|Tr,typeof Gr=="number"?0|Gr:0|Tr):Tr?(Gt(Vr,Tr),Qt(xr,Tr)):Ut(xr,1,1),Vr.genMipmaps&&(xr.mipmask=(xr.width<<1)-1),fr.mipmask=xr.mipmask,Mt(fr,xr),fr.internalformat=xr.internalformat,qt.width=xr.width,qt.height=xr.height,Kt(fr),Ie(xr,3553),ir(Vr,3553),or(),wt(xr),Xe.profile&&(fr.stats.size=w(fr.internalformat,fr.type,xr.width,xr.height,Vr.genMipmaps,!1)),qt.format=On[fr.internalformat],qt.type=Sn[fr.type],qt.mag=an[Vr.magFilter],qt.min=Nr[Vr.minFilter],qt.wrapS=Pr[Vr.wrapS],qt.wrapT=Pr[Vr.wrapT],qt}var fr=new Xt(3553);return An[fr.id]=fr,Pe.textureCount++,qt(Jt,It),qt.subimage=function(Tr,Gr,Vr,xr){Gr|=0,Vr|=0,xr|=0;var wr=it();return Mt(wr,fr),wr.width=0,wr.height=0,Dt(wr,Tr),wr.width=wr.width||(fr.width>>xr)-Gr,wr.height=wr.height||(fr.height>>xr)-Vr,Kt(fr),xt(wr,3553,Gr,Vr,xr),or(),St(wr),qt},qt.resize=function(Tr,Gr){var Vr=0|Tr,xr=0|Gr||Vr;if(Vr===fr.width&&xr===fr.height)return qt;qt.width=fr.width=Vr,qt.height=fr.height=xr,Kt(fr);for(var wr=0;fr.mipmask>>wr;++wr){var Sr=Vr>>wr,Mr=xr>>wr;if(!Sr||!Mr)break;Be.texImage2D(3553,wr,fr.format,Sr,Mr,0,fr.format,fr.type,null)}return or(),Xe.profile&&(fr.stats.size=w(fr.internalformat,fr.type,Vr,xr,!1,!1)),qt},qt._reglType="texture2d",qt._texture=fr,Xe.profile&&(qt.stats=fr.stats),qt.destroy=function(){fr.decRef()},qt},createCube:function(Jt,It,qt,fr,Tr,Gr){function Vr(Sr,Mr,Ir,qr,cn,_n){var Jr,bn=xr.texInfo;for(Ot.call(bn),Jr=0;6>Jr;++Jr)wr[Jr]=lt();if(typeof Sr!="number"&&Sr){if(typeof Sr=="object")if(Mr)Qt(wr[0],Sr),Qt(wr[1],Mr),Qt(wr[2],Ir),Qt(wr[3],qr),Qt(wr[4],cn),Qt(wr[5],_n);else if(Gt(bn,Sr),pt(xr,Sr),"faces"in Sr)for(Sr=Sr.faces,Jr=0;6>Jr;++Jr)Mt(wr[Jr],xr),Qt(wr[Jr],Sr[Jr]);else for(Jr=0;6>Jr;++Jr)Qt(wr[Jr],Sr)}else for(Sr=0|Sr||1,Jr=0;6>Jr;++Jr)Ut(wr[Jr],Sr,Sr);for(Mt(xr,wr[0]),xr.mipmask=bn.genMipmaps?(wr[0].width<<1)-1:wr[0].mipmask,xr.internalformat=wr[0].internalformat,Vr.width=wr[0].width,Vr.height=wr[0].height,Kt(xr),Jr=0;6>Jr;++Jr)Ie(wr[Jr],34069+Jr);for(ir(bn,34067),or(),Xe.profile&&(xr.stats.size=w(xr.internalformat,xr.type,Vr.width,Vr.height,bn.genMipmaps,!0)),Vr.format=On[xr.internalformat],Vr.type=Sn[xr.type],Vr.mag=an[bn.magFilter],Vr.min=Nr[bn.minFilter],Vr.wrapS=Pr[bn.wrapS],Vr.wrapT=Pr[bn.wrapT],Jr=0;6>Jr;++Jr)wt(wr[Jr]);return Vr}var xr=new Xt(34067);An[xr.id]=xr,Pe.cubeCount++;var wr=Array(6);return Vr(Jt,It,qt,fr,Tr,Gr),Vr.subimage=function(Sr,Mr,Ir,qr,cn){Ir|=0,qr|=0,cn|=0;var _n=it();return Mt(_n,xr),_n.width=0,_n.height=0,Dt(_n,Mr),_n.width=_n.width||(xr.width>>cn)-Ir,_n.height=_n.height||(xr.height>>cn)-qr,Kt(xr),xt(_n,34069+Sr,Ir,qr,cn),or(),St(_n),Vr},Vr.resize=function(Sr){if((Sr|=0)!==xr.width){Vr.width=xr.width=Sr,Vr.height=xr.height=Sr,Kt(xr);for(var Mr=0;6>Mr;++Mr)for(var Ir=0;xr.mipmask>>Ir;++Ir)Be.texImage2D(34069+Mr,Ir,xr.format,Sr>>Ir,Sr>>Ir,0,xr.format,xr.type,null);return or(),Xe.profile&&(xr.stats.size=w(xr.internalformat,xr.type,Vr.width,Vr.height,!1,!0)),Vr}},Vr._reglType="textureCube",Vr._texture=xr,Xe.profile&&(Vr.stats=xr.stats),Vr.destroy=function(){xr.decRef()},Vr},clear:function(){for(var Jt=0;Jt<En;++Jt)Be.activeTexture(33984+Jt),Be.bindTexture(3553,null),Bn[Jt]=null;he(An).forEach(dr),Pe.cubeCount=0,Pe.textureCount=0},getTexture:function(Jt){return null},restore:function(){for(var Jt=0;Jt<En;++Jt){var It=Bn[Jt];It&&(It.bindCount=0,It.unit=-1,Bn[Jt]=null)}he(An).forEach(function(qt){qt.texture=Be.createTexture(),Be.bindTexture(qt.target,qt.texture);for(var fr=0;32>fr;++fr)if((qt.mipmask&1<<fr)!=0)if(qt.target===3553)Be.texImage2D(3553,fr,qt.internalformat,qt.width>>fr,qt.height>>fr,0,qt.internalformat,qt.type,null);else for(var Tr=0;6>Tr;++Tr)Be.texImage2D(34069+Tr,fr,qt.internalformat,qt.width>>fr,qt.height>>fr,0,qt.internalformat,qt.type,null);ir(qt.texInfo,qt.target)})},refresh:function(){for(var Jt=0;Jt<En;++Jt){var It=Bn[Jt];It&&(It.bindCount=0,It.unit=-1,Bn[Jt]=null),Be.activeTexture(33984+Jt),Be.bindTexture(3553,null),Be.bindTexture(34067,null)}}}}function k(Be,Ke,_e,Ce,Le,Pe){function Xe(Xt,Kt,or){this.target=Xt,this.texture=Kt,this.renderbuffer=or;var dr=Xt=0;Kt?(Xt=Kt.width,dr=Kt.height):or&&(Xt=or.width,dr=or.height),this.width=Xt,this.height=dr}function ht(Xt){Xt&&(Xt.texture&&Xt.texture._texture.decRef(),Xt.renderbuffer&&Xt.renderbuffer._renderbuffer.decRef())}function Mt(Xt,Kt,or){Xt&&(Xt.texture?Xt.texture._texture.refCount+=1:Xt.renderbuffer._renderbuffer.refCount+=1)}function pt(Xt,Kt){Kt&&(Kt.texture?Be.framebufferTexture2D(36160,Xt,Kt.target,Kt.texture._texture.texture,0):Be.framebufferRenderbuffer(36160,Xt,36161,Kt.renderbuffer._renderbuffer.renderbuffer))}function Lt(Xt){var Kt=3553,or=null,dr=null,vr=Xt;return typeof Xt=="object"&&(vr=Xt.data,"target"in Xt&&(Kt=0|Xt.target)),(Xt=vr._reglType)==="texture2d"||Xt==="textureCube"?or=vr:Xt==="renderbuffer"&&(dr=vr,Kt=36161),new Xe(Kt,or,dr)}function vt(Xt,Kt,or,dr,vr){return or?((Xt=Ce.create2D({width:Xt,height:Kt,format:dr,type:vr}))._texture.refCount=0,new Xe(3553,Xt,null)):((Xt=Le.create({width:Xt,height:Kt,format:dr}))._renderbuffer.refCount=0,new Xe(36161,null,Xt))}function Dt(Xt){return Xt&&(Xt.texture||Xt.renderbuffer)}function xt(Xt,Kt,or){Xt&&(Xt.texture?Xt.texture.resize(Kt,or):Xt.renderbuffer&&Xt.renderbuffer.resize(Kt,or),Xt.width=Kt,Xt.height=or)}function it(){this.id=Gt++,ir[this.id]=this,this.framebuffer=Be.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function St(Xt){Xt.colorAttachments.forEach(ht),ht(Xt.depthAttachment),ht(Xt.stencilAttachment),ht(Xt.depthStencilAttachment)}function Nt(Xt){Be.deleteFramebuffer(Xt.framebuffer),Xt.framebuffer=null,Pe.framebufferCount--,delete ir[Xt.id]}function Ut(Xt){var Kt;Be.bindFramebuffer(36160,Xt.framebuffer);var or=Xt.colorAttachments;for(Kt=0;Kt<or.length;++Kt)pt(36064+Kt,or[Kt]);for(Kt=or.length;Kt<_e.maxColorAttachments;++Kt)Be.framebufferTexture2D(36160,36064+Kt,3553,null,0);Be.framebufferTexture2D(36160,33306,3553,null,0),Be.framebufferTexture2D(36160,36096,3553,null,0),Be.framebufferTexture2D(36160,36128,3553,null,0),pt(36096,Xt.depthAttachment),pt(36128,Xt.stencilAttachment),pt(33306,Xt.depthStencilAttachment),Be.checkFramebufferStatus(36160),Be.isContextLost(),Be.bindFramebuffer(36160,Ie.next?Ie.next.framebuffer:null),Ie.cur=Ie.next,Be.getError()}function Qt(Xt,Kt){function or(vr,ur){var pr,br=0,Rr=0,_r=!0,jr=!0;pr=null;var $r=!0,pn="rgba",In="uint8",On=1,Sn=null,an=null,Nr=null,Pr=!1;typeof vr=="number"?(br=0|vr,Rr=0|ur||br):vr?("shape"in vr?(br=(Rr=vr.shape)[0],Rr=Rr[1]):("radius"in vr&&(br=Rr=vr.radius),"width"in vr&&(br=vr.width),"height"in vr&&(Rr=vr.height)),("color"in vr||"colors"in vr)&&(pr=vr.color||vr.colors,Array.isArray(pr)),pr||("colorCount"in vr&&(On=0|vr.colorCount),"colorTexture"in vr&&($r=!!vr.colorTexture,pn="rgba4"),"colorType"in vr&&(In=vr.colorType,!$r)&&(In==="half float"||In==="float16"?pn="rgba16f":In!=="float"&&In!=="float32"||(pn="rgba32f")),"colorFormat"in vr&&(pn=vr.colorFormat,0<=lt.indexOf(pn)?$r=!0:0<=wt.indexOf(pn)&&($r=!1))),("depthTexture"in vr||"depthStencilTexture"in vr)&&(Pr=!(!vr.depthTexture&&!vr.depthStencilTexture)),"depth"in vr&&(typeof vr.depth=="boolean"?_r=vr.depth:(Sn=vr.depth,jr=!1)),"stencil"in vr&&(typeof vr.stencil=="boolean"?jr=vr.stencil:(an=vr.stencil,_r=!1)),"depthStencil"in vr&&(typeof vr.depthStencil=="boolean"?_r=jr=vr.depthStencil:(Nr=vr.depthStencil,jr=_r=!1))):br=Rr=1;var en=null,tn=null,Qr=null,rn=null;if(Array.isArray(pr))en=pr.map(Lt);else if(pr)en=[Lt(pr)];else for(en=Array(On),pr=0;pr<On;++pr)en[pr]=vt(br,Rr,$r,pn,In);for(br=br||en[0].width,Rr=Rr||en[0].height,Sn?tn=Lt(Sn):_r&&!jr&&(tn=vt(br,Rr,Pr,"depth","uint32")),an?Qr=Lt(an):jr&&!_r&&(Qr=vt(br,Rr,!1,"stencil","uint8")),Nr?rn=Lt(Nr):!Sn&&!an&&jr&&_r&&(rn=vt(br,Rr,Pr,"depth stencil","depth stencil")),_r=null,pr=0;pr<en.length;++pr)Mt(en[pr]),en[pr]&&en[pr].texture&&(jr=Pt[en[pr].texture._texture.format]*kt[en[pr].texture._texture.type],_r===null&&(_r=jr));return Mt(tn),Mt(Qr),Mt(rn),St(dr),dr.width=br,dr.height=Rr,dr.colorAttachments=en,dr.depthAttachment=tn,dr.stencilAttachment=Qr,dr.depthStencilAttachment=rn,or.color=en.map(Dt),or.depth=Dt(tn),or.stencil=Dt(Qr),or.depthStencil=Dt(rn),or.width=dr.width,or.height=dr.height,Ut(dr),or}var dr=new it;return Pe.framebufferCount++,or(Xt,Kt),j(or,{resize:function(vr,ur){var pr=Math.max(0|vr,1),br=Math.max(0|ur||pr,1);if(pr===dr.width&&br===dr.height)return or;for(var Rr=dr.colorAttachments,_r=0;_r<Rr.length;++_r)xt(Rr[_r],pr,br);return xt(dr.depthAttachment,pr,br),xt(dr.stencilAttachment,pr,br),xt(dr.depthStencilAttachment,pr,br),dr.width=or.width=pr,dr.height=or.height=br,Ut(dr),or},_reglType:"framebuffer",_framebuffer:dr,destroy:function(){Nt(dr),St(dr)},use:function(vr){Ie.setFBO({framebuffer:or},vr)}})}var Ie={cur:null,next:null,dirty:!1,setFBO:null},lt=["rgba"],wt=["rgba4","rgb565","rgb5 a1"];Ke.ext_srgb&&wt.push("srgba"),Ke.ext_color_buffer_half_float&&wt.push("rgba16f","rgb16f"),Ke.webgl_color_buffer_float&&wt.push("rgba32f");var Ot=["uint8"];Ke.oes_texture_half_float&&Ot.push("half float","float16"),Ke.oes_texture_float&&Ot.push("float","float32");var Gt=0,ir={};return j(Ie,{getFramebuffer:function(Xt){return typeof Xt=="function"&&Xt._reglType==="framebuffer"&&(Xt=Xt._framebuffer)instanceof it?Xt:null},create:Qt,createCube:function(Xt){function Kt(dr){var vr,ur={color:null},pr=0,br=null;vr="rgba";var Rr="uint8",_r=1;if(typeof dr=="number"?pr=0|dr:dr?("shape"in dr?pr=dr.shape[0]:("radius"in dr&&(pr=0|dr.radius),"width"in dr?pr=0|dr.width:"height"in dr&&(pr=0|dr.height)),("color"in dr||"colors"in dr)&&(br=dr.color||dr.colors,Array.isArray(br)),br||("colorCount"in dr&&(_r=0|dr.colorCount),"colorType"in dr&&(Rr=dr.colorType),"colorFormat"in dr&&(vr=dr.colorFormat)),"depth"in dr&&(ur.depth=dr.depth),"stencil"in dr&&(ur.stencil=dr.stencil),"depthStencil"in dr&&(ur.depthStencil=dr.depthStencil)):pr=1,br)if(Array.isArray(br))for(dr=[],vr=0;vr<br.length;++vr)dr[vr]=br[vr];else dr=[br];else for(dr=Array(_r),br={radius:pr,format:vr,type:Rr},vr=0;vr<_r;++vr)dr[vr]=Ce.createCube(br);for(ur.color=Array(dr.length),vr=0;vr<dr.length;++vr)_r=dr[vr],pr=pr||_r.width,ur.color[vr]={target:34069,data:dr[vr]};for(vr=0;6>vr;++vr){for(_r=0;_r<dr.length;++_r)ur.color[_r].target=34069+vr;0<vr&&(ur.depth=or[0].depth,ur.stencil=or[0].stencil,ur.depthStencil=or[0].depthStencil),or[vr]?or[vr](ur):or[vr]=Qt(ur)}return j(Kt,{width:pr,height:pr,color:dr})}var or=Array(6);return Kt(Xt),j(Kt,{faces:or,resize:function(dr){var vr=0|dr;if(vr===Kt.width)return Kt;var ur=Kt.color;for(dr=0;dr<ur.length;++dr)ur[dr].resize(vr);for(dr=0;6>dr;++dr)or[dr].resize(vr);return Kt.width=Kt.height=vr,Kt},_reglType:"framebufferCube",destroy:function(){or.forEach(function(dr){dr.destroy()})}})},clear:function(){he(ir).forEach(Nt)},restore:function(){Ie.cur=null,Ie.next=null,Ie.dirty=!0,he(ir).forEach(function(Xt){Xt.framebuffer=Be.createFramebuffer(),Ut(Xt)})}})}function L(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function M(Be,Ke,_e,Ce,Le,Pe,Xe){function ht(){this.id=++Lt,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var xt=Ke.oes_vertex_array_object;this.vao=xt?xt.createVertexArrayOES():null,vt[this.id]=this,this.buffers=[]}var Mt=_e.maxAttributes,pt=Array(Mt);for(_e=0;_e<Mt;++_e)pt[_e]=new L;var Lt=0,vt={},Dt={Record:L,scope:{},state:pt,currentVAO:null,targetVAO:null,restore:Ke.oes_vertex_array_object?function(){Ke.oes_vertex_array_object&&he(vt).forEach(function(xt){xt.refresh()})}:function(){},createVAO:function(xt){function it(Nt){var Ut;Array.isArray(Nt)?(Ut=Nt,St.elements&&St.ownsElements&&St.elements.destroy(),St.elements=null,St.ownsElements=!1,St.offset=0,St.count=0,St.instances=-1,St.primitive=4):(Nt.elements?(Ut=Nt.elements,St.ownsElements?(typeof Ut=="function"&&Ut._reglType==="elements"?St.elements.destroy():St.elements(Ut),St.ownsElements=!1):Pe.getElements(Nt.elements)?(St.elements=Nt.elements,St.ownsElements=!1):(St.elements=Pe.create(Nt.elements),St.ownsElements=!0)):(St.elements=null,St.ownsElements=!1),Ut=Nt.attributes,St.offset=0,St.count=-1,St.instances=-1,St.primitive=4,St.elements&&(St.count=St.elements._elements.vertCount,St.primitive=St.elements._elements.primType),"offset"in Nt&&(St.offset=0|Nt.offset),"count"in Nt&&(St.count=0|Nt.count),"instances"in Nt&&(St.instances=0|Nt.instances),"primitive"in Nt&&(St.primitive=xe[Nt.primitive])),Nt={};var Qt=St.attributes;Qt.length=Ut.length;for(var Ie=0;Ie<Ut.length;++Ie){var lt,wt=Ut[Ie],Ot=Qt[Ie]=new L,Gt=wt.data||wt;Array.isArray(Gt)||ae(Gt)||l(Gt)?(St.buffers[Ie]&&(lt=St.buffers[Ie],ae(Gt)&&lt._buffer.byteLength>=Gt.byteLength?lt.subdata(Gt):(lt.destroy(),St.buffers[Ie]=null)),St.buffers[Ie]||(lt=St.buffers[Ie]=Le.create(wt,34962,!1,!0)),Ot.buffer=Le.getBuffer(lt),Ot.size=0|Ot.buffer.dimension,Ot.normalized=!1,Ot.type=Ot.buffer.dtype,Ot.offset=0,Ot.stride=0,Ot.divisor=0,Ot.state=1,Nt[Ie]=1):Le.getBuffer(wt)?(Ot.buffer=Le.getBuffer(wt),Ot.size=0|Ot.buffer.dimension,Ot.normalized=!1,Ot.type=Ot.buffer.dtype,Ot.offset=0,Ot.stride=0,Ot.divisor=0,Ot.state=1):Le.getBuffer(wt.buffer)?(Ot.buffer=Le.getBuffer(wt.buffer),Ot.size=0|(+wt.size||Ot.buffer.dimension),Ot.normalized=!!wt.normalized||!1,Ot.type="type"in wt?ue[wt.type]:Ot.buffer.dtype,Ot.offset=0|(wt.offset||0),Ot.stride=0|(wt.stride||0),Ot.divisor=0|(wt.divisor||0),Ot.state=1):"x"in wt&&(Ot.x=+wt.x||0,Ot.y=+wt.y||0,Ot.z=+wt.z||0,Ot.w=+wt.w||0,Ot.state=2)}for(lt=0;lt<St.buffers.length;++lt)!Nt[lt]&&St.buffers[lt]&&(St.buffers[lt].destroy(),St.buffers[lt]=null);return St.refresh(),it}var St=new ht;return Ce.vaoCount+=1,it.destroy=function(){for(var Nt=0;Nt<St.buffers.length;++Nt)St.buffers[Nt]&&St.buffers[Nt].destroy();St.buffers.length=0,St.ownsElements&&(St.elements.destroy(),St.elements=null,St.ownsElements=!1),St.destroy()},it._vao=St,it._reglType="vao",it(xt)},getVAO:function(xt){return typeof xt=="function"&&xt._vao?xt._vao:null},destroyBuffer:function(xt){for(var it=0;it<pt.length;++it){var St=pt[it];St.buffer===xt&&(Be.disableVertexAttribArray(it),St.buffer=null)}},setVAO:Ke.oes_vertex_array_object?function(xt){if(xt!==Dt.currentVAO){var it=Ke.oes_vertex_array_object;xt?it.bindVertexArrayOES(xt.vao):it.bindVertexArrayOES(null),Dt.currentVAO=xt}}:function(xt){if(xt!==Dt.currentVAO){if(xt)xt.bindAttrs();else{for(var it=Ke.angle_instanced_arrays,St=0;St<pt.length;++St){var Nt=pt[St];Nt.buffer?(Be.enableVertexAttribArray(St),Nt.buffer.bind(),Be.vertexAttribPointer(St,Nt.size,Nt.type,Nt.normalized,Nt.stride,Nt.offfset),it&&Nt.divisor&&it.vertexAttribDivisorANGLE(St,Nt.divisor)):(Be.disableVertexAttribArray(St),Be.vertexAttrib4f(St,Nt.x,Nt.y,Nt.z,Nt.w))}Xe.elements?Be.bindBuffer(34963,Xe.elements.buffer.buffer):Be.bindBuffer(34963,null)}Dt.currentVAO=xt}},clear:Ke.oes_vertex_array_object?function(){he(vt).forEach(function(xt){xt.destroy()})}:function(){}};return ht.prototype.bindAttrs=function(){for(var xt=Ke.angle_instanced_arrays,it=this.attributes,St=0;St<it.length;++St){var Nt=it[St];Nt.buffer?(Be.enableVertexAttribArray(St),Be.bindBuffer(34962,Nt.buffer.buffer),Be.vertexAttribPointer(St,Nt.size,Nt.type,Nt.normalized,Nt.stride,Nt.offset),xt&&Nt.divisor&&xt.vertexAttribDivisorANGLE(St,Nt.divisor)):(Be.disableVertexAttribArray(St),Be.vertexAttrib4f(St,Nt.x,Nt.y,Nt.z,Nt.w))}for(xt=it.length;xt<Mt;++xt)Be.disableVertexAttribArray(xt);(xt=Pe.getElements(this.elements))?Be.bindBuffer(34963,xt.buffer.buffer):Be.bindBuffer(34963,null)},ht.prototype.refresh=function(){var xt=Ke.oes_vertex_array_object;xt&&(xt.bindVertexArrayOES(this.vao),this.bindAttrs(),Dt.currentVAO=null,xt.bindVertexArrayOES(null))},ht.prototype.destroy=function(){if(this.vao){var xt=Ke.oes_vertex_array_object;this===Dt.currentVAO&&(Dt.currentVAO=null,xt.bindVertexArrayOES(null)),xt.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),vt[this.id]&&(delete vt[this.id],--Ce.vaoCount)},Dt}function P(Be,Ke,_e,Ce){function Le(it,St,Nt,Ut){this.name=it,this.id=St,this.location=Nt,this.info=Ut}function Pe(it,St){for(var Nt=0;Nt<it.length;++Nt)if(it[Nt].id===St.id)return void(it[Nt].location=St.location);it.push(St)}function Xe(it,St,Nt){if(!(Qt=(Nt=it===35632?pt:Lt)[St])){var Ut=Ke.str(St),Qt=Be.createShader(it);Be.shaderSource(Qt,Ut),Be.compileShader(Qt),Nt[St]=Qt}return Qt}function ht(it,St){this.id=xt++,this.fragId=it,this.vertId=St,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Ce.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Mt(it,St,Nt){var Ut;Ut=Xe(35632,it.fragId);var Qt=Xe(35633,it.vertId);if(St=it.program=Be.createProgram(),Be.attachShader(St,Ut),Be.attachShader(St,Qt),Nt)for(Ut=0;Ut<Nt.length;++Ut)Qt=Nt[Ut],Be.bindAttribLocation(St,Qt[0],Qt[1]);Be.linkProgram(St),Qt=Be.getProgramParameter(St,35718),Ce.profile&&(it.stats.uniformsCount=Qt);var Ie=it.uniforms;for(Ut=0;Ut<Qt;++Ut)if(Nt=Be.getActiveUniform(St,Ut)){if(1<Nt.size)for(var lt=0;lt<Nt.size;++lt){var wt=Nt.name.replace("[0]","["+lt+"]");Pe(Ie,new Le(wt,Ke.id(wt),Be.getUniformLocation(St,wt),Nt))}lt=Nt.name,1<Nt.size&&(lt=lt.replace("[0]","")),Pe(Ie,new Le(lt,Ke.id(lt),Be.getUniformLocation(St,lt),Nt))}for(Qt=Be.getProgramParameter(St,35721),Ce.profile&&(it.stats.attributesCount=Qt),it=it.attributes,Ut=0;Ut<Qt;++Ut)(Nt=Be.getActiveAttrib(St,Ut))&&Pe(it,new Le(Nt.name,Ke.id(Nt.name),Be.getAttribLocation(St,Nt.name),Nt))}var pt={},Lt={},vt={},Dt=[],xt=0;return Ce.profile&&(_e.getMaxUniformsCount=function(){var it=0;return Dt.forEach(function(St){St.stats.uniformsCount>it&&(it=St.stats.uniformsCount)}),it},_e.getMaxAttributesCount=function(){var it=0;return Dt.forEach(function(St){St.stats.attributesCount>it&&(it=St.stats.attributesCount)}),it}),{clear:function(){var it=Be.deleteShader.bind(Be);he(pt).forEach(it),pt={},he(Lt).forEach(it),Lt={},Dt.forEach(function(St){Be.deleteProgram(St.program)}),Dt.length=0,vt={},_e.shaderCount=0},program:function(it,St,Nt,Ut){var Qt=vt[St];Qt||(Qt=vt[St]={});var Ie=Qt[it];if(Ie&&(Ie.refCount++,!Ut))return Ie;var lt=new ht(St,it);return _e.shaderCount++,Mt(lt,Nt,Ut),Ie||(Qt[it]=lt),Dt.push(lt),j(lt,{destroy:function(){if(lt.refCount--,0>=lt.refCount){Be.deleteProgram(lt.program);var wt=Dt.indexOf(lt);Dt.splice(wt,1),_e.shaderCount--}0>=Qt[lt.vertId].refCount&&(Be.deleteShader(Lt[lt.vertId]),delete Lt[lt.vertId],delete vt[lt.fragId][lt.vertId]),Object.keys(vt[lt.fragId]).length||(Be.deleteShader(pt[lt.fragId]),delete pt[lt.fragId],delete vt[lt.fragId])}})},restore:function(){pt={},Lt={};for(var it=0;it<Dt.length;++it)Mt(Dt[it],null,Dt[it].attributes.map(function(St){return[St.location,St.name]}))},shader:Xe,frag:-1,vert:-1}}function D(Be,Ke,_e,Ce,Le,Pe,Xe){function ht(Mt){var pt;pt=Ke.next===null?5121:Ke.next.colorAttachments[0].texture._texture.type;var Lt=0,vt=0,Dt=Ce.framebufferWidth,xt=Ce.framebufferHeight,it=null;return ae(Mt)?it=Mt:Mt&&(Lt=0|Mt.x,vt=0|Mt.y,Dt=0|(Mt.width||Ce.framebufferWidth-Lt),xt=0|(Mt.height||Ce.framebufferHeight-vt),it=Mt.data||null),_e(),Mt=Dt*xt*4,it||(pt===5121?it=new Uint8Array(Mt):pt===5126&&(it=it||new Float32Array(Mt))),Be.pixelStorei(3333,4),Be.readPixels(Lt,vt,Dt,xt,6408,pt,it),it}return function(Mt){return Mt&&"framebuffer"in Mt?function(pt){var Lt;return Ke.setFBO({framebuffer:pt.framebuffer},function(){Lt=ht(pt)}),Lt}(Mt):ht(Mt)}}function N(Be){return Array.prototype.slice.call(Be)}function U(Be){return N(Be).join("")}function q(Be){return Array.isArray(Be)||ae(Be)||l(Be)}function X(Be){return Be.sort(function(Ke,_e){return Ke==="viewport"?-1:_e==="viewport"?1:Ke<_e?-1:1})}function K(Be,Ke,_e,Ce){this.thisDep=Be,this.contextDep=Ke,this.propDep=_e,this.append=Ce}function Z(Be){return Be&&!(Be.thisDep||Be.contextDep||Be.propDep)}function H(Be){return new K(!1,!1,!1,Be)}function Y(Be,Ke){var _e=Be.type;if(_e===0)return new K(!0,1<=(_e=Be.data.length),2<=_e,Ke);if(_e===4)return new K((_e=Be.data).thisDep,_e.contextDep,_e.propDep,Ke);if(_e===5)return new K(!1,!1,!1,Ke);if(_e===6){for(var Ce=_e=!1,Le=!1,Pe=0;Pe<Be.data.length;++Pe){var Xe=Be.data[Pe];Xe.type===1?Le=!0:Xe.type===2?Ce=!0:Xe.type===3?_e=!0:Xe.type===0?(_e=!0,1<=(Xe=Xe.data)&&(Ce=!0),2<=Xe&&(Le=!0)):Xe.type===4&&(_e=_e||Xe.data.thisDep,Ce=Ce||Xe.data.contextDep,Le=Le||Xe.data.propDep)}return new K(_e,Ce,Le,Ke)}return new K(_e===3,_e===2,_e===1,Ke)}function $(Be,Ke,_e,Ce,Le,Pe,Xe,ht,Mt,pt,Lt,vt,Dt,xt,it){function St(It){return It.replace(".","_")}function Nt(It,qt,fr){var Tr=St(It);Qr.push(It),tn[Tr]=en[Tr]=!!fr,rn[Tr]=qt}function Ut(It,qt,fr){var Tr=St(It);Qr.push(It),Array.isArray(fr)?(en[Tr]=fr.slice(),tn[Tr]=fr.slice()):en[Tr]=tn[Tr]=fr,An[Tr]=qt}function Qt(){var It=function(){function Mr(){var Dr=[],Wr=[];return j(function(){Dr.push.apply(Dr,N(arguments))},{def:function(){var vn="v"+qr++;return Wr.push(vn),0<arguments.length&&(Dr.push(vn,"="),Dr.push.apply(Dr,N(arguments)),Dr.push(";")),vn},toString:function(){return U([0<Wr.length?"var "+Wr.join(",")+";":"",U(Dr)])}})}function Ir(){function Dr(sa,Yn){vn(sa,Yn,"=",Wr.def(sa,Yn),";")}var Wr=Mr(),vn=Mr(),dn=Wr.toString,Pn=vn.toString;return j(function(){Wr.apply(Wr,N(arguments))},{def:Wr.def,entry:Wr,exit:vn,save:Dr,set:function(sa,Yn,yn){Dr(sa,Yn),Wr(sa,Yn,"=",yn,";")},toString:function(){return dn()+Pn()}})}var qr=0,cn=[],_n=[],Jr=Mr(),bn={};return{global:Jr,link:function(Dr){for(var Wr=0;Wr<_n.length;++Wr)if(_n[Wr]===Dr)return cn[Wr];return Wr="g"+qr++,cn.push(Wr),_n.push(Dr),Wr},block:Mr,proc:function(Dr,Wr){function vn(){var Yn="a"+dn.length;return dn.push(Yn),Yn}var dn=[];Wr=Wr||0;for(var Pn=0;Pn<Wr;++Pn)vn();var sa=(Pn=Ir()).toString;return bn[Dr]=j(Pn,{arg:vn,toString:function(){return U(["function(",dn.join(),"){",sa(),"}"])}})},scope:Ir,cond:function(){var Dr=U(arguments),Wr=Ir(),vn=Ir(),dn=Wr.toString,Pn=vn.toString;return j(Wr,{then:function(){return Wr.apply(Wr,N(arguments)),this},else:function(){return vn.apply(vn,N(arguments)),this},toString:function(){var sa=Pn();return sa&&(sa="else{"+sa+"}"),U(["if(",Dr,"){",dn(),"}",sa])}})},compile:function(){var Dr=['"use strict";',Jr,"return {"];Object.keys(bn).forEach(function(vn){Dr.push('"',vn,'":',bn[vn].toString(),",")}),Dr.push("}");var Wr=U(Dr).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`);return Function.apply(null,cn.concat(Wr)).apply(null,_n)}}}(),qt=It.link,fr=It.global;It.id=Jt++,It.batchId="0";var Tr=qt(En),Gr=It.shared={props:"a0"};Object.keys(En).forEach(function(Mr){Gr[Mr]=fr.def(Tr,".",Mr)});var Vr=It.next={},xr=It.current={};Object.keys(An).forEach(function(Mr){Array.isArray(en[Mr])&&(Vr[Mr]=fr.def(Gr.next,".",Mr),xr[Mr]=fr.def(Gr.current,".",Mr))});var wr=It.constants={};Object.keys(Bn).forEach(function(Mr){wr[Mr]=fr.def(JSON.stringify(Bn[Mr]))}),It.invoke=function(Mr,Ir){switch(Ir.type){case 0:var qr=["this",Gr.context,Gr.props,It.batchId];return Mr.def(qt(Ir.data),".call(",qr.slice(0,Math.max(Ir.data.length+1,4)),")");case 1:return Mr.def(Gr.props,Ir.data);case 2:return Mr.def(Gr.context,Ir.data);case 3:return Mr.def("this",Ir.data);case 4:return Ir.data.append(It,Mr),Ir.data.ref;case 5:return Ir.data.toString();case 6:return Ir.data.map(function(cn){return It.invoke(Mr,cn)})}},It.attribCache={};var Sr={};return It.scopeAttrib=function(Mr){if((Mr=Ke.id(Mr))in Sr)return Sr[Mr];var Ir=pt.scope[Mr];return Ir||(Ir=pt.scope[Mr]=new On),Sr[Mr]=qt(Ir)},It}function Ie(It,qt){var fr=It.static,Tr=It.dynamic;if("framebuffer"in fr){var Gr=fr.framebuffer;return Gr?(Gr=ht.getFramebuffer(Gr),H(function(xr,wr){var Sr=xr.link(Gr),Mr=xr.shared;return wr.set(Mr.framebuffer,".next",Sr),Mr=Mr.context,wr.set(Mr,".framebufferWidth",Sr+".width"),wr.set(Mr,".framebufferHeight",Sr+".height"),Sr})):H(function(xr,wr){var Sr=xr.shared;return wr.set(Sr.framebuffer,".next","null"),Sr=Sr.context,wr.set(Sr,".framebufferWidth",Sr+".drawingBufferWidth"),wr.set(Sr,".framebufferHeight",Sr+".drawingBufferHeight"),"null"})}if("framebuffer"in Tr){var Vr=Tr.framebuffer;return Y(Vr,function(xr,wr){var Sr=xr.invoke(wr,Vr),Mr=xr.shared,Ir=Mr.framebuffer;return Sr=wr.def(Ir,".getFramebuffer(",Sr,")"),wr.set(Ir,".next",Sr),Mr=Mr.context,wr.set(Mr,".framebufferWidth",Sr+"?"+Sr+".width:"+Mr+".drawingBufferWidth"),wr.set(Mr,".framebufferHeight",Sr+"?"+Sr+".height:"+Mr+".drawingBufferHeight"),Sr})}return null}function lt(It,qt,fr){function Tr(Mr){if(Mr in Gr){var Ir=Ke.id(Gr[Mr]);return(Mr=H(function(){return Ir})).id=Ir,Mr}if(Mr in Vr){var qr=Vr[Mr];return Y(qr,function(cn,_n){var Jr=cn.invoke(_n,qr);return _n.def(cn.shared.strings,".id(",Jr,")")})}return null}var Gr=It.static,Vr=It.dynamic,xr=Tr("frag"),wr=Tr("vert"),Sr=null;return Z(xr)&&Z(wr)?(Sr=Lt.program(wr.id,xr.id,null,fr),It=H(function(Mr,Ir){return Mr.link(Sr)})):It=new K(xr&&xr.thisDep||wr&&wr.thisDep,xr&&xr.contextDep||wr&&wr.contextDep,xr&&xr.propDep||wr&&wr.propDep,function(Mr,Ir){var qr,cn,_n=Mr.shared.shader;return qr=xr?xr.append(Mr,Ir):Ir.def(_n,".","frag"),cn=wr?wr.append(Mr,Ir):Ir.def(_n,".","vert"),Ir.def(_n+".program("+cn+","+qr+")")}),{frag:xr,vert:wr,progVar:It,program:Sr}}function wt(It,qt){function fr(Jr,bn){if(Jr in Tr){var Dr=0|Tr[Jr];return bn?Vr.offset=Dr:Vr.instances=Dr,H(function(vn,dn){return bn&&(vn.OFFSET=Dr),Dr})}if(Jr in Gr){var Wr=Gr[Jr];return Y(Wr,function(vn,dn){var Pn=vn.invoke(dn,Wr);return bn&&(vn.OFFSET=Pn),Pn})}if(bn){if(Sr)return H(function(vn,dn){return vn.OFFSET=0});if(xr)return new K(wr.thisDep,wr.contextDep,wr.propDep,function(vn,dn){return dn.def(vn.shared.vao+".currentVAO?"+vn.shared.vao+".currentVAO.offset:0")})}else if(xr)return new K(wr.thisDep,wr.contextDep,wr.propDep,function(vn,dn){return dn.def(vn.shared.vao+".currentVAO?"+vn.shared.vao+".currentVAO.instances:-1")});return null}var Tr=It.static,Gr=It.dynamic,Vr={},xr=!1,wr=function(){if("vao"in Tr){var Jr=Tr.vao;return Jr!==null&&pt.getVAO(Jr)===null&&(Jr=pt.createVAO(Jr)),xr=!0,Vr.vao=Jr,H(function(Dr){var Wr=pt.getVAO(Jr);return Wr?Dr.link(Wr):"null"})}if("vao"in Gr){xr=!0;var bn=Gr.vao;return Y(bn,function(Dr,Wr){var vn=Dr.invoke(Wr,bn);return Wr.def(Dr.shared.vao+".getVAO("+vn+")")})}return null}(),Sr=!1,Mr=function(){if("elements"in Tr){var Jr=Tr.elements;if(Vr.elements=Jr,q(Jr)){var bn=Vr.elements=Pe.create(Jr,!0);Jr=Pe.getElements(bn),Sr=!0}else Jr&&(Jr=Pe.getElements(Jr),Sr=!0);return(bn=H(function(Wr,vn){if(Jr){var dn=Wr.link(Jr);return Wr.ELEMENTS=dn}return Wr.ELEMENTS=null})).value=Jr,bn}if("elements"in Gr){Sr=!0;var Dr=Gr.elements;return Y(Dr,function(Wr,vn){var dn=(Pn=Wr.shared).isBufferArgs,Pn=Pn.elements,sa=Wr.invoke(vn,Dr),Yn=vn.def("null");return dn=vn.def(dn,"(",sa,")"),sa=Wr.cond(dn).then(Yn,"=",Pn,".createStream(",sa,");").else(Yn,"=",Pn,".getElements(",sa,");"),vn.entry(sa),vn.exit(Wr.cond(dn).then(Pn,".destroyStream(",Yn,");")),Wr.ELEMENTS=Yn})}return xr?new K(wr.thisDep,wr.contextDep,wr.propDep,function(Wr,vn){return vn.def(Wr.shared.vao+".currentVAO?"+Wr.shared.elements+".getElements("+Wr.shared.vao+".currentVAO.elements):null")}):null}(),Ir=fr("offset",!0),qr=function(){if("primitive"in Tr){var Jr=Tr.primitive;return Vr.primitive=Jr,H(function(Dr,Wr){return xe[Jr]})}if("primitive"in Gr){var bn=Gr.primitive;return Y(bn,function(Dr,Wr){var vn=Dr.constants.primTypes,dn=Dr.invoke(Wr,bn);return Wr.def(vn,"[",dn,"]")})}return Sr?Z(Mr)?Mr.value?H(function(Dr,Wr){return Wr.def(Dr.ELEMENTS,".primType")}):H(function(){return 4}):new K(Mr.thisDep,Mr.contextDep,Mr.propDep,function(Dr,Wr){var vn=Dr.ELEMENTS;return Wr.def(vn,"?",vn,".primType:",4)}):xr?new K(wr.thisDep,wr.contextDep,wr.propDep,function(Dr,Wr){return Wr.def(Dr.shared.vao+".currentVAO?"+Dr.shared.vao+".currentVAO.primitive:4")}):null}(),cn=function(){if("count"in Tr){var Jr=0|Tr.count;return Vr.count=Jr,H(function(){return Jr})}if("count"in Gr){var bn=Gr.count;return Y(bn,function(Dr,Wr){return Dr.invoke(Wr,bn)})}return Sr?Z(Mr)?Mr?Ir?new K(Ir.thisDep,Ir.contextDep,Ir.propDep,function(Dr,Wr){return Wr.def(Dr.ELEMENTS,".vertCount-",Dr.OFFSET)}):H(function(Dr,Wr){return Wr.def(Dr.ELEMENTS,".vertCount")}):H(function(){return-1}):new K(Mr.thisDep||Ir.thisDep,Mr.contextDep||Ir.contextDep,Mr.propDep||Ir.propDep,function(Dr,Wr){var vn=Dr.ELEMENTS;return Dr.OFFSET?Wr.def(vn,"?",vn,".vertCount-",Dr.OFFSET,":-1"):Wr.def(vn,"?",vn,".vertCount:-1")}):xr?new K(wr.thisDep,wr.contextDep,wr.propDep,function(Dr,Wr){return Wr.def(Dr.shared.vao,".currentVAO?",Dr.shared.vao,".currentVAO.count:-1")}):null}(),_n=fr("instances",!1);return{elements:Mr,primitive:qr,count:cn,instances:_n,offset:Ir,vao:wr,vaoActive:xr,elementsActive:Sr,static:Vr}}function Ot(It,qt){var fr=It.static,Tr=It.dynamic,Gr={};return Object.keys(fr).forEach(function(Vr){var xr=fr[Vr],wr=Ke.id(Vr),Sr=new On;if(q(xr))Sr.state=1,Sr.buffer=Le.getBuffer(Le.create(xr,34962,!1,!0)),Sr.type=0;else if(Ir=Le.getBuffer(xr))Sr.state=1,Sr.buffer=Ir,Sr.type=0;else if("constant"in xr){var Mr=xr.constant;Sr.buffer="null",Sr.state=2,typeof Mr=="number"?Sr.x=Mr:at.forEach(function(Dr,Wr){Wr<Mr.length&&(Sr[Dr]=Mr[Wr])})}else{var Ir=q(xr.buffer)?Le.getBuffer(Le.create(xr.buffer,34962,!1,!0)):Le.getBuffer(xr.buffer),qr=0|xr.offset,cn=0|xr.stride,_n=0|xr.size,Jr=!!xr.normalized,bn=0;"type"in xr&&(bn=ue[xr.type]),xr=0|xr.divisor,Sr.buffer=Ir,Sr.state=1,Sr.size=_n,Sr.normalized=Jr,Sr.type=bn||Ir.dtype,Sr.offset=qr,Sr.stride=cn,Sr.divisor=xr}Gr[Vr]=H(function(Dr,Wr){var vn=Dr.attribCache;if(wr in vn)return vn[wr];var dn={isStream:!1};return Object.keys(Sr).forEach(function(Pn){dn[Pn]=Sr[Pn]}),Sr.buffer&&(dn.buffer=Dr.link(Sr.buffer),dn.type=dn.type||dn.buffer+".dtype"),vn[wr]=dn})}),Object.keys(Tr).forEach(function(Vr){var xr=Tr[Vr];Gr[Vr]=Y(xr,function(wr,Sr){function Mr(vn){Sr(Jr[vn],"=",Ir,".",vn,"|0;")}var Ir=wr.invoke(Sr,xr),qr=wr.shared,cn=wr.constants,_n=qr.isBufferArgs,Jr=(qr=qr.buffer,{isStream:Sr.def(!1)}),bn=new On;bn.state=1,Object.keys(bn).forEach(function(vn){Jr[vn]=Sr.def(""+bn[vn])});var Dr=Jr.buffer,Wr=Jr.type;return Sr("if(",_n,"(",Ir,")){",Jr.isStream,"=true;",Dr,"=",qr,".createStream(",34962,",",Ir,");",Wr,"=",Dr,".dtype;","}else{",Dr,"=",qr,".getBuffer(",Ir,");","if(",Dr,"){",Wr,"=",Dr,".dtype;",'}else if("constant" in ',Ir,"){",Jr.state,"=",2,";","if(typeof "+Ir+'.constant === "number"){',Jr[at[0]],"=",Ir,".constant;",at.slice(1).map(function(vn){return Jr[vn]}).join("="),"=0;","}else{",at.map(function(vn,dn){return Jr[vn]+"="+Ir+".constant.length>"+dn+"?"+Ir+".constant["+dn+"]:0;"}).join(""),"}}else{","if(",_n,"(",Ir,".buffer)){",Dr,"=",qr,".createStream(",34962,",",Ir,".buffer);","}else{",Dr,"=",qr,".getBuffer(",Ir,".buffer);","}",Wr,'="type" in ',Ir,"?",cn.glTypes,"[",Ir,".type]:",Dr,".dtype;",Jr.normalized,"=!!",Ir,".normalized;"),Mr("size"),Mr("offset"),Mr("stride"),Mr("divisor"),Sr("}}"),Sr.exit("if(",Jr.isStream,"){",qr,".destroyStream(",Dr,");","}"),Jr})}),Gr}function Gt(It,qt,fr,Tr,Gr){function Vr(bn){var Dr=wr[bn];Dr&&(Mr[bn]=Dr)}var xr=function(bn,Dr){if(typeof(Wr=bn.static).frag=="string"&&typeof Wr.vert=="string"){if(0<Object.keys(Dr.dynamic).length)return null;var Wr=Dr.static,vn=Object.keys(Wr);if(0<vn.length&&typeof Wr[vn[0]]=="number"){for(var dn=[],Pn=0;Pn<vn.length;++Pn)dn.push([0|Wr[vn[Pn]],vn[Pn]]);return dn}}return null}(It,qt),wr=function(bn,Dr,Wr){function vn(Yn){if(Yn in dn){var yn=dn[Yn];Yn=!0;var ra,pa,Qa=0|yn.x,Fi=0|yn.y;return"width"in yn?ra=0|yn.width:Yn=!1,"height"in yn?pa=0|yn.height:Yn=!1,new K(!Yn&&Dr&&Dr.thisDep,!Yn&&Dr&&Dr.contextDep,!Yn&&Dr&&Dr.propDep,function(ki,Ea){var Ga=ki.shared.context,ko=ra;"width"in yn||(ko=Ea.def(Ga,".","framebufferWidth","-",Qa));var Qo=pa;return"height"in yn||(Qo=Ea.def(Ga,".","framebufferHeight","-",Fi)),[Qa,Fi,ko,Qo]})}if(Yn in Pn){var li=Pn[Yn];return Yn=Y(li,function(ki,Ea){var Ga=ki.invoke(Ea,li),ko=ki.shared.context,Qo=Ea.def(Ga,".x|0"),us=Ea.def(Ga,".y|0");return[Qo,us,Ea.def('"width" in ',Ga,"?",Ga,".width|0:","(",ko,".","framebufferWidth","-",Qo,")"),Ga=Ea.def('"height" in ',Ga,"?",Ga,".height|0:","(",ko,".","framebufferHeight","-",us,")")]}),Dr&&(Yn.thisDep=Yn.thisDep||Dr.thisDep,Yn.contextDep=Yn.contextDep||Dr.contextDep,Yn.propDep=Yn.propDep||Dr.propDep),Yn}return Dr?new K(Dr.thisDep,Dr.contextDep,Dr.propDep,function(ki,Ea){var Ga=ki.shared.context;return[0,0,Ea.def(Ga,".","framebufferWidth"),Ea.def(Ga,".","framebufferHeight")]}):null}var dn=bn.static,Pn=bn.dynamic;if(bn=vn("viewport")){var sa=bn;bn=new K(bn.thisDep,bn.contextDep,bn.propDep,function(Yn,yn){var ra=sa.append(Yn,yn),pa=Yn.shared.context;return yn.set(pa,".viewportWidth",ra[2]),yn.set(pa,".viewportHeight",ra[3]),ra})}return{viewport:bn,scissor_box:vn("scissor.box")}}(It,qr=Ie(It)),Sr=wt(It),Mr=function(bn,Dr){var Wr=bn.static,vn=bn.dynamic,dn={};return Qr.forEach(function(Pn){function sa(yn,ra){if(Pn in Wr){var pa=yn(Wr[Pn]);dn[Yn]=H(function(){return pa})}else if(Pn in vn){var Qa=vn[Pn];dn[Yn]=Y(Qa,function(Fi,li){return ra(Fi,li,Fi.invoke(li,Qa))})}}var Yn=St(Pn);switch(Pn){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return sa(function(yn){return yn},function(yn,ra,pa){return pa});case"depth.func":return sa(function(yn){return er[yn]},function(yn,ra,pa){return ra.def(yn.constants.compareFuncs,"[",pa,"]")});case"depth.range":return sa(function(yn){return yn},function(yn,ra,pa){return[ra.def("+",pa,"[0]"),ra=ra.def("+",pa,"[1]")]});case"blend.func":return sa(function(yn){return[_t["srcRGB"in yn?yn.srcRGB:yn.src],_t["dstRGB"in yn?yn.dstRGB:yn.dst],_t["srcAlpha"in yn?yn.srcAlpha:yn.src],_t["dstAlpha"in yn?yn.dstAlpha:yn.dst]]},function(yn,ra,pa){function Qa(Ea,Ga){return ra.def('"',Ea,Ga,'" in ',pa,"?",pa,".",Ea,Ga,":",pa,".",Ea)}yn=yn.constants.blendFuncs;var Fi=Qa("src","RGB"),li=Qa("dst","RGB"),ki=(Fi=ra.def(yn,"[",Fi,"]"),ra.def(yn,"[",Qa("src","Alpha"),"]"));return[Fi,li=ra.def(yn,"[",li,"]"),ki,yn=ra.def(yn,"[",Qa("dst","Alpha"),"]")]});case"blend.equation":return sa(function(yn){return typeof yn=="string"?[Sn[yn],Sn[yn]]:typeof yn=="object"?[Sn[yn.rgb],Sn[yn.alpha]]:void 0},function(yn,ra,pa){var Qa=yn.constants.blendEquations,Fi=ra.def(),li=ra.def();return(yn=yn.cond("typeof ",pa,'==="string"')).then(Fi,"=",li,"=",Qa,"[",pa,"];"),yn.else(Fi,"=",Qa,"[",pa,".rgb];",li,"=",Qa,"[",pa,".alpha];"),ra(yn),[Fi,li]});case"blend.color":return sa(function(yn){return f(4,function(ra){return+yn[ra]})},function(yn,ra,pa){return f(4,function(Qa){return ra.def("+",pa,"[",Qa,"]")})});case"stencil.mask":return sa(function(yn){return 0|yn},function(yn,ra,pa){return ra.def(pa,"|0")});case"stencil.func":return sa(function(yn){return[er[yn.cmp||"keep"],yn.ref||0,"mask"in yn?yn.mask:-1]},function(yn,ra,pa){return[yn=ra.def('"cmp" in ',pa,"?",yn.constants.compareFuncs,"[",pa,".cmp]",":",7680),ra.def(pa,".ref|0"),ra=ra.def('"mask" in ',pa,"?",pa,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return sa(function(yn){return[Pn==="stencil.opBack"?1029:1028,tr[yn.fail||"keep"],tr[yn.zfail||"keep"],tr[yn.zpass||"keep"]]},function(yn,ra,pa){function Qa(li){return ra.def('"',li,'" in ',pa,"?",Fi,"[",pa,".",li,"]:",7680)}var Fi=yn.constants.stencilOps;return[Pn==="stencil.opBack"?1029:1028,Qa("fail"),Qa("zfail"),Qa("zpass")]});case"polygonOffset.offset":return sa(function(yn){return[0|yn.factor,0|yn.units]},function(yn,ra,pa){return[ra.def(pa,".factor|0"),ra=ra.def(pa,".units|0")]});case"cull.face":return sa(function(yn){var ra=0;return yn==="front"?ra=1028:yn==="back"&&(ra=1029),ra},function(yn,ra,pa){return ra.def(pa,'==="front"?',1028,":",1029)});case"lineWidth":return sa(function(yn){return yn},function(yn,ra,pa){return pa});case"frontFace":return sa(function(yn){return Ue[yn]},function(yn,ra,pa){return ra.def(pa+'==="cw"?2304:2305')});case"colorMask":return sa(function(yn){return yn.map(function(ra){return!!ra})},function(yn,ra,pa){return f(4,function(Qa){return"!!"+pa+"["+Qa+"]"})});case"sample.coverage":return sa(function(yn){return["value"in yn?yn.value:1,!!yn.invert]},function(yn,ra,pa){return[ra.def('"value" in ',pa,"?+",pa,".value:1"),ra=ra.def("!!",pa,".invert")]})}}),dn}(It),Ir=lt(It,0,xr);Vr("viewport"),Vr(St("scissor.box"));var qr,cn=0<Object.keys(Mr).length;if((qr={framebuffer:qr,draw:Sr,shader:Ir,state:Mr,dirty:cn,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}}).profile=function(bn){var Dr,Wr=bn.static;if(bn=bn.dynamic,"profile"in Wr){var vn=!!Wr.profile;(Dr=H(function(Pn,sa){return vn})).enable=vn}else if("profile"in bn){var dn=bn.profile;Dr=Y(dn,function(Pn,sa){return Pn.invoke(sa,dn)})}return Dr}(It),qr.uniforms=function(bn,Dr){var Wr=bn.static,vn=bn.dynamic,dn={};return Object.keys(Wr).forEach(function(Pn){var sa,Yn=Wr[Pn];if(typeof Yn=="number"||typeof Yn=="boolean")sa=H(function(){return Yn});else if(typeof Yn=="function"){var yn=Yn._reglType;yn==="texture2d"||yn==="textureCube"?sa=H(function(ra){return ra.link(Yn)}):yn!=="framebuffer"&&yn!=="framebufferCube"||(sa=H(function(ra){return ra.link(Yn.color[0])}))}else y(Yn)&&(sa=H(function(ra){return ra.global.def("[",f(Yn.length,function(pa){return Yn[pa]}),"]")}));sa.value=Yn,dn[Pn]=sa}),Object.keys(vn).forEach(function(Pn){var sa=vn[Pn];dn[Pn]=Y(sa,function(Yn,yn){return Yn.invoke(yn,sa)})}),dn}(fr),qr.drawVAO=qr.scopeVAO=Sr.vao,!qr.drawVAO&&Ir.program&&!xr&&_e.angle_instanced_arrays&&Sr.static.elements){var _n=!0;if(It=Ir.program.attributes.map(function(bn){return bn=qt.static[bn],_n=_n&&!!bn,bn}),_n&&0<It.length){var Jr=pt.getVAO(pt.createVAO({attributes:It,elements:Sr.static.elements}));qr.drawVAO=new K(null,null,null,function(bn,Dr){return bn.link(Jr)}),qr.useVAO=!0}}return xr?qr.useVAO=!0:qr.attributes=Ot(qt),qr.context=function(bn){var Dr=bn.static,Wr=bn.dynamic,vn={};return Object.keys(Dr).forEach(function(dn){var Pn=Dr[dn];vn[dn]=H(function(sa,Yn){return typeof Pn=="number"||typeof Pn=="boolean"?""+Pn:sa.link(Pn)})}),Object.keys(Wr).forEach(function(dn){var Pn=Wr[dn];vn[dn]=Y(Pn,function(sa,Yn){return sa.invoke(Yn,Pn)})}),vn}(Tr),qr}function ir(It,qt,fr){var Tr=It.shared.context,Gr=It.scope();Object.keys(fr).forEach(function(Vr){qt.save(Tr,"."+Vr);var xr=fr[Vr].append(It,qt);Array.isArray(xr)?Gr(Tr,".",Vr,"=[",xr.join(),"];"):Gr(Tr,".",Vr,"=",xr,";")}),qt(Gr)}function Xt(It,qt,fr,Tr){var Gr,Vr=(wr=It.shared).gl,xr=wr.framebuffer;Nr&&(Gr=qt.def(wr.extensions,".webgl_draw_buffers"));var wr=(Sr=It.constants).drawBuffer,Sr=Sr.backBuffer;It=fr?fr.append(It,qt):qt.def(xr,".next"),Tr||qt("if(",It,"!==",xr,".cur){"),qt("if(",It,"){",Vr,".bindFramebuffer(",36160,",",It,".framebuffer);"),Nr&&qt(Gr,".drawBuffersWEBGL(",wr,"[",It,".colorAttachments.length]);"),qt("}else{",Vr,".bindFramebuffer(",36160,",null);"),Nr&&qt(Gr,".drawBuffersWEBGL(",Sr,");"),qt("}",xr,".cur=",It,";"),Tr||qt("}")}function Kt(It,qt,fr){var Tr=It.shared,Gr=Tr.gl,Vr=It.current,xr=It.next,wr=Tr.current,Sr=Tr.next,Mr=It.cond(wr,".dirty");Qr.forEach(function(Ir){var qr,cn;if(!((Ir=St(Ir))in fr.state))if(Ir in xr){qr=xr[Ir],cn=Vr[Ir];var _n=f(en[Ir].length,function(Jr){return Mr.def(qr,"[",Jr,"]")});Mr(It.cond(_n.map(function(Jr,bn){return Jr+"!=="+cn+"["+bn+"]"}).join("||")).then(Gr,".",An[Ir],"(",_n,");",_n.map(function(Jr,bn){return cn+"["+bn+"]="+Jr}).join(";"),";"))}else qr=Mr.def(Sr,".",Ir),_n=It.cond(qr,"!==",wr,".",Ir),Mr(_n),Ir in rn?_n(It.cond(qr).then(Gr,".enable(",rn[Ir],");").else(Gr,".disable(",rn[Ir],");"),wr,".",Ir,"=",qr,";"):_n(Gr,".",An[Ir],"(",qr,");",wr,".",Ir,"=",qr,";")}),Object.keys(fr.state).length===0&&Mr(wr,".dirty=false;"),qt(Mr)}function or(It,qt,fr,Tr){var Gr=It.shared,Vr=It.current,xr=Gr.current,wr=Gr.gl;X(Object.keys(fr)).forEach(function(Sr){var Mr=fr[Sr];if(!Tr||Tr(Mr)){var Ir=Mr.append(It,qt);if(rn[Sr]){var qr=rn[Sr];Z(Mr)?qt(wr,Ir?".enable(":".disable(",qr,");"):qt(It.cond(Ir).then(wr,".enable(",qr,");").else(wr,".disable(",qr,");")),qt(xr,".",Sr,"=",Ir,";")}else if(y(Ir)){var cn=Vr[Sr];qt(wr,".",An[Sr],"(",Ir,");",Ir.map(function(_n,Jr){return cn+"["+Jr+"]="+_n}).join(";"),";")}else qt(wr,".",An[Sr],"(",Ir,");",xr,".",Sr,"=",Ir,";")}})}function dr(It,qt){an&&(It.instancing=qt.def(It.shared.extensions,".angle_instanced_arrays"))}function vr(It,qt,fr,Tr,Gr){function Vr(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}function xr(bn){bn(Mr=qt.def(),"=",Vr(),";"),typeof Gr=="string"?bn(cn,".count+=",Gr,";"):bn(cn,".count++;"),xt&&(Tr?bn(Ir=qt.def(),"=",Jr,".getNumPendingQueries();"):bn(Jr,".beginQuery(",cn,");"))}function wr(bn){bn(cn,".cpuTime+=",Vr(),"-",Mr,";"),xt&&(Tr?bn(Jr,".pushScopeStats(",Ir,",",Jr,".getNumPendingQueries(),",cn,");"):bn(Jr,".endQuery();"))}function Sr(bn){var Dr=qt.def(_n,".profile");qt(_n,".profile=",bn,";"),qt.exit(_n,".profile=",Dr,";")}var Mr,Ir,qr=It.shared,cn=It.stats,_n=qr.current,Jr=qr.timer;if(fr=fr.profile){if(Z(fr))return void(fr.enable?(xr(qt),wr(qt.exit),Sr("true")):Sr("false"));Sr(fr=fr.append(It,qt))}else fr=qt.def(_n,".profile");xr(qr=It.block()),qt("if(",fr,"){",qr,"}"),wr(It=It.block()),qt.exit("if(",fr,"){",It,"}")}function ur(It,qt,fr,Tr,Gr){function Vr(wr,Sr,Mr){function Ir(){qt("if(!",Jr,".buffer){",cn,".enableVertexAttribArray(",_n,");}");var vn,dn=Mr.type;vn=Mr.size?qt.def(Mr.size,"||",Sr):Sr,qt("if(",Jr,".type!==",dn,"||",Jr,".size!==",vn,"||",Wr.map(function(Pn){return Jr+"."+Pn+"!=="+Mr[Pn]}).join("||"),"){",cn,".bindBuffer(",34962,",",bn,".buffer);",cn,".vertexAttribPointer(",[_n,vn,dn,Mr.normalized,Mr.stride,Mr.offset],");",Jr,".type=",dn,";",Jr,".size=",vn,";",Wr.map(function(Pn){return Jr+"."+Pn+"="+Mr[Pn]+";"}).join(""),"}"),an&&(dn=Mr.divisor,qt("if(",Jr,".divisor!==",dn,"){",It.instancing,".vertexAttribDivisorANGLE(",[_n,dn],");",Jr,".divisor=",dn,";}"))}function qr(){qt("if(",Jr,".buffer){",cn,".disableVertexAttribArray(",_n,");",Jr,".buffer=null;","}if(",at.map(function(vn,dn){return Jr+"."+vn+"!=="+Dr[dn]}).join("||"),"){",cn,".vertexAttrib4f(",_n,",",Dr,");",at.map(function(vn,dn){return Jr+"."+vn+"="+Dr[dn]+";"}).join(""),"}")}var cn=xr.gl,_n=qt.def(wr,".location"),Jr=qt.def(xr.attributes,"[",_n,"]");wr=Mr.state;var bn=Mr.buffer,Dr=[Mr.x,Mr.y,Mr.z,Mr.w],Wr=["buffer","normalized","offset","stride"];wr===1?Ir():wr===2?qr():(qt("if(",wr,"===",1,"){"),Ir(),qt("}else{"),qr(),qt("}"))}var xr=It.shared;Tr.forEach(function(wr){var Sr,Mr=wr.name,Ir=fr.attributes[Mr];if(Ir){if(!Gr(Ir))return;Sr=Ir.append(It,qt)}else{if(!Gr(He))return;var qr=It.scopeAttrib(Mr);Sr={},Object.keys(new On).forEach(function(cn){Sr[cn]=qt.def(qr,".",cn)})}Vr(It.link(wr),function(cn){switch(cn){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(wr.info.type),Sr)})}function pr(It,qt,fr,Tr,Gr,Vr){for(var xr,wr=It.shared,Sr=wr.gl,Mr={},Ir=0;Ir<Tr.length;++Ir){var qr=(Wr=Tr[Ir]).name,cn=Wr.info.type,_n=Wr.info.size,Jr=fr.uniforms[qr];if(1<_n){if(!Jr)continue;var bn=qr.replace("[0]","");if(Mr[bn])continue;Mr[bn]=1}var Dr,Wr=It.link(Wr)+".location";if(Jr){if(!Gr(Jr))continue;if(Z(Jr)){if(qr=Jr.value,cn===35678||cn===35680)qt(Sr,".uniform1i(",Wr,",",(cn=It.link(qr._texture||qr.color[0]._texture))+".bind());"),qt.exit(cn,".unbind();");else if(cn===35674||cn===35675||cn===35676)_n=It.global.def("new Float32Array(["+Array.prototype.slice.call(qr)+"])"),qr=2,cn===35675?qr=3:cn===35676&&(qr=4),qt(Sr,".uniformMatrix",qr,"fv(",Wr,",false,",_n,");");else{switch(cn){case 5126:xr="1f";break;case 35664:xr="2f";break;case 35665:xr="3f";break;case 35666:xr="4f";break;case 35670:case 5124:xr="1i";break;case 35671:case 35667:xr="2i";break;case 35672:case 35668:xr="3i";break;case 35673:xr="4i";break;case 35669:xr="4i"}1<_n?(xr+="v",qr=It.global.def("["+Array.prototype.slice.call(qr)+"]")):qr=y(qr)?Array.prototype.slice.call(qr):qr,qt(Sr,".uniform",xr,"(",Wr,",",qr,");")}continue}Dr=Jr.append(It,qt)}else{if(!Gr(He))continue;Dr=qt.def(wr.uniforms,"[",Ke.id(qr),"]")}switch(cn===35678?qt("if(",Dr,"&&",Dr,'._reglType==="framebuffer"){',Dr,"=",Dr,".color[0];","}"):cn===35680&&qt("if(",Dr,"&&",Dr,'._reglType==="framebufferCube"){',Dr,"=",Dr,".color[0];","}"),qr=1,cn){case 35678:case 35680:cn=qt.def(Dr,"._texture"),qt(Sr,".uniform1i(",Wr,",",cn,".bind());"),qt.exit(cn,".unbind();");continue;case 5124:case 35670:xr="1i";break;case 35667:case 35671:xr="2i",qr=2;break;case 35668:case 35672:xr="3i",qr=3;break;case 35669:case 35673:xr="4i",qr=4;break;case 5126:xr="1f";break;case 35664:xr="2f",qr=2;break;case 35665:xr="3f",qr=3;break;case 35666:xr="4f",qr=4;break;case 35674:xr="Matrix2fv";break;case 35675:xr="Matrix3fv";break;case 35676:xr="Matrix4fv"}if(xr.indexOf("Matrix")===-1&&1<_n&&(xr+="v",qr=1),xr.charAt(0)==="M"){qt(Sr,".uniform",xr,"(",Wr,","),Wr=Math.pow(cn-35674+2,2);var vn=It.global.def("new Float32Array(",Wr,")");Array.isArray(Dr)?qt("false,(",f(Wr,function(Pn){return vn+"["+Pn+"]="+Dr[Pn]}),",",vn,")"):qt("false,(Array.isArray(",Dr,")||",Dr," instanceof Float32Array)?",Dr,":(",f(Wr,function(Pn){return vn+"["+Pn+"]="+Dr+"["+Pn+"]"}),",",vn,")"),qt(");")}else{if(1<qr){cn=[];var dn=[];for(_n=0;_n<qr;++_n)Array.isArray(Dr)?dn.push(Dr[_n]):dn.push(qt.def(Dr+"["+_n+"]")),Vr&&cn.push(qt.def());Vr&&qt("if(!",It.batchId,"||",cn.map(function(Pn,sa){return Pn+"!=="+dn[sa]}).join("||"),"){",cn.map(function(Pn,sa){return Pn+"="+dn[sa]+";"}).join("")),qt(Sr,".uniform",xr,"(",Wr,",",dn.join(","),");")}else Vr&&(cn=qt.def(),qt("if(!",It.batchId,"||",cn,"!==",Dr,"){",cn,"=",Dr,";")),qt(Sr,".uniform",xr,"(",Wr,",",Dr,");");Vr&&qt("}")}}}function br(It,qt,fr,Tr){function Gr(dn){var Pn=cn[dn];return Pn?Pn.contextDep&&Tr.contextDynamic||Pn.propDep?Pn.append(It,fr):Pn.append(It,qt):qt.def(qr,".",dn)}function Vr(){function dn(){fr(Sr,".drawElementsInstancedANGLE(",[Jr,Dr,Wr,bn+"<<(("+Wr+"-5121)>>1)",wr],");")}function Pn(){fr(Sr,".drawArraysInstancedANGLE(",[Jr,bn,Dr,wr],");")}_n&&_n!=="null"?vn?dn():(fr("if(",_n,"){"),dn(),fr("}else{"),Pn(),fr("}")):Pn()}function xr(){function dn(){fr(Ir+".drawElements("+[Jr,Dr,Wr,bn+"<<(("+Wr+"-5121)>>1)"]+");")}function Pn(){fr(Ir+".drawArrays("+[Jr,bn,Dr]+");")}_n&&_n!=="null"?vn?dn():(fr("if(",_n,"){"),dn(),fr("}else{"),Pn(),fr("}")):Pn()}var wr,Sr,Mr=It.shared,Ir=Mr.gl,qr=Mr.draw,cn=Tr.draw,_n=function(){var dn=cn.elements,Pn=qt;return dn?((dn.contextDep&&Tr.contextDynamic||dn.propDep)&&(Pn=fr),dn=dn.append(It,Pn),cn.elementsActive&&Pn("if("+dn+")"+Ir+".bindBuffer(34963,"+dn+".buffer.buffer);")):(dn=Pn.def(),Pn(dn,"=",qr,".","elements",";","if(",dn,"){",Ir,".bindBuffer(",34963,",",dn,".buffer.buffer);}","else if(",Mr.vao,".currentVAO){",dn,"=",It.shared.elements+".getElements("+Mr.vao,".currentVAO.elements);",Pr?"":"if("+dn+")"+Ir+".bindBuffer(34963,"+dn+".buffer.buffer);","}")),dn}(),Jr=Gr("primitive"),bn=Gr("offset"),Dr=function(){var dn=cn.count,Pn=qt;return dn?((dn.contextDep&&Tr.contextDynamic||dn.propDep)&&(Pn=fr),dn=dn.append(It,Pn)):dn=Pn.def(qr,".","count"),dn}();if(typeof Dr=="number"){if(Dr===0)return}else fr("if(",Dr,"){"),fr.exit("}");an&&(wr=Gr("instances"),Sr=It.instancing);var Wr=_n+".type",vn=cn.elements&&Z(cn.elements)&&!cn.vaoActive;an&&(typeof wr!="number"||0<=wr)?typeof wr=="string"?(fr("if(",wr,">0){"),Vr(),fr("}else if(",wr,"<0){"),xr(),fr("}")):Vr():xr()}function Rr(It,qt,fr,Tr,Gr){return Gr=(qt=Qt()).proc("body",Gr),an&&(qt.instancing=Gr.def(qt.shared.extensions,".angle_instanced_arrays")),It(qt,Gr,fr,Tr),qt.compile().body}function _r(It,qt,fr,Tr){dr(It,qt),fr.useVAO?fr.drawVAO?qt(It.shared.vao,".setVAO(",fr.drawVAO.append(It,qt),");"):qt(It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"):(qt(It.shared.vao,".setVAO(null);"),ur(It,qt,fr,Tr.attributes,function(){return!0})),pr(It,qt,fr,Tr.uniforms,function(){return!0},!1),br(It,qt,qt,fr)}function jr(It,qt,fr,Tr){function Gr(){return!0}It.batchId="a1",dr(It,qt),ur(It,qt,fr,Tr.attributes,Gr),pr(It,qt,fr,Tr.uniforms,Gr,!1),br(It,qt,qt,fr)}function $r(It,qt,fr,Tr){function Gr(qr){return qr.contextDep&&xr||qr.propDep}function Vr(qr){return!Gr(qr)}dr(It,qt);var xr=fr.contextDep,wr=qt.def(),Sr=qt.def();It.shared.props=Sr,It.batchId=wr;var Mr=It.scope(),Ir=It.scope();qt(Mr.entry,"for(",wr,"=0;",wr,"<","a1",";++",wr,"){",Sr,"=","a0","[",wr,"];",Ir,"}",Mr.exit),fr.needsContext&&ir(It,Ir,fr.context),fr.needsFramebuffer&&Xt(It,Ir,fr.framebuffer),or(It,Ir,fr.state,Gr),fr.profile&&Gr(fr.profile)&&vr(It,Ir,fr,!1,!0),Tr?(fr.useVAO?fr.drawVAO?Gr(fr.drawVAO)?Ir(It.shared.vao,".setVAO(",fr.drawVAO.append(It,Ir),");"):Mr(It.shared.vao,".setVAO(",fr.drawVAO.append(It,Mr),");"):Mr(It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"):(Mr(It.shared.vao,".setVAO(null);"),ur(It,Mr,fr,Tr.attributes,Vr),ur(It,Ir,fr,Tr.attributes,Gr)),pr(It,Mr,fr,Tr.uniforms,Vr,!1),pr(It,Ir,fr,Tr.uniforms,Gr,!0),br(It,Mr,Ir,fr)):(qt=It.global.def("{}"),Tr=fr.shader.progVar.append(It,Ir),Sr=Ir.def(Tr,".id"),Mr=Ir.def(qt,"[",Sr,"]"),Ir(It.shared.gl,".useProgram(",Tr,".program);","if(!",Mr,"){",Mr,"=",qt,"[",Sr,"]=",It.link(function(qr){return Rr(jr,It,fr,qr,2)}),"(",Tr,");}",Mr,".call(this,a0[",wr,"],",wr,");"))}function pn(It,qt){function fr(xr){var wr=qt.shader[xr];wr&&Tr.set(Gr.shader,"."+xr,wr.append(It,Tr))}var Tr=It.proc("scope",3);It.batchId="a2";var Gr=It.shared,Vr=Gr.current;ir(It,Tr,qt.context),qt.framebuffer&&qt.framebuffer.append(It,Tr),X(Object.keys(qt.state)).forEach(function(xr){var wr=qt.state[xr].append(It,Tr);y(wr)?wr.forEach(function(Sr,Mr){Tr.set(It.next[xr],"["+Mr+"]",Sr)}):Tr.set(Gr.next,"."+xr,wr)}),vr(It,Tr,qt,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(xr){var wr=qt.draw[xr];wr&&Tr.set(Gr.draw,"."+xr,""+wr.append(It,Tr))}),Object.keys(qt.uniforms).forEach(function(xr){var wr=qt.uniforms[xr].append(It,Tr);Array.isArray(wr)&&(wr="["+wr.join()+"]"),Tr.set(Gr.uniforms,"["+Ke.id(xr)+"]",wr)}),Object.keys(qt.attributes).forEach(function(xr){var wr=qt.attributes[xr].append(It,Tr),Sr=It.scopeAttrib(xr);Object.keys(new On).forEach(function(Mr){Tr.set(Sr,"."+Mr,wr[Mr])})}),qt.scopeVAO&&Tr.set(Gr.vao,".targetVAO",qt.scopeVAO.append(It,Tr)),fr("vert"),fr("frag"),0<Object.keys(qt.state).length&&(Tr(Vr,".dirty=true;"),Tr.exit(Vr,".dirty=true;")),Tr("a1(",It.shared.context,",a0,",It.batchId,");")}function In(It,qt,fr){var Tr=qt.static[fr];if(Tr&&function(Ir){if(typeof Ir=="object"&&!y(Ir)){for(var qr=Object.keys(Ir),cn=0;cn<qr.length;++cn)if(ee.isDynamic(Ir[qr[cn]]))return!0;return!1}}(Tr)){var Gr=It.global,Vr=Object.keys(Tr),xr=!1,wr=!1,Sr=!1,Mr=It.global.def("{}");Vr.forEach(function(Ir){var qr=Tr[Ir];if(ee.isDynamic(qr))typeof qr=="function"&&(qr=Tr[Ir]=ee.unbox(qr)),Ir=Y(qr,null),xr=xr||Ir.thisDep,Sr=Sr||Ir.propDep,wr=wr||Ir.contextDep;else{switch(Gr(Mr,".",Ir,"="),typeof qr){case"number":Gr(qr);break;case"string":Gr('"',qr,'"');break;case"object":Array.isArray(qr)&&Gr("[",qr.join(),"]");break;default:Gr(It.link(qr))}Gr(";")}}),qt.dynamic[fr]=new ee.DynamicVariable(4,{thisDep:xr,contextDep:wr,propDep:Sr,ref:Mr,append:function(Ir,qr){Vr.forEach(function(cn){var _n=Tr[cn];ee.isDynamic(_n)&&(_n=Ir.invoke(qr,_n),qr(Mr,".",cn,"=",_n,";"))})}}),delete qt.static[fr]}}var On=pt.Record,Sn={add:32774,subtract:32778,"reverse subtract":32779};_e.ext_blend_minmax&&(Sn.min=32775,Sn.max=32776);var an=_e.angle_instanced_arrays,Nr=_e.webgl_draw_buffers,Pr=_e.oes_vertex_array_object,en={dirty:!0,profile:it.profile},tn={},Qr=[],rn={},An={};Nt("dither",3024),Nt("blend.enable",3042),Ut("blend.color","blendColor",[0,0,0,0]),Ut("blend.equation","blendEquationSeparate",[32774,32774]),Ut("blend.func","blendFuncSeparate",[1,0,1,0]),Nt("depth.enable",2929,!0),Ut("depth.func","depthFunc",513),Ut("depth.range","depthRange",[0,1]),Ut("depth.mask","depthMask",!0),Ut("colorMask","colorMask",[!0,!0,!0,!0]),Nt("cull.enable",2884),Ut("cull.face","cullFace",1029),Ut("frontFace","frontFace",2305),Ut("lineWidth","lineWidth",1),Nt("polygonOffset.enable",32823),Ut("polygonOffset.offset","polygonOffset",[0,0]),Nt("sample.alpha",32926),Nt("sample.enable",32928),Ut("sample.coverage","sampleCoverage",[1,!1]),Nt("stencil.enable",2960),Ut("stencil.mask","stencilMask",-1),Ut("stencil.func","stencilFunc",[519,0,-1]),Ut("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),Ut("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),Nt("scissor.enable",3089),Ut("scissor.box","scissor",[0,0,Be.drawingBufferWidth,Be.drawingBufferHeight]),Ut("viewport","viewport",[0,0,Be.drawingBufferWidth,Be.drawingBufferHeight]);var En={gl:Be,context:Dt,strings:Ke,next:tn,current:en,draw:vt,elements:Pe,buffer:Le,shader:Lt,attributes:pt.state,vao:pt,uniforms:Mt,framebuffer:ht,extensions:_e,timer:xt,isBufferArgs:q},Bn={primTypes:xe,compareFuncs:er,blendFuncs:_t,blendEquations:Sn,stencilOps:tr,glTypes:ue,orientationType:Ue};Nr&&(Bn.backBuffer=[1029],Bn.drawBuffer=f(Ce.maxDrawbuffers,function(It){return It===0?[0]:f(It,function(qt){return 36064+qt})}));var Jt=0;return{next:tn,current:en,procs:function(){var It=Qt(),qt=It.proc("poll"),fr=It.proc("refresh"),Tr=It.block();qt(Tr),fr(Tr);var Gr,Vr=It.shared,xr=Vr.gl,wr=Vr.next,Sr=Vr.current;Tr(Sr,".dirty=false;"),Xt(It,qt),Xt(It,fr,null,!0),an&&(Gr=It.link(an)),_e.oes_vertex_array_object&&fr(It.link(_e.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Mr=0;Mr<Ce.maxAttributes;++Mr){var Ir=fr.def(Vr.attributes,"[",Mr,"]"),qr=It.cond(Ir,".buffer");qr.then(xr,".enableVertexAttribArray(",Mr,");",xr,".bindBuffer(",34962,",",Ir,".buffer.buffer);",xr,".vertexAttribPointer(",Mr,",",Ir,".size,",Ir,".type,",Ir,".normalized,",Ir,".stride,",Ir,".offset);").else(xr,".disableVertexAttribArray(",Mr,");",xr,".vertexAttrib4f(",Mr,",",Ir,".x,",Ir,".y,",Ir,".z,",Ir,".w);",Ir,".buffer=null;"),fr(qr),an&&fr(Gr,".vertexAttribDivisorANGLE(",Mr,",",Ir,".divisor);")}return fr(It.shared.vao,".currentVAO=null;",It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"),Object.keys(rn).forEach(function(cn){var _n=rn[cn],Jr=Tr.def(wr,".",cn),bn=It.block();bn("if(",Jr,"){",xr,".enable(",_n,")}else{",xr,".disable(",_n,")}",Sr,".",cn,"=",Jr,";"),fr(bn),qt("if(",Jr,"!==",Sr,".",cn,"){",bn,"}")}),Object.keys(An).forEach(function(cn){var _n,Jr,bn=An[cn],Dr=en[cn],Wr=It.block();Wr(xr,".",bn,"("),y(Dr)?(bn=Dr.length,_n=It.global.def(wr,".",cn),Jr=It.global.def(Sr,".",cn),Wr(f(bn,function(vn){return _n+"["+vn+"]"}),");",f(bn,function(vn){return Jr+"["+vn+"]="+_n+"["+vn+"];"}).join("")),qt("if(",f(bn,function(vn){return _n+"["+vn+"]!=="+Jr+"["+vn+"]"}).join("||"),"){",Wr,"}")):(_n=Tr.def(wr,".",cn),Jr=Tr.def(Sr,".",cn),Wr(_n,");",Sr,".",cn,"=",_n,";"),qt("if(",_n,"!==",Jr,"){",Wr,"}")),fr(Wr)}),It.compile()}(),compile:function(It,qt,fr,Tr,Gr){var Vr=Qt();Vr.stats=Vr.link(Gr),Object.keys(qt.static).forEach(function(wr){In(Vr,qt,wr)}),tt.forEach(function(wr){In(Vr,It,wr)});var xr=Gt(It,qt,fr,Tr);return function(wr,Sr){var Mr=wr.proc("draw",1);dr(wr,Mr),ir(wr,Mr,Sr.context),Xt(wr,Mr,Sr.framebuffer),Kt(wr,Mr,Sr),or(wr,Mr,Sr.state),vr(wr,Mr,Sr,!1,!0);var Ir=Sr.shader.progVar.append(wr,Mr);if(Mr(wr.shared.gl,".useProgram(",Ir,".program);"),Sr.shader.program)_r(wr,Mr,Sr,Sr.shader.program);else{Mr(wr.shared.vao,".setVAO(null);");var qr=wr.global.def("{}"),cn=Mr.def(Ir,".id"),_n=Mr.def(qr,"[",cn,"]");Mr(wr.cond(_n).then(_n,".call(this,a0);").else(_n,"=",qr,"[",cn,"]=",wr.link(function(Jr){return Rr(_r,wr,Sr,Jr,1)}),"(",Ir,");",_n,".call(this,a0);"))}0<Object.keys(Sr.state).length&&Mr(wr.shared.current,".dirty=true;"),wr.shared.vao&&Mr(wr.shared.vao,".setVAO(null);")}(Vr,xr),pn(Vr,xr),function(wr,Sr){function Mr(Dr){return Dr.contextDep&&qr||Dr.propDep}var Ir=wr.proc("batch",2);wr.batchId="0",dr(wr,Ir);var qr=!1,cn=!0;Object.keys(Sr.context).forEach(function(Dr){qr=qr||Sr.context[Dr].propDep}),qr||(ir(wr,Ir,Sr.context),cn=!1);var _n=!1;if((Jr=Sr.framebuffer)?(Jr.propDep?qr=_n=!0:Jr.contextDep&&qr&&(_n=!0),_n||Xt(wr,Ir,Jr)):Xt(wr,Ir,null),Sr.state.viewport&&Sr.state.viewport.propDep&&(qr=!0),Kt(wr,Ir,Sr),or(wr,Ir,Sr.state,function(Dr){return!Mr(Dr)}),Sr.profile&&Mr(Sr.profile)||vr(wr,Ir,Sr,!1,"a1"),Sr.contextDep=qr,Sr.needsContext=cn,Sr.needsFramebuffer=_n,(cn=Sr.shader.progVar).contextDep&&qr||cn.propDep)$r(wr,Ir,Sr,null);else if(cn=cn.append(wr,Ir),Ir(wr.shared.gl,".useProgram(",cn,".program);"),Sr.shader.program)$r(wr,Ir,Sr,Sr.shader.program);else{Ir(wr.shared.vao,".setVAO(null);");var Jr=wr.global.def("{}"),bn=(_n=Ir.def(cn,".id"),Ir.def(Jr,"[",_n,"]"));Ir(wr.cond(bn).then(bn,".call(this,a0,a1);").else(bn,"=",Jr,"[",_n,"]=",wr.link(function(Dr){return Rr($r,wr,Sr,Dr,2)}),"(",cn,");",bn,".call(this,a0,a1);"))}0<Object.keys(Sr.state).length&&Ir(wr.shared.current,".dirty=true;"),wr.shared.vao&&Ir(wr.shared.vao,".setVAO(null);")}(Vr,xr),j(Vr.compile(),{destroy:function(){xr.shader.program.destroy()}})}}}function z(Be,Ke){for(var _e=0;_e<Be.length;++_e)if(Be[_e]===Ke)return _e;return-1}var j=function(Be,Ke){for(var _e=Object.keys(Ke),Ce=0;Ce<_e.length;++Ce)Be[_e[Ce]]=Ke[_e[Ce]];return Be},W=0,ee={DynamicVariable:t,define:function(Be,Ke){return new t(Be,d(Ke+""))},isDynamic:function(Be){return typeof Be=="function"&&!Be._reglType||Be instanceof t},unbox:function Be(Ke,_e){return typeof Ke=="function"?new t(0,Ke):typeof Ke=="number"||typeof Ke=="boolean"?new t(5,Ke):Array.isArray(Ke)?new t(6,Ke.map(function(Ce,Le){return Be(Ce)})):Ke instanceof t?Ke:void 0},accessor:d},J={next:typeof requestAnimationFrame=="function"?function(Be){return requestAnimationFrame(Be)}:function(Be){return setTimeout(Be,16)},cancel:typeof cancelAnimationFrame=="function"?function(Be){return cancelAnimationFrame(Be)}:clearTimeout},Q=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date},te=s();te.zero=s();var ie=function(Be,Ke){var _e=1;Ke.ext_texture_filter_anisotropic&&(_e=Be.getParameter(34047));var Ce=1,Le=1;Ke.webgl_draw_buffers&&(Ce=Be.getParameter(34852),Le=Be.getParameter(36063));var Pe=!!Ke.oes_texture_float;if(Pe){Pe=Be.createTexture(),Be.bindTexture(3553,Pe),Be.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var Xe=Be.createFramebuffer();if(Be.bindFramebuffer(36160,Xe),Be.framebufferTexture2D(36160,36064,3553,Pe,0),Be.bindTexture(3553,null),Be.checkFramebufferStatus(36160)!==36053)Pe=!1;else{Be.viewport(0,0,1,1),Be.clearColor(1,0,0,1),Be.clear(16384);var ht=te.allocType(5126,4);Be.readPixels(0,0,1,1,6408,5126,ht),Be.getError()?Pe=!1:(Be.deleteFramebuffer(Xe),Be.deleteTexture(Pe),Pe=ht[0]===1),te.freeType(ht)}}return ht=!0,typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(ht=Be.createTexture(),Xe=te.allocType(5121,36),Be.activeTexture(33984),Be.bindTexture(34067,ht),Be.texImage2D(34069,0,6408,3,3,0,6408,5121,Xe),te.freeType(Xe),Be.bindTexture(34067,null),Be.deleteTexture(ht),ht=!Be.getError()),{colorBits:[Be.getParameter(3410),Be.getParameter(3411),Be.getParameter(3412),Be.getParameter(3413)],depthBits:Be.getParameter(3414),stencilBits:Be.getParameter(3415),subpixelBits:Be.getParameter(3408),extensions:Object.keys(Ke).filter(function(Mt){return!!Ke[Mt]}),maxAnisotropic:_e,maxDrawbuffers:Ce,maxColorAttachments:Le,pointSizeDims:Be.getParameter(33901),lineWidthDims:Be.getParameter(33902),maxViewportDims:Be.getParameter(3386),maxCombinedTextureUnits:Be.getParameter(35661),maxCubeMapSize:Be.getParameter(34076),maxRenderbufferSize:Be.getParameter(34024),maxTextureUnits:Be.getParameter(34930),maxTextureSize:Be.getParameter(3379),maxAttributes:Be.getParameter(34921),maxVertexUniforms:Be.getParameter(36347),maxVertexTextureUnits:Be.getParameter(35660),maxVaryingVectors:Be.getParameter(36348),maxFragmentUniforms:Be.getParameter(36349),glsl:Be.getParameter(35724),renderer:Be.getParameter(7937),vendor:Be.getParameter(7936),version:Be.getParameter(7938),readFloat:Pe,npotTextureCube:ht}},ae=function(Be){return Be instanceof Uint8Array||Be instanceof Uint16Array||Be instanceof Uint32Array||Be instanceof Int8Array||Be instanceof Int16Array||Be instanceof Int32Array||Be instanceof Float32Array||Be instanceof Float64Array||Be instanceof Uint8ClampedArray},he=function(Be){return Object.keys(Be).map(function(Ke){return Be[Ke]})},se={shape:function(Be){for(var Ke=[];Be.length;Be=Be[0])Ke.push(Be.length);return Ke},flatten:function(Be,Ke,_e,Ce){var Le=1;if(Ke.length)for(var Pe=0;Pe<Ke.length;++Pe)Le*=Ke[Pe];else Le=0;switch(_e=Ce||te.allocType(_e,Le),Ke.length){case 0:break;case 1:for(Ce=Ke[0],Ke=0;Ke<Ce;++Ke)_e[Ke]=Be[Ke];break;case 2:for(Ce=Ke[0],Ke=Ke[1],Pe=Le=0;Pe<Ce;++Pe)for(var Xe=Be[Pe],ht=0;ht<Ke;++ht)_e[Le++]=Xe[ht];break;case 3:o(Be,Ke[0],Ke[1],Ke[2],_e,0);break;default:(function Mt(pt,Lt,vt,Dt,xt){for(var it=1,St=vt+1;St<Lt.length;++St)it*=Lt[St];var Nt=Lt[vt];if(Lt.length-vt==4){var Ut=Lt[vt+1],Qt=Lt[vt+2];for(Lt=Lt[vt+3],St=0;St<Nt;++St)o(pt[St],Ut,Qt,Lt,Dt,xt),xt+=it}else for(St=0;St<Nt;++St)Mt(pt[St],Lt,vt+1,Dt,xt),xt+=it})(Be,Ke,0,_e,0)}return _e}},de={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},ue={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},ve={dynamic:35048,stream:35040,static:35044},ke=se.flatten,Ee=se.shape,be=[];be[5120]=1,be[5122]=2,be[5124]=4,be[5121]=1,be[5123]=2,be[5125]=4,be[5126]=4;var xe={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ce=new Float32Array(1),ge=new Uint32Array(ce.buffer),we=[9984,9986,9985,9987],Me=[0,6409,6410,6407,6408],Se={};Se[6409]=Se[6406]=Se[6402]=1,Se[34041]=Se[6410]=2,Se[6407]=Se[35904]=3,Se[6408]=Se[35906]=4;var ze=v("HTMLCanvasElement"),Fe=v("OffscreenCanvas"),Ye=v("CanvasRenderingContext2D"),rt=v("ImageBitmap"),Oe=v("HTMLImageElement"),je=v("HTMLVideoElement"),We=Object.keys(de).concat([ze,Fe,Ye,rt,Oe,je]),qe=[];qe[5121]=1,qe[5126]=4,qe[36193]=2,qe[5123]=2,qe[5125]=4;var Qe=[];Qe[32854]=2,Qe[32855]=2,Qe[36194]=2,Qe[34041]=4,Qe[33776]=.5,Qe[33777]=.5,Qe[33778]=1,Qe[33779]=1,Qe[35986]=.5,Qe[35987]=1,Qe[34798]=1,Qe[35840]=.5,Qe[35841]=.25,Qe[35842]=.5,Qe[35843]=.25,Qe[36196]=.5;var st=[];st[32854]=2,st[32855]=2,st[36194]=2,st[33189]=2,st[36168]=1,st[34041]=4,st[35907]=4,st[34836]=16,st[34842]=8,st[34843]=6;var ct=function(Be,Ke,_e,Ce,Le){function Pe(vt){this.id=pt++,this.refCount=1,this.renderbuffer=vt,this.format=32854,this.height=this.width=0,Le.profile&&(this.stats={size:0})}function Xe(vt){var Dt=vt.renderbuffer;Be.bindRenderbuffer(36161,null),Be.deleteRenderbuffer(Dt),vt.renderbuffer=null,vt.refCount=0,delete Lt[vt.id],Ce.renderbufferCount--}var ht={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};Ke.ext_srgb&&(ht.srgba=35907),Ke.ext_color_buffer_half_float&&(ht.rgba16f=34842,ht.rgb16f=34843),Ke.webgl_color_buffer_float&&(ht.rgba32f=34836);var Mt=[];Object.keys(ht).forEach(function(vt){Mt[ht[vt]]=vt});var pt=0,Lt={};return Pe.prototype.decRef=function(){0>=--this.refCount&&Xe(this)},Le.profile&&(Ce.getTotalRenderbufferSize=function(){var vt=0;return Object.keys(Lt).forEach(function(Dt){vt+=Lt[Dt].stats.size}),vt}),{create:function(vt,Dt){function xt(St,Nt){var Ut=0,Qt=0,Ie=32854;if(typeof St=="object"&&St?("shape"in St?(Ut=0|(Qt=St.shape)[0],Qt=0|Qt[1]):("radius"in St&&(Ut=Qt=0|St.radius),"width"in St&&(Ut=0|St.width),"height"in St&&(Qt=0|St.height)),"format"in St&&(Ie=ht[St.format])):typeof St=="number"?(Ut=0|St,Qt=typeof Nt=="number"?0|Nt:Ut):St||(Ut=Qt=1),Ut!==it.width||Qt!==it.height||Ie!==it.format)return xt.width=it.width=Ut,xt.height=it.height=Qt,it.format=Ie,Be.bindRenderbuffer(36161,it.renderbuffer),Be.renderbufferStorage(36161,Ie,Ut,Qt),Le.profile&&(it.stats.size=st[it.format]*it.width*it.height),xt.format=Mt[it.format],xt}var it=new Pe(Be.createRenderbuffer());return Lt[it.id]=it,Ce.renderbufferCount++,xt(vt,Dt),xt.resize=function(St,Nt){var Ut=0|St,Qt=0|Nt||Ut;return Ut===it.width&&Qt===it.height||(xt.width=it.width=Ut,xt.height=it.height=Qt,Be.bindRenderbuffer(36161,it.renderbuffer),Be.renderbufferStorage(36161,it.format,Ut,Qt),Le.profile&&(it.stats.size=st[it.format]*it.width*it.height)),xt},xt._reglType="renderbuffer",xt._renderbuffer=it,Le.profile&&(xt.stats=it.stats),xt.destroy=function(){it.decRef()},xt},clear:function(){he(Lt).forEach(Xe)},restore:function(){he(Lt).forEach(function(vt){vt.renderbuffer=Be.createRenderbuffer(),Be.bindRenderbuffer(36161,vt.renderbuffer),Be.renderbufferStorage(36161,vt.format,vt.width,vt.height)}),Be.bindRenderbuffer(36161,null)}}},Pt=[];Pt[6408]=4,Pt[6407]=3;var kt=[];kt[5121]=1,kt[5126]=4,kt[36193]=2;var at=["x","y","z","w"],tt="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),_t={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},er={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},tr={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ue={cw:2304,ccw:2305},He=new K(!1,!1,!1,function(){});return function(Be){function Ke(){if(jr.length===0)Ie&&Ie.update(),On=null;else{On=J.next(Ke),Lt();for(var an=jr.length-1;0<=an;--an){var Nr=jr[an];Nr&&Nr(Gt,null,0)}xt.flush(),Ie&&Ie.update()}}function _e(){!On&&0<jr.length&&(On=J.next(Ke))}function Ce(){On&&(J.cancel(Ke),On=null)}function Le(an){an.preventDefault(),Ce(),$r.forEach(function(Nr){Nr()})}function Pe(an){xt.getError(),St.restore(),dr.restore(),Xt.restore(),vr.restore(),ur.restore(),pr.restore(),or.restore(),Ie&&Ie.restore(),br.procs.refresh(),_e(),pn.forEach(function(Nr){Nr()})}function Xe(an){function Nr(It,qt){var fr={},Tr={};return Object.keys(It).forEach(function(Gr){var Vr=It[Gr];if(ee.isDynamic(Vr))Tr[Gr]=ee.unbox(Vr,Gr);else{if(qt&&Array.isArray(Vr)){for(var xr=0;xr<Vr.length;++xr)if(ee.isDynamic(Vr[xr]))return void(Tr[Gr]=ee.unbox(Vr,Gr))}fr[Gr]=Vr}}),{dynamic:Tr,static:fr}}var Pr=Nr(an.context||{},!0),en=Nr(an.uniforms||{},!0),tn=Nr(an.attributes||{},!1);an=Nr(function(It){function qt(Tr){if(Tr in fr){var Gr=fr[Tr];delete fr[Tr],Object.keys(Gr).forEach(function(Vr){fr[Tr+"."+Vr]=Gr[Vr]})}}var fr=j({},It);return delete fr.uniforms,delete fr.attributes,delete fr.context,delete fr.vao,"stencil"in fr&&fr.stencil.op&&(fr.stencil.opBack=fr.stencil.opFront=fr.stencil.op,delete fr.stencil.op),qt("blend"),qt("depth"),qt("cull"),qt("stencil"),qt("polygonOffset"),qt("scissor"),qt("sample"),"vao"in It&&(fr.vao=It.vao),fr}(an),!1);var Qr={gpuTime:0,cpuTime:0,count:0},rn=br.compile(an,tn,en,Pr,Qr),An=rn.draw,En=rn.batch,Bn=rn.scope,Jt=[];return j(function(It,qt){var fr;if(typeof It=="function")return Bn.call(this,null,It,0);if(typeof qt=="function")if(typeof It=="number")for(fr=0;fr<It;++fr)Bn.call(this,null,qt,fr);else{if(!Array.isArray(It))return Bn.call(this,It,qt,0);for(fr=0;fr<It.length;++fr)Bn.call(this,It[fr],qt,fr)}else if(typeof It=="number"){if(0<It)return En.call(this,function(Tr){for(;Jt.length<Tr;)Jt.push(null);return Jt}(0|It),0|It)}else{if(!Array.isArray(It))return An.call(this,It);if(It.length)return En.call(this,It,It.length)}},{stats:Qr,destroy:function(){rn.destroy()}})}function ht(an,Nr){var Pr=0;br.procs.poll();var en=Nr.color;en&&(xt.clearColor(+en[0]||0,+en[1]||0,+en[2]||0,+en[3]||0),Pr|=16384),"depth"in Nr&&(xt.clearDepth(+Nr.depth),Pr|=256),"stencil"in Nr&&(xt.clearStencil(0|Nr.stencil),Pr|=1024),xt.clear(Pr)}function Mt(an){return jr.push(an),_e(),{cancel:function(){var Nr=z(jr,an);jr[Nr]=function Pr(){var en=z(jr,Pr);jr[en]=jr[jr.length-1],--jr.length,0>=jr.length&&Ce()}}}}function pt(){var an=Rr.viewport,Nr=Rr.scissor_box;an[0]=an[1]=Nr[0]=Nr[1]=0,Gt.viewportWidth=Gt.framebufferWidth=Gt.drawingBufferWidth=an[2]=Nr[2]=xt.drawingBufferWidth,Gt.viewportHeight=Gt.framebufferHeight=Gt.drawingBufferHeight=an[3]=Nr[3]=xt.drawingBufferHeight}function Lt(){Gt.tick+=1,Gt.time=Dt(),pt(),br.procs.poll()}function vt(){vr.refresh(),pt(),br.procs.refresh(),Ie&&Ie.update()}function Dt(){return(Q()-lt)/1e3}if(!(Be=e(Be)))return null;var xt=Be.gl,it=xt.getContextAttributes();xt.isContextLost();var St=function(an,Nr){function Pr(rn){var An;rn=rn.toLowerCase();try{An=en[rn]=an.getExtension(rn)}catch(En){}return!!An}for(var en={},tn=0;tn<Nr.extensions.length;++tn){var Qr=Nr.extensions[tn];if(!Pr(Qr))return Nr.onDestroy(),Nr.onDone('"'+Qr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Nr.optionalExtensions.forEach(Pr),{extensions:en,restore:function(){Object.keys(en).forEach(function(rn){if(en[rn]&&!Pr(rn))throw Error("(regl): error restoring extension "+rn)})}}}(xt,Be);if(!St)return null;var Nt=function(){var an={"":0},Nr=[""];return{id:function(Pr){var en=an[Pr];return en||(en=an[Pr]=Nr.length,Nr.push(Pr),en)},str:function(Pr){return Nr[Pr]}}}(),Ut={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},Qt=St.extensions,Ie=function(an,Nr){function Pr(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function en(Jt,It,qt){var fr=rn.pop()||new Pr;fr.startQueryIndex=Jt,fr.endQueryIndex=It,fr.sum=0,fr.stats=qt,An.push(fr)}if(!Nr.ext_disjoint_timer_query)return null;var tn=[],Qr=[],rn=[],An=[],En=[],Bn=[];return{beginQuery:function(Jt){var It=tn.pop()||Nr.ext_disjoint_timer_query.createQueryEXT();Nr.ext_disjoint_timer_query.beginQueryEXT(35007,It),Qr.push(It),en(Qr.length-1,Qr.length,Jt)},endQuery:function(){Nr.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:en,update:function(){var Jt,It;if((Jt=Qr.length)!==0){Bn.length=Math.max(Bn.length,Jt+1),En.length=Math.max(En.length,Jt+1),En[0]=0;var qt=Bn[0]=0;for(It=Jt=0;It<Qr.length;++It){var fr=Qr[It];Nr.ext_disjoint_timer_query.getQueryObjectEXT(fr,34919)?(qt+=Nr.ext_disjoint_timer_query.getQueryObjectEXT(fr,34918),tn.push(fr)):Qr[Jt++]=fr,En[It+1]=qt,Bn[It+1]=Jt}for(Qr.length=Jt,It=Jt=0;It<An.length;++It){var Tr=(qt=An[It]).startQueryIndex;fr=qt.endQueryIndex,qt.sum+=En[fr]-En[Tr],Tr=Bn[Tr],(fr=Bn[fr])===Tr?(qt.stats.gpuTime+=qt.sum/1e6,rn.push(qt)):(qt.startQueryIndex=Tr,qt.endQueryIndex=fr,An[Jt++]=qt)}An.length=Jt}},getNumPendingQueries:function(){return Qr.length},clear:function(){tn.push.apply(tn,Qr);for(var Jt=0;Jt<tn.length;Jt++)Nr.ext_disjoint_timer_query.deleteQueryEXT(tn[Jt]);Qr.length=0,tn.length=0},restore:function(){Qr.length=0,tn.length=0}}}(0,Qt),lt=Q(),wt=xt.drawingBufferWidth,Ot=xt.drawingBufferHeight,Gt={tick:0,time:0,viewportWidth:wt,viewportHeight:Ot,framebufferWidth:wt,framebufferHeight:Ot,drawingBufferWidth:wt,drawingBufferHeight:Ot,pixelRatio:Be.pixelRatio},ir=(wt={elements:null,primitive:4,count:-1,offset:0,instances:-1},ie(xt,Qt)),Xt=a(xt,Ut,Be,function(an){return or.destroyBuffer(an)}),Kt=g(xt,Qt,Xt,Ut),or=M(xt,Qt,ir,Ut,Xt,Kt,wt),dr=P(xt,Nt,Ut,Be),vr=C(xt,Qt,ir,function(){br.procs.poll()},Gt,Ut,Be),ur=ct(xt,Qt,0,Ut,Be),pr=k(xt,Qt,ir,vr,ur,Ut),br=$(xt,Nt,Qt,ir,Xt,Kt,0,pr,{},or,dr,wt,Gt,Ie,Be),Rr=(Nt=D(xt,pr,br.procs.poll,Gt),br.next),_r=xt.canvas,jr=[],$r=[],pn=[],In=[Be.onDestroy],On=null;_r&&(_r.addEventListener("webglcontextlost",Le,!1),_r.addEventListener("webglcontextrestored",Pe,!1));var Sn=pr.setFBO=Xe({framebuffer:ee.define.call(null,1,"framebuffer")});return vt(),it=j(Xe,{clear:function(an){if("framebuffer"in an)if(an.framebuffer&&an.framebuffer_reglType==="framebufferCube")for(var Nr=0;6>Nr;++Nr)Sn(j({framebuffer:an.framebuffer.faces[Nr]},an),ht);else Sn(an,ht);else ht(0,an)},prop:ee.define.bind(null,1),context:ee.define.bind(null,2),this:ee.define.bind(null,3),draw:Xe({}),buffer:function(an){return Xt.create(an,34962,!1,!1)},elements:function(an){return Kt.create(an,!1)},texture:vr.create2D,cube:vr.createCube,renderbuffer:ur.create,framebuffer:pr.create,framebufferCube:pr.createCube,vao:or.createVAO,attributes:it,frame:Mt,on:function(an,Nr){var Pr;switch(an){case"frame":return Mt(Nr);case"lost":Pr=$r;break;case"restore":Pr=pn;break;case"destroy":Pr=In}return Pr.push(Nr),{cancel:function(){for(var en=0;en<Pr.length;++en)if(Pr[en]===Nr){Pr[en]=Pr[Pr.length-1],Pr.pop();break}}}},limits:ir,hasExtension:function(an){return 0<=ir.extensions.indexOf(an.toLowerCase())},read:Nt,destroy:function(){jr.length=0,Ce(),_r&&(_r.removeEventListener("webglcontextlost",Le),_r.removeEventListener("webglcontextrestored",Pe)),dr.clear(),pr.clear(),ur.clear(),or.clear(),vr.clear(),Kt.clear(),Xt.clear(),Ie&&Ie.clear(),In.forEach(function(an){an()})},_gl:xt,_refresh:vt,poll:function(){Lt(),Ie&&Ie.update()},now:Dt,stats:Ut}),Be.onDone(null,it),it}})},{}],527:[function(r,O,B){var t,d="";O.exports=function(m,p){if(typeof m!="string")throw new TypeError("expected a string");if(p===1)return m;if(p===2)return m+m;var e=m.length*p;if(t!==m||t===void 0)t=m,d="";else if(d.length>=e)return d.substr(0,e);for(;e>d.length&&p>1;)1&p&&(d+=m),p>>=1,m+=m;return d=(d+=m).substr(0,e)}},{}],528:[function(r,O,B){(function(t){(function(){O.exports=t.performance&&t.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,typeof Xi!="undefined"?Xi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],529:[function(r,O,B){O.exports=function(t){for(var d=t.length,m=t[t.length-1],p=d,e=d-2;e>=0;--e){var f=m,u=t[e];(l=u-((m=f+u)-f))&&(t[--p]=m,m=l)}var s=0;for(e=p;e<d;++e){var l;f=t[e],(l=(u=m)-((m=f+u)-f))&&(t[s++]=l)}return t[s++]=m,t.length=s,t}},{}],530:[function(r,O,B){var t=r("two-product"),d=r("robust-sum"),m=r("robust-scale"),p=r("robust-compress");function e(o,i,c,n){return function(a){return n(o(c(a[0][0],a[1][1]),c(-a[0][1],a[1][0])))}}function f(o,i,c,n){return function(a){return n(o(i(o(c(a[1][1],a[2][2]),c(-a[1][2],a[2][1])),a[0][0]),o(i(o(c(a[1][0],a[2][2]),c(-a[1][2],a[2][0])),-a[0][1]),i(o(c(a[1][0],a[2][1]),c(-a[1][1],a[2][0])),a[0][2]))))}}function u(o){return(o===2?e:o===3?f:void 0)(d,m,t,p)}var s=[function(){return[0]},function(o){return[o[0][0]]}];function l(o,i,c,n,a,g){return function(h){switch(h.length){case 0:return o(h);case 1:return i(h);case 2:return c(h);case 3:return n(h)}var y=a[h.length];return y||(y=a[h.length]=g(h.length)),y(h)}}(function(){for(;s.length<4;)s.push(u(s.length));O.exports=l.apply(void 0,s.concat([s,u]));for(var o=0;o<s.length;++o)O.exports[o]=s[o]})()},{"robust-compress":529,"robust-scale":536,"robust-sum":539,"two-product":588}],531:[function(r,O,B){var t=r("two-product"),d=r("robust-sum");O.exports=function(m,p){for(var e=t(m[0],p[0]),f=1;f<m.length;++f)e=d(e,t(m[f],p[f]));return e}},{"robust-sum":539,"two-product":588}],532:[function(r,O,B){var t=r("two-product"),d=r("robust-sum"),m=r("robust-subtract"),p=r("robust-scale");function e(n){return(n===3?f:n===4?u:n===5?s:l)(d,m,t,p)}function f(n,a,g,h){return function(y,v,_){var x=g(y[0],y[0]),T=h(x,v[0]),A=h(x,_[0]),S=g(v[0],v[0]),w=h(S,y[0]),C=h(S,_[0]),k=g(_[0],_[0]),L=h(k,y[0]),M=h(k,v[0]),P=n(a(M,C),a(w,T)),D=a(L,A),N=a(P,D);return N[N.length-1]}}function u(n,a,g,h){return function(y,v,_,x){var T=n(g(y[0],y[0]),g(y[1],y[1])),A=h(T,v[0]),S=h(T,_[0]),w=h(T,x[0]),C=n(g(v[0],v[0]),g(v[1],v[1])),k=h(C,y[0]),L=h(C,_[0]),M=h(C,x[0]),P=n(g(_[0],_[0]),g(_[1],_[1])),D=h(P,y[0]),N=h(P,v[0]),U=h(P,x[0]),q=n(g(x[0],x[0]),g(x[1],x[1])),X=h(q,y[0]),K=h(q,v[0]),Z=h(q,_[0]),H=n(n(h(a(Z,U),v[1]),n(h(a(K,M),-_[1]),h(a(N,L),x[1]))),n(h(a(K,M),y[1]),n(h(a(X,w),-v[1]),h(a(k,A),x[1])))),Y=n(n(h(a(Z,U),y[1]),n(h(a(X,w),-_[1]),h(a(D,S),x[1]))),n(h(a(N,L),y[1]),n(h(a(D,S),-v[1]),h(a(k,A),_[1])))),$=a(H,Y);return $[$.length-1]}}function s(n,a,g,h){return function(y,v,_,x,T){var A=n(g(y[0],y[0]),n(g(y[1],y[1]),g(y[2],y[2]))),S=h(A,v[0]),w=h(A,_[0]),C=h(A,x[0]),k=h(A,T[0]),L=n(g(v[0],v[0]),n(g(v[1],v[1]),g(v[2],v[2]))),M=h(L,y[0]),P=h(L,_[0]),D=h(L,x[0]),N=h(L,T[0]),U=n(g(_[0],_[0]),n(g(_[1],_[1]),g(_[2],_[2]))),q=h(U,y[0]),X=h(U,v[0]),K=h(U,x[0]),Z=h(U,T[0]),H=n(g(x[0],x[0]),n(g(x[1],x[1]),g(x[2],x[2]))),Y=h(H,y[0]),$=h(H,v[0]),z=h(H,_[0]),j=h(H,T[0]),W=n(g(T[0],T[0]),n(g(T[1],T[1]),g(T[2],T[2]))),ee=h(W,y[0]),J=h(W,v[0]),Q=h(W,_[0]),te=h(W,x[0]),ie=n(n(n(h(n(h(a(te,j),_[1]),n(h(a(Q,Z),-x[1]),h(a(z,K),T[1]))),v[2]),n(h(n(h(a(te,j),v[1]),n(h(a(J,N),-x[1]),h(a($,D),T[1]))),-_[2]),h(n(h(a(Q,Z),v[1]),n(h(a(J,N),-_[1]),h(a(X,P),T[1]))),x[2]))),n(h(n(h(a(z,K),v[1]),n(h(a($,D),-_[1]),h(a(X,P),x[1]))),-T[2]),n(h(n(h(a(te,j),v[1]),n(h(a(J,N),-x[1]),h(a($,D),T[1]))),y[2]),h(n(h(a(te,j),y[1]),n(h(a(ee,k),-x[1]),h(a(Y,C),T[1]))),-v[2])))),n(n(h(n(h(a(J,N),y[1]),n(h(a(ee,k),-v[1]),h(a(M,S),T[1]))),x[2]),n(h(n(h(a($,D),y[1]),n(h(a(Y,C),-v[1]),h(a(M,S),x[1]))),-T[2]),h(n(h(a(z,K),v[1]),n(h(a($,D),-_[1]),h(a(X,P),x[1]))),y[2]))),n(h(n(h(a(z,K),y[1]),n(h(a(Y,C),-_[1]),h(a(q,w),x[1]))),-v[2]),n(h(n(h(a($,D),y[1]),n(h(a(Y,C),-v[1]),h(a(M,S),x[1]))),_[2]),h(n(h(a(X,P),y[1]),n(h(a(q,w),-v[1]),h(a(M,S),_[1]))),-x[2]))))),ae=n(n(n(h(n(h(a(te,j),_[1]),n(h(a(Q,Z),-x[1]),h(a(z,K),T[1]))),y[2]),h(n(h(a(te,j),y[1]),n(h(a(ee,k),-x[1]),h(a(Y,C),T[1]))),-_[2])),n(h(n(h(a(Q,Z),y[1]),n(h(a(ee,k),-_[1]),h(a(q,w),T[1]))),x[2]),h(n(h(a(z,K),y[1]),n(h(a(Y,C),-_[1]),h(a(q,w),x[1]))),-T[2]))),n(n(h(n(h(a(Q,Z),v[1]),n(h(a(J,N),-_[1]),h(a(X,P),T[1]))),y[2]),h(n(h(a(Q,Z),y[1]),n(h(a(ee,k),-_[1]),h(a(q,w),T[1]))),-v[2])),n(h(n(h(a(J,N),y[1]),n(h(a(ee,k),-v[1]),h(a(M,S),T[1]))),_[2]),h(n(h(a(X,P),y[1]),n(h(a(q,w),-v[1]),h(a(M,S),_[1]))),-T[2])))),he=a(ie,ae);return he[he.length-1]}}function l(n,a,g,h){return function(y,v,_,x,T,A){var S=n(n(g(y[0],y[0]),g(y[1],y[1])),n(g(y[2],y[2]),g(y[3],y[3]))),w=h(S,v[0]),C=h(S,_[0]),k=h(S,x[0]),L=h(S,T[0]),M=h(S,A[0]),P=n(n(g(v[0],v[0]),g(v[1],v[1])),n(g(v[2],v[2]),g(v[3],v[3]))),D=h(P,y[0]),N=h(P,_[0]),U=h(P,x[0]),q=h(P,T[0]),X=h(P,A[0]),K=n(n(g(_[0],_[0]),g(_[1],_[1])),n(g(_[2],_[2]),g(_[3],_[3]))),Z=h(K,y[0]),H=h(K,v[0]),Y=h(K,x[0]),$=h(K,T[0]),z=h(K,A[0]),j=n(n(g(x[0],x[0]),g(x[1],x[1])),n(g(x[2],x[2]),g(x[3],x[3]))),W=h(j,y[0]),ee=h(j,v[0]),J=h(j,_[0]),Q=h(j,T[0]),te=h(j,A[0]),ie=n(n(g(T[0],T[0]),g(T[1],T[1])),n(g(T[2],T[2]),g(T[3],T[3]))),ae=h(ie,y[0]),he=h(ie,v[0]),se=h(ie,_[0]),de=h(ie,x[0]),ue=h(ie,A[0]),ve=n(n(g(A[0],A[0]),g(A[1],A[1])),n(g(A[2],A[2]),g(A[3],A[3]))),ke=h(ve,y[0]),Ee=h(ve,v[0]),be=h(ve,_[0]),xe=h(ve,x[0]),ce=h(ve,T[0]),ge=n(n(n(h(n(n(h(n(h(a(ce,ue),x[1]),n(h(a(xe,te),-T[1]),h(a(de,Q),A[1]))),_[2]),h(n(h(a(ce,ue),_[1]),n(h(a(be,z),-T[1]),h(a(se,$),A[1]))),-x[2])),n(h(n(h(a(xe,te),_[1]),n(h(a(be,z),-x[1]),h(a(J,Y),A[1]))),T[2]),h(n(h(a(de,Q),_[1]),n(h(a(se,$),-x[1]),h(a(J,Y),T[1]))),-A[2]))),v[3]),n(h(n(n(h(n(h(a(ce,ue),x[1]),n(h(a(xe,te),-T[1]),h(a(de,Q),A[1]))),v[2]),h(n(h(a(ce,ue),v[1]),n(h(a(Ee,X),-T[1]),h(a(he,q),A[1]))),-x[2])),n(h(n(h(a(xe,te),v[1]),n(h(a(Ee,X),-x[1]),h(a(ee,U),A[1]))),T[2]),h(n(h(a(de,Q),v[1]),n(h(a(he,q),-x[1]),h(a(ee,U),T[1]))),-A[2]))),-_[3]),h(n(n(h(n(h(a(ce,ue),_[1]),n(h(a(be,z),-T[1]),h(a(se,$),A[1]))),v[2]),h(n(h(a(ce,ue),v[1]),n(h(a(Ee,X),-T[1]),h(a(he,q),A[1]))),-_[2])),n(h(n(h(a(be,z),v[1]),n(h(a(Ee,X),-_[1]),h(a(H,N),A[1]))),T[2]),h(n(h(a(se,$),v[1]),n(h(a(he,q),-_[1]),h(a(H,N),T[1]))),-A[2]))),x[3]))),n(n(h(n(n(h(n(h(a(xe,te),_[1]),n(h(a(be,z),-x[1]),h(a(J,Y),A[1]))),v[2]),h(n(h(a(xe,te),v[1]),n(h(a(Ee,X),-x[1]),h(a(ee,U),A[1]))),-_[2])),n(h(n(h(a(be,z),v[1]),n(h(a(Ee,X),-_[1]),h(a(H,N),A[1]))),x[2]),h(n(h(a(J,Y),v[1]),n(h(a(ee,U),-_[1]),h(a(H,N),x[1]))),-A[2]))),-T[3]),h(n(n(h(n(h(a(de,Q),_[1]),n(h(a(se,$),-x[1]),h(a(J,Y),T[1]))),v[2]),h(n(h(a(de,Q),v[1]),n(h(a(he,q),-x[1]),h(a(ee,U),T[1]))),-_[2])),n(h(n(h(a(se,$),v[1]),n(h(a(he,q),-_[1]),h(a(H,N),T[1]))),x[2]),h(n(h(a(J,Y),v[1]),n(h(a(ee,U),-_[1]),h(a(H,N),x[1]))),-T[2]))),A[3])),n(h(n(n(h(n(h(a(ce,ue),x[1]),n(h(a(xe,te),-T[1]),h(a(de,Q),A[1]))),v[2]),h(n(h(a(ce,ue),v[1]),n(h(a(Ee,X),-T[1]),h(a(he,q),A[1]))),-x[2])),n(h(n(h(a(xe,te),v[1]),n(h(a(Ee,X),-x[1]),h(a(ee,U),A[1]))),T[2]),h(n(h(a(de,Q),v[1]),n(h(a(he,q),-x[1]),h(a(ee,U),T[1]))),-A[2]))),y[3]),h(n(n(h(n(h(a(ce,ue),x[1]),n(h(a(xe,te),-T[1]),h(a(de,Q),A[1]))),y[2]),h(n(h(a(ce,ue),y[1]),n(h(a(ke,M),-T[1]),h(a(ae,L),A[1]))),-x[2])),n(h(n(h(a(xe,te),y[1]),n(h(a(ke,M),-x[1]),h(a(W,k),A[1]))),T[2]),h(n(h(a(de,Q),y[1]),n(h(a(ae,L),-x[1]),h(a(W,k),T[1]))),-A[2]))),-v[3])))),n(n(n(h(n(n(h(n(h(a(ce,ue),v[1]),n(h(a(Ee,X),-T[1]),h(a(he,q),A[1]))),y[2]),h(n(h(a(ce,ue),y[1]),n(h(a(ke,M),-T[1]),h(a(ae,L),A[1]))),-v[2])),n(h(n(h(a(Ee,X),y[1]),n(h(a(ke,M),-v[1]),h(a(D,w),A[1]))),T[2]),h(n(h(a(he,q),y[1]),n(h(a(ae,L),-v[1]),h(a(D,w),T[1]))),-A[2]))),x[3]),h(n(n(h(n(h(a(xe,te),v[1]),n(h(a(Ee,X),-x[1]),h(a(ee,U),A[1]))),y[2]),h(n(h(a(xe,te),y[1]),n(h(a(ke,M),-x[1]),h(a(W,k),A[1]))),-v[2])),n(h(n(h(a(Ee,X),y[1]),n(h(a(ke,M),-v[1]),h(a(D,w),A[1]))),x[2]),h(n(h(a(ee,U),y[1]),n(h(a(W,k),-v[1]),h(a(D,w),x[1]))),-A[2]))),-T[3])),n(h(n(n(h(n(h(a(de,Q),v[1]),n(h(a(he,q),-x[1]),h(a(ee,U),T[1]))),y[2]),h(n(h(a(de,Q),y[1]),n(h(a(ae,L),-x[1]),h(a(W,k),T[1]))),-v[2])),n(h(n(h(a(he,q),y[1]),n(h(a(ae,L),-v[1]),h(a(D,w),T[1]))),x[2]),h(n(h(a(ee,U),y[1]),n(h(a(W,k),-v[1]),h(a(D,w),x[1]))),-T[2]))),A[3]),h(n(n(h(n(h(a(xe,te),_[1]),n(h(a(be,z),-x[1]),h(a(J,Y),A[1]))),v[2]),h(n(h(a(xe,te),v[1]),n(h(a(Ee,X),-x[1]),h(a(ee,U),A[1]))),-_[2])),n(h(n(h(a(be,z),v[1]),n(h(a(Ee,X),-_[1]),h(a(H,N),A[1]))),x[2]),h(n(h(a(J,Y),v[1]),n(h(a(ee,U),-_[1]),h(a(H,N),x[1]))),-A[2]))),y[3]))),n(n(h(n(n(h(n(h(a(xe,te),_[1]),n(h(a(be,z),-x[1]),h(a(J,Y),A[1]))),y[2]),h(n(h(a(xe,te),y[1]),n(h(a(ke,M),-x[1]),h(a(W,k),A[1]))),-_[2])),n(h(n(h(a(be,z),y[1]),n(h(a(ke,M),-_[1]),h(a(Z,C),A[1]))),x[2]),h(n(h(a(J,Y),y[1]),n(h(a(W,k),-_[1]),h(a(Z,C),x[1]))),-A[2]))),-v[3]),h(n(n(h(n(h(a(xe,te),v[1]),n(h(a(Ee,X),-x[1]),h(a(ee,U),A[1]))),y[2]),h(n(h(a(xe,te),y[1]),n(h(a(ke,M),-x[1]),h(a(W,k),A[1]))),-v[2])),n(h(n(h(a(Ee,X),y[1]),n(h(a(ke,M),-v[1]),h(a(D,w),A[1]))),x[2]),h(n(h(a(ee,U),y[1]),n(h(a(W,k),-v[1]),h(a(D,w),x[1]))),-A[2]))),_[3])),n(h(n(n(h(n(h(a(be,z),v[1]),n(h(a(Ee,X),-_[1]),h(a(H,N),A[1]))),y[2]),h(n(h(a(be,z),y[1]),n(h(a(ke,M),-_[1]),h(a(Z,C),A[1]))),-v[2])),n(h(n(h(a(Ee,X),y[1]),n(h(a(ke,M),-v[1]),h(a(D,w),A[1]))),_[2]),h(n(h(a(H,N),y[1]),n(h(a(Z,C),-v[1]),h(a(D,w),_[1]))),-A[2]))),-x[3]),h(n(n(h(n(h(a(J,Y),v[1]),n(h(a(ee,U),-_[1]),h(a(H,N),x[1]))),y[2]),h(n(h(a(J,Y),y[1]),n(h(a(W,k),-_[1]),h(a(Z,C),x[1]))),-v[2])),n(h(n(h(a(ee,U),y[1]),n(h(a(W,k),-v[1]),h(a(D,w),x[1]))),_[2]),h(n(h(a(H,N),y[1]),n(h(a(Z,C),-v[1]),h(a(D,w),_[1]))),-x[2]))),A[3]))))),we=n(n(n(h(n(n(h(n(h(a(ce,ue),x[1]),n(h(a(xe,te),-T[1]),h(a(de,Q),A[1]))),_[2]),h(n(h(a(ce,ue),_[1]),n(h(a(be,z),-T[1]),h(a(se,$),A[1]))),-x[2])),n(h(n(h(a(xe,te),_[1]),n(h(a(be,z),-x[1]),h(a(J,Y),A[1]))),T[2]),h(n(h(a(de,Q),_[1]),n(h(a(se,$),-x[1]),h(a(J,Y),T[1]))),-A[2]))),y[3]),n(h(n(n(h(n(h(a(ce,ue),x[1]),n(h(a(xe,te),-T[1]),h(a(de,Q),A[1]))),y[2]),h(n(h(a(ce,ue),y[1]),n(h(a(ke,M),-T[1]),h(a(ae,L),A[1]))),-x[2])),n(h(n(h(a(xe,te),y[1]),n(h(a(ke,M),-x[1]),h(a(W,k),A[1]))),T[2]),h(n(h(a(de,Q),y[1]),n(h(a(ae,L),-x[1]),h(a(W,k),T[1]))),-A[2]))),-_[3]),h(n(n(h(n(h(a(ce,ue),_[1]),n(h(a(be,z),-T[1]),h(a(se,$),A[1]))),y[2]),h(n(h(a(ce,ue),y[1]),n(h(a(ke,M),-T[1]),h(a(ae,L),A[1]))),-_[2])),n(h(n(h(a(be,z),y[1]),n(h(a(ke,M),-_[1]),h(a(Z,C),A[1]))),T[2]),h(n(h(a(se,$),y[1]),n(h(a(ae,L),-_[1]),h(a(Z,C),T[1]))),-A[2]))),x[3]))),n(n(h(n(n(h(n(h(a(xe,te),_[1]),n(h(a(be,z),-x[1]),h(a(J,Y),A[1]))),y[2]),h(n(h(a(xe,te),y[1]),n(h(a(ke,M),-x[1]),h(a(W,k),A[1]))),-_[2])),n(h(n(h(a(be,z),y[1]),n(h(a(ke,M),-_[1]),h(a(Z,C),A[1]))),x[2]),h(n(h(a(J,Y),y[1]),n(h(a(W,k),-_[1]),h(a(Z,C),x[1]))),-A[2]))),-T[3]),h(n(n(h(n(h(a(de,Q),_[1]),n(h(a(se,$),-x[1]),h(a(J,Y),T[1]))),y[2]),h(n(h(a(de,Q),y[1]),n(h(a(ae,L),-x[1]),h(a(W,k),T[1]))),-_[2])),n(h(n(h(a(se,$),y[1]),n(h(a(ae,L),-_[1]),h(a(Z,C),T[1]))),x[2]),h(n(h(a(J,Y),y[1]),n(h(a(W,k),-_[1]),h(a(Z,C),x[1]))),-T[2]))),A[3])),n(h(n(n(h(n(h(a(ce,ue),_[1]),n(h(a(be,z),-T[1]),h(a(se,$),A[1]))),v[2]),h(n(h(a(ce,ue),v[1]),n(h(a(Ee,X),-T[1]),h(a(he,q),A[1]))),-_[2])),n(h(n(h(a(be,z),v[1]),n(h(a(Ee,X),-_[1]),h(a(H,N),A[1]))),T[2]),h(n(h(a(se,$),v[1]),n(h(a(he,q),-_[1]),h(a(H,N),T[1]))),-A[2]))),y[3]),h(n(n(h(n(h(a(ce,ue),_[1]),n(h(a(be,z),-T[1]),h(a(se,$),A[1]))),y[2]),h(n(h(a(ce,ue),y[1]),n(h(a(ke,M),-T[1]),h(a(ae,L),A[1]))),-_[2])),n(h(n(h(a(be,z),y[1]),n(h(a(ke,M),-_[1]),h(a(Z,C),A[1]))),T[2]),h(n(h(a(se,$),y[1]),n(h(a(ae,L),-_[1]),h(a(Z,C),T[1]))),-A[2]))),-v[3])))),n(n(n(h(n(n(h(n(h(a(ce,ue),v[1]),n(h(a(Ee,X),-T[1]),h(a(he,q),A[1]))),y[2]),h(n(h(a(ce,ue),y[1]),n(h(a(ke,M),-T[1]),h(a(ae,L),A[1]))),-v[2])),n(h(n(h(a(Ee,X),y[1]),n(h(a(ke,M),-v[1]),h(a(D,w),A[1]))),T[2]),h(n(h(a(he,q),y[1]),n(h(a(ae,L),-v[1]),h(a(D,w),T[1]))),-A[2]))),_[3]),h(n(n(h(n(h(a(be,z),v[1]),n(h(a(Ee,X),-_[1]),h(a(H,N),A[1]))),y[2]),h(n(h(a(be,z),y[1]),n(h(a(ke,M),-_[1]),h(a(Z,C),A[1]))),-v[2])),n(h(n(h(a(Ee,X),y[1]),n(h(a(ke,M),-v[1]),h(a(D,w),A[1]))),_[2]),h(n(h(a(H,N),y[1]),n(h(a(Z,C),-v[1]),h(a(D,w),_[1]))),-A[2]))),-T[3])),n(h(n(n(h(n(h(a(se,$),v[1]),n(h(a(he,q),-_[1]),h(a(H,N),T[1]))),y[2]),h(n(h(a(se,$),y[1]),n(h(a(ae,L),-_[1]),h(a(Z,C),T[1]))),-v[2])),n(h(n(h(a(he,q),y[1]),n(h(a(ae,L),-v[1]),h(a(D,w),T[1]))),_[2]),h(n(h(a(H,N),y[1]),n(h(a(Z,C),-v[1]),h(a(D,w),_[1]))),-T[2]))),A[3]),h(n(n(h(n(h(a(de,Q),_[1]),n(h(a(se,$),-x[1]),h(a(J,Y),T[1]))),v[2]),h(n(h(a(de,Q),v[1]),n(h(a(he,q),-x[1]),h(a(ee,U),T[1]))),-_[2])),n(h(n(h(a(se,$),v[1]),n(h(a(he,q),-_[1]),h(a(H,N),T[1]))),x[2]),h(n(h(a(J,Y),v[1]),n(h(a(ee,U),-_[1]),h(a(H,N),x[1]))),-T[2]))),y[3]))),n(n(h(n(n(h(n(h(a(de,Q),_[1]),n(h(a(se,$),-x[1]),h(a(J,Y),T[1]))),y[2]),h(n(h(a(de,Q),y[1]),n(h(a(ae,L),-x[1]),h(a(W,k),T[1]))),-_[2])),n(h(n(h(a(se,$),y[1]),n(h(a(ae,L),-_[1]),h(a(Z,C),T[1]))),x[2]),h(n(h(a(J,Y),y[1]),n(h(a(W,k),-_[1]),h(a(Z,C),x[1]))),-T[2]))),-v[3]),h(n(n(h(n(h(a(de,Q),v[1]),n(h(a(he,q),-x[1]),h(a(ee,U),T[1]))),y[2]),h(n(h(a(de,Q),y[1]),n(h(a(ae,L),-x[1]),h(a(W,k),T[1]))),-v[2])),n(h(n(h(a(he,q),y[1]),n(h(a(ae,L),-v[1]),h(a(D,w),T[1]))),x[2]),h(n(h(a(ee,U),y[1]),n(h(a(W,k),-v[1]),h(a(D,w),x[1]))),-T[2]))),_[3])),n(h(n(n(h(n(h(a(se,$),v[1]),n(h(a(he,q),-_[1]),h(a(H,N),T[1]))),y[2]),h(n(h(a(se,$),y[1]),n(h(a(ae,L),-_[1]),h(a(Z,C),T[1]))),-v[2])),n(h(n(h(a(he,q),y[1]),n(h(a(ae,L),-v[1]),h(a(D,w),T[1]))),_[2]),h(n(h(a(H,N),y[1]),n(h(a(Z,C),-v[1]),h(a(D,w),_[1]))),-T[2]))),-x[3]),h(n(n(h(n(h(a(J,Y),v[1]),n(h(a(ee,U),-_[1]),h(a(H,N),x[1]))),y[2]),h(n(h(a(J,Y),y[1]),n(h(a(W,k),-_[1]),h(a(Z,C),x[1]))),-v[2])),n(h(n(h(a(ee,U),y[1]),n(h(a(W,k),-v[1]),h(a(D,w),x[1]))),_[2]),h(n(h(a(H,N),y[1]),n(h(a(Z,C),-v[1]),h(a(D,w),_[1]))),-x[2]))),T[3]))))),Me=a(ge,we);return Me[Me.length-1]}}var o=[function(){return 0},function(){return 0},function(){return 0}];function i(n){var a=o[n.length];return a||(a=o[n.length]=e(n.length)),a.apply(void 0,n)}function c(n,a,g,h,y,v,_,x){return function(T,A,S,w,C,k){switch(arguments.length){case 0:case 1:return 0;case 2:return h(T,A);case 3:return y(T,A,S);case 4:return v(T,A,S,w);case 5:return _(T,A,S,w,C);case 6:return x(T,A,S,w,C,k)}for(var L=new Array(arguments.length),M=0;M<arguments.length;++M)L[M]=arguments[M];return n(L)}}(function(){for(;o.length<=6;)o.push(e(o.length));O.exports=c.apply(void 0,[i].concat(o));for(var n=0;n<=6;++n)O.exports[n]=o[n]})()},{"robust-scale":536,"robust-subtract":538,"robust-sum":539,"two-product":588}],533:[function(r,O,B){var t=r("robust-determinant");function d(u){var s=u===2?m:p;return s(u<3?t[u]:t)}function m(u){return function(s,l){return[u([[+l[0],+s[0][1]],[+l[1],+s[1][1]]]),u([[+s[0][0],+l[0]],[+s[1][0],+l[1]]]),u(s)]}}function p(u){return function(s,l){return[u([[+l[0],+s[0][1],+s[0][2]],[+l[1],+s[1][1],+s[1][2]],[+l[2],+s[2][1],+s[2][2]]]),u([[+s[0][0],+l[0],+s[0][2]],[+s[1][0],+l[1],+s[1][2]],[+s[2][0],+l[2],+s[2][2]]]),u([[+s[0][0],+s[0][1],+l[0]],[+s[1][0],+s[1][1],+l[1]],[+s[2][0],+s[2][1],+l[2]]]),u(s)]}}var e=[function(){return[[0]]},function(u,s){return[[s[0]],[u[0][0]]]}];function f(u,s,l,o,i,c){return function(n,a){switch(n.length){case 0:return u(n,a);case 1:return s(n,a);case 2:return l(n,a);case 3:return o(n,a)}var g=i[n.length];return g||(g=i[n.length]=c(n.length)),g(n,a)}}(function(){for(;e.length<=3;)e.push(d(e.length));O.exports=f.apply(void 0,e.concat([e,d]));for(var u=0;u<3;++u)O.exports[u]=e[u]})()},{"robust-determinant":530}],534:[function(r,O,B){var t=r("two-product"),d=r("robust-sum"),m=r("robust-scale"),p=r("robust-subtract");function e(a,g,h,y){return function(v,_,x){var T=a(a(g(_[1],x[0]),g(-x[1],_[0])),a(g(v[1],_[0]),g(-_[1],v[0]))),A=a(g(v[1],x[0]),g(-x[1],v[0])),S=y(T,A);return S[S.length-1]}}function f(a,g,h,y){return function(v,_,x,T){var A=a(a(h(a(g(x[1],T[0]),g(-T[1],x[0])),_[2]),a(h(a(g(_[1],T[0]),g(-T[1],_[0])),-x[2]),h(a(g(_[1],x[0]),g(-x[1],_[0])),T[2]))),a(h(a(g(_[1],T[0]),g(-T[1],_[0])),v[2]),a(h(a(g(v[1],T[0]),g(-T[1],v[0])),-_[2]),h(a(g(v[1],_[0]),g(-_[1],v[0])),T[2])))),S=a(a(h(a(g(x[1],T[0]),g(-T[1],x[0])),v[2]),a(h(a(g(v[1],T[0]),g(-T[1],v[0])),-x[2]),h(a(g(v[1],x[0]),g(-x[1],v[0])),T[2]))),a(h(a(g(_[1],x[0]),g(-x[1],_[0])),v[2]),a(h(a(g(v[1],x[0]),g(-x[1],v[0])),-_[2]),h(a(g(v[1],_[0]),g(-_[1],v[0])),x[2])))),w=y(A,S);return w[w.length-1]}}function u(a,g,h,y){return function(v,_,x,T,A){var S=a(a(a(h(a(h(a(g(T[1],A[0]),g(-A[1],T[0])),x[2]),a(h(a(g(x[1],A[0]),g(-A[1],x[0])),-T[2]),h(a(g(x[1],T[0]),g(-T[1],x[0])),A[2]))),_[3]),a(h(a(h(a(g(T[1],A[0]),g(-A[1],T[0])),_[2]),a(h(a(g(_[1],A[0]),g(-A[1],_[0])),-T[2]),h(a(g(_[1],T[0]),g(-T[1],_[0])),A[2]))),-x[3]),h(a(h(a(g(x[1],A[0]),g(-A[1],x[0])),_[2]),a(h(a(g(_[1],A[0]),g(-A[1],_[0])),-x[2]),h(a(g(_[1],x[0]),g(-x[1],_[0])),A[2]))),T[3]))),a(h(a(h(a(g(x[1],T[0]),g(-T[1],x[0])),_[2]),a(h(a(g(_[1],T[0]),g(-T[1],_[0])),-x[2]),h(a(g(_[1],x[0]),g(-x[1],_[0])),T[2]))),-A[3]),a(h(a(h(a(g(T[1],A[0]),g(-A[1],T[0])),_[2]),a(h(a(g(_[1],A[0]),g(-A[1],_[0])),-T[2]),h(a(g(_[1],T[0]),g(-T[1],_[0])),A[2]))),v[3]),h(a(h(a(g(T[1],A[0]),g(-A[1],T[0])),v[2]),a(h(a(g(v[1],A[0]),g(-A[1],v[0])),-T[2]),h(a(g(v[1],T[0]),g(-T[1],v[0])),A[2]))),-_[3])))),a(a(h(a(h(a(g(_[1],A[0]),g(-A[1],_[0])),v[2]),a(h(a(g(v[1],A[0]),g(-A[1],v[0])),-_[2]),h(a(g(v[1],_[0]),g(-_[1],v[0])),A[2]))),T[3]),a(h(a(h(a(g(_[1],T[0]),g(-T[1],_[0])),v[2]),a(h(a(g(v[1],T[0]),g(-T[1],v[0])),-_[2]),h(a(g(v[1],_[0]),g(-_[1],v[0])),T[2]))),-A[3]),h(a(h(a(g(x[1],T[0]),g(-T[1],x[0])),_[2]),a(h(a(g(_[1],T[0]),g(-T[1],_[0])),-x[2]),h(a(g(_[1],x[0]),g(-x[1],_[0])),T[2]))),v[3]))),a(h(a(h(a(g(x[1],T[0]),g(-T[1],x[0])),v[2]),a(h(a(g(v[1],T[0]),g(-T[1],v[0])),-x[2]),h(a(g(v[1],x[0]),g(-x[1],v[0])),T[2]))),-_[3]),a(h(a(h(a(g(_[1],T[0]),g(-T[1],_[0])),v[2]),a(h(a(g(v[1],T[0]),g(-T[1],v[0])),-_[2]),h(a(g(v[1],_[0]),g(-_[1],v[0])),T[2]))),x[3]),h(a(h(a(g(_[1],x[0]),g(-x[1],_[0])),v[2]),a(h(a(g(v[1],x[0]),g(-x[1],v[0])),-_[2]),h(a(g(v[1],_[0]),g(-_[1],v[0])),x[2]))),-T[3]))))),w=a(a(a(h(a(h(a(g(T[1],A[0]),g(-A[1],T[0])),x[2]),a(h(a(g(x[1],A[0]),g(-A[1],x[0])),-T[2]),h(a(g(x[1],T[0]),g(-T[1],x[0])),A[2]))),v[3]),h(a(h(a(g(T[1],A[0]),g(-A[1],T[0])),v[2]),a(h(a(g(v[1],A[0]),g(-A[1],v[0])),-T[2]),h(a(g(v[1],T[0]),g(-T[1],v[0])),A[2]))),-x[3])),a(h(a(h(a(g(x[1],A[0]),g(-A[1],x[0])),v[2]),a(h(a(g(v[1],A[0]),g(-A[1],v[0])),-x[2]),h(a(g(v[1],x[0]),g(-x[1],v[0])),A[2]))),T[3]),h(a(h(a(g(x[1],T[0]),g(-T[1],x[0])),v[2]),a(h(a(g(v[1],T[0]),g(-T[1],v[0])),-x[2]),h(a(g(v[1],x[0]),g(-x[1],v[0])),T[2]))),-A[3]))),a(a(h(a(h(a(g(x[1],A[0]),g(-A[1],x[0])),_[2]),a(h(a(g(_[1],A[0]),g(-A[1],_[0])),-x[2]),h(a(g(_[1],x[0]),g(-x[1],_[0])),A[2]))),v[3]),h(a(h(a(g(x[1],A[0]),g(-A[1],x[0])),v[2]),a(h(a(g(v[1],A[0]),g(-A[1],v[0])),-x[2]),h(a(g(v[1],x[0]),g(-x[1],v[0])),A[2]))),-_[3])),a(h(a(h(a(g(_[1],A[0]),g(-A[1],_[0])),v[2]),a(h(a(g(v[1],A[0]),g(-A[1],v[0])),-_[2]),h(a(g(v[1],_[0]),g(-_[1],v[0])),A[2]))),x[3]),h(a(h(a(g(_[1],x[0]),g(-x[1],_[0])),v[2]),a(h(a(g(v[1],x[0]),g(-x[1],v[0])),-_[2]),h(a(g(v[1],_[0]),g(-_[1],v[0])),x[2]))),-A[3])))),C=y(S,w);return C[C.length-1]}}function s(a){return(a===3?e:a===4?f:u)(d,t,m,p)}var l=s(3),o=s(4),i=[function(){return 0},function(){return 0},function(a,g){return g[0]-a[0]},function(a,g,h){var y,v=(a[1]-h[1])*(g[0]-h[0]),_=(a[0]-h[0])*(g[1]-h[1]),x=v-_;if(v>0){if(_<=0)return x;y=v+_}else{if(!(v<0)||_>=0)return x;y=-(v+_)}var T=33306690738754716e-32*y;return x>=T||x<=-T?x:l(a,g,h)},function(a,g,h,y){var v=a[0]-y[0],_=g[0]-y[0],x=h[0]-y[0],T=a[1]-y[1],A=g[1]-y[1],S=h[1]-y[1],w=a[2]-y[2],C=g[2]-y[2],k=h[2]-y[2],L=_*S,M=x*A,P=x*T,D=v*S,N=v*A,U=_*T,q=w*(L-M)+C*(P-D)+k*(N-U),X=7771561172376103e-31*((Math.abs(L)+Math.abs(M))*Math.abs(w)+(Math.abs(P)+Math.abs(D))*Math.abs(C)+(Math.abs(N)+Math.abs(U))*Math.abs(k));return q>X||-q>X?q:o(a,g,h,y)}];function c(a){var g=i[a.length];return g||(g=i[a.length]=s(a.length)),g.apply(void 0,a)}function n(a,g,h,y,v,_,x){return function(T,A,S,w,C){switch(arguments.length){case 0:case 1:return 0;case 2:return y(T,A);case 3:return v(T,A,S);case 4:return _(T,A,S,w);case 5:return x(T,A,S,w,C)}for(var k=new Array(arguments.length),L=0;L<arguments.length;++L)k[L]=arguments[L];return a(k)}}(function(){for(;i.length<=5;)i.push(s(i.length));O.exports=n.apply(void 0,[c].concat(i));for(var a=0;a<=5;++a)O.exports[a]=i[a]})()},{"robust-scale":536,"robust-subtract":538,"robust-sum":539,"two-product":588}],535:[function(r,O,B){var t=r("robust-sum"),d=r("robust-scale");O.exports=function(m,p){if(m.length===1)return d(p,m[0]);if(p.length===1)return d(m,p[0]);if(m.length===0||p.length===0)return[0];var e=[0];if(m.length<p.length)for(var f=0;f<m.length;++f)e=t(e,d(p,m[f]));else for(f=0;f<p.length;++f)e=t(e,d(m,p[f]));return e}},{"robust-scale":536,"robust-sum":539}],536:[function(r,O,B){var t=r("two-product"),d=r("two-sum");O.exports=function(m,p){var e=m.length;if(e===1){var f=t(m[0],p);return f[0]?f:[f[1]]}var u=new Array(2*e),s=[.1,.1],l=[.1,.1],o=0;t(m[0],p,s),s[0]&&(u[o++]=s[0]);for(var i=1;i<e;++i){t(m[i],p,l);var c=s[1];d(c,l[0],s),s[0]&&(u[o++]=s[0]);var n=l[1],a=s[1],g=n+a,h=a-(g-n);s[1]=g,h&&(u[o++]=h)}return s[1]&&(u[o++]=s[1]),o===0&&(u[o++]=0),u.length=o,u}},{"two-product":588,"two-sum":589}],537:[function(r,O,B){O.exports=function(d,m,p,e){var f=t(d,p,e),u=t(m,p,e);if(f>0&&u>0||f<0&&u<0)return!1;var s=t(p,d,m),l=t(e,d,m);return s>0&&l>0||s<0&&l<0?!1:f===0&&u===0&&s===0&&l===0?function(o,i,c,n){for(var a=0;a<2;++a){var g=o[a],h=i[a],y=Math.min(g,h),v=Math.max(g,h),_=c[a],x=n[a],T=Math.min(_,x);if(Math.max(_,x)<y||v<T)return!1}return!0}(d,m,p,e):!0};var t=r("robust-orientation")[3]},{"robust-orientation":534}],538:[function(r,O,B){O.exports=function(t,d){var m=0|t.length,p=0|d.length;if(m===1&&p===1)return function(S,w){var C=S+w,k=C-S,L=S-(C-k)+(w-k);return L?[L,C]:[C]}(t[0],-d[0]);var e,f,u=new Array(m+p),s=0,l=0,o=0,i=Math.abs,c=t[l],n=i(c),a=-d[o],g=i(a);n<g?(f=c,(l+=1)<m&&(c=t[l],n=i(c))):(f=a,(o+=1)<p&&(a=-d[o],g=i(a))),l<m&&n<g||o>=p?(e=c,(l+=1)<m&&(c=t[l],n=i(c))):(e=a,(o+=1)<p&&(a=-d[o],g=i(a)));for(var h,y,v=e+f,_=v-e,x=f-_,T=x,A=v;l<m&&o<p;)n<g?(e=c,(l+=1)<m&&(c=t[l],n=i(c))):(e=a,(o+=1)<p&&(a=-d[o],g=i(a))),(x=(f=T)-(_=(v=e+f)-e))&&(u[s++]=x),T=A-((h=A+v)-(y=h-A))+(v-y),A=h;for(;l<m;)(x=(f=T)-(_=(v=(e=c)+f)-e))&&(u[s++]=x),T=A-((h=A+v)-(y=h-A))+(v-y),A=h,(l+=1)<m&&(c=t[l]);for(;o<p;)(x=(f=T)-(_=(v=(e=a)+f)-e))&&(u[s++]=x),T=A-((h=A+v)-(y=h-A))+(v-y),A=h,(o+=1)<p&&(a=-d[o]);return T&&(u[s++]=T),A&&(u[s++]=A),s||(u[s++]=0),u.length=s,u}},{}],539:[function(r,O,B){O.exports=function(t,d){var m=0|t.length,p=0|d.length;if(m===1&&p===1)return function(S,w){var C=S+w,k=C-S,L=S-(C-k)+(w-k);return L?[L,C]:[C]}(t[0],d[0]);var e,f,u=new Array(m+p),s=0,l=0,o=0,i=Math.abs,c=t[l],n=i(c),a=d[o],g=i(a);n<g?(f=c,(l+=1)<m&&(c=t[l],n=i(c))):(f=a,(o+=1)<p&&(a=d[o],g=i(a))),l<m&&n<g||o>=p?(e=c,(l+=1)<m&&(c=t[l],n=i(c))):(e=a,(o+=1)<p&&(a=d[o],g=i(a)));for(var h,y,v=e+f,_=v-e,x=f-_,T=x,A=v;l<m&&o<p;)n<g?(e=c,(l+=1)<m&&(c=t[l],n=i(c))):(e=a,(o+=1)<p&&(a=d[o],g=i(a))),(x=(f=T)-(_=(v=e+f)-e))&&(u[s++]=x),T=A-((h=A+v)-(y=h-A))+(v-y),A=h;for(;l<m;)(x=(f=T)-(_=(v=(e=c)+f)-e))&&(u[s++]=x),T=A-((h=A+v)-(y=h-A))+(v-y),A=h,(l+=1)<m&&(c=t[l]);for(;o<p;)(x=(f=T)-(_=(v=(e=a)+f)-e))&&(u[s++]=x),T=A-((h=A+v)-(y=h-A))+(v-y),A=h,(o+=1)<p&&(a=d[o]);return T&&(u[s++]=T),A&&(u[s++]=A),s||(u[s++]=0),u.length=s,u}},{}],540:[function(r,O,B){var t=r("buffer"),d=t.Buffer;function m(e,f){for(var u in e)f[u]=e[u]}function p(e,f,u){return d(e,f,u)}d.from&&d.alloc&&d.allocUnsafe&&d.allocUnsafeSlow?O.exports=t:(m(t,B),B.Buffer=p),p.prototype=Object.create(d.prototype),m(d,p),p.from=function(e,f,u){if(typeof e=="number")throw new TypeError("Argument must not be a number");return d(e,f,u)},p.alloc=function(e,f,u){if(typeof e!="number")throw new TypeError("Argument must be a number");var s=d(e);return f!==void 0?typeof u=="string"?s.fill(f,u):s.fill(f):s.fill(0),s},p.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return d(e)},p.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(e)}},{buffer:117}],541:[function(r,O,B){O.exports=function(t){return t<0?-1:t>0?1:0}},{}],542:[function(r,O,B){O.exports=function(m){return d(t(m))};var t=r("boundary-cells"),d=r("reduce-simplicial-complex")},{"boundary-cells":107,"reduce-simplicial-complex":521}],543:[function(r,O,B){O.exports=function(e,f,u,s){if(u=u||0,s===void 0&&(s=function(h){for(var y=h.length,v=0,_=0;_<y;++_)v=0|Math.max(v,h[_].length);return v-1}(e)),e.length===0||s<1)return{cells:[],vertexIds:[],vertexWeights:[]};var l=function(h,y){for(var v=h.length,_=d.mallocUint8(v),x=0;x<v;++x)_[x]=h[x]<y|0;return _}(f,+u),o=function(h,y){for(var v=h.length,_=y*(y+1)/2*v|0,x=d.mallocUint32(2*_),T=0,A=0;A<v;++A)for(var S=h[A],w=(y=S.length,0);w<y;++w)for(var C=0;C<w;++C){var k=S[C],L=S[w];x[T++]=0|Math.min(k,L),x[T++]=0|Math.max(k,L)}m(t(x,[T/2|0,2]));var M=2;for(A=2;A<T;A+=2)x[A-2]===x[A]&&x[A-1]===x[A+1]||(x[M++]=x[A],x[M++]=x[A+1]);return t(x,[M/2|0,2])}(e,s),i=function(h,y,v,_){for(var x=h.data,T=h.shape[0],A=d.mallocDouble(T),S=0,w=0;w<T;++w){var C=x[2*w],k=x[2*w+1];if(v[C]!==v[k]){var L=y[C],M=y[k];x[2*S]=C,x[2*S+1]=k,A[S++]=(M-_)/(M-L)}}return h.shape[0]=S,t(A,[S])}(o,f,l,+u),c=function(h,y){var v=d.mallocInt32(2*y),_=h.shape[0],x=h.data;v[0]=0;for(var T=0,A=0;A<_;++A){var S=x[2*A];if(S!==T){for(v[2*T+1]=A;++T<S;)v[2*T]=A,v[2*T+1]=A;v[2*T]=A}}for(v[2*T+1]=_;++T<y;)v[2*T]=v[2*T+1]=_;return v}(o,0|f.length),n=p(s)(e,o.data,c,l),a=function(h){for(var y=0|h.shape[0],v=h.data,_=new Array(y),x=0;x<y;++x)_[x]=[v[2*x],v[2*x+1]];return _}(o),g=[].slice.call(i.data,0,i.shape[0]);return d.free(l),d.free(o.data),d.free(i.data),d.free(c),{cells:n,vertexIds:a,vertexWeights:g}};var t=r("ndarray"),d=r("typedarray-pool"),m=r("ndarray-sort"),p=r("./lib/codegen")},{"./lib/codegen":544,ndarray:472,"ndarray-sort":471,"typedarray-pool":601}],544:[function(r,O,B){O.exports=function(d){return t[d]()};var t=[function(){return function(d,m,p,e){for(var f=d.length,u=0;u<f;++u)d[u].length;return[]}},function(){function d(m,p,e,f){for(var u=0|Math.min(e,f),s=0|Math.max(e,f),l=m[2*u],o=m[2*u+1];l<o;){var i=l+o>>1,c=p[2*i+1];if(c===s)return i;s<c?o=i:l=i+1}return l}return function(m,p,e,f){for(var u=m.length,s=[],l=0;l<u;++l){var o=m[l];if(o.length===2){var i=(f[o[0]]<<0)+(f[o[1]]<<1);if(i===0||i===3)continue;switch(i){case 0:break;case 1:s.push([d(e,p,o[0],o[1])]);break;case 2:s.push([d(e,p,o[1],o[0])])}}}return s}},function(){function d(m,p,e,f){for(var u=0|Math.min(e,f),s=0|Math.max(e,f),l=m[2*u],o=m[2*u+1];l<o;){var i=l+o>>1,c=p[2*i+1];if(c===s)return i;s<c?o=i:l=i+1}return l}return function(m,p,e,f){for(var u=m.length,s=[],l=0;l<u;++l){var o=m[l],i=o.length;if(i===3){if((c=(f[o[0]]<<0)+(f[o[1]]<<1)+(f[o[2]]<<2))==0||c===7)continue;switch(c){case 0:break;case 1:s.push([d(e,p,o[0],o[2]),d(e,p,o[0],o[1])]);break;case 2:s.push([d(e,p,o[1],o[0]),d(e,p,o[1],o[2])]);break;case 3:s.push([d(e,p,o[0],o[2]),d(e,p,o[1],o[2])]);break;case 4:s.push([d(e,p,o[2],o[1]),d(e,p,o[2],o[0])]);break;case 5:s.push([d(e,p,o[2],o[1]),d(e,p,o[0],o[1])]);break;case 6:s.push([d(e,p,o[1],o[0]),d(e,p,o[2],o[0])])}}else if(i===2){var c;if((c=(f[o[0]]<<0)+(f[o[1]]<<1))==0||c===3)continue;switch(c){case 0:break;case 1:s.push([d(e,p,o[0],o[1])]);break;case 2:s.push([d(e,p,o[1],o[0])])}}}return s}},function(){function d(m,p,e,f){for(var u=0|Math.min(e,f),s=0|Math.max(e,f),l=m[2*u],o=m[2*u+1];l<o;){var i=l+o>>1,c=p[2*i+1];if(c===s)return i;s<c?o=i:l=i+1}return l}return function(m,p,e,f){for(var u=m.length,s=[],l=0;l<u;++l){var o=m[l],i=o.length;if(i===4){if((c=(f[o[0]]<<0)+(f[o[1]]<<1)+(f[o[2]]<<2)+(f[o[3]]<<3))==0||c===15)continue;switch(c){case 0:break;case 1:s.push([d(e,p,o[0],o[1]),d(e,p,o[0],o[2]),d(e,p,o[0],o[3])]);break;case 2:s.push([d(e,p,o[1],o[2]),d(e,p,o[1],o[0]),d(e,p,o[1],o[3])]);break;case 3:s.push([d(e,p,o[1],o[2]),d(e,p,o[0],o[2]),d(e,p,o[0],o[3])],[d(e,p,o[1],o[3]),d(e,p,o[1],o[2]),d(e,p,o[0],o[3])]);break;case 4:s.push([d(e,p,o[2],o[0]),d(e,p,o[2],o[1]),d(e,p,o[2],o[3])]);break;case 5:s.push([d(e,p,o[0],o[1]),d(e,p,o[2],o[1]),d(e,p,o[0],o[3])],[d(e,p,o[2],o[1]),d(e,p,o[2],o[3]),d(e,p,o[0],o[3])]);break;case 6:s.push([d(e,p,o[2],o[0]),d(e,p,o[1],o[0]),d(e,p,o[1],o[3])],[d(e,p,o[2],o[3]),d(e,p,o[2],o[0]),d(e,p,o[1],o[3])]);break;case 7:s.push([d(e,p,o[0],o[3]),d(e,p,o[1],o[3]),d(e,p,o[2],o[3])]);break;case 8:s.push([d(e,p,o[3],o[1]),d(e,p,o[3],o[0]),d(e,p,o[3],o[2])]);break;case 9:s.push([d(e,p,o[3],o[1]),d(e,p,o[0],o[1]),d(e,p,o[0],o[2])],[d(e,p,o[3],o[2]),d(e,p,o[3],o[1]),d(e,p,o[0],o[2])]);break;case 10:s.push([d(e,p,o[1],o[0]),d(e,p,o[3],o[0]),d(e,p,o[1],o[2])],[d(e,p,o[3],o[0]),d(e,p,o[3],o[2]),d(e,p,o[1],o[2])]);break;case 11:s.push([d(e,p,o[1],o[2]),d(e,p,o[0],o[2]),d(e,p,o[3],o[2])]);break;case 12:s.push([d(e,p,o[3],o[0]),d(e,p,o[2],o[0]),d(e,p,o[2],o[1])],[d(e,p,o[3],o[1]),d(e,p,o[3],o[0]),d(e,p,o[2],o[1])]);break;case 13:s.push([d(e,p,o[0],o[1]),d(e,p,o[2],o[1]),d(e,p,o[3],o[1])]);break;case 14:s.push([d(e,p,o[2],o[0]),d(e,p,o[1],o[0]),d(e,p,o[3],o[0])])}}else if(i===3){if((c=(f[o[0]]<<0)+(f[o[1]]<<1)+(f[o[2]]<<2))==0||c===7)continue;switch(c){case 0:break;case 1:s.push([d(e,p,o[0],o[2]),d(e,p,o[0],o[1])]);break;case 2:s.push([d(e,p,o[1],o[0]),d(e,p,o[1],o[2])]);break;case 3:s.push([d(e,p,o[0],o[2]),d(e,p,o[1],o[2])]);break;case 4:s.push([d(e,p,o[2],o[1]),d(e,p,o[2],o[0])]);break;case 5:s.push([d(e,p,o[2],o[1]),d(e,p,o[0],o[1])]);break;case 6:s.push([d(e,p,o[1],o[0]),d(e,p,o[2],o[0])])}}else if(i===2){var c;if((c=(f[o[0]]<<0)+(f[o[1]]<<1))==0||c===3)continue;switch(c){case 0:break;case 1:s.push([d(e,p,o[0],o[1])]);break;case 2:s.push([d(e,p,o[1],o[0])])}}}return s}}]},{}],545:[function(r,O,B){var t=r("bit-twiddle"),d=r("union-find");function m(o,i){var c=o.length,n=o.length-i.length,a=Math.min;if(n)return n;switch(c){case 0:return 0;case 1:return o[0]-i[0];case 2:return(y=o[0]+o[1]-i[0]-i[1])||a(o[0],o[1])-a(i[0],i[1]);case 3:var g=o[0]+o[1],h=i[0]+i[1];if(y=g+o[2]-(h+i[2]))return y;var y,v=a(o[0],o[1]),_=a(i[0],i[1]);return(y=a(v,o[2])-a(_,i[2]))||a(v+o[2],g)-a(_+i[2],h);default:var x=o.slice(0);x.sort();var T=i.slice(0);T.sort();for(var A=0;A<c;++A)if(n=x[A]-T[A])return n;return 0}}function p(o,i){return m(o[0],i[0])}function e(o,i){if(i){for(var c=o.length,n=new Array(c),a=0;a<c;++a)n[a]=[o[a],i[a]];for(n.sort(p),a=0;a<c;++a)o[a]=n[a][0],i[a]=n[a][1];return o}return o.sort(m),o}function f(o){if(o.length===0)return[];for(var i=1,c=o.length,n=1;n<c;++n){var a=o[n];if(m(a,o[n-1])){if(n===i){i++;continue}o[i++]=a}}return o.length=i,o}function u(o,i){for(var c=0,n=o.length-1,a=-1;c<=n;){var g=c+n>>1,h=m(o[g],i);h<=0?(h===0&&(a=g),c=g+1):h>0&&(n=g-1)}return a}function s(o,i){for(var c=new Array(o.length),n=0,a=c.length;n<a;++n)c[n]=[];for(var g=[],h=(n=0,i.length);n<h;++n)for(var y=i[n],v=y.length,_=1,x=1<<v;_<x;++_){g.length=t.popCount(_);for(var T=0,A=0;A<v;++A)_&1<<A&&(g[T++]=y[A]);var S=u(o,g);if(!(S<0))for(;c[S++].push(n),!(S>=o.length||m(o[S],g)!==0););}return c}function l(o,i){if(i<0)return[];for(var c=[],n=(1<<i+1)-1,a=0;a<o.length;++a)for(var g=o[a],h=n;h<1<<g.length;h=t.nextCombination(h)){for(var y=new Array(i+1),v=0,_=0;_<g.length;++_)h&1<<_&&(y[v++]=g[_]);c.push(y)}return e(c)}B.dimension=function(o){for(var i=0,c=Math.max,n=0,a=o.length;n<a;++n)i=c(i,o[n].length);return i-1},B.countVertices=function(o){for(var i=-1,c=Math.max,n=0,a=o.length;n<a;++n)for(var g=o[n],h=0,y=g.length;h<y;++h)i=c(i,g[h]);return i+1},B.cloneCells=function(o){for(var i=new Array(o.length),c=0,n=o.length;c<n;++c)i[c]=o[c].slice(0);return i},B.compareCells=m,B.normalize=e,B.unique=f,B.findCell=u,B.incidence=s,B.dual=function(o,i){if(!i)return s(f(l(o,0)),o);for(var c=new Array(i),n=0;n<i;++n)c[n]=[];n=0;for(var a=o.length;n<a;++n)for(var g=o[n],h=0,y=g.length;h<y;++h)c[g[h]].push(n);return c},B.explode=function(o){for(var i=[],c=0,n=o.length;c<n;++c)for(var a=o[c],g=0|a.length,h=1,y=1<<g;h<y;++h){for(var v=[],_=0;_<g;++_)h>>>_&1&&v.push(a[_]);i.push(v)}return e(i)},B.skeleton=l,B.boundary=function(o){for(var i=[],c=0,n=o.length;c<n;++c)for(var a=o[c],g=0,h=a.length;g<h;++g){for(var y=new Array(a.length-1),v=0,_=0;v<h;++v)v!==g&&(y[_++]=a[v]);i.push(y)}return e(i)},B.connectedComponents=function(o,i){return i?function(c,n){for(var a=new d(n),g=0;g<c.length;++g)for(var h=c[g],y=0;y<h.length;++y)for(var v=y+1;v<h.length;++v)a.link(h[y],h[v]);var _=[],x=a.ranks;for(g=0;g<x.length;++g)x[g]=-1;for(g=0;g<c.length;++g){var T=a.find(c[g][0]);x[T]<0?(x[T]=_.length,_.push([c[g].slice(0)])):_[x[T]].push(c[g].slice(0))}return _}(o,i):function(c){for(var n=f(e(l(c,0))),a=new d(n.length),g=0;g<c.length;++g)for(var h=c[g],y=0;y<h.length;++y)for(var v=u(n,[h[y]]),_=y+1;_<h.length;++_)a.link(v,u(n,[h[_]]));var x=[],T=a.ranks;for(g=0;g<T.length;++g)T[g]=-1;for(g=0;g<c.length;++g){var A=a.find(u(n,[c[g][0]]));T[A]<0?(T[A]=x.length,x.push([c[g].slice(0)])):x[T[A]].push(c[g].slice(0))}return x}(o)}},{"bit-twiddle":104,"union-find":602}],546:[function(r,O,B){arguments[4][104][0].apply(B,arguments)},{dup:104}],547:[function(r,O,B){arguments[4][545][0].apply(B,arguments)},{"bit-twiddle":546,dup:545,"union-find":548}],548:[function(r,O,B){function t(d){this.roots=new Array(d),this.ranks=new Array(d);for(var m=0;m<d;++m)this.roots[m]=m,this.ranks[m]=0}O.exports=t,t.prototype.length=function(){return this.roots.length},t.prototype.makeSet=function(){var d=this.roots.length;return this.roots.push(d),this.ranks.push(0),d},t.prototype.find=function(d){for(var m=this.roots;m[d]!==d;){var p=m[d];m[d]=m[p],d=p}return d},t.prototype.link=function(d,m){var p=this.find(d),e=this.find(m);if(p!==e){var f=this.ranks,u=this.roots,s=f[p],l=f[e];s<l?u[p]=e:l<s?u[e]=p:(u[e]=p,++f[p])}}},{}],549:[function(r,O,B){O.exports=function(m,p,e){for(var f=p.length,u=m.length,s=new Array(f),l=new Array(f),o=new Array(f),i=new Array(f),c=0;c<f;++c)s[c]=l[c]=-1,o[c]=1/0,i[c]=!1;for(c=0;c<u;++c){var n=m[c];if(n.length!==2)throw new Error("Input must be a graph");var a=n[1],g=n[0];l[g]!==-1?l[g]=-2:l[g]=a,s[a]!==-1?s[a]=-2:s[a]=g}function h(U){if(i[U])return 1/0;var q,X,K,Z,H,Y=s[U],$=l[U];return Y<0||$<0?1/0:(q=p[U],X=p[Y],K=p[$],Z=Math.abs(t(q,X,K)),H=Math.sqrt(Math.pow(X[0]-K[0],2)+Math.pow(X[1]-K[1],2)),Z/H)}function y(U,q){var X=C[U],K=C[q];C[U]=K,C[q]=X,k[X]=q,k[K]=U}function v(U){return o[C[U]]}function _(U){return 1&U?U-1>>1:(U>>1)-1}function x(U){for(var q=v(U);;){var X=q,K=2*U+1,Z=2*(U+1),H=U;if(K<L){var Y=v(K);Y<X&&(H=K,X=Y)}if(Z<L&&v(Z)<X&&(H=Z),H===U)return U;y(U,H),U=H}}function T(U){for(var q=v(U);U>0;){var X=_(U);if(X>=0&&q<v(X)){y(U,X),U=X;continue}return U}}function A(){if(L>0){var U=C[0];return y(0,L-1),L-=1,x(0),U}return-1}function S(U,q){var X=C[U];return o[X]===q?U:(o[X]=-1/0,T(U),A(),o[X]=q,T((L+=1)-1))}function w(U){if(!i[U]){i[U]=!0;var q=s[U],X=l[U];s[X]>=0&&(s[X]=q),l[q]>=0&&(l[q]=X),k[q]>=0&&S(k[q],h(q)),k[X]>=0&&S(k[X],h(X))}}var C=[],k=new Array(f);for(c=0;c<f;++c)(o[c]=h(c))<1/0?(k[c]=C.length,C.push(c)):k[c]=-1;var L=C.length;for(c=L>>1;c>=0;--c)x(c);for(;;){var M=A();if(M<0||o[M]>e)break;w(M)}var P=[];for(c=0;c<f;++c)i[c]||(k[c]=P.length,P.push(p[c].slice()));P.length;function D(U,q){if(U[q]<0)return q;var X=q,K=q;do{var Z=U[K];if(!i[K]||Z<0||Z===K||(Z=U[K=Z],!i[K]||Z<0||Z===K))break;K=Z,X=U[X]}while(X!==K);for(var H=q;H!==K;H=U[H])U[H]=K;return K}var N=[];return m.forEach(function(U){var q=D(s,U[0]),X=D(l,U[1]);if(q>=0&&X>=0&&q!==X){var K=k[q],Z=k[X];K!==Z&&N.push([K,Z])}}),d.unique(d.normalize(N)),{positions:P,edges:N}};var t=r("robust-orientation"),d=r("simplicial-complex")},{"robust-orientation":534,"simplicial-complex":547}],550:[function(r,O,B){O.exports=function(m,p){var e,f,u,s;if(p[0][0]<p[1][0])e=p[0],f=p[1];else{if(!(p[0][0]>p[1][0]))return d(p,m);e=p[1],f=p[0]}if(m[0][0]<m[1][0])u=m[0],s=m[1];else{if(!(m[0][0]>m[1][0]))return-d(m,p);u=m[1],s=m[0]}var l=t(e,f,s),o=t(e,f,u);if(l<0){if(o<=0)return l}else if(l>0){if(o>=0)return l}else if(o)return o;if(l=t(s,u,f),o=t(s,u,e),l<0){if(o<=0)return l}else if(l>0){if(o>=0)return l}else if(o)return o;return f[0]-s[0]};var t=r("robust-orientation");function d(m,p){var e,f,u,s;if(p[0][0]<p[1][0])e=p[0],f=p[1];else{if(!(p[0][0]>p[1][0])){var l=Math.min(m[0][1],m[1][1]),o=Math.max(m[0][1],m[1][1]),i=Math.min(p[0][1],p[1][1]),c=Math.max(p[0][1],p[1][1]);return o<i?o-i:l>c?l-c:o-c}e=p[1],f=p[0]}m[0][1]<m[1][1]?(u=m[0],s=m[1]):(u=m[1],s=m[0]);var n=t(f,e,u);return n||(n=t(f,e,s))||s-f}},{"robust-orientation":534}],551:[function(r,O,B){O.exports=function(o){for(var i=o.length,c=2*i,n=new Array(c),a=0;a<i;++a){var g=o[a],h=g[0][0]<g[1][0];n[2*a]=new l(g[0][0],g,h,a),n[2*a+1]=new l(g[1][0],g,!h,a)}n.sort(function(w,C){var k=w.x-C.x;return k||(k=w.create-C.create)||Math.min(w.segment[0][1],w.segment[1][1])-Math.min(C.segment[0][1],C.segment[1][1])});var y=d(p),v=[],_=[],x=[];for(a=0;a<c;){for(var T=n[a].x,A=[];a<c;){var S=n[a];if(S.x!==T)break;a+=1,S.segment[0][0]===S.x&&S.segment[1][0]===S.x?S.create&&(S.segment[0][1]<S.segment[1][1]?(A.push(new s(S.segment[0][1],S.index,!0,!0)),A.push(new s(S.segment[1][1],S.index,!1,!1))):(A.push(new s(S.segment[1][1],S.index,!0,!1)),A.push(new s(S.segment[0][1],S.index,!1,!0)))):y=S.create?y.insert(S.segment,S.index):y.remove(S.segment)}v.push(y.root),_.push(T),x.push(A)}return new e(v,_,x)};var t=r("binary-search-bounds"),d=r("functional-red-black-tree"),m=r("robust-orientation"),p=r("./lib/order-segments");function e(o,i,c){this.slabs=o,this.coordinates=i,this.horizontal=c}function f(o,i){return o.y-i}function u(o,i){for(var c=null;o;){var n,a,g=o.key;g[0][0]<g[1][0]?(n=g[0],a=g[1]):(n=g[1],a=g[0]);var h=m(n,a,i);if(h<0)o=o.left;else if(h>0)if(i[0]!==g[1][0])c=o,o=o.right;else{if(y=u(o.right,i))return y;o=o.left}else{if(i[0]!==g[1][0])return o;var y;if(y=u(o.right,i))return y;o=o.left}}return c}function s(o,i,c,n){this.y=o,this.index=i,this.start=c,this.closed=n}function l(o,i,c,n){this.x=o,this.segment=i,this.create=c,this.index=n}e.prototype.castUp=function(o){var i=t.le(this.coordinates,o[0]);if(i<0)return-1;this.slabs[i];var c=u(this.slabs[i],o),n=-1;if(c&&(n=c.value),this.coordinates[i]===o[0]){var a=null;if(c&&(a=c.key),i>0){var g=u(this.slabs[i-1],o);g&&(a?p(g.key,a)>0&&(a=g.key,n=g.value):(n=g.value,a=g.key))}var h=this.horizontal[i];if(h.length>0){var y=t.ge(h,o[1],f);if(y<h.length){var v=h[y];if(o[1]===v.y){if(v.closed)return v.index;for(;y<h.length-1&&h[y+1].y===o[1];)if((v=h[y+=1]).closed)return v.index;if(v.y===o[1]&&!v.start){if((y+=1)>=h.length)return n;v=h[y]}}if(v.start)if(a){var _=m(a[0],a[1],[o[0],v.y]);a[0][0]>a[1][0]&&(_=-_),_>0&&(n=v.index)}else n=v.index;else v.y!==o[1]&&(n=v.index)}}}return n}},{"./lib/order-segments":550,"binary-search-bounds":103,"functional-red-black-tree":251,"robust-orientation":534}],552:[function(r,O,B){var t=r("robust-dot-product"),d=r("robust-sum");function m(e,f){var u=d(t(e,f),[f[f.length-1]]);return u[u.length-1]}function p(e,f,u,s){var l=-f/(s-f);l<0?l=0:l>1&&(l=1);for(var o=1-l,i=e.length,c=new Array(i),n=0;n<i;++n)c[n]=l*e[n]+o*u[n];return c}O.exports=function(e,f){for(var u=[],s=[],l=m(e[e.length-1],f),o=e[e.length-1],i=e[0],c=0;c<e.length;++c,o=i){var n=m(i=e[c],f);if(l<0&&n>0||l>0&&n<0){var a=p(o,n,i,l);u.push(a),s.push(a.slice())}n<0?s.push(i.slice()):n>0?u.push(i.slice()):(u.push(i.slice()),s.push(i.slice())),l=n}return{positive:u,negative:s}},O.exports.positive=function(e,f){for(var u=[],s=m(e[e.length-1],f),l=e[e.length-1],o=e[0],i=0;i<e.length;++i,l=o){var c=m(o=e[i],f);(s<0&&c>0||s>0&&c<0)&&u.push(p(l,c,o,s)),c>=0&&u.push(o.slice()),s=c}return u},O.exports.negative=function(e,f){for(var u=[],s=m(e[e.length-1],f),l=e[e.length-1],o=e[0],i=0;i<e.length;++i,l=o){var c=m(o=e[i],f);(s<0&&c>0||s>0&&c<0)&&u.push(p(l,c,o,s)),c<=0&&u.push(o.slice()),s=c}return u}},{"robust-dot-product":531,"robust-sum":539}],553:[function(r,O,B){(function(){var t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function d(u){return p(f(u),arguments)}function m(u,s){return d.apply(null,[u].concat(s||[]))}function p(u,s){var l,o,i,c,n,a,g,h,y,v=1,_=u.length,x="";for(o=0;o<_;o++)if(typeof u[o]=="string")x+=u[o];else if(typeof u[o]=="object"){if((c=u[o]).keys)for(l=s[v],i=0;i<c.keys.length;i++){if(l==null)throw new Error(d('[sprintf] Cannot access property "%s" of undefined value "%s"',c.keys[i],c.keys[i-1]));l=l[c.keys[i]]}else l=c.param_no?s[c.param_no]:s[v++];if(t.not_type.test(c.type)&&t.not_primitive.test(c.type)&&l instanceof Function&&(l=l()),t.numeric_arg.test(c.type)&&typeof l!="number"&&isNaN(l))throw new TypeError(d("[sprintf] expecting number but found %T",l));switch(t.number.test(c.type)&&(h=l>=0),c.type){case"b":l=parseInt(l,10).toString(2);break;case"c":l=String.fromCharCode(parseInt(l,10));break;case"d":case"i":l=parseInt(l,10);break;case"j":l=JSON.stringify(l,null,c.width?parseInt(c.width):0);break;case"e":l=c.precision?parseFloat(l).toExponential(c.precision):parseFloat(l).toExponential();break;case"f":l=c.precision?parseFloat(l).toFixed(c.precision):parseFloat(l);break;case"g":l=c.precision?String(Number(l.toPrecision(c.precision))):parseFloat(l);break;case"o":l=(parseInt(l,10)>>>0).toString(8);break;case"s":l=String(l),l=c.precision?l.substring(0,c.precision):l;break;case"t":l=String(!!l),l=c.precision?l.substring(0,c.precision):l;break;case"T":l=Object.prototype.toString.call(l).slice(8,-1).toLowerCase(),l=c.precision?l.substring(0,c.precision):l;break;case"u":l=parseInt(l,10)>>>0;break;case"v":l=l.valueOf(),l=c.precision?l.substring(0,c.precision):l;break;case"x":l=(parseInt(l,10)>>>0).toString(16);break;case"X":l=(parseInt(l,10)>>>0).toString(16).toUpperCase()}t.json.test(c.type)?x+=l:(!t.number.test(c.type)||h&&!c.sign?y="":(y=h?"+":"-",l=l.toString().replace(t.sign,"")),a=c.pad_char?c.pad_char==="0"?"0":c.pad_char.charAt(1):" ",g=c.width-(y+l).length,n=c.width&&g>0?a.repeat(g):"",x+=c.align?y+l+n:a==="0"?y+n+l:n+y+l)}return x}var e=Object.create(null);function f(u){if(e[u])return e[u];for(var s,l=u,o=[],i=0;l;){if((s=t.text.exec(l))!==null)o.push(s[0]);else if((s=t.modulo.exec(l))!==null)o.push("%");else{if((s=t.placeholder.exec(l))===null)throw new SyntaxError("[sprintf] unexpected placeholder");if(s[2]){i|=1;var c=[],n=s[2],a=[];if((a=t.key.exec(n))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");for(c.push(a[1]);(n=n.substring(a[0].length))!=="";)if((a=t.key_access.exec(n))!==null)c.push(a[1]);else{if((a=t.index_access.exec(n))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");c.push(a[1])}s[2]=c}else i|=2;if(i===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");o.push({placeholder:s[0],param_no:s[1],keys:s[2],sign:s[3],pad_char:s[4],align:s[5],width:s[6],precision:s[7],type:s[8]})}l=l.substring(s[0].length)}return e[u]=o}B!==void 0&&(B.sprintf=d,B.vsprintf=m),typeof window!="undefined"&&(window.sprintf=d,window.vsprintf=m)})()},{}],554:[function(r,O,B){O.exports=d;var t=r("events").EventEmitter;function d(){t.call(this)}r("inherits")(d,t),d.Readable=r("readable-stream/lib/_stream_readable.js"),d.Writable=r("readable-stream/lib/_stream_writable.js"),d.Duplex=r("readable-stream/lib/_stream_duplex.js"),d.Transform=r("readable-stream/lib/_stream_transform.js"),d.PassThrough=r("readable-stream/lib/_stream_passthrough.js"),d.finished=r("readable-stream/lib/internal/streams/end-of-stream.js"),d.pipeline=r("readable-stream/lib/internal/streams/pipeline.js"),d.Stream=d,d.prototype.pipe=function(m,p){var e=this;function f(n){m.writable&&m.write(n)===!1&&e.pause&&e.pause()}function u(){e.readable&&e.resume&&e.resume()}e.on("data",f),m.on("drain",u),m._isStdio||p&&p.end===!1||(e.on("end",l),e.on("close",o));var s=!1;function l(){s||(s=!0,m.end())}function o(){s||(s=!0,typeof m.destroy=="function"&&m.destroy())}function i(n){if(c(),t.listenerCount(this,"error")===0)throw n}function c(){e.removeListener("data",f),m.removeListener("drain",u),e.removeListener("end",l),e.removeListener("close",o),e.removeListener("error",i),m.removeListener("error",i),e.removeListener("end",c),e.removeListener("close",c),m.removeListener("close",c)}return e.on("error",i),m.on("error",i),e.on("end",c),e.on("close",c),m.on("close",c),m.emit("pipe",e),m}},{events:116,inherits:439,"readable-stream/lib/_stream_duplex.js":556,"readable-stream/lib/_stream_passthrough.js":557,"readable-stream/lib/_stream_readable.js":558,"readable-stream/lib/_stream_transform.js":559,"readable-stream/lib/_stream_writable.js":560,"readable-stream/lib/internal/streams/end-of-stream.js":564,"readable-stream/lib/internal/streams/pipeline.js":566}],555:[function(r,O,B){var t={};function d(p,e,f){f||(f=Error);var u=function(s){var l,o;function i(c,n,a){return s.call(this,function(g,h,y){return typeof e=="string"?e:e(g,h,y)}(c,n,a))||this}return o=s,(l=i).prototype=Object.create(o.prototype),l.prototype.constructor=l,l.__proto__=o,i}(f);u.prototype.name=f.name,u.prototype.code=p,t[p]=u}function m(p,e){if(Array.isArray(p)){var f=p.length;return p=p.map(function(u){return String(u)}),f>2?"one of ".concat(e," ").concat(p.slice(0,f-1).join(", "),", or ")+p[f-1]:f===2?"one of ".concat(e," ").concat(p[0]," or ").concat(p[1]):"of ".concat(e," ").concat(p[0])}return"of ".concat(e," ").concat(String(p))}d("ERR_INVALID_OPT_VALUE",function(p,e){return'The value "'+e+'" is invalid for option "'+p+'"'},TypeError),d("ERR_INVALID_ARG_TYPE",function(p,e,f){var u,s,l;if(typeof e=="string"&&(s="not ",e.substr(0,s.length)===s)?(u="must not be",e=e.replace(/^not /,"")):u="must be",function(i,c,n){return(n===void 0||n>i.length)&&(n=i.length),i.substring(n-c.length,n)===c}(p," argument"))l="The ".concat(p," ").concat(u," ").concat(m(e,"type"));else{var o=function(i,c,n){return typeof n!="number"&&(n=0),!(n+c.length>i.length)&&i.indexOf(c,n)!==-1}(p,".")?"property":"argument";l='The "'.concat(p,'" ').concat(o," ").concat(u," ").concat(m(e,"type"))}return l+=". Received type ".concat(typeof f)},TypeError),d("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),d("ERR_METHOD_NOT_IMPLEMENTED",function(p){return"The "+p+" method is not implemented"}),d("ERR_STREAM_PREMATURE_CLOSE","Premature close"),d("ERR_STREAM_DESTROYED",function(p){return"Cannot call "+p+" after a stream was destroyed"}),d("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),d("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),d("ERR_STREAM_WRITE_AFTER_END","write after end"),d("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),d("ERR_UNKNOWN_ENCODING",function(p){return"Unknown encoding: "+p},TypeError),d("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),O.exports.codes=t},{}],556:[function(r,O,B){(function(t){(function(){var d=Object.keys||function(i){var c=[];for(var n in i)c.push(n);return c};O.exports=s;var m=r("./_stream_readable"),p=r("./_stream_writable");r("inherits")(s,m);for(var e=d(p.prototype),f=0;f<e.length;f++){var u=e[f];s.prototype[u]||(s.prototype[u]=p.prototype[u])}function s(i){if(!(this instanceof s))return new s(i);m.call(this,i),p.call(this,i),this.allowHalfOpen=!0,i&&(i.readable===!1&&(this.readable=!1),i.writable===!1&&(this.writable=!1),i.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",l)))}function l(){this._writableState.ended||t.nextTick(o,this)}function o(i){i.end()}Object.defineProperty(s.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(s.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(s.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(s.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(i){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=i,this._writableState.destroyed=i)}})}).call(this)}).call(this,r("_process"))},{"./_stream_readable":558,"./_stream_writable":560,_process:514,inherits:439}],557:[function(r,O,B){O.exports=d;var t=r("./_stream_transform");function d(m){if(!(this instanceof d))return new d(m);t.call(this,m)}r("inherits")(d,t),d.prototype._transform=function(m,p,e){e(null,m)}},{"./_stream_transform":559,inherits:439}],558:[function(r,O,B){(function(t,d){(function(){var m;O.exports=w,w.ReadableState=S,r("events").EventEmitter;var p=function(z,j){return z.listeners(j).length},e=r("./internal/streams/stream"),f=r("buffer").Buffer,u=d.Uint8Array||function(){},s,l=r("util");s=l&&l.debuglog?l.debuglog("stream"):function(){};var o,i,c,n=r("./internal/streams/buffer_list"),a=r("./internal/streams/destroy"),g=r("./internal/streams/state").getHighWaterMark,h=r("../errors").codes,y=h.ERR_INVALID_ARG_TYPE,v=h.ERR_STREAM_PUSH_AFTER_EOF,_=h.ERR_METHOD_NOT_IMPLEMENTED,x=h.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r("inherits")(w,e);var T=a.errorOrDestroy,A=["error","close","destroy","pause","resume"];function S(z,j,W){m=m||r("./_stream_duplex"),z=z||{},typeof W!="boolean"&&(W=j instanceof m),this.objectMode=!!z.objectMode,W&&(this.objectMode=this.objectMode||!!z.readableObjectMode),this.highWaterMark=g(this,z,"readableHighWaterMark",W),this.buffer=new n,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=z.emitClose!==!1,this.autoDestroy=!!z.autoDestroy,this.destroyed=!1,this.defaultEncoding=z.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,z.encoding&&(o||(o=r("string_decoder/").StringDecoder),this.decoder=new o(z.encoding),this.encoding=z.encoding)}function w(z){if(m=m||r("./_stream_duplex"),!(this instanceof w))return new w(z);var j=this instanceof m;this._readableState=new S(z,this,j),this.readable=!0,z&&(typeof z.read=="function"&&(this._read=z.read),typeof z.destroy=="function"&&(this._destroy=z.destroy)),e.call(this)}function C(z,j,W,ee,J){s("readableAddChunk",j);var Q,te=z._readableState;if(j===null)te.reading=!1,function(ie,ae){if(s("onEofChunk"),!ae.ended){if(ae.decoder){var he=ae.decoder.end();he&&he.length&&(ae.buffer.push(he),ae.length+=ae.objectMode?1:he.length)}ae.ended=!0,ae.sync?M(ie):(ae.needReadable=!1,ae.emittedReadable||(ae.emittedReadable=!0,P(ie)))}}(z,te);else if(J||(Q=function(ie,ae){var he;se=ae,f.isBuffer(se)||se instanceof u||typeof ae=="string"||ae===void 0||ie.objectMode||(he=new y("chunk",["string","Buffer","Uint8Array"],ae));var se;return he}(te,j)),Q)T(z,Q);else if(te.objectMode||j&&j.length>0)if(typeof j=="string"||te.objectMode||Object.getPrototypeOf(j)===f.prototype||(j=function(ie){return f.from(ie)}(j)),ee)te.endEmitted?T(z,new x):k(z,te,j,!0);else if(te.ended)T(z,new v);else{if(te.destroyed)return!1;te.reading=!1,te.decoder&&!W?(j=te.decoder.write(j),te.objectMode||j.length!==0?k(z,te,j,!1):D(z,te)):k(z,te,j,!1)}else ee||(te.reading=!1,D(z,te));return!te.ended&&(te.length<te.highWaterMark||te.length===0)}function k(z,j,W,ee){j.flowing&&j.length===0&&!j.sync?(j.awaitDrain=0,z.emit("data",W)):(j.length+=j.objectMode?1:W.length,ee?j.buffer.unshift(W):j.buffer.push(W),j.needReadable&&M(z)),D(z,j)}Object.defineProperty(w.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(z){this._readableState&&(this._readableState.destroyed=z)}}),w.prototype.destroy=a.destroy,w.prototype._undestroy=a.undestroy,w.prototype._destroy=function(z,j){j(z)},w.prototype.push=function(z,j){var W,ee=this._readableState;return ee.objectMode?W=!0:typeof z=="string"&&((j=j||ee.defaultEncoding)!==ee.encoding&&(z=f.from(z,j),j=""),W=!0),C(this,z,j,!1,W)},w.prototype.unshift=function(z){return C(this,z,null,!0,!1)},w.prototype.isPaused=function(){return this._readableState.flowing===!1},w.prototype.setEncoding=function(z){o||(o=r("string_decoder/").StringDecoder);var j=new o(z);this._readableState.decoder=j,this._readableState.encoding=this._readableState.decoder.encoding;for(var W=this._readableState.buffer.head,ee="";W!==null;)ee+=j.write(W.data),W=W.next;return this._readableState.buffer.clear(),ee!==""&&this._readableState.buffer.push(ee),this._readableState.length=ee.length,this};function L(z,j){return z<=0||j.length===0&&j.ended?0:j.objectMode?1:z!=z?j.flowing&&j.length?j.buffer.head.data.length:j.length:(z>j.highWaterMark&&(j.highWaterMark=function(W){return W>=1073741824?W=1073741824:(W--,W|=W>>>1,W|=W>>>2,W|=W>>>4,W|=W>>>8,W|=W>>>16,W++),W}(z)),z<=j.length?z:j.ended?j.length:(j.needReadable=!0,0))}function M(z){var j=z._readableState;s("emitReadable",j.needReadable,j.emittedReadable),j.needReadable=!1,j.emittedReadable||(s("emitReadable",j.flowing),j.emittedReadable=!0,t.nextTick(P,z))}function P(z){var j=z._readableState;s("emitReadable_",j.destroyed,j.length,j.ended),j.destroyed||!j.length&&!j.ended||(z.emit("readable"),j.emittedReadable=!1),j.needReadable=!j.flowing&&!j.ended&&j.length<=j.highWaterMark,K(z)}function D(z,j){j.readingMore||(j.readingMore=!0,t.nextTick(N,z,j))}function N(z,j){for(;!j.reading&&!j.ended&&(j.length<j.highWaterMark||j.flowing&&j.length===0);){var W=j.length;if(s("maybeReadMore read 0"),z.read(0),W===j.length)break}j.readingMore=!1}function U(z){var j=z._readableState;j.readableListening=z.listenerCount("readable")>0,j.resumeScheduled&&!j.paused?j.flowing=!0:z.listenerCount("data")>0&&z.resume()}function q(z){s("readable nexttick read 0"),z.read(0)}function X(z,j){s("resume",j.reading),j.reading||z.read(0),j.resumeScheduled=!1,z.emit("resume"),K(z),j.flowing&&!j.reading&&z.read(0)}function K(z){var j=z._readableState;for(s("flow",j.flowing);j.flowing&&z.read()!==null;);}function Z(z,j){return j.length===0?null:(j.objectMode?W=j.buffer.shift():!z||z>=j.length?(W=j.decoder?j.buffer.join(""):j.buffer.length===1?j.buffer.first():j.buffer.concat(j.length),j.buffer.clear()):W=j.buffer.consume(z,j.decoder),W);var W}function H(z){var j=z._readableState;s("endReadable",j.endEmitted),j.endEmitted||(j.ended=!0,t.nextTick(Y,j,z))}function Y(z,j){if(s("endReadableNT",z.endEmitted,z.length),!z.endEmitted&&z.length===0&&(z.endEmitted=!0,j.readable=!1,j.emit("end"),z.autoDestroy)){var W=j._writableState;(!W||W.autoDestroy&&W.finished)&&j.destroy()}}function $(z,j){for(var W=0,ee=z.length;W<ee;W++)if(z[W]===j)return W;return-1}w.prototype.read=function(z){s("read",z),z=parseInt(z,10);var j=this._readableState,W=z;if(z!==0&&(j.emittedReadable=!1),z===0&&j.needReadable&&((j.highWaterMark!==0?j.length>=j.highWaterMark:j.length>0)||j.ended))return s("read: emitReadable",j.length,j.ended),j.length===0&&j.ended?H(this):M(this),null;if((z=L(z,j))===0&&j.ended)return j.length===0&&H(this),null;var ee,J=j.needReadable;return s("need readable",J),(j.length===0||j.length-z<j.highWaterMark)&&s("length less than watermark",J=!0),j.ended||j.reading?s("reading or ended",J=!1):J&&(s("do read"),j.reading=!0,j.sync=!0,j.length===0&&(j.needReadable=!0),this._read(j.highWaterMark),j.sync=!1,j.reading||(z=L(W,j))),(ee=z>0?Z(z,j):null)===null?(j.needReadable=j.length<=j.highWaterMark,z=0):(j.length-=z,j.awaitDrain=0),j.length===0&&(j.ended||(j.needReadable=!0),W!==z&&j.ended&&H(this)),ee!==null&&this.emit("data",ee),ee},w.prototype._read=function(z){T(this,new _("_read()"))},w.prototype.pipe=function(z,j){var W=this,ee=this._readableState;switch(ee.pipesCount){case 0:ee.pipes=z;break;case 1:ee.pipes=[ee.pipes,z];break;default:ee.pipes.push(z)}ee.pipesCount+=1,s("pipe count=%d opts=%j",ee.pipesCount,j);var J=(!j||j.end!==!1)&&z!==t.stdout&&z!==t.stderr?te:ve;function Q(ke,Ee){s("onunpipe"),ke===W&&Ee&&Ee.hasUnpiped===!1&&(Ee.hasUnpiped=!0,s("cleanup"),z.removeListener("close",de),z.removeListener("finish",ue),z.removeListener("drain",ie),z.removeListener("error",se),z.removeListener("unpipe",Q),W.removeListener("end",te),W.removeListener("end",ve),W.removeListener("data",he),ae=!0,!ee.awaitDrain||z._writableState&&!z._writableState.needDrain||ie())}function te(){s("onend"),z.end()}ee.endEmitted?t.nextTick(J):W.once("end",J),z.on("unpipe",Q);var ie=function(ke){return function(){var Ee=ke._readableState;s("pipeOnDrain",Ee.awaitDrain),Ee.awaitDrain&&Ee.awaitDrain--,Ee.awaitDrain===0&&p(ke,"data")&&(Ee.flowing=!0,K(ke))}}(W);z.on("drain",ie);var ae=!1;function he(ke){s("ondata");var Ee=z.write(ke);s("dest.write",Ee),Ee===!1&&((ee.pipesCount===1&&ee.pipes===z||ee.pipesCount>1&&$(ee.pipes,z)!==-1)&&!ae&&(s("false write response, pause",ee.awaitDrain),ee.awaitDrain++),W.pause())}function se(ke){s("onerror",ke),ve(),z.removeListener("error",se),p(z,"error")===0&&T(z,ke)}function de(){z.removeListener("finish",ue),ve()}function ue(){s("onfinish"),z.removeListener("close",de),ve()}function ve(){s("unpipe"),W.unpipe(z)}return W.on("data",he),function(ke,Ee,be){if(typeof ke.prependListener=="function")return ke.prependListener(Ee,be);ke._events&&ke._events[Ee]?Array.isArray(ke._events[Ee])?ke._events[Ee].unshift(be):ke._events[Ee]=[be,ke._events[Ee]]:ke.on(Ee,be)}(z,"error",se),z.once("close",de),z.once("finish",ue),z.emit("pipe",W),ee.flowing||(s("pipe resume"),W.resume()),z},w.prototype.unpipe=function(z){var j=this._readableState,W={hasUnpiped:!1};if(j.pipesCount===0)return this;if(j.pipesCount===1)return z&&z!==j.pipes||(z||(z=j.pipes),j.pipes=null,j.pipesCount=0,j.flowing=!1,z&&z.emit("unpipe",this,W)),this;if(!z){var ee=j.pipes,J=j.pipesCount;j.pipes=null,j.pipesCount=0,j.flowing=!1;for(var Q=0;Q<J;Q++)ee[Q].emit("unpipe",this,{hasUnpiped:!1});return this}var te=$(j.pipes,z);return te===-1||(j.pipes.splice(te,1),j.pipesCount-=1,j.pipesCount===1&&(j.pipes=j.pipes[0]),z.emit("unpipe",this,W)),this},w.prototype.on=function(z,j){var W=e.prototype.on.call(this,z,j),ee=this._readableState;return z==="data"?(ee.readableListening=this.listenerCount("readable")>0,ee.flowing!==!1&&this.resume()):z==="readable"&&(ee.endEmitted||ee.readableListening||(ee.readableListening=ee.needReadable=!0,ee.flowing=!1,ee.emittedReadable=!1,s("on readable",ee.length,ee.reading),ee.length?M(this):ee.reading||t.nextTick(q,this))),W},w.prototype.addListener=w.prototype.on,w.prototype.removeListener=function(z,j){var W=e.prototype.removeListener.call(this,z,j);return z==="readable"&&t.nextTick(U,this),W},w.prototype.removeAllListeners=function(z){var j=e.prototype.removeAllListeners.apply(this,arguments);return z!=="readable"&&z!==void 0||t.nextTick(U,this),j},w.prototype.resume=function(){var z=this._readableState;return z.flowing||(s("resume"),z.flowing=!z.readableListening,function(j,W){W.resumeScheduled||(W.resumeScheduled=!0,t.nextTick(X,j,W))}(this,z)),z.paused=!1,this},w.prototype.pause=function(){return s("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(s("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},w.prototype.wrap=function(z){var j=this,W=this._readableState,ee=!1;for(var J in z.on("end",function(){if(s("wrapped end"),W.decoder&&!W.ended){var te=W.decoder.end();te&&te.length&&j.push(te)}j.push(null)}),z.on("data",function(te){s("wrapped data"),W.decoder&&(te=W.decoder.write(te)),W.objectMode&&te==null||(W.objectMode||te&&te.length)&&(j.push(te)||(ee=!0,z.pause()))}),z)this[J]===void 0&&typeof z[J]=="function"&&(this[J]=function(te){return function(){return z[te].apply(z,arguments)}}(J));for(var Q=0;Q<A.length;Q++)z.on(A[Q],this.emit.bind(this,A[Q]));return this._read=function(te){s("wrapped _read",te),ee&&(ee=!1,z.resume())},this},typeof Symbol=="function"&&(w.prototype[Symbol.asyncIterator]=function(){return i===void 0&&(i=r("./internal/streams/async_iterator")),i(this)}),Object.defineProperty(w.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(w.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(w.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(z){this._readableState&&(this._readableState.flowing=z)}}),w._fromList=Z,Object.defineProperty(w.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(w.from=function(z,j){return c===void 0&&(c=r("./internal/streams/from")),c(w,z,j)})}).call(this)}).call(this,r("_process"),typeof Xi!="undefined"?Xi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"../errors":555,"./_stream_duplex":556,"./internal/streams/async_iterator":561,"./internal/streams/buffer_list":562,"./internal/streams/destroy":563,"./internal/streams/from":565,"./internal/streams/state":567,"./internal/streams/stream":568,_process:514,buffer:117,events:116,inherits:439,"string_decoder/":569,util:115}],559:[function(r,O,B){O.exports=s;var t=r("../errors").codes,d=t.ERR_METHOD_NOT_IMPLEMENTED,m=t.ERR_MULTIPLE_CALLBACK,p=t.ERR_TRANSFORM_ALREADY_TRANSFORMING,e=t.ERR_TRANSFORM_WITH_LENGTH_0,f=r("./_stream_duplex");function u(i,c){var n=this._transformState;n.transforming=!1;var a=n.writecb;if(a===null)return this.emit("error",new m);n.writechunk=null,n.writecb=null,c!=null&&this.push(c),a(i);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}function s(i){if(!(this instanceof s))return new s(i);f.call(this,i),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,i&&(typeof i.transform=="function"&&(this._transform=i.transform),typeof i.flush=="function"&&(this._flush=i.flush)),this.on("prefinish",l)}function l(){var i=this;typeof this._flush!="function"||this._readableState.destroyed?o(this,null,null):this._flush(function(c,n){o(i,c,n)})}function o(i,c,n){if(c)return i.emit("error",c);if(n!=null&&i.push(n),i._writableState.length)throw new e;if(i._transformState.transforming)throw new p;return i.push(null)}r("inherits")(s,f),s.prototype.push=function(i,c){return this._transformState.needTransform=!1,f.prototype.push.call(this,i,c)},s.prototype._transform=function(i,c,n){n(new d("_transform()"))},s.prototype._write=function(i,c,n){var a=this._transformState;if(a.writecb=n,a.writechunk=i,a.writeencoding=c,!a.transforming){var g=this._readableState;(a.needTransform||g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}},s.prototype._read=function(i){var c=this._transformState;c.writechunk===null||c.transforming?c.needTransform=!0:(c.transforming=!0,this._transform(c.writechunk,c.writeencoding,c.afterTransform))},s.prototype._destroy=function(i,c){f.prototype._destroy.call(this,i,function(n){c(n)})}},{"../errors":555,"./_stream_duplex":556,inherits:439}],560:[function(r,O,B){(function(t,d){(function(){function m(N){var U=this;this.next=null,this.entry=null,this.finish=function(){(function(q,X,K){var Z=q.entry;for(q.entry=null;Z;){var H=Z.callback;X.pendingcb--,H(K),Z=Z.next}X.corkedRequestsFree.next=q})(U,N)}}var p;O.exports=w,w.WritableState=S;var e={deprecate:r("util-deprecate")},f=r("./internal/streams/stream"),u=r("buffer").Buffer,s=d.Uint8Array||function(){},l,o=r("./internal/streams/destroy"),i=r("./internal/streams/state").getHighWaterMark,c=r("../errors").codes,n=c.ERR_INVALID_ARG_TYPE,a=c.ERR_METHOD_NOT_IMPLEMENTED,g=c.ERR_MULTIPLE_CALLBACK,h=c.ERR_STREAM_CANNOT_PIPE,y=c.ERR_STREAM_DESTROYED,v=c.ERR_STREAM_NULL_VALUES,_=c.ERR_STREAM_WRITE_AFTER_END,x=c.ERR_UNKNOWN_ENCODING,T=o.errorOrDestroy;function A(){}function S(N,U,q){p=p||r("./_stream_duplex"),N=N||{},typeof q!="boolean"&&(q=U instanceof p),this.objectMode=!!N.objectMode,q&&(this.objectMode=this.objectMode||!!N.writableObjectMode),this.highWaterMark=i(this,N,"writableHighWaterMark",q),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var X=N.decodeStrings===!1;this.decodeStrings=!X,this.defaultEncoding=N.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(K){(function(Z,H){var Y=Z._writableState,$=Y.sync,z=Y.writecb;if(typeof z!="function")throw new g;if(function(W){W.writing=!1,W.writecb=null,W.length-=W.writelen,W.writelen=0}(Y),H)(function(W,ee,J,Q,te){--ee.pendingcb,J?(t.nextTick(te,Q),t.nextTick(D,W,ee),W._writableState.errorEmitted=!0,T(W,Q)):(te(Q),W._writableState.errorEmitted=!0,T(W,Q),D(W,ee))})(Z,Y,$,H,z);else{var j=M(Y)||Z.destroyed;j||Y.corked||Y.bufferProcessing||!Y.bufferedRequest||L(Z,Y),$?t.nextTick(k,Z,Y,j,z):k(Z,Y,j,z)}})(U,K)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=N.emitClose!==!1,this.autoDestroy=!!N.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new m(this)}function w(N){var U=this instanceof(p=p||r("./_stream_duplex"));if(!U&&!l.call(w,this))return new w(N);this._writableState=new S(N,this,U),this.writable=!0,N&&(typeof N.write=="function"&&(this._write=N.write),typeof N.writev=="function"&&(this._writev=N.writev),typeof N.destroy=="function"&&(this._destroy=N.destroy),typeof N.final=="function"&&(this._final=N.final)),f.call(this)}function C(N,U,q,X,K,Z,H){U.writelen=X,U.writecb=H,U.writing=!0,U.sync=!0,U.destroyed?U.onwrite(new y("write")):q?N._writev(K,U.onwrite):N._write(K,Z,U.onwrite),U.sync=!1}function k(N,U,q,X){q||function(K,Z){Z.length===0&&Z.needDrain&&(Z.needDrain=!1,K.emit("drain"))}(N,U),U.pendingcb--,X(),D(N,U)}function L(N,U){U.bufferProcessing=!0;var q=U.bufferedRequest;if(N._writev&&q&&q.next){var X=U.bufferedRequestCount,K=new Array(X),Z=U.corkedRequestsFree;Z.entry=q;for(var H=0,Y=!0;q;)K[H]=q,q.isBuf||(Y=!1),q=q.next,H+=1;K.allBuffers=Y,C(N,U,!0,U.length,K,"",Z.finish),U.pendingcb++,U.lastBufferedRequest=null,Z.next?(U.corkedRequestsFree=Z.next,Z.next=null):U.corkedRequestsFree=new m(U),U.bufferedRequestCount=0}else{for(;q;){var $=q.chunk,z=q.encoding,j=q.callback;if(C(N,U,!1,U.objectMode?1:$.length,$,z,j),q=q.next,U.bufferedRequestCount--,U.writing)break}q===null&&(U.lastBufferedRequest=null)}U.bufferedRequest=q,U.bufferProcessing=!1}function M(N){return N.ending&&N.length===0&&N.bufferedRequest===null&&!N.finished&&!N.writing}function P(N,U){N._final(function(q){U.pendingcb--,q&&T(N,q),U.prefinished=!0,N.emit("prefinish"),D(N,U)})}function D(N,U){var q=M(U);if(q&&(function(K,Z){Z.prefinished||Z.finalCalled||(typeof K._final!="function"||Z.destroyed?(Z.prefinished=!0,K.emit("prefinish")):(Z.pendingcb++,Z.finalCalled=!0,t.nextTick(P,K,Z)))}(N,U),U.pendingcb===0&&(U.finished=!0,N.emit("finish"),U.autoDestroy))){var X=N._readableState;(!X||X.autoDestroy&&X.endEmitted)&&N.destroy()}return q}r("inherits")(w,f),S.prototype.getBuffer=function(){for(var N=this.bufferedRequest,U=[];N;)U.push(N),N=N.next;return U},function(){try{Object.defineProperty(S.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(N){}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(l=Function.prototype[Symbol.hasInstance],Object.defineProperty(w,Symbol.hasInstance,{value:function(N){return!!l.call(this,N)||this===w&&N&&N._writableState instanceof S}})):l=function(N){return N instanceof this},w.prototype.pipe=function(){T(this,new h)},w.prototype.write=function(N,U,q){var X,K=this._writableState,Z=!1,H=!K.objectMode&&(X=N,u.isBuffer(X)||X instanceof s);return H&&!u.isBuffer(N)&&(N=function(Y){return u.from(Y)}(N)),typeof U=="function"&&(q=U,U=null),H?U="buffer":U||(U=K.defaultEncoding),typeof q!="function"&&(q=A),K.ending?function(Y,$){var z=new _;T(Y,z),t.nextTick($,z)}(this,q):(H||function(Y,$,z,j){var W;return z===null?W=new v:typeof z=="string"||$.objectMode||(W=new n("chunk",["string","Buffer"],z)),!W||(T(Y,W),t.nextTick(j,W),!1)}(this,K,N,q))&&(K.pendingcb++,Z=function(Y,$,z,j,W,ee){if(!z){var J=function(ae,he,se){return ae.objectMode||ae.decodeStrings===!1||typeof he!="string"||(he=u.from(he,se)),he}($,j,W);j!==J&&(z=!0,W="buffer",j=J)}var Q=$.objectMode?1:j.length;$.length+=Q;var te=$.length<$.highWaterMark;if(te||($.needDrain=!0),$.writing||$.corked){var ie=$.lastBufferedRequest;$.lastBufferedRequest={chunk:j,encoding:W,isBuf:z,callback:ee,next:null},ie?ie.next=$.lastBufferedRequest:$.bufferedRequest=$.lastBufferedRequest,$.bufferedRequestCount+=1}else C(Y,$,!1,Q,j,W,ee);return te}(this,K,H,N,U,q)),Z},w.prototype.cork=function(){this._writableState.corked++},w.prototype.uncork=function(){var N=this._writableState;N.corked&&(N.corked--,N.writing||N.corked||N.bufferProcessing||!N.bufferedRequest||L(this,N))},w.prototype.setDefaultEncoding=function(N){if(typeof N=="string"&&(N=N.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((N+"").toLowerCase())>-1))throw new x(N);return this._writableState.defaultEncoding=N,this},Object.defineProperty(w.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(w.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),w.prototype._write=function(N,U,q){q(new a("_write()"))},w.prototype._writev=null,w.prototype.end=function(N,U,q){var X=this._writableState;return typeof N=="function"?(q=N,N=null,U=null):typeof U=="function"&&(q=U,U=null),N!=null&&this.write(N,U),X.corked&&(X.corked=1,this.uncork()),X.ending||function(K,Z,H){Z.ending=!0,D(K,Z),H&&(Z.finished?t.nextTick(H):K.once("finish",H)),Z.ended=!0,K.writable=!1}(this,X,q),this},Object.defineProperty(w.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(w.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(N){this._writableState&&(this._writableState.destroyed=N)}}),w.prototype.destroy=o.destroy,w.prototype._undestroy=o.undestroy,w.prototype._destroy=function(N,U){U(N)}}).call(this)}).call(this,r("_process"),typeof Xi!="undefined"?Xi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"../errors":555,"./_stream_duplex":556,"./internal/streams/destroy":563,"./internal/streams/state":567,"./internal/streams/stream":568,_process:514,buffer:117,inherits:439,"util-deprecate":606}],561:[function(r,O,B){(function(t){(function(){var d;function m(y,v,_){return v in y?Object.defineProperty(y,v,{value:_,enumerable:!0,configurable:!0,writable:!0}):y[v]=_,y}var p=r("./end-of-stream"),e=Symbol("lastResolve"),f=Symbol("lastReject"),u=Symbol("error"),s=Symbol("ended"),l=Symbol("lastPromise"),o=Symbol("handlePromise"),i=Symbol("stream");function c(y,v){return{value:y,done:v}}function n(y){var v=y[e];if(v!==null){var _=y[i].read();_!==null&&(y[l]=null,y[e]=null,y[f]=null,v(c(_,!1)))}}function a(y){t.nextTick(n,y)}var g=Object.getPrototypeOf(function(){}),h=Object.setPrototypeOf((m(d={get stream(){return this[i]},next:function(){var y=this,v=this[u];if(v!==null)return Promise.reject(v);if(this[s])return Promise.resolve(c(void 0,!0));if(this[i].destroyed)return new Promise(function(A,S){t.nextTick(function(){y[u]?S(y[u]):A(c(void 0,!0))})});var _,x=this[l];if(x)_=new Promise(function(A,S){return function(w,C){A.then(function(){S[s]?w(c(void 0,!0)):S[o](w,C)},C)}}(x,this));else{var T=this[i].read();if(T!==null)return Promise.resolve(c(T,!1));_=new Promise(this[o])}return this[l]=_,_}},Symbol.asyncIterator,function(){return this}),m(d,"return",function(){var y=this;return new Promise(function(v,_){y[i].destroy(null,function(x){x?_(x):v(c(void 0,!0))})})}),d),g);O.exports=function(y){var v,_=Object.create(h,(m(v={},i,{value:y,writable:!0}),m(v,e,{value:null,writable:!0}),m(v,f,{value:null,writable:!0}),m(v,u,{value:null,writable:!0}),m(v,s,{value:y._readableState.endEmitted,writable:!0}),m(v,o,{value:function(x,T){var A=_[i].read();A?(_[l]=null,_[e]=null,_[f]=null,x(c(A,!1))):(_[e]=x,_[f]=T)},writable:!0}),v));return _[l]=null,p(y,function(x){if(x&&x.code!=="ERR_STREAM_PREMATURE_CLOSE"){var T=_[f];return T!==null&&(_[l]=null,_[e]=null,_[f]=null,T(x)),void(_[u]=x)}var A=_[e];A!==null&&(_[l]=null,_[e]=null,_[f]=null,A(c(void 0,!0))),_[s]=!0}),y.on("readable",a.bind(null,_)),_}}).call(this)}).call(this,r("_process"))},{"./end-of-stream":564,_process:514}],562:[function(r,O,B){function t(u,s){var l=Object.keys(u);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(u);s&&(o=o.filter(function(i){return Object.getOwnPropertyDescriptor(u,i).enumerable})),l.push.apply(l,o)}return l}function d(u,s,l){return s in u?Object.defineProperty(u,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):u[s]=l,u}function m(u,s){for(var l=0;l<s.length;l++){var o=s[l];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(u,o.key,o)}}var p=r("buffer").Buffer,e=r("util").inspect,f=e&&e.custom||"inspect";O.exports=function(){function u(){(function(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")})(this,u),this.head=null,this.tail=null,this.length=0}var s,l;return s=u,(l=[{key:"push",value:function(o){var i={data:o,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length}},{key:"unshift",value:function(o){var i={data:o,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length}},{key:"shift",value:function(){if(this.length!==0){var o=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,o}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(o){if(this.length===0)return"";for(var i=this.head,c=""+i.data;i=i.next;)c+=o+i.data;return c}},{key:"concat",value:function(o){if(this.length===0)return p.alloc(0);for(var i,c,n,a=p.allocUnsafe(o>>>0),g=this.head,h=0;g;)i=g.data,c=a,n=h,p.prototype.copy.call(i,c,n),h+=g.data.length,g=g.next;return a}},{key:"consume",value:function(o,i){var c;return o<this.head.data.length?(c=this.head.data.slice(0,o),this.head.data=this.head.data.slice(o)):c=o===this.head.data.length?this.shift():i?this._getString(o):this._getBuffer(o),c}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(o){var i=this.head,c=1,n=i.data;for(o-=n.length;i=i.next;){var a=i.data,g=o>a.length?a.length:o;if(g===a.length?n+=a:n+=a.slice(0,o),(o-=g)==0){g===a.length?(++c,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=a.slice(g));break}++c}return this.length-=c,n}},{key:"_getBuffer",value:function(o){var i=p.allocUnsafe(o),c=this.head,n=1;for(c.data.copy(i),o-=c.data.length;c=c.next;){var a=c.data,g=o>a.length?a.length:o;if(a.copy(i,i.length-o,0,g),(o-=g)==0){g===a.length?(++n,c.next?this.head=c.next:this.head=this.tail=null):(this.head=c,c.data=a.slice(g));break}++n}return this.length-=n,i}},{key:f,value:function(o,i){return e(this,function(c){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?t(Object(a),!0).forEach(function(g){d(c,g,a[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach(function(g){Object.defineProperty(c,g,Object.getOwnPropertyDescriptor(a,g))})}return c}({},i,{depth:0,customInspect:!1}))}}])&&m(s.prototype,l),u}()},{buffer:117,util:115}],563:[function(r,O,B){(function(t){(function(){function d(e,f){p(e,f),m(e)}function m(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function p(e,f){e.emit("error",f)}O.exports={destroy:function(e,f){var u=this,s=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return s||l?(f?f(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(p,this,e)):t.nextTick(p,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(o){!f&&o?u._writableState?u._writableState.errorEmitted?t.nextTick(m,u):(u._writableState.errorEmitted=!0,t.nextTick(d,u,o)):t.nextTick(d,u,o):f?(t.nextTick(m,u),f(o)):t.nextTick(m,u)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,f){var u=e._readableState,s=e._writableState;u&&u.autoDestroy||s&&s.autoDestroy?e.destroy(f):e.emit("error",f)}}}).call(this)}).call(this,r("_process"))},{_process:514}],564:[function(r,O,B){var t=r("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function d(){}O.exports=function m(p,e,f){if(typeof e=="function")return m(p,null,e);e||(e={}),f=function(y){var v=!1;return function(){if(!v){v=!0;for(var _=arguments.length,x=new Array(_),T=0;T<_;T++)x[T]=arguments[T];y.apply(this,x)}}}(f||d);var u=e.readable||e.readable!==!1&&p.readable,s=e.writable||e.writable!==!1&&p.writable,l=function(){p.writable||i()},o=p._writableState&&p._writableState.finished,i=function(){s=!1,o=!0,u||f.call(p)},c=p._readableState&&p._readableState.endEmitted,n=function(){u=!1,c=!0,s||f.call(p)},a=function(y){f.call(p,y)},g=function(){var y;return u&&!c?(p._readableState&&p._readableState.ended||(y=new t),f.call(p,y)):s&&!o?(p._writableState&&p._writableState.ended||(y=new t),f.call(p,y)):void 0},h=function(){p.req.on("finish",i)};return function(y){return y.setHeader&&typeof y.abort=="function"}(p)?(p.on("complete",i),p.on("abort",g),p.req?h():p.on("request",h)):s&&!p._writableState&&(p.on("end",l),p.on("close",l)),p.on("end",n),p.on("finish",i),e.error!==!1&&p.on("error",a),p.on("close",g),function(){p.removeListener("complete",i),p.removeListener("abort",g),p.removeListener("request",h),p.req&&p.req.removeListener("finish",i),p.removeListener("end",l),p.removeListener("close",l),p.removeListener("finish",i),p.removeListener("end",n),p.removeListener("error",a),p.removeListener("close",g)}}},{"../../../errors":555}],565:[function(r,O,B){O.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],566:[function(r,O,B){var t,d=r("../../../errors").codes,m=d.ERR_MISSING_ARGS,p=d.ERR_STREAM_DESTROYED;function e(o){if(o)throw o}function f(o,i,c,n){n=function(h){var y=!1;return function(){y||(y=!0,h.apply(void 0,arguments))}}(n);var a=!1;o.on("close",function(){a=!0}),t===void 0&&(t=r("./end-of-stream")),t(o,{readable:i,writable:c},function(h){if(h)return n(h);a=!0,n()});var g=!1;return function(h){if(!a&&!g)return g=!0,function(y){return y.setHeader&&typeof y.abort=="function"}(o)?o.abort():typeof o.destroy=="function"?o.destroy():void n(h||new p("pipe"))}}function u(o){o()}function s(o,i){return o.pipe(i)}function l(o){return o.length?typeof o[o.length-1]!="function"?e:o.pop():e}O.exports=function(){for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];var n,a=l(i);if(Array.isArray(i[0])&&(i=i[0]),i.length<2)throw new m("streams");var g=i.map(function(h,y){var v=y<i.length-1;return f(h,v,y>0,function(_){n||(n=_),_&&g.forEach(u),v||(g.forEach(u),a(n))})});return i.reduce(s)}},{"../../../errors":555,"./end-of-stream":564}],567:[function(r,O,B){var t=r("../../../errors").codes.ERR_INVALID_OPT_VALUE;O.exports={getHighWaterMark:function(d,m,p,e){var f=function(u,s,l){return u.highWaterMark!=null?u.highWaterMark:s?u[l]:null}(m,e,p);if(f!=null){if(!isFinite(f)||Math.floor(f)!==f||f<0)throw new t(e?p:"highWaterMark",f);return Math.floor(f)}return d.objectMode?16:16384}}},{"../../../errors":555}],568:[function(r,O,B){O.exports=r("events").EventEmitter},{events:116}],569:[function(r,O,B){var t=r("safe-buffer").Buffer,d=t.isEncoding||function(c){switch((c=""+c)&&c.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function m(c){var n;switch(this.encoding=function(a){var g=function(h){if(!h)return"utf8";for(var y;;)switch(h){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return h;default:if(y)return;h=(""+h).toLowerCase(),y=!0}}(a);if(typeof g!="string"&&(t.isEncoding===d||!d(a)))throw new Error("Unknown encoding: "+a);return g||a}(c),this.encoding){case"utf16le":this.text=f,this.end=u,n=4;break;case"utf8":this.fillLast=e,n=4;break;case"base64":this.text=s,this.end=l,n=3;break;default:return this.write=o,void(this.end=i)}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(n)}function p(c){return c<=127?0:c>>5==6?2:c>>4==14?3:c>>3==30?4:c>>6==2?-1:-2}function e(c){var n=this.lastTotal-this.lastNeed,a=function(g,h,y){if((192&h[0])!=128)return g.lastNeed=0,"\uFFFD";if(g.lastNeed>1&&h.length>1){if((192&h[1])!=128)return g.lastNeed=1,"\uFFFD";if(g.lastNeed>2&&h.length>2&&(192&h[2])!=128)return g.lastNeed=2,"\uFFFD"}}(this,c);return a!==void 0?a:this.lastNeed<=c.length?(c.copy(this.lastChar,n,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(c.copy(this.lastChar,n,0,c.length),void(this.lastNeed-=c.length))}function f(c,n){if((c.length-n)%2==0){var a=c.toString("utf16le",n);if(a){var g=a.charCodeAt(a.length-1);if(g>=55296&&g<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=c[c.length-2],this.lastChar[1]=c[c.length-1],a.slice(0,-1)}return a}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=c[c.length-1],c.toString("utf16le",n,c.length-1)}function u(c){var n=c&&c.length?this.write(c):"";if(this.lastNeed){var a=this.lastTotal-this.lastNeed;return n+this.lastChar.toString("utf16le",0,a)}return n}function s(c,n){var a=(c.length-n)%3;return a===0?c.toString("base64",n):(this.lastNeed=3-a,this.lastTotal=3,a===1?this.lastChar[0]=c[c.length-1]:(this.lastChar[0]=c[c.length-2],this.lastChar[1]=c[c.length-1]),c.toString("base64",n,c.length-a))}function l(c){var n=c&&c.length?this.write(c):"";return this.lastNeed?n+this.lastChar.toString("base64",0,3-this.lastNeed):n}function o(c){return c.toString(this.encoding)}function i(c){return c&&c.length?this.write(c):""}B.StringDecoder=m,m.prototype.write=function(c){if(c.length===0)return"";var n,a;if(this.lastNeed){if((n=this.fillLast(c))===void 0)return"";a=this.lastNeed,this.lastNeed=0}else a=0;return a<c.length?n?n+this.text(c,a):this.text(c,a):n||""},m.prototype.end=function(c){var n=c&&c.length?this.write(c):"";return this.lastNeed?n+"\uFFFD":n},m.prototype.text=function(c,n){var a=function(h,y,v){var _=y.length-1;if(_<v)return 0;var x=p(y[_]);return x>=0?(x>0&&(h.lastNeed=x-1),x):--_<v||x===-2?0:(x=p(y[_]))>=0?(x>0&&(h.lastNeed=x-2),x):--_<v||x===-2?0:(x=p(y[_]))>=0?(x>0&&(x===2?x=0:h.lastNeed=x-3),x):0}(this,c,n);if(!this.lastNeed)return c.toString("utf8",n);this.lastTotal=a;var g=c.length-(a-this.lastNeed);return c.copy(this.lastChar,0,g),c.toString("utf8",n,g)},m.prototype.fillLast=function(c){if(this.lastNeed<=c.length)return c.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);c.copy(this.lastChar,this.lastTotal-this.lastNeed,0,c.length),this.lastNeed-=c.length}},{"safe-buffer":540}],570:[function(r,O,B){(function(t,d){(function(){var m=r("assert"),p=r("debug")("stream-parser");O.exports=function(a){var g=a&&typeof a._transform=="function",h=a&&typeof a._write=="function";if(!g&&!h)throw new Error("must pass a Writable or Transform stream in");p("extending Parser into stream"),a._bytes=f,a._skipBytes=u,g&&(a._passthrough=s),g?a._transform=o:a._write=l};function e(a){p("initializing parser stream"),a._parserBytesLeft=0,a._parserBuffers=[],a._parserBuffered=0,a._parserState=-1,a._parserCallback=null,typeof a.push=="function"&&(a._parserOutput=a.push.bind(a)),a._parserInit=!0}function f(a,g){m(!this._parserCallback,'there is already a "callback" set!'),m(isFinite(a)&&a>0,'can only buffer a finite number of bytes > 0, got "'+a+'"'),this._parserInit||e(this),p("buffering %o bytes",a),this._parserBytesLeft=a,this._parserCallback=g,this._parserState=0}function u(a,g){m(!this._parserCallback,'there is already a "callback" set!'),m(a>0,'can only skip > 0 bytes, got "'+a+'"'),this._parserInit||e(this),p("skipping %o bytes",a),this._parserBytesLeft=a,this._parserCallback=g,this._parserState=1}function s(a,g){m(!this._parserCallback,'There is already a "callback" set!'),m(a>0,'can only pass through > 0 bytes, got "'+a+'"'),this._parserInit||e(this),p("passing through %o bytes",a),this._parserBytesLeft=a,this._parserCallback=g,this._parserState=2}function l(a,g,h){this._parserInit||e(this),p("write(%o bytes)",a.length),typeof g=="function"&&(h=g),c(this,a,null,h)}function o(a,g,h){this._parserInit||e(this),p("transform(%o bytes)",a.length),typeof g!="function"&&(g=this._parserOutput),c(this,a,g,h)}function i(a,g,h,y){if(a._parserBytesLeft-=g.length,p("%o bytes left for stream piece",a._parserBytesLeft),a._parserState===0?(a._parserBuffers.push(g),a._parserBuffered+=g.length):a._parserState===2&&h(g),a._parserBytesLeft!==0)return y;var v=a._parserCallback;if(v&&a._parserState===0&&a._parserBuffers.length>1&&(g=d.concat(a._parserBuffers,a._parserBuffered)),a._parserState!==0&&(g=null),a._parserCallback=null,a._parserBuffered=0,a._parserState=-1,a._parserBuffers.splice(0),v){var _=[];g&&_.push(g),h&&_.push(h);var x=v.length>_.length;x&&_.push(n(y));var T=v.apply(a,_);if(!x||y===T)return y}}var c=n(function a(g,h,y,v){return g._parserBytesLeft<=0?v(new Error("got data but not currently parsing anything")):h.length<=g._parserBytesLeft?function(){return i(g,h,y,v)}:function(){var _=h.slice(0,g._parserBytesLeft);return i(g,_,y,function(x){return x?v(x):h.length>_.length?function(){return a(g,h.slice(_.length),y,v)}:void 0})}});function n(a){return function(){for(var g=a.apply(this,arguments);typeof g=="function";)g=g();return g}}}).call(this)}).call(this,r("_process"),r("buffer").Buffer)},{_process:514,assert:80,buffer:117,debug:571}],571:[function(r,O,B){(function(t){(function(){function d(){var m;try{m=B.storage.debug}catch(p){}return!m&&t!==void 0&&"env"in t&&(m=t.env.DEBUG),m}(B=O.exports=r("./debug")).log=function(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},B.formatArgs=function(m){var p=this.useColors;if(m[0]=(p?"%c":"")+this.namespace+(p?" %c":" ")+m[0]+(p?"%c ":" ")+"+"+B.humanize(this.diff),!!p){var e="color: "+this.color;m.splice(1,0,e,"color: inherit");var f=0,u=0;m[0].replace(/%[a-zA-Z%]/g,function(s){s!=="%%"&&(f++,s==="%c"&&(u=f))}),m.splice(u,0,e)}},B.save=function(m){try{m==null?B.storage.removeItem("debug"):B.storage.debug=m}catch(p){}},B.load=d,B.useColors=function(){return typeof window!="undefined"&&window.process&&window.process.type==="renderer"?!0:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},B.storage=typeof chrome!="undefined"&&chrome.storage!==void 0?chrome.storage.local:function(){try{return window.localStorage}catch(m){}}(),B.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],B.formatters.j=function(m){try{return JSON.stringify(m)}catch(p){return"[UnexpectedJSONParseError]: "+p.message}},B.enable(d())}).call(this)}).call(this,r("_process"))},{"./debug":572,_process:514}],572:[function(r,O,B){var t;function d(m){function p(){if(p.enabled){var e=p,f=+new Date,u=f-(t||f);e.diff=u,e.prev=t,e.curr=f,t=f;for(var s=new Array(arguments.length),l=0;l<s.length;l++)s[l]=arguments[l];s[0]=B.coerce(s[0]),typeof s[0]!="string"&&s.unshift("%O");var o=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(c,n){if(c==="%%")return c;o++;var a=B.formatters[n];if(typeof a=="function"){var g=s[o];c=a.call(e,g),s.splice(o,1),o--}return c}),B.formatArgs.call(e,s);var i=p.log||B.log||console.log.bind(console);i.apply(e,s)}}return p.namespace=m,p.enabled=B.enabled(m),p.useColors=B.useColors(),p.color=function(e){var f,u=0;for(f in e)u=(u<<5)-u+e.charCodeAt(f),u|=0;return B.colors[Math.abs(u)%B.colors.length]}(m),typeof B.init=="function"&&B.init(p),p}(B=O.exports=d.debug=d.default=d).coerce=function(m){return m instanceof Error?m.stack||m.message:m},B.disable=function(){B.enable("")},B.enable=function(m){B.save(m),B.names=[],B.skips=[];for(var p=(typeof m=="string"?m:"").split(/[\s,]+/),e=p.length,f=0;f<e;f++)p[f]&&((m=p[f].replace(/\*/g,".*?"))[0]==="-"?B.skips.push(new RegExp("^"+m.substr(1)+"$")):B.names.push(new RegExp("^"+m+"$")))},B.enabled=function(m){var p,e;for(p=0,e=B.skips.length;p<e;p++)if(B.skips[p].test(m))return!1;for(p=0,e=B.names.length;p<e;p++)if(B.names[p].test(m))return!0;return!1},B.humanize=r("ms"),B.names=[],B.skips=[],B.formatters={}},{ms:573}],573:[function(r,O,B){var t=1e3,d=6e4,m=60*d,p=24*m;function e(f,u,s){if(!(f<u))return f<1.5*u?Math.floor(f/u)+" "+s:Math.ceil(f/u)+" "+s+"s"}O.exports=function(f,u){u=u||{};var s,l=typeof f;if(l==="string"&&f.length>0)return function(o){if(!((o=String(o)).length>100)){var i=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(o);if(!!i){var c=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*c;case"days":case"day":case"d":return c*p;case"hours":case"hour":case"hrs":case"hr":case"h":return c*m;case"minutes":case"minute":case"mins":case"min":case"m":return c*d;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}(f);if(l==="number"&&isNaN(f)===!1)return u.long?e(s=f,p,"day")||e(s,m,"hour")||e(s,d,"minute")||e(s,t,"second")||s+" ms":function(o){return o>=p?Math.round(o/p)+"d":o>=m?Math.round(o/m)+"h":o>=d?Math.round(o/d)+"m":o>=t?Math.round(o/t)+"s":o+"ms"}(f);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(f))}},{}],574:[function(r,O,B){var t=r("parenthesis");O.exports=function(d,m,p){if(d==null)throw Error("First argument should be a string");if(m==null)throw Error("Separator should be a string or a RegExp");p?(typeof p=="string"||Array.isArray(p))&&(p={ignore:p}):p={},p.escape==null&&(p.escape=!0),p.ignore==null?p.ignore=["[]","()","{}","<>",'""',"''","``","\u201C\u201D","\xAB\xBB"]:(typeof p.ignore=="string"&&(p.ignore=[p.ignore]),p.ignore=p.ignore.map(function(i){return i.length===1&&(i+=i),i}));var e=t.parse(d,{flat:!0,brackets:p.ignore}),f=e[0].split(m);if(p.escape){for(var u=[],s=0;s<f.length;s++){var l=f[s],o=f[s+1];l[l.length-1]==="\\"&&l[l.length-2]!=="\\"?(u.push(l+m+o),s++):u.push(l)}f=u}for(s=0;s<f.length;s++)e[0]=f[s],f[s]=t.stringify(e,{flat:!0});return f}},{parenthesis:480}],575:[function(r,O,B){O.exports=function(t){for(var d=t.length,m=new Array(d),p=new Array(d),e=new Array(d),f=new Array(d),u=new Array(d),s=new Array(d),l=0;l<d;++l)m[l]=-1,p[l]=0,e[l]=!1,f[l]=0,u[l]=-1,s[l]=[];var o,i=0,c=[],n=[];function a(y){var v=[y],_=[y];for(m[y]=p[y]=i,e[y]=!0,i+=1;_.length>0;){y=_[_.length-1];var x=t[y];if(f[y]<x.length){for(var T=f[y];T<x.length;++T){var A=x[T];if(m[A]<0){m[A]=p[A]=i,e[A]=!0,i+=1,v.push(A),_.push(A);break}e[A]&&(p[y]=0|Math.min(p[y],p[A])),u[A]>=0&&s[y].push(u[A])}f[y]=T}else{if(p[y]===m[y]){var S=[],w=[],C=0;for(T=v.length-1;T>=0;--T){var k=v[T];if(e[k]=!1,S.push(k),w.push(s[k]),C+=s[k].length,u[k]=c.length,k===y){v.length=T;break}}c.push(S);var L=new Array(C);for(T=0;T<w.length;T++)for(var M=0;M<w[T].length;M++)L[--C]=w[T][M];n.push(L)}_.pop()}}}for(l=0;l<d;++l)m[l]<0&&a(l);for(l=0;l<n.length;l++){var g=n[l];if(g.length!==0){g.sort(function(y,v){return y-v}),o=[g[0]];for(var h=1;h<g.length;h++)g[h]!==g[h-1]&&o.push(g[h]);n[l]=o}}return{components:c,adjacencyList:n}}},{}],576:[function(r,O,B){O.exports=function(e,f){if(e.dimension<=0)return{positions:[],cells:[]};if(e.dimension===1)return function(l,o){for(var i=d(l,o),c=i.length,n=new Array(c),a=new Array(c),g=0;g<c;++g)n[g]=[i[g]],a[g]=[g];return{positions:n,cells:a}}(e,f);var u=e.order.join()+"-"+e.dtype,s=p[u];return f=+f||0,s||(s=p[u]=function(l,o){var i=l.length+"d",c=m[i];if(c)return c(t,l,o)}(e.order,e.dtype)),s(e,f)};var t=r("ndarray-extract-contour"),d=r("zero-crossings"),m={"2d":function(e,f,u){var s=e({order:f,scalarArguments:3,getters:u==="generic"?[0]:void 0,phase:function(l,o,i,c){return l>c|0},vertex:function(l,o,i,c,n,a,g,h,y,v,_,x,T){var A=(g<<0)+(h<<1)+(y<<2)+(v<<3)|0;if(A!==0&&A!==15)switch(A){case 0:_.push([l-.5,o-.5]);break;case 1:_.push([l-.25-.25*(c+i-2*T)/(i-c),o-.25-.25*(n+i-2*T)/(i-n)]);break;case 2:_.push([l-.75-.25*(-c-i+2*T)/(c-i),o-.25-.25*(a+c-2*T)/(c-a)]);break;case 3:_.push([l-.5,o-.5-.5*(n+i+a+c-4*T)/(i-n+c-a)]);break;case 4:_.push([l-.25-.25*(a+n-2*T)/(n-a),o-.75-.25*(-n-i+2*T)/(n-i)]);break;case 5:_.push([l-.5-.5*(c+i+a+n-4*T)/(i-c+n-a),o-.5]);break;case 6:_.push([l-.5-.25*(-c-i+a+n)/(c-i+n-a),o-.5-.25*(-n-i+a+c)/(n-i+c-a)]);break;case 7:_.push([l-.75-.25*(a+n-2*T)/(n-a),o-.75-.25*(a+c-2*T)/(c-a)]);break;case 8:_.push([l-.75-.25*(-a-n+2*T)/(a-n),o-.75-.25*(-a-c+2*T)/(a-c)]);break;case 9:_.push([l-.5-.25*(c+i+-a-n)/(i-c+a-n),o-.5-.25*(n+i+-a-c)/(i-n+a-c)]);break;case 10:_.push([l-.5-.5*(-c-i-a-n+4*T)/(c-i+a-n),o-.5]);break;case 11:_.push([l-.25-.25*(-a-n+2*T)/(a-n),o-.75-.25*(n+i-2*T)/(i-n)]);break;case 12:_.push([l-.5,o-.5-.5*(-n-i-a-c+4*T)/(n-i+a-c)]);break;case 13:_.push([l-.75-.25*(c+i-2*T)/(i-c),o-.25-.25*(-a-c+2*T)/(a-c)]);break;case 14:_.push([l-.25-.25*(-c-i+2*T)/(c-i),o-.25-.25*(-n-i+2*T)/(n-i)]);break;case 15:_.push([l-.5,o-.5])}},cell:function(l,o,i,c,n,a,g,h,y){n?h.push([l,o]):h.push([o,l])}});return function(l,o){var i=[],c=[];return s(l,i,c,o),{positions:i,cells:c}}}},p={}},{"ndarray-extract-contour":464,"zero-crossings":631}],577:[function(r,O,B){Object.defineProperty(B,"__esModule",{value:!0});var t=function(f,u){if(Array.isArray(f))return f;if(Symbol.iterator in Object(f))return function(s,l){var o=[],i=!0,c=!1,n=void 0;try{for(var a,g=s[Symbol.iterator]();!(i=(a=g.next()).done)&&(o.push(a.value),!l||o.length!==l);i=!0);}catch(h){c=!0,n=h}finally{try{!i&&g.return&&g.return()}finally{if(c)throw n}}return o}(f,u);throw new TypeError("Invalid attempt to destructure non-iterable instance")},d=2*Math.PI,m=function(f,u,s,l,o,i,c){var n=f.x,a=f.y;return{x:l*(n*=u)-o*(a*=s)+i,y:o*n+l*a+c}},p=function(f,u){var s=u===1.5707963267948966?.551915024494:u===-1.5707963267948966?-.551915024494:4/3*Math.tan(u/4),l=Math.cos(f),o=Math.sin(f),i=Math.cos(f+u),c=Math.sin(f+u);return[{x:l-o*s,y:o+l*s},{x:i+c*s,y:c-i*s},{x:i,y:c}]},e=function(f,u,s,l){var o=f*s+u*l;return o>1&&(o=1),o<-1&&(o=-1),(f*l-u*s<0?-1:1)*Math.acos(o)};B.default=function(f){var u=f.px,s=f.py,l=f.cx,o=f.cy,i=f.rx,c=f.ry,n=f.xAxisRotation,a=n===void 0?0:n,g=f.largeArcFlag,h=g===void 0?0:g,y=f.sweepFlag,v=y===void 0?0:y,_=[];if(i===0||c===0)return[];var x=Math.sin(a*d/360),T=Math.cos(a*d/360),A=T*(u-l)/2+x*(s-o)/2,S=-x*(u-l)/2+T*(s-o)/2;if(A===0&&S===0)return[];i=Math.abs(i),c=Math.abs(c);var w=Math.pow(A,2)/Math.pow(i,2)+Math.pow(S,2)/Math.pow(c,2);w>1&&(i*=Math.sqrt(w),c*=Math.sqrt(w));var C=function(X,K,Z,H,Y,$,z,j,W,ee,J,Q){var te=Math.pow(Y,2),ie=Math.pow($,2),ae=Math.pow(J,2),he=Math.pow(Q,2),se=te*ie-te*he-ie*ae;se<0&&(se=0),se/=te*he+ie*ae;var de=(se=Math.sqrt(se)*(z===j?-1:1))*Y/$*Q,ue=se*-$/Y*J,ve=ee*de-W*ue+(X+Z)/2,ke=W*de+ee*ue+(K+H)/2,Ee=(J-de)/Y,be=(Q-ue)/$,xe=(-J-de)/Y,ce=(-Q-ue)/$,ge=e(1,0,Ee,be),we=e(Ee,be,xe,ce);return j===0&&we>0&&(we-=d),j===1&&we<0&&(we+=d),[ve,ke,ge,we]}(u,s,l,o,i,c,h,v,x,T,A,S),k=t(C,4),L=k[0],M=k[1],P=k[2],D=k[3],N=Math.abs(D)/(d/4);Math.abs(1-N)<1e-7&&(N=1);var U=Math.max(Math.ceil(N),1);D/=U;for(var q=0;q<U;q++)_.push(p(P,D)),P+=D;return _.map(function(X){var K=m(X[0],i,c,T,x,L,M),Z=K.x,H=K.y,Y=m(X[1],i,c,T,x,L,M),$=Y.x,z=Y.y,j=m(X[2],i,c,T,x,L,M);return{x1:Z,y1:H,x2:$,y2:z,x:j.x,y:j.y}})},O.exports=B.default},{}],578:[function(r,O,B){var t=r("parse-svg-path"),d=r("abs-svg-path"),m=r("normalize-svg-path"),p=r("is-svg-path"),e=r("assert");O.exports=function(f){if(Array.isArray(f)&&f.length===1&&typeof f[0]=="string"&&(f=f[0]),typeof f=="string"&&(e(p(f),"String is not an SVG path."),f=t(f)),e(Array.isArray(f),"Argument should be a string or an array of path segments."),f=d(f),!(f=m(f)).length)return[0,0,0,0];for(var u=[1/0,1/0,-1/0,-1/0],s=0,l=f.length;s<l;s++)for(var o=f[s].slice(1),i=0;i<o.length;i+=2)o[i+0]<u[0]&&(u[0]=o[i+0]),o[i+1]<u[1]&&(u[1]=o[i+1]),o[i+0]>u[2]&&(u[2]=o[i+0]),o[i+1]>u[3]&&(u[3]=o[i+1]);return u}},{"abs-svg-path":71,assert:80,"is-svg-path":449,"normalize-svg-path":579,"parse-svg-path":482}],579:[function(r,O,B){O.exports=function(p){for(var e,f=[],u=0,s=0,l=0,o=0,i=null,c=null,n=0,a=0,g=0,h=p.length;g<h;g++){var y=p[g],v=y[0];switch(v){case"M":l=y[1],o=y[2];break;case"A":var _=t({px:n,py:a,cx:y[6],cy:y[7],rx:y[1],ry:y[2],xAxisRotation:y[3],largeArcFlag:y[4],sweepFlag:y[5]});if(!_.length)continue;for(var x,T=0;T<_.length;T++)x=_[T],y=["C",x.x1,x.y1,x.x2,x.y2,x.x,x.y],T<_.length-1&&f.push(y);break;case"S":var A=n,S=a;e!="C"&&e!="S"||(A+=A-u,S+=S-s),y=["C",A,S,y[1],y[2],y[3],y[4]];break;case"T":e=="Q"||e=="T"?(i=2*n-i,c=2*a-c):(i=n,c=a),y=m(n,a,i,c,y[1],y[2]);break;case"Q":i=y[1],c=y[2],y=m(n,a,y[1],y[2],y[3],y[4]);break;case"L":y=d(n,a,y[1],y[2]);break;case"H":y=d(n,a,y[1],a);break;case"V":y=d(n,a,n,y[1]);break;case"Z":y=d(n,a,l,o)}e=v,n=y[y.length-2],a=y[y.length-1],y.length>4?(u=y[y.length-4],s=y[y.length-3]):(u=n,s=a),f.push(y)}return f};var t=r("svg-arc-to-cubic-bezier");function d(p,e,f,u){return["C",p,e,f,u,f,u]}function m(p,e,f,u,s,l){return["C",p/3+2/3*f,e/3+2/3*u,s/3+2/3*f,l/3+2/3*u,s,l]}},{"svg-arc-to-cubic-bezier":577}],580:[function(r,O,B){var t,d=r("svg-path-bounds"),m=r("parse-svg-path"),p=r("draw-svg-path"),e=r("is-svg-path"),f=r("bitmap-sdf"),u=document.createElement("canvas"),s=u.getContext("2d");O.exports=function(l,o){if(!e(l))throw Error("Argument should be valid svg path string");o||(o={});var i,c;o.shape?(i=o.shape[0],c=o.shape[1]):(i=u.width=o.w||o.width||200,c=u.height=o.h||o.height||200);var n=Math.min(i,c),a=o.stroke||0,g=o.viewbox||o.viewBox||d(l),h=[i/(g[2]-g[0]),c/(g[3]-g[1])],y=Math.min(h[0]||0,h[1]||0)/2;if(s.fillStyle="black",s.fillRect(0,0,i,c),s.fillStyle="white",a&&(typeof a!="number"&&(a=1),s.strokeStyle=a>0?"white":"black",s.lineWidth=Math.abs(a)),s.translate(.5*i,.5*c),s.scale(y,y),function(){if(t!=null)return t;var x=document.createElement("canvas").getContext("2d");if(x.canvas.width=x.canvas.height=1,!window.Path2D)return t=!1;var T=new Path2D("M0,0h1v1h-1v-1Z");x.fillStyle="black",x.fill(T);var A=x.getImageData(0,0,1,1);return t=A&&A.data&&A.data[3]===255}()){var v=new Path2D(l);s.fill(v),a&&s.stroke(v)}else{var _=m(l);p(s,_),s.fill(),a&&s.stroke()}return s.setTransform(1,0,0,1,0,0),f(s,{cutoff:o.cutoff!=null?o.cutoff:.5,radius:o.radius!=null?o.radius:.5*n})}},{"bitmap-sdf":105,"draw-svg-path":180,"is-svg-path":449,"parse-svg-path":482,"svg-path-bounds":578}],581:[function(r,O,B){(function(t){(function(){O.exports=function e(f,u,s){s=s||{};var l=p[f];l||(l=p[f]={" ":{data:new Float32Array(0),shape:.2}});var o=l[u];if(!o)if(u.length<=1||!/\d/.test(u))o=l[u]=function(T){for(var A=T.cells,S=T.positions,w=new Float32Array(6*A.length),C=0,k=0,L=0;L<A.length;++L)for(var M=A[L],P=0;P<3;++P){var D=S[M[P]];w[C++]=D[0],w[C++]=D[1]+1.4,k=Math.max(D[0],k)}return{data:w,shape:k}}(d(u,{triangles:!0,font:f,textAlign:s.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var i=u.split(/(\d|\s)/),c=new Array(i.length),n=0,a=0,g=0;g<i.length;++g)c[g]=e(f,i[g]),n+=c[g].data.length,a+=c[g].shape,g>0&&(a+=.02);var h=new Float32Array(n),y=0,v=-.5*a;for(g=0;g<c.length;++g){for(var _=c[g].data,x=0;x<_.length;x+=2)h[y++]=_[x]+v,h[y++]=_[x+1];v+=c[g].shape+.02}o=l[u]={data:h,shape:a}}return o};var d=r("vectorize-text"),m=window||t.global||{},p=m.__TEXT_CACHE||{};m.__TEXT_CACHE={}}).call(this)}).call(this,r("_process"))},{_process:514,"vectorize-text":607}],582:[function(r,O,B){(function(t,d){(function(){var m=r("process/browser.js").nextTick,p=Function.prototype.apply,e=Array.prototype.slice,f={},u=0;function s(l,o){this._id=l,this._clearFn=o}B.setTimeout=function(){return new s(p.call(setTimeout,window,arguments),clearTimeout)},B.setInterval=function(){return new s(p.call(setInterval,window,arguments),clearInterval)},B.clearTimeout=B.clearInterval=function(l){l.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},B.enroll=function(l,o){clearTimeout(l._idleTimeoutId),l._idleTimeout=o},B.unenroll=function(l){clearTimeout(l._idleTimeoutId),l._idleTimeout=-1},B._unrefActive=B.active=function(l){clearTimeout(l._idleTimeoutId);var o=l._idleTimeout;o>=0&&(l._idleTimeoutId=setTimeout(function(){l._onTimeout&&l._onTimeout()},o))},B.setImmediate=typeof t=="function"?t:function(l){var o=u++,i=!(arguments.length<2)&&e.call(arguments,1);return f[o]=!0,m(function(){f[o]&&(i?l.apply(null,i):l.call(null),B.clearImmediate(o))}),o},B.clearImmediate=typeof d=="function"?d:function(l){delete f[l]}}).call(this)}).call(this,r("timers").setImmediate,r("timers").clearImmediate)},{"process/browser.js":514,timers:582}],583:[function(r,O,B){(function(t){var d=/^\s+/,m=/\s+$/,p=0,e=t.round,f=t.min,u=t.max,s=t.random;function l(W,ee){if(ee=ee||{},(W=W||"")instanceof l)return W;if(!(this instanceof l))return new l(W,ee);var J=function(Q){var te={r:0,g:0,b:0},ie=1,ae=null,he=null,se=null,de=!1,ue=!1;typeof Q=="string"&&(Q=function(be){be=be.replace(d,"").replace(m,"").toLowerCase();var xe,ce=!1;if(L[be])be=L[be],ce=!0;else if(be=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(xe=z.rgb.exec(be))?{r:xe[1],g:xe[2],b:xe[3]}:(xe=z.rgba.exec(be))?{r:xe[1],g:xe[2],b:xe[3],a:xe[4]}:(xe=z.hsl.exec(be))?{h:xe[1],s:xe[2],l:xe[3]}:(xe=z.hsla.exec(be))?{h:xe[1],s:xe[2],l:xe[3],a:xe[4]}:(xe=z.hsv.exec(be))?{h:xe[1],s:xe[2],v:xe[3]}:(xe=z.hsva.exec(be))?{h:xe[1],s:xe[2],v:xe[3],a:xe[4]}:(xe=z.hex8.exec(be))?{r:U(xe[1]),g:U(xe[2]),b:U(xe[3]),a:Z(xe[4]),format:ce?"name":"hex8"}:(xe=z.hex6.exec(be))?{r:U(xe[1]),g:U(xe[2]),b:U(xe[3]),format:ce?"name":"hex"}:(xe=z.hex4.exec(be))?{r:U(xe[1]+""+xe[1]),g:U(xe[2]+""+xe[2]),b:U(xe[3]+""+xe[3]),a:Z(xe[4]+""+xe[4]),format:ce?"name":"hex8"}:(xe=z.hex3.exec(be))?{r:U(xe[1]+""+xe[1]),g:U(xe[2]+""+xe[2]),b:U(xe[3]+""+xe[3]),format:ce?"name":"hex"}:!1}(Q)),typeof Q=="object"&&(j(Q.r)&&j(Q.g)&&j(Q.b)?(ve=Q.r,ke=Q.g,Ee=Q.b,te={r:255*D(ve,255),g:255*D(ke,255),b:255*D(Ee,255)},de=!0,ue=String(Q.r).substr(-1)==="%"?"prgb":"rgb"):j(Q.h)&&j(Q.s)&&j(Q.v)?(ae=X(Q.s),he=X(Q.v),te=function(be,xe,ce){be=6*D(be,360),xe=D(xe,100),ce=D(ce,100);var ge=t.floor(be),we=be-ge,Me=ce*(1-xe),Se=ce*(1-we*xe),ze=ce*(1-(1-we)*xe),Fe=ge%6;return{r:255*[ce,Se,Me,Me,ze,ce][Fe],g:255*[ze,ce,ce,Se,Me,Me][Fe],b:255*[Me,Me,ze,ce,ce,Se][Fe]}}(Q.h,ae,he),de=!0,ue="hsv"):j(Q.h)&&j(Q.s)&&j(Q.l)&&(ae=X(Q.s),se=X(Q.l),te=function(be,xe,ce){var ge,we,Me;function Se(Ye,rt,Oe){return Oe<0&&(Oe+=1),Oe>1&&(Oe-=1),Oe<1/6?Ye+6*(rt-Ye)*Oe:Oe<.5?rt:Oe<2/3?Ye+(rt-Ye)*(2/3-Oe)*6:Ye}if(be=D(be,360),xe=D(xe,100),ce=D(ce,100),xe===0)ge=we=Me=ce;else{var ze=ce<.5?ce*(1+xe):ce+xe-ce*xe,Fe=2*ce-ze;ge=Se(Fe,ze,be+1/3),we=Se(Fe,ze,be),Me=Se(Fe,ze,be-1/3)}return{r:255*ge,g:255*we,b:255*Me}}(Q.h,ae,se),de=!0,ue="hsl"),Q.hasOwnProperty("a")&&(ie=Q.a));var ve,ke,Ee;return ie=P(ie),{ok:de,format:Q.format||ue,r:f(255,u(te.r,0)),g:f(255,u(te.g,0)),b:f(255,u(te.b,0)),a:ie}}(W);this._originalInput=W,this._r=J.r,this._g=J.g,this._b=J.b,this._a=J.a,this._roundA=e(100*this._a)/100,this._format=ee.format||J.format,this._gradientType=ee.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=J.ok,this._tc_id=p++}function o(W,ee,J){W=D(W,255),ee=D(ee,255),J=D(J,255);var Q,te,ie=u(W,ee,J),ae=f(W,ee,J),he=(ie+ae)/2;if(ie==ae)Q=te=0;else{var se=ie-ae;switch(te=he>.5?se/(2-ie-ae):se/(ie+ae),ie){case W:Q=(ee-J)/se+(ee<J?6:0);break;case ee:Q=(J-W)/se+2;break;case J:Q=(W-ee)/se+4}Q/=6}return{h:Q,s:te,l:he}}function i(W,ee,J){W=D(W,255),ee=D(ee,255),J=D(J,255);var Q,te,ie=u(W,ee,J),ae=f(W,ee,J),he=ie,se=ie-ae;if(te=ie===0?0:se/ie,ie==ae)Q=0;else{switch(ie){case W:Q=(ee-J)/se+(ee<J?6:0);break;case ee:Q=(J-W)/se+2;break;case J:Q=(W-ee)/se+4}Q/=6}return{h:Q,s:te,v:he}}function c(W,ee,J,Q){var te=[q(e(W).toString(16)),q(e(ee).toString(16)),q(e(J).toString(16))];return Q&&te[0].charAt(0)==te[0].charAt(1)&&te[1].charAt(0)==te[1].charAt(1)&&te[2].charAt(0)==te[2].charAt(1)?te[0].charAt(0)+te[1].charAt(0)+te[2].charAt(0):te.join("")}function n(W,ee,J,Q){return[q(K(Q)),q(e(W).toString(16)),q(e(ee).toString(16)),q(e(J).toString(16))].join("")}function a(W,ee){ee=ee===0?0:ee||10;var J=l(W).toHsl();return J.s-=ee/100,J.s=N(J.s),l(J)}function g(W,ee){ee=ee===0?0:ee||10;var J=l(W).toHsl();return J.s+=ee/100,J.s=N(J.s),l(J)}function h(W){return l(W).desaturate(100)}function y(W,ee){ee=ee===0?0:ee||10;var J=l(W).toHsl();return J.l+=ee/100,J.l=N(J.l),l(J)}function v(W,ee){ee=ee===0?0:ee||10;var J=l(W).toRgb();return J.r=u(0,f(255,J.r-e(-ee/100*255))),J.g=u(0,f(255,J.g-e(-ee/100*255))),J.b=u(0,f(255,J.b-e(-ee/100*255))),l(J)}function _(W,ee){ee=ee===0?0:ee||10;var J=l(W).toHsl();return J.l-=ee/100,J.l=N(J.l),l(J)}function x(W,ee){var J=l(W).toHsl(),Q=(J.h+ee)%360;return J.h=Q<0?360+Q:Q,l(J)}function T(W){var ee=l(W).toHsl();return ee.h=(ee.h+180)%360,l(ee)}function A(W){var ee=l(W).toHsl(),J=ee.h;return[l(W),l({h:(J+120)%360,s:ee.s,l:ee.l}),l({h:(J+240)%360,s:ee.s,l:ee.l})]}function S(W){var ee=l(W).toHsl(),J=ee.h;return[l(W),l({h:(J+90)%360,s:ee.s,l:ee.l}),l({h:(J+180)%360,s:ee.s,l:ee.l}),l({h:(J+270)%360,s:ee.s,l:ee.l})]}function w(W){var ee=l(W).toHsl(),J=ee.h;return[l(W),l({h:(J+72)%360,s:ee.s,l:ee.l}),l({h:(J+216)%360,s:ee.s,l:ee.l})]}function C(W,ee,J){ee=ee||6,J=J||30;var Q=l(W).toHsl(),te=360/J,ie=[l(W)];for(Q.h=(Q.h-(te*ee>>1)+720)%360;--ee;)Q.h=(Q.h+te)%360,ie.push(l(Q));return ie}function k(W,ee){ee=ee||6;for(var J=l(W).toHsv(),Q=J.h,te=J.s,ie=J.v,ae=[],he=1/ee;ee--;)ae.push(l({h:Q,s:te,v:ie})),ie=(ie+he)%1;return ae}l.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var W=this.toRgb();return(299*W.r+587*W.g+114*W.b)/1e3},getLuminance:function(){var W,ee,J,Q=this.toRgb();return W=Q.r/255,ee=Q.g/255,J=Q.b/255,.2126*(W<=.03928?W/12.92:t.pow((W+.055)/1.055,2.4))+.7152*(ee<=.03928?ee/12.92:t.pow((ee+.055)/1.055,2.4))+.0722*(J<=.03928?J/12.92:t.pow((J+.055)/1.055,2.4))},setAlpha:function(W){return this._a=P(W),this._roundA=e(100*this._a)/100,this},toHsv:function(){var W=i(this._r,this._g,this._b);return{h:360*W.h,s:W.s,v:W.v,a:this._a}},toHsvString:function(){var W=i(this._r,this._g,this._b),ee=e(360*W.h),J=e(100*W.s),Q=e(100*W.v);return this._a==1?"hsv("+ee+", "+J+"%, "+Q+"%)":"hsva("+ee+", "+J+"%, "+Q+"%, "+this._roundA+")"},toHsl:function(){var W=o(this._r,this._g,this._b);return{h:360*W.h,s:W.s,l:W.l,a:this._a}},toHslString:function(){var W=o(this._r,this._g,this._b),ee=e(360*W.h),J=e(100*W.s),Q=e(100*W.l);return this._a==1?"hsl("+ee+", "+J+"%, "+Q+"%)":"hsla("+ee+", "+J+"%, "+Q+"%, "+this._roundA+")"},toHex:function(W){return c(this._r,this._g,this._b,W)},toHexString:function(W){return"#"+this.toHex(W)},toHex8:function(W){return function(ee,J,Q,te,ie){var ae=[q(e(ee).toString(16)),q(e(J).toString(16)),q(e(Q).toString(16)),q(K(te))];return ie&&ae[0].charAt(0)==ae[0].charAt(1)&&ae[1].charAt(0)==ae[1].charAt(1)&&ae[2].charAt(0)==ae[2].charAt(1)&&ae[3].charAt(0)==ae[3].charAt(1)?ae[0].charAt(0)+ae[1].charAt(0)+ae[2].charAt(0)+ae[3].charAt(0):ae.join("")}(this._r,this._g,this._b,this._a,W)},toHex8String:function(W){return"#"+this.toHex8(W)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(100*D(this._r,255))+"%",g:e(100*D(this._g,255))+"%",b:e(100*D(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+e(100*D(this._r,255))+"%, "+e(100*D(this._g,255))+"%, "+e(100*D(this._b,255))+"%)":"rgba("+e(100*D(this._r,255))+"%, "+e(100*D(this._g,255))+"%, "+e(100*D(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(M[c(this._r,this._g,this._b,!0)]||!1)},toFilter:function(W){var ee="#"+n(this._r,this._g,this._b,this._a),J=ee,Q=this._gradientType?"GradientType = 1, ":"";if(W){var te=l(W);J="#"+n(te._r,te._g,te._b,te._a)}return"progid:DXImageTransform.Microsoft.gradient("+Q+"startColorstr="+ee+",endColorstr="+J+")"},toString:function(W){var ee=!!W;W=W||this._format;var J=!1,Q=this._a<1&&this._a>=0;return ee||!Q||W!=="hex"&&W!=="hex6"&&W!=="hex3"&&W!=="hex4"&&W!=="hex8"&&W!=="name"?(W==="rgb"&&(J=this.toRgbString()),W==="prgb"&&(J=this.toPercentageRgbString()),W!=="hex"&&W!=="hex6"||(J=this.toHexString()),W==="hex3"&&(J=this.toHexString(!0)),W==="hex4"&&(J=this.toHex8String(!0)),W==="hex8"&&(J=this.toHex8String()),W==="name"&&(J=this.toName()),W==="hsl"&&(J=this.toHslString()),W==="hsv"&&(J=this.toHsvString()),J||this.toHexString()):W==="name"&&this._a===0?this.toName():this.toRgbString()},clone:function(){return l(this.toString())},_applyModification:function(W,ee){var J=W.apply(null,[this].concat([].slice.call(ee)));return this._r=J._r,this._g=J._g,this._b=J._b,this.setAlpha(J._a),this},lighten:function(){return this._applyModification(y,arguments)},brighten:function(){return this._applyModification(v,arguments)},darken:function(){return this._applyModification(_,arguments)},desaturate:function(){return this._applyModification(a,arguments)},saturate:function(){return this._applyModification(g,arguments)},greyscale:function(){return this._applyModification(h,arguments)},spin:function(){return this._applyModification(x,arguments)},_applyCombination:function(W,ee){return W.apply(null,[this].concat([].slice.call(ee)))},analogous:function(){return this._applyCombination(C,arguments)},complement:function(){return this._applyCombination(T,arguments)},monochromatic:function(){return this._applyCombination(k,arguments)},splitcomplement:function(){return this._applyCombination(w,arguments)},triad:function(){return this._applyCombination(A,arguments)},tetrad:function(){return this._applyCombination(S,arguments)}},l.fromRatio=function(W,ee){if(typeof W=="object"){var J={};for(var Q in W)W.hasOwnProperty(Q)&&(J[Q]=Q==="a"?W[Q]:X(W[Q]));W=J}return l(W,ee)},l.equals=function(W,ee){return!(!W||!ee)&&l(W).toRgbString()==l(ee).toRgbString()},l.random=function(){return l.fromRatio({r:s(),g:s(),b:s()})},l.mix=function(W,ee,J){J=J===0?0:J||50;var Q=l(W).toRgb(),te=l(ee).toRgb(),ie=J/100;return l({r:(te.r-Q.r)*ie+Q.r,g:(te.g-Q.g)*ie+Q.g,b:(te.b-Q.b)*ie+Q.b,a:(te.a-Q.a)*ie+Q.a})},l.readability=function(W,ee){var J=l(W),Q=l(ee);return(t.max(J.getLuminance(),Q.getLuminance())+.05)/(t.min(J.getLuminance(),Q.getLuminance())+.05)},l.isReadable=function(W,ee,J){var Q,te,ie=l.readability(W,ee);switch(te=!1,(Q=function(ae){var he,se;return he=((ae=ae||{level:"AA",size:"small"}).level||"AA").toUpperCase(),se=(ae.size||"small").toLowerCase(),he!=="AA"&&he!=="AAA"&&(he="AA"),se!=="small"&&se!=="large"&&(se="small"),{level:he,size:se}}(J)).level+Q.size){case"AAsmall":case"AAAlarge":te=ie>=4.5;break;case"AAlarge":te=ie>=3;break;case"AAAsmall":te=ie>=7}return te},l.mostReadable=function(W,ee,J){var Q,te,ie,ae,he=null,se=0;te=(J=J||{}).includeFallbackColors,ie=J.level,ae=J.size;for(var de=0;de<ee.length;de++)(Q=l.readability(W,ee[de]))>se&&(se=Q,he=l(ee[de]));return l.isReadable(W,he,{level:ie,size:ae})||!te?he:(J.includeFallbackColors=!1,l.mostReadable(W,["#fff","#000"],J))};var L=l.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},M=l.hexNames=function(W){var ee={};for(var J in W)W.hasOwnProperty(J)&&(ee[W[J]]=J);return ee}(L);function P(W){return W=parseFloat(W),(isNaN(W)||W<0||W>1)&&(W=1),W}function D(W,ee){(function(Q){return typeof Q=="string"&&Q.indexOf(".")!=-1&&parseFloat(Q)===1})(W)&&(W="100%");var J=function(Q){return typeof Q=="string"&&Q.indexOf("%")!=-1}(W);return W=f(ee,u(0,parseFloat(W))),J&&(W=parseInt(W*ee,10)/100),t.abs(W-ee)<1e-6?1:W%ee/parseFloat(ee)}function N(W){return f(1,u(0,W))}function U(W){return parseInt(W,16)}function q(W){return W.length==1?"0"+W:""+W}function X(W){return W<=1&&(W=100*W+"%"),W}function K(W){return t.round(255*parseFloat(W)).toString(16)}function Z(W){return U(W)/255}var H,Y,$,z=(Y="[\\s|\\(]+("+(H="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+H+")[,|\\s]+("+H+")\\s*\\)?",$="[\\s|\\(]+("+H+")[,|\\s]+("+H+")[,|\\s]+("+H+")[,|\\s]+("+H+")\\s*\\)?",{CSS_UNIT:new RegExp(H),rgb:new RegExp("rgb"+Y),rgba:new RegExp("rgba"+$),hsl:new RegExp("hsl"+Y),hsla:new RegExp("hsla"+$),hsv:new RegExp("hsv"+Y),hsva:new RegExp("hsva"+$),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function j(W){return!!z.CSS_UNIT.exec(W)}O!==void 0&&O.exports?O.exports=l:window.tinycolor=l})(Math)},{}],584:[function(r,O,B){O.exports=d,O.exports.float32=O.exports.float=d,O.exports.fract32=O.exports.fract=function(m,p){if(m.length){if(m instanceof Float32Array)return new Float32Array(m.length);p instanceof Float32Array||(p=d(m));for(var e=0,f=p.length;e<f;e++)p[e]=m[e]-p[e];return p}return d(m-d(m))};var t=new Float32Array(1);function d(m){return m.length?m instanceof Float32Array?m:new Float32Array(m):(t[0]=m,t[0])}},{}],585:[function(r,O,B){var t=r("parse-unit");O.exports=m;function d(p,e){var f=t(getComputedStyle(p).getPropertyValue(e));return f[0]*m(f[1],p)}function m(p,e){switch(e=e||document.body,p=(p||"px").trim().toLowerCase(),e!==window&&e!==document||(e=document.body),p){case"%":return e.clientHeight/100;case"ch":case"ex":return function(f,u){var s=document.createElement("div");s.style["font-size"]="128"+f,u.appendChild(s);var l=d(s,"font-size")/128;return u.removeChild(s),l}(p,e);case"em":return d(e,"font-size");case"rem":return d(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}},{"parse-unit":483}],586:[function(r,O,B){(function(t,d){d(typeof B=="object"&&O!==void 0?B:(t=t||self).topojson=t.topojson||{})})(this,function(t){function d(n){return n}function m(n){if(n==null)return d;var a,g,h=n.scale[0],y=n.scale[1],v=n.translate[0],_=n.translate[1];return function(x,T){T||(a=g=0);var A=2,S=x.length,w=new Array(S);for(w[0]=(a+=x[0])*h+v,w[1]=(g+=x[1])*y+_;A<S;)w[A]=x[A],++A;return w}}function p(n){var a,g=m(n.transform),h=1/0,y=h,v=-h,_=-h;function x(A){(A=g(A))[0]<h&&(h=A[0]),A[0]>v&&(v=A[0]),A[1]<y&&(y=A[1]),A[1]>_&&(_=A[1])}function T(A){switch(A.type){case"GeometryCollection":A.geometries.forEach(T);break;case"Point":x(A.coordinates);break;case"MultiPoint":A.coordinates.forEach(x)}}for(a in n.arcs.forEach(function(A){for(var S,w=-1,C=A.length;++w<C;)(S=g(A[w],w))[0]<h&&(h=S[0]),S[0]>v&&(v=S[0]),S[1]<y&&(y=S[1]),S[1]>_&&(_=S[1])}),n.objects)T(n.objects[a]);return[h,y,v,_]}function e(n,a){var g=a.id,h=a.bbox,y=a.properties==null?{}:a.properties,v=f(n,a);return g==null&&h==null?{type:"Feature",properties:y,geometry:v}:h==null?{type:"Feature",id:g,properties:y,geometry:v}:{type:"Feature",id:g,bbox:h,properties:y,geometry:v}}function f(n,a){var g=m(n.transform),h=n.arcs;function y(A,S){S.length&&S.pop();for(var w=h[A<0?~A:A],C=0,k=w.length;C<k;++C)S.push(g(w[C],C));A<0&&function(L,M){for(var P,D=L.length,N=D-M;N<--D;)P=L[N],L[N++]=L[D],L[D]=P}(S,k)}function v(A){return g(A)}function _(A){for(var S=[],w=0,C=A.length;w<C;++w)y(A[w],S);return S.length<2&&S.push(S[0]),S}function x(A){for(var S=_(A);S.length<4;)S.push(S[0]);return S}function T(A){return A.map(x)}return function A(S){var w,C=S.type;switch(C){case"GeometryCollection":return{type:C,geometries:S.geometries.map(A)};case"Point":w=v(S.coordinates);break;case"MultiPoint":w=S.coordinates.map(v);break;case"LineString":w=_(S.arcs);break;case"MultiLineString":w=S.arcs.map(_);break;case"Polygon":w=T(S.arcs);break;case"MultiPolygon":w=S.arcs.map(T);break;default:return null}return{type:C,coordinates:w}}(a)}function u(n,a){var g={},h={},y={},v=[],_=-1;function x(T,A){for(var S in T){var w=T[S];delete A[w.start],delete w.start,delete w.end,w.forEach(function(C){g[C<0?~C:C]=1}),v.push(w)}}return a.forEach(function(T,A){var S,w=n.arcs[T<0?~T:T];w.length<3&&!w[1][0]&&!w[1][1]&&(S=a[++_],a[_]=T,a[A]=S)}),a.forEach(function(T){var A,S,w=function(P){var D,N=n.arcs[P<0?~P:P],U=N[0];return n.transform?(D=[0,0],N.forEach(function(q){D[0]+=q[0],D[1]+=q[1]})):D=N[N.length-1],P<0?[D,U]:[U,D]}(T),C=w[0],k=w[1];if(A=y[C])if(delete y[A.end],A.push(T),A.end=k,S=h[k]){delete h[S.start];var L=S===A?A:A.concat(S);h[L.start=A.start]=y[L.end=S.end]=L}else h[A.start]=y[A.end]=A;else if(A=h[k])if(delete h[A.start],A.unshift(T),A.start=C,S=y[C]){delete y[S.end];var M=S===A?A:S.concat(A);h[M.start=S.start]=y[M.end=A.end]=M}else h[A.start]=y[A.end]=A;else h[(A=[T]).start=C]=y[A.end=k]=A}),x(y,h),x(h,y),a.forEach(function(T){g[T<0?~T:T]||v.push([T])}),v}function s(n,a,g){var h,y,v;if(arguments.length>1)h=l(n,a,g);else for(y=0,h=new Array(v=n.arcs.length);y<v;++y)h[y]=y;return{type:"MultiLineString",arcs:u(n,h)}}function l(n,a,g){var h,y=[],v=[];function _(A){var S=A<0?~A:A;(v[S]||(v[S]=[])).push({i:A,g:h})}function x(A){A.forEach(_)}function T(A){A.forEach(x)}return function A(S){switch(h=S,S.type){case"GeometryCollection":S.geometries.forEach(A);break;case"LineString":x(S.arcs);break;case"MultiLineString":case"Polygon":T(S.arcs);break;case"MultiPolygon":(function(w){w.forEach(T)})(S.arcs)}}(a),v.forEach(g==null?function(A){y.push(A[0].i)}:function(A){g(A[0].g,A[A.length-1].g)&&y.push(A[0].i)}),y}function o(n,a){var g={},h=[],y=[];function v(x){x.forEach(function(T){T.forEach(function(A){(g[A=A<0?~A:A]||(g[A]=[])).push(x)})}),h.push(x)}function _(x){return function(T){for(var A,S=-1,w=T.length,C=T[w-1],k=0;++S<w;)A=C,C=T[S],k+=A[0]*C[1]-A[1]*C[0];return Math.abs(k)}(f(n,{type:"Polygon",arcs:[x]}).coordinates[0])}return a.forEach(function x(T){switch(T.type){case"GeometryCollection":T.geometries.forEach(x);break;case"Polygon":v(T.arcs);break;case"MultiPolygon":T.arcs.forEach(v)}}),h.forEach(function(x){if(!x._){var T=[],A=[x];for(x._=1,y.push(T);x=A.pop();)T.push(x),x.forEach(function(S){S.forEach(function(w){g[w<0?~w:w].forEach(function(C){C._||(C._=1,A.push(C))})})})}}),h.forEach(function(x){delete x._}),{type:"MultiPolygon",arcs:y.map(function(x){var T,A=[];if(x.forEach(function(L){L.forEach(function(M){M.forEach(function(P){g[P<0?~P:P].length<2&&A.push(P)})})}),(T=(A=u(n,A)).length)>1)for(var S,w,C=1,k=_(A[0]);C<T;++C)(S=_(A[C]))>k&&(w=A[0],A[0]=A[C],A[C]=w,k=S);return A}).filter(function(x){return x.length>0})}}function i(n,a){for(var g=0,h=n.length;g<h;){var y=g+h>>>1;n[y]<a?g=y+1:h=y}return g}function c(n){if(n==null)return d;var a,g,h=n.scale[0],y=n.scale[1],v=n.translate[0],_=n.translate[1];return function(x,T){T||(a=g=0);var A=2,S=x.length,w=new Array(S),C=Math.round((x[0]-v)/h),k=Math.round((x[1]-_)/y);for(w[0]=C-a,a=C,w[1]=k-g,g=k;A<S;)w[A]=x[A],++A;return w}}t.bbox=p,t.feature=function(n,a){return typeof a=="string"&&(a=n.objects[a]),a.type==="GeometryCollection"?{type:"FeatureCollection",features:a.geometries.map(function(g){return e(n,g)})}:e(n,a)},t.merge=function(n){return f(n,o.apply(this,arguments))},t.mergeArcs=o,t.mesh=function(n){return f(n,s.apply(this,arguments))},t.meshArcs=s,t.neighbors=function(n){var a={},g=n.map(function(){return[]});function h(L,M){L.forEach(function(P){P<0&&(P=~P);var D=a[P];D?D.push(M):a[P]=[M]})}function y(L,M){L.forEach(function(P){h(P,M)})}var v={LineString:h,MultiLineString:y,Polygon:y,MultiPolygon:function(L,M){L.forEach(function(P){y(P,M)})}};for(var _ in n.forEach(function L(M,P){M.type==="GeometryCollection"?M.geometries.forEach(function(D){L(D,P)}):M.type in v&&v[M.type](M.arcs,P)}),a)for(var x=a[_],T=x.length,A=0;A<T;++A)for(var S=A+1;S<T;++S){var w,C=x[A],k=x[S];(w=g[C])[_=i(w,k)]!==k&&w.splice(_,0,k),(w=g[k])[_=i(w,C)]!==C&&w.splice(_,0,C)}return g},t.quantize=function(n,a){if(n.transform)throw new Error("already quantized");if(a&&a.scale)x=n.bbox;else{if(!((g=Math.floor(a))>=2))throw new Error("n must be \u22652");var g,h=(x=n.bbox||p(n))[0],y=x[1],v=x[2],_=x[3];a={scale:[v-h?(v-h)/(g-1):1,_-y?(_-y)/(g-1):1],translate:[h,y]}}var x,T,A=c(a),S=n.objects,w={};function C(L){return A(L)}function k(L){var M;switch(L.type){case"GeometryCollection":M={type:"GeometryCollection",geometries:L.geometries.map(k)};break;case"Point":M={type:"Point",coordinates:C(L.coordinates)};break;case"MultiPoint":M={type:"MultiPoint",coordinates:L.coordinates.map(C)};break;default:return L}return L.id!=null&&(M.id=L.id),L.bbox!=null&&(M.bbox=L.bbox),L.properties!=null&&(M.properties=L.properties),M}for(T in S)w[T]=k(S[T]);return{type:"Topology",bbox:x,transform:a,objects:w,arcs:n.arcs.map(function(L){var M,P=0,D=1,N=L.length,U=new Array(N);for(U[0]=A(L[0],0);++P<N;)((M=A(L[P],P))[0]||M[1])&&(U[D++]=M);return D===1&&(U[D++]=[0,0]),U.length=D,U})}},t.transform=m,t.untransform=c,Object.defineProperty(t,"__esModule",{value:!0})})},{}],587:[function(r,O,B){O.exports=function(n){var a=(n=n||{}).center||[0,0,0],g=n.up||[0,1,0],h=n.right||l(g),y=n.radius||1,v=n.theta||0,_=n.phi||0;if(a=[].slice.call(a,0,3),g=[].slice.call(g,0,3),e(g,g),h=[].slice.call(h,0,3),e(h,h),"eye"in n){var x=n.eye,T=[x[0]-a[0],x[1]-a[1],x[2]-a[2]];p(h,T,g),u(h[0],h[1],h[2])<1e-6?h=l(g):e(h,h),y=u(T[0],T[1],T[2]);var A=f(g,T)/y,S=f(h,T)/y;_=Math.acos(A),v=Math.acos(S)}return y=Math.log(y),new o(n.zoomMin,n.zoomMax,a,g,h,y,v,_)};var t=r("filtered-vector"),d=r("gl-mat4/invert"),m=r("gl-mat4/rotate"),p=r("gl-vec3/cross"),e=r("gl-vec3/normalize"),f=r("gl-vec3/dot");function u(n,a,g){return Math.sqrt(Math.pow(n,2)+Math.pow(a,2)+Math.pow(g,2))}function s(n){return Math.min(1,Math.max(-1,n))}function l(n){var a=Math.abs(n[0]),g=Math.abs(n[1]),h=Math.abs(n[2]),y=[0,0,0];a>Math.max(g,h)?y[2]=1:g>Math.max(a,h)?y[0]=1:y[1]=1;for(var v=0,_=0,x=0;x<3;++x)v+=n[x]*n[x],_+=y[x]*n[x];for(x=0;x<3;++x)y[x]-=_/v*n[x];return e(y,y),y}function o(n,a,g,h,y,v,_,x){this.center=t(g),this.up=t(h),this.right=t(y),this.radius=t([v]),this.angle=t([_,x]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(n,a),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var T=0;T<16;++T)this.computedMatrix[T]=.5;this.recalcMatrix(0)}var i=o.prototype;i.setDistanceLimits=function(n,a){n=n>0?Math.log(n):-1/0,a=a>0?Math.log(a):1/0,a=Math.max(a,n),this.radius.bounds[0][0]=n,this.radius.bounds[1][0]=a},i.getDistanceLimits=function(n){var a=this.radius.bounds[0];return n?(n[0]=Math.exp(a[0][0]),n[1]=Math.exp(a[1][0]),n):[Math.exp(a[0][0]),Math.exp(a[1][0])]},i.recalcMatrix=function(n){this.center.curve(n),this.up.curve(n),this.right.curve(n),this.radius.curve(n),this.angle.curve(n);for(var a=this.computedUp,g=this.computedRight,h=0,y=0,v=0;v<3;++v)y+=a[v]*g[v],h+=a[v]*a[v];var _=Math.sqrt(h),x=0;for(v=0;v<3;++v)g[v]-=a[v]*y/h,x+=g[v]*g[v],a[v]/=_;var T=Math.sqrt(x);for(v=0;v<3;++v)g[v]/=T;var A=this.computedToward;p(A,a,g),e(A,A);var S=Math.exp(this.computedRadius[0]),w=this.computedAngle[0],C=this.computedAngle[1],k=Math.cos(w),L=Math.sin(w),M=Math.cos(C),P=Math.sin(C),D=this.computedCenter,N=k*M,U=L*M,q=P,X=-k*P,K=-L*P,Z=M,H=this.computedEye,Y=this.computedMatrix;for(v=0;v<3;++v){var $=N*g[v]+U*A[v]+q*a[v];Y[4*v+1]=X*g[v]+K*A[v]+Z*a[v],Y[4*v+2]=$,Y[4*v+3]=0}var z=Y[1],j=Y[5],W=Y[9],ee=Y[2],J=Y[6],Q=Y[10],te=j*Q-W*J,ie=W*ee-z*Q,ae=z*J-j*ee,he=u(te,ie,ae);for(te/=he,ie/=he,ae/=he,Y[0]=te,Y[4]=ie,Y[8]=ae,v=0;v<3;++v)H[v]=D[v]+Y[2+4*v]*S;for(v=0;v<3;++v){x=0;for(var se=0;se<3;++se)x+=Y[v+4*se]*H[se];Y[12+v]=-x}Y[15]=1},i.getMatrix=function(n,a){this.recalcMatrix(n);var g=this.computedMatrix;if(a){for(var h=0;h<16;++h)a[h]=g[h];return a}return g};var c=[0,0,0];i.rotate=function(n,a,g,h){if(this.angle.move(n,a,g),h){this.recalcMatrix(n);var y=this.computedMatrix;c[0]=y[2],c[1]=y[6],c[2]=y[10];for(var v=this.computedUp,_=this.computedRight,x=this.computedToward,T=0;T<3;++T)y[4*T]=v[T],y[4*T+1]=_[T],y[4*T+2]=x[T];for(m(y,y,h,c),T=0;T<3;++T)v[T]=y[4*T],_[T]=y[4*T+1];this.up.set(n,v[0],v[1],v[2]),this.right.set(n,_[0],_[1],_[2])}},i.pan=function(n,a,g,h){a=a||0,g=g||0,h=h||0,this.recalcMatrix(n);var y=this.computedMatrix,v=(Math.exp(this.computedRadius[0]),y[1]),_=y[5],x=y[9],T=u(v,_,x);v/=T,_/=T,x/=T;var A=y[0],S=y[4],w=y[8],C=A*v+S*_+w*x,k=u(A-=v*C,S-=_*C,w-=x*C),L=(A/=k)*a+v*g,M=(S/=k)*a+_*g,P=(w/=k)*a+x*g;this.center.move(n,L,M,P);var D=Math.exp(this.computedRadius[0]);D=Math.max(1e-4,D+h),this.radius.set(n,Math.log(D))},i.translate=function(n,a,g,h){this.center.move(n,a||0,g||0,h||0)},i.setMatrix=function(n,a,g,h){var y=1;typeof g=="number"&&(y=0|g),(y<0||y>3)&&(y=1);var v=(y+2)%3;a||(this.recalcMatrix(n),a=this.computedMatrix);var _=a[y],x=a[y+4],T=a[y+8];if(h){var A=Math.abs(_),S=Math.abs(x),w=Math.abs(T),C=Math.max(A,S,w);A===C?(_=_<0?-1:1,x=T=0):w===C?(T=T<0?-1:1,_=x=0):(x=x<0?-1:1,_=T=0)}else{var k=u(_,x,T);_/=k,x/=k,T/=k}var L,M,P=a[v],D=a[v+4],N=a[v+8],U=P*_+D*x+N*T,q=u(P-=_*U,D-=x*U,N-=T*U),X=x*(N/=q)-T*(D/=q),K=T*(P/=q)-_*N,Z=_*D-x*P,H=u(X,K,Z);if(X/=H,K/=H,Z/=H,this.center.jump(n,ke,Ee,be),this.radius.idle(n),this.up.jump(n,_,x,T),this.right.jump(n,P,D,N),y===2){var Y=a[1],$=a[5],z=a[9],j=Y*P+$*D+z*N,W=Y*X+$*K+z*Z;L=te<0?-Math.PI/2:Math.PI/2,M=Math.atan2(W,j)}else{var ee=a[2],J=a[6],Q=a[10],te=ee*_+J*x+Q*T,ie=ee*P+J*D+Q*N,ae=ee*X+J*K+Q*Z;L=Math.asin(s(te)),M=Math.atan2(ae,ie)}this.angle.jump(n,M,L),this.recalcMatrix(n);var he=a[2],se=a[6],de=a[10],ue=this.computedMatrix;d(ue,a);var ve=ue[15],ke=ue[12]/ve,Ee=ue[13]/ve,be=ue[14]/ve,xe=Math.exp(this.computedRadius[0]);this.center.jump(n,ke-he*xe,Ee-se*xe,be-de*xe)},i.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},i.idle=function(n){this.center.idle(n),this.up.idle(n),this.right.idle(n),this.radius.idle(n),this.angle.idle(n)},i.flush=function(n){this.center.flush(n),this.up.flush(n),this.right.flush(n),this.radius.flush(n),this.angle.flush(n)},i.setDistance=function(n,a){a>0&&this.radius.set(n,Math.log(a))},i.lookAt=function(n,a,g,h){this.recalcMatrix(n),a=a||this.computedEye,g=g||this.computedCenter;var y=(h=h||this.computedUp)[0],v=h[1],_=h[2],x=u(y,v,_);if(!(x<1e-6)){y/=x,v/=x,_/=x;var T=a[0]-g[0],A=a[1]-g[1],S=a[2]-g[2],w=u(T,A,S);if(!(w<1e-6)){T/=w,A/=w,S/=w;var C=this.computedRight,k=C[0],L=C[1],M=C[2],P=y*k+v*L+_*M,D=u(k-=P*y,L-=P*v,M-=P*_);if(!(D<.01&&(D=u(k=v*S-_*A,L=_*T-y*S,M=y*A-v*T))<1e-6)){k/=D,L/=D,M/=D,this.up.set(n,y,v,_),this.right.set(n,k,L,M),this.center.set(n,g[0],g[1],g[2]),this.radius.set(n,Math.log(w));var N=v*M-_*L,U=_*k-y*M,q=y*L-v*k,X=u(N,U,q),K=y*T+v*A+_*S,Z=k*T+L*A+M*S,H=(N/=X)*T+(U/=X)*A+(q/=X)*S,Y=Math.asin(s(K)),$=Math.atan2(H,Z),z=this.angle._state,j=z[z.length-1],W=z[z.length-2];j%=2*Math.PI;var ee=Math.abs(j+2*Math.PI-$),J=Math.abs(j-$),Q=Math.abs(j-2*Math.PI-$);ee<J&&(j+=2*Math.PI),Q<J&&(j-=2*Math.PI),this.angle.jump(this.angle.lastT(),j,W),this.angle.set(n,$,Y)}}}}},{"filtered-vector":247,"gl-mat4/invert":293,"gl-mat4/rotate":299,"gl-vec3/cross":360,"gl-vec3/dot":365,"gl-vec3/normalize":382}],588:[function(r,O,B){O.exports=function(d,m,p){var e=d*m,f=t*d,u=f-(f-d),s=d-u,l=t*m,o=l-(l-m),i=m-o,c=s*i-(e-u*o-s*o-u*i);return p?(p[0]=c,p[1]=e,p):[c,e]};var t=+(Math.pow(2,27)+1)},{}],589:[function(r,O,B){O.exports=function(t,d,m){var p=t+d,e=p-t,f=d-e,u=t-(p-e);return m?(m[0]=u+f,m[1]=p,m):[u+f,p]}},{}],590:[function(r,O,B){var t=r("../prototype/is");O.exports=function(d){if(typeof d!="function"||!hasOwnProperty.call(d,"length"))return!1;try{if(typeof d.length!="number"||typeof d.call!="function"||typeof d.apply!="function")return!1}catch(m){return!1}return!t(d)}},{"../prototype/is":597}],591:[function(r,O,B){var t=r("../value/is"),d=r("../object/is"),m=r("../string/coerce"),p=r("./to-short-string"),e=function(f,u){return f.replace("%v",p(u))};O.exports=function(f,u,s){if(!d(s))throw new TypeError(e(u,f));if(!t(f)){if("default"in s)return s.default;if(s.isOptional)return null}var l=m(s.errorMessage);throw t(l)||(l=u),new TypeError(e(l,f))}},{"../object/is":594,"../string/coerce":598,"../value/is":600,"./to-short-string":593}],592:[function(r,O,B){O.exports=function(t){try{return t.toString()}catch(d){try{return String(t)}catch(m){return null}}}},{}],593:[function(r,O,B){var t=r("./safe-to-string"),d=/[\n\r\u2028\u2029]/g;O.exports=function(m){var p=t(m);return p===null?"<Non-coercible to string value>":(p.length>100&&(p=p.slice(0,99)+"\u2026"),p=p.replace(d,function(e){switch(e){case`
`:return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}))}},{"./safe-to-string":592}],594:[function(r,O,B){var t=r("../value/is"),d={object:!0,function:!0,undefined:!0};O.exports=function(m){return!!t(m)&&hasOwnProperty.call(d,typeof m)}},{"../value/is":600}],595:[function(r,O,B){var t=r("../lib/resolve-exception"),d=r("./is");O.exports=function(m){return d(m)?m:t(m,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":591,"./is":596}],596:[function(r,O,B){var t=r("../function/is"),d=/^\s*class[\s{/}]/,m=Function.prototype.toString;O.exports=function(p){return!!t(p)&&!d.test(m.call(p))}},{"../function/is":590}],597:[function(r,O,B){var t=r("../object/is");O.exports=function(d){if(!t(d))return!1;try{return!!d.constructor&&d.constructor.prototype===d}catch(m){return!1}}},{"../object/is":594}],598:[function(r,O,B){var t=r("../value/is"),d=r("../object/is"),m=Object.prototype.toString;O.exports=function(p){if(!t(p))return null;if(d(p)){var e=p.toString;if(typeof e!="function"||e===m)return null}try{return""+p}catch(f){return null}}},{"../object/is":594,"../value/is":600}],599:[function(r,O,B){var t=r("../lib/resolve-exception"),d=r("./is");O.exports=function(m){return d(m)?m:t(m,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":591,"./is":600}],600:[function(r,O,B){O.exports=function(t){return t!=null}},{}],601:[function(r,O,B){(function(t){(function(){var d=r("bit-twiddle"),m=r("dup"),p=r("buffer").Buffer;t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:m([32,0]),UINT16:m([32,0]),UINT32:m([32,0]),BIGUINT64:m([32,0]),INT8:m([32,0]),INT16:m([32,0]),INT32:m([32,0]),BIGINT64:m([32,0]),FLOAT:m([32,0]),DOUBLE:m([32,0]),DATA:m([32,0]),UINT8C:m([32,0]),BUFFER:m([32,0])});var e=typeof Uint8ClampedArray!="undefined",f=typeof BigUint64Array!="undefined",u=typeof BigInt64Array!="undefined",s=t.__TYPEDARRAY_POOL;s.UINT8C||(s.UINT8C=m([32,0])),s.BIGUINT64||(s.BIGUINT64=m([32,0])),s.BIGINT64||(s.BIGINT64=m([32,0])),s.BUFFER||(s.BUFFER=m([32,0]));var l=s.DATA,o=s.BUFFER;function i(k){if(k){var L=k.length||k.byteLength,M=d.log2(L);l[M].push(k)}}function c(k){k=d.nextPow2(k);var L=d.log2(k),M=l[L];return M.length>0?M.pop():new ArrayBuffer(k)}function n(k){return new Uint8Array(c(k),0,k)}function a(k){return new Uint16Array(c(2*k),0,k)}function g(k){return new Uint32Array(c(4*k),0,k)}function h(k){return new Int8Array(c(k),0,k)}function y(k){return new Int16Array(c(2*k),0,k)}function v(k){return new Int32Array(c(4*k),0,k)}function _(k){return new Float32Array(c(4*k),0,k)}function x(k){return new Float64Array(c(8*k),0,k)}function T(k){return e?new Uint8ClampedArray(c(k),0,k):n(k)}function A(k){return f?new BigUint64Array(c(8*k),0,k):null}function S(k){return u?new BigInt64Array(c(8*k),0,k):null}function w(k){return new DataView(c(k),0,k)}function C(k){k=d.nextPow2(k);var L=d.log2(k),M=o[L];return M.length>0?M.pop():new p(k)}B.free=function(k){if(p.isBuffer(k))o[d.log2(k.length)].push(k);else{if(Object.prototype.toString.call(k)!=="[object ArrayBuffer]"&&(k=k.buffer),!k)return;var L=k.length||k.byteLength,M=0|d.log2(L);l[M].push(k)}},B.freeUint8=B.freeUint16=B.freeUint32=B.freeBigUint64=B.freeInt8=B.freeInt16=B.freeInt32=B.freeBigInt64=B.freeFloat32=B.freeFloat=B.freeFloat64=B.freeDouble=B.freeUint8Clamped=B.freeDataView=function(k){i(k.buffer)},B.freeArrayBuffer=i,B.freeBuffer=function(k){o[d.log2(k.length)].push(k)},B.malloc=function(k,L){if(L===void 0||L==="arraybuffer")return c(k);switch(L){case"uint8":return n(k);case"uint16":return a(k);case"uint32":return g(k);case"int8":return h(k);case"int16":return y(k);case"int32":return v(k);case"float":case"float32":return _(k);case"double":case"float64":return x(k);case"uint8_clamped":return T(k);case"bigint64":return S(k);case"biguint64":return A(k);case"buffer":return C(k);case"data":case"dataview":return w(k);default:return null}return null},B.mallocArrayBuffer=c,B.mallocUint8=n,B.mallocUint16=a,B.mallocUint32=g,B.mallocInt8=h,B.mallocInt16=y,B.mallocInt32=v,B.mallocFloat32=B.mallocFloat=_,B.mallocFloat64=B.mallocDouble=x,B.mallocUint8Clamped=T,B.mallocBigUint64=A,B.mallocBigInt64=S,B.mallocDataView=w,B.mallocBuffer=C,B.clearCache=function(){for(var k=0;k<32;++k)s.UINT8[k].length=0,s.UINT16[k].length=0,s.UINT32[k].length=0,s.INT8[k].length=0,s.INT16[k].length=0,s.INT32[k].length=0,s.FLOAT[k].length=0,s.DOUBLE[k].length=0,s.BIGUINT64[k].length=0,s.BIGINT64[k].length=0,s.UINT8C[k].length=0,l[k].length=0,o[k].length=0}}).call(this)}).call(this,typeof Xi!="undefined"?Xi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"bit-twiddle":104,buffer:117,dup:182}],602:[function(r,O,B){function t(m){this.roots=new Array(m),this.ranks=new Array(m);for(var p=0;p<m;++p)this.roots[p]=p,this.ranks[p]=0}O.exports=t;var d=t.prototype;Object.defineProperty(d,"length",{get:function(){return this.roots.length}}),d.makeSet=function(){var m=this.roots.length;return this.roots.push(m),this.ranks.push(0),m},d.find=function(m){for(var p=m,e=this.roots;e[m]!==m;)m=e[m];for(;e[p]!==m;){var f=e[p];e[p]=m,p=f}return m},d.link=function(m,p){var e=this.find(m),f=this.find(p);if(e!==f){var u=this.ranks,s=this.roots,l=u[e],o=u[f];l<o?s[e]=f:o<l?s[f]=e:(s[f]=e,++u[e])}}},{}],603:[function(r,O,B){O.exports=function(t,d,m){return t.length===0?t:d?(m||t.sort(d),function(p,e){for(var f=1,u=p.length,s=p[0],l=p[0],o=1;o<u;++o)if(l=s,e(s=p[o],l)){if(o===f){f++;continue}p[f++]=s}return p.length=f,p}(t,d)):(m||t.sort(),function(p){for(var e=1,f=p.length,u=p[0],s=p[0],l=1;l<f;++l,s=u)if(s=u,(u=p[l])!==s){if(l===e){e++;continue}p[e++]=u}return p.length=e,p}(t))}},{}],604:[function(r,O,B){var t=/[\'\"]/;O.exports=function(d){return d?(t.test(d.charAt(0))&&(d=d.substr(1)),t.test(d.charAt(d.length-1))&&(d=d.substr(0,d.length-1)),d):""}},{}],605:[function(r,O,B){O.exports=function(t,d,m){Array.isArray(m)||(m=[].slice.call(arguments,2));for(var p=0,e=m.length;p<e;p++){var f=m[p];for(var u in f)if((d[u]===void 0||Array.isArray(d[u])||t[u]!==d[u])&&u in d){var s;if(f[u]===!0)s=d[u];else if(f[u]===!1||typeof f[u]=="function"&&(s=f[u](d[u],t,d))===void 0)continue;t[u]=s}}return t}},{}],606:[function(r,O,B){(function(t){(function(){function d(m){try{if(!t.localStorage)return!1}catch(e){return!1}var p=t.localStorage[m];return p!=null&&String(p).toLowerCase()==="true"}O.exports=function(m,p){if(d("noDeprecation"))return m;var e=!1;return function(){if(!e){if(d("throwDeprecation"))throw new Error(p);d("traceDeprecation")?console.trace(p):console.warn(p),e=!0}return m.apply(this,arguments)}}}).call(this)}).call(this,typeof Xi!="undefined"?Xi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],607:[function(r,O,B){O.exports=function(p,e){return typeof e=="object"&&e!==null||(e={}),t(p,e.canvas||d,e.context||m,e)};var t=r("./lib/vtext"),d=null,m=null;typeof document!="undefined"&&((d=document.createElement("canvas")).width=8192,d.height=1024,m=d.getContext("2d"))},{"./lib/vtext":608}],608:[function(r,O,B){O.exports=function(i,c,n,a){var g=64,h=1.25,y={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};return a&&(a.size&&a.size>0&&(g=a.size),a.lineSpacing&&a.lineSpacing>0&&(h=a.lineSpacing),a.styletags&&a.styletags.breaklines&&(y.breaklines=!!a.styletags.breaklines),a.styletags&&a.styletags.bolds&&(y.bolds=!!a.styletags.bolds),a.styletags&&a.styletags.italics&&(y.italics=!!a.styletags.italics),a.styletags&&a.styletags.subscripts&&(y.subscripts=!!a.styletags.subscripts),a.styletags&&a.styletags.superscripts&&(y.superscripts=!!a.styletags.superscripts)),n.font=[a.fontStyle,a.fontVariant,a.fontWeight,g+"px",a.font].filter(function(v){return v}).join(" "),n.textAlign="start",n.textBaseline="alphabetic",n.direction="ltr",o(function(v,_,x,T,A,S){x=x.replace(/\n/g,""),x=S.breaklines===!0?x.replace(/\<br\>/g,`
`):x.replace(/\<br\>/g," ");var w="",C=[];for(P=0;P<x.length;++P)C[P]=w;S.bolds===!0&&(C=u("b","b|",x,C)),S.italics===!0&&(C=u("i","i|",x,C)),S.superscripts===!0&&(C=u("sup","+1",x,C)),S.subscripts===!0&&(C=u("sub","-1",x,C));var k=[],L="";for(P=0;P<x.length;++P)C[P]!==null&&(L+=x[P],k.push(C[P]));var M,P,D,N,U,q=L.split(`
`),X=q.length,K=Math.round(A*T),Z=T,H=2*T,Y=0,$=X*K+H;v.height<$&&(v.height=$),_.fillStyle="#000",_.fillRect(0,0,v.width,v.height),_.fillStyle="#fff";var z=0,j="";function W(){if(j!==""){var se=_.measureText(j).width;_.fillText(j,Z+D,H+N),D+=se}}function ee(){return Math.round(U)+"px "}function J(se,de){var ue=""+_.font;if(S.subscripts===!0){var ve=se.indexOf("-"),ke=de.indexOf("-"),Ee=ve>-1?parseInt(se[1+ve]):0,be=ke>-1?parseInt(de[1+ke]):0;Ee!==be&&(ue=ue.replace(ee(),"?px "),U*=Math.pow(.75,be-Ee),ue=ue.replace("?px ",ee())),N+=.25*K*(be-Ee)}if(S.superscripts===!0){var xe=se.indexOf("+"),ce=de.indexOf("+"),ge=xe>-1?parseInt(se[1+xe]):0,we=ce>-1?parseInt(de[1+ce]):0;ge!==we&&(ue=ue.replace(ee(),"?px "),U*=Math.pow(.75,we-ge),ue=ue.replace("?px ",ee())),N-=.25*K*(we-ge)}if(S.bolds===!0){var Me=se.indexOf("b|")>-1,Se=de.indexOf("b|")>-1;!Me&&Se&&(ue=ze?ue.replace("italic ","italic bold "):"bold "+ue),Me&&!Se&&(ue=ue.replace("bold ",""))}if(S.italics===!0){var ze=se.indexOf("i|")>-1,Fe=de.indexOf("i|")>-1;!ze&&Fe&&(ue="italic "+ue),ze&&!Fe&&(ue=ue.replace("italic ",""))}_.font=ue}for(M=0;M<X;++M){var Q=q[M]+`
`;for(D=0,N=M*K,U=T,j="",P=0;P<Q.length;++P){var te=P+z<k.length?k[P+z]:k[k.length-1];w===te?j+=Q[P]:(W(),j=Q[P],te!==void 0&&(J(w,te),w=te))}W(),z+=Q.length;var ie=0|Math.round(D+2*Z);Y<ie&&(Y=ie)}var ae=Y,he=H+K*X;return d(_.getImageData(0,0,ae,he).data,[he,ae,4]).pick(-1,-1,0).transpose(1,0)}(c,n,i,g,h,y),a,g)},O.exports.processPixels=o;var t=r("surface-nets"),d=r("ndarray"),m=r("simplify-planar-graph"),p=r("clean-pslg"),e=r("cdt2d"),f=r("planar-graph-to-polyline");function u(i,c,n,a){for(var g="<"+i+">",h="</"+i+">",y=g.length,v=h.length,_=c[0]==="+"||c[0]==="-",x=0,T=-v;x>-1&&(x=n.indexOf(g,x))!==-1&&(T=n.indexOf(h,x+y))!==-1&&!(T<=x);){for(var A=x;A<T+v;++A)if(A<x+y||A>=T)a[A]=null,n=n.substr(0,A)+" "+n.substr(A+1);else if(a[A]!==null){var S=a[A].indexOf(c[0]);S===-1?a[A]+=c:_&&(a[A]=a[A].substr(0,S+1)+(1+parseInt(a[A][S+1]))+a[A].substr(S+2))}var w=x+y,C=n.substr(w,T-w).indexOf(g);x=C!==-1?C:T+v}return a}function s(i,c){var n=t(i,128);return c?m(n.cells,n.positions,.25):{edges:n.cells,positions:n.positions}}function l(i,c,n,a){var g=s(i,a),h=function(M,P,D){for(var N=P.textAlign||"start",U=P.textBaseline||"alphabetic",q=[1<<30,1<<30],X=[0,0],K=M.length,Z=0;Z<K;++Z)for(var H=M[Z],Y=0;Y<2;++Y)q[Y]=0|Math.min(q[Y],H[Y]),X[Y]=0|Math.max(X[Y],H[Y]);var $=0;switch(N){case"center":$=-.5*(q[0]+X[0]);break;case"right":case"end":$=-X[0];break;case"left":case"start":$=-q[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+N+"'")}var z=0;switch(U){case"hanging":case"top":z=-q[1];break;case"middle":z=-.5*(q[1]+X[1]);break;case"alphabetic":case"ideographic":z=-3*D;break;case"bottom":z=-X[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+U+"'")}var j=1/D;return"lineHeight"in P?j*=+P.lineHeight:"width"in P?j=P.width/(X[0]-q[0]):"height"in P&&(j=P.height/(X[1]-q[1])),M.map(function(W){return[j*(W[0]+$),j*(W[1]+z)]})}(g.positions,c,n),y=g.edges,v=c.orientation==="ccw";if(p(h,y),c.polygons||c.polygon||c.polyline){for(var _=f(y,h),x=new Array(_.length),T=0;T<_.length;++T){for(var A=_[T],S=new Array(A.length),w=0;w<A.length;++w){for(var C=A[w],k=new Array(C.length),L=0;L<C.length;++L)k[L]=h[C[L]].slice();v&&k.reverse(),S[w]=k}x[T]=S}return x}return c.triangles||c.triangulate||c.triangle?{cells:e(h,y,{delaunay:!1,exterior:!1,interior:!0}),positions:h}:{edges:y,positions:h}}function o(i,c,n){try{return l(i,c,n,!0)}catch(a){}try{return l(i,c,n,!1)}catch(a){}return c.polygons||c.polyline||c.polygon?[]:c.triangles||c.triangulate||c.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}},{cdt2d:118,"clean-pslg":127,ndarray:472,"planar-graph-to-polyline":488,"simplify-planar-graph":549,"surface-nets":576}],609:[function(r,O,B){(function(){if(typeof ses=="undefined"||!ses.ok||ses.ok()){typeof ses!="undefined"&&(ses.weakMapPermitHostObjects=g);var t=!1;if(typeof WeakMap=="function"){var d=WeakMap;if(!(typeof navigator!="undefined"&&/Firefox/.test(navigator.userAgent))){var m=new d,p=Object.freeze({});if(m.set(p,1),m.get(p)===1)return void(O.exports=WeakMap);t=!0}}var e=Object.getOwnPropertyNames,f=Object.defineProperty,u=Object.isExtensible,s="weakmap:ident:"+Math.random()+"___";if(typeof crypto!="undefined"&&typeof crypto.getRandomValues=="function"&&typeof ArrayBuffer=="function"&&typeof Uint8Array=="function"){var l=new ArrayBuffer(25),o=new Uint8Array(l);crypto.getRandomValues(o),s="weakmap:rand:"+Array.prototype.map.call(o,function(x){return(x%36).toString(36)}).join("")+"___"}if(f(Object,"getOwnPropertyNames",{value:function(x){return e(x).filter(h)}}),"getPropertyNames"in Object){var i=Object.getPropertyNames;f(Object,"getPropertyNames",{value:function(x){return i(x).filter(h)}})}(function(){var x=Object.freeze;f(Object,"freeze",{value:function(S){return y(S),x(S)}});var T=Object.seal;f(Object,"seal",{value:function(S){return y(S),T(S)}});var A=Object.preventExtensions;f(Object,"preventExtensions",{value:function(S){return y(S),A(S)}})})();var c=!1,n=0,a=function(){this instanceof a||_();var x=[],T=[],A=n++;return Object.create(a.prototype,{get___:{value:v(function(S,w){var C,k=y(S);return k?A in k?k[A]:w:(C=x.indexOf(S))>=0?T[C]:w})},has___:{value:v(function(S){var w=y(S);return w?A in w:x.indexOf(S)>=0})},set___:{value:v(function(S,w){var C,k=y(S);return k?k[A]=w:(C=x.indexOf(S))>=0?T[C]=w:(C=x.length,T[C]=w,x[C]=S),this})},delete___:{value:v(function(S){var w,C,k=y(S);return k?A in k&&delete k[A]:!((w=x.indexOf(S))<0)&&(C=x.length-1,x[w]=void 0,T[w]=T[C],x[w]=x[C],x.length=C,T.length=C,!0)})}})};a.prototype=Object.create(Object.prototype,{get:{value:function(x,T){return this.get___(x,T)},writable:!0,configurable:!0},has:{value:function(x){return this.has___(x)},writable:!0,configurable:!0},set:{value:function(x,T){return this.set___(x,T)},writable:!0,configurable:!0},delete:{value:function(x){return this.delete___(x)},writable:!0,configurable:!0}}),typeof d=="function"?function(){function x(){this instanceof a||_();var T,A=new d,S=void 0,w=!1;return T=t?function(C,k){return A.set(C,k),A.has(C)||(S||(S=new a),S.set(C,k)),this}:function(C,k){if(w)try{A.set(C,k)}catch(L){S||(S=new a),S.set___(C,k)}else A.set(C,k);return this},Object.create(a.prototype,{get___:{value:v(function(C,k){return S?A.has(C)?A.get(C):S.get___(C,k):A.get(C,k)})},has___:{value:v(function(C){return A.has(C)||!!S&&S.has___(C)})},set___:{value:v(T)},delete___:{value:v(function(C){var k=!!A.delete(C);return S&&S.delete___(C)||k})},permitHostObjects___:{value:v(function(C){if(C!==g)throw new Error("bogus call to permitHostObjects___");w=!0})}})}t&&typeof Proxy!="undefined"&&(Proxy=void 0),x.prototype=a.prototype,O.exports=x,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy!="undefined"&&(Proxy=void 0),O.exports=a)}function g(x){x.permitHostObjects___&&x.permitHostObjects___(g)}function h(x){return!(x.substr(0,"weakmap:".length)=="weakmap:"&&x.substr(x.length-3)==="___")}function y(x){if(x!==Object(x))throw new TypeError("Not an object: "+x);var T=x[s];if(T&&T.key===x)return T;if(u(x)){T={key:x};try{return f(x,s,{value:T,writable:!1,enumerable:!1,configurable:!1}),T}catch(A){return}}}function v(x){return x.prototype=null,Object.freeze(x)}function _(){c||typeof console=="undefined"||(c=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}})()},{}],610:[function(r,O,B){var t=r("./hidden-store.js");O.exports=function(){var d={};return function(m){if((typeof m!="object"||m===null)&&typeof m!="function")throw new Error("Weakmap-shim: Key must be object");var p=m.valueOf(d);return p&&p.identity===d?p:t(m,d)}}},{"./hidden-store.js":611}],611:[function(r,O,B){O.exports=function(t,d){var m={identity:d},p=t.valueOf;return Object.defineProperty(t,"valueOf",{value:function(e){return e!==d?p.apply(this,arguments):m},writable:!0}),m}},{}],612:[function(r,O,B){var t=r("./create-store.js");O.exports=function(){var d=t();return{get:function(m,p){var e=d(m);return e.hasOwnProperty("value")?e.value:p},set:function(m,p){return d(m).value=p,this},has:function(m){return"value"in d(m)},delete:function(m){return delete d(m).value}}}},{"./create-store.js":610}],613:[function(r,O,B){var t=r("get-canvas-context");O.exports=function(d){return t("webgl",d)}},{"get-canvas-context":252}],614:[function(r,O,B){var t=r("../main"),d=r("object-assign"),m=t.instance();function p(i){this.local=this.regionalOptions[i||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,d(p.prototype,{name:"Chinese",jdEpoch:17214255e-1,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(i,c){if(typeof i=="string"){var n=i.match(f);return n?n[0]:""}var a=this._validateYear(i),g=i.month(),h=""+this.toChineseMonth(a,g);return c&&h.length<2&&(h="0"+h),this.isIntercalaryMonth(a,g)&&(h+="i"),h},monthNames:function(i){if(typeof i=="string"){var c=i.match(u);return c?c[0]:""}var n=this._validateYear(i),a=i.month(),g=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"][this.toChineseMonth(n,a)-1];return this.isIntercalaryMonth(n,a)&&(g="\u95F0"+g),g},monthNamesShort:function(i){if(typeof i=="string"){var c=i.match(s);return c?c[0]:""}var n=this._validateYear(i),a=i.month(),g=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"][this.toChineseMonth(n,a)-1];return this.isIntercalaryMonth(n,a)&&(g="\u95F0"+g),g},parseMonth:function(i,c){i=this._validateYear(i);var n,a=parseInt(c);if(isNaN(a))c[0]==="\u95F0"&&(n=!0,c=c.substring(1)),c[c.length-1]==="\u6708"&&(c=c.substring(0,c.length-1)),a=1+["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"].indexOf(c);else{var g=c[c.length-1];n=g==="i"||g==="I"}return this.toMonthIndex(i,a,n)},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(i,c){if(i.year&&(i=i.year()),typeof i!="number"||i<1888||i>2111)throw c.replace(/\{0\}/,this.local.name);return i},toMonthIndex:function(i,c,n){var a=this.intercalaryMonth(i);if(n&&c!==a||c<1||c>12)throw t.local.invalidMonth.replace(/\{0\}/,this.local.name);return a?!n&&c<=a?c-1:c:c-1},toChineseMonth:function(i,c){i.year&&(c=(i=i.year()).month());var n=this.intercalaryMonth(i);if(c<0||c>(n?12:11))throw t.local.invalidMonth.replace(/\{0\}/,this.local.name);return n?c<n?c+1:c:c+1},intercalaryMonth:function(i){return i=this._validateYear(i),l[i-l[0]]>>13},isIntercalaryMonth:function(i,c){i.year&&(c=(i=i.year()).month());var n=this.intercalaryMonth(i);return!!n&&n===c},leapYear:function(i){return this.intercalaryMonth(i)!==0},weekOfYear:function(i,c,n){var a,g=this._validateYear(i,t.local.invalidyear),h=o[g-o[0]],y=h>>9&4095,v=h>>5&15,_=31&h;(a=m.newDate(y,v,_)).add(4-(a.dayOfWeek()||7),"d");var x=this.toJD(i,c,n)-a.toJD();return 1+Math.floor(x/7)},monthsInYear:function(i){return this.leapYear(i)?13:12},daysInMonth:function(i,c){i.year&&(c=i.month(),i=i.year()),i=this._validateYear(i);var n=l[i-l[0]];if(c>(n>>13?12:11))throw t.local.invalidMonth.replace(/\{0\}/,this.local.name);return n&1<<12-c?30:29},weekDay:function(i,c,n){return(this.dayOfWeek(i,c,n)||7)<6},toJD:function(i,c,n){var a=this._validate(i,h,n,t.local.invalidDate);i=this._validateYear(a.year()),c=a.month(),n=a.day();var g=this.isIntercalaryMonth(i,c),h=this.toChineseMonth(i,c),y=function(v,_,x,T,A){var S,w,C;if(typeof v=="object")w=v,S=_||{};else{var k;if(!(typeof v=="number"&&v>=1888&&v<=2111))throw new Error("Lunar year outside range 1888-2111");if(!(typeof _=="number"&&_>=1&&_<=12))throw new Error("Lunar month outside range 1 - 12");if(!(typeof x=="number"&&x>=1&&x<=30))throw new Error("Lunar day outside range 1 - 30");typeof T=="object"?(k=!1,S=T):(k=!!T,S=A||{}),w={year:v,month:_,day:x,isIntercalary:k}}C=w.day-1;var L,M=l[w.year-l[0]],P=M>>13;L=P&&(w.month>P||w.isIntercalary)?w.month:w.month-1;for(var D=0;D<L;D++)C+=M&1<<12-D?30:29;var N=o[w.year-o[0]],U=new Date(N>>9&4095,(N>>5&15)-1,(31&N)+C);return S.year=U.getFullYear(),S.month=1+U.getMonth(),S.day=U.getDate(),S}(i,h,n,g);return m.toJD(y.year,y.month,y.day)},fromJD:function(i){var c=m.fromJD(i),n=function(g,h,y,v){var _,x;if(typeof g=="object")_=g,x=h||{};else{if(!(typeof g=="number"&&g>=1888&&g<=2111))throw new Error("Solar year outside range 1888-2111");if(!(typeof h=="number"&&h>=1&&h<=12))throw new Error("Solar month outside range 1 - 12");if(!(typeof y=="number"&&y>=1&&y<=31))throw new Error("Solar day outside range 1 - 31");_={year:g,month:h,day:y},x=v||{}}var T=o[_.year-o[0]],A=_.year<<9|_.month<<5|_.day;x.year=A>=T?_.year:_.year-1,T=o[x.year-o[0]];var S,w=new Date(T>>9&4095,(T>>5&15)-1,31&T),C=new Date(_.year,_.month-1,_.day);S=Math.round((C-w)/864e5);var k,L=l[x.year-l[0]];for(k=0;k<13;k++){var M=L&1<<12-k?30:29;if(S<M)break;S-=M}var P=L>>13;return!P||k<P?(x.isIntercalary=!1,x.month=1+k):k===P?(x.isIntercalary=!0,x.month=k):(x.isIntercalary=!1,x.month=k),x.day=1+S,x}(c.year(),c.month(),c.day()),a=this.toMonthIndex(n.year,n.month,n.isIntercalary);return this.newDate(n.year,a,n.day)},fromString:function(i){var c=i.match(e),n=this._validateYear(+c[1]),a=+c[2],g=!!c[3],h=this.toMonthIndex(n,a,g),y=+c[4];return this.newDate(n,h,y)},add:function(i,c,n){var a=i.year(),g=i.month(),h=this.isIntercalaryMonth(a,g),y=this.toChineseMonth(a,g),v=Object.getPrototypeOf(p.prototype).add.call(this,i,c,n);if(n==="y"){var _=v.year(),x=v.month(),T=this.isIntercalaryMonth(_,y),A=h&&T?this.toMonthIndex(_,y,!0):this.toMonthIndex(_,y,!1);A!==x&&v.month(A)}return v}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,f=/^\d?\d[iI]?/m,u=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?\u6708/m,s=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?/m;t.calendars.chinese=p;var l=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],o=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904]},{"../main":628,"object-assign":476}],615:[function(r,O,B){var t=r("../main"),d=r("object-assign");function m(p){this.local=this.regionalOptions[p||""]||this.regionalOptions[""]}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Coptic",jdEpoch:18250295e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(p){var e=this._validate(p,this.minMonth,this.minDay,t.local.invalidYear);return(p=e.year()+(e.year()<0?1:0))%4==3||p%4==-1},monthsInYear:function(p){return this._validate(p,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear),13},weekOfYear:function(p,e,f){var u=this.newDate(p,e,f);return u.add(-u.dayOfWeek(),"d"),Math.floor((u.dayOfYear()-1)/7)+1},daysInMonth:function(p,e){var f=this._validate(p,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===13&&this.leapYear(f.year())?1:0)},weekDay:function(p,e,f){return(this.dayOfWeek(p,e,f)||7)<6},toJD:function(p,e,f){var u=this._validate(p,e,f,t.local.invalidDate);return(p=u.year())<0&&p++,u.day()+30*(u.month()-1)+365*(p-1)+Math.floor(p/4)+this.jdEpoch-1},fromJD:function(p){var e=Math.floor(p)+.5-this.jdEpoch,f=Math.floor((e-Math.floor((e+366)/1461))/365)+1;f<=0&&f--,e=Math.floor(p)+.5-this.newDate(f,1,1).toJD();var u=Math.floor(e/30)+1,s=e-30*(u-1)+1;return this.newDate(f,u,s)}}),t.calendars.coptic=m},{"../main":628,"object-assign":476}],616:[function(r,O,B){var t=r("../main"),d=r("object-assign");function m(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Discworld",jdEpoch:17214255e-1,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),400},weekOfYear:function(e,f,u){var s=this.newDate(e,f,u);return s.add(-s.dayOfWeek(),"d"),Math.floor((s.dayOfYear()-1)/8)+1},daysInMonth:function(e,f){var u=this._validate(e,f,this.minDay,t.local.invalidMonth);return this.daysPerMonth[u.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,f,u){return(this._validate(e,f,u,t.local.invalidDate).day()+1)%8},weekDay:function(e,f,u){var s=this.dayOfWeek(e,f,u);return s>=2&&s<=6},extraInfo:function(e,f,u){var s=this._validate(e,f,u,t.local.invalidDate);return{century:p[Math.floor((s.year()-1)/100)+1]||""}},toJD:function(e,f,u){var s=this._validate(e,f,u,t.local.invalidDate);return e=s.year()+(s.year()<0?1:0),f=s.month(),(u=s.day())+(f>1?16:0)+(f>2?32*(f-2):0)+400*(e-1)+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var f=Math.floor(e/400)+1;e-=400*(f-1),e+=e>15?16:0;var u=Math.floor(e/32)+1,s=e-32*(u-1)+1;return this.newDate(f<=0?f-1:f,u,s)}});var p={20:"Fruitbat",21:"Anchovy"};t.calendars.discworld=m},{"../main":628,"object-assign":476}],617:[function(r,O,B){var t=r("../main"),d=r("object-assign");function m(p){this.local=this.regionalOptions[p||""]||this.regionalOptions[""]}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Ethiopian",jdEpoch:17242205e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(p){var e=this._validate(p,this.minMonth,this.minDay,t.local.invalidYear);return(p=e.year()+(e.year()<0?1:0))%4==3||p%4==-1},monthsInYear:function(p){return this._validate(p,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear),13},weekOfYear:function(p,e,f){var u=this.newDate(p,e,f);return u.add(-u.dayOfWeek(),"d"),Math.floor((u.dayOfYear()-1)/7)+1},daysInMonth:function(p,e){var f=this._validate(p,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===13&&this.leapYear(f.year())?1:0)},weekDay:function(p,e,f){return(this.dayOfWeek(p,e,f)||7)<6},toJD:function(p,e,f){var u=this._validate(p,e,f,t.local.invalidDate);return(p=u.year())<0&&p++,u.day()+30*(u.month()-1)+365*(p-1)+Math.floor(p/4)+this.jdEpoch-1},fromJD:function(p){var e=Math.floor(p)+.5-this.jdEpoch,f=Math.floor((e-Math.floor((e+366)/1461))/365)+1;f<=0&&f--,e=Math.floor(p)+.5-this.newDate(f,1,1).toJD();var u=Math.floor(e/30)+1,s=e-30*(u-1)+1;return this.newDate(f,u,s)}}),t.calendars.ethiopian=m},{"../main":628,"object-assign":476}],618:[function(r,O,B){var t=r("../main"),d=r("object-assign");function m(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function p(e,f){return e-f*Math.floor(e/f)}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return this._leapYear(f.year())},_leapYear:function(e){return p(7*(e=e<0?e+1:e)+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,f,u){var s=this.newDate(e,f,u);return s.add(-s.dayOfWeek(),"d"),Math.floor((s.dayOfYear()-1)/7)+1},daysInYear:function(e){return e=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear).year(),this.toJD(e===-1?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,f){return e.year&&(f=e.month(),e=e.year()),this._validate(e,f,this.minDay,t.local.invalidMonth),f===12&&this.leapYear(e)||f===8&&p(this.daysInYear(e),10)===5?30:f===9&&p(this.daysInYear(e),10)===3?29:this.daysPerMonth[f-1]},weekDay:function(e,f,u){return this.dayOfWeek(e,f,u)!==6},extraInfo:function(e,f,u){var s=this._validate(e,f,u,t.local.invalidDate);return{yearType:(this.leapYear(s)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(s)%10-3]}},toJD:function(e,f,u){var s=this._validate(e,f,u,t.local.invalidDate);e=s.year(),f=s.month(),u=s.day();var l=e<=0?e+1:e,o=this.jdEpoch+this._delay1(l)+this._delay2(l)+u+1;if(f<7){for(var i=7;i<=this.monthsInYear(e);i++)o+=this.daysInMonth(e,i);for(i=1;i<f;i++)o+=this.daysInMonth(e,i)}else for(i=7;i<f;i++)o+=this.daysInMonth(e,i);return o},_delay1:function(e){var f=Math.floor((235*e-234)/19),u=12084+13753*f,s=29*f+Math.floor(u/25920);return p(3*(s+1),7)<3&&s++,s},_delay2:function(e){var f=this._delay1(e-1),u=this._delay1(e);return this._delay1(e+1)-u==356?2:u-f==382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var f=Math.floor(98496*(e-this.jdEpoch)/35975351)-1;e>=this.toJD(f===-1?1:f+1,7,1);)f++;for(var u=e<this.toJD(f,1,1)?7:1;e>this.toJD(f,u,this.daysInMonth(f,u));)u++;var s=e-this.toJD(f,u,1)+1;return this.newDate(f,u,s)}}),t.calendars.hebrew=m},{"../main":628,"object-assign":476}],619:[function(r,O,B){var t=r("../main"),d=r("object-assign");function m(p){this.local=this.regionalOptions[p||""]||this.regionalOptions[""]}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Islamic",jdEpoch:19484395e-1,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012Bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(p){return(11*this._validate(p,this.minMonth,this.minDay,t.local.invalidYear).year()+14)%30<11},weekOfYear:function(p,e,f){var u=this.newDate(p,e,f);return u.add(-u.dayOfWeek(),"d"),Math.floor((u.dayOfYear()-1)/7)+1},daysInYear:function(p){return this.leapYear(p)?355:354},daysInMonth:function(p,e){var f=this._validate(p,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===12&&this.leapYear(f.year())?1:0)},weekDay:function(p,e,f){return this.dayOfWeek(p,e,f)!==5},toJD:function(p,e,f){var u=this._validate(p,e,f,t.local.invalidDate);return p=u.year(),e=u.month(),p=p<=0?p+1:p,(f=u.day())+Math.ceil(29.5*(e-1))+354*(p-1)+Math.floor((3+11*p)/30)+this.jdEpoch-1},fromJD:function(p){p=Math.floor(p)+.5;var e=Math.floor((30*(p-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var f=Math.min(12,Math.ceil((p-29-this.toJD(e,1,1))/29.5)+1),u=p-this.toJD(e,f,1)+1;return this.newDate(e,f,u)}}),t.calendars.islamic=m},{"../main":628,"object-assign":476}],620:[function(r,O,B){var t=r("../main"),d=r("object-assign");function m(p){this.local=this.regionalOptions[p||""]||this.regionalOptions[""]}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Julian",jdEpoch:17214235e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(p){var e=this._validate(p,this.minMonth,this.minDay,t.local.invalidYear);return(p=e.year()<0?e.year()+1:e.year())%4==0},weekOfYear:function(p,e,f){var u=this.newDate(p,e,f);return u.add(4-(u.dayOfWeek()||7),"d"),Math.floor((u.dayOfYear()-1)/7)+1},daysInMonth:function(p,e){var f=this._validate(p,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===2&&this.leapYear(f.year())?1:0)},weekDay:function(p,e,f){return(this.dayOfWeek(p,e,f)||7)<6},toJD:function(p,e,f){var u=this._validate(p,e,f,t.local.invalidDate);return p=u.year(),e=u.month(),f=u.day(),p<0&&p++,e<=2&&(p--,e+=12),Math.floor(365.25*(p+4716))+Math.floor(30.6001*(e+1))+f-1524.5},fromJD:function(p){var e=Math.floor(p+.5)+1524,f=Math.floor((e-122.1)/365.25),u=Math.floor(365.25*f),s=Math.floor((e-u)/30.6001),l=s-Math.floor(s<14?1:13),o=f-Math.floor(l>2?4716:4715),i=e-u-Math.floor(30.6001*s);return o<=0&&o--,this.newDate(o,l,i)}}),t.calendars.julian=m},{"../main":628,"object-assign":476}],621:[function(r,O,B){var t=r("../main"),d=r("object-assign");function m(f){this.local=this.regionalOptions[f||""]||this.regionalOptions[""]}function p(f,u){return f-u*Math.floor(f/u)}function e(f,u){return p(f-1,u)+1}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(f){return this._validate(f,this.minMonth,this.minDay,t.local.invalidYear),!1},formatYear:function(f){f=this._validate(f,this.minMonth,this.minDay,t.local.invalidYear).year();var u=Math.floor(f/400);return f%=400,f+=f<0?400:0,u+"."+Math.floor(f/20)+"."+f%20},forYear:function(f){if((f=f.split(".")).length<3)throw"Invalid Mayan year";for(var u=0,s=0;s<f.length;s++){var l=parseInt(f[s],10);if(Math.abs(l)>19||s>0&&l<0)throw"Invalid Mayan year";u=20*u+l}return u},monthsInYear:function(f){return this._validate(f,this.minMonth,this.minDay,t.local.invalidYear),18},weekOfYear:function(f,u,s){return this._validate(f,u,s,t.local.invalidDate),0},daysInYear:function(f){return this._validate(f,this.minMonth,this.minDay,t.local.invalidYear),360},daysInMonth:function(f,u){return this._validate(f,u,this.minDay,t.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(f,u,s){return this._validate(f,u,s,t.local.invalidDate).day()},weekDay:function(f,u,s){return this._validate(f,u,s,t.local.invalidDate),!0},extraInfo:function(f,u,s){var l=this._validate(f,u,s,t.local.invalidDate).toJD(),o=this._toHaab(l),i=this._toTzolkin(l);return{haabMonthName:this.local.haabMonths[o[0]-1],haabMonth:o[0],haabDay:o[1],tzolkinDayName:this.local.tzolkinMonths[i[0]-1],tzolkinDay:i[0],tzolkinTrecena:i[1]}},_toHaab:function(f){var u=p((f-=this.jdEpoch)+8+340,365);return[Math.floor(u/20)+1,p(u,20)]},_toTzolkin:function(f){return[e((f-=this.jdEpoch)+20,20),e(f+4,13)]},toJD:function(f,u,s){var l=this._validate(f,u,s,t.local.invalidDate);return l.day()+20*l.month()+360*l.year()+this.jdEpoch},fromJD:function(f){f=Math.floor(f)+.5-this.jdEpoch;var u=Math.floor(f/360);f%=360,f+=f<0?360:0;var s=Math.floor(f/20),l=f%20;return this.newDate(u,s,l)}}),t.calendars.mayan=m},{"../main":628,"object-assign":476}],622:[function(r,O,B){var t=r("../main"),d=r("object-assign");function m(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}m.prototype=new t.baseCalendar;var p=t.instance("gregorian");d(m.prototype,{name:"Nanakshahi",jdEpoch:22576735e-1,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear);return p.leapYear(f.year()+(f.year()<1?1:0)+1469)},weekOfYear:function(e,f,u){var s=this.newDate(e,f,u);return s.add(1-(s.dayOfWeek()||7),"d"),Math.floor((s.dayOfYear()-1)/7)+1},daysInMonth:function(e,f){var u=this._validate(e,f,this.minDay,t.local.invalidMonth);return this.daysPerMonth[u.month()-1]+(u.month()===12&&this.leapYear(u.year())?1:0)},weekDay:function(e,f,u){return(this.dayOfWeek(e,f,u)||7)<6},toJD:function(e,f,u){var s=this._validate(e,f,u,t.local.invalidMonth);(e=s.year())<0&&e++;for(var l=s.day(),o=1;o<s.month();o++)l+=this.daysPerMonth[o-1];return l+p.toJD(e+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var f=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(f+1,1,1);)f++;for(var u=e-Math.floor(this.toJD(f,1,1)+.5)+1,s=1;u>this.daysInMonth(f,s);)u-=this.daysInMonth(f,s),s++;return this.newDate(f,s,u)}}),t.calendars.nanakshahi=m},{"../main":628,"object-assign":476}],623:[function(r,O,B){var t=r("../main"),d=r("object-assign");function m(p){this.local=this.regionalOptions[p||""]||this.regionalOptions[""]}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Nepali",jdEpoch:17007095e-1,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(p){return this.daysInYear(p)!==this.daysPerYear},weekOfYear:function(p,e,f){var u=this.newDate(p,e,f);return u.add(-u.dayOfWeek(),"d"),Math.floor((u.dayOfYear()-1)/7)+1},daysInYear:function(p){if(p=this._validate(p,this.minMonth,this.minDay,t.local.invalidYear).year(),this.NEPALI_CALENDAR_DATA[p]===void 0)return this.daysPerYear;for(var e=0,f=this.minMonth;f<=12;f++)e+=this.NEPALI_CALENDAR_DATA[p][f];return e},daysInMonth:function(p,e){return p.year&&(e=p.month(),p=p.year()),this._validate(p,e,this.minDay,t.local.invalidMonth),this.NEPALI_CALENDAR_DATA[p]===void 0?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[p][e]},weekDay:function(p,e,f){return this.dayOfWeek(p,e,f)!==6},toJD:function(p,e,f){var u=this._validate(p,e,f,t.local.invalidDate);p=u.year(),e=u.month(),f=u.day();var s=t.instance(),l=0,o=e,i=p;this._createMissingCalendarData(p);var c=p-(o>9||o===9&&f>=this.NEPALI_CALENDAR_DATA[i][0]?56:57);for(e!==9&&(l=f,o--);o!==9;)o<=0&&(o=12,i--),l+=this.NEPALI_CALENDAR_DATA[i][o],o--;return e===9?(l+=f-this.NEPALI_CALENDAR_DATA[i][0])<0&&(l+=s.daysInYear(c)):l+=this.NEPALI_CALENDAR_DATA[i][9]-this.NEPALI_CALENDAR_DATA[i][0],s.newDate(c,1,1).add(l,"d").toJD()},fromJD:function(p){var e=t.instance().fromJD(p),f=e.year(),u=e.dayOfYear(),s=f+56;this._createMissingCalendarData(s);for(var l=9,o=this.NEPALI_CALENDAR_DATA[s][0],i=this.NEPALI_CALENDAR_DATA[s][l]-o+1;u>i;)++l>12&&(l=1,s++),i+=this.NEPALI_CALENDAR_DATA[s][l];var c=this.NEPALI_CALENDAR_DATA[s][l]-(i-u);return this.newDate(s,l,c)},_createMissingCalendarData:function(p){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var f=p-1;f<p+2;f++)this.NEPALI_CALENDAR_DATA[f]===void 0&&(this.NEPALI_CALENDAR_DATA[f]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),t.calendars.nepali=m},{"../main":628,"object-assign":476}],624:[function(r,O,B){var t=r("../main"),d=r("object-assign");function m(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function p(e,f){return e-f*Math.floor(e/f)}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Persian",jdEpoch:19483205e-1,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xE6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xE6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return 682*((f.year()-(f.year()>0?474:473))%2820+474+38)%2816<682},weekOfYear:function(e,f,u){var s=this.newDate(e,f,u);return s.add(-(s.dayOfWeek()+1)%7,"d"),Math.floor((s.dayOfYear()-1)/7)+1},daysInMonth:function(e,f){var u=this._validate(e,f,this.minDay,t.local.invalidMonth);return this.daysPerMonth[u.month()-1]+(u.month()===12&&this.leapYear(u.year())?1:0)},weekDay:function(e,f,u){return this.dayOfWeek(e,f,u)!==5},toJD:function(e,f,u){var s=this._validate(e,f,u,t.local.invalidDate);e=s.year(),f=s.month(),u=s.day();var l=e-(e>=0?474:473),o=474+p(l,2820);return u+(f<=7?31*(f-1):30*(f-1)+6)+Math.floor((682*o-110)/2816)+365*(o-1)+1029983*Math.floor(l/2820)+this.jdEpoch-1},fromJD:function(e){var f=(e=Math.floor(e)+.5)-this.toJD(475,1,1),u=Math.floor(f/1029983),s=p(f,1029983),l=2820;if(s!==1029982){var o=Math.floor(s/366),i=p(s,366);l=Math.floor((2134*o+2816*i+2815)/1028522)+o+1}var c=l+2820*u+474;c=c<=0?c-1:c;var n=e-this.toJD(c,1,1)+1,a=n<=186?Math.ceil(n/31):Math.ceil((n-6)/30),g=e-this.toJD(c,a,1)+1;return this.newDate(c,a,g)}}),t.calendars.persian=m,t.calendars.jalali=m},{"../main":628,"object-assign":476}],625:[function(r,O,B){var t=r("../main"),d=r("object-assign"),m=t.instance();function p(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,d(p.prototype,{name:"Taiwan",jdEpoch:24194025e-1,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(f.year()),m.leapYear(e)},weekOfYear:function(e,f,u){var s=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(s.year()),m.weekOfYear(e,s.month(),s.day())},daysInMonth:function(e,f){var u=this._validate(e,f,this.minDay,t.local.invalidMonth);return this.daysPerMonth[u.month()-1]+(u.month()===2&&this.leapYear(u.year())?1:0)},weekDay:function(e,f,u){return(this.dayOfWeek(e,f,u)||7)<6},toJD:function(e,f,u){var s=this._validate(e,f,u,t.local.invalidDate);return e=this._t2gYear(s.year()),m.toJD(e,s.month(),s.day())},fromJD:function(e){var f=m.fromJD(e),u=this._g2tYear(f.year());return this.newDate(u,f.month(),f.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),t.calendars.taiwan=p},{"../main":628,"object-assign":476}],626:[function(r,O,B){var t=r("../main"),d=r("object-assign"),m=t.instance();function p(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,d(p.prototype,{name:"Thai",jdEpoch:15230985e-1,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(f.year()),m.leapYear(e)},weekOfYear:function(e,f,u){var s=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(s.year()),m.weekOfYear(e,s.month(),s.day())},daysInMonth:function(e,f){var u=this._validate(e,f,this.minDay,t.local.invalidMonth);return this.daysPerMonth[u.month()-1]+(u.month()===2&&this.leapYear(u.year())?1:0)},weekDay:function(e,f,u){return(this.dayOfWeek(e,f,u)||7)<6},toJD:function(e,f,u){var s=this._validate(e,f,u,t.local.invalidDate);return e=this._t2gYear(s.year()),m.toJD(e,s.month(),s.day())},fromJD:function(e){var f=m.fromJD(e),u=this._g2tYear(f.year());return this.newDate(u,f.month(),f.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),t.calendars.thai=p},{"../main":628,"object-assign":476}],627:[function(r,O,B){var t=r("../main"),d=r("object-assign");function m(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}m.prototype=new t.baseCalendar,d(m.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012Bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return this.daysInYear(f.year())===355},weekOfYear:function(e,f,u){var s=this.newDate(e,f,u);return s.add(-s.dayOfWeek(),"d"),Math.floor((s.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var f=0,u=1;u<=12;u++)f+=this.daysInMonth(e,u);return f},daysInMonth:function(e,f){for(var u=this._validate(e,f,this.minDay,t.local.invalidMonth).toJD()-24e5+.5,s=0,l=0;l<p.length;l++){if(p[l]>u)return p[s]-p[s-1];s++}return 30},weekDay:function(e,f,u){return this.dayOfWeek(e,f,u)!==5},toJD:function(e,f,u){var s=this._validate(e,f,u,t.local.invalidDate),l=12*(s.year()-1)+s.month()-15292;return s.day()+p[l-1]-1+24e5-.5},fromJD:function(e){for(var f=e-24e5+.5,u=0,s=0;s<p.length&&!(p[s]>f);s++)u++;var l=u+15292,o=Math.floor((l-1)/12),i=o+1,c=l-12*o,n=f-p[u-1]+1;return this.newDate(i,c,n)},isValid:function(e,f,u){var s=t.baseCalendar.prototype.isValid.apply(this,arguments);return s&&(s=(e=e.year!=null?e.year:e)>=1276&&e<=1500),s},_validate:function(e,f,u,s){var l=t.baseCalendar.prototype._validate.apply(this,arguments);if(l.year<1276||l.year>1500)throw s.replace(/\{0\}/,this.local.name);return l}}),t.calendars.ummalqura=m;var p=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":628,"object-assign":476}],628:[function(r,O,B){var t=r("object-assign");function d(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function m(s,l,o,i){if(this._calendar=s,this._year=l,this._month=o,this._day=i,this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day))throw(u.local.invalidDate||u.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function p(s,l){return"000000".substring(0,l-(s=""+s).length)+s}function e(){this.shortYearCutoff="+10"}function f(s){this.local=this.regionalOptions[s]||this.regionalOptions[""]}t(d.prototype,{instance:function(s,l){s=(s||"gregorian").toLowerCase(),l=l||"";var o=this._localCals[s+"-"+l];if(!o&&this.calendars[s]&&(o=new this.calendars[s](l),this._localCals[s+"-"+l]=o),!o)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,s);return o},newDate:function(s,l,o,i,c){return(i=(s!=null&&s.year?s.calendar():typeof i=="string"?this.instance(i,c):i)||this.instance()).newDate(s,l,o)},substituteDigits:function(s){return function(l){return(l+"").replace(/[0-9]/g,function(o){return s[o]})}},substituteChineseDigits:function(s,l){return function(o){for(var i="",c=0;o>0;){var n=o%10;i=(n===0?"":s[n]+l[c])+i,c++,o=Math.floor(o/10)}return i.indexOf(s[1]+l[1])===0&&(i=i.substr(1)),i||s[0]}}}),t(m.prototype,{newDate:function(s,l,o){return this._calendar.newDate(s==null?this:s,l,o)},year:function(s){return arguments.length===0?this._year:this.set(s,"y")},month:function(s){return arguments.length===0?this._month:this.set(s,"m")},day:function(s){return arguments.length===0?this._day:this.set(s,"d")},date:function(s,l,o){if(!this._calendar.isValid(s,l,o))throw(u.local.invalidDate||u.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=s,this._month=l,this._day=o,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(s,l){return this._calendar.add(this,s,l)},set:function(s,l){return this._calendar.set(this,s,l)},compareTo:function(s){if(this._calendar.name!==s._calendar.name)throw(u.local.differentCalendars||u.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,s._calendar.local.name);var l=this._year!==s._year?this._year-s._year:this._month!==s._month?this.monthOfYear()-s.monthOfYear():this._day-s._day;return l===0?0:l<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(s){return this._calendar.fromJD(s)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(s){return this._calendar.fromJSDate(s)},toString:function(){return(this.year()<0?"-":"")+p(Math.abs(this.year()),4)+"-"+p(this.month(),2)+"-"+p(this.day(),2)}}),t(e.prototype,{_validateLevel:0,newDate:function(s,l,o){return s==null?this.today():(s.year&&(this._validate(s,l,o,u.local.invalidDate||u.regionalOptions[""].invalidDate),o=s.day(),l=s.month(),s=s.year()),new m(this,s,l,o))},today:function(){return this.fromJSDate(new Date)},epoch:function(s){return this._validate(s,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear).year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(s){var l=this._validate(s,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return(l.year()<0?"-":"")+p(Math.abs(l.year()),4)},monthsInYear:function(s){return this._validate(s,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear),12},monthOfYear:function(s,l){var o=this._validate(s,l,this.minDay,u.local.invalidMonth||u.regionalOptions[""].invalidMonth);return(o.month()+this.monthsInYear(o)-this.firstMonth)%this.monthsInYear(o)+this.minMonth},fromMonthOfYear:function(s,l){var o=(l+this.firstMonth-2*this.minMonth)%this.monthsInYear(s)+this.minMonth;return this._validate(s,o,this.minDay,u.local.invalidMonth||u.regionalOptions[""].invalidMonth),o},daysInYear:function(s){var l=this._validate(s,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return this.leapYear(l)?366:365},dayOfYear:function(s,l,o){var i=this._validate(s,l,o,u.local.invalidDate||u.regionalOptions[""].invalidDate);return i.toJD()-this.newDate(i.year(),this.fromMonthOfYear(i.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(s,l,o){var i=this._validate(s,l,o,u.local.invalidDate||u.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(i))+2)%this.daysInWeek()},extraInfo:function(s,l,o){return this._validate(s,l,o,u.local.invalidDate||u.regionalOptions[""].invalidDate),{}},add:function(s,l,o){return this._validate(s,this.minMonth,this.minDay,u.local.invalidDate||u.regionalOptions[""].invalidDate),this._correctAdd(s,this._add(s,l,o),l,o)},_add:function(s,l,o){if(this._validateLevel++,o==="d"||o==="w"){var i=s.toJD()+l*(o==="w"?this.daysInWeek():1),c=s.calendar().fromJD(i);return this._validateLevel--,[c.year(),c.month(),c.day()]}try{var n=s.year()+(o==="y"?l:0),a=s.monthOfYear()+(o==="m"?l:0);c=s.day(),o==="y"?(s.month()!==this.fromMonthOfYear(n,a)&&(a=this.newDate(n,s.month(),this.minDay).monthOfYear()),a=Math.min(a,this.monthsInYear(n)),c=Math.min(c,this.daysInMonth(n,this.fromMonthOfYear(n,a)))):o==="m"&&(function(h){for(;a<h.minMonth;)n--,a+=h.monthsInYear(n);for(var y=h.monthsInYear(n);a>y-1+h.minMonth;)n++,a-=y,y=h.monthsInYear(n)}(this),c=Math.min(c,this.daysInMonth(n,this.fromMonthOfYear(n,a))));var g=[n,this.fromMonthOfYear(n,a),c];return this._validateLevel--,g}catch(h){throw this._validateLevel--,h}},_correctAdd:function(s,l,o,i){if(!(this.hasYearZero||i!=="y"&&i!=="m"||l[0]!==0&&s.year()>0==l[0]>0)){var c={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[i],n=o<0?-1:1;l=this._add(s,o*c[0]+n*c[1],c[2])}return s.date(l[0],l[1],l[2])},set:function(s,l,o){this._validate(s,this.minMonth,this.minDay,u.local.invalidDate||u.regionalOptions[""].invalidDate);var i=o==="y"?l:s.year(),c=o==="m"?l:s.month(),n=o==="d"?l:s.day();return o!=="y"&&o!=="m"||(n=Math.min(n,this.daysInMonth(i,c))),s.date(i,c,n)},isValid:function(s,l,o){this._validateLevel++;var i=this.hasYearZero||s!==0;if(i){var c=this.newDate(s,l,this.minDay);i=l>=this.minMonth&&l-this.minMonth<this.monthsInYear(c)&&o>=this.minDay&&o-this.minDay<this.daysInMonth(c)}return this._validateLevel--,i},toJSDate:function(s,l,o){var i=this._validate(s,l,o,u.local.invalidDate||u.regionalOptions[""].invalidDate);return u.instance().fromJD(this.toJD(i)).toJSDate()},fromJSDate:function(s){return this.fromJD(u.instance().fromJSDate(s).toJD())},_validate:function(s,l,o,i){if(s.year){if(this._validateLevel===0&&this.name!==s.calendar().name)throw(u.local.differentCalendars||u.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,s.calendar().local.name);return s}try{if(this._validateLevel++,this._validateLevel===1&&!this.isValid(s,l,o))throw i.replace(/\{0\}/,this.local.name);var c=this.newDate(s,l,o);return this._validateLevel--,c}catch(n){throw this._validateLevel--,n}}}),f.prototype=new e,t(f.prototype,{name:"Gregorian",jdEpoch:17214255e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(s){var l=this._validate(s,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return(s=l.year()+(l.year()<0?1:0))%4==0&&(s%100!=0||s%400==0)},weekOfYear:function(s,l,o){var i=this.newDate(s,l,o);return i.add(4-(i.dayOfWeek()||7),"d"),Math.floor((i.dayOfYear()-1)/7)+1},daysInMonth:function(s,l){var o=this._validate(s,l,this.minDay,u.local.invalidMonth||u.regionalOptions[""].invalidMonth);return this.daysPerMonth[o.month()-1]+(o.month()===2&&this.leapYear(o.year())?1:0)},weekDay:function(s,l,o){return(this.dayOfWeek(s,l,o)||7)<6},toJD:function(s,l,o){var i=this._validate(s,l,o,u.local.invalidDate||u.regionalOptions[""].invalidDate);s=i.year(),l=i.month(),o=i.day(),s<0&&s++,l<3&&(l+=12,s--);var c=Math.floor(s/100),n=2-c+Math.floor(c/4);return Math.floor(365.25*(s+4716))+Math.floor(30.6001*(l+1))+o+n-1524.5},fromJD:function(s){var l=Math.floor(s+.5),o=Math.floor((l-186721625e-2)/36524.25),i=(o=l+1+o-Math.floor(o/4))+1524,c=Math.floor((i-122.1)/365.25),n=Math.floor(365.25*c),a=Math.floor((i-n)/30.6001),g=i-n-Math.floor(30.6001*a),h=a-(a>13.5?13:1),y=c-(h>2.5?4716:4715);return y<=0&&y--,this.newDate(y,h,g)},toJSDate:function(s,l,o){var i=this._validate(s,l,o,u.local.invalidDate||u.regionalOptions[""].invalidDate),c=new Date(i.year(),i.month()-1,i.day());return c.setHours(0),c.setMinutes(0),c.setSeconds(0),c.setMilliseconds(0),c.setHours(c.getHours()>12?c.getHours()+2:0),c},fromJSDate:function(s){return this.newDate(s.getFullYear(),s.getMonth()+1,s.getDate())}});var u=O.exports=new d;u.cdate=m,u.baseCalendar=e,u.calendars.gregorian=f},{"object-assign":476}],629:[function(r,O,B){var t=r("object-assign"),d=r("./main");t(d.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),d.local=d.regionalOptions[""],t(d.cdate.prototype,{formatDate:function(m,p){return typeof m!="string"&&(p=m,m=""),this._calendar.formatDate(m||"",this,p)}}),t(d.baseCalendar.prototype,{UNIX_EPOCH:d.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:d.instance().jdEpoch,TICKS_PER_DAY:864e9,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(m,p,e){if(typeof m!="string"&&(e=p,p=m,m=""),!p)return"";if(p.calendar()!==this)throw d.local.invalidFormat||d.regionalOptions[""].invalidFormat;m=m||this.local.dateFormat;for(var f,u,s,l,o=(e=e||{}).dayNamesShort||this.local.dayNamesShort,i=e.dayNames||this.local.dayNames,c=e.monthNumbers||this.local.monthNumbers,n=e.monthNamesShort||this.local.monthNamesShort,a=e.monthNames||this.local.monthNames,g=(e.calculateWeek||this.local.calculateWeek,function(C,k){for(var L=1;w+L<m.length&&m.charAt(w+L)===C;)L++;return w+=L-1,Math.floor(L/(k||1))>1}),h=function(C,k,L,M){var P=""+k;if(g(C,M))for(;P.length<L;)P="0"+P;return P},y=this,v=function(C){return typeof c=="function"?c.call(y,C,g("m")):T(h("m",C.month(),2))},_=function(C,k){return k?typeof a=="function"?a.call(y,C):a[C.month()-y.minMonth]:typeof n=="function"?n.call(y,C):n[C.month()-y.minMonth]},x=this.local.digits,T=function(C){return e.localNumbers&&x?x(C):C},A="",S=!1,w=0;w<m.length;w++)if(S)m.charAt(w)!=="'"||g("'")?A+=m.charAt(w):S=!1;else switch(m.charAt(w)){case"d":A+=T(h("d",p.day(),2));break;case"D":A+=(f="D",u=p.dayOfWeek(),s=o,l=i,g(f)?l[u]:s[u]);break;case"o":A+=h("o",p.dayOfYear(),3);break;case"w":A+=h("w",p.weekOfYear(),2);break;case"m":A+=v(p);break;case"M":A+=_(p,g("M"));break;case"y":A+=g("y",2)?p.year():(p.year()%100<10?"0":"")+p.year()%100;break;case"Y":g("Y",2),A+=p.formatYear();break;case"J":A+=p.toJD();break;case"@":A+=(p.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":A+=(p.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":g("'")?A+="'":S=!0;break;default:A+=m.charAt(w)}return A},parseDate:function(m,p,e){if(p==null)throw d.local.invalidArguments||d.regionalOptions[""].invalidArguments;if((p=typeof p=="object"?p.toString():p+"")==="")return null;m=m||this.local.dateFormat;var f=(e=e||{}).shortYearCutoff||this.shortYearCutoff;f=typeof f!="string"?f:this.today().year()%100+parseInt(f,10);for(var u=e.dayNamesShort||this.local.dayNamesShort,s=e.dayNames||this.local.dayNames,l=e.parseMonth||this.local.parseMonth,o=e.monthNumbers||this.local.monthNumbers,i=e.monthNamesShort||this.local.monthNamesShort,c=e.monthNames||this.local.monthNames,n=-1,a=-1,g=-1,h=-1,y=-1,v=!1,_=!1,x=function(N,U){for(var q=1;M+q<m.length&&m.charAt(M+q)===N;)q++;return M+=q-1,Math.floor(q/(U||1))>1},T=function(N,U){var q=x(N,U),X=[2,3,q?4:2,q?4:2,10,11,20]["oyYJ@!".indexOf(N)+1],K=new RegExp("^-?\\d{1,"+X+"}"),Z=p.substring(L).match(K);if(!Z)throw(d.local.missingNumberAt||d.regionalOptions[""].missingNumberAt).replace(/\{0\}/,L);return L+=Z[0].length,parseInt(Z[0],10)},A=this,S=function(){if(typeof o=="function"){x("m");var N=o.call(A,p.substring(L));return L+=N.length,N}return T("m")},w=function(N,U,q,X){for(var K=x(N,X)?q:U,Z=0;Z<K.length;Z++)if(p.substr(L,K[Z].length).toLowerCase()===K[Z].toLowerCase())return L+=K[Z].length,Z+A.minMonth;throw(d.local.unknownNameAt||d.regionalOptions[""].unknownNameAt).replace(/\{0\}/,L)},C=function(){if(typeof c=="function"){var N=x("M")?c.call(A,p.substring(L)):i.call(A,p.substring(L));return L+=N.length,N}return w("M",i,c)},k=function(){if(p.charAt(L)!==m.charAt(M))throw(d.local.unexpectedLiteralAt||d.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,L);L++},L=0,M=0;M<m.length;M++)if(_)m.charAt(M)!=="'"||x("'")?k():_=!1;else switch(m.charAt(M)){case"d":h=T("d");break;case"D":w("D",u,s);break;case"o":y=T("o");break;case"w":T("w");break;case"m":g=S();break;case"M":g=C();break;case"y":var P=M;v=!x("y",2),M=P,a=T("y",2);break;case"Y":a=T("Y",2);break;case"J":n=T("J")+.5,p.charAt(L)==="."&&(L++,T("J"));break;case"@":n=T("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":n=T("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":L=p.length;break;case"'":x("'")?k():_=!0;break;default:k()}if(L<p.length)throw d.local.unexpectedText||d.regionalOptions[""].unexpectedText;if(a===-1?a=this.today().year():a<100&&v&&(a+=f===-1?1900:this.today().year()-this.today().year()%100-(a<=f?0:100)),typeof g=="string"&&(g=l.call(this,a,g)),y>-1){g=1,h=y;for(var D=this.daysInMonth(a,g);h>D;D=this.daysInMonth(a,g))g++,h-=D}return n>-1?this.fromJD(n):this.newDate(a,g,h)},determineDate:function(m,p,e,f,u){e&&typeof e!="object"&&(u=f,f=e,e=null),typeof f!="string"&&(u=f,f="");var s=this;return p=p?p.newDate():null,m=m==null?p:typeof m=="string"?function(l){try{return s.parseDate(f,l,u)}catch(n){}for(var o=((l=l.toLowerCase()).match(/^c/)&&e?e.newDate():null)||s.today(),i=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,c=i.exec(l);c;)o.add(parseInt(c[1],10),c[2]||"d"),c=i.exec(l);return o}(m):typeof m=="number"?isNaN(m)||m===1/0||m===-1/0?p:s.today().add(m,"d"):s.newDate(m)}})},{"./main":628,"object-assign":476}],630:[function(r,O,B){var t,d=function(){return function(m,p,e,f,u,s){var l=m[0],o=e[0],i=[0],c=o;f|=0;var n=0,a=o;for(n=0;n<l;++n){var g=p[f]-s,h=p[f+c]-s;g>=0!=h>=0&&u.push(i[0]+.5+.5*(g+h)/(g-h)),f+=a,++i[0]}}};O.exports=(t={funcName:"zeroCrossings"},function(m){var p={};return function(e,f,u){var s=e.dtype,l=e.order,o=[s,l.join()].join(),i=p[o];return i||(p[o]=i=m([s,l])),i(e.shape.slice(0),e.data,e.stride,0|e.offset,f,u)}}(d.bind(void 0,t)))},{}],631:[function(r,O,B){O.exports=function(d,m){var p=[];return m=+m||0,t(d.hi(d.shape[0]-1),p,m),p};var t=r("./lib/zc-core")},{"./lib/zc-core":630}],632:[function(r,O,B){O.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],633:[function(r,O,B){var t=r("./arrow_paths"),d=r("../../plots/font_attributes"),m=r("../../plots/cartesian/constants"),p=r("../../plot_api/plot_template").templatedArray;r("../../constants/axis_placeable_objects"),O.exports=p("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:d({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:t.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:t.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",m.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",m.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",m.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",m.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:d({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":756,"../../plot_api/plot_template":827,"../../plots/cartesian/constants":845,"../../plots/font_attributes":867,"./arrow_paths":632}],634:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("./draw").draw;function p(f){var u=f._fullLayout;t.filterVisible(u.annotations).forEach(function(s){var l=d.getFromId(f,s.xref),o=d.getFromId(f,s.yref),i=d.getRefType(s.xref),c=d.getRefType(s.yref);s._extremes={},i==="range"&&e(s,l),c==="range"&&e(s,o)})}function e(f,u){var s,l=u._id,o=l.charAt(0),i=f[o],c=f["a"+o],n=f[o+"ref"],a=f["a"+o+"ref"],g=f["_"+o+"padplus"],h=f["_"+o+"padminus"],y={x:1,y:-1}[o]*f[o+"shift"],v=3*f.arrowsize*f.arrowwidth||0,_=v+y,x=v-y,T=3*f.startarrowsize*f.arrowwidth||0,A=T+y,S=T-y;if(a===n){var w=d.findExtremes(u,[u.r2c(i)],{ppadplus:_,ppadminus:x}),C=d.findExtremes(u,[u.r2c(c)],{ppadplus:Math.max(g,A),ppadminus:Math.max(h,S)});s={min:[w.min[0],C.min[0]],max:[w.max[0],C.max[0]]}}else A=c?A+c:A,S=c?S-c:S,s=d.findExtremes(u,[u.r2c(i)],{ppadplus:Math.max(g,_,A),ppadminus:Math.max(h,x,S)});f._extremes[l]=s}O.exports=function(f){var u=f._fullLayout;if(t.filterVisible(u.annotations).length&&f._fullData.length)return t.syncOrAsync([m,p],f)}},{"../../lib":787,"../../plots/cartesian/axes":838,"./draw":639}],635:[function(r,O,B){var t=r("../../lib"),d=r("../../registry"),m=r("../../plot_api/plot_template").arrayEditor;function p(f,u){var s,l,o,i,c,n,a,g=f._fullLayout.annotations,h=[],y=[],v=[],_=(u||[]).length;for(s=0;s<g.length;s++)if(i=(o=g[s]).clicktoshow){for(l=0;l<_;l++)if(n=(c=u[l]).xaxis,a=c.yaxis,n._id===o.xref&&a._id===o.yref&&n.d2r(c.x)===e(o._xclick,n)&&a.d2r(c.y)===e(o._yclick,a)){(o.visible?i==="onout"?y:v:h).push(s);break}l===_&&o.visible&&i==="onout"&&y.push(s)}return{on:h,off:y,explicitOff:v}}function e(f,u){return u.type==="log"?u.l2r(f):u.d2r(f)}O.exports={hasClickToShow:function(f,u){var s=p(f,u);return s.on.length>0||s.explicitOff.length>0},onClick:function(f,u){var s,l,o=p(f,u),i=o.on,c=o.off.concat(o.explicitOff),n={},a=f._fullLayout.annotations;if(!(!i.length&&!c.length)){for(s=0;s<i.length;s++)(l=m(f.layout,"annotations",a[i[s]])).modifyItem("visible",!0),t.extendFlat(n,l.getUpdateObj());for(s=0;s<c.length;s++)(l=m(f.layout,"annotations",a[c[s]])).modifyItem("visible",!1),t.extendFlat(n,l.getUpdateObj());return d.call("update",f,{},n)}}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../registry":915}],636:[function(r,O,B){var t=r("../../lib"),d=r("../color");O.exports=function(m,p,e,f){f("opacity");var u=f("bgcolor"),s=f("bordercolor"),l=d.opacity(s);f("borderpad");var o=f("borderwidth"),i=f("showarrow");if(f("text",i?" ":e._dfltTitle.annotation),f("textangle"),t.coerceFont(f,"font",e.font),f("width"),f("align"),f("height")&&f("valign"),i){var c,n,a=f("arrowside");a.indexOf("end")!==-1&&(c=f("arrowhead"),n=f("arrowsize")),a.indexOf("start")!==-1&&(f("startarrowhead",c),f("startarrowsize",n)),f("arrowcolor",l?p.bordercolor:d.defaultLine),f("arrowwidth",2*(l&&o||1)),f("standoff"),f("startstandoff")}var g=f("hovertext"),h=e.hoverlabel||{};if(g){var y=f("hoverlabel.bgcolor",h.bgcolor||(d.opacity(u)?d.rgb(u):d.defaultLine)),v=f("hoverlabel.bordercolor",h.bordercolor||d.contrast(y));t.coerceFont(f,"hoverlabel.font",{family:h.font.family,size:h.font.size,color:h.font.color||v})}f("captureevents",!!g)}},{"../../lib":787,"../color":650}],637:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib/to_log_range");O.exports=function(m,p,e,f){p=p||{};var u=e==="log"&&p.type==="linear",s=e==="linear"&&p.type==="log";if(u||s)for(var l,o,i=m._fullLayout.annotations,c=p._id.charAt(0),n=0;n<i.length;n++)l=i[n],o="annotations["+n+"].",l[c+"ref"]===p._id&&a(c),l["a"+c+"ref"]===p._id&&a("a"+c);function a(g){var h=l[g],y=null;y=u?d(h,p.range):Math.pow(10,h),t(y)||(y=null),f(o+g,y)}}},{"../../lib/to_log_range":815,"fast-isnumeric":246}],638:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("../../plots/array_container_defaults"),p=r("./common_defaults"),e=r("./attributes");function f(u,s,l){function o(C,k){return t.coerce(u,s,e,C,k)}var i=o("visible"),c=o("clicktoshow");if(i||c){p(u,s,l,o);for(var n=s.showarrow,a=["x","y"],g=[-10,-30],h={_fullLayout:l},y=0;y<2;y++){var v=a[y],_=d.coerceRef(u,s,h,v,"","paper");if(_!=="paper"&&d.getFromId(h,_)._annIndices.push(s._index),d.coercePosition(s,h,o,_,v,.5),n){var x="a"+v,T=d.coerceRef(u,s,h,x,"pixel",["pixel","paper"]);T!=="pixel"&&T!==_&&(T=s[x]="pixel");var A=T==="pixel"?g[y]:.4;d.coercePosition(s,h,o,T,x,A)}o(v+"anchor"),o(v+"shift")}if(t.noneOrAll(u,s,["x","y"]),n&&t.noneOrAll(u,s,["ax","ay"]),c){var S=o("xclick"),w=o("yclick");s._xclick=S===void 0?s.x:d.cleanPosition(S,h,s.xref),s._yclick=w===void 0?s.y:d.cleanPosition(w,h,s.yref)}}}O.exports=function(u,s){m(u,s,{name:"annotations",handleItemDefaults:f})}},{"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"./attributes":633,"./common_defaults":636}],639:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../registry"),m=r("../../plots/plots"),p=r("../../lib"),e=p.strTranslate,f=r("../../plots/cartesian/axes"),u=r("../color"),s=r("../drawing"),l=r("../fx"),o=r("../../lib/svg_text_utils"),i=r("../../lib/setcursor"),c=r("../dragelement"),n=r("../../plot_api/plot_template").arrayEditor,a=r("./draw_arrow_head");function g(v,_){var x=v._fullLayout.annotations[_]||{},T=f.getFromId(v,x.xref),A=f.getFromId(v,x.yref);T&&T.setScale(),A&&A.setScale(),y(v,x,_,!1,T,A)}function h(v,_,x,T,A){var S=A[x],w=A[x+"ref"],C=x.indexOf("y")!==-1,k=f.getRefType(w)==="domain",L=C?T.h:T.w;return v?k?S+(C?-_:_)/v._length:v.p2r(v.r2p(S)+_):S+(C?-_:_)/L}function y(v,_,x,T,A,S){var w,C,k=v._fullLayout,L=v._fullLayout._size,M=v._context.edits;T?(w="annotation-"+T,C=T+".annotations"):(w="annotation",C="annotations");var P=n(v.layout,C,_),D=P.modifyBase,N=P.modifyItem,U=P.getUpdateObj;k._infolayer.selectAll("."+w+'[data-index="'+x+'"]').remove();var q="clip"+k._uid+"_ann"+x;if(_._input&&_.visible!==!1){var X={x:{},y:{}},K=+_.textangle||0,Z=k._infolayer.append("g").classed(w,!0).attr("data-index",String(x)).style("opacity",_.opacity),H=Z.append("g").classed("annotation-text-g",!0),Y=M[_.showarrow?"annotationTail":"annotationPosition"],$=_.captureevents||M.annotationText||Y,z=H.append("g").style("pointer-events",$?"all":null).call(i,"pointer").on("click",function(){v._dragging=!1,v.emit("plotly_clickannotation",se(t.event))});_.hovertext&&z.on("mouseover",function(){var ve=_.hoverlabel,ke=ve.font,Ee=this.getBoundingClientRect(),be=v.getBoundingClientRect();l.loneHover({x0:Ee.left-be.left,x1:Ee.right-be.left,y:(Ee.top+Ee.bottom)/2-be.top,text:_.hovertext,color:ve.bgcolor,borderColor:ve.bordercolor,fontFamily:ke.family,fontSize:ke.size,fontColor:ke.color},{container:k._hoverlayer.node(),outerContainer:k._paper.node(),gd:v})}).on("mouseout",function(){l.loneUnhover(k._hoverlayer.node())});var j=_.borderwidth,W=_.borderpad,ee=j+W,J=z.append("rect").attr("class","bg").style("stroke-width",j+"px").call(u.stroke,_.bordercolor).call(u.fill,_.bgcolor),Q=_.width||_.height,te=k._topclips.selectAll("#"+q).data(Q?[0]:[]);te.enter().append("clipPath").classed("annclip",!0).attr("id",q).append("rect"),te.exit().remove();var ie=_.font,ae=k._meta?p.templateString(_.text,k._meta):_.text,he=z.append("text").classed("annotation-text",!0).text(ae);M.annotationText?he.call(o.makeEditable,{delegate:z,gd:v}).call(de).on("edit",function(ve){_.text=ve,this.call(de),N("text",ve),A&&A.autorange&&D(A._name+".autorange",!0),S&&S.autorange&&D(S._name+".autorange",!0),d.call("_guiRelayout",v,U())}):he.call(de)}else t.selectAll("#"+q).remove();function se(ve){var ke={index:x,annotation:_._input,fullAnnotation:_,event:ve};return T&&(ke.subplotId=T),ke}function de(ve){return ve.call(s.font,ie).attr({"text-anchor":{left:"start",right:"end"}[_.align]||"middle"}),o.convertToTspans(ve,v,ue),ve}function ue(){var ve=he.selectAll("a");ve.size()===1&&ve.text()===he.text()&&z.insert("a",":first-child").attr({"xlink:xlink:href":ve.attr("xlink:href"),"xlink:xlink:show":ve.attr("xlink:show")}).style({cursor:"pointer"}).node().appendChild(J.node());var ke=z.select(".annotation-text-math-group"),Ee=!ke.empty(),be=s.bBox((Ee?ke:he).node()),xe=be.width,ce=be.height,ge=_.width||xe,we=_.height||ce,Me=Math.round(ge+2*ee),Se=Math.round(we+2*ee);function ze(it,St){return St==="auto"&&(St=it<1/3?"left":it>2/3?"right":"center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[St]}for(var Fe=!1,Ye=["x","y"],rt=0;rt<Ye.length;rt++){var Oe,je,We,qe,Qe,st=Ye[rt],ct=_[st+"ref"]||st,Pt=_["a"+st+"ref"],kt={x:A,y:S}[st],at=(K+(st==="x"?0:-90))*Math.PI/180,tt=Me*Math.cos(at),_t=Se*Math.sin(at),er=Math.abs(tt)+Math.abs(_t),tr=_[st+"anchor"],Ue=_[st+"shift"]*(st==="x"?1:-1),He=X[st],Be=f.getRefType(ct);if(kt&&Be!=="domain"){var Ke=kt.r2fraction(_[st]);(Ke<0||Ke>1)&&(Pt===ct?((Ke=kt.r2fraction(_["a"+st]))<0||Ke>1)&&(Fe=!0):Fe=!0),Oe=kt._offset+kt.r2p(_[st]),qe=.5}else{var _e=Be==="domain";st==="x"?(We=_[st],Oe=_e?kt._offset+kt._length*We:Oe=L.l+L.w*We):(We=1-_[st],Oe=_e?kt._offset+kt._length*We:Oe=L.t+L.h*We),qe=_.showarrow?.5:We}if(_.showarrow){He.head=Oe;var Ce=_["a"+st];if(Qe=tt*ze(.5,_.xanchor)-_t*ze(.5,_.yanchor),Pt===ct){var Le=f.getRefType(Pt);Le==="domain"?(st==="y"&&(Ce=1-Ce),He.tail=kt._offset+kt._length*Ce):Le==="paper"?st==="y"?(Ce=1-Ce,He.tail=L.t+L.h*Ce):He.tail=L.l+L.w*Ce:He.tail=kt._offset+kt.r2p(Ce),je=Qe}else He.tail=Oe+Ce,je=Qe+Ce;He.text=He.tail+Qe;var Pe=k[st==="x"?"width":"height"];if(ct==="paper"&&(He.head=p.constrain(He.head,1,Pe-1)),Pt==="pixel"){var Xe=-Math.max(He.tail-3,He.text),ht=Math.min(He.tail+3,He.text)-Pe;Xe>0?(He.tail+=Xe,He.text+=Xe):ht>0&&(He.tail-=ht,He.text-=ht)}He.tail+=Ue,He.head+=Ue}else je=Qe=er*ze(qe,tr),He.text=Oe+Qe;He.text+=Ue,Qe+=Ue,je+=Ue,_["_"+st+"padplus"]=er/2+je,_["_"+st+"padminus"]=er/2-je,_["_"+st+"size"]=er,_["_"+st+"shift"]=Qe}if(Fe)z.remove();else{var Mt=0,pt=0;if(_.align!=="left"&&(Mt=(ge-xe)*(_.align==="center"?.5:1)),_.valign!=="top"&&(pt=(we-ce)*(_.valign==="middle"?.5:1)),Ee)ke.select("svg").attr({x:ee+Mt-1,y:ee+pt}).call(s.setClipUrl,Q?q:null,v);else{var Lt=ee+pt-be.top,vt=ee+Mt-be.left;he.call(o.positionText,vt,Lt).call(s.setClipUrl,Q?q:null,v)}te.select("rect").call(s.setRect,ee,ee,ge,we),J.call(s.setRect,j/2,j/2,Me-j,Se-j),z.call(s.setTranslate,Math.round(X.x.text-Me/2),Math.round(X.y.text-Se/2)),H.attr({transform:"rotate("+K+","+X.x.text+","+X.y.text+")"});var Dt,xt=function(it,St){Z.selectAll(".annotation-arrow-g").remove();var Nt=X.x.head,Ut=X.y.head,Qt=X.x.tail+it,Ie=X.y.tail+St,lt=X.x.text+it,wt=X.y.text+St,Ot=p.rotationXYMatrix(K,lt,wt),Gt=p.apply2DTransform(Ot),ir=p.apply2DTransform2(Ot),Xt=+J.attr("width"),Kt=+J.attr("height"),or=lt-.5*Xt,dr=or+Xt,vr=wt-.5*Kt,ur=vr+Kt,pr=[[or,vr,or,ur],[or,ur,dr,ur],[dr,ur,dr,vr],[dr,vr,or,vr]].map(ir);if(!pr.reduce(function(Pr,en){return Pr^!!p.segmentsIntersect(Nt,Ut,Nt+1e6,Ut+1e6,en[0],en[1],en[2],en[3])},!1)){pr.forEach(function(Pr){var en=p.segmentsIntersect(Qt,Ie,Nt,Ut,Pr[0],Pr[1],Pr[2],Pr[3]);en&&(Qt=en.x,Ie=en.y)});var br=_.arrowwidth,Rr=_.arrowcolor,_r=_.arrowside,jr=Z.append("g").style({opacity:u.opacity(Rr)}).classed("annotation-arrow-g",!0),$r=jr.append("path").attr("d","M"+Qt+","+Ie+"L"+Nt+","+Ut).style("stroke-width",br+"px").call(u.stroke,u.rgb(Rr));if(a($r,_r,_),M.annotationPosition&&$r.node().parentNode&&!T){var pn=Nt,In=Ut;if(_.standoff){var On=Math.sqrt(Math.pow(Nt-Qt,2)+Math.pow(Ut-Ie,2));pn+=_.standoff*(Qt-Nt)/On,In+=_.standoff*(Ie-Ut)/On}var Sn,an,Nr=jr.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(Qt-pn)+","+(Ie-In),transform:e(pn,In)}).style("stroke-width",br+6+"px").call(u.stroke,"rgba(0,0,0,0)").call(u.fill,"rgba(0,0,0,0)");c.init({element:Nr.node(),gd:v,prepFn:function(){var Pr=s.getTranslate(z);Sn=Pr.x,an=Pr.y,A&&A.autorange&&D(A._name+".autorange",!0),S&&S.autorange&&D(S._name+".autorange",!0)},moveFn:function(Pr,en){var tn=Gt(Sn,an),Qr=tn[0]+Pr,rn=tn[1]+en;z.call(s.setTranslate,Qr,rn),N("x",h(A,Pr,"x",L,_)),N("y",h(S,en,"y",L,_)),_.axref===_.xref&&N("ax",h(A,Pr,"ax",L,_)),_.ayref===_.yref&&N("ay",h(S,en,"ay",L,_)),jr.attr("transform",e(Pr,en)),H.attr({transform:"rotate("+K+","+Qr+","+rn+")"})},doneFn:function(){d.call("_guiRelayout",v,U());var Pr=document.querySelector(".js-notes-box-panel");Pr&&Pr.redraw(Pr.selectedObj)}})}}};_.showarrow&&xt(0,0),Y&&c.init({element:z.node(),gd:v,prepFn:function(){Dt=H.attr("transform")},moveFn:function(it,St){var Nt="pointer";if(_.showarrow)_.axref===_.xref?N("ax",h(A,it,"ax",L,_)):N("ax",_.ax+it),_.ayref===_.yref?N("ay",h(S,St,"ay",L.w,_)):N("ay",_.ay+St),xt(it,St);else{if(T)return;var Ut,Qt;if(A)Ut=h(A,it,"x",L,_);else{var Ie=_._xsize/L.w,lt=_.x+(_._xshift-_.xshift)/L.w-Ie/2;Ut=c.align(lt+it/L.w,Ie,0,1,_.xanchor)}if(S)Qt=h(S,St,"y",L,_);else{var wt=_._ysize/L.h,Ot=_.y-(_._yshift+_.yshift)/L.h-wt/2;Qt=c.align(Ot-St/L.h,wt,0,1,_.yanchor)}N("x",Ut),N("y",Qt),A&&S||(Nt=c.getCursor(A?.5:Ut,S?.5:Qt,_.xanchor,_.yanchor))}H.attr({transform:e(it,St)+Dt}),i(z,Nt)},clickFn:function(it,St){_.captureevents&&v.emit("plotly_clickannotation",se(St))},doneFn:function(){i(z),d.call("_guiRelayout",v,U());var it=document.querySelector(".js-notes-box-panel");it&&it.redraw(it.selectedObj)}})}}}O.exports={draw:function(v){var _=v._fullLayout;_._infolayer.selectAll(".annotation").remove();for(var x=0;x<_.annotations.length;x++)_.annotations[x].visible&&g(v,x);return m.previousPromises(v)},drawOne:g,drawRaw:y}},{"../../lib":787,"../../lib/setcursor":808,"../../lib/svg_text_utils":813,"../../plot_api/plot_template":827,"../../plots/cartesian/axes":838,"../../plots/plots":901,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"../fx":690,"./draw_arrow_head":640,"@plotly/d3":58}],640:[function(r,O,B){var t=r("@plotly/d3"),d=r("../color"),m=r("./arrow_paths"),p=r("../../lib"),e=p.strScale,f=p.strRotate,u=p.strTranslate;O.exports=function(s,l,o){var i,c,n,a,g=s.node(),h=m[o.arrowhead||0],y=m[o.startarrowhead||0],v=(o.arrowwidth||1)*(o.arrowsize||1),_=(o.arrowwidth||1)*(o.startarrowsize||1),x=l.indexOf("start")>=0,T=l.indexOf("end")>=0,A=h.backoff*v+o.standoff,S=y.backoff*_+o.startstandoff;if(g.nodeName==="line"){i={x:+s.attr("x1"),y:+s.attr("y1")},c={x:+s.attr("x2"),y:+s.attr("y2")};var w=i.x-c.x,C=i.y-c.y;if(a=(n=Math.atan2(C,w))+Math.PI,A&&S&&A+S>Math.sqrt(w*w+C*C))return void Z();if(A){if(A*A>w*w+C*C)return void Z();var k=A*Math.cos(n),L=A*Math.sin(n);c.x+=k,c.y+=L,s.attr({x2:c.x,y2:c.y})}if(S){if(S*S>w*w+C*C)return void Z();var M=S*Math.cos(n),P=S*Math.sin(n);i.x-=M,i.y-=P,s.attr({x1:i.x,y1:i.y})}}else if(g.nodeName==="path"){var D=g.getTotalLength(),N="";if(D<A+S)return void Z();var U=g.getPointAtLength(0),q=g.getPointAtLength(.1);n=Math.atan2(U.y-q.y,U.x-q.x),i=g.getPointAtLength(Math.min(S,D)),N="0px,"+S+"px,";var X=g.getPointAtLength(D),K=g.getPointAtLength(D-.1);a=Math.atan2(X.y-K.y,X.x-K.x),c=g.getPointAtLength(Math.max(0,D-A)),N+=D-(N?S+A:A)+"px,"+D+"px",s.style("stroke-dasharray",N)}function Z(){s.style("stroke-dasharray","0px,100px")}function H(Y,$,z,j){Y.path&&(Y.noRotate&&(z=0),t.select(g.parentNode).append("path").attr({class:s.attr("class"),d:Y.path,transform:u($.x,$.y)+f(180*z/Math.PI)+e(j)}).style({fill:d.rgb(o.arrowcolor),"stroke-width":0}))}x&&H(y,i,n,_),T&&H(h,c,a,v)}},{"../../lib":787,"../color":650,"./arrow_paths":632,"@plotly/d3":58}],641:[function(r,O,B){var t=r("./draw"),d=r("./click");O.exports={moduleType:"component",name:"annotations",layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),includeBasePlot:r("../../plots/cartesian/include_components")("annotations"),calcAutorange:r("./calc_autorange"),draw:t.draw,drawOne:t.drawOne,drawRaw:t.drawRaw,hasClickToShow:d.hasClickToShow,onClick:d.onClick,convertCoords:r("./convert_coords")}},{"../../plots/cartesian/include_components":851,"./attributes":633,"./calc_autorange":634,"./click":635,"./convert_coords":637,"./defaults":638,"./draw":639}],642:[function(r,O,B){var t=r("../annotations/attributes"),d=r("../../plot_api/edit_types").overrideAll,m=r("../../plot_api/plot_template").templatedArray;O.exports=d(m("annotation",{visible:t.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:t.xanchor,xshift:t.xshift,yanchor:t.yanchor,yshift:t.yshift,text:t.text,textangle:t.textangle,font:t.font,width:t.width,height:t.height,opacity:t.opacity,align:t.align,valign:t.valign,bgcolor:t.bgcolor,bordercolor:t.bordercolor,borderpad:t.borderpad,borderwidth:t.borderwidth,showarrow:t.showarrow,arrowcolor:t.arrowcolor,arrowhead:t.arrowhead,startarrowhead:t.startarrowhead,arrowside:t.arrowside,arrowsize:t.arrowsize,startarrowsize:t.startarrowsize,arrowwidth:t.arrowwidth,standoff:t.standoff,startstandoff:t.startstandoff,hovertext:t.hovertext,hoverlabel:t.hoverlabel,captureevents:t.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../annotations/attributes":633}],643:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes");function m(p,e){var f=e.fullSceneLayout.domain,u=e.fullLayout._size,s={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};p._xa={},t.extendFlat(p._xa,s),d.setConvert(p._xa),p._xa._offset=u.l+f.x[0]*u.w,p._xa.l2p=function(){return .5*(1+p._pdata[0]/p._pdata[3])*u.w*(f.x[1]-f.x[0])},p._ya={},t.extendFlat(p._ya,s),d.setConvert(p._ya),p._ya._offset=u.t+(1-f.y[1])*u.h,p._ya.l2p=function(){return .5*(1-p._pdata[1]/p._pdata[3])*u.h*(f.y[1]-f.y[0])}}O.exports=function(p){for(var e=p.fullSceneLayout.annotations,f=0;f<e.length;f++)m(e[f],p);p.fullLayout._infolayer.selectAll(".annotation-"+p.id).remove()}},{"../../lib":787,"../../plots/cartesian/axes":838}],644:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("../../plots/array_container_defaults"),p=r("../annotations/common_defaults"),e=r("./attributes");function f(u,s,l,o){function i(n,a){return t.coerce(u,s,e,n,a)}function c(n){var a=n+"axis",g={_fullLayout:{}};return g._fullLayout[a]=l[a],d.coercePosition(s,g,i,n,n,.5)}i("visible")&&(p(u,s,o.fullLayout,i),c("x"),c("y"),c("z"),t.noneOrAll(u,s,["x","y","z"]),s.xref="x",s.yref="y",s.zref="z",i("xanchor"),i("yanchor"),i("xshift"),i("yshift"),s.showarrow&&(s.axref="pixel",s.ayref="pixel",i("ax",-10),i("ay",-30),t.noneOrAll(u,s,["ax","ay"])))}O.exports=function(u,s,l){m(u,s,{name:"annotations",handleItemDefaults:f,fullLayout:l.fullLayout})}},{"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"../annotations/common_defaults":636,"./attributes":642}],645:[function(r,O,B){var t=r("../annotations/draw").drawRaw,d=r("../../plots/gl3d/project"),m=["x","y","z"];O.exports=function(p){for(var e=p.fullSceneLayout,f=p.dataScale,u=e.annotations,s=0;s<u.length;s++){for(var l=u[s],o=!1,i=0;i<3;i++){var c=m[i],n=l[c],a=e[c+"axis"].r2fraction(n);if(a<0||a>1){o=!0;break}}o?p.fullLayout._infolayer.select(".annotation-"+p.id+'[data-index="'+s+'"]').remove():(l._pdata=d(p.glplot.cameraParams,[e.xaxis.r2l(l.x)*f[0],e.yaxis.r2l(l.y)*f[1],e.zaxis.r2l(l.z)*f[2]]),t(p.graphDiv,l,s,p.id,l._xa,l._ya))}}},{"../../plots/gl3d/project":889,"../annotations/draw":639}],646:[function(r,O,B){var t=r("../../registry"),d=r("../../lib");O.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:r("./attributes")}}},layoutAttributes:r("./attributes"),handleDefaults:r("./defaults"),includeBasePlot:function(m,p){var e=t.subplotsRegistry.gl3d;if(!!e)for(var f=e.attrRegex,u=Object.keys(m),s=0;s<u.length;s++){var l=u[s];f.test(l)&&(m[l].annotations||[]).length&&(d.pushUnique(p._basePlotModules,e),d.pushUnique(p._subplots.gl3d,l))}},convert:r("./convert"),draw:r("./draw")}},{"../../lib":787,"../../registry":915,"./attributes":642,"./convert":643,"./defaults":644,"./draw":645}],647:[function(r,O,B){O.exports=r("world-calendars/dist/main"),r("world-calendars/dist/plus"),r("world-calendars/dist/calendars/chinese"),r("world-calendars/dist/calendars/coptic"),r("world-calendars/dist/calendars/discworld"),r("world-calendars/dist/calendars/ethiopian"),r("world-calendars/dist/calendars/hebrew"),r("world-calendars/dist/calendars/islamic"),r("world-calendars/dist/calendars/julian"),r("world-calendars/dist/calendars/mayan"),r("world-calendars/dist/calendars/nanakshahi"),r("world-calendars/dist/calendars/nepali"),r("world-calendars/dist/calendars/persian"),r("world-calendars/dist/calendars/taiwan"),r("world-calendars/dist/calendars/thai"),r("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":614,"world-calendars/dist/calendars/coptic":615,"world-calendars/dist/calendars/discworld":616,"world-calendars/dist/calendars/ethiopian":617,"world-calendars/dist/calendars/hebrew":618,"world-calendars/dist/calendars/islamic":619,"world-calendars/dist/calendars/julian":620,"world-calendars/dist/calendars/mayan":621,"world-calendars/dist/calendars/nanakshahi":622,"world-calendars/dist/calendars/nepali":623,"world-calendars/dist/calendars/persian":624,"world-calendars/dist/calendars/taiwan":625,"world-calendars/dist/calendars/thai":626,"world-calendars/dist/calendars/ummalqura":627,"world-calendars/dist/main":628,"world-calendars/dist/plus":629}],648:[function(r,O,B){var t=r("./calendars"),d=r("../../lib"),m=r("../../constants/numerical"),p=m.EPOCHJD,e=m.ONEDAY,f={valType:"enumerated",values:d.sortObjectKeys(t.calendars),editType:"calc",dflt:"gregorian"},u=function(y,v,_,x){var T={};return T[_]=f,d.coerce(y,v,T,_,x)},s={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:"##",w:"##",c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}},l={};function o(y){var v=l[y];return v||(v=l[y]=t.instance(y))}function i(y){return d.extendFlat({},f,{description:y})}function c(y){return"Sets the calendar system to use with `"+y+"` date data."}var n={xcalendar:i(c("x"))},a=d.extendFlat({},n,{ycalendar:i(c("y"))}),g=d.extendFlat({},a,{zcalendar:i(c("z"))}),h=i(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));O.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:a,bar:a,box:a,heatmap:a,contour:a,histogram:a,histogram2d:a,histogram2dcontour:a,scatter3d:g,surface:g,mesh3d:g,scattergl:a,ohlc:n,candlestick:n},layout:{calendar:i(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:h},yaxis:{calendar:h},scene:{xaxis:{calendar:h},yaxis:{calendar:h},zaxis:{calendar:h}},polar:{radialaxis:{calendar:h}}},transforms:{filter:{valuecalendar:i(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:i(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:f,handleDefaults:u,handleTraceDefaults:function(y,v,_,x){for(var T=0;T<_.length;T++)u(y,v,_[T]+"calendar",x.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:o,worldCalFmt:function(y,v,_){for(var x,T,A,S,w,C=Math.floor((v+.05)/e)+p,k=o(_).fromJD(C),L=0;(L=y.indexOf("%",L))!==-1;)(x=y.charAt(L+1))==="0"||x==="-"||x==="_"?(A=3,T=y.charAt(L+2),x==="_"&&(x="-")):(T=x,x="0",A=2),(S=s[T])?(w=S==="##"?"##":k.formatDate(S[x]),y=y.substr(0,L)+w+y.substr(L+A),L+=w.length):L+=A;return y}}},{"../../constants/numerical":763,"../../lib":787,"./calendars":647}],649:[function(r,O,B){B.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],B.defaultLine="#444",B.lightLine="#eee",B.background="#fff",B.borderLine="#BEC8D9",B.lightFraction=1e3/11},{}],650:[function(r,O,B){var t=r("tinycolor2"),d=r("fast-isnumeric"),m=r("../../lib/array").isTypedArray,p=O.exports={},e=r("./attributes");p.defaults=e.defaults;var f=p.defaultLine=e.defaultLine;p.lightLine=e.lightLine;var u=p.background=e.background;function s(l){if(d(l)||typeof l!="string")return l;var o=l.trim();if(o.substr(0,3)!=="rgb")return l;var i=o.match(/^rgba?\s*\(([^()]*)\)$/);if(!i)return l;var c=i[1].trim().split(/\s*[\s,]\s*/),n=o.charAt(3)==="a"&&c.length===4;if(!n&&c.length!==3)return l;for(var a=0;a<c.length;a++){if(!c[a].length||(c[a]=Number(c[a]),!(c[a]>=0)))return l;if(a===3)c[a]>1&&(c[a]=1);else if(c[a]>=1)return l}var g=Math.round(255*c[0])+", "+Math.round(255*c[1])+", "+Math.round(255*c[2]);return n?"rgba("+g+", "+c[3]+")":"rgb("+g+")"}p.tinyRGB=function(l){var o=l.toRgb();return"rgb("+Math.round(o.r)+", "+Math.round(o.g)+", "+Math.round(o.b)+")"},p.rgb=function(l){return p.tinyRGB(t(l))},p.opacity=function(l){return l?t(l).getAlpha():0},p.addOpacity=function(l,o){var i=t(l).toRgb();return"rgba("+Math.round(i.r)+", "+Math.round(i.g)+", "+Math.round(i.b)+", "+o+")"},p.combine=function(l,o){var i=t(l).toRgb();if(i.a===1)return t(l).toRgbString();var c=t(o||u).toRgb(),n=c.a===1?c:{r:255*(1-c.a)+c.r*c.a,g:255*(1-c.a)+c.g*c.a,b:255*(1-c.a)+c.b*c.a},a={r:n.r*(1-i.a)+i.r*i.a,g:n.g*(1-i.a)+i.g*i.a,b:n.b*(1-i.a)+i.b*i.a};return t(a).toRgbString()},p.contrast=function(l,o,i){var c=t(l);return c.getAlpha()!==1&&(c=t(p.combine(l,u))),(c.isDark()?o?c.lighten(o):u:i?c.darken(i):f).toString()},p.stroke=function(l,o){var i=t(o);l.style({stroke:p.tinyRGB(i),"stroke-opacity":i.getAlpha()})},p.fill=function(l,o){var i=t(o);l.style({fill:p.tinyRGB(i),"fill-opacity":i.getAlpha()})},p.clean=function(l){if(l&&typeof l=="object"){var o,i,c,n,a=Object.keys(l);for(o=0;o<a.length;o++)if(n=l[c=a[o]],c.substr(c.length-5)==="color")if(Array.isArray(n))for(i=0;i<n.length;i++)n[i]=s(n[i]);else l[c]=s(n);else if(c.substr(c.length-10)==="colorscale"&&Array.isArray(n))for(i=0;i<n.length;i++)Array.isArray(n[i])&&(n[i][1]=s(n[i][1]));else if(Array.isArray(n)){var g=n[0];if(!Array.isArray(g)&&g&&typeof g=="object")for(i=0;i<n.length;i++)p.clean(n[i])}else n&&typeof n=="object"&&!m(n)&&p.clean(n)}}},{"../../lib/array":769,"./attributes":649,"fast-isnumeric":246,tinycolor2:583}],651:[function(r,O,B){var t=r("../../plots/cartesian/layout_attributes"),d=r("../../plots/font_attributes"),m=r("../../lib/extend").extendFlat,p=r("../../plot_api/edit_types").overrideAll;O.exports=p({thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:t.linecolor,outlinewidth:t.linewidth,bordercolor:t.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:t.tickmode,nticks:t.nticks,tick0:t.tick0,dtick:t.dtick,tickvals:t.tickvals,ticktext:t.ticktext,ticks:m({},t.ticks,{dflt:""}),ticklabeloverflow:m({},t.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside bottom","inside bottom"],dflt:"outside"},ticklen:t.ticklen,tickwidth:t.tickwidth,tickcolor:t.tickcolor,showticklabels:t.showticklabels,tickfont:d({}),tickangle:t.tickangle,tickformat:t.tickformat,tickformatstops:t.tickformatstops,tickprefix:t.tickprefix,showtickprefix:t.showtickprefix,ticksuffix:t.ticksuffix,showticksuffix:t.showticksuffix,separatethousands:t.separatethousands,exponentformat:t.exponentformat,minexponent:t.minexponent,showexponent:t.showexponent,title:{text:{valType:"string"},font:d({}),side:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}},_deprecated:{title:{valType:"string"},titlefont:d({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/cartesian/layout_attributes":853,"../../plots/font_attributes":867}],652:[function(r,O,B){O.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],653:[function(r,O,B){var t=r("../../lib"),d=r("../../plot_api/plot_template"),m=r("../../plots/cartesian/tick_value_defaults"),p=r("../../plots/cartesian/tick_mark_defaults"),e=r("../../plots/cartesian/tick_label_defaults"),f=r("./attributes");O.exports=function(u,s,l){var o=d.newContainer(s,"colorbar"),i=u.colorbar||{};function c(x,T){return t.coerce(i,o,f,x,T)}var n=c("thicknessmode");c("thickness",n==="fraction"?30/(l.width-l.margin.l-l.margin.r):30);var a=c("lenmode");c("len",a==="fraction"?1:l.height-l.margin.t-l.margin.b),c("x"),c("xanchor"),c("xpad"),c("y"),c("yanchor"),c("ypad"),t.noneOrAll(i,o,["x","y"]),c("outlinecolor"),c("outlinewidth"),c("bordercolor"),c("borderwidth"),c("bgcolor");var g=c("ticklabelposition");c("ticklabeloverflow",g.indexOf("inside")!==-1?"hide past domain":"hide past div"),m(i,o,c,"linear");var h=l.font,y={outerTicks:!1,font:h};g.indexOf("inside")!==-1&&(y.bgColor="black"),e(i,o,c,"linear",y),p(i,o,c,"linear",y),c("title.text",l._dfltTitle.colorbar);var v=o.tickfont,_=t.extendFlat({},v,{color:h.color,size:t.bigFont(v.size)});t.coerceFont(c,"title.font",_),c("title.side")}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/cartesian/tick_label_defaults":860,"../../plots/cartesian/tick_mark_defaults":861,"../../plots/cartesian/tick_value_defaults":862,"./attributes":651}],654:[function(r,O,B){var t=r("@plotly/d3"),d=r("tinycolor2"),m=r("../../plots/plots"),p=r("../../registry"),e=r("../../plots/cartesian/axes"),f=r("../dragelement"),u=r("../../lib"),s=u.strTranslate,l=r("../../lib/extend").extendFlat,o=r("../../lib/setcursor"),i=r("../drawing"),c=r("../color"),n=r("../titles"),a=r("../../lib/svg_text_utils"),g=r("../colorscale/helpers").flipScale,h=r("../../plots/cartesian/axis_defaults"),y=r("../../plots/cartesian/position_defaults"),v=r("../../plots/cartesian/layout_attributes"),_=r("../../constants/alignment"),x=_.LINE_SPACING,T=_.FROM_TL,A=_.FROM_BR,S=r("./constants").cn;O.exports={draw:function(w){var C=w._fullLayout._infolayer.selectAll("g."+S.colorbar).data(function(k){var L,M,P,D,N=k._fullLayout,U=k.calcdata,q=[];function X(Q){return l(Q,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function K(){typeof D.calc=="function"?D.calc(k,P,L):(L._fillgradient=M.reversescale?g(M.colorscale):M.colorscale,L._zrange=[M[D.min],M[D.max]])}for(var Z=0;Z<U.length;Z++){var H=U[Z],Y=(P=H[0].trace)._module.colorbar;if(P.visible===!0&&Y)for(var $=Array.isArray(Y),z=$?Y:[Y],j=0;j<z.length;j++){var W=(D=z[j]).container;(M=W?P[W]:P)&&M.showscale&&((L=X(M.colorbar))._id="cb"+P.uid+($&&W?"-"+W:""),L._traceIndex=P.index,L._propPrefix=(W?W+".":"")+"colorbar.",L._meta=P._meta,K(),q.push(L))}}for(var ee in N._colorAxes)if((M=N[ee]).showscale){var J=N._colorAxes[ee];(L=X(M.colorbar))._id="cb"+ee,L._propPrefix=ee+".colorbar.",L._meta=N._meta,D={min:"cmin",max:"cmax"},J[0]!=="heatmap"&&(P=J[1],D.calc=P._module.colorbar.calc),K(),q.push(L)}return q}(w),function(k){return k._id});C.enter().append("g").attr("class",function(k){return k._id}).classed(S.colorbar,!0),C.each(function(k){var L=t.select(this);u.ensureSingle(L,"rect",S.cbbg),u.ensureSingle(L,"g",S.cbfills),u.ensureSingle(L,"g",S.cblines),u.ensureSingle(L,"g",S.cbaxis,function(P){P.classed(S.crisp,!0)}),u.ensureSingle(L,"g",S.cbtitleunshift,function(P){P.append("g").classed(S.cbtitle,!0)}),u.ensureSingle(L,"rect",S.cboutline);var M=function(P,D,N){var U=N._fullLayout,q=U._size,X=D._fillcolor,K=D._line,Z=D.title,H=Z.side,Y=D._zrange||t.extent((typeof X=="function"?X:K.color).domain()),$=typeof K.color=="function"?K.color:function(){return K.color},z=typeof X=="function"?X:function(){return X},j=D._levels,W=function(Oe,je,We){var qe,Qe,st=je._levels,ct=[],Pt=[],kt=st.end+st.size/100,at=st.size,tt=1.001*We[0]-.001*We[1],_t=1.001*We[1]-.001*We[0];for(Qe=0;Qe<1e5&&(qe=st.start+Qe*at,!(at>0?qe>=kt:qe<=kt));Qe++)qe>tt&&qe<_t&&ct.push(qe);if(je._fillgradient)Pt=[0];else if(typeof je._fillcolor=="function"){var er=je._filllevels;if(er)for(kt=er.end+er.size/100,at=er.size,Qe=0;Qe<1e5&&(qe=er.start+Qe*at,!(at>0?qe>=kt:qe<=kt));Qe++)qe>We[0]&&qe<We[1]&&Pt.push(qe);else(Pt=ct.map(function(tr){return tr-st.size/2})).push(Pt[Pt.length-1]+st.size)}else je._fillcolor&&typeof je._fillcolor=="string"&&(Pt=[0]);return st.size<0&&(ct.reverse(),Pt.reverse()),{line:ct,fill:Pt}}(0,D,Y),ee=W.fill,J=W.line,Q=Math.round(D.thickness*(D.thicknessmode==="fraction"?q.w:1)),te=Q/q.w,ie=Math.round(D.len*(D.lenmode==="fraction"?q.h:1)),ae=ie/q.h,he=D.xpad/q.w,se=(D.borderwidth+D.outlinewidth)/2,de=D.ypad/q.h,ue=Math.round(D.x*q.w+D.xpad),ve=D.x-te*({middle:.5,right:1}[D.xanchor]||0),ke=D.y+ae*(({top:-.5,bottom:.5}[D.yanchor]||0)-.5),Ee=Math.round(q.h*(1-ke)),be=Ee-ie;D._lenFrac=ae,D._thickFrac=te,D._xLeftFrac=ve,D._yBottomFrac=ke;var xe=D._axis=function(Oe,je,We){var qe=Oe._fullLayout,Qe={type:"linear",range:We,tickmode:je.tickmode,nticks:je.nticks,tick0:je.tick0,dtick:je.dtick,tickvals:je.tickvals,ticktext:je.ticktext,ticks:je.ticks,ticklen:je.ticklen,tickwidth:je.tickwidth,tickcolor:je.tickcolor,showticklabels:je.showticklabels,ticklabelposition:je.ticklabelposition,ticklabeloverflow:je.ticklabeloverflow,tickfont:je.tickfont,tickangle:je.tickangle,tickformat:je.tickformat,exponentformat:je.exponentformat,minexponent:je.minexponent,separatethousands:je.separatethousands,showexponent:je.showexponent,showtickprefix:je.showtickprefix,tickprefix:je.tickprefix,showticksuffix:je.showticksuffix,ticksuffix:je.ticksuffix,title:je.title,showline:!0,anchor:"free",side:"right",position:1},st={type:"linear",_id:"y"+je._id},ct={letter:"y",font:qe.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:qe.calendar};function Pt(kt,at){return u.coerce(Qe,st,v,kt,at)}return h(Qe,st,Pt,ct,qe),y(Qe,st,Pt,ct),st}(N,D,Y);if(xe.position=D.x+he+te,["top","bottom"].indexOf(H)!==-1&&(xe.title.side=H,xe.titlex=D.x+he,xe.titley=ke+(Z.side==="top"?ae-de:de)),K.color&&D.tickmode==="auto"){xe.tickmode="linear",xe.tick0=j.start;var ce=j.size,ge=u.constrain((Ee-be)/50,4,15)+1,we=(Y[1]-Y[0])/((D.nticks||ge)*ce);if(we>1){var Me=Math.pow(10,Math.floor(Math.log(we)/Math.LN10));ce*=Me*u.roundUp(we/Me,[2,5,10]),(Math.abs(j.start)/j.size+1e-6)%1<2e-6&&(xe.tick0=0)}xe.dtick=ce}xe.domain=[ke+de,ke+ae-de],xe.setScale(),P.attr("transform",s(Math.round(q.l),Math.round(q.t)));var Se,ze=P.select("."+S.cbtitleunshift).attr("transform",s(-Math.round(q.l),-Math.round(q.t))),Fe=P.select("."+S.cbaxis),Ye=0;function rt(Oe,je){var We={propContainer:xe,propName:D._propPrefix+"title",traceIndex:D._traceIndex,_meta:D._meta,placeholder:U._dfltTitle.colorbar,containerGroup:P.select("."+S.cbtitle)},qe=Oe.charAt(0)==="h"?Oe.substr(1):"h"+Oe;P.selectAll("."+qe+",."+qe+"-math-group").remove(),n.draw(N,Oe,l(We,je||{}))}return u.syncOrAsync([m.previousPromises,function(){if(["top","bottom"].indexOf(H)!==-1){var Oe,je=q.l+(D.x+he)*q.w,We=xe.title.font.size;Oe=H==="top"?(1-(ke+ae-de))*q.h+q.t+3+.75*We:(1-(ke+de))*q.h+q.t-3-.25*We,rt(xe._id+"title",{attributes:{x:je,y:Oe,"text-anchor":"start"}})}},function(){if(["top","bottom"].indexOf(H)!==-1){var Oe=P.select("."+S.cbtitle),je=Oe.select("text"),We=[-D.outlinewidth/2,D.outlinewidth/2],qe=Oe.select(".h"+xe._id+"title-math-group").node(),Qe=15.6;if(je.node()&&(Qe=parseInt(je.node().style.fontSize,10)*x),qe?(Ye=i.bBox(qe).height)>Qe&&(We[1]-=(Ye-Qe)/2):je.node()&&!je.classed(S.jsPlaceholder)&&(Ye=i.bBox(je.node()).height),Ye){if(Ye+=5,H==="top")xe.domain[1]-=Ye/q.h,We[1]*=-1;else{xe.domain[0]+=Ye/q.h;var st=a.lineCount(je);We[1]+=(1-st)*Qe}Oe.attr("transform",s(We[0],We[1])),xe.setScale()}}P.selectAll("."+S.cbfills+",."+S.cblines).attr("transform",s(0,Math.round(q.h*(1-xe.domain[1])))),Fe.attr("transform",s(0,Math.round(-q.t)));var ct=P.select("."+S.cbfills).selectAll("rect."+S.cbfill).attr("style","").data(ee);ct.enter().append("rect").classed(S.cbfill,!0).style("stroke","none"),ct.exit().remove();var Pt=Y.map(xe.c2p).map(Math.round).sort(function(er,tr){return er-tr});ct.each(function(er,tr){var Ue=[tr===0?Y[0]:(ee[tr]+ee[tr-1])/2,tr===ee.length-1?Y[1]:(ee[tr]+ee[tr+1])/2].map(xe.c2p).map(Math.round);Ue[1]=u.constrain(Ue[1]+(Ue[1]>Ue[0])?1:-1,Pt[0],Pt[1]);var He=t.select(this).attr({x:ue,width:Math.max(Q,2),y:t.min(Ue),height:Math.max(t.max(Ue)-t.min(Ue),2)});if(D._fillgradient)i.gradient(He,N,D._id,"vertical",D._fillgradient,"fill");else{var Be=z(er).replace("e-","");He.attr("fill",d(Be).toHexString())}});var kt=P.select("."+S.cblines).selectAll("path."+S.cbline).data(K.color&&K.width?J:[]);kt.enter().append("path").classed(S.cbline,!0),kt.exit().remove(),kt.each(function(er){t.select(this).attr("d","M"+ue+","+(Math.round(xe.c2p(er))+K.width/2%1)+"h"+Q).call(i.lineGroupStyle,K.width,$(er),K.dash)}),Fe.selectAll("g."+xe._id+"tick,path").remove();var at=ue+Q+(D.outlinewidth||0)/2-(D.ticks==="outside"?1:0),tt=e.calcTicks(xe),_t=e.getTickSigns(xe)[2];return e.drawTicks(N,xe,{vals:xe.ticks==="inside"?e.clipEnds(xe,tt):tt,layer:Fe,path:e.makeTickPath(xe,at,_t),transFn:e.makeTransTickFn(xe)}),e.drawLabels(N,xe,{vals:tt,layer:Fe,transFn:e.makeTransTickLabelFn(xe),labelFns:e.makeLabelFns(xe,at)})},function(){if(["top","bottom"].indexOf(H)===-1){var Oe=xe.title.font.size,je=xe._offset+xe._length/2,We=q.l+(xe.position||0)*q.w+(xe.side==="right"?10+Oe*(xe.showticklabels?1:.5):-10-Oe*(xe.showticklabels?.5:0));rt("h"+xe._id+"title",{avoid:{selection:t.select(N).selectAll("g."+xe._id+"tick"),side:H,offsetLeft:q.l,offsetTop:0,maxShift:U.width},attributes:{x:We,y:je,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}},m.previousPromises,function(){var Oe=Q+D.outlinewidth/2;if(xe.ticklabelposition.indexOf("inside")===-1&&(Oe+=i.bBox(Fe.node()).width),(Se=ze.select("text")).node()&&!Se.classed(S.jsPlaceholder)){var je,We=ze.select(".h"+xe._id+"title-math-group").node();je=We&&["top","bottom"].indexOf(H)!==-1?i.bBox(We).width:i.bBox(ze.node()).right-ue-q.l,Oe=Math.max(Oe,je)}var qe=2*D.xpad+Oe+D.borderwidth+D.outlinewidth/2,Qe=Ee-be;P.select("."+S.cbbg).attr({x:ue-D.xpad-(D.borderwidth+D.outlinewidth)/2,y:be-se,width:Math.max(qe,2),height:Math.max(Qe+2*se,2)}).call(c.fill,D.bgcolor).call(c.stroke,D.bordercolor).style("stroke-width",D.borderwidth),P.selectAll("."+S.cboutline).attr({x:ue,y:be+D.ypad+(H==="top"?Ye:0),width:Math.max(Q,2),height:Math.max(Qe-2*D.ypad-Ye,2)}).call(c.stroke,D.outlinecolor).style({fill:"none","stroke-width":D.outlinewidth});var st=({center:.5,right:1}[D.xanchor]||0)*qe;P.attr("transform",s(q.l-st,q.t));var ct={},Pt=T[D.yanchor],kt=A[D.yanchor];D.lenmode==="pixels"?(ct.y=D.y,ct.t=Qe*Pt,ct.b=Qe*kt):(ct.t=ct.b=0,ct.yt=D.y+D.len*Pt,ct.yb=D.y-D.len*kt);var at=T[D.xanchor],tt=A[D.xanchor];if(D.thicknessmode==="pixels")ct.x=D.x,ct.l=qe*at,ct.r=qe*tt;else{var _t=qe-Q;ct.l=_t*at,ct.r=_t*tt,ct.xl=D.x-D.thickness*at,ct.xr=D.x+D.thickness*tt}m.autoMargin(N,D._id,ct)}],N)}(L,k,w);M&&M.then&&(w._promises||[]).push(M),w._context.edits.colorbarPosition&&function(P,D,N){var U,q,X,K=N._fullLayout._size;f.init({element:P.node(),gd:N,prepFn:function(){U=P.attr("transform"),o(P)},moveFn:function(Z,H){P.attr("transform",U+s(Z,H)),q=f.align(D._xLeftFrac+Z/K.w,D._thickFrac,0,1,D.xanchor),X=f.align(D._yBottomFrac-H/K.h,D._lenFrac,0,1,D.yanchor);var Y=f.getCursor(q,X,D.xanchor,D.yanchor);o(P,Y)},doneFn:function(){if(o(P),q!==void 0&&X!==void 0){var Z={};Z[D._propPrefix+"x"]=q,Z[D._propPrefix+"y"]=X,D._traceIndex!==void 0?p.call("_guiRestyle",N,Z,D._traceIndex):p.call("_guiRelayout",N,Z)}}})}(L,k,w)}),C.exit().each(function(k){m.autoMargin(w,k._id)}).remove(),C.order()}}},{"../../constants/alignment":755,"../../lib":787,"../../lib/extend":777,"../../lib/setcursor":808,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../plots/cartesian/axis_defaults":840,"../../plots/cartesian/layout_attributes":853,"../../plots/cartesian/position_defaults":856,"../../plots/plots":901,"../../registry":915,"../color":650,"../colorscale/helpers":661,"../dragelement":669,"../drawing":672,"../titles":748,"./constants":652,"@plotly/d3":58,tinycolor2:583}],655:[function(r,O,B){var t=r("../../lib");O.exports=function(d){return t.isPlainObject(d.colorbar)}},{"../../lib":787}],656:[function(r,O,B){O.exports={moduleType:"component",name:"colorbar",attributes:r("./attributes"),supplyDefaults:r("./defaults"),draw:r("./draw").draw,hasColorbar:r("./has_colorbar")}},{"./attributes":651,"./defaults":653,"./draw":654,"./has_colorbar":655}],657:[function(r,O,B){var t=r("../colorbar/attributes"),d=r("../../lib/regex").counter,m=r("../../lib/sort_object_keys"),p=r("./scales.js").scales;m(p);function e(f){return"`"+f+"`"}O.exports=function(f,u){f=f||"";var s,l=(u=u||{}).cLetter||"c",o=("onlyIfNumerical"in u?u.onlyIfNumerical:Boolean(f),"noScale"in u?u.noScale:f==="marker.line"),i="showScaleDflt"in u?u.showScaleDflt:l==="z",c=typeof u.colorscaleDflt=="string"?p[u.colorscaleDflt]:null,n=u.editTypeOverride||"",a=f?f+".":"";"colorAttr"in u?(s=u.colorAttr,u.colorAttr):e(a+(s={z:"z",c:"color"}[l]));var g=l+"auto",h=l+"min",y=l+"max",v=l+"mid",_={};_[h]=_[y]=void 0;var x={};x[g]=!1;var T={};return s==="color"&&(T.color={valType:"color",arrayOk:!0,editType:n||"style"},u.anim&&(T.color.anim=!0)),T[g]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:_},T[h]={valType:"number",dflt:null,editType:n||"plot",impliedEdits:x},T[y]={valType:"number",dflt:null,editType:n||"plot",impliedEdits:x},T[v]={valType:"number",dflt:null,editType:"calc",impliedEdits:_},T.colorscale={valType:"colorscale",editType:"calc",dflt:c,impliedEdits:{autocolorscale:!1}},T.autocolorscale={valType:"boolean",dflt:u.autoColorDflt!==!1,editType:"calc",impliedEdits:{colorscale:void 0}},T.reversescale={valType:"boolean",dflt:!1,editType:"plot"},o||(T.showscale={valType:"boolean",dflt:i,editType:"calc"},T.colorbar=t),u.noColorAxis||(T.coloraxis={valType:"subplotid",regex:d("coloraxis"),dflt:null,editType:"calc"}),T}},{"../../lib/regex":804,"../../lib/sort_object_keys":810,"../colorbar/attributes":651,"./scales.js":665}],658:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("./helpers").extractOpts;O.exports=function(p,e,f){var u,s=p._fullLayout,l=f.vals,o=f.containerStr,i=o?d.nestedProperty(e,o).get():e,c=m(i),n=c.auto!==!1,a=c.min,g=c.max,h=c.mid,y=function(){return d.aggNums(Math.min,null,l)},v=function(){return d.aggNums(Math.max,null,l)};a===void 0?a=y():n&&(a=i._colorAx&&t(a)?Math.min(a,y()):y()),g===void 0?g=v():n&&(g=i._colorAx&&t(g)?Math.max(g,v()):v()),n&&h!==void 0&&(g-h>h-a?a=h-(g-h):g-h<h-a&&(g=h+(h-a))),a===g&&(a-=.5,g+=.5),c._sync("min",a),c._sync("max",g),c.autocolorscale&&(u=a*g<0?s.colorscale.diverging:a>=0?s.colorscale.sequential:s.colorscale.sequentialminus,c._sync("colorscale",u))}},{"../../lib":787,"./helpers":661,"fast-isnumeric":246}],659:[function(r,O,B){var t=r("../../lib"),d=r("./helpers").hasColorscale,m=r("./helpers").extractOpts;O.exports=function(p,e){function f(n,a){var g=n["_"+a];g!==void 0&&(n[a]=g)}function u(n,a){var g=a.container?t.nestedProperty(n,a.container).get():n;if(g)if(g.coloraxis)g._colorAx=e[g.coloraxis];else{var h=m(g),y=h.auto;(y||h.min===void 0)&&f(g,a.min),(y||h.max===void 0)&&f(g,a.max),h.autocolorscale&&f(g,"colorscale")}}for(var s=0;s<p.length;s++){var l=p[s],o=l._module.colorbar;if(o)if(Array.isArray(o))for(var i=0;i<o.length;i++)u(l,o[i]);else u(l,o);d(l,"marker.line")&&u(l,{container:"marker.line",min:"cmin",max:"cmax"})}for(var c in e._colorAxes)u(e[c],{min:"cmin",max:"cmax"})}},{"../../lib":787,"./helpers":661}],660:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../colorbar/has_colorbar"),p=r("../colorbar/defaults"),e=r("./scales").isValid,f=r("../../registry").traceIs;function u(s,l){var o=l.slice(0,l.length-1);return l?d.nestedProperty(s,o).get()||{}:s}O.exports=function s(l,o,i,c,n){var a=n.prefix,g=n.cLetter,h="_module"in o,y=u(l,a),v=u(o,a),_=u(o._template||{},a)||{},x=function(){return delete l.coloraxis,delete o.coloraxis,s(l,o,i,c,n)};if(h){var T=i._colorAxes||{},A=c(a+"coloraxis");if(A){var S=f(o,"contour")&&d.nestedProperty(o,"contours.coloring").get()||"heatmap",w=T[A];return void(w?(w[2].push(x),w[0]!==S&&(w[0]=!1,d.warn(["Ignoring coloraxis:",A,"setting","as it is linked to incompatible colorscales."].join(" ")))):T[A]=[S,o,[x]])}}var C=y[g+"min"],k=y[g+"max"],L=t(C)&&t(k)&&C<k;c(a+g+"auto",!L)?c(a+g+"mid"):(c(a+g+"min"),c(a+g+"max"));var M,P,D=y.colorscale,N=_.colorscale;D!==void 0&&(M=!e(D)),N!==void 0&&(M=!e(N)),c(a+"autocolorscale",M),c(a+"colorscale"),c(a+"reversescale"),a!=="marker.line."&&(a&&h&&(P=m(y)),c(a+"showscale",P)&&(a&&_&&(v._template=_),p(y,v,i)))}},{"../../lib":787,"../../registry":915,"../colorbar/defaults":653,"../colorbar/has_colorbar":655,"./scales":665,"fast-isnumeric":246}],661:[function(r,O,B){var t=r("@plotly/d3"),d=r("tinycolor2"),m=r("fast-isnumeric"),p=r("../../lib"),e=r("../color"),f=r("./scales").isValid,u=["showscale","autocolorscale","colorscale","reversescale","colorbar"],s=["min","max","mid","auto"];function l(a){var g,h,y,v=a._colorAx,_=v||a,x={};for(h=0;h<u.length;h++)x[y=u[h]]=_[y];if(v)for(g="c",h=0;h<s.length;h++)x[y=s[h]]=_["c"+y];else{var T;for(h=0;h<s.length;h++)((T="c"+(y=s[h]))in _||(T="z"+y)in _)&&(x[y]=_[T]);g=T.charAt(0)}return x._sync=function(A,S){var w=s.indexOf(A)!==-1?g+A:A;_[w]=_["_"+w]=S},x}function o(a){for(var g=l(a),h=g.min,y=g.max,v=g.reversescale?i(g.colorscale):g.colorscale,_=v.length,x=new Array(_),T=new Array(_),A=0;A<_;A++){var S=v[A];x[A]=h+S[0]*(y-h),T[A]=S[1]}return{domain:x,range:T}}function i(a){for(var g=a.length,h=new Array(g),y=g-1,v=0;y>=0;y--,v++){var _=a[y];h[v]=[1-_[0],_[1]]}return h}function c(a,g){g=g||{};for(var h=a.domain,y=a.range,v=y.length,_=new Array(v),x=0;x<v;x++){var T=d(y[x]).toRgb();_[x]=[T.r,T.g,T.b,T.a]}var A,S=t.scale.linear().domain(h).range(_).clamp(!0),w=g.noNumericCheck,C=g.returnArray;return(A=w&&C?S:w?function(k){return n(S(k))}:C?function(k){return m(k)?S(k):d(k).isValid()?k:e.defaultLine}:function(k){return m(k)?n(S(k)):d(k).isValid()?k:e.defaultLine}).domain=S.domain,A.range=function(){return y},A}function n(a){var g={r:a[0],g:a[1],b:a[2],a:a[3]};return d(g).toRgbString()}O.exports={hasColorscale:function(a,g,h){var y=g?p.nestedProperty(a,g).get()||{}:a,v=y[h||"color"],_=!1;if(p.isArrayOrTypedArray(v)){for(var x=0;x<v.length;x++)if(m(v[x])){_=!0;break}}return p.isPlainObject(y)&&(_||y.showscale===!0||m(y.cmin)&&m(y.cmax)||f(y.colorscale)||p.isPlainObject(y.colorbar))},extractOpts:l,extractScale:o,flipScale:i,makeColorScaleFunc:c,makeColorScaleFuncFromTrace:function(a,g){return c(o(a),g)}}},{"../../lib":787,"../color":650,"./scales":665,"@plotly/d3":58,"fast-isnumeric":246,tinycolor2:583}],662:[function(r,O,B){var t=r("./scales"),d=r("./helpers");O.exports={moduleType:"component",name:"colorscale",attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyLayoutDefaults:r("./layout_defaults"),handleDefaults:r("./defaults"),crossTraceDefaults:r("./cross_trace_defaults"),calc:r("./calc"),scales:t.scales,defaultScale:t.defaultScale,getScale:t.get,isValidScale:t.isValid,hasColorscale:d.hasColorscale,extractOpts:d.extractOpts,extractScale:d.extractScale,flipScale:d.flipScale,makeColorScaleFunc:d.makeColorScaleFunc,makeColorScaleFuncFromTrace:d.makeColorScaleFuncFromTrace}},{"./attributes":657,"./calc":658,"./cross_trace_defaults":659,"./defaults":660,"./helpers":661,"./layout_attributes":663,"./layout_defaults":664,"./scales":665}],663:[function(r,O,B){var t=r("../../lib/extend").extendFlat,d=r("./attributes"),m=r("./scales").scales;O.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:m.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:m.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:m.RdBu,editType:"calc"}},coloraxis:t({_isSubplotObj:!0,editType:"calc"},d("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":777,"./attributes":657,"./scales":665}],664:[function(r,O,B){var t=r("../../lib"),d=r("../../plot_api/plot_template"),m=r("./layout_attributes"),p=r("./defaults");O.exports=function(e,f){function u(g,h){return t.coerce(e,f,m,g,h)}u("colorscale.sequential"),u("colorscale.sequentialminus"),u("colorscale.diverging");var s,l,o=f._colorAxes;function i(g,h){return t.coerce(s,l,m.coloraxis,g,h)}for(var c in o){var n=o[c];if(n[0])s=e[c]||{},(l=d.newContainer(f,c,"coloraxis"))._name=c,p(s,l,f,i,{prefix:"",cLetter:"c"});else{for(var a=0;a<n[2].length;a++)n[2][a]();delete f._colorAxes[c]}}}},{"../../lib":787,"../../plot_api/plot_template":827,"./defaults":660,"./layout_attributes":663}],665:[function(r,O,B){var t=r("tinycolor2"),d={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},m=d.RdBu;function p(e){var f=0;if(!Array.isArray(e)||e.length<2||!e[0]||!e[e.length-1]||+e[0][0]!=0||+e[e.length-1][0]!=1)return!1;for(var u=0;u<e.length;u++){var s=e[u];if(s.length!==2||+s[0]<f||!t(s[1]).isValid())return!1;f=+s[0]}return!0}O.exports={scales:d,defaultScale:m,get:function(e,f){if(f||(f=m),!e)return f;function u(){try{e=d[e]||JSON.parse(e)}catch(s){e=f}}return typeof e=="string"&&(u(),typeof e=="string"&&u()),p(e)?e:f},isValid:function(e){return d[e]!==void 0||p(e)}}},{tinycolor2:583}],666:[function(r,O,B){O.exports=function(t,d,m,p,e){var f=(t-m)/(p-m),u=f+d/(p-m),s=(f+u)/2;return e==="left"||e==="bottom"?f:e==="center"||e==="middle"?s:e==="right"||e==="top"?u:f<2/3-s?f:u>4/3-s?u:s}},{}],667:[function(r,O,B){var t=r("../../lib"),d=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];O.exports=function(m,p,e,f){return m=e==="left"?0:e==="center"?1:e==="right"?2:t.constrain(Math.floor(3*m),0,2),p=f==="bottom"?0:f==="middle"?1:f==="top"?2:t.constrain(Math.floor(3*p),0,2),d[p][m]}},{"../../lib":787}],668:[function(r,O,B){B.selectMode=function(t){return t==="lasso"||t==="select"},B.drawMode=function(t){return t==="drawclosedpath"||t==="drawopenpath"||t==="drawline"||t==="drawrect"||t==="drawcircle"},B.openMode=function(t){return t==="drawline"||t==="drawopenpath"},B.rectMode=function(t){return t==="select"||t==="drawline"||t==="drawrect"||t==="drawcircle"},B.freeMode=function(t){return t==="lasso"||t==="drawclosedpath"||t==="drawopenpath"},B.selectingOrDrawing=function(t){return B.freeMode(t)||B.rectMode(t)}},{}],669:[function(r,O,B){var t=r("mouse-event-offset"),d=r("has-hover"),m=r("has-passive-events"),p=r("../../lib").removeElement,e=r("../../plots/cartesian/constants"),f=O.exports={};f.align=r("./align"),f.getCursor=r("./cursor");var u=r("./unhover");function s(){var o=document.createElement("div");o.className="dragcover";var i=o.style;return i.position="fixed",i.left=0,i.right=0,i.top=0,i.bottom=0,i.zIndex=999999999,i.background="none",document.body.appendChild(o),o}function l(o){return t(o.changedTouches?o.changedTouches[0]:o,document.body)}f.unhover=u.wrapped,f.unhoverRaw=u.raw,f.init=function(o){var i,c,n,a,g,h,y,v,_=o.gd,x=1,T=_._context.doubleClickDelay,A=o.element;_._mouseDownTime||(_._mouseDownTime=0),A.style.pointerEvents="all",A.onmousedown=w,m?(A._ontouchstart&&A.removeEventListener("touchstart",A._ontouchstart),A._ontouchstart=w,A.addEventListener("touchstart",w,{passive:!1})):A.ontouchstart=w;var S=o.clampFn||function(L,M,P){return Math.abs(L)<P&&(L=0),Math.abs(M)<P&&(M=0),[L,M]};function w(L){_._dragged=!1,_._dragging=!0;var M=l(L);i=M[0],c=M[1],y=L.target,h=L,v=L.buttons===2||L.ctrlKey,L.clientX===void 0&&L.clientY===void 0&&(L.clientX=i,L.clientY=c),(n=new Date().getTime())-_._mouseDownTime<T?x+=1:(x=1,_._mouseDownTime=n),o.prepFn&&o.prepFn(L,i,c),d&&!v?(g=s()).style.cursor=window.getComputedStyle(A).cursor:d||(g=document,a=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(A).cursor),document.addEventListener("mouseup",k),document.addEventListener("touchend",k),o.dragmode!==!1&&(L.preventDefault(),document.addEventListener("mousemove",C),document.addEventListener("touchmove",C,{passive:!1}))}function C(L){L.preventDefault();var M=l(L),P=o.minDrag||e.MINDRAG,D=S(M[0]-i,M[1]-c,P),N=D[0],U=D[1];(N||U)&&(_._dragged=!0,f.unhover(_,L)),_._dragged&&o.moveFn&&!v&&(_._dragdata={element:A,dx:N,dy:U},o.moveFn(N,U))}function k(L){if(delete _._dragdata,o.dragmode!==!1&&(L.preventDefault(),document.removeEventListener("mousemove",C),document.removeEventListener("touchmove",C)),document.removeEventListener("mouseup",k),document.removeEventListener("touchend",k),d?p(g):a&&(g.documentElement.style.cursor=a,a=null),_._dragging){if(_._dragging=!1,new Date().getTime()-_._mouseDownTime>T&&(x=Math.max(x-1,1)),_._dragged)o.doneFn&&o.doneFn();else if(o.clickFn&&o.clickFn(x,h),!v){var M;try{M=new MouseEvent("click",L)}catch(D){var P=l(L);(M=document.createEvent("MouseEvents")).initMouseEvent("click",L.bubbles,L.cancelable,L.view,L.detail,L.screenX,L.screenY,P[0],P[1],L.ctrlKey,L.altKey,L.shiftKey,L.metaKey,L.button,L.relatedTarget)}y.dispatchEvent(M)}_._dragging=!1,_._dragged=!1}else _._dragged=!1}},f.coverSlip=s},{"../../lib":787,"../../plots/cartesian/constants":845,"./align":666,"./cursor":667,"./unhover":670,"has-hover":435,"has-passive-events":436,"mouse-event-offset":460}],670:[function(r,O,B){var t=r("../../lib/events"),d=r("../../lib/throttle"),m=r("../../lib/dom").getGraphDiv,p=r("../fx/constants"),e=O.exports={};e.wrapped=function(f,u,s){(f=m(f))._fullLayout&&d.clear(f._fullLayout._uid+p.HOVERID),e.raw(f,u,s)},e.raw=function(f,u){var s=f._fullLayout,l=f._hoverdata;u||(u={}),u.target&&!f._dragged&&t.triggerHandler(f,"plotly_beforehover",u)===!1||(s._hoverlayer.selectAll("g").remove(),s._hoverlayer.selectAll("line").remove(),s._hoverlayer.selectAll("circle").remove(),f._hoverdata=void 0,u.target&&l&&f.emit("plotly_unhover",{event:u,points:l}))}},{"../../lib/dom":775,"../../lib/events":776,"../../lib/throttle":814,"../fx/constants":684}],671:[function(r,O,B){B.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},B.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],672:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=d.numberFormat,p=r("fast-isnumeric"),e=r("tinycolor2"),f=r("../../registry"),u=r("../color"),s=r("../colorscale"),l=d.strTranslate,o=r("../../lib/svg_text_utils"),i=r("../../constants/xmlns_namespaces"),c=r("../../constants/alignment").LINE_SPACING,n=r("../../constants/interactions").DESELECTDIM,a=r("../../traces/scatter/subtypes"),g=r("../../traces/scatter/make_bubble_size_func"),h=r("../../components/fx/helpers").appendArrayPointValue,y=O.exports={};y.font=function(Z,H,Y,$){d.isPlainObject(H)&&($=H.color,Y=H.size,H=H.family),H&&Z.style("font-family",H),Y+1&&Z.style("font-size",Y+"px"),$&&Z.call(u.fill,$)},y.setPosition=function(Z,H,Y){Z.attr("x",H).attr("y",Y)},y.setSize=function(Z,H,Y){Z.attr("width",H).attr("height",Y)},y.setRect=function(Z,H,Y,$,z){Z.call(y.setPosition,H,Y).call(y.setSize,$,z)},y.translatePoint=function(Z,H,Y,$){var z=Y.c2p(Z.x),j=$.c2p(Z.y);return!!(p(z)&&p(j)&&H.node())&&(H.node().nodeName==="text"?H.attr("x",z).attr("y",j):H.attr("transform",l(z,j)),!0)},y.translatePoints=function(Z,H,Y){Z.each(function($){var z=t.select(this);y.translatePoint($,z,H,Y)})},y.hideOutsideRangePoint=function(Z,H,Y,$,z,j){H.attr("display",Y.isPtWithinRange(Z,z)&&$.isPtWithinRange(Z,j)?null:"none")},y.hideOutsideRangePoints=function(Z,H){if(H._hasClipOnAxisFalse){var Y=H.xaxis,$=H.yaxis;Z.each(function(z){var j=z[0].trace,W=j.xcalendar,ee=j.ycalendar,J=f.traceIs(j,"bar-like")?".bartext":".point,.textpoint";Z.selectAll(J).each(function(Q){y.hideOutsideRangePoint(Q,t.select(this),Y,$,W,ee)})})}},y.crispRound=function(Z,H,Y){return H&&p(H)?Z._context.staticPlot?H:H<1?1:Math.round(H):Y||0},y.singleLineStyle=function(Z,H,Y,$,z){H.style("fill","none");var j=(((Z||[])[0]||{}).trace||{}).line||{},W=Y||j.width||0,ee=z||j.dash||"";u.stroke(H,$||j.color),y.dashLine(H,ee,W)},y.lineGroupStyle=function(Z,H,Y,$){Z.style("fill","none").each(function(z){var j=(((z||[])[0]||{}).trace||{}).line||{},W=H||j.width||0,ee=$||j.dash||"";t.select(this).call(u.stroke,Y||j.color).call(y.dashLine,ee,W)})},y.dashLine=function(Z,H,Y){Y=+Y||0,H=y.dashStyle(H,Y),Z.style({"stroke-dasharray":H,"stroke-width":Y+"px"})},y.dashStyle=function(Z,H){H=+H||1;var Y=Math.max(H,3);return Z==="solid"?Z="":Z==="dot"?Z=Y+"px,"+Y+"px":Z==="dash"?Z=3*Y+"px,"+3*Y+"px":Z==="longdash"?Z=5*Y+"px,"+5*Y+"px":Z==="dashdot"?Z=3*Y+"px,"+Y+"px,"+Y+"px,"+Y+"px":Z==="longdashdot"&&(Z=5*Y+"px,"+2*Y+"px,"+Y+"px,"+2*Y+"px"),Z},y.singleFillStyle=function(Z){var H=(((t.select(Z.node()).data()[0]||[])[0]||{}).trace||{}).fillcolor;H&&Z.call(u.fill,H)},y.fillGroupStyle=function(Z){Z.style("stroke-width",0).each(function(H){var Y=t.select(this);H[0].trace&&Y.call(u.fill,H[0].trace.fillcolor)})};var v=r("./symbol_defs");y.symbolNames=[],y.symbolFuncs=[],y.symbolNeedLines={},y.symbolNoDot={},y.symbolNoFill={},y.symbolList=[],Object.keys(v).forEach(function(Z){var H=v[Z],Y=H.n;y.symbolList.push(Y,String(Y),Z,Y+100,String(Y+100),Z+"-open"),y.symbolNames[Y]=Z,y.symbolFuncs[Y]=H.f,H.needLine&&(y.symbolNeedLines[Y]=!0),H.noDot?y.symbolNoDot[Y]=!0:y.symbolList.push(Y+200,String(Y+200),Z+"-dot",Y+300,String(Y+300),Z+"-open-dot"),H.noFill&&(y.symbolNoFill[Y]=!0)});var _=y.symbolNames.length;function x(Z,H){var Y=Z%100;return y.symbolFuncs[Y](H)+(Z>=200?"M0,0.5L0.5,0L0,-0.5L-0.5,0Z":"")}y.symbolNumber=function(Z){if(p(Z))Z=+Z;else if(typeof Z=="string"){var H=0;Z.indexOf("-open")>0&&(H=100,Z=Z.replace("-open","")),Z.indexOf("-dot")>0&&(H+=200,Z=Z.replace("-dot","")),(Z=y.symbolNames.indexOf(Z))>=0&&(Z+=H)}return Z%100>=_||Z>=400?0:Math.floor(Math.max(Z,0))};var T={x1:1,x2:0,y1:0,y2:0},A={x1:0,x2:0,y1:1,y2:0},S=m("~f"),w={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:T},horizontalreversed:{node:"linearGradient",attrs:T,reversed:!0},vertical:{node:"linearGradient",attrs:A},verticalreversed:{node:"linearGradient",attrs:A,reversed:!0}};y.gradient=function(Z,H,Y,$,z,j){for(var W=z.length,ee=w[$],J=new Array(W),Q=0;Q<W;Q++)ee.reversed?J[W-1-Q]=[S(100*(1-z[Q][0])),z[Q][1]]:J[Q]=[S(100*z[Q][0]),z[Q][1]];var te=H._fullLayout,ie="g"+te._uid+"-"+Y,ae=te._defs.select(".gradients").selectAll("#"+ie).data([$+J.join(";")],d.identity);ae.exit().remove(),ae.enter().append(ee.node).each(function(){var de=t.select(this);ee.attrs&&de.attr(ee.attrs),de.attr("id",ie);var ue=de.selectAll("stop").data(J);ue.exit().remove(),ue.enter().append("stop"),ue.each(function(ve){var ke=e(ve[1]);t.select(this).attr({offset:ve[0]+"%","stop-color":u.tinyRGB(ke),"stop-opacity":ke.getAlpha()})})}),Z.style(j,q(ie,H)).style(j+"-opacity",null);var he=function(de){return"."+de.attr("class").replace(/\s/g,".")},se=he(t.select(Z.node().parentNode))+">"+he(Z);te._gradientUrlQueryParts[se]=1},y.pattern=function(Z,H,Y,$,z,j,W,ee,J,Q,te,ie){var ae=H==="legend";ee&&(J==="overlay"?(Q=ee,te=u.contrast(Q)):(Q=void 0,te=ee));var he,se,de,ue,ve,ke,Ee,be,xe,ce,ge,we=Y._fullLayout,Me="p"+we._uid+"-"+$,Se={};switch(z){case"/":he=j*Math.sqrt(2),se=j*Math.sqrt(2),ke="path",Se={d:de="M-"+he/4+","+se/4+"l"+he/2+",-"+se/2+"M0,"+se+"L"+he+",0M"+he/4*3+","+se/4*5+"l"+he/2+",-"+se/2,opacity:ie,stroke:te,"stroke-width":(ue=W*j)+"px"};break;case"\\":he=j*Math.sqrt(2),se=j*Math.sqrt(2),ke="path",Se={d:de="M"+he/4*3+",-"+se/4+"l"+he/2+","+se/2+"M0,0L"+he+","+se+"M-"+he/4+","+se/4*3+"l"+he/2+","+se/2,opacity:ie,stroke:te,"stroke-width":(ue=W*j)+"px"};break;case"x":he=j*Math.sqrt(2),se=j*Math.sqrt(2),de="M-"+he/4+","+se/4+"l"+he/2+",-"+se/2+"M0,"+se+"L"+he+",0M"+he/4*3+","+se/4*5+"l"+he/2+",-"+se/2+"M"+he/4*3+",-"+se/4+"l"+he/2+","+se/2+"M0,0L"+he+","+se+"M-"+he/4+","+se/4*3+"l"+he/2+","+se/2,ue=j-j*Math.sqrt(1-W),ke="path",Se={d:de,opacity:ie,stroke:te,"stroke-width":ue+"px"};break;case"|":ke="path",ke="path",Se={d:de="M"+(he=j)/2+",0L"+he/2+","+(se=j),opacity:ie,stroke:te,"stroke-width":(ue=W*j)+"px"};break;case"-":ke="path",ke="path",Se={d:de="M0,"+(se=j)/2+"L"+(he=j)+","+se/2,opacity:ie,stroke:te,"stroke-width":(ue=W*j)+"px"};break;case"+":ke="path",de="M"+(he=j)/2+",0L"+he/2+","+(se=j)+"M0,"+se/2+"L"+he+","+se/2,ue=j-j*Math.sqrt(1-W),ke="path",Se={d:de,opacity:ie,stroke:te,"stroke-width":ue+"px"};break;case".":he=j,se=j,W<Math.PI/4?ve=Math.sqrt(W*j*j/Math.PI):(Ee=W,be=Math.PI/4,xe=1,ce=j/2,ge=j/Math.sqrt(2),ve=ce+(ge-ce)*(Ee-be)/(xe-be)),ke="circle",Se={cx:he/2,cy:se/2,r:ve,opacity:ie,fill:te}}var ze=[z||"noSh",Q||"noBg",te||"noFg",j,W].join(";"),Fe=we._defs.select(".patterns").selectAll("#"+Me).data([ze],d.identity);Fe.exit().remove(),Fe.enter().append("pattern").each(function(){var rt=t.select(this);if(rt.attr({id:Me,width:he+"px",height:se+"px",patternUnits:"userSpaceOnUse",patternTransform:ae?"scale(0.8)":""}),Q){var Oe=rt.selectAll("rect").data([0]);Oe.exit().remove(),Oe.enter().append("rect").attr({width:he+"px",height:se+"px",fill:Q})}var je=rt.selectAll(ke).data([0]);je.exit().remove(),je.enter().append(ke).attr(Se)}),Z.style("fill",q(Me,Y)).style("fill-opacity",null),Z.classed("pattern_filled",!0);var Ye="."+t.select(Z.node().parentNode).attr("class").replace(/\s/g,".")+">.pattern_filled";we._patternUrlQueryParts[Ye]=1},y.initGradients=function(Z){var H=Z._fullLayout;d.ensureSingle(H._defs,"g","gradients").selectAll("linearGradient,radialGradient").remove(),H._gradientUrlQueryParts={}},y.initPatterns=function(Z){var H=Z._fullLayout;d.ensureSingle(H._defs,"g","patterns").selectAll("pattern").remove(),H._patternUrlQueryParts={}},y.getPatternAttr=function(Z,H,Y){return Z&&d.isArrayOrTypedArray(Z)?H<Z.length?Z[H]:Y:Z},y.pointStyle=function(Z,H,Y){if(Z.size()){var $=y.makePointStyleFns(H);Z.each(function(z){y.singlePointStyle(z,t.select(this),H,$,Y)})}},y.singlePointStyle=function(Z,H,Y,$,z){var j=Y.marker,W=j.line;if(H.style("opacity",$.selectedOpacityFn?$.selectedOpacityFn(Z):Z.mo===void 0?j.opacity:Z.mo),$.ms2mrc){var ee;ee=Z.ms==="various"||j.size==="various"?3:$.ms2mrc(Z.ms),Z.mrc=ee,$.selectedSizeFn&&(ee=Z.mrc=$.selectedSizeFn(Z));var J=y.symbolNumber(Z.mx||j.symbol)||0;Z.om=J%200>=100,H.attr("d",x(J,ee))}var Q,te,ie,ae=!1;if(Z.so)ie=W.outlierwidth,te=W.outliercolor,Q=j.outliercolor;else{var he=(W||{}).width;ie=(Z.mlw+1||he+1||(Z.trace?(Z.trace.marker.line||{}).width:0)+1)-1||0,te="mlc"in Z?Z.mlcc=$.lineScale(Z.mlc):d.isArrayOrTypedArray(W.color)?u.defaultLine:W.color,d.isArrayOrTypedArray(j.color)&&(Q=u.defaultLine,ae=!0),Q="mc"in Z?Z.mcc=$.markerScale(Z.mc):j.color||"rgba(0,0,0,0)",$.selectedColorFn&&(Q=$.selectedColorFn(Z))}if(Z.om)H.call(u.stroke,Q).style({"stroke-width":(ie||1)+"px",fill:"none"});else{H.style("stroke-width",(Z.isBlank?0:ie)+"px");var se=j.gradient,de=Z.mgt;de?ae=!0:de=se&&se.type,d.isArrayOrTypedArray(de)&&(de=de[0],w[de]||(de=0));var ue=j.pattern,ve=ue&&y.getPatternAttr(ue.shape,Z.i,"");if(de&&de!=="none"){var ke=Z.mgc;ke?ae=!0:ke=se.color;var Ee=Y.uid;ae&&(Ee+="-"+Z.i),y.gradient(H,z,Ee,de,[[0,ke],[1,Q]],"fill")}else if(ve){var be=y.getPatternAttr(ue.bgcolor,Z.i,null),xe=y.getPatternAttr(ue.fgcolor,Z.i,null),ce=ue.fgopacity,ge=y.getPatternAttr(ue.size,Z.i,8),we=y.getPatternAttr(ue.solidity,Z.i,.3),Me=Z.mcc||d.isArrayOrTypedArray(ue.shape)||d.isArrayOrTypedArray(ue.bgcolor)||d.isArrayOrTypedArray(ue.size)||d.isArrayOrTypedArray(ue.solidity),Se=Y.uid;Me&&(Se+="-"+Z.i),y.pattern(H,"point",z,Se,ve,ge,we,Z.mcc,ue.fillmode,be,xe,ce)}else u.fill(H,Q);ie&&u.stroke(H,te)}},y.makePointStyleFns=function(Z){var H={},Y=Z.marker;return H.markerScale=y.tryColorscale(Y,""),H.lineScale=y.tryColorscale(Y,"line"),f.traceIs(Z,"symbols")&&(H.ms2mrc=a.isBubble(Z)?g(Z):function(){return(Y.size||6)/2}),Z.selectedpoints&&d.extendFlat(H,y.makeSelectedPointStyleFns(Z)),H},y.makeSelectedPointStyleFns=function(Z){var H={},Y=Z.selected||{},$=Z.unselected||{},z=Z.marker||{},j=Y.marker||{},W=$.marker||{},ee=z.opacity,J=j.opacity,Q=W.opacity,te=J!==void 0,ie=Q!==void 0;(d.isArrayOrTypedArray(ee)||te||ie)&&(H.selectedOpacityFn=function(be){var xe=be.mo===void 0?z.opacity:be.mo;return be.selected?te?J:xe:ie?Q:n*xe});var ae=z.color,he=j.color,se=W.color;(he||se)&&(H.selectedColorFn=function(be){var xe=be.mcc||ae;return be.selected?he||xe:se||xe});var de=z.size,ue=j.size,ve=W.size,ke=ue!==void 0,Ee=ve!==void 0;return f.traceIs(Z,"symbols")&&(ke||Ee)&&(H.selectedSizeFn=function(be){var xe=be.mrc||de/2;return be.selected?ke?ue/2:xe:Ee?ve/2:xe}),H},y.makeSelectedTextStyleFns=function(Z){var H={},Y=Z.selected||{},$=Z.unselected||{},z=Z.textfont||{},j=Y.textfont||{},W=$.textfont||{},ee=z.color,J=j.color,Q=W.color;return H.selectedTextColorFn=function(te){var ie=te.tc||ee;return te.selected?J||ie:Q||(J?ie:u.addOpacity(ie,n))},H},y.selectedPointStyle=function(Z,H){if(Z.size()&&H.selectedpoints){var Y=y.makeSelectedPointStyleFns(H),$=H.marker||{},z=[];Y.selectedOpacityFn&&z.push(function(j,W){j.style("opacity",Y.selectedOpacityFn(W))}),Y.selectedColorFn&&z.push(function(j,W){u.fill(j,Y.selectedColorFn(W))}),Y.selectedSizeFn&&z.push(function(j,W){var ee=W.mx||$.symbol||0,J=Y.selectedSizeFn(W);j.attr("d",x(y.symbolNumber(ee),J)),W.mrc2=J}),z.length&&Z.each(function(j){for(var W=t.select(this),ee=0;ee<z.length;ee++)z[ee](W,j)})}},y.tryColorscale=function(Z,H){var Y=H?d.nestedProperty(Z,H).get():Z;if(Y){var $=Y.color;if((Y.colorscale||Y._colorAx)&&d.isArrayOrTypedArray($))return s.makeColorScaleFuncFromTrace(Y)}return d.identity};var C={start:1,end:-1,middle:0,bottom:1,top:-1};function k(Z,H,Y,$){var z=t.select(Z.node().parentNode),j=H.indexOf("top")!==-1?"top":H.indexOf("bottom")!==-1?"bottom":"middle",W=H.indexOf("left")!==-1?"end":H.indexOf("right")!==-1?"start":"middle",ee=$?$/.8+1:0,J=(o.lineCount(Z)-1)*c+1,Q=C[W]*ee,te=.75*Y+C[j]*ee+(C[j]-1)*J*Y/2;Z.attr("text-anchor",W),z.attr("transform",l(Q,te))}function L(Z,H){var Y=Z.ts||H.textfont.size;return p(Y)&&Y>0?Y:0}y.textPointStyle=function(Z,H,Y){if(Z.size()){var $;if(H.selectedpoints){var z=y.makeSelectedTextStyleFns(H);$=z.selectedTextColorFn}var j=H.texttemplate,W=Y._fullLayout;Z.each(function(ee){var J=t.select(this),Q=j?d.extractOption(ee,H,"txt","texttemplate"):d.extractOption(ee,H,"tx","text");if(Q||Q===0){if(j){var te=H._module.formatLabels,ie=te?te(ee,H,W):{},ae={};h(ae,H,ee.i);var he=H._meta||{};Q=d.texttemplateString(Q,ie,W._d3locale,ae,ee,he)}var se=ee.tp||H.textposition,de=L(ee,H),ue=$?$(ee):ee.tc||H.textfont.color;J.call(y.font,ee.tf||H.textfont.family,de,ue).text(Q).call(o.convertToTspans,Y).call(k,se,de,ee.mrc)}else J.remove()})}},y.selectedTextStyle=function(Z,H){if(Z.size()&&H.selectedpoints){var Y=y.makeSelectedTextStyleFns(H);Z.each(function($){var z=t.select(this),j=Y.selectedTextColorFn($),W=$.tp||H.textposition,ee=L($,H);u.fill(z,j),k(z,W,ee,$.mrc2||$.mrc)})}};function M(Z,H,Y,$){var z=Z[0]-H[0],j=Z[1]-H[1],W=Y[0]-H[0],ee=Y[1]-H[1],J=Math.pow(z*z+j*j,.25),Q=Math.pow(W*W+ee*ee,.25),te=(Q*Q*z-J*J*W)*$,ie=(Q*Q*j-J*J*ee)*$,ae=3*Q*(J+Q),he=3*J*(J+Q);return[[t.round(H[0]+(ae&&te/ae),2),t.round(H[1]+(ae&&ie/ae),2)],[t.round(H[0]-(he&&te/he),2),t.round(H[1]-(he&&ie/he),2)]]}y.smoothopen=function(Z,H){if(Z.length<3)return"M"+Z.join("L");var Y,$="M"+Z[0],z=[];for(Y=1;Y<Z.length-1;Y++)z.push(M(Z[Y-1],Z[Y],Z[Y+1],H));for($+="Q"+z[0][0]+" "+Z[1],Y=2;Y<Z.length-1;Y++)$+="C"+z[Y-2][1]+" "+z[Y-1][0]+" "+Z[Y];return $+="Q"+z[Z.length-3][1]+" "+Z[Z.length-1]},y.smoothclosed=function(Z,H){if(Z.length<3)return"M"+Z.join("L")+"Z";var Y,$="M"+Z[0],z=Z.length-1,j=[M(Z[z],Z[0],Z[1],H)];for(Y=1;Y<z;Y++)j.push(M(Z[Y-1],Z[Y],Z[Y+1],H));for(j.push(M(Z[z-1],Z[z],Z[0],H)),Y=1;Y<=z;Y++)$+="C"+j[Y-1][1]+" "+j[Y][0]+" "+Z[Y];return $+="C"+j[z][1]+" "+j[0][0]+" "+Z[0]+"Z"};var P={hv:function(Z,H){return"H"+t.round(H[0],2)+"V"+t.round(H[1],2)},vh:function(Z,H){return"V"+t.round(H[1],2)+"H"+t.round(H[0],2)},hvh:function(Z,H){return"H"+t.round((Z[0]+H[0])/2,2)+"V"+t.round(H[1],2)+"H"+t.round(H[0],2)},vhv:function(Z,H){return"V"+t.round((Z[1]+H[1])/2,2)+"H"+t.round(H[0],2)+"V"+t.round(H[1],2)}},D=function(Z,H){return"L"+t.round(H[0],2)+","+t.round(H[1],2)};y.steps=function(Z){var H=P[Z]||D;return function(Y){for(var $="M"+t.round(Y[0][0],2)+","+t.round(Y[0][1],2),z=1;z<Y.length;z++)$+=H(Y[z-1],Y[z]);return $}},y.makeTester=function(){var Z=d.ensureSingleById(t.select("body"),"svg","js-plotly-tester",function(Y){Y.attr(i.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),H=d.ensureSingle(Z,"path","js-reference-point",function(Y){Y.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});y.tester=Z,y.testref=H},y.savedBBoxes={};var N=0;function U(Z){var H=Z.getAttribute("data-unformatted");if(H!==null)return H+Z.getAttribute("data-math")+Z.getAttribute("text-anchor")+Z.getAttribute("style")}function q(Z,H){if(!Z)return null;var Y=H._context,$=Y._exportedPlot?"":Y._baseUrl||"";return $?"url('"+$+"#"+Z+"')":"url(#"+Z+")"}y.bBox=function(Z,H,Y){var $,z,j;if(Y||(Y=U(Z)),Y){if($=y.savedBBoxes[Y])return d.extendFlat({},$)}else if(Z.childNodes.length===1){var W=Z.childNodes[0];if(Y=U(W)){var ee=+W.getAttribute("x")||0,J=+W.getAttribute("y")||0,Q=W.getAttribute("transform");if(!Q){var te=y.bBox(W,!1,Y);return ee&&(te.left+=ee,te.right+=ee),J&&(te.top+=J,te.bottom+=J),te}if(Y+="~"+ee+"~"+J+"~"+Q,$=y.savedBBoxes[Y])return d.extendFlat({},$)}}H?z=Z:(j=y.tester.node(),z=Z.cloneNode(!0),j.appendChild(z)),t.select(z).attr("transform",null).call(o.positionText,0,0);var ie=z.getBoundingClientRect(),ae=y.testref.node().getBoundingClientRect();H||j.removeChild(z);var he={height:ie.height,width:ie.width,left:ie.left-ae.left,top:ie.top-ae.top,right:ie.right-ae.left,bottom:ie.bottom-ae.top};return N>=1e4&&(y.savedBBoxes={},N=0),Y&&(y.savedBBoxes[Y]=he),N++,d.extendFlat({},he)},y.setClipUrl=function(Z,H,Y){Z.attr("clip-path",q(H,Y))},y.getTranslate=function(Z){var H=(Z[Z.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,function(Y,$,z){return[$,z].join(" ")}).split(" ");return{x:+H[0]||0,y:+H[1]||0}},y.setTranslate=function(Z,H,Y){var $=Z.attr?"attr":"getAttribute",z=Z.attr?"attr":"setAttribute",j=Z[$]("transform")||"";return H=H||0,Y=Y||0,j=j.replace(/(\btranslate\(.*?\);?)/,"").trim(),j=(j+=l(H,Y)).trim(),Z[z]("transform",j),j},y.getScale=function(Z){var H=(Z[Z.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(Y,$,z){return[$,z].join(" ")}).split(" ");return{x:+H[0]||1,y:+H[1]||1}},y.setScale=function(Z,H,Y){var $=Z.attr?"attr":"getAttribute",z=Z.attr?"attr":"setAttribute",j=Z[$]("transform")||"";return H=H||1,Y=Y||1,j=j.replace(/(\bscale\(.*?\);?)/,"").trim(),j=(j+="scale("+H+","+Y+")").trim(),Z[z]("transform",j),j};var X=/\s*sc.*/;y.setPointGroupScale=function(Z,H,Y){if(H=H||1,Y=Y||1,Z){var $=H===1&&Y===1?"":"scale("+H+","+Y+")";Z.each(function(){var z=(this.getAttribute("transform")||"").replace(X,"");z=(z+=$).trim(),this.setAttribute("transform",z)})}};var K=/translate\([^)]*\)\s*$/;y.setTextPointsScale=function(Z,H,Y){Z&&Z.each(function(){var $,z=t.select(this),j=z.select("text");if(j.node()){var W=parseFloat(j.attr("x")||0),ee=parseFloat(j.attr("y")||0),J=(z.attr("transform")||"").match(K);$=H===1&&Y===1?[]:[l(W,ee),"scale("+H+","+Y+")",l(-W,-ee)],J&&$.push(J),z.attr("transform",$.join(""))}})}},{"../../components/fx/helpers":686,"../../constants/alignment":755,"../../constants/interactions":762,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../lib/svg_text_utils":813,"../../registry":915,"../../traces/scatter/make_bubble_size_func":1219,"../../traces/scatter/subtypes":1227,"../color":650,"../colorscale":662,"./symbol_defs":673,"@plotly/d3":58,"fast-isnumeric":246,tinycolor2:583}],673:[function(r,O,B){var t=r("@plotly/d3");O.exports={circle:{n:0,f:function(d){var m=t.round(d,2);return"M"+m+",0A"+m+","+m+" 0 1,1 0,-"+m+"A"+m+","+m+" 0 0,1 "+m+",0Z"}},square:{n:1,f:function(d){var m=t.round(d,2);return"M"+m+","+m+"H-"+m+"V-"+m+"H"+m+"Z"}},diamond:{n:2,f:function(d){var m=t.round(1.3*d,2);return"M"+m+",0L0,"+m+"L-"+m+",0L0,-"+m+"Z"}},cross:{n:3,f:function(d){var m=t.round(.4*d,2),p=t.round(1.2*d,2);return"M"+p+","+m+"H"+m+"V"+p+"H-"+m+"V"+m+"H-"+p+"V-"+m+"H-"+m+"V-"+p+"H"+m+"V-"+m+"H"+p+"Z"}},x:{n:4,f:function(d){var m=t.round(.8*d/Math.sqrt(2),2),p="l"+m+","+m,e="l"+m+",-"+m,f="l-"+m+",-"+m,u="l-"+m+","+m;return"M0,"+m+p+e+f+e+f+u+f+u+p+u+p+"Z"}},"triangle-up":{n:5,f:function(d){var m=t.round(2*d/Math.sqrt(3),2);return"M-"+m+","+t.round(d/2,2)+"H"+m+"L0,-"+t.round(d,2)+"Z"}},"triangle-down":{n:6,f:function(d){var m=t.round(2*d/Math.sqrt(3),2);return"M-"+m+",-"+t.round(d/2,2)+"H"+m+"L0,"+t.round(d,2)+"Z"}},"triangle-left":{n:7,f:function(d){var m=t.round(2*d/Math.sqrt(3),2);return"M"+t.round(d/2,2)+",-"+m+"V"+m+"L-"+t.round(d,2)+",0Z"}},"triangle-right":{n:8,f:function(d){var m=t.round(2*d/Math.sqrt(3),2);return"M-"+t.round(d/2,2)+",-"+m+"V"+m+"L"+t.round(d,2)+",0Z"}},"triangle-ne":{n:9,f:function(d){var m=t.round(.6*d,2),p=t.round(1.2*d,2);return"M-"+p+",-"+m+"H"+m+"V"+p+"Z"}},"triangle-se":{n:10,f:function(d){var m=t.round(.6*d,2),p=t.round(1.2*d,2);return"M"+m+",-"+p+"V"+m+"H-"+p+"Z"}},"triangle-sw":{n:11,f:function(d){var m=t.round(.6*d,2),p=t.round(1.2*d,2);return"M"+p+","+m+"H-"+m+"V-"+p+"Z"}},"triangle-nw":{n:12,f:function(d){var m=t.round(.6*d,2),p=t.round(1.2*d,2);return"M-"+m+","+p+"V-"+m+"H"+p+"Z"}},pentagon:{n:13,f:function(d){var m=t.round(.951*d,2),p=t.round(.588*d,2),e=t.round(-d,2),f=t.round(-.309*d,2);return"M"+m+","+f+"L"+p+","+t.round(.809*d,2)+"H-"+p+"L-"+m+","+f+"L0,"+e+"Z"}},hexagon:{n:14,f:function(d){var m=t.round(d,2),p=t.round(d/2,2),e=t.round(d*Math.sqrt(3)/2,2);return"M"+e+",-"+p+"V"+p+"L0,"+m+"L-"+e+","+p+"V-"+p+"L0,-"+m+"Z"}},hexagon2:{n:15,f:function(d){var m=t.round(d,2),p=t.round(d/2,2),e=t.round(d*Math.sqrt(3)/2,2);return"M-"+p+","+e+"H"+p+"L"+m+",0L"+p+",-"+e+"H-"+p+"L-"+m+",0Z"}},octagon:{n:16,f:function(d){var m=t.round(.924*d,2),p=t.round(.383*d,2);return"M-"+p+",-"+m+"H"+p+"L"+m+",-"+p+"V"+p+"L"+p+","+m+"H-"+p+"L-"+m+","+p+"V-"+p+"Z"}},star:{n:17,f:function(d){var m=1.4*d,p=t.round(.225*m,2),e=t.round(.951*m,2),f=t.round(.363*m,2),u=t.round(.588*m,2),s=t.round(-m,2),l=t.round(-.309*m,2),o=t.round(.118*m,2),i=t.round(.809*m,2);return"M"+p+","+l+"H"+e+"L"+f+","+o+"L"+u+","+i+"L0,"+t.round(.382*m,2)+"L-"+u+","+i+"L-"+f+","+o+"L-"+e+","+l+"H-"+p+"L0,"+s+"Z"}},hexagram:{n:18,f:function(d){var m=t.round(.66*d,2),p=t.round(.38*d,2),e=t.round(.76*d,2);return"M-"+e+",0l-"+p+",-"+m+"h"+e+"l"+p+",-"+m+"l"+p+","+m+"h"+e+"l-"+p+","+m+"l"+p+","+m+"h-"+e+"l-"+p+","+m+"l-"+p+",-"+m+"h-"+e+"Z"}},"star-triangle-up":{n:19,f:function(d){var m=t.round(d*Math.sqrt(3)*.8,2),p=t.round(.8*d,2),e=t.round(1.6*d,2),f=t.round(4*d,2),u="A "+f+","+f+" 0 0 1 ";return"M-"+m+","+p+u+m+","+p+u+"0,-"+e+u+"-"+m+","+p+"Z"}},"star-triangle-down":{n:20,f:function(d){var m=t.round(d*Math.sqrt(3)*.8,2),p=t.round(.8*d,2),e=t.round(1.6*d,2),f=t.round(4*d,2),u="A "+f+","+f+" 0 0 1 ";return"M"+m+",-"+p+u+"-"+m+",-"+p+u+"0,"+e+u+m+",-"+p+"Z"}},"star-square":{n:21,f:function(d){var m=t.round(1.1*d,2),p=t.round(2*d,2),e="A "+p+","+p+" 0 0 1 ";return"M-"+m+",-"+m+e+"-"+m+","+m+e+m+","+m+e+m+",-"+m+e+"-"+m+",-"+m+"Z"}},"star-diamond":{n:22,f:function(d){var m=t.round(1.4*d,2),p=t.round(1.9*d,2),e="A "+p+","+p+" 0 0 1 ";return"M-"+m+",0"+e+"0,"+m+e+m+",0"+e+"0,-"+m+e+"-"+m+",0Z"}},"diamond-tall":{n:23,f:function(d){var m=t.round(.7*d,2),p=t.round(1.4*d,2);return"M0,"+p+"L"+m+",0L0,-"+p+"L-"+m+",0Z"}},"diamond-wide":{n:24,f:function(d){var m=t.round(1.4*d,2),p=t.round(.7*d,2);return"M0,"+p+"L"+m+",0L0,-"+p+"L-"+m+",0Z"}},hourglass:{n:25,f:function(d){var m=t.round(d,2);return"M"+m+","+m+"H-"+m+"L"+m+",-"+m+"H-"+m+"Z"},noDot:!0},bowtie:{n:26,f:function(d){var m=t.round(d,2);return"M"+m+","+m+"V-"+m+"L-"+m+","+m+"V-"+m+"Z"},noDot:!0},"circle-cross":{n:27,f:function(d){var m=t.round(d,2);return"M0,"+m+"V-"+m+"M"+m+",0H-"+m+"M"+m+",0A"+m+","+m+" 0 1,1 0,-"+m+"A"+m+","+m+" 0 0,1 "+m+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(d){var m=t.round(d,2),p=t.round(d/Math.sqrt(2),2);return"M"+p+","+p+"L-"+p+",-"+p+"M"+p+",-"+p+"L-"+p+","+p+"M"+m+",0A"+m+","+m+" 0 1,1 0,-"+m+"A"+m+","+m+" 0 0,1 "+m+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(d){var m=t.round(d,2);return"M0,"+m+"V-"+m+"M"+m+",0H-"+m+"M"+m+","+m+"H-"+m+"V-"+m+"H"+m+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(d){var m=t.round(d,2);return"M"+m+","+m+"L-"+m+",-"+m+"M"+m+",-"+m+"L-"+m+","+m+"M"+m+","+m+"H-"+m+"V-"+m+"H"+m+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(d){var m=t.round(1.3*d,2);return"M"+m+",0L0,"+m+"L-"+m+",0L0,-"+m+"ZM0,-"+m+"V"+m+"M-"+m+",0H"+m},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(d){var m=t.round(1.3*d,2),p=t.round(.65*d,2);return"M"+m+",0L0,"+m+"L-"+m+",0L0,-"+m+"ZM-"+p+",-"+p+"L"+p+","+p+"M-"+p+","+p+"L"+p+",-"+p},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(d){var m=t.round(1.4*d,2);return"M0,"+m+"V-"+m+"M"+m+",0H-"+m},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(d){var m=t.round(d,2);return"M"+m+","+m+"L-"+m+",-"+m+"M"+m+",-"+m+"L-"+m+","+m},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(d){var m=t.round(1.2*d,2),p=t.round(.85*d,2);return"M0,"+m+"V-"+m+"M"+m+",0H-"+m+"M"+p+","+p+"L-"+p+",-"+p+"M"+p+",-"+p+"L-"+p+","+p},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(d){var m=t.round(d/2,2),p=t.round(d,2);return"M"+m+","+p+"V-"+p+"m-"+p+",0V"+p+"M"+p+","+m+"H-"+p+"m0,-"+p+"H"+p},needLine:!0,noFill:!0},"y-up":{n:37,f:function(d){var m=t.round(1.2*d,2),p=t.round(1.6*d,2),e=t.round(.8*d,2);return"M-"+m+","+e+"L0,0M"+m+","+e+"L0,0M0,-"+p+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(d){var m=t.round(1.2*d,2),p=t.round(1.6*d,2),e=t.round(.8*d,2);return"M-"+m+",-"+e+"L0,0M"+m+",-"+e+"L0,0M0,"+p+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(d){var m=t.round(1.2*d,2),p=t.round(1.6*d,2),e=t.round(.8*d,2);return"M"+e+","+m+"L0,0M"+e+",-"+m+"L0,0M-"+p+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(d){var m=t.round(1.2*d,2),p=t.round(1.6*d,2),e=t.round(.8*d,2);return"M-"+e+","+m+"L0,0M-"+e+",-"+m+"L0,0M"+p+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(d){var m=t.round(1.4*d,2);return"M"+m+",0H-"+m},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(d){var m=t.round(1.4*d,2);return"M0,"+m+"V-"+m},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(d){var m=t.round(d,2);return"M"+m+",-"+m+"L-"+m+","+m},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(d){var m=t.round(d,2);return"M"+m+","+m+"L-"+m+",-"+m},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(d){var m=t.round(d,2);return"M0,0L-"+m+","+t.round(2*d,2)+"H"+m+"Z"},noDot:!0},"arrow-down":{n:46,f:function(d){var m=t.round(d,2);return"M0,0L-"+m+",-"+t.round(2*d,2)+"H"+m+"Z"},noDot:!0},"arrow-left":{n:47,f:function(d){var m=t.round(2*d,2),p=t.round(d,2);return"M0,0L"+m+",-"+p+"V"+p+"Z"},noDot:!0},"arrow-right":{n:48,f:function(d){var m=t.round(2*d,2),p=t.round(d,2);return"M0,0L-"+m+",-"+p+"V"+p+"Z"},noDot:!0},"arrow-bar-up":{n:49,f:function(d){var m=t.round(d,2);return"M-"+m+",0H"+m+"M0,0L-"+m+","+t.round(2*d,2)+"H"+m+"Z"},needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(d){var m=t.round(d,2);return"M-"+m+",0H"+m+"M0,0L-"+m+",-"+t.round(2*d,2)+"H"+m+"Z"},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(d){var m=t.round(2*d,2),p=t.round(d,2);return"M0,-"+p+"V"+p+"M0,0L"+m+",-"+p+"V"+p+"Z"},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(d){var m=t.round(2*d,2),p=t.round(d,2);return"M0,-"+p+"V"+p+"M0,0L-"+m+",-"+p+"V"+p+"Z"},needLine:!0,noDot:!0}}},{"@plotly/d3":58}],674:[function(r,O,B){O.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],675:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../registry"),m=r("../../plots/cartesian/axes"),p=r("../../lib"),e=r("./compute_error");function f(u,s,l,o){var i=s["error_"+o]||{},c=[];if(i.visible&&["linear","log"].indexOf(l.type)!==-1){for(var n=e(i),a=0;a<u.length;a++){var g=u[a],h=g.i;if(h===void 0)h=a;else if(h===null)continue;var y=g[o];if(t(l.c2l(y))){var v=n(y,h);if(t(v[0])&&t(v[1])){var _=g[o+"s"]=y-v[0],x=g[o+"h"]=y+v[1];c.push(_,x)}}}var T=l._id,A=s._extremes[T],S=m.findExtremes(l,c,p.extendFlat({tozero:A.opts.tozero},{padded:!0}));A.min=A.min.concat(S.min),A.max=A.max.concat(S.max)}}O.exports=function(u){for(var s=u.calcdata,l=0;l<s.length;l++){var o=s[l],i=o[0].trace;if(i.visible===!0&&d.traceIs(i,"errorBarsOK")){var c=m.getFromId(u,i.xaxis),n=m.getFromId(u,i.yaxis);f(o,i,c,"x"),f(o,i,n,"y")}}}},{"../../lib":787,"../../plots/cartesian/axes":838,"../../registry":915,"./compute_error":676,"fast-isnumeric":246}],676:[function(r,O,B){function t(d,m){return d==="percent"?function(p){return Math.abs(p*m/100)}:d==="constant"?function(){return Math.abs(m)}:d==="sqrt"?function(p){return Math.sqrt(Math.abs(p))}:void 0}O.exports=function(d){var m=d.type,p=d.symmetric;if(m==="data"){var e=d.array||[];if(p)return function(l,o){var i=+e[o];return[i,i]};var f=d.arrayminus||[];return function(l,o){var i=+e[o],c=+f[o];return isNaN(i)&&isNaN(c)?[NaN,NaN]:[c||0,i||0]}}var u=t(m,d.value),s=t(m,d.valueminus);return p||d.valueminus===void 0?function(l){var o=u(l);return[o,o]}:function(l){return[s(l),u(l)]}}},{}],677:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../registry"),m=r("../../lib"),p=r("../../plot_api/plot_template"),e=r("./attributes");O.exports=function(f,u,s,l){var o="error_"+l.axis,i=p.newContainer(u,o),c=f[o]||{};function n(y,v){return m.coerce(c,i,e,y,v)}if(n("visible",c.array!==void 0||c.value!==void 0||c.type==="sqrt")!==!1){var a=n("type","array"in c?"data":"percent"),g=!0;a!=="sqrt"&&(g=n("symmetric",!((a==="data"?"arrayminus":"valueminus")in c))),a==="data"?(n("array"),n("traceref"),g||(n("arrayminus"),n("tracerefminus"))):a!=="percent"&&a!=="constant"||(n("value"),g||n("valueminus"));var h="copy_"+l.inherit+"style";l.inherit&&(u["error_"+l.inherit]||{}).visible&&n(h,!(c.color||t(c.thickness)||t(c.width))),l.inherit&&i[h]||(n("color",s),n("thickness"),n("width",d.traceIs(u,"gl3d")?0:4))}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../registry":915,"./attributes":674,"fast-isnumeric":246}],678:[function(r,O,B){var t=r("../../lib"),d=r("../../plot_api/edit_types").overrideAll,m=r("./attributes"),p={error_x:t.extendFlat({},m),error_y:t.extendFlat({},m)};delete p.error_x.copy_zstyle,delete p.error_y.copy_zstyle,delete p.error_y.copy_ystyle;var e={error_x:t.extendFlat({},m),error_y:t.extendFlat({},m),error_z:t.extendFlat({},m)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,O.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:p,bar:p,histogram:p,scatter3d:d(e,"calc","nested"),scattergl:d(p,"calc","nested")}},supplyDefaults:r("./defaults"),calc:r("./calc"),makeComputeError:r("./compute_error"),plot:r("./plot"),style:r("./style"),hoverInfo:function(f,u,s){(u.error_y||{}).visible&&(s.yerr=f.yh-f.y,u.error_y.symmetric||(s.yerrneg=f.y-f.ys)),(u.error_x||{}).visible&&(s.xerr=f.xh-f.x,u.error_x.symmetric||(s.xerrneg=f.x-f.xs))}}},{"../../lib":787,"../../plot_api/edit_types":820,"./attributes":674,"./calc":675,"./compute_error":676,"./defaults":677,"./plot":679,"./style":680}],679:[function(r,O,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("../drawing"),p=r("../../traces/scatter/subtypes");O.exports=function(e,f,u,s){var l=u.xaxis,o=u.yaxis,i=s&&s.duration>0;f.each(function(c){var n,a=c[0].trace,g=a.error_x||{},h=a.error_y||{};a.ids&&(n=function(x){return x.id});var y=p.hasMarkers(a)&&a.marker.maxdisplayed>0;h.visible||g.visible||(c=[]);var v=t.select(this).selectAll("g.errorbar").data(c,n);if(v.exit().remove(),c.length){g.visible||v.selectAll("path.xerror").remove(),h.visible||v.selectAll("path.yerror").remove(),v.style("opacity",1);var _=v.enter().append("g").classed("errorbar",!0);i&&_.style("opacity",0).transition().duration(s.duration).style("opacity",1),m.setClipUrl(v,u.layerClipId,e),v.each(function(x){var T=t.select(this),A=function(M,P,D){var N={x:P.c2p(M.x),y:D.c2p(M.y)};return M.yh!==void 0&&(N.yh=D.c2p(M.yh),N.ys=D.c2p(M.ys),d(N.ys)||(N.noYS=!0,N.ys=D.c2p(M.ys,!0))),M.xh!==void 0&&(N.xh=P.c2p(M.xh),N.xs=P.c2p(M.xs),d(N.xs)||(N.noXS=!0,N.xs=P.c2p(M.xs,!0))),N}(x,l,o);if(!y||x.vis){var S,w=T.select("path.yerror");if(h.visible&&d(A.x)&&d(A.yh)&&d(A.ys)){var C=h.width;S="M"+(A.x-C)+","+A.yh+"h"+2*C+"m-"+C+",0V"+A.ys,A.noYS||(S+="m-"+C+",0h"+2*C),w.size()?i&&(w=w.transition().duration(s.duration).ease(s.easing)):w=T.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0),w.attr("d",S)}else w.remove();var k=T.select("path.xerror");if(g.visible&&d(A.y)&&d(A.xh)&&d(A.xs)){var L=(g.copy_ystyle?h:g).width;S="M"+A.xh+","+(A.y-L)+"v"+2*L+"m0,-"+L+"H"+A.xs,A.noXS||(S+="m0,-"+L+"v"+2*L),k.size()?i&&(k=k.transition().duration(s.duration).ease(s.easing)):k=T.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0),k.attr("d",S)}else k.remove()}})}})}},{"../../traces/scatter/subtypes":1227,"../drawing":672,"@plotly/d3":58,"fast-isnumeric":246}],680:[function(r,O,B){var t=r("@plotly/d3"),d=r("../color");O.exports=function(m){m.each(function(p){var e=p[0].trace,f=e.error_y||{},u=e.error_x||{},s=t.select(this);s.selectAll("path.yerror").style("stroke-width",f.thickness+"px").call(d.stroke,f.color),u.copy_ystyle&&(u=f),s.selectAll("path.xerror").style("stroke-width",u.thickness+"px").call(d.stroke,u.color)})}},{"../color":650,"@plotly/d3":58}],681:[function(r,O,B){var t=r("../../plots/font_attributes"),d=r("./layout_attributes").hoverlabel,m=r("../../lib/extend").extendFlat;O.exports={hoverlabel:{bgcolor:m({},d.bgcolor,{arrayOk:!0}),bordercolor:m({},d.bordercolor,{arrayOk:!0}),font:t({arrayOk:!0,editType:"none"}),align:m({},d.align,{arrayOk:!0}),namelength:m({},d.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":777,"../../plots/font_attributes":867,"./layout_attributes":691}],682:[function(r,O,B){var t=r("../../lib"),d=r("../../registry");function m(p,e,f,u){u=u||t.identity,Array.isArray(p)&&(e[0][f]=u(p))}O.exports=function(p){var e=p.calcdata,f=p._fullLayout;function u(c){return function(n){return t.coerceHoverinfo({hoverinfo:n},{_module:c._module},f)}}for(var s=0;s<e.length;s++){var l=e[s],o=l[0].trace;if(!d.traceIs(o,"pie-like")){var i=d.traceIs(o,"2dMap")?m:t.fillArray;i(o.hoverinfo,l,"hi",u(o)),o.hovertemplate&&i(o.hovertemplate,l,"ht"),o.hoverlabel&&(i(o.hoverlabel.bgcolor,l,"hbg"),i(o.hoverlabel.bordercolor,l,"hbc"),i(o.hoverlabel.font.size,l,"hts"),i(o.hoverlabel.font.color,l,"htc"),i(o.hoverlabel.font.family,l,"htf"),i(o.hoverlabel.namelength,l,"hnl"),i(o.hoverlabel.align,l,"hta"))}}}},{"../../lib":787,"../../registry":915}],683:[function(r,O,B){var t=r("../../registry"),d=r("./hover").hover;O.exports=function(m,p,e){var f=t.getComponentMethod("annotations","onClick")(m,m._hoverdata);function u(){m.emit("plotly_click",{points:m._hoverdata,event:p})}e!==void 0&&d(m,p,e,!0),m._hoverdata&&p&&p.target&&(f&&f.then?f.then(u):u(),p.stopImmediatePropagation&&p.stopImmediatePropagation())}},{"../../registry":915,"./hover":687}],684:[function(r,O,B){O.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],685:[function(r,O,B){var t=r("../../lib"),d=r("./attributes"),m=r("./hoverlabel_defaults");O.exports=function(p,e,f,u){var s=t.extendFlat({},u.hoverlabel);e.hovertemplate&&(s.namelength=-1),m(p,e,function(l,o){return t.coerce(p,e,d,l,o)},s)}},{"../../lib":787,"./attributes":681,"./hoverlabel_defaults":688}],686:[function(r,O,B){var t=r("../../lib");B.getSubplot=function(u){return u.subplot||u.xaxis+u.yaxis||u.geo},B.isTraceInSubplots=function(u,s){if(u.type==="splom"){for(var l=u.xaxes||[],o=u.yaxes||[],i=0;i<l.length;i++)for(var c=0;c<o.length;c++)if(s.indexOf(l[i]+o[c])!==-1)return!0;return!1}return s.indexOf(B.getSubplot(u))!==-1},B.flat=function(u,s){for(var l=new Array(u.length),o=0;o<u.length;o++)l[o]=s;return l},B.p2c=function(u,s){for(var l=new Array(u.length),o=0;o<u.length;o++)l[o]=u[o].p2c(s);return l},B.getDistanceFunction=function(u,s,l,o){return u==="closest"?o||B.quadrature(s,l):u.charAt(0)==="x"?s:l},B.getClosest=function(u,s,l){if(l.index!==!1)l.index>=0&&l.index<u.length?l.distance=0:l.index=!1;else for(var o=0;o<u.length;o++){var i=s(u[o]);i<=l.distance&&(l.index=o,l.distance=i)}return l},B.inbox=function(u,s,l){return u*s<0||u===0?l:1/0},B.quadrature=function(u,s){return function(l){var o=u(l),i=s(l);return Math.sqrt(o*o+i*i)}},B.makeEventData=function(u,s,l){var o="index"in u?u.index:u.pointNumber,i={data:s._input,fullData:s,curveNumber:s.index,pointNumber:o};if(s._indexToPoints){var c=s._indexToPoints[o];c.length===1?i.pointIndex=c[0]:i.pointIndices=c}else i.pointIndex=o;return s._module.eventData?i=s._module.eventData(i,u,s,l,o):("xVal"in u?i.x=u.xVal:"x"in u&&(i.x=u.x),"yVal"in u?i.y=u.yVal:"y"in u&&(i.y=u.y),u.xa&&(i.xaxis=u.xa),u.ya&&(i.yaxis=u.ya),u.zLabelVal!==void 0&&(i.z=u.zLabelVal)),B.appendArrayPointValue(i,s,o),i},B.appendArrayPointValue=function(u,s,l){var o=s._arrayAttrs;if(o)for(var i=0;i<o.length;i++){var c=o[i],n=m(c);if(u[n]===void 0){var a=p(t.nestedProperty(s,c).get(),l);a!==void 0&&(u[n]=a)}}},B.appendArrayMultiPointValues=function(u,s,l){var o=s._arrayAttrs;if(o)for(var i=0;i<o.length;i++){var c=o[i],n=m(c);if(u[n]===void 0){for(var a=t.nestedProperty(s,c).get(),g=new Array(l.length),h=0;h<l.length;h++)g[h]=p(a,l[h]);u[n]=g}}};var d={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function m(u){return d[u]||u}function p(u,s){return Array.isArray(s)?Array.isArray(u)&&Array.isArray(u[s[0]])?u[s[0]][s[1]]:void 0:u[s]}var e={x:!0,y:!0},f={"x unified":!0,"y unified":!0};B.isUnifiedHover=function(u){return typeof u=="string"&&!!f[u]},B.isXYhover=function(u){return typeof u=="string"&&!!e[u]}},{"../../lib":787}],687:[function(r,O,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("tinycolor2"),p=r("../../lib"),e=p.strTranslate,f=p.strRotate,u=r("../../lib/events"),s=r("../../lib/svg_text_utils"),l=r("../../lib/override_cursor"),o=r("../drawing"),i=r("../color"),c=r("../dragelement"),n=r("../../plots/cartesian/axes"),a=r("../../registry"),g=r("./helpers"),h=r("./constants"),y=r("../legend/defaults"),v=r("../legend/draw"),_=h.YANGLE,x=Math.PI*_/180,T=1/Math.sin(x),A=Math.cos(x),S=Math.sin(x),w=h.HOVERARROWSIZE,C=h.HOVERTEXTPAD,k={box:!0,ohlc:!0,violin:!0,candlestick:!0},L={scatter:!0,scattergl:!0,splom:!0};function M(j){return[j.trace.index,j.index,j.x0,j.y0,j.name,j.attr,j.xa?j.xa._id:"",j.ya?j.ya._id:""].join(",")}B.hover=function(j,W,ee,J){j=p.getGraphDiv(j),p.throttle(j._fullLayout._uid+h.HOVERID,h.HOVERMINTIME,function(){(function(Q,te,ie,ae){ie||(ie="xy");var he=Array.isArray(ie)?ie:[ie],se=Q._fullLayout,de=se._plots||[],ue=de[ie],ve=se._has("cartesian");if(ue){var ke=ue.overlays.map(function(tn){return tn.id});he=he.concat(ke)}for(var Ee=he.length,be=new Array(Ee),xe=new Array(Ee),ce=!1,ge=0;ge<Ee;ge++){var we=he[ge];if(de[we])ce=!0,be[ge]=de[we].xaxis,xe[ge]=de[we].yaxis;else{if(!se[we]||!se[we]._subplot)return void p.warn("Unrecognized subplot: "+we);var Me=se[we]._subplot;be[ge]=Me.xaxis,xe[ge]=Me.yaxis}}var Se=te.hovermode||se.hovermode;if(Se&&!ce&&(Se="closest"),["x","y","closest","x unified","y unified"].indexOf(Se)===-1||!Q.calcdata||Q.querySelector(".zoombox")||Q._dragging)return c.unhoverRaw(Q,te);var ze=se.hoverdistance;ze===-1&&(ze=1/0);var Fe=se.spikedistance;Fe===-1&&(Fe=1/0);var Ye,rt,Oe,je,We,qe,Qe,st,ct,Pt,kt,at,tt,_t=[],er=[],tr={hLinePoint:null,vLinePoint:null},Ue=!1;if(Array.isArray(te))for(Se="array",Oe=0;Oe<te.length;Oe++)(We=Q.calcdata[te[Oe].curveNumber||0])&&(qe=We[0].trace,We[0].trace.hoverinfo!=="skip"&&(er.push(We),qe.orientation==="h"&&(Ue=!0)));else{for(je=0;je<Q.calcdata.length;je++)We=Q.calcdata[je],(qe=We[0].trace).hoverinfo!=="skip"&&g.isTraceInSubplots(qe,he)&&(er.push(We),qe.orientation==="h"&&(Ue=!0));var He,Be;if(!te.target)He="xpx"in te?te.xpx:be[0]._length/2,Be="ypx"in te?te.ypx:xe[0]._length/2;else{if(u.triggerHandler(Q,"plotly_beforehover",te)===!1)return;var Ke=te.composedPath&&te.composedPath()[0];Ke||(Ke=te.target);var _e=Ke.getBoundingClientRect();He=te.clientX-_e.left,Be=te.clientY-_e.top,se._calcInverseTransform(Q);var Ce=p.apply3DTransform(se._invTransform)(He,Be);if(He=Ce[0],Be=Ce[1],He<0||He>be[0]._length||Be<0||Be>xe[0]._length)return c.unhoverRaw(Q,te)}if(te.pointerX=He+be[0]._offset,te.pointerY=Be+xe[0]._offset,Ye="xval"in te?g.flat(he,te.xval):g.p2c(be,He),rt="yval"in te?g.flat(he,te.yval):g.p2c(xe,Be),!d(Ye[0])||!d(rt[0]))return p.warn("Fx.hover failed",te,Q),c.unhoverRaw(Q,te)}var Le=1/0;function Pe(tn,Qr){for(je=0;je<er.length;je++)if((We=er[je])&&We[0]&&We[0].trace&&(qe=We[0].trace).visible===!0&&qe._length!==0&&["carpet","contourcarpet"].indexOf(qe._module.name)===-1){if(qe.type==="splom"?Qe=he[st=0]:(Qe=g.getSubplot(qe),st=he.indexOf(Qe)),ct=Se,g.isUnifiedHover(ct)&&(ct=ct.charAt(0)),at={cd:We,trace:qe,xa:be[st],ya:xe[st],maxHoverDistance:ze,maxSpikeDistance:Fe,index:!1,distance:Math.min(Le,ze),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:i.defaultLine,name:qe.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},se[Qe]&&(at.subplot=se[Qe]._subplot),se._splomScenes&&se._splomScenes[qe.uid]&&(at.scene=se._splomScenes[qe.uid]),tt=_t.length,ct==="array"){var rn=te[je];"pointNumber"in rn?(at.index=rn.pointNumber,ct="closest"):(ct="","xval"in rn&&(Pt=rn.xval,ct="x"),"yval"in rn&&(kt=rn.yval,ct=ct?"closest":"y"))}else tn!==void 0&&Qr!==void 0?(Pt=tn,kt=Qr):(Pt=Ye[st],kt=rt[st]);if(ze!==0)if(qe._module&&qe._module.hoverPoints){var An=qe._module.hoverPoints(at,Pt,kt,ct,{finiteRange:!0,hoverLayer:se._hoverlayer});if(An)for(var En,Bn=0;Bn<An.length;Bn++)En=An[Bn],d(En.x0)&&d(En.y0)&&_t.push(q(En,Se))}else p.log("Unrecognized trace type in hover:",qe);if(Se==="closest"&&_t.length>tt&&(_t.splice(0,tt),Le=_t[0].distance),ve&&Fe!==0&&_t.length===0){at.distance=Fe,at.index=!1;var Jt=qe._module.hoverPoints(at,Pt,kt,"closest",{hoverLayer:se._hoverlayer});if(Jt&&(Jt=Jt.filter(function(Vr){return Vr.spikeDistance<=Fe})),Jt&&Jt.length){var It,qt=Jt.filter(function(Vr){return Vr.xa.showspikes&&Vr.xa.spikesnap!=="hovered data"});if(qt.length){var fr=qt[0];d(fr.x0)&&d(fr.y0)&&(It=ht(fr),(!tr.vLinePoint||tr.vLinePoint.spikeDistance>It.spikeDistance)&&(tr.vLinePoint=It))}var Tr=Jt.filter(function(Vr){return Vr.ya.showspikes&&Vr.ya.spikesnap!=="hovered data"});if(Tr.length){var Gr=Tr[0];d(Gr.x0)&&d(Gr.y0)&&(It=ht(Gr),(!tr.hLinePoint||tr.hLinePoint.spikeDistance>It.spikeDistance)&&(tr.hLinePoint=It))}}}}}function Xe(tn,Qr,rn){for(var An,En=null,Bn=1/0,Jt=0;Jt<tn.length;Jt++)An=tn[Jt].spikeDistance,rn&&Jt===0&&(An=-1/0),An<=Bn&&An<=Qr&&(En=tn[Jt],Bn=An);return En}function ht(tn){return tn?{xa:tn.xa,ya:tn.ya,x:tn.xSpike!==void 0?tn.xSpike:(tn.x0+tn.x1)/2,y:tn.ySpike!==void 0?tn.ySpike:(tn.y0+tn.y1)/2,distance:tn.distance,spikeDistance:tn.spikeDistance,curveNumber:tn.trace.index,color:tn.color,pointNumber:tn.index}:null}Pe();var Mt={fullLayout:se,container:se._hoverlayer,event:te},pt=Q._spikepoints,Lt={vLinePoint:tr.vLinePoint,hLinePoint:tr.hLinePoint};Q._spikepoints=Lt;var vt=function(){_t.sort(function(tn,Qr){return tn.distance-Qr.distance}),_t=function(tn,Qr){for(var rn=Qr.charAt(0),An=[],En=[],Bn=[],Jt=0;Jt<tn.length;Jt++){var It=tn[Jt];a.traceIs(It.trace,"bar-like")||a.traceIs(It.trace,"box-violin")?Bn.push(It):It.trace[rn+"period"]?En.push(It):An.push(It)}return An.concat(En).concat(Bn)}(_t,Se)};vt();var Dt=Se.charAt(0),xt=(Dt==="x"||Dt==="y")&&_t[0]&&L[_t[0].trace.type];if(ve&&Fe!==0&&_t.length!==0){var it=Xe(_t.filter(function(tn){return tn.ya.showspikes}),Fe,xt);tr.hLinePoint=ht(it);var St=Xe(_t.filter(function(tn){return tn.xa.showspikes}),Fe,xt);tr.vLinePoint=ht(St)}if(_t.length===0){var Nt=c.unhoverRaw(Q,te);return!ve||tr.hLinePoint===null&&tr.vLinePoint===null||K(pt)&&X(Q,tr,Mt),Nt}if(ve&&K(pt)&&X(Q,tr,Mt),g.isXYhover(ct)&&_t[0].length!==0&&_t[0].trace.type!=="splom"){var Ut=_t[0],Qt=(_t=k[Ut.trace.type]?_t.filter(function(tn){return tn.trace.index===Ut.trace.index}):[Ut]).length,Ie=H("x",Ut,se),lt=H("y",Ut,se);Pe(Ie,lt);var wt,Ot=[],Gt={},ir=0,Xt=function(tn){var Qr=k[tn.trace.type]?M(tn):tn.trace.index;if(Gt[Qr]){var rn=Gt[Qr]-1,An=Ot[rn];rn>0&&Math.abs(tn.distance)<Math.abs(An.distance)&&(Ot[rn]=tn)}else ir++,Gt[Qr]=ir,Ot.push(tn)};for(wt=0;wt<Qt;wt++)Xt(_t[wt]);for(wt=_t.length-1;wt>Qt-1;wt--)Xt(_t[wt]);_t=Ot,vt()}var Kt=Q._hoverdata,or=[],dr=Y(Q),vr=$(Q);for(Oe=0;Oe<_t.length;Oe++){var ur=_t[Oe],pr=g.makeEventData(ur,ur.trace,ur.cd);if(ur.hovertemplate!==!1){var br=!1;ur.cd[ur.index]&&ur.cd[ur.index].ht&&(br=ur.cd[ur.index].ht),ur.hovertemplate=br||ur.trace.hovertemplate||!1}if(ur.xa&&ur.ya){var Rr=ur.x0+ur.xa._offset,_r=ur.x1+ur.xa._offset,jr=ur.y0+ur.ya._offset,$r=ur.y1+ur.ya._offset,pn=Math.min(Rr,_r),In=Math.max(Rr,_r),On=Math.min(jr,$r),Sn=Math.max(jr,$r);pr.bbox={x0:pn+vr,x1:In+vr,y0:On+dr,y1:Sn+dr}}ur.eventData=[pr],or.push(pr)}Q._hoverdata=or;var an=Se==="y"&&(er.length>1||_t.length>1)||Se==="closest"&&Ue&&_t.length>1,Nr=i.combine(se.plot_bgcolor||i.background,se.paper_bgcolor),Pr=D(_t,{gd:Q,hovermode:Se,rotateLabels:an,bgColor:Nr,container:se._hoverlayer,outerContainer:se._paper.node(),commonLabelOpts:se.hoverlabel,hoverdistance:se.hoverdistance});if(g.isUnifiedHover(Se)||(function(tn,Qr,rn){var An,En,Bn,Jt,It,qt,fr,Tr=0,Gr=1,Vr=tn.size(),xr=new Array(Vr),wr=0;function Sr(Dr){var Wr=Dr[0],vn=Dr[Dr.length-1];if(En=Wr.pmin-Wr.pos-Wr.dp+Wr.size,Bn=vn.pos+vn.dp+vn.size-Wr.pmax,En>.01){for(It=Dr.length-1;It>=0;It--)Dr[It].dp+=En;An=!1}if(!(Bn<.01)){if(En<-.01){for(It=Dr.length-1;It>=0;It--)Dr[It].dp-=Bn;An=!1}if(An){var dn=0;for(Jt=0;Jt<Dr.length;Jt++)(qt=Dr[Jt]).pos+qt.dp+qt.size>Wr.pmax&&dn++;for(Jt=Dr.length-1;Jt>=0&&!(dn<=0);Jt--)(qt=Dr[Jt]).pos>Wr.pmax-1&&(qt.del=!0,dn--);for(Jt=0;Jt<Dr.length&&!(dn<=0);Jt++)if((qt=Dr[Jt]).pos<Wr.pmin+1)for(qt.del=!0,dn--,Bn=2*qt.size,It=Dr.length-1;It>=0;It--)Dr[It].dp-=Bn;for(Jt=Dr.length-1;Jt>=0&&!(dn<=0);Jt--)(qt=Dr[Jt]).pos+qt.dp+qt.size>Wr.pmax&&(qt.del=!0,dn--)}}}for(tn.each(function(Dr){var Wr=Dr[Qr],vn=Wr._id.charAt(0)==="x",dn=Wr.range;wr===0&&dn&&dn[0]>dn[1]!==vn&&(Gr=-1),xr[wr++]=[{datum:Dr,traceIndex:Dr.trace.index,dp:0,pos:Dr.pos,posref:Dr.posref,size:Dr.by*(vn?T:1)/2,pmin:0,pmax:vn?rn.width:rn.height}]}),xr.sort(function(Dr,Wr){return Dr[0].posref-Wr[0].posref||Gr*(Wr[0].traceIndex-Dr[0].traceIndex)});!An&&Tr<=Vr;){for(Tr++,An=!0,Jt=0;Jt<xr.length-1;){var Mr=xr[Jt],Ir=xr[Jt+1],qr=Mr[Mr.length-1],cn=Ir[0];if((En=qr.pos+qr.dp+qr.size-cn.pos-cn.dp+cn.size)>.01&&qr.pmin===cn.pmin&&qr.pmax===cn.pmax){for(It=Ir.length-1;It>=0;It--)Ir[It].dp+=En;for(Mr.push.apply(Mr,Ir),xr.splice(Jt+1,1),fr=0,It=Mr.length-1;It>=0;It--)fr+=Mr[It].dp;for(Bn=fr/Mr.length,It=Mr.length-1;It>=0;It--)Mr[It].dp-=Bn;An=!1}else Jt++}xr.forEach(Sr)}for(Jt=xr.length-1;Jt>=0;Jt--){var _n=xr[Jt];for(It=_n.length-1;It>=0;It--){var Jr=_n[It],bn=Jr.datum;bn.offset=Jr.dp,bn.del=Jr.del}}}(Pr,an?"xa":"ya",se),U(Pr,an,se._invScaleX,se._invScaleY)),te.target&&te.target.tagName){var en=a.getComponentMethod("annotations","hasClickToShow")(Q,or);l(t.select(te.target),en?"pointer":"")}!te.target||ae||!function(tn,Qr,rn){if(!rn||rn.length!==tn._hoverdata.length)return!0;for(var An=rn.length-1;An>=0;An--){var En=rn[An],Bn=tn._hoverdata[An];if(En.curveNumber!==Bn.curveNumber||String(En.pointNumber)!==String(Bn.pointNumber)||String(En.pointNumbers)!==String(Bn.pointNumbers))return!0}return!1}(Q,0,Kt)||(Kt&&Q.emit("plotly_unhover",{event:te,points:Kt}),Q.emit("plotly_hover",{event:te,points:Q._hoverdata,xaxes:be,yaxes:xe,xvals:Ye,yvals:rt}))})(j,W,ee,J)})},B.loneHover=function(j,W){var ee=!0;Array.isArray(j)||(ee=!1,j=[j]);var J=W.gd,Q=Y(J),te=$(J),ie=D(j.map(function(se){var de=se._x0||se.x0||se.x||0,ue=se._x1||se.x1||se.x||0,ve=se._y0||se.y0||se.y||0,ke=se._y1||se.y1||se.y||0,Ee=se.eventData;if(Ee){var be=Math.min(de,ue),xe=Math.max(de,ue),ce=Math.min(ve,ke),ge=Math.max(ve,ke),we=se.trace;if(a.traceIs(we,"gl3d")){var Me=J._fullLayout[we.scene]._scene.container,Se=Me.offsetLeft,ze=Me.offsetTop;be+=Se,xe+=Se,ce+=ze,ge+=ze}Ee.bbox={x0:be+te,x1:xe+te,y0:ce+Q,y1:ge+Q},W.inOut_bbox&&W.inOut_bbox.push(Ee.bbox)}else Ee=!1;return{color:se.color||i.defaultLine,x0:se.x0||se.x||0,x1:se.x1||se.x||0,y0:se.y0||se.y||0,y1:se.y1||se.y||0,xLabel:se.xLabel,yLabel:se.yLabel,zLabel:se.zLabel,text:se.text,name:se.name,idealAlign:se.idealAlign,borderColor:se.borderColor,fontFamily:se.fontFamily,fontSize:se.fontSize,fontColor:se.fontColor,nameLength:se.nameLength,textAlign:se.textAlign,trace:se.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:se.hovertemplate||!1,hovertemplateLabels:se.hovertemplateLabels||!1,eventData:Ee}}),{gd:J,hovermode:"closest",rotateLabels:!1,bgColor:W.bgColor||i.background,container:t.select(W.container),outerContainer:W.outerContainer||W.container}),ae=0,he=0;return ie.sort(function(se,de){return se.y0-de.y0}).each(function(se,de){var ue=se.y0-se.by/2;se.offset=ue-5<ae?ae-ue+5:0,ae=ue+se.by+se.offset,de===W.anchorIndex&&(he=se.offset)}).each(function(se){se.offset-=he}),U(ie,!1,J._fullLayout._invScaleX,J._fullLayout._invScaleY),ee?ie:ie.node()};var P=/<extra>([\s\S]*)<\/extra>/;function D(j,W){var ee=W.gd,J=ee._fullLayout,Q=W.hovermode,te=W.rotateLabels,ie=W.bgColor,ae=W.container,he=W.outerContainer,se=W.commonLabelOpts||{},de=W.fontFamily||h.HOVERFONT,ue=W.fontSize||h.HOVERFONTSIZE,ve=j[0],ke=ve.xa,Ee=ve.ya,be=Q.charAt(0),xe=ve[be+"Label"],ce=z(ee,he),ge=ce.top,we=ce.width,Me=ce.height,Se=xe!==void 0&&ve.distance<=W.hoverdistance&&(Q==="x"||Q==="y");if(Se){var ze,Fe,Ye=!0;for(ze=0;ze<j.length;ze++)if(Ye&&j[ze].zLabel===void 0&&(Ye=!1),Fe=j[ze].hoverinfo||j[ze].trace.hoverinfo){var rt=Array.isArray(Fe)?Fe:Fe.split("+");if(rt.indexOf("all")===-1&&rt.indexOf(Q)===-1){Se=!1;break}}Ye&&(Se=!1)}var Oe=ae.selectAll("g.axistext").data(Se?[0]:[]);if(Oe.enter().append("g").classed("axistext",!0),Oe.exit().remove(),Oe.each(function(){var xt=t.select(this),it=p.ensureSingle(xt,"path","",function(_r){_r.style({"stroke-width":"1px"})}),St=p.ensureSingle(xt,"text","",function(_r){_r.attr("data-notex",1)}),Nt=se.bgcolor||i.defaultLine,Ut=se.bordercolor||i.contrast(Nt),Qt=i.contrast(Nt),Ie={family:se.font.family||de,size:se.font.size||ue,color:se.font.color||Qt};it.style({fill:Nt,stroke:Ut}),St.text(xe).call(o.font,Ie).call(s.positionText,0,0).call(s.convertToTspans,ee),xt.attr("transform","");var lt,wt,Ot=z(ee,St.node());if(Q==="x"){var Gt=ke.side==="top"?"-":"";St.attr("text-anchor","middle").call(s.positionText,0,ke.side==="top"?ge-Ot.bottom-w-C:ge-Ot.top+w+C),lt=ke._offset+(ve.x0+ve.x1)/2,wt=Ee._offset+(ke.side==="top"?0:Ee._length);var ir=Ot.width/2+C;lt<ir?(lt=ir,it.attr("d","M-"+(ir-w)+",0L-"+(ir-2*w)+","+Gt+w+"H"+(C+Ot.width/2)+"v"+Gt+(2*C+Ot.height)+"H-"+ir+"V"+Gt+w+"Z")):lt>J.width-ir?(lt=J.width-ir,it.attr("d","M"+(ir-w)+",0L"+ir+","+Gt+w+"v"+Gt+(2*C+Ot.height)+"H-"+ir+"V"+Gt+w+"H"+(ir-2*w)+"Z")):it.attr("d","M0,0L"+w+","+Gt+w+"H"+(C+Ot.width/2)+"v"+Gt+(2*C+Ot.height)+"H-"+(C+Ot.width/2)+"V"+Gt+w+"H-"+w+"Z")}else{var Xt,Kt,or;Ee.side==="right"?(Xt="start",Kt=1,or="",lt=ke._offset+ke._length):(Xt="end",Kt=-1,or="-",lt=ke._offset),wt=Ee._offset+(ve.y0+ve.y1)/2,St.attr("text-anchor",Xt),it.attr("d","M0,0L"+or+w+","+w+"V"+(C+Ot.height/2)+"h"+or+(2*C+Ot.width)+"V-"+(C+Ot.height/2)+"H"+or+w+"V-"+w+"Z");var dr,vr=Ot.height/2,ur=ge-Ot.top-vr,pr="clip"+J._uid+"commonlabel"+Ee._id;if(lt<Ot.width+2*C+w){dr="M-"+(w+C)+"-"+vr+"h-"+(Ot.width-C)+"V"+vr+"h"+(Ot.width-C)+"Z";var br=Ot.width-lt+C;s.positionText(St,br,ur),Xt==="end"&&St.selectAll("tspan").each(function(){var _r=t.select(this),jr=o.tester.append("text").text(_r.text()).call(o.font,Ie),$r=z(ee,jr.node());Math.round($r.width)<Math.round(Ot.width)&&_r.attr("x",br-$r.width),jr.remove()})}else s.positionText(St,Kt*(C+w),ur),dr=null;var Rr=J._topclips.selectAll("#"+pr).data(dr?[0]:[]);Rr.enter().append("clipPath").attr("id",pr).append("path"),Rr.exit().remove(),Rr.select("path").attr("d",dr),o.setClipUrl(St,dr?pr:null,ee)}xt.attr("transform",e(lt,wt))}),g.isUnifiedHover(Q)){if(ae.selectAll("g.hovertext").remove(),j.length===0)return;var je=J.hoverlabel,We=je.font,qe={showlegend:!0,legend:{title:{text:xe,font:We},font:We,bgcolor:je.bgcolor,bordercolor:je.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:J.legend?J.legend.traceorder:void 0,orientation:"v"}},Qe={};y(qe,Qe,ee._fullData);var st=Qe.legend;st.entries=[];for(var ct=0;ct<j.length;ct++){var Pt=N(j[ct],!0,Q,J,xe),kt=Pt[0],at=Pt[1],tt=j[ct];tt.name=at,tt.text=at!==""?at+" : "+kt:kt;var _t=tt.cd[tt.index];_t&&(_t.mc&&(tt.mc=_t.mc),_t.mcc&&(tt.mc=_t.mcc),_t.mlc&&(tt.mlc=_t.mlc),_t.mlcc&&(tt.mlc=_t.mlcc),_t.mlw&&(tt.mlw=_t.mlw),_t.mrc&&(tt.mrc=_t.mrc),_t.dir&&(tt.dir=_t.dir)),tt._distinct=!0,st.entries.push([tt])}st.entries.sort(function(xt,it){return xt[0].trace.index-it[0].trace.index}),st.layer=ae,st._inHover=!0,st._groupTitleFont=We,v(ee,st);var er,tr,Ue,He,Be=ae.select("g.legend"),Ke=z(ee,Be.node()),_e=Ke.width+2*C,Ce=Ke.height+2*C,Le=j[0],Pe=(Le.x0+Le.x1)/2,Xe=(Le.y0+Le.y1)/2,ht=!(a.traceIs(Le.trace,"bar-like")||a.traceIs(Le.trace,"box-violin"));be==="y"?ht?(tr=Xe-C,er=Xe+C):(tr=Math.min.apply(null,j.map(function(xt){return Math.min(xt.y0,xt.y1)})),er=Math.max.apply(null,j.map(function(xt){return Math.max(xt.y0,xt.y1)}))):tr=er=p.mean(j.map(function(xt){return(xt.y0+xt.y1)/2}))-Ce/2,be==="x"?ht?(Ue=Pe+C,He=Pe-C):(Ue=Math.max.apply(null,j.map(function(xt){return Math.max(xt.x0,xt.x1)})),He=Math.min.apply(null,j.map(function(xt){return Math.min(xt.x0,xt.x1)}))):Ue=He=p.mean(j.map(function(xt){return(xt.x0+xt.x1)/2}))-_e/2;var Mt,pt,Lt=ke._offset,vt=Ee._offset;return He+=Lt-_e,tr+=vt-Ce,Mt=(Ue+=Lt)+_e<we&&Ue>=0?Ue:He+_e<we&&He>=0?He:Lt+_e<we?Lt:Ue-Pe<Pe-He+_e?we-_e:0,Mt+=C,pt=(er+=vt)+Ce<Me&&er>=0?er:tr+Ce<Me&&tr>=0?tr:vt+Ce<Me?vt:er-Xe<Xe-tr+Ce?Me-Ce:0,pt+=C,Be.attr("transform",e(Mt-1,pt-1)),Be}var Dt=ae.selectAll("g.hovertext").data(j,function(xt){return M(xt)});return Dt.enter().append("g").classed("hovertext",!0).each(function(){var xt=t.select(this);xt.append("rect").call(i.fill,i.addOpacity(ie,.8)),xt.append("text").classed("name",!0),xt.append("path").style("stroke-width","1px"),xt.append("text").classed("nums",!0).call(o.font,de,ue)}),Dt.exit().remove(),Dt.each(function(xt){var it=t.select(this).attr("transform",""),St=xt.color;Array.isArray(St)&&(St=St[xt.eventData[0].pointNumber]);var Nt=xt.bgcolor||St,Ut=i.combine(i.opacity(Nt)?Nt:i.defaultLine,ie),Qt=i.combine(i.opacity(St)?St:i.defaultLine,ie),Ie=xt.borderColor||i.contrast(Ut),lt=N(xt,Se,Q,J,xe,it),wt=lt[0],Ot=lt[1],Gt=it.select("text.nums").call(o.font,xt.fontFamily||de,xt.fontSize||ue,xt.fontColor||Ie).text(wt).attr("data-notex",1).call(s.positionText,0,0).call(s.convertToTspans,ee),ir=it.select("text.name"),Xt=0,Kt=0;if(Ot&&Ot!==wt){ir.call(o.font,xt.fontFamily||de,xt.fontSize||ue,Qt).text(Ot).attr("data-notex",1).call(s.positionText,0,0).call(s.convertToTspans,ee);var or=z(ee,ir.node());Xt=or.width+2*C,Kt=or.height+2*C}else ir.remove(),it.select("rect").remove();it.select("path").style({fill:Ut,stroke:Ie});var dr=xt.xa._offset+(xt.x0+xt.x1)/2,vr=xt.ya._offset+(xt.y0+xt.y1)/2,ur=Math.abs(xt.x1-xt.x0),pr=Math.abs(xt.y1-xt.y0),br=z(ee,Gt.node()),Rr=br.width/J._invScaleX,_r=br.height/J._invScaleY;xt.ty0=(ge-br.top)/J._invScaleY,xt.bx=Rr+2*C,xt.by=Math.max(_r+2*C,Kt),xt.anchor="start",xt.txwidth=Rr,xt.tx2width=Xt,xt.offset=0;var jr,$r,pn=(Rr+w+C+Xt)*J._invScaleX;if(te)xt.pos=dr,jr=vr+pr/2+pn<=Me,$r=vr-pr/2-pn>=0,xt.idealAlign!=="top"&&jr||!$r?jr?(vr+=pr/2,xt.anchor="start"):xt.anchor="middle":(vr-=pr/2,xt.anchor="end");else if(xt.pos=vr,jr=dr+ur/2+pn<=we,$r=dr-ur/2-pn>=0,xt.idealAlign!=="left"&&jr||!$r)if(jr)dr+=ur/2,xt.anchor="start";else{xt.anchor="middle";var In=pn/2,On=dr+In-we,Sn=dr-In;On>0&&(dr-=On),Sn<0&&(dr+=-Sn)}else dr-=ur/2,xt.anchor="end";Gt.attr("text-anchor",xt.anchor),Xt&&ir.attr("text-anchor",xt.anchor),it.attr("transform",e(dr,vr)+(te?f(_):""))}),Dt}function N(j,W,ee,J,Q,te){var ie="",ae="";j.nameOverride!==void 0&&(j.name=j.nameOverride),j.name&&(j.trace._meta&&(j.name=p.templateString(j.name,j.trace._meta)),ie=Z(j.name,j.nameLength));var he=ee.charAt(0),se=he==="x"?"y":"x";j.zLabel!==void 0?(j.xLabel!==void 0&&(ae+="x: "+j.xLabel+"<br>"),j.yLabel!==void 0&&(ae+="y: "+j.yLabel+"<br>"),j.trace.type!=="choropleth"&&j.trace.type!=="choroplethmapbox"&&(ae+=(ae?"z: ":"")+j.zLabel)):W&&j[he+"Label"]===Q?ae=j[se+"Label"]||"":j.xLabel===void 0?j.yLabel!==void 0&&j.trace.type!=="scattercarpet"&&(ae=j.yLabel):ae=j.yLabel===void 0?j.xLabel:"("+j.xLabel+", "+j.yLabel+")",!j.text&&j.text!==0||Array.isArray(j.text)||(ae+=(ae?"<br>":"")+j.text),j.extraText!==void 0&&(ae+=(ae?"<br>":"")+j.extraText),te&&ae===""&&!j.hovertemplate&&(ie===""&&te.remove(),ae=ie);var de=j.hovertemplate||!1;if(de){var ue=j.hovertemplateLabels||j;j[he+"Label"]!==Q&&(ue[he+"other"]=ue[he+"Val"],ue[he+"otherLabel"]=ue[he+"Label"]),ae=(ae=p.hovertemplateString(de,ue,J._d3locale,j.eventData[0]||{},j.trace._meta)).replace(P,function(ve,ke){return ie=Z(ke,j.nameLength),""})}return[ae,ie]}function U(j,W,ee,J){var Q=function(ie){return ie*ee},te=function(ie){return ie*J};j.each(function(ie){var ae=t.select(this);if(ie.del)return ae.remove();var he=ae.select("text.nums"),se=ie.anchor,de=se==="end"?-1:1,ue={start:1,end:-1,middle:0}[se],ve=ue*(w+C),ke=ve+ue*(ie.txwidth+C),Ee=0,be=ie.offset,xe=se==="middle";xe&&(ve-=ie.tx2width/2,ke+=ie.txwidth/2+C),W&&(be*=-S,Ee=ie.offset*A),ae.select("path").attr("d",xe?"M-"+Q(ie.bx/2+ie.tx2width/2)+","+te(be-ie.by/2)+"h"+Q(ie.bx)+"v"+te(ie.by)+"h-"+Q(ie.bx)+"Z":"M0,0L"+Q(de*w+Ee)+","+te(w+be)+"v"+te(ie.by/2-w)+"h"+Q(de*ie.bx)+"v-"+te(ie.by)+"H"+Q(de*w+Ee)+"V"+te(be-w)+"Z");var ce=Ee+ve,ge=be+ie.ty0-ie.by/2+C,we=ie.textAlign||"auto";we!=="auto"&&(we==="left"&&se!=="start"?(he.attr("text-anchor","start"),ce=xe?-ie.bx/2-ie.tx2width/2+C:-ie.bx-C):we==="right"&&se!=="end"&&(he.attr("text-anchor","end"),ce=xe?ie.bx/2-ie.tx2width/2-C:ie.bx+C)),he.call(s.positionText,Q(ce),te(ge)),ie.tx2width&&(ae.select("text.name").call(s.positionText,Q(ke+ue*C+Ee),te(be+ie.ty0-ie.by/2+C)),ae.select("rect").call(o.setRect,Q(ke+(ue-1)*ie.tx2width/2+Ee),te(be-ie.by/2-1),Q(ie.tx2width),te(ie.by+2)))})}function q(j,W){var ee=j.index,J=j.trace||{},Q=j.cd[0],te=j.cd[ee]||{};function ie(ve){return ve||d(ve)&&ve===0}var ae=Array.isArray(ee)?function(ve,ke){var Ee=p.castOption(Q,ee,ve);return ie(Ee)?Ee:p.extractOption({},J,"",ke)}:function(ve,ke){return p.extractOption(te,J,ve,ke)};function he(ve,ke,Ee){var be=ae(ke,Ee);ie(be)&&(j[ve]=be)}if(he("hoverinfo","hi","hoverinfo"),he("bgcolor","hbg","hoverlabel.bgcolor"),he("borderColor","hbc","hoverlabel.bordercolor"),he("fontFamily","htf","hoverlabel.font.family"),he("fontSize","hts","hoverlabel.font.size"),he("fontColor","htc","hoverlabel.font.color"),he("nameLength","hnl","hoverlabel.namelength"),he("textAlign","hta","hoverlabel.align"),j.posref=W==="y"||W==="closest"&&J.orientation==="h"?j.xa._offset+(j.x0+j.x1)/2:j.ya._offset+(j.y0+j.y1)/2,j.x0=p.constrain(j.x0,0,j.xa._length),j.x1=p.constrain(j.x1,0,j.xa._length),j.y0=p.constrain(j.y0,0,j.ya._length),j.y1=p.constrain(j.y1,0,j.ya._length),j.xLabelVal!==void 0&&(j.xLabel="xLabel"in j?j.xLabel:n.hoverLabelText(j.xa,j.xLabelVal,J.xhoverformat),j.xVal=j.xa.c2d(j.xLabelVal)),j.yLabelVal!==void 0&&(j.yLabel="yLabel"in j?j.yLabel:n.hoverLabelText(j.ya,j.yLabelVal,J.yhoverformat),j.yVal=j.ya.c2d(j.yLabelVal)),j.zLabelVal!==void 0&&j.zLabel===void 0&&(j.zLabel=String(j.zLabelVal)),!(isNaN(j.xerr)||j.xa.type==="log"&&j.xerr<=0)){var se=n.tickText(j.xa,j.xa.c2l(j.xerr),"hover").text;j.xerrneg!==void 0?j.xLabel+=" +"+se+" / -"+n.tickText(j.xa,j.xa.c2l(j.xerrneg),"hover").text:j.xLabel+=" \xB1 "+se,W==="x"&&(j.distance+=1)}if(!(isNaN(j.yerr)||j.ya.type==="log"&&j.yerr<=0)){var de=n.tickText(j.ya,j.ya.c2l(j.yerr),"hover").text;j.yerrneg!==void 0?j.yLabel+=" +"+de+" / -"+n.tickText(j.ya,j.ya.c2l(j.yerrneg),"hover").text:j.yLabel+=" \xB1 "+de,W==="y"&&(j.distance+=1)}var ue=j.hoverinfo||j.trace.hoverinfo;return ue&&ue!=="all"&&((ue=Array.isArray(ue)?ue:ue.split("+")).indexOf("x")===-1&&(j.xLabel=void 0),ue.indexOf("y")===-1&&(j.yLabel=void 0),ue.indexOf("z")===-1&&(j.zLabel=void 0),ue.indexOf("text")===-1&&(j.text=void 0),ue.indexOf("name")===-1&&(j.name=void 0)),j}function X(j,W,ee){var J,Q,te=ee.container,ie=ee.fullLayout,ae=ie._size,he=ee.event,se=!!W.hLinePoint,de=!!W.vLinePoint;if(te.selectAll(".spikeline").remove(),de||se){var ue=i.combine(ie.plot_bgcolor,ie.paper_bgcolor);if(se){var ve,ke,Ee=W.hLinePoint;J=Ee&&Ee.xa,(Q=Ee&&Ee.ya).spikesnap==="cursor"?(ve=he.pointerX,ke=he.pointerY):(ve=J._offset+Ee.x,ke=Q._offset+Ee.y);var be,xe,ce=m.readability(Ee.color,ue)<1.5?i.contrast(ue):Ee.color,ge=Q.spikemode,we=Q.spikethickness,Me=Q.spikecolor||ce,Se=n.getPxPosition(j,Q);if(ge.indexOf("toaxis")!==-1||ge.indexOf("across")!==-1){if(ge.indexOf("toaxis")!==-1&&(be=Se,xe=ve),ge.indexOf("across")!==-1){var ze=Q._counterDomainMin,Fe=Q._counterDomainMax;Q.anchor==="free"&&(ze=Math.min(ze,Q.position),Fe=Math.max(Fe,Q.position)),be=ae.l+ze*ae.w,xe=ae.l+Fe*ae.w}te.insert("line",":first-child").attr({x1:be,x2:xe,y1:ke,y2:ke,"stroke-width":we,stroke:Me,"stroke-dasharray":o.dashStyle(Q.spikedash,we)}).classed("spikeline",!0).classed("crisp",!0),te.insert("line",":first-child").attr({x1:be,x2:xe,y1:ke,y2:ke,"stroke-width":we+2,stroke:ue}).classed("spikeline",!0).classed("crisp",!0)}ge.indexOf("marker")!==-1&&te.insert("circle",":first-child").attr({cx:Se+(Q.side!=="right"?we:-we),cy:ke,r:we,fill:Me}).classed("spikeline",!0)}if(de){var Ye,rt,Oe=W.vLinePoint;J=Oe&&Oe.xa,Q=Oe&&Oe.ya,J.spikesnap==="cursor"?(Ye=he.pointerX,rt=he.pointerY):(Ye=J._offset+Oe.x,rt=Q._offset+Oe.y);var je,We,qe=m.readability(Oe.color,ue)<1.5?i.contrast(ue):Oe.color,Qe=J.spikemode,st=J.spikethickness,ct=J.spikecolor||qe,Pt=n.getPxPosition(j,J);if(Qe.indexOf("toaxis")!==-1||Qe.indexOf("across")!==-1){if(Qe.indexOf("toaxis")!==-1&&(je=Pt,We=rt),Qe.indexOf("across")!==-1){var kt=J._counterDomainMin,at=J._counterDomainMax;J.anchor==="free"&&(kt=Math.min(kt,J.position),at=Math.max(at,J.position)),je=ae.t+(1-at)*ae.h,We=ae.t+(1-kt)*ae.h}te.insert("line",":first-child").attr({x1:Ye,x2:Ye,y1:je,y2:We,"stroke-width":st,stroke:ct,"stroke-dasharray":o.dashStyle(J.spikedash,st)}).classed("spikeline",!0).classed("crisp",!0),te.insert("line",":first-child").attr({x1:Ye,x2:Ye,y1:je,y2:We,"stroke-width":st+2,stroke:ue}).classed("spikeline",!0).classed("crisp",!0)}Qe.indexOf("marker")!==-1&&te.insert("circle",":first-child").attr({cx:Ye,cy:Pt-(J.side!=="top"?st:-st),r:st,fill:ct}).classed("spikeline",!0)}}}function K(j,W){return!W||W.vLinePoint!==j._spikepoints.vLinePoint||W.hLinePoint!==j._spikepoints.hLinePoint}function Z(j,W){return s.plainText(j||"",{len:W,allowedTags:["br","sub","sup","b","i","em"]})}function H(j,W,ee){var J=W[j+"a"],Q=W[j+"Val"],te=W.cd[0];if(J.type==="category")Q=J._categoriesMap[Q];else if(J.type==="date"){var ie=W.trace[j+"periodalignment"];if(ie){var ae=W.cd[W.index],he=ae[j+"Start"];he===void 0&&(he=ae[j]);var se=ae[j+"End"];se===void 0&&(se=ae[j]);var de=se-he;ie==="end"?Q+=de:ie==="middle"&&(Q+=de/2)}Q=J.d2c(Q)}return te&&te.t&&te.t.posLetter===J._id&&(ee.boxmode!=="group"&&ee.violinmode!=="group"||(Q+=te.t.dPos)),Q}function Y(j){return j.offsetTop+j.clientTop}function $(j){return j.offsetLeft+j.clientLeft}function z(j,W){var ee=j._fullLayout,J=W.getBoundingClientRect(),Q=J.x,te=J.y,ie=Q+J.width,ae=te+J.height,he=p.apply3DTransform(ee._invTransform)(Q,te),se=p.apply3DTransform(ee._invTransform)(ie,ae),de=he[0],ue=he[1],ve=se[0],ke=se[1];return{x:de,y:ue,width:ve-de,height:ke-ue,top:Math.min(ue,ke),left:Math.min(de,ve),right:Math.max(de,ve),bottom:Math.max(ue,ke)}}},{"../../lib":787,"../../lib/events":776,"../../lib/override_cursor":798,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"../legend/defaults":702,"../legend/draw":703,"./constants":684,"./helpers":686,"@plotly/d3":58,"fast-isnumeric":246,tinycolor2:583}],688:[function(r,O,B){var t=r("../../lib"),d=r("../color"),m=r("./helpers").isUnifiedHover;O.exports=function(p,e,f,u){function s(l){u.font[l]||(u.font[l]=e.legend?e.legend.font[l]:e.font[l])}u=u||{},e&&m(e.hovermode)&&(u.font||(u.font={}),s("size"),s("family"),s("color"),e.legend?(u.bgcolor||(u.bgcolor=d.combine(e.legend.bgcolor,e.paper_bgcolor)),u.bordercolor||(u.bordercolor=e.legend.bordercolor)):u.bgcolor||(u.bgcolor=e.paper_bgcolor)),f("hoverlabel.bgcolor",u.bgcolor),f("hoverlabel.bordercolor",u.bordercolor),f("hoverlabel.namelength",u.namelength),t.coerceFont(f,"hoverlabel.font",u.font),f("hoverlabel.align",u.align)}},{"../../lib":787,"../color":650,"./helpers":686}],689:[function(r,O,B){var t=r("../../lib"),d=r("./layout_attributes");O.exports=function(m,p){function e(f,u){return p[f]!==void 0?p[f]:t.coerce(m,p,d,f,u)}return e("clickmode"),e("hovermode")}},{"../../lib":787,"./layout_attributes":691}],690:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../dragelement"),p=r("./helpers"),e=r("./layout_attributes"),f=r("./hover");O.exports={moduleType:"component",name:"fx",constants:r("./constants"),schema:{layout:e},attributes:r("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:r("./layout_global_defaults"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc"),getDistanceFunction:p.getDistanceFunction,getClosest:p.getClosest,inbox:p.inbox,quadrature:p.quadrature,appendArrayPointValue:p.appendArrayPointValue,castHoverOption:function(u,s,l){return d.castOption(u,s,"hoverlabel."+l)},castHoverinfo:function(u,s,l){return d.castOption(u,l,"hoverinfo",function(o){return d.coerceHoverinfo({hoverinfo:o},{_module:u._module},s)})},hover:f.hover,unhover:m.unhover,loneHover:f.loneHover,loneUnhover:function(u){var s=d.isD3Selection(u)?u:t.select(u);s.selectAll("g.hovertext").remove(),s.selectAll(".spikeline").remove()},click:r("./click")}},{"../../lib":787,"../dragelement":669,"./attributes":681,"./calc":682,"./click":683,"./constants":684,"./defaults":685,"./helpers":686,"./hover":687,"./layout_attributes":691,"./layout_defaults":692,"./layout_global_defaults":693,"@plotly/d3":58}],691:[function(r,O,B){var t=r("./constants"),d=r("../../plots/font_attributes")({editType:"none"});d.family.dflt=t.HOVERFONT,d.size.dflt=t.HOVERFONTSIZE,O.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:d,align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":867,"./constants":684}],692:[function(r,O,B){var t=r("../../lib"),d=r("./layout_attributes"),m=r("./hovermode_defaults"),p=r("./hoverlabel_defaults");O.exports=function(e,f){function u(i,c){return t.coerce(e,f,d,i,c)}m(e,f)&&(u("hoverdistance"),u("spikedistance")),u("dragmode")==="select"&&u("selectdirection");var s=f._has("mapbox"),l=f._has("geo"),o=f._basePlotModules.length;f.dragmode==="zoom"&&((s||l)&&o===1||s&&l&&o===2)&&(f.dragmode="pan"),p(e,f,u)}},{"../../lib":787,"./hoverlabel_defaults":688,"./hovermode_defaults":689,"./layout_attributes":691}],693:[function(r,O,B){var t=r("../../lib"),d=r("./hoverlabel_defaults"),m=r("./layout_attributes");O.exports=function(p,e){d(p,e,function(f,u){return t.coerce(p,e,m,f,u)})}},{"../../lib":787,"./hoverlabel_defaults":688,"./layout_attributes":691}],694:[function(r,O,B){var t=r("../../lib"),d=r("../../lib/regex").counter,m=r("../../plots/domain").attributes,p=r("../../plots/cartesian/constants").idRegex,e=r("../../plot_api/plot_template"),f={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[d("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[p.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[p.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:m({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function u(o,i,c){var n=i[c+"axes"],a=Object.keys((o._splomAxes||{})[c]||{});return Array.isArray(n)?n:a.length?a:void 0}function s(o,i,c,n,a,g){var h=i(o+"gap",c),y=i("domain."+o);i(o+"side",n);for(var v=new Array(a),_=y[0],x=(y[1]-_)/(a-h),T=x*(1-h),A=0;A<a;A++){var S=_+x*A;v[g?a-1-A:A]=[S,S+T]}return v}function l(o,i,c,n,a){var g,h=new Array(c);function y(v,_){i.indexOf(_)!==-1&&n[_]===void 0?(h[v]=_,n[_]=v):h[v]=""}if(Array.isArray(o))for(g=0;g<c;g++)y(g,o[g]);else for(y(0,a),g=1;g<c;g++)y(g,a+(g+1));return h}O.exports={moduleType:"component",name:"grid",schema:{layout:{grid:f}},layoutAttributes:f,sizeDefaults:function(o,i){var c=o.grid||{},n=u(i,c,"x"),a=u(i,c,"y");if(o.grid||n||a){var g,h,y=Array.isArray(c.subplots)&&Array.isArray(c.subplots[0]),v=Array.isArray(n),_=Array.isArray(a),x=v&&n!==c.xaxes&&_&&a!==c.yaxes;y?(g=c.subplots.length,h=c.subplots[0].length):(_&&(g=a.length),v&&(h=n.length));var T=e.newContainer(i,"grid"),A=P("rows",g),S=P("columns",h);if(A*S>1){!y&&!v&&!_&&P("pattern")==="independent"&&(y=!0),T._hasSubplotGrid=y;var w,C,k=P("roworder")==="top to bottom",L=y?.2:.1,M=y?.3:.1;x&&i._splomGridDflt&&(w=i._splomGridDflt.xside,C=i._splomGridDflt.yside),T._domains={x:s("x",P,L,w,S),y:s("y",P,M,C,A,k)}}else delete i.grid}function P(D,N){return t.coerce(c,T,f,D,N)}},contentDefaults:function(o,i){var c=i.grid;if(c&&c._domains){var n,a,g,h,y,v,_,x=o.grid||{},T=i._subplots,A=c._hasSubplotGrid,S=c.rows,w=c.columns,C=c.pattern==="independent",k=c._axisMap={};if(A){var L=x.subplots||[];v=c.subplots=new Array(S);var M=1;for(n=0;n<S;n++){var P=v[n]=new Array(w),D=L[n]||[];for(a=0;a<w;a++)if(C?(y=M===1?"xy":"x"+M+"y"+M,M++):y=D[a],P[a]="",T.cartesian.indexOf(y)!==-1){if(_=y.indexOf("y"),g=y.slice(0,_),h=y.slice(_),k[g]!==void 0&&k[g]!==a||k[h]!==void 0&&k[h]!==n)continue;P[a]=y,k[g]=a,k[h]=n}}}else{var N=u(i,x,"x"),U=u(i,x,"y");c.xaxes=l(N,T.xaxis,w,k,"x"),c.yaxes=l(U,T.yaxis,S,k,"y")}var q=c._anchors={},X=c.roworder==="top to bottom";for(var K in k){var Z,H,Y,$=K.charAt(0),z=c[$+"side"];if(z.length<8)q[K]="free";else if($==="x"){if(z.charAt(0)==="t"===X?(Z=0,H=1,Y=S):(Z=S-1,H=-1,Y=-1),A){var j=k[K];for(n=Z;n!==Y;n+=H)if((y=v[n][j])&&(_=y.indexOf("y"),y.slice(0,_)===K)){q[K]=y.slice(_);break}}else for(n=Z;n!==Y;n+=H)if(h=c.yaxes[n],T.cartesian.indexOf(K+h)!==-1){q[K]=h;break}}else if(z.charAt(0)==="l"?(Z=0,H=1,Y=w):(Z=w-1,H=-1,Y=-1),A){var W=k[K];for(n=Z;n!==Y;n+=H)if((y=v[W][n])&&(_=y.indexOf("y"),y.slice(_)===K)){q[K]=y.slice(0,_);break}}else for(n=Z;n!==Y;n+=H)if(g=c.xaxes[n],T.cartesian.indexOf(g+K)!==-1){q[K]=g;break}}}}}},{"../../lib":787,"../../lib/regex":804,"../../plot_api/plot_template":827,"../../plots/cartesian/constants":845,"../../plots/domain":866}],695:[function(r,O,B){var t=r("../../plots/cartesian/constants"),d=r("../../plot_api/plot_template").templatedArray;r("../../constants/axis_placeable_objects"),O.exports=d("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",t.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",t.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":756,"../../plot_api/plot_template":827,"../../plots/cartesian/constants":845}],696:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib/to_log_range");O.exports=function(m,p,e,f){p=p||{};var u=e==="log"&&p.type==="linear",s=e==="linear"&&p.type==="log";if(u||s){for(var l,o,i=m._fullLayout.images,c=p._id.charAt(0),n=0;n<i.length;n++)if(o="images["+n+"].",(l=i[n])[c+"ref"]===p._id){var a=l[c],g=l["size"+c],h=null,y=null;if(u){h=d(a,p.range);var v=g/Math.pow(10,h)/2;y=2*Math.log(v+Math.sqrt(1+v*v))/Math.LN10}else y=(h=Math.pow(10,a))*(Math.pow(10,g/2)-Math.pow(10,-g/2));t(h)?t(y)||(y=null):(h=null,y=null),f(o+c,h),f(o+"size"+c,y)}}}},{"../../lib/to_log_range":815,"fast-isnumeric":246}],697:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("../../plots/array_container_defaults"),p=r("./attributes");function e(f,u,s){function l(h,y){return t.coerce(f,u,p,h,y)}var o=l("source");if(!l("visible",!!o))return u;l("layer"),l("xanchor"),l("yanchor"),l("sizex"),l("sizey"),l("sizing"),l("opacity");for(var i={_fullLayout:s},c=["x","y"],n=0;n<2;n++){var a=c[n],g=d.coerceRef(f,u,i,a,"paper",void 0);g!=="paper"&&d.getFromId(i,g)._imgIndices.push(u._index),d.coercePosition(u,i,l,g,a,0)}return u}O.exports=function(f,u){m(f,u,{name:"images",handleItemDefaults:e})}},{"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"./attributes":695}],698:[function(r,O,B){var t=r("@plotly/d3"),d=r("../drawing"),m=r("../../plots/cartesian/axes"),p=r("../../plots/cartesian/axis_ids"),e=r("../../constants/xmlns_namespaces");O.exports=function(f){var u,s,l=f._fullLayout,o=[],i={},c=[];for(s=0;s<l.images.length;s++){var n=l.images[s];if(n.visible)if(n.layer==="below"&&n.xref!=="paper"&&n.yref!=="paper"){u=p.ref2id(n.xref)+p.ref2id(n.yref);var a=l._plots[u];if(!a){c.push(n);continue}a.mainplot&&(u=a.mainplot.id),i[u]||(i[u]=[]),i[u].push(n)}else n.layer==="above"?o.push(n):c.push(n)}var g={left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-.5},right:{sizing:"xMax",offset:-1}},h={top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-.5},bottom:{sizing:"YMax",offset:-1}};function y(w){var C=t.select(this);if(this._imgSrc!==w.source)if(C.attr("xmlns",e.svg),w.source&&w.source.slice(0,5)==="data:")C.attr("xlink:href",w.source),this._imgSrc=w.source;else{var k=new Promise(function(L){var M=new Image;function P(){C.remove(),L()}this.img=M,M.setAttribute("crossOrigin","anonymous"),M.onerror=P,M.onload=function(){var D=document.createElement("canvas");D.width=this.width,D.height=this.height,D.getContext("2d").drawImage(this,0,0);var N=D.toDataURL("image/png");C.attr("xlink:href",N),L()},C.on("error",P),M.src=w.source,this._imgSrc=w.source}.bind(this));f._promises.push(k)}}function v(w){var C,k,L=t.select(this),M=m.getFromId(f,w.xref),P=m.getFromId(f,w.yref),D=m.getRefType(w.xref)==="domain",N=m.getRefType(w.yref)==="domain",U=l._size;C=M!==void 0?typeof w.xref=="string"&&D?M._length*w.sizex:Math.abs(M.l2p(w.sizex)-M.l2p(0)):w.sizex*U.w,k=P!==void 0?typeof w.yref=="string"&&N?P._length*w.sizey:Math.abs(P.l2p(w.sizey)-P.l2p(0)):w.sizey*U.h;var q,X,K=C*g[w.xanchor].offset,Z=k*h[w.yanchor].offset,H=g[w.xanchor].sizing+h[w.yanchor].sizing;switch(q=M!==void 0?typeof w.xref=="string"&&D?M._length*w.x+M._offset:M.r2p(w.x)+M._offset:w.x*U.w+U.l,q+=K,X=P!==void 0?typeof w.yref=="string"&&N?P._length*(1-w.y)+P._offset:P.r2p(w.y)+P._offset:U.h-w.y*U.h+U.t,X+=Z,w.sizing){case"fill":H+=" slice";break;case"stretch":H="none"}L.attr({x:q,y:X,width:C,height:k,preserveAspectRatio:H,opacity:w.opacity});var Y=(M&&m.getRefType(w.xref)!=="domain"?M._id:"")+(P&&m.getRefType(w.yref)!=="domain"?P._id:"");d.setClipUrl(L,Y?"clip"+l._uid+Y:null,f)}var _=l._imageLowerLayer.selectAll("image").data(c),x=l._imageUpperLayer.selectAll("image").data(o);_.enter().append("image"),x.enter().append("image"),_.exit().remove(),x.exit().remove(),_.each(function(w){y.bind(this)(w),v.bind(this)(w)}),x.each(function(w){y.bind(this)(w),v.bind(this)(w)});var T=Object.keys(l._plots);for(s=0;s<T.length;s++){u=T[s];var A=l._plots[u];if(A.imagelayer){var S=A.imagelayer.selectAll("image").data(i[u]||[]);S.enter().append("image"),S.exit().remove(),S.each(function(w){y.bind(this)(w),v.bind(this)(w)})}}}},{"../../constants/xmlns_namespaces":764,"../../plots/cartesian/axes":838,"../../plots/cartesian/axis_ids":842,"../drawing":672,"@plotly/d3":58}],699:[function(r,O,B){O.exports={moduleType:"component",name:"images",layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),includeBasePlot:r("../../plots/cartesian/include_components")("images"),draw:r("./draw"),convertCoords:r("./convert_coords")}},{"../../plots/cartesian/include_components":851,"./attributes":695,"./convert_coords":696,"./defaults":697,"./draw":698}],700:[function(r,O,B){var t=r("../../plots/font_attributes"),d=r("../color/attributes");O.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:d.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:t({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:t({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":867,"../color/attributes":649}],701:[function(r,O,B){O.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],702:[function(r,O,B){var t=r("../../registry"),d=r("../../lib"),m=r("../../plot_api/plot_template"),p=r("./attributes"),e=r("../../plots/layout_attributes"),f=r("./helpers");O.exports=function(u,s,l){for(var o=u.legend||{},i=0,c=!1,n="normal",a=0;a<l.length;a++){var g=l[a];g.visible&&((g.showlegend||g._dfltShowLegend&&!(g._module&&g._module.attributes&&g._module.attributes.showlegend&&g._module.attributes.showlegend.dflt===!1))&&(i++,g.showlegend&&(c=!0,(t.traceIs(g,"pie-like")||g._input.showlegend===!0)&&i++)),(t.traceIs(g,"bar")&&s.barmode==="stack"||["tonextx","tonexty"].indexOf(g.fill)!==-1)&&(n=f.isGrouped({traceorder:n})?"grouped+reversed":"reversed"),g.legendgroup!==void 0&&g.legendgroup!==""&&(n=f.isReversed({traceorder:n})?"reversed+grouped":"grouped"))}var h=d.coerce(u,s,e,"showlegend",c&&i>1);if(h!==!1||o.uirevision){var y=m.newContainer(s,"legend");if(w("uirevision",s.uirevision),h!==!1){w("bgcolor",s.paper_bgcolor),w("bordercolor"),w("borderwidth");var v,_,x,T=d.coerceFont(w,"font",s.font),A=w("orientation")==="h";if(A?(v=0,t.getComponentMethod("rangeslider","isVisible")(u.xaxis)?(_=1.1,x="bottom"):(_=-.1,x="top")):(v=1.02,_=1,x="auto"),w("traceorder",n),f.isGrouped(s.legend)&&w("tracegroupgap"),w("itemsizing"),w("itemwidth"),w("itemclick"),w("itemdoubleclick"),w("groupclick"),w("x",v),w("xanchor"),w("y",_),w("yanchor",x),w("valign"),d.noneOrAll(o,y,["x","y"]),w("title.text")){w("title.side",A?"left":"top");var S=d.extendFlat({},T,{size:d.bigFont(T.size)});d.coerceFont(w,"title.font",S)}}}function w(C,k){return d.coerce(o,y,p,C,k)}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/layout_attributes":892,"../../registry":915,"./attributes":700,"./helpers":706}],703:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../plots/plots"),p=r("../../registry"),e=r("../../lib/events"),f=r("../dragelement"),u=r("../drawing"),s=r("../color"),l=r("../../lib/svg_text_utils"),o=r("./handle_click"),i=r("./constants"),c=r("../../constants/alignment"),n=c.LINE_SPACING,a=c.FROM_TL,g=c.FROM_BR,h=r("./get_legend_data"),y=r("./style"),v=r("./helpers");function _(k,L,M,P,D){var N=M.data()[0][0].trace,U={event:D,node:M.node(),curveNumber:N.index,expandedIndex:N._expandedIndex,data:k.data,layout:k.layout,frames:k._transitionData._frames,config:k._context,fullData:k._fullData,fullLayout:k._fullLayout};N._group&&(U.group=N._group),p.traceIs(N,"pie-like")&&(U.label=M.datum()[0].label),e.triggerHandler(k,"plotly_legendclick",U)!==!1&&(P===1?L._clickTimeout=setTimeout(function(){k._fullLayout&&o(M,k,P)},k._context.doubleClickDelay):P===2&&(L._clickTimeout&&clearTimeout(L._clickTimeout),k._legendMouseDownTime=0,e.triggerHandler(k,"plotly_legenddoubleclick",U)!==!1&&o(M,k,P)))}function x(k,L,M){var P,D,N=k.data()[0][0],U=N.trace,q=p.traceIs(U,"pie-like"),X=!M._inHover&&L._context.edits.legendText&&!q,K=M._maxNameLength;N.groupTitle?(P=N.groupTitle.text,D=N.groupTitle.font):(D=M.font,M.entries?P=N.text:(P=q?N.label:U.name,U._meta&&(P=d.templateString(P,U._meta))));var Z=d.ensureSingle(k,"text","legendtext");Z.attr("text-anchor","start").call(u.font,D).text(X?T(P,K):P);var H=M.itemwidth+2*i.itemGap;l.positionText(Z,H,0),X?Z.call(l.makeEditable,{gd:L,text:P}).call(S,k,L,M).on("edit",function(Y){this.text(T(Y,K)).call(S,k,L,M);var $=N.trace._fullInput||{},z={};if(p.hasTransform($,"groupby")){var j=p.getTransformIndices($,"groupby"),W=j[j.length-1],ee=d.keyedContainer($,"transforms["+W+"].styles","target","value.name");ee.set(N.trace._group,Y),z=ee.constructUpdate()}else z.name=Y;return p.call("_guiRestyle",L,z,U.index)}):S(Z,k,L,M)}function T(k,L){var M=Math.max(4,L);if(k&&k.trim().length>=M/2)return k;for(var P=M-(k=k||"").length;P>0;P--)k+=" ";return k}function A(k,L){var M,P=L._context.doubleClickDelay,D=1,N=d.ensureSingle(k,"rect","legendtoggle",function(U){L._context.staticPlot||U.style("cursor","pointer").attr("pointer-events","all"),U.call(s.fill,"rgba(0,0,0,0)")});L._context.staticPlot||(N.on("mousedown",function(){(M=new Date().getTime())-L._legendMouseDownTime<P?D+=1:(D=1,L._legendMouseDownTime=M)}),N.on("mouseup",function(){if(!L._dragged&&!L._editing){var U=L._fullLayout.legend;new Date().getTime()-L._legendMouseDownTime>P&&(D=Math.max(D-1,1)),_(L,U,k,D,t.event)}}))}function S(k,L,M,P,D){P._inHover&&k.attr("data-notex",!0),l.convertToTspans(k,M,function(){(function(N,U,q,X){var K=N.data()[0][0];if(!q._inHover&&K&&!K.trace.showlegend)return void N.remove();var Z=N.select("g[class*=math-group]"),H=Z.node();q||(q=U._fullLayout.legend);var Y,$=q.borderwidth;Y=X===1?q.title.font:K.groupTitle?K.groupTitle.font:q.font;var z,j,W=Y.size*n;if(H){var ee=u.bBox(H);z=ee.height,j=ee.width,X===1?u.setTranslate(Z,$,$+.75*z):u.setTranslate(Z,0,.25*z)}else{var J=N.select(X===1?".legendtitletext":".legendtext"),Q=l.lineCount(J),te=J.node();if(z=W*Q,j=te?u.bBox(te).width:0,X===1)q.title.side==="left"&&(j+=2*i.itemGap),l.positionText(J,$+i.titlePad,$+W);else{var ie=2*i.itemGap+q.itemwidth;K.groupTitle&&(ie=i.itemGap,j-=q.itemwidth),l.positionText(J,ie,-W*((Q-1)/2-.3))}}X===1?(q._titleWidth=j,q._titleHeight=z):(K.lineHeight=W,K.height=Math.max(z,16)+3,K.width=j)})(L,M,P,D)})}function w(k){return d.isRightAnchor(k)?"right":d.isCenterAnchor(k)?"center":"left"}function C(k){return d.isBottomAnchor(k)?"bottom":d.isMiddleAnchor(k)?"middle":"top"}O.exports=function(k,L){return L||(L=k._fullLayout.legend||{}),function(M,P){var D,N,U=M._fullLayout,q="legend"+U._uid,X=P._inHover;if(X?(D=P.layer,q+="-hover"):D=U._infolayer,!!D){if(M._legendMouseDownTime||(M._legendMouseDownTime=0),X){if(!P.entries)return;N=h(P.entries,P)}else{if(!M.calcdata)return;N=U.showlegend&&h(M.calcdata,P)}var K=U.hiddenlabels||[];if(!(X||U.showlegend&&N.length))return D.selectAll(".legend").remove(),U._topdefs.select("#"+q).remove(),m.autoMargin(M,"legend");var Z=d.ensureSingle(D,"g","legend",function(Q){X||Q.attr("pointer-events","all")}),H=d.ensureSingleById(U._topdefs,"clipPath",q,function(Q){Q.append("rect")}),Y=d.ensureSingle(Z,"rect","bg",function(Q){Q.attr("shape-rendering","crispEdges")});Y.call(s.stroke,P.bordercolor).call(s.fill,P.bgcolor).style("stroke-width",P.borderwidth+"px");var $=d.ensureSingle(Z,"g","scrollbox"),z=P.title;if(P._titleWidth=0,P._titleHeight=0,z.text){var j=d.ensureSingle($,"text","legendtitletext");j.attr("text-anchor","start").call(u.font,z.font).text(z.text),S(j,$,M,P,1)}else $.selectAll(".legendtitletext").remove();var W=d.ensureSingle(Z,"rect","scrollbar",function(Q){Q.attr(i.scrollBarEnterAttrs).call(s.fill,i.scrollBarColor)}),ee=$.selectAll("g.groups").data(N);ee.enter().append("g").attr("class","groups"),ee.exit().remove();var J=ee.selectAll("g.traces").data(d.identity);J.enter().append("g").attr("class","traces"),J.exit().remove(),J.style("opacity",function(Q){var te=Q[0].trace;return p.traceIs(te,"pie-like")?K.indexOf(Q[0].label)!==-1?.5:1:te.visible==="legendonly"?.5:1}).each(function(){t.select(this).call(x,M,P)}).call(y,M,P).each(function(){X||t.select(this).call(A,M)}),d.syncOrAsync([m.previousPromises,function(){return function(Q,te,ie,ae){var he=Q._fullLayout;ae||(ae=he.legend);var se=he._size,de=v.isVertical(ae),ue=v.isGrouped(ae),ve=ae.borderwidth,ke=2*ve,Ee=i.itemGap,be=ae.itemwidth+2*Ee,xe=2*(ve+Ee),ce=C(ae),ge=ae.y<0||ae.y===0&&ce==="top",we=ae.y>1||ae.y===1&&ce==="bottom",Me=ae.tracegroupgap;ae._maxHeight=Math.max(ge||we?he.height/2:se.h,30);var Se=0;ae._width=0,ae._height=0;var ze=function(Be){var Ke=0,_e=0,Ce=Be.title.side;return Ce&&(Ce.indexOf("left")!==-1&&(Ke=Be._titleWidth),Ce.indexOf("top")!==-1&&(_e=Be._titleHeight)),[Ke,_e]}(ae);if(de)ie.each(function(Be){var Ke=Be[0].height;u.setTranslate(this,ve+ze[0],ve+ze[1]+ae._height+Ke/2+Ee),ae._height+=Ke,ae._width=Math.max(ae._width,Be[0].width)}),Se=be+ae._width,ae._width+=Ee+be+ke,ae._height+=xe,ue&&(te.each(function(Be,Ke){u.setTranslate(this,0,Ke*ae.tracegroupgap)}),ae._height+=(ae._lgroupsLength-1)*ae.tracegroupgap);else{var Fe=w(ae),Ye=ae.x<0||ae.x===0&&Fe==="right",rt=ae.x>1||ae.x===1&&Fe==="left",Oe=we||ge,je=he.width/2;ae._maxWidth=Math.max(Ye?Oe&&Fe==="left"?se.l+se.w:je:rt?Oe&&Fe==="right"?se.r+se.w:je:se.w,2*be);var We=0,qe=0;ie.each(function(Be){var Ke=Be[0].width+be;We=Math.max(We,Ke),qe+=Ke}),Se=null;var Qe=0;if(ue){var st=0,ct=0,Pt=0;te.each(function(){var Be=0,Ke=0;t.select(this).selectAll("g.traces").each(function(Ce){var Le=Ce[0].height;u.setTranslate(this,ze[0],ze[1]+ve+Ee+Le/2+Ke),Ke+=Le,Be=Math.max(Be,be+Ce[0].width)}),st=Math.max(st,Ke);var _e=Be+Ee;_e+ve+ct>ae._maxWidth&&(Qe=Math.max(Qe,ct),ct=0,Pt+=st+Me,st=Ke),u.setTranslate(this,ct,Pt),ct+=_e}),ae._width=Math.max(Qe,ct)+ve,ae._height=Pt+st+xe}else{var kt=ie.size(),at=qe+ke+(kt-1)*Ee<ae._maxWidth,tt=0,_t=0,er=0,tr=0;ie.each(function(Be){var Ke=Be[0].height,_e=be+Be[0].width,Ce=(at?_e:We)+Ee;Ce+ve+_t-Ee>=ae._maxWidth&&(Qe=Math.max(Qe,tr),_t=0,er+=tt,ae._height+=tt,tt=0),u.setTranslate(this,ze[0]+ve+_t,ze[1]+ve+er+Ke/2+Ee),tr=_t+_e+Ee,_t+=Ce,tt=Math.max(tt,Ke)}),at?(ae._width=_t+ke,ae._height=tt+xe):(ae._width=Math.max(Qe,tr)+ke,ae._height+=tt+xe)}}ae._width=Math.ceil(Math.max(ae._width+ze[0],ae._titleWidth+2*(ve+i.titlePad))),ae._height=Math.ceil(Math.max(ae._height+ze[1],ae._titleHeight+2*(ve+i.itemGap))),ae._effHeight=Math.min(ae._height,ae._maxHeight);var Ue=Q._context.edits,He=Ue.legendText||Ue.legendPosition;ie.each(function(Be){var Ke=t.select(this).select(".legendtoggle"),_e=Be[0].height,Ce=He?be:Se||be+Be[0].width;de||(Ce+=Ee/2),u.setRect(Ke,0,-_e/2,Ce,_e)})}(M,ee,J,P)},function(){if(X||!function(Oe){var je=Oe._fullLayout.legend,We=w(je),qe=C(je);return m.autoMargin(Oe,"legend",{x:je.x,y:je.y,l:je._width*a[We],r:je._width*g[We],b:je._effHeight*g[qe],t:je._effHeight*a[qe]})}(M)){var Q,te,ie,ae,he=U._size,se=P.borderwidth,de=he.l+he.w*P.x-a[w(P)]*P._width,ue=he.t+he.h*(1-P.y)-a[C(P)]*P._effHeight;if(!X&&U.margin.autoexpand){var ve=de,ke=ue;de=d.constrain(de,0,U.width-P._width),ue=d.constrain(ue,0,U.height-P._effHeight),de!==ve&&d.log("Constrain legend.x to make legend fit inside graph"),ue!==ke&&d.log("Constrain legend.y to make legend fit inside graph")}if(X||u.setTranslate(Z,de,ue),W.on(".drag",null),Z.on("wheel",null),X||P._height<=P._maxHeight||M._context.staticPlot){var Ee=P._effHeight;X&&(Ee=P._height),Y.attr({width:P._width-se,height:Ee-se,x:se/2,y:se/2}),u.setTranslate($,0,0),H.select("rect").attr({width:P._width-2*se,height:Ee-2*se,x:se,y:se}),u.setClipUrl($,q,M),u.setRect(W,0,0,0,0),delete P._scrollY}else{var be,xe,ce,ge=Math.max(i.scrollBarMinHeight,P._effHeight*P._effHeight/P._height),we=P._effHeight-ge-2*i.scrollBarMargin,Me=P._height-P._effHeight,Se=we/Me,ze=Math.min(P._scrollY||0,Me);Y.attr({width:P._width-2*se+i.scrollBarWidth+i.scrollBarMargin,height:P._effHeight-se,x:se/2,y:se/2}),H.select("rect").attr({width:P._width-2*se+i.scrollBarWidth+i.scrollBarMargin,height:P._effHeight-2*se,x:se,y:se+ze}),u.setClipUrl($,q,M),rt(ze,ge,Se),Z.on("wheel",function(){rt(ze=d.constrain(P._scrollY+t.event.deltaY/we*Me,0,Me),ge,Se),ze!==0&&ze!==Me&&t.event.preventDefault()});var Fe=t.behavior.drag().on("dragstart",function(){var Oe=t.event.sourceEvent;be=Oe.type==="touchstart"?Oe.changedTouches[0].clientY:Oe.clientY,ce=ze}).on("drag",function(){var Oe=t.event.sourceEvent;Oe.buttons===2||Oe.ctrlKey||(xe=Oe.type==="touchmove"?Oe.changedTouches[0].clientY:Oe.clientY,rt(ze=function(je,We,qe){var Qe=(qe-We)/Se+je;return d.constrain(Qe,0,Me)}(ce,be,xe),ge,Se))});W.call(Fe);var Ye=t.behavior.drag().on("dragstart",function(){var Oe=t.event.sourceEvent;Oe.type==="touchstart"&&(be=Oe.changedTouches[0].clientY,ce=ze)}).on("drag",function(){var Oe=t.event.sourceEvent;Oe.type==="touchmove"&&(xe=Oe.changedTouches[0].clientY,rt(ze=function(je,We,qe){var Qe=(We-qe)/Se+je;return d.constrain(Qe,0,Me)}(ce,be,xe),ge,Se))});$.call(Ye)}M._context.edits.legendPosition&&(Z.classed("cursor-move",!0),f.init({element:Z.node(),gd:M,prepFn:function(){var Oe=u.getTranslate(Z);ie=Oe.x,ae=Oe.y},moveFn:function(Oe,je){var We=ie+Oe,qe=ae+je;u.setTranslate(Z,We,qe),Q=f.align(We,0,he.l,he.l+he.w,P.xanchor),te=f.align(qe,0,he.t+he.h,he.t,P.yanchor)},doneFn:function(){Q!==void 0&&te!==void 0&&p.call("_guiRelayout",M,{"legend.x":Q,"legend.y":te})},clickFn:function(Oe,je){var We=D.selectAll("g.traces").filter(function(){var qe=this.getBoundingClientRect();return je.clientX>=qe.left&&je.clientX<=qe.right&&je.clientY>=qe.top&&je.clientY<=qe.bottom});We.size()>0&&_(M,Z,We,Oe,je)}}))}function rt(Oe,je,We){P._scrollY=M._fullLayout.legend._scrollY=Oe,u.setTranslate($,0,-Oe),u.setRect(W,P._width,i.scrollBarMargin+Oe*We,i.scrollBarWidth,je),H.select("rect").attr("y",se+Oe)}}],M)}}(k,L)}},{"../../constants/alignment":755,"../../lib":787,"../../lib/events":776,"../../lib/svg_text_utils":813,"../../plots/plots":901,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"./constants":701,"./get_legend_data":704,"./handle_click":705,"./helpers":706,"./style":708,"@plotly/d3":58}],704:[function(r,O,B){var t=r("../../registry"),d=r("./helpers");O.exports=function(m,p){var e,f,u=p._inHover,s=d.isGrouped(p),l=d.isReversed(p),o={},i=[],c=!1,n={},a=0,g=0;function h(U,q){if(U!==""&&d.isGrouped(p))i.indexOf(U)===-1?(i.push(U),c=!0,o[U]=[q]):o[U].push(q);else{var X="~~i"+a;i.push(X),o[X]=[q],a++}}for(e=0;e<m.length;e++){var y=m[e],v=y[0],_=v.trace,x=_.legendgroup;if(u||_.visible&&_.showlegend)if(t.traceIs(_,"pie-like"))for(n[x]||(n[x]={}),f=0;f<y.length;f++){var T=y[f].label;n[x][T]||(h(x,{label:T,color:y[f].color,i:y[f].i,trace:_,pts:y[f].pts}),n[x][T]=!0,g=Math.max(g,(T||"").length))}else h(x,v),g=Math.max(g,(_.name||"").length)}if(!i.length)return[];var A=!c||!s,S=[];for(e=0;e<i.length;e++){var w=o[i[e]];A?S.push(w[0]):S.push(w)}for(A&&(S=[S]),e=0;e<S.length;e++){var C=1/0;for(f=0;f<S[e].length;f++){var k=S[e][f].trace.legendrank;C>k&&(C=k)}S[e][0]._groupMinRank=C,S[e][0]._preGroupSort=e}var L=function(U,q){return U.trace.legendrank-q.trace.legendrank||U._preSort-q._preSort};for(S.forEach(function(U,q){U[0]._preGroupSort=q}),S.sort(function(U,q){return U[0]._groupMinRank-q[0]._groupMinRank||U[0]._preGroupSort-q[0]._preGroupSort}),e=0;e<S.length;e++){S[e].forEach(function(U,q){U._preSort=q}),S[e].sort(L);var M=S[e][0].trace,P=null;for(f=0;f<S[e].length;f++){var D=S[e][f].trace.legendgrouptitle;if(D&&D.text){P=D,u&&(D.font=p._groupTitleFont);break}}if(l&&S[e].reverse(),P){var N=!1;for(f=0;f<S[e].length;f++)if(t.traceIs(S[e][f].trace,"pie-like")){N=!0;break}S[e].unshift({i:-1,groupTitle:P,noClick:N,trace:{showlegend:M.showlegend,legendgroup:M.legendgroup,visible:p.groupclick==="toggleitem"||M.visible}})}for(f=0;f<S[e].length;f++)S[e][f]=[S[e][f]]}return p._lgroupsLength=S.length,p._maxNameLength=g,S}},{"../../registry":915,"./helpers":706}],705:[function(r,O,B){var t=r("../../lib"),d=r("../../registry"),m=!0;O.exports=function(p,e,f){var u=e._fullLayout;if(!e._dragged&&!e._editing){var s,l=u.legend.itemclick,o=u.legend.itemdoubleclick,i=u.legend.groupclick;if(f===1&&l==="toggle"&&o==="toggleothers"&&m&&e.data&&e._context.showTips&&t.notifier(t._(e,"Double-click on legend to isolate one trace"),"long"),m=!1,f===1?s=l:f===2&&(s=o),s){var c=i==="togglegroup",n=u.hiddenlabels?u.hiddenlabels.slice():[],a=p.data()[0][0];if(!a.groupTitle||!a.noClick){var g,h,y,v,_,x=e._fullData,T=a.trace,A=T.legendgroup,S={},w=[],C=[],k=[];if(d.traceIs(T,"pie-like")){var L=a.label,M=n.indexOf(L);s==="toggle"?M===-1?n.push(L):n.splice(M,1):s==="toggleothers"&&(n=[],e.calcdata[0].forEach(function(W){L!==W.label&&n.push(W.label)}),e._fullLayout.hiddenlabels&&e._fullLayout.hiddenlabels.length===n.length&&M===-1&&(n=[])),d.call("_guiRelayout",e,"hiddenlabels",n)}else{var P,D=A&&A.length,N=[];if(D)for(g=0;g<x.length;g++)(P=x[g]).visible&&P.legendgroup===A&&N.push(g);if(s==="toggle"){var U;switch(T.visible){case!0:U="legendonly";break;case!1:U=!1;break;case"legendonly":U=!0}if(D)if(c)for(g=0;g<x.length;g++)x[g].visible!==!1&&x[g].legendgroup===A&&j(x[g],U);else j(T,U);else j(T,U)}else if(s==="toggleothers"){var q,X,K,Z,H=!0;for(g=0;g<x.length;g++)if(q=x[g]===T,K=x[g].showlegend!==!0,!(q||K||(X=D&&x[g].legendgroup===A)||x[g].visible!==!0||d.traceIs(x[g],"notLegendIsolatable"))){H=!1;break}for(g=0;g<x.length;g++)if(x[g].visible!==!1&&!d.traceIs(x[g],"notLegendIsolatable"))switch(T.visible){case"legendonly":j(x[g],!0);break;case!0:Z=!!H||"legendonly",q=x[g]===T,K=x[g].showlegend!==!0&&!x[g].legendgroup,X=q||D&&x[g].legendgroup===A,j(x[g],!(!X&&!K)||Z)}}for(g=0;g<C.length;g++)if(y=C[g]){var Y=y.constructUpdate(),$=Object.keys(Y);for(h=0;h<$.length;h++)v=$[h],(S[v]=S[v]||[])[k[g]]=Y[v]}for(_=Object.keys(S),g=0;g<_.length;g++)for(v=_[g],h=0;h<w.length;h++)S[v].hasOwnProperty(h)||(S[v][h]=void 0);d.call("_guiRestyle",e,S,w)}}}}function z(W,ee,J){var Q=w.indexOf(W),te=S[ee];return te||(te=S[ee]=[]),w.indexOf(W)===-1&&(w.push(W),Q=w.length-1),te[Q]=J,Q}function j(W,ee){if(!a.groupTitle||c){var J=W._fullInput;if(d.hasTransform(J,"groupby")){var Q=C[J.index];if(!Q){var te=d.getTransformIndices(J,"groupby"),ie=te[te.length-1];Q=t.keyedContainer(J,"transforms["+ie+"].styles","target","value.visible"),C[J.index]=Q}var ae=Q.get(W._group);ae===void 0&&(ae=!0),ae!==!1&&Q.set(W._group,ee),k[J.index]=z(J.index,"visible",J.visible!==!1)}else{var he=J.visible!==!1&&ee;z(J.index,"visible",he)}}}}},{"../../lib":787,"../../registry":915}],706:[function(r,O,B){B.isGrouped=function(t){return(t.traceorder||"").indexOf("grouped")!==-1},B.isVertical=function(t){return t.orientation!=="h"},B.isReversed=function(t){return(t.traceorder||"").indexOf("reversed")!==-1}},{}],707:[function(r,O,B){O.exports={moduleType:"component",name:"legend",layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),draw:r("./draw"),style:r("./style")}},{"./attributes":700,"./defaults":702,"./draw":703,"./style":708}],708:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../registry"),m=r("../../lib"),p=m.strTranslate,e=r("../drawing"),f=r("../color"),u=r("../colorscale/helpers").extractOpts,s=r("../../traces/scatter/subtypes"),l=r("../../traces/pie/style_one"),o=r("../../traces/pie/helpers").castOption,i=r("./constants");function c(g,h){return(h?"radial":"horizontal")+(g?"":"reversed")}function n(g){var h=g[0].trace,y=h.contours,v=s.hasLines(h),_=s.hasMarkers(h),x=h.visible&&h.fill&&h.fill!=="none",T=!1,A=!1;if(y){var S=y.coloring;S==="lines"?T=!0:v=S==="none"||S==="heatmap"||y.showlines,y.type==="constraint"?x=y._operation!=="=":S!=="fill"&&S!=="heatmap"||(A=!0)}return{showMarker:_,showLine:v,showFill:x,showGradientLine:T,showGradientFill:A,anyLine:v||T,anyFill:x||A}}function a(g,h,y){return g&&m.isArrayOrTypedArray(g)?h:g>y?y:g}O.exports=function(g,h,y){var v=h._fullLayout;y||(y=v.legend);var _=y.itemsizing==="constant",x=y.itemwidth,T=(x+2*i.itemGap)/2,A=p(T,0),S=function(k,L,M,P){var D;if(k+1)D=k;else{if(!(L&&L.width>0))return 0;D=L.width}return _?P:Math.min(D,M)};function w(k,L,M){var P=k[0].trace,D=P.marker||{},N=D.line||{},U=M?P.visible&&P.type===M:d.traceIs(P,"bar"),q=t.select(L).select("g.legendpoints").selectAll("path.legend"+M).data(U?[k]:[]);q.enter().append("path").classed("legend"+M,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",A),q.exit().remove(),q.each(function(X){var K=t.select(this),Z=X[0],H=S(Z.mlw,D.line,5,2);K.style("stroke-width",H+"px");var Y=Z.mcc;if(!y._inHover&&"mc"in Z){var $=u(D),z=$.mid;z===void 0&&(z=($.max+$.min)/2),Y=e.tryColorscale(D,"")(z)}var j=Y||Z.mc||D.color,W=D.pattern,ee=W&&e.getPatternAttr(W.shape,0,"");if(ee){var J=e.getPatternAttr(W.bgcolor,0,null),Q=e.getPatternAttr(W.fgcolor,0,null),te=W.fgopacity,ie=a(W.size,8,10),ae=a(W.solidity,.5,1),he="legend-"+P.uid;K.call(e.pattern,"legend",h,he,ee,ie,ae,Y,W.fillmode,J,Q,te)}else K.call(f.fill,j);H&&f.stroke(K,Z.mlc||N.color)})}function C(k,L,M){var P=k[0],D=P.trace,N=M?D.visible&&D.type===M:d.traceIs(D,M),U=t.select(L).select("g.legendpoints").selectAll("path.legend"+M).data(N?[k]:[]);if(U.enter().append("path").classed("legend"+M,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",A),U.exit().remove(),U.size()){var q=(D.marker||{}).line,X=S(o(q.width,P.pts),q,5,2),K=m.minExtend(D,{marker:{line:{width:X}}});K.marker.line.color=q.color;var Z=m.minExtend(P,{trace:K});l(U,Z,K)}}g.each(function(k){var L=t.select(this),M=m.ensureSingle(L,"g","layers");M.style("opacity",k[0].trace.opacity);var P=y.valign,D=k[0].lineHeight,N=k[0].height;if(P!=="middle"&&D&&N){var U={top:1,bottom:-1}[P]*(.5*(D-N+3));M.attr("transform",p(0,U))}else M.attr("transform",null);M.selectAll("g.legendfill").data([k]).enter().append("g").classed("legendfill",!0),M.selectAll("g.legendlines").data([k]).enter().append("g").classed("legendlines",!0);var q=M.selectAll("g.legendsymbols").data([k]);q.enter().append("g").classed("legendsymbols",!0),q.selectAll("g.legendpoints").data([k]).enter().append("g").classed("legendpoints",!0)}).each(function(k){var L,M=k[0].trace,P=[];if(M.visible)switch(M.type){case"histogram2d":case"heatmap":P=[["M-15,-2V4H15V-2Z"]],L=!0;break;case"choropleth":case"choroplethmapbox":P=[["M-6,-6V6H6V-6Z"]],L=!0;break;case"densitymapbox":P=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],L="radial";break;case"cone":P=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],L=!1;break;case"streamtube":P=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],L=!1;break;case"surface":P=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],L=!0;break;case"mesh3d":P=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],L=!1;break;case"volume":P=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],L=!0;break;case"isosurface":P=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],L=!1}var D=t.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(P);D.enter().append("path").classed("legend3dandfriends",!0).attr("transform",A).style("stroke-miterlimit",1),D.exit().remove(),D.each(function(N,U){var q,X=t.select(this),K=u(M),Z=K.colorscale,H=K.reversescale;if(Z){if(!L){var Y=Z.length;q=U===0?Z[H?Y-1:0][1]:U===1?Z[H?0:Y-1][1]:Z[Math.floor((Y-1)/2)][1]}}else{var $=M.vertexcolor||M.facecolor||M.color;q=m.isArrayOrTypedArray($)?$[U]||$[0]:$}X.attr("d",N[0]),q?X.call(f.fill,q):X.call(function(z){if(z.size()){var j="legendfill-"+M.uid;e.gradient(z,h,j,c(H,L==="radial"),Z,"fill")}})})}).each(function(k){var L=k[0].trace,M=L.type==="waterfall";if(k[0]._distinct&&M){var P=k[0].trace[k[0].dir].marker;return k[0].mc=P.color,k[0].mlw=P.line.width,k[0].mlc=P.line.color,w(k,this,"waterfall")}var D=[];L.visible&&M&&(D=k[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var N=t.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(D);N.enter().append("path").classed("legendwaterfall",!0).attr("transform",A).style("stroke-miterlimit",1),N.exit().remove(),N.each(function(U){var q=t.select(this),X=L[U[0]].marker,K=S(void 0,X.line,5,2);q.attr("d",U[1]).style("stroke-width",K+"px").call(f.fill,X.color),K&&q.call(f.stroke,X.line.color)})}).each(function(k){w(k,this,"funnel")}).each(function(k){w(k,this)}).each(function(k){var L=k[0].trace,M=t.select(this).select("g.legendpoints").selectAll("path.legendbox").data(L.visible&&d.traceIs(L,"box-violin")?[k]:[]);M.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",A),M.exit().remove(),M.each(function(){var P=t.select(this);if(L.boxpoints!=="all"&&L.points!=="all"||f.opacity(L.fillcolor)!==0||f.opacity((L.line||{}).color)!==0){var D=S(void 0,L.line,5,2);P.style("stroke-width",D+"px").call(f.fill,L.fillcolor),D&&f.stroke(P,L.line.color)}else{var N=m.minExtend(L,{marker:{size:_?12:m.constrain(L.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});M.call(e.pointStyle,N,h)}})}).each(function(k){C(k,this,"funnelarea")}).each(function(k){C(k,this,"pie")}).each(function(k){var L,M,P=n(k),D=P.showFill,N=P.showLine,U=P.showGradientLine,q=P.showGradientFill,X=P.anyFill,K=P.anyLine,Z=k[0],H=Z.trace,Y=u(H),$=Y.colorscale,z=Y.reversescale,j=s.hasMarkers(H)||!X?"M5,0":K?"M5,-2":"M5,-3",W=t.select(this),ee=W.select(".legendfill").selectAll("path").data(D||q?[k]:[]);if(ee.enter().append("path").classed("js-fill",!0),ee.exit().remove(),ee.attr("d",j+"h"+x+"v6h-"+x+"z").call(D?e.fillGroupStyle:function(te){if(te.size()){var ie="legendfill-"+H.uid;e.gradient(te,h,ie,c(z),$,"fill")}}),N||U){var J=S(void 0,H.line,10,5);M=m.minExtend(H,{line:{width:J}}),L=[m.minExtend(Z,{trace:M})]}var Q=W.select(".legendlines").selectAll("path").data(N||U?[L]:[]);Q.enter().append("path").classed("js-line",!0),Q.exit().remove(),Q.attr("d",j+(U?"l"+x+",0.0001":"h"+x)).call(N?e.lineGroupStyle:function(te){if(te.size()){var ie="legendline-"+H.uid;e.lineGroupStyle(te),e.gradient(te,h,ie,c(z),$,"stroke")}})}).each(function(k){var L,M,P=n(k),D=P.anyFill,N=P.anyLine,U=P.showLine,q=P.showMarker,X=k[0],K=X.trace,Z=!q&&!N&&!D&&s.hasText(K);function H(Q,te,ie,ae){var he=m.nestedProperty(K,Q).get(),se=m.isArrayOrTypedArray(he)&&te?te(he):he;if(_&&se&&ae!==void 0&&(se=ae),ie){if(se<ie[0])return ie[0];if(se>ie[1])return ie[1]}return se}function Y(Q){return X._distinct&&X.index&&Q[X.index]?Q[X.index]:Q[0]}if(q||Z||U){var $={},z={};if(q){$.mc=H("marker.color",Y),$.mx=H("marker.symbol",Y),$.mo=H("marker.opacity",m.mean,[.2,1]),$.mlc=H("marker.line.color",Y),$.mlw=H("marker.line.width",m.mean,[0,5],2),z.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var j=H("marker.size",m.mean,[2,16],12);$.ms=j,z.marker.size=j}U&&(z.line={width:H("line.width",Y,[0,10],5)}),Z&&($.tx="Aa",$.tp=H("textposition",Y),$.ts=10,$.tc=H("textfont.color",Y),$.tf=H("textfont.family",Y)),L=[m.minExtend(X,$)],(M=m.minExtend(K,z)).selectedpoints=null,M.texttemplate=null}var W=t.select(this).select("g.legendpoints"),ee=W.selectAll("path.scatterpts").data(q?L:[]);ee.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",A),ee.exit().remove(),ee.call(e.pointStyle,M,h),q&&(L[0].mrc=3);var J=W.selectAll("g.pointtext").data(Z?L:[]);J.enter().append("g").classed("pointtext",!0).append("text").attr("transform",A),J.exit().remove(),J.selectAll("text").call(e.textPointStyle,M,h)}).each(function(k){var L=k[0].trace,M=t.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(L.visible&&L.type==="candlestick"?[k,k]:[]);M.enter().append("path").classed("legendcandle",!0).attr("d",function(P,D){return D?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",A).style("stroke-miterlimit",1),M.exit().remove(),M.each(function(P,D){var N=t.select(this),U=L[D?"increasing":"decreasing"],q=S(void 0,U.line,5,2);N.style("stroke-width",q+"px").call(f.fill,U.fillcolor),q&&f.stroke(N,U.line.color)})}).each(function(k){var L=k[0].trace,M=t.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(L.visible&&L.type==="ohlc"?[k,k]:[]);M.enter().append("path").classed("legendohlc",!0).attr("d",function(P,D){return D?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",A).style("stroke-miterlimit",1),M.exit().remove(),M.each(function(P,D){var N=t.select(this),U=L[D?"increasing":"decreasing"],q=S(void 0,U.line,5,2);N.style("fill","none").call(e.dashLine,U.line.dash,q),q&&f.stroke(N,U.line.color)})})}},{"../../lib":787,"../../registry":915,"../../traces/pie/helpers":1181,"../../traces/pie/style_one":1187,"../../traces/scatter/subtypes":1227,"../color":650,"../colorscale/helpers":661,"../drawing":672,"./constants":701,"@plotly/d3":58}],709:[function(r,O,B){r("./constants"),O.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":711}],710:[function(r,O,B){var t=r("../../registry"),d=r("../../plots/plots"),m=r("../../plots/cartesian/axis_ids"),p=r("../../fonts/ploticon"),e=r("../shapes/draw").eraseActiveShape,f=r("../../lib"),u=f._,s=O.exports={};function l(v,_){var x,T,A=_.currentTarget,S=A.getAttribute("data-attr"),w=A.getAttribute("data-val")||!0,C=v._fullLayout,k={},L=m.list(v,null,!0),M=C._cartesianSpikesEnabled;if(S==="zoom"){var P,D=w==="in"?.5:2,N=(1+D)/2,U=(1-D)/2;for(T=0;T<L.length;T++)if(!(x=L[T]).fixedrange)if(P=x._name,w==="auto")k[P+".autorange"]=!0;else if(w==="reset"){if(x._rangeInitial===void 0)k[P+".autorange"]=!0;else{var q=x._rangeInitial.slice();k[P+".range[0]"]=q[0],k[P+".range[1]"]=q[1]}x._showSpikeInitial!==void 0&&(k[P+".showspikes"]=x._showSpikeInitial,M!=="on"||x._showSpikeInitial||(M="off"))}else{var X=[x.r2l(x.range[0]),x.r2l(x.range[1])],K=[N*X[0]+U*X[1],N*X[1]+U*X[0]];k[P+".range[0]"]=x.l2r(K[0]),k[P+".range[1]"]=x.l2r(K[1])}}else S!=="hovermode"||w!=="x"&&w!=="y"||(w=C._isHoriz?"y":"x",A.setAttribute("data-val",w)),k[S]=w;C._cartesianSpikesEnabled=M,t.call("_guiRelayout",v,k)}function o(v,_){for(var x=_.currentTarget,T=x.getAttribute("data-attr"),A=x.getAttribute("data-val")||!0,S=v._fullLayout._subplots.gl3d||[],w={},C=T.split("."),k=0;k<S.length;k++)w[S[k]+"."+C[1]]=A;var L=A==="pan"?A:"zoom";w.dragmode=L,t.call("_guiRelayout",v,w)}function i(v,_){for(var x=_.currentTarget.getAttribute("data-attr"),T=x==="resetLastSave",A=x==="resetDefault",S=v._fullLayout,w=S._subplots.gl3d||[],C={},k=0;k<w.length;k++){var L,M=w[k],P=M+".camera",D=M+".aspectratio",N=M+".aspectmode",U=S[M]._scene;T?(C[P+".up"]=U.viewInitial.up,C[P+".eye"]=U.viewInitial.eye,C[P+".center"]=U.viewInitial.center,L=!0):A&&(C[P+".up"]=null,C[P+".eye"]=null,C[P+".center"]=null,L=!0),L&&(C[D+".x"]=U.viewInitial.aspectratio.x,C[D+".y"]=U.viewInitial.aspectratio.y,C[D+".z"]=U.viewInitial.aspectratio.z,C[N]=U.viewInitial.aspectmode)}t.call("_guiRelayout",v,C)}function c(v,_){var x=_.currentTarget,T=x._previousVal,A=v._fullLayout,S=A._subplots.gl3d||[],w=["xaxis","yaxis","zaxis"],C={},k={};if(T)k=T,x._previousVal=null;else{for(var L=0;L<S.length;L++){var M=S[L],P=A[M],D=M+".hovermode";C[D]=P.hovermode,k[D]=!1;for(var N=0;N<3;N++){var U=w[N],q=M+"."+U+".showspikes";k[q]=!1,C[q]=P[U].showspikes}}x._previousVal=C}return k}function n(v,_){for(var x=_.currentTarget,T=x.getAttribute("data-attr"),A=x.getAttribute("data-val")||!0,S=v._fullLayout,w=S._subplots.geo||[],C=0;C<w.length;C++){var k=w[C],L=S[k];if(T==="zoom"){var M=L.projection.scale,P=A==="in"?2*M:.5*M;t.call("_guiRelayout",v,k+".projection.scale",P)}}T==="reset"&&y(v,"geo")}function a(v){var _=v._fullLayout;return!_.hovermode&&(_._has("cartesian")?_._isHoriz?"y":"x":"closest")}function g(v){var _=a(v);t.call("_guiRelayout",v,"hovermode",_)}function h(v,_){for(var x=_.currentTarget.getAttribute("data-val"),T=v._fullLayout,A=T._subplots.mapbox||[],S={},w=0;w<A.length;w++){var C=A[w],k=T[C].zoom,L=x==="in"?1.05*k:k/1.05;S[C+".zoom"]=L}t.call("_guiRelayout",v,S)}function y(v,_){for(var x=v._fullLayout,T=x._subplots[_]||[],A={},S=0;S<T.length;S++)for(var w=T[S],C=x[w]._subplot.viewInitial,k=Object.keys(C),L=0;L<k.length;L++){var M=k[L];A[w+"."+M]=C[M]}t.call("_guiRelayout",v,A)}s.toImage={name:"toImage",title:function(v){var _=(v._context.toImageButtonOptions||{}).format||"png";return u(v,_==="png"?"Download plot as a png":"Download plot")},icon:p.camera,click:function(v){var _=v._context.toImageButtonOptions,x={format:_.format||"png"};f.notifier(u(v,"Taking snapshot - this may take a few seconds"),"long"),x.format!=="svg"&&f.isIE()&&(f.notifier(u(v,"IE only supports svg.  Changing format to svg."),"long"),x.format="svg"),["filename","width","height","scale"].forEach(function(T){T in _&&(x[T]=_[T])}),t.call("downloadImage",v,x).then(function(T){f.notifier(u(v,"Snapshot succeeded")+" - "+T,"long")}).catch(function(){f.notifier(u(v,"Sorry, there was a problem downloading your snapshot!"),"long")})}},s.sendDataToCloud={name:"sendDataToCloud",title:function(v){return u(v,"Edit in Chart Studio")},icon:p.disk,click:function(v){d.sendDataToCloud(v)}},s.editInChartStudio={name:"editInChartStudio",title:function(v){return u(v,"Edit in Chart Studio")},icon:p.pencil,click:function(v){d.sendDataToCloud(v)}},s.zoom2d={name:"zoom2d",_cat:"zoom",title:function(v){return u(v,"Zoom")},attr:"dragmode",val:"zoom",icon:p.zoombox,click:l},s.pan2d={name:"pan2d",_cat:"pan",title:function(v){return u(v,"Pan")},attr:"dragmode",val:"pan",icon:p.pan,click:l},s.select2d={name:"select2d",_cat:"select",title:function(v){return u(v,"Box Select")},attr:"dragmode",val:"select",icon:p.selectbox,click:l},s.lasso2d={name:"lasso2d",_cat:"lasso",title:function(v){return u(v,"Lasso Select")},attr:"dragmode",val:"lasso",icon:p.lasso,click:l},s.drawclosedpath={name:"drawclosedpath",title:function(v){return u(v,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:p.drawclosedpath,click:l},s.drawopenpath={name:"drawopenpath",title:function(v){return u(v,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:p.drawopenpath,click:l},s.drawline={name:"drawline",title:function(v){return u(v,"Draw line")},attr:"dragmode",val:"drawline",icon:p.drawline,click:l},s.drawrect={name:"drawrect",title:function(v){return u(v,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:p.drawrect,click:l},s.drawcircle={name:"drawcircle",title:function(v){return u(v,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:p.drawcircle,click:l},s.eraseshape={name:"eraseshape",title:function(v){return u(v,"Erase active shape")},icon:p.eraseshape,click:e},s.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(v){return u(v,"Zoom in")},attr:"zoom",val:"in",icon:p.zoom_plus,click:l},s.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(v){return u(v,"Zoom out")},attr:"zoom",val:"out",icon:p.zoom_minus,click:l},s.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(v){return u(v,"Autoscale")},attr:"zoom",val:"auto",icon:p.autoscale,click:l},s.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(v){return u(v,"Reset axes")},attr:"zoom",val:"reset",icon:p.home,click:l},s.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(v){return u(v,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:p.tooltip_basic,gravity:"ne",click:l},s.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(v){return u(v,"Compare data on hover")},attr:"hovermode",val:function(v){return v._fullLayout._isHoriz?"y":"x"},icon:p.tooltip_compare,gravity:"ne",click:l},s.zoom3d={name:"zoom3d",_cat:"zoom",title:function(v){return u(v,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:p.zoombox,click:o},s.pan3d={name:"pan3d",_cat:"pan",title:function(v){return u(v,"Pan")},attr:"scene.dragmode",val:"pan",icon:p.pan,click:o},s.orbitRotation={name:"orbitRotation",title:function(v){return u(v,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:p["3d_rotate"],click:o},s.tableRotation={name:"tableRotation",title:function(v){return u(v,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:p["z-axis"],click:o},s.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(v){return u(v,"Reset camera to default")},attr:"resetDefault",icon:p.home,click:i},s.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(v){return u(v,"Reset camera to last save")},attr:"resetLastSave",icon:p.movie,click:i},s.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(v){return u(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:p.tooltip_basic,gravity:"ne",click:function(v,_){var x=c(v,_);t.call("_guiRelayout",v,x)}},s.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(v){return u(v,"Zoom in")},attr:"zoom",val:"in",icon:p.zoom_plus,click:n},s.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(v){return u(v,"Zoom out")},attr:"zoom",val:"out",icon:p.zoom_minus,click:n},s.resetGeo={name:"resetGeo",_cat:"reset",title:function(v){return u(v,"Reset")},attr:"reset",val:null,icon:p.autoscale,click:n},s.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(v){return u(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:p.tooltip_basic,gravity:"ne",click:g},s.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(v){return u(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:p.tooltip_basic,gravity:"ne",click:g},s.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(v){return u(v,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:p.tooltip_basic,gravity:"ne",click:g},s.resetViewSankey={name:"resetSankeyGroup",title:function(v){return u(v,"Reset view")},icon:p.home,click:function(v){for(var _={"node.groups":[],"node.x":[],"node.y":[]},x=0;x<v._fullData.length;x++){var T=v._fullData[x]._viewInitial;_["node.groups"].push(T.node.groups.slice()),_["node.x"].push(T.node.x.slice()),_["node.y"].push(T.node.y.slice())}t.call("restyle",v,_)}},s.toggleHover={name:"toggleHover",title:function(v){return u(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:p.tooltip_basic,gravity:"ne",click:function(v,_){var x=c(v,_);x.hovermode=a(v),t.call("_guiRelayout",v,x)}},s.resetViews={name:"resetViews",title:function(v){return u(v,"Reset views")},icon:p.home,click:function(v,_){var x=_.currentTarget;x.setAttribute("data-attr","zoom"),x.setAttribute("data-val","reset"),l(v,_),x.setAttribute("data-attr","resetLastSave"),i(v,_),y(v,"geo"),y(v,"mapbox")}},s.toggleSpikelines={name:"toggleSpikelines",title:function(v){return u(v,"Toggle Spike Lines")},icon:p.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(v){var _=v._fullLayout,x=_._cartesianSpikesEnabled;_._cartesianSpikesEnabled=x==="on"?"off":"on",t.call("_guiRelayout",v,function(T){for(var A=T._fullLayout._cartesianSpikesEnabled==="on",S=m.list(T,null,!0),w={},C=0;C<S.length;C++){var k=S[C];w[k._name+".showspikes"]=!!A||k._showSpikeInitial}return w}(v))}},s.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(v){return u(v,"Reset view")},attr:"reset",icon:p.home,click:function(v){y(v,"mapbox")}},s.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(v){return u(v,"Zoom in")},attr:"zoom",val:"in",icon:p.zoom_plus,click:h},s.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(v){return u(v,"Zoom out")},attr:"zoom",val:"out",icon:p.zoom_minus,click:h}},{"../../fonts/ploticon":766,"../../lib":787,"../../plots/cartesian/axis_ids":842,"../../plots/plots":901,"../../registry":915,"../shapes/draw":734}],711:[function(r,O,B){var t=r("./buttons"),d=Object.keys(t),m=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],p=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(m),e=[];d.forEach(function(f){(function(u){if(p.indexOf(u._cat||u.name)===-1){var s=u.name,l=(u._cat||u.name).toLowerCase();e.indexOf(s)===-1&&e.push(s),e.indexOf(l)===-1&&e.push(l)}})(t[f])}),e.sort(),O.exports={DRAW_MODES:m,backButtons:p,foreButtons:e}},{"./buttons":710}],712:[function(r,O,B){var t=r("../../lib"),d=r("../color"),m=r("../../plot_api/plot_template"),p=r("./attributes");O.exports=function(e,f){var u=e.modebar||{},s=m.newContainer(f,"modebar");function l(i,c){return t.coerce(u,s,p,i,c)}l("orientation"),l("bgcolor",d.addOpacity(f.paper_bgcolor,.5));var o=d.contrast(d.rgb(f.modebar.bgcolor));l("color",d.addOpacity(o,.3)),l("activecolor",d.addOpacity(o,.7)),l("uirevision",f.uirevision),l("add"),l("remove")}},{"../../lib":787,"../../plot_api/plot_template":827,"../color":650,"./attributes":709}],713:[function(r,O,B){O.exports={moduleType:"component",name:"modebar",layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),manage:r("./manage")}},{"./attributes":709,"./defaults":712,"./manage":714}],714:[function(r,O,B){var t=r("../../plots/cartesian/axis_ids"),d=r("../../traces/scatter/subtypes"),m=r("../../registry"),p=r("../fx/helpers").isUnifiedHover,e=r("./modebar"),f=r("./buttons"),u=r("./constants").DRAW_MODES;O.exports=function(s){var l=s._fullLayout,o=s._context,i=l._modeBar;if(o.displayModeBar||o.watermark){if(!Array.isArray(o.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(o.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var c,n=o.modeBarButtons;c=Array.isArray(n)&&n.length?function(a){for(var g=0;g<a.length;g++)for(var h=a[g],y=0;y<h.length;y++){var v=h[y];if(typeof v=="string"){if(f[v]===void 0)throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "));a[g][y]=f[v]}}return a}(n):!o.displayModeBar&&o.watermark?[]:function(a){var g=a._fullLayout,h=a._fullData,y=a._context;function v(ie,ae){if(typeof ae=="string"){if(ae.toLowerCase()===ie.toLowerCase())return!0}else{var he=ae.name,se=ae._cat||ae.name;if(he===ie||se===ie.toLowerCase())return!0}return!1}var _=g.modebar.add;typeof _=="string"&&(_=[_]);var x=g.modebar.remove;typeof x=="string"&&(x=[x]);var T=y.modeBarButtonsToAdd.concat(_.filter(function(ie){for(var ae=0;ae<y.modeBarButtonsToRemove.length;ae++)if(v(ie,y.modeBarButtonsToRemove[ae]))return!1;return!0})),A=y.modeBarButtonsToRemove.concat(x.filter(function(ie){for(var ae=0;ae<y.modeBarButtonsToAdd.length;ae++)if(v(ie,y.modeBarButtonsToAdd[ae]))return!1;return!0})),S=g._has("cartesian"),w=g._has("gl3d"),C=g._has("geo"),k=g._has("pie"),L=g._has("funnelarea"),M=g._has("gl2d"),P=g._has("ternary"),D=g._has("mapbox"),N=g._has("polar"),U=g._has("sankey"),q=function(ie){for(var ae=t.list({_fullLayout:ie},null,!0),he=0;he<ae.length;he++)if(!ae[he].fixedrange)return!1;return!0}(g),X=p(g.hovermode),K=[];function Z(ie){if(ie.length){for(var ae=[],he=0;he<ie.length;he++){for(var se=ie[he],de=f[se],ue=de.name.toLowerCase(),ve=(de._cat||de.name).toLowerCase(),ke=!1,Ee=0;Ee<A.length;Ee++){var be=A[Ee].toLowerCase();if(be===ue||be===ve){ke=!0;break}}ke||ae.push(f[se])}K.push(ae)}}var H=["toImage"];y.showEditInChartStudio?H.push("editInChartStudio"):y.showSendToCloud&&H.push("sendDataToCloud"),Z(H);var Y=[],$=[],z=[],j=[];(S||M||k||L||P)+C+w+D+N>1?($=["toggleHover"],z=["resetViews"]):C?(Y=["zoomInGeo","zoomOutGeo"],$=["hoverClosestGeo"],z=["resetGeo"]):w?($=["hoverClosest3d"],z=["resetCameraDefault3d","resetCameraLastSave3d"]):D?(Y=["zoomInMapbox","zoomOutMapbox"],$=["toggleHover"],z=["resetViewMapbox"]):M?$=["hoverClosestGl2d"]:k?$=["hoverClosestPie"]:U?($=["hoverClosestCartesian","hoverCompareCartesian"],z=["resetViewSankey"]):$=["toggleHover"],S&&($=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(function(ie){for(var ae=0;ae<ie.length;ae++)if(!m.traceIs(ie[ae],"noHover"))return!1;return!0}(h)||X)&&($=[]),!S&&!M||q||(Y=["zoomIn2d","zoomOut2d","autoScale2d"],z[0]!=="resetViews"&&(z=["resetScale2d"])),w?j=["zoom3d","pan3d","orbitRotation","tableRotation"]:(S||M)&&!q||P?j=["zoom2d","pan2d"]:D||C?j=["pan2d"]:N&&(j=["zoom2d"]),function(ie){for(var ae=!1,he=0;he<ie.length&&!ae;he++){var se=ie[he];se._module&&se._module.selectPoints&&(m.traceIs(se,"scatter-like")?(d.hasMarkers(se)||d.hasText(se))&&(ae=!0):m.traceIs(se,"box-violin")&&se.boxpoints!=="all"&&se.points!=="all"||(ae=!0))}return ae}(h)&&j.push("select2d","lasso2d");var W=[],ee=function(ie){W.indexOf(ie)===-1&&$.indexOf(ie)!==-1&&W.push(ie)};if(Array.isArray(T)){for(var J=[],Q=0;Q<T.length;Q++){var te=T[Q];typeof te=="string"?(te=te.toLowerCase(),u.indexOf(te)!==-1?(g._has("mapbox")||g._has("cartesian"))&&j.push(te):te==="togglespikelines"?ee("toggleSpikelines"):te==="togglehover"?ee("toggleHover"):te==="hovercompare"?ee("hoverCompareCartesian"):te==="hoverclosest"?(ee("hoverClosestCartesian"),ee("hoverClosestGeo"),ee("hoverClosest3d"),ee("hoverClosestGl2d"),ee("hoverClosestPie")):te==="v1hovermode"&&(ee("toggleHover"),ee("hoverClosestCartesian"),ee("hoverCompareCartesian"),ee("hoverClosestGeo"),ee("hoverClosest3d"),ee("hoverClosestGl2d"),ee("hoverClosestPie"))):J.push(te)}T=J}return Z(j),Z(Y.concat(z)),Z(W),function(ie,ae){if(ae.length)if(Array.isArray(ae[0]))for(var he=0;he<ae.length;he++)ie.push(ae[he]);else ie.push(ae);return ie}(K,T)}(s),i?i.update(s,c):l._modeBar=e(s,c)}else i&&(i.destroy(),delete l._modeBar)}},{"../../plots/cartesian/axis_ids":842,"../../registry":915,"../../traces/scatter/subtypes":1227,"../fx/helpers":686,"./buttons":710,"./constants":711,"./modebar":715}],715:[function(r,O,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("../../lib"),p=r("../../fonts/ploticon"),e=new DOMParser;function f(s){this.container=s.container,this.element=document.createElement("div"),this.update(s.graphInfo,s.buttons),this.container.appendChild(this.element)}var u=f.prototype;u.update=function(s,l){this.graphInfo=s;var o=this.graphInfo._context,i=this.graphInfo._fullLayout,c="modebar-"+i._uid;this.element.setAttribute("id",c),this._uid=c,this.element.className="modebar",o.displayModeBar==="hover"&&(this.element.className+=" modebar--hover ease-bg"),i.modebar.orientation==="v"&&(this.element.className+=" vertical",l=l.reverse());var n=i.modebar,a=o.displayModeBar==="hover"?".js-plotly-plot .plotly:hover ":"";m.deleteRelatedStyleRule(c),m.addRelatedStyleRule(c,a+"#"+c+" .modebar-group","background-color: "+n.bgcolor),m.addRelatedStyleRule(c,"#"+c+" .modebar-btn .icon path","fill: "+n.color),m.addRelatedStyleRule(c,"#"+c+" .modebar-btn:hover .icon path","fill: "+n.activecolor),m.addRelatedStyleRule(c,"#"+c+" .modebar-btn.active .icon path","fill: "+n.activecolor);var g=!this.hasButtons(l),h=this.hasLogo!==o.displaylogo,y=this.locale!==o.locale;if(this.locale=o.locale,(g||h||y)&&(this.removeAllButtons(),this.updateButtons(l),o.watermark||o.displaylogo)){var v=this.getLogo();o.watermark&&(v.className=v.className+" watermark"),i.modebar.orientation==="v"?this.element.insertBefore(v,this.element.childNodes[0]):this.element.appendChild(v),this.hasLogo=!0}this.updateActiveButton()},u.updateButtons=function(s){var l=this;this.buttons=s,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(o){var i=l.createGroup();o.forEach(function(c){var n=c.name;if(!n)throw new Error("must provide button 'name' in button config");if(l.buttonsNames.indexOf(n)!==-1)throw new Error("button name '"+n+"' is taken");l.buttonsNames.push(n);var a=l.createButton(c);l.buttonElements.push(a),i.appendChild(a)}),l.element.appendChild(i)})},u.createGroup=function(){var s=document.createElement("div");return s.className="modebar-group",s},u.createButton=function(s){var l=this,o=document.createElement("a");o.setAttribute("rel","tooltip"),o.className="modebar-btn";var i=s.title;i===void 0?i=s.name:typeof i=="function"&&(i=i(this.graphInfo)),(i||i===0)&&o.setAttribute("data-title",i),s.attr!==void 0&&o.setAttribute("data-attr",s.attr);var c=s.val;if(c!==void 0&&(typeof c=="function"&&(c=c(this.graphInfo)),o.setAttribute("data-val",c)),typeof s.click!="function")throw new Error("must provide button 'click' function in button config");o.addEventListener("click",function(a){s.click(l.graphInfo,a),l.updateActiveButton(a.currentTarget)}),o.setAttribute("data-toggle",s.toggle||!1),s.toggle&&t.select(o).classed("active",!0);var n=s.icon;return typeof n=="function"?o.appendChild(n()):o.appendChild(this.createIcon(n||p.question)),o.setAttribute("data-gravity",s.gravity||"n"),o},u.createIcon=function(s){var l,o=d(s.height)?Number(s.height):s.ascent-s.descent,i="http://www.w3.org/2000/svg";if(s.path){(l=document.createElementNS(i,"svg")).setAttribute("viewBox",[0,0,s.width,o].join(" ")),l.setAttribute("class","icon");var c=document.createElementNS(i,"path");c.setAttribute("d",s.path),s.transform?c.setAttribute("transform",s.transform):s.ascent!==void 0&&c.setAttribute("transform","matrix(1 0 0 -1 0 "+s.ascent+")"),l.appendChild(c)}return s.svg&&(l=e.parseFromString(s.svg,"application/xml").childNodes[0]),l.setAttribute("height","1em"),l.setAttribute("width","1em"),l},u.updateActiveButton=function(s){var l=this.graphInfo._fullLayout,o=s!==void 0?s.getAttribute("data-attr"):null;this.buttonElements.forEach(function(i){var c=i.getAttribute("data-val")||!0,n=i.getAttribute("data-attr"),a=i.getAttribute("data-toggle")==="true",g=t.select(i);if(a)n===o&&g.classed("active",!g.classed("active"));else{var h=n===null?n:m.nestedProperty(l,n).get();g.classed("active",h===c)}})},u.hasButtons=function(s){var l=this.buttons;if(!l||s.length!==l.length)return!1;for(var o=0;o<s.length;++o){if(s[o].length!==l[o].length)return!1;for(var i=0;i<s[o].length;i++)if(s[o][i].name!==l[o][i].name)return!1}return!0},u.getLogo=function(){var s=this.createGroup(),l=document.createElement("a");return l.href="https://plotly.com/",l.target="_blank",l.setAttribute("data-title",m._(this.graphInfo,"Produced with Plotly")),l.className="modebar-btn plotlyjsicon modebar-btn--logo",l.appendChild(this.createIcon(p.newplotlylogo)),s.appendChild(l),s},u.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},u.destroy=function(){m.removeElement(this.container.querySelector(".modebar")),m.deleteRelatedStyleRule(this._uid)},O.exports=function(s,l){var o=s._fullLayout,i=new f({graphInfo:s,container:o._modebardiv.node(),buttons:l});return o._privateplot&&t.select(i.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),i}},{"../../fonts/ploticon":766,"../../lib":787,"@plotly/d3":58,"fast-isnumeric":246}],716:[function(r,O,B){var t=r("../../plots/font_attributes"),d=r("../color/attributes"),m=(0,r("../../plot_api/plot_template").templatedArray)("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});O.exports={visible:{valType:"boolean",editType:"plot"},buttons:m,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:t({editType:"plot"}),bgcolor:{valType:"color",dflt:d.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:d.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":827,"../../plots/font_attributes":867,"../color/attributes":649}],717:[function(r,O,B){O.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],718:[function(r,O,B){var t=r("../../lib"),d=r("../color"),m=r("../../plot_api/plot_template"),p=r("../../plots/array_container_defaults"),e=r("./attributes"),f=r("./constants");function u(s,l,o,i){var c=i.calendar;function n(g,h){return t.coerce(s,l,e.buttons,g,h)}if(n("visible")){var a=n("step");a!=="all"&&(!c||c==="gregorian"||a!=="month"&&a!=="year"?n("stepmode"):l.stepmode="backward",n("count")),n("label")}}O.exports=function(s,l,o,i,c){var n=s.rangeselector||{},a=m.newContainer(l,"rangeselector");function g(v,_){return t.coerce(n,a,e,v,_)}if(g("visible",p(n,a,{name:"buttons",handleItemDefaults:u,calendar:c}).length>0)){var h=function(v,_,x){for(var T=x.filter(function(C){return _[C].anchor===v._id}),A=0,S=0;S<T.length;S++){var w=_[T[S]].domain;w&&(A=Math.max(w[1],A))}return[v.domain[0],A+f.yPad]}(l,o,i);g("x",h[0]),g("y",h[1]),t.noneOrAll(s,l,["x","y"]),g("xanchor"),g("yanchor"),t.coerceFont(g,"font",o.font);var y=g("bgcolor");g("activecolor",d.contrast(y,f.lightAmount,f.darkAmount)),g("bordercolor"),g("borderwidth")}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/array_container_defaults":833,"../color":650,"./attributes":716,"./constants":717}],719:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../registry"),m=r("../../plots/plots"),p=r("../color"),e=r("../drawing"),f=r("../../lib"),u=f.strTranslate,s=r("../../lib/svg_text_utils"),l=r("../../plots/cartesian/axis_ids"),o=r("../../constants/alignment"),i=o.LINE_SPACING,c=o.FROM_TL,n=o.FROM_BR,a=r("./constants"),g=r("./get_update_object");function h(_){return _._id}function y(_,x,T){var A=f.ensureSingle(_,"rect","selector-rect",function(S){S.attr("shape-rendering","crispEdges")});A.attr({rx:a.rx,ry:a.ry}),A.call(p.stroke,x.bordercolor).call(p.fill,function(S,w){return w._isActive||w._isHovered?S.activecolor:S.bgcolor}(x,T)).style("stroke-width",x.borderwidth+"px")}function v(_,x,T,A){f.ensureSingle(_,"text","selector-text",function(S){S.attr("text-anchor","middle")}).call(e.font,x.font).text(function(S,w){return S.label?w?f.templateString(S.label,w):S.label:S.step==="all"?"all":S.count+S.step.charAt(0)}(T,A._fullLayout._meta)).call(function(S){s.convertToTspans(S,A)})}O.exports=function(_){var x=_._fullLayout._infolayer.selectAll(".rangeselector").data(function(T){for(var A=l.list(T,"x",!0),S=[],w=0;w<A.length;w++){var C=A[w];C.rangeselector&&C.rangeselector.visible&&S.push(C)}return S}(_),h);x.enter().append("g").classed("rangeselector",!0),x.exit().remove(),x.style({cursor:"pointer","pointer-events":"all"}),x.each(function(T){var A=t.select(this),S=T,w=S.rangeselector,C=A.selectAll("g.button").data(f.filterVisible(w.buttons));C.enter().append("g").classed("button",!0),C.exit().remove(),C.each(function(k){var L=t.select(this),M=g(S,k);k._isActive=function(P,D,N){if(D.step==="all")return P.autorange===!0;var U=Object.keys(N);return P.range[0]===N[U[0]]&&P.range[1]===N[U[1]]}(S,k,M),L.call(y,w,k),L.call(v,w,k,_),L.on("click",function(){_._dragged||d.call("_guiRelayout",_,M)}),L.on("mouseover",function(){k._isHovered=!0,L.call(y,w,k)}),L.on("mouseout",function(){k._isHovered=!1,L.call(y,w,k)})}),function(k,L,M,P,D){var N=0,U=0,q=M.borderwidth;L.each(function(){var $=t.select(this).select(".selector-text"),z=M.font.size*i,j=Math.max(z*s.lineCount($),16)+3;U=Math.max(U,j)}),L.each(function(){var $=t.select(this),z=$.select(".selector-rect"),j=$.select(".selector-text"),W=j.node()&&e.bBox(j.node()).width,ee=M.font.size*i,J=s.lineCount(j),Q=Math.max(W+10,a.minButtonWidth);$.attr("transform",u(q+N,q)),z.attr({x:0,y:0,width:Q,height:U}),s.positionText(j,Q/2,U/2-(J-1)*ee/2+3),N+=Q+5});var X=k._fullLayout._size,K=X.l+X.w*M.x,Z=X.t+X.h*(1-M.y),H="left";f.isRightAnchor(M)&&(K-=N,H="right"),f.isCenterAnchor(M)&&(K-=N/2,H="center");var Y="top";f.isBottomAnchor(M)&&(Z-=U,Y="bottom"),f.isMiddleAnchor(M)&&(Z-=U/2,Y="middle"),N=Math.ceil(N),U=Math.ceil(U),K=Math.round(K),Z=Math.round(Z),m.autoMargin(k,P+"-range-selector",{x:M.x,y:M.y,l:N*c[H],r:N*n[H],b:U*n[Y],t:U*c[Y]}),D.attr("transform",u(K,Z))}(_,C,w,S._name,A)})}},{"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/cartesian/axis_ids":842,"../../plots/plots":901,"../../registry":915,"../color":650,"../drawing":672,"./constants":717,"./get_update_object":720,"@plotly/d3":58}],720:[function(r,O,B){var t=r("d3-time"),d=r("../../lib").titleCase;O.exports=function(m,p){var e=m._name,f={};if(p.step==="all")f[e+".autorange"]=!0;else{var u=function(s,l){var o,i=s.range,c=new Date(s.r2l(i[1])),n=l.step,a=t["utc"+d(n)],g=l.count;switch(l.stepmode){case"backward":o=s.l2r(+a.offset(c,-g));break;case"todate":var h=a.offset(c,-g);o=s.l2r(+a.ceil(h))}var y=i[1];return[o,y]}(m,p);f[e+".range[0]"]=u[0],f[e+".range[1]"]=u[1]}return f}},{"../../lib":787,"d3-time":174}],721:[function(r,O,B){O.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:r("./attributes")}}},layoutAttributes:r("./attributes"),handleDefaults:r("./defaults"),draw:r("./draw")}},{"./attributes":716,"./defaults":718,"./draw":719}],722:[function(r,O,B){var t=r("../color/attributes");O.exports={bgcolor:{valType:"color",dflt:t.background,editType:"plot"},bordercolor:{valType:"color",dflt:t.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":649}],723:[function(r,O,B){var t=r("../../plots/cartesian/axis_ids").list,d=r("../../plots/cartesian/autorange").getAutoRange,m=r("./constants");O.exports=function(p){for(var e=t(p,"x",!0),f=0;f<e.length;f++){var u=e[f],s=u[m.name];s&&s.visible&&s.autorange&&(s._input.autorange=!0,s._input.range=s.range=d(p,u))}}},{"../../plots/cartesian/autorange":837,"../../plots/cartesian/axis_ids":842,"./constants":724}],724:[function(r,O,B){O.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],725:[function(r,O,B){var t=r("../../lib"),d=r("../../plot_api/plot_template"),m=r("../../plots/cartesian/axis_ids"),p=r("./attributes"),e=r("./oppaxis_attributes");O.exports=function(f,u,s){var l=f[s],o=u[s];if(l.rangeslider||u._requestRangeslider[o._id]){t.isPlainObject(l.rangeslider)||(l.rangeslider={});var i,c,n=l.rangeslider,a=d.newContainer(o,"rangeslider");if(A("visible")){A("bgcolor",u.plot_bgcolor),A("bordercolor"),A("borderwidth"),A("thickness"),A("autorange",!o.isValidRange(n.range)),A("range");var g=u._subplots;if(g)for(var h=g.cartesian.filter(function(w){return w.substr(0,w.indexOf("y"))===m.name2id(s)}).map(function(w){return w.substr(w.indexOf("y"),w.length)}),y=t.simpleMap(h,m.id2name),v=0;v<y.length;v++){var _=y[v];i=n[_]||{},c=d.newContainer(a,_,"yaxis");var x,T=u[_];i.range&&T.isValidRange(i.range)&&(x="fixed"),S("rangemode",x)!=="match"&&S("range",T.range.slice())}a._input=n}}function A(w,C){return t.coerce(n,a,p,w,C)}function S(w,C){return t.coerce(i,c,e,w,C)}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/cartesian/axis_ids":842,"./attributes":722,"./oppaxis_attributes":729}],726:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../registry"),m=r("../../plots/plots"),p=r("../../lib"),e=p.strTranslate,f=r("../drawing"),u=r("../color"),s=r("../titles"),l=r("../../plots/cartesian"),o=r("../../plots/cartesian/axis_ids"),i=r("../dragelement"),c=r("../../lib/setcursor"),n=r("./constants");function a(x,T,A,S){var w=p.ensureSingle(x,"rect",n.bgClassName,function(M){M.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),C=S.borderwidth%2==0?S.borderwidth:S.borderwidth-1,k=-S._offsetShift,L=f.crispRound(T,S.borderwidth);w.attr({width:S._width+C,height:S._height+C,transform:e(k,k),fill:S.bgcolor,stroke:S.bordercolor,"stroke-width":L})}function g(x,T,A,S){var w=T._fullLayout;p.ensureSingleById(w._topdefs,"clipPath",S._clipId,function(C){C.append("rect").attr({x:0,y:0})}).select("rect").attr({width:S._width,height:S._height})}function h(x,T,A,S){var w,C=T.calcdata,k=x.selectAll("g."+n.rangePlotClassName).data(A._subplotsWith,p.identity);k.enter().append("g").attr("class",function(L){return n.rangePlotClassName+" "+L}).call(f.setClipUrl,S._clipId,T),k.order(),k.exit().remove(),k.each(function(L,M){var P=t.select(this),D=M===0,N=o.getFromId(T,L,"y"),U=N._name,q=S[U],X={data:[],layout:{xaxis:{type:A.type,domain:[0,1],range:S.range.slice(),calendar:A.calendar},width:S._width,height:S._height,margin:{t:0,b:0,l:0,r:0}},_context:T._context};A.rangebreaks&&(X.layout.xaxis.rangebreaks=A.rangebreaks),X.layout[U]={type:N.type,domain:[0,1],range:q.rangemode!=="match"?q.range.slice():N.range.slice(),calendar:N.calendar},N.rangebreaks&&(X.layout[U].rangebreaks=N.rangebreaks),m.supplyDefaults(X);var K=X._fullLayout.xaxis,Z=X._fullLayout[U];K.clearCalc(),K.setScale(),Z.clearCalc(),Z.setScale();var H={id:L,plotgroup:P,xaxis:K,yaxis:Z,isRangePlot:!0};D?w=H:(H.mainplot="xy",H.mainplotinfo=w),l.rangePlot(T,H,function(Y,$){for(var z=[],j=0;j<Y.length;j++){var W=Y[j],ee=W[0].trace;ee.xaxis+ee.yaxis===$&&z.push(W)}return z}(C,L))})}function y(x,T,A,S,w){p.ensureSingle(x,"rect",n.maskMinClassName,function(C){C.attr({x:0,y:0,"shape-rendering":"crispEdges"})}).attr("height",S._height).call(u.fill,n.maskColor),p.ensureSingle(x,"rect",n.maskMaxClassName,function(C){C.attr({y:0,"shape-rendering":"crispEdges"})}).attr("height",S._height).call(u.fill,n.maskColor),w.rangemode!=="match"&&(p.ensureSingle(x,"rect",n.maskMinOppAxisClassName,function(C){C.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",S._width).call(u.fill,n.maskOppAxisColor),p.ensureSingle(x,"rect",n.maskMaxOppAxisClassName,function(C){C.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",S._width).style("border-top",n.maskOppBorder).call(u.fill,n.maskOppAxisColor))}function v(x,T,A,S){T._context.staticPlot||p.ensureSingle(x,"rect",n.slideBoxClassName,function(w){w.attr({y:0,cursor:n.slideBoxCursor,"shape-rendering":"crispEdges"})}).attr({height:S._height,fill:n.slideBoxFill})}function _(x,T,A,S){var w=p.ensureSingle(x,"g",n.grabberMinClassName),C=p.ensureSingle(x,"g",n.grabberMaxClassName),k={x:0,width:n.handleWidth,rx:n.handleRadius,fill:u.background,stroke:u.defaultLine,"stroke-width":n.handleStrokeWidth,"shape-rendering":"crispEdges"},L={y:Math.round(S._height/4),height:Math.round(S._height/2)};p.ensureSingle(w,"rect",n.handleMinClassName,function(P){P.attr(k)}).attr(L),p.ensureSingle(C,"rect",n.handleMaxClassName,function(P){P.attr(k)}).attr(L);var M={width:n.grabAreaWidth,x:0,y:0,fill:n.grabAreaFill,cursor:T._context.staticPlot?void 0:n.grabAreaCursor};p.ensureSingle(w,"rect",n.grabAreaMinClassName,function(P){P.attr(M)}).attr("height",S._height),p.ensureSingle(C,"rect",n.grabAreaMaxClassName,function(P){P.attr(M)}).attr("height",S._height)}O.exports=function(x){for(var T=x._fullLayout,A=T._rangeSliderData,S=0;S<A.length;S++){var w=A[S][n.name];w._clipId=w._id+"-"+T._uid}var C=T._infolayer.selectAll("g."+n.containerClassName).data(A,function(k){return k._name});C.exit().each(function(k){var L=k[n.name];T._topdefs.select("#"+L._clipId).remove()}).remove(),A.length!==0&&(C.enter().append("g").classed(n.containerClassName,!0).attr("pointer-events","all"),C.each(function(k){var L=t.select(this),M=k[n.name],P=T[o.id2name(k.anchor)],D=M[o.id2name(k.anchor)];if(M.range){var N,U=p.simpleMap(M.range,k.r2l),q=p.simpleMap(k.range,k.r2l);N=q[0]<q[1]?[Math.min(U[0],q[0]),Math.max(U[1],q[1])]:[Math.max(U[0],q[0]),Math.min(U[1],q[1])],M.range=M._input.range=p.simpleMap(N,k.l2r)}k.cleanRange("rangeslider.range");var X=T._size,K=k.domain;M._width=X.w*(K[1]-K[0]);var Z=Math.round(X.l+X.w*K[0]),H=Math.round(X.t+X.h*(1-k._counterDomainMin)+(k.side==="bottom"?k._depth:0)+M._offsetShift+n.extraPad);L.attr("transform",e(Z,H)),M._rl=p.simpleMap(M.range,k.r2l);var Y=M._rl[0],$=M._rl[1],z=$-Y;if(M.p2d=function(he){return he/M._width*z+Y},M.d2p=function(he){return(he-Y)/z*M._width},k.rangebreaks){var j=k.locateBreaks(Y,$);if(j.length){var W,ee,J=0;for(W=0;W<j.length;W++)J+=(ee=j[W]).max-ee.min;var Q=M._width/($-Y-J),te=[-Q*Y];for(W=0;W<j.length;W++)ee=j[W],te.push(te[te.length-1]-Q*(ee.max-ee.min));for(M.d2p=function(he){for(var se=te[0],de=0;de<j.length;de++){var ue=j[de];if(he>=ue.max)se=te[de+1];else if(he<ue.min)break}return se+Q*he},W=0;W<j.length;W++)(ee=j[W]).pmin=M.d2p(ee.min),ee.pmax=M.d2p(ee.max);M.p2d=function(he){for(var se=te[0],de=0;de<j.length;de++){var ue=j[de];if(he>=ue.pmax)se=te[de+1];else if(he<ue.pmin)break}return(he-se)/Q}}}if(D.rangemode!=="match"){var ie=P.r2l(D.range[0]),ae=P.r2l(D.range[1])-ie;M.d2pOppAxis=function(he){return(he-ie)/ae*M._height}}L.call(a,x,k,M).call(g,x,k,M).call(h,x,k,M).call(y,x,k,M,D).call(v,x,k,M).call(_,x,k,M),function(he,se,de,ue){if(se._context.staticPlot)return;var ve=he.select("rect."+n.slideBoxClassName).node(),ke=he.select("rect."+n.grabAreaMinClassName).node(),Ee=he.select("rect."+n.grabAreaMaxClassName).node();function be(){var xe=t.event,ce=xe.target,ge=xe.clientX||xe.touches[0].clientX,we=ge-he.node().getBoundingClientRect().left,Me=ue.d2p(de._rl[0]),Se=ue.d2p(de._rl[1]),ze=i.coverSlip();function Fe(rt){var Oe,je,We,qe=+(rt.clientX||rt.touches[0].clientX)-ge;switch(ce){case ve:We="ew-resize",Oe=Me+qe,je=Se+qe;break;case ke:We="col-resize",Oe=Me+qe,je=Se;break;case Ee:We="col-resize",Oe=Me,je=Se+qe;break;default:We="ew-resize",Oe=we,je=we+qe}if(je<Oe){var Qe=je;je=Oe,Oe=Qe}ue._pixelMin=Oe,ue._pixelMax=je,c(t.select(ze),We),function(st,ct,Pt,kt){function at(er){return Pt.l2r(p.constrain(er,kt._rl[0],kt._rl[1]))}var tt=at(kt.p2d(kt._pixelMin)),_t=at(kt.p2d(kt._pixelMax));window.requestAnimationFrame(function(){d.call("_guiRelayout",ct,Pt._name+".range",[tt,_t])})}(0,se,de,ue)}function Ye(){ze.removeEventListener("mousemove",Fe),ze.removeEventListener("mouseup",Ye),this.removeEventListener("touchmove",Fe),this.removeEventListener("touchend",Ye),p.removeElement(ze)}this.addEventListener("touchmove",Fe),this.addEventListener("touchend",Ye),ze.addEventListener("mousemove",Fe),ze.addEventListener("mouseup",Ye)}he.on("mousedown",be),he.on("touchstart",be)}(L,x,k,M),function(he,se,de,ue,ve,ke){var Ee=n.handleWidth/2;function be(Ye){return p.constrain(Ye,0,ue._width)}function xe(Ye){return p.constrain(Ye,0,ue._height)}function ce(Ye){return p.constrain(Ye,-Ee,ue._width+Ee)}var ge=be(ue.d2p(de._rl[0])),we=be(ue.d2p(de._rl[1]));if(he.select("rect."+n.slideBoxClassName).attr("x",ge).attr("width",we-ge),he.select("rect."+n.maskMinClassName).attr("width",ge),he.select("rect."+n.maskMaxClassName).attr("x",we).attr("width",ue._width-we),ke.rangemode!=="match"){var Me=ue._height-xe(ue.d2pOppAxis(ve._rl[1])),Se=ue._height-xe(ue.d2pOppAxis(ve._rl[0]));he.select("rect."+n.maskMinOppAxisClassName).attr("x",ge).attr("height",Me).attr("width",we-ge),he.select("rect."+n.maskMaxOppAxisClassName).attr("x",ge).attr("y",Se).attr("height",ue._height-Se).attr("width",we-ge),he.select("rect."+n.slideBoxClassName).attr("y",Me).attr("height",Se-Me)}var ze=Math.round(ce(ge-Ee))-.5,Fe=Math.round(ce(we-Ee))+.5;he.select("g."+n.grabberMinClassName).attr("transform",e(ze,.5)),he.select("g."+n.grabberMaxClassName).attr("transform",e(Fe,.5))}(L,0,k,M,P,D),k.side==="bottom"&&s.draw(x,k._id+"title",{propContainer:k,propName:k._name+".title",placeholder:T._dfltTitle.x,attributes:{x:k._offset+k._length/2,y:H+M._height+M._offsetShift+10+1.5*k.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":787,"../../lib/setcursor":808,"../../plots/cartesian":852,"../../plots/cartesian/axis_ids":842,"../../plots/plots":901,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"../titles":748,"./constants":724,"@plotly/d3":58}],727:[function(r,O,B){var t=r("../../plots/cartesian/axis_ids"),d=r("../../lib/svg_text_utils"),m=r("./constants"),p=r("../../constants/alignment").LINE_SPACING,e=m.name;function f(u){var s=u&&u[e];return s&&s.visible}B.isVisible=f,B.makeData=function(u){var s=t.list({_fullLayout:u},"x",!0),l=u.margin,o=[];if(!u._has("gl2d"))for(var i=0;i<s.length;i++){var c=s[i];if(f(c)){o.push(c);var n=c[e];n._id=e+c._id,n._height=(u.height-l.b-l.t)*n.thickness,n._offsetShift=Math.floor(n.borderwidth/2)}}u._rangeSliderData=o},B.autoMarginOpts=function(u,s){var l=u._fullLayout,o=s[e],i=s._id.charAt(0),c=0,n=0;return s.side==="bottom"&&(c=s._depth,s.title.text!==l._dfltTitle[i]&&(n=1.5*s.title.font.size+10+o._offsetShift,n+=(s.title.text.match(d.BR_TAG_ALL)||[]).length*s.title.font.size*p)),{x:0,y:s._counterDomainMin,l:0,r:0,t:0,b:o._height+c+Math.max(l.margin.b,n),pad:m.extraPad+2*o._offsetShift}}},{"../../constants/alignment":755,"../../lib/svg_text_utils":813,"../../plots/cartesian/axis_ids":842,"./constants":724}],728:[function(r,O,B){var t=r("../../lib"),d=r("./attributes"),m=r("./oppaxis_attributes"),p=r("./helpers");O.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:t.extendFlat({},d,{yaxis:m})}}},layoutAttributes:r("./attributes"),handleDefaults:r("./defaults"),calcAutorange:r("./calc_autorange"),draw:r("./draw"),isVisible:p.isVisible,makeData:p.makeData,autoMarginOpts:p.autoMarginOpts}},{"../../lib":787,"./attributes":722,"./calc_autorange":723,"./defaults":725,"./draw":726,"./helpers":727,"./oppaxis_attributes":729}],729:[function(r,O,B){O.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],730:[function(r,O,B){var t=r("../annotations/attributes"),d=r("../../traces/scatter/attributes").line,m=r("../drawing/attributes").dash,p=r("../../lib/extend").extendFlat,e=r("../../plot_api/plot_template").templatedArray;r("../../constants/axis_placeable_objects"),O.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:p({},t.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:p({},t.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:p({},d.color,{editType:"arraydraw"}),width:p({},d.width,{editType:"calc+arraydraw"}),dash:p({},m,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":756,"../../lib/extend":777,"../../plot_api/plot_template":827,"../../traces/scatter/attributes":1202,"../annotations/attributes":633,"../drawing/attributes":671}],731:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("./constants"),p=r("./helpers");function e(l){return u(l.line.width,l.xsizemode,l.x0,l.x1,l.path,!1)}function f(l){return u(l.line.width,l.ysizemode,l.y0,l.y1,l.path,!0)}function u(l,o,i,c,n,a){var g=l/2,h=a;if(o==="pixel"){var y=n?p.extractPathCoords(n,a?m.paramIsY:m.paramIsX):[i,c],v=t.aggNums(Math.max,null,y),_=t.aggNums(Math.min,null,y),x=_<0?Math.abs(_)+g:g,T=v>0?v+g:g;return{ppad:g,ppadplus:h?x:T,ppadminus:h?T:x}}return{ppad:g}}function s(l,o,i,c,n){var a=l.type==="category"||l.type==="multicategory"?l.r2c:l.d2c;if(o!==void 0)return[a(o),a(i)];if(c){var g,h,y,v,_=1/0,x=-1/0,T=c.match(m.segmentRE);for(l.type==="date"&&(a=p.decodeDate(a)),g=0;g<T.length;g++)(h=n[T[g].charAt(0)].drawn)!==void 0&&(!(y=T[g].substr(1).match(m.paramRE))||y.length<h||((v=a(y[h]))<_&&(_=v),v>x&&(x=v)));return x>=_?[_,x]:void 0}}O.exports=function(l){var o=l._fullLayout,i=t.filterVisible(o.shapes);if(i.length&&l._fullData.length)for(var c=0;c<i.length;c++){var n,a,g=i[c];g._extremes={};var h=d.getRefType(g.xref),y=d.getRefType(g.yref);if(g.xref!=="paper"&&h!=="domain"){var v=g.xsizemode==="pixel"?g.xanchor:g.x0,_=g.xsizemode==="pixel"?g.xanchor:g.x1;(a=s(n=d.getFromId(l,g.xref),v,_,g.path,m.paramIsX))&&(g._extremes[n._id]=d.findExtremes(n,a,e(g)))}if(g.yref!=="paper"&&y!=="domain"){var x=g.ysizemode==="pixel"?g.yanchor:g.y0,T=g.ysizemode==="pixel"?g.yanchor:g.y1;(a=s(n=d.getFromId(l,g.yref),x,T,g.path,m.paramIsY))&&(g._extremes[n._id]=d.findExtremes(n,a,f(g)))}}}},{"../../lib":787,"../../plots/cartesian/axes":838,"./constants":732,"./helpers":741}],732:[function(r,O,B){O.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],733:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("../../plots/array_container_defaults"),p=r("./attributes"),e=r("./helpers");function f(u,s,l){function o(D,N){return t.coerce(u,s,p,D,N)}if(o("visible")){var i=o("path"),c=o("type",i?"path":"rect");s.type!=="path"&&delete s.path,o("editable"),o("layer"),o("opacity"),o("fillcolor"),o("fillrule"),o("line.width")&&(o("line.color"),o("line.dash"));for(var n=o("xsizemode"),a=o("ysizemode"),g=["x","y"],h=0;h<2;h++){var y,v,_,x=g[h],T=x+"anchor",A=x==="x"?n:a,S={_fullLayout:l},w=d.coerceRef(u,s,S,x,void 0,"paper");if(d.getRefType(w)==="range"?((y=d.getFromId(S,w))._shapeIndices.push(s._index),_=e.rangeToShapePosition(y),v=e.shapePositionToRange(y)):v=_=t.identity,c!=="path"){var C=x+"0",k=x+"1",L=u[C],M=u[k];u[C]=v(u[C],!0),u[k]=v(u[k],!0),A==="pixel"?(o(C,0),o(k,10)):(d.coercePosition(s,S,o,w,C,.25),d.coercePosition(s,S,o,w,k,.75)),s[C]=_(s[C]),s[k]=_(s[k]),u[C]=L,u[k]=M}if(A==="pixel"){var P=u[T];u[T]=v(u[T],!0),d.coercePosition(s,S,o,w,T,.25),s[T]=_(s[T]),u[T]=P}}c==="path"?o("path"):t.noneOrAll(u,s,["x0","x1","y0","y1"])}}O.exports=function(u,s){m(u,s,{name:"shapes",handleItemDefaults:f})}},{"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"./attributes":730,"./helpers":741}],734:[function(r,O,B){var t=r("../../registry"),d=r("../../lib"),m=r("../../plots/cartesian/axes"),p=r("./draw_newshape/helpers").readPaths,e=r("./draw_newshape/display_outlines"),f=r("../../plots/cartesian/handle_outline").clearOutlineControllers,u=r("../color"),s=r("../drawing"),l=r("../../plot_api/plot_template").arrayEditor,o=r("../dragelement"),i=r("../../lib/setcursor"),c=r("./constants"),n=r("./helpers");function a(A){var S=A._fullLayout;for(var w in S._shapeUpperLayer.selectAll("path").remove(),S._shapeLowerLayer.selectAll("path").remove(),S._plots){var C=S._plots[w].shapelayer;C&&C.selectAll("path").remove()}for(var k=0;k<S.shapes.length;k++)S.shapes[k].visible&&y(A,k)}function g(A){return!!A._fullLayout._drawing}function h(A){return!A._context.edits.shapePosition}function y(A,S){A._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+S+'"]').remove();var w=n.makeOptionsAndPlotinfo(A,S),C=w.options,k=w.plotinfo;C._input&&C.visible!==!1&&(C.layer!=="below"?L(A._fullLayout._shapeUpperLayer):C.xref==="paper"||C.yref==="paper"?L(A._fullLayout._shapeLowerLayer):k._hadPlotinfo?L((k.mainplotinfo||k).shapelayer):L(A._fullLayout._shapeLowerLayer));function L(M){var P=_(A,C),D={"data-index":S,"fill-rule":C.fillrule,d:P},N=C.opacity,U=C.fillcolor,q=C.line.width?C.line.color:"rgba(0,0,0,0)",X=C.line.width,K=C.line.dash;X||C.editable!==!0||(X=5,K="solid");var Z=P[P.length-1]!=="Z",H=h(A)&&C.editable&&A._fullLayout._activeShapeIndex===S;H&&(U=Z?"rgba(0,0,0,0)":A._fullLayout.activeshape.fillcolor,N=A._fullLayout.activeshape.opacity);var Y,$=M.append("path").attr(D).style("opacity",N).call(u.stroke,q).call(u.fill,U).call(s.dashLine,K,X);if(v($,A,C),(H||A._context.edits.shapePosition)&&(Y=l(A.layout,"shapes",C)),H){$.style({cursor:"move"});var z={element:$.node(),plotinfo:k,gd:A,editHelpers:Y,isActiveShape:!0},j=p(P,A);e(j,$,z)}else A._context.edits.shapePosition?function(W,ee,J,Q,te,ie){var ae,he,se,de,ue,ve,ke,Ee,be,xe,ce,ge,we,Me,Se,ze,Fe=J.xsizemode==="pixel",Ye=J.ysizemode==="pixel",rt=J.type==="line",Oe=J.type==="path",je=ie.modifyItem,We=m.getFromId(W,J.xref),qe=m.getRefType(J.xref),Qe=m.getFromId(W,J.yref),st=m.getRefType(J.yref),ct=n.getDataToPixel(W,We,!1,qe),Pt=n.getDataToPixel(W,Qe,!0,st),kt=n.getPixelToData(W,We,!1,qe),at=n.getPixelToData(W,Qe,!0,st),tt=rt?function(){var Ke=Math.max(J.line.width,10),_e=te.append("g").attr("data-index",Q);_e.append("path").attr("d",ee.attr("d")).style({cursor:"move","stroke-width":Ke,"stroke-opacity":"0"});var Ce={"fill-opacity":"0"},Le=Math.max(Ke/2,10);return _e.append("circle").attr({"data-line-point":"start-point",cx:Fe?ct(J.xanchor)+J.x0:ct(J.x0),cy:Ye?Pt(J.yanchor)-J.y0:Pt(J.y0),r:Le}).style(Ce).classed("cursor-grab",!0),_e.append("circle").attr({"data-line-point":"end-point",cx:Fe?ct(J.xanchor)+J.x1:ct(J.x1),cy:Ye?Pt(J.yanchor)-J.y1:Pt(J.y1),r:Le}).style(Ce).classed("cursor-grab",!0),_e}():ee,_t={element:tt.node(),gd:W,prepFn:function(Ke){g(W)||(Fe&&(ue=ct(J.xanchor)),Ye&&(ve=Pt(J.yanchor)),J.type==="path"?Se=J.path:(ae=Fe?J.x0:ct(J.x0),he=Ye?J.y0:Pt(J.y0),se=Fe?J.x1:ct(J.x1),de=Ye?J.y1:Pt(J.y1)),ae<se?(be=ae,we="x0",xe=se,Me="x1"):(be=se,we="x1",xe=ae,Me="x0"),!Ye&&he<de||Ye&&he>de?(ke=he,ce="y0",Ee=de,ge="y1"):(ke=de,ce="y1",Ee=he,ge="y0"),er(Ke),He(te,J),function(_e,Ce,Le){var Pe=Ce.xref,Xe=Ce.yref,ht=m.getFromId(Le,Pe),Mt=m.getFromId(Le,Xe),pt="";Pe==="paper"||ht.autorange||(pt+=Pe),Xe==="paper"||Mt.autorange||(pt+=Xe),s.setClipUrl(_e,pt?"clip"+Le._fullLayout._uid+pt:null,Le)}(ee,J,W),_t.moveFn=ze==="move"?tr:Ue,_t.altKey=Ke.altKey)},doneFn:function(){g(W)||(i(ee),Be(te),v(ee,W,J),t.call("_guiRelayout",W,ie.getUpdateObj()))},clickFn:function(){g(W)||Be(te)}};function er(Ke){if(g(W))ze=null;else if(rt)ze=Ke.target.tagName==="path"?"move":Ke.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point";else{var _e=_t.element.getBoundingClientRect(),Ce=_e.right-_e.left,Le=_e.bottom-_e.top,Pe=Ke.clientX-_e.left,Xe=Ke.clientY-_e.top,ht=!Oe&&Ce>10&&Le>10&&!Ke.shiftKey?o.getCursor(Pe/Ce,1-Xe/Le):"move";i(ee,ht),ze=ht.split("-")[0]}}function tr(Ke,_e){if(J.type==="path"){var Ce=function(Xe){return Xe},Le=Ce,Pe=Ce;Fe?je("xanchor",J.xanchor=kt(ue+Ke)):(Le=function(Xe){return kt(ct(Xe)+Ke)},We&&We.type==="date"&&(Le=n.encodeDate(Le))),Ye?je("yanchor",J.yanchor=at(ve+_e)):(Pe=function(Xe){return at(Pt(Xe)+_e)},Qe&&Qe.type==="date"&&(Pe=n.encodeDate(Pe))),je("path",J.path=x(Se,Le,Pe))}else Fe?je("xanchor",J.xanchor=kt(ue+Ke)):(je("x0",J.x0=kt(ae+Ke)),je("x1",J.x1=kt(se+Ke))),Ye?je("yanchor",J.yanchor=at(ve+_e)):(je("y0",J.y0=at(he+_e)),je("y1",J.y1=at(de+_e)));ee.attr("d",_(W,J)),He(te,J)}function Ue(Ke,_e){if(Oe){var Ce=function(Ie){return Ie},Le=Ce,Pe=Ce;Fe?je("xanchor",J.xanchor=kt(ue+Ke)):(Le=function(Ie){return kt(ct(Ie)+Ke)},We&&We.type==="date"&&(Le=n.encodeDate(Le))),Ye?je("yanchor",J.yanchor=at(ve+_e)):(Pe=function(Ie){return at(Pt(Ie)+_e)},Qe&&Qe.type==="date"&&(Pe=n.encodeDate(Pe))),je("path",J.path=x(Se,Le,Pe))}else if(rt){if(ze==="resize-over-start-point"){var Xe=ae+Ke,ht=Ye?he-_e:he+_e;je("x0",J.x0=Fe?Xe:kt(Xe)),je("y0",J.y0=Ye?ht:at(ht))}else if(ze==="resize-over-end-point"){var Mt=se+Ke,pt=Ye?de-_e:de+_e;je("x1",J.x1=Fe?Mt:kt(Mt)),je("y1",J.y1=Ye?pt:at(pt))}}else{var Lt=function(Ie){return ze.indexOf(Ie)!==-1},vt=Lt("n"),Dt=Lt("s"),xt=Lt("w"),it=Lt("e"),St=vt?ke+_e:ke,Nt=Dt?Ee+_e:Ee,Ut=xt?be+Ke:be,Qt=it?xe+Ke:xe;Ye&&(vt&&(St=ke-_e),Dt&&(Nt=Ee-_e)),(!Ye&&Nt-St>10||Ye&&St-Nt>10)&&(je(ce,J[ce]=Ye?St:at(St)),je(ge,J[ge]=Ye?Nt:at(Nt))),Qt-Ut>10&&(je(we,J[we]=Fe?Ut:kt(Ut)),je(Me,J[Me]=Fe?Qt:kt(Qt)))}ee.attr("d",_(W,J)),He(te,J)}function He(Ke,_e){(Fe||Ye)&&function(){var Ce=_e.type!=="path",Le=Ke.selectAll(".visual-cue").data([0]);Le.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":1}).classed("visual-cue",!0);var Pe=ct(Fe?_e.xanchor:d.midRange(Ce?[_e.x0,_e.x1]:n.extractPathCoords(_e.path,c.paramIsX))),Xe=Pt(Ye?_e.yanchor:d.midRange(Ce?[_e.y0,_e.y1]:n.extractPathCoords(_e.path,c.paramIsY)));if(Pe=n.roundPositionForSharpStrokeRendering(Pe,1),Xe=n.roundPositionForSharpStrokeRendering(Xe,1),Fe&&Ye){var ht="M"+(Pe-1-1)+","+(Xe-1-1)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";Le.attr("d",ht)}else if(Fe){var Mt="M"+(Pe-1-1)+","+(Xe-9-1)+"v18 h2 v-18 Z";Le.attr("d",Mt)}else{var pt="M"+(Pe-9-1)+","+(Xe-1-1)+"h18 v2 h-18 Z";Le.attr("d",pt)}}()}function Be(Ke){Ke.selectAll(".visual-cue").remove()}o.init(_t),tt.node().onmousemove=er}(A,$,C,S,M,Y):C.editable===!0&&$.style("pointer-events",Z||u.opacity(U)*N<=.5?"stroke":"all");$.node().addEventListener("click",function(){return function(W,ee){if(!!h(W)){var J=+ee.node().getAttribute("data-index");if(J>=0){if(J===W._fullLayout._activeShapeIndex)return void T(W);W._fullLayout._activeShapeIndex=J,W._fullLayout._deactivateShape=T,a(W)}}}(A,$)})}}function v(A,S,w){var C=(w.xref+w.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");s.setClipUrl(A,C?"clip"+S._fullLayout._uid+C:null,S)}function _(A,S){var w,C,k,L,M,P,D,N,U=S.type,q=m.getRefType(S.xref),X=m.getRefType(S.yref),K=m.getFromId(A,S.xref),Z=m.getFromId(A,S.yref),H=A._fullLayout._size;if(K?q==="domain"?C=function(te){return K._offset+K._length*te}:(w=n.shapePositionToRange(K),C=function(te){return K._offset+K.r2p(w(te,!0))}):C=function(te){return H.l+H.w*te},Z?X==="domain"?L=function(te){return Z._offset+Z._length*(1-te)}:(k=n.shapePositionToRange(Z),L=function(te){return Z._offset+Z.r2p(k(te,!0))}):L=function(te){return H.t+H.h*(1-te)},U==="path")return K&&K.type==="date"&&(C=n.decodeDate(C)),Z&&Z.type==="date"&&(L=n.decodeDate(L)),function(te,ie,ae){var he=te.path,se=te.xsizemode,de=te.ysizemode,ue=te.xanchor,ve=te.yanchor;return he.replace(c.segmentRE,function(ke){var Ee=0,be=ke.charAt(0),xe=c.paramIsX[be],ce=c.paramIsY[be],ge=c.numParams[be],we=ke.substr(1).replace(c.paramRE,function(Me){return xe[Ee]?Me=se==="pixel"?ie(ue)+Number(Me):ie(Me):ce[Ee]&&(Me=de==="pixel"?ae(ve)-Number(Me):ae(Me)),++Ee>ge&&(Me="X"),Me});return Ee>ge&&(we=we.replace(/[\s,]*X.*/,""),d.log("Ignoring extra params in segment "+ke)),be+we})}(S,C,L);if(S.xsizemode==="pixel"){var Y=C(S.xanchor);M=Y+S.x0,P=Y+S.x1}else M=C(S.x0),P=C(S.x1);if(S.ysizemode==="pixel"){var $=L(S.yanchor);D=$-S.y0,N=$-S.y1}else D=L(S.y0),N=L(S.y1);if(U==="line")return"M"+M+","+D+"L"+P+","+N;if(U==="rect")return"M"+M+","+D+"H"+P+"V"+N+"H"+M+"Z";var z=(M+P)/2,j=(D+N)/2,W=Math.abs(z-M),ee=Math.abs(j-D),J="A"+W+","+ee,Q=z+W+","+j;return"M"+Q+J+" 0 1,1 "+(z+","+(j-ee))+J+" 0 0,1 "+Q+"Z"}function x(A,S,w){return A.replace(c.segmentRE,function(C){var k=0,L=C.charAt(0),M=c.paramIsX[L],P=c.paramIsY[L],D=c.numParams[L];return L+C.substr(1).replace(c.paramRE,function(N){return k>=D||(M[k]?N=S(N):P[k]&&(N=w(N)),k++),N})})}function T(A){h(A)&&A._fullLayout._activeShapeIndex>=0&&(f(A),delete A._fullLayout._activeShapeIndex,a(A))}O.exports={draw:a,drawOne:y,eraseActiveShape:function(A){if(!!h(A)){f(A);var S=A._fullLayout._activeShapeIndex,w=(A.layout||{}).shapes||[];if(S<w.length){for(var C=[],k=0;k<w.length;k++)k!==S&&C.push(w[k]);delete A._fullLayout._activeShapeIndex,t.call("_guiRelayout",A,{shapes:C})}}}}},{"../../lib":787,"../../lib/setcursor":808,"../../plot_api/plot_template":827,"../../plots/cartesian/axes":838,"../../plots/cartesian/handle_outline":849,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"./constants":732,"./draw_newshape/display_outlines":738,"./draw_newshape/helpers":739,"./helpers":741}],735:[function(r,O,B){var t=r("../../drawing/attributes").dash,d=r("../../../lib/extend").extendFlat;O.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:d({},t,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":777,"../../drawing/attributes":671}],736:[function(r,O,B){O.exports={CIRCLE_SIDES:32,i000:0,i090:8,i180:16,i270:24,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],737:[function(r,O,B){var t=r("../../color");O.exports=function(d,m,p){if(p("newshape.drawdirection"),p("newshape.layer"),p("newshape.fillcolor"),p("newshape.fillrule"),p("newshape.opacity"),p("newshape.line.width")){var e=(d||{}).plot_bgcolor||"#FFF";p("newshape.line.color",t.contrast(e)),p("newshape.line.dash")}p("activeshape.fillcolor"),p("activeshape.opacity")}},{"../../color":650}],738:[function(r,O,B){var t=r("../../dragelement"),d=r("../../dragelement/helpers").drawMode,m=r("../../../registry"),p=r("./constants"),e=p.i000,f=p.i090,u=p.i180,s=p.i270,l=r("../../../plots/cartesian/handle_outline").clearOutlineControllers,o=r("./helpers"),i=o.pointsShapeRectangle,c=o.pointsShapeEllipse,n=o.writePaths,a=r("./newshapes");O.exports=function g(h,y,v,_){_||(_=0);var x=v.gd;function T(){g(h,y,v,_++),c(h[0])&&A({redrawing:!0})}function A(Y){v.isActiveShape=!1;var $=a(y,v);Object.keys($).length&&m.call((Y||{}).redrawing?"relayout":"_guiRelayout",x,$)}var S,w,C,k,L,M=v.isActiveShape,P=x._fullLayout._zoomlayer,D=v.dragmode;d(D)?x._fullLayout._drawing=!0:x._fullLayout._activeShapeIndex>=0&&l(x),y.attr("d",n(h)),M&&!_&&(L=function(Y,$){for(var z=0;z<$.length;z++){var j=$[z];Y[z]=[];for(var W=0;W<j.length;W++){Y[z][W]=[];for(var ee=0;ee<j[W].length;ee++)Y[z][W][ee]=j[W][ee]}}return Y}([],h),function(Y){S=[];for(var $=0;$<h.length;$++){var z=h[$],j=!i(z)&&c(z);S[$]=[];for(var W=0;W<z.length;W++)if(z[W][0]!=="Z"&&(!j||W===e||W===f||W===u||W===s)){var ee=z[W][1],J=z[W][2],Q=Y.append("circle").classed("cursor-grab",!0).attr("data-i",$).attr("data-j",W).attr("cx",ee).attr("cy",J).attr("r",4).style({"mix-blend-mode":"luminosity",fill:"black",stroke:"white","stroke-width":1});S[$][W]={element:Q.node(),gd:x,prepFn:N,doneFn:q,clickFn:X},t.init(S[$][W])}}}(P.append("g").attr("class","outline-controllers")),function(){w=[],!!h.length&&(w[0]={element:y[0][0],gd:x,prepFn:Z,doneFn:H},t.init(w[0]))}());function N(Y){C=+Y.srcElement.getAttribute("data-i"),k=+Y.srcElement.getAttribute("data-j"),S[C][k].moveFn=U}function U(Y,$){if(h.length){var z=L[C][k][1],j=L[C][k][2],W=h[C],ee=W.length;if(i(W)){for(var J=0;J<ee;J++)if(J!==k){var Q=W[J];Q[1]===W[k][1]&&(Q[1]=z+Y),Q[2]===W[k][2]&&(Q[2]=j+$)}if(W[k][1]=z+Y,W[k][2]=j+$,!i(W))for(var te=0;te<ee;te++)for(var ie=0;ie<W[te].length;ie++)W[te][ie]=L[C][te][ie]}else W[k][1]=z+Y,W[k][2]=j+$;T()}}function q(){A()}function X(Y,$){if(Y===2){C=+$.srcElement.getAttribute("data-i"),k=+$.srcElement.getAttribute("data-j");var z=h[C];i(z)||c(z)||function(){if(h.length&&h[C]&&h[C].length){for(var j=[],W=0;W<h[C].length;W++)W!==k&&j.push(h[C][W]);j.length>1&&(j.length!==2||j[1][0]!=="Z")&&(k===0&&(j[0][0]="M"),h[C]=j,T(),A())}}()}}function K(Y,$){(function(z,j){if(h.length)for(var W=0;W<h.length;W++)for(var ee=0;ee<h[W].length;ee++)for(var J=0;J+2<h[W][ee].length;J+=2)h[W][ee][J+1]=L[W][ee][J+1]+z,h[W][ee][J+2]=L[W][ee][J+2]+j})(Y,$),T()}function Z(Y){(C=+Y.srcElement.getAttribute("data-i"))||(C=0),w[C].moveFn=K}function H(){A()}}},{"../../../plots/cartesian/handle_outline":849,"../../../registry":915,"../../dragelement":669,"../../dragelement/helpers":668,"./constants":736,"./helpers":739,"./newshapes":740}],739:[function(r,O,B){var t=r("parse-svg-path"),d=r("./constants"),m=d.CIRCLE_SIDES,p=d.SQRT2,e=r("../../../plots/cartesian/helpers"),f=e.p2r,u=e.r2p,s=[0,3,4,5,6,1,2],l=[0,3,4,1,2];function o(c,n){return Math.abs(c-n)<=1e-6}function i(c,n){var a=n[1]-c[1],g=n[2]-c[2];return Math.sqrt(a*a+g*g)}B.writePaths=function(c){var n=c.length;if(!n)return"M0,0Z";for(var a="",g=0;g<n;g++)for(var h=c[g].length,y=0;y<h;y++){var v=c[g][y][0];if(v==="Z")a+="Z";else for(var _=c[g][y].length,x=0;x<_;x++){var T=x;v==="Q"||v==="S"?T=l[x]:v==="C"&&(T=s[x]),a+=c[g][y][T],x>0&&x<_-1&&(a+=",")}}return a},B.readPaths=function(c,n,a,g){var h,y,v,_=t(c),x=[],T=-1,A=0,S=0,w=function(){y=A,v=S};w();for(var C=0;C<_.length;C++){var k,L,M,P,D=[],N=_[C][0],U=N;switch(N){case"M":T++,x[T]=[],A=+_[C][1],S=+_[C][2],D.push([U,A,S]),w();break;case"Q":case"S":k=+_[C][1],M=+_[C][2],A=+_[C][3],S=+_[C][4],D.push([U,A,S,k,M]);break;case"C":k=+_[C][1],M=+_[C][2],L=+_[C][3],P=+_[C][4],A=+_[C][5],S=+_[C][6],D.push([U,A,S,k,M,L,P]);break;case"T":case"L":A=+_[C][1],S=+_[C][2],D.push([U,A,S]);break;case"H":U="L",A=+_[C][1],D.push([U,A,S]);break;case"V":U="L",S=+_[C][1],D.push([U,A,S]);break;case"A":U="L";var q=+_[C][1],X=+_[C][2];+_[C][4]||(q=-q,X=-X);var K=A-q,Z=S;for(h=1;h<=m/2;h++){var H=2*Math.PI*h/m;D.push([U,K+q*Math.cos(H),Z+X*Math.sin(H)])}break;case"Z":A===y&&S===v||(A=y,S=v,D.push([U,A,S]))}for(var Y=(a||{}).domain,$=n._fullLayout._size,z=a&&a.xsizemode==="pixel",j=a&&a.ysizemode==="pixel",W=g===!1,ee=0;ee<D.length;ee++){for(h=0;h+2<7;h+=2){var J=D[ee][h+1],Q=D[ee][h+2];J!==void 0&&Q!==void 0&&(A=J,S=Q,a&&(a.xaxis&&a.xaxis.p2r?(W&&(J-=a.xaxis._offset),J=z?u(a.xaxis,a.xanchor)+J:f(a.xaxis,J)):(W&&(J-=$.l),Y?J=Y.x[0]+J/$.w:J/=$.w),a.yaxis&&a.yaxis.p2r?(W&&(Q-=a.yaxis._offset),Q=j?u(a.yaxis,a.yanchor)-Q:f(a.yaxis,Q)):(W&&(Q-=$.t),Q=Y?Y.y[1]-Q/$.h:1-Q/$.h)),D[ee][h+1]=J,D[ee][h+2]=Q)}x[T].push(D[ee].slice())}}return x},B.pointsShapeRectangle=function(c){if(c.length!==5)return!1;for(var n=1;n<3;n++)if(!o(c[0][n]-c[1][n],c[3][n]-c[2][n])||!o(c[0][n]-c[3][n],c[1][n]-c[2][n]))return!1;return!(!o(c[0][1],c[1][1])&&!o(c[0][1],c[3][1]))&&!!(i(c[0],c[1])*i(c[0],c[3]))},B.pointsShapeEllipse=function(c){var n=c.length;if(n!==m+1)return!1;n=m;for(var a=0;a<n;a++){var g=(2*n-a)%n,h=(n/2+g)%n,y=(n/2+a)%n;if(!o(i(c[a],c[y]),i(c[g],c[h])))return!1}return!0},B.handleEllipse=function(c,n,a){if(!c)return[n,a];var g=B.ellipseOver({x0:n[0],y0:n[1],x1:a[0],y1:a[1]}),h=(g.x1+g.x0)/2,y=(g.y1+g.y0)/2,v=(g.x1-g.x0)/2,_=(g.y1-g.y0)/2;v||(v=_/=p),_||(_=v/=p);for(var x=[],T=0;T<m;T++){var A=2*T*Math.PI/m;x.push([h+v*Math.cos(A),y+_*Math.sin(A)])}return x},B.ellipseOver=function(c){var n=c.x0,a=c.y0,g=c.x1,h=c.y1,y=g-n,v=h-a,_=((n-=y)+g)/2,x=((a-=v)+h)/2;return{x0:_-(y*=p),y0:x-(v*=p),x1:_+y,y1:x+v}}},{"../../../plots/cartesian/helpers":850,"./constants":736,"parse-svg-path":482}],740:[function(r,O,B){var t=r("../../dragelement/helpers"),d=t.drawMode,m=t.openMode,p=r("./constants"),e=p.i000,f=p.i090,u=p.i180,s=p.i270,l=p.cos45,o=p.sin45,i=r("../../../plots/cartesian/helpers"),c=i.p2r,n=i.r2p,a=r("../../../plots/cartesian/handle_outline").clearSelect,g=r("./helpers"),h=g.readPaths,y=g.writePaths,v=g.ellipseOver;O.exports=function(_,x){if(_.length){var T=_[0][0];if(T){var A=T.getAttribute("d"),S=x.gd,w=S._fullLayout.newshape,C=x.plotinfo,k=C.xaxis,L=C.yaxis,M=!!C.domain||!C.xaxis,P=!!C.domain||!C.yaxis,D=x.isActiveShape,N=x.dragmode,U=(S.layout||{}).shapes||[];if(!d(N)&&D!==void 0){var q=S._fullLayout._activeShapeIndex;if(q<U.length)switch(S._fullLayout.shapes[q].type){case"rect":N="drawrect";break;case"circle":N="drawcircle";break;case"line":N="drawline";break;case"path":var X=U[q].path||"";N=X[X.length-1]==="Z"?"drawclosedpath":"drawopenpath"}}var K,Z=m(N),H=h(A,S,C,D),Y={editable:!0,xref:M?"paper":k._id,yref:P?"paper":L._id,layer:w.layer,opacity:w.opacity,line:{color:w.line.color,width:w.line.width,dash:w.line.dash}};if(Z||(Y.fillcolor=w.fillcolor,Y.fillrule=w.fillrule),H.length===1&&(K=H[0]),K&&N==="drawrect")Y.type="rect",Y.x0=K[0][1],Y.y0=K[0][2],Y.x1=K[2][1],Y.y1=K[2][2];else if(K&&N==="drawline")Y.type="line",Y.x0=K[0][1],Y.y0=K[0][2],Y.x1=K[1][1],Y.y1=K[1][2];else if(K&&N==="drawcircle"){Y.type="circle";var $=K[e][1],z=K[f][1],j=K[u][1],W=K[s][1],ee=K[e][2],J=K[f][2],Q=K[u][2],te=K[s][2],ie=C.xaxis&&(C.xaxis.type==="date"||C.xaxis.type==="log"),ae=C.yaxis&&(C.yaxis.type==="date"||C.yaxis.type==="log");ie&&($=n(C.xaxis,$),z=n(C.xaxis,z),j=n(C.xaxis,j),W=n(C.xaxis,W)),ae&&(ee=n(C.yaxis,ee),J=n(C.yaxis,J),Q=n(C.yaxis,Q),te=n(C.yaxis,te));var he=(z+W)/2,se=(ee+Q)/2,de=v({x0:he,y0:se,x1:he+(W-z+j-$)/2*l,y1:se+(te-J+Q-ee)/2*o});ie&&(de.x0=c(C.xaxis,de.x0),de.x1=c(C.xaxis,de.x1)),ae&&(de.y0=c(C.yaxis,de.y0),de.y1=c(C.yaxis,de.y1)),Y.x0=de.x0,Y.y0=de.y0,Y.x1=de.x1,Y.y1=de.y1}else Y.type="path",k&&L&&function(ce,ge,we){var Me=ge.type==="date",Se=we.type==="date";if(!Me&&!Se)return ce;for(var ze=0;ze<ce.length;ze++)for(var Fe=0;Fe<ce[ze].length;Fe++)for(var Ye=0;Ye+2<ce[ze][Fe].length;Ye+=2)Me&&(ce[ze][Fe][Ye+1]=ce[ze][Fe][Ye+1].replace(" ","_")),Se&&(ce[ze][Fe][Ye+2]=ce[ze][Fe][Ye+2].replace(" ","_"))}(H,k,L),Y.path=y(H),K=null;a(S);for(var ue=x.editHelpers,ve=(ue||{}).modifyItem,ke=[],Ee=0;Ee<U.length;Ee++){var be=S._fullLayout.shapes[Ee];if(ke[Ee]=be._input,D!==void 0&&Ee===S._fullLayout._activeShapeIndex){var xe=Y;switch(be.type){case"line":case"rect":case"circle":ve("x0",xe.x0),ve("x1",xe.x1),ve("y0",xe.y0),ve("y1",xe.y1);break;case"path":ve("path",xe.path)}}}return D===void 0?(ke.push(Y),ke):ue?ue.getUpdateObj():{}}}}},{"../../../plots/cartesian/handle_outline":849,"../../../plots/cartesian/helpers":850,"../../dragelement/helpers":668,"./constants":736,"./helpers":739}],741:[function(r,O,B){var t=r("./constants"),d=r("../../lib");B.rangeToShapePosition=function(m){return m.type==="log"?m.r2d:function(p){return p}},B.shapePositionToRange=function(m){return m.type==="log"?m.d2r:function(p){return p}},B.decodeDate=function(m){return function(p){return p.replace&&(p=p.replace("_"," ")),m(p)}},B.encodeDate=function(m){return function(p){return m(p).replace(" ","_")}},B.extractPathCoords=function(m,p){var e=[];return m.match(t.segmentRE).forEach(function(f){var u=p[f.charAt(0)].drawn;if(u!==void 0){var s=f.substr(1).match(t.paramRE);!s||s.length<u||e.push(d.cleanNumber(s[u]))}}),e},B.getDataToPixel=function(m,p,e,f){var u,s=m._fullLayout._size;if(p)if(f==="domain")u=function(o){return p._length*(e?1-o:o)+p._offset};else{var l=B.shapePositionToRange(p);u=function(o){return p._offset+p.r2p(l(o,!0))},p.type==="date"&&(u=B.decodeDate(u))}else u=e?function(o){return s.t+s.h*(1-o)}:function(o){return s.l+s.w*o};return u},B.getPixelToData=function(m,p,e,f){var u,s=m._fullLayout._size;if(p)if(f==="domain")u=function(o){var i=(o-p._offset)/p._length;return e?1-i:i};else{var l=B.rangeToShapePosition(p);u=function(o){return l(p.p2r(o-p._offset))}}else u=e?function(o){return 1-(o-s.t)/s.h}:function(o){return(o-s.l)/s.w};return u},B.roundPositionForSharpStrokeRendering=function(m,p){var e=Math.round(p%2)===1,f=Math.round(m);return e?f+.5:f},B.makeOptionsAndPlotinfo=function(m,p){var e=m._fullLayout.shapes[p]||{},f=m._fullLayout._plots[e.xref+e.yref];return f?f._hadPlotinfo=!0:(f={},e.xref&&e.xref!=="paper"&&(f.xaxis=m._fullLayout[e.xref+"axis"]),e.yref&&e.yref!=="paper"&&(f.yaxis=m._fullLayout[e.yref+"axis"])),f.xsizemode=e.xsizemode,f.ysizemode=e.ysizemode,f.xanchor=e.xanchor,f.yanchor=e.yanchor,{options:e,plotinfo:f}}},{"../../lib":787,"./constants":732}],742:[function(r,O,B){var t=r("./draw");O.exports={moduleType:"component",name:"shapes",layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),supplyDrawNewShapeDefaults:r("./draw_newshape/defaults"),includeBasePlot:r("../../plots/cartesian/include_components")("shapes"),calcAutorange:r("./calc_autorange"),draw:t.draw,drawOne:t.drawOne}},{"../../plots/cartesian/include_components":851,"./attributes":730,"./calc_autorange":731,"./defaults":733,"./draw":734,"./draw_newshape/defaults":737}],743:[function(r,O,B){var t=r("../../plots/font_attributes"),d=r("../../plots/pad_attributes"),m=r("../../lib/extend").extendDeepAll,p=r("../../plot_api/edit_types").overrideAll,e=r("../../plots/animation_attributes"),f=r("../../plot_api/plot_template").templatedArray,u=r("./constants"),s=f("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});O.exports=p(f("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:s,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:m(d({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:t({})},font:t({}),activebgcolor:{valType:"color",dflt:u.gripBgActiveColor},bgcolor:{valType:"color",dflt:u.railBgColor},bordercolor:{valType:"color",dflt:u.railBorderColor},borderwidth:{valType:"number",min:0,dflt:u.railBorderWidth},ticklen:{valType:"number",min:0,dflt:u.tickLength},tickcolor:{valType:"color",dflt:u.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:u.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../plots/animation_attributes":832,"../../plots/font_attributes":867,"../../plots/pad_attributes":900,"./constants":744}],744:[function(r,O,B){O.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],745:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/array_container_defaults"),m=r("./attributes"),p=r("./constants").name,e=m.steps;function f(s,l,o){function i(h,y){return t.coerce(s,l,m,h,y)}for(var c=d(s,l,{name:"steps",handleItemDefaults:u}),n=0,a=0;a<c.length;a++)c[a].visible&&n++;if(n<2?l.visible=!1:i("visible")){l._stepCount=n;var g=l._visibleSteps=t.filterVisible(c);(c[i("active")]||{}).visible||(l.active=g[0]._index),i("x"),i("y"),t.noneOrAll(s,l,["x","y"]),i("xanchor"),i("yanchor"),i("len"),i("lenmode"),i("pad.t"),i("pad.r"),i("pad.b"),i("pad.l"),t.coerceFont(i,"font",o.font),i("currentvalue.visible")&&(i("currentvalue.xanchor"),i("currentvalue.prefix"),i("currentvalue.suffix"),i("currentvalue.offset"),t.coerceFont(i,"currentvalue.font",l.font)),i("transition.duration"),i("transition.easing"),i("bgcolor"),i("activebgcolor"),i("bordercolor"),i("borderwidth"),i("ticklen"),i("tickwidth"),i("tickcolor"),i("minorticklen")}}function u(s,l){function o(c,n){return t.coerce(s,l,e,c,n)}if(s.method==="skip"||Array.isArray(s.args)?o("visible"):l.visible=!1){o("method"),o("args");var i=o("label","step-"+l._index);o("value",i),o("execute")}}O.exports=function(s,l){d(s,l,{name:p,handleItemDefaults:f})}},{"../../lib":787,"../../plots/array_container_defaults":833,"./attributes":743,"./constants":744}],746:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../plots/plots"),m=r("../color"),p=r("../drawing"),e=r("../../lib"),f=e.strTranslate,u=r("../../lib/svg_text_utils"),s=r("../../plot_api/plot_template").arrayEditor,l=r("./constants"),o=r("../../constants/alignment"),i=o.LINE_SPACING,c=o.FROM_TL,n=o.FROM_BR;function a(D){return l.autoMarginIdRoot+D._index}function g(D){return D._index}function h(D,N){var U=p.tester.selectAll("g."+l.labelGroupClass).data(N._visibleSteps);U.enter().append("g").classed(l.labelGroupClass,!0);var q=0,X=0;U.each(function(ee){var J=_(t.select(this),{step:ee},N).node();if(J){var Q=p.bBox(J);X=Math.max(X,Q.height),q=Math.max(q,Q.width)}}),U.remove();var K=N._dims={};K.inputAreaWidth=Math.max(l.railWidth,l.gripHeight);var Z=D._fullLayout._size;K.lx=Z.l+Z.w*N.x,K.ly=Z.t+Z.h*(1-N.y),N.lenmode==="fraction"?K.outerLength=Math.round(Z.w*N.len):K.outerLength=N.len,K.inputAreaStart=0,K.inputAreaLength=Math.round(K.outerLength-N.pad.l-N.pad.r);var H=(K.inputAreaLength-2*l.stepInset)/(N._stepCount-1),Y=q+l.labelPadding;if(K.labelStride=Math.max(1,Math.ceil(Y/H)),K.labelHeight=X,K.currentValueMaxWidth=0,K.currentValueHeight=0,K.currentValueTotalHeight=0,K.currentValueMaxLines=1,N.currentvalue.visible){var $=p.tester.append("g");U.each(function(ee){var J=y($,N,ee.label),Q=J.node()&&p.bBox(J.node())||{width:0,height:0},te=u.lineCount(J);K.currentValueMaxWidth=Math.max(K.currentValueMaxWidth,Math.ceil(Q.width)),K.currentValueHeight=Math.max(K.currentValueHeight,Math.ceil(Q.height)),K.currentValueMaxLines=Math.max(K.currentValueMaxLines,te)}),K.currentValueTotalHeight=K.currentValueHeight+N.currentvalue.offset,$.remove()}K.height=K.currentValueTotalHeight+l.tickOffset+N.ticklen+l.labelOffset+K.labelHeight+N.pad.t+N.pad.b;var z="left";e.isRightAnchor(N)&&(K.lx-=K.outerLength,z="right"),e.isCenterAnchor(N)&&(K.lx-=K.outerLength/2,z="center");var j="top";e.isBottomAnchor(N)&&(K.ly-=K.height,j="bottom"),e.isMiddleAnchor(N)&&(K.ly-=K.height/2,j="middle"),K.outerLength=Math.ceil(K.outerLength),K.height=Math.ceil(K.height),K.lx=Math.round(K.lx),K.ly=Math.round(K.ly);var W={y:N.y,b:K.height*n[j],t:K.height*c[j]};N.lenmode==="fraction"?(W.l=0,W.xl=N.x-N.len*c[z],W.r=0,W.xr=N.x+N.len*n[z]):(W.x=N.x,W.l=K.outerLength*c[z],W.r=K.outerLength*n[z]),d.autoMargin(D,a(N),W)}function y(D,N,U){if(N.currentvalue.visible){var q,X,K=N._dims;switch(N.currentvalue.xanchor){case"right":q=K.inputAreaLength-l.currentValueInset-K.currentValueMaxWidth,X="left";break;case"center":q=.5*K.inputAreaLength,X="middle";break;default:q=l.currentValueInset,X="left"}var Z=e.ensureSingle(D,"text",l.labelClass,function(W){W.attr({"text-anchor":X,"data-notex":1})}),H=N.currentvalue.prefix?N.currentvalue.prefix:"";if(typeof U=="string")H+=U;else{var Y=N.steps[N.active].label,$=N._gd._fullLayout._meta;$&&(Y=e.templateString(Y,$)),H+=Y}N.currentvalue.suffix&&(H+=N.currentvalue.suffix),Z.call(p.font,N.currentvalue.font).text(H).call(u.convertToTspans,N._gd);var z=u.lineCount(Z),j=(K.currentValueMaxLines+1-z)*N.currentvalue.font.size*i;return u.positionText(Z,q,j),Z}}function v(D,N,U){e.ensureSingle(D,"rect",l.gripRectClass,function(q){q.call(S,N,D,U).style("pointer-events","all")}).attr({width:l.gripWidth,height:l.gripHeight,rx:l.gripRadius,ry:l.gripRadius}).call(m.stroke,U.bordercolor).call(m.fill,U.bgcolor).style("stroke-width",U.borderwidth+"px")}function _(D,N,U){var q=e.ensureSingle(D,"text",l.labelClass,function(Z){Z.attr({"text-anchor":"middle","data-notex":1})}),X=N.step.label,K=U._gd._fullLayout._meta;return K&&(X=e.templateString(X,K)),q.call(p.font,U.font).text(X).call(u.convertToTspans,U._gd),q}function x(D,N){var U=e.ensureSingle(D,"g",l.labelsClass),q=N._dims,X=U.selectAll("g."+l.labelGroupClass).data(q.labelSteps);X.enter().append("g").classed(l.labelGroupClass,!0),X.exit().remove(),X.each(function(K){var Z=t.select(this);Z.call(_,K,N),p.setTranslate(Z,k(N,K.fraction),l.tickOffset+N.ticklen+N.font.size*i+l.labelOffset+q.currentValueTotalHeight)})}function T(D,N,U,q,X){var K=Math.round(q*(U._stepCount-1)),Z=U._visibleSteps[K]._index;Z!==U.active&&A(D,N,U,Z,!0,X)}function A(D,N,U,q,X,K){var Z=U.active;U.active=q,s(D.layout,l.name,U).applyUpdate("active",q);var H=U.steps[U.active];N.call(C,U,K),N.call(y,U),D.emit("plotly_sliderchange",{slider:U,step:U.steps[U.active],interaction:X,previousActive:Z}),H&&H.method&&X&&(N._nextMethod?(N._nextMethod.step=H,N._nextMethod.doCallback=X,N._nextMethod.doTransition=K):(N._nextMethod={step:H,doCallback:X,doTransition:K},N._nextMethodRaf=window.requestAnimationFrame(function(){var Y=N._nextMethod.step;Y.method&&(Y.execute&&d.executeAPICommand(D,Y.method,Y.args),N._nextMethod=null,N._nextMethodRaf=null)})))}function S(D,N,U){var q=U.node(),X=t.select(N);function K(){return U.data()[0]}function Z(){var H=K();N.emit("plotly_sliderstart",{slider:H});var Y=U.select("."+l.gripRectClass);t.event.stopPropagation(),t.event.preventDefault(),Y.call(m.fill,H.activebgcolor);var $=L(H,t.mouse(q)[0]);function z(){var W=K(),ee=L(W,t.mouse(q)[0]);T(N,U,W,ee,!1)}function j(){var W=K();W._dragging=!1,Y.call(m.fill,W.bgcolor),X.on("mouseup",null),X.on("mousemove",null),X.on("touchend",null),X.on("touchmove",null),N.emit("plotly_sliderend",{slider:W,step:W.steps[W.active]})}T(N,U,H,$,!0),H._dragging=!0,X.on("mousemove",z),X.on("touchmove",z),X.on("mouseup",j),X.on("touchend",j)}D.on("mousedown",Z),D.on("touchstart",Z)}function w(D,N){var U=D.selectAll("rect."+l.tickRectClass).data(N._visibleSteps),q=N._dims;U.enter().append("rect").classed(l.tickRectClass,!0),U.exit().remove(),U.attr({width:N.tickwidth+"px","shape-rendering":"crispEdges"}),U.each(function(X,K){var Z=K%q.labelStride==0,H=t.select(this);H.attr({height:Z?N.ticklen:N.minorticklen}).call(m.fill,N.tickcolor),p.setTranslate(H,k(N,K/(N._stepCount-1))-.5*N.tickwidth,(Z?l.tickOffset:l.minorTickOffset)+q.currentValueTotalHeight)})}function C(D,N,U){for(var q=D.select("rect."+l.gripRectClass),X=0,K=0;K<N._stepCount;K++)if(N._visibleSteps[K]._index===N.active){X=K;break}var Z=k(N,X/(N._stepCount-1));if(!N._invokingCommand){var H=q;U&&N.transition.duration>0&&(H=H.transition().duration(N.transition.duration).ease(N.transition.easing)),H.attr("transform",f(Z-.5*l.gripWidth,N._dims.currentValueTotalHeight))}}function k(D,N){var U=D._dims;return U.inputAreaStart+l.stepInset+(U.inputAreaLength-2*l.stepInset)*Math.min(1,Math.max(0,N))}function L(D,N){var U=D._dims;return Math.min(1,Math.max(0,(N-l.stepInset-U.inputAreaStart)/(U.inputAreaLength-2*l.stepInset-2*U.inputAreaStart)))}function M(D,N,U){var q=U._dims,X=e.ensureSingle(D,"rect",l.railTouchRectClass,function(K){K.call(S,N,D,U).style("pointer-events","all")});X.attr({width:q.inputAreaLength,height:Math.max(q.inputAreaWidth,l.tickOffset+U.ticklen+q.labelHeight)}).call(m.fill,U.bgcolor).attr("opacity",0),p.setTranslate(X,0,q.currentValueTotalHeight)}function P(D,N){var U=N._dims,q=U.inputAreaLength-2*l.railInset,X=e.ensureSingle(D,"rect",l.railRectClass);X.attr({width:q,height:l.railWidth,rx:l.railRadius,ry:l.railRadius,"shape-rendering":"crispEdges"}).call(m.stroke,N.bordercolor).call(m.fill,N.bgcolor).style("stroke-width",N.borderwidth+"px"),p.setTranslate(X,l.railInset,.5*(U.inputAreaWidth-l.railWidth)+U.currentValueTotalHeight)}O.exports=function(D){var N=D._fullLayout,U=function(Y,$){for(var z=Y[l.name],j=[],W=0;W<z.length;W++){var ee=z[W];ee.visible&&(ee._gd=$,j.push(ee))}return j}(N,D),q=N._infolayer.selectAll("g."+l.containerClassName).data(U.length>0?[0]:[]);function X(Y){Y._commandObserver&&(Y._commandObserver.remove(),delete Y._commandObserver),d.autoMargin(D,a(Y))}if(q.enter().append("g").classed(l.containerClassName,!0).style("cursor","ew-resize"),q.exit().each(function(){t.select(this).selectAll("g."+l.groupClassName).each(X)}).remove(),U.length!==0){var K=q.selectAll("g."+l.groupClassName).data(U,g);K.enter().append("g").classed(l.groupClassName,!0),K.exit().each(X).remove();for(var Z=0;Z<U.length;Z++){var H=U[Z];h(D,H)}K.each(function(Y){var $=t.select(this);(function(z){var j=z._dims;j.labelSteps=[];for(var W=z._stepCount,ee=0;ee<W;ee+=j.labelStride)j.labelSteps.push({fraction:ee/(W-1),step:z._visibleSteps[ee]})})(Y),d.manageCommandObserver(D,Y,Y._visibleSteps,function(z){var j=$.data()[0];j.active!==z.index&&(j._dragging||A(D,$,j,z.index,!1,!0))}),function(z,j,W){(W.steps[W.active]||{}).visible||(W.active=W._visibleSteps[0]._index),j.call(y,W).call(P,W).call(x,W).call(w,W).call(M,z,W).call(v,z,W);var ee=W._dims;p.setTranslate(j,ee.lx+W.pad.l,ee.ly+W.pad.t),j.call(C,W,!1),j.call(y,W)}(D,t.select(this),Y)})}}},{"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"../../plot_api/plot_template":827,"../../plots/plots":901,"../color":650,"../drawing":672,"./constants":744,"@plotly/d3":58}],747:[function(r,O,B){var t=r("./constants");O.exports={moduleType:"component",name:t.name,layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),draw:r("./draw")}},{"./attributes":743,"./constants":744,"./defaults":745,"./draw":746}],748:[function(r,O,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("../../plots/plots"),p=r("../../registry"),e=r("../../lib"),f=e.strTranslate,u=r("../drawing"),s=r("../color"),l=r("../../lib/svg_text_utils"),o=r("../../constants/interactions"),i=r("../../constants/alignment").OPPOSITE_SIDE,c=/ [XY][0-9]* /;O.exports={draw:function(n,a,g){var h,y=g.propContainer,v=g.propName,_=g.placeholder,x=g.traceIndex,T=g.avoid||{},A=g.attributes,S=g.transform,w=g.containerGroup,C=n._fullLayout,k=1,L=!1,M=y.title,P=(M&&M.text?M.text:"").trim(),D=M&&M.font?M.font:{},N=D.family,U=D.size,q=D.color;v==="title.text"?h="titleText":v.indexOf("axis")!==-1?h="axisTitleText":v.indexOf(!0)&&(h="colorbarTitleText");var X=n._context.edits[h];P===""?k=0:P.replace(c," % ")===_.replace(c," % ")&&(k=.2,L=!0,X||(P="")),g._meta?P=e.templateString(P,g._meta):C._meta&&(P=e.templateString(P,C._meta));var K=P||X;w||(w=e.ensureSingle(C._infolayer,"g","g-"+a));var Z=w.selectAll("text").data(K?[0]:[]);if(Z.enter().append("text"),Z.text(P).attr("class",a),Z.exit().remove(),!K)return w;function H(z){e.syncOrAsync([Y,$],z)}function Y(z){var j;return S?(j="",S.rotate&&(j+="rotate("+[S.rotate,A.x,A.y]+")"),S.offset&&(j+=f(0,S.offset))):j=null,z.attr("transform",j),z.style({"font-family":N,"font-size":t.round(U,2)+"px",fill:s.rgb(q),opacity:k*s.opacity(q),"font-weight":m.fontWeight}).attr(A).call(l.convertToTspans,n),m.previousPromises(n)}function $(z){var j=t.select(z.node().parentNode);if(T&&T.selection&&T.side&&P){j.attr("transform",null);var W=i[T.side],ee=T.side==="left"||T.side==="top"?-1:1,J=d(T.pad)?T.pad:2,Q=u.bBox(j.node()),te={left:0,top:0,right:C.width,bottom:C.height},ie=T.maxShift||ee*(te[T.side]-Q[T.side]),ae=0;if(ie<0)ae=ie;else{var he=T.offsetLeft||0,se=T.offsetTop||0;Q.left-=he,Q.right-=he,Q.top-=se,Q.bottom-=se,T.selection.each(function(){var ue=u.bBox(this);e.bBoxIntersect(Q,ue,J)&&(ae=Math.max(ae,ee*(ue[T.side]-Q[W])+J))}),ae=Math.min(ie,ae)}if(ae>0||ie<0){var de={left:[-ae,0],right:[ae,0],top:[0,-ae],bottom:[0,ae]}[T.side];j.attr("transform",f(de[0],de[1]))}}}return Z.call(H),X&&(P?Z.on(".opacity",null):(k=0,L=!0,Z.text(_).on("mouseover.opacity",function(){t.select(this).transition().duration(o.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){t.select(this).transition().duration(o.HIDE_PLACEHOLDER).style("opacity",0)})),Z.call(l.makeEditable,{gd:n}).on("edit",function(z){x!==void 0?p.call("_guiRestyle",n,v,z,x):p.call("_guiRelayout",n,v,z)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(H)}).on("input",function(z){this.text(z||" ").call(l.positionText,A.x,A.y)})),Z.classed("js-placeholder",L),w}}},{"../../constants/alignment":755,"../../constants/interactions":762,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/plots":901,"../../registry":915,"../color":650,"../drawing":672,"@plotly/d3":58,"fast-isnumeric":246}],749:[function(r,O,B){var t=r("../../plots/font_attributes"),d=r("../color/attributes"),m=r("../../lib/extend").extendFlat,p=r("../../plot_api/edit_types").overrideAll,e=r("../../plots/pad_attributes"),f=r("../../plot_api/plot_template").templatedArray,u=f("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});O.exports=p(f("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:u,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:m(e({editType:"arraydraw"}),{}),font:t({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:d.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../plots/font_attributes":867,"../../plots/pad_attributes":900,"../color/attributes":649}],750:[function(r,O,B){O.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25C4",right:"\u25BA",up:"\u25B2",down:"\u25BC"}}},{}],751:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/array_container_defaults"),m=r("./attributes"),p=r("./constants").name,e=m.buttons;function f(s,l,o){function i(c,n){return t.coerce(s,l,m,c,n)}i("visible",d(s,l,{name:"buttons",handleItemDefaults:u}).length>0)&&(i("active"),i("direction"),i("type"),i("showactive"),i("x"),i("y"),t.noneOrAll(s,l,["x","y"]),i("xanchor"),i("yanchor"),i("pad.t"),i("pad.r"),i("pad.b"),i("pad.l"),t.coerceFont(i,"font",o.font),i("bgcolor",o.paper_bgcolor),i("bordercolor"),i("borderwidth"))}function u(s,l){function o(i,c){return t.coerce(s,l,e,i,c)}o("visible",s.method==="skip"||Array.isArray(s.args))&&(o("method"),o("args"),o("args2"),o("label"),o("execute"))}O.exports=function(s,l){d(s,l,{name:p,handleItemDefaults:f})}},{"../../lib":787,"../../plots/array_container_defaults":833,"./attributes":749,"./constants":750}],752:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../plots/plots"),m=r("../color"),p=r("../drawing"),e=r("../../lib"),f=r("../../lib/svg_text_utils"),u=r("../../plot_api/plot_template").arrayEditor,s=r("../../constants/alignment").LINE_SPACING,l=r("./constants"),o=r("./scrollbox");function i(k){return k._index}function c(k,L){return+k.attr(l.menuIndexAttrName)===L._index}function n(k,L,M,P,D,N,U,q){L.active=U,u(k.layout,l.name,L).applyUpdate("active",U),L.type==="buttons"?g(k,P,null,null,L):L.type==="dropdown"&&(D.attr(l.menuIndexAttrName,"-1"),a(k,P,D,N,L),q||g(k,P,D,N,L))}function a(k,L,M,P,D){var N=e.ensureSingle(L,"g",l.headerClassName,function(H){H.style("pointer-events","all")}),U=D._dims,q=D.active,X=D.buttons[q]||l.blankHeaderOpts,K={y:D.pad.t,yPad:0,x:D.pad.l,xPad:0,index:0},Z={width:U.headerWidth,height:U.headerHeight};N.call(h,D,X,k).call(w,D,K,Z),e.ensureSingle(L,"text",l.headerArrowClassName,function(H){H.attr("text-anchor","end").call(p.font,D.font).text(l.arrowSymbol[D.direction])}).attr({x:U.headerWidth-l.arrowOffsetX+D.pad.l,y:U.headerHeight/2+l.textOffsetY+D.pad.t}),N.on("click",function(){M.call(C,String(c(M,D)?-1:D._index)),g(k,L,M,P,D)}),N.on("mouseover",function(){N.call(x)}),N.on("mouseout",function(){N.call(T,D)}),p.setTranslate(L,U.lx,U.ly)}function g(k,L,M,P,D){M||(M=L).attr("pointer-events","all");var N=function(W){return+W.attr(l.menuIndexAttrName)==-1}(M)&&D.type!=="buttons"?[]:D.buttons,U=D.type==="dropdown"?l.dropdownButtonClassName:l.buttonClassName,q=M.selectAll("g."+U).data(e.filterVisible(N)),X=q.enter().append("g").classed(U,!0),K=q.exit();D.type==="dropdown"?(X.attr("opacity","0").transition().attr("opacity","1"),K.transition().attr("opacity","0").remove()):K.remove();var Z=0,H=0,Y=D._dims,$=["up","down"].indexOf(D.direction)!==-1;D.type==="dropdown"&&($?H=Y.headerHeight+l.gapButtonHeader:Z=Y.headerWidth+l.gapButtonHeader),D.type==="dropdown"&&D.direction==="up"&&(H=-l.gapButtonHeader+l.gapButton-Y.openHeight),D.type==="dropdown"&&D.direction==="left"&&(Z=-l.gapButtonHeader+l.gapButton-Y.openWidth);var z={x:Y.lx+Z+D.pad.l,y:Y.ly+H+D.pad.t,yPad:l.gapButton,xPad:l.gapButton,index:0},j={l:z.x+D.borderwidth,t:z.y+D.borderwidth};q.each(function(W,ee){var J=t.select(this);J.call(h,D,W,k).call(w,D,z),J.on("click",function(){t.event.defaultPrevented||(W.execute&&(W.args2&&D.active===ee?(n(k,D,0,L,M,P,-1),d.executeAPICommand(k,W.method,W.args2)):(n(k,D,0,L,M,P,ee),d.executeAPICommand(k,W.method,W.args))),k.emit("plotly_buttonclicked",{menu:D,button:W,active:D.active}))}),J.on("mouseover",function(){J.call(x)}),J.on("mouseout",function(){J.call(T,D),q.call(_,D)})}),q.call(_,D),$?(j.w=Math.max(Y.openWidth,Y.headerWidth),j.h=z.y-j.t):(j.w=z.x-j.l,j.h=Math.max(Y.openHeight,Y.headerHeight)),j.direction=D.direction,P&&(q.size()?function(W,ee,J,Q,te,ie){var ae,he,se,de=te.direction,ue=de==="up"||de==="down",ve=te._dims,ke=te.active;if(ue)for(he=0,se=0;se<ke;se++)he+=ve.heights[se]+l.gapButton;else for(ae=0,se=0;se<ke;se++)ae+=ve.widths[se]+l.gapButton;Q.enable(ie,ae,he),Q.hbar&&Q.hbar.attr("opacity","0").transition().attr("opacity","1"),Q.vbar&&Q.vbar.attr("opacity","0").transition().attr("opacity","1")}(0,0,0,P,D,j):function(W){var ee=!!W.hbar,J=!!W.vbar;ee&&W.hbar.transition().attr("opacity","0").each("end",function(){ee=!1,J||W.disable()}),J&&W.vbar.transition().attr("opacity","0").each("end",function(){J=!1,ee||W.disable()})}(P))}function h(k,L,M,P){k.call(y,L).call(v,L,M,P)}function y(k,L){e.ensureSingle(k,"rect",l.itemRectClassName,function(M){M.attr({rx:l.rx,ry:l.ry,"shape-rendering":"crispEdges"})}).call(m.stroke,L.bordercolor).call(m.fill,L.bgcolor).style("stroke-width",L.borderwidth+"px")}function v(k,L,M,P){var D=e.ensureSingle(k,"text",l.itemTextClassName,function(q){q.attr({"text-anchor":"start","data-notex":1})}),N=M.label,U=P._fullLayout._meta;U&&(N=e.templateString(N,U)),D.call(p.font,L.font).text(N).call(f.convertToTspans,P)}function _(k,L){var M=L.active;k.each(function(P,D){var N=t.select(this);D===M&&L.showactive&&N.select("rect."+l.itemRectClassName).call(m.fill,l.activeColor)})}function x(k){k.select("rect."+l.itemRectClassName).call(m.fill,l.hoverColor)}function T(k,L){k.select("rect."+l.itemRectClassName).call(m.fill,L.bgcolor)}function A(k,L){var M=L._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},P=p.tester.selectAll("g."+l.dropdownButtonClassName).data(e.filterVisible(L.buttons));P.enter().append("g").classed(l.dropdownButtonClassName,!0);var D=["up","down"].indexOf(L.direction)!==-1;P.each(function(Z,H){var Y=t.select(this);Y.call(h,L,Z,k);var $=Y.select("."+l.itemTextClassName),z=$.node()&&p.bBox($.node()).width,j=Math.max(z+l.textPadX,l.minWidth),W=L.font.size*s,ee=f.lineCount($),J=Math.max(W*ee,l.minHeight)+l.textOffsetY;J=Math.ceil(J),j=Math.ceil(j),M.widths[H]=j,M.heights[H]=J,M.height1=Math.max(M.height1,J),M.width1=Math.max(M.width1,j),D?(M.totalWidth=Math.max(M.totalWidth,j),M.openWidth=M.totalWidth,M.totalHeight+=J+l.gapButton,M.openHeight+=J+l.gapButton):(M.totalWidth+=j+l.gapButton,M.openWidth+=j+l.gapButton,M.totalHeight=Math.max(M.totalHeight,J),M.openHeight=M.totalHeight)}),D?M.totalHeight-=l.gapButton:M.totalWidth-=l.gapButton,M.headerWidth=M.width1+l.arrowPadX,M.headerHeight=M.height1,L.type==="dropdown"&&(D?(M.width1+=l.arrowPadX,M.totalHeight=M.height1):M.totalWidth=M.width1,M.totalWidth+=l.arrowPadX),P.remove();var N=M.totalWidth+L.pad.l+L.pad.r,U=M.totalHeight+L.pad.t+L.pad.b,q=k._fullLayout._size;M.lx=q.l+q.w*L.x,M.ly=q.t+q.h*(1-L.y);var X="left";e.isRightAnchor(L)&&(M.lx-=N,X="right"),e.isCenterAnchor(L)&&(M.lx-=N/2,X="center");var K="top";e.isBottomAnchor(L)&&(M.ly-=U,K="bottom"),e.isMiddleAnchor(L)&&(M.ly-=U/2,K="middle"),M.totalWidth=Math.ceil(M.totalWidth),M.totalHeight=Math.ceil(M.totalHeight),M.lx=Math.round(M.lx),M.ly=Math.round(M.ly),d.autoMargin(k,S(L),{x:L.x,y:L.y,l:N*({right:1,center:.5}[X]||0),r:N*({left:1,center:.5}[X]||0),b:U*({top:1,middle:.5}[K]||0),t:U*({bottom:1,middle:.5}[K]||0)})}function S(k){return l.autoMarginIdRoot+k._index}function w(k,L,M,P){P=P||{};var D=k.select("."+l.itemRectClassName),N=k.select("."+l.itemTextClassName),U=L.borderwidth,q=M.index,X=L._dims;p.setTranslate(k,U+M.x,U+M.y);var K=["up","down"].indexOf(L.direction)!==-1,Z=P.height||(K?X.heights[q]:X.height1);D.attr({x:0,y:0,width:P.width||(K?X.width1:X.widths[q]),height:Z});var H=L.font.size*s,Y=(f.lineCount(N)-1)*H/2;f.positionText(N,l.textOffsetX,Z/2-Y+l.textOffsetY),K?M.y+=X.heights[q]+M.yPad:M.x+=X.widths[q]+M.xPad,M.index++}function C(k,L){k.attr(l.menuIndexAttrName,L||"-1").selectAll("g."+l.dropdownButtonClassName).remove()}O.exports=function(k){var L=k._fullLayout,M=e.filterVisible(L[l.name]);function P(H){d.autoMargin(k,S(H))}var D=L._menulayer.selectAll("g."+l.containerClassName).data(M.length>0?[0]:[]);if(D.enter().append("g").classed(l.containerClassName,!0).style("cursor","pointer"),D.exit().each(function(){t.select(this).selectAll("g."+l.headerGroupClassName).each(P)}).remove(),M.length!==0){var N=D.selectAll("g."+l.headerGroupClassName).data(M,i);N.enter().append("g").classed(l.headerGroupClassName,!0);for(var U=e.ensureSingle(D,"g",l.dropdownButtonGroupClassName,function(H){H.style("pointer-events","all")}),q=0;q<M.length;q++){var X=M[q];A(k,X)}var K="updatemenus"+L._uid,Z=new o(k,U,K);N.enter().size()&&(U.node().parentNode.appendChild(U.node()),U.call(C)),N.exit().each(function(H){U.call(C),P(H)}).remove(),N.each(function(H){var Y=t.select(this),$=H.type==="dropdown"?U:null;d.manageCommandObserver(k,H,H.buttons,function(z){n(k,H,H.buttons[z.index],Y,$,Z,z.index,!0)}),H.type==="dropdown"?(a(k,Y,U,Z,H),c(U,H)&&g(k,Y,U,Z,H)):g(k,Y,null,null,H)})}}},{"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"../../plot_api/plot_template":827,"../../plots/plots":901,"../color":650,"../drawing":672,"./constants":750,"./scrollbox":754,"@plotly/d3":58}],753:[function(r,O,B){arguments[4][747][0].apply(B,arguments)},{"./attributes":749,"./constants":750,"./defaults":751,"./draw":752,dup:747}],754:[function(r,O,B){O.exports=e;var t=r("@plotly/d3"),d=r("../color"),m=r("../drawing"),p=r("../../lib");function e(f,u,s){this.gd=f,this.container=u,this.id=s,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(f,u,s){var l=this.gd._fullLayout,o=l.width,i=l.height;this.position=f;var c,n,a,g,h=this.position.l,y=this.position.w,v=this.position.t,_=this.position.h,x=this.position.direction,T=x==="down",A=x==="left",S=x==="up",w=y,C=_;T||A||x==="right"||S||(this.position.direction="down",T=!0),T||S?(n=(c=h)+w,T?(a=v,C=(g=Math.min(a+C,i))-a):C=(g=v+C)-(a=Math.max(g-C,0))):(g=(a=v)+C,A?w=(n=h+w)-(c=Math.max(n-w,0)):(c=h,w=(n=Math.min(c+w,o))-c)),this._box={l:c,t:a,w,h:C};var k=y>w,L=e.barLength+2*e.barPad,M=e.barWidth+2*e.barPad,P=h,D=v+_;D+M>i&&(D=i-M);var N=this.container.selectAll("rect.scrollbar-horizontal").data(k?[0]:[]);N.exit().on(".drag",null).remove(),N.enter().append("rect").classed("scrollbar-horizontal",!0).call(d.fill,e.barColor),k?(this.hbar=N.attr({rx:e.barRadius,ry:e.barRadius,x:P,y:D,width:L,height:M}),this._hbarXMin=P+L/2,this._hbarTranslateMax=w-L):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var U=_>C,q=e.barWidth+2*e.barPad,X=e.barLength+2*e.barPad,K=h+y,Z=v;K+q>o&&(K=o-q);var H=this.container.selectAll("rect.scrollbar-vertical").data(U?[0]:[]);H.exit().on(".drag",null).remove(),H.enter().append("rect").classed("scrollbar-vertical",!0).call(d.fill,e.barColor),U?(this.vbar=H.attr({rx:e.barRadius,ry:e.barRadius,x:K,y:Z,width:q,height:X}),this._vbarYMin=Z+X/2,this._vbarTranslateMax=C-X):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var Y=this.id,$=c-.5,z=U?n+q+.5:n+.5,j=a-.5,W=k?g+M+.5:g+.5,ee=l._topdefs.selectAll("#"+Y).data(k||U?[0]:[]);if(ee.exit().remove(),ee.enter().append("clipPath").attr("id",Y).append("rect"),k||U?(this._clipRect=ee.select("rect").attr({x:Math.floor($),y:Math.floor(j),width:Math.ceil(z)-Math.floor($),height:Math.ceil(W)-Math.floor(j)}),this.container.call(m.setClipUrl,Y,this.gd),this.bg.attr({x:h,y:v,width:y,height:_})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(m.setClipUrl,null),delete this._clipRect),k||U){var J=t.behavior.drag().on("dragstart",function(){t.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(J);var Q=t.behavior.drag().on("dragstart",function(){t.event.sourceEvent.preventDefault(),t.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));k&&this.hbar.on(".drag",null).call(Q),U&&this.vbar.on(".drag",null).call(Q)}this.setTranslate(u,s)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(m.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var f=this.translateX,u=this.translateY;this.hbar&&(f-=t.event.dx),this.vbar&&(u-=t.event.dy),this.setTranslate(f,u)},e.prototype._onBoxWheel=function(){var f=this.translateX,u=this.translateY;this.hbar&&(f+=t.event.deltaY),this.vbar&&(u+=t.event.deltaY),this.setTranslate(f,u)},e.prototype._onBarDrag=function(){var f=this.translateX,u=this.translateY;if(this.hbar){var s=f+this._hbarXMin,l=s+this._hbarTranslateMax;f=(p.constrain(t.event.x,s,l)-s)/(l-s)*(this.position.w-this._box.w)}if(this.vbar){var o=u+this._vbarYMin,i=o+this._vbarTranslateMax;u=(p.constrain(t.event.y,o,i)-o)/(i-o)*(this.position.h-this._box.h)}this.setTranslate(f,u)},e.prototype.setTranslate=function(f,u){var s=this.position.w-this._box.w,l=this.position.h-this._box.h;if(f=p.constrain(f||0,0,s),u=p.constrain(u||0,0,l),this.translateX=f,this.translateY=u,this.container.call(m.setTranslate,this._box.l-this.position.l-f,this._box.t-this.position.t-u),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+f-.5),y:Math.floor(this.position.t+u-.5)}),this.hbar){var o=f/s;this.hbar.call(m.setTranslate,f+o*this._hbarTranslateMax,u)}if(this.vbar){var i=u/l;this.vbar.call(m.setTranslate,f,u+i*this._vbarTranslateMax)}}},{"../../lib":787,"../color":650,"../drawing":672,"@plotly/d3":58}],755:[function(r,O,B){O.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],756:[function(r,O,B){O.exports={axisRefDescription:function(t,d,m){return["If set to a",t,"axis id (e.g. *"+t+"* or","*"+t+"2*), the `"+t+"` position refers to a",t,"coordinate. If set to *paper*, the `"+t+"`","position refers to the distance from the",d,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",d,"("+m+"). If set to a",t,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",d,"of the domain of that axis: e.g.,","*"+t+"2 domain* refers to the domain of the second",t," axis and a",t,"position of 0.5 refers to the","point between the",d,"and the",m,"of the domain of the","second",t,"axis."].join(" ")}}},{}],757:[function(r,O,B){O.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25B2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25BC"}}},{}],758:[function(r,O,B){O.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],759:[function(r,O,B){O.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],760:[function(r,O,B){O.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],761:[function(r,O,B){O.exports={circle:"\u25CF","circle-open":"\u25CB",square:"\u25A0","square-open":"\u25A1",diamond:"\u25C6","diamond-open":"\u25C7",cross:"+",x:"\u274C"}},{}],762:[function(r,O,B){O.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],763:[function(r,O,B){O.exports={BADNUM:void 0,FP_SAFE:1e-4*Number.MAX_VALUE,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:24405875e-1,ALMOST_EQUAL:.999999,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],764:[function(r,O,B){B.xmlns="http://www.w3.org/2000/xmlns/",B.svg="http://www.w3.org/2000/svg",B.xlink="http://www.w3.org/1999/xlink",B.svgAttrs={xmlns:B.svg,"xmlns:xlink":B.xlink}},{}],765:[function(r,O,B){B.version=r("./version").version,r("native-promise-only"),r("../build/plotcss");for(var t=r("./registry"),d=B.register=t.register,m=r("./plot_api"),p=Object.keys(m),e=0;e<p.length;e++){var f=p[e];f.charAt(0)!=="_"&&(B[f]=m[f]),d({moduleType:"apiMethod",name:f,fn:m[f]})}d(r("./traces/scatter")),d([r("./components/legend"),r("./components/fx"),r("./components/annotations"),r("./components/annotations3d"),r("./components/shapes"),r("./components/images"),r("./components/updatemenus"),r("./components/sliders"),r("./components/rangeslider"),r("./components/rangeselector"),r("./components/grid"),r("./components/errorbars"),r("./components/colorscale"),r("./components/colorbar"),r("./components/modebar")]),d([r("./locale-en"),r("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(d(window.PlotlyLocales),delete window.PlotlyLocales),B.Icons=r("./fonts/ploticon");var u=r("./components/fx"),s=r("./plots/plots");B.Plots={resize:s.resize,graphJson:s.graphJson,sendDataToCloud:s.sendDataToCloud},B.Fx={hover:u.hover,unhover:u.unhover,loneHover:u.loneHover,loneUnhover:u.loneUnhover},B.Snapshot=r("./snapshot"),B.PlotSchema=r("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":641,"./components/annotations3d":646,"./components/colorbar":656,"./components/colorscale":662,"./components/errorbars":678,"./components/fx":690,"./components/grid":694,"./components/images":699,"./components/legend":707,"./components/modebar":713,"./components/rangeselector":721,"./components/rangeslider":728,"./components/shapes":742,"./components/sliders":747,"./components/updatemenus":753,"./fonts/ploticon":766,"./locale-en":818,"./locale-en-us":817,"./plot_api":822,"./plot_api/plot_schema":826,"./plots/plots":901,"./registry":915,"./snapshot":920,"./traces/scatter":1214,"./version":1388,"native-promise-only":463}],766:[function(r,O,B){O.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'><defs><style>.cls-1 {fill: #3f4f75;} .cls-2 {fill: #80cfbe;} .cls-3 {fill: #fff;}</style></defs><title>plotly-logomark</title><g id='symbol'><rect class='cls-1' width='132' height='132' rx='6' ry='6'/><circle class='cls-2' cx='78' cy='54' r='6'/><circle class='cls-2' cx='102' cy='30' r='6'/><circle class='cls-2' cx='78' cy='30' r='6'/><circle class='cls-2' cx='54' cy='30' r='6'/><circle class='cls-2' cx='30' cy='30' r='6'/><circle class='cls-2' cx='30' cy='54' r='6'/><path class='cls-3' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/><path class='cls-3' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/><path class='cls-3' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/><path class='cls-3' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/></g></svg>"}}},{}],767:[function(r,O,B){B.isLeftAnchor=function(t){return t.xanchor==="left"||t.xanchor==="auto"&&t.x<=1/3},B.isCenterAnchor=function(t){return t.xanchor==="center"||t.xanchor==="auto"&&t.x>1/3&&t.x<2/3},B.isRightAnchor=function(t){return t.xanchor==="right"||t.xanchor==="auto"&&t.x>=2/3},B.isTopAnchor=function(t){return t.yanchor==="top"||t.yanchor==="auto"&&t.y>=2/3},B.isMiddleAnchor=function(t){return t.yanchor==="middle"||t.yanchor==="auto"&&t.y>1/3&&t.y<2/3},B.isBottomAnchor=function(t){return t.yanchor==="bottom"||t.yanchor==="auto"&&t.y<=1/3}},{}],768:[function(r,O,B){var t=r("./mod"),d=t.mod,m=t.modHalf,p=Math.PI,e=2*p;function f(o){return Math.abs(o[1]-o[0])>e-1e-14}function u(o,i){return m(i-o,e)}function s(o,i){if(f(i))return!0;var c,n;i[0]<i[1]?(c=i[0],n=i[1]):(c=i[1],n=i[0]),(c=d(c,e))>(n=d(n,e))&&(n+=e);var a=d(o,e),g=a+e;return a>=c&&a<=n||g>=c&&g<=n}function l(o,i,c,n,a,g,h){a=a||0,g=g||0;var y,v,_,x,T,A=f([c,n]);function S(L,M){return[L*Math.cos(M)+a,g-L*Math.sin(M)]}A?(y=0,v=p,_=e):c<n?(y=c,_=n):(y=n,_=c),o<i?(x=o,T=i):(x=i,T=o);var w,C=Math.abs(_-y)<=p?0:1;function k(L,M,P){return"A"+[L,L]+" "+[0,C,P]+" "+S(L,M)}return A?w=x===null?"M"+S(T,y)+k(T,v,0)+k(T,_,0)+"Z":"M"+S(x,y)+k(x,v,0)+k(x,_,0)+"ZM"+S(T,y)+k(T,v,1)+k(T,_,1)+"Z":x===null?(w="M"+S(T,y)+k(T,_,0),h&&(w+="L0,0Z")):w="M"+S(x,y)+"L"+S(T,y)+k(T,_,0)+"L"+S(x,_)+k(x,y,1)+"Z",w}O.exports={deg2rad:function(o){return o/180*p},rad2deg:function(o){return o/p*180},angleDelta:u,angleDist:function(o,i){return Math.abs(u(o,i))},isFullCircle:f,isAngleInsideSector:s,isPtInsideSector:function(o,i,c,n){return!!s(i,n)&&(c[0]<c[1]?(a=c[0],g=c[1]):(a=c[1],g=c[0]),o>=a&&o<=g);var a,g},pathArc:function(o,i,c,n,a){return l(null,o,i,c,n,a,0)},pathSector:function(o,i,c,n,a){return l(null,o,i,c,n,a,1)},pathAnnulus:function(o,i,c,n,a,g){return l(o,i,c,n,a,g,1)}}},{"./mod":794}],769:[function(r,O,B){var t=Array.isArray,d=ArrayBuffer,m=DataView;function p(u){return d.isView(u)&&!(u instanceof m)}function e(u){return t(u)||p(u)}function f(u,s,l){if(e(u)){if(e(u[0])){for(var o=l,i=0;i<u.length;i++)o=s(o,u[i].length);return o}return u.length}return 0}B.isTypedArray=p,B.isArrayOrTypedArray=e,B.isArray1D=function(u){return!e(u[0])},B.ensureArray=function(u,s){return t(u)||(u=[]),u.length=s,u},B.concat=function(){var u,s,l,o,i,c,n,a,g=[],h=!0,y=0;for(l=0;l<arguments.length;l++)(c=(o=arguments[l]).length)&&(s?g.push(o):(s=o,i=c),t(o)?u=!1:(h=!1,y?u!==o.constructor&&(u=!1):u=o.constructor),y+=c);if(!y)return[];if(!g.length)return s;if(h)return s.concat.apply(s,g);if(u){for((n=new u(y)).set(s),l=0;l<g.length;l++)o=g[l],n.set(o,i),i+=o.length;return n}for(n=new Array(y),a=0;a<s.length;a++)n[a]=s[a];for(l=0;l<g.length;l++){for(o=g[l],a=0;a<o.length;a++)n[i+a]=o[a];i+=a}return n},B.maxRowLength=function(u){return f(u,Math.max,0)},B.minRowLength=function(u){return f(u,Math.min,1/0)}},{}],770:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../constants/numerical").BADNUM,m=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;O.exports=function(p){return typeof p=="string"&&(p=p.replace(m,"")),t(p)?Number(p):d}},{"../constants/numerical":763,"fast-isnumeric":246}],771:[function(r,O,B){O.exports=function(t){var d=t._fullLayout;d._glcanvas&&d._glcanvas.size()&&d._glcanvas.each(function(m){m.regl&&m.regl.clear({color:!0,depth:!0})})}},{}],772:[function(r,O,B){O.exports=function(t){t._responsiveChartHandler&&(window.removeEventListener("resize",t._responsiveChartHandler),delete t._responsiveChartHandler)}},{}],773:[function(r,O,B){var t=r("fast-isnumeric"),d=r("tinycolor2"),m=r("../plots/attributes"),p=r("../components/colorscale/scales"),e=r("../components/color"),f=r("../constants/interactions").DESELECTDIM,u=r("./nested_property"),s=r("./regex").counter,l=r("./mod").modHalf,o=r("./array").isArrayOrTypedArray;function i(c,n){var a=B.valObjectMeta[n.valType];if(n.arrayOk&&o(c))return!0;if(a.validateFunction)return a.validateFunction(c,n);var g={},h=g,y={set:function(v){h=v}};return a.coerceFunction(c,y,g,n),h!==g}B.valObjectMeta={data_array:{coerceFunction:function(c,n,a){o(c)?n.set(c):a!==void 0&&n.set(a)}},enumerated:{coerceFunction:function(c,n,a,g){g.coerceNumber&&(c=+c),g.values.indexOf(c)===-1?n.set(a):n.set(c)},validateFunction:function(c,n){n.coerceNumber&&(c=+c);for(var a=n.values,g=0;g<a.length;g++){var h=String(a[g]);if(h.charAt(0)==="/"&&h.charAt(h.length-1)==="/"){if(new RegExp(h.substr(1,h.length-2)).test(c))return!0}else if(c===a[g])return!0}return!1}},boolean:{coerceFunction:function(c,n,a){c===!0||c===!1?n.set(c):n.set(a)}},number:{coerceFunction:function(c,n,a,g){!t(c)||g.min!==void 0&&c<g.min||g.max!==void 0&&c>g.max?n.set(a):n.set(+c)}},integer:{coerceFunction:function(c,n,a,g){c%1||!t(c)||g.min!==void 0&&c<g.min||g.max!==void 0&&c>g.max?n.set(a):n.set(+c)}},string:{coerceFunction:function(c,n,a,g){if(typeof c!="string"){var h=typeof c=="number";g.strict!==!0&&h?n.set(String(c)):n.set(a)}else g.noBlank&&!c?n.set(a):n.set(c)}},color:{coerceFunction:function(c,n,a){d(c).isValid()?n.set(c):n.set(a)}},colorlist:{coerceFunction:function(c,n,a){Array.isArray(c)&&c.length&&c.every(function(g){return d(g).isValid()})?n.set(c):n.set(a)}},colorscale:{coerceFunction:function(c,n,a){n.set(p.get(c,a))}},angle:{coerceFunction:function(c,n,a){c==="auto"?n.set("auto"):t(c)?n.set(l(+c,360)):n.set(a)}},subplotid:{coerceFunction:function(c,n,a,g){var h=g.regex||s(a);typeof c=="string"&&h.test(c)?n.set(c):n.set(a)},validateFunction:function(c,n){var a=n.dflt;return c===a||typeof c=="string"&&!!s(a).test(c)}},flaglist:{coerceFunction:function(c,n,a,g){if(typeof c=="string")if((g.extras||[]).indexOf(c)===-1){for(var h=c.split("+"),y=0;y<h.length;){var v=h[y];g.flags.indexOf(v)===-1||h.indexOf(v)<y?h.splice(y,1):y++}h.length?n.set(h.join("+")):n.set(a)}else n.set(c);else n.set(a)}},any:{coerceFunction:function(c,n,a){c===void 0?n.set(a):n.set(c)}},info_array:{coerceFunction:function(c,n,a,g){function h(D,N,U){var q,X={set:function(K){q=K}};return U===void 0&&(U=N.dflt),B.valObjectMeta[N.valType].coerceFunction(D,X,U,N),q}var y=g.dimensions===2||g.dimensions==="1-2"&&Array.isArray(c)&&Array.isArray(c[0]);if(Array.isArray(c)){var v,_,x,T,A,S,w=g.items,C=[],k=Array.isArray(w),L=k&&y&&Array.isArray(w[0]),M=y&&k&&!L,P=k&&!M?w.length:c.length;if(a=Array.isArray(a)?a:[],y)for(v=0;v<P;v++)for(C[v]=[],x=Array.isArray(c[v])?c[v]:[],A=M?w.length:k?w[v].length:x.length,_=0;_<A;_++)T=M?w[_]:k?w[v][_]:w,(S=h(x[_],T,(a[v]||[])[_]))!==void 0&&(C[v][_]=S);else for(v=0;v<P;v++)(S=h(c[v],k?w[v]:w,a[v]))!==void 0&&(C[v]=S);n.set(C)}else n.set(a)},validateFunction:function(c,n){if(!Array.isArray(c))return!1;var a=n.items,g=Array.isArray(a),h=n.dimensions===2;if(!n.freeLength&&c.length!==a.length)return!1;for(var y=0;y<c.length;y++)if(h){if(!Array.isArray(c[y])||!n.freeLength&&c[y].length!==a[y].length)return!1;for(var v=0;v<c[y].length;v++)if(!i(c[y][v],g?a[y][v]:a))return!1}else if(!i(c[y],g?a[y]:a))return!1;return!0}}},B.coerce=function(c,n,a,g,h){var y=u(a,g).get(),v=u(c,g),_=u(n,g),x=v.get(),T=n._template;if(x===void 0&&T&&(x=u(T,g).get(),T=0),h===void 0&&(h=y.dflt),y.arrayOk&&o(x))return _.set(x),x;var A=B.valObjectMeta[y.valType].coerceFunction;A(x,_,h,y);var S=_.get();return T&&S===h&&!i(x,y)&&(A(x=u(T,g).get(),_,h,y),S=_.get()),S},B.coerce2=function(c,n,a,g,h){var y=u(c,g),v=B.coerce(c,n,a,g,h),_=y.get();return _!=null&&v},B.coerceFont=function(c,n,a){var g={};return a=a||{},g.family=c(n+".family",a.family),g.size=c(n+".size",a.size),g.color=c(n+".color",a.color),g},B.coercePattern=function(c,n,a,g){if(c(n+".shape")){c(n+".solidity"),c(n+".size");var h=c(n+".fillmode")==="overlay";if(!g){var y=c(n+".bgcolor",h?a:void 0);c(n+".fgcolor",h?e.contrast(y):a)}c(n+".fgopacity",h?.5:1)}},B.coerceHoverinfo=function(c,n,a){var g,h=n._module.attributes,y=h.hoverinfo?h:m,v=y.hoverinfo;if(a._dataLength===1){var _=v.dflt==="all"?v.flags.slice():v.dflt.split("+");_.splice(_.indexOf("name"),1),g=_.join("+")}return B.coerce(c,n,y,"hoverinfo",g)},B.coerceSelectionMarkerOpacity=function(c,n){if(c.marker){var a,g,h=c.marker.opacity;h!==void 0&&(o(h)||c.selected||c.unselected||(a=h,g=f*h),n("selected.marker.opacity",a),n("unselected.marker.opacity",g))}},B.validate=i},{"../components/color":650,"../components/colorscale/scales":665,"../constants/interactions":762,"../plots/attributes":834,"./array":769,"./mod":794,"./nested_property":795,"./regex":804,"fast-isnumeric":246,tinycolor2:583}],774:[function(r,O,B){var t,d,m=r("d3-time-format").timeFormat,p=r("fast-isnumeric"),e=r("./loggers"),f=r("./mod").mod,u=r("../constants/numerical"),s=u.BADNUM,l=u.ONEDAY,o=u.ONEHOUR,i=u.ONEMIN,c=u.ONESEC,n=u.EPOCHJD,a=r("../registry"),g=r("d3-time-format").utcFormat,h=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,y=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,v=new Date().getFullYear()-70;function _(N){return N&&a.componentsRegistry.calendars&&typeof N=="string"&&N!=="gregorian"}function x(N,U){return String(N+Math.pow(10,U)).substr(1)}B.dateTick0=function(N,U){var q=function(K,Z){return _(K)?Z?a.getComponentMethod("calendars","CANONICAL_SUNDAY")[K]:a.getComponentMethod("calendars","CANONICAL_TICK")[K]:Z?"2000-01-02":"2000-01-01"}(N,!!U);if(U<2)return q;var X=B.dateTime2ms(q,N);return X+=l*(U-1),B.ms2DateTime(X,0,N)},B.dfltRange=function(N){return _(N)?a.getComponentMethod("calendars","DFLTRANGE")[N]:["2000-01-01","2001-01-01"]},B.isJSDate=function(N){return typeof N=="object"&&N!==null&&typeof N.getTime=="function"},B.dateTime2ms=function(N,U){if(B.isJSDate(N)){var q=N.getTimezoneOffset()*i,X=(N.getUTCMinutes()-N.getMinutes())*i+(N.getUTCSeconds()-N.getSeconds())*c+(N.getUTCMilliseconds()-N.getMilliseconds());if(X){var K=3*i;q=q-K/2+f(X-q+K/2,K)}return(N=Number(N)-q)>=t&&N<=d?N:s}if(typeof N!="string"&&typeof N!="number")return s;N=String(N);var Z=_(U),H=N.charAt(0);!Z||H!=="G"&&H!=="g"||(N=N.substr(1),U="");var Y=Z&&U.substr(0,7)==="chinese",$=N.match(Y?y:h);if(!$)return s;var z=$[1],j=$[3]||"1",W=Number($[5]||1),ee=Number($[7]||0),J=Number($[9]||0),Q=Number($[11]||0);if(Z){if(z.length===2)return s;var te;z=Number(z);try{var ie=a.getComponentMethod("calendars","getCal")(U);if(Y){var ae=j.charAt(j.length-1)==="i";j=parseInt(j,10),te=ie.newDate(z,ie.toMonthIndex(z,j,ae),W)}else te=ie.newDate(z,Number(j),W)}catch(se){return s}return te?(te.toJD()-n)*l+ee*o+J*i+Q*c:s}z=z.length===2?(Number(z)+2e3-v)%100+v:Number(z),j-=1;var he=new Date(Date.UTC(2e3,j,W,ee,J));return he.setUTCFullYear(z),he.getUTCMonth()!==j||he.getUTCDate()!==W?s:he.getTime()+Q*c},t=B.MIN_MS=B.dateTime2ms("-9999"),d=B.MAX_MS=B.dateTime2ms("9999-12-31 23:59:59.9999"),B.isDateTime=function(N,U){return B.dateTime2ms(N,U)!==s};var T=90*l,A=3*o,S=5*i;function w(N,U,q,X,K){if((U||q||X||K)&&(N+=" "+x(U,2)+":"+x(q,2),(X||K)&&(N+=":"+x(X,2),K))){for(var Z=4;K%10==0;)Z-=1,K/=10;N+="."+x(K,Z)}return N}B.ms2DateTime=function(N,U,q){if(typeof N!="number"||!(N>=t&&N<=d))return s;U||(U=0);var X,K,Z,H,Y,$,z=Math.floor(10*f(N+.05,1)),j=Math.round(N-z/10);if(_(q)){var W=Math.floor(j/l)+n,ee=Math.floor(f(N,l));try{X=a.getComponentMethod("calendars","getCal")(q).fromJD(W).formatDate("yyyy-mm-dd")}catch(J){X=g("G%Y-%m-%d")(new Date(j))}if(X.charAt(0)==="-")for(;X.length<11;)X="-0"+X.substr(1);else for(;X.length<10;)X="0"+X;K=U<T?Math.floor(ee/o):0,Z=U<T?Math.floor(ee%o/i):0,H=U<A?Math.floor(ee%i/c):0,Y=U<S?ee%c*10+z:0}else $=new Date(j),X=g("%Y-%m-%d")($),K=U<T?$.getUTCHours():0,Z=U<T?$.getUTCMinutes():0,H=U<A?$.getUTCSeconds():0,Y=U<S?10*$.getUTCMilliseconds()+z:0;return w(X,K,Z,H,Y)},B.ms2DateTimeLocal=function(N){if(!(N>=t+l&&N<=d-l))return s;var U=Math.floor(10*f(N+.05,1)),q=new Date(Math.round(N-U/10));return w(m("%Y-%m-%d")(q),q.getHours(),q.getMinutes(),q.getSeconds(),10*q.getUTCMilliseconds()+U)},B.cleanDate=function(N,U,q){if(N===s)return U;if(B.isJSDate(N)||typeof N=="number"&&isFinite(N)){if(_(q))return e.error("JS Dates and milliseconds are incompatible with world calendars",N),U;if(!(N=B.ms2DateTimeLocal(+N))&&U!==void 0)return U}else if(!B.isDateTime(N,q))return e.error("unrecognized date",N),U;return N};var C=/%\d?f/g,k=/%h/g,L={1:"1",2:"1",3:"2",4:"2"};function M(N,U,q,X){N=N.replace(C,function(Z){var H=Math.min(+Z.charAt(1)||6,6);return(U/1e3%1+2).toFixed(H).substr(2).replace(/0+$/,"")||"0"});var K=new Date(Math.floor(U+.05));if(N=N.replace(k,function(){return L[q("%q")(K)]}),_(X))try{N=a.getComponentMethod("calendars","worldCalFmt")(N,U,X)}catch(Z){return"Invalid"}return q(N)(K)}var P=[59,59.9,59.99,59.999,59.9999];B.formatDate=function(N,U,q,X,K,Z){if(K=_(K)&&K,!U)if(q==="y")U=Z.year;else if(q==="m")U=Z.month;else{if(q!=="d")return function(H,Y){var $=f(H+.05,l),z=x(Math.floor($/o),2)+":"+x(f(Math.floor($/i),60),2);if(Y!=="M"){p(Y)||(Y=0);var j=(100+Math.min(f(H/c,60),P[Y])).toFixed(Y).substr(1);Y>0&&(j=j.replace(/0+$/,"").replace(/[\.]$/,"")),z+=":"+j}return z}(N,q)+`
`+M(Z.dayMonthYear,N,X,K);U=Z.dayMonth+`
`+Z.year}return M(U,N,X,K)};var D=3*l;B.incrementMonth=function(N,U,q){q=_(q)&&q;var X=f(N,l);if(N=Math.round(N-X),q)try{var K=Math.round(N/l)+n,Z=a.getComponentMethod("calendars","getCal")(q),H=Z.fromJD(K);return U%12?Z.add(H,U,"m"):Z.add(H,U/12,"y"),(H.toJD()-n)*l+X}catch($){e.error("invalid ms "+N+" in calendar "+q)}var Y=new Date(N+D);return Y.setUTCMonth(Y.getUTCMonth()+U)+X-D},B.findExactDates=function(N,U){for(var q,X,K=0,Z=0,H=0,Y=0,$=_(U)&&a.getComponentMethod("calendars","getCal")(U),z=0;z<N.length;z++)if(X=N[z],p(X)){if(!(X%l))if($)try{(q=$.fromJD(X/l+n)).day()===1?q.month()===1?K++:Z++:H++}catch(W){}else(q=new Date(X)).getUTCDate()===1?q.getUTCMonth()===0?K++:Z++:H++}else Y++;H+=Z+=K;var j=N.length-Y;return{exactYears:K/j,exactMonths:Z/j,exactDays:H/j}}},{"../constants/numerical":763,"../registry":915,"./loggers":791,"./mod":794,"d3-time-format":172,"fast-isnumeric":246}],775:[function(r,O,B){var t=r("@plotly/d3"),d=r("./loggers"),m=r("./matrix"),p=r("gl-mat4");function e(o){var i=o&&o.parentNode;i&&i.removeChild(o)}function f(o,i,c){var n="plotly.js-style-"+o,a=document.getElementById(n);a||((a=document.createElement("style")).setAttribute("id",n),a.appendChild(document.createTextNode("")),document.head.appendChild(a));var g=a.sheet;g.insertRule?g.insertRule(i+"{"+c+"}",0):g.addRule?g.addRule(i,c,0):d.warn("addStyleRule failed")}function u(o){var i=window.getComputedStyle(o,null),c=i.getPropertyValue("-webkit-transform")||i.getPropertyValue("-moz-transform")||i.getPropertyValue("-ms-transform")||i.getPropertyValue("-o-transform")||i.getPropertyValue("transform");return c==="none"?null:c.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(n){return+n})}function s(o){for(var i=[];l(o);)i.push(o),o=o.parentNode;return i}function l(o){return o&&(o instanceof Element||o instanceof HTMLElement)}O.exports={getGraphDiv:function(o){var i;if(typeof o=="string"){if((i=document.getElementById(o))===null)throw new Error("No DOM element with id '"+o+"' exists on the page.");return i}if(o==null)throw new Error("DOM element provided is null or undefined");return o},isPlotDiv:function(o){var i=t.select(o);return i.node()instanceof HTMLElement&&i.size()&&i.classed("js-plotly-plot")},removeElement:e,addStyleRule:function(o,i){f("global",o,i)},addRelatedStyleRule:f,deleteRelatedStyleRule:function(o){var i="plotly.js-style-"+o,c=document.getElementById(i);c&&e(c)},getFullTransformMatrix:function(o){var i=s(o),c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return i.forEach(function(n){var a=u(n);if(a){var g=m.convertCssMatrix(a);c=p.multiply(c,c,g)}}),c},getElementTransformMatrix:u,getElementAndAncestors:s,equalDomRects:function(o,i){return o&&i&&o.x===i.x&&o.y===i.y&&o.top===i.top&&o.left===i.left&&o.right===i.right&&o.bottom===i.bottom}}},{"./loggers":791,"./matrix":793,"@plotly/d3":58,"gl-mat4":292}],776:[function(r,O,B){var t=r("events").EventEmitter,d={init:function(m){if(m._ev instanceof t)return m;var p=new t,e=new t;return m._ev=p,m._internalEv=e,m.on=p.on.bind(p),m.once=p.once.bind(p),m.removeListener=p.removeListener.bind(p),m.removeAllListeners=p.removeAllListeners.bind(p),m._internalOn=e.on.bind(e),m._internalOnce=e.once.bind(e),m._removeInternalListener=e.removeListener.bind(e),m._removeAllInternalListeners=e.removeAllListeners.bind(e),m.emit=function(f,u){typeof jQuery!="undefined"&&jQuery(m).trigger(f,u),p.emit(f,u),e.emit(f,u)},m},triggerHandler:function(m,p,e){var f,u;typeof jQuery!="undefined"&&(f=jQuery(m).triggerHandler(p,e));var s=m._ev;if(!s)return f;var l,o=s._events[p];if(!o)return f;function i(c){return c.listener?(s.removeListener(p,c.listener),c.fired?void 0:(c.fired=!0,c.listener.apply(s,[e]))):c.apply(s,[e])}for(o=Array.isArray(o)?o:[o],l=0;l<o.length-1;l++)i(o[l]);return u=i(o[l]),f!==void 0?f:u},purge:function(m){return delete m._ev,delete m.on,delete m.once,delete m.removeListener,delete m.removeAllListeners,delete m.emit,delete m._ev,delete m._internalEv,delete m._internalOn,delete m._internalOnce,delete m._removeInternalListener,delete m._removeAllInternalListeners,m}};O.exports=d},{events:116}],777:[function(r,O,B){var t=r("./is_plain_object.js"),d=Array.isArray;function m(p,e,f,u){var s,l,o,i,c,n,a=p[0],g=p.length;if(g===2&&d(a)&&d(p[1])&&a.length===0){if(function(y,v){var _,x;for(_=0;_<y.length;_++){if((x=y[_])!==null&&typeof x=="object")return!1;x!==void 0&&(v[_]=x)}return!0}(p[1],a))return a;a.splice(0,a.length)}for(var h=1;h<g;h++)for(l in s=p[h])o=a[l],i=s[l],u&&d(i)?a[l]=i:e&&i&&(t(i)||(c=d(i)))?(c?(c=!1,n=o&&d(o)?o:[]):n=o&&t(o)?o:{},a[l]=m([n,i],e,f,u)):(i!==void 0||f)&&(a[l]=i);return a}B.extendFlat=function(){return m(arguments,!1,!1,!1)},B.extendDeep=function(){return m(arguments,!0,!1,!1)},B.extendDeepAll=function(){return m(arguments,!0,!0,!1)},B.extendDeepNoArrays=function(){return m(arguments,!0,!1,!0)}},{"./is_plain_object.js":788}],778:[function(r,O,B){O.exports=function(t){for(var d={},m=[],p=0,e=0;e<t.length;e++){var f=t[e];d[f]!==1&&(d[f]=1,m[p++]=f)}return m}},{}],779:[function(r,O,B){function t(m){return m.visible===!0}function d(m){var p=m[0].trace;return p.visible===!0&&p._length!==0}O.exports=function(m){for(var p,e=(p=m,Array.isArray(p)&&Array.isArray(p[0])&&p[0][0]&&p[0][0].trace?d:t),f=[],u=0;u<m.length;u++){var s=m[u];e(s)&&f.push(s)}return f}},{}],780:[function(r,O,B){var t=r("@plotly/d3"),d=r("country-regex"),m=r("@turf/area"),p=r("@turf/centroid"),e=r("@turf/bbox"),f=r("./identity"),u=r("./loggers"),s=r("./is_plain_object"),l=r("./nested_property"),o=r("./polygon"),i=Object.keys(d),c={"ISO-3":f,"USA-states":f,"country names":function(a){for(var g=0;g<i.length;g++){var h=i[g];if(new RegExp(d[h]).test(a.trim().toLowerCase()))return h}return u.log("Unrecognized country name: "+a+"."),!1}};function n(a){var g=a.geojson,h=window.PlotlyGeoAssets||{},y=typeof g=="string"?h[g]:g;return s(y)?y:(u.error("Oops ... something went wrong when fetching "+g),!1)}O.exports={locationToFeature:function(a,g,h){if(!g||typeof g!="string")return!1;var y,v,_,x=c[a](g);if(x){if(a==="USA-states")for(y=[],_=0;_<h.length;_++)(v=h[_]).properties&&v.properties.gu&&v.properties.gu==="USA"&&y.push(v);else y=h;for(_=0;_<y.length;_++)if((v=y[_]).id===x)return v;u.log(["Location with id",x,"does not have a matching topojson feature at this resolution."].join(" "))}return!1},feature2polygons:function(a){var g,h,y,v,_=a.geometry,x=_.coordinates,T=a.id,A=[];function S(w){for(var C=0;C<w.length-1;C++)if(w[C][0]>0&&w[C+1][0]<0)return C;return null}switch(g=T==="RUS"||T==="FJI"?function(w){var C;if(S(w)===null)C=w;else for(C=new Array(w.length),v=0;v<w.length;v++)C[v]=[w[v][0]<0?w[v][0]+360:w[v][0],w[v][1]];A.push(o.tester(C))}:T==="ATA"?function(w){var C=S(w);if(C===null)return A.push(o.tester(w));var k=new Array(w.length+1),L=0;for(v=0;v<w.length;v++)v>C?k[L++]=[w[v][0]+360,w[v][1]]:v===C?(k[L++]=w[v],k[L++]=[w[v][0],-90]):k[L++]=w[v];var M=o.tester(k);M.pts.pop(),A.push(M)}:function(w){A.push(o.tester(w))},_.type){case"MultiPolygon":for(h=0;h<x.length;h++)for(y=0;y<x[h].length;y++)g(x[h][y]);break;case"Polygon":for(h=0;h<x.length;h++)g(x[h])}return A},getTraceGeojson:n,extractTraceFeature:function(a){var g=a[0].trace,h=n(g);if(!h)return!1;var y,v={},_=[];for(y=0;y<g._length;y++){var x=a[y];(x.loc||x.loc===0)&&(v[x.loc]=x)}function T(w){var C=l(w,g.featureidkey||"id").get(),k=v[C];if(k){var L=w.geometry;if(L.type==="Polygon"||L.type==="MultiPolygon"){var M={type:"Feature",id:C,geometry:L,properties:{}};M.properties.ct=function(P){var D,N=P.geometry;if(N.type==="MultiPolygon")for(var U=N.coordinates,q=0,X=0;X<U.length;X++){var K={type:"Polygon",coordinates:U[X]},Z=m.default(K);Z>q&&(q=Z,D=K)}else D=N;return p.default(D).geometry.coordinates}(M),k.fIn=w,k.fOut=M,_.push(M)}else u.log(["Location",k.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete v[C]}switch(h.type){case"FeatureCollection":var A=h.features;for(y=0;y<A.length;y++)T(A[y]);break;case"Feature":T(h);break;default:return u.warn(["Invalid GeoJSON type",(h.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var S in v)u.log(["Location *"+S+"*","does not have a matching feature with id-key","*"+g.featureidkey+"*."].join(" "));return _},fetchTraceGeoData:function(a){var g=window.PlotlyGeoAssets||{},h=[];function y(T){return new Promise(function(A,S){t.json(T,function(w,C){if(w){delete g[T];var k=w.status===404?'GeoJSON at URL "'+T+'" does not exist.':"Unexpected error while fetching from "+T;return S(new Error(k))}return g[T]=C,A(C)})})}function v(T){return new Promise(function(A,S){var w=0,C=setInterval(function(){return g[T]&&g[T]!=="pending"?(clearInterval(C),A(g[T])):w>100?(clearInterval(C),S("Unexpected error while fetching from "+T)):void w++},50)})}for(var _=0;_<a.length;_++){var x=a[_][0].trace.geojson;typeof x=="string"&&(g[x]?g[x]==="pending"&&h.push(v(x)):(g[x]="pending",h.push(y(x))))}return h},computeBbox:function(a){return e.default(a)}}},{"./identity":785,"./is_plain_object":788,"./loggers":791,"./nested_property":795,"./polygon":799,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":145}],781:[function(r,O,B){var t=r("../constants/numerical").BADNUM;B.calcTraceToLineCoords=function(d){for(var m=d[0].trace.connectgaps,p=[],e=[],f=0;f<d.length;f++){var u=d[f].lonlat;u[0]!==t?e.push(u):!m&&e.length>0&&(p.push(e),e=[])}return e.length>0&&p.push(e),p},B.makeLine=function(d){return d.length===1?{type:"LineString",coordinates:d[0]}:{type:"MultiLineString",coordinates:d}},B.makePolygon=function(d){if(d.length===1)return{type:"Polygon",coordinates:d};for(var m=new Array(d.length),p=0;p<d.length;p++)m[p]=[d[p]];return{type:"MultiPolygon",coordinates:m}},B.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":763}],782:[function(r,O,B){var t,d,m,p=r("./mod").mod;function e(u,s,l,o,i,c,n,a){var g=l-u,h=i-u,y=n-i,v=o-s,_=c-s,x=a-c,T=g*x-y*v;if(T===0)return null;var A=(h*x-y*_)/T,S=(h*v-g*_)/T;return S<0||S>1||A<0||A>1?null:{x:u+g*A,y:s+v*A}}function f(u,s,l,o,i){var c=o*u+i*s;if(c<0)return o*o+i*i;if(c>l){var n=o-u,a=i-s;return n*n+a*a}var g=o*s-i*u;return g*g/l}B.segmentsIntersect=e,B.segmentDistance=function(u,s,l,o,i,c,n,a){if(e(u,s,l,o,i,c,n,a))return 0;var g=l-u,h=o-s,y=n-i,v=a-c,_=g*g+h*h,x=y*y+v*v,T=Math.min(f(g,h,_,i-u,c-s),f(g,h,_,n-u,a-s),f(y,v,x,u-i,s-c),f(y,v,x,l-i,o-c));return Math.sqrt(T)},B.getTextLocation=function(u,s,l,o){if(u===d&&o===m||(t={},d=u,m=o),t[l])return t[l];var i=u.getPointAtLength(p(l-o/2,s)),c=u.getPointAtLength(p(l+o/2,s)),n=Math.atan((c.y-i.y)/(c.x-i.x)),a=u.getPointAtLength(p(l,s)),g={x:(4*a.x+i.x+c.x)/6,y:(4*a.y+i.y+c.y)/6,theta:n};return t[l]=g,g},B.clearLocationCache=function(){d=null},B.getVisibleSegment=function(u,s,l){var o,i,c=s.left,n=s.right,a=s.top,g=s.bottom,h=0,y=u.getTotalLength(),v=y;function _(T){var A=u.getPointAtLength(T);T===0?o=A:T===y&&(i=A);var S=A.x<c?c-A.x:A.x>n?A.x-n:0,w=A.y<a?a-A.y:A.y>g?A.y-g:0;return Math.sqrt(S*S+w*w)}for(var x=_(h);x;){if((h+=x+l)>v)return;x=_(h)}for(x=_(v);x;){if(h>(v-=x+l))return;x=_(v)}return{min:h,max:v,len:v-h,total:y,isClosed:h===0&&v===y&&Math.abs(o.x-i.x)<.1&&Math.abs(o.y-i.y)<.1}},B.findPointOnPath=function(u,s,l,o){for(var i,c,n,a=(o=o||{}).pathLength||u.getTotalLength(),g=o.tolerance||.001,h=o.iterationLimit||30,y=u.getPointAtLength(0)[l]>u.getPointAtLength(a)[l]?-1:1,v=0,_=0,x=a;v<h;){if(i=(_+x)/2,n=(c=u.getPointAtLength(i))[l]-s,Math.abs(n)<g)return c;y*n>0?x=i:_=i,v++}return c}},{"./mod":794}],783:[function(r,O,B){var t=r("fast-isnumeric"),d=r("tinycolor2"),m=r("color-normalize"),p=r("../components/colorscale"),e=r("../components/color/attributes").defaultLine,f=r("./array").isArrayOrTypedArray,u=m(e);function s(i,c){var n=i;return n[3]*=c,n}function l(i){if(t(i))return u;var c=m(i);return c.length?c:u}function o(i){return t(i)?i:1}O.exports={formatColor:function(i,c,n){var a,g,h,y,v,_=i.color,x=f(_),T=f(c),A=p.extractOpts(i),S=[];if(a=A.colorscale!==void 0?p.makeColorScaleFuncFromTrace(i):l,g=x?function(C,k){return C[k]===void 0?u:m(a(C[k]))}:l,h=T?function(C,k){return C[k]===void 0?1:o(C[k])}:o,x||T)for(var w=0;w<n;w++)y=g(_,w),v=h(c,w),S[w]=s(y,v);else S=s(m(_),c);return S},parseColorScale:function(i){var c=p.extractOpts(i),n=c.colorscale;return c.reversescale&&(n=p.flipScale(c.colorscale)),n.map(function(a){var g=a[0],h=d(a[1]).toRgb();return{index:g,rgb:[h.r,h.g,h.b,h.a]}})}}},{"../components/color/attributes":649,"../components/colorscale":662,"./array":769,"color-normalize":131,"fast-isnumeric":246,tinycolor2:583}],784:[function(r,O,B){var t=r("./identity");function d(m){return[m]}O.exports={keyFun:function(m){return m.key},repeat:d,descend:t,wrap:d,unwrap:function(m){return m[0]}}},{"./identity":785}],785:[function(r,O,B){O.exports=function(t){return t}},{}],786:[function(r,O,B){O.exports=function(t,d){if(!d)return t;var m=1/Math.abs(d),p=m>1?(m*t+m*d)/m:t+d,e=String(p).length;if(e>16){var f=String(d).length;if(e>=String(t).length+f){var u=parseFloat(p).toPrecision(12);u.indexOf("e+")===-1&&(p=+u)}}return p}},{}],787:[function(r,O,B){var t=r("@plotly/d3"),d=r("d3-time-format").utcFormat,m=r("d3-format").format,p=r("fast-isnumeric"),e=r("../constants/numerical"),f=e.FP_SAFE,u=-f,s=e.BADNUM,l=O.exports={};l.adjustFormat=function(z){return!z||/^\d[.]\df/.test(z)||/[.]\d%/.test(z)?z:z==="0.f"?"~f":/^\d%/.test(z)?"~%":/^\ds/.test(z)?"~s":!/^[~,.0$]/.test(z)&&/[&fps]/.test(z)?"~"+z:z};var o={};l.warnBadFormat=function(z){var j=String(z);o[j]||(o[j]=1,l.warn('encountered bad format: "'+j+'"'))},l.noFormat=function(z){return String(z)},l.numberFormat=function(z){var j;try{j=m(l.adjustFormat(z))}catch(W){return l.warnBadFormat(z),l.noFormat}return j},l.nestedProperty=r("./nested_property"),l.keyedContainer=r("./keyed_container"),l.relativeAttr=r("./relative_attr"),l.isPlainObject=r("./is_plain_object"),l.toLogRange=r("./to_log_range"),l.relinkPrivateKeys=r("./relink_private");var i=r("./array");l.isTypedArray=i.isTypedArray,l.isArrayOrTypedArray=i.isArrayOrTypedArray,l.isArray1D=i.isArray1D,l.ensureArray=i.ensureArray,l.concat=i.concat,l.maxRowLength=i.maxRowLength,l.minRowLength=i.minRowLength;var c=r("./mod");l.mod=c.mod,l.modHalf=c.modHalf;var n=r("./coerce");l.valObjectMeta=n.valObjectMeta,l.coerce=n.coerce,l.coerce2=n.coerce2,l.coerceFont=n.coerceFont,l.coercePattern=n.coercePattern,l.coerceHoverinfo=n.coerceHoverinfo,l.coerceSelectionMarkerOpacity=n.coerceSelectionMarkerOpacity,l.validate=n.validate;var a=r("./dates");l.dateTime2ms=a.dateTime2ms,l.isDateTime=a.isDateTime,l.ms2DateTime=a.ms2DateTime,l.ms2DateTimeLocal=a.ms2DateTimeLocal,l.cleanDate=a.cleanDate,l.isJSDate=a.isJSDate,l.formatDate=a.formatDate,l.incrementMonth=a.incrementMonth,l.dateTick0=a.dateTick0,l.dfltRange=a.dfltRange,l.findExactDates=a.findExactDates,l.MIN_MS=a.MIN_MS,l.MAX_MS=a.MAX_MS;var g=r("./search");l.findBin=g.findBin,l.sorterAsc=g.sorterAsc,l.sorterDes=g.sorterDes,l.distinctVals=g.distinctVals,l.roundUp=g.roundUp,l.sort=g.sort,l.findIndexOfMin=g.findIndexOfMin,l.sortObjectKeys=r("./sort_object_keys");var h=r("./stats");l.aggNums=h.aggNums,l.len=h.len,l.mean=h.mean,l.median=h.median,l.midRange=h.midRange,l.variance=h.variance,l.stdev=h.stdev,l.interp=h.interp;var y=r("./matrix");l.init2dArray=y.init2dArray,l.transposeRagged=y.transposeRagged,l.dot=y.dot,l.translationMatrix=y.translationMatrix,l.rotationMatrix=y.rotationMatrix,l.rotationXYMatrix=y.rotationXYMatrix,l.apply3DTransform=y.apply3DTransform,l.apply2DTransform=y.apply2DTransform,l.apply2DTransform2=y.apply2DTransform2,l.convertCssMatrix=y.convertCssMatrix,l.inverseTransformMatrix=y.inverseTransformMatrix;var v=r("./angles");l.deg2rad=v.deg2rad,l.rad2deg=v.rad2deg,l.angleDelta=v.angleDelta,l.angleDist=v.angleDist,l.isFullCircle=v.isFullCircle,l.isAngleInsideSector=v.isAngleInsideSector,l.isPtInsideSector=v.isPtInsideSector,l.pathArc=v.pathArc,l.pathSector=v.pathSector,l.pathAnnulus=v.pathAnnulus;var _=r("./anchor_utils");l.isLeftAnchor=_.isLeftAnchor,l.isCenterAnchor=_.isCenterAnchor,l.isRightAnchor=_.isRightAnchor,l.isTopAnchor=_.isTopAnchor,l.isMiddleAnchor=_.isMiddleAnchor,l.isBottomAnchor=_.isBottomAnchor;var x=r("./geometry2d");l.segmentsIntersect=x.segmentsIntersect,l.segmentDistance=x.segmentDistance,l.getTextLocation=x.getTextLocation,l.clearLocationCache=x.clearLocationCache,l.getVisibleSegment=x.getVisibleSegment,l.findPointOnPath=x.findPointOnPath;var T=r("./extend");l.extendFlat=T.extendFlat,l.extendDeep=T.extendDeep,l.extendDeepAll=T.extendDeepAll,l.extendDeepNoArrays=T.extendDeepNoArrays;var A=r("./loggers");l.log=A.log,l.warn=A.warn,l.error=A.error;var S=r("./regex");l.counterRegex=S.counter;var w=r("./throttle");l.throttle=w.throttle,l.throttleDone=w.done,l.clearThrottle=w.clear;var C=r("./dom");function k(z){var j={};for(var W in z)for(var ee=z[W],J=0;J<ee.length;J++)j[ee[J]]=+W;return j}l.getGraphDiv=C.getGraphDiv,l.isPlotDiv=C.isPlotDiv,l.removeElement=C.removeElement,l.addStyleRule=C.addStyleRule,l.addRelatedStyleRule=C.addRelatedStyleRule,l.deleteRelatedStyleRule=C.deleteRelatedStyleRule,l.getFullTransformMatrix=C.getFullTransformMatrix,l.getElementTransformMatrix=C.getElementTransformMatrix,l.getElementAndAncestors=C.getElementAndAncestors,l.equalDomRects=C.equalDomRects,l.clearResponsive=r("./clear_responsive"),l.preserveDrawingBuffer=r("./preserve_drawing_buffer"),l.makeTraceGroups=r("./make_trace_groups"),l._=r("./localize"),l.notifier=r("./notifier"),l.filterUnique=r("./filter_unique"),l.filterVisible=r("./filter_visible"),l.pushUnique=r("./push_unique"),l.increment=r("./increment"),l.cleanNumber=r("./clean_number"),l.ensureNumber=function(z){return p(z)?(z=Number(z))>f||z<u?s:z:s},l.isIndex=function(z,j){return!(j!==void 0&&z>=j)&&p(z)&&z>=0&&z%1==0},l.noop=r("./noop"),l.identity=r("./identity"),l.repeat=function(z,j){for(var W=new Array(j),ee=0;ee<j;ee++)W[ee]=z;return W},l.swapAttrs=function(z,j,W,ee){W||(W="x"),ee||(ee="y");for(var J=0;J<j.length;J++){var Q=j[J],te=l.nestedProperty(z,Q.replace("?",W)),ie=l.nestedProperty(z,Q.replace("?",ee)),ae=te.get();te.set(ie.get()),ie.set(ae)}},l.raiseToTop=function(z){z.parentNode.appendChild(z)},l.cancelTransition=function(z){return z.transition().duration(0)},l.constrain=function(z,j,W){return j>W?Math.max(W,Math.min(j,z)):Math.max(j,Math.min(W,z))},l.bBoxIntersect=function(z,j,W){return W=W||0,z.left<=j.right+W&&j.left<=z.right+W&&z.top<=j.bottom+W&&j.top<=z.bottom+W},l.simpleMap=function(z,j,W,ee,J){for(var Q=z.length,te=new Array(Q),ie=0;ie<Q;ie++)te[ie]=j(z[ie],W,ee,J);return te},l.randstr=function z(j,W,ee,J){if(ee||(ee=16),W===void 0&&(W=24),W<=0)return"0";var Q,te,ie=Math.log(Math.pow(2,W))/Math.log(ee),ae="";for(Q=2;ie===1/0;Q*=2)ie=Math.log(Math.pow(2,W/Q))/Math.log(ee)*Q;var he=ie-Math.floor(ie);for(Q=0;Q<Math.floor(ie);Q++)ae=Math.floor(Math.random()*ee).toString(ee)+ae;he&&(te=Math.pow(ee,he),ae=Math.floor(Math.random()*te).toString(ee)+ae);var se=parseInt(ae,ee);return j&&j[ae]||se!==1/0&&se>=Math.pow(2,W)?J>10?(l.warn("randstr failed uniqueness"),ae):z(j,W,ee,(J||0)+1):ae},l.OptionControl=function(z,j){z||(z={}),j||(j="opt");var W={optionList:[],_newoption:function(ee){ee[j]=z,W[ee.name]=ee,W.optionList.push(ee)}};return W["_"+j]=z,W},l.smooth=function(z,j){if((j=Math.round(j)||0)<2)return z;var W,ee,J,Q,te=z.length,ie=2*te,ae=2*j-1,he=new Array(ae),se=new Array(te);for(W=0;W<ae;W++)he[W]=(1-Math.cos(Math.PI*(W+1)/j))/(2*j);for(W=0;W<te;W++){for(Q=0,ee=0;ee<ae;ee++)(J=W+ee+1-j)<-te?J-=ie*Math.round(J/ie):J>=ie&&(J-=ie*Math.floor(J/ie)),J<0?J=-1-J:J>=te&&(J=ie-1-J),Q+=z[J]*he[ee];se[W]=Q}return se},l.syncOrAsync=function(z,j,W){var ee;function J(){return l.syncOrAsync(z,j,W)}for(;z.length;)if((ee=(0,z.splice(0,1)[0])(j))&&ee.then)return ee.then(J);return W&&W(j)},l.stripTrailingSlash=function(z){return z.substr(-1)==="/"?z.substr(0,z.length-1):z},l.noneOrAll=function(z,j,W){if(z){var ee,J=!1,Q=!0;for(ee=0;ee<W.length;ee++)z[W[ee]]!=null?J=!0:Q=!1;if(J&&!Q)for(ee=0;ee<W.length;ee++)z[W[ee]]=j[W[ee]]}},l.mergeArray=function(z,j,W,ee){var J=typeof ee=="function";if(l.isArrayOrTypedArray(z))for(var Q=Math.min(z.length,j.length),te=0;te<Q;te++){var ie=z[te];j[te][W]=J?ee(ie):ie}},l.mergeArrayCastPositive=function(z,j,W){return l.mergeArray(z,j,W,function(ee){var J=+ee;return isFinite(J)&&J>0?J:0})},l.fillArray=function(z,j,W,ee){if(ee=ee||l.identity,l.isArrayOrTypedArray(z))for(var J=0;J<j.length;J++)j[J][W]=ee(z[J])},l.castOption=function(z,j,W,ee){ee=ee||l.identity;var J=l.nestedProperty(z,W).get();return l.isArrayOrTypedArray(J)?Array.isArray(j)&&l.isArrayOrTypedArray(J[j[0]])?ee(J[j[0]][j[1]]):ee(J[j]):J},l.extractOption=function(z,j,W,ee){if(W in z)return z[W];var J=l.nestedProperty(j,ee).get();return Array.isArray(J)?void 0:J},l.tagSelected=function(z,j,W){var ee,J,Q=j.selectedpoints,te=j._indexToPoints;te&&(ee=k(te));for(var ie=0;ie<Q.length;ie++){var ae=Q[ie];if(l.isIndex(ae)||l.isArrayOrTypedArray(ae)&&l.isIndex(ae[0])&&l.isIndex(ae[1])){var he=ee?ee[ae]:ae,se=W?W[he]:he;(J=se)!==void 0&&J<z.length&&(z[se].selected=1)}}},l.selIndices2selPoints=function(z){var j=z.selectedpoints,W=z._indexToPoints;if(W){for(var ee=k(W),J=[],Q=0;Q<j.length;Q++){var te=j[Q];if(l.isIndex(te)){var ie=ee[te];l.isIndex(ie)&&J.push(ie)}}return J}return j},l.getTargetArray=function(z,j){var W=j.target;if(typeof W=="string"&&W){var ee=l.nestedProperty(z,W).get();return!!Array.isArray(ee)&&ee}return!!Array.isArray(W)&&W},l.minExtend=function(z,j){var W={};typeof j!="object"&&(j={});var ee,J,Q,te=Object.keys(z);for(ee=0;ee<te.length;ee++)Q=z[J=te[ee]],J.charAt(0)!=="_"&&typeof Q!="function"&&(J==="module"?W[J]=Q:Array.isArray(Q)?W[J]=J==="colorscale"?Q.slice():Q.slice(0,3):l.isTypedArray(Q)?W[J]=Q.subarray(0,3):W[J]=Q&&typeof Q=="object"?l.minExtend(z[J],j[J]):Q);for(te=Object.keys(j),ee=0;ee<te.length;ee++)typeof(Q=j[J=te[ee]])=="object"&&J in W&&typeof W[J]=="object"||(W[J]=Q);return W},l.titleCase=function(z){return z.charAt(0).toUpperCase()+z.substr(1)},l.containsAny=function(z,j){for(var W=0;W<j.length;W++)if(z.indexOf(j[W])!==-1)return!0;return!1},l.isIE=function(){return window.navigator.msSaveBlob!==void 0};var L=/Version\/[\d\.]+.*Safari/;l.isSafari=function(){return L.test(window.navigator.userAgent)};var M=/iPad|iPhone|iPod/;l.isIOS=function(){return M.test(window.navigator.userAgent)};var P=/Firefox\/(\d+)\.\d+/;l.getFirefoxVersion=function(){var z=P.exec(window.navigator.userAgent);if(z&&z.length===2){var j=parseInt(z[1]);if(!isNaN(j))return j}return null},l.isD3Selection=function(z){return z instanceof t.selection},l.ensureSingle=function(z,j,W,ee){var J=z.select(j+(W?"."+W:""));if(J.size())return J;var Q=z.append(j);return W&&Q.classed(W,!0),ee&&Q.call(ee),Q},l.ensureSingleById=function(z,j,W,ee){var J=z.select(j+"#"+W);if(J.size())return J;var Q=z.append(j).attr("id",W);return ee&&Q.call(ee),Q},l.objectFromPath=function(z,j){for(var W,ee=z.split("."),J=W={},Q=0;Q<ee.length;Q++){var te=ee[Q],ie=null,ae=ee[Q].match(/(.*)\[([0-9]+)\]/);ae?(te=ae[1],ie=ae[2],W=W[te]=[],Q===ee.length-1?W[ie]=j:W[ie]={},W=W[ie]):(Q===ee.length-1?W[te]=j:W[te]={},W=W[te])}return J};var D=/^([^\[\.]+)\.(.+)?/,N=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;l.expandObjectPaths=function(z){var j,W,ee,J,Q,te,ie;if(typeof z=="object"&&!Array.isArray(z))for(W in z)z.hasOwnProperty(W)&&((j=W.match(D))?(J=z[W],ee=j[1],delete z[W],z[ee]=l.extendDeepNoArrays(z[ee]||{},l.objectFromPath(W,l.expandObjectPaths(J))[ee])):(j=W.match(N))?(J=z[W],ee=j[1],Q=parseInt(j[2]),delete z[W],z[ee]=z[ee]||[],j[3]==="."?(ie=j[4],te=z[ee][Q]=z[ee][Q]||{},l.extendDeepNoArrays(te,l.objectFromPath(ie,l.expandObjectPaths(J)))):z[ee][Q]=l.expandObjectPaths(J)):z[W]=l.expandObjectPaths(z[W]));return z},l.numSeparate=function(z,j,W){if(W||(W=!1),typeof j!="string"||j.length===0)throw new Error("Separator string required for formatting!");typeof z=="number"&&(z=String(z));var ee=/(\d+)(\d{3})/,J=j.charAt(0),Q=j.charAt(1),te=z.split("."),ie=te[0],ae=te.length>1?J+te[1]:"";if(Q&&(te.length>1||ie.length>4||W))for(;ee.test(ie);)ie=ie.replace(ee,"$1"+Q+"$2");return ie+ae},l.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var U=/^\w*$/;l.templateString=function(z,j){var W={};return z.replace(l.TEMPLATE_STRING_REGEX,function(ee,J){var Q;return U.test(J)?Q=j[J]:(W[J]=W[J]||l.nestedProperty(j,J).get,Q=W[J]()),l.isValidTextValue(Q)?Q:""})};var q={max:10,count:0,name:"hovertemplate"};l.hovertemplateString=function(){return Z.apply(q,arguments)};var X={max:10,count:0,name:"texttemplate"};l.texttemplateString=function(){return Z.apply(X,arguments)};var K=/^[:|\|]/;function Z(z,j,W){var ee=this,J=arguments;j||(j={});var Q={};return z.replace(l.TEMPLATE_STRING_REGEX,function(te,ie,ae){var he,se,de,ue=ie==="_xother"||ie==="_yother",ve=ie==="_xother_"||ie==="_yother_",ke=ie==="xother_"||ie==="yother_",Ee=ie==="xother"||ie==="yother"||ue||ke||ve,be=ie;if((ue||ve)&&(be=be.substring(1)),(ke||ve)&&(be=be.substring(0,be.length-1)),Ee){if((he=j[be])===void 0)return""}else for(de=3;de<J.length;de++)if(se=J[de]){if(se.hasOwnProperty(be)){he=se[be];break}if(U.test(be)||(he=l.nestedProperty(se,be).get(),(he=Q[be]||l.nestedProperty(se,be).get())&&(Q[be]=he)),he!==void 0)break}if(he===void 0&&ee)return ee.count<ee.max&&(l.warn("Variable '"+be+"' in "+ee.name+" could not be found!"),he=te),ee.count===ee.max&&l.warn("Too many "+ee.name+" warnings - additional warnings will be suppressed"),ee.count++,te;if(ae){var xe;if(ae[0]===":"&&(he=(xe=W?W.numberFormat:l.numberFormat)(ae.replace(K,""))(he)),ae[0]==="|"){xe=W?W.timeFormat:d;var ce=l.dateTime2ms(he);he=l.formatDate(ce,ae.replace(K,""),!1,xe)}}else{var ge=be+"Label";j.hasOwnProperty(ge)&&(he=j[ge])}return Ee&&(he="("+he+")",(ue||ve)&&(he=" "+he),(ke||ve)&&(he+=" ")),he})}l.subplotSort=function(z,j){for(var W=Math.min(z.length,j.length)+1,ee=0,J=0,Q=0;Q<W;Q++){var te=z.charCodeAt(Q)||0,ie=j.charCodeAt(Q)||0,ae=te>=48&&te<=57,he=ie>=48&&ie<=57;if(ae&&(ee=10*ee+te-48),he&&(J=10*J+ie-48),!ae||!he){if(ee!==J)return ee-J;if(te!==ie)return te-ie}}return J-ee};var H=2e9;l.seedPseudoRandom=function(){H=2e9},l.pseudoRandom=function(){var z=H;return H=(69069*H+1)%4294967296,Math.abs(H-z)<429496729?l.pseudoRandom():H/4294967296},l.fillText=function(z,j,W){var ee=Array.isArray(W)?function(te){W.push(te)}:function(te){W.text=te},J=l.extractOption(z,j,"htx","hovertext");if(l.isValidTextValue(J))return ee(J);var Q=l.extractOption(z,j,"tx","text");return l.isValidTextValue(Q)?ee(Q):void 0},l.isValidTextValue=function(z){return z||z===0},l.formatPercent=function(z,j){j=j||0;for(var W=(Math.round(100*z*Math.pow(10,j))*Math.pow(.1,j)).toFixed(j)+"%",ee=0;ee<j;ee++)W.indexOf(".")!==-1&&(W=(W=W.replace("0%","%")).replace(".%","%"));return W},l.isHidden=function(z){var j=window.getComputedStyle(z).display;return!j||j==="none"},l.strTranslate=function(z,j){return z||j?"translate("+z+","+j+")":""},l.strRotate=function(z){return z?"rotate("+z+")":""},l.strScale=function(z){return z!==1?"scale("+z+")":""},l.getTextTransform=function(z){var j=z.noCenter,W=z.textX,ee=z.textY,J=z.targetX,Q=z.targetY,te=z.anchorX||0,ie=z.anchorY||0,ae=z.rotate,he=z.scale;return he?he>1&&(he=1):he=0,l.strTranslate(J-he*(W+te),Q-he*(ee+ie))+l.strScale(he)+(ae?"rotate("+ae+(j?"":" "+W+" "+ee)+")":"")},l.ensureUniformFontSize=function(z,j){var W=l.extendFlat({},j);return W.size=Math.max(j.size,z._fullLayout.uniformtext.minsize||0),W},l.join2=function(z,j,W){var ee=z.length;return ee>1?z.slice(0,-1).join(j)+W+z[ee-1]:z.join(j)},l.bigFont=function(z){return Math.round(1.2*z)};var Y=l.getFirefoxVersion(),$=Y!==null&&Y<86;l.getPositionFromD3Event=function(){return $?[t.event.layerX,t.event.layerY]:[t.event.offsetX,t.event.offsetY]}},{"../constants/numerical":763,"./anchor_utils":767,"./angles":768,"./array":769,"./clean_number":770,"./clear_responsive":772,"./coerce":773,"./dates":774,"./dom":775,"./extend":777,"./filter_unique":778,"./filter_visible":779,"./geometry2d":782,"./identity":785,"./increment":786,"./is_plain_object":788,"./keyed_container":789,"./localize":790,"./loggers":791,"./make_trace_groups":792,"./matrix":793,"./mod":794,"./nested_property":795,"./noop":796,"./notifier":797,"./preserve_drawing_buffer":801,"./push_unique":802,"./regex":804,"./relative_attr":805,"./relink_private":806,"./search":807,"./sort_object_keys":810,"./stats":811,"./throttle":814,"./to_log_range":815,"@plotly/d3":58,"d3-format":164,"d3-time-format":172,"fast-isnumeric":246}],788:[function(r,O,B){O.exports=function(t){return window&&window.process&&window.process.versions?Object.prototype.toString.call(t)==="[object Object]":Object.prototype.toString.call(t)==="[object Object]"&&Object.getPrototypeOf(t).hasOwnProperty("hasOwnProperty")}},{}],789:[function(r,O,B){var t=r("./nested_property"),d=/^\w*$/;O.exports=function(m,p,e,f){var u,s,l;e=e||"name",f=f||"value";var o={};p&&p.length?(l=t(m,p),s=l.get()):s=m,p=p||"";var i={};if(s)for(u=0;u<s.length;u++)i[s[u][e]]=u;var c=d.test(f),n={set:function(a,g){var h=g===null?4:0;if(!s){if(!l||h===4)return;s=[],l.set(s)}var y=i[a];if(y===void 0){if(h===4)return;h|=3,y=s.length,i[a]=y}else g!==(c?s[y][f]:t(s[y],f).get())&&(h|=2);var v=s[y]=s[y]||{};return v[e]=a,c?v[f]=g:t(v,f).set(g),g!==null&&(h&=-5),o[y]=o[y]|h,n},get:function(a){if(s){var g=i[a];return g===void 0?void 0:c?s[g][f]:t(s[g],f).get()}},rename:function(a,g){var h=i[a];return h===void 0||(o[h]=1|o[h],i[g]=h,delete i[a],s[h][e]=g),n},remove:function(a){var g=i[a];if(g===void 0)return n;var h=s[g];if(Object.keys(h).length>2)return o[g]=2|o[g],n.set(a,null);if(c){for(u=g;u<s.length;u++)o[u]=3|o[u];for(u=g;u<s.length;u++)i[s[u][e]]--;s.splice(g,1),delete i[a]}else t(h,f).set(null),o[g]=6|o[g];return n},constructUpdate:function(){for(var a,g,h={},y=Object.keys(o),v=0;v<y.length;v++)g=y[v],a=p+"["+g+"]",s[g]?(1&o[g]&&(h[a+"."+e]=s[g][e]),2&o[g]&&(h[a+"."+f]=c?4&o[g]?null:s[g][f]:4&o[g]?null:t(s[g],f).get())):h[a]=null;return h}};return n}},{"./nested_property":795}],790:[function(r,O,B){var t=r("../registry");O.exports=function(d,m){for(var p=d._context.locale,e=0;e<2;e++){for(var f=d._context.locales,u=0;u<2;u++){var s=(f[p]||{}).dictionary;if(s){var l=s[m];if(l)return l}f=t.localeRegistry}var o=p.split("-")[0];if(o===p)break;p=o}return m}},{"../registry":915}],791:[function(r,O,B){var t=r("../plot_api/plot_config").dfltConfig,d=r("./notifier"),m=O.exports={};m.log=function(){var p;if(t.logging>1){var e=["LOG:"];for(p=0;p<arguments.length;p++)e.push(arguments[p]);console.trace.apply(console,e)}if(t.notifyOnLogging>1){var f=[];for(p=0;p<arguments.length;p++)f.push(arguments[p]);d(f.join("<br>"),"long")}},m.warn=function(){var p;if(t.logging>0){var e=["WARN:"];for(p=0;p<arguments.length;p++)e.push(arguments[p]);console.trace.apply(console,e)}if(t.notifyOnLogging>0){var f=[];for(p=0;p<arguments.length;p++)f.push(arguments[p]);d(f.join("<br>"),"stick")}},m.error=function(){var p;if(t.logging>0){var e=["ERROR:"];for(p=0;p<arguments.length;p++)e.push(arguments[p]);console.error.apply(console,e)}if(t.notifyOnLogging>0){var f=[];for(p=0;p<arguments.length;p++)f.push(arguments[p]);d(f.join("<br>"),"stick")}}},{"../plot_api/plot_config":825,"./notifier":797}],792:[function(r,O,B){var t=r("@plotly/d3");O.exports=function(d,m,p){var e=d.selectAll("g."+p.replace(/\s/g,".")).data(m,function(u){return u[0].trace.uid});e.exit().remove(),e.enter().append("g").attr("class",p),e.order();var f=d.classed("rangeplot")?"nodeRangePlot3":"node3";return e.each(function(u){u[0][f]=t.select(this)}),e}},{"@plotly/d3":58}],793:[function(r,O,B){var t=r("gl-mat4");B.init2dArray=function(d,m){for(var p=new Array(d),e=0;e<d;e++)p[e]=new Array(m);return p},B.transposeRagged=function(d){var m,p,e=0,f=d.length;for(m=0;m<f;m++)e=Math.max(e,d[m].length);var u=new Array(e);for(m=0;m<e;m++)for(u[m]=new Array(f),p=0;p<f;p++)u[m][p]=d[p][m];return u},B.dot=function(d,m){if(!d.length||!m.length||d.length!==m.length)return null;var p,e,f=d.length;if(d[0].length)for(p=new Array(f),e=0;e<f;e++)p[e]=B.dot(d[e],m);else if(m[0].length){var u=B.transposeRagged(m);for(p=new Array(u.length),e=0;e<u.length;e++)p[e]=B.dot(d,u[e])}else for(p=0,e=0;e<f;e++)p+=d[e]*m[e];return p},B.translationMatrix=function(d,m){return[[1,0,d],[0,1,m],[0,0,1]]},B.rotationMatrix=function(d){var m=d*Math.PI/180;return[[Math.cos(m),-Math.sin(m),0],[Math.sin(m),Math.cos(m),0],[0,0,1]]},B.rotationXYMatrix=function(d,m,p){return B.dot(B.dot(B.translationMatrix(m,p),B.rotationMatrix(d)),B.translationMatrix(-m,-p))},B.apply3DTransform=function(d){return function(){var m=arguments,p=arguments.length===1?m[0]:[m[0],m[1],m[2]||0];return B.dot(d,[p[0],p[1],p[2],1]).slice(0,3)}},B.apply2DTransform=function(d){return function(){var m=arguments;m.length===3&&(m=m[0]);var p=arguments.length===1?m[0]:[m[0],m[1]];return B.dot(d,[p[0],p[1],1]).slice(0,2)}},B.apply2DTransform2=function(d){var m=B.apply2DTransform(d);return function(p){return m(p.slice(0,2)).concat(m(p.slice(2,4)))}},B.convertCssMatrix=function(d){if(d){var m=d.length;if(m===16)return d;if(m===6)return[d[0],d[1],0,0,d[2],d[3],0,0,0,0,1,0,d[4],d[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},B.inverseTransformMatrix=function(d){var m=[];return t.invert(m,d),[[m[0],m[1],m[2],m[3]],[m[4],m[5],m[6],m[7]],[m[8],m[9],m[10],m[11]],[m[12],m[13],m[14],m[15]]]}},{"gl-mat4":292}],794:[function(r,O,B){O.exports={mod:function(t,d){var m=t%d;return m<0?m+d:m},modHalf:function(t,d){return Math.abs(t)>d/2?t-Math.round(t/d)*d:t}}},{}],795:[function(r,O,B){var t=r("fast-isnumeric"),d=r("./array").isArrayOrTypedArray;function m(o,i){return function(){var c,n,a,g,h,y=o;for(g=0;g<i.length-1;g++){if((c=i[g])===-1){for(n=!0,a=[],h=0;h<y.length;h++)a[h]=m(y[h],i.slice(g+1))(),a[h]!==a[0]&&(n=!1);return n?a[0]:a}if(typeof c=="number"&&!d(y)||typeof(y=y[c])!="object"||y===null)return}if(typeof y=="object"&&y!==null&&(a=y[i[g]])!==null)return a}}O.exports=function(o,i){if(t(i))i=String(i);else if(typeof i!="string"||i.substr(i.length-4)==="[-1]")throw"bad property string";for(var c,n,a,g=0,h=i.split(".");g<h.length;){if(c=String(h[g]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/)){if(c[1])h[g]=c[1];else{if(g!==0)throw"bad property string";h.splice(0,1)}for(n=c[2].substr(1,c[2].length-2).split("]["),a=0;a<n.length;a++)g++,h.splice(g,0,Number(n[a]))}g++}return typeof o!="object"?function(y,v,_){return{set:function(){throw"bad container"},get:function(){},astr:v,parts:_,obj:y}}(o,i,h):{set:f(o,h,i),get:m(o,h),astr:i,parts:h,obj:o}};var p=/(^|\.)args\[/;function e(o,i){return o===void 0||o===null&&!i.match(p)}function f(o,i,c){return function(n){var a,g,h=o,y="",v=e(n,c);for(g=0;g<i.length-1;g++){if(typeof(a=i[g])=="number"&&!d(h))throw"array index but container is not an array";if(a===-1){if(v=!s(h,i.slice(g+1),n,c))break;return}if(!l(h,a,i[g+1],v))break;if(typeof(h=h[a])!="object"||h===null)throw"container is not an object";y=u(y,a)}if(v){if(g===i.length-1&&(delete h[i[g]],Array.isArray(h)&&+i[g]==h.length-1))for(;h.length&&h[h.length-1]===void 0;)h.pop()}else h[i[g]]=n}}function u(o,i){var c=i;return t(i)?c="["+i+"]":o&&(c="."+i),o+c}function s(o,i,c,n){var a,g=d(c),h=!0,y=c,v=n.replace("-1",0),_=!g&&e(c,v),x=i[0];for(a=0;a<o.length;a++)v=n.replace("-1",a),g&&(_=e(y=c[a%c.length],v)),_&&(h=!1),l(o,a,x,_)&&f(o[a],i,n.replace("-1",a))(y);return h}function l(o,i,c,n){if(o[i]===void 0){if(n)return!1;o[i]=typeof c=="number"?[]:{}}return!0}},{"./array":769,"fast-isnumeric":246}],796:[function(r,O,B){O.exports=function(){}},{}],797:[function(r,O,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=[];O.exports=function(p,e){if(m.indexOf(p)===-1){m.push(p);var f=1e3;d(e)?f=e:e==="long"&&(f=3e3);var u=t.select("body").selectAll(".plotly-notifier").data([0]);u.enter().append("div").classed("plotly-notifier",!0),u.selectAll(".notifier-note").data(m).enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(l){var o=t.select(this);o.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){o.transition().call(s)});for(var i=o.append("p"),c=l.split(/<br\s*\/?>/g),n=0;n<c.length;n++)n&&i.append("br"),i.append("span").text(c[n]);e==="stick"?o.transition().duration(350).style("opacity",1):o.transition().duration(700).style("opacity",1).transition().delay(f).call(s)})}function s(l){l.duration(700).style("opacity",0).each("end",function(o){var i=m.indexOf(o);i!==-1&&m.splice(i,1),t.select(this).remove()})}}},{"@plotly/d3":58,"fast-isnumeric":246}],798:[function(r,O,B){var t=r("./setcursor"),d="data-savedcursor";O.exports=function(m,p){var e=m.attr(d);if(p){if(!e){for(var f=(m.attr("class")||"").split(" "),u=0;u<f.length;u++){var s=f[u];s.indexOf("cursor-")===0&&m.attr(d,s.substr(7)).classed(s,!1)}m.attr(d)||m.attr(d,"!!")}t(m,p)}else e&&(m.attr(d,null),e==="!!"?t(m):t(m,e))}},{"./setcursor":808}],799:[function(r,O,B){var t=r("./matrix").dot,d=r("../constants/numerical").BADNUM,m=O.exports={};m.tester=function(p){var e,f=p.slice(),u=f[0][0],s=u,l=f[0][1],o=l;for(f.push(f[0]),e=1;e<f.length;e++)u=Math.min(u,f[e][0]),s=Math.max(s,f[e][0]),l=Math.min(l,f[e][1]),o=Math.max(o,f[e][1]);var i,c=!1;f.length===5&&(f[0][0]===f[1][0]?f[2][0]===f[3][0]&&f[0][1]===f[3][1]&&f[1][1]===f[2][1]&&(c=!0,i=function(g){return g[0]===f[0][0]}):f[0][1]===f[1][1]&&f[2][1]===f[3][1]&&f[0][0]===f[3][0]&&f[1][0]===f[2][0]&&(c=!0,i=function(g){return g[1]===f[0][1]}));var n=!0,a=f[0];for(e=1;e<f.length;e++)if(a[0]!==f[e][0]||a[1]!==f[e][1]){n=!1;break}return{xmin:u,xmax:s,ymin:l,ymax:o,pts:f,contains:c?function(g,h){var y=g[0],v=g[1];return!(y===d||y<u||y>s||v===d||v<l||v>o)&&(!h||!i(g))}:function(g,h){var y=g[0],v=g[1];if(y===d||y<u||y>s||v===d||v<l||v>o)return!1;var _,x,T,A,S,w=f.length,C=f[0][0],k=f[0][1],L=0;for(_=1;_<w;_++)if(x=C,T=k,C=f[_][0],k=f[_][1],!(y<(A=Math.min(x,C))||y>Math.max(x,C)||v>Math.max(T,k)))if(v<Math.min(T,k))y!==A&&L++;else{if(v===(S=C===x?v:T+(y-x)*(k-T)/(C-x)))return _!==1||!h;v<=S&&y!==A&&L++}return L%2==1},isRect:c,degenerate:n}},m.isSegmentBent=function(p,e,f,u){var s,l,o,i=p[e],c=[p[f][0]-i[0],p[f][1]-i[1]],n=t(c,c),a=Math.sqrt(n),g=[-c[1]/a,c[0]/a];for(s=e+1;s<f;s++)if(l=[p[s][0]-i[0],p[s][1]-i[1]],(o=t(l,c))<0||o>n||Math.abs(t(l,g))>u)return!0;return!1},m.filter=function(p,e){var f=[p[0]],u=0,s=0;function l(o){p.push(o);var i=f.length,c=u;f.splice(s+1);for(var n=c+1;n<p.length;n++)(n===p.length-1||m.isSegmentBent(p,c,n+1,e))&&(f.push(p[n]),f.length<i-2&&(u=n,s=f.length-1),c=n)}return p.length>1&&l(p.pop()),{addPt:l,raw:p,filtered:f}}},{"../constants/numerical":763,"./matrix":793}],800:[function(r,O,B){(function(t){(function(){var d=r("./show_no_webgl_msg"),m=r("regl");O.exports=function(p,e){var f=p._fullLayout,u=!0;return f._glcanvas.each(function(s){if(!s.regl&&(!s.pick||f._has("parcoords"))){try{s.regl=m({canvas:this,attributes:{antialias:!s.pick,preserveDrawingBuffer:!0},pixelRatio:p._context.plotGlPixelRatio||t.devicePixelRatio,extensions:e||[]})}catch(l){u=!1}s.regl||(u=!1),u&&this.addEventListener("webglcontextlost",function(l){p&&p.emit&&p.emit("plotly_webglcontextlost",{event:l,layer:s.key})},!1)}}),u||d({container:f._glcontainer.node()}),u}}).call(this)}).call(this,typeof Xi!="undefined"?Xi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./show_no_webgl_msg":809,regl:526}],801:[function(r,O,B){var t=r("fast-isnumeric"),d=r("is-mobile");O.exports=function(m){var p;if(typeof(p=m&&m.hasOwnProperty("userAgent")?m.userAgent:function(){var i;return typeof navigator!="undefined"&&(i=navigator.userAgent),i&&i.headers&&typeof i.headers["user-agent"]=="string"&&(i=i.headers["user-agent"]),i}())!="string")return!0;var e=d({ua:{headers:{"user-agent":p}},tablet:!0,featureDetect:!1});if(!e){for(var f=p.split(" "),u=1;u<f.length;u++)if(f[u].indexOf("Safari")!==-1)for(var s=u-1;s>-1;s--){var l=f[s];if(l.substr(0,8)==="Version/"){var o=l.substr(8).split(".")[0];if(t(o)&&(o=+o),o>=13)return!0}}}return e}},{"fast-isnumeric":246,"is-mobile":445}],802:[function(r,O,B){O.exports=function(t,d){if(d instanceof RegExp){for(var m=d.toString(),p=0;p<t.length;p++)if(t[p]instanceof RegExp&&t[p].toString()===m)return t;t.push(d)}else!d&&d!==0||t.indexOf(d)!==-1||t.push(d);return t}},{}],803:[function(r,O,B){var t=r("../lib"),d=r("../plot_api/plot_config").dfltConfig,m={add:function(p,e,f,u,s){var l,o;p.undoQueue=p.undoQueue||{index:0,queue:[],sequence:!1},o=p.undoQueue.index,p.autoplay?p.undoQueue.inSequence||(p.autoplay=!1):(!p.undoQueue.sequence||p.undoQueue.beginSequence?(l={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},p.undoQueue.queue.splice(o,p.undoQueue.queue.length-o,l),p.undoQueue.index+=1):l=p.undoQueue.queue[o-1],p.undoQueue.beginSequence=!1,l&&(l.undo.calls.unshift(e),l.undo.args.unshift(f),l.redo.calls.push(u),l.redo.args.push(s)),p.undoQueue.queue.length>d.queueLength&&(p.undoQueue.queue.shift(),p.undoQueue.index--))},startSequence:function(p){p.undoQueue=p.undoQueue||{index:0,queue:[],sequence:!1},p.undoQueue.sequence=!0,p.undoQueue.beginSequence=!0},stopSequence:function(p){p.undoQueue=p.undoQueue||{index:0,queue:[],sequence:!1},p.undoQueue.sequence=!1,p.undoQueue.beginSequence=!1},undo:function(p){var e,f;if(!(p.undoQueue===void 0||isNaN(p.undoQueue.index)||p.undoQueue.index<=0)){for(p.undoQueue.index--,e=p.undoQueue.queue[p.undoQueue.index],p.undoQueue.inSequence=!0,f=0;f<e.undo.calls.length;f++)m.plotDo(p,e.undo.calls[f],e.undo.args[f]);p.undoQueue.inSequence=!1,p.autoplay=!1}},redo:function(p){var e,f;if(!(p.undoQueue===void 0||isNaN(p.undoQueue.index)||p.undoQueue.index>=p.undoQueue.queue.length)){for(e=p.undoQueue.queue[p.undoQueue.index],p.undoQueue.inSequence=!0,f=0;f<e.redo.calls.length;f++)m.plotDo(p,e.redo.calls[f],e.redo.args[f]);p.undoQueue.inSequence=!1,p.autoplay=!1,p.undoQueue.index++}}};m.plotDo=function(p,e,f){p.autoplay=!0,f=function(u,s){for(var l,o=[],i=0;i<s.length;i++)l=s[i],o[i]=l===u?l:typeof l=="object"?Array.isArray(l)?t.extendDeep([],l):t.extendDeepAll({},l):l;return o}(p,f),e.apply(null,f)},O.exports=m},{"../lib":787,"../plot_api/plot_config":825}],804:[function(r,O,B){B.counter=function(t,d,m,p){var e=(d||"")+(m?"":"$"),f=p===!1?"":"^";return t==="xy"?new RegExp(f+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(f+t+"([2-9]|[1-9][0-9]+)?"+e)}},{}],805:[function(r,O,B){var t=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,d=/^[^\.\[\]]+$/;O.exports=function(m,p){for(;p;){var e=m.match(t);if(e)m=e[1];else{if(!m.match(d))throw new Error("bad relativeAttr call:"+[m,p]);m=""}if(p.charAt(0)!=="^")break;p=p.slice(1)}return m&&p.charAt(0)!=="["?m+"."+p:m+p}},{}],806:[function(r,O,B){var t=r("./array").isArrayOrTypedArray,d=r("./is_plain_object");O.exports=function m(p,e){for(var f in e){var u=e[f],s=p[f];if(s!==u)if(f.charAt(0)==="_"||typeof u=="function"){if(f in p)continue;p[f]=u}else if(t(u)&&t(s)&&d(u[0])){if(f==="customdata"||f==="ids")continue;for(var l=Math.min(u.length,s.length),o=0;o<l;o++)s[o]!==u[o]&&d(u[o])&&d(s[o])&&m(s[o],u[o])}else d(u)&&d(s)&&(m(s,u),Object.keys(s).length||delete p[f])}}},{"./array":769,"./is_plain_object":788}],807:[function(r,O,B){var t=r("fast-isnumeric"),d=r("./loggers"),m=r("./identity"),p=r("../constants/numerical").BADNUM;function e(l,o){return l<o}function f(l,o){return l<=o}function u(l,o){return l>o}function s(l,o){return l>=o}B.findBin=function(l,o,i){if(t(o.start))return i?Math.ceil((l-o.start)/o.size-1e-9)-1:Math.floor((l-o.start)/o.size+1e-9);var c,n,a=0,g=o.length,h=0,y=g>1?(o[g-1]-o[0])/(g-1):1;for(n=y>=0?i?e:f:i?s:u,l+=1e-9*y*(i?-1:1)*(y>=0?1:-1);a<g&&h++<100;)n(o[c=Math.floor((a+g)/2)],l)?a=c+1:g=c;return h>90&&d.log("Long binary search..."),a-1},B.sorterAsc=function(l,o){return l-o},B.sorterDes=function(l,o){return o-l},B.distinctVals=function(l){var o,i=l.slice();for(i.sort(B.sorterAsc),o=i.length-1;o>-1&&i[o]===p;o--);for(var c,n=i[o]-i[0]||1,a=n/(o||1)/1e4,g=[],h=0;h<=o;h++){var y=i[h],v=y-c;c===void 0?(g.push(y),c=y):v>a&&(n=Math.min(n,v),g.push(y),c=y)}return{vals:g,minDiff:n}},B.roundUp=function(l,o,i){for(var c,n=0,a=o.length-1,g=0,h=i?0:1,y=i?1:0,v=i?Math.ceil:Math.floor;n<a&&g++<100;)o[c=v((n+a)/2)]<=l?n=c+h:a=c-y;return o[n]},B.sort=function(l,o){for(var i=0,c=0,n=1;n<l.length;n++){var a=o(l[n],l[n-1]);if(a<0?i=1:a>0&&(c=1),i&&c)return l.sort(o)}return c?l:l.reverse()},B.findIndexOfMin=function(l,o){o=o||m;for(var i,c=1/0,n=0;n<l.length;n++){var a=o(l[n]);a<c&&(c=a,i=n)}return i}},{"../constants/numerical":763,"./identity":785,"./loggers":791,"fast-isnumeric":246}],808:[function(r,O,B){O.exports=function(t,d){(t.attr("class")||"").split(" ").forEach(function(m){m.indexOf("cursor-")===0&&t.classed(m,!1)}),d&&t.classed("cursor-"+d,!0)}},{}],809:[function(r,O,B){var t=r("../components/color"),d=function(){};O.exports=function(m){for(var p in m)typeof m[p]=="function"&&(m[p]=d);m.destroy=function(){m.container.parentNode.removeChild(m.container)};var e=document.createElement("div");e.className="no-webgl",e.style.cursor="pointer",e.style.fontSize="24px",e.style.color=t.defaults[0],e.style.position="absolute",e.style.left=e.style.top="0px",e.style.width=e.style.height="100%",e.style["background-color"]=t.lightLine,e.style["z-index"]=30;var f=document.createElement("p");return f.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",f.style.position="relative",f.style.top="50%",f.style.left="50%",f.style.height="30%",f.style.width="50%",f.style.margin="-15% 0 0 -25%",e.appendChild(f),m.container.appendChild(e),m.container.style.background="#FFFFFF",m.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":650}],810:[function(r,O,B){O.exports=function(t){return Object.keys(t).sort()}},{}],811:[function(r,O,B){var t=r("fast-isnumeric"),d=r("./array").isArrayOrTypedArray;B.aggNums=function(m,p,e,f){var u,s;if((!f||f>e.length)&&(f=e.length),t(p)||(p=!1),d(e[0])){for(s=new Array(f),u=0;u<f;u++)s[u]=B.aggNums(m,p,e[u]);e=s}for(u=0;u<f;u++)t(p)?t(e[u])&&(p=m(+p,+e[u])):p=e[u];return p},B.len=function(m){return B.aggNums(function(p){return p+1},0,m)},B.mean=function(m,p){return p||(p=B.len(m)),B.aggNums(function(e,f){return e+f},0,m)/p},B.midRange=function(m){if(m!==void 0&&m.length!==0)return(B.aggNums(Math.max,null,m)+B.aggNums(Math.min,null,m))/2},B.variance=function(m,p,e){return p||(p=B.len(m)),t(e)||(e=B.mean(m,p)),B.aggNums(function(f,u){return f+Math.pow(u-e,2)},0,m)/p},B.stdev=function(m,p,e){return Math.sqrt(B.variance(m,p,e))},B.median=function(m){var p=m.slice().sort();return B.interp(p,.5)},B.interp=function(m,p){if(!t(p))throw"n should be a finite number";if((p=p*m.length-.5)<0)return m[0];if(p>m.length-1)return m[m.length-1];var e=p%1;return e*m[Math.ceil(p)]+(1-e)*m[Math.floor(p)]}},{"./array":769,"fast-isnumeric":246}],812:[function(r,O,B){var t=r("color-normalize");O.exports=function(d){return d?t(d):[0,0,0,1]}},{"color-normalize":131}],813:[function(r,O,B){var t=r("@plotly/d3"),d=r("../lib"),m=d.strTranslate,p=r("../constants/xmlns_namespaces"),e=r("../constants/alignment").LINE_SPACING;function f(P,D){return P.node().getBoundingClientRect()[D]}var u=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;B.convertToTspans=function(P,D,N){var U=P.text(),q=!P.attr("data-notex")&&typeof MathJax!="undefined"&&U.match(u),X=t.select(P.node().parentNode);if(!X.empty()){var K=P.attr("class")?P.attr("class").split(" ")[0]:"text";return K+="-math",X.selectAll("svg."+K).remove(),X.selectAll("g."+K+"-group").remove(),P.style("display",null).attr({"data-unformatted":U,"data-math":"N"}),q?(D&&D._promises||[]).push(new Promise(function(H){P.style("display","none");var Y=parseInt(P.node().style.fontSize,10),$={fontSize:Y};(function(z,j,W){var ee,J,Q,te;MathJax.Hub.Queue(function(){return J=d.extendDeepAll({},MathJax.Hub.config),Q=MathJax.Hub.processSectionDelay,MathJax.Hub.processSectionDelay!==void 0&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]},displayAlign:"left"})},function(){if((ee=MathJax.Hub.config.menuSettings.renderer)!=="SVG")return MathJax.Hub.setRenderer("SVG")},function(){var ie="math-output-"+d.randstr({},64);return te=t.select("body").append("div").attr({id:ie}).style({visibility:"hidden",position:"absolute"}).style({"font-size":j.fontSize+"px"}).text(z.replace(s,"\\lt ").replace(l,"\\gt ")),MathJax.Hub.Typeset(te.node())},function(){var ie=t.select("body").select("#MathJax_SVG_glyphs");if(te.select(".MathJax_SVG").empty()||!te.select("svg").node())d.log("There was an error in the tex syntax.",z),W();else{var ae=te.select("svg").node().getBoundingClientRect();W(te.select(".MathJax_SVG"),ie,ae)}if(te.remove(),ee!=="SVG")return MathJax.Hub.setRenderer(ee)},function(){return Q!==void 0&&(MathJax.Hub.processSectionDelay=Q),MathJax.Hub.Config(J)})})(q[2],$,function(z,j,W){X.selectAll("svg."+K).remove(),X.selectAll("g."+K+"-group").remove();var ee=z&&z.select("svg");if(!ee||!ee.node())return Z(),void H();var J=X.append("g").classed(K+"-group",!0).attr({"pointer-events":"none","data-unformatted":U,"data-math":"Y"});J.node().appendChild(ee.node()),j&&j.node()&&ee.node().insertBefore(j.node().cloneNode(!0),ee.node().firstChild),ee.attr({class:K,height:W.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var Q=P.node().style.fill||"black",te=ee.select("g");te.attr({fill:Q,stroke:Q});var ie=f(te,"width"),ae=f(te,"height"),he=+P.attr("x")-ie*{start:0,middle:.5,end:1}[P.attr("text-anchor")||"start"],se=-(Y||f(P,"height"))/4;K[0]==="y"?(J.attr({transform:"rotate("+[-90,+P.attr("x"),+P.attr("y")]+")"+m(-ie/2,se-ae/2)}),ee.attr({x:+P.attr("x"),y:+P.attr("y")})):K[0]==="l"?ee.attr({x:P.attr("x"),y:se-ae/2}):K[0]==="a"&&K.indexOf("atitle")!==0?ee.attr({x:0,y:se}):ee.attr({x:he,y:+P.attr("y")+se-ae/2}),N&&N.call(P,J),H(J)})})):Z(),P}function Z(){X.empty()||(K=P.attr("class")+"-math",X.select("svg."+K).remove()),P.text("").style("white-space","pre"),function(H,Y){Y=Y.replace(a," ");var $,z=!1,j=[],W=-1;function ee(){W++;var ce=document.createElementNS(p.svg,"tspan");t.select(ce).attr({class:"line",dy:W*e+"em"}),H.appendChild(ce),$=ce;var ge=j;if(j=[{node:ce}],ge.length>1)for(var we=1;we<ge.length;we++)J(ge[we])}function J(ce){var ge,we=ce.type,Me={};if(we==="a"){ge="a";var Se=ce.target,ze=ce.href,Fe=ce.popup;ze&&(Me={"xlink:xlink:show":Se==="_blank"||Se.charAt(0)!=="_"?"new":"replace",target:Se,"xlink:xlink:href":ze},Fe&&(Me.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+Fe+'");return false;'))}else ge="tspan";ce.style&&(Me.style=ce.style);var Ye=document.createElementNS(p.svg,ge);if(we==="sup"||we==="sub"){Q($,"\u200B"),$.appendChild(Ye);var rt=document.createElementNS(p.svg,"tspan");Q(rt,"\u200B"),t.select(rt).attr("dy",c[we]),Me.dy=i[we],$.appendChild(Ye),$.appendChild(rt)}else $.appendChild(Ye);t.select(Ye).attr(Me),$=ce.node=Ye,j.push(ce)}function Q(ce,ge){ce.appendChild(document.createTextNode(ge))}function te(ce){if(j.length!==1){var ge=j.pop();ce!==ge.type&&d.log("Start tag <"+ge.type+"> doesnt match end tag <"+ce+">. Pretending it did match.",Y),$=j[j.length-1].node}else d.log("Ignoring unexpected end tag </"+ce+">.",Y)}y.test(Y)?ee():($=H,j=[{node:H}]);for(var ie=Y.split(g),ae=0;ae<ie.length;ae++){var he=ie[ae],se=he.match(h),de=se&&se[2].toLowerCase(),ue=o[de];if(de==="br")ee();else if(ue===void 0)Q($,k(he));else if(se[1])te(de);else{var ve=se[4],ke={type:de},Ee=A(ve,v);if(Ee?(Ee=Ee.replace(S,"$1 fill:"),ue&&(Ee+=";"+ue)):ue&&(Ee=ue),Ee&&(ke.style=Ee),de==="a"){z=!0;var be=A(ve,_);if(be){var xe=L(be);xe&&(ke.href=xe,ke.target=A(ve,x)||"_blank",ke.popup=A(ve,T))}}J(ke)}}return z}(P.node(),U)&&P.style("pointer-events","all"),B.positionText(P),N&&N.call(P)}};var s=/(<|&lt;|&#60;)/g,l=/(>|&gt;|&#62;)/g,o={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},i={sub:"0.3em",sup:"-0.6em"},c={sub:"-0.21em",sup:"0.42em"},n=["http:","https:","mailto:","",void 0,":"],a=B.NEWLINES=/(\r\n?|\n)/g,g=/(<[^<>]*>)/,h=/<(\/?)([^ >]*)(\s+(.*))?>/i,y=/<br(\s+.*)?>/i;B.BR_TAG_ALL=/<br(\s+.*)?>/gi;var v=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,_=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,x=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,T=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function A(P,D){if(!P)return null;var N=P.match(D),U=N&&(N[3]||N[4]);return U&&k(U)}var S=/(^|;)\s*color:/;B.plainText=function(P,D){for(var N=(D=D||{}).len!==void 0&&D.len!==-1?D.len:1/0,U=D.allowedTags!==void 0?D.allowedTags:["br"],q="...".length,X=P.split(g),K=[],Z="",H=0,Y=0;Y<X.length;Y++){var $=X[Y],z=$.match(h),j=z&&z[2].toLowerCase();if(j)U.indexOf(j)!==-1&&(K.push($),Z=j);else{var W=$.length;if(H+W<N)K.push($),H+=W;else if(H<N){var ee=N-H;Z&&(Z!=="br"||ee<=q||W<=q)&&K.pop(),N>q?K.push($.substr(0,ee-q)+"..."):K.push($.substr(0,ee));break}Z=""}}return K.join("")};var w={mu:"\u03BC",amp:"&",lt:"<",gt:">",nbsp:"\xA0",times:"\xD7",plusmn:"\xB1",deg:"\xB0"},C=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function k(P){return P.replace(C,function(D,N){return(N.charAt(0)==="#"?function(U){if(!(U>1114111)){var q=String.fromCodePoint;if(q)return q(U);var X=String.fromCharCode;return U<=65535?X(U):X(55232+(U>>10),U%1024+56320)}}(N.charAt(1)==="x"?parseInt(N.substr(2),16):parseInt(N.substr(1),10)):w[N])||D})}function L(P){var D=encodeURI(decodeURI(P)),N=document.createElement("a"),U=document.createElement("a");N.href=P,U.href=D;var q=N.protocol,X=U.protocol;return n.indexOf(q)!==-1&&n.indexOf(X)!==-1?D:""}function M(P,D,N){var U,q,X,K=N.horizontalAlign,Z=N.verticalAlign||"top",H=P.node().getBoundingClientRect(),Y=D.node().getBoundingClientRect();return q=Z==="bottom"?function(){return H.bottom-U.height}:Z==="middle"?function(){return H.top+(H.height-U.height)/2}:function(){return H.top},X=K==="right"?function(){return H.right-U.width}:K==="center"?function(){return H.left+(H.width-U.width)/2}:function(){return H.left},function(){U=this.node().getBoundingClientRect();var $=X()-Y.left,z=q()-Y.top,j=N.gd||{};if(N.gd){j._fullLayout._calcInverseTransform(j);var W=d.apply3DTransform(j._fullLayout._invTransform)($,z);$=W[0],z=W[1]}return this.style({top:z+"px",left:$+"px","z-index":1e3}),this}}B.convertEntities=k,B.sanitizeHTML=function(P){P=P.replace(a," ");for(var D=document.createElement("p"),N=D,U=[],q=P.split(g),X=0;X<q.length;X++){var K=q[X],Z=K.match(h),H=Z&&Z[2].toLowerCase();if(H in o)if(Z[1])U.length&&(N=U.pop());else{var Y=Z[4],$=A(Y,v),z=$?{style:$}:{};if(H==="a"){var j=A(Y,_);if(j){var W=L(j);if(W){z.href=W;var ee=A(Y,x);ee&&(z.target=ee)}}}var J=document.createElement(H);N.appendChild(J),t.select(J).attr(z),N=J,U.push(J)}else N.appendChild(document.createTextNode(k(K)))}return D.innerHTML},B.lineCount=function(P){return P.selectAll("tspan.line").size()||1},B.positionText=function(P,D,N){return P.each(function(){var U=t.select(this);function q(Z,H){return H===void 0?(H=U.attr(Z))===null&&(U.attr(Z,0),H=0):U.attr(Z,H),H}var X=q("x",D),K=q("y",N);this.nodeName==="text"&&U.selectAll("tspan.line").attr({x:X,y:K})})},B.makeTextShadow=function(P){var D="1px ",N="1px ",U="1px ";return D+N+U+P+", -"+D+"-"+N+U+P+", "+D+"-"+N+U+P+", -"+D+N+U+P},B.makeEditable=function(P,D){var N=D.gd,U=D.delegate,q=t.dispatch("edit","input","cancel"),X=U||P;if(P.style({"pointer-events":U?"none":"all"}),P.size()!==1)throw new Error("boo");function K(){(function(){var $=t.select(N).select(".svg-container"),z=$.append("div"),j=P.node().style,W=parseFloat(j.fontSize||12),ee=D.text;ee===void 0&&(ee=P.attr("data-unformatted")),z.classed("plugin-editable editable",!0).style({position:"absolute","font-family":j.fontFamily||"Arial","font-size":W,color:D.fill||j.fill||"black",opacity:1,"background-color":D.background||"transparent",outline:"#ffffff33 1px solid",margin:[-W/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(ee).call(M(P,$,D)).on("blur",function(){N._editing=!1,P.text(this.textContent).style({opacity:1});var J,Q=t.select(this).attr("class");(J=Q?"."+Q.split(" ")[0]+"-math-group":"[class*=-math-group]")&&t.select(P.node().parentNode).select(J).style({opacity:0});var te=this.textContent;t.select(this).transition().duration(0).remove(),t.select(document).on("mouseup",null),q.edit.call(P,te)}).on("focus",function(){var J=this;N._editing=!0,t.select(document).on("mouseup",function(){if(t.event.target===J)return!1;document.activeElement===z.node()&&z.node().blur()})}).on("keyup",function(){t.event.which===27?(N._editing=!1,P.style({opacity:1}),t.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),q.cancel.call(P,this.textContent)):(q.input.call(P,this.textContent),t.select(this).call(M(P,$,D)))}).on("keydown",function(){t.event.which===13&&this.blur()}).call(Z)})(),P.style({opacity:0});var H,Y=X.attr("class");(H=Y?"."+Y.split(" ")[0]+"-math-group":"[class*=-math-group]")&&t.select(P.node().parentNode).select(H).style({opacity:0})}function Z(H){var Y=H.node(),$=document.createRange();$.selectNodeContents(Y);var z=window.getSelection();z.removeAllRanges(),z.addRange($),Y.focus()}return D.immediate?K():X.on("click",K),t.rebind(P,q,"on")}},{"../constants/alignment":755,"../constants/xmlns_namespaces":764,"../lib":787,"@plotly/d3":58}],814:[function(r,O,B){var t={};function d(m){m&&m.timer!==null&&(clearTimeout(m.timer),m.timer=null)}B.throttle=function(m,p,e){var f=t[m],u=Date.now();if(!f){for(var s in t)t[s].ts<u-6e4&&delete t[s];f=t[m]={ts:0,timer:null}}function l(){e(),f.ts=Date.now(),f.onDone&&(f.onDone(),f.onDone=null)}d(f),u>f.ts+p?l():f.timer=setTimeout(function(){l(),f.timer=null},p)},B.done=function(m){var p=t[m];return p&&p.timer?new Promise(function(e){var f=p.onDone;p.onDone=function(){f&&f(),e(),p.onDone=null}}):Promise.resolve()},B.clear=function(m){if(m)d(t[m]),delete t[m];else for(var p in t)B.clear(p)}},{}],815:[function(r,O,B){var t=r("fast-isnumeric");O.exports=function(d,m){if(d>0)return Math.log(d)/Math.LN10;var p=Math.log(Math.min(m[0],m[1]))/Math.LN10;return t(p)||(p=Math.log(Math.max(m[0],m[1]))/Math.LN10-6),p}},{"fast-isnumeric":246}],816:[function(r,O,B){var t=O.exports={},d=r("../plots/geo/constants").locationmodeToLayer,m=r("topojson-client").feature;t.getTopojsonName=function(p){return[p.scope.replace(/ /g,"-"),"_",p.resolution.toString(),"m"].join("")},t.getTopojsonPath=function(p,e){return p+e+".json"},t.getTopojsonFeatures=function(p,e){var f=d[p.locationmode],u=e.objects[f];return m(e,u).features}},{"../plots/geo/constants":869,"topojson-client":586}],817:[function(r,O,B){O.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],818:[function(r,O,B){O.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],819:[function(r,O,B){var t=r("../registry");O.exports=function(d){for(var m,p,e=t.layoutArrayContainers,f=t.layoutArrayRegexes,u=d.split("[")[0],s=0;s<f.length;s++)if((p=d.match(f[s]))&&p.index===0){m=p[0];break}if(m||(m=e[e.indexOf(u)]),!m)return!1;var l=d.substr(m.length);return l?!!(p=l.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/))&&{array:m,index:Number(p[1]),property:p[3]||""}:{array:m,index:"",property:""}}},{"../registry":915}],820:[function(r,O,B){var t=r("../lib"),d=t.extendFlat,m=t.isPlainObject,p={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},f=p.flags.slice().concat(["fullReplot"]),u=e.flags.slice().concat("layoutReplot");function s(i){for(var c={},n=0;n<i.length;n++)c[i[n]]=!1;return c}function l(i,c,n){var a=d({},i);for(var g in a){var h=a[g];m(h)&&(a[g]=o(h,c,n,g))}return n==="from-root"&&(a.editType=c),a}function o(i,c,n,a){if(i.valType){var g=d({},i);if(g.editType=c,Array.isArray(i.items)){g.items=new Array(i.items.length);for(var h=0;h<i.items.length;h++)g.items[h]=o(i.items[h],c)}return g}return l(i,c,a.charAt(0)==="_"?"nested":"from-root")}O.exports={traces:p,layout:e,traceFlags:function(){return s(f)},layoutFlags:function(){return s(u)},update:function(i,c){var n=c.editType;if(n&&n!=="none")for(var a=n.split("+"),g=0;g<a.length;g++)i[a[g]]=!0},overrideAll:l}},{"../lib":787}],821:[function(r,O,B){var t=r("fast-isnumeric"),d=r("gl-mat4/fromQuat"),m=r("../registry"),p=r("../lib"),e=r("../plots/plots"),f=r("../plots/cartesian/axis_ids"),u=r("../components/color"),s=f.cleanId,l=f.getFromTrace,o=m.traceIs;function i(x,T){var A=x[T],S=T.charAt(0);A&&A!=="paper"&&(x[T]=s(A,S,!0))}function c(x){function T(A,S){var w=x[A],C=x.title&&x.title[S];w&&!C&&(x.title||(x.title={}),x.title[S]=x[A],delete x[A])}x&&(typeof x.title!="string"&&typeof x.title!="number"||(x.title={text:x.title}),T("titlefont","font"),T("titleposition","position"),T("titleside","side"),T("titleoffset","offset"))}function n(x){if(!p.isPlainObject(x))return!1;var T=x.name;return delete x.name,delete x.showlegend,(typeof T=="string"||typeof T=="number")&&String(T)}function a(x,T,A,S){if(A&&!S)return x;if(S&&!A||!x.trim())return T;if(!T.trim())return x;var w,C=Math.min(x.length,T.length);for(w=0;w<C&&x.charAt(w)===T.charAt(w);w++);return x.substr(0,w).trim()}function g(x){var T="middle",A="center";return typeof x=="string"&&(x.indexOf("top")!==-1?T="top":x.indexOf("bottom")!==-1&&(T="bottom"),x.indexOf("left")!==-1?A="left":x.indexOf("right")!==-1&&(A="right")),T+" "+A}function h(x,T){return T in x&&typeof x[T]=="object"&&Object.keys(x[T]).length===0}B.clearPromiseQueue=function(x){Array.isArray(x._promises)&&x._promises.length>0&&p.log("Clearing previous rejected promises from queue."),x._promises=[]},B.cleanLayout=function(x){var T,A;x||(x={}),x.xaxis1&&(x.xaxis||(x.xaxis=x.xaxis1),delete x.xaxis1),x.yaxis1&&(x.yaxis||(x.yaxis=x.yaxis1),delete x.yaxis1),x.scene1&&(x.scene||(x.scene=x.scene1),delete x.scene1);var S=(e.subplotsRegistry.cartesian||{}).attrRegex,w=(e.subplotsRegistry.polar||{}).attrRegex,C=(e.subplotsRegistry.ternary||{}).attrRegex,k=(e.subplotsRegistry.gl3d||{}).attrRegex,L=Object.keys(x);for(T=0;T<L.length;T++){var M=L[T];if(S&&S.test(M)){var P=x[M];P.anchor&&P.anchor!=="free"&&(P.anchor=s(P.anchor)),P.overlaying&&(P.overlaying=s(P.overlaying)),P.type||(P.isdate?P.type="date":P.islog?P.type="log":P.isdate===!1&&P.islog===!1&&(P.type="linear")),P.autorange!=="withzero"&&P.autorange!=="tozero"||(P.autorange=!0,P.rangemode="tozero"),delete P.islog,delete P.isdate,delete P.categories,h(P,"domain")&&delete P.domain,P.autotick!==void 0&&(P.tickmode===void 0&&(P.tickmode=P.autotick?"auto":"linear"),delete P.autotick),c(P)}else if(w&&w.test(M))c(x[M].radialaxis);else if(C&&C.test(M)){var D=x[M];c(D.aaxis),c(D.baxis),c(D.caxis)}else if(k&&k.test(M)){var N=x[M],U=N.cameraposition;if(Array.isArray(U)&&U[0].length===4){var q=U[0],X=U[1],K=U[2],Z=d([],q),H=[];for(A=0;A<3;++A)H[A]=X[A]+K*Z[2+4*A];N.camera={eye:{x:H[0],y:H[1],z:H[2]},center:{x:X[0],y:X[1],z:X[2]},up:{x:0,y:0,z:1}},delete N.cameraposition}c(N.xaxis),c(N.yaxis),c(N.zaxis)}}var Y=Array.isArray(x.annotations)?x.annotations.length:0;for(T=0;T<Y;T++){var $=x.annotations[T];p.isPlainObject($)&&($.ref&&($.ref==="paper"?($.xref="paper",$.yref="paper"):$.ref==="data"&&($.xref="x",$.yref="y"),delete $.ref),i($,"xref"),i($,"yref"))}var z=Array.isArray(x.shapes)?x.shapes.length:0;for(T=0;T<z;T++){var j=x.shapes[T];p.isPlainObject(j)&&(i(j,"xref"),i(j,"yref"))}var W=Array.isArray(x.images)?x.images.length:0;for(T=0;T<W;T++){var ee=x.images[T];p.isPlainObject(ee)&&(i(ee,"xref"),i(ee,"yref"))}var J=x.legend;return J&&(J.x>3?(J.x=1.02,J.xanchor="left"):J.x<-2&&(J.x=-.02,J.xanchor="right"),J.y>3?(J.y=1.02,J.yanchor="bottom"):J.y<-2&&(J.y=-.02,J.yanchor="top")),c(x),x.dragmode==="rotate"&&(x.dragmode="orbit"),u.clean(x),x.template&&x.template.layout&&B.cleanLayout(x.template.layout),x},B.cleanData=function(x){for(var T=0;T<x.length;T++){var A,S=x[T];if(S.type==="histogramy"&&"xbins"in S&&!("ybins"in S)&&(S.ybins=S.xbins,delete S.xbins),S.error_y&&"opacity"in S.error_y){var w=u.defaults,C=S.error_y.color||(o(S,"bar")?u.defaultLine:w[T%w.length]);S.error_y.color=u.addOpacity(u.rgb(C),u.opacity(C)*S.error_y.opacity),delete S.error_y.opacity}if("bardir"in S&&(S.bardir!=="h"||!o(S,"bar")&&S.type.substr(0,9)!=="histogram"||(S.orientation="h",B.swapXYData(S)),delete S.bardir),S.type==="histogramy"&&B.swapXYData(S),S.type!=="histogramx"&&S.type!=="histogramy"||(S.type="histogram"),"scl"in S&&!("colorscale"in S)&&(S.colorscale=S.scl,delete S.scl),"reversescl"in S&&!("reversescale"in S)&&(S.reversescale=S.reversescl,delete S.reversescl),S.xaxis&&(S.xaxis=s(S.xaxis,"x")),S.yaxis&&(S.yaxis=s(S.yaxis,"y")),o(S,"gl3d")&&S.scene&&(S.scene=e.subplotsRegistry.gl3d.cleanId(S.scene)),!o(S,"pie-like")&&!o(S,"bar-like"))if(Array.isArray(S.textposition))for(A=0;A<S.textposition.length;A++)S.textposition[A]=g(S.textposition[A]);else S.textposition&&(S.textposition=g(S.textposition));var k=m.getModule(S);if(k&&k.colorbar){var L=k.colorbar.container,M=L?S[L]:S;M&&M.colorscale&&(M.colorscale==="YIGnBu"&&(M.colorscale="YlGnBu"),M.colorscale==="YIOrRd"&&(M.colorscale="YlOrRd"))}if(S.type==="surface"&&p.isPlainObject(S.contours)){var P=["x","y","z"];for(A=0;A<P.length;A++){var D=S.contours[P[A]];p.isPlainObject(D)&&(D.highlightColor&&(D.highlightcolor=D.highlightColor,delete D.highlightColor),D.highlightWidth&&(D.highlightwidth=D.highlightWidth,delete D.highlightWidth))}}if(S.type==="candlestick"||S.type==="ohlc"){var N=(S.increasing||{}).showlegend!==!1,U=(S.decreasing||{}).showlegend!==!1,q=n(S.increasing),X=n(S.decreasing);if(q!==!1&&X!==!1){var K=a(q,X,N,U);K&&(S.name=K)}else!q&&!X||S.name||(S.name=q||X)}if(Array.isArray(S.transforms)){var Z=S.transforms;for(A=0;A<Z.length;A++){var H=Z[A];if(p.isPlainObject(H))switch(H.type){case"filter":H.filtersrc&&(H.target=H.filtersrc,delete H.filtersrc),H.calendar&&(H.valuecalendar||(H.valuecalendar=H.calendar),delete H.calendar);break;case"groupby":if(H.styles=H.styles||H.style,H.styles&&!Array.isArray(H.styles)){var Y=H.styles,$=Object.keys(Y);H.styles=[];for(var z=0;z<$.length;z++)H.styles.push({target:$[z],value:Y[$[z]]})}}}}h(S,"line")&&delete S.line,"marker"in S&&(h(S.marker,"line")&&delete S.marker.line,h(S,"marker")&&delete S.marker),u.clean(S),S.autobinx&&(delete S.autobinx,delete S.xbins),S.autobiny&&(delete S.autobiny,delete S.ybins),c(S),S.colorbar&&c(S.colorbar),S.marker&&S.marker.colorbar&&c(S.marker.colorbar),S.line&&S.line.colorbar&&c(S.line.colorbar),S.aaxis&&c(S.aaxis),S.baxis&&c(S.baxis)}},B.swapXYData=function(x){var T;if(p.swapAttrs(x,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(x.z)&&Array.isArray(x.z[0])&&(x.transpose?delete x.transpose:x.transpose=!0),x.error_x&&x.error_y){var A=x.error_y,S="copy_ystyle"in A?A.copy_ystyle:!(A.color||A.thickness||A.width);p.swapAttrs(x,["error_?.copy_ystyle"]),S&&p.swapAttrs(x,["error_?.color","error_?.thickness","error_?.width"])}if(typeof x.hoverinfo=="string"){var w=x.hoverinfo.split("+");for(T=0;T<w.length;T++)w[T]==="x"?w[T]="y":w[T]==="y"&&(w[T]="x");x.hoverinfo=w.join("+")}},B.coerceTraceIndices=function(x,T){if(t(T))return[T];if(!Array.isArray(T)||!T.length)return x.data.map(function(w,C){return C});if(Array.isArray(T)){for(var A=[],S=0;S<T.length;S++)p.isIndex(T[S],x.data.length)?A.push(T[S]):p.warn("trace index (",T[S],") is not a number or is out of bounds");return A}return T},B.manageArrayContainers=function(x,T,A){var S=x.obj,w=x.parts,C=w.length,k=w[C-1],L=t(k);if(L&&T===null){var M=w.slice(0,C-1).join(".");p.nestedProperty(S,M).get().splice(k,1)}else L&&x.get()===void 0&&x.get()===void 0&&(A[x.astr]=null),x.set(T)};var y=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function v(x){var T=x.search(y);if(T>0)return x.substr(0,T)}B.hasParent=function(x,T){for(var A=v(T);A;){if(A in x)return!0;A=v(A)}return!1};var _=["x","y","z"];B.clearAxisTypes=function(x,T,A){for(var S=0;S<T.length;S++)for(var w=x._fullData[S],C=0;C<3;C++){var k=l(x,w,_[C]);if(k&&k.type!=="log"){var L=k._name,M=k._id.substr(1);if(M.substr(0,5)==="scene"){if(A[M]!==void 0)continue;L=M+"."+L}var P=L+".type";A[L]===void 0&&A[P]===void 0&&p.nestedProperty(x.layout,P).set(null)}}}},{"../components/color":650,"../lib":787,"../plots/cartesian/axis_ids":842,"../plots/plots":901,"../registry":915,"fast-isnumeric":246,"gl-mat4/fromQuat":282}],822:[function(r,O,B){var t=r("./plot_api");B._doPlot=t._doPlot,B.newPlot=t.newPlot,B.restyle=t.restyle,B.relayout=t.relayout,B.redraw=t.redraw,B.update=t.update,B._guiRestyle=t._guiRestyle,B._guiRelayout=t._guiRelayout,B._guiUpdate=t._guiUpdate,B._storeDirectGUIEdit=t._storeDirectGUIEdit,B.react=t.react,B.extendTraces=t.extendTraces,B.prependTraces=t.prependTraces,B.addTraces=t.addTraces,B.deleteTraces=t.deleteTraces,B.moveTraces=t.moveTraces,B.purge=t.purge,B.addFrames=t.addFrames,B.deleteFrames=t.deleteFrames,B.animate=t.animate,B.setPlotConfig=t.setPlotConfig,B.toImage=r("./to_image"),B.validate=r("./validate"),B.downloadImage=r("../snapshot/download");var d=r("./template_api");B.makeTemplate=d.makeTemplate,B.validateTemplate=d.validateTemplate},{"../snapshot/download":917,"./plot_api":824,"./template_api":829,"./to_image":830,"./validate":831}],823:[function(r,O,B){var t=r("../lib/is_plain_object"),d=r("../lib/noop"),m=r("../lib/loggers"),p=r("../lib/search").sorterAsc,e=r("../registry");B.containerArrayMatch=r("./container_array_match");var f=B.isAddVal=function(s){return s==="add"||t(s)},u=B.isRemoveVal=function(s){return s===null||s==="remove"};B.applyContainerArrayChanges=function(s,l,o,i,c){var n=l.astr,a=e.getComponentMethod(n,"supplyLayoutDefaults"),g=e.getComponentMethod(n,"draw"),h=e.getComponentMethod(n,"drawOne"),y=i.replot||i.recalc||a===d||g===d,v=s.layout,_=s._fullLayout;if(o[""]){Object.keys(o).length>1&&m.warn("Full array edits are incompatible with other edits",n);var x=o[""][""];if(u(x))l.set(null);else{if(!Array.isArray(x))return m.warn("Unrecognized full array edit value",n,x),!0;l.set(x)}return!y&&(a(v,_),g(s),!0)}var T,A,S,w,C,k,L,M,P=Object.keys(o).map(Number).sort(p),D=l.get(),N=D||[],U=c(_,n).get(),q=[],X=-1,K=N.length;for(T=0;T<P.length;T++)if(w=o[S=P[T]],C=Object.keys(w),k=w[""],L=f(k),S<0||S>N.length-(L?0:1))m.warn("index out of range",n,S);else if(k!==void 0)C.length>1&&m.warn("Insertion & removal are incompatible with edits to the same index.",n,S),u(k)?q.push(S):L?(k==="add"&&(k={}),N.splice(S,0,k),U&&U.splice(S,0,{})):m.warn("Unrecognized full object edit value",n,S,k),X===-1&&(X=S);else for(A=0;A<C.length;A++)M=n+"["+S+"].",c(N[S],C[A],M).set(w[C[A]]);for(T=q.length-1;T>=0;T--)N.splice(q[T],1),U&&U.splice(q[T],1);if(N.length?D||l.set(N):l.set(null),y)return!1;if(a(v,_),h!==d){var Z;if(X===-1)Z=P;else{for(K=Math.max(N.length,K),Z=[],T=0;T<P.length&&!((S=P[T])>=X);T++)Z.push(S);for(T=X;T<K;T++)Z.push(T)}for(T=0;T<Z.length;T++)h(s,Z[T])}else g(s);return!0}},{"../lib/is_plain_object":788,"../lib/loggers":791,"../lib/noop":796,"../lib/search":807,"../registry":915,"./container_array_match":819}],824:[function(r,O,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("has-hover"),p=r("../lib"),e=p.nestedProperty,f=r("../lib/events"),u=r("../lib/queue"),s=r("../registry"),l=r("./plot_schema"),o=r("../plots/plots"),i=r("../plots/cartesian/axes"),c=r("../components/drawing"),n=r("../components/color"),a=r("../plots/cartesian/graph_interact").initInteractions,g=r("../constants/xmlns_namespaces"),h=r("../plots/cartesian/select").clearSelect,y=r("./plot_config").dfltConfig,v=r("./manage_arrays"),_=r("./helpers"),x=r("./subroutines"),T=r("./edit_types"),A=r("../plots/cartesian/constants").AX_NAME_PATTERN,S=0;function w(ce){var ge=ce._fullLayout;ge._redrawFromAutoMarginCount?ge._redrawFromAutoMarginCount--:ce.emit("plotly_afterplot")}function C(ce,ge){try{ce._fullLayout._paper.style("background",ge)}catch(we){p.error(we)}}function k(ce,ge){C(ce,n.combine(ge,"white"))}function L(ce,ge){if(!ce._context){ce._context=p.extendDeep({},y);var we=t.select("base");ce._context._baseUrl=we.size()&&we.attr("href")?window.location.href.split("#")[0]:""}var Me,Se,ze,Fe=ce._context;if(ge){for(Se=Object.keys(ge),Me=0;Me<Se.length;Me++)(ze=Se[Me])!=="editable"&&ze!=="edits"&&ze in Fe&&(ze==="setBackground"&&ge[ze]==="opaque"?Fe[ze]=k:Fe[ze]=ge[ze]);ge.plot3dPixelRatio&&!Fe.plotGlPixelRatio&&(Fe.plotGlPixelRatio=Fe.plot3dPixelRatio);var Ye=ge.editable;if(Ye!==void 0)for(Fe.editable=Ye,Se=Object.keys(Fe.edits),Me=0;Me<Se.length;Me++)Fe.edits[Se[Me]]=Ye;if(ge.edits)for(Se=Object.keys(ge.edits),Me=0;Me<Se.length;Me++)(ze=Se[Me])in Fe.edits&&(Fe.edits[ze]=ge.edits[ze]);Fe._exportedPlot=ge._exportedPlot}Fe.staticPlot&&(Fe.editable=!1,Fe.edits={},Fe.autosizable=!1,Fe.scrollZoom=!1,Fe.doubleClick=!1,Fe.showTips=!1,Fe.showLink=!1,Fe.displayModeBar=!1),Fe.displayModeBar!=="hover"||m||(Fe.displayModeBar=!0),Fe.setBackground!=="transparent"&&typeof Fe.setBackground=="function"||(Fe.setBackground=C),Fe._hasZeroHeight=Fe._hasZeroHeight||ce.clientHeight===0,Fe._hasZeroWidth=Fe._hasZeroWidth||ce.clientWidth===0;var rt=Fe.scrollZoom,Oe=Fe._scrollZoom={};if(rt===!0)Oe.cartesian=1,Oe.gl3d=1,Oe.geo=1,Oe.mapbox=1;else if(typeof rt=="string"){var je=rt.split("+");for(Me=0;Me<je.length;Me++)Oe[je[Me]]=1}else rt!==!1&&(Oe.gl3d=1,Oe.geo=1,Oe.mapbox=1)}function M(ce,ge){var we,Me,Se=ge+1,ze=[];for(we=0;we<ce.length;we++)(Me=ce[we])<0?ze.push(Se+Me):ze.push(Me);return ze}function P(ce,ge,we){var Me,Se;for(Me=0;Me<ge.length;Me++){if((Se=ge[Me])!==parseInt(Se,10))throw new Error("all values in "+we+" must be integers");if(Se>=ce.data.length||Se<-ce.data.length)throw new Error(we+" must be valid indices for gd.data.");if(ge.indexOf(Se,Me+1)>-1||Se>=0&&ge.indexOf(-ce.data.length+Se)>-1||Se<0&&ge.indexOf(ce.data.length+Se)>-1)throw new Error("each index in "+we+" must be unique.")}}function D(ce,ge,we){if(!Array.isArray(ce.data))throw new Error("gd.data must be an array.");if(ge===void 0)throw new Error("currentIndices is a required argument.");if(Array.isArray(ge)||(ge=[ge]),P(ce,ge,"currentIndices"),we===void 0||Array.isArray(we)||(we=[we]),we!==void 0&&P(ce,we,"newIndices"),we!==void 0&&ge.length!==we.length)throw new Error("current and new indices must be of equal length.")}function N(ce,ge,we,Me,Se){(function(qe,Qe,st,ct){var Pt=p.isPlainObject(ct);if(!Array.isArray(qe.data))throw new Error("gd.data must be an array");if(!p.isPlainObject(Qe))throw new Error("update must be a key:value object");if(st===void 0)throw new Error("indices must be an integer or array of integers");for(var kt in P(qe,st,"indices"),Qe){if(!Array.isArray(Qe[kt])||Qe[kt].length!==st.length)throw new Error("attribute "+kt+" must be an array of length equal to indices array length");if(Pt&&(!(kt in ct)||!Array.isArray(ct[kt])||ct[kt].length!==Qe[kt].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}})(ce,ge,we,Me);for(var ze=function(qe,Qe,st,ct){var Pt,kt,at,tt,_t,er=p.isPlainObject(ct),tr=[];for(var Ue in Array.isArray(st)||(st=[st]),st=M(st,qe.data.length-1),Qe)for(var He=0;He<st.length;He++){if(Pt=qe.data[st[He]],kt=(at=e(Pt,Ue)).get(),tt=Qe[Ue][He],!p.isArrayOrTypedArray(tt))throw new Error("attribute: "+Ue+" index: "+He+" must be an array");if(!p.isArrayOrTypedArray(kt))throw new Error("cannot extend missing or non-array attribute: "+Ue);if(kt.constructor!==tt.constructor)throw new Error("cannot extend array with an array of a different type: "+Ue);_t=er?ct[Ue][He]:ct,d(_t)||(_t=-1),tr.push({prop:at,target:kt,insert:tt,maxp:Math.floor(_t)})}return tr}(ce,ge,we,Me),Fe={},Ye={},rt=0;rt<ze.length;rt++){var Oe=ze[rt].prop,je=ze[rt].maxp,We=Se(ze[rt].target,ze[rt].insert,je);Oe.set(We[0]),Array.isArray(Fe[Oe.astr])||(Fe[Oe.astr]=[]),Fe[Oe.astr].push(We[1]),Array.isArray(Ye[Oe.astr])||(Ye[Oe.astr]=[]),Ye[Oe.astr].push(ze[rt].target.length)}return{update:Fe,maxPoints:Ye}}function U(ce,ge){var we=new ce.constructor(ce.length+ge.length);return we.set(ce),we.set(ge,ce.length),we}function q(ce,ge,we,Me){ce=p.getGraphDiv(ce),_.clearPromiseQueue(ce);var Se={};if(typeof ge=="string")Se[ge]=we;else{if(!p.isPlainObject(ge))return p.warn("Restyle fail.",ge,we,Me),Promise.reject();Se=p.extendFlat({},ge),Me===void 0&&(Me=we)}Object.keys(Se).length&&(ce.changed=!0);var ze=_.coerceTraceIndices(ce,Me),Fe=H(ce,Se,ze),Ye=Fe.flags;Ye.calc&&(ce.calcdata=void 0),Ye.clearAxisTypes&&_.clearAxisTypes(ce,ze,{});var rt=[];Ye.fullReplot?rt.push(B._doPlot):(rt.push(o.previousPromises),o.supplyDefaults(ce),Ye.markerSize&&(o.doCalcdata(ce),j(rt)),Ye.style&&rt.push(x.doTraceStyle),Ye.colorbars&&rt.push(x.doColorBars),rt.push(w)),rt.push(o.rehover,o.redrag),u.add(ce,q,[ce,Fe.undoit,Fe.traces],q,[ce,Fe.redoit,Fe.traces]);var Oe=p.syncOrAsync(rt,ce);return Oe&&Oe.then||(Oe=Promise.resolve()),Oe.then(function(){return ce.emit("plotly_restyle",Fe.eventData),ce})}function X(ce){return ce===void 0?null:ce}function K(ce,ge){return ge?function(we,Me,Se){var ze=e(we,Me),Fe=ze.set;return ze.set=function(Ye){Z((Se||"")+Me,ze.get(),Ye,ce),Fe(Ye)},ze}:e}function Z(ce,ge,we,Me){if(Array.isArray(ge)||Array.isArray(we))for(var Se=Array.isArray(ge)?ge:[],ze=Array.isArray(we)?we:[],Fe=Math.max(Se.length,ze.length),Ye=0;Ye<Fe;Ye++)Z(ce+"["+Ye+"]",Se[Ye],ze[Ye],Me);else if(p.isPlainObject(ge)||p.isPlainObject(we)){var rt=p.isPlainObject(ge)?ge:{},Oe=p.isPlainObject(we)?we:{},je=p.extendFlat({},rt,Oe);for(var We in je)Z(ce+"."+We,rt[We],Oe[We],Me)}else Me[ce]===void 0&&(Me[ce]=X(ge))}function H(ce,ge,we){var Me,Se=ce._fullLayout,ze=ce._fullData,Fe=ce.data,Ye=Se._guiEditing,rt=K(Se._preGUI,Ye),Oe=p.extendDeepAll({},ge);Y(ge);var je,We=T.traceFlags(),qe={},Qe={};function st(){return we.map(function(){})}function ct(wt){var Ot=i.id2name(wt);je.indexOf(Ot)===-1&&je.push(Ot)}function Pt(wt){return"LAYOUT"+wt+".autorange"}function kt(wt){return"LAYOUT"+wt+".range"}function at(wt){for(var Ot=wt;Ot<ze.length;Ot++)if(ze[Ot]._input===Fe[wt])return ze[Ot]}function tt(wt,Ot,Gt){if(Array.isArray(wt))wt.forEach(function(Kt){tt(Kt,Ot,Gt)});else if(!(wt in ge)&&!_.hasParent(ge,wt)){var ir;if(wt.substr(0,6)==="LAYOUT")ir=rt(ce.layout,wt.replace("LAYOUT",""));else{var Xt=we[Gt];ir=K(Se._tracePreGUI[at(Xt)._fullInput.uid],Ye)(Fe[Xt],wt)}wt in Qe||(Qe[wt]=st()),Qe[wt][Gt]===void 0&&(Qe[wt][Gt]=X(ir.get())),Ot!==void 0&&ir.set(Ot)}}function _t(wt){return function(Ot){return ze[Ot][wt]}}function er(wt){return function(Ot,Gt){return Ot===!1?ze[we[Gt]][wt]:null}}for(var tr in ge){if(_.hasParent(ge,tr))throw new Error("cannot set "+tr+" and a parent attribute simultaneously");var Ue,He,Be,Ke,_e,Ce,Le=ge[tr];if(tr!=="autobinx"&&tr!=="autobiny"||(tr=tr.charAt(tr.length-1)+"bins",Le=Array.isArray(Le)?Le.map(er(tr)):Le===!1?we.map(_t(tr)):null),qe[tr]=Le,tr.substr(0,6)!=="LAYOUT"){for(Qe[tr]=st(),Me=0;Me<we.length;Me++)if(Ue=Fe[we[Me]],He=at(we[Me]),Ke=(Be=K(Se._tracePreGUI[He._fullInput.uid],Ye)(Ue,tr)).get(),(_e=Array.isArray(Le)?Le[Me%Le.length]:Le)!==void 0){var Pe=Be.parts[Be.parts.length-1],Xe=tr.substr(0,tr.length-Pe.length-1),ht=Xe?Xe+".":"",Mt=Xe?e(He,Xe).get():He;if((Ce=l.getTraceValObject(He,Be.parts))&&Ce.impliedEdits&&_e!==null)for(var pt in Ce.impliedEdits)tt(p.relativeAttr(tr,pt),Ce.impliedEdits[pt],Me);else if(Pe!=="thicknessmode"&&Pe!=="lenmode"||Ke===_e||_e!=="fraction"&&_e!=="pixels"||!Mt){if(tr==="type"&&(_e==="pie"!=(Ke==="pie")||_e==="funnelarea"!=(Ke==="funnelarea"))){var Lt="x",vt="y";_e!=="bar"&&Ke!=="bar"||Ue.orientation!=="h"||(Lt="y",vt="x"),p.swapAttrs(Ue,["?","?src"],"labels",Lt),p.swapAttrs(Ue,["d?","?0"],"label",Lt),p.swapAttrs(Ue,["?","?src"],"values",vt),Ke==="pie"||Ke==="funnelarea"?(e(Ue,"marker.color").set(e(Ue,"marker.colors").get()),Se._pielayer.selectAll("g.trace").remove()):s.traceIs(Ue,"cartesian")&&e(Ue,"marker.colors").set(e(Ue,"marker.color").get())}}else{var Dt=Se._size,xt=Mt.orient,it=xt==="top"||xt==="bottom";if(Pe==="thicknessmode"){var St=it?Dt.h:Dt.w;tt(ht+"thickness",Mt.thickness*(_e==="fraction"?1/St:St),Me)}else{var Nt=it?Dt.w:Dt.h;tt(ht+"len",Mt.len*(_e==="fraction"?1/Nt:Nt),Me)}}if(Qe[tr][Me]=X(Ke),["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(tr)!==-1){if(tr==="orientation"){Be.set(_e);var Ut=Ue.x&&!Ue.y?"h":"v";if((Be.get()||Ut)===He.orientation)continue}else tr==="orientationaxes"&&(Ue.orientation={v:"h",h:"v"}[He.orientation]);_.swapXYData(Ue),We.calc=We.clearAxisTypes=!0}else o.dataArrayContainers.indexOf(Be.parts[0])!==-1?(_.manageArrayContainers(Be,_e,Qe),We.calc=!0):(Ce?Ce.arrayOk&&!s.traceIs(He,"regl")&&(p.isArrayOrTypedArray(_e)||p.isArrayOrTypedArray(Ke))?We.calc=!0:T.update(We,Ce):We.calc=!0,Be.set(_e))}if(["swapxyaxes","orientationaxes"].indexOf(tr)!==-1&&i.swap(ce,we),tr==="orientationaxes"){var Qt=e(ce.layout,"hovermode"),Ie=Qt.get();Ie==="x"?Qt.set("y"):Ie==="y"?Qt.set("x"):Ie==="x unified"?Qt.set("y unified"):Ie==="y unified"&&Qt.set("x unified")}if(["orientation","type"].indexOf(tr)!==-1){for(je=[],Me=0;Me<we.length;Me++){var lt=Fe[we[Me]];s.traceIs(lt,"cartesian")&&(ct(lt.xaxis||"x"),ct(lt.yaxis||"y"))}tt(je.map(Pt),!0,0),tt(je.map(kt),[0,1],0)}}else Be=rt(ce.layout,tr.replace("LAYOUT","")),Qe[tr]=[X(Be.get())],Be.set(Array.isArray(Le)?Le[0]:Le),We.calc=!0}return(We.calc||We.plot)&&(We.fullReplot=!0),{flags:We,undoit:Qe,redoit:qe,traces:we,eventData:p.extendDeepNoArrays([],[Oe,we])}}function Y(ce){var ge,we,Me,Se=p.counterRegex("axis",".title",!1,!1),ze=/colorbar\.title$/,Fe=Object.keys(ce);for(ge=0;ge<Fe.length;ge++)we=Fe[ge],Me=ce[we],we!=="title"&&!Se.test(we)&&!ze.test(we)||typeof Me!="string"&&typeof Me!="number"?we.indexOf("titlefont")>-1?Ye(we,we.replace("titlefont","title.font")):we.indexOf("titleposition")>-1?Ye(we,we.replace("titleposition","title.position")):we.indexOf("titleside")>-1?Ye(we,we.replace("titleside","title.side")):we.indexOf("titleoffset")>-1&&Ye(we,we.replace("titleoffset","title.offset")):Ye(we,we.replace("title","title.text"));function Ye(rt,Oe){ce[Oe]=ce[rt],delete ce[rt]}}function $(ce,ge,we){ce=p.getGraphDiv(ce),_.clearPromiseQueue(ce);var Me={};if(typeof ge=="string")Me[ge]=we;else{if(!p.isPlainObject(ge))return p.warn("Relayout fail.",ge,we),Promise.reject();Me=p.extendFlat({},ge)}Object.keys(Me).length&&(ce.changed=!0);var Se=Q(ce,Me),ze=Se.flags;ze.calc&&(ce.calcdata=void 0);var Fe=[o.previousPromises];ze.layoutReplot?Fe.push(x.layoutReplot):Object.keys(Me).length&&(z(ce,ze,Se)||o.supplyDefaults(ce),ze.legend&&Fe.push(x.doLegend),ze.layoutstyle&&Fe.push(x.layoutStyles),ze.axrange&&j(Fe,Se.rangesAltered),ze.ticks&&Fe.push(x.doTicksRelayout),ze.modebar&&Fe.push(x.doModeBar),ze.camera&&Fe.push(x.doCamera),ze.colorbars&&Fe.push(x.doColorBars),Fe.push(w)),Fe.push(o.rehover,o.redrag),u.add(ce,$,[ce,Se.undoit],$,[ce,Se.redoit]);var Ye=p.syncOrAsync(Fe,ce);return Ye&&Ye.then||(Ye=Promise.resolve(ce)),Ye.then(function(){return ce.emit("plotly_relayout",Se.eventData),ce})}function z(ce,ge,we){var Me=ce._fullLayout;if(!ge.axrange)return!1;for(var Se in ge)if(Se!=="axrange"&&ge[Se])return!1;for(var ze in we.rangesAltered){var Fe=i.id2name(ze),Ye=ce.layout[Fe],rt=Me[Fe];if(rt.autorange=Ye.autorange,Ye.range&&(rt.range=Ye.range.slice()),rt.cleanRange(),rt._matchGroup){for(var Oe in rt._matchGroup)if(Oe!==ze){var je=Me[i.id2name(Oe)];je.autorange=rt.autorange,je.range=rt.range.slice(),je._input.range=rt.range.slice()}}}return!0}function j(ce,ge){var we=ge?function(Me){var Se=[],ze=!0;for(var Fe in ge){var Ye=i.getFromId(Me,Fe);if(Se.push(Fe),(Ye.ticklabelposition||"").indexOf("inside")!==-1&&Ye._anchorAxis&&Se.push(Ye._anchorAxis._id),Ye._matchGroup)for(var rt in Ye._matchGroup)ge[rt]||Se.push(rt);Ye.automargin&&(ze=!1)}return i.draw(Me,Se,{skipTitle:ze})}:function(Me){return i.draw(Me,"redraw")};ce.push(h,x.doAutoRangeAndConstraints,we,x.drawData,x.finalDraw)}var W=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,ee=/^[xyz]axis[0-9]*\.autorange$/,J=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function Q(ce,ge){var we,Me,Se,ze=ce.layout,Fe=ce._fullLayout,Ye=Fe._guiEditing,rt=K(Fe._preGUI,Ye),Oe=Object.keys(ge),je=i.list(ce),We=p.extendDeepAll({},ge),qe={};for(Y(ge),Oe=Object.keys(ge),Me=0;Me<Oe.length;Me++)if(Oe[Me].indexOf("allaxes")===0){for(Se=0;Se<je.length;Se++){var Qe=je[Se]._id.substr(1),st=Qe.indexOf("scene")!==-1?Qe+".":"",ct=Oe[Me].replace("allaxes",st+je[Se]._name);ge[ct]||(ge[ct]=ge[Oe[Me]])}delete ge[Oe[Me]]}var Pt=T.layoutFlags(),kt={},at={};function tt(Xt,Kt){if(Array.isArray(Xt))Xt.forEach(function(dr){tt(dr,Kt)});else if(!(Xt in ge)&&!_.hasParent(ge,Xt)){var or=rt(ze,Xt);Xt in at||(at[Xt]=X(or.get())),Kt!==void 0&&or.set(Kt)}}var _t,er={};function tr(Xt){var Kt=i.name2id(Xt.split(".")[0]);return er[Kt]=1,Kt}for(var Ue in ge){if(_.hasParent(ge,Ue))throw new Error("cannot set "+Ue+" and a parent attribute simultaneously");for(var He=rt(ze,Ue),Be=ge[Ue],Ke=He.parts.length-1;Ke>0&&typeof He.parts[Ke]!="string";)Ke--;var _e=He.parts[Ke],Ce=He.parts[Ke-1]+"."+_e,Le=He.parts.slice(0,Ke).join("."),Pe=e(ce.layout,Le).get(),Xe=e(Fe,Le).get(),ht=He.get();if(Be!==void 0){kt[Ue]=Be,at[Ue]=_e==="reverse"?Be:X(ht);var Mt=l.getLayoutValObject(Fe,He.parts);if(Mt&&Mt.impliedEdits&&Be!==null)for(var pt in Mt.impliedEdits)tt(p.relativeAttr(Ue,pt),Mt.impliedEdits[pt]);if(["width","height"].indexOf(Ue)!==-1)if(Be){tt("autosize",null);var Lt=Ue==="height"?"width":"height";tt(Lt,Fe[Lt])}else Fe[Ue]=ce._initialAutoSize[Ue];else if(Ue==="autosize")tt("width",Be?null:Fe.width),tt("height",Be?null:Fe.height);else if(Ce.match(W))tr(Ce),e(Fe,Le+"._inputRange").set(null);else if(Ce.match(ee)){tr(Ce),e(Fe,Le+"._inputRange").set(null);var vt=e(Fe,Le).get();vt._inputDomain&&(vt._input.domain=vt._inputDomain.slice())}else Ce.match(J)&&e(Fe,Le+"._inputDomain").set(null);if(_e==="type"){_t=Pe;var Dt=Xe.type==="linear"&&Be==="log",xt=Xe.type==="log"&&Be==="linear";if(Dt||xt){if(_t&&_t.range)if(Xe.autorange)Dt&&(_t.range=_t.range[1]>_t.range[0]?[1,2]:[2,1]);else{var it=_t.range[0],St=_t.range[1];Dt?(it<=0&&St<=0&&tt(Le+".autorange",!0),it<=0?it=St/1e6:St<=0&&(St=it/1e6),tt(Le+".range[0]",Math.log(it)/Math.LN10),tt(Le+".range[1]",Math.log(St)/Math.LN10)):(tt(Le+".range[0]",Math.pow(10,it)),tt(Le+".range[1]",Math.pow(10,St)))}else tt(Le+".autorange",!0);Array.isArray(Fe._subplots.polar)&&Fe._subplots.polar.length&&Fe[He.parts[0]]&&He.parts[1]==="radialaxis"&&delete Fe[He.parts[0]]._subplot.viewInitial["radialaxis.range"],s.getComponentMethod("annotations","convertCoords")(ce,Xe,Be,tt),s.getComponentMethod("images","convertCoords")(ce,Xe,Be,tt)}else tt(Le+".autorange",!0),tt(Le+".range",null);e(Fe,Le+"._inputRange").set(null)}else if(_e.match(A)){var Nt=e(Fe,Ue).get(),Ut=(Be||{}).type;Ut&&Ut!=="-"||(Ut="linear"),s.getComponentMethod("annotations","convertCoords")(ce,Nt,Ut,tt),s.getComponentMethod("images","convertCoords")(ce,Nt,Ut,tt)}var Qt=v.containerArrayMatch(Ue);if(Qt){we=Qt.array,Me=Qt.index;var Ie=Qt.property,lt=Mt||{editType:"calc"};Me!==""&&Ie===""&&(v.isAddVal(Be)?at[Ue]=null:v.isRemoveVal(Be)?at[Ue]=(e(ze,we).get()||[])[Me]:p.warn("unrecognized full object value",ge)),T.update(Pt,lt),qe[we]||(qe[we]={});var wt=qe[we][Me];wt||(wt=qe[we][Me]={}),wt[Ie]=Be,delete ge[Ue]}else _e==="reverse"?(Pe.range?Pe.range.reverse():(tt(Le+".autorange",!0),Pe.range=[1,0]),Xe.autorange?Pt.calc=!0:Pt.plot=!0):(Fe._has("scatter-like")&&Fe._has("regl")&&Ue==="dragmode"&&(Be==="lasso"||Be==="select")&&ht!=="lasso"&&ht!=="select"||Fe._has("gl2d")?Pt.plot=!0:Mt?T.update(Pt,Mt):Pt.calc=!0,He.set(Be))}}for(we in qe)v.applyContainerArrayChanges(ce,rt(ze,we),qe[we],Pt,rt)||(Pt.plot=!0);for(var Ot in er){var Gt=(_t=i.getFromId(ce,Ot))&&_t._constraintGroup;if(Gt)for(var ir in Pt.calc=!0,Gt)er[ir]||(i.getFromId(ce,ir)._constraintShrinkable=!0)}return(te(ce)||ge.height||ge.width)&&(Pt.plot=!0),(Pt.plot||Pt.calc)&&(Pt.layoutReplot=!0),{flags:Pt,rangesAltered:er,undoit:at,redoit:kt,eventData:We}}function te(ce){var ge=ce._fullLayout,we=ge.width,Me=ge.height;return ce.layout.autosize&&o.plotAutoSize(ce,ce.layout,ge),ge.width!==we||ge.height!==Me}function ie(ce,ge,we,Me){ce=p.getGraphDiv(ce),_.clearPromiseQueue(ce),p.isPlainObject(ge)||(ge={}),p.isPlainObject(we)||(we={}),Object.keys(ge).length&&(ce.changed=!0),Object.keys(we).length&&(ce.changed=!0);var Se=_.coerceTraceIndices(ce,Me),ze=H(ce,p.extendFlat({},ge),Se),Fe=ze.flags,Ye=Q(ce,p.extendFlat({},we)),rt=Ye.flags;(Fe.calc||rt.calc)&&(ce.calcdata=void 0),Fe.clearAxisTypes&&_.clearAxisTypes(ce,Se,we);var Oe=[];rt.layoutReplot?Oe.push(x.layoutReplot):Fe.fullReplot?Oe.push(B._doPlot):(Oe.push(o.previousPromises),z(ce,rt,Ye)||o.supplyDefaults(ce),Fe.style&&Oe.push(x.doTraceStyle),(Fe.colorbars||rt.colorbars)&&Oe.push(x.doColorBars),rt.legend&&Oe.push(x.doLegend),rt.layoutstyle&&Oe.push(x.layoutStyles),rt.axrange&&j(Oe,Ye.rangesAltered),rt.ticks&&Oe.push(x.doTicksRelayout),rt.modebar&&Oe.push(x.doModeBar),rt.camera&&Oe.push(x.doCamera),Oe.push(w)),Oe.push(o.rehover,o.redrag),u.add(ce,ie,[ce,ze.undoit,Ye.undoit,ze.traces],ie,[ce,ze.redoit,Ye.redoit,ze.traces]);var je=p.syncOrAsync(Oe,ce);return je&&je.then||(je=Promise.resolve(ce)),je.then(function(){return ce.emit("plotly_update",{data:ze.eventData,layout:Ye.eventData}),ce})}function ae(ce){return function(ge){ge._fullLayout._guiEditing=!0;var we=ce.apply(null,arguments);return ge._fullLayout._guiEditing=!1,we}}var he=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],se=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function de(ce,ge){for(var we=0;we<ge.length;we++){var Me=ge[we],Se=ce.match(Me.pattern);if(Se)return{head:Se[1],attr:Me.attr}}}function ue(ce,ge){var we=e(ge,ce).get();if(we!==void 0)return we;var Me=ce.split(".");for(Me.pop();Me.length>1;)if(Me.pop(),(we=e(ge,Me.join(".")+".uirevision").get())!==void 0)return we;return ge.uirevision}function ve(ce,ge){for(var we=0;we<ge.length;we++)if(ge[we]._fullInput.uid===ce)return we;return-1}function ke(ce,ge,we){for(var Me=0;Me<ge.length;Me++)if(ge[Me].uid===ce)return Me;return!ge[we]||ge[we].uid?-1:we}function Ee(ce,ge){var we=p.isPlainObject(ce),Me=Array.isArray(ce);return we||Me?(we&&p.isPlainObject(ge)||Me&&Array.isArray(ge))&&JSON.stringify(ce)===JSON.stringify(ge):ce===ge}function be(ce,ge,we,Me){var Se,ze,Fe,Ye=Me.getValObject,rt=Me.flags,Oe=Me.immutable,je=Me.inArray,We=Me.arrayIndex;function qe(){var Pe=Se.editType;je&&Pe.indexOf("arraydraw")!==-1?p.pushUnique(rt.arrays[je],We):(T.update(rt,Se),Pe!=="none"&&rt.nChanges++,Me.transition&&Se.anim&&rt.nChangesAnim++,(W.test(Fe)||ee.test(Fe))&&(rt.rangesAltered[we[0]]=1),J.test(Fe)&&e(ge,"_inputDomain").set(null),ze==="datarevision"&&(rt.newDataRevision=1))}function Qe(Pe){return Pe.valType==="data_array"||Pe.arrayOk}for(ze in ce){if(rt.calc&&!Me.transition)return;var st=ce[ze],ct=ge[ze],Pt=we.concat(ze);if(Fe=Pt.join("."),ze.charAt(0)!=="_"&&typeof st!="function"&&st!==ct){if((ze==="tick0"||ze==="dtick")&&we[0]!=="geo"){var kt=ge.tickmode;if(kt==="auto"||kt==="array"||!kt)continue}if((ze!=="range"||!ge.autorange)&&(ze!=="zmin"&&ze!=="zmax"||ge.type!=="contourcarpet")&&(Se=Ye(Pt))&&(!Se._compareAsJSON||JSON.stringify(st)!==JSON.stringify(ct))){var at,tt=Se.valType,_t=Qe(Se),er=Array.isArray(st),tr=Array.isArray(ct);if(er&&tr){var Ue="_input_"+ze,He=ce[Ue],Be=ge[Ue];if(Array.isArray(He)&&He===Be)continue}if(ct===void 0)_t&&er?rt.calc=!0:qe();else if(Se._isLinkedToArray){var Ke=[],_e=!1;je||(rt.arrays[ze]=Ke);var Ce=Math.min(st.length,ct.length),Le=Math.max(st.length,ct.length);if(Ce!==Le){if(Se.editType!=="arraydraw"){qe();continue}_e=!0}for(at=0;at<Ce;at++)be(st[at],ct[at],Pt.concat(at),p.extendFlat({inArray:ze,arrayIndex:at},Me));if(_e)for(at=Ce;at<Le;at++)Ke.push(at)}else!tt&&p.isPlainObject(st)?be(st,ct,Pt,Me):_t?er&&tr?(Oe&&(rt.calc=!0),(Oe||Me.newDataRevision)&&qe()):er!==tr?rt.calc=!0:qe():er&&tr&&st.length===ct.length&&String(st)===String(ct)||qe()}}}for(ze in ge)if(!(ze in ce)&&ze.charAt(0)!=="_"&&typeof ge[ze]!="function"){if(Qe(Se=Ye(we.concat(ze)))&&Array.isArray(ge[ze]))return void(rt.calc=!0);qe()}}function xe(ce){var ge=ce._fullLayout,we=ce.getBoundingClientRect();if(!p.equalDomRects(we,ge._lastBBox)){var Me=ge._invTransform=p.inverseTransformMatrix(p.getFullTransformMatrix(ce));ge._invScaleX=Math.sqrt(Me[0][0]*Me[0][0]+Me[0][1]*Me[0][1]+Me[0][2]*Me[0][2]),ge._invScaleY=Math.sqrt(Me[1][0]*Me[1][0]+Me[1][1]*Me[1][1]+Me[1][2]*Me[1][2]),ge._lastBBox=we}}B.animate=function(ce,ge,we){if(ce=p.getGraphDiv(ce),!p.isPlotDiv(ce))throw new Error("This element is not a Plotly plot: "+ce+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var Me=ce._transitionData;Me._frameQueue||(Me._frameQueue=[]);var Se=(we=o.supplyAnimationDefaults(we)).transition,ze=we.frame;function Fe(Oe){return Array.isArray(Se)?Oe>=Se.length?Se[0]:Se[Oe]:Se}function Ye(Oe){return Array.isArray(ze)?Oe>=ze.length?ze[0]:ze[Oe]:ze}function rt(Oe,je){var We=0;return function(){if(Oe&&++We===je)return Oe()}}return Me._frameWaitingCnt===void 0&&(Me._frameWaitingCnt=0),new Promise(function(Oe,je){function We(){Me._currentFrame&&Me._currentFrame.onComplete&&Me._currentFrame.onComplete();var He=Me._currentFrame=Me._frameQueue.shift();if(He){var Be=He.name?He.name.toString():null;ce._fullLayout._currentFrame=Be,Me._lastFrameAt=Date.now(),Me._timeToNext=He.frameOpts.duration,o.transition(ce,He.frame.data,He.frame.layout,_.coerceTraceIndices(ce,He.frame.traces),He.frameOpts,He.transitionOpts).then(function(){He.onComplete&&He.onComplete()}),ce.emit("plotly_animatingframe",{name:Be,frame:He.frame,animation:{frame:He.frameOpts,transition:He.transitionOpts}})}else ce.emit("plotly_animated"),window.cancelAnimationFrame(Me._animationRaf),Me._animationRaf=null}function qe(){ce.emit("plotly_animating"),Me._lastFrameAt=-1/0,Me._timeToNext=0,Me._runningTransitions=0,Me._currentFrame=null;var He=function(){Me._animationRaf=window.requestAnimationFrame(He),Date.now()-Me._lastFrameAt>Me._timeToNext&&We()};He()}var Qe,st,ct=0;function Pt(He){return Array.isArray(Se)?ct>=Se.length?He.transitionOpts=Se[ct]:He.transitionOpts=Se[0]:He.transitionOpts=Se,ct++,He}var kt=[],at=ge==null,tt=Array.isArray(ge);if(!at&&!tt&&p.isPlainObject(ge))kt.push({type:"object",data:Pt(p.extendFlat({},ge))});else if(at||["string","number"].indexOf(typeof ge)!==-1)for(Qe=0;Qe<Me._frames.length;Qe++)(st=Me._frames[Qe])&&(at||String(st.group)===String(ge))&&kt.push({type:"byname",name:String(st.name),data:Pt({name:st.name})});else if(tt)for(Qe=0;Qe<ge.length;Qe++){var _t=ge[Qe];["number","string"].indexOf(typeof _t)!==-1?(_t=String(_t),kt.push({type:"byname",name:_t,data:Pt({name:_t})})):p.isPlainObject(_t)&&kt.push({type:"object",data:Pt(p.extendFlat({},_t))})}for(Qe=0;Qe<kt.length;Qe++)if((st=kt[Qe]).type==="byname"&&!Me._frameHash[st.data.name])return p.warn('animate failure: frame not found: "'+st.data.name+'"'),void je();["next","immediate"].indexOf(we.mode)!==-1&&function(){if(Me._frameQueue.length!==0){for(;Me._frameQueue.length;){var He=Me._frameQueue.pop();He.onInterrupt&&He.onInterrupt()}ce.emit("plotly_animationinterrupted",[])}}(),we.direction==="reverse"&&kt.reverse();var er=ce._fullLayout._currentFrame;if(er&&we.fromcurrent){var tr=-1;for(Qe=0;Qe<kt.length;Qe++)if((st=kt[Qe]).type==="byname"&&st.name===er){tr=Qe;break}if(tr>0&&tr<kt.length-1){var Ue=[];for(Qe=0;Qe<kt.length;Qe++)st=kt[Qe],(kt[Qe].type!=="byname"||Qe>tr)&&Ue.push(st);kt=Ue}}kt.length>0?function(He){if(He.length!==0){for(var Be=0;Be<He.length;Be++){var Ke;Ke=He[Be].type==="byname"?o.computeFrame(ce,He[Be].name):He[Be].data;var _e=Ye(Be),Ce=Fe(Be);Ce.duration=Math.min(Ce.duration,_e.duration);var Le={frame:Ke,name:He[Be].name,frameOpts:_e,transitionOpts:Ce};Be===He.length-1&&(Le.onComplete=rt(Oe,2),Le.onInterrupt=je),Me._frameQueue.push(Le)}we.mode==="immediate"&&(Me._lastFrameAt=-1/0),Me._animationRaf||qe()}}(kt):(ce.emit("plotly_animated"),Oe())})},B.addFrames=function(ce,ge,we){if(ce=p.getGraphDiv(ce),ge==null)return Promise.resolve();if(!p.isPlotDiv(ce))throw new Error("This element is not a Plotly plot: "+ce+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var Me,Se,ze,Fe,Ye=ce._transitionData._frames,rt=ce._transitionData._frameHash;if(!Array.isArray(ge))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+ge);var Oe=Ye.length+2*ge.length,je=[],We={};for(Me=ge.length-1;Me>=0;Me--)if(p.isPlainObject(ge[Me])){var qe=ge[Me].name,Qe=(rt[qe]||We[qe]||{}).name,st=ge[Me].name,ct=rt[Qe]||We[Qe];Qe&&st&&typeof st=="number"&&ct&&S<5&&(S++,p.warn('addFrames: overwriting frame "'+(rt[Qe]||We[Qe]).name+'" with a frame whose name of type "number" also equates to "'+Qe+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),S===5&&p.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),We[qe]={name:qe},je.push({frame:o.supplyFrameDefaults(ge[Me]),index:we&&we[Me]!==void 0&&we[Me]!==null?we[Me]:Oe+Me})}je.sort(function(Ue,He){return Ue.index>He.index?-1:Ue.index<He.index?1:0});var Pt=[],kt=[],at=Ye.length;for(Me=je.length-1;Me>=0;Me--){if(typeof(Se=je[Me].frame).name=="number"&&p.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!Se.name)for(;rt[Se.name="frame "+ce._transitionData._counter++];);if(rt[Se.name]){for(ze=0;ze<Ye.length&&(Ye[ze]||{}).name!==Se.name;ze++);Pt.push({type:"replace",index:ze,value:Se}),kt.unshift({type:"replace",index:ze,value:Ye[ze]})}else Fe=Math.max(0,Math.min(je[Me].index,at)),Pt.push({type:"insert",index:Fe,value:Se}),kt.unshift({type:"delete",index:Fe}),at++}var tt=o.modifyFrames,_t=o.modifyFrames,er=[ce,kt],tr=[ce,Pt];return u&&u.add(ce,tt,er,_t,tr),o.modifyFrames(ce,Pt)},B.deleteFrames=function(ce,ge){if(ce=p.getGraphDiv(ce),!p.isPlotDiv(ce))throw new Error("This element is not a Plotly plot: "+ce);var we,Me,Se=ce._transitionData._frames,ze=[],Fe=[];if(!ge)for(ge=[],we=0;we<Se.length;we++)ge.push(we);for((ge=ge.slice()).sort(),we=ge.length-1;we>=0;we--)Me=ge[we],ze.push({type:"delete",index:Me}),Fe.unshift({type:"insert",index:Me,value:Se[Me]});var Ye=o.modifyFrames,rt=o.modifyFrames,Oe=[ce,Fe],je=[ce,ze];return u&&u.add(ce,Ye,Oe,rt,je),o.modifyFrames(ce,ze)},B.addTraces=function ce(ge,we,Me){ge=p.getGraphDiv(ge);var Se,ze,Fe=[],Ye=B.deleteTraces,rt=ce,Oe=[ge,Fe],je=[ge,we];for(function(We,qe,Qe){var st,ct;if(!Array.isArray(We.data))throw new Error("gd.data must be an array.");if(qe===void 0)throw new Error("traces must be defined.");for(Array.isArray(qe)||(qe=[qe]),st=0;st<qe.length;st++)if(typeof(ct=qe[st])!="object"||Array.isArray(ct)||ct===null)throw new Error("all values in traces array must be non-array objects");if(Qe===void 0||Array.isArray(Qe)||(Qe=[Qe]),Qe!==void 0&&Qe.length!==qe.length)throw new Error("if indices is specified, traces.length must equal indices.length")}(ge,we,Me),Array.isArray(we)||(we=[we]),we=we.map(function(We){return p.extendFlat({},We)}),_.cleanData(we),Se=0;Se<we.length;Se++)ge.data.push(we[Se]);for(Se=0;Se<we.length;Se++)Fe.push(-we.length+Se);if(Me===void 0)return ze=B.redraw(ge),u.add(ge,Ye,Oe,rt,je),ze;Array.isArray(Me)||(Me=[Me]);try{D(ge,Fe,Me)}catch(We){throw ge.data.splice(ge.data.length-we.length,we.length),We}return u.startSequence(ge),u.add(ge,Ye,Oe,rt,je),ze=B.moveTraces(ge,Fe,Me),u.stopSequence(ge),ze},B.deleteTraces=function ce(ge,we){ge=p.getGraphDiv(ge);var Me,Se,ze=[],Fe=B.addTraces,Ye=ce,rt=[ge,ze,we],Oe=[ge,we];if(we===void 0)throw new Error("indices must be an integer or array of integers.");for(Array.isArray(we)||(we=[we]),P(ge,we,"indices"),(we=M(we,ge.data.length-1)).sort(p.sorterDes),Me=0;Me<we.length;Me+=1)Se=ge.data.splice(we[Me],1)[0],ze.push(Se);var je=B.redraw(ge);return u.add(ge,Fe,rt,Ye,Oe),je},B.extendTraces=function ce(ge,we,Me,Se){function ze(Oe,je,We){var qe,Qe;if(p.isTypedArray(Oe))if(We<0){var st=new Oe.constructor(0),ct=U(Oe,je);We<0?(qe=ct,Qe=st):(qe=st,Qe=ct)}else if(qe=new Oe.constructor(We),Qe=new Oe.constructor(Oe.length+je.length-We),We===je.length)qe.set(je),Qe.set(Oe);else if(We<je.length){var Pt=je.length-We;qe.set(je.subarray(Pt)),Qe.set(Oe),Qe.set(je.subarray(0,Pt),Oe.length)}else{var kt=We-je.length,at=Oe.length-kt;qe.set(Oe.subarray(at)),qe.set(je,kt),Qe.set(Oe.subarray(0,at))}else qe=Oe.concat(je),Qe=We>=0&&We<qe.length?qe.splice(0,qe.length-We):[];return[qe,Qe]}var Fe=N(ge=p.getGraphDiv(ge),we,Me,Se,ze),Ye=B.redraw(ge),rt=[ge,Fe.update,Me,Fe.maxPoints];return u.add(ge,B.prependTraces,rt,ce,arguments),Ye},B.moveTraces=function ce(ge,we,Me){var Se,ze=[],Fe=[],Ye=ce,rt=ce,Oe=[ge=p.getGraphDiv(ge),Me,we],je=[ge,we,Me];if(D(ge,we,Me),we=Array.isArray(we)?we:[we],Me===void 0)for(Me=[],Se=0;Se<we.length;Se++)Me.push(-we.length+Se);for(Me=Array.isArray(Me)?Me:[Me],we=M(we,ge.data.length-1),Me=M(Me,ge.data.length-1),Se=0;Se<ge.data.length;Se++)we.indexOf(Se)===-1&&ze.push(ge.data[Se]);for(Se=0;Se<we.length;Se++)Fe.push({newIndex:Me[Se],trace:ge.data[we[Se]]});for(Fe.sort(function(qe,Qe){return qe.newIndex-Qe.newIndex}),Se=0;Se<Fe.length;Se+=1)ze.splice(Fe[Se].newIndex,0,Fe[Se].trace);ge.data=ze;var We=B.redraw(ge);return u.add(ge,Ye,Oe,rt,je),We},B.prependTraces=function ce(ge,we,Me,Se){function ze(Oe,je,We){var qe,Qe;if(p.isTypedArray(Oe))if(We<=0){var st=new Oe.constructor(0),ct=U(je,Oe);We<0?(qe=ct,Qe=st):(qe=st,Qe=ct)}else if(qe=new Oe.constructor(We),Qe=new Oe.constructor(Oe.length+je.length-We),We===je.length)qe.set(je),Qe.set(Oe);else if(We<je.length){var Pt=je.length-We;qe.set(je.subarray(0,Pt)),Qe.set(je.subarray(Pt)),Qe.set(Oe,Pt)}else{var kt=We-je.length;qe.set(je),qe.set(Oe.subarray(0,kt),je.length),Qe.set(Oe.subarray(kt))}else qe=je.concat(Oe),Qe=We>=0&&We<qe.length?qe.splice(We,qe.length):[];return[qe,Qe]}var Fe=N(ge=p.getGraphDiv(ge),we,Me,Se,ze),Ye=B.redraw(ge),rt=[ge,Fe.update,Me,Fe.maxPoints];return u.add(ge,B.extendTraces,rt,ce,arguments),Ye},B.newPlot=function(ce,ge,we,Me){return ce=p.getGraphDiv(ce),o.cleanPlot([],{},ce._fullData||[],ce._fullLayout||{}),o.purge(ce),B._doPlot(ce,ge,we,Me)},B._doPlot=function(ce,ge,we,Me){var Se;if(ce=p.getGraphDiv(ce),f.init(ce),p.isPlainObject(ge)){var ze=ge;ge=ze.data,we=ze.layout,Me=ze.config,Se=ze.frames}if(f.triggerHandler(ce,"plotly_beforeplot",[ge,we,Me])===!1)return Promise.reject();ge||we||p.isPlotDiv(ce)||p.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",ce),L(ce,Me),we||(we={}),t.select(ce).classed("js-plotly-plot",!0),c.makeTester(),Array.isArray(ce._promises)||(ce._promises=[]);var Fe=(ce.data||[]).length===0&&Array.isArray(ge);Array.isArray(ge)&&(_.cleanData(ge),Fe?ce.data=ge:ce.data.push.apply(ce.data,ge),ce.empty=!1),ce.layout&&!Fe||(ce.layout=_.cleanLayout(we)),o.supplyDefaults(ce);var Ye=ce._fullLayout,rt=Ye._has("cartesian");Ye._replotting=!0,(Fe||Ye._shouldCreateBgLayer)&&(function(kt){var at=t.select(kt),tt=kt._fullLayout;if(tt._calcInverseTransform=xe,tt._calcInverseTransform(kt),tt._container=at.selectAll(".plot-container").data([0]),tt._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),tt._paperdiv=tt._container.selectAll(".svg-container").data([0]),tt._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),tt._glcontainer=tt._paperdiv.selectAll(".gl-container").data([{}]),tt._glcontainer.enter().append("div").classed("gl-container",!0),tt._paperdiv.selectAll(".main-svg").remove(),tt._paperdiv.select(".modebar-container").remove(),tt._paper=tt._paperdiv.insert("svg",":first-child").classed("main-svg",!0),tt._toppaper=tt._paperdiv.append("svg").classed("main-svg",!0),tt._modebardiv=tt._paperdiv.append("div"),delete tt._modeBar,tt._hoverpaper=tt._paperdiv.append("svg").classed("main-svg",!0),!tt._uid){var _t={};t.selectAll("defs").each(function(){this.id&&(_t[this.id.split("-")[1]]=1)}),tt._uid=p.randstr(_t)}tt._paperdiv.selectAll(".main-svg").attr(g.svgAttrs),tt._defs=tt._paper.append("defs").attr("id","defs-"+tt._uid),tt._clips=tt._defs.append("g").classed("clips",!0),tt._topdefs=tt._toppaper.append("defs").attr("id","topdefs-"+tt._uid),tt._topclips=tt._topdefs.append("g").classed("clips",!0),tt._bgLayer=tt._paper.append("g").classed("bglayer",!0),tt._draggers=tt._paper.append("g").classed("draglayer",!0);var er=tt._paper.append("g").classed("layer-below",!0);tt._imageLowerLayer=er.append("g").classed("imagelayer",!0),tt._shapeLowerLayer=er.append("g").classed("shapelayer",!0),tt._cartesianlayer=tt._paper.append("g").classed("cartesianlayer",!0),tt._polarlayer=tt._paper.append("g").classed("polarlayer",!0),tt._ternarylayer=tt._paper.append("g").classed("ternarylayer",!0),tt._geolayer=tt._paper.append("g").classed("geolayer",!0),tt._funnelarealayer=tt._paper.append("g").classed("funnelarealayer",!0),tt._pielayer=tt._paper.append("g").classed("pielayer",!0),tt._iciclelayer=tt._paper.append("g").classed("iciclelayer",!0),tt._treemaplayer=tt._paper.append("g").classed("treemaplayer",!0),tt._sunburstlayer=tt._paper.append("g").classed("sunburstlayer",!0),tt._indicatorlayer=tt._toppaper.append("g").classed("indicatorlayer",!0),tt._glimages=tt._paper.append("g").classed("glimages",!0);var tr=tt._toppaper.append("g").classed("layer-above",!0);tt._imageUpperLayer=tr.append("g").classed("imagelayer",!0),tt._shapeUpperLayer=tr.append("g").classed("shapelayer",!0),tt._infolayer=tt._toppaper.append("g").classed("infolayer",!0),tt._menulayer=tt._toppaper.append("g").classed("menulayer",!0),tt._zoomlayer=tt._toppaper.append("g").classed("zoomlayer",!0),tt._hoverlayer=tt._hoverpaper.append("g").classed("hoverlayer",!0),tt._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),kt.emit("plotly_framework")}(ce),Ye._shouldCreateBgLayer&&delete Ye._shouldCreateBgLayer),c.initGradients(ce),c.initPatterns(ce),Fe&&i.saveShowSpikeInitial(ce);var Oe=!ce.calcdata||ce.calcdata.length!==(ce._fullData||[]).length;Oe&&o.doCalcdata(ce);for(var je=0;je<ce.calcdata.length;je++)ce.calcdata[je][0].trace=ce._fullData[je];ce._context.responsive?ce._responsiveChartHandler||(ce._responsiveChartHandler=function(){p.isHidden(ce)||o.resize(ce)},window.addEventListener("resize",ce._responsiveChartHandler)):p.clearResponsive(ce);var We=p.extendFlat({},Ye._size),qe=0;function Qe(){if(o.clearAutoMarginIds(ce),x.drawMarginPushers(ce),i.allowAutoMargin(ce),Ye._has("pie"))for(var kt=ce._fullData,at=0;at<kt.length;at++){var tt=kt[at];tt.type==="pie"&&tt.automargin&&o.allowAutoMargin(ce,"pie."+tt.uid+".automargin")}return o.doAutoMargin(ce),o.previousPromises(ce)}function st(){ce._transitioning||(x.doAutoRangeAndConstraints(ce),Fe&&i.saveRangeInitial(ce),s.getComponentMethod("rangeslider","calcAutorange")(ce))}var ct=[o.previousPromises,function(){if(Se)return B.addFrames(ce,Se)},function kt(){for(var at=Ye._basePlotModules,tt=0;tt<at.length;tt++)at[tt].drawFramework&&at[tt].drawFramework(ce);!Ye._glcanvas&&Ye._has("gl")&&(Ye._glcanvas=Ye._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(Ue){return Ue.key}),Ye._glcanvas.enter().append("canvas").attr("class",function(Ue){return"gl-canvas gl-canvas-"+Ue.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var _t=ce._context.plotGlPixelRatio;if(Ye._glcanvas){Ye._glcanvas.attr("width",Ye.width*_t).attr("height",Ye.height*_t).style("width",Ye.width+"px").style("height",Ye.height+"px");var er=Ye._glcanvas.data()[0].regl;if(er&&(Math.floor(Ye.width*_t)!==er._gl.drawingBufferWidth||Math.floor(Ye.height*_t)!==er._gl.drawingBufferHeight)){var tr="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(!qe)return p.log(tr+" Clearing graph and plotting again."),o.cleanPlot([],{},ce._fullData,Ye),o.supplyDefaults(ce),Ye=ce._fullLayout,o.doCalcdata(ce),qe++,kt();p.error(tr)}}return Ye.modebar.orientation==="h"?Ye._modebardiv.style("height",null).style("width","100%"):Ye._modebardiv.style("width",null).style("height",Ye.height+"px"),o.previousPromises(ce)},Qe,function(){if(o.didMarginChange(We,Ye._size))return p.syncOrAsync([Qe,x.layoutStyles],ce)}];rt&&ct.push(function(){if(Oe)return p.syncOrAsync([s.getComponentMethod("shapes","calcAutorange"),s.getComponentMethod("annotations","calcAutorange"),st],ce);st()}),ct.push(x.layoutStyles),rt&&ct.push(function(){return i.draw(ce,Fe?"":"redraw")},function(kt){kt._fullLayout._insideTickLabelsAutorange&&$(kt,kt._fullLayout._insideTickLabelsAutorange).then(function(){kt._fullLayout._insideTickLabelsAutorange=void 0})}),ct.push(x.drawData,x.finalDraw,a,o.addLinks,o.rehover,o.redrag,o.doAutoMargin,function(kt){kt._fullLayout._insideTickLabelsAutorange&&Fe&&i.saveRangeInitial(kt,!0)},o.previousPromises);var Pt=p.syncOrAsync(ct,ce);return Pt&&Pt.then||(Pt=Promise.resolve()),Pt.then(function(){return w(ce),ce})},B.purge=function(ce){var ge=(ce=p.getGraphDiv(ce))._fullLayout||{},we=ce._fullData||[];return o.cleanPlot([],{},we,ge),o.purge(ce),f.purge(ce),ge._container&&ge._container.remove(),delete ce._context,ce},B.react=function(ce,ge,we,Me){var Se,ze;ce=p.getGraphDiv(ce),_.clearPromiseQueue(ce);var Fe=ce._fullData,Ye=ce._fullLayout;if(p.isPlotDiv(ce)&&Fe&&Ye){if(p.isPlainObject(ge)){var rt=ge;ge=rt.data,we=rt.layout,Me=rt.config,Se=rt.frames}var Oe=!1;if(Me){var je=p.extendDeep({},ce._context);ce._context=void 0,L(ce,Me),Oe=function Le(Pe,Xe){var ht;for(ht in Pe)if(ht.charAt(0)!=="_"){var Mt=Pe[ht],pt=Xe[ht];if(Mt!==pt)if(p.isPlainObject(Mt)&&p.isPlainObject(pt)){if(Le(Mt,pt))return!0}else{if(!Array.isArray(Mt)||!Array.isArray(pt)||Mt.length!==pt.length)return!0;for(var Lt=0;Lt<Mt.length;Lt++)if(Mt[Lt]!==pt[Lt]&&(!p.isPlainObject(Mt[Lt])||!p.isPlainObject(pt[Lt])||Le(Mt[Lt],pt[Lt])))return!0}}}(je,ce._context)}ce.data=ge||[],_.cleanData(ce.data),ce.layout=we||{},_.cleanLayout(ce.layout),function(Le,Pe,Xe,ht){var Mt,pt,Lt,vt,Dt,xt,it,St,Nt=ht._preGUI,Ut=[],Qt={};for(Mt in Nt){if(Dt=de(Mt,he)){if(pt=Dt.attr||Dt.head+".uirevision",(vt=(Lt=e(ht,pt).get())&&ue(pt,Pe))&&vt===Lt&&((xt=Nt[Mt])===null&&(xt=void 0),Ee(St=(it=e(Pe,Mt)).get(),xt))){St===void 0&&Mt.substr(Mt.length-9)==="autorange"&&Ut.push(Mt.substr(0,Mt.length-10)),it.set(X(e(ht,Mt).get()));continue}}else p.warn("unrecognized GUI edit: "+Mt);delete Nt[Mt],Mt.substr(Mt.length-8,6)==="range["&&(Qt[Mt.substr(0,Mt.length-9)]=1)}for(var Ie=0;Ie<Ut.length;Ie++){var lt=Ut[Ie];if(Qt[lt]){var wt=e(Pe,lt).get();wt&&delete wt.autorange}}var Ot=ht._tracePreGUI;for(var Gt in Ot){var ir,Xt=Ot[Gt],Kt=null;for(Mt in Xt){if(!Kt){var or=ve(Gt,Xe);if(or<0){delete Ot[Gt];break}var dr=ke(Gt,Le,(ir=Xe[or]._fullInput).index);if(dr<0){delete Ot[Gt];break}Kt=Le[dr]}if(Dt=de(Mt,se)){if(Dt.attr?vt=(Lt=e(ht,Dt.attr).get())&&ue(Dt.attr,Pe):(Lt=ir.uirevision,(vt=Kt.uirevision)===void 0&&(vt=Pe.uirevision)),vt&&vt===Lt&&((xt=Xt[Mt])===null&&(xt=void 0),Ee(St=(it=e(Kt,Mt)).get(),xt))){it.set(X(e(ir,Mt).get()));continue}}else p.warn("unrecognized GUI edit: "+Mt+" in trace uid "+Gt);delete Xt[Mt]}}}(ce.data,ce.layout,Fe,Ye),o.supplyDefaults(ce,{skipUpdateCalc:!0});var We=ce._fullData,qe=ce._fullLayout,Qe=qe.datarevision===void 0,st=qe.transition,ct=function(Le,Pe,Xe,ht,Mt){var pt=T.layoutFlags();function Lt(vt){return l.getLayoutValObject(Xe,vt)}return pt.arrays={},pt.rangesAltered={},pt.nChanges=0,pt.nChangesAnim=0,be(Pe,Xe,[],{getValObject:Lt,flags:pt,immutable:ht,transition:Mt,gd:Le}),(pt.plot||pt.calc)&&(pt.layoutReplot=!0),Mt&&pt.nChanges&&pt.nChangesAnim&&(pt.anim=pt.nChanges===pt.nChangesAnim?"all":"some"),pt}(ce,Ye,qe,Qe,st),Pt=ct.newDataRevision,kt=function(Le,Pe,Xe,ht,Mt,pt){var Lt=Pe.length===Xe.length;if(!Mt&&!Lt)return{fullReplot:!0,calc:!0};var vt,Dt,xt=T.traceFlags();xt.arrays={},xt.nChanges=0,xt.nChangesAnim=0;var it={getValObject:function(Nt){var Ut=l.getTraceValObject(Dt,Nt);return!Dt._module.animatable&&Ut.anim&&(Ut.anim=!1),Ut},flags:xt,immutable:ht,transition:Mt,newDataRevision:pt,gd:Le},St={};for(vt=0;vt<Pe.length;vt++)if(Xe[vt]){if(Dt=Xe[vt]._fullInput,o.hasMakesDataTransform(Dt)&&(Dt=Xe[vt]),St[Dt.uid])continue;St[Dt.uid]=1,be(Pe[vt]._fullInput,Dt,[],it)}return(xt.calc||xt.plot)&&(xt.fullReplot=!0),Mt&&xt.nChanges&&xt.nChangesAnim&&(xt.anim=xt.nChanges===xt.nChangesAnim&&Lt?"all":"some"),xt}(ce,Fe,We,Qe,st,Pt);if(te(ce)&&(ct.layoutReplot=!0),kt.calc||ct.calc){ce.calcdata=void 0;for(var at=Object.getOwnPropertyNames(qe),tt=0;tt<at.length;tt++){var _t=at[tt],er=_t.substring(0,5);if(er==="xaxis"||er==="yaxis"){var tr=qe[_t]._emptyCategories;tr&&tr()}}}else o.supplyDefaultsUpdateCalc(ce.calcdata,We);var Ue=[];if(Se&&(ce._transitionData={},o.createTransitionData(ce),Ue.push(function(){return B.addFrames(ce,Se)})),qe.transition&&!Oe&&(kt.anim||ct.anim))ct.ticks&&Ue.push(x.doTicksRelayout),o.doCalcdata(ce),x.doAutoRangeAndConstraints(ce),Ue.push(function(){return o.transitionFromReact(ce,kt,ct,Ye)});else if(kt.fullReplot||ct.layoutReplot||Oe)ce._fullLayout._skipDefaults=!0,Ue.push(B._doPlot);else{for(var He in ct.arrays){var Be=ct.arrays[He];if(Be.length){var Ke=s.getComponentMethod(He,"drawOne");if(Ke!==p.noop)for(var _e=0;_e<Be.length;_e++)Ke(ce,Be[_e]);else{var Ce=s.getComponentMethod(He,"draw");if(Ce===p.noop)throw new Error("cannot draw components: "+He);Ce(ce)}}}Ue.push(o.previousPromises),kt.style&&Ue.push(x.doTraceStyle),(kt.colorbars||ct.colorbars)&&Ue.push(x.doColorBars),ct.legend&&Ue.push(x.doLegend),ct.layoutstyle&&Ue.push(x.layoutStyles),ct.axrange&&j(Ue),ct.ticks&&Ue.push(x.doTicksRelayout),ct.modebar&&Ue.push(x.doModeBar),ct.camera&&Ue.push(x.doCamera),Ue.push(w)}Ue.push(o.rehover,o.redrag),(ze=p.syncOrAsync(Ue,ce))&&ze.then||(ze=Promise.resolve(ce))}else ze=B.newPlot(ce,ge,we,Me);return ze.then(function(){return ce.emit("plotly_react",{data:ge,layout:we}),ce})},B.redraw=function(ce){if(ce=p.getGraphDiv(ce),!p.isPlotDiv(ce))throw new Error("This element is not a Plotly plot: "+ce);return _.cleanData(ce.data),_.cleanLayout(ce.layout),ce.calcdata=void 0,B._doPlot(ce).then(function(){return ce.emit("plotly_redraw"),ce})},B.relayout=$,B.restyle=q,B.setPlotConfig=function(ce){return p.extendFlat(y,ce)},B.update=ie,B._guiRelayout=ae($),B._guiRestyle=ae(q),B._guiUpdate=ae(ie),B._storeDirectGUIEdit=function(ce,ge,we){for(var Me in we)Z(Me,e(ce,Me).get(),we[Me],ge)}},{"../components/color":650,"../components/drawing":672,"../constants/xmlns_namespaces":764,"../lib":787,"../lib/events":776,"../lib/queue":803,"../plots/cartesian/axes":838,"../plots/cartesian/constants":845,"../plots/cartesian/graph_interact":848,"../plots/cartesian/select":858,"../plots/plots":901,"../registry":915,"./edit_types":820,"./helpers":821,"./manage_arrays":823,"./plot_config":825,"./plot_schema":826,"./subroutines":828,"@plotly/d3":58,"fast-isnumeric":246,"has-hover":435}],825:[function(r,O,B){var t={staticPlot:{valType:"boolean",dflt:!1},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},d={};(function m(p,e){for(var f in p){var u=p[f];u.valType?e[f]=u.dflt:(e[f]||(e[f]={}),m(u,e[f]))}})(t,d),O.exports={configAttributes:t,dfltConfig:d}},{}],826:[function(r,O,B){var t=r("../registry"),d=r("../lib"),m=r("../plots/attributes"),p=r("../plots/layout_attributes"),e=r("../plots/frame_attributes"),f=r("../plots/animation_attributes"),u=r("./plot_config").configAttributes,s=r("./edit_types"),l=d.extendDeepAll,o=d.isPlainObject,i=d.isArrayOrTypedArray,c=d.nestedProperty,n=d.valObjectMeta,a=["_isSubplotObj","_isLinkedToArray","_arrayAttrRegexps","_deprecated"];function g(A,S,w){if(!A)return!1;if(A._isLinkedToArray){if(h(S[w]))w++;else if(w<S.length)return!1}for(;w<S.length;w++){var C=A[S[w]];if(!o(C)||(A=C,w===S.length-1))break;if(A._isLinkedToArray){if(!h(S[++w]))return!1}else if(A.valType==="info_array"){var k=S[++w];if(!h(k))return!1;var L=A.items;if(Array.isArray(L)){if(k>=L.length)return!1;if(A.dimensions===2){if(w++,S.length===w)return A;var M=S[w];if(!h(M))return!1;A=L[k][M]}else A=L[k]}else A=L}}return A}function h(A){return A===Math.round(A)&&A>=0}function y(){var A,S,w={};for(A in l(w,p),t.subplotsRegistry)if((S=t.subplotsRegistry[A]).layoutAttributes)if(Array.isArray(S.attr))for(var C=0;C<S.attr.length;C++)x(w,S,S.attr[C]);else x(w,S,S.attr==="subplot"?S.name:S.attr);for(A in t.componentsRegistry){var k=(S=t.componentsRegistry[A]).schema;if(k&&(k.subplots||k.layout)){var L=k.subplots;if(L&&L.xaxis&&!L.yaxis)for(var M in L.xaxis)delete w.yaxis[M]}else S.name==="colorscale"?l(w,S.layoutAttributes):S.layoutAttributes&&T(w,S.layoutAttributes,S.name)}return{layoutAttributes:_(w)}}function v(){var A={frames:l({},e)};return _(A),A.frames}function _(A){return function(S){B.crawl(S,function(w,C,k){B.isValObject(w)?w.arrayOk!==!0&&w.valType!=="data_array"||(k[C+"src"]={valType:"string",editType:"none"}):o(w)&&(w.role="object")})}(A),function(S){B.crawl(S,function(w,C,k){if(w){var L=w._isLinkedToArray;L&&(delete w._isLinkedToArray,k[C]={items:{}},k[C].items[L]=w,k[C].role="object")}})}(A),function(S){(function w(C){for(var k in C)if(o(C[k]))w(C[k]);else if(Array.isArray(C[k]))for(var L=0;L<C[k].length;L++)w(C[k][L]);else C[k]instanceof RegExp&&(C[k]=C[k].toString())})(S)}(A),A}function x(A,S,w){var C=c(A,w),k=l({},S.layoutAttributes);k._isSubplotObj=!0,C.set(k)}function T(A,S,w){var C=c(A,w);C.set(l(C.get()||{},S))}B.IS_SUBPLOT_OBJ="_isSubplotObj",B.IS_LINKED_TO_ARRAY="_isLinkedToArray",B.DEPRECATED="_deprecated",B.UNDERSCORE_ATTRS=a,B.get=function(){var A={};t.allTypes.forEach(function(w){A[w]=function(C){var k,L;k=t.modules[C]._module,L=k.basePlotModule;var M={type:null},P=l({},m),D=l({},k.attributes);B.crawl(D,function(q,X,K,Z,H){c(P,H).set(void 0),q===void 0&&c(D,H).set(void 0)}),l(M,P),t.traceIs(C,"noOpacity")&&delete M.opacity,t.traceIs(C,"showLegend")||(delete M.showlegend,delete M.legendgroup),t.traceIs(C,"noHover")&&(delete M.hoverinfo,delete M.hoverlabel),k.selectPoints||delete M.selectedpoints,l(M,D),L.attributes&&l(M,L.attributes),M.type=C;var N={meta:k.meta||{},categories:k.categories||{},animatable:Boolean(k.animatable),type:C,attributes:_(M)};if(k.layoutAttributes){var U={};l(U,k.layoutAttributes),N.layoutAttributes=_(U)}return k.animatable||B.crawl(N,function(q){B.isValObject(q)&&"anim"in q&&delete q.anim}),N}(w)});var S={};return Object.keys(t.transformsRegistry).forEach(function(w){S[w]=function(C){var k=t.transformsRegistry[C],L=l({},k.attributes);return Object.keys(t.componentsRegistry).forEach(function(M){var P=t.componentsRegistry[M];P.schema&&P.schema.transforms&&P.schema.transforms[C]&&Object.keys(P.schema.transforms[C]).forEach(function(D){T(L,P.schema.transforms[C][D],D)})}),{attributes:_(L)}}(w)}),{defs:{valObjects:n,metaKeys:a.concat(["description","role","editType","impliedEdits"]),editType:{traces:s.traces,layout:s.layout},impliedEdits:{}},traces:A,layout:y(),transforms:S,frames:v(),animation:_(f),config:_(u)}},B.crawl=function(A,S,w,C){var k=w||0;C=C||"",Object.keys(A).forEach(function(L){var M=A[L];if(a.indexOf(L)===-1){var P=(C?C+".":"")+L;S(M,L,A,k,P),B.isValObject(M)||o(M)&&L!=="impliedEdits"&&B.crawl(M,S,k+1,P)}})},B.isValObject=function(A){return A&&A.valType!==void 0},B.findArrayAttributes=function(A){var S,w,C=[],k=[],L=[];function M(q,X,K,Z){k=k.slice(0,Z).concat([X]),L=L.slice(0,Z).concat([q&&q._isLinkedToArray]),q&&(q.valType==="data_array"||q.arrayOk===!0)&&!(k[Z-1]==="colorbar"&&(X==="ticktext"||X==="tickvals"))&&function H(Y,$,z){var j=Y[k[$]],W=z+k[$];if($===k.length-1)i(j)&&C.push(w+W);else if(L[$]){if(Array.isArray(j))for(var ee=0;ee<j.length;ee++)o(j[ee])&&H(j[ee],$+1,W+"["+ee+"].")}else o(j)&&H(j,$+1,W+".")}(S,0,"")}S=A,w="",B.crawl(m,M),A._module&&A._module.attributes&&B.crawl(A._module.attributes,M);var P=A.transforms;if(P)for(var D=0;D<P.length;D++){var N=P[D],U=N._module;U&&(w="transforms["+D+"].",S=N,B.crawl(U.attributes,M))}return C},B.getTraceValObject=function(A,S){var w,C,k=S[0],L=1;if(k==="transforms"){if(S.length===1)return m.transforms;var M=A.transforms;if(!Array.isArray(M)||!M.length)return!1;var P=S[1];if(!h(P)||P>=M.length)return!1;C=(w=(t.transformsRegistry[M[P].type]||{}).attributes)&&w[S[2]],L=3}else{var D=A._module;if(D||(D=(t.modules[A.type||m.type.dflt]||{})._module),!D)return!1;if(!(C=(w=D.attributes)&&w[k])){var N=D.basePlotModule;N&&N.attributes&&(C=N.attributes[k])}C||(C=m[k])}return g(C,S,L)},B.getLayoutValObject=function(A,S){return g(function(w,C){var k,L,M,P,D=w._basePlotModules;if(D){var N;for(k=0;k<D.length;k++){if((M=D[k]).attrRegex&&M.attrRegex.test(C)){if(M.layoutAttrOverrides)return M.layoutAttrOverrides;!N&&M.layoutAttributes&&(N=M.layoutAttributes)}var U=M.baseLayoutAttrOverrides;if(U&&C in U)return U[C]}if(N)return N}var q=w._modules;if(q){for(k=0;k<q.length;k++)if((P=q[k].layoutAttributes)&&C in P)return P[C]}for(L in t.componentsRegistry){if((M=t.componentsRegistry[L]).name==="colorscale"&&C.indexOf("coloraxis")===0)return M.layoutAttributes[C];if(!M.schema&&C===M.name)return M.layoutAttributes}return C in p&&p[C]}(A,S[0]),S,1)}},{"../lib":787,"../plots/animation_attributes":832,"../plots/attributes":834,"../plots/frame_attributes":868,"../plots/layout_attributes":892,"../registry":915,"./edit_types":820,"./plot_config":825}],827:[function(r,O,B){var t=r("../lib"),d=r("../plots/attributes"),m={name:{valType:"string",editType:"none"}};function p(f){return f&&typeof f=="string"}function e(f){var u=f.length-1;return f.charAt(u)!=="s"&&t.warn("bad argument to arrayDefaultKey: "+f),f.substr(0,f.length-1)+"defaults"}m.templateitemname={valType:"string",editType:"calc"},B.templatedArray=function(f,u){return u._isLinkedToArray=f,u.name=m.name,u.templateitemname=m.templateitemname,u},B.traceTemplater=function(f){var u,s,l={};for(u in f)s=f[u],Array.isArray(s)&&s.length&&(l[u]=0);return{newTrace:function(o){var i={type:u=t.coerce(o,{},d,"type"),_template:null};if(u in l){s=f[u];var c=l[u]%s.length;l[u]++,i._template=s[c]}return i}}},B.newContainer=function(f,u,s){var l=f._template,o=l&&(l[u]||s&&l[s]);return t.isPlainObject(o)||(o=null),f[u]={_template:o}},B.arrayTemplater=function(f,u,s){var l=f._template,o=l&&l[e(u)],i=l&&l[u];Array.isArray(i)&&i.length||(i=[]);var c={};return{newItem:function(n){var a={name:n.name,_input:n},g=a.templateitemname=n.templateitemname;if(!p(g))return a._template=o,a;for(var h=0;h<i.length;h++){var y=i[h];if(y.name===g)return c[g]=1,a._template=y,a}return a[s]=n[s]||!1,a._template=!1,a},defaultItems:function(){for(var n=[],a=0;a<i.length;a++){var g=i[a],h=g.name;if(p(h)&&!c[h]){var y={_template:g,name:h,_input:{_templateitemname:h}};y.templateitemname=g.templateitemname,n.push(y),c[h]=1}}return n}}},B.arrayDefaultKey=e,B.arrayEditor=function(f,u,s){var l=(t.nestedProperty(f,u).get()||[]).length,o=s._index,i=o>=l&&(s._input||{})._templateitemname;i&&(o=l);var c,n=u+"["+o+"]";function a(){c={},i&&(c[n]={},c[n].templateitemname=i)}function g(y,v){i?t.nestedProperty(c[n],y).set(v):c[n+"."+y]=v}function h(){var y=c;return a(),y}return a(),{modifyBase:function(y,v){c[y]=v},modifyItem:g,getUpdateObj:h,applyUpdate:function(y,v){y&&g(y,v);var _=h();for(var x in _)t.nestedProperty(f,x).set(_[x])}}}},{"../lib":787,"../plots/attributes":834}],828:[function(r,O,B){var t=r("@plotly/d3"),d=r("../registry"),m=r("../plots/plots"),p=r("../lib"),e=r("../lib/clear_gl_canvases"),f=r("../components/color"),u=r("../components/drawing"),s=r("../components/titles"),l=r("../components/modebar"),o=r("../plots/cartesian/axes"),i=r("../constants/alignment"),c=r("../plots/cartesian/constraints"),n=c.enforce,a=c.clean,g=r("../plots/cartesian/autorange").doAutoRange;function h(S,w,C){for(var k=0;k<C.length;k++){var L=C[k][0],M=C[k][1];if(!(L[0]>=S[1]||L[1]<=S[0])&&M[0]<w[1]&&M[1]>w[0])return!0}return!1}function y(S){var w,C,k,L,M,P,D=S._fullLayout,N=D._size,U=N.p,q=o.list(S,"",!0);if(D._paperdiv.style({width:S._context.responsive&&D.autosize&&!S._context._hasZeroWidth&&!S.layout.width?"100%":D.width+"px",height:S._context.responsive&&D.autosize&&!S._context._hasZeroHeight&&!S.layout.height?"100%":D.height+"px"}).selectAll(".main-svg").call(u.setSize,D.width,D.height),S._context.setBackground(S,D.paper_bgcolor),B.drawMainTitle(S),l.manage(S),!D._has("cartesian"))return m.previousPromises(S);function X(qe,Qe,st){var ct=qe._lw/2;return qe._id.charAt(0)==="x"?Qe?st==="top"?Qe._offset-U-ct:Qe._offset+Qe._length+U+ct:N.t+N.h*(1-(qe.position||0))+ct%1:Qe?st==="right"?Qe._offset+Qe._length+U+ct:Qe._offset-U-ct:N.l+N.w*(qe.position||0)+ct%1}for(w=0;w<q.length;w++){var K=(L=q[w])._anchorAxis;L._linepositions={},L._lw=u.crispRound(S,L.linewidth,1),L._mainLinePosition=X(L,K,L.side),L._mainMirrorPosition=L.mirror&&K?X(L,K,i.OPPOSITE_SIDE[L.side]):null}var Z=[],H=[],Y=[],$=f.opacity(D.paper_bgcolor)===1&&f.opacity(D.plot_bgcolor)===1&&D.paper_bgcolor===D.plot_bgcolor;for(C in D._plots)if((k=D._plots[C]).mainplot)k.bg&&k.bg.remove(),k.bg=void 0;else{var z=k.xaxis.domain,j=k.yaxis.domain,W=k.plotgroup;if(h(z,j,Y)){var ee=W.node(),J=k.bg=p.ensureSingle(W,"rect","bg");ee.insertBefore(J.node(),ee.childNodes[0]),H.push(C)}else W.select("rect.bg").remove(),Y.push([z,j]),$||(Z.push(C),H.push(C))}var Q,te,ie,ae,he,se,de,ue,ve,ke,Ee,be,xe,ce=D._bgLayer.selectAll(".bg").data(Z);for(ce.enter().append("rect").classed("bg",!0),ce.exit().remove(),ce.each(function(qe){D._plots[qe].bg=t.select(this)}),w=0;w<H.length;w++)k=D._plots[H[w]],M=k.xaxis,P=k.yaxis,k.bg&&M._offset!==void 0&&P._offset!==void 0&&k.bg.call(u.setRect,M._offset-U,P._offset-U,M._length+2*U,P._length+2*U).call(f.fill,D.plot_bgcolor).style("stroke-width",0);if(!D._hasOnlyLargeSploms)for(C in D._plots){k=D._plots[C],M=k.xaxis,P=k.yaxis;var ge,we,Me=k.clipId="clip"+D._uid+C+"plot",Se=p.ensureSingleById(D._clips,"clipPath",Me,function(qe){qe.classed("plotclip",!0).append("rect")});k.clipRect=Se.select("rect").attr({width:M._length,height:P._length}),u.setTranslate(k.plot,M._offset,P._offset),k._hasClipOnAxisFalse?(ge=null,we=Me):(ge=Me,we=null),u.setClipUrl(k.plot,ge,S),k.layerClipId=we}function ze(qe){return"M"+Q+","+qe+"H"+te}function Fe(qe){return"M"+M._offset+","+qe+"h"+M._length}function Ye(qe){return"M"+qe+","+ue+"V"+de}function rt(qe){return"M"+qe+","+P._offset+"v"+P._length}function Oe(qe,Qe,st){if(!qe.showline||C!==qe._mainSubplot)return"";if(!qe._anchorAxis)return st(qe._mainLinePosition);var ct=Qe(qe._mainLinePosition);return qe.mirror&&(ct+=Qe(qe._mainMirrorPosition)),ct}for(C in D._plots){k=D._plots[C],M=k.xaxis,P=k.yaxis;var je="M0,0";v(M,C)&&(he=x(M,"left",P,q),Q=M._offset-(he?U+he:0),se=x(M,"right",P,q),te=M._offset+M._length+(se?U+se:0),ie=X(M,P,"bottom"),ae=X(M,P,"top"),!(xe=!M._anchorAxis||C!==M._mainSubplot)||M.mirror!=="allticks"&&M.mirror!=="all"||(M._linepositions[C]=[ie,ae]),je=Oe(M,ze,Fe),xe&&M.showline&&(M.mirror==="all"||M.mirror==="allticks")&&(je+=ze(ie)+ze(ae)),k.xlines.style("stroke-width",M._lw+"px").call(f.stroke,M.showline?M.linecolor:"rgba(0,0,0,0)")),k.xlines.attr("d",je);var We="M0,0";v(P,C)&&(Ee=x(P,"bottom",M,q),de=P._offset+P._length+(Ee?U:0),be=x(P,"top",M,q),ue=P._offset-(be?U:0),ve=X(P,M,"left"),ke=X(P,M,"right"),!(xe=!P._anchorAxis||C!==P._mainSubplot)||P.mirror!=="allticks"&&P.mirror!=="all"||(P._linepositions[C]=[ve,ke]),We=Oe(P,Ye,rt),xe&&P.showline&&(P.mirror==="all"||P.mirror==="allticks")&&(We+=Ye(ve)+Ye(ke)),k.ylines.style("stroke-width",P._lw+"px").call(f.stroke,P.showline?P.linecolor:"rgba(0,0,0,0)")),k.ylines.attr("d",We)}return o.makeClipPaths(S),m.previousPromises(S)}function v(S,w){return(S.ticks||S.showline)&&(w===S._mainSubplot||S.mirror==="all"||S.mirror==="allticks")}function _(S,w,C){if(!C.showline||!C._lw)return!1;if(C.mirror==="all"||C.mirror==="allticks")return!0;var k=C._anchorAxis;if(!k)return!1;var L=i.FROM_BL[w];return C.side===w?k.domain[L]===S.domain[L]:C.mirror&&k.domain[1-L]===S.domain[1-L]}function x(S,w,C,k){if(_(S,w,C))return C._lw;for(var L=0;L<k.length;L++){var M=k[L];if(M._mainAxis===C._mainAxis&&_(S,w,M))return M._lw}return 0}function T(S,w){var C=S.title,k=S._size,L=0;switch(w==="start"?L=C.pad.l:w==="end"&&(L=-C.pad.r),C.xref){case"paper":return k.l+k.w*C.x+L;case"container":default:return S.width*C.x+L}}function A(S,w){var C=S.title,k=S._size,L=0;if(w!=="0em"&&w?w===i.CAP_SHIFT+"em"&&(L=C.pad.t):L=-C.pad.b,C.y==="auto")return k.t/2;switch(C.yref){case"paper":return k.t+k.h-k.h*C.y+L;case"container":default:return S.height-S.height*C.y+L}}B.layoutStyles=function(S){return p.syncOrAsync([m.doAutoMargin,y],S)},B.drawMainTitle=function(S){var w=S._fullLayout,C=function(L){var M=L.title,P="middle";return p.isRightAnchor(M)?P="end":p.isLeftAnchor(M)&&(P="start"),P}(w),k=function(L){var M=L.title,P="0em";return p.isTopAnchor(M)?P=i.CAP_SHIFT+"em":p.isMiddleAnchor(M)&&(P=i.MID_SHIFT+"em"),P}(w);s.draw(S,"gtitle",{propContainer:w,propName:"title.text",placeholder:w._dfltTitle.plot,attributes:{x:T(w,C),y:A(w,k),"text-anchor":C,dy:k}})},B.doTraceStyle=function(S){var w,C=S.calcdata,k=[];for(w=0;w<C.length;w++){var L=C[w],M=L[0]||{},P=M.trace||{},D=P._module||{},N=D.arraysToCalcdata;N&&N(L,P);var U=D.editStyle;U&&k.push({fn:U,cd0:M})}if(k.length){for(w=0;w<k.length;w++){var q=k[w];q.fn(S,q.cd0)}e(S),B.redrawReglTraces(S)}return m.style(S),d.getComponentMethod("legend","draw")(S),m.previousPromises(S)},B.doColorBars=function(S){return d.getComponentMethod("colorbar","draw")(S),m.previousPromises(S)},B.layoutReplot=function(S){var w=S.layout;return S.layout=void 0,d.call("_doPlot",S,"",w)},B.doLegend=function(S){return d.getComponentMethod("legend","draw")(S),m.previousPromises(S)},B.doTicksRelayout=function(S){return o.draw(S,"redraw"),S._fullLayout._hasOnlyLargeSploms&&(d.subplotsRegistry.splom.updateGrid(S),e(S),B.redrawReglTraces(S)),B.drawMainTitle(S),m.previousPromises(S)},B.doModeBar=function(S){var w=S._fullLayout;l.manage(S);for(var C=0;C<w._basePlotModules.length;C++){var k=w._basePlotModules[C].updateFx;k&&k(S)}return m.previousPromises(S)},B.doCamera=function(S){for(var w=S._fullLayout,C=w._subplots.gl3d,k=0;k<C.length;k++){var L=w[C[k]];L._scene.setViewport(L)}},B.drawData=function(S){var w=S._fullLayout;e(S);for(var C=w._basePlotModules,k=0;k<C.length;k++)C[k].plot(S);return B.redrawReglTraces(S),m.style(S),d.getComponentMethod("shapes","draw")(S),d.getComponentMethod("annotations","draw")(S),d.getComponentMethod("images","draw")(S),w._replotting=!1,m.previousPromises(S)},B.redrawReglTraces=function(S){var w=S._fullLayout;if(w._has("regl")){var C,k,L=S._fullData,M=[],P=[];for(w._hasOnlyLargeSploms&&w._splomGrid.draw(),C=0;C<L.length;C++){var D=L[C];D.visible===!0&&D._length!==0&&(D.type==="splom"?w._splomScenes[D.uid].draw():D.type==="scattergl"?p.pushUnique(M,D.xaxis+D.yaxis):D.type==="scatterpolargl"&&p.pushUnique(P,D.subplot))}for(C=0;C<M.length;C++)(k=w._plots[M[C]])._scene&&k._scene.draw();for(C=0;C<P.length;C++)(k=w[P[C]]._subplot)._scene&&k._scene.draw()}},B.doAutoRangeAndConstraints=function(S){for(var w,C=o.list(S,"",!0),k={},L=0;L<C.length;L++)if(!k[(w=C[L])._id]){k[w._id]=1,a(S,w),g(S,w);var M=w._matchGroup;if(M)for(var P in M){var D=o.getFromId(S,P);g(S,D,w.range),k[P]=1}}n(S)},B.finalDraw=function(S){d.getComponentMethod("rangeslider","draw")(S),d.getComponentMethod("rangeselector","draw")(S)},B.drawMarginPushers=function(S){d.getComponentMethod("legend","draw")(S),d.getComponentMethod("rangeselector","draw")(S),d.getComponentMethod("sliders","draw")(S),d.getComponentMethod("updatemenus","draw")(S),d.getComponentMethod("colorbar","draw")(S)}},{"../components/color":650,"../components/drawing":672,"../components/modebar":713,"../components/titles":748,"../constants/alignment":755,"../lib":787,"../lib/clear_gl_canvases":771,"../plots/cartesian/autorange":837,"../plots/cartesian/axes":838,"../plots/cartesian/constraints":846,"../plots/plots":901,"../registry":915,"@plotly/d3":58}],829:[function(r,O,B){var t=r("../lib"),d=t.isPlainObject,m=r("./plot_schema"),p=r("../plots/plots"),e=r("../plots/attributes"),f=r("./plot_template"),u=r("./plot_config").dfltConfig;function s(h,y){h=t.extendDeep({},h);var v,_,x=Object.keys(h).sort();function T(k,L,M){if(d(L)&&d(k))s(k,L);else if(Array.isArray(L)&&Array.isArray(k)){var P=f.arrayTemplater({_template:h},M);for(_=0;_<L.length;_++){var D=L[_],N=P.newItem(D)._template;N&&s(N,D)}var U=P.defaultItems();for(_=0;_<U.length;_++)L.push(U[_]._template);for(_=0;_<L.length;_++)delete L[_].templateitemname}}for(v=0;v<x.length;v++){var A=x[v],S=h[A];if(A in y?T(S,y[A],A):y[A]=S,l(A)===A)for(var w in y){var C=l(w);w===C||C!==A||w in h||T(S,y[w],A)}}}function l(h){return h.replace(/[0-9]+$/,"")}function o(h,y,v,_,x){var T=x&&v(x);for(var A in h){var S=h[A],w=n(h,A,_),C=n(h,A,x),k=v(C);if(!k){var L=l(A);L!==A&&(k=v(C=n(h,L,x)))}if((!T||T!==k)&&!(!k||k._noTemplating||k.valType==="data_array"||k.arrayOk&&Array.isArray(S)))if(!k.valType&&d(S))o(S,y,v,w,C);else if(k._isLinkedToArray&&Array.isArray(S))for(var M=!1,P=0,D={},N=0;N<S.length;N++){var U=S[N];if(d(U)){var q=U.name;if(q)D[q]||(o(U,y,v,n(S,P,w),n(S,P,C)),P++,D[q]=1);else if(!M){var X=n(h,f.arrayDefaultKey(A),_),K=n(S,P,w);o(U,y,v,K,n(S,P,C));var Z=t.nestedProperty(y,K);t.nestedProperty(y,X).set(Z.get()),Z.set(null),M=!0}}}else t.nestedProperty(y,w).set(S)}}function i(h,y){return m.getLayoutValObject(h,t.nestedProperty({},y).parts)}function c(h,y){return m.getTraceValObject(h,t.nestedProperty({},y).parts)}function n(h,y,v){return v?Array.isArray(h)?v+"["+y+"]":v+"."+y:y}function a(h){for(var y=0;y<h.length;y++)if(d(h[y]))return!0}function g(h){var y;switch(h.code){case"data":y="The template has no key data.";break;case"layout":y="The template has no key layout.";break;case"missing":y=h.path?"There are no templates for item "+h.path+" with name "+h.templateitemname:"There are no templates for trace "+h.index+", of type "+h.traceType+".";break;case"unused":y=h.path?"The template item at "+h.path+" was not used in constructing the plot.":h.dataCount?"Some of the templates of type "+h.traceType+" were not used. The template has "+h.templateCount+" traces, the data only has "+h.dataCount+" of this type.":"The template has "+h.templateCount+" traces of type "+h.traceType+" but there are none in the data.";break;case"reused":y="Some of the templates of type "+h.traceType+" were used more than once. The template has "+h.templateCount+" traces, the data has "+h.dataCount+" of this type."}return h.msg=y,h}B.makeTemplate=function(h){h=t.isPlainObject(h)?h:t.getGraphDiv(h),h=t.extendDeep({_context:u},{data:h.data,layout:h.layout}),p.supplyDefaults(h);var y=h.data||[],v=h.layout||{};v._basePlotModules=h._fullLayout._basePlotModules,v._modules=h._fullLayout._modules;var _={data:{},layout:{}};y.forEach(function(P){var D={};o(P,D,c.bind(null,P));var N=t.coerce(P,{},e,"type"),U=_.data[N];U||(U=_.data[N]=[]),U.push(D)}),o(v,_.layout,i.bind(null,v)),delete _.layout.template;var x=v.template;if(d(x)){var T,A,S,w,C,k,L=x.layout;d(L)&&s(L,_.layout);var M=x.data;if(d(M)){for(A in _.data)if(S=M[A],Array.isArray(S)){for(k=(C=_.data[A]).length,w=S.length,T=0;T<k;T++)s(S[T%w],C[T]);for(T=k;T<w;T++)C.push(t.extendDeep({},S[T]))}for(A in M)A in _.data||(_.data[A]=t.extendDeep([],M[A]))}}return _},B.validateTemplate=function(h,y){var v=t.extendDeep({},{_context:u,data:h.data,layout:h.layout}),_=v.layout||{};d(y)||(y=_.template||{});var x=y.layout,T=y.data,A=[];v.layout=_,v.layout.template=y,p.supplyDefaults(v);var S=v._fullLayout,w=v._fullData,C={};if(d(x)?(function U(q,X){for(var K in q)if(K.charAt(0)!=="_"&&d(q[K])){var Z,H=l(K),Y=[];for(Z=0;Z<X.length;Z++)Y.push(n(q,K,X[Z])),H!==K&&Y.push(n(q,H,X[Z]));for(Z=0;Z<Y.length;Z++)C[Y[Z]]=1;U(q[K],Y)}}(S,["layout"]),function U(q,X){for(var K in q)if(K.indexOf("defaults")===-1&&d(q[K])){var Z=n(q,K,X);C[Z]?U(q[K],Z):A.push({code:"unused",path:Z})}}(x,"layout")):A.push({code:"layout"}),d(T)){for(var k,L={},M=0;M<w.length;M++){var P=w[M];L[k=P.type]=(L[k]||0)+1,P._fullInput._template||A.push({code:"missing",index:P._fullInput.index,traceType:k})}for(k in T){var D=T[k].length,N=L[k]||0;D>N?A.push({code:"unused",traceType:k,templateCount:D,dataCount:N}):N>D&&A.push({code:"reused",traceType:k,templateCount:D,dataCount:N})}}else A.push({code:"data"});if(function U(q,X){for(var K in q)if(K.charAt(0)!=="_"){var Z=q[K],H=n(q,K,X);d(Z)?(Array.isArray(q)&&Z._template===!1&&Z.templateitemname&&A.push({code:"missing",path:H,templateitemname:Z.templateitemname}),U(Z,H)):Array.isArray(Z)&&a(Z)&&U(Z,H)}}({data:w,layout:S},""),A.length)return A.map(g)}},{"../lib":787,"../plots/attributes":834,"../plots/plots":901,"./plot_config":825,"./plot_schema":826,"./plot_template":827}],830:[function(r,O,B){var t=r("fast-isnumeric"),d=r("./plot_api"),m=r("../plots/plots"),p=r("../lib"),e=r("../snapshot/helpers"),f=r("../snapshot/tosvg"),u=r("../snapshot/svgtoimg"),s=r("../version").version,l={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};O.exports=function(o,i){var c,n,a,g;function h(N){return!(N in i)||p.validate(i[N],l[N])}if(i=i||{},p.isPlainObject(o)?(c=o.data||[],n=o.layout||{},a=o.config||{},g={}):(o=p.getGraphDiv(o),c=p.extendDeep([],o.data),n=p.extendDeep({},o.layout),a=o._context,g=o._fullLayout||{}),!h("width")&&i.width!==null||!h("height")&&i.height!==null)throw new Error("Height and width should be pixel values.");if(!h("format"))throw new Error("Export format is not "+p.join2(l.format.values,", "," or ")+".");var y={};function v(N,U){return p.coerce(i,y,l,N,U)}var _=v("format"),x=v("width"),T=v("height"),A=v("scale"),S=v("setBackground"),w=v("imageDataOnly"),C=document.createElement("div");C.style.position="absolute",C.style.left="-5000px",document.body.appendChild(C);var k=p.extendFlat({},n);x?k.width=x:i.width===null&&t(g.width)&&(k.width=g.width),T?k.height=T:i.height===null&&t(g.height)&&(k.height=g.height);var L=p.extendFlat({},a,{_exportedPlot:!0,staticPlot:!0,setBackground:S}),M=e.getRedrawFunc(C);function P(){return new Promise(function(N){setTimeout(N,e.getDelay(C._fullLayout))})}function D(){return new Promise(function(N,U){var q=f(C,_,A),X=C._fullLayout.width,K=C._fullLayout.height;function Z(){d.purge(C),document.body.removeChild(C)}if(_==="full-json"){var H=m.graphJson(C,!1,"keepdata","object",!0,!0);return H.version=s,H=JSON.stringify(H),Z(),N(w?H:e.encodeJSON(H))}if(Z(),_==="svg")return N(w?q:e.encodeSVG(q));var Y=document.createElement("canvas");Y.id=p.randstr(),u({format:_,width:X,height:K,scale:A,canvas:Y,svg:q,promise:!0}).then(N).catch(U)})}return new Promise(function(N,U){d.newPlot(C,c,k,L).then(M).then(P).then(D).then(function(q){N(function(X){return w?X.replace(e.IMAGE_URL_PREFIX,""):X}(q))}).catch(function(q){U(q)})})}},{"../lib":787,"../plots/plots":901,"../snapshot/helpers":919,"../snapshot/svgtoimg":921,"../snapshot/tosvg":923,"../version":1388,"./plot_api":824,"fast-isnumeric":246}],831:[function(r,O,B){var t=r("../lib"),d=r("../plots/plots"),m=r("./plot_schema"),p=r("./plot_config").dfltConfig,e=t.isPlainObject,f=Array.isArray,u=t.isArrayOrTypedArray;function s(y,v,_,x,T,A){A=A||[];for(var S=Object.keys(y),w=0;w<S.length;w++){var C=S[w];if(C!=="transforms"){var k=A.slice();k.push(C);var L=y[C],M=v[C],P=a(_,C),D=(P||{}).valType,N=D==="info_array",U=D==="colorscale",q=(P||{}).items;if(n(_,C))if(e(L)&&e(M)&&D!=="any")s(L,M,P,x,T,k);else if(N&&f(L)){L.length>M.length&&x.push(c("unused",T,k.concat(M.length)));var X,K,Z,H,Y,$=M.length,z=Array.isArray(q);if(z&&($=Math.min($,q.length)),P.dimensions===2)for(K=0;K<$;K++)if(f(L[K])){L[K].length>M[K].length&&x.push(c("unused",T,k.concat(K,M[K].length)));var j=M[K].length;for(X=0;X<(z?Math.min(j,q[K].length):j);X++)Z=z?q[K][X]:q,H=L[K][X],Y=M[K][X],t.validate(H,Z)?Y!==H&&Y!==+H&&x.push(c("dynamic",T,k.concat(K,X),H,Y)):x.push(c("value",T,k.concat(K,X),H))}else x.push(c("array",T,k.concat(K),L[K]));else for(K=0;K<$;K++)Z=z?q[K]:q,H=L[K],Y=M[K],t.validate(H,Z)?Y!==H&&Y!==+H&&x.push(c("dynamic",T,k.concat(K),H,Y)):x.push(c("value",T,k.concat(K),H))}else if(P.items&&!N&&f(L)){var W,ee,J=q[Object.keys(q)[0]],Q=[];for(W=0;W<M.length;W++){var te=M[W]._index||W;if((ee=k.slice()).push(te),e(L[te])&&e(M[W])){Q.push(te);var ie=L[te],ae=M[W];e(ie)&&ie.visible!==!1&&ae.visible===!1?x.push(c("invisible",T,ee)):s(ie,ae,J,x,T,ee)}}for(W=0;W<L.length;W++)(ee=k.slice()).push(W),e(L[W])?Q.indexOf(W)===-1&&x.push(c("unused",T,ee)):x.push(c("object",T,ee,L[W]))}else!e(L)&&e(M)?x.push(c("object",T,k,L)):u(L)||!u(M)||N||U?C in v?t.validate(L,P)?P.valType==="enumerated"&&(P.coerceNumber&&L!==+M||L!==M)&&x.push(c("dynamic",T,k,L,M)):x.push(c("value",T,k,L)):x.push(c("unused",T,k,L)):x.push(c("array",T,k,L));else x.push(c("schema",T,k))}}return x}function l(y,v){for(var _=y.layout.layoutAttributes,x=0;x<v.length;x++){var T=v[x],A=y.traces[T.type],S=A.layoutAttributes;S&&(T.subplot?t.extendFlat(_[A.attributes.subplot.dflt],S):t.extendFlat(_,S))}return _}O.exports=function(y,v){y===void 0&&(y=[]),v===void 0&&(v={});var _,x,T=m.get(),A=[],S={_context:t.extendFlat({},p)};f(y)?(S.data=t.extendDeep([],y),_=y):(S.data=[],_=[],A.push(c("array","data"))),e(v)?(S.layout=t.extendDeep({},v),x=v):(S.layout={},x={},arguments.length>1&&A.push(c("object","layout"))),d.supplyDefaults(S);for(var w=S._fullData,C=_.length,k=0;k<C;k++){var L=_[k],M=["data",k];if(e(L)){var P=w[k],D=P.type,N=T.traces[D].attributes;N.type={valType:"enumerated",values:[D]},P.visible===!1&&L.visible!==!1&&A.push(c("invisible",M)),s(L,P,N,A,M);var U=L.transforms,q=P.transforms;if(U){f(U)||A.push(c("array",M,["transforms"])),M.push("transforms");for(var X=0;X<U.length;X++){var K=["transforms",X],Z=U[X].type;if(e(U[X])){var H=T.transforms[Z]?T.transforms[Z].attributes:{};H.type={valType:"enumerated",values:Object.keys(T.transforms)},s(U[X],q[X],H,A,M,K)}else A.push(c("object",M,K))}}}else A.push(c("object",M))}var Y=S._fullLayout,$=l(T,w);return s(x,Y,$,A,"layout"),A.length===0?void 0:A};var o={object:function(y,v){return(y==="layout"&&v===""?"The layout argument":y[0]==="data"&&v===""?"Trace "+y[1]+" in the data argument":i(y)+"key "+v)+" must be linked to an object container"},array:function(y,v){return(y==="data"?"The data argument":i(y)+"key "+v)+" must be linked to an array container"},schema:function(y,v){return i(y)+"key "+v+" is not part of the schema"},unused:function(y,v,_){var x=e(_)?"container":"key";return i(y)+x+" "+v+" did not get coerced"},dynamic:function(y,v,_,x){return[i(y)+"key",v,"(set to '"+_+"')","got reset to","'"+x+"'","during defaults."].join(" ")},invisible:function(y,v){return(v?i(y)+"item "+v:"Trace "+y[1])+" got defaulted to be not visible"},value:function(y,v,_){return[i(y)+"key "+v,"is set to an invalid value ("+_+")"].join(" ")}};function i(y){return f(y)?"In data trace "+y[1]+", ":"In "+y+", "}function c(y,v,_,x,T){var A,S;_=_||"",f(v)?(A=v[0],S=v[1]):(A=v,S=null);var w=function(k){if(!f(k))return String(k);for(var L="",M=0;M<k.length;M++){var P=k[M];typeof P=="number"?L=L.substr(0,L.length-1)+"["+P+"]":L+=P,M<k.length-1&&(L+=".")}return L}(_),C=o[y](v,w,x,T);return t.log(C),{code:y,container:A,trace:S,path:_,astr:w,msg:C}}function n(y,v){var _=h(v),x=_.keyMinusId,T=_.id;return!!(x in y&&y[x]._isSubplotObj&&T)||v in y}function a(y,v){return v in y?y[v]:y[h(v).keyMinusId]}var g=t.counterRegex("([a-z]+)");function h(y){var v=y.match(g);return{keyMinusId:v&&v[1],id:v&&v[2]}}},{"../lib":787,"../plots/plots":901,"./plot_config":825,"./plot_schema":826}],832:[function(r,O,B){O.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],833:[function(r,O,B){var t=r("../lib"),d=r("../plot_api/plot_template");O.exports=function(m,p,e){var f,u,s=e.name,l=e.inclusionAttr||"visible",o=p[s],i=t.isArrayOrTypedArray(m[s])?m[s]:[],c=p[s]=[],n=d.arrayTemplater(p,s,l);for(f=0;f<i.length;f++){var a=i[f];t.isPlainObject(a)?u=n.newItem(a):(u=n.newItem({}))[l]=!1,u._index=f,u[l]!==!1&&e.handleItemDefaults(a,u,p,e),c.push(u)}var g=n.defaultItems();for(f=0;f<g.length;f++)(u=g[f])._index=c.length,e.handleItemDefaults({},u,p,e,{}),c.push(u);if(t.isArrayOrTypedArray(o)){var h=Math.min(o.length,c.length);for(f=0;f<h;f++)t.relinkPrivateKeys(c[f],o[f])}return c}},{"../lib":787,"../plot_api/plot_template":827}],834:[function(r,O,B){var t=r("./font_attributes"),d=r("../components/fx/attributes");O.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:t({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:d.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":681,"./font_attributes":867}],835:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=d.dateTime2ms,p=d.incrementMonth,e=r("../../constants/numerical").ONEAVGMONTH;O.exports=function(f,u,s,l){if(u.type!=="date")return{vals:l};var o=f[s+"periodalignment"];if(!o)return{vals:l};var i,c=f[s+"period"];if(t(c)){if((c=+c)<=0)return{vals:l}}else if(typeof c=="string"&&c.charAt(0)==="M"){var n=+c.substring(1);if(!(n>0&&Math.round(n)===n))return{vals:l};i=n}for(var a=u.calendar,g=o==="start",h=o==="end",y=f[s+"period0"],v=m(y,a)||0,_=[],x=[],T=[],A=l.length,S=0;S<A;S++){var w,C,k,L=l[S];if(i){for(w=Math.round((L-v)/(i*e)),k=p(v,i*w,a);k>L;)k=p(k,-i,a);for(;k<=L;)k=p(k,i,a);C=p(k,-i,a)}else{for(k=v+(w=Math.round((L-v)/c))*c;k>L;)k-=c;for(;k<=L;)k+=c;C=k-c}_[S]=g?C:h?k:(C+k)/2,x[S]=C,T[S]=k}return{vals:_,starts:x,ends:T}}},{"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],836:[function(r,O,B){O.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],837:[function(r,O,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("../../lib"),p=r("../../constants/numerical").FP_SAFE,e=r("../../registry"),f=r("../../components/drawing"),u=r("./axis_ids"),s=u.getFromId,l=u.isLinked;function o(x,T){var A,S,w=[],C=x._fullLayout,k=c(C,T,0),L=c(C,T,1),M=n(x,T),P=M.min,D=M.max;if(P.length===0||D.length===0)return m.simpleMap(T.range,T.r2l);var N=P[0].val,U=D[0].val;for(A=1;A<P.length&&N===U;A++)N=Math.min(N,P[A].val);for(A=1;A<D.length&&N===U;A++)U=Math.max(U,D[A].val);var q=!1;if(T.range){var X=m.simpleMap(T.range,T.r2l);q=X[1]<X[0]}T.autorange==="reversed"&&(q=!0,T.autorange=!0);var K,Z,H,Y,$,z,j=T.rangemode,W=j==="tozero",ee=j==="nonnegative",J=T._length,Q=J/10,te=0;for(A=0;A<P.length;A++)for(K=P[A],S=0;S<D.length;S++)(z=(Z=D[S]).val-K.val-i(T,K.val,Z.val))>0&&(($=J-k(K)-L(Z))>Q?z/$>te&&(H=K,Y=Z,te=z/$):z/J>te&&(H={val:K.val,nopad:1},Y={val:Z.val,nopad:1},te=z/J));if(N===U){var ie=N-1,ae=N+1;if(W)if(N===0)w=[0,1];else{var he=(N>0?D:P).reduce(function(de,ue){return Math.max(de,L(ue))},0),se=N/(1-Math.min(.5,he/J));w=N>0?[0,se]:[se,0]}else w=ee?[Math.max(0,ie),Math.max(1,ae)]:[ie,ae]}else W?(H.val>=0&&(H={val:0,nopad:1}),Y.val<=0&&(Y={val:0,nopad:1})):ee&&(H.val-te*k(H)<0&&(H={val:0,nopad:1}),Y.val<=0&&(Y={val:1,nopad:1})),te=(Y.val-H.val-i(T,K.val,Z.val))/(J-k(H)-L(Y)),w=[H.val-te*k(H),Y.val+te*L(Y)];return q&&w.reverse(),m.simpleMap(w,T.l2r||Number)}function i(x,T,A){var S=0;if(x.rangebreaks)for(var w=x.locateBreaks(T,A),C=0;C<w.length;C++){var k=w[C];S+=k.max-k.min}return S}function c(x,T,A){var S=.05*T._length,w=T._anchorAxis||{};if((T.ticklabelposition||"").indexOf("inside")!==-1||(w.ticklabelposition||"").indexOf("inside")!==-1){var C=T.autorange==="reversed";if(!C){var k=m.simpleMap(T.range,T.r2l);C=k[1]<k[0]}C&&(A=!A)}var L=0;return l(x,T._id)||(L=function(M,P,D){var N=0,U=P._id.charAt(0)==="x";for(var q in M._plots){var X=M._plots[q];if(P._id===X.xaxis._id||P._id===X.yaxis._id){var K=(U?X.yaxis:X.xaxis)||{};if((K.ticklabelposition||"").indexOf("inside")!==-1&&(!D&&(K.side==="left"||K.side==="bottom")||D&&(K.side==="top"||K.side==="right"))){if(K._vals){var Z=m.deg2rad(K._tickAngles[K._id+"tick"]||0),H=Math.abs(Math.cos(Z)),Y=Math.abs(Math.sin(Z));if(!K._vals[0].bb){var $=K._id+"tick";K._selections[$].each(function(J){var Q=t.select(this);Q.select(".text-math-group").empty()&&(J.bb=f.bBox(Q.node()))})}for(var z=0;z<K._vals.length;z++){var j=K._vals[z].bb;if(j){var W=6+j.width,ee=6+j.height;N=Math.max(N,U?Math.max(W*H,ee*Y):Math.max(ee*H,W*Y))}}}K.ticks==="inside"&&K.ticklabelposition==="inside"&&(N+=K.ticklen||0)}}}return N}(x,T,A)),S=Math.max(L,S),T.constrain==="domain"&&T._inputDomain&&(S*=(T._inputDomain[1]-T._inputDomain[0])/(T.domain[1]-T.domain[0])),function(M){return M.nopad?0:M.pad+(M.extrapad?S:L)}}O.exports={getAutoRange:o,makePadFn:c,doAutoRange:function(x,T,A){if(T.setScale(),T.autorange){T.range=A?A.slice():o(x,T),T._r=T.range.slice(),T._rl=m.simpleMap(T._r,T.r2l);var S=T._input,w={};w[T._attr+".range"]=T.range,w[T._attr+".autorange"]=T.autorange,e.call("_storeDirectGUIEdit",x.layout,x._fullLayout._preGUI,w),S.range=T.range.slice(),S.autorange=T.autorange}var C=T._anchorAxis;if(C&&C.rangeslider){var k=C.rangeslider[T._name];k&&k.rangemode==="auto"&&(k.range=o(x,T)),C._input.rangeslider[T._name]=m.extendFlat({},k)}},findExtremes:function(x,T,A){A||(A={}),x._m||x.setScale();var S,w,C,k,L,M,P,D,N,U=[],q=[],X=T.length,K=A.padded||!1,Z=A.tozero&&(x.type==="linear"||x.type==="-"),H=x.type==="log",Y=!1,$=A.vpadLinearized||!1;function z(ae){if(Array.isArray(ae))return Y=!0,function(se){return Math.max(Number(ae[se]||0),0)};var he=Math.max(Number(ae||0),0);return function(){return he}}var j=z((x._m>0?A.ppadplus:A.ppadminus)||A.ppad||0),W=z((x._m>0?A.ppadminus:A.ppadplus)||A.ppad||0),ee=z(A.vpadplus||A.vpad),J=z(A.vpadminus||A.vpad);if(!Y){if(D=1/0,N=-1/0,H)for(S=0;S<X;S++)(w=T[S])<D&&w>0&&(D=w),w>N&&w<p&&(N=w);else for(S=0;S<X;S++)(w=T[S])<D&&w>-p&&(D=w),w>N&&w<p&&(N=w);T=[D,N],X=2}var Q={tozero:Z,extrapad:K};function te(ae){C=T[ae],d(C)&&(M=j(ae),P=W(ae),$?(k=x.c2l(C)-J(ae),L=x.c2l(C)+ee(ae)):(D=C-J(ae),N=C+ee(ae),H&&D<N/10&&(D=N/10),k=x.c2l(D),L=x.c2l(N)),Z&&(k=Math.min(0,k),L=Math.max(0,L)),y(k)&&a(U,k,P,Q),y(L)&&g(q,L,M,Q))}var ie=Math.min(6,X);for(S=0;S<ie;S++)te(S);for(S=X-1;S>=ie;S--)te(S);return{min:U,max:q,opts:A}},concatExtremes:n};function n(x,T,A){var S,w,C,k=T._id,L=x._fullData,M=x._fullLayout,P=[],D=[];function N(Z,H){for(S=0;S<H.length;S++){var Y=Z[H[S]],$=(Y._extremes||{})[k];if(Y.visible===!0&&$){for(w=0;w<$.min.length;w++)C=$.min[w],a(P,C.val,C.pad,{extrapad:C.extrapad});for(w=0;w<$.max.length;w++)C=$.max[w],g(D,C.val,C.pad,{extrapad:C.extrapad})}}}if(N(L,T._traceIndices),N(M.annotations||[],T._annIndices||[]),N(M.shapes||[],T._shapeIndices||[]),T._matchGroup&&!A){for(var U in T._matchGroup)if(U!==T._id){var q=s(x,U),X=n(x,q,!0),K=T._length/q._length;for(w=0;w<X.min.length;w++)C=X.min[w],a(P,C.val,C.pad*K,{extrapad:C.extrapad});for(w=0;w<X.max.length;w++)C=X.max[w],g(D,C.val,C.pad*K,{extrapad:C.extrapad})}}return{min:P,max:D}}function a(x,T,A,S){h(x,T,A,S,v)}function g(x,T,A,S){h(x,T,A,S,_)}function h(x,T,A,S,w){for(var C=S.tozero,k=S.extrapad,L=!0,M=0;M<x.length&&L;M++){var P=x[M];if(w(P.val,T)&&P.pad>=A&&(P.extrapad||!k)){L=!1;break}w(T,P.val)&&P.pad<=A&&(k||!P.extrapad)&&(x.splice(M,1),M--)}if(L){var D=C&&T===0;x.push({val:T,pad:D?0:A,extrapad:!D&&k})}}function y(x){return d(x)&&Math.abs(x)<p}function v(x,T){return x<=T}function _(x,T){return x>=T}},{"../../components/drawing":672,"../../constants/numerical":763,"../../lib":787,"../../registry":915,"./axis_ids":842,"@plotly/d3":58,"fast-isnumeric":246}],838:[function(r,O,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("../../plots/plots"),p=r("../../registry"),e=r("../../lib"),f=e.strTranslate,u=r("../../lib/svg_text_utils"),s=r("../../components/titles"),l=r("../../components/color"),o=r("../../components/drawing"),i=r("./layout_attributes"),c=r("./clean_ticks"),n=r("../../constants/numerical"),a=n.ONEMAXYEAR,g=n.ONEAVGYEAR,h=n.ONEMINYEAR,y=n.ONEMAXQUARTER,v=n.ONEAVGQUARTER,_=n.ONEMINQUARTER,x=n.ONEMAXMONTH,T=n.ONEAVGMONTH,A=n.ONEMINMONTH,S=n.ONEWEEK,w=n.ONEDAY,C=w/2,k=n.ONEHOUR,L=n.ONEMIN,M=n.ONESEC,P=n.MINUS_SIGN,D=n.BADNUM,N={K:"zeroline"},U={K:"gridline",L:"path"},q={K:"tick",L:"path"},X={K:"tick",L:"text"},K=r("../../constants/alignment"),Z=K.MID_SHIFT,H=K.CAP_SHIFT,Y=K.LINE_SPACING,$=K.OPPOSITE_SIDE,z=O.exports={};z.setConvert=r("./set_convert");var j=r("./axis_autotype"),W=r("./axis_ids"),ee=W.idSort,J=W.isLinked;z.id2name=W.id2name,z.name2id=W.name2id,z.cleanId=W.cleanId,z.list=W.list,z.listIds=W.listIds,z.getFromId=W.getFromId,z.getFromTrace=W.getFromTrace;var Q=r("./autorange");z.getAutoRange=Q.getAutoRange,z.findExtremes=Q.findExtremes;function te(Ue){var He=1e-4*(Ue[1]-Ue[0]);return[Ue[0]-He,Ue[1]+He]}z.coerceRef=function(Ue,He,Be,Ke,_e,Ce){var Le=Ke.charAt(Ke.length-1),Pe=Be._fullLayout._subplots[Le+"axis"],Xe=Ke+"ref",ht={};return _e||(_e=Pe[0]||(typeof Ce=="string"?Ce:Ce[0])),Ce||(Ce=_e),Pe=Pe.concat(Pe.map(function(Mt){return Mt+" domain"})),ht[Xe]={valType:"enumerated",values:Pe.concat(Ce?typeof Ce=="string"?[Ce]:Ce:[]),dflt:_e},e.coerce(Ue,He,ht,Xe)},z.getRefType=function(Ue){return Ue===void 0?Ue:Ue==="paper"?"paper":Ue==="pixel"?"pixel":/( domain)$/.test(Ue)?"domain":"range"},z.coercePosition=function(Ue,He,Be,Ke,_e,Ce){var Le,Pe;if(z.getRefType(Ke)!=="range")Le=e.ensureNumber,Pe=Be(_e,Ce);else{var Xe=z.getFromId(He,Ke);Pe=Be(_e,Ce=Xe.fraction2r(Ce)),Le=Xe.cleanPos}Ue[_e]=Le(Pe)},z.cleanPosition=function(Ue,He,Be){return(Be==="paper"||Be==="pixel"?e.ensureNumber:z.getFromId(He,Be).cleanPos)(Ue)},z.redrawComponents=function(Ue,He){He=He||z.listIds(Ue);var Be=Ue._fullLayout;function Ke(_e,Ce,Le,Pe){for(var Xe=p.getComponentMethod(_e,Ce),ht={},Mt=0;Mt<He.length;Mt++)for(var pt=Be[z.id2name(He[Mt])][Le],Lt=0;Lt<pt.length;Lt++){var vt=pt[Lt];if(!ht[vt]&&(Xe(Ue,vt),ht[vt]=1,Pe))return}}Ke("annotations","drawOne","_annIndices"),Ke("shapes","drawOne","_shapeIndices"),Ke("images","draw","_imgIndices",!0)};var ie=z.getDataConversions=function(Ue,He,Be,Ke){var _e,Ce=Be==="x"||Be==="y"||Be==="z"?Be:Ke;if(Array.isArray(Ce)){if(_e={type:j(Ke,void 0,{autotypenumbers:Ue._fullLayout.autotypenumbers}),_categories:[]},z.setConvert(_e),_e.type==="category")for(var Le=0;Le<Ke.length;Le++)_e.d2c(Ke[Le])}else _e=z.getFromTrace(Ue,He,Ce);return _e?{d2c:_e.d2c,c2d:_e.c2d}:Ce==="ids"?{d2c:he,c2d:he}:{d2c:ae,c2d:ae}};function ae(Ue){return+Ue}function he(Ue){return String(Ue)}function se(Ue){return+Ue.substring(1)}z.getDataToCoordFunc=function(Ue,He,Be,Ke){return ie(Ue,He,Be,Ke).d2c},z.counterLetter=function(Ue){var He=Ue.charAt(0);return He==="x"?"y":He==="y"?"x":void 0},z.minDtick=function(Ue,He,Be,Ke){["log","category","multicategory"].indexOf(Ue.type)===-1&&Ke?Ue._minDtick===void 0?(Ue._minDtick=He,Ue._forceTick0=Be):Ue._minDtick&&((Ue._minDtick/He+1e-6)%1<2e-6&&((Be-Ue._forceTick0)/He%1+1.000001)%1<2e-6?(Ue._minDtick=He,Ue._forceTick0=Be):((He/Ue._minDtick+1e-6)%1>2e-6||((Be-Ue._forceTick0)/Ue._minDtick%1+1.000001)%1>2e-6)&&(Ue._minDtick=0)):Ue._minDtick=0},z.saveRangeInitial=function(Ue,He){for(var Be=z.list(Ue,"",!0),Ke=!1,_e=0;_e<Be.length;_e++){var Ce=Be[_e],Le=Ce._rangeInitial===void 0,Pe=Le||!(Ce.range[0]===Ce._rangeInitial[0]&&Ce.range[1]===Ce._rangeInitial[1]);(Le&&Ce.autorange===!1||He&&Pe)&&(Ce._rangeInitial=Ce.range.slice(),Ke=!0)}return Ke},z.saveShowSpikeInitial=function(Ue,He){for(var Be=z.list(Ue,"",!0),Ke=!1,_e="on",Ce=0;Ce<Be.length;Ce++){var Le=Be[Ce],Pe=Le._showSpikeInitial===void 0,Xe=Pe||Le.showspikes!==Le._showspikes;(Pe||He&&Xe)&&(Le._showSpikeInitial=Le.showspikes,Ke=!0),_e!=="on"||Le.showspikes||(_e="off")}return Ue._fullLayout._cartesianSpikesEnabled=_e,Ke},z.autoBin=function(Ue,He,Be,Ke,_e,Ce){var Le,Pe=e.aggNums(Math.min,null,Ue),Xe=e.aggNums(Math.max,null,Ue);if(He.type==="category"||He.type==="multicategory")return{start:Pe-.5,end:Xe+.5,size:Math.max(1,Math.round(Ce)||1),_dataSpan:Xe-Pe};if(_e||(_e=He.calendar),Le=He.type==="log"?{type:"linear",range:[Pe,Xe]}:{type:He.type,range:e.simpleMap([Pe,Xe],He.c2r,0,_e),calendar:_e},z.setConvert(Le),Ce=Ce&&c.dtick(Ce,Le.type))Le.dtick=Ce,Le.tick0=c.tick0(void 0,Le.type,_e);else{var ht;if(Be)ht=(Xe-Pe)/Be;else{var Mt=e.distinctVals(Ue),pt=Math.pow(10,Math.floor(Math.log(Mt.minDiff)/Math.LN10)),Lt=pt*e.roundUp(Mt.minDiff/pt,[.9,1.9,4.9,9.9],!0);ht=Math.max(Lt,2*e.stdev(Ue)/Math.pow(Ue.length,Ke?.25:.4)),d(ht)||(ht=1)}z.autoTicks(Le,ht)}var vt,Dt=Le.dtick,xt=z.tickIncrement(z.tickFirst(Le),Dt,"reverse",_e);if(typeof Dt=="number")vt=(xt=function(it,St,Nt,Ut,Qt){var Ie=0,lt=0,wt=0,Ot=0;function Gt(or){return(1+100*(or-it)/Nt.dtick)%100<2}for(var ir=0;ir<St.length;ir++)St[ir]%1==0?wt++:d(St[ir])||Ot++,Gt(St[ir])&&Ie++,Gt(St[ir]+Nt.dtick/2)&&lt++;var Xt=St.length-Ot;if(wt===Xt&&Nt.type!=="date")Nt.dtick<1?it=Ut-.5*Nt.dtick:(it-=.5)+Nt.dtick<Ut&&(it+=Nt.dtick);else if(lt<.1*Xt&&(Ie>.3*Xt||Gt(Ut)||Gt(Qt))){var Kt=Nt.dtick/2;it+=it+Kt<Ut?Kt:-Kt}return it}(xt,Ue,Le,Pe,Xe))+(1+Math.floor((Xe-xt)/Dt))*Dt;else for(Le.dtick.charAt(0)==="M"&&(xt=function(it,St,Nt,Ut,Qt){var Ie=e.findExactDates(St,Qt);if(Ie.exactDays>.8){var lt=Number(Nt.substr(1));Ie.exactYears>.8&&lt%12==0?it=z.tickIncrement(it,"M6","reverse")+1.5*w:Ie.exactMonths>.8?it=z.tickIncrement(it,"M1","reverse")+15.5*w:it-=C;var wt=z.tickIncrement(it,Nt);if(wt<=Ut)return wt}return it}(xt,Ue,Dt,Pe,_e)),vt=xt,0;vt<=Xe;)vt=z.tickIncrement(vt,Dt,!1,_e);return{start:He.c2r(xt,0,_e),end:He.c2r(vt,0,_e),size:Dt,_dataSpan:Xe-Pe}},z.prepTicks=function(Ue,He){var Be=e.simpleMap(Ue.range,Ue.r2l,void 0,void 0,He);if(Ue._dtickInit=Ue.dtick,Ue._tick0Init=Ue.tick0,Ue.tickmode==="auto"||!Ue.dtick){var Ke,_e=Ue.nticks;_e||(Ue.type==="category"||Ue.type==="multicategory"?(Ke=Ue.tickfont?e.bigFont(Ue.tickfont.size||12):15,_e=Ue._length/Ke):(Ke=Ue._id.charAt(0)==="y"?40:80,_e=e.constrain(Ue._length/Ke,4,9)+1),Ue._name==="radialaxis"&&(_e*=2)),Ue.tickmode==="array"&&(_e*=100),Ue._roughDTick=Math.abs(Be[1]-Be[0])/_e,z.autoTicks(Ue,Ue._roughDTick),Ue._minDtick>0&&Ue.dtick<2*Ue._minDtick&&(Ue.dtick=Ue._minDtick,Ue.tick0=Ue.l2r(Ue._forceTick0))}Ue.ticklabelmode==="period"&&function(Ce){var Le;function Pe(){return!(d(Ce.dtick)||Ce.dtick.charAt(0)!=="M")}var Xe=Pe(),ht=z.getTickFormat(Ce);if(ht){var Mt=Ce._dtickInit!==Ce.dtick;/%[fLQsSMX]/.test(ht)||(/%[HI]/.test(ht)?(Le=k,Mt&&!Xe&&Ce.dtick<k&&(Ce.dtick=k)):/%p/.test(ht)?(Le=C,Mt&&!Xe&&Ce.dtick<C&&(Ce.dtick=C)):/%[Aadejuwx]/.test(ht)?(Le=w,Mt&&!Xe&&Ce.dtick<w&&(Ce.dtick=w)):/%[UVW]/.test(ht)?(Le=S,Mt&&!Xe&&Ce.dtick<S&&(Ce.dtick=S)):/%[Bbm]/.test(ht)?(Le=T,Mt&&(Xe?se(Ce.dtick)<1:Ce.dtick<A)&&(Ce.dtick="M1")):/%[q]/.test(ht)?(Le=v,Mt&&(Xe?se(Ce.dtick)<3:Ce.dtick<_)&&(Ce.dtick="M3")):/%[Yy]/.test(ht)&&(Le=g,Mt&&(Xe?se(Ce.dtick)<12:Ce.dtick<h)&&(Ce.dtick="M12")))}(Xe=Pe())&&Ce.tick0===Ce._dowTick0&&(Ce.tick0=Ce._rawTick0),Ce._definedDelta=Le}(Ue),Ue.tick0||(Ue.tick0=Ue.type==="date"?"2000-01-01":0),Ue.type==="date"&&Ue.dtick<.1&&(Ue.dtick=.1),ge(Ue)},z.calcTicks=function(Ue,He){z.prepTicks(Ue,He);var Be=e.simpleMap(Ue.range,Ue.r2l,void 0,void 0,He);if(Ue.tickmode==="array")return function(ir){var Xt=ir.tickvals,Kt=ir.ticktext,or=new Array(Xt.length),dr=te(e.simpleMap(ir.range,ir.r2l)),vr=Math.min(dr[0],dr[1]),ur=Math.max(dr[0],dr[1]),pr=0;Array.isArray(Kt)||(Kt=[]);var br=ir.type==="category"?ir.d2l_noadd:ir.d2l;ir.type==="log"&&String(ir.dtick).charAt(0)!=="L"&&(ir.dtick="L"+Math.pow(10,Math.floor(Math.min(ir.range[0],ir.range[1]))-1));for(var Rr=0;Rr<Xt.length;Rr++){var _r=br(Xt[Rr]);_r>vr&&_r<ur&&(Kt[Rr]===void 0?or[pr]=z.tickText(ir,_r):or[pr]=we(ir,_r,String(Kt[Rr])),pr++)}return pr<Xt.length&&or.splice(pr,Xt.length-pr),ir.rangebreaks&&(or=or.filter(function(jr){return ir.maskBreaks(jr.x)!==D})),or}(Ue);var Ke=te(Be),_e=Ke[0],Ce=Ke[1],Le=Be[1]<Be[0],Pe=Math.min(Be[0],Be[1]),Xe=Math.max(Be[0],Be[1]),ht=Ue.type==="log"&&!(d(Ue.dtick)||Ue.dtick.charAt(0)==="L"),Mt=Ue.ticklabelmode==="period";if(Ue._tmin=z.tickFirst(Ue,He),Ue._tmin<_e!==Le)return[];Ue.type!=="category"&&Ue.type!=="multicategory"||(Ce=Le?Math.max(-.5,Ce):Math.min(Ue._categories.length-.5,Ce));var pt=Ue._tmin;Ue.rangebreaks&&Ue._tick0Init!==Ue.tick0&&(pt=_t(pt,Ue),Le||(pt=z.tickIncrement(pt,Ue.dtick,!Le,Ue.calendar))),Mt&&(pt=z.tickIncrement(pt,Ue.dtick,!Le,Ue.calendar));for(var Lt,vt=Math.max(1e3,Ue._length||0),Dt=[],xt=null;Le?pt>=Ce:pt<=Ce;pt=z.tickIncrement(pt,Ue.dtick,Le,Ue.calendar)){if(Ue.rangebreaks&&!Le){if(pt<_e)continue;if(Ue.maskBreaks(pt)===D&&_t(pt,Ue)>=Xe)break}if(Dt.length>vt||pt===xt)break;xt=pt;var it=!1;ht&&pt!==(0|pt)&&(it=!0),Dt.push({minor:it,value:pt})}if(Mt&&function(ir,Xt,Kt){for(var or=0;or<ir.length;or++){var dr=ir[or].value,vr=or,ur=or+1;or<ir.length-1?(vr=or,ur=or+1):or>0?(vr=or-1,ur=or):(vr=or,ur=or);var pr,br=ir[vr].value,Rr=ir[ur].value,_r=Math.abs(Rr-br),jr=Kt||_r,$r=0;jr>=h?$r=_r>=h&&_r<=a?_r:g:Kt===v&&jr>=_?$r=_r>=_&&_r<=y?_r:v:jr>=A?$r=_r>=A&&_r<=x?_r:T:Kt===S&&jr>=S?$r=S:jr>=w?$r=w:Kt===C&&jr>=C?$r=C:Kt===k&&jr>=k&&($r=k),$r>=_r&&($r=_r,pr=!0);var pn=dr+$r;if(Xt.rangebreaks&&$r>0){for(var In=0,On=0;On<84;On++){var Sn=(On+.5)/84;Xt.maskBreaks(dr*(1-Sn)+Sn*pn)!==D&&In++}($r*=In/84)||(ir[or].drop=!0),pr&&_r>S&&($r=_r)}($r>0||or===0)&&(ir[or].periodX=dr+$r/2)}}(Dt,Ue,Ue._definedDelta),Ue.rangebreaks){var St=Ue._id.charAt(0)==="y",Nt=1;Ue.tickmode==="auto"&&(Nt=Ue.tickfont?Ue.tickfont.size:12);var Ut=NaN;for(Lt=Dt.length-1;Lt>-1;Lt--)if(Dt[Lt].drop)Dt.splice(Lt,1);else{Dt[Lt].value=_t(Dt[Lt].value,Ue);var Qt=Ue.c2p(Dt[Lt].value);(St?Ut>Qt-Nt:Ut<Qt+Nt)?Dt.splice(Le?Lt+1:Lt,1):Ut=Qt}}tt(Ue)&&Math.abs(Be[1]-Be[0])===360&&Dt.pop(),Ue._tmax=(Dt[Dt.length-1]||{}).value,Ue._prevDateHead="",Ue._inCalcTicks=!0;var Ie,lt,wt=[];for(Lt=0;Lt<Dt.length;Lt++){var Ot=Dt[Lt].minor,Gt=Dt[Lt].value;Ie=z.tickText(Ue,Gt,!1,Ot),(lt=Dt[Lt].periodX)!==void 0&&(Ie.periodX=lt,(lt>Xe||lt<Pe)&&(lt>Xe&&(Ie.periodX=Xe),lt<Pe&&(Ie.periodX=Pe),Ie.text=" ",Ue._prevDateHead="")),wt.push(Ie)}return Ue._inCalcTicks=!1,wt};var de=[2,5,10],ue=[1,2,3,6,12],ve=[1,2,5,10,15,30],ke=[1,2,3,7,14],Ee=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],be=[-.301,0,.301,.699,1],xe=[15,30,45,90,180];function ce(Ue,He,Be){return He*e.roundUp(Ue/He,Be)}function ge(Ue){var He=Ue.dtick;if(Ue._tickexponent=0,d(He)||typeof He=="string"||(He=1),Ue.type!=="category"&&Ue.type!=="multicategory"||(Ue._tickround=null),Ue.type==="date"){var Be=Ue.r2l(Ue.tick0),Ke=Ue.l2r(Be).replace(/(^-|i)/g,""),_e=Ke.length;if(String(He).charAt(0)==="M")_e>10||Ke.substr(5)!=="01-01"?Ue._tickround="d":Ue._tickround=+He.substr(1)%12==0?"y":"m";else if(He>=w&&_e<=10||He>=15*w)Ue._tickround="d";else if(He>=L&&_e<=16||He>=k)Ue._tickround="M";else if(He>=M&&_e<=19||He>=L)Ue._tickround="S";else{var Ce=Ue.l2r(Be+He).replace(/^-/,"").length;Ue._tickround=Math.max(_e,Ce)-20,Ue._tickround<0&&(Ue._tickround=4)}}else if(d(He)||He.charAt(0)==="L"){var Le=Ue.range.map(Ue.r2d||Number);d(He)||(He=Number(He.substr(1))),Ue._tickround=2-Math.floor(Math.log(He)/Math.LN10+.01);var Pe=Math.max(Math.abs(Le[0]),Math.abs(Le[1])),Xe=Math.floor(Math.log(Pe)/Math.LN10+.01),ht=Ue.minexponent===void 0?3:Ue.minexponent;Math.abs(Xe)>ht&&(Se(Ue.exponentformat)&&!ze(Xe)?Ue._tickexponent=3*Math.round((Xe-1)/3):Ue._tickexponent=Xe)}else Ue._tickround=null}function we(Ue,He,Be){var Ke=Ue.tickfont||{};return{x:He,dx:0,dy:0,text:Be||"",fontSize:Ke.size,font:Ke.family,fontColor:Ke.color}}z.autoTicks=function(Ue,He){var Be;function Ke(Mt){return Math.pow(Mt,Math.floor(Math.log(He)/Math.LN10))}if(Ue.type==="date"){Ue.tick0=e.dateTick0(Ue.calendar,0);var _e=2*He;if(_e>g)He/=g,Be=Ke(10),Ue.dtick="M"+12*ce(He,Be,de);else if(_e>T)He/=T,Ue.dtick="M"+ce(He,1,ue);else if(_e>w){Ue.dtick=ce(He,w,Ue._hasDayOfWeekBreaks?[1,2,7,14]:ke);var Ce=z.getTickFormat(Ue),Le=Ue.ticklabelmode==="period";Le&&(Ue._rawTick0=Ue.tick0),/%[uVW]/.test(Ce)?Ue.tick0=e.dateTick0(Ue.calendar,2):Ue.tick0=e.dateTick0(Ue.calendar,1),Le&&(Ue._dowTick0=Ue.tick0)}else _e>k?Ue.dtick=ce(He,k,ue):_e>L?Ue.dtick=ce(He,L,ve):_e>M?Ue.dtick=ce(He,M,ve):(Be=Ke(10),Ue.dtick=ce(He,Be,de))}else if(Ue.type==="log"){Ue.tick0=0;var Pe=e.simpleMap(Ue.range,Ue.r2l);if(He>.7)Ue.dtick=Math.ceil(He);else if(Math.abs(Pe[1]-Pe[0])<1){var Xe=1.5*Math.abs((Pe[1]-Pe[0])/He);He=Math.abs(Math.pow(10,Pe[1])-Math.pow(10,Pe[0]))/Xe,Be=Ke(10),Ue.dtick="L"+ce(He,Be,de)}else Ue.dtick=He>.3?"D2":"D1"}else Ue.type==="category"||Ue.type==="multicategory"?(Ue.tick0=0,Ue.dtick=Math.ceil(Math.max(He,1))):tt(Ue)?(Ue.tick0=0,Be=1,Ue.dtick=ce(He,Be,xe)):(Ue.tick0=0,Be=Ke(10),Ue.dtick=ce(He,Be,de));if(Ue.dtick===0&&(Ue.dtick=1),!d(Ue.dtick)&&typeof Ue.dtick!="string"){var ht=Ue.dtick;throw Ue.dtick=1,"ax.dtick error: "+String(ht)}},z.tickIncrement=function(Ue,He,Be,Ke){var _e=Be?-1:1;if(d(He))return e.increment(Ue,_e*He);var Ce=He.charAt(0),Le=_e*Number(He.substr(1));if(Ce==="M")return e.incrementMonth(Ue,Le,Ke);if(Ce==="L")return Math.log(Math.pow(10,Ue)+Le)/Math.LN10;if(Ce==="D"){var Pe=He==="D2"?be:Ee,Xe=Ue+.01*_e,ht=e.roundUp(e.mod(Xe,1),Pe,Be);return Math.floor(Xe)+Math.log(t.round(Math.pow(10,ht),1))/Math.LN10}throw"unrecognized dtick "+String(He)},z.tickFirst=function(Ue,He){var Be=Ue.r2l||Number,Ke=e.simpleMap(Ue.range,Be,void 0,void 0,He),_e=Ke[1]<Ke[0],Ce=_e?Math.floor:Math.ceil,Le=te(Ke)[0],Pe=Ue.dtick,Xe=Be(Ue.tick0);if(d(Pe)){var ht=Ce((Le-Xe)/Pe)*Pe+Xe;return Ue.type!=="category"&&Ue.type!=="multicategory"||(ht=e.constrain(ht,0,Ue._categories.length-1)),ht}var Mt=Pe.charAt(0),pt=Number(Pe.substr(1));if(Mt==="M"){for(var Lt,vt,Dt,xt=0,it=Xe;xt<10;){if(((Lt=z.tickIncrement(it,Pe,_e,Ue.calendar))-Le)*(it-Le)<=0)return _e?Math.min(it,Lt):Math.max(it,Lt);vt=(Le-(it+Lt)/2)/(Lt-it),Dt=Mt+(Math.abs(Math.round(vt))||1)*pt,it=z.tickIncrement(it,Dt,vt<0?!_e:_e,Ue.calendar),xt++}return e.error("tickFirst did not converge",Ue),it}if(Mt==="L")return Math.log(Ce((Math.pow(10,Le)-Xe)/pt)*pt+Xe)/Math.LN10;if(Mt==="D"){var St=Pe==="D2"?be:Ee,Nt=e.roundUp(e.mod(Le,1),St,_e);return Math.floor(Le)+Math.log(t.round(Math.pow(10,Nt),1))/Math.LN10}throw"unrecognized dtick "+String(Pe)},z.tickText=function(Ue,He,Be,Ke){var _e,Ce=we(Ue,He),Le=Ue.tickmode==="array",Pe=Be||Le,Xe=Ue.type,ht=Xe==="category"?Ue.d2l_noadd:Ue.d2l;if(Le&&Array.isArray(Ue.ticktext)){var Mt=e.simpleMap(Ue.range,Ue.r2l),pt=(Math.abs(Mt[1]-Mt[0])-(Ue._lBreaks||0))/1e4;for(_e=0;_e<Ue.ticktext.length&&!(Math.abs(He-ht(Ue.tickvals[_e]))<pt);_e++);if(_e<Ue.ticktext.length)return Ce.text=String(Ue.ticktext[_e]),Ce}function Lt(xt){if(xt===void 0)return!0;if(Be)return xt==="none";var it={first:Ue._tmin,last:Ue._tmax}[xt];return xt!=="all"&&He!==it}var vt=Be?"never":Ue.exponentformat!=="none"&&Lt(Ue.showexponent)?"hide":"";if(Xe==="date"?function(xt,it,St,Nt){var Ut=xt._tickround,Qt=St&&xt.hoverformat||z.getTickFormat(xt);Nt&&(Ut=d(Ut)?4:{y:"m",m:"d",d:"M",M:"S",S:4}[Ut]);var Ie,lt=e.formatDate(it.x,Qt,Ut,xt._dateFormat,xt.calendar,xt._extraFormat),wt=lt.indexOf(`
`);if(wt!==-1&&(Ie=lt.substr(wt+1),lt=lt.substr(0,wt)),Nt&&(lt==="00:00:00"||lt==="00:00"?(lt=Ie,Ie=""):lt.length===8&&(lt=lt.replace(/:00$/,""))),Ie)if(St)Ut==="d"?lt+=", "+Ie:lt=Ie+(lt?", "+lt:"");else if(xt._inCalcTicks&&xt._prevDateHead===Ie){var Ot=er(xt),Gt=xt._realSide||xt.side;(!Ot&&Gt==="top"||Ot&&Gt==="bottom")&&(lt+="<br> ")}else xt._prevDateHead=Ie,lt+="<br>"+Ie;it.text=lt}(Ue,Ce,Be,Pe):Xe==="log"?function(xt,it,St,Nt,Ut){var Qt=xt.dtick,Ie=it.x,lt=xt.tickformat,wt=typeof Qt=="string"&&Qt.charAt(0);if(Ut==="never"&&(Ut=""),Nt&&wt!=="L"&&(Qt="L3",wt="L"),lt||wt==="L")it.text=Fe(Math.pow(10,Ie),xt,Ut,Nt);else if(d(Qt)||wt==="D"&&e.mod(Ie+.01,1)<.1){var Ot=Math.round(Ie),Gt=Math.abs(Ot),ir=xt.exponentformat;ir==="power"||Se(ir)&&ze(Ot)?(it.text=Ot===0?1:Ot===1?"10":"10<sup>"+(Ot>1?"":P)+Gt+"</sup>",it.fontSize*=1.25):(ir==="e"||ir==="E")&&Gt>2?it.text="1"+ir+(Ot>0?"+":P)+Gt:(it.text=Fe(Math.pow(10,Ie),xt,"","fakehover"),Qt==="D1"&&xt._id.charAt(0)==="y"&&(it.dy-=it.fontSize/6))}else{if(wt!=="D")throw"unrecognized dtick "+String(Qt);it.text=String(Math.round(Math.pow(10,e.mod(Ie,1)))),it.fontSize*=.75}if(xt.dtick==="D1"){var Xt=String(it.text).charAt(0);Xt!=="0"&&Xt!=="1"||(xt._id.charAt(0)==="y"?it.dx-=it.fontSize/4:(it.dy+=it.fontSize/2,it.dx+=(xt.range[1]>xt.range[0]?1:-1)*it.fontSize*(Ie<0?.5:.25)))}}(Ue,Ce,0,Pe,vt):Xe==="category"?function(xt,it){var St=xt._categories[Math.round(it.x)];St===void 0&&(St=""),it.text=String(St)}(Ue,Ce):Xe==="multicategory"?function(xt,it,St){var Nt=Math.round(it.x),Ut=xt._categories[Nt]||[],Qt=Ut[1]===void 0?"":String(Ut[1]),Ie=Ut[0]===void 0?"":String(Ut[0]);St?it.text=Ie+" - "+Qt:(it.text=Qt,it.text2=Ie)}(Ue,Ce,Be):tt(Ue)?function(xt,it,St,Nt,Ut){if(xt.thetaunit!=="radians"||St)it.text=Fe(it.x,xt,Ut,Nt);else{var Qt=it.x/180;if(Qt===0)it.text="0";else{var Ie=function(wt){function Ot(Kt,or){return Math.abs(Kt-or)<=1e-6}var Gt=function(Kt){for(var or=1;!Ot(Math.round(Kt*or)/or,Kt);)or*=10;return or}(wt),ir=wt*Gt,Xt=Math.abs(function Kt(or,dr){return Ot(dr,0)?or:Kt(dr,or%dr)}(ir,Gt));return[Math.round(ir/Xt),Math.round(Gt/Xt)]}(Qt);if(Ie[1]>=100)it.text=Fe(e.deg2rad(it.x),xt,Ut,Nt);else{var lt=it.x<0;Ie[1]===1?Ie[0]===1?it.text="\u03C0":it.text=Ie[0]+"\u03C0":it.text=["<sup>",Ie[0],"</sup>","\u2044","<sub>",Ie[1],"</sub>","\u03C0"].join(""),lt&&(it.text=P+it.text)}}}}(Ue,Ce,Be,Pe,vt):function(xt,it,St,Nt,Ut){Ut==="never"?Ut="":xt.showexponent==="all"&&Math.abs(it.x/xt.dtick)<1e-6&&(Ut="hide"),it.text=Fe(it.x,xt,Ut,Nt)}(Ue,Ce,0,Pe,vt),Ke||(Ue.tickprefix&&!Lt(Ue.showtickprefix)&&(Ce.text=Ue.tickprefix+Ce.text),Ue.ticksuffix&&!Lt(Ue.showticksuffix)&&(Ce.text+=Ue.ticksuffix)),Ue.tickson==="boundaries"||Ue.showdividers){var Dt=function(xt){var it=Ue.l2p(xt);return it>=0&&it<=Ue._length?xt:null};Ce.xbnd=[Dt(Ce.x-.5),Dt(Ce.x+Ue.dtick-.5)]}return Ce},z.hoverLabelText=function(Ue,He,Be){Be&&(Ue=e.extendFlat({},Ue,{hoverformat:Be}));var Ke=Array.isArray(He)?He[0]:He,_e=Array.isArray(He)?He[1]:void 0;if(_e!==void 0&&_e!==Ke)return z.hoverLabelText(Ue,Ke,Be)+" - "+z.hoverLabelText(Ue,_e,Be);var Ce=Ue.type==="log"&&Ke<=0,Le=z.tickText(Ue,Ue.c2l(Ce?-Ke:Ke),"hover").text;return Ce?Ke===0?"0":P+Le:Le};var Me=["f","p","n","\u03BC","m","","k","M","G","T"];function Se(Ue){return Ue==="SI"||Ue==="B"}function ze(Ue){return Ue>14||Ue<-15}function Fe(Ue,He,Be,Ke){var _e=Ue<0,Ce=He._tickround,Le=Be||He.exponentformat||"B",Pe=He._tickexponent,Xe=z.getTickFormat(He),ht=He.separatethousands;if(Ke){var Mt={exponentformat:Le,minexponent:He.minexponent,dtick:He.showexponent==="none"?He.dtick:d(Ue)&&Math.abs(Ue)||1,range:He.showexponent==="none"?He.range.map(He.r2d):[0,Ue||1]};ge(Mt),Ce=(Number(Mt._tickround)||0)+4,Pe=Mt._tickexponent,He.hoverformat&&(Xe=He.hoverformat)}if(Xe)return He._numFormat(Xe)(Ue).replace(/-/g,P);var pt,Lt=Math.pow(10,-Ce)/2;if(Le==="none"&&(Pe=0),(Ue=Math.abs(Ue))<Lt)Ue="0",_e=!1;else{if(Ue+=Lt,Pe&&(Ue*=Math.pow(10,-Pe),Ce+=Pe),Ce===0)Ue=String(Math.floor(Ue));else if(Ce<0){Ue=(Ue=String(Math.round(Ue))).substr(0,Ue.length+Ce);for(var vt=Ce;vt<0;vt++)Ue+="0"}else{var Dt=(Ue=String(Ue)).indexOf(".")+1;Dt&&(Ue=Ue.substr(0,Dt+Ce).replace(/\.?0+$/,""))}Ue=e.numSeparate(Ue,He._separators,ht)}return Pe&&Le!=="hide"&&(Se(Le)&&ze(Pe)&&(Le="power"),pt=Pe<0?P+-Pe:Le!=="power"?"+"+Pe:String(Pe),Le==="e"||Le==="E"?Ue+=Le+pt:Le==="power"?Ue+="\xD710<sup>"+pt+"</sup>":Le==="B"&&Pe===9?Ue+="B":Se(Le)&&(Ue+=Me[Pe/3+5])),_e?P+Ue:Ue}function Ye(Ue,He){for(var Be=[],Ke={},_e=0;_e<He.length;_e++){var Ce=He[_e];Ke[Ce.text2]?Ke[Ce.text2].push(Ce.x):Ke[Ce.text2]=[Ce.x]}for(var Le in Ke)Be.push(we(Ue,e.interp(Ke[Le],.5),Le));return Be}function rt(Ue){return Ue.periodX!==void 0?Ue.periodX:Ue.x}function Oe(Ue){return[Ue.text,Ue.x,Ue.axInfo,Ue.font,Ue.fontSize,Ue.fontColor].join("_")}function je(Ue){var He=Ue.title.font.size,Be=(Ue.title.text.match(u.BR_TAG_ALL)||[]).length;return Ue.title.hasOwnProperty("standoff")?Be?He*(H+Be*Y):He*H:Be?He*(Be+1)*Y:He}function We(Ue,He){var Be=Ue.l2p(He);return Be>1&&Be<Ue._length-1}function qe(Ue){var He=t.select(Ue),Be=He.select(".text-math-group");return Be.empty()?He.select("text"):Be}function Qe(Ue){return Ue._id+".automargin"}function st(Ue){return Qe(Ue)+".mirror"}function ct(Ue){return Ue._id+".rangeslider"}function Pt(Ue,He){for(var Be=0;Be<He.length;Be++)Ue.indexOf(He[Be])===-1&&Ue.push(He[Be])}function kt(Ue,He,Be){var Ke,_e,Ce=[],Le=[],Pe=Ue.layout;for(Ke=0;Ke<He.length;Ke++)Ce.push(z.getFromId(Ue,He[Ke]));for(Ke=0;Ke<Be.length;Ke++)Le.push(z.getFromId(Ue,Be[Ke]));var Xe=Object.keys(i),ht=["anchor","domain","overlaying","position","side","tickangle","editType"],Mt=["linear","log"];for(Ke=0;Ke<Xe.length;Ke++){var pt=Xe[Ke],Lt=Ce[0][pt],vt=Le[0][pt],Dt=!0,xt=!1,it=!1;if(pt.charAt(0)!=="_"&&typeof Lt!="function"&&ht.indexOf(pt)===-1){for(_e=1;_e<Ce.length&&Dt;_e++){var St=Ce[_e][pt];pt==="type"&&Mt.indexOf(Lt)!==-1&&Mt.indexOf(St)!==-1&&Lt!==St?xt=!0:St!==Lt&&(Dt=!1)}for(_e=1;_e<Le.length&&Dt;_e++){var Nt=Le[_e][pt];pt==="type"&&Mt.indexOf(vt)!==-1&&Mt.indexOf(Nt)!==-1&&vt!==Nt?it=!0:Le[_e][pt]!==vt&&(Dt=!1)}Dt&&(xt&&(Pe[Ce[0]._name].type="linear"),it&&(Pe[Le[0]._name].type="linear"),at(Pe,pt,Ce,Le,Ue._fullLayout._dfltTitle))}}for(Ke=0;Ke<Ue._fullLayout.annotations.length;Ke++){var Ut=Ue._fullLayout.annotations[Ke];He.indexOf(Ut.xref)!==-1&&Be.indexOf(Ut.yref)!==-1&&e.swapAttrs(Pe.annotations[Ke],["?"])}}function at(Ue,He,Be,Ke,_e){var Ce,Le=e.nestedProperty,Pe=Le(Ue[Be[0]._name],He).get(),Xe=Le(Ue[Ke[0]._name],He).get();for(He==="title"&&(Pe&&Pe.text===_e.x&&(Pe.text=_e.y),Xe&&Xe.text===_e.y&&(Xe.text=_e.x)),Ce=0;Ce<Be.length;Ce++)Le(Ue,Be[Ce]._name+"."+He).set(Xe);for(Ce=0;Ce<Ke.length;Ce++)Le(Ue,Ke[Ce]._name+"."+He).set(Pe)}function tt(Ue){return Ue._id==="angularaxis"}function _t(Ue,He){for(var Be=He._rangebreaks.length,Ke=0;Ke<Be;Ke++){var _e=He._rangebreaks[Ke];if(Ue>=_e.min&&Ue<_e.max)return _e.max}return Ue}function er(Ue){return(Ue.ticklabelposition||"").indexOf("inside")!==-1}function tr(Ue,He){er(Ue._anchorAxis||{})&&Ue._hideCounterAxisInsideTickLabels&&Ue._hideCounterAxisInsideTickLabels(He)}z.getTickFormat=function(Ue){var He,Be,Ke,_e,Ce,Le,Pe,Xe;function ht(Lt){return typeof Lt!="string"?Lt:Number(Lt.replace("M",""))*T}function Mt(Lt,vt){var Dt=["L","D"];if(typeof Lt==typeof vt){if(typeof Lt=="number")return Lt-vt;var xt=Dt.indexOf(Lt.charAt(0)),it=Dt.indexOf(vt.charAt(0));return xt===it?Number(Lt.replace(/(L|D)/g,""))-Number(vt.replace(/(L|D)/g,"")):xt-it}return typeof Lt=="number"?1:-1}function pt(Lt,vt){var Dt=vt[0]===null,xt=vt[1]===null,it=Mt(Lt,vt[0])>=0,St=Mt(Lt,vt[1])<=0;return(Dt||it)&&(xt||St)}if(Ue.tickformatstops&&Ue.tickformatstops.length>0)switch(Ue.type){case"date":case"linear":for(He=0;He<Ue.tickformatstops.length;He++)if((Ke=Ue.tickformatstops[He]).enabled&&(_e=Ue.dtick,Ce=Ke.dtickrange,Le=void 0,Pe=void 0,Xe=void 0,Le=ht||function(Lt){return Lt},Pe=Ce[0],Xe=Ce[1],(!Pe&&typeof Pe!="number"||Le(Pe)<=Le(_e))&&(!Xe&&typeof Xe!="number"||Le(Xe)>=Le(_e)))){Be=Ke;break}break;case"log":for(He=0;He<Ue.tickformatstops.length;He++)if((Ke=Ue.tickformatstops[He]).enabled&&pt(Ue.dtick,Ke.dtickrange)){Be=Ke;break}}return Be?Be.value:Ue.tickformat},z.getSubplots=function(Ue,He){var Be=Ue._fullLayout._subplots,Ke=Be.cartesian.concat(Be.gl2d||[]),_e=He?z.findSubplotsWithAxis(Ke,He):Ke;return _e.sort(function(Ce,Le){var Pe=Ce.substr(1).split("y"),Xe=Le.substr(1).split("y");return Pe[0]===Xe[0]?+Pe[1]-+Xe[1]:+Pe[0]-+Xe[0]}),_e},z.findSubplotsWithAxis=function(Ue,He){for(var Be=new RegExp(He._id.charAt(0)==="x"?"^"+He._id+"y":He._id+"$"),Ke=[],_e=0;_e<Ue.length;_e++){var Ce=Ue[_e];Be.test(Ce)&&Ke.push(Ce)}return Ke},z.makeClipPaths=function(Ue){var He=Ue._fullLayout;if(!He._hasOnlyLargeSploms){var Be,Ke,_e={_offset:0,_length:He.width,_id:""},Ce={_offset:0,_length:He.height,_id:""},Le=z.list(Ue,"x",!0),Pe=z.list(Ue,"y",!0),Xe=[];for(Be=0;Be<Le.length;Be++)for(Xe.push({x:Le[Be],y:Ce}),Ke=0;Ke<Pe.length;Ke++)Be===0&&Xe.push({x:_e,y:Pe[Ke]}),Xe.push({x:Le[Be],y:Pe[Ke]});var ht=He._clips.selectAll(".axesclip").data(Xe,function(Mt){return Mt.x._id+Mt.y._id});ht.enter().append("clipPath").classed("axesclip",!0).attr("id",function(Mt){return"clip"+He._uid+Mt.x._id+Mt.y._id}).append("rect"),ht.exit().remove(),ht.each(function(Mt){t.select(this).select("rect").attr({x:Mt.x._offset||0,y:Mt.y._offset||0,width:Mt.x._length||1,height:Mt.y._length||1})})}},z.draw=function(Ue,He,Be){var Ke=Ue._fullLayout;He==="redraw"&&Ke._paper.selectAll("g.subplot").each(function(Ce){var Le=Ce[0],Pe=Ke._plots[Le];if(Pe){var Xe=Pe.xaxis,ht=Pe.yaxis;Pe.xaxislayer.selectAll("."+Xe._id+"tick").remove(),Pe.yaxislayer.selectAll("."+ht._id+"tick").remove(),Pe.xaxislayer.selectAll("."+Xe._id+"tick2").remove(),Pe.yaxislayer.selectAll("."+ht._id+"tick2").remove(),Pe.xaxislayer.selectAll("."+Xe._id+"divider").remove(),Pe.yaxislayer.selectAll("."+ht._id+"divider").remove(),Pe.gridlayer&&Pe.gridlayer.selectAll("path").remove(),Pe.zerolinelayer&&Pe.zerolinelayer.selectAll("path").remove(),Ke._infolayer.select(".g-"+Xe._id+"title").remove(),Ke._infolayer.select(".g-"+ht._id+"title").remove()}});var _e=He&&He!=="redraw"?He:z.listIds(Ue);return e.syncOrAsync(_e.map(function(Ce){return function(){if(Ce){var Le=z.getFromId(Ue,Ce),Pe=z.drawOne(Ue,Le,Be);return Le._r=Le.range.slice(),Le._rl=e.simpleMap(Le._r,Le.r2l),Pe}}}))},z.drawOne=function(Ue,He,Be){var Ke,_e,Ce;Be=Be||{},He.setScale();var Le=Ue._fullLayout,Pe=He._id,Xe=Pe.charAt(0),ht=z.counterLetter(Pe),Mt=Le._plots[He._mainSubplot];if(Mt){var pt=Mt[Xe+"axislayer"],Lt=He._mainLinePosition,vt=He._mainMirrorPosition,Dt=He._vals=z.calcTicks(He),xt=[He.mirror,Lt,vt].join("_");for(Ke=0;Ke<Dt.length;Ke++)Dt[Ke].axInfo=xt;He._selections={},He._tickAngles&&(He._prevTickAngles=He._tickAngles),He._tickAngles={},He._depth=null;var it={};if(He.visible){var St,Nt,Ut=z.makeTransTickFn(He),Qt=z.makeTransTickLabelFn(He),Ie=He.ticks==="inside",lt=He.ticks==="outside";if(He.tickson==="boundaries"){var wt=function(Nr,Pr){var en,tn=[],Qr=function(rn,An){var En=rn.xbnd[An];En!==null&&tn.push(e.extendFlat({},rn,{x:En}))};if(Pr.length){for(en=0;en<Pr.length;en++)Qr(Pr[en],0);Qr(Pr[en-1],1)}return tn}(0,Dt);Nt=z.clipEnds(He,wt),St=Ie?Nt:wt}else Nt=z.clipEnds(He,Dt),St=Ie&&He.ticklabelmode!=="period"?Nt:Dt;var Ot=He._gridVals=Nt,Gt=function(Nr,Pr){var en,tn,Qr=[],rn=Pr.length&&Pr[Pr.length-1].x<Pr[0].x,An=function(Bn,Jt){var It=Bn.xbnd[Jt];It!==null&&Qr.push(e.extendFlat({},Bn,{x:It}))};if(Nr.showdividers&&Pr.length){for(en=0;en<Pr.length;en++){var En=Pr[en];En.text2!==tn&&An(En,rn?1:0),tn=En.text2}An(Pr[en-1],rn?0:1)}return Qr}(He,Dt);if(!Le._hasOnlyLargeSploms){var ir=He._subplotsWith,Xt={};for(Ke=0;Ke<ir.length;Ke++){_e=ir[Ke];var Kt=(Ce=Le._plots[_e])[ht+"axis"],or=Kt._mainAxis._id;if(!Xt[or]){Xt[or]=1;var dr=Xe==="x"?"M0,"+Kt._offset+"v"+Kt._length:"M"+Kt._offset+",0h"+Kt._length;z.drawGrid(Ue,He,{vals:Ot,counterAxis:Kt,layer:Ce.gridlayer.select("."+Pe),path:dr,transFn:Ut}),z.drawZeroLine(Ue,He,{counterAxis:Kt,layer:Ce.zerolinelayer,path:dr,transFn:Ut})}}}var vr=z.getTickSigns(He),ur=[];if(He.ticks){var pr,br,Rr,_r=z.makeTickPath(He,Lt,vr[2]);if(He._anchorAxis&&He.mirror&&He.mirror!==!0?(pr=z.makeTickPath(He,vt,vr[3]),br=_r+pr):(pr="",br=_r),He.showdividers&&lt&&He.tickson==="boundaries"){var jr={};for(Ke=0;Ke<Gt.length;Ke++)jr[Gt[Ke].x]=1;Rr=function(Nr){return jr[Nr.x]?pr:br}}else Rr=br;z.drawTicks(Ue,He,{vals:St,layer:pt,path:Rr,transFn:Ut}),He.mirror==="allticks"&&(ur=Object.keys(He._linepositions||{}))}for(Ke=0;Ke<ur.length;Ke++){_e=ur[Ke],Ce=Le._plots[_e];var $r=He._linepositions[_e]||[],pn=z.makeTickPath(He,$r[0],vr[0])+z.makeTickPath(He,$r[1],vr[1]);z.drawTicks(Ue,He,{vals:St,layer:Ce[Xe+"axislayer"],path:pn,transFn:Ut})}var In=[];if(In.push(function(){return z.drawLabels(Ue,He,{vals:Dt,layer:pt,plotinfo:Ce,transFn:Qt,labelFns:z.makeLabelFns(He,Lt)})}),He.type==="multicategory"){var On={x:2,y:10}[Xe];In.push(function(){var Nr={x:"height",y:"width"}[Xe],Pr=an()[Nr]+On+(He._tickAngles[Pe+"tick"]?He.tickfont.size*Y:0);return z.drawLabels(Ue,He,{vals:Ye(He,Dt),layer:pt,cls:Pe+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:Ut,labelFns:z.makeLabelFns(He,Lt+Pr*vr[4])})}),In.push(function(){return He._depth=vr[4]*(an("tick2")[He.side]-Lt),function(Nr,Pr,en){var tn=Pr._id+"divider",Qr=en.vals,rn=en.layer.selectAll("path."+tn).data(Qr,Oe);rn.exit().remove(),rn.enter().insert("path",":first-child").classed(tn,1).classed("crisp",1).call(l.stroke,Pr.dividercolor).style("stroke-width",o.crispRound(Nr,Pr.dividerwidth,1)+"px"),rn.attr("transform",en.transFn).attr("d",en.path)}(Ue,He,{vals:Gt,layer:pt,path:z.makeTickPath(He,Lt,vr[4],He._depth),transFn:Ut})})}else He.title.hasOwnProperty("standoff")&&In.push(function(){He._depth=vr[4]*(an()[He.side]-Lt)});var Sn=p.getComponentMethod("rangeslider","isVisible")(He);return In.push(function(){var Nr,Pr,en,tn,Qr=He.side.charAt(0),rn=$[He.side].charAt(0),An=z.getPxPosition(Ue,He),En=lt?He.ticklen:0;if((He.automargin||Sn)&&(He.type==="multicategory"?Nr=an("tick2"):(Nr=an(),Xe==="x"&&Qr==="b"&&(He._depth=Math.max(Nr.width>0?Nr.bottom-An:0,En)))),He.automargin){Pr={x:0,y:0,r:0,l:0,t:0,b:0};var Bn=[0,1];if(Xe==="x"){if(Qr==="b"?Pr[Qr]=He._depth:(Pr[Qr]=He._depth=Math.max(Nr.width>0?An-Nr.top:0,En),Bn.reverse()),Nr.width>0){var Jt=Nr.right-(He._offset+He._length);Jt>0&&(Pr.xr=1,Pr.r=Jt);var It=He._offset-Nr.left;It>0&&(Pr.xl=0,Pr.l=It)}}else if(Qr==="l"?Pr[Qr]=He._depth=Math.max(Nr.height>0?An-Nr.left:0,En):(Pr[Qr]=He._depth=Math.max(Nr.height>0?Nr.right-An:0,En),Bn.reverse()),Nr.height>0){var qt=Nr.bottom-(He._offset+He._length);qt>0&&(Pr.yb=0,Pr.b=qt);var fr=He._offset-Nr.top;fr>0&&(Pr.yt=1,Pr.t=fr)}Pr[ht]=He.anchor==="free"?He.position:He._anchorAxis.domain[Bn[0]],He.title.text!==Le._dfltTitle[Xe]&&(Pr[Qr]+=je(He)+(He.title.standoff||0)),He.mirror&&He.anchor!=="free"&&((en={x:0,y:0,r:0,l:0,t:0,b:0})[rn]=He.linewidth,He.mirror&&He.mirror!==!0&&(en[rn]+=En),He.mirror===!0||He.mirror==="ticks"?en[ht]=He._anchorAxis.domain[Bn[1]]:He.mirror!=="all"&&He.mirror!=="allticks"||(en[ht]=[He._counterDomainMin,He._counterDomainMax][Bn[1]]))}Sn&&(tn=p.getComponentMethod("rangeslider","autoMarginOpts")(Ue,He)),m.autoMargin(Ue,Qe(He),Pr),m.autoMargin(Ue,st(He),en),m.autoMargin(Ue,ct(He),tn)}),Be.skipTitle||Sn&&He.side==="bottom"||In.push(function(){return function(Nr,Pr){var en,tn=Nr._fullLayout,Qr=Pr._id,rn=Qr.charAt(0),An=Pr.title.font.size;if(Pr.title.hasOwnProperty("standoff"))en=Pr._depth+Pr.title.standoff+je(Pr);else{var En=er(Pr);if(Pr.type==="multicategory")en=Pr._depth;else{var Bn=1.5*An;En&&(Bn=.5*An,Pr.ticks==="outside"&&(Bn+=Pr.ticklen)),en=10+Bn+(Pr.linewidth?Pr.linewidth-1:0)}En||(en+=rn==="x"?Pr.side==="top"?An*(Pr.showticklabels?1:0):An*(Pr.showticklabels?1.5:.5):Pr.side==="right"?An*(Pr.showticklabels?1:.5):An*(Pr.showticklabels?.5:0))}var Jt,It,qt,fr,Tr=z.getPxPosition(Nr,Pr);if(rn==="x"?(It=Pr._offset+Pr._length/2,qt=Pr.side==="top"?Tr-en:Tr+en):(qt=Pr._offset+Pr._length/2,It=Pr.side==="right"?Tr+en:Tr-en,Jt={rotate:"-90",offset:0}),Pr.type!=="multicategory"){var Gr=Pr._selections[Pr._id+"tick"];if(fr={selection:Gr,side:Pr.side},Gr&&Gr.node()&&Gr.node().parentNode){var Vr=o.getTranslate(Gr.node().parentNode);fr.offsetLeft=Vr.x,fr.offsetTop=Vr.y}Pr.title.hasOwnProperty("standoff")&&(fr.pad=0)}return s.draw(Nr,Qr+"title",{propContainer:Pr,propName:Pr._name+".title.text",placeholder:tn._dfltTitle[rn],avoid:fr,transform:Jt,attributes:{x:It,y:qt,"text-anchor":"middle"}})}(Ue,He)}),e.syncOrAsync(In)}}function an(Nr){var Pr=Pe+(Nr||"tick");return it[Pr]||(it[Pr]=function(en,tn){var Qr,rn,An,En;return en._selections[tn].size()?(Qr=1/0,rn=-1/0,An=1/0,En=-1/0,en._selections[tn].each(function(){var Bn=qe(this),Jt=o.bBox(Bn.node().parentNode);Qr=Math.min(Qr,Jt.top),rn=Math.max(rn,Jt.bottom),An=Math.min(An,Jt.left),En=Math.max(En,Jt.right)})):(Qr=0,rn=0,An=0,En=0),{top:Qr,bottom:rn,left:An,right:En,height:rn-Qr,width:En-An}}(He,Pr)),it[Pr]}},z.getTickSigns=function(Ue){var He=Ue._id.charAt(0),Be={x:"top",y:"right"}[He],Ke=Ue.side===Be?1:-1,_e=[-1,1,Ke,-Ke];return Ue.ticks!=="inside"==(He==="x")&&(_e=_e.map(function(Ce){return-Ce})),Ue.side&&_e.push({l:-1,t:-1,r:1,b:1}[Ue.side.charAt(0)]),_e},z.makeTransTickFn=function(Ue){return Ue._id.charAt(0)==="x"?function(He){return f(Ue._offset+Ue.l2p(He.x),0)}:function(He){return f(0,Ue._offset+Ue.l2p(He.x))}},z.makeTransTickLabelFn=function(Ue){var He=function(_e){var Ce=_e.ticklabelposition||"",Le=function(St){return Ce.indexOf(St)!==-1},Pe=Le("top"),Xe=Le("left"),ht=Le("right"),Mt=Le("bottom"),pt=Le("inside"),Lt=Mt||Xe||Pe||ht;if(!Lt&&!pt)return[0,0];var vt=_e.side,Dt=Lt?(_e.tickwidth||0)/2:0,xt=3,it=_e.tickfont?_e.tickfont.size:12;return(Mt||Pe)&&(Dt+=it*H,xt+=(_e.linewidth||0)/2),(Xe||ht)&&(Dt+=(_e.linewidth||0)/2,xt+=3),pt&&vt==="top"&&(xt-=it*(1-H)),(Xe||Pe)&&(Dt=-Dt),vt!=="bottom"&&vt!=="right"||(xt=-xt),[Lt?Dt:0,pt?xt:0]}(Ue),Be=He[0],Ke=He[1];return Ue._id.charAt(0)==="x"?function(_e){return f(Be+Ue._offset+Ue.l2p(rt(_e)),Ke)}:function(_e){return f(Ke,Be+Ue._offset+Ue.l2p(rt(_e)))}},z.makeTickPath=function(Ue,He,Be,Ke){Ke=Ke!==void 0?Ke:Ue.ticklen;var _e=Ue._id.charAt(0),Ce=(Ue.linewidth||1)/2;return _e==="x"?"M0,"+(He+Ce*Be)+"v"+Ke*Be:"M"+(He+Ce*Be)+",0h"+Ke*Be},z.makeLabelFns=function(Ue,He,Be){var Ke=Ue.ticklabelposition||"",_e=function(Xt){return Ke.indexOf(Xt)!==-1},Ce=_e("top"),Le=_e("left"),Pe=_e("right"),Xe=_e("bottom")||Le||Ce||Pe,ht=_e("inside"),Mt=Ke==="inside"&&Ue.ticks==="inside"||!ht&&Ue.ticks==="outside"&&Ue.tickson!=="boundaries",pt=0,Lt=0,vt=Mt?Ue.ticklen:0;if(ht?vt*=-1:Xe&&(vt=0),Mt&&(pt+=vt,Be)){var Dt=e.deg2rad(Be);pt=vt*Math.cos(Dt)+1,Lt=vt*Math.sin(Dt)}Ue.showticklabels&&(Mt||Ue.showline)&&(pt+=.2*Ue.tickfont.size);var xt,it,St,Nt,Ut,Qt={labelStandoff:pt+=(Ue.linewidth||1)/2*(ht?-1:1),labelShift:Lt},Ie=0,lt=Ue.side,wt=Ue._id.charAt(0),Ot=Ue.tickangle;if(wt==="x")Nt=(Ut=!ht&&lt==="bottom"||ht&&lt==="top")?1:-1,ht&&(Nt*=-1),xt=Lt*Nt,it=He+pt*Nt,St=Ut?1:-.2,Math.abs(Ot)===90&&(ht?St+=Z:St=Ot===-90&&lt==="bottom"?H:Ot===90&&lt==="top"?Z:.5,Ie=Z/2*(Ot/90)),Qt.xFn=function(Xt){return Xt.dx+xt+Ie*Xt.fontSize},Qt.yFn=function(Xt){return Xt.dy+it+Xt.fontSize*St},Qt.anchorFn=function(Xt,Kt){if(Xe){if(Le)return"end";if(Pe)return"start"}return d(Kt)&&Kt!==0&&Kt!==180?Kt*Nt<0!==ht?"end":"start":"middle"},Qt.heightFn=function(Xt,Kt,or){return Kt<-60||Kt>60?-.5*or:Ue.side==="top"!==ht?-or:0};else if(wt==="y"){if(Nt=(Ut=!ht&&lt==="left"||ht&&lt==="right")?1:-1,ht&&(Nt*=-1),xt=pt,it=Lt*Nt,St=0,ht||Math.abs(Ot)!==90||(St=Ot===-90&&lt==="left"||Ot===90&&lt==="right"?H:.5),ht){var Gt=d(Ot)?+Ot:0;if(Gt!==0){var ir=e.deg2rad(Gt);Ie=Math.abs(Math.sin(ir))*H*Nt,St=0}}Qt.xFn=function(Xt){return Xt.dx+He-(xt+Xt.fontSize*St)*Nt+Ie*Xt.fontSize},Qt.yFn=function(Xt){return Xt.dy+it+Xt.fontSize*Z},Qt.anchorFn=function(Xt,Kt){return d(Kt)&&Math.abs(Kt)===90?"middle":Ut?"end":"start"},Qt.heightFn=function(Xt,Kt,or){return Ue.side==="right"&&(Kt*=-1),Kt<-30?-or:Kt<30?-.5*or:0}}return Qt},z.drawTicks=function(Ue,He,Be){Be=Be||{};var Ke=He._id+"tick",_e=Be.vals;He.ticklabelmode==="period"&&(_e=_e.slice()).shift();var Ce=Be.layer.selectAll("path."+Ke).data(He.ticks?_e:[],Oe);Ce.exit().remove(),Ce.enter().append("path").classed(Ke,1).classed("ticks",1).classed("crisp",Be.crisp!==!1).call(l.stroke,He.tickcolor).style("stroke-width",o.crispRound(Ue,He.tickwidth,1)+"px").attr("d",Be.path).style("display",null),tr(He,[q]),Ce.attr("transform",Be.transFn)},z.drawGrid=function(Ue,He,Be){Be=Be||{};var Ke=He._id+"grid",_e=Be.vals,Ce=Be.counterAxis;if(He.showgrid===!1)_e=[];else if(Ce&&z.shouldShowZeroLine(Ue,He,Ce))for(var Le=He.tickmode==="array",Pe=0;Pe<_e.length;Pe++){var Xe=_e[Pe].x;if(Le?!Xe:Math.abs(Xe)<He.dtick/100){if(_e=_e.slice(0,Pe).concat(_e.slice(Pe+1)),!Le)break;Pe--}}var ht=Be.layer.selectAll("path."+Ke).data(_e,Oe);ht.exit().remove(),ht.enter().append("path").classed(Ke,1).classed("crisp",Be.crisp!==!1),He._gw=o.crispRound(Ue,He.gridwidth,1),ht.attr("transform",Be.transFn).attr("d",Be.path).call(l.stroke,He.gridcolor||"#ddd").style("stroke-width",He._gw+"px").style("display",null),tr(He,[U]),typeof Be.path=="function"&&ht.attr("d",Be.path)},z.drawZeroLine=function(Ue,He,Be){Be=Be||Be;var Ke=He._id+"zl",_e=z.shouldShowZeroLine(Ue,He,Be.counterAxis),Ce=Be.layer.selectAll("path."+Ke).data(_e?[{x:0,id:He._id}]:[]);Ce.exit().remove(),Ce.enter().append("path").classed(Ke,1).classed("zl",1).classed("crisp",Be.crisp!==!1).each(function(){Be.layer.selectAll("path").sort(function(Le,Pe){return ee(Le.id,Pe.id)})}),Ce.attr("transform",Be.transFn).attr("d",Be.path).call(l.stroke,He.zerolinecolor||l.defaultLine).style("stroke-width",o.crispRound(Ue,He.zerolinewidth,He._gw||1)+"px").style("display",null),tr(He,[N])},z.drawLabels=function(Ue,He,Be){Be=Be||{};var Ke=Ue._fullLayout,_e=He._id,Ce=_e.charAt(0),Le=Be.cls||_e+"tick",Pe=Be.vals,Xe=Be.labelFns,ht=Be.secondary?0:He.tickangle,Mt=(He._prevTickAngles||{})[Le],pt=Be.layer.selectAll("g."+Le).data(He.showticklabels?Pe:[],Oe),Lt=[];function vt(Nt,Ut){Nt.each(function(Qt){var Ie=t.select(this),lt=Ie.select(".text-math-group"),wt=Xe.anchorFn(Qt,Ut),Ot=Be.transFn.call(Ie.node(),Qt)+(d(Ut)&&+Ut!=0?" rotate("+Ut+","+Xe.xFn(Qt)+","+(Xe.yFn(Qt)-Qt.fontSize/2)+")":""),Gt=u.lineCount(Ie),ir=Y*Qt.fontSize,Xt=Xe.heightFn(Qt,d(Ut)?+Ut:0,(Gt-1)*ir);if(Xt&&(Ot+=f(0,Xt)),lt.empty()){var Kt=Ie.select("text");Kt.attr({transform:Ot,"text-anchor":wt}),Kt.style("opacity",1),He._adjustTickLabelsOverflow&&He._adjustTickLabelsOverflow()}else{var or=o.bBox(lt.node()).width*{end:-.5,start:.5}[wt];lt.attr("transform",Ot+f(or,0))}})}pt.enter().append("g").classed(Le,1).append("text").attr("text-anchor","middle").each(function(Nt){var Ut=t.select(this),Qt=Ue._promises.length;Ut.call(u.positionText,Xe.xFn(Nt),Xe.yFn(Nt)).call(o.font,Nt.font,Nt.fontSize,Nt.fontColor).text(Nt.text).call(u.convertToTspans,Ue),Ue._promises[Qt]?Lt.push(Ue._promises.pop().then(function(){vt(Ut,ht)})):vt(Ut,ht)}),tr(He,[X]),pt.exit().remove(),Be.repositionOnUpdate&&pt.each(function(Nt){t.select(this).select("text").call(u.positionText,Xe.xFn(Nt),Xe.yFn(Nt))}),He._adjustTickLabelsOverflow=function(){var Nt=He.ticklabeloverflow;if(Nt&&Nt!=="allow"){var Ut=Nt.indexOf("hide")!==-1,Qt=He._id.charAt(0)==="x",Ie=0,lt=Qt?Ue._fullLayout.width:Ue._fullLayout.height;if(Nt.indexOf("domain")!==-1){var wt=e.simpleMap(He.range,He.r2l);Ie=He.l2p(wt[0])+He._offset,lt=He.l2p(wt[1])+He._offset}var Ot=Math.min(Ie,lt),Gt=Math.max(Ie,lt),ir=He.side,Xt=1/0,Kt=-1/0;for(var or in pt.each(function(ur){var pr=t.select(this);if(pr.select(".text-math-group").empty()){var br=o.bBox(pr.node()),Rr=0;Qt?(br.right>Gt||br.left<Ot)&&(Rr=1):(br.bottom>Gt||br.top+(He.tickangle?0:ur.fontSize/4)<Ot)&&(Rr=1);var _r=pr.select("text");Rr?Ut&&_r.style("opacity",0):(_r.style("opacity",1),Xt=ir==="bottom"||ir==="right"?Math.min(Xt,Qt?br.top:br.left):-1/0,Kt=ir==="top"||ir==="left"?Math.max(Kt,Qt?br.bottom:br.right):1/0)}}),Ke._plots){var dr=Ke._plots[or];if(He._id===dr.xaxis._id||He._id===dr.yaxis._id){var vr=Qt?dr.yaxis:dr.xaxis;vr&&(vr["_visibleLabelMin_"+He._id]=Xt,vr["_visibleLabelMax_"+He._id]=Kt)}}}},He._hideCounterAxisInsideTickLabels=function(Nt){var Ut=He._id.charAt(0)==="x",Qt=[];for(var Ie in Ke._plots){var lt=Ke._plots[Ie];He._id!==lt.xaxis._id&&He._id!==lt.yaxis._id||Qt.push(Ut?lt.yaxis:lt.xaxis)}Qt.forEach(function(wt,Ot){wt&&er(wt)&&(Nt||[N,U,q,X]).forEach(function(Gt){var ir=Gt.K==="tick"&&Gt.L==="text"&&He.ticklabelmode==="period",Xt=Ke._plots[He._mainSubplot];(Gt.K===N.K?Xt.zerolinelayer.selectAll("."+He._id+"zl"):Gt.K===U.K?Xt.gridlayer.selectAll("."+He._id):Xt[He._id.charAt(0)+"axislayer"]).each(function(){var Kt=t.select(this);Gt.L&&(Kt=Kt.selectAll(Gt.L)),Kt.each(function(or){var dr=He.l2p(ir?rt(or):or.x)+He._offset,vr=t.select(this);dr<He["_visibleLabelMax_"+wt._id]&&dr>He["_visibleLabelMin_"+wt._id]?vr.style("display","none"):Gt.K!=="tick"||Ot||vr.style("display",null)})})})})},vt(pt,Mt+1?Mt:ht);var Dt=null;He._selections&&(He._selections[Le]=pt);var xt=[function(){return Lt.length&&Promise.all(Lt)}];He.automargin&&Ke._redrawFromAutoMarginCount&&Mt===90?(Dt=90,xt.push(function(){vt(pt,Mt)})):xt.push(function(){if(vt(pt,ht),Pe.length&&Ce==="x"&&!d(ht)&&(He.type!=="log"||String(He.dtick).charAt(0)!=="D")){Dt=0;var Nt,Ut=0,Qt=[];if(pt.each(function(pr){Ut=Math.max(Ut,pr.fontSize);var br=He.l2p(pr.x),Rr=qe(this),_r=o.bBox(Rr.node());Qt.push({top:0,bottom:10,height:10,left:br-_r.width/2,right:br+_r.width/2+2,width:_r.width+2})}),He.tickson!=="boundaries"&&!He.showdividers||Be.secondary){var Ie=Pe.length,lt=Math.abs((Pe[Ie-1].x-Pe[0].x)*He._m)/(Ie-1),wt=He.ticklabelposition||"",Ot=function(pr){return wt.indexOf(pr)!==-1},Gt=Ot("top"),ir=Ot("left"),Xt=Ot("right"),Kt=Ot("bottom")||ir||Gt||Xt?(He.tickwidth||0)+6:0,or=lt<2.5*Ut||He.type==="multicategory";for(Nt=0;Nt<Qt.length-1;Nt++)if(e.bBoxIntersect(Qt[Nt],Qt[Nt+1],Kt)){Dt=or?90:30;break}}else{var dr=2;for(He.ticks&&(dr+=He.tickwidth/2),Nt=0;Nt<Qt.length;Nt++){var vr=Pe[Nt].xbnd,ur=Qt[Nt];if(vr[0]!==null&&ur.left-He.l2p(vr[0])<dr||vr[1]!==null&&He.l2p(vr[1])-ur.right<dr){Dt=90;break}}}Dt&&vt(pt,Dt)}}),He._tickAngles&&xt.push(function(){He._tickAngles[Le]=Dt===null?d(ht)?ht:0:Dt});var it=He._anchorAxis;it&&it.autorange&&er(He)&&!J(Ke,He._id)&&(Ke._insideTickLabelsAutorange||(Ke._insideTickLabelsAutorange={}),Ke._insideTickLabelsAutorange[it._name+".autorange"]=it.autorange,xt.push(function(){pt.each(function(Nt,Ut){var Qt=qe(this);Qt.select(".text-math-group").empty()&&(He._vals[Ut].bb=o.bBox(Qt.node()))})}));var St=e.syncOrAsync(xt);return St&&St.then&&Ue._promises.push(St),St},z.getPxPosition=function(Ue,He){var Be,Ke=Ue._fullLayout._size,_e=He._id.charAt(0),Ce=He.side;return He.anchor!=="free"?Be=He._anchorAxis:_e==="x"?Be={_offset:Ke.t+(1-(He.position||0))*Ke.h,_length:0}:_e==="y"&&(Be={_offset:Ke.l+(He.position||0)*Ke.w,_length:0}),Ce==="top"||Ce==="left"?Be._offset:Ce==="bottom"||Ce==="right"?Be._offset+Be._length:void 0},z.shouldShowZeroLine=function(Ue,He,Be){var Ke=e.simpleMap(He.range,He.r2l);return Ke[0]*Ke[1]<=0&&He.zeroline&&(He.type==="linear"||He.type==="-")&&!(He.rangebreaks&&He.maskBreaks(0)===D)&&(We(He,0)||!function(_e,Ce,Le,Pe){var Xe=Le._mainAxis;if(!Xe)return;var ht=_e._fullLayout,Mt=Ce._id.charAt(0),pt=z.counterLetter(Ce._id),Lt=Ce._offset+(Math.abs(Pe[0])<Math.abs(Pe[1])==(Mt==="x")?0:Ce._length);function vt(Nt){if(!Nt.showline||!Nt.linewidth)return!1;var Ut=Math.max((Nt.linewidth+Ce.zerolinewidth)/2,1);function Qt(wt){return typeof wt=="number"&&Math.abs(wt-Lt)<Ut}if(Qt(Nt._mainLinePosition)||Qt(Nt._mainMirrorPosition))return!0;var Ie=Nt._linepositions||{};for(var lt in Ie)if(Qt(Ie[lt][0])||Qt(Ie[lt][1]))return!0}var Dt=ht._plots[Le._mainSubplot];if(!(Dt.mainplotinfo||Dt).overlays.length)return vt(Le);for(var xt=z.list(_e,pt),it=0;it<xt.length;it++){var St=xt[it];if(St._mainAxis===Xe&&vt(St))return!0}}(Ue,He,Be,Ke)||function(_e,Ce){for(var Le=_e._fullData,Pe=Ce._mainSubplot,Xe=Ce._id.charAt(0),ht=0;ht<Le.length;ht++){var Mt=Le[ht];if(Mt.visible===!0&&Mt.xaxis+Mt.yaxis===Pe&&(p.traceIs(Mt,"bar-like")&&Mt.orientation==={x:"h",y:"v"}[Xe]||Mt.fill&&Mt.fill.charAt(Mt.fill.length-1)===Xe))return!0}return!1}(Ue,He))},z.clipEnds=function(Ue,He){return He.filter(function(Be){return We(Ue,Be.x)})},z.allowAutoMargin=function(Ue){for(var He=z.list(Ue,"",!0),Be=0;Be<He.length;Be++){var Ke=He[Be];Ke.automargin&&(m.allowAutoMargin(Ue,Qe(Ke)),Ke.mirror&&m.allowAutoMargin(Ue,st(Ke))),p.getComponentMethod("rangeslider","isVisible")(Ke)&&m.allowAutoMargin(Ue,ct(Ke))}},z.swap=function(Ue,He){for(var Be=function(_e,Ce){var Le,Pe,Xe=[];for(Le=0;Le<Ce.length;Le++){var ht=[],Mt=_e._fullData[Ce[Le]].xaxis,pt=_e._fullData[Ce[Le]].yaxis;if(Mt&&pt){for(Pe=0;Pe<Xe.length;Pe++)Xe[Pe].x.indexOf(Mt)===-1&&Xe[Pe].y.indexOf(pt)===-1||ht.push(Pe);if(ht.length){var Lt,vt=Xe[ht[0]];if(ht.length>1)for(Pe=1;Pe<ht.length;Pe++)Lt=Xe[ht[Pe]],Pt(vt.x,Lt.x),Pt(vt.y,Lt.y);Pt(vt.x,[Mt]),Pt(vt.y,[pt])}else Xe.push({x:[Mt],y:[pt]})}}return Xe}(Ue,He),Ke=0;Ke<Be.length;Ke++)kt(Ue,Be[Ke].x,Be[Ke].y)}},{"../../components/color":650,"../../components/drawing":672,"../../components/titles":748,"../../constants/alignment":755,"../../constants/numerical":763,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/plots":901,"../../registry":915,"./autorange":837,"./axis_autotype":839,"./axis_ids":842,"./clean_ticks":844,"./layout_attributes":853,"./set_convert":859,"@plotly/d3":58,"fast-isnumeric":246}],839:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../constants/numerical").BADNUM,p=d.isArrayOrTypedArray,e=d.isDateTime,f=d.cleanNumber,u=Math.round;function s(o,i){return i?t(o):typeof o=="number"}function l(o){return Math.max(1,(o-1)/1e3)}O.exports=function(o,i,c){var n=o,a=c.noMultiCategory;if(p(n)&&!n.length)return"-";if(!a&&function(_){return p(_[0])&&p(_[1])}(n))return"multicategory";if(a&&Array.isArray(n[0])){for(var g=[],h=0;h<n.length;h++)if(p(n[h]))for(var y=0;y<n[h].length;y++)g.push(n[h][y]);n=g}if(function(_,x){for(var T=_.length,A=l(T),S=0,w=0,C={},k=0;k<T;k+=A){var L=u(k),M=_[L],P=String(M);C[P]||(C[P]=1,e(M,x)&&S++,t(M)&&w++)}return S>2*w}(n,i))return"date";var v=c.autotypenumbers!=="strict";return function(_,x){for(var T=_.length,A=l(T),S=0,w=0,C={},k=0;k<T;k+=A){var L=u(k),M=_[L],P=String(M);if(!C[P]){C[P]=1;var D=typeof M;D==="boolean"?w++:(x?f(M)!==m:D==="number")?S++:D==="string"&&w++}}return w>2*S}(n,v)?"category":function(_,x){for(var T=_.length,A=0;A<T;A++)if(s(_[A],x))return!0;return!1}(n,v)?"linear":"-"}},{"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],840:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../registry"),m=r("../../lib"),p=r("../array_container_defaults"),e=r("./layout_attributes"),f=r("./tick_value_defaults"),u=r("./tick_mark_defaults"),s=r("./tick_label_defaults"),l=r("./category_order_defaults"),o=r("./line_grid_defaults"),i=r("./set_convert"),c=r("./constants").WEEKDAY_PATTERN,n=r("./constants").HOUR_PATTERN;function a(y,v,_){function x(M,P){return m.coerce(y,v,e.rangebreaks,M,P)}if(x("enabled")){var T=x("bounds");if(T&&T.length>=2){var A,S,w="";if(T.length===2){for(A=0;A<2;A++)if(S=h(T[A])){w=c;break}}var C=x("pattern",w);if(C===c)for(A=0;A<2;A++)(S=h(T[A]))&&(v.bounds[A]=T[A]=S-1);if(C)for(A=0;A<2;A++)switch(S=T[A],C){case c:if(!t(S)||(S=+S)!==Math.floor(S)||S<0||S>=7)return void(v.enabled=!1);v.bounds[A]=T[A]=S;break;case n:if(!t(S)||(S=+S)<0||S>24)return void(v.enabled=!1);v.bounds[A]=T[A]=S}if(_.autorange===!1){var k=_.range;if(k[0]<k[1]){if(T[0]<k[0]&&T[1]>k[1])return void(v.enabled=!1)}else if(T[0]>k[0]&&T[1]<k[1])return void(v.enabled=!1)}}else{var L=x("values");if(!L||!L.length)return void(v.enabled=!1);x("dvalue")}}}O.exports=function(y,v,_,x,T){var A,S=x.letter,w=x.font||{},C=x.splomStash||{},k=_("visible",!x.visibleDflt),L=v._template||{},M=v.type||L.type||"-";M==="date"&&(d.getComponentMethod("calendars","handleDefaults")(y,v,"calendar",x.calendar),x.noTicklabelmode||(A=_("ticklabelmode")));var P="";x.noTicklabelposition&&M!=="multicategory"||(P=m.coerce(y,v,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:A==="period"?["outside","inside"]:S==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),x.noTicklabeloverflow||_("ticklabeloverflow",P.indexOf("inside")!==-1?"hide past domain":M==="category"||M==="multicategory"?"allow":"hide past div"),i(v,T);var D=!v.isValidRange(y.range);D&&x.reverseDflt&&(D="reversed"),!_("autorange",D)||M!=="linear"&&M!=="-"||_("rangemode"),_("range"),v.cleanRange(),l(y,v,_,x),M==="category"||x.noHover||_("hoverformat");var N=_("color"),U=N!==e.color.dflt?N:w.color,q=C.label||T._dfltTitle[S];if(s(y,v,_,M,x,{pass:1}),!k)return v;_("title.text",q),m.coerceFont(_,"title.font",{family:w.family,size:m.bigFont(w.size),color:U}),f(y,v,_,M),s(y,v,_,M,x,{pass:2}),u(y,v,_,x),o(y,v,_,{dfltColor:N,bgColor:x.bgColor,showGrid:x.showGrid,attributes:e}),(v.showline||v.ticks)&&_("mirror"),x.automargin&&_("automargin");var X,K=M==="multicategory";if(x.noTickson||M!=="category"&&!K||!v.ticks&&!v.showgrid||(K&&(X="boundaries"),_("tickson",X)==="boundaries"&&delete v.ticklabelposition),K&&_("showdividers")&&(_("dividercolor"),_("dividerwidth")),M==="date")if(p(y,v,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:a}),v.rangebreaks.length){for(var Z=0;Z<v.rangebreaks.length;Z++)if(v.rangebreaks[Z].pattern===c){v._hasDayOfWeekBreaks=!0;break}if(i(v,T),T._has("scattergl")||T._has("splom"))for(var H=0;H<x.data.length;H++){var Y=x.data[H];Y.type!=="scattergl"&&Y.type!=="splom"||(Y.visible=!1,m.warn(Y.type+" traces do not work on axes with rangebreaks. Setting trace "+Y.index+" to `visible: false`."))}}else delete v.rangebreaks;return v};var g={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function h(y){if(typeof y=="string")return g[y.substr(0,3).toLowerCase()]}},{"../../lib":787,"../../registry":915,"../array_container_defaults":833,"./category_order_defaults":843,"./constants":845,"./layout_attributes":853,"./line_grid_defaults":855,"./set_convert":859,"./tick_label_defaults":860,"./tick_mark_defaults":861,"./tick_value_defaults":862,"fast-isnumeric":246}],841:[function(r,O,B){var t=r("../../constants/docs"),d=t.FORMAT_LINK,m=t.DATE_FORMAT_LINK;function p(f,u){return["Sets the "+f+" formatting rule"+(u?"for `"+u+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+d+"."].join(" ")}function e(f,u){return p(f,u)+[" And for dates see: "+m+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}O.exports={axisHoverFormat:function(f,u){return{valType:"string",dflt:"",editType:"none",description:(u?p:e)("hover text",f)+["By default the values are formatted using "+(u?"generic number format":"`"+f+"axis.hoverformat`")+"."].join(" ")}},descriptionOnlyNumbers:p,descriptionWithDates:e}},{"../../constants/docs":758}],842:[function(r,O,B){var t=r("../../registry"),d=r("./constants");function m(p,e){if(e&&e.length){for(var f=0;f<e.length;f++)if(e[f][p])return!0}return!1}B.id2name=function(p){if(typeof p=="string"&&p.match(d.AX_ID_PATTERN)){var e=p.split(" ")[0].substr(1);return e==="1"&&(e=""),p.charAt(0)+"axis"+e}},B.name2id=function(p){if(p.match(d.AX_NAME_PATTERN)){var e=p.substr(5);return e==="1"&&(e=""),p.charAt(0)+e}},B.cleanId=function(p,e,f){var u=/( domain)$/.test(p);if(typeof p=="string"&&p.match(d.AX_ID_PATTERN)&&(!e||p.charAt(0)===e)&&(!u||f)){var s=p.split(" ")[0].substr(1).replace(/^0+/,"");return s==="1"&&(s=""),p.charAt(0)+s+(u&&f?" domain":"")}},B.list=function(p,e,f){var u=p._fullLayout;if(!u)return[];var s,l=B.listIds(p,e),o=new Array(l.length);for(s=0;s<l.length;s++){var i=l[s];o[s]=u[i.charAt(0)+"axis"+i.substr(1)]}if(!f){var c=u._subplots.gl3d||[];for(s=0;s<c.length;s++){var n=u[c[s]];e?o.push(n[e+"axis"]):o.push(n.xaxis,n.yaxis,n.zaxis)}}return o},B.listIds=function(p,e){var f=p._fullLayout;if(!f)return[];var u=f._subplots;return e?u[e+"axis"]:u.xaxis.concat(u.yaxis)},B.getFromId=function(p,e,f){var u=p._fullLayout;return e=e===void 0||typeof e!="string"?e:e.replace(" domain",""),f==="x"?e=e.replace(/y[0-9]*/,""):f==="y"&&(e=e.replace(/x[0-9]*/,"")),u[B.id2name(e)]},B.getFromTrace=function(p,e,f){var u=p._fullLayout,s=null;if(t.traceIs(e,"gl3d")){var l=e.scene;l.substr(0,5)==="scene"&&(s=u[l][f+"axis"])}else s=B.getFromId(p,e[f+"axis"]||f);return s},B.idSort=function(p,e){var f=p.charAt(0),u=e.charAt(0);return f!==u?f>u?1:-1:+(p.substr(1)||1)-+(e.substr(1)||1)},B.ref2id=function(p){return!!/^[xyz]/.test(p)&&p.split(" ")[0]},B.isLinked=function(p,e){return m(e,p._axisMatchGroups)||m(e,p._axisConstraintGroups)}},{"../../registry":915,"./constants":845}],843:[function(r,O,B){O.exports=function(t,d,m,p){if(d.type==="category"){var e,f=t.categoryarray,u=Array.isArray(f)&&f.length>0;u&&(e="array");var s,l=m("categoryorder",e);l==="array"&&(s=m("categoryarray")),u||l!=="array"||(l=d.categoryorder="trace"),l==="trace"?d._initialCategories=[]:l==="array"?d._initialCategories=s.slice():(s=function(o,i){var c,n,a,g=i.dataAttr||o._id.charAt(0),h={};if(i.axData)c=i.axData;else for(c=[],n=0;n<i.data.length;n++){var y=i.data[n];y[g+"axis"]===o._id&&c.push(y)}for(n=0;n<c.length;n++){var v=c[n][g];for(a=0;a<v.length;a++){var _=v[a];_!=null&&(h[_]=1)}}return Object.keys(h)}(d,p).sort(),l==="category ascending"?d._initialCategories=s:l==="category descending"&&(d._initialCategories=s.reverse()))}}},{}],844:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../constants/numerical"),p=m.ONEDAY,e=m.ONEWEEK;B.dtick=function(f,u){var s=u==="log",l=u==="date",o=u==="category",i=l?p:1;if(!f)return i;if(t(f))return(f=Number(f))<=0?i:o?Math.max(1,Math.round(f)):l?Math.max(.1,f):f;if(typeof f!="string"||!l&&!s)return i;var c=f.charAt(0),n=f.substr(1);return(n=t(n)?Number(n):0)<=0||!(l&&c==="M"&&n===Math.round(n)||s&&c==="L"||s&&c==="D"&&(n===1||n===2))?i:f},B.tick0=function(f,u,s,l){return u==="date"?d.cleanDate(f,d.dateTick0(s,l%e==0?1:0)):l!=="D1"&&l!=="D2"?t(f)?Number(f):0:void 0}},{"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],845:[function(r,O,B){var t=r("../../lib/regex").counter;O.exports={idRegex:{x:t("x","( domain)?"),y:t("y","( domain)?")},attrRegex:t("[xy]axis"),xAxisMatch:t("xaxis"),yAxisMatch:t("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":804}],846:[function(r,O,B){var t=r("../../lib"),d=r("./autorange"),m=r("./axis_ids").id2name,p=r("./layout_attributes"),e=r("./scale_zoom"),f=r("./set_convert"),u=r("../../constants/numerical").ALMOST_EQUAL,s=r("../../constants/alignment").FROM_BL;function l(h,y,v){var _=v.axIds,x=v.layoutOut,T=v.hasImage,A=x._axisConstraintGroups,S=x._axisMatchGroups,w=y._id,C=w.charAt(0),k=((x._splomAxes||{})[C]||{})[w]||{},L=y._id,M=L.charAt(0)==="x";function P(ee,J){return t.coerce(h,y,p,ee,J)}y._matchGroup=null,y._constraintGroup=null,P("constrain",T?"domain":"range"),t.coerce(h,y,{constraintoward:{valType:"enumerated",values:M?["left","center","right"]:["bottom","middle","top"],dflt:M?"center":"middle"}},"constraintoward");var D,N,U=y.type,q=[];for(D=0;D<_.length;D++)(N=_[D])!==L&&x[m(N)].type===U&&q.push(N);var X=i(A,L);if(X){var K=[];for(D=0;D<q.length;D++)X[N=q[D]]||K.push(N);q=K}var Z,H,Y=q.length;Y&&(h.matches||k.matches)&&(Z=t.coerce(h,y,{matches:{valType:"enumerated",values:q,dflt:q.indexOf(k.matches)!==-1?k.matches:void 0}},"matches"));var $=T&&!M?y.anchor:void 0;if(Y&&!Z&&(h.scaleanchor||$)&&(H=t.coerce(h,y,{scaleanchor:{valType:"enumerated",values:q}},"scaleanchor",$)),Z){y._matchGroup=c(S,L,Z,1);var z=x[m(Z)],j=o(x,y)/o(x,z);M!==(Z.charAt(0)==="x")&&(j=(M?"x":"y")+j),c(A,L,Z,j)}else h.matches&&_.indexOf(h.matches)!==-1&&t.warn("ignored "+y._name+'.matches: "'+h.matches+'" to avoid an infinite loop');if(H){var W=P("scaleratio");W||(W=y.scaleratio=1),c(A,L,H,W)}else h.scaleanchor&&_.indexOf(h.scaleanchor)!==-1&&t.warn("ignored "+y._name+'.scaleanchor: "'+h.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function o(h,y){var v=y.domain;return v||(v=h[m(y.overlaying)].domain),v[1]-v[0]}function i(h,y){for(var v=0;v<h.length;v++)if(h[v][y])return h[v];return null}function c(h,y,v,_){var x,T,A,S,w,C=i(h,y);C===null?((C={})[y]=1,w=h.length,h.push(C)):w=h.indexOf(C);var k=Object.keys(C);for(x=0;x<h.length;x++)if(A=h[x],x!==w&&A[v]){var L=A[v];for(T=0;T<k.length;T++)A[S=k[T]]=n(L,n(_,C[S]));return void h.splice(w,1)}if(_!==1)for(T=0;T<k.length;T++){var M=k[T];C[M]=n(_,C[M])}C[v]=1}function n(h,y){var v,_,x="",T="";typeof h=="string"&&(v=(x=h.match(/^[xy]*/)[0]).length,h=+h.substr(v)),typeof y=="string"&&(_=(T=y.match(/^[xy]*/)[0]).length,y=+y.substr(_));var A=h*y;return v||_?v&&_&&x.charAt(0)!==T.charAt(0)?v===_?A:(v>_?x.substr(_):T.substr(v))+A:x+T+h*y:A}function a(h,y){for(var v=y._size,_=v.h/v.w,x={},T=Object.keys(h),A=0;A<T.length;A++){var S=T[A],w=h[S];if(typeof w=="string"){var C=w.match(/^[xy]*/)[0],k=C.length;w=+w.substr(k);for(var L=C.charAt(0)==="y"?_:1/_,M=0;M<k;M++)w*=L}x[S]=w}return x}function g(h,y){var v=h._inputDomain,_=s[h.constraintoward],x=v[0]+(v[1]-v[0])*_;h.domain=h._input.domain=[x+(v[0]-x)/y,x+(v[1]-x)/y],h.setScale()}B.handleDefaults=function(h,y,v){var _,x,T,A,S,w,C,k,L=v.axIds,M=v.axHasImage,P=y._axisConstraintGroups=[],D=y._axisMatchGroups=[];for(_=0;_<L.length;_++)l(S=h[A=m(L[_])],w=y[A],{axIds:L,layoutOut:y,hasImage:M[A]});function N(z,j){for(_=0;_<z.length;_++)for(T in x=z[_])y[m(T)][j]=x}for(N(D,"_matchGroup"),_=0;_<P.length;_++)for(T in x=P[_])if((w=y[m(T)]).fixedrange){for(var U in x){var q=m(U);(h[q]||{}).fixedrange===!1&&t.warn("fixedrange was specified as false for axis "+q+" but was overridden because another axis in its constraint group has fixedrange true"),y[q].fixedrange=!0}break}for(_=0;_<P.length;){for(T in x=P[_]){(w=y[m(T)])._matchGroup&&Object.keys(w._matchGroup).length===Object.keys(x).length&&(P.splice(_,1),_--);break}_++}N(P,"_constraintGroup");var X=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],K=!1,Z=!1;function H(){k=w[C],C==="rangebreaks"&&(Z=w._hasDayOfWeekBreaks)}for(_=0;_<D.length;_++){x=D[_];for(var Y=0;Y<X.length;Y++){var $;for(T in C=X[Y],k=null,x)if(S=h[A=m(T)],w=y[A],C in w){if(!w.matches&&($=w,C in S)){H();break}k===null&&C in S&&H()}if(C==="range"&&k&&(K=!0),C==="autorange"&&k===null&&K&&(k=!1),k===null&&C in $&&(k=$[C]),k!==null)for(T in x)(w=y[m(T)])[C]=C==="range"?k.slice():k,C==="rangebreaks"&&(w._hasDayOfWeekBreaks=Z,f(w,y))}}},B.enforce=function(h){var y,v,_,x,T,A,S,w,C=h._fullLayout,k=C._axisConstraintGroups||[];for(y=0;y<k.length;y++){_=a(k[y],C);var L=Object.keys(_),M=1/0,P=0,D=1/0,N={},U={},q=!1;for(v=0;v<L.length;v++)U[x=L[v]]=T=C[m(x)],T._inputDomain?T.domain=T._inputDomain.slice():T._inputDomain=T.domain.slice(),T._inputRange||(T._inputRange=T.range.slice()),T.setScale(),N[x]=A=Math.abs(T._m)/_[x],M=Math.min(M,A),T.constrain!=="domain"&&T._constraintShrinkable||(D=Math.min(D,A)),delete T._constraintShrinkable,P=Math.max(P,A),T.constrain==="domain"&&(q=!0);if(!(M>u*P)||q){for(v=0;v<L.length;v++)if(A=N[x=L[v]],S=(T=U[x]).constrain,A!==D||S==="domain")if(w=A/D,S==="range")e(T,w);else{var X=T._inputDomain,K=(T.domain[1]-T.domain[0])/(X[1]-X[0]),Z=(T.r2l(T.range[1])-T.r2l(T.range[0]))/(T.r2l(T._inputRange[1])-T.r2l(T._inputRange[0]));if((w/=K)*Z<1){T.domain=T._input.domain=X.slice(),e(T,w);continue}if(Z<1&&(T.range=T._input.range=T._inputRange.slice(),w*=Z),T.autorange){var H=T.r2l(T.range[0]),Y=T.r2l(T.range[1]),$=(H+Y)/2,z=$,j=$,W=Math.abs(Y-$),ee=$-W*w*1.0001,J=$+W*w*1.0001,Q=d.makePadFn(C,T,0),te=d.makePadFn(C,T,1);g(T,w);var ie,ae,he=Math.abs(T._m),se=d.concatExtremes(h,T),de=se.min,ue=se.max;for(ae=0;ae<de.length;ae++)(ie=de[ae].val-Q(de[ae])/he)>ee&&ie<z&&(z=ie);for(ae=0;ae<ue.length;ae++)(ie=ue[ae].val+te(ue[ae])/he)<J&&ie>j&&(j=ie);w/=(j-z)/(2*W),z=T.l2r(z),j=T.l2r(j),T.range=T._input.range=H<Y?[z,j]:[j,z]}g(T,w)}}}},B.getAxisGroup=function(h,y){for(var v=h._axisMatchGroups,_=0;_<v.length;_++)if(v[_][y])return"g"+_;return y},B.clean=function(h,y){if(y._inputDomain){for(var v=!1,_=y._id,x=h._fullLayout._axisConstraintGroups,T=0;T<x.length;T++)if(x[T][_]){v=!0;break}v&&y.constrain==="domain"||(y._input.domain=y.domain=y._inputDomain,delete y._inputDomain)}}},{"../../constants/alignment":755,"../../constants/numerical":763,"../../lib":787,"./autorange":837,"./axis_ids":842,"./layout_attributes":853,"./scale_zoom":857,"./set_convert":859}],847:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=d.numberFormat,p=r("tinycolor2"),e=r("has-passive-events"),f=r("../../registry"),u=d.strTranslate,s=r("../../lib/svg_text_utils"),l=r("../../components/color"),o=r("../../components/drawing"),i=r("../../components/fx"),c=r("./axes"),n=r("../../lib/setcursor"),a=r("../../components/dragelement"),g=r("../../components/dragelement/helpers"),h=g.selectingOrDrawing,y=g.freeMode,v=r("../../constants/alignment").FROM_TL,_=r("../../lib/clear_gl_canvases"),x=r("../../plot_api/subroutines").redrawReglTraces,T=r("../plots"),A=r("./axis_ids").getFromId,S=r("./select").prepSelect,w=r("./select").clearSelect,C=r("./select").selectOnClick,k=r("./scale_zoom"),L=r("./constants"),M=L.MINDRAG,P=L.MINZOOM,D=!0;function N(ie,ae,he,se){var de=d.ensureSingle(ie.draglayer,ae,he,function(ue){ue.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",ie.id)});return de.call(n,se),de.node()}function U(ie,ae,he,se,de,ue,ve){var ke=N(ie,"rect",ae,he);return t.select(ke).call(o.setRect,se,de,ue,ve),ke}function q(ie,ae){for(var he=0;he<ie.length;he++)if(!ie[he].fixedrange)return ae;return""}function X(ie,ae,he,se,de){for(var ue=0;ue<ie.length;ue++){var ve=ie[ue];if(!ve.fixedrange)if(ve.rangebreaks){var ke=ve._id.charAt(0)==="y",Ee=ke?1-ae:ae,be=ke?1-he:he;se[ve._name+".range[0]"]=ve.l2r(ve.p2l(Ee*ve._length)),se[ve._name+".range[1]"]=ve.l2r(ve.p2l(be*ve._length))}else{var xe=ve._rl[0],ce=ve._rl[1]-xe;se[ve._name+".range[0]"]=ve.l2r(xe+ce*ae),se[ve._name+".range[1]"]=ve.l2r(xe+ce*he)}}if(de&&de.length){var ge=(ae+(1-he))/2;X(de,ge,1-ge,se,[])}}function K(ie,ae){for(var he=0;he<ie.length;he++){var se=ie[he];if(!se.fixedrange)if(se.rangebreaks){var de=se._length,ue=(se.p2l(0+ae)-se.p2l(0)+(se.p2l(de+ae)-se.p2l(de)))/2;se.range=[se.l2r(se._rl[0]-ue),se.l2r(se._rl[1]-ue)]}else se.range=[se.l2r(se._rl[0]-ae/se._m),se.l2r(se._rl[1]-ae/se._m)]}}function Z(ie){return 1-(ie>=0?Math.min(ie,.9):1/(1/Math.max(ie,-.3)+3.222))}function H(ie,ae,he,se,de){return ie.append("path").attr("class","zoombox").style({fill:ae>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",u(he,se)).attr("d",de+"Z")}function Y(ie,ae,he){return ie.append("path").attr("class","zoombox-corners").style({fill:l.background,stroke:l.defaultLine,"stroke-width":1,opacity:0}).attr("transform",u(ae,he)).attr("d","M0,0Z")}function $(ie,ae,he,se,de,ue){ie.attr("d",se+"M"+he.l+","+he.t+"v"+he.h+"h"+he.w+"v-"+he.h+"h-"+he.w+"Z"),z(ie,ae,de,ue)}function z(ie,ae,he,se){he||(ie.transition().style("fill",se>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ae.transition().style("opacity",1).duration(200))}function j(ie){t.select(ie).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function W(ie){D&&ie.data&&ie._context.showTips&&(d.notifier(d._(ie,"Double-click to zoom back out"),"long"),D=!1)}function ee(ie){var ae=Math.floor(Math.min(ie.b-ie.t,ie.r-ie.l,P)/2);return"M"+(ie.l-3.5)+","+(ie.t-.5+ae)+"h3v"+-ae+"h"+ae+"v-3h-"+(ae+3)+"ZM"+(ie.r+3.5)+","+(ie.t-.5+ae)+"h-3v"+-ae+"h"+-ae+"v-3h"+(ae+3)+"ZM"+(ie.r+3.5)+","+(ie.b+.5-ae)+"h-3v"+ae+"h"+-ae+"v3h"+(ae+3)+"ZM"+(ie.l-3.5)+","+(ie.b+.5-ae)+"h3v"+ae+"h"+ae+"v3h-"+(ae+3)+"Z"}function J(ie,ae,he,se,de){for(var ue,ve,ke,Ee,be=!1,xe={},ce={},ge=(de||{}).xaHash,we=(de||{}).yaHash,Me=0;Me<ae.length;Me++){var Se=ae[Me];for(ue in he)if(Se[ue]){for(ke in Se)de&&(ge[ke]||we[ke])||(ke.charAt(0)==="x"?he:se)[ke]||(xe[ke]=ue);for(ve in se)de&&(ge[ve]||we[ve])||!Se[ve]||(be=!0)}for(ve in se)if(Se[ve])for(Ee in Se)de&&(ge[Ee]||we[Ee])||(Ee.charAt(0)==="x"?he:se)[Ee]||(ce[Ee]=ve)}be&&(d.extendFlat(xe,ce),ce={});var ze={},Fe=[];for(ke in xe){var Ye=A(ie,ke);Fe.push(Ye),ze[Ye._id]=Ye}var rt={},Oe=[];for(Ee in ce){var je=A(ie,Ee);Oe.push(je),rt[je._id]=je}return{xaHash:ze,yaHash:rt,xaxes:Fe,yaxes:Oe,xLinks:xe,yLinks:ce,isSubplotConstrained:be}}function Q(ie,ae){if(e){var he=ie.onwheel!==void 0?"wheel":"mousewheel";ie._onwheel&&ie.removeEventListener(he,ie._onwheel),ie._onwheel=ae,ie.addEventListener(he,ae,{passive:!1})}else ie.onwheel!==void 0?ie.onwheel=ae:ie.onmousewheel!==void 0?ie.onmousewheel=ae:ie.isAddedWheelEvent||(ie.isAddedWheelEvent=!0,ie.addEventListener("wheel",ae,{passive:!1}))}function te(ie){var ae=[];for(var he in ie)ae.push(ie[he]);return ae}O.exports={makeDragBox:function(ie,ae,he,se,de,ue,ve,ke){var Ee,be,xe,ce,ge,we,Me,Se,ze,Fe,Ye,rt,Oe,je,We,qe,Qe,st,ct,Pt,kt,at,tt,_t=ie._fullLayout._zoomlayer,er=ve+ke==="nsew",tr=(ve+ke).length===1;function Ue(){if(Ee=ae.xaxis,be=ae.yaxis,ze=Ee._length,Fe=be._length,Me=Ee._offset,Se=be._offset,(xe={})[Ee._id]=Ee,(ce={})[be._id]=be,ve&&ke)for(var ur=ae.overlays,pr=0;pr<ur.length;pr++){var br=ur[pr].xaxis;xe[br._id]=br;var Rr=ur[pr].yaxis;ce[Rr._id]=Rr}ge=te(xe),we=te(ce),Oe=q(ge,ke),je=q(we,ve),We=!je&&!Oe,rt=J(ie,ie._fullLayout._axisMatchGroups,xe,ce);var _r=(Ye=J(ie,ie._fullLayout._axisConstraintGroups,xe,ce,rt)).isSubplotConstrained||rt.isSubplotConstrained;qe=ke||_r,Qe=ve||_r;var jr=ie._fullLayout;st=jr._has("scattergl"),ct=jr._has("splom"),Pt=jr._has("svg")}Ue();var He=function(ur,pr,br){return ur?ur==="nsew"?br?"":pr==="pan"?"move":"crosshair":ur.toLowerCase()+"-resize":"pointer"}(je+Oe,ie._fullLayout.dragmode,er),Be=U(ae,ve+ke+"drag",He,he,se,de,ue);if(We&&!er)return Be.onmousedown=null,Be.style.pointerEvents="none",Be;var Ke,_e,Ce,Le,Pe,Xe,ht,Mt,pt,Lt,vt={element:Be,gd:ie,plotinfo:ae};function Dt(){vt.plotinfo.selection=!1,w(ie)}function xt(ur,pr){var br=vt.gd;if(br._fullLayout._activeShapeIndex>=0)br._fullLayout._deactivateShape(br);else{var Rr=br._fullLayout.clickmode;if(j(br),ur!==2||tr||ir(),er)Rr.indexOf("select")>-1&&C(pr,br,ge,we,ae.id,vt),Rr.indexOf("event")>-1&&i.click(br,pr,ae.id);else if(ur===1&&tr){var _r=ve?be:Ee,jr=ve==="s"||ke==="w"?0:1,$r=_r._name+".range["+jr+"]",pn=function(Sn,an){var Nr,Pr=Sn.range[an],en=Math.abs(Pr-Sn.range[1-an]);return Sn.type==="date"?Pr:Sn.type==="log"?(Nr=Math.ceil(Math.max(0,-Math.log(en)/Math.LN10))+3,m("."+Nr+"g")(Math.pow(10,Pr))):(Nr=Math.floor(Math.log(Math.abs(Pr))/Math.LN10)-Math.floor(Math.log(en)/Math.LN10)+4,m("."+String(Nr)+"g")(Pr))}(_r,jr),In="left",On="middle";if(_r.fixedrange)return;ve?(On=ve==="n"?"top":"bottom",_r.side==="right"&&(In="right")):ke==="e"&&(In="right"),br._context.showAxisRangeEntryBoxes&&t.select(Be).call(s.makeEditable,{gd:br,immediate:!0,background:br._fullLayout.paper_bgcolor,text:String(pn),fill:_r.tickfont?_r.tickfont.color:"#444",horizontalAlign:In,verticalAlign:On}).on("edit",function(Sn){var an=_r.d2r(Sn);an!==void 0&&f.call("_guiRelayout",br,$r,an)})}}}function it(ur,pr){if(ie._transitioningWithDuration)return!1;var br=Math.max(0,Math.min(ze,at*ur+Ke)),Rr=Math.max(0,Math.min(Fe,tt*pr+_e)),_r=Math.abs(br-Ke),jr=Math.abs(Rr-_e);function $r(){ht="",Ce.r=Ce.l,Ce.t=Ce.b,pt.attr("d","M0,0Z")}if(Ce.l=Math.min(Ke,br),Ce.r=Math.max(Ke,br),Ce.t=Math.min(_e,Rr),Ce.b=Math.max(_e,Rr),Ye.isSubplotConstrained)_r>P||jr>P?(ht="xy",_r/ze>jr/Fe?(jr=_r*Fe/ze,_e>Rr?Ce.t=_e-jr:Ce.b=_e+jr):(_r=jr*ze/Fe,Ke>br?Ce.l=Ke-_r:Ce.r=Ke+_r),pt.attr("d",ee(Ce))):$r();else if(rt.isSubplotConstrained)if(_r>P||jr>P){ht="xy";var pn=Math.min(Ce.l/ze,(Fe-Ce.b)/Fe),In=Math.max(Ce.r/ze,(Fe-Ce.t)/Fe);Ce.l=pn*ze,Ce.r=In*ze,Ce.b=(1-pn)*Fe,Ce.t=(1-In)*Fe,pt.attr("d",ee(Ce))}else $r();else!je||jr<Math.min(Math.max(.6*_r,M),P)?_r<M||!Oe?$r():(Ce.t=0,Ce.b=Fe,ht="x",pt.attr("d",function(On,Sn){return"M"+(On.l-.5)+","+(Sn-P-.5)+"h-3v"+(2*P+1)+"h3ZM"+(On.r+.5)+","+(Sn-P-.5)+"h3v"+(2*P+1)+"h-3Z"}(Ce,_e))):!Oe||_r<Math.min(.6*jr,P)?(Ce.l=0,Ce.r=ze,ht="y",pt.attr("d",function(On,Sn){return"M"+(Sn-P-.5)+","+(On.t-.5)+"v-3h"+(2*P+1)+"v3ZM"+(Sn-P-.5)+","+(On.b+.5)+"v3h"+(2*P+1)+"v-3Z"}(Ce,Ke))):(ht="xy",pt.attr("d",ee(Ce)));Ce.w=Ce.r-Ce.l,Ce.h=Ce.b-Ce.t,ht&&(Lt=!0),ie._dragged=Lt,$(Mt,pt,Ce,Pe,Xe,Le),St(),ie.emit("plotly_relayouting",kt),Xe=!0}function St(){kt={},ht!=="xy"&&ht!=="x"||(X(ge,Ce.l/ze,Ce.r/ze,kt,Ye.xaxes),Ot("x",kt)),ht!=="xy"&&ht!=="y"||(X(we,(Fe-Ce.b)/Fe,(Fe-Ce.t)/Fe,kt,Ye.yaxes),Ot("y",kt))}function Nt(){St(),j(ie),Xt(),W(ie)}vt.prepFn=function(ur,pr,br){var Rr=vt.dragmode,_r=ie._fullLayout.dragmode;_r!==Rr&&(vt.dragmode=_r),Ue(),at=ie._fullLayout._invScaleX,tt=ie._fullLayout._invScaleY,We||(er?ur.shiftKey?_r==="pan"?_r="zoom":h(_r)||(_r="pan"):ur.ctrlKey&&(_r="pan"):_r="pan"),y(_r)?vt.minDrag=1:vt.minDrag=void 0,h(_r)?(vt.xaxes=ge,vt.yaxes=we,S(ur,pr,br,vt,_r)):(vt.clickFn=xt,h(Rr)&&Dt(),We||(_r==="zoom"?(vt.moveFn=it,vt.doneFn=Nt,vt.minDrag=1,function(jr,$r,pn){var In=Be.getBoundingClientRect();Ke=$r-In.left,_e=pn-In.top,ie._fullLayout._calcInverseTransform(ie);var On=d.apply3DTransform(ie._fullLayout._invTransform)(Ke,_e);Ke=On[0],_e=On[1],Ce={l:Ke,r:Ke,w:0,t:_e,b:_e,h:0},Le=ie._hmpixcount?ie._hmlumcount/ie._hmpixcount:p(ie._fullLayout.plot_bgcolor).getLuminance(),Xe=!1,ht="xy",Lt=!1,Mt=H(_t,Le,Me,Se,Pe="M0,0H"+ze+"V"+Fe+"H0V0"),pt=Y(_t,Me,Se)}(0,pr,br)):_r==="pan"&&(vt.moveFn=wt,vt.doneFn=Xt))),ie._fullLayout._redrag=function(){var jr=ie._dragdata;if(jr&&jr.element===Be){var $r=ie._fullLayout.dragmode;h($r)||(Ue(),Kt([0,0,ze,Fe]),vt.moveFn(jr.dx,jr.dy))}}},a.init(vt);var Ut=[0,0,ze,Fe],Qt=null,Ie=L.REDRAWDELAY,lt=ae.mainplot?ie._fullLayout._plots[ae.mainplot]:ae;function wt(ur,pr){if(ur*=at,pr*=tt,!ie._transitioningWithDuration){if(ie._fullLayout._replotting=!0,Oe==="ew"||je==="ns"){var br=Oe?-ur:0,Rr=je?-pr:0;if(rt.isSubplotConstrained){if(Oe&&je){var _r=(ur/ze-pr/Fe)/2;br=-(ur=_r*ze),Rr=-(pr=-_r*Fe)}je?br=-Rr*ze/Fe:Rr=-br*Fe/ze}return Oe&&(K(ge,ur),Ot("x")),je&&(K(we,pr),Ot("y")),Kt([br,Rr,ze,Fe]),Gt(),void ie.emit("plotly_relayouting",kt)}var jr,$r,pn=Oe==="w"==(je==="n")?1:-1;if(Oe&&je&&(Ye.isSubplotConstrained||rt.isSubplotConstrained)){var In=(ur/ze+pn*pr/Fe)/2;ur=In*ze,pr=pn*In*Fe}if(Oe==="w"?ur=Nr(ge,0,ur):Oe==="e"?ur=Nr(ge,1,-ur):Oe||(ur=0),je==="n"?pr=Nr(we,1,pr):je==="s"?pr=Nr(we,0,-pr):je||(pr=0),jr=Oe==="w"?ur:0,$r=je==="n"?pr:0,Ye.isSubplotConstrained&&!rt.isSubplotConstrained||rt.isSubplotConstrained&&Oe&&je&&pn>0){var On;if(rt.isSubplotConstrained||!Oe&&je.length===1){for(On=0;On<ge.length;On++)ge[On].range=ge[On]._r.slice(),k(ge[On],1-pr/Fe);jr=(ur=pr*ze/Fe)/2}if(rt.isSubplotConstrained||!je&&Oe.length===1){for(On=0;On<we.length;On++)we[On].range=we[On]._r.slice(),k(we[On],1-ur/ze);$r=(pr=ur*Fe/ze)/2}}rt.isSubplotConstrained&&je||Ot("x"),rt.isSubplotConstrained&&Oe||Ot("y");var Sn=ze-ur,an=Fe-pr;!rt.isSubplotConstrained||Oe&&je||(Oe?($r=jr?0:ur*Fe/ze,an=Sn*Fe/ze):(jr=$r?0:pr*ze/Fe,Sn=an*ze/Fe)),Kt([jr,$r,Sn,an]),Gt(),ie.emit("plotly_relayouting",kt)}function Nr(Pr,en,tn){for(var Qr,rn,An=1-en,En=0;En<Pr.length;En++){var Bn=Pr[En];if(!Bn.fixedrange){Qr=Bn,rn=Bn._rl[An]+(Bn._rl[en]-Bn._rl[An])/Z(tn/Bn._length);var Jt=Bn.l2r(rn);Jt!==!1&&Jt!==void 0&&(Bn.range[en]=Jt)}}return Qr._length*(Qr._rl[en]-rn)/(Qr._rl[en]-Qr._rl[An])}}function Ot(ur,pr){for(var br=rt.isSubplotConstrained?{x:we,y:ge}[ur]:rt[ur+"axes"],Rr=rt.isSubplotConstrained?{x:ge,y:we}[ur]:[],_r=0;_r<br.length;_r++){var jr=br[_r],$r=jr._id,pn=rt.xLinks[$r]||rt.yLinks[$r],In=Rr[0]||xe[pn]||ce[pn];In&&(pr?(pr[jr._name+".range[0]"]=pr[In._name+".range[0]"],pr[jr._name+".range[1]"]=pr[In._name+".range[1]"]):jr.range=In.range.slice())}}function Gt(){var ur,pr=[];function br(jr){for(ur=0;ur<jr.length;ur++)jr[ur].fixedrange||pr.push(jr[ur]._id)}for(qe&&(br(ge),br(Ye.xaxes),br(rt.xaxes)),Qe&&(br(we),br(Ye.yaxes),br(rt.yaxes)),kt={},ur=0;ur<pr.length;ur++){var Rr=pr[ur],_r=A(ie,Rr);c.drawOne(ie,_r,{skipTitle:!0}),kt[_r._name+".range[0]"]=_r.range[0],kt[_r._name+".range[1]"]=_r.range[1]}c.redrawComponents(ie,pr)}function ir(){if(!ie._transitioningWithDuration){var ur=ie._context.doubleClick,pr=[];Oe&&(pr=pr.concat(ge)),je&&(pr=pr.concat(we)),rt.xaxes&&(pr=pr.concat(rt.xaxes)),rt.yaxes&&(pr=pr.concat(rt.yaxes));var br,Rr,_r,jr={};if(ur==="reset+autosize"){for(ur="autosize",Rr=0;Rr<pr.length;Rr++)if((br=pr[Rr])._rangeInitial&&(br.range[0]!==br._rangeInitial[0]||br.range[1]!==br._rangeInitial[1])||!br._rangeInitial&&!br.autorange){ur="reset";break}}if(ur==="autosize")for(Rr=0;Rr<pr.length;Rr++)(br=pr[Rr]).fixedrange||(jr[br._name+".autorange"]=!0);else if(ur==="reset")for((Oe||Ye.isSubplotConstrained)&&(pr=pr.concat(Ye.xaxes)),je&&!Ye.isSubplotConstrained&&(pr=pr.concat(Ye.yaxes)),Ye.isSubplotConstrained&&(Oe?je||(pr=pr.concat(we)):pr=pr.concat(ge)),Rr=0;Rr<pr.length;Rr++)(br=pr[Rr]).fixedrange||(br._rangeInitial?(_r=br._rangeInitial,jr[br._name+".range[0]"]=_r[0],jr[br._name+".range[1]"]=_r[1]):jr[br._name+".autorange"]=!0);ie.emit("plotly_doubleclick",null),f.call("_guiRelayout",ie,jr)}}function Xt(){Kt([0,0,ze,Fe]),d.syncOrAsync([T.previousPromises,function(){ie._fullLayout._replotting=!1,f.call("_guiRelayout",ie,kt)}],ie)}function Kt(ur){var pr,br,Rr,_r,jr=ie._fullLayout,$r=jr._plots,pn=jr._subplots.cartesian;if(ct&&f.subplotsRegistry.splom.drag(ie),st){for(pr=0;pr<pn.length;pr++)if(Rr=(br=$r[pn[pr]]).xaxis,_r=br.yaxis,br._scene){var In=d.simpleMap(Rr.range,Rr.r2l),On=d.simpleMap(_r.range,_r.r2l);br._scene.update({range:[In[0],On[0],In[1],On[1]]})}}if((ct||st)&&(_(ie),x(ie)),Pt){var Sn=ur[2]/Ee._length,an=ur[3]/be._length;for(pr=0;pr<pn.length;pr++){Rr=(br=$r[pn[pr]]).xaxis,_r=br.yaxis;var Nr,Pr,en,tn,Qr=(qe||rt.isSubplotConstrained)&&!Rr.fixedrange&&xe[Rr._id],rn=(Qe||rt.isSubplotConstrained)&&!_r.fixedrange&&ce[_r._id];if(Qr?(Nr=Sn,en=ke||rt.isSubplotConstrained?ur[0]:vr(Rr,Nr)):rt.xaHash[Rr._id]?(Nr=Sn,en=ur[0]*Rr._length/Ee._length):rt.yaHash[Rr._id]?(Nr=an,en=je==="ns"?-ur[1]*Rr._length/be._length:vr(Rr,Nr,{n:"top",s:"bottom"}[je])):en=dr(Rr,Nr=or(Rr,Sn,an)),rn?(Pr=an,tn=ve||rt.isSubplotConstrained?ur[1]:vr(_r,Pr)):rt.yaHash[_r._id]?(Pr=an,tn=ur[1]*_r._length/be._length):rt.xaHash[_r._id]?(Pr=Sn,tn=Oe==="ew"?-ur[0]*_r._length/Ee._length:vr(_r,Pr,{e:"right",w:"left"}[Oe])):tn=dr(_r,Pr=or(_r,Sn,an)),Nr||Pr){Nr||(Nr=1),Pr||(Pr=1);var An=Rr._offset-en/Nr,En=_r._offset-tn/Pr;br.clipRect.call(o.setTranslate,en,tn).call(o.setScale,Nr,Pr),br.plot.call(o.setTranslate,An,En).call(o.setScale,1/Nr,1/Pr),Nr===br.xScaleFactor&&Pr===br.yScaleFactor||(o.setPointGroupScale(br.zoomScalePts,Nr,Pr),o.setTextPointsScale(br.zoomScaleTxt,Nr,Pr)),o.hideOutsideRangePoints(br.clipOnAxisFalseTraces,br),br.xScaleFactor=Nr,br.yScaleFactor=Pr}}}}function or(ur,pr,br){return ur.fixedrange?0:qe&&Ye.xaHash[ur._id]?pr:Qe&&(Ye.isSubplotConstrained?Ye.xaHash:Ye.yaHash)[ur._id]?br:0}function dr(ur,pr){return pr?(ur.range=ur._r.slice(),k(ur,pr),vr(ur,pr)):0}function vr(ur,pr,br){return ur._length*(1-pr)*v[br||ur.constraintoward||"middle"]}return ve.length*ke.length!=1&&Q(Be,function(ur){if(ie._context._scrollZoom.cartesian||ie._fullLayout._enablescrollzoom){if(Dt(),ie._transitioningWithDuration)return ur.preventDefault(),void ur.stopPropagation();Ue(),clearTimeout(Qt);var pr=-ur.deltaY;if(isFinite(pr)||(pr=ur.wheelDelta/10),isFinite(pr)){var br,Rr=Math.exp(-Math.min(Math.max(pr,-20),20)/200),_r=lt.draglayer.select(".nsewdrag").node().getBoundingClientRect(),jr=(ur.clientX-_r.left)/_r.width,$r=(_r.bottom-ur.clientY)/_r.height;if(qe){for(ke||(jr=.5),br=0;br<ge.length;br++)pn(ge[br],jr,Rr);Ot("x"),Ut[2]*=Rr,Ut[0]+=Ut[2]*jr*(1/Rr-1)}if(Qe){for(ve||($r=.5),br=0;br<we.length;br++)pn(we[br],$r,Rr);Ot("y"),Ut[3]*=Rr,Ut[1]+=Ut[3]*(1-$r)*(1/Rr-1)}Kt(Ut),Gt(),ie.emit("plotly_relayouting",kt),Qt=setTimeout(function(){ie._fullLayout&&(Ut=[0,0,ze,Fe],Xt())},Ie),ur.preventDefault()}else d.log("Did not find wheel motion attributes: ",ur)}function pn(In,On,Sn){if(!In.fixedrange){var an=d.simpleMap(In.range,In.r2l),Nr=an[0]+(an[1]-an[0])*On;In.range=an.map(function(Pr){return In.l2r(Nr+(Pr-Nr)*Sn)})}}}),Be},makeDragger:N,makeRectDragger:U,makeZoombox:H,makeCorners:Y,updateZoombox:$,xyCorners:ee,transitionZoombox:z,removeZoombox:j,showDoubleClickNotifier:W,attachWheelEventHandler:Q}},{"../../components/color":650,"../../components/dragelement":669,"../../components/dragelement/helpers":668,"../../components/drawing":672,"../../components/fx":690,"../../constants/alignment":755,"../../lib":787,"../../lib/clear_gl_canvases":771,"../../lib/setcursor":808,"../../lib/svg_text_utils":813,"../../plot_api/subroutines":828,"../../registry":915,"../plots":901,"./axes":838,"./axis_ids":842,"./constants":845,"./scale_zoom":857,"./select":858,"@plotly/d3":58,"has-passive-events":436,tinycolor2:583}],848:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/fx"),m=r("../../components/dragelement"),p=r("../../lib/setcursor"),e=r("./dragbox").makeDragBox,f=r("./constants").DRAGGERSIZE;B.initInteractions=function(u){var s=u._fullLayout;if(u._context.staticPlot)t.select(u).selectAll(".drag").remove();else if(s._has("cartesian")||s._has("splom")){Object.keys(s._plots||{}).sort(function(o,i){if((s._plots[o].mainplot&&!0)===(s._plots[i].mainplot&&!0)){var c=o.split("y"),n=i.split("y");return c[0]===n[0]?Number(c[1]||1)-Number(n[1]||1):Number(c[0]||1)-Number(n[0]||1)}return s._plots[o].mainplot?1:-1}).forEach(function(o){var i=s._plots[o],c=i.xaxis,n=i.yaxis;if(!i.mainplot){var a=e(u,i,c._offset,n._offset,c._length,n._length,"ns","ew");a.onmousemove=function(y){u._fullLayout._rehover=function(){u._fullLayout._hoversubplot===o&&u._fullLayout._plots[o]&&d.hover(u,y,o)},d.hover(u,y,o),u._fullLayout._lasthover=a,u._fullLayout._hoversubplot=o},a.onmouseout=function(y){u._dragging||(u._fullLayout._hoversubplot=null,m.unhover(u,y))},u._context.showAxisDragHandles&&(e(u,i,c._offset-f,n._offset-f,f,f,"n","w"),e(u,i,c._offset+c._length,n._offset-f,f,f,"n","e"),e(u,i,c._offset-f,n._offset+n._length,f,f,"s","w"),e(u,i,c._offset+c._length,n._offset+n._length,f,f,"s","e"))}if(u._context.showAxisDragHandles){if(o===c._mainSubplot){var g=c._mainLinePosition;c.side==="top"&&(g-=f),e(u,i,c._offset+.1*c._length,g,.8*c._length,f,"","ew"),e(u,i,c._offset,g,.1*c._length,f,"","w"),e(u,i,c._offset+.9*c._length,g,.1*c._length,f,"","e")}if(o===n._mainSubplot){var h=n._mainLinePosition;n.side!=="right"&&(h-=f),e(u,i,h,n._offset+.1*n._length,f,.8*n._length,"ns",""),e(u,i,h,n._offset+.9*n._length,f,.1*n._length,"s",""),e(u,i,h,n._offset,f,.1*n._length,"n","")}}});var l=s._hoverlayer.node();l.onmousemove=function(o){o.target=u._fullLayout._lasthover,d.hover(u,o,s._hoversubplot)},l.onclick=function(o){o.target=u._fullLayout._lasthover,d.click(u,o)},l.onmousedown=function(o){u._fullLayout._lasthover.onmousedown(o)},B.updateFx(u)}},B.updateFx=function(u){var s=u._fullLayout,l=s.dragmode==="pan"?"move":"crosshair";p(s._draggers,l)}},{"../../components/dragelement":669,"../../components/fx":690,"../../lib/setcursor":808,"./constants":845,"./dragbox":847,"@plotly/d3":58}],849:[function(r,O,B){O.exports={clearOutlineControllers:function(t){var d=t._fullLayout._zoomlayer;d&&d.selectAll(".outline-controllers").remove()},clearSelect:function(t){var d=t._fullLayout._zoomlayer;d&&d.selectAll(".select-outline").remove(),t._fullLayout._drawing=!1}}},{}],850:[function(r,O,B){var t=r("../../lib").strTranslate;function d(m,p){switch(m.type){case"log":return m.p2d(p);case"date":return m.p2r(p,0,m.calendar);default:return m.p2r(p)}}O.exports={p2r:d,r2p:function(m,p){switch(m.type){case"log":return m.d2p(p);case"date":return m.r2p(p,0,m.calendar);default:return m.r2p(p)}},axValue:function(m){var p=m._id.charAt(0)==="y"?1:0;return function(e){return d(m,e[p])}},getTransform:function(m){return t(m.xaxis._offset,m.yaxis._offset)}}},{"../../lib":787}],851:[function(r,O,B){var t=r("../../registry"),d=r("../../lib"),m=r("./axis_ids");O.exports=function(p){return function(e,f){var u=e[p];if(Array.isArray(u))for(var s=t.subplotsRegistry.cartesian,l=s.idRegex,o=f._subplots,i=o.xaxis,c=o.yaxis,n=o.cartesian,a=f._has("cartesian")||f._has("gl2d"),g=0;g<u.length;g++){var h=u[g];if(d.isPlainObject(h)){var y=m.cleanId(h.xref,"x",!1),v=m.cleanId(h.yref,"y",!1),_=l.x.test(y),x=l.y.test(v);if(_||x){a||d.pushUnique(f._basePlotModules,s);var T=!1;_&&i.indexOf(y)===-1&&(i.push(y),T=!0),x&&c.indexOf(v)===-1&&(c.push(v),T=!0),T&&_&&x&&n.push(y+v)}}}}}},{"../../lib":787,"../../registry":915,"./axis_ids":842}],852:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../registry"),m=r("../../lib"),p=r("../plots"),e=r("../../components/drawing"),f=r("../get_data").getModuleCalcData,u=r("./axis_ids"),s=r("./constants"),l=r("../../constants/xmlns_namespaces"),o=m.ensureSingle;function i(h,y,v){return m.ensureSingle(h,y,v,function(_){_.datum(v)})}function c(h,y,v,_,x){for(var T,A,S,w=s.traceLayerClasses,C=h._fullLayout,k=C._modules,L=[],M=[],P=0;P<k.length;P++){var D=(T=k[P]).name,N=d.modules[D].categories;if(N.svg){var U=T.layerName||D+"layer",q=T.plot;S=(A=f(v,q))[0],v=A[1],S.length&&L.push({i:w.indexOf(U),className:U,plotMethod:q,cdModule:S}),N.zoomScale&&M.push("."+U)}}L.sort(function(Z,H){return Z.i-H.i});var X=y.plot.selectAll("g.mlayer").data(L,function(Z){return Z.className});if(X.enter().append("g").attr("class",function(Z){return Z.className}).classed("mlayer",!0).classed("rangeplot",y.isRangePlot),X.exit().remove(),X.order(),X.each(function(Z){var H=t.select(this),Y=Z.className;Z.plotMethod(h,y,Z.cdModule,H,_,x),s.clipOnAxisFalseQuery.indexOf("."+Y)===-1&&e.setClipUrl(H,y.layerClipId,h)}),C._has("scattergl")&&(T=d.getModule("scattergl"),S=f(v,T)[0],T.plot(h,y,S)),!h._context.staticPlot&&(y._hasClipOnAxisFalse&&(y.clipOnAxisFalseTraces=y.plot.selectAll(s.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),M.length)){var K=y.plot.selectAll(M.join(",")).selectAll(".trace");y.zoomScalePts=K.selectAll("path.point"),y.zoomScaleTxt=K.selectAll(".textpoint")}}function n(h,y){var v=y.plotgroup,_=y.id,x=s.layerValue2layerClass[y.xaxis.layer],T=s.layerValue2layerClass[y.yaxis.layer],A=h._fullLayout._hasOnlyLargeSploms;if(y.mainplot){var S=y.mainplotinfo,w=S.plotgroup,C=_+"-x",k=_+"-y";y.gridlayer=S.gridlayer,y.zerolinelayer=S.zerolinelayer,o(S.overlinesBelow,"path",C),o(S.overlinesBelow,"path",k),o(S.overaxesBelow,"g",C),o(S.overaxesBelow,"g",k),y.plot=o(S.overplot,"g",_),o(S.overlinesAbove,"path",C),o(S.overlinesAbove,"path",k),o(S.overaxesAbove,"g",C),o(S.overaxesAbove,"g",k),y.xlines=w.select(".overlines-"+x).select("."+C),y.ylines=w.select(".overlines-"+T).select("."+k),y.xaxislayer=w.select(".overaxes-"+x).select("."+C),y.yaxislayer=w.select(".overaxes-"+T).select("."+k)}else if(A)y.xlines=o(v,"path","xlines-above"),y.ylines=o(v,"path","ylines-above"),y.xaxislayer=o(v,"g","xaxislayer-above"),y.yaxislayer=o(v,"g","yaxislayer-above");else{var L=o(v,"g","layer-subplot");y.shapelayer=o(L,"g","shapelayer"),y.imagelayer=o(L,"g","imagelayer"),y.gridlayer=o(v,"g","gridlayer"),y.zerolinelayer=o(v,"g","zerolinelayer"),o(v,"path","xlines-below"),o(v,"path","ylines-below"),y.overlinesBelow=o(v,"g","overlines-below"),o(v,"g","xaxislayer-below"),o(v,"g","yaxislayer-below"),y.overaxesBelow=o(v,"g","overaxes-below"),y.plot=o(v,"g","plot"),y.overplot=o(v,"g","overplot"),y.xlines=o(v,"path","xlines-above"),y.ylines=o(v,"path","ylines-above"),y.overlinesAbove=o(v,"g","overlines-above"),o(v,"g","xaxislayer-above"),o(v,"g","yaxislayer-above"),y.overaxesAbove=o(v,"g","overaxes-above"),y.xlines=v.select(".xlines-"+x),y.ylines=v.select(".ylines-"+T),y.xaxislayer=v.select(".xaxislayer-"+x),y.yaxislayer=v.select(".yaxislayer-"+T)}A||(i(y.gridlayer,"g",y.xaxis._id),i(y.gridlayer,"g",y.yaxis._id),y.gridlayer.selectAll("g").map(function(M){return M[0]}).sort(u.idSort)),y.xlines.style("fill","none").classed("crisp",!0),y.ylines.style("fill","none").classed("crisp",!0)}function a(h,y){if(h){var v={};for(var _ in h.each(function(S){var w=S[0];t.select(this).remove(),g(w,y),v[w]=!0}),y._plots)for(var x=y._plots[_].overlays||[],T=0;T<x.length;T++){var A=x[T];v[A.id]&&A.plot.selectAll(".trace").remove()}}}function g(h,y){y._draggers.selectAll("g."+h).remove(),y._defs.select("#clip"+y._uid+h+"plot").remove()}B.name="cartesian",B.attr=["xaxis","yaxis"],B.idRoot=["x","y"],B.idRegex=s.idRegex,B.attrRegex=s.attrRegex,B.attributes=r("./attributes"),B.layoutAttributes=r("./layout_attributes"),B.supplyLayoutDefaults=r("./layout_defaults"),B.transitionAxes=r("./transition_axes"),B.finalizeSubplots=function(h,y){var v,_,x,T=y._subplots,A=T.xaxis,S=T.yaxis,w=T.cartesian,C=w.concat(T.gl2d||[]),k={},L={};for(v=0;v<C.length;v++){var M=C[v].split("y");k[M[0]]=1,L["y"+M[1]]=1}for(v=0;v<A.length;v++)k[_=A[v]]||(x=(h[u.id2name(_)]||{}).anchor,s.idRegex.y.test(x)||(x="y"),w.push(_+x),C.push(_+x),L[x]||(L[x]=1,m.pushUnique(S,x)));for(v=0;v<S.length;v++)L[x=S[v]]||(_=(h[u.id2name(x)]||{}).anchor,s.idRegex.x.test(_)||(_="x"),w.push(_+x),C.push(_+x),k[_]||(k[_]=1,m.pushUnique(A,_)));if(!C.length){for(var P in _="",x="",h)s.attrRegex.test(P)&&(P.charAt(0)==="x"?(!_||+P.substr(5)<+_.substr(5))&&(_=P):(!x||+P.substr(5)<+x.substr(5))&&(x=P));_=_?u.name2id(_):"x",x=x?u.name2id(x):"y",A.push(_),S.push(x),w.push(_+x)}},B.plot=function(h,y,v,_){var x,T=h._fullLayout,A=T._subplots.cartesian,S=h.calcdata;if(!Array.isArray(y))for(y=[],x=0;x<S.length;x++)y.push(x);for(x=0;x<A.length;x++){for(var w,C=A[x],k=T._plots[C],L=[],M=0;M<S.length;M++){var P=S[M],D=P[0].trace;D.xaxis+D.yaxis===C&&((y.indexOf(D.index)!==-1||D.carpet)&&(w&&w[0].trace.xaxis+w[0].trace.yaxis===C&&["tonextx","tonexty","tonext"].indexOf(D.fill)!==-1&&L.indexOf(w)===-1&&L.push(w),L.push(P)),w=P)}c(h,k,L,v,_)}},B.clean=function(h,y,v,_){var x,T,A,S=_._plots||{},w=y._plots||{},C=_._subplots||{};if(_._hasOnlyLargeSploms&&!y._hasOnlyLargeSploms)for(A in S)(x=S[A]).plotgroup&&x.plotgroup.remove();var k=_._has&&_._has("gl"),L=y._has&&y._has("gl");if(k&&!L)for(A in S)(x=S[A])._scene&&x._scene.destroy();if(C.xaxis&&C.yaxis){var M=u.listIds({_fullLayout:_});for(T=0;T<M.length;T++){var P=M[T];y[u.id2name(P)]||_._infolayer.selectAll(".g-"+P+"title").remove()}}var D=_._has&&_._has("cartesian"),N=y._has&&y._has("cartesian");if(D&&!N)a(_._cartesianlayer.selectAll(".subplot"),_),_._defs.selectAll(".axesclip").remove(),delete _._axisConstraintGroups,delete _._axisMatchGroups;else if(C.cartesian)for(T=0;T<C.cartesian.length;T++){var U=C.cartesian[T];if(!w[U]){var q="."+U+",."+U+"-x,."+U+"-y";_._cartesianlayer.selectAll(q).remove(),g(U,_)}}},B.drawFramework=function(h){var y=h._fullLayout,v=function(x){var T,A,S,w,C,k,L=x._fullLayout,M=L._subplots.cartesian,P=M.length,D=[],N=[];for(T=0;T<P;T++){S=M[T],w=L._plots[S],C=w.xaxis,k=w.yaxis;var U=C._mainAxis,q=k._mainAxis,X=U._id+q._id,K=L._plots[X];w.overlays=[],X!==S&&K?(w.mainplot=X,w.mainplotinfo=K,N.push(S)):(w.mainplot=void 0,w.mainplotinfo=void 0,D.push(S))}for(T=0;T<N.length;T++)S=N[T],(w=L._plots[S]).mainplotinfo.overlays.push(w);var Z=D.concat(N),H=new Array(P);for(T=0;T<P;T++){S=Z[T],w=L._plots[S],C=w.xaxis,k=w.yaxis;var Y=[S,C.layer,k.layer,C.overlaying||"",k.overlaying||""];for(A=0;A<w.overlays.length;A++)Y.push(w.overlays[A].id);H[T]=Y}return H}(h),_=y._cartesianlayer.selectAll(".subplot").data(v,String);_.enter().append("g").attr("class",function(x){return"subplot "+x[0]}),_.order(),_.exit().call(a,y),_.each(function(x){var T=x[0],A=y._plots[T];A.plotgroup=t.select(this),n(h,A),A.draglayer=o(y._draggers,"g",T)})},B.rangePlot=function(h,y,v){n(h,y),c(h,y,v),p.style(h)},B.toSVG=function(h){var y=h._fullLayout._glimages,v=t.select(h).selectAll(".svg-container");v.filter(function(_,x){return x===v.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var _=this.toDataURL("image/png");y.append("svg:image").attr({xmlns:l.svg,"xlink:href":_,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})})},B.updateFx=r("./graph_interact").updateFx},{"../../components/drawing":672,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../registry":915,"../get_data":875,"../plots":901,"./attributes":836,"./axis_ids":842,"./constants":845,"./graph_interact":848,"./layout_attributes":853,"./layout_defaults":854,"./transition_axes":863,"@plotly/d3":58}],853:[function(r,O,B){var t=r("../font_attributes"),d=r("../../components/color/attributes"),m=r("../../components/drawing/attributes").dash,p=r("../../lib/extend").extendFlat,e=r("../../plot_api/plot_template").templatedArray,f=r("../../plots/cartesian/axis_format_attributes").descriptionWithDates,u=r("../../constants/numerical").ONEDAY,s=r("./constants"),l=s.HOUR_PATTERN,o=s.WEEKDAY_PATTERN;O.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:d.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:t({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[s.idRegex.x.toString(),s.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[s.idRegex.x.toString(),s.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[o,l,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:u},editType:"calc"}),tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:d.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"boolean",dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:p({},m,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:t({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:f("tick label")},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:f("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:d.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:d.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:d.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:d.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",s.idRegex.x.toString(),s.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",s.idRegex.x.toString(),s.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:t({editType:"ticks"})}}},{"../../components/color/attributes":649,"../../components/drawing/attributes":671,"../../constants/numerical":763,"../../lib/extend":777,"../../plot_api/plot_template":827,"../../plots/cartesian/axis_format_attributes":841,"../font_attributes":867,"./constants":845}],854:[function(r,O,B){var t=r("../../lib"),d=r("../../components/color"),m=r("../../components/fx/helpers").isUnifiedHover,p=r("../../components/fx/hovermode_defaults"),e=r("../../plot_api/plot_template"),f=r("../layout_attributes"),u=r("./layout_attributes"),s=r("./type_defaults"),l=r("./axis_defaults"),o=r("./constraints"),i=r("./position_defaults"),c=r("./axis_ids"),n=c.id2name,a=c.name2id,g=r("./constants").AX_ID_PATTERN,h=r("../../registry"),y=h.traceIs,v=h.getComponentMethod;function _(x,T,A){Array.isArray(x[T])?x[T].push(A):x[T]=[A]}O.exports=function(x,T,A){var S,w,C=T.autotypenumbers,k={},L={},M={},P={},D={},N={},U={},q={},X={},K={};for(S=0;S<A.length;S++){var Z=A[S];if(y(Z,"cartesian")||y(Z,"gl2d")){var H,Y;if(Z.xaxis)H=n(Z.xaxis),_(k,H,Z);else if(Z.xaxes)for(w=0;w<Z.xaxes.length;w++)_(k,n(Z.xaxes[w]),Z);if(Z.yaxis)Y=n(Z.yaxis),_(k,Y,Z);else if(Z.yaxes)for(w=0;w<Z.yaxes.length;w++)_(k,n(Z.yaxes[w]),Z);Z.type==="funnel"?Z.orientation==="h"?(H&&(L[H]=!0),Y&&(U[Y]=!0)):Y&&(M[Y]=!0):Z.type==="image"?(Y&&(q[Y]=!0),H&&(q[H]=!0)):(Y&&(D[Y]=!0,N[Y]=!0),y(Z,"carpet")&&(Z.type!=="carpet"||Z._cheater)||H&&(P[H]=!0)),Z.type==="carpet"&&Z._cheater&&H&&(L[H]=!0),y(Z,"2dMap")&&(X[H]=!0,X[Y]=!0),y(Z,"oriented")&&(K[Z.orientation==="h"?Y:H]=!0)}}var $=T._subplots,z=$.xaxis,j=$.yaxis,W=t.simpleMap(z,n),ee=t.simpleMap(j,n),J=W.concat(ee),Q=d.background;z.length&&j.length&&(Q=t.coerce(x,T,f,"plot_bgcolor"));var te,ie,ae,he,se,de=d.combine(Q,T.paper_bgcolor);function ue(){var tt=k[te]||[];se._traceIndices=tt.map(function(_t){return _t._expandedIndex}),se._annIndices=[],se._shapeIndices=[],se._imgIndices=[],se._subplotsWith=[],se._counterAxes=[],se._name=se._attr=te,se._id=ie}function ve(tt,_t){return t.coerce(he,se,u,tt,_t)}function ke(tt,_t){return t.coerce2(he,se,u,tt,_t)}function Ee(tt){return tt==="x"?j:z}function be(tt,_t){for(var er=tt==="x"?W:ee,tr=[],Ue=0;Ue<er.length;Ue++){var He=er[Ue];He===_t||(x[He]||{}).overlaying||tr.push(a(He))}return tr}var xe={x:Ee("x"),y:Ee("y")},ce=xe.x.concat(xe.y),ge={},we=[];function Me(){var tt=he.matches;g.test(tt)&&ce.indexOf(tt)===-1&&(ge[tt]=he.type,we=Object.keys(ge))}var Se=p(x,T),ze=m(Se);for(S=0;S<J.length;S++){te=J[S],ie=a(te),ae=te.charAt(0),t.isPlainObject(x[te])||(x[te]={}),he=x[te],se=e.newContainer(T,te,ae+"axis"),ue();var Fe=ae==="x"&&!P[te]&&L[te]||ae==="y"&&!D[te]&&M[te],Ye=ae==="y"&&(!N[te]&&U[te]||q[te]),rt={letter:ae,font:T.font,outerTicks:X[te],showGrid:!K[te],data:k[te]||[],bgColor:de,calendar:T.calendar,automargin:!0,visibleDflt:Fe,reverseDflt:Ye,autotypenumbersDflt:C,splomStash:((T._splomAxes||{})[ae]||{})[ie]};ve("uirevision",T.uirevision),s(he,se,ve,rt),l(he,se,ve,rt,T);var Oe=ze&&ae===Se.charAt(0),je=ke("spikecolor",ze?se.color:void 0),We=ke("spikethickness",ze?1.5:void 0),qe=ke("spikedash",ze?"dot":void 0),Qe=ke("spikemode",ze?"across":void 0),st=ke("spikesnap");ve("showspikes",!!(Oe||je||We||qe||Qe||st))||(delete se.spikecolor,delete se.spikethickness,delete se.spikedash,delete se.spikemode,delete se.spikesnap),i(he,se,ve,{letter:ae,counterAxes:xe[ae],overlayableAxes:be(ae,te),grid:T.grid}),ve("title.standoff"),Me(),se._input=he}for(S=0;S<we.length;){ie=we[S++],ae=(te=n(ie)).charAt(0),t.isPlainObject(x[te])||(x[te]={}),he=x[te],se=e.newContainer(T,te,ae+"axis"),ue();var ct={letter:ae,font:T.font,outerTicks:X[te],showGrid:!K[te],data:[],bgColor:de,calendar:T.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:C,splomStash:((T._splomAxes||{})[ae]||{})[ie]};ve("uirevision",T.uirevision),se.type=ge[ie]||"linear",l(he,se,ve,ct,T),i(he,se,ve,{letter:ae,counterAxes:xe[ae],overlayableAxes:be(ae,te),grid:T.grid}),ve("fixedrange"),Me(),se._input=he}var Pt=v("rangeslider","handleDefaults"),kt=v("rangeselector","handleDefaults");for(S=0;S<W.length;S++)te=W[S],he=x[te],se=T[te],Pt(x,T,te),se.type==="date"&&kt(he,se,T,ee,se.calendar),ve("fixedrange");for(S=0;S<ee.length;S++){te=ee[S],he=x[te],se=T[te];var at=T[n(se.anchor)];ve("fixedrange",v("rangeslider","isVisible")(at))}o.handleDefaults(x,T,{axIds:ce.concat(we).sort(c.idSort),axHasImage:q})}},{"../../components/color":650,"../../components/fx/helpers":686,"../../components/fx/hovermode_defaults":689,"../../lib":787,"../../plot_api/plot_template":827,"../../registry":915,"../layout_attributes":892,"./axis_defaults":840,"./axis_ids":842,"./constants":845,"./constraints":846,"./layout_attributes":853,"./position_defaults":856,"./type_defaults":864}],855:[function(r,O,B){var t=r("tinycolor2").mix,d=r("../../components/color/attributes").lightFraction,m=r("../../lib");O.exports=function(p,e,f,u){var s=(u=u||{}).dfltColor;function l(h,y){return m.coerce2(p,e,u.attributes,h,y)}var o=l("linecolor",s),i=l("linewidth");f("showline",u.showLine||!!o||!!i)||(delete e.linecolor,delete e.linewidth);var c=l("gridcolor",t(s,u.bgColor,u.blend||d).toRgbString()),n=l("gridwidth");if(f("showgrid",u.showGrid||!!c||!!n)||(delete e.gridcolor,delete e.gridwidth),!u.noZeroLine){var a=l("zerolinecolor",s),g=l("zerolinewidth");f("zeroline",u.showGrid||!!a||!!g)||(delete e.zerolinecolor,delete e.zerolinewidth)}}},{"../../components/color/attributes":649,"../../lib":787,tinycolor2:583}],856:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib");O.exports=function(m,p,e,f){var u,s,l,o,i=f.counterAxes||[],c=f.overlayableAxes||[],n=f.letter,a=f.grid;a&&(s=a._domains[n][a._axisMap[p._id]],u=a._anchors[p._id],s&&(l=a[n+"side"].split(" ")[0],o=a.domain[n][l==="right"||l==="top"?1:0])),s=s||[0,1],u=u||(t(m.position)?"free":i[0]||"free"),l=l||(n==="x"?"bottom":"left"),o=o||0,d.coerce(m,p,{anchor:{valType:"enumerated",values:["free"].concat(i),dflt:u}},"anchor")==="free"&&e("position",o),d.coerce(m,p,{side:{valType:"enumerated",values:n==="x"?["bottom","top"]:["left","right"],dflt:l}},"side");var g=!1;if(c.length&&(g=d.coerce(m,p,{overlaying:{valType:"enumerated",values:[!1].concat(c),dflt:!1}},"overlaying")),!g){var h=e("domain",s);h[0]>h[1]-1/4096&&(p.domain=s),d.noneOrAll(m.domain,p.domain,s)}return e("layer"),p}},{"../../lib":787,"fast-isnumeric":246}],857:[function(r,O,B){var t=r("../../constants/alignment").FROM_BL;O.exports=function(d,m,p){p===void 0&&(p=t[d.constraintoward||"center"]);var e=[d.r2l(d.range[0]),d.r2l(d.range[1])],f=e[0]+(e[1]-e[0])*p;d.range=d._input.range=[d.l2r(f+(e[0]-f)*m),d.l2r(f+(e[1]-f)*m)],d.setScale()}},{"../../constants/alignment":755}],858:[function(r,O,B){var t=r("polybooljs"),d=r("../../registry"),m=r("../../components/drawing").dashStyle,p=r("../../components/color"),e=r("../../components/fx"),f=r("../../components/fx/helpers").makeEventData,u=r("../../components/dragelement/helpers"),s=u.freeMode,l=u.rectMode,o=u.drawMode,i=u.openMode,c=u.selectMode,n=r("../../components/shapes/draw_newshape/display_outlines"),a=r("../../components/shapes/draw_newshape/helpers").handleEllipse,g=r("../../components/shapes/draw_newshape/newshapes"),h=r("../../lib"),y=r("../../lib/polygon"),v=r("../../lib/throttle"),_=r("./axis_ids").getFromId,x=r("../../lib/clear_gl_canvases"),T=r("../../plot_api/subroutines").redrawReglTraces,A=r("./constants"),S=A.MINSELECT,w=y.filter,C=y.tester,k=r("./handle_outline").clearSelect,L=r("./helpers"),M=L.p2r,P=L.axValue,D=L.getTransform;function N(W,ee,J,Q,te,ie,ae){var he,se,de,ue,ve,ke,Ee,be,xe,ce=ee._hoverdata,ge=ee._fullLayout.clickmode.indexOf("event")>-1,we=[];if(function(Ye){return Ye&&Array.isArray(Ye)&&Ye[0].hoverOnBox!==!0}(ce)){K(W,ee,ie);var Me=function(Ye,rt){var Oe,je,We=Ye[0],qe=-1,Qe=[];for(je=0;je<rt.length;je++)if(Oe=rt[je],We.fullData._expandedIndex===Oe.cd[0].trace._expandedIndex){if(We.hoverOnBox===!0)break;We.pointNumber!==void 0?qe=We.pointNumber:We.binNumber!==void 0&&(qe=We.binNumber,Qe=We.pointNumbers);break}return{pointNumber:qe,pointNumbers:Qe,searchInfo:Oe}}(ce,he=H(ee,J,Q,te));if(Me.pointNumbers.length>0?function(Ye,rt){var Oe,je,We,qe=[];for(We=0;We<Ye.length;We++)(Oe=Ye[We]).cd[0].trace.selectedpoints&&Oe.cd[0].trace.selectedpoints.length>0&&qe.push(Oe);if(qe.length===1&&qe[0]===rt.searchInfo&&(je=rt.searchInfo.cd[0].trace).selectedpoints.length===rt.pointNumbers.length){for(We=0;We<rt.pointNumbers.length;We++)if(je.selectedpoints.indexOf(rt.pointNumbers[We])<0)return!1;return!0}return!1}(he,Me):function(Ye){var rt,Oe,je,We=0;for(je=0;je<Ye.length;je++)if(rt=Ye[je],(Oe=rt.cd[0].trace).selectedpoints&&(Oe.selectedpoints.length>1||(We+=Oe.selectedpoints.length)>1))return!1;return We===1}(he)&&(ke=Y(Me))){for(ae&&ae.remove(),xe=0;xe<he.length;xe++)(se=he[xe])._module.selectPoints(se,!1);$(ee,he),Z(ie),ge&&ee.emit("plotly_deselect",null)}else{for(Ee=W.shiftKey&&(ke!==void 0?ke:Y(Me)),de=function(Ye,rt,Oe){return{pointNumber:Ye,searchInfo:rt,subtract:Oe}}(Me.pointNumber,Me.searchInfo,Ee),ue=X(ie.selectionDefs.concat([de])),xe=0;xe<he.length;xe++)if(ve=z(he[xe]._module.selectPoints(he[xe],ue),he[xe]),we.length)for(var Se=0;Se<ve.length;Se++)we.push(ve[Se]);else we=ve;if($(ee,he,be={points:we}),de&&ie&&ie.selectionDefs.push(de),ae){var ze=ie.mergedPolygons,Fe=i(ie.dragmode);n(j(ze,Fe),ae,ie)}ge&&ee.emit("plotly_selected",be)}}}function U(W){return"pointNumber"in W&&"searchInfo"in W}function q(W){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(ee,J,Q,te){var ie=W.searchInfo.cd[0].trace._expandedIndex;return te.cd[0].trace._expandedIndex===ie&&Q===W.pointNumber},isRect:!1,degenerate:!1,subtract:W.subtract}}function X(W){for(var ee=[],J=U(W[0])?0:W[0][0][0],Q=J,te=U(W[0])?0:W[0][0][1],ie=te,ae=0;ae<W.length;ae++)if(U(W[ae]))ee.push(q(W[ae]));else{var he=y.tester(W[ae]);he.subtract=W[ae].subtract,ee.push(he),J=Math.min(J,he.xmin),Q=Math.max(Q,he.xmax),te=Math.min(te,he.ymin),ie=Math.max(ie,he.ymax)}return{xmin:J,xmax:Q,ymin:te,ymax:ie,pts:[],contains:function(se,de,ue,ve){for(var ke=!1,Ee=0;Ee<ee.length;Ee++)ee[Ee].contains(se,de,ue,ve)&&(ke=ee[Ee].subtract===!1);return ke},isRect:!1,degenerate:!1}}function K(W,ee,J){ee._fullLayout._drawing=!1;var Q=ee._fullLayout,te=J.plotinfo,ie=J.dragmode,ae=Q._lastSelectedSubplot&&Q._lastSelectedSubplot===te.id,he=(W.shiftKey||W.altKey)&&!(o(ie)&&i(ie));ae&&he&&te.selection&&te.selection.selectionDefs&&!J.selectionDefs?(J.selectionDefs=te.selection.selectionDefs,J.mergedPolygons=te.selection.mergedPolygons):he&&te.selection||Z(J),ae||(k(ee),Q._lastSelectedSubplot=te.id)}function Z(W){var ee=W.dragmode,J=W.plotinfo,Q=W.gd;if(Q._fullLayout._activeShapeIndex>=0&&Q._fullLayout._deactivateShape(Q),o(ee)){var te=Q._fullLayout._zoomlayer.selectAll(".select-outline-"+J.id);if(te&&Q._fullLayout._drawing){var ie=g(te,W);ie&&d.call("_guiRelayout",Q,{shapes:ie}),Q._fullLayout._drawing=!1}}J.selection={},J.selection.selectionDefs=W.selectionDefs=[],J.selection.mergedPolygons=W.mergedPolygons=[]}function H(W,ee,J,Q){var te,ie,ae,he=[],se=ee.map(function(Ee){return Ee._id}),de=J.map(function(Ee){return Ee._id});for(ae=0;ae<W.calcdata.length;ae++)if((ie=(te=W.calcdata[ae])[0].trace).visible===!0&&ie._module&&ie._module.selectPoints)if(!Q||ie.subplot!==Q&&ie.geo!==Q)if(ie.type==="splom"&&ie._xaxes[se[0]]&&ie._yaxes[de[0]]){var ue=ke(ie._module,te,ee[0],J[0]);ue.scene=W._fullLayout._splomScenes[ie.uid],he.push(ue)}else if(ie.type==="sankey"){var ve=ke(ie._module,te,ee[0],J[0]);he.push(ve)}else{if(se.indexOf(ie.xaxis)===-1||de.indexOf(ie.yaxis)===-1)continue;he.push(ke(ie._module,te,_(W,ie.xaxis),_(W,ie.yaxis)))}else he.push(ke(ie._module,te,ee[0],J[0]));return he;function ke(Ee,be,xe,ce){return{_module:Ee,cd:be,xaxis:xe,yaxis:ce}}}function Y(W){var ee=W.searchInfo.cd[0].trace,J=W.pointNumber,Q=W.pointNumbers,te=Q.length>0?Q[0]:J;return!!ee.selectedpoints&&ee.selectedpoints.indexOf(te)>-1}function $(W,ee,J){var Q,te,ie,ae;for(Q=0;Q<ee.length;Q++){var he=ee[Q].cd[0].trace._fullInput,se=W._fullLayout._tracePreGUI[he.uid]||{};se.selectedpoints===void 0&&(se.selectedpoints=he._input.selectedpoints||null)}if(J){var de=J.points||[];for(Q=0;Q<ee.length;Q++)(ae=ee[Q].cd[0].trace)._input.selectedpoints=ae._fullInput.selectedpoints=[],ae._fullInput!==ae&&(ae.selectedpoints=[]);for(Q=0;Q<de.length;Q++){var ue=de[Q],ve=ue.data,ke=ue.fullData;ue.pointIndices?([].push.apply(ve.selectedpoints,ue.pointIndices),ae._fullInput!==ae&&[].push.apply(ke.selectedpoints,ue.pointIndices)):(ve.selectedpoints.push(ue.pointIndex),ae._fullInput!==ae&&ke.selectedpoints.push(ue.pointIndex))}}else for(Q=0;Q<ee.length;Q++)delete(ae=ee[Q].cd[0].trace).selectedpoints,delete ae._input.selectedpoints,ae._fullInput!==ae&&delete ae._fullInput.selectedpoints;var Ee=!1;for(Q=0;Q<ee.length;Q++){ae=(ie=(te=ee[Q]).cd)[0].trace,d.traceIs(ae,"regl")&&(Ee=!0);var be=te._module,xe=be.styleOnSelect||be.style;xe&&(xe(W,ie,ie[0].node3),ie[0].nodeRangePlot3&&xe(W,ie,ie[0].nodeRangePlot3))}Ee&&(x(W),T(W))}function z(W,ee){if(Array.isArray(W))for(var J=ee.cd,Q=ee.cd[0].trace,te=0;te<W.length;te++)W[te]=f(W[te],Q,J);return W}function j(W,ee){for(var J=[],Q=0;Q<W.length;Q++){J[Q]=[];for(var te=0;te<W[Q].length;te++){J[Q][te]=[],J[Q][te][0]=te?"L":"M";for(var ie=0;ie<W[Q][te].length;ie++)J[Q][te].push(W[Q][te][ie])}ee||J[Q].push(["Z",J[Q][0][1],J[Q][0][2]])}return J}O.exports={prepSelect:function(W,ee,J,Q,te){var ie=s(te),ae=l(te),he=i(te),se=o(te),de=c(te),ue=te==="drawcircle",ve=te==="drawline"||ue,ke=Q.gd,Ee=ke._fullLayout,be=Ee._zoomlayer,xe=Q.element.getBoundingClientRect(),ce=Q.plotinfo,ge=D(ce),we=ee-xe.left,Me=J-xe.top;Ee._calcInverseTransform(ke);var Se=h.apply3DTransform(Ee._invTransform)(we,Me);we=Se[0],Me=Se[1];var ze,Fe,Ye,rt,Oe,je,We,qe=Ee._invScaleX,Qe=Ee._invScaleY,st=we,ct=Me,Pt="M"+we+","+Me,kt=Q.xaxes[0]._length,at=Q.yaxes[0]._length,tt=Q.xaxes.concat(Q.yaxes),_t=W.altKey&&!(o(te)&&he);K(W,ke,Q),ie&&(ze=w([[we,Me]],A.BENDPX));var er=be.selectAll("path.select-outline-"+ce.id).data(se?[0]:[1,2]),tr=Ee.newshape;er.enter().append("path").attr("class",function(Le){return"select-outline select-outline-"+Le+" select-outline-"+ce.id}).style(se?{opacity:tr.opacity/2,fill:he?void 0:tr.fillcolor,stroke:tr.line.color,"stroke-dasharray":m(tr.line.dash,tr.line.width),"stroke-width":tr.line.width+"px"}:{}).attr("fill-rule",tr.fillrule).classed("cursor-move",!!se).attr("transform",ge).attr("d",Pt+"Z");var Ue,He=be.append("path").attr("class","zoombox-corners").style({fill:p.background,stroke:p.defaultLine,"stroke-width":1}).attr("transform",ge).attr("d","M0,0Z"),Be=Ee._uid+A.SELECTID,Ke=[],_e=H(ke,Q.xaxes,Q.yaxes,Q.subplot);function Ce(Le,Pe){return Le-Pe}Ue=ce.fillRangeItems?ce.fillRangeItems:ae?function(Le,Pe){var Xe=Le.range={};for(Oe=0;Oe<tt.length;Oe++){var ht=tt[Oe],Mt=ht._id.charAt(0);Xe[ht._id]=[M(ht,Pe[Mt+"min"]),M(ht,Pe[Mt+"max"])].sort(Ce)}}:function(Le,Pe,Xe){var ht=Le.lassoPoints={};for(Oe=0;Oe<tt.length;Oe++){var Mt=tt[Oe];ht[Mt._id]=Xe.filtered.map(P(Mt))}},Q.moveFn=function(Le,Pe){st=Math.max(0,Math.min(kt,qe*Le+we)),ct=Math.max(0,Math.min(at,Qe*Pe+Me));var Xe=Math.abs(st-we),ht=Math.abs(ct-Me);if(ae){var Mt,pt,Lt;if(de){var vt=Ee.selectdirection;switch(Mt=vt==="any"?ht<Math.min(.6*Xe,S)?"h":Xe<Math.min(.6*ht,S)?"v":"d":vt){case"h":pt=ue?at/2:0,Lt=at;break;case"v":pt=ue?kt/2:0,Lt=kt}}if(se)switch(Ee.newshape.drawdirection){case"vertical":Mt="h",pt=ue?at/2:0,Lt=at;break;case"horizontal":Mt="v",pt=ue?kt/2:0,Lt=kt;break;case"ortho":Xe<ht?(Mt="h",pt=Me,Lt=ct):(Mt="v",pt=we,Lt=st);break;default:Mt="d"}Mt==="h"?((rt=ve?a(ue,[st,pt],[st,Lt]):[[we,pt],[we,Lt],[st,Lt],[st,pt]]).xmin=ve?st:Math.min(we,st),rt.xmax=ve?st:Math.max(we,st),rt.ymin=Math.min(pt,Lt),rt.ymax=Math.max(pt,Lt),He.attr("d","M"+rt.xmin+","+(Me-S)+"h-4v"+2*S+"h4ZM"+(rt.xmax-1)+","+(Me-S)+"h4v"+2*S+"h-4Z")):Mt==="v"?((rt=ve?a(ue,[pt,ct],[Lt,ct]):[[pt,Me],[pt,ct],[Lt,ct],[Lt,Me]]).xmin=Math.min(pt,Lt),rt.xmax=Math.max(pt,Lt),rt.ymin=ve?ct:Math.min(Me,ct),rt.ymax=ve?ct:Math.max(Me,ct),He.attr("d","M"+(we-S)+","+rt.ymin+"v-4h"+2*S+"v4ZM"+(we-S)+","+(rt.ymax-1)+"v4h"+2*S+"v-4Z")):Mt==="d"&&((rt=ve?a(ue,[we,Me],[st,ct]):[[we,Me],[we,ct],[st,ct],[st,Me]]).xmin=Math.min(we,st),rt.xmax=Math.max(we,st),rt.ymin=Math.min(Me,ct),rt.ymax=Math.max(Me,ct),He.attr("d","M0,0Z"))}else ie&&(ze.addPt([st,ct]),rt=ze.filtered);Q.selectionDefs&&Q.selectionDefs.length?(Ye=function(Dt,xt,it){return it?t.difference({regions:Dt,inverted:!1},{regions:[xt],inverted:!1}).regions:t.union({regions:Dt,inverted:!1},{regions:[xt],inverted:!1}).regions}(Q.mergedPolygons,rt,_t),rt.subtract=_t,Fe=X(Q.selectionDefs.concat([rt]))):(Ye=[rt],Fe=C(rt)),n(j(Ye,he),er,Q),de&&v.throttle(Be,A.SELECTDELAY,function(){var Dt;Ke=[];var xt;for(Oe=0;Oe<_e.length;Oe++)if(xt=(je=_e[Oe])._module.selectPoints(je,Fe),Dt=z(xt,je),Ke.length)for(var it=0;it<Dt.length;it++)Ke.push(Dt[it]);else Ke=Dt;$(ke,_e,We={points:Ke}),Ue(We,rt,ze),Q.gd.emit("plotly_selecting",We)})},Q.clickFn=function(Le,Pe){if(He.remove(),ke._fullLayout._activeShapeIndex>=0)ke._fullLayout._deactivateShape(ke);else if(!se){var Xe=Ee.clickmode;v.done(Be).then(function(){if(v.clear(Be),Le===2){for(er.remove(),Oe=0;Oe<_e.length;Oe++)(je=_e[Oe])._module.selectPoints(je,!1);$(ke,_e),Z(Q),ke.emit("plotly_deselect",null)}else Xe.indexOf("select")>-1&&N(Pe,ke,Q.xaxes,Q.yaxes,Q.subplot,Q,er),Xe==="event"&&ke.emit("plotly_selected",void 0);e.click(ke,Pe)}).catch(h.error)}},Q.doneFn=function(){He.remove(),v.done(Be).then(function(){v.clear(Be),Q.gd.emit("plotly_selected",We),rt&&Q.selectionDefs&&(rt.subtract=_t,Q.selectionDefs.push(rt),Q.mergedPolygons.length=0,[].push.apply(Q.mergedPolygons,Ye)),Q.doneFnCompleted&&Q.doneFnCompleted(Ke)}).catch(h.error),se&&Z(Q)}},clearSelect:k,clearSelectionsCache:Z,selectOnClick:N}},{"../../components/color":650,"../../components/dragelement/helpers":668,"../../components/drawing":672,"../../components/fx":690,"../../components/fx/helpers":686,"../../components/shapes/draw_newshape/display_outlines":738,"../../components/shapes/draw_newshape/helpers":739,"../../components/shapes/draw_newshape/newshapes":740,"../../lib":787,"../../lib/clear_gl_canvases":771,"../../lib/polygon":799,"../../lib/throttle":814,"../../plot_api/subroutines":828,"../../registry":915,"./axis_ids":842,"./constants":845,"./handle_outline":849,"./helpers":850,polybooljs:490}],859:[function(r,O,B){var t=r("@plotly/d3"),d=r("d3-time-format").utcFormat,m=r("../../lib"),p=m.numberFormat,e=r("fast-isnumeric"),f=m.cleanNumber,u=m.ms2DateTime,s=m.dateTime2ms,l=m.ensureNumber,o=m.isArrayOrTypedArray,i=r("../../constants/numerical"),c=i.FP_SAFE,n=i.BADNUM,a=i.LOG_CLIP,g=i.ONEWEEK,h=i.ONEDAY,y=i.ONEHOUR,v=i.ONEMIN,_=i.ONESEC,x=r("./axis_ids"),T=r("./constants"),A=T.HOUR_PATTERN,S=T.WEEKDAY_PATTERN;function w(k){return Math.pow(10,k)}function C(k){return k!=null}O.exports=function(k,L){L=L||{};var M=k._id||"x",P=M.charAt(0);function D(J,Q){if(J>0)return Math.log(J)/Math.LN10;if(J<=0&&Q&&k.range&&k.range.length===2){var te=k.range[0],ie=k.range[1];return .5*(te+ie-2*a*Math.abs(te-ie))}return n}function N(J,Q,te,ie){if((ie||{}).msUTC&&e(J))return+J;var ae=s(J,te||k.calendar);if(ae===n){if(!e(J))return n;J=+J;var he=Math.floor(10*m.mod(J+.05,1)),se=Math.round(J-he/10);ae=s(new Date(se))+he/10}return ae}function U(J,Q,te){return u(J,Q,te||k.calendar)}function q(J){return k._categories[Math.round(J)]}function X(J){if(C(J)){if(k._categoriesMap===void 0&&(k._categoriesMap={}),k._categoriesMap[J]!==void 0)return k._categoriesMap[J];k._categories.push(typeof J=="number"?String(J):J);var Q=k._categories.length-1;return k._categoriesMap[J]=Q,Q}return n}function K(J){if(k._categoriesMap)return k._categoriesMap[J]}function Z(J){var Q=K(J);return Q!==void 0?Q:e(J)?+J:void 0}function H(J){return e(J)?+J:K(J)}function Y(J,Q,te){return t.round(te+Q*J,2)}function $(J,Q,te){return(J-te)/Q}var z=function(J){return e(J)?Y(J,k._m,k._b):n},j=function(J){return $(J,k._m,k._b)};if(k.rangebreaks){var W=P==="y";z=function(J){if(!e(J))return n;var Q=k._rangebreaks.length;if(!Q)return Y(J,k._m,k._b);var te=W;k.range[0]>k.range[1]&&(te=!te);for(var ie=te?-1:1,ae=ie*J,he=0,se=0;se<Q;se++){var de=ie*k._rangebreaks[se].min,ue=ie*k._rangebreaks[se].max;if(ae<de)break;if(!(ae>ue)){he=ae<(de+ue)/2?se:se+1;break}he=se+1}var ve=k._B[he]||0;return isFinite(ve)?Y(J,k._m2,ve):0},j=function(J){var Q=k._rangebreaks.length;if(!Q)return $(J,k._m,k._b);for(var te=0,ie=0;ie<Q&&!(J<k._rangebreaks[ie].pmin);ie++)J>k._rangebreaks[ie].pmax&&(te=ie+1);return $(J,k._m2,k._B[te])}}k.c2l=k.type==="log"?D:l,k.l2c=k.type==="log"?w:l,k.l2p=z,k.p2l=j,k.c2p=k.type==="log"?function(J,Q){return z(D(J,Q))}:z,k.p2c=k.type==="log"?function(J){return w(j(J))}:j,["linear","-"].indexOf(k.type)!==-1?(k.d2r=k.r2d=k.d2c=k.r2c=k.d2l=k.r2l=f,k.c2d=k.c2r=k.l2d=k.l2r=l,k.d2p=k.r2p=function(J){return k.l2p(f(J))},k.p2d=k.p2r=j,k.cleanPos=l):k.type==="log"?(k.d2r=k.d2l=function(J,Q){return D(f(J),Q)},k.r2d=k.r2c=function(J){return w(f(J))},k.d2c=k.r2l=f,k.c2d=k.l2r=l,k.c2r=D,k.l2d=w,k.d2p=function(J,Q){return k.l2p(k.d2r(J,Q))},k.p2d=function(J){return w(j(J))},k.r2p=function(J){return k.l2p(f(J))},k.p2r=j,k.cleanPos=l):k.type==="date"?(k.d2r=k.r2d=m.identity,k.d2c=k.r2c=k.d2l=k.r2l=N,k.c2d=k.c2r=k.l2d=k.l2r=U,k.d2p=k.r2p=function(J,Q,te){return k.l2p(N(J,0,te))},k.p2d=k.p2r=function(J,Q,te){return U(j(J),Q,te)},k.cleanPos=function(J){return m.cleanDate(J,n,k.calendar)}):k.type==="category"?(k.d2c=k.d2l=X,k.r2d=k.c2d=k.l2d=q,k.d2r=k.d2l_noadd=Z,k.r2c=function(J){var Q=H(J);return Q!==void 0?Q:k.fraction2r(.5)},k.l2r=k.c2r=l,k.r2l=H,k.d2p=function(J){return k.l2p(k.r2c(J))},k.p2d=function(J){return q(j(J))},k.r2p=k.d2p,k.p2r=j,k.cleanPos=function(J){return typeof J=="string"&&J!==""?J:l(J)}):k.type==="multicategory"&&(k.r2d=k.c2d=k.l2d=q,k.d2r=k.d2l_noadd=Z,k.r2c=function(J){var Q=Z(J);return Q!==void 0?Q:k.fraction2r(.5)},k.r2c_just_indices=K,k.l2r=k.c2r=l,k.r2l=Z,k.d2p=function(J){return k.l2p(k.r2c(J))},k.p2d=function(J){return q(j(J))},k.r2p=k.d2p,k.p2r=j,k.cleanPos=function(J){return Array.isArray(J)||typeof J=="string"&&J!==""?J:l(J)},k.setupMultiCategory=function(J){var Q,te,ie=k._traceIndices,ae=k._matchGroup;if(ae&&k._categories.length===0){for(var he in ae)if(he!==M){var se=L[x.id2name(he)];ie=ie.concat(se._traceIndices)}}var de=[[0,{}],[0,{}]],ue=[];for(Q=0;Q<ie.length;Q++){var ve=J[ie[Q]];if(P in ve){var ke=ve[P],Ee=ve._length||m.minRowLength(ke);if(o(ke[0])&&o(ke[1]))for(te=0;te<Ee;te++){var be=ke[0][te],xe=ke[1][te];C(be)&&C(xe)&&(ue.push([be,xe]),be in de[0][1]||(de[0][1][be]=de[0][0]++),xe in de[1][1]||(de[1][1][xe]=de[1][0]++))}}}for(ue.sort(function(ce,ge){var we=de[0][1],Me=we[ce[0]]-we[ge[0]];if(Me)return Me;var Se=de[1][1];return Se[ce[1]]-Se[ge[1]]}),Q=0;Q<ue.length;Q++)X(ue[Q])}),k.fraction2r=function(J){var Q=k.r2l(k.range[0]),te=k.r2l(k.range[1]);return k.l2r(Q+J*(te-Q))},k.r2fraction=function(J){var Q=k.r2l(k.range[0]),te=k.r2l(k.range[1]);return(k.r2l(J)-Q)/(te-Q)},k.cleanRange=function(J,Q){Q||(Q={}),J||(J="range");var te,ie,ae=m.nestedProperty(k,J).get();if(ie=(ie=k.type==="date"?m.dfltRange(k.calendar):P==="y"?T.DFLTRANGEY:Q.dfltRange||T.DFLTRANGEX).slice(),k.rangemode!=="tozero"&&k.rangemode!=="nonnegative"||(ie[0]=0),ae&&ae.length===2)for(k.type!=="date"||k.autorange||(ae[0]=m.cleanDate(ae[0],n,k.calendar),ae[1]=m.cleanDate(ae[1],n,k.calendar)),te=0;te<2;te++)if(k.type==="date"){if(!m.isDateTime(ae[te],k.calendar)){k[J]=ie;break}if(k.r2l(ae[0])===k.r2l(ae[1])){var he=m.constrain(k.r2l(ae[0]),m.MIN_MS+1e3,m.MAX_MS-1e3);ae[0]=k.l2r(he-1e3),ae[1]=k.l2r(he+1e3);break}}else{if(!e(ae[te])){if(!e(ae[1-te])){k[J]=ie;break}ae[te]=ae[1-te]*(te?10:.1)}if(ae[te]<-c?ae[te]=-c:ae[te]>c&&(ae[te]=c),ae[0]===ae[1]){var se=Math.max(1,Math.abs(1e-6*ae[0]));ae[0]-=se,ae[1]+=se}}else m.nestedProperty(k,J).set(ie)},k.setScale=function(J){var Q=L._size;if(k.overlaying){var te=x.getFromId({_fullLayout:L},k.overlaying);k.domain=te.domain}var ie=J&&k._r?"_r":"range",ae=k.calendar;k.cleanRange(ie);var he,se,de=k.r2l(k[ie][0],ae),ue=k.r2l(k[ie][1],ae),ve=P==="y";if(ve?(k._offset=Q.t+(1-k.domain[1])*Q.h,k._length=Q.h*(k.domain[1]-k.domain[0]),k._m=k._length/(de-ue),k._b=-k._m*ue):(k._offset=Q.l+k.domain[0]*Q.w,k._length=Q.w*(k.domain[1]-k.domain[0]),k._m=k._length/(ue-de),k._b=-k._m*de),k._rangebreaks=[],k._lBreaks=0,k._m2=0,k._B=[],k.rangebreaks&&(k._rangebreaks=k.locateBreaks(Math.min(de,ue),Math.max(de,ue)),k._rangebreaks.length)){for(he=0;he<k._rangebreaks.length;he++)se=k._rangebreaks[he],k._lBreaks+=Math.abs(se.max-se.min);var ke=ve;de>ue&&(ke=!ke),ke&&k._rangebreaks.reverse();var Ee=ke?-1:1;for(k._m2=Ee*k._length/(Math.abs(ue-de)-k._lBreaks),k._B.push(-k._m2*(ve?ue:de)),he=0;he<k._rangebreaks.length;he++)se=k._rangebreaks[he],k._B.push(k._B[k._B.length-1]-Ee*k._m2*(se.max-se.min));for(he=0;he<k._rangebreaks.length;he++)(se=k._rangebreaks[he]).pmin=z(se.min),se.pmax=z(se.max)}if(!isFinite(k._m)||!isFinite(k._b)||k._length<0)throw L._replotting=!1,new Error("Something went wrong with axis scaling")},k.maskBreaks=function(J){var Q,te,ie,ae,he,se=k.rangebreaks||[];se._cachedPatterns||(se._cachedPatterns=se.map(function(be){return be.enabled&&be.bounds?m.simpleMap(be.bounds,be.pattern?f:k.d2c):null})),se._cachedValues||(se._cachedValues=se.map(function(be){return be.enabled&&be.values?m.simpleMap(be.values,k.d2c).sort(m.sorterAsc):null}));for(var de=0;de<se.length;de++){var ue=se[de];if(ue.enabled){if(ue.bounds){var ve=ue.pattern;switch(te=(Q=se._cachedPatterns[de])[0],ie=Q[1],ve){case S:ae=(he=new Date(J)).getUTCDay(),te>ie&&(ie+=7,ae<te&&(ae+=7));break;case A:ae=(he=new Date(J)).getUTCHours()+(he.getUTCMinutes()/60+he.getUTCSeconds()/3600+he.getUTCMilliseconds()/36e5),te>ie&&(ie+=24,ae<te&&(ae+=24));break;case"":ae=J}if(ae>=te&&ae<ie)return n}else for(var ke=se._cachedValues[de],Ee=0;Ee<ke.length;Ee++)if(ie=(te=ke[Ee])+ue.dvalue,J>=te&&J<ie)return n}}return J},k.locateBreaks=function(J,Q){var te,ie,ae,he,se=[];if(!k.rangebreaks)return se;var de=k.rangebreaks.slice().sort(function(Se,ze){return Se.pattern===S&&ze.pattern===A?-1:ze.pattern===S&&Se.pattern===A?1:0}),ue=function(Se,ze){if((Se=m.constrain(Se,J,Q))!==(ze=m.constrain(ze,J,Q))){for(var Fe=!0,Ye=0;Ye<se.length;Ye++){var rt=se[Ye];Se<rt.max&&ze>=rt.min&&(Se<rt.min&&(rt.min=Se),ze>rt.max&&(rt.max=ze),Fe=!1)}Fe&&se.push({min:Se,max:ze})}};for(te=0;te<de.length;te++){var ve=de[te];if(ve.enabled)if(ve.bounds){var ke=J,Ee=Q;ve.pattern&&(ke=Math.floor(ke)),ae=(ie=m.simpleMap(ve.bounds,ve.pattern?f:k.r2l))[0],he=ie[1];var be,xe,ce=new Date(ke);switch(ve.pattern){case S:xe=g,be=(he-ae+(he<ae?7:0))*h,ke+=ae*h-(ce.getUTCDay()*h+ce.getUTCHours()*y+ce.getUTCMinutes()*v+ce.getUTCSeconds()*_+ce.getUTCMilliseconds());break;case A:xe=h,be=(he-ae+(he<ae?24:0))*y,ke+=ae*y-(ce.getUTCHours()*y+ce.getUTCMinutes()*v+ce.getUTCSeconds()*_+ce.getUTCMilliseconds());break;default:ke=Math.min(ie[0],ie[1]),be=xe=(Ee=Math.max(ie[0],ie[1]))-ke}for(var ge=ke;ge<Ee;ge+=xe)ue(ge,ge+be)}else for(var we=m.simpleMap(ve.values,k.d2c),Me=0;Me<we.length;Me++)ue(ae=we[Me],he=ae+ve.dvalue)}return se.sort(function(Se,ze){return Se.min-ze.min}),se},k.makeCalcdata=function(J,Q,te){var ie,ae,he,se,de=k.type,ue=de==="date"&&J[Q+"calendar"];if(Q in J){if(ie=J[Q],se=J._length||m.minRowLength(ie),m.isTypedArray(ie)&&(de==="linear"||de==="log")){if(se===ie.length)return ie;if(ie.subarray)return ie.subarray(0,se)}if(de==="multicategory")return function(Ee,be){for(var xe=new Array(be),ce=0;ce<be;ce++){var ge=(Ee[0]||[])[ce],we=(Ee[1]||[])[ce];xe[ce]=K([ge,we])}return xe}(ie,se);for(ae=new Array(se),he=0;he<se;he++)ae[he]=k.d2c(ie[he],0,ue,te)}else{var ve=Q+"0"in J?k.d2c(J[Q+"0"],0,ue):0,ke=J["d"+Q]?Number(J["d"+Q]):1;for(ie=J[{x:"y",y:"x"}[Q]],se=J._length||ie.length,ae=new Array(se),he=0;he<se;he++)ae[he]=ve+he*ke}if(k.rangebreaks)for(he=0;he<se;he++)ae[he]=k.maskBreaks(ae[he]);return ae},k.isValidRange=function(J){return Array.isArray(J)&&J.length===2&&e(k.r2l(J[0]))&&e(k.r2l(J[1]))},k.isPtWithinRange=function(J,Q){var te=k.c2l(J[P],null,Q),ie=k.r2l(k.range[0]),ae=k.r2l(k.range[1]);return ie<ae?ie<=te&&te<=ae:ae<=te&&te<=ie},k._emptyCategories=function(){k._categories=[],k._categoriesMap={}},k.clearCalc=function(){var J=k._matchGroup;if(J){var Q=null,te=null;for(var ie in J){var ae=L[x.id2name(ie)];if(ae._categories){Q=ae._categories,te=ae._categoriesMap;break}}Q&&te?(k._categories=Q,k._categoriesMap=te):k._emptyCategories()}else k._emptyCategories();if(k._initialCategories)for(var he=0;he<k._initialCategories.length;he++)X(k._initialCategories[he])},k.sortByInitialCategories=function(){var J=[];if(k._emptyCategories(),k._initialCategories)for(var Q=0;Q<k._initialCategories.length;Q++)X(k._initialCategories[Q]);J=J.concat(k._traceIndices);var te=k._matchGroup;for(var ie in te)if(M!==ie){var ae=L[x.id2name(ie)];ae._categories=k._categories,ae._categoriesMap=k._categoriesMap,J=J.concat(ae._traceIndices)}return J};var ee=L._d3locale;k.type==="date"&&(k._dateFormat=ee?ee.timeFormat:d,k._extraFormat=L._extraFormat),k._separators=L.separators,k._numFormat=ee?ee.numberFormat:p,delete k._minDtick,delete k._forceTick0}},{"../../constants/numerical":763,"../../lib":787,"./axis_ids":842,"./constants":845,"@plotly/d3":58,"d3-time-format":172,"fast-isnumeric":246}],860:[function(r,O,B){var t=r("../../lib"),d=r("../../components/color").contrast,m=r("./layout_attributes"),p=r("../array_container_defaults");function e(u){var s=["showexponent","showtickprefix","showticksuffix"].filter(function(l){return u[l]!==void 0});if(s.every(function(l){return u[l]===u[s[0]]})||s.length===1)return u[s[0]]}function f(u,s){function l(o,i){return t.coerce(u,s,m.tickformatstops,o,i)}l("enabled")&&(l("dtickrange"),l("value"))}O.exports=function(u,s,l,o,i,c){c&&c.pass!==1||function(n,a,g,h,y){var v=e(n);g("tickprefix")&&g("showtickprefix",v),g("ticksuffix",y.tickSuffixDflt)&&g("showticksuffix",v)}(u,0,l,0,i),c&&c.pass!==2||function(n,a,g,h,y){var v=e(n);if(g("tickprefix")&&g("showtickprefix",v),g("ticksuffix",y.tickSuffixDflt)&&g("showticksuffix",v),g("showticklabels")){var _=y.font||{},x=a.color,T=(a.ticklabelposition||"").indexOf("inside")!==-1?d(y.bgColor):x&&x!==m.color.dflt?x:_.color;if(t.coerceFont(g,"tickfont",{family:_.family,size:_.size,color:T}),g("tickangle"),h!=="category"){var A=g("tickformat");p(n,a,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:f}),a.tickformatstops.length||delete a.tickformatstops,A||h==="date"||(g("showexponent",v),g("exponentformat"),g("minexponent"),g("separatethousands"))}}}(u,s,l,o,i)}},{"../../components/color":650,"../../lib":787,"../array_container_defaults":833,"./layout_attributes":853}],861:[function(r,O,B){var t=r("../../lib"),d=r("./layout_attributes");O.exports=function(m,p,e,f){var u=t.coerce2(m,p,d,"ticklen"),s=t.coerce2(m,p,d,"tickwidth"),l=t.coerce2(m,p,d,"tickcolor",p.color);e("ticks",f.outerTicks||u||s||l?"outside":"")||(delete p.ticklen,delete p.tickwidth,delete p.tickcolor)}},{"../../lib":787,"./layout_attributes":853}],862:[function(r,O,B){var t=r("./clean_ticks"),d=r("../../lib").isArrayOrTypedArray;O.exports=function(m,p,e,f){function u(n){var a=m[n];return a!==void 0?a:(p._template||{})[n]}var s=u("tick0"),l=u("dtick"),o=u("tickvals"),i=e("tickmode",d(o)?"array":l?"linear":"auto");if(i==="auto")e("nticks");else if(i==="linear"){var c=p.dtick=t.dtick(l,f);p.tick0=t.tick0(s,f,p.calendar,c)}else f!=="multicategory"&&(e("tickvals")===void 0?p.tickmode="auto":e("ticktext"))}},{"../../lib":787,"./clean_ticks":844}],863:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../registry"),m=r("../../lib"),p=r("../../components/drawing"),e=r("./axes");O.exports=function(f,u,s,l){var o=f._fullLayout;if(u.length!==0){var i,c,n,a;l&&(i=l());var g=t.ease(s.easing);return f._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(a),a=null,function(){for(var v={},_=0;_<u.length;_++){var x=u[_],T=x.plotinfo.xaxis,A=x.plotinfo.yaxis;x.xr0&&(v[T._name+".range"]=x.xr0.slice()),x.yr0&&(v[A._name+".range"]=x.yr0.slice())}return d.call("relayout",f,v).then(function(){for(var S=0;S<u.length;S++)h(u[S].plotinfo)})}()}),c=Date.now(),a=window.requestAnimationFrame(function v(){n=Date.now();for(var _=Math.min(1,(n-c)/s.duration),x=g(_),T=0;T<u.length;T++)y(u[T],x);n-c>s.duration?(function(){for(var A={},S=0;S<u.length;S++){var w=u[S],C=w.plotinfo.xaxis,k=w.plotinfo.yaxis;w.xr1&&(A[C._name+".range"]=w.xr1.slice()),w.yr1&&(A[k._name+".range"]=w.yr1.slice())}i&&i(),d.call("relayout",f,A).then(function(){for(var L=0;L<u.length;L++)h(u[L].plotinfo)})}(),a=window.cancelAnimationFrame(v)):a=window.requestAnimationFrame(v)}),Promise.resolve()}function h(v){var _=v.xaxis,x=v.yaxis;o._defs.select("#"+v.clipId+"> rect").call(p.setTranslate,0,0).call(p.setScale,1,1),v.plot.call(p.setTranslate,_._offset,x._offset).call(p.setScale,1,1);var T=v.plot.selectAll(".scatterlayer .trace");T.selectAll(".point").call(p.setPointGroupScale,1,1),T.selectAll(".textpoint").call(p.setTextPointsScale,1,1),T.call(p.hideOutsideRangePoints,v)}function y(v,_){var x=v.plotinfo,T=x.xaxis,A=x.yaxis,S=T._length,w=A._length,C=!!v.xr1,k=!!v.yr1,L=[];if(C){var M=m.simpleMap(v.xr0,T.r2l),P=m.simpleMap(v.xr1,T.r2l),D=M[1]-M[0],N=P[1]-P[0];L[0]=(M[0]*(1-_)+_*P[0]-M[0])/(M[1]-M[0])*S,L[2]=S*(1-_+_*N/D),T.range[0]=T.l2r(M[0]*(1-_)+_*P[0]),T.range[1]=T.l2r(M[1]*(1-_)+_*P[1])}else L[0]=0,L[2]=S;if(k){var U=m.simpleMap(v.yr0,A.r2l),q=m.simpleMap(v.yr1,A.r2l),X=U[1]-U[0],K=q[1]-q[0];L[1]=(U[1]*(1-_)+_*q[1]-U[1])/(U[0]-U[1])*w,L[3]=w*(1-_+_*K/X),A.range[0]=T.l2r(U[0]*(1-_)+_*q[0]),A.range[1]=A.l2r(U[1]*(1-_)+_*q[1])}else L[1]=0,L[3]=w;e.drawOne(f,T,{skipTitle:!0}),e.drawOne(f,A,{skipTitle:!0}),e.redrawComponents(f,[T._id,A._id]);var Z=C?S/L[2]:1,H=k?w/L[3]:1,Y=C?L[0]:0,$=k?L[1]:0,z=C?L[0]/L[2]*S:0,j=k?L[1]/L[3]*w:0,W=T._offset-z,ee=A._offset-j;x.clipRect.call(p.setTranslate,Y,$).call(p.setScale,1/Z,1/H),x.plot.call(p.setTranslate,W,ee).call(p.setScale,Z,H),p.setPointGroupScale(x.zoomScalePts,1/Z,1/H),p.setTextPointsScale(x.zoomScaleTxt,1/Z,1/H)}e.redrawComponents(f)}},{"../../components/drawing":672,"../../lib":787,"../../registry":915,"./axes":838,"@plotly/d3":58}],864:[function(r,O,B){var t=r("../../registry").traceIs,d=r("./axis_autotype");function m(e){return{v:"x",h:"y"}[e.orientation||"v"]}function p(e,f){var u=m(e),s=t(e,"box-violin"),l=t(e._fullInput||{},"candlestick");return s&&!l&&f===u&&e[u]===void 0&&e[u+"0"]===void 0}O.exports=function(e,f,u,s){u("autotypenumbers",s.autotypenumbersDflt),u("type",(s.splomStash||{}).type)==="-"&&(function(l,o){if(l.type==="-"){var i,c=l._id,n=c.charAt(0);c.indexOf("scene")!==-1&&(c=n);var a=function(A,S,w){for(var C=0;C<A.length;C++){var k=A[C];if(k.type==="splom"&&k._length>0&&(k["_"+w+"axes"]||{})[S]||(k[w+"axis"]||w)===S&&(p(k,w)||(k[w]||[]).length||k[w+"0"]))return k}}(o,c,n);if(!!a){if(a.type==="histogram"&&n==={v:"y",h:"x"}[a.orientation||"v"])return void(l.type="linear");var g=n+"calendar",h=a[g],y={noMultiCategory:!t(a,"cartesian")||t(a,"noMultiCategory")};if(a.type==="box"&&a._hasPreCompStats&&n==={h:"x",v:"y"}[a.orientation||"v"]&&(y.noMultiCategory=!0),y.autotypenumbers=l.autotypenumbers,p(a,n)){var v=m(a),_=[];for(i=0;i<o.length;i++){var x=o[i];t(x,"box-violin")&&(x[n+"axis"]||n)===c&&(x[v]!==void 0?_.push(x[v][0]):x.name!==void 0?_.push(x.name):_.push("text"),x[g]!==h&&(h=void 0))}l.type=d(_,h,y)}else if(a.type==="splom"){var T=a.dimensions[a._axesDim[c]];T.visible&&(l.type=d(T.values,h,y))}else l.type=d(a[n]||[a[n+"0"]],h,y)}}}(f,s.data),f.type==="-"?f.type="linear":e.type=f.type)}},{"../../registry":915,"./axis_autotype":839}],865:[function(r,O,B){var t=r("../registry"),d=r("../lib");function m(u,s,l){var o,i,c,n=!1;if(s.type==="data")o=u._fullData[s.traces!==null?s.traces[0]:0];else{if(s.type!=="layout")return!1;o=u._fullLayout}return i=d.nestedProperty(o,s.prop).get(),(c=l[s.type]=l[s.type]||{}).hasOwnProperty(s.prop)&&c[s.prop]!==i&&(n=!0),c[s.prop]=i,{changed:n,value:i}}function p(u,s){var l=[],o=s[0],i={};if(typeof o=="string")i[o]=s[1];else{if(!d.isPlainObject(o))return l;i=o}return f(i,function(c,n,a){l.push({type:"layout",prop:c,value:a})},"",0),l}function e(u,s){var l,o,i,c,n=[];if(o=s[0],i=s[1],l=s[2],c={},typeof o=="string")c[o]=i;else{if(!d.isPlainObject(o))return n;c=o,l===void 0&&(l=i)}return l===void 0&&(l=null),f(c,function(a,g,h){var y,v;if(Array.isArray(h)){v=h.slice();var _=Math.min(v.length,u.data.length);l&&(_=Math.min(_,l.length)),y=[];for(var x=0;x<_;x++)y[x]=l?l[x]:x}else v=h,y=l?l.slice():null;if(y===null)Array.isArray(v)&&(v=v[0]);else if(Array.isArray(y)){if(!Array.isArray(v)){var T=v;v=[];for(var A=0;A<y.length;A++)v[A]=T}v.length=Math.min(y.length,v.length)}n.push({type:"data",prop:a,traces:y,value:v})},"",0),n}function f(u,s,l,o){Object.keys(u).forEach(function(i){var c=u[i];if(i[0]!=="_"){var n=l+(o>0?".":"")+i;d.isPlainObject(c)?f(c,s,n,o+1):s(n,i,c)}})}B.manageCommandObserver=function(u,s,l,o){var i={},c=!0;s&&s._commandObserver&&(i=s._commandObserver),i.cache||(i.cache={}),i.lookupTable={};var n=B.hasSimpleAPICommandBindings(u,l,i.lookupTable);if(s&&s._commandObserver){if(n)return i;if(s._commandObserver.remove)return s._commandObserver.remove(),s._commandObserver=null,i}if(n){m(u,n,i.cache),i.check=function(){if(c){var h=m(u,n,i.cache);return h.changed&&o&&i.lookupTable[h.value]!==void 0&&(i.disable(),Promise.resolve(o({value:h.value,type:n.type,prop:n.prop,traces:n.traces,index:i.lookupTable[h.value]})).then(i.enable,i.enable)),h.changed}};for(var a=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],g=0;g<a.length;g++)u._internalOn(a[g],i.check);i.remove=function(){for(var h=0;h<a.length;h++)u._removeInternalListener(a[h],i.check)}}else d.log("Unable to automatically bind plot updates to API command"),i.lookupTable={},i.remove=function(){};return i.disable=function(){c=!1},i.enable=function(){c=!0},s&&(s._commandObserver=i),i},B.hasSimpleAPICommandBindings=function(u,s,l){var o,i,c=s.length;for(o=0;o<c;o++){var n,a=s[o],g=a.method,h=a.args;if(Array.isArray(h)||(h=[]),!g)return!1;var y=B.computeAPICommandBindings(u,g,h);if(y.length!==1)return!1;if(i){if((n=y[0]).type!==i.type||n.prop!==i.prop)return!1;if(Array.isArray(i.traces)){if(!Array.isArray(n.traces))return!1;n.traces.sort();for(var v=0;v<i.traces.length;v++)if(i.traces[v]!==n.traces[v])return!1}else if(n.prop!==i.prop)return!1}else i=y[0],Array.isArray(i.traces)&&i.traces.sort();var _=(n=y[0]).value;if(Array.isArray(_)){if(_.length!==1)return!1;_=_[0]}l&&(l[_]=o)}return i},B.executeAPICommand=function(u,s,l){if(s==="skip")return Promise.resolve();var o=t.apiMethodRegistry[s],i=[u];Array.isArray(l)||(l=[]);for(var c=0;c<l.length;c++)i.push(l[c]);return o.apply(null,i).catch(function(n){return d.warn("API call to Plotly."+s+" rejected.",n),Promise.reject(n)})},B.computeAPICommandBindings=function(u,s,l){var o;switch(Array.isArray(l)||(l=[]),s){case"restyle":o=e(u,l);break;case"relayout":o=p(u,l);break;case"update":o=e(u,[l[0],l[2]]).concat(p(u,[l[1]]));break;case"animate":o=function(i,c){return Array.isArray(c[0])&&c[0].length===1&&["string","number"].indexOf(typeof c[0][0])!==-1?[{type:"layout",prop:"_currentFrame",value:c[0][0].toString()}]:[]}(0,l);break;default:o=[]}return o}},{"../lib":787,"../registry":915}],866:[function(r,O,B){var t=r("../lib/extend").extendFlat;B.attributes=function(d,m){m=m||{};var p={valType:"info_array",editType:(d=d||{}).editType,items:[{valType:"number",min:0,max:1,editType:d.editType},{valType:"number",min:0,max:1,editType:d.editType}],dflt:[0,1]},e=(d.name&&d.name,d.trace,m.description&&m.description,{x:t({},p,{}),y:t({},p,{}),editType:d.editType});return d.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:d.editType},e.column={valType:"integer",min:0,dflt:0,editType:d.editType}),e},B.defaults=function(d,m,p,e){var f=e&&e.x||[0,1],u=e&&e.y||[0,1],s=m.grid;if(s){var l=p("domain.column");l!==void 0&&(l<s.columns?f=s._domains.x[l]:delete d.domain.column);var o=p("domain.row");o!==void 0&&(o<s.rows?u=s._domains.y[o]:delete d.domain.row)}var i=p("domain.x",f),c=p("domain.y",u);i[0]<i[1]||(d.domain.x=f.slice()),c[0]<c[1]||(d.domain.y=u.slice())}},{"../lib/extend":777}],867:[function(r,O,B){O.exports=function(t){var d=t.editType,m=t.colorEditType;m===void 0&&(m=d);var p={family:{valType:"string",noBlank:!0,strict:!0,editType:d},size:{valType:"number",min:1,editType:d},color:{valType:"color",editType:m},editType:d};return t.arrayOk&&(p.family.arrayOk=!0,p.size.arrayOk=!0,p.color.arrayOk=!0),p}},{}],868:[function(r,O,B){O.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],869:[function(r,O,B){B.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},B.axesNames=["lonaxis","lataxis"],B.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},B.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},B.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},B.clipPad=.001,B.precision=.1,B.landColor="#F0DC82",B.waterColor="#3399FF",B.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},B.sphereSVG={type:"Sphere"},B.fillLayers={ocean:1,land:1,lakes:1},B.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},B.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],B.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],B.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],870:[function(r,O,B){var t=r("@plotly/d3"),d=r("d3-geo"),m=d.geoPath,p=d.geoDistance,e=r("d3-geo-projection"),f=r("../../registry"),u=r("../../lib"),s=u.strTranslate,l=r("../../components/color"),o=r("../../components/drawing"),i=r("../../components/fx"),c=r("../plots"),n=r("../cartesian/axes"),a=r("../cartesian/autorange").getAutoRange,g=r("../../components/dragelement"),h=r("../cartesian/select").prepSelect,y=r("../cartesian/select").clearSelect,v=r("../cartesian/select").selectOnClick,_=r("./zoom"),x=r("./constants"),T=r("../../lib/geo_location_utils"),A=r("../../lib/topojson_utils"),S=r("topojson-client").feature;function w(L){this.id=L.id,this.graphDiv=L.graphDiv,this.container=L.container,this.topojsonURL=L.topojsonURL,this.isStatic=L.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var C=w.prototype;function k(L,M){var P=x.clipPad,D=L[0]+P,N=L[1]-P,U=M[0]+P,q=M[1]-P;D>0&&N<0&&(N+=360);var X=(N-D)/4;return{type:"Polygon",coordinates:[[[D,U],[D,q],[D+X,q],[D+2*X,q],[D+3*X,q],[N,q],[N,U],[N-X,U],[N-2*X,U],[N-3*X,U],[D,U]]]}}O.exports=function(L){return new w(L)},C.plot=function(L,M,P){var D=this,N=M[this.id],U=[],q=!1;for(var X in x.layerNameToAdjective)if(X!=="frame"&&N["show"+X]){q=!0;break}for(var K=0;K<L.length;K++)if(L[0][0].trace.locationmode){q=!0;break}if(q){var Z=A.getTopojsonName(N);D.topojson!==null&&Z===D.topojsonName||(D.topojsonName=Z,PlotlyGeoAssets.topojson[D.topojsonName]===void 0&&U.push(D.fetchTopojson()))}U=U.concat(T.fetchTraceGeoData(L)),P.push(new Promise(function(H,Y){Promise.all(U).then(function(){D.topojson=PlotlyGeoAssets.topojson[D.topojsonName],D.update(L,M),H()}).catch(Y)}))},C.fetchTopojson=function(){var L=this,M=A.getTopojsonPath(L.topojsonURL,L.topojsonName);return new Promise(function(P,D){t.json(M,function(N,U){if(N)return N.status===404?D(new Error(["plotly.js could not find topojson file at",M,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):D(new Error(["unexpected error while fetching topojson file at",M].join(" ")));PlotlyGeoAssets.topojson[L.topojsonName]=U,P()})})},C.update=function(L,M){var P=M[this.id];this.hasChoropleth=!1;for(var D=0;D<L.length;D++){var N=L[D],U=N[0].trace;U.type==="choropleth"&&(this.hasChoropleth=!0),U.visible===!0&&U._length>0&&U._module.calcGeoJSON(N,M)}if(!this.updateProjection(L,M)){this.viewInitial&&this.scope===P.scope||this.saveViewInitial(P),this.scope=P.scope,this.updateBaseLayers(M,P),this.updateDims(M,P),this.updateFx(M,P),c.generalUpdatePerTraceModule(this.graphDiv,this,L,P);var q=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=q.selectAll(".point"),this.dataPoints.text=q.selectAll("text"),this.dataPaths.line=q.selectAll(".js-line");var X=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=X.selectAll("path"),this.render()}},C.updateProjection=function(L,M){var P=this.graphDiv,D=M[this.id],N=M._size,U=D.domain,q=D.projection,X=D.lonaxis,K=D.lataxis,Z=X._ax,H=K._ax,Y=this.projection=function(ce){var ge=ce.projection,we=ge.type,Me=x.projNames[we];Me="geo"+u.titleCase(Me);for(var Se=(d[Me]||e[Me])(),ze=ce._isSatellite?180*Math.acos(1/ge.distance)/Math.PI:ce._isClipped?x.lonaxisSpan[we]/2:null,Fe=["center","rotate","parallels","clipExtent"],Ye=function(je){return je?Se:[]},rt=0;rt<Fe.length;rt++){var Oe=Fe[rt];typeof Se[Oe]!="function"&&(Se[Oe]=Ye)}return Se.isLonLatOverEdges=function(je){if(Se(je)===null)return!0;if(ze){var We=Se.rotate();return p(je,[-We[0],-We[1]])>ze*Math.PI/180}return!1},Se.getPath=function(){return m().projection(Se)},Se.getBounds=function(je){return Se.getPath().bounds(je)},Se.precision(x.precision),ce._isSatellite&&Se.tilt(ge.tilt).distance(ge.distance),ze&&Se.clipAngle(ze-x.clipPad),Se}(D),$=[[N.l+N.w*U.x[0],N.t+N.h*(1-U.y[1])],[N.l+N.w*U.x[1],N.t+N.h*(1-U.y[0])]],z=D.center||{},j=q.rotation||{},W=X.range||[],ee=K.range||[];if(D.fitbounds){Z._length=$[1][0]-$[0][0],H._length=$[1][1]-$[0][1],Z.range=a(P,Z),H.range=a(P,H);var J=(Z.range[0]+Z.range[1])/2,Q=(H.range[0]+H.range[1])/2;if(D._isScoped)z={lon:J,lat:Q};else if(D._isClipped){z={lon:J,lat:Q},j={lon:J,lat:Q,roll:j.roll};var te=q.type,ie=x.lonaxisSpan[te]/2||180,ae=x.lataxisSpan[te]/2||90;W=[J-ie,J+ie],ee=[Q-ae,Q+ae]}else z={lon:J,lat:Q},j={lon:J,lat:j.lat,roll:j.roll}}Y.center([z.lon-j.lon,z.lat-j.lat]).rotate([-j.lon,-j.lat,j.roll]).parallels(q.parallels);var he=k(W,ee);Y.fitExtent($,he);var se=this.bounds=Y.getBounds(he),de=this.fitScale=Y.scale(),ue=Y.translate();if(D.fitbounds){var ve=Y.getBounds(k(Z.range,H.range)),ke=Math.min((se[1][0]-se[0][0])/(ve[1][0]-ve[0][0]),(se[1][1]-se[0][1])/(ve[1][1]-ve[0][1]));isFinite(ke)?Y.scale(ke*de):u.warn("Something went wrong during"+this.id+"fitbounds computations.")}else Y.scale(q.scale*de);var Ee=this.midPt=[(se[0][0]+se[1][0])/2,(se[0][1]+se[1][1])/2];if(Y.translate([ue[0]+(Ee[0]-ue[0]),ue[1]+(Ee[1]-ue[1])]).clipExtent(se),D._isAlbersUsa){var be=Y([z.lon,z.lat]),xe=Y.translate();Y.translate([xe[0]-(be[0]-xe[0]),xe[1]-(be[1]-xe[1])])}},C.updateBaseLayers=function(L,M){var P=this,D=P.topojson,N=P.layers,U=P.basePaths;function q(Y){return Y==="lonaxis"||Y==="lataxis"}function X(Y){return Boolean(x.lineLayers[Y])}function K(Y){return Boolean(x.fillLayers[Y])}var Z=(this.hasChoropleth?x.layersForChoropleth:x.layers).filter(function(Y){return X(Y)||K(Y)?M["show"+Y]:!q(Y)||M[Y].showgrid}),H=P.framework.selectAll(".layer").data(Z,String);H.exit().each(function(Y){delete N[Y],delete U[Y],t.select(this).remove()}),H.enter().append("g").attr("class",function(Y){return"layer "+Y}).each(function(Y){var $=N[Y]=t.select(this);Y==="bg"?P.bgRect=$.append("rect").style("pointer-events","all"):q(Y)?U[Y]=$.append("path").style("fill","none"):Y==="backplot"?$.append("g").classed("choroplethlayer",!0):Y==="frontplot"?$.append("g").classed("scatterlayer",!0):X(Y)?U[Y]=$.append("path").style("fill","none").style("stroke-miterlimit",2):K(Y)&&(U[Y]=$.append("path").style("stroke","none"))}),H.order(),H.each(function(Y){var $=U[Y],z=x.layerNameToAdjective[Y];Y==="frame"?$.datum(x.sphereSVG):X(Y)||K(Y)?$.datum(S(D,D.objects[Y])):q(Y)&&$.datum(function(j,W,ee){var J,Q,te,ie=W[j],ae=x.scopeDefaults[W.scope];j==="lonaxis"?(J=ae.lonaxisRange,Q=ae.lataxisRange,te=function(xe,ce){return[xe,ce]}):j==="lataxis"&&(J=ae.lataxisRange,Q=ae.lonaxisRange,te=function(xe,ce){return[ce,xe]});var he={type:"linear",range:[J[0],J[1]-1e-6],tick0:ie.tick0,dtick:ie.dtick};n.setConvert(he,ee);var se=n.calcTicks(he);W.isScoped||j!=="lonaxis"||se.pop();for(var de=se.length,ue=new Array(de),ve=0;ve<de;ve++)for(var ke=se[ve].x,Ee=ue[ve]=[],be=Q[0];be<Q[1]+2.5;be+=2.5)Ee.push(te(ke,be));return{type:"MultiLineString",coordinates:ue}}(Y,M,L)).call(l.stroke,M[Y].gridcolor).call(o.dashLine,"",M[Y].gridwidth),X(Y)?$.call(l.stroke,M[z+"color"]).call(o.dashLine,"",M[z+"width"]):K(Y)&&$.call(l.fill,M[z+"color"])})},C.updateDims=function(L,M){var P=this.bounds,D=(M.framewidth||0)/2,N=P[0][0]-D,U=P[0][1]-D,q=P[1][0]-N+D,X=P[1][1]-U+D;o.setRect(this.clipRect,N,U,q,X),this.bgRect.call(o.setRect,N,U,q,X).call(l.fill,M.bgcolor),this.xaxis._offset=N,this.xaxis._length=q,this.yaxis._offset=U,this.yaxis._length=X},C.updateFx=function(L,M){var P=this,D=P.graphDiv,N=P.bgRect,U=L.dragmode,q=L.clickmode;if(!P.isStatic){var X;U==="select"?X=function(H,Y){(H.range={})[P.id]=[Z([Y.xmin,Y.ymin]),Z([Y.xmax,Y.ymax])]}:U==="lasso"&&(X=function(H,Y,$){(H.lassoPoints={})[P.id]=$.filtered.map(Z)});var K={element:P.bgRect.node(),gd:D,plotinfo:{id:P.id,xaxis:P.xaxis,yaxis:P.yaxis,fillRangeItems:X},xaxes:[P.xaxis],yaxes:[P.yaxis],subplot:P.id,clickFn:function(H){H===2&&y(D)}};U==="pan"?(N.node().onmousedown=null,N.call(_(P,M)),N.on("dblclick.zoom",function(){var H=P.viewInitial,Y={};for(var $ in H)Y[P.id+"."+$]=H[$];f.call("_guiRelayout",D,Y),D.emit("plotly_doubleclick",null)}),D._context._scrollZoom.geo||N.on("wheel.zoom",null)):U!=="select"&&U!=="lasso"||(N.on(".zoom",null),K.prepFn=function(H,Y,$){h(H,Y,$,K,U)},g.init(K)),N.on("mousemove",function(){var H=P.projection.invert(u.getPositionFromD3Event());if(!H)return g.unhover(D,t.event);P.xaxis.p2c=function(){return H[0]},P.yaxis.p2c=function(){return H[1]},i.hover(D,t.event,P.id)}),N.on("mouseout",function(){D._dragging||g.unhover(D,t.event)}),N.on("click",function(){U!=="select"&&U!=="lasso"&&(q.indexOf("select")>-1&&v(t.event,D,[P.xaxis],[P.yaxis],P.id,K),q.indexOf("event")>-1&&i.click(D,t.event))})}function Z(H){return P.projection.invert([H[0]+P.xaxis._offset,H[1]+P.yaxis._offset])}},C.makeFramework=function(){var L=this,M=L.graphDiv,P=M._fullLayout,D="clip"+P._uid+L.id;L.clipDef=P._clips.append("clipPath").attr("id",D),L.clipRect=L.clipDef.append("rect"),L.framework=t.select(L.container).append("g").attr("class","geo "+L.id).call(o.setClipUrl,D,M),L.project=function(N){var U=L.projection(N);return U?[U[0]-L.xaxis._offset,U[1]-L.yaxis._offset]:[null,null]},L.xaxis={_id:"x",c2p:function(N){return L.project(N)[0]}},L.yaxis={_id:"y",c2p:function(N){return L.project(N)[1]}},L.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},n.setConvert(L.mockAxis,P)},C.saveViewInitial=function(L){var M,P=L.center||{},D=L.projection,N=D.rotation||{};this.viewInitial={fitbounds:L.fitbounds,"projection.scale":D.scale},M=L._isScoped?{"center.lon":P.lon,"center.lat":P.lat}:L._isClipped?{"projection.rotation.lon":N.lon,"projection.rotation.lat":N.lat}:{"center.lon":P.lon,"center.lat":P.lat,"projection.rotation.lon":N.lon},u.extendFlat(this.viewInitial,M)},C.render=function(){var L,M=this.projection,P=M.getPath();function D(U){var q=M(U.lonlat);return q?s(q[0],q[1]):null}function N(U){return M.isLonLatOverEdges(U.lonlat)?"none":null}for(L in this.basePaths)this.basePaths[L].attr("d",P);for(L in this.dataPaths)this.dataPaths[L].attr("d",function(U){return P(U.geojson)});for(L in this.dataPoints)this.dataPoints[L].attr("display",N).attr("transform",D)}},{"../../components/color":650,"../../components/dragelement":669,"../../components/drawing":672,"../../components/fx":690,"../../lib":787,"../../lib/geo_location_utils":780,"../../lib/topojson_utils":816,"../../registry":915,"../cartesian/autorange":837,"../cartesian/axes":838,"../cartesian/select":858,"../plots":901,"./constants":869,"./zoom":874,"@plotly/d3":58,"d3-geo":166,"d3-geo-projection":165,"topojson-client":586}],871:[function(r,O,B){var t=r("../../plots/get_data").getSubplotCalcData,d=r("../../lib").counterRegex,m=r("./geo"),p="geo",e=d(p),f={};f.geo={valType:"subplotid",dflt:p,editType:"calc"},O.exports={attr:p,name:p,idRoot:p,idRegex:e,attrRegex:e,attributes:f,layoutAttributes:r("./layout_attributes"),supplyLayoutDefaults:r("./layout_defaults"),plot:function(u){for(var s=u._fullLayout,l=u.calcdata,o=s._subplots.geo,i=0;i<o.length;i++){var c=o[i],n=t(l,p,c),a=s[c]._subplot;a||(a=m({id:c,graphDiv:u,container:s._geolayer.node(),topojsonURL:u._context.topojsonURL,staticPlot:u._context.staticPlot}),s[c]._subplot=a),a.plot(n,s,u._promises)}},updateFx:function(u){for(var s=u._fullLayout,l=s._subplots.geo,o=0;o<l.length;o++){var i=s[l[o]];i._subplot.updateFx(s,i)}},clean:function(u,s,l,o){for(var i=o._subplots.geo||[],c=0;c<i.length;c++){var n=i[c],a=o[n]._subplot;!s[n]&&a&&(a.framework.remove(),a.clipDef.remove())}}}},{"../../lib":787,"../../plots/get_data":875,"./geo":870,"./layout_attributes":872,"./layout_defaults":873}],872:[function(r,O,B){var t=r("../../components/color/attributes"),d=r("../domain").attributes,m=r("./constants"),p=r("../../plot_api/edit_types").overrideAll,e=r("../../lib/sort_object_keys"),f={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:t.lightLine},gridwidth:{valType:"number",min:0,dflt:1}};(O.exports=p({domain:d({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:e(m.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:e(m.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:t.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:m.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:m.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:m.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:m.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:t.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:t.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:t.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:t.background},lonaxis:f,lataxis:f},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":649,"../../lib/sort_object_keys":810,"../../plot_api/edit_types":820,"../domain":866,"./constants":869}],873:[function(r,O,B){var t=r("../../lib"),d=r("../subplot_defaults"),m=r("../get_data").getSubplotData,p=r("./constants"),e=r("./layout_attributes"),f=p.axesNames;function u(s,l,o,i){var c=m(i.fullData,"geo",i.id).map(function(j){return j._expandedIndex}),n=o("resolution"),a=o("scope"),g=p.scopeDefaults[a],h=o("projection.type",g.projType),y=l._isAlbersUsa=h==="albers usa";y&&(a=l.scope="usa");var v=l._isScoped=a!=="world",_=l._isSatellite=h==="satellite",x=l._isConic=h.indexOf("conic")!==-1||h==="albers",T=l._isClipped=!!p.lonaxisSpan[h];if(s.visible===!1){var A=t.extendDeep({},l._template);A.showcoastlines=!1,A.showcountries=!1,A.showframe=!1,A.showlakes=!1,A.showland=!1,A.showocean=!1,A.showrivers=!1,A.showsubunits=!1,A.lonaxis&&(A.lonaxis.showgrid=!1),A.lataxis&&(A.lataxis.showgrid=!1),l._template=A}for(var S=o("visible"),w=0;w<f.length;w++){var C,k=f[w],L=[30,10][w];if(v)C=g[k+"Range"];else{var M=p[k+"Span"],P=(M[h]||M["*"])/2,D=o("projection.rotation."+k.substr(0,3),g.projRotate[w]);C=[D-P,D+P]}var N=o(k+".range",C);o(k+".tick0"),o(k+".dtick",L),o(k+".showgrid",!!S&&void 0)&&(o(k+".gridcolor"),o(k+".gridwidth")),l[k]._ax={type:"linear",_id:k.slice(0,3),_traceIndices:c,setScale:t.identity,c2l:t.identity,r2l:t.identity,autorange:!0,range:N.slice(),_m:1,_input:{}}}var U=l.lonaxis.range,q=l.lataxis.range,X=U[0],K=U[1];X>0&&K<0&&(K+=360);var Z,H,Y,$=(X+K)/2;if(!y){var z=v?g.projRotate:[$,0,0];Z=o("projection.rotation.lon",z[0]),o("projection.rotation.lat",z[1]),o("projection.rotation.roll",z[2]),o("showcoastlines",!v&&S)&&(o("coastlinecolor"),o("coastlinewidth")),o("showocean",!!S&&void 0)&&o("oceancolor")}y?(H=-96.6,Y=38.7):(H=v?$:Z,Y=(q[0]+q[1])/2),o("center.lon",H),o("center.lat",Y),_&&(o("projection.tilt"),o("projection.distance")),x&&o("projection.parallels",g.projParallels||[0,60]),o("projection.scale"),o("showland",!!S&&void 0)&&o("landcolor"),o("showlakes",!!S&&void 0)&&o("lakecolor"),o("showrivers",!!S&&void 0)&&(o("rivercolor"),o("riverwidth")),o("showcountries",v&&a!=="usa"&&S)&&(o("countrycolor"),o("countrywidth")),(a==="usa"||a==="north america"&&n===50)&&(o("showsubunits",S),o("subunitcolor"),o("subunitwidth")),v||o("showframe",S)&&(o("framecolor"),o("framewidth")),o("bgcolor"),o("fitbounds")&&(delete l.projection.scale,v?(delete l.center.lon,delete l.center.lat):T?(delete l.center.lon,delete l.center.lat,delete l.projection.rotation.lon,delete l.projection.rotation.lat,delete l.lonaxis.range,delete l.lataxis.range):(delete l.center.lon,delete l.center.lat,delete l.projection.rotation.lon))}O.exports=function(s,l,o){d(s,l,o,{type:"geo",attributes:e,handleDefaults:u,fullData:o,partition:"y"})}},{"../../lib":787,"../get_data":875,"../subplot_defaults":909,"./constants":869,"./layout_attributes":872}],874:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../registry"),p=Math.PI/180,e=180/Math.PI,f={cursor:"pointer"},u={cursor:"auto"};function s(S,w){return t.behavior.zoom().translate(w.translate()).scale(w.scale())}function l(S,w,C){var k=S.id,L=S.graphDiv,M=L.layout,P=M[k],D=L._fullLayout,N=D[k],U={},q={};function X(K,Z){U[k+"."+K]=d.nestedProperty(P,K).get(),m.call("_storeDirectGUIEdit",M,D._preGUI,U);var H=d.nestedProperty(N,K);H.get()!==Z&&(H.set(Z),d.nestedProperty(P,K).set(Z),q[k+"."+K]=Z)}C(X),X("projection.scale",w.scale()/S.fitScale),X("fitbounds",!1),L.emit("plotly_relayout",q)}function o(S,w){var C=s(0,w);function k(L){var M=w.invert(S.midPt);L("center.lon",M[0]),L("center.lat",M[1])}return C.on("zoomstart",function(){t.select(this).style(f)}).on("zoom",function(){w.scale(t.event.scale).translate(t.event.translate),S.render();var L=w.invert(S.midPt);S.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":w.scale()/S.fitScale,"geo.center.lon":L[0],"geo.center.lat":L[1]})}).on("zoomend",function(){t.select(this).style(u),l(S,w,k)}),C}function i(S,w){var C,k,L,M,P,D,N,U,q,X=s(0,w);function K(H){return w.invert(H)}function Z(H){var Y=w.rotate(),$=w.invert(S.midPt);H("projection.rotation.lon",-Y[0]),H("center.lon",$[0]),H("center.lat",$[1])}return X.on("zoomstart",function(){t.select(this).style(f),C=t.mouse(this),k=w.rotate(),L=w.translate(),M=k,P=K(C)}).on("zoom",function(){if(D=t.mouse(this),function($){var z=K($);if(!z)return!0;var j=w(z);return Math.abs(j[0]-$[0])>2||Math.abs(j[1]-$[1])>2}(C))return X.scale(w.scale()),void X.translate(w.translate());w.scale(t.event.scale),w.translate([L[0],t.event.translate[1]]),P?K(D)&&(U=K(D),N=[M[0]+(U[0]-P[0]),k[1],k[2]],w.rotate(N),M=N):P=K(C=D),q=!0,S.render();var H=w.rotate(),Y=w.invert(S.midPt);S.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":w.scale()/S.fitScale,"geo.center.lon":Y[0],"geo.center.lat":Y[1],"geo.projection.rotation.lon":-H[0]})}).on("zoomend",function(){t.select(this).style(u),q&&l(S,w,Z)}),X}function c(S,w){var C,k={r:w.rotate(),k:w.scale()},L=s(0,w),M=function(K){for(var Z=0,H=arguments.length,Y=[];++Z<H;)Y.push(arguments[Z]);var $=t.dispatch.apply(null,Y);return $.of=function(z,j){return function(W){var ee;try{ee=W.sourceEvent=t.event,W.target=K,t.event=W,$[W.type].apply(z,j)}finally{t.event=ee}}},$}(L,"zoomstart","zoom","zoomend"),P=0,D=L.on;function N(K){P++||K({type:"zoomstart"})}function U(K){K({type:"zoom"})}function q(K){--P||K({type:"zoomend"})}function X(K){var Z=w.rotate();K("projection.rotation.lon",-Z[0]),K("projection.rotation.lat",-Z[1])}return L.on("zoomstart",function(){t.select(this).style(f);var K=t.mouse(this),Z=w.rotate(),H=Z,Y=w.translate(),$=a(Z);C=n(w,K),D.call(L,"zoom",function(){var z=t.mouse(this);if(w.scale(k.k=t.event.scale),C){if(n(w,z)){w.rotate(Z).translate(Y);var j=n(w,z),W=h(C,j),ee=T(g($,W)),J=k.r=y(ee,C,H);isFinite(J[0])&&isFinite(J[1])&&isFinite(J[2])||(J=H),w.rotate(J),H=J}}else C=n(w,K=z);U(M.of(this,arguments))}),N(M.of(this,arguments))}).on("zoomend",function(){t.select(this).style(u),D.call(L,"zoom",null),q(M.of(this,arguments)),l(S,w,X)}).on("zoom.redraw",function(){S.render();var K=w.rotate();S.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":w.scale()/S.fitScale,"geo.projection.rotation.lon":-K[0],"geo.projection.rotation.lat":-K[1]})}),t.rebind(L,M,"on")}function n(S,w){var C=S.invert(w);return C&&isFinite(C[0])&&isFinite(C[1])&&function(k){var L=k[0]*p,M=k[1]*p,P=Math.cos(M);return[P*Math.cos(L),P*Math.sin(L),Math.sin(M)]}(C)}function a(S){var w=.5*S[0]*p,C=.5*S[1]*p,k=.5*S[2]*p,L=Math.sin(w),M=Math.cos(w),P=Math.sin(C),D=Math.cos(C),N=Math.sin(k),U=Math.cos(k);return[M*D*U+L*P*N,L*D*U-M*P*N,M*P*U+L*D*N,M*D*N-L*P*U]}function g(S,w){var C=S[0],k=S[1],L=S[2],M=S[3],P=w[0],D=w[1],N=w[2],U=w[3];return[C*P-k*D-L*N-M*U,C*D+k*P+L*U-M*N,C*N-k*U+L*P+M*D,C*U+k*N-L*D+M*P]}function h(S,w){if(S&&w){var C=function(P,D){return[P[1]*D[2]-P[2]*D[1],P[2]*D[0]-P[0]*D[2],P[0]*D[1]-P[1]*D[0]]}(S,w),k=Math.sqrt(A(C,C)),L=.5*Math.acos(Math.max(-1,Math.min(1,A(S,w)))),M=Math.sin(L)/k;return k&&[Math.cos(L),C[2]*M,-C[1]*M,C[0]*M]}}function y(S,w,C){var k=x(w,2,S[0]);k=x(k,1,S[1]),k=x(k,0,S[2]-C[2]);var L,M,P=w[0],D=w[1],N=w[2],U=k[0],q=k[1],X=k[2],K=Math.atan2(D,P)*e,Z=Math.sqrt(P*P+D*D);Math.abs(q)>Z?(M=(q>0?90:-90)-K,L=0):(M=Math.asin(q/Z)*e-K,L=Math.sqrt(Z*Z-q*q));var H=180-M-2*K,Y=(Math.atan2(X,U)-Math.atan2(N,L))*e,$=(Math.atan2(X,U)-Math.atan2(N,-L))*e;return v(C[0],C[1],M,Y)<=v(C[0],C[1],H,$)?[M,Y,C[2]]:[H,$,C[2]]}function v(S,w,C,k){var L=_(C-S),M=_(k-w);return Math.sqrt(L*L+M*M)}function _(S){return(S%360+540)%360-180}function x(S,w,C){var k=C*p,L=S.slice(),M=w===0?1:0,P=w===2?1:2,D=Math.cos(k),N=Math.sin(k);return L[M]=S[M]*D-S[P]*N,L[P]=S[P]*D+S[M]*N,L}function T(S){return[Math.atan2(2*(S[0]*S[1]+S[2]*S[3]),1-2*(S[1]*S[1]+S[2]*S[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(S[0]*S[2]-S[3]*S[1]))))*e,Math.atan2(2*(S[0]*S[3]+S[1]*S[2]),1-2*(S[2]*S[2]+S[3]*S[3]))*e]}function A(S,w){for(var C=0,k=0,L=S.length;k<L;++k)C+=S[k]*w[k];return C}O.exports=function(S,w){var C=S.projection;return(w._isScoped?o:w._isClipped?c:i)(S,C)}},{"../../lib":787,"../../registry":915,"@plotly/d3":58}],875:[function(r,O,B){var t=r("../registry"),d=r("./cartesian/constants").SUBPLOT_PATTERN;B.getSubplotCalcData=function(m,p,e){var f=t.subplotsRegistry[p];if(!f)return[];for(var u=f.attr,s=[],l=0;l<m.length;l++){var o=m[l];o[0].trace[u]===e&&s.push(o)}return s},B.getModuleCalcData=function(m,p){var e,f=[],u=[];if(!(e=typeof p=="string"?t.getModule(p).plot:typeof p=="function"?p:p.plot))return[f,m];for(var s=0;s<m.length;s++){var l=m[s],o=l[0].trace;o.visible===!0&&o._length!==0&&(o._module.plot===e?f.push(l):u.push(l))}return[f,u]},B.getSubplotData=function(m,p,e){if(!t.subplotsRegistry[p])return[];var f,u,s,l=t.subplotsRegistry[p].attr,o=[];if(p==="gl2d"){var i=e.match(d);u="x"+i[1],s="y"+i[2]}for(var c=0;c<m.length;c++)f=m[c],p==="gl2d"&&t.traceIs(f,"gl2d")?f[l[0]]===u&&f[l[1]]===s&&o.push(f):f[l]===e&&o.push(f);return o}},{"../registry":915,"./cartesian/constants":845}],876:[function(r,O,B){var t=r("mouse-change"),d=r("mouse-wheel"),m=r("mouse-event-offset"),p=r("../cartesian/constants"),e=r("has-passive-events");function f(u,s){this.element=u,this.plot=s,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}O.exports=function(u){var s=u.mouseContainer,l=u.glplot,o=new f(s,l);function i(){u.xaxis.autorange=!1,u.yaxis.autorange=!1}function c(n,a,g){var h,y,v=u.calcDataBox(),_=l.viewBox,x=o.lastPos[0],T=o.lastPos[1],A=p.MINDRAG*l.pixelRatio,S=p.MINZOOM*l.pixelRatio;function w(D,N,U){var q=Math.min(N,U),X=Math.max(N,U);q!==X?(v[D]=q,v[D+2]=X,o.dataBox=v,u.setRanges(v)):(u.selectBox.selectBox=[0,0,1,1],u.glplot.setDirty())}switch(a*=l.pixelRatio,g*=l.pixelRatio,g=_[3]-_[1]-g,u.fullLayout.dragmode){case"zoom":if(n){var C=a/(_[2]-_[0])*(v[2]-v[0])+v[0],k=g/(_[3]-_[1])*(v[3]-v[1])+v[1];o.boxInited||(o.boxStart[0]=C,o.boxStart[1]=k,o.dragStart[0]=a,o.dragStart[1]=g),o.boxEnd[0]=C,o.boxEnd[1]=k,o.boxInited=!0,o.boxEnabled||o.boxStart[0]===o.boxEnd[0]&&o.boxStart[1]===o.boxEnd[1]||(o.boxEnabled=!0);var L=Math.abs(o.dragStart[0]-a)<S,M=Math.abs(o.dragStart[1]-g)<S;if(!function(){for(var D=u.graphDiv._fullLayout._axisConstraintGroups,N=u.xaxis._id,U=u.yaxis._id,q=0;q<D.length;q++)if(D[q][N]!==-1){if(D[q][U]!==-1)return!0;break}return!1}()||L&&M)L&&(o.boxEnd[0]=o.boxStart[0]),M&&(o.boxEnd[1]=o.boxStart[1]);else{h=o.boxEnd[0]-o.boxStart[0],y=o.boxEnd[1]-o.boxStart[1];var P=(v[3]-v[1])/(v[2]-v[0]);Math.abs(h*P)>Math.abs(y)?(o.boxEnd[1]=o.boxStart[1]+Math.abs(h)*P*(y>=0?1:-1),o.boxEnd[1]<v[1]?(o.boxEnd[1]=v[1],o.boxEnd[0]=o.boxStart[0]+(v[1]-o.boxStart[1])/Math.abs(P)):o.boxEnd[1]>v[3]&&(o.boxEnd[1]=v[3],o.boxEnd[0]=o.boxStart[0]+(v[3]-o.boxStart[1])/Math.abs(P))):(o.boxEnd[0]=o.boxStart[0]+Math.abs(y)/P*(h>=0?1:-1),o.boxEnd[0]<v[0]?(o.boxEnd[0]=v[0],o.boxEnd[1]=o.boxStart[1]+(v[0]-o.boxStart[0])*Math.abs(P)):o.boxEnd[0]>v[2]&&(o.boxEnd[0]=v[2],o.boxEnd[1]=o.boxStart[1]+(v[2]-o.boxStart[0])*Math.abs(P)))}}else o.boxEnabled?(h=o.boxStart[0]!==o.boxEnd[0],y=o.boxStart[1]!==o.boxEnd[1],h||y?(h&&(w(0,o.boxStart[0],o.boxEnd[0]),u.xaxis.autorange=!1),y&&(w(1,o.boxStart[1],o.boxEnd[1]),u.yaxis.autorange=!1),u.relayoutCallback()):u.glplot.setDirty(),o.boxEnabled=!1,o.boxInited=!1):o.boxInited&&(o.boxInited=!1);break;case"pan":o.boxEnabled=!1,o.boxInited=!1,n?(o.panning||(o.dragStart[0]=a,o.dragStart[1]=g),Math.abs(o.dragStart[0]-a)<A&&(a=o.dragStart[0]),Math.abs(o.dragStart[1]-g)<A&&(g=o.dragStart[1]),h=(x-a)*(v[2]-v[0])/(l.viewBox[2]-l.viewBox[0]),y=(T-g)*(v[3]-v[1])/(l.viewBox[3]-l.viewBox[1]),v[0]+=h,v[2]+=h,v[1]+=y,v[3]+=y,u.setRanges(v),o.panning=!0,o.lastInputTime=Date.now(),i(),u.cameraChanged(),u.handleAnnotations()):o.panning&&(o.panning=!1,u.relayoutCallback())}o.lastPos[0]=a,o.lastPos[1]=g}return o.mouseListener=t(s,c),s.addEventListener("touchstart",function(n){var a=m(n.changedTouches[0],s);c(0,a[0],a[1]),c(1,a[0],a[1]),n.preventDefault()},!!e&&{passive:!1}),s.addEventListener("touchmove",function(n){n.preventDefault();var a=m(n.changedTouches[0],s);c(1,a[0],a[1]),n.preventDefault()},!!e&&{passive:!1}),s.addEventListener("touchend",function(n){c(0,o.lastPos[0],o.lastPos[1]),n.preventDefault()},!!e&&{passive:!1}),o.wheelListener=d(s,function(n,a){if(!u.scrollZoom)return!1;var g=u.calcDataBox(),h=l.viewBox,y=o.lastPos[0],v=o.lastPos[1],_=Math.exp(5*a/(h[3]-h[1])),x=y/(h[2]-h[0])*(g[2]-g[0])+g[0],T=v/(h[3]-h[1])*(g[3]-g[1])+g[1];return g[0]=(g[0]-x)*_+x,g[2]=(g[2]-x)*_+x,g[1]=(g[1]-T)*_+T,g[3]=(g[3]-T)*_+T,u.setRanges(g),o.lastInputTime=Date.now(),i(),u.cameraChanged(),u.handleAnnotations(),u.relayoutCallback(),!0},!0),o}},{"../cartesian/constants":845,"has-passive-events":436,"mouse-change":459,"mouse-event-offset":460,"mouse-wheel":462}],877:[function(r,O,B){var t=r("../cartesian/axes"),d=r("../../lib/str2rgbarray");function m(f){this.scene=f,this.gl=f.gl,this.pixelRatio=f.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var p=m.prototype,e=["xaxis","yaxis"];p.merge=function(f){var u,s,l,o,i,c,n,a,g,h,y;for(this.titleEnable=!1,this.backgroundColor=d(f.plot_bgcolor),h=0;h<2;++h){var v=(u=e[h]).charAt(0);for(l=(s=f[this.scene[u]._name]).title.text===this.scene.fullLayout._dfltTitle[v]?"":s.title.text,y=0;y<=2;y+=2)this.labelEnable[h+y]=!1,this.labels[h+y]=l,this.labelColor[h+y]=d(s.title.font.color),this.labelFont[h+y]=s.title.font.family,this.labelSize[h+y]=s.title.font.size,this.labelPad[h+y]=this.getLabelPad(u,s),this.tickEnable[h+y]=!1,this.tickColor[h+y]=d((s.tickfont||{}).color),this.tickAngle[h+y]=s.tickangle==="auto"?0:Math.PI*-s.tickangle/180,this.tickPad[h+y]=this.getTickPad(s),this.tickMarkLength[h+y]=0,this.tickMarkWidth[h+y]=s.tickwidth||0,this.tickMarkColor[h+y]=d(s.tickcolor),this.borderLineEnable[h+y]=!1,this.borderLineColor[h+y]=d(s.linecolor),this.borderLineWidth[h+y]=s.linewidth||0;n=this.hasSharedAxis(s),i=this.hasAxisInDfltPos(u,s)&&!n,c=this.hasAxisInAltrPos(u,s)&&!n,o=s.mirror||!1,a=n?String(o).indexOf("all")!==-1:!!o,g=n?o==="allticks":String(o).indexOf("ticks")!==-1,i?this.labelEnable[h]=!0:c&&(this.labelEnable[h+2]=!0),i?this.tickEnable[h]=s.showticklabels:c&&(this.tickEnable[h+2]=s.showticklabels),(i||a)&&(this.borderLineEnable[h]=s.showline),(c||a)&&(this.borderLineEnable[h+2]=s.showline),(i||g)&&(this.tickMarkLength[h]=this.getTickMarkLength(s)),(c||g)&&(this.tickMarkLength[h+2]=this.getTickMarkLength(s)),this.gridLineEnable[h]=s.showgrid,this.gridLineColor[h]=d(s.gridcolor),this.gridLineWidth[h]=s.gridwidth,this.zeroLineEnable[h]=s.zeroline,this.zeroLineColor[h]=d(s.zerolinecolor),this.zeroLineWidth[h]=s.zerolinewidth}},p.hasSharedAxis=function(f){var u=this.scene,s=u.fullLayout._subplots.gl2d;return t.findSubplotsWithAxis(s,f).indexOf(u.id)!==0},p.hasAxisInDfltPos=function(f,u){var s=u.side;return f==="xaxis"?s==="bottom":f==="yaxis"?s==="left":void 0},p.hasAxisInAltrPos=function(f,u){var s=u.side;return f==="xaxis"?s==="top":f==="yaxis"?s==="right":void 0},p.getLabelPad=function(f,u){var s=u.title.font.size,l=u.showticklabels;return f==="xaxis"?u.side==="top"?s*(1.5+(l?1:0))-10:s*(1.5+(l?.5:0))-10:f==="yaxis"?u.side==="right"?10+s*(1.5+(l?1:.5)):10+s*(1.5+(l?.5:0)):void 0},p.getTickPad=function(f){return f.ticks==="outside"?10+f.ticklen:15},p.getTickMarkLength=function(f){if(!f.ticks)return 0;var u=f.ticklen;return f.ticks==="inside"?-u:u},O.exports=function(f){return new m(f)}},{"../../lib/str2rgbarray":812,"../cartesian/axes":838}],878:[function(r,O,B){var t=r("../../plot_api/edit_types").overrideAll,d=r("./scene2d"),m=r("../layout_attributes"),p=r("../../constants/xmlns_namespaces"),e=r("../cartesian/constants"),f=r("../cartesian"),u=r("../../components/fx/layout_attributes"),s=r("../get_data").getSubplotData;B.name="gl2d",B.attr=["xaxis","yaxis"],B.idRoot=["x","y"],B.idRegex=e.idRegex,B.attrRegex=e.attrRegex,B.attributes=r("../cartesian/attributes"),B.supplyLayoutDefaults=function(l,o,i){o._has("cartesian")||f.supplyLayoutDefaults(l,o,i)},B.layoutAttrOverrides=t(f.layoutAttributes,"plot","from-root"),B.baseLayoutAttrOverrides=t({plot_bgcolor:m.plot_bgcolor,hoverlabel:u.hoverlabel},"plot","nested"),B.plot=function(l){for(var o=l._fullLayout,i=l._fullData,c=o._subplots.gl2d,n=0;n<c.length;n++){var a=c[n],g=o._plots[a],h=s(i,"gl2d",a),y=g._scene2d;y===void 0&&(y=new d({id:a,graphDiv:l,container:l.querySelector(".gl-container"),staticPlot:l._context.staticPlot,plotGlPixelRatio:l._context.plotGlPixelRatio},o),g._scene2d=y),y.plot(h,l.calcdata,o,l.layout)}},B.clean=function(l,o,i,c){for(var n=c._subplots.gl2d||[],a=0;a<n.length;a++){var g=n[a],h=c._plots[g];if(h._scene2d){var y=s(l,"gl2d",g);y.length===0&&(h._scene2d.destroy(),delete c._plots[g])}}f.clean.apply(this,arguments)},B.drawFramework=function(l){l._context.staticPlot||f.drawFramework(l)},B.toSVG=function(l){for(var o=l._fullLayout,i=o._subplots.gl2d,c=0;c<i.length;c++){var n=o._plots[i[c]]._scene2d,a=n.toImage("png");o._glimages.append("svg:image").attr({xmlns:p.svg,"xlink:href":a,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),n.destroy()}},B.updateFx=function(l){for(var o=l._fullLayout,i=o._subplots.gl2d,c=0;c<i.length;c++)o._plots[i[c]]._scene2d.updateFx(o.dragmode)}},{"../../components/fx/layout_attributes":691,"../../constants/xmlns_namespaces":764,"../../plot_api/edit_types":820,"../cartesian":852,"../cartesian/attributes":836,"../cartesian/constants":845,"../get_data":875,"../layout_attributes":892,"./scene2d":879}],879:[function(r,O,B){var t,d,m=r("../../registry"),p=r("../../plots/cartesian/axes"),e=r("../../components/fx"),f=r("gl-plot2d"),u=r("gl-spikes2d"),s=r("gl-select-box"),l=r("webgl-context"),o=r("./convert"),i=r("./camera"),c=r("../../lib/show_no_webgl_msg"),n=r("../cartesian/constraints"),a=n.enforce,g=n.clean,h=r("../cartesian/autorange").doAutoRange,y=r("../../components/dragelement/helpers"),v=y.drawMode,_=y.selectMode,x=["xaxis","yaxis"],T=r("../cartesian/constants").SUBPLOT_PATTERN;function A(w,C){this.container=w.container,this.graphDiv=w.graphDiv,this.pixelRatio=w.plotGlPixelRatio||window.devicePixelRatio,this.id=w.id,this.staticPlot=!!w.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(C),this.makeFramework(),this.stopped||(this.glplotOptions=o(this),this.glplotOptions.merge(C),this.glplot=f(this.glplotOptions),this.camera=i(this),this.traces={},this.spikes=u(this.glplot),this.selectBox=s(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}O.exports=A;var S=A.prototype;S.makeFramework=function(){if(this.staticPlot){if(!(d||(t=document.createElement("canvas"),d=l({canvas:t,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}))))throw new Error("Error creating static canvas/context for image server");this.canvas=t,this.gl=d}else{var w=this.container.querySelector(".gl-canvas-focus"),C=l({canvas:w,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!C)return c(this),void(this.stopped=!0);this.canvas=w,this.gl=C}var k=this.canvas;k.style.width="100%",k.style.height="100%",k.style.position="absolute",k.style.top="0px",k.style.left="0px",k.style["pointer-events"]="none",this.updateSize(k);var L=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");L.style.position="absolute",L.style.top=L.style.left="0px",L.style.width=L.style.height="100%",L.style["z-index"]=20,L.style["pointer-events"]="none";var M=this.mouseContainer=document.createElement("div");M.style.position="absolute",M.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var P=this.container;P.appendChild(L),P.appendChild(M);var D=this;M.addEventListener("mouseout",function(){D.isMouseOver=!1,D.unhover()}),M.addEventListener("mouseover",function(){D.isMouseOver=!0})},S.toImage=function(w){w||(w="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(t),this.updateSize(this.canvas);var C=this.glplot.gl,k=C.drawingBufferWidth,L=C.drawingBufferHeight;C.clearColor(1,1,1,0),C.clear(C.COLOR_BUFFER_BIT|C.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),C.bindFramebuffer(C.FRAMEBUFFER,null);var M=new Uint8Array(k*L*4);C.readPixels(0,0,k,L,C.RGBA,C.UNSIGNED_BYTE,M);for(var P=0,D=L-1;P<D;++P,--D)for(var N=0;N<k;++N)for(var U=0;U<4;++U){var q=M[4*(k*P+N)+U];M[4*(k*P+N)+U]=M[4*(k*D+N)+U],M[4*(k*D+N)+U]=q}var X=document.createElement("canvas");X.width=k,X.height=L;var K,Z=X.getContext("2d"),H=Z.createImageData(k,L);switch(H.data.set(M),Z.putImageData(H,0,0),w){case"jpeg":K=X.toDataURL("image/jpeg");break;case"webp":K=X.toDataURL("image/webp");break;default:K=X.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(t),K},S.updateSize=function(w){w||(w=this.canvas);var C=this.pixelRatio,k=this.fullLayout,L=k.width,M=k.height,P=0|Math.ceil(C*L),D=0|Math.ceil(C*M);return w.width===P&&w.height===D||(w.width=P,w.height=D),w},S.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var w=[p.calcTicks(this.xaxis),p.calcTicks(this.yaxis)],C=0;C<2;++C)for(var k=0;k<w[C].length;++k)w[C][k].text=w[C][k].text+"";return w},S.updateRefs=function(w){this.fullLayout=w;var C=this.id.match(T),k="xaxis"+C[1],L="yaxis"+C[2];this.xaxis=this.fullLayout[k],this.yaxis=this.fullLayout[L]},S.relayoutCallback=function(){var w=this.graphDiv,C=this.xaxis,k=this.yaxis,L=w.layout,M={},P=M[C._name+".range"]=C.range.slice(),D=M[k._name+".range"]=k.range.slice();M[C._name+".autorange"]=C.autorange,M[k._name+".autorange"]=k.autorange,m.call("_storeDirectGUIEdit",w.layout,w._fullLayout._preGUI,M);var N=L[C._name];N.range=P,N.autorange=C.autorange;var U=L[k._name];U.range=D,U.autorange=k.autorange,M.lastInputTime=this.camera.lastInputTime,w.emit("plotly_relayout",M)},S.cameraChanged=function(){var w=this.camera;this.glplot.setDataBox(this.calcDataBox());var C=this.computeTickMarks();(function(k,L){for(var M=0;M<2;++M){var P=k[M],D=L[M];if(P.length!==D.length)return!0;for(var N=0;N<P.length;++N)if(P[N].x!==D[N].x)return!0}return!1})(C,this.glplotOptions.ticks)&&(this.glplotOptions.ticks=C,this.glplotOptions.dataBox=w.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},S.handleAnnotations=function(){for(var w=this.graphDiv,C=this.fullLayout.annotations,k=0;k<C.length;k++){var L=C[k];L.xref===this.xaxis._id&&L.yref===this.yaxis._id&&m.getComponentMethod("annotations","drawOne")(w,k)}},S.destroy=function(){if(this.glplot){var w=this.traces;w&&Object.keys(w).map(function(C){w[C].dispose(),delete w[C]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},S.plot=function(w,C,k){var L=this.glplot;this.updateRefs(k),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(w,C),this.updateFx(k.dragmode);var M=k.width,P=k.height;this.updateSize(this.canvas);var D=this.glplotOptions;D.merge(k),D.screenBox=[0,0,M,P];var N={_fullLayout:{_axisConstraintGroups:k._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:k._size}};g(N,this.xaxis),g(N,this.yaxis);var U,q,X=k._size,K=this.xaxis.domain,Z=this.yaxis.domain;for(D.viewBox=[X.l+K[0]*X.w,X.b+Z[0]*X.h,M-X.r-(1-K[1])*X.w,P-X.t-(1-Z[1])*X.h],this.mouseContainer.style.width=X.w*(K[1]-K[0])+"px",this.mouseContainer.style.height=X.h*(Z[1]-Z[0])+"px",this.mouseContainer.height=X.h*(Z[1]-Z[0]),this.mouseContainer.style.left=X.l+K[0]*X.w+"px",this.mouseContainer.style.top=X.t+(1-Z[1])*X.h+"px",q=0;q<2;++q)(U=this[x[q]])._length=D.viewBox[q+2]-D.viewBox[q],h(this.graphDiv,U),U.setScale();a(N),D.ticks=this.computeTickMarks(),D.dataBox=this.calcDataBox(),D.merge(k),L.update(D),this.glplot.draw()},S.calcDataBox=function(){var w=this.xaxis,C=this.yaxis,k=w.range,L=C.range,M=w.r2l,P=C.r2l;return[M(k[0]),P(L[0]),M(k[1]),P(L[1])]},S.setRanges=function(w){var C=this.xaxis,k=this.yaxis,L=C.l2r,M=k.l2r;C.range=[L(w[0]),L(w[2])],k.range=[M(w[1]),M(w[3])]},S.updateTraces=function(w,C){var k,L,M,P=Object.keys(this.traces);this.fullData=w;e:for(k=0;k<P.length;k++){var D=P[k],N=this.traces[D];for(L=0;L<w.length;L++)if((M=w[L]).uid===D&&M.type===N.type)continue e;N.dispose(),delete this.traces[D]}for(k=0;k<w.length;k++){M=w[k];var U=C[k],q=this.traces[M.uid];q?q.update(M,U):(q=M._module.plot(this,M,U),this.traces[M.uid]=q)}this.glplot.objects.sort(function(X,K){return X._trace.index-K._trace.index})},S.updateFx=function(w){_(w)||v(w)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor=w==="pan"?"move":w==="zoom"?"crosshair":null},S.emitPointAction=function(w,C){for(var k,L=w.trace.uid,M=w.pointIndex,P=0;P<this.fullData.length;P++)this.fullData[P].uid===L&&(k=this.fullData[P]);var D={x:w.traceCoord[0],y:w.traceCoord[1],curveNumber:k.index,pointNumber:M,data:k._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};e.appendArrayPointValue(D,k,M),this.graphDiv.emit(C,{points:[D]})},S.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var w=this.glplot,C=this.camera,k=C.mouseListener,L=this.lastButtonState===1&&k.buttons===0,M=this.fullLayout;this.lastButtonState=k.buttons,this.cameraChanged();var P,D=k.x*w.pixelRatio,N=this.canvas.height-w.pixelRatio*k.y;if(C.boxEnabled&&M.dragmode==="zoom"){this.selectBox.enabled=!0;for(var U=this.selectBox.selectBox=[Math.min(C.boxStart[0],C.boxEnd[0]),Math.min(C.boxStart[1],C.boxEnd[1]),Math.max(C.boxStart[0],C.boxEnd[0]),Math.max(C.boxStart[1],C.boxEnd[1])],q=0;q<2;q++)C.boxStart[q]===C.boxEnd[q]&&(U[q]=w.dataBox[q],U[q+2]=w.dataBox[q+2]);w.setDirty()}else if(!C.panning&&this.isMouseOver){this.selectBox.enabled=!1;var X=M._size,K=this.xaxis.domain,Z=this.yaxis.domain,H=(P=w.pick(D/w.pixelRatio+X.l+K[0]*X.w,N/w.pixelRatio-(X.t+(1-Z[1])*X.h)))&&P.object._trace.handlePick(P);if(H&&L&&this.emitPointAction(H,"plotly_click"),P&&P.object._trace.hoverinfo!=="skip"&&M.hovermode&&H&&(!this.lastPickResult||this.lastPickResult.traceUid!==H.trace.uid||this.lastPickResult.dataCoord[0]!==H.dataCoord[0]||this.lastPickResult.dataCoord[1]!==H.dataCoord[1])){var Y=H;this.lastPickResult={traceUid:H.trace?H.trace.uid:null,dataCoord:H.dataCoord.slice()},this.spikes.update({center:P.dataCoord}),Y.screenCoord=[((w.viewBox[2]-w.viewBox[0])*(P.dataCoord[0]-w.dataBox[0])/(w.dataBox[2]-w.dataBox[0])+w.viewBox[0])/w.pixelRatio,(this.canvas.height-(w.viewBox[3]-w.viewBox[1])*(P.dataCoord[1]-w.dataBox[1])/(w.dataBox[3]-w.dataBox[1])-w.viewBox[1])/w.pixelRatio],this.emitPointAction(H,"plotly_hover");var $=this.fullData[Y.trace.index]||{},z=Y.pointIndex,j=e.castHoverinfo($,M,z);if(j&&j!=="all"){var W=j.split("+");W.indexOf("x")===-1&&(Y.traceCoord[0]=void 0),W.indexOf("y")===-1&&(Y.traceCoord[1]=void 0),W.indexOf("z")===-1&&(Y.traceCoord[2]=void 0),W.indexOf("text")===-1&&(Y.textLabel=void 0),W.indexOf("name")===-1&&(Y.name=void 0)}e.loneHover({x:Y.screenCoord[0],y:Y.screenCoord[1],xLabel:this.hoverFormatter("xaxis",Y.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",Y.traceCoord[1]),zLabel:Y.traceCoord[2],text:Y.textLabel,name:Y.name,color:e.castHoverOption($,z,"bgcolor")||Y.color,borderColor:e.castHoverOption($,z,"bordercolor"),fontFamily:e.castHoverOption($,z,"font.family"),fontSize:e.castHoverOption($,z,"font.size"),fontColor:e.castHoverOption($,z,"font.color"),nameLength:e.castHoverOption($,z,"namelength"),textAlign:e.castHoverOption($,z,"align")},{container:this.svgContainer,gd:this.graphDiv})}}P||this.unhover(),w.draw()}},S.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),e.loneUnhover(this.svgContainer))},S.hoverFormatter=function(w,C){if(C!==void 0){var k=this[w];return p.tickText(k,k.c2l(C),"hover").text}}},{"../../components/dragelement/helpers":668,"../../components/fx":690,"../../lib/show_no_webgl_msg":809,"../../plots/cartesian/axes":838,"../../registry":915,"../cartesian/autorange":837,"../cartesian/constants":845,"../cartesian/constraints":846,"./camera":876,"./convert":877,"gl-plot2d":316,"gl-select-box":330,"gl-spikes2d":339,"webgl-context":613}],880:[function(r,O,B){var t=r("../../plot_api/edit_types").overrideAll,d=r("../../components/fx/layout_attributes"),m=r("./scene"),p=r("../get_data").getSubplotData,e=r("../../lib"),f=r("../../constants/xmlns_namespaces");B.name="gl3d",B.attr="scene",B.idRoot="scene",B.idRegex=B.attrRegex=e.counterRegex("scene"),B.attributes=r("./layout/attributes"),B.layoutAttributes=r("./layout/layout_attributes"),B.baseLayoutAttrOverrides=t({hoverlabel:d.hoverlabel},"plot","nested"),B.supplyLayoutDefaults=r("./layout/defaults"),B.plot=function(u){for(var s=u._fullLayout,l=u._fullData,o=s._subplots.gl3d,i=0;i<o.length;i++){var c=o[i],n=p(l,"gl3d",c),a=s[c],g=a.camera,h=a._scene;h||(h=new m({id:c,graphDiv:u,container:u.querySelector(".gl-container"),staticPlot:u._context.staticPlot,plotGlPixelRatio:u._context.plotGlPixelRatio,camera:g},s),a._scene=h),h.viewInitial||(h.viewInitial={up:{x:g.up.x,y:g.up.y,z:g.up.z},eye:{x:g.eye.x,y:g.eye.y,z:g.eye.z},center:{x:g.center.x,y:g.center.y,z:g.center.z}}),h.plot(n,s,u.layout)}},B.clean=function(u,s,l,o){for(var i=o._subplots.gl3d||[],c=0;c<i.length;c++){var n=i[c];!s[n]&&o[n]._scene&&(o[n]._scene.destroy(),o._infolayer&&o._infolayer.selectAll(".annotation-"+n).remove())}},B.toSVG=function(u){for(var s=u._fullLayout,l=s._subplots.gl3d,o=s._size,i=0;i<l.length;i++){var c=s[l[i]],n=c.domain,a=c._scene,g=a.toImage("png");s._glimages.append("svg:image").attr({xmlns:f.svg,"xlink:href":g,x:o.l+o.w*n.x[0],y:o.t+o.h*(1-n.y[1]),width:o.w*(n.x[1]-n.x[0]),height:o.h*(n.y[1]-n.y[0]),preserveAspectRatio:"none"}),a.destroy()}},B.cleanId=function(u){if(u.match(/^scene[0-9]*$/)){var s=u.substr(5);return s==="1"&&(s=""),"scene"+s}},B.updateFx=function(u){for(var s=u._fullLayout,l=s._subplots.gl3d,o=0;o<l.length;o++)s[l[o]]._scene.updateFx(s.dragmode,s.hovermode)}},{"../../components/fx/layout_attributes":691,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../plot_api/edit_types":820,"../get_data":875,"./layout/attributes":881,"./layout/defaults":885,"./layout/layout_attributes":886,"./scene":890}],881:[function(r,O,B){O.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],882:[function(r,O,B){var t=r("../../../components/color"),d=r("../../cartesian/layout_attributes"),m=r("../../../lib/extend").extendFlat,p=r("../../../plot_api/edit_types").overrideAll;O.exports=p({visible:d.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:t.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:d.color,categoryorder:d.categoryorder,categoryarray:d.categoryarray,title:{text:d.title.text,font:d.title.font},type:m({},d.type,{values:["-","linear","log","date","category"]}),autotypenumbers:d.autotypenumbers,autorange:d.autorange,rangemode:d.rangemode,range:m({},d.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:d.tickmode,nticks:d.nticks,tick0:d.tick0,dtick:d.dtick,tickvals:d.tickvals,ticktext:d.ticktext,ticks:d.ticks,mirror:d.mirror,ticklen:d.ticklen,tickwidth:d.tickwidth,tickcolor:d.tickcolor,showticklabels:d.showticklabels,tickfont:d.tickfont,tickangle:d.tickangle,tickprefix:d.tickprefix,showtickprefix:d.showtickprefix,ticksuffix:d.ticksuffix,showticksuffix:d.showticksuffix,showexponent:d.showexponent,exponentformat:d.exponentformat,minexponent:d.minexponent,separatethousands:d.separatethousands,tickformat:d.tickformat,tickformatstops:d.tickformatstops,hoverformat:d.hoverformat,showline:d.showline,linecolor:d.linecolor,linewidth:d.linewidth,showgrid:d.showgrid,gridcolor:m({},d.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:d.gridwidth,zeroline:d.zeroline,zerolinecolor:d.zerolinecolor,zerolinewidth:d.zerolinewidth,_deprecated:{title:d._deprecated.title,titlefont:d._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":650,"../../../lib/extend":777,"../../../plot_api/edit_types":820,"../../cartesian/layout_attributes":853}],883:[function(r,O,B){var t=r("tinycolor2").mix,d=r("../../../lib"),m=r("../../../plot_api/plot_template"),p=r("./axis_attributes"),e=r("../../cartesian/type_defaults"),f=r("../../cartesian/axis_defaults"),u=["xaxis","yaxis","zaxis"];O.exports=function(s,l,o){var i,c;function n(h,y){return d.coerce(i,c,p,h,y)}for(var a=0;a<u.length;a++){var g=u[a];i=s[g]||{},(c=m.newContainer(l,g))._id=g[0]+o.scene,c._name=g,e(i,c,n,o),f(i,c,n,{font:o.font,letter:g[0],data:o.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:o.bgColor,calendar:o.calendar},o.fullLayout),n("gridcolor",t(c.color,o.bgColor,13600/187).toRgbString()),n("title.text",g[0]),c.setScale=d.noop,n("showspikes")&&(n("spikesides"),n("spikethickness"),n("spikecolor",c.color)),n("showaxeslabels"),n("showbackground")&&n("backgroundcolor")}}},{"../../../lib":787,"../../../plot_api/plot_template":827,"../../cartesian/axis_defaults":840,"../../cartesian/type_defaults":864,"./axis_attributes":882,tinycolor2:583}],884:[function(r,O,B){var t=r("../../../lib/str2rgbarray"),d=r("../../../lib"),m=["xaxis","yaxis","zaxis"];function p(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}p.prototype.merge=function(e,f){for(var u=0;u<3;++u){var s=f[m[u]];s.visible?(this.labels[u]=e._meta?d.templateString(s.title.text,e._meta):s.title.text,"font"in s.title&&(s.title.font.color&&(this.labelColor[u]=t(s.title.font.color)),s.title.font.family&&(this.labelFont[u]=s.title.font.family),s.title.font.size&&(this.labelSize[u]=s.title.font.size)),"showline"in s&&(this.lineEnable[u]=s.showline),"linecolor"in s&&(this.lineColor[u]=t(s.linecolor)),"linewidth"in s&&(this.lineWidth[u]=s.linewidth),"showgrid"in s&&(this.gridEnable[u]=s.showgrid),"gridcolor"in s&&(this.gridColor[u]=t(s.gridcolor)),"gridwidth"in s&&(this.gridWidth[u]=s.gridwidth),s.type==="log"?this.zeroEnable[u]=!1:"zeroline"in s&&(this.zeroEnable[u]=s.zeroline),"zerolinecolor"in s&&(this.zeroLineColor[u]=t(s.zerolinecolor)),"zerolinewidth"in s&&(this.zeroLineWidth[u]=s.zerolinewidth),"ticks"in s&&s.ticks?this.lineTickEnable[u]=!0:this.lineTickEnable[u]=!1,"ticklen"in s&&(this.lineTickLength[u]=this._defaultLineTickLength[u]=s.ticklen),"tickcolor"in s&&(this.lineTickColor[u]=t(s.tickcolor)),"tickwidth"in s&&(this.lineTickWidth[u]=s.tickwidth),"tickangle"in s&&(this.tickAngle[u]=s.tickangle==="auto"?-3600:Math.PI*-s.tickangle/180),"showticklabels"in s&&(this.tickEnable[u]=s.showticklabels),"tickfont"in s&&(s.tickfont.color&&(this.tickColor[u]=t(s.tickfont.color)),s.tickfont.family&&(this.tickFont[u]=s.tickfont.family),s.tickfont.size&&(this.tickSize[u]=s.tickfont.size)),"mirror"in s?["ticks","all","allticks"].indexOf(s.mirror)!==-1?(this.lineTickMirror[u]=!0,this.lineMirror[u]=!0):s.mirror===!0?(this.lineTickMirror[u]=!1,this.lineMirror[u]=!0):(this.lineTickMirror[u]=!1,this.lineMirror[u]=!1):this.lineMirror[u]=!1,"showbackground"in s&&s.showbackground!==!1?(this.backgroundEnable[u]=!0,this.backgroundColor[u]=t(s.backgroundcolor)):this.backgroundEnable[u]=!1):(this.tickEnable[u]=!1,this.labelEnable[u]=!1,this.lineEnable[u]=!1,this.lineTickEnable[u]=!1,this.gridEnable[u]=!1,this.zeroEnable[u]=!1,this.backgroundEnable[u]=!1)}},O.exports=function(e,f){var u=new p;return u.merge(e,f),u}},{"../../../lib":787,"../../../lib/str2rgbarray":812}],885:[function(r,O,B){var t=r("../../../lib"),d=r("../../../components/color"),m=r("../../../registry"),p=r("../../subplot_defaults"),e=r("./axis_defaults"),f=r("./layout_attributes"),u=r("../../get_data").getSubplotData;function s(l,o,i,c){for(var n=i("bgcolor"),a=d.combine(n,c.paper_bgcolor),g=["up","center","eye"],h=0;h<g.length;h++)i("camera."+g[h]+".x"),i("camera."+g[h]+".y"),i("camera."+g[h]+".z");i("camera.projection.type");var y=!!i("aspectratio.x")&&!!i("aspectratio.y")&&!!i("aspectratio.z"),v=i("aspectmode",y?"manual":"auto");y||(l.aspectratio=o.aspectratio={x:1,y:1,z:1},v==="manual"&&(o.aspectmode="auto"),l.aspectmode=o.aspectmode);var _=u(c.fullData,"gl3d",c.id);e(l,o,{font:c.font,scene:c.id,data:_,bgColor:a,calendar:c.calendar,autotypenumbersDflt:c.autotypenumbersDflt,fullLayout:c.fullLayout}),m.getComponentMethod("annotations3d","handleDefaults")(l,o,c);var x=c.getDfltFromLayout("dragmode");if(x!==!1&&!x)if(x="orbit",l.camera&&l.camera.up){var T=l.camera.up.x,A=l.camera.up.y,S=l.camera.up.z;S!==0&&(T&&A&&S?S/Math.sqrt(T*T+A*A+S*S)>.999&&(x="turntable"):x="turntable")}else x="turntable";i("dragmode",x),i("hovermode",c.getDfltFromLayout("hovermode"))}O.exports=function(l,o,i){var c=o._basePlotModules.length>1;p(l,o,i,{type:"gl3d",attributes:f,handleDefaults:s,fullLayout:o,font:o.font,fullData:i,getDfltFromLayout:function(n){if(!c)return t.validate(l[n],f[n])?l[n]:void 0},autotypenumbersDflt:o.autotypenumbers,paper_bgcolor:o.paper_bgcolor,calendar:o.calendar})}},{"../../../components/color":650,"../../../lib":787,"../../../registry":915,"../../get_data":875,"../../subplot_defaults":909,"./axis_defaults":883,"./layout_attributes":886}],886:[function(r,O,B){var t=r("./axis_attributes"),d=r("../../domain").attributes,m=r("../../../lib/extend").extendFlat,p=r("../../../lib").counterRegex;function e(f,u,s){return{x:{valType:"number",dflt:f,editType:"camera"},y:{valType:"number",dflt:u,editType:"camera"},z:{valType:"number",dflt:s,editType:"camera"},editType:"camera"}}O.exports={_arrayAttrRegexps:[p("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:m(e(0,0,1),{}),center:m(e(0,0,0),{}),eye:m(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:d({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:t,yaxis:t,zaxis:t,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":787,"../../../lib/extend":777,"../../domain":866,"./axis_attributes":882}],887:[function(r,O,B){var t=r("../../../lib/str2rgbarray"),d=["xaxis","yaxis","zaxis"];function m(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}m.prototype.merge=function(p){for(var e=0;e<3;++e){var f=p[d[e]];f.visible?(this.enabled[e]=f.showspikes,this.colors[e]=t(f.spikecolor),this.drawSides[e]=f.spikesides,this.lineWidth[e]=f.spikethickness):(this.enabled[e]=!1,this.drawSides[e]=!1)}},O.exports=function(p){var e=new m;return e.merge(p),e}},{"../../../lib/str2rgbarray":812}],888:[function(r,O,B){O.exports=function(e){for(var f=e.axesOptions,u=e.glplot.axesPixels,s=e.fullSceneLayout,l=[[],[],[]],o=0;o<3;++o){var i=s[m[o]];if(i._length=(u[o].hi-u[o].lo)*u[o].pixelsPerDataUnit/e.dataScale[o],Math.abs(i._length)===1/0||isNaN(i._length))l[o]=[];else{i._input_range=i.range.slice(),i.range[0]=u[o].lo/e.dataScale[o],i.range[1]=u[o].hi/e.dataScale[o],i._m=1/(e.dataScale[o]*u[o].pixelsPerDataUnit),i.range[0]===i.range[1]&&(i.range[0]-=1,i.range[1]+=1);var c=i.tickmode;if(i.tickmode==="auto"){i.tickmode="linear";var n=i.nticks||d.constrain(i._length/40,4,9);t.autoTicks(i,Math.abs(i.range[1]-i.range[0])/n)}for(var a=t.calcTicks(i,{msUTC:!0}),g=0;g<a.length;++g)a[g].x=a[g].x*e.dataScale[o],i.type==="date"&&(a[g].text=a[g].text.replace(/\<br\>/g," "));l[o]=a,i.tickmode=c}}for(f.ticks=l,o=0;o<3;++o)for(p[o]=.5*(e.glplot.bounds[0][o]+e.glplot.bounds[1][o]),g=0;g<2;++g)f.bounds[g][o]=e.glplot.bounds[g][o];e.contourLevels=function(h){for(var y=new Array(3),v=0;v<3;++v){for(var _=h[v],x=new Array(_.length),T=0;T<_.length;++T)x[T]=_[T].x;y[v]=x}return y}(l)};var t=r("../../cartesian/axes"),d=r("../../../lib"),m=["xaxis","yaxis","zaxis"],p=[0,0,0]},{"../../../lib":787,"../../cartesian/axes":838}],889:[function(r,O,B){function t(d,m){var p,e,f=[0,0,0,0];for(p=0;p<4;++p)for(e=0;e<4;++e)f[e]+=d[4*p+e]*m[p];return f}O.exports=function(d,m){return t(d.projection,t(d.view,t(d.model,[m[0],m[1],m[2],1])))}},{}],890:[function(r,O,B){var t,d,m=r("gl-plot3d"),p=m.createCamera,e=m.createScene,f=r("webgl-context"),u=r("has-passive-events"),s=r("../../registry"),l=r("../../lib"),o=l.preserveDrawingBuffer(),i=r("../../plots/cartesian/axes"),c=r("../../components/fx"),n=r("../../lib/str2rgbarray"),a=r("../../lib/show_no_webgl_msg"),g=r("./project"),h=r("./layout/convert"),y=r("./layout/spikes"),v=r("./layout/tick_marks");function _(w,C){var k=document.createElement("div"),L=w.container;this.graphDiv=w.graphDiv;var M=document.createElementNS("http://www.w3.org/2000/svg","svg");M.style.position="absolute",M.style.top=M.style.left="0px",M.style.width=M.style.height="100%",M.style["z-index"]=20,M.style["pointer-events"]="none",k.appendChild(M),this.svgContainer=M,k.id=w.id,k.style.position="absolute",k.style.top=k.style.left="0px",k.style.width=k.style.height="100%",L.appendChild(k),this.fullLayout=C,this.id=w.id||"scene",this.fullSceneLayout=C[this.id],this.plotArgs=[[],{},{}],this.axesOptions=h(C,C[this.id]),this.spikeOptions=y(C[this.id]),this.container=k,this.staticMode=!!w.staticPlot,this.pixelRatio=this.pixelRatio||w.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=s.getComponentMethod("annotations3d","convert"),this.drawAnnotations=s.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var x=_.prototype;x.prepareOptions=function(){var w={canvas:this.canvas,gl:this.gl,glOptions:{preserveDrawingBuffer:o,premultipliedAlpha:!0,antialias:!0},container:this.container,axes:this.axesOptions,spikes:this.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:this.camera,pixelRatio:this.pixelRatio};if(this.staticMode){if(!(d||(t=document.createElement("canvas"),d=f({canvas:t,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}))))throw new Error("error creating static canvas/context for image server");w.gl=d,w.canvas=t}return w};var T=!0;x.tryCreatePlot=function(){var w=this.prepareOptions(),C=!0;try{this.glplot=e(w)}catch(k){if(this.staticMode||!T||o)C=!1;else{l.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{o=w.glOptions.preserveDrawingBuffer=!0,this.glplot=e(w)}catch(L){o=w.glOptions.preserveDrawingBuffer=!1,C=!1}}}return T=!1,C},x.initializeGLCamera=function(){var w=this.fullSceneLayout.camera,C=w.projection.type==="orthographic";this.camera=p(this.container,{center:[w.center.x,w.center.y,w.center.z],eye:[w.eye.x,w.eye.y,w.eye.z],up:[w.up.x,w.up.y,w.up.z],_ortho:C,zoomMin:.01,zoomMax:100,mode:"orbit"})},x.initializeGLPlot=function(){var w=this;if(w.initializeGLCamera(),!w.tryCreatePlot())return a(w);w.traces={},w.make4thDimension();var C=w.graphDiv,k=C.layout,L=function(){var P={};return w.isCameraChanged(k)&&(P[w.id+".camera"]=w.getCamera()),w.isAspectChanged(k)&&(P[w.id+".aspectratio"]=w.glplot.getAspectratio(),k[w.id].aspectmode!=="manual"&&(w.fullSceneLayout.aspectmode=k[w.id].aspectmode=P[w.id+".aspectmode"]="manual")),P},M=function(P){if(P.fullSceneLayout.dragmode!==!1){var D=L();P.saveLayout(k),P.graphDiv.emit("plotly_relayout",D)}};return w.glplot.canvas&&(w.glplot.canvas.addEventListener("mouseup",function(){M(w)}),w.glplot.canvas.addEventListener("wheel",function(P){if(C._context._scrollZoom.gl3d){if(w.camera._ortho){var D=P.deltaX>P.deltaY?1.1:1/1.1,N=w.glplot.getAspectratio();w.glplot.setAspectratio({x:D*N.x,y:D*N.y,z:D*N.z})}M(w)}},!!u&&{passive:!1}),w.glplot.canvas.addEventListener("mousemove",function(){if(w.fullSceneLayout.dragmode!==!1&&w.camera.mouseListener.buttons!==0){var P=L();w.graphDiv.emit("plotly_relayouting",P)}}),w.staticMode||w.glplot.canvas.addEventListener("webglcontextlost",function(P){C&&C.emit&&C.emit("plotly_webglcontextlost",{event:P,layer:w.id})},!1)),w.glplot.oncontextloss=function(){w.recoverContext()},w.glplot.onrender=function(){w.render()},!0},x.render=function(){var w,C=this,k=C.graphDiv,L=C.svgContainer,M=C.container.getBoundingClientRect();k._fullLayout._calcInverseTransform(k);var P=k._fullLayout._invScaleX,D=k._fullLayout._invScaleY,N=M.width*P,U=M.height*D;L.setAttributeNS(null,"viewBox","0 0 "+N+" "+U),L.setAttributeNS(null,"width",N),L.setAttributeNS(null,"height",U),v(C),C.glplot.axes.update(C.axesOptions);for(var q,X=Object.keys(C.traces),K=null,Z=C.glplot.selection,H=0;H<X.length;++H)(w=C.traces[X[H]]).data.hoverinfo!=="skip"&&w.handlePick(Z)&&(K=w),w.setContourLevels&&w.setContourLevels();function Y(de,ue,ve){var ke=C.fullSceneLayout[de+"axis"];return ke.type!=="log"&&(ue=ke.d2l(ue)),i.hoverLabelText(ke,ue,ve)}if(K!==null){var $=g(C.glplot.cameraParams,Z.dataCoordinate);w=K.data;var z,j=k._fullData[w.index],W=Z.index,ee={xLabel:Y("x",Z.traceCoordinate[0],w.xhoverformat),yLabel:Y("y",Z.traceCoordinate[1],w.yhoverformat),zLabel:Y("z",Z.traceCoordinate[2],w.zhoverformat)},J=c.castHoverinfo(j,C.fullLayout,W),Q=(J||"").split("+"),te=J&&J==="all";j.hovertemplate||te||(Q.indexOf("x")===-1&&(ee.xLabel=void 0),Q.indexOf("y")===-1&&(ee.yLabel=void 0),Q.indexOf("z")===-1&&(ee.zLabel=void 0),Q.indexOf("text")===-1&&(Z.textLabel=void 0),Q.indexOf("name")===-1&&(K.name=void 0));var ie=[];w.type==="cone"||w.type==="streamtube"?(ee.uLabel=Y("x",Z.traceCoordinate[3],w.uhoverformat),(te||Q.indexOf("u")!==-1)&&ie.push("u: "+ee.uLabel),ee.vLabel=Y("y",Z.traceCoordinate[4],w.vhoverformat),(te||Q.indexOf("v")!==-1)&&ie.push("v: "+ee.vLabel),ee.wLabel=Y("z",Z.traceCoordinate[5],w.whoverformat),(te||Q.indexOf("w")!==-1)&&ie.push("w: "+ee.wLabel),ee.normLabel=Z.traceCoordinate[6].toPrecision(3),(te||Q.indexOf("norm")!==-1)&&ie.push("norm: "+ee.normLabel),w.type==="streamtube"&&(ee.divergenceLabel=Z.traceCoordinate[7].toPrecision(3),(te||Q.indexOf("divergence")!==-1)&&ie.push("divergence: "+ee.divergenceLabel)),Z.textLabel&&ie.push(Z.textLabel),z=ie.join("<br>")):w.type==="isosurface"||w.type==="volume"?(ee.valueLabel=i.hoverLabelText(C._mockAxis,C._mockAxis.d2l(Z.traceCoordinate[3]),w.valuehoverformat),ie.push("value: "+ee.valueLabel),Z.textLabel&&ie.push(Z.textLabel),z=ie.join("<br>")):z=Z.textLabel;var ae={x:Z.traceCoordinate[0],y:Z.traceCoordinate[1],z:Z.traceCoordinate[2],data:j._input,fullData:j,curveNumber:j.index,pointNumber:W};c.appendArrayPointValue(ae,j,W),w._module.eventData&&(ae=j._module.eventData(ae,Z,j,{},W));var he={points:[ae]};if(C.fullSceneLayout.hovermode){var se=[];c.loneHover({trace:j,x:(.5+.5*$[0]/$[3])*N,y:(.5-.5*$[1]/$[3])*U,xLabel:ee.xLabel,yLabel:ee.yLabel,zLabel:ee.zLabel,text:z,name:K.name,color:c.castHoverOption(j,W,"bgcolor")||K.color,borderColor:c.castHoverOption(j,W,"bordercolor"),fontFamily:c.castHoverOption(j,W,"font.family"),fontSize:c.castHoverOption(j,W,"font.size"),fontColor:c.castHoverOption(j,W,"font.color"),nameLength:c.castHoverOption(j,W,"namelength"),textAlign:c.castHoverOption(j,W,"align"),hovertemplate:l.castOption(j,W,"hovertemplate"),hovertemplateLabels:l.extendFlat({},ae,ee),eventData:[ae]},{container:L,gd:k,inOut_bbox:se}),ae.bbox=se[0]}Z.buttons&&Z.distance<5?k.emit("plotly_click",he):k.emit("plotly_hover",he),q=he}else c.loneUnhover(L),k.emit("plotly_unhover",q);C.drawAnnotations(C)},x.recoverContext=function(){var w=this;w.glplot.dispose();var C=function(){w.glplot.gl.isContextLost()?requestAnimationFrame(C):w.initializeGLPlot()?w.plot.apply(w,w.plotArgs):l.error("Catastrophic and unrecoverable WebGL error. Context lost.")};requestAnimationFrame(C)};var A=["xaxis","yaxis","zaxis"];function S(w,C,k){for(var L=w.fullSceneLayout,M=0;M<3;M++){var P=A[M],D=P.charAt(0),N=L[P],U=C[D],q=C[D+"calendar"],X=C["_"+D+"length"];if(l.isArrayOrTypedArray(U))for(var K,Z=0;Z<(X||U.length);Z++)if(l.isArrayOrTypedArray(U[Z]))for(var H=0;H<U[Z].length;++H)K=N.d2l(U[Z][H],0,q),!isNaN(K)&&isFinite(K)&&(k[0][M]=Math.min(k[0][M],K),k[1][M]=Math.max(k[1][M],K));else K=N.d2l(U[Z],0,q),!isNaN(K)&&isFinite(K)&&(k[0][M]=Math.min(k[0][M],K),k[1][M]=Math.max(k[1][M],K));else k[0][M]=Math.min(k[0][M],0),k[1][M]=Math.max(k[1][M],X-1)}}x.plot=function(w,C,k){if(this.plotArgs=[w,C,k],!this.glplot.contextLost){var L,M,P,D,N,U,q=C[this.id],X=k[this.id];this.fullLayout=C,this.fullSceneLayout=q,this.axesOptions.merge(C,q),this.spikeOptions.merge(q),this.setViewport(q),this.updateFx(q.dragmode,q.hovermode),this.camera.enableWheel=this.graphDiv._context._scrollZoom.gl3d,this.glplot.setClearColor(n(q.bgcolor)),this.setConvert(N),w?Array.isArray(w)||(w=[w]):w=[];var K=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(P=0;P<w.length;++P)(L=w[P]).visible===!0&&L._length!==0&&S(this,L,K);(function(we,Me){for(var Se=we.fullSceneLayout,ze=Se.annotations||[],Fe=0;Fe<3;Fe++)for(var Ye=A[Fe],rt=Ye.charAt(0),Oe=Se[Ye],je=0;je<ze.length;je++){var We=ze[je];if(We.visible){var qe=Oe.r2l(We[rt]);!isNaN(qe)&&isFinite(qe)&&(Me[0][Fe]=Math.min(Me[0][Fe],qe),Me[1][Fe]=Math.max(Me[1][Fe],qe))}}})(this,K);var Z=[1,1,1];for(D=0;D<3;++D)K[1][D]===K[0][D]?Z[D]=1:Z[D]=1/(K[1][D]-K[0][D]);for(this.dataScale=Z,this.convertAnnotations(this),P=0;P<w.length;++P)(L=w[P]).visible===!0&&L._length!==0&&((M=this.traces[L.uid])?M.data.type===L.type?M.update(L):(M.dispose(),M=L._module.plot(this,L),this.traces[L.uid]=M):(M=L._module.plot(this,L),this.traces[L.uid]=M),M.name=L.name);var H=Object.keys(this.traces);e:for(P=0;P<H.length;++P){for(D=0;D<w.length;++D)if(w[D].uid===H[P]&&w[D].visible===!0&&w[D]._length!==0)continue e;(M=this.traces[H[P]]).dispose(),delete this.traces[H[P]]}this.glplot.objects.sort(function(we,Me){return we._trace.data.index-Me._trace.data.index});var Y,$=[[0,0,0],[0,0,0]],z=[],j={};for(P=0;P<3;++P){if((U=(N=q[A[P]]).type)in j?(j[U].acc*=Z[P],j[U].count+=1):j[U]={acc:Z[P],count:1},N.autorange){$[0][P]=1/0,$[1][P]=-1/0;var W=this.glplot.objects,ee=this.fullSceneLayout.annotations||[],J=N._name.charAt(0);for(D=0;D<W.length;D++){var Q=W[D],te=Q.bounds,ie=Q._trace.data._pad||0;Q.constructor.name==="ErrorBars"&&N._lowerLogErrorBound?$[0][P]=Math.min($[0][P],N._lowerLogErrorBound):$[0][P]=Math.min($[0][P],te[0][P]/Z[P]-ie),$[1][P]=Math.max($[1][P],te[1][P]/Z[P]+ie)}for(D=0;D<ee.length;D++){var ae=ee[D];if(ae.visible){var he=N.r2l(ae[J]);$[0][P]=Math.min($[0][P],he),$[1][P]=Math.max($[1][P],he)}}if("rangemode"in N&&N.rangemode==="tozero"&&($[0][P]=Math.min($[0][P],0),$[1][P]=Math.max($[1][P],0)),$[0][P]>$[1][P])$[0][P]=-1,$[1][P]=1;else{var se=$[1][P]-$[0][P];$[0][P]-=se/32,$[1][P]+=se/32}if(N.autorange==="reversed"){var de=$[0][P];$[0][P]=$[1][P],$[1][P]=de}}else{var ue=N.range;$[0][P]=N.r2l(ue[0]),$[1][P]=N.r2l(ue[1])}$[0][P]===$[1][P]&&($[0][P]-=1,$[1][P]+=1),z[P]=$[1][P]-$[0][P],this.glplot.setBounds(P,{min:$[0][P]*Z[P],max:$[1][P]*Z[P]})}var ve=q.aspectmode;if(ve==="cube")Y=[1,1,1];else if(ve==="manual"){var ke=q.aspectratio;Y=[ke.x,ke.y,ke.z]}else{if(ve!=="auto"&&ve!=="data")throw new Error("scene.js aspectRatio was not one of the enumerated types");var Ee=[1,1,1];for(P=0;P<3;++P){var be=j[U=(N=q[A[P]]).type];Ee[P]=Math.pow(be.acc,1/be.count)/Z[P]}Y=ve==="data"||Math.max.apply(null,Ee)/Math.min.apply(null,Ee)<=4?Ee:[1,1,1]}q.aspectratio.x=X.aspectratio.x=Y[0],q.aspectratio.y=X.aspectratio.y=Y[1],q.aspectratio.z=X.aspectratio.z=Y[2],this.glplot.setAspectratio(q.aspectratio),this.viewInitial.aspectratio||(this.viewInitial.aspectratio={x:q.aspectratio.x,y:q.aspectratio.y,z:q.aspectratio.z}),this.viewInitial.aspectmode||(this.viewInitial.aspectmode=q.aspectmode);var xe=q.domain||null,ce=C._size||null;if(xe&&ce){var ge=this.container.style;ge.position="absolute",ge.left=ce.l+xe.x[0]*ce.w+"px",ge.top=ce.t+(1-xe.y[1])*ce.h+"px",ge.width=ce.w*(xe.x[1]-xe.x[0])+"px",ge.height=ce.h*(xe.y[1]-xe.y[0])+"px"}this.glplot.redraw()}},x.destroy=function(){this.glplot&&(this.camera.mouseListener.enabled=!1,this.container.removeEventListener("wheel",this.camera.wheelListener),this.camera=null,this.glplot.dispose(),this.container.parentNode.removeChild(this.container),this.glplot=null)},x.getCamera=function(){var w;return this.camera.view.recalcMatrix(this.camera.view.lastT()),{up:{x:(w=this.camera).up[0],y:w.up[1],z:w.up[2]},center:{x:w.center[0],y:w.center[1],z:w.center[2]},eye:{x:w.eye[0],y:w.eye[1],z:w.eye[2]},projection:{type:w._ortho===!0?"orthographic":"perspective"}}},x.setViewport=function(w){var C,k=w.camera;this.camera.lookAt.apply(this,[[(C=k).eye.x,C.eye.y,C.eye.z],[C.center.x,C.center.y,C.center.z],[C.up.x,C.up.y,C.up.z]]),this.glplot.setAspectratio(w.aspectratio),k.projection.type==="orthographic"!==this.camera._ortho&&(this.glplot.redraw(),this.glplot.clearRGBA(),this.glplot.dispose(),this.initializeGLPlot())},x.isCameraChanged=function(w){var C=this.getCamera(),k=l.nestedProperty(w,this.id+".camera").get();function L(N,U,q,X){var K=["up","center","eye"],Z=["x","y","z"];return U[K[q]]&&N[K[q]][Z[X]]===U[K[q]][Z[X]]}var M=!1;if(k===void 0)M=!0;else{for(var P=0;P<3;P++)for(var D=0;D<3;D++)if(!L(C,k,P,D)){M=!0;break}(!k.projection||C.projection&&C.projection.type!==k.projection.type)&&(M=!0)}return M},x.isAspectChanged=function(w){var C=this.glplot.getAspectratio(),k=l.nestedProperty(w,this.id+".aspectratio").get();return k===void 0||k.x!==C.x||k.y!==C.y||k.z!==C.z},x.saveLayout=function(w){var C,k,L,M,P,D,N=this.fullLayout,U=this.isCameraChanged(w),q=this.isAspectChanged(w),X=U||q;if(X){var K={};U&&(C=this.getCamera(),L=(k=l.nestedProperty(w,this.id+".camera")).get(),K[this.id+".camera"]=L),q&&(M=this.glplot.getAspectratio(),D=(P=l.nestedProperty(w,this.id+".aspectratio")).get(),K[this.id+".aspectratio"]=D),s.call("_storeDirectGUIEdit",w,N._preGUI,K),U&&(k.set(C),l.nestedProperty(N,this.id+".camera").set(C)),q&&(P.set(M),l.nestedProperty(N,this.id+".aspectratio").set(M),this.glplot.redraw())}return X},x.updateFx=function(w,C){var k=this.camera;if(k)if(w==="orbit")k.mode="orbit",k.keyBindingMode="rotate";else if(w==="turntable"){k.up=[0,0,1],k.mode="turntable",k.keyBindingMode="rotate";var L=this.graphDiv,M=L._fullLayout,P=this.fullSceneLayout.camera,D=P.up.x,N=P.up.y,U=P.up.z;if(U/Math.sqrt(D*D+N*N+U*U)<.999){var q=this.id+".camera.up",X={x:0,y:0,z:1},K={};K[q]=X;var Z=L.layout;s.call("_storeDirectGUIEdit",Z,M._preGUI,K),P.up=X,l.nestedProperty(Z,q).set(X)}}else k.keyBindingMode=w;this.fullSceneLayout.hovermode=C},x.toImage=function(w){w||(w="png"),this.staticMode&&this.container.appendChild(t),this.glplot.redraw();var C=this.glplot.gl,k=C.drawingBufferWidth,L=C.drawingBufferHeight;C.bindFramebuffer(C.FRAMEBUFFER,null);var M=new Uint8Array(k*L*4);C.readPixels(0,0,k,L,C.RGBA,C.UNSIGNED_BYTE,M),function(q,X,K){for(var Z=0,H=K-1;Z<H;++Z,--H)for(var Y=0;Y<X;++Y)for(var $=0;$<4;++$){var z=4*(X*Z+Y)+$,j=4*(X*H+Y)+$,W=q[z];q[z]=q[j],q[j]=W}}(M,k,L),function(q,X,K){for(var Z=0;Z<K;++Z)for(var H=0;H<X;++H){var Y=4*(X*Z+H),$=q[Y+3];if($>0)for(var z=255/$,j=0;j<3;++j)q[Y+j]=Math.min(z*q[Y+j],255)}}(M,k,L);var P=document.createElement("canvas");P.width=k,P.height=L;var D,N=P.getContext("2d"),U=N.createImageData(k,L);switch(U.data.set(M),N.putImageData(U,0,0),w){case"jpeg":D=P.toDataURL("image/jpeg");break;case"webp":D=P.toDataURL("image/webp");break;default:D=P.toDataURL("image/png")}return this.staticMode&&this.container.removeChild(t),D},x.setConvert=function(){for(var w=0;w<3;w++){var C=this.fullSceneLayout[A[w]];i.setConvert(C,this.fullLayout),C.setScale=l.noop}},x.make4thDimension=function(){var w=this.graphDiv._fullLayout;this._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},i.setConvert(this._mockAxis,w)},O.exports=_},{"../../components/fx":690,"../../lib":787,"../../lib/show_no_webgl_msg":809,"../../lib/str2rgbarray":812,"../../plots/cartesian/axes":838,"../../registry":915,"./layout/convert":884,"./layout/spikes":887,"./layout/tick_marks":888,"./project":889,"gl-plot3d":319,"has-passive-events":436,"webgl-context":613}],891:[function(r,O,B){O.exports=function(t,d,m,p){p=p||t.length;for(var e=new Array(p),f=0;f<p;f++)e[f]=[t[f],d[f],m[f]];return e}},{}],892:[function(r,O,B){var t=r("./font_attributes"),d=r("./animation_attributes"),m=r("../components/color/attributes"),p=r("../components/shapes/draw_newshape/attributes"),e=r("./pad_attributes"),f=r("../lib/extend").extendFlat,u=t({editType:"calc"});u.family.dflt='"Open Sans", verdana, arial, sans-serif',u.size.dflt=12,u.color.dflt=m.defaultLine,O.exports={font:u,title:{text:{valType:"string",editType:"layoutstyle"},font:t({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:f(e({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:m.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:m.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:m.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:p.newshape,activeshape:p.activeshape,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:f({},d.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:t({editType:"layoutstyle"})}}},{"../components/color/attributes":649,"../components/shapes/draw_newshape/attributes":735,"../lib/extend":777,"./animation_attributes":832,"./font_attributes":867,"./pad_attributes":900}],893:[function(r,O,B){var t=r("../../lib/sort_object_keys"),d='\xA9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',m=['\xA9 <a target="_blank" href="https://carto.com/">Carto</a>',d].join(" "),p=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" "),e={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:d,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:m,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:m,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:p,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:p,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" "),tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},f=t(e);O.exports={requiredVersion:"1.10.1",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:e,styleValuesNonMapbox:f,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@1.10.1."].join(`
`),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join(`
`),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",f.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join(`
`),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join(`
`),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":`content: ""; cursor: pointer; position: absolute; background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;`,"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":`display:block; width: 21px; height: 21px; background-image: url('data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E')`}}},{"../../lib/sort_object_keys":810}],894:[function(r,O,B){var t=r("../../lib");O.exports=function(d,m){var p=d.split(" "),e=p[0],f=p[1],u=t.isArrayOrTypedArray(m)?t.mean(m):m,s=.5+u/100,l=1.5+u/100,o=["",""],i=[0,0];switch(e){case"top":o[0]="top",i[1]=-l;break;case"bottom":o[0]="bottom",i[1]=l}switch(f){case"left":o[1]="right",i[0]=-s;break;case"right":o[1]="left",i[0]=s}return{anchor:o[0]&&o[1]?o.join("-"):o[0]?o[0]:o[1]?o[1]:"center",offset:i}}},{"../../lib":787}],895:[function(r,O,B){var t=r("mapbox-gl/dist/mapbox-gl-unminified"),d=r("../../lib"),m=d.strTranslate,p=d.strScale,e=r("../../plots/get_data").getSubplotCalcData,f=r("../../constants/xmlns_namespaces"),u=r("@plotly/d3"),s=r("../../components/drawing"),l=r("../../lib/svg_text_utils"),o=r("./mapbox"),i=B.constants=r("./constants");function c(n){return typeof n=="string"&&(i.styleValuesMapbox.indexOf(n)!==-1||n.indexOf("mapbox://")===0)}B.name="mapbox",B.attr="subplot",B.idRoot="mapbox",B.idRegex=B.attrRegex=d.counterRegex("mapbox"),B.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},B.layoutAttributes=r("./layout_attributes"),B.supplyLayoutDefaults=r("./layout_defaults"),B.plot=function(n){var a=n._fullLayout,g=n.calcdata,h=a._subplots.mapbox;if(t.version!==i.requiredVersion)throw new Error(i.wrongVersionErrorMsg);var y=function(S,w){var C=S._fullLayout;if(S._context.mapboxAccessToken==="")return"";for(var k=[],L=[],M=!1,P=!1,D=0;D<w.length;D++){var N=C[w[D]],U=N.accesstoken;c(N.style)&&(U?d.pushUnique(k,U):(c(N._input.style)&&(d.error("Uses Mapbox map style, but did not set an access token."),M=!0),P=!0)),U&&d.pushUnique(L,U)}if(P){var q=M?i.noAccessTokenErrorMsg:i.missingStyleErrorMsg;throw d.error(q),new Error(q)}return k.length?(k.length>1&&d.warn(i.multipleTokensErrorMsg),k[0]):(L.length&&d.log(["Listed mapbox access token(s)",L.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}(n,h);t.accessToken=y;for(var v=0;v<h.length;v++){var _=h[v],x=e(g,"mapbox",_),T=a[_],A=T._subplot;A||(A=new o(n,_),a[_]._subplot=A),A.viewInitial||(A.viewInitial={center:d.extendFlat({},T.center),zoom:T.zoom,bearing:T.bearing,pitch:T.pitch}),A.plot(x,a,n._promises)}},B.clean=function(n,a,g,h){for(var y=h._subplots.mapbox||[],v=0;v<y.length;v++){var _=y[v];!a[_]&&h[_]._subplot&&h[_]._subplot.destroy()}},B.toSVG=function(n){for(var a=n._fullLayout,g=a._subplots.mapbox,h=a._size,y=0;y<g.length;y++){var v=a[g[y]],_=v.domain,x=v._subplot.toImage("png");a._glimages.append("svg:image").attr({xmlns:f.svg,"xlink:href":x,x:h.l+h.w*_.x[0],y:h.t+h.h*(1-_.y[1]),width:h.w*(_.x[1]-_.x[0]),height:h.h*(_.y[1]-_.y[0]),preserveAspectRatio:"none"});var T=u.select(v._subplot.div);if(T.select(".mapboxgl-ctrl-logo").node().offsetParent!==null){var A=a._glimages.append("g");A.attr("transform",m(h.l+h.w*_.x[0]+10,h.t+h.h*(1-_.y[0])-31)),A.append("path").attr("d",i.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),A.append("path").attr("d",i.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),A.append("path").attr("d",i.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),A.append("polygon").attr("points",i.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var S=T.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),w=a._glimages.append("g"),C=w.append("text");C.text(S).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":S});var k=s.bBox(C.node()),L=h.w*(_.x[1]-_.x[0]);if(k.width>L/2){var M=S.split("|").join("<br>");C.text(M).attr("data-unformatted",M).call(l.convertToTspans,n),k=s.bBox(C.node())}C.attr("transform",m(-3,8-k.height)),w.insert("rect",".static-attribution").attr({x:-k.width-6,y:-k.height-3,width:k.width+6,height:k.height+3,fill:"rgba(255, 255, 255, 0.75)"});var P=1;k.width+6>L&&(P=L/(k.width+6));var D=[h.l+h.w*_.x[1],h.t+h.h*(1-_.y[0])];w.attr("transform",m(D[0],D[1])+p(P))}},B.updateFx=function(n){for(var a=n._fullLayout,g=a._subplots.mapbox,h=0;h<g.length;h++)a[g[h]]._subplot.updateFx(a)}},{"../../components/drawing":672,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/get_data":875,"./constants":893,"./layout_attributes":897,"./layout_defaults":898,"./mapbox":899,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":451}],896:[function(r,O,B){var t=r("../../lib"),d=r("../../lib/svg_text_utils").sanitizeHTML,m=r("./convert_text_opts"),p=r("./constants");function e(l,o){this.subplot=l,this.uid=l.uid+"-"+o,this.index=o,this.idSource="source-"+this.uid,this.idLayer=p.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var f=e.prototype;function u(l){if(!l.visible)return!1;var o=l.source;if(Array.isArray(o)&&o.length>0){for(var i=0;i<o.length;i++)if(typeof o[i]!="string"||o[i].length===0)return!1;return!0}return t.isPlainObject(o)||typeof o=="string"&&o.length>0}function s(l){var o={},i={};switch(l.type){case"circle":t.extendFlat(i,{"circle-radius":l.circle.radius,"circle-color":l.color,"circle-opacity":l.opacity});break;case"line":t.extendFlat(i,{"line-width":l.line.width,"line-color":l.color,"line-opacity":l.opacity,"line-dasharray":l.line.dash});break;case"fill":t.extendFlat(i,{"fill-color":l.color,"fill-outline-color":l.fill.outlinecolor,"fill-opacity":l.opacity});break;case"symbol":var c=l.symbol,n=m(c.textposition,c.iconsize);t.extendFlat(o,{"icon-image":c.icon+"-15","icon-size":c.iconsize/10,"text-field":c.text,"text-size":c.textfont.size,"text-anchor":n.anchor,"text-offset":n.offset,"symbol-placement":c.placement}),t.extendFlat(i,{"icon-color":l.color,"text-color":c.textfont.color,"text-opacity":l.opacity});break;case"raster":t.extendFlat(i,{"raster-fade-duration":0,"raster-opacity":l.opacity})}return{layout:o,paint:i}}f.update=function(l){this.visible?this.needsNewImage(l)?this.updateImage(l):this.needsNewSource(l)?(this.removeLayer(),this.updateSource(l),this.updateLayer(l)):this.needsNewLayer(l)?this.updateLayer(l):this.updateStyle(l):(this.updateSource(l),this.updateLayer(l)),this.visible=u(l)},f.needsNewImage=function(l){return this.subplot.map.getSource(this.idSource)&&this.sourceType==="image"&&l.sourcetype==="image"&&(this.source!==l.source||JSON.stringify(this.coordinates)!==JSON.stringify(l.coordinates))},f.needsNewSource=function(l){return this.sourceType!==l.sourcetype||JSON.stringify(this.source)!==JSON.stringify(l.source)||this.layerType!==l.type},f.needsNewLayer=function(l){return this.layerType!==l.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},f.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},f.updateImage=function(l){this.subplot.map.getSource(this.idSource).updateImage({url:l.source,coordinates:l.coordinates});var o=this.findFollowingMapboxLayerId(this.lookupBelow());o!==null&&this.subplot.map.moveLayer(this.idLayer,o)},f.updateSource=function(l){var o=this.subplot.map;if(o.getSource(this.idSource)&&o.removeSource(this.idSource),this.sourceType=l.sourcetype,this.source=l.source,u(l)){var i=function(c){var n,a=c.sourcetype,g=c.source,h={type:a};return a==="geojson"?n="data":a==="vector"?n=typeof g=="string"?"url":"tiles":a==="raster"?(n="tiles",h.tileSize=256):a==="image"&&(n="url",h.coordinates=c.coordinates),h[n]=g,c.sourceattribution&&(h.attribution=d(c.sourceattribution)),h}(l);o.addSource(this.idSource,i)}},f.findFollowingMapboxLayerId=function(l){if(l==="traces")for(var o=this.subplot.getMapLayers(),i=0;i<o.length;i++){var c=o[i].id;if(typeof c=="string"&&c.indexOf(p.traceLayerPrefix)===0){l=c;break}}return l},f.updateLayer=function(l){var o=this.subplot,i=s(l),c=this.lookupBelow(),n=this.findFollowingMapboxLayerId(c);this.removeLayer(),u(l)&&o.addLayer({id:this.idLayer,source:this.idSource,"source-layer":l.sourcelayer||"",type:l.type,minzoom:l.minzoom,maxzoom:l.maxzoom,layout:i.layout,paint:i.paint},n),this.layerType=l.type,this.below=c},f.updateStyle=function(l){if(u(l)){var o=s(l);this.subplot.setOptions(this.idLayer,"setLayoutProperty",o.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",o.paint)}},f.removeLayer=function(){var l=this.subplot.map;l.getLayer(this.idLayer)&&l.removeLayer(this.idLayer)},f.dispose=function(){var l=this.subplot.map;l.getLayer(this.idLayer)&&l.removeLayer(this.idLayer),l.getSource(this.idSource)&&l.removeSource(this.idSource)},O.exports=function(l,o,i){var c=new e(l,o);return c.update(i),c}},{"../../lib":787,"../../lib/svg_text_utils":813,"./constants":893,"./convert_text_opts":894}],897:[function(r,O,B){var t=r("../../lib"),d=r("../../components/color").defaultLine,m=r("../domain").attributes,p=r("../font_attributes"),e=r("../../traces/scatter/attributes").textposition,f=r("../../plot_api/edit_types").overrideAll,u=r("../../plot_api/plot_template").templatedArray,s=r("./constants"),l=p({});l.family.dflt="Open Sans Regular, Arial Unicode MS Regular",(O.exports=f({_arrayAttrRegexps:[t.counterRegex("mapbox",".layers",!0)],domain:m({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:s.styleValuesMapbox.concat(s.styleValuesNonMapbox),dflt:s.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:u("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:d},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:d}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:l,textposition:t.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color":650,"../../lib":787,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../traces/scatter/attributes":1202,"../domain":866,"../font_attributes":867,"./constants":893}],898:[function(r,O,B){var t=r("../../lib"),d=r("../subplot_defaults"),m=r("../array_container_defaults"),p=r("./layout_attributes");function e(u,s,l,o){l("accesstoken",o.accessToken),l("style"),l("center.lon"),l("center.lat"),l("zoom"),l("bearing"),l("pitch"),m(u,s,{name:"layers",handleItemDefaults:f}),s._input=u}function f(u,s){function l(a,g){return t.coerce(u,s,p.layers,a,g)}if(l("visible")){var o,i=l("sourcetype"),c=i==="raster"||i==="image";l("source"),l("sourceattribution"),i==="vector"&&l("sourcelayer"),i==="image"&&l("coordinates"),c&&(o="raster");var n=l("type",o);c&&n!=="raster"&&(n=s.type="raster",t.log("Source types *raster* and *image* must drawn *raster* layer type.")),l("below"),l("color"),l("opacity"),l("minzoom"),l("maxzoom"),n==="circle"&&l("circle.radius"),n==="line"&&(l("line.width"),l("line.dash")),n==="fill"&&l("fill.outlinecolor"),n==="symbol"&&(l("symbol.icon"),l("symbol.iconsize"),l("symbol.text"),t.coerceFont(l,"symbol.textfont"),l("symbol.textposition"),l("symbol.placement"))}}O.exports=function(u,s,l){d(u,s,l,{type:"mapbox",attributes:p,handleDefaults:e,partition:"y",accessToken:s._mapboxAccessToken})}},{"../../lib":787,"../array_container_defaults":833,"../subplot_defaults":909,"./layout_attributes":897}],899:[function(r,O,B){var t=r("mapbox-gl/dist/mapbox-gl-unminified"),d=r("../../lib"),m=r("../../lib/geo_location_utils"),p=r("../../registry"),e=r("../cartesian/axes"),f=r("../../components/dragelement"),u=r("../../components/fx"),s=r("../../components/dragelement/helpers"),l=s.rectMode,o=s.drawMode,i=s.selectMode,c=r("../cartesian/select").prepSelect,n=r("../cartesian/select").clearSelect,a=r("../cartesian/select").clearSelectionsCache,g=r("../cartesian/select").selectOnClick,h=r("./constants"),y=r("./layers");function v(w,C){this.id=C,this.gd=w;var k=w._fullLayout,L=w._context;this.container=k._glcontainer.node(),this.isStatic=L.staticPlot,this.uid=k._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(k),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var _=v.prototype;_.plot=function(w,C,k){var L,M=this,P=C[M.id];M.map&&P.accesstoken!==M.accessToken&&(M.map.remove(),M.map=null,M.styleObj=null,M.traceHash={},M.layerList=[]),L=M.map?new Promise(function(D,N){M.updateMap(w,C,D,N)}):new Promise(function(D,N){M.createMap(w,C,D,N)}),k.push(L)},_.createMap=function(w,C,k,L){var M=this,P=C[M.id],D=M.styleObj=T(P.style);M.accessToken=P.accesstoken;var N=M.map=new t.Map({container:M.div,style:D.style,center:S(P.center),zoom:P.zoom,bearing:P.bearing,pitch:P.pitch,interactive:!M.isStatic,preserveDrawingBuffer:M.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new t.AttributionControl({compact:!0}));N._canvas.style.left="0px",N._canvas.style.top="0px",M.rejectOnError(L),M.isStatic||M.initFx(w,C);var U=[];U.push(new Promise(function(q){N.once("load",q)})),U=U.concat(m.fetchTraceGeoData(w)),Promise.all(U).then(function(){M.fillBelowLookup(w,C),M.updateData(w),M.updateLayout(C),M.resolveOnRender(k)}).catch(L)},_.updateMap=function(w,C,k,L){var M=this,P=M.map,D=C[this.id];M.rejectOnError(L);var N=[],U=T(D.style);JSON.stringify(M.styleObj)!==JSON.stringify(U)&&(M.styleObj=U,P.setStyle(U.style),M.traceHash={},N.push(new Promise(function(q){P.once("styledata",q)}))),N=N.concat(m.fetchTraceGeoData(w)),Promise.all(N).then(function(){M.fillBelowLookup(w,C),M.updateData(w),M.updateLayout(C),M.resolveOnRender(k)}).catch(L)},_.fillBelowLookup=function(w,C){var k,L,M=C[this.id].layers,P=this.belowLookup={},D=!1;for(k=0;k<w.length;k++){var N=w[k][0].trace,U=N._module;typeof N.below=="string"?L=N.below:U.getBelow&&(L=U.getBelow(N,this)),L===""&&(D=!0),P["trace-"+N.uid]=L||""}for(k=0;k<M.length;k++){var q=M[k];L=typeof q.below=="string"?q.below:D?"traces":"",P["layout-"+k]=L}var X,K,Z={};for(X in P)Z[L=P[X]]?Z[L].push(X):Z[L]=[X];for(L in Z){var H=Z[L];if(H.length>1)for(k=0;k<H.length;k++)(X=H[k]).indexOf("trace-")===0?(K=X.split("trace-")[1],this.traceHash[K]&&(this.traceHash[K].below=null)):X.indexOf("layout-")===0&&(K=X.split("layout-")[1],this.layerList[K]&&(this.layerList[K].below=null))}};var x={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};function T(w){var C={};return d.isPlainObject(w)?(C.id=w.id,C.style=w):typeof w=="string"?(C.id=w,h.styleValuesMapbox.indexOf(w)!==-1?C.style=A(w):h.stylesNonMapbox[w]?C.style=h.stylesNonMapbox[w]:C.style=w):(C.id=h.styleValueDflt,C.style=A(h.styleValueDflt)),C.transition={duration:0,delay:0},C}function A(w){return h.styleUrlPrefix+w+"-"+h.styleUrlSuffix}function S(w){return[w.lon,w.lat]}_.updateData=function(w){var C,k,L,M,P=this.traceHash,D=w.slice().sort(function(K,Z){return x[K[0].trace.type]-x[Z[0].trace.type]});for(L=0;L<D.length;L++){var N=D[L],U=!1;(C=P[(k=N[0].trace).uid])&&(C.type===k.type?(C.update(N),U=!0):C.dispose()),!U&&k._module&&(P[k.uid]=k._module.plot(this,N))}var q=Object.keys(P);e:for(L=0;L<q.length;L++){var X=q[L];for(M=0;M<w.length;M++)if(X===(k=w[M][0].trace).uid)continue e;(C=P[X]).dispose(),delete P[X]}},_.updateLayout=function(w){var C=this.map,k=w[this.id];this.dragging||this.wheeling||(C.setCenter(S(k.center)),C.setZoom(k.zoom),C.setBearing(k.bearing),C.setPitch(k.pitch)),this.updateLayers(w),this.updateFramework(w),this.updateFx(w),this.map.resize(),this.gd._context._scrollZoom.mapbox?C.scrollZoom.enable():C.scrollZoom.disable()},_.resolveOnRender=function(w){var C=this.map;C.on("render",function k(){C.loaded()&&(C.off("render",k),setTimeout(w,10))})},_.rejectOnError=function(w){var C=this.map;function k(){w(new Error(h.mapOnErrorMsg))}C.once("error",k),C.once("style.error",k),C.once("source.error",k),C.once("tile.error",k),C.once("layer.error",k)},_.createFramework=function(w){var C=this,k=C.div=document.createElement("div");k.id=C.uid,k.style.position="absolute",C.container.appendChild(k),C.xaxis={_id:"x",c2p:function(L){return C.project(L).x}},C.yaxis={_id:"y",c2p:function(L){return C.project(L).y}},C.updateFramework(w),C.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(C.mockAxis,w)},_.initFx=function(w,C){var k=this,L=k.gd,M=k.map;function P(){u.loneUnhover(C._hoverlayer)}function D(){var N=k.getView();L.emit("plotly_relayouting",k.getViewEditsWithDerived(N))}M.on("moveend",function(N){if(k.map){var U=L._fullLayout;if(N.originalEvent||k.wheeling){var q=U[k.id];p.call("_storeDirectGUIEdit",L.layout,U._preGUI,k.getViewEdits(q));var X=k.getView();q._input.center=q.center=X.center,q._input.zoom=q.zoom=X.zoom,q._input.bearing=q.bearing=X.bearing,q._input.pitch=q.pitch=X.pitch,L.emit("plotly_relayout",k.getViewEditsWithDerived(X))}N.originalEvent&&N.originalEvent.type==="mouseup"?k.dragging=!1:k.wheeling&&(k.wheeling=!1),U._rehover&&U._rehover()}}),M.on("wheel",function(){k.wheeling=!0}),M.on("mousemove",function(N){var U=k.div.getBoundingClientRect(),q=[N.originalEvent.offsetX,N.originalEvent.offsetY];N.target.getBoundingClientRect=function(){return U},k.xaxis.p2c=function(){return M.unproject(q).lng},k.yaxis.p2c=function(){return M.unproject(q).lat},L._fullLayout._rehover=function(){L._fullLayout._hoversubplot===k.id&&L._fullLayout[k.id]&&u.hover(L,N,k.id)},u.hover(L,N,k.id),L._fullLayout._hoversubplot=k.id}),M.on("dragstart",function(){k.dragging=!0,P()}),M.on("zoomstart",P),M.on("mouseout",function(){L._fullLayout._hoversubplot=null}),M.on("drag",D),M.on("zoom",D),M.on("dblclick",function(){var N=L._fullLayout[k.id];p.call("_storeDirectGUIEdit",L.layout,L._fullLayout._preGUI,k.getViewEdits(N));var U=k.viewInitial;M.setCenter(S(U.center)),M.setZoom(U.zoom),M.setBearing(U.bearing),M.setPitch(U.pitch);var q=k.getView();N._input.center=N.center=q.center,N._input.zoom=N.zoom=q.zoom,N._input.bearing=N.bearing=q.bearing,N._input.pitch=N.pitch=q.pitch,L.emit("plotly_doubleclick",null),L.emit("plotly_relayout",k.getViewEditsWithDerived(q))}),k.clearSelect=function(){a(k.dragOptions),n(k.dragOptions.gd)},k.onClickInPanFn=function(N){return function(U){var q=L._fullLayout.clickmode;q.indexOf("select")>-1&&g(U.originalEvent,L,[k.xaxis],[k.yaxis],k.id,N),q.indexOf("event")>-1&&u.click(L,U.originalEvent)}}},_.updateFx=function(w){var C=this,k=C.map,L=C.gd;if(!C.isStatic){var M,P=w.dragmode;M=l(P)?function(U,q){(U.range={})[C.id]=[N([q.xmin,q.ymin]),N([q.xmax,q.ymax])]}:function(U,q,X){(U.lassoPoints={})[C.id]=X.filtered.map(N)};var D=C.dragOptions;C.dragOptions=d.extendDeep(D||{},{dragmode:w.dragmode,element:C.div,gd:L,plotinfo:{id:C.id,domain:w[C.id].domain,xaxis:C.xaxis,yaxis:C.yaxis,fillRangeItems:M},xaxes:[C.xaxis],yaxes:[C.yaxis],subplot:C.id}),k.off("click",C.onClickInPanHandler),i(P)||o(P)?(k.dragPan.disable(),k.on("zoomstart",C.clearSelect),C.dragOptions.prepFn=function(U,q,X){c(U,q,X,C.dragOptions,P)},f.init(C.dragOptions)):(k.dragPan.enable(),k.off("zoomstart",C.clearSelect),C.div.onmousedown=null,C.onClickInPanHandler=C.onClickInPanFn(C.dragOptions),k.on("click",C.onClickInPanHandler))}function N(U){var q=C.map.unproject(U);return[q.lng,q.lat]}},_.updateFramework=function(w){var C=w[this.id].domain,k=w._size,L=this.div.style;L.width=k.w*(C.x[1]-C.x[0])+"px",L.height=k.h*(C.y[1]-C.y[0])+"px",L.left=k.l+C.x[0]*k.w+"px",L.top=k.t+(1-C.y[1])*k.h+"px",this.xaxis._offset=k.l+C.x[0]*k.w,this.xaxis._length=k.w*(C.x[1]-C.x[0]),this.yaxis._offset=k.t+(1-C.y[1])*k.h,this.yaxis._length=k.h*(C.y[1]-C.y[0])},_.updateLayers=function(w){var C,k=w[this.id].layers,L=this.layerList;if(k.length!==L.length){for(C=0;C<L.length;C++)L[C].dispose();for(L=this.layerList=[],C=0;C<k.length;C++)L.push(y(this,C,k[C]))}else for(C=0;C<k.length;C++)L[C].update(k[C])},_.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},_.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},_.setOptions=function(w,C,k){for(var L in k)this.map[C](w,L,k[L])},_.getMapLayers=function(){return this.map.getStyle().layers},_.addLayer=function(w,C){var k=this.map;if(typeof C=="string"){if(C==="")return void k.addLayer(w,C);for(var L=this.getMapLayers(),M=0;M<L.length;M++)if(C===L[M].id)return void k.addLayer(w,C);d.warn(["Trying to add layer with *below* value",C,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}k.addLayer(w)},_.project=function(w){return this.map.project(new t.LngLat(w[0],w[1]))},_.getView=function(){var w=this.map,C=w.getCenter(),k={lon:C.lng,lat:C.lat},L=w.getCanvas(),M=L.width,P=L.height;return{center:k,zoom:w.getZoom(),bearing:w.getBearing(),pitch:w.getPitch(),_derived:{coordinates:[w.unproject([0,0]).toArray(),w.unproject([M,0]).toArray(),w.unproject([M,P]).toArray(),w.unproject([0,P]).toArray()]}}},_.getViewEdits=function(w){for(var C=this.id,k=["center","zoom","bearing","pitch"],L={},M=0;M<k.length;M++){var P=k[M];L[C+"."+P]=w[P]}return L},_.getViewEditsWithDerived=function(w){var C=this.id,k=this.getViewEdits(w);return k[C+"._derived"]=w._derived,k},O.exports=v},{"../../components/dragelement":669,"../../components/dragelement/helpers":668,"../../components/fx":690,"../../lib":787,"../../lib/geo_location_utils":780,"../../registry":915,"../cartesian/axes":838,"../cartesian/select":858,"./constants":893,"./layers":896,"mapbox-gl/dist/mapbox-gl-unminified":451}],900:[function(r,O,B){O.exports=function(t){var d=t.editType;return{t:{valType:"number",dflt:0,editType:d},r:{valType:"number",dflt:0,editType:d},b:{valType:"number",dflt:0,editType:d},l:{valType:"number",dflt:0,editType:d},editType:d}}},{}],901:[function(r,O,B){var t=r("@plotly/d3"),d=r("d3-time-format").timeFormatLocale,m=r("d3-format").formatLocale,p=r("fast-isnumeric"),e=r("../registry"),f=r("../plot_api/plot_schema"),u=r("../plot_api/plot_template"),s=r("../lib"),l=r("../components/color"),o=r("../constants/numerical").BADNUM,i=r("./cartesian/axis_ids"),c=r("./cartesian/handle_outline").clearSelect,n=r("./animation_attributes"),a=r("./frame_attributes"),g=r("../plots/get_data").getModuleCalcData,h=s.relinkPrivateKeys,y=s._,v=O.exports={};s.extendFlat(v,e),v.attributes=r("./attributes"),v.attributes.type.values=v.allTypes,v.fontAttrs=r("./font_attributes"),v.layoutAttributes=r("./layout_attributes"),v.fontWeight="normal";var _=v.transformsRegistry,x=r("./command");v.executeAPICommand=x.executeAPICommand,v.computeAPICommandBindings=x.computeAPICommandBindings,v.manageCommandObserver=x.manageCommandObserver,v.hasSimpleAPICommandBindings=x.hasSimpleAPICommandBindings,v.redrawText=function(X){return X=s.getGraphDiv(X),new Promise(function(K){setTimeout(function(){X._fullLayout&&(e.getComponentMethod("annotations","draw")(X),e.getComponentMethod("legend","draw")(X),e.getComponentMethod("colorbar","draw")(X),K(v.previousPromises(X)))},300)})},v.resize=function(X){var K;X=s.getGraphDiv(X);var Z=new Promise(function(H,Y){X&&!s.isHidden(X)||Y(new Error("Resize must be passed a displayed plot div element.")),X._redrawTimer&&clearTimeout(X._redrawTimer),X._resolveResize&&(K=X._resolveResize),X._resolveResize=H,X._redrawTimer=setTimeout(function(){if(!X.layout||X.layout.width&&X.layout.height||s.isHidden(X))H(X);else{delete X.layout.width,delete X.layout.height;var $=X.changed;X.autoplay=!0,e.call("relayout",X,{autosize:!0}).then(function(){X.changed=$,X._resolveResize===H&&(delete X._resolveResize,H(X))})}},100)});return K&&K(Z),Z},v.previousPromises=function(X){if((X._promises||[]).length)return Promise.all(X._promises).then(function(){X._promises=[]})},v.addLinks=function(X){if(X._context.showLink||X._context.showSources){var K=X._fullLayout,Z=s.ensureSingle(K._paper,"text","js-plot-link-container",function(W){W.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:l.defaultLine,"pointer-events":"all"}).each(function(){var ee=t.select(this);ee.append("tspan").classed("js-link-to-tool",!0),ee.append("tspan").classed("js-link-spacer",!0),ee.append("tspan").classed("js-sourcelinks",!0)})}),H=Z.node(),Y={y:K._paper.attr("height")-9};document.body.contains(H)&&H.getComputedTextLength()>=K.width-20?(Y["text-anchor"]="start",Y.x=5):(Y["text-anchor"]="end",Y.x=K._paper.attr("width")-7),Z.attr(Y);var $=Z.select(".js-link-to-tool"),z=Z.select(".js-link-spacer"),j=Z.select(".js-sourcelinks");X._context.showSources&&X._context.showSources(X),X._context.showLink&&function(W,ee){ee.text("");var J=ee.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(W._context.linkText+" "+String.fromCharCode(187));if(W._context.sendData)J.on("click",function(){v.sendDataToCloud(W)});else{var Q=window.location.pathname.split("/"),te=window.location.search;J.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+Q[2].split(".")[0]+"/"+Q[1]+te})}}(X,$),z.text($.text()&&j.text()?" - ":"")}},v.sendDataToCloud=function(X){var K=(window.PLOTLYENV||{}).BASE_URL||X._context.plotlyServerURL;if(K){X.emit("plotly_beforeexport");var Z=t.select(X).append("div").attr("id","hiddenform").style("display","none"),H=Z.append("form").attr({action:K+"/external",method:"post",target:"_blank"});return H.append("input").attr({type:"text",name:"data"}).node().value=v.graphJson(X,!1,"keepdata"),H.node().submit(),Z.remove(),X.emit("plotly_afterexport"),!1}};var T=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],A=["year","month","dayMonth","dayMonthYear"];function S(X,K){var Z=X._context.locale;Z||(Z="en-US");var H=!1,Y={};function $(Q){for(var te=!0,ie=0;ie<K.length;ie++){var ae=K[ie];Y[ae]||(Q[ae]?Y[ae]=Q[ae]:te=!1)}te&&(H=!0)}for(var z=0;z<2;z++){for(var j=X._context.locales,W=0;W<2;W++){var ee=(j[Z]||{}).format;if(ee&&($(ee),H))break;j=e.localeRegistry}var J=Z.split("-")[0];if(H||J===Z)break;Z=J}return H||$(e.localeRegistry.en.format),Y}function w(X,K){var Z={_fullLayout:K},H=X._id.charAt(0)==="x",Y=X._mainAxis._anchorAxis,$="",z="",j="";if(Y&&(j=Y._mainAxis._id,$=H?X._id+j:j+X._id),!$||!K._plots[$]){$="";for(var W=X._counterAxes,ee=0;ee<W.length;ee++){var J=W[ee],Q=H?X._id+J:J+X._id;z||(z=Q);var te=i.getFromId(Z,J);if(j&&te.overlaying===j){$=Q;break}}}return $||z}function C(X){var K=X.transforms;if(Array.isArray(K)&&K.length)for(var Z=0;Z<K.length;Z++){var H=K[Z],Y=H._module||_[H.type];if(Y&&Y.makesData)return!0}return!1}function k(X,K,Z,H){for(var Y=X.transforms,$=[X],z=0;z<Y.length;z++){var j=Y[z],W=_[j.type];W&&W.transform&&($=W.transform($,{transform:j,fullTrace:X,fullData:K,layout:Z,fullLayout:H,transformIndex:z}))}return $}function L(X){return typeof X=="string"&&X.substr(X.length-2)==="px"&&parseFloat(X)}function M(X){var K=X.margin;if(!X._size){var Z=X._size={l:Math.round(K.l),r:Math.round(K.r),t:Math.round(K.t),b:Math.round(K.b),p:Math.round(K.pad)};Z.w=Math.round(X.width)-Z.l-Z.r,Z.h=Math.round(X.height)-Z.t-Z.b}X._pushmargin||(X._pushmargin={}),X._pushmarginIds||(X._pushmarginIds={})}v.supplyDefaults=function(X,K){var Z=K&&K.skipUpdateCalc,H=X._fullLayout||{};if(H._skipDefaults)delete H._skipDefaults;else{var Y,$=X._fullLayout={},z=X.layout||{},j=X._fullData||[],W=X._fullData=[],ee=X.data||[],J=X.calcdata||[],Q=X._context||{};X._transitionData||v.createTransitionData(X),$._dfltTitle={plot:y(X,"Click to enter Plot title"),x:y(X,"Click to enter X axis title"),y:y(X,"Click to enter Y axis title"),colorbar:y(X,"Click to enter Colorscale title"),annotation:y(X,"new text")},$._traceWord=y(X,"trace");var te=S(X,T);if($._mapboxAccessToken=Q.mapboxAccessToken,H._initialAutoSizeIsDone){var ie=H.width,ae=H.height;v.supplyLayoutGlobalDefaults(z,$,te),z.width||($.width=ie),z.height||($.height=ae),v.sanitizeMargins($)}else{v.supplyLayoutGlobalDefaults(z,$,te);var he=!z.width||!z.height,se=$.autosize,de=Q.autosizable;he&&(se||de)?v.plotAutoSize(X,z,$):he&&v.sanitizeMargins($),!se&&he&&(z.width=$.width,z.height=$.height)}$._d3locale=function(je,We){return je.decimal=We.charAt(0),je.thousands=We.charAt(1),{numberFormat:function(qe){try{qe=m(je).format(s.adjustFormat(qe))}catch(Qe){return s.warnBadFormat(qe),s.noFormat}return qe},timeFormat:d(je).utcFormat}}(te,$.separators),$._extraFormat=S(X,A),$._initialAutoSizeIsDone=!0,$._dataLength=ee.length,$._modules=[],$._visibleModules=[],$._basePlotModules=[];var ue=$._subplots=function(){var je,We,qe=e.collectableSubplotTypes,Qe={};if(!qe){qe=[];var st=e.subplotsRegistry;for(var ct in st){var Pt=st[ct].attr;if(Pt&&(qe.push(ct),Array.isArray(Pt)))for(We=0;We<Pt.length;We++)s.pushUnique(qe,Pt[We])}}for(je=0;je<qe.length;je++)Qe[qe[je]]=[];return Qe}(),ve=$._splomAxes={x:{},y:{}},ke=$._splomSubplots={};$._splomGridDflt={},$._scatterStackOpts={},$._firstScatter={},$._alignmentOpts={},$._colorAxes={},$._requestRangeslider={},$._traceUids=function(je,We){var qe,Qe,st=We.length,ct=[];for(qe=0;qe<je.length;qe++){var Pt=je[qe]._fullInput;Pt!==Qe&&ct.push(Pt),Qe=Pt}var kt=ct.length,at=new Array(st),tt={};function _t(Ue,He){at[He]=Ue,tt[Ue]=1}function er(Ue,He){if(Ue&&typeof Ue=="string"&&!tt[Ue])return _t(Ue,He),!0}for(qe=0;qe<st;qe++){var tr=We[qe].uid;typeof tr=="number"&&(tr=String(tr)),er(tr,qe)||qe<kt&&er(ct[qe].uid,qe)||_t(s.randstr(tt),qe)}return at}(j,ee),$._globalTransforms=(X._context||{}).globalTransforms,v.supplyDataDefaults(ee,W,z,$);var Ee=Object.keys(ve.x),be=Object.keys(ve.y);if(Ee.length>1&&be.length>1){for(e.getComponentMethod("grid","sizeDefaults")(z,$),Y=0;Y<Ee.length;Y++)s.pushUnique(ue.xaxis,Ee[Y]);for(Y=0;Y<be.length;Y++)s.pushUnique(ue.yaxis,be[Y]);for(var xe in ke)s.pushUnique(ue.cartesian,xe)}if($._has=v._hasPlotType.bind($),j.length===W.length)for(Y=0;Y<W.length;Y++)h(W[Y],j[Y]);v.supplyLayoutModuleDefaults(z,$,W,X._transitionData);var ce=$._visibleModules,ge=[];for(Y=0;Y<ce.length;Y++){var we=ce[Y].crossTraceDefaults;we&&s.pushUnique(ge,we)}for(Y=0;Y<ge.length;Y++)ge[Y](W,$);$._hasOnlyLargeSploms=$._basePlotModules.length===1&&$._basePlotModules[0].name==="splom"&&Ee.length>15&&be.length>15&&$.shapes.length===0&&$.images.length===0,v.linkSubplots(W,$,j,H),v.cleanPlot(W,$,j,H);var Me=!(!H._has||!H._has("gl2d")),Se=!(!$._has||!$._has("gl2d")),ze=!(!H._has||!H._has("cartesian"))||Me,Fe=!(!$._has||!$._has("cartesian"))||Se;ze&&!Fe?H._bgLayer.remove():Fe&&!ze&&($._shouldCreateBgLayer=!0),H._zoomlayer&&!X._dragging&&c({_fullLayout:H}),function(je,We){var qe,Qe=[];We.meta&&(qe=We._meta={meta:We.meta,layout:{meta:We.meta}});for(var st=0;st<je.length;st++){var ct=je[st];ct.meta?Qe[ct.index]=ct._meta={meta:ct.meta}:We.meta&&(ct._meta={meta:We.meta}),We.meta&&(ct._meta.layout={meta:We.meta})}Qe.length&&(qe||(qe=We._meta={}),qe.data=Qe)}(W,$),h($,H),e.getComponentMethod("colorscale","crossTraceDefaults")(W,$),$._preGUI||($._preGUI={}),$._tracePreGUI||($._tracePreGUI={});var Ye,rt=$._tracePreGUI,Oe={};for(Ye in rt)Oe[Ye]="old";for(Y=0;Y<W.length;Y++)Oe[Ye=W[Y]._fullInput.uid]||(rt[Ye]={}),Oe[Ye]="new";for(Ye in Oe)Oe[Ye]==="old"&&delete rt[Ye];M($),e.getComponentMethod("rangeslider","makeData")($),Z||J.length!==W.length||v.supplyDefaultsUpdateCalc(J,W)}},v.supplyDefaultsUpdateCalc=function(X,K){for(var Z=0;Z<K.length;Z++){var H=K[Z],Y=(X[Z]||[])[0];if(Y&&Y.trace){var $=Y.trace;if($._hasCalcTransform){var z,j,W,ee=$._arrayAttrs;for(z=0;z<ee.length;z++)j=ee[z],W=s.nestedProperty($,j).get().slice(),s.nestedProperty(H,j).set(W)}Y.trace=H}}},v.createTransitionData=function(X){X._transitionData||(X._transitionData={}),X._transitionData._frames||(X._transitionData._frames=[]),X._transitionData._frameHash||(X._transitionData._frameHash={}),X._transitionData._counter||(X._transitionData._counter=0),X._transitionData._interruptCallbacks||(X._transitionData._interruptCallbacks=[])},v._hasPlotType=function(X){var K,Z=this._basePlotModules||[];for(K=0;K<Z.length;K++)if(Z[K].name===X)return!0;var H=this._modules||[];for(K=0;K<H.length;K++){var Y=H[K].name;if(Y===X)return!0;var $=e.modules[Y];if($&&$.categories[X])return!0}return!1},v.cleanPlot=function(X,K,Z,H){var Y,$,z=H._basePlotModules||[];for(Y=0;Y<z.length;Y++){var j=z[Y];j.clean&&j.clean(X,K,Z,H)}var W=H._has&&H._has("gl"),ee=K._has&&K._has("gl");W&&!ee&&H._glcontainer!==void 0&&(H._glcontainer.selectAll(".gl-canvas").remove(),H._glcontainer.selectAll(".no-webgl").remove(),H._glcanvas=null);var J=!!H._infolayer;e:for(Y=0;Y<Z.length;Y++){var Q=Z[Y].uid;for($=0;$<X.length;$++)if(Q===X[$].uid)continue e;J&&H._infolayer.select(".cb"+Q).remove()}},v.linkSubplots=function(X,K,Z,H){var Y,$,z=H._plots||{},j=K._plots={},W=K._subplots,ee={_fullData:X,_fullLayout:K},J=W.cartesian.concat(W.gl2d||[]);for(Y=0;Y<J.length;Y++){var Q,te=J[Y],ie=z[te],ae=i.getFromId(ee,te,"x"),he=i.getFromId(ee,te,"y");for(ie?Q=j[te]=ie:(Q=j[te]={}).id=te,ae._counterAxes.push(he._id),he._counterAxes.push(ae._id),ae._subplotsWith.push(te),he._subplotsWith.push(te),Q.xaxis=ae,Q.yaxis=he,Q._hasClipOnAxisFalse=!1,$=0;$<X.length;$++){var se=X[$];if(se.xaxis===Q.xaxis._id&&se.yaxis===Q.yaxis._id&&se.cliponaxis===!1){Q._hasClipOnAxisFalse=!0;break}}}var de,ue=i.list(ee,null,!0);for(Y=0;Y<ue.length;Y++){var ve=null;(de=ue[Y]).overlaying&&(ve=i.getFromId(ee,de.overlaying))&&ve.overlaying&&(de.overlaying=!1,ve=null),de._mainAxis=ve||de,ve&&(de.domain=ve.domain.slice()),de._anchorAxis=de.anchor==="free"?null:i.getFromId(ee,de.anchor)}for(Y=0;Y<ue.length;Y++)if((de=ue[Y])._counterAxes.sort(i.idSort),de._subplotsWith.sort(s.subplotSort),de._mainSubplot=w(de,K),de._counterAxes.length&&(de.spikemode&&de.spikemode.indexOf("across")!==-1||de.automargin&&de.mirror&&de.anchor!=="free"||e.getComponentMethod("rangeslider","isVisible")(de))){var ke=1,Ee=0;for($=0;$<de._counterAxes.length;$++){var be=i.getFromId(ee,de._counterAxes[$]);ke=Math.min(ke,be.domain[0]),Ee=Math.max(Ee,be.domain[1])}ke<Ee&&(de._counterDomainMin=ke,de._counterDomainMax=Ee)}},v.clearExpandedTraceDefaultColors=function(X){var K,Z,H;for(Z=[],(K=X._module._colorAttrs)||(X._module._colorAttrs=K=[],f.crawl(X._module.attributes,function(Y,$,z,j){Z[j]=$,Z.length=j+1,Y.valType==="color"&&Y.dflt===void 0&&K.push(Z.join("."))})),H=0;H<K.length;H++)s.nestedProperty(X,"_input."+K[H]).get()||s.nestedProperty(X,K[H]).set(null)},v.supplyDataDefaults=function(X,K,Z,H){var Y,$,z,j=H._modules,W=H._visibleModules,ee=H._basePlotModules,J=0,Q=0;function te(xe){K.push(xe);var ce=xe._module;ce&&(s.pushUnique(j,ce),xe.visible===!0&&s.pushUnique(W,ce),s.pushUnique(ee,xe._module.basePlotModule),J++,xe._input.visible!==!1&&Q++)}H._transformModules=[];var ie={},ae=[],he=(Z.template||{}).data||{},se=u.traceTemplater(he);for(Y=0;Y<X.length;Y++){if(z=X[Y],($=se.newTrace(z)).uid=H._traceUids[Y],v.supplyTraceDefaults(z,$,Q,H,Y),$.index=Y,$._input=z,$._expandedIndex=J,$.transforms&&$.transforms.length)for(var de=z.visible!==!1&&$.visible===!1,ue=k($,K,Z,H),ve=0;ve<ue.length;ve++){var ke=ue[ve],Ee={_template:$._template,type:$.type,uid:$.uid+ve};de&&ke.visible===!1&&delete ke.visible,v.supplyTraceDefaults(ke,Ee,J,H,Y),h(Ee,ke),Ee.index=Y,Ee._input=z,Ee._fullInput=$,Ee._expandedIndex=J,Ee._expandedInput=ke,te(Ee)}else $._fullInput=$,$._expandedInput=$,te($);e.traceIs($,"carpetAxis")&&(ie[$.carpet]=$),e.traceIs($,"carpetDependent")&&ae.push(Y)}for(Y=0;Y<ae.length;Y++)if(($=K[ae[Y]]).visible){var be=ie[$.carpet];$._carpet=be,be&&be.visible?($.xaxis=be.xaxis,$.yaxis=be.yaxis):$.visible=!1}},v.supplyAnimationDefaults=function(X){var K;X=X||{};var Z={};function H(Y,$){return s.coerce(X||{},Z,n,Y,$)}if(H("mode"),H("direction"),H("fromcurrent"),Array.isArray(X.frame))for(Z.frame=[],K=0;K<X.frame.length;K++)Z.frame[K]=v.supplyAnimationFrameDefaults(X.frame[K]||{});else Z.frame=v.supplyAnimationFrameDefaults(X.frame||{});if(Array.isArray(X.transition))for(Z.transition=[],K=0;K<X.transition.length;K++)Z.transition[K]=v.supplyAnimationTransitionDefaults(X.transition[K]||{});else Z.transition=v.supplyAnimationTransitionDefaults(X.transition||{});return Z},v.supplyAnimationFrameDefaults=function(X){var K={};function Z(H,Y){return s.coerce(X||{},K,n.frame,H,Y)}return Z("duration"),Z("redraw"),K},v.supplyAnimationTransitionDefaults=function(X){var K={};function Z(H,Y){return s.coerce(X||{},K,n.transition,H,Y)}return Z("duration"),Z("easing"),K},v.supplyFrameDefaults=function(X){var K={};function Z(H,Y){return s.coerce(X,K,a,H,Y)}return Z("group"),Z("name"),Z("traces"),Z("baseframe"),Z("data"),Z("layout"),K},v.supplyTraceDefaults=function(X,K,Z,H,Y){var $,z=H.colorway||l.defaults,j=z[Z%z.length];function W(ue,ve){return s.coerce(X,K,v.attributes,ue,ve)}var ee=W("visible");W("type"),W("name",H._traceWord+" "+Y),W("uirevision",H.uirevision);var J=v.getModule(K);if(K._module=J,J){var Q=J.basePlotModule,te=Q.attr,ie=Q.attributes;if(te&&ie){var ae=H._subplots,he="";if(ee||Q.name!=="gl2d"){if(Array.isArray(te))for($=0;$<te.length;$++){var se=te[$],de=s.coerce(X,K,ie,se);ae[se]&&s.pushUnique(ae[se],de),he+=de}else he=s.coerce(X,K,ie,te);ae[Q.name]&&s.pushUnique(ae[Q.name],he)}}}return ee&&(W("customdata"),W("ids"),W("meta"),e.traceIs(K,"showLegend")?(s.coerce(X,K,J.attributes.showlegend?J.attributes:v.attributes,"showlegend"),W("legendgroup"),W("legendgrouptitle.text")&&s.coerceFont(W,"legendgrouptitle.font",s.extendFlat({},H.font,{size:Math.round(1.1*H.font.size)})),W("legendrank"),K._dfltShowLegend=!0):K._dfltShowLegend=!1,J&&J.supplyDefaults(X,K,j,H),e.traceIs(K,"noOpacity")||W("opacity"),e.traceIs(K,"notLegendIsolatable")&&(K.visible=!!K.visible),e.traceIs(K,"noHover")||(K.hovertemplate||s.coerceHoverinfo(X,K,H),K.type!=="parcats"&&e.getComponentMethod("fx","supplyDefaults")(X,K,j,H)),J&&J.selectPoints&&W("selectedpoints"),v.supplyTransformDefaults(X,K,H)),K},v.hasMakesDataTransform=C,v.supplyTransformDefaults=function(X,K,Z){if(K._length||C(X)){var H=Z._globalTransforms||[],Y=Z._transformModules||[];if(Array.isArray(X.transforms)||H.length!==0)for(var $=X.transforms||[],z=H.concat($),j=K.transforms=[],W=0;W<z.length;W++){var ee,J=z[W],Q=J.type,te=_[Q],ie=!(J._module&&J._module===te),ae=te&&typeof te.transform=="function";te||s.warn("Unrecognized transform type "+Q+"."),te&&te.supplyDefaults&&(ie||ae)?((ee=te.supplyDefaults(J,K,Z,X)).type=Q,ee._module=te,s.pushUnique(Y,te)):ee=s.extendFlat({},J),j.push(ee)}}},v.supplyLayoutGlobalDefaults=function(X,K,Z){function H(j,W){return s.coerce(X,K,v.layoutAttributes,j,W)}var Y=X.template;s.isPlainObject(Y)&&(K.template=Y,K._template=Y.layout,K._dataTemplate=Y.data),H("autotypenumbers");var $=s.coerceFont(H,"font");H("title.text",K._dfltTitle.plot),s.coerceFont(H,"title.font",{family:$.family,size:Math.round(1.4*$.size),color:$.color}),H("title.xref"),H("title.yref"),H("title.x"),H("title.y"),H("title.xanchor"),H("title.yanchor"),H("title.pad.t"),H("title.pad.r"),H("title.pad.b"),H("title.pad.l"),H("uniformtext.mode")&&H("uniformtext.minsize"),H("autosize",!(X.width&&X.height)),H("width"),H("height"),H("margin.l"),H("margin.r"),H("margin.t"),H("margin.b"),H("margin.pad"),H("margin.autoexpand"),X.width&&X.height&&v.sanitizeMargins(K),e.getComponentMethod("grid","sizeDefaults")(X,K),H("paper_bgcolor"),H("separators",Z.decimal+Z.thousands),H("hidesources"),H("colorway"),H("datarevision");var z=H("uirevision");H("editrevision",z),H("selectionrevision",z),e.getComponentMethod("modebar","supplyLayoutDefaults")(X,K),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(X,K,H),H("meta"),s.isPlainObject(X.transition)&&(H("transition.duration"),H("transition.easing"),H("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(X,K,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(X,K,H)},v.plotAutoSize=function(X,K,Z){var H,Y,$=X._context||{},z=$.frameMargins,j=s.isPlotDiv(X);if(j&&X.emit("plotly_autosize"),$.fillFrame)H=window.innerWidth,Y=window.innerHeight,document.body.style.overflow="hidden";else{var W=j?window.getComputedStyle(X):{};if(H=L(W.width)||L(W.maxWidth)||Z.width,Y=L(W.height)||L(W.maxHeight)||Z.height,p(z)&&z>0){var ee=1-2*z;H=Math.round(ee*H),Y=Math.round(ee*Y)}}var J=v.layoutAttributes.width.min,Q=v.layoutAttributes.height.min;H<J&&(H=J),Y<Q&&(Y=Q);var te=!K.width&&Math.abs(Z.width-H)>1,ie=!K.height&&Math.abs(Z.height-Y)>1;(ie||te)&&(te&&(Z.width=H),ie&&(Z.height=Y)),X._initialAutoSize||(X._initialAutoSize={width:H,height:Y}),v.sanitizeMargins(Z)},v.supplyLayoutModuleDefaults=function(X,K,Z,H){var Y,$,z,j=e.componentsRegistry,W=K._basePlotModules,ee=e.subplotsRegistry.cartesian;for(Y in j)(z=j[Y]).includeBasePlot&&z.includeBasePlot(X,K);for(var J in W.length||W.push(ee),K._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(X,K),ee.finalizeSubplots(X,K)),K._subplots)K._subplots[J].sort(s.subplotSort);for($=0;$<W.length;$++)(z=W[$]).supplyLayoutDefaults&&z.supplyLayoutDefaults(X,K,Z);var Q=K._modules;for($=0;$<Q.length;$++)(z=Q[$]).supplyLayoutDefaults&&z.supplyLayoutDefaults(X,K,Z);var te=K._transformModules;for($=0;$<te.length;$++)(z=te[$]).supplyLayoutDefaults&&z.supplyLayoutDefaults(X,K,Z,H);for(Y in j)(z=j[Y]).supplyLayoutDefaults&&z.supplyLayoutDefaults(X,K,Z)},v.purge=function(X){var K=X._fullLayout||{};K._glcontainer!==void 0&&(K._glcontainer.selectAll(".gl-canvas").remove(),K._glcontainer.remove(),K._glcanvas=null),K._modeBar&&K._modeBar.destroy(),X._transitionData&&(X._transitionData._interruptCallbacks&&(X._transitionData._interruptCallbacks.length=0),X._transitionData._animationRaf&&window.cancelAnimationFrame(X._transitionData._animationRaf)),s.clearThrottle(),s.clearResponsive(X),delete X.data,delete X.layout,delete X._fullData,delete X._fullLayout,delete X.calcdata,delete X.empty,delete X.fid,delete X.undoqueue,delete X.undonum,delete X.autoplay,delete X.changed,delete X._promises,delete X._redrawTimer,delete X._hmlumcount,delete X._hmpixcount,delete X._transitionData,delete X._transitioning,delete X._initialAutoSize,delete X._transitioningWithDuration,delete X._dragging,delete X._dragged,delete X._dragdata,delete X._hoverdata,delete X._snapshotInProgress,delete X._editing,delete X._mouseDownTime,delete X._legendMouseDownTime,X.removeAllListeners&&X.removeAllListeners()},v.style=function(X){var K,Z=X._fullLayout._visibleModules,H=[];for(K=0;K<Z.length;K++){var Y=Z[K];Y.style&&s.pushUnique(H,Y.style)}for(K=0;K<H.length;K++)H[K](X)},v.sanitizeMargins=function(X){if(X&&X.margin){var K,Z=X.width,H=X.height,Y=X.margin,$=Z-(Y.l+Y.r),z=H-(Y.t+Y.b);$<0&&(K=(Z-1)/(Y.l+Y.r),Y.l=Math.floor(K*Y.l),Y.r=Math.floor(K*Y.r)),z<0&&(K=(H-1)/(Y.t+Y.b),Y.t=Math.floor(K*Y.t),Y.b=Math.floor(K*Y.b))}},v.clearAutoMarginIds=function(X){X._fullLayout._pushmarginIds={}},v.allowAutoMargin=function(X,K){X._fullLayout._pushmarginIds[K]=1},v.autoMargin=function(X,K,Z){var H=X._fullLayout,Y=H.width,$=H.height,z=H.margin,j=s.constrain(Y-z.l-z.r,2,64),W=s.constrain($-z.t-z.b,2,64),ee=Math.max(0,Y-j),J=Math.max(0,$-W),Q=H._pushmargin,te=H._pushmarginIds;if(z.autoexpand!==!1){if(Z){var ie=Z.pad;if(ie===void 0&&(ie=Math.min(12,z.l,z.r,z.t,z.b)),ee){var ae=(Z.l+Z.r)/ee;ae>1&&(Z.l/=ae,Z.r/=ae)}if(J){var he=(Z.t+Z.b)/J;he>1&&(Z.t/=he,Z.b/=he)}var se=Z.xl!==void 0?Z.xl:Z.x,de=Z.xr!==void 0?Z.xr:Z.x,ue=Z.yt!==void 0?Z.yt:Z.y,ve=Z.yb!==void 0?Z.yb:Z.y;Q[K]={l:{val:se,size:Z.l+ie},r:{val:de,size:Z.r+ie},b:{val:ve,size:Z.b+ie},t:{val:ue,size:Z.t+ie}},te[K]=1}else delete Q[K],delete te[K];if(!H._replotting)return v.doAutoMargin(X)}},v.doAutoMargin=function(X){var K=X._fullLayout,Z=K.width,H=K.height;K._size||(K._size={}),M(K);var Y=K._size,$=K.margin,z=s.extendFlat({},Y),j=$.l,W=$.r,ee=$.t,J=$.b,Q=K._pushmargin,te=K._pushmarginIds;if(K.margin.autoexpand!==!1){for(var ie in Q)te[ie]||delete Q[ie];for(var ae in Q.base={l:{val:0,size:j},r:{val:1,size:W},t:{val:1,size:ee},b:{val:0,size:J}},Q){var he=Q[ae].l||{},se=Q[ae].b||{},de=he.val,ue=he.size,ve=se.val,ke=se.size;for(var Ee in Q){if(p(ue)&&Q[Ee].r){var be=Q[Ee].r.val,xe=Q[Ee].r.size;if(be>de){var ce=(ue*be+(xe-Z)*de)/(be-de),ge=(xe*(1-de)+(ue-Z)*(1-be))/(be-de);ce+ge>j+W&&(j=ce,W=ge)}}if(p(ke)&&Q[Ee].t){var we=Q[Ee].t.val,Me=Q[Ee].t.size;if(we>ve){var Se=(ke*we+(Me-H)*ve)/(we-ve),ze=(Me*(1-ve)+(ke-H)*(1-we))/(we-ve);Se+ze>J+ee&&(J=Se,ee=ze)}}}}}var Fe=s.constrain(Z-$.l-$.r,2,64),Ye=s.constrain(H-$.t-$.b,2,64),rt=Math.max(0,Z-Fe),Oe=Math.max(0,H-Ye);if(rt){var je=(j+W)/rt;je>1&&(j/=je,W/=je)}if(Oe){var We=(J+ee)/Oe;We>1&&(J/=We,ee/=We)}if(Y.l=Math.round(j),Y.r=Math.round(W),Y.t=Math.round(ee),Y.b=Math.round(J),Y.p=Math.round($.pad),Y.w=Math.round(Z)-Y.l-Y.r,Y.h=Math.round(H)-Y.t-Y.b,!K._replotting&&v.didMarginChange(z,Y)){"_redrawFromAutoMarginCount"in K?K._redrawFromAutoMarginCount++:K._redrawFromAutoMarginCount=1;var qe=3*(1+Object.keys(te).length);if(K._redrawFromAutoMarginCount<qe)return e.call("_doPlot",X);K._size=z,s.warn("Too many auto-margin redraws.")}(function(Qe){var st=i.list(Qe,"",!0);["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(ct){for(var Pt=0;Pt<st.length;Pt++){var kt=st[Pt][ct];kt&&kt()}})})(X)};var P=["l","r","t","b","p","w","h"];function D(X,K,Z){var H=!1,Y=[v.previousPromises,function(){if(X._transitionData)return X._transitioning=!1,function(z){var j=Promise.resolve();if(!z)return j;for(;z.length;)j=j.then(z.shift());return j}(X._transitionData._interruptCallbacks)},Z.prepareFn,v.rehover,function(){return X.emit("plotly_transitioning",[]),new Promise(function(z){X._transitioning=!0,K.duration>0&&(X._transitioningWithDuration=!0),X._transitionData._interruptCallbacks.push(function(){H=!0}),Z.redraw&&X._transitionData._interruptCallbacks.push(function(){return e.call("redraw",X)}),X._transitionData._interruptCallbacks.push(function(){X.emit("plotly_transitioninterrupted",[])});var j=0,W=0;function ee(){return j++,function(){W++,H||W!==j||function(J){!X._transitionData||(function(Q){if(Q)for(;Q.length;)Q.shift()}(X._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(Z.redraw)return e.call("redraw",X)}).then(function(){X._transitioning=!1,X._transitioningWithDuration=!1,X.emit("plotly_transitioned",[])}).then(J))}(z)}}Z.runFn(ee),setTimeout(ee())})}],$=s.syncOrAsync(Y,X);return $&&$.then||($=Promise.resolve()),$.then(function(){return X})}v.didMarginChange=function(X,K){for(var Z=0;Z<P.length;Z++){var H=P[Z],Y=X[H],$=K[H];if(!p(Y)||Math.abs($-Y)>1)return!0}return!1},v.graphJson=function(X,K,Z,H,Y,$){(Y&&K&&!X._fullData||Y&&!K&&!X._fullLayout)&&v.supplyDefaults(X);var z=Y?X._fullData:X.data,j=Y?X._fullLayout:X.layout,W=(X._transitionData||{})._frames;function ee(te,ie){if(typeof te=="function")return ie?"_function_":null;if(s.isPlainObject(te)){var ae,he={};return Object.keys(te).sort().forEach(function(se){if(["_","["].indexOf(se.charAt(0))===-1)if(typeof te[se]!="function"){if(Z==="keepdata"){if(se.substr(se.length-3)==="src")return}else if(Z==="keepstream"){if(typeof(ae=te[se+"src"])=="string"&&ae.indexOf(":")>0&&!s.isPlainObject(te.stream))return}else if(Z!=="keepall"&&typeof(ae=te[se+"src"])=="string"&&ae.indexOf(":")>0)return;he[se]=ee(te[se],ie)}else ie&&(he[se]="_function")}),he}return Array.isArray(te)?te.map(function(se){return ee(se,ie)}):s.isTypedArray(te)?s.simpleMap(te,s.identity):s.isJSDate(te)?s.ms2DateTimeLocal(+te):te}var J={data:(z||[]).map(function(te){var ie=ee(te);return K&&delete ie.fit,ie})};if(!K&&(J.layout=ee(j),Y)){var Q=j._size;J.layout.computed={margin:{b:Q.b,l:Q.l,r:Q.r,t:Q.t}}}return W&&(J.frames=ee(W)),$&&(J.config=ee(X._context,!0)),H==="object"?J:JSON.stringify(J)},v.modifyFrames=function(X,K){var Z,H,Y,$=X._transitionData._frames,z=X._transitionData._frameHash;for(Z=0;Z<K.length;Z++)switch((H=K[Z]).type){case"replace":Y=H.value;var j=($[H.index]||{}).name,W=Y.name;$[H.index]=z[W]=Y,W!==j&&(delete z[j],z[W]=Y);break;case"insert":z[(Y=H.value).name]=Y,$.splice(H.index,0,Y);break;case"delete":delete z[(Y=$[H.index]).name],$.splice(H.index,1)}return Promise.resolve()},v.computeFrame=function(X,K){var Z,H,Y,$,z=X._transitionData._frameHash;if(!K)throw new Error("computeFrame must be given a string frame name");var j=z[K.toString()];if(!j)return!1;for(var W=[j],ee=[j.name];j.baseframe&&(j=z[j.baseframe.toString()])&&ee.indexOf(j.name)===-1;)W.push(j),ee.push(j.name);for(var J={};j=W.pop();)if(j.layout&&(J.layout=v.extendLayout(J.layout,j.layout)),j.data){if(J.data||(J.data=[]),!(H=j.traces))for(H=[],Z=0;Z<j.data.length;Z++)H[Z]=Z;for(J.traces||(J.traces=[]),Z=0;Z<j.data.length;Z++)(Y=H[Z])!=null&&(($=J.traces.indexOf(Y))===-1&&($=J.data.length,J.traces[$]=Y),J.data[$]=v.extendTrace(J.data[$],j.data[Z]))}return J},v.recomputeFrameHash=function(X){for(var K=X._transitionData._frameHash={},Z=X._transitionData._frames,H=0;H<Z.length;H++){var Y=Z[H];Y&&Y.name&&(K[Y.name]=Y)}},v.extendObjectWithContainers=function(X,K,Z){var H,Y,$,z,j,W,ee,J=s.extendDeepNoArrays({},K||{}),Q=s.expandObjectPaths(J),te={};if(Z&&Z.length)for($=0;$<Z.length;$++)(Y=(H=s.nestedProperty(Q,Z[$])).get())===void 0?s.nestedProperty(te,Z[$]).set(null):(H.set(null),s.nestedProperty(te,Z[$]).set(Y));if(X=s.extendDeepNoArrays(X||{},Q),Z&&Z.length){for($=0;$<Z.length;$++)if(W=s.nestedProperty(te,Z[$]).get()){for(ee=(j=s.nestedProperty(X,Z[$])).get(),Array.isArray(ee)||(ee=[],j.set(ee)),z=0;z<W.length;z++){var ie=W[z];ee[z]=ie===null?null:v.extendObjectWithContainers(ee[z],ie)}j.set(ee)}}return X},v.dataArrayContainers=["transforms","dimensions"],v.layoutArrayContainers=e.layoutArrayContainers,v.extendTrace=function(X,K){return v.extendObjectWithContainers(X,K,v.dataArrayContainers)},v.extendLayout=function(X,K){return v.extendObjectWithContainers(X,K,v.layoutArrayContainers)},v.transition=function(X,K,Z,H,Y,$){var z={redraw:Y.redraw},j={},W=[];return z.prepareFn=function(){for(var ee=Array.isArray(K)?K.length:0,J=H.slice(0,ee),Q=0;Q<J.length;Q++){var te=J[Q],ie=X._fullData[te]._module;if(ie){if(ie.animatable){var ae=ie.basePlotModule.name;j[ae]||(j[ae]=[]),j[ae].push(te)}X.data[J[Q]]=v.extendTrace(X.data[J[Q]],K[Q])}}var he=s.expandObjectPaths(s.extendDeepNoArrays({},Z)),se=/^[xy]axis[0-9]*$/;for(var de in he)se.test(de)&&delete he[de].range;v.extendLayout(X.layout,he),delete X.calcdata,v.supplyDefaults(X),v.doCalcdata(X);var ue=s.expandObjectPaths(Z);if(ue){var ve=X._fullLayout._plots;for(var ke in ve){var Ee=ve[ke],be=Ee.xaxis,xe=Ee.yaxis,ce=be.range.slice(),ge=xe.range.slice(),we=null,Me=null,Se=null,ze=null;Array.isArray(ue[be._name+".range"])?we=ue[be._name+".range"].slice():Array.isArray((ue[be._name]||{}).range)&&(we=ue[be._name].range.slice()),Array.isArray(ue[xe._name+".range"])?Me=ue[xe._name+".range"].slice():Array.isArray((ue[xe._name]||{}).range)&&(Me=ue[xe._name].range.slice()),ce&&we&&(be.r2l(ce[0])!==be.r2l(we[0])||be.r2l(ce[1])!==be.r2l(we[1]))&&(Se={xr0:ce,xr1:we}),ge&&Me&&(xe.r2l(ge[0])!==xe.r2l(Me[0])||xe.r2l(ge[1])!==xe.r2l(Me[1]))&&(ze={yr0:ge,yr1:Me}),(Se||ze)&&W.push(s.extendFlat({plotinfo:Ee},Se,ze))}}return Promise.resolve()},z.runFn=function(ee){var J,Q,te=X._fullLayout._basePlotModules,ie=W.length;if(Z)for(Q=0;Q<te.length;Q++)te[Q].transitionAxes&&te[Q].transitionAxes(X,W,$,ee);for(var ae in ie?((J=s.extendFlat({},$)).duration=0,delete j.cartesian):J=$,j){var he=j[ae];X._fullData[he[0]]._module.basePlotModule.plot(X,he,J,ee)}},D(X,$,z)},v.transitionFromReact=function(X,K,Z,H){var Y=X._fullLayout,$=Y.transition,z={},j=[];return z.prepareFn=function(){var W=Y._plots;for(var ee in z.redraw=!1,K.anim==="some"&&(z.redraw=!0),Z.anim==="some"&&(z.redraw=!0),W){var J=W[ee],Q=J.xaxis,te=J.yaxis,ie=H[Q._name].range.slice(),ae=H[te._name].range.slice(),he=Q.range.slice(),se=te.range.slice();Q.setScale(),te.setScale();var de=null,ue=null;Q.r2l(ie[0])===Q.r2l(he[0])&&Q.r2l(ie[1])===Q.r2l(he[1])||(de={xr0:ie,xr1:he}),te.r2l(ae[0])===te.r2l(se[0])&&te.r2l(ae[1])===te.r2l(se[1])||(ue={yr0:ae,yr1:se}),(de||ue)&&j.push(s.extendFlat({plotinfo:J},de,ue))}return Promise.resolve()},z.runFn=function(W){for(var ee,J,Q,te=X._fullData,ie=X._fullLayout._basePlotModules,ae=[],he=0;he<te.length;he++)ae.push(he);function se(){if(X._fullLayout)for(var ue=0;ue<ie.length;ue++)ie[ue].transitionAxes&&ie[ue].transitionAxes(X,j,ee,W)}function de(){if(X._fullLayout)for(var ue=0;ue<ie.length;ue++)ie[ue].plot(X,Q,J,W)}j.length&&K.anim?$.ordering==="traces first"?(ee=s.extendFlat({},$,{duration:0}),Q=ae,J=$,setTimeout(se,$.duration),de()):(ee=$,Q=null,J=s.extendFlat({},$,{duration:0}),setTimeout(de,ee.duration),se()):j.length?(ee=$,se()):K.anim&&(Q=ae,J=$,de())},D(X,$,z)},v.doCalcdata=function(X,K){var Z,H,Y,$,z=i.list(X),j=X._fullData,W=X._fullLayout,ee=new Array(j.length),J=(X.calcdata||[]).slice();for(X.calcdata=ee,W._numBoxes=0,W._numViolins=0,W._violinScaleGroupStats={},X._hmpixcount=0,X._hmlumcount=0,W._piecolormap={},W._sunburstcolormap={},W._treemapcolormap={},W._iciclecolormap={},W._funnelareacolormap={},Y=0;Y<j.length;Y++)Array.isArray(K)&&K.indexOf(Y)===-1&&(ee[Y]=J[Y]);for(Y=0;Y<j.length;Y++)(Z=j[Y])._arrayAttrs=f.findArrayAttributes(Z),Z._extremes={};var Q=W._subplots.polar||[];for(Y=0;Y<Q.length;Y++)z.push(W[Q[Y]].radialaxis,W[Q[Y]].angularaxis);for(var te in W._colorAxes){var ie=W[te];ie.cauto!==!1&&(delete ie.cmin,delete ie.cmax)}var ae=!1;function he(ue){if(Z=j[ue],H=Z._module,Z.visible===!0&&Z.transforms){if(H&&H.calc){var ve=H.calc(X,Z);ve[0]&&ve[0].t&&ve[0].t._scene&&delete ve[0].t._scene.dirty}for($=0;$<Z.transforms.length;$++){var ke=Z.transforms[$];(H=_[ke.type])&&H.calcTransform&&(Z._hasCalcTransform=!0,ae=!0,H.calcTransform(X,Z,ke))}}}function se(ue,ve){if(Z=j[ue],!!(H=Z._module).isContainer===ve){var ke=[];if(Z.visible===!0&&Z._length!==0){delete Z._indexToPoints;var Ee=Z.transforms||[];for($=Ee.length-1;$>=0;$--)if(Ee[$].enabled){Z._indexToPoints=Ee[$]._indexToPoints;break}H&&H.calc&&(ke=H.calc(X,Z))}Array.isArray(ke)&&ke[0]||(ke=[{x:o,y:o}]),ke[0].t||(ke[0].t={}),ke[0].trace=Z,ee[ue]=ke}}for(U(z,j,W),Y=0;Y<j.length;Y++)se(Y,!0);for(Y=0;Y<j.length;Y++)he(Y);for(ae&&U(z,j,W),Y=0;Y<j.length;Y++)se(Y,!0);for(Y=0;Y<j.length;Y++)se(Y,!1);q(X);var de=function(ue,ve){var ke,Ee,be,xe,ce,ge=[];function we(Ke,_e,Ce){var Le=_e._id.charAt(0);if(Ke==="histogram2dcontour"){var Pe=_e._counterAxes[0],Xe=i.getFromId(ve,Pe),ht=Le==="x"||Pe==="x"&&Xe.type==="category",Mt=Le==="y"||Pe==="y"&&Xe.type==="category";return function(pt,Lt){return pt===0||Lt===0||ht&&pt===Ce[Lt].length-1||Mt&&Lt===Ce.length-1?-1:(Le==="y"?Lt:pt)-1}}return function(pt,Lt){return Le==="y"?Lt:pt}}var Me={min:function(Ke){return s.aggNums(Math.min,null,Ke)},max:function(Ke){return s.aggNums(Math.max,null,Ke)},sum:function(Ke){return s.aggNums(function(_e,Ce){return _e+Ce},null,Ke)},total:function(Ke){return s.aggNums(function(_e,Ce){return _e+Ce},null,Ke)},mean:function(Ke){return s.mean(Ke)},median:function(Ke){return s.median(Ke)}};for(ke=0;ke<ue.length;ke++){var Se=ue[ke];if(Se.type==="category"){var ze=Se.categoryorder.match(N);if(ze){var Fe=ze[1],Ye=ze[2],rt=Se._id.charAt(0),Oe=rt==="x",je=[];for(Ee=0;Ee<Se._categories.length;Ee++)je.push([Se._categories[Ee],[]]);for(Ee=0;Ee<Se._traceIndices.length;Ee++){var We=Se._traceIndices[Ee],qe=ve._fullData[We];if(qe.visible===!0){var Qe=qe.type;e.traceIs(qe,"histogram")&&(delete qe._xautoBinFinished,delete qe._yautoBinFinished);var st=Qe==="splom",ct=Qe==="scattergl",Pt=ve.calcdata[We];for(be=0;be<Pt.length;be++){var kt,at,tt=Pt[be];if(st){var _t=qe._axesDim[Se._id];if(!Oe){var er=qe._diag[_t][0];er&&(Se=ve._fullLayout[i.id2name(er)])}var tr=tt.trace.dimensions[_t].values;for(xe=0;xe<tr.length;xe++)for(kt=Se._categoriesMap[tr[xe]],ce=0;ce<tt.trace.dimensions.length;ce++)if(ce!==_t){var Ue=tt.trace.dimensions[ce];je[kt][1].push(Ue.values[xe])}}else if(ct){for(xe=0;xe<tt.t.x.length;xe++)Oe?(kt=tt.t.x[xe],at=tt.t.y[xe]):(kt=tt.t.y[xe],at=tt.t.x[xe]),je[kt][1].push(at);tt.t&&tt.t._scene&&delete tt.t._scene.dirty}else if(tt.hasOwnProperty("z")){at=tt.z;var He=we(qe.type,Se,at);for(xe=0;xe<at.length;xe++)for(ce=0;ce<at[xe].length;ce++)(kt=He(ce,xe))+1&&je[kt][1].push(at[xe][ce])}else for((kt=tt.p)===void 0&&(kt=tt[rt]),(at=tt.s)===void 0&&(at=tt.v),at===void 0&&(at=Oe?tt.y:tt.x),Array.isArray(at)||(at=at===void 0?[]:[at]),xe=0;xe<at.length;xe++)je[kt][1].push(at[xe])}}}Se._categoriesValue=je;var Be=[];for(Ee=0;Ee<je.length;Ee++)Be.push([je[Ee][0],Me[Fe](je[Ee][1])]);Be.sort(function(Ke,_e){return Ke[1]-_e[1]}),Se._categoriesAggregatedValue=Be,Se._initialCategories=Be.map(function(Ke){return Ke[0]}),Ye==="descending"&&Se._initialCategories.reverse(),ge=ge.concat(Se.sortByInitialCategories())}}}return ge}(z,X);if(de.length){for(W._numBoxes=0,W._numViolins=0,Y=0;Y<de.length;Y++)se(de[Y],!0);for(Y=0;Y<de.length;Y++)se(de[Y],!1);q(X)}e.getComponentMethod("fx","calc")(X),e.getComponentMethod("errorbars","calc")(X)};var N=/(total|sum|min|max|mean|median) (ascending|descending)/;function U(X,K,Z){var H={};function Y(W){W.clearCalc(),W.type==="multicategory"&&W.setupMultiCategory(K),H[W._id]=1}s.simpleMap(X,Y);for(var $=Z._axisMatchGroups||[],z=0;z<$.length;z++)for(var j in $[z])H[j]||Y(Z[i.id2name(j)])}function q(X){var K,Z,H,Y=X._fullLayout,$=Y._visibleModules,z={};for(Z=0;Z<$.length;Z++){var j=$[Z],W=j.crossTraceCalc;if(W){var ee=j.basePlotModule.name;z[ee]?s.pushUnique(z[ee],W):z[ee]=[W]}}for(H in z){var J=z[H],Q=Y._subplots[H];if(Array.isArray(Q))for(K=0;K<Q.length;K++){var te=Q[K],ie=H==="cartesian"?Y._plots[te]:Y[te];for(Z=0;Z<J.length;Z++)J[Z](X,ie,te)}else for(Z=0;Z<J.length;Z++)J[Z](X)}}v.rehover=function(X){X._fullLayout._rehover&&X._fullLayout._rehover()},v.redrag=function(X){X._fullLayout._redrag&&X._fullLayout._redrag()},v.generalUpdatePerTraceModule=function(X,K,Z,H){var Y,$=K.traceHash,z={};for(Y=0;Y<Z.length;Y++){var j=Z[Y],W=j[0].trace;W.visible&&(z[W.type]=z[W.type]||[],z[W.type].push(j))}for(var ee in $)if(!z[ee]){var J=$[ee][0];J[0].trace.visible=!1,z[ee]=[J]}for(var Q in z){var te=z[Q];te[0][0].trace._module.plot(X,K,s.filterVisible(te),H)}K.traceHash=z},v.plotBasePlot=function(X,K,Z,H,Y){var $=e.getModule(X),z=g(K.calcdata,$)[0];$.plot(K,z,H,Y)},v.cleanBasePlot=function(X,K,Z,H,Y){var $=Y._has&&Y._has(X),z=Z._has&&Z._has(X);$&&!z&&Y["_"+X+"layer"].selectAll("g.trace").remove()}},{"../components/color":650,"../constants/numerical":763,"../lib":787,"../plot_api/plot_schema":826,"../plot_api/plot_template":827,"../plots/get_data":875,"../registry":915,"./animation_attributes":832,"./attributes":834,"./cartesian/axis_ids":842,"./cartesian/handle_outline":849,"./command":865,"./font_attributes":867,"./frame_attributes":868,"./layout_attributes":892,"@plotly/d3":58,"d3-format":164,"d3-time-format":172,"fast-isnumeric":246}],902:[function(r,O,B){O.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],903:[function(r,O,B){var t=r("../../lib"),d=r("../../lib/polygon").tester,m=t.findIndexOfMin,p=t.isAngleInsideSector,e=t.angleDelta,f=t.angleDist;function u(i,c,n,a){var g,h,y=a[0],v=a[1],_=l(Math.sin(c)-Math.sin(i)),x=l(Math.cos(c)-Math.cos(i)),T=Math.tan(n),A=l(1/T),S=_/x,w=v-S*y;return A?_&&x?h=T*(g=w/(T-S)):x?(g=v*A,h=v):(g=y,h=y*T):_&&x?(g=0,h=w):x?(g=0,h=v):g=h=NaN,[g,h]}function s(i,c,n,a){return t.isFullCircle([c,n])?function(g,h){var y,v=h.length,_=new Array(v+1);for(y=0;y<v;y++){var x=h[y];_[y]=[g*Math.cos(x),g*Math.sin(x)]}return _[y]=_[0].slice(),_}(i,a):function(g,h,y,v){var _,x,T=v.length,A=[];function S(U){return[g*Math.cos(U),g*Math.sin(U)]}function w(U,q,X){return u(U,q,X,S(U))}function C(U){return t.mod(U,T)}function k(U){return p(U,[h,y])}var L=m(v,function(U){return k(U)?f(U,h):1/0}),M=w(v[L],v[C(L-1)],h);for(A.push(M),_=L,x=0;x<T;_++,x++){var P=v[C(_)];if(!k(P))break;A.push(S(P))}var D=m(v,function(U){return k(U)?f(U,y):1/0}),N=w(v[D],v[C(D+1)],y);return A.push(N),A.push([0,0]),A.push(A[0].slice()),A}(i,c,n,a)}function l(i){return Math.abs(i)>1e-10?i:0}function o(i,c,n){c=c||0,n=n||0;for(var a=i.length,g=new Array(a),h=0;h<a;h++){var y=i[h];g[h]=[c+y[0],n-y[1]]}return g}O.exports={isPtInsidePolygon:function(i,c,n,a,g){if(!p(c,a))return!1;var h,y;n[0]<n[1]?(h=n[0],y=n[1]):(h=n[1],y=n[0]);var v=d(s(h,a[0],a[1],g)),_=d(s(y,a[0],a[1],g)),x=[i*Math.cos(c),i*Math.sin(c)];return _.contains(x)&&!v.contains(x)},findPolygonOffset:function(i,c,n,a){for(var g=1/0,h=1/0,y=s(i,c,n,a),v=0;v<y.length;v++){var _=y[v];g=Math.min(g,_[0]),h=Math.min(h,-_[1])}return[g,h]},findEnclosingVertexAngles:function(i,c){var n=m(c,function(g){var h=e(g,i);return h>0?h:1/0}),a=t.mod(n+1,c.length);return[c[n],c[a]]},findIntersectionXY:u,findXYatLength:function(i,c,n,a){var g=-c*n,h=c*c+1,y=2*(c*g-n),v=g*g+n*n-i*i,_=Math.sqrt(y*y-4*h*v),x=(-y+_)/(2*h),T=(-y-_)/(2*h);return[[x,c*x+g+a],[T,c*T+g+a]]},clampTiny:l,pathPolygon:function(i,c,n,a,g,h){return"M"+o(s(i,c,n,a),g,h).join("L")},pathPolygonAnnulus:function(i,c,n,a,g,h,y){var v,_;i<c?(v=i,_=c):(v=c,_=i);var x=o(s(v,n,a,g),h,y);return"M"+o(s(_,n,a,g),h,y).reverse().join("L")+"M"+x.join("L")}}},{"../../lib":787,"../../lib/polygon":799}],904:[function(r,O,B){var t=r("../get_data").getSubplotCalcData,d=r("../../lib").counterRegex,m=r("./polar"),p=r("./constants"),e=p.attr,f=p.name,u=d(f),s={};s[e]={valType:"subplotid",dflt:f,editType:"calc"},O.exports={attr:e,name:f,idRoot:f,idRegex:u,attrRegex:u,attributes:s,layoutAttributes:r("./layout_attributes"),supplyLayoutDefaults:r("./layout_defaults"),plot:function(l){for(var o=l._fullLayout,i=l.calcdata,c=o._subplots[f],n=0;n<c.length;n++){var a=c[n],g=t(i,f,a),h=o[a]._subplot;h||(h=m(l,a),o[a]._subplot=h),h.plot(g,o,l._promises)}},clean:function(l,o,i,c){for(var n=c._subplots[f]||[],a=c._has&&c._has("gl"),g=o._has&&o._has("gl"),h=a&&!g,y=0;y<n.length;y++){var v=n[y],_=c[v]._subplot;if(!o[v]&&_)for(var x in _.framework.remove(),_.layers["radial-axis-title"].remove(),_.clipPaths)_.clipPaths[x].remove();h&&_._scene&&(_._scene.destroy(),_._scene=null)}},toSVG:r("../cartesian").toSVG}},{"../../lib":787,"../cartesian":852,"../get_data":875,"./constants":902,"./layout_attributes":905,"./layout_defaults":906,"./polar":907}],905:[function(r,O,B){var t=r("../../components/color/attributes"),d=r("../cartesian/layout_attributes"),m=r("../domain").attributes,p=r("../../lib").extendFlat,e=r("../../plot_api/edit_types").overrideAll,f=e({color:d.color,showline:p({},d.showline,{dflt:!0}),linecolor:d.linecolor,linewidth:d.linewidth,showgrid:p({},d.showgrid,{dflt:!0}),gridcolor:d.gridcolor,gridwidth:d.gridwidth},"plot","from-root"),u=e({tickmode:d.tickmode,nticks:d.nticks,tick0:d.tick0,dtick:d.dtick,tickvals:d.tickvals,ticktext:d.ticktext,ticks:d.ticks,ticklen:d.ticklen,tickwidth:d.tickwidth,tickcolor:d.tickcolor,showticklabels:d.showticklabels,showtickprefix:d.showtickprefix,tickprefix:d.tickprefix,showticksuffix:d.showticksuffix,ticksuffix:d.ticksuffix,showexponent:d.showexponent,exponentformat:d.exponentformat,minexponent:d.minexponent,separatethousands:d.separatethousands,tickfont:d.tickfont,tickangle:d.tickangle,tickformat:d.tickformat,tickformatstops:d.tickformatstops,layer:d.layer},"plot","from-root"),s={visible:p({},d.visible,{dflt:!0}),type:p({},d.type,{values:["-","linear","log","date","category"]}),autotypenumbers:d.autotypenumbers,autorange:p({},d.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:p({},d.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:d.categoryorder,categoryarray:d.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:p({},d.title.text,{editType:"plot",dflt:""}),font:p({},d.title.font,{editType:"plot"}),editType:"plot"},hoverformat:d.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:d._deprecated.title,titlefont:d._deprecated.titlefont}};p(s,f,u);var l={visible:p({},d.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:d.autotypenumbers,categoryorder:d.categoryorder,categoryarray:d.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:d.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};p(l,f,u),O.exports={domain:m({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:t.background},radialaxis:s,angularaxis:l,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":649,"../../lib":787,"../../plot_api/edit_types":820,"../cartesian/layout_attributes":853,"../domain":866}],906:[function(r,O,B){var t=r("../../lib"),d=r("../../components/color"),m=r("../../plot_api/plot_template"),p=r("../subplot_defaults"),e=r("../get_data").getSubplotData,f=r("../cartesian/tick_value_defaults"),u=r("../cartesian/tick_mark_defaults"),s=r("../cartesian/tick_label_defaults"),l=r("../cartesian/category_order_defaults"),o=r("../cartesian/line_grid_defaults"),i=r("../cartesian/axis_autotype"),c=r("./layout_attributes"),n=r("./set_convert"),a=r("./constants"),g=a.axisNames;function h(v,_,x,T){var A=x("bgcolor");T.bgColor=d.combine(A,T.paper_bgcolor);var S=x("sector");x("hole");var w,C=e(T.fullData,a.name,T.id),k=T.layoutOut;function L($,z){return x(w+"."+$,z)}for(var M=0;M<g.length;M++){w=g[M],t.isPlainObject(v[w])||(v[w]={});var P=v[w],D=m.newContainer(_,w);D._id=D._name=w,D._attr=T.id+"."+w,D._traceIndices=C.map(function($){return $._expandedIndex});var N=a.axisName2dataArray[w],U=y(P,D,L,C,N,T);l(P,D,L,{axData:C,dataAttr:N});var q,X,K=L("visible");switch(n(D,_,k),L("uirevision",_.uirevision),K&&(X=(q=L("color"))===P.color?q:T.font.color),D._m=1,w){case"radialaxis":var Z=L("autorange",!D.isValidRange(P.range));P.autorange=Z,!Z||U!=="linear"&&U!=="-"||L("rangemode"),Z==="reversed"&&(D._m=-1),L("range"),D.cleanRange("range",{dfltRange:[0,1]}),K&&(L("side"),L("angle",S[0]),L("title.text"),t.coerceFont(L,"title.font",{family:T.font.family,size:t.bigFont(T.font.size),color:X}));break;case"angularaxis":if(U==="date"){t.log("Polar plots do not support date angular axes yet.");for(var H=0;H<C.length;H++)C[H].visible=!1;U=P.type=D.type="linear"}L(U==="linear"?"thetaunit":"period");var Y=L("direction");L("rotation",{counterclockwise:0,clockwise:90}[Y])}K&&(f(P,D,L,D.type),s(P,D,L,D.type,{tickSuffixDflt:D.thetaunit==="degrees"?"\xB0":void 0}),u(P,D,L,{outerTicks:!0}),L("showticklabels")&&(t.coerceFont(L,"tickfont",{family:T.font.family,size:T.font.size,color:X}),L("tickangle"),L("tickformat")),o(P,D,L,{dfltColor:q,bgColor:T.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:c[w]}),L("layer")),U!=="category"&&L("hoverformat"),D._input=P}_.angularaxis.type==="category"&&x("gridshape")}function y(v,_,x,T,A,S){var w=x("autotypenumbers",S.autotypenumbersDflt);if(x("type")==="-"){for(var C,k=0;k<T.length;k++)if(T[k].visible){C=T[k];break}C&&C[A]&&(_.type=i(C[A],"gregorian",{noMultiCategory:!0,autotypenumbers:w})),_.type==="-"?_.type="linear":v.type=_.type}return _.type}O.exports=function(v,_,x){p(v,_,x,{type:a.name,attributes:c,handleDefaults:h,font:_.font,autotypenumbersDflt:_.autotypenumbers,paper_bgcolor:_.paper_bgcolor,fullData:x,layoutOut:_})}},{"../../components/color":650,"../../lib":787,"../../plot_api/plot_template":827,"../cartesian/axis_autotype":839,"../cartesian/category_order_defaults":843,"../cartesian/line_grid_defaults":855,"../cartesian/tick_label_defaults":860,"../cartesian/tick_mark_defaults":861,"../cartesian/tick_value_defaults":862,"../get_data":875,"../subplot_defaults":909,"./constants":902,"./layout_attributes":905,"./set_convert":908}],907:[function(r,O,B){var t=r("@plotly/d3"),d=r("tinycolor2"),m=r("../../registry"),p=r("../../lib"),e=p.strRotate,f=p.strTranslate,u=r("../../components/color"),s=r("../../components/drawing"),l=r("../plots"),o=r("../../plots/cartesian/axes"),i=r("../cartesian/set_convert"),c=r("./set_convert"),n=r("../cartesian/autorange").doAutoRange,a=r("../cartesian/dragbox"),g=r("../../components/dragelement"),h=r("../../components/fx"),y=r("../../components/titles"),v=r("../cartesian/select").prepSelect,_=r("../cartesian/select").selectOnClick,x=r("../cartesian/select").clearSelect,T=r("../../lib/setcursor"),A=r("../../lib/clear_gl_canvases"),S=r("../../plot_api/subroutines").redrawReglTraces,w=r("../../constants/alignment").MID_SHIFT,C=r("./constants"),k=r("./helpers"),L=p._,M=p.mod,P=p.deg2rad,D=p.rad2deg;function N(Z,H){this.id=H,this.gd=Z,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var Y=Z._fullLayout,$="clip"+Y._uid+H;this.clipIds.forTraces=$+"-for-traces",this.clipPaths.forTraces=Y._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=Y._polarlayer.append("g").attr("class",H),this.radialTickLayout=null,this.angularTickLayout=null}var U=N.prototype;function q(Z){var H=Z.ticks+String(Z.ticklen)+String(Z.showticklabels);return"side"in Z&&(H+=Z.side),H}function X(Z,H){return H[p.findIndexOfMin(H,function(Y){return p.angleDist(Z,Y)})]}function K(Z,H,Y){return H?(Z.attr("display",null),Z.attr(Y)):Z&&Z.attr("display","none"),Z}O.exports=function(Z,H){return new N(Z,H)},U.plot=function(Z,H){var Y=H[this.id];this._hasClipOnAxisFalse=!1;for(var $=0;$<Z.length;$++)if(Z[$][0].trace.cliponaxis===!1){this._hasClipOnAxisFalse=!0;break}this.updateLayers(H,Y),this.updateLayout(H,Y),l.generalUpdatePerTraceModule(this.gd,this,Z,Y),this.updateFx(H,Y)},U.updateLayers=function(Z,H){var Y=this.layers,$=H.radialaxis,z=H.angularaxis,j=C.layerNames,W=j.indexOf("frontplot"),ee=j.slice(0,W),J=z.layer==="below traces",Q=$.layer==="below traces";J&&ee.push("angular-line"),Q&&ee.push("radial-line"),J&&ee.push("angular-axis"),Q&&ee.push("radial-axis"),ee.push("frontplot"),J||ee.push("angular-line"),Q||ee.push("radial-line"),J||ee.push("angular-axis"),Q||ee.push("radial-axis");var te=this.framework.selectAll(".polarsublayer").data(ee,String);te.enter().append("g").attr("class",function(ie){return"polarsublayer "+ie}).each(function(ie){var ae=Y[ie]=t.select(this);switch(ie){case"frontplot":ae.append("g").classed("barlayer",!0),ae.append("g").classed("scatterlayer",!0);break;case"backplot":ae.append("g").classed("maplayer",!0);break;case"plotbg":Y.bg=ae.append("path");break;case"radial-grid":case"angular-grid":ae.style("fill","none");break;case"radial-line":ae.append("line").style("fill","none");break;case"angular-line":ae.append("path").style("fill","none")}}),te.order()},U.updateLayout=function(Z,H){var Y=this.layers,$=Z._size,z=H.radialaxis,j=H.angularaxis,W=H.domain.x,ee=H.domain.y;this.xOffset=$.l+$.w*W[0],this.yOffset=$.t+$.h*(1-ee[1]);var J=this.xLength=$.w*(W[1]-W[0]),Q=this.yLength=$.h*(ee[1]-ee[0]),te=H.sector;this.sectorInRad=te.map(P);var ie,ae,he,se,de,ue=this.sectorBBox=function(rt){var Oe,je,We,qe,Qe=rt[0],st=rt[1]-Qe,ct=M(Qe,360),Pt=ct+st,kt=Math.cos(P(ct)),at=Math.sin(P(ct)),tt=Math.cos(P(Pt)),_t=Math.sin(P(Pt));return qe=ct<=90&&Pt>=90||ct>90&&Pt>=450?1:at<=0&&_t<=0?0:Math.max(at,_t),Oe=ct<=180&&Pt>=180||ct>180&&Pt>=540?-1:kt>=0&&tt>=0?0:Math.min(kt,tt),je=ct<=270&&Pt>=270||ct>270&&Pt>=630?-1:at>=0&&_t>=0?0:Math.min(at,_t),We=Pt>=360?1:kt<=0&&tt<=0?0:Math.max(kt,tt),[Oe,je,We,qe]}(te),ve=ue[2]-ue[0],ke=ue[3]-ue[1],Ee=Q/J,be=Math.abs(ke/ve);Ee>be?(ie=J,de=(Q-(ae=J*be))/$.h/2,he=[W[0],W[1]],se=[ee[0]+de,ee[1]-de]):(ae=Q,de=(J-(ie=Q/be))/$.w/2,he=[W[0]+de,W[1]-de],se=[ee[0],ee[1]]),this.xLength2=ie,this.yLength2=ae,this.xDomain2=he,this.yDomain2=se;var xe=this.xOffset2=$.l+$.w*he[0],ce=this.yOffset2=$.t+$.h*(1-se[1]),ge=this.radius=ie/ve,we=this.innerRadius=H.hole*ge,Me=this.cx=xe-ge*ue[0],Se=this.cy=ce+ge*ue[3],ze=this.cxx=Me-xe,Fe=this.cyy=Se-ce;this.radialAxis=this.mockAxis(Z,H,z,{_id:"x",side:{counterclockwise:"top",clockwise:"bottom"}[z.side],_realSide:z.side,domain:[we/$.w,ge/$.w]}),this.angularAxis=this.mockAxis(Z,H,j,{side:"right",domain:[0,Math.PI],autorange:!1}),this.doAutoRange(Z,H),this.updateAngularAxis(Z,H),this.updateRadialAxis(Z,H),this.updateRadialAxisTitle(Z,H),this.xaxis=this.mockCartesianAxis(Z,H,{_id:"x",domain:he}),this.yaxis=this.mockCartesianAxis(Z,H,{_id:"y",domain:se});var Ye=this.pathSubplot();this.clipPaths.forTraces.select("path").attr("d",Ye).attr("transform",f(ze,Fe)),Y.frontplot.attr("transform",f(xe,ce)).call(s.setClipUrl,this._hasClipOnAxisFalse?null:this.clipIds.forTraces,this.gd),Y.bg.attr("d",Ye).attr("transform",f(Me,Se)).call(u.fill,H.bgcolor)},U.mockAxis=function(Z,H,Y,$){var z=p.extendFlat({},Y,$);return c(z,H,Z),z},U.mockCartesianAxis=function(Z,H,Y){var $=this,z=Y._id,j=p.extendFlat({type:"linear"},Y);i(j,Z);var W={x:[0,2],y:[1,3]};return j.setRange=function(){var ee=$.sectorBBox,J=W[z],Q=$.radialAxis._rl,te=(Q[1]-Q[0])/(1-H.hole);j.range=[ee[J[0]]*te,ee[J[1]]*te]},j.isPtWithinRange=z==="x"?function(ee){return $.isPtInside(ee)}:function(){return!0},j.setRange(),j.setScale(),j},U.doAutoRange=function(Z,H){var Y=this.gd,$=this.radialAxis,z=H.radialaxis;$.setScale(),n(Y,$);var j=$.range;z.range=j.slice(),z._input.range=j.slice(),$._rl=[$.r2l(j[0],null,"gregorian"),$.r2l(j[1],null,"gregorian")]},U.updateRadialAxis=function(Z,H){var Y=this,$=Y.gd,z=Y.layers,j=Y.radius,W=Y.innerRadius,ee=Y.cx,J=Y.cy,Q=H.radialaxis,te=M(H.sector[0],360),ie=Y.radialAxis,ae=W<j;Y.fillViewInitialKey("radialaxis.angle",Q.angle),Y.fillViewInitialKey("radialaxis.range",ie.range.slice()),ie.setGeometry(),ie.tickangle==="auto"&&te>90&&te<=270&&(ie.tickangle=180);var he=function(xe){return f(ie.l2p(xe.x)+W,0)},se=q(Q);if(Y.radialTickLayout!==se&&(z["radial-axis"].selectAll(".xtick").remove(),Y.radialTickLayout=se),ae){ie.setScale();var de=o.calcTicks(ie),ue=o.clipEnds(ie,de),ve=o.getTickSigns(ie)[2];o.drawTicks($,ie,{vals:de,layer:z["radial-axis"],path:o.makeTickPath(ie,0,ve),transFn:he,crisp:!1}),o.drawGrid($,ie,{vals:ue,layer:z["radial-grid"],path:function(xe){return Y.pathArc(ie.r2p(xe.x)+W)},transFn:p.noop,crisp:!1}),o.drawLabels($,ie,{vals:de,layer:z["radial-axis"],transFn:he,labelFns:o.makeLabelFns(ie,0)})}var ke=Y.radialAxisAngle=Y.vangles?D(X(P(Q.angle),Y.vangles)):Q.angle,Ee=f(ee,J),be=Ee+e(-ke);K(z["radial-axis"],ae&&(Q.showticklabels||Q.ticks),{transform:be}),K(z["radial-grid"],ae&&Q.showgrid,{transform:Ee}),K(z["radial-line"].select("line"),ae&&Q.showline,{x1:W,y1:0,x2:j,y2:0,transform:be}).attr("stroke-width",Q.linewidth).call(u.stroke,Q.linecolor)},U.updateRadialAxisTitle=function(Z,H,Y){var $=this.gd,z=this.radius,j=this.cx,W=this.cy,ee=H.radialaxis,J=this.id+"title",Q=Y!==void 0?Y:this.radialAxisAngle,te=P(Q),ie=Math.cos(te),ae=Math.sin(te),he=0;if(ee.title){var se=s.bBox(this.layers["radial-axis"].node()).height,de=ee.title.font.size;he=ee.side==="counterclockwise"?-se-.4*de:se+.8*de}this.layers["radial-axis-title"]=y.draw($,J,{propContainer:ee,propName:this.id+".radialaxis.title",placeholder:L($,"Click to enter radial axis title"),attributes:{x:j+z/2*ie+he*ae,y:W-z/2*ae+he*ie,"text-anchor":"middle"},transform:{rotate:-Q}})},U.updateAngularAxis=function(Z,H){var Y=this,$=Y.gd,z=Y.layers,j=Y.radius,W=Y.innerRadius,ee=Y.cx,J=Y.cy,Q=H.angularaxis,te=Y.angularAxis;Y.fillViewInitialKey("angularaxis.rotation",Q.rotation),te.setGeometry(),te.setScale();var ie=function(be){return te.t2g(be.x)};te.type==="linear"&&te.thetaunit==="radians"&&(te.tick0=D(te.tick0),te.dtick=D(te.dtick));var ae=function(be){return f(ee+j*Math.cos(be),J-j*Math.sin(be))},he=o.makeLabelFns(te,0).labelStandoff,se={xFn:function(be){var xe=ie(be);return Math.cos(xe)*he},yFn:function(be){var xe=ie(be),ce=Math.sin(xe)>0?.2:1;return-Math.sin(xe)*(he+be.fontSize*ce)+Math.abs(Math.cos(xe))*(be.fontSize*w)},anchorFn:function(be){var xe=ie(be),ce=Math.cos(xe);return Math.abs(ce)<.1?"middle":ce>0?"start":"end"},heightFn:function(be,xe,ce){var ge=ie(be);return-.5*(1+Math.sin(ge))*ce}},de=q(Q);Y.angularTickLayout!==de&&(z["angular-axis"].selectAll("."+te._id+"tick").remove(),Y.angularTickLayout=de);var ue,ve=o.calcTicks(te);if(H.gridshape==="linear"?(ue=ve.map(ie),p.angleDelta(ue[0],ue[1])<0&&(ue=ue.slice().reverse())):ue=null,Y.vangles=ue,te.type==="category"&&(ve=ve.filter(function(be){return p.isAngleInsideSector(ie(be),Y.sectorInRad)})),te.visible){var ke=te.ticks==="inside"?-1:1,Ee=(te.linewidth||1)/2;o.drawTicks($,te,{vals:ve,layer:z["angular-axis"],path:"M"+ke*Ee+",0h"+ke*te.ticklen,transFn:function(be){var xe=ie(be);return ae(xe)+e(-D(xe))},crisp:!1}),o.drawGrid($,te,{vals:ve,layer:z["angular-grid"],path:function(be){var xe=ie(be),ce=Math.cos(xe),ge=Math.sin(xe);return"M"+[ee+W*ce,J-W*ge]+"L"+[ee+j*ce,J-j*ge]},transFn:p.noop,crisp:!1}),o.drawLabels($,te,{vals:ve,layer:z["angular-axis"],repositionOnUpdate:!0,transFn:function(be){return ae(ie(be))},labelFns:se})}K(z["angular-line"].select("path"),Q.showline,{d:Y.pathSubplot(),transform:f(ee,J)}).attr("stroke-width",Q.linewidth).call(u.stroke,Q.linecolor)},U.updateFx=function(Z,H){this.gd._context.staticPlot||(this.updateAngularDrag(Z),this.updateRadialDrag(Z,H,0),this.updateRadialDrag(Z,H,1),this.updateMainDrag(Z))},U.updateMainDrag=function(Z){var H,Y,$=this,z=$.gd,j=$.layers,W=Z._zoomlayer,ee=C.MINZOOM,J=C.OFFEDGE,Q=$.radius,te=$.innerRadius,ie=$.cx,ae=$.cy,he=$.cxx,se=$.cyy,de=$.sectorInRad,ue=$.vangles,ve=$.radialAxis,ke=k.clampTiny,Ee=k.findXYatLength,be=k.findEnclosingVertexAngles,xe=C.cornerHalfWidth,ce=C.cornerLen/2,ge=a.makeDragger(j,"path","maindrag","crosshair");t.select(ge).attr("d",$.pathSubplot()).attr("transform",f(ie,ae));var we,Me,Se,ze,Fe,Ye,rt,Oe,je,We={element:ge,gd:z,subplot:$.id,plotinfo:{id:$.id,xaxis:$.xaxis,yaxis:$.yaxis},xaxes:[$.xaxis],yaxes:[$.yaxis]};function qe(Ke,_e){return Math.sqrt(Ke*Ke+_e*_e)}function Qe(Ke,_e){return qe(Ke-he,_e-se)}function st(Ke,_e){return Math.atan2(se-_e,Ke-he)}function ct(Ke,_e){return[Ke*Math.cos(_e),Ke*Math.sin(-_e)]}function Pt(Ke,_e){if(Ke===0)return $.pathSector(2*xe);var Ce=ce/Ke,Le=_e-Ce,Pe=_e+Ce,Xe=Math.max(0,Math.min(Ke,Q)),ht=Xe-xe,Mt=Xe+xe;return"M"+ct(ht,Le)+"A"+[ht,ht]+" 0,0,0 "+ct(ht,Pe)+"L"+ct(Mt,Pe)+"A"+[Mt,Mt]+" 0,0,1 "+ct(Mt,Le)+"Z"}function kt(Ke,_e,Ce){if(Ke===0)return $.pathSector(2*xe);var Le,Pe,Xe=ct(Ke,_e),ht=ct(Ke,Ce),Mt=ke((Xe[0]+ht[0])/2),pt=ke((Xe[1]+ht[1])/2);if(Mt&&pt){var Lt=pt/Mt,vt=-1/Lt,Dt=Ee(xe,Lt,Mt,pt);Le=Ee(ce,vt,Dt[0][0],Dt[0][1]),Pe=Ee(ce,vt,Dt[1][0],Dt[1][1])}else{var xt,it;pt?(xt=ce,it=xe):(xt=xe,it=ce),Le=[[Mt-xt,pt-it],[Mt+xt,pt-it]],Pe=[[Mt-xt,pt+it],[Mt+xt,pt+it]]}return"M"+Le.join("L")+"L"+Pe.reverse().join("L")+"Z"}function at(Ke,_e){return _e=Math.max(Math.min(_e,Q),te),Ke<J?Ke=0:Q-Ke<J?Ke=Q:_e<J?_e=0:Q-_e<J&&(_e=Q),Math.abs(_e-Ke)>ee?(Ke<_e?(Se=Ke,ze=_e):(Se=_e,ze=Ke),!0):(Se=null,ze=null,!1)}function tt(Ke,_e){Ke=Ke||Fe,_e=_e||"M0,0Z",Oe.attr("d",Ke),je.attr("d",_e),a.transitionZoombox(Oe,je,Ye,rt),Ye=!0;var Ce={};He(Ce),z.emit("plotly_relayouting",Ce)}function _t(Ke,_e){var Ce,Le,Pe=we+(Ke*=H),Xe=Me+(_e*=Y),ht=Qe(we,Me),Mt=Math.min(Qe(Pe,Xe),Q),pt=st(we,Me);at(ht,Mt)&&(Ce=Fe+$.pathSector(ze),Se&&(Ce+=$.pathSector(Se)),Le=Pt(Se,pt)+Pt(ze,pt)),tt(Ce,Le)}function er(Ke,_e,Ce,Le){var Pe=k.findIntersectionXY(Ce,Le,Ce,[Ke-he,se-_e]);return qe(Pe[0],Pe[1])}function tr(Ke,_e){var Ce,Le,Pe=we+Ke,Xe=Me+_e,ht=st(we,Me),Mt=st(Pe,Xe),pt=be(ht,ue),Lt=be(Mt,ue);at(er(we,Me,pt[0],pt[1]),Math.min(er(Pe,Xe,Lt[0],Lt[1]),Q))&&(Ce=Fe+$.pathSector(ze),Se&&(Ce+=$.pathSector(Se)),Le=[kt(Se,pt[0],pt[1]),kt(ze,pt[0],pt[1])].join(" ")),tt(Ce,Le)}function Ue(){if(a.removeZoombox(z),Se!==null&&ze!==null){var Ke={};He(Ke),a.showDoubleClickNotifier(z),m.call("_guiRelayout",z,Ke)}}function He(Ke){var _e=ve._rl,Ce=(_e[1]-_e[0])/(1-te/Q)/Q,Le=[_e[0]+(Se-te)*Ce,_e[0]+(ze-te)*Ce];Ke[$.id+".radialaxis.range"]=Le}function Be(Ke,_e){var Ce=z._fullLayout.clickmode;if(a.removeZoombox(z),Ke===2){var Le={};for(var Pe in $.viewInitial)Le[$.id+"."+Pe]=$.viewInitial[Pe];z.emit("plotly_doubleclick",null),m.call("_guiRelayout",z,Le)}Ce.indexOf("select")>-1&&Ke===1&&_(_e,z,[$.xaxis],[$.yaxis],$.id,We),Ce.indexOf("event")>-1&&h.click(z,_e,$.id)}We.prepFn=function(Ke,_e,Ce){var Le=z._fullLayout.dragmode,Pe=ge.getBoundingClientRect();z._fullLayout._calcInverseTransform(z);var Xe=z._fullLayout._invTransform;H=z._fullLayout._invScaleX,Y=z._fullLayout._invScaleY;var ht=p.apply3DTransform(Xe)(_e-Pe.left,Ce-Pe.top);if(we=ht[0],Me=ht[1],ue){var Mt=k.findPolygonOffset(Q,de[0],de[1],ue);we+=he+Mt[0],Me+=se+Mt[1]}switch(Le){case"zoom":We.moveFn=ue?tr:_t,We.clickFn=Be,We.doneFn=Ue,function(){Se=null,ze=null,Fe=$.pathSubplot(),Ye=!1;var pt=z._fullLayout[$.id];rt=d(pt.bgcolor).getLuminance(),(Oe=a.makeZoombox(W,rt,ie,ae,Fe)).attr("fill-rule","evenodd"),je=a.makeCorners(W,ie,ae),x(z)}();break;case"select":case"lasso":v(Ke,_e,Ce,We,Le)}},ge.onmousemove=function(Ke){h.hover(z,Ke,$.id),z._fullLayout._lasthover=ge,z._fullLayout._hoversubplot=$.id},ge.onmouseout=function(Ke){z._dragging||g.unhover(z,Ke)},g.init(We)},U.updateRadialDrag=function(Z,H,Y){var $=this,z=$.gd,j=$.layers,W=$.radius,ee=$.innerRadius,J=$.cx,Q=$.cy,te=$.radialAxis,ie=C.radialDragBoxSize,ae=ie/2;if(te.visible){var he,se,de,ue=P($.radialAxisAngle),ve=te._rl,ke=ve[0],Ee=ve[1],be=ve[Y],xe=.75*(ve[1]-ve[0])/(1-H.hole)/W;Y?(he=J+(W+ae)*Math.cos(ue),se=Q-(W+ae)*Math.sin(ue),de="radialdrag"):(he=J+(ee-ae)*Math.cos(ue),se=Q-(ee-ae)*Math.sin(ue),de="radialdrag-inner");var ce,ge,we,Me=a.makeRectDragger(j,de,"crosshair",-ae,-ae,ie,ie),Se={element:Me,gd:z};K(t.select(Me),te.visible&&ee<W,{transform:f(he,se)}),Se.prepFn=function(){ce=null,ge=null,we=null,Se.moveFn=ze,Se.doneFn=Fe,x(z)},Se.clampFn=function(Oe,je){return Math.sqrt(Oe*Oe+je*je)<C.MINDRAG&&(Oe=0,je=0),[Oe,je]},g.init(Se)}function ze(Oe,je){if(ce)ce(Oe,je);else{var We=[Oe,-je],qe=[Math.cos(ue),Math.sin(ue)],Qe=Math.abs(p.dot(We,qe)/Math.sqrt(p.dot(We,We)));isNaN(Qe)||(ce=Qe<.5?Ye:rt)}var st={};(function(ct){ge!==null?ct[$.id+".radialaxis.angle"]=ge:we!==null&&(ct[$.id+".radialaxis.range["+Y+"]"]=we)})(st),z.emit("plotly_relayouting",st)}function Fe(){ge!==null?m.call("_guiRelayout",z,$.id+".radialaxis.angle",ge):we!==null&&m.call("_guiRelayout",z,$.id+".radialaxis.range["+Y+"]",we)}function Ye(Oe,je){if(Y!==0){var We=he+Oe,qe=se+je;ge=Math.atan2(Q-qe,We-J),$.vangles&&(ge=X(ge,$.vangles)),ge=D(ge);var Qe=f(J,Q)+e(-ge);j["radial-axis"].attr("transform",Qe),j["radial-line"].select("line").attr("transform",Qe);var st=$.gd._fullLayout,ct=st[$.id];$.updateRadialAxisTitle(st,ct,ge)}}function rt(Oe,je){var We=p.dot([Oe,-je],[Math.cos(ue),Math.sin(ue)]);if(we=be-xe*We,xe>0==(Y?we>ke:we<Ee)){var qe=z._fullLayout,Qe=qe[$.id];te.range[Y]=we,te._rl[Y]=we,$.updateRadialAxis(qe,Qe),$.xaxis.setRange(),$.xaxis.setScale(),$.yaxis.setRange(),$.yaxis.setScale();var st=!1;for(var ct in $.traceHash){var Pt=$.traceHash[ct],kt=p.filterVisible(Pt);Pt[0][0].trace._module.plot(z,$,kt,Qe),m.traceIs(ct,"gl")&&kt.length&&(st=!0)}st&&(A(z),S(z))}else we=null}},U.updateAngularDrag=function(Z){var H=this,Y=H.gd,$=H.layers,z=H.radius,j=H.angularAxis,W=H.cx,ee=H.cy,J=H.cxx,Q=H.cyy,te=C.angularDragBoxSize,ie=a.makeDragger($,"path","angulardrag","move"),ae={element:ie,gd:Y};function he(Se,ze){return Math.atan2(Q+te-ze,Se-J-te)}t.select(ie).attr("d",H.pathAnnulus(z,z+te)).attr("transform",f(W,ee)).call(T,"move");var se,de,ue,ve,ke,Ee,be=$.frontplot.select(".scatterlayer").selectAll(".trace"),xe=be.selectAll(".point"),ce=be.selectAll(".textpoint");function ge(Se,ze){var Fe=H.gd._fullLayout,Ye=Fe[H.id],rt=he(se+Se*Z._invScaleX,de+ze*Z._invScaleY),Oe=D(rt-Ee);if(ve=ue+Oe,$.frontplot.attr("transform",f(H.xOffset2,H.yOffset2)+e([-Oe,J,Q])),H.vangles){ke=H.radialAxisAngle+Oe;var je=f(W,ee)+e(-Oe),We=f(W,ee)+e(-ke);$.bg.attr("transform",je),$["radial-grid"].attr("transform",je),$["radial-axis"].attr("transform",We),$["radial-line"].select("line").attr("transform",We),H.updateRadialAxisTitle(Fe,Ye,ke)}else H.clipPaths.forTraces.select("path").attr("transform",f(J,Q)+e(Oe));xe.each(function(){var kt=t.select(this),at=s.getTranslate(kt);kt.attr("transform",f(at.x,at.y)+e([Oe]))}),ce.each(function(){var kt=t.select(this),at=kt.select("text"),tt=s.getTranslate(kt);kt.attr("transform",e([Oe,at.attr("x"),at.attr("y")])+f(tt.x,tt.y))}),j.rotation=p.modHalf(ve,360),H.updateAngularAxis(Fe,Ye),H._hasClipOnAxisFalse&&!p.isFullCircle(H.sectorInRad)&&be.call(s.hideOutsideRangePoints,H);var qe=!1;for(var Qe in H.traceHash)if(m.traceIs(Qe,"gl")){var st=H.traceHash[Qe],ct=p.filterVisible(st);st[0][0].trace._module.plot(Y,H,ct,Ye),ct.length&&(qe=!0)}qe&&(A(Y),S(Y));var Pt={};we(Pt),Y.emit("plotly_relayouting",Pt)}function we(Se){Se[H.id+".angularaxis.rotation"]=ve,H.vangles&&(Se[H.id+".radialaxis.angle"]=ke)}function Me(){ce.select("text").attr("transform",null);var Se={};we(Se),m.call("_guiRelayout",Y,Se)}ae.prepFn=function(Se,ze,Fe){var Ye=Z[H.id];ue=Ye.angularaxis.rotation;var rt=ie.getBoundingClientRect();se=ze-rt.left,de=Fe-rt.top,Y._fullLayout._calcInverseTransform(Y);var Oe=p.apply3DTransform(Z._invTransform)(se,de);se=Oe[0],de=Oe[1],Ee=he(se,de),ae.moveFn=ge,ae.doneFn=Me,x(Y)},H.vangles&&!p.isFullCircle(H.sectorInRad)&&(ae.prepFn=p.noop,T(t.select(ie),null)),g.init(ae)},U.isPtInside=function(Z){var H=this.sectorInRad,Y=this.vangles,$=this.angularAxis.c2g(Z.theta),z=this.radialAxis,j=z.c2l(Z.r),W=z._rl;return(Y?k.isPtInsidePolygon:p.isPtInsideSector)(j,$,W,H,Y)},U.pathArc=function(Z){var H=this.sectorInRad,Y=this.vangles;return(Y?k.pathPolygon:p.pathArc)(Z,H[0],H[1],Y)},U.pathSector=function(Z){var H=this.sectorInRad,Y=this.vangles;return(Y?k.pathPolygon:p.pathSector)(Z,H[0],H[1],Y)},U.pathAnnulus=function(Z,H){var Y=this.sectorInRad,$=this.vangles;return($?k.pathPolygonAnnulus:p.pathAnnulus)(Z,H,Y[0],Y[1],$)},U.pathSubplot=function(){var Z=this.innerRadius,H=this.radius;return Z?this.pathAnnulus(Z,H):this.pathSector(H)},U.fillViewInitialKey=function(Z,H){Z in this.viewInitial||(this.viewInitial[Z]=H)}},{"../../components/color":650,"../../components/dragelement":669,"../../components/drawing":672,"../../components/fx":690,"../../components/titles":748,"../../constants/alignment":755,"../../lib":787,"../../lib/clear_gl_canvases":771,"../../lib/setcursor":808,"../../plot_api/subroutines":828,"../../plots/cartesian/axes":838,"../../registry":915,"../cartesian/autorange":837,"../cartesian/dragbox":847,"../cartesian/select":858,"../cartesian/set_convert":859,"../plots":901,"./constants":902,"./helpers":903,"./set_convert":908,"@plotly/d3":58,tinycolor2:583}],908:[function(r,O,B){var t=r("../../lib"),d=r("../cartesian/set_convert"),m=t.deg2rad,p=t.rad2deg;O.exports=function(e,f,u){switch(d(e,u),e._id){case"x":case"radialaxis":(function(s,l){var o=l._subplot;s.setGeometry=function(){var i=s._rl[0],c=s._rl[1],n=o.innerRadius,a=(o.radius-n)/(c-i),g=n/a,h=i>c?function(y){return y<=0}:function(y){return y>=0};s.c2g=function(y){var v=s.c2l(y)-i;return(h(v)?v:0)+g},s.g2c=function(y){return s.l2c(y+i-g)},s.g2p=function(y){return y*a},s.c2p=function(y){return s.g2p(s.c2g(y))}}})(e,f);break;case"angularaxis":(function(s,l){var o=s.type;if(o==="linear"){var i=s.d2c,c=s.c2d;s.d2c=function(n,a){return function(g,h){return h==="degrees"?m(g):g}(i(n),a)},s.c2d=function(n,a){return c(function(g,h){return h==="degrees"?p(g):g}(n,a))}}s.makeCalcdata=function(n,a){var g,h,y=n[a],v=n._length,_=function(w){return s.d2c(w,n.thetaunit)};if(y){if(t.isTypedArray(y)&&o==="linear"){if(v===y.length)return y;if(y.subarray)return y.subarray(0,v)}for(g=new Array(v),h=0;h<v;h++)g[h]=_(y[h])}else{var x=a+"0",T="d"+a,A=x in n?_(n[x]):0,S=n[T]?_(n[T]):(s.period||2*Math.PI)/v;for(g=new Array(v),h=0;h<v;h++)g[h]=A+h*S}return g},s.setGeometry=function(){var n,a,g,h,y=l.sector,v=y.map(m),_={clockwise:-1,counterclockwise:1}[s.direction],x=m(s.rotation),T=function(C){return _*C+x},A=function(C){return(C-x)/_};switch(o){case"linear":a=n=t.identity,h=m,g=p,s.range=t.isFullCircle(v)?[y[0],y[0]+360]:v.map(A).map(p);break;case"category":var S=s._categories.length,w=s.period?Math.max(s.period,S):S;w===0&&(w=1),a=h=function(C){return 2*C*Math.PI/w},n=g=function(C){return C*w/Math.PI/2},s.range=[0,w]}s.c2g=function(C){return T(a(C))},s.g2c=function(C){return n(A(C))},s.t2g=function(C){return T(h(C))},s.g2t=function(C){return g(A(C))}}})(e,f)}}},{"../../lib":787,"../cartesian/set_convert":859}],909:[function(r,O,B){var t=r("../lib"),d=r("../plot_api/plot_template"),m=r("./domain").defaults;O.exports=function(p,e,f,u){var s,l,o=u.type,i=u.attributes,c=u.handleDefaults,n=u.partition||"x",a=e._subplots[o],g=a.length,h=g&&a[0].replace(/\d+$/,"");function y(T,A){return t.coerce(s,l,i,T,A)}for(var v=0;v<g;v++){var _=a[v];s=p[_]?p[_]:p[_]={},l=d.newContainer(e,_,h),y("uirevision",e.uirevision);var x={};x[n]=[v/g,(v+1)/g],m(l,e,y,x),u.id=_,c(s,l,y,u)}}},{"../lib":787,"../plot_api/plot_template":827,"./domain":866}],910:[function(r,O,B){var t=r("../constants/docs");t.FORMAT_LINK,t.DATE_FORMAT_LINK;function d(m){var p=m.description?" "+m.description:"",e=m.keys||[];if(e.length>0){for(var f=[],u=0;u<e.length;u++)f[u]="`"+e[u]+"`";p+="Finally, the template string has access to ",p=e.length===1?"variable "+f[0]:"variables "+f.slice(0,-1).join(", ")+" and "+f.slice(-1)+"."}return p}B.hovertemplateAttrs=function(m,p){m=m||{},d(p=p||{});var e={valType:"string",dflt:"",editType:m.editType||"none"};return m.arrayOk!==!1&&(e.arrayOk=!0),e},B.texttemplateAttrs=function(m,p){m=m||{},d(p=p||{});var e={valType:"string",dflt:"",editType:m.editType||"calc"};return m.arrayOk!==!1&&(e.arrayOk=!0),e}},{"../constants/docs":758}],911:[function(r,O,B){var t=r("./ternary"),d=r("../../plots/get_data").getSubplotCalcData,m=r("../../lib").counterRegex;B.name="ternary";var p=B.attr="subplot";B.idRoot="ternary",B.idRegex=B.attrRegex=m("ternary"),(B.attributes={})[p]={valType:"subplotid",dflt:"ternary",editType:"calc"},B.layoutAttributes=r("./layout_attributes"),B.supplyLayoutDefaults=r("./layout_defaults"),B.plot=function(e){for(var f=e._fullLayout,u=e.calcdata,s=f._subplots.ternary,l=0;l<s.length;l++){var o=s[l],i=d(u,"ternary",o),c=f[o]._subplot;c||(c=new t({id:o,graphDiv:e,container:f._ternarylayer.node()},f),f[o]._subplot=c),c.plot(i,f,e._promises)}},B.clean=function(e,f,u,s){for(var l=s._subplots.ternary||[],o=0;o<l.length;o++){var i=l[o],c=s[i]._subplot;!f[i]&&c&&(c.plotContainer.remove(),c.clipDef.remove(),c.clipDefRelative.remove(),c.layers["a-title"].remove(),c.layers["b-title"].remove(),c.layers["c-title"].remove())}}},{"../../lib":787,"../../plots/get_data":875,"./layout_attributes":912,"./layout_defaults":913,"./ternary":914}],912:[function(r,O,B){var t=r("../../components/color/attributes"),d=r("../domain").attributes,m=r("../cartesian/layout_attributes"),p=r("../../plot_api/edit_types").overrideAll,e=r("../../lib/extend").extendFlat,f={title:{text:m.title.text,font:m.title.font},color:m.color,tickmode:m.tickmode,nticks:e({},m.nticks,{dflt:6,min:1}),tick0:m.tick0,dtick:m.dtick,tickvals:m.tickvals,ticktext:m.ticktext,ticks:m.ticks,ticklen:m.ticklen,tickwidth:m.tickwidth,tickcolor:m.tickcolor,showticklabels:m.showticklabels,showtickprefix:m.showtickprefix,tickprefix:m.tickprefix,showticksuffix:m.showticksuffix,ticksuffix:m.ticksuffix,showexponent:m.showexponent,exponentformat:m.exponentformat,minexponent:m.minexponent,separatethousands:m.separatethousands,tickfont:m.tickfont,tickangle:m.tickangle,tickformat:m.tickformat,tickformatstops:m.tickformatstops,hoverformat:m.hoverformat,showline:e({},m.showline,{dflt:!0}),linecolor:m.linecolor,linewidth:m.linewidth,showgrid:e({},m.showgrid,{dflt:!0}),gridcolor:m.gridcolor,gridwidth:m.gridwidth,layer:m.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:m._deprecated.title,titlefont:m._deprecated.titlefont}},u=O.exports=p({domain:d({name:"ternary"}),bgcolor:{valType:"color",dflt:t.background},sum:{valType:"number",dflt:1,min:0},aaxis:f,baxis:f,caxis:f},"plot","from-root");u.uirevision={valType:"any",editType:"none"},u.aaxis.uirevision=u.baxis.uirevision=u.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":649,"../../lib/extend":777,"../../plot_api/edit_types":820,"../cartesian/layout_attributes":853,"../domain":866}],913:[function(r,O,B){var t=r("../../components/color"),d=r("../../plot_api/plot_template"),m=r("../../lib"),p=r("../subplot_defaults"),e=r("../cartesian/tick_label_defaults"),f=r("../cartesian/tick_mark_defaults"),u=r("../cartesian/tick_value_defaults"),s=r("../cartesian/line_grid_defaults"),l=r("./layout_attributes"),o=["aaxis","baxis","caxis"];function i(n,a,g,h){var y,v,_,x=g("bgcolor"),T=g("sum");h.bgColor=t.combine(x,h.paper_bgcolor);for(var A=0;A<o.length;A++)v=n[y=o[A]]||{},(_=d.newContainer(a,y))._name=y,c(v,_,h,a);var S=a.aaxis,w=a.baxis,C=a.caxis;S.min+w.min+C.min>=T&&(S.min=0,w.min=0,C.min=0,n.aaxis&&delete n.aaxis.min,n.baxis&&delete n.baxis.min,n.caxis&&delete n.caxis.min)}function c(n,a,g,h){var y=l[a._name];function v(w,C){return m.coerce(n,a,y,w,C)}v("uirevision",h.uirevision),a.type="linear";var _=v("color"),x=_!==y.color.dflt?_:g.font.color,T=a._name.charAt(0).toUpperCase(),A="Component "+T,S=v("title.text",A);a._hovertitle=S===A?S:T,m.coerceFont(v,"title.font",{family:g.font.family,size:m.bigFont(g.font.size),color:x}),v("min"),u(n,a,v,"linear"),e(n,a,v,"linear",{}),f(n,a,v,{outerTicks:!0}),v("showticklabels")&&(m.coerceFont(v,"tickfont",{family:g.font.family,size:g.font.size,color:x}),v("tickangle"),v("tickformat")),s(n,a,v,{dfltColor:_,bgColor:g.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:y}),v("hoverformat"),v("layer")}O.exports=function(n,a,g){p(n,a,g,{type:"ternary",attributes:l,handleDefaults:i,font:a.font,paper_bgcolor:a.paper_bgcolor})}},{"../../components/color":650,"../../lib":787,"../../plot_api/plot_template":827,"../cartesian/line_grid_defaults":855,"../cartesian/tick_label_defaults":860,"../cartesian/tick_mark_defaults":861,"../cartesian/tick_value_defaults":862,"../subplot_defaults":909,"./layout_attributes":912}],914:[function(r,O,B){var t=r("@plotly/d3"),d=r("tinycolor2"),m=r("../../registry"),p=r("../../lib"),e=p.strTranslate,f=p._,u=r("../../components/color"),s=r("../../components/drawing"),l=r("../cartesian/set_convert"),o=r("../../lib/extend").extendFlat,i=r("../plots"),c=r("../cartesian/axes"),n=r("../../components/dragelement"),a=r("../../components/fx"),g=r("../../components/dragelement/helpers"),h=g.freeMode,y=g.rectMode,v=r("../../components/titles"),_=r("../cartesian/select").prepSelect,x=r("../cartesian/select").selectOnClick,T=r("../cartesian/select").clearSelect,A=r("../cartesian/select").clearSelectionsCache,S=r("../cartesian/constants");function w(q,X){this.id=q.id,this.graphDiv=q.graphDiv,this.init(X),this.makeFramework(X),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}O.exports=w;var C=w.prototype;C.init=function(q){this.container=q._ternarylayer,this.defs=q._defs,this.layoutId=q._uid,this.traceHash={},this.layers={}},C.plot=function(q,X){var K=X[this.id],Z=X._size;this._hasClipOnAxisFalse=!1;for(var H=0;H<q.length;H++)if(q[H][0].trace.cliponaxis===!1){this._hasClipOnAxisFalse=!0;break}this.updateLayers(K),this.adjustLayout(K,Z),i.generalUpdatePerTraceModule(this.graphDiv,this,q,K),this.layers.plotbg.select("path").call(u.fill,K.bgcolor)},C.makeFramework=function(q){var X=this.graphDiv,K=q[this.id],Z=this.clipId="clip"+this.layoutId+this.id,H=this.clipIdRelative="clip-relative"+this.layoutId+this.id;this.clipDef=p.ensureSingleById(q._clips,"clipPath",Z,function(Y){Y.append("path").attr("d","M0,0Z")}),this.clipDefRelative=p.ensureSingleById(q._clips,"clipPath",H,function(Y){Y.append("path").attr("d","M0,0Z")}),this.plotContainer=p.ensureSingle(this.container,"g",this.id),this.updateLayers(K),s.setClipUrl(this.layers.backplot,Z,X),s.setClipUrl(this.layers.grids,Z,X)},C.updateLayers=function(q){var X=this.layers,K=["draglayer","plotbg","backplot","grids"];q.aaxis.layer==="below traces"&&K.push("aaxis","aline"),q.baxis.layer==="below traces"&&K.push("baxis","bline"),q.caxis.layer==="below traces"&&K.push("caxis","cline"),K.push("frontplot"),q.aaxis.layer==="above traces"&&K.push("aaxis","aline"),q.baxis.layer==="above traces"&&K.push("baxis","bline"),q.caxis.layer==="above traces"&&K.push("caxis","cline");var Z=this.plotContainer.selectAll("g.toplevel").data(K,String),H=["agrid","bgrid","cgrid"];Z.enter().append("g").attr("class",function(Y){return"toplevel "+Y}).each(function(Y){var $=t.select(this);X[Y]=$,Y==="frontplot"?$.append("g").classed("scatterlayer",!0):Y==="backplot"?$.append("g").classed("maplayer",!0):Y==="plotbg"?$.append("path").attr("d","M0,0Z"):Y==="aline"||Y==="bline"||Y==="cline"?$.append("path"):Y==="grids"&&H.forEach(function(z){X[z]=$.append("g").classed("grid "+z,!0)})}),Z.order()};var k=Math.sqrt(4/3);C.adjustLayout=function(q,X){var K,Z,H,Y,$,z,j=this,W=q.domain,ee=(W.x[0]+W.x[1])/2,J=(W.y[0]+W.y[1])/2,Q=W.x[1]-W.x[0],te=W.y[1]-W.y[0],ie=Q*X.w,ae=te*X.h,he=q.sum,se=q.aaxis.min,de=q.baxis.min,ue=q.caxis.min;ie>k*ae?H=(Y=ae)*k:Y=(H=ie)/k,$=Q*H/ie,z=te*Y/ae,K=X.l+X.w*ee-H/2,Z=X.t+X.h*(1-J)-Y/2,j.x0=K,j.y0=Z,j.w=H,j.h=Y,j.sum=he,j.xaxis={type:"linear",range:[se+2*ue-he,he-se-2*de],domain:[ee-$/2,ee+$/2],_id:"x"},l(j.xaxis,j.graphDiv._fullLayout),j.xaxis.setScale(),j.xaxis.isPtWithinRange=function(ze){return ze.a>=j.aaxis.range[0]&&ze.a<=j.aaxis.range[1]&&ze.b>=j.baxis.range[1]&&ze.b<=j.baxis.range[0]&&ze.c>=j.caxis.range[1]&&ze.c<=j.caxis.range[0]},j.yaxis={type:"linear",range:[se,he-de-ue],domain:[J-z/2,J+z/2],_id:"y"},l(j.yaxis,j.graphDiv._fullLayout),j.yaxis.setScale(),j.yaxis.isPtWithinRange=function(){return!0};var ve=j.yaxis.domain[0],ke=j.aaxis=o({},q.aaxis,{range:[se,he-de-ue],side:"left",tickangle:(+q.aaxis.tickangle||0)-30,domain:[ve,ve+z*k],anchor:"free",position:0,_id:"y",_length:H});l(ke,j.graphDiv._fullLayout),ke.setScale();var Ee=j.baxis=o({},q.baxis,{range:[he-se-ue,de],side:"bottom",domain:j.xaxis.domain,anchor:"free",position:0,_id:"x",_length:H});l(Ee,j.graphDiv._fullLayout),Ee.setScale();var be=j.caxis=o({},q.caxis,{range:[he-se-de,ue],side:"right",tickangle:(+q.caxis.tickangle||0)+30,domain:[ve,ve+z*k],anchor:"free",position:0,_id:"y",_length:H});l(be,j.graphDiv._fullLayout),be.setScale();var xe="M"+K+","+(Z+Y)+"h"+H+"l-"+H/2+",-"+Y+"Z";j.clipDef.select("path").attr("d",xe),j.layers.plotbg.select("path").attr("d",xe);var ce="M0,"+Y+"h"+H+"l-"+H/2+",-"+Y+"Z";j.clipDefRelative.select("path").attr("d",ce);var ge=e(K,Z);j.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",ge),j.clipDefRelative.select("path").attr("transform",null);var we=e(K-Ee._offset,Z+Y);j.layers.baxis.attr("transform",we),j.layers.bgrid.attr("transform",we);var Me=e(K+H/2,Z)+"rotate(30)"+e(0,-ke._offset);j.layers.aaxis.attr("transform",Me),j.layers.agrid.attr("transform",Me);var Se=e(K+H/2,Z)+"rotate(-30)"+e(0,-be._offset);j.layers.caxis.attr("transform",Se),j.layers.cgrid.attr("transform",Se),j.drawAxes(!0),j.layers.aline.select("path").attr("d",ke.showline?"M"+K+","+(Z+Y)+"l"+H/2+",-"+Y:"M0,0").call(u.stroke,ke.linecolor||"#000").style("stroke-width",(ke.linewidth||0)+"px"),j.layers.bline.select("path").attr("d",Ee.showline?"M"+K+","+(Z+Y)+"h"+H:"M0,0").call(u.stroke,Ee.linecolor||"#000").style("stroke-width",(Ee.linewidth||0)+"px"),j.layers.cline.select("path").attr("d",be.showline?"M"+(K+H/2)+","+Z+"l"+H/2+","+Y:"M0,0").call(u.stroke,be.linecolor||"#000").style("stroke-width",(be.linewidth||0)+"px"),j.graphDiv._context.staticPlot||j.initInteractions(),s.setClipUrl(j.layers.frontplot,j._hasClipOnAxisFalse?null:j.clipId,j.graphDiv)},C.drawAxes=function(q){var X=this.graphDiv,K=this.id.substr(7)+"title",Z=this.layers,H=this.aaxis,Y=this.baxis,$=this.caxis;if(this.drawAx(H),this.drawAx(Y),this.drawAx($),q){var z=Math.max(H.showticklabels?H.tickfont.size/2:0,($.showticklabels?.75*$.tickfont.size:0)+($.ticks==="outside"?.87*$.ticklen:0)),j=(Y.showticklabels?Y.tickfont.size:0)+(Y.ticks==="outside"?Y.ticklen:0)+3;Z["a-title"]=v.draw(X,"a"+K,{propContainer:H,propName:this.id+".aaxis.title",placeholder:f(X,"Click to enter Component A title"),attributes:{x:this.x0+this.w/2,y:this.y0-H.title.font.size/3-z,"text-anchor":"middle"}}),Z["b-title"]=v.draw(X,"b"+K,{propContainer:Y,propName:this.id+".baxis.title",placeholder:f(X,"Click to enter Component B title"),attributes:{x:this.x0-j,y:this.y0+this.h+.83*Y.title.font.size+j,"text-anchor":"middle"}}),Z["c-title"]=v.draw(X,"c"+K,{propContainer:$,propName:this.id+".caxis.title",placeholder:f(X,"Click to enter Component C title"),attributes:{x:this.x0+this.w+j,y:this.y0+this.h+.83*$.title.font.size+j,"text-anchor":"middle"}})}},C.drawAx=function(q){var X,K=this.graphDiv,Z=q._name,H=Z.charAt(0),Y=q._id,$=this.layers[Z],z=H+"tickLayout",j=(X=q).ticks+String(X.ticklen)+String(X.showticklabels);this[z]!==j&&($.selectAll("."+Y+"tick").remove(),this[z]=j),q.setScale();var W=c.calcTicks(q),ee=c.clipEnds(q,W),J=c.makeTransTickFn(q),Q=c.getTickSigns(q)[2],te=p.deg2rad(30),ie=Q*(q.linewidth||1)/2,ae=Q*q.ticklen,he=this.w,se=this.h,de=H==="b"?"M0,"+ie+"l"+Math.sin(te)*ae+","+Math.cos(te)*ae:"M"+ie+",0l"+Math.cos(te)*ae+","+-Math.sin(te)*ae,ue={a:"M0,0l"+se+",-"+he/2,b:"M0,0l-"+he/2+",-"+se,c:"M0,0l-"+se+","+he/2}[H];c.drawTicks(K,q,{vals:q.ticks==="inside"?ee:W,layer:$,path:de,transFn:J,crisp:!1}),c.drawGrid(K,q,{vals:ee,layer:this.layers[H+"grid"],path:ue,transFn:J,crisp:!1}),c.drawLabels(K,q,{vals:W,layer:$,transFn:J,labelFns:c.makeLabelFns(q,0,30)})};var L=S.MINZOOM/2+.87,M="m-0.87,.5h"+L+"v3h-"+(L+5.2)+"l"+(L/2+2.6)+",-"+(.87*L+4.5)+"l2.6,1.5l-"+L/2+","+.87*L+"Z",P="m0.87,.5h-"+L+"v3h"+(L+5.2)+"l-"+(L/2+2.6)+",-"+(.87*L+4.5)+"l-2.6,1.5l"+L/2+","+.87*L+"Z",D="m0,1l"+L/2+","+.87*L+"l2.6,-1.5l-"+(L/2+2.6)+",-"+(.87*L+4.5)+"l-"+(L/2+2.6)+","+(.87*L+4.5)+"l2.6,1.5l"+L/2+",-"+.87*L+"Z",N=!0;function U(q){t.select(q).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}C.clearSelect=function(){A(this.dragOptions),T(this.dragOptions.gd)},C.initInteractions=function(){var q,X,K,Z,H,Y,$,z,j,W,ee,J,Q=this,te=Q.layers.plotbg.select("path").node(),ie=Q.graphDiv,ae=ie._fullLayout._zoomlayer;function he(ce){var ge={};return ge[Q.id+".aaxis.min"]=ce.a,ge[Q.id+".baxis.min"]=ce.b,ge[Q.id+".caxis.min"]=ce.c,ge}function se(ce,ge){var we=ie._fullLayout.clickmode;U(ie),ce===2&&(ie.emit("plotly_doubleclick",null),m.call("_guiRelayout",ie,he({a:0,b:0,c:0}))),we.indexOf("select")>-1&&ce===1&&x(ge,ie,[Q.xaxis],[Q.yaxis],Q.id,Q.dragOptions),we.indexOf("event")>-1&&a.click(ie,ge,Q.id)}function de(ce,ge){return 1-ge/Q.h}function ue(ce,ge){return 1-(ce+(Q.h-ge)/Math.sqrt(3))/Q.w}function ve(ce,ge){return(ce-(Q.h-ge)/Math.sqrt(3))/Q.w}function ke(ce,ge){var we=K+ce*q,Me=Z+ge*X,Se=Math.max(0,Math.min(1,de(0,Z),de(0,Me))),ze=Math.max(0,Math.min(1,ue(K,Z),ue(we,Me))),Fe=Math.max(0,Math.min(1,ve(K,Z),ve(we,Me))),Ye=(Se/2+Fe)*Q.w,rt=(1-Se/2-ze)*Q.w,Oe=(Ye+rt)/2,je=rt-Ye,We=(1-Se)*Q.h,qe=We-je/k;je<S.MINZOOM?($=H,ee.attr("d",j),J.attr("d","M0,0Z")):($={a:H.a+Se*Y,b:H.b+ze*Y,c:H.c+Fe*Y},ee.attr("d",j+"M"+Ye+","+We+"H"+rt+"L"+Oe+","+qe+"L"+Ye+","+We+"Z"),J.attr("d","M"+K+","+Z+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2ZM"+Ye+","+We+M+"M"+rt+","+We+P+"M"+Oe+","+qe+D)),W||(ee.transition().style("fill",z>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),J.transition().style("opacity",1).duration(200),W=!0),ie.emit("plotly_relayouting",he($))}function Ee(){U(ie),$!==H&&(m.call("_guiRelayout",ie,he($)),N&&ie.data&&ie._context.showTips&&(p.notifier(f(ie,"Double-click to zoom back out"),"long"),N=!1))}function be(ce,ge){var we=ce/Q.xaxis._m,Me=ge/Q.yaxis._m,Se=[($={a:H.a-Me,b:H.b+(we+Me)/2,c:H.c-(we-Me)/2}).a,$.b,$.c].sort(p.sorterAsc),ze=Se.indexOf($.a),Fe=Se.indexOf($.b),Ye=Se.indexOf($.c);Se[0]<0&&(Se[1]+Se[0]/2<0?(Se[2]+=Se[0]+Se[1],Se[0]=Se[1]=0):(Se[2]+=Se[0]/2,Se[1]+=Se[0]/2,Se[0]=0),$={a:Se[ze],b:Se[Fe],c:Se[Ye]},ge=(H.a-$.a)*Q.yaxis._m,ce=(H.c-$.c-H.b+$.b)*Q.xaxis._m);var rt=e(Q.x0+ce,Q.y0+ge);Q.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",rt);var Oe=e(-ce,-ge);Q.clipDefRelative.select("path").attr("transform",Oe),Q.aaxis.range=[$.a,Q.sum-$.b-$.c],Q.baxis.range=[Q.sum-$.a-$.c,$.b],Q.caxis.range=[Q.sum-$.a-$.b,$.c],Q.drawAxes(!1),Q._hasClipOnAxisFalse&&Q.plotContainer.select(".scatterlayer").selectAll(".trace").call(s.hideOutsideRangePoints,Q),ie.emit("plotly_relayouting",he($))}function xe(){m.call("_guiRelayout",ie,he($))}this.dragOptions={element:te,gd:ie,plotinfo:{id:Q.id,domain:ie._fullLayout[Q.id].domain,xaxis:Q.xaxis,yaxis:Q.yaxis},subplot:Q.id,prepFn:function(ce,ge,we){Q.dragOptions.xaxes=[Q.xaxis],Q.dragOptions.yaxes=[Q.yaxis],q=ie._fullLayout._invScaleX,X=ie._fullLayout._invScaleY;var Me=Q.dragOptions.dragmode=ie._fullLayout.dragmode;h(Me)?Q.dragOptions.minDrag=1:Q.dragOptions.minDrag=void 0,Me==="zoom"?(Q.dragOptions.moveFn=ke,Q.dragOptions.clickFn=se,Q.dragOptions.doneFn=Ee,function(Se,ze,Fe){var Ye=te.getBoundingClientRect();K=ze-Ye.left,Z=Fe-Ye.top,ie._fullLayout._calcInverseTransform(ie);var rt=ie._fullLayout._invTransform,Oe=p.apply3DTransform(rt)(K,Z);K=Oe[0],Z=Oe[1],H={a:Q.aaxis.range[0],b:Q.baxis.range[1],c:Q.caxis.range[1]},$=H,Y=Q.aaxis.range[1]-H.a,z=d(Q.graphDiv._fullLayout[Q.id].bgcolor).getLuminance(),j="M0,"+Q.h+"L"+Q.w/2+", 0L"+Q.w+","+Q.h+"Z",W=!1,ee=ae.append("path").attr("class","zoombox").attr("transform",e(Q.x0,Q.y0)).style({fill:z>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",j),J=ae.append("path").attr("class","zoombox-corners").attr("transform",e(Q.x0,Q.y0)).style({fill:u.background,stroke:u.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),Q.clearSelect(ie)}(0,ge,we)):Me==="pan"?(Q.dragOptions.moveFn=be,Q.dragOptions.clickFn=se,Q.dragOptions.doneFn=xe,H={a:Q.aaxis.range[0],b:Q.baxis.range[1],c:Q.caxis.range[1]},$=H,Q.clearSelect(ie)):(y(Me)||h(Me))&&_(ce,ge,we,Q.dragOptions,Me)}},te.onmousemove=function(ce){a.hover(ie,ce,Q.id),ie._fullLayout._lasthover=te,ie._fullLayout._hoversubplot=Q.id},te.onmouseout=function(ce){ie._dragging||n.unhover(ie,ce)},n.init(this.dragOptions)}},{"../../components/color":650,"../../components/dragelement":669,"../../components/dragelement/helpers":668,"../../components/drawing":672,"../../components/fx":690,"../../components/titles":748,"../../lib":787,"../../lib/extend":777,"../../registry":915,"../cartesian/axes":838,"../cartesian/constants":845,"../cartesian/select":858,"../cartesian/set_convert":859,"../plots":901,"@plotly/d3":58,tinycolor2:583}],915:[function(r,O,B){var t=r("./lib/loggers"),d=r("./lib/noop"),m=r("./lib/push_unique"),p=r("./lib/is_plain_object"),e=r("./lib/dom").addStyleRule,f=r("./lib/extend"),u=r("./plots/attributes"),s=r("./plots/layout_attributes"),l=f.extendFlat,o=f.extendDeepAll;function i(x){var T=x.name,A=x.categories,S=x.meta;if(B.modules[T])t.log("Type "+T+" already registered");else{B.subplotsRegistry[x.basePlotModule.name]||function(N){var U=N.name;if(B.subplotsRegistry[U])return void t.log("Plot type "+U+" already registered.");for(var q in g(N),B.subplotsRegistry[U]=N,B.componentsRegistry)v(q,N.name)}(x.basePlotModule);for(var w={},C=0;C<A.length;C++)w[A[C]]=!0,B.allCategories[A[C]]=!0;for(var k in B.modules[T]={_module:x,categories:w},S&&Object.keys(S).length&&(B.modules[T].meta=S),B.allTypes.push(T),B.componentsRegistry)h(k,T);x.layoutAttributes&&l(B.traceLayoutAttributes,x.layoutAttributes);var L=x.basePlotModule,M=L.name;if(M==="mapbox"){var P=L.constants.styleRules;for(var D in P)e(".js-plotly-plot .plotly .mapboxgl-"+D,P[D])}M!=="geo"&&M!=="mapbox"||typeof window===void 0||window.PlotlyGeoAssets!==void 0||(window.PlotlyGeoAssets={topojson:{}})}}function c(x){if(typeof x.name!="string")throw new Error("Component module *name* must be a string.");var T=x.name;for(var A in B.componentsRegistry[T]=x,x.layoutAttributes&&(x.layoutAttributes._isLinkedToArray&&m(B.layoutArrayContainers,T),g(x)),B.modules)h(T,A);for(var S in B.subplotsRegistry)v(T,S);for(var w in B.transformsRegistry)y(T,w);x.schema&&x.schema.layout&&o(s,x.schema.layout)}function n(x){if(typeof x.name!="string")throw new Error("Transform module *name* must be a string.");var T="Transform module "+x.name,A=typeof x.transform=="function",S=typeof x.calcTransform=="function";if(!A&&!S)throw new Error(T+" is missing a *transform* or *calcTransform* method.");for(var w in A&&S&&t.log([T+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),p(x.attributes)||t.log(T+" registered without an *attributes* object."),typeof x.supplyDefaults!="function"&&t.log(T+" registered without a *supplyDefaults* method."),B.transformsRegistry[x.name]=x,B.componentsRegistry)y(w,x.name)}function a(x){var T=x.name,A=T.split("-")[0],S=x.dictionary,w=x.format,C=S&&Object.keys(S).length,k=w&&Object.keys(w).length,L=B.localeRegistry,M=L[T];if(M||(L[T]=M={}),A!==T){var P=L[A];P||(L[A]=P={}),C&&P.dictionary===M.dictionary&&(P.dictionary=S),k&&P.format===M.format&&(P.format=w)}C&&(M.dictionary=S),k&&(M.format=w)}function g(x){if(x.layoutAttributes){var T=x.layoutAttributes._arrayAttrRegexps;if(T)for(var A=0;A<T.length;A++)m(B.layoutArrayRegexes,T[A])}}function h(x,T){var A=B.componentsRegistry[x].schema;if(A&&A.traces){var S=A.traces[T];S&&o(B.modules[T]._module.attributes,S)}}function y(x,T){var A=B.componentsRegistry[x].schema;if(A&&A.transforms){var S=A.transforms[T];S&&o(B.transformsRegistry[T].attributes,S)}}function v(x,T){var A=B.componentsRegistry[x].schema;if(A&&A.subplots){var S=B.subplotsRegistry[T],w=S.layoutAttributes,C=S.attr==="subplot"?S.name:S.attr;Array.isArray(C)&&(C=C[0]);var k=A.subplots[C];w&&k&&o(w,k)}}function _(x){return typeof x=="object"&&(x=x.type),x}B.modules={},B.allCategories={},B.allTypes=[],B.subplotsRegistry={},B.transformsRegistry={},B.componentsRegistry={},B.layoutArrayContainers=[],B.layoutArrayRegexes=[],B.traceLayoutAttributes={},B.localeRegistry={},B.apiMethodRegistry={},B.collectableSubplotTypes=null,B.register=function(x){if(B.collectableSubplotTypes=null,!x)throw new Error("No argument passed to Plotly.register.");x&&!Array.isArray(x)&&(x=[x]);for(var T=0;T<x.length;T++){var A=x[T];if(!A)throw new Error("Invalid module was attempted to be registered!");switch(A.moduleType){case"trace":i(A);break;case"transform":n(A);break;case"component":c(A);break;case"locale":a(A);break;case"apiMethod":var S=A.name;B.apiMethodRegistry[S]=A.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},B.getModule=function(x){var T=B.modules[_(x)];return!!T&&T._module},B.traceIs=function(x,T){if((x=_(x))==="various")return!1;var A=B.modules[x];return A||(x&&t.log("Unrecognized trace type "+x+"."),A=B.modules[u.type.dflt]),!!A.categories[T]},B.getTransformIndices=function(x,T){for(var A=[],S=x.transforms||[],w=0;w<S.length;w++)S[w].type===T&&A.push(w);return A},B.hasTransform=function(x,T){for(var A=x.transforms||[],S=0;S<A.length;S++)if(A[S].type===T)return!0;return!1},B.getComponentMethod=function(x,T){var A=B.componentsRegistry[x];return A&&A[T]||d},B.call=function(){var x=arguments[0],T=[].slice.call(arguments,1);return B.apiMethodRegistry[x].apply(null,T)}},{"./lib/dom":775,"./lib/extend":777,"./lib/is_plain_object":788,"./lib/loggers":791,"./lib/noop":796,"./lib/push_unique":802,"./plots/attributes":834,"./plots/layout_attributes":892}],916:[function(r,O,B){var t=r("../registry"),d=r("../lib"),m=d.extendFlat,p=d.extendDeep;function e(f){var u;switch(f){case"themes__thumb":u={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":u={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:u={}}return u}O.exports=function(f,u){var s,l,o=f.data,i=f.layout,c=p([],o),n=p({},i,e(u.tileClass)),a=f._context||{};if(u.width&&(n.width=u.width),u.height&&(n.height=u.height),u.tileClass==="thumbnail"||u.tileClass==="themes__thumb"){n.annotations=[];var g=Object.keys(n);for(s=0;s<g.length;s++)l=g[s],["xaxis","yaxis","zaxis"].indexOf(l.slice(0,5))>-1&&(n[g[s]].title={text:""});for(s=0;s<c.length;s++){var h=c[s];h.showscale=!1,h.marker&&(h.marker.showscale=!1),t.traceIs(h,"pie-like")&&(h.textposition="none")}}if(Array.isArray(u.annotations))for(s=0;s<u.annotations.length;s++)n.annotations.push(u.annotations[s]);var y=Object.keys(n).filter(function(A){return A.match(/^scene\d*$/)});if(y.length){var v={};for(u.tileClass==="thumbnail"&&(v={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),s=0;s<y.length;s++){var _=n[y[s]];_.xaxis||(_.xaxis={}),_.yaxis||(_.yaxis={}),_.zaxis||(_.zaxis={}),m(_.xaxis,v),m(_.yaxis,v),m(_.zaxis,v),_._scene=null}}var x=document.createElement("div");u.tileClass&&(x.className=u.tileClass);var T={gd:x,td:x,layout:n,data:c,config:{staticPlot:u.staticPlot===void 0||u.staticPlot,plotGlPixelRatio:u.plotGlPixelRatio===void 0?2:u.plotGlPixelRatio,displaylogo:u.displaylogo||!1,showLink:u.showLink||!1,showTips:u.showTips||!1,mapboxAccessToken:a.mapboxAccessToken}};return u.setBackground!=="transparent"&&(T.config.setBackground=u.setBackground||"opaque"),T.gd.defaultLayout=e(u.tileClass),T}},{"../lib":787,"../registry":915}],917:[function(r,O,B){var t=r("../lib"),d=r("../plot_api/to_image"),m=r("./filesaver"),p=r("./helpers");O.exports=function(e,f){var u;return t.isPlainObject(e)||(u=t.getGraphDiv(e)),(f=f||{}).format=f.format||"png",f.width=f.width||null,f.height=f.height||null,f.imageDataOnly=!0,new Promise(function(s,l){u&&u._snapshotInProgress&&l(new Error("Snapshotting already in progress.")),t.isIE()&&f.format!=="svg"&&l(new Error(p.MSG_IE_BAD_FORMAT)),u&&(u._snapshotInProgress=!0);var o=d(e,f),i=f.filename||e.fn||"newplot";i+="."+f.format.replace("-","."),o.then(function(c){return u&&(u._snapshotInProgress=!1),m(c,i,f.format)}).then(function(c){s(c)}).catch(function(c){u&&(u._snapshotInProgress=!1),l(c)})})}},{"../lib":787,"../plot_api/to_image":830,"./filesaver":918,"./helpers":919}],918:[function(r,O,B){var t=r("../lib"),d=r("./helpers");O.exports=function(m,p,e){var f=document.createElement("a"),u="download"in f;return new Promise(function(s,l){var o,i;if(t.isIE())return o=d.createBlob(m,"svg"),window.navigator.msSaveBlob(o,p),o=null,s(p);if(u)return o=d.createBlob(m,e),i=d.createObjectURL(o),f.href=i,f.download=p,document.body.appendChild(f),f.click(),document.body.removeChild(f),d.revokeObjectURL(i),o=null,s(p);if(t.isSafari()){var c=e==="svg"?",":";base64,";return d.octetStream(c+encodeURIComponent(m)),s(p)}l(new Error("download error"))})}},{"../lib":787,"./helpers":919}],919:[function(r,O,B){var t=r("../registry");B.getDelay=function(m){return m._has&&(m._has("gl3d")||m._has("gl2d")||m._has("mapbox"))?500:0},B.getRedrawFunc=function(m){return function(){t.getComponentMethod("colorbar","draw")(m)}},B.encodeSVG=function(m){return"data:image/svg+xml,"+encodeURIComponent(m)},B.encodeJSON=function(m){return"data:application/json,"+encodeURIComponent(m)};var d=window.URL||window.webkitURL;B.createObjectURL=function(m){return d.createObjectURL(m)},B.revokeObjectURL=function(m){return d.revokeObjectURL(m)},B.createBlob=function(m,p){if(p==="svg")return new window.Blob([m],{type:"image/svg+xml;charset=utf-8"});if(p==="full-json")return new window.Blob([m],{type:"application/json;charset=utf-8"});var e=function(f){for(var u=f.length,s=new ArrayBuffer(u),l=new Uint8Array(s),o=0;o<u;o++)l[o]=f.charCodeAt(o);return s}(window.atob(m));return new window.Blob([e],{type:"image/"+p})},B.octetStream=function(m){document.location.href="data:application/octet-stream"+m},B.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,B.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":915}],920:[function(r,O,B){var t=r("./helpers"),d={getDelay:t.getDelay,getRedrawFunc:t.getRedrawFunc,clone:r("./cloneplot"),toSVG:r("./tosvg"),svgToImg:r("./svgtoimg"),toImage:r("./toimage"),downloadImage:r("./download")};O.exports=d},{"./cloneplot":916,"./download":917,"./helpers":919,"./svgtoimg":921,"./toimage":922,"./tosvg":923}],921:[function(r,O,B){var t=r("../lib"),d=r("events").EventEmitter,m=r("./helpers");O.exports=function(p){var e=p.emitter||new d,f=new Promise(function(u,s){var l=window.Image,o=p.svg,i=p.format||"png";if(t.isIE()&&i!=="svg"){var c=new Error(m.MSG_IE_BAD_FORMAT);return s(c),p.promise?f:e.emit("error",c)}var n,a,g=p.canvas,h=p.scale||1,y=p.width||300,v=p.height||150,_=h*y,x=h*v,T=g.getContext("2d"),A=new l;i==="svg"||t.isSafari()?a=m.encodeSVG(o):(n=m.createBlob(o,"svg"),a=m.createObjectURL(n)),g.width=_,g.height=x,A.onload=function(){var S;switch(n=null,m.revokeObjectURL(a),i!=="svg"&&T.drawImage(A,0,0,_,x),i){case"jpeg":S=g.toDataURL("image/jpeg");break;case"png":S=g.toDataURL("image/png");break;case"webp":S=g.toDataURL("image/webp");break;case"svg":S=a;break;default:var w="Image format is not jpeg, png, svg or webp.";if(s(new Error(w)),!p.promise)return e.emit("error",w)}u(S),p.promise||e.emit("success",S)},A.onerror=function(S){if(n=null,m.revokeObjectURL(a),s(S),!p.promise)return e.emit("error",S)},A.src=a});return p.promise?f:e}},{"../lib":787,"./helpers":919,events:116}],922:[function(r,O,B){var t=r("events").EventEmitter,d=r("../registry"),m=r("../lib"),p=r("./helpers"),e=r("./cloneplot"),f=r("./tosvg"),u=r("./svgtoimg");O.exports=function(s,l){var o=new t,i=e(s,{format:"png"}),c=i.gd;c.style.position="absolute",c.style.left="-5000px",document.body.appendChild(c);var n=p.getRedrawFunc(c);return d.call("_doPlot",c,i.data,i.layout,i.config).then(n).then(function(){var a=p.getDelay(c._fullLayout);setTimeout(function(){var g=f(c),h=document.createElement("canvas");h.id=m.randstr(),(o=u({format:l.format,width:c._fullLayout.width,height:c._fullLayout.height,canvas:h,emitter:o,svg:g})).clean=function(){c&&document.body.removeChild(c)}},a)}).catch(function(a){o.emit("error",a)}),o}},{"../lib":787,"../registry":915,"./cloneplot":916,"./helpers":919,"./svgtoimg":921,"./tosvg":923,events:116}],923:[function(r,O,B){var t=r("@plotly/d3"),d=r("../lib"),m=r("../components/drawing"),p=r("../components/color"),e=r("../constants/xmlns_namespaces"),f=/"/g,u=new RegExp('("TOBESTRIPPED)|(TOBESTRIPPED")',"g");O.exports=function(s,l,o){var i,c,n=s._fullLayout,a=n._paper,g=n._toppaper,h=n.width,y=n.height;a.insert("rect",":first-child").call(m.setRect,0,0,h,y).call(p.fill,n.paper_bgcolor);var v=n._basePlotModules||[];for(i=0;i<v.length;i++){var _=v[i];_.toSVG&&_.toSVG(s)}if(g){var x=g.node().childNodes,T=Array.prototype.slice.call(x);for(i=0;i<T.length;i++){var A=T[i];A.childNodes.length&&a.node().appendChild(A)}}n._draggers&&n._draggers.remove(),a.node().style.background="",a.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var C=t.select(this);if(this.style.visibility!=="hidden"&&this.style.display!=="none"){C.style({visibility:null,display:null});var k=this.style.fontFamily;k&&k.indexOf('"')!==-1&&C.style("font-family",k.replace(f,"TOBESTRIPPED"))}else C.remove()});var S=[];if(n._gradientUrlQueryParts)for(c in n._gradientUrlQueryParts)S.push(c);if(n._patternUrlQueryParts)for(c in n._patternUrlQueryParts)S.push(c);S.length&&a.selectAll(S.join(",")).each(function(){var C=t.select(this),k=this.style.fill;k&&k.indexOf("url(")!==-1&&C.style("fill",k.replace(f,"TOBESTRIPPED"));var L=this.style.stroke;L&&L.indexOf("url(")!==-1&&C.style("stroke",L.replace(f,"TOBESTRIPPED"))}),l!=="pdf"&&l!=="eps"||a.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),a.node().setAttributeNS(e.xmlns,"xmlns",e.svg),a.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),l==="svg"&&o&&(a.attr("width",o*h),a.attr("height",o*y),a.attr("viewBox","0 0 "+h+" "+y));var w=new window.XMLSerializer().serializeToString(a.node());return w=function(C){var k=t.select("body").append("div").style({display:"none"}).html(""),L=C.replace(/(&[^;]*;)/gi,function(M){return M==="&lt;"?"&#60;":M==="&rt;"?"&#62;":M.indexOf("<")!==-1||M.indexOf(">")!==-1?"":k.html(M).text()});return k.remove(),L}(w),w=(w=w.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")).replace(u,"'"),d.isIE()&&(w=(w=(w=w.replace(/"/gi,"'")).replace(/(\('#)([^']*)('\))/gi,'("#$2")')).replace(/(\\')/gi,'"')),w}},{"../components/color":650,"../components/drawing":672,"../constants/xmlns_namespaces":764,"../lib":787,"@plotly/d3":58}],924:[function(r,O,B){var t=r("../../lib");O.exports=function(d,m){for(var p=0;p<d.length;p++)d[p].i=p;t.mergeArray(m.text,d,"tx"),t.mergeArray(m.hovertext,d,"htx");var e=m.marker;if(e){t.mergeArray(e.opacity,d,"mo",!0),t.mergeArray(e.color,d,"mc");var f=e.line;f&&(t.mergeArray(f.color,d,"mlc"),t.mergeArrayCastPositive(f.width,d,"mlw"))}}},{"../../lib":787}],925:[function(r,O,B){var t=r("../scatter/attributes"),d=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=r("../../plots/template_attributes").hovertemplateAttrs,p=r("../../plots/template_attributes").texttemplateAttrs,e=r("../../components/colorscale/attributes"),f=r("../../plots/font_attributes"),u=r("./constants"),s=r("../../components/drawing/attributes").pattern,l=r("../../lib/extend").extendFlat,o=f({editType:"calc",arrayOk:!0,colorEditType:"style"}),i=l({},t.marker.line.width,{dflt:0}),c=l({width:i,editType:"calc"},e("marker.line")),n=l({line:c,editType:"calc"},e("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:s});O.exports={x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,xhoverformat:d("x"),yhoverformat:d("y"),text:t.text,texttemplate:p({editType:"plot"},{keys:u.eventDataKeys}),hovertext:t.hovertext,hovertemplate:m({},{keys:u.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:l({},o,{}),insidetextfont:l({},o,{}),outsidetextfont:l({},o,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:l({},t.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:n,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:t.selected.marker.opacity,color:t.selected.marker.color,editType:"style"},textfont:t.selected.textfont,editType:"style"},unselected:{marker:{opacity:t.unselected.marker.opacity,color:t.unselected.marker.color,editType:"style"},textfont:t.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":657,"../../components/drawing/attributes":671,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/font_attributes":867,"../../plots/template_attributes":910,"../scatter/attributes":1202,"./constants":927}],926:[function(r,O,B){var t=r("../../plots/cartesian/axes"),d=r("../../plots/cartesian/align_period"),m=r("../../components/colorscale/helpers").hasColorscale,p=r("../../components/colorscale/calc"),e=r("./arrays_to_calcdata"),f=r("../scatter/calc_selection");O.exports=function(u,s){var l,o,i,c,n,a,g=t.getFromId(u,s.xaxis||"x"),h=t.getFromId(u,s.yaxis||"y"),y={msUTC:!(!s.base&&s.base!==0)};s.orientation==="h"?(l=g.makeCalcdata(s,"x",y),i=h.makeCalcdata(s,"y"),c=d(s,h,"y",i),n=!!s.yperiodalignment,a="y"):(l=h.makeCalcdata(s,"y",y),i=g.makeCalcdata(s,"x"),c=d(s,g,"x",i),n=!!s.xperiodalignment,a="x"),o=c.vals;for(var v=Math.min(o.length,l.length),_=new Array(v),x=0;x<v;x++)_[x]={p:o[x],s:l[x]},n&&(_[x].orig_p=i[x],_[x][a+"End"]=c.ends[x],_[x][a+"Start"]=c.starts[x]),s.ids&&(_[x].id=String(s.ids[x]));return m(s,"marker")&&p(u,s,{vals:s.marker.color,containerStr:"marker",cLetter:"c"}),m(s,"marker.line")&&p(u,s,{vals:s.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(_,s),f(_,s),_}},{"../../components/colorscale/calc":658,"../../components/colorscale/helpers":661,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../scatter/calc_selection":1204,"./arrays_to_calcdata":924}],927:[function(r,O,B){O.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],928:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib").isArrayOrTypedArray,m=r("../../constants/numerical").BADNUM,p=r("../../registry"),e=r("../../plots/cartesian/axes"),f=r("../../plots/cartesian/constraints").getAxisGroup,u=r("./sieve.js");function s(v,_,x,T,A){if(T.length){var S,w,C,k;switch(function(L,M){var P,D;for(P=0;P<M.length;P++){var N,U=M[P],q=U[0].trace,X=q.type==="funnel"?q._base:q.base,K=q.orientation==="h"?q.xcalendar:q.ycalendar,Z=L.type==="category"||L.type==="multicategory"?function(){return null}:L.d2c;if(d(X)){for(D=0;D<Math.min(X.length,U.length);D++)N=Z(X[D],0,K),t(N)?(U[D].b=+N,U[D].hasB=1):U[D].b=0;for(;D<U.length;D++)U[D].b=0}else{N=Z(X,0,K);var H=t(N);for(N=H?N:0,D=0;D<U.length;D++)U[D].b=N,H&&(U[D].hasB=1)}}}(x,T),A.mode){case"overlay":l(_,x,T,A);break;case"group":for(S=[],w=[],C=0;C<T.length;C++)(k=T[C])[0].trace.offset===void 0?w.push(k):S.push(k);w.length&&function(L,M,P,D,N){var U=new u(D,{posAxis:M,sepNegVal:!1,overlapNoMerge:!N.norm});(function(q,X,K,Z){for(var H=q._fullLayout,Y=K.positions,$=K.distinctPositions,z=K.minDiff,j=K.traces,W=j.length,ee=Y.length!==$.length,J=z*(1-Z.gap),Q=f(H,X._id)+j[0][0].trace.orientation,te=H._alignmentOpts[Q]||{},ie=0;ie<W;ie++){var ae,he,se=j[ie],de=se[0].trace,ue=te[de.alignmentgroup]||{},ve=Object.keys(ue.offsetGroups||{}).length,ke=(ae=ve?J/ve:ee?J/W:J)*(1-(Z.groupgap||0));he=ve?((2*de._offsetIndex+1-ve)*ae-ke)/2:ee?((2*ie+1-W)*ae-ke)/2:-ke/2;var Ee=se[0].t;Ee.barwidth=ke,Ee.poffset=he,Ee.bargroupwidth=J,Ee.bardelta=z}K.binWidth=j[0][0].t.barwidth/100,i(K),c(X,K),n(X,K,ee)})(L,M,U,N),function(q,X){for(var K=q.traces,Z=0;Z<K.length;Z++){var H=K[Z];if(H[0].trace.base===void 0)for(var Y=new u([H],{posAxis:X,sepNegVal:!0,overlapNoMerge:!0}),$=0;$<H.length;$++){var z=H[$];if(z.p!==m){var j=Y.put(z.p,z.b+z.s);j&&(z.b=j)}}}}(U,M),N.norm?(g(U),h(P,U,N)):a(P,U)}(v,_,x,w,A),S.length&&l(_,x,S,A);break;case"stack":case"relative":for(S=[],w=[],C=0;C<T.length;C++)(k=T[C])[0].trace.base===void 0?w.push(k):S.push(k);w.length&&function(L,M,P,D,N){var U=new u(D,{posAxis:M,sepNegVal:N.mode==="relative",overlapNoMerge:!(N.norm||N.mode==="stack"||N.mode==="relative")});o(M,U,N),function(H,Y,$){var z,j,W,ee,J,Q,te=y(H),ie=Y.traces;for(ee=0;ee<ie.length;ee++)if(z=ie[ee],(j=z[0].trace).type==="funnel")for(J=0;J<z.length;J++)(Q=z[J]).s!==m&&Y.put(Q.p,-.5*Q.s);for(ee=0;ee<ie.length;ee++){z=ie[ee],j=z[0].trace,W=j.type==="funnel";var ae=[];for(J=0;J<z.length;J++)if((Q=z[J]).s!==m){var he;he=W?Q.s:Q.s+Q.b;var se=Y.put(Q.p,he),de=se+he;Q.b=se,Q[te]=de,$.norm||(ae.push(de),Q.hasB&&ae.push(se))}$.norm||(j._extremes[H._id]=e.findExtremes(H,ae,{tozero:!0,padded:!0}))}}(P,U,N);for(var q=0;q<D.length;q++)for(var X=D[q],K=0;K<X.length;K++){var Z=X[K];Z.s!==m&&Z.b+Z.s===U.get(Z.p,Z.s)&&(Z._outmost=!0)}N.norm&&h(P,U,N)}(0,_,x,w,A),S.length&&l(_,x,S,A)}(function(L,M){var P,D,N,U=y(M),q={},X=1/0,K=-1/0;for(P=0;P<L.length;P++)for(N=L[P],D=0;D<N.length;D++){var Z=N[D].p;t(Z)&&(X=Math.min(X,Z),K=Math.max(K,Z))}var H=1e4/(K-X),Y=q.round=function(Q){return String(Math.round(H*(Q-X)))};for(P=0;P<L.length;P++){(N=L[P])[0].t.extents=q;var $=N[0].t.poffset,z=Array.isArray($);for(D=0;D<N.length;D++){var j=N[D],W=j[U]-j.w/2;if(t(W)){var ee=j[U]+j.w/2,J=Y(j.p);q[J]?q[J]=[Math.min(W,q[J][0]),Math.max(ee,q[J][1])]:q[J]=[W,ee]}j.p0=j.p+(z?$[D]:$),j.p1=j.p0+j.w,j.s0=j.b,j.s1=j.s0+j.s}}})(T,_)}}function l(v,_,x,T){for(var A=0;A<x.length;A++){var S=x[A],w=new u([S],{posAxis:v,sepNegVal:!1,overlapNoMerge:!T.norm});o(v,w,T),T.norm?(g(w),h(_,w,T)):a(_,w)}}function o(v,_,x){for(var T=_.minDiff,A=_.traces,S=T*(1-x.gap),w=S*(1-(x.groupgap||0)),C=-w/2,k=0;k<A.length;k++){var L=A[k][0].t;L.barwidth=w,L.poffset=C,L.bargroupwidth=S,L.bardelta=T}_.binWidth=A[0][0].t.barwidth/100,i(_),c(v,_),n(v,_)}function i(v){var _,x,T=v.traces;for(_=0;_<T.length;_++){var A,S=T[_],w=S[0],C=w.trace,k=w.t,L=C._offset||C.offset,M=k.poffset;if(d(L)){for(A=Array.prototype.slice.call(L,0,S.length),x=0;x<A.length;x++)t(A[x])||(A[x]=M);for(x=A.length;x<S.length;x++)A.push(M);k.poffset=A}else L!==void 0&&(k.poffset=L);var P=C._width||C.width,D=k.barwidth;if(d(P)){var N=Array.prototype.slice.call(P,0,S.length);for(x=0;x<N.length;x++)t(N[x])||(N[x]=D);for(x=N.length;x<S.length;x++)N.push(D);if(k.barwidth=N,L===void 0){for(A=[],x=0;x<S.length;x++)A.push(M+(D-N[x])/2);k.poffset=A}}else P!==void 0&&(k.barwidth=P,L===void 0&&(k.poffset=M+(D-P)/2))}}function c(v,_){for(var x=_.traces,T=y(v),A=0;A<x.length;A++)for(var S=x[A],w=S[0].t,C=w.poffset,k=Array.isArray(C),L=w.barwidth,M=Array.isArray(L),P=0;P<S.length;P++){var D=S[P],N=D.w=M?L[P]:L;D[T]=D.p+(k?C[P]:C)+N/2}}function n(v,_,x){var T=_.traces,A=_.minDiff/2;e.minDtick(v,_.minDiff,_.distinctPositions[0],x);for(var S=0;S<T.length;S++){var w,C,k,L,M=T[S],P=M[0],D=P.trace,N=[];for(L=0;L<M.length;L++)C=(w=M[L]).p-A,k=w.p+A,N.push(C,k);if(D.width||D.offset){var U=P.t,q=U.poffset,X=U.barwidth,K=Array.isArray(q),Z=Array.isArray(X);for(L=0;L<M.length;L++){w=M[L];var H=K?q[L]:q,Y=Z?X[L]:X;k=(C=w.p+H)+Y,N.push(C,k)}}D._extremes[v._id]=e.findExtremes(v,N,{padded:!1})}}function a(v,_){for(var x=_.traces,T=y(v),A=0;A<x.length;A++){for(var S=x[A],w=S[0].trace,C=[],k=!1,L=0;L<S.length;L++){var M=S[L],P=M.b,D=P+M.s;M[T]=D,C.push(D),M.hasB&&C.push(P),M.hasB&&M.b||(k=!0)}w._extremes[v._id]=e.findExtremes(v,C,{tozero:k,padded:!0})}}function g(v){for(var _=v.traces,x=0;x<_.length;x++)for(var T=_[x],A=0;A<T.length;A++){var S=T[A];S.s!==m&&v.put(S.p,S.b+S.s)}}function h(v,_,x){var T=_.traces,A=y(v),S=x.norm==="fraction"?1:100,w=S/1e9,C=v.l2c(v.c2l(0)),k=x.mode==="stack"?S:C;function L($){return t(v.c2l($))&&($<C-w||$>k+w||!t(C))}for(var M=0;M<T.length;M++){for(var P=T[M],D=P[0].trace,N=[],U=!1,q=!1,X=0;X<P.length;X++){var K=P[X];if(K.s!==m){var Z=Math.abs(S/_.get(K.p,K.s));K.b*=Z,K.s*=Z;var H=K.b,Y=H+K.s;K[A]=Y,N.push(Y),q=q||L(Y),K.hasB&&(N.push(H),q=q||L(H)),K.hasB&&K.b||(U=!0)}}D._extremes[v._id]=e.findExtremes(v,N,{tozero:U,padded:q})}}function y(v){return v._id.charAt(0)}O.exports={crossTraceCalc:function(v,_){for(var x=_.xaxis,T=_.yaxis,A=v._fullLayout,S=v._fullData,w=v.calcdata,C=[],k=[],L=0;L<S.length;L++){var M=S[L];if(M.visible===!0&&p.traceIs(M,"bar")&&M.xaxis===x._id&&M.yaxis===T._id&&(M.orientation==="h"?C.push(w[L]):k.push(w[L]),M._computePh))for(var P=v.calcdata[L],D=0;D<P.length;D++)typeof P[D].ph0=="function"&&(P[D].ph0=P[D].ph0()),typeof P[D].ph1=="function"&&(P[D].ph1=P[D].ph1())}var N={xCat:x.type==="category"||x.type==="multicategory",yCat:T.type==="category"||T.type==="multicategory",mode:A.barmode,norm:A.barnorm,gap:A.bargap,groupgap:A.bargroupgap};s(v,x,T,k,N),s(v,T,x,C,N)},setGroupPositions:s}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/axes":838,"../../plots/cartesian/constraints":846,"../../registry":915,"./sieve.js":938,"fast-isnumeric":246}],929:[function(r,O,B){var t=r("../../lib"),d=r("../../components/color"),m=r("../../registry"),p=r("../scatter/xy_defaults"),e=r("../scatter/period_defaults"),f=r("./style_defaults"),u=r("../../plots/cartesian/constraints").getAxisGroup,s=r("./attributes"),l=t.coerceFont;function o(c,n,a,g){var h=n.orientation,y=n[{v:"x",h:"y"}[h]+"axis"],v=u(a,y)+h,_=a._alignmentOpts||{},x=g("alignmentgroup"),T=_[v];T||(T=_[v]={});var A=T[x];A?A.traces.push(n):A=T[x]={traces:[n],alignmentIndex:Object.keys(T).length,offsetGroups:{}};var S=g("offsetgroup"),w=A.offsetGroups,C=w[S];S&&(C||(C=w[S]={offsetIndex:Object.keys(w).length}),n._offsetIndex=C.offsetIndex)}function i(c,n,a,g,h,y){var v=(y=y||{}).moduleHasSelected!==!1,_=y.moduleHasUnselected!==!1,x=y.moduleHasConstrain!==!1,T=y.moduleHasCliponaxis!==!1,A=y.moduleHasTextangle!==!1,S=y.moduleHasInsideanchor!==!1,w=!!y.hasPathbar,C=Array.isArray(h)||h==="auto",k=C||h==="inside",L=C||h==="outside";if(k||L){var M=l(g,"textfont",a.font),P=t.extendFlat({},M),D=!(c.textfont&&c.textfont.color);if(D&&delete P.color,l(g,"insidetextfont",P),w){var N=t.extendFlat({},M);D&&delete N.color,l(g,"pathbar.textfont",N)}L&&l(g,"outsidetextfont",M),v&&g("selected.textfont.color"),_&&g("unselected.textfont.color"),x&&g("constraintext"),T&&g("cliponaxis"),A&&g("textangle"),g("texttemplate")}k&&S&&g("insidetextanchor")}O.exports={supplyDefaults:function(c,n,a,g){function h(x,T){return t.coerce(c,n,s,x,T)}if(p(c,n,g,h)){e(c,n,g,h),h("xhoverformat"),h("yhoverformat"),h("orientation",n.x&&!n.y?"h":"v"),h("base"),h("offset"),h("width"),h("text"),h("hovertext"),h("hovertemplate");var y=h("textposition");i(c,n,g,h,y,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),f(c,n,h,a,g);var v=(n.marker.line||{}).color,_=m.getComponentMethod("errorbars","supplyDefaults");_(c,n,v||d.defaultLine,{axis:"y"}),_(c,n,v||d.defaultLine,{axis:"x",inherit:"y"}),t.coerceSelectionMarkerOpacity(n,h)}else n.visible=!1},crossTraceDefaults:function(c,n){var a;function g(y){return t.coerce(a._input,a,s,y)}if(n.barmode==="group")for(var h=0;h<c.length;h++)(a=c[h]).type==="bar"&&(a._input,o(0,a,n,g))},handleGroupingDefaults:o,handleText:i}},{"../../components/color":650,"../../lib":787,"../../plots/cartesian/constraints":846,"../../registry":915,"../scatter/period_defaults":1222,"../scatter/xy_defaults":1229,"./attributes":925,"./style_defaults":940}],930:[function(r,O,B){O.exports=function(t,d,m){return t.x="xVal"in d?d.xVal:d.x,t.y="yVal"in d?d.yVal:d.y,d.xa&&(t.xaxis=d.xa),d.ya&&(t.yaxis=d.ya),m.orientation==="h"?(t.label=t.y,t.value=t.x):(t.label=t.x,t.value=t.y),t}},{}],931:[function(r,O,B){var t=r("fast-isnumeric"),d=r("tinycolor2"),m=r("../../lib").isArrayOrTypedArray;B.coerceString=function(p,e,f){if(typeof e=="string"){if(e||!p.noBlank)return e}else if((typeof e=="number"||e===!0)&&!p.strict)return String(e);return f!==void 0?f:p.dflt},B.coerceNumber=function(p,e,f){if(t(e)){e=+e;var u=p.min,s=p.max;if(!(u!==void 0&&e<u||s!==void 0&&e>s))return e}return f!==void 0?f:p.dflt},B.coerceColor=function(p,e,f){return d(e).isValid()?e:f!==void 0?f:p.dflt},B.coerceEnumerated=function(p,e,f){return p.coerceNumber&&(e=+e),p.values.indexOf(e)!==-1?e:f!==void 0?f:p.dflt},B.getValue=function(p,e){var f;return Array.isArray(p)?e<p.length&&(f=p[e]):f=p,f},B.getLineWidth=function(p,e){return 0<e.mlw?e.mlw:m(p.marker.line.width)?0:p.marker.line.width}},{"../../lib":787,"fast-isnumeric":246,tinycolor2:583}],932:[function(r,O,B){var t=r("../../components/fx"),d=r("../../registry"),m=r("../../components/color"),p=r("../../lib").fillText,e=r("./helpers").getLineWidth,f=r("../../plots/cartesian/axes").hoverLabelText,u=r("../../constants/numerical").BADNUM;function s(o,i,c,n,a){var g,h,y,v,_,x,T,A=o.cd,S=A[0].trace,w=A[0].t,C=n==="closest",k=S.type==="waterfall",L=o.maxHoverDistance,M=o.maxSpikeDistance;S.orientation==="h"?(g=c,h=i,y="y",v="x",_=z,x=Y):(g=i,h=c,y="x",v="y",x=z,_=Y);var P=S[y+"period"],D=C||P;function N(ae){return q(ae,-1)}function U(ae){return q(ae,1)}function q(ae,he){var se=ae.w;return ae[y]+he*se/2}function X(ae){return ae[y+"End"]-ae[y+"Start"]}var K=C?N:P?function(ae){return ae.p-X(ae)/2}:function(ae){return Math.min(N(ae),ae.p-w.bardelta/2)},Z=C?U:P?function(ae){return ae.p+X(ae)/2}:function(ae){return Math.max(U(ae),ae.p+w.bardelta/2)};function H(ae,he,se){return a.finiteRange&&(se=0),t.inbox(ae-g,he-g,se+Math.min(1,Math.abs(he-ae)/T)-1)}function Y(ae){return H(K(ae),Z(ae),L)}function $(ae){var he=ae[v];if(k){var se=Math.abs(ae.rawS)||0;h>0?he+=se:h<0&&(he-=se)}return he}function z(ae){var he=h,se=ae.b,de=$(ae);return t.inbox(se-he,de-he,L+(de-he)/(de-se)-1)}var j=o[y+"a"],W=o[v+"a"];T=Math.abs(j.r2c(j.range[1])-j.r2c(j.range[0]));var ee=t.getDistanceFunction(n,_,x,function(ae){return(_(ae)+x(ae))/2});if(t.getClosest(A,ee,o),o.index!==!1&&A[o.index].p!==u){D||(K=function(ae){return Math.min(N(ae),ae.p-w.bargroupwidth/2)},Z=function(ae){return Math.max(U(ae),ae.p+w.bargroupwidth/2)});var J=A[o.index],Q=S.base?J.b+J.s:J.s;o[v+"0"]=o[v+"1"]=W.c2p(J[v],!0),o[v+"LabelVal"]=Q;var te=w.extents[w.extents.round(J.p)];o[y+"0"]=j.c2p(C?K(J):te[0],!0),o[y+"1"]=j.c2p(C?Z(J):te[1],!0);var ie=J.orig_p!==void 0;return o[y+"LabelVal"]=ie?J.orig_p:J.p,o.labelLabel=f(j,o[y+"LabelVal"],S[y+"hoverformat"]),o.valueLabel=f(W,o[v+"LabelVal"],S[v+"hoverformat"]),o.baseLabel=f(W,J.b,S[v+"hoverformat"]),o.spikeDistance=(function(ae){var he=h,se=ae.b,de=$(ae);return t.inbox(se-he,de-he,M+(de-he)/(de-se)-1)}(J)+function(ae){return H(N(ae),U(ae),M)}(J))/2,o[y+"Spike"]=j.c2p(J.p,!0),p(J,S,o),o.hovertemplate=S.hovertemplate,o}}function l(o,i){var c=i.mcc||o.marker.color,n=i.mlcc||o.marker.line.color,a=e(o,i);return m.opacity(c)?c:m.opacity(n)&&a?n:void 0}O.exports={hoverPoints:function(o,i,c,n,a){var g=s(o,i,c,n,a);if(g){var h=g.cd,y=h[0].trace,v=h[g.index];return g.color=l(y,v),d.getComponentMethod("errorbars","hoverInfo")(v,y,g),[g]}},hoverOnBars:s,getTraceColor:l}},{"../../components/color":650,"../../components/fx":690,"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/axes":838,"../../registry":915,"./helpers":931}],933:[function(r,O,B){O.exports={attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults").supplyDefaults,crossTraceDefaults:r("./defaults").crossTraceDefaults,supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc"),crossTraceCalc:r("./cross_trace_calc").crossTraceCalc,colorbar:r("../scatter/marker_colorbar"),arraysToCalcdata:r("./arrays_to_calcdata"),plot:r("./plot").plot,style:r("./style").style,styleOnSelect:r("./style").styleOnSelect,hoverPoints:r("./hover").hoverPoints,eventData:r("./event_data"),selectPoints:r("./select"),moduleType:"trace",name:"bar",basePlotModule:r("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":852,"../scatter/marker_colorbar":1220,"./arrays_to_calcdata":924,"./attributes":925,"./calc":926,"./cross_trace_calc":928,"./defaults":929,"./event_data":930,"./hover":932,"./layout_attributes":934,"./layout_defaults":935,"./plot":936,"./select":937,"./style":939}],934:[function(r,O,B){O.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],935:[function(r,O,B){var t=r("../../registry"),d=r("../../plots/cartesian/axes"),m=r("../../lib"),p=r("./layout_attributes");O.exports=function(e,f,u){function s(y,v){return m.coerce(e,f,p,y,v)}for(var l=!1,o=!1,i=!1,c={},n=s("barmode"),a=0;a<u.length;a++){var g=u[a];if(t.traceIs(g,"bar")&&g.visible){if(l=!0,n==="group"){var h=g.xaxis+g.yaxis;c[h]&&(i=!0),c[h]=!0}g.visible&&g.type==="histogram"&&d.getFromId({_fullLayout:f},g[g.orientation==="v"?"xaxis":"yaxis"]).type!=="category"&&(o=!0)}}l?(n!=="overlay"&&s("barnorm"),s("bargap",o&&!i?0:.2),s("bargroupgap")):delete f.barmode}},{"../../lib":787,"../../plots/cartesian/axes":838,"../../registry":915,"./layout_attributes":934}],936:[function(r,O,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("../../lib"),p=r("../../lib/svg_text_utils"),e=r("../../components/color"),f=r("../../components/drawing"),u=r("../../registry"),s=r("../../plots/cartesian/axes").tickText,l=r("./uniform_text"),o=l.recordMinTextSize,i=l.clearMinTextSize,c=r("./style"),n=r("./helpers"),a=r("./constants"),g=r("./attributes"),h=g.text,y=g.textposition,v=r("../../components/fx/helpers").appendArrayPointValue,_=a.TEXTPAD;function x(M){return M.id}function T(M){if(M.ids)return x}function A(M,P){return M<P?1:-1}function S(M,P,D,N){var U;return!P.uniformtext.mode&&w(D)?(N&&(U=N()),M.transition().duration(D.duration).ease(D.easing).each("end",function(){U&&U()}).each("interrupt",function(){U&&U()})):M}function w(M){return M&&M.duration>0}function C(M){return M==="auto"?0:M}function k(M,P){var D=Math.PI/180*P,N=Math.abs(Math.sin(D)),U=Math.abs(Math.cos(D));return{x:M.width*U+M.height*N,y:M.width*N+M.height*U}}function L(M,P,D,N,U,q){var X=!!q.isHorizontal,K=!!q.constrained,Z=q.angle||0,H=q.anchor||"end",Y=H==="end",$=H==="start",z=((q.leftToRight||0)+1)/2,j=1-z,W=U.width,ee=U.height,J=Math.abs(P-M),Q=Math.abs(N-D),te=J>2*_&&Q>2*_?_:0;J-=2*te,Q-=2*te;var ie=C(Z);Z!=="auto"||W<=J&&ee<=Q||!(W>J||ee>Q)||(W>Q||ee>J)&&W<ee==J<Q||(ie+=90);var ae=k(U,ie),he=1;K&&(he=Math.min(1,J/ae.x,Q/ae.y));var se=U.left*j+U.right*z,de=(U.top+U.bottom)/2,ue=(M+_)*j+(P-_)*z,ve=(D+N)/2,ke=0,Ee=0;if($||Y){var be=(X?ae.x:ae.y)/2,xe=X?A(M,P):A(D,N);X?$?(ue=M+xe*te,ke=-xe*be):(ue=P-xe*te,ke=xe*be):$?(ve=D+xe*te,Ee=-xe*be):(ve=N-xe*te,Ee=xe*be)}return{textX:se,textY:de,targetX:ue,targetY:ve,anchorX:ke,anchorY:Ee,scale:he,rotate:ie}}O.exports={plot:function(M,P,D,N,U,q){var X=P.xaxis,K=P.yaxis,Z=M._fullLayout;U||(U={mode:Z.barmode,norm:Z.barmode,gap:Z.bargap,groupgap:Z.bargroupgap},i("bar",Z));var H=m.makeTraceGroups(N,D,"trace bars").each(function(Y){var $=t.select(this),z=Y[0].trace,j=z.type==="waterfall",W=z.type==="funnel",ee=z.type==="bar"||W,J=0;j&&z.connector.visible&&z.connector.mode==="between"&&(J=z.connector.line.width/2);var Q=z.orientation==="h",te=w(U),ie=m.ensureSingle($,"g","points"),ae=T(z),he=ie.selectAll("g.point").data(m.identity,ae);he.enter().append("g").classed("point",!0),he.exit().remove(),he.each(function(de,ue){var ve,ke,Ee=t.select(this),be=function(Oe,je,We,qe){var Qe=[],st=[],ct=qe?je:We,Pt=qe?We:je;return Qe[0]=ct.c2p(Oe.s0,!0),st[0]=Pt.c2p(Oe.p0,!0),Qe[1]=ct.c2p(Oe.s1,!0),st[1]=Pt.c2p(Oe.p1,!0),qe?[Qe,st]:[st,Qe]}(de,X,K,Q),xe=be[0][0],ce=be[0][1],ge=be[1][0],we=be[1][1],Me=(Q?ce-xe:we-ge)==0;if(Me&&ee&&n.getLineWidth(z,de)&&(Me=!1),Me||(Me=!(d(xe)&&d(ce)&&d(ge)&&d(we))),de.isBlank=Me,Me&&(Q?ce=xe:we=ge),J&&!Me&&(Q?(xe-=A(xe,ce)*J,ce+=A(xe,ce)*J):(ge-=A(ge,we)*J,we+=A(ge,we)*J)),z.type==="waterfall"){if(!Me){var Se=z[de.dir].marker;ve=Se.line.width,ke=Se.color}}else ve=n.getLineWidth(z,de),ke=de.mc||z.marker.color;function ze(Oe){var je=t.round(ve/2%1,2);return U.gap===0&&U.groupgap===0?t.round(Math.round(Oe)-je,2):Oe}if(!M._context.staticPlot){var Fe=e.opacity(ke)<1||ve>.01?ze:function(Oe,je,We){return We&&Oe===je?Oe:Math.abs(Oe-je)>=2?ze(Oe):Oe>je?Math.ceil(Oe):Math.floor(Oe)};xe=Fe(xe,ce,Q),ce=Fe(ce,xe,Q),ge=Fe(ge,we,!Q),we=Fe(we,ge,!Q)}var Ye=S(m.ensureSingle(Ee,"path"),Z,U,q);if(Ye.style("vector-effect","non-scaling-stroke").attr("d",isNaN((ce-xe)*(we-ge))||Me&&M._context.staticPlot?"M0,0Z":"M"+xe+","+ge+"V"+we+"H"+ce+"V"+ge+"Z").call(f.setClipUrl,P.layerClipId,M),!Z.uniformtext.mode&&te){var rt=f.makePointStyleFns(z);f.singlePointStyle(de,Ye,z,rt,M)}(function(Oe,je,We,qe,Qe,st,ct,Pt,kt,at,tt){var _t,er=je.xaxis,tr=je.yaxis,Ue=Oe._fullLayout;function He(Xt,Kt,or){return m.ensureSingle(Xt,"text").text(Kt).attr({class:"bartext bartext-"+_t,"text-anchor":"middle","data-notex":1}).call(f.font,or).call(p.convertToTspans,Oe)}var Be=qe[0].trace,Ke=Be.orientation==="h",_e=function(Xt,Kt,or,dr,vr){var ur,pr=Kt[0].trace;return ur=pr.texttemplate?function(br,Rr,_r,jr,$r){var pn=Rr[0].trace,In=m.castOption(pn,_r,"texttemplate");if(!In)return"";var On,Sn,an,Nr,Pr=pn.type==="waterfall",en=pn.type==="funnel";pn.orientation==="h"?(On="y",Sn=$r,an="x",Nr=jr):(On="x",Sn=jr,an="y",Nr=$r);function tn(It){return s(Nr,Nr.c2l(It),!0).text}var Qr=Rr[_r],rn={};rn.label=Qr.p,rn.labelLabel=rn[On+"Label"]=(An=Qr.p,s(Sn,Sn.c2l(An),!0).text);var An,En=m.castOption(pn,Qr.i,"text");(En===0||En)&&(rn.text=En),rn.value=Qr.s,rn.valueLabel=rn[an+"Label"]=tn(Qr.s);var Bn={};v(Bn,pn,Qr.i),Pr&&(rn.delta=+Qr.rawS||Qr.s,rn.deltaLabel=tn(rn.delta),rn.final=Qr.v,rn.finalLabel=tn(rn.final),rn.initial=rn.final-rn.delta,rn.initialLabel=tn(rn.initial)),en&&(rn.value=Qr.s,rn.valueLabel=tn(rn.value),rn.percentInitial=Qr.begR,rn.percentInitialLabel=m.formatPercent(Qr.begR),rn.percentPrevious=Qr.difR,rn.percentPreviousLabel=m.formatPercent(Qr.difR),rn.percentTotal=Qr.sumR,rn.percenTotalLabel=m.formatPercent(Qr.sumR));var Jt=m.castOption(pn,Qr.i,"customdata");return Jt&&(rn.customdata=Jt),m.texttemplateString(In,rn,br._d3locale,Bn,rn,pn._meta||{})}(Xt,Kt,or,dr,vr):pr.textinfo?function(br,Rr,_r,jr){var $r=br[0].trace,pn=$r.orientation==="h",In=$r.type==="waterfall",On=$r.type==="funnel";function Sn(qt){return s(pn?_r:jr,+qt,!0).text}var an,Nr=$r.textinfo,Pr=br[Rr],en=Nr.split("+"),tn=[],Qr=function(qt){return en.indexOf(qt)!==-1};Qr("label")&&tn.push((rn=br[Rr].p,s(pn?jr:_r,rn,!0).text));var rn;if(Qr("text")&&((an=m.castOption($r,Pr.i,"text"))===0||an)&&tn.push(an),In){var An=+Pr.rawS||Pr.s,En=Pr.v,Bn=En-An;Qr("initial")&&tn.push(Sn(Bn)),Qr("delta")&&tn.push(Sn(An)),Qr("final")&&tn.push(Sn(En))}if(On){Qr("value")&&tn.push(Sn(Pr.s));var Jt=0;Qr("percent initial")&&Jt++,Qr("percent previous")&&Jt++,Qr("percent total")&&Jt++;var It=Jt>1;Qr("percent initial")&&(an=m.formatPercent(Pr.begR),It&&(an+=" of initial"),tn.push(an)),Qr("percent previous")&&(an=m.formatPercent(Pr.difR),It&&(an+=" of previous"),tn.push(an)),Qr("percent total")&&(an=m.formatPercent(Pr.sumR),It&&(an+=" of total"),tn.push(an))}return tn.join("<br>")}(Kt,or,dr,vr):n.getValue(pr.text,or),n.coerceString(h,ur)}(Ue,qe,Qe,er,tr);_t=function(Xt,Kt){var or=n.getValue(Xt.textposition,Kt);return n.coerceEnumerated(y,or)}(Be,Qe);var Ce=at.mode==="stack"||at.mode==="relative",Le=qe[Qe],Pe=!Ce||Le._outmost;if(!_e||_t==="none"||(Le.isBlank||st===ct||Pt===kt)&&(_t==="auto"||_t==="inside"))return void We.select("text").remove();var Xe=Ue.font,ht=c.getBarColor(qe[Qe],Be),Mt=c.getInsideTextFont(Be,Qe,Xe,ht),pt=c.getOutsideTextFont(Be,Qe,Xe),Lt=We.datum();Ke?er.type==="log"&&Lt.s0<=0&&(st=er.range[0]<er.range[1]?0:er._length):tr.type==="log"&&Lt.s0<=0&&(Pt=tr.range[0]<tr.range[1]?tr._length:0);var vt,Dt,xt,it,St,Nt=Math.abs(ct-st)-2*_,Ut=Math.abs(kt-Pt)-2*_;if(_t==="outside"&&(Pe||Le.hasB||(_t="inside")),_t==="auto")if(Pe){_t="inside",St=m.ensureUniformFontSize(Oe,Mt),vt=He(We,_e,St),Dt=f.bBox(vt.node()),xt=Dt.width,it=Dt.height;var Qt=xt<=Nt&&it<=Ut,Ie=xt<=Ut&&it<=Nt,lt=Ke?Nt>=xt*(Ut/it):Ut>=it*(Nt/xt);xt>0&&it>0&&(Qt||Ie||lt)?_t="inside":(_t="outside",vt.remove(),vt=null)}else _t="inside";if(!vt){St=m.ensureUniformFontSize(Oe,_t==="outside"?pt:Mt);var wt=(vt=He(We,_e,St)).attr("transform");if(vt.attr("transform",""),Dt=f.bBox(vt.node()),xt=Dt.width,it=Dt.height,vt.attr("transform",wt),xt<=0||it<=0)return void vt.remove()}var Ot,Gt,ir=Be.textangle;_t==="outside"?(Gt=Be.constraintext==="both"||Be.constraintext==="outside",Ot=function(Xt,Kt,or,dr,vr,ur){var pr,br=!!ur.isHorizontal,Rr=!!ur.constrained,_r=ur.angle||0,jr=vr.width,$r=vr.height,pn=Math.abs(Kt-Xt),In=Math.abs(dr-or);pr=br?In>2*_?_:0:pn>2*_?_:0;var On=1;Rr&&(On=br?Math.min(1,In/$r):Math.min(1,pn/jr));var Sn=C(_r),an=k(vr,Sn),Nr=(br?an.x:an.y)/2,Pr=(vr.left+vr.right)/2,en=(vr.top+vr.bottom)/2,tn=(Xt+Kt)/2,Qr=(or+dr)/2,rn=0,An=0,En=br?A(Kt,Xt):A(or,dr);return br?(tn=Kt-En*pr,rn=En*Nr):(Qr=dr+En*pr,An=-En*Nr),{textX:Pr,textY:en,targetX:tn,targetY:Qr,anchorX:rn,anchorY:An,scale:On,rotate:Sn}}(st,ct,Pt,kt,Dt,{isHorizontal:Ke,constrained:Gt,angle:ir})):(Gt=Be.constraintext==="both"||Be.constraintext==="inside",Ot=L(st,ct,Pt,kt,Dt,{isHorizontal:Ke,constrained:Gt,angle:ir,anchor:Be.insidetextanchor})),Ot.fontSize=St.size,o(Be.type,Ot,Ue),Le.transform=Ot,S(vt,Ue,at,tt).attr("transform",m.getTextTransform(Ot))})(M,P,Ee,Y,ue,xe,ce,ge,we,U,q),P.layerClipId&&f.hideOutsideRangePoint(de,Ee.select("text"),X,K,z.xcalendar,z.ycalendar)});var se=z.cliponaxis===!1;f.setClipUrl($,se?null:P.layerClipId,M)});u.getComponentMethod("errorbars","plot")(M,H,P,U)},toMoveInsideBar:L}},{"../../components/color":650,"../../components/drawing":672,"../../components/fx/helpers":686,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../registry":915,"./attributes":925,"./constants":927,"./helpers":931,"./style":939,"./uniform_text":941,"@plotly/d3":58,"fast-isnumeric":246}],937:[function(r,O,B){function t(d,m,p,e,f){var u=m.c2p(e?d.s0:d.p0,!0),s=m.c2p(e?d.s1:d.p1,!0),l=p.c2p(e?d.p0:d.s0,!0),o=p.c2p(e?d.p1:d.s1,!0);return f?[(u+s)/2,(l+o)/2]:e?[s,(l+o)/2]:[(u+s)/2,o]}O.exports=function(d,m){var p,e=d.cd,f=d.xaxis,u=d.yaxis,s=e[0].trace,l=s.type==="funnel",o=s.orientation==="h",i=[];if(m===!1)for(p=0;p<e.length;p++)e[p].selected=0;else for(p=0;p<e.length;p++){var c=e[p],n="ct"in c?c.ct:t(c,f,u,o,l);m.contains(n,!1,p,d)?(i.push({pointNumber:p,x:f.c2d(c.x),y:u.c2d(c.y)}),c.selected=1):c.selected=0}return i}},{}],938:[function(r,O,B){O.exports=m;var t=r("../../lib").distinctVals,d=r("../../constants/numerical").BADNUM;function m(p,e){this.traces=p,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var f=1/0,u=[],s=0;s<p.length;s++){for(var l=p[s],o=0;o<l.length;o++){var i=l[o];i.p!==d&&u.push(i.p)}l[0]&&l[0].width1&&(f=Math.min(l[0].width1,f))}this.positions=u;var c=t(u);this.distinctPositions=c.vals,c.vals.length===1&&f!==1/0?this.minDiff=f:this.minDiff=Math.min(c.minDiff,f);var n=(e.posAxis||{}).type;n!=="category"&&n!=="multicategory"||(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}m.prototype.put=function(p,e){var f=this.getLabel(p,e),u=this.bins[f]||0;return this.bins[f]=u+e,u},m.prototype.get=function(p,e){var f=this.getLabel(p,e);return this.bins[f]||0},m.prototype.getLabel=function(p,e){return(e<0&&this.sepNegVal?"v":"^")+(this.overlapNoMerge?p:Math.round(p/this.binWidth))}},{"../../constants/numerical":763,"../../lib":787}],939:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/color"),m=r("../../components/drawing"),p=r("../../lib"),e=r("../../registry"),f=r("./uniform_text").resizeText,u=r("./attributes"),s=u.textfont,l=u.insidetextfont,o=u.outsidetextfont,i=r("./helpers");function c(x,T,A){m.pointStyle(x.selectAll("path"),T,A),n(x,T,A)}function n(x,T,A){x.selectAll("text").each(function(S){var w=t.select(this),C=p.ensureUniformFontSize(A,a(w,S,T,A));m.font(w,C)})}function a(x,T,A,S){var w=S._fullLayout.font,C=A.textfont;if(x.classed("bartext-inside")){var k=_(T,A);C=h(A,T.i,w,k)}else x.classed("bartext-outside")&&(C=y(A,T.i,w));return C}function g(x,T,A){return v(s,x.textfont,T,A)}function h(x,T,A,S){var w=g(x,T,A);return(x._input.textfont===void 0||x._input.textfont.color===void 0||Array.isArray(x.textfont.color)&&x.textfont.color[T]===void 0)&&(w={color:d.contrast(S),family:w.family,size:w.size}),v(l,x.insidetextfont,T,w)}function y(x,T,A){var S=g(x,T,A);return v(o,x.outsidetextfont,T,S)}function v(x,T,A,S){T=T||{};var w=i.getValue(T.family,A),C=i.getValue(T.size,A),k=i.getValue(T.color,A);return{family:i.coerceString(x.family,w,S.family),size:i.coerceNumber(x.size,C,S.size),color:i.coerceColor(x.color,k,S.color)}}function _(x,T){return T.type==="waterfall"?T[x.dir].marker.color:x.mcc||x.mc||T.marker.color}O.exports={style:function(x){var T=t.select(x).selectAll("g.barlayer").selectAll("g.trace");f(x,T,"bar");var A=T.size(),S=x._fullLayout;T.style("opacity",function(w){return w[0].trace.opacity}).each(function(w){(S.barmode==="stack"&&A>1||S.bargap===0&&S.bargroupgap===0&&!w[0].trace.marker.line.width)&&t.select(this).attr("shape-rendering","crispEdges")}),T.selectAll("g.points").each(function(w){c(t.select(this),w[0].trace,x)}),e.getComponentMethod("errorbars","style")(T)},styleTextPoints:n,styleOnSelect:function(x,T,A){var S=T[0].trace;S.selectedpoints?function(w,C,k){m.selectedPointStyle(w.selectAll("path"),C),function(L,M,P){L.each(function(D){var N,U=t.select(this);if(D.selected){N=p.ensureUniformFontSize(P,a(U,D,M,P));var q=M.selected.textfont&&M.selected.textfont.color;q&&(N.color=q),m.font(U,N)}else m.selectedTextStyle(U,M)})}(w.selectAll("text"),C,k)}(A,S,x):(c(A,S,x),e.getComponentMethod("errorbars","style")(A))},getInsideTextFont:h,getOutsideTextFont:y,getBarColor:_,resizeText:f}},{"../../components/color":650,"../../components/drawing":672,"../../lib":787,"../../registry":915,"./attributes":925,"./helpers":931,"./uniform_text":941,"@plotly/d3":58}],940:[function(r,O,B){var t=r("../../components/color"),d=r("../../components/colorscale/helpers").hasColorscale,m=r("../../components/colorscale/defaults"),p=r("../../lib").coercePattern;O.exports=function(e,f,u,s,l){var o=u("marker.color",s),i=d(e,"marker");i&&m(e,f,l,u,{prefix:"marker.",cLetter:"c"}),u("marker.line.color",t.defaultLine),d(e,"marker.line")&&m(e,f,l,u,{prefix:"marker.line.",cLetter:"c"}),u("marker.line.width"),u("marker.opacity"),p(u,"marker.pattern",o,i),u("selected.marker.color"),u("unselected.marker.color")}},{"../../components/color":650,"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"../../lib":787}],941:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib");function m(p){return"_"+p+"Text_minsize"}O.exports={recordMinTextSize:function(p,e,f){if(f.uniformtext.mode){var u=m(p),s=f.uniformtext.minsize,l=e.scale*e.fontSize;e.hide=l<s,f[u]=f[u]||1/0,e.hide||(f[u]=Math.min(f[u],Math.max(l,s)))}},clearMinTextSize:function(p,e){e[m(p)]=void 0},resizeText:function(p,e,f){var u=p._fullLayout,s=u["_"+f+"Text_minsize"];if(s){var l,o=u.uniformtext.mode==="hide";switch(f){case"funnelarea":case"pie":case"sunburst":l="g.slice";break;case"treemap":case"icicle":l="g.slice, g.pathbar";break;default:l="g.points > g.point"}e.selectAll(l).each(function(i){var c=i.transform;c&&(c.scale=o&&c.hide?0:s/c.fontSize,t.select(this).select("text").attr("transform",d.getTextTransform(c)))})}}}},{"../../lib":787,"@plotly/d3":58}],942:[function(r,O,B){var t=r("../../plots/template_attributes").hovertemplateAttrs,d=r("../../lib/extend").extendFlat,m=r("../scatterpolar/attributes"),p=r("../bar/attributes");O.exports={r:m.r,theta:m.theta,r0:m.r0,dr:m.dr,theta0:m.theta0,dtheta:m.dtheta,thetaunit:m.thetaunit,base:d({},p.base,{}),offset:d({},p.offset,{}),width:d({},p.width,{}),text:d({},p.text,{}),hovertext:d({},p.hovertext,{}),marker:p.marker,hoverinfo:m.hoverinfo,hovertemplate:t(),selected:p.selected,unselected:p.unselected}},{"../../lib/extend":777,"../../plots/template_attributes":910,"../bar/attributes":925,"../scatterpolar/attributes":1276}],943:[function(r,O,B){var t=r("../../components/colorscale/helpers").hasColorscale,d=r("../../components/colorscale/calc"),m=r("../bar/arrays_to_calcdata"),p=r("../bar/cross_trace_calc").setGroupPositions,e=r("../scatter/calc_selection"),f=r("../../registry").traceIs,u=r("../../lib").extendFlat;O.exports={calc:function(s,l){for(var o=s._fullLayout,i=l.subplot,c=o[i].radialaxis,n=o[i].angularaxis,a=c.makeCalcdata(l,"r"),g=n.makeCalcdata(l,"theta"),h=l._length,y=new Array(h),v=a,_=g,x=0;x<h;x++)y[x]={p:_[x],s:v[x]};function T(A){var S=l[A];S!==void 0&&(l["_"+A]=Array.isArray(S)?n.makeCalcdata(l,A):n.d2c(S,l.thetaunit))}return n.type==="linear"&&(T("width"),T("offset")),t(l,"marker")&&d(s,l,{vals:l.marker.color,containerStr:"marker",cLetter:"c"}),t(l,"marker.line")&&d(s,l,{vals:l.marker.line.color,containerStr:"marker.line",cLetter:"c"}),m(y,l),e(y,l),y},crossTraceCalc:function(s,l,o){for(var i=s.calcdata,c=[],n=0;n<i.length;n++){var a=i[n],g=a[0].trace;g.visible===!0&&f(g,"bar")&&g.subplot===o&&c.push(a)}var h=u({},l.radialaxis,{_id:"x"}),y=l.angularaxis;p(s,y,h,c,{mode:l.barmode,norm:l.barnorm,gap:l.bargap,groupgap:l.bargroupgap})}}},{"../../components/colorscale/calc":658,"../../components/colorscale/helpers":661,"../../lib":787,"../../registry":915,"../bar/arrays_to_calcdata":924,"../bar/cross_trace_calc":928,"../scatter/calc_selection":1204}],944:[function(r,O,B){var t=r("../../lib"),d=r("../scatterpolar/defaults").handleRThetaDefaults,m=r("../bar/style_defaults"),p=r("./attributes");O.exports=function(e,f,u,s){function l(o,i){return t.coerce(e,f,p,o,i)}d(e,f,s,l)?(l("thetaunit"),l("base"),l("offset"),l("width"),l("text"),l("hovertext"),l("hovertemplate"),m(e,f,l,u,s),t.coerceSelectionMarkerOpacity(f,l)):f.visible=!1}},{"../../lib":787,"../bar/style_defaults":940,"../scatterpolar/defaults":1278,"./attributes":942}],945:[function(r,O,B){var t=r("../../components/fx"),d=r("../../lib"),m=r("../bar/hover").getTraceColor,p=d.fillText,e=r("../scatterpolar/hover").makeHoverPointText,f=r("../../plots/polar/helpers").isPtInsidePolygon;O.exports=function(u,s,l){var o=u.cd,i=o[0].trace,c=u.subplot,n=c.radialAxis,a=c.angularAxis,g=c.vangles,h=g?f:d.isPtInsideSector,y=u.maxHoverDistance,v=a._period||2*Math.PI,_=Math.abs(n.g2p(Math.sqrt(s*s+l*l))),x=Math.atan2(l,s);if(n.range[0]>n.range[1]&&(x+=Math.PI),t.getClosest(o,function(S){return h(_,x,[S.rp0,S.rp1],[S.thetag0,S.thetag1],g)?y+Math.min(1,Math.abs(S.thetag1-S.thetag0)/v)-1+(S.rp1-_)/(S.rp1-S.rp0)-1:1/0},u),u.index!==!1){var T=o[u.index];u.x0=u.x1=T.ct[0],u.y0=u.y1=T.ct[1];var A=d.extendFlat({},T,{r:T.s,theta:T.p});return p(T,i,u),e(A,i,c,u),u.hovertemplate=i.hovertemplate,u.color=m(i,T),u.xLabelVal=u.yLabelVal=void 0,T.s<0&&(u.idealAlign="left"),[u]}}},{"../../components/fx":690,"../../lib":787,"../../plots/polar/helpers":903,"../bar/hover":932,"../scatterpolar/hover":1280}],946:[function(r,O,B){O.exports={moduleType:"trace",name:"barpolar",basePlotModule:r("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("../scatterpolar/format_labels"),style:r("../bar/style").style,styleOnSelect:r("../bar/style").styleOnSelect,hoverPoints:r("./hover"),selectPoints:r("../bar/select"),meta:{}}},{"../../plots/polar":904,"../bar/select":937,"../bar/style":939,"../scatter/marker_colorbar":1220,"../scatterpolar/format_labels":1279,"./attributes":942,"./calc":943,"./defaults":944,"./hover":945,"./layout_attributes":947,"./layout_defaults":948,"./plot":949}],947:[function(r,O,B){O.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],948:[function(r,O,B){var t=r("../../lib"),d=r("./layout_attributes");O.exports=function(m,p,e){var f,u={};function s(i,c){return t.coerce(m[f]||{},p[f],d,i,c)}for(var l=0;l<e.length;l++){var o=e[l];o.type==="barpolar"&&o.visible===!0&&(u[f=o.subplot]||(s("barmode"),s("bargap"),u[f]=1))}}},{"../../lib":787,"./layout_attributes":947}],949:[function(r,O,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("../../lib"),p=r("../../components/drawing"),e=r("../../plots/polar/helpers");O.exports=function(f,u,s){var l=u.xaxis,o=u.yaxis,i=u.radialAxis,c=u.angularAxis,n=function(g){var h=g.cxx,y=g.cyy;return g.vangles?function(v,_,x,T){var A,S;m.angleDelta(x,T)>0?(A=x,S=T):(A=T,S=x);var w=[e.findEnclosingVertexAngles(A,g.vangles)[0],(A+S)/2,e.findEnclosingVertexAngles(S,g.vangles)[1]];return e.pathPolygonAnnulus(v,_,A,S,w,h,y)}:function(v,_,x,T){return m.pathAnnulus(v,_,x,T,h,y)}}(u),a=u.layers.frontplot.select("g.barlayer");m.makeTraceGroups(a,s,"trace bars").each(function(){var g=t.select(this),h=m.ensureSingle(g,"g","points").selectAll("g.point").data(m.identity);h.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),h.exit().remove(),h.each(function(y){var v,_=t.select(this),x=y.rp0=i.c2p(y.s0),T=y.rp1=i.c2p(y.s1),A=y.thetag0=c.c2g(y.p0),S=y.thetag1=c.c2g(y.p1);if(d(x)&&d(T)&&d(A)&&d(S)&&x!==T&&A!==S){var w=i.c2g(y.s1),C=(A+S)/2;y.ct=[l.c2p(w*Math.cos(C)),o.c2p(w*Math.sin(C))],v=n(x,T,A,S)}else v="M0,0Z";m.ensureSingle(_,"path").attr("d",v)}),p.setClipUrl(g,u._hasClipOnAxisFalse?u.clipIds.forTraces:null,f)})}},{"../../components/drawing":672,"../../lib":787,"../../plots/polar/helpers":903,"@plotly/d3":58,"fast-isnumeric":246}],950:[function(r,O,B){var t=r("../scatter/attributes"),d=r("../bar/attributes"),m=r("../../components/color/attributes"),p=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=r("../../plots/template_attributes").hovertemplateAttrs,f=r("../../lib/extend").extendFlat,u=t.marker,s=u.line;O.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,xhoverformat:p("x"),yhoverformat:p("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:f({},u.symbol,{arrayOk:!1,editType:"plot"}),opacity:f({},u.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:f({},u.size,{arrayOk:!1,editType:"calc"}),color:f({},u.color,{arrayOk:!1,editType:"style"}),line:{color:f({},s.color,{arrayOk:!1,dflt:m.defaultLine,editType:"style"}),width:f({},s.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:t.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:d.offsetgroup,alignmentgroup:d.alignmentgroup,selected:{marker:t.selected.marker,editType:"style"},unselected:{marker:t.unselected.marker,editType:"style"},text:f({},t.text,{}),hovertext:f({},t.hovertext,{}),hovertemplate:e({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":649,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../bar/attributes":925,"../scatter/attributes":1202}],951:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../plots/cartesian/axes"),m=r("../../plots/cartesian/align_period"),p=r("../../lib"),e=r("../../constants/numerical").BADNUM,f=p._;O.exports=function(h,y){var v,_,x,T,A,S,w,C=h._fullLayout,k=d.getFromId(h,y.xaxis||"x"),L=d.getFromId(h,y.yaxis||"y"),M=[],P=y.type==="violin"?"_numViolins":"_numBoxes";y.orientation==="h"?(x=k,T="x",A=L,S="y",w=!!y.yperiodalignment):(x=L,T="y",A=k,S="x",w=!!y.xperiodalignment);var D,N,U,q,X,K,Z=function(We,qe,Qe,st){var ct,Pt=qe+"0"in We,kt="d"+qe in We;if(qe in We||Pt&&kt){var at=Qe.makeCalcdata(We,qe);return[m(We,Qe,qe,at).vals,at]}ct=Pt?We[qe+"0"]:"name"in We&&(Qe.type==="category"||t(We.name)&&["linear","log"].indexOf(Qe.type)!==-1||p.isDateTime(We.name)&&Qe.type==="date")?We.name:st;for(var tt=Qe.type==="multicategory"?Qe.r2c_just_indices(ct):Qe.d2c(ct,0,We[qe+"calendar"]),_t=We._length,er=new Array(_t),tr=0;tr<_t;tr++)er[tr]=tt;return[er]}(y,S,A,C[P]),H=Z[0],Y=Z[1],$=p.distinctVals(H,A),z=$.vals,j=$.minDiff/2,W=(y.boxpoints||y.points)==="all"?p.identity:function(We){return We.v<D.lf||We.v>D.uf};if(y._hasPreCompStats){var ee=y[T],J=function(We){return x.d2c((y[We]||[])[v])},Q=1/0,te=-1/0;for(v=0;v<y._length;v++){var ie=H[v];if(t(ie)){if((D={}).pos=D[S]=ie,w&&Y&&(D.orig_p=Y[v]),D.q1=J("q1"),D.med=J("median"),D.q3=J("q3"),N=[],ee&&p.isArrayOrTypedArray(ee[v]))for(_=0;_<ee[v].length;_++)(K=x.d2c(ee[v][_]))!==e&&(s(X={v:K,i:[v,_]},y,[v,_]),N.push(X));if(D.pts=N.sort(l),q=(U=D[T]=N.map(o)).length,D.med!==e&&D.q1!==e&&D.q3!==e&&D.med>=D.q1&&D.q3>=D.med){var ae=J("lowerfence");D.lf=ae!==e&&ae<=D.q1?ae:i(D,U,q);var he=J("upperfence");D.uf=he!==e&&he>=D.q3?he:c(D,U,q);var se=J("mean");D.mean=se!==e?se:q?p.mean(U,q):(D.q1+D.q3)/2;var de=J("sd");D.sd=se!==e&&de>=0?de:q?p.stdev(U,q,D.mean):D.q3-D.q1,D.lo=n(D),D.uo=a(D);var ue=J("notchspan");ue=ue!==e&&ue>0?ue:g(D,q),D.ln=D.med-ue,D.un=D.med+ue;var ve=D.lf,ke=D.uf;y.boxpoints&&U.length&&(ve=Math.min(ve,U[0]),ke=Math.max(ke,U[q-1])),y.notched&&(ve=Math.min(ve,D.ln),ke=Math.max(ke,D.un)),D.min=ve,D.max=ke}else{var Ee;p.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+D.q1,"median = "+D.med,"q3 = "+D.q3].join(`
`)),Ee=D.med!==e?D.med:D.q1!==e?D.q3!==e?(D.q1+D.q3)/2:D.q1:D.q3!==e?D.q3:0,D.med=Ee,D.q1=D.q3=Ee,D.lf=D.uf=Ee,D.mean=D.sd=Ee,D.ln=D.un=Ee,D.min=D.max=Ee}Q=Math.min(Q,D.min),te=Math.max(te,D.max),D.pts2=N.filter(W),M.push(D)}}y._extremes[x._id]=d.findExtremes(x,[Q,te],{padded:!0})}else{var be=x.makeCalcdata(y,T),xe=function(We,qe){for(var Qe=We.length,st=new Array(Qe+1),ct=0;ct<Qe;ct++)st[ct]=We[ct]-qe;return st[Qe]=We[Qe-1]+qe,st}(z,j),ce=z.length,ge=function(We){for(var qe=new Array(We),Qe=0;Qe<We;Qe++)qe[Qe]=[];return qe}(ce);for(v=0;v<y._length;v++)if(K=be[v],t(K)){var we=p.findBin(H[v],xe);we>=0&&we<ce&&(s(X={v:K,i:v},y,v),ge[we].push(X))}var Me=1/0,Se=-1/0,ze=y.quartilemethod,Fe=ze==="exclusive",Ye=ze==="inclusive";for(v=0;v<ce;v++)if(ge[v].length>0){var rt,Oe;(D={}).pos=D[S]=z[v],N=D.pts=ge[v].sort(l),q=(U=D[T]=N.map(o)).length,D.min=U[0],D.max=U[q-1],D.mean=p.mean(U,q),D.sd=p.stdev(U,q,D.mean),D.med=p.interp(U,.5),q%2&&(Fe||Ye)?(Fe?(rt=U.slice(0,q/2),Oe=U.slice(q/2+1)):Ye&&(rt=U.slice(0,q/2+1),Oe=U.slice(q/2)),D.q1=p.interp(rt,.5),D.q3=p.interp(Oe,.5)):(D.q1=p.interp(U,.25),D.q3=p.interp(U,.75)),D.lf=i(D,U,q),D.uf=c(D,U,q),D.lo=n(D),D.uo=a(D);var je=g(D,q);D.ln=D.med-je,D.un=D.med+je,Me=Math.min(Me,D.ln),Se=Math.max(Se,D.un),D.pts2=N.filter(W),M.push(D)}y._extremes[x._id]=d.findExtremes(x,y.notched?be.concat([Me,Se]):be,{padded:!0})}return function(We,qe){if(p.isArrayOrTypedArray(qe.selectedpoints))for(var Qe=0;Qe<We.length;Qe++){for(var st=We[Qe].pts||[],ct={},Pt=0;Pt<st.length;Pt++)ct[st[Pt].i]=Pt;p.tagSelected(st,qe,ct)}}(M,y),M.length>0?(M[0].t={num:C[P],dPos:j,posLetter:S,valLetter:T,labels:{med:f(h,"median:"),min:f(h,"min:"),q1:f(h,"q1:"),q3:f(h,"q3:"),max:f(h,"max:"),mean:y.boxmean==="sd"?f(h,"mean \xB1 \u03C3:"):f(h,"mean:"),lf:f(h,"lower fence:"),uf:f(h,"upper fence:")}},C[P]++,M):[{t:{empty:!0}}]};var u={text:"tx",hovertext:"htx"};function s(h,y,v){for(var _ in u)p.isArrayOrTypedArray(y[_])&&(Array.isArray(v)?p.isArrayOrTypedArray(y[_][v[0]])&&(h[u[_]]=y[_][v[0]][v[1]]):h[u[_]]=y[_][v])}function l(h,y){return h.v-y.v}function o(h){return h.v}function i(h,y,v){return v===0?h.q1:Math.min(h.q1,y[Math.min(p.findBin(2.5*h.q1-1.5*h.q3,y,!0)+1,v-1)])}function c(h,y,v){return v===0?h.q3:Math.max(h.q3,y[Math.max(p.findBin(2.5*h.q3-1.5*h.q1,y),0)])}function n(h){return 4*h.q1-3*h.q3}function a(h){return 4*h.q3-3*h.q1}function g(h,y){return y===0?0:1.57*(h.q3-h.q1)/Math.sqrt(y)}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"fast-isnumeric":246}],952:[function(r,O,B){var t=r("../../plots/cartesian/axes"),d=r("../../lib"),m=r("../../plots/cartesian/constraints").getAxisGroup,p=["v","h"];function e(f,u,s,l){var o,i,c,n=u.calcdata,a=u._fullLayout,g=l._id,h=g.charAt(0),y=[],v=0;for(o=0;o<s.length;o++)for(c=n[s[o]],i=0;i<c.length;i++)y.push(l.c2l(c[i].pos,!0)),v+=(c[i].pts2||[]).length;if(y.length){var _=d.distinctVals(y);l.type!=="category"&&l.type!=="multicategory"||(_.minDiff=1);var x=_.minDiff/2;t.minDtick(l,_.minDiff,_.vals[0],!0);var T=a[f==="violin"?"_numViolins":"_numBoxes"],A=a[f+"mode"]==="group"&&T>1,S=1-a[f+"gap"],w=1-a[f+"groupgap"];for(o=0;o<s.length;o++){var C,k,L,M,P,D,N=(c=n[s[o]])[0].trace,U=c[0].t,q=N.width,X=N.side;if(q)C=k=M=q/2,L=0;else if(C=x,A){var K=m(a,l._id)+N.orientation,Z=(a._alignmentOpts[K]||{})[N.alignmentgroup]||{},H=Object.keys(Z.offsetGroups||{}).length,Y=H||T;k=C*S*w/Y,L=2*C*(((H?N._offsetIndex:U.num)+.5)/Y-.5)*S,M=C*S/Y}else k=C*S*w,L=0,M=C;U.dPos=C,U.bPos=L,U.bdPos=k,U.wHover=M;var $,z,j,W,ee,J,Q=L+k,te=Boolean(q);if(X==="positive"?(P=C*(q?1:.5),$=Q,D=$=L):X==="negative"?(P=$=L,D=C*(q?1:.5),z=Q):(P=D=C,$=z=Q),(N.boxpoints||N.points)&&v>0){var ie=N.pointpos,ae=N.jitter,he=N.marker.size/2,se=0;ie+ae>=0&&((se=Q*(ie+ae))>P?(te=!0,ee=he,j=se):se>$&&(ee=he,j=P)),se<=P&&(j=P);var de=0;ie-ae<=0&&((de=-Q*(ie-ae))>D?(te=!0,J=he,W=de):de>z&&(J=he,W=D)),de<=D&&(W=D)}else j=P,W=D;var ue=new Array(c.length);for(i=0;i<c.length;i++)ue[i]=c[i].pos;N._extremes[g]=t.findExtremes(l,ue,{padded:te,vpadminus:W,vpadplus:j,vpadLinearized:!0,ppadminus:{x:J,y:ee}[h],ppadplus:{x:ee,y:J}[h]})}}}O.exports={crossTraceCalc:function(f,u){for(var s=f.calcdata,l=u.xaxis,o=u.yaxis,i=0;i<p.length;i++){for(var c=p[i],n=c==="h"?o:l,a=[],g=0;g<s.length;g++){var h=s[g],y=h[0].t,v=h[0].trace;v.visible!==!0||v.type!=="box"&&v.type!=="candlestick"||y.empty||(v.orientation||"v")!==c||v.xaxis!==l._id||v.yaxis!==o._id||a.push(g)}e("box",f,a,n)}},setPositionOffset:e}},{"../../lib":787,"../../plots/cartesian/axes":838,"../../plots/cartesian/constraints":846}],953:[function(r,O,B){var t=r("../../lib"),d=r("../../registry"),m=r("../../components/color"),p=r("../scatter/period_defaults"),e=r("../bar/defaults").handleGroupingDefaults,f=r("../../plots/cartesian/axis_autotype"),u=r("./attributes");function s(o,i,c,n){function a(X){var K=0;return X&&X.length&&(K+=1,t.isArrayOrTypedArray(X[0])&&X[0].length&&(K+=1)),K}function g(X){return t.validate(o[X],u[X])}var h,y=c("y"),v=c("x");if(i.type==="box"){var _=c("q1"),x=c("median"),T=c("q3");i._hasPreCompStats=_&&_.length&&x&&x.length&&T&&T.length,h=Math.min(t.minRowLength(_),t.minRowLength(x),t.minRowLength(T))}var A,S,w=a(y),C=a(v),k=w&&t.minRowLength(y),L=C&&t.minRowLength(v),M=n.calendar,P={autotypenumbers:n.autotypenumbers};if(i._hasPreCompStats)switch(String(C)+String(w)){case"00":var D=g("x0")||g("dx");A=(g("y0")||g("dy"))&&!D?"h":"v",S=h;break;case"10":A="v",S=Math.min(h,L);break;case"20":A="h",S=Math.min(h,v.length);break;case"01":A="h",S=Math.min(h,k);break;case"02":A="v",S=Math.min(h,y.length);break;case"12":A="v",S=Math.min(h,L,y.length);break;case"21":A="h",S=Math.min(h,v.length,k);break;case"11":S=0;break;case"22":var N,U=!1;for(N=0;N<v.length;N++)if(f(v[N],M,P)==="category"){U=!0;break}if(U)A="v",S=Math.min(h,L,y.length);else{for(N=0;N<y.length;N++)if(f(y[N],M,P)==="category"){U=!0;break}U?(A="h",S=Math.min(h,v.length,k)):(A="v",S=Math.min(h,L,y.length))}}else w>0?(A="v",S=C>0?Math.min(L,k):Math.min(k)):C>0?(A="h",S=Math.min(L)):S=0;if(S){i._length=S;var q=c("orientation",A);i._hasPreCompStats?q==="v"&&C===0?(c("x0",0),c("dx",1)):q==="h"&&w===0&&(c("y0",0),c("dy",1)):q==="v"&&C===0?c("x0"):q==="h"&&w===0&&c("y0"),d.getComponentMethod("calendars","handleTraceDefaults")(o,i,["x","y"],n)}else i.visible=!1}function l(o,i,c,n){var a=n.prefix,g=t.coerce2(o,i,u,"marker.outliercolor"),h=c("marker.line.outliercolor"),y="outliers";i._hasPreCompStats?y="all":(g||h)&&(y="suspectedoutliers");var v=c(a+"points",y);v?(c("jitter",v==="all"?.3:0),c("pointpos",v==="all"?-1.5:0),c("marker.symbol"),c("marker.opacity"),c("marker.size"),c("marker.color",i.line.color),c("marker.line.color"),c("marker.line.width"),v==="suspectedoutliers"&&(c("marker.line.outliercolor",i.marker.color),c("marker.line.outlierwidth")),c("selected.marker.color"),c("unselected.marker.color"),c("selected.marker.size"),c("unselected.marker.size"),c("text"),c("hovertext")):delete i.marker;var _=c("hoveron");_!=="all"&&_.indexOf("points")===-1||c("hovertemplate"),t.coerceSelectionMarkerOpacity(i,c)}O.exports={supplyDefaults:function(o,i,c,n){function a(T,A){return t.coerce(o,i,u,T,A)}if(s(o,i,a,n),i.visible!==!1){p(o,i,n,a),a("xhoverformat"),a("yhoverformat");var g=i._hasPreCompStats;g&&(a("lowerfence"),a("upperfence")),a("line.color",(o.marker||{}).color||c),a("line.width"),a("fillcolor",m.addOpacity(i.line.color,.5));var h=!1;if(g){var y=a("mean"),v=a("sd");y&&y.length&&(h=!0,v&&v.length&&(h="sd"))}a("boxmean",h),a("whiskerwidth"),a("width"),a("quartilemethod");var _=!1;if(g){var x=a("notchspan");x&&x.length&&(_=!0)}else t.validate(o.notchwidth,u.notchwidth)&&(_=!0);a("notched",_)&&a("notchwidth"),l(o,i,a,{prefix:"box"})}},crossTraceDefaults:function(o,i){var c,n;function a(y){return t.coerce(n._input,n,u,y)}for(var g=0;g<o.length;g++){var h=(n=o[g]).type;h!=="box"&&h!=="violin"||(c=n._input,i[h+"mode"]==="group"&&e(c,n,i,a))}},handleSampleDefaults:s,handlePointsDefaults:l}},{"../../components/color":650,"../../lib":787,"../../plots/cartesian/axis_autotype":839,"../../registry":915,"../bar/defaults":929,"../scatter/period_defaults":1222,"./attributes":950}],954:[function(r,O,B){O.exports=function(t,d){return d.hoverOnBox&&(t.hoverOnBox=d.hoverOnBox),"xVal"in d&&(t.x=d.xVal),"yVal"in d&&(t.y=d.yVal),d.xa&&(t.xaxis=d.xa),d.ya&&(t.yaxis=d.ya),t}},{}],955:[function(r,O,B){var t=r("../../plots/cartesian/axes"),d=r("../../lib"),m=r("../../components/fx"),p=r("../../components/color"),e=d.fillText;function f(s,l,o,i){var c,n,a,g,h,y,v,_,x,T,A,S,w,C,k=s.cd,L=s.xa,M=s.ya,P=k[0].trace,D=k[0].t,N=P.type==="violin",U=[],q=D.bdPos,X=D.wHover,K=function(se){return a.c2l(se.pos)+D.bPos-a.c2l(y)};N&&P.side!=="both"?(P.side==="positive"&&(x=function(se){var de=K(se);return m.inbox(de,de+X,T)},S=q,w=0),P.side==="negative"&&(x=function(se){var de=K(se);return m.inbox(de-X,de,T)},S=0,w=q)):(x=function(se){var de=K(se);return m.inbox(de-X,de+X,T)},S=w=q),C=N?function(se){return m.inbox(se.span[0]-h,se.span[1]-h,T)}:function(se){return m.inbox(se.min-h,se.max-h,T)},P.orientation==="h"?(h=l,y=o,v=C,_=x,c="y",a=M,n="x",g=L):(h=o,y=l,v=x,_=C,c="x",a=L,n="y",g=M);var Z=Math.min(1,q/Math.abs(a.r2c(a.range[1])-a.r2c(a.range[0])));function H(se){return(v(se)+_(se))/2}T=s.maxHoverDistance-Z,A=s.maxSpikeDistance-Z;var Y=m.getDistanceFunction(i,v,_,H);if(m.getClosest(k,Y,s),s.index===!1)return[];var $=k[s.index],z=P.line.color,j=(P.marker||{}).color;p.opacity(z)&&P.line.width?s.color=z:p.opacity(j)&&P.boxpoints?s.color=j:s.color=P.fillcolor,s[c+"0"]=a.c2p($.pos+D.bPos-w,!0),s[c+"1"]=a.c2p($.pos+D.bPos+S,!0),s[c+"LabelVal"]=$.orig_p!==void 0?$.orig_p:$.pos;var W=c+"Spike";s.spikeDistance=H($)*A/T,s[W]=a.c2p($.pos,!0);var ee={},J=["med","q1","q3","min","max"];(P.boxmean||(P.meanline||{}).visible)&&J.push("mean"),(P.boxpoints||P.points)&&J.push("lf","uf");for(var Q=0;Q<J.length;Q++){var te=J[Q];if(te in $&&!($[te]in ee)){ee[$[te]]=!0;var ie=$[te],ae=g.c2p(ie,!0),he=d.extendFlat({},s);he.attr=te,he[n+"0"]=he[n+"1"]=ae,he[n+"LabelVal"]=ie,he[n+"Label"]=(D.labels?D.labels[te]+" ":"")+t.hoverLabelText(g,ie,P[n+"hoverformat"]),he.hoverOnBox=!0,te==="mean"&&"sd"in $&&P.boxmean==="sd"&&(he[n+"err"]=$.sd),s.name="",s.spikeDistance=void 0,s[W]=void 0,he.hovertemplate=!1,U.push(he)}}return U}function u(s,l,o){for(var i,c,n,a=s.cd,g=s.xa,h=s.ya,y=a[0].trace,v=g.c2p(l),_=h.c2p(o),x=m.quadrature(function(N){var U=Math.max(3,N.mrc||0);return Math.max(Math.abs(g.c2p(N.x)-v)-U,1-3/U)},function(N){var U=Math.max(3,N.mrc||0);return Math.max(Math.abs(h.c2p(N.y)-_)-U,1-3/U)}),T=!1,A=0;A<a.length;A++){c=a[A];for(var S=0;S<(c.pts||[]).length;S++){var w=x(n=c.pts[S]);w<=s.distance&&(s.distance=w,T=[A,S])}}if(!T)return!1;n=(c=a[T[0]]).pts[T[1]];var C=g.c2p(n.x,!0),k=h.c2p(n.y,!0),L=n.mrc||1;i=d.extendFlat({},s,{index:n.i,color:(y.marker||{}).color,name:y.name,x0:C-L,x1:C+L,y0:k-L,y1:k+L,spikeDistance:s.distance,hovertemplate:y.hovertemplate});var M,P=c.orig_p,D=P!==void 0?P:c.pos;return y.orientation==="h"?(M=h,i.xLabelVal=n.x,i.yLabelVal=D):(M=g,i.xLabelVal=D,i.yLabelVal=n.y),i[M._id.charAt(0)+"Spike"]=M.c2p(c.pos,!0),e(n,y,i),i}O.exports={hoverPoints:function(s,l,o,i){var c,n=s.cd[0].trace.hoveron,a=[];return n.indexOf("boxes")!==-1&&(a=a.concat(f(s,l,o,i))),n.indexOf("points")!==-1&&(c=u(s,l,o)),i==="closest"?c?[c]:a:(c&&a.push(c),a)},hoverOnBoxes:f,hoverOnPoints:u}},{"../../components/color":650,"../../components/fx":690,"../../lib":787,"../../plots/cartesian/axes":838}],956:[function(r,O,B){O.exports={attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults").supplyDefaults,crossTraceDefaults:r("./defaults").crossTraceDefaults,supplyLayoutDefaults:r("./layout_defaults").supplyLayoutDefaults,calc:r("./calc"),crossTraceCalc:r("./cross_trace_calc").crossTraceCalc,plot:r("./plot").plot,style:r("./style").style,styleOnSelect:r("./style").styleOnSelect,hoverPoints:r("./hover").hoverPoints,eventData:r("./event_data"),selectPoints:r("./select"),moduleType:"trace",name:"box",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"./attributes":950,"./calc":951,"./cross_trace_calc":952,"./defaults":953,"./event_data":954,"./hover":955,"./layout_attributes":957,"./layout_defaults":958,"./plot":959,"./select":960,"./style":961}],957:[function(r,O,B){O.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],958:[function(r,O,B){var t=r("../../registry"),d=r("../../lib"),m=r("./layout_attributes");function p(e,f,u,s,l){for(var o=l+"Layout",i=!1,c=0;c<u.length;c++){var n=u[c];if(t.traceIs(n,o)){i=!0;break}}i&&(s(l+"mode"),s(l+"gap"),s(l+"groupgap"))}O.exports={supplyLayoutDefaults:function(e,f,u){p(0,0,u,function(s,l){return d.coerce(e,f,m,s,l)},"box")},_supply:p}},{"../../lib":787,"../../registry":915,"./layout_attributes":957}],959:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../components/drawing");function p(u,s,l,o){var i,c,n=l.orientation==="h",a=s.val,g=s.pos,h=!!g.rangebreaks,y=o.bPos,v=o.wdPos||0,_=o.bPosPxOffset||0,x=l.whiskerwidth||0,T=l.notched||!1,A=T?1-2*l.notchwidth:1;Array.isArray(o.bdPos)?(i=o.bdPos[0],c=o.bdPos[1]):(i=o.bdPos,c=o.bdPos);var S=u.selectAll("path.box").data(l.type!=="violin"||l.box.visible?d.identity:[]);S.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),S.exit().remove(),S.each(function(w){if(w.empty)return"M0,0Z";var C=g.c2l(w.pos+y,!0),k=g.l2p(C-i)+_,L=g.l2p(C+c)+_,M=h?(k+L)/2:g.l2p(C)+_,P=l.whiskerwidth,D=h?k*P+(1-P)*M:g.l2p(C-v)+_,N=h?L*P+(1-P)*M:g.l2p(C+v)+_,U=g.l2p(C-i*A)+_,q=g.l2p(C+c*A)+_,X=a.c2p(w.q1,!0),K=a.c2p(w.q3,!0),Z=d.constrain(a.c2p(w.med,!0),Math.min(X,K)+1,Math.max(X,K)-1),H=w.lf===void 0||l.boxpoints===!1,Y=a.c2p(H?w.min:w.lf,!0),$=a.c2p(H?w.max:w.uf,!0),z=a.c2p(w.ln,!0),j=a.c2p(w.un,!0);n?t.select(this).attr("d","M"+Z+","+U+"V"+q+"M"+X+","+k+"V"+L+(T?"H"+z+"L"+Z+","+q+"L"+j+","+L:"")+"H"+K+"V"+k+(T?"H"+j+"L"+Z+","+U+"L"+z+","+k:"")+"ZM"+X+","+M+"H"+Y+"M"+K+","+M+"H"+$+(x===0?"":"M"+Y+","+D+"V"+N+"M"+$+","+D+"V"+N)):t.select(this).attr("d","M"+U+","+Z+"H"+q+"M"+k+","+X+"H"+L+(T?"V"+z+"L"+q+","+Z+"L"+L+","+j:"")+"V"+K+"H"+k+(T?"V"+j+"L"+U+","+Z+"L"+k+","+z:"")+"ZM"+M+","+X+"V"+Y+"M"+M+","+K+"V"+$+(x===0?"":"M"+D+","+Y+"H"+N+"M"+D+","+$+"H"+N))})}function e(u,s,l,o){var i=s.x,c=s.y,n=o.bdPos,a=o.bPos,g=l.boxpoints||l.points;d.seedPseudoRandom();var h=u.selectAll("g.points").data(g?function(v){return v.forEach(function(_){_.t=o,_.trace=l}),v}:[]);h.enter().append("g").attr("class","points"),h.exit().remove();var y=h.selectAll("path").data(function(v){var _,x,T=v.pts2,A=Math.max((v.max-v.min)/10,v.q3-v.q1),S=1e-9*A,w=.01*A,C=[],k=0;if(l.jitter){if(A===0)for(k=1,C=new Array(T.length),_=0;_<T.length;_++)C[_]=1;else for(_=0;_<T.length;_++){var L=Math.max(0,_-5),M=T[L].v,P=Math.min(T.length-1,_+5),D=T[P].v;g!=="all"&&(T[_].v<v.lf?D=Math.min(D,v.lf):M=Math.max(M,v.uf));var N=Math.sqrt(w*(P-L)/(D-M+S))||0;N=d.constrain(Math.abs(N),0,1),C.push(N),k=Math.max(N,k)}x=2*l.jitter/(k||1)}for(_=0;_<T.length;_++){var U=T[_],q=U.v,X=l.jitter?x*C[_]*(d.pseudoRandom()-.5):0,K=v.pos+a+n*(l.pointpos+X);l.orientation==="h"?(U.y=K,U.x=q):(U.x=K,U.y=q),g==="suspectedoutliers"&&q<v.uo&&q>v.lo&&(U.so=!0)}return T});y.enter().append("path").classed("point",!0),y.exit().remove(),y.call(m.translatePoints,i,c)}function f(u,s,l,o){var i,c,n=s.val,a=s.pos,g=!!a.rangebreaks,h=o.bPos,y=o.bPosPxOffset||0,v=l.boxmean||(l.meanline||{}).visible;Array.isArray(o.bdPos)?(i=o.bdPos[0],c=o.bdPos[1]):(i=o.bdPos,c=o.bdPos);var _=u.selectAll("path.mean").data(l.type==="box"&&l.boxmean||l.type==="violin"&&l.box.visible&&l.meanline.visible?d.identity:[]);_.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),_.exit().remove(),_.each(function(x){var T=a.c2l(x.pos+h,!0),A=a.l2p(T-i)+y,S=a.l2p(T+c)+y,w=g?(A+S)/2:a.l2p(T)+y,C=n.c2p(x.mean,!0),k=n.c2p(x.mean-x.sd,!0),L=n.c2p(x.mean+x.sd,!0);l.orientation==="h"?t.select(this).attr("d","M"+C+","+A+"V"+S+(v==="sd"?"m0,0L"+k+","+w+"L"+C+","+A+"L"+L+","+w+"Z":"")):t.select(this).attr("d","M"+A+","+C+"H"+S+(v==="sd"?"m0,0L"+w+","+k+"L"+A+","+C+"L"+w+","+L+"Z":""))})}O.exports={plot:function(u,s,l,o){var i=s.xaxis,c=s.yaxis;d.makeTraceGroups(o,l,"trace boxes").each(function(n){var a,g,h=t.select(this),y=n[0],v=y.t,_=y.trace;v.wdPos=v.bdPos*_.whiskerwidth,_.visible!==!0||v.empty?h.remove():(_.orientation==="h"?(a=c,g=i):(a=i,g=c),p(h,{pos:a,val:g},_,v),e(h,{x:i,y:c},_,v),f(h,{pos:a,val:g},_,v))})},plotBoxAndWhiskers:p,plotPoints:e,plotBoxMean:f}},{"../../components/drawing":672,"../../lib":787,"@plotly/d3":58}],960:[function(r,O,B){O.exports=function(t,d){var m,p,e=t.cd,f=t.xaxis,u=t.yaxis,s=[];if(d===!1)for(m=0;m<e.length;m++)for(p=0;p<(e[m].pts||[]).length;p++)e[m].pts[p].selected=0;else for(m=0;m<e.length;m++)for(p=0;p<(e[m].pts||[]).length;p++){var l=e[m].pts[p],o=f.c2p(l.x),i=u.c2p(l.y);d.contains([o,i],null,l.i,t)?(s.push({pointNumber:l.i,x:f.c2d(l.x),y:u.c2d(l.y)}),l.selected=1):l.selected=0}return s}},{}],961:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/color"),m=r("../../components/drawing");O.exports={style:function(p,e,f){var u=f||t.select(p).selectAll("g.trace.boxes");u.style("opacity",function(s){return s[0].trace.opacity}),u.each(function(s){var l=t.select(this),o=s[0].trace,i=o.line.width;function c(g,h,y,v){g.style("stroke-width",h+"px").call(d.stroke,y).call(d.fill,v)}var n=l.selectAll("path.box");if(o.type==="candlestick")n.each(function(g){if(!g.empty){var h=t.select(this),y=o[g.dir];c(h,y.line.width,y.line.color,y.fillcolor),h.style("opacity",o.selectedpoints&&!g.selected?.3:1)}});else{c(n,i,o.line.color,o.fillcolor),l.selectAll("path.mean").style({"stroke-width":i,"stroke-dasharray":2*i+"px,"+i+"px"}).call(d.stroke,o.line.color);var a=l.selectAll("path.point");m.pointStyle(a,o,p)}})},styleOnSelect:function(p,e,f){var u=e[0].trace,s=f.selectAll("path.point");u.selectedpoints?m.selectedPointStyle(s,u):m.pointStyle(s,u,p)}}},{"../../components/color":650,"../../components/drawing":672,"@plotly/d3":58}],962:[function(r,O,B){var t=r("../../lib").extendFlat,d=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=r("../ohlc/attributes"),p=r("../box/attributes");function e(f){return{line:{color:t({},p.line.color,{dflt:f}),width:p.line.width,editType:"style"},fillcolor:p.fillcolor,editType:"style"}}O.exports={xperiod:m.xperiod,xperiod0:m.xperiod0,xperiodalignment:m.xperiodalignment,xhoverformat:d("x"),yhoverformat:d("y"),x:m.x,open:m.open,high:m.high,low:m.low,close:m.close,line:{width:t({},p.line.width,{}),editType:"style"},increasing:e(m.increasing.line.color.dflt),decreasing:e(m.decreasing.line.color.dflt),text:m.text,hovertext:m.hovertext,whiskerwidth:t({},p.whiskerwidth,{dflt:0}),hoverlabel:m.hoverlabel}},{"../../lib":787,"../../plots/cartesian/axis_format_attributes":841,"../box/attributes":950,"../ohlc/attributes":1148}],963:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("../../plots/cartesian/align_period"),p=r("../ohlc/calc").calcCommon;function e(f,u,s,l){return{min:s,q1:Math.min(f,l),med:l,q3:Math.max(f,l),max:u}}O.exports=function(f,u){var s=f._fullLayout,l=d.getFromId(f,u.xaxis),o=d.getFromId(f,u.yaxis),i=l.makeCalcdata(u,"x"),c=m(u,l,"x",i).vals,n=p(f,u,i,c,o,e);return n.length?(t.extendFlat(n[0].t,{num:s._numBoxes,dPos:t.distinctVals(c).minDiff/2,posLetter:"x",valLetter:"y"}),s._numBoxes++,n):[{t:{empty:!0}}]}},{"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../ohlc/calc":1149}],964:[function(r,O,B){var t=r("../../lib"),d=r("../../components/color"),m=r("../ohlc/ohlc_defaults"),p=r("../scatter/period_defaults"),e=r("./attributes");function f(u,s,l,o){var i=l(o+".line.color");l(o+".line.width",s.line.width),l(o+".fillcolor",d.addOpacity(i,.5))}O.exports=function(u,s,l,o){function i(c,n){return t.coerce(u,s,e,c,n)}m(u,s,i,o)?(p(u,s,o,i,{x:!0}),i("xhoverformat"),i("yhoverformat"),i("line.width"),f(u,s,i,"increasing"),f(u,s,i,"decreasing"),i("text"),i("hovertext"),i("whiskerwidth"),o._requestRangeslider[s.xaxis]=!0):s.visible=!1}},{"../../components/color":650,"../../lib":787,"../ohlc/ohlc_defaults":1153,"../scatter/period_defaults":1222,"./attributes":962}],965:[function(r,O,B){O.exports={moduleType:"trace",name:"candlestick",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:r("./attributes"),layoutAttributes:r("../box/layout_attributes"),supplyLayoutDefaults:r("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:r("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("../box/plot").plot,layerName:"boxlayer",style:r("../box/style").style,hoverPoints:r("../ohlc/hover").hoverPoints,selectPoints:r("../ohlc/select")}},{"../../plots/cartesian":852,"../box/cross_trace_calc":952,"../box/layout_attributes":957,"../box/layout_defaults":958,"../box/plot":959,"../box/style":961,"../ohlc/hover":1151,"../ohlc/select":1155,"./attributes":962,"./calc":963,"./defaults":964}],966:[function(r,O,B){var t=r("./axis_defaults"),d=r("../../plot_api/plot_template");O.exports=function(m,p,e,f,u){f("a")||(f("da"),f("a0")),f("b")||(f("db"),f("b0")),function(s,l,o,i){["aaxis","baxis"].forEach(function(c){var n=c.charAt(0),a=s[c]||{},g=d.newContainer(l,c),h={tickfont:"x",id:n+"axis",letter:n,font:l.font,name:c,data:s[n],calendar:l.calendar,dfltColor:i,bgColor:o.paper_bgcolor,autotypenumbersDflt:o.autotypenumbers,fullLayout:o};t(a,g,h),g._categories=g._categories||[],s[c]||a.type==="-"||(s[c]={type:a.type})})}(m,p,e,u)}},{"../../plot_api/plot_template":827,"./axis_defaults":971}],967:[function(r,O,B){var t=r("../../lib").isArrayOrTypedArray;O.exports=function(d){return function m(p,e){if(!t(p)||e>=10)return null;for(var f=1/0,u=-1/0,s=p.length,l=0;l<s;l++){var o=p[l];if(t(o)){var i=m(o,e+1);i&&(f=Math.min(i[0],f),u=Math.max(i[1],u))}else f=Math.min(o,f),u=Math.max(o,u)}return[f,u]}(d,0)}},{"../../lib":787}],968:[function(r,O,B){var t=r("../../plots/font_attributes"),d=r("./axis_attributes"),m=r("../../components/color/attributes"),p=t({editType:"calc"});p.family.dflt='"Open Sans", verdana, arial, sans-serif',p.size.dflt=12,p.color.dflt=m.defaultLine,O.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:d,baxis:d,font:p,color:{valType:"color",dflt:m.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":649,"../../plots/font_attributes":867,"./axis_attributes":970}],969:[function(r,O,B){var t=r("../../lib").isArrayOrTypedArray;O.exports=function(d,m,p,e){var f,u,s,l,o,i,c,n,a,g,h,y,v,_=t(p)?"a":"b",x=(_==="a"?d.aaxis:d.baxis).smoothing,T=_==="a"?d.a2i:d.b2j,A=_==="a"?p:e,S=_==="a"?e:p,w=_==="a"?m.a.length:m.b.length,C=_==="a"?m.b.length:m.a.length,k=Math.floor(_==="a"?d.b2j(S):d.a2i(S)),L=_==="a"?function($){return d.evalxy([],$,k)}:function($){return d.evalxy([],k,$)};x&&(s=Math.max(0,Math.min(C-2,k)),l=k-s,u=_==="a"?function($,z){return d.dxydi([],$,s,z,l)}:function($,z){return d.dxydj([],s,$,l,z)});var M=T(A[0]),P=T(A[1]),D=M<P?1:-1,N=1e-8*(P-M),U=D>0?Math.floor:Math.ceil,q=D>0?Math.ceil:Math.floor,X=D>0?Math.min:Math.max,K=D>0?Math.max:Math.min,Z=U(M+N),H=q(P-N),Y=[[c=L(M)]];for(f=Z;f*D<H*D;f+=D)o=[],h=K(M,f),v=(y=X(P,f+D))-h,i=Math.max(0,Math.min(w-2,Math.floor(.5*(h+y)))),n=L(y),x&&(a=u(i,h-i),g=u(i,y-i),o.push([c[0]+a[0]/3*v,c[1]+a[1]/3*v]),o.push([n[0]-g[0]/3*v,n[1]-g[1]/3*v])),o.push(n),Y.push(o),c=n;return Y}},{"../../lib":787}],970:[function(r,O,B){var t=r("../../plots/font_attributes"),d=r("../../components/color/attributes"),m=r("../../plots/cartesian/layout_attributes"),p=r("../../plots/cartesian/axis_format_attributes").descriptionWithDates,e=r("../../plot_api/edit_types").overrideAll;O.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:t({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:m.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:t({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:p("tick label")},tickformatstops:e(m.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:d.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:d.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:t({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":649,"../../plot_api/edit_types":820,"../../plots/cartesian/axis_format_attributes":841,"../../plots/cartesian/layout_attributes":853,"../../plots/font_attributes":867}],971:[function(r,O,B){var t=r("./attributes"),d=r("../../components/color").addOpacity,m=r("../../registry"),p=r("../../lib"),e=r("../../plots/cartesian/tick_value_defaults"),f=r("../../plots/cartesian/tick_label_defaults"),u=r("../../plots/cartesian/category_order_defaults"),s=r("../../plots/cartesian/set_convert"),l=r("../../plots/cartesian/axis_autotype");O.exports=function(o,i,c){var n=c.letter,a=c.font||{},g=t[n+"axis"];function h(M,P){return p.coerce(o,i,g,M,P)}function y(M,P){return p.coerce2(o,i,g,M,P)}c.name&&(i._name=c.name,i._id=c.name),h("autotypenumbers",c.autotypenumbersDflt);var v=h("type");v==="-"&&(c.data&&function(M,P){if(M.type==="-"){var D=M._id.charAt(0),N=M[D+"calendar"];M.type=l(P,N,{autotypenumbers:M.autotypenumbers})}}(i,c.data),i.type==="-"?i.type="linear":v=o.type=i.type),h("smoothing"),h("cheatertype"),h("showticklabels"),h("labelprefix",n+" = "),h("labelsuffix"),h("showtickprefix"),h("showticksuffix"),h("separatethousands"),h("tickformat"),h("exponentformat"),h("minexponent"),h("showexponent"),h("categoryorder"),h("tickmode"),h("tickvals"),h("ticktext"),h("tick0"),h("dtick"),i.tickmode==="array"&&(h("arraytick0"),h("arraydtick")),h("labelpadding"),i._hovertitle=n,v==="date"&&m.getComponentMethod("calendars","handleDefaults")(o,i,"calendar",c.calendar),s(i,c.fullLayout),i.c2p=p.identity;var _=h("color",c.dfltColor),x=_===o.color?_:a.color;h("title.text")&&(p.coerceFont(h,"title.font",{family:a.family,size:p.bigFont(a.size),color:x}),h("title.offset")),h("tickangle"),h("autorange",!i.isValidRange(o.range))&&h("rangemode"),h("range"),i.cleanRange(),h("fixedrange"),e(o,i,h,v),f(o,i,h,v,c),u(o,i,h,{data:c.data,dataAttr:n});var T=y("gridcolor",d(_,.3)),A=y("gridwidth"),S=h("showgrid");S||(delete i.gridcolor,delete i.gridwidth);var w=y("startlinecolor",_),C=y("startlinewidth",A);h("startline",i.showgrid||!!w||!!C)||(delete i.startlinecolor,delete i.startlinewidth);var k=y("endlinecolor",_),L=y("endlinewidth",A);return h("endline",i.showgrid||!!k||!!L)||(delete i.endlinecolor,delete i.endlinewidth),S?(h("minorgridcount"),h("minorgridwidth",A),h("minorgridcolor",d(T,.06)),i.minorgridcount||(delete i.minorgridwidth,delete i.minorgridcolor)):(delete i.gridcolor,delete i.gridWidth),i.showticklabels==="none"&&(delete i.tickfont,delete i.tickangle,delete i.showexponent,delete i.exponentformat,delete i.minexponent,delete i.tickformat,delete i.showticksuffix,delete i.showtickprefix),i.showticksuffix||delete i.ticksuffix,i.showtickprefix||delete i.tickprefix,h("tickmode"),i}},{"../../components/color":650,"../../lib":787,"../../plots/cartesian/axis_autotype":839,"../../plots/cartesian/category_order_defaults":843,"../../plots/cartesian/set_convert":859,"../../plots/cartesian/tick_label_defaults":860,"../../plots/cartesian/tick_value_defaults":862,"../../registry":915,"./attributes":968}],972:[function(r,O,B){var t=r("../../plots/cartesian/axes"),d=r("../../lib").isArray1D,m=r("./cheater_basis"),p=r("./array_minmax"),e=r("./calc_gridlines"),f=r("./calc_labels"),u=r("./calc_clippath"),s=r("../heatmap/clean_2d_array"),l=r("./smooth_fill_2d_array"),o=r("../heatmap/convert_column_xyz"),i=r("./set_convert");O.exports=function(c,n){var a=t.getFromId(c,n.xaxis),g=t.getFromId(c,n.yaxis),h=n.aaxis,y=n.baxis,v=n.x,_=n.y,x=[];v&&d(v)&&x.push("x"),_&&d(_)&&x.push("y"),x.length&&o(n,h,y,"a","b",x);var T=n._a=n._a||n.a,A=n._b=n._b||n.b;v=n._x||n.x,_=n._y||n.y;var S={};if(n._cheater){var w=h.cheatertype==="index"?T.length:T,C=y.cheatertype==="index"?A.length:A;v=m(w,C,n.cheaterslope)}n._x=v=s(v),n._y=_=s(_),l(v,T,A),l(_,T,A),i(n),n.setScale();var k=p(v),L=p(_),M=.5*(k[1]-k[0]),P=.5*(k[1]+k[0]),D=.5*(L[1]-L[0]),N=.5*(L[1]+L[0]);return k=[P-1.3*M,P+1.3*M],L=[N-1.3*D,N+1.3*D],n._extremes[a._id]=t.findExtremes(a,k,{padded:!0}),n._extremes[g._id]=t.findExtremes(g,L,{padded:!0}),e(n,"a","b"),e(n,"b","a"),f(n,h),f(n,y),S.clipsegments=u(n._xctrl,n._yctrl,h,y),S.x=v,S.y=_,S.a=T,S.b=A,[S]}},{"../../lib":787,"../../plots/cartesian/axes":838,"../heatmap/clean_2d_array":1071,"../heatmap/convert_column_xyz":1073,"./array_minmax":967,"./calc_clippath":973,"./calc_gridlines":974,"./calc_labels":975,"./cheater_basis":977,"./set_convert":990,"./smooth_fill_2d_array":991}],973:[function(r,O,B){O.exports=function(t,d,m,p){var e,f,u,s=[],l=!!m.smoothing,o=!!p.smoothing,i=t[0].length-1,c=t.length-1;for(e=0,f=[],u=[];e<=i;e++)f[e]=t[0][e],u[e]=d[0][e];for(s.push({x:f,y:u,bicubic:l}),e=0,f=[],u=[];e<=c;e++)f[e]=t[e][i],u[e]=d[e][i];for(s.push({x:f,y:u,bicubic:o}),e=i,f=[],u=[];e>=0;e--)f[i-e]=t[c][e],u[i-e]=d[c][e];for(s.push({x:f,y:u,bicubic:l}),e=c,f=[],u=[];e>=0;e--)f[c-e]=t[e][0],u[c-e]=d[e][0];return s.push({x:f,y:u,bicubic:o}),s}},{}],974:[function(r,O,B){var t=r("../../plots/cartesian/axes"),d=r("../../lib/extend").extendFlat;O.exports=function(m,p,e){var f,u,s,l,o,i,c,n,a,g,h,y,v,_,x=m["_"+p],T=m[p+"axis"],A=T._gridlines=[],S=T._minorgridlines=[],w=T._boundarylines=[],C=m["_"+e],k=m[e+"axis"];T.tickmode==="array"&&(T.tickvals=x.slice());var L=m._xctrl,M=m._yctrl,P=L[0].length,D=L.length,N=m._a.length,U=m._b.length;t.prepTicks(T),T.tickmode==="array"&&delete T.tickvals;var q=T.smoothing?3:1;function X(Z){var H,Y,$,z,j,W,ee,J,Q,te,ie,ae,he=[],se=[],de={};if(p==="b")for(Y=m.b2j(Z),$=Math.floor(Math.max(0,Math.min(U-2,Y))),z=Y-$,de.length=U,de.crossLength=N,de.xy=function(ue){return m.evalxy([],ue,Y)},de.dxy=function(ue,ve){return m.dxydi([],ue,$,ve,z)},H=0;H<N;H++)W=Math.min(N-2,H),ee=H-W,J=m.evalxy([],H,Y),k.smoothing&&H>0&&(Q=m.dxydi([],H-1,$,0,z),he.push(j[0]+Q[0]/3),se.push(j[1]+Q[1]/3),te=m.dxydi([],H-1,$,1,z),he.push(J[0]-te[0]/3),se.push(J[1]-te[1]/3)),he.push(J[0]),se.push(J[1]),j=J;else for(H=m.a2i(Z),W=Math.floor(Math.max(0,Math.min(N-2,H))),ee=H-W,de.length=N,de.crossLength=U,de.xy=function(ue){return m.evalxy([],H,ue)},de.dxy=function(ue,ve){return m.dxydj([],W,ue,ee,ve)},Y=0;Y<U;Y++)$=Math.min(U-2,Y),z=Y-$,J=m.evalxy([],H,Y),k.smoothing&&Y>0&&(ie=m.dxydj([],W,Y-1,ee,0),he.push(j[0]+ie[0]/3),se.push(j[1]+ie[1]/3),ae=m.dxydj([],W,Y-1,ee,1),he.push(J[0]-ae[0]/3),se.push(J[1]-ae[1]/3)),he.push(J[0]),se.push(J[1]),j=J;return de.axisLetter=p,de.axis=T,de.crossAxis=k,de.value=Z,de.constvar=e,de.index=n,de.x=he,de.y=se,de.smoothing=k.smoothing,de}function K(Z){var H,Y,$,z,j,W=[],ee=[],J={};if(J.length=x.length,J.crossLength=C.length,p==="b")for($=Math.max(0,Math.min(U-2,Z)),j=Math.min(1,Math.max(0,Z-$)),J.xy=function(Q){return m.evalxy([],Q,Z)},J.dxy=function(Q,te){return m.dxydi([],Q,$,te,j)},H=0;H<P;H++)W[H]=L[Z*q][H],ee[H]=M[Z*q][H];else for(Y=Math.max(0,Math.min(N-2,Z)),z=Math.min(1,Math.max(0,Z-Y)),J.xy=function(Q){return m.evalxy([],Z,Q)},J.dxy=function(Q,te){return m.dxydj([],Y,Q,z,te)},H=0;H<D;H++)W[H]=L[H][Z*q],ee[H]=M[H][Z*q];return J.axisLetter=p,J.axis=T,J.crossAxis=k,J.value=x[Z],J.constvar=e,J.index=Z,J.x=W,J.y=ee,J.smoothing=k.smoothing,J}if(T.tickmode==="array"){for(l=5e-15,i=(o=[Math.floor((x.length-1-T.arraytick0)/T.arraydtick*(1+l)),Math.ceil(-T.arraytick0/T.arraydtick/(1+l))].sort(function(Z,H){return Z-H}))[0]-1,c=o[1]+1,n=i;n<c;n++)(u=T.arraytick0+T.arraydtick*n)<0||u>x.length-1||A.push(d(K(u),{color:T.gridcolor,width:T.gridwidth}));for(n=i;n<c;n++)if(s=T.arraytick0+T.arraydtick*n,h=Math.min(s+T.arraydtick,x.length-1),!(s<0||s>x.length-1||h<0||h>x.length-1))for(y=x[s],v=x[h],f=0;f<T.minorgridcount;f++)(_=h-s)<=0||(g=y+(v-y)*(f+1)/(T.minorgridcount+1)*(T.arraydtick/_))<x[0]||g>x[x.length-1]||S.push(d(X(g),{color:T.minorgridcolor,width:T.minorgridwidth}));T.startline&&w.push(d(K(0),{color:T.startlinecolor,width:T.startlinewidth})),T.endline&&w.push(d(K(x.length-1),{color:T.endlinecolor,width:T.endlinewidth}))}else{for(l=5e-15,i=(o=[Math.floor((x[x.length-1]-T.tick0)/T.dtick*(1+l)),Math.ceil((x[0]-T.tick0)/T.dtick/(1+l))].sort(function(Z,H){return Z-H}))[0],c=o[1],n=i;n<=c;n++)a=T.tick0+T.dtick*n,A.push(d(X(a),{color:T.gridcolor,width:T.gridwidth}));for(n=i-1;n<c+1;n++)for(a=T.tick0+T.dtick*n,f=0;f<T.minorgridcount;f++)(g=a+T.dtick*(f+1)/(T.minorgridcount+1))<x[0]||g>x[x.length-1]||S.push(d(X(g),{color:T.minorgridcolor,width:T.minorgridwidth}));T.startline&&w.push(d(X(x[0]),{color:T.startlinecolor,width:T.startlinewidth})),T.endline&&w.push(d(X(x[x.length-1]),{color:T.endlinecolor,width:T.endlinewidth}))}}},{"../../lib/extend":777,"../../plots/cartesian/axes":838}],975:[function(r,O,B){var t=r("../../plots/cartesian/axes"),d=r("../../lib/extend").extendFlat;O.exports=function(m,p){var e,f,u,s=p._labels=[],l=p._gridlines;for(e=0;e<l.length;e++)u=l[e],["start","both"].indexOf(p.showticklabels)!==-1&&(f=t.tickText(p,u.value),d(f,{prefix:void 0,suffix:void 0,endAnchor:!0,xy:u.xy(0),dxy:u.dxy(0,0),axis:u.axis,length:u.crossAxis.length,font:u.axis.tickfont,isFirst:e===0,isLast:e===l.length-1}),s.push(f)),["end","both"].indexOf(p.showticklabels)!==-1&&(f=t.tickText(p,u.value),d(f,{endAnchor:!1,xy:u.xy(u.crossLength-1),dxy:u.dxy(u.crossLength-2,1),axis:u.axis,length:u.crossAxis.length,font:u.axis.tickfont,isFirst:e===0,isLast:e===l.length-1}),s.push(f))}},{"../../lib/extend":777,"../../plots/cartesian/axes":838}],976:[function(r,O,B){O.exports=function(t,d,m,p){var e=t[0]-d[0],f=t[1]-d[1],u=m[0]-d[0],s=m[1]-d[1],l=Math.pow(e*e+f*f,.25),o=Math.pow(u*u+s*s,.25),i=(o*o*e-l*l*u)*p,c=(o*o*f-l*l*s)*p,n=o*(l+o)*3,a=l*(l+o)*3;return[[d[0]+(n&&i/n),d[1]+(n&&c/n)],[d[0]-(a&&i/a),d[1]-(a&&c/a)]]}},{}],977:[function(r,O,B){var t=r("../../lib").isArrayOrTypedArray;O.exports=function(d,m,p){var e,f,u,s,l,o,i=[],c=t(d)?d.length:d,n=t(m)?m.length:m,a=t(d)?d:null,g=t(m)?m:null;a&&(u=(a.length-1)/(a[a.length-1]-a[0])/(c-1)),g&&(s=(g.length-1)/(g[g.length-1]-g[0])/(n-1));var h=1/0,y=-1/0;for(f=0;f<n;f++)for(i[f]=[],l=g?(g[f]-g[0])*s:f/(n-1),e=0;e<c;e++)o=(a?(a[e]-a[0])*u:e/(c-1))-l*p,h=Math.min(o,h),y=Math.max(o,y),i[f][e]=o;var v=1/(y-h),_=-h*v;for(f=0;f<n;f++)for(e=0;e<c;e++)i[f][e]=v*i[f][e]+_;return i}},{"../../lib":787}],978:[function(r,O,B){var t=r("./catmull_rom"),d=r("../../lib").ensureArray;function m(p,e,f){var u=-.5*f[0]+1.5*e[0],s=-.5*f[1]+1.5*e[1];return[(2*u+p[0])/3,(2*s+p[1])/3]}O.exports=function(p,e,f,u,s,l){var o,i,c,n,a,g,h,y,v,_,x=f[0].length,T=f.length,A=s?3*x-2:x,S=l?3*T-2:T;for(p=d(p,S),e=d(e,S),c=0;c<S;c++)p[c]=d(p[c],A),e[c]=d(e[c],A);for(i=0,n=0;i<T;i++,n+=l?3:1)for(a=p[n],g=e[n],h=f[i],y=u[i],o=0,c=0;o<x;o++,c+=s?3:1)a[c]=h[o],g[c]=y[o];if(s)for(i=0,n=0;i<T;i++,n+=l?3:1){for(o=1,c=3;o<x-1;o++,c+=3)v=t([f[i][o-1],u[i][o-1]],[f[i][o],u[i][o]],[f[i][o+1],u[i][o+1]],s),p[n][c-1]=v[0][0],e[n][c-1]=v[0][1],p[n][c+1]=v[1][0],e[n][c+1]=v[1][1];_=m([p[n][0],e[n][0]],[p[n][2],e[n][2]],[p[n][3],e[n][3]]),p[n][1]=_[0],e[n][1]=_[1],_=m([p[n][A-1],e[n][A-1]],[p[n][A-3],e[n][A-3]],[p[n][A-4],e[n][A-4]]),p[n][A-2]=_[0],e[n][A-2]=_[1]}if(l)for(c=0;c<A;c++){for(n=3;n<S-3;n+=3)v=t([p[n-3][c],e[n-3][c]],[p[n][c],e[n][c]],[p[n+3][c],e[n+3][c]],l),p[n-1][c]=v[0][0],e[n-1][c]=v[0][1],p[n+1][c]=v[1][0],e[n+1][c]=v[1][1];_=m([p[0][c],e[0][c]],[p[2][c],e[2][c]],[p[3][c],e[3][c]]),p[1][c]=_[0],e[1][c]=_[1],_=m([p[S-1][c],e[S-1][c]],[p[S-3][c],e[S-3][c]],[p[S-4][c],e[S-4][c]]),p[S-2][c]=_[0],e[S-2][c]=_[1]}if(s&&l)for(n=1;n<S;n+=(n+1)%3==0?2:1){for(c=3;c<A-3;c+=3)v=t([p[n][c-3],e[n][c-3]],[p[n][c],e[n][c]],[p[n][c+3],e[n][c+3]],s),p[n][c-1]=.5*(p[n][c-1]+v[0][0]),e[n][c-1]=.5*(e[n][c-1]+v[0][1]),p[n][c+1]=.5*(p[n][c+1]+v[1][0]),e[n][c+1]=.5*(e[n][c+1]+v[1][1]);_=m([p[n][0],e[n][0]],[p[n][2],e[n][2]],[p[n][3],e[n][3]]),p[n][1]=.5*(p[n][1]+_[0]),e[n][1]=.5*(e[n][1]+_[1]),_=m([p[n][A-1],e[n][A-1]],[p[n][A-3],e[n][A-3]],[p[n][A-4],e[n][A-4]]),p[n][A-2]=.5*(p[n][A-2]+_[0]),e[n][A-2]=.5*(e[n][A-2]+_[1])}return[p,e]}},{"../../lib":787,"./catmull_rom":976}],979:[function(r,O,B){O.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],980:[function(r,O,B){O.exports=function(t,d,m){return d&&m?function(p,e,f,u,s){var l,o,i,c,n,a;p||(p=[]),e*=3,f*=3;var g=u*u,h=1-u,y=h*h,v=h*u*2,_=-3*y,x=3*(y-v),T=3*(v-g),A=3*g,S=s*s,w=S*s,C=1-s,k=C*C,L=k*C;for(a=0;a<t.length;a++)l=_*(n=t[a])[f][e]+x*n[f][e+1]+T*n[f][e+2]+A*n[f][e+3],o=_*n[f+1][e]+x*n[f+1][e+1]+T*n[f+1][e+2]+A*n[f+1][e+3],i=_*n[f+2][e]+x*n[f+2][e+1]+T*n[f+2][e+2]+A*n[f+2][e+3],c=_*n[f+3][e]+x*n[f+3][e+1]+T*n[f+3][e+2]+A*n[f+3][e+3],p[a]=L*l+3*(k*s*o+C*S*i)+w*c;return p}:d?function(p,e,f,u,s){var l,o,i,c;p||(p=[]),e*=3;var n=u*u,a=1-u,g=a*a,h=a*u*2,y=-3*g,v=3*(g-h),_=3*(h-n),x=3*n,T=1-s;for(i=0;i<t.length;i++)l=y*(c=t[i])[f][e]+v*c[f][e+1]+_*c[f][e+2]+x*c[f][e+3],o=y*c[f+1][e]+v*c[f+1][e+1]+_*c[f+1][e+2]+x*c[f+1][e+3],p[i]=T*l+s*o;return p}:m?function(p,e,f,u,s){var l,o,i,c,n,a;p||(p=[]),f*=3;var g=s*s,h=g*s,y=1-s,v=y*y,_=v*y;for(n=0;n<t.length;n++)l=(a=t[n])[f][e+1]-a[f][e],o=a[f+1][e+1]-a[f+1][e],i=a[f+2][e+1]-a[f+2][e],c=a[f+3][e+1]-a[f+3][e],p[n]=_*l+3*(v*s*o+y*g*i)+h*c;return p}:function(p,e,f,u,s){var l,o,i,c;p||(p=[]);var n=1-s;for(i=0;i<t.length;i++)l=(c=t[i])[f][e+1]-c[f][e],o=c[f+1][e+1]-c[f+1][e],p[i]=n*l+s*o;return p}}},{}],981:[function(r,O,B){O.exports=function(t,d,m){return d&&m?function(p,e,f,u,s){var l,o,i,c,n,a;p||(p=[]),e*=3,f*=3;var g=u*u,h=g*u,y=1-u,v=y*y,_=v*y,x=s*s,T=1-s,A=T*T,S=T*s*2,w=-3*A,C=3*(A-S),k=3*(S-x),L=3*x;for(a=0;a<t.length;a++)l=w*(n=t[a])[f][e]+C*n[f+1][e]+k*n[f+2][e]+L*n[f+3][e],o=w*n[f][e+1]+C*n[f+1][e+1]+k*n[f+2][e+1]+L*n[f+3][e+1],i=w*n[f][e+2]+C*n[f+1][e+2]+k*n[f+2][e+2]+L*n[f+3][e+2],c=w*n[f][e+3]+C*n[f+1][e+3]+k*n[f+2][e+3]+L*n[f+3][e+3],p[a]=_*l+3*(v*u*o+y*g*i)+h*c;return p}:d?function(p,e,f,u,s){var l,o,i,c,n,a;p||(p=[]),e*=3;var g=s*s,h=g*s,y=1-s,v=y*y,_=v*y;for(n=0;n<t.length;n++)l=(a=t[n])[f+1][e]-a[f][e],o=a[f+1][e+1]-a[f][e+1],i=a[f+1][e+2]-a[f][e+2],c=a[f+1][e+3]-a[f][e+3],p[n]=_*l+3*(v*s*o+y*g*i)+h*c;return p}:m?function(p,e,f,u,s){var l,o,i,c;p||(p=[]),f*=3;var n=1-u,a=s*s,g=1-s,h=g*g,y=g*s*2,v=-3*h,_=3*(h-y),x=3*(y-a),T=3*a;for(i=0;i<t.length;i++)l=v*(c=t[i])[f][e]+_*c[f+1][e]+x*c[f+2][e]+T*c[f+3][e],o=v*c[f][e+1]+_*c[f+1][e+1]+x*c[f+2][e+1]+T*c[f+3][e+1],p[i]=n*l+u*o;return p}:function(p,e,f,u,s){var l,o,i,c;p||(p=[]);var n=1-u;for(i=0;i<t.length;i++)l=(c=t[i])[f+1][e]-c[f][e],o=c[f+1][e+1]-c[f][e+1],p[i]=n*l+u*o;return p}}},{}],982:[function(r,O,B){O.exports=function(t,d,m,p,e){var f=d-2,u=m-2;return p&&e?function(s,l,o){var i,c,n,a,g,h;s||(s=[]);var y=Math.max(0,Math.min(Math.floor(l),f)),v=Math.max(0,Math.min(Math.floor(o),u)),_=Math.max(0,Math.min(1,l-y)),x=Math.max(0,Math.min(1,o-v));y*=3,v*=3;var T=_*_,A=T*_,S=1-_,w=S*S,C=w*S,k=x*x,L=k*x,M=1-x,P=M*M,D=P*M;for(h=0;h<t.length;h++)i=C*(g=t[h])[v][y]+3*(w*_*g[v][y+1]+S*T*g[v][y+2])+A*g[v][y+3],c=C*g[v+1][y]+3*(w*_*g[v+1][y+1]+S*T*g[v+1][y+2])+A*g[v+1][y+3],n=C*g[v+2][y]+3*(w*_*g[v+2][y+1]+S*T*g[v+2][y+2])+A*g[v+2][y+3],a=C*g[v+3][y]+3*(w*_*g[v+3][y+1]+S*T*g[v+3][y+2])+A*g[v+3][y+3],s[h]=D*i+3*(P*x*c+M*k*n)+L*a;return s}:p?function(s,l,o){s||(s=[]);var i,c,n,a,g,h,y=Math.max(0,Math.min(Math.floor(l),f)),v=Math.max(0,Math.min(Math.floor(o),u)),_=Math.max(0,Math.min(1,l-y)),x=Math.max(0,Math.min(1,o-v));y*=3;var T=_*_,A=T*_,S=1-_,w=S*S,C=w*S,k=1-x;for(g=0;g<t.length;g++)i=k*(h=t[g])[v][y]+x*h[v+1][y],c=k*h[v][y+1]+x*h[v+1][y+1],n=k*h[v][y+2]+x*h[v+1][y+1],a=k*h[v][y+3]+x*h[v+1][y+1],s[g]=C*i+3*(w*_*c+S*T*n)+A*a;return s}:e?function(s,l,o){s||(s=[]);var i,c,n,a,g,h,y=Math.max(0,Math.min(Math.floor(l),f)),v=Math.max(0,Math.min(Math.floor(o),u)),_=Math.max(0,Math.min(1,l-y)),x=Math.max(0,Math.min(1,o-v));v*=3;var T=x*x,A=T*x,S=1-x,w=S*S,C=w*S,k=1-_;for(g=0;g<t.length;g++)i=k*(h=t[g])[v][y]+_*h[v][y+1],c=k*h[v+1][y]+_*h[v+1][y+1],n=k*h[v+2][y]+_*h[v+2][y+1],a=k*h[v+3][y]+_*h[v+3][y+1],s[g]=C*i+3*(w*x*c+S*T*n)+A*a;return s}:function(s,l,o){s||(s=[]);var i,c,n,a,g=Math.max(0,Math.min(Math.floor(l),f)),h=Math.max(0,Math.min(Math.floor(o),u)),y=Math.max(0,Math.min(1,l-g)),v=Math.max(0,Math.min(1,o-h)),_=1-v,x=1-y;for(n=0;n<t.length;n++)i=x*(a=t[n])[h][g]+y*a[h][g+1],c=x*a[h+1][g]+y*a[h+1][g+1],s[n]=_*i+v*c;return s}}},{}],983:[function(r,O,B){var t=r("../../lib"),d=r("./xy_defaults"),m=r("./ab_defaults"),p=r("./attributes"),e=r("../../components/color/attributes");O.exports=function(f,u,s,l){function o(c,n){return t.coerce(f,u,p,c,n)}u._clipPathId="clip"+u.uid+"carpet";var i=o("color",e.defaultLine);t.coerceFont(o,"font"),o("carpet"),m(f,u,l,o,i),u.a&&u.b?(u.a.length<3&&(u.aaxis.smoothing=0),u.b.length<3&&(u.baxis.smoothing=0),d(f,u,o)||(u.visible=!1),u._cheater&&o("cheaterslope")):u.visible=!1}},{"../../components/color/attributes":649,"../../lib":787,"./ab_defaults":966,"./attributes":968,"./xy_defaults":992}],984:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),plot:r("./plot"),calc:r("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":852,"./attributes":968,"./calc":972,"./defaults":983,"./plot":989}],985:[function(r,O,B){O.exports=function(t,d){for(var m,p=t._fullData.length,e=0;e<p;e++){var f=t._fullData[e];if(f.index!==d.index&&f.type==="carpet"&&(m||(m=f),f.carpet===d.carpet))return f}return m}},{}],986:[function(r,O,B){O.exports=function(t,d,m){if(t.length===0)return"";var p,e=[],f=m?3:1;for(p=0;p<t.length;p+=f)e.push(t[p]+","+d[p]),m&&p<t.length-f&&(e.push("C"),e.push([t[p+1]+","+d[p+1],t[p+2]+","+d[p+2]+" "].join(" ")));return e.join(m?"":"L")}},{}],987:[function(r,O,B){var t=r("../../lib").isArrayOrTypedArray;O.exports=function(d,m,p){var e;for(t(d)?d.length>m.length&&(d=d.slice(0,m.length)):d=[],e=0;e<m.length;e++)d[e]=p(m[e]);return d}},{"../../lib":787}],988:[function(r,O,B){O.exports=function(t,d,m,p,e,f){var u=e[0]*t.dpdx(d),s=e[1]*t.dpdy(m),l=1,o=1;if(f){var i=Math.sqrt(e[0]*e[0]+e[1]*e[1]),c=Math.sqrt(f[0]*f[0]+f[1]*f[1]),n=(e[0]*f[0]+e[1]*f[1])/i/c;o=Math.max(0,n)}var a=180*Math.atan2(s,u)/Math.PI;return a<-90?(a+=180,l=-l):a>90&&(a-=180,l=-l),{angle:a,flip:l,p:t.c2p(p,d,m),offsetMultplier:o}}},{}],989:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/drawing"),m=r("./map_1d_array"),p=r("./makepath"),e=r("./orient_text"),f=r("../../lib/svg_text_utils"),u=r("../../lib"),s=u.strRotate,l=u.strTranslate,o=r("../../constants/alignment");function i(h,y,v,_,x,T){var A="const-"+x+"-lines",S=v.selectAll("."+A).data(T);S.enter().append("path").classed(A,!0).style("vector-effect","non-scaling-stroke"),S.each(function(w){var C=w,k=C.x,L=C.y,M=m([],k,h.c2p),P=m([],L,y.c2p),D="M"+p(M,P,C.smoothing);t.select(this).attr("d",D).style("stroke-width",C.width).style("stroke",C.color).style("fill","none")}),S.exit().remove()}function c(h,y,v,_,x,T,A,S){var w=T.selectAll("text."+S).data(A);w.enter().append("text").classed(S,!0);var C=0,k={};return w.each(function(L,M){var P;if(L.axis.tickangle==="auto")P=e(_,y,v,L.xy,L.dxy);else{var D=(L.axis.tickangle+180)*Math.PI/180;P=e(_,y,v,L.xy,[Math.cos(D),Math.sin(D)])}M||(k={angle:P.angle,flip:P.flip});var N=(L.endAnchor?-1:1)*P.flip,U=t.select(this).attr({"text-anchor":N>0?"start":"end","data-notex":1}).call(d.font,L.font).text(L.text).call(f.convertToTspans,h),q=d.bBox(this);U.attr("transform",l(P.p[0],P.p[1])+s(P.angle)+l(L.axis.labelpadding*N,.3*q.height)),C=Math.max(C,q.width+L.axis.labelpadding)}),w.exit().remove(),k.maxExtent=C,k}O.exports=function(h,y,v,_){var x=y.xaxis,T=y.yaxis,A=h._fullLayout._clips;u.makeTraceGroups(_,v,"trace").each(function(S){var w=t.select(this),C=S[0],k=C.trace,L=k.aaxis,M=k.baxis,P=u.ensureSingle(w,"g","minorlayer"),D=u.ensureSingle(w,"g","majorlayer"),N=u.ensureSingle(w,"g","boundarylayer"),U=u.ensureSingle(w,"g","labellayer");w.style("opacity",k.opacity),i(x,T,D,L,"a",L._gridlines),i(x,T,D,M,"b",M._gridlines),i(x,T,P,L,"a",L._minorgridlines),i(x,T,P,M,"b",M._minorgridlines),i(x,T,N,L,"a-boundary",L._boundarylines),i(x,T,N,M,"b-boundary",M._boundarylines);var q=c(h,x,T,k,C,U,L._labels,"a-label"),X=c(h,x,T,k,C,U,M._labels,"b-label");(function(K,Z,H,Y,$,z,j,W){var ee,J,Q,te,ie=u.aggNums(Math.min,null,H.a),ae=u.aggNums(Math.max,null,H.a),he=u.aggNums(Math.min,null,H.b),se=u.aggNums(Math.max,null,H.b);ee=.5*(ie+ae),J=he,Q=H.ab2xy(ee,J,!0),te=H.dxyda_rough(ee,J),j.angle===void 0&&u.extendFlat(j,e(H,$,z,Q,H.dxydb_rough(ee,J))),g(K,Z,H,Y,Q,te,H.aaxis,$,z,j,"a-title"),ee=ie,J=.5*(he+se),Q=H.ab2xy(ee,J,!0),te=H.dxydb_rough(ee,J),W.angle===void 0&&u.extendFlat(W,e(H,$,z,Q,H.dxyda_rough(ee,J))),g(K,Z,H,Y,Q,te,H.baxis,$,z,W,"b-title")})(h,U,k,C,x,T,q,X),function(K,Z,H,Y,$){var z,j,W,ee,J=H.select("#"+K._clipPathId);J.size()||(J=H.append("clipPath").classed("carpetclip",!0));var Q=u.ensureSingle(J,"path","carpetboundary"),te=Z.clipsegments,ie=[];for(ee=0;ee<te.length;ee++)z=te[ee],j=m([],z.x,Y.c2p),W=m([],z.y,$.c2p),ie.push(p(j,W,z.bicubic));var ae="M"+ie.join("L")+"Z";J.attr("id",K._clipPathId),Q.attr("d",ae)}(k,C,A,x,T)})};var n=o.LINE_SPACING,a=(1-o.MID_SHIFT)/n+1;function g(h,y,v,_,x,T,A,S,w,C,k){var L=[];A.title.text&&L.push(A.title.text);var M=y.selectAll("text."+k).data(L),P=C.maxExtent;M.enter().append("text").classed(k,!0),M.each(function(){var D=e(v,S,w,x,T);["start","both"].indexOf(A.showticklabels)===-1&&(P=0);var N=A.title.font.size;P+=N+A.title.offset;var U=(C.angle+(C.flip<0?180:0)-D.angle+450)%360,q=U>90&&U<270,X=t.select(this);X.text(A.title.text).call(f.convertToTspans,h),q&&(P=(-f.lineCount(X)+a)*n*N-P),X.attr("transform",l(D.p[0],D.p[1])+s(D.angle)+l(0,P)).attr("text-anchor","middle").call(d.font,A.title.font)}),M.exit().remove()}},{"../../components/drawing":672,"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"./makepath":986,"./map_1d_array":987,"./orient_text":988,"@plotly/d3":58}],990:[function(r,O,B){var t=r("./constants"),d=r("../../lib/search").findBin,m=r("./compute_control_points"),p=r("./create_spline_evaluator"),e=r("./create_i_derivative_evaluator"),f=r("./create_j_derivative_evaluator");O.exports=function(u){var s=u._a,l=u._b,o=s.length,i=l.length,c=u.aaxis,n=u.baxis,a=s[0],g=s[o-1],h=l[0],y=l[i-1],v=s[s.length-1]-s[0],_=l[l.length-1]-l[0],x=v*t.RELATIVE_CULL_TOLERANCE,T=_*t.RELATIVE_CULL_TOLERANCE;a-=x,g+=x,h-=T,y+=T,u.isVisible=function(A,S){return A>a&&A<g&&S>h&&S<y},u.isOccluded=function(A,S){return A<a||A>g||S<h||S>y},u.setScale=function(){var A=u._x,S=u._y,w=m(u._xctrl,u._yctrl,A,S,c.smoothing,n.smoothing);u._xctrl=w[0],u._yctrl=w[1],u.evalxy=p([u._xctrl,u._yctrl],o,i,c.smoothing,n.smoothing),u.dxydi=e([u._xctrl,u._yctrl],c.smoothing,n.smoothing),u.dxydj=f([u._xctrl,u._yctrl],c.smoothing,n.smoothing)},u.i2a=function(A){var S=Math.max(0,Math.floor(A[0]),o-2),w=A[0]-S;return(1-w)*s[S]+w*s[S+1]},u.j2b=function(A){var S=Math.max(0,Math.floor(A[1]),o-2),w=A[1]-S;return(1-w)*l[S]+w*l[S+1]},u.ij2ab=function(A){return[u.i2a(A[0]),u.j2b(A[1])]},u.a2i=function(A){var S=Math.max(0,Math.min(d(A,s),o-2)),w=s[S],C=s[S+1];return Math.max(0,Math.min(o-1,S+(A-w)/(C-w)))},u.b2j=function(A){var S=Math.max(0,Math.min(d(A,l),i-2)),w=l[S],C=l[S+1];return Math.max(0,Math.min(i-1,S+(A-w)/(C-w)))},u.ab2ij=function(A){return[u.a2i(A[0]),u.b2j(A[1])]},u.i2c=function(A,S){return u.evalxy([],A,S)},u.ab2xy=function(A,S,w){if(!w&&(A<s[0]||A>s[o-1]|S<l[0]||S>l[i-1]))return[!1,!1];var C=u.a2i(A),k=u.b2j(S),L=u.evalxy([],C,k);if(w){var M,P,D,N,U=0,q=0,X=[];A<s[0]?(M=0,P=0,U=(A-s[0])/(s[1]-s[0])):A>s[o-1]?(M=o-2,P=1,U=(A-s[o-1])/(s[o-1]-s[o-2])):P=C-(M=Math.max(0,Math.min(o-2,Math.floor(C)))),S<l[0]?(D=0,N=0,q=(S-l[0])/(l[1]-l[0])):S>l[i-1]?(D=i-2,N=1,q=(S-l[i-1])/(l[i-1]-l[i-2])):N=k-(D=Math.max(0,Math.min(i-2,Math.floor(k)))),U&&(u.dxydi(X,M,D,P,N),L[0]+=X[0]*U,L[1]+=X[1]*U),q&&(u.dxydj(X,M,D,P,N),L[0]+=X[0]*q,L[1]+=X[1]*q)}return L},u.c2p=function(A,S,w){return[S.c2p(A[0]),w.c2p(A[1])]},u.p2x=function(A,S,w){return[S.p2c(A[0]),w.p2c(A[1])]},u.dadi=function(A){var S=Math.max(0,Math.min(s.length-2,A));return s[S+1]-s[S]},u.dbdj=function(A){var S=Math.max(0,Math.min(l.length-2,A));return l[S+1]-l[S]},u.dxyda=function(A,S,w,C){var k=u.dxydi(null,A,S,w,C),L=u.dadi(A,w);return[k[0]/L,k[1]/L]},u.dxydb=function(A,S,w,C){var k=u.dxydj(null,A,S,w,C),L=u.dbdj(S,C);return[k[0]/L,k[1]/L]},u.dxyda_rough=function(A,S,w){var C=v*(w||.1),k=u.ab2xy(A+C,S,!0),L=u.ab2xy(A-C,S,!0);return[.5*(k[0]-L[0])/C,.5*(k[1]-L[1])/C]},u.dxydb_rough=function(A,S,w){var C=_*(w||.1),k=u.ab2xy(A,S+C,!0),L=u.ab2xy(A,S-C,!0);return[.5*(k[0]-L[0])/C,.5*(k[1]-L[1])/C]},u.dpdx=function(A){return A._m},u.dpdy=function(A){return A._m}}},{"../../lib/search":807,"./compute_control_points":978,"./constants":979,"./create_i_derivative_evaluator":980,"./create_j_derivative_evaluator":981,"./create_spline_evaluator":982}],991:[function(r,O,B){var t=r("../../lib");O.exports=function(d,m,p){var e,f,u,s=[],l=[],o=d[0].length,i=d.length;function c(Z,H){var Y,$=0,z=0;return Z>0&&(Y=d[H][Z-1])!==void 0&&(z++,$+=Y),Z<o-1&&(Y=d[H][Z+1])!==void 0&&(z++,$+=Y),H>0&&(Y=d[H-1][Z])!==void 0&&(z++,$+=Y),H<i-1&&(Y=d[H+1][Z])!==void 0&&(z++,$+=Y),$/Math.max(1,z)}var n,a,g,h,y,v,_,x,T,A,S,w=0;for(e=0;e<o;e++)for(f=0;f<i;f++)d[f][e]===void 0&&(s.push(e),l.push(f),d[f][e]=c(e,f)),w=Math.max(w,Math.abs(d[f][e]));if(!s.length)return d;var C=0,k=0,L=s.length;do{for(C=0,u=0;u<L;u++){e=s[u],f=l[u];var M,P,D,N,U,q,X=0,K=0;e===0?(D=m[U=Math.min(o-1,2)],N=m[1],M=d[f][U],K+=(P=d[f][1])+(P-M)*(m[0]-N)/(N-D),X++):e===o-1&&(D=m[U=Math.max(0,o-3)],N=m[o-2],M=d[f][U],K+=(P=d[f][o-2])+(P-M)*(m[o-1]-N)/(N-D),X++),(e===0||e===o-1)&&f>0&&f<i-1&&(n=p[f+1]-p[f],K+=((a=p[f]-p[f-1])*d[f+1][e]+n*d[f-1][e])/(a+n),X++),f===0?(D=p[q=Math.min(i-1,2)],N=p[1],M=d[q][e],K+=(P=d[1][e])+(P-M)*(p[0]-N)/(N-D),X++):f===i-1&&(D=p[q=Math.max(0,i-3)],N=p[i-2],M=d[q][e],K+=(P=d[i-2][e])+(P-M)*(p[i-1]-N)/(N-D),X++),(f===0||f===i-1)&&e>0&&e<o-1&&(n=m[e+1]-m[e],K+=((a=m[e]-m[e-1])*d[f][e+1]+n*d[f][e-1])/(a+n),X++),X?K/=X:(g=m[e+1]-m[e],h=m[e]-m[e-1],x=(y=p[f+1]-p[f])*(v=p[f]-p[f-1])*(y+v),K=((_=g*h*(g+h))*(v*d[f+1][e]+y*d[f-1][e])+x*(h*d[f][e+1]+g*d[f][e-1]))/(x*(h+g)+_*(v+y))),C+=(A=(T=K-d[f][e])/w)*A,S=X?0:.85,d[f][e]+=T*(1+S)}C=Math.sqrt(C)}while(k++<100&&C>1e-5);return t.log("Smoother converged to",C,"after",k,"iterations"),d}},{"../../lib":787}],992:[function(r,O,B){var t=r("../../lib").isArray1D;O.exports=function(d,m,p){var e=p("x"),f=e&&e.length,u=p("y"),s=u&&u.length;if(!f&&!s)return!1;if(m._cheater=!e,f&&!t(e)||s&&!t(u))m._length=null;else{var l=f?e.length:1/0;s&&(l=Math.min(l,u.length)),m.a&&m.a.length&&(l=Math.min(l,m.a.length)),m.b&&m.b.length&&(l=Math.min(l,m.b.length)),m._length=l}return!0}},{"../../lib":787}],993:[function(r,O,B){var t=r("../../plots/template_attributes").hovertemplateAttrs,d=r("../scattergeo/attributes"),m=r("../../components/colorscale/attributes"),p=r("../../plots/attributes"),e=r("../../components/color/attributes").defaultLine,f=r("../../lib/extend").extendFlat,u=d.marker.line;O.exports=f({locations:{valType:"data_array",editType:"calc"},locationmode:d.locationmode,z:{valType:"data_array",editType:"calc"},geojson:f({},d.geojson,{}),featureidkey:d.featureidkey,text:f({},d.text,{}),hovertext:f({},d.hovertext,{}),marker:{line:{color:f({},u.color,{dflt:e}),width:f({},u.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:d.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:d.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:f({},p.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:t(),showlegend:f({},p.showlegend,{dflt:!1})},m("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":649,"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scattergeo/attributes":1244}],994:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../constants/numerical").BADNUM,m=r("../../components/colorscale/calc"),p=r("../scatter/arrays_to_calcdata"),e=r("../scatter/calc_selection");function f(u){return u&&typeof u=="string"}O.exports=function(u,s){var l,o=s._length,i=new Array(o);l=s.geojson?function(h){return f(h)||t(h)}:f;for(var c=0;c<o;c++){var n=i[c]={},a=s.locations[c],g=s.z[c];l(a)&&t(g)?(n.loc=a,n.z=g):(n.loc=null,n.z=d),n.index=c}return p(i,s),m(u,s,{vals:s.z,containerStr:"",cLetter:"z"}),e(i,s),i}},{"../../components/colorscale/calc":658,"../../constants/numerical":763,"../scatter/arrays_to_calcdata":1201,"../scatter/calc_selection":1204,"fast-isnumeric":246}],995:[function(r,O,B){var t=r("../../lib"),d=r("../../components/colorscale/defaults"),m=r("./attributes");O.exports=function(p,e,f,u){function s(n,a){return t.coerce(p,e,m,n,a)}var l=s("locations"),o=s("z");if(l&&l.length&&t.isArrayOrTypedArray(o)&&o.length){e._length=Math.min(l.length,o.length);var i,c=s("geojson");(typeof c=="string"&&c!==""||t.isPlainObject(c))&&(i="geojson-id"),s("locationmode",i)==="geojson-id"&&s("featureidkey"),s("text"),s("hovertext"),s("hovertemplate"),s("marker.line.width")&&s("marker.line.color"),s("marker.opacity"),d(p,e,u,s,{prefix:"",cLetter:"z"}),t.coerceSelectionMarkerOpacity(e,s)}else e.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":993}],996:[function(r,O,B){O.exports=function(t,d,m,p,e){t.location=d.location,t.z=d.z;var f=p[e];return f.fIn&&f.fIn.properties&&(t.properties=f.fIn.properties),t.ct=f.ct,t}},{}],997:[function(r,O,B){var t=r("../../plots/cartesian/axes"),d=r("./attributes"),m=r("../../lib").fillText;O.exports=function(p,e,f){var u,s,l,o,i=p.cd,c=i[0].trace,n=p.subplot,a=[e,f],g=[e+360,f];for(s=0;s<i.length;s++)if(o=!1,(u=i[s])._polygons){for(l=0;l<u._polygons.length;l++)u._polygons[l].contains(a)&&(o=!o),u._polygons[l].contains(g)&&(o=!o);if(o)break}if(o&&u)return p.x0=p.x1=p.xa.c2p(u.ct),p.y0=p.y1=p.ya.c2p(u.ct),p.index=u.index,p.location=u.loc,p.z=u.z,p.zLabel=t.tickText(n.mockAxis,n.mockAxis.c2l(u.z),"hover").text,p.hovertemplate=u.hovertemplate,function(h,y,v){if(!y.hovertemplate){var _=v.hi||y.hoverinfo,x=String(v.loc),T=_==="all"?d.hoverinfo.flags:_.split("+"),A=T.indexOf("name")!==-1,S=T.indexOf("location")!==-1,w=T.indexOf("z")!==-1,C=T.indexOf("text")!==-1,k=[];!A&&S?h.nameOverride=x:(A&&(h.nameOverride=y.name),S&&k.push(x)),w&&k.push(h.zLabel),C&&m(v,y,k),h.extraText=k.join("<br>")}}(p,c,u),[p]}},{"../../lib":787,"../../plots/cartesian/axes":838,"./attributes":993}],998:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../heatmap/colorbar"),calc:r("./calc"),calcGeoJSON:r("./plot").calcGeoJSON,plot:r("./plot").plot,style:r("./style").style,styleOnSelect:r("./style").styleOnSelect,hoverPoints:r("./hover"),eventData:r("./event_data"),selectPoints:r("./select"),moduleType:"trace",name:"choropleth",basePlotModule:r("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":871,"../heatmap/colorbar":1072,"./attributes":993,"./calc":994,"./defaults":995,"./event_data":996,"./hover":997,"./plot":999,"./select":1e3,"./style":1001}],999:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../lib/geo_location_utils"),p=r("../../lib/topojson_utils").getTopojsonFeatures,e=r("../../plots/cartesian/autorange").findExtremes,f=r("./style").style;O.exports={calcGeoJSON:function(u,s){for(var l=u[0].trace,o=s[l.geo],i=o._subplot,c=l.locationmode,n=l._length,a=c==="geojson-id"?m.extractTraceFeature(u):p(l,i.topojson),g=[],h=[],y=0;y<n;y++){var v=u[y],_=c==="geojson-id"?v.fOut:m.locationToFeature(c,v.loc,a);if(_){v.geojson=_,v.ct=_.properties.ct,v._polygons=m.feature2polygons(_);var x=m.computeBbox(_);g.push(x[0],x[2]),h.push(x[1],x[3])}else v.geojson=null}if(o.fitbounds==="geojson"&&c==="geojson-id"){var T=m.computeBbox(m.getTraceGeojson(l));g=[T[0],T[2]],h=[T[1],T[3]]}var A={padded:!0};l._extremes.lon=e(o.lonaxis._ax,g,A),l._extremes.lat=e(o.lataxis._ax,h,A)},plot:function(u,s,l){var o=s.layers.backplot.select(".choroplethlayer");d.makeTraceGroups(o,l,"trace choropleth").each(function(i){var c=t.select(this).selectAll("path.choroplethlocation").data(d.identity);c.enter().append("path").classed("choroplethlocation",!0),c.exit().remove(),f(u,i)})}}},{"../../lib":787,"../../lib/geo_location_utils":780,"../../lib/topojson_utils":816,"../../plots/cartesian/autorange":837,"./style":1001,"@plotly/d3":58}],1e3:[function(r,O,B){O.exports=function(t,d){var m,p,e,f,u,s=t.cd,l=t.xaxis,o=t.yaxis,i=[];if(d===!1)for(m=0;m<s.length;m++)s[m].selected=0;else for(m=0;m<s.length;m++)(e=(p=s[m]).ct)&&(f=l.c2p(e),u=o.c2p(e),d.contains([f,u],null,m,t)?(i.push({pointNumber:m,lon:e[0],lat:e[1]}),p.selected=1):p.selected=0);return i}},{}],1001:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/color"),m=r("../../components/drawing"),p=r("../../components/colorscale");function e(f,u){var s=u[0].trace,l=u[0].node3.selectAll(".choroplethlocation"),o=s.marker||{},i=o.line||{},c=p.makeColorScaleFuncFromTrace(s);l.each(function(n){t.select(this).attr("fill",c(n.z)).call(d.stroke,n.mlc||i.color).call(m.dashLine,"",n.mlw||i.width||0).style("opacity",o.opacity)}),m.selectedPointStyle(l,s,f)}O.exports={style:function(f,u){u&&e(f,u)},styleOnSelect:function(f,u){var s=u[0].node3,l=u[0].trace;l.selectedpoints?m.selectedPointStyle(s.selectAll(".choroplethlocation"),l,f):e(f,u)}}},{"../../components/color":650,"../../components/colorscale":662,"../../components/drawing":672,"@plotly/d3":58}],1002:[function(r,O,B){var t=r("../choropleth/attributes"),d=r("../../components/colorscale/attributes"),m=r("../../plots/template_attributes").hovertemplateAttrs,p=r("../../plots/attributes"),e=r("../../lib/extend").extendFlat;O.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},t.featureidkey,{}),below:{valType:"string",editType:"plot"},text:t.text,hovertext:t.hovertext,marker:{line:{color:e({},t.marker.line.color,{editType:"plot"}),width:e({},t.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},t.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},t.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},t.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:t.hoverinfo,hovertemplate:m({},{keys:["properties"]}),showlegend:e({},p.showlegend,{dflt:!1})},d("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../choropleth/attributes":993}],1003:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../components/colorscale"),p=r("../../components/drawing"),e=r("../../lib/geojson_utils").makeBlank,f=r("../../lib/geo_location_utils");function u(s){var l,o=s[0].trace,i=o._opts;if(o.selectedpoints){for(var c=p.makeSelectedPointStyleFns(o),n=0;n<s.length;n++){var a=s[n];a.fOut&&(a.fOut.properties.mo2=c.selectedOpacityFn(a))}l={type:"identity",property:"mo2"}}else l=d.isArrayOrTypedArray(o.marker.opacity)?{type:"identity",property:"mo"}:o.marker.opacity;return d.extendFlat(i.fill.paint,{"fill-opacity":l}),d.extendFlat(i.line.paint,{"line-opacity":l}),i}O.exports={convert:function(s){var l=s[0].trace,o=l.visible===!0&&l._length!==0,i={layout:{visibility:"none"},paint:{}},c={layout:{visibility:"none"},paint:{}},n=l._opts={fill:i,line:c,geojson:e()};if(!o)return n;var a=f.extractTraceFeature(s);if(!a)return n;var g,h,y,v=m.makeColorScaleFuncFromTrace(l),_=l.marker,x=_.line||{};d.isArrayOrTypedArray(_.opacity)&&(g=function(k){var L=k.mo;return t(L)?+d.constrain(L,0,1):0}),d.isArrayOrTypedArray(x.color)&&(h=function(k){return k.mlc}),d.isArrayOrTypedArray(x.width)&&(y=function(k){return k.mlw});for(var T=0;T<s.length;T++){var A=s[T],S=A.fOut;if(S){var w=S.properties;w.fc=v(A.z),g&&(w.mo=g(A)),h&&(w.mlc=h(A)),y&&(w.mlw=y(A)),A.ct=w.ct,A._polygons=f.feature2polygons(S)}}var C=g?{type:"identity",property:"mo"}:_.opacity;return d.extendFlat(i.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":C}),d.extendFlat(c.paint,{"line-color":h?{type:"identity",property:"mlc"}:x.color,"line-width":y?{type:"identity",property:"mlw"}:x.width,"line-opacity":C}),i.layout.visibility="visible",c.layout.visibility="visible",n.geojson={type:"FeatureCollection",features:a},u(s),n},convertOnSelect:u}},{"../../components/colorscale":662,"../../components/drawing":672,"../../lib":787,"../../lib/geo_location_utils":780,"../../lib/geojson_utils":781,"fast-isnumeric":246}],1004:[function(r,O,B){var t=r("../../lib"),d=r("../../components/colorscale/defaults"),m=r("./attributes");O.exports=function(p,e,f,u){function s(c,n){return t.coerce(p,e,m,c,n)}var l=s("locations"),o=s("z"),i=s("geojson");t.isArrayOrTypedArray(l)&&l.length&&t.isArrayOrTypedArray(o)&&o.length&&(typeof i=="string"&&i!==""||t.isPlainObject(i))?(s("featureidkey"),e._length=Math.min(l.length,o.length),s("below"),s("text"),s("hovertext"),s("hovertemplate"),s("marker.line.width")&&s("marker.line.color"),s("marker.opacity"),d(p,e,u,s,{prefix:"",cLetter:"z"}),t.coerceSelectionMarkerOpacity(e,s)):e.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":1002}],1005:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../heatmap/colorbar"),calc:r("../choropleth/calc"),plot:r("./plot"),hoverPoints:r("../choropleth/hover"),eventData:r("../choropleth/event_data"),selectPoints:r("../choropleth/select"),styleOnSelect:function(t,d){d&&d[0].trace._glTrace.updateOnSelect(d)},getBelow:function(t,d){for(var m=d.getMapLayers(),p=m.length-2;p>=0;p--){var e=m[p].id;if(typeof e=="string"&&e.indexOf("water")===0){for(var f=p+1;f<m.length;f++)if(typeof(e=m[f].id)=="string"&&e.indexOf("plotly-")===-1)return e}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:r("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":895,"../choropleth/calc":994,"../choropleth/event_data":996,"../choropleth/hover":997,"../choropleth/select":1e3,"../heatmap/colorbar":1072,"./attributes":1002,"./defaults":1004,"./plot":1006}],1006:[function(r,O,B){var t=r("./convert").convert,d=r("./convert").convertOnSelect,m=r("../../plots/mapbox/constants").traceLayerPrefix;function p(f,u){this.type="choroplethmapbox",this.subplot=f,this.uid=u,this.sourceId="source-"+u,this.layerList=[["fill",m+u+"-fill"],["line",m+u+"-line"]],this.below=null}var e=p.prototype;e.update=function(f){this._update(t(f))},e.updateOnSelect=function(f){this._update(d(f))},e._update=function(f){var u=this.subplot,s=this.layerList,l=u.belowLookup["trace-"+this.uid];u.map.getSource(this.sourceId).setData(f.geojson),l!==this.below&&(this._removeLayers(),this._addLayers(f,l),this.below=l);for(var o=0;o<s.length;o++){var i=s[o],c=i[0],n=i[1],a=f[c];u.setOptions(n,"setLayoutProperty",a.layout),a.layout.visibility==="visible"&&u.setOptions(n,"setPaintProperty",a.paint)}},e._addLayers=function(f,u){for(var s=this.subplot,l=this.layerList,o=this.sourceId,i=0;i<l.length;i++){var c=l[i],n=c[0],a=f[n];s.addLayer({type:n,id:c[1],source:o,layout:a.layout,paint:a.paint},u)}},e._removeLayers=function(){for(var f=this.subplot.map,u=this.layerList,s=u.length-1;s>=0;s--)f.removeLayer(u[s][1])},e.dispose=function(){var f=this.subplot.map;this._removeLayers(),f.removeSource(this.sourceId)},O.exports=function(f,u){var s=u[0].trace,l=new p(f,s.uid),o=l.sourceId,i=t(u),c=l.below=f.belowLookup["trace-"+s.uid];return f.map.addSource(o,{type:"geojson",data:i.geojson}),l._addLayers(i,c),u[0].trace._glTrace=l,l}},{"../../plots/mapbox/constants":893,"./convert":1003}],1007:[function(r,O,B){var t=r("../../components/colorscale/attributes"),d=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=r("../../plots/template_attributes").hovertemplateAttrs,p=r("../mesh3d/attributes"),e=r("../../plots/attributes"),f=r("../../lib/extend").extendFlat,u={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:m({editType:"calc"},{keys:["norm"]}),uhoverformat:d("u",1),vhoverformat:d("v",1),whoverformat:d("w",1),xhoverformat:d("x"),yhoverformat:d("y"),zhoverformat:d("z"),showlegend:f({},e.showlegend,{dflt:!1})};f(u,t("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(s){u[s]=p[s]}),u.hoverinfo=f({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),u.transforms=void 0,O.exports=u},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../mesh3d/attributes":1143}],1008:[function(r,O,B){var t=r("../../components/colorscale/calc");O.exports=function(d,m){for(var p=m.u,e=m.v,f=m.w,u=Math.min(m.x.length,m.y.length,m.z.length,p.length,e.length,f.length),s=-1/0,l=1/0,o=0;o<u;o++){var i=p[o],c=e[o],n=f[o],a=Math.sqrt(i*i+c*c+n*n);s=Math.max(s,a),l=Math.min(l,a)}m._len=u,m._normMax=s,t(d,m,{vals:[l,s],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":658}],1009:[function(r,O,B){var t=r("gl-cone3d"),d=r("gl-cone3d").createConeMesh,m=r("../../lib").simpleMap,p=r("../../lib/gl_format_color").parseColorScale,e=r("../../components/colorscale").extractOpts,f=r("../../plots/gl3d/zip3");function u(n,a){this.scene=n,this.uid=a,this.mesh=null,this.data=null}var s=u.prototype;s.handlePick=function(n){if(n.object===this.mesh){var a=n.index=n.data.index,g=this.data.x[a],h=this.data.y[a],y=this.data.z[a],v=this.data.u[a],_=this.data.v[a],x=this.data.w[a];n.traceCoordinate=[g,h,y,v,_,x,Math.sqrt(v*v+_*_+x*x)];var T=this.data.hovertext||this.data.text;return Array.isArray(T)&&T[a]!==void 0?n.textLabel=T[a]:T&&(n.textLabel=T),!0}};var l={xaxis:0,yaxis:1,zaxis:2},o={tip:1,tail:0,cm:.25,center:.5},i={tip:1,tail:1,cm:.75,center:.5};function c(n,a){var g=n.fullSceneLayout,h=n.dataScale,y={};function v(A,S){var w=g[S],C=h[l[S]];return m(A,function(k){return w.d2l(k)*C})}y.vectors=f(v(a.u,"xaxis"),v(a.v,"yaxis"),v(a.w,"zaxis"),a._len),y.positions=f(v(a.x,"xaxis"),v(a.y,"yaxis"),v(a.z,"zaxis"),a._len);var _=e(a);y.colormap=p(a),y.vertexIntensityBounds=[_.min/a._normMax,_.max/a._normMax],y.coneOffset=o[a.anchor],a.sizemode==="scaled"?y.coneSize=a.sizeref||.5:y.coneSize=a.sizeref&&a._normMax?a.sizeref/a._normMax:.5;var x=t(y),T=a.lightposition;return x.lightPosition=[T.x,T.y,T.z],x.ambient=a.lighting.ambient,x.diffuse=a.lighting.diffuse,x.specular=a.lighting.specular,x.roughness=a.lighting.roughness,x.fresnel=a.lighting.fresnel,x.opacity=a.opacity,a._pad=i[a.anchor]*x.vectorScale*x.coneScale*a._normMax,x}s.update=function(n){this.data=n;var a=c(this.scene,n);this.mesh.update(a)},s.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},O.exports=function(n,a){var g=n.glplot.gl,h=c(n,a),y=d(g,h),v=new u(n,a.uid);return v.mesh=y,v.data=a,y._trace=v,n.glplot.add(y),v}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gl_format_color":783,"../../plots/gl3d/zip3":891,"gl-cone3d":262}],1010:[function(r,O,B){var t=r("../../lib"),d=r("../../components/colorscale/defaults"),m=r("./attributes");O.exports=function(p,e,f,u){function s(g,h){return t.coerce(p,e,m,g,h)}var l=s("u"),o=s("v"),i=s("w"),c=s("x"),n=s("y"),a=s("z");l&&l.length&&o&&o.length&&i&&i.length&&c&&c.length&&n&&n.length&&a&&a.length?(s("sizeref"),s("sizemode"),s("anchor"),s("lighting.ambient"),s("lighting.diffuse"),s("lighting.specular"),s("lighting.roughness"),s("lighting.fresnel"),s("lightposition.x"),s("lightposition.y"),s("lightposition.z"),d(p,e,u,s,{prefix:"",cLetter:"c"}),s("text"),s("hovertext"),s("hovertemplate"),s("uhoverformat"),s("vhoverformat"),s("whoverformat"),s("xhoverformat"),s("yhoverformat"),s("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":1007}],1011:[function(r,O,B){O.exports={moduleType:"trace",name:"cone",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:r("./calc"),plot:r("./convert"),eventData:function(t,d){return t.norm=d.traceCoordinate[6],t},meta:{}}},{"../../plots/gl3d":880,"./attributes":1007,"./calc":1008,"./convert":1009,"./defaults":1010}],1012:[function(r,O,B){var t=r("../heatmap/attributes"),d=r("../scatter/attributes"),m=r("../../plots/cartesian/axis_format_attributes"),p=m.axisHoverFormat,e=m.descriptionOnlyNumbers,f=r("../../components/colorscale/attributes"),u=r("../../components/drawing/attributes").dash,s=r("../../plots/font_attributes"),l=r("../../lib/extend").extendFlat,o=r("../../constants/filter_ops"),i=o.COMPARISON_OPS2,c=o.INTERVAL_OPS,n=d.line;O.exports=l({z:t.z,x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,text:t.text,hovertext:t.hovertext,transpose:t.transpose,xtype:t.xtype,ytype:t.ytype,xhoverformat:p("x"),yhoverformat:p("y"),zhoverformat:p("z",1),hovertemplate:t.hovertemplate,hoverongaps:t.hoverongaps,connectgaps:l({},t.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:s({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:e("contour label")},operation:{valType:"enumerated",values:[].concat(i).concat(c),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:l({},n.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:u,smoothing:l({},n.smoothing,{}),editType:"plot"}},f("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":657,"../../components/drawing/attributes":671,"../../constants/filter_ops":759,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/font_attributes":867,"../heatmap/attributes":1069,"../scatter/attributes":1202}],1013:[function(r,O,B){var t=r("../../components/colorscale"),d=r("../heatmap/calc"),m=r("./set_contours"),p=r("./end_plus");O.exports=function(e,f){var u=d(e,f),s=u[0].z;m(f,s);var l,o=f.contours,i=t.extractOpts(f);if(o.coloring==="heatmap"&&i.auto&&f.autocontour===!1){var c=o.start,n=p(o),a=o.size||1,g=Math.floor((n-c)/a)+1;isFinite(a)||(a=1,g=1);var h=c-a/2;l=[h,h+g*a]}else l=s;return t.calc(e,f,{vals:l,cLetter:"z"}),u}},{"../../components/colorscale":662,"../heatmap/calc":1070,"./end_plus":1023,"./set_contours":1031}],1014:[function(r,O,B){O.exports=function(t,d){var m,p=t[0],e=p.z;switch(d.type){case"levels":var f=Math.min(e[0][0],e[0][1]);for(m=0;m<t.length;m++){var u=t[m];u.prefixBoundary=!u.edgepaths.length&&(f>u.level||u.starts.length&&f===u.level)}break;case"constraint":if(p.prefixBoundary=!1,p.edgepaths.length)return;var s=p.x.length,l=p.y.length,o=-1/0,i=1/0;for(m=0;m<l;m++)i=Math.min(i,e[m][0]),i=Math.min(i,e[m][s-1]),o=Math.max(o,e[m][0]),o=Math.max(o,e[m][s-1]);for(m=1;m<s-1;m++)i=Math.min(i,e[0][m]),i=Math.min(i,e[l-1][m]),o=Math.max(o,e[0][m]),o=Math.max(o,e[l-1][m]);var c,n,a=d.value;switch(d._operation){case">":a>o&&(p.prefixBoundary=!0);break;case"<":(a<i||p.starts.length&&a===i)&&(p.prefixBoundary=!0);break;case"[]":c=Math.min(a[0],a[1]),((n=Math.max(a[0],a[1]))<i||c>o||p.starts.length&&n===i)&&(p.prefixBoundary=!0);break;case"][":c=Math.min(a[0],a[1]),n=Math.max(a[0],a[1]),c<i&&n>o&&(p.prefixBoundary=!0)}}}},{}],1015:[function(r,O,B){var t=r("../../components/colorscale"),d=r("./make_color_map"),m=r("./end_plus");O.exports={min:"zmin",max:"zmax",calc:function(p,e,f){var u=e.contours,s=e.line,l=u.size||1,o=u.coloring,i=d(e,{isColorbar:!0});if(o==="heatmap"){var c=t.extractOpts(e);f._fillgradient=c.reversescale?t.flipScale(c.colorscale):c.colorscale,f._zrange=[c.min,c.max]}else o==="fill"&&(f._fillcolor=i);f._line={color:o==="lines"?i:s.color,width:u.showlines!==!1?s.width:0,dash:s.dash},f._levels={start:u.start,end:m(u),size:l}}}},{"../../components/colorscale":662,"./end_plus":1023,"./make_color_map":1028}],1016:[function(r,O,B){O.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],1017:[function(r,O,B){var t=r("fast-isnumeric"),d=r("./label_defaults"),m=r("../../components/color"),p=m.addOpacity,e=m.opacity,f=r("../../constants/filter_ops"),u=f.CONSTRAINT_REDUCTION,s=f.COMPARISON_OPS2;O.exports=function(l,o,i,c,n,a){var g,h,y,v=o.contours,_=i("contours.operation");v._operation=u[_],function(x,T){var A;s.indexOf(T.operation)===-1?(x("contours.value",[0,1]),Array.isArray(T.value)?T.value.length>2?T.value=T.value.slice(2):T.length===0?T.value=[0,1]:T.length<2?(A=parseFloat(T.value[0]),T.value=[A,A+1]):T.value=[parseFloat(T.value[0]),parseFloat(T.value[1])]:t(T.value)&&(A=parseFloat(T.value),T.value=[A,A+1])):(x("contours.value",0),t(T.value)||(Array.isArray(T.value)?T.value=parseFloat(T.value[0]):T.value=0))}(i,v),_==="="?g=v.showlines=!0:(g=i("contours.showlines"),y=i("fillcolor",p((l.line||{}).color||n,.5))),g&&(h=i("line.color",y&&e(y)?p(o.fillcolor,1):n),i("line.width",2),i("line.dash")),i("line.smoothing"),d(i,c,h,a)}},{"../../components/color":650,"../../constants/filter_ops":759,"./label_defaults":1027,"fast-isnumeric":246}],1018:[function(r,O,B){var t=r("../../constants/filter_ops"),d=r("fast-isnumeric");function m(f,u){var s,l=Array.isArray(u);function o(i){return d(i)?+i:null}return t.COMPARISON_OPS2.indexOf(f)!==-1?s=o(l?u[0]:u):t.INTERVAL_OPS.indexOf(f)!==-1?s=l?[o(u[0]),o(u[1])]:[o(u),o(u)]:t.SET_OPS.indexOf(f)!==-1&&(s=l?u.map(o):[o(u)]),s}function p(f){return function(u){u=m(f,u);var s=Math.min(u[0],u[1]),l=Math.max(u[0],u[1]);return{start:s,end:l,size:l-s}}}function e(f){return function(u){return{start:u=m(f,u),end:1/0,size:1/0}}}O.exports={"[]":p("[]"),"][":p("]["),">":e(">"),"<":e("<"),"=":e("=")}},{"../../constants/filter_ops":759,"fast-isnumeric":246}],1019:[function(r,O,B){O.exports=function(t,d,m,p){var e=p("contours.start"),f=p("contours.end"),u=e===!1||f===!1,s=m("contours.size");!(u?d.autocontour=!0:m("autocontour",!1))&&s||m("ncontours")}},{}],1020:[function(r,O,B){var t=r("../../lib");function d(m){return t.extendFlat({},m,{edgepaths:t.extendDeep([],m.edgepaths),paths:t.extendDeep([],m.paths),starts:t.extendDeep([],m.starts)})}O.exports=function(m,p){var e,f,u,s=function(i){return i.reverse()},l=function(i){return i};switch(p){case"=":case"<":return m;case">":for(m.length!==1&&t.warn("Contour data invalid for the specified inequality operation."),f=m[0],e=0;e<f.edgepaths.length;e++)f.edgepaths[e]=s(f.edgepaths[e]);for(e=0;e<f.paths.length;e++)f.paths[e]=s(f.paths[e]);for(e=0;e<f.starts.length;e++)f.starts[e]=s(f.starts[e]);return m;case"][":var o=s;s=l,l=o;case"[]":for(m.length!==2&&t.warn("Contour data invalid for the specified inequality range operation."),f=d(m[0]),u=d(m[1]),e=0;e<f.edgepaths.length;e++)f.edgepaths[e]=s(f.edgepaths[e]);for(e=0;e<f.paths.length;e++)f.paths[e]=s(f.paths[e]);for(e=0;e<f.starts.length;e++)f.starts[e]=s(f.starts[e]);for(;u.edgepaths.length;)f.edgepaths.push(l(u.edgepaths.shift()));for(;u.paths.length;)f.paths.push(l(u.paths.shift()));for(;u.starts.length;)f.starts.push(l(u.starts.shift()));return[f]}}},{"../../lib":787}],1021:[function(r,O,B){var t=r("../../lib"),d=r("../heatmap/xyz_defaults"),m=r("../scatter/period_defaults"),p=r("./constraint_defaults"),e=r("./contours_defaults"),f=r("./style_defaults"),u=r("./attributes");O.exports=function(s,l,o,i){function c(a,g){return t.coerce(s,l,u,a,g)}if(d(s,l,c,i)){m(s,l,i,c),c("xhoverformat"),c("yhoverformat"),c("text"),c("hovertext"),c("hovertemplate"),c("hoverongaps");var n=c("contours.type")==="constraint";c("connectgaps",t.isArray1D(l.z)),n?p(s,l,c,i,o):(e(s,l,c,function(a){return t.coerce2(s,l,u,a)}),f(s,l,c,i))}else l.visible=!1}},{"../../lib":787,"../heatmap/xyz_defaults":1083,"../scatter/period_defaults":1222,"./attributes":1012,"./constraint_defaults":1017,"./contours_defaults":1019,"./style_defaults":1033}],1022:[function(r,O,B){var t=r("../../lib"),d=r("./constraint_mapping"),m=r("./end_plus");O.exports=function(p,e,f){for(var u=p.type==="constraint"?d[p._operation](p.value):p,s=u.size,l=[],o=m(u),i=f.trace._carpetTrace,c=i?{xaxis:i.aaxis,yaxis:i.baxis,x:f.a,y:f.b}:{xaxis:e.xaxis,yaxis:e.yaxis,x:f.x,y:f.y},n=u.start;n<o;n+=s)if(l.push(t.extendFlat({level:n,crossings:{},starts:[],edgepaths:[],paths:[],z:f.z,smoothing:f.trace.line.smoothing},c)),l.length>1e3){t.warn("Too many contours, clipping at 1000",p);break}return l}},{"../../lib":787,"./constraint_mapping":1018,"./end_plus":1023}],1023:[function(r,O,B){O.exports=function(t){return t.end+t.size/1e6}},{}],1024:[function(r,O,B){var t=r("../../lib"),d=r("./constants");function m(f,u,s,l){return Math.abs(f[0]-u[0])<s&&Math.abs(f[1]-u[1])<l}function p(f,u,s,l,o){var i,c=u.join(","),n=f.crossings[c],a=function(Q,te,ie){var ae=0,he=0;return Q>20&&te?Q===208||Q===1114?ae=ie[0]===0?1:-1:he=ie[1]===0?1:-1:d.BOTTOMSTART.indexOf(Q)!==-1?he=1:d.LEFTSTART.indexOf(Q)!==-1?ae=1:d.TOPSTART.indexOf(Q)!==-1?he=-1:ae=-1,[ae,he]}(n,s,u),g=[e(f,u,[-a[0],-a[1]])],h=f.z.length,y=f.z[0].length,v=u.slice(),_=a.slice();for(i=0;i<1e4;i++){if(n>20?(n=d.CHOOSESADDLE[n][(a[0]||a[1])<0?0:1],f.crossings[c]=d.SADDLEREMAINDER[n]):delete f.crossings[c],!(a=d.NEWDELTA[n])){t.log("Found bad marching index:",n,u,f.level);break}g.push(e(f,u,a)),u[0]+=a[0],u[1]+=a[1],c=u.join(","),m(g[g.length-1],g[g.length-2],l,o)&&g.pop();var x=a[0]&&(u[0]<0||u[0]>y-2)||a[1]&&(u[1]<0||u[1]>h-2);if(u[0]===v[0]&&u[1]===v[1]&&a[0]===_[0]&&a[1]===_[1]||s&&x)break;n=f.crossings[c]}i===1e4&&t.log("Infinite loop in contour?");var T,A,S,w,C,k,L,M,P,D,N,U,q,X,K,Z=m(g[0],g[g.length-1],l,o),H=0,Y=.2*f.smoothing,$=[],z=0;for(i=1;i<g.length;i++)U=g[i],q=g[i-1],X=void 0,K=void 0,X=U[2]-q[2],K=U[3]-q[3],H+=L=Math.sqrt(X*X+K*K),$.push(L);var j=H/$.length*Y;function W(Q){return g[Q%g.length]}for(i=g.length-2;i>=z;i--)if((T=$[i])<j){for(S=0,A=i-1;A>=z&&T+$[A]<j;A--)T+=$[A];if(Z&&i===g.length-2)for(S=0;S<A&&T+$[S]<j;S++)T+=$[S];C=i-A+S+1,k=Math.floor((i+A+S+2)/2),w=Z||i!==g.length-2?Z||A!==-1?C%2?W(k):[(W(k)[0]+W(k+1)[0])/2,(W(k)[1]+W(k+1)[1])/2]:g[0]:g[g.length-1],g.splice(A+1,i-A+1,w),i=A+1,S&&(z=S),Z&&(i===g.length-2?g[S]=g[g.length-1]:i===0&&(g[g.length-1]=g[0]))}for(g.splice(0,z),i=0;i<g.length;i++)g[i].length=2;if(!(g.length<2))if(Z)g.pop(),f.paths.push(g);else{s||t.log("Unclosed interior contour?",f.level,v.join(","),g.join("L"));var ee=!1;for(M=0;M<f.edgepaths.length;M++)if(D=f.edgepaths[M],!ee&&m(D[0],g[g.length-1],l,o)){g.pop(),ee=!0;var J=!1;for(P=0;P<f.edgepaths.length;P++)if(m((N=f.edgepaths[P])[N.length-1],g[0],l,o)){J=!0,g.shift(),f.edgepaths.splice(M,1),P===M?f.paths.push(g.concat(N)):(P>M&&P--,f.edgepaths[P]=N.concat(g,D));break}J||(f.edgepaths[M]=g.concat(D))}for(M=0;M<f.edgepaths.length&&!ee;M++)m((D=f.edgepaths[M])[D.length-1],g[0],l,o)&&(g.shift(),f.edgepaths[M]=D.concat(g),ee=!0);ee||f.edgepaths.push(g)}}function e(f,u,s){var l=u[0]+Math.max(s[0],0),o=u[1]+Math.max(s[1],0),i=f.z[o][l],c=f.xaxis,n=f.yaxis;if(s[1]){var a=(f.level-i)/(f.z[o][l+1]-i);return[c.c2p((1-a)*f.x[l]+a*f.x[l+1],!0),n.c2p(f.y[o],!0),l+a,o]}var g=(f.level-i)/(f.z[o+1][l]-i);return[c.c2p(f.x[l],!0),n.c2p((1-g)*f.y[o]+g*f.y[o+1],!0),l,o+g]}O.exports=function(f,u,s){var l,o,i,c;for(u=u||.01,s=s||.01,o=0;o<f.length;o++){for(i=f[o],c=0;c<i.starts.length;c++)p(i,i.starts[c],"edge",u,s);for(l=0;Object.keys(i.crossings).length&&l<1e4;)l++,p(i,Object.keys(i.crossings)[0].split(",").map(Number),void 0,u,s);l===1e4&&t.log("Infinite loop in contour?")}}},{"../../lib":787,"./constants":1016}],1025:[function(r,O,B){var t=r("../../components/color"),d=r("../heatmap/hover");O.exports=function(m,p,e,f,u){u||(u={}),u.isContour=!0;var s=d(m,p,e,f,u);return s&&s.forEach(function(l){var o=l.trace;o.contours.type==="constraint"&&(o.fillcolor&&t.opacity(o.fillcolor)?l.color=t.addOpacity(o.fillcolor,1):o.contours.showlines&&t.opacity(o.line.color)&&(l.color=t.addOpacity(o.line.color,1)))}),s}},{"../../components/color":650,"../heatmap/hover":1076}],1026:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot").plot,style:r("./style"),colorbar:r("./colorbar"),hoverPoints:r("./hover"),moduleType:"trace",name:"contour",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":852,"./attributes":1012,"./calc":1013,"./colorbar":1015,"./defaults":1021,"./hover":1025,"./plot":1030,"./style":1032}],1027:[function(r,O,B){var t=r("../../lib");O.exports=function(d,m,p,e){if(e||(e={}),d("contours.showlabels")){var f=m.font;t.coerceFont(d,"contours.labelfont",{family:f.family,size:f.size,color:p}),d("contours.labelformat")}e.hasHover!==!1&&d("zhoverformat")}},{"../../lib":787}],1028:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/colorscale"),m=r("./end_plus");O.exports=function(p){var e=p.contours,f=e.start,u=m(e),s=e.size||1,l=Math.floor((u-f)/s)+1,o=e.coloring==="lines"?0:1,i=d.extractOpts(p);isFinite(s)||(s=1,l=1);var c,n,a=i.reversescale?d.flipScale(i.colorscale):i.colorscale,g=a.length,h=new Array(g),y=new Array(g);if(e.coloring==="heatmap"){var v=i.min,_=i.max;for(n=0;n<g;n++)c=a[n],h[n]=c[0]*(_-v)+v,y[n]=c[1];var x=t.extent([v,_,e.start,e.start+s*(l-1)]),T=x[v<_?0:1],A=x[v<_?1:0];T!==v&&(h.splice(0,0,T),y.splice(0,0,y[0])),A!==_&&(h.push(A),y.push(y[y.length-1]))}else for(n=0;n<g;n++)c=a[n],h[n]=(c[0]*(l+o-1)-o/2)*s+f,y[n]=c[1];return d.makeColorScaleFunc({domain:h,range:y},{noNumericCheck:!0})}},{"../../components/colorscale":662,"./end_plus":1023,"@plotly/d3":58}],1029:[function(r,O,B){var t=r("./constants");function d(m,p){var e=(p[0][0]>m?0:1)+(p[0][1]>m?0:2)+(p[1][1]>m?0:4)+(p[1][0]>m?0:8);return e===5||e===10?m>(p[0][0]+p[0][1]+p[1][0]+p[1][1])/4?e===5?713:1114:e===5?104:208:e===15?0:e}O.exports=function(m){var p,e,f,u,s,l,o,i,c,n=m[0].z,a=n.length,g=n[0].length,h=a===2||g===2;for(e=0;e<a-1;e++)for(u=[],e===0&&(u=u.concat(t.BOTTOMSTART)),e===a-2&&(u=u.concat(t.TOPSTART)),p=0;p<g-1;p++)for(f=u.slice(),p===0&&(f=f.concat(t.LEFTSTART)),p===g-2&&(f=f.concat(t.RIGHTSTART)),s=p+","+e,l=[[n[e][p],n[e][p+1]],[n[e+1][p],n[e+1][p+1]]],c=0;c<m.length;c++)(o=d((i=m[c]).level,l))&&(i.crossings[s]=o,f.indexOf(o)!==-1&&(i.starts.push([p,e]),h&&f.indexOf(o,f.indexOf(o)+1)!==-1&&i.starts.push([p,e])))}},{"./constants":1016}],1030:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../components/drawing"),p=r("../../components/colorscale"),e=r("../../lib/svg_text_utils"),f=r("../../plots/cartesian/axes"),u=r("../../plots/cartesian/set_convert"),s=r("../heatmap/plot"),l=r("./make_crossings"),o=r("./find_all_paths"),i=r("./empty_pathinfo"),c=r("./convert_to_constraints"),n=r("./close_boundaries"),a=r("./constants"),g=a.LABELOPTIMIZER;function h(_,x){var T,A,S,w,C,k,L,M="",P=0,D=_.edgepaths.map(function(Z,H){return H}),N=!0;function U(Z){return Math.abs(Z[1]-x[2][1])<.01}function q(Z){return Math.abs(Z[0]-x[0][0])<.01}function X(Z){return Math.abs(Z[0]-x[2][0])<.01}for(;D.length;){for(k=m.smoothopen(_.edgepaths[P],_.smoothing),M+=N?k:k.replace(/^M/,"L"),D.splice(D.indexOf(P),1),T=_.edgepaths[P][_.edgepaths[P].length-1],w=-1,S=0;S<4;S++){if(!T){d.log("Missing end?",P,_);break}for(L=T,Math.abs(L[1]-x[0][1])<.01&&!X(T)?A=x[1]:q(T)?A=x[0]:U(T)?A=x[3]:X(T)&&(A=x[2]),C=0;C<_.edgepaths.length;C++){var K=_.edgepaths[C][0];Math.abs(T[0]-A[0])<.01?Math.abs(T[0]-K[0])<.01&&(K[1]-T[1])*(A[1]-K[1])>=0&&(A=K,w=C):Math.abs(T[1]-A[1])<.01?Math.abs(T[1]-K[1])<.01&&(K[0]-T[0])*(A[0]-K[0])>=0&&(A=K,w=C):d.log("endpt to newendpt is not vert. or horz.",T,A,K)}if(T=A,w>=0)break;M+="L"+A}if(w===_.edgepaths.length){d.log("unclosed perimeter path");break}P=w,(N=D.indexOf(P)===-1)&&(P=D[0],M+="Z")}for(P=0;P<_.paths.length;P++)M+=m.smoothclosed(_.paths[P],_.smoothing);return M}function y(_,x,T,A){var S=x.width/2,w=x.height/2,C=_.x,k=_.y,L=_.theta,M=Math.cos(L)*S,P=Math.sin(L)*S,D=(C>A.center?A.right-C:C-A.left)/(M+Math.abs(Math.sin(L)*w)),N=(k>A.middle?A.bottom-k:k-A.top)/(Math.abs(P)+Math.cos(L)*w);if(D<1||N<1)return 1/0;var U=g.EDGECOST*(1/(D-1)+1/(N-1));U+=g.ANGLECOST*L*L;for(var q=C-M,X=k-P,K=C+M,Z=k+P,H=0;H<T.length;H++){var Y=T[H],$=Math.cos(Y.theta)*Y.width/2,z=Math.sin(Y.theta)*Y.width/2,j=2*d.segmentDistance(q,X,K,Z,Y.x-$,Y.y-z,Y.x+$,Y.y+z)/(x.height+Y.height),W=Y.level===x.level,ee=W?g.SAMELEVELDISTANCE:1;if(j<=ee)return 1/0;U+=g.NEIGHBORCOST*(W?g.SAMELEVELFACTOR:1)/(j-ee)}return U}function v(_){var x,T,A=_.trace._emptypoints,S=[],w=_.z.length,C=_.z[0].length,k=[];for(x=0;x<C;x++)k.push(1);for(x=0;x<w;x++)S.push(k.slice());for(x=0;x<A.length;x++)S[(T=A[x])[0]][T[1]]=0;return _.zmask=S,S}B.plot=function(_,x,T,A){var S=x.xaxis,w=x.yaxis;d.makeTraceGroups(A,T,"contour").each(function(C){var k=t.select(this),L=C[0],M=L.trace,P=L.x,D=L.y,N=M.contours,U=i(N,x,L),q=d.ensureSingle(k,"g","heatmapcoloring"),X=[];N.coloring==="heatmap"&&(X=[C]),s(_,x,X,q),l(U),o(U);var K=S.c2p(P[0],!0),Z=S.c2p(P[P.length-1],!0),H=w.c2p(D[0],!0),Y=w.c2p(D[D.length-1],!0),$=[[K,Y],[Z,Y],[Z,H],[K,H]],z=U;N.type==="constraint"&&(z=c(U,N._operation)),function(j,W,ee){var J=d.ensureSingle(j,"g","contourbg").selectAll("path").data(ee.coloring==="fill"?[0]:[]);J.enter().append("path"),J.exit().remove(),J.attr("d","M"+W.join("L")+"Z").style("stroke","none")}(k,$,N),function(j,W,ee,J){var Q=J.coloring==="fill"||J.type==="constraint"&&J._operation!=="=",te="M"+ee.join("L")+"Z";Q&&n(W,J);var ie=d.ensureSingle(j,"g","contourfill").selectAll("path").data(Q?W:[]);ie.enter().append("path"),ie.exit().remove(),ie.each(function(ae){var he=(ae.prefixBoundary?te:"")+h(ae,ee);he?t.select(this).attr("d",he).style("stroke","none"):t.select(this).remove()})}(k,z,$,N),function(j,W,ee,J,Q){var te=d.ensureSingle(j,"g","contourlines"),ie=Q.showlines!==!1,ae=Q.showlabels,he=ie&&ae,se=B.createLines(te,ie||ae,W),de=B.createLineClip(te,he,ee,J.trace.uid),ue=j.selectAll("g.contourlabels").data(ae?[0]:[]);if(ue.exit().remove(),ue.enter().append("g").classed("contourlabels",!0),ae){var ve=[],ke=[];d.clearLocationCache();var Ee=B.labelFormatter(ee,J),be=m.tester.append("text").attr("data-notex",1).call(m.font,Q.labelfont),xe=W[0].xaxis,ce=W[0].yaxis,ge=xe._length,we=ce._length,Me=xe.range,Se=ce.range,ze=d.aggNums(Math.min,null,J.x),Fe=d.aggNums(Math.max,null,J.x),Ye=d.aggNums(Math.min,null,J.y),rt=d.aggNums(Math.max,null,J.y),Oe=Math.max(xe.c2p(ze,!0),0),je=Math.min(xe.c2p(Fe,!0),ge),We=Math.max(ce.c2p(rt,!0),0),qe=Math.min(ce.c2p(Ye,!0),we),Qe={};Me[0]<Me[1]?(Qe.left=Oe,Qe.right=je):(Qe.left=je,Qe.right=Oe),Se[0]<Se[1]?(Qe.top=We,Qe.bottom=qe):(Qe.top=qe,Qe.bottom=We),Qe.middle=(Qe.top+Qe.bottom)/2,Qe.center=(Qe.left+Qe.right)/2,ve.push([[Qe.left,Qe.top],[Qe.right,Qe.top],[Qe.right,Qe.bottom],[Qe.left,Qe.bottom]]);var st=Math.sqrt(ge*ge+we*we),ct=a.LABELDISTANCE*st/Math.max(1,W.length/a.LABELINCREASE);se.each(function(Pt){var kt=B.calcTextOpts(Pt.level,Ee,be,ee);t.select(this).selectAll("path").each(function(){var at=d.getVisibleSegment(this,Qe,kt.height/2);if(at&&!(at.len<(kt.width+kt.height)*a.LABELMIN))for(var tt=Math.min(Math.ceil(at.len/ct),a.LABELMAX),_t=0;_t<tt;_t++){var er=B.findBestTextLocation(this,at,kt,ke,Qe);if(!er)break;B.addLabelData(er,kt,ke,ve)}})}),be.remove(),B.drawLabels(ue,ke,ee,de,he?ve:null)}ae&&!ie&&se.remove()}(k,U,_,L,N),function(j,W,ee,J,Q){var te=J.trace,ie=ee._fullLayout._clips,ae="clip"+te.uid,he=ie.selectAll("#"+ae).data(te.connectgaps?[]:[0]);if(he.enter().append("clipPath").classed("contourclip",!0).attr("id",ae),he.exit().remove(),te.connectgaps===!1){var se={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:W.xaxis,yaxis:W.yaxis,x:J.x,y:J.y,z:v(J),smoothing:0};l([se]),o([se]),n([se],{type:"levels"}),d.ensureSingle(he,"path","").attr("d",(se.prefixBoundary?"M"+Q.join("L")+"Z":"")+h(se,Q))}else ae=null;m.setClipUrl(j,ae,ee)}(k,x,_,L,$)})},B.createLines=function(_,x,T){var A=T[0].smoothing,S=_.selectAll("g.contourlevel").data(x?T:[]);if(S.exit().remove(),S.enter().append("g").classed("contourlevel",!0),x){var w=S.selectAll("path.openline").data(function(k){return k.pedgepaths||k.edgepaths});w.exit().remove(),w.enter().append("path").classed("openline",!0),w.attr("d",function(k){return m.smoothopen(k,A)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var C=S.selectAll("path.closedline").data(function(k){return k.ppaths||k.paths});C.exit().remove(),C.enter().append("path").classed("closedline",!0),C.attr("d",function(k){return m.smoothclosed(k,A)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return S},B.createLineClip=function(_,x,T,A){var S=x?"clipline"+A:null,w=T._fullLayout._clips.selectAll("#"+S).data(x?[0]:[]);return w.exit().remove(),w.enter().append("clipPath").classed("contourlineclip",!0).attr("id",S),m.setClipUrl(_,S,T),w},B.labelFormatter=function(_,x){var T=_._fullLayout,A=x.trace,S=A.contours,w={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(S.labelformat)w.tickformat=S.labelformat,u(w,T);else{var C=p.extractOpts(A);if(C&&C.colorbar&&C.colorbar._axis)w=C.colorbar._axis;else{if(S.type==="constraint"){var k=S.value;Array.isArray(k)?w.range=[k[0],k[k.length-1]]:w.range=[k,k]}else w.range=[S.start,S.end],w.nticks=(S.end-S.start)/S.size;w.range[0]===w.range[1]&&(w.range[1]+=w.range[0]||1),w.nticks||(w.nticks=1e3),u(w,T),f.prepTicks(w),w._tmin=null,w._tmax=null}}return function(L){return f.tickText(w,L).text}},B.calcTextOpts=function(_,x,T,A){var S=x(_);T.text(S).call(e.convertToTspans,A);var w=T.node(),C=m.bBox(w,!0);return{text:S,width:C.width,height:C.height,fontSize:+w.style["font-size"].replace("px",""),level:_,dy:(C.top+C.bottom)/2}},B.findBestTextLocation=function(_,x,T,A,S){var w,C,k,L,M,P=T.width;x.isClosed?(C=x.len/g.INITIALSEARCHPOINTS,w=x.min+C/2,k=x.max):(C=(x.len-P)/(g.INITIALSEARCHPOINTS+1),w=x.min+C+P/2,k=x.max-(C+P)/2);for(var D=1/0,N=0;N<g.ITERATIONS;N++){for(var U=w;U<k;U+=C){var q=d.getTextLocation(_,x.total,U,P),X=y(q,T,A,S);X<D&&(D=X,M=q,L=U)}if(D>2*g.MAXCOST)break;N&&(C/=2),k=(w=L-C/2)+1.5*C}if(D<=g.MAXCOST)return M},B.addLabelData=function(_,x,T,A){var S=x.fontSize,w=x.width+S/3,C=Math.max(0,x.height-S/3),k=_.x,L=_.y,M=_.theta,P=Math.sin(M),D=Math.cos(M),N=function(q,X){return[k+q*D-X*P,L+q*P+X*D]},U=[N(-w/2,-C/2),N(-w/2,C/2),N(w/2,C/2),N(w/2,-C/2)];T.push({text:x.text,x:k,y:L,dy:x.dy,theta:M,level:x.level,width:w,height:C}),A.push(U)},B.drawLabels=function(_,x,T,A,S){var w=_.selectAll("text").data(x,function(L){return L.text+","+L.x+","+L.y+","+L.theta});if(w.exit().remove(),w.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(L){var M=L.x+Math.sin(L.theta)*L.dy,P=L.y-Math.cos(L.theta)*L.dy;t.select(this).text(L.text).attr({x:M,y:P,transform:"rotate("+180*L.theta/Math.PI+" "+M+" "+P+")"}).call(e.convertToTspans,T)}),S){for(var C="",k=0;k<S.length;k++)C+="M"+S[k].join("L")+"Z";d.ensureSingle(A,"path","").attr("d",C)}}},{"../../components/colorscale":662,"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../plots/cartesian/set_convert":859,"../heatmap/plot":1080,"./close_boundaries":1014,"./constants":1016,"./convert_to_constraints":1020,"./empty_pathinfo":1022,"./find_all_paths":1024,"./make_crossings":1029,"@plotly/d3":58}],1031:[function(r,O,B){var t=r("../../plots/cartesian/axes"),d=r("../../lib");function m(p,e,f){var u={type:"linear",range:[p,e]};return t.autoTicks(u,(e-p)/(f||15)),u}O.exports=function(p,e){var f=p.contours;if(p.autocontour){var u=p.zmin,s=p.zmax;(p.zauto||u===void 0)&&(u=d.aggNums(Math.min,null,e)),(p.zauto||s===void 0)&&(s=d.aggNums(Math.max,null,e));var l=m(u,s,p.ncontours);f.size=l.dtick,f.start=t.tickFirst(l),l.range.reverse(),f.end=t.tickFirst(l),f.start===u&&(f.start+=f.size),f.end===s&&(f.end-=f.size),f.start>f.end&&(f.start=f.end=(f.start+f.end)/2),p._input.contours||(p._input.contours={}),d.extendFlat(p._input.contours,{start:f.start,end:f.end,size:f.size}),p._input.autocontour=!0}else if(f.type!=="constraint"){var o,i=f.start,c=f.end,n=p._input.contours;i>c&&(f.start=n.start=c,c=f.end=n.end=i,i=f.start),!(f.size>0)&&(o=i===c?1:m(i,c,p.ncontours).dtick,n.size=f.size=o)}}},{"../../lib":787,"../../plots/cartesian/axes":838}],1032:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/drawing"),m=r("../heatmap/style"),p=r("./make_color_map");O.exports=function(e){var f=t.select(e).selectAll("g.contour");f.style("opacity",function(u){return u[0].trace.opacity}),f.each(function(u){var s=t.select(this),l=u[0].trace,o=l.contours,i=l.line,c=o.size||1,n=o.start,a=o.type==="constraint",g=!a&&o.coloring==="lines",h=!a&&o.coloring==="fill",y=g||h?p(l):null;s.selectAll("g.contourlevel").each(function(x){t.select(this).selectAll("path").call(d.lineGroupStyle,i.width,g?y(x.level):i.color,i.dash)});var v=o.labelfont;if(s.selectAll("g.contourlabels text").each(function(x){d.font(t.select(this),{family:v.family,size:v.size,color:v.color||(g?y(x.level):i.color)})}),a)s.selectAll("g.contourfill path").style("fill",l.fillcolor);else if(h){var _;s.selectAll("g.contourfill path").style("fill",function(x){return _===void 0&&(_=x.level),y(x.level+.5*c)}),_===void 0&&(_=n),s.selectAll("g.contourbg path").style("fill",y(_-.5*c))}}),m(e)}},{"../../components/drawing":672,"../heatmap/style":1081,"./make_color_map":1028,"@plotly/d3":58}],1033:[function(r,O,B){var t=r("../../components/colorscale/defaults"),d=r("./label_defaults");O.exports=function(m,p,e,f,u){var s,l=e("contours.coloring"),o="";l==="fill"&&(s=e("contours.showlines")),s!==!1&&(l!=="lines"&&(o=e("line.color","#000")),e("line.width",.5),e("line.dash")),l!=="none"&&(m.showlegend!==!0&&(p.showlegend=!1),p._dfltShowLegend=!1,t(m,p,f,e,{prefix:"",cLetter:"z"})),e("line.smoothing"),d(e,f,o,u)}},{"../../components/colorscale/defaults":660,"./label_defaults":1027}],1034:[function(r,O,B){var t=r("../heatmap/attributes"),d=r("../contour/attributes"),m=r("../../components/colorscale/attributes"),p=r("../../lib/extend").extendFlat,e=d.contours;O.exports=p({carpet:{valType:"string",editType:"calc"},z:t.z,a:t.x,a0:t.x0,da:t.dx,b:t.y,b0:t.y0,db:t.dy,text:t.text,hovertext:t.hovertext,transpose:t.transpose,atype:t.xtype,btype:t.ytype,fillcolor:d.fillcolor,autocontour:d.autocontour,ncontours:d.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:d.line.color,width:d.line.width,dash:d.line.dash,smoothing:d.line.smoothing,editType:"plot"},transforms:void 0},m("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../contour/attributes":1012,"../heatmap/attributes":1069}],1035:[function(r,O,B){var t=r("../../components/colorscale/calc"),d=r("../../lib"),m=r("../heatmap/convert_column_xyz"),p=r("../heatmap/clean_2d_array"),e=r("../heatmap/interp2d"),f=r("../heatmap/find_empties"),u=r("../heatmap/make_bound_array"),s=r("./defaults"),l=r("../carpet/lookup_carpetid"),o=r("../contour/set_contours");O.exports=function(i,c){var n=c._carpetTrace=l(i,c);if(n&&n.visible&&n.visible!=="legendonly"){if(!c.a||!c.b){var a=i.data[n.index],g=i.data[c.index];g.a||(g.a=a.a),g.b||(g.b=a.b),s(g,c,c._defaultColor,i._fullLayout)}var h=function(y,v){var _,x,T,A,S,w,C,k=v._carpetTrace,L=k.aaxis,M=k.baxis;L._minDtick=0,M._minDtick=0,d.isArray1D(v.z)&&m(v,L,M,"a","b",["z"]),_=v._a=v._a||v.a,A=v._b=v._b||v.b,_=_?L.makeCalcdata(v,"_a"):[],A=A?M.makeCalcdata(v,"_b"):[],x=v.a0||0,T=v.da||1,S=v.b0||0,w=v.db||1,C=v._z=p(v._z||v.z,v.transpose),v._emptypoints=f(C),e(C,v._emptypoints);var P=d.maxRowLength(C),D=v.xtype==="scaled"?"":_,N=u(v,D,x,T,P,L),U=v.ytype==="scaled"?"":A,q=u(v,U,S,w,C.length,M),X={a:N,b:q,z:C};return v.contours.type==="levels"&&v.contours.coloring!=="none"&&t(y,v,{vals:C,containerStr:"",cLetter:"z"}),[X]}(i,c);return o(c,c._z),h}}},{"../../components/colorscale/calc":658,"../../lib":787,"../carpet/lookup_carpetid":985,"../contour/set_contours":1031,"../heatmap/clean_2d_array":1071,"../heatmap/convert_column_xyz":1073,"../heatmap/find_empties":1075,"../heatmap/interp2d":1078,"../heatmap/make_bound_array":1079,"./defaults":1036}],1036:[function(r,O,B){var t=r("../../lib"),d=r("../heatmap/xyz_defaults"),m=r("./attributes"),p=r("../contour/constraint_defaults"),e=r("../contour/contours_defaults"),f=r("../contour/style_defaults");O.exports=function(u,s,l,o){function i(c,n){return t.coerce(u,s,m,c,n)}if(i("carpet"),u.a&&u.b){if(!d(u,s,i,o,"a","b"))return void(s.visible=!1);i("text"),i("contours.type")==="constraint"?p(u,s,i,o,l,{hasHover:!1}):(e(u,s,i,function(c){return t.coerce2(u,s,m,c)}),f(u,s,i,o,{hasHover:!1}))}else s._defaultColor=l,s._length=null}},{"../../lib":787,"../contour/constraint_defaults":1017,"../contour/contours_defaults":1019,"../contour/style_defaults":1033,"../heatmap/xyz_defaults":1083,"./attributes":1034}],1037:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../contour/colorbar"),calc:r("./calc"),plot:r("./plot"),style:r("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":852,"../contour/colorbar":1015,"../contour/style":1032,"./attributes":1034,"./calc":1035,"./defaults":1036,"./plot":1038}],1038:[function(r,O,B){var t=r("@plotly/d3"),d=r("../carpet/map_1d_array"),m=r("../carpet/makepath"),p=r("../../components/drawing"),e=r("../../lib"),f=r("../contour/make_crossings"),u=r("../contour/find_all_paths"),s=r("../contour/plot"),l=r("../contour/constants"),o=r("../contour/convert_to_constraints"),i=r("../contour/empty_pathinfo"),c=r("../contour/close_boundaries"),n=r("../carpet/lookup_carpetid"),a=r("../carpet/axis_aligned_line");function g(v,_,x){var T=v.getPointAtLength(_),A=v.getPointAtLength(x),S=A.x-T.x,w=A.y-T.y,C=Math.sqrt(S*S+w*w);return[S/C,w/C]}function h(v){var _=Math.sqrt(v[0]*v[0]+v[1]*v[1]);return[v[0]/_,v[1]/_]}function y(v,_){var x=Math.abs(v[0]*_[0]+v[1]*_[1]);return Math.sqrt(1-x*x)/x}O.exports=function(v,_,x,T){var A=_.xaxis,S=_.yaxis;e.makeTraceGroups(T,x,"contour").each(function(w){var C=t.select(this),k=w[0],L=k.trace,M=L._carpetTrace=n(v,L),P=v.calcdata[M.index][0];if(M.visible&&M.visible!=="legendonly"){var D=k.a,N=k.b,U=L.contours,q=i(U,_,k),X=U.type==="constraint",K=U._operation,Z=X?K==="="?"lines":"fill":U.coloring,H=[[D[0],N[N.length-1]],[D[D.length-1],N[N.length-1]],[D[D.length-1],N[0]],[D[0],N[0]]];f(q);var Y=1e-8*(D[D.length-1]-D[0]),$=1e-8*(N[N.length-1]-N[0]);u(q,Y,$);var z,j,W,ee,J=q;U.type==="constraint"&&(J=o(q,K)),function(ae,he){var se,de,ue,ve,ke,Ee,be,xe,ce;for(se=0;se<ae.length;se++){for(ve=ae[se],ke=ve.pedgepaths=[],Ee=ve.ppaths=[],de=0;de<ve.edgepaths.length;de++){for(ce=ve.edgepaths[de],be=[],ue=0;ue<ce.length;ue++)be[ue]=he(ce[ue]);ke.push(be)}for(de=0;de<ve.paths.length;de++){for(ce=ve.paths[de],xe=[],ue=0;ue<ce.length;ue++)xe[ue]=he(ce[ue]);Ee.push(xe)}}}(q,ie);var Q=[];for(ee=P.clipsegments.length-1;ee>=0;ee--)z=P.clipsegments[ee],j=d([],z.x,A.c2p),W=d([],z.y,S.c2p),j.reverse(),W.reverse(),Q.push(m(j,W,z.bicubic));var te="M"+Q.join("L")+"Z";(function(ae,he,se,de,ue,ve){var ke,Ee,be,xe,ce=e.ensureSingle(ae,"g","contourbg").selectAll("path").data(ve!=="fill"||ue?[]:[0]);ce.enter().append("path"),ce.exit().remove();var ge=[];for(xe=0;xe<he.length;xe++)ke=he[xe],Ee=d([],ke.x,se.c2p),be=d([],ke.y,de.c2p),ge.push(m(Ee,be,ke.bicubic));ce.attr("d","M"+ge.join("L")+"Z").style("stroke","none")})(C,P.clipsegments,A,S,X,Z),function(ae,he,se,de,ue,ve,ke,Ee,be,xe,ce){var ge=xe==="fill";ge&&c(ue,ae.contours);var we=e.ensureSingle(he,"g","contourfill").selectAll("path").data(ge?ue:[]);we.enter().append("path"),we.exit().remove(),we.each(function(Me){var Se=(Me.prefixBoundary?ce:"")+function(ze,Fe,Ye,rt,Oe,je,We,qe){var Qe,st,ct,Pt,kt,at,tt,_t="",er=Fe.edgepaths.map(function(ht,Mt){return Mt}),tr=!0,Ue=1e-4*Math.abs(Ye[0][0]-Ye[2][0]),He=1e-4*Math.abs(Ye[0][1]-Ye[2][1]);function Be(ht){return Math.abs(ht[1]-Ye[0][1])<He}function Ke(ht){return Math.abs(ht[1]-Ye[2][1])<He}function _e(ht){return Math.abs(ht[0]-Ye[0][0])<Ue}function Ce(ht){return Math.abs(ht[0]-Ye[2][0])<Ue}function Le(ht,Mt){var pt,Lt,vt,Dt,xt="";for(Be(ht)&&!Ce(ht)||Ke(ht)&&!_e(ht)?(Dt=Oe.aaxis,vt=a(Oe,je,[ht[0],Mt[0]],.5*(ht[1]+Mt[1]))):(Dt=Oe.baxis,vt=a(Oe,je,.5*(ht[0]+Mt[0]),[ht[1],Mt[1]])),pt=1;pt<vt.length;pt++)for(xt+=Dt.smoothing?"C":"L",Lt=0;Lt<vt[pt].length;Lt++){var it=vt[pt][Lt];xt+=[We.c2p(it[0]),qe.c2p(it[1])]+" "}return xt}for(Qe=0,st=null;er.length;){var Pe=Fe.edgepaths[Qe][0];for(st&&(_t+=Le(st,Pe)),tt=p.smoothopen(Fe.edgepaths[Qe].map(rt),Fe.smoothing),_t+=tr?tt:tt.replace(/^M/,"L"),er.splice(er.indexOf(Qe),1),st=Fe.edgepaths[Qe][Fe.edgepaths[Qe].length-1],kt=-1,Pt=0;Pt<4;Pt++){if(!st){e.log("Missing end?",Qe,Fe);break}for(Be(st)&&!Ce(st)?ct=Ye[1]:_e(st)?ct=Ye[0]:Ke(st)?ct=Ye[3]:Ce(st)&&(ct=Ye[2]),at=0;at<Fe.edgepaths.length;at++){var Xe=Fe.edgepaths[at][0];Math.abs(st[0]-ct[0])<Ue?Math.abs(st[0]-Xe[0])<Ue&&(Xe[1]-st[1])*(ct[1]-Xe[1])>=0&&(ct=Xe,kt=at):Math.abs(st[1]-ct[1])<He?Math.abs(st[1]-Xe[1])<He&&(Xe[0]-st[0])*(ct[0]-Xe[0])>=0&&(ct=Xe,kt=at):e.log("endpt to newendpt is not vert. or horz.",st,ct,Xe)}if(kt>=0)break;_t+=Le(st,ct),st=ct}if(kt===Fe.edgepaths.length){e.log("unclosed perimeter path");break}Qe=kt,(tr=er.indexOf(Qe)===-1)&&(Qe=er[0],_t+=Le(st,ct)+"Z",st=null)}for(Qe=0;Qe<Fe.paths.length;Qe++)_t+=p.smoothclosed(Fe.paths[Qe].map(rt),Fe.smoothing);return _t}(0,Me,ve,ke,Ee,be,se,de);Se?t.select(this).attr("d",Se).style("stroke","none"):t.select(this).remove()})}(L,C,A,S,J,H,ie,M,P,Z,te),function(ae,he,se,de,ue,ve,ke){var Ee=e.ensureSingle(ae,"g","contourlines"),be=ue.showlines!==!1,xe=ue.showlabels,ce=be&&xe,ge=s.createLines(Ee,be||xe,he),we=s.createLineClip(Ee,ce,se,de.trace.uid),Me=ae.selectAll("g.contourlabels").data(xe?[0]:[]);if(Me.exit().remove(),Me.enter().append("g").classed("contourlabels",!0),xe){var Se=ve.xaxis,ze=ve.yaxis,Fe=Se._length,Ye=ze._length,rt=[[[0,0],[Fe,0],[Fe,Ye],[0,Ye]]],Oe=[];e.clearLocationCache();var je=s.labelFormatter(se,de),We=p.tester.append("text").attr("data-notex",1).call(p.font,ue.labelfont),qe={left:0,right:Fe,center:Fe/2,top:0,bottom:Ye,middle:Ye/2},Qe=Math.sqrt(Fe*Fe+Ye*Ye),st=l.LABELDISTANCE*Qe/Math.max(1,he.length/l.LABELINCREASE);ge.each(function(ct){var Pt=s.calcTextOpts(ct.level,je,We,se);t.select(this).selectAll("path").each(function(kt){var at=e.getVisibleSegment(this,qe,Pt.height/2);if(at&&(function(tr,Ue,He,Be,Ke,_e){for(var Ce,Le=0;Le<He.pedgepaths.length;Le++)Ue===He.pedgepaths[Le]&&(Ce=He.edgepaths[Le]);if(!Ce)return;var Pe=Ke.a[0],Xe=Ke.a[Ke.a.length-1],ht=Ke.b[0],Mt=Ke.b[Ke.b.length-1];function pt(it,St){var Nt,Ut=0;return(Math.abs(it[0]-Pe)<.1||Math.abs(it[0]-Xe)<.1)&&(Nt=h(Ke.dxydb_rough(it[0],it[1],.1)),Ut=Math.max(Ut,_e*y(St,Nt)/2)),(Math.abs(it[1]-ht)<.1||Math.abs(it[1]-Mt)<.1)&&(Nt=h(Ke.dxyda_rough(it[0],it[1],.1)),Ut=Math.max(Ut,_e*y(St,Nt)/2)),Ut}var Lt=g(tr,0,1),vt=g(tr,Be.total,Be.total-1),Dt=pt(Ce[0],Lt),xt=Be.total-pt(Ce[Ce.length-1],vt);Be.min<Dt&&(Be.min=Dt),Be.max>xt&&(Be.max=xt),Be.len=Be.max-Be.min}(this,kt,ct,at,ke,Pt.height),!(at.len<(Pt.width+Pt.height)*l.LABELMIN)))for(var tt=Math.min(Math.ceil(at.len/st),l.LABELMAX),_t=0;_t<tt;_t++){var er=s.findBestTextLocation(this,at,Pt,Oe,qe);if(!er)break;s.addLabelData(er,Pt,Oe,rt)}})}),We.remove(),s.drawLabels(Me,Oe,se,we,ce?rt:null)}xe&&!be&&ge.remove()}(C,q,v,k,U,_,M),p.setClipUrl(C,M._clipPathId,v)}function ie(ae){var he=M.ab2xy(ae[0],ae[1],!0);return[A.c2p(he[0]),S.c2p(he[1])]}})}},{"../../components/drawing":672,"../../lib":787,"../carpet/axis_aligned_line":969,"../carpet/lookup_carpetid":985,"../carpet/makepath":986,"../carpet/map_1d_array":987,"../contour/close_boundaries":1014,"../contour/constants":1016,"../contour/convert_to_constraints":1020,"../contour/empty_pathinfo":1022,"../contour/find_all_paths":1024,"../contour/make_crossings":1029,"../contour/plot":1030,"@plotly/d3":58}],1039:[function(r,O,B){var t=r("../../components/colorscale/attributes"),d=r("../../plots/template_attributes").hovertemplateAttrs,m=r("../../plots/attributes"),p=r("../scattermapbox/attributes"),e=r("../../lib/extend").extendFlat;O.exports=e({lon:p.lon,lat:p.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:p.text,hovertext:p.hovertext,hoverinfo:e({},m.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:d(),showlegend:e({},m.showlegend,{dflt:!1})},t("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scattermapbox/attributes":1267}],1040:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib").isArrayOrTypedArray,m=r("../../constants/numerical").BADNUM,p=r("../../components/colorscale/calc"),e=r("../../lib")._;O.exports=function(f,u){for(var s=u._length,l=new Array(s),o=u.z,i=d(o)&&o.length,c=0;c<s;c++){var n=l[c]={},a=u.lon[c],g=u.lat[c];if(n.lonlat=t(a)&&t(g)?[+a,+g]:[m,m],i){var h=o[c];n.z=t(h)?h:m}}return p(f,u,{vals:i?o:[0,1],containerStr:"",cLetter:"z"}),s&&(l[0].t={labels:{lat:e(f,"lat:")+" ",lon:e(f,"lon:")+" "}}),l}},{"../../components/colorscale/calc":658,"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],1041:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../components/color"),p=r("../../components/colorscale"),e=r("../../constants/numerical").BADNUM,f=r("../../lib/geojson_utils").makeBlank;O.exports=function(u){var s=u[0].trace,l=s.visible===!0&&s._length!==0,o=s._opts={heatmap:{layout:{visibility:"none"},paint:{}},geojson:f()};if(!l)return o;var i,c=[],n=s.z,a=s.radius,g=d.isArrayOrTypedArray(n)&&n.length,h=d.isArrayOrTypedArray(a);for(i=0;i<u.length;i++){var y=u[i],v=y.lonlat;if(v[0]!==e){var _={};if(g){var x=y.z;_.z=x!==e?x:0}h&&(_.r=t(a[i])&&a[i]>0?+a[i]:0),c.push({type:"Feature",geometry:{type:"Point",coordinates:v},properties:_})}}var T=p.extractOpts(s),A=T.reversescale?p.flipScale(T.colorscale):T.colorscale,S=A[0][1],w=["interpolate",["linear"],["heatmap-density"],0,m.opacity(S)<1?S:m.addOpacity(S,0)];for(i=1;i<A.length;i++)w.push(A[i][0],A[i][1]);var C=["interpolate",["linear"],["get","z"],T.min,0,T.max,1];return d.extendFlat(o.heatmap.paint,{"heatmap-weight":g?C:1/(T.max-T.min),"heatmap-color":w,"heatmap-radius":h?{type:"identity",property:"r"}:s.radius,"heatmap-opacity":s.opacity}),o.geojson={type:"FeatureCollection",features:c},o.heatmap.layout.visibility="visible",o}},{"../../components/color":650,"../../components/colorscale":662,"../../constants/numerical":763,"../../lib":787,"../../lib/geojson_utils":781,"fast-isnumeric":246}],1042:[function(r,O,B){var t=r("../../lib"),d=r("../../components/colorscale/defaults"),m=r("./attributes");O.exports=function(p,e,f,u){function s(c,n){return t.coerce(p,e,m,c,n)}var l=s("lon")||[],o=s("lat")||[],i=Math.min(l.length,o.length);i?(e._length=i,s("z"),s("radius"),s("below"),s("text"),s("hovertext"),s("hovertemplate"),d(p,e,u,s,{prefix:"",cLetter:"z"})):e.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":1039}],1043:[function(r,O,B){O.exports=function(t,d){return t.lon=d.lon,t.lat=d.lat,t.z=d.z,t}},{}],1044:[function(r,O,B){var t=r("../../plots/cartesian/axes"),d=r("../scattermapbox/hover").hoverPoints,m=r("../scattermapbox/hover").getExtraText;O.exports=function(p,e,f){var u=d(p,e,f);if(u){var s=u[0],l=s.cd,o=l[0].trace,i=l[s.index];if(delete s.color,"z"in i){var c=s.subplot.mockAxis;s.z=i.z,s.zLabel=t.tickText(c,c.c2l(i.z),"hover").text}return s.extraText=m(o,i,l[0].t.labels),[s]}}},{"../../plots/cartesian/axes":838,"../scattermapbox/hover":1272}],1045:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../heatmap/colorbar"),formatLabels:r("../scattermapbox/format_labels"),calc:r("./calc"),plot:r("./plot"),hoverPoints:r("./hover"),eventData:r("./event_data"),getBelow:function(t,d){for(var m=d.getMapLayers(),p=0;p<m.length;p++){var e=m[p],f=e.id;if(e.type==="symbol"&&typeof f=="string"&&f.indexOf("plotly-")===-1)return f}},moduleType:"trace",name:"densitymapbox",basePlotModule:r("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":895,"../heatmap/colorbar":1072,"../scattermapbox/format_labels":1271,"./attributes":1039,"./calc":1040,"./defaults":1042,"./event_data":1043,"./hover":1044,"./plot":1046}],1046:[function(r,O,B){var t=r("./convert"),d=r("../../plots/mapbox/constants").traceLayerPrefix;function m(e,f){this.type="densitymapbox",this.subplot=e,this.uid=f,this.sourceId="source-"+f,this.layerList=[["heatmap",d+f+"-heatmap"]],this.below=null}var p=m.prototype;p.update=function(e){var f=this.subplot,u=this.layerList,s=t(e),l=f.belowLookup["trace-"+this.uid];f.map.getSource(this.sourceId).setData(s.geojson),l!==this.below&&(this._removeLayers(),this._addLayers(s,l),this.below=l);for(var o=0;o<u.length;o++){var i=u[o],c=i[0],n=i[1],a=s[c];f.setOptions(n,"setLayoutProperty",a.layout),a.layout.visibility==="visible"&&f.setOptions(n,"setPaintProperty",a.paint)}},p._addLayers=function(e,f){for(var u=this.subplot,s=this.layerList,l=this.sourceId,o=0;o<s.length;o++){var i=s[o],c=i[0],n=e[c];u.addLayer({type:c,id:i[1],source:l,layout:n.layout,paint:n.paint},f)}},p._removeLayers=function(){for(var e=this.subplot.map,f=this.layerList,u=f.length-1;u>=0;u--)e.removeLayer(f[u][1])},p.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},O.exports=function(e,f){var u=f[0].trace,s=new m(e,u.uid),l=s.sourceId,o=t(f),i=s.below=e.belowLookup["trace-"+u.uid];return e.map.addSource(l,{type:"geojson",data:o.geojson}),s._addLayers(o,i),s}},{"../../plots/mapbox/constants":893,"./convert":1041}],1047:[function(r,O,B){var t=r("../../lib");O.exports=function(d,m){for(var p=0;p<d.length;p++)d[p].i=p;t.mergeArray(m.text,d,"tx"),t.mergeArray(m.hovertext,d,"htx");var e=m.marker;if(e){t.mergeArray(e.opacity,d,"mo"),t.mergeArray(e.color,d,"mc");var f=e.line;f&&(t.mergeArray(f.color,d,"mlc"),t.mergeArrayCastPositive(f.width,d,"mlw"))}}},{"../../lib":787}],1048:[function(r,O,B){var t,d=r("../bar/attributes"),m=r("../scatter/attributes").line,p=r("../../plots/attributes"),e=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,f=r("../../plots/template_attributes").hovertemplateAttrs,u=r("../../plots/template_attributes").texttemplateAttrs,s=r("./constants"),l=r("../../lib/extend").extendFlat,o=r("../../components/color");O.exports={x:d.x,x0:d.x0,dx:d.dx,y:d.y,y0:d.y0,dy:d.dy,xperiod:d.xperiod,yperiod:d.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:d.xperiodalignment,yperiodalignment:d.yperiodalignment,xhoverformat:e("x"),yhoverformat:e("y"),hovertext:d.hovertext,hovertemplate:f({},{keys:s.eventDataKeys}),hoverinfo:l({},p.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:u({editType:"plot"},{keys:s.eventDataKeys.concat(["label","value"])}),text:d.text,textposition:d.textposition,insidetextanchor:l({},d.insidetextanchor,{dflt:"middle"}),textangle:l({},d.textangle,{dflt:0}),textfont:d.textfont,insidetextfont:d.insidetextfont,outsidetextfont:d.outsidetextfont,constraintext:d.constraintext,cliponaxis:d.cliponaxis,orientation:l({},d.orientation,{}),offset:l({},d.offset,{arrayOk:!1}),width:l({},d.width,{arrayOk:!1}),marker:(t=l({},d.marker),delete t.pattern,t),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:l({},m.color,{dflt:o.defaultLine}),width:l({},m.width,{dflt:0,editType:"plot"}),dash:m.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:d.offsetgroup,alignmentgroup:d.alignmentgroup}},{"../../components/color":650,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../bar/attributes":925,"../scatter/attributes":1202,"./constants":1050}],1049:[function(r,O,B){var t=r("../../plots/cartesian/axes"),d=r("../../plots/cartesian/align_period"),m=r("./arrays_to_calcdata"),p=r("../scatter/calc_selection"),e=r("../../constants/numerical").BADNUM;function f(u){return u===e?0:u}O.exports=function(u,s){var l,o,i,c,n,a,g,h,y=t.getFromId(u,s.xaxis||"x"),v=t.getFromId(u,s.yaxis||"y");s.orientation==="h"?(l=y.makeCalcdata(s,"x"),i=v.makeCalcdata(s,"y"),c=d(s,v,"y",i),n=!!s.yperiodalignment,a="y"):(l=v.makeCalcdata(s,"y"),i=y.makeCalcdata(s,"x"),c=d(s,y,"x",i),n=!!s.xperiodalignment,a="x"),o=c.vals;var _,x=Math.min(o.length,l.length),T=new Array(x);for(s._base=[],g=0;g<x;g++){l[g]<0&&(l[g]=e);var A=!1;l[g]!==e&&g+1<x&&l[g+1]!==e&&(A=!0),h=T[g]={p:o[g],s:l[g],cNext:A},s._base[g]=-.5*h.s,n&&(T[g].orig_p=i[g],T[g][a+"End"]=c.ends[g],T[g][a+"Start"]=c.starts[g]),s.ids&&(h.id=String(s.ids[g])),g===0&&(T[0].vTotal=0),T[0].vTotal+=f(h.s),h.begR=f(h.s)/f(T[0].s)}for(g=0;g<x;g++)(h=T[g]).s!==e&&(h.sumR=h.s/T[0].vTotal,h.difR=_!==void 0?h.s/_:1,_=h.s);return m(T,s),p(T,s),T}},{"../../constants/numerical":763,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../scatter/calc_selection":1204,"./arrays_to_calcdata":1047}],1050:[function(r,O,B){O.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],1051:[function(r,O,B){var t=r("../bar/cross_trace_calc").setGroupPositions;O.exports=function(d,m){var p,e,f=d._fullLayout,u=d._fullData,s=d.calcdata,l=m.xaxis,o=m.yaxis,i=[],c=[],n=[];for(e=0;e<u.length;e++){var a=u[e],g=a.orientation==="h";a.visible===!0&&a.xaxis===l._id&&a.yaxis===o._id&&a.type==="funnel"&&(p=s[e],g?n.push(p):c.push(p),i.push(p))}var h={mode:f.funnelmode,norm:f.funnelnorm,gap:f.funnelgap,groupgap:f.funnelgroupgap};for(t(d,l,o,c,h),t(d,o,l,n,h),e=0;e<i.length;e++){p=i[e];for(var y=0;y<p.length;y++)y+1<p.length&&(p[y].nextP0=p[y+1].p0,p[y].nextS0=p[y+1].s0,p[y].nextP1=p[y+1].p1,p[y].nextS1=p[y+1].s1)}}},{"../bar/cross_trace_calc":928}],1052:[function(r,O,B){var t=r("../../lib"),d=r("../bar/defaults").handleGroupingDefaults,m=r("../bar/defaults").handleText,p=r("../scatter/xy_defaults"),e=r("../scatter/period_defaults"),f=r("./attributes"),u=r("../../components/color");O.exports={supplyDefaults:function(s,l,o,i){function c(h,y){return t.coerce(s,l,f,h,y)}if(p(s,l,i,c)){e(s,l,i,c),c("xhoverformat"),c("yhoverformat"),c("orientation",l.y&&!l.x?"v":"h"),c("offset"),c("width");var n=c("text");c("hovertext"),c("hovertemplate");var a=c("textposition");m(s,l,i,c,a,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),l.textposition==="none"||l.texttemplate||c("textinfo",Array.isArray(n)?"text+value":"value");var g=c("marker.color",o);c("marker.line.color",u.defaultLine),c("marker.line.width"),c("connector.visible")&&(c("connector.fillcolor",function(h){var y=t.isArrayOrTypedArray(h)?"#000":h;return u.addOpacity(y,.5*u.opacity(y))}(g)),c("connector.line.width")&&(c("connector.line.color"),c("connector.line.dash")))}else l.visible=!1},crossTraceDefaults:function(s,l){var o,i;function c(a){return t.coerce(i._input,i,f,a)}if(l.funnelmode==="group")for(var n=0;n<s.length;n++)o=(i=s[n])._input,d(o,i,l,c)}}},{"../../components/color":650,"../../lib":787,"../bar/defaults":929,"../scatter/period_defaults":1222,"../scatter/xy_defaults":1229,"./attributes":1048}],1053:[function(r,O,B){O.exports=function(t,d){return t.x="xVal"in d?d.xVal:d.x,t.y="yVal"in d?d.yVal:d.y,"percentInitial"in d&&(t.percentInitial=d.percentInitial),"percentPrevious"in d&&(t.percentPrevious=d.percentPrevious),"percentTotal"in d&&(t.percentTotal=d.percentTotal),d.xa&&(t.xaxis=d.xa),d.ya&&(t.yaxis=d.ya),t}},{}],1054:[function(r,O,B){var t=r("../../components/color").opacity,d=r("../bar/hover").hoverOnBars,m=r("../../lib").formatPercent;O.exports=function(p,e,f,u,s){var l=d(p,e,f,u,s);if(l){var o=l.cd,i=o[0].trace,c=i.orientation==="h",n=o[l.index];l[(c?"x":"y")+"LabelVal"]=n.s,l.percentInitial=n.begR,l.percentInitialLabel=m(n.begR,1),l.percentPrevious=n.difR,l.percentPreviousLabel=m(n.difR,1),l.percentTotal=n.sumR,l.percentTotalLabel=m(n.sumR,1);var a=n.hi||i.hoverinfo,g=[];if(a&&a!=="none"&&a!=="skip"){var h=a==="all",y=a.split("+"),v=function(_){return h||y.indexOf(_)!==-1};v("percent initial")&&g.push(l.percentInitialLabel+" of initial"),v("percent previous")&&g.push(l.percentPreviousLabel+" of previous"),v("percent total")&&g.push(l.percentTotalLabel+" of total")}return l.extraText=g.join("<br>"),l.color=function(_,x){var T=_.marker,A=x.mc||T.color,S=x.mlc||T.line.color,w=x.mlw||T.line.width;if(t(A))return A;if(t(S)&&w)return S}(i,n),[l]}}},{"../../components/color":650,"../../lib":787,"../bar/hover":932}],1055:[function(r,O,B){O.exports={attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults").supplyDefaults,crossTraceDefaults:r("./defaults").crossTraceDefaults,supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc"),crossTraceCalc:r("./cross_trace_calc"),plot:r("./plot"),style:r("./style").style,hoverPoints:r("./hover"),eventData:r("./event_data"),selectPoints:r("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:r("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"../bar/select":937,"./attributes":1048,"./calc":1049,"./cross_trace_calc":1051,"./defaults":1052,"./event_data":1053,"./hover":1054,"./layout_attributes":1056,"./layout_defaults":1057,"./plot":1058,"./style":1059}],1056:[function(r,O,B){O.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1057:[function(r,O,B){var t=r("../../lib"),d=r("./layout_attributes");O.exports=function(m,p,e){var f=!1;function u(o,i){return t.coerce(m,p,d,o,i)}for(var s=0;s<e.length;s++){var l=e[s];if(l.visible&&l.type==="funnel"){f=!0;break}}f&&(u("funnelmode"),u("funnelgap",.2),u("funnelgroupgap"))}},{"../../lib":787,"./layout_attributes":1056}],1058:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../components/drawing"),p=r("../../constants/numerical").BADNUM,e=r("../bar/plot"),f=r("../bar/uniform_text").clearMinTextSize;function u(s,l,o,i){var c=[],n=[],a=i?l:o,g=i?o:l;return c[0]=a.c2p(s.s0,!0),n[0]=g.c2p(s.p0,!0),c[1]=a.c2p(s.s1,!0),n[1]=g.c2p(s.p1,!0),c[2]=a.c2p(s.nextS0,!0),n[2]=g.c2p(s.nextP0,!0),c[3]=a.c2p(s.nextS1,!0),n[3]=g.c2p(s.nextP1,!0),i?[c,n]:[n,c]}O.exports=function(s,l,o,i){var c=s._fullLayout;f("funnel",c),function(n,a,g,h){var y=a.xaxis,v=a.yaxis;d.makeTraceGroups(h,g,"trace bars").each(function(_){var x=t.select(this),T=_[0].trace,A=d.ensureSingle(x,"g","regions");if(T.connector&&T.connector.visible){var S=T.orientation==="h",w=A.selectAll("g.region").data(d.identity);w.enter().append("g").classed("region",!0),w.exit().remove();var C=w.size();w.each(function(k,L){if(L===C-1||k.cNext){var M=u(k,y,v,S),P=M[0],D=M[1],N="";P[0]!==p&&D[0]!==p&&P[1]!==p&&D[1]!==p&&P[2]!==p&&D[2]!==p&&P[3]!==p&&D[3]!==p&&(N+=S?"M"+P[0]+","+D[1]+"L"+P[2]+","+D[2]+"H"+P[3]+"L"+P[1]+","+D[1]+"Z":"M"+P[1]+","+D[1]+"L"+P[2]+","+D[3]+"V"+D[2]+"L"+P[1]+","+D[0]+"Z"),N===""&&(N="M0,0Z"),d.ensureSingle(t.select(this),"path").attr("d",N).call(m.setClipUrl,a.layerClipId,n)}})}else A.remove()})}(s,l,o,i),function(n,a,g,h){var y=a.xaxis,v=a.yaxis;d.makeTraceGroups(h,g,"trace bars").each(function(_){var x=t.select(this),T=_[0].trace,A=d.ensureSingle(x,"g","lines");if(T.connector&&T.connector.visible&&T.connector.line.width){var S=T.orientation==="h",w=A.selectAll("g.line").data(d.identity);w.enter().append("g").classed("line",!0),w.exit().remove();var C=w.size();w.each(function(k,L){if(L===C-1||k.cNext){var M=u(k,y,v,S),P=M[0],D=M[1],N="";P[3]!==void 0&&D[3]!==void 0&&(S?(N+="M"+P[0]+","+D[1]+"L"+P[2]+","+D[2],N+="M"+P[1]+","+D[1]+"L"+P[3]+","+D[2]):(N+="M"+P[1]+","+D[1]+"L"+P[2]+","+D[3],N+="M"+P[1]+","+D[0]+"L"+P[2]+","+D[2])),N===""&&(N="M0,0Z"),d.ensureSingle(t.select(this),"path").attr("d",N).call(m.setClipUrl,a.layerClipId,n)}})}else A.remove()})}(s,l,o,i),e.plot(s,l,o,i,{mode:c.funnelmode,norm:c.funnelmode,gap:c.funnelgap,groupgap:c.funnelgroupgap})}},{"../../components/drawing":672,"../../constants/numerical":763,"../../lib":787,"../bar/plot":936,"../bar/uniform_text":941,"@plotly/d3":58}],1059:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/drawing"),m=r("../../components/color"),p=r("../../constants/interactions").DESELECTDIM,e=r("../bar/style"),f=r("../bar/uniform_text").resizeText,u=e.styleTextPoints;O.exports={style:function(s,l,o){var i=o||t.select(s).selectAll("g.funnellayer").selectAll("g.trace");f(s,i,"funnel"),i.style("opacity",function(c){return c[0].trace.opacity}),i.each(function(c){var n=t.select(this),a=c[0].trace;n.selectAll(".point > path").each(function(g){if(!g.isBlank){var h=a.marker;t.select(this).call(m.fill,g.mc||h.color).call(m.stroke,g.mlc||h.line.color).call(d.dashLine,h.line.dash,g.mlw||h.line.width).style("opacity",a.selectedpoints&&!g.selected?p:1)}}),u(n,a,s),n.selectAll(".regions").each(function(){t.select(this).selectAll("path").style("stroke-width",0).call(m.fill,a.connector.fillcolor)}),n.selectAll(".lines").each(function(){var g=a.connector.line;d.lineGroupStyle(t.select(this).selectAll("path"),g.width,g.color,g.dash)})})}}},{"../../components/color":650,"../../components/drawing":672,"../../constants/interactions":762,"../bar/style":939,"../bar/uniform_text":941,"@plotly/d3":58}],1060:[function(r,O,B){var t=r("../pie/attributes"),d=r("../../plots/attributes"),m=r("../../plots/domain").attributes,p=r("../../plots/template_attributes").hovertemplateAttrs,e=r("../../plots/template_attributes").texttemplateAttrs,f=r("../../lib/extend").extendFlat;O.exports={labels:t.labels,label0:t.label0,dlabel:t.dlabel,values:t.values,marker:{colors:t.marker.colors,line:{color:f({},t.marker.line.color,{dflt:null}),width:f({},t.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:t.text,hovertext:t.hovertext,scalegroup:f({},t.scalegroup,{}),textinfo:f({},t.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:f({},d.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:p({},{keys:["label","color","value","text","percent"]}),textposition:f({},t.textposition,{values:["inside","none"],dflt:"inside"}),textfont:t.textfont,insidetextfont:t.insidetextfont,title:{text:t.title.text,font:t.title.font,position:f({},t.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:m({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":777,"../../plots/attributes":834,"../../plots/domain":866,"../../plots/template_attributes":910,"../pie/attributes":1176}],1061:[function(r,O,B){var t=r("../../plots/plots");B.name="funnelarea",B.plot=function(d,m,p,e){t.plotBasePlot(B.name,d,m,p,e)},B.clean=function(d,m,p,e){t.cleanBasePlot(B.name,d,m,p,e)}},{"../../plots/plots":901}],1062:[function(r,O,B){var t=r("../pie/calc");O.exports={calc:function(d,m){return t.calc(d,m)},crossTraceCalc:function(d){t.crossTraceCalc(d,{type:"funnelarea"})}}},{"../pie/calc":1178}],1063:[function(r,O,B){var t=r("../../lib"),d=r("./attributes"),m=r("../../plots/domain").defaults,p=r("../bar/defaults").handleText,e=r("../pie/defaults").handleLabelsAndValues;O.exports=function(f,u,s,l){function o(_,x){return t.coerce(f,u,d,_,x)}var i=o("labels"),c=o("values"),n=e(i,c),a=n.len;if(u._hasLabels=n.hasLabels,u._hasValues=n.hasValues,!u._hasLabels&&u._hasValues&&(o("label0"),o("dlabel")),a){u._length=a,o("marker.line.width")&&o("marker.line.color",l.paper_bgcolor),o("marker.colors"),o("scalegroup");var g,h=o("text"),y=o("texttemplate");if(y||(g=o("textinfo",Array.isArray(h)?"text+percent":"percent")),o("hovertext"),o("hovertemplate"),y||g&&g!=="none"){var v=o("textposition");p(f,u,l,o,v,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}m(u,l,o),o("title.text")&&(o("title.position"),t.coerceFont(o,"title.font",l.font)),o("aspectratio"),o("baseratio")}else u.visible=!1}},{"../../lib":787,"../../plots/domain":866,"../bar/defaults":929,"../pie/defaults":1179,"./attributes":1060}],1064:[function(r,O,B){O.exports={moduleType:"trace",name:"funnelarea",basePlotModule:r("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot"),style:r("./style"),styleOne:r("../pie/style_one"),meta:{}}},{"../pie/style_one":1187,"./attributes":1060,"./base_plot":1061,"./calc":1062,"./defaults":1063,"./layout_attributes":1065,"./layout_defaults":1066,"./plot":1067,"./style":1068}],1065:[function(r,O,B){var t=r("../pie/layout_attributes").hiddenlabels;O.exports={hiddenlabels:t,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":1183}],1066:[function(r,O,B){var t=r("../../lib"),d=r("./layout_attributes");O.exports=function(m,p){function e(f,u){return t.coerce(m,p,d,f,u)}e("hiddenlabels"),e("funnelareacolorway",p.colorway),e("extendfunnelareacolors")}},{"../../lib":787,"./layout_attributes":1065}],1067:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/drawing"),m=r("../../lib"),p=m.strScale,e=m.strTranslate,f=r("../../lib/svg_text_utils"),u=r("../bar/plot").toMoveInsideBar,s=r("../bar/uniform_text"),l=s.recordMinTextSize,o=s.clearMinTextSize,i=r("../pie/helpers"),c=r("../pie/plot"),n=c.attachFxHandlers,a=c.determineInsideTextFont,g=c.layoutAreas,h=c.prerenderTitles,y=c.positionTitleOutside,v=c.formatSliceLabel;function _(x,T){return"l"+(T[0]-x[0])+","+(T[1]-x[1])}O.exports=function(x,T){var A=x._fullLayout;o("funnelarea",A),h(T,x),g(T,A._size),m.makeTraceGroups(A._funnelarealayer,T,"trace").each(function(S){var w=t.select(this),C=S[0],k=C.trace;(function(L){if(!L.length)return;var M=L[0],P=M.trace,D=P.aspectratio,N=P.baseratio;N>.999&&(N=.999);var U,q=Math.pow(N,2),X=M.vTotal,K=X,Z=X*q/(1-q)/X;function H(){var be,xe={x:be=Math.sqrt(Z),y:-be};return[xe.x,xe.y]}var Y,$,z=[];for(z.push(H()),Y=L.length-1;Y>-1;Y--)if(!($=L[Y]).hidden){var j=$.v/K;Z+=j,z.push(H())}var W=1/0,ee=-1/0;for(Y=0;Y<z.length;Y++)U=z[Y],W=Math.min(W,U[1]),ee=Math.max(ee,U[1]);for(Y=0;Y<z.length;Y++)z[Y][1]-=(ee+W)/2;var J=z[z.length-1][0],Q=M.r,te=(ee-W)/2,ie=Q/J,ae=Q/te*D;for(M.r=ae*te,Y=0;Y<z.length;Y++)z[Y][0]*=ie,z[Y][1]*=ae;var he=[-(U=z[0])[0],U[1]],se=[U[0],U[1]],de=0;for(Y=L.length-1;Y>-1;Y--)if(!($=L[Y]).hidden){var ue=z[de+=1][0],ve=z[de][1];$.TL=[-ue,ve],$.TR=[ue,ve],$.BL=he,$.BR=se,$.pxmid=(ke=$.TR,Ee=$.BR,[.5*(ke[0]+Ee[0]),.5*(ke[1]+Ee[1])]),he=$.TL,se=$.TR}var ke,Ee})(S),w.each(function(){var L=t.select(this).selectAll("g.slice").data(S);L.enter().append("g").classed("slice",!0),L.exit().remove(),L.each(function(P,D){if(P.hidden)t.select(this).selectAll("path,g").remove();else{P.pointNumber=P.i,P.curveNumber=k.index;var N=C.cx,U=C.cy,q=t.select(this),X=q.selectAll("path.surface").data([P]);X.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),q.call(n,x,S);var K="M"+(N+P.TR[0])+","+(U+P.TR[1])+_(P.TR,P.BR)+_(P.BR,P.BL)+_(P.BL,P.TL)+"Z";X.attr("d",K),v(x,P,C);var Z=i.castOption(k.textposition,P.pts),H=q.selectAll("g.slicetext").data(P.text&&Z!=="none"?[0]:[]);H.enter().append("g").classed("slicetext",!0),H.exit().remove(),H.each(function(){var Y=m.ensureSingle(t.select(this),"text","",function(te){te.attr("data-notex",1)}),$=m.ensureUniformFontSize(x,a(k,P,A.font));Y.text(P.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(d.font,$).call(f.convertToTspans,x);var z,j,W,ee=d.bBox(Y.node()),J=Math.min(P.BL[1],P.BR[1])+U,Q=Math.max(P.TL[1],P.TR[1])+U;j=Math.max(P.TL[0],P.BL[0])+N,W=Math.min(P.TR[0],P.BR[0])+N,(z=u(j,W,J,Q,ee,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"})).fontSize=$.size,l(k.type,z,A),S[D].transform=z,Y.attr("transform",m.getTextTransform(z))})}});var M=t.select(this).selectAll("g.titletext").data(k.title.text?[0]:[]);M.enter().append("g").classed("titletext",!0),M.exit().remove(),M.each(function(){var P=m.ensureSingle(t.select(this),"text","",function(U){U.attr("data-notex",1)}),D=k.title.text;k._meta&&(D=m.templateString(D,k._meta)),P.text(D).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(d.font,k.title.font).call(f.convertToTspans,x);var N=y(C,A._size);P.attr("transform",e(N.x,N.y)+p(Math.min(1,N.scale))+e(N.tx,N.ty))})})})}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../bar/plot":936,"../bar/uniform_text":941,"../pie/helpers":1181,"../pie/plot":1185,"@plotly/d3":58}],1068:[function(r,O,B){var t=r("@plotly/d3"),d=r("../pie/style_one"),m=r("../bar/uniform_text").resizeText;O.exports=function(p){var e=p._fullLayout._funnelarealayer.selectAll(".trace");m(p,e,"funnelarea"),e.each(function(f){var u=f[0].trace,s=t.select(this);s.style({opacity:u.opacity}),s.selectAll("path.surface").each(function(l){t.select(this).call(d,l,u)})})}},{"../bar/uniform_text":941,"../pie/style_one":1187,"@plotly/d3":58}],1069:[function(r,O,B){var t=r("../scatter/attributes"),d=r("../../plots/attributes"),m=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=r("../../plots/template_attributes").hovertemplateAttrs,e=r("../../components/colorscale/attributes"),f=r("../../lib/extend").extendFlat;O.exports=f({z:{valType:"data_array",editType:"calc"},x:f({},t.x,{impliedEdits:{xtype:"array"}}),x0:f({},t.x0,{impliedEdits:{xtype:"scaled"}}),dx:f({},t.dx,{impliedEdits:{xtype:"scaled"}}),y:f({},t.y,{impliedEdits:{ytype:"array"}}),y0:f({},t.y0,{impliedEdits:{ytype:"scaled"}}),dy:f({},t.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:f({},t.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:f({},t.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:f({},t.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:f({},t.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:f({},t.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:f({},t.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:m("x"),yhoverformat:m("y"),zhoverformat:m("z",1),hovertemplate:p(),showlegend:f({},d.showlegend,{dflt:!1})},{transforms:void 0},e("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1070:[function(r,O,B){var t=r("../../registry"),d=r("../../lib"),m=r("../../plots/cartesian/axes"),p=r("../../plots/cartesian/align_period"),e=r("../histogram2d/calc"),f=r("../../components/colorscale/calc"),u=r("./convert_column_xyz"),s=r("./clean_2d_array"),l=r("./interp2d"),o=r("./find_empties"),i=r("./make_bound_array"),c=r("../../constants/numerical").BADNUM;function n(a){for(var g=[],h=a.length,y=0;y<h;y++){var v=a[y];v!==c&&g.push(v)}return g}O.exports=function(a,g){var h,y,v,_,x,T,A,S,w,C,k,L=m.getFromId(a,g.xaxis||"x"),M=m.getFromId(a,g.yaxis||"y"),P=t.traceIs(g,"contour"),D=t.traceIs(g,"histogram"),N=t.traceIs(g,"gl2d"),U=P?"best":g.zsmooth;if(L._minDtick=0,M._minDtick=0,D)_=(k=e(a,g)).orig_x,h=k.x,y=k.x0,v=k.dx,S=k.orig_y,x=k.y,T=k.y0,A=k.dy,w=k.z;else{var q=g.z;d.isArray1D(q)?(u(g,L,M,"x","y",["z"]),h=g._x,x=g._y,q=g._z):(_=g.x?L.makeCalcdata(g,"x"):[],S=g.y?M.makeCalcdata(g,"y"):[],h=p(g,L,"x",_).vals,x=p(g,M,"y",S).vals,g._x=h,g._y=x),y=g.x0,v=g.dx,T=g.y0,A=g.dy,w=s(q,g,L,M)}function X(te){U=g._input.zsmooth=g.zsmooth=!1,d.warn('cannot use zsmooth: "fast": '+te)}if((L.rangebreaks||M.rangebreaks)&&(w=function(te,ie,ae){for(var he=[],se=-1,de=0;de<ae.length;de++)if(ie[de]!==c){se++,he[se]=[];for(var ue=0;ue<ae[de].length;ue++)te[ue]!==c&&he[se].push(ae[de][ue])}return he}(h,x,w),D||(h=n(h),x=n(x),g._x=h,g._y=x)),D||!P&&!g.connectgaps||(g._emptypoints=o(w),l(w,g._emptypoints)),U==="fast"){if(L.type==="log"||M.type==="log")X("log axis found");else if(!D){if(h.length){var K=(h[h.length-1]-h[0])/(h.length-1),Z=Math.abs(K/100);for(C=0;C<h.length-1;C++)if(Math.abs(h[C+1]-h[C]-K)>Z){X("x scale is not linear");break}}if(x.length&&U==="fast"){var H=(x[x.length-1]-x[0])/(x.length-1),Y=Math.abs(H/100);for(C=0;C<x.length-1;C++)if(Math.abs(x[C+1]-x[C]-H)>Y){X("y scale is not linear");break}}}}var $=d.maxRowLength(w),z=g.xtype==="scaled"?"":h,j=i(g,z,y,v,$,L),W=g.ytype==="scaled"?"":x,ee=i(g,W,T,A,w.length,M);N||(g._extremes[L._id]=m.findExtremes(L,j),g._extremes[M._id]=m.findExtremes(M,ee));var J={x:j,y:ee,z:w,text:g._text||g.text,hovertext:g._hovertext||g.hovertext};if(g.xperiodalignment&&_&&(J.orig_x=_),g.yperiodalignment&&S&&(J.orig_y=S),z&&z.length===j.length-1&&(J.xCenter=z),W&&W.length===ee.length-1&&(J.yCenter=W),D&&(J.xRanges=k.xRanges,J.yRanges=k.yRanges,J.pts=k.pts),P||f(a,g,{vals:w,cLetter:"z"}),P&&g.contours&&g.contours.coloring==="heatmap"){var Q={type:g.type==="contour"?"heatmap":"histogram2d",xcalendar:g.xcalendar,ycalendar:g.ycalendar};J.xfill=i(Q,z,y,v,$,L),J.yfill=i(Q,W,T,A,w.length,M)}return[J]}},{"../../components/colorscale/calc":658,"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../../registry":915,"../histogram2d/calc":1102,"./clean_2d_array":1071,"./convert_column_xyz":1073,"./find_empties":1075,"./interp2d":1078,"./make_bound_array":1079}],1071:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../constants/numerical").BADNUM;O.exports=function(p,e,f,u){var s,l,o,i,c,n;function a(x){if(t(x))return+x}if(e&&e.transpose){for(s=0,c=0;c<p.length;c++)s=Math.max(s,p[c].length);if(s===0)return!1;o=function(x){return x.length},i=function(x,T,A){return(x[A]||[])[T]}}else s=p.length,o=function(x,T){return x[T].length},i=function(x,T,A){return(x[T]||[])[A]};var g=function(x,T,A){return T===m||A===m?m:i(x,T,A)};function h(x){if(e&&e.type!=="carpet"&&e.type!=="contourcarpet"&&x&&x.type==="category"&&e["_"+x._id.charAt(0)].length){var T=x._id.charAt(0),A={},S=e["_"+T+"CategoryMap"]||e[T];for(c=0;c<S.length;c++)A[S[c]]=c;return function(w){var C=A[x._categories[w]];return C+1?C:m}}return d.identity}var y=h(f),v=h(u);u&&u.type==="category"&&(s=u._categories.length);var _=new Array(s);for(c=0;c<s;c++)for(l=f&&f.type==="category"?f._categories.length:o(p,c),_[c]=new Array(l),n=0;n<l;n++)_[c][n]=a(g(p,v(c),y(n)));return _}},{"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],1072:[function(r,O,B){O.exports={min:"zmin",max:"zmax"}},{}],1073:[function(r,O,B){var t=r("../../lib"),d=r("../../constants/numerical").BADNUM,m=r("../../plots/cartesian/align_period");O.exports=function(p,e,f,u,s,l){var o=p._length,i=e.makeCalcdata(p,u),c=f.makeCalcdata(p,s);i=m(p,e,u,i).vals,c=m(p,f,s,c).vals;var n,a,g,h,y=p.text,v=y!==void 0&&t.isArray1D(y),_=p.hovertext,x=_!==void 0&&t.isArray1D(_),T=t.distinctVals(i),A=T.vals,S=t.distinctVals(c),w=S.vals,C=[],k=w.length,L=A.length;for(n=0;n<l.length;n++)C[n]=t.init2dArray(k,L);v&&(g=t.init2dArray(k,L)),x&&(h=t.init2dArray(k,L));var M=t.init2dArray(k,L);for(n=0;n<o;n++)if(i[n]!==d&&c[n]!==d){var P=t.findBin(i[n]+T.minDiff/2,A),D=t.findBin(c[n]+S.minDiff/2,w);for(a=0;a<l.length;a++){var N=p[l[a]];C[a][D][P]=N[n],M[D][P]=n}v&&(g[D][P]=y[n]),x&&(h[D][P]=_[n])}for(p["_"+u]=A,p["_"+s]=w,a=0;a<l.length;a++)p["_"+l[a]]=C[a];v&&(p._text=g),x&&(p._hovertext=h),e&&e.type==="category"&&(p["_"+u+"CategoryMap"]=A.map(function(U){return e._categories[U]})),f&&f.type==="category"&&(p["_"+s+"CategoryMap"]=w.map(function(U){return f._categories[U]})),p._after2before=M}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835}],1074:[function(r,O,B){var t=r("../../lib"),d=r("./xyz_defaults"),m=r("../scatter/period_defaults"),p=r("./style_defaults"),e=r("../../components/colorscale/defaults"),f=r("./attributes");O.exports=function(u,s,l,o){function i(c,n){return t.coerce(u,s,f,c,n)}d(u,s,i,o)?(m(u,s,o,i),i("xhoverformat"),i("yhoverformat"),i("text"),i("hovertext"),i("hovertemplate"),p(u,s,i,o),i("hoverongaps"),i("connectgaps",t.isArray1D(s.z)&&s.zsmooth!==!1),e(u,s,o,i,{prefix:"",cLetter:"z"})):s.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"../scatter/period_defaults":1222,"./attributes":1069,"./style_defaults":1082,"./xyz_defaults":1083}],1075:[function(r,O,B){var t=r("../../lib").maxRowLength;O.exports=function(d){var m,p,e,f,u,s,l,o,i=[],c={},n=[],a=d[0],g=[],h=[0,0,0],y=t(d);for(p=0;p<d.length;p++)for(m=g,g=a,a=d[p+1]||[],e=0;e<y;e++)g[e]===void 0&&((s=(g[e-1]!==void 0?1:0)+(g[e+1]!==void 0?1:0)+(m[e]!==void 0?1:0)+(a[e]!==void 0?1:0))?(p===0&&s++,e===0&&s++,p===d.length-1&&s++,e===g.length-1&&s++,s<4&&(c[[p,e]]=[p,e,s]),i.push([p,e,s])):n.push([p,e]));for(;n.length;){for(l={},o=!1,u=n.length-1;u>=0;u--)(s=((c[[(p=(f=n[u])[0])-1,e=f[1]]]||h)[2]+(c[[p+1,e]]||h)[2]+(c[[p,e-1]]||h)[2]+(c[[p,e+1]]||h)[2])/20)&&(l[f]=[p,e,s],n.splice(u,1),o=!0);if(!o)throw"findEmpties iterated with no new neighbors";for(f in l)c[f]=l[f],i.push(l[f])}return i.sort(function(v,_){return _[2]-v[2]})}},{"../../lib":787}],1076:[function(r,O,B){var t=r("../../components/fx"),d=r("../../lib"),m=r("../../plots/cartesian/axes"),p=r("../../components/colorscale").extractOpts;O.exports=function(e,f,u,s,l){l||(l={});var o,i,c,n,a=l.isContour,g=e.cd[0],h=g.trace,y=e.xa,v=e.ya,_=g.x,x=g.y,T=g.z,A=g.xCenter,S=g.yCenter,w=g.zmask,C=h.zhoverformat,k=_,L=x;if(e.index!==!1){try{c=Math.round(e.index[1]),n=Math.round(e.index[0])}catch(z){return void d.error("Error hovering on heatmap, pointNumber must be [row,col], found:",e.index)}if(c<0||c>=T[0].length||n<0||n>T.length)return}else{if(t.inbox(f-_[0],f-_[_.length-1],0)>0||t.inbox(u-x[0],u-x[x.length-1],0)>0)return;if(a){var M;for(k=[2*_[0]-_[1]],M=1;M<_.length;M++)k.push((_[M]+_[M-1])/2);for(k.push([2*_[_.length-1]-_[_.length-2]]),L=[2*x[0]-x[1]],M=1;M<x.length;M++)L.push((x[M]+x[M-1])/2);L.push([2*x[x.length-1]-x[x.length-2]])}c=Math.max(0,Math.min(k.length-2,d.findBin(f,k))),n=Math.max(0,Math.min(L.length-2,d.findBin(u,L)))}var P,D,N=y.c2p(_[c]),U=y.c2p(_[c+1]),q=v.c2p(x[n]),X=v.c2p(x[n+1]);a?(P=g.orig_x||_,D=g.orig_y||x,U=N,o=P[c],X=q,i=D[n]):(P=g.orig_x||A||_,D=g.orig_y||S||x,o=A?P[c]:(P[c]+P[c+1])/2,i=S?D[n]:(D[n]+D[n+1])/2,y&&y.type==="category"&&(o=_[c]),v&&v.type==="category"&&(i=x[n]),h.zsmooth&&(N=U=y.c2p(o),q=X=v.c2p(i)));var K=T[n][c];if(w&&!w[n][c]&&(K=void 0),K!==void 0||h.hoverongaps){var Z;Array.isArray(g.hovertext)&&Array.isArray(g.hovertext[n])?Z=g.hovertext[n][c]:Array.isArray(g.text)&&Array.isArray(g.text[n])&&(Z=g.text[n][c]);var H=p(h),Y={type:"linear",range:[H.min,H.max],hoverformat:C,_separators:y._separators,_numFormat:y._numFormat},$=m.tickText(Y,K,"hover").text;return[d.extendFlat(e,{index:h._after2before?h._after2before[n][c]:[n,c],distance:e.maxHoverDistance,spikeDistance:e.maxSpikeDistance,x0:N,x1:U,y0:q,y1:X,xLabelVal:o,yLabelVal:i,zLabelVal:K,zLabel:$,text:Z})]}}},{"../../components/colorscale":662,"../../components/fx":690,"../../lib":787,"../../plots/cartesian/axes":838}],1077:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),colorbar:r("./colorbar"),style:r("./style"),hoverPoints:r("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":852,"./attributes":1069,"./calc":1070,"./colorbar":1072,"./defaults":1074,"./hover":1076,"./plot":1080,"./style":1081}],1078:[function(r,O,B){var t=r("../../lib"),d=[[-1,0],[1,0],[0,-1],[0,1]];function m(e){return .5-.25*Math.min(1,.5*e)}function p(e,f,u){var s,l,o,i,c,n,a,g,h,y,v,_,x,T=0;for(i=0;i<f.length;i++){for(l=(s=f[i])[0],o=s[1],v=e[l][o],y=0,h=0,c=0;c<4;c++)(a=e[l+(n=d[c])[0]])&&(g=a[o+n[1]])!==void 0&&(y===0?_=x=g:(_=Math.min(_,g),x=Math.max(x,g)),h++,y+=g);if(h===0)throw"iterateInterp2d order is wrong: no defined neighbors";e[l][o]=y/h,v===void 0?h<4&&(T=1):(e[l][o]=(1+u)*e[l][o]-u*v,x>_&&(T=Math.max(T,Math.abs(e[l][o]-v)/(x-_))))}return T}O.exports=function(e,f){var u,s=1;for(p(e,f),u=0;u<f.length&&!(f[u][2]<4);u++);for(f=f.slice(u),u=0;u<100&&s>.01;u++)s=p(e,f,m(s));return s>.01&&t.log("interp2d didn't converge quickly",s),e}},{"../../lib":787}],1079:[function(r,O,B){var t=r("../../registry"),d=r("../../lib").isArrayOrTypedArray;O.exports=function(m,p,e,f,u,s){var l,o,i,c=[],n=t.traceIs(m,"contour"),a=t.traceIs(m,"histogram"),g=t.traceIs(m,"gl2d");if(d(p)&&p.length>1&&!a&&s.type!=="category"){var h=p.length;if(!(h<=u))return n?p.slice(0,u):p.slice(0,u+1);if(n||g)c=p.slice(0,u);else if(u===1)c=[p[0]-.5,p[0]+.5];else{for(c=[1.5*p[0]-.5*p[1]],i=1;i<h;i++)c.push(.5*(p[i-1]+p[i]));c.push(1.5*p[h-1]-.5*p[h-2])}if(h<u){var y=c[c.length-1],v=y-c[c.length-2];for(i=h;i<u;i++)y+=v,c.push(y)}}else{var _=m[s._id.charAt(0)+"calendar"];for(a?l=s.r2c(e,0,_):d(p)&&p.length===1?l=p[0]:e===void 0?l=0:l=(s.type==="log"?s.d2c:s.r2c)(e,0,_),o=f||1,i=n||g?0:-.5;i<u;i++)c.push(l+o*i)}return c}},{"../../lib":787,"../../registry":915}],1080:[function(r,O,B){var t=r("@plotly/d3"),d=r("tinycolor2"),m=r("../../registry"),p=r("../../lib"),e=r("../../components/colorscale").makeColorScaleFuncFromTrace,f=r("../../constants/xmlns_namespaces");function u(o,i){var c=i.length-2,n=p.constrain(p.findBin(o,i),0,c),a=i[n],g=i[n+1],h=p.constrain(n+(o-a)/(g-a)-.5,0,c),y=Math.round(h),v=Math.abs(h-y);return h&&h!==c&&v?{bin0:y,frac:v,bin1:Math.round(y+v/(h-y))}:{bin0:y,bin1:y,frac:0}}function s(o,i){var c=i.length-1,n=p.constrain(p.findBin(o,i),0,c),a=i[n],g=(o-a)/(i[n+1]-a)||0;return g<=0?{bin0:n,bin1:n,frac:0}:g<.5?{bin0:n,bin1:n+1,frac:g}:{bin0:n+1,bin1:n,frac:1-g}}function l(o,i,c){o[i]=c[0],o[i+1]=c[1],o[i+2]=c[2],o[i+3]=Math.round(255*c[3])}O.exports=function(o,i,c,n){var a=i.xaxis,g=i.yaxis;p.makeTraceGroups(n,c,"hm").each(function(h){var y,v,_,x,T,A,S=t.select(this),w=h[0],C=w.trace,k=w.z,L=w.x,M=w.y,P=w.xCenter,D=w.yCenter,N=m.traceIs(C,"contour"),U=N?"best":C.zsmooth,q=k.length,X=p.maxRowLength(k),K=!1,Z=!1;for(A=0;y===void 0&&A<L.length-1;)y=a.c2p(L[A]),A++;for(A=L.length-1;v===void 0&&A>0;)v=a.c2p(L[A]),A--;for(v<y&&(_=v,v=y,y=_,K=!0),A=0;x===void 0&&A<M.length-1;)x=g.c2p(M[A]),A++;for(A=M.length-1;T===void 0&&A>0;)T=g.c2p(M[A]),A--;if(T<x&&(_=x,x=T,T=_,Z=!0),N&&(P=L,D=M,L=w.xfill,M=w.yfill),U!=="fast"){var H=U==="best"?0:.5;y=Math.max(-H*a._length,y),v=Math.min((1+H)*a._length,v),x=Math.max(-H*g._length,x),T=Math.min((1+H)*g._length,T)}var Y=Math.round(v-y),$=Math.round(T-x);if(Y<=0||$<=0)S.selectAll("image").data([]).exit().remove();else{var z,j;U==="fast"?(z=X,j=q):(z=Y,j=$);var W=document.createElement("canvas");W.width=z,W.height=j;var ee,J,Q=W.getContext("2d"),te=e(C,{noNumericCheck:!0,returnArray:!0});U==="fast"?(ee=K?function(Be){return X-1-Be}:p.identity,J=Z?function(Be){return q-1-Be}:p.identity):(ee=function(Be){return p.constrain(Math.round(a.c2p(L[Be])-y),0,Y)},J=function(Be){return p.constrain(Math.round(g.c2p(M[Be])-x),0,$)});var ie,ae,he,se,de,ue=J(0),ve=[ue,ue],ke=K?0:1,Ee=Z?0:1,be=0,xe=0,ce=0,ge=0;if(U){var we,Me=0;try{we=new Uint8Array(Y*$*4)}catch(Be){we=new Array(Y*$*4)}if(U==="best"){var Se,ze,Fe,Ye=P||L,rt=D||M,Oe=new Array(Ye.length),je=new Array(rt.length),We=new Array(Y),qe=P?s:u,Qe=D?s:u;for(A=0;A<Ye.length;A++)Oe[A]=Math.round(a.c2p(Ye[A])-y);for(A=0;A<rt.length;A++)je[A]=Math.round(g.c2p(rt[A])-x);for(A=0;A<Y;A++)We[A]=qe(A,Oe);for(ae=0;ae<$;ae++)for(ze=k[(Se=Qe(ae,je)).bin0],Fe=k[Se.bin1],A=0;A<Y;A++,Me+=4)l(we,Me,de=He(ze,Fe,We[A],Se))}else for(ae=0;ae<q;ae++)for(se=k[ae],ve=J(ae),A=0;A<Y;A++)de=Ue(se[A],1),l(we,Me=4*(ve*Y+ee(A)),de);var st=Q.createImageData(Y,$);try{st.data.set(we)}catch(Be){var ct=st.data,Pt=ct.length;for(ae=0;ae<Pt;ae++)ct[ae]=we[ae]}Q.putImageData(st,0,0)}else{var kt=C.xgap,at=C.ygap,tt=Math.floor(kt/2),_t=Math.floor(at/2);for(ae=0;ae<q;ae++)if(se=k[ae],ve.reverse(),ve[Ee]=J(ae+1),ve[0]!==ve[1]&&ve[0]!==void 0&&ve[1]!==void 0)for(ie=[he=ee(0),he],A=0;A<X;A++)ie.reverse(),ie[ke]=ee(A+1),ie[0]!==ie[1]&&ie[0]!==void 0&&ie[1]!==void 0&&(de=Ue(se[A],(ie[1]-ie[0])*(ve[1]-ve[0])),Q.fillStyle="rgba("+de.join(",")+")",Q.fillRect(ie[0]+tt,ve[0]+_t,ie[1]-ie[0]-kt,ve[1]-ve[0]-at))}xe=Math.round(xe/be),ce=Math.round(ce/be),ge=Math.round(ge/be);var er=d("rgb("+xe+","+ce+","+ge+")");o._hmpixcount=(o._hmpixcount||0)+be,o._hmlumcount=(o._hmlumcount||0)+be*er.getLuminance();var tr=S.selectAll("image").data(h);tr.enter().append("svg:image").attr({xmlns:f.svg,preserveAspectRatio:"none"}),tr.attr({height:$,width:Y,x:y,y:x,"xlink:href":W.toDataURL("image/png")})}function Ue(Be,Ke){if(Be!==void 0){var _e=te(Be);return _e[0]=Math.round(_e[0]),_e[1]=Math.round(_e[1]),_e[2]=Math.round(_e[2]),be+=Ke,xe+=_e[0]*Ke,ce+=_e[1]*Ke,ge+=_e[2]*Ke,_e}return[0,0,0,0]}function He(Be,Ke,_e,Ce){var Le=Be[_e.bin0];if(Le===void 0)return Ue(void 0,1);var Pe,Xe=Be[_e.bin1],ht=Ke[_e.bin0],Mt=Ke[_e.bin1],pt=Xe-Le||0,Lt=ht-Le||0;return Pe=Xe===void 0?Mt===void 0?0:ht===void 0?2*(Mt-Le):2*(2*Mt-ht-Le)/3:Mt===void 0?ht===void 0?0:2*(2*Le-Xe-ht)/3:ht===void 0?2*(2*Mt-Xe-Le)/3:Mt+Le-Xe-ht,Ue(Le+_e.frac*pt+Ce.frac*(Lt+_e.frac*Pe))}})}},{"../../components/colorscale":662,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../registry":915,"@plotly/d3":58,tinycolor2:583}],1081:[function(r,O,B){var t=r("@plotly/d3");O.exports=function(d){t.select(d).selectAll(".hm image").style("opacity",function(m){return m.trace.opacity})}},{"@plotly/d3":58}],1082:[function(r,O,B){O.exports=function(t,d,m){m("zsmooth")===!1&&(m("xgap"),m("ygap")),m("zhoverformat")}},{}],1083:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../registry");function p(e,f){var u=f(e);return(u?f(e+"type","array"):"scaled")==="scaled"&&(f(e+"0"),f("d"+e)),u}O.exports=function(e,f,u,s,l,o){var i,c,n=u("z");if(l=l||"x",o=o||"y",n===void 0||!n.length)return 0;if(d.isArray1D(e.z)){i=u(l),c=u(o);var a=d.minRowLength(i),g=d.minRowLength(c);if(a===0||g===0)return 0;f._length=Math.min(a,g,n.length)}else{if(i=p(l,u),c=p(o,u),!function(h){for(var y,v=!0,_=!1,x=!1,T=0;T<h.length;T++){if(y=h[T],!d.isArrayOrTypedArray(y)){v=!1;break}y.length>0&&(_=!0);for(var A=0;A<y.length;A++)if(t(y[A])){x=!0;break}}return v&&_&&x}(n))return 0;u("transpose"),f._length=null}return e.type==="heatmapgl"||m.getComponentMethod("calendars","handleTraceDefaults")(e,f,[l,o],s),!0}},{"../../lib":787,"../../registry":915,"fast-isnumeric":246}],1084:[function(r,O,B){for(var t=r("../heatmap/attributes"),d=r("../../components/colorscale/attributes"),m=r("../../lib/extend").extendFlat,p=r("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],f={},u=0;u<e.length;u++){var s=e[u];f[s]=t[s]}f.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},m(f,d("",{cLetter:"z",autoColorDflt:!1})),O.exports=p(f,"calc","nested")},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../heatmap/attributes":1069}],1085:[function(r,O,B){var t=r("gl-heatmap2d"),d=r("../../plots/cartesian/axes"),m=r("../../lib/str2rgbarray");function p(f,u){this.scene=f,this.uid=u,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=t(f.glplot,this.options),this.heatmap._trace=this}var e=p.prototype;e.handlePick=function(f){var u=this.options,s=u.shape,l=f.pointId,o=l%s[0],i=Math.floor(l/s[0]),c=l;return{trace:this,dataCoord:f.dataCoord,traceCoord:[u.x[o],u.y[i],u.z[c]],textLabel:this.textLabels[l],name:this.name,pointIndex:[i,o],hoverinfo:this.hoverinfo}},e.update=function(f,u){var s=u[0];this.index=f.index,this.name=f.name,this.hoverinfo=f.hoverinfo;var l=s.z;this.options.z=[].concat.apply([],l);var o=l[0].length,i=l.length;this.options.shape=[o,i],this.options.x=s.x,this.options.y=s.y,this.options.zsmooth=f.zsmooth;var c=function(y){for(var v=y.colorscale,_=y.zmin,x=y.zmax,T=v.length,A=new Array(T),S=new Array(4*T),w=0;w<T;w++){var C=v[w],k=m(C[1]);A[w]=_+C[0]*(x-_);for(var L=0;L<4;L++)S[4*w+L]=k[L]}return{colorLevels:A,colorValues:S}}(f);this.options.colorLevels=c.colorLevels,this.options.colorValues=c.colorValues,this.textLabels=[].concat.apply([],f.text),this.heatmap.update(this.options);var n,a,g=this.scene.xaxis,h=this.scene.yaxis;f.zsmooth===!1&&(n={ppad:s.x[1]-s.x[0]},a={ppad:s.y[1]-s.y[0]}),f._extremes[g._id]=d.findExtremes(g,s.x,n),f._extremes[h._id]=d.findExtremes(h,s.y,a)},e.dispose=function(){this.heatmap.dispose()},O.exports=function(f,u,s){var l=new p(f,u.uid);return l.update(u,s),l}},{"../../lib/str2rgbarray":812,"../../plots/cartesian/axes":838,"gl-heatmap2d":272}],1086:[function(r,O,B){var t=r("../../lib"),d=r("../heatmap/xyz_defaults"),m=r("../../components/colorscale/defaults"),p=r("./attributes");O.exports=function(e,f,u,s){function l(o,i){return t.coerce(e,f,p,o,i)}d(e,f,l,s)?(l("text"),l("zsmooth"),m(e,f,s,l,{prefix:"",cLetter:"z"})):f.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"../heatmap/xyz_defaults":1083,"./attributes":1084}],1087:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../heatmap/colorbar"),calc:r("../heatmap/calc"),plot:r("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:r("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":878,"../heatmap/calc":1070,"../heatmap/colorbar":1072,"./attributes":1084,"./convert":1085,"./defaults":1086}],1088:[function(r,O,B){var t=r("../bar/attributes"),d=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=r("../../plots/template_attributes").hovertemplateAttrs,p=r("./bin_attributes"),e=r("./constants"),f=r("../../lib/extend").extendFlat;O.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:d("x"),yhoverformat:d("y"),text:f({},t.text,{}),hovertext:f({},t.hovertext,{}),orientation:t.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:p("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:p("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:m({},{keys:e.eventDataKeys}),marker:t.marker,offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup,selected:t.selected,unselected:t.unselected,_deprecated:{bardir:t._deprecated.bardir}}},{"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../bar/attributes":925,"./bin_attributes":1090,"./constants":1094}],1089:[function(r,O,B){O.exports=function(t,d){for(var m=t.length,p=0,e=0;e<m;e++)d[e]?(t[e]/=d[e],p+=t[e]):t[e]=null;return p}},{}],1090:[function(r,O,B){O.exports=function(t,d){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],1091:[function(r,O,B){var t=r("fast-isnumeric");O.exports={count:function(d,m,p){return p[d]++,1},sum:function(d,m,p,e){var f=e[m];return t(f)?(f=Number(f),p[d]+=f,f):0},avg:function(d,m,p,e,f){var u=e[m];return t(u)&&(u=Number(u),p[d]+=u,f[d]++),0},min:function(d,m,p,e){var f=e[m];if(t(f)){if(f=Number(f),!t(p[d]))return p[d]=f,f;if(p[d]>f){var u=f-p[d];return p[d]=f,u}}return 0},max:function(d,m,p,e){var f=e[m];if(t(f)){if(f=Number(f),!t(p[d]))return p[d]=f,f;if(p[d]<f){var u=f-p[d];return p[d]=f,u}}return 0}}},{"fast-isnumeric":246}],1092:[function(r,O,B){var t=r("../../constants/numerical"),d=t.ONEAVGYEAR,m=t.ONEAVGMONTH,p=t.ONEDAY,e=t.ONEHOUR,f=t.ONEMIN,u=t.ONESEC,s=r("../../plots/cartesian/axes").tickIncrement;function l(n,a,g,h){if(n*a<=0)return 1/0;for(var y=Math.abs(a-n),v=g.type==="date",_=o(y,v),x=0;x<10;x++){var T=o(80*_,v);if(_===T||!i(T,n,a,v,g,h))break;_=T}return _}function o(n,a){return a&&n>u?n>p?n>1.1*d?d:n>1.1*m?m:p:n>e?e:n>f?f:u:Math.pow(10,Math.floor(Math.log(n)/Math.LN10))}function i(n,a,g,h,y,v){if(h&&n>p){var _=c(a,y,v),x=c(g,y,v),T=n===d?0:1;return _[T]!==x[T]}return Math.floor(g/n)-Math.floor(a/n)>.1}function c(n,a,g){var h=a.c2d(n,d,g).split("-");return h[0]===""&&(h.unshift(),h[0]="-"+h[0]),h}O.exports=function(n,a,g,h,y){var v,_,x=-1.1*a,T=-.1*a,A=n-T,S=g[0],w=g[1],C=Math.min(l(S+T,S+A,h,y),l(w+T,w+A,h,y)),k=Math.min(l(S+x,S+T,h,y),l(w+x,w+T,h,y));if(C>k&&k<Math.abs(w-S)/4e3?(v=C,_=!1):(v=Math.min(C,k),_=!0),h.type==="date"&&v>p){var L=v===d?1:6,M=v===d?"M12":"M1";return function(P,D){var N=h.c2d(P,d,y),U=N.indexOf("-",L);U>0&&(N=N.substr(0,U));var q=h.d2c(N,0,y);if(q<P){var X=s(q,M,!1,y);(q+X)/2<P+n&&(q=X)}return D&&_?s(q,M,!0,y):q}}return function(P,D){var N=v*Math.round(P/v);return N+v/10<P&&N+.9*v<P+n&&(N+=v),D&&_&&(N-=v),N}}},{"../../constants/numerical":763,"../../plots/cartesian/axes":838}],1093:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../registry"),p=r("../../plots/cartesian/axes"),e=r("../bar/arrays_to_calcdata"),f=r("./bin_functions"),u=r("./norm_functions"),s=r("./average"),l=r("./bin_label_vals");function o(i,c,n,a,g){var h,y,v,_,x,T,A,S=a+"bins",w=i._fullLayout,C=c["_"+a+"bingroup"],k=w._histogramBinOpts[C],L=w.barmode==="overlay",M=function(ue){return n.r2c(ue,0,_)},P=function(ue){return n.c2r(ue,0,_)},D=n.type==="date"?function(ue){return ue||ue===0?d.cleanDate(ue,null,_):null}:function(ue){return t(ue)?Number(ue):null};function N(ue,ve,ke){ve[ue+"Found"]?(ve[ue]=D(ve[ue]),ve[ue]===null&&(ve[ue]=ke[ue])):(T[ue]=ve[ue]=ke[ue],d.nestedProperty(y[0],S+"."+ue).set(ke[ue]))}if(c["_"+a+"autoBinFinished"])delete c["_"+a+"autoBinFinished"];else{y=k.traces;var U=[],q=!0,X=!1,K=!1;for(h=0;h<y.length;h++)if((v=y[h]).visible){var Z=k.dirs[h];x=v["_"+Z+"pos0"]=n.makeCalcdata(v,Z),U=d.concat(U,x),delete v["_"+a+"autoBinFinished"],c.visible===!0&&(q?q=!1:(delete v._autoBin,v["_"+a+"autoBinFinished"]=1),m.traceIs(v,"2dMap")&&(X=!0),v.type==="histogram2dcontour"&&(K=!0))}_=y[0][a+"calendar"];var H=p.autoBin(U,n,k.nbins,X,_,k.sizeFound&&k.size),Y=y[0]._autoBin={};if(T=Y[k.dirs[0]]={},K&&(k.size||(H.start=P(p.tickIncrement(M(H.start),H.size,!0,_))),k.end===void 0&&(H.end=P(p.tickIncrement(M(H.end),H.size,!1,_)))),L&&!m.traceIs(c,"2dMap")&&H._dataSpan===0&&n.type!=="category"&&n.type!=="multicategory"){if(g)return[H,x,!0];H=function(ue,ve,ke,Ee,be){var xe,ce,ge,we=ue._fullLayout,Me=function(ct,Pt){for(var kt=Pt.xaxis,at=Pt.yaxis,tt=Pt.orientation,_t=[],er=ct._fullData,tr=0;tr<er.length;tr++){var Ue=er[tr];Ue.type==="histogram"&&Ue.visible===!0&&Ue.orientation===tt&&Ue.xaxis===kt&&Ue.yaxis===at&&_t.push(Ue)}return _t}(ue,ve),Se=!1,ze=1/0,Fe=[ve];for(xe=0;xe<Me.length;xe++)if((ce=Me[xe])===ve)Se=!0;else if(Se){var Ye=o(ue,ce,ke,Ee,!0),rt=Ye[0],Oe=Ye[2];ce["_"+Ee+"autoBinFinished"]=1,ce["_"+Ee+"pos0"]=Ye[1],Oe?Fe.push(ce):ze=Math.min(ze,rt.size)}else ge=we._histogramBinOpts[ce["_"+Ee+"bingroup"]],ze=Math.min(ze,ge.size||ce[be].size);var je=new Array(Fe.length);for(xe=0;xe<Fe.length;xe++)for(var We=Fe[xe]["_"+Ee+"pos0"],qe=0;qe<We.length;qe++)if(We[qe]!==void 0){je[xe]=We[qe];break}for(isFinite(ze)||(ze=d.distinctVals(je).minDiff),xe=0;xe<Fe.length;xe++){var Qe=(ce=Fe[xe])[Ee+"calendar"],st={start:ke.c2r(je[xe]-ze/2,0,Qe),end:ke.c2r(je[xe]+ze/2,0,Qe),size:ze};ce._input[be]=ce[be]=st,(ge=we._histogramBinOpts[ce["_"+Ee+"bingroup"]])&&d.extendFlat(ge,st)}return ve[be]}(i,c,n,a,S)}(A=v.cumulative||{}).enabled&&A.currentbin!=="include"&&(A.direction==="decreasing"?H.start=P(p.tickIncrement(M(H.start),H.size,!0,_)):H.end=P(p.tickIncrement(M(H.end),H.size,!1,_))),k.size=H.size,k.sizeFound||(T.size=H.size,d.nestedProperty(y[0],S+".size").set(H.size)),N("start",k,H),N("end",k,H)}x=c["_"+a+"pos0"],delete c["_"+a+"pos0"];var $=c._input[S]||{},z=d.extendFlat({},k),j=k.start,W=n.r2l($.start),ee=W!==void 0;if((k.startFound||ee)&&W!==n.r2l(j)){var J=ee?W:d.aggNums(Math.min,null,x),Q={type:n.type==="category"||n.type==="multicategory"?"linear":n.type,r2l:n.r2l,dtick:k.size,tick0:j,calendar:_,range:[J,p.tickIncrement(J,k.size,!1,_)].map(n.l2r)},te=p.tickFirst(Q);te>n.r2l(J)&&(te=p.tickIncrement(te,k.size,!0,_)),z.start=n.l2r(te),ee||d.nestedProperty(c,S+".start").set(z.start)}var ie=k.end,ae=n.r2l($.end),he=ae!==void 0;if((k.endFound||he)&&ae!==n.r2l(ie)){var se=he?ae:d.aggNums(Math.max,null,x);z.end=n.l2r(se),he||d.nestedProperty(c,S+".start").set(z.end)}var de="autobin"+a;return c._input[de]===!1&&(c._input[S]=d.extendFlat({},c[S]||{}),delete c._input[de],delete c[de]),[z,x]}O.exports={calc:function(i,c){var n,a,g,h,y=[],v=[],_=p.getFromId(i,c.orientation==="h"?c.yaxis:c.xaxis),x=c.orientation==="h"?"y":"x",T={x:"y",y:"x"}[x],A=c[x+"calendar"],S=c.cumulative,w=o(i,c,_,x),C=w[0],k=w[1],L=typeof C.size=="string",M=[],P=L?M:C,D=[],N=[],U=[],q=0,X=c.histnorm,K=c.histfunc,Z=X.indexOf("density")!==-1;S.enabled&&Z&&(X=X.replace(/ ?density$/,""),Z=!1);var H,Y=K==="max"||K==="min"?null:0,$=f.count,z=u[X],j=!1,W=function(xe){return _.r2c(xe,0,A)};for(d.isArrayOrTypedArray(c[T])&&K!=="count"&&(H=c[T],j=K==="avg",$=f[K]),n=W(C.start),g=W(C.end)+(n-p.tickIncrement(n,C.size,!1,A))/1e6;n<g&&y.length<1e6&&(a=p.tickIncrement(n,C.size,!1,A),y.push((n+a)/2),v.push(Y),U.push([]),M.push(n),Z&&D.push(1/(a-n)),j&&N.push(0),!(a<=n));)n=a;M.push(n),L||_.type!=="date"||(P={start:W(P.start),end:W(P.end),size:P.size}),i._fullLayout._roundFnOpts||(i._fullLayout._roundFnOpts={});var ee=c["_"+x+"bingroup"],J={leftGap:1/0,rightGap:1/0};ee&&(i._fullLayout._roundFnOpts[ee]||(i._fullLayout._roundFnOpts[ee]=J),J=i._fullLayout._roundFnOpts[ee]);var Q,te=v.length,ie=!0,ae=J.leftGap,he=J.rightGap,se={};for(n=0;n<k.length;n++){var de=k[n];(h=d.findBin(de,P))>=0&&h<te&&(q+=$(h,n,v,H,N),ie&&U[h].length&&de!==k[U[h][0]]&&(ie=!1),U[h].push(n),se[n]=h,ae=Math.min(ae,de-M[h]),he=Math.min(he,M[h+1]-de))}J.leftGap=ae,J.rightGap=he,ie||(Q=function(xe,ce){return function(){var ge=i._fullLayout._roundFnOpts[ee];return l(ge.leftGap,ge.rightGap,M,_,A)(xe,ce)}}),j&&(q=s(v,N)),z&&z(v,q,D),S.enabled&&function(xe,ce,ge){var we,Me,Se;function ze(Ye){Se=xe[Ye],xe[Ye]/=2}function Fe(Ye){Me=xe[Ye],xe[Ye]=Se+Me/2,Se+=Me}if(ge==="half")if(ce==="increasing")for(ze(0),we=1;we<xe.length;we++)Fe(we);else for(ze(xe.length-1),we=xe.length-2;we>=0;we--)Fe(we);else if(ce==="increasing"){for(we=1;we<xe.length;we++)xe[we]+=xe[we-1];ge==="exclude"&&(xe.unshift(0),xe.pop())}else{for(we=xe.length-2;we>=0;we--)xe[we]+=xe[we+1];ge==="exclude"&&(xe.push(0),xe.shift())}}(v,S.direction,S.currentbin);var ue=Math.min(y.length,v.length),ve=[],ke=0,Ee=ue-1;for(n=0;n<ue;n++)if(v[n]){ke=n;break}for(n=ue-1;n>=ke;n--)if(v[n]){Ee=n;break}for(n=ke;n<=Ee;n++)if(t(y[n])&&t(v[n])){var be={p:y[n],s:v[n],b:0};S.enabled||(be.pts=U[n],ie?be.ph0=be.ph1=U[n].length?k[U[n][0]]:y[n]:(c._computePh=!0,be.ph0=Q(M[n]),be.ph1=Q(M[n+1],!0))),ve.push(be)}return ve.length===1&&(ve[0].width1=p.tickIncrement(ve[0].p,C.size,!1,A)-ve[0].p),e(ve,c),d.isArrayOrTypedArray(c.selectedpoints)&&d.tagSelected(ve,c,se),ve},calcAllAutoBins:o}},{"../../lib":787,"../../plots/cartesian/axes":838,"../../registry":915,"../bar/arrays_to_calcdata":924,"./average":1089,"./bin_functions":1091,"./bin_label_vals":1092,"./norm_functions":1100,"fast-isnumeric":246}],1094:[function(r,O,B){O.exports={eventDataKeys:["binNumber"]}},{}],1095:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/cartesian/axis_ids"),m=r("../../registry").traceIs,p=r("../bar/defaults").handleGroupingDefaults,e=t.nestedProperty,f=r("../../plots/cartesian/constraints").getAxisGroup,u=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],s=["x","y"];O.exports=function(l,o){var i,c,n,a,g,h,y,v=o._histogramBinOpts={},_=[],x={},T=[];function A(H,Y){return t.coerce(i._input,i,i._module.attributes,H,Y)}function S(H){return H.orientation==="v"?"x":"y"}function w(H,Y,$){var z=H.uid+"__"+$;Y||(Y=z);var j=function(Q,te){return d.getFromTrace({_fullLayout:o},Q,te).type}(H,$),W=H[$+"calendar"]||"",ee=v[Y],J=!0;ee&&(j===ee.axType&&W===ee.calendar?(J=!1,ee.traces.push(H),ee.dirs.push($)):(Y=z,j!==ee.axType&&t.warn(["Attempted to group the bins of trace",H.index,"set on a","type:"+j,"axis","with bins on","type:"+ee.axType,"axis."].join(" ")),W!==ee.calendar&&t.warn(["Attempted to group the bins of trace",H.index,"set with a",W,"calendar","with bins",ee.calendar?"on a "+ee.calendar+" calendar":"w/o a set calendar"].join(" ")))),J&&(v[Y]={traces:[H],dirs:[$],axType:j,calendar:H[$+"calendar"]||""}),H["_"+$+"bingroup"]=Y}for(g=0;g<l.length;g++)i=l[g],m(i,"histogram")&&(_.push(i),delete i._xautoBinFinished,delete i._yautoBinFinished,m(i,"2dMap")||p(i._input,i,o,A));var C=o._alignmentOpts||{};for(g=0;g<_.length;g++){if(i=_[g],n="",!m(i,"2dMap")){if(a=S(i),o.barmode==="group"&&i.alignmentgroup){var k=i[a+"axis"],L=f(o,k)+i.orientation;(C[L]||{})[i.alignmentgroup]&&(n=L)}n||o.barmode==="overlay"||(n=f(o,i.xaxis)+f(o,i.yaxis)+S(i))}n?(x[n]||(x[n]=[]),x[n].push(i)):T.push(i)}for(n in x)if((c=x[n]).length!==1){var M=!1;for(c.length&&(i=c[0],M=A("bingroup")),n=M||n,g=0;g<c.length;g++){var P=(i=c[g])._input.bingroup;P&&P!==n&&t.warn(["Trace",i.index,"must match","within bingroup",n+".","Ignoring its bingroup:",P,"setting."].join(" ")),i.bingroup=n,w(i,n,S(i))}}else T.push(c[0]);for(g=0;g<T.length;g++){i=T[g];var D=A("bingroup");if(m(i,"2dMap"))for(y=0;y<2;y++){var N=A((a=s[y])+"bingroup",D?D+"__"+a:null);w(i,N,a)}else w(i,D,S(i))}for(n in v){var U=v[n];for(c=U.traces,h=0;h<u.length;h++){var q,X,K=u[h],Z=K.name;if(Z!=="nbins"||!U.sizeFound){for(g=0;g<c.length;g++){if(i=c[g],a=U.dirs[g],q=K.aStr[a],e(i._input,q).get()!==void 0){U[Z]=A(q),U[Z+"Found"]=!0;break}(X=(i._autoBin||{})[a]||{})[Z]&&e(i,q).set(X[Z])}if(Z==="start"||Z==="end")for(;g<c.length;g++)(i=c[g])["_"+a+"bingroup"]&&A(q,(X=(i._autoBin||{})[a]||{})[Z]);Z!=="nbins"||U.sizeFound||U.nbinsFound||(i=c[0],U[Z]=A(q))}}}}},{"../../lib":787,"../../plots/cartesian/axis_ids":842,"../../plots/cartesian/constraints":846,"../../registry":915,"../bar/defaults":929}],1096:[function(r,O,B){var t=r("../../registry"),d=r("../../lib"),m=r("../../components/color"),p=r("../bar/style_defaults"),e=r("./attributes");O.exports=function(f,u,s,l){function o(_,x){return d.coerce(f,u,e,_,x)}var i=o("x"),c=o("y");o("cumulative.enabled")&&(o("cumulative.direction"),o("cumulative.currentbin")),o("text"),o("hovertext"),o("hovertemplate"),o("xhoverformat"),o("yhoverformat");var n=o("orientation",c&&!i?"h":"v"),a=n==="v"?"x":"y",g=n==="v"?"y":"x",h=i&&c?Math.min(d.minRowLength(i)&&d.minRowLength(c)):d.minRowLength(u[a]||[]);if(h){u._length=h,t.getComponentMethod("calendars","handleTraceDefaults")(f,u,["x","y"],l),u[g]&&o("histfunc"),o("histnorm"),o("autobin"+a),p(f,u,o,s,l),d.coerceSelectionMarkerOpacity(u,o);var y=(u.marker.line||{}).color,v=t.getComponentMethod("errorbars","supplyDefaults");v(f,u,y||m.defaultLine,{axis:"y"}),v(f,u,y||m.defaultLine,{axis:"x",inherit:"y"})}else u.visible=!1}},{"../../components/color":650,"../../lib":787,"../../registry":915,"../bar/style_defaults":940,"./attributes":1088}],1097:[function(r,O,B){O.exports=function(t,d,m,p,e){if(t.x="xVal"in d?d.xVal:d.x,t.y="yVal"in d?d.yVal:d.y,"zLabelVal"in d&&(t.z=d.zLabelVal),d.xa&&(t.xaxis=d.xa),d.ya&&(t.yaxis=d.ya),!(m.cumulative||{}).enabled){var f,u=Array.isArray(e)?p[0].pts[e[0]][e[1]]:p[e].pts;if(t.pointNumbers=u,t.binNumber=t.pointNumber,delete t.pointNumber,delete t.pointIndex,m._indexToPoints){f=[];for(var s=0;s<u.length;s++)f=f.concat(m._indexToPoints[u[s]])}else f=u;t.pointIndices=f}return t}},{}],1098:[function(r,O,B){var t=r("../bar/hover").hoverPoints,d=r("../../plots/cartesian/axes").hoverLabelText;O.exports=function(m,p,e,f,u){var s=t(m,p,e,f,u);if(s){var l=(m=s[0]).cd[m.index],o=m.cd[0].trace;if(!o.cumulative.enabled){var i=o.orientation==="h"?"y":"x";m[i+"Label"]=d(m[i+"a"],[l.ph0,l.ph1],o[i+"hoverformat"])}return s}}},{"../../plots/cartesian/axes":838,"../bar/hover":932}],1099:[function(r,O,B){O.exports={attributes:r("./attributes"),layoutAttributes:r("../bar/layout_attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("./cross_trace_defaults"),supplyLayoutDefaults:r("../bar/layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("../bar/cross_trace_calc").crossTraceCalc,plot:r("../bar/plot").plot,layerName:"barlayer",style:r("../bar/style").style,styleOnSelect:r("../bar/style").styleOnSelect,colorbar:r("../scatter/marker_colorbar"),hoverPoints:r("./hover"),selectPoints:r("../bar/select"),eventData:r("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:r("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":852,"../bar/cross_trace_calc":928,"../bar/layout_attributes":934,"../bar/layout_defaults":935,"../bar/plot":936,"../bar/select":937,"../bar/style":939,"../scatter/marker_colorbar":1220,"./attributes":1088,"./calc":1093,"./cross_trace_defaults":1095,"./defaults":1096,"./event_data":1097,"./hover":1098}],1100:[function(r,O,B){O.exports={percent:function(t,d){for(var m=t.length,p=100/d,e=0;e<m;e++)t[e]*=p},probability:function(t,d){for(var m=t.length,p=0;p<m;p++)t[p]/=d},density:function(t,d,m,p){var e=t.length;p=p||1;for(var f=0;f<e;f++)t[f]*=m[f]*p},"probability density":function(t,d,m,p){var e=t.length;p&&(d/=p);for(var f=0;f<e;f++)t[f]*=m[f]/d}}},{}],1101:[function(r,O,B){var t=r("../histogram/attributes"),d=r("../histogram/bin_attributes"),m=r("../heatmap/attributes"),p=r("../../plots/attributes"),e=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,f=r("../../plots/template_attributes").hovertemplateAttrs,u=r("../../components/colorscale/attributes"),s=r("../../lib/extend").extendFlat;O.exports=s({x:t.x,y:t.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:t.histnorm,histfunc:t.histfunc,nbinsx:t.nbinsx,xbins:d("x"),nbinsy:t.nbinsy,ybins:d("y"),autobinx:t.autobinx,autobiny:t.autobiny,bingroup:s({},t.bingroup,{}),xbingroup:s({},t.bingroup,{}),ybingroup:s({},t.bingroup,{}),xgap:m.xgap,ygap:m.ygap,zsmooth:m.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:f({},{keys:"z"}),showlegend:s({},p.showlegend,{dflt:!1})},u("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../heatmap/attributes":1069,"../histogram/attributes":1088,"../histogram/bin_attributes":1090}],1102:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("../histogram/bin_functions"),p=r("../histogram/norm_functions"),e=r("../histogram/average"),f=r("../histogram/bin_label_vals"),u=r("../histogram/calc").calcAllAutoBins;function s(i,c,n,a){var g,h=new Array(i);if(a)for(g=0;g<i;g++)h[g]=1/(c[g+1]-c[g]);else{var y=1/n;for(g=0;g<i;g++)h[g]=y}return h}function l(i,c){return{start:i(c.start),end:i(c.end),size:c.size}}function o(i,c,n,a,g,h){var y,v=i.length-1,_=new Array(v),x=f(n,a,i,g,h);for(y=0;y<v;y++){var T=(c||[])[y];_[y]=T===void 0?[x(i[y]),x(i[y+1],!0)]:[T,T]}return _}O.exports=function(i,c){var n,a,g,h,y=d.getFromId(i,c.xaxis),v=d.getFromId(i,c.yaxis),_=c.xcalendar,x=c.ycalendar,T=function(at){return y.r2c(at,0,_)},A=function(at){return v.r2c(at,0,x)},S=u(i,c,y,"x"),w=S[0],C=S[1],k=u(i,c,v,"y"),L=k[0],M=k[1],P=c._length;C.length>P&&C.splice(P,C.length-P),M.length>P&&M.splice(P,M.length-P);var D=[],N=[],U=[],q=typeof w.size=="string",X=typeof L.size=="string",K=[],Z=[],H=q?K:w,Y=X?Z:L,$=0,z=[],j=[],W=c.histnorm,ee=c.histfunc,J=W.indexOf("density")!==-1,Q=ee==="max"||ee==="min"?null:0,te=m.count,ie=p[W],ae=!1,he=[],se=[],de="z"in c?c.z:"marker"in c&&Array.isArray(c.marker.color)?c.marker.color:"";de&&ee!=="count"&&(ae=ee==="avg",te=m[ee]);var ue=w.size,ve=T(w.start),ke=T(w.end)+(ve-d.tickIncrement(ve,ue,!1,_))/1e6;for(n=ve;n<ke;n=d.tickIncrement(n,ue,!1,_))N.push(Q),K.push(n),ae&&U.push(0);K.push(n);var Ee,be=N.length,xe=(n-ve)/be,ce=(Ee=ve+xe/2,y.c2r(Ee,0,_)),ge=L.size,we=A(L.start),Me=A(L.end)+(we-d.tickIncrement(we,ge,!1,x))/1e6;for(n=we;n<Me;n=d.tickIncrement(n,ge,!1,x)){D.push(N.slice()),Z.push(n);var Se=new Array(be);for(a=0;a<be;a++)Se[a]=[];j.push(Se),ae&&z.push(U.slice())}Z.push(n);var ze=D.length,Fe=(n-we)/ze,Ye=function(at){return v.c2r(at,0,x)}(we+Fe/2);J&&(he=s(N.length,H,xe,q),se=s(D.length,Y,Fe,X)),q||y.type!=="date"||(H=l(T,H)),X||v.type!=="date"||(Y=l(A,Y));var rt=!0,Oe=!0,je=new Array(be),We=new Array(ze),qe=1/0,Qe=1/0,st=1/0,ct=1/0;for(n=0;n<P;n++){var Pt=C[n],kt=M[n];g=t.findBin(Pt,H),h=t.findBin(kt,Y),g>=0&&g<be&&h>=0&&h<ze&&($+=te(g,n,D[h],de,z[h]),j[h][g].push(n),rt&&(je[g]===void 0?je[g]=Pt:je[g]!==Pt&&(rt=!1)),Oe&&(We[h]===void 0?We[h]=kt:We[h]!==kt&&(Oe=!1)),qe=Math.min(qe,Pt-K[g]),Qe=Math.min(Qe,K[g+1]-Pt),st=Math.min(st,kt-Z[h]),ct=Math.min(ct,Z[h+1]-kt))}if(ae)for(h=0;h<ze;h++)$+=e(D[h],z[h]);if(ie)for(h=0;h<ze;h++)ie(D[h],$,he,se[h]);return{x:C,xRanges:o(K,rt&&je,qe,Qe,y,_),x0:ce,dx:xe,y:M,yRanges:o(Z,Oe&&We,st,ct,v,x),y0:Ye,dy:Fe,z:D,pts:j}}},{"../../lib":787,"../../plots/cartesian/axes":838,"../histogram/average":1089,"../histogram/bin_functions":1091,"../histogram/bin_label_vals":1092,"../histogram/calc":1093,"../histogram/norm_functions":1100}],1103:[function(r,O,B){var t=r("../../lib"),d=r("./sample_defaults"),m=r("../heatmap/style_defaults"),p=r("../../components/colorscale/defaults"),e=r("./attributes");O.exports=function(f,u,s,l){function o(i,c){return t.coerce(f,u,e,i,c)}d(f,u,o,l),u.visible!==!1&&(m(f,u,o,l),p(f,u,l,o,{prefix:"",cLetter:"z"}),o("hovertemplate"),o("xhoverformat"),o("yhoverformat"))}},{"../../components/colorscale/defaults":660,"../../lib":787,"../heatmap/style_defaults":1082,"./attributes":1101,"./sample_defaults":1106}],1104:[function(r,O,B){var t=r("../heatmap/hover"),d=r("../../plots/cartesian/axes").hoverLabelText;O.exports=function(m,p,e,f,u){var s=t(m,p,e,f,u);if(s){var l=(m=s[0]).index,o=l[0],i=l[1],c=m.cd[0],n=c.trace,a=c.xRanges[i],g=c.yRanges[o];return m.xLabel=d(m.xa,[a[0],a[1]],n.xhoverformat),m.yLabel=d(m.ya,[g[0],g[1]],n.yhoverformat),s}}},{"../../plots/cartesian/axes":838,"../heatmap/hover":1076}],1105:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("../histogram/cross_trace_defaults"),calc:r("../heatmap/calc"),plot:r("../heatmap/plot"),layerName:"heatmaplayer",colorbar:r("../heatmap/colorbar"),style:r("../heatmap/style"),hoverPoints:r("./hover"),eventData:r("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":852,"../heatmap/calc":1070,"../heatmap/colorbar":1072,"../heatmap/plot":1080,"../heatmap/style":1081,"../histogram/cross_trace_defaults":1095,"../histogram/event_data":1097,"./attributes":1101,"./defaults":1103,"./hover":1104}],1106:[function(r,O,B){var t=r("../../registry"),d=r("../../lib");O.exports=function(m,p,e,f){var u=e("x"),s=e("y"),l=d.minRowLength(u),o=d.minRowLength(s);l&&o?(p._length=Math.min(l,o),t.getComponentMethod("calendars","handleTraceDefaults")(m,p,["x","y"],f),(e("z")||e("marker.color"))&&e("histfunc"),e("histnorm"),e("autobinx"),e("autobiny")):p.visible=!1}},{"../../lib":787,"../../registry":915}],1107:[function(r,O,B){var t=r("../histogram2d/attributes"),d=r("../contour/attributes"),m=r("../../components/colorscale/attributes"),p=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=r("../../lib/extend").extendFlat;O.exports=e({x:t.x,y:t.y,z:t.z,marker:t.marker,histnorm:t.histnorm,histfunc:t.histfunc,nbinsx:t.nbinsx,xbins:t.xbins,nbinsy:t.nbinsy,ybins:t.ybins,autobinx:t.autobinx,autobiny:t.autobiny,bingroup:t.bingroup,xbingroup:t.xbingroup,ybingroup:t.ybingroup,autocontour:d.autocontour,ncontours:d.ncontours,contours:d.contours,line:{color:d.line.color,width:e({},d.line.width,{dflt:.5}),dash:d.line.dash,smoothing:d.line.smoothing,editType:"plot"},xhoverformat:p("x"),yhoverformat:p("y"),zhoverformat:p("z",1),hovertemplate:t.hovertemplate},m("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../contour/attributes":1012,"../histogram2d/attributes":1101}],1108:[function(r,O,B){var t=r("../../lib"),d=r("../histogram2d/sample_defaults"),m=r("../contour/contours_defaults"),p=r("../contour/style_defaults"),e=r("./attributes");O.exports=function(f,u,s,l){function o(i,c){return t.coerce(f,u,e,i,c)}d(f,u,o,l),u.visible!==!1&&(m(f,u,o,function(i){return t.coerce2(f,u,e,i)}),p(f,u,o,l),o("hovertemplate"),o("xhoverformat"),o("yhoverformat"))}},{"../../lib":787,"../contour/contours_defaults":1019,"../contour/style_defaults":1033,"../histogram2d/sample_defaults":1106,"./attributes":1107}],1109:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("../histogram/cross_trace_defaults"),calc:r("../contour/calc"),plot:r("../contour/plot").plot,layerName:"contourlayer",style:r("../contour/style"),colorbar:r("../contour/colorbar"),hoverPoints:r("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":852,"../contour/calc":1013,"../contour/colorbar":1015,"../contour/hover":1025,"../contour/plot":1030,"../contour/style":1032,"../histogram/cross_trace_defaults":1095,"./attributes":1107,"./defaults":1108}],1110:[function(r,O,B){var t=r("../../plots/template_attributes").hovertemplateAttrs,d=r("../../plots/template_attributes").texttemplateAttrs,m=r("../../components/colorscale/attributes"),p=r("../../plots/domain").attributes,e=r("../pie/attributes"),f=r("../sunburst/attributes"),u=r("../treemap/attributes"),s=r("../treemap/constants"),l=r("../../lib/extend").extendFlat;O.exports={labels:f.labels,parents:f.parents,values:f.values,branchvalues:f.branchvalues,count:f.count,level:f.level,maxdepth:f.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:u.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:l({colors:f.marker.colors,line:f.marker.line,editType:"calc"},m("marker",{colorAttr:"colors",anim:!1})),leaf:f.leaf,pathbar:u.pathbar,text:e.text,textinfo:f.textinfo,texttemplate:d({editType:"plot"},{keys:s.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:f.hoverinfo,hovertemplate:t({},{keys:s.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:u.outsidetextfont,textposition:u.textposition,sort:e.sort,root:f.root,domain:p({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/domain":866,"../../plots/template_attributes":910,"../pie/attributes":1176,"../sunburst/attributes":1314,"../treemap/attributes":1340,"../treemap/constants":1343}],1111:[function(r,O,B){var t=r("../../plots/plots");B.name="icicle",B.plot=function(d,m,p,e){t.plotBasePlot(B.name,d,m,p,e)},B.clean=function(d,m,p,e){t.cleanBasePlot(B.name,d,m,p,e)}},{"../../plots/plots":901}],1112:[function(r,O,B){var t=r("../sunburst/calc");B.calc=function(d,m){return t.calc(d,m)},B.crossTraceCalc=function(d){return t._runCrossTraceCalc("icicle",d)}},{"../sunburst/calc":1316}],1113:[function(r,O,B){var t=r("../../lib"),d=r("./attributes"),m=r("../../components/color"),p=r("../../plots/domain").defaults,e=r("../bar/defaults").handleText,f=r("../bar/constants").TEXTPAD,u=r("../../components/colorscale"),s=u.hasColorscale,l=u.handleDefaults;O.exports=function(o,i,c,n){function a(T,A){return t.coerce(o,i,d,T,A)}var g=a("labels"),h=a("parents");if(g&&g.length&&h&&h.length){var y=a("values");y&&y.length?a("branchvalues"):a("count"),a("level"),a("maxdepth"),a("tiling.orientation"),a("tiling.flip"),a("tiling.pad");var v=a("text");a("texttemplate"),i.texttemplate||a("textinfo",Array.isArray(v)?"text+label":"label"),a("hovertext"),a("hovertemplate");var _=a("pathbar.visible");e(o,i,n,a,"auto",{hasPathbar:_,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),a("textposition"),a("marker.line.width")&&a("marker.line.color",n.paper_bgcolor),a("marker.colors");var x=i._hasColorscale=s(o,"marker","colors")||(o.marker||{}).coloraxis;x&&l(o,i,n,a,{prefix:"marker.",cLetter:"c"}),a("leaf.opacity",x?1:.7),i._hovered={marker:{line:{width:2,color:m.contrast(n.paper_bgcolor)}}},_&&(a("pathbar.thickness",i.pathbar.textfont.size+2*f),a("pathbar.side"),a("pathbar.edgeshape")),a("sort"),a("root.color"),p(i,n,a),i._length=null}else i.visible=!1}},{"../../components/color":650,"../../components/colorscale":662,"../../lib":787,"../../plots/domain":866,"../bar/constants":927,"../bar/defaults":929,"./attributes":1110}],1114:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../components/drawing"),p=r("../../lib/svg_text_utils"),e=r("./partition"),f=r("./style").styleOne,u=r("../treemap/constants"),s=r("../sunburst/helpers"),l=r("../sunburst/fx"),o=r("../sunburst/plot").formatSliceLabel;O.exports=function(i,c,n,a,g){var h=g.width,y=g.height,v=g.viewX,_=g.viewY,x=g.pathSlice,T=g.toMoveInsideSlice,A=g.strTransform,S=g.hasTransition,w=g.handleSlicesExit,C=g.makeUpdateSliceInterpolator,k=g.makeUpdateTextInterpolator,L=g.prevEntry,M=i._fullLayout,P=c[0].trace,D=P.textposition.indexOf("left")!==-1,N=P.textposition.indexOf("right")!==-1,U=P.textposition.indexOf("bottom")!==-1,q=e(n,[h,y],{flipX:P.tiling.flip.indexOf("x")>-1,flipY:P.tiling.flip.indexOf("y")>-1,orientation:P.tiling.orientation,pad:{inner:P.tiling.pad},maxDepth:P._maxDepth}).descendants(),X=1/0,K=-1/0;q.forEach(function(z){var j=z.depth;j>=P._maxDepth?(z.x0=z.x1=(z.x0+z.x1)/2,z.y0=z.y1=(z.y0+z.y1)/2):(X=Math.min(X,j),K=Math.max(K,j))}),a=a.data(q,s.getPtId),P._maxVisibleLayers=isFinite(K)?K-X+1:0,a.enter().append("g").classed("slice",!0),w(a,!1,{},[h,y],x),a.order();var Z=null;if(S&&L){var H=s.getPtId(L);a.each(function(z){Z===null&&s.getPtId(z)===H&&(Z={x0:z.x0,x1:z.x1,y0:z.y0,y1:z.y1})})}var Y=function(){return Z||{x0:0,x1:h,y0:0,y1:y}},$=a;return S&&($=$.transition().each("end",function(){var z=t.select(this);s.setSliceCursor(z,i,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),$.each(function(z){z._x0=v(z.x0),z._x1=v(z.x1),z._y0=_(z.y0),z._y1=_(z.y1),z._hoverX=v(z.x1-P.tiling.pad),z._hoverY=_(U?z.y1-P.tiling.pad/2:z.y0+P.tiling.pad/2);var j=t.select(this),W=d.ensureSingle(j,"path","surface",function(te){te.style("pointer-events","all")});S?W.transition().attrTween("d",function(te){var ie=C(te,!1,Y(),[h,y],{orientation:P.tiling.orientation,flipX:P.tiling.flip.indexOf("x")>-1,flipY:P.tiling.flip.indexOf("y")>-1});return function(ae){return x(ie(ae))}}):W.attr("d",x),j.call(l,n,i,c,{styleOne:f,eventDataKeys:u.eventDataKeys,transitionTime:u.CLICK_TRANSITION_TIME,transitionEasing:u.CLICK_TRANSITION_EASING}).call(s.setSliceCursor,i,{isTransitioning:i._transitioning}),W.call(f,z,P,{hovered:!1}),z.x0===z.x1||z.y0===z.y1?z._text="":z._text=o(z,n,P,c,M)||"";var ee=d.ensureSingle(j,"g","slicetext"),J=d.ensureSingle(ee,"text","",function(te){te.attr("data-notex",1)}),Q=d.ensureUniformFontSize(i,s.determineTextFont(P,z,M.font));J.text(z._text||" ").classed("slicetext",!0).attr("text-anchor",N?"end":D?"start":"middle").call(m.font,Q).call(p.convertToTspans,i),z.textBB=m.bBox(J.node()),z.transform=T(z,{fontSize:Q.size}),z.transform.fontSize=Q.size,S?J.transition().attrTween("transform",function(te){var ie=k(te,!1,Y(),[h,y]);return function(ae){return A(ie(ae))}}):J.attr("transform",A(z))}),Z}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../sunburst/fx":1319,"../sunburst/helpers":1320,"../sunburst/plot":1324,"../treemap/constants":1343,"./partition":1118,"./style":1120,"@plotly/d3":58}],1115:[function(r,O,B){O.exports={moduleType:"trace",name:"icicle",basePlotModule:r("./base_plot"),categories:[],animatable:!0,attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot"),style:r("./style").style,colorbar:r("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1220,"./attributes":1110,"./base_plot":1111,"./calc":1112,"./defaults":1113,"./layout_attributes":1116,"./layout_defaults":1117,"./plot":1119,"./style":1120}],1116:[function(r,O,B){O.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1117:[function(r,O,B){var t=r("../../lib"),d=r("./layout_attributes");O.exports=function(m,p){function e(f,u){return t.coerce(m,p,d,f,u)}e("iciclecolorway",p.colorway),e("extendiciclecolors")}},{"../../lib":787,"./layout_attributes":1116}],1118:[function(r,O,B){var t=r("d3-hierarchy"),d=r("../treemap/flip_tree");O.exports=function(m,p,e){var f=e.flipX,u=e.flipY,s=e.orientation==="h",l=e.maxDepth,o=p[0],i=p[1];l&&(o=(m.height+1)*p[0]/Math.min(m.height+1,l),i=(m.height+1)*p[1]/Math.min(m.height+1,l));var c=t.partition().padding(e.pad.inner).size(s?[p[1],o]:[p[0],i])(m);return(s||f||u)&&d(c,p,{swapXY:s,flipX:f,flipY:u}),c}},{"../treemap/flip_tree":1348,"d3-hierarchy":167}],1119:[function(r,O,B){var t=r("../treemap/draw"),d=r("./draw_descendants");O.exports=function(m,p,e,f){return t(m,p,e,f,{type:"icicle",drawDescendants:d})}},{"../treemap/draw":1345,"./draw_descendants":1114}],1120:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/color"),m=r("../../lib"),p=r("../bar/uniform_text").resizeText;function e(f,u,s){var l=u.data.data,o=!u.children,i=l.i,c=m.castOption(s,i,"marker.line.color")||d.defaultLine,n=m.castOption(s,i,"marker.line.width")||0;f.style("stroke-width",n).call(d.fill,l.color).call(d.stroke,c).style("opacity",o?s.leaf.opacity:null)}O.exports={style:function(f){var u=f._fullLayout._iciclelayer.selectAll(".trace");p(f,u,"icicle"),u.each(function(s){var l=t.select(this),o=s[0].trace;l.style("opacity",o.opacity),l.selectAll("path.surface").each(function(i){t.select(this).call(e,i,o)})})},styleOne:e}},{"../../components/color":650,"../../lib":787,"../bar/uniform_text":941,"@plotly/d3":58}],1121:[function(r,O,B){for(var t=r("../../plots/attributes"),d=r("../../plots/template_attributes").hovertemplateAttrs,m=r("../../lib/extend").extendFlat,p=r("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],f=[],u=[],s=0;s<e.length;s++){var l=p[e[s]];f.push("For the `"+e[s]+"` colormodel, it is ["+(l.zminDflt||l.min).join(", ")+"]."),u.push("For the `"+e[s]+"` colormodel, it is ["+(l.zmaxDflt||l.max).join(", ")+"].")}O.exports=m({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:m({},t.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:d({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"./constants":1123}],1122:[function(r,O,B){var t=r("../../lib"),d=r("./constants"),m=r("fast-isnumeric"),p=r("../../plots/cartesian/axes"),e=r("../../lib").maxRowLength,f=r("./helpers").getImageSize;function u(l,o,i,c){return function(n){return t.constrain((n-l)*o,i,c)}}function s(l,o){return function(i){return t.constrain(i,l,o)}}O.exports=function(l,o){var i,c;if(o._hasZ)i=o.z.length,c=e(o.z);else if(o._hasSource){var n=f(o.source);i=n.height,c=n.width}var a,g=p.getFromId(l,o.xaxis||"x"),h=p.getFromId(l,o.yaxis||"y"),y=g.d2c(o.x0)-o.dx/2,v=h.d2c(o.y0)-o.dy/2,_=[y,y+c*o.dx],x=[v,v+i*o.dy];if(g&&g.type==="log")for(a=0;a<c;a++)_.push(y+a*o.dx);if(h&&h.type==="log")for(a=0;a<i;a++)x.push(v+a*o.dy);return o._extremes[g._id]=p.findExtremes(g,_),o._extremes[h._id]=p.findExtremes(h,x),o._scaler=function(T){var A=d.colormodel[T.colormodel],S=(A.colormodel||T.colormodel).length;T._sArray=[];for(var w=0;w<S;w++)A.min[w]!==T.zmin[w]||A.max[w]!==T.zmax[w]?T._sArray.push(u(T.zmin[w],(A.max[w]-A.min[w])/(T.zmax[w]-T.zmin[w]),A.min[w],A.max[w])):T._sArray.push(s(A.min[w],A.max[w]));return function(C){for(var k=C.slice(0,S),L=0;L<S;L++){var M=k[L];if(!m(M))return!1;k[L]=T._sArray[L](M)}return k}}(o),[{x0:y,y0:v,z:o.z,w:c,h:i}]}},{"../../lib":787,"../../plots/cartesian/axes":838,"./constants":1123,"./helpers":1126,"fast-isnumeric":246}],1123:[function(r,O,B){O.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(t){return t.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(t){return t.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(t){return t.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(t){var d=t.slice(0,3);return d[1]=d[1]+"%",d[2]=d[2]+"%",d},suffix:["\xB0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(t){var d=t.slice(0,4);return d[1]=d[1]+"%",d[2]=d[2]+"%",d},suffix:["\xB0","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],1124:[function(r,O,B){var t=r("../../lib"),d=r("./attributes"),m=r("./constants"),p=r("../../snapshot/helpers").IMAGE_URL_PREFIX;O.exports=function(e,f){function u(o,i){return t.coerce(e,f,d,o,i)}u("source"),f.source&&!f.source.match(p)&&delete f.source,f._hasSource=!!f.source;var s,l=u("z");f._hasZ=!(l===void 0||!l.length||!l[0]||!l[0].length),f._hasZ||f._hasSource?(u("x0"),u("y0"),u("dx"),u("dy"),f._hasZ?(u("colormodel","rgb"),u("zmin",(s=m.colormodel[f.colormodel]).zminDflt||s.min),u("zmax",s.zmaxDflt||s.max)):f._hasSource&&(f.colormodel="rgba256",s=m.colormodel[f.colormodel],f.zmin=s.zminDflt,f.zmax=s.zmaxDflt),u("zsmooth"),u("text"),u("hovertext"),u("hovertemplate"),f._length=null):f.visible=!1}},{"../../lib":787,"../../snapshot/helpers":919,"./attributes":1121,"./constants":1123}],1125:[function(r,O,B){O.exports=function(t,d){return"xVal"in d&&(t.x=d.xVal),"yVal"in d&&(t.y=d.yVal),d.xa&&(t.xaxis=d.xa),d.ya&&(t.yaxis=d.ya),t.color=d.color,t.colormodel=d.trace.colormodel,t.z||(t.z=d.color),t}},{}],1126:[function(r,O,B){var t=r("probe-image-size/sync"),d=r("../../snapshot/helpers").IMAGE_URL_PREFIX,m=r("buffer/").Buffer;B.getImageSize=function(p){var e=p.replace(d,""),f=new m(e,"base64");return t(f)}},{"../../snapshot/helpers":919,"buffer/":117,"probe-image-size/sync":513}],1127:[function(r,O,B){var t=r("../../components/fx"),d=r("../../lib"),m=r("./constants");O.exports=function(p,e,f){var u=p.cd[0],s=u.trace,l=p.xa,o=p.ya;if(!(t.inbox(e-u.x0,e-(u.x0+u.w*s.dx),0)>0||t.inbox(f-u.y0,f-(u.y0+u.h*s.dy),0)>0)){var i,c=Math.floor((e-u.x0)/s.dx),n=Math.floor(Math.abs(f-u.y0)/s.dy);if(s._hasZ?i=u.z[n][c]:s._hasSource&&(i=s._canvas.el.getContext("2d").getImageData(c,n,1,1).data),i){var a,g=u.hi||s.hoverinfo;if(g){var h=g.split("+");h.indexOf("all")!==-1&&(h=["color"]),h.indexOf("color")!==-1&&(a=!0)}var y,v=m.colormodel[s.colormodel],_=v.colormodel||s.colormodel,x=_.length,T=s._scaler(i),A=v.suffix,S=[];(s.hovertemplate||a)&&(S.push("["+[T[0]+A[0],T[1]+A[1],T[2]+A[2]].join(", ")),x===4&&S.push(", "+T[3]+A[3]),S.push("]"),S=S.join(""),p.extraText=_.toUpperCase()+": "+S),Array.isArray(s.hovertext)&&Array.isArray(s.hovertext[n])?y=s.hovertext[n][c]:Array.isArray(s.text)&&Array.isArray(s.text[n])&&(y=s.text[n][c]);var w=o.c2p(u.y0+(n+.5)*s.dy),C=u.x0+(c+.5)*s.dx,k=u.y0+(n+.5)*s.dy,L="["+i.slice(0,s.colormodel.length).join(", ")+"]";return[d.extendFlat(p,{index:[n,c],x0:l.c2p(u.x0+c*s.dx),x1:l.c2p(u.x0+(c+1)*s.dx),y0:w,y1:w,color:T,xVal:C,xLabelVal:C,yVal:k,yLabelVal:k,zLabelVal:L,text:y,hovertemplateLabels:{zLabel:L,colorLabel:S,"color[0]Label":T[0]+A[0],"color[1]Label":T[1]+A[1],"color[2]Label":T[2]+A[2],"color[3]Label":T[3]+A[3]}})]}}}},{"../../components/fx":690,"../../lib":787,"./constants":1123}],1128:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),style:r("./style"),hoverPoints:r("./hover"),eventData:r("./event_data"),moduleType:"trace",name:"image",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":852,"./attributes":1121,"./calc":1122,"./defaults":1124,"./event_data":1125,"./hover":1127,"./plot":1129,"./style":1130}],1129:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=d.strTranslate,p=r("../../constants/xmlns_namespaces"),e=r("./constants"),f=d.isIOS()||d.isSafari()||d.isIE();O.exports=function(u,s,l,o){var i=s.xaxis,c=s.yaxis,n=!(f||u._context._exportedPlot);d.makeTraceGroups(o,l,"im").each(function(a){var g=t.select(this),h=a[0],y=h.trace,v=(y.zsmooth==="fast"||y.zsmooth===!1&&n)&&!y._hasZ&&y._hasSource&&i.type==="linear"&&c.type==="linear";y._realImage=v;var _,x,T,A,S,w,C=h.z,k=h.x0,L=h.y0,M=h.w,P=h.h,D=y.dx,N=y.dy;for(w=0;_===void 0&&w<M;)_=i.c2p(k+w*D),w++;for(w=M;x===void 0&&w>0;)x=i.c2p(k+w*D),w--;for(w=0;A===void 0&&w<P;)A=c.c2p(L+w*N),w++;for(w=P;S===void 0&&w>0;)S=c.c2p(L+w*N),w--;x<_&&(T=x,x=_,_=T),S<A&&(T=A,A=S,S=T),!v&&(_=Math.max(-.5*i._length,_),x=Math.min(1.5*i._length,x),A=Math.max(-.5*c._length,A),S=Math.min(1.5*c._length,S));var U=Math.round(x-_),q=Math.round(S-A);if(U<=0||q<=0)g.selectAll("image").data([]).exit().remove();else{var X=g.selectAll("image").data([a]);X.enter().append("svg:image").attr({xmlns:p.svg,preserveAspectRatio:"none"}),X.exit().remove();var K=y.zsmooth===!1?e.pixelatedStyle:"";if(v){var Z=d.simpleMap(i.range,i.r2l),H=d.simpleMap(c.range,c.r2l),Y=Z[1]<Z[0],$=H[1]>H[0];if(Y||$){var z=_+U/2,j=A+q/2;K+="transform:"+m(z+"px",j+"px")+"scale("+(Y?-1:1)+","+($?-1:1)+")"+m(-z+"px",-j+"px")+";"}}X.attr("style",K);var W=new Promise(function(J){if(y._hasZ)J();else if(y._hasSource)if(y._canvas&&y._canvas.el.width===M&&y._canvas.el.height===P&&y._canvas.source===y.source)J();else{var Q=document.createElement("canvas");Q.width=M,Q.height=P;var te=Q.getContext("2d");y._image=y._image||new Image;var ie=y._image;ie.onload=function(){te.drawImage(ie,0,0),y._canvas={el:Q,source:y.source},J()},ie.setAttribute("src",y.source)}}).then(function(){var J;if(y._hasZ)J=ee(function(te,ie){return C[ie][te]}).toDataURL("image/png");else if(y._hasSource)if(v)J=y.source;else{var Q=y._canvas.el.getContext("2d").getImageData(0,0,M,P).data;J=ee(function(te,ie){var ae=4*(ie*M+te);return[Q[ae],Q[ae+1],Q[ae+2],Q[ae+3]]}).toDataURL("image/png")}X.attr({"xlink:href":J,height:q,width:U,x:_,y:A})});u._promises.push(W)}function ee(J){var Q=document.createElement("canvas");Q.width=U,Q.height=q;var te,ie=Q.getContext("2d"),ae=function(ce){return d.constrain(Math.round(i.c2p(k+ce*D)-_),0,U)},he=function(ce){return d.constrain(Math.round(c.c2p(L+ce*N)-A),0,q)},se=e.colormodel[y.colormodel],de=se.colormodel||y.colormodel,ue=se.fmt;for(w=0;w<h.w;w++){var ve=ae(w),ke=ae(w+1);if(ke!==ve&&!isNaN(ke)&&!isNaN(ve))for(var Ee=0;Ee<h.h;Ee++){var be=he(Ee),xe=he(Ee+1);xe===be||isNaN(xe)||isNaN(be)||!J(w,Ee)||(te=y._scaler(J(w,Ee)),ie.fillStyle=te?de+"("+ue(te).join(",")+")":"rgba(0,0,0,0)",ie.fillRect(ve,be,ke-ve,xe-be))}}return Q}})}},{"../../constants/xmlns_namespaces":764,"../../lib":787,"./constants":1123,"@plotly/d3":58}],1130:[function(r,O,B){var t=r("@plotly/d3");O.exports=function(d){t.select(d).selectAll(".im image").style("opacity",function(m){return m[0].trace.opacity})}},{"@plotly/d3":58}],1131:[function(r,O,B){var t=r("../../lib/extend").extendFlat,d=r("../../lib/extend").extendDeep,m=r("../../plot_api/edit_types").overrideAll,p=r("../../plots/font_attributes"),e=r("../../components/color/attributes"),f=r("../../plots/domain").attributes,u=r("../../plots/cartesian/layout_attributes"),s=r("../../plot_api/plot_template").templatedArray,l=r("../../constants/delta.js"),o=r("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,i=p({editType:"plot",colorEditType:"plot"}),c={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},n={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},a=s("step",d({},c,{range:n}));O.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:f({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:t({},i,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:o("value")},font:t({},i,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:o("value")},increasing:{symbol:{valType:"string",dflt:l.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:l.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:l.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:l.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:t({},i,{}),editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:d({},c,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:m({range:n,visible:t({},u.visible,{dflt:!0}),tickmode:u.tickmode,nticks:u.nticks,tick0:u.tick0,dtick:u.dtick,tickvals:u.tickvals,ticktext:u.ticktext,ticks:t({},u.ticks,{dflt:"outside"}),ticklen:u.ticklen,tickwidth:u.tickwidth,tickcolor:u.tickcolor,showticklabels:u.showticklabels,tickfont:p({}),tickangle:u.tickangle,tickformat:u.tickformat,tickformatstops:u.tickformatstops,tickprefix:u.tickprefix,showtickprefix:u.showtickprefix,ticksuffix:u.ticksuffix,showticksuffix:u.showticksuffix,separatethousands:u.separatethousands,exponentformat:u.exponentformat,minexponent:u.minexponent,showexponent:u.showexponent,editType:"plot"},"plot"),steps:a,threshold:{line:{color:t({},c.line.color,{}),width:t({},c.line.width,{dflt:1}),editType:"plot"},thickness:t({},c.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":649,"../../constants/delta.js":757,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../plots/cartesian/axis_format_attributes":841,"../../plots/cartesian/layout_attributes":853,"../../plots/domain":866,"../../plots/font_attributes":867}],1132:[function(r,O,B){var t=r("../../plots/plots");B.name="indicator",B.plot=function(d,m,p,e){t.plotBasePlot(B.name,d,m,p,e)},B.clean=function(d,m,p,e){t.cleanBasePlot(B.name,d,m,p,e)}},{"../../plots/plots":901}],1133:[function(r,O,B){O.exports={calc:function(t,d){var m=[],p=d.value;typeof d._lastValue!="number"&&(d._lastValue=d.value);var e=d._lastValue,f=e;return d._hasDelta&&typeof d.delta.reference=="number"&&(f=d.delta.reference),m[0]={y:p,lastY:e,delta:p-f,relativeDelta:(p-f)/f},m}}},{}],1134:[function(r,O,B){O.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],1135:[function(r,O,B){var t=r("../../lib"),d=r("./attributes"),m=r("../../plots/domain").defaults,p=r("../../plot_api/plot_template"),e=r("../../plots/array_container_defaults"),f=r("./constants.js"),u=r("../../plots/cartesian/tick_value_defaults"),s=r("../../plots/cartesian/tick_mark_defaults"),l=r("../../plots/cartesian/tick_label_defaults");function o(i,c){function n(a,g){return t.coerce(i,c,d.gauge.steps,a,g)}n("color"),n("line.color"),n("line.width"),n("range"),n("thickness")}O.exports={supplyDefaults:function(i,c,n,a){function g(L,M){return t.coerce(i,c,d,L,M)}m(c,a,g),g("mode"),c._hasNumber=c.mode.indexOf("number")!==-1,c._hasDelta=c.mode.indexOf("delta")!==-1,c._hasGauge=c.mode.indexOf("gauge")!==-1;var h=g("value");c._range=[0,typeof h=="number"?1.5*h:1];var y,v,_,x,T,A,S=new Array(2);function w(L,M){return t.coerce(_,x,d.gauge,L,M)}function C(L,M){return t.coerce(T,A,d.gauge.axis,L,M)}if(c._hasNumber&&(g("number.valueformat"),g("number.font.color",a.font.color),g("number.font.family",a.font.family),g("number.font.size"),c.number.font.size===void 0&&(c.number.font.size=f.defaultNumberFontSize,S[0]=!0),g("number.prefix"),g("number.suffix"),y=c.number.font.size),c._hasDelta&&(g("delta.font.color",a.font.color),g("delta.font.family",a.font.family),g("delta.font.size"),c.delta.font.size===void 0&&(c.delta.font.size=(c._hasNumber?.5:1)*(y||f.defaultNumberFontSize),S[1]=!0),g("delta.reference",c.value),g("delta.relative"),g("delta.valueformat",c.delta.relative?"2%":""),g("delta.increasing.symbol"),g("delta.increasing.color"),g("delta.decreasing.symbol"),g("delta.decreasing.color"),g("delta.position"),v=c.delta.font.size),c._scaleNumbers=(!c._hasNumber||S[0])&&(!c._hasDelta||S[1])||!1,g("title.font.color",a.font.color),g("title.font.family",a.font.family),g("title.font.size",.25*(y||v||f.defaultNumberFontSize)),g("title.text"),c._hasGauge){(_=i.gauge)||(_={}),x=p.newContainer(c,"gauge"),w("shape"),(c._isBullet=c.gauge.shape==="bullet")||g("title.align","center"),(c._isAngular=c.gauge.shape==="angular")||g("align","center"),w("bgcolor",a.paper_bgcolor),w("borderwidth"),w("bordercolor"),w("bar.color"),w("bar.line.color"),w("bar.line.width"),w("bar.thickness",f.valueThickness*(c.gauge.shape==="bullet"?.5:1)),e(_,x,{name:"steps",handleItemDefaults:o}),w("threshold.value"),w("threshold.thickness"),w("threshold.line.width"),w("threshold.line.color"),T={},_&&(T=_.axis||{}),A=p.newContainer(x,"axis"),C("visible"),c._range=C("range",c._range);var k={outerTicks:!0};u(T,A,C,"linear"),l(T,A,C,"linear",k),s(T,A,C,k)}else g("title.align","center"),g("align","center"),c._isAngular=c._isBullet=!1;c._length=null}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/array_container_defaults":833,"../../plots/cartesian/tick_label_defaults":860,"../../plots/cartesian/tick_mark_defaults":861,"../../plots/cartesian/tick_value_defaults":862,"../../plots/domain":866,"./attributes":1131,"./constants.js":1134}],1136:[function(r,O,B){O.exports={moduleType:"trace",name:"indicator",basePlotModule:r("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:r("./attributes"),supplyDefaults:r("./defaults").supplyDefaults,calc:r("./calc").calc,plot:r("./plot"),meta:{}}},{"./attributes":1131,"./base_plot":1132,"./calc":1133,"./defaults":1135,"./plot":1137}],1137:[function(r,O,B){var t=r("@plotly/d3"),d=r("d3-interpolate").interpolate,m=r("d3-interpolate").interpolateNumber,p=r("../../lib"),e=p.strScale,f=p.strTranslate,u=p.rad2deg,s=r("../../constants/alignment").MID_SHIFT,l=r("../../components/drawing"),o=r("./constants"),i=r("../../lib/svg_text_utils"),c=r("../../plots/cartesian/axes"),n=r("../../plots/cartesian/axis_defaults"),a=r("../../plots/cartesian/position_defaults"),g=r("../../plots/cartesian/layout_attributes"),h=r("../../components/color"),y={left:"start",center:"middle",right:"end"},v={left:0,center:.5,right:1},_=/[yzafpn\xb5mkMGTPEZY]/;function x(k){return k&&k.duration>0}function T(k){k.each(function(L){h.stroke(t.select(this),L.line.color)}).each(function(L){h.fill(t.select(this),L.color)}).style("stroke-width",function(L){return L.line.width})}function A(k,L,M){var P=k._fullLayout,D=p.extendFlat({type:"linear",ticks:"outside",range:M,showline:!0},L),N={type:"linear",_id:"x"+L._id},U={letter:"x",font:P.font,noHover:!0,noTickson:!0};function q(X,K){return p.coerce(D,N,g,X,K)}return n(D,N,q,U,P),a(D,N,q,U),N}function S(k,L,M){return[Math.min(L/k.width,M/k.height),k,L+"x"+M]}function w(k,L,M,P){var D=document.createElementNS("http://www.w3.org/2000/svg","text"),N=t.select(D);return N.text(k).attr("x",0).attr("y",0).attr("text-anchor",M).attr("data-unformatted",k).call(i.convertToTspans,P).call(l.font,L),l.bBox(N.node())}function C(k,L,M,P,D,N){var U="_cache"+L;k[U]&&k[U].key===D||(k[U]={key:D,value:M});var q=p.aggNums(N,null,[k[U].value,P],2);return k[U].value=q,q}O.exports=function(k,L,M,P){var D,N=k._fullLayout;x(M)&&P&&(D=P()),p.makeTraceGroups(N._indicatorlayer,L,"trace").each(function(U){var q,X,K,Z,H,Y=U[0].trace,$=t.select(this),z=Y._hasGauge,j=Y._isAngular,W=Y._isBullet,ee=Y.domain,J={w:N._size.w*(ee.x[1]-ee.x[0]),h:N._size.h*(ee.y[1]-ee.y[0]),l:N._size.l+N._size.w*ee.x[0],r:N._size.r+N._size.w*(1-ee.x[1]),t:N._size.t+N._size.h*(1-ee.y[1]),b:N._size.b+N._size.h*ee.y[0]},Q=J.l+J.w/2,te=J.t+J.h/2,ie=Math.min(J.w/2,J.h),ae=o.innerRadius*ie,he=Y.align||"center";if(X=te,z){if(j&&(q=Q,X=te+ie/2,K=function(xe){return function(ce,ge){var we=Math.sqrt(ce.width/2*(ce.width/2)+ce.height*ce.height);return[ge/we,ce,ge]}(xe,.9*ae)}),W){var se=o.bulletPadding,de=1-o.bulletNumberDomainSize+se;q=J.l+(de+(1-de)*v[he])*J.w,K=function(xe){return S(xe,(o.bulletNumberDomainSize-se)*J.w,J.h)}}}else q=J.l+v[he]*J.w,K=function(xe){return S(xe,J.w,J.h)};(function(xe,ce,ge,we){var Me,Se,ze,Fe=ge[0].trace,Ye=we.numbersX,rt=we.numbersY,Oe=Fe.align||"center",je=y[Oe],We=we.transitionOpts,qe=we.onComplete,Qe=p.ensureSingle(ce,"g","numbers"),st=[];Fe._hasNumber&&st.push("number"),Fe._hasDelta&&(st.push("delta"),Fe.delta.position==="left"&&st.reverse());var ct=Qe.selectAll("text").data(st);function Pt(He,Be,Ke,_e){if(!He.match("s")||Ke>=0==_e>=0||Be(Ke).slice(-1).match(_)||Be(_e).slice(-1).match(_))return Be;var Ce=He.slice().replace("s","f").replace(/\d+/,function(Pe){return parseInt(Pe)-1}),Le=A(xe,{tickformat:Ce});return function(Pe){return Math.abs(Pe)<1?c.tickText(Le,Pe).text:Be(Pe)}}ct.enter().append("text"),ct.attr("text-anchor",function(){return je}).attr("class",function(He){return He}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),ct.exit().remove();var kt,at=Fe.mode+Fe.align;if(Fe._hasDelta&&(kt=function(){var He=A(xe,{tickformat:Fe.delta.valueformat},Fe._range);He.setScale(),c.prepTicks(He);var Be=function(Xe){return c.tickText(He,Xe).text},Ke=function(Xe){return Fe.delta.relative?Xe.relativeDelta:Xe.delta},_e=function(Xe,ht){return Xe===0||typeof Xe!="number"||isNaN(Xe)?"-":(Xe>0?Fe.delta.increasing.symbol:Fe.delta.decreasing.symbol)+ht(Xe)},Ce=function(Xe){return Xe.delta>=0?Fe.delta.increasing.color:Fe.delta.decreasing.color};Fe._deltaLastValue===void 0&&(Fe._deltaLastValue=Ke(ge[0]));var Le=Qe.select("text.delta");function Pe(){Le.text(_e(Ke(ge[0]),Be)).call(h.fill,Ce(ge[0])).call(i.convertToTspans,xe)}return Le.call(l.font,Fe.delta.font).call(h.fill,Ce({delta:Fe._deltaLastValue})),x(We)?Le.transition().duration(We.duration).ease(We.easing).tween("text",function(){var Xe=t.select(this),ht=Ke(ge[0]),Mt=Fe._deltaLastValue,pt=Pt(Fe.delta.valueformat,Be,Mt,ht),Lt=m(Mt,ht);return Fe._deltaLastValue=ht,function(vt){Xe.text(_e(Lt(vt),pt)),Xe.call(h.fill,Ce({delta:Lt(vt)}))}}).each("end",function(){Pe(),qe&&qe()}).each("interrupt",function(){Pe(),qe&&qe()}):Pe(),Se=w(_e(Ke(ge[0]),Be),Fe.delta.font,je,xe),Le}(),at+=Fe.delta.position+Fe.delta.font.size+Fe.delta.font.family+Fe.delta.valueformat,at+=Fe.delta.increasing.symbol+Fe.delta.decreasing.symbol,ze=Se),Fe._hasNumber&&(function(){var He=A(xe,{tickformat:Fe.number.valueformat},Fe._range);He.setScale(),c.prepTicks(He);var Be=function(Pe){return c.tickText(He,Pe).text},Ke=Fe.number.suffix,_e=Fe.number.prefix,Ce=Qe.select("text.number");function Le(){var Pe=typeof ge[0].y=="number"?_e+Be(ge[0].y)+Ke:"-";Ce.text(Pe).call(l.font,Fe.number.font).call(i.convertToTspans,xe)}x(We)?Ce.transition().duration(We.duration).ease(We.easing).each("end",function(){Le(),qe&&qe()}).each("interrupt",function(){Le(),qe&&qe()}).attrTween("text",function(){var Pe=t.select(this),Xe=m(ge[0].lastY,ge[0].y);Fe._lastValue=ge[0].y;var ht=Pt(Fe.number.valueformat,Be,ge[0].lastY,ge[0].y);return function(Mt){Pe.text(_e+ht(Xe(Mt))+Ke)}}):Le(),Me=w(_e+Be(ge[0].y)+Ke,Fe.number.font,je,xe)}(),at+=Fe.number.font.size+Fe.number.font.family+Fe.number.valueformat+Fe.number.suffix+Fe.number.prefix,ze=Me),Fe._hasDelta&&Fe._hasNumber){var tt,_t,er=[(Me.left+Me.right)/2,(Me.top+Me.bottom)/2],tr=[(Se.left+Se.right)/2,(Se.top+Se.bottom)/2],Ue=.75*Fe.delta.font.size;Fe.delta.position==="left"&&(tt=C(Fe,"deltaPos",0,-1*(Me.width*v[Fe.align]+Se.width*(1-v[Fe.align])+Ue),at,Math.min),_t=er[1]-tr[1],ze={width:Me.width+Se.width+Ue,height:Math.max(Me.height,Se.height),left:Se.left+tt,right:Me.right,top:Math.min(Me.top,Se.top+_t),bottom:Math.max(Me.bottom,Se.bottom+_t)}),Fe.delta.position==="right"&&(tt=C(Fe,"deltaPos",0,Me.width*(1-v[Fe.align])+Se.width*v[Fe.align]+Ue,at,Math.max),_t=er[1]-tr[1],ze={width:Me.width+Se.width+Ue,height:Math.max(Me.height,Se.height),left:Me.left,right:Se.right+tt,top:Math.min(Me.top,Se.top+_t),bottom:Math.max(Me.bottom,Se.bottom+_t)}),Fe.delta.position==="bottom"&&(tt=null,_t=Se.height,ze={width:Math.max(Me.width,Se.width),height:Me.height+Se.height,left:Math.min(Me.left,Se.left),right:Math.max(Me.right,Se.right),top:Me.bottom-Me.height,bottom:Me.bottom+Se.height}),Fe.delta.position==="top"&&(tt=null,_t=Me.top,ze={width:Math.max(Me.width,Se.width),height:Me.height+Se.height,left:Math.min(Me.left,Se.left),right:Math.max(Me.right,Se.right),top:Me.bottom-Me.height-Se.height,bottom:Me.bottom}),kt.attr({dx:tt,dy:_t})}(Fe._hasNumber||Fe._hasDelta)&&Qe.attr("transform",function(){var He=we.numbersScaler(ze);at+=He[2];var Be,Ke=C(Fe,"numbersScale",1,He[0],at,Math.min);Fe._scaleNumbers||(Ke=1),Be=Fe._isAngular?rt-Ke*ze.bottom:rt-Ke*(ze.top+ze.bottom)/2,Fe._numbersTop=Ke*ze.top+Be;var _e=ze[Oe];Oe==="center"&&(_e=(ze.left+ze.right)/2);var Ce=Ye-Ke*_e;return Ce=C(Fe,"numbersTranslate",0,Ce,at,Math.max),f(Ce,Be)+e(Ke)})})(k,$,U,{numbersX:q,numbersY:X,numbersScaler:K,transitionOpts:M,onComplete:D}),z&&(Z={range:Y.gauge.axis.range,color:Y.gauge.bgcolor,line:{color:Y.gauge.bordercolor,width:0},thickness:1},H={range:Y.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:Y.gauge.bordercolor,width:Y.gauge.borderwidth},thickness:1});var ue=$.selectAll("g.angular").data(j?U:[]);ue.exit().remove();var ve=$.selectAll("g.angularaxis").data(j?U:[]);ve.exit().remove(),j&&function(xe,ce,ge,we){var Me,Se,ze,Fe,Ye=ge[0].trace,rt=we.size,Oe=we.radius,je=we.innerRadius,We=we.gaugeBg,qe=we.gaugeOutline,Qe=[rt.l+rt.w/2,rt.t+rt.h/2+Oe/2],st=we.gauge,ct=we.layer,Pt=we.transitionOpts,kt=we.onComplete,at=Math.PI/2;function tt(xt){var it=Ye.gauge.axis.range[0],St=(xt-it)/(Ye.gauge.axis.range[1]-it)*Math.PI-at;return St<-at?-at:St>at?at:St}function _t(xt){return t.svg.arc().innerRadius((je+Oe)/2-xt/2*(Oe-je)).outerRadius((je+Oe)/2+xt/2*(Oe-je)).startAngle(-at)}function er(xt){xt.attr("d",function(it){return _t(it.thickness).startAngle(tt(it.range[0])).endAngle(tt(it.range[1]))()})}st.enter().append("g").classed("angular",!0),st.attr("transform",f(Qe[0],Qe[1])),ct.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),ct.selectAll("g.xangularaxistick,path,text").remove(),(Me=A(xe,Ye.gauge.axis)).type="linear",Me.range=Ye.gauge.axis.range,Me._id="xangularaxis",Me.ticklabeloverflow="allow",Me.setScale();var tr=function(xt){return(Me.range[0]-xt.x)/(Me.range[1]-Me.range[0])*Math.PI+Math.PI},Ue={},He=c.makeLabelFns(Me,0).labelStandoff;Ue.xFn=function(xt){var it=tr(xt);return Math.cos(it)*He},Ue.yFn=function(xt){var it=tr(xt),St=Math.sin(it)>0?.2:1;return-Math.sin(it)*(He+xt.fontSize*St)+Math.abs(Math.cos(it))*(xt.fontSize*s)},Ue.anchorFn=function(xt){var it=tr(xt),St=Math.cos(it);return Math.abs(St)<.1?"middle":St>0?"start":"end"},Ue.heightFn=function(xt,it,St){var Nt=tr(xt);return-.5*(1+Math.sin(Nt))*St};var Be=function(xt){return f(Qe[0]+Oe*Math.cos(xt),Qe[1]-Oe*Math.sin(xt))};if(ze=function(xt){return Be(tr(xt))},Se=c.calcTicks(Me),Fe=c.getTickSigns(Me)[2],Me.visible){Fe=Me.ticks==="inside"?-1:1;var Ke=(Me.linewidth||1)/2;c.drawTicks(xe,Me,{vals:Se,layer:ct,path:"M"+Fe*Ke+",0h"+Fe*Me.ticklen,transFn:function(xt){var it=tr(xt);return Be(it)+"rotate("+-u(it)+")"}}),c.drawLabels(xe,Me,{vals:Se,layer:ct,transFn:ze,labelFns:Ue})}var _e=[We].concat(Ye.gauge.steps),Ce=st.selectAll("g.bg-arc").data(_e);Ce.enter().append("g").classed("bg-arc",!0).append("path"),Ce.select("path").call(er).call(T),Ce.exit().remove();var Le=_t(Ye.gauge.bar.thickness),Pe=st.selectAll("g.value-arc").data([Ye.gauge.bar]);Pe.enter().append("g").classed("value-arc",!0).append("path");var Xe=Pe.select("path");x(Pt)?(Xe.transition().duration(Pt.duration).ease(Pt.easing).each("end",function(){kt&&kt()}).each("interrupt",function(){kt&&kt()}).attrTween("d",(ht=Le,Mt=tt(ge[0].lastY),pt=tt(ge[0].y),function(){var xt=d(Mt,pt);return function(it){return ht.endAngle(xt(it))()}})),Ye._lastValue=ge[0].y):Xe.attr("d",typeof ge[0].y=="number"?Le.endAngle(tt(ge[0].y)):"M0,0Z");var ht,Mt,pt;Xe.call(T),Pe.exit().remove(),_e=[];var Lt=Ye.gauge.threshold.value;(Lt||Lt===0)&&_e.push({range:[Lt,Lt],color:Ye.gauge.threshold.color,line:{color:Ye.gauge.threshold.line.color,width:Ye.gauge.threshold.line.width},thickness:Ye.gauge.threshold.thickness});var vt=st.selectAll("g.threshold-arc").data(_e);vt.enter().append("g").classed("threshold-arc",!0).append("path"),vt.select("path").call(er).call(T),vt.exit().remove();var Dt=st.selectAll("g.gauge-outline").data([qe]);Dt.enter().append("g").classed("gauge-outline",!0).append("path"),Dt.select("path").call(er).call(T),Dt.exit().remove()}(k,0,U,{radius:ie,innerRadius:ae,gauge:ue,layer:ve,size:J,gaugeBg:Z,gaugeOutline:H,transitionOpts:M,onComplete:D});var ke=$.selectAll("g.bullet").data(W?U:[]);ke.exit().remove();var Ee=$.selectAll("g.bulletaxis").data(W?U:[]);Ee.exit().remove(),W&&function(xe,ce,ge,we){var Me,Se,ze,Fe,Ye,rt=ge[0].trace,Oe=we.gauge,je=we.layer,We=we.gaugeBg,qe=we.gaugeOutline,Qe=we.size,st=rt.domain,ct=we.transitionOpts,Pt=we.onComplete;Oe.enter().append("g").classed("bullet",!0),Oe.attr("transform",f(Qe.l,Qe.t)),je.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),je.selectAll("g.xbulletaxistick,path,text").remove();var kt=Qe.h,at=rt.gauge.bar.thickness*kt,tt=st.x[0],_t=st.x[0]+(st.x[1]-st.x[0])*(rt._hasNumber||rt._hasDelta?1-o.bulletNumberDomainSize:1);(Me=A(xe,rt.gauge.axis))._id="xbulletaxis",Me.domain=[tt,_t],Me.setScale(),Se=c.calcTicks(Me),ze=c.makeTransTickFn(Me),Fe=c.getTickSigns(Me)[2],Ye=Qe.t+Qe.h,Me.visible&&(c.drawTicks(xe,Me,{vals:Me.ticks==="inside"?c.clipEnds(Me,Se):Se,layer:je,path:c.makeTickPath(Me,Ye,Fe),transFn:ze}),c.drawLabels(xe,Me,{vals:Se,layer:je,transFn:ze,labelFns:c.makeLabelFns(Me,Ye)}));function er(Ce){Ce.attr("width",function(Le){return Math.max(0,Me.c2p(Le.range[1])-Me.c2p(Le.range[0]))}).attr("x",function(Le){return Me.c2p(Le.range[0])}).attr("y",function(Le){return .5*(1-Le.thickness)*kt}).attr("height",function(Le){return Le.thickness*kt})}var tr=[We].concat(rt.gauge.steps),Ue=Oe.selectAll("g.bg-bullet").data(tr);Ue.enter().append("g").classed("bg-bullet",!0).append("rect"),Ue.select("rect").call(er).call(T),Ue.exit().remove();var He=Oe.selectAll("g.value-bullet").data([rt.gauge.bar]);He.enter().append("g").classed("value-bullet",!0).append("rect"),He.select("rect").attr("height",at).attr("y",(kt-at)/2).call(T),x(ct)?He.select("rect").transition().duration(ct.duration).ease(ct.easing).each("end",function(){Pt&&Pt()}).each("interrupt",function(){Pt&&Pt()}).attr("width",Math.max(0,Me.c2p(Math.min(rt.gauge.axis.range[1],ge[0].y)))):He.select("rect").attr("width",typeof ge[0].y=="number"?Math.max(0,Me.c2p(Math.min(rt.gauge.axis.range[1],ge[0].y))):0),He.exit().remove();var Be=ge.filter(function(){return rt.gauge.threshold.value||rt.gauge.threshold.value===0}),Ke=Oe.selectAll("g.threshold-bullet").data(Be);Ke.enter().append("g").classed("threshold-bullet",!0).append("line"),Ke.select("line").attr("x1",Me.c2p(rt.gauge.threshold.value)).attr("x2",Me.c2p(rt.gauge.threshold.value)).attr("y1",(1-rt.gauge.threshold.thickness)/2*kt).attr("y2",(1-(1-rt.gauge.threshold.thickness)/2)*kt).call(h.stroke,rt.gauge.threshold.line.color).style("stroke-width",rt.gauge.threshold.line.width),Ke.exit().remove();var _e=Oe.selectAll("g.gauge-outline").data([qe]);_e.enter().append("g").classed("gauge-outline",!0).append("rect"),_e.select("rect").call(er).call(T),_e.exit().remove()}(k,0,U,{gauge:ke,layer:Ee,size:J,gaugeBg:Z,gaugeOutline:H,transitionOpts:M,onComplete:D});var be=$.selectAll("text.title").data(U);be.exit().remove(),be.enter().append("text").classed("title",!0),be.attr("text-anchor",function(){return W?y.right:y[Y.title.align]}).text(Y.title.text).call(l.font,Y.title.font).call(i.convertToTspans,k),be.attr("transform",function(){var xe,ce=J.l+J.w*v[Y.title.align],ge=o.titlePadding,we=l.bBox(be.node());return z?(j&&(Y.gauge.axis.visible?xe=l.bBox(ve.node()).top-ge-we.bottom:xe=J.t+J.h/2-ie/2-we.bottom-ge),W&&(xe=X-(we.top+we.bottom)/2,ce=J.l-o.bulletPadding*J.w)):xe=Y._numbersTop-ge-we.bottom,f(ce,xe)})})}},{"../../components/color":650,"../../components/drawing":672,"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../plots/cartesian/axis_defaults":840,"../../plots/cartesian/layout_attributes":853,"../../plots/cartesian/position_defaults":856,"./constants":1134,"@plotly/d3":58,"d3-interpolate":168}],1138:[function(r,O,B){var t=r("../../components/colorscale/attributes"),d=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=r("../../plots/template_attributes").hovertemplateAttrs,p=r("../mesh3d/attributes"),e=r("../../plots/attributes"),f=r("../../lib/extend").extendFlat,u=r("../../plot_api/edit_types").overrideAll,s=O.exports=u(f({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}},caps:{x:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:m(),xhoverformat:d("x"),yhoverformat:d("y"),zhoverformat:d("z"),valuehoverformat:d("value",1),showlegend:f({},e.showlegend,{dflt:!1})},t("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:p.opacity,lightposition:p.lightposition,lighting:p.lighting,flatshading:p.flatshading,contour:p.contour,hoverinfo:f({},e.hoverinfo)}),"calc","nested");s.flatshading.dflt=!0,s.lighting.facenormalsepsilon.dflt=0,s.x.editType=s.y.editType=s.z.editType=s.value.editType="calc+clearAxisTypes",s.transforms=void 0},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../mesh3d/attributes":1143}],1139:[function(r,O,B){var t=r("../../components/colorscale/calc"),d=r("../streamtube/calc").processGrid,m=r("../streamtube/calc").filter;O.exports=function(p,e){e._len=Math.min(e.x.length,e.y.length,e.z.length,e.value.length),e._x=m(e.x,e._len),e._y=m(e.y,e._len),e._z=m(e.z,e._len),e._value=m(e.value,e._len);var f=d(e);e._gridFill=f.fill,e._Xs=f.Xs,e._Ys=f.Ys,e._Zs=f.Zs,e._len=f.len;for(var u=1/0,s=-1/0,l=0;l<e._len;l++){var o=e._value[l];u=Math.min(u,o),s=Math.max(s,o)}e._minValues=u,e._maxValues=s,e._vMin=e.isomin===void 0||e.isomin===null?u:e.isomin,e._vMax=e.isomax===void 0||e.isomin===null?s:e.isomax,t(p,e,{vals:[e._vMin,e._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":658,"../streamtube/calc":1310}],1140:[function(r,O,B){var t=r("gl-mesh3d"),d=r("../../lib/gl_format_color").parseColorScale,m=r("../../lib/str2rgbarray"),p=r("../../components/colorscale").extractOpts,e=r("../../plots/gl3d/zip3"),f=function(i,c){for(var n=c.length-1;n>0;n--){var a=Math.min(c[n],c[n-1]),g=Math.max(c[n],c[n-1]);if(g>a&&a<i&&i<=g)return{id:n,distRatio:(g-i)/(g-a)}}return{id:0,distRatio:0}};function u(i,c,n){this.scene=i,this.uid=n,this.mesh=c,this.name="",this.data=null,this.showContour=!1}var s=u.prototype;s.handlePick=function(i){if(i.object===this.mesh){var c=i.data.index,n=this.data._meshX[c],a=this.data._meshY[c],g=this.data._meshZ[c],h=this.data._Ys.length,y=this.data._Zs.length,v=f(n,this.data._Xs).id,_=f(a,this.data._Ys).id,x=f(g,this.data._Zs).id,T=i.index=x+y*_+y*h*v;i.traceCoordinate=[this.data._meshX[T],this.data._meshY[T],this.data._meshZ[T],this.data._value[T]];var A=this.data.hovertext||this.data.text;return Array.isArray(A)&&A[T]!==void 0?i.textLabel=A[T]:A&&(i.textLabel=A),!0}},s.update=function(i){var c=this.scene,n=c.fullSceneLayout;function a(y,v,_,x){return v.map(function(T){return y.d2l(T,0,x)*_})}this.data=o(i);var g={positions:e(a(n.xaxis,i._meshX,c.dataScale[0],i.xcalendar),a(n.yaxis,i._meshY,c.dataScale[1],i.ycalendar),a(n.zaxis,i._meshZ,c.dataScale[2],i.zcalendar)),cells:e(i._meshI,i._meshJ,i._meshK),lightPosition:[i.lightposition.x,i.lightposition.y,i.lightposition.z],ambient:i.lighting.ambient,diffuse:i.lighting.diffuse,specular:i.lighting.specular,roughness:i.lighting.roughness,fresnel:i.lighting.fresnel,vertexNormalsEpsilon:i.lighting.vertexnormalsepsilon,faceNormalsEpsilon:i.lighting.facenormalsepsilon,opacity:i.opacity,contourEnable:i.contour.show,contourColor:m(i.contour.color).slice(0,3),contourWidth:i.contour.width,useFacetNormals:i.flatshading},h=p(i);g.vertexIntensity=i._meshIntensity,g.vertexIntensityBounds=[h.min,h.max],g.colormap=d(i),this.mesh.update(g)},s.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var l=["xyz","xzy","yxz","yzx","zxy","zyx"];function o(i){i._meshI=[],i._meshJ=[],i._meshK=[];var c,n,a,g,h,y,v,_=i.surface.show,x=i.spaceframe.show,T=i.surface.fill,A=i.spaceframe.fill,S=!1,w=!1,C=0,k=i._Xs,L=i._Ys,M=i._Zs,P=k.length,D=L.length,N=M.length,U=l.indexOf(i._gridFill.replace(/-/g,"").replace(/\+/g,"")),q=function(Oe,je,We){switch(U){case 5:return We+N*je+N*D*Oe;case 4:return We+N*Oe+N*P*je;case 3:return je+D*We+D*N*Oe;case 2:return je+D*Oe+D*P*We;case 1:return Oe+P*We+P*N*je;default:return Oe+P*je+P*D*We}},X=i._minValues,K=i._maxValues,Z=i._vMin,H=i._vMax;function Y(Oe,je,We){for(var qe=y.length,Qe=n;Qe<qe;Qe++)if(Oe===a[Qe]&&je===g[Qe]&&We===h[Qe])return Qe;return-1}function $(){n=c}function z(){a=[],g=[],h=[],y=[],c=0,$()}function j(Oe,je,We,qe){return a.push(Oe),g.push(je),h.push(We),y.push(qe),++c-1}function W(Oe,je,We){for(var qe=[],Qe=0;Qe<Oe.length;Qe++)qe[Qe]=Oe[Qe]*(1-We)+We*je[Qe];return qe}function ee(Oe){v=Oe}function J(Oe,je){return Oe==="all"||Oe===null||Oe.indexOf(je)>-1}function Q(Oe,je){return Oe===null?je:Oe}function te(Oe,je,We){$();var qe,Qe,st,ct=[je],Pt=[We];if(v>=1)ct=[je],Pt=[We];else if(v>0){var kt=function(Ke,_e){var Ce=Ke[0],Le=Ke[1],Pe=Ke[2],Xe=function(it,St,Nt){for(var Ut=[],Qt=0;Qt<it.length;Qt++)Ut[Qt]=(it[Qt]+St[Qt]+Nt[Qt])/3;return Ut}(Ce,Le,Pe),ht=Math.sqrt(1-v),Mt=W(Xe,Ce,ht),pt=W(Xe,Le,ht),Lt=W(Xe,Pe,ht),vt=_e[0],Dt=_e[1],xt=_e[2];return{xyzv:[[Ce,Le,pt],[pt,Mt,Ce],[Le,Pe,Lt],[Lt,pt,Le],[Pe,Ce,Mt],[Mt,Lt,Pe]],abc:[[vt,Dt,-1],[-1,-1,vt],[Dt,xt,-1],[-1,-1,Dt],[xt,vt,-1],[-1,-1,xt]]}}(je,We);ct=kt.xyzv,Pt=kt.abc}for(var at=0;at<ct.length;at++){je=ct[at],We=Pt[at];for(var tt=[],_t=0;_t<3;_t++){var er=je[_t][0],tr=je[_t][1],Ue=je[_t][2],He=je[_t][3],Be=We[_t]>-1?We[_t]:Y(er,tr,Ue);tt[_t]=Be>-1?Be:j(er,tr,Ue,Q(Oe,He))}qe=tt[0],Qe=tt[1],st=tt[2],i._meshI.push(qe),i._meshJ.push(Qe),i._meshK.push(st),++C}}function ie(Oe,je,We,qe){var Qe=Oe[3];Qe<We&&(Qe=We),Qe>qe&&(Qe=qe);for(var st=(Oe[3]-Qe)/(Oe[3]-je[3]+1e-9),ct=[],Pt=0;Pt<4;Pt++)ct[Pt]=(1-st)*Oe[Pt]+st*je[Pt];return ct}function ae(Oe,je,We){return Oe>=je&&Oe<=We}function he(Oe){var je=.001*(H-Z);return Oe>=Z-je&&Oe<=H+je}function se(Oe){for(var je=[],We=0;We<4;We++){var qe=Oe[We];je.push([i._x[qe],i._y[qe],i._z[qe],i._value[qe]])}return je}function de(Oe,je,We,qe,Qe,st){st||(st=1),We=[-1,-1,-1];var ct=!1,Pt=[ae(je[0][3],qe,Qe),ae(je[1][3],qe,Qe),ae(je[2][3],qe,Qe)];if(!Pt[0]&&!Pt[1]&&!Pt[2])return!1;var kt=function(tt,_t,er){return he(_t[0][3])&&he(_t[1][3])&&he(_t[2][3])?(te(tt,_t,er),!0):st<3&&de(tt,_t,er,Z,H,++st)};if(Pt[0]&&Pt[1]&&Pt[2])return kt(Oe,je,We)||ct;var at=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(tt){if(Pt[tt[0]]&&Pt[tt[1]]&&!Pt[tt[2]]){var _t=je[tt[0]],er=je[tt[1]],tr=je[tt[2]],Ue=ie(tr,_t,qe,Qe),He=ie(tr,er,qe,Qe);ct=kt(Oe,[He,Ue,_t],[-1,-1,We[tt[0]]])||ct,ct=kt(Oe,[_t,er,He],[We[tt[0]],We[tt[1]],-1])||ct,at=!0}}),at||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(tt){if(Pt[tt[0]]&&!Pt[tt[1]]&&!Pt[tt[2]]){var _t=je[tt[0]],er=je[tt[1]],tr=je[tt[2]],Ue=ie(er,_t,qe,Qe),He=ie(tr,_t,qe,Qe);ct=kt(Oe,[He,Ue,_t],[-1,-1,We[tt[0]]])||ct,at=!0}}),ct}function ue(Oe,je,We,qe){var Qe=!1,st=se(je),ct=[ae(st[0][3],We,qe),ae(st[1][3],We,qe),ae(st[2][3],We,qe),ae(st[3][3],We,qe)];if(!(ct[0]||ct[1]||ct[2]||ct[3]))return Qe;if(ct[0]&&ct[1]&&ct[2]&&ct[3])return w&&(Qe=function(kt,at,tt){var _t=function(er,tr,Ue){te(kt,[at[er],at[tr],at[Ue]],[tt[er],tt[tr],tt[Ue]])};_t(0,1,2),_t(3,0,1),_t(2,3,0),_t(1,2,3)}(Oe,st,je)||Qe),Qe;var Pt=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(kt){if(ct[kt[0]]&&ct[kt[1]]&&ct[kt[2]]&&!ct[kt[3]]){var at=st[kt[0]],tt=st[kt[1]],_t=st[kt[2]],er=st[kt[3]];if(w)Qe=te(Oe,[at,tt,_t],[je[kt[0]],je[kt[1]],je[kt[2]]])||Qe;else{var tr=ie(er,at,We,qe),Ue=ie(er,tt,We,qe),He=ie(er,_t,We,qe);Qe=te(null,[tr,Ue,He],[-1,-1,-1])||Qe}Pt=!0}}),Pt||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(kt){if(ct[kt[0]]&&ct[kt[1]]&&!ct[kt[2]]&&!ct[kt[3]]){var at=st[kt[0]],tt=st[kt[1]],_t=st[kt[2]],er=st[kt[3]],tr=ie(_t,at,We,qe),Ue=ie(_t,tt,We,qe),He=ie(er,tt,We,qe),Be=ie(er,at,We,qe);w?(Qe=te(Oe,[at,Be,tr],[je[kt[0]],-1,-1])||Qe,Qe=te(Oe,[tt,Ue,He],[je[kt[1]],-1,-1])||Qe):Qe=function(Ke,_e,Ce){var Le=function(Pe,Xe,ht){te(Ke,[_e[Pe],_e[Xe],_e[ht]],[Ce[Pe],Ce[Xe],Ce[ht]])};Le(0,1,2),Le(2,3,0)}(null,[tr,Ue,He,Be],[-1,-1,-1,-1])||Qe,Pt=!0}}),Pt||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(kt){if(ct[kt[0]]&&!ct[kt[1]]&&!ct[kt[2]]&&!ct[kt[3]]){var at=st[kt[0]],tt=st[kt[1]],_t=st[kt[2]],er=st[kt[3]],tr=ie(tt,at,We,qe),Ue=ie(_t,at,We,qe),He=ie(er,at,We,qe);w?(Qe=te(Oe,[at,tr,Ue],[je[kt[0]],-1,-1])||Qe,Qe=te(Oe,[at,Ue,He],[je[kt[0]],-1,-1])||Qe,Qe=te(Oe,[at,He,tr],[je[kt[0]],-1,-1])||Qe):Qe=te(null,[tr,Ue,He],[-1,-1,-1])||Qe,Pt=!0}})),Qe}function ve(Oe,je,We,qe,Qe,st,ct,Pt,kt,at,tt){var _t=!1;return S&&(J(Oe,"A")&&(_t=ue(null,[je,We,qe,st],at,tt)||_t),J(Oe,"B")&&(_t=ue(null,[We,qe,Qe,kt],at,tt)||_t),J(Oe,"C")&&(_t=ue(null,[We,st,ct,kt],at,tt)||_t),J(Oe,"D")&&(_t=ue(null,[qe,st,Pt,kt],at,tt)||_t),J(Oe,"E")&&(_t=ue(null,[We,qe,st,kt],at,tt)||_t)),w&&(_t=ue(Oe,[We,qe,st,kt],at,tt)||_t),_t}function ke(Oe,je,We,qe,Qe,st,ct,Pt){return[Pt[0]===!0||de(Oe,se([je,We,qe]),[je,We,qe],st,ct),Pt[1]===!0||de(Oe,se([qe,Qe,je]),[qe,Qe,je],st,ct)]}function Ee(Oe,je,We,qe,Qe,st,ct,Pt,kt){return Pt?ke(Oe,je,We,Qe,qe,st,ct,kt):ke(Oe,We,Qe,qe,je,st,ct,kt)}function be(Oe,je,We,qe,Qe,st,ct){var Pt,kt,at,tt,_t=!1,er=function(){_t=de(Oe,[Pt,kt,at],[-1,-1,-1],Qe,st)||_t,_t=de(Oe,[at,tt,Pt],[-1,-1,-1],Qe,st)||_t},tr=ct[0],Ue=ct[1],He=ct[2];return tr&&(Pt=W(se([q(je,We-0,qe-0)])[0],se([q(je-1,We-0,qe-0)])[0],tr),kt=W(se([q(je,We-0,qe-1)])[0],se([q(je-1,We-0,qe-1)])[0],tr),at=W(se([q(je,We-1,qe-1)])[0],se([q(je-1,We-1,qe-1)])[0],tr),tt=W(se([q(je,We-1,qe-0)])[0],se([q(je-1,We-1,qe-0)])[0],tr),er()),Ue&&(Pt=W(se([q(je-0,We,qe-0)])[0],se([q(je-0,We-1,qe-0)])[0],Ue),kt=W(se([q(je-0,We,qe-1)])[0],se([q(je-0,We-1,qe-1)])[0],Ue),at=W(se([q(je-1,We,qe-1)])[0],se([q(je-1,We-1,qe-1)])[0],Ue),tt=W(se([q(je-1,We,qe-0)])[0],se([q(je-1,We-1,qe-0)])[0],Ue),er()),He&&(Pt=W(se([q(je-0,We-0,qe)])[0],se([q(je-0,We-0,qe-1)])[0],He),kt=W(se([q(je-0,We-1,qe)])[0],se([q(je-0,We-1,qe-1)])[0],He),at=W(se([q(je-1,We-1,qe)])[0],se([q(je-1,We-1,qe-1)])[0],He),tt=W(se([q(je-1,We-0,qe)])[0],se([q(je-1,We-0,qe-1)])[0],He),er()),_t}function xe(Oe,je,We,qe,Qe,st,ct,Pt,kt,at,tt,_t){var er=Oe;return _t?(S&&Oe==="even"&&(er=null),ve(er,je,We,qe,Qe,st,ct,Pt,kt,at,tt)):(S&&Oe==="odd"&&(er=null),ve(er,kt,Pt,ct,st,Qe,qe,We,je,at,tt))}function ce(Oe,je,We,qe,Qe){for(var st=[],ct=0,Pt=0;Pt<je.length;Pt++)for(var kt=je[Pt],at=1;at<N;at++)for(var tt=1;tt<D;tt++)st.push(Ee(Oe,q(kt,tt-1,at-1),q(kt,tt-1,at),q(kt,tt,at-1),q(kt,tt,at),We,qe,(kt+tt+at)%2,Qe&&Qe[ct]?Qe[ct]:[])),ct++;return st}function ge(Oe,je,We,qe,Qe){for(var st=[],ct=0,Pt=0;Pt<je.length;Pt++)for(var kt=je[Pt],at=1;at<P;at++)for(var tt=1;tt<N;tt++)st.push(Ee(Oe,q(at-1,kt,tt-1),q(at,kt,tt-1),q(at-1,kt,tt),q(at,kt,tt),We,qe,(at+kt+tt)%2,Qe&&Qe[ct]?Qe[ct]:[])),ct++;return st}function we(Oe,je,We,qe,Qe){for(var st=[],ct=0,Pt=0;Pt<je.length;Pt++)for(var kt=je[Pt],at=1;at<D;at++)for(var tt=1;tt<P;tt++)st.push(Ee(Oe,q(tt-1,at-1,kt),q(tt-1,at,kt),q(tt,at-1,kt),q(tt,at,kt),We,qe,(tt+at+kt)%2,Qe&&Qe[ct]?Qe[ct]:[])),ct++;return st}function Me(Oe,je,We){for(var qe=1;qe<N;qe++)for(var Qe=1;Qe<D;Qe++)for(var st=1;st<P;st++)xe(Oe,q(st-1,Qe-1,qe-1),q(st-1,Qe-1,qe),q(st-1,Qe,qe-1),q(st-1,Qe,qe),q(st,Qe-1,qe-1),q(st,Qe-1,qe),q(st,Qe,qe-1),q(st,Qe,qe),je,We,(st+Qe+qe)%2)}function Se(Oe,je,We){S=!0,Me(Oe,je,We),S=!1}function ze(Oe,je,We,qe,Qe,st){for(var ct=[],Pt=0,kt=0;kt<je.length;kt++)for(var at=je[kt],tt=1;tt<N;tt++)for(var _t=1;_t<D;_t++)ct.push(be(Oe,at,_t,tt,We,qe,Qe[kt],st&&st[Pt]&&st[Pt])),Pt++;return ct}function Fe(Oe,je,We,qe,Qe,st){for(var ct=[],Pt=0,kt=0;kt<je.length;kt++)for(var at=je[kt],tt=1;tt<P;tt++)for(var _t=1;_t<N;_t++)ct.push(be(Oe,tt,at,_t,We,qe,Qe[kt],st&&st[Pt]&&st[Pt])),Pt++;return ct}function Ye(Oe,je,We,qe,Qe,st){for(var ct=[],Pt=0,kt=0;kt<je.length;kt++)for(var at=je[kt],tt=1;tt<D;tt++)for(var _t=1;_t<P;_t++)ct.push(be(Oe,_t,tt,at,We,qe,Qe[kt],st&&st[Pt]&&st[Pt])),Pt++;return ct}function rt(Oe,je){for(var We=[],qe=Oe;qe<je;qe++)We.push(qe);return We}return function(){if(z(),function(){for(var Pt=0;Pt<P;Pt++)for(var kt=0;kt<D;kt++)for(var at=0;at<N;at++){var tt=q(Pt,kt,at);j(i._x[tt],i._y[tt],i._z[tt],i._value[tt])}}(),x&&A&&(ee(A),w=!0,Me(null,Z,H),w=!1),_&&T){ee(T);for(var Oe=i.surface.pattern,je=i.surface.count,We=0;We<je;We++){var qe=je===1?.5:We/(je-1),Qe=(1-qe)*Z+qe*H,st=Math.abs(Qe-X)>Math.abs(Qe-K)?[X,Qe]:[Qe,K];Se(Oe,st[0],st[1])}}var ct=[[Math.min(Z,K),Math.max(Z,K)],[Math.min(X,H),Math.max(X,H)]];["x","y","z"].forEach(function(Pt){for(var kt=[],at=0;at<ct.length;at++){var tt=0,_t=ct[at][0],er=ct[at][1],tr=i.slices[Pt];if(tr.show&&tr.fill){ee(tr.fill);var Ue=[],He=[],Be=[];if(tr.locations.length)for(var Ke=0;Ke<tr.locations.length;Ke++){var _e=f(tr.locations[Ke],Pt==="x"?k:Pt==="y"?L:M);_e.distRatio===0?Ue.push(_e.id):_e.id>0&&(He.push(_e.id),Pt==="x"?Be.push([_e.distRatio,0,0]):Pt==="y"?Be.push([0,_e.distRatio,0]):Be.push([0,0,_e.distRatio]))}else Ue=rt(1,Pt==="x"?P-1:Pt==="y"?D-1:N-1);He.length>0&&(kt[tt]=Pt==="x"?ze(null,He,_t,er,Be,kt[tt]):Pt==="y"?Fe(null,He,_t,er,Be,kt[tt]):Ye(null,He,_t,er,Be,kt[tt]),tt++),Ue.length>0&&(kt[tt]=Pt==="x"?ce(null,Ue,_t,er,kt[tt]):Pt==="y"?ge(null,Ue,_t,er,kt[tt]):we(null,Ue,_t,er,kt[tt]),tt++)}var Ce=i.caps[Pt];Ce.show&&Ce.fill&&(ee(Ce.fill),kt[tt]=Pt==="x"?ce(null,[0,P-1],_t,er,kt[tt]):Pt==="y"?ge(null,[0,D-1],_t,er,kt[tt]):we(null,[0,N-1],_t,er,kt[tt]),tt++)}}),C===0&&z(),i._meshX=a,i._meshY=g,i._meshZ=h,i._meshIntensity=y,i._Xs=k,i._Ys=L,i._Zs=M}(),i}O.exports={findNearestOnAxis:f,generateIsoMeshes:o,createIsosurfaceTrace:function(i,c){var n=i.glplot.gl,a=t({gl:n}),g=new u(i,a,c.uid);return a._trace=g,g.update(c),i.glplot.add(a),g}}},{"../../components/colorscale":662,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../../plots/gl3d/zip3":891,"gl-mesh3d":309}],1141:[function(r,O,B){var t=r("../../lib"),d=r("../../registry"),m=r("./attributes"),p=r("../../components/colorscale/defaults");function e(f,u,s,l,o){var i=o("isomin"),c=o("isomax");c!=null&&i!=null&&i>c&&(u.isomin=null,u.isomax=null);var n=o("x"),a=o("y"),g=o("z"),h=o("value");n&&n.length&&a&&a.length&&g&&g.length&&h&&h.length?(d.getComponentMethod("calendars","handleTraceDefaults")(f,u,["x","y","z"],l),o("valuehoverformat"),["x","y","z"].forEach(function(y){o(y+"hoverformat");var v="caps."+y;o(v+".show")&&o(v+".fill");var _="slices."+y;o(_+".show")&&(o(_+".fill"),o(_+".locations"))}),o("spaceframe.show")&&o("spaceframe.fill"),o("surface.show")&&(o("surface.count"),o("surface.fill"),o("surface.pattern")),o("contour.show")&&(o("contour.color"),o("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(y){o(y)}),p(f,u,l,o,{prefix:"",cLetter:"c"}),u._length=null):u.visible=!1}O.exports={supplyDefaults:function(f,u,s,l){e(f,u,s,l,function(o,i){return t.coerce(f,u,m,o,i)})},supplyIsoDefaults:e}},{"../../components/colorscale/defaults":660,"../../lib":787,"../../registry":915,"./attributes":1138}],1142:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults").supplyDefaults,calc:r("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:r("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":880,"./attributes":1138,"./calc":1139,"./convert":1140,"./defaults":1141}],1143:[function(r,O,B){var t=r("../../components/colorscale/attributes"),d=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=r("../../plots/template_attributes").hovertemplateAttrs,p=r("../surface/attributes"),e=r("../../plots/attributes"),f=r("../../lib/extend").extendFlat;O.exports=f({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:m({editType:"calc"}),xhoverformat:d("x"),yhoverformat:d("y"),zhoverformat:d("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},t("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:p.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:f({},p.contours.x.show,{}),color:p.contours.x.color,width:p.contours.x.width,editType:"calc"},lightposition:{x:f({},p.lightposition.x,{dflt:1e5}),y:f({},p.lightposition.y,{dflt:1e5}),z:f({},p.lightposition.z,{dflt:0}),editType:"calc"},lighting:f({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},p.lighting),hoverinfo:f({},e.hoverinfo,{editType:"calc"}),showlegend:f({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../surface/attributes":1326}],1144:[function(r,O,B){var t=r("../../components/colorscale/calc");O.exports=function(d,m){m.intensity&&t(d,m,{vals:m.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":658}],1145:[function(r,O,B){var t=r("gl-mesh3d"),d=r("delaunay-triangulate"),m=r("alpha-shape"),p=r("convex-hull"),e=r("../../lib/gl_format_color").parseColorScale,f=r("../../lib/str2rgbarray"),u=r("../../components/colorscale").extractOpts,s=r("../../plots/gl3d/zip3");function l(g,h,y){this.scene=g,this.uid=y,this.mesh=h,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var o=l.prototype;function i(g){for(var h=[],y=g.length,v=0;v<y;v++)h[v]=f(g[v]);return h}function c(g,h,y,v){for(var _=[],x=h.length,T=0;T<x;T++)_[T]=g.d2l(h[T],0,v)*y;return _}function n(g){for(var h=[],y=g.length,v=0;v<y;v++)h[v]=Math.round(g[v]);return h}function a(g,h){for(var y=g.length,v=0;v<y;v++)if(g[v]<=-.5||g[v]>=h-.5)return!1;return!0}o.handlePick=function(g){if(g.object===this.mesh){var h=g.index=g.data.index;g.data._cellCenter?g.traceCoordinate=g.data.dataCoordinate:g.traceCoordinate=[this.data.x[h],this.data.y[h],this.data.z[h]];var y=this.data.hovertext||this.data.text;return Array.isArray(y)&&y[h]!==void 0?g.textLabel=y[h]:y&&(g.textLabel=y),!0}},o.update=function(g){var h=this.scene,y=h.fullSceneLayout;this.data=g;var v,_=g.x.length,x=s(c(y.xaxis,g.x,h.dataScale[0],g.xcalendar),c(y.yaxis,g.y,h.dataScale[1],g.ycalendar),c(y.zaxis,g.z,h.dataScale[2],g.zcalendar));if(g.i&&g.j&&g.k){if(g.i.length!==g.j.length||g.j.length!==g.k.length||!a(g.i,_)||!a(g.j,_)||!a(g.k,_))return;v=s(n(g.i),n(g.j),n(g.k))}else v=g.alphahull===0?p(x):g.alphahull>0?m(g.alphahull,x):function(w,C){for(var k=["x","y","z"].indexOf(w),L=[],M=C.length,P=0;P<M;P++)L[P]=[C[P][(k+1)%3],C[P][(k+2)%3]];return d(L)}(g.delaunayaxis,x);var T={positions:x,cells:v,lightPosition:[g.lightposition.x,g.lightposition.y,g.lightposition.z],ambient:g.lighting.ambient,diffuse:g.lighting.diffuse,specular:g.lighting.specular,roughness:g.lighting.roughness,fresnel:g.lighting.fresnel,vertexNormalsEpsilon:g.lighting.vertexnormalsepsilon,faceNormalsEpsilon:g.lighting.facenormalsepsilon,opacity:g.opacity,contourEnable:g.contour.show,contourColor:f(g.contour.color).slice(0,3),contourWidth:g.contour.width,useFacetNormals:g.flatshading};if(g.intensity){var A=u(g);this.color="#fff";var S=g.intensitymode;T[S+"Intensity"]=g.intensity,T[S+"IntensityBounds"]=[A.min,A.max],T.colormap=e(g)}else g.vertexcolor?(this.color=g.vertexcolor[0],T.vertexColors=i(g.vertexcolor)):g.facecolor?(this.color=g.facecolor[0],T.cellColors=i(g.facecolor)):(this.color=g.color,T.meshColor=f(g.color));this.mesh.update(T)},o.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},O.exports=function(g,h){var y=g.glplot.gl,v=t({gl:y}),_=new l(g,v,h.uid);return v._trace=_,_.update(h),g.glplot.add(v),_}},{"../../components/colorscale":662,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../../plots/gl3d/zip3":891,"alpha-shape":75,"convex-hull":141,"delaunay-triangulate":177,"gl-mesh3d":309}],1146:[function(r,O,B){var t=r("../../registry"),d=r("../../lib"),m=r("../../components/colorscale/defaults"),p=r("./attributes");O.exports=function(e,f,u,s){function l(i,c){return d.coerce(e,f,p,i,c)}function o(i){var c=i.map(function(n){var a=l(n);return a&&d.isArrayOrTypedArray(a)?a:null});return c.every(function(n){return n&&n.length===c[0].length})&&c}o(["x","y","z"])?(o(["i","j","k"]),(!f.i||f.j&&f.k)&&(!f.j||f.k&&f.i)&&(!f.k||f.i&&f.j)?(t.getComponentMethod("calendars","handleTraceDefaults")(e,f,["x","y","z"],s),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(i){l(i)}),l("contour.show")&&(l("contour.color"),l("contour.width")),"intensity"in e?(l("intensity"),l("intensitymode"),m(e,f,s,l,{prefix:"",cLetter:"c"})):(f.showscale=!1,"facecolor"in e?l("facecolor"):"vertexcolor"in e?l("vertexcolor"):l("color",u)),l("text"),l("hovertext"),l("hovertemplate"),l("xhoverformat"),l("yhoverformat"),l("zhoverformat"),f._length=null):f.visible=!1):f.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"../../registry":915,"./attributes":1143}],1147:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:r("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":880,"./attributes":1143,"./calc":1144,"./convert":1145,"./defaults":1146}],1148:[function(r,O,B){var t=r("../../lib").extendFlat,d=r("../scatter/attributes"),m=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=r("../../components/drawing/attributes").dash,e=r("../../components/fx/attributes"),f=r("../../constants/delta.js"),u=f.INCREASING.COLOR,s=f.DECREASING.COLOR,l=d.line;function o(i){return{line:{color:t({},l.color,{dflt:i}),width:l.width,dash:p,editType:"style"},editType:"style"}}O.exports={xperiod:d.xperiod,xperiod0:d.xperiod0,xperiodalignment:d.xperiodalignment,xhoverformat:m("x"),yhoverformat:m("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:t({},l.width,{}),dash:t({},p,{}),editType:"style"},increasing:o(u),decreasing:o(s),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:t({},e.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":671,"../../components/fx/attributes":681,"../../constants/delta.js":757,"../../lib":787,"../../plots/cartesian/axis_format_attributes":841,"../scatter/attributes":1202}],1149:[function(r,O,B){var t=r("../../lib"),d=t._,m=r("../../plots/cartesian/axes"),p=r("../../plots/cartesian/align_period"),e=r("../../constants/numerical").BADNUM;function f(s,l,o,i){return{o:s,h:l,l:o,c:i}}function u(s,l,o,i,c,n){for(var a=c.makeCalcdata(l,"open"),g=c.makeCalcdata(l,"high"),h=c.makeCalcdata(l,"low"),y=c.makeCalcdata(l,"close"),v=Array.isArray(l.text),_=Array.isArray(l.hovertext),x=!0,T=null,A=!!l.xperiodalignment,S=[],w=0;w<i.length;w++){var C=i[w],k=a[w],L=g[w],M=h[w],P=y[w];if(C!==e&&k!==e&&L!==e&&M!==e&&P!==e){P===k?T!==null&&P!==T&&(x=P>T):x=P>k,T=P;var D=n(k,L,M,P);D.pos=C,D.yc=(k+P)/2,D.i=w,D.dir=x?"increasing":"decreasing",D.x=D.pos,D.y=[M,L],A&&(D.orig_p=o[w]),v&&(D.tx=l.text[w]),_&&(D.htx=l.hovertext[w]),S.push(D)}else S.push({pos:C,empty:!0})}return l._extremes[c._id]=m.findExtremes(c,t.concat(h,g),{padded:!0}),S.length&&(S[0].t={labels:{open:d(s,"open:")+" ",high:d(s,"high:")+" ",low:d(s,"low:")+" ",close:d(s,"close:")+" "}}),S}O.exports={calc:function(s,l){var o=m.getFromId(s,l.xaxis),i=m.getFromId(s,l.yaxis),c=function(y,v,_){var x=_._minDiff;if(!x){var T,A=y._fullData,S=[];for(x=1/0,T=0;T<A.length;T++){var w=A[T];if(w.type==="ohlc"&&w.visible===!0&&w.xaxis===v._id){S.push(w);var C=v.makeCalcdata(w,"x");w._origX=C;var k=p(_,v,"x",C).vals;w._xcalc=k;var L=t.distinctVals(k).minDiff;L&&isFinite(L)&&(x=Math.min(x,L))}}for(x===1/0&&(x=1),T=0;T<S.length;T++)S[T]._minDiff=x}return x*_.tickwidth}(s,o,l),n=l._minDiff;l._minDiff=null;var a=l._origX;l._origX=null;var g=l._xcalc;l._xcalc=null;var h=u(s,l,a,g,i,f);return l._extremes[o._id]=m.findExtremes(o,g,{vpad:n/2}),h.length?(t.extendFlat(h[0].t,{wHover:n/2,tickLen:c}),h):[{t:{empty:!0}}]},calcCommon:u}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838}],1150:[function(r,O,B){var t=r("../../lib"),d=r("./ohlc_defaults"),m=r("../scatter/period_defaults"),p=r("./attributes");function e(f,u,s,l){s(l+".line.color"),s(l+".line.width",u.line.width),s(l+".line.dash",u.line.dash)}O.exports=function(f,u,s,l){function o(i,c){return t.coerce(f,u,p,i,c)}d(f,u,o,l)?(m(f,u,l,o,{x:!0}),o("xhoverformat"),o("yhoverformat"),o("line.width"),o("line.dash"),e(f,u,o,"increasing"),e(f,u,o,"decreasing"),o("text"),o("hovertext"),o("tickwidth"),l._requestRangeslider[u.xaxis]=!0):u.visible=!1}},{"../../lib":787,"../scatter/period_defaults":1222,"./attributes":1148,"./ohlc_defaults":1153}],1151:[function(r,O,B){var t=r("../../plots/cartesian/axes"),d=r("../../lib"),m=r("../../components/fx"),p=r("../../components/color"),e=r("../../lib").fillText,f=r("../../constants/delta.js"),u={increasing:f.INCREASING.SYMBOL,decreasing:f.DECREASING.SYMBOL};function s(i,c,n,a){var g,h,y=i.cd,v=i.xa,_=y[0].trace,x=y[0].t,T=_.type,A=T==="ohlc"?"l":"min",S=T==="ohlc"?"h":"max",w=x.bPos||0,C=x.bdPos||x.tickLen,k=x.wHover,L=Math.min(1,C/Math.abs(v.r2c(v.range[1])-v.r2c(v.range[0])));function M(K){var Z=function(H){return H.pos+w-c}(K);return m.inbox(Z-k,Z+k,g)}function P(K){var Z=K[A],H=K[S];return Z===H||m.inbox(Z-n,H-n,g)}function D(K){return(M(K)+P(K))/2}g=i.maxHoverDistance-L,h=i.maxSpikeDistance-L;var N=m.getDistanceFunction(a,M,P,D);if(m.getClosest(y,N,i),i.index===!1)return null;var U=y[i.index];if(U.empty)return null;var q=_[U.dir],X=q.line.color;return p.opacity(X)&&q.line.width?i.color=X:i.color=q.fillcolor,i.x0=v.c2p(U.pos+w-C,!0),i.x1=v.c2p(U.pos+w+C,!0),i.xLabelVal=U.orig_p!==void 0?U.orig_p:U.pos,i.spikeDistance=D(U)*h/g,i.xSpike=v.c2p(U.pos,!0),i}function l(i,c,n,a){var g=i.cd,h=i.ya,y=g[0].trace,v=g[0].t,_=[],x=s(i,c,n,a);if(!x)return[];var T=g[x.index].hi||y.hoverinfo,A=T.split("+");if(!(T==="all"||A.indexOf("y")!==-1))return[];for(var S=["high","open","close","low"],w={},C=0;C<S.length;C++){var k,L=S[C],M=y[L][x.index],P=h.c2p(M,!0);M in w?(k=w[M]).yLabel+="<br>"+v.labels[L]+t.hoverLabelText(h,M,y.yhoverformat):((k=d.extendFlat({},x)).y0=k.y1=P,k.yLabelVal=M,k.yLabel=v.labels[L]+t.hoverLabelText(h,M,y.yhoverformat),k.name="",_.push(k),w[M]=k)}return _}function o(i,c,n,a){var g=i.cd,h=i.ya,y=g[0].trace,v=g[0].t,_=s(i,c,n,a);if(!_)return[];var x=g[_.index],T=_.index=x.i,A=x.dir;function S(D){return v.labels[D]+t.hoverLabelText(h,y[D][T],y.yhoverformat)}var w=x.hi||y.hoverinfo,C=w.split("+"),k=w==="all",L=k||C.indexOf("y")!==-1,M=k||C.indexOf("text")!==-1,P=L?[S("open"),S("high"),S("low"),S("close")+"  "+u[A]]:[];return M&&e(x,y,P),_.extraText=P.join("<br>"),_.y0=_.y1=h.c2p(x.yc,!0),[_]}O.exports={hoverPoints:function(i,c,n,a){return i.cd[0].trace.hoverlabel.split?l(i,c,n,a):o(i,c,n,a)},hoverSplit:l,hoverOnPoints:o}},{"../../components/color":650,"../../components/fx":690,"../../constants/delta.js":757,"../../lib":787,"../../plots/cartesian/axes":838}],1152:[function(r,O,B){O.exports={moduleType:"trace",name:"ohlc",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc").calc,plot:r("./plot"),style:r("./style"),hoverPoints:r("./hover").hoverPoints,selectPoints:r("./select")}},{"../../plots/cartesian":852,"./attributes":1148,"./calc":1149,"./defaults":1150,"./hover":1151,"./plot":1154,"./select":1155,"./style":1156}],1153:[function(r,O,B){var t=r("../../registry"),d=r("../../lib");O.exports=function(m,p,e,f){var u=e("x"),s=e("open"),l=e("high"),o=e("low"),i=e("close");if(e("hoverlabel.split"),t.getComponentMethod("calendars","handleTraceDefaults")(m,p,["x"],f),s&&l&&o&&i){var c=Math.min(s.length,l.length,o.length,i.length);return u&&(c=Math.min(c,d.minRowLength(u))),p._length=c,c}}},{"../../lib":787,"../../registry":915}],1154:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib");O.exports=function(m,p,e,f){var u=p.yaxis,s=p.xaxis,l=!!s.rangebreaks;d.makeTraceGroups(f,e,"trace ohlc").each(function(o){var i=t.select(this),c=o[0],n=c.t;if(c.trace.visible!==!0||n.empty)i.remove();else{var a=n.tickLen,g=i.selectAll("path").data(d.identity);g.enter().append("path"),g.exit().remove(),g.attr("d",function(h){if(h.empty)return"M0,0Z";var y=s.c2p(h.pos-a,!0),v=s.c2p(h.pos+a,!0),_=l?(y+v)/2:s.c2p(h.pos,!0);return"M"+y+","+u.c2p(h.o,!0)+"H"+_+"M"+_+","+u.c2p(h.h,!0)+"V"+u.c2p(h.l,!0)+"M"+v+","+u.c2p(h.c,!0)+"H"+_})}})}},{"../../lib":787,"@plotly/d3":58}],1155:[function(r,O,B){O.exports=function(t,d){var m,p=t.cd,e=t.xaxis,f=t.yaxis,u=[],s=p[0].t.bPos||0;if(d===!1)for(m=0;m<p.length;m++)p[m].selected=0;else for(m=0;m<p.length;m++){var l=p[m];d.contains([e.c2p(l.pos+s),f.c2p(l.yc)],null,l.i,t)?(u.push({pointNumber:l.i,x:e.c2d(l.pos),y:f.c2d(l.yc)}),l.selected=1):l.selected=0}return u}},{}],1156:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/drawing"),m=r("../../components/color");O.exports=function(p,e,f){var u=f||t.select(p).selectAll("g.ohlclayer").selectAll("g.trace");u.style("opacity",function(s){return s[0].trace.opacity}),u.each(function(s){var l=s[0].trace;t.select(this).selectAll("path").each(function(o){if(!o.empty){var i=l[o.dir].line;t.select(this).style("fill","none").call(m.stroke,i.color).call(d.dashLine,i.dash,i.width).style("opacity",l.selectedpoints&&!o.selected?.3:1)}})})}},{"../../components/color":650,"../../components/drawing":672,"@plotly/d3":58}],1157:[function(r,O,B){var t=r("../../lib/extend").extendFlat,d=r("../../plots/attributes"),m=r("../../plots/font_attributes"),p=r("../../components/colorscale/attributes"),e=r("../../plots/template_attributes").hovertemplateAttrs,f=r("../../plots/domain").attributes,u=t({editType:"calc"},p("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});O.exports={domain:f({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:t({},d.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:m({editType:"calc"}),tickfont:m({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:u,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/domain":866,"../../plots/font_attributes":867,"../../plots/template_attributes":910}],1158:[function(r,O,B){var t=r("../../plots/get_data").getModuleCalcData,d=r("./plot");B.name="parcats",B.plot=function(m,p,e,f){var u=t(m.calcdata,"parcats");if(u.length){var s=u[0];d(m,s,e,f)}},B.clean=function(m,p,e,f){var u=f._has&&f._has("parcats"),s=p._has&&p._has("parcats");u&&!s&&f._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":875,"./plot":1163}],1159:[function(r,O,B){var t=r("../../lib/gup").wrap,d=r("../../components/colorscale/helpers").hasColorscale,m=r("../../components/colorscale/calc"),p=r("../../lib/filter_unique.js"),e=r("../../components/drawing"),f=r("../../lib"),u=r("fast-isnumeric");function s(i,c,n){i.valueInds.push(c),i.count+=n}function l(i,c,n){return{categoryInds:i,color:c,rawColor:n,valueInds:[],count:0}}function o(i,c,n){i.valueInds.push(c),i.count+=n}O.exports=function(i,c){var n=f.filterVisible(c.dimensions);if(n.length===0)return[];var a,g,h,y=n.map(function(Y){var $;if(Y.categoryorder==="trace")$=null;else if(Y.categoryorder==="array")$=Y.categoryarray;else{$=p(Y.values);for(var z=!0,j=0;j<$.length;j++)if(!u($[j])){z=!1;break}$.sort(z?f.sorterAsc:void 0),Y.categoryorder==="category descending"&&($=$.reverse())}return function(W,ee){ee=ee==null?[]:ee.map(function(de){return de});var J={},Q={},te=[];ee.forEach(function(de,ue){J[de]=0,Q[de]=ue});for(var ie=0;ie<W.length;ie++){var ae,he=W[ie];J[he]===void 0?(J[he]=1,ae=ee.push(he)-1,Q[he]=ae):(J[he]++,ae=Q[he]),te.push(ae)}var se=ee.map(function(de){return J[de]});return{uniqueValues:ee,uniqueCounts:se,inds:te}}(Y.values,$)});a=f.isArrayOrTypedArray(c.counts)?c.counts:[c.counts],function(Y){var $;if(function(z){for(var j=new Array(z.length),W=0;W<z.length;W++){if(z[W]<0||z[W]>=z.length||j[z[W]]!==void 0)return!1;j[z[W]]=!0}return!0}(Y.map(function(z){return z.displayindex})))for($=0;$<Y.length;$++)Y[$]._displayindex=Y[$].displayindex;else for($=0;$<Y.length;$++)Y[$]._displayindex=$}(n),n.forEach(function(Y,$){(function(z,j){z._categoryarray=j.uniqueValues,z.ticktext===null||z.ticktext===void 0?z._ticktext=[]:z._ticktext=z.ticktext.slice();for(var W=z._ticktext.length;W<j.uniqueValues.length;W++)z._ticktext.push(j.uniqueValues[W])})(Y,y[$])});var v,_=c.line;_?(d(c,"line")&&m(i,c,{vals:c.line.color,containerStr:"line",cLetter:"c"}),v=e.tryColorscale(_)):v=f.identity;var x,T,A,S,w,C=n[0].values.length,k={},L=y.map(function(Y){return Y.inds});for(h=0,x=0;x<C;x++){var M=[];for(T=0;T<L.length;T++)M.push(L[T][x]);g=a[x%a.length],h+=g;var P=(A=x,S=void 0,w=void 0,f.isArrayOrTypedArray(_.color)?w=S=_.color[A%_.color.length]:S=_.color,{color:v(S),rawColor:w}),D=M+"-"+P.rawColor;k[D]===void 0&&(k[D]=l(M,P.color,P.rawColor)),o(k[D],x,g)}var N,U=n.map(function(Y,$){return function(z,j,W,ee,J){return{dimensionInd:z,containerInd:j,displayInd:W,dimensionLabel:ee,count:J,categories:[],dragX:null}}($,Y._index,Y._displayindex,Y.label,h)});for(x=0;x<C;x++)for(g=a[x%a.length],T=0;T<U.length;T++){var q=U[T].containerInd,X=y[T].inds[x],K=U[T].categories;if(K[X]===void 0){var Z=c.dimensions[q]._categoryarray[X],H=c.dimensions[q]._ticktext[X];K[X]={dimensionInd:T,categoryInd:N=X,categoryValue:Z,displayInd:N,categoryLabel:H,valueInds:[],count:0,dragY:null}}s(K[X],x,g)}return t(function(Y,$,z){var j=Y.map(function(W){return W.categories.length}).reduce(function(W,ee){return Math.max(W,ee)});return{dimensions:Y,paths:$,trace:void 0,maxCats:j,count:z}}(U,k,h))}},{"../../components/colorscale/calc":658,"../../components/colorscale/helpers":661,"../../components/drawing":672,"../../lib":787,"../../lib/filter_unique.js":778,"../../lib/gup":784,"fast-isnumeric":246}],1160:[function(r,O,B){var t=r("../../lib"),d=r("../../components/colorscale/helpers").hasColorscale,m=r("../../components/colorscale/defaults"),p=r("../../plots/domain").defaults,e=r("../../plots/array_container_defaults"),f=r("./attributes"),u=r("../parcoords/merge_length");function s(l,o){function i(v,_){return t.coerce(l,o,f.dimensions,v,_)}var c=i("values"),n=i("visible");if(c&&c.length||(n=o.visible=!1),n){i("label"),i("displayindex",o._index);var a,g=l.categoryarray,h=Array.isArray(g)&&g.length>0;h&&(a="array");var y=i("categoryorder",a);y==="array"?(i("categoryarray"),i("ticktext")):(delete l.categoryarray,delete l.ticktext),h||y!=="array"||(o.categoryorder="trace")}}O.exports=function(l,o,i,c){function n(v,_){return t.coerce(l,o,f,v,_)}var a=e(l,o,{name:"dimensions",handleItemDefaults:s}),g=function(v,_,x,T,A){A("line.shape"),A("line.hovertemplate");var S=A("line.color",T.colorway[0]);if(d(v,"line")&&t.isArrayOrTypedArray(S)){if(S.length)return A("line.colorscale"),m(v,_,T,A,{prefix:"line.",cLetter:"c"}),S.length;_.line.color=x}return 1/0}(l,o,i,c,n);p(o,c,n),Array.isArray(a)&&a.length||(o.visible=!1),u(o,a,"values",g),n("hoveron"),n("hovertemplate"),n("arrangement"),n("bundlecolors"),n("sortpaths"),n("counts");var h={family:c.font.family,size:Math.round(c.font.size),color:c.font.color};t.coerceFont(n,"labelfont",h);var y={family:c.font.family,size:Math.round(c.font.size/1.2),color:c.font.color};t.coerceFont(n,"tickfont",y)}},{"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/domain":866,"../parcoords/merge_length":1173,"./attributes":1157}],1161:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:r("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1157,"./base_plot":1158,"./calc":1159,"./defaults":1160,"./plot":1163}],1162:[function(r,O,B){var t=r("@plotly/d3"),d=r("d3-interpolate").interpolateNumber,m=r("../../plot_api/plot_api"),p=r("../../components/fx"),e=r("../../lib"),f=e.strTranslate,u=r("../../components/drawing"),s=r("tinycolor2"),l=r("../../lib/svg_text_utils");function o(z,j,W,ee){var J=z.map(K.bind(0,j,W)),Q=ee.selectAll("g.parcatslayer").data([null]);Q.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var te=Q.selectAll("g.trace.parcats").data(J,i),ie=te.enter().append("g").attr("class","trace parcats");te.attr("transform",function(be){return f(be.x,be.y)}),ie.append("g").attr("class","paths");var ae=te.select("g.paths").selectAll("path.path").data(function(be){return be.paths},i);ae.attr("fill",function(be){return be.model.color});var he=ae.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(be){return be.model.color}).attr("fill-opacity",0);_(he),ae.attr("d",function(be){return be.svgD}),he.empty()||ae.sort(n),ae.exit().remove(),ae.on("mouseover",a).on("mouseout",g).on("click",v),ie.append("g").attr("class","dimensions");var se=te.select("g.dimensions").selectAll("g.dimension").data(function(be){return be.dimensions},i);se.enter().append("g").attr("class","dimension"),se.attr("transform",function(be){return f(be.x,0)}),se.exit().remove();var de=se.selectAll("g.category").data(function(be){return be.categories},i),ue=de.enter().append("g").attr("class","category");de.attr("transform",function(be){return f(0,be.y)}),ue.append("rect").attr("class","catrect").attr("pointer-events","none"),de.select("rect.catrect").attr("fill","none").attr("width",function(be){return be.width}).attr("height",function(be){return be.height}),T(ue);var ve=de.selectAll("rect.bandrect").data(function(be){return be.bands},i);ve.each(function(){e.raiseToTop(this)}),ve.attr("fill",function(be){return be.color});var ke=ve.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(be){return be.color}).attr("fill-opacity",0);ve.attr("fill",function(be){return be.color}).attr("width",function(be){return be.width}).attr("height",function(be){return be.height}).attr("y",function(be){return be.y}).attr("cursor",function(be){return be.parcatsViewModel.arrangement==="fixed"?"default":be.parcatsViewModel.arrangement==="perpendicular"?"ns-resize":"move"}),A(ke),ve.exit().remove(),ue.append("text").attr("class","catlabel").attr("pointer-events","none");var Ee=j._fullLayout.paper_bgcolor;de.select("text.catlabel").attr("text-anchor",function(be){return c(be)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",l.makeTextShadow(Ee)).style("fill","rgb(0, 0, 0)").attr("x",function(be){return c(be)?be.width+5:-5}).attr("y",function(be){return be.height/2}).text(function(be){return be.model.categoryLabel}).each(function(be){u.font(t.select(this),be.parcatsViewModel.categorylabelfont),l.convertToTspans(t.select(this),j)}),ue.append("text").attr("class","dimlabel"),de.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(be){return be.parcatsViewModel.arrangement==="fixed"?"default":"ew-resize"}).attr("x",function(be){return be.width/2}).attr("y",-5).text(function(be,xe){return xe===0?be.parcatsViewModel.model.dimensions[be.model.dimensionInd].dimensionLabel:null}).each(function(be){u.font(t.select(this),be.parcatsViewModel.labelfont)}),de.selectAll("rect.bandrect").on("mouseover",L).on("mouseout",M),de.exit().remove(),se.call(t.behavior.drag().origin(function(be){return{x:be.x,y:0}}).on("dragstart",P).on("drag",D).on("dragend",N)),te.each(function(be){be.traceSelection=t.select(this),be.pathSelection=t.select(this).selectAll("g.paths").selectAll("path.path"),be.dimensionSelection=t.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),te.exit().remove()}function i(z){return z.key}function c(z){var j=z.parcatsViewModel.dimensions.length,W=z.parcatsViewModel.dimensions[j-1].model.dimensionInd;return z.model.dimensionInd===W}function n(z,j){return z.model.rawColor>j.model.rawColor?1:z.model.rawColor<j.model.rawColor?-1:0}function a(z){if(!z.parcatsViewModel.dragDimension&&z.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){e.raiseToTop(this),x(t.select(this));var j=h(z),W=y(z);if(z.parcatsViewModel.graphDiv.emit("plotly_hover",{points:j,event:t.event,constraints:W}),z.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var ee,J,Q,te=t.mouse(this)[0],ie=z.parcatsViewModel.graphDiv,ae=z.parcatsViewModel.trace,he=ie._fullLayout,se=he._paperdiv.node().getBoundingClientRect(),de=z.parcatsViewModel.graphDiv.getBoundingClientRect();for(Q=0;Q<z.leftXs.length-1;Q++)if(z.leftXs[Q]+z.dimWidths[Q]-2<=te&&te<=z.leftXs[Q+1]+2){var ue=z.parcatsViewModel.dimensions[Q],ve=z.parcatsViewModel.dimensions[Q+1];ee=(ue.x+ue.width+ve.x)/2,J=(z.topYs[Q]+z.topYs[Q+1]+z.height)/2;break}var ke=z.parcatsViewModel.x+ee,Ee=z.parcatsViewModel.y+J,be=s.mostReadable(z.model.color,["black","white"]),xe=z.model.count,ce=xe/z.parcatsViewModel.model.count,ge={countLabel:xe,probabilityLabel:ce.toFixed(3)},we=[];z.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&we.push(["Count:",ge.countLabel].join(" ")),z.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&we.push(["P:",ge.probabilityLabel].join(" "));var Me=we.join("<br>"),Se=t.mouse(ie)[0];p.loneHover({trace:ae,x:ke-se.left+de.left,y:Ee-se.top+de.top,text:Me,color:z.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:be,idealAlign:Se<ke?"right":"left",hovertemplate:(ae.line||{}).hovertemplate,hovertemplateLabels:ge,eventData:[{data:ae._input,fullData:ae,count:xe,probability:ce}]},{container:he._hoverlayer.node(),outerContainer:he._paper.node(),gd:ie})}}}function g(z){if(!z.parcatsViewModel.dragDimension&&(_(t.select(this)),p.loneUnhover(z.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),z.parcatsViewModel.pathSelection.sort(n),z.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1)){var j=h(z),W=y(z);z.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:j,event:t.event,constraints:W})}}function h(z){for(var j=[],W=U(z.parcatsViewModel),ee=0;ee<z.model.valueInds.length;ee++){var J=z.model.valueInds[ee];j.push({curveNumber:W,pointNumber:J})}return j}function y(z){for(var j={},W=z.parcatsViewModel.model.dimensions,ee=0;ee<W.length;ee++){var J=W[ee],Q=J.categories[z.model.categoryInds[ee]];j[J.containerInd]=Q.categoryValue}return z.model.rawColor!==void 0&&(j.color=z.model.rawColor),j}function v(z){if(z.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var j=h(z),W=y(z);z.parcatsViewModel.graphDiv.emit("plotly_click",{points:j,event:t.event,constraints:W})}}function _(z){z.attr("fill",function(j){return j.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function x(z){z.attr("fill-opacity",.8).attr("stroke",function(j){return s.mostReadable(j.model.color,["black","white"])}).attr("stroke-width",.3)}function T(z){z.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function A(z){z.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function S(z){var j=z.parcatsViewModel.pathSelection,W=z.categoryViewModel.model.dimensionInd,ee=z.categoryViewModel.model.categoryInd;return j.filter(function(J){return J.model.categoryInds[W]===ee&&J.model.color===z.color})}function w(z,j,W){var ee=t.select(z).datum(),J=ee.categoryViewModel.model,Q=ee.parcatsViewModel.graphDiv,te=t.select(z.parentNode).selectAll("rect.bandrect"),ie=[];te.each(function(he){S(he).each(function(se){Array.prototype.push.apply(ie,h(se))})});var ae={};ae[J.dimensionInd]=J.categoryValue,Q.emit(j,{points:ie,event:W,constraints:ae})}function C(z,j,W){var ee=t.select(z).datum(),J=ee.categoryViewModel.model,Q=ee.parcatsViewModel.graphDiv,te=S(ee),ie=[];te.each(function(he){Array.prototype.push.apply(ie,h(he))});var ae={};ae[J.dimensionInd]=J.categoryValue,ee.rawColor!==void 0&&(ae.color=ee.rawColor),Q.emit(j,{points:ie,event:W,constraints:ae})}function k(z,j,W){z._fullLayout._calcInverseTransform(z);var ee,J,Q=z._fullLayout._invScaleX,te=z._fullLayout._invScaleY,ie=t.select(W.parentNode).select("rect.catrect"),ae=ie.node().getBoundingClientRect(),he=ie.datum(),se=he.parcatsViewModel,de=se.model.dimensions[he.model.dimensionInd],ue=se.trace,ve=ae.top+ae.height/2;se.dimensions.length>1&&de.displayInd===se.dimensions.length-1?(ee=ae.left,J="left"):(ee=ae.left+ae.width,J="right");var ke=he.model.count,Ee=he.model.categoryLabel,be=ke/he.parcatsViewModel.model.count,xe={countLabel:ke,categoryLabel:Ee,probabilityLabel:be.toFixed(3)},ce=[];he.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&ce.push(["Count:",xe.countLabel].join(" ")),he.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&ce.push(["P("+xe.categoryLabel+"):",xe.probabilityLabel].join(" "));var ge=ce.join("<br>");return{trace:ue,x:Q*(ee-j.left),y:te*(ve-j.top),text:ge,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:J,hovertemplate:ue.hovertemplate,hovertemplateLabels:xe,eventData:[{data:ue._input,fullData:ue,count:ke,category:Ee,probability:be}]}}function L(z){if(!z.parcatsViewModel.dragDimension&&z.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){if(t.mouse(this)[1]<-1)return;var j,W=z.parcatsViewModel.graphDiv,ee=W._fullLayout,J=ee._paperdiv.node().getBoundingClientRect(),Q=z.parcatsViewModel.hoveron;Q==="color"?(function(te){var ie=t.select(te).datum(),ae=S(ie);x(ae),ae.each(function(){e.raiseToTop(this)}),t.select(te.parentNode).selectAll("rect.bandrect").filter(function(he){return he.color===ie.color}).each(function(){e.raiseToTop(this),t.select(this).attr("stroke","black").attr("stroke-width",1.5)})}(this),C(this,"plotly_hover",t.event)):(function(te){t.select(te.parentNode).selectAll("rect.bandrect").each(function(ie){var ae=S(ie);x(ae),ae.each(function(){e.raiseToTop(this)})}),t.select(te.parentNode).select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}(this),w(this,"plotly_hover",t.event)),z.parcatsViewModel.hoverinfoItems.indexOf("none")===-1&&(Q==="category"?j=k(W,J,this):Q==="color"?j=function(te,ie,ae){te._fullLayout._calcInverseTransform(te);var he,se,de=te._fullLayout._invScaleX,ue=te._fullLayout._invScaleY,ve=ae.getBoundingClientRect(),ke=t.select(ae).datum(),Ee=ke.categoryViewModel,be=Ee.parcatsViewModel,xe=be.model.dimensions[Ee.model.dimensionInd],ce=be.trace,ge=ve.y+ve.height/2;be.dimensions.length>1&&xe.displayInd===be.dimensions.length-1?(he=ve.left,se="left"):(he=ve.left+ve.width,se="right");var we=Ee.model.categoryLabel,Me=ke.parcatsViewModel.model.count,Se=0;ke.categoryViewModel.bands.forEach(function(st){st.color===ke.color&&(Se+=st.count)});var ze=Ee.model.count,Fe=0;be.pathSelection.each(function(st){st.model.color===ke.color&&(Fe+=st.model.count)});var Ye=Se/Me,rt=Se/Fe,Oe=Se/ze,je={countLabel:Me,categoryLabel:we,probabilityLabel:Ye.toFixed(3)},We=[];Ee.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&We.push(["Count:",je.countLabel].join(" ")),Ee.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&(We.push("P(color \u2229 "+we+"): "+je.probabilityLabel),We.push("P("+we+" | color): "+rt.toFixed(3)),We.push("P(color | "+we+"): "+Oe.toFixed(3)));var qe=We.join("<br>"),Qe=s.mostReadable(ke.color,["black","white"]);return{trace:ce,x:de*(he-ie.left),y:ue*(ge-ie.top),text:qe,color:ke.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:Qe,fontSize:10,idealAlign:se,hovertemplate:ce.hovertemplate,hovertemplateLabels:je,eventData:[{data:ce._input,fullData:ce,category:we,count:Me,probability:Ye,categorycount:ze,colorcount:Fe,bandcolorcount:Se}]}}(W,J,this):Q==="dimension"&&(j=function(te,ie,ae){var he=[];return t.select(ae.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){he.push(k(te,ie,this))}),he}(W,J,this)),j&&p.loneHover(j,{container:ee._hoverlayer.node(),outerContainer:ee._paper.node(),gd:W}))}}function M(z){var j=z.parcatsViewModel;!j.dragDimension&&(_(j.pathSelection),T(j.dimensionSelection.selectAll("g.category")),A(j.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),p.loneUnhover(j.graphDiv._fullLayout._hoverlayer.node()),j.pathSelection.sort(n),j.hoverinfoItems.indexOf("skip")===-1)&&(z.parcatsViewModel.hoveron==="color"?C(this,"plotly_unhover",t.event):w(this,"plotly_unhover",t.event))}function P(z){z.parcatsViewModel.arrangement!=="fixed"&&(z.dragDimensionDisplayInd=z.model.displayInd,z.initialDragDimensionDisplayInds=z.parcatsViewModel.model.dimensions.map(function(j){return j.displayInd}),z.dragHasMoved=!1,z.dragCategoryDisplayInd=null,t.select(this).selectAll("g.category").select("rect.catrect").each(function(j){var W=t.mouse(this)[0],ee=t.mouse(this)[1];-2<=W&&W<=j.width+2&&-2<=ee&&ee<=j.height+2&&(z.dragCategoryDisplayInd=j.model.displayInd,z.initialDragCategoryDisplayInds=z.model.categories.map(function(J){return J.displayInd}),j.model.dragY=j.y,e.raiseToTop(this.parentNode),t.select(this.parentNode).selectAll("rect.bandrect").each(function(J){J.y<ee&&ee<=J.y+J.height&&(z.potentialClickBand=this)}))}),z.parcatsViewModel.dragDimension=z,p.loneUnhover(z.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function D(z){if(z.parcatsViewModel.arrangement!=="fixed"&&(z.dragHasMoved=!0,z.dragDimensionDisplayInd!==null)){var j=z.dragDimensionDisplayInd,W=j-1,ee=j+1,J=z.parcatsViewModel.dimensions[j];if(z.dragCategoryDisplayInd!==null){var Q=J.categories[z.dragCategoryDisplayInd];Q.model.dragY+=t.event.dy;var te=Q.model.dragY,ie=Q.model.displayInd,ae=J.categories,he=ae[ie-1],se=ae[ie+1];he!==void 0&&te<he.y+he.height/2&&(Q.model.displayInd=he.model.displayInd,he.model.displayInd=ie),se!==void 0&&te+Q.height>se.y+se.height/2&&(Q.model.displayInd=se.model.displayInd,se.model.displayInd=ie),z.dragCategoryDisplayInd=Q.model.displayInd}if(z.dragCategoryDisplayInd===null||z.parcatsViewModel.arrangement==="freeform"){J.model.dragX=t.event.x;var de=z.parcatsViewModel.dimensions[W],ue=z.parcatsViewModel.dimensions[ee];de!==void 0&&J.model.dragX<de.x+de.width&&(J.model.displayInd=de.model.displayInd,de.model.displayInd=j),ue!==void 0&&J.model.dragX+J.width>ue.x&&(J.model.displayInd=ue.model.displayInd,ue.model.displayInd=z.dragDimensionDisplayInd),z.dragDimensionDisplayInd=J.model.displayInd}Y(z.parcatsViewModel),H(z.parcatsViewModel),X(z.parcatsViewModel),q(z.parcatsViewModel)}}function N(z){if(z.parcatsViewModel.arrangement!=="fixed"&&z.dragDimensionDisplayInd!==null){t.select(this).selectAll("text").attr("font-weight","normal");var j={},W=U(z.parcatsViewModel),ee=z.parcatsViewModel.model.dimensions.map(function(se){return se.displayInd}),J=z.initialDragDimensionDisplayInds.some(function(se,de){return se!==ee[de]});J&&ee.forEach(function(se,de){var ue=z.parcatsViewModel.model.dimensions[de].containerInd;j["dimensions["+ue+"].displayindex"]=se});var Q=!1;if(z.dragCategoryDisplayInd!==null){var te=z.model.categories.map(function(se){return se.displayInd});if(Q=z.initialDragCategoryDisplayInds.some(function(se,de){return se!==te[de]})){var ie=z.model.categories.slice().sort(function(se,de){return se.displayInd-de.displayInd}),ae=ie.map(function(se){return se.categoryValue}),he=ie.map(function(se){return se.categoryLabel});j["dimensions["+z.model.containerInd+"].categoryarray"]=[ae],j["dimensions["+z.model.containerInd+"].ticktext"]=[he],j["dimensions["+z.model.containerInd+"].categoryorder"]="array"}}z.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1&&!z.dragHasMoved&&z.potentialClickBand&&(z.parcatsViewModel.hoveron==="color"?C(z.potentialClickBand,"plotly_click",t.event.sourceEvent):w(z.potentialClickBand,"plotly_click",t.event.sourceEvent)),z.model.dragX=null,z.dragCategoryDisplayInd!==null&&(z.parcatsViewModel.dimensions[z.dragDimensionDisplayInd].categories[z.dragCategoryDisplayInd].model.dragY=null,z.dragCategoryDisplayInd=null),z.dragDimensionDisplayInd=null,z.parcatsViewModel.dragDimension=null,z.dragHasMoved=null,z.potentialClickBand=null,Y(z.parcatsViewModel),H(z.parcatsViewModel),t.transition().duration(300).ease("cubic-in-out").each(function(){X(z.parcatsViewModel,!0),q(z.parcatsViewModel,!0)}).each("end",function(){(J||Q)&&m.restyle(z.parcatsViewModel.graphDiv,j,[W])})}}function U(z){for(var j,W=z.graphDiv._fullData,ee=0;ee<W.length;ee++)if(z.key===W[ee].uid){j=ee;break}return j}function q(z,j){var W;j===void 0&&(j=!1),z.pathSelection.data(function(ee){return ee.paths},i),(W=z.pathSelection,j?W.transition():W).attr("d",function(ee){return ee.svgD})}function X(z,j){function W(te){return j?te.transition():te}j===void 0&&(j=!1),z.dimensionSelection.data(function(te){return te.dimensions},i);var ee=z.dimensionSelection.selectAll("g.category").data(function(te){return te.categories},i);W(z.dimensionSelection).attr("transform",function(te){return f(te.x,0)}),W(ee).attr("transform",function(te){return f(0,te.y)}),ee.select(".dimlabel").text(function(te,ie){return ie===0?te.parcatsViewModel.model.dimensions[te.model.dimensionInd].dimensionLabel:null}),ee.select(".catlabel").attr("text-anchor",function(te){return c(te)?"start":"end"}).attr("x",function(te){return c(te)?te.width+5:-5}).each(function(te){var ie,ae;c(te)?(ie=te.width+5,ae="start"):(ie=-5,ae="end"),t.select(this).selectAll("tspan").attr("x",ie).attr("text-anchor",ae)});var J=ee.selectAll("rect.bandrect").data(function(te){return te.bands},i),Q=J.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(te){return te.color}).attr("fill-opacity",0);J.attr("fill",function(te){return te.color}).attr("width",function(te){return te.width}).attr("height",function(te){return te.height}).attr("y",function(te){return te.y}),A(Q),J.each(function(){e.raiseToTop(this)}),J.exit().remove()}function K(z,j,W){var ee,J=W[0],Q=j.margin||{l:80,r:80,t:100,b:80},te=J.trace,ie=te.domain,ae=j.width,he=j.height,se=Math.floor(ae*(ie.x[1]-ie.x[0])),de=Math.floor(he*(ie.y[1]-ie.y[0])),ue=ie.x[0]*ae+Q.l,ve=j.height-ie.y[1]*j.height+Q.t,ke=te.line.shape;ee=te.hoverinfo==="all"?["count","probability"]:(te.hoverinfo||"").split("+");var Ee={trace:te,key:te.uid,model:J,x:ue,y:ve,width:se,height:de,hoveron:te.hoveron,hoverinfoItems:ee,arrangement:te.arrangement,bundlecolors:te.bundlecolors,sortpaths:te.sortpaths,labelfont:te.labelfont,categorylabelfont:te.tickfont,pathShape:ke,dragDimension:null,margin:Q,paths:[],dimensions:[],graphDiv:z,traceSelection:null,pathSelection:null,dimensionSelection:null};return J.dimensions&&(Y(Ee),H(Ee)),Ee}function Z(z,j,W,ee,J){var Q,te,ie=[],ae=[];for(te=0;te<W.length-1;te++)Q=d(W[te]+z[te],z[te+1]),ie.push(Q(J)),ae.push(Q(1-J));var he="M "+z[0]+","+j[0];for(he+="l"+W[0]+",0 ",te=1;te<W.length;te++)he+="C"+ie[te-1]+","+j[te-1]+" "+ae[te-1]+","+j[te]+" "+z[te]+","+j[te],he+="l"+W[te]+",0 ";for(he+="l0,"+ee+" ",he+="l -"+W[W.length-1]+",0 ",te=W.length-2;te>=0;te--)he+="C"+ae[te]+","+(j[te+1]+ee)+" "+ie[te]+","+(j[te]+ee)+" "+(z[te]+W[te])+","+(j[te]+ee),he+="l-"+W[te]+",0 ";return he+="Z"}function H(z){var j=z.dimensions,W=z.model,ee=j.map(function(We){return We.categories.map(function(qe){return qe.y})}),J=z.model.dimensions.map(function(We){return We.categories.map(function(qe){return qe.displayInd})}),Q=z.model.dimensions.map(function(We){return We.displayInd}),te=z.dimensions.map(function(We){return We.model.dimensionInd}),ie=j.map(function(We){return We.x}),ae=j.map(function(We){return We.width}),he=[];for(var se in W.paths)W.paths.hasOwnProperty(se)&&he.push(W.paths[se]);function de(We){var qe=We.categoryInds.map(function(Qe,st){return J[st][Qe]});return te.map(function(Qe){return qe[Qe]})}he.sort(function(We,qe){var Qe=de(We),st=de(qe);return z.sortpaths==="backward"&&(Qe.reverse(),st.reverse()),Qe.push(We.valueInds[0]),st.push(qe.valueInds[0]),z.bundlecolors&&(Qe.unshift(We.rawColor),st.unshift(qe.rawColor)),Qe<st?-1:Qe>st?1:0});for(var ue=new Array(he.length),ve=j[0].model.count,ke=j[0].categories.map(function(We){return We.height}).reduce(function(We,qe){return We+qe}),Ee=0;Ee<he.length;Ee++){var be,xe=he[Ee];be=ve>0?ke*(xe.count/ve):0;for(var ce,ge=new Array(ee.length),we=0;we<xe.categoryInds.length;we++){var Me=xe.categoryInds[we],Se=J[we][Me],ze=Q[we];ge[ze]=ee[ze][Se],ee[ze][Se]+=be;var Fe=z.dimensions[ze].categories[Se],Ye=Fe.bands.length,rt=Fe.bands[Ye-1];if(rt===void 0||xe.rawColor!==rt.rawColor){var Oe=rt===void 0?0:rt.y+rt.height;Fe.bands.push({key:Oe,color:xe.color,rawColor:xe.rawColor,height:be,width:Fe.width,count:xe.count,y:Oe,categoryViewModel:Fe,parcatsViewModel:z})}else{var je=Fe.bands[Ye-1];je.height+=be,je.count+=xe.count}}ce=z.pathShape==="hspline"?Z(ie,ge,ae,be,.5):Z(ie,ge,ae,be,0),ue[Ee]={key:xe.valueInds[0],model:xe,height:be,leftXs:ie,topYs:ge,dimWidths:ae,svgD:ce,parcatsViewModel:z}}z.paths=ue}function Y(z){var j=z.model.dimensions.map(function(te){return{displayInd:te.displayInd,dimensionInd:te.dimensionInd}});j.sort(function(te,ie){return te.displayInd-ie.displayInd});var W=[];for(var ee in j){var J=j[ee].dimensionInd,Q=z.model.dimensions[J];W.push($(z,Q))}z.dimensions=W}function $(z,j){var W,ee=z.model.dimensions.length,J=j.displayInd;W=40+(ee>1?(z.width-80-16)/(ee-1):0)*J;var Q,te,ie,ae,he,se=[],de=z.model.maxCats,ue=j.categories.length,ve=j.count,ke=z.height-8*(de-1),Ee=8*(de-ue)/2,be=j.categories.map(function(xe){return{displayInd:xe.displayInd,categoryInd:xe.categoryInd}});for(be.sort(function(xe,ce){return xe.displayInd-ce.displayInd}),he=0;he<ue;he++)ae=be[he].categoryInd,te=j.categories[ae],Q=ve>0?te.count/ve*ke:0,ie={key:te.valueInds[0],model:te,width:16,height:Q,y:te.dragY!==null?te.dragY:Ee,bands:[],parcatsViewModel:z},Ee=Ee+Q+8,se.push(ie);return{key:j.dimensionInd,x:j.dragX!==null?j.dragX:W,y:0,width:16,model:j,categories:se,parcatsViewModel:z,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}O.exports=function(z,j,W,ee){o(W,z,ee,j)}},{"../../components/drawing":672,"../../components/fx":690,"../../lib":787,"../../lib/svg_text_utils":813,"../../plot_api/plot_api":824,"@plotly/d3":58,"d3-interpolate":168,tinycolor2:583}],1163:[function(r,O,B){var t=r("./parcats");O.exports=function(d,m,p,e){var f=d._fullLayout,u=f._paper,s=f._size;t(d,u,m,{width:s.w,height:s.h,margin:{t:s.t,r:s.r,b:s.b,l:s.l}},p,e)}},{"./parcats":1162}],1164:[function(r,O,B){var t=r("../../components/colorscale/attributes"),d=r("../../plots/cartesian/layout_attributes"),m=r("../../plots/font_attributes"),p=r("../../plots/domain").attributes,e=r("../../lib/extend").extendFlat,f=r("../../plot_api/plot_template").templatedArray;O.exports={domain:p({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:m({editType:"plot"}),tickfont:m({editType:"plot"}),rangefont:m({editType:"plot"}),dimensions:f("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},d.tickvals,{editType:"plot"}),ticktext:e({},d.ticktext,{editType:"plot"}),tickformat:e({},d.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},t("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"}))}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/plot_template":827,"../../plots/cartesian/layout_attributes":853,"../../plots/domain":866,"../../plots/font_attributes":867}],1165:[function(r,O,B){var t=r("./constants"),d=r("@plotly/d3"),m=r("../../lib/gup").keyFun,p=r("../../lib/gup").repeat,e=r("../../lib").sorterAsc,f=r("../../lib").strTranslate,u=t.bar.snapRatio;function s(k,L){return k*(1-u)+L*u}var l=t.bar.snapClose;function o(k,L){return k*(1-l)+L*l}function i(k,L,M,P){if(function($,z){for(var j=0;j<z.length;j++)if($>=z[j][0]&&$<=z[j][1])return!0;return!1}(M,P))return M;var D=k?-1:1,N=0,U=L.length-1;if(D<0){var q=N;N=U,U=q}for(var X=L[N],K=X,Z=N;D*Z<D*U;Z+=D){var H=Z+D,Y=L[H];if(D*M<D*o(X,Y))return s(X,K);if(D*M<D*Y||H===U)return s(Y,X);K=X,X=Y}}function c(k){k.attr("x",-t.bar.captureWidth/2).attr("width",t.bar.captureWidth)}function n(k){k.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function a(k){if(!k.brush.filterSpecified)return"0,"+k.height;for(var L,M,P,D=g(k.brush.filter.getConsolidated(),k.height),N=[0],U=D.length?D[0][0]:null,q=0;q<D.length;q++)M=(L=D[q])[1]-L[0],N.push(U),N.push(M),(P=q+1)<D.length&&(U=D[P][0]-L[1]);return N.push(k.height),N}function g(k,L){return k.map(function(M){return M.map(function(P){return Math.max(0,P*L)}).sort(e)})}function h(){d.select(document.body).style("cursor",null)}function y(k){k.attr("stroke-dasharray",a)}function v(k,L){var M=d.select(k).selectAll(".highlight, .highlight-shadow");y(L?M.transition().duration(t.bar.snapDuration).each("end",L):M)}function _(k,L){var M,P=k.brush,D=NaN,N={};if(P.filterSpecified){var U=k.height,q=P.filter.getConsolidated(),X=g(q,U),K=NaN,Z=NaN,H=NaN;for(M=0;M<=X.length;M++){var Y=X[M];if(Y&&Y[0]<=L&&L<=Y[1]){K=M;break}if(Z=M?M-1:NaN,Y&&Y[0]>L){H=M;break}}if(D=K,isNaN(D)&&(D=isNaN(Z)||isNaN(H)?isNaN(Z)?H:Z:L-X[Z][1]<X[H][0]-L?Z:H),!isNaN(D)){var $=X[D],z=function(J,Q){var te=t.bar.handleHeight;if(!(Q>J[1]+te||Q<J[0]-te))return Q>=.9*J[1]+.1*J[0]?"n":Q<=.9*J[0]+.1*J[1]?"s":"ns"}($,L);z&&(N.interval=q[D],N.intervalPix=$,N.region=z)}}if(k.ordinal&&!N.region){var j=k.unitTickvals,W=k.unitToPaddedPx.invert(L);for(M=0;M<j.length;M++){var ee=[.25*j[Math.max(M-1,0)]+.75*j[M],.25*j[Math.min(M+1,j.length-1)]+.75*j[M]];if(W>=ee[0]&&W<=ee[1]){N.clickableOrdinalRange=ee;break}}}return N}function x(k,L){d.event.sourceEvent.stopPropagation();var M=L.height-d.mouse(k)[1]-2*t.verticalPadding,P=L.brush.svgBrush;P.wasDragged=!0,P._dragging=!0,P.grabbingBar?P.newExtent=[M-P.grabPoint,M+P.barLength-P.grabPoint].map(L.unitToPaddedPx.invert):P.newExtent=[P.startExtent,L.unitToPaddedPx.invert(M)].sort(e),L.brush.filterSpecified=!0,P.extent=P.stayingIntervals.concat([P.newExtent]),P.brushCallback(L),v(k.parentNode)}function T(k,L){var M=_(L,L.height-d.mouse(k)[1]-2*t.verticalPadding),P="crosshair";M.clickableOrdinalRange?P="pointer":M.region&&(P=M.region+"-resize"),d.select(document.body).style("cursor",P)}function A(k){k.on("mousemove",function(L){d.event.preventDefault(),L.parent.inBrushDrag||T(this,L)}).on("mouseleave",function(L){L.parent.inBrushDrag||h()}).call(d.behavior.drag().on("dragstart",function(L){(function(M,P){d.event.sourceEvent.stopPropagation();var D=P.height-d.mouse(M)[1]-2*t.verticalPadding,N=P.unitToPaddedPx.invert(D),U=P.brush,q=_(P,D),X=q.interval,K=U.svgBrush;if(K.wasDragged=!1,K.grabbingBar=q.region==="ns",K.grabbingBar){var Z=X.map(P.unitToPaddedPx);K.grabPoint=D-Z[0]-t.verticalPadding,K.barLength=Z[1]-Z[0]}K.clickableOrdinalRange=q.clickableOrdinalRange,K.stayingIntervals=P.multiselect&&U.filterSpecified?U.filter.getConsolidated():[],X&&(K.stayingIntervals=K.stayingIntervals.filter(function(H){return H[0]!==X[0]&&H[1]!==X[1]})),K.startExtent=q.region?X[q.region==="s"?1:0]:N,P.parent.inBrushDrag=!0,K.brushStartCallback()})(this,L)}).on("drag",function(L){x(this,L)}).on("dragend",function(L){(function(M,P){var D=P.brush,N=D.filter,U=D.svgBrush;U._dragging||(T(M,P),x(M,P),P.brush.svgBrush.wasDragged=!1),U._dragging=!1,d.event.sourceEvent.stopPropagation();var q=U.grabbingBar;if(U.grabbingBar=!1,U.grabLocation=void 0,P.parent.inBrushDrag=!1,h(),!U.wasDragged)return U.wasDragged=void 0,U.clickableOrdinalRange?D.filterSpecified&&P.multiselect?U.extent.push(U.clickableOrdinalRange):(U.extent=[U.clickableOrdinalRange],D.filterSpecified=!0):q?(U.extent=U.stayingIntervals,U.extent.length===0&&w(D)):w(D),U.brushCallback(P),v(M.parentNode),void U.brushEndCallback(D.filterSpecified?N.getConsolidated():[]);var X=function(){N.set(N.getConsolidated())};if(P.ordinal){var K=P.unitTickvals;K[K.length-1]<K[0]&&K.reverse(),U.newExtent=[i(0,K,U.newExtent[0],U.stayingIntervals),i(1,K,U.newExtent[1],U.stayingIntervals)];var Z=U.newExtent[1]>U.newExtent[0];U.extent=U.stayingIntervals.concat(Z?[U.newExtent]:[]),U.extent.length||w(D),U.brushCallback(P),Z?v(M.parentNode,X):(X(),v(M.parentNode))}else X();U.brushEndCallback(D.filterSpecified?N.getConsolidated():[])})(this,L)}))}function S(k,L){return k[0]-L[0]}function w(k){k.filterSpecified=!1,k.svgBrush.extent=[[-1/0,1/0]]}function C(k){for(var L,M=k.slice(),P=[],D=M.shift();D;){for(L=D.slice();(D=M.shift())&&D[0]<=L[1];)L[1]=Math.max(L[1],D[1]);P.push(L)}return P.length===1&&P[0][0]>P[0][1]&&(P=[]),P}O.exports={makeBrush:function(k,L,M,P,D,N){var U,q=function(){var X,K,Z=[];return{set:function(H){(Z=H.map(function(Y){return Y.slice().sort(e)}).sort(S)).length===1&&Z[0][0]===-1/0&&Z[0][1]===1/0&&(Z=[[0,-1]]),X=C(Z),K=Z.reduce(function(Y,$){return[Math.min(Y[0],$[0]),Math.max(Y[1],$[1])]},[1/0,-1/0])},get:function(){return Z.slice()},getConsolidated:function(){return X},getBounds:function(){return K}}}();return q.set(M),{filter:q,filterSpecified:L,svgBrush:{extent:[],brushStartCallback:P,brushCallback:(U=D,function(X){var K=X.brush,Z=function(H){return H.svgBrush.extent.map(function(Y){return Y.slice()})}(K).slice();K.filter.set(Z),U()}),brushEndCallback:N}}},ensureAxisBrush:function(k,L){var M=k.selectAll("."+t.cn.axisBrush).data(p,m);M.enter().append("g").classed(t.cn.axisBrush,!0),function(P,D){var N=P.selectAll(".background").data(p);N.enter().append("rect").classed("background",!0).call(c).call(n).style("pointer-events","auto").attr("transform",f(0,t.verticalPadding)),N.call(A).attr("height",function(X){return X.height-t.verticalPadding});var U=P.selectAll(".highlight-shadow").data(p);U.enter().append("line").classed("highlight-shadow",!0).attr("x",-t.bar.width/2).attr("stroke-width",t.bar.width+t.bar.strokeWidth).attr("stroke",D).attr("opacity",t.bar.strokeOpacity).attr("stroke-linecap","butt"),U.attr("y1",function(X){return X.height}).call(y);var q=P.selectAll(".highlight").data(p);q.enter().append("line").classed("highlight",!0).attr("x",-t.bar.width/2).attr("stroke-width",t.bar.width-t.bar.strokeWidth).attr("stroke",t.bar.fillColor).attr("opacity",t.bar.fillOpacity).attr("stroke-linecap","butt"),q.attr("y1",function(X){return X.height}).call(y)}(M,L)},cleanRanges:function(k,L){if(Array.isArray(k[0])?(k=k.map(function(P){return P.sort(e)}),k=L.multiselect?C(k.sort(S)):[k[0]]):k=[k.sort(e)],L.tickvals){var M=L.tickvals.slice().sort(e);if(!(k=k.map(function(P){var D=[i(0,M,P[0],[]),i(1,M,P[1],[])];if(D[1]>D[0])return D}).filter(function(P){return P})).length)return}return k.length>1?k:k[0]}}},{"../../lib":787,"../../lib/gup":784,"./constants":1168,"@plotly/d3":58}],1166:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../plots/get_data").getModuleCalcData,m=r("./plot"),p=r("../../constants/xmlns_namespaces");B.name="parcoords",B.plot=function(e){var f=d(e.calcdata,"parcoords")[0];f.length&&m(e,f)},B.clean=function(e,f,u,s){var l=s._has&&s._has("parcoords"),o=f._has&&f._has("parcoords");l&&!o&&(s._paperdiv.selectAll(".parcoords").remove(),s._glimages.selectAll("*").remove())},B.toSVG=function(e){var f=e._fullLayout._glimages,u=t.select(e).selectAll(".svg-container");u.filter(function(s,l){return l===u.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var s=this.toDataURL("image/png");f.append("svg:image").attr({xmlns:p.svg,"xlink:href":s,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})}),window.setTimeout(function(){t.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":764,"../../plots/get_data":875,"./plot":1175,"@plotly/d3":58}],1167:[function(r,O,B){var t=r("../../lib").isArrayOrTypedArray,d=r("../../components/colorscale"),m=r("../../lib/gup").wrap;O.exports=function(p,e){var f,u;return d.hasColorscale(e,"line")&&t(e.line.color)?(f=e.line.color,u=d.extractOpts(e.line).colorscale,d.calc(p,e,{vals:f,containerStr:"line",cLetter:"c"})):(f=function(s){for(var l=new Array(s),o=0;o<s;o++)l[o]=.5;return l}(e._length),u=[[0,e.line.color],[1,e.line.color]]),m({lineColor:f,cscale:u})}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gup":784}],1168:[function(r,O,B){O.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,deselectedLineColor:"#777",bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],1169:[function(r,O,B){var t=r("../../lib"),d=r("../../components/colorscale/helpers").hasColorscale,m=r("../../components/colorscale/defaults"),p=r("../../plots/domain").defaults,e=r("../../plots/array_container_defaults"),f=r("../../plots/cartesian/axes"),u=r("./attributes"),s=r("./axisbrush"),l=r("./constants").maxDimensionCount,o=r("./merge_length");function i(c,n,a,g){function h(T,A){return t.coerce(c,n,u.dimensions,T,A)}var y=h("values"),v=h("visible");if(y&&y.length||(v=n.visible=!1),v){h("label"),h("tickvals"),h("ticktext"),h("tickformat");var _=h("range");n._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:_},f.setConvert(n._ax,g.layout),h("multiselect");var x=h("constraintrange");x&&(n.constraintrange=s.cleanRanges(x,n))}}O.exports=function(c,n,a,g){function h(T,A){return t.coerce(c,n,u,T,A)}var y=c.dimensions;Array.isArray(y)&&y.length>l&&(t.log("parcoords traces support up to "+l+" dimensions at the moment"),y.splice(l));var v=e(c,n,{name:"dimensions",layout:g,handleItemDefaults:i}),_=function(T,A,S,w,C){var k=C("line.color",S);if(d(T,"line")&&t.isArrayOrTypedArray(k)){if(k.length)return C("line.colorscale"),m(T,A,w,C,{prefix:"line.",cLetter:"c"}),k.length;A.line.color=S}return 1/0}(c,n,a,g,h);p(n,g,h),Array.isArray(v)&&v.length||(n.visible=!1),o(n,v,"values",_);var x={family:g.font.family,size:Math.round(g.font.size/1.2),color:g.font.color};t.coerceFont(h,"labelfont",x),t.coerceFont(h,"tickfont",x),t.coerceFont(h,"rangefont",x),h("labelangle"),h("labelside")}},{"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"../../plots/domain":866,"./attributes":1164,"./axisbrush":1165,"./constants":1168,"./merge_length":1173}],1170:[function(r,O,B){var t=r("../../lib").isTypedArray;B.convertTypedArray=function(d){return t(d)?Array.prototype.slice.call(d):d},B.isOrdinal=function(d){return!!d.tickvals},B.isVisible=function(d){return d.visible||!("visible"in d)}},{"../../lib":787}],1171:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:r("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":1164,"./base_plot":1166,"./calc":1167,"./defaults":1169,"./plot":1175}],1172:[function(r,O,B){var t=r("glslify"),d=t([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

attribute vec4 p01_04, p05_08, p09_12, p13_16,
               p17_20, p21_24, p25_28, p29_32,
               p33_36, p37_40, p41_44, p45_48,
               p49_52, p53_56, p57_60, colors;

uniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,
             loA, hiA, loB, hiB, loC, hiC, loD, hiD;

uniform vec2 resolution, viewBoxPos, viewBoxSize;
uniform float maskHeight;
uniform float drwLayer; // 0: context, 1: focus, 2: pick
uniform vec4 contextColor;
uniform sampler2D maskTexture, palette;

bool isPick    = (drwLayer > 1.5);
bool isContext = (drwLayer < 0.5);

const vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);
const vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);

float val(mat4 p, mat4 v) {
    return dot(matrixCompMult(p, v) * UNITS, UNITS);
}

float axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {
    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);
    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);
    return y1 * (1.0 - ratio) + y2 * ratio;
}

int iMod(int a, int b) {
    return a - b * (a / b);
}

bool fOutside(float p, float lo, float hi) {
    return (lo < hi) && (lo > p || p > hi);
}

bool vOutside(vec4 p, vec4 lo, vec4 hi) {
    return (
        fOutside(p[0], lo[0], hi[0]) ||
        fOutside(p[1], lo[1], hi[1]) ||
        fOutside(p[2], lo[2], hi[2]) ||
        fOutside(p[3], lo[3], hi[3])
    );
}

bool mOutside(mat4 p, mat4 lo, mat4 hi) {
    return (
        vOutside(p[0], lo[0], hi[0]) ||
        vOutside(p[1], lo[1], hi[1]) ||
        vOutside(p[2], lo[2], hi[2]) ||
        vOutside(p[3], lo[3], hi[3])
    );
}

bool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {
    return mOutside(A, loA, hiA) ||
           mOutside(B, loB, hiB) ||
           mOutside(C, loC, hiC) ||
           mOutside(D, loD, hiD);
}

bool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {
    mat4 pnts[4];
    pnts[0] = A;
    pnts[1] = B;
    pnts[2] = C;
    pnts[3] = D;

    for(int i = 0; i < 4; ++i) {
        for(int j = 0; j < 4; ++j) {
            for(int k = 0; k < 4; ++k) {
                if(0 == iMod(
                    int(255.0 * texture2D(maskTexture,
                        vec2(
                            (float(i * 2 + j / 2) + 0.5) / 8.0,
                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight
                        ))[3]
                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),
                    2
                )) return true;
            }
        }
    }
    return false;
}

vec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {
    float x = 0.5 * sign(v) + 0.5;
    float y = axisY(x, A, B, C, D);
    float z = 1.0 - abs(v);

    z += isContext ? 0.0 : 2.0 * float(
        outsideBoundingBox(A, B, C, D) ||
        outsideRasterMask(A, B, C, D)
    );

    return vec4(
        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,
        z,
        1.0
    );
}

void main() {
    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);
    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);
    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);
    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);

    float v = colors[3];

    gl_Position = position(isContext, v, A, B, C, D);

    fragColor =
        isContext ? vec4(contextColor) :
        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));
}
`]),m=t([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
    gl_FragColor = fragColor;
}
`]),p=r("./constants").maxDimensionCount,e=r("../../lib"),f=new Uint8Array(4),u=new Uint8Array(4),s={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function l(v,_,x,T,A){var S=v._gl;S.enable(S.SCISSOR_TEST),S.scissor(_,x,T,A),v.clear({color:[0,0,0,0],depth:1})}function o(v,_,x,T,A,S){var w=S.key;x.drawCompleted||(function(C){C.read({x:0,y:0,width:1,height:1,data:f})}(v),x.drawCompleted=!0),function C(k){var L=Math.min(T,A-k*T);k===0&&(window.cancelAnimationFrame(x.currentRafs[w]),delete x.currentRafs[w],l(v,S.scissorX,S.scissorY,S.scissorWidth,S.viewBoxSize[1])),x.clearOnly||(S.count=2*L,S.offset=2*k*T,_(S),k*T+L<A&&(x.currentRafs[w]=window.requestAnimationFrame(function(){C(k+1)})),x.drawCompleted=!1)}(0)}function i(v,_){for(var x=new Array(256),T=0;T<256;T++)x[T]=v(T/255).concat(_);return x}function c(v,_){return(v>>>8*_)%256/255}function n(v,_,x){for(var T=new Array(8*_),A=0,S=0;S<_;S++)for(var w=0;w<2;w++)for(var C=0;C<4;C++){var k=4*v+C,L=x[64*S+k];k===63&&w===0&&(L*=-1),T[A++]=L}return T}function a(v){var _="0"+v;return _.substr(_.length-2)}function g(v){return v<p?"p"+a(v+1)+"_"+a(v+4):"colors"}function h(v,_,x,T,A,S,w,C,k,L,M,P,D,N){for(var U=[[],[]],q=0;q<64;q++)U[0][q]=q===A?1:0,U[1][q]=q===S?1:0;w*=N,C*=N,k*=N,L*=N;var X=v.lines.canvasOverdrag*N,K=v.domain,Z=v.canvasWidth*N,H=v.canvasHeight*N,Y=v.pad.l*N,$=v.pad.b*N,z=v.layoutHeight*N,j=v.layoutWidth*N,W=v.deselectedLines.color;return e.extendFlat({key:M,resolution:[Z,H],viewBoxPos:[w+X,C],viewBoxSize:[k,L],i0:A,i1:S,dim0A:U[0].slice(0,16),dim0B:U[0].slice(16,32),dim0C:U[0].slice(32,48),dim0D:U[0].slice(48,64),dim1A:U[1].slice(0,16),dim1B:U[1].slice(16,32),dim1C:U[1].slice(32,48),dim1D:U[1].slice(48,64),drwLayer:P,contextColor:[W[0]/255,W[1]/255,W[2]/255,W[3]<1?W[3]:Math.max(1/255,Math.pow(1/v.lines.color.length,1/3))],scissorX:(T===_?0:w+X)+(Y-X)+j*K.x[0],scissorWidth:(T===x?Z-w+X:k+.5)+(T===_?w+X:0),scissorY:C+$+z*K.y[0],scissorHeight:L,viewportX:Y-X+j*K.x[0],viewportY:$+z*K.y[0],viewportWidth:Z,viewportHeight:H},D)}function y(v){var _=Math.max(0,Math.floor(2047*v[0]),0),x=Math.min(2047,Math.ceil(2047*v[1]),2047);return[Math.min(_,x),Math.max(_,x)]}O.exports=function(v,_){var x,T,A,S,w,C=_.context,k=_.pick,L=_.regl,M=L._gl,P=M.getParameter(M.ALIASED_LINE_WIDTH_RANGE),D=Math.max(P[0],Math.min(P[1],_.viewModel.plotGlPixelRatio)),N={currentRafs:{},drawCompleted:!0,clearOnly:!1},U=function(H){for(var Y={},$=0;$<=p;$+=4)Y[g($)]=H.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return Y}(L),q=L.texture(s),X=[];Z(_);var K=L({profile:!1,blend:{enable:C,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!C,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:L.prop("scissorX"),y:L.prop("scissorY"),width:L.prop("scissorWidth"),height:L.prop("scissorHeight")}},viewport:{x:L.prop("viewportX"),y:L.prop("viewportY"),width:L.prop("viewportWidth"),height:L.prop("viewportHeight")},dither:!1,vert:d,frag:m,primitive:"lines",lineWidth:D,attributes:U,uniforms:{resolution:L.prop("resolution"),viewBoxPos:L.prop("viewBoxPos"),viewBoxSize:L.prop("viewBoxSize"),dim0A:L.prop("dim0A"),dim1A:L.prop("dim1A"),dim0B:L.prop("dim0B"),dim1B:L.prop("dim1B"),dim0C:L.prop("dim0C"),dim1C:L.prop("dim1C"),dim0D:L.prop("dim0D"),dim1D:L.prop("dim1D"),loA:L.prop("loA"),hiA:L.prop("hiA"),loB:L.prop("loB"),hiB:L.prop("hiB"),loC:L.prop("loC"),hiC:L.prop("hiC"),loD:L.prop("loD"),hiD:L.prop("hiD"),palette:q,contextColor:L.prop("contextColor"),maskTexture:L.prop("maskTexture"),drwLayer:L.prop("drwLayer"),maskHeight:L.prop("maskHeight")},offset:L.prop("offset"),count:L.prop("count")});function Z(H){x=H.model,T=H.viewModel,A=T.dimensions.slice(),S=A[0]?A[0].values.length:0;var Y=x.lines,$=k?Y.color.map(function(j,W){return W/Y.color.length}):Y.color,z=function(j,W,ee){for(var J,Q=new Array(j*(p+4)),te=0,ie=0;ie<j;ie++){for(var ae=0;ae<p;ae++)Q[te++]=ae<W.length?W[ae].paddedUnitValues[ie]:.5;Q[te++]=c(ie,2),Q[te++]=c(ie,1),Q[te++]=c(ie,0),Q[te++]=(J=ee[ie],Math.max(1e-6,Math.min(.999999,J)))}return Q}(S,A,$);(function(j,W,ee){for(var J=0;J<=p;J+=4)j[g(J)](n(J/4,W,ee))})(U,S,z),C||k||(q=L.texture(e.extendFlat({data:i(x.unitToColor,255)},s)))}return{render:function(H,Y,$){var z,j,W,ee=H.length,J=1/0,Q=-1/0;for(z=0;z<ee;z++)H[z].dim0.canvasX<J&&(J=H[z].dim0.canvasX,j=z),H[z].dim1.canvasX>Q&&(Q=H[z].dim1.canvasX,W=z);ee===0&&l(L,0,0,x.canvasWidth,x.canvasHeight);var te=function(be){var xe,ce,ge,we=[[],[]];for(ge=0;ge<64;ge++){var Me=!be&&ge<A.length?A[ge].brush.filter.getBounds():[-1/0,1/0];we[0][ge]=Me[0],we[1][ge]=Me[1]}var Se=new Array(16384);for(xe=0;xe<16384;xe++)Se[xe]=255;if(!be)for(xe=0;xe<A.length;xe++){var ze=xe%8,Fe=(xe-ze)/8,Ye=Math.pow(2,ze),rt=A[xe].brush.filter.get();if(!(rt.length<2)){var Oe=y(rt[0])[1];for(ce=1;ce<rt.length;ce++){var je=y(rt[ce]);for(ge=Oe+1;ge<je[0];ge++)Se[8*ge+Fe]&=~Ye;Oe=Math.max(Oe,je[1])}}}var We={shape:[8,2048],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:Se};return w?w(We):w=L.texture(We),{maskTexture:w,maskHeight:2048,loA:we[0].slice(0,16),loB:we[0].slice(16,32),loC:we[0].slice(32,48),loD:we[0].slice(48,64),hiA:we[1].slice(0,16),hiB:we[1].slice(16,32),hiC:we[1].slice(32,48),hiD:we[1].slice(48,64)}}(C);for(z=0;z<ee;z++){var ie=H[z],ae=ie.dim0.crossfilterDimensionIndex,he=ie.dim1.crossfilterDimensionIndex,se=ie.canvasX,de=ie.canvasY,ue=se+ie.panelSizeX,ve=ie.plotGlPixelRatio;if(Y||!X[ae]||X[ae][0]!==se||X[ae][1]!==ue){X[ae]=[se,ue];var ke=h(x,j,W,z,ae,he,se,de,ie.panelSizeX,ie.panelSizeY,ie.dim0.crossfilterDimensionIndex,C?0:k?2:1,te,ve);N.clearOnly=$;var Ee=Y?x.lines.blockLineCount:S;o(L,K,N,Ee,S,ke)}}},readPixel:function(H,Y){return L.read({x:H,y:Y,width:1,height:1,data:u}),u},readPixels:function(H,Y,$,z){var j=new Uint8Array(4*$*z);return L.read({x:H,y:Y,width:$,height:z,data:j}),j},destroy:function(){for(var H in v.style["pointer-events"]="none",q.destroy(),w&&w.destroy(),U)U[H].destroy()},update:Z}}},{"../../lib":787,"./constants":1168,glslify:434}],1173:[function(r,O,B){O.exports=function(t,d,m,p){var e,f;for(p||(p=1/0),e=0;e<d.length;e++)(f=d[e]).visible&&(p=Math.min(p,f[m].length));for(p===1/0&&(p=0),t._length=p,e=0;e<d.length;e++)(f=d[e]).visible&&(f._length=p);return p}},{}],1174:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=d.numberFormat,p=r("color-rgba"),e=r("../../plots/cartesian/axes"),f=d.strRotate,u=d.strTranslate,s=r("../../lib/svg_text_utils"),l=r("../../components/drawing"),o=r("../../components/colorscale"),i=r("../../lib/gup"),c=i.keyFun,n=i.repeat,a=i.unwrap,g=r("./helpers"),h=r("./constants"),y=r("./axisbrush"),v=r("./lines");function _(X,K,Z){return d.aggNums(X,null,K,Z)}function x(X,K){return A(_(Math.min,X,K),_(Math.max,X,K))}function T(X){var K=X.range;return K?A(K[0],K[1]):x(X.values,X._length)}function A(X,K){return!isNaN(X)&&isFinite(X)||(X=0),!isNaN(K)&&isFinite(K)||(K=0),X===K&&(X===0?(X-=1,K+=1):(X*=.9,K*=1.1)),[X,K]}function S(X,K,Z,H,Y){var $,z,j=T(Z);return H?t.scale.ordinal().domain(H.map(($=m(Z.tickformat),z=Y,z?function(W,ee){var J=z[ee];return J==null?$(W):J}:$))).range(H.map(function(W){var ee=(W-j[0])/(j[1]-j[0]);return X-K+ee*(2*K-X)})):t.scale.linear().domain(j).range([X-K,K])}function w(X){if(X.tickvals){var K=T(X);return t.scale.ordinal().domain(X.tickvals).range(X.tickvals.map(function(Z){return(Z-K[0])/(K[1]-K[0])}))}}function C(X){var K=X.map(function(Y){return Y[0]}),Z=X.map(function(Y){var $=p(Y[1]);return t.rgb("rgb("+$[0]+","+$[1]+","+$[2]+")")}),H="rgb".split("").map(function(Y){return t.scale.linear().clamp(!0).domain(K).range(Z.map(($=Y,function(z){return z[$]})));var $});return function(Y){return H.map(function($){return $(Y)})}}function k(X){return X.dimensions.some(function(K){return K.brush.filterSpecified})}function L(X,K,Z){var H=a(K),Y=H.trace,$=g.convertTypedArray(H.lineColor),z=Y.line,j={color:p(h.deselectedLineColor)},W=o.extractOpts(z),ee=W.reversescale?o.flipScale(H.cscale):H.cscale,J=Y.domain,Q=Y.dimensions,te=X.width,ie=Y.labelangle,ae=Y.labelside,he=Y.labelfont,se=Y.tickfont,de=Y.rangefont,ue=d.extendDeepNoArrays({},z,{color:$.map(t.scale.linear().domain(T({values:$,range:[W.min,W.max],_length:Y._length}))),blockLineCount:h.blockLineCount,canvasOverdrag:h.overdrag*h.canvasPixelRatio}),ve=Math.floor(te*(J.x[1]-J.x[0])),ke=Math.floor(X.height*(J.y[1]-J.y[0])),Ee=X.margin||{l:80,r:80,t:100,b:80},be=ve,xe=ke;return{key:Z,colCount:Q.filter(g.isVisible).length,dimensions:Q,tickDistance:h.tickDistance,unitToColor:C(ee),lines:ue,deselectedLines:j,labelAngle:ie,labelSide:ae,labelFont:he,tickFont:se,rangeFont:de,layoutWidth:te,layoutHeight:X.height,domain:J,translateX:J.x[0]*te,translateY:X.height-J.y[1]*X.height,pad:Ee,canvasWidth:be*h.canvasPixelRatio+2*ue.canvasOverdrag,canvasHeight:xe*h.canvasPixelRatio,width:be,height:xe,canvasPixelRatio:h.canvasPixelRatio}}function M(X,K,Z){var H=Z.width,Y=Z.height,$=Z.dimensions,z=Z.canvasPixelRatio,j=function(te){return H*te/Math.max(1,Z.colCount-1)},W=h.verticalPadding/Y,ee=function(te,ie){return t.scale.linear().range([ie,te-ie])}(Y,h.verticalPadding),J={key:Z.key,xScale:j,model:Z,inBrushDrag:!1},Q={};return J.dimensions=$.filter(g.isVisible).map(function(te,ie){var ae=function(Se,ze){return t.scale.linear().domain(T(Se)).range([ze,1-ze])}(te,W),he=Q[te.label];Q[te.label]=(he||0)+1;var se=te.label+(he?"__"+he:""),de=te.constraintrange,ue=de&&de.length;ue&&!Array.isArray(de[0])&&(de=[de]);var ve=ue?de.map(function(Se){return Se.map(ae)}):[[-1/0,1/0]],ke=te.values;ke.length>te._length&&(ke=ke.slice(0,te._length));var Ee,be=te.tickvals;function xe(Se,ze){return{val:Se,text:Ee[ze]}}function ce(Se,ze){return Se.val-ze.val}if(Array.isArray(be)&&be.length){Ee=te.ticktext,Array.isArray(Ee)&&Ee.length?Ee.length>be.length?Ee=Ee.slice(0,be.length):be.length>Ee.length&&(be=be.slice(0,Ee.length)):Ee=be.map(m(te.tickformat));for(var ge=1;ge<be.length;ge++)if(be[ge]<be[ge-1]){for(var we=be.map(xe).sort(ce),Me=0;Me<be.length;Me++)be[Me]=we[Me].val,Ee[Me]=we[Me].text;break}}else be=void 0;return ke=g.convertTypedArray(ke),{key:se,label:te.label,tickFormat:te.tickformat,tickvals:be,ticktext:Ee,ordinal:g.isOrdinal(te),multiselect:te.multiselect,xIndex:ie,crossfilterDimensionIndex:ie,visibleIndex:te._index,height:Y,values:ke,paddedUnitValues:ke.map(ae),unitTickvals:be&&be.map(ae),xScale:j,x:j(ie),canvasX:j(ie)*z,unitToPaddedPx:ee,domainScale:S(Y,h.verticalPadding,te,be,Ee),ordinalScale:w(te),parent:J,model:Z,brush:y.makeBrush(X,ue,ve,function(){X.linePickActive(!1)},function(){var Se=J;Se.focusLayer&&Se.focusLayer.render(Se.panels,!0);var ze=k(Se);!X.contextShown()&&ze?(Se.contextLayer&&Se.contextLayer.render(Se.panels,!0),X.contextShown(!0)):X.contextShown()&&!ze&&(Se.contextLayer&&Se.contextLayer.render(Se.panels,!0,!0),X.contextShown(!1))},function(Se){if(J.focusLayer.render(J.panels,!0),J.pickLayer&&J.pickLayer.render(J.panels,!0),X.linePickActive(!0),K&&K.filterChanged){var ze=ae.invert,Fe=Se.map(function(Ye){return Ye.map(ze).sort(d.sorterAsc)}).sort(function(Ye,rt){return Ye[0]-rt[0]});K.filterChanged(J.key,te._index,Fe)}})}}),J}function P(X){X.classed(h.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function D(X,K){var Z=K==="top"?1:-1,H=X*Math.PI/180;return{dir:Z,dx:Math.sin(H),dy:Math.cos(H),degrees:X}}function N(X,K,Z){for(var H=K.panels||(K.panels=[]),Y=X.data(),$=0;$<Y.length-1;$++){var z=H[$]||(H[$]={}),j=Y[$],W=Y[$+1];z.dim0=j,z.dim1=W,z.canvasX=j.canvasX,z.panelSizeX=W.canvasX-j.canvasX,z.panelSizeY=K.model.canvasHeight,z.y=0,z.canvasY=0,z.plotGlPixelRatio=Z}}function U(X,K){return e.tickText(X._ax,K,!1).text}function q(X,K){if(X.ordinal)return"";var Z=X.domainScale.domain(),H=Z[K?Z.length-1:0];return U(X.model.dimensions[X.visibleIndex],H)}O.exports=function(X,K,Z,H){var Y=X._fullLayout,$=Y._toppaper,z=Y._glcontainer,j=X._context.plotGlPixelRatio,W=X._fullLayout.paper_bgcolor;(function(Me){for(var Se=0;Se<Me.length;Se++)for(var ze=0;ze<Me[Se].length;ze++)for(var Fe=Me[Se][ze].trace,Ye=Fe.dimensions,rt=0;rt<Ye.length;rt++){var Oe=Ye[rt].values,je=Ye[rt]._ax;je&&(je.range?je.range=A(je.range[0],je.range[1]):je.range=x(Oe,Fe._length),je.dtick||(je.dtick=.01*(Math.abs(je.range[1]-je.range[0])||1)),je.tickformat=Ye[rt].tickformat,e.calcTicks(je),je.cleanRange())}})(K);var ee,J,Q=(ee=!0,J=!1,{linePickActive:function(Me){return arguments.length?ee=!!Me:ee},contextShown:function(Me){return arguments.length?J=!!Me:J}}),te=K.filter(function(Me){return a(Me).trace.visible}).map(L.bind(0,Z)).map(M.bind(0,Q,H));z.each(function(Me,Se){return d.extendFlat(Me,te[Se])});var ie=z.selectAll(".gl-canvas").each(function(Me){Me.viewModel=te[0],Me.viewModel.plotGlPixelRatio=j,Me.viewModel.paperColor=W,Me.model=Me.viewModel?Me.viewModel.model:null}),ae=null;ie.filter(function(Me){return Me.pick}).style("pointer-events","auto").on("mousemove",function(Me){if(Q.linePickActive()&&Me.lineLayer&&H&&H.hover){var Se=t.event,ze=this.width,Fe=this.height,Ye=t.mouse(this),rt=Ye[0],Oe=Ye[1];if(rt<0||Oe<0||rt>=ze||Oe>=Fe)return;var je=Me.lineLayer.readPixel(rt,Fe-1-Oe),We=je[3]!==0,qe=We?je[2]+256*(je[1]+256*je[0]):null,Qe={x:rt,y:Oe,clientX:Se.clientX,clientY:Se.clientY,dataIndex:Me.model.key,curveNumber:qe};qe!==ae&&(We?H.hover(Qe):H.unhover&&H.unhover(Qe),ae=qe)}}),ie.style("opacity",function(Me){return Me.pick?0:1}),$.style("background","rgba(255, 255, 255, 0)");var he=$.selectAll("."+h.cn.parcoords).data(te,c);he.exit().remove(),he.enter().append("g").classed(h.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),he.attr("transform",function(Me){return u(Me.model.translateX,Me.model.translateY)});var se=he.selectAll("."+h.cn.parcoordsControlView).data(n,c);se.enter().append("g").classed(h.cn.parcoordsControlView,!0),se.attr("transform",function(Me){return u(Me.model.pad.l,Me.model.pad.t)});var de=se.selectAll("."+h.cn.yAxis).data(function(Me){return Me.dimensions},c);de.enter().append("g").classed(h.cn.yAxis,!0),se.each(function(Me){N(de,Me,j)}),ie.each(function(Me){if(Me.viewModel){!Me.lineLayer||H?Me.lineLayer=v(this,Me):Me.lineLayer.update(Me),(Me.key||Me.key===0)&&(Me.viewModel[Me.key]=Me.lineLayer);var Se=!Me.context||H;Me.lineLayer.render(Me.viewModel.panels,Se)}}),de.attr("transform",function(Me){return u(Me.xScale(Me.xIndex),0)}),de.call(t.behavior.drag().origin(function(Me){return Me}).on("drag",function(Me){var Se=Me.parent;Q.linePickActive(!1),Me.x=Math.max(-h.overdrag,Math.min(Me.model.width+h.overdrag,t.event.x)),Me.canvasX=Me.x*Me.model.canvasPixelRatio,de.sort(function(ze,Fe){return ze.x-Fe.x}).each(function(ze,Fe){ze.xIndex=Fe,ze.x=Me===ze?ze.x:ze.xScale(ze.xIndex),ze.canvasX=ze.x*ze.model.canvasPixelRatio}),N(de,Se,j),de.filter(function(ze){return Math.abs(Me.xIndex-ze.xIndex)!==0}).attr("transform",function(ze){return u(ze.xScale(ze.xIndex),0)}),t.select(this).attr("transform",u(Me.x,0)),de.each(function(ze,Fe,Ye){Ye===Me.parent.key&&(Se.dimensions[Fe]=ze)}),Se.contextLayer&&Se.contextLayer.render(Se.panels,!1,!k(Se)),Se.focusLayer.render&&Se.focusLayer.render(Se.panels)}).on("dragend",function(Me){var Se=Me.parent;Me.x=Me.xScale(Me.xIndex),Me.canvasX=Me.x*Me.model.canvasPixelRatio,N(de,Se,j),t.select(this).attr("transform",function(ze){return u(ze.x,0)}),Se.contextLayer&&Se.contextLayer.render(Se.panels,!1,!k(Se)),Se.focusLayer&&Se.focusLayer.render(Se.panels),Se.pickLayer&&Se.pickLayer.render(Se.panels,!0),Q.linePickActive(!0),H&&H.axesMoved&&H.axesMoved(Se.key,Se.dimensions.map(function(ze){return ze.crossfilterDimensionIndex}))})),de.exit().remove();var ue=de.selectAll("."+h.cn.axisOverlays).data(n,c);ue.enter().append("g").classed(h.cn.axisOverlays,!0),ue.selectAll("."+h.cn.axis).remove();var ve=ue.selectAll("."+h.cn.axis).data(n,c);ve.enter().append("g").classed(h.cn.axis,!0),ve.each(function(Me){var Se=Me.model.height/Me.model.tickDistance,ze=Me.domainScale,Fe=ze.domain();t.select(this).call(t.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(Se,Me.tickFormat).tickValues(Me.ordinal?Fe:null).tickFormat(function(Ye){return g.isOrdinal(Me)?Ye:U(Me.model.dimensions[Me.visibleIndex],Ye)}).scale(ze)),l.font(ve.selectAll("text"),Me.model.tickFont)}),ve.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),ve.selectAll("text").style("text-shadow",s.makeTextShadow(W)).style("cursor","default");var ke=ue.selectAll("."+h.cn.axisHeading).data(n,c);ke.enter().append("g").classed(h.cn.axisHeading,!0);var Ee=ke.selectAll("."+h.cn.axisTitle).data(n,c);Ee.enter().append("text").classed(h.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events","auto"),Ee.text(function(Me){return Me.label}).each(function(Me){var Se=t.select(this);l.font(Se,Me.model.labelFont),s.convertToTspans(Se,X)}).attr("transform",function(Me){var Se=D(Me.model.labelAngle,Me.model.labelSide),ze=h.axisTitleOffset;return(Se.dir>0?"":u(0,2*ze+Me.model.height))+f(Se.degrees)+u(-ze*Se.dx,-ze*Se.dy)}).attr("text-anchor",function(Me){var Se=D(Me.model.labelAngle,Me.model.labelSide);return 2*Math.abs(Se.dx)>Math.abs(Se.dy)?Se.dir*Se.dx<0?"start":"end":"middle"});var be=ue.selectAll("."+h.cn.axisExtent).data(n,c);be.enter().append("g").classed(h.cn.axisExtent,!0);var xe=be.selectAll("."+h.cn.axisExtentTop).data(n,c);xe.enter().append("g").classed(h.cn.axisExtentTop,!0),xe.attr("transform",u(0,-h.axisExtentOffset));var ce=xe.selectAll("."+h.cn.axisExtentTopText).data(n,c);ce.enter().append("text").classed(h.cn.axisExtentTopText,!0).call(P),ce.text(function(Me){return q(Me,!0)}).each(function(Me){l.font(t.select(this),Me.model.rangeFont)});var ge=be.selectAll("."+h.cn.axisExtentBottom).data(n,c);ge.enter().append("g").classed(h.cn.axisExtentBottom,!0),ge.attr("transform",function(Me){return u(0,Me.model.height+h.axisExtentOffset)});var we=ge.selectAll("."+h.cn.axisExtentBottomText).data(n,c);we.enter().append("text").classed(h.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(P),we.text(function(Me){return q(Me,!1)}).each(function(Me){l.font(t.select(this),Me.model.rangeFont)}),y.ensureAxisBrush(ue,W)}},{"../../components/colorscale":662,"../../components/drawing":672,"../../lib":787,"../../lib/gup":784,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"./axisbrush":1165,"./constants":1168,"./helpers":1170,"./lines":1172,"@plotly/d3":58,"color-rgba":133}],1175:[function(r,O,B){var t=r("./parcoords"),d=r("../../lib/prepare_regl"),m=r("./helpers").isVisible;function p(e,f,u){var s=f.indexOf(u),l=e.indexOf(s);return l===-1&&(l+=f.length),l}O.exports=function(e,f){var u=e._fullLayout;if(d(e)){var s={},l={},o={},i={},c=u._size;f.forEach(function(n,a){var g=n[0].trace;o[a]=g.index;var h=i[a]=g._fullInput.index;s[a]=e.data[h].dimensions,l[a]=e.data[h].dimensions.slice()}),t(e,f,{width:c.w,height:c.h,margin:{t:c.t,r:c.r,b:c.b,l:c.l}},{filterChanged:function(n,a,g){var h=l[n][a],y=g.map(function(S){return S.slice()}),v="dimensions["+a+"].constraintrange",_=u._tracePreGUI[e._fullData[o[n]]._fullInput.uid];if(_[v]===void 0){var x=h.constraintrange;_[v]=x||null}var T=e._fullData[o[n]].dimensions[a];y.length?(y.length===1&&(y=y[0]),h.constraintrange=y,T.constraintrange=y.slice(),y=[y]):(delete h.constraintrange,delete T.constraintrange,y=null);var A={};A[v]=y,e.emit("plotly_restyle",[A,[i[n]]])},hover:function(n){e.emit("plotly_hover",n)},unhover:function(n){e.emit("plotly_unhover",n)},axesMoved:function(n,a){var g=function(h,y){return function(v,_){return p(h,y,v)-p(h,y,_)}}(a,l[n].filter(m));s[n].sort(g),l[n].filter(function(h){return!m(h)}).sort(function(h){return l[n].indexOf(h)}).forEach(function(h){s[n].splice(s[n].indexOf(h),1),s[n].splice(l[n].indexOf(h),0,h)}),e.emit("plotly_restyle",[{dimensions:[s[n]]},[i[n]]])}})}}},{"../../lib/prepare_regl":800,"./helpers":1170,"./parcoords":1174}],1176:[function(r,O,B){var t=r("../../plots/attributes"),d=r("../../plots/domain").attributes,m=r("../../plots/font_attributes"),p=r("../../components/color/attributes"),e=r("../../plots/template_attributes").hovertemplateAttrs,f=r("../../plots/template_attributes").texttemplateAttrs,u=r("../../lib/extend").extendFlat,s=m({editType:"plot",arrayOk:!0,colorEditType:"plot"});O.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:p.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:u({},t.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:f({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:u({},s,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:u({},s,{}),outsidetextfont:u({},s,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:u({},s,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:d({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:u({},s,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":649,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/domain":866,"../../plots/font_attributes":867,"../../plots/template_attributes":910}],1177:[function(r,O,B){var t=r("../../plots/plots");B.name="pie",B.plot=function(d,m,p,e){t.plotBasePlot(B.name,d,m,p,e)},B.clean=function(d,m,p,e){t.cleanBasePlot(B.name,d,m,p,e)}},{"../../plots/plots":901}],1178:[function(r,O,B){var t=r("fast-isnumeric"),d=r("tinycolor2"),m=r("../../components/color"),p={};function e(u){return function(s,l){return!!s&&!!(s=d(s)).isValid()&&(s=m.addOpacity(s,s.getAlpha()),u[l]||(u[l]=s),s)}}function f(u,s){var l,o=JSON.stringify(u),i=s[o];if(!i){for(i=u.slice(),l=0;l<u.length;l++)i.push(d(u[l]).lighten(20).toHexString());for(l=0;l<u.length;l++)i.push(d(u[l]).darken(20).toHexString());s[o]=i}return i}O.exports={calc:function(u,s){var l,o,i=[],c=u._fullLayout,n=c.hiddenlabels||[],a=s.labels,g=s.marker.colors||[],h=s.values,y=s._length,v=s._hasValues&&y;if(s.dlabel)for(a=new Array(y),l=0;l<y;l++)a[l]=String(s.label0+l*s.dlabel);var _={},x=e(c["_"+s.type+"colormap"]),T=0,A=!1;for(l=0;l<y;l++){var S,w,C;if(v){if(S=h[l],!t(S)||(S=+S)<0)continue}else S=1;(w=a[l])!==void 0&&w!==""||(w=l);var k=_[w=String(w)];k===void 0?(_[w]=i.length,(C=n.indexOf(w)!==-1)||(T+=S),i.push({v:S,label:w,color:x(g[l],w),i:l,pts:[l],hidden:C})):(A=!0,(o=i[k]).v+=S,o.pts.push(l),o.hidden||(T+=S),o.color===!1&&g[l]&&(o.color=x(g[l],w)))}return(s.type==="funnelarea"?A:s.sort)&&i.sort(function(L,M){return M.v-L.v}),i[0]&&(i[0].vTotal=T),i},crossTraceCalc:function(u,s){var l=(s||{}).type;l||(l="pie");var o=u._fullLayout,i=u.calcdata,c=o[l+"colorway"],n=o["_"+l+"colormap"];o["extend"+l+"colors"]&&(c=f(c,p));for(var a=0,g=0;g<i.length;g++){var h=i[g];if(h[0].trace.type===l)for(var y=0;y<h.length;y++){var v=h[y];v.color===!1&&(n[v.label]?v.color=n[v.label]:(n[v.label]=v.color=c[a%c.length],a++))}}},makePullColorFn:e,generateExtendedColors:f}},{"../../components/color":650,"fast-isnumeric":246,tinycolor2:583}],1179:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("./attributes"),p=r("../../plots/domain").defaults,e=r("../bar/defaults").handleText;function f(u,s){var l=Array.isArray(u),o=d.isArrayOrTypedArray(s),i=Math.min(l?u.length:1/0,o?s.length:1/0);if(isFinite(i)||(i=0),i&&o){for(var c,n=0;n<i;n++){var a=s[n];if(t(a)&&a>0){c=!0;break}}c||(i=0)}return{hasLabels:l,hasValues:o,len:i}}O.exports={handleLabelsAndValues:f,supplyDefaults:function(u,s,l,o){function i(x,T){return d.coerce(u,s,m,x,T)}var c=f(i("labels"),i("values")),n=c.len;if(s._hasLabels=c.hasLabels,s._hasValues=c.hasValues,!s._hasLabels&&s._hasValues&&(i("label0"),i("dlabel")),n){s._length=n,i("marker.line.width")&&i("marker.line.color"),i("marker.colors"),i("scalegroup");var a,g=i("text"),h=i("texttemplate");if(h||(a=i("textinfo",Array.isArray(g)?"text+percent":"percent")),i("hovertext"),i("hovertemplate"),h||a&&a!=="none"){var y=i("textposition");e(u,s,o,i,y,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),(Array.isArray(y)||y==="auto"||y==="outside")&&i("automargin"),(y==="inside"||y==="auto"||Array.isArray(y))&&i("insidetextorientation")}p(s,o,i);var v=i("hole");if(i("title.text")){var _=i("title.position",v?"middle center":"top center");v||_!=="middle center"||(s.title.position="top center"),d.coerceFont(i,"title.font",o.font)}i("sort"),i("direction"),i("rotation"),i("pull")}else s.visible=!1}}},{"../../lib":787,"../../plots/domain":866,"../bar/defaults":929,"./attributes":1176,"fast-isnumeric":246}],1180:[function(r,O,B){var t=r("../../components/fx/helpers").appendArrayMultiPointValues;O.exports=function(d,m){var p={curveNumber:m.index,pointNumbers:d.pts,data:m._input,fullData:m,label:d.label,color:d.color,value:d.v,percent:d.percent,text:d.text,bbox:d.bbox,v:d.v};return d.pts.length===1&&(p.pointNumber=p.i=d.pts[0]),t(p,m,d.pts),m.type==="funnelarea"&&(delete p.v,delete p.i),p}},{"../../components/fx/helpers":686}],1181:[function(r,O,B){var t=r("../../lib");function d(m){return m.indexOf("e")!==-1?m.replace(/[.]?0+e/,"e"):m.indexOf(".")!==-1?m.replace(/[.]?0+$/,""):m}B.formatPiePercent=function(m,p){var e=d((100*m).toPrecision(3));return t.numSeparate(e,p)+"%"},B.formatPieValue=function(m,p){var e=d(m.toPrecision(10));return t.numSeparate(e,p)},B.getFirstFilled=function(m,p){if(Array.isArray(m))for(var e=0;e<p.length;e++){var f=m[p[e]];if(f||f===0||f==="")return f}},B.castOption=function(m,p){return Array.isArray(m)?B.getFirstFilled(m,p):m||void 0},B.getRotationAngle=function(m){return(m==="auto"?0:m)*Math.PI/180}},{"../../lib":787}],1182:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults").supplyDefaults,supplyLayoutDefaults:r("./layout_defaults"),layoutAttributes:r("./layout_attributes"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot").plot,style:r("./style"),styleOne:r("./style_one"),moduleType:"trace",name:"pie",basePlotModule:r("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":1176,"./base_plot":1177,"./calc":1178,"./defaults":1179,"./layout_attributes":1183,"./layout_defaults":1184,"./plot":1185,"./style":1186,"./style_one":1187}],1183:[function(r,O,B){O.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1184:[function(r,O,B){var t=r("../../lib"),d=r("./layout_attributes");O.exports=function(m,p){function e(f,u){return t.coerce(m,p,d,f,u)}e("hiddenlabels"),e("piecolorway",p.colorway),e("extendpiecolors")}},{"../../lib":787,"./layout_attributes":1183}],1185:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../plots/plots"),m=r("../../components/fx"),p=r("../../components/color"),e=r("../../components/drawing"),f=r("../../lib"),u=f.strScale,s=f.strTranslate,l=r("../../lib/svg_text_utils"),o=r("../bar/uniform_text"),i=o.recordMinTextSize,c=o.clearMinTextSize,n=r("../bar/constants").TEXTPAD,a=r("./helpers"),g=r("./event_data"),h=r("../../lib").isValidTextValue;function y(K,Z,H){var Y=H[0],$=Y.cx,z=Y.cy,j=Y.trace,W=j.type==="funnelarea";"_hasHoverLabel"in j||(j._hasHoverLabel=!1),"_hasHoverEvent"in j||(j._hasHoverEvent=!1),K.on("mouseover",function(ee){var J=Z._fullLayout,Q=Z._fullData[j.index];if(!Z._dragging&&J.hovermode!==!1){var te=Q.hoverinfo;if(Array.isArray(te)&&(te=m.castHoverinfo({hoverinfo:[a.castOption(te,ee.pts)],_module:j._module},J,0)),te==="all"&&(te="label+text+value+percent+name"),Q.hovertemplate||te!=="none"&&te!=="skip"&&te){var ie=ee.rInscribed||0,ae=$+ee.pxmid[0]*(1-ie),he=z+ee.pxmid[1]*(1-ie),se=J.separators,de=[];if(te&&te.indexOf("label")!==-1&&de.push(ee.label),ee.text=a.castOption(Q.hovertext||Q.text,ee.pts),te&&te.indexOf("text")!==-1){var ue=ee.text;f.isValidTextValue(ue)&&de.push(ue)}ee.value=ee.v,ee.valueLabel=a.formatPieValue(ee.v,se),te&&te.indexOf("value")!==-1&&de.push(ee.valueLabel),ee.percent=ee.v/Y.vTotal,ee.percentLabel=a.formatPiePercent(ee.percent,se),te&&te.indexOf("percent")!==-1&&de.push(ee.percentLabel);var ve=Q.hoverlabel,ke=ve.font,Ee=[];m.loneHover({trace:j,x0:ae-ie*Y.r,x1:ae+ie*Y.r,y:he,_x0:W?$+ee.TL[0]:ae-ie*Y.r,_x1:W?$+ee.TR[0]:ae+ie*Y.r,_y0:W?z+ee.TL[1]:he-ie*Y.r,_y1:W?z+ee.BL[1]:he+ie*Y.r,text:de.join("<br>"),name:Q.hovertemplate||te.indexOf("name")!==-1?Q.name:void 0,idealAlign:ee.pxmid[0]<0?"left":"right",color:a.castOption(ve.bgcolor,ee.pts)||ee.color,borderColor:a.castOption(ve.bordercolor,ee.pts),fontFamily:a.castOption(ke.family,ee.pts),fontSize:a.castOption(ke.size,ee.pts),fontColor:a.castOption(ke.color,ee.pts),nameLength:a.castOption(ve.namelength,ee.pts),textAlign:a.castOption(ve.align,ee.pts),hovertemplate:a.castOption(Q.hovertemplate,ee.pts),hovertemplateLabels:ee,eventData:[g(ee,Q)]},{container:J._hoverlayer.node(),outerContainer:J._paper.node(),gd:Z,inOut_bbox:Ee}),ee.bbox=Ee[0],j._hasHoverLabel=!0}j._hasHoverEvent=!0,Z.emit("plotly_hover",{points:[g(ee,Q)],event:t.event})}}),K.on("mouseout",function(ee){var J=Z._fullLayout,Q=Z._fullData[j.index],te=t.select(this).datum();j._hasHoverEvent&&(ee.originalEvent=t.event,Z.emit("plotly_unhover",{points:[g(te,Q)],event:t.event}),j._hasHoverEvent=!1),j._hasHoverLabel&&(m.loneUnhover(J._hoverlayer.node()),j._hasHoverLabel=!1)}),K.on("click",function(ee){var J=Z._fullLayout,Q=Z._fullData[j.index];Z._dragging||J.hovermode===!1||(Z._hoverdata=[g(ee,Q)],m.click(Z,t.event))})}function v(K,Z,H){var Y=a.castOption(K.insidetextfont.color,Z.pts);!Y&&K._input.textfont&&(Y=a.castOption(K._input.textfont.color,Z.pts));var $=a.castOption(K.insidetextfont.family,Z.pts)||a.castOption(K.textfont.family,Z.pts)||H.family,z=a.castOption(K.insidetextfont.size,Z.pts)||a.castOption(K.textfont.size,Z.pts)||H.size;return{color:Y||p.contrast(Z.color),family:$,size:z}}function _(K,Z){for(var H,Y,$=0;$<K.length;$++)if((Y=(H=K[$][0]).trace).title.text){var z=Y.title.text;Y._meta&&(z=f.templateString(z,Y._meta));var j=e.tester.append("text").attr("data-notex",1).text(z).call(e.font,Y.title.font).call(l.convertToTspans,Z),W=e.bBox(j.node(),!0);H.titleBox={width:W.width,height:W.height},j.remove()}}function x(K,Z,H){var Y=H.r||Z.rpx1,$=Z.rInscribed;if(Z.startangle===Z.stopangle)return{rCenter:1-$,scale:0,rotate:0,textPosAngle:0};var z,j=Z.ring,W=j===1&&Math.abs(Z.startangle-Z.stopangle)===2*Math.PI,ee=Z.halfangle,J=Z.midangle,Q=H.trace.insidetextorientation,te=Q==="horizontal",ie=Q==="tangential",ae=Q==="radial",he=Q==="auto",se=[];if(!he){var de,ue=function(ce,ge){if(function(ze,Fe){var Ye=ze.startangle,rt=ze.stopangle;return Ye>Fe&&Fe>rt||Ye<Fe&&Fe<rt}(Z,ce)){var we=Math.abs(ce-Z.startangle),Me=Math.abs(ce-Z.stopangle),Se=we<Me?we:Me;(z=ge==="tan"?A(K,Y,j,Se,0):T(K,Y,j,Se,Math.PI/2)).textPosAngle=ce,se.push(z)}};if(te||ie){for(de=4;de>=-4;de-=2)ue(Math.PI*de,"tan");for(de=4;de>=-4;de-=2)ue(Math.PI*(de+1),"tan")}if(te||ae){for(de=4;de>=-4;de-=2)ue(Math.PI*(de+1.5),"rad");for(de=4;de>=-4;de-=2)ue(Math.PI*(de+.5),"rad")}}if(W||he||te){var ve=Math.sqrt(K.width*K.width+K.height*K.height);if((z={scale:$*Y*2/ve,rCenter:1-$,rotate:0}).textPosAngle=(Z.startangle+Z.stopangle)/2,z.scale>=1)return z;se.push(z)}(he||ae)&&((z=T(K,Y,j,ee,J)).textPosAngle=(Z.startangle+Z.stopangle)/2,se.push(z)),(he||ie)&&((z=A(K,Y,j,ee,J)).textPosAngle=(Z.startangle+Z.stopangle)/2,se.push(z));for(var ke=0,Ee=0,be=0;be<se.length;be++){var xe=se[be].scale;if(Ee<xe&&(Ee=xe,ke=be),!he&&Ee>=1)break}return se[ke]}function T(K,Z,H,Y,$){Z=Math.max(0,Z-2*n);var z=K.width/K.height,j=C(z,Y,Z,H);return{scale:2*j/K.height,rCenter:S(z,j/Z),rotate:w($)}}function A(K,Z,H,Y,$){Z=Math.max(0,Z-2*n);var z=K.height/K.width,j=C(z,Y,Z,H);return{scale:2*j/K.width,rCenter:S(z,j/Z),rotate:w($+Math.PI/2)}}function S(K,Z){return Math.cos(Z)-K*Z}function w(K){return(180/Math.PI*K+720)%180-90}function C(K,Z,H,Y){var $=K+1/(2*Math.tan(Z));return H*Math.min(1/(Math.sqrt($*$+.5)+$),Y/(Math.sqrt(K*K+Y/2)+K))}function k(K,Z){return K.v!==Z.vTotal||Z.trace.hole?Math.min(1/(1+1/Math.sin(K.halfangle)),K.ring/2):1}function L(K,Z){var H=Z.pxmid[0],Y=Z.pxmid[1],$=K.width/2,z=K.height/2;return H<0&&($*=-1),Y<0&&(z*=-1),{scale:1,rCenter:1,rotate:0,x:$+Math.abs(z)*($>0?1:-1)/2,y:z/(1+H*H/(Y*Y)),outside:!0}}function M(K,Z){var H,Y,$,z=K.trace,j={x:K.cx,y:K.cy},W={tx:0,ty:0};W.ty+=z.title.font.size,$=D(z),z.title.position.indexOf("top")!==-1?(j.y-=(1+$)*K.r,W.ty-=K.titleBox.height):z.title.position.indexOf("bottom")!==-1&&(j.y+=(1+$)*K.r);var ee,J,Q=(ee=K.r,J=K.trace.aspectratio,ee/(J===void 0?1:J)),te=Z.w*(z.domain.x[1]-z.domain.x[0])/2;return z.title.position.indexOf("left")!==-1?(te+=Q,j.x-=(1+$)*Q,W.tx+=K.titleBox.width/2):z.title.position.indexOf("center")!==-1?te*=2:z.title.position.indexOf("right")!==-1&&(te+=Q,j.x+=(1+$)*Q,W.tx-=K.titleBox.width/2),H=te/K.titleBox.width,Y=P(K,Z)/K.titleBox.height,{x:j.x,y:j.y,scale:Math.min(H,Y),tx:W.tx,ty:W.ty}}function P(K,Z){var H=K.trace,Y=Z.h*(H.domain.y[1]-H.domain.y[0]);return Math.min(K.titleBox.height,Y/2)}function D(K){var Z,H=K.pull;if(!H)return 0;if(Array.isArray(H))for(H=0,Z=0;Z<K.pull.length;Z++)K.pull[Z]>H&&(H=K.pull[Z]);return H}function N(K,Z){for(var H=[],Y=0;Y<K.length;Y++){var $=K[Y][0],z=$.trace,j=z.domain,W=Z.w*(j.x[1]-j.x[0]),ee=Z.h*(j.y[1]-j.y[0]);z.title.text&&z.title.position!=="middle center"&&(ee-=P($,Z));var J=W/2,Q=ee/2;z.type!=="funnelarea"||z.scalegroup||(Q/=z.aspectratio),$.r=Math.min(J,Q)/(1+D(z)),$.cx=Z.l+Z.w*(z.domain.x[1]+z.domain.x[0])/2,$.cy=Z.t+Z.h*(1-z.domain.y[0])-ee/2,z.title.text&&z.title.position.indexOf("bottom")!==-1&&($.cy-=P($,Z)),z.scalegroup&&H.indexOf(z.scalegroup)===-1&&H.push(z.scalegroup)}(function(te,ie){for(var ae,he,se,de=0;de<ie.length;de++){var ue=1/0,ve=ie[de];for(he=0;he<te.length;he++)if(ae=te[he][0],(se=ae.trace).scalegroup===ve){var ke;if(se.type==="pie")ke=ae.r*ae.r;else if(se.type==="funnelarea"){var Ee,be;se.aspectratio>1?(Ee=ae.r,be=Ee/se.aspectratio):(be=ae.r,Ee=be*se.aspectratio),Ee*=(1+se.baseratio)/2,ke=Ee*be}ue=Math.min(ue,ke/ae.vTotal)}for(he=0;he<te.length;he++)if(ae=te[he][0],(se=ae.trace).scalegroup===ve){var xe=ue*ae.vTotal;se.type==="funnelarea"&&(xe/=(1+se.baseratio)/2,xe/=se.aspectratio),ae.r=Math.sqrt(xe)}}})(K,H)}function U(K,Z){return[K*Math.sin(Z),-K*Math.cos(Z)]}function q(K,Z,H){var Y=K._fullLayout,$=H.trace,z=$.texttemplate,j=$.textinfo;if(!z&&j&&j!=="none"){var W,ee=j.split("+"),J=function(ke){return ee.indexOf(ke)!==-1},Q=J("label"),te=J("text"),ie=J("value"),ae=J("percent"),he=Y.separators;if(W=Q?[Z.label]:[],te){var se=a.getFirstFilled($.text,Z.pts);h(se)&&W.push(se)}ie&&W.push(a.formatPieValue(Z.v,he)),ae&&W.push(a.formatPiePercent(Z.v/H.vTotal,he)),Z.text=W.join("<br>")}if(z){var de=f.castOption($,Z.i,"texttemplate");if(de){var ue=function(ke){return{label:ke.label,value:ke.v,valueLabel:a.formatPieValue(ke.v,Y.separators),percent:ke.v/H.vTotal,percentLabel:a.formatPiePercent(ke.v/H.vTotal,Y.separators),color:ke.color,text:ke.text,customdata:f.castOption($,ke.i,"customdata")}}(Z),ve=a.getFirstFilled($.text,Z.pts);(h(ve)||ve==="")&&(ue.text=ve),Z.text=f.texttemplateString(de,ue,K._fullLayout._d3locale,ue,$._meta||{})}else Z.text=""}}function X(K,Z){var H=K.rotate*Math.PI/180,Y=Math.cos(H),$=Math.sin(H),z=(Z.left+Z.right)/2,j=(Z.top+Z.bottom)/2;K.textX=z*Y-j*$,K.textY=z*$+j*Y,K.noCenter=!0}O.exports={plot:function(K,Z){var H=K._fullLayout,Y=H._size;c("pie",H),_(Z,K),N(Z,Y);var $=f.makeTraceGroups(H._pielayer,Z,"trace").each(function(z){var j=t.select(this),W=z[0],ee=W.trace;(function(J){var Q,te,ie,ae=J[0],he=ae.r,se=ae.trace,de=a.getRotationAngle(se.rotation),ue=2*Math.PI/ae.vTotal,ve="px0",ke="px1";if(se.direction==="counterclockwise"){for(Q=0;Q<J.length&&J[Q].hidden;Q++);if(Q===J.length)return;de+=ue*J[Q].v,ue*=-1,ve="px1",ke="px0"}for(ie=U(he,de),Q=0;Q<J.length;Q++)(te=J[Q]).hidden||(te[ve]=ie,te.startangle=de,de+=ue*te.v/2,te.pxmid=U(he,de),te.midangle=de,de+=ue*te.v/2,ie=U(he,de),te.stopangle=de,te[ke]=ie,te.largeArc=te.v>ae.vTotal/2?1:0,te.halfangle=Math.PI*Math.min(te.v/ae.vTotal,.5),te.ring=1-se.hole,te.rInscribed=k(te,ae))})(z),j.attr("stroke-linejoin","round"),j.each(function(){var J=t.select(this).selectAll("g.slice").data(z);J.enter().append("g").classed("slice",!0),J.exit().remove();var Q=[[[],[]],[[],[]]],te=!1;J.each(function(ke,Ee){if(ke.hidden)t.select(this).selectAll("path,g").remove();else{ke.pointNumber=ke.i,ke.curveNumber=ee.index,Q[ke.pxmid[1]<0?0:1][ke.pxmid[0]<0?0:1].push(ke);var be=W.cx,xe=W.cy,ce=t.select(this),ge=ce.selectAll("path.surface").data([ke]);if(ge.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),ce.call(y,K,z),ee.pull){var we=+a.castOption(ee.pull,ke.pts)||0;we>0&&(be+=we*ke.pxmid[0],xe+=we*ke.pxmid[1])}ke.cxFinal=be,ke.cyFinal=xe;var Me=ee.hole;if(ke.v===W.vTotal){var Se="M"+(be+ke.px0[0])+","+(xe+ke.px0[1])+Oe(ke.px0,ke.pxmid,!0,1)+Oe(ke.pxmid,ke.px0,!0,1)+"Z";Me?ge.attr("d","M"+(be+Me*ke.px0[0])+","+(xe+Me*ke.px0[1])+Oe(ke.px0,ke.pxmid,!1,Me)+Oe(ke.pxmid,ke.px0,!1,Me)+"Z"+Se):ge.attr("d",Se)}else{var ze=Oe(ke.px0,ke.px1,!0,1);if(Me){var Fe=1-Me;ge.attr("d","M"+(be+Me*ke.px1[0])+","+(xe+Me*ke.px1[1])+Oe(ke.px1,ke.px0,!1,Me)+"l"+Fe*ke.px0[0]+","+Fe*ke.px0[1]+ze+"Z")}else ge.attr("d","M"+be+","+xe+"l"+ke.px0[0]+","+ke.px0[1]+ze+"Z")}q(K,ke,W);var Ye=a.castOption(ee.textposition,ke.pts),rt=ce.selectAll("g.slicetext").data(ke.text&&Ye!=="none"?[0]:[]);rt.enter().append("g").classed("slicetext",!0),rt.exit().remove(),rt.each(function(){var je=f.ensureSingle(t.select(this),"text","",function(at){at.attr("data-notex",1)}),We=f.ensureUniformFontSize(K,Ye==="outside"?function(at,tt,_t){var er=a.castOption(at.outsidetextfont.color,tt.pts)||a.castOption(at.textfont.color,tt.pts)||_t.color,tr=a.castOption(at.outsidetextfont.family,tt.pts)||a.castOption(at.textfont.family,tt.pts)||_t.family,Ue=a.castOption(at.outsidetextfont.size,tt.pts)||a.castOption(at.textfont.size,tt.pts)||_t.size;return{color:er,family:tr,size:Ue}}(ee,ke,H.font):v(ee,ke,H.font));je.text(ke.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,We).call(l.convertToTspans,K);var qe,Qe=e.bBox(je.node());if(Ye==="outside")qe=L(Qe,ke);else if(qe=x(Qe,ke,W),Ye==="auto"&&qe.scale<1){var st=f.ensureUniformFontSize(K,ee.outsidetextfont);je.call(e.font,st),qe=L(Qe=e.bBox(je.node()),ke)}var ct=qe.textPosAngle,Pt=ct===void 0?ke.pxmid:U(W.r,ct);if(qe.targetX=be+Pt[0]*qe.rCenter+(qe.x||0),qe.targetY=xe+Pt[1]*qe.rCenter+(qe.y||0),X(qe,Qe),qe.outside){var kt=qe.targetY;ke.yLabelMin=kt-Qe.height/2,ke.yLabelMid=kt,ke.yLabelMax=kt+Qe.height/2,ke.labelExtraX=0,ke.labelExtraY=0,te=!0}qe.fontSize=We.size,i(ee.type,qe,H),z[Ee].transform=qe,je.attr("transform",f.getTextTransform(qe))})}function Oe(je,We,qe,Qe){var st=Qe*(We[0]-je[0]),ct=Qe*(We[1]-je[1]);return"a"+Qe*W.r+","+Qe*W.r+" 0 "+ke.largeArc+(qe?" 1 ":" 0 ")+st+","+ct}});var ie=t.select(this).selectAll("g.titletext").data(ee.title.text?[0]:[]);if(ie.enter().append("g").classed("titletext",!0),ie.exit().remove(),ie.each(function(){var ke,Ee=f.ensureSingle(t.select(this),"text","",function(xe){xe.attr("data-notex",1)}),be=ee.title.text;ee._meta&&(be=f.templateString(be,ee._meta)),Ee.text(be).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,ee.title.font).call(l.convertToTspans,K),ke=ee.title.position==="middle center"?function(xe){var ce=Math.sqrt(xe.titleBox.width*xe.titleBox.width+xe.titleBox.height*xe.titleBox.height);return{x:xe.cx,y:xe.cy,scale:xe.trace.hole*xe.r*2/ce,tx:0,ty:-xe.titleBox.height/2+xe.trace.title.font.size}}(W):M(W,Y),Ee.attr("transform",s(ke.x,ke.y)+u(Math.min(1,ke.scale))+s(ke.tx,ke.ty))}),te&&function(ke,Ee){var be,xe,ce,ge,we,Me,Se,ze,Fe,Ye,rt,Oe,je;function We(ct,Pt){return ct.pxmid[1]-Pt.pxmid[1]}function qe(ct,Pt){return Pt.pxmid[1]-ct.pxmid[1]}function Qe(ct,Pt){Pt||(Pt={});var kt,at,tt,_t,er=Pt.labelExtraY+(xe?Pt.yLabelMax:Pt.yLabelMin),tr=xe?ct.yLabelMin:ct.yLabelMax,Ue=xe?ct.yLabelMax:ct.yLabelMin,He=ct.cyFinal+we(ct.px0[1],ct.px1[1]),Be=er-tr;if(Be*Se>0&&(ct.labelExtraY=Be),Array.isArray(Ee.pull))for(at=0;at<Ye.length;at++)(tt=Ye[at])===ct||(a.castOption(Ee.pull,ct.pts)||0)>=(a.castOption(Ee.pull,tt.pts)||0)||((ct.pxmid[1]-tt.pxmid[1])*Se>0?(Be=tt.cyFinal+we(tt.px0[1],tt.px1[1])-tr-ct.labelExtraY)*Se>0&&(ct.labelExtraY+=Be):(Ue+ct.labelExtraY-He)*Se>0&&(kt=3*Me*Math.abs(at-Ye.indexOf(ct)),(_t=tt.cxFinal+ge(tt.px0[0],tt.px1[0])+kt-(ct.cxFinal+ct.pxmid[0])-ct.labelExtraX)*Me>0&&(ct.labelExtraX+=_t)))}for(xe=0;xe<2;xe++)for(ce=xe?We:qe,we=xe?Math.max:Math.min,Se=xe?1:-1,be=0;be<2;be++){for(ge=be?Math.max:Math.min,Me=be?1:-1,(ze=ke[xe][be]).sort(ce),Fe=ke[1-xe][be],Ye=Fe.concat(ze),Oe=[],rt=0;rt<ze.length;rt++)ze[rt].yLabelMid!==void 0&&Oe.push(ze[rt]);for(je=!1,rt=0;xe&&rt<Fe.length;rt++)if(Fe[rt].yLabelMid!==void 0){je=Fe[rt];break}for(rt=0;rt<Oe.length;rt++){var st=rt&&Oe[rt-1];je&&!rt&&(st=je),Qe(Oe[rt],st)}}}(Q,ee),function(ke,Ee){ke.each(function(be){var xe=t.select(this);if(be.labelExtraX||be.labelExtraY){var ce=xe.select("g.slicetext text");be.transform.targetX+=be.labelExtraX,be.transform.targetY+=be.labelExtraY,ce.attr("transform",f.getTextTransform(be.transform));var ge=be.cxFinal+be.pxmid[0],we="M"+ge+","+(be.cyFinal+be.pxmid[1]),Me=(be.yLabelMax-be.yLabelMin)*(be.pxmid[0]<0?-1:1)/4;if(be.labelExtraX){var Se=be.labelExtraX*be.pxmid[1]/be.pxmid[0],ze=be.yLabelMid+be.labelExtraY-(be.cyFinal+be.pxmid[1]);Math.abs(Se)>Math.abs(ze)?we+="l"+ze*be.pxmid[0]/be.pxmid[1]+","+ze+"H"+(ge+be.labelExtraX+Me):we+="l"+be.labelExtraX+","+Se+"v"+(ze-Se)+"h"+Me}else we+="V"+(be.yLabelMid+be.labelExtraY)+"h"+Me;f.ensureSingle(xe,"path","textline").call(p.stroke,Ee.outsidetextfont.color).attr({"stroke-width":Math.min(2,Ee.outsidetextfont.size/8),d:we,fill:"none"})}else xe.select("path.textline").remove()})}(J,ee),te&&ee.automargin){var ae=e.bBox(j.node()),he=ee.domain,se=Y.w*(he.x[1]-he.x[0]),de=Y.h*(he.y[1]-he.y[0]),ue=(.5*se-W.r)/Y.w,ve=(.5*de-W.r)/Y.h;d.autoMargin(K,"pie."+ee.uid+".automargin",{xl:he.x[0]-ue,xr:he.x[1]+ue,yb:he.y[0]-ve,yt:he.y[1]+ve,l:Math.max(W.cx-W.r-ae.left,0),r:Math.max(ae.right-(W.cx+W.r),0),b:Math.max(ae.bottom-(W.cy+W.r),0),t:Math.max(W.cy-W.r-ae.top,0),pad:5})}})});setTimeout(function(){$.selectAll("tspan").each(function(){var z=t.select(this);z.attr("dy")&&z.attr("dy",z.attr("dy"))})},0)},formatSliceLabel:q,transformInsideText:x,determineInsideTextFont:v,positionTitleOutside:M,prerenderTitles:_,layoutAreas:N,attachFxHandlers:y,computeTransform:X}},{"../../components/color":650,"../../components/drawing":672,"../../components/fx":690,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/plots":901,"../bar/constants":927,"../bar/uniform_text":941,"./event_data":1180,"./helpers":1181,"@plotly/d3":58}],1186:[function(r,O,B){var t=r("@plotly/d3"),d=r("./style_one"),m=r("../bar/uniform_text").resizeText;O.exports=function(p){var e=p._fullLayout._pielayer.selectAll(".trace");m(p,e,"pie"),e.each(function(f){var u=f[0].trace,s=t.select(this);s.style({opacity:u.opacity}),s.selectAll("path.surface").each(function(l){t.select(this).call(d,l,u)})})}},{"../bar/uniform_text":941,"./style_one":1187,"@plotly/d3":58}],1187:[function(r,O,B){var t=r("../../components/color"),d=r("./helpers").castOption;O.exports=function(m,p,e){var f=e.marker.line,u=d(f.color,p.pts)||t.defaultLine,s=d(f.width,p.pts)||0;m.style("stroke-width",s).call(t.fill,p.color).call(t.stroke,u)}},{"../../components/color":650,"./helpers":1181}],1188:[function(r,O,B){var t=r("../scatter/attributes");O.exports={x:t.x,y:t.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:t.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":1202}],1189:[function(r,O,B){var t=r("gl-pointcloud2d"),d=r("../../lib/str2rgbarray"),m=r("../../plots/cartesian/autorange").findExtremes,p=r("../scatter/get_trace_color");function e(u,s){this.scene=u,this.uid=s,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=t(u.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var f=e.prototype;f.handlePick=function(u){var s=this.idToIndex[u.pointId];return{trace:this,dataCoord:u.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*s],this.pickXYData[2*s+1]]:[this.pickXData[s],this.pickYData[s]],textLabel:Array.isArray(this.textLabels)?this.textLabels[s]:this.textLabels,color:this.color,name:this.name,pointIndex:s,hoverinfo:this.hoverinfo}},f.update=function(u){this.index=u.index,this.textLabels=u.text,this.name=u.name,this.hoverinfo=u.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(u),this.color=p(u,{})},f.updateFast=function(u){var s,l,o,i,c,n,a=this.xData=this.pickXData=u.x,g=this.yData=this.pickYData=u.y,h=this.pickXYData=u.xy,y=u.xbounds&&u.ybounds,v=u.indices,_=this.bounds;if(h){if(o=h,s=h.length>>>1,y)_[0]=u.xbounds[0],_[2]=u.xbounds[1],_[1]=u.ybounds[0],_[3]=u.ybounds[1];else for(n=0;n<s;n++)i=o[2*n],c=o[2*n+1],i<_[0]&&(_[0]=i),i>_[2]&&(_[2]=i),c<_[1]&&(_[1]=c),c>_[3]&&(_[3]=c);if(v)l=v;else for(l=new Int32Array(s),n=0;n<s;n++)l[n]=n}else for(s=a.length,o=new Float32Array(2*s),l=new Int32Array(s),n=0;n<s;n++)i=a[n],c=g[n],l[n]=n,o[2*n]=i,o[2*n+1]=c,i<_[0]&&(_[0]=i),i>_[2]&&(_[2]=i),c<_[1]&&(_[1]=c),c>_[3]&&(_[3]=c);this.idToIndex=l,this.pointcloudOptions.idToIndex=l,this.pointcloudOptions.positions=o;var x=d(u.marker.color),T=d(u.marker.border.color),A=u.opacity*u.marker.opacity;x[3]*=A,this.pointcloudOptions.color=x;var S=u.marker.blend;S===null&&(S=a.length<100||g.length<100),this.pointcloudOptions.blend=S,T[3]*=A,this.pointcloudOptions.borderColor=T;var w=u.marker.sizemin,C=Math.max(u.marker.sizemax,u.marker.sizemin);this.pointcloudOptions.sizeMin=w,this.pointcloudOptions.sizeMax=C,this.pointcloudOptions.areaRatio=u.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var k=this.scene.xaxis,L=this.scene.yaxis,M=C/2||.5;u._extremes[k._id]=m(k,[_[0],_[2]],{ppad:M}),u._extremes[L._id]=m(L,[_[1],_[3]],{ppad:M})},f.dispose=function(){this.pointcloud.dispose()},O.exports=function(u,s){var l=new e(u,s.uid);return l.update(s),l}},{"../../lib/str2rgbarray":812,"../../plots/cartesian/autorange":837,"../scatter/get_trace_color":1212,"gl-pointcloud2d":321}],1190:[function(r,O,B){var t=r("../../lib"),d=r("./attributes");O.exports=function(m,p,e){function f(u,s){return t.coerce(m,p,d,u,s)}f("x"),f("y"),f("xbounds"),f("ybounds"),m.xy&&m.xy instanceof Float32Array&&(p.xy=m.xy),m.indices&&m.indices instanceof Int32Array&&(p.indices=m.indices),f("text"),f("marker.color",e),f("marker.opacity"),f("marker.blend"),f("marker.sizemin"),f("marker.sizemax"),f("marker.border.color",e),f("marker.border.arearatio"),p._length=null}},{"../../lib":787,"./attributes":1188}],1191:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("../scatter3d/calc"),plot:r("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:r("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":878,"../scatter3d/calc":1231,"./attributes":1188,"./convert":1189,"./defaults":1190}],1192:[function(r,O,B){var t=r("../../plots/font_attributes"),d=r("../../plots/attributes"),m=r("../../components/color/attributes"),p=r("../../components/fx/attributes"),e=r("../../plots/domain").attributes,f=r("../../plots/template_attributes").hovertemplateAttrs,u=r("../../components/colorscale/attributes"),s=r("../../plot_api/plot_template").templatedArray,l=r("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,o=r("../../lib/extend").extendFlat,i=r("../../plot_api/edit_types").overrideAll;(O.exports=i({hoverinfo:o({},d.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:p.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:l("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:t({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:m.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:p.hoverlabel,hovertemplate:f({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:m.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:p.hoverlabel,hovertemplate:f({},{keys:["value","label"]}),colorscales:s("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:o(u().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested")).transforms=void 0},{"../../components/color/attributes":649,"../../components/colorscale/attributes":657,"../../components/fx/attributes":681,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/domain":866,"../../plots/font_attributes":867,"../../plots/template_attributes":910}],1193:[function(r,O,B){var t=r("../../plot_api/edit_types").overrideAll,d=r("../../plots/get_data").getModuleCalcData,m=r("./plot"),p=r("../../components/fx/layout_attributes"),e=r("../../lib/setcursor"),f=r("../../components/dragelement"),u=r("../../plots/cartesian/select").prepSelect,s=r("../../lib"),l=r("../../registry");function o(i,c){var n=i._fullData[c],a=i._fullLayout,g=a.dragmode,h=a.dragmode==="pan"?"move":"crosshair",y=n._bgRect;if(g!=="pan"&&g!=="zoom"){e(y,h);var v={_id:"x",c2p:s.identity,_offset:n._sankey.translateX,_length:n._sankey.width},_={_id:"y",c2p:s.identity,_offset:n._sankey.translateY,_length:n._sankey.height},x={gd:i,element:y.node(),plotinfo:{id:c,xaxis:v,yaxis:_,fillRangeItems:s.noop},subplot:c,xaxes:[v],yaxes:[_],doneFnCompleted:function(T){var A,S=i._fullData[c],w=S.node.groups.slice(),C=[];function k(D){for(var N=S._sankey.graph.nodes,U=0;U<N.length;U++)if(N[U].pointNumber===D)return N[U]}for(var L=0;L<T.length;L++){var M=k(T[L].pointNumber);if(M)if(M.group){for(var P=0;P<M.childrenNodes.length;P++)C.push(M.childrenNodes[P].pointNumber);w[M.pointNumber-S.node._count]=!1}else C.push(M.pointNumber)}A=w.filter(Boolean).concat([C]),l.call("_guiRestyle",i,{"node.groups":[A]},c)},prepFn:function(T,A,S){u(T,A,S,x,g)}};f.init(x)}}B.name="sankey",B.baseLayoutAttrOverrides=t({hoverlabel:p.hoverlabel},"plot","nested"),B.plot=function(i){var c=d(i.calcdata,"sankey")[0];m(i,c),B.updateFx(i)},B.clean=function(i,c,n,a){var g=a._has&&a._has("sankey"),h=c._has&&c._has("sankey");g&&!h&&(a._paperdiv.selectAll(".sankey").remove(),a._paperdiv.selectAll(".bgsankey").remove())},B.updateFx=function(i){for(var c=0;c<i._fullData.length;c++)o(i,c)}},{"../../components/dragelement":669,"../../components/fx/layout_attributes":691,"../../lib":787,"../../lib/setcursor":808,"../../plot_api/edit_types":820,"../../plots/cartesian/select":858,"../../plots/get_data":875,"../../registry":915,"./plot":1198}],1194:[function(r,O,B){var t=r("strongly-connected-components"),d=r("../../lib"),m=r("../../lib/gup").wrap,p=d.isArrayOrTypedArray,e=d.isIndex,f=r("../../components/colorscale");function u(s){var l,o=s.node,i=s.link,c=[],n=p(i.color),a=p(i.customdata),g={},h={},y=i.colorscales.length;for(l=0;l<y;l++){var v=i.colorscales[l],_=f.extractScale(v,{cLetter:"c"}),x=f.makeColorScaleFunc(_);h[v.label]=x}var T=0;for(l=0;l<i.value.length;l++)i.source[l]>T&&(T=i.source[l]),i.target[l]>T&&(T=i.target[l]);var A,S=T+1;s.node._count=S;var w=s.node.groups,C={};for(l=0;l<w.length;l++){var k=w[l];for(A=0;A<k.length;A++){var L=k[A],M=S+l;C.hasOwnProperty(L)?d.warn("Node "+L+" is already part of a group."):C[L]=M}}var P={source:[],target:[]};for(l=0;l<i.value.length;l++){var D=i.value[l],N=i.source[l],U=i.target[l];if(D>0&&e(N,S)&&e(U,S)&&(!C.hasOwnProperty(N)||!C.hasOwnProperty(U)||C[N]!==C[U])){C.hasOwnProperty(U)&&(U=C[U]),C.hasOwnProperty(N)&&(N=C[N]),U=+U,g[N=+N]=g[U]=!0;var q="";i.label&&i.label[l]&&(q=i.label[l]);var X=null;q&&h.hasOwnProperty(q)&&(X=h[q]),c.push({pointNumber:l,label:q,color:n?i.color[l]:i.color,customdata:a?i.customdata[l]:i.customdata,concentrationscale:X,source:N,target:U,value:+D}),P.source.push(N),P.target.push(U)}}var K=S+w.length,Z=p(o.color),H=p(o.customdata),Y=[];for(l=0;l<K;l++)if(g[l]){var $=o.label[l];Y.push({group:l>S-1,childrenNodes:[],pointNumber:l,label:$,color:Z?o.color[l]:o.color,customdata:H?o.customdata[l]:o.customdata})}var z=!1;return function(j,W,ee){for(var J=d.init2dArray(j,0),Q=0;Q<Math.min(W.length,ee.length);Q++)if(d.isIndex(W[Q],j)&&d.isIndex(ee[Q],j)){if(W[Q]===ee[Q])return!0;J[W[Q]].push(ee[Q])}return t(J).components.some(function(te){return te.length>1})}(K,P.source,P.target)&&(z=!0),{circular:z,links:c,nodes:Y,groups:w,groupLookup:C}}O.exports=function(s,l){var o=u(l);return m({circular:o.circular,_nodes:o.nodes,_links:o.links,_groups:o.groups,_groupLookup:o.groupLookup})}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gup":784,"strongly-connected-components":575}],1195:[function(r,O,B){O.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],1196:[function(r,O,B){var t=r("../../lib"),d=r("./attributes"),m=r("../../components/color"),p=r("tinycolor2"),e=r("../../plots/domain").defaults,f=r("../../components/fx/hoverlabel_defaults"),u=r("../../plot_api/plot_template"),s=r("../../plots/array_container_defaults");function l(o,i){function c(n,a){return t.coerce(o,i,d.link.colorscales,n,a)}c("label"),c("cmin"),c("cmax"),c("colorscale")}O.exports=function(o,i,c,n){function a(C,k){return t.coerce(o,i,d,C,k)}var g=t.extendDeep(n.hoverlabel,o.hoverlabel),h=o.node,y=u.newContainer(i,"node");function v(C,k){return t.coerce(h,y,d.node,C,k)}v("label"),v("groups"),v("x"),v("y"),v("pad"),v("thickness"),v("line.color"),v("line.width"),v("hoverinfo",o.hoverinfo),f(h,y,v,g),v("hovertemplate");var _=n.colorway;v("color",y.label.map(function(C,k){return m.addOpacity(function(L){return _[L%_.length]}(k),.8)})),v("customdata");var x=o.link||{},T=u.newContainer(i,"link");function A(C,k){return t.coerce(x,T,d.link,C,k)}A("label"),A("source"),A("target"),A("value"),A("line.color"),A("line.width"),A("hoverinfo",o.hoverinfo),f(x,T,A,g),A("hovertemplate");var S,w=p(n.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";A("color",t.repeat(w,T.value.length)),A("customdata"),s(x,T,{name:"colorscales",handleItemDefaults:l}),e(i,n,a),a("orientation"),a("valueformat"),a("valuesuffix"),y.x.length&&y.y.length&&(S="freeform"),a("arrangement",S),t.coerceFont(a,"textfont",t.extendFlat({},n.font)),i._length=null}},{"../../components/color":650,"../../components/fx/hoverlabel_defaults":688,"../../lib":787,"../../plot_api/plot_template":827,"../../plots/array_container_defaults":833,"../../plots/domain":866,"./attributes":1192,tinycolor2:583}],1197:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),moduleType:"trace",name:"sankey",basePlotModule:r("./base_plot"),selectPoints:r("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":1192,"./base_plot":1193,"./calc":1194,"./defaults":1196,"./plot":1198,"./select.js":1200}],1198:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=d.numberFormat,p=r("./render"),e=r("../../components/fx"),f=r("../../components/color"),u=r("./constants").cn,s=d._;function l(x){return x!==""}function o(x,T){return x.filter(function(A){return A.key===T.traceId})}function i(x,T){t.select(x).select("path").style("fill-opacity",T),t.select(x).select("rect").style("fill-opacity",T)}function c(x){t.select(x).select("text.name").style("fill","black")}function n(x){return function(T){return x.node.sourceLinks.indexOf(T.link)!==-1||x.node.targetLinks.indexOf(T.link)!==-1}}function a(x){return function(T){return T.node.sourceLinks.indexOf(x.link)!==-1||T.node.targetLinks.indexOf(x.link)!==-1}}function g(x,T,A){T&&A&&o(A,T).selectAll("."+u.sankeyLink).filter(n(T)).call(y.bind(0,T,A,!1))}function h(x,T,A){T&&A&&o(A,T).selectAll("."+u.sankeyLink).filter(n(T)).call(v.bind(0,T,A,!1))}function y(x,T,A,S){var w=S.datum().link.label;S.style("fill-opacity",function(C){if(!C.link.concentrationscale)return .4}),w&&o(T,x).selectAll("."+u.sankeyLink).filter(function(C){return C.link.label===w}).style("fill-opacity",function(C){if(!C.link.concentrationscale)return .4}),A&&o(T,x).selectAll("."+u.sankeyNode).filter(a(x)).call(g)}function v(x,T,A,S){var w=S.datum().link.label;S.style("fill-opacity",function(C){return C.tinyColorAlpha}),w&&o(T,x).selectAll("."+u.sankeyLink).filter(function(C){return C.link.label===w}).style("fill-opacity",function(C){return C.tinyColorAlpha}),A&&o(T,x).selectAll(u.sankeyNode).filter(a(x)).call(h)}function _(x,T){var A=x.hoverlabel||{},S=d.nestedProperty(A,T).get();return!Array.isArray(S)&&S}O.exports=function(x,T){for(var A=x._fullLayout,S=A._paper,w=A._size,C=0;C<x._fullData.length;C++)if(x._fullData[C].visible&&x._fullData[C].type===u.sankey&&!x._fullData[C]._viewInitial){var k=x._fullData[C].node;x._fullData[C]._viewInitial={node:{groups:k.groups.slice(),x:k.x.slice(),y:k.y.slice()}}}var L=s(x,"source:")+" ",M=s(x,"target:")+" ",P=s(x,"concentration:")+" ",D=s(x,"incoming flow count:")+" ",N=s(x,"outgoing flow count:")+" ";p(x,S,T,{width:w.w,height:w.h,margin:{t:w.t,r:w.r,b:w.b,l:w.l}},{linkEvents:{hover:function(U,q,X){x._fullLayout.hovermode!==!1&&(t.select(U).call(y.bind(0,q,X,!0)),q.link.trace.link.hoverinfo!=="skip"&&(q.link.fullData=q.link.trace,x.emit("plotly_hover",{event:t.event,points:[q.link]})))},follow:function(U,q){if(x._fullLayout.hovermode!==!1){var X=q.link.trace.link;if(X.hoverinfo!=="none"&&X.hoverinfo!=="skip"){for(var K=[],Z=0,H=0;H<q.flow.links.length;H++){var Y=q.flow.links[H];if(x._fullLayout.hovermode!=="closest"||q.link.pointNumber===Y.pointNumber){q.link.pointNumber===Y.pointNumber&&(Z=H),Y.fullData=Y.trace,X=q.link.trace.link;var $=j(Y),z={valueLabel:m(q.valueFormat)(Y.value)+q.valueSuffix};K.push({x:$[0],y:$[1],name:z.valueLabel,text:[Y.label||"",L+Y.source.label,M+Y.target.label,Y.concentrationscale?P+m("%0.2f")(Y.flow.labelConcentration):""].filter(l).join("<br>"),color:_(X,"bgcolor")||f.addOpacity(Y.color,1),borderColor:_(X,"bordercolor"),fontFamily:_(X,"font.family"),fontSize:_(X,"font.size"),fontColor:_(X,"font.color"),nameLength:_(X,"namelength"),textAlign:_(X,"align"),idealAlign:t.event.x<$[0]?"right":"left",hovertemplate:X.hovertemplate,hovertemplateLabels:z,eventData:[Y]})}}e.loneHover(K,{container:A._hoverlayer.node(),outerContainer:A._paper.node(),gd:x,anchorIndex:Z}).each(function(){q.link.concentrationscale||i(this,.65),c(this)})}}function j(W){var ee,J;W.circular?(ee=(W.circularPathData.leftInnerExtent+W.circularPathData.rightInnerExtent)/2,J=W.circularPathData.verticalFullExtent):(ee=(W.source.x1+W.target.x0)/2,J=(W.y0+W.y1)/2);var Q=[ee,J];return W.trace.orientation==="v"&&Q.reverse(),Q[0]+=q.parent.translateX,Q[1]+=q.parent.translateY,Q}},unhover:function(U,q,X){x._fullLayout.hovermode!==!1&&(t.select(U).call(v.bind(0,q,X,!0)),q.link.trace.link.hoverinfo!=="skip"&&(q.link.fullData=q.link.trace,x.emit("plotly_unhover",{event:t.event,points:[q.link]})),e.loneUnhover(A._hoverlayer.node()))},select:function(U,q){var X=q.link;X.originalEvent=t.event,x._hoverdata=[X],e.click(x,{target:!0})}},nodeEvents:{hover:function(U,q,X){x._fullLayout.hovermode!==!1&&(t.select(U).call(g,q,X),q.node.trace.node.hoverinfo!=="skip"&&(q.node.fullData=q.node.trace,x.emit("plotly_hover",{event:t.event,points:[q.node]})))},follow:function(U,q){if(x._fullLayout.hovermode!==!1){var X=q.node.trace.node;if(X.hoverinfo!=="none"&&X.hoverinfo!=="skip"){var K=t.select(U).select("."+u.nodeRect),Z=x._fullLayout._paperdiv.node().getBoundingClientRect(),H=K.node().getBoundingClientRect(),Y=H.left-2-Z.left,$=H.right+2-Z.left,z=H.top+H.height/4-Z.top,j={valueLabel:m(q.valueFormat)(q.node.value)+q.valueSuffix};q.node.fullData=q.node.trace,x._fullLayout._calcInverseTransform(x);var W=x._fullLayout._invScaleX,ee=x._fullLayout._invScaleY,J=e.loneHover({x0:W*Y,x1:W*$,y:ee*z,name:m(q.valueFormat)(q.node.value)+q.valueSuffix,text:[q.node.label,D+q.node.targetLinks.length,N+q.node.sourceLinks.length].filter(l).join("<br>"),color:_(X,"bgcolor")||q.tinyColorHue,borderColor:_(X,"bordercolor"),fontFamily:_(X,"font.family"),fontSize:_(X,"font.size"),fontColor:_(X,"font.color"),nameLength:_(X,"namelength"),textAlign:_(X,"align"),idealAlign:"left",hovertemplate:X.hovertemplate,hovertemplateLabels:j,eventData:[q.node]},{container:A._hoverlayer.node(),outerContainer:A._paper.node(),gd:x});i(J,.85),c(J)}}},unhover:function(U,q,X){x._fullLayout.hovermode!==!1&&(t.select(U).call(h,q,X),q.node.trace.node.hoverinfo!=="skip"&&(q.node.fullData=q.node.trace,x.emit("plotly_unhover",{event:t.event,points:[q.node]})),e.loneUnhover(A._hoverlayer.node()))},select:function(U,q,X){var K=q.node;K.originalEvent=t.event,x._hoverdata=[K],t.select(U).call(h,q,X),e.click(x,{target:!0})}}})}},{"../../components/color":650,"../../components/fx":690,"../../lib":787,"./constants":1195,"./render":1199,"@plotly/d3":58}],1199:[function(r,O,B){var t=r("d3-force"),d=r("d3-interpolate").interpolateNumber,m=r("@plotly/d3"),p=r("@plotly/d3-sankey"),e=r("@plotly/d3-sankey-circular"),f=r("./constants"),u=r("tinycolor2"),s=r("../../components/color"),l=r("../../components/drawing"),o=r("../../lib"),i=o.strTranslate,c=o.strRotate,n=r("../../lib/gup"),a=n.keyFun,g=n.repeat,h=n.unwrap,y=r("../../lib/svg_text_utils"),v=r("../../registry"),_=r("../../constants/alignment"),x=_.CAP_SHIFT,T=_.LINE_SPACING;function A(H,Y,$){var z,j=h(Y),W=j.trace,ee=W.domain,J=W.orientation==="h",Q=W.node.pad,te=W.node.thickness,ie=H.width*(ee.x[1]-ee.x[0]),ae=H.height*(ee.y[1]-ee.y[0]),he=j._nodes,se=j._links,de=j.circular;(z=de?e.sankeyCircular().circularLinkGap(0):p.sankey()).iterations(f.sankeyIterations).size(J?[ie,ae]:[ae,ie]).nodeWidth(te).nodePadding(Q).nodeId(function(Se){return Se.pointNumber}).nodes(he).links(se);var ue,ve,ke,Ee=z();for(var be in z.nodePadding()<Q&&o.warn("node.pad was reduced to ",z.nodePadding()," to fit within the figure."),j._groupLookup){var xe,ce=parseInt(j._groupLookup[be]);for(ue=0;ue<Ee.nodes.length;ue++)if(Ee.nodes[ue].pointNumber===ce){xe=Ee.nodes[ue];break}if(xe){var ge={pointNumber:parseInt(be),x0:xe.x0,x1:xe.x1,y0:xe.y0,y1:xe.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};Ee.nodes.unshift(ge),xe.childrenNodes.unshift(ge)}}if(function(){for(ue=0;ue<Ee.nodes.length;ue++){var Se,ze,Fe=Ee.nodes[ue],Ye={};for(ve=0;ve<Fe.targetLinks.length;ve++)Se=(ze=Fe.targetLinks[ve]).source.pointNumber+":"+ze.target.pointNumber,Ye.hasOwnProperty(Se)||(Ye[Se]=[]),Ye[Se].push(ze);var rt=Object.keys(Ye);for(ve=0;ve<rt.length;ve++){var Oe=Ye[Se=rt[ve]],je=0,We={};for(ke=0;ke<Oe.length;ke++)We[(ze=Oe[ke]).label]||(We[ze.label]=0),We[ze.label]+=ze.value,je+=ze.value;for(ke=0;ke<Oe.length;ke++)(ze=Oe[ke]).flow={value:je,labelConcentration:We[ze.label]/je,concentration:ze.value/je,links:Oe},ze.concentrationscale&&(ze.color=u(ze.concentrationscale(ze.flow.labelConcentration)))}var qe=0;for(ve=0;ve<Fe.sourceLinks.length;ve++)qe+=Fe.sourceLinks[ve].value;for(ve=0;ve<Fe.sourceLinks.length;ve++)(ze=Fe.sourceLinks[ve]).concentrationOut=ze.value/qe;var Qe=0;for(ve=0;ve<Fe.targetLinks.length;ve++)Qe+=Fe.targetLinks[ve].value;for(ve=0;ve<Fe.targetLinks.length;ve++)(ze=Fe.targetLinks[ve]).concenrationIn=ze.value/Qe}}(),W.node.x.length&&W.node.y.length){for(ue=0;ue<Math.min(W.node.x.length,W.node.y.length,Ee.nodes.length);ue++)if(W.node.x[ue]&&W.node.y[ue]){var we=[W.node.x[ue]*ie,W.node.y[ue]*ae];Ee.nodes[ue].x0=we[0]-te/2,Ee.nodes[ue].x1=we[0]+te/2;var Me=Ee.nodes[ue].y1-Ee.nodes[ue].y0;Ee.nodes[ue].y0=we[1]-Me/2,Ee.nodes[ue].y1=we[1]+Me/2}W.arrangement==="snap"&&function(Se){Se.forEach(function(ze){var Fe,Ye,rt,Oe=0,je=ze.length;for(ze.sort(function(We,qe){return We.y0-qe.y0}),rt=0;rt<je;++rt)(Fe=ze[rt]).y0>=Oe||(Ye=Oe-Fe.y0)>1e-6&&(Fe.y0+=Ye,Fe.y1+=Ye),Oe=Fe.y1+Q})}(function(Se){var ze,Fe,Ye=Se.map(function(qe,Qe){return{x0:qe.x0,index:Qe}}).sort(function(qe,Qe){return qe.x0-Qe.x0}),rt=[],Oe=-1,je=-1/0;for(ue=0;ue<Ye.length;ue++){var We=Se[Ye[ue].index];We.x0>je+te&&(Oe+=1,ze=We.x0),je=We.x0,rt[Oe]||(rt[Oe]=[]),rt[Oe].push(We),Fe=ze-We.x0,We.x0+=Fe,We.x1+=Fe}return rt}(he=Ee.nodes)),z.update(Ee)}return{circular:de,key:$,trace:W,guid:o.randstr(),horizontal:J,width:ie,height:ae,nodePad:W.node.pad,nodeLineColor:W.node.line.color,nodeLineWidth:W.node.line.width,linkLineColor:W.link.line.color,linkLineWidth:W.link.line.width,valueFormat:W.valueformat,valueSuffix:W.valuesuffix,textFont:W.textfont,translateX:ee.x[0]*H.width+H.margin.l,translateY:H.height-ee.y[1]*H.height+H.margin.t,dragParallel:J?ae:ie,dragPerpendicular:J?ie:ae,arrangement:W.arrangement,sankey:z,graph:Ee,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function S(H,Y,$){var z=u(Y.color),j=Y.source.label+"|"+Y.target.label+"__"+$;return Y.trace=H.trace,Y.curveNumber=H.trace.index,{circular:H.circular,key:j,traceId:H.key,pointNumber:Y.pointNumber,link:Y,tinyColorHue:s.tinyRGB(z),tinyColorAlpha:z.getAlpha(),linkPath:w,linkLineColor:H.linkLineColor,linkLineWidth:H.linkLineWidth,valueFormat:H.valueFormat,valueSuffix:H.valueSuffix,sankey:H.sankey,parent:H,interactionState:H.interactionState,flow:Y.flow}}function w(){return function(H){if(H.link.circular)return Y=H.link,$=Y.width/2,z=Y.circularPathData,Y.circularLinkType==="top"?"M "+z.targetX+" "+(z.targetY+$)+" L"+z.rightInnerExtent+" "+(z.targetY+$)+"A"+(z.rightLargeArcRadius+$)+" "+(z.rightSmallArcRadius+$)+" 0 0 1 "+(z.rightFullExtent-$)+" "+(z.targetY-z.rightSmallArcRadius)+"L"+(z.rightFullExtent-$)+" "+z.verticalRightInnerExtent+"A"+(z.rightLargeArcRadius+$)+" "+(z.rightLargeArcRadius+$)+" 0 0 1 "+z.rightInnerExtent+" "+(z.verticalFullExtent-$)+"L"+z.leftInnerExtent+" "+(z.verticalFullExtent-$)+"A"+(z.leftLargeArcRadius+$)+" "+(z.leftLargeArcRadius+$)+" 0 0 1 "+(z.leftFullExtent+$)+" "+z.verticalLeftInnerExtent+"L"+(z.leftFullExtent+$)+" "+(z.sourceY-z.leftSmallArcRadius)+"A"+(z.leftLargeArcRadius+$)+" "+(z.leftSmallArcRadius+$)+" 0 0 1 "+z.leftInnerExtent+" "+(z.sourceY+$)+"L"+z.sourceX+" "+(z.sourceY+$)+"L"+z.sourceX+" "+(z.sourceY-$)+"L"+z.leftInnerExtent+" "+(z.sourceY-$)+"A"+(z.leftLargeArcRadius-$)+" "+(z.leftSmallArcRadius-$)+" 0 0 0 "+(z.leftFullExtent-$)+" "+(z.sourceY-z.leftSmallArcRadius)+"L"+(z.leftFullExtent-$)+" "+z.verticalLeftInnerExtent+"A"+(z.leftLargeArcRadius-$)+" "+(z.leftLargeArcRadius-$)+" 0 0 0 "+z.leftInnerExtent+" "+(z.verticalFullExtent+$)+"L"+z.rightInnerExtent+" "+(z.verticalFullExtent+$)+"A"+(z.rightLargeArcRadius-$)+" "+(z.rightLargeArcRadius-$)+" 0 0 0 "+(z.rightFullExtent+$)+" "+z.verticalRightInnerExtent+"L"+(z.rightFullExtent+$)+" "+(z.targetY-z.rightSmallArcRadius)+"A"+(z.rightLargeArcRadius-$)+" "+(z.rightSmallArcRadius-$)+" 0 0 0 "+z.rightInnerExtent+" "+(z.targetY-$)+"L"+z.targetX+" "+(z.targetY-$)+"Z":"M "+z.targetX+" "+(z.targetY-$)+" L"+z.rightInnerExtent+" "+(z.targetY-$)+"A"+(z.rightLargeArcRadius+$)+" "+(z.rightSmallArcRadius+$)+" 0 0 0 "+(z.rightFullExtent-$)+" "+(z.targetY+z.rightSmallArcRadius)+"L"+(z.rightFullExtent-$)+" "+z.verticalRightInnerExtent+"A"+(z.rightLargeArcRadius+$)+" "+(z.rightLargeArcRadius+$)+" 0 0 0 "+z.rightInnerExtent+" "+(z.verticalFullExtent+$)+"L"+z.leftInnerExtent+" "+(z.verticalFullExtent+$)+"A"+(z.leftLargeArcRadius+$)+" "+(z.leftLargeArcRadius+$)+" 0 0 0 "+(z.leftFullExtent+$)+" "+z.verticalLeftInnerExtent+"L"+(z.leftFullExtent+$)+" "+(z.sourceY+z.leftSmallArcRadius)+"A"+(z.leftLargeArcRadius+$)+" "+(z.leftSmallArcRadius+$)+" 0 0 0 "+z.leftInnerExtent+" "+(z.sourceY-$)+"L"+z.sourceX+" "+(z.sourceY-$)+"L"+z.sourceX+" "+(z.sourceY+$)+"L"+z.leftInnerExtent+" "+(z.sourceY+$)+"A"+(z.leftLargeArcRadius-$)+" "+(z.leftSmallArcRadius-$)+" 0 0 1 "+(z.leftFullExtent-$)+" "+(z.sourceY+z.leftSmallArcRadius)+"L"+(z.leftFullExtent-$)+" "+z.verticalLeftInnerExtent+"A"+(z.leftLargeArcRadius-$)+" "+(z.leftLargeArcRadius-$)+" 0 0 1 "+z.leftInnerExtent+" "+(z.verticalFullExtent-$)+"L"+z.rightInnerExtent+" "+(z.verticalFullExtent-$)+"A"+(z.rightLargeArcRadius-$)+" "+(z.rightLargeArcRadius-$)+" 0 0 1 "+(z.rightFullExtent+$)+" "+z.verticalRightInnerExtent+"L"+(z.rightFullExtent+$)+" "+(z.targetY+z.rightSmallArcRadius)+"A"+(z.rightLargeArcRadius-$)+" "+(z.rightSmallArcRadius-$)+" 0 0 1 "+z.rightInnerExtent+" "+(z.targetY+$)+"L"+z.targetX+" "+(z.targetY+$)+"Z";var Y,$,z,j=H.link.source.x1,W=H.link.target.x0,ee=d(j,W),J=ee(.5),Q=ee(.5),te=H.link.y0-H.link.width/2,ie=H.link.y0+H.link.width/2,ae=H.link.y1-H.link.width/2,he=H.link.y1+H.link.width/2;return"M"+j+","+te+"C"+J+","+te+" "+Q+","+ae+" "+W+","+ae+"L"+W+","+he+"C"+Q+","+he+" "+J+","+ie+" "+j+","+ie+"Z"}}function C(H,Y){var $=u(Y.color),z=f.nodePadAcross,j=H.nodePad/2;Y.dx=Y.x1-Y.x0,Y.dy=Y.y1-Y.y0;var W=Y.dx,ee=Math.max(.5,Y.dy),J="node_"+Y.pointNumber;return Y.group&&(J=o.randstr()),Y.trace=H.trace,Y.curveNumber=H.trace.index,{index:Y.pointNumber,key:J,partOfGroup:Y.partOfGroup||!1,group:Y.group,traceId:H.key,trace:H.trace,node:Y,nodePad:H.nodePad,nodeLineColor:H.nodeLineColor,nodeLineWidth:H.nodeLineWidth,textFont:H.textFont,size:H.horizontal?H.height:H.width,visibleWidth:Math.ceil(W),visibleHeight:ee,zoneX:-z,zoneY:-j,zoneWidth:W+2*z,zoneHeight:ee+2*j,labelY:H.horizontal?Y.dy/2+1:Y.dx/2+1,left:Y.originalLayer===1,sizeAcross:H.width,forceLayouts:H.forceLayouts,horizontal:H.horizontal,darkBackground:$.getBrightness()<=128,tinyColorHue:s.tinyRGB($),tinyColorAlpha:$.getAlpha(),valueFormat:H.valueFormat,valueSuffix:H.valueSuffix,sankey:H.sankey,graph:H.graph,arrangement:H.arrangement,uniqueNodeLabelPathId:[H.guid,H.key,J].join("_"),interactionState:H.interactionState,figure:H}}function k(H){H.attr("transform",function(Y){return i(Y.node.x0.toFixed(3),Y.node.y0.toFixed(3))})}function L(H){H.call(k)}function M(H,Y){H.call(L),Y.attr("d",w())}function P(H){H.attr("width",function(Y){return Y.node.x1-Y.node.x0}).attr("height",function(Y){return Y.visibleHeight})}function D(H){return H.link.width>1||H.linkLineWidth>0}function N(H){return i(H.translateX,H.translateY)+(H.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function U(H,Y,$){H.on(".basic",null).on("mouseover.basic",function(z){z.interactionState.dragInProgress||z.partOfGroup||($.hover(this,z,Y),z.interactionState.hovered=[this,z])}).on("mousemove.basic",function(z){z.interactionState.dragInProgress||z.partOfGroup||($.follow(this,z),z.interactionState.hovered=[this,z])}).on("mouseout.basic",function(z){z.interactionState.dragInProgress||z.partOfGroup||($.unhover(this,z,Y),z.interactionState.hovered=!1)}).on("click.basic",function(z){z.interactionState.hovered&&($.unhover(this,z,Y),z.interactionState.hovered=!1),z.interactionState.dragInProgress||z.partOfGroup||$.select(this,z,Y)})}function q(H,Y,$,z){var j=m.behavior.drag().origin(function(W){return{x:W.node.x0+W.visibleWidth/2,y:W.node.y0+W.visibleHeight/2}}).on("dragstart",function(W){if(W.arrangement!=="fixed"&&(o.ensureSingle(z._fullLayout._infolayer,"g","dragcover",function(J){z._fullLayout._dragCover=J}),o.raiseToTop(this),W.interactionState.dragInProgress=W.node,K(W.node),W.interactionState.hovered&&($.nodeEvents.unhover.apply(0,W.interactionState.hovered),W.interactionState.hovered=!1),W.arrangement==="snap")){var ee=W.traceId+"|"+W.key;W.forceLayouts[ee]?W.forceLayouts[ee].alpha(1):function(J,Q,te,ie){(function(he){for(var se=0;se<he.length;se++)he[se].y=(he[se].y0+he[se].y1)/2,he[se].x=(he[se].x0+he[se].x1)/2})(te.graph.nodes);var ae=te.graph.nodes.filter(function(he){return he.originalX===te.node.originalX}).filter(function(he){return!he.partOfGroup});te.forceLayouts[Q]=t.forceSimulation(ae).alphaDecay(0).force("collide",t.forceCollide().radius(function(he){return he.dy/2+te.nodePad/2}).strength(1).iterations(f.forceIterations)).force("constrain",function(he,se,de,ue){return function(){for(var ve=0,ke=0;ke<de.length;ke++){var Ee=de[ke];Ee===ue.interactionState.dragInProgress?(Ee.x=Ee.lastDraggedX,Ee.y=Ee.lastDraggedY):(Ee.vx=(Ee.originalX-Ee.x)/f.forceTicksPerFrame,Ee.y=Math.min(ue.size-Ee.dy/2,Math.max(Ee.dy/2,Ee.y))),ve=Math.max(ve,Math.abs(Ee.vx),Math.abs(Ee.vy))}!ue.interactionState.dragInProgress&&ve<.1&&ue.forceLayouts[se].alpha()>0&&ue.forceLayouts[se].alpha(0)}}(0,Q,ae,te)).stop()}(0,ee,W),function(J,Q,te,ie,ae){window.requestAnimationFrame(function he(){var se;for(se=0;se<f.forceTicksPerFrame;se++)te.forceLayouts[ie].tick();if(function(ue){for(var ve=0;ve<ue.length;ve++)ue[ve].y0=ue[ve].y-ue[ve].dy/2,ue[ve].y1=ue[ve].y0+ue[ve].dy,ue[ve].x0=ue[ve].x-ue[ve].dx/2,ue[ve].x1=ue[ve].x0+ue[ve].dx}(te.graph.nodes),te.sankey.update(te.graph),M(J.filter(Z(te)),Q),te.forceLayouts[ie].alpha()>0)window.requestAnimationFrame(he);else{var de=te.node.originalX;te.node.x0=de-te.visibleWidth/2,te.node.x1=de+te.visibleWidth/2,X(te,ae)}})}(H,Y,W,ee,z)}}).on("drag",function(W){if(W.arrangement!=="fixed"){var ee=m.event.x,J=m.event.y;W.arrangement==="snap"?(W.node.x0=ee-W.visibleWidth/2,W.node.x1=ee+W.visibleWidth/2,W.node.y0=J-W.visibleHeight/2,W.node.y1=J+W.visibleHeight/2):(W.arrangement==="freeform"&&(W.node.x0=ee-W.visibleWidth/2,W.node.x1=ee+W.visibleWidth/2),J=Math.max(0,Math.min(W.size-W.visibleHeight/2,J)),W.node.y0=J-W.visibleHeight/2,W.node.y1=J+W.visibleHeight/2),K(W.node),W.arrangement!=="snap"&&(W.sankey.update(W.graph),M(H.filter(Z(W)),Y))}}).on("dragend",function(W){if(W.arrangement!=="fixed"){W.interactionState.dragInProgress=!1;for(var ee=0;ee<W.node.childrenNodes.length;ee++)W.node.childrenNodes[ee].x=W.node.x,W.node.childrenNodes[ee].y=W.node.y;W.arrangement!=="snap"&&X(W,z)}});H.on(".drag",null).call(j)}function X(H,Y){for(var $=[],z=[],j=0;j<H.graph.nodes.length;j++){var W=(H.graph.nodes[j].x0+H.graph.nodes[j].x1)/2,ee=(H.graph.nodes[j].y0+H.graph.nodes[j].y1)/2;$.push(W/H.figure.width),z.push(ee/H.figure.height)}v.call("_guiRestyle",Y,{"node.x":[$],"node.y":[z]},H.trace.index).then(function(){Y._fullLayout._dragCover&&Y._fullLayout._dragCover.remove()})}function K(H){H.lastDraggedX=H.x0+H.dx/2,H.lastDraggedY=H.y0+H.dy/2}function Z(H){return function(Y){return Y.node.originalX===H.node.originalX}}O.exports=function(H,Y,$,z,j){var W=!1;o.ensureSingle(H._fullLayout._infolayer,"g","first-render",function(){W=!0});var ee=H._fullLayout._dragCover,J=$.filter(function(ue){return h(ue).trace.visible}).map(A.bind(null,z)),Q=Y.selectAll("."+f.cn.sankey).data(J,a);Q.exit().remove(),Q.enter().append("g").classed(f.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",N),Q.each(function(ue,ve){H._fullData[ve]._sankey=ue;var ke="bgsankey-"+ue.trace.uid+"-"+ve;o.ensureSingle(H._fullLayout._draggers,"rect",ke),H._fullData[ve]._bgRect=m.select("."+ke),H._fullData[ve]._bgRect.style("pointer-events","all").attr("width",ue.width).attr("height",ue.height).attr("x",ue.translateX).attr("y",ue.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),Q.transition().ease(f.ease).duration(f.duration).attr("transform",N);var te=Q.selectAll("."+f.cn.sankeyLinks).data(g,a);te.enter().append("g").classed(f.cn.sankeyLinks,!0).style("fill","none");var ie=te.selectAll("."+f.cn.sankeyLink).data(function(ue){return ue.graph.links.filter(function(ve){return ve.value}).map(S.bind(null,ue))},a);ie.enter().append("path").classed(f.cn.sankeyLink,!0).call(U,Q,j.linkEvents),ie.style("stroke",function(ue){return D(ue)?s.tinyRGB(u(ue.linkLineColor)):ue.tinyColorHue}).style("stroke-opacity",function(ue){return D(ue)?s.opacity(ue.linkLineColor):ue.tinyColorAlpha}).style("fill",function(ue){return ue.tinyColorHue}).style("fill-opacity",function(ue){return ue.tinyColorAlpha}).style("stroke-width",function(ue){return D(ue)?ue.linkLineWidth:1}).attr("d",w()),ie.style("opacity",function(){return H._context.staticPlot||W||ee?1:0}).transition().ease(f.ease).duration(f.duration).style("opacity",1),ie.exit().transition().ease(f.ease).duration(f.duration).style("opacity",0).remove();var ae=Q.selectAll("."+f.cn.sankeyNodeSet).data(g,a);ae.enter().append("g").classed(f.cn.sankeyNodeSet,!0),ae.style("cursor",function(ue){switch(ue.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var he=ae.selectAll("."+f.cn.sankeyNode).data(function(ue){var ve=ue.graph.nodes;return function(ke){var Ee,be=[];for(Ee=0;Ee<ke.length;Ee++)ke[Ee].originalX=(ke[Ee].x0+ke[Ee].x1)/2,ke[Ee].originalY=(ke[Ee].y0+ke[Ee].y1)/2,be.indexOf(ke[Ee].originalX)===-1&&be.push(ke[Ee].originalX);for(be.sort(function(xe,ce){return xe-ce}),Ee=0;Ee<ke.length;Ee++)ke[Ee].originalLayerIndex=be.indexOf(ke[Ee].originalX),ke[Ee].originalLayer=ke[Ee].originalLayerIndex/(be.length-1)}(ve),ve.map(C.bind(null,ue))},a);he.enter().append("g").classed(f.cn.sankeyNode,!0).call(k).style("opacity",function(ue){return!H._context.staticPlot&&!W||ue.partOfGroup?0:1}),he.call(U,Q,j.nodeEvents).call(q,ie,j,H),he.transition().ease(f.ease).duration(f.duration).call(k).style("opacity",function(ue){return ue.partOfGroup?0:1}),he.exit().transition().ease(f.ease).duration(f.duration).style("opacity",0).remove();var se=he.selectAll("."+f.cn.nodeRect).data(g);se.enter().append("rect").classed(f.cn.nodeRect,!0).call(P),se.style("stroke-width",function(ue){return ue.nodeLineWidth}).style("stroke",function(ue){return s.tinyRGB(u(ue.nodeLineColor))}).style("stroke-opacity",function(ue){return s.opacity(ue.nodeLineColor)}).style("fill",function(ue){return ue.tinyColorHue}).style("fill-opacity",function(ue){return ue.tinyColorAlpha}),se.transition().ease(f.ease).duration(f.duration).call(P);var de=he.selectAll("."+f.cn.nodeLabel).data(g);de.enter().append("text").classed(f.cn.nodeLabel,!0).style("cursor","default"),de.attr("data-notex",1).text(function(ue){return ue.node.label}).each(function(ue){var ve=m.select(this);l.font(ve,ue.textFont),y.convertToTspans(ve,H)}).style("text-shadow",y.makeTextShadow(H._fullLayout.paper_bgcolor)).attr("text-anchor",function(ue){return ue.horizontal&&ue.left?"end":"start"}).attr("transform",function(ue){var ve=m.select(this),ke=y.lineCount(ve),Ee=ue.textFont.size*((ke-1)*T-x),be=ue.nodeLineWidth/2+3,xe=((ue.horizontal?ue.visibleHeight:ue.visibleWidth)-Ee)/2;ue.horizontal&&(ue.left?be=-be:be+=ue.visibleWidth);var ce=ue.horizontal?"":"scale(-1,1)"+c(90);return i(ue.horizontal?be:xe,ue.horizontal?xe:be)+ce}),de.transition().ease(f.ease).duration(f.duration)}},{"../../components/color":650,"../../components/drawing":672,"../../constants/alignment":755,"../../lib":787,"../../lib/gup":784,"../../lib/svg_text_utils":813,"../../registry":915,"./constants":1195,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":163,"d3-interpolate":168,tinycolor2:583}],1200:[function(r,O,B){O.exports=function(t,d){for(var m=[],p=t.cd[0].trace,e=p._sankey.graph.nodes,f=0;f<e.length;f++){var u=e[f];if(!u.partOfGroup){var s=[(u.x0+u.x1)/2,(u.y0+u.y1)/2];p.orientation==="v"&&s.reverse(),d&&d.contains(s,!1,f,t)&&m.push({pointNumber:u.pointNumber})}}return m}},{}],1201:[function(r,O,B){var t=r("../../lib");O.exports=function(d,m){for(var p=0;p<d.length;p++)d[p].i=p;t.mergeArray(m.text,d,"tx"),t.mergeArray(m.texttemplate,d,"txt"),t.mergeArray(m.hovertext,d,"htx"),t.mergeArray(m.customdata,d,"data"),t.mergeArray(m.textposition,d,"tp"),m.textfont&&(t.mergeArrayCastPositive(m.textfont.size,d,"ts"),t.mergeArray(m.textfont.color,d,"tc"),t.mergeArray(m.textfont.family,d,"tf"));var e=m.marker;if(e){t.mergeArrayCastPositive(e.size,d,"ms"),t.mergeArrayCastPositive(e.opacity,d,"mo"),t.mergeArray(e.symbol,d,"mx"),t.mergeArray(e.color,d,"mc");var f=e.line;e.line&&(t.mergeArray(f.color,d,"mlc"),t.mergeArrayCastPositive(f.width,d,"mlw"));var u=e.gradient;u&&u.type!=="none"&&(t.mergeArray(u.type,d,"mgt"),t.mergeArray(u.color,d,"mgc"))}}},{"../../lib":787}],1202:[function(r,O,B){var t=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,d=r("../../plots/template_attributes").texttemplateAttrs,m=r("../../plots/template_attributes").hovertemplateAttrs,p=r("../../components/colorscale/attributes"),e=r("../../plots/font_attributes"),f=r("../../components/drawing/attributes").dash,u=r("../../components/drawing"),s=r("./constants"),l=r("../../lib/extend").extendFlat;O.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:{valType:"any",dflt:0,editType:"calc"},yperiod:{valType:"any",dflt:0,editType:"calc"},xperiod0:{valType:"any",editType:"calc"},yperiod0:{valType:"any",editType:"calc"},xperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},yperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},xhoverformat:t("x"),yhoverformat:t("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:d({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:m({},{keys:s.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:l({},f,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},marker:l({symbol:{valType:"enumerated",values:u.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:l({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},p("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},p("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:e({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":657,"../../components/drawing":672,"../../components/drawing/attributes":671,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/font_attributes":867,"../../plots/template_attributes":910,"./constants":1206}],1203:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../plots/cartesian/axes"),p=r("../../plots/cartesian/align_period"),e=r("../../constants/numerical").BADNUM,f=r("./subtypes"),u=r("./colorscale_calc"),s=r("./arrays_to_calcdata"),l=r("./calc_selection");function o(g,h,y,v,_,x,T){var A=h._length,S=g._fullLayout,w=y._id,C=v._id,k=S._firstScatter[n(h)]===h.uid,L=(a(h,S,y,v)||{}).orientation,M=h.fill;y._minDtick=0,v._minDtick=0;var P={padded:!0},D={padded:!0};T&&(P.ppad=D.ppad=T);var N=A<2||_[0]!==_[A-1]||x[0]!==x[A-1];N&&(M==="tozerox"||M==="tonextx"&&(k||L==="h"))?P.tozero=!0:(h.error_y||{}).visible||M!=="tonexty"&&M!=="tozeroy"&&(f.hasMarkers(h)||f.hasText(h))||(P.padded=!1,P.ppad=0),N&&(M==="tozeroy"||M==="tonexty"&&(k||L==="v"))?D.tozero=!0:M!=="tonextx"&&M!=="tozerox"||(D.padded=!1),w&&(h._extremes[w]=m.findExtremes(y,_,P)),C&&(h._extremes[C]=m.findExtremes(v,x,D))}function i(g,h){if(f.hasMarkers(g)){var y,v=g.marker,_=1.6*(g.marker.sizeref||1);if(y=g.marker.sizemode==="area"?function(w){return Math.max(Math.sqrt((w||0)/_),3)}:function(w){return Math.max((w||0)/_,3)},d.isArrayOrTypedArray(v.size)){var x={type:"linear"};m.setConvert(x);for(var T=x.makeCalcdata(g.marker,"size"),A=new Array(h),S=0;S<h;S++)A[S]=y(T[S]);return A}return y(v.size)}}function c(g,h){var y=n(h),v=g._firstScatter;v[y]||(v[y]=h.uid)}function n(g){var h=g.stackgroup;return g.xaxis+g.yaxis+g.type+(h?"-"+h:"")}function a(g,h,y,v){var _=g.stackgroup;if(_){var x=h._scatterStackOpts[y._id+v._id][_],T=x.orientation==="v"?v:y;return T.type==="linear"||T.type==="log"?x:void 0}}O.exports={calc:function(g,h){var y,v,_,x,T,A,S=g._fullLayout,w=m.getFromId(g,h.xaxis||"x"),C=m.getFromId(g,h.yaxis||"y"),k=w.makeCalcdata(h,"x"),L=C.makeCalcdata(h,"y"),M=p(h,w,"x",k),P=p(h,C,"y",L),D=M.vals,N=P.vals,U=h._length,q=new Array(U),X=h.ids,K=a(h,S,w,C),Z=!1;c(S,h);var H,Y="x",$="y";K?(d.pushUnique(K.traceIndices,h._expandedIndex),(y=K.orientation==="v")?($="s",H="x"):(Y="s",H="y"),T=K.stackgaps==="interpolate"):o(g,h,w,C,D,N,i(h,U));var z=!!h.xperiodalignment,j=!!h.yperiodalignment;for(v=0;v<U;v++){var W=q[v]={},ee=t(D[v]),J=t(N[v]);ee&&J?(W[Y]=D[v],W[$]=N[v],z&&(W.orig_x=k[v],W.xEnd=M.ends[v],W.xStart=M.starts[v]),j&&(W.orig_y=L[v],W.yEnd=P.ends[v],W.yStart=P.starts[v])):K&&(y?ee:J)?(W[H]=y?D[v]:N[v],W.gap=!0,T?(W.s=e,Z=!0):W.s=0):W[Y]=W[$]=e,X&&(W.id=String(X[v]))}if(s(q,h),u(g,h),l(q,h),K){for(v=0;v<q.length;)q[v][H]===e?q.splice(v,1):v++;if(d.sort(q,function(ae,he){return ae[H]-he[H]||ae.i-he.i}),Z){for(v=0;v<q.length-1&&q[v].gap;)v++;for((A=q[v].s)||(A=q[v].s=0),_=0;_<v;_++)q[_].s=A;for(x=q.length-1;x>v&&q[x].gap;)x--;for(A=q[x].s,_=q.length-1;_>x;_--)q[_].s=A;for(;v<x;)if(q[++v].gap){for(_=v+1;q[_].gap;)_++;for(var Q=q[v-1][H],te=q[v-1].s,ie=(q[_].s-te)/(q[_][H]-Q);v<_;)q[v].s=te+(q[v][H]-Q)*ie,v++}}}return q},calcMarkerSize:i,calcAxisExpansion:o,setFirstScatter:c,getStackOpts:a}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"./arrays_to_calcdata":1201,"./calc_selection":1204,"./colorscale_calc":1205,"./subtypes":1227,"fast-isnumeric":246}],1204:[function(r,O,B){var t=r("../../lib");O.exports=function(d,m){t.isArrayOrTypedArray(m.selectedpoints)&&t.tagSelected(d,m)}},{"../../lib":787}],1205:[function(r,O,B){var t=r("../../components/colorscale/helpers").hasColorscale,d=r("../../components/colorscale/calc"),m=r("./subtypes");O.exports=function(p,e){m.hasLines(e)&&t(e,"line")&&d(p,e,{vals:e.line.color,containerStr:"line",cLetter:"c"}),m.hasMarkers(e)&&(t(e,"marker")&&d(p,e,{vals:e.marker.color,containerStr:"marker",cLetter:"c"}),t(e,"marker.line")&&d(p,e,{vals:e.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":658,"../../components/colorscale/helpers":661,"./subtypes":1227}],1206:[function(r,O,B){O.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],1207:[function(r,O,B){var t=r("./calc");function d(m,p,e,f,u,s,l){u[f]=!0;var o={i:null,gap:!0,s:0};if(o[l]=e,m.splice(p,0,o),p&&e===m[p-1][l]){var i=m[p-1];o.s=i.s,o.i=i.i,o.gap=i.gap}else s&&(o.s=function(c,n,a,g){var h=c[n-1],y=c[n+1];return y?h?h.s+(y.s-h.s)*(a-h[g])/(y[g]-h[g]):y.s:h.s}(m,p,e,l));p||(m[0].t=m[1].t,m[0].trace=m[1].trace,delete m[1].t,delete m[1].trace)}O.exports=function(m,p){var e=p.xaxis,f=p.yaxis,u=e._id+f._id,s=m._fullLayout._scatterStackOpts[u];if(s){var l,o,i,c,n,a,g,h,y,v,_,x,T,A,S,w=m.calcdata;for(var C in s){var k=(v=s[C]).traceIndices;if(k.length){for(_=v.stackgaps==="interpolate",x=v.groupnorm,v.orientation==="v"?(T="x",A="y"):(T="y",A="x"),S=new Array(k.length),l=0;l<S.length;l++)S[l]=!1;a=w[k[0]];var L=new Array(a.length);for(l=0;l<a.length;l++)L[l]=a[l][T];for(l=1;l<k.length;l++){for(n=w[k[l]],o=i=0;o<n.length;o++){for(g=n[o][T];g>L[i]&&i<L.length;i++)d(n,o,L[i],l,S,_,T),o++;if(g!==L[i]){for(c=0;c<l;c++)d(w[k[c]],i,g,c,S,_,T);L.splice(i,0,g)}i++}for(;i<L.length;i++)d(n,o,L[i],l,S,_,T),o++}var M=L.length;for(o=0;o<a.length;o++){for(h=a[o][A]=a[o].s,l=1;l<k.length;l++)(n=w[k[l]])[0].trace._rawLength=n[0].trace._length,n[0].trace._length=M,h+=n[o].s,n[o][A]=h;if(x)for(y=(x==="fraction"?h:h/100)||1,l=0;l<k.length;l++){var P=w[k[l]][o];P[A]/=y,P.sNorm=P.s/y}}for(l=0;l<k.length;l++){var D=(n=w[k[l]])[0].trace,N=t.calcMarkerSize(D,D._rawLength),U=Array.isArray(N);if(N&&S[l]||U){var q=N;for(N=new Array(M),o=0;o<M;o++)N[o]=n[o].gap?0:U?q[n[o].i]:q}var X=new Array(M),K=new Array(M);for(o=0;o<M;o++)X[o]=n[o].x,K[o]=n[o].y;t.calcAxisExpansion(m,D,e,f,X,K,N),n[0].t.orientation=v.orientation}}}}}},{"./calc":1203}],1208:[function(r,O,B){O.exports=function(t){for(var d=0;d<t.length;d++){var m=t[d];if(m.type==="scatter"){var p=m.fill;if(p!=="none"&&p!=="toself"&&(m.opacity=void 0,p==="tonexty"||p==="tonextx"))for(var e=d-1;e>=0;e--){var f=t[e];if(f.type==="scatter"&&f.xaxis===m.xaxis&&f.yaxis===m.yaxis){f.opacity=void 0;break}}}}}},{}],1209:[function(r,O,B){var t=r("../../lib"),d=r("../../registry"),m=r("./attributes"),p=r("./constants"),e=r("./subtypes"),f=r("./xy_defaults"),u=r("./period_defaults"),s=r("./stack_defaults"),l=r("./marker_defaults"),o=r("./line_defaults"),i=r("./line_shape_defaults"),c=r("./text_defaults"),n=r("./fillcolor_defaults");O.exports=function(a,g,h,y){function v(k,L){return t.coerce(a,g,m,k,L)}var _=f(a,g,y,v);if(_||(g.visible=!1),g.visible){u(a,g,y,v),v("xhoverformat"),v("yhoverformat");var x=s(a,g,y,v),T=!x&&_<p.PTS_LINESONLY?"lines+markers":"lines";v("text"),v("hovertext"),v("mode",T),e.hasLines(g)&&(o(a,g,h,y,v),i(a,g,v),v("connectgaps"),v("line.simplify")),e.hasMarkers(g)&&l(a,g,h,y,v,{gradient:!0}),e.hasText(g)&&(v("texttemplate"),c(a,g,y,v));var A=[];(e.hasMarkers(g)||e.hasText(g))&&(v("cliponaxis"),v("marker.maxdisplayed"),A.push("points")),v("fill",x?x.fillDflt:"none"),g.fill!=="none"&&(n(a,g,h,v),e.hasLines(g)||i(a,g,v));var S=(g.line||{}).color,w=(g.marker||{}).color;g.fill!=="tonext"&&g.fill!=="toself"||A.push("fills"),v("hoveron",A.join("+")||"points"),g.hoveron!=="fills"&&v("hovertemplate");var C=d.getComponentMethod("errorbars","supplyDefaults");C(a,g,S||w||h,{axis:"y"}),C(a,g,S||w||h,{axis:"x",inherit:"y"}),t.coerceSelectionMarkerOpacity(g,v)}}},{"../../lib":787,"../../registry":915,"./attributes":1202,"./constants":1206,"./fillcolor_defaults":1210,"./line_defaults":1215,"./line_shape_defaults":1217,"./marker_defaults":1221,"./period_defaults":1222,"./stack_defaults":1225,"./subtypes":1227,"./text_defaults":1228,"./xy_defaults":1229}],1210:[function(r,O,B){var t=r("../../components/color"),d=r("../../lib").isArrayOrTypedArray;O.exports=function(m,p,e,f){var u=!1;if(p.marker){var s=p.marker.color,l=(p.marker.line||{}).color;s&&!d(s)?u=s:l&&!d(l)&&(u=l)}f("fillcolor",t.addOpacity((p.line||{}).color||u||e,.5))}},{"../../components/color":650,"../../lib":787}],1211:[function(r,O,B){var t=r("../../plots/cartesian/axes");O.exports=function(d,m,p){var e={},f={_fullLayout:p},u=t.getFromTrace(f,m,"x"),s=t.getFromTrace(f,m,"y");return e.xLabel=t.tickText(u,u.c2l(d.x),!0).text,e.yLabel=t.tickText(s,s.c2l(d.y),!0).text,e}},{"../../plots/cartesian/axes":838}],1212:[function(r,O,B){var t=r("../../components/color"),d=r("./subtypes");O.exports=function(m,p){var e,f;if(m.mode==="lines")return(e=m.line.color)&&t.opacity(e)?e:m.fillcolor;if(m.mode==="none")return m.fill?m.fillcolor:"";var u=p.mcc||(m.marker||{}).color,s=p.mlcc||((m.marker||{}).line||{}).color;return(f=u&&t.opacity(u)?u:s&&t.opacity(s)&&(p.mlw||((m.marker||{}).line||{}).width)?s:"")?t.opacity(f)<.3?t.addOpacity(f,.3):f:(e=(m.line||{}).color)&&t.opacity(e)&&d.hasLines(m)&&m.line.width?e:m.fillcolor}},{"../../components/color":650,"./subtypes":1227}],1213:[function(r,O,B){var t=r("../../lib"),d=r("../../components/fx"),m=r("../../registry"),p=r("./get_trace_color"),e=r("../../components/color"),f=t.fillText;O.exports=function(u,s,l,o){var i=u.cd,c=i[0].trace,n=u.xa,a=u.ya,g=n.c2p(s),h=a.c2p(l),y=[g,h],v=c.hoveron||"",_=c.mode.indexOf("markers")!==-1?3:.5,x=!!c.xperiodalignment,T=!!c.yperiodalignment;if(v.indexOf("points")!==-1){var A=function(se){var de=Math.max(_,se.mrc||0),ue=n.c2p(se.x)-g,ve=a.c2p(se.y)-h;return Math.max(Math.sqrt(ue*ue+ve*ve)-de,1-_/de)},S=d.getDistanceFunction(o,function(se){if(x){var de=n.c2p(se.xStart),ue=n.c2p(se.xEnd);return g>=Math.min(de,ue)&&g<=Math.max(de,ue)?0:1/0}var ve=Math.max(3,se.mrc||0),ke=1-1/ve,Ee=Math.abs(n.c2p(se.x)-g);return Ee<ve?ke*Ee/ve:Ee-ve+ke},function(se){if(T){var de=a.c2p(se.yStart),ue=a.c2p(se.yEnd);return h>=Math.min(de,ue)&&h<=Math.max(de,ue)?0:1/0}var ve=Math.max(3,se.mrc||0),ke=1-1/ve,Ee=Math.abs(a.c2p(se.y)-h);return Ee<ve?ke*Ee/ve:Ee-ve+ke},A);if(d.getClosest(i,S,u),u.index!==!1){var w=i[u.index],C=n.c2p(w.x,!0),k=a.c2p(w.y,!0),L=w.mrc||1;u.index=w.i;var M=i[0].t.orientation,P=M&&(w.sNorm||w.s),D=M==="h"?P:w.orig_x!==void 0?w.orig_x:w.x,N=M==="v"?P:w.orig_y!==void 0?w.orig_y:w.y;return t.extendFlat(u,{color:p(c,w),x0:C-L,x1:C+L,xLabelVal:D,y0:k-L,y1:k+L,yLabelVal:N,spikeDistance:A(w),hovertemplate:c.hovertemplate}),f(w,c,u),m.getComponentMethod("errorbars","hoverInfo")(w,c,u),[u]}}if(v.indexOf("fills")!==-1&&c._polygons){var U,q,X,K,Z,H,Y,$,z,j=c._polygons,W=[],ee=!1,J=1/0,Q=-1/0,te=1/0,ie=-1/0;for(U=0;U<j.length;U++)(X=j[U]).contains(y)&&(ee=!ee,W.push(X),te=Math.min(te,X.ymin),ie=Math.max(ie,X.ymax));if(ee){var ae=((te=Math.max(te,0))+(ie=Math.min(ie,a._length)))/2;for(U=0;U<W.length;U++)for(K=W[U].pts,q=1;q<K.length;q++)($=K[q-1][1])>ae!=(z=K[q][1])>=ae&&(H=K[q-1][0],Y=K[q][0],z-$&&(Z=H+(Y-H)*(ae-$)/(z-$),J=Math.min(J,Z),Q=Math.max(Q,Z)));J=Math.max(J,0),Q=Math.min(Q,n._length);var he=e.defaultLine;return e.opacity(c.fillcolor)?he=c.fillcolor:e.opacity((c.line||{}).color)&&(he=c.line.color),t.extendFlat(u,{distance:u.maxHoverDistance,x0:J,x1:Q,y0:ae,y1:ae,color:he,hovertemplate:!1}),delete u.index,c.text&&!Array.isArray(c.text)?u.text=String(c.text):u.text=c.name,[u]}}}},{"../../components/color":650,"../../components/fx":690,"../../lib":787,"../../registry":915,"./get_trace_color":1212}],1214:[function(r,O,B){var t=r("./subtypes");O.exports={hasLines:t.hasLines,hasMarkers:t.hasMarkers,hasText:t.hasText,isBubble:t.isBubble,attributes:r("./attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("./cross_trace_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./cross_trace_calc"),arraysToCalcdata:r("./arrays_to_calcdata"),plot:r("./plot"),colorbar:r("./marker_colorbar"),formatLabels:r("./format_labels"),style:r("./style").style,styleOnSelect:r("./style").styleOnSelect,hoverPoints:r("./hover"),selectPoints:r("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"./arrays_to_calcdata":1201,"./attributes":1202,"./calc":1203,"./cross_trace_calc":1207,"./cross_trace_defaults":1208,"./defaults":1209,"./format_labels":1211,"./hover":1213,"./marker_colorbar":1220,"./plot":1223,"./select":1224,"./style":1226,"./subtypes":1227}],1215:[function(r,O,B){var t=r("../../lib").isArrayOrTypedArray,d=r("../../components/colorscale/helpers").hasColorscale,m=r("../../components/colorscale/defaults");O.exports=function(p,e,f,u,s,l){var o=(p.marker||{}).color;s("line.color",f),d(p,"line")?m(p,e,u,s,{prefix:"line.",cLetter:"c"}):s("line.color",!t(o)&&o||f),s("line.width"),(l||{}).noDash||s("line.dash")}},{"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"../../lib":787}],1216:[function(r,O,B){var t=r("../../constants/numerical"),d=t.BADNUM,m=t.LOG_CLIP,p=m+.5,e=m-.5,f=r("../../lib"),u=f.segmentsIntersect,s=f.constrain,l=r("./constants");O.exports=function(o,i){var c,n,a,g,h,y,v,_,x,T,A,S,w,C,k,L,M,P,D=i.xaxis,N=i.yaxis,U=D.type==="log",q=N.type==="log",X=D._length,K=N._length,Z=i.connectGaps,H=i.baseTolerance,Y=i.shape,$=Y==="linear",z=i.fill&&i.fill!=="none",j=[],W=l.minTolerance,ee=o.length,J=new Array(ee),Q=0;function te(qe){var Qe=o[qe];if(!Qe)return!1;var st=i.linearized?D.l2p(Qe.x):D.c2p(Qe.x),ct=i.linearized?N.l2p(Qe.y):N.c2p(Qe.y);if(st===d){if(U&&(st=D.c2p(Qe.x,!0)),st===d)return!1;q&&ct===d&&(st*=Math.abs(D._m*K*(D._m>0?p:e)/(N._m*X*(N._m>0?p:e)))),st*=1e3}if(ct===d){if(q&&(ct=N.c2p(Qe.y,!0)),ct===d)return!1;ct*=1e3}return[st,ct]}function ie(qe,Qe,st,ct){var Pt=st-qe,kt=ct-Qe,at=.5-qe,tt=.5-Qe,_t=Pt*Pt+kt*kt,er=Pt*at+kt*tt;if(er>0&&er<_t){var tr=at*kt-tt*Pt;if(tr*tr<_t)return!0}}function ae(qe,Qe){var st=qe[0]/X,ct=qe[1]/K,Pt=Math.max(0,-st,st-1,-ct,ct-1);return Pt&&M!==void 0&&ie(st,ct,M,P)&&(Pt=0),Pt&&Qe&&ie(st,ct,Qe[0]/X,Qe[1]/K)&&(Pt=0),(1+l.toleranceGrowth*Pt)*H}function he(qe,Qe){var st=qe[0]-Qe[0],ct=qe[1]-Qe[1];return Math.sqrt(st*st+ct*ct)}var se,de,ue,ve,ke,Ee,be,xe=l.maxScreensAway,ce=-X*xe,ge=X*(1+xe),we=-K*xe,Me=K*(1+xe),Se=[[ce,we,ge,we],[ge,we,ge,Me],[ge,Me,ce,Me],[ce,Me,ce,we]];function ze(qe){if(qe[0]<ce||qe[0]>ge||qe[1]<we||qe[1]>Me)return[s(qe[0],ce,ge),s(qe[1],we,Me)]}function Fe(qe,Qe){return qe[0]===Qe[0]&&(qe[0]===ce||qe[0]===ge)||qe[1]===Qe[1]&&(qe[1]===we||qe[1]===Me)||void 0}function Ye(qe,Qe,st){return function(ct,Pt){var kt=ze(ct),at=ze(Pt),tt=[];if(kt&&at&&Fe(kt,at))return tt;kt&&tt.push(kt),at&&tt.push(at);var _t=2*f.constrain((ct[qe]+Pt[qe])/2,Qe,st)-((kt||ct)[qe]+(at||Pt)[qe]);return _t&&((kt&&at?_t>0==kt[qe]>at[qe]?kt:at:kt||at)[qe]+=_t),tt}}function rt(qe){var Qe=qe[0],st=qe[1],ct=Qe===J[Q-1][0],Pt=st===J[Q-1][1];if(!ct||!Pt)if(Q>1){var kt=Qe===J[Q-2][0],at=st===J[Q-2][1];ct&&(Qe===ce||Qe===ge)&&kt?at?Q--:J[Q-1]=qe:Pt&&(st===we||st===Me)&&at?kt?Q--:J[Q-1]=qe:J[Q++]=qe}else J[Q++]=qe}function Oe(qe){J[Q-1][0]!==qe[0]&&J[Q-1][1]!==qe[1]&&rt([ue,ve]),rt(qe),ke=null,ue=ve=0}function je(qe){if(M=qe[0]/X,P=qe[1]/K,se=qe[0]<ce?ce:qe[0]>ge?ge:0,de=qe[1]<we?we:qe[1]>Me?Me:0,se||de){if(Q)if(ke){var Qe=be(ke,qe);Qe.length>1&&(Oe(Qe[0]),J[Q++]=Qe[1])}else Ee=be(J[Q-1],qe)[0],J[Q++]=Ee;else J[Q++]=[se||qe[0],de||qe[1]];var st=J[Q-1];se&&de&&(st[0]!==se||st[1]!==de)?(ke&&(ue!==se&&ve!==de?rt(ue&&ve?(ct=ke,kt=(Pt=qe)[0]-ct[0],at=(Pt[1]-ct[1])/kt,(ct[1]*Pt[0]-Pt[1]*ct[0])/kt>0?[at>0?ce:ge,Me]:[at>0?ge:ce,we]):[ue||se,ve||de]):ue&&ve&&rt([ue,ve])),rt([se,de])):ue-se&&ve-de&&rt([se||ue,de||ve]),ke=qe,ue=se,ve=de}else ke&&Oe(be(ke,qe)[0]),J[Q++]=qe;var ct,Pt,kt,at}for(Y==="linear"||Y==="spline"?be=function(qe,Qe){for(var st=[],ct=0,Pt=0;Pt<4;Pt++){var kt=Se[Pt],at=u(qe[0],qe[1],Qe[0],Qe[1],kt[0],kt[1],kt[2],kt[3]);at&&(!ct||Math.abs(at.x-st[0][0])>1||Math.abs(at.y-st[0][1])>1)&&(at=[at.x,at.y],ct&&he(at,qe)<he(st[0],qe)?st.unshift(at):st.push(at),ct++)}return st}:Y==="hv"||Y==="vh"?be=function(qe,Qe){var st=[],ct=ze(qe),Pt=ze(Qe);return ct&&Pt&&Fe(ct,Pt)||(ct&&st.push(ct),Pt&&st.push(Pt)),st}:Y==="hvh"?be=Ye(0,ce,ge):Y==="vhv"&&(be=Ye(1,we,Me)),c=0;c<ee;c++)if(n=te(c)){for(Q=0,ke=null,je(n),c++;c<ee;c++){if(!(g=te(c))){if(Z)continue;break}if($&&i.simplify){var We=te(c+1);if(T=he(g,n),z&&(Q===0||Q===ee-1)||!(T<ae(g,We)*W)){for(_=[(g[0]-n[0])/T,(g[1]-n[1])/T],h=n,A=T,S=C=k=0,v=!1,a=g,c++;c<o.length;c++){if(y=We,We=te(c+1),!y){if(Z)continue;break}if(L=(x=[y[0]-n[0],y[1]-n[1]])[0]*_[1]-x[1]*_[0],C=Math.min(C,L),(k=Math.max(k,L))-C>ae(y,We))break;a=y,(w=x[0]*_[0]+x[1]*_[1])>A?(A=w,g=y,v=!1):w<S&&(S=w,h=y,v=!0)}if(v?(je(g),a!==h&&je(h)):(h!==n&&je(h),a!==g&&je(g)),je(a),c>=o.length||!y)break;je(y),n=y}}else je(g)}ke&&rt([ue||ke[0],ve||ke[1]]),j.push(J.slice(0,Q))}return j}},{"../../constants/numerical":763,"../../lib":787,"./constants":1206}],1217:[function(r,O,B){O.exports=function(t,d,m){m("line.shape")==="spline"&&m("line.smoothing")}},{}],1218:[function(r,O,B){var t={tonextx:1,tonexty:1,tonext:1};O.exports=function(d,m,p){var e,f,u,s,l,o={},i=!1,c=-1,n=0,a=-1;for(f=0;f<p.length;f++)(u=(e=p[f][0].trace).stackgroup||"")?u in o?l=o[u]:(l=o[u]=n,n++):e.fill in t&&a>=0?l=a:(l=a=n,n++),l<c&&(i=!0),e._groupIndex=c=l;var g=p.slice();i&&g.sort(function(y,v){var _=y[0].trace,x=v[0].trace;return _._groupIndex-x._groupIndex||_.index-x.index});var h={};for(f=0;f<g.length;f++)u=(e=g[f][0].trace).stackgroup||"",e.visible===!0?(e._nexttrace=null,e.fill in t&&(s=h[u],e._prevtrace=s||null,s&&(s._nexttrace=e)),e._ownfill=e.fill&&(e.fill.substr(0,6)==="tozero"||e.fill==="toself"||e.fill.substr(0,2)==="to"&&!e._prevtrace),h[u]=e):e._prevtrace=e._nexttrace=e._ownfill=null;return g}},{}],1219:[function(r,O,B){var t=r("fast-isnumeric");O.exports=function(d,m){m||(m=2);var p=d.marker,e=p.sizeref||1,f=p.sizemin||0,u=p.sizemode==="area"?function(s){return Math.sqrt(s/e)}:function(s){return s/e};return function(s){var l=u(s/m);return t(l)&&l>0?Math.max(l,f):0}}},{"fast-isnumeric":246}],1220:[function(r,O,B){O.exports={container:"marker",min:"cmin",max:"cmax"}},{}],1221:[function(r,O,B){var t=r("../../components/color"),d=r("../../components/colorscale/helpers").hasColorscale,m=r("../../components/colorscale/defaults"),p=r("./subtypes");O.exports=function(e,f,u,s,l,o){var i=p.isBubble(e),c=(e.line||{}).color;o=o||{},c&&(u=c),l("marker.symbol"),l("marker.opacity",i?.7:1),l("marker.size"),l("marker.color",u),d(e,"marker")&&m(e,f,s,l,{prefix:"marker.",cLetter:"c"}),o.noSelect||(l("selected.marker.color"),l("unselected.marker.color"),l("selected.marker.size"),l("unselected.marker.size")),o.noLine||(l("marker.line.color",c&&!Array.isArray(c)&&f.marker.color!==c?c:i?t.background:t.defaultLine),d(e,"marker.line")&&m(e,f,s,l,{prefix:"marker.line.",cLetter:"c"}),l("marker.line.width",i?1:0)),i&&(l("marker.sizeref"),l("marker.sizemin"),l("marker.sizemode")),o.gradient&&l("marker.gradient.type")!=="none"&&l("marker.gradient.color")}},{"../../components/color":650,"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"./subtypes":1227}],1222:[function(r,O,B){var t=r("../../lib").dateTick0,d=r("../../constants/numerical").ONEWEEK;function m(p,e){return t(e,p%d==0?1:0)}O.exports=function(p,e,f,u,s){if(s||(s={x:!0,y:!0}),s.x){var l=u("xperiod");l&&(u("xperiod0",m(l,e.xcalendar)),u("xperiodalignment"))}if(s.y){var o=u("yperiod");o&&(u("yperiod0",m(o,e.ycalendar)),u("yperiodalignment"))}}},{"../../constants/numerical":763,"../../lib":787}],1223:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../registry"),m=r("../../lib"),p=m.ensureSingle,e=m.identity,f=r("../../components/drawing"),u=r("./subtypes"),s=r("./line_points"),l=r("./link_traces"),o=r("../../lib/polygon").tester;function i(c,n,a,g,h,y,v){var _;(function(ge,we,Me,Se,ze){var Fe=Me.xaxis,Ye=Me.yaxis,rt=t.extent(m.simpleMap(Fe.range,Fe.r2c)),Oe=t.extent(m.simpleMap(Ye.range,Ye.r2c)),je=Se[0].trace;if(!!u.hasMarkers(je)){var We=je.marker.maxdisplayed;if(We!==0){var qe=Se.filter(function(Pt){return Pt.x>=rt[0]&&Pt.x<=rt[1]&&Pt.y>=Oe[0]&&Pt.y<=Oe[1]}),Qe=Math.ceil(qe.length/We),st=0;ze.forEach(function(Pt,kt){var at=Pt[0].trace;u.hasMarkers(at)&&at.marker.maxdisplayed>0&&kt<we&&st++});var ct=Math.round(st*Qe/3+Math.floor(st/3)*Qe/7.1);Se.forEach(function(Pt){delete Pt.vis}),qe.forEach(function(Pt,kt){Math.round((kt+ct)%Qe)===0&&(Pt.vis=!0)})}}})(0,n,a,g,h);var x=!!v&&v.duration>0;function T(ge){return x?ge.transition():ge}var A=a.xaxis,S=a.yaxis,w=g[0].trace,C=w.line,k=t.select(y),L=p(k,"g","errorbars"),M=p(k,"g","lines"),P=p(k,"g","points"),D=p(k,"g","text");if(d.getComponentMethod("errorbars","plot")(c,L,a,v),w.visible===!0){var N,U;T(k).style("opacity",w.opacity);var q=w.fill.charAt(w.fill.length-1);q!=="x"&&q!=="y"&&(q=""),g[0][a.isRangePlot?"nodeRangePlot3":"node3"]=k;var X,K,Z="",H=[],Y=w._prevtrace;Y&&(Z=Y._prevRevpath||"",U=Y._nextFill,H=Y._polygons);var $,z,j,W,ee,J,Q,te="",ie="",ae=[],he=m.noop;if(N=w._ownFill,u.hasLines(w)||w.fill!=="none"){for(U&&U.datum(g),["hv","vh","hvh","vhv"].indexOf(C.shape)!==-1?($=f.steps(C.shape),z=f.steps(C.shape.split("").reverse().join(""))):$=z=C.shape==="spline"?function(ge){var we=ge[ge.length-1];return ge.length>1&&ge[0][0]===we[0]&&ge[0][1]===we[1]?f.smoothclosed(ge.slice(1),C.smoothing):f.smoothopen(ge,C.smoothing)}:function(ge){return"M"+ge.join("L")},j=function(ge){return z(ge.reverse())},ae=s(g,{xaxis:A,yaxis:S,connectGaps:w.connectgaps,baseTolerance:Math.max(C.width||1,3)/4,shape:C.shape,simplify:C.simplify,fill:w.fill}),Q=w._polygons=new Array(ae.length),_=0;_<ae.length;_++)w._polygons[_]=o(ae[_]);ae.length&&(W=ae[0][0],J=(ee=ae[ae.length-1])[ee.length-1]),he=function(ge){return function(we){if(X=$(we),K=j(we),te?q?(te+="L"+X.substr(1),ie=K+"L"+ie.substr(1)):(te+="Z"+X,ie=K+"Z"+ie):(te=X,ie=K),u.hasLines(w)&&we.length>1){var Me=t.select(this);if(Me.datum(g),ge)T(Me.style("opacity",0).attr("d",X).call(f.lineGroupStyle)).style("opacity",1);else{var Se=T(Me);Se.attr("d",X),f.singleLineStyle(g,Se)}}}}}var se=M.selectAll(".js-line").data(ae);T(se.exit()).style("opacity",0).remove(),se.each(he(!1)),se.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(f.lineGroupStyle).each(he(!0)),f.setClipUrl(se,a.layerClipId,c),ae.length?(N?(N.datum(g),W&&J&&(q?(q==="y"?W[1]=J[1]=S.c2p(0,!0):q==="x"&&(W[0]=J[0]=A.c2p(0,!0)),T(N).attr("d","M"+J+"L"+W+"L"+te.substr(1)).call(f.singleFillStyle)):T(N).attr("d",te+"Z").call(f.singleFillStyle))):U&&(w.fill.substr(0,6)==="tonext"&&te&&Z?(w.fill==="tonext"?T(U).attr("d",te+"Z"+Z+"Z").call(f.singleFillStyle):T(U).attr("d",te+"L"+Z.substr(1)+"Z").call(f.singleFillStyle),w._polygons=w._polygons.concat(H)):(ue(U),w._polygons=null)),w._prevRevpath=ie,w._prevPolygons=Q):(N?ue(N):U&&ue(U),w._polygons=w._prevRevpath=w._prevPolygons=null),P.datum(g),D.datum(g),function(ge,we,Me){var Se,ze=Me[0].trace,Fe=u.hasMarkers(ze),Ye=u.hasText(ze),rt=xe(ze),Oe=ce,je=ce;if(Fe||Ye){var We=e,qe=ze.stackgroup,Qe=qe&&c._fullLayout._scatterStackOpts[A._id+S._id][qe].stackgaps==="infer zero";ze.marker.maxdisplayed||ze._needsCull?We=Qe?ke:ve:qe&&!Qe&&(We=Ee),Fe&&(Oe=We),Ye&&(je=We)}var st,ct=(Se=ge.selectAll("path.point").data(Oe,rt)).enter().append("path").classed("point",!0);x&&ct.call(f.pointStyle,ze,c).call(f.translatePoints,A,S).style("opacity",0).transition().style("opacity",1),Se.order(),Fe&&(st=f.makePointStyleFns(ze)),Se.each(function(Pt){var kt=t.select(this),at=T(kt);f.translatePoint(Pt,at,A,S)?(f.singlePointStyle(Pt,at,ze,st,c),a.layerClipId&&f.hideOutsideRangePoint(Pt,at,A,S,ze.xcalendar,ze.ycalendar),ze.customdata&&kt.classed("plotly-customdata",Pt.data!==null&&Pt.data!==void 0)):at.remove()}),x?Se.exit().transition().style("opacity",0).remove():Se.exit().remove(),(Se=we.selectAll("g").data(je,rt)).enter().append("g").classed("textpoint",!0).append("text"),Se.order(),Se.each(function(Pt){var kt=t.select(this),at=T(kt.select("text"));f.translatePoint(Pt,at,A,S)?a.layerClipId&&f.hideOutsideRangePoint(Pt,kt,A,S,ze.xcalendar,ze.ycalendar):kt.remove()}),Se.selectAll("text").call(f.textPointStyle,ze,c).each(function(Pt){var kt=A.c2p(Pt.x),at=S.c2p(Pt.y);t.select(this).selectAll("tspan.line").each(function(){T(t.select(this)).attr({x:kt,y:at})})}),Se.exit().remove()}(P,D,g);var de=w.cliponaxis===!1?null:a.layerClipId;f.setClipUrl(P,de,c),f.setClipUrl(D,de,c)}function ue(ge){T(ge).attr("d","M0,0Z")}function ve(ge){return ge.filter(function(we){return!we.gap&&we.vis})}function ke(ge){return ge.filter(function(we){return we.vis})}function Ee(ge){return ge.filter(function(we){return!we.gap})}function be(ge){return ge.id}function xe(ge){if(ge.ids)return be}function ce(){return!1}}O.exports=function(c,n,a,g,h,y){var v,_,x=!h,T=!!h&&h.duration>0,A=l(c,n,a);(v=g.selectAll("g.trace").data(A,function(S){return S[0].trace.uid})).enter().append("g").attr("class",function(S){return"trace scatter trace"+S[0].trace.uid}).style("stroke-miterlimit",2),v.order(),function(S,w,C){w.each(function(k){var L=p(t.select(this),"g","fills");f.setClipUrl(L,C.layerClipId,S);var M=k[0].trace,P=[];M._ownfill&&P.push("_ownFill"),M._nexttrace&&P.push("_nextFill");var D=L.selectAll("g").data(P,e);D.enter().append("g"),D.exit().each(function(N){M[N]=null}).remove(),D.order().each(function(N){M[N]=p(t.select(this),"path","js-fill")})})}(c,v,n),T?(y&&(_=y()),t.transition().duration(h.duration).ease(h.easing).each("end",function(){_&&_()}).each("interrupt",function(){_&&_()}).each(function(){g.selectAll("g.trace").each(function(S,w){i(c,w,n,S,A,this,h)})})):v.each(function(S,w){i(c,w,n,S,A,this,h)}),x&&v.exit().remove(),g.selectAll("path:not([d])").remove()}},{"../../components/drawing":672,"../../lib":787,"../../lib/polygon":799,"../../registry":915,"./line_points":1216,"./link_traces":1218,"./subtypes":1227,"@plotly/d3":58}],1224:[function(r,O,B){var t=r("./subtypes");O.exports=function(d,m){var p,e,f,u,s=d.cd,l=d.xaxis,o=d.yaxis,i=[],c=s[0].trace;if(!t.hasMarkers(c)&&!t.hasText(c))return[];if(m===!1)for(p=0;p<s.length;p++)s[p].selected=0;else for(p=0;p<s.length;p++)e=s[p],f=l.c2p(e.x),u=o.c2p(e.y),e.i!==null&&m.contains([f,u],!1,p,d)?(i.push({pointNumber:e.i,x:l.c2d(e.x),y:o.c2d(e.y)}),e.selected=1):e.selected=0;return i}},{"./subtypes":1227}],1225:[function(r,O,B){var t=["orientation","groupnorm","stackgaps"];O.exports=function(d,m,p,e){var f=p._scatterStackOpts,u=e("stackgroup");if(u){var s=m.xaxis+m.yaxis,l=f[s];l||(l=f[s]={});var o=l[u],i=!1;o?o.traces.push(m):(o=l[u]={traceIndices:[],traces:[m]},i=!0);for(var c={orientation:m.x&&!m.y?"h":"v"},n=0;n<t.length;n++){var a=t[n],g=a+"Found";if(!o[g]){var h=d[a]!==void 0,y=a==="orientation";if((h||i)&&(o[a]=e(a,c[a]),y&&(o.fillDflt=o[a]==="h"?"tonextx":"tonexty"),h&&(o[g]=!0,!i&&(delete o.traces[0][a],y))))for(var v=0;v<o.traces.length-1;v++){var _=o.traces[v];_._input.fill!==_.fill&&(_.fill=o.fillDflt)}}}return o}}},{}],1226:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/drawing"),m=r("../../registry");function p(f,u,s){d.pointStyle(f.selectAll("path.point"),u,s)}function e(f,u,s){d.textPointStyle(f.selectAll("text"),u,s)}O.exports={style:function(f){var u=t.select(f).selectAll("g.trace.scatter");u.style("opacity",function(s){return s[0].trace.opacity}),u.selectAll("g.points").each(function(s){p(t.select(this),s.trace||s[0].trace,f)}),u.selectAll("g.text").each(function(s){e(t.select(this),s.trace||s[0].trace,f)}),u.selectAll("g.trace path.js-line").call(d.lineGroupStyle),u.selectAll("g.trace path.js-fill").call(d.fillGroupStyle),m.getComponentMethod("errorbars","style")(u)},stylePoints:p,styleText:e,styleOnSelect:function(f,u,s){var l=u[0].trace;l.selectedpoints?(d.selectedPointStyle(s.selectAll("path.point"),l),d.selectedTextStyle(s.selectAll("text"),l)):(p(s,l,f),e(s,l,f))}}},{"../../components/drawing":672,"../../registry":915,"@plotly/d3":58}],1227:[function(r,O,B){var t=r("../../lib");O.exports={hasLines:function(d){return d.visible&&d.mode&&d.mode.indexOf("lines")!==-1},hasMarkers:function(d){return d.visible&&(d.mode&&d.mode.indexOf("markers")!==-1||d.type==="splom")},hasText:function(d){return d.visible&&d.mode&&d.mode.indexOf("text")!==-1},isBubble:function(d){return t.isPlainObject(d.marker)&&t.isArrayOrTypedArray(d.marker.size)}}},{"../../lib":787}],1228:[function(r,O,B){var t=r("../../lib");O.exports=function(d,m,p,e,f){f=f||{},e("textposition"),t.coerceFont(e,"textfont",p.font),f.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":787}],1229:[function(r,O,B){var t=r("../../lib"),d=r("../../registry");O.exports=function(m,p,e,f){var u,s=f("x"),l=f("y");if(d.getComponentMethod("calendars","handleTraceDefaults")(m,p,["x","y"],e),s){var o=t.minRowLength(s);l?u=Math.min(o,t.minRowLength(l)):(u=o,f("y0"),f("dy"))}else{if(!l)return 0;u=t.minRowLength(l),f("x0"),f("dx")}return p._length=u,u}},{"../../lib":787,"../../registry":915}],1230:[function(r,O,B){var t=r("../scatter/attributes"),d=r("../../components/colorscale/attributes"),m=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=r("../../plots/template_attributes").hovertemplateAttrs,e=r("../../plots/template_attributes").texttemplateAttrs,f=r("../../plots/attributes"),u=r("../../constants/gl3d_dashes"),s=r("../../constants/gl3d_markers"),l=r("../../lib/extend").extendFlat,o=r("../../plot_api/edit_types").overrideAll,i=r("../../lib/sort_object_keys"),c=t.line,n=t.marker,a=n.line,g=l({width:c.width,dash:{valType:"enumerated",values:i(u),dflt:"solid"}},d("line")),h=O.exports=o({x:t.x,y:t.y,z:{valType:"data_array"},text:l({},t.text,{}),texttemplate:e({},{}),hovertext:l({},t.hovertext,{}),hovertemplate:p(),xhoverformat:m("x"),yhoverformat:m("y"),zhoverformat:m("z"),mode:l({},t.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},y:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},z:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}},connectgaps:t.connectgaps,line:g,marker:l({symbol:{valType:"enumerated",values:i(s),dflt:"circle",arrayOk:!0},size:l({},n.size,{dflt:8}),sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode,opacity:l({},n.opacity,{arrayOk:!1}),colorbar:n.colorbar,line:l({width:l({},a.width,{arrayOk:!1})},d("marker.line"))},d("marker")),textposition:l({},t.textposition,{dflt:"top center"}),textfont:{color:t.textfont.color,size:t.textfont.size,family:l({},t.textfont.family,{arrayOk:!1})},hoverinfo:l({},f.hoverinfo)},"calc","nested");h.x.editType=h.y.editType=h.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":657,"../../constants/gl3d_dashes":760,"../../constants/gl3d_markers":761,"../../lib/extend":777,"../../lib/sort_object_keys":810,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1231:[function(r,O,B){var t=r("../scatter/arrays_to_calcdata"),d=r("../scatter/colorscale_calc");O.exports=function(m,p){var e=[{x:!1,y:!1,trace:p,t:{}}];return t(e,p),d(m,p),e}},{"../scatter/arrays_to_calcdata":1201,"../scatter/colorscale_calc":1205}],1232:[function(r,O,B){var t=r("../../registry");function d(m,p,e,f){if(!p||!p.visible)return null;for(var u=t.getComponentMethod("errorbars","makeComputeError")(p),s=new Array(m.length),l=0;l<m.length;l++){var o=u(+m[l],l);if(f.type==="log"){var i=f.c2l(m[l]),c=m[l]-o[0],n=m[l]+o[1];if(s[l]=[(f.c2l(c,!0)-i)*e,(f.c2l(n,!0)-i)*e],c>0){var a=f.c2l(c);f._lowerLogErrorBound||(f._lowerLogErrorBound=a),f._lowerErrorBound=Math.min(f._lowerLogErrorBound,a)}}else s[l]=[-o[0]*e,o[1]*e]}return s}O.exports=function(m,p,e){var f=[d(m.x,m.error_x,p[0],e.xaxis),d(m.y,m.error_y,p[1],e.yaxis),d(m.z,m.error_z,p[2],e.zaxis)],u=function(n){for(var a=0;a<n.length;a++)if(n[a])return n[a].length;return 0}(f);if(u===0)return null;for(var s=new Array(u),l=0;l<u;l++){for(var o=[[0,0,0],[0,0,0]],i=0;i<3;i++)if(f[i])for(var c=0;c<2;c++)o[c][i]=f[i][l][c];s[l]=o}return s}},{"../../registry":915}],1233:[function(r,O,B){var t=r("gl-line3d"),d=r("gl-scatter3d"),m=r("gl-error3d"),p=r("gl-mesh3d"),e=r("delaunay-triangulate"),f=r("../../lib"),u=r("../../lib/str2rgbarray"),s=r("../../lib/gl_format_color").formatColor,l=r("../scatter/make_bubble_size_func"),o=r("../../constants/gl3d_dashes"),i=r("../../constants/gl3d_markers"),c=r("../../plots/cartesian/axes"),n=r("../../components/fx/helpers").appendArrayPointValue,a=r("./calc_errors");function g(C,k){this.scene=C,this.uid=k,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var h=g.prototype;function y(C){return C==null?0:C.indexOf("left")>-1?-1:C.indexOf("right")>-1?1:0}function v(C){return C==null?0:C.indexOf("top")>-1?-1:C.indexOf("bottom")>-1?1:0}function _(C,k){return k(4*C)}function x(C){return i[C]}function T(C,k,L,M,P){var D=null;if(f.isArrayOrTypedArray(C)){D=[];for(var N=0;N<k;N++)C[N]===void 0?D[N]=M:D[N]=L(C[N],P)}else D=L(C,f.identity);return D}function A(C,k){var L,M,P,D,N,U,q=[],X=C.fullSceneLayout,K=C.dataScale,Z=X.xaxis,H=X.yaxis,Y=X.zaxis,$=k.marker,z=k.line,j=k.x||[],W=k.y||[],ee=k.z||[],J=j.length,Q=k.xcalendar,te=k.ycalendar,ie=k.zcalendar;for(N=0;N<J;N++)L=Z.d2l(j[N],0,Q)*K[0],M=H.d2l(W[N],0,te)*K[1],P=Y.d2l(ee[N],0,ie)*K[2],q[N]=[L,M,P];if(Array.isArray(k.text))U=k.text;else if(k.text!==void 0)for(U=new Array(J),N=0;N<J;N++)U[N]=k.text;function ae(Se,ze){var Fe=X[Se];return c.tickText(Fe,Fe.d2l(ze),!0).text}var he=k.texttemplate;if(he){var se=C.fullLayout._d3locale,de=Array.isArray(he),ue=de?Math.min(he.length,J):J,ve=de?function(Se){return he[Se]}:function(){return he};for(U=new Array(ue),N=0;N<ue;N++){var ke={x:j[N],y:W[N],z:ee[N]},Ee={xLabel:ae("xaxis",j[N]),yLabel:ae("yaxis",W[N]),zLabel:ae("zaxis",ee[N])},be={};n(be,k,N);var xe=k._meta||{};U[N]=f.texttemplateString(ve(N),Ee,se,be,ke,xe)}}if(D={position:q,mode:k.mode,text:U},"line"in k&&(D.lineColor=s(z,1,J),D.lineWidth=z.width,D.lineDashes=z.dash),"marker"in k){var ce=l(k);D.scatterColor=s($,1,J),D.scatterSize=T($.size,J,_,20,ce),D.scatterMarker=T($.symbol,J,x,"\u25CF"),D.scatterLineWidth=$.line.width,D.scatterLineColor=s($.line,1,J),D.scatterAngle=0}"textposition"in k&&(D.textOffset=function(Se){var ze=[0,0];if(Array.isArray(Se))for(var Fe=0;Fe<Se.length;Fe++)ze[Fe]=[0,0],Se[Fe]&&(ze[Fe][0]=y(Se[Fe]),ze[Fe][1]=v(Se[Fe]));else ze[0]=y(Se),ze[1]=v(Se);return ze}(k.textposition),D.textColor=s(k.textfont,1,J),D.textSize=T(k.textfont.size,J,f.identity,12),D.textFont=k.textfont.family,D.textAngle=0);var ge=["x","y","z"];for(D.project=[!1,!1,!1],D.projectScale=[1,1,1],D.projectOpacity=[1,1,1],N=0;N<3;++N){var we=k.projection[ge[N]];(D.project[N]=we.show)&&(D.projectOpacity[N]=we.opacity,D.projectScale[N]=we.scale)}D.errorBounds=a(k,K,X);var Me=function(Se){for(var ze=[0,0,0],Fe=[[0,0,0],[0,0,0],[0,0,0]],Ye=[1,1,1],rt=0;rt<3;rt++){var Oe=Se[rt];Oe&&Oe.copy_zstyle!==!1&&Se[2].visible!==!1&&(Oe=Se[2]),Oe&&Oe.visible&&(ze[rt]=Oe.width/2,Fe[rt]=u(Oe.color),Ye[rt]=Oe.thickness)}return{capSize:ze,color:Fe,lineWidth:Ye}}([k.error_x,k.error_y,k.error_z]);return D.errorColor=Me.color,D.errorLineWidth=Me.lineWidth,D.errorCapSize=Me.capSize,D.delaunayAxis=k.surfaceaxis,D.delaunayColor=u(k.surfacecolor),D}function S(C){if(f.isArrayOrTypedArray(C)){var k=C[0];return f.isArrayOrTypedArray(k)&&(C=k),"rgb("+C.slice(0,3).map(function(L){return Math.round(255*L)})+")"}return null}function w(C){return f.isArrayOrTypedArray(C)?C.length===4&&typeof C[0]=="number"?S(C):C.map(S):null}h.handlePick=function(C){if(C.object&&(C.object===this.linePlot||C.object===this.delaunayMesh||C.object===this.textMarkers||C.object===this.scatterPlot)){var k=C.index=C.data.index;return C.object.highlight&&C.object.highlight(null),this.scatterPlot&&(C.object=this.scatterPlot,this.scatterPlot.highlight(C.data)),C.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[k]||this.textLabels[k]===0)&&(C.textLabel=this.textLabels[k]):C.textLabel=this.textLabels),C.traceCoordinate=[this.data.x[k],this.data.y[k],this.data.z[k]],!0}},h.update=function(C){var k,L,M,P,D=this.scene.glplot.gl,N=o.solid;this.data=C;var U=A(this.scene,C);"mode"in U&&(this.mode=U.mode),"lineDashes"in U&&U.lineDashes in o&&(N=o[U.lineDashes]),this.color=w(U.scatterColor)||w(U.lineColor),this.dataPoints=U.position,k={gl:this.scene.glplot.gl,position:U.position,color:U.lineColor,lineWidth:U.lineWidth||1,dashes:N[0],dashScale:N[1],opacity:C.opacity,connectGaps:C.connectgaps},this.mode.indexOf("lines")!==-1?this.linePlot?this.linePlot.update(k):(this.linePlot=t(k),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var q=C.opacity;if(C.marker&&C.marker.opacity&&(q*=C.marker.opacity),L={gl:this.scene.glplot.gl,position:U.position,color:U.scatterColor,size:U.scatterSize,glyph:U.scatterMarker,opacity:q,orthographic:!0,lineWidth:U.scatterLineWidth,lineColor:U.scatterLineColor,project:U.project,projectScale:U.projectScale,projectOpacity:U.projectOpacity},this.mode.indexOf("markers")!==-1?this.scatterPlot?this.scatterPlot.update(L):(this.scatterPlot=d(L),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),P={gl:this.scene.glplot.gl,position:U.position,glyph:U.text,color:U.textColor,size:U.textSize,angle:U.textAngle,alignment:U.textOffset,font:U.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:C.opacity},this.textLabels=C.hovertext||C.text,this.mode.indexOf("text")!==-1?this.textMarkers?this.textMarkers.update(P):(this.textMarkers=d(P),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),M={gl:this.scene.glplot.gl,position:U.position,color:U.errorColor,error:U.errorBounds,lineWidth:U.errorLineWidth,capSize:U.errorCapSize,opacity:C.opacity},this.errorBars?U.errorBounds?this.errorBars.update(M):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):U.errorBounds&&(this.errorBars=m(M),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),U.delaunayAxis>=0){var X=function(K,Z,H){var Y,$=(H+1)%3,z=(H+2)%3,j=[],W=[];for(Y=0;Y<K.length;++Y){var ee=K[Y];!isNaN(ee[$])&&isFinite(ee[$])&&!isNaN(ee[z])&&isFinite(ee[z])&&(j.push([ee[$],ee[z]]),W.push(Y))}var J=e(j);for(Y=0;Y<J.length;++Y)for(var Q=J[Y],te=0;te<Q.length;++te)Q[te]=W[Q[te]];return{positions:K,cells:J,meshColor:Z}}(U.position,U.delaunayColor,U.delaunayAxis);X.opacity=C.opacity,this.delaunayMesh?this.delaunayMesh.update(X):(X.gl=D,this.delaunayMesh=p(X),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},h.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},O.exports=function(C,k){var L=new g(C,k.uid);return L.update(k),L}},{"../../components/fx/helpers":686,"../../constants/gl3d_dashes":760,"../../constants/gl3d_markers":761,"../../lib":787,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../../plots/cartesian/axes":838,"../scatter/make_bubble_size_func":1219,"./calc_errors":1232,"delaunay-triangulate":177,"gl-error3d":267,"gl-line3d":275,"gl-mesh3d":309,"gl-scatter3d":327}],1234:[function(r,O,B){var t=r("../../registry"),d=r("../../lib"),m=r("../scatter/subtypes"),p=r("../scatter/marker_defaults"),e=r("../scatter/line_defaults"),f=r("../scatter/text_defaults"),u=r("./attributes");O.exports=function(s,l,o,i){function c(_,x){return d.coerce(s,l,u,_,x)}if(function(_,x,T,A){var S=0,w=T("x"),C=T("y"),k=T("z");return t.getComponentMethod("calendars","handleTraceDefaults")(_,x,["x","y","z"],A),w&&C&&k&&(S=Math.min(w.length,C.length,k.length),x._length=x._xlength=x._ylength=x._zlength=S),S}(s,l,c,i)){c("text"),c("hovertext"),c("hovertemplate"),c("xhoverformat"),c("yhoverformat"),c("zhoverformat"),c("mode"),m.hasLines(l)&&(c("connectgaps"),e(s,l,o,i,c)),m.hasMarkers(l)&&p(s,l,o,i,c,{noSelect:!0}),m.hasText(l)&&(c("texttemplate"),f(s,l,i,c,{noSelect:!0}));var n=(l.line||{}).color,a=(l.marker||{}).color;c("surfaceaxis")>=0&&c("surfacecolor",n||a);for(var g=["x","y","z"],h=0;h<3;++h){var y="projection."+g[h];c(y+".show")&&(c(y+".opacity"),c(y+".scale"))}var v=t.getComponentMethod("errorbars","supplyDefaults");v(s,l,n||a||o,{axis:"z"}),v(s,l,n||a||o,{axis:"y",inherit:"z"}),v(s,l,n||a||o,{axis:"x",inherit:"z"})}else l.visible=!1}},{"../../lib":787,"../../registry":915,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1230}],1235:[function(r,O,B){O.exports={plot:r("./convert"),attributes:r("./attributes"),markerSymbols:r("../../constants/gl3d_markers"),supplyDefaults:r("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:r("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":761,"../../plots/gl3d":880,"./attributes":1230,"./calc":1231,"./convert":1233,"./defaults":1234}],1236:[function(r,O,B){var t=r("../scatter/attributes"),d=r("../../plots/attributes"),m=r("../../plots/template_attributes").hovertemplateAttrs,p=r("../../plots/template_attributes").texttemplateAttrs,e=r("../../components/colorscale/attributes"),f=r("../../lib/extend").extendFlat,u=t.marker,s=t.line,l=u.line;O.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:f({},t.mode,{dflt:"markers"}),text:f({},t.text,{}),texttemplate:p({editType:"plot"},{keys:["a","b","text"]}),hovertext:f({},t.hovertext,{}),line:{color:s.color,width:s.width,dash:s.dash,shape:f({},s.shape,{values:["linear","spline"]}),smoothing:s.smoothing,editType:"calc"},connectgaps:t.connectgaps,fill:f({},t.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:t.fillcolor,marker:f({symbol:u.symbol,opacity:u.opacity,maxdisplayed:u.maxdisplayed,size:u.size,sizeref:u.sizeref,sizemin:u.sizemin,sizemode:u.sizemode,line:f({width:l.width,editType:"calc"},e("marker.line")),gradient:u.gradient,editType:"calc"},e("marker")),textfont:t.textfont,textposition:t.textposition,selected:t.selected,unselected:t.unselected,hoverinfo:f({},d.hoverinfo,{flags:["a","b","text","name"]}),hoveron:t.hoveron,hovertemplate:m()}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1237:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../scatter/colorscale_calc"),m=r("../scatter/arrays_to_calcdata"),p=r("../scatter/calc_selection"),e=r("../scatter/calc").calcMarkerSize,f=r("../carpet/lookup_carpetid");O.exports=function(u,s){var l=s._carpetTrace=f(u,s);if(l&&l.visible&&l.visible!=="legendonly"){var o;s.xaxis=l.xaxis,s.yaxis=l.yaxis;var i,c,n=s._length,a=new Array(n),g=!1;for(o=0;o<n;o++)if(i=s.a[o],c=s.b[o],t(i)&&t(c)){var h=l.ab2xy(+i,+c,!0),y=l.isVisible(+i,+c);y||(g=!0),a[o]={x:h[0],y:h[1],a:i,b:c,vis:y}}else a[o]={x:!1,y:!1};return s._needsCull=g,a[0].carpet=l,a[0].trace=s,e(s,n),d(u,s),m(a,s),p(a,s),a}}},{"../carpet/lookup_carpetid":985,"../scatter/arrays_to_calcdata":1201,"../scatter/calc":1203,"../scatter/calc_selection":1204,"../scatter/colorscale_calc":1205,"fast-isnumeric":246}],1238:[function(r,O,B){var t=r("../../lib"),d=r("../scatter/constants"),m=r("../scatter/subtypes"),p=r("../scatter/marker_defaults"),e=r("../scatter/line_defaults"),f=r("../scatter/line_shape_defaults"),u=r("../scatter/text_defaults"),s=r("../scatter/fillcolor_defaults"),l=r("./attributes");O.exports=function(o,i,c,n){function a(_,x){return t.coerce(o,i,l,_,x)}a("carpet"),i.xaxis="x",i.yaxis="y";var g=a("a"),h=a("b"),y=Math.min(g.length,h.length);if(y){i._length=y,a("text"),a("texttemplate"),a("hovertext"),a("mode",y<d.PTS_LINESONLY?"lines+markers":"lines"),m.hasLines(i)&&(e(o,i,c,n,a),f(o,i,a),a("connectgaps")),m.hasMarkers(i)&&p(o,i,c,n,a,{gradient:!0}),m.hasText(i)&&u(o,i,n,a);var v=[];(m.hasMarkers(i)||m.hasText(i))&&(a("marker.maxdisplayed"),v.push("points")),a("fill"),i.fill!=="none"&&(s(o,i,c,a),m.hasLines(i)||f(o,i,a)),i.fill!=="tonext"&&i.fill!=="toself"||v.push("fills"),a("hoveron",v.join("+")||"points")!=="fills"&&a("hovertemplate"),t.coerceSelectionMarkerOpacity(i,a)}else i.visible=!1}},{"../../lib":787,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/line_shape_defaults":1217,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1236}],1239:[function(r,O,B){O.exports=function(t,d,m,p,e){var f=p[e];return t.a=f.a,t.b=f.b,t.y=f.y,t}},{}],1240:[function(r,O,B){O.exports=function(t,d){var m={},p=d._carpet,e=p.ab2ij([t.a,t.b]),f=Math.floor(e[0]),u=e[0]-f,s=Math.floor(e[1]),l=e[1]-s,o=p.evalxy([],f,s,u,l);return m.yLabel=o[1].toFixed(3),m}},{}],1241:[function(r,O,B){var t=r("../scatter/hover"),d=r("../../lib").fillText;O.exports=function(m,p,e,f){var u=t(m,p,e,f);if(u&&u[0].index!==!1){var s=u[0];if(s.index===void 0){var l=1-s.y0/m.ya._length,o=m.xa._length,i=o*l/2,c=o-i;return s.x0=Math.max(Math.min(s.x0,c),i),s.x1=Math.max(Math.min(s.x1,c),i),u}var n=s.cd[s.index];s.a=n.a,s.b=n.b,s.xLabelVal=void 0,s.yLabelVal=void 0;var a=s.trace,g=a._carpet,h=a._module.formatLabels(n,a);s.yLabel=h.yLabel,delete s.text;var y=[];if(!a.hovertemplate){var v=(n.hi||a.hoverinfo).split("+");v.indexOf("all")!==-1&&(v=["a","b","text"]),v.indexOf("a")!==-1&&_(g.aaxis,n.a),v.indexOf("b")!==-1&&_(g.baxis,n.b),y.push("y: "+s.yLabel),v.indexOf("text")!==-1&&d(n,a,y),s.extraText=y.join("<br>")}return u}function _(x,T){var A;A=x.labelprefix&&x.labelprefix.length>0?x.labelprefix.replace(/ = $/,""):x._hovertitle,y.push(A+": "+T.toFixed(3)+x.labelsuffix)}}},{"../../lib":787,"../scatter/hover":1213}],1242:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),plot:r("./plot"),style:r("../scatter/style").style,styleOnSelect:r("../scatter/style").styleOnSelect,hoverPoints:r("./hover"),selectPoints:r("../scatter/select"),eventData:r("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:r("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"../scatter/marker_colorbar":1220,"../scatter/select":1224,"../scatter/style":1226,"./attributes":1236,"./calc":1237,"./defaults":1238,"./event_data":1239,"./format_labels":1240,"./hover":1241,"./plot":1243}],1243:[function(r,O,B){var t=r("../scatter/plot"),d=r("../../plots/cartesian/axes"),m=r("../../components/drawing");O.exports=function(p,e,f,u){var s,l,o,i=f[0][0].carpet,c={xaxis:d.getFromId(p,i.xaxis||"x"),yaxis:d.getFromId(p,i.yaxis||"y"),plot:e.plot};for(t(p,c,f,u),s=0;s<f.length;s++)l=f[s][0].trace,o=u.selectAll("g.trace"+l.uid+" .js-line"),m.setClipUrl(o,f[s][0].carpet._clipPathId,p)}},{"../../components/drawing":672,"../../plots/cartesian/axes":838,"../scatter/plot":1223}],1244:[function(r,O,B){var t=r("../../plots/template_attributes").hovertemplateAttrs,d=r("../../plots/template_attributes").texttemplateAttrs,m=r("../scatter/attributes"),p=r("../../plots/attributes"),e=r("../../components/colorscale/attributes"),f=r("../../components/drawing/attributes").dash,u=r("../../lib/extend").extendFlat,s=r("../../plot_api/edit_types").overrideAll,l=m.marker,o=m.line,i=l.line;O.exports=s({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:u({},m.mode,{dflt:"markers"}),text:u({},m.text,{}),texttemplate:d({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:u({},m.hovertext,{}),textfont:m.textfont,textposition:m.textposition,line:{color:o.color,width:o.width,dash:f},connectgaps:m.connectgaps,marker:u({symbol:l.symbol,opacity:l.opacity,size:l.size,sizeref:l.sizeref,sizemin:l.sizemin,sizemode:l.sizemode,colorbar:l.colorbar,line:u({width:i.width},e("marker.line")),gradient:l.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:m.fillcolor,selected:m.selected,unselected:m.unselected,hoverinfo:u({},p.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:t()},"calc","nested")},{"../../components/colorscale/attributes":657,"../../components/drawing/attributes":671,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1245:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../constants/numerical").BADNUM,m=r("../scatter/colorscale_calc"),p=r("../scatter/arrays_to_calcdata"),e=r("../scatter/calc_selection"),f=r("../../lib")._;function u(s){return s&&typeof s=="string"}O.exports=function(s,l){var o,i=Array.isArray(l.locations),c=i?l.locations.length:l._length,n=new Array(c);o=l.geojson?function(_){return u(_)||t(_)}:u;for(var a=0;a<c;a++){var g=n[a]={};if(i){var h=l.locations[a];g.loc=o(h)?h:null}else{var y=l.lon[a],v=l.lat[a];t(y)&&t(v)?g.lonlat=[+y,+v]:g.lonlat=[d,d]}}return p(n,l),m(s,l),e(n,l),c&&(n[0].t={labels:{lat:f(s,"lat:")+" ",lon:f(s,"lon:")+" "}}),n}},{"../../constants/numerical":763,"../../lib":787,"../scatter/arrays_to_calcdata":1201,"../scatter/calc_selection":1204,"../scatter/colorscale_calc":1205,"fast-isnumeric":246}],1246:[function(r,O,B){var t=r("../../lib"),d=r("../scatter/subtypes"),m=r("../scatter/marker_defaults"),p=r("../scatter/line_defaults"),e=r("../scatter/text_defaults"),f=r("../scatter/fillcolor_defaults"),u=r("./attributes");O.exports=function(s,l,o,i){function c(_,x){return t.coerce(s,l,u,_,x)}var n,a=c("locations");if(a&&a.length){var g,h=c("geojson");(typeof h=="string"&&h!==""||t.isPlainObject(h))&&(g="geojson-id"),c("locationmode",g)==="geojson-id"&&c("featureidkey"),n=a.length}else{var y=c("lon")||[],v=c("lat")||[];n=Math.min(y.length,v.length)}n?(l._length=n,c("text"),c("hovertext"),c("hovertemplate"),c("mode"),d.hasLines(l)&&(p(s,l,o,i,c),c("connectgaps")),d.hasMarkers(l)&&m(s,l,o,i,c,{gradient:!0}),d.hasText(l)&&(c("texttemplate"),e(s,l,i,c)),c("fill"),l.fill!=="none"&&f(s,l,o,c),t.coerceSelectionMarkerOpacity(l,c)):l.visible=!1}},{"../../lib":787,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1244}],1247:[function(r,O,B){O.exports=function(t,d,m,p,e){t.lon=d.lon,t.lat=d.lat,t.location=d.loc?d.loc:null;var f=p[e];return f.fIn&&f.fIn.properties&&(t.properties=f.fIn.properties),t}},{}],1248:[function(r,O,B){var t=r("../../plots/cartesian/axes");O.exports=function(d,m,p){var e={},f=p[m.geo]._subplot.mockAxis,u=d.lonlat;return e.lonLabel=t.tickText(f,f.c2l(u[0]),!0).text,e.latLabel=t.tickText(f,f.c2l(u[1]),!0).text,e}},{"../../plots/cartesian/axes":838}],1249:[function(r,O,B){var t=r("../../components/fx"),d=r("../../constants/numerical").BADNUM,m=r("../scatter/get_trace_color"),p=r("../../lib").fillText,e=r("./attributes");O.exports=function(f,u,s){var l=f.cd,o=l[0].trace,i=f.xa,c=f.ya,n=f.subplot,a=n.projection.isLonLatOverEdges,g=n.project;if(t.getClosest(l,function(A){var S=A.lonlat;if(S[0]===d||a(S))return 1/0;var w=g(S),C=g([u,s]),k=Math.abs(w[0]-C[0]),L=Math.abs(w[1]-C[1]),M=Math.max(3,A.mrc||0);return Math.max(Math.sqrt(k*k+L*L)-M,1-3/M)},f),f.index!==!1){var h=l[f.index],y=h.lonlat,v=[i.c2p(y),c.c2p(y)],_=h.mrc||1;f.x0=v[0]-_,f.x1=v[0]+_,f.y0=v[1]-_,f.y1=v[1]+_,f.loc=h.loc,f.lon=y[0],f.lat=y[1];var x={};x[o.geo]={_subplot:n};var T=o._module.formatLabels(h,o,x);return f.lonLabel=T.lonLabel,f.latLabel=T.latLabel,f.color=m(o,h),f.extraText=function(A,S,w,C){if(A.hovertemplate)return;var k=S.hi||A.hoverinfo,L=k==="all"?e.hoverinfo.flags:k.split("+"),M=L.indexOf("location")!==-1&&Array.isArray(A.locations),P=L.indexOf("lon")!==-1,D=L.indexOf("lat")!==-1,N=L.indexOf("text")!==-1,U=[];function q(X){return X+"\xB0"}return M?U.push(S.loc):P&&D?U.push("("+q(w.latLabel)+", "+q(w.lonLabel)+")"):P?U.push(C.lon+q(w.lonLabel)):D&&U.push(C.lat+q(w.latLabel)),N&&p(S,A,U),U.join("<br>")}(o,h,f,l[0].t.labels),f.hovertemplate=o.hovertemplate,[f]}}},{"../../components/fx":690,"../../constants/numerical":763,"../../lib":787,"../scatter/get_trace_color":1212,"./attributes":1244}],1250:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),calcGeoJSON:r("./plot").calcGeoJSON,plot:r("./plot").plot,style:r("./style"),styleOnSelect:r("../scatter/style").styleOnSelect,hoverPoints:r("./hover"),eventData:r("./event_data"),selectPoints:r("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:r("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":871,"../scatter/marker_colorbar":1220,"../scatter/style":1226,"./attributes":1244,"./calc":1245,"./defaults":1246,"./event_data":1247,"./format_labels":1248,"./hover":1249,"./plot":1251,"./select":1252,"./style":1253}],1251:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../lib/topojson_utils").getTopojsonFeatures,p=r("../../lib/geojson_utils"),e=r("../../lib/geo_location_utils"),f=r("../../plots/cartesian/autorange").findExtremes,u=r("../../constants/numerical").BADNUM,s=r("../scatter/calc").calcMarkerSize,l=r("../scatter/subtypes"),o=r("./style");O.exports={calcGeoJSON:function(i,c){var n,a,g=i[0].trace,h=c[g.geo],y=h._subplot,v=g._length;if(Array.isArray(g.locations)){var _=g.locationmode,x=_==="geojson-id"?e.extractTraceFeature(i):m(g,y.topojson);for(n=0;n<v;n++){a=i[n];var T=_==="geojson-id"?a.fOut:e.locationToFeature(_,a.loc,x);a.lonlat=T?T.properties.ct:[u,u]}}var A,S,w={padded:!0};if(h.fitbounds==="geojson"&&g.locationmode==="geojson-id"){var C=e.computeBbox(e.getTraceGeojson(g));A=[C[0],C[2]],S=[C[1],C[3]]}else{for(A=new Array(v),S=new Array(v),n=0;n<v;n++)a=i[n],A[n]=a.lonlat[0],S[n]=a.lonlat[1];w.ppad=s(g,v)}g._extremes.lon=f(h.lonaxis._ax,A,w),g._extremes.lat=f(h.lataxis._ax,S,w)},plot:function(i,c,n){var a=c.layers.frontplot.select(".scatterlayer"),g=d.makeTraceGroups(a,n,"trace scattergeo");function h(y,v){y.lonlat[0]===u&&t.select(v).remove()}g.selectAll("*").remove(),g.each(function(y){var v=t.select(this),_=y[0].trace;if(l.hasLines(_)||_.fill!=="none"){var x=p.calcTraceToLineCoords(y),T=_.fill!=="none"?p.makePolygon(x):p.makeLine(x);v.selectAll("path.js-line").data([{geojson:T,trace:_}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}l.hasMarkers(_)&&v.selectAll("path.point").data(d.identity).enter().append("path").classed("point",!0).each(function(A){h(A,this)}),l.hasText(_)&&v.selectAll("g").data(d.identity).enter().append("g").append("text").each(function(A){h(A,this)}),o(i,y)})}}},{"../../constants/numerical":763,"../../lib":787,"../../lib/geo_location_utils":780,"../../lib/geojson_utils":781,"../../lib/topojson_utils":816,"../../plots/cartesian/autorange":837,"../scatter/calc":1203,"../scatter/subtypes":1227,"./style":1253,"@plotly/d3":58}],1252:[function(r,O,B){var t=r("../scatter/subtypes"),d=r("../../constants/numerical").BADNUM;O.exports=function(m,p){var e,f,u,s,l,o=m.cd,i=m.xaxis,c=m.yaxis,n=[],a=o[0].trace;if(!t.hasMarkers(a)&&!t.hasText(a))return[];if(p===!1)for(l=0;l<o.length;l++)o[l].selected=0;else for(l=0;l<o.length;l++)(f=(e=o[l]).lonlat)[0]!==d&&(u=i.c2p(f),s=c.c2p(f),p.contains([u,s],null,l,m)?(n.push({pointNumber:l,lon:f[0],lat:f[1]}),e.selected=1):e.selected=0);return n}},{"../../constants/numerical":763,"../scatter/subtypes":1227}],1253:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/drawing"),m=r("../../components/color"),p=r("../scatter/style"),e=p.stylePoints,f=p.styleText;O.exports=function(u,s){s&&function(l,o){var i=o[0].trace,c=o[0].node3;c.style("opacity",o[0].trace.opacity),e(c,i,l),f(c,i,l),c.selectAll("path.js-line").style("fill","none").each(function(n){var a=t.select(this),g=n.trace,h=g.line||{};a.call(m.stroke,h.color).call(d.dashLine,h.dash||"",h.width||0),g.fill!=="none"&&a.call(m.fill,g.fillcolor)})}(u,s)}},{"../../components/color":650,"../../components/drawing":672,"../scatter/style":1226,"@plotly/d3":58}],1254:[function(r,O,B){var t=r("../../plots/attributes"),d=r("../scatter/attributes"),m=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=r("../../components/colorscale/attributes"),e=r("../../lib/sort_object_keys"),f=r("../../lib/extend").extendFlat,u=r("../../plot_api/edit_types").overrideAll,s=r("./constants").DASHES,l=d.line,o=d.marker,i=o.line,c=O.exports=u({x:d.x,x0:d.x0,dx:d.dx,y:d.y,y0:d.y0,dy:d.dy,xperiod:d.xperiod,yperiod:d.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:d.xperiodalignment,yperiodalignment:d.yperiodalignment,xhoverformat:m("x"),yhoverformat:m("y"),text:d.text,hovertext:d.hovertext,textposition:d.textposition,textfont:d.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:l.color,width:l.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:e(s),dflt:"solid"}},marker:f({},p("marker"),{symbol:o.symbol,size:o.size,sizeref:o.sizeref,sizemin:o.sizemin,sizemode:o.sizemode,opacity:o.opacity,colorbar:o.colorbar,line:f({},p("marker.line"),{width:i.width})}),connectgaps:d.connectgaps,fill:f({},d.fill,{dflt:"none"}),fillcolor:d.fillcolor,selected:{marker:d.selected.marker,textfont:d.selected.textfont},unselected:{marker:d.unselected.marker,textfont:d.unselected.textfont},opacity:t.opacity},"calc","nested");c.x.editType=c.y.editType=c.x0.editType=c.y0.editType="calc+clearAxisTypes",c.hovertemplate=d.hovertemplate,c.texttemplate=d.texttemplate},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../lib/sort_object_keys":810,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../scatter/attributes":1202,"./constants":1256}],1255:[function(r,O,B){var t=r("@plotly/point-cluster"),d=r("../../lib"),m=r("../../plots/cartesian/axis_ids"),p=r("../../plots/cartesian/autorange").findExtremes,e=r("../../plots/cartesian/align_period"),f=r("../scatter/calc"),u=f.calcMarkerSize,s=f.calcAxisExpansion,l=f.setFirstScatter,o=r("../scatter/colorscale_calc"),i=r("./convert"),c=r("./scene_update"),n=r("../../constants/numerical").BADNUM,a=r("./constants").TOO_MANY_POINTS;function g(h,y,v){var _=h._extremes[y._id],x=p(y,v._bnds,{padded:!0});_.min=_.min.concat(x.min),_.max=_.max.concat(x.max)}O.exports=function(h,y){var v,_=h._fullLayout,x=m.getFromId(h,y.xaxis),T=m.getFromId(h,y.yaxis),A=_._plots[y.xaxis+y.yaxis],S=y._length,w=S>=a,C=2*S,k={},L=x.makeCalcdata(y,"x"),M=T.makeCalcdata(y,"y"),P=e(y,x,"x",L),D=e(y,T,"y",M),N=P.vals,U=D.vals;y._x=N,y._y=U,y.xperiodalignment&&(y._origX=L,y._xStarts=P.starts,y._xEnds=P.ends),y.yperiodalignment&&(y._origY=M,y._yStarts=D.starts,y._yEnds=D.ends);var q=new Array(C),X=new Array(S);for(v=0;v<S;v++)q[2*v]=N[v]===n?NaN:N[v],q[2*v+1]=U[v]===n?NaN:U[v],X[v]=v;if(x.type==="log")for(v=0;v<C;v+=2)q[v]=x.c2l(q[v]);if(T.type==="log")for(v=1;v<C;v+=2)q[v]=T.c2l(q[v]);w&&x.type!=="log"&&T.type!=="log"?k.tree=t(q):k.ids=X,o(h,y);var K,Z=function(Y,$,z,j,W,ee){var J=i.style(Y,z);if(J.marker&&(J.marker.positions=j),J.line&&j.length>1&&d.extendFlat(J.line,i.linePositions(Y,z,j)),J.errorX||J.errorY){var Q=i.errorBarPositions(Y,z,j,W,ee);J.errorX&&d.extendFlat(J.errorX,Q.x),J.errorY&&d.extendFlat(J.errorY,Q.y)}return J.text&&(d.extendFlat(J.text,{positions:j},i.textPosition(Y,z,J.text,J.marker)),d.extendFlat(J.textSel,{positions:j},i.textPosition(Y,z,J.text,J.markerSel)),d.extendFlat(J.textUnsel,{positions:j},i.textPosition(Y,z,J.text,J.markerUnsel))),J}(h,0,y,q,N,U),H=c(h,A);return l(_,y),w?Z.marker&&(K=Z.marker.sizeAvg||Math.max(Z.marker.size,3)):K=u(y,S),s(h,y,x,T,N,U,K),Z.errorX&&g(y,x,Z.errorX),Z.errorY&&g(y,T,Z.errorY),Z.fill&&!H.fill2d&&(H.fill2d=!0),Z.marker&&!H.scatter2d&&(H.scatter2d=!0),Z.line&&!H.line2d&&(H.line2d=!0),!Z.errorX&&!Z.errorY||H.error2d||(H.error2d=!0),Z.text&&!H.glText&&(H.glText=!0),Z.marker&&(Z.marker.snap=S),H.lineOptions.push(Z.line),H.errorXOptions.push(Z.errorX),H.errorYOptions.push(Z.errorY),H.fillOptions.push(Z.fill),H.markerOptions.push(Z.marker),H.markerSelectedOptions.push(Z.markerSel),H.markerUnselectedOptions.push(Z.markerUnsel),H.textOptions.push(Z.text),H.textSelectedOptions.push(Z.textSel),H.textUnselectedOptions.push(Z.textUnsel),H.selectBatch.push([]),H.unselectBatch.push([]),k._scene=H,k.index=H.count,k.x=N,k.y=U,k.positions=q,H.count++,[{x:!1,y:!1,t:k,trace:y}]}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/autorange":837,"../../plots/cartesian/axis_ids":842,"../scatter/calc":1203,"../scatter/colorscale_calc":1205,"./constants":1256,"./convert":1257,"./scene_update":1265,"@plotly/point-cluster":59}],1256:[function(r,O,B){O.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],1257:[function(r,O,B){var t=r("fast-isnumeric"),d=r("svg-path-sdf"),m=r("color-normalize"),p=r("../../registry"),e=r("../../lib"),f=r("../../components/drawing"),u=r("../../plots/cartesian/axis_ids"),s=r("../../lib/gl_format_color").formatColor,l=r("../scatter/subtypes"),o=r("../scatter/make_bubble_size_func"),i=r("./helpers"),c=r("./constants"),n=r("../../constants/interactions").DESELECTDIM,a={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},g=r("../../components/fx/helpers").appendArrayPointValue;function h(L,M){var P,D=L._fullLayout,N=M._length,U=M.textfont,q=M.textposition,X=Array.isArray(q)?q:[q],K=U.color,Z=U.size,H=U.family,Y={},$=L._context.plotGlPixelRatio,z=M.texttemplate;if(z){Y.text=[];var j=D._d3locale,W=Array.isArray(z),ee=W?Math.min(z.length,N):N,J=W?function(de){return z[de]}:function(){return z};for(P=0;P<ee;P++){var Q={i:P},te=M._module.formatLabels(Q,M,D),ie={};g(ie,M,P);var ae=M._meta||{};Y.text.push(e.texttemplateString(J(P),te,j,ie,Q,ae))}}else Array.isArray(M.text)&&M.text.length<N?Y.text=M.text.slice():Y.text=M.text;if(Array.isArray(Y.text))for(P=Y.text.length;P<N;P++)Y.text[P]="";for(Y.opacity=M.opacity,Y.font={},Y.align=[],Y.baseline=[],P=0;P<X.length;P++){var he=X[P].split(/\s+/);switch(he[1]){case"left":Y.align.push("right");break;case"right":Y.align.push("left");break;default:Y.align.push(he[1])}switch(he[0]){case"top":Y.baseline.push("bottom");break;case"bottom":Y.baseline.push("top");break;default:Y.baseline.push(he[0])}}if(Array.isArray(K))for(Y.color=new Array(N),P=0;P<N;P++)Y.color[P]=K[P];else Y.color=K;if(e.isArrayOrTypedArray(Z)||Array.isArray(H))for(Y.font=new Array(N),P=0;P<N;P++){var se=Y.font[P]={};se.size=(e.isTypedArray(Z)?Z[P]:Array.isArray(Z)?t(Z[P])?Z[P]:0:Z)*$,se.family=Array.isArray(H)?H[P]:H}else Y.font={size:Z*$,family:H};return Y}function y(L){var M,P,D=L._length,N=L.marker,U={},q=e.isArrayOrTypedArray(N.symbol),X=e.isArrayOrTypedArray(N.color),K=e.isArrayOrTypedArray(N.line.color),Z=e.isArrayOrTypedArray(N.opacity),H=e.isArrayOrTypedArray(N.size),Y=e.isArrayOrTypedArray(N.line.width);if(q||(P=i.isOpenSymbol(N.symbol)),q||X||K||Z){U.colors=new Array(D),U.borderColors=new Array(D);var $=s(N,N.opacity,D),z=s(N.line,N.opacity,D);if(!Array.isArray(z[0])){var j=z;for(z=Array(D),M=0;M<D;M++)z[M]=j}if(!Array.isArray($[0])){var W=$;for($=Array(D),M=0;M<D;M++)$[M]=W}for(U.colors=$,U.borderColors=z,M=0;M<D;M++){if(q){var ee=N.symbol[M];P=i.isOpenSymbol(ee)}P&&(z[M]=$[M].slice(),$[M]=$[M].slice(),$[M][3]=0)}U.opacity=L.opacity}else P?(U.color=m(N.color,"uint8"),U.color[3]=0,U.borderColor=m(N.color,"uint8")):(U.color=m(N.color,"uint8"),U.borderColor=m(N.line.color,"uint8")),U.opacity=L.opacity*N.opacity;if(q)for(U.markers=new Array(D),M=0;M<D;M++)U.markers[M]=k(N.symbol[M]);else U.marker=k(N.symbol);var J,Q=o(L,1);if(H||Y){var te,ie=U.sizes=new Array(D),ae=U.borderSizes=new Array(D),he=0;if(H){for(M=0;M<D;M++)ie[M]=Q(N.size[M]),he+=ie[M];te=he/D}else for(J=Q(N.size),M=0;M<D;M++)ie[M]=J;if(Y)for(M=0;M<D;M++)ae[M]=N.line.width[M];else for(J=N.line.width,M=0;M<D;M++)ae[M]=J;U.sizeAvg=te}else U.size=Q(N&&N.size||10),U.borderSizes=Q(N.line.width);return U}function v(L,M){var P=L.marker,D={};return M&&(M.marker&&M.marker.symbol?D=y(e.extendFlat({},P,M.marker)):M.marker&&(M.marker.size&&(D.size=M.marker.size),M.marker.color&&(D.colors=M.marker.color),M.marker.opacity!==void 0&&(D.opacity=M.marker.opacity))),D}function _(L,M,P){var D={};if(!P)return D;if(P.textfont){var N={opacity:1,text:M.text,texttemplate:M.texttemplate,textposition:M.textposition,textfont:e.extendFlat({},M.textfont)};P.textfont&&e.extendFlat(N.textfont,P.textfont),D=h(L,N)}return D}function x(L,M,P){var D={capSize:2*M.width*P,lineWidth:M.thickness*P,color:M.color};return M.copy_ystyle&&(D=L.error_y),D}var T=c.SYMBOL_SDF_SIZE,A=c.SYMBOL_SIZE,S=c.SYMBOL_STROKE,w={},C=f.symbolFuncs[0](.05*A);function k(L){if(L==="circle")return null;var M,P,D=f.symbolNumber(L),N=f.symbolFuncs[D%100],U=!!f.symbolNoDot[D%100],q=!!f.symbolNoFill[D%100],X=i.isDotSymbol(L);return w[L]?w[L]:(M=X&&!U?N(1.1*A)+C:N(A),P=d(M,{w:T,h:T,viewBox:[-A,-A,A,A],stroke:q?S:-S}),w[L]=P,P||null)}O.exports={style:function(L,M){var P,D={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},N=L._context.plotGlPixelRatio;if(M.visible!==!0)return D;if(l.hasText(M)&&(D.text=h(L,M),D.textSel=_(L,M,M.selected),D.textUnsel=_(L,M,M.unselected)),l.hasMarkers(M)&&(D.marker=y(M),D.markerSel=v(M,M.selected),D.markerUnsel=v(M,M.unselected),!M.unselected&&e.isArrayOrTypedArray(M.marker.opacity))){var U=M.marker.opacity;for(D.markerUnsel.opacity=new Array(U.length),P=0;P<U.length;P++)D.markerUnsel.opacity[P]=n*U[P]}if(l.hasLines(M)){D.line={overlay:!0,thickness:M.line.width*N,color:M.line.color,opacity:M.opacity};var q=(c.DASHES[M.line.dash]||[1]).slice();for(P=0;P<q.length;++P)q[P]*=M.line.width*N;D.line.dashes=q}return M.error_x&&M.error_x.visible&&(D.errorX=x(M,M.error_x,N)),M.error_y&&M.error_y.visible&&(D.errorY=x(M,M.error_y,N)),M.fill&&M.fill!=="none"&&(D.fill={closed:!0,fill:M.fillcolor,thickness:0}),D},markerStyle:y,markerSelection:v,linePositions:function(L,M,P){var D,N,U=P.length,q=U/2;if(l.hasLines(M)&&q)if(M.line.shape==="hv"){for(D=[],N=0;N<q-1;N++)isNaN(P[2*N])||isNaN(P[2*N+1])?D.push(NaN,NaN,NaN,NaN):(D.push(P[2*N],P[2*N+1]),isNaN(P[2*N+2])||isNaN(P[2*N+3])?D.push(NaN,NaN):D.push(P[2*N+2],P[2*N+1]));D.push(P[U-2],P[U-1])}else if(M.line.shape==="hvh"){for(D=[],N=0;N<q-1;N++)if(isNaN(P[2*N])||isNaN(P[2*N+1])||isNaN(P[2*N+2])||isNaN(P[2*N+3]))isNaN(P[2*N])||isNaN(P[2*N+1])?D.push(NaN,NaN):D.push(P[2*N],P[2*N+1]),D.push(NaN,NaN);else{var X=(P[2*N]+P[2*N+2])/2;D.push(P[2*N],P[2*N+1],X,P[2*N+1],X,P[2*N+3])}D.push(P[U-2],P[U-1])}else if(M.line.shape==="vhv"){for(D=[],N=0;N<q-1;N++)if(isNaN(P[2*N])||isNaN(P[2*N+1])||isNaN(P[2*N+2])||isNaN(P[2*N+3]))isNaN(P[2*N])||isNaN(P[2*N+1])?D.push(NaN,NaN):D.push(P[2*N],P[2*N+1]),D.push(NaN,NaN);else{var K=(P[2*N+1]+P[2*N+3])/2;D.push(P[2*N],P[2*N+1],P[2*N],K,P[2*N+2],K)}D.push(P[U-2],P[U-1])}else if(M.line.shape==="vh"){for(D=[],N=0;N<q-1;N++)isNaN(P[2*N])||isNaN(P[2*N+1])?D.push(NaN,NaN,NaN,NaN):(D.push(P[2*N],P[2*N+1]),isNaN(P[2*N+2])||isNaN(P[2*N+3])?D.push(NaN,NaN):D.push(P[2*N],P[2*N+3]));D.push(P[U-2],P[U-1])}else D=P;var Z=!1;for(N=0;N<D.length;N++)if(isNaN(D[N])){Z=!0;break}var H=Z||D.length>c.TOO_MANY_POINTS||l.hasMarkers(M)?"rect":"round";if(Z&&M.connectgaps){var Y=D[0],$=D[1];for(N=0;N<D.length;N+=2)isNaN(D[N])||isNaN(D[N+1])?(D[N]=Y,D[N+1]=$):(Y=D[N],$=D[N+1])}return{join:H,positions:D}},errorBarPositions:function(L,M,P,D,N){var U=p.getComponentMethod("errorbars","makeComputeError"),q=u.getFromId(L,M.xaxis),X=u.getFromId(L,M.yaxis),K=P.length/2,Z={};function H(Y,$){var z=$._id.charAt(0),j=M["error_"+z];if(j&&j.visible&&($.type==="linear"||$.type==="log")){for(var W=U(j),ee={x:0,y:1}[z],J={x:[0,1,2,3],y:[2,3,0,1]}[z],Q=new Float64Array(4*K),te=1/0,ie=-1/0,ae=0,he=0;ae<K;ae++,he+=4){var se=Y[ae];if(t(se)){var de=P[2*ae+ee],ue=W(se,ae),ve=ue[0],ke=ue[1];if(t(ve)&&t(ke)){var Ee=se-ve,be=se+ke;Q[he+J[0]]=de-$.c2l(Ee),Q[he+J[1]]=$.c2l(be)-de,Q[he+J[2]]=0,Q[he+J[3]]=0,te=Math.min(te,se-ve),ie=Math.max(ie,se+ke)}}}Z[z]={positions:P,errors:Q,_bnds:[te,ie]}}}return H(D,q),H(N,X),Z},textPosition:function(L,M,P,D){var N,U=M._length,q={};if(l.hasMarkers(M)){var X=P.font,K=P.align,Z=P.baseline;for(q.offset=new Array(U),N=0;N<U;N++){var H=D.sizes?D.sizes[N]:D.size,Y=Array.isArray(X)?X[N].size:X.size,$=Array.isArray(K)?K.length>1?K[N]:K[0]:K,z=Array.isArray(Z)?Z.length>1?Z[N]:Z[0]:Z,j=a[$],W=a[z],ee=H?H/.8+1:0,J=-W*ee-.5*W;q.offset[N]=[j*ee/Y,J/Y]}}return q}}},{"../../components/drawing":672,"../../components/fx/helpers":686,"../../constants/interactions":762,"../../lib":787,"../../lib/gl_format_color":783,"../../plots/cartesian/axis_ids":842,"../../registry":915,"../scatter/make_bubble_size_func":1219,"../scatter/subtypes":1227,"./constants":1256,"./helpers":1261,"color-normalize":131,"fast-isnumeric":246,"svg-path-sdf":580}],1258:[function(r,O,B){var t=r("../../lib"),d=r("../../registry"),m=r("./helpers"),p=r("./attributes"),e=r("../scatter/constants"),f=r("../scatter/subtypes"),u=r("../scatter/xy_defaults"),s=r("../scatter/period_defaults"),l=r("../scatter/marker_defaults"),o=r("../scatter/line_defaults"),i=r("../scatter/fillcolor_defaults"),c=r("../scatter/text_defaults");O.exports=function(n,a,g,h){function y(C,k){return t.coerce(n,a,p,C,k)}var v=!!n.marker&&m.isOpenSymbol(n.marker.symbol),_=f.isBubble(n),x=u(n,a,h,y);if(x){s(n,a,h,y),y("xhoverformat"),y("yhoverformat");var T=x<e.PTS_LINESONLY?"lines+markers":"lines";y("text"),y("hovertext"),y("hovertemplate"),y("mode",T),f.hasLines(a)&&(y("connectgaps"),o(n,a,g,h,y),y("line.shape")),f.hasMarkers(a)&&(l(n,a,g,h,y),y("marker.line.width",v||_?1:0)),f.hasText(a)&&(y("texttemplate"),c(n,a,h,y));var A=(a.line||{}).color,S=(a.marker||{}).color;y("fill"),a.fill!=="none"&&i(n,a,g,y);var w=d.getComponentMethod("errorbars","supplyDefaults");w(n,a,A||S||g,{axis:"y"}),w(n,a,A||S||g,{axis:"x",inherit:"y"}),t.coerceSelectionMarkerOpacity(a,y)}else a.visible=!1}},{"../../lib":787,"../../registry":915,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/period_defaults":1222,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"../scatter/xy_defaults":1229,"./attributes":1254,"./helpers":1261}],1259:[function(r,O,B){var t=r("../../lib"),d=r("../../components/color"),m=r("../../constants/interactions").DESELECTDIM;O.exports={styleTextSelection:function(p){var e,f,u=p[0],s=u.trace,l=u.t,o=l._scene,i=l.index,c=o.selectBatch[i],n=o.unselectBatch[i],a=o.textOptions[i],g=o.textSelectedOptions[i]||{},h=o.textUnselectedOptions[i]||{},y=t.extendFlat({},a);if(c.length||n.length){var v=g.color,_=h.color,x=a.color,T=Array.isArray(x);for(y.color=new Array(s._length),e=0;e<c.length;e++)f=c[e],y.color[f]=v||(T?x[f]:x);for(e=0;e<n.length;e++){f=n[e];var A=T?x[f]:x;y.color[f]=_||(v?A:d.addOpacity(A,m))}}o.glText[i].update(y)}}},{"../../components/color":650,"../../constants/interactions":762,"../../lib":787}],1260:[function(r,O,B){var t=r("../scatter/format_labels");O.exports=function(d,m,p){var e=d.i;return"x"in d||(d.x=m._x[e]),"y"in d||(d.y=m._y[e]),t(d,m,p)}},{"../scatter/format_labels":1211}],1261:[function(r,O,B){var t=r("./constants");B.isOpenSymbol=function(d){return typeof d=="string"?t.OPEN_RE.test(d):d%200>100},B.isDotSymbol=function(d){return typeof d=="string"?t.DOT_RE.test(d):d>200}},{"./constants":1256}],1262:[function(r,O,B){var t=r("../../registry"),d=r("../../lib"),m=r("../scatter/get_trace_color");function p(e,f,u,s){var l=e.xa,o=e.ya,i=e.distance,c=e.dxy,n=e.index,a={pointNumber:n,x:f[n],y:u[n]};a.tx=Array.isArray(s.text)?s.text[n]:s.text,a.htx=Array.isArray(s.hovertext)?s.hovertext[n]:s.hovertext,a.data=Array.isArray(s.customdata)?s.customdata[n]:s.customdata,a.tp=Array.isArray(s.textposition)?s.textposition[n]:s.textposition;var g=s.textfont;g&&(a.ts=d.isArrayOrTypedArray(g.size)?g.size[n]:g.size,a.tc=Array.isArray(g.color)?g.color[n]:g.color,a.tf=Array.isArray(g.family)?g.family[n]:g.family);var h=s.marker;h&&(a.ms=d.isArrayOrTypedArray(h.size)?h.size[n]:h.size,a.mo=d.isArrayOrTypedArray(h.opacity)?h.opacity[n]:h.opacity,a.mx=d.isArrayOrTypedArray(h.symbol)?h.symbol[n]:h.symbol,a.mc=d.isArrayOrTypedArray(h.color)?h.color[n]:h.color);var y=h&&h.line;y&&(a.mlc=Array.isArray(y.color)?y.color[n]:y.color,a.mlw=d.isArrayOrTypedArray(y.width)?y.width[n]:y.width);var v=h&&h.gradient;v&&v.type!=="none"&&(a.mgt=Array.isArray(v.type)?v.type[n]:v.type,a.mgc=Array.isArray(v.color)?v.color[n]:v.color);var _=l.c2p(a.x,!0),x=o.c2p(a.y,!0),T=a.mrc||1,A=s.hoverlabel;A&&(a.hbg=Array.isArray(A.bgcolor)?A.bgcolor[n]:A.bgcolor,a.hbc=Array.isArray(A.bordercolor)?A.bordercolor[n]:A.bordercolor,a.hts=d.isArrayOrTypedArray(A.font.size)?A.font.size[n]:A.font.size,a.htc=Array.isArray(A.font.color)?A.font.color[n]:A.font.color,a.htf=Array.isArray(A.font.family)?A.font.family[n]:A.font.family,a.hnl=d.isArrayOrTypedArray(A.namelength)?A.namelength[n]:A.namelength);var S=s.hoverinfo;S&&(a.hi=Array.isArray(S)?S[n]:S);var w=s.hovertemplate;w&&(a.ht=Array.isArray(w)?w[n]:w);var C={};C[e.index]=a;var k=s._origX,L=s._origY,M=d.extendFlat({},e,{color:m(s,a),x0:_-T,x1:_+T,xLabelVal:k?k[n]:a.x,y0:x-T,y1:x+T,yLabelVal:L?L[n]:a.y,cd:C,distance:i,spikeDistance:c,hovertemplate:a.ht});return a.htx?M.text=a.htx:a.tx?M.text=a.tx:s.text&&(M.text=s.text),d.fillText(a,s,M),t.getComponentMethod("errorbars","hoverInfo")(a,s,M),M}O.exports={hoverPoints:function(e,f,u,s){var l,o,i,c,n,a,g,h,y,v,_=e.cd,x=_[0].t,T=_[0].trace,A=e.xa,S=e.ya,w=x.x,C=x.y,k=A.c2p(f),L=S.c2p(u),M=e.distance;if(x.tree){var P=A.p2c(k-M),D=A.p2c(k+M),N=S.p2c(L-M),U=S.p2c(L+M);l=s==="x"?x.tree.range(Math.min(P,D),Math.min(S._rl[0],S._rl[1]),Math.max(P,D),Math.max(S._rl[0],S._rl[1])):x.tree.range(Math.min(P,D),Math.min(N,U),Math.max(P,D),Math.max(N,U))}else l=x.ids;var q=M;if(s==="x"){var X=!!T.xperiodalignment,K=!!T.yperiodalignment;for(a=0;a<l.length;a++){if(c=w[o=l[a]],g=Math.abs(A.c2p(c)-k),X){var Z=A.c2p(T._xStarts[o]),H=A.c2p(T._xEnds[o]);g=k>=Math.min(Z,H)&&k<=Math.max(Z,H)?0:1/0}if(g<q){if(q=g,n=C[o],h=S.c2p(n)-L,K){var Y=S.c2p(T._yStarts[o]),$=S.c2p(T._yEnds[o]);h=L>=Math.min(Y,$)&&L<=Math.max(Y,$)?0:1/0}v=Math.sqrt(g*g+h*h),i=l[a]}}}else for(a=l.length-1;a>-1;a--)c=w[o=l[a]],n=C[o],g=A.c2p(c)-k,h=S.c2p(n)-L,(y=Math.sqrt(g*g+h*h))<q&&(q=v=y,i=o);return e.index=i,e.distance=q,e.dxy=v,i===void 0?[e]:[p(e,w,C,T)]},calcHover:p}},{"../../lib":787,"../../registry":915,"../scatter/get_trace_color":1212}],1263:[function(r,O,B){var t=r("./hover");O.exports={moduleType:"trace",name:"scattergl",basePlotModule:r("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:r("./attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("../scatter/cross_trace_defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),plot:r("./plot"),hoverPoints:t.hoverPoints,selectPoints:r("./select"),meta:{}}},{"../../plots/cartesian":852,"../scatter/cross_trace_defaults":1208,"../scatter/marker_colorbar":1220,"./attributes":1254,"./calc":1255,"./defaults":1258,"./format_labels":1260,"./hover":1262,"./plot":1264,"./select":1266}],1264:[function(r,O,B){var t=r("regl-scatter2d"),d=r("regl-line2d"),m=r("regl-error2d"),p=r("gl-text"),e=r("../../lib"),f=r("../../components/dragelement/helpers").selectMode,u=r("../../lib/prepare_regl"),s=r("../scatter/subtypes"),l=r("../scatter/link_traces"),o=r("./edit_style").styleTextSelection;function i(c,n,a,g){var h=c._size,y=c.width*g,v=c.height*g,_=h.l*g,x=h.b*g,T=h.r*g,A=h.t*g,S=h.w*g,w=h.h*g;return[_+n.domain[0]*S,x+a.domain[0]*w,y-T-(1-n.domain[1])*S,v-A-(1-a.domain[1])*w]}O.exports=function(c,n,a){if(a.length){var g,h,y=c._fullLayout,v=n._scene,_=n.xaxis,x=n.yaxis;if(v)if(u(c,["ANGLE_instanced_arrays","OES_element_index_uint"])){var T=v.count,A=y._glcanvas.data()[0].regl;if(l(c,n,a),v.dirty){if(v.error2d===!0&&(v.error2d=m(A)),v.line2d===!0&&(v.line2d=d(A)),v.scatter2d===!0&&(v.scatter2d=t(A)),v.fill2d===!0&&(v.fill2d=d(A)),v.glText===!0)for(v.glText=new Array(T),g=0;g<T;g++)v.glText[g]=new p(A);if(v.glText){if(T>v.glText.length){var S=T-v.glText.length;for(g=0;g<S;g++)v.glText.push(new p(A))}else if(T<v.glText.length){var w=v.glText.length-T;v.glText.splice(T,w).forEach(function(J){J.destroy()})}for(g=0;g<T;g++)v.glText[g].update(v.textOptions[g])}if(v.line2d&&(v.line2d.update(v.lineOptions),v.lineOptions=v.lineOptions.map(function(J){if(J&&J.positions){for(var Q=J.positions,te=0;te<Q.length&&(isNaN(Q[te])||isNaN(Q[te+1]));)te+=2;for(var ie=Q.length-2;ie>te&&(isNaN(Q[ie])||isNaN(Q[ie+1]));)ie-=2;J.positions=Q.slice(te,ie+2)}return J}),v.line2d.update(v.lineOptions)),v.error2d){var C=(v.errorXOptions||[]).concat(v.errorYOptions||[]);v.error2d.update(C)}v.scatter2d&&v.scatter2d.update(v.markerOptions),v.fillOrder=e.repeat(null,T),v.fill2d&&(v.fillOptions=v.fillOptions.map(function(J,Q){var te=a[Q];if(J&&te&&te[0]&&te[0].trace){var ie,ae,he=te[0],se=he.trace,de=he.t,ue=v.lineOptions[Q],ve=[];se._ownfill&&ve.push(Q),se._nexttrace&&ve.push(Q+1),ve.length&&(v.fillOrder[Q]=ve);var ke,Ee,be=[],xe=ue&&ue.positions||de.positions;if(se.fill==="tozeroy"){for(ke=0;ke<xe.length&&isNaN(xe[ke+1]);)ke+=2;for(Ee=xe.length-2;Ee>ke&&isNaN(xe[Ee+1]);)Ee-=2;xe[ke+1]!==0&&(be=[xe[ke],0]),be=be.concat(xe.slice(ke,Ee+2)),xe[Ee+1]!==0&&(be=be.concat([xe[Ee],0]))}else if(se.fill==="tozerox"){for(ke=0;ke<xe.length&&isNaN(xe[ke]);)ke+=2;for(Ee=xe.length-2;Ee>ke&&isNaN(xe[Ee]);)Ee-=2;xe[ke]!==0&&(be=[0,xe[ke+1]]),be=be.concat(xe.slice(ke,Ee+2)),xe[Ee]!==0&&(be=be.concat([0,xe[Ee+1]]))}else if(se.fill==="toself"||se.fill==="tonext"){for(be=[],ie=0,J.splitNull=!0,ae=0;ae<xe.length;ae+=2)(isNaN(xe[ae])||isNaN(xe[ae+1]))&&((be=be.concat(xe.slice(ie,ae))).push(xe[ie],xe[ie+1]),be.push(null,null),ie=ae+2);be=be.concat(xe.slice(ie)),ie&&be.push(xe[ie],xe[ie+1])}else{var ce=se._nexttrace;if(ce){var ge=v.lineOptions[Q+1];if(ge){var we=ge.positions;if(se.fill==="tonexty"){for(be=xe.slice(),Q=Math.floor(we.length/2);Q--;){var Me=we[2*Q],Se=we[2*Q+1];isNaN(Me)||isNaN(Se)||be.push(Me,Se)}J.fill=ce.fillcolor}}}}if(se._prevtrace&&se._prevtrace.fill==="tonext"){var ze=v.lineOptions[Q-1].positions,Fe=be.length/2,Ye=[ie=Fe];for(ae=0;ae<ze.length;ae+=2)(isNaN(ze[ae])||isNaN(ze[ae+1]))&&(Ye.push(ae/2+Fe+1),ie=ae+2);be=be.concat(ze),J.hole=Ye}return J.fillmode=se.fill,J.opacity=se.opacity,J.positions=be,J}}),v.fill2d.update(v.fillOptions))}var k=y.dragmode,L=f(k),M=y.clickmode.indexOf("select")>-1;for(g=0;g<T;g++){var P=a[g][0],D=P.trace,N=P.t,U=N.index,q=D._length,X=N.x,K=N.y;if(D.selectedpoints||L||M){if(L||(L=!0),D.selectedpoints){var Z=v.selectBatch[U]=e.selIndices2selPoints(D),H={};for(h=0;h<Z.length;h++)H[Z[h]]=1;var Y=[];for(h=0;h<q;h++)H[h]||Y.push(h);v.unselectBatch[U]=Y}var $=N.xpx=new Array(q),z=N.ypx=new Array(q);for(h=0;h<q;h++)$[h]=_.c2p(X[h]),z[h]=x.c2p(K[h])}else N.xpx=N.ypx=null}if(L){if(v.select2d||(v.select2d=t(y._glcanvas.data()[1].regl)),v.scatter2d){var j=new Array(T);for(g=0;g<T;g++)j[g]=v.selectBatch[g].length||v.unselectBatch[g].length?v.markerUnselectedOptions[g]:{};v.scatter2d.update(j)}v.select2d&&(v.select2d.update(v.markerOptions),v.select2d.update(v.markerSelectedOptions)),v.glText&&a.forEach(function(J){var Q=((J||[])[0]||{}).trace||{};s.hasText(Q)&&o(J)})}else v.scatter2d&&v.scatter2d.update(v.markerOptions);var W={viewport:i(y,_,x,c._context.plotGlPixelRatio),range:[(_._rl||_.range)[0],(x._rl||x.range)[0],(_._rl||_.range)[1],(x._rl||x.range)[1]]},ee=e.repeat(W,v.count);v.fill2d&&v.fill2d.update(ee),v.line2d&&v.line2d.update(ee),v.error2d&&v.error2d.update(ee.concat(ee)),v.scatter2d&&v.scatter2d.update(ee),v.select2d&&v.select2d.update(ee),v.glText&&v.glText.forEach(function(J){J.update(W)})}else v.init()}}},{"../../components/dragelement/helpers":668,"../../lib":787,"../../lib/prepare_regl":800,"../scatter/link_traces":1218,"../scatter/subtypes":1227,"./edit_style":1259,"gl-text":347,"regl-error2d":522,"regl-line2d":523,"regl-scatter2d":524}],1265:[function(r,O,B){var t=r("../../lib");O.exports=function(d,m){var p=m._scene,e={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},f={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return m._scene||((p=m._scene={}).init=function(){t.extendFlat(p,f,e)},p.init(),p.update=function(u){var s=t.repeat(u,p.count);if(p.fill2d&&p.fill2d.update(s),p.scatter2d&&p.scatter2d.update(s),p.line2d&&p.line2d.update(s),p.error2d&&p.error2d.update(s.concat(s)),p.select2d&&p.select2d.update(s),p.glText)for(var l=0;l<p.count;l++)p.glText[l].update(u)},p.draw=function(){for(var u=p.count,s=p.fill2d,l=p.error2d,o=p.line2d,i=p.scatter2d,c=p.glText,n=p.select2d,a=p.selectBatch,g=p.unselectBatch,h=0;h<u;h++){if(s&&p.fillOrder[h]&&s.draw(p.fillOrder[h]),o&&p.lineOptions[h]&&o.draw(h),l&&(p.errorXOptions[h]&&l.draw(h),p.errorYOptions[h]&&l.draw(h+u)),i&&p.markerOptions[h])if(g[h].length){var y=t.repeat([],p.count);y[h]=g[h],i.draw(y)}else a[h].length||i.draw(h);c[h]&&p.textOptions[h]&&c[h].render()}n&&n.draw(a),p.dirty=!1},p.destroy=function(){p.fill2d&&p.fill2d.destroy&&p.fill2d.destroy(),p.scatter2d&&p.scatter2d.destroy&&p.scatter2d.destroy(),p.error2d&&p.error2d.destroy&&p.error2d.destroy(),p.line2d&&p.line2d.destroy&&p.line2d.destroy(),p.select2d&&p.select2d.destroy&&p.select2d.destroy(),p.glText&&p.glText.forEach(function(u){u.destroy&&u.destroy()}),p.lineOptions=null,p.fillOptions=null,p.markerOptions=null,p.markerSelectedOptions=null,p.markerUnselectedOptions=null,p.errorXOptions=null,p.errorYOptions=null,p.textOptions=null,p.textSelectedOptions=null,p.textUnselectedOptions=null,p.selectBatch=null,p.unselectBatch=null,m._scene=null}),p.dirty||t.extendFlat(p,e),p}},{"../../lib":787}],1266:[function(r,O,B){var t=r("../scatter/subtypes"),d=r("./edit_style").styleTextSelection;O.exports=function(m,p){var e=m.cd,f=m.xaxis,u=m.yaxis,s=[],l=e[0].trace,o=e[0].t,i=l._length,c=o.x,n=o.y,a=o._scene,g=o.index;if(!a)return s;var h=t.hasText(l),y=t.hasMarkers(l),v=!y&&!h;if(l.visible!==!0||v)return s;var _=[],x=[];if(p!==!1&&!p.degenerate)for(var T=0;T<i;T++)p.contains([o.xpx[T],o.ypx[T]],!1,T,m)?(_.push(T),s.push({pointNumber:T,x:f.c2d(c[T]),y:u.c2d(n[T])})):x.push(T);if(y){var A=a.scatter2d;if(_.length||x.length){if(!a.selectBatch[g].length&&!a.unselectBatch[g].length){var S=new Array(a.count);S[g]=a.markerUnselectedOptions[g],A.update.apply(A,S)}}else{var w=new Array(a.count);w[g]=a.markerOptions[g],A.update.apply(A,w)}}return a.selectBatch[g]=_,a.unselectBatch[g]=x,h&&d(e),s}},{"../scatter/subtypes":1227,"./edit_style":1259}],1267:[function(r,O,B){var t=r("../../plots/template_attributes").hovertemplateAttrs,d=r("../../plots/template_attributes").texttemplateAttrs,m=r("../scattergeo/attributes"),p=r("../scatter/attributes"),e=r("../../plots/mapbox/layout_attributes"),f=r("../../plots/attributes"),u=r("../../components/colorscale/attributes"),s=r("../../lib/extend").extendFlat,l=r("../../plot_api/edit_types").overrideAll,o=m.line,i=m.marker;O.exports=l({lon:m.lon,lat:m.lat,mode:s({},p.mode,{dflt:"markers"}),text:s({},p.text,{}),texttemplate:d({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:s({},p.hovertext,{}),line:{color:o.color,width:o.width},connectgaps:p.connectgaps,marker:s({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:i.opacity,size:i.size,sizeref:i.sizeref,sizemin:i.sizemin,sizemode:i.sizemode},u("marker")),fill:m.fill,fillcolor:p.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:p.selected.marker},unselected:{marker:p.unselected.marker},hoverinfo:s({},f.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:t()},"calc","nested")},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/mapbox/layout_attributes":897,"../../plots/template_attributes":910,"../scatter/attributes":1202,"../scattergeo/attributes":1244}],1268:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../constants/numerical").BADNUM,p=r("../../lib/geojson_utils"),e=r("../../components/colorscale"),f=r("../../components/drawing"),u=r("../scatter/make_bubble_size_func"),s=r("../scatter/subtypes"),l=r("../../plots/mapbox/convert_text_opts"),o=r("../../components/fx/helpers").appendArrayPointValue,i=r("../../lib/svg_text_utils").NEWLINES,c=r("../../lib/svg_text_utils").BR_TAG_ALL;function n(){return{geojson:p.makeBlank(),layout:{visibility:"none"},paint:{}}}function a(y,v){return d.isArrayOrTypedArray(y)?v?function(_){return t(y[_])?+y[_]:0}:function(_){return y[_]}:y?function(){return y}:g}function g(){return""}function h(y){return y[0]===m}O.exports=function(y,v){var _,x=v[0].trace,T=x.visible===!0&&x._length!==0,A=x.fill!=="none",S=s.hasLines(x),w=s.hasMarkers(x),C=s.hasText(x),k=w&&x.marker.symbol==="circle",L=w&&x.marker.symbol!=="circle",M=n(),P=n(),D=n(),N=n(),U={fill:M,line:P,circle:D,symbol:N};if(!T)return U;if((A||S)&&(_=p.calcTraceToLineCoords(v)),A&&(M.geojson=p.makePolygon(_),M.layout.visibility="visible",d.extendFlat(M.paint,{"fill-color":x.fillcolor})),S&&(P.geojson=p.makeLine(_),P.layout.visibility="visible",d.extendFlat(P.paint,{"line-width":x.line.width,"line-color":x.line.color,"line-opacity":x.opacity})),k){var q=function(Z){var H,Y,$,z,j=Z[0].trace,W=j.marker,ee=j.selectedpoints,J=d.isArrayOrTypedArray(W.color),Q=d.isArrayOrTypedArray(W.size),te=d.isArrayOrTypedArray(W.opacity);function ie(Ee){return j.opacity*Ee}J&&(Y=e.hasColorscale(j,"marker")?e.makeColorScaleFuncFromTrace(W):d.identity),Q&&($=u(j)),te&&(z=function(Ee){return ie(t(Ee)?+d.constrain(Ee,0,1):0)});var ae,he=[];for(H=0;H<Z.length;H++){var se=Z[H],de=se.lonlat;if(!h(de)){var ue={};Y&&(ue.mcc=se.mcc=Y(se.mc)),$&&(ue.mrc=se.mrc=$(se.ms)),z&&(ue.mo=z(se.mo)),ee&&(ue.selected=se.selected||0),he.push({type:"Feature",geometry:{type:"Point",coordinates:de},properties:ue})}}if(ee)for(ae=f.makeSelectedPointStyleFns(j),H=0;H<he.length;H++){var ve=he[H].properties;ae.selectedOpacityFn&&(ve.mo=ie(ae.selectedOpacityFn(ve))),ae.selectedColorFn&&(ve.mcc=ae.selectedColorFn(ve)),ae.selectedSizeFn&&(ve.mrc=ae.selectedSizeFn(ve))}return{geojson:{type:"FeatureCollection",features:he},mcc:J||ae&&ae.selectedColorFn?{type:"identity",property:"mcc"}:W.color,mrc:Q||ae&&ae.selectedSizeFn?{type:"identity",property:"mrc"}:(ke=W.size,ke/2),mo:te||ae&&ae.selectedOpacityFn?{type:"identity",property:"mo"}:ie(W.opacity)};var ke}(v);D.geojson=q.geojson,D.layout.visibility="visible",d.extendFlat(D.paint,{"circle-color":q.mcc,"circle-radius":q.mrc,"circle-opacity":q.mo})}if((L||C)&&(N.geojson=function(Z,H){for(var Y=H._fullLayout,$=Z[0].trace,z=$.marker||{},j=z.symbol,W=z.angle,ee=j!=="circle"?a(j):g,J=W!=="auto"?a(W,!0):g,Q=s.hasText($)?a($.text):g,te=[],ie=0;ie<Z.length;ie++){var ae=Z[ie];if(!h(ae.lonlat)){var he,se=$.texttemplate;if(se){var de=Array.isArray(se)?se[ie]||"":se,ue=$._module.formatLabels(ae,$,Y),ve={};o(ve,$,ae.i);var ke=$._meta||{};he=d.texttemplateString(de,ue,Y._d3locale,ve,ae,ke)}else he=Q(ie);he&&(he=he.replace(i,"").replace(c,`
`)),te.push({type:"Feature",geometry:{type:"Point",coordinates:ae.lonlat},properties:{symbol:ee(ie),angle:J(ie),text:he}})}}return{type:"FeatureCollection",features:te}}(v,y),d.extendFlat(N.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),L&&(d.extendFlat(N.layout,{"icon-size":x.marker.size/10}),"angle"in x.marker&&x.marker.angle!=="auto"&&d.extendFlat(N.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),N.layout["icon-allow-overlap"]=x.marker.allowoverlap,d.extendFlat(N.paint,{"icon-opacity":x.opacity*x.marker.opacity,"icon-color":x.marker.color})),C)){var X=(x.marker||{}).size,K=l(x.textposition,X);d.extendFlat(N.layout,{"text-size":x.textfont.size,"text-anchor":K.anchor,"text-offset":K.offset}),d.extendFlat(N.paint,{"text-color":x.textfont.color,"text-opacity":x.opacity})}return U}},{"../../components/colorscale":662,"../../components/drawing":672,"../../components/fx/helpers":686,"../../constants/numerical":763,"../../lib":787,"../../lib/geojson_utils":781,"../../lib/svg_text_utils":813,"../../plots/mapbox/convert_text_opts":894,"../scatter/make_bubble_size_func":1219,"../scatter/subtypes":1227,"fast-isnumeric":246}],1269:[function(r,O,B){var t=r("../../lib"),d=r("../scatter/subtypes"),m=r("../scatter/marker_defaults"),p=r("../scatter/line_defaults"),e=r("../scatter/text_defaults"),f=r("../scatter/fillcolor_defaults"),u=r("./attributes");O.exports=function(s,l,o,i){function c(a,g){return t.coerce(s,l,u,a,g)}if(function(a,g,h){var y=h("lon")||[],v=h("lat")||[],_=Math.min(y.length,v.length);return g._length=_,_}(0,l,c)){if(c("text"),c("texttemplate"),c("hovertext"),c("hovertemplate"),c("mode"),c("below"),d.hasLines(l)&&(p(s,l,o,i,c,{noDash:!0}),c("connectgaps")),d.hasMarkers(l)){m(s,l,o,i,c,{noLine:!0}),c("marker.allowoverlap"),c("marker.angle");var n=l.marker;n.symbol!=="circle"&&(t.isArrayOrTypedArray(n.size)&&(n.size=n.size[0]),t.isArrayOrTypedArray(n.color)&&(n.color=n.color[0]))}d.hasText(l)&&e(s,l,i,c,{noSelect:!0}),c("fill"),l.fill!=="none"&&f(s,l,o,c),t.coerceSelectionMarkerOpacity(l,c)}else l.visible=!1}},{"../../lib":787,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1267}],1270:[function(r,O,B){O.exports=function(t,d){return t.lon=d.lon,t.lat=d.lat,t}},{}],1271:[function(r,O,B){var t=r("../../plots/cartesian/axes");O.exports=function(d,m,p){var e={},f=p[m.subplot]._subplot.mockAxis,u=d.lonlat;return e.lonLabel=t.tickText(f,f.c2l(u[0]),!0).text,e.latLabel=t.tickText(f,f.c2l(u[1]),!0).text,e}},{"../../plots/cartesian/axes":838}],1272:[function(r,O,B){var t=r("../../components/fx"),d=r("../../lib"),m=r("../scatter/get_trace_color"),p=d.fillText,e=r("../../constants/numerical").BADNUM;function f(u,s,l){if(!u.hovertemplate){var o=(s.hi||u.hoverinfo).split("+"),i=o.indexOf("all")!==-1,c=o.indexOf("lon")!==-1,n=o.indexOf("lat")!==-1,a=s.lonlat,g=[];return i||c&&n?g.push("("+h(a[1])+", "+h(a[0])+")"):c?g.push(l.lon+h(a[0])):n&&g.push(l.lat+h(a[1])),(i||o.indexOf("text")!==-1)&&p(s,u,g),g.join("<br>")}function h(y){return y+"\xB0"}}O.exports={hoverPoints:function(u,s,l){var o=u.cd,i=o[0].trace,c=u.xa,n=u.ya,a=u.subplot,g=360*(s>=0?Math.floor((s+180)/360):Math.ceil((s-180)/360)),h=s-g;if(t.getClosest(o,function(C){var k=C.lonlat;if(k[0]===e)return 1/0;var L=d.modHalf(k[0],360),M=k[1],P=a.project([L,M]),D=P.x-c.c2p([h,M]),N=P.y-n.c2p([L,l]),U=Math.max(3,C.mrc||0);return Math.max(Math.sqrt(D*D+N*N)-U,1-3/U)},u),u.index!==!1){var y=o[u.index],v=y.lonlat,_=[d.modHalf(v[0],360)+g,v[1]],x=c.c2p(_),T=n.c2p(_),A=y.mrc||1;u.x0=x-A,u.x1=x+A,u.y0=T-A,u.y1=T+A;var S={};S[i.subplot]={_subplot:a};var w=i._module.formatLabels(y,i,S);return u.lonLabel=w.lonLabel,u.latLabel=w.latLabel,u.color=m(i,y),u.extraText=f(i,y,o[0].t.labels),u.hovertemplate=i.hovertemplate,[u]}},getExtraText:f}},{"../../components/fx":690,"../../constants/numerical":763,"../../lib":787,"../scatter/get_trace_color":1212}],1273:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("../scattergeo/calc"),plot:r("./plot"),hoverPoints:r("./hover").hoverPoints,eventData:r("./event_data"),selectPoints:r("./select"),styleOnSelect:function(t,d){d&&d[0].trace._glTrace.update(d)},moduleType:"trace",name:"scattermapbox",basePlotModule:r("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":895,"../scatter/marker_colorbar":1220,"../scattergeo/calc":1245,"./attributes":1267,"./defaults":1269,"./event_data":1270,"./format_labels":1271,"./hover":1272,"./plot":1274,"./select":1275}],1274:[function(r,O,B){var t=r("./convert"),d=r("../../plots/mapbox/constants").traceLayerPrefix,m=["fill","line","circle","symbol"];function p(f,u){this.type="scattermapbox",this.subplot=f,this.uid=u,this.sourceIds={fill:"source-"+u+"-fill",line:"source-"+u+"-line",circle:"source-"+u+"-circle",symbol:"source-"+u+"-symbol"},this.layerIds={fill:d+u+"-fill",line:d+u+"-line",circle:d+u+"-circle",symbol:d+u+"-symbol"},this.below=null}var e=p.prototype;e.addSource=function(f,u){this.subplot.map.addSource(this.sourceIds[f],{type:"geojson",data:u.geojson})},e.setSourceData=function(f,u){this.subplot.map.getSource(this.sourceIds[f]).setData(u.geojson)},e.addLayer=function(f,u,s){this.subplot.addLayer({type:f,id:this.layerIds[f],source:this.sourceIds[f],layout:u.layout,paint:u.paint},s)},e.update=function(f){var u,s,l,o=this.subplot,i=o.map,c=t(o.gd,f),n=o.belowLookup["trace-"+this.uid];if(n!==this.below){for(u=m.length-1;u>=0;u--)s=m[u],i.removeLayer(this.layerIds[s]);for(u=0;u<m.length;u++)l=c[s=m[u]],this.addLayer(s,l,n);this.below=n}for(u=0;u<m.length;u++)l=c[s=m[u]],o.setOptions(this.layerIds[s],"setLayoutProperty",l.layout),l.layout.visibility==="visible"&&(this.setSourceData(s,l),o.setOptions(this.layerIds[s],"setPaintProperty",l.paint));f[0].trace._glTrace=this},e.dispose=function(){for(var f=this.subplot.map,u=m.length-1;u>=0;u--){var s=m[u];f.removeLayer(this.layerIds[s]),f.removeSource(this.sourceIds[s])}},O.exports=function(f,u){for(var s=u[0].trace,l=new p(f,s.uid),o=t(f.gd,u),i=l.below=f.belowLookup["trace-"+s.uid],c=0;c<m.length;c++){var n=m[c],a=o[n];l.addSource(n,a),l.addLayer(n,a,i)}return u[0].trace._glTrace=l,l}},{"../../plots/mapbox/constants":893,"./convert":1268}],1275:[function(r,O,B){var t=r("../../lib"),d=r("../scatter/subtypes"),m=r("../../constants/numerical").BADNUM;O.exports=function(p,e){var f,u=p.cd,s=p.xaxis,l=p.yaxis,o=[],i=u[0].trace;if(!d.hasMarkers(i))return[];if(e===!1)for(f=0;f<u.length;f++)u[f].selected=0;else for(f=0;f<u.length;f++){var c=u[f],n=c.lonlat;if(n[0]!==m){var a=[t.modHalf(n[0],360),n[1]],g=[s.c2p(a),l.c2p(a)];e.contains(g,null,f,p)?(o.push({pointNumber:f,lon:n[0],lat:n[1]}),c.selected=1):c.selected=0}}return o}},{"../../constants/numerical":763,"../../lib":787,"../scatter/subtypes":1227}],1276:[function(r,O,B){var t=r("../../plots/template_attributes").hovertemplateAttrs,d=r("../../plots/template_attributes").texttemplateAttrs,m=r("../../lib/extend").extendFlat,p=r("../scatter/attributes"),e=r("../../plots/attributes"),f=p.line;O.exports={mode:p.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:p.text,texttemplate:d({editType:"plot"},{keys:["r","theta","text"]}),hovertext:p.hovertext,line:{color:f.color,width:f.width,dash:f.dash,shape:m({},f.shape,{values:["linear","spline"]}),smoothing:f.smoothing,editType:"calc"},connectgaps:p.connectgaps,marker:p.marker,cliponaxis:m({},p.cliponaxis,{dflt:!1}),textposition:p.textposition,textfont:p.textfont,fill:m({},p.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:p.fillcolor,hoverinfo:m({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:p.hoveron,hovertemplate:t(),selected:p.selected,unselected:p.unselected}},{"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1277:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../../constants/numerical").BADNUM,m=r("../../plots/cartesian/axes"),p=r("../scatter/colorscale_calc"),e=r("../scatter/arrays_to_calcdata"),f=r("../scatter/calc_selection"),u=r("../scatter/calc").calcMarkerSize;O.exports=function(s,l){for(var o=s._fullLayout,i=l.subplot,c=o[i].radialaxis,n=o[i].angularaxis,a=c.makeCalcdata(l,"r"),g=n.makeCalcdata(l,"theta"),h=l._length,y=new Array(h),v=0;v<h;v++){var _=a[v],x=g[v],T=y[v]={};t(_)&&t(x)?(T.r=_,T.theta=x):T.r=d}var A=u(l,h);return l._extremes.x=m.findExtremes(c,a,{ppad:A}),p(s,l),e(y,l),f(y,l),y}},{"../../constants/numerical":763,"../../plots/cartesian/axes":838,"../scatter/arrays_to_calcdata":1201,"../scatter/calc":1203,"../scatter/calc_selection":1204,"../scatter/colorscale_calc":1205,"fast-isnumeric":246}],1278:[function(r,O,B){var t=r("../../lib"),d=r("../scatter/subtypes"),m=r("../scatter/marker_defaults"),p=r("../scatter/line_defaults"),e=r("../scatter/line_shape_defaults"),f=r("../scatter/text_defaults"),u=r("../scatter/fillcolor_defaults"),s=r("../scatter/constants").PTS_LINESONLY,l=r("./attributes");function o(i,c,n,a){var g,h=a("r"),y=a("theta");if(h)y?g=Math.min(h.length,y.length):(g=h.length,a("theta0"),a("dtheta"));else{if(!y)return 0;g=c.theta.length,a("r0"),a("dr")}return c._length=g,g}O.exports={handleRThetaDefaults:o,supplyDefaults:function(i,c,n,a){function g(v,_){return t.coerce(i,c,l,v,_)}var h=o(i,c,a,g);if(h){g("thetaunit"),g("mode",h<s?"lines+markers":"lines"),g("text"),g("hovertext"),c.hoveron!=="fills"&&g("hovertemplate"),d.hasLines(c)&&(p(i,c,n,a,g),e(i,c,g),g("connectgaps")),d.hasMarkers(c)&&m(i,c,n,a,g,{gradient:!0}),d.hasText(c)&&(g("texttemplate"),f(i,c,a,g));var y=[];(d.hasMarkers(c)||d.hasText(c))&&(g("cliponaxis"),g("marker.maxdisplayed"),y.push("points")),g("fill"),c.fill!=="none"&&(u(i,c,n,g),d.hasLines(c)||e(i,c,g)),c.fill!=="tonext"&&c.fill!=="toself"||y.push("fills"),g("hoveron",y.join("+")||"points"),t.coerceSelectionMarkerOpacity(c,g)}else c.visible=!1}}},{"../../lib":787,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/line_shape_defaults":1217,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1276}],1279:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes");O.exports=function(m,p,e){var f,u,s={},l=e[p.subplot]._subplot;l?(f=l.radialAxis,u=l.angularAxis):(f=(l=e[p.subplot]).radialaxis,u=l.angularaxis);var o=f.c2l(m.r);s.rLabel=d.tickText(f,o,!0).text;var i=u.thetaunit==="degrees"?t.rad2deg(m.theta):m.theta;return s.thetaLabel=d.tickText(u,i,!0).text,s}},{"../../lib":787,"../../plots/cartesian/axes":838}],1280:[function(r,O,B){var t=r("../scatter/hover");function d(m,p,e,f){var u=e.radialAxis,s=e.angularAxis;u._hovertitle="r",s._hovertitle="\u03B8";var l={};l[p.subplot]={_subplot:e};var o=p._module.formatLabels(m,p,l);f.rLabel=o.rLabel,f.thetaLabel=o.thetaLabel;var i=m.hi||p.hoverinfo,c=[];function n(g,h){c.push(g._hovertitle+": "+h)}if(!p.hovertemplate){var a=i.split("+");a.indexOf("all")!==-1&&(a=["r","theta","text"]),a.indexOf("r")!==-1&&n(u,f.rLabel),a.indexOf("theta")!==-1&&n(s,f.thetaLabel),a.indexOf("text")!==-1&&f.text&&(c.push(f.text),delete f.text),f.extraText=c.join("<br>")}}O.exports={hoverPoints:function(m,p,e,f){var u=t(m,p,e,f);if(u&&u[0].index!==!1){var s=u[0];if(s.index===void 0)return u;var l=m.subplot,o=s.cd[s.index],i=s.trace;if(l.isPtInside(o))return s.xLabelVal=void 0,s.yLabelVal=void 0,d(o,i,l,s),s.hovertemplate=i.hovertemplate,u}},makeHoverPointText:d}},{"../scatter/hover":1213}],1281:[function(r,O,B){O.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:r("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:r("./attributes"),supplyDefaults:r("./defaults").supplyDefaults,colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),plot:r("./plot"),style:r("../scatter/style").style,styleOnSelect:r("../scatter/style").styleOnSelect,hoverPoints:r("./hover").hoverPoints,selectPoints:r("../scatter/select"),meta:{}}},{"../../plots/polar":904,"../scatter/marker_colorbar":1220,"../scatter/select":1224,"../scatter/style":1226,"./attributes":1276,"./calc":1277,"./defaults":1278,"./format_labels":1279,"./hover":1280,"./plot":1282}],1282:[function(r,O,B){var t=r("../scatter/plot"),d=r("../../constants/numerical").BADNUM;O.exports=function(m,p,e){for(var f=p.layers.frontplot.select("g.scatterlayer"),u={xaxis:p.xaxis,yaxis:p.yaxis,plot:p.framework,layerClipId:p._hasClipOnAxisFalse?p.clipIds.forTraces:null},s=p.radialAxis,l=p.angularAxis,o=0;o<e.length;o++)for(var i=e[o],c=0;c<i.length;c++){var n=i[c],a=n.r;if(a===d)n.x=n.y=d;else{var g=s.c2g(a),h=l.c2g(n.theta);n.x=g*Math.cos(h),n.y=g*Math.sin(h)}}t(m,u,e,f)}},{"../../constants/numerical":763,"../scatter/plot":1223}],1283:[function(r,O,B){var t=r("../scatterpolar/attributes"),d=r("../scattergl/attributes"),m=r("../../plots/template_attributes").texttemplateAttrs;O.exports={mode:t.mode,r:t.r,theta:t.theta,r0:t.r0,dr:t.dr,theta0:t.theta0,dtheta:t.dtheta,thetaunit:t.thetaunit,text:t.text,texttemplate:m({editType:"plot"},{keys:["r","theta","text"]}),hovertext:t.hovertext,hovertemplate:t.hovertemplate,line:d.line,connectgaps:d.connectgaps,marker:d.marker,fill:d.fill,fillcolor:d.fillcolor,textposition:d.textposition,textfont:d.textfont,hoverinfo:t.hoverinfo,selected:t.selected,unselected:t.unselected}},{"../../plots/template_attributes":910,"../scattergl/attributes":1254,"../scatterpolar/attributes":1276}],1284:[function(r,O,B){var t=r("../scatter/colorscale_calc"),d=r("../scatter/calc").calcMarkerSize,m=r("../scattergl/convert"),p=r("../../plots/cartesian/axes"),e=r("../scattergl/constants").TOO_MANY_POINTS;O.exports=function(f,u){var s=f._fullLayout,l=u.subplot,o=s[l].radialaxis,i=s[l].angularaxis,c=u._r=o.makeCalcdata(u,"r"),n=u._theta=i.makeCalcdata(u,"theta"),a=u._length,g={};a<c.length&&(c=c.slice(0,a)),a<n.length&&(n=n.slice(0,a)),g.r=c,g.theta=n,t(f,u);var h,y=g.opts=m.style(f,u);return a<e?h=d(u,a):y.marker&&(h=2*(y.marker.sizeAvg||Math.max(y.marker.size,3))),u._extremes.x=p.findExtremes(o,c,{ppad:h}),[{x:!1,y:!1,t:g,trace:u}]}},{"../../plots/cartesian/axes":838,"../scatter/calc":1203,"../scatter/colorscale_calc":1205,"../scattergl/constants":1256,"../scattergl/convert":1257}],1285:[function(r,O,B){var t=r("../../lib"),d=r("../scatter/subtypes"),m=r("../scatterpolar/defaults").handleRThetaDefaults,p=r("../scatter/marker_defaults"),e=r("../scatter/line_defaults"),f=r("../scatter/text_defaults"),u=r("../scatter/fillcolor_defaults"),s=r("../scatter/constants").PTS_LINESONLY,l=r("./attributes");O.exports=function(o,i,c,n){function a(h,y){return t.coerce(o,i,l,h,y)}var g=m(o,i,n,a);g?(a("thetaunit"),a("mode",g<s?"lines+markers":"lines"),a("text"),a("hovertext"),i.hoveron!=="fills"&&a("hovertemplate"),d.hasLines(i)&&(e(o,i,c,n,a),a("connectgaps")),d.hasMarkers(i)&&p(o,i,c,n,a),d.hasText(i)&&(a("texttemplate"),f(o,i,n,a)),a("fill"),i.fill!=="none"&&u(o,i,c,a),t.coerceSelectionMarkerOpacity(i,a)):i.visible=!1}},{"../../lib":787,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"../scatterpolar/defaults":1278,"./attributes":1283}],1286:[function(r,O,B){var t=r("../scatterpolar/format_labels");O.exports=function(d,m,p){var e=d.i;return"r"in d||(d.r=m._r[e]),"theta"in d||(d.theta=m._theta[e]),t(d,m,p)}},{"../scatterpolar/format_labels":1279}],1287:[function(r,O,B){var t=r("../scattergl/hover"),d=r("../scatterpolar/hover").makeHoverPointText;O.exports={hoverPoints:function(m,p,e,f){var u=m.cd[0].t,s=u.r,l=u.theta,o=t.hoverPoints(m,p,e,f);if(o&&o[0].index!==!1){var i=o[0];if(i.index===void 0)return o;var c=m.subplot,n=i.cd[i.index],a=i.trace;if(n.r=s[i.index],n.theta=l[i.index],c.isPtInside(n))return i.xLabelVal=void 0,i.yLabelVal=void 0,d(n,a,c,i),o}}}},{"../scattergl/hover":1262,"../scatterpolar/hover":1280}],1288:[function(r,O,B){O.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:r("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),plot:r("./plot"),hoverPoints:r("./hover").hoverPoints,selectPoints:r("../scattergl/select"),meta:{}}},{"../../plots/polar":904,"../scatter/marker_colorbar":1220,"../scattergl/select":1266,"./attributes":1283,"./calc":1284,"./defaults":1285,"./format_labels":1286,"./hover":1287,"./plot":1289}],1289:[function(r,O,B){var t=r("@plotly/point-cluster"),d=r("fast-isnumeric"),m=r("../scattergl/plot"),p=r("../scattergl/scene_update"),e=r("../scattergl/convert"),f=r("../../lib"),u=r("../scattergl/constants").TOO_MANY_POINTS;O.exports=function(s,l,o){if(o.length){var i=l.radialAxis,c=l.angularAxis,n=p(s,l);return o.forEach(function(a){if(a&&a[0]&&a[0].trace){var g,h=a[0],y=h.trace,v=h.t,_=y._length,x=v.r,T=v.theta,A=v.opts,S=x.slice(),w=T.slice();for(g=0;g<x.length;g++)l.isPtInside({r:x[g],theta:T[g]})||(S[g]=NaN,w[g]=NaN);var C=new Array(2*_),k=Array(_),L=Array(_);for(g=0;g<_;g++){var M,P,D=S[g];if(d(D)){var N=i.c2g(D),U=c.c2g(w[g],y.thetaunit);M=N*Math.cos(U),P=N*Math.sin(U)}else M=P=NaN;k[g]=C[2*g]=M,L[g]=C[2*g+1]=P}v.tree=t(C),A.marker&&_>=u&&(A.marker.cluster=v.tree),A.marker&&(A.markerSel.positions=A.markerUnsel.positions=A.marker.positions=C),A.line&&C.length>1&&f.extendFlat(A.line,e.linePositions(s,y,C)),A.text&&(f.extendFlat(A.text,{positions:C},e.textPosition(s,y,A.text,A.marker)),f.extendFlat(A.textSel,{positions:C},e.textPosition(s,y,A.text,A.markerSel)),f.extendFlat(A.textUnsel,{positions:C},e.textPosition(s,y,A.text,A.markerUnsel))),A.fill&&!n.fill2d&&(n.fill2d=!0),A.marker&&!n.scatter2d&&(n.scatter2d=!0),A.line&&!n.line2d&&(n.line2d=!0),A.text&&!n.glText&&(n.glText=!0),n.lineOptions.push(A.line),n.fillOptions.push(A.fill),n.markerOptions.push(A.marker),n.markerSelectedOptions.push(A.markerSel),n.markerUnselectedOptions.push(A.markerUnsel),n.textOptions.push(A.text),n.textSelectedOptions.push(A.textSel),n.textUnselectedOptions.push(A.textUnsel),n.selectBatch.push([]),n.unselectBatch.push([]),v.x=k,v.y=L,v.rawx=k,v.rawy=L,v.r=x,v.theta=T,v.positions=C,v._scene=n,v.index=n.count,n.count++}}),m(s,l,o)}}},{"../../lib":787,"../scattergl/constants":1256,"../scattergl/convert":1257,"../scattergl/plot":1264,"../scattergl/scene_update":1265,"@plotly/point-cluster":59,"fast-isnumeric":246}],1290:[function(r,O,B){var t=r("../../plots/template_attributes").hovertemplateAttrs,d=r("../../plots/template_attributes").texttemplateAttrs,m=r("../scatter/attributes"),p=r("../../plots/attributes"),e=r("../../components/colorscale/attributes"),f=r("../../components/drawing/attributes").dash,u=r("../../lib/extend").extendFlat,s=m.marker,l=m.line,o=s.line;O.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:u({},m.mode,{dflt:"markers"}),text:u({},m.text,{}),texttemplate:d({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:u({},m.hovertext,{}),line:{color:l.color,width:l.width,dash:f,shape:u({},l.shape,{values:["linear","spline"]}),smoothing:l.smoothing,editType:"calc"},connectgaps:m.connectgaps,cliponaxis:m.cliponaxis,fill:u({},m.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:m.fillcolor,marker:u({symbol:s.symbol,opacity:s.opacity,maxdisplayed:s.maxdisplayed,size:s.size,sizeref:s.sizeref,sizemin:s.sizemin,sizemode:s.sizemode,line:u({width:o.width,editType:"calc"},e("marker.line")),gradient:s.gradient,editType:"calc"},e("marker")),textfont:m.textfont,textposition:m.textposition,selected:m.selected,unselected:m.unselected,hoverinfo:u({},p.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:m.hoveron,hovertemplate:t()}},{"../../components/colorscale/attributes":657,"../../components/drawing/attributes":671,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1291:[function(r,O,B){var t=r("fast-isnumeric"),d=r("../scatter/colorscale_calc"),m=r("../scatter/arrays_to_calcdata"),p=r("../scatter/calc_selection"),e=r("../scatter/calc").calcMarkerSize,f=["a","b","c"],u={a:["b","c"],b:["a","c"],c:["a","b"]};O.exports=function(s,l){var o,i,c,n,a,g,h=s._fullLayout[l.subplot].sum,y=l.sum||h,v={a:l.a,b:l.b,c:l.c};for(o=0;o<f.length;o++)if(!v[c=f[o]]){for(a=v[u[c][0]],g=v[u[c][1]],n=new Array(a.length),i=0;i<a.length;i++)n[i]=y-a[i]-g[i];v[c]=n}var _,x,T,A,S,w,C=l._length,k=new Array(C);for(o=0;o<C;o++)_=v.a[o],x=v.b[o],T=v.c[o],t(_)&&t(x)&&t(T)?((A=h/((_=+_)+(x=+x)+(T=+T)))!=1&&(_*=A,x*=A,T*=A),w=_,S=T-x,k[o]={x:S,y:w,a:_,b:x,c:T}):k[o]={x:!1,y:!1};return e(l,C),d(s,l),m(k,l),p(k,l),k}},{"../scatter/arrays_to_calcdata":1201,"../scatter/calc":1203,"../scatter/calc_selection":1204,"../scatter/colorscale_calc":1205,"fast-isnumeric":246}],1292:[function(r,O,B){var t=r("../../lib"),d=r("../scatter/constants"),m=r("../scatter/subtypes"),p=r("../scatter/marker_defaults"),e=r("../scatter/line_defaults"),f=r("../scatter/line_shape_defaults"),u=r("../scatter/text_defaults"),s=r("../scatter/fillcolor_defaults"),l=r("./attributes");O.exports=function(o,i,c,n){function a(x,T){return t.coerce(o,i,l,x,T)}var g,h=a("a"),y=a("b"),v=a("c");if(h?(g=h.length,y?(g=Math.min(g,y.length),v&&(g=Math.min(g,v.length))):g=v?Math.min(g,v.length):0):y&&v&&(g=Math.min(y.length,v.length)),g){i._length=g,a("sum"),a("text"),a("hovertext"),i.hoveron!=="fills"&&a("hovertemplate"),a("mode",g<d.PTS_LINESONLY?"lines+markers":"lines"),m.hasLines(i)&&(e(o,i,c,n,a),f(o,i,a),a("connectgaps")),m.hasMarkers(i)&&p(o,i,c,n,a,{gradient:!0}),m.hasText(i)&&(a("texttemplate"),u(o,i,n,a));var _=[];(m.hasMarkers(i)||m.hasText(i))&&(a("cliponaxis"),a("marker.maxdisplayed"),_.push("points")),a("fill"),i.fill!=="none"&&(s(o,i,c,a),m.hasLines(i)||f(o,i,a)),i.fill!=="tonext"&&i.fill!=="toself"||_.push("fills"),a("hoveron",_.join("+")||"points"),t.coerceSelectionMarkerOpacity(i,a)}else i.visible=!1}},{"../../lib":787,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/line_shape_defaults":1217,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1290}],1293:[function(r,O,B){O.exports=function(t,d,m,p,e){if(d.xa&&(t.xaxis=d.xa),d.ya&&(t.yaxis=d.ya),p[e]){var f=p[e];t.a=f.a,t.b=f.b,t.c=f.c}else t.a=d.a,t.b=d.b,t.c=d.c;return t}},{}],1294:[function(r,O,B){var t=r("../../plots/cartesian/axes");O.exports=function(d,m,p){var e={},f=p[m.subplot]._subplot;return e.aLabel=t.tickText(f.aaxis,d.a,!0).text,e.bLabel=t.tickText(f.baxis,d.b,!0).text,e.cLabel=t.tickText(f.caxis,d.c,!0).text,e}},{"../../plots/cartesian/axes":838}],1295:[function(r,O,B){var t=r("../scatter/hover");O.exports=function(d,m,p,e){var f=t(d,m,p,e);if(f&&f[0].index!==!1){var u=f[0];if(u.index===void 0){var s=1-u.y0/d.ya._length,l=d.xa._length,o=l*s/2,i=l-o;return u.x0=Math.max(Math.min(u.x0,i),o),u.x1=Math.max(Math.min(u.x1,i),o),f}var c=u.cd[u.index],n=u.trace,a=u.subplot;u.a=c.a,u.b=c.b,u.c=c.c,u.xLabelVal=void 0,u.yLabelVal=void 0;var g={};g[n.subplot]={_subplot:a};var h=n._module.formatLabels(c,n,g);u.aLabel=h.aLabel,u.bLabel=h.bLabel,u.cLabel=h.cLabel;var y=c.hi||n.hoverinfo,v=[];if(!n.hovertemplate){var _=y.split("+");_.indexOf("all")!==-1&&(_=["a","b","c"]),_.indexOf("a")!==-1&&x(a.aaxis,u.aLabel),_.indexOf("b")!==-1&&x(a.baxis,u.bLabel),_.indexOf("c")!==-1&&x(a.caxis,u.cLabel)}return u.extraText=v.join("<br>"),u.hovertemplate=n.hovertemplate,f}function x(T,A){v.push(T._hovertitle+": "+A)}}},{"../scatter/hover":1213}],1296:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),plot:r("./plot"),style:r("../scatter/style").style,styleOnSelect:r("../scatter/style").styleOnSelect,hoverPoints:r("./hover"),selectPoints:r("../scatter/select"),eventData:r("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:r("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":911,"../scatter/marker_colorbar":1220,"../scatter/select":1224,"../scatter/style":1226,"./attributes":1290,"./calc":1291,"./defaults":1292,"./event_data":1293,"./format_labels":1294,"./hover":1295,"./plot":1297}],1297:[function(r,O,B){var t=r("../scatter/plot");O.exports=function(d,m,p){var e=m.plotContainer;e.select(".scatterlayer").selectAll("*").remove();var f={xaxis:m.xaxis,yaxis:m.yaxis,plot:e,layerClipId:m._hasClipOnAxisFalse?m.clipIdRelative:null},u=m.layers.frontplot.select("g.scatterlayer");t(d,f,p,u)}},{"../scatter/plot":1223}],1298:[function(r,O,B){var t=r("../scatter/attributes"),d=r("../../components/colorscale/attributes"),m=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=r("../../plots/template_attributes").hovertemplateAttrs,e=r("../scattergl/attributes"),f=r("../../plots/cartesian/constants").idRegex,u=r("../../plot_api/plot_template").templatedArray,s=r("../../lib/extend").extendFlat,l=t.marker,o=l.line,i=s(d("marker.line",{editTypeOverride:"calc"}),{width:s({},o.width,{editType:"calc"}),editType:"calc"}),c=s(d("marker"),{symbol:l.symbol,size:s({},l.size,{editType:"markerSize"}),sizeref:l.sizeref,sizemin:l.sizemin,sizemode:l.sizemode,opacity:l.opacity,colorbar:l.colorbar,line:i,editType:"calc"});function n(a){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:f[a],editType:"plot"}}}c.color.editType=c.cmin.editType=c.cmax.editType="style",O.exports={dimensions:u("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:s({},e.text,{}),hovertext:s({},e.hovertext,{}),hovertemplate:p(),xhoverformat:m("x"),yhoverformat:m("y"),marker:c,xaxes:n("x"),yaxes:n("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:e.selected.marker,editType:"calc"},unselected:{marker:e.unselected.marker,editType:"calc"},opacity:e.opacity}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/plot_template":827,"../../plots/cartesian/axis_format_attributes":841,"../../plots/cartesian/constants":845,"../../plots/template_attributes":910,"../scatter/attributes":1202,"../scattergl/attributes":1254}],1299:[function(r,O,B){var t=r("regl-line2d"),d=r("../../registry"),m=r("../../lib/prepare_regl"),p=r("../../plots/get_data").getModuleCalcData,e=r("../../plots/cartesian"),f=r("../../plots/cartesian/axis_ids").getFromId,u=r("../../plots/cartesian/axes").shouldShowZeroLine;function s(o,i,c){for(var n=c.matrixOptions.data.length,a=i._visibleDims,g=c.viewOpts.ranges=new Array(n),h=0;h<a.length;h++){var y=a[h],v=g[h]=new Array(4),_=f(o,i._diag[y][0]);_&&(v[0]=_.r2l(_.range[0]),v[2]=_.r2l(_.range[1]));var x=f(o,i._diag[y][1]);x&&(v[1]=x.r2l(x.range[0]),v[3]=x.r2l(x.range[1]))}c.selectBatch.length||c.unselectBatch.length?c.matrix.update({ranges:g},{ranges:g}):c.matrix.update({ranges:g})}function l(o){var i=o._fullLayout,c=i._glcanvas.data()[0].regl,n=i._splomGrid;n||(n=i._splomGrid=t(c)),n.update(function(a){var g,h=a._context.plotGlPixelRatio,y=a._fullLayout,v=y._size,_=[0,0,y.width*h,y.height*h],x={};function T(Z,H,Y,$,z,j){Y*=h,$*=h,z*=h,j*=h;var W=H[Z+"color"],ee=H[Z+"width"],J=String(W+ee);J in x?x[J].data.push(NaN,NaN,Y,$,z,j):x[J]={data:[Y,$,z,j],join:"rect",thickness:ee*h,color:W,viewport:_,range:_,overlay:!1}}for(g in y._splomSubplots){var A,S,w=y._plots[g],C=w.xaxis,k=w.yaxis,L=C._gridVals,M=k._gridVals,P=C._offset,D=C._length,N=k._length,U=v.b+k.domain[0]*v.h,q=-k._m,X=-q*k.r2l(k.range[0],k.calendar);if(C.showgrid)for(g=0;g<L.length;g++)A=P+C.l2p(L[g].x),T("grid",C,A,U,A,U+N);if(k.showgrid)for(g=0;g<M.length;g++)S=U+X+q*M[g].x,T("grid",k,P,S,P+D,S);u(a,C,k)&&(A=P+C.l2p(0),T("zeroline",C,A,U,A,U+N)),u(a,k,C)&&T("zeroline",k,P,S=U+X+0,P+D,S)}var K=[];for(g in x)K.push(x[g]);return K}(o))}O.exports={name:"splom",attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:function(o){var i=o._fullLayout,c=d.getModule("splom"),n=p(o.calcdata,c)[0];m(o,["ANGLE_instanced_arrays","OES_element_index_uint"])&&(i._hasOnlyLargeSploms&&l(o),c.plot(o,{},n))},drag:function(o){var i=o.calcdata,c=o._fullLayout;c._hasOnlyLargeSploms&&l(o);for(var n=0;n<i.length;n++){var a=i[n][0].trace,g=c._splomScenes[a.uid];a.type==="splom"&&g&&g.matrix&&s(o,a,g)}},updateGrid:l,clean:function(o,i,c,n){var a,g={};if(n._splomScenes){for(a=0;a<o.length;a++){var h=o[a];h.type==="splom"&&(g[h.uid]=1)}for(a=0;a<c.length;a++){var y=c[a];if(!g[y.uid]){var v=n._splomScenes[y.uid];v&&v.destroy&&v.destroy(),n._splomScenes[y.uid]=null,delete n._splomScenes[y.uid]}}}Object.keys(n._splomScenes||{}).length===0&&delete n._splomScenes,n._splomGrid&&!i._hasOnlyLargeSploms&&n._hasOnlyLargeSploms&&(n._splomGrid.destroy(),n._splomGrid=null,delete n._splomGrid),e.clean(o,i,c,n)},updateFx:e.updateFx,toSVG:e.toSVG}},{"../../lib/prepare_regl":800,"../../plots/cartesian":852,"../../plots/cartesian/axes":838,"../../plots/cartesian/axis_ids":842,"../../plots/get_data":875,"../../registry":915,"regl-line2d":523}],1300:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/cartesian/axis_ids"),m=r("../scatter/calc").calcMarkerSize,p=r("../scatter/calc").calcAxisExpansion,e=r("../scatter/colorscale_calc"),f=r("../scattergl/convert").markerSelection,u=r("../scattergl/convert").markerStyle,s=r("./scene_update"),l=r("../../constants/numerical").BADNUM,o=r("../scattergl/constants").TOO_MANY_POINTS;O.exports=function(i,c){var n,a,g,h,y,v,_=c.dimensions,x=c._length,T={},A=T.cdata=[],S=T.data=[],w=c._visibleDims=[];function C(L,M){for(var P=L.makeCalcdata({v:M.values,vcalendar:c.calendar},"v"),D=0;D<P.length;D++)P[D]=P[D]===l?NaN:P[D];A.push(P),S.push(L.type==="log"?t.simpleMap(P,L.c2l):P)}for(n=0;n<_.length;n++)if((g=_[n]).visible){if(h=d.getFromId(i,c._diag[n][0]),y=d.getFromId(i,c._diag[n][1]),h&&y&&h.type!==y.type){t.log("Skipping splom dimension "+n+" with conflicting axis types");continue}h?(C(h,g),y&&y.type==="category"&&(y._categories=h._categories.slice())):C(y,g),w.push(n)}for(e(i,c),t.extendFlat(T,u(c)),v=A.length*x>o?T.sizeAvg||Math.max(T.size,3):m(c,x),a=0;a<w.length;a++)g=_[n=w[a]],h=d.getFromId(i,c._diag[n][0])||{},y=d.getFromId(i,c._diag[n][1])||{},p(i,c,h,y,A[a],A[a],v);var k=s(i,c);return k.matrix||(k.matrix=!0),k.matrixOptions=T,k.selectedOptions=f(c,c.selected),k.unselectedOptions=f(c,c.unselected),[{x:!1,y:!1,t:{},trace:c}]}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/axis_ids":842,"../scatter/calc":1203,"../scatter/colorscale_calc":1205,"../scattergl/constants":1256,"../scattergl/convert":1257,"./scene_update":1307}],1301:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/array_container_defaults"),m=r("./attributes"),p=r("../scatter/subtypes"),e=r("../scatter/marker_defaults"),f=r("../parcoords/merge_length"),u=r("../scattergl/helpers").isOpenSymbol;function s(l,o){function i(n,a){return t.coerce(l,o,m.dimensions,n,a)}i("label");var c=i("values");c&&c.length?i("visible"):o.visible=!1,i("axis.type"),i("axis.matches")}O.exports=function(l,o,i,c){function n(x,T){return t.coerce(l,o,m,x,T)}var a=d(l,o,{name:"dimensions",handleItemDefaults:s}),g=n("diagonal.visible"),h=n("showupperhalf"),y=n("showlowerhalf");if(f(o,a,"values")&&(g||h||y)){n("text"),n("hovertext"),n("hovertemplate"),n("xhoverformat"),n("yhoverformat"),e(l,o,i,c,n);var v=u(o.marker.symbol),_=p.isBubble(o);n("marker.line.width",v||_?1:0),function(x,T,A,S){var w,C,k=T.dimensions,L=k.length,M=T.showupperhalf,P=T.showlowerhalf,D=T.diagonal.visible,N=new Array(L),U=new Array(L);for(w=0;w<L;w++){var q=w?w+1:"";N[w]="x"+q,U[w]="y"+q}var X=S("xaxes",N),K=S("yaxes",U),Z=T._diag=new Array(L);T._xaxes={},T._yaxes={};var H=[],Y=[];function $(ae,he,se,de){if(ae){var ue=ae.charAt(0),ve=A._splomAxes[ue];if(T["_"+ue+"axes"][ae]=1,de.push(ae),!(ae in ve)){var ke=ve[ae]={};se&&(ke.label=se.label||"",se.visible&&se.axis&&(se.axis.type&&(ke.type=se.axis.type),se.axis.matches&&(ke.matches=he)))}}}var z=!D&&!P,j=!D&&!M;for(T._axesDim={},w=0;w<L;w++){var W=k[w],ee=w===0,J=w===L-1,Q=ee&&z||J&&j?void 0:X[w],te=ee&&j||J&&z?void 0:K[w];$(Q,te,W,H),$(te,Q,W,Y),Z[w]=[Q,te],T._axesDim[Q]=w,T._axesDim[te]=w}for(w=0;w<H.length;w++)for(C=0;C<Y.length;C++){var ie=H[w]+Y[C];w>C&&M||w<C&&P?A._splomSubplots[ie]=1:w!==C||!D&&P&&M||(A._splomSubplots[ie]=1)}(!P||!D&&M&&P)&&(A._splomGridDflt.xside="bottom",A._splomGridDflt.yside="left")}(0,o,c,n),t.coerceSelectionMarkerOpacity(o,n)}else o.visible=!1}},{"../../lib":787,"../../plots/array_container_defaults":833,"../parcoords/merge_length":1173,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scattergl/helpers":1261,"./attributes":1298}],1302:[function(r,O,B){var t=r("../../lib"),d=r("../scatter/colorscale_calc"),m=r("../scattergl/convert").markerStyle;O.exports=function(p,e){var f=e.trace,u=p._fullLayout._splomScenes[f.uid];if(u){d(p,f),t.extendFlat(u.matrixOptions,m(f));var s=t.extendFlat({},u.matrixOptions,u.viewOpts);u.matrix.update(s,null)}}},{"../../lib":787,"../scatter/colorscale_calc":1205,"../scattergl/convert":1257}],1303:[function(r,O,B){B.getDimIndex=function(t,d){for(var m=d._id,p={x:0,y:1}[m.charAt(0)],e=t._visibleDims,f=0;f<e.length;f++){var u=e[f];if(t._diag[u][p]===m)return f}return!1}},{}],1304:[function(r,O,B){var t=r("./helpers"),d=r("../scattergl/hover").calcHover;O.exports={hoverPoints:function(m,p,e){var f=m.cd[0].trace,u=m.scene.matrixOptions.cdata,s=m.xa,l=m.ya,o=s.c2p(p),i=l.c2p(e),c=m.distance,n=t.getDimIndex(f,s),a=t.getDimIndex(f,l);if(n===!1||a===!1)return[m];for(var g,h,y=u[n],v=u[a],_=c,x=0;x<y.length;x++){var T=y[x],A=v[x],S=s.c2p(T)-o,w=l.c2p(A)-i,C=Math.sqrt(S*S+w*w);C<_&&(_=h=C,g=x)}return m.index=g,m.distance=_,m.dxy=h,g===void 0?[m]:[d(m,y,v,f)]}}},{"../scattergl/hover":1262,"./helpers":1303}],1305:[function(r,O,B){var t=r("../../registry"),d=r("../../components/grid");O.exports={moduleType:"trace",name:"splom",basePlotModule:r("./base_plot"),categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),calc:r("./calc"),plot:r("./plot"),hoverPoints:r("./hover").hoverPoints,selectPoints:r("./select"),editStyle:r("./edit_style"),meta:{}},t.register(d)},{"../../components/grid":694,"../../registry":915,"../scatter/marker_colorbar":1220,"./attributes":1298,"./base_plot":1299,"./calc":1300,"./defaults":1301,"./edit_style":1302,"./hover":1304,"./plot":1306,"./select":1308}],1306:[function(r,O,B){var t=r("regl-splom"),d=r("../../lib"),m=r("../../plots/cartesian/axis_ids"),p=r("../../components/dragelement/helpers").selectMode;function e(f,u){var s,l,o,i,c,n=f._fullLayout,a=n._size,g=u.trace,h=u.t,y=n._splomScenes[g.uid],v=y.matrixOptions,_=v.cdata,x=n._glcanvas.data()[0].regl,T=n.dragmode;if(_.length!==0){v.lower=g.showupperhalf,v.upper=g.showlowerhalf,v.diagonal=g.diagonal.visible;var A=g._visibleDims,S=_.length,w=y.viewOpts={};for(w.ranges=new Array(S),w.domains=new Array(S),c=0;c<A.length;c++){o=A[c];var C=w.ranges[c]=new Array(4),k=w.domains[c]=new Array(4);(s=m.getFromId(f,g._diag[o][0]))&&(C[0]=s._rl[0],C[2]=s._rl[1],k[0]=s.domain[0],k[2]=s.domain[1]),(l=m.getFromId(f,g._diag[o][1]))&&(C[1]=l._rl[0],C[3]=l._rl[1],k[1]=l.domain[0],k[3]=l.domain[1])}var L=f._context.plotGlPixelRatio,M=a.l*L,P=a.b*L,D=a.w*L,N=a.h*L;w.viewport=[M,P,D+M,N+P],y.matrix===!0&&(y.matrix=t(x));var U=n.clickmode.indexOf("select")>-1,q=!0;if(p(T)||!!g.selectedpoints||U){var X=g._length;if(g.selectedpoints){y.selectBatch=g.selectedpoints;var K=g.selectedpoints,Z={};for(o=0;o<K.length;o++)Z[K[o]]=!0;var H=[];for(o=0;o<X;o++)Z[o]||H.push(o);y.unselectBatch=H}var Y=h.xpx=new Array(S),$=h.ypx=new Array(S);for(c=0;c<A.length;c++){if(o=A[c],s=m.getFromId(f,g._diag[o][0]))for(Y[c]=new Array(X),i=0;i<X;i++)Y[c][i]=s.c2p(_[c][i]);if(l=m.getFromId(f,g._diag[o][1]))for($[c]=new Array(X),i=0;i<X;i++)$[c][i]=l.c2p(_[c][i])}if(y.selectBatch.length||y.unselectBatch.length){var z=d.extendFlat({},v,y.unselectedOptions,w),j=d.extendFlat({},v,y.selectedOptions,w);y.matrix.update(z,j),q=!1}}else h.xpx=h.ypx=null;if(q){var W=d.extendFlat({},v,w);y.matrix.update(W,null)}}}O.exports=function(f,u,s){if(s.length)for(var l=0;l<s.length;l++)e(f,s[l][0])}},{"../../components/dragelement/helpers":668,"../../lib":787,"../../plots/cartesian/axis_ids":842,"regl-splom":525}],1307:[function(r,O,B){var t=r("../../lib");O.exports=function(d,m){var p=d._fullLayout,e=m.uid,f=p._splomScenes;f||(f=p._splomScenes={});var u={dirty:!0,selectBatch:[],unselectBatch:[]},s=f[m.uid];return s||((s=f[e]=t.extendFlat({},u,{matrix:!1,selectBatch:[],unselectBatch:[]})).draw=function(){s.matrix&&s.matrix.draw&&(s.selectBatch.length||s.unselectBatch.length?s.matrix.draw(s.unselectBatch,s.selectBatch):s.matrix.draw()),s.dirty=!1},s.destroy=function(){s.matrix&&s.matrix.destroy&&s.matrix.destroy(),s.matrixOptions=null,s.selectBatch=null,s.unselectBatch=null,s=null}),s.dirty||t.extendFlat(s,u),s}},{"../../lib":787}],1308:[function(r,O,B){var t=r("../../lib"),d=r("../scatter/subtypes"),m=r("./helpers");O.exports=function(p,e){var f=p.cd,u=f[0].trace,s=f[0].t,l=p.scene,o=l.matrixOptions.cdata,i=p.xaxis,c=p.yaxis,n=[];if(!l)return n;var a=!d.hasMarkers(u)&&!d.hasText(u);if(u.visible!==!0||a)return n;var g=m.getDimIndex(u,i),h=m.getDimIndex(u,c);if(g===!1||h===!1)return n;var y=s.xpx[g],v=s.ypx[h],_=o[g],x=o[h],T=[],A=[];if(e!==!1&&!e.degenerate)for(var S=0;S<_.length;S++)e.contains([y[S],v[S]],null,S,p)?(T.push(S),n.push({pointNumber:S,x:_[S],y:x[S]})):A.push(S);var w=l.matrixOptions;return T.length||A.length?l.selectBatch.length||l.unselectBatch.length||l.matrix.update(l.unselectedOptions,t.extendFlat({},w,l.selectedOptions,l.viewOpts)):l.matrix.update(w,null),l.selectBatch=T,l.unselectBatch=A,n}},{"../../lib":787,"../scatter/subtypes":1227,"./helpers":1303}],1309:[function(r,O,B){var t=r("../../components/colorscale/attributes"),d=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=r("../../plots/template_attributes").hovertemplateAttrs,p=r("../mesh3d/attributes"),e=r("../../plots/attributes"),f=r("../../lib/extend").extendFlat,u={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:m({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:d("u",1),vhoverformat:d("v",1),whoverformat:d("w",1),xhoverformat:d("x"),yhoverformat:d("y"),zhoverformat:d("z"),showlegend:f({},e.showlegend,{dflt:!1})};f(u,t("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(s){u[s]=p[s]}),u.hoverinfo=f({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),u.transforms=void 0,O.exports=u},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../mesh3d/attributes":1143}],1310:[function(r,O,B){var t=r("../../lib"),d=r("../../components/colorscale/calc");function m(f){var u,s,l,o,i,c,n,a,g,h,y,v,_=f._x,x=f._y,T=f._z,A=f._len,S=-1/0,w=1/0,C=-1/0,k=1/0,L=-1/0,M=1/0,P="";for(A&&(n=_[0],g=x[0],y=T[0]),A>1&&(a=_[A-1],h=x[A-1],v=T[A-1]),u=0;u<A;u++)S=Math.max(S,_[u]),w=Math.min(w,_[u]),C=Math.max(C,x[u]),k=Math.min(k,x[u]),L=Math.max(L,T[u]),M=Math.min(M,T[u]),o||_[u]===n||(o=!0,P+="x"),i||x[u]===g||(i=!0,P+="y"),c||T[u]===y||(c=!0,P+="z");o||(P+="x"),i||(P+="y"),c||(P+="z");var D=p(f._x),N=p(f._y),U=p(f._z);P=(P=(P=P.replace("x",(n>a?"-":"+")+"x")).replace("y",(g>h?"-":"+")+"y")).replace("z",(y>v?"-":"+")+"z");var q=function(){A=0,D=[],N=[],U=[]};(!A||A<D.length*N.length*U.length)&&q();var X=function(ue){return ue==="x"?_:ue==="y"?x:T},K=function(ue){return ue==="x"?D:ue==="y"?N:U},Z=function(ue){return ue[A-1]<ue[0]?-1:1},H=X(P[1]),Y=X(P[3]),$=X(P[5]),z=K(P[1]).length,j=K(P[3]).length,W=K(P[5]).length,ee=!1,J=function(ue,ve,ke){return z*(j*ue+ve)+ke},Q=Z(X(P[1])),te=Z(X(P[3])),ie=Z(X(P[5]));for(u=0;u<W-1;u++){for(s=0;s<j-1;s++){for(l=0;l<z-1;l++){var ae=J(u,s,l),he=J(u,s,l+1),se=J(u,s+1,l),de=J(u+1,s,l);if(H[ae]*Q<H[he]*Q&&Y[ae]*te<Y[se]*te&&$[ae]*ie<$[de]*ie||(ee=!0),ee)break}if(ee)break}if(ee)break}return ee&&(t.warn("Encountered arbitrary coordinates! Unable to input data grid."),q()),{xMin:w,yMin:k,zMin:M,xMax:S,yMax:C,zMax:L,Xs:D,Ys:N,Zs:U,len:A,fill:P}}function p(f){return t.distinctVals(f).vals}function e(f,u){if(u===void 0&&(u=f.length),t.isTypedArray(f))return f.subarray(0,u);for(var s=[],l=0;l<u;l++)s[l]=+f[l];return s}O.exports={calc:function(f,u){u._len=Math.min(u.u.length,u.v.length,u.w.length,u.x.length,u.y.length,u.z.length),u._u=e(u.u,u._len),u._v=e(u.v,u._len),u._w=e(u.w,u._len),u._x=e(u.x,u._len),u._y=e(u.y,u._len),u._z=e(u.z,u._len);var s=m(u);u._gridFill=s.fill,u._Xs=s.Xs,u._Ys=s.Ys,u._Zs=s.Zs,u._len=s.len;var l,o,i,c=0;u.starts&&(l=e(u.starts.x||[]),o=e(u.starts.y||[]),i=e(u.starts.z||[]),c=Math.min(l.length,o.length,i.length)),u._startsX=l||[],u._startsY=o||[],u._startsZ=i||[];var n,a=0,g=1/0;for(n=0;n<u._len;n++){var h=u._u[n],y=u._v[n],v=u._w[n],_=Math.sqrt(h*h+y*y+v*v);a=Math.max(a,_),g=Math.min(g,_)}for(d(f,u,{vals:[g,a],containerStr:"",cLetter:"c"}),n=0;n<c;n++){var x=l[n];s.xMax=Math.max(s.xMax,x),s.xMin=Math.min(s.xMin,x);var T=o[n];s.yMax=Math.max(s.yMax,T),s.yMin=Math.min(s.yMin,T);var A=i[n];s.zMax=Math.max(s.zMax,A),s.zMin=Math.min(s.zMin,A)}u._slen=c,u._normMax=a,u._xbnds=[s.xMin,s.xMax],u._ybnds=[s.yMin,s.yMax],u._zbnds=[s.zMin,s.zMax]},filter:e,processGrid:m}},{"../../components/colorscale/calc":658,"../../lib":787}],1311:[function(r,O,B){var t=r("gl-streamtube3d"),d=t.createTubeMesh,m=r("../../lib"),p=r("../../lib/gl_format_color").parseColorScale,e=r("../../components/colorscale").extractOpts,f=r("../../plots/gl3d/zip3"),u={xaxis:0,yaxis:1,zaxis:2};function s(n,a){this.scene=n,this.uid=a,this.mesh=null,this.data=null}var l=s.prototype;function o(n){var a=n.length;return a>2?n.slice(1,a-1):a===2?[(n[0]+n[1])/2]:n}function i(n){var a=n.length;return a===1?[.5,.5]:[n[1]-n[0],n[a-1]-n[a-2]]}function c(n,a){var g=n.fullSceneLayout,h=n.dataScale,y=a._len,v={};function _(z,j){var W=g[j],ee=h[u[j]];return m.simpleMap(z,function(J){return W.d2l(J)*ee})}if(v.vectors=f(_(a._u,"xaxis"),_(a._v,"yaxis"),_(a._w,"zaxis"),y),!y)return{positions:[],cells:[]};var x=_(a._Xs,"xaxis"),T=_(a._Ys,"yaxis"),A=_(a._Zs,"zaxis");if(v.meshgrid=[x,T,A],v.gridFill=a._gridFill,a._slen)v.startingPositions=f(_(a._startsX,"xaxis"),_(a._startsY,"yaxis"),_(a._startsZ,"zaxis"));else{for(var S=T[0],w=o(x),C=o(A),k=new Array(w.length*C.length),L=0,M=0;M<w.length;M++)for(var P=0;P<C.length;P++)k[L++]=[w[M],S,C[P]];v.startingPositions=k}v.colormap=p(a),v.tubeSize=a.sizeref,v.maxLength=a.maxdisplayed;var D=_(a._xbnds,"xaxis"),N=_(a._ybnds,"yaxis"),U=_(a._zbnds,"zaxis"),q=i(x),X=i(T),K=i(A),Z=[[D[0]-q[0],N[0]-X[0],U[0]-K[0]],[D[1]+q[1],N[1]+X[1],U[1]+K[1]]],H=t(v,Z),Y=e(a);H.vertexIntensityBounds=[Y.min/a._normMax,Y.max/a._normMax];var $=a.lightposition;return H.lightPosition=[$.x,$.y,$.z],H.ambient=a.lighting.ambient,H.diffuse=a.lighting.diffuse,H.specular=a.lighting.specular,H.roughness=a.lighting.roughness,H.fresnel=a.lighting.fresnel,H.opacity=a.opacity,a._pad=H.tubeScale*a.sizeref*2,H}l.handlePick=function(n){var a=this.scene.fullSceneLayout,g=this.scene.dataScale;function h(_,x){var T=a[x],A=g[u[x]];return T.l2c(_)/A}if(n.object===this.mesh){var y=n.data.position,v=n.data.velocity;return n.traceCoordinate=[h(y[0],"xaxis"),h(y[1],"yaxis"),h(y[2],"zaxis"),h(v[0],"xaxis"),h(v[1],"yaxis"),h(v[2],"zaxis"),n.data.intensity*this.data._normMax,n.data.divergence],n.textLabel=this.data.hovertext||this.data.text,!0}},l.update=function(n){this.data=n;var a=c(this.scene,n);this.mesh.update(a)},l.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},O.exports=function(n,a){var g=n.glplot.gl,h=c(n,a),y=d(g,h),v=new s(n,a.uid);return v.mesh=y,v.data=a,y._trace=v,n.glplot.add(y),v}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gl_format_color":783,"../../plots/gl3d/zip3":891,"gl-streamtube3d":344}],1312:[function(r,O,B){var t=r("../../lib"),d=r("../../components/colorscale/defaults"),m=r("./attributes");O.exports=function(p,e,f,u){function s(g,h){return t.coerce(p,e,m,g,h)}var l=s("u"),o=s("v"),i=s("w"),c=s("x"),n=s("y"),a=s("z");l&&l.length&&o&&o.length&&i&&i.length&&c&&c.length&&n&&n.length&&a&&a.length?(s("starts.x"),s("starts.y"),s("starts.z"),s("maxdisplayed"),s("sizeref"),s("lighting.ambient"),s("lighting.diffuse"),s("lighting.specular"),s("lighting.roughness"),s("lighting.fresnel"),s("lightposition.x"),s("lightposition.y"),s("lightposition.z"),d(p,e,u,s,{prefix:"",cLetter:"c"}),s("text"),s("hovertext"),s("hovertemplate"),s("uhoverformat"),s("vhoverformat"),s("whoverformat"),s("xhoverformat"),s("yhoverformat"),s("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":1309}],1313:[function(r,O,B){O.exports={moduleType:"trace",name:"streamtube",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:r("./calc").calc,plot:r("./convert"),eventData:function(t,d){return t.tubex=t.x,t.tubey=t.y,t.tubez=t.z,t.tubeu=d.traceCoordinate[3],t.tubev=d.traceCoordinate[4],t.tubew=d.traceCoordinate[5],t.norm=d.traceCoordinate[6],t.divergence=d.traceCoordinate[7],delete t.x,delete t.y,delete t.z,t},meta:{}}},{"../../plots/gl3d":880,"./attributes":1309,"./calc":1310,"./convert":1311,"./defaults":1312}],1314:[function(r,O,B){var t=r("../../plots/attributes"),d=r("../../plots/template_attributes").hovertemplateAttrs,m=r("../../plots/template_attributes").texttemplateAttrs,p=r("../../components/colorscale/attributes"),e=r("../../plots/domain").attributes,f=r("../pie/attributes"),u=r("./constants"),s=r("../../lib/extend").extendFlat;O.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:s({colors:{valType:"data_array",editType:"calc"},line:{color:s({},f.marker.line.color,{dflt:null}),width:s({},f.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},p("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:f.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:m({editType:"plot"},{keys:u.eventDataKeys.concat(["label","value"])}),hovertext:f.hovertext,hoverinfo:s({},t.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:d({},{keys:u.eventDataKeys}),textfont:f.textfont,insidetextorientation:f.insidetextorientation,insidetextfont:f.insidetextfont,outsidetextfont:s({},f.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:f.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/domain":866,"../../plots/template_attributes":910,"../pie/attributes":1176,"./constants":1317}],1315:[function(r,O,B){var t=r("../../plots/plots");B.name="sunburst",B.plot=function(d,m,p,e){t.plotBasePlot(B.name,d,m,p,e)},B.clean=function(d,m,p,e){t.cleanBasePlot(B.name,d,m,p,e)}},{"../../plots/plots":901}],1316:[function(r,O,B){var t=r("d3-hierarchy"),d=r("fast-isnumeric"),m=r("../../lib"),p=r("../../components/colorscale").makeColorScaleFuncFromTrace,e=r("../pie/calc").makePullColorFn,f=r("../pie/calc").generateExtendedColors,u=r("../../components/colorscale").calc,s=r("../../constants/numerical").ALMOST_EQUAL,l={},o={},i={};B.calc=function(c,n){var a,g,h,y,v,_,x=c._fullLayout,T=n.ids,A=m.isArrayOrTypedArray(T),S=n.labels,w=n.parents,C=n.values,k=m.isArrayOrTypedArray(C),L=[],M={},P={},D=function(te){return te||typeof te=="number"},N=function(te){return!k||d(C[te])&&C[te]>=0};A?(a=Math.min(T.length,w.length),g=function(te){return D(T[te])&&N(te)},h=function(te){return String(T[te])}):(a=Math.min(S.length,w.length),g=function(te){return D(S[te])&&N(te)},h=function(te){return String(S[te])}),k&&(a=Math.min(a,C.length));for(var U=0;U<a;U++)if(g(U)){var q=h(U),X=D(w[U])?String(w[U]):"",K={i:U,id:q,pid:X,label:D(S[U])?String(S[U]):""};k&&(K.v=+C[U]),L.push(K),v=q,M[y=X]?M[y].push(v):M[y]=[v],P[v]=1}if(M[""]){if(M[""].length>1){for(var Z=m.randstr(),H=0;H<L.length;H++)L[H].pid===""&&(L[H].pid=Z);L.unshift({hasMultipleRoots:!0,id:Z,pid:"",label:""})}}else{var Y,$=[];for(Y in M)P[Y]||$.push(Y);if($.length!==1)return m.warn(["Multiple implied roots, cannot build",n.type,"hierarchy of",n.name+".","These roots include:",$.join(", ")].join(" "));Y=$[0],L.unshift({hasImpliedRoot:!0,id:Y,pid:"",label:Y})}try{_=t.stratify().id(function(te){return te.id}).parentId(function(te){return te.pid})(L)}catch(te){return m.warn(["Failed to build",n.type,"hierarchy of",n.name+".","Error:",te.message].join(" "))}var z=t.hierarchy(_),j=!1;if(k)switch(n.branchvalues){case"remainder":z.sum(function(te){return te.data.v});break;case"total":z.each(function(te){var ie=te.data.data,ae=ie.v;if(te.children){var he=te.children.reduce(function(se,de){return se+de.data.data.v},0);if((ie.hasImpliedRoot||ie.hasMultipleRoots)&&(ae=he),ae<he*s)return j=!0,m.warn(["Total value for node",te.data.data.id,"of",n.name,"is smaller than the sum of its children.",`
parent value =`,ae,`
children sum =`,he].join(" "))}te.value=ae})}else(function te(ie,ae,he){var se=0,de=ie.children;if(de){for(var ue=de.length,ve=0;ve<ue;ve++)se+=te(de[ve],ae,he);he.branches&&se++}else he.leaves&&se++;return ie.value=ie.data.data.value=se,ae._values||(ae._values=[]),ae._values[ie.data.data.i]=se,se})(z,n,{branches:n.count.indexOf("branches")!==-1,leaves:n.count.indexOf("leaves")!==-1});if(!j){var W,ee;n.sort&&z.sort(function(te,ie){return ie.value-te.value});var J=n.marker.colors||[],Q=!!J.length;return n._hasColorscale?(Q||(J=k?n.values:n._values),u(c,n,{vals:J,containerStr:"marker",cLetter:"c"}),ee=p(n.marker)):W=e(x["_"+n.type+"colormap"]),z.each(function(te){var ie=te.data.data;ie.color=n._hasColorscale?ee(J[ie.i]):W(J[ie.i],ie.id)}),L[0].hierarchy=z,L}},B._runCrossTraceCalc=function(c,n){var a=n._fullLayout,g=n.calcdata,h=a[c+"colorway"],y=a["_"+c+"colormap"];a["extend"+c+"colors"]&&(h=f(h,c==="icicle"?i:c==="treemap"?o:l));var v,_=0;function x(S){var w=S.data.data,C=w.id;w.color===!1&&(y[C]?w.color=y[C]:S.parent?S.parent.parent?w.color=S.parent.data.data.color:(y[C]=w.color=h[_%h.length],_++):w.color=v)}for(var T=0;T<g.length;T++){var A=g[T][0];A.trace.type===c&&A.hierarchy&&(v=A.trace.root.color,A.hierarchy.each(x))}},B.crossTraceCalc=function(c){return B._runCrossTraceCalc("sunburst",c)}},{"../../components/colorscale":662,"../../constants/numerical":763,"../../lib":787,"../pie/calc":1178,"d3-hierarchy":167,"fast-isnumeric":246}],1317:[function(r,O,B){O.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1318:[function(r,O,B){var t=r("../../lib"),d=r("./attributes"),m=r("../../plots/domain").defaults,p=r("../bar/defaults").handleText,e=r("../../components/colorscale"),f=e.hasColorscale,u=e.handleDefaults;O.exports=function(s,l,o,i){function c(v,_){return t.coerce(s,l,d,v,_)}var n=c("labels"),a=c("parents");if(n&&n.length&&a&&a.length){var g=c("values");g&&g.length?c("branchvalues"):c("count"),c("level"),c("maxdepth"),c("marker.line.width")&&c("marker.line.color",i.paper_bgcolor),c("marker.colors");var h=l._hasColorscale=f(s,"marker","colors")||(s.marker||{}).coloraxis;h&&u(s,l,i,c,{prefix:"marker.",cLetter:"c"}),c("leaf.opacity",h?1:.7);var y=c("text");c("texttemplate"),l.texttemplate||c("textinfo",Array.isArray(y)?"text+label":"label"),c("hovertext"),c("hovertemplate"),p(s,l,i,c,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),c("insidetextorientation"),c("sort"),c("rotation"),c("root.color"),m(l,i,c),l._length=null}else l.visible=!1}},{"../../components/colorscale":662,"../../lib":787,"../../plots/domain":866,"../bar/defaults":929,"./attributes":1314}],1319:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../registry"),m=r("../../components/fx/helpers").appendArrayPointValue,p=r("../../components/fx"),e=r("../../lib"),f=r("../../lib/events"),u=r("./helpers"),s=r("../pie/helpers").formatPieValue;function l(o,i,c){for(var n=o.data.data,a={curveNumber:i.index,pointNumber:n.i,data:i._input,fullData:i},g=0;g<c.length;g++){var h=c[g];h in o&&(a[h]=o[h])}return"parentString"in o&&!u.isHierarchyRoot(o)&&(a.parent=o.parentString),m(a,i,n.i),a}O.exports=function(o,i,c,n,a){var g=n[0],h=g.trace,y=g.hierarchy,v=h.type==="sunburst",_=h.type==="treemap"||h.type==="icicle";"_hasHoverLabel"in h||(h._hasHoverLabel=!1),"_hasHoverEvent"in h||(h._hasHoverEvent=!1),o.on("mouseover",function(x){var T=c._fullLayout;if(!c._dragging&&T.hovermode!==!1){var A,S=c._fullData[h.index],w=x.data.data,C=w.i,k=u.isHierarchyRoot(x),L=u.getParent(y,x),M=u.getValue(x),P=function(Q){return e.castOption(S,C,Q)},D=P("hovertemplate"),N=p.castHoverinfo(S,T,C),U=T.separators;if(D||N&&N!=="none"&&N!=="skip"){var q,X;v&&(q=g.cx+x.pxmid[0]*(1-x.rInscribed),X=g.cy+x.pxmid[1]*(1-x.rInscribed)),_&&(q=x._hoverX,X=x._hoverY);var K,Z={},H=[],Y=[],$=function(Q){return H.indexOf(Q)!==-1};N&&(H=N==="all"?S._module.attributes.hoverinfo.flags:N.split("+")),Z.label=w.label,$("label")&&Z.label&&Y.push(Z.label),w.hasOwnProperty("v")&&(Z.value=w.v,Z.valueLabel=s(Z.value,U),$("value")&&Y.push(Z.valueLabel)),Z.currentPath=x.currentPath=u.getPath(x.data),$("current path")&&!k&&Y.push(Z.currentPath);var z=[],j=function(){z.indexOf(K)===-1&&(Y.push(K),z.push(K))};Z.percentParent=x.percentParent=M/u.getValue(L),Z.parent=x.parentString=u.getPtLabel(L),$("percent parent")&&(K=u.formatPercent(Z.percentParent,U)+" of "+Z.parent,j()),Z.percentEntry=x.percentEntry=M/u.getValue(i),Z.entry=x.entry=u.getPtLabel(i),!$("percent entry")||k||x.onPathbar||(K=u.formatPercent(Z.percentEntry,U)+" of "+Z.entry,j()),Z.percentRoot=x.percentRoot=M/u.getValue(y),Z.root=x.root=u.getPtLabel(y),$("percent root")&&!k&&(K=u.formatPercent(Z.percentRoot,U)+" of "+Z.root,j()),Z.text=P("hovertext")||P("text"),$("text")&&(K=Z.text,e.isValidTextValue(K)&&Y.push(K)),A=[l(x,S,a.eventDataKeys)];var W={trace:S,y:X,_x0:x._x0,_x1:x._x1,_y0:x._y0,_y1:x._y1,text:Y.join("<br>"),name:D||$("name")?S.name:void 0,color:P("hoverlabel.bgcolor")||w.color,borderColor:P("hoverlabel.bordercolor"),fontFamily:P("hoverlabel.font.family"),fontSize:P("hoverlabel.font.size"),fontColor:P("hoverlabel.font.color"),nameLength:P("hoverlabel.namelength"),textAlign:P("hoverlabel.align"),hovertemplate:D,hovertemplateLabels:Z,eventData:A};v&&(W.x0=q-x.rInscribed*x.rpx1,W.x1=q+x.rInscribed*x.rpx1,W.idealAlign=x.pxmid[0]<0?"left":"right"),_&&(W.x=q,W.idealAlign=q<0?"left":"right");var ee=[];p.loneHover(W,{container:T._hoverlayer.node(),outerContainer:T._paper.node(),gd:c,inOut_bbox:ee}),A[0].bbox=ee[0],h._hasHoverLabel=!0}if(_){var J=o.select("path.surface");a.styleOne(J,x,S,{hovered:!0})}h._hasHoverEvent=!0,c.emit("plotly_hover",{points:A||[l(x,S,a.eventDataKeys)],event:t.event})}}),o.on("mouseout",function(x){var T=c._fullLayout,A=c._fullData[h.index],S=t.select(this).datum();if(h._hasHoverEvent&&(x.originalEvent=t.event,c.emit("plotly_unhover",{points:[l(S,A,a.eventDataKeys)],event:t.event}),h._hasHoverEvent=!1),h._hasHoverLabel&&(p.loneUnhover(T._hoverlayer.node()),h._hasHoverLabel=!1),_){var w=o.select("path.surface");a.styleOne(w,S,A,{hovered:!1})}}),o.on("click",function(x){var T=c._fullLayout,A=c._fullData[h.index],S=v&&(u.isHierarchyRoot(x)||u.isLeaf(x)),w=u.getPtId(x),C=u.isEntry(x)?u.findEntryWithChild(y,w):u.findEntryWithLevel(y,w),k=u.getPtId(C),L={points:[l(x,A,a.eventDataKeys)],event:t.event};S||(L.nextLevel=k);var M=f.triggerHandler(c,"plotly_"+h.type+"click",L);if(M!==!1&&T.hovermode&&(c._hoverdata=[l(x,A,a.eventDataKeys)],p.click(c,t.event)),!S&&M!==!1&&!c._dragging&&!c._transitioning){d.call("_storeDirectGUIEdit",A,T._tracePreGUI[A.uid],{level:A.level});var P={data:[{level:k}],traces:[h.index]},D={frame:{redraw:!1,duration:a.transitionTime},transition:{duration:a.transitionTime,easing:a.transitionEasing},mode:"immediate",fromcurrent:!0};p.loneUnhover(T._hoverlayer.node()),d.call("animate",c,P,D)}})}},{"../../components/fx":690,"../../components/fx/helpers":686,"../../lib":787,"../../lib/events":776,"../../registry":915,"../pie/helpers":1181,"./helpers":1320,"@plotly/d3":58}],1320:[function(r,O,B){var t=r("../../lib"),d=r("../../components/color"),m=r("../../lib/setcursor"),p=r("../pie/helpers");function e(f){return f.data.data.pid}B.findEntryWithLevel=function(f,u){var s;return u&&f.eachAfter(function(l){if(B.getPtId(l)===u)return s=l.copy()}),s||f},B.findEntryWithChild=function(f,u){var s;return f.eachAfter(function(l){for(var o=l.children||[],i=0;i<o.length;i++){var c=o[i];if(B.getPtId(c)===u)return s=l.copy()}}),s||f},B.isEntry=function(f){return!f.parent},B.isLeaf=function(f){return!f.children},B.getPtId=function(f){return f.data.data.id},B.getPtLabel=function(f){return f.data.data.label},B.getValue=function(f){return f.value},B.isHierarchyRoot=function(f){return e(f)===""},B.setSliceCursor=function(f,u,s){var l=s.isTransitioning;if(!l){var o=f.datum();l=s.hideOnRoot&&B.isHierarchyRoot(o)||s.hideOnLeaves&&B.isLeaf(o)}m(f,l?null:"pointer")},B.getInsideTextFontKey=function(f,u,s,l,o){var i=(o||{}).onPathbar?"pathbar.textfont":"insidetextfont",c=s.data.data.i;return t.castOption(u,c,i+"."+f)||t.castOption(u,c,"textfont."+f)||l.size},B.getOutsideTextFontKey=function(f,u,s,l){var o=s.data.data.i;return t.castOption(u,o,"outsidetextfont."+f)||t.castOption(u,o,"textfont."+f)||l.size},B.isOutsideText=function(f,u){return!f._hasColorscale&&B.isHierarchyRoot(u)},B.determineTextFont=function(f,u,s,l){return B.isOutsideText(f,u)?function(o,i,c){return{color:B.getOutsideTextFontKey("color",o,i,c),family:B.getOutsideTextFontKey("family",o,i,c),size:B.getOutsideTextFontKey("size",o,i,c)}}(f,u,s):function(o,i,c,n){var a=(n||{}).onPathbar,g=i.data.data,h=g.i,y=t.castOption(o,h,(a?"pathbar.textfont":"insidetextfont")+".color");return!y&&o._input.textfont&&(y=t.castOption(o._input,h,"textfont.color")),{color:y||d.contrast(g.color),family:B.getInsideTextFontKey("family",o,i,c,n),size:B.getInsideTextFontKey("size",o,i,c,n)}}(f,u,s,l)},B.hasTransition=function(f){return!!(f&&f.duration>0)},B.getMaxDepth=function(f){return f.maxdepth>=0?f.maxdepth:1/0},B.isHeader=function(f,u){return!(B.isLeaf(f)||f.depth===u._maxDepth-1)},B.getParent=function(f,u){return B.findEntryWithLevel(f,e(u))},B.listPath=function(f,u){var s=f.parent;if(!s)return[];var l=u?[s.data[u]]:[s];return B.listPath(s,u).concat(l)},B.getPath=function(f){return B.listPath(f,"label").join("/")+"/"},B.formatValue=p.formatPieValue,B.formatPercent=function(f,u){var s=t.formatPercent(f,0);return s==="0%"&&(s=p.formatPiePercent(f,u)),s}},{"../../components/color":650,"../../lib":787,"../../lib/setcursor":808,"../pie/helpers":1181}],1321:[function(r,O,B){O.exports={moduleType:"trace",name:"sunburst",basePlotModule:r("./base_plot"),categories:[],animatable:!0,attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot").plot,style:r("./style").style,colorbar:r("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1220,"./attributes":1314,"./base_plot":1315,"./calc":1316,"./defaults":1318,"./layout_attributes":1322,"./layout_defaults":1323,"./plot":1324,"./style":1325}],1322:[function(r,O,B){O.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1323:[function(r,O,B){var t=r("../../lib"),d=r("./layout_attributes");O.exports=function(m,p){function e(f,u){return t.coerce(m,p,d,f,u)}e("sunburstcolorway",p.colorway),e("extendsunburstcolors")}},{"../../lib":787,"./layout_attributes":1322}],1324:[function(r,O,B){var t=r("@plotly/d3"),d=r("d3-hierarchy"),m=r("d3-interpolate").interpolate,p=r("../../components/drawing"),e=r("../../lib"),f=r("../../lib/svg_text_utils"),u=r("../bar/uniform_text"),s=u.recordMinTextSize,l=u.clearMinTextSize,o=r("../pie/plot"),i=r("../pie/helpers").getRotationAngle,c=o.computeTransform,n=o.transformInsideText,a=r("./style").styleOne,g=r("../bar/style").resizeText,h=r("./fx"),y=r("./constants"),v=r("./helpers");function _(T,A,S,w){var C=T._fullLayout,k=!C.uniformtext.mode&&v.hasTransition(w),L=t.select(S).selectAll("g.slice"),M=A[0],P=M.trace,D=M.hierarchy,N=v.findEntryWithLevel(D,P.level),U=v.getMaxDepth(P),q=C._size,X=P.domain,K=q.w*(X.x[1]-X.x[0]),Z=q.h*(X.y[1]-X.y[0]),H=.5*Math.min(K,Z),Y=M.cx=q.l+q.w*(X.x[1]+X.x[0])/2,$=M.cy=q.t+q.h*(1-X.y[0])-Z/2;if(!N)return L.remove();var z=null,j={};k&&L.each(function(xe){j[v.getPtId(xe)]={rpx0:xe.rpx0,rpx1:xe.rpx1,x0:xe.x0,x1:xe.x1,transform:xe.transform},!z&&v.isEntry(xe)&&(z=xe)});var W=function(xe){return d.partition().size([2*Math.PI,xe.height+1])(xe)}(N).descendants(),ee=N.height+1,J=0,Q=U;M.hasMultipleRoots&&v.isHierarchyRoot(N)&&(W=W.slice(1),ee-=1,J=1,Q+=1),W=W.filter(function(xe){return xe.y1<=Q});var te=i(P.rotation);te&&W.forEach(function(xe){xe.x0+=te,xe.x1+=te});var ie=Math.min(ee,U),ae=function(xe){return(xe-J)/ie*H},he=function(xe,ce){return[xe*Math.cos(ce),-xe*Math.sin(ce)]},se=function(xe){return e.pathAnnulus(xe.rpx0,xe.rpx1,xe.x0,xe.x1,Y,$)},de=function(xe){return Y+x(xe)[0]*(xe.transform.rCenter||0)+(xe.transform.x||0)},ue=function(xe){return $+x(xe)[1]*(xe.transform.rCenter||0)+(xe.transform.y||0)};(L=L.data(W,v.getPtId)).enter().append("g").classed("slice",!0),k?L.exit().transition().each(function(){var xe=t.select(this);xe.select("path.surface").transition().attrTween("d",function(ce){var ge=function(we){var Me,Se=v.getPtId(we),ze=j[Se],Fe=j[v.getPtId(N)];if(Fe){var Ye=(we.x1>Fe.x1?2*Math.PI:0)+te;Me=we.rpx1<Fe.rpx1?{x0:we.x0,x1:we.x1,rpx0:0,rpx1:0}:{x0:Ye,x1:Ye,rpx0:we.rpx0,rpx1:we.rpx1}}else{var rt,Oe=v.getPtId(we.parent);L.each(function(st){if(v.getPtId(st)===Oe)return rt=st});var je,We=rt.children;We.forEach(function(st,ct){if(v.getPtId(st)===Se)return je=ct});var qe=We.length,Qe=m(rt.x0,rt.x1);Me={rpx0:H,rpx1:H,x0:Qe(je/qe),x1:Qe((je+1)/qe)}}return m(ze,Me)}(ce);return function(we){return se(ge(we))}}),xe.select("g.slicetext").attr("opacity",0)}).remove():L.exit().remove(),L.order();var ve=null;if(k&&z){var ke=v.getPtId(z);L.each(function(xe){ve===null&&v.getPtId(xe)===ke&&(ve=xe.x1)})}var Ee=L;function be(xe){var ce=xe.parent,ge=j[v.getPtId(ce)],we={};if(ge){var Me=ce.children,Se=Me.indexOf(xe),ze=Me.length,Fe=m(ge.x0,ge.x1);we.x0=Fe(Se/ze),we.x1=Fe(Se/ze)}else we.x0=we.x1=0;return we}k&&(Ee=Ee.transition().each("end",function(){var xe=t.select(this);v.setSliceCursor(xe,T,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),Ee.each(function(xe){var ce=t.select(this),ge=e.ensureSingle(ce,"path","surface",function(Ye){Ye.style("pointer-events","all")});xe.rpx0=ae(xe.y0),xe.rpx1=ae(xe.y1),xe.xmid=(xe.x0+xe.x1)/2,xe.pxmid=he(xe.rpx1,xe.xmid),xe.midangle=-(xe.xmid-Math.PI/2),xe.startangle=-(xe.x0-Math.PI/2),xe.stopangle=-(xe.x1-Math.PI/2),xe.halfangle=.5*Math.min(e.angleDelta(xe.x0,xe.x1)||Math.PI,Math.PI),xe.ring=1-xe.rpx0/xe.rpx1,xe.rInscribed=function(Ye){return Ye.rpx0===0&&e.isFullCircle([Ye.x0,Ye.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(Ye.halfangle)),Ye.ring/2))}(xe),k?ge.transition().attrTween("d",function(Ye){var rt=function(Oe){var je,We=j[v.getPtId(Oe)],qe={x0:Oe.x0,x1:Oe.x1,rpx0:Oe.rpx0,rpx1:Oe.rpx1};if(We)je=We;else if(z)if(Oe.parent)if(ve){var Qe=(Oe.x1>ve?2*Math.PI:0)+te;je={x0:Qe,x1:Qe}}else je={rpx0:H,rpx1:H},e.extendFlat(je,be(Oe));else je={rpx0:0,rpx1:0};else je={x0:te,x1:te};return m(je,qe)}(Ye);return function(Oe){return se(rt(Oe))}}):ge.attr("d",se),ce.call(h,N,T,A,{eventDataKeys:y.eventDataKeys,transitionTime:y.CLICK_TRANSITION_TIME,transitionEasing:y.CLICK_TRANSITION_EASING}).call(v.setSliceCursor,T,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:T._transitioning}),ge.call(a,xe,P);var we=e.ensureSingle(ce,"g","slicetext"),Me=e.ensureSingle(we,"text","",function(Ye){Ye.attr("data-notex",1)}),Se=e.ensureUniformFontSize(T,v.determineTextFont(P,xe,C.font));Me.text(B.formatSliceLabel(xe,N,P,A,C)).classed("slicetext",!0).attr("text-anchor","middle").call(p.font,Se).call(f.convertToTspans,T);var ze=p.bBox(Me.node());xe.transform=n(ze,xe,M),xe.transform.targetX=de(xe),xe.transform.targetY=ue(xe);var Fe=function(Ye,rt){var Oe=Ye.transform;return c(Oe,rt),Oe.fontSize=Se.size,s(P.type,Oe,C),e.getTextTransform(Oe)};k?Me.transition().attrTween("transform",function(Ye){var rt=function(Oe){var je,We=j[v.getPtId(Oe)],qe=Oe.transform;if(We)je=We;else if(je={rpx1:Oe.rpx1,transform:{textPosAngle:qe.textPosAngle,scale:0,rotate:qe.rotate,rCenter:qe.rCenter,x:qe.x,y:qe.y}},z)if(Oe.parent)if(ve){var Qe=Oe.x1>ve?2*Math.PI:0;je.x0=je.x1=Qe}else e.extendFlat(je,be(Oe));else je.x0=je.x1=te;else je.x0=je.x1=te;var st=m(je.transform.textPosAngle,Oe.transform.textPosAngle),ct=m(je.rpx1,Oe.rpx1),Pt=m(je.x0,Oe.x0),kt=m(je.x1,Oe.x1),at=m(je.transform.scale,qe.scale),tt=m(je.transform.rotate,qe.rotate),_t=qe.rCenter===0?3:je.transform.rCenter===0?1/3:1,er=m(je.transform.rCenter,qe.rCenter);return function(tr){var Ue=ct(tr),He=Pt(tr),Be=kt(tr),Ke=function(Ce){return er(Math.pow(Ce,_t))}(tr),_e={pxmid:he(Ue,(He+Be)/2),rpx1:Ue,transform:{textPosAngle:st(tr),rCenter:Ke,x:qe.x,y:qe.y}};return s(P.type,qe,C),{transform:{targetX:de(_e),targetY:ue(_e),scale:at(tr),rotate:tt(tr),rCenter:Ke}}}}(Ye);return function(Oe){return Fe(rt(Oe),ze)}}):Me.attr("transform",Fe(xe,ze))})}function x(T){return A=T.rpx1,S=T.transform.textPosAngle,[A*Math.sin(S),-A*Math.cos(S)];var A,S}B.plot=function(T,A,S,w){var C,k,L=T._fullLayout,M=L._sunburstlayer,P=!S,D=!L.uniformtext.mode&&v.hasTransition(S);l("sunburst",L),(C=M.selectAll("g.trace.sunburst").data(A,function(N){return N[0].trace.uid})).enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),C.order(),D?(w&&(k=w()),t.transition().duration(S.duration).ease(S.easing).each("end",function(){k&&k()}).each("interrupt",function(){k&&k()}).each(function(){M.selectAll("g.trace").each(function(N){_(T,N,this,S)})})):(C.each(function(N){_(T,N,this,S)}),L.uniformtext.mode&&g(T,L._sunburstlayer.selectAll(".trace"),"sunburst")),P&&C.exit().remove()},B.formatSliceLabel=function(T,A,S,w,C){var k=S.texttemplate,L=S.textinfo;if(!(k||L&&L!=="none"))return"";var M=C.separators,P=w[0],D=T.data.data,N=P.hierarchy,U=v.isHierarchyRoot(T),q=v.getParent(N,T),X=v.getValue(T);if(!k){var K,Z=L.split("+"),H=function(te){return Z.indexOf(te)!==-1},Y=[];if(H("label")&&D.label&&Y.push(D.label),D.hasOwnProperty("v")&&H("value")&&Y.push(v.formatValue(D.v,M)),!U){H("current path")&&Y.push(v.getPath(T.data));var $=0;H("percent parent")&&$++,H("percent entry")&&$++,H("percent root")&&$++;var z=$>1;if($){var j,W=function(te){K=v.formatPercent(j,M),z&&(K+=" of "+te),Y.push(K)};H("percent parent")&&!U&&(j=X/v.getValue(q),W("parent")),H("percent entry")&&(j=X/v.getValue(A),W("entry")),H("percent root")&&(j=X/v.getValue(N),W("root"))}}return H("text")&&(K=e.castOption(S,D.i,"text"),e.isValidTextValue(K)&&Y.push(K)),Y.join("<br>")}var ee=e.castOption(S,D.i,"texttemplate");if(!ee)return"";var J={};D.label&&(J.label=D.label),D.hasOwnProperty("v")&&(J.value=D.v,J.valueLabel=v.formatValue(D.v,M)),J.currentPath=v.getPath(T.data),U||(J.percentParent=X/v.getValue(q),J.percentParentLabel=v.formatPercent(J.percentParent,M),J.parent=v.getPtLabel(q)),J.percentEntry=X/v.getValue(A),J.percentEntryLabel=v.formatPercent(J.percentEntry,M),J.entry=v.getPtLabel(A),J.percentRoot=X/v.getValue(N),J.percentRootLabel=v.formatPercent(J.percentRoot,M),J.root=v.getPtLabel(N),D.hasOwnProperty("color")&&(J.color=D.color);var Q=e.castOption(S,D.i,"text");return(e.isValidTextValue(Q)||Q==="")&&(J.text=Q),J.customdata=e.castOption(S,D.i,"customdata"),e.texttemplateString(ee,J,C._d3locale,J,S._meta||{})}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../bar/style":939,"../bar/uniform_text":941,"../pie/helpers":1181,"../pie/plot":1185,"./constants":1317,"./fx":1319,"./helpers":1320,"./style":1325,"@plotly/d3":58,"d3-hierarchy":167,"d3-interpolate":168}],1325:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/color"),m=r("../../lib"),p=r("../bar/uniform_text").resizeText;function e(f,u,s){var l=u.data.data,o=!u.children,i=l.i,c=m.castOption(s,i,"marker.line.color")||d.defaultLine,n=m.castOption(s,i,"marker.line.width")||0;f.style("stroke-width",n).call(d.fill,l.color).call(d.stroke,c).style("opacity",o?s.leaf.opacity:null)}O.exports={style:function(f){var u=f._fullLayout._sunburstlayer.selectAll(".trace");p(f,u,"sunburst"),u.each(function(s){var l=t.select(this),o=s[0].trace;l.style("opacity",o.opacity),l.selectAll("path.surface").each(function(i){t.select(this).call(e,i,o)})})},styleOne:e}},{"../../components/color":650,"../../lib":787,"../bar/uniform_text":941,"@plotly/d3":58}],1326:[function(r,O,B){var t=r("../../components/color"),d=r("../../components/colorscale/attributes"),m=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=r("../../plots/template_attributes").hovertemplateAttrs,e=r("../../plots/attributes"),f=r("../../lib/extend").extendFlat,u=r("../../plot_api/edit_types").overrideAll;function s(o){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:{valType:"boolean",dflt:!1},y:{valType:"boolean",dflt:!1},z:{valType:"boolean",dflt:!1}},color:{valType:"color",dflt:t.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:t.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var l=O.exports=u(f({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:p(),xhoverformat:m("x"),yhoverformat:m("y"),zhoverformat:m("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},d("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:s(),y:s(),z:s()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:f({},d.zauto,{}),zmin:f({},d.zmin,{}),zmax:f({},d.zmax,{})},hoverinfo:f({},e.hoverinfo),showlegend:f({},e.showlegend,{dflt:!1})}),"calc","nested");l.x.editType=l.y.editType=l.z.editType="calc+clearAxisTypes",l.transforms=void 0},{"../../components/color":650,"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910}],1327:[function(r,O,B){var t=r("../../components/colorscale/calc");O.exports=function(d,m){m.surfacecolor?t(d,m,{vals:m.surfacecolor,containerStr:"",cLetter:"c"}):t(d,m,{vals:m.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":658}],1328:[function(r,O,B){var t=r("gl-surface3d"),d=r("ndarray"),m=r("ndarray-linear-interpolate").d2,p=r("../heatmap/interp2d"),e=r("../heatmap/find_empties"),f=r("../../lib").isArrayOrTypedArray,u=r("../../lib/gl_format_color").parseColorScale,s=r("../../lib/str2rgbarray"),l=r("../../components/colorscale").extractOpts;function o(S,w,C){this.scene=S,this.uid=C,this.surface=w,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var i=o.prototype;i.getXat=function(S,w,C,k){var L=f(this.data.x)?f(this.data.x[0])?this.data.x[w][S]:this.data.x[S]:S;return C===void 0?L:k.d2l(L,0,C)},i.getYat=function(S,w,C,k){var L=f(this.data.y)?f(this.data.y[0])?this.data.y[w][S]:this.data.y[w]:w;return C===void 0?L:k.d2l(L,0,C)},i.getZat=function(S,w,C,k){var L=this.data.z[w][S];return L===null&&this.data.connectgaps&&this.data._interpolatedZ&&(L=this.data._interpolatedZ[w][S]),C===void 0?L:k.d2l(L,0,C)},i.handlePick=function(S){if(S.object===this.surface){var w=(S.data.index[0]-1)/this.dataScaleX-1,C=(S.data.index[1]-1)/this.dataScaleY-1,k=Math.max(Math.min(Math.round(w),this.data.z[0].length-1),0),L=Math.max(Math.min(Math.round(C),this.data._ylength-1),0);S.index=[k,L],S.traceCoordinate=[this.getXat(k,L),this.getYat(k,L),this.getZat(k,L)],S.dataCoordinate=[this.getXat(k,L,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(k,L,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(k,L,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var M=0;M<3;M++){var P=S.dataCoordinate[M];P!=null&&(S.dataCoordinate[M]*=this.scene.dataScale[M])}var D=this.data.hovertext||this.data.text;return Array.isArray(D)&&D[L]&&D[L][k]!==void 0?S.textLabel=D[L][k]:S.textLabel=D||"",S.data.dataCoordinate=S.dataCoordinate.slice(),this.surface.highlight(S.data),this.scene.glplot.spikes.position=S.dataCoordinate,!0}};var c=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function n(S,w){if(S<w)return 0;for(var C=0;Math.floor(S%w)===0;)S/=w,C++;return C}function a(S){for(var w=[],C=0;C<c.length;C++){var k=c[C];w.push(n(S,k))}return w}function g(S){for(var w=a(S),C=S,k=0;k<c.length;k++)if(w[k]>0){C=c[k];break}return C}function h(S,w){if(!(S<1||w<1)){for(var C=a(S),k=a(w),L=1,M=0;M<c.length;M++)L*=Math.pow(c[M],Math.max(C[M],k[M]));return L}}i.calcXnums=function(S){var w,C=[];for(w=1;w<S;w++){var k=this.getXat(w-1,0),L=this.getXat(w,0);C[w-1]=L!==k&&k!=null&&L!=null?Math.abs(L-k):0}var M=0;for(w=1;w<S;w++)M+=C[w-1];for(w=1;w<S;w++)C[w-1]===0?C[w-1]=1:C[w-1]=Math.round(M/C[w-1]);return C},i.calcYnums=function(S){var w,C=[];for(w=1;w<S;w++){var k=this.getYat(0,w-1),L=this.getYat(0,w);C[w-1]=L!==k&&k!=null&&L!=null?Math.abs(L-k):0}var M=0;for(w=1;w<S;w++)M+=C[w-1];for(w=1;w<S;w++)C[w-1]===0?C[w-1]=1:C[w-1]=Math.round(M/C[w-1]);return C};var y=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],v=y[9],_=y[13];function x(S,w,C){var k=C[8]+C[2]*w[0]+C[5]*w[1];return S[0]=(C[6]+C[0]*w[0]+C[3]*w[1])/k,S[1]=(C[7]+C[1]*w[0]+C[4]*w[1])/k,S}function T(S,w,C){return function(k,L,M,P){for(var D=[0,0],N=k.shape[0],U=k.shape[1],q=0;q<N;q++)for(var X=0;X<U;X++)M(D,[q,X],P),k.set(q,X,m(L,D[0],D[1]))}(S,w,x,C),S}function A(S,w){for(var C=!1,k=0;k<S.length;k++)if(w===S[k]){C=!0;break}C===!1&&S.push(w)}i.estimateScale=function(S,w){for(var C=1+function(L){if(L.length!==0){for(var M=1,P=0;P<L.length;P++)M=h(M,L[P]);return M}}(w===0?this.calcXnums(S):this.calcYnums(S));C<v;)C*=2;for(;C>_;)C--,C/=g(C),++C<v&&(C=_);var k=Math.round(C/S);return k>1?k:1},i.refineCoords=function(S){for(var w=this.dataScaleX,C=this.dataScaleY,k=S[0].shape[0],L=S[0].shape[1],M=0|Math.floor(S[0].shape[0]*w+1),P=0|Math.floor(S[0].shape[1]*C+1),D=1+k+1,N=1+L+1,U=d(new Float32Array(D*N),[D,N]),q=[1/w,0,0,0,1/C,0,0,0,1],X=0;X<S.length;++X){this.surface.padField(U,S[X]);var K=d(new Float32Array(M*P),[M,P]);T(K,U,q),S[X]=K}},i.setContourLevels=function(){var S,w,C,k=[[],[],[]],L=[!1,!1,!1],M=!1;for(S=0;S<3;++S)if(this.showContour[S]&&(M=!0,this.contourSize[S]>0&&this.contourStart[S]!==null&&this.contourEnd[S]!==null&&this.contourEnd[S]>this.contourStart[S]))for(L[S]=!0,w=this.contourStart[S];w<this.contourEnd[S];w+=this.contourSize[S])C=w*this.scene.dataScale[S],A(k[S],C);if(M){var P=[[],[],[]];for(S=0;S<3;++S)this.showContour[S]&&(P[S]=L[S]?k[S]:this.scene.contourLevels[S]);this.surface.update({levels:P})}},i.update=function(S){var w,C,k,L,M=this.scene,P=M.fullSceneLayout,D=this.surface,N=u(S),U=M.dataScale,q=S.z[0].length,X=S._ylength,K=M.contourLevels;this.data=S;var Z=[];for(w=0;w<3;w++)for(Z[w]=[],C=0;C<q;C++)Z[w][C]=[];for(C=0;C<q;C++)for(k=0;k<X;k++)Z[0][C][k]=this.getXat(C,k,S.xcalendar,P.xaxis),Z[1][C][k]=this.getYat(C,k,S.ycalendar,P.yaxis),Z[2][C][k]=this.getZat(C,k,S.zcalendar,P.zaxis);if(S.connectgaps)for(S._emptypoints=e(Z[2]),p(Z[2],S._emptypoints),S._interpolatedZ=[],C=0;C<q;C++)for(S._interpolatedZ[C]=[],k=0;k<X;k++)S._interpolatedZ[C][k]=Z[2][C][k];for(w=0;w<3;w++)for(C=0;C<q;C++)for(k=0;k<X;k++)(L=Z[w][C][k])==null?Z[w][C][k]=NaN:L=Z[w][C][k]*=U[w];for(w=0;w<3;w++)for(C=0;C<q;C++)for(k=0;k<X;k++)(L=Z[w][C][k])!=null&&(this.minValues[w]>L&&(this.minValues[w]=L),this.maxValues[w]<L&&(this.maxValues[w]=L));for(w=0;w<3;w++)this.objectOffset[w]=.5*(this.minValues[w]+this.maxValues[w]);for(w=0;w<3;w++)for(C=0;C<q;C++)for(k=0;k<X;k++)(L=Z[w][C][k])!=null&&(Z[w][C][k]-=this.objectOffset[w]);var H=[d(new Float32Array(q*X),[q,X]),d(new Float32Array(q*X),[q,X]),d(new Float32Array(q*X),[q,X])];for(w=0;w<3;w++)for(C=0;C<q;C++)for(k=0;k<X;k++)H[w].set(C,k,Z[w][C][k]);Z=[];var Y={colormap:N,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!S.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:S.opacityscale,opacity:S.opacity},$=l(S);if(Y.intensityBounds=[$.min,$.max],S.surfacecolor){var z=d(new Float32Array(q*X),[q,X]);for(C=0;C<q;C++)for(k=0;k<X;k++)z.set(C,k,S.surfacecolor[k][C]);H.push(z)}else Y.intensityBounds[0]*=U[2],Y.intensityBounds[1]*=U[2];(_<H[0].shape[0]||_<H[0].shape[1])&&(this.refineData=!1),this.refineData===!0&&(this.dataScaleX=this.estimateScale(H[0].shape[0],0),this.dataScaleY=this.estimateScale(H[0].shape[1],1),this.dataScaleX===1&&this.dataScaleY===1||this.refineCoords(H)),S.surfacecolor&&(Y.intensity=H.pop());var j=[!0,!0,!0],W=["x","y","z"];for(w=0;w<3;++w){var ee=S.contours[W[w]];j[w]=ee.highlight,Y.showContour[w]=ee.show||ee.highlight,Y.showContour[w]&&(Y.contourProject[w]=[ee.project.x,ee.project.y,ee.project.z],ee.show?(this.showContour[w]=!0,Y.levels[w]=K[w],D.highlightColor[w]=Y.contourColor[w]=s(ee.color),ee.usecolormap?D.highlightTint[w]=Y.contourTint[w]=0:D.highlightTint[w]=Y.contourTint[w]=1,Y.contourWidth[w]=ee.width,this.contourStart[w]=ee.start,this.contourEnd[w]=ee.end,this.contourSize[w]=ee.size):(this.showContour[w]=!1,this.contourStart[w]=null,this.contourEnd[w]=null,this.contourSize[w]=0),ee.highlight&&(Y.dynamicColor[w]=s(ee.highlightcolor),Y.dynamicWidth[w]=ee.highlightwidth))}(function(J){var Q=J[0].rgb,te=J[J.length-1].rgb;return Q[0]===te[0]&&Q[1]===te[1]&&Q[2]===te[2]&&Q[3]===te[3]})(N)&&(Y.vertexColor=!0),Y.objectOffset=this.objectOffset,Y.coords=H,D.update(Y),D.visible=S.visible,D.enableDynamic=j,D.enableHighlight=j,D.snapToData=!0,"lighting"in S&&(D.ambientLight=S.lighting.ambient,D.diffuseLight=S.lighting.diffuse,D.specularLight=S.lighting.specular,D.roughness=S.lighting.roughness,D.fresnel=S.lighting.fresnel),"lightposition"in S&&(D.lightPosition=[S.lightposition.x,S.lightposition.y,S.lightposition.z])},i.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},O.exports=function(S,w){var C=S.glplot.gl,k=t({gl:C}),L=new o(S,k,w.uid);return k._trace=L,L.update(w),S.glplot.add(k),L}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../heatmap/find_empties":1075,"../heatmap/interp2d":1078,"gl-surface3d":346,ndarray:472,"ndarray-linear-interpolate":466}],1329:[function(r,O,B){var t=r("../../registry"),d=r("../../lib"),m=r("../../components/colorscale/defaults"),p=r("./attributes");function e(u,s,l,o){var i=o("opacityscale");i==="max"?s.opacityscale=[[0,.1],[1,1]]:i==="min"?s.opacityscale=[[0,1],[1,.1]]:i==="extremes"?s.opacityscale=function(c,n){for(var a=[],g=0;g<32;g++){var h=g/31,y=n+(1-n)*(1-Math.pow(Math.sin(c*h*Math.PI),2));a.push([h,Math.max(0,Math.min(1,y))])}return a}(1,.1):function(c){var n=0;if(!Array.isArray(c)||c.length<2||!c[0]||!c[c.length-1]||+c[0][0]!=0||+c[c.length-1][0]!=1)return!1;for(var a=0;a<c.length;a++){var g=c[a];if(g.length!==2||+g[0]<n)return!1;n=+g[0]}return!0}(i)||(s.opacityscale=void 0)}function f(u,s,l){s in u&&!(l in u)&&(u[l]=u[s])}O.exports={supplyDefaults:function(u,s,l,o){var i,c;function n(A,S){return d.coerce(u,s,p,A,S)}var a=n("x"),g=n("y"),h=n("z");if(!h||!h.length||a&&a.length<1||g&&g.length<1)s.visible=!1;else{s._xlength=Array.isArray(a)&&d.isArrayOrTypedArray(a[0])?h.length:h[0].length,s._ylength=h.length,t.getComponentMethod("calendars","handleTraceDefaults")(u,s,["x","y","z"],o),n("text"),n("hovertext"),n("hovertemplate"),n("xhoverformat"),n("yhoverformat"),n("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(A){n(A)});var y=n("surfacecolor"),v=["x","y","z"];for(i=0;i<3;++i){var _="contours."+v[i],x=n(_+".show"),T=n(_+".highlight");if(x||T)for(c=0;c<3;++c)n(_+".project."+v[c]);x&&(n(_+".color"),n(_+".width"),n(_+".usecolormap")),T&&(n(_+".highlightcolor"),n(_+".highlightwidth")),n(_+".start"),n(_+".end"),n(_+".size")}y||(f(u,"zmin","cmin"),f(u,"zmax","cmax"),f(u,"zauto","cauto")),m(u,s,o,n,{prefix:"",cLetter:"c"}),e(u,s,o,n),s._length=null}},opacityscaleDefaults:e}},{"../../components/colorscale/defaults":660,"../../lib":787,"../../registry":915,"./attributes":1326}],1330:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:r("./calc"),plot:r("./convert"),moduleType:"trace",name:"surface",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":880,"./attributes":1326,"./calc":1327,"./convert":1328,"./defaults":1329}],1331:[function(r,O,B){var t=r("../../components/annotations/attributes"),d=r("../../lib/extend").extendFlat,m=r("../../plot_api/edit_types").overrideAll,p=r("../../plots/font_attributes"),e=r("../../plots/domain").attributes,f=r("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers;(O.exports=m({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:f("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:d({},t.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:d({},p({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:f("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:d({},t.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:d({},p({arrayOk:!0}))}},"calc","from-root")).transforms=void 0},{"../../components/annotations/attributes":633,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/cartesian/axis_format_attributes":841,"../../plots/domain":866,"../../plots/font_attributes":867}],1332:[function(r,O,B){var t=r("../../plots/get_data").getModuleCalcData,d=r("./plot");B.name="table",B.plot=function(m){var p=t(m.calcdata,"table")[0];p.length&&d(m,p)},B.clean=function(m,p,e,f){var u=f._has&&f._has("table"),s=p._has&&p._has("table");u&&!s&&f._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":875,"./plot":1339}],1333:[function(r,O,B){var t=r("../../lib/gup").wrap;O.exports=function(){return t({})}},{"../../lib/gup":784}],1334:[function(r,O,B){O.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1335:[function(r,O,B){var t=r("./constants"),d=r("../../lib/extend").extendFlat,m=r("fast-isnumeric");function p(i){if(Array.isArray(i)){for(var c=0,n=0;n<i.length;n++)c=Math.max(c,p(i[n]));return c}return i}function e(i,c){return i+c}function f(i){var c,n=i.slice(),a=1/0,g=0;for(c=0;c<n.length;c++)Array.isArray(n[c])||(n[c]=[n[c]]),a=Math.min(a,n[c].length),g=Math.max(g,n[c].length);if(a!==g)for(c=0;c<n.length;c++){var h=g-n[c].length;h&&(n[c]=n[c].concat(u(h)))}return n}function u(i){for(var c=new Array(i),n=0;n<i;n++)c[n]="";return c}function s(i){return i.calcdata.columns.reduce(function(c,n){return n.xIndex<i.xIndex?c+n.columnWidth:c},0)}function l(i,c){return Object.keys(i).map(function(n){return d({},i[n],{auxiliaryBlocks:c})})}function o(i,c){for(var n,a={},g=0,h=0,y={firstRowIndex:null,lastRowIndex:null,rows:[]},v=0,_=0,x=0;x<i.length;x++)n=i[x],y.rows.push({rowIndex:x,rowHeight:n}),((h+=n)>=c||x===i.length-1)&&(a[g]=y,y.key=_++,y.firstRowIndex=v,y.lastRowIndex=x,y={firstRowIndex:null,lastRowIndex:null,rows:[]},g+=h,v=x+1,h=0);return a}O.exports=function(i,c){var n=f(c.cells.values),a=function(U){return U.slice(c.header.values.length,U.length)},g=f(c.header.values);g.length&&!g[0].length&&(g[0]=[""],g=f(g));var h=g.concat(a(n).map(function(){return u((g[0]||[""]).length)})),y=c.domain,v=Math.floor(i._fullLayout._size.w*(y.x[1]-y.x[0])),_=Math.floor(i._fullLayout._size.h*(y.y[1]-y.y[0])),x=c.header.values.length?h[0].map(function(){return c.header.height}):[t.emptyHeaderHeight],T=n.length?n[0].map(function(){return c.cells.height}):[],A=x.reduce(e,0),S=o(T,_-A+t.uplift),w=l(o(x,A),[]),C=l(S,w),k={},L=c._fullInput.columnorder.concat(a(n.map(function(U,q){return q}))),M=h.map(function(U,q){var X=Array.isArray(c.columnwidth)?c.columnwidth[Math.min(q,c.columnwidth.length-1)]:c.columnwidth;return m(X)?Number(X):1}),P=M.reduce(e,0);M=M.map(function(U){return U/P*v});var D=Math.max(p(c.header.line.width),p(c.cells.line.width)),N={key:c.uid+i._context.staticPlot,translateX:y.x[0]*i._fullLayout._size.w,translateY:i._fullLayout._size.h*(1-y.y[1]),size:i._fullLayout._size,width:v,maxLineWidth:D,height:_,columnOrder:L,groupHeight:_,rowBlocks:C,headerRowBlocks:w,scrollY:0,cells:d({},c.cells,{values:n}),headerCells:d({},c.header,{values:h}),gdColumns:h.map(function(U){return U[0]}),gdColumnsOriginalOrder:h.map(function(U){return U[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:h.map(function(U,q){var X=k[U];return k[U]=(X||0)+1,{key:U+"__"+k[U],label:U,specIndex:q,xIndex:L[q],xScale:s,x:void 0,calcdata:void 0,columnWidth:M[q]}})};return N.columns.forEach(function(U){U.calcdata=N,U.x=s(U)}),N}},{"../../lib/extend":777,"./constants":1334,"fast-isnumeric":246}],1336:[function(r,O,B){var t=r("../../lib/extend").extendFlat;B.splitToPanels=function(d){var m=[0,0],p=t({},d,{key:"header",type:"header",page:0,prevPages:m,currentRepaint:[null,null],dragHandle:!0,values:d.calcdata.headerCells.values[d.specIndex],rowBlocks:d.calcdata.headerRowBlocks,calcdata:t({},d.calcdata,{cells:d.calcdata.headerCells})});return[t({},d,{key:"cells1",type:"cells",page:0,prevPages:m,currentRepaint:[null,null],dragHandle:!1,values:d.calcdata.cells.values[d.specIndex],rowBlocks:d.calcdata.rowBlocks}),t({},d,{key:"cells2",type:"cells",page:1,prevPages:m,currentRepaint:[null,null],dragHandle:!1,values:d.calcdata.cells.values[d.specIndex],rowBlocks:d.calcdata.rowBlocks}),p]},B.splitToCells=function(d){var m=function(p){var e=p.rowBlocks[p.page],f=e?e.rows[0].rowIndex:0,u=e?f+e.rows.length:0;return[f,u]}(d);return(d.values||[]).slice(m[0],m[1]).map(function(p,e){return{keyWithinBlock:e+(typeof p=="string"&&p.match(/[<$&> ]/)?"_keybuster_"+Math.random():""),key:m[0]+e,column:d,calcdata:d.calcdata,page:d.page,rowBlocks:d.rowBlocks,value:p}})}},{"../../lib/extend":777}],1337:[function(r,O,B){var t=r("../../lib"),d=r("./attributes"),m=r("../../plots/domain").defaults;O.exports=function(p,e,f,u){function s(l,o){return t.coerce(p,e,d,l,o)}m(e,u,s),s("columnwidth"),s("header.values"),s("header.format"),s("header.align"),s("header.prefix"),s("header.suffix"),s("header.height"),s("header.line.width"),s("header.line.color"),s("header.fill.color"),t.coerceFont(s,"header.font",t.extendFlat({},u.font)),function(l,o){for(var i=l.columnorder||[],c=l.header.values.length,n=i.slice(0,c),a=n.slice().sort(function(y,v){return y-v}),g=n.map(function(y){return a.indexOf(y)}),h=g.length;h<c;h++)g.push(h);o("columnorder",g)}(e,s),s("cells.values"),s("cells.format"),s("cells.align"),s("cells.prefix"),s("cells.suffix"),s("cells.height"),s("cells.line.width"),s("cells.line.color"),s("cells.fill.color"),t.coerceFont(s,"cells.font",t.extendFlat({},u.font)),e._length=null}},{"../../lib":787,"../../plots/domain":866,"./attributes":1331}],1338:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),moduleType:"trace",name:"table",basePlotModule:r("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1331,"./base_plot":1332,"./calc":1333,"./defaults":1337,"./plot":1339}],1339:[function(r,O,B){var t=r("./constants"),d=r("@plotly/d3"),m=r("../../lib").numberFormat,p=r("../../lib/gup"),e=r("../../components/drawing"),f=r("../../lib/svg_text_utils"),u=r("../../lib").raiseToTop,s=r("../../lib").strTranslate,l=r("../../lib").cancelTransition,o=r("./data_preparation_helper"),i=r("./data_split_helpers"),c=r("../../components/color");function n(H){return Math.ceil(H.calcdata.maxLineWidth/2)}function a(H,Y){return"clip"+H._fullLayout._uid+"_scrollAreaBottomClip_"+Y.key}function g(H,Y){return"clip"+H._fullLayout._uid+"_columnBoundaryClippath_"+Y.calcdata.key+"_"+Y.specIndex}function h(H){return[].concat.apply([],H.map(function(Y){return Y})).map(function(Y){return Y.__data__})}function y(H,Y,$){var z=H.selectAll("."+t.cn.scrollbarKit).data(p.repeat,p.keyFun);z.enter().append("g").classed(t.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),z.each(function(Q){var te=Q.scrollbarState;te.totalHeight=function(ie){var ae=ie.rowBlocks;return q(ae,ae.length-1)+(ae.length?X(ae[ae.length-1],1/0):1)}(Q),te.scrollableAreaHeight=Q.groupHeight-C(Q),te.currentlyVisibleHeight=Math.min(te.totalHeight,te.scrollableAreaHeight),te.ratio=te.currentlyVisibleHeight/te.totalHeight,te.barLength=Math.max(te.ratio*te.currentlyVisibleHeight,t.goldenRatio*t.scrollbarWidth),te.barWiggleRoom=te.currentlyVisibleHeight-te.barLength,te.wiggleRoom=Math.max(0,te.totalHeight-te.scrollableAreaHeight),te.topY=te.barWiggleRoom===0?0:Q.scrollY/te.wiggleRoom*te.barWiggleRoom,te.bottomY=te.topY+te.barLength,te.dragMultiplier=te.wiggleRoom/te.barWiggleRoom}).attr("transform",function(Q){var te=Q.width+t.scrollbarWidth/2+t.scrollbarOffset;return s(te,C(Q))});var j=z.selectAll("."+t.cn.scrollbar).data(p.repeat,p.keyFun);j.enter().append("g").classed(t.cn.scrollbar,!0);var W=j.selectAll("."+t.cn.scrollbarSlider).data(p.repeat,p.keyFun);W.enter().append("g").classed(t.cn.scrollbarSlider,!0),W.attr("transform",function(Q){return s(0,Q.scrollbarState.topY||0)});var ee=W.selectAll("."+t.cn.scrollbarGlyph).data(p.repeat,p.keyFun);ee.enter().append("line").classed(t.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",t.scrollbarWidth).attr("stroke-linecap","round").attr("y1",t.scrollbarWidth/2),ee.attr("y2",function(Q){return Q.scrollbarState.barLength-t.scrollbarWidth/2}).attr("stroke-opacity",function(Q){return Q.columnDragInProgress||!Q.scrollbarState.barWiggleRoom||$?0:.4}),ee.transition().delay(0).duration(0),ee.transition().delay(t.scrollbarHideDelay).duration(t.scrollbarHideDuration).attr("stroke-opacity",0);var J=j.selectAll("."+t.cn.scrollbarCaptureZone).data(p.repeat,p.keyFun);J.enter().append("line").classed(t.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",t.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(Q){var te=d.event.y,ie=this.getBoundingClientRect(),ae=Q.scrollbarState,he=te-ie.top,se=d.scale.linear().domain([0,ae.scrollableAreaHeight]).range([0,ae.totalHeight]).clamp(!0);ae.topY<=he&&he<=ae.bottomY||L(Y,H,null,se(he-ae.barLength/2))(Q)}).call(d.behavior.drag().origin(function(Q){return d.event.stopPropagation(),Q.scrollbarState.scrollbarScrollInProgress=!0,Q}).on("drag",L(Y,H)).on("dragend",function(){})),J.attr("y2",function(Q){return Q.scrollbarState.scrollableAreaHeight}),Y._context.staticPlot&&(ee.remove(),J.remove())}function v(H,Y,$,z){var j=function(ee){var J=ee.selectAll("."+t.cn.columnCell).data(i.splitToCells,function(Q){return Q.keyWithinBlock});return J.enter().append("g").classed(t.cn.columnCell,!0),J.exit().remove(),J}(function(ee){var J=ee.selectAll("."+t.cn.columnCells).data(p.repeat,p.keyFun);return J.enter().append("g").classed(t.cn.columnCells,!0),J.exit().remove(),J}($));(function(ee){ee.each(function(J,Q){var te=J.calcdata.cells.font,ie=J.column.specIndex,ae={size:T(te.size,ie,Q),color:T(te.color,ie,Q),family:T(te.family,ie,Q)};J.rowNumber=J.key,J.align=T(J.calcdata.cells.align,ie,Q),J.cellBorderWidth=T(J.calcdata.cells.line.width,ie,Q),J.font=ae})})(j),function(ee){ee.attr("width",function(J){return J.column.columnWidth}).attr("stroke-width",function(J){return J.cellBorderWidth}).each(function(J){var Q=d.select(this);c.stroke(Q,T(J.calcdata.cells.line.color,J.column.specIndex,J.rowNumber)),c.fill(Q,T(J.calcdata.cells.fill.color,J.column.specIndex,J.rowNumber))})}(function(ee){var J=ee.selectAll("."+t.cn.cellRect).data(p.repeat,function(Q){return Q.keyWithinBlock});return J.enter().append("rect").classed(t.cn.cellRect,!0),J}(j));var W=function(ee){var J=ee.selectAll("."+t.cn.cellText).data(p.repeat,function(Q){return Q.keyWithinBlock});return J.enter().append("text").classed(t.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){d.event.stopPropagation()}),J}(function(ee){var J=ee.selectAll("."+t.cn.cellTextHolder).data(p.repeat,function(Q){return Q.keyWithinBlock});return J.enter().append("g").classed(t.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),J}(j));(function(ee){ee.each(function(J){e.font(d.select(this),J.font)})})(W),_(W,Y,z,H),U(j)}function _(H,Y,$,z){H.text(function(j){var W=j.column.specIndex,ee=j.rowNumber,J=j.value,Q=typeof J=="string",te=Q&&J.match(/<br>/i),ie=!Q||te;j.mayHaveMarkup=Q&&J.match(/[<&>]/);var ae,he=typeof(ae=J)=="string"&&ae.match(t.latexCheck);j.latex=he;var se,de,ue=he?"":T(j.calcdata.cells.prefix,W,ee)||"",ve=he?"":T(j.calcdata.cells.suffix,W,ee)||"",ke=he?null:T(j.calcdata.cells.format,W,ee)||null,Ee=ue+(ke?m(ke)(j.value):j.value)+ve;if(j.wrappingNeeded=!j.wrapped&&!ie&&!he&&(se=x(Ee)),j.cellHeightMayIncrease=te||he||j.mayHaveMarkup||(se===void 0?x(Ee):se),j.needsConvertToTspans=j.mayHaveMarkup||j.wrappingNeeded||j.latex,j.wrappingNeeded){var be=(t.wrapSplitCharacter===" "?Ee.replace(/<a href=/gi,"<a_href="):Ee).split(t.wrapSplitCharacter),xe=t.wrapSplitCharacter===" "?be.map(function(ce){return ce.replace(/<a_href=/gi,"<a href=")}):be;j.fragments=xe.map(function(ce){return{text:ce,width:null}}),j.fragments.push({fragment:t.wrapSpacer,width:null}),de=xe.join(t.lineBreaker)+t.lineBreaker+t.wrapSpacer}else delete j.fragments,de=Ee;return de}).attr("dy",function(j){return j.needsConvertToTspans?0:"0.75em"}).each(function(j){var W=d.select(this),ee=j.wrappingNeeded?P:D;j.needsConvertToTspans?f.convertToTspans(W,z,ee($,this,Y,z,j)):d.select(this.parentNode).attr("transform",function(J){return s(N(J),t.cellPad)}).attr("text-anchor",function(J){return{left:"start",center:"middle",right:"end"}[J.align]})})}function x(H){return H.indexOf(t.wrapSplitCharacter)!==-1}function T(H,Y,$){if(Array.isArray(H)){var z=H[Math.min(Y,H.length-1)];return Array.isArray(z)?z[Math.min($,z.length-1)]:z}return H}function A(H,Y,$){H.transition().ease(t.releaseTransitionEase).duration(t.releaseTransitionDuration).attr("transform",s(Y.x,$))}function S(H){return H.type==="cells"}function w(H){return H.type==="header"}function C(H){return(H.rowBlocks.length?H.rowBlocks[0].auxiliaryBlocks:[]).reduce(function(Y,$){return Y+X($,1/0)},0)}function k(H,Y,$){var z=h(Y)[0];if(z!==void 0){var j=z.rowBlocks,W=z.calcdata,ee=q(j,j.length),J=z.calcdata.groupHeight-C(z),Q=W.scrollY=Math.max(0,Math.min(ee-J,W.scrollY)),te=function(ie,ae,he){for(var se=[],de=0,ue=0;ue<ie.length;ue++){for(var ve=ie[ue],ke=ve.rows,Ee=0,be=0;be<ke.length;be++)Ee+=ke[be].rowHeight;ve.allRowsHeight=Ee,ae<de+Ee&&ae+he>de&&se.push(ue),de+=Ee}return se}(j,Q,J);te.length===1&&(te[0]===j.length-1?te.unshift(te[0]-1):te.push(te[0]+1)),te[0]%2&&te.reverse(),Y.each(function(ie,ae){ie.page=te[ae],ie.scrollY=Q}),Y.attr("transform",function(ie){var ae=q(ie.rowBlocks,ie.page)-ie.scrollY;return s(0,ae)}),H&&(M(H,$,Y,te,z.prevPages,z,0),M(H,$,Y,te,z.prevPages,z,1),y($,H))}}function L(H,Y,$,z){return function(j){var W=j.calcdata?j.calcdata:j,ee=Y.filter(function(ie){return W.key===ie.key}),J=$||W.scrollbarState.dragMultiplier,Q=W.scrollY;W.scrollY=z===void 0?W.scrollY+J*d.event.dy:z;var te=ee.selectAll("."+t.cn.yColumn).selectAll("."+t.cn.columnBlock).filter(S);return k(H,te,ee),W.scrollY===Q}}function M(H,Y,$,z,j,W,ee){z[ee]!==j[ee]&&(clearTimeout(W.currentRepaint[ee]),W.currentRepaint[ee]=setTimeout(function(){var J=$.filter(function(Q,te){return te===ee&&z[te]!==j[te]});v(H,Y,J,$),j[ee]=z[ee]}))}function P(H,Y,$,z){return function(){var j=d.select(Y.parentNode);j.each(function(W){var ee=W.fragments;j.selectAll("tspan.line").each(function(de,ue){ee[ue].width=this.getComputedTextLength()});var J,Q,te=ee[ee.length-1].width,ie=ee.slice(0,-1),ae=[],he=0,se=W.column.columnWidth-2*t.cellPad;for(W.value="";ie.length;)he+(Q=(J=ie.shift()).width+te)>se&&(W.value+=ae.join(t.wrapSpacer)+t.lineBreaker,ae=[],he=0),ae.push(J.text),he+=Q;he&&(W.value+=ae.join(t.wrapSpacer)),W.wrapped=!0}),j.selectAll("tspan.line").remove(),_(j.select("."+t.cn.cellText),$,H,z),d.select(Y.parentNode.parentNode).call(U)}}function D(H,Y,$,z,j){return function(){if(!j.settledY){var W=d.select(Y.parentNode),ee=Z(j),J=j.key-ee.firstRowIndex,Q=ee.rows[J].rowHeight,te=j.cellHeightMayIncrease?Y.parentNode.getBoundingClientRect().height+2*t.cellPad:Q,ie=Math.max(te,Q);ie-ee.rows[J].rowHeight&&(ee.rows[J].rowHeight=ie,H.selectAll("."+t.cn.columnCell).call(U),k(null,H.filter(S),0),y($,z,!0)),W.attr("transform",function(){var ae=this.parentNode.getBoundingClientRect(),he=d.select(this.parentNode).select("."+t.cn.cellRect).node().getBoundingClientRect(),se=this.transform.baseVal.consolidate(),de=he.top-ae.top+(se?se.matrix.f:t.cellPad);return s(N(j,d.select(this.parentNode).select("."+t.cn.cellTextHolder).node().getBoundingClientRect().width),de)}),j.settledY=!0}}}function N(H,Y){switch(H.align){case"left":return t.cellPad;case"right":return H.column.columnWidth-(Y||0)-t.cellPad;case"center":return(H.column.columnWidth-(Y||0))/2;default:return t.cellPad}}function U(H){H.attr("transform",function(Y){var $=Y.rowBlocks[0].auxiliaryBlocks.reduce(function(j,W){return j+X(W,1/0)},0),z=X(Z(Y),Y.key);return s(0,z+$)}).selectAll("."+t.cn.cellRect).attr("height",function(Y){return($=Z(Y),z=Y.key,$.rows[z-$.firstRowIndex]).rowHeight;var $,z})}function q(H,Y){for(var $=0,z=Y-1;z>=0;z--)$+=K(H[z]);return $}function X(H,Y){for(var $=0,z=0;z<H.rows.length&&H.rows[z].rowIndex<Y;z++)$+=H.rows[z].rowHeight;return $}function K(H){var Y=H.allRowsHeight;if(Y!==void 0)return Y;for(var $=0,z=0;z<H.rows.length;z++)$+=H.rows[z].rowHeight;return H.allRowsHeight=$,$}function Z(H){return H.rowBlocks[H.page]}O.exports=function(H,Y){var $=!H._context.staticPlot,z=H._fullLayout._paper.selectAll("."+t.cn.table).data(Y.map(function(ve){var ke=p.unwrap(ve).trace;return o(H,ke)}),p.keyFun);z.exit().remove(),z.enter().append("g").classed(t.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),z.attr("width",function(ve){return ve.width+ve.size.l+ve.size.r}).attr("height",function(ve){return ve.height+ve.size.t+ve.size.b}).attr("transform",function(ve){return s(ve.translateX,ve.translateY)});var j=z.selectAll("."+t.cn.tableControlView).data(p.repeat,p.keyFun),W=j.enter().append("g").classed(t.cn.tableControlView,!0).style("box-sizing","content-box");if($){var ee="onwheel"in document?"wheel":"mousewheel";W.on("mousemove",function(ve){j.filter(function(ke){return ve===ke}).call(y,H)}).on(ee,function(ve){if(!ve.scrollbarState.wheeling){ve.scrollbarState.wheeling=!0;var ke=ve.scrollY+d.event.deltaY;L(H,j,null,ke)(ve)||(d.event.stopPropagation(),d.event.preventDefault()),ve.scrollbarState.wheeling=!1}}).call(y,H,!0)}j.attr("transform",function(ve){return s(ve.size.l,ve.size.t)});var J=j.selectAll("."+t.cn.scrollBackground).data(p.repeat,p.keyFun);J.enter().append("rect").classed(t.cn.scrollBackground,!0).attr("fill","none"),J.attr("width",function(ve){return ve.width}).attr("height",function(ve){return ve.height}),j.each(function(ve){e.setClipUrl(d.select(this),a(H,ve),H)});var Q=j.selectAll("."+t.cn.yColumn).data(function(ve){return ve.columns},p.keyFun);Q.enter().append("g").classed(t.cn.yColumn,!0),Q.exit().remove(),Q.attr("transform",function(ve){return s(ve.x,0)}),$&&Q.call(d.behavior.drag().origin(function(ve){return A(d.select(this),ve,-t.uplift),u(this),ve.calcdata.columnDragInProgress=!0,y(j.filter(function(ke){return ve.calcdata.key===ke.key}),H),ve}).on("drag",function(ve){var ke=d.select(this),Ee=function(be){return(ve===be?d.event.x:be.x)+be.columnWidth/2};ve.x=Math.max(-t.overdrag,Math.min(ve.calcdata.width+t.overdrag-ve.columnWidth,d.event.x)),h(Q).filter(function(be){return be.calcdata.key===ve.calcdata.key}).sort(function(be,xe){return Ee(be)-Ee(xe)}).forEach(function(be,xe){be.xIndex=xe,be.x=ve===be?be.x:be.xScale(be)}),Q.filter(function(be){return ve!==be}).transition().ease(t.transitionEase).duration(t.transitionDuration).attr("transform",function(be){return s(be.x,0)}),ke.call(l).attr("transform",s(ve.x,-t.uplift))}).on("dragend",function(ve){var ke=d.select(this),Ee=ve.calcdata;ve.x=ve.xScale(ve),ve.calcdata.columnDragInProgress=!1,A(ke,ve,0),function(be,xe,ce){var ge=xe.gdColumnsOriginalOrder;xe.gdColumns.sort(function(we,Me){return ce[ge.indexOf(we)]-ce[ge.indexOf(Me)]}),xe.columnorder=ce,be.emit("plotly_restyle")}(H,Ee,Ee.columns.map(function(be){return be.xIndex}))})),Q.each(function(ve){e.setClipUrl(d.select(this),g(H,ve),H)});var te=Q.selectAll("."+t.cn.columnBlock).data(i.splitToPanels,p.keyFun);te.enter().append("g").classed(t.cn.columnBlock,!0).attr("id",function(ve){return ve.key}),te.style("cursor",function(ve){return ve.dragHandle?"ew-resize":ve.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var ie=te.filter(w),ae=te.filter(S);$&&ae.call(d.behavior.drag().origin(function(ve){return d.event.stopPropagation(),ve}).on("drag",L(H,j,-1)).on("dragend",function(){})),v(H,j,ie,te),v(H,j,ae,te);var he=j.selectAll("."+t.cn.scrollAreaClip).data(p.repeat,p.keyFun);he.enter().append("clipPath").classed(t.cn.scrollAreaClip,!0).attr("id",function(ve){return a(H,ve)});var se=he.selectAll("."+t.cn.scrollAreaClipRect).data(p.repeat,p.keyFun);se.enter().append("rect").classed(t.cn.scrollAreaClipRect,!0).attr("x",-t.overdrag).attr("y",-t.uplift).attr("fill","none"),se.attr("width",function(ve){return ve.width+2*t.overdrag}).attr("height",function(ve){return ve.height+t.uplift}),Q.selectAll("."+t.cn.columnBoundary).data(p.repeat,p.keyFun).enter().append("g").classed(t.cn.columnBoundary,!0);var de=Q.selectAll("."+t.cn.columnBoundaryClippath).data(p.repeat,p.keyFun);de.enter().append("clipPath").classed(t.cn.columnBoundaryClippath,!0),de.attr("id",function(ve){return g(H,ve)});var ue=de.selectAll("."+t.cn.columnBoundaryRect).data(p.repeat,p.keyFun);ue.enter().append("rect").classed(t.cn.columnBoundaryRect,!0).attr("fill","none"),ue.attr("width",function(ve){return ve.columnWidth+2*n(ve)}).attr("height",function(ve){return ve.calcdata.height+2*n(ve)+t.uplift}).attr("x",function(ve){return-n(ve)}).attr("y",function(ve){return-n(ve)}),k(null,ae,j)}},{"../../components/color":650,"../../components/drawing":672,"../../lib":787,"../../lib/gup":784,"../../lib/svg_text_utils":813,"./constants":1334,"./data_preparation_helper":1335,"./data_split_helpers":1336,"@plotly/d3":58}],1340:[function(r,O,B){var t=r("../../plots/template_attributes").hovertemplateAttrs,d=r("../../plots/template_attributes").texttemplateAttrs,m=r("../../components/colorscale/attributes"),p=r("../../plots/domain").attributes,e=r("../pie/attributes"),f=r("../sunburst/attributes"),u=r("./constants"),s=r("../../lib/extend").extendFlat;O.exports={labels:f.labels,parents:f.parents,values:f.values,branchvalues:f.branchvalues,count:f.count,level:f.level,maxdepth:f.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:s({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:f.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:f.marker.line,editType:"calc"},m("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:s({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:f.textinfo,texttemplate:d({editType:"plot"},{keys:u.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:f.hoverinfo,hovertemplate:t({},{keys:u.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:s({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:f.root,domain:p({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/domain":866,"../../plots/template_attributes":910,"../pie/attributes":1176,"../sunburst/attributes":1314,"./constants":1343}],1341:[function(r,O,B){var t=r("../../plots/plots");B.name="treemap",B.plot=function(d,m,p,e){t.plotBasePlot(B.name,d,m,p,e)},B.clean=function(d,m,p,e){t.cleanBasePlot(B.name,d,m,p,e)}},{"../../plots/plots":901}],1342:[function(r,O,B){var t=r("../sunburst/calc");B.calc=function(d,m){return t.calc(d,m)},B.crossTraceCalc=function(d){return t._runCrossTraceCalc("treemap",d)}},{"../sunburst/calc":1316}],1343:[function(r,O,B){O.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1344:[function(r,O,B){var t=r("../../lib"),d=r("./attributes"),m=r("../../components/color"),p=r("../../plots/domain").defaults,e=r("../bar/defaults").handleText,f=r("../bar/constants").TEXTPAD,u=r("../../components/colorscale"),s=u.hasColorscale,l=u.handleDefaults;O.exports=function(o,i,c,n){function a(S,w){return t.coerce(o,i,d,S,w)}var g=a("labels"),h=a("parents");if(g&&g.length&&h&&h.length){var y=a("values");y&&y.length?a("branchvalues"):a("count"),a("level"),a("maxdepth"),a("tiling.packing")==="squarify"&&a("tiling.squarifyratio"),a("tiling.flip"),a("tiling.pad");var v=a("text");a("texttemplate"),i.texttemplate||a("textinfo",Array.isArray(v)?"text+label":"label"),a("hovertext"),a("hovertemplate");var _=a("pathbar.visible");e(o,i,n,a,"auto",{hasPathbar:_,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),a("textposition");var x=i.textposition.indexOf("bottom")!==-1;a("marker.line.width")&&a("marker.line.color",n.paper_bgcolor);var T=a("marker.colors");(i._hasColorscale=s(o,"marker","colors")||(o.marker||{}).coloraxis)?l(o,i,n,a,{prefix:"marker.",cLetter:"c"}):a("marker.depthfade",!(T||[]).length);var A=2*i.textfont.size;a("marker.pad.t",x?A/4:A),a("marker.pad.l",A/4),a("marker.pad.r",A/4),a("marker.pad.b",x?A:A/4),i._hovered={marker:{line:{width:2,color:m.contrast(n.paper_bgcolor)}}},_&&(a("pathbar.thickness",i.pathbar.textfont.size+2*f),a("pathbar.side"),a("pathbar.edgeshape")),a("sort"),a("root.color"),p(i,n,a),i._length=null}else i.visible=!1}},{"../../components/color":650,"../../components/colorscale":662,"../../lib":787,"../../plots/domain":866,"../bar/constants":927,"../bar/defaults":929,"./attributes":1340}],1345:[function(r,O,B){var t=r("@plotly/d3"),d=r("../sunburst/helpers"),m=r("../bar/uniform_text").clearMinTextSize,p=r("../bar/style").resizeText,e=r("./plot_one");O.exports=function(f,u,s,l,o){var i,c,n=o.type,a=o.drawDescendants,g=f._fullLayout,h=g["_"+n+"layer"],y=!s;m(n,g),(i=h.selectAll("g.trace."+n).data(u,function(v){return v[0].trace.uid})).enter().append("g").classed("trace",!0).classed(n,!0),i.order(),!g.uniformtext.mode&&d.hasTransition(s)?(l&&(c=l()),t.transition().duration(s.duration).ease(s.easing).each("end",function(){c&&c()}).each("interrupt",function(){c&&c()}).each(function(){h.selectAll("g.trace").each(function(v){e(f,v,this,s,a)})})):(i.each(function(v){e(f,v,this,s,a)}),g.uniformtext.mode&&p(f,h.selectAll(".trace"),n)),y&&i.exit().remove()}},{"../bar/style":939,"../bar/uniform_text":941,"../sunburst/helpers":1320,"./plot_one":1354,"@plotly/d3":58}],1346:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../components/drawing"),p=r("../../lib/svg_text_utils"),e=r("./partition"),f=r("./style").styleOne,u=r("./constants"),s=r("../sunburst/helpers"),l=r("../sunburst/fx");O.exports=function(o,i,c,n,a){var g=a.barDifY,h=a.width,y=a.height,v=a.viewX,_=a.viewY,x=a.pathSlice,T=a.toMoveInsideSlice,A=a.strTransform,S=a.hasTransition,w=a.handleSlicesExit,C=a.makeUpdateSliceInterpolator,k=a.makeUpdateTextInterpolator,L={},M=o._fullLayout,P=i[0],D=P.trace,N=P.hierarchy,U=h/D._entryDepth,q=s.listPath(c.data,"id"),X=e(N.copy(),[h,y],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();(X=X.filter(function(Z){var H=q.indexOf(Z.data.id);return H!==-1&&(Z.x0=U*H,Z.x1=U*(H+1),Z.y0=g,Z.y1=g+y,Z.onPathbar=!0,!0)})).reverse(),(n=n.data(X,s.getPtId)).enter().append("g").classed("pathbar",!0),w(n,!0,L,[h,y],x),n.order();var K=n;S&&(K=K.transition().each("end",function(){var Z=t.select(this);s.setSliceCursor(Z,o,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),K.each(function(Z){Z._x0=v(Z.x0),Z._x1=v(Z.x1),Z._y0=_(Z.y0),Z._y1=_(Z.y1),Z._hoverX=v(Z.x1-Math.min(h,y)/2),Z._hoverY=_(Z.y1-y/2);var H=t.select(this),Y=d.ensureSingle(H,"path","surface",function(W){W.style("pointer-events","all")});S?Y.transition().attrTween("d",function(W){var ee=C(W,!0,L,[h,y]);return function(J){return x(ee(J))}}):Y.attr("d",x),H.call(l,c,o,i,{styleOne:f,eventDataKeys:u.eventDataKeys,transitionTime:u.CLICK_TRANSITION_TIME,transitionEasing:u.CLICK_TRANSITION_EASING}).call(s.setSliceCursor,o,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:o._transitioning}),Y.call(f,Z,D,{hovered:!1}),Z._text=(s.getPtLabel(Z)||"").split("<br>").join(" ")||"";var $=d.ensureSingle(H,"g","slicetext"),z=d.ensureSingle($,"text","",function(W){W.attr("data-notex",1)}),j=d.ensureUniformFontSize(o,s.determineTextFont(D,Z,M.font,{onPathbar:!0}));z.text(Z._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(m.font,j).call(p.convertToTspans,o),Z.textBB=m.bBox(z.node()),Z.transform=T(Z,{fontSize:j.size,onPathbar:!0}),Z.transform.fontSize=j.size,S?z.transition().attrTween("transform",function(W){var ee=k(W,!0,L,[h,y]);return function(J){return A(ee(J))}}):z.attr("transform",A(Z))})}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../sunburst/fx":1319,"../sunburst/helpers":1320,"./constants":1343,"./partition":1352,"./style":1355,"@plotly/d3":58}],1347:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../components/drawing"),p=r("../../lib/svg_text_utils"),e=r("./partition"),f=r("./style").styleOne,u=r("./constants"),s=r("../sunburst/helpers"),l=r("../sunburst/fx"),o=r("../sunburst/plot").formatSliceLabel;O.exports=function(i,c,n,a,g){var h=g.width,y=g.height,v=g.viewX,_=g.viewY,x=g.pathSlice,T=g.toMoveInsideSlice,A=g.strTransform,S=g.hasTransition,w=g.handleSlicesExit,C=g.makeUpdateSliceInterpolator,k=g.makeUpdateTextInterpolator,L=g.prevEntry,M=i._fullLayout,P=c[0].trace,D=P.textposition.indexOf("left")!==-1,N=P.textposition.indexOf("right")!==-1,U=P.textposition.indexOf("bottom")!==-1,q=!U&&!P.marker.pad.t||U&&!P.marker.pad.b,X=e(n,[h,y],{packing:P.tiling.packing,squarifyratio:P.tiling.squarifyratio,flipX:P.tiling.flip.indexOf("x")>-1,flipY:P.tiling.flip.indexOf("y")>-1,pad:{inner:P.tiling.pad,top:P.marker.pad.t,left:P.marker.pad.l,right:P.marker.pad.r,bottom:P.marker.pad.b}}).descendants(),K=1/0,Z=-1/0;X.forEach(function(j){var W=j.depth;W>=P._maxDepth?(j.x0=j.x1=(j.x0+j.x1)/2,j.y0=j.y1=(j.y0+j.y1)/2):(K=Math.min(K,W),Z=Math.max(Z,W))}),a=a.data(X,s.getPtId),P._maxVisibleLayers=isFinite(Z)?Z-K+1:0,a.enter().append("g").classed("slice",!0),w(a,!1,{},[h,y],x),a.order();var H=null;if(S&&L){var Y=s.getPtId(L);a.each(function(j){H===null&&s.getPtId(j)===Y&&(H={x0:j.x0,x1:j.x1,y0:j.y0,y1:j.y1})})}var $=function(){return H||{x0:0,x1:h,y0:0,y1:y}},z=a;return S&&(z=z.transition().each("end",function(){var j=t.select(this);s.setSliceCursor(j,i,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),z.each(function(j){var W=s.isHeader(j,P);j._x0=v(j.x0),j._x1=v(j.x1),j._y0=_(j.y0),j._y1=_(j.y1),j._hoverX=v(j.x1-P.marker.pad.r),j._hoverY=_(U?j.y1-P.marker.pad.b/2:j.y0+P.marker.pad.t/2);var ee=t.select(this),J=d.ensureSingle(ee,"path","surface",function(ae){ae.style("pointer-events","all")});S?J.transition().attrTween("d",function(ae){var he=C(ae,!1,$(),[h,y]);return function(se){return x(he(se))}}):J.attr("d",x),ee.call(l,n,i,c,{styleOne:f,eventDataKeys:u.eventDataKeys,transitionTime:u.CLICK_TRANSITION_TIME,transitionEasing:u.CLICK_TRANSITION_EASING}).call(s.setSliceCursor,i,{isTransitioning:i._transitioning}),J.call(f,j,P,{hovered:!1}),j.x0===j.x1||j.y0===j.y1?j._text="":j._text=W?q?"":s.getPtLabel(j)||"":o(j,n,P,c,M)||"";var Q=d.ensureSingle(ee,"g","slicetext"),te=d.ensureSingle(Q,"text","",function(ae){ae.attr("data-notex",1)}),ie=d.ensureUniformFontSize(i,s.determineTextFont(P,j,M.font));te.text(j._text||" ").classed("slicetext",!0).attr("text-anchor",N?"end":D||W?"start":"middle").call(m.font,ie).call(p.convertToTspans,i),j.textBB=m.bBox(te.node()),j.transform=T(j,{fontSize:ie.size,isHeader:W}),j.transform.fontSize=ie.size,S?te.transition().attrTween("transform",function(ae){var he=k(ae,!1,$(),[h,y]);return function(se){return A(he(se))}}):te.attr("transform",A(j))}),H}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../sunburst/fx":1319,"../sunburst/helpers":1320,"../sunburst/plot":1324,"./constants":1343,"./partition":1352,"./style":1355,"@plotly/d3":58}],1348:[function(r,O,B){O.exports=function t(d,m,p){var e;p.swapXY&&(e=d.x0,d.x0=d.y0,d.y0=e,e=d.x1,d.x1=d.y1,d.y1=e),p.flipX&&(e=d.x0,d.x0=m[0]-d.x1,d.x1=m[0]-e),p.flipY&&(e=d.y0,d.y0=m[1]-d.y1,d.y1=m[1]-e);var f=d.children;if(f)for(var u=0;u<f.length;u++)t(f[u],m,p)}},{}],1349:[function(r,O,B){O.exports={moduleType:"trace",name:"treemap",basePlotModule:r("./base_plot"),categories:[],animatable:!0,attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot"),style:r("./style").style,colorbar:r("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1220,"./attributes":1340,"./base_plot":1341,"./calc":1342,"./defaults":1344,"./layout_attributes":1350,"./layout_defaults":1351,"./plot":1353,"./style":1355}],1350:[function(r,O,B){O.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1351:[function(r,O,B){var t=r("../../lib"),d=r("./layout_attributes");O.exports=function(m,p){function e(f,u){return t.coerce(m,p,d,f,u)}e("treemapcolorway",p.colorway),e("extendtreemapcolors")}},{"../../lib":787,"./layout_attributes":1350}],1352:[function(r,O,B){var t=r("d3-hierarchy"),d=r("./flip_tree");O.exports=function(m,p,e){var f,u=e.flipX,s=e.flipY,l=e.packing==="dice-slice",o=e.pad[s?"bottom":"top"],i=e.pad[u?"right":"left"],c=e.pad[u?"left":"right"],n=e.pad[s?"top":"bottom"];l&&(f=i,i=o,o=f,f=c,c=n,n=f);var a=t.treemap().tile(function(g,h){switch(g){case"squarify":return t.treemapSquarify.ratio(h);case"binary":return t.treemapBinary;case"dice":return t.treemapDice;case"slice":return t.treemapSlice;default:return t.treemapSliceDice}}(e.packing,e.squarifyratio)).paddingInner(e.pad.inner).paddingLeft(i).paddingRight(c).paddingTop(o).paddingBottom(n).size(l?[p[1],p[0]]:p)(m);return(l||u||s)&&d(a,p,{swapXY:l,flipX:u,flipY:s}),a}},{"./flip_tree":1348,"d3-hierarchy":167}],1353:[function(r,O,B){var t=r("./draw"),d=r("./draw_descendants");O.exports=function(m,p,e,f){return t(m,p,e,f,{type:"treemap",drawDescendants:d})}},{"./draw":1345,"./draw_descendants":1347}],1354:[function(r,O,B){var t=r("@plotly/d3"),d=r("d3-interpolate").interpolate,m=r("../sunburst/helpers"),p=r("../../lib"),e=r("../bar/constants").TEXTPAD,f=r("../bar/plot").toMoveInsideBar,u=r("../bar/uniform_text").recordMinTextSize,s=r("./constants"),l=r("./draw_ancestors");function o(i){return m.isHierarchyRoot(i)?"":m.getPtId(i)}O.exports=function(i,c,n,a,g){var h=i._fullLayout,y=c[0],v=y.trace,_=v.type==="icicle",x=y.hierarchy,T=m.findEntryWithLevel(x,v.level),A=t.select(n),S=A.selectAll("g.pathbar"),w=A.selectAll("g.slice");if(!T)return S.remove(),void w.remove();var C=m.isHierarchyRoot(T),k=!h.uniformtext.mode&&m.hasTransition(a),L=m.getMaxDepth(v),M=h._size,P=v.domain,D=M.w*(P.x[1]-P.x[0]),N=M.h*(P.y[1]-P.y[0]),U=D,q=v.pathbar.thickness,X=v.marker.line.width+s.gapWithPathbar,K=v.pathbar.visible?v.pathbar.side.indexOf("bottom")>-1?N+X:-(q+X):0,Z={x0:U,x1:U,y0:K,y1:K+q},H=function(Se,ze,Fe){var Ye=v.tiling.pad,rt=function(qe){return qe-Ye<=ze.x0},Oe=function(qe){return qe+Ye>=ze.x1},je=function(qe){return qe-Ye<=ze.y0},We=function(qe){return qe+Ye>=ze.y1};return Se.x0===ze.x0&&Se.x1===ze.x1&&Se.y0===ze.y0&&Se.y1===ze.y1?{x0:Se.x0,x1:Se.x1,y0:Se.y0,y1:Se.y1}:{x0:rt(Se.x0-Ye)?0:Oe(Se.x0-Ye)?Fe[0]:Se.x0,x1:rt(Se.x1+Ye)?0:Oe(Se.x1+Ye)?Fe[0]:Se.x1,y0:je(Se.y0-Ye)?0:We(Se.y0-Ye)?Fe[1]:Se.y0,y1:je(Se.y1+Ye)?0:We(Se.y1+Ye)?Fe[1]:Se.y1}},Y=null,$={},z={},j=null,W=function(Se,ze){return ze?$[o(Se)]:z[o(Se)]},ee=function(Se,ze,Fe,Ye){if(ze)return $[o(x)]||Z;var rt=z[v.level]||Fe;return function(Oe){return Oe.data.depth-T.data.depth<L}(Se)?H(Se,rt,Ye):{}};y.hasMultipleRoots&&C&&L++,v._maxDepth=L,v._backgroundColor=h.paper_bgcolor,v._entryDepth=T.data.depth,v._atRootLevel=C;var J=-D/2+M.l+M.w*(P.x[1]+P.x[0])/2,Q=-N/2+M.t+M.h*(1-(P.y[1]+P.y[0])/2),te=function(Se){return J+Se},ie=function(Se){return Q+Se},ae=ie(0),he=te(0),se=function(Se){return he+Se},de=function(Se){return ae+Se};function ue(Se,ze){return Se+","+ze}var ve=se(0),ke=function(Se){Se.x=Math.max(ve,Se.x)},Ee=v.pathbar.edgeshape,be=function(Se,ze){var Fe=Se.x0,Ye=Se.x1,rt=Se.y0,Oe=Se.y1,je=Se.textBB,We=function(_t){return v.textposition.indexOf(_t)!==-1},qe=We("bottom"),Qe=We("top")||ze.isHeader&&!qe?"start":qe?"end":"middle",st=We("right"),ct=We("left")||ze.onPathbar?-1:st?1:0,Pt=v[_?"tiling":"marker"].pad;if(ze.isHeader){if((Fe+=(_?Pt:Pt.l)-e)>=(Ye-=(_?Pt:Pt.r)-e)){var kt=(Fe+Ye)/2;Fe=kt,Ye=kt}var at;qe?rt<(at=Oe-(_?Pt:Pt.b))&&at<Oe&&(rt=at):rt<(at=rt+(_?Pt:Pt.t))&&at<Oe&&(Oe=at)}var tt=f(Fe,Ye,rt,Oe,je,{isHorizontal:!1,constrained:!0,angle:0,anchor:Qe,leftToRight:ct});return tt.fontSize=ze.fontSize,tt.targetX=te(tt.targetX),tt.targetY=ie(tt.targetY),isNaN(tt.targetX)||isNaN(tt.targetY)?{}:(Fe!==Ye&&rt!==Oe&&u(v.type,tt,h),{scale:tt.scale,rotate:tt.rotate,textX:tt.textX,textY:tt.textY,anchorX:tt.anchorX,anchorY:tt.anchorY,targetX:tt.targetX,targetY:tt.targetY})},xe=function(Se,ze){for(var Fe,Ye=0,rt=Se;!Fe&&Ye<L;)Ye++,(rt=rt.parent)?Fe=W(rt,ze):Ye=L;return Fe||{}},ce=function(Se,ze,Fe,Ye,rt){var Oe,je=W(Se,ze);if(je)Oe=je;else if(ze)Oe=Z;else if(Y)if(Se.parent){var We=j||Fe;We&&!ze?Oe=H(Se,We,Ye):(Oe={},p.extendFlat(Oe,xe(Se,ze)))}else Oe=p.extendFlat({},Se),_&&(rt.orientation==="h"?rt.flipX?Oe.x0=Se.x1:Oe.x1=0:rt.flipY?Oe.y0=Se.y1:Oe.y1=0);else Oe={};return d(Oe,{x0:Se.x0,x1:Se.x1,y0:Se.y0,y1:Se.y1})},ge=function(Se,ze,Fe,Ye){var rt=W(Se,ze),Oe={},je=ee(Se,ze,Fe,Ye);p.extendFlat(Oe,{transform:be({x0:je.x0,x1:je.x1,y0:je.y0,y1:je.y1,textBB:Se.textBB,_text:Se._text},{isHeader:m.isHeader(Se,v)})}),rt?Oe=rt:Se.parent&&p.extendFlat(Oe,xe(Se,ze));var We=Se.transform;return Se.x0!==Se.x1&&Se.y0!==Se.y1&&u(v.type,We,h),d(Oe,{transform:{scale:We.scale,rotate:We.rotate,textX:We.textX,textY:We.textY,anchorX:We.anchorX,anchorY:We.anchorY,targetX:We.targetX,targetY:We.targetY}})},we=function(Se,ze,Fe,Ye,rt){var Oe=Ye[0],je=Ye[1];k?Se.exit().transition().each(function(){var We=t.select(this);We.select("path.surface").transition().attrTween("d",function(qe){var Qe=function(st,ct,Pt,kt){var at,tt=W(st,ct);if(ct)at=Z;else{var _t=W(T,ct);at=_t?H(st,_t,kt):{}}return d(tt,at)}(qe,ze,0,[Oe,je]);return function(st){return rt(Qe(st))}}),We.select("g.slicetext").attr("opacity",0)}).remove():Se.exit().remove()},Me=function(Se){var ze=Se.transform;return Se.x0!==Se.x1&&Se.y0!==Se.y1&&u(v.type,ze,h),p.getTextTransform({textX:ze.textX,textY:ze.textY,anchorX:ze.anchorX,anchorY:ze.anchorY,targetX:ze.targetX,targetY:ze.targetY,scale:ze.scale,rotate:ze.rotate})};k&&(S.each(function(Se){$[o(Se)]={x0:Se.x0,x1:Se.x1,y0:Se.y0,y1:Se.y1},Se.transform&&($[o(Se)].transform={textX:Se.transform.textX,textY:Se.transform.textY,anchorX:Se.transform.anchorX,anchorY:Se.transform.anchorY,targetX:Se.transform.targetX,targetY:Se.transform.targetY,scale:Se.transform.scale,rotate:Se.transform.rotate})}),w.each(function(Se){z[o(Se)]={x0:Se.x0,x1:Se.x1,y0:Se.y0,y1:Se.y1},Se.transform&&(z[o(Se)].transform={textX:Se.transform.textX,textY:Se.transform.textY,anchorX:Se.transform.anchorX,anchorY:Se.transform.anchorY,targetX:Se.transform.targetX,targetY:Se.transform.targetY,scale:Se.transform.scale,rotate:Se.transform.rotate}),!Y&&m.isEntry(Se)&&(Y=Se)})),j=g(i,c,T,w,{width:D,height:N,viewX:te,viewY:ie,pathSlice:function(Se){var ze=te(Se.x0),Fe=te(Se.x1),Ye=ie(Se.y0),rt=ie(Se.y1),Oe=Fe-ze,je=rt-Ye;return!Oe||!je?"":"M"+ue(ze,Ye+0)+"L"+ue(Fe-0,Ye)+"L"+ue(Fe,rt-0)+"L"+ue(ze+0,rt)+"Z"},toMoveInsideSlice:be,prevEntry:Y,makeUpdateSliceInterpolator:ce,makeUpdateTextInterpolator:ge,handleSlicesExit:we,hasTransition:k,strTransform:Me}),v.pathbar.visible?l(i,c,T,S,{barDifY:K,width:U,height:q,viewX:se,viewY:de,pathSlice:function(Se){var ze=se(Math.max(Math.min(Se.x0,Se.x0),0)),Fe=se(Math.min(Math.max(Se.x1,Se.x1),U)),Ye=de(Se.y0),rt=de(Se.y1),Oe=q/2,je={},We={};je.x=ze,We.x=Fe,je.y=We.y=(Ye+rt)/2;var qe={x:ze,y:Ye},Qe={x:Fe,y:Ye},st={x:Fe,y:rt},ct={x:ze,y:rt};return Ee===">"?(qe.x-=Oe,Qe.x-=Oe,st.x-=Oe,ct.x-=Oe):Ee==="/"?(st.x-=Oe,ct.x-=Oe,je.x-=Oe/2,We.x-=Oe/2):Ee==="\\"?(qe.x-=Oe,Qe.x-=Oe,je.x-=Oe/2,We.x-=Oe/2):Ee==="<"&&(je.x-=Oe,We.x-=Oe),ke(qe),ke(ct),ke(je),ke(Qe),ke(st),ke(We),"M"+ue(qe.x,qe.y)+"L"+ue(Qe.x,Qe.y)+"L"+ue(We.x,We.y)+"L"+ue(st.x,st.y)+"L"+ue(ct.x,ct.y)+"L"+ue(je.x,je.y)+"Z"},toMoveInsideSlice:be,makeUpdateSliceInterpolator:ce,makeUpdateTextInterpolator:ge,handleSlicesExit:we,hasTransition:k,strTransform:Me}):S.remove()}},{"../../lib":787,"../bar/constants":927,"../bar/plot":936,"../bar/uniform_text":941,"../sunburst/helpers":1320,"./constants":1343,"./draw_ancestors":1346,"@plotly/d3":58,"d3-interpolate":168}],1355:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/color"),m=r("../../lib"),p=r("../sunburst/helpers"),e=r("../bar/uniform_text").resizeText;function f(u,s,l,o){var i,c,n=(o||{}).hovered,a=s.data.data,g=a.i,h=a.color,y=p.isHierarchyRoot(s),v=1;if(n)i=l._hovered.marker.line.color,c=l._hovered.marker.line.width;else if(y&&h===l.root.color)v=100,i="rgba(0,0,0,0)",c=0;else if(i=m.castOption(l,g,"marker.line.color")||d.defaultLine,c=m.castOption(l,g,"marker.line.width")||0,!l._hasColorscale&&!s.onPathbar){var _=l.marker.depthfade;if(_){var x,T=d.combine(d.addOpacity(l._backgroundColor,.75),h);if(_===!0){var A=p.getMaxDepth(l);x=isFinite(A)?p.isLeaf(s)?0:l._maxVisibleLayers-(s.data.depth-l._entryDepth):s.data.height+1}else x=s.data.depth-l._entryDepth,l._atRootLevel||x++;if(x>0)for(var S=0;S<x;S++){var w=.5*S/x;h=d.combine(d.addOpacity(T,w),h)}}}u.style("stroke-width",c).call(d.fill,h).call(d.stroke,i).style("opacity",v)}O.exports={style:function(u){var s=u._fullLayout._treemaplayer.selectAll(".trace");e(u,s,"treemap"),s.each(function(l){var o=t.select(this),i=l[0].trace;o.style("opacity",i.opacity),o.selectAll("path.surface").each(function(c){t.select(this).call(f,c,i,{hovered:!1})})})},styleOne:f}},{"../../components/color":650,"../../lib":787,"../bar/uniform_text":941,"../sunburst/helpers":1320,"@plotly/d3":58}],1356:[function(r,O,B){var t=r("../box/attributes"),d=r("../../lib/extend").extendFlat,m=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat;O.exports={y:t.y,x:t.x,x0:t.x0,y0:t.y0,xhoverformat:m("x"),yhoverformat:m("y"),name:d({},t.name,{}),orientation:d({},t.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:t.fillcolor,points:d({},t.boxpoints,{}),jitter:d({},t.jitter,{}),pointpos:d({},t.pointpos,{}),width:d({},t.width,{}),marker:t.marker,text:t.text,hovertext:t.hovertext,hovertemplate:t.hovertemplate,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup,selected:t.selected,unselected:t.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../box/attributes":950}],1357:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("../box/calc"),p=r("./helpers"),e=r("../../constants/numerical").BADNUM;function f(s,l,o){var i=l.max-l.min;if(!i)return s.bandwidth?s.bandwidth:0;if(s.bandwidth)return Math.max(s.bandwidth,i/1e4);var c=o.length,n=t.stdev(o,c-1,l.mean);return Math.max(function(a,g,h){return 1.059*Math.min(g,h/1.349)*Math.pow(a,-.2)}(c,n,l.q3-l.q1),i/100)}function u(s,l,o,i){var c,n=s.spanmode,a=s.span||[],g=[l.min,l.max],h=[l.min-2*i,l.max+2*i];function y(_){var x=a[_],T=o.type==="multicategory"?o.r2c(x):o.d2c(x,0,s[l.valLetter+"calendar"]);return T===e?h[_]:T}var v={type:"linear",range:c=n==="soft"?h:n==="hard"?g:[y(0),y(1)]};return d.setConvert(v),v.cleanRange(),c}O.exports=function(s,l){var o=m(s,l);if(o[0].t.empty)return o;for(var i=s._fullLayout,c=d.getFromId(s,l[l.orientation==="h"?"xaxis":"yaxis"]),n=1/0,a=-1/0,g=0,h=0,y=0;y<o.length;y++){var v=o[y],_=v.pts.map(p.extractVal),x=v.bandwidth=f(l,v,_),T=v.span=u(l,v,c,x);if(v.min===v.max&&x===0)T=v.span=[v.min,v.max],v.density=[{v:1,t:T[0]}],v.bandwidth=x,g=Math.max(g,1);else{var A=T[1]-T[0],S=Math.ceil(A/(x/3)),w=A/S;if(!isFinite(w)||!isFinite(S))return t.error("Something went wrong with computing the violin span"),o[0].t.empty=!0,o;var C=p.makeKDE(v,l,_);v.density=new Array(S);for(var k=0,L=T[0];L<T[1]+w/2;k++,L+=w){var M=C(L);v.density[k]={v:M,t:L},g=Math.max(g,M)}}h=Math.max(h,_.length),n=Math.min(n,T[0]),a=Math.max(a,T[1])}var P=d.findExtremes(c,[n,a],{padded:!0});if(l._extremes[c._id]=P,l.width)o[0].t.maxKDE=g;else{var D=i._violinScaleGroupStats,N=l.scalegroup,U=D[N];U?(U.maxKDE=Math.max(U.maxKDE,g),U.maxCount=Math.max(U.maxCount,h)):D[N]={maxKDE:g,maxCount:h}}return o[0].t.labels.kde=t._(s,"kde:"),o}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/axes":838,"../box/calc":951,"./helpers":1360}],1358:[function(r,O,B){var t=r("../box/cross_trace_calc").setPositionOffset,d=["v","h"];O.exports=function(m,p){for(var e=m.calcdata,f=p.xaxis,u=p.yaxis,s=0;s<d.length;s++){for(var l=d[s],o=l==="h"?u:f,i=[],c=0;c<e.length;c++){var n=e[c],a=n[0].t,g=n[0].trace;g.visible!==!0||g.type!=="violin"||a.empty||g.orientation!==l||g.xaxis!==f._id||g.yaxis!==u._id||i.push(c)}t("violin",m,i,o)}}},{"../box/cross_trace_calc":952}],1359:[function(r,O,B){var t=r("../../lib"),d=r("../../components/color"),m=r("../box/defaults"),p=r("./attributes");O.exports=function(e,f,u,s){function l(A,S){return t.coerce(e,f,p,A,S)}function o(A,S){return t.coerce2(e,f,p,A,S)}if(m.handleSampleDefaults(e,f,l,s),f.visible!==!1){l("bandwidth"),l("side"),l("width")||(l("scalegroup",f.name),l("scalemode"));var i,c=l("span");Array.isArray(c)&&(i="manual"),l("spanmode",i);var n=l("line.color",(e.marker||{}).color||u),a=l("line.width"),g=l("fillcolor",d.addOpacity(f.line.color,.5));m.handlePointsDefaults(e,f,l,{prefix:""});var h=o("box.width"),y=o("box.fillcolor",g),v=o("box.line.color",n),_=o("box.line.width",a);l("box.visible",Boolean(h||y||v||_))||(f.box={visible:!1});var x=o("meanline.color",n),T=o("meanline.width",a);l("meanline.visible",Boolean(x||T))||(f.meanline={visible:!1})}}},{"../../components/color":650,"../../lib":787,"../box/defaults":953,"./attributes":1356}],1360:[function(r,O,B){var t=r("../../lib"),d=function(m){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*m*m)};B.makeKDE=function(m,p,e){var f=e.length,u=d,s=m.bandwidth,l=1/(f*s);return function(o){for(var i=0,c=0;c<f;c++)i+=u((o-e[c])/s);return l*i}},B.getPositionOnKdePath=function(m,p,e){var f,u;p.orientation==="h"?(f="y",u="x"):(f="x",u="y");var s=t.findPointOnPath(m.path,e,u,{pathLength:m.pathLength}),l=m.posCenterPx,o=s[f];return[o,p.side==="both"?2*l-o:l]},B.getKdeValue=function(m,p,e){var f=m.pts.map(B.extractVal);return B.makeKDE(m,p,f)(e)/m.posDensityScale},B.extractVal=function(m){return m.v}},{"../../lib":787}],1361:[function(r,O,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("../box/hover"),p=r("./helpers");O.exports=function(e,f,u,s,l){l||(l={});var o,i,c=l.hoverLayer,n=e.cd,a=n[0].trace,g=a.hoveron,h=g.indexOf("violins")!==-1,y=g.indexOf("kde")!==-1,v=[];if(h||y){var _=m.hoverOnBoxes(e,f,u,s);if(y&&_.length>0){var x,T,A,S,w,C=e.xa,k=e.ya;a.orientation==="h"?(w=f,x="y",A=k,T="x",S=C):(w=u,x="x",A=C,T="y",S=k);var L=n[e.index];if(w>=L.span[0]&&w<=L.span[1]){var M=t.extendFlat({},e),P=S.c2p(w,!0),D=p.getKdeValue(L,a,w),N=p.getPositionOnKdePath(L,a,P),U=A._offset,q=A._length;M[x+"0"]=N[0],M[x+"1"]=N[1],M[T+"0"]=M[T+"1"]=P,M[T+"Label"]=T+": "+d.hoverLabelText(S,w,a[T+"hoverformat"])+", "+n[0].t.labels.kde+" "+D.toFixed(3),M.spikeDistance=_[0].spikeDistance;var X=x+"Spike";M[X]=_[0][X],_[0].spikeDistance=void 0,_[0][X]=void 0,M.hovertemplate=!1,v.push(M),(i={stroke:e.color})[x+"1"]=t.constrain(U+N[0],U,U+q),i[x+"2"]=t.constrain(U+N[1],U,U+q),i[T+"1"]=i[T+"2"]=S._offset+P}}h&&(v=v.concat(_))}g.indexOf("points")!==-1&&(o=m.hoverOnPoints(e,f,u));var K=c.selectAll(".violinline-"+a.uid).data(i?[0]:[]);return K.enter().append("line").classed("violinline-"+a.uid,!0).attr("stroke-width",1.5),K.exit().remove(),K.attr(i),s==="closest"?o?[o]:v:(o&&v.push(o),v)}},{"../../lib":787,"../../plots/cartesian/axes":838,"../box/hover":955,"./helpers":1360}],1362:[function(r,O,B){O.exports={attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc"),crossTraceCalc:r("./cross_trace_calc"),plot:r("./plot"),style:r("./style"),styleOnSelect:r("../scatter/style").styleOnSelect,hoverPoints:r("./hover"),selectPoints:r("../box/select"),moduleType:"trace",name:"violin",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"../box/defaults":953,"../box/select":960,"../scatter/style":1226,"./attributes":1356,"./calc":1357,"./cross_trace_calc":1358,"./defaults":1359,"./hover":1361,"./layout_attributes":1363,"./layout_defaults":1364,"./plot":1365,"./style":1366}],1363:[function(r,O,B){var t=r("../box/layout_attributes"),d=r("../../lib").extendFlat;O.exports={violinmode:d({},t.boxmode,{}),violingap:d({},t.boxgap,{}),violingroupgap:d({},t.boxgroupgap,{})}},{"../../lib":787,"../box/layout_attributes":957}],1364:[function(r,O,B){var t=r("../../lib"),d=r("./layout_attributes"),m=r("../box/layout_defaults");O.exports=function(p,e,f){m._supply(p,e,f,function(u,s){return t.coerce(p,e,d,u,s)},"violin")}},{"../../lib":787,"../box/layout_defaults":958,"./layout_attributes":1363}],1365:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../components/drawing"),p=r("../box/plot"),e=r("../scatter/line_points"),f=r("./helpers");O.exports=function(u,s,l,o){var i=u._fullLayout,c=s.xaxis,n=s.yaxis;function a(g){var h=e(g,{xaxis:c,yaxis:n,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return m.smoothopen(h[0],1)}d.makeTraceGroups(o,l,"trace violins").each(function(g){var h=t.select(this),y=g[0],v=y.t,_=y.trace;if(_.visible!==!0||v.empty)h.remove();else{var x=v.bPos,T=v.bdPos,A=s[v.valLetter+"axis"],S=s[v.posLetter+"axis"],w=_.side==="both",C=w||_.side==="positive",k=w||_.side==="negative",L=h.selectAll("path.violin").data(d.identity);L.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),L.exit().remove(),L.each(function(K){var Z,H,Y,$,z,j,W,ee,J=t.select(this),Q=K.density,te=Q.length,ie=S.c2l(K.pos+x,!0),ae=S.l2p(ie);if(_.width)Z=v.maxKDE/T;else{var he=i._violinScaleGroupStats[_.scalegroup];Z=_.scalemode==="count"?he.maxKDE/T*(he.maxCount/K.pts.length):he.maxKDE/T}if(C){for(W=new Array(te),z=0;z<te;z++)(ee=W[z]={})[v.posLetter]=ie+Q[z].v/Z,ee[v.valLetter]=A.c2l(Q[z].t,!0);H=a(W)}if(k){for(W=new Array(te),j=0,z=te-1;j<te;j++,z--)(ee=W[j]={})[v.posLetter]=ie-Q[z].v/Z,ee[v.valLetter]=A.c2l(Q[z].t,!0);Y=a(W)}if(w)$=H+"L"+Y.substr(1)+"Z";else{var se=[ae,A.c2p(Q[0].t)],de=[ae,A.c2p(Q[te-1].t)];_.orientation==="h"&&(se.reverse(),de.reverse()),$=C?"M"+se+"L"+H.substr(1)+"L"+de:"M"+de+"L"+Y.substr(1)+"L"+se}J.attr("d",$),K.posCenterPx=ae,K.posDensityScale=Z*T,K.path=J.node(),K.pathLength=K.path.getTotalLength()/(w?2:1)});var M,P,D,N=_.box,U=N.width,q=(N.line||{}).width;w?(M=T*U,P=0):C?(M=[0,T*U/2],P=q*{x:1,y:-1}[v.posLetter]):(M=[T*U/2,0],P=q*{x:-1,y:1}[v.posLetter]),p.plotBoxAndWhiskers(h,{pos:S,val:A},_,{bPos:x,bdPos:M,bPosPxOffset:P}),p.plotBoxMean(h,{pos:S,val:A},_,{bPos:x,bdPos:M,bPosPxOffset:P}),!_.box.visible&&_.meanline.visible&&(D=d.identity);var X=h.selectAll("path.meanline").data(D||[]);X.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),X.exit().remove(),X.each(function(K){var Z=A.c2p(K.mean,!0),H=f.getPositionOnKdePath(K,_,Z);t.select(this).attr("d",_.orientation==="h"?"M"+Z+","+H[0]+"V"+H[1]:"M"+H[0]+","+Z+"H"+H[1])}),p.plotPoints(h,{x:c,y:n},_,v)}})}},{"../../components/drawing":672,"../../lib":787,"../box/plot":959,"../scatter/line_points":1216,"./helpers":1360,"@plotly/d3":58}],1366:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/color"),m=r("../scatter/style").stylePoints;O.exports=function(p){var e=t.select(p).selectAll("g.trace.violins");e.style("opacity",function(f){return f[0].trace.opacity}),e.each(function(f){var u=f[0].trace,s=t.select(this),l=u.box||{},o=l.line||{},i=u.meanline||{},c=i.width;s.selectAll("path.violin").style("stroke-width",u.line.width+"px").call(d.stroke,u.line.color).call(d.fill,u.fillcolor),s.selectAll("path.box").style("stroke-width",o.width+"px").call(d.stroke,o.color).call(d.fill,l.fillcolor);var n={"stroke-width":c+"px","stroke-dasharray":2*c+"px,"+c+"px"};s.selectAll("path.mean").style(n).call(d.stroke,i.color),s.selectAll("path.meanline").style(n).call(d.stroke,i.color),m(s,u,p)})}},{"../../components/color":650,"../scatter/style":1226,"@plotly/d3":58}],1367:[function(r,O,B){var t=r("../../components/colorscale/attributes"),d=r("../isosurface/attributes"),m=r("../surface/attributes"),p=r("../../plots/attributes"),e=r("../../lib/extend").extendFlat,f=r("../../plot_api/edit_types").overrideAll,u=O.exports=f(e({x:d.x,y:d.y,z:d.z,value:d.value,isomin:d.isomin,isomax:d.isomax,surface:d.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:d.slices,caps:d.caps,text:d.text,hovertext:d.hovertext,xhoverformat:d.xhoverformat,yhoverformat:d.yhoverformat,zhoverformat:d.zhoverformat,valuehoverformat:d.valuehoverformat,hovertemplate:d.hovertemplate},t("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:d.colorbar,opacity:d.opacity,opacityscale:m.opacityscale,lightposition:d.lightposition,lighting:d.lighting,flatshading:d.flatshading,contour:d.contour,hoverinfo:e({},p.hoverinfo),showlegend:e({},p.showlegend,{dflt:!1})}),"calc","nested");u.x.editType=u.y.editType=u.z.editType=u.value.editType="calc+clearAxisTypes",u.transforms=void 0},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../isosurface/attributes":1138,"../surface/attributes":1326}],1368:[function(r,O,B){var t=r("gl-mesh3d"),d=r("../../lib/gl_format_color").parseColorScale,m=r("../../lib/str2rgbarray"),p=r("../../components/colorscale").extractOpts,e=r("../../plots/gl3d/zip3"),f=r("../isosurface/convert").findNearestOnAxis,u=r("../isosurface/convert").generateIsoMeshes;function s(o,i,c){this.scene=o,this.uid=c,this.mesh=i,this.name="",this.data=null,this.showContour=!1}var l=s.prototype;l.handlePick=function(o){if(o.object===this.mesh){var i=o.data.index,c=this.data._meshX[i],n=this.data._meshY[i],a=this.data._meshZ[i],g=this.data._Ys.length,h=this.data._Zs.length,y=f(c,this.data._Xs).id,v=f(n,this.data._Ys).id,_=f(a,this.data._Zs).id,x=o.index=_+h*v+h*g*y;o.traceCoordinate=[this.data._meshX[x],this.data._meshY[x],this.data._meshZ[x],this.data._value[x]];var T=this.data.hovertext||this.data.text;return Array.isArray(T)&&T[x]!==void 0?o.textLabel=T[x]:T&&(o.textLabel=T),!0}},l.update=function(o){var i=this.scene,c=i.fullSceneLayout;function n(h,y,v,_){return y.map(function(x){return h.d2l(x,0,_)*v})}this.data=u(o);var a={positions:e(n(c.xaxis,o._meshX,i.dataScale[0],o.xcalendar),n(c.yaxis,o._meshY,i.dataScale[1],o.ycalendar),n(c.zaxis,o._meshZ,i.dataScale[2],o.zcalendar)),cells:e(o._meshI,o._meshJ,o._meshK),lightPosition:[o.lightposition.x,o.lightposition.y,o.lightposition.z],ambient:o.lighting.ambient,diffuse:o.lighting.diffuse,specular:o.lighting.specular,roughness:o.lighting.roughness,fresnel:o.lighting.fresnel,vertexNormalsEpsilon:o.lighting.vertexnormalsepsilon,faceNormalsEpsilon:o.lighting.facenormalsepsilon,opacity:o.opacity,opacityscale:o.opacityscale,contourEnable:o.contour.show,contourColor:m(o.contour.color).slice(0,3),contourWidth:o.contour.width,useFacetNormals:o.flatshading},g=p(o);a.vertexIntensity=o._meshIntensity,a.vertexIntensityBounds=[g.min,g.max],a.colormap=d(o),this.mesh.update(a)},l.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},O.exports=function(o,i){var c=o.glplot.gl,n=t({gl:c}),a=new s(o,n,i.uid);return n._trace=a,a.update(i),o.glplot.add(n),a}},{"../../components/colorscale":662,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../../plots/gl3d/zip3":891,"../isosurface/convert":1140,"gl-mesh3d":309}],1369:[function(r,O,B){var t=r("../../lib"),d=r("./attributes"),m=r("../isosurface/defaults").supplyIsoDefaults,p=r("../surface/defaults").opacityscaleDefaults;O.exports=function(e,f,u,s){function l(o,i){return t.coerce(e,f,d,o,i)}m(e,f,u,s,l),p(e,f,s,l)}},{"../../lib":787,"../isosurface/defaults":1141,"../surface/defaults":1329,"./attributes":1367}],1370:[function(r,O,B){O.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:r("./convert"),moduleType:"trace",name:"volume",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":880,"../isosurface/calc":1139,"./attributes":1367,"./convert":1368,"./defaults":1369}],1371:[function(r,O,B){var t=r("../bar/attributes"),d=r("../scatter/attributes").line,m=r("../../plots/attributes"),p=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=r("../../plots/template_attributes").hovertemplateAttrs,f=r("../../plots/template_attributes").texttemplateAttrs,u=r("./constants"),s=r("../../lib/extend").extendFlat,l=r("../../components/color");function o(i){return{marker:{color:s({},t.marker.color,{arrayOk:!1,editType:"style"}),line:{color:s({},t.marker.line.color,{arrayOk:!1,editType:"style"}),width:s({},t.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}O.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,xhoverformat:p("x"),yhoverformat:p("y"),hovertext:t.hovertext,hovertemplate:e({},{keys:u.eventDataKeys}),hoverinfo:s({},m.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:f({editType:"plot"},{keys:u.eventDataKeys.concat(["label"])}),text:t.text,textposition:t.textposition,insidetextanchor:t.insidetextanchor,textangle:t.textangle,textfont:t.textfont,insidetextfont:t.insidetextfont,outsidetextfont:t.outsidetextfont,constraintext:t.constraintext,cliponaxis:t.cliponaxis,orientation:t.orientation,offset:t.offset,width:t.width,increasing:o(),decreasing:o(),totals:o(),connector:{line:{color:s({},d.color,{dflt:l.defaultLine}),width:s({},d.width,{editType:"plot"}),dash:d.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup}},{"../../components/color":650,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../bar/attributes":925,"../scatter/attributes":1202,"./constants":1373}],1372:[function(r,O,B){var t=r("../../plots/cartesian/axes"),d=r("../../plots/cartesian/align_period"),m=r("../../lib").mergeArray,p=r("../scatter/calc_selection"),e=r("../../constants/numerical").BADNUM;function f(s){return s==="a"||s==="absolute"}function u(s){return s==="t"||s==="total"}O.exports=function(s,l){var o,i,c,n,a,g,h=t.getFromId(s,l.xaxis||"x"),y=t.getFromId(s,l.yaxis||"y");l.orientation==="h"?(o=h.makeCalcdata(l,"x"),c=y.makeCalcdata(l,"y"),n=d(l,y,"y",c),a=!!l.yperiodalignment,g="y"):(o=y.makeCalcdata(l,"y"),c=h.makeCalcdata(l,"x"),n=d(l,h,"x",c),a=!!l.xperiodalignment,g="x"),i=n.vals;for(var v,_=Math.min(i.length,o.length),x=new Array(_),T=0,A=!1,S=0;S<_;S++){var w=o[S]||0,C=!1;(o[S]!==e||u(l.measure[S])||f(l.measure[S]))&&S+1<_&&(o[S+1]!==e||u(l.measure[S+1])||f(l.measure[S+1]))&&(C=!0);var k=x[S]={i:S,p:i[S],s:w,rawS:w,cNext:C};f(l.measure[S])?(T=k.s,k.isSum=!0,k.dir="totals",k.s=T):u(l.measure[S])?(k.isSum=!0,k.dir="totals",k.s=T):(k.isSum=!1,k.dir=k.rawS<0?"decreasing":"increasing",v=k.s,k.s=T+v,T+=v),k.dir==="totals"&&(A=!0),a&&(x[S].orig_p=c[S],x[S][g+"End"]=n.ends[S],x[S][g+"Start"]=n.starts[S]),l.ids&&(k.id=String(l.ids[S])),k.v=(l.base||0)+T}return x.length&&(x[0].hasTotals=A),m(l.text,x,"tx"),m(l.hovertext,x,"htx"),p(x,l),x}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../scatter/calc_selection":1204}],1373:[function(r,O,B){O.exports={eventDataKeys:["initial","delta","final"]}},{}],1374:[function(r,O,B){var t=r("../bar/cross_trace_calc").setGroupPositions;O.exports=function(d,m){var p,e,f=d._fullLayout,u=d._fullData,s=d.calcdata,l=m.xaxis,o=m.yaxis,i=[],c=[],n=[];for(e=0;e<u.length;e++){var a=u[e];a.visible===!0&&a.xaxis===l._id&&a.yaxis===o._id&&a.type==="waterfall"&&(p=s[e],a.orientation==="h"?n.push(p):c.push(p),i.push(p))}var g={mode:f.waterfallmode,norm:f.waterfallnorm,gap:f.waterfallgap,groupgap:f.waterfallgroupgap};for(t(d,l,o,c,g),t(d,o,l,n,g),e=0;e<i.length;e++){p=i[e];for(var h=0;h<p.length;h++){var y=p[h];y.isSum===!1&&(y.s0+=h===0?0:p[h-1].s),h+1<p.length&&(p[h].nextP0=p[h+1].p0,p[h].nextS0=p[h+1].s0)}}}},{"../bar/cross_trace_calc":928}],1375:[function(r,O,B){var t=r("../../lib"),d=r("../bar/defaults").handleGroupingDefaults,m=r("../bar/defaults").handleText,p=r("../scatter/xy_defaults"),e=r("../scatter/period_defaults"),f=r("./attributes"),u=r("../../components/color"),s=r("../../constants/delta.js"),l=s.INCREASING.COLOR,o=s.DECREASING.COLOR;function i(c,n,a){c(n+".marker.color",a),c(n+".marker.line.color",u.defaultLine),c(n+".marker.line.width")}O.exports={supplyDefaults:function(c,n,a,g){function h(v,_){return t.coerce(c,n,f,v,_)}if(p(c,n,g,h)){e(c,n,g,h),h("xhoverformat"),h("yhoverformat"),h("measure"),h("orientation",n.x&&!n.y?"h":"v"),h("base"),h("offset"),h("width"),h("text"),h("hovertext"),h("hovertemplate");var y=h("textposition");m(c,n,g,h,y,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),n.textposition!=="none"&&(h("texttemplate"),n.texttemplate||h("textinfo")),i(h,"increasing",l),i(h,"decreasing",o),i(h,"totals","#4499FF"),h("connector.visible")&&(h("connector.mode"),h("connector.line.width")&&(h("connector.line.color"),h("connector.line.dash")))}else n.visible=!1},crossTraceDefaults:function(c,n){var a,g;function h(v){return t.coerce(g._input,g,f,v)}if(n.waterfallmode==="group")for(var y=0;y<c.length;y++)a=(g=c[y])._input,d(a,g,n,h)}}},{"../../components/color":650,"../../constants/delta.js":757,"../../lib":787,"../bar/defaults":929,"../scatter/period_defaults":1222,"../scatter/xy_defaults":1229,"./attributes":1371}],1376:[function(r,O,B){O.exports=function(t,d){return t.x="xVal"in d?d.xVal:d.x,t.y="yVal"in d?d.yVal:d.y,"initial"in d&&(t.initial=d.initial),"delta"in d&&(t.delta=d.delta),"final"in d&&(t.final=d.final),d.xa&&(t.xaxis=d.xa),d.ya&&(t.yaxis=d.ya),t}},{}],1377:[function(r,O,B){var t=r("../../plots/cartesian/axes").hoverLabelText,d=r("../../components/color").opacity,m=r("../bar/hover").hoverOnBars,p=r("../../constants/delta.js"),e=p.INCREASING.SYMBOL,f=p.DECREASING.SYMBOL;O.exports=function(u,s,l,o,i){var c=m(u,s,l,o,i);if(c){var n=c.cd,a=n[0].trace,g=a.orientation==="h",h=g?"x":"y",y=g?u.xa:u.ya,v=n[c.index],_=v.isSum?v.b+v.s:v.rawS;if(!v.isSum){c.initial=v.b+v.s-_,c.delta=_,c.final=c.initial+c.delta;var x=k(Math.abs(c.delta));c.deltaLabel=_<0?"("+x+")":x,c.finalLabel=k(c.final),c.initialLabel=k(c.initial)}var T=v.hi||a.hoverinfo,A=[];if(T&&T!=="none"&&T!=="skip"){var S=T==="all",w=T.split("+"),C=function(L){return S||w.indexOf(L)!==-1};v.isSum||(!C("final")||C(g?"x":"y")||A.push(c.finalLabel),C("delta")&&(_<0?A.push(c.deltaLabel+" "+f):A.push(c.deltaLabel+" "+e)),C("initial")&&A.push("Initial: "+c.initialLabel))}return A.length&&(c.extraText=A.join("<br>")),c.color=function(L,M){var P=L[M.dir].marker,D=P.color,N=P.line.color,U=P.line.width;if(d(D))return D;if(d(N)&&U)return N}(a,v),[c]}function k(L){return t(y,L,a[h+"hoverformat"])}}},{"../../components/color":650,"../../constants/delta.js":757,"../../plots/cartesian/axes":838,"../bar/hover":932}],1378:[function(r,O,B){O.exports={attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults").supplyDefaults,crossTraceDefaults:r("./defaults").crossTraceDefaults,supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc"),crossTraceCalc:r("./cross_trace_calc"),plot:r("./plot"),style:r("./style").style,hoverPoints:r("./hover"),eventData:r("./event_data"),selectPoints:r("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:r("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"../bar/select":937,"./attributes":1371,"./calc":1372,"./cross_trace_calc":1374,"./defaults":1375,"./event_data":1376,"./hover":1377,"./layout_attributes":1379,"./layout_defaults":1380,"./plot":1381,"./style":1382}],1379:[function(r,O,B){O.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1380:[function(r,O,B){var t=r("../../lib"),d=r("./layout_attributes");O.exports=function(m,p,e){var f=!1;function u(o,i){return t.coerce(m,p,d,o,i)}for(var s=0;s<e.length;s++){var l=e[s];if(l.visible&&l.type==="waterfall"){f=!0;break}}f&&(u("waterfallmode"),u("waterfallgap",.2),u("waterfallgroupgap"))}},{"../../lib":787,"./layout_attributes":1379}],1381:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../components/drawing"),p=r("../../constants/numerical").BADNUM,e=r("../bar/plot"),f=r("../bar/uniform_text").clearMinTextSize;O.exports=function(u,s,l,o){var i=u._fullLayout;f("waterfall",i),e.plot(u,s,l,o,{mode:i.waterfallmode,norm:i.waterfallmode,gap:i.waterfallgap,groupgap:i.waterfallgroupgap}),function(c,n,a,g){var h=n.xaxis,y=n.yaxis;d.makeTraceGroups(g,a,"trace bars").each(function(v){var _=t.select(this),x=v[0].trace,T=d.ensureSingle(_,"g","lines");if(x.connector&&x.connector.visible){var A=x.orientation==="h",S=x.connector.mode,w=T.selectAll("g.line").data(d.identity);w.enter().append("g").classed("line",!0),w.exit().remove();var C=w.size();w.each(function(k,L){if(L===C-1||k.cNext){var M=function(U,q,X,K){var Z=[],H=[],Y=K?q:X,$=K?X:q;return Z[0]=Y.c2p(U.s0,!0),H[0]=$.c2p(U.p0,!0),Z[1]=Y.c2p(U.s1,!0),H[1]=$.c2p(U.p1,!0),Z[2]=Y.c2p(U.nextS0,!0),H[2]=$.c2p(U.nextP0,!0),K?[Z,H]:[H,Z]}(k,h,y,A),P=M[0],D=M[1],N="";P[0]!==p&&D[0]!==p&&P[1]!==p&&D[1]!==p&&(S==="spanning"&&!k.isSum&&L>0&&(N+=A?"M"+P[0]+","+D[1]+"V"+D[0]:"M"+P[1]+","+D[0]+"H"+P[0]),S!=="between"&&(k.isSum||L<C-1)&&(N+=A?"M"+P[1]+","+D[0]+"V"+D[1]:"M"+P[0]+","+D[1]+"H"+P[1]),P[2]!==p&&D[2]!==p&&(N+=A?"M"+P[1]+","+D[1]+"V"+D[2]:"M"+P[1]+","+D[1]+"H"+P[2])),N===""&&(N="M0,0Z"),d.ensureSingle(t.select(this),"path").attr("d",N).call(m.setClipUrl,n.layerClipId,c)}})}else T.remove()})}(u,s,l,o)}},{"../../components/drawing":672,"../../constants/numerical":763,"../../lib":787,"../bar/plot":936,"../bar/uniform_text":941,"@plotly/d3":58}],1382:[function(r,O,B){var t=r("@plotly/d3"),d=r("../../components/drawing"),m=r("../../components/color"),p=r("../../constants/interactions").DESELECTDIM,e=r("../bar/style"),f=r("../bar/uniform_text").resizeText,u=e.styleTextPoints;O.exports={style:function(s,l,o){var i=o||t.select(s).selectAll("g.waterfalllayer").selectAll("g.trace");f(s,i,"waterfall"),i.style("opacity",function(c){return c[0].trace.opacity}),i.each(function(c){var n=t.select(this),a=c[0].trace;n.selectAll(".point > path").each(function(g){if(!g.isBlank){var h=a[g.dir].marker;t.select(this).call(m.fill,h.color).call(m.stroke,h.line.color).call(d.dashLine,h.line.dash,h.line.width).style("opacity",a.selectedpoints&&!g.selected?p:1)}}),u(n,a,s),n.selectAll(".lines").each(function(){var g=a.connector.line;d.lineGroupStyle(t.select(this).selectAll("path"),g.width,g.color,g.dash)})})}}},{"../../components/color":650,"../../components/drawing":672,"../../constants/interactions":762,"../bar/style":939,"../bar/uniform_text":941,"@plotly/d3":58}],1383:[function(r,O,B){var t=r("../plots/cartesian/axes"),d=r("../lib"),m=r("../plot_api/plot_schema"),p=r("./helpers").pointsAccessorFunction,e=r("../constants/numerical").BADNUM;B.moduleType="transform",B.name="aggregate";var f=B.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},u=f.aggregations;function s(c,n,a,g){if(g.enabled){for(var h=g.target,y=d.nestedProperty(n,h),v=y.get(),_=function(A,S){var w=A.func,C=S.d2c,k=S.c2d;switch(w){case"count":return l;case"first":return o;case"last":return i;case"sum":return function(L,M){for(var P=0,D=0;D<M.length;D++){var N=C(L[M[D]]);N!==e&&(P+=N)}return k(P)};case"avg":return function(L,M){for(var P=0,D=0,N=0;N<M.length;N++){var U=C(L[M[N]]);U!==e&&(P+=U,D++)}return D?k(P/D):e};case"min":return function(L,M){for(var P=1/0,D=0;D<M.length;D++){var N=C(L[M[D]]);N!==e&&(P=Math.min(P,N))}return P===1/0?e:k(P)};case"max":return function(L,M){for(var P=-1/0,D=0;D<M.length;D++){var N=C(L[M[D]]);N!==e&&(P=Math.max(P,N))}return P===-1/0?e:k(P)};case"range":return function(L,M){for(var P=1/0,D=-1/0,N=0;N<M.length;N++){var U=C(L[M[N]]);U!==e&&(P=Math.min(P,U),D=Math.max(D,U))}return D===-1/0||P===1/0?e:k(D-P)};case"change":return function(L,M){var P=C(L[M[0]]),D=C(L[M[M.length-1]]);return P===e||D===e?e:k(D-P)};case"median":return function(L,M){for(var P=[],D=0;D<M.length;D++){var N=C(L[M[D]]);N!==e&&P.push(N)}if(!P.length)return e;P.sort(d.sorterAsc);var U=(P.length-1)/2;return k((P[Math.floor(U)]+P[Math.ceil(U)])/2)};case"mode":return function(L,M){for(var P={},D=0,N=e,U=0;U<M.length;U++){var q=C(L[M[U]]);if(q!==e){var X=P[q]=(P[q]||0)+1;X>D&&(D=X,N=q)}}return D?k(N):e};case"rms":return function(L,M){for(var P=0,D=0,N=0;N<M.length;N++){var U=C(L[M[N]]);U!==e&&(P+=U*U,D++)}return D?k(Math.sqrt(P/D)):e};case"stddev":return function(L,M){var P,D=0,N=0,U=1,q=e;for(P=0;P<M.length&&q===e;P++)q=C(L[M[P]]);if(q===e)return e;for(;P<M.length;P++){var X=C(L[M[P]]);if(X!==e){var K=X-q;D+=K,N+=K*K,U++}}var Z=A.funcmode==="sample"?U-1:U;return Z?Math.sqrt((N-D*D/U)/Z):0}}}(g,t.getDataConversions(c,n,h,v)),x=new Array(a.length),T=0;T<a.length;T++)x[T]=_(v,a[T]);y.set(x),g.func==="count"&&d.pushUnique(n._arrayAttrs,h)}}function l(c,n){return n.length}function o(c,n){return c[n[0]]}function i(c,n){return c[n[n.length-1]]}B.supplyDefaults=function(c,n){var a,g={};function h(k,L){return d.coerce(c,g,f,k,L)}if(!h("enabled"))return g;var y=m.findArrayAttributes(n),v={};for(a=0;a<y.length;a++)v[y[a]]=1;var _=h("groups");if(!Array.isArray(_)){if(!v[_])return g.enabled=!1,g;v[_]=0}var x,T=c.aggregations||[],A=g.aggregations=new Array(T.length);function S(k,L){return d.coerce(T[a],x,u,k,L)}for(a=0;a<T.length;a++){x={_index:a};var w=S("target"),C=S("func");S("enabled")&&w&&(v[w]||C==="count"&&v[w]===void 0)?(C==="stddev"&&S("funcmode"),v[w]=0,A[a]=x):A[a]={enabled:!1,_index:a}}for(a=0;a<y.length;a++)v[y[a]]&&A.push({target:y[a],func:u.func.dflt,enabled:!0,_index:-1});return g},B.calcTransform=function(c,n,a){if(a.enabled){var g=a.groups,h=d.getTargetArray(n,{target:g});if(h){var y,v,_,x,T={},A={},S=[],w=p(n.transforms,a),C=h.length;for(n._length&&(C=Math.min(C,n._length)),y=0;y<C;y++)(_=T[v=h[y]])===void 0?(T[v]=S.length,x=[y],S.push(x),A[T[v]]=w(y)):(S[_].push(y),A[T[v]]=(A[T[v]]||[]).concat(w(y)));a._indexToPoints=A;var k=a.aggregations;for(y=0;y<k.length;y++)s(c,n,S,k[y]);typeof g=="string"&&s(c,n,S,{target:g,func:"first",enabled:!0}),n._length=S.length}}}},{"../constants/numerical":763,"../lib":787,"../plot_api/plot_schema":826,"../plots/cartesian/axes":838,"./helpers":1386}],1384:[function(r,O,B){var t=r("../lib"),d=r("../registry"),m=r("../plots/cartesian/axes"),p=r("./helpers").pointsAccessorFunction,e=r("../constants/filter_ops"),f=e.COMPARISON_OPS,u=e.INTERVAL_OPS,s=e.SET_OPS;B.moduleType="transform",B.name="filter",B.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(f).concat(u).concat(s),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},B.supplyDefaults=function(l){var o={};function i(a,g){return t.coerce(l,o,B.attributes,a,g)}if(i("enabled")){var c=i("target");if(t.isArrayOrTypedArray(c)&&c.length===0)return o.enabled=!1,o;i("preservegaps"),i("operation"),i("value");var n=d.getComponentMethod("calendars","handleDefaults");n(l,o,"valuecalendar",null),n(l,o,"targetcalendar",null)}return o},B.calcTransform=function(l,o,i){if(i.enabled){var c=t.getTargetArray(o,i);if(c){var n=i.target,a=c.length;o._length&&(a=Math.min(a,o._length));var g=i.targetcalendar,h=o._arrayAttrs,y=i.preservegaps;if(typeof n=="string"){var v=t.nestedProperty(o,n+"calendar").get();v&&(g=v)}var _,x,T=function(M,P,D){var N=M.operation,U=M.value,q=Array.isArray(U);function X(Y){return Y.indexOf(N)!==-1}var K,Z=function(Y){return P(Y,0,M.valuecalendar)},H=function(Y){return P(Y,0,D)};switch(X(f)?K=Z(q?U[0]:U):X(u)?K=q?[Z(U[0]),Z(U[1])]:[Z(U),Z(U)]:X(s)&&(K=q?U.map(Z):[Z(U)]),N){case"=":return function(Y){return H(Y)===K};case"!=":return function(Y){return H(Y)!==K};case"<":return function(Y){return H(Y)<K};case"<=":return function(Y){return H(Y)<=K};case">":return function(Y){return H(Y)>K};case">=":return function(Y){return H(Y)>=K};case"[]":return function(Y){var $=H(Y);return $>=K[0]&&$<=K[1]};case"()":return function(Y){var $=H(Y);return $>K[0]&&$<K[1]};case"[)":return function(Y){var $=H(Y);return $>=K[0]&&$<K[1]};case"(]":return function(Y){var $=H(Y);return $>K[0]&&$<=K[1]};case"][":return function(Y){var $=H(Y);return $<=K[0]||$>=K[1]};case")(":return function(Y){var $=H(Y);return $<K[0]||$>K[1]};case"](":return function(Y){var $=H(Y);return $<=K[0]||$>K[1]};case")[":return function(Y){var $=H(Y);return $<K[0]||$>=K[1]};case"{}":return function(Y){return K.indexOf(H(Y))!==-1};case"}{":return function(Y){return K.indexOf(H(Y))===-1}}}(i,m.getDataToCoordFunc(l,o,n,c),g),A={},S={},w=0;y?(_=function(M){A[M.astr]=t.extendDeep([],M.get()),M.set(new Array(a))},x=function(M,P){var D=A[M.astr][P];M.get()[P]=D}):(_=function(M){A[M.astr]=t.extendDeep([],M.get()),M.set([])},x=function(M,P){var D=A[M.astr][P];M.get().push(D)}),L(_);for(var C=p(o.transforms,i),k=0;k<a;k++)T(c[k])?(L(x,k),S[w++]=C(k)):y&&w++;i._indexToPoints=S,o._length=w}}function L(M,P){for(var D=0;D<h.length;D++)M(t.nestedProperty(o,h[D]),P)}}},{"../constants/filter_ops":759,"../lib":787,"../plots/cartesian/axes":838,"../registry":915,"./helpers":1386}],1385:[function(r,O,B){var t=r("../lib"),d=r("../plot_api/plot_schema"),m=r("../plots/plots"),p=r("./helpers").pointsAccessorFunction;function e(f,u){var s,l,o,i,c,n,a,g,h,y,v=u.transform,_=u.transformIndex,x=f.transforms[_].groups,T=p(f.transforms,v);if(!t.isArrayOrTypedArray(x)||x.length===0)return[f];var A=t.filterUnique(x),S=new Array(A.length),w=x.length,C=d.findArrayAttributes(f),k=v.styles||[],L={};for(s=0;s<k.length;s++)L[k[s].target]=k[s].value;v.styles&&(y=t.keyedContainer(v,"styles","target","value.name"));var M={},P={};for(s=0;s<A.length;s++){M[n=A[s]]=s,P[n]=0,(a=S[s]=t.extendDeepNoArrays({},f))._group=n,a.transforms[_]._indexToPoints={};var D=null;for(y&&(D=y.get(n)),a.name=D||D===""?D:t.templateString(v.nameformat,{trace:f.name,group:n}),g=a.transforms,a.transforms=[],l=0;l<g.length;l++)a.transforms[l]=t.extendDeepNoArrays({},g[l]);for(l=0;l<C.length;l++)t.nestedProperty(a,C[l]).set([])}for(o=0;o<C.length;o++){for(i=C[o],l=0,h=[];l<A.length;l++)h[l]=t.nestedProperty(S[l],i).get();for(c=t.nestedProperty(f,i).get(),l=0;l<w;l++)h[M[x[l]]].push(c[l])}for(l=0;l<w;l++)(a=S[M[x[l]]]).transforms[_]._indexToPoints[P[x[l]]]=T(l),P[x[l]]++;for(s=0;s<A.length;s++)n=A[s],a=S[s],m.clearExpandedTraceDefaultColors(a),a=t.extendDeepNoArrays(a,L[n]||{});return S}B.moduleType="transform",B.name="groupby",B.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},B.supplyDefaults=function(f,u,s){var l,o={};function i(h,y){return t.coerce(f,o,B.attributes,h,y)}if(!i("enabled"))return o;i("groups"),i("nameformat",s._dataLength>1?"%{group} (%{trace})":"%{group}");var c=f.styles,n=o.styles=[];if(c)for(l=0;l<c.length;l++){var a=n[l]={};t.coerce(c[l],n[l],B.attributes.styles,"target");var g=t.coerce(c[l],n[l],B.attributes.styles,"value");t.isPlainObject(g)?a.value=t.extendDeep({},g):g&&delete a.value}return o},B.transform=function(f,u){var s,l,o,i=[];for(l=0;l<f.length;l++)for(s=e(f[l],u),o=0;o<s.length;o++)i.push(s[o]);return i}},{"../lib":787,"../plot_api/plot_schema":826,"../plots/plots":901,"./helpers":1386}],1386:[function(r,O,B){B.pointsAccessorFunction=function(t,d){for(var m,p,e=0;e<t.length&&(m=t[e])!==d;e++)m._indexToPoints&&m.enabled!==!1&&(p=m._indexToPoints);return p?function(f){return p[f]}:function(f){return[f]}}},{}],1387:[function(r,O,B){var t=r("../lib"),d=r("../plots/cartesian/axes"),m=r("./helpers").pointsAccessorFunction,p=r("../constants/numerical").BADNUM;B.moduleType="transform",B.name="sort",B.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},B.supplyDefaults=function(e){var f={};function u(s,l){return t.coerce(e,f,B.attributes,s,l)}return u("enabled")&&(u("target"),u("order")),f},B.calcTransform=function(e,f,u){if(u.enabled){var s=t.getTargetArray(f,u);if(s){var l=u.target,o=s.length;f._length&&(o=Math.min(o,f._length));var i,c,n=f._arrayAttrs,a=function(x,T,A,S){var w,C=new Array(S),k=new Array(S);for(w=0;w<S;w++)C[w]={v:T[w],i:w};for(C.sort(function(L,M){switch(L.order){case"ascending":return function(P,D){var N=M(P.v),U=M(D.v);return N===p?1:U===p?-1:N-U};case"descending":return function(P,D){var N=M(P.v),U=M(D.v);return N===p?1:U===p?-1:U-N}}}(x,A)),w=0;w<S;w++)k[w]=C[w].i;return k}(u,s,d.getDataToCoordFunc(e,f,l,s),o),g=m(f.transforms,u),h={};for(i=0;i<n.length;i++){var y=t.nestedProperty(f,n[i]),v=y.get(),_=new Array(o);for(c=0;c<o;c++)_[c]=v[a[c]];y.set(_)}for(c=0;c<o;c++)h[c]=g(a[c]);u._indexToPoints=h,f._length=o}}}},{"../constants/numerical":763,"../lib":787,"../plots/cartesian/axes":838,"./helpers":1386}],1388:[function(r,O,B){B.version="2.5.1"},{}]},{},[27])(27)})})(Xd);var Yl=zm(Xd.exports);const Rm=["AfterExport","AfterPlot","Animated","AnimatingFrame","AnimationInterrupted","AutoSize","BeforeExport","ButtonClicked","Click","ClickAnnotation","Deselect","DoubleClick","Framework","Hover","LegendClick","LegendDoubleClick","Relayout","Restyle","Redraw","Selected","Selecting","SliderChange","SliderEnd","SliderStart","Transitioning","TransitionInterrupted","Unhover"],Zd=Rm.map(et=>et.toLocaleLowerCase()).map(et=>({completeName:"plotly_"+et,handler:$e=>(...r)=>{$e.$emit.apply($e,[et,...r])}})),Fm=["restyle","relayout","update","addTraces","deleteTraces","moveTraces","extendTraces","prependTraces","purge"],Bm=Fm.reduce((et,$e)=>(et[$e]=function(...r){return Yl[$e].apply(Yl,[this.$el,...r])},et),{});function Nm(et){const $e=Object.create(null);return function(O){return $e[O]||($e[O]=et(O))}}const jm=/-(\w)/g,Um=Nm(et=>et.replace(jm,($e,r)=>r?r.toUpperCase():""));var Vm=function(){var et=this,$e=et.$createElement,r=et._self._c||$e;return r("div",{directives:[{name:"resize",rawName:"v-resize:debounce.100",value:et.onResize,expression:"onResize",arg:"debounce",modifiers:{"100":!0}}],attrs:{id:et.id}})},Hm=[];function Gm(et,$e,r,O,B,t,d,m){var p=typeof et=="function"?et.options:et;$e&&(p.render=$e,p.staticRenderFns=r,p._compiled=!0),O&&(p.functional=!0),t&&(p._scopeId="data-v-"+t);var e;if(d?(e=function(s){s=s||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!s&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(s=__VUE_SSR_CONTEXT__),B&&B.call(this,s),s&&s._registeredComponents&&s._registeredComponents.add(d)},p._ssrRegister=e):B&&(e=m?function(){B.call(this,(p.functional?this.parent:this).$root.$options.shadowRoot)}:B),e)if(p.functional){p._injectStyles=e;var f=p.render;p.render=function(l,o){return e.call(o),f(l,o)}}else{var u=p.beforeCreate;p.beforeCreate=u?[].concat(u,e):[e]}return{exports:et,options:p}}const Kd={};typeof window!="undefined"&&(Kd.resize=require("vue-resize-directive"));const qm={name:"plotly",inheritAttrs:!1,directives:Kd,props:{data:{type:Array},layout:{type:Object},id:{type:String,required:!1,default:null}},data(){return{scheduled:null,innerLayout:Nf({},this.layout)}},mounted(){Yl.newPlot(this.$el,this.data,this.innerLayout,this.options),Zd.forEach(et=>{this.$el.on(et.completeName,et.handler(this))})},watch:{data:{handler(){this.schedule({replot:!0})},deep:!0},options:{handler(et,$e){JSON.stringify(et)!==JSON.stringify($e)&&this.schedule({replot:!0})},deep:!0},layout(et){this.innerLayout=Nf({},et),this.schedule({replot:!1})}},computed:{options(){const et=Object.keys(this.$attrs).reduce(($e,r)=>($e[Um(r)]=this.$attrs[r],$e),{});return Nf({responsive:!1},et)}},beforeDestroy(){Zd.forEach(et=>this.$el.removeAllListeners(et.completeName)),Yl.purge(this.$el)},methods:Dm(Nf({},Bm),{onResize(){Yl.Plots.resize(this.$el)},schedule(et){const{scheduled:$e}=this;if($e){$e.replot=$e.replot||et.replot;return}this.scheduled=et,this.$nextTick(()=>{const{scheduled:{replot:r}}=this;if(this.scheduled=null,r){this.react();return}this.relayout(this.innerLayout)})},toImage(et){const $e=Object.assign(this.getPrintOptions(),et);return Yl.toImage(this.$el,$e)},downloadImage(et){const $e=`plot--${new Date().toISOString()}`,r=Object.assign(this.getPrintOptions(),{filename:$e},et);return Yl.downloadImage(this.$el,r)},getPrintOptions(){const{$el:et}=this;return{format:"png",width:et.clientWidth,height:et.clientHeight}},react(){Yl.react(this.$el,this.data,this.innerLayout,this.options)}})},Jd={};var Ym=Gm(qm,Vm,Hm,!1,Wm,null,null,null);function Wm(et){for(let $e in Jd)this[$e]=Jd[$e]}var $d=function(){return Ym.exports}();function Wl(et={},$e={},r={},O=!1){return{name:et.name,mixins:[Uu],props:{plotlyOptions:{type:Object,default:function(){return{}}}},render(t){const d=new Ps(this.$props),m=d.getRowKeys(),p=d.getColKeys(),e=O?p:m;e.length===0&&e.push([]);const f=O?m:p;f.length===0&&f.push([]);let u=this.$props.aggregatorName;const s=uu[u]([])().numInputs||0;s!==0&&(u+=` of ${this.$props.vals.slice(0,s).join(", ")}`);const l=e.map(a=>{const g=[],h=[];for(const v of f){const _=parseFloat(d.getAggregator(O?v:a,O?a:v).value());g.push(isFinite(_)?_:null),h.push(v.join("-")||" ")}const y={name:a.join("-")||u};return $e.type==="pie"?(y.values=g,y.labels=h.length>1?h:[u]):(y.x=O?g:h,y.y=O?h:g),Object.assign(y,$e)});let o=u;const i=O?this.$props.rows.join("-"):this.$props.cols.join("-"),c=O?this.$props.cols.join("-"):this.$props.rows.join("-");i!==""&&(o+=` vs ${i}`),c!==""&&(o+=` by ${c}`);const n={title:o,hovermode:"closest",width:window.innerWidth/1.5,height:window.innerHeight/1.4-50};if($e.type==="pie"){const a=Math.ceil(Math.sqrt(l.length)),g=Math.ceil(l.length/a);n.grid={columns:a,rows:g},l.forEach((h,y)=>{h.domain={row:Math.floor(y/a),column:y-a*Math.floor(y/a)},l.length>1&&(h.title=h.name)}),l[0].labels.length===1&&(n.showlegend=!1)}else n.xaxis={title:O?u:null,automargin:!0},n.yaxis={title:O?null:u,automargin:!0};return t($d,{props:{data:l,layout:ul(ul(ul({},n),r),this.$props.plotlyOptions)}})}}}function Xm(et={}){return{name:et.name,mixins:[Uu],props:{plotlyOptions:{type:Object,default:function(){return{}}}},render(r){const O=new Ps(this.$props),B=O.getRowKeys(),t=O.getColKeys();B.length===0&&B.push([]),t.length===0&&t.push([]);const d={x:[],y:[],text:[],type:"scatter",mode:"markers"};B.map(p=>{t.map(e=>{const f=O.getAggregator(p,e).value();f!==null&&(d.x.push(e.join("-")),d.y.push(p.join("-")),d.text.push(f))})});const m={title:this.$props.rows.join("-")+" vs "+this.$props.cols.join("-"),hovermode:"closest",xaxis:{title:this.$props.cols.join("-"),automargin:!0},yaxis:{title:this.$props.rows.join("-"),automargin:!0},width:window.innerWidth/1.5,height:window.innerHeight/1.4-50};return r($d,{props:{data:[d],layout:ul(ul({},m),this.$props.plotlyOptions)}})}}}var Qd={"Grouped Column Chart":Wl({name:"vue-grouped-column-chart"},{type:"bar"},{barmode:"group"}),"Stacked Column Chart":Wl({name:"vue-stacked-column-chart"},{type:"bar"},{barmode:"relative"}),"Grouped Bar Chart":Wl({name:"groupd-bar-chart"},{type:"bar",orientation:"h"},{barmode:"group"},!0),"Stacked Bar Chart":Wl({name:"vue-stacked-bar-chart"},{type:"bar",orientation:"h"},{barmode:"relative"},!0),"Line Chart":Wl({name:"vue-line-chart"},{connectgaps:!0}),"Dot Chart":Wl({name:"vue-dot-chart"},{mode:"markers"},{},!0),"Area Chart":Wl({name:"vue-area-chart"},{stackgroup:1}),"Scatter Chart":Xm({name:"vue-scatter-chart"}),"Multiple Pie Chart":Wl({name:"vue-multiple-pie-chart"},{type:"pie",scalegroup:1,hoverinfo:"label+value",textinfo:"none"},{},!0)},e0={name:"vue-pivottable-ui",mixins:[Uu],props:{hiddenAttributes:{type:Array,default:function(){return[]}},hiddenFromAggregators:{type:Array,default:function(){return[]}},hiddenFromDragDrop:{type:Array,default:function(){return[]}},sortonlyFromDragDrop:{type:Array,default:function(){return[]}},disabledFromDragDrop:{type:Array,default:function(){return[]}},rowLimit:{type:Number,default:0},colLimit:{type:Number,default:0},menuLimit:{type:Number,default:500}},computed:{rendererItems(){return Object.assign({},bf,Qd)},numValsAllowed(){return uu[this.propsData.aggregatorName||this.aggregatorName]([])().numInputs||0},rowAttrs(){return this.propsData.rows.filter(et=>!this.hiddenAttributes.includes(et)&&!this.hiddenFromDragDrop.includes(et))},colAttrs(){return this.propsData.cols.filter(et=>!this.hiddenAttributes.includes(et)&&!this.hiddenFromDragDrop.includes(et))},unusedAttrs(){return this.propsData.attributes.filter(et=>!this.propsData.rows.includes(et)&&!this.propsData.cols.includes(et)&&!this.hiddenAttributes.includes(et)&&!this.hiddenFromDragDrop.includes(et)).sort(Td(this.unusedOrder))},config(){return{derivedAttributes:this.derivedAttributes,hiddenAttributes:this.hiddenAttributes,hiddenFromAggregators:[],hiddenFromDragDrop:[],menuLimit:500,cols:["Party"],rows:["Province"],vals:[],rowOrder:"key_a_to_z",colOrder:"key_a_to_z",exclusions:{},inclusions:{},unusedAttrsVertical:85,autoSortUnusedAttrs:!1,showUI:!0,sorters:{},inclusionsInfo:{},aggregatorName:"Count",rendererName:"Table"}}},data(){return{propsData:{aggregatorName:"",rendererName:"",rowOrder:"key_a_to_z",colOrder:"key_a_to_z",vals:[],cols:[],rows:[],attributes:[],valueFilter:{},renderer:null},pivotData:[],openStatus:{},attrValues:{},unusedOrder:[],zIndices:{},maxZIndex:1e3,openDropdown:!1,materializedInput:[],sortIcons:{key_a_to_z:{rowSymbol:"\u2195",colSymbol:"\u2194",next:"value_a_to_z"},value_a_to_z:{rowSymbol:"\u2193",colSymbol:"\u2192",next:"value_z_to_a"},value_z_to_a:{rowSymbol:"\u2191",colSymbol:"\u2190",next:"key_a_to_z"}}}},beforeUpdated(et){this.materializeInput(et.data)},watch:{data:{handler(et){this.init()},immediate:!0,deep:!0},attributes:{handler(et){this.propsData.attributes=et.length>0?et:Object.keys(this.attrValues)},deep:!0},propsData:{handler(et){if(this.pivotData.length===0)return;const $e=gf(ul({},this.$props),{data:this.materializedInput,rowOrder:et.rowOrder,colOrder:et.colOrder,valueFilter:et.valueFilter,rows:et.rows,cols:et.cols,rendererName:et.rendererName,aggregatorName:this.aggregatorName,vals:this.vals});this.$emit("onRefresh",$e)},immediate:!1,deep:!0}},methods:{init(){this.materializeInput(this.data),this.propsData.vals=this.vals.slice(),this.propsData.rows=this.rows,this.propsData.cols=this.cols,this.propsData.attributes=this.attributes.length>0?this.attributes:Object.keys(this.attrValues),this.unusedOrder=this.unusedAttrs,Object.keys(this.attrValues).map(this.assignValue),Object.keys(this.openStatus).map(this.assignValue),this.propsData.colOrder=this.colOrder,this.propsData.rowOrder=this.rowOrder,this.propsData.valueFilter=this.valueFilter},assignValue(et){this.$set(this.propsData.valueFilter,et,{})},propUpdater(et){return $e=>{this.propsData[et]=$e}},updateValueFilter({attribute:et,valueFilter:$e}){this.$set(this.propsData.valueFilter,et,$e)},moveFilterBoxToTop({attribute:et}){this.maxZIndex+=1,this.zIndices[et]=this.maxZIndex+1},openFilterBox({attribute:et,open:$e}){this.openStatus[et]=$e},materializeInput(et){if(this.pivotData===et)return;this.pivotData=et;const $e={},r=[];let O=0;Ps.forEachRecord(this.data,this.derivedAttributes,function(B){r.push(B);for(const t of Object.keys(B))t in $e||($e[t]={},O>0&&($e[t].null=O));for(const t in $e){const d=t in B?B[t]:"null";d in $e[t]||($e[t][d]=0),$e[t][d]++}O++}),this.materializedInput=r,this.attrValues=$e},makeDnDCell(et,$e,r,O){const B=this.$scopedSlots.pvtAttr;return O(Em,{attrs:{draggable:"li[data-id]",group:"sharted",ghostClass:".pvtPlaceholder",filter:".pvtFilterBox",preventOnFilter:!1,tag:"td"},props:{value:et},staticClass:r,on:{sort:$e.bind(this)}},[et.map(t=>O(Gg,{[B?"scopedSlots":void 0]:{pvtAttr:d=>O("slot",B(d))},props:{sortable:this.sortonlyFromDragDrop.includes(t)||!this.disabledFromDragDrop.includes(t),draggable:!this.sortonlyFromDragDrop.includes(t)&&!this.disabledFromDragDrop.includes(t),name:t,key:t,attrValues:this.attrValues[t],sorter:yf(this.sorters,t),menuLimit:this.menuLimit,zIndex:this.zIndices[t]||this.maxZIndex,valueFilter:this.propsData.valueFilter[t],open:this.openStatus[t],unused:this.unusedAttrs.includes(t)},domProps:{},on:{"update:filter":this.updateValueFilter,"moveToTop:filterbox":this.moveFilterBoxToTop,"open:filterbox":this.openFilterBox}}))])},rendererCell(et,$e){return this.$slots.rendererCell?$e("td",{staticClass:["pvtRenderers pvtVals pvtText"]},this.$slots.rendererCell):$e("td",{staticClass:["pvtRenderers"]},[$e(Ah,{props:{values:Object.keys(this.rendererItems)},domProps:{value:et},on:{input:r=>{this.propUpdater("rendererName")(r),this.propUpdater("renderer",this.rendererItems[r])}}})])},aggregatorCell(et,$e,r){return this.$slots.aggregatorCell?r("td",{staticClass:["pvtVals pvtText"]},this.$slots.aggregatorCell):r("td",{staticClass:["pvtVals"]},[r("div",[r(Ah,{style:{display:"inline-block"},props:{values:Object.keys(uu)},domProps:{value:et},on:{input:O=>{this.propUpdater("aggregatorName")(O)}}}),r("a",{staticClass:["pvtRowOrder"],attrs:{role:"button"},on:{click:()=>{this.propUpdater("rowOrder")(this.sortIcons[this.propsData.rowOrder].next)}}},this.sortIcons[this.propsData.rowOrder].rowSymbol),r("a",{staticClass:["pvtColOrder"],attrs:{role:"button"},on:{click:()=>{this.propUpdater("colOrder")(this.sortIcons[this.propsData.colOrder].next)}}},this.sortIcons[this.propsData.colOrder].colSymbol)]),this.numValsAllowed>0?new Array(this.numValsAllowed).fill().map((O,B)=>[r(Ah,{props:{values:Object.keys(this.attrValues).filter(t=>!this.hiddenAttributes.includes(t)&&!this.hiddenFromAggregators.includes(t))},domProps:{value:$e[B]},on:{input:t=>{this.propsData.vals.splice(B,1,t)}}})]):void 0])},outputCell(et,$e,r){return r("td",{staticClass:["pvtOutput"]},[$e?r(Qd[et.rendererName],{props:et}):r(_f,{props:gf(ul({},et),{tableMaxWidth:this.tableMaxWidth})})])}},render(et){if(this.data.length<1)return;const $e=this.$scopedSlots.output,r=this.$slots.output,O=this.propsData.rendererName||this.rendererName,B=this.propsData.aggregatorName||this.aggregatorName,t=this.propsData.vals,d=this.makeDnDCell(this.unusedAttrs,i=>{const c=i.item.getAttribute("data-id");this.sortonlyFromDragDrop.includes(c)&&(!i.from.classList.contains("pvtUnused")||!i.to.classList.contains("pvtUnused"))||(i.from.classList.contains("pvtUnused")&&this.unusedOrder.splice(i.oldIndex,1),i.to.classList.contains("pvtUnused")&&this.unusedOrder.splice(i.newIndex,0,c))},"pvtAxisContainer pvtUnused pvtHorizList",et),m=this.makeDnDCell(this.colAttrs,i=>{const c=i.item.getAttribute("data-id");this.sortonlyFromDragDrop.includes(c)&&(!i.from.classList.contains("pvtCols")||!i.to.classList.contains("pvtCols"))||(i.from.classList.contains("pvtCols")&&this.propsData.cols.splice(i.oldIndex,1),i.to.classList.contains("pvtCols")&&this.propsData.cols.splice(i.newIndex,0,c))},"pvtAxisContainer pvtHorizList pvtCols",et),p=this.makeDnDCell(this.rowAttrs,i=>{const c=i.item.getAttribute("data-id");this.sortonlyFromDragDrop.includes(c)&&(!i.from.classList.contains("pvtRows")||!i.to.classList.contains("pvtRows"))||(i.from.classList.contains("pvtRows")&&this.propsData.rows.splice(i.oldIndex,1),i.to.classList.contains("pvtRows")&&this.propsData.rows.splice(i.newIndex,0,c))},"pvtAxisContainer pvtVertList pvtRows",et),e=gf(ul({},this.$props),{data:this.materializedInput,rowOrder:this.propsData.rowOrder,colOrder:this.propsData.colOrder,valueFilter:this.propsData.valueFilter,rows:this.propsData.rows,cols:this.propsData.cols,rendererName:O,aggregatorName:B,vals:t}),f=new Ps(e),u=$e&&this.colLimit>0&&this.rowLimit>0&&(f.getColKeys().length>this.colLimit||f.getRowKeys().length>this.rowLimit),s=this.rendererCell(O,et),l=this.aggregatorCell(B,t,et),o=this.outputCell(e,O.indexOf("Chart")>-1,et);return et("table",{staticClass:["pvtUi"]},[et("tbody",[et("tr",[s,d]),et("tr",[l,m]),et("tr",[p,r?et("td",{staticClass:"pvtOutput"},r):void 0,$e&&u?et("td",{staticClass:"pvtOutput"},$e({pivotData:new Ps(e)})):void 0,!r&&!u&&o])])])}};const Zm={aggregatorTemplates:bo,aggregators:uu,derivers:Ug,locales:Bg,naturalSort:su,numberFormat:mf,getSort:yf,sortAs:Td,PivotData:Ps},Yh={VuePivottable:_f,VuePivottableUi:e0};typeof window!="undefined"&&window.Vue&&window.Vue.use(_f);const Km=et=>{for(const $e in Yh)et.component(Yh[$e].name,Yh[$e])};exports.PivotUtilities=Zm;exports.VuePivottable=_f;exports.VuePivottableUi=e0;exports.addVueGlobalUse=Km;
