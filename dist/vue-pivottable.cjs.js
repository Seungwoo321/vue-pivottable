"use strict";var Ng=Object.defineProperty,jg=Object.defineProperties;var Ug=Object.getOwnPropertyDescriptors;var _d=Object.getOwnPropertySymbols;var Vg=Object.prototype.hasOwnProperty,Hg=Object.prototype.propertyIsEnumerable;var wd=(Je,Qe,r)=>Qe in Je?Ng(Je,Qe,{enumerable:!0,configurable:!0,writable:!0,value:r}):Je[Qe]=r,ul=(Je,Qe)=>{for(var r in Qe||(Qe={}))Vg.call(Qe,r)&&wd(Je,r,Qe[r]);if(_d)for(var r of _d(Qe))Hg.call(Qe,r)&&wd(Je,r,Qe[r]);return Je},gf=(Je,Qe)=>jg(Je,Ug(Qe));Object.defineProperty(exports,"__esModule",{value:!0});exports[Symbol.toStringTag]="Module";const Gg=function(Je,Qe,r){const I=String(Je).split(".");let B=I[0];const t=I.length>1?r+I[1]:"",d=/(\d+)(\d{3})/;for(;d.test(B);)B=B.replace(d,`$1${Qe}$2`);return B+t},mf=function(Je){const r=Object.assign({},{digitsAfterDecimal:2,scaler:1,thousandsSep:",",decimalSep:".",prefix:"",suffix:""},Je);return function(I){if(isNaN(I)||!isFinite(I))return"";const B=Gg((r.scaler*I).toFixed(r.digitsAfterDecimal),r.thousandsSep,r.decimalSep);return`${r.prefix}${B}${r.suffix}`}},Td=/(\d+)|(\D+)/g,vf=/\d/,kd=/^0/,su=(Je,Qe)=>{if(Qe!==null&&Je===null)return-1;if(Je!==null&&Qe===null)return 1;if(typeof Je=="number"&&isNaN(Je))return-1;if(typeof Qe=="number"&&isNaN(Qe))return 1;const r=Number(Je),I=Number(Qe);if(r<I)return-1;if(r>I)return 1;if(typeof Je=="number"&&typeof Qe!="number")return-1;if(typeof Qe=="number"&&typeof Je!="number")return 1;if(typeof Je=="number"&&typeof Qe=="number")return 0;if(isNaN(I)&&!isNaN(r))return-1;if(isNaN(r)&&!isNaN(I))return 1;let B=String(Je),t=String(Qe);if(B===t)return 0;if(!vf.test(B)||!vf.test(t))return B>t?1:-1;for(B=B.match(Td),t=t.match(Td);B.length&&t.length;){const d=B.shift(),m=t.shift();if(d!==m)return vf.test(d)&&vf.test(m)?d.replace(kd,".0")-m.replace(kd,".0"):d>m?1:-1}return B.length-t.length},Ad=function(Je){const Qe={},r={};for(const I in Je){const B=Je[I];Qe[B]=I,typeof B=="string"&&(r[B.toLowerCase()]=I)}return function(I,B){return I in Qe&&B in Qe?Qe[I]-Qe[B]:I in Qe?-1:B in Qe?1:I in r&&B in r?r[I]-r[B]:I in r?-1:B in r?1:su(I,B)}},yf=function(Je,Qe){if(Je){if(typeof Je=="function"){const r=Je(Qe);if(typeof r=="function")return r}else if(Qe in Je)return Je[Qe]}return su},ks=mf(),gc=mf({digitsAfterDecimal:0}),lu=mf({digitsAfterDecimal:1,scaler:100,suffix:"%"}),bo={count(Je=gc){return()=>function(){return{count:0,push(){this.count++},value(){return this.count},format:Je}}},uniques(Je,Qe=gc){return function([r]){return function(){return{uniq:[],push(I){Array.from(this.uniq).includes(I[r])||this.uniq.push(I[r])},value(){return Je(this.uniq)},format:Qe,numInputs:typeof r!="undefined"?0:1}}}},sum(Je=ks){return function([Qe]){return function(){return{sum:0,push(r){isNaN(parseFloat(r[Qe]))||(this.sum+=parseFloat(r[Qe]))},value(){return this.sum},format:Je,numInputs:typeof Qe!="undefined"?0:1}}}},extremes(Je,Qe=ks){return function([r]){return function(I){return{val:null,sorter:yf(typeof I!="undefined"?I.sorters:null,r),push(B){let t=B[r];["min","max"].includes(Je)&&(t=parseFloat(t),isNaN(t)||(this.val=Math[Je](t,this.val!==null?this.val:t))),Je==="first"&&this.sorter(t,this.val!==null?this.val:t)<=0&&(this.val=t),Je==="last"&&this.sorter(t,this.val!==null?this.val:t)>=0&&(this.val=t)},value(){return this.val},format(B){return isNaN(B)?B:Qe(B)},numInputs:typeof r!="undefined"?0:1}}}},quantile(Je,Qe=ks){return function([r]){return function(){return{vals:[],push(I){const B=parseFloat(I[r]);isNaN(B)||this.vals.push(B)},value(){if(this.vals.length===0)return null;this.vals.sort((B,t)=>B-t);const I=(this.vals.length-1)*Je;return(this.vals[Math.floor(I)]+this.vals[Math.ceil(I)])/2},format:Qe,numInputs:typeof r!="undefined"?0:1}}}},runningStat(Je="mean",Qe=1,r=ks){return function([I]){return function(){return{n:0,m:0,s:0,push(B){const t=parseFloat(B[I]);if(isNaN(t))return;this.n+=1,this.n===1&&(this.m=t);const d=this.m+(t-this.m)/this.n;this.s=this.s+(t-this.m)*(t-d),this.m=d},value(){if(Je==="mean")return this.n===0?0/0:this.m;if(this.n<=Qe)return 0;switch(Je){case"var":return this.s/(this.n-Qe);case"stdev":return Math.sqrt(this.s/(this.n-Qe));default:throw new Error("unknown mode for runningStat")}},format:r,numInputs:typeof I!="undefined"?0:1}}}},sumOverSum(Je=ks){return function([Qe,r]){return function(){return{sumNum:0,sumDenom:0,push(I){isNaN(parseFloat(I[Qe]))||(this.sumNum+=parseFloat(I[Qe])),isNaN(parseFloat(I[r]))||(this.sumDenom+=parseFloat(I[r]))},value(){return this.sumNum/this.sumDenom},format:Je,numInputs:typeof Qe!="undefined"&&typeof r!="undefined"?0:2}}}},fractionOf(Je,Qe="total",r=lu){return(...I)=>function(B,t,d){return{selector:{total:[[],[]],row:[t,[]],col:[[],d]}[Qe],inner:Je(...Array.from(I||[]))(B,t,d),push(m){this.inner.push(m)},format:r,value(){return this.inner.value()/B.getAggregator(...Array.from(this.selector||[])).inner.value()},numInputs:Je(...Array.from(I||[]))().numInputs}}}};bo.countUnique=Je=>bo.uniques(Qe=>Qe.length,Je);bo.listUnique=Je=>bo.uniques(Qe=>Qe.join(Je),Qe=>Qe);bo.max=Je=>bo.extremes("max",Je);bo.min=Je=>bo.extremes("min",Je);bo.first=Je=>bo.extremes("first",Je);bo.last=Je=>bo.extremes("last",Je);bo.median=Je=>bo.quantile(.5,Je);bo.average=Je=>bo.runningStat("mean",1,Je);bo.var=(Je,Qe)=>bo.runningStat("var",Je,Qe);bo.stdev=(Je,Qe)=>bo.runningStat("stdev",Je,Qe);const uu=(Je=>({Count:Je.count(gc),"Count Unique Values":Je.countUnique(gc),"List Unique Values":Je.listUnique(", "),Sum:Je.sum(ks),"Integer Sum":Je.sum(gc),Average:Je.average(ks),Median:Je.median(ks),"Sample Variance":Je.var(1,ks),"Sample Standard Deviation":Je.stdev(1,ks),Minimum:Je.min(ks),Maximum:Je.max(ks),First:Je.first(ks),Last:Je.last(ks),"Sum over Sum":Je.sumOverSum(ks),"Sum as Fraction of Total":Je.fractionOf(Je.sum(),"total",lu),"Sum as Fraction of Rows":Je.fractionOf(Je.sum(),"row",lu),"Sum as Fraction of Columns":Je.fractionOf(Je.sum(),"col",lu),"Count as Fraction of Total":Je.fractionOf(Je.count(),"total",lu),"Count as Fraction of Rows":Je.fractionOf(Je.count(),"row",lu),"Count as Fraction of Columns":Je.fractionOf(Je.count(),"col",lu)}))(bo),qg={en:{aggregators:uu,localeStrings:{renderError:"An error occurred rendering the PivotTable results.",computeError:"An error occurred computing the PivotTable results.",uiRenderError:"An error occurred rendering the PivotTable UI.",selectAll:"Select All",selectNone:"Select None",tooMany:"(too many to list)",filterResults:"Filter values",apply:"Apply",cancel:"Cancel",totals:"Totals",vs:"vs",by:"by"}}},Yg=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Wg=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],mc=Je=>`0${Je}`.substr(-2,2),Xg={bin(Je,Qe){return r=>r[Je]-r[Je]%Qe},dateFormat(Je,Qe,r=!1,I=Yg,B=Wg){const t=r?"UTC":"";return function(d){const m=new Date(Date.parse(d[Je]));return isNaN(m)?"":Qe.replace(/%(.)/g,function(h,e){switch(e){case"y":return m[`get${t}FullYear`]();case"m":return mc(m[`get${t}Month`]()+1);case"n":return I[m[`get${t}Month`]()];case"d":return mc(m[`get${t}Date`]());case"w":return B[m[`get${t}Day`]()];case"x":return m[`get${t}Day`]();case"H":return mc(m[`get${t}Hours`]());case"M":return mc(m[`get${t}Minutes`]());case"S":return mc(m[`get${t}Seconds`]());default:return`%${e}`}})}}};class Ps{constructor(Qe={}){this.props=Object.assign({},Ps.defaultProps,Qe),this.aggregator=this.props.aggregators[this.props.aggregatorName](this.props.vals),this.tree={},this.rowKeys=[],this.colKeys=[],this.rowTotals={},this.colTotals={},this.allTotal=this.aggregator(this,[],[]),this.sorted=!1,this.filteredData=[],Ps.forEachRecord(this.props.data,this.props.derivedAttributes,r=>{this.filter(r)&&(this.filteredData.push(r),this.processRecord(r))})}filter(Qe){for(const r in this.props.valueFilter)if(Qe[r]in this.props.valueFilter[r])return!1;return!0}forEachMatchingRecord(Qe,r){return Ps.forEachRecord(this.props.data,this.props.derivedAttributes,I=>{if(!!this.filter(I)){for(const B in Qe)if(Qe[B]!==(B in I?I[B]:"null"))return;r(I)}})}arrSort(Qe){let r;const I=(()=>{const B=[];for(r of Array.from(Qe))B.push(yf(this.props.sorters,r));return B})();return function(B,t){for(const d of Object.keys(I||{})){const h=I[d](B[d],t[d]);if(h!==0)return h}return 0}}sortKeys(){if(!this.sorted){this.sorted=!0;const Qe=(r,I)=>this.getAggregator(r,I).value();switch(this.props.rowOrder){case"value_a_to_z":this.rowKeys.sort((r,I)=>su(Qe(r,[]),Qe(I,[])));break;case"value_z_to_a":this.rowKeys.sort((r,I)=>-su(Qe(r,[]),Qe(I,[])));break;default:this.rowKeys.sort(this.arrSort(this.props.rows))}switch(this.props.colOrder){case"value_a_to_z":this.colKeys.sort((r,I)=>su(Qe([],r),Qe([],I)));break;case"value_z_to_a":this.colKeys.sort((r,I)=>-su(Qe([],r),Qe([],I)));break;default:this.colKeys.sort(this.arrSort(this.props.cols))}}}getFilteredData(){return this.filteredData}getColKeys(){return this.sortKeys(),this.colKeys}getRowKeys(){return this.sortKeys(),this.rowKeys}processRecord(Qe){const r=[],I=[];for(const d of Array.from(this.props.cols))r.push(d in Qe?Qe[d]:"null");for(const d of Array.from(this.props.rows))I.push(d in Qe?Qe[d]:"null");const B=I.join(String.fromCharCode(0)),t=r.join(String.fromCharCode(0));this.allTotal.push(Qe),I.length!==0&&(this.rowTotals[B]||(this.rowKeys.push(I),this.rowTotals[B]=this.aggregator(this,I,[])),this.rowTotals[B].push(Qe)),r.length!==0&&(this.colTotals[t]||(this.colKeys.push(r),this.colTotals[t]=this.aggregator(this,[],r)),this.colTotals[t].push(Qe)),r.length!==0&&I.length!==0&&(this.tree[B]||(this.tree[B]={}),this.tree[B][t]||(this.tree[B][t]=this.aggregator(this,I,r)),this.tree[B][t].push(Qe))}getAggregator(Qe,r){let I;const B=Qe.join(String.fromCharCode(0)),t=r.join(String.fromCharCode(0));return Qe.length===0&&r.length===0?I=this.allTotal:Qe.length===0?I=this.colTotals[t]:r.length===0?I=this.rowTotals[B]:I=this.tree[B][t],I||{value(){return null},format(){return""}}}}Ps.forEachRecord=function(Je,Qe,r){let I,B;if(Object.getOwnPropertyNames(Qe).length===0?I=r:I=function(t){for(const d in Qe){const m=Qe[d](t);m!==null&&(t[d]=m)}return r(t)},typeof Je=="function")return Je(I);if(Array.isArray(Je))return Array.isArray(Je[0])?(()=>{const t=[];for(const d of Object.keys(Je||{})){const m=Je[d];if(d>0){B={};for(const h of Object.keys(Je[0]||{})){const e=Je[0][h];B[e]=m[h]}t.push(I(B))}}return t})():(()=>{const t=[];for(B of Array.from(Je))t.push(I(B));return t})();throw new Error("unknown input format")};Ps.defaultProps={aggregators:uu,cols:[],rows:[],vals:[],aggregatorName:"Count",sorters:{},valueFilter:{},rowOrder:"key_a_to_z",colOrder:"key_a_to_z",derivedAttributes:{}};var Uu={props:{data:{type:[Array,Object,Function],required:!0},aggregators:{type:Object,default:function(){return uu}},aggregatorName:String,cols:{type:Array,default:function(){return[]}},heatmapMode:String,tableColorScaleGenerator:{type:Function},tableOptions:{type:Object,default:function(){return{}}},renderers:Function,rendererName:{type:String,default:"Table"},rowTotal:{type:Boolean,default:!0},colTotal:{type:Boolean,default:!0},rows:{type:Array,default:function(){return[]}},vals:{type:Array,default:function(){return[]}},attributes:{type:Array,default:function(){return[]}},valueFilter:{type:Object,default:function(){return{}}},sorters:{type:[Function,Object],default:function(){return{}}},derivedAttributes:{type:[Function,Object],default:function(){return{}}},rowOrder:{type:String,default:"key_a_to_z",validator:function(Je){return["key_a_to_z","value_a_to_z","value_z_to_a"].indexOf(Je)!==-1}},colOrder:{type:String,default:"key_a_to_z",validator:function(Je){return["key_a_to_z","value_a_to_z","value_z_to_a"].indexOf(Je)!==-1}},tableMaxWidth:{type:Number,default:0,validator:function(Je){return Je>=0}}}};function Zg(Je){const Qe=Math.min.apply(Math,Je),r=Math.max.apply(Math,Je);return I=>{const B=255-Math.round(255*(I-Qe)/(r-Qe));return{backgroundColor:`rgb(255,${B},${B})`}}}function xf(Je={}){return{name:Je.name,mixins:[Uu],props:{heatmapMode:String,tableColorScaleGenerator:{type:Function,default:Zg},tableOptions:{type:Object,default:function(){return{}}}},methods:{spanSize(r,I,B){let t;if(I!==0){let m,h,e=!0;for(t=0,h=B,m=h>=0;m?t<=h:t>=h;m?t++:t--)r[I-1][t]!==r[I][t]&&(e=!1);if(e)return-1}let d=0;for(;I+d<r.length;){let m,h,e=!1;for(t=0,h=B,m=h>=0;m?t<=h:t>=h;m?t++:t--)r[I][t]!==r[I+d][t]&&(e=!0);if(e)break;d++}return d}},render(r){const I=new Ps(this.$props),B=I.props.cols,t=I.props.rows,d=I.getRowKeys(),m=I.getColKeys(),h=I.getAggregator([],[]);let e=()=>{},f=()=>{},l=()=>{};if(Je.heatmapMode){const u=this.tableColorScaleGenerator,s=m.map(c=>I.getAggregator([],c).value());f=u(s);const i=d.map(c=>I.getAggregator(c,[]).value());if(l=u(i),Je.heatmapMode==="full"){const c=[];d.map(a=>m.map(g=>c.push(I.getAggregator(a,g).value())));const n=u(c);e=(a,g,p)=>n(p)}else if(Je.heatmapMode==="row"){const c={};d.map(n=>{const a=m.map(g=>I.getAggregator(n,g).value());c[n]=u(a)}),e=(n,a,g)=>c[n](g)}else if(Je.heatmapMode==="col"){const c={};m.map(n=>{const a=d.map(g=>I.getAggregator(g,n).value());c[n]=u(a)}),e=(n,a,g)=>c[a](g)}}const o=this.tableOptions&&this.tableOptions.clickCallback?(u,s,i)=>{const c={};for(const n of Object.keys(B||{})){const a=B[n];i[n]!==null&&(c[a]=i[n])}for(const n of Object.keys(t||{})){const a=t[n];s[n]!==null&&(c[a]=s[n])}return n=>this.tableOptions.clickCallback(n,u,c,I)}:null;return r("table",{staticClass:["pvtTable"]},[r("thead",[B.map((u,s)=>r("tr",{attrs:{key:`colAttrs${s}`}},[s===0&&t.length!==0?r("th",{attrs:{colSpan:t.length,rowSpan:B.length}}):void 0,r("th",{staticClass:["pvtAxisLabel"]},u),m.map((i,c)=>{const n=this.spanSize(m,c,s);return n===-1?null:r("th",{staticClass:["pvtColLabel"],attrs:{key:`colKey${c}`,colSpan:n,rowSpan:s===B.length-1&&t.length!==0?2:1}},i[s])}),s===0&&this.rowTotal?r("th",{staticClass:["pvtTotalLabel"],attrs:{rowSpan:B.length+(t.length===0?0:1)}},"Totals"):void 0])),t.length!==0?r("tr",[t.map((u,s)=>r("th",{staticClass:["pvtAxisLabel"],attrs:{key:`rowAttr${s}`}},u)),this.rowTotal?r("th",{staticClass:["pvtTotalLabel"]},B.length===0?"Totals":null):B.length===0?void 0:r("th",{staticClass:["pvtTotalLabel"]},null)]):void 0]),r("tbody",[d.map((u,s)=>{const i=I.getAggregator(u,[]);return r("tr",{attrs:{key:`rowKeyRow${s}`}},[u.map((c,n)=>{const a=this.spanSize(d,s,n);return a===-1?null:r("th",{staticClass:["pvtRowLabel"],attrs:{key:`rowKeyLabel${s}-${n}`,rowSpan:a,colSpan:n===t.length-1&&B.length!==0?2:1}},c)}),m.map((c,n)=>{const a=I.getAggregator(u,c);return r("td",{staticClass:["pvVal"],style:e(u,c,a.value()),attrs:{key:`pvtVal${s}-${n}`},on:o?{click:o(a.value(),u,c)}:{}},a.format(a.value()))}),this.rowTotal?r("td",{staticClass:["pvtTotal"],style:l(i.value()),on:o?{click:o(i.value(),u,[null])}:{}},i.format(i.value())):void 0])}),r("tr",[this.colTotal?r("th",{staticClass:["pvtTotalLabel"],attrs:{colSpan:t.length+(B.length===0?0:1)}},"Totals"):void 0,this.colTotal?m.map((u,s)=>{const i=I.getAggregator([],u);return r("td",{staticClass:["pvtTotal"],style:f(i.value()),attrs:{key:`total${s}`},on:o?{click:o(i.value(),[null],u)}:{}},i.format(i.value()))}):void 0,this.colTotal&&this.rowTotal?r("td",{staticClass:["pvtGrandTotal"],on:o?{click:o(h.value(),[null],[null])}:{}},h.format(h.value())):void 0])])])}}}const Kg={name:"tsv-export-renderers",mixins:[Uu],render(Je){const Qe=new Ps(this.$props),r=Qe.getRowKeys(),I=Qe.getColKeys();r.length===0&&r.push([]),I.length===0&&I.push([]);const B=Qe.props.rows.map(d=>d);I.length===1&&I[0].length===0?B.push(this.aggregatorName):I.map(d=>B.push(d.join("-")));const t=r.map(d=>{const m=d.map(h=>h);return I.map(h=>{const e=Qe.getAggregator(d,h).value();m.push(e||"")}),m});return t.unshift(B),Je("textarea",{style:{width:"100%",height:`${window.innerHeight/2}px`},attrs:{readOnly:!0},domProps:{value:t.map(d=>d.join("	")).join(`
`)}})}};var bf={Table:xf({name:"vue-table"}),"Table Heatmap":xf({heatmapMode:"full",name:"vue-table-heatmap"}),"Table Col Heatmap":xf({heatmapMode:"col",name:"vue-table-col-heatmap"}),"Table Row Heatmap":xf({heatmapMode:"row",name:"vue-table-col-heatmap"}),"Expor Table TSV":Kg},_f={name:"vue-pivottable",mixins:[Uu],computed:{defaultRenderers(){return bf[this.rendererName in bf?this.rendererName:Object.keys(bf)[0]]}},methods:{createPivottable(Je){const Qe=this.$props;return Je(this.renderers||this.defaultRenderers,{props:Qe})},createWrapperContainer(Je){return Je("div",{style:{display:"block","overflow-x":"auto","max-width":`${this.tableMaxWidth}px`}},[this.createPivottable(Je)])}},render(Je){return this.tableMaxWidth>0?this.createWrapperContainer(Je):this.createPivottable(Je)}},Jg={name:"draggable-attribute",props:{open:{type:Boolean,default:!1},sortable:{type:Boolean,default:!0},draggable:{type:Boolean,default:!0},name:{type:String,required:!0},attrValues:{type:Object,required:!1},valueFilter:{type:Object,default:function(){return{}}},sorter:{type:Function,required:!0},menuLimit:Number,zIndex:Number,unused:Boolean},data(){return{filterText:"",attribute:"",values:[],filter:{}}},computed:{disabled(){return!this.sortable&&!this.draggable},sortonly(){return this.sortable&&!this.draggable}},methods:{setValuesInFilter(Je,Qe){const r=Qe.reduce((I,B)=>(I[B]=!0,I),{});this.$emit("update:filter",{attribute:Je,valueFilter:r})},addValuesToFilter(Je,Qe){const r=Qe.reduce((I,B)=>(I[B]=!0,I),ul({},this.valueFilter));this.$emit("update:filter",{attribute:Je,valueFilter:r})},removeValuesFromFilter(Je,Qe){const r=Qe.reduce((I,B)=>(I[B]&&delete I[B],I),ul({},this.valueFilter));this.$emit("update:filter",{attribute:Je,valueFilter:r})},moveFilterBoxToTop(Je){this.$emit("moveToTop:filterbox",{attribute:Je})},toggleValue(Je){Je in this.valueFilter?this.removeValuesFromFilter(this.name,[Je]):this.addValuesToFilter(this.name,[Je])},matchesFilter(Je){return Je.toLowerCase().trim().includes(this.filterText.toLowerCase().trim())},selectOnly(Je,Qe){Je.stopPropagation(),this.value=Qe,this.setValuesInFilter(this.name,Object.keys(this.attrValues).filter(r=>r!==Qe))},getFilterBox(Je){const Qe=Object.keys(this.attrValues).length<this.menuLimit,r=Object.keys(this.attrValues),I=r.filter(this.matchesFilter.bind(this)).sort(this.sorter);return Je("div",{staticClass:["pvtFilterBox"],style:{display:"block",cursor:"initial",zIndex:this.zIndex},on:{click:()=>this.moveFilterBoxToTop(this.name)}},[Je("div",{staticClass:"pvtSearchContainer"},[Qe||Je("p","too many values to show"),Qe&&Je("input",{staticClass:["pvtSearch"],attrs:{type:"text",placeholder:"Filter Values"},domProps:{value:this.filterText},on:{input:B=>{this.filterText=B.target.value,this.$emit("input",B.target.value)}}}),Je("a",{staticClass:["pvtFilterTextClear"],on:{click:()=>{this.filterText=""}}}),Je("a",{staticClass:["pvtButton"],attrs:{role:"button"},on:{click:()=>this.removeValuesFromFilter(this.name,Object.keys(this.attrValues).filter(this.matchesFilter.bind(this)))}},`Select ${r.length===I.length?"All":I.length}`),Je("a",{staticClass:["pvtButton"],attrs:{role:"button"},on:{click:()=>this.addValuesToFilter(this.name,Object.keys(this.attrValues).filter(this.matchesFilter.bind(this)))}},`Deselect ${r.length===I.length?"All":I.length}`)]),Qe&&Je("div",{staticClass:["pvtCheckContainer"]},[...I.map(B=>{const t=!(B in this.valueFilter);return Je("p",{class:{selected:t},attrs:{key:B},on:{click:()=>this.toggleValue(B)}},[Je("input",{attrs:{type:"checkbox"},domProps:{checked:t}}),B,Je("a",{staticClass:["pvtOnly"],on:{click:d=>this.selectOnly(d,B)}},"only"),Je("a",{staticClass:["pvtOnlySpacer"]})])})])])},toggleFilterBox(){this.openFilterBox(this.name,!this.open),this.moveFilterBoxToTop(this.name)},openFilterBox(Je,Qe){this.$emit("open:filterbox",{attribute:Je,open:Qe})}},render(Je){const Qe=Object.keys(this.valueFilter).length!==0?"pvtFilteredAttribute":"",r=this.$scopedSlots.pvtAttr;return Je("li",{attrs:{"data-id":this.disabled?void 0:this.name}},[Je("span",{staticClass:["pvtAttr "+Qe],class:{sortonly:this.sortonly,disabled:this.disabled}},[r?r({name:this.name}):this.name,!this.disabled&&!this.unused?Je("span",{staticClass:["pvtTriangle"],on:{click:this.toggleFilterBox.bind(this)}},"  \u25BE"):void 0,this.open?this.getFilterBox(Je):void 0])])}},Ah={props:["values","changeValue"],methods:{handleChange(Je){const Qe=Je.target.value;this.$emit("input",Qe)}},render(Je){return Je("select",{staticClass:["pvtDropdown"],attrs:{value:this.value},on:{change:this.handleChange}},[this.values.map(Qe=>Je("option",{attrs:{value:Qe}},Qe))])}},$g=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Qg(Je){return Je&&Je.__esModule&&Object.prototype.hasOwnProperty.call(Je,"default")?Je.default:Je}function em(Je){if(Je.__esModule)return Je;var Qe=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(Je).forEach(function(r){var I=Object.getOwnPropertyDescriptor(Je,r);Object.defineProperty(Qe,r,I.get?I:{enumerable:!0,get:function(){return Je[r]}})}),Qe}var Md={exports:{}};/**!
 * Sortable 1.10.2
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function wf(Je){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?wf=function(Qe){return typeof Qe}:wf=function(Qe){return Qe&&typeof Symbol=="function"&&Qe.constructor===Symbol&&Qe!==Symbol.prototype?"symbol":typeof Qe},wf(Je)}function tm(Je,Qe,r){return Qe in Je?Object.defineProperty(Je,Qe,{value:r,enumerable:!0,configurable:!0,writable:!0}):Je[Qe]=r,Je}function Ys(){return Ys=Object.assign||function(Je){for(var Qe=1;Qe<arguments.length;Qe++){var r=arguments[Qe];for(var I in r)Object.prototype.hasOwnProperty.call(r,I)&&(Je[I]=r[I])}return Je},Ys.apply(this,arguments)}function Vl(Je){for(var Qe=1;Qe<arguments.length;Qe++){var r=arguments[Qe]!=null?arguments[Qe]:{},I=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(I=I.concat(Object.getOwnPropertySymbols(r).filter(function(B){return Object.getOwnPropertyDescriptor(r,B).enumerable}))),I.forEach(function(B){tm(Je,B,r[B])})}return Je}function rm(Je,Qe){if(Je==null)return{};var r={},I=Object.keys(Je),B,t;for(t=0;t<I.length;t++)B=I[t],!(Qe.indexOf(B)>=0)&&(r[B]=Je[B]);return r}function nm(Je,Qe){if(Je==null)return{};var r=rm(Je,Qe),I,B;if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(Je);for(B=0;B<t.length;B++)I=t[B],!(Qe.indexOf(I)>=0)&&(!Object.prototype.propertyIsEnumerable.call(Je,I)||(r[I]=Je[I]))}return r}function am(Je){return im(Je)||om(Je)||sm()}function im(Je){if(Array.isArray(Je)){for(var Qe=0,r=new Array(Je.length);Qe<Je.length;Qe++)r[Qe]=Je[Qe];return r}}function om(Je){if(Symbol.iterator in Object(Je)||Object.prototype.toString.call(Je)==="[object Arguments]")return Array.from(Je)}function sm(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var lm="1.10.2";function Ll(Je){if(typeof window!="undefined"&&window.navigator)return!!navigator.userAgent.match(Je)}var Pl=Ll(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),vc=Ll(/Edge/i),Sd=Ll(/firefox/i),Mh=Ll(/safari/i)&&!Ll(/chrome/i)&&!Ll(/android/i),Ed=Ll(/iP(ad|od|hone)/i),um=Ll(/chrome/i)&&Ll(/android/i),Cd={capture:!1,passive:!1};function fi(Je,Qe,r){Je.addEventListener(Qe,r,!Pl&&Cd)}function ni(Je,Qe,r){Je.removeEventListener(Qe,r,!Pl&&Cd)}function Tf(Je,Qe){if(!!Qe){if(Qe[0]===">"&&(Qe=Qe.substring(1)),Je)try{if(Je.matches)return Je.matches(Qe);if(Je.msMatchesSelector)return Je.msMatchesSelector(Qe);if(Je.webkitMatchesSelector)return Je.webkitMatchesSelector(Qe)}catch(r){return!1}return!1}}function cm(Je){return Je.host&&Je!==document&&Je.host.nodeType?Je.host:Je.parentNode}function cl(Je,Qe,r,I){if(Je){r=r||document;do{if(Qe!=null&&(Qe[0]===">"?Je.parentNode===r&&Tf(Je,Qe):Tf(Je,Qe))||I&&Je===r)return Je;if(Je===r)break}while(Je=cm(Je))}return null}var Ld=/\s+/g;function go(Je,Qe,r){if(Je&&Qe)if(Je.classList)Je.classList[r?"add":"remove"](Qe);else{var I=(" "+Je.className+" ").replace(Ld," ").replace(" "+Qe+" "," ");Je.className=(I+(r?" "+Qe:"")).replace(Ld," ")}}function wa(Je,Qe,r){var I=Je&&Je.style;if(I){if(r===void 0)return document.defaultView&&document.defaultView.getComputedStyle?r=document.defaultView.getComputedStyle(Je,""):Je.currentStyle&&(r=Je.currentStyle),Qe===void 0?r:r[Qe];!(Qe in I)&&Qe.indexOf("webkit")===-1&&(Qe="-webkit-"+Qe),I[Qe]=r+(typeof r=="string"?"":"px")}}function cu(Je,Qe){var r="";if(typeof Je=="string")r=Je;else do{var I=wa(Je,"transform");I&&I!=="none"&&(r=I+" "+r)}while(!Qe&&(Je=Je.parentNode));var B=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return B&&new B(r)}function Pd(Je,Qe,r){if(Je){var I=Je.getElementsByTagName(Qe),B=0,t=I.length;if(r)for(;B<t;B++)r(I[B],B);return I}return[]}function wl(){var Je=document.scrollingElement;return Je||document.documentElement}function _o(Je,Qe,r,I,B){if(!(!Je.getBoundingClientRect&&Je!==window)){var t,d,m,h,e,f,l;if(Je!==window&&Je!==wl()?(t=Je.getBoundingClientRect(),d=t.top,m=t.left,h=t.bottom,e=t.right,f=t.height,l=t.width):(d=0,m=0,h=window.innerHeight,e=window.innerWidth,f=window.innerHeight,l=window.innerWidth),(Qe||r)&&Je!==window&&(B=B||Je.parentNode,!Pl))do if(B&&B.getBoundingClientRect&&(wa(B,"transform")!=="none"||r&&wa(B,"position")!=="static")){var o=B.getBoundingClientRect();d-=o.top+parseInt(wa(B,"border-top-width")),m-=o.left+parseInt(wa(B,"border-left-width")),h=d+t.height,e=m+t.width;break}while(B=B.parentNode);if(I&&Je!==window){var u=cu(B||Je),s=u&&u.a,i=u&&u.d;u&&(d/=i,m/=s,l/=s,f/=i,h=d+f,e=m+l)}return{top:d,left:m,bottom:h,right:e,width:l,height:f}}}function Id(Je,Qe,r){for(var I=Hl(Je,!0),B=_o(Je)[Qe];I;){var t=_o(I)[r],d=void 0;if(r==="top"||r==="left"?d=B>=t:d=B<=t,!d)return I;if(I===wl())break;I=Hl(I,!1)}return!1}function kf(Je,Qe,r){for(var I=0,B=0,t=Je.children;B<t.length;){if(t[B].style.display!=="none"&&t[B]!==Ia.ghost&&t[B]!==Ia.dragged&&cl(t[B],r.draggable,Je,!1)){if(I===Qe)return t[B];I++}B++}return null}function Sh(Je,Qe){for(var r=Je.lastElementChild;r&&(r===Ia.ghost||wa(r,"display")==="none"||Qe&&!Tf(r,Qe));)r=r.previousElementSibling;return r||null}function wo(Je,Qe){var r=0;if(!Je||!Je.parentNode)return-1;for(;Je=Je.previousElementSibling;)Je.nodeName.toUpperCase()!=="TEMPLATE"&&Je!==Ia.clone&&(!Qe||Tf(Je,Qe))&&r++;return r}function Od(Je){var Qe=0,r=0,I=wl();if(Je)do{var B=cu(Je),t=B.a,d=B.d;Qe+=Je.scrollLeft*t,r+=Je.scrollTop*d}while(Je!==I&&(Je=Je.parentNode));return[Qe,r]}function fm(Je,Qe){for(var r in Je)if(!!Je.hasOwnProperty(r)){for(var I in Qe)if(Qe.hasOwnProperty(I)&&Qe[I]===Je[r][I])return Number(r)}return-1}function Hl(Je,Qe){if(!Je||!Je.getBoundingClientRect)return wl();var r=Je,I=!1;do if(r.clientWidth<r.scrollWidth||r.clientHeight<r.scrollHeight){var B=wa(r);if(r.clientWidth<r.scrollWidth&&(B.overflowX=="auto"||B.overflowX=="scroll")||r.clientHeight<r.scrollHeight&&(B.overflowY=="auto"||B.overflowY=="scroll")){if(!r.getBoundingClientRect||r===document.body)return wl();if(I||Qe)return r;I=!0}}while(r=r.parentNode);return wl()}function hm(Je,Qe){if(Je&&Qe)for(var r in Qe)Qe.hasOwnProperty(r)&&(Je[r]=Qe[r]);return Je}function Eh(Je,Qe){return Math.round(Je.top)===Math.round(Qe.top)&&Math.round(Je.left)===Math.round(Qe.left)&&Math.round(Je.height)===Math.round(Qe.height)&&Math.round(Je.width)===Math.round(Qe.width)}var yc;function Dd(Je,Qe){return function(){if(!yc){var r=arguments,I=this;r.length===1?Je.call(I,r[0]):Je.apply(I,r),yc=setTimeout(function(){yc=void 0},Qe)}}}function pm(){clearTimeout(yc),yc=void 0}function zd(Je,Qe,r){Je.scrollLeft+=Qe,Je.scrollTop+=r}function Ch(Je){var Qe=window.Polymer,r=window.jQuery||window.Zepto;return Qe&&Qe.dom?Qe.dom(Je).cloneNode(!0):r?r(Je).clone(!0)[0]:Je.cloneNode(!0)}function Rd(Je,Qe){wa(Je,"position","absolute"),wa(Je,"top",Qe.top),wa(Je,"left",Qe.left),wa(Je,"width",Qe.width),wa(Je,"height",Qe.height)}function Lh(Je){wa(Je,"position",""),wa(Je,"top",""),wa(Je,"left",""),wa(Je,"width",""),wa(Je,"height","")}var ds="Sortable"+new Date().getTime();function dm(){var Je=[],Qe;return{captureAnimationState:function(){if(Je=[],!!this.options.animation){var I=[].slice.call(this.el.children);I.forEach(function(B){if(!(wa(B,"display")==="none"||B===Ia.ghost)){Je.push({target:B,rect:_o(B)});var t=Vl({},Je[Je.length-1].rect);if(B.thisAnimationDuration){var d=cu(B,!0);d&&(t.top-=d.f,t.left-=d.e)}B.fromRect=t}})}},addAnimationState:function(I){Je.push(I)},removeAnimationState:function(I){Je.splice(fm(Je,{target:I}),1)},animateAll:function(I){var B=this;if(!this.options.animation){clearTimeout(Qe),typeof I=="function"&&I();return}var t=!1,d=0;Je.forEach(function(m){var h=0,e=m.target,f=e.fromRect,l=_o(e),o=e.prevFromRect,u=e.prevToRect,s=m.rect,i=cu(e,!0);i&&(l.top-=i.f,l.left-=i.e),e.toRect=l,e.thisAnimationDuration&&Eh(o,l)&&!Eh(f,l)&&(s.top-l.top)/(s.left-l.left)==(f.top-l.top)/(f.left-l.left)&&(h=mm(s,o,u,B.options)),Eh(l,f)||(e.prevFromRect=f,e.prevToRect=l,h||(h=B.options.animation),B.animate(e,s,l,h)),h&&(t=!0,d=Math.max(d,h),clearTimeout(e.animationResetTimer),e.animationResetTimer=setTimeout(function(){e.animationTime=0,e.prevFromRect=null,e.fromRect=null,e.prevToRect=null,e.thisAnimationDuration=null},h),e.thisAnimationDuration=h)}),clearTimeout(Qe),t?Qe=setTimeout(function(){typeof I=="function"&&I()},d):typeof I=="function"&&I(),Je=[]},animate:function(I,B,t,d){if(d){wa(I,"transition",""),wa(I,"transform","");var m=cu(this.el),h=m&&m.a,e=m&&m.d,f=(B.left-t.left)/(h||1),l=(B.top-t.top)/(e||1);I.animatingX=!!f,I.animatingY=!!l,wa(I,"transform","translate3d("+f+"px,"+l+"px,0)"),gm(I),wa(I,"transition","transform "+d+"ms"+(this.options.easing?" "+this.options.easing:"")),wa(I,"transform","translate3d(0,0,0)"),typeof I.animated=="number"&&clearTimeout(I.animated),I.animated=setTimeout(function(){wa(I,"transition",""),wa(I,"transform",""),I.animated=!1,I.animatingX=!1,I.animatingY=!1},d)}}}}function gm(Je){return Je.offsetWidth}function mm(Je,Qe,r,I){return Math.sqrt(Math.pow(Qe.top-Je.top,2)+Math.pow(Qe.left-Je.left,2))/Math.sqrt(Math.pow(Qe.top-r.top,2)+Math.pow(Qe.left-r.left,2))*I.animation}var xc=[],Ph={initializeByDefault:!0},bc={mount:function(Qe){for(var r in Ph)Ph.hasOwnProperty(r)&&!(r in Qe)&&(Qe[r]=Ph[r]);xc.push(Qe)},pluginEvent:function(Qe,r,I){var B=this;this.eventCanceled=!1,I.cancel=function(){B.eventCanceled=!0};var t=Qe+"Global";xc.forEach(function(d){!r[d.pluginName]||(r[d.pluginName][t]&&r[d.pluginName][t](Vl({sortable:r},I)),r.options[d.pluginName]&&r[d.pluginName][Qe]&&r[d.pluginName][Qe](Vl({sortable:r},I)))})},initializePlugins:function(Qe,r,I,B){xc.forEach(function(m){var h=m.pluginName;if(!(!Qe.options[h]&&!m.initializeByDefault)){var e=new m(Qe,r,Qe.options);e.sortable=Qe,e.options=Qe.options,Qe[h]=e,Ys(I,e.defaults)}});for(var t in Qe.options)if(!!Qe.options.hasOwnProperty(t)){var d=this.modifyOption(Qe,t,Qe.options[t]);typeof d!="undefined"&&(Qe.options[t]=d)}},getEventProperties:function(Qe,r){var I={};return xc.forEach(function(B){typeof B.eventProperties=="function"&&Ys(I,B.eventProperties.call(r[B.pluginName],Qe))}),I},modifyOption:function(Qe,r,I){var B;return xc.forEach(function(t){!Qe[t.pluginName]||t.optionListeners&&typeof t.optionListeners[r]=="function"&&(B=t.optionListeners[r].call(Qe[t.pluginName],I))}),B}};function _c(Je){var Qe=Je.sortable,r=Je.rootEl,I=Je.name,B=Je.targetEl,t=Je.cloneEl,d=Je.toEl,m=Je.fromEl,h=Je.oldIndex,e=Je.newIndex,f=Je.oldDraggableIndex,l=Je.newDraggableIndex,o=Je.originalEvent,u=Je.putSortable,s=Je.extraEventProperties;if(Qe=Qe||r&&r[ds],!!Qe){var i,c=Qe.options,n="on"+I.charAt(0).toUpperCase()+I.substr(1);window.CustomEvent&&!Pl&&!vc?i=new CustomEvent(I,{bubbles:!0,cancelable:!0}):(i=document.createEvent("Event"),i.initEvent(I,!0,!0)),i.to=d||r,i.from=m||r,i.item=B||r,i.clone=t,i.oldIndex=h,i.newIndex=e,i.oldDraggableIndex=f,i.newDraggableIndex=l,i.originalEvent=o,i.pullMode=u?u.lastPutMode:void 0;var a=Vl({},s,bc.getEventProperties(I,Qe));for(var g in a)i[g]=a[g];r&&r.dispatchEvent(i),c[n]&&c[n].call(Qe,i)}}var Is=function(Qe,r){var I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},B=I.evt,t=nm(I,["evt"]);bc.pluginEvent.bind(Ia)(Qe,r,Vl({dragEl:aa,parentEl:Bo,ghostEl:Ha,rootEl:mo,nextEl:fu,lastDownEl:Af,cloneEl:To,cloneHidden:Gl,dragStarted:Tc,putSortable:ls,activeSortable:Ia.active,originalEvent:B,oldIndex:Vu,oldDraggableIndex:wc,newIndex:Ns,newDraggableIndex:ql,hideGhostForTarget:Hd,unhideGhostForTarget:Gd,cloneNowHidden:function(){Gl=!0},cloneNowShown:function(){Gl=!1},dispatchSortableEvent:function(m){As({sortable:r,name:m,originalEvent:B})}},t))};function As(Je){_c(Vl({putSortable:ls,cloneEl:To,targetEl:aa,rootEl:mo,oldIndex:Vu,oldDraggableIndex:wc,newIndex:Ns,newDraggableIndex:ql},Je))}var aa,Bo,Ha,mo,fu,Af,To,Gl,Vu,Ns,wc,ql,Mf,ls,Hu=!1,Sf=!1,Ef=[],hu,fl,Ih,Oh,Fd,Bd,Tc,Gu,kc,Ac=!1,Cf=!1,Lf,gs,Dh=[],zh=!1,Pf=[],If=typeof document!="undefined",Of=Ed,Nd=vc||Pl?"cssFloat":"float",vm=If&&!um&&!Ed&&"draggable"in document.createElement("div"),jd=function(){if(!!If){if(Pl)return!1;var Je=document.createElement("x");return Je.style.cssText="pointer-events:auto",Je.style.pointerEvents==="auto"}}(),Ud=function(Qe,r){var I=wa(Qe),B=parseInt(I.width)-parseInt(I.paddingLeft)-parseInt(I.paddingRight)-parseInt(I.borderLeftWidth)-parseInt(I.borderRightWidth),t=kf(Qe,0,r),d=kf(Qe,1,r),m=t&&wa(t),h=d&&wa(d),e=m&&parseInt(m.marginLeft)+parseInt(m.marginRight)+_o(t).width,f=h&&parseInt(h.marginLeft)+parseInt(h.marginRight)+_o(d).width;if(I.display==="flex")return I.flexDirection==="column"||I.flexDirection==="column-reverse"?"vertical":"horizontal";if(I.display==="grid")return I.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(t&&m.float&&m.float!=="none"){var l=m.float==="left"?"left":"right";return d&&(h.clear==="both"||h.clear===l)?"vertical":"horizontal"}return t&&(m.display==="block"||m.display==="flex"||m.display==="table"||m.display==="grid"||e>=B&&I[Nd]==="none"||d&&I[Nd]==="none"&&e+f>B)?"vertical":"horizontal"},ym=function(Qe,r,I){var B=I?Qe.left:Qe.top,t=I?Qe.right:Qe.bottom,d=I?Qe.width:Qe.height,m=I?r.left:r.top,h=I?r.right:r.bottom,e=I?r.width:r.height;return B===m||t===h||B+d/2===m+e/2},xm=function(Qe,r){var I;return Ef.some(function(B){if(!Sh(B)){var t=_o(B),d=B[ds].options.emptyInsertThreshold,m=Qe>=t.left-d&&Qe<=t.right+d,h=r>=t.top-d&&r<=t.bottom+d;if(d&&m&&h)return I=B}}),I},Vd=function(Qe){function r(t,d){return function(m,h,e,f){var l=m.options.group.name&&h.options.group.name&&m.options.group.name===h.options.group.name;if(t==null&&(d||l))return!0;if(t==null||t===!1)return!1;if(d&&t==="clone")return t;if(typeof t=="function")return r(t(m,h,e,f),d)(m,h,e,f);var o=(d?m:h).options.group.name;return t===!0||typeof t=="string"&&t===o||t.join&&t.indexOf(o)>-1}}var I={},B=Qe.group;(!B||wf(B)!="object")&&(B={name:B}),I.name=B.name,I.checkPull=r(B.pull,!0),I.checkPut=r(B.put),I.revertClone=B.revertClone,Qe.group=I},Hd=function(){!jd&&Ha&&wa(Ha,"display","none")},Gd=function(){!jd&&Ha&&wa(Ha,"display","")};If&&document.addEventListener("click",function(Je){if(Sf)return Je.preventDefault(),Je.stopPropagation&&Je.stopPropagation(),Je.stopImmediatePropagation&&Je.stopImmediatePropagation(),Sf=!1,!1},!0);var pu=function(Qe){if(aa){Qe=Qe.touches?Qe.touches[0]:Qe;var r=xm(Qe.clientX,Qe.clientY);if(r){var I={};for(var B in Qe)Qe.hasOwnProperty(B)&&(I[B]=Qe[B]);I.target=I.rootEl=r,I.preventDefault=void 0,I.stopPropagation=void 0,r[ds]._onDragOver(I)}}},bm=function(Qe){aa&&aa.parentNode[ds]._isOutsideThisEl(Qe.target)};function Ia(Je,Qe){if(!(Je&&Je.nodeType&&Je.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(Je));this.el=Je,this.options=Qe=Ys({},Qe),Je[ds]=this;var r={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(Je.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Ud(Je,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(d,m){d.setData("Text",m.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Ia.supportPointer!==!1&&"PointerEvent"in window,emptyInsertThreshold:5};bc.initializePlugins(this,Je,r);for(var I in r)!(I in Qe)&&(Qe[I]=r[I]);Vd(Qe);for(var B in this)B.charAt(0)==="_"&&typeof this[B]=="function"&&(this[B]=this[B].bind(this));this.nativeDraggable=Qe.forceFallback?!1:vm,this.nativeDraggable&&(this.options.touchStartThreshold=1),Qe.supportPointer?fi(Je,"pointerdown",this._onTapStart):(fi(Je,"mousedown",this._onTapStart),fi(Je,"touchstart",this._onTapStart)),this.nativeDraggable&&(fi(Je,"dragover",this),fi(Je,"dragenter",this)),Ef.push(this.el),Qe.store&&Qe.store.get&&this.sort(Qe.store.get(this)||[]),Ys(this,dm())}Ia.prototype={constructor:Ia,_isOutsideThisEl:function(Qe){!this.el.contains(Qe)&&Qe!==this.el&&(Gu=null)},_getDirection:function(Qe,r){return typeof this.options.direction=="function"?this.options.direction.call(this,Qe,r,aa):this.options.direction},_onTapStart:function(Qe){if(!!Qe.cancelable){var r=this,I=this.el,B=this.options,t=B.preventOnFilter,d=Qe.type,m=Qe.touches&&Qe.touches[0]||Qe.pointerType&&Qe.pointerType==="touch"&&Qe,h=(m||Qe).target,e=Qe.target.shadowRoot&&(Qe.path&&Qe.path[0]||Qe.composedPath&&Qe.composedPath()[0])||h,f=B.filter;if(Sm(I),!aa&&!(/mousedown|pointerdown/.test(d)&&Qe.button!==0||B.disabled)&&!e.isContentEditable&&(h=cl(h,B.draggable,I,!1),!(h&&h.animated)&&Af!==h)){if(Vu=wo(h),wc=wo(h,B.draggable),typeof f=="function"){if(f.call(this,Qe,h,this)){As({sortable:r,rootEl:e,name:"filter",targetEl:h,toEl:I,fromEl:I}),Is("filter",r,{evt:Qe}),t&&Qe.cancelable&&Qe.preventDefault();return}}else if(f&&(f=f.split(",").some(function(l){if(l=cl(e,l.trim(),I,!1),l)return As({sortable:r,rootEl:l,name:"filter",targetEl:h,fromEl:I,toEl:I}),Is("filter",r,{evt:Qe}),!0}),f)){t&&Qe.cancelable&&Qe.preventDefault();return}B.handle&&!cl(e,B.handle,I,!1)||this._prepareDragStart(Qe,m,h)}}},_prepareDragStart:function(Qe,r,I){var B=this,t=B.el,d=B.options,m=t.ownerDocument,h;if(I&&!aa&&I.parentNode===t){var e=_o(I);if(mo=t,aa=I,Bo=aa.parentNode,fu=aa.nextSibling,Af=I,Mf=d.group,Ia.dragged=aa,hu={target:aa,clientX:(r||Qe).clientX,clientY:(r||Qe).clientY},Fd=hu.clientX-e.left,Bd=hu.clientY-e.top,this._lastX=(r||Qe).clientX,this._lastY=(r||Qe).clientY,aa.style["will-change"]="all",h=function(){if(Is("delayEnded",B,{evt:Qe}),Ia.eventCanceled){B._onDrop();return}B._disableDelayedDragEvents(),!Sd&&B.nativeDraggable&&(aa.draggable=!0),B._triggerDragStart(Qe,r),As({sortable:B,name:"choose",originalEvent:Qe}),go(aa,d.chosenClass,!0)},d.ignore.split(",").forEach(function(f){Pd(aa,f.trim(),Fh)}),fi(m,"dragover",pu),fi(m,"mousemove",pu),fi(m,"touchmove",pu),fi(m,"mouseup",B._onDrop),fi(m,"touchend",B._onDrop),fi(m,"touchcancel",B._onDrop),Sd&&this.nativeDraggable&&(this.options.touchStartThreshold=4,aa.draggable=!0),Is("delayStart",this,{evt:Qe}),d.delay&&(!d.delayOnTouchOnly||r)&&(!this.nativeDraggable||!(vc||Pl))){if(Ia.eventCanceled){this._onDrop();return}fi(m,"mouseup",B._disableDelayedDrag),fi(m,"touchend",B._disableDelayedDrag),fi(m,"touchcancel",B._disableDelayedDrag),fi(m,"mousemove",B._delayedDragTouchMoveHandler),fi(m,"touchmove",B._delayedDragTouchMoveHandler),d.supportPointer&&fi(m,"pointermove",B._delayedDragTouchMoveHandler),B._dragStartTimer=setTimeout(h,d.delay)}else h()}},_delayedDragTouchMoveHandler:function(Qe){var r=Qe.touches?Qe.touches[0]:Qe;Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){aa&&Fh(aa),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var Qe=this.el.ownerDocument;ni(Qe,"mouseup",this._disableDelayedDrag),ni(Qe,"touchend",this._disableDelayedDrag),ni(Qe,"touchcancel",this._disableDelayedDrag),ni(Qe,"mousemove",this._delayedDragTouchMoveHandler),ni(Qe,"touchmove",this._delayedDragTouchMoveHandler),ni(Qe,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(Qe,r){r=r||Qe.pointerType=="touch"&&Qe,!this.nativeDraggable||r?this.options.supportPointer?fi(document,"pointermove",this._onTouchMove):r?fi(document,"touchmove",this._onTouchMove):fi(document,"mousemove",this._onTouchMove):(fi(aa,"dragend",this),fi(mo,"dragstart",this._onDragStart));try{document.selection?Df(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(I){}},_dragStarted:function(Qe,r){if(Hu=!1,mo&&aa){Is("dragStarted",this,{evt:r}),this.nativeDraggable&&fi(document,"dragover",bm);var I=this.options;!Qe&&go(aa,I.dragClass,!1),go(aa,I.ghostClass,!0),Ia.active=this,Qe&&this._appendGhost(),As({sortable:this,name:"start",originalEvent:r})}else this._nulling()},_emulateDragOver:function(){if(fl){this._lastX=fl.clientX,this._lastY=fl.clientY,Hd();for(var Qe=document.elementFromPoint(fl.clientX,fl.clientY),r=Qe;Qe&&Qe.shadowRoot&&(Qe=Qe.shadowRoot.elementFromPoint(fl.clientX,fl.clientY),Qe!==r);)r=Qe;if(aa.parentNode[ds]._isOutsideThisEl(Qe),r)do{if(r[ds]){var I=void 0;if(I=r[ds]._onDragOver({clientX:fl.clientX,clientY:fl.clientY,target:Qe,rootEl:r}),I&&!this.options.dragoverBubble)break}Qe=r}while(r=r.parentNode);Gd()}},_onTouchMove:function(Qe){if(hu){var r=this.options,I=r.fallbackTolerance,B=r.fallbackOffset,t=Qe.touches?Qe.touches[0]:Qe,d=Ha&&cu(Ha,!0),m=Ha&&d&&d.a,h=Ha&&d&&d.d,e=Of&&gs&&Od(gs),f=(t.clientX-hu.clientX+B.x)/(m||1)+(e?e[0]-Dh[0]:0)/(m||1),l=(t.clientY-hu.clientY+B.y)/(h||1)+(e?e[1]-Dh[1]:0)/(h||1);if(!Ia.active&&!Hu){if(I&&Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))<I)return;this._onDragStart(Qe,!0)}if(Ha){d?(d.e+=f-(Ih||0),d.f+=l-(Oh||0)):d={a:1,b:0,c:0,d:1,e:f,f:l};var o="matrix(".concat(d.a,",").concat(d.b,",").concat(d.c,",").concat(d.d,",").concat(d.e,",").concat(d.f,")");wa(Ha,"webkitTransform",o),wa(Ha,"mozTransform",o),wa(Ha,"msTransform",o),wa(Ha,"transform",o),Ih=f,Oh=l,fl=t}Qe.cancelable&&Qe.preventDefault()}},_appendGhost:function(){if(!Ha){var Qe=this.options.fallbackOnBody?document.body:mo,r=_o(aa,!0,Of,!0,Qe),I=this.options;if(Of){for(gs=Qe;wa(gs,"position")==="static"&&wa(gs,"transform")==="none"&&gs!==document;)gs=gs.parentNode;gs!==document.body&&gs!==document.documentElement?(gs===document&&(gs=wl()),r.top+=gs.scrollTop,r.left+=gs.scrollLeft):gs=wl(),Dh=Od(gs)}Ha=aa.cloneNode(!0),go(Ha,I.ghostClass,!1),go(Ha,I.fallbackClass,!0),go(Ha,I.dragClass,!0),wa(Ha,"transition",""),wa(Ha,"transform",""),wa(Ha,"box-sizing","border-box"),wa(Ha,"margin",0),wa(Ha,"top",r.top),wa(Ha,"left",r.left),wa(Ha,"width",r.width),wa(Ha,"height",r.height),wa(Ha,"opacity","0.8"),wa(Ha,"position",Of?"absolute":"fixed"),wa(Ha,"zIndex","100000"),wa(Ha,"pointerEvents","none"),Ia.ghost=Ha,Qe.appendChild(Ha),wa(Ha,"transform-origin",Fd/parseInt(Ha.style.width)*100+"% "+Bd/parseInt(Ha.style.height)*100+"%")}},_onDragStart:function(Qe,r){var I=this,B=Qe.dataTransfer,t=I.options;if(Is("dragStart",this,{evt:Qe}),Ia.eventCanceled){this._onDrop();return}Is("setupClone",this),Ia.eventCanceled||(To=Ch(aa),To.draggable=!1,To.style["will-change"]="",this._hideClone(),go(To,this.options.chosenClass,!1),Ia.clone=To),I.cloneId=Df(function(){Is("clone",I),!Ia.eventCanceled&&(I.options.removeCloneOnHide||mo.insertBefore(To,aa),I._hideClone(),As({sortable:I,name:"clone"}))}),!r&&go(aa,t.dragClass,!0),r?(Sf=!0,I._loopId=setInterval(I._emulateDragOver,50)):(ni(document,"mouseup",I._onDrop),ni(document,"touchend",I._onDrop),ni(document,"touchcancel",I._onDrop),B&&(B.effectAllowed="move",t.setData&&t.setData.call(I,B,aa)),fi(document,"drop",I),wa(aa,"transform","translateZ(0)")),Hu=!0,I._dragStartId=Df(I._dragStarted.bind(I,r,Qe)),fi(document,"selectstart",I),Tc=!0,Mh&&wa(document.body,"user-select","none")},_onDragOver:function(Qe){var r=this.el,I=Qe.target,B,t,d,m=this.options,h=m.group,e=Ia.active,f=Mf===h,l=m.sort,o=ls||e,u,s=this,i=!1;if(zh)return;function c(P,D){Is(P,s,Vl({evt:Qe,isOwner:f,axis:u?"vertical":"horizontal",revert:d,dragRect:B,targetRect:t,canSort:l,fromSortable:o,target:I,completed:a,onMove:function(U,G){return Rh(mo,r,aa,B,U,_o(U),Qe,G)},changed:g},D))}function n(){c("dragOverAnimationCapture"),s.captureAnimationState(),s!==o&&o.captureAnimationState()}function a(P){return c("dragOverCompleted",{insertion:P}),P&&(f?e._hideClone():e._showClone(s),s!==o&&(go(aa,ls?ls.options.ghostClass:e.options.ghostClass,!1),go(aa,m.ghostClass,!0)),ls!==s&&s!==Ia.active?ls=s:s===Ia.active&&ls&&(ls=null),o===s&&(s._ignoreWhileAnimating=I),s.animateAll(function(){c("dragOverAnimationComplete"),s._ignoreWhileAnimating=null}),s!==o&&(o.animateAll(),o._ignoreWhileAnimating=null)),(I===aa&&!aa.animated||I===r&&!I.animated)&&(Gu=null),!m.dragoverBubble&&!Qe.rootEl&&I!==document&&(aa.parentNode[ds]._isOutsideThisEl(Qe.target),!P&&pu(Qe)),!m.dragoverBubble&&Qe.stopPropagation&&Qe.stopPropagation(),i=!0}function g(){Ns=wo(aa),ql=wo(aa,m.draggable),As({sortable:s,name:"change",toEl:r,newIndex:Ns,newDraggableIndex:ql,originalEvent:Qe})}if(Qe.preventDefault!==void 0&&Qe.cancelable&&Qe.preventDefault(),I=cl(I,m.draggable,r,!0),c("dragOver"),Ia.eventCanceled)return i;if(aa.contains(Qe.target)||I.animated&&I.animatingX&&I.animatingY||s._ignoreWhileAnimating===I)return a(!1);if(Sf=!1,e&&!m.disabled&&(f?l||(d=!mo.contains(aa)):ls===this||(this.lastPutMode=Mf.checkPull(this,e,aa,Qe))&&h.checkPut(this,e,aa,Qe))){if(u=this._getDirection(Qe,I)==="vertical",B=_o(aa),c("dragOverValid"),Ia.eventCanceled)return i;if(d)return Bo=mo,n(),this._hideClone(),c("revert"),Ia.eventCanceled||(fu?mo.insertBefore(aa,fu):mo.appendChild(aa)),a(!0);var p=Sh(r,m.draggable);if(!p||Tm(Qe,u,this)&&!p.animated){if(p===aa)return a(!1);if(p&&r===Qe.target&&(I=p),I&&(t=_o(I)),Rh(mo,r,aa,B,I,t,Qe,!!I)!==!1)return n(),r.appendChild(aa),Bo=r,g(),a(!0)}else if(I.parentNode===r){t=_o(I);var y=0,v,b=aa.parentNode!==r,x=!ym(aa.animated&&aa.toRect||B,I.animated&&I.toRect||t,u),T=u?"top":"left",A=Id(I,"top","top")||Id(aa,"top","top"),S=A?A.scrollTop:void 0;Gu!==I&&(v=t[T],Ac=!1,Cf=!x&&m.invertSwap||b),y=km(Qe,I,t,u,x?1:m.swapThreshold,m.invertedSwapThreshold==null?m.swapThreshold:m.invertedSwapThreshold,Cf,Gu===I);var w;if(y!==0){var E=wo(aa);do E-=y,w=Bo.children[E];while(w&&(wa(w,"display")==="none"||w===Ha))}if(y===0||w===I)return a(!1);Gu=I,kc=y;var k=I.nextElementSibling,L=!1;L=y===1;var M=Rh(mo,r,aa,B,I,t,Qe,L);if(M!==!1)return(M===1||M===-1)&&(L=M===1),zh=!0,setTimeout(wm,30),n(),L&&!k?r.appendChild(aa):I.parentNode.insertBefore(aa,L?k:I),A&&zd(A,0,S-A.scrollTop),Bo=aa.parentNode,v!==void 0&&!Cf&&(Lf=Math.abs(v-_o(I)[T])),g(),a(!0)}if(r.contains(aa))return a(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){ni(document,"mousemove",this._onTouchMove),ni(document,"touchmove",this._onTouchMove),ni(document,"pointermove",this._onTouchMove),ni(document,"dragover",pu),ni(document,"mousemove",pu),ni(document,"touchmove",pu)},_offUpEvents:function(){var Qe=this.el.ownerDocument;ni(Qe,"mouseup",this._onDrop),ni(Qe,"touchend",this._onDrop),ni(Qe,"pointerup",this._onDrop),ni(Qe,"touchcancel",this._onDrop),ni(document,"selectstart",this)},_onDrop:function(Qe){var r=this.el,I=this.options;if(Ns=wo(aa),ql=wo(aa,I.draggable),Is("drop",this,{evt:Qe}),Bo=aa&&aa.parentNode,Ns=wo(aa),ql=wo(aa,I.draggable),Ia.eventCanceled){this._nulling();return}Hu=!1,Cf=!1,Ac=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Bh(this.cloneId),Bh(this._dragStartId),this.nativeDraggable&&(ni(document,"drop",this),ni(r,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Mh&&wa(document.body,"user-select",""),wa(aa,"transform",""),Qe&&(Tc&&(Qe.cancelable&&Qe.preventDefault(),!I.dropBubble&&Qe.stopPropagation()),Ha&&Ha.parentNode&&Ha.parentNode.removeChild(Ha),(mo===Bo||ls&&ls.lastPutMode!=="clone")&&To&&To.parentNode&&To.parentNode.removeChild(To),aa&&(this.nativeDraggable&&ni(aa,"dragend",this),Fh(aa),aa.style["will-change"]="",Tc&&!Hu&&go(aa,ls?ls.options.ghostClass:this.options.ghostClass,!1),go(aa,this.options.chosenClass,!1),As({sortable:this,name:"unchoose",toEl:Bo,newIndex:null,newDraggableIndex:null,originalEvent:Qe}),mo!==Bo?(Ns>=0&&(As({rootEl:Bo,name:"add",toEl:Bo,fromEl:mo,originalEvent:Qe}),As({sortable:this,name:"remove",toEl:Bo,originalEvent:Qe}),As({rootEl:Bo,name:"sort",toEl:Bo,fromEl:mo,originalEvent:Qe}),As({sortable:this,name:"sort",toEl:Bo,originalEvent:Qe})),ls&&ls.save()):Ns!==Vu&&Ns>=0&&(As({sortable:this,name:"update",toEl:Bo,originalEvent:Qe}),As({sortable:this,name:"sort",toEl:Bo,originalEvent:Qe})),Ia.active&&((Ns==null||Ns===-1)&&(Ns=Vu,ql=wc),As({sortable:this,name:"end",toEl:Bo,originalEvent:Qe}),this.save()))),this._nulling()},_nulling:function(){Is("nulling",this),mo=aa=Bo=Ha=fu=To=Af=Gl=hu=fl=Tc=Ns=ql=Vu=wc=Gu=kc=ls=Mf=Ia.dragged=Ia.ghost=Ia.clone=Ia.active=null,Pf.forEach(function(Qe){Qe.checked=!0}),Pf.length=Ih=Oh=0},handleEvent:function(Qe){switch(Qe.type){case"drop":case"dragend":this._onDrop(Qe);break;case"dragenter":case"dragover":aa&&(this._onDragOver(Qe),_m(Qe));break;case"selectstart":Qe.preventDefault();break}},toArray:function(){for(var Qe=[],r,I=this.el.children,B=0,t=I.length,d=this.options;B<t;B++)r=I[B],cl(r,d.draggable,this.el,!1)&&Qe.push(r.getAttribute(d.dataIdAttr)||Mm(r));return Qe},sort:function(Qe){var r={},I=this.el;this.toArray().forEach(function(B,t){var d=I.children[t];cl(d,this.options.draggable,I,!1)&&(r[B]=d)},this),Qe.forEach(function(B){r[B]&&(I.removeChild(r[B]),I.appendChild(r[B]))})},save:function(){var Qe=this.options.store;Qe&&Qe.set&&Qe.set(this)},closest:function(Qe,r){return cl(Qe,r||this.options.draggable,this.el,!1)},option:function(Qe,r){var I=this.options;if(r===void 0)return I[Qe];var B=bc.modifyOption(this,Qe,r);typeof B!="undefined"?I[Qe]=B:I[Qe]=r,Qe==="group"&&Vd(I)},destroy:function(){Is("destroy",this);var Qe=this.el;Qe[ds]=null,ni(Qe,"mousedown",this._onTapStart),ni(Qe,"touchstart",this._onTapStart),ni(Qe,"pointerdown",this._onTapStart),this.nativeDraggable&&(ni(Qe,"dragover",this),ni(Qe,"dragenter",this)),Array.prototype.forEach.call(Qe.querySelectorAll("[draggable]"),function(r){r.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Ef.splice(Ef.indexOf(this.el),1),this.el=Qe=null},_hideClone:function(){if(!Gl){if(Is("hideClone",this),Ia.eventCanceled)return;wa(To,"display","none"),this.options.removeCloneOnHide&&To.parentNode&&To.parentNode.removeChild(To),Gl=!0}},_showClone:function(Qe){if(Qe.lastPutMode!=="clone"){this._hideClone();return}if(Gl){if(Is("showClone",this),Ia.eventCanceled)return;mo.contains(aa)&&!this.options.group.revertClone?mo.insertBefore(To,aa):fu?mo.insertBefore(To,fu):mo.appendChild(To),this.options.group.revertClone&&this.animate(aa,To),wa(To,"display",""),Gl=!1}}};function _m(Je){Je.dataTransfer&&(Je.dataTransfer.dropEffect="move"),Je.cancelable&&Je.preventDefault()}function Rh(Je,Qe,r,I,B,t,d,m){var h,e=Je[ds],f=e.options.onMove,l;return window.CustomEvent&&!Pl&&!vc?h=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(h=document.createEvent("Event"),h.initEvent("move",!0,!0)),h.to=Qe,h.from=Je,h.dragged=r,h.draggedRect=I,h.related=B||Qe,h.relatedRect=t||_o(Qe),h.willInsertAfter=m,h.originalEvent=d,Je.dispatchEvent(h),f&&(l=f.call(e,h,d)),l}function Fh(Je){Je.draggable=!1}function wm(){zh=!1}function Tm(Je,Qe,r){var I=_o(Sh(r.el,r.options.draggable)),B=10;return Qe?Je.clientX>I.right+B||Je.clientX<=I.right&&Je.clientY>I.bottom&&Je.clientX>=I.left:Je.clientX>I.right&&Je.clientY>I.top||Je.clientX<=I.right&&Je.clientY>I.bottom+B}function km(Je,Qe,r,I,B,t,d,m){var h=I?Je.clientY:Je.clientX,e=I?r.height:r.width,f=I?r.top:r.left,l=I?r.bottom:r.right,o=!1;if(!d){if(m&&Lf<e*B){if(!Ac&&(kc===1?h>f+e*t/2:h<l-e*t/2)&&(Ac=!0),Ac)o=!0;else if(kc===1?h<f+Lf:h>l-Lf)return-kc}else if(h>f+e*(1-B)/2&&h<l-e*(1-B)/2)return Am(Qe)}return o=o||d,o&&(h<f+e*t/2||h>l-e*t/2)?h>f+e/2?1:-1:0}function Am(Je){return wo(aa)<wo(Je)?1:-1}function Mm(Je){for(var Qe=Je.tagName+Je.className+Je.src+Je.href+Je.textContent,r=Qe.length,I=0;r--;)I+=Qe.charCodeAt(r);return I.toString(36)}function Sm(Je){Pf.length=0;for(var Qe=Je.getElementsByTagName("input"),r=Qe.length;r--;){var I=Qe[r];I.checked&&Pf.push(I)}}function Df(Je){return setTimeout(Je,0)}function Bh(Je){return clearTimeout(Je)}If&&fi(document,"touchmove",function(Je){(Ia.active||Hu)&&Je.cancelable&&Je.preventDefault()});Ia.utils={on:fi,off:ni,css:wa,find:Pd,is:function(Qe,r){return!!cl(Qe,r,Qe,!1)},extend:hm,throttle:Dd,closest:cl,toggleClass:go,clone:Ch,index:wo,nextTick:Df,cancelNextTick:Bh,detectDirection:Ud,getChild:kf};Ia.get=function(Je){return Je[ds]};Ia.mount=function(){for(var Je=arguments.length,Qe=new Array(Je),r=0;r<Je;r++)Qe[r]=arguments[r];Qe[0].constructor===Array&&(Qe=Qe[0]),Qe.forEach(function(I){if(!I.prototype||!I.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(I));I.utils&&(Ia.utils=Vl({},Ia.utils,I.utils)),bc.mount(I)})};Ia.create=function(Je,Qe){return new Ia(Je,Qe)};Ia.version=lm;var No=[],Mc,Nh,jh=!1,Uh,Vh,zf,Sc;function Em(){function Je(){this.defaults={scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var Qe in this)Qe.charAt(0)==="_"&&typeof this[Qe]=="function"&&(this[Qe]=this[Qe].bind(this))}return Je.prototype={dragStarted:function(r){var I=r.originalEvent;this.sortable.nativeDraggable?fi(document,"dragover",this._handleAutoScroll):this.options.supportPointer?fi(document,"pointermove",this._handleFallbackAutoScroll):I.touches?fi(document,"touchmove",this._handleFallbackAutoScroll):fi(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(r){var I=r.originalEvent;!this.options.dragOverBubble&&!I.rootEl&&this._handleAutoScroll(I)},drop:function(){this.sortable.nativeDraggable?ni(document,"dragover",this._handleAutoScroll):(ni(document,"pointermove",this._handleFallbackAutoScroll),ni(document,"touchmove",this._handleFallbackAutoScroll),ni(document,"mousemove",this._handleFallbackAutoScroll)),qd(),Rf(),pm()},nulling:function(){zf=Nh=Mc=jh=Sc=Uh=Vh=null,No.length=0},_handleFallbackAutoScroll:function(r){this._handleAutoScroll(r,!0)},_handleAutoScroll:function(r,I){var B=this,t=(r.touches?r.touches[0]:r).clientX,d=(r.touches?r.touches[0]:r).clientY,m=document.elementFromPoint(t,d);if(zf=r,I||vc||Pl||Mh){Hh(r,this.options,m,I);var h=Hl(m,!0);jh&&(!Sc||t!==Uh||d!==Vh)&&(Sc&&qd(),Sc=setInterval(function(){var e=Hl(document.elementFromPoint(t,d),!0);e!==h&&(h=e,Rf()),Hh(r,B.options,e,I)},10),Uh=t,Vh=d)}else{if(!this.options.bubbleScroll||Hl(m,!0)===wl()){Rf();return}Hh(r,this.options,Hl(m,!1),!1)}}},Ys(Je,{pluginName:"scroll",initializeByDefault:!0})}function Rf(){No.forEach(function(Je){clearInterval(Je.pid)}),No=[]}function qd(){clearInterval(Sc)}var Hh=Dd(function(Je,Qe,r,I){if(!!Qe.scroll){var B=(Je.touches?Je.touches[0]:Je).clientX,t=(Je.touches?Je.touches[0]:Je).clientY,d=Qe.scrollSensitivity,m=Qe.scrollSpeed,h=wl(),e=!1,f;Nh!==r&&(Nh=r,Rf(),Mc=Qe.scroll,f=Qe.scrollFn,Mc===!0&&(Mc=Hl(r,!0)));var l=0,o=Mc;do{var u=o,s=_o(u),i=s.top,c=s.bottom,n=s.left,a=s.right,g=s.width,p=s.height,y=void 0,v=void 0,b=u.scrollWidth,x=u.scrollHeight,T=wa(u),A=u.scrollLeft,S=u.scrollTop;u===h?(y=g<b&&(T.overflowX==="auto"||T.overflowX==="scroll"||T.overflowX==="visible"),v=p<x&&(T.overflowY==="auto"||T.overflowY==="scroll"||T.overflowY==="visible")):(y=g<b&&(T.overflowX==="auto"||T.overflowX==="scroll"),v=p<x&&(T.overflowY==="auto"||T.overflowY==="scroll"));var w=y&&(Math.abs(a-B)<=d&&A+g<b)-(Math.abs(n-B)<=d&&!!A),E=v&&(Math.abs(c-t)<=d&&S+p<x)-(Math.abs(i-t)<=d&&!!S);if(!No[l])for(var k=0;k<=l;k++)No[k]||(No[k]={});(No[l].vx!=w||No[l].vy!=E||No[l].el!==u)&&(No[l].el=u,No[l].vx=w,No[l].vy=E,clearInterval(No[l].pid),(w!=0||E!=0)&&(e=!0,No[l].pid=setInterval(function(){I&&this.layer===0&&Ia.active._onTouchMove(zf);var L=No[this.layer].vy?No[this.layer].vy*m:0,M=No[this.layer].vx?No[this.layer].vx*m:0;typeof f=="function"&&f.call(Ia.dragged.parentNode[ds],M,L,Je,zf,No[this.layer].el)!=="continue"||zd(No[this.layer].el,M,L)}.bind({layer:l}),24))),l++}while(Qe.bubbleScroll&&o!==h&&(o=Hl(o,!1)));jh=e}},30),Yd=function(Qe){var r=Qe.originalEvent,I=Qe.putSortable,B=Qe.dragEl,t=Qe.activeSortable,d=Qe.dispatchSortableEvent,m=Qe.hideGhostForTarget,h=Qe.unhideGhostForTarget;if(!!r){var e=I||t;m();var f=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:r,l=document.elementFromPoint(f.clientX,f.clientY);h(),e&&!e.el.contains(l)&&(d("spill"),this.onSpill({dragEl:B,putSortable:I}))}};function Gh(){}Gh.prototype={startIndex:null,dragStart:function(Qe){var r=Qe.oldDraggableIndex;this.startIndex=r},onSpill:function(Qe){var r=Qe.dragEl,I=Qe.putSortable;this.sortable.captureAnimationState(),I&&I.captureAnimationState();var B=kf(this.sortable.el,this.startIndex,this.options);B?this.sortable.el.insertBefore(r,B):this.sortable.el.appendChild(r),this.sortable.animateAll(),I&&I.animateAll()},drop:Yd};Ys(Gh,{pluginName:"revertOnSpill"});function qh(){}qh.prototype={onSpill:function(Qe){var r=Qe.dragEl,I=Qe.putSortable,B=I||this.sortable;B.captureAnimationState(),r.parentNode&&r.parentNode.removeChild(r),B.animateAll()},drop:Yd};Ys(qh,{pluginName:"removeOnSpill"});var Ws;function Cm(){function Je(){this.defaults={swapClass:"sortable-swap-highlight"}}return Je.prototype={dragStart:function(r){var I=r.dragEl;Ws=I},dragOverValid:function(r){var I=r.completed,B=r.target,t=r.onMove,d=r.activeSortable,m=r.changed,h=r.cancel;if(!!d.options.swap){var e=this.sortable.el,f=this.options;if(B&&B!==e){var l=Ws;t(B)!==!1?(go(B,f.swapClass,!0),Ws=B):Ws=null,l&&l!==Ws&&go(l,f.swapClass,!1)}m(),I(!0),h()}},drop:function(r){var I=r.activeSortable,B=r.putSortable,t=r.dragEl,d=B||this.sortable,m=this.options;Ws&&go(Ws,m.swapClass,!1),Ws&&(m.swap||B&&B.options.swap)&&t!==Ws&&(d.captureAnimationState(),d!==I&&I.captureAnimationState(),Lm(t,Ws),d.animateAll(),d!==I&&I.animateAll())},nulling:function(){Ws=null}},Ys(Je,{pluginName:"swap",eventProperties:function(){return{swapItem:Ws}}})}function Lm(Je,Qe){var r=Je.parentNode,I=Qe.parentNode,B,t;!r||!I||r.isEqualNode(Qe)||I.isEqualNode(Je)||(B=wo(Je),t=wo(Qe),r.isEqualNode(I)&&B<t&&t++,r.insertBefore(Qe,r.children[B]),I.insertBefore(Je,I.children[t]))}var Na=[],js=[],Ec,hl,Cc=!1,Us=!1,qu=!1,Xi,Lc,Ff;function Pm(){function Je(Qe){for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));Qe.options.supportPointer?fi(document,"pointerup",this._deselectMultiDrag):(fi(document,"mouseup",this._deselectMultiDrag),fi(document,"touchend",this._deselectMultiDrag)),fi(document,"keydown",this._checkKeyDown),fi(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(B,t){var d="";Na.length&&hl===Qe?Na.forEach(function(m,h){d+=(h?", ":"")+m.textContent}):d=t.textContent,B.setData("Text",d)}}}return Je.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(r){var I=r.dragEl;Xi=I},delayEnded:function(){this.isMultiDrag=~Na.indexOf(Xi)},setupClone:function(r){var I=r.sortable,B=r.cancel;if(!!this.isMultiDrag){for(var t=0;t<Na.length;t++)js.push(Ch(Na[t])),js[t].sortableIndex=Na[t].sortableIndex,js[t].draggable=!1,js[t].style["will-change"]="",go(js[t],this.options.selectedClass,!1),Na[t]===Xi&&go(js[t],this.options.chosenClass,!1);I._hideClone(),B()}},clone:function(r){var I=r.sortable,B=r.rootEl,t=r.dispatchSortableEvent,d=r.cancel;!this.isMultiDrag||this.options.removeCloneOnHide||Na.length&&hl===I&&(Wd(!0,B),t("clone"),d())},showClone:function(r){var I=r.cloneNowShown,B=r.rootEl,t=r.cancel;!this.isMultiDrag||(Wd(!1,B),js.forEach(function(d){wa(d,"display","")}),I(),Ff=!1,t())},hideClone:function(r){var I=this;r.sortable;var B=r.cloneNowHidden,t=r.cancel;!this.isMultiDrag||(js.forEach(function(d){wa(d,"display","none"),I.options.removeCloneOnHide&&d.parentNode&&d.parentNode.removeChild(d)}),B(),Ff=!0,t())},dragStartGlobal:function(r){r.sortable,!this.isMultiDrag&&hl&&hl.multiDrag._deselectMultiDrag(),Na.forEach(function(I){I.sortableIndex=wo(I)}),Na=Na.sort(function(I,B){return I.sortableIndex-B.sortableIndex}),qu=!0},dragStarted:function(r){var I=this,B=r.sortable;if(!!this.isMultiDrag){if(this.options.sort&&(B.captureAnimationState(),this.options.animation)){Na.forEach(function(d){d!==Xi&&wa(d,"position","absolute")});var t=_o(Xi,!1,!0,!0);Na.forEach(function(d){d!==Xi&&Rd(d,t)}),Us=!0,Cc=!0}B.animateAll(function(){Us=!1,Cc=!1,I.options.animation&&Na.forEach(function(d){Lh(d)}),I.options.sort&&Bf()})}},dragOver:function(r){var I=r.target,B=r.completed,t=r.cancel;Us&&~Na.indexOf(I)&&(B(!1),t())},revert:function(r){var I=r.fromSortable,B=r.rootEl,t=r.sortable,d=r.dragRect;Na.length>1&&(Na.forEach(function(m){t.addAnimationState({target:m,rect:Us?_o(m):d}),Lh(m),m.fromRect=d,I.removeAnimationState(m)}),Us=!1,Im(!this.options.removeCloneOnHide,B))},dragOverCompleted:function(r){var I=r.sortable,B=r.isOwner,t=r.insertion,d=r.activeSortable,m=r.parentEl,h=r.putSortable,e=this.options;if(t){if(B&&d._hideClone(),Cc=!1,e.animation&&Na.length>1&&(Us||!B&&!d.options.sort&&!h)){var f=_o(Xi,!1,!0,!0);Na.forEach(function(o){o!==Xi&&(Rd(o,f),m.appendChild(o))}),Us=!0}if(!B)if(Us||Bf(),Na.length>1){var l=Ff;d._showClone(I),d.options.animation&&!Ff&&l&&js.forEach(function(o){d.addAnimationState({target:o,rect:Lc}),o.fromRect=Lc,o.thisAnimationDuration=null})}else d._showClone(I)}},dragOverAnimationCapture:function(r){var I=r.dragRect,B=r.isOwner,t=r.activeSortable;if(Na.forEach(function(m){m.thisAnimationDuration=null}),t.options.animation&&!B&&t.multiDrag.isMultiDrag){Lc=Ys({},I);var d=cu(Xi,!0);Lc.top-=d.f,Lc.left-=d.e}},dragOverAnimationComplete:function(){Us&&(Us=!1,Bf())},drop:function(r){var I=r.originalEvent,B=r.rootEl,t=r.parentEl,d=r.sortable,m=r.dispatchSortableEvent,h=r.oldIndex,e=r.putSortable,f=e||this.sortable;if(!!I){var l=this.options,o=t.children;if(!qu)if(l.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),go(Xi,l.selectedClass,!~Na.indexOf(Xi)),~Na.indexOf(Xi))Na.splice(Na.indexOf(Xi),1),Ec=null,_c({sortable:d,rootEl:B,name:"deselect",targetEl:Xi,originalEvt:I});else{if(Na.push(Xi),_c({sortable:d,rootEl:B,name:"select",targetEl:Xi,originalEvt:I}),I.shiftKey&&Ec&&d.el.contains(Ec)){var u=wo(Ec),s=wo(Xi);if(~u&&~s&&u!==s){var i,c;for(s>u?(c=u,i=s):(c=s,i=u+1);c<i;c++)~Na.indexOf(o[c])||(go(o[c],l.selectedClass,!0),Na.push(o[c]),_c({sortable:d,rootEl:B,name:"select",targetEl:o[c],originalEvt:I}))}}else Ec=Xi;hl=f}if(qu&&this.isMultiDrag){if((t[ds].options.sort||t!==B)&&Na.length>1){var n=_o(Xi),a=wo(Xi,":not(."+this.options.selectedClass+")");if(!Cc&&l.animation&&(Xi.thisAnimationDuration=null),f.captureAnimationState(),!Cc&&(l.animation&&(Xi.fromRect=n,Na.forEach(function(p){if(p.thisAnimationDuration=null,p!==Xi){var y=Us?_o(p):n;p.fromRect=y,f.addAnimationState({target:p,rect:y})}})),Bf(),Na.forEach(function(p){o[a]?t.insertBefore(p,o[a]):t.appendChild(p),a++}),h===wo(Xi))){var g=!1;Na.forEach(function(p){if(p.sortableIndex!==wo(p)){g=!0;return}}),g&&m("update")}Na.forEach(function(p){Lh(p)}),f.animateAll()}hl=f}(B===t||e&&e.lastPutMode!=="clone")&&js.forEach(function(p){p.parentNode&&p.parentNode.removeChild(p)})}},nullingGlobal:function(){this.isMultiDrag=qu=!1,js.length=0},destroyGlobal:function(){this._deselectMultiDrag(),ni(document,"pointerup",this._deselectMultiDrag),ni(document,"mouseup",this._deselectMultiDrag),ni(document,"touchend",this._deselectMultiDrag),ni(document,"keydown",this._checkKeyDown),ni(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(r){if(!(typeof qu!="undefined"&&qu)&&hl===this.sortable&&!(r&&cl(r.target,this.options.draggable,this.sortable.el,!1))&&!(r&&r.button!==0))for(;Na.length;){var I=Na[0];go(I,this.options.selectedClass,!1),Na.shift(),_c({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:I,originalEvt:r})}},_checkKeyDown:function(r){r.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(r){r.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},Ys(Je,{pluginName:"multiDrag",utils:{select:function(r){var I=r.parentNode[ds];!I||!I.options.multiDrag||~Na.indexOf(r)||(hl&&hl!==I&&(hl.multiDrag._deselectMultiDrag(),hl=I),go(r,I.options.selectedClass,!0),Na.push(r))},deselect:function(r){var I=r.parentNode[ds],B=Na.indexOf(r);!I||!I.options.multiDrag||!~B||(go(r,I.options.selectedClass,!1),Na.splice(B,1))}},eventProperties:function(){var r=this,I=[],B=[];return Na.forEach(function(t){I.push({multiDragElement:t,index:t.sortableIndex});var d;Us&&t!==Xi?d=-1:Us?d=wo(t,":not(."+r.options.selectedClass+")"):d=wo(t),B.push({multiDragElement:t,index:d})}),{items:am(Na),clones:[].concat(js),oldIndicies:I,newIndicies:B}},optionListeners:{multiDragKey:function(r){return r=r.toLowerCase(),r==="ctrl"?r="Control":r.length>1&&(r=r.charAt(0).toUpperCase()+r.substr(1)),r}}})}function Im(Je,Qe){Na.forEach(function(r,I){var B=Qe.children[r.sortableIndex+(Je?Number(I):0)];B?Qe.insertBefore(r,B):Qe.appendChild(r)})}function Wd(Je,Qe){js.forEach(function(r,I){var B=Qe.children[r.sortableIndex+(Je?Number(I):0)];B?Qe.insertBefore(r,B):Qe.appendChild(r)})}function Bf(){Na.forEach(function(Je){Je!==Xi&&Je.parentNode&&Je.parentNode.removeChild(Je)})}Ia.mount(new Em);Ia.mount(qh,Gh);var Om=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ia,MultiDrag:Pm,Sortable:Ia,Swap:Cm}),Dm=em(Om);(function(Je,Qe){(function(I,B){Je.exports=B(Dm)})(typeof self!="undefined"?self:$g,function(r){return function(I){var B={};function t(d){if(B[d])return B[d].exports;var m=B[d]={i:d,l:!1,exports:{}};return I[d].call(m.exports,m,m.exports,t),m.l=!0,m.exports}return t.m=I,t.c=B,t.d=function(d,m,h){t.o(d,m)||Object.defineProperty(d,m,{enumerable:!0,get:h})},t.r=function(d){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(d,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(d,"__esModule",{value:!0})},t.t=function(d,m){if(m&1&&(d=t(d)),m&8||m&4&&typeof d=="object"&&d&&d.__esModule)return d;var h=Object.create(null);if(t.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:d}),m&2&&typeof d!="string")for(var e in d)t.d(h,e,function(f){return d[f]}.bind(null,e));return h},t.n=function(d){var m=d&&d.__esModule?function(){return d.default}:function(){return d};return t.d(m,"a",m),m},t.o=function(d,m){return Object.prototype.hasOwnProperty.call(d,m)},t.p="",t(t.s="fb15")}({"01f9":function(I,B,t){var d=t("2d00"),m=t("5ca1"),h=t("2aba"),e=t("32e9"),f=t("84f2"),l=t("41a0"),o=t("7f20"),u=t("38fd"),s=t("2b4c")("iterator"),i=!([].keys&&"next"in[].keys()),c="@@iterator",n="keys",a="values",g=function(){return this};I.exports=function(p,y,v,b,x,T,A){l(v,y,b);var S=function(K){if(!i&&K in L)return L[K];switch(K){case n:return function(){return new v(this,K)};case a:return function(){return new v(this,K)}}return function(){return new v(this,K)}},w=y+" Iterator",E=x==a,k=!1,L=p.prototype,M=L[s]||L[c]||x&&L[x],P=M||S(x),D=x?E?S("entries"):P:void 0,N=y=="Array"&&L.entries||M,U,G,X;if(N&&(X=u(N.call(new p)),X!==Object.prototype&&X.next&&(o(X,w,!0),!d&&typeof X[s]!="function"&&e(X,s,g))),E&&M&&M.name!==a&&(k=!0,P=function(){return M.call(this)}),(!d||A)&&(i||k||!L[s])&&e(L,s,P),f[y]=P,f[w]=g,x)if(U={values:E?P:S(a),keys:T?P:S(n),entries:D},A)for(G in U)G in L||h(L,G,U[G]);else m(m.P+m.F*(i||k),y,U);return U}},"02f4":function(I,B,t){var d=t("4588"),m=t("be13");I.exports=function(h){return function(e,f){var l=String(m(e)),o=d(f),u=l.length,s,i;return o<0||o>=u?h?"":void 0:(s=l.charCodeAt(o),s<55296||s>56319||o+1===u||(i=l.charCodeAt(o+1))<56320||i>57343?h?l.charAt(o):s:h?l.slice(o,o+2):(s-55296<<10)+(i-56320)+65536)}}},"0390":function(I,B,t){var d=t("02f4")(!0);I.exports=function(m,h,e){return h+(e?d(m,h).length:1)}},"0bfb":function(I,B,t){var d=t("cb7c");I.exports=function(){var m=d(this),h="";return m.global&&(h+="g"),m.ignoreCase&&(h+="i"),m.multiline&&(h+="m"),m.unicode&&(h+="u"),m.sticky&&(h+="y"),h}},"0d58":function(I,B,t){var d=t("ce10"),m=t("e11e");I.exports=Object.keys||function(e){return d(e,m)}},"1495":function(I,B,t){var d=t("86cc"),m=t("cb7c"),h=t("0d58");I.exports=t("9e1e")?Object.defineProperties:function(f,l){m(f);for(var o=h(l),u=o.length,s=0,i;u>s;)d.f(f,i=o[s++],l[i]);return f}},"214f":function(I,B,t){t("b0c5");var d=t("2aba"),m=t("32e9"),h=t("79e5"),e=t("be13"),f=t("2b4c"),l=t("520a"),o=f("species"),u=!h(function(){var i=/./;return i.exec=function(){var c=[];return c.groups={a:"7"},c},"".replace(i,"$<a>")!=="7"}),s=function(){var i=/(?:)/,c=i.exec;i.exec=function(){return c.apply(this,arguments)};var n="ab".split(i);return n.length===2&&n[0]==="a"&&n[1]==="b"}();I.exports=function(i,c,n){var a=f(i),g=!h(function(){var T={};return T[a]=function(){return 7},""[i](T)!=7}),p=g?!h(function(){var T=!1,A=/a/;return A.exec=function(){return T=!0,null},i==="split"&&(A.constructor={},A.constructor[o]=function(){return A}),A[a](""),!T}):void 0;if(!g||!p||i==="replace"&&!u||i==="split"&&!s){var y=/./[a],v=n(e,a,""[i],function(A,S,w,E,k){return S.exec===l?g&&!k?{done:!0,value:y.call(S,w,E)}:{done:!0,value:A.call(w,S,E)}:{done:!1}}),b=v[0],x=v[1];d(String.prototype,i,b),m(RegExp.prototype,a,c==2?function(T,A){return x.call(T,this,A)}:function(T){return x.call(T,this)})}}},"230e":function(I,B,t){var d=t("d3f4"),m=t("7726").document,h=d(m)&&d(m.createElement);I.exports=function(e){return h?m.createElement(e):{}}},"23c6":function(I,B,t){var d=t("2d95"),m=t("2b4c")("toStringTag"),h=d(function(){return arguments}())=="Arguments",e=function(f,l){try{return f[l]}catch(o){}};I.exports=function(f){var l,o,u;return f===void 0?"Undefined":f===null?"Null":typeof(o=e(l=Object(f),m))=="string"?o:h?d(l):(u=d(l))=="Object"&&typeof l.callee=="function"?"Arguments":u}},"2621":function(I,B){B.f=Object.getOwnPropertySymbols},"2aba":function(I,B,t){var d=t("7726"),m=t("32e9"),h=t("69a8"),e=t("ca5a")("src"),f=t("fa5b"),l="toString",o=(""+f).split(l);t("8378").inspectSource=function(u){return f.call(u)},(I.exports=function(u,s,i,c){var n=typeof i=="function";n&&(h(i,"name")||m(i,"name",s)),u[s]!==i&&(n&&(h(i,e)||m(i,e,u[s]?""+u[s]:o.join(String(s)))),u===d?u[s]=i:c?u[s]?u[s]=i:m(u,s,i):(delete u[s],m(u,s,i)))})(Function.prototype,l,function(){return typeof this=="function"&&this[e]||f.call(this)})},"2aeb":function(I,B,t){var d=t("cb7c"),m=t("1495"),h=t("e11e"),e=t("613b")("IE_PROTO"),f=function(){},l="prototype",o=function(){var u=t("230e")("iframe"),s=h.length,i="<",c=">",n;for(u.style.display="none",t("fab2").appendChild(u),u.src="javascript:",n=u.contentWindow.document,n.open(),n.write(i+"script"+c+"document.F=Object"+i+"/script"+c),n.close(),o=n.F;s--;)delete o[l][h[s]];return o()};I.exports=Object.create||function(s,i){var c;return s!==null?(f[l]=d(s),c=new f,f[l]=null,c[e]=s):c=o(),i===void 0?c:m(c,i)}},"2b4c":function(I,B,t){var d=t("5537")("wks"),m=t("ca5a"),h=t("7726").Symbol,e=typeof h=="function",f=I.exports=function(l){return d[l]||(d[l]=e&&h[l]||(e?h:m)("Symbol."+l))};f.store=d},"2d00":function(I,B){I.exports=!1},"2d95":function(I,B){var t={}.toString;I.exports=function(d){return t.call(d).slice(8,-1)}},"2fdb":function(I,B,t){var d=t("5ca1"),m=t("d2c8"),h="includes";d(d.P+d.F*t("5147")(h),"String",{includes:function(f){return!!~m(this,f,h).indexOf(f,arguments.length>1?arguments[1]:void 0)}})},"32e9":function(I,B,t){var d=t("86cc"),m=t("4630");I.exports=t("9e1e")?function(h,e,f){return d.f(h,e,m(1,f))}:function(h,e,f){return h[e]=f,h}},"38fd":function(I,B,t){var d=t("69a8"),m=t("4bf8"),h=t("613b")("IE_PROTO"),e=Object.prototype;I.exports=Object.getPrototypeOf||function(f){return f=m(f),d(f,h)?f[h]:typeof f.constructor=="function"&&f instanceof f.constructor?f.constructor.prototype:f instanceof Object?e:null}},"41a0":function(I,B,t){var d=t("2aeb"),m=t("4630"),h=t("7f20"),e={};t("32e9")(e,t("2b4c")("iterator"),function(){return this}),I.exports=function(f,l,o){f.prototype=d(e,{next:m(1,o)}),h(f,l+" Iterator")}},"456d":function(I,B,t){var d=t("4bf8"),m=t("0d58");t("5eda")("keys",function(){return function(e){return m(d(e))}})},"4588":function(I,B){var t=Math.ceil,d=Math.floor;I.exports=function(m){return isNaN(m=+m)?0:(m>0?d:t)(m)}},"4630":function(I,B){I.exports=function(t,d){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:d}}},"4bf8":function(I,B,t){var d=t("be13");I.exports=function(m){return Object(d(m))}},"5147":function(I,B,t){var d=t("2b4c")("match");I.exports=function(m){var h=/./;try{"/./"[m](h)}catch(e){try{return h[d]=!1,!"/./"[m](h)}catch(f){}}return!0}},"520a":function(I,B,t){var d=t("0bfb"),m=RegExp.prototype.exec,h=String.prototype.replace,e=m,f="lastIndex",l=function(){var s=/a/,i=/b*/g;return m.call(s,"a"),m.call(i,"a"),s[f]!==0||i[f]!==0}(),o=/()??/.exec("")[1]!==void 0,u=l||o;u&&(e=function(i){var c=this,n,a,g,p;return o&&(a=new RegExp("^"+c.source+"$(?!\\s)",d.call(c))),l&&(n=c[f]),g=m.call(c,i),l&&g&&(c[f]=c.global?g.index+g[0].length:n),o&&g&&g.length>1&&h.call(g[0],a,function(){for(p=1;p<arguments.length-2;p++)arguments[p]===void 0&&(g[p]=void 0)}),g}),I.exports=e},"52a7":function(I,B){B.f={}.propertyIsEnumerable},"5537":function(I,B,t){var d=t("8378"),m=t("7726"),h="__core-js_shared__",e=m[h]||(m[h]={});(I.exports=function(f,l){return e[f]||(e[f]=l!==void 0?l:{})})("versions",[]).push({version:d.version,mode:t("2d00")?"pure":"global",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})},"5ca1":function(I,B,t){var d=t("7726"),m=t("8378"),h=t("32e9"),e=t("2aba"),f=t("9b43"),l="prototype",o=function(u,s,i){var c=u&o.F,n=u&o.G,a=u&o.S,g=u&o.P,p=u&o.B,y=n?d:a?d[s]||(d[s]={}):(d[s]||{})[l],v=n?m:m[s]||(m[s]={}),b=v[l]||(v[l]={}),x,T,A,S;n&&(i=s);for(x in i)T=!c&&y&&y[x]!==void 0,A=(T?y:i)[x],S=p&&T?f(A,d):g&&typeof A=="function"?f(Function.call,A):A,y&&e(y,x,A,u&o.U),v[x]!=A&&h(v,x,S),g&&b[x]!=A&&(b[x]=A)};d.core=m,o.F=1,o.G=2,o.S=4,o.P=8,o.B=16,o.W=32,o.U=64,o.R=128,I.exports=o},"5eda":function(I,B,t){var d=t("5ca1"),m=t("8378"),h=t("79e5");I.exports=function(e,f){var l=(m.Object||{})[e]||Object[e],o={};o[e]=f(l),d(d.S+d.F*h(function(){l(1)}),"Object",o)}},"5f1b":function(I,B,t){var d=t("23c6"),m=RegExp.prototype.exec;I.exports=function(h,e){var f=h.exec;if(typeof f=="function"){var l=f.call(h,e);if(typeof l!="object")throw new TypeError("RegExp exec method returned something other than an Object or null");return l}if(d(h)!=="RegExp")throw new TypeError("RegExp#exec called on incompatible receiver");return m.call(h,e)}},"613b":function(I,B,t){var d=t("5537")("keys"),m=t("ca5a");I.exports=function(h){return d[h]||(d[h]=m(h))}},"626a":function(I,B,t){var d=t("2d95");I.exports=Object("z").propertyIsEnumerable(0)?Object:function(m){return d(m)=="String"?m.split(""):Object(m)}},"6762":function(I,B,t){var d=t("5ca1"),m=t("c366")(!0);d(d.P,"Array",{includes:function(e){return m(this,e,arguments.length>1?arguments[1]:void 0)}}),t("9c6c")("includes")},"6821":function(I,B,t){var d=t("626a"),m=t("be13");I.exports=function(h){return d(m(h))}},"69a8":function(I,B){var t={}.hasOwnProperty;I.exports=function(d,m){return t.call(d,m)}},"6a99":function(I,B,t){var d=t("d3f4");I.exports=function(m,h){if(!d(m))return m;var e,f;if(h&&typeof(e=m.toString)=="function"&&!d(f=e.call(m))||typeof(e=m.valueOf)=="function"&&!d(f=e.call(m))||!h&&typeof(e=m.toString)=="function"&&!d(f=e.call(m)))return f;throw TypeError("Can't convert object to primitive value")}},"7333":function(I,B,t){var d=t("0d58"),m=t("2621"),h=t("52a7"),e=t("4bf8"),f=t("626a"),l=Object.assign;I.exports=!l||t("79e5")(function(){var o={},u={},s=Symbol(),i="abcdefghijklmnopqrst";return o[s]=7,i.split("").forEach(function(c){u[c]=c}),l({},o)[s]!=7||Object.keys(l({},u)).join("")!=i})?function(u,s){for(var i=e(u),c=arguments.length,n=1,a=m.f,g=h.f;c>n;)for(var p=f(arguments[n++]),y=a?d(p).concat(a(p)):d(p),v=y.length,b=0,x;v>b;)g.call(p,x=y[b++])&&(i[x]=p[x]);return i}:l},"7726":function(I,B){var t=I.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=t)},"77f1":function(I,B,t){var d=t("4588"),m=Math.max,h=Math.min;I.exports=function(e,f){return e=d(e),e<0?m(e+f,0):h(e,f)}},"79e5":function(I,B){I.exports=function(t){try{return!!t()}catch(d){return!0}}},"7f20":function(I,B,t){var d=t("86cc").f,m=t("69a8"),h=t("2b4c")("toStringTag");I.exports=function(e,f,l){e&&!m(e=l?e:e.prototype,h)&&d(e,h,{configurable:!0,value:f})}},"8378":function(I,B){var t=I.exports={version:"2.6.5"};typeof __e=="number"&&(__e=t)},"84f2":function(I,B){I.exports={}},"86cc":function(I,B,t){var d=t("cb7c"),m=t("c69a"),h=t("6a99"),e=Object.defineProperty;B.f=t("9e1e")?Object.defineProperty:function(l,o,u){if(d(l),o=h(o,!0),d(u),m)try{return e(l,o,u)}catch(s){}if("get"in u||"set"in u)throw TypeError("Accessors not supported!");return"value"in u&&(l[o]=u.value),l}},"9b43":function(I,B,t){var d=t("d8e8");I.exports=function(m,h,e){if(d(m),h===void 0)return m;switch(e){case 1:return function(f){return m.call(h,f)};case 2:return function(f,l){return m.call(h,f,l)};case 3:return function(f,l,o){return m.call(h,f,l,o)}}return function(){return m.apply(h,arguments)}}},"9c6c":function(I,B,t){var d=t("2b4c")("unscopables"),m=Array.prototype;m[d]==null&&t("32e9")(m,d,{}),I.exports=function(h){m[d][h]=!0}},"9def":function(I,B,t){var d=t("4588"),m=Math.min;I.exports=function(h){return h>0?m(d(h),9007199254740991):0}},"9e1e":function(I,B,t){I.exports=!t("79e5")(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},a352:function(I,B){I.exports=r},a481:function(I,B,t){var d=t("cb7c"),m=t("4bf8"),h=t("9def"),e=t("4588"),f=t("0390"),l=t("5f1b"),o=Math.max,u=Math.min,s=Math.floor,i=/\$([$&`']|\d\d?|<[^>]*>)/g,c=/\$([$&`']|\d\d?)/g,n=function(a){return a===void 0?a:String(a)};t("214f")("replace",2,function(a,g,p,y){return[function(x,T){var A=a(this),S=x==null?void 0:x[g];return S!==void 0?S.call(x,A,T):p.call(String(A),x,T)},function(b,x){var T=y(p,b,this,x);if(T.done)return T.value;var A=d(b),S=String(this),w=typeof x=="function";w||(x=String(x));var E=A.global;if(E){var k=A.unicode;A.lastIndex=0}for(var L=[];;){var M=l(A,S);if(M===null||(L.push(M),!E))break;var P=String(M[0]);P===""&&(A.lastIndex=f(S,h(A.lastIndex),k))}for(var D="",N=0,U=0;U<L.length;U++){M=L[U];for(var G=String(M[0]),X=o(u(e(M.index),S.length),0),K=[],Z=1;Z<M.length;Z++)K.push(n(M[Z]));var H=M.groups;if(w){var Y=[G].concat(K,X,S);H!==void 0&&Y.push(H);var $=String(x.apply(void 0,Y))}else $=v(G,S,X,K,H,x);X>=N&&(D+=S.slice(N,X)+$,N=X+G.length)}return D+S.slice(N)}];function v(b,x,T,A,S,w){var E=T+b.length,k=A.length,L=c;return S!==void 0&&(S=m(S),L=i),p.call(w,L,function(M,P){var D;switch(P.charAt(0)){case"$":return"$";case"&":return b;case"`":return x.slice(0,T);case"'":return x.slice(E);case"<":D=S[P.slice(1,-1)];break;default:var N=+P;if(N===0)return M;if(N>k){var U=s(N/10);return U===0?M:U<=k?A[U-1]===void 0?P.charAt(1):A[U-1]+P.charAt(1):M}D=A[N-1]}return D===void 0?"":D})}})},aae3:function(I,B,t){var d=t("d3f4"),m=t("2d95"),h=t("2b4c")("match");I.exports=function(e){var f;return d(e)&&((f=e[h])!==void 0?!!f:m(e)=="RegExp")}},ac6a:function(I,B,t){for(var d=t("cadf"),m=t("0d58"),h=t("2aba"),e=t("7726"),f=t("32e9"),l=t("84f2"),o=t("2b4c"),u=o("iterator"),s=o("toStringTag"),i=l.Array,c={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},n=m(c),a=0;a<n.length;a++){var g=n[a],p=c[g],y=e[g],v=y&&y.prototype,b;if(v&&(v[u]||f(v,u,i),v[s]||f(v,s,g),l[g]=i,p))for(b in d)v[b]||h(v,b,d[b],!0)}},b0c5:function(I,B,t){var d=t("520a");t("5ca1")({target:"RegExp",proto:!0,forced:d!==/./.exec},{exec:d})},be13:function(I,B){I.exports=function(t){if(t==null)throw TypeError("Can't call method on  "+t);return t}},c366:function(I,B,t){var d=t("6821"),m=t("9def"),h=t("77f1");I.exports=function(e){return function(f,l,o){var u=d(f),s=m(u.length),i=h(o,s),c;if(e&&l!=l){for(;s>i;)if(c=u[i++],c!=c)return!0}else for(;s>i;i++)if((e||i in u)&&u[i]===l)return e||i||0;return!e&&-1}}},c649:function(I,B,t){(function(d){t.d(B,"c",function(){return u}),t.d(B,"a",function(){return l}),t.d(B,"b",function(){return h}),t.d(B,"d",function(){return o}),t("a481");function m(){return typeof window!="undefined"?window.console:d.console}var h=m();function e(s){var i=Object.create(null);return function(n){var a=i[n];return a||(i[n]=s(n))}}var f=/-(\w)/g,l=e(function(s){return s.replace(f,function(i,c){return c?c.toUpperCase():""})});function o(s){s.parentElement!==null&&s.parentElement.removeChild(s)}function u(s,i,c){var n=c===0?s.children[0]:s.children[c-1].nextSibling;s.insertBefore(i,n)}}).call(this,t("c8ba"))},c69a:function(I,B,t){I.exports=!t("9e1e")&&!t("79e5")(function(){return Object.defineProperty(t("230e")("div"),"a",{get:function(){return 7}}).a!=7})},c8ba:function(I,B){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(d){typeof window=="object"&&(t=window)}I.exports=t},ca5a:function(I,B){var t=0,d=Math.random();I.exports=function(m){return"Symbol(".concat(m===void 0?"":m,")_",(++t+d).toString(36))}},cadf:function(I,B,t){var d=t("9c6c"),m=t("d53b"),h=t("84f2"),e=t("6821");I.exports=t("01f9")(Array,"Array",function(f,l){this._t=e(f),this._i=0,this._k=l},function(){var f=this._t,l=this._k,o=this._i++;return!f||o>=f.length?(this._t=void 0,m(1)):l=="keys"?m(0,o):l=="values"?m(0,f[o]):m(0,[o,f[o]])},"values"),h.Arguments=h.Array,d("keys"),d("values"),d("entries")},cb7c:function(I,B,t){var d=t("d3f4");I.exports=function(m){if(!d(m))throw TypeError(m+" is not an object!");return m}},ce10:function(I,B,t){var d=t("69a8"),m=t("6821"),h=t("c366")(!1),e=t("613b")("IE_PROTO");I.exports=function(f,l){var o=m(f),u=0,s=[],i;for(i in o)i!=e&&d(o,i)&&s.push(i);for(;l.length>u;)d(o,i=l[u++])&&(~h(s,i)||s.push(i));return s}},d2c8:function(I,B,t){var d=t("aae3"),m=t("be13");I.exports=function(h,e,f){if(d(e))throw TypeError("String#"+f+" doesn't accept regex!");return String(m(h))}},d3f4:function(I,B){I.exports=function(t){return typeof t=="object"?t!==null:typeof t=="function"}},d53b:function(I,B){I.exports=function(t,d){return{value:d,done:!!t}}},d8e8:function(I,B){I.exports=function(t){if(typeof t!="function")throw TypeError(t+" is not a function!");return t}},e11e:function(I,B){I.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},f559:function(I,B,t){var d=t("5ca1"),m=t("9def"),h=t("d2c8"),e="startsWith",f=""[e];d(d.P+d.F*t("5147")(e),"String",{startsWith:function(o){var u=h(this,o,e),s=m(Math.min(arguments.length>1?arguments[1]:void 0,u.length)),i=String(o);return f?f.call(u,i,s):u.slice(s,s+i.length)===i}})},f6fd:function(I,B){(function(t){var d="currentScript",m=t.getElementsByTagName("script");d in t||Object.defineProperty(t,d,{get:function(){try{throw new Error}catch(f){var h,e=(/.*at [^\(]*\((.*):.+:.+\)$/ig.exec(f.stack)||[!1])[1];for(h in m)if(m[h].src==e||m[h].readyState=="interactive")return m[h];return null}}})})(document)},f751:function(I,B,t){var d=t("5ca1");d(d.S+d.F,"Object",{assign:t("7333")})},fa5b:function(I,B,t){I.exports=t("5537")("native-function-to-string",Function.toString)},fab2:function(I,B,t){var d=t("7726").document;I.exports=d&&d.documentElement},fb15:function(I,B,t){if(t.r(B),typeof window!="undefined"){t("f6fd");var d;(d=window.document.currentScript)&&(d=d.src.match(/(.+\/)[^/]+\.js(\?.*)?$/))&&(t.p=d[1])}t("f751"),t("f559"),t("ac6a"),t("cadf"),t("456d");function m(G){if(Array.isArray(G))return G}function h(G,X){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(G)))){var K=[],Z=!0,H=!1,Y=void 0;try{for(var $=G[Symbol.iterator](),z;!(Z=(z=$.next()).done)&&(K.push(z.value),!(X&&K.length===X));Z=!0);}catch(j){H=!0,Y=j}finally{try{!Z&&$.return!=null&&$.return()}finally{if(H)throw Y}}return K}}function e(G,X){(X==null||X>G.length)&&(X=G.length);for(var K=0,Z=new Array(X);K<X;K++)Z[K]=G[K];return Z}function f(G,X){if(!!G){if(typeof G=="string")return e(G,X);var K=Object.prototype.toString.call(G).slice(8,-1);if(K==="Object"&&G.constructor&&(K=G.constructor.name),K==="Map"||K==="Set")return Array.from(G);if(K==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(K))return e(G,X)}}function l(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o(G,X){return m(G)||h(G,X)||f(G,X)||l()}t("6762"),t("2fdb");function u(G){if(Array.isArray(G))return e(G)}function s(G){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(G))return Array.from(G)}function i(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c(G){return u(G)||s(G)||f(G)||i()}var n=t("a352"),a=t.n(n),g=t("c649");function p(G,X,K){return K===void 0||(G=G||{},G[X]=K),G}function y(G,X){return G.map(function(K){return K.elm}).indexOf(X)}function v(G,X,K,Z){if(!G)return[];var H=G.map(function(z){return z.elm}),Y=X.length-Z,$=c(X).map(function(z,j){return j>=Y?H.length:H.indexOf(z)});return K?$.filter(function(z){return z!==-1}):$}function b(G,X){var K=this;this.$nextTick(function(){return K.$emit(G.toLowerCase(),X)})}function x(G){var X=this;return function(K){X.realList!==null&&X["onDrag"+G](K),b.call(X,G,K)}}function T(G){return["transition-group","TransitionGroup"].includes(G)}function A(G){if(!G||G.length!==1)return!1;var X=o(G,1),K=X[0].componentOptions;return K?T(K.tag):!1}function S(G,X,K){return G[K]||(X[K]?X[K]():void 0)}function w(G,X,K){var Z=0,H=0,Y=S(X,K,"header");Y&&(Z=Y.length,G=G?[].concat(c(Y),c(G)):c(Y));var $=S(X,K,"footer");return $&&(H=$.length,G=G?[].concat(c(G),c($)):c($)),{children:G,headerOffset:Z,footerOffset:H}}function E(G,X){var K=null,Z=function(W,ee){K=p(K,W,ee)},H=Object.keys(G).filter(function(j){return j==="id"||j.startsWith("data-")}).reduce(function(j,W){return j[W]=G[W],j},{});if(Z("attrs",H),!X)return K;var Y=X.on,$=X.props,z=X.attrs;return Z("on",Y),Z("props",$),Object.assign(K.attrs,z),K}var k=["Start","Add","Remove","Update","End"],L=["Choose","Unchoose","Sort","Filter","Clone"],M=["Move"].concat(k,L).map(function(G){return"on"+G}),P=null,D={options:Object,list:{type:Array,required:!1,default:null},value:{type:Array,required:!1,default:null},noTransitionOnDrag:{type:Boolean,default:!1},clone:{type:Function,default:function(X){return X}},element:{type:String,default:"div"},tag:{type:String,default:null},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},N={name:"draggable",inheritAttrs:!1,props:D,data:function(){return{transitionMode:!1,noneFunctionalComponentMode:!1}},render:function(X){var K=this.$slots.default;this.transitionMode=A(K);var Z=w(K,this.$slots,this.$scopedSlots),H=Z.children,Y=Z.headerOffset,$=Z.footerOffset;this.headerOffset=Y,this.footerOffset=$;var z=E(this.$attrs,this.componentData);return X(this.getTag(),z,H)},created:function(){this.list!==null&&this.value!==null&&g.b.error("Value and list props are mutually exclusive! Please set one or another."),this.element!=="div"&&g.b.warn("Element props is deprecated please use tag props instead. See https://github.com/SortableJS/Vue.Draggable/blob/master/documentation/migrate.md#element-props"),this.options!==void 0&&g.b.warn("Options props is deprecated, add sortable options directly as vue.draggable item, or use v-bind. See https://github.com/SortableJS/Vue.Draggable/blob/master/documentation/migrate.md#options-props")},mounted:function(){var X=this;if(this.noneFunctionalComponentMode=this.getTag().toLowerCase()!==this.$el.nodeName.toLowerCase()&&!this.getIsFunctional(),this.noneFunctionalComponentMode&&this.transitionMode)throw new Error("Transition-group inside component is not supported. Please alter tag value or remove transition-group. Current tag value: ".concat(this.getTag()));var K={};k.forEach(function(Y){K["on"+Y]=x.call(X,Y)}),L.forEach(function(Y){K["on"+Y]=b.bind(X,Y)});var Z=Object.keys(this.$attrs).reduce(function(Y,$){return Y[Object(g.a)($)]=X.$attrs[$],Y},{}),H=Object.assign({},this.options,Z,K,{onMove:function($,z){return X.onDragMove($,z)}});!("draggable"in H)&&(H.draggable=">*"),this._sortable=new a.a(this.rootContainer,H),this.computeIndexes()},beforeDestroy:function(){this._sortable!==void 0&&this._sortable.destroy()},computed:{rootContainer:function(){return this.transitionMode?this.$el.children[0]:this.$el},realList:function(){return this.list?this.list:this.value}},watch:{options:{handler:function(X){this.updateOptions(X)},deep:!0},$attrs:{handler:function(X){this.updateOptions(X)},deep:!0},realList:function(){this.computeIndexes()}},methods:{getIsFunctional:function(){var X=this._vnode.fnOptions;return X&&X.functional},getTag:function(){return this.tag||this.element},updateOptions:function(X){for(var K in X){var Z=Object(g.a)(K);M.indexOf(Z)===-1&&this._sortable.option(Z,X[K])}},getChildrenNodes:function(){if(this.noneFunctionalComponentMode)return this.$children[0].$slots.default;var X=this.$slots.default;return this.transitionMode?X[0].child.$slots.default:X},computeIndexes:function(){var X=this;this.$nextTick(function(){X.visibleIndexes=v(X.getChildrenNodes(),X.rootContainer.children,X.transitionMode,X.footerOffset)})},getUnderlyingVm:function(X){var K=y(this.getChildrenNodes()||[],X);if(K===-1)return null;var Z=this.realList[K];return{index:K,element:Z}},getUnderlyingPotencialDraggableComponent:function(X){var K=X.__vue__;return!K||!K.$options||!T(K.$options._componentTag)?!("realList"in K)&&K.$children.length===1&&"realList"in K.$children[0]?K.$children[0]:K:K.$parent},emitChanges:function(X){var K=this;this.$nextTick(function(){K.$emit("change",X)})},alterList:function(X){if(this.list){X(this.list);return}var K=c(this.value);X(K),this.$emit("input",K)},spliceList:function(){var X=arguments,K=function(H){return H.splice.apply(H,c(X))};this.alterList(K)},updatePosition:function(X,K){var Z=function(Y){return Y.splice(K,0,Y.splice(X,1)[0])};this.alterList(Z)},getRelatedContextFromMoveEvent:function(X){var K=X.to,Z=X.related,H=this.getUnderlyingPotencialDraggableComponent(K);if(!H)return{component:H};var Y=H.realList,$={list:Y,component:H};if(K!==Z&&Y&&H.getUnderlyingVm){var z=H.getUnderlyingVm(Z);if(z)return Object.assign(z,$)}return $},getVmIndex:function(X){var K=this.visibleIndexes,Z=K.length;return X>Z-1?Z:K[X]},getComponent:function(){return this.$slots.default[0].componentInstance},resetTransitionData:function(X){if(!(!this.noTransitionOnDrag||!this.transitionMode)){var K=this.getChildrenNodes();K[X].data=null;var Z=this.getComponent();Z.children=[],Z.kept=void 0}},onDragStart:function(X){this.context=this.getUnderlyingVm(X.item),X.item._underlying_vm_=this.clone(this.context.element),P=X.item},onDragAdd:function(X){var K=X.item._underlying_vm_;if(K!==void 0){Object(g.d)(X.item);var Z=this.getVmIndex(X.newIndex);this.spliceList(Z,0,K),this.computeIndexes();var H={element:K,newIndex:Z};this.emitChanges({added:H})}},onDragRemove:function(X){if(Object(g.c)(this.rootContainer,X.item,X.oldIndex),X.pullMode==="clone"){Object(g.d)(X.clone);return}var K=this.context.index;this.spliceList(K,1);var Z={element:this.context.element,oldIndex:K};this.resetTransitionData(K),this.emitChanges({removed:Z})},onDragUpdate:function(X){Object(g.d)(X.item),Object(g.c)(X.from,X.item,X.oldIndex);var K=this.context.index,Z=this.getVmIndex(X.newIndex);this.updatePosition(K,Z);var H={element:this.context.element,oldIndex:K,newIndex:Z};this.emitChanges({moved:H})},updateProperty:function(X,K){X.hasOwnProperty(K)&&(X[K]+=this.headerOffset)},computeFutureIndex:function(X,K){if(!X.element)return 0;var Z=c(K.to.children).filter(function(z){return z.style.display!=="none"}),H=Z.indexOf(K.related),Y=X.component.getVmIndex(H),$=Z.indexOf(P)!==-1;return $||!K.willInsertAfter?Y:Y+1},onDragMove:function(X,K){var Z=this.move;if(!Z||!this.realList)return!0;var H=this.getRelatedContextFromMoveEvent(X),Y=this.context,$=this.computeFutureIndex(H,X);Object.assign(Y,{futureIndex:$});var z=Object.assign({},X,{relatedContext:H,draggedContext:Y});return Z(z,K)},onDragEnd:function(){this.computeIndexes(),P=null}}};typeof window!="undefined"&&"Vue"in window&&window.Vue.component("draggable",N);var U=N;B.default=U}}).default})})(Md);var zm=Qg(Md.exports),Rm=Object.defineProperty,Fm=Object.defineProperties,Bm=Object.getOwnPropertyDescriptors,Xd=Object.getOwnPropertySymbols,Nm=Object.prototype.hasOwnProperty,jm=Object.prototype.propertyIsEnumerable,Zd=(Je,Qe,r)=>Qe in Je?Rm(Je,Qe,{enumerable:!0,configurable:!0,writable:!0,value:r}):Je[Qe]=r,Nf=(Je,Qe)=>{for(var r in Qe||(Qe={}))Nm.call(Qe,r)&&Zd(Je,r,Qe[r]);if(Xd)for(var r of Xd(Qe))jm.call(Qe,r)&&Zd(Je,r,Qe[r]);return Je},Um=(Je,Qe)=>Fm(Je,Bm(Qe)),vi=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Kd(Je){return Je&&Je.__esModule&&Object.prototype.hasOwnProperty.call(Je,"default")?Je.default:Je}function jf(Je){throw new Error('Could not dynamically require "'+Je+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Jd={exports:{}};(function(Je,Qe){(function(r){Je.exports=r()})(function(){return function r(I,B,t){function d(e,f){if(!B[e]){if(!I[e]){var l=typeof jf=="function"&&jf;if(!f&&l)return l(e,!0);if(m)return m(e,!0);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}var u=B[e]={exports:{}};I[e][0].call(u.exports,function(s){return d(I[e][1][s]||s)},u,u.exports,r,I,B,t)}return B[e].exports}for(var m=typeof jf=="function"&&jf,h=0;h<t.length;h++)d(t[h]);return d}({1:[function(r,I,B){var t=r("../src/lib"),d={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid transparent;border-left-color:#69738a;margin-top:8px;margin-right:-30px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:#fff;","X .select-outline-2":"stroke:#000;stroke-dasharray:2px 2px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var m in d){var h=m.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");t.addStyleRule(h,d[m])}},{"../src/lib":787}],2:[function(r,I,B){I.exports=r("../src/transforms/aggregate")},{"../src/transforms/aggregate":1383}],3:[function(r,I,B){I.exports=r("../src/traces/bar")},{"../src/traces/bar":933}],4:[function(r,I,B){I.exports=r("../src/traces/barpolar")},{"../src/traces/barpolar":946}],5:[function(r,I,B){I.exports=r("../src/traces/box")},{"../src/traces/box":956}],6:[function(r,I,B){I.exports=r("../src/components/calendars")},{"../src/components/calendars":648}],7:[function(r,I,B){I.exports=r("../src/traces/candlestick")},{"../src/traces/candlestick":965}],8:[function(r,I,B){I.exports=r("../src/traces/carpet")},{"../src/traces/carpet":984}],9:[function(r,I,B){I.exports=r("../src/traces/choropleth")},{"../src/traces/choropleth":998}],10:[function(r,I,B){I.exports=r("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":1005}],11:[function(r,I,B){I.exports=r("../src/traces/cone")},{"../src/traces/cone":1011}],12:[function(r,I,B){I.exports=r("../src/traces/contour")},{"../src/traces/contour":1026}],13:[function(r,I,B){I.exports=r("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":1037}],14:[function(r,I,B){I.exports=r("../src/core")},{"../src/core":765}],15:[function(r,I,B){I.exports=r("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":1045}],16:[function(r,I,B){I.exports=r("../src/transforms/filter")},{"../src/transforms/filter":1384}],17:[function(r,I,B){I.exports=r("../src/traces/funnel")},{"../src/traces/funnel":1055}],18:[function(r,I,B){I.exports=r("../src/traces/funnelarea")},{"../src/traces/funnelarea":1064}],19:[function(r,I,B){I.exports=r("../src/transforms/groupby")},{"../src/transforms/groupby":1385}],20:[function(r,I,B){I.exports=r("../src/traces/heatmap")},{"../src/traces/heatmap":1077}],21:[function(r,I,B){I.exports=r("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":1087}],22:[function(r,I,B){I.exports=r("../src/traces/histogram")},{"../src/traces/histogram":1099}],23:[function(r,I,B){I.exports=r("../src/traces/histogram2d")},{"../src/traces/histogram2d":1105}],24:[function(r,I,B){I.exports=r("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":1109}],25:[function(r,I,B){I.exports=r("../src/traces/icicle")},{"../src/traces/icicle":1115}],26:[function(r,I,B){I.exports=r("../src/traces/image")},{"../src/traces/image":1128}],27:[function(r,I,B){var t=r("./core");t.register([r("./bar"),r("./box"),r("./heatmap"),r("./histogram"),r("./histogram2d"),r("./histogram2dcontour"),r("./contour"),r("./scatterternary"),r("./violin"),r("./funnel"),r("./waterfall"),r("./image"),r("./pie"),r("./sunburst"),r("./treemap"),r("./icicle"),r("./funnelarea"),r("./scatter3d"),r("./surface"),r("./isosurface"),r("./volume"),r("./mesh3d"),r("./cone"),r("./streamtube"),r("./scattergeo"),r("./choropleth"),r("./scattergl"),r("./splom"),r("./pointcloud"),r("./heatmapgl"),r("./parcoords"),r("./parcats"),r("./scattermapbox"),r("./choroplethmapbox"),r("./densitymapbox"),r("./sankey"),r("./indicator"),r("./table"),r("./carpet"),r("./scattercarpet"),r("./contourcarpet"),r("./ohlc"),r("./candlestick"),r("./scatterpolar"),r("./scatterpolargl"),r("./barpolar"),r("./aggregate"),r("./filter"),r("./groupby"),r("./sort"),r("./calendars")]),I.exports=t},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scatterternary":44,"./sort":45,"./splom":46,"./streamtube":47,"./sunburst":48,"./surface":49,"./table":50,"./treemap":51,"./violin":52,"./volume":53,"./waterfall":54}],28:[function(r,I,B){I.exports=r("../src/traces/indicator")},{"../src/traces/indicator":1136}],29:[function(r,I,B){I.exports=r("../src/traces/isosurface")},{"../src/traces/isosurface":1142}],30:[function(r,I,B){I.exports=r("../src/traces/mesh3d")},{"../src/traces/mesh3d":1147}],31:[function(r,I,B){I.exports=r("../src/traces/ohlc")},{"../src/traces/ohlc":1152}],32:[function(r,I,B){I.exports=r("../src/traces/parcats")},{"../src/traces/parcats":1161}],33:[function(r,I,B){I.exports=r("../src/traces/parcoords")},{"../src/traces/parcoords":1171}],34:[function(r,I,B){I.exports=r("../src/traces/pie")},{"../src/traces/pie":1182}],35:[function(r,I,B){I.exports=r("../src/traces/pointcloud")},{"../src/traces/pointcloud":1191}],36:[function(r,I,B){I.exports=r("../src/traces/sankey")},{"../src/traces/sankey":1197}],37:[function(r,I,B){I.exports=r("../src/traces/scatter3d")},{"../src/traces/scatter3d":1235}],38:[function(r,I,B){I.exports=r("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":1242}],39:[function(r,I,B){I.exports=r("../src/traces/scattergeo")},{"../src/traces/scattergeo":1250}],40:[function(r,I,B){I.exports=r("../src/traces/scattergl")},{"../src/traces/scattergl":1263}],41:[function(r,I,B){I.exports=r("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1273}],42:[function(r,I,B){I.exports=r("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1281}],43:[function(r,I,B){I.exports=r("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1288}],44:[function(r,I,B){I.exports=r("../src/traces/scatterternary")},{"../src/traces/scatterternary":1296}],45:[function(r,I,B){I.exports=r("../src/transforms/sort")},{"../src/transforms/sort":1387}],46:[function(r,I,B){I.exports=r("../src/traces/splom")},{"../src/traces/splom":1305}],47:[function(r,I,B){I.exports=r("../src/traces/streamtube")},{"../src/traces/streamtube":1313}],48:[function(r,I,B){I.exports=r("../src/traces/sunburst")},{"../src/traces/sunburst":1321}],49:[function(r,I,B){I.exports=r("../src/traces/surface")},{"../src/traces/surface":1330}],50:[function(r,I,B){I.exports=r("../src/traces/table")},{"../src/traces/table":1338}],51:[function(r,I,B){I.exports=r("../src/traces/treemap")},{"../src/traces/treemap":1349}],52:[function(r,I,B){I.exports=r("../src/traces/violin")},{"../src/traces/violin":1362}],53:[function(r,I,B){I.exports=r("../src/traces/volume")},{"../src/traces/volume":1370}],54:[function(r,I,B){I.exports=r("../src/traces/waterfall")},{"../src/traces/waterfall":1378}],55:[function(r,I,B){I.exports=function(f){var l=(f=f||{}).eye||[0,0,1],o=f.center||[0,0,0],u=f.up||[0,1,0],s=f.distanceLimits||[0,1/0],i=f.mode||"turntable",c=t(),n=d(),a=m();return c.setDistanceLimits(s[0],s[1]),c.lookAt(0,l,o,u),n.setDistanceLimits(s[0],s[1]),n.lookAt(0,l,o,u),a.setDistanceLimits(s[0],s[1]),a.lookAt(0,l,o,u),new h({turntable:c,orbit:n,matrix:a},i)};var t=r("turntable-camera-controller"),d=r("orbit-camera-controller"),m=r("matrix-camera-controller");function h(f,l){this._controllerNames=Object.keys(f),this._controllerList=this._controllerNames.map(function(o){return f[o]}),this._mode=l,this._active=f[l],this._active||(this._mode="turntable",this._active=f.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var e=h.prototype;e.flush=function(f){for(var l=this._controllerList,o=0;o<l.length;++o)l[o].flush(f)},e.idle=function(f){for(var l=this._controllerList,o=0;o<l.length;++o)l[o].idle(f)},e.lookAt=function(f,l,o,u){for(var s=this._controllerList,i=0;i<s.length;++i)s[i].lookAt(f,l,o,u)},e.rotate=function(f,l,o,u){for(var s=this._controllerList,i=0;i<s.length;++i)s[i].rotate(f,l,o,u)},e.pan=function(f,l,o,u){for(var s=this._controllerList,i=0;i<s.length;++i)s[i].pan(f,l,o,u)},e.translate=function(f,l,o,u){for(var s=this._controllerList,i=0;i<s.length;++i)s[i].translate(f,l,o,u)},e.setMatrix=function(f,l){for(var o=this._controllerList,u=0;u<o.length;++u)o[u].setMatrix(f,l)},e.setDistanceLimits=function(f,l){for(var o=this._controllerList,u=0;u<o.length;++u)o[u].setDistanceLimits(f,l)},e.setDistance=function(f,l){for(var o=this._controllerList,u=0;u<o.length;++u)o[u].setDistance(f,l)},e.recalcMatrix=function(f){this._active.recalcMatrix(f)},e.getDistance=function(f){return this._active.getDistance(f)},e.getDistanceLimits=function(f){return this._active.getDistanceLimits(f)},e.lastT=function(){return this._active.lastT()},e.setMode=function(f){if(f!==this._mode){var l=this._controllerNames.indexOf(f);if(!(l<0)){var o=this._active,u=this._controllerList[l],s=Math.max(o.lastT(),u.lastT());o.recalcMatrix(s),u.setMatrix(s,o.computedMatrix),this._active=u,this._mode=f,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},e.getMode=function(){return this._mode}},{"matrix-camera-controller":457,"orbit-camera-controller":478,"turntable-camera-controller":587}],56:[function(r,I,B){(function(t,d){typeof B=="object"&&I!==void 0?d(B,r("d3-array"),r("d3-collection"),r("d3-shape"),r("elementary-circuits-directed-graph")):d(t.d3=t.d3||{},t.d3,t.d3,t.d3,null)})(this,function(t,d,m,h,e){function f(ie){return ie.target.depth}function l(ie,ae){return ie.sourceLinks.length?ie.depth:ae-1}function o(ie){return function(){return ie}}e=e&&e.hasOwnProperty("default")?e.default:e;var u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ie){return typeof ie}:function(ie){return ie&&typeof Symbol=="function"&&ie.constructor===Symbol&&ie!==Symbol.prototype?"symbol":typeof ie};function s(ie,ae){return c(ie.source,ae.source)||ie.index-ae.index}function i(ie,ae){return c(ie.target,ae.target)||ie.index-ae.index}function c(ie,ae){return ie.partOfCycle===ae.partOfCycle?ie.y0-ae.y0:ie.circularLinkType==="top"||ae.circularLinkType==="bottom"?-1:1}function n(ie){return ie.value}function a(ie){return(ie.y0+ie.y1)/2}function g(ie){return a(ie.source)}function p(ie){return a(ie.target)}function y(ie){return ie.index}function v(ie){return ie.nodes}function b(ie){return ie.links}function x(ie,ae){var he=ie.get(ae);if(!he)throw new Error("missing: "+ae);return he}function T(ie,ae){return ae(ie)}function A(ie,ae,he){var se=0;if(he===null){for(var de=[],ue=0;ue<ie.links.length;ue++){var ve=ie.links[ue],ke=ve.source.index,Ee=ve.target.index;de[ke]||(de[ke]=[]),de[Ee]||(de[Ee]=[]),de[ke].indexOf(Ee)===-1&&de[ke].push(Ee)}var be=e(de);be.sort(function(ge,we){return ge.length-we.length});var xe={};for(ue=0;ue<be.length;ue++){var ce=be[ue].slice(-2);xe[ce[0]]||(xe[ce[0]]={}),xe[ce[0]][ce[1]]=!0}ie.links.forEach(function(ge){var we=ge.target.index,Me=ge.source.index;we===Me||xe[Me]&&xe[Me][we]?(ge.circular=!0,ge.circularLinkID=se,se+=1):ge.circular=!1})}else ie.links.forEach(function(ge){ge.source[he]<ge.target[he]?ge.circular=!1:(ge.circular=!0,ge.circularLinkID=se,se+=1)})}function S(ie,ae){var he=0,se=0;ie.links.forEach(function(de){de.circular&&(de.source.circularLinkType||de.target.circularLinkType?de.circularLinkType=de.source.circularLinkType?de.source.circularLinkType:de.target.circularLinkType:de.circularLinkType=he<se?"top":"bottom",de.circularLinkType=="top"?he+=1:se+=1,ie.nodes.forEach(function(ue){T(ue,ae)!=T(de.source,ae)&&T(ue,ae)!=T(de.target,ae)||(ue.circularLinkType=de.circularLinkType)}))}),ie.links.forEach(function(de){de.circular&&(de.source.circularLinkType==de.target.circularLinkType&&(de.circularLinkType=de.source.circularLinkType),Q(de,ae)&&(de.circularLinkType=de.source.circularLinkType))})}function w(ie){var ae=Math.abs(ie.y1-ie.y0),he=Math.abs(ie.target.x0-ie.source.x1);return Math.atan(he/ae)}function E(ie,ae){var he=0;ie.sourceLinks.forEach(function(de){he=de.circular&&!Q(de,ae)?he+1:he});var se=0;return ie.targetLinks.forEach(function(de){se=de.circular&&!Q(de,ae)?se+1:se}),he+se}function k(ie){var ae=ie.source.sourceLinks,he=0;ae.forEach(function(ue){he=ue.circular?he+1:he});var se=ie.target.targetLinks,de=0;return se.forEach(function(ue){de=ue.circular?de+1:de}),!(he>1||de>1)}function L(ie,ae,he){return ie.sort(P),ie.forEach(function(se,de){var ue,ve,ke=0;if(Q(se,he)&&k(se))se.circularPathData.verticalBuffer=ke+se.width/2;else{for(var Ee=0;Ee<de;Ee++)if(ue=ie[de],ve=ie[Ee],!(ue.source.column<ve.target.column||ue.target.column>ve.source.column)){var be=ie[Ee].circularPathData.verticalBuffer+ie[Ee].width/2+ae;ke=be>ke?be:ke}se.circularPathData.verticalBuffer=ke+se.width/2}}),ie}function M(ie,ae,he,se){var de=d.min(ie.links,function(ue){return ue.source.y0});ie.links.forEach(function(ue){ue.circular&&(ue.circularPathData={})}),L(ie.links.filter(function(ue){return ue.circularLinkType=="top"}),ae,se),L(ie.links.filter(function(ue){return ue.circularLinkType=="bottom"}),ae,se),ie.links.forEach(function(ue){if(ue.circular){if(ue.circularPathData.arcRadius=ue.width+10,ue.circularPathData.leftNodeBuffer=5,ue.circularPathData.rightNodeBuffer=5,ue.circularPathData.sourceWidth=ue.source.x1-ue.source.x0,ue.circularPathData.sourceX=ue.source.x0+ue.circularPathData.sourceWidth,ue.circularPathData.targetX=ue.target.x0,ue.circularPathData.sourceY=ue.y0,ue.circularPathData.targetY=ue.y1,Q(ue,se)&&k(ue))ue.circularPathData.leftSmallArcRadius=10+ue.width/2,ue.circularPathData.leftLargeArcRadius=10+ue.width/2,ue.circularPathData.rightSmallArcRadius=10+ue.width/2,ue.circularPathData.rightLargeArcRadius=10+ue.width/2,ue.circularLinkType=="bottom"?(ue.circularPathData.verticalFullExtent=ue.source.y1+25+ue.circularPathData.verticalBuffer,ue.circularPathData.verticalLeftInnerExtent=ue.circularPathData.verticalFullExtent-ue.circularPathData.leftLargeArcRadius,ue.circularPathData.verticalRightInnerExtent=ue.circularPathData.verticalFullExtent-ue.circularPathData.rightLargeArcRadius):(ue.circularPathData.verticalFullExtent=ue.source.y0-25-ue.circularPathData.verticalBuffer,ue.circularPathData.verticalLeftInnerExtent=ue.circularPathData.verticalFullExtent+ue.circularPathData.leftLargeArcRadius,ue.circularPathData.verticalRightInnerExtent=ue.circularPathData.verticalFullExtent+ue.circularPathData.rightLargeArcRadius);else{var ve=ue.source.column,ke=ue.circularLinkType,Ee=ie.links.filter(function(ce){return ce.source.column==ve&&ce.circularLinkType==ke});ue.circularLinkType=="bottom"?Ee.sort(N):Ee.sort(D);var be=0;Ee.forEach(function(ce,ge){ce.circularLinkID==ue.circularLinkID&&(ue.circularPathData.leftSmallArcRadius=10+ue.width/2+be,ue.circularPathData.leftLargeArcRadius=10+ue.width/2+ge*ae+be),be+=ce.width}),ve=ue.target.column,Ee=ie.links.filter(function(ce){return ce.target.column==ve&&ce.circularLinkType==ke}),ue.circularLinkType=="bottom"?Ee.sort(G):Ee.sort(U),be=0,Ee.forEach(function(ce,ge){ce.circularLinkID==ue.circularLinkID&&(ue.circularPathData.rightSmallArcRadius=10+ue.width/2+be,ue.circularPathData.rightLargeArcRadius=10+ue.width/2+ge*ae+be),be+=ce.width}),ue.circularLinkType=="bottom"?(ue.circularPathData.verticalFullExtent=Math.max(he,ue.source.y1,ue.target.y1)+25+ue.circularPathData.verticalBuffer,ue.circularPathData.verticalLeftInnerExtent=ue.circularPathData.verticalFullExtent-ue.circularPathData.leftLargeArcRadius,ue.circularPathData.verticalRightInnerExtent=ue.circularPathData.verticalFullExtent-ue.circularPathData.rightLargeArcRadius):(ue.circularPathData.verticalFullExtent=de-25-ue.circularPathData.verticalBuffer,ue.circularPathData.verticalLeftInnerExtent=ue.circularPathData.verticalFullExtent+ue.circularPathData.leftLargeArcRadius,ue.circularPathData.verticalRightInnerExtent=ue.circularPathData.verticalFullExtent+ue.circularPathData.rightLargeArcRadius)}ue.circularPathData.leftInnerExtent=ue.circularPathData.sourceX+ue.circularPathData.leftNodeBuffer,ue.circularPathData.rightInnerExtent=ue.circularPathData.targetX-ue.circularPathData.rightNodeBuffer,ue.circularPathData.leftFullExtent=ue.circularPathData.sourceX+ue.circularPathData.leftLargeArcRadius+ue.circularPathData.leftNodeBuffer,ue.circularPathData.rightFullExtent=ue.circularPathData.targetX-ue.circularPathData.rightLargeArcRadius-ue.circularPathData.rightNodeBuffer}if(ue.circular)ue.path=function(ce){var ge="";return ge=ce.circularLinkType=="top"?"M"+ce.circularPathData.sourceX+" "+ce.circularPathData.sourceY+" L"+ce.circularPathData.leftInnerExtent+" "+ce.circularPathData.sourceY+" A"+ce.circularPathData.leftLargeArcRadius+" "+ce.circularPathData.leftSmallArcRadius+" 0 0 0 "+ce.circularPathData.leftFullExtent+" "+(ce.circularPathData.sourceY-ce.circularPathData.leftSmallArcRadius)+" L"+ce.circularPathData.leftFullExtent+" "+ce.circularPathData.verticalLeftInnerExtent+" A"+ce.circularPathData.leftLargeArcRadius+" "+ce.circularPathData.leftLargeArcRadius+" 0 0 0 "+ce.circularPathData.leftInnerExtent+" "+ce.circularPathData.verticalFullExtent+" L"+ce.circularPathData.rightInnerExtent+" "+ce.circularPathData.verticalFullExtent+" A"+ce.circularPathData.rightLargeArcRadius+" "+ce.circularPathData.rightLargeArcRadius+" 0 0 0 "+ce.circularPathData.rightFullExtent+" "+ce.circularPathData.verticalRightInnerExtent+" L"+ce.circularPathData.rightFullExtent+" "+(ce.circularPathData.targetY-ce.circularPathData.rightSmallArcRadius)+" A"+ce.circularPathData.rightLargeArcRadius+" "+ce.circularPathData.rightSmallArcRadius+" 0 0 0 "+ce.circularPathData.rightInnerExtent+" "+ce.circularPathData.targetY+" L"+ce.circularPathData.targetX+" "+ce.circularPathData.targetY:"M"+ce.circularPathData.sourceX+" "+ce.circularPathData.sourceY+" L"+ce.circularPathData.leftInnerExtent+" "+ce.circularPathData.sourceY+" A"+ce.circularPathData.leftLargeArcRadius+" "+ce.circularPathData.leftSmallArcRadius+" 0 0 1 "+ce.circularPathData.leftFullExtent+" "+(ce.circularPathData.sourceY+ce.circularPathData.leftSmallArcRadius)+" L"+ce.circularPathData.leftFullExtent+" "+ce.circularPathData.verticalLeftInnerExtent+" A"+ce.circularPathData.leftLargeArcRadius+" "+ce.circularPathData.leftLargeArcRadius+" 0 0 1 "+ce.circularPathData.leftInnerExtent+" "+ce.circularPathData.verticalFullExtent+" L"+ce.circularPathData.rightInnerExtent+" "+ce.circularPathData.verticalFullExtent+" A"+ce.circularPathData.rightLargeArcRadius+" "+ce.circularPathData.rightLargeArcRadius+" 0 0 1 "+ce.circularPathData.rightFullExtent+" "+ce.circularPathData.verticalRightInnerExtent+" L"+ce.circularPathData.rightFullExtent+" "+(ce.circularPathData.targetY+ce.circularPathData.rightSmallArcRadius)+" A"+ce.circularPathData.rightLargeArcRadius+" "+ce.circularPathData.rightSmallArcRadius+" 0 0 1 "+ce.circularPathData.rightInnerExtent+" "+ce.circularPathData.targetY+" L"+ce.circularPathData.targetX+" "+ce.circularPathData.targetY,ge}(ue);else{var xe=h.linkHorizontal().source(function(ce){return[ce.source.x0+(ce.source.x1-ce.source.x0),ce.y0]}).target(function(ce){return[ce.target.x0,ce.y1]});ue.path=xe(ue)}})}function P(ie,ae){return X(ie)==X(ae)?ie.circularLinkType=="bottom"?N(ie,ae):D(ie,ae):X(ae)-X(ie)}function D(ie,ae){return ie.y0-ae.y0}function N(ie,ae){return ae.y0-ie.y0}function U(ie,ae){return ie.y1-ae.y1}function G(ie,ae){return ae.y1-ie.y1}function X(ie){return ie.target.column-ie.source.column}function K(ie){return ie.target.x0-ie.source.x1}function Z(ie,ae){var he=w(ie),se=K(ae)/Math.tan(he);return J(ie)=="up"?ie.y1+se:ie.y1-se}function H(ie,ae){var he=w(ie),se=K(ae)/Math.tan(he);return J(ie)=="up"?ie.y1-se:ie.y1+se}function Y(ie,ae,he,se){ie.links.forEach(function(de){if(!de.circular&&de.target.column-de.source.column>1){var ue=de.source.column+1,ve=de.target.column-1,ke=1,Ee=ve-ue+1;for(ke=1;ue<=ve;ue++,ke++)ie.nodes.forEach(function(be){if(be.column==ue){var xe,ce=ke/(Ee+1),ge=Math.pow(1-ce,3),we=3*ce*Math.pow(1-ce,2),Me=3*Math.pow(ce,2)*(1-ce),Se=Math.pow(ce,3),ze=ge*de.y0+we*de.y0+Me*de.y1+Se*de.y1,Fe=ze-de.width/2,Ye=ze+de.width/2;Fe>be.y0&&Fe<be.y1?(xe=be.y1-Fe+10,xe=be.circularLinkType=="bottom"?xe:-xe,be=z(be,xe,ae,he),ie.nodes.forEach(function(rt){T(rt,se)!=T(be,se)&&rt.column==be.column&&$(be,rt)&&z(rt,xe,ae,he)})):(Ye>be.y0&&Ye<be.y1||Fe<be.y0&&Ye>be.y1)&&(xe=Ye-be.y0+10,be=z(be,xe,ae,he),ie.nodes.forEach(function(rt){T(rt,se)!=T(be,se)&&rt.column==be.column&&rt.y0<be.y1&&rt.y1>be.y1&&z(rt,xe,ae,he)}))}})}})}function $(ie,ae){return ie.y0>ae.y0&&ie.y0<ae.y1||ie.y1>ae.y0&&ie.y1<ae.y1||ie.y0<ae.y0&&ie.y1>ae.y1}function z(ie,ae,he,se){return ie.y0+ae>=he&&ie.y1+ae<=se&&(ie.y0=ie.y0+ae,ie.y1=ie.y1+ae,ie.targetLinks.forEach(function(de){de.y1=de.y1+ae}),ie.sourceLinks.forEach(function(de){de.y0=de.y0+ae})),ie}function j(ie,ae,he,se){ie.nodes.forEach(function(de){se&&de.y+(de.y1-de.y0)>ae&&(de.y=de.y-(de.y+(de.y1-de.y0)-ae));var ue=ie.links.filter(function(Ee){return T(Ee.source,he)==T(de,he)}),ve=ue.length;ve>1&&ue.sort(function(Ee,be){if(!Ee.circular&&!be.circular){if(Ee.target.column==be.target.column||!ee(Ee,be))return Ee.y1-be.y1;if(Ee.target.column>be.target.column){var xe=H(be,Ee);return Ee.y1-xe}if(be.target.column>Ee.target.column)return H(Ee,be)-be.y1}return Ee.circular&&!be.circular?Ee.circularLinkType=="top"?-1:1:be.circular&&!Ee.circular?be.circularLinkType=="top"?1:-1:Ee.circular&&be.circular?Ee.circularLinkType===be.circularLinkType&&Ee.circularLinkType=="top"?Ee.target.column===be.target.column?Ee.target.y1-be.target.y1:be.target.column-Ee.target.column:Ee.circularLinkType===be.circularLinkType&&Ee.circularLinkType=="bottom"?Ee.target.column===be.target.column?be.target.y1-Ee.target.y1:Ee.target.column-be.target.column:Ee.circularLinkType=="top"?-1:1:void 0});var ke=de.y0;ue.forEach(function(Ee){Ee.y0=ke+Ee.width/2,ke+=Ee.width}),ue.forEach(function(Ee,be){if(Ee.circularLinkType=="bottom"){for(var xe=be+1,ce=0;xe<ve;xe++)ce+=ue[xe].width;Ee.y0=de.y1-ce-Ee.width/2}})})}function W(ie,ae,he){ie.nodes.forEach(function(se){var de=ie.links.filter(function(ke){return T(ke.target,he)==T(se,he)}),ue=de.length;ue>1&&de.sort(function(ke,Ee){if(!ke.circular&&!Ee.circular){if(ke.source.column==Ee.source.column||!ee(ke,Ee))return ke.y0-Ee.y0;if(Ee.source.column<ke.source.column){var be=Z(Ee,ke);return ke.y0-be}if(ke.source.column<Ee.source.column)return Z(ke,Ee)-Ee.y0}return ke.circular&&!Ee.circular?ke.circularLinkType=="top"?-1:1:Ee.circular&&!ke.circular?Ee.circularLinkType=="top"?1:-1:ke.circular&&Ee.circular?ke.circularLinkType===Ee.circularLinkType&&ke.circularLinkType=="top"?ke.source.column===Ee.source.column?ke.source.y1-Ee.source.y1:ke.source.column-Ee.source.column:ke.circularLinkType===Ee.circularLinkType&&ke.circularLinkType=="bottom"?ke.source.column===Ee.source.column?ke.source.y1-Ee.source.y1:Ee.source.column-ke.source.column:ke.circularLinkType=="top"?-1:1:void 0});var ve=se.y0;de.forEach(function(ke){ke.y1=ve+ke.width/2,ve+=ke.width}),de.forEach(function(ke,Ee){if(ke.circularLinkType=="bottom"){for(var be=Ee+1,xe=0;be<ue;be++)xe+=de[be].width;ke.y1=se.y1-xe-ke.width/2}})})}function ee(ie,ae){return J(ie)==J(ae)}function J(ie){return ie.y0-ie.y1>0?"up":"down"}function Q(ie,ae){return T(ie.source,ae)==T(ie.target,ae)}function te(ie,ae,he){var se=ie.nodes,de=ie.links,ue=!1,ve=!1;if(de.forEach(function(be){be.circularLinkType=="top"?ue=!0:be.circularLinkType=="bottom"&&(ve=!0)}),ue==0||ve==0){var ke=d.min(se,function(be){return be.y0}),Ee=(he-ae)/(d.max(se,function(be){return be.y1})-ke);se.forEach(function(be){var xe=(be.y1-be.y0)*Ee;be.y0=(be.y0-ke)*Ee,be.y1=be.y0+xe}),de.forEach(function(be){be.y0=(be.y0-ke)*Ee,be.y1=(be.y1-ke)*Ee,be.width=be.width*Ee})}}t.sankeyCircular=function(){var ie,ae,he=0,se=0,de=1,ue=1,ve=24,ke=y,Ee=l,be=v,xe=b,ce=32,ge=2,we=null;function Me(){var Oe={nodes:be.apply(null,arguments),links:xe.apply(null,arguments)};Se(Oe),A(Oe,ke,we),ze(Oe),Fe(Oe),S(Oe,ke),Ye(Oe,ce,ke),rt(Oe);for(var je=4,We=0;We<je;We++)j(Oe,ue,ke),W(Oe,ue,ke),Y(Oe,se,ue,ke),j(Oe,ue,ke),W(Oe,ue,ke);return te(Oe,se,ue),M(Oe,ge,ue,ke),Oe}function Se(Oe){Oe.nodes.forEach(function(We,qe){We.index=qe,We.sourceLinks=[],We.targetLinks=[]});var je=m.map(Oe.nodes,ke);return Oe.links.forEach(function(We,qe){We.index=qe;var et=We.source,st=We.target;(et===void 0?"undefined":u(et))!=="object"&&(et=We.source=x(je,et)),(st===void 0?"undefined":u(st))!=="object"&&(st=We.target=x(je,st)),et.sourceLinks.push(We),st.targetLinks.push(We)}),Oe}function ze(Oe){Oe.nodes.forEach(function(je){je.partOfCycle=!1,je.value=Math.max(d.sum(je.sourceLinks,n),d.sum(je.targetLinks,n)),je.sourceLinks.forEach(function(We){We.circular&&(je.partOfCycle=!0,je.circularLinkType=We.circularLinkType)}),je.targetLinks.forEach(function(We){We.circular&&(je.partOfCycle=!0,je.circularLinkType=We.circularLinkType)})})}function Fe(Oe){var je,We,qe;for(je=Oe.nodes,We=[],qe=0;je.length;++qe,je=We,We=[])je.forEach(function(et){et.depth=qe,et.sourceLinks.forEach(function(st){We.indexOf(st.target)<0&&!st.circular&&We.push(st.target)})});for(je=Oe.nodes,We=[],qe=0;je.length;++qe,je=We,We=[])je.forEach(function(et){et.height=qe,et.targetLinks.forEach(function(st){We.indexOf(st.source)<0&&!st.circular&&We.push(st.source)})});Oe.nodes.forEach(function(et){et.column=Math.floor(Ee.call(null,et,qe))})}function Ye(Oe,je,We){var qe=m.nest().key(function(kt){return kt.column}).sortKeys(d.ascending).entries(Oe.nodes).map(function(kt){return kt.values});(function(kt){if(ae){var at=1/0;qe.forEach(function(tr){var Ue=ue*ae/(tr.length+1);at=Ue<at?Ue:at}),ie=at}var tt=d.min(qe,function(tr){return(ue-se-(tr.length-1)*ie)/d.sum(tr,n)});tt*=.3,Oe.links.forEach(function(tr){tr.width=tr.value*tt});var _t=function(tr){var Ue=0,He=0,Be=0,Ke=0,_e=d.max(tr.nodes,function(Ce){return Ce.column});return tr.links.forEach(function(Ce){Ce.circular&&(Ce.circularLinkType=="top"?Ue+=Ce.width:He+=Ce.width,Ce.target.column==0&&(Ke+=Ce.width),Ce.source.column==_e&&(Be+=Ce.width))}),{top:Ue=Ue>0?Ue+25+10:Ue,bottom:He=He>0?He+25+10:He,left:Ke=Ke>0?Ke+25+10:Ke,right:Be=Be>0?Be+25+10:Be}}(Oe),er=function(tr,Ue){var He=d.max(tr.nodes,function(Le){return Le.column}),Be=de-he,Ke=ue-se,_e=Be/(Be+Ue.right+Ue.left),Ce=Ke/(Ke+Ue.top+Ue.bottom);return he=he*_e+Ue.left,de=Ue.right==0?de:de*_e,se=se*Ce+Ue.top,ue*=Ce,tr.nodes.forEach(function(Le){Le.x0=he+Le.column*((de-he-ve)/He),Le.x1=Le.x0+ve}),Ce}(Oe,_t);tt*=er,Oe.links.forEach(function(tr){tr.width=tr.value*tt}),qe.forEach(function(tr){var Ue=tr.length;tr.forEach(function(He,Be){He.depth==qe.length-1&&Ue==1||He.depth==0&&Ue==1?(He.y0=ue/2-He.value*tt,He.y1=He.y0+He.value*tt):He.partOfCycle?E(He,kt)==0?(He.y0=ue/2+Be,He.y1=He.y0+He.value*tt):He.circularLinkType=="top"?(He.y0=se+Be,He.y1=He.y0+He.value*tt):(He.y0=ue-He.value*tt-Be,He.y1=He.y0+He.value*tt):_t.top==0||_t.bottom==0?(He.y0=(ue-se)/Ue*Be,He.y1=He.y0+He.value*tt):(He.y0=(ue-se)/2-Ue/2+Be,He.y1=He.y0+He.value*tt)})})})(We),Pt();for(var et=1,st=je;st>0;--st)ct(et*=.99,We),Pt();function ct(kt,at){var tt=qe.length;qe.forEach(function(_t){var er=_t.length,tr=_t[0].depth;_t.forEach(function(Ue){var He;if((Ue.sourceLinks.length||Ue.targetLinks.length)&&!(Ue.partOfCycle&&E(Ue,at)>0))if(tr==0&&er==1)He=Ue.y1-Ue.y0,Ue.y0=ue/2-He/2,Ue.y1=ue/2+He/2;else if(tr==tt-1&&er==1)He=Ue.y1-Ue.y0,Ue.y0=ue/2-He/2,Ue.y1=ue/2+He/2;else{var Be=d.mean(Ue.sourceLinks,p),Ke=d.mean(Ue.targetLinks,g),_e=((Be&&Ke?(Be+Ke)/2:Be||Ke)-a(Ue))*kt;Ue.y0+=_e,Ue.y1+=_e}})})}function Pt(){qe.forEach(function(kt){var at,tt,_t,er=se,tr=kt.length;for(kt.sort(c),_t=0;_t<tr;++_t)(tt=er-(at=kt[_t]).y0)>0&&(at.y0+=tt,at.y1+=tt),er=at.y1+ie;if((tt=er-ie-ue)>0)for(er=at.y0-=tt,at.y1-=tt,_t=tr-2;_t>=0;--_t)(tt=(at=kt[_t]).y1+ie-er)>0&&(at.y0-=tt,at.y1-=tt),er=at.y0})}}function rt(Oe){Oe.nodes.forEach(function(je){je.sourceLinks.sort(i),je.targetLinks.sort(s)}),Oe.nodes.forEach(function(je){var We=je.y0,qe=We,et=je.y1,st=et;je.sourceLinks.forEach(function(ct){ct.circular?(ct.y0=et-ct.width/2,et-=ct.width):(ct.y0=We+ct.width/2,We+=ct.width)}),je.targetLinks.forEach(function(ct){ct.circular?(ct.y1=st-ct.width/2,st-=ct.width):(ct.y1=qe+ct.width/2,qe+=ct.width)})})}return Me.nodeId=function(Oe){return arguments.length?(ke=typeof Oe=="function"?Oe:o(Oe),Me):ke},Me.nodeAlign=function(Oe){return arguments.length?(Ee=typeof Oe=="function"?Oe:o(Oe),Me):Ee},Me.nodeWidth=function(Oe){return arguments.length?(ve=+Oe,Me):ve},Me.nodePadding=function(Oe){return arguments.length?(ie=+Oe,Me):ie},Me.nodes=function(Oe){return arguments.length?(be=typeof Oe=="function"?Oe:o(Oe),Me):be},Me.links=function(Oe){return arguments.length?(xe=typeof Oe=="function"?Oe:o(Oe),Me):xe},Me.size=function(Oe){return arguments.length?(he=se=0,de=+Oe[0],ue=+Oe[1],Me):[de-he,ue-se]},Me.extent=function(Oe){return arguments.length?(he=+Oe[0][0],de=+Oe[1][0],se=+Oe[0][1],ue=+Oe[1][1],Me):[[he,se],[de,ue]]},Me.iterations=function(Oe){return arguments.length?(ce=+Oe,Me):ce},Me.circularLinkGap=function(Oe){return arguments.length?(ge=+Oe,Me):ge},Me.nodePaddingRatio=function(Oe){return arguments.length?(ae=+Oe,Me):ae},Me.sortNodes=function(Oe){return arguments.length?(we=Oe,Me):we},Me.update=function(Oe){return S(Oe,ke),rt(Oe),Oe.links.forEach(function(je){je.circular&&(je.circularLinkType=je.y0+je.y1<ue?"top":"bottom",je.source.circularLinkType=je.circularLinkType,je.target.circularLinkType=je.circularLinkType)}),j(Oe,ue,ke,!1),W(Oe,ue,ke),M(Oe,ge,ue,ke),Oe},Me},t.sankeyCenter=function(ie){return ie.targetLinks.length?ie.depth:ie.sourceLinks.length?d.min(ie.sourceLinks,f)-1:0},t.sankeyLeft=function(ie){return ie.depth},t.sankeyRight=function(ie,ae){return ae-1-ie.height},t.sankeyJustify=l,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":159,"d3-collection":160,"d3-shape":171,"elementary-circuits-directed-graph":185}],57:[function(r,I,B){(function(t,d){typeof B=="object"&&I!==void 0?d(B,r("d3-array"),r("d3-collection"),r("d3-shape")):d(t.d3=t.d3||{},t.d3,t.d3,t.d3)})(this,function(t,d,m,h){function e(T){return T.target.depth}function f(T,A){return T.sourceLinks.length?T.depth:A-1}function l(T){return function(){return T}}function o(T,A){return s(T.source,A.source)||T.index-A.index}function u(T,A){return s(T.target,A.target)||T.index-A.index}function s(T,A){return T.y0-A.y0}function i(T){return T.value}function c(T){return(T.y0+T.y1)/2}function n(T){return c(T.source)*T.value}function a(T){return c(T.target)*T.value}function g(T){return T.index}function p(T){return T.nodes}function y(T){return T.links}function v(T,A){var S=T.get(A);if(!S)throw new Error("missing: "+A);return S}function b(T){return[T.source.x1,T.y0]}function x(T){return[T.target.x0,T.y1]}t.sankey=function(){var T=0,A=0,S=1,w=1,E=24,k=8,L=g,M=f,P=p,D=y,N=32;function U(){var Y={nodes:P.apply(null,arguments),links:D.apply(null,arguments)};return G(Y),X(Y),K(Y),Z(Y),H(Y),Y}function G(Y){Y.nodes.forEach(function(z,j){z.index=j,z.sourceLinks=[],z.targetLinks=[]});var $=m.map(Y.nodes,L);Y.links.forEach(function(z,j){z.index=j;var W=z.source,ee=z.target;typeof W!="object"&&(W=z.source=v($,W)),typeof ee!="object"&&(ee=z.target=v($,ee)),W.sourceLinks.push(z),ee.targetLinks.push(z)})}function X(Y){Y.nodes.forEach(function($){$.value=Math.max(d.sum($.sourceLinks,i),d.sum($.targetLinks,i))})}function K(Y){var $,z,j;for($=Y.nodes,z=[],j=0;$.length;++j,$=z,z=[])$.forEach(function(ee){ee.depth=j,ee.sourceLinks.forEach(function(J){z.indexOf(J.target)<0&&z.push(J.target)})});for($=Y.nodes,z=[],j=0;$.length;++j,$=z,z=[])$.forEach(function(ee){ee.height=j,ee.targetLinks.forEach(function(J){z.indexOf(J.source)<0&&z.push(J.source)})});var W=(S-T-E)/(j-1);Y.nodes.forEach(function(ee){ee.x1=(ee.x0=T+Math.max(0,Math.min(j-1,Math.floor(M.call(null,ee,j))))*W)+E})}function Z(Y){var $=m.nest().key(function(Q){return Q.x0}).sortKeys(d.ascending).entries(Y.nodes).map(function(Q){return Q.values});(function(){var Q=d.max($,function(ae){return ae.length}),te=2/3*(w-A)/(Q-1);k>te&&(k=te);var ie=d.min($,function(ae){return(w-A-(ae.length-1)*k)/d.sum(ae,i)});$.forEach(function(ae){ae.forEach(function(he,se){he.y1=(he.y0=se)+he.value*ie})}),Y.links.forEach(function(ae){ae.width=ae.value*ie})})(),J();for(var z=1,j=N;j>0;--j)ee(z*=.99),J(),W(z),J();function W(Q){$.forEach(function(te){te.forEach(function(ie){if(ie.targetLinks.length){var ae=(d.sum(ie.targetLinks,n)/d.sum(ie.targetLinks,i)-c(ie))*Q;ie.y0+=ae,ie.y1+=ae}})})}function ee(Q){$.slice().reverse().forEach(function(te){te.forEach(function(ie){if(ie.sourceLinks.length){var ae=(d.sum(ie.sourceLinks,a)/d.sum(ie.sourceLinks,i)-c(ie))*Q;ie.y0+=ae,ie.y1+=ae}})})}function J(){$.forEach(function(Q){var te,ie,ae,he=A,se=Q.length;for(Q.sort(s),ae=0;ae<se;++ae)(ie=he-(te=Q[ae]).y0)>0&&(te.y0+=ie,te.y1+=ie),he=te.y1+k;if((ie=he-k-w)>0)for(he=te.y0-=ie,te.y1-=ie,ae=se-2;ae>=0;--ae)(ie=(te=Q[ae]).y1+k-he)>0&&(te.y0-=ie,te.y1-=ie),he=te.y0})}}function H(Y){Y.nodes.forEach(function($){$.sourceLinks.sort(u),$.targetLinks.sort(o)}),Y.nodes.forEach(function($){var z=$.y0,j=z;$.sourceLinks.forEach(function(W){W.y0=z+W.width/2,z+=W.width}),$.targetLinks.forEach(function(W){W.y1=j+W.width/2,j+=W.width})})}return U.update=function(Y){return H(Y),Y},U.nodeId=function(Y){return arguments.length?(L=typeof Y=="function"?Y:l(Y),U):L},U.nodeAlign=function(Y){return arguments.length?(M=typeof Y=="function"?Y:l(Y),U):M},U.nodeWidth=function(Y){return arguments.length?(E=+Y,U):E},U.nodePadding=function(Y){return arguments.length?(k=+Y,U):k},U.nodes=function(Y){return arguments.length?(P=typeof Y=="function"?Y:l(Y),U):P},U.links=function(Y){return arguments.length?(D=typeof Y=="function"?Y:l(Y),U):D},U.size=function(Y){return arguments.length?(T=A=0,S=+Y[0],w=+Y[1],U):[S-T,w-A]},U.extent=function(Y){return arguments.length?(T=+Y[0][0],S=+Y[1][0],A=+Y[0][1],w=+Y[1][1],U):[[T,A],[S,w]]},U.iterations=function(Y){return arguments.length?(N=+Y,U):N},U},t.sankeyCenter=function(T){return T.targetLinks.length?T.depth:T.sourceLinks.length?d.min(T.sourceLinks,e)-1:0},t.sankeyLeft=function(T){return T.depth},t.sankeyRight=function(T,A){return A-1-T.height},t.sankeyJustify=f,t.sankeyLinkHorizontal=function(){return h.linkHorizontal().source(b).target(x)},Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":159,"d3-collection":160,"d3-shape":171}],58:[function(r,I,B){(function(){var t={version:"3.8.0"},d=[].slice,m=function(oe){return d.call(oe)},h=self.document;function e(oe){return oe&&(oe.ownerDocument||oe.document||oe).documentElement}function f(oe){return oe&&(oe.ownerDocument&&oe.ownerDocument.defaultView||oe.document&&oe||oe.defaultView)}if(h)try{m(h.documentElement.childNodes)[0].nodeType}catch(oe){m=function(C){for(var R=C.length,F=new Array(R);R--;)F[R]=C[R];return F}}if(Date.now||(Date.now=function(){return+new Date}),h)try{h.createElement("DIV").style.setProperty("opacity",0,"")}catch(oe){var l=this.Element.prototype,o=l.setAttribute,u=l.setAttributeNS,s=this.CSSStyleDeclaration.prototype,i=s.setProperty;l.setAttribute=function(C,R){o.call(this,C,R+"")},l.setAttributeNS=function(C,R,F){u.call(this,C,R,F+"")},s.setProperty=function(C,R,F){i.call(this,C,R+"",F)}}function c(oe,C){return oe<C?-1:oe>C?1:oe>=C?0:NaN}function n(oe){return oe===null?NaN:+oe}function a(oe){return!isNaN(oe)}function g(oe){return{left:function(C,R,F,V){for(arguments.length<3&&(F=0),arguments.length<4&&(V=C.length);F<V;){var ne=F+V>>>1;oe(C[ne],R)<0?F=ne+1:V=ne}return F},right:function(C,R,F,V){for(arguments.length<3&&(F=0),arguments.length<4&&(V=C.length);F<V;){var ne=F+V>>>1;oe(C[ne],R)>0?V=ne:F=ne+1}return F}}}t.ascending=c,t.descending=function(oe,C){return C<oe?-1:C>oe?1:C>=oe?0:NaN},t.min=function(oe,C){var R,F,V=-1,ne=oe.length;if(arguments.length===1){for(;++V<ne;)if((F=oe[V])!=null&&F>=F){R=F;break}for(;++V<ne;)(F=oe[V])!=null&&R>F&&(R=F)}else{for(;++V<ne;)if((F=C.call(oe,oe[V],V))!=null&&F>=F){R=F;break}for(;++V<ne;)(F=C.call(oe,oe[V],V))!=null&&R>F&&(R=F)}return R},t.max=function(oe,C){var R,F,V=-1,ne=oe.length;if(arguments.length===1){for(;++V<ne;)if((F=oe[V])!=null&&F>=F){R=F;break}for(;++V<ne;)(F=oe[V])!=null&&F>R&&(R=F)}else{for(;++V<ne;)if((F=C.call(oe,oe[V],V))!=null&&F>=F){R=F;break}for(;++V<ne;)(F=C.call(oe,oe[V],V))!=null&&F>R&&(R=F)}return R},t.extent=function(oe,C){var R,F,V,ne=-1,le=oe.length;if(arguments.length===1){for(;++ne<le;)if((F=oe[ne])!=null&&F>=F){R=V=F;break}for(;++ne<le;)(F=oe[ne])!=null&&(R>F&&(R=F),V<F&&(V=F))}else{for(;++ne<le;)if((F=C.call(oe,oe[ne],ne))!=null&&F>=F){R=V=F;break}for(;++ne<le;)(F=C.call(oe,oe[ne],ne))!=null&&(R>F&&(R=F),V<F&&(V=F))}return[R,V]},t.sum=function(oe,C){var R,F=0,V=oe.length,ne=-1;if(arguments.length===1)for(;++ne<V;)a(R=+oe[ne])&&(F+=R);else for(;++ne<V;)a(R=+C.call(oe,oe[ne],ne))&&(F+=R);return F},t.mean=function(oe,C){var R,F=0,V=oe.length,ne=-1,le=V;if(arguments.length===1)for(;++ne<V;)a(R=n(oe[ne]))?F+=R:--le;else for(;++ne<V;)a(R=n(C.call(oe,oe[ne],ne)))?F+=R:--le;if(le)return F/le},t.quantile=function(oe,C){var R=(oe.length-1)*C+1,F=Math.floor(R),V=+oe[F-1],ne=R-F;return ne?V+ne*(oe[F]-V):V},t.median=function(oe,C){var R,F=[],V=oe.length,ne=-1;if(arguments.length===1)for(;++ne<V;)a(R=n(oe[ne]))&&F.push(R);else for(;++ne<V;)a(R=n(C.call(oe,oe[ne],ne)))&&F.push(R);if(F.length)return t.quantile(F.sort(c),.5)},t.variance=function(oe,C){var R,F,V=oe.length,ne=0,le=0,pe=-1,ye=0;if(arguments.length===1)for(;++pe<V;)a(R=n(oe[pe]))&&(le+=(F=R-ne)*(R-(ne+=F/++ye)));else for(;++pe<V;)a(R=n(C.call(oe,oe[pe],pe)))&&(le+=(F=R-ne)*(R-(ne+=F/++ye)));if(ye>1)return le/(ye-1)},t.deviation=function(){var oe=t.variance.apply(this,arguments);return oe&&Math.sqrt(oe)};var p=g(c);function y(oe){return oe.length}t.bisectLeft=p.left,t.bisect=t.bisectRight=p.right,t.bisector=function(oe){return g(oe.length===1?function(C,R){return c(oe(C),R)}:oe)},t.shuffle=function(oe,C,R){(ne=arguments.length)<3&&(R=oe.length,ne<2&&(C=0));for(var F,V,ne=R-C;ne;)V=Math.random()*ne--|0,F=oe[ne+C],oe[ne+C]=oe[V+C],oe[V+C]=F;return oe},t.permute=function(oe,C){for(var R=C.length,F=new Array(R);R--;)F[R]=oe[C[R]];return F},t.pairs=function(oe){for(var C=0,R=oe.length-1,F=oe[0],V=new Array(R<0?0:R);C<R;)V[C]=[F,F=oe[++C]];return V},t.transpose=function(oe){if(!(V=oe.length))return[];for(var C=-1,R=t.min(oe,y),F=new Array(R);++C<R;)for(var V,ne=-1,le=F[C]=new Array(V);++ne<V;)le[ne]=oe[ne][C];return F},t.zip=function(){return t.transpose(arguments)},t.keys=function(oe){var C=[];for(var R in oe)C.push(R);return C},t.values=function(oe){var C=[];for(var R in oe)C.push(oe[R]);return C},t.entries=function(oe){var C=[];for(var R in oe)C.push({key:R,value:oe[R]});return C},t.merge=function(oe){for(var C,R,F,V=oe.length,ne=-1,le=0;++ne<V;)le+=oe[ne].length;for(R=new Array(le);--V>=0;)for(C=(F=oe[V]).length;--C>=0;)R[--le]=F[C];return R};var v=Math.abs;function b(oe){for(var C=1;oe*C%1;)C*=10;return C}function x(oe,C){for(var R in C)Object.defineProperty(oe.prototype,R,{value:C[R],enumerable:!1})}function T(){this._=Object.create(null)}t.range=function(oe,C,R){if(arguments.length<3&&(R=1,arguments.length<2&&(C=oe,oe=0)),(C-oe)/R==1/0)throw new Error("infinite range");var F,V=[],ne=b(v(R)),le=-1;if(oe*=ne,C*=ne,(R*=ne)<0)for(;(F=oe+R*++le)>C;)V.push(F/ne);else for(;(F=oe+R*++le)<C;)V.push(F/ne);return V},t.map=function(oe,C){var R=new T;if(oe instanceof T)oe.forEach(function(pe,ye){R.set(pe,ye)});else if(Array.isArray(oe)){var F,V=-1,ne=oe.length;if(arguments.length===1)for(;++V<ne;)R.set(V,oe[V]);else for(;++V<ne;)R.set(C.call(oe,F=oe[V],V),F)}else for(var le in oe)R.set(le,oe[le]);return R};function A(oe){return(oe+="")=="__proto__"||oe[0]==="\0"?"\0"+oe:oe}function S(oe){return(oe+="")[0]==="\0"?oe.slice(1):oe}function w(oe){return A(oe)in this._}function E(oe){return(oe=A(oe))in this._&&delete this._[oe]}function k(){var oe=[];for(var C in this._)oe.push(S(C));return oe}function L(){var oe=0;for(var C in this._)++oe;return oe}function M(){for(var oe in this._)return!1;return!0}function P(){this._=Object.create(null)}function D(oe){return oe}function N(oe,C,R){return function(){var F=R.apply(C,arguments);return F===C?oe:F}}function U(oe,C){if(C in oe)return C;C=C.charAt(0).toUpperCase()+C.slice(1);for(var R=0,F=G.length;R<F;++R){var V=G[R]+C;if(V in oe)return V}}x(T,{has:w,get:function(oe){return this._[A(oe)]},set:function(oe,C){return this._[A(oe)]=C},remove:E,keys:k,values:function(){var oe=[];for(var C in this._)oe.push(this._[C]);return oe},entries:function(){var oe=[];for(var C in this._)oe.push({key:S(C),value:this._[C]});return oe},size:L,empty:M,forEach:function(oe){for(var C in this._)oe.call(this,S(C),this._[C])}}),t.nest=function(){var oe,C,R={},F=[],V=[];function ne(le,pe,ye){if(ye>=F.length)return C?C.call(R,pe):oe?pe.sort(oe):pe;for(var Te,Ne,Ge,nt,bt=-1,Ct=pe.length,Tt=F[ye++],At=new T;++bt<Ct;)(nt=At.get(Te=Tt(Ne=pe[bt])))?nt.push(Ne):At.set(Te,[Ne]);return le?(Ne=le(),Ge=function(yt,Ft){Ne.set(yt,ne(le,Ft,ye))}):(Ne={},Ge=function(yt,Ft){Ne[yt]=ne(le,Ft,ye)}),At.forEach(Ge),Ne}return R.map=function(le,pe){return ne(pe,le,0)},R.entries=function(le){return function pe(ye,Te){if(Te>=F.length)return ye;var Ne=[],Ge=V[Te++];return ye.forEach(function(nt,bt){Ne.push({key:nt,values:pe(bt,Te)})}),Ge?Ne.sort(function(nt,bt){return Ge(nt.key,bt.key)}):Ne}(ne(t.map,le,0),0)},R.key=function(le){return F.push(le),R},R.sortKeys=function(le){return V[F.length-1]=le,R},R.sortValues=function(le){return oe=le,R},R.rollup=function(le){return C=le,R},R},t.set=function(oe){var C=new P;if(oe)for(var R=0,F=oe.length;R<F;++R)C.add(oe[R]);return C},x(P,{has:w,add:function(oe){return this._[A(oe+="")]=!0,oe},remove:E,values:k,size:L,empty:M,forEach:function(oe){for(var C in this._)oe.call(this,S(C))}}),t.behavior={},t.rebind=function(oe,C){for(var R,F=1,V=arguments.length;++F<V;)oe[R=arguments[F]]=N(oe,C,C[R]);return oe};var G=["webkit","ms","moz","Moz","o","O"];function X(){}function K(){}function Z(oe){var C=[],R=new T;function F(){for(var V,ne=C,le=-1,pe=ne.length;++le<pe;)(V=ne[le].on)&&V.apply(this,arguments);return oe}return F.on=function(V,ne){var le,pe=R.get(V);return arguments.length<2?pe&&pe.on:(pe&&(pe.on=null,C=C.slice(0,le=C.indexOf(pe)).concat(C.slice(le+1)),R.remove(V)),ne&&C.push(R.set(V,{on:ne})),oe)},F}function H(){t.event.preventDefault()}function Y(){for(var oe,C=t.event;oe=C.sourceEvent;)C=oe;return C}function $(oe){for(var C=new K,R=0,F=arguments.length;++R<F;)C[arguments[R]]=Z(C);return C.of=function(V,ne){return function(le){try{var pe=le.sourceEvent=t.event;le.target=oe,t.event=le,C[le.type].apply(V,ne)}finally{t.event=pe}}},C}t.dispatch=function(){for(var oe=new K,C=-1,R=arguments.length;++C<R;)oe[arguments[C]]=Z(oe);return oe},K.prototype.on=function(oe,C){var R=oe.indexOf("."),F="";if(R>=0&&(F=oe.slice(R+1),oe=oe.slice(0,R)),oe)return arguments.length<2?this[oe].on(F):this[oe].on(F,C);if(arguments.length===2){if(C==null)for(oe in this)this.hasOwnProperty(oe)&&this[oe].on(F,null);return this}},t.event=null,t.requote=function(oe){return oe.replace(z,"\\$&")};var z=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,j=function(oe,C){for(var R in C)oe[R]=C[R]};function W(oe){return j(oe,te),oe}var ee=function(oe,C){return C.querySelector(oe)},J=function(oe,C){return C.querySelectorAll(oe)},Q=function(oe,C){var R=oe.matches||oe[U(oe,"matchesSelector")];return(Q=function(F,V){return R.call(F,V)})(oe,C)};typeof Sizzle=="function"&&(ee=function(oe,C){return Sizzle(oe,C)[0]||null},J=Sizzle,Q=Sizzle.matchesSelector),t.selection=function(){return t.select(h.documentElement)};var te=t.selection.prototype=[];function ie(oe){return typeof oe=="function"?oe:function(){return ee(oe,this)}}function ae(oe){return typeof oe=="function"?oe:function(){return J(oe,this)}}te.select=function(oe){var C,R,F,V,ne=[];oe=ie(oe);for(var le=-1,pe=this.length;++le<pe;){ne.push(C=[]),C.parentNode=(F=this[le]).parentNode;for(var ye=-1,Te=F.length;++ye<Te;)(V=F[ye])?(C.push(R=oe.call(V,V.__data__,ye,le)),R&&"__data__"in V&&(R.__data__=V.__data__)):C.push(null)}return W(ne)},te.selectAll=function(oe){var C,R,F=[];oe=ae(oe);for(var V=-1,ne=this.length;++V<ne;)for(var le=this[V],pe=-1,ye=le.length;++pe<ye;)(R=le[pe])&&(F.push(C=m(oe.call(R,R.__data__,pe,V))),C.parentNode=R);return W(F)};var he="http://www.w3.org/1999/xhtml",se={svg:"http://www.w3.org/2000/svg",xhtml:he,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function de(oe,C){return oe=t.ns.qualify(oe),C==null?oe.local?function(){this.removeAttributeNS(oe.space,oe.local)}:function(){this.removeAttribute(oe)}:typeof C=="function"?oe.local?function(){var R=C.apply(this,arguments);R==null?this.removeAttributeNS(oe.space,oe.local):this.setAttributeNS(oe.space,oe.local,R)}:function(){var R=C.apply(this,arguments);R==null?this.removeAttribute(oe):this.setAttribute(oe,R)}:oe.local?function(){this.setAttributeNS(oe.space,oe.local,C)}:function(){this.setAttribute(oe,C)}}function ue(oe){return oe.trim().replace(/\s+/g," ")}function ve(oe){return new RegExp("(?:^|\\s+)"+t.requote(oe)+"(?:\\s+|$)","g")}function ke(oe){return(oe+"").trim().split(/^|\s+/)}function Ee(oe,C){var R=(oe=ke(oe).map(be)).length;return typeof C=="function"?function(){for(var F=-1,V=C.apply(this,arguments);++F<R;)oe[F](this,V)}:function(){for(var F=-1;++F<R;)oe[F](this,C)}}function be(oe){var C=ve(oe);return function(R,F){if(V=R.classList)return F?V.add(oe):V.remove(oe);var V=R.getAttribute("class")||"";F?(C.lastIndex=0,C.test(V)||R.setAttribute("class",ue(V+" "+oe))):R.setAttribute("class",ue(V.replace(C," ")))}}function xe(oe,C,R){return C==null?function(){this.style.removeProperty(oe)}:typeof C=="function"?function(){var F=C.apply(this,arguments);F==null?this.style.removeProperty(oe):this.style.setProperty(oe,F,R)}:function(){this.style.setProperty(oe,C,R)}}function ce(oe,C){return C==null?function(){delete this[oe]}:typeof C=="function"?function(){var R=C.apply(this,arguments);R==null?delete this[oe]:this[oe]=R}:function(){this[oe]=C}}function ge(oe){return typeof oe=="function"?oe:(oe=t.ns.qualify(oe)).local?function(){return this.ownerDocument.createElementNS(oe.space,oe.local)}:function(){var C=this.ownerDocument,R=this.namespaceURI;return R===he&&C.documentElement.namespaceURI===he?C.createElement(oe):C.createElementNS(R,oe)}}function we(){var oe=this.parentNode;oe&&oe.removeChild(this)}function Me(oe){return{__data__:oe}}function Se(oe){return function(){return Q(this,oe)}}function ze(oe){return arguments.length||(oe=c),function(C,R){return C&&R?oe(C.__data__,R.__data__):!C-!R}}function Fe(oe,C){for(var R=0,F=oe.length;R<F;R++)for(var V,ne=oe[R],le=0,pe=ne.length;le<pe;le++)(V=ne[le])&&C(V,le,R);return oe}function Ye(oe){return j(oe,rt),oe}t.ns={prefix:se,qualify:function(oe){var C=oe.indexOf(":"),R=oe;return C>=0&&(R=oe.slice(0,C))!=="xmlns"&&(oe=oe.slice(C+1)),se.hasOwnProperty(R)?{space:se[R],local:oe}:oe}},te.attr=function(oe,C){if(arguments.length<2){if(typeof oe=="string"){var R=this.node();return(oe=t.ns.qualify(oe)).local?R.getAttributeNS(oe.space,oe.local):R.getAttribute(oe)}for(C in oe)this.each(de(C,oe[C]));return this}return this.each(de(oe,C))},te.classed=function(oe,C){if(arguments.length<2){if(typeof oe=="string"){var R=this.node(),F=(oe=ke(oe)).length,V=-1;if(C=R.classList){for(;++V<F;)if(!C.contains(oe[V]))return!1}else for(C=R.getAttribute("class");++V<F;)if(!ve(oe[V]).test(C))return!1;return!0}for(C in oe)this.each(Ee(C,oe[C]));return this}return this.each(Ee(oe,C))},te.style=function(oe,C,R){var F=arguments.length;if(F<3){if(typeof oe!="string"){for(R in F<2&&(C=""),oe)this.each(xe(R,oe[R],C));return this}if(F<2){var V=this.node();return f(V).getComputedStyle(V,null).getPropertyValue(oe)}R=""}return this.each(xe(oe,C,R))},te.property=function(oe,C){if(arguments.length<2){if(typeof oe=="string")return this.node()[oe];for(C in oe)this.each(ce(C,oe[C]));return this}return this.each(ce(oe,C))},te.text=function(oe){return arguments.length?this.each(typeof oe=="function"?function(){var C=oe.apply(this,arguments);this.textContent=C==null?"":C}:oe==null?function(){this.textContent=""}:function(){this.textContent=oe}):this.node().textContent},te.html=function(oe){return arguments.length?this.each(typeof oe=="function"?function(){var C=oe.apply(this,arguments);this.innerHTML=C==null?"":C}:oe==null?function(){this.innerHTML=""}:function(){this.innerHTML=oe}):this.node().innerHTML},te.append=function(oe){return oe=ge(oe),this.select(function(){return this.appendChild(oe.apply(this,arguments))})},te.insert=function(oe,C){return oe=ge(oe),C=ie(C),this.select(function(){return this.insertBefore(oe.apply(this,arguments),C.apply(this,arguments)||null)})},te.remove=function(){return this.each(we)},te.data=function(oe,C){var R,F,V=-1,ne=this.length;if(!arguments.length){for(oe=new Array(ne=(R=this[0]).length);++V<ne;)(F=R[V])&&(oe[V]=F.__data__);return oe}function le(Ne,Ge){var nt,bt,Ct,Tt=Ne.length,At=Ge.length,yt=Math.min(Tt,At),Ft=new Array(At),zt=new Array(At),jt=new Array(Tt);if(C){var rr,hr=new T,Ar=new Array(Tt);for(nt=-1;++nt<Tt;)(bt=Ne[nt])&&(hr.has(rr=C.call(bt,bt.__data__,nt))?jt[nt]=bt:hr.set(rr,bt),Ar[nt]=rr);for(nt=-1;++nt<At;)(bt=hr.get(rr=C.call(Ge,Ct=Ge[nt],nt)))?bt!==!0&&(Ft[nt]=bt,bt.__data__=Ct):zt[nt]=Me(Ct),hr.set(rr,!0);for(nt=-1;++nt<Tt;)nt in Ar&&hr.get(Ar[nt])!==!0&&(jt[nt]=Ne[nt])}else{for(nt=-1;++nt<yt;)bt=Ne[nt],Ct=Ge[nt],bt?(bt.__data__=Ct,Ft[nt]=bt):zt[nt]=Me(Ct);for(;nt<At;++nt)zt[nt]=Me(Ge[nt]);for(;nt<Tt;++nt)jt[nt]=Ne[nt]}zt.update=Ft,zt.parentNode=Ft.parentNode=jt.parentNode=Ne.parentNode,pe.push(zt),ye.push(Ft),Te.push(jt)}var pe=Ye([]),ye=W([]),Te=W([]);if(typeof oe=="function")for(;++V<ne;)le(R=this[V],oe.call(R,R.parentNode.__data__,V));else for(;++V<ne;)le(R=this[V],oe);return ye.enter=function(){return pe},ye.exit=function(){return Te},ye},te.datum=function(oe){return arguments.length?this.property("__data__",oe):this.property("__data__")},te.filter=function(oe){var C,R,F,V=[];typeof oe!="function"&&(oe=Se(oe));for(var ne=0,le=this.length;ne<le;ne++){V.push(C=[]),C.parentNode=(R=this[ne]).parentNode;for(var pe=0,ye=R.length;pe<ye;pe++)(F=R[pe])&&oe.call(F,F.__data__,pe,ne)&&C.push(F)}return W(V)},te.order=function(){for(var oe=-1,C=this.length;++oe<C;)for(var R,F=this[oe],V=F.length-1,ne=F[V];--V>=0;)(R=F[V])&&(ne&&ne!==R.nextSibling&&ne.parentNode.insertBefore(R,ne),ne=R);return this},te.sort=function(oe){oe=ze.apply(this,arguments);for(var C=-1,R=this.length;++C<R;)this[C].sort(oe);return this.order()},te.each=function(oe){return Fe(this,function(C,R,F){oe.call(C,C.__data__,R,F)})},te.call=function(oe){var C=m(arguments);return oe.apply(C[0]=this,C),this},te.empty=function(){return!this.node()},te.node=function(){for(var oe=0,C=this.length;oe<C;oe++)for(var R=this[oe],F=0,V=R.length;F<V;F++){var ne=R[F];if(ne)return ne}return null},te.size=function(){var oe=0;return Fe(this,function(){++oe}),oe};var rt=[];function Oe(oe){var C,R;return function(F,V,ne){var le,pe=oe[ne].update,ye=pe.length;for(ne!=R&&(R=ne,C=0),V>=C&&(C=V+1);!(le=pe[C])&&++C<ye;);return le}}function je(oe,C,R){var F="__on"+oe,V=oe.indexOf("."),ne=qe;V>0&&(oe=oe.slice(0,V));var le=We.get(oe);function pe(){var ye=this[F];ye&&(this.removeEventListener(oe,ye,ye.$),delete this[F])}return le&&(oe=le,ne=et),V?C?function(){var ye=ne(C,m(arguments));pe.call(this),this.addEventListener(oe,this[F]=ye,ye.$=R),ye._=C}:pe:C?X:function(){var ye,Te=new RegExp("^__on([^.]+)"+t.requote(oe)+"$");for(var Ne in this)if(ye=Ne.match(Te)){var Ge=this[Ne];this.removeEventListener(ye[1],Ge,Ge.$),delete this[Ne]}}}t.selection.enter=Ye,t.selection.enter.prototype=rt,rt.append=te.append,rt.empty=te.empty,rt.node=te.node,rt.call=te.call,rt.size=te.size,rt.select=function(oe){for(var C,R,F,V,ne,le=[],pe=-1,ye=this.length;++pe<ye;){F=(V=this[pe]).update,le.push(C=[]),C.parentNode=V.parentNode;for(var Te=-1,Ne=V.length;++Te<Ne;)(ne=V[Te])?(C.push(F[Te]=R=oe.call(V.parentNode,ne.__data__,Te,pe)),R.__data__=ne.__data__):C.push(null)}return W(le)},rt.insert=function(oe,C){return arguments.length<2&&(C=Oe(this)),te.insert.call(this,oe,C)},t.select=function(oe){var C;return typeof oe=="string"?(C=[ee(oe,h)]).parentNode=h.documentElement:(C=[oe]).parentNode=e(oe),W([C])},t.selectAll=function(oe){var C;return typeof oe=="string"?(C=m(J(oe,h))).parentNode=h.documentElement:(C=m(oe)).parentNode=null,W([C])},te.on=function(oe,C,R){var F=arguments.length;if(F<3){if(typeof oe!="string"){for(R in F<2&&(C=!1),oe)this.each(je(R,oe[R],C));return this}if(F<2)return(F=this.node()["__on"+oe])&&F._;R=!1}return this.each(je(oe,C,R))};var We=t.map({mouseenter:"mouseover",mouseleave:"mouseout"});function qe(oe,C){return function(R){var F=t.event;t.event=R,C[0]=this.__data__;try{oe.apply(this,C)}finally{t.event=F}}}function et(oe,C){var R=qe(oe,C);return function(F){var V=F.relatedTarget;V&&(V===this||8&V.compareDocumentPosition(this))||R.call(this,F)}}h&&We.forEach(function(oe){"on"+oe in h&&We.remove(oe)});var st,ct=0;function Pt(oe){var C=".dragsuppress-"+ ++ct,R="click"+C,F=t.select(f(oe)).on("touchmove"+C,H).on("dragstart"+C,H).on("selectstart"+C,H);if(st==null&&(st=!("onselectstart"in oe)&&U(oe.style,"userSelect")),st){var V=e(oe).style,ne=V[st];V[st]="none"}return function(le){if(F.on(C,null),st&&(V[st]=ne),le){var pe=function(){F.on(R,null)};F.on(R,function(){H(),pe()},!0),setTimeout(pe,0)}}}t.mouse=function(oe){return at(oe,Y())};var kt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function at(oe,C){C.changedTouches&&(C=C.changedTouches[0]);var R=oe.ownerSVGElement||oe;if(R.createSVGPoint){var F=R.createSVGPoint();if(kt<0){var V=f(oe);if(V.scrollX||V.scrollY){var ne=(R=t.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();kt=!(ne.f||ne.e),R.remove()}}return kt?(F.x=C.pageX,F.y=C.pageY):(F.x=C.clientX,F.y=C.clientY),[(F=F.matrixTransform(oe.getScreenCTM().inverse())).x,F.y]}var le=oe.getBoundingClientRect();return[C.clientX-le.left-oe.clientLeft,C.clientY-le.top-oe.clientTop]}function tt(){return t.event.changedTouches[0].identifier}t.touch=function(oe,C,R){if(arguments.length<3&&(R=C,C=Y().changedTouches),C){for(var F,V=0,ne=C.length;V<ne;++V)if((F=C[V]).identifier===R)return at(oe,F)}},t.behavior.drag=function(){var oe=$(V,"drag","dragstart","dragend"),C=null,R=ne(X,t.mouse,f,"mousemove","mouseup"),F=ne(tt,t.touch,D,"touchmove","touchend");function V(){this.on("mousedown.drag",R).on("touchstart.drag",F)}function ne(le,pe,ye,Te,Ne){return function(){var Ge,nt=this,bt=t.event.target.correspondingElement||t.event.target,Ct=nt.parentNode,Tt=oe.of(nt,arguments),At=0,yt=le(),Ft=".drag"+(yt==null?"":"-"+yt),zt=t.select(ye(bt)).on(Te+Ft,hr).on(Ne+Ft,Ar),jt=Pt(bt),rr=pe(Ct,yt);function hr(){var kr,Kr,Zr=pe(Ct,yt);Zr&&(kr=Zr[0]-rr[0],Kr=Zr[1]-rr[1],At|=kr|Kr,rr=Zr,Tt({type:"drag",x:Zr[0]+Ge[0],y:Zr[1]+Ge[1],dx:kr,dy:Kr}))}function Ar(){pe(Ct,yt)&&(zt.on(Te+Ft,null).on(Ne+Ft,null),jt(At),Tt({type:"dragend"}))}Ge=C?[(Ge=C.apply(nt,arguments)).x-rr[0],Ge.y-rr[1]]:[0,0],Tt({type:"dragstart"})}}return V.origin=function(le){return arguments.length?(C=le,V):C},t.rebind(V,oe,"on")},t.touches=function(oe,C){return arguments.length<2&&(C=Y().touches),C?m(C).map(function(R){var F=at(oe,R);return F.identifier=R.identifier,F}):[]};var _t=1e-6,er=Math.PI,tr=2*er,Ue=tr-_t,He=er/2,Be=er/180,Ke=180/er;function _e(oe){return oe>1?He:oe<-1?-He:Math.asin(oe)}function Ce(oe){return((oe=Math.exp(oe))+1/oe)/2}var Le=Math.SQRT2;t.interpolateZoom=function(oe,C){var R,F,V=oe[0],ne=oe[1],le=oe[2],pe=C[0],ye=C[1],Te=C[2],Ne=pe-V,Ge=ye-ne,nt=Ne*Ne+Ge*Ge;if(nt<1e-12)F=Math.log(Te/le)/Le,R=function(Ft){return[V+Ft*Ne,ne+Ft*Ge,le*Math.exp(Le*Ft*F)]};else{var bt=Math.sqrt(nt),Ct=(Te*Te-le*le+4*nt)/(2*le*2*bt),Tt=(Te*Te-le*le-4*nt)/(2*Te*2*bt),At=Math.log(Math.sqrt(Ct*Ct+1)-Ct),yt=Math.log(Math.sqrt(Tt*Tt+1)-Tt);F=(yt-At)/Le,R=function(Ft){var zt,jt=Ft*F,rr=Ce(At),hr=le/(2*bt)*(rr*(zt=Le*jt+At,((zt=Math.exp(2*zt))-1)/(zt+1))-function(Ar){return((Ar=Math.exp(Ar))-1/Ar)/2}(At));return[V+hr*Ne,ne+hr*Ge,le*rr/Ce(Le*jt+At)]}}return R.duration=1e3*F,R},t.behavior.zoom=function(){var oe,C,R,F,V,ne,le,pe,ye,Te={x:0,y:0,k:1},Ne=[960,500],Ge=ht,nt=250,bt=0,Ct="mousedown.zoom",Tt="mousemove.zoom",At="mouseup.zoom",yt="touchstart.zoom",Ft=$(zt,"zoomstart","zoom","zoomend");function zt(Ur){Ur.on(Ct,sn).on(Xe+".zoom",Wn).on("dblclick.zoom",ua).on(yt,Un)}function jt(Ur){return[(Ur[0]-Te.x)/Te.k,(Ur[1]-Te.y)/Te.k]}function rr(Ur){Te.k=Math.max(Ge[0],Math.min(Ge[1],Ur))}function hr(Ur,kn){kn=function(Xn){return[Xn[0]*Te.k+Te.x,Xn[1]*Te.k+Te.y]}(kn),Te.x+=Ur[0]-kn[0],Te.y+=Ur[1]-kn[1]}function Ar(Ur,kn,Xn,Gn){Ur.__chart__={x:Te.x,y:Te.y,k:Te.k},rr(Math.pow(2,Gn)),hr(C=kn,Xn),Ur=t.select(Ur),nt>0&&(Ur=Ur.transition().duration(nt)),Ur.call(zt.event)}function kr(){le&&le.domain(ne.range().map(function(Ur){return(Ur-Te.x)/Te.k}).map(ne.invert)),ye&&ye.domain(pe.range().map(function(Ur){return(Ur-Te.y)/Te.k}).map(pe.invert))}function Kr(Ur){bt++||Ur({type:"zoomstart"})}function Zr(Ur){kr(),Ur({type:"zoom",scale:Te.k,translate:[Te.x,Te.y]})}function hn(Ur){--bt||(Ur({type:"zoomend"}),C=null)}function sn(){var Ur=this,kn=Ft.of(Ur,arguments),Xn=0,Gn=t.select(f(Ur)).on(Tt,Ma).on(At,Kn),ea=jt(t.mouse(Ur)),fa=Pt(Ur);function Ma(){Xn=1,hr(t.mouse(Ur),ea),Zr(kn)}function Kn(){Gn.on(Tt,null).on(At,null),fa(Xn),hn(kn)}$s.call(Ur),Kr(kn)}function Un(){var Ur,kn=this,Xn=Ft.of(kn,arguments),Gn={},ea=0,fa=".zoom-"+t.event.changedTouches[0].identifier,Ma="touchmove"+fa,Kn="touchend"+fa,xa=[],ma=t.select(kn),La=Pt(kn);function ba(){var Ri=t.touches(kn);return Ur=Te.k,Ri.forEach(function(Fi){Fi.identifier in Gn&&(Gn[Fi.identifier]=jt(Fi))}),Ri}function Pa(){var Ri=t.event.target;t.select(Ri).on(Ma,Ua).on(Kn,di),xa.push(Ri);for(var Fi=t.event.changedTouches,pi=0,Ci=Fi.length;pi<Ci;++pi)Gn[Fi[pi].identifier]=null;var bi=ba(),Lo=Date.now();if(bi.length===1){if(Lo-V<500){var Ki=bi[0];Ar(kn,Ki,Gn[Ki.identifier],Math.floor(Math.log(Te.k)/Math.LN2)+1),H()}V=Lo}else if(bi.length>1){Ki=bi[0];var Zo=bi[1],qs=Ki[0]-Zo[0],yl=Ki[1]-Zo[1];ea=qs*qs+yl*yl}}function Ua(){var Ri,Fi,pi,Ci,bi=t.touches(kn);$s.call(kn);for(var Lo=0,Ki=bi.length;Lo<Ki;++Lo,Ci=null)if(pi=bi[Lo],Ci=Gn[pi.identifier]){if(Fi)break;Ri=pi,Fi=Ci}if(Ci){var Zo=(Zo=pi[0]-Ri[0])*Zo+(Zo=pi[1]-Ri[1])*Zo,qs=ea&&Math.sqrt(Zo/ea);Ri=[(Ri[0]+pi[0])/2,(Ri[1]+pi[1])/2],Fi=[(Fi[0]+Ci[0])/2,(Fi[1]+Ci[1])/2],rr(qs*Ur)}V=null,hr(Ri,Fi),Zr(Xn)}function di(){if(t.event.touches.length){for(var Ri=t.event.changedTouches,Fi=0,pi=Ri.length;Fi<pi;++Fi)delete Gn[Ri[Fi].identifier];for(var Ci in Gn)return void ba()}t.selectAll(xa).on(fa,null),ma.on(Ct,sn).on(yt,Un),La(),hn(Xn)}Pa(),Kr(Xn),ma.on(Ct,null).on(yt,Pa)}function Wn(){var Ur=Ft.of(this,arguments);F?clearTimeout(F):($s.call(this),oe=jt(C=R||t.mouse(this)),Kr(Ur)),F=setTimeout(function(){F=null,hn(Ur)},50),H(),rr(Math.pow(2,.002*Pe())*Te.k),hr(C,oe),Zr(Ur)}function ua(){var Ur=t.mouse(this),kn=Math.log(Te.k)/Math.LN2;Ar(this,Ur,jt(Ur),t.event.shiftKey?Math.ceil(kn)-1:Math.floor(kn)+1)}return Xe||(Xe="onwheel"in h?(Pe=function(){return-t.event.deltaY*(t.event.deltaMode?120:1)},"wheel"):"onmousewheel"in h?(Pe=function(){return t.event.wheelDelta},"mousewheel"):(Pe=function(){return-t.event.detail},"MozMousePixelScroll")),zt.event=function(Ur){Ur.each(function(){var kn=Ft.of(this,arguments),Xn=Te;Rs?t.select(this).transition().each("start.zoom",function(){Te=this.__chart__||{x:0,y:0,k:1},Kr(kn)}).tween("zoom:zoom",function(){var Gn=Ne[0],ea=Ne[1],fa=C?C[0]:Gn/2,Ma=C?C[1]:ea/2,Kn=t.interpolateZoom([(fa-Te.x)/Te.k,(Ma-Te.y)/Te.k,Gn/Te.k],[(fa-Xn.x)/Xn.k,(Ma-Xn.y)/Xn.k,Gn/Xn.k]);return function(xa){var ma=Kn(xa),La=Gn/ma[2];this.__chart__=Te={x:fa-ma[0]*La,y:Ma-ma[1]*La,k:La},Zr(kn)}}).each("interrupt.zoom",function(){hn(kn)}).each("end.zoom",function(){hn(kn)}):(this.__chart__=Te,Kr(kn),Zr(kn),hn(kn))})},zt.translate=function(Ur){return arguments.length?(Te={x:+Ur[0],y:+Ur[1],k:Te.k},kr(),zt):[Te.x,Te.y]},zt.scale=function(Ur){return arguments.length?(Te={x:Te.x,y:Te.y,k:null},rr(+Ur),kr(),zt):Te.k},zt.scaleExtent=function(Ur){return arguments.length?(Ge=Ur==null?ht:[+Ur[0],+Ur[1]],zt):Ge},zt.center=function(Ur){return arguments.length?(R=Ur&&[+Ur[0],+Ur[1]],zt):R},zt.size=function(Ur){return arguments.length?(Ne=Ur&&[+Ur[0],+Ur[1]],zt):Ne},zt.duration=function(Ur){return arguments.length?(nt=+Ur,zt):nt},zt.x=function(Ur){return arguments.length?(le=Ur,ne=Ur.copy(),Te={x:0,y:0,k:1},zt):le},zt.y=function(Ur){return arguments.length?(ye=Ur,pe=Ur.copy(),Te={x:0,y:0,k:1},zt):ye},t.rebind(zt,Ft,"on")};var Pe,Xe,ht=[0,1/0];function Mt(){}function pt(oe,C,R){return this instanceof pt?(this.h=+oe,this.s=+C,void(this.l=+R)):arguments.length<2?oe instanceof pt?new pt(oe.h,oe.s,oe.l):dr(""+oe,vr,pt):new pt(oe,C,R)}t.color=Mt,Mt.prototype.toString=function(){return this.rgb()+""},t.hsl=pt;var Lt=pt.prototype=new Mt;function vt(oe,C,R){var F,V;function ne(le){return Math.round(255*function(pe){return pe>360?pe-=360:pe<0&&(pe+=360),pe<60?F+(V-F)*pe/60:pe<180?V:pe<240?F+(V-F)*(240-pe)/60:F}(le))}return oe=isNaN(oe)?0:(oe%=360)<0?oe+360:oe,C=isNaN(C)||C<0?0:C>1?1:C,F=2*(R=R<0?0:R>1?1:R)-(V=R<=.5?R*(1+C):R+C-R*C),new Gt(ne(oe+120),ne(oe),ne(oe-120))}function Dt(oe,C,R){return this instanceof Dt?(this.h=+oe,this.c=+C,void(this.l=+R)):arguments.length<2?oe instanceof Dt?new Dt(oe.h,oe.c,oe.l):Ie(oe instanceof St?oe.l:(oe=ur((oe=t.rgb(oe)).r,oe.g,oe.b)).l,oe.a,oe.b):new Dt(oe,C,R)}Lt.brighter=function(oe){return oe=Math.pow(.7,arguments.length?oe:1),new pt(this.h,this.s,this.l/oe)},Lt.darker=function(oe){return oe=Math.pow(.7,arguments.length?oe:1),new pt(this.h,this.s,oe*this.l)},Lt.rgb=function(){return vt(this.h,this.s,this.l)},t.hcl=Dt;var xt=Dt.prototype=new Mt;function it(oe,C,R){return isNaN(oe)&&(oe=0),isNaN(C)&&(C=0),new St(R,Math.cos(oe*=Be)*C,Math.sin(oe)*C)}function St(oe,C,R){return this instanceof St?(this.l=+oe,this.a=+C,void(this.b=+R)):arguments.length<2?oe instanceof St?new St(oe.l,oe.a,oe.b):oe instanceof Dt?it(oe.h,oe.c,oe.l):ur((oe=Gt(oe)).r,oe.g,oe.b):new St(oe,C,R)}xt.brighter=function(oe){return new Dt(this.h,this.c,Math.min(100,this.l+Nt*(arguments.length?oe:1)))},xt.darker=function(oe){return new Dt(this.h,this.c,Math.max(0,this.l-Nt*(arguments.length?oe:1)))},xt.rgb=function(){return it(this.h,this.c,this.l).rgb()},t.lab=St;var Nt=18,Ut=St.prototype=new Mt;function Qt(oe,C,R){var F=(oe+16)/116,V=F+C/500,ne=F-R/200;return new Gt(Ot(3.2404542*(V=.95047*lt(V))-1.5371385*(F=1*lt(F))-.4985314*(ne=1.08883*lt(ne))),Ot(-.969266*V+1.8760108*F+.041556*ne),Ot(.0556434*V-.2040259*F+1.0572252*ne))}function Ie(oe,C,R){return oe>0?new Dt(Math.atan2(R,C)*Ke,Math.sqrt(C*C+R*R),oe):new Dt(NaN,NaN,oe)}function lt(oe){return oe>.206893034?oe*oe*oe:(oe-4/29)/7.787037}function wt(oe){return oe>.008856?Math.pow(oe,1/3):7.787037*oe+4/29}function Ot(oe){return Math.round(255*(oe<=.00304?12.92*oe:1.055*Math.pow(oe,1/2.4)-.055))}function Gt(oe,C,R){return this instanceof Gt?(this.r=~~oe,this.g=~~C,void(this.b=~~R)):arguments.length<2?oe instanceof Gt?new Gt(oe.r,oe.g,oe.b):dr(""+oe,Gt,vt):new Gt(oe,C,R)}function ir(oe){return new Gt(oe>>16,oe>>8&255,255&oe)}function Xt(oe){return ir(oe)+""}Ut.brighter=function(oe){return new St(Math.min(100,this.l+Nt*(arguments.length?oe:1)),this.a,this.b)},Ut.darker=function(oe){return new St(Math.max(0,this.l-Nt*(arguments.length?oe:1)),this.a,this.b)},Ut.rgb=function(){return Qt(this.l,this.a,this.b)},t.rgb=Gt;var Kt=Gt.prototype=new Mt;function or(oe){return oe<16?"0"+Math.max(0,oe).toString(16):Math.min(255,oe).toString(16)}function dr(oe,C,R){var F,V,ne,le=0,pe=0,ye=0;if(F=/([a-z]+)\((.*)\)/.exec(oe=oe.toLowerCase()))switch(V=F[2].split(","),F[1]){case"hsl":return R(parseFloat(V[0]),parseFloat(V[1])/100,parseFloat(V[2])/100);case"rgb":return C(br(V[0]),br(V[1]),br(V[2]))}return(ne=Rr.get(oe))?C(ne.r,ne.g,ne.b):(oe==null||oe.charAt(0)!=="#"||isNaN(ne=parseInt(oe.slice(1),16))||(oe.length===4?(le=(3840&ne)>>4,le|=le>>4,pe=240&ne,pe|=pe>>4,ye=15&ne,ye|=ye<<4):oe.length===7&&(le=(16711680&ne)>>16,pe=(65280&ne)>>8,ye=255&ne)),C(le,pe,ye))}function vr(oe,C,R){var F,V,ne=Math.min(oe/=255,C/=255,R/=255),le=Math.max(oe,C,R),pe=le-ne,ye=(le+ne)/2;return pe?(V=ye<.5?pe/(le+ne):pe/(2-le-ne),F=oe==le?(C-R)/pe+(C<R?6:0):C==le?(R-oe)/pe+2:(oe-C)/pe+4,F*=60):(F=NaN,V=ye>0&&ye<1?0:F),new pt(F,V,ye)}function ur(oe,C,R){var F=wt((.4124564*(oe=pr(oe))+.3575761*(C=pr(C))+.1804375*(R=pr(R)))/.95047),V=wt((.2126729*oe+.7151522*C+.072175*R)/1);return St(116*V-16,500*(F-V),200*(V-wt((.0193339*oe+.119192*C+.9503041*R)/1.08883)))}function pr(oe){return(oe/=255)<=.04045?oe/12.92:Math.pow((oe+.055)/1.055,2.4)}function br(oe){var C=parseFloat(oe);return oe.charAt(oe.length-1)==="%"?Math.round(2.55*C):C}Kt.brighter=function(oe){oe=Math.pow(.7,arguments.length?oe:1);var C=this.r,R=this.g,F=this.b,V=30;return C||R||F?(C&&C<V&&(C=V),R&&R<V&&(R=V),F&&F<V&&(F=V),new Gt(Math.min(255,C/oe),Math.min(255,R/oe),Math.min(255,F/oe))):new Gt(V,V,V)},Kt.darker=function(oe){return new Gt((oe=Math.pow(.7,arguments.length?oe:1))*this.r,oe*this.g,oe*this.b)},Kt.hsl=function(){return vr(this.r,this.g,this.b)},Kt.toString=function(){return"#"+or(this.r)+or(this.g)+or(this.b)};var Rr=t.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function _r(oe){return typeof oe=="function"?oe:function(){return oe}}function jr(oe){return function(C,R,F){return arguments.length===2&&typeof R=="function"&&(F=R,R=null),$r(C,R,oe,F)}}function $r(oe,C,R,F){var V={},ne=t.dispatch("beforesend","progress","load","error"),le={},pe=new XMLHttpRequest,ye=null;function Te(){var Ne,Ge=pe.status;if(!Ge&&function(nt){var bt=nt.responseType;return bt&&bt!=="text"?nt.response:nt.responseText}(pe)||Ge>=200&&Ge<300||Ge===304){try{Ne=R.call(V,pe)}catch(nt){return void ne.error.call(V,nt)}ne.load.call(V,Ne)}else ne.error.call(V,pe)}return self.XDomainRequest&&!("withCredentials"in pe)&&/^(http(s)?:)?\/\//.test(oe)&&(pe=new XDomainRequest),"onload"in pe?pe.onload=pe.onerror=Te:pe.onreadystatechange=function(){pe.readyState>3&&Te()},pe.onprogress=function(Ne){var Ge=t.event;t.event=Ne;try{ne.progress.call(V,pe)}finally{t.event=Ge}},V.header=function(Ne,Ge){return Ne=(Ne+"").toLowerCase(),arguments.length<2?le[Ne]:(Ge==null?delete le[Ne]:le[Ne]=Ge+"",V)},V.mimeType=function(Ne){return arguments.length?(C=Ne==null?null:Ne+"",V):C},V.responseType=function(Ne){return arguments.length?(ye=Ne,V):ye},V.response=function(Ne){return R=Ne,V},["get","post"].forEach(function(Ne){V[Ne]=function(){return V.send.apply(V,[Ne].concat(m(arguments)))}}),V.send=function(Ne,Ge,nt){if(arguments.length===2&&typeof Ge=="function"&&(nt=Ge,Ge=null),pe.open(Ne,oe,!0),C==null||"accept"in le||(le.accept=C+",*/*"),pe.setRequestHeader)for(var bt in le)pe.setRequestHeader(bt,le[bt]);return C!=null&&pe.overrideMimeType&&pe.overrideMimeType(C),ye!=null&&(pe.responseType=ye),nt!=null&&V.on("error",nt).on("load",function(Ct){nt(null,Ct)}),ne.beforesend.call(V,pe),pe.send(Ge==null?null:Ge),V},V.abort=function(){return pe.abort(),V},t.rebind(V,ne,"on"),F==null?V:V.get(function(Ne){return Ne.length===1?function(Ge,nt){Ne(Ge==null?nt:null)}:Ne}(F))}Rr.forEach(function(oe,C){Rr.set(oe,ir(C))}),t.functor=_r,t.xhr=jr(D),t.dsv=function(oe,C){var R=new RegExp('["'+oe+`
]`),F=oe.charCodeAt(0);function V(Te,Ne,Ge){arguments.length<3&&(Ge=Ne,Ne=null);var nt=$r(Te,C,Ne==null?ne:le(Ne),Ge);return nt.row=function(bt){return arguments.length?nt.response((Ne=bt)==null?ne:le(bt)):Ne},nt}function ne(Te){return V.parse(Te.responseText)}function le(Te){return function(Ne){return V.parse(Ne.responseText,Te)}}function pe(Te){return Te.map(ye).join(oe)}function ye(Te){return R.test(Te)?'"'+Te.replace(/\"/g,'""')+'"':Te}return V.parse=function(Te,Ne){var Ge;return V.parseRows(Te,function(nt,bt){if(Ge)return Ge(nt,bt-1);var Ct=function(Tt){for(var At={},yt=nt.length,Ft=0;Ft<yt;++Ft)At[nt[Ft]]=Tt[Ft];return At};Ge=Ne?function(Tt,At){return Ne(Ct(Tt),At)}:Ct})},V.parseRows=function(Te,Ne){var Ge,nt,bt={},Ct={},Tt=[],At=Te.length,yt=0,Ft=0;function zt(){if(yt>=At)return Ct;if(nt)return nt=!1,bt;var rr=yt;if(Te.charCodeAt(rr)===34){for(var hr=rr;hr++<At;)if(Te.charCodeAt(hr)===34){if(Te.charCodeAt(hr+1)!==34)break;++hr}return yt=hr+2,(Ar=Te.charCodeAt(hr+1))===13?(nt=!0,Te.charCodeAt(hr+2)===10&&++yt):Ar===10&&(nt=!0),Te.slice(rr+1,hr).replace(/""/g,'"')}for(;yt<At;){var Ar,kr=1;if((Ar=Te.charCodeAt(yt++))===10)nt=!0;else if(Ar===13)nt=!0,Te.charCodeAt(yt)===10&&(++yt,++kr);else if(Ar!==F)continue;return Te.slice(rr,yt-kr)}return Te.slice(rr)}for(;(Ge=zt())!==Ct;){for(var jt=[];Ge!==bt&&Ge!==Ct;)jt.push(Ge),Ge=zt();Ne&&(jt=Ne(jt,Ft++))==null||Tt.push(jt)}return Tt},V.format=function(Te){if(Array.isArray(Te[0]))return V.formatRows(Te);var Ne=new P,Ge=[];return Te.forEach(function(nt){for(var bt in nt)Ne.has(bt)||Ge.push(Ne.add(bt))}),[Ge.map(ye).join(oe)].concat(Te.map(function(nt){return Ge.map(function(bt){return ye(nt[bt])}).join(oe)})).join(`
`)},V.formatRows=function(Te){return Te.map(pe).join(`
`)},V},t.csv=t.dsv(",","text/csv"),t.tsv=t.dsv("	","text/tab-separated-values");var pn,In,On,Sn,an=this[U(this,"requestAnimationFrame")]||function(oe){setTimeout(oe,17)};function Nr(oe,C,R){var F=arguments.length;F<2&&(C=0),F<3&&(R=Date.now());var V=R+C,ne={c:oe,t:V,n:null};return In?In.n=ne:pn=ne,In=ne,On||(Sn=clearTimeout(Sn),On=1,an(Pr)),ne}function Pr(){var oe=en(),C=tn()-oe;C>24?(isFinite(C)&&(clearTimeout(Sn),Sn=setTimeout(Pr,C)),On=0):(On=1,an(Pr))}function en(){for(var oe=Date.now(),C=pn;C;)oe>=C.t&&C.c(oe-C.t)&&(C.c=null),C=C.n;return oe}function tn(){for(var oe,C=pn,R=1/0;C;)C.c?(C.t<R&&(R=C.t),C=(oe=C).n):C=oe?oe.n=C.n:pn=C.n;return In=oe,R}function Qr(oe){return oe[0]}function rn(oe){return oe[1]}function An(oe){for(var C,R,F,V=oe.length,ne=[0,1],le=2,pe=2;pe<V;pe++){for(;le>1&&(C=oe[ne[le-2]],R=oe[ne[le-1]],F=oe[pe],(R[0]-C[0])*(F[1]-C[1])-(R[1]-C[1])*(F[0]-C[0])<=0);)--le;ne[le++]=pe}return ne.slice(0,le)}function En(oe,C){return oe[0]-C[0]||oe[1]-C[1]}t.timer=function(){Nr.apply(this,arguments)},t.timer.flush=function(){en(),tn()},t.round=function(oe,C){return C?Math.round(oe*(C=Math.pow(10,C)))/C:Math.round(oe)},t.geom={},t.geom.hull=function(oe){var C=Qr,R=rn;if(arguments.length)return F(oe);function F(V){if(V.length<3)return[];var ne,le=_r(C),pe=_r(R),ye=V.length,Te=[],Ne=[];for(ne=0;ne<ye;ne++)Te.push([+le.call(this,V[ne],ne),+pe.call(this,V[ne],ne),ne]);for(Te.sort(En),ne=0;ne<ye;ne++)Ne.push([Te[ne][0],-Te[ne][1]]);var Ge=An(Te),nt=An(Ne),bt=nt[0]===Ge[0],Ct=nt[nt.length-1]===Ge[Ge.length-1],Tt=[];for(ne=Ge.length-1;ne>=0;--ne)Tt.push(V[Te[Ge[ne]][2]]);for(ne=+bt;ne<nt.length-Ct;++ne)Tt.push(V[Te[nt[ne]][2]]);return Tt}return F.x=function(V){return arguments.length?(C=V,F):C},F.y=function(V){return arguments.length?(R=V,F):R},F},t.geom.polygon=function(oe){return j(oe,Bn),oe};var Bn=t.geom.polygon.prototype=[];function Jt(oe,C,R){return(R[0]-C[0])*(oe[1]-C[1])<(R[1]-C[1])*(oe[0]-C[0])}function It(oe,C,R,F){var V=oe[0],ne=R[0],le=C[0]-V,pe=F[0]-ne,ye=oe[1],Te=R[1],Ne=C[1]-ye,Ge=F[1]-Te,nt=(pe*(ye-Te)-Ge*(V-ne))/(Ge*le-pe*Ne);return[V+nt*le,ye+nt*Ne]}function qt(oe){var C=oe[0],R=oe[oe.length-1];return!(C[0]-R[0]||C[1]-R[1])}Bn.area=function(){for(var oe,C=-1,R=this.length,F=this[R-1],V=0;++C<R;)oe=F,F=this[C],V+=oe[1]*F[0]-oe[0]*F[1];return .5*V},Bn.centroid=function(oe){var C,R,F=-1,V=this.length,ne=0,le=0,pe=this[V-1];for(arguments.length||(oe=-1/(6*this.area()));++F<V;)C=pe,pe=this[F],R=C[0]*pe[1]-pe[0]*C[1],ne+=(C[0]+pe[0])*R,le+=(C[1]+pe[1])*R;return[ne*oe,le*oe]},Bn.clip=function(oe){for(var C,R,F,V,ne,le,pe=qt(oe),ye=-1,Te=this.length-qt(this),Ne=this[Te-1];++ye<Te;){for(C=oe.slice(),oe.length=0,V=this[ye],ne=C[(F=C.length-pe)-1],R=-1;++R<F;)Jt(le=C[R],Ne,V)?(Jt(ne,Ne,V)||oe.push(It(ne,le,Ne,V)),oe.push(le)):Jt(ne,Ne,V)&&oe.push(It(ne,le,Ne,V)),ne=le;pe&&oe.push(oe[0]),Ne=V}return oe};var fr,Tr,Gr,Vr,xr,wr=[],Sr=[];function Mr(){li(this),this.edge=this.site=this.circle=null}function Ir(oe){var C=wr.pop()||new Mr;return C.site=oe,C}function qr(oe){Pn(oe),Gr.remove(oe),wr.push(oe),li(oe)}function cn(oe){var C=oe.circle,R=C.x,F=C.cy,V={x:R,y:F},ne=oe.P,le=oe.N,pe=[oe];qr(oe);for(var ye=ne;ye.circle&&v(R-ye.circle.x)<_t&&v(F-ye.circle.cy)<_t;)ne=ye.P,pe.unshift(ye),qr(ye),ye=ne;pe.unshift(ye),Pn(ye);for(var Te=le;Te.circle&&v(R-Te.circle.x)<_t&&v(F-Te.circle.cy)<_t;)le=Te.N,pe.push(Te),qr(Te),Te=le;pe.push(Te),Pn(Te);var Ne,Ge=pe.length;for(Ne=1;Ne<Ge;++Ne)Te=pe[Ne],ye=pe[Ne-1],pa(Te.edge,ye.site,Te.site,V);ye=pe[0],(Te=pe[Ge-1]).edge=yn(ye.site,Te.site,null,V),dn(ye),dn(Te)}function _n(oe){for(var C,R,F,V,ne=oe.x,le=oe.y,pe=Gr._;pe;)if((F=Jr(pe,le)-ne)>_t)pe=pe.L;else{if(!((V=ne-bn(pe,le))>_t)){F>-_t?(C=pe.P,R=pe):V>-_t?(C=pe,R=pe.N):C=R=pe;break}if(!pe.R){C=pe;break}pe=pe.R}var ye=Ir(oe);if(Gr.insert(C,ye),C||R){if(C===R)return Pn(C),R=Ir(C.site),Gr.insert(ye,R),ye.edge=R.edge=yn(C.site,ye.site),dn(C),void dn(R);if(R){Pn(C),Pn(R);var Te=C.site,Ne=Te.x,Ge=Te.y,nt=oe.x-Ne,bt=oe.y-Ge,Ct=R.site,Tt=Ct.x-Ne,At=Ct.y-Ge,yt=2*(nt*At-bt*Tt),Ft=nt*nt+bt*bt,zt=Tt*Tt+At*At,jt={x:(At*Ft-bt*zt)/yt+Ne,y:(nt*zt-Tt*Ft)/yt+Ge};pa(R.edge,Te,Ct,jt),ye.edge=yn(Te,oe,null,jt),R.edge=yn(oe,Ct,null,jt),dn(C),dn(R)}else ye.edge=yn(C.site,ye.site)}}function Jr(oe,C){var R=oe.site,F=R.x,V=R.y,ne=V-C;if(!ne)return F;var le=oe.P;if(!le)return-1/0;var pe=(R=le.site).x,ye=R.y,Te=ye-C;if(!Te)return pe;var Ne=pe-F,Ge=1/ne-1/Te,nt=Ne/Te;return Ge?(-nt+Math.sqrt(nt*nt-2*Ge*(Ne*Ne/(-2*Te)-ye+Te/2+V-ne/2)))/Ge+F:(F+pe)/2}function bn(oe,C){var R=oe.N;if(R)return Jr(R,C);var F=oe.site;return F.y===C?F.x:1/0}function Dr(oe){this.site=oe,this.edges=[]}function Wr(oe,C){return C.angle-oe.angle}function vn(){li(this),this.x=this.y=this.arc=this.site=this.cy=null}function dn(oe){var C=oe.P,R=oe.N;if(C&&R){var F=C.site,V=oe.site,ne=R.site;if(F!==ne){var le=V.x,pe=V.y,ye=F.x-le,Te=F.y-pe,Ne=ne.x-le,Ge=2*(ye*(At=ne.y-pe)-Te*Ne);if(!(Ge>=-1e-12)){var nt=ye*ye+Te*Te,bt=Ne*Ne+At*At,Ct=(At*nt-Te*bt)/Ge,Tt=(ye*bt-Ne*nt)/Ge,At=Tt+pe,yt=Sr.pop()||new vn;yt.arc=oe,yt.site=V,yt.x=Ct+le,yt.y=At+Math.sqrt(Ct*Ct+Tt*Tt),yt.cy=At,oe.circle=yt;for(var Ft=null,zt=xr._;zt;)if(yt.y<zt.y||yt.y===zt.y&&yt.x<=zt.x){if(!zt.L){Ft=zt.P;break}zt=zt.L}else{if(!zt.R){Ft=zt;break}zt=zt.R}xr.insert(Ft,yt),Ft||(Vr=yt)}}}}function Pn(oe){var C=oe.circle;C&&(C.P||(Vr=C.N),xr.remove(C),Sr.push(C),li(C),oe.circle=null)}function sa(oe,C){var R=oe.b;if(R)return!0;var F,V,ne=oe.a,le=C[0][0],pe=C[1][0],ye=C[0][1],Te=C[1][1],Ne=oe.l,Ge=oe.r,nt=Ne.x,bt=Ne.y,Ct=Ge.x,Tt=Ge.y,At=(nt+Ct)/2,yt=(bt+Tt)/2;if(Tt===bt){if(At<le||At>=pe)return;if(nt>Ct){if(ne){if(ne.y>=Te)return}else ne={x:At,y:ye};R={x:At,y:Te}}else{if(ne){if(ne.y<ye)return}else ne={x:At,y:Te};R={x:At,y:ye}}}else if(V=yt-(F=(nt-Ct)/(Tt-bt))*At,F<-1||F>1)if(nt>Ct){if(ne){if(ne.y>=Te)return}else ne={x:(ye-V)/F,y:ye};R={x:(Te-V)/F,y:Te}}else{if(ne){if(ne.y<ye)return}else ne={x:(Te-V)/F,y:Te};R={x:(ye-V)/F,y:ye}}else if(bt<Tt){if(ne){if(ne.x>=pe)return}else ne={x:le,y:F*le+V};R={x:pe,y:F*pe+V}}else{if(ne){if(ne.x<le)return}else ne={x:pe,y:F*pe+V};R={x:le,y:F*le+V}}return oe.a=ne,oe.b=R,!0}function Yn(oe,C){this.l=oe,this.r=C,this.a=this.b=null}function yn(oe,C,R,F){var V=new Yn(oe,C);return fr.push(V),R&&pa(V,oe,C,R),F&&pa(V,C,oe,F),Tr[oe.i].edges.push(new Qa(V,oe,C)),Tr[C.i].edges.push(new Qa(V,C,oe)),V}function ra(oe,C,R){var F=new Yn(oe,null);return F.a=C,F.b=R,fr.push(F),F}function pa(oe,C,R,F){oe.a||oe.b?oe.l===R?oe.b=F:oe.a=F:(oe.a=F,oe.l=C,oe.r=R)}function Qa(oe,C,R){var F=oe.a,V=oe.b;this.edge=oe,this.site=C,this.angle=R?Math.atan2(R.y-C.y,R.x-C.x):oe.l===C?Math.atan2(V.x-F.x,F.y-V.y):Math.atan2(F.x-V.x,V.y-F.y)}function Bi(){this._=null}function li(oe){oe.U=oe.C=oe.L=oe.R=oe.P=oe.N=null}function Ai(oe,C){var R=C,F=C.R,V=R.U;V?V.L===R?V.L=F:V.R=F:oe._=F,F.U=V,R.U=F,R.R=F.L,R.R&&(R.R.U=R),F.L=R}function Ea(oe,C){var R=C,F=C.L,V=R.U;V?V.L===R?V.L=F:V.R=F:oe._=F,F.U=V,R.U=F,R.L=F.R,R.L&&(R.L.U=R),F.R=R}function Ga(oe){for(;oe.L;)oe=oe.L;return oe}function ko(oe,C){var R,F,V,ne=oe.sort(Qo).pop();for(fr=[],Tr=new Array(oe.length),Gr=new Bi,xr=new Bi;;)if(V=Vr,ne&&(!V||ne.y<V.y||ne.y===V.y&&ne.x<V.x))ne.x===R&&ne.y===F||(Tr[ne.i]=new Dr(ne),_n(ne),R=ne.x,F=ne.y),ne=oe.pop();else{if(!V)break;cn(V.arc)}C&&(function(pe){for(var ye,Te,Ne,Ge,nt,bt=fr,Ct=(Te=pe[0][0],Ne=pe[0][1],Ge=pe[1][0],nt=pe[1][1],function(At){var yt,Ft=At.a,zt=At.b,jt=Ft.x,rr=Ft.y,hr=0,Ar=1,kr=zt.x-jt,Kr=zt.y-rr;if(yt=Te-jt,kr||!(yt>0)){if(yt/=kr,kr<0){if(yt<hr)return;yt<Ar&&(Ar=yt)}else if(kr>0){if(yt>Ar)return;yt>hr&&(hr=yt)}if(yt=Ge-jt,kr||!(yt<0)){if(yt/=kr,kr<0){if(yt>Ar)return;yt>hr&&(hr=yt)}else if(kr>0){if(yt<hr)return;yt<Ar&&(Ar=yt)}if(yt=Ne-rr,Kr||!(yt>0)){if(yt/=Kr,Kr<0){if(yt<hr)return;yt<Ar&&(Ar=yt)}else if(Kr>0){if(yt>Ar)return;yt>hr&&(hr=yt)}if(yt=nt-rr,Kr||!(yt<0)){if(yt/=Kr,Kr<0){if(yt>Ar)return;yt>hr&&(hr=yt)}else if(Kr>0){if(yt<hr)return;yt<Ar&&(Ar=yt)}return hr>0&&(At.a={x:jt+hr*kr,y:rr+hr*Kr}),Ar<1&&(At.b={x:jt+Ar*kr,y:rr+Ar*Kr}),At}}}}}),Tt=bt.length;Tt--;)(!sa(ye=bt[Tt],pe)||!Ct(ye)||v(ye.a.x-ye.b.x)<_t&&v(ye.a.y-ye.b.y)<_t)&&(ye.a=ye.b=null,bt.splice(Tt,1))}(C),function(pe){for(var ye,Te,Ne,Ge,nt,bt,Ct,Tt,At,yt,Ft=pe[0][0],zt=pe[1][0],jt=pe[0][1],rr=pe[1][1],hr=Tr,Ar=hr.length;Ar--;)if((nt=hr[Ar])&&nt.prepare())for(Tt=(Ct=nt.edges).length,bt=0;bt<Tt;)Ne=(yt=Ct[bt].end()).x,Ge=yt.y,ye=(At=Ct[++bt%Tt].start()).x,Te=At.y,(v(Ne-ye)>_t||v(Ge-Te)>_t)&&(Ct.splice(bt,0,new Qa(ra(nt.site,yt,v(Ne-Ft)<_t&&rr-Ge>_t?{x:Ft,y:v(ye-Ft)<_t?Te:rr}:v(Ge-rr)<_t&&zt-Ne>_t?{x:v(Te-rr)<_t?ye:zt,y:rr}:v(Ne-zt)<_t&&Ge-jt>_t?{x:zt,y:v(ye-zt)<_t?Te:jt}:v(Ge-jt)<_t&&Ne-Ft>_t?{x:v(Te-jt)<_t?ye:Ft,y:jt}:null),nt.site,null)),++Tt)}(C));var le={cells:Tr,edges:fr};return Gr=xr=fr=Tr=null,le}function Qo(oe,C){return C.y-oe.y||C.x-oe.x}Dr.prototype.prepare=function(){for(var oe,C=this.edges,R=C.length;R--;)(oe=C[R].edge).b&&oe.a||C.splice(R,1);return C.sort(Wr),C.length},Qa.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Bi.prototype={insert:function(oe,C){var R,F,V;if(oe){if(C.P=oe,C.N=oe.N,oe.N&&(oe.N.P=C),oe.N=C,oe.R){for(oe=oe.R;oe.L;)oe=oe.L;oe.L=C}else oe.R=C;R=oe}else this._?(oe=Ga(this._),C.P=null,C.N=oe,oe.P=oe.L=C,R=oe):(C.P=C.N=null,this._=C,R=null);for(C.L=C.R=null,C.U=R,C.C=!0,oe=C;R&&R.C;)R===(F=R.U).L?(V=F.R)&&V.C?(R.C=V.C=!1,F.C=!0,oe=F):(oe===R.R&&(Ai(this,R),R=(oe=R).U),R.C=!1,F.C=!0,Ea(this,F)):(V=F.L)&&V.C?(R.C=V.C=!1,F.C=!0,oe=F):(oe===R.L&&(Ea(this,R),R=(oe=R).U),R.C=!1,F.C=!0,Ai(this,F)),R=oe.U;this._.C=!1},remove:function(oe){oe.N&&(oe.N.P=oe.P),oe.P&&(oe.P.N=oe.N),oe.N=oe.P=null;var C,R,F,V=oe.U,ne=oe.L,le=oe.R;if(R=ne?le?Ga(le):ne:le,V?V.L===oe?V.L=R:V.R=R:this._=R,ne&&le?(F=R.C,R.C=oe.C,R.L=ne,ne.U=R,R!==le?(V=R.U,R.U=oe.U,oe=R.R,V.L=oe,R.R=le,le.U=R):(R.U=V,V=R,oe=R.R)):(F=oe.C,oe=R),oe&&(oe.U=V),!F)if(oe&&oe.C)oe.C=!1;else{do{if(oe===this._)break;if(oe===V.L){if((C=V.R).C&&(C.C=!1,V.C=!0,Ai(this,V),C=V.R),C.L&&C.L.C||C.R&&C.R.C){C.R&&C.R.C||(C.L.C=!1,C.C=!0,Ea(this,C),C=V.R),C.C=V.C,V.C=C.R.C=!1,Ai(this,V),oe=this._;break}}else if((C=V.L).C&&(C.C=!1,V.C=!0,Ea(this,V),C=V.L),C.L&&C.L.C||C.R&&C.R.C){C.L&&C.L.C||(C.R.C=!1,C.C=!0,Ai(this,C),C=V.L),C.C=V.C,V.C=C.L.C=!1,Ea(this,V),oe=this._;break}C.C=!0,oe=V,V=V.U}while(!oe.C);oe&&(oe.C=!1)}}},t.geom.voronoi=function(oe){var C=Qr,R=rn,F=C,V=R,ne=us;if(oe)return le(oe);function le(ye){var Te=new Array(ye.length),Ne=ne[0][0],Ge=ne[0][1],nt=ne[1][0],bt=ne[1][1];return ko(pe(ye),ne).cells.forEach(function(Ct,Tt){var At=Ct.edges,yt=Ct.site;(Te[Tt]=At.length?At.map(function(Ft){var zt=Ft.start();return[zt.x,zt.y]}):yt.x>=Ne&&yt.x<=nt&&yt.y>=Ge&&yt.y<=bt?[[Ne,bt],[nt,bt],[nt,Ge],[Ne,Ge]]:[]).point=ye[Tt]}),Te}function pe(ye){return ye.map(function(Te,Ne){return{x:Math.round(F(Te,Ne)/_t)*_t,y:Math.round(V(Te,Ne)/_t)*_t,i:Ne}})}return le.links=function(ye){return ko(pe(ye)).edges.filter(function(Te){return Te.l&&Te.r}).map(function(Te){return{source:ye[Te.l.i],target:ye[Te.r.i]}})},le.triangles=function(ye){var Te=[];return ko(pe(ye)).cells.forEach(function(Ne,Ge){for(var nt,bt,Ct,Tt,At=Ne.site,yt=Ne.edges.sort(Wr),Ft=-1,zt=yt.length,jt=yt[zt-1].edge,rr=jt.l===At?jt.r:jt.l;++Ft<zt;)nt=rr,rr=(jt=yt[Ft].edge).l===At?jt.r:jt.l,Ge<nt.i&&Ge<rr.i&&(Ct=nt,Tt=rr,((bt=At).x-Tt.x)*(Ct.y-bt.y)-(bt.x-Ct.x)*(Tt.y-bt.y)<0)&&Te.push([ye[Ge],ye[nt.i],ye[rr.i]])}),Te},le.x=function(ye){return arguments.length?(F=_r(C=ye),le):C},le.y=function(ye){return arguments.length?(V=_r(R=ye),le):R},le.clipExtent=function(ye){return arguments.length?(ne=ye==null?us:ye,le):ne===us?null:ne},le.size=function(ye){return arguments.length?le.clipExtent(ye&&[[0,0],ye]):ne===us?null:ne&&ne[1]},le};var us=[[-1e6,-1e6],[1e6,1e6]];function $i(oe){return oe.x}function to(oe){return oe.y}function es(oe,C,R,F,V,ne){if(!oe(C,R,F,V,ne)){var le=.5*(R+V),pe=.5*(F+ne),ye=C.nodes;ye[0]&&es(oe,ye[0],R,F,le,pe),ye[1]&&es(oe,ye[1],le,F,V,pe),ye[2]&&es(oe,ye[2],R,pe,le,ne),ye[3]&&es(oe,ye[3],le,pe,V,ne)}}function Wa(oe,C,R,F,V,ne,le){var pe,ye=1/0;return function Te(Ne,Ge,nt,bt,Ct){if(!(Ge>ne||nt>le||bt<F||Ct<V)){if(Tt=Ne.point){var Tt,At=C-Ne.x,yt=R-Ne.y,Ft=At*At+yt*yt;if(Ft<ye){var zt=Math.sqrt(ye=Ft);F=C-zt,V=R-zt,ne=C+zt,le=R+zt,pe=Tt}}for(var jt=Ne.nodes,rr=.5*(Ge+bt),hr=.5*(nt+Ct),Ar=(R>=hr)<<1|C>=rr,kr=Ar+4;Ar<kr;++Ar)if(Ne=jt[3&Ar])switch(3&Ar){case 0:Te(Ne,Ge,nt,rr,hr);break;case 1:Te(Ne,rr,nt,bt,hr);break;case 2:Te(Ne,Ge,hr,rr,Ct);break;case 3:Te(Ne,rr,hr,bt,Ct)}}}(oe,F,V,ne,le),pe}function jo(oe,C){oe=t.rgb(oe),C=t.rgb(C);var R=oe.r,F=oe.g,V=oe.b,ne=C.r-R,le=C.g-F,pe=C.b-V;return function(ye){return"#"+or(Math.round(R+ne*ye))+or(Math.round(F+le*ye))+or(Math.round(V+pe*ye))}}function Ao(oe,C){var R,F={},V={};for(R in oe)R in C?F[R]=Vi(oe[R],C[R]):V[R]=oe[R];for(R in C)R in oe||(V[R]=C[R]);return function(ne){for(R in F)V[R]=F[R](ne);return V}}function Mi(oe,C){return oe=+oe,C=+C,function(R){return oe*(1-R)+C*R}}function ro(oe,C){var R,F,V,ne=Mo.lastIndex=zo.lastIndex=0,le=-1,pe=[],ye=[];for(oe+="",C+="";(R=Mo.exec(oe))&&(F=zo.exec(C));)(V=F.index)>ne&&(V=C.slice(ne,V),pe[le]?pe[le]+=V:pe[++le]=V),(R=R[0])===(F=F[0])?pe[le]?pe[le]+=F:pe[++le]=F:(pe[++le]=null,ye.push({i:le,x:Mi(R,F)})),ne=zo.lastIndex;return ne<C.length&&(V=C.slice(ne),pe[le]?pe[le]+=V:pe[++le]=V),pe.length<2?ye[0]?(C=ye[0].x,function(Te){return C(Te)+""}):function(){return C}:(C=ye.length,function(Te){for(var Ne,Ge=0;Ge<C;++Ge)pe[(Ne=ye[Ge]).i]=Ne.x(Te);return pe.join("")})}t.geom.delaunay=function(oe){return t.geom.voronoi().triangles(oe)},t.geom.quadtree=function(oe,C,R,F,V){var ne,le=Qr,pe=rn;if(ne=arguments.length)return le=$i,pe=to,ne===3&&(V=R,F=C,R=C=0),ye(oe);function ye(Te){var Ne,Ge,nt,bt,Ct,Tt,At,yt,Ft,zt=_r(le),jt=_r(pe);if(C!=null)Tt=C,At=R,yt=F,Ft=V;else if(yt=Ft=-(Tt=At=1/0),Ge=[],nt=[],Ct=Te.length,ne)for(bt=0;bt<Ct;++bt)(Ne=Te[bt]).x<Tt&&(Tt=Ne.x),Ne.y<At&&(At=Ne.y),Ne.x>yt&&(yt=Ne.x),Ne.y>Ft&&(Ft=Ne.y),Ge.push(Ne.x),nt.push(Ne.y);else for(bt=0;bt<Ct;++bt){var rr=+zt(Ne=Te[bt],bt),hr=+jt(Ne,bt);rr<Tt&&(Tt=rr),hr<At&&(At=hr),rr>yt&&(yt=rr),hr>Ft&&(Ft=hr),Ge.push(rr),nt.push(hr)}var Ar=yt-Tt,kr=Ft-At;function Kr(sn,Un,Wn,ua,Ur,kn,Xn,Gn){if(!isNaN(Wn)&&!isNaN(ua))if(sn.leaf){var ea=sn.x,fa=sn.y;if(ea!=null)if(v(ea-Wn)+v(fa-ua)<.01)Zr(sn,Un,Wn,ua,Ur,kn,Xn,Gn);else{var Ma=sn.point;sn.x=sn.y=sn.point=null,Zr(sn,Ma,ea,fa,Ur,kn,Xn,Gn),Zr(sn,Un,Wn,ua,Ur,kn,Xn,Gn)}else sn.x=Wn,sn.y=ua,sn.point=Un}else Zr(sn,Un,Wn,ua,Ur,kn,Xn,Gn)}function Zr(sn,Un,Wn,ua,Ur,kn,Xn,Gn){var ea=.5*(Ur+Xn),fa=.5*(kn+Gn),Ma=Wn>=ea,Kn=ua>=fa,xa=Kn<<1|Ma;sn.leaf=!1,Ma?Ur=ea:Xn=ea,Kn?kn=fa:Gn=fa,Kr(sn=sn.nodes[xa]||(sn.nodes[xa]={leaf:!0,nodes:[],point:null,x:null,y:null}),Un,Wn,ua,Ur,kn,Xn,Gn)}Ar>kr?Ft=At+Ar:yt=Tt+kr;var hn={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(sn){Kr(hn,sn,+zt(sn,++bt),+jt(sn,bt),Tt,At,yt,Ft)},visit:function(sn){es(sn,hn,Tt,At,yt,Ft)},find:function(sn){return Wa(hn,sn[0],sn[1],Tt,At,yt,Ft)}};if(bt=-1,C==null){for(;++bt<Ct;)Kr(hn,Te[bt],Ge[bt],nt[bt],Tt,At,yt,Ft);--bt}else Te.forEach(hn.add);return Ge=nt=Te=Ne=null,hn}return ye.x=function(Te){return arguments.length?(le=Te,ye):le},ye.y=function(Te){return arguments.length?(pe=Te,ye):pe},ye.extent=function(Te){return arguments.length?(Te==null?C=R=F=V=null:(C=+Te[0][0],R=+Te[0][1],F=+Te[1][0],V=+Te[1][1]),ye):C==null?null:[[C,R],[F,V]]},ye.size=function(Te){return arguments.length?(Te==null?C=R=F=V=null:(C=R=0,F=+Te[0],V=+Te[1]),ye):C==null?null:[F-C,V-R]},ye},t.interpolateRgb=jo,t.interpolateObject=Ao,t.interpolateNumber=Mi,t.interpolateString=ro;var Mo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zo=new RegExp(Mo.source,"g");function Vi(oe,C){for(var R,F=t.interpolators.length;--F>=0&&!(R=t.interpolators[F](oe,C)););return R}function yi(oe,C){var R,F=[],V=[],ne=oe.length,le=C.length,pe=Math.min(oe.length,C.length);for(R=0;R<pe;++R)F.push(Vi(oe[R],C[R]));for(;R<ne;++R)V[R]=oe[R];for(;R<le;++R)V[R]=C[R];return function(ye){for(R=0;R<pe;++R)V[R]=F[R](ye);return V}}t.interpolate=Vi,t.interpolators=[function(oe,C){var R=typeof C;return(R==="string"?Rr.has(C.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(C)?jo:ro:C instanceof Mt?jo:Array.isArray(C)?yi:R==="object"&&isNaN(C)?Ao:Mi)(oe,C)}],t.interpolateArray=yi;var Qi=function(){return D},Vs=t.map({linear:Qi,poly:function(oe){return function(C){return Math.pow(C,oe)}},quad:function(){return Zs},cubic:function(){return Ks},sin:function(){return Js},exp:function(){return Uo},circle:function(){return Vo},elastic:function(oe,C){var R;return arguments.length<2&&(C=.45),arguments.length?R=C/tr*Math.asin(1/oe):(oe=1,R=C/4),function(F){return 1+oe*Math.pow(2,-10*F)*Math.sin((F-R)*tr/C)}},back:function(oe){return oe||(oe=1.70158),function(C){return C*C*((oe+1)*C-oe)}},bounce:function(){return ts}}),Xs=t.map({in:D,out:Os,"in-out":ms,"out-in":function(oe){return ms(Os(oe))}});function Xa(oe){return function(C){return C<=0?0:C>=1?1:oe(C)}}function Os(oe){return function(C){return 1-oe(1-C)}}function ms(oe){return function(C){return .5*(C<.5?oe(2*C):2-oe(2-2*C))}}function Zs(oe){return oe*oe}function Ks(oe){return oe*oe*oe}function Hs(oe){if(oe<=0)return 0;if(oe>=1)return 1;var C=oe*oe,R=C*oe;return 4*(oe<.5?R:3*(oe-C)+R-.75)}function Js(oe){return 1-Math.cos(oe*He)}function Uo(oe){return Math.pow(2,10*(oe-1))}function Vo(oe){return 1-Math.sqrt(1-oe*oe)}function ts(oe){return oe<1/2.75?7.5625*oe*oe:oe<2/2.75?7.5625*(oe-=1.5/2.75)*oe+.75:oe<2.5/2.75?7.5625*(oe-=2.25/2.75)*oe+.9375:7.5625*(oe-=2.625/2.75)*oe+.984375}function rs(oe,C){return C-=oe,function(R){return Math.round(oe+C*R)}}function ns(oe){var C,R,F,V=[oe.a,oe.b],ne=[oe.c,oe.d],le=So(V),pe=vs(V,ne),ye=So(((C=ne)[0]+=(F=-pe)*(R=V)[0],C[1]+=F*R[1],C))||0;V[0]*ne[1]<ne[0]*V[1]&&(V[0]*=-1,V[1]*=-1,le*=-1,pe*=-1),this.rotate=(le?Math.atan2(V[1],V[0]):Math.atan2(-ne[0],ne[1]))*Ke,this.translate=[oe.e,oe.f],this.scale=[le,ye],this.skew=ye?Math.atan2(pe,ye)*Ke:0}function vs(oe,C){return oe[0]*C[0]+oe[1]*C[1]}function So(oe){var C=Math.sqrt(vs(oe,oe));return C&&(oe[0]/=C,oe[1]/=C),C}t.ease=function(oe){var C=oe.indexOf("-"),R=C>=0?oe.slice(0,C):oe,F=C>=0?oe.slice(C+1):"in";return R=Vs.get(R)||Qi,Xa((F=Xs.get(F)||D)(R.apply(null,d.call(arguments,1))))},t.interpolateHcl=function(oe,C){oe=t.hcl(oe),C=t.hcl(C);var R=oe.h,F=oe.c,V=oe.l,ne=C.h-R,le=C.c-F,pe=C.l-V;return isNaN(le)&&(le=0,F=isNaN(F)?C.c:F),isNaN(ne)?(ne=0,R=isNaN(R)?C.h:R):ne>180?ne-=360:ne<-180&&(ne+=360),function(ye){return it(R+ne*ye,F+le*ye,V+pe*ye)+""}},t.interpolateHsl=function(oe,C){oe=t.hsl(oe),C=t.hsl(C);var R=oe.h,F=oe.s,V=oe.l,ne=C.h-R,le=C.s-F,pe=C.l-V;return isNaN(le)&&(le=0,F=isNaN(F)?C.s:F),isNaN(ne)?(ne=0,R=isNaN(R)?C.h:R):ne>180?ne-=360:ne<-180&&(ne+=360),function(ye){return vt(R+ne*ye,F+le*ye,V+pe*ye)+""}},t.interpolateLab=function(oe,C){oe=t.lab(oe),C=t.lab(C);var R=oe.l,F=oe.a,V=oe.b,ne=C.l-R,le=C.a-F,pe=C.b-V;return function(ye){return Qt(R+ne*ye,F+le*ye,V+pe*ye)+""}},t.interpolateRound=rs,t.transform=function(oe){var C=h.createElementNS(t.ns.prefix.svg,"g");return(t.transform=function(R){if(R!=null){C.setAttribute("transform",R);var F=C.transform.baseVal.consolidate()}return new ns(F?F.matrix:Ds)})(oe)},ns.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Ds={a:1,b:0,c:0,d:1,e:0,f:0};function vo(oe){return oe.length?oe.pop()+",":""}function as(oe,C){var R=[],F=[];return oe=t.transform(oe),C=t.transform(C),function(V,ne,le,pe){if(V[0]!==ne[0]||V[1]!==ne[1]){var ye=le.push("translate(",null,",",null,")");pe.push({i:ye-4,x:Mi(V[0],ne[0])},{i:ye-2,x:Mi(V[1],ne[1])})}else(ne[0]||ne[1])&&le.push("translate("+ne+")")}(oe.translate,C.translate,R,F),function(V,ne,le,pe){V!==ne?(V-ne>180?ne+=360:ne-V>180&&(V+=360),pe.push({i:le.push(vo(le)+"rotate(",null,")")-2,x:Mi(V,ne)})):ne&&le.push(vo(le)+"rotate("+ne+")")}(oe.rotate,C.rotate,R,F),function(V,ne,le,pe){V!==ne?pe.push({i:le.push(vo(le)+"skewX(",null,")")-2,x:Mi(V,ne)}):ne&&le.push(vo(le)+"skewX("+ne+")")}(oe.skew,C.skew,R,F),function(V,ne,le,pe){if(V[0]!==ne[0]||V[1]!==ne[1]){var ye=le.push(vo(le)+"scale(",null,",",null,")");pe.push({i:ye-4,x:Mi(V[0],ne[0])},{i:ye-2,x:Mi(V[1],ne[1])})}else ne[0]===1&&ne[1]===1||le.push(vo(le)+"scale("+ne+")")}(oe.scale,C.scale,R,F),oe=C=null,function(V){for(var ne,le=-1,pe=F.length;++le<pe;)R[(ne=F[le]).i]=ne.x(V);return R.join("")}}function zs(oe,C){return C=(C-=oe=+oe)||1/C,function(R){return(R-oe)/C}}function Ho(oe,C){return C=(C-=oe=+oe)||1/C,function(R){return Math.max(0,Math.min(1,(R-oe)/C))}}function qa(oe){for(var C=oe.source,R=oe.target,F=function(le,pe){if(le===pe)return le;for(var ye=Re(le),Te=Re(pe),Ne=ye.pop(),Ge=Te.pop(),nt=null;Ne===Ge;)nt=Ne,Ne=ye.pop(),Ge=Te.pop();return nt}(C,R),V=[C];C!==F;)C=C.parent,V.push(C);for(var ne=V.length;R!==F;)V.splice(ne,0,R),R=R.parent;return V}function Re(oe){for(var C=[],R=oe.parent;R!=null;)C.push(oe),oe=R,R=R.parent;return C.push(oe),C}function Ve(oe){oe.fixed|=2}function $e(oe){oe.fixed&=-7}function ot(oe){oe.fixed|=4,oe.px=oe.x,oe.py=oe.y}function mt(oe){oe.fixed&=-5}t.interpolateTransform=as,t.layout={},t.layout.bundle=function(){return function(oe){for(var C=[],R=-1,F=oe.length;++R<F;)C.push(qa(oe[R]));return C}},t.layout.chord=function(){var oe,C,R,F,V,ne,le,pe={},ye=0;function Te(){var Ge,nt,bt,Ct,Tt,At={},yt=[],Ft=t.range(F),zt=[];for(oe=[],C=[],Ge=0,Ct=-1;++Ct<F;){for(nt=0,Tt=-1;++Tt<F;)nt+=R[Ct][Tt];yt.push(nt),zt.push(t.range(F)),Ge+=nt}for(V&&Ft.sort(function(hn,sn){return V(yt[hn],yt[sn])}),ne&&zt.forEach(function(hn,sn){hn.sort(function(Un,Wn){return ne(R[sn][Un],R[sn][Wn])})}),Ge=(tr-ye*F)/Ge,nt=0,Ct=-1;++Ct<F;){for(bt=nt,Tt=-1;++Tt<F;){var jt=Ft[Ct],rr=zt[jt][Tt],hr=R[jt][rr],Ar=nt,kr=nt+=hr*Ge;At[jt+"-"+rr]={index:jt,subindex:rr,startAngle:Ar,endAngle:kr,value:hr}}C[jt]={index:jt,startAngle:bt,endAngle:nt,value:yt[jt]},nt+=ye}for(Ct=-1;++Ct<F;)for(Tt=Ct-1;++Tt<F;){var Kr=At[Ct+"-"+Tt],Zr=At[Tt+"-"+Ct];(Kr.value||Zr.value)&&oe.push(Kr.value<Zr.value?{source:Zr,target:Kr}:{source:Kr,target:Zr})}le&&Ne()}function Ne(){oe.sort(function(Ge,nt){return le((Ge.source.value+Ge.target.value)/2,(nt.source.value+nt.target.value)/2)})}return pe.matrix=function(Ge){return arguments.length?(F=(R=Ge)&&R.length,oe=C=null,pe):R},pe.padding=function(Ge){return arguments.length?(ye=Ge,oe=C=null,pe):ye},pe.sortGroups=function(Ge){return arguments.length?(V=Ge,oe=C=null,pe):V},pe.sortSubgroups=function(Ge){return arguments.length?(ne=Ge,oe=null,pe):ne},pe.sortChords=function(Ge){return arguments.length?(le=Ge,oe&&Ne(),pe):le},pe.chords=function(){return oe||Te(),oe},pe.groups=function(){return C||Te(),C},pe},t.layout.force=function(){var oe,C,R,F,V,ne,le={},pe=t.dispatch("start","tick","end"),ye=[1,1],Te=.9,Ne=dt,Ge=Et,nt=-30,bt=Zt,Ct=.1,Tt=.64,At=[],yt=[];function Ft(jt){return function(rr,hr,Ar,kr){if(rr.point!==jt){var Kr=rr.cx-jt.x,Zr=rr.cy-jt.y,hn=kr-hr,sn=Kr*Kr+Zr*Zr;if(hn*hn/Tt<sn){if(sn<bt){var Un=rr.charge/sn;jt.px-=Kr*Un,jt.py-=Zr*Un}return!0}rr.point&&sn&&sn<bt&&(Un=rr.pointCharge/sn,jt.px-=Kr*Un,jt.py-=Zr*Un)}return!rr.charge}}function zt(jt){jt.px=t.event.x,jt.py=t.event.y,le.resume()}return le.tick=function(){if((R*=.99)<.005)return oe=null,pe.end({type:"end",alpha:R=0}),!0;var jt,rr,hr,Ar,kr,Kr,Zr,hn,sn,Un=At.length,Wn=yt.length;for(rr=0;rr<Wn;++rr)Ar=(hr=yt[rr]).source,(Kr=(hn=(kr=hr.target).x-Ar.x)*hn+(sn=kr.y-Ar.y)*sn)&&(hn*=Kr=R*V[rr]*((Kr=Math.sqrt(Kr))-F[rr])/Kr,sn*=Kr,kr.x-=hn*(Zr=Ar.weight+kr.weight?Ar.weight/(Ar.weight+kr.weight):.5),kr.y-=sn*Zr,Ar.x+=hn*(Zr=1-Zr),Ar.y+=sn*Zr);if((Zr=R*Ct)&&(hn=ye[0]/2,sn=ye[1]/2,rr=-1,Zr))for(;++rr<Un;)(hr=At[rr]).x+=(hn-hr.x)*Zr,hr.y+=(sn-hr.y)*Zr;if(nt)for(function ua(Ur,kn,Xn){var Gn=0,ea=0;if(Ur.charge=0,!Ur.leaf)for(var fa,Ma=Ur.nodes,Kn=Ma.length,xa=-1;++xa<Kn;)(fa=Ma[xa])!=null&&(ua(fa,kn,Xn),Ur.charge+=fa.charge,Gn+=fa.charge*fa.cx,ea+=fa.charge*fa.cy);if(Ur.point){Ur.leaf||(Ur.point.x+=Math.random()-.5,Ur.point.y+=Math.random()-.5);var ma=kn*Xn[Ur.point.index];Ur.charge+=Ur.pointCharge=ma,Gn+=ma*Ur.point.x,ea+=ma*Ur.point.y}Ur.cx=Gn/Ur.charge,Ur.cy=ea/Ur.charge}(jt=t.geom.quadtree(At),R,ne),rr=-1;++rr<Un;)(hr=At[rr]).fixed||jt.visit(Ft(hr));for(rr=-1;++rr<Un;)(hr=At[rr]).fixed?(hr.x=hr.px,hr.y=hr.py):(hr.x-=(hr.px-(hr.px=hr.x))*Te,hr.y-=(hr.py-(hr.py=hr.y))*Te);pe.tick({type:"tick",alpha:R})},le.nodes=function(jt){return arguments.length?(At=jt,le):At},le.links=function(jt){return arguments.length?(yt=jt,le):yt},le.size=function(jt){return arguments.length?(ye=jt,le):ye},le.linkDistance=function(jt){return arguments.length?(Ne=typeof jt=="function"?jt:+jt,le):Ne},le.distance=le.linkDistance,le.linkStrength=function(jt){return arguments.length?(Ge=typeof jt=="function"?jt:+jt,le):Ge},le.friction=function(jt){return arguments.length?(Te=+jt,le):Te},le.charge=function(jt){return arguments.length?(nt=typeof jt=="function"?jt:+jt,le):nt},le.chargeDistance=function(jt){return arguments.length?(bt=jt*jt,le):Math.sqrt(bt)},le.gravity=function(jt){return arguments.length?(Ct=+jt,le):Ct},le.theta=function(jt){return arguments.length?(Tt=jt*jt,le):Math.sqrt(Tt)},le.alpha=function(jt){return arguments.length?(jt=+jt,R?jt>0?R=jt:(oe.c=null,oe.t=NaN,oe=null,pe.end({type:"end",alpha:R=0})):jt>0&&(pe.start({type:"start",alpha:R=jt}),oe=Nr(le.tick)),le):R},le.start=function(){var jt,rr,hr,Ar=At.length,kr=yt.length,Kr=ye[0],Zr=ye[1];for(jt=0;jt<Ar;++jt)(hr=At[jt]).index=jt,hr.weight=0;for(jt=0;jt<kr;++jt)typeof(hr=yt[jt]).source=="number"&&(hr.source=At[hr.source]),typeof hr.target=="number"&&(hr.target=At[hr.target]),++hr.source.weight,++hr.target.weight;for(jt=0;jt<Ar;++jt)hr=At[jt],isNaN(hr.x)&&(hr.x=hn("x",Kr)),isNaN(hr.y)&&(hr.y=hn("y",Zr)),isNaN(hr.px)&&(hr.px=hr.x),isNaN(hr.py)&&(hr.py=hr.y);if(F=[],typeof Ne=="function")for(jt=0;jt<kr;++jt)F[jt]=+Ne.call(this,yt[jt],jt);else for(jt=0;jt<kr;++jt)F[jt]=Ne;if(V=[],typeof Ge=="function")for(jt=0;jt<kr;++jt)V[jt]=+Ge.call(this,yt[jt],jt);else for(jt=0;jt<kr;++jt)V[jt]=Ge;if(ne=[],typeof nt=="function")for(jt=0;jt<Ar;++jt)ne[jt]=+nt.call(this,At[jt],jt);else for(jt=0;jt<Ar;++jt)ne[jt]=nt;function hn(sn,Un){if(!rr){for(rr=new Array(Ar),kn=0;kn<Ar;++kn)rr[kn]=[];for(kn=0;kn<kr;++kn){var Wn=yt[kn];rr[Wn.source.index].push(Wn.target),rr[Wn.target.index].push(Wn.source)}}for(var ua,Ur=rr[jt],kn=-1,Xn=Ur.length;++kn<Xn;)if(!isNaN(ua=Ur[kn][sn]))return ua;return Math.random()*Un}return le.resume()},le.resume=function(){return le.alpha(.1)},le.stop=function(){return le.alpha(0)},le.drag=function(){if(C||(C=t.behavior.drag().origin(D).on("dragstart.force",Ve).on("drag.force",zt).on("dragend.force",$e)),!arguments.length)return C;this.on("mouseover.force",ot).on("mouseout.force",mt).call(C)},t.rebind(le,pe,"on")};var dt=20,Et=1,Zt=1/0;function $t(oe,C){return t.rebind(oe,C,"sort","children","value"),oe.nodes=oe,oe.links=Or,oe}function Yt(oe,C){for(var R=[oe];(oe=R.pop())!=null;)if(C(oe),(V=oe.children)&&(F=V.length))for(var F,V;--F>=0;)R.push(V[F])}function nr(oe,C){for(var R=[oe],F=[];(oe=R.pop())!=null;)if(F.push(oe),(ne=oe.children)&&(V=ne.length))for(var V,ne,le=-1;++le<V;)R.push(ne[le]);for(;(oe=F.pop())!=null;)C(oe)}function cr(oe){return oe.children}function mr(oe){return oe.value}function yr(oe,C){return C.value-oe.value}function Or(oe){return t.merge(oe.map(function(C){return(C.children||[]).map(function(R){return{source:C,target:R}})}))}t.layout.hierarchy=function(){var oe=yr,C=cr,R=mr;function F(V){var ne,le=[V],pe=[];for(V.depth=0;(ne=le.pop())!=null;)if(pe.push(ne),(Te=C.call(F,ne,ne.depth))&&(ye=Te.length)){for(var ye,Te,Ne;--ye>=0;)le.push(Ne=Te[ye]),Ne.parent=ne,Ne.depth=ne.depth+1;R&&(ne.value=0),ne.children=Te}else R&&(ne.value=+R.call(F,ne,ne.depth)||0),delete ne.children;return nr(V,function(Ge){var nt,bt;oe&&(nt=Ge.children)&&nt.sort(oe),R&&(bt=Ge.parent)&&(bt.value+=Ge.value)}),pe}return F.sort=function(V){return arguments.length?(oe=V,F):oe},F.children=function(V){return arguments.length?(C=V,F):C},F.value=function(V){return arguments.length?(R=V,F):R},F.revalue=function(V){return R&&(Yt(V,function(ne){ne.children&&(ne.value=0)}),nr(V,function(ne){var le;ne.children||(ne.value=+R.call(F,ne,ne.depth)||0),(le=ne.parent)&&(le.value+=ne.value)})),V},F},t.layout.partition=function(){var oe=t.layout.hierarchy(),C=[1,1];function R(F,V){var ne=oe.call(this,F,V);return function le(pe,ye,Te,Ne){var Ge=pe.children;if(pe.x=ye,pe.y=pe.depth*Ne,pe.dx=Te,pe.dy=Ne,Ge&&(nt=Ge.length)){var nt,bt,Ct,Tt=-1;for(Te=pe.value?Te/pe.value:0;++Tt<nt;)le(bt=Ge[Tt],ye,Ct=bt.value*Te,Ne),ye+=Ct}}(ne[0],0,C[0],C[1]/function le(pe){var ye=pe.children,Te=0;if(ye&&(Ne=ye.length))for(var Ne,Ge=-1;++Ge<Ne;)Te=Math.max(Te,le(ye[Ge]));return 1+Te}(ne[0])),ne}return R.size=function(F){return arguments.length?(C=F,R):C},$t(R,oe)},t.layout.pie=function(){var oe=Number,C=nn,R=0,F=tr,V=0;function ne(le){var pe,ye=le.length,Te=le.map(function(Ft,zt){return+oe.call(ne,Ft,zt)}),Ne=+(typeof R=="function"?R.apply(this,arguments):R),Ge=(typeof F=="function"?F.apply(this,arguments):F)-Ne,nt=Math.min(Math.abs(Ge)/ye,+(typeof V=="function"?V.apply(this,arguments):V)),bt=nt*(Ge<0?-1:1),Ct=t.sum(Te),Tt=Ct?(Ge-ye*bt)/Ct:0,At=t.range(ye),yt=[];return C!=null&&At.sort(C===nn?function(Ft,zt){return Te[zt]-Te[Ft]}:function(Ft,zt){return C(le[Ft],le[zt])}),At.forEach(function(Ft){yt[Ft]={data:le[Ft],value:pe=Te[Ft],startAngle:Ne,endAngle:Ne+=pe*Tt+bt,padAngle:nt}}),yt}return ne.value=function(le){return arguments.length?(oe=le,ne):oe},ne.sort=function(le){return arguments.length?(C=le,ne):C},ne.startAngle=function(le){return arguments.length?(R=le,ne):R},ne.endAngle=function(le){return arguments.length?(F=le,ne):F},ne.padAngle=function(le){return arguments.length?(V=le,ne):V},ne};var nn={};function gn(oe){return oe.x}function Cn(oe){return oe.y}function Dn(oe,C,R){oe.y0=C,oe.y=R}t.layout.stack=function(){var oe=D,C=ga,R=ka,F=Dn,V=gn,ne=Cn;function le(pe,ye){if(!(nt=pe.length))return pe;var Te=pe.map(function(Ft,zt){return oe.call(le,Ft,zt)}),Ne=Te.map(function(Ft){return Ft.map(function(zt,jt){return[V.call(le,zt,jt),ne.call(le,zt,jt)]})}),Ge=C.call(le,Ne,ye);Te=t.permute(Te,Ge),Ne=t.permute(Ne,Ge);var nt,bt,Ct,Tt,At=R.call(le,Ne,ye),yt=Te[0].length;for(Ct=0;Ct<yt;++Ct)for(F.call(le,Te[0][Ct],Tt=At[Ct],Ne[0][Ct][1]),bt=1;bt<nt;++bt)F.call(le,Te[bt][Ct],Tt+=Ne[bt-1][Ct][1],Ne[bt][Ct][1]);return pe}return le.values=function(pe){return arguments.length?(oe=pe,le):oe},le.order=function(pe){return arguments.length?(C=typeof pe=="function"?pe:Hn.get(pe)||ga,le):C},le.offset=function(pe){return arguments.length?(R=typeof pe=="function"?pe:zn.get(pe)||ka,le):R},le.x=function(pe){return arguments.length?(V=pe,le):V},le.y=function(pe){return arguments.length?(ne=pe,le):ne},le.out=function(pe){return arguments.length?(F=pe,le):F},le};var Hn=t.map({"inside-out":function(oe){var C,R,F=oe.length,V=oe.map(Ba),ne=oe.map(Fa),le=t.range(F).sort(function(Ge,nt){return V[Ge]-V[nt]}),pe=0,ye=0,Te=[],Ne=[];for(C=0;C<F;++C)R=le[C],pe<ye?(pe+=ne[R],Te.push(R)):(ye+=ne[R],Ne.push(R));return Ne.reverse().concat(Te)},reverse:function(oe){return t.range(oe.length).reverse()},default:ga}),zn=t.map({silhouette:function(oe){var C,R,F,V=oe.length,ne=oe[0].length,le=[],pe=0,ye=[];for(R=0;R<ne;++R){for(C=0,F=0;C<V;C++)F+=oe[C][R][1];F>pe&&(pe=F),le.push(F)}for(R=0;R<ne;++R)ye[R]=(pe-le[R])/2;return ye},wiggle:function(oe){var C,R,F,V,ne,le,pe,ye,Te,Ne=oe.length,Ge=oe[0],nt=Ge.length,bt=[];for(bt[0]=ye=Te=0,R=1;R<nt;++R){for(C=0,V=0;C<Ne;++C)V+=oe[C][R][1];for(C=0,ne=0,pe=Ge[R][0]-Ge[R-1][0];C<Ne;++C){for(F=0,le=(oe[C][R][1]-oe[C][R-1][1])/(2*pe);F<C;++F)le+=(oe[F][R][1]-oe[F][R-1][1])/pe;ne+=le*oe[C][R][1]}bt[R]=ye-=V?ne/V*pe:0,ye<Te&&(Te=ye)}for(R=0;R<nt;++R)bt[R]-=Te;return bt},expand:function(oe){var C,R,F,V=oe.length,ne=oe[0].length,le=1/V,pe=[];for(R=0;R<ne;++R){for(C=0,F=0;C<V;C++)F+=oe[C][R][1];if(F)for(C=0;C<V;C++)oe[C][R][1]/=F;else for(C=0;C<V;C++)oe[C][R][1]=le}for(R=0;R<ne;++R)pe[R]=0;return pe},zero:ka});function ga(oe){return t.range(oe.length)}function ka(oe){for(var C=-1,R=oe[0].length,F=[];++C<R;)F[C]=0;return F}function Ba(oe){for(var C,R=1,F=0,V=oe[0][1],ne=oe.length;R<ne;++R)(C=oe[R][1])>V&&(F=R,V=C);return F}function Fa(oe){return oe.reduce(ja,0)}function ja(oe,C){return oe+C[1]}function Si(oe,C){return Ti(oe,Math.ceil(Math.log(C.length)/Math.LN2+1))}function Ti(oe,C){for(var R=-1,F=+oe[0],V=(oe[1]-F)/C,ne=[];++R<=C;)ne[R]=V*R+F;return ne}function ui(oe){return[t.min(oe),t.max(oe)]}function ci(oe,C){return oe.value-C.value}function ki(oe,C){var R=oe._pack_next;oe._pack_next=C,C._pack_prev=oe,C._pack_next=R,R._pack_prev=C}function Hi(oe,C){oe._pack_next=C,C._pack_prev=oe}function no(oe,C){var R=C.x-oe.x,F=C.y-oe.y,V=oe.r+C.r;return .999*V*V>R*R+F*F}function ao(oe){if((C=oe.children)&&(ye=C.length)){var C,R,F,V,ne,le,pe,ye,Te=1/0,Ne=-1/0,Ge=1/0,nt=-1/0;if(C.forEach(io),(R=C[0]).x=-R.r,R.y=0,zt(R),ye>1&&((F=C[1]).x=F.r,F.y=0,zt(F),ye>2))for(Oa(R,F,V=C[2]),zt(V),ki(R,V),R._pack_prev=V,ki(V,F),F=R._pack_next,ne=3;ne<ye;ne++){Oa(R,F,V=C[ne]);var bt=0,Ct=1,Tt=1;for(le=F._pack_next;le!==F;le=le._pack_next,Ct++)if(no(le,V)){bt=1;break}if(bt==1)for(pe=R._pack_prev;pe!==le._pack_prev&&!no(pe,V);pe=pe._pack_prev,Tt++);bt?(Ct<Tt||Ct==Tt&&F.r<R.r?Hi(R,F=le):Hi(R=pe,F),ne--):(ki(R,V),F=V,zt(V))}var At=(Te+Ne)/2,yt=(Ge+nt)/2,Ft=0;for(ne=0;ne<ye;ne++)(V=C[ne]).x-=At,V.y-=yt,Ft=Math.max(Ft,V.r+Math.sqrt(V.x*V.x+V.y*V.y));oe.r=Ft,C.forEach(oo)}function zt(jt){Te=Math.min(jt.x-jt.r,Te),Ne=Math.max(jt.x+jt.r,Ne),Ge=Math.min(jt.y-jt.r,Ge),nt=Math.max(jt.y+jt.r,nt)}}function io(oe){oe._pack_next=oe._pack_prev=oe}function oo(oe){delete oe._pack_next,delete oe._pack_prev}function Oa(oe,C,R){var F=oe.r+R.r,V=C.x-oe.x,ne=C.y-oe.y;if(F&&(V||ne)){var le=C.r+R.r,pe=V*V+ne*ne,ye=.5+((F*=F)-(le*=le))/(2*pe),Te=Math.sqrt(Math.max(0,2*le*(F+pe)-(F-=pe)*F-le*le))/(2*pe);R.x=oe.x+ye*V+Te*ne,R.y=oe.y+ye*ne-Te*V}else R.x=oe.x+F,R.y=oe.y}function ft(oe,C){return oe.parent==C.parent?1:2}function Rt(oe){var C=oe.children;return C.length?C[0]:oe.t}function sr(oe){var C,R=oe.children;return(C=R.length)?R[C-1]:oe.t}function Vt(oe,C,R){var F=R/(C.i-oe.i);C.c-=F,C.s+=R,oe.c+=F,C.z+=R,C.m+=R}function lr(oe,C,R){return oe.a.parent===C.parent?oe.a:R}function Lr(oe){return{x:oe.x,y:oe.y,dx:oe.dx,dy:oe.dy}}function zr(oe,C){var R=oe.x+C[3],F=oe.y+C[0],V=oe.dx-C[1]-C[3],ne=oe.dy-C[0]-C[2];return V<0&&(R+=V/2,V=0),ne<0&&(F+=ne/2,ne=0),{x:R,y:F,dx:V,dy:ne}}function Yr(oe){var C=oe[0],R=oe[oe.length-1];return C<R?[C,R]:[R,C]}function ln(oe){return oe.rangeExtent?oe.rangeExtent():Yr(oe.range())}function on(oe,C,R,F){var V=R(oe[0],oe[1]),ne=F(C[0],C[1]);return function(le){return ne(V(le))}}function mn(oe,C){var R,F=0,V=oe.length-1,ne=oe[F],le=oe[V];return le<ne&&(R=F,F=V,V=R,R=ne,ne=le,le=R),oe[F]=C.floor(ne),oe[V]=C.ceil(le),oe}function wn(oe){return oe?{floor:function(C){return Math.floor(C/oe)*oe},ceil:function(C){return Math.ceil(C/oe)*oe}}:un}t.layout.histogram=function(){var oe=!0,C=Number,R=ui,F=Si;function V(ne,le){for(var pe,ye,Te=[],Ne=ne.map(C,this),Ge=R.call(this,Ne,le),nt=F.call(this,Ge,Ne,le),bt=(le=-1,Ne.length),Ct=nt.length-1,Tt=oe?1:1/bt;++le<Ct;)(pe=Te[le]=[]).dx=nt[le+1]-(pe.x=nt[le]),pe.y=0;if(Ct>0)for(le=-1;++le<bt;)(ye=Ne[le])>=Ge[0]&&ye<=Ge[1]&&((pe=Te[t.bisect(nt,ye,1,Ct)-1]).y+=Tt,pe.push(ne[le]));return Te}return V.value=function(ne){return arguments.length?(C=ne,V):C},V.range=function(ne){return arguments.length?(R=_r(ne),V):R},V.bins=function(ne){return arguments.length?(F=typeof ne=="number"?function(le){return Ti(le,ne)}:_r(ne),V):F},V.frequency=function(ne){return arguments.length?(oe=!!ne,V):oe},V},t.layout.pack=function(){var oe,C=t.layout.hierarchy().sort(ci),R=0,F=[1,1];function V(ne,le){var pe=C.call(this,ne,le),ye=pe[0],Te=F[0],Ne=F[1],Ge=oe==null?Math.sqrt:typeof oe=="function"?oe:function(){return oe};if(ye.x=ye.y=0,nr(ye,function(bt){bt.r=+Ge(bt.value)}),nr(ye,ao),R){var nt=R*(oe?1:Math.max(2*ye.r/Te,2*ye.r/Ne))/2;nr(ye,function(bt){bt.r+=nt}),nr(ye,ao),nr(ye,function(bt){bt.r-=nt})}return function bt(Ct,Tt,At,yt){var Ft=Ct.children;if(Ct.x=Tt+=yt*Ct.x,Ct.y=At+=yt*Ct.y,Ct.r*=yt,Ft)for(var zt=-1,jt=Ft.length;++zt<jt;)bt(Ft[zt],Tt,At,yt)}(ye,Te/2,Ne/2,oe?1:1/Math.max(2*ye.r/Te,2*ye.r/Ne)),pe}return V.size=function(ne){return arguments.length?(F=ne,V):F},V.radius=function(ne){return arguments.length?(oe=ne==null||typeof ne=="function"?ne:+ne,V):oe},V.padding=function(ne){return arguments.length?(R=+ne,V):R},$t(V,C)},t.layout.tree=function(){var oe=t.layout.hierarchy().sort(null).value(null),C=ft,R=[1,1],F=null;function V(ye,Te){var Ne=oe.call(this,ye,Te),Ge=Ne[0],nt=function(zt){for(var jt,rr={A:null,children:[zt]},hr=[rr];(jt=hr.pop())!=null;)for(var Ar,kr=jt.children,Kr=0,Zr=kr.length;Kr<Zr;++Kr)hr.push((kr[Kr]=Ar={_:kr[Kr],parent:jt,children:(Ar=kr[Kr].children)&&Ar.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:Kr}).a=Ar);return rr.children[0]}(Ge);if(nr(nt,ne),nt.parent.m=-nt.z,Yt(nt,le),F)Yt(Ge,pe);else{var bt=Ge,Ct=Ge,Tt=Ge;Yt(Ge,function(zt){zt.x<bt.x&&(bt=zt),zt.x>Ct.x&&(Ct=zt),zt.depth>Tt.depth&&(Tt=zt)});var At=C(bt,Ct)/2-bt.x,yt=R[0]/(Ct.x+C(Ct,bt)/2+At),Ft=R[1]/(Tt.depth||1);Yt(Ge,function(zt){zt.x=(zt.x+At)*yt,zt.y=zt.depth*Ft})}return Ne}function ne(ye){var Te=ye.children,Ne=ye.parent.children,Ge=ye.i?Ne[ye.i-1]:null;if(Te.length){(function(bt){for(var Ct,Tt=0,At=0,yt=bt.children,Ft=yt.length;--Ft>=0;)(Ct=yt[Ft]).z+=Tt,Ct.m+=Tt,Tt+=Ct.s+(At+=Ct.c)})(ye);var nt=(Te[0].z+Te[Te.length-1].z)/2;Ge?(ye.z=Ge.z+C(ye._,Ge._),ye.m=ye.z-nt):ye.z=nt}else Ge&&(ye.z=Ge.z+C(ye._,Ge._));ye.parent.A=function(bt,Ct,Tt){if(Ct){for(var At,yt=bt,Ft=bt,zt=Ct,jt=yt.parent.children[0],rr=yt.m,hr=Ft.m,Ar=zt.m,kr=jt.m;zt=sr(zt),yt=Rt(yt),zt&&yt;)jt=Rt(jt),(Ft=sr(Ft)).a=bt,(At=zt.z+Ar-yt.z-rr+C(zt._,yt._))>0&&(Vt(lr(zt,bt,Tt),bt,At),rr+=At,hr+=At),Ar+=zt.m,rr+=yt.m,kr+=jt.m,hr+=Ft.m;zt&&!sr(Ft)&&(Ft.t=zt,Ft.m+=Ar-hr),yt&&!Rt(jt)&&(jt.t=yt,jt.m+=rr-kr,Tt=bt)}return Tt}(ye,Ge,ye.parent.A||Ne[0])}function le(ye){ye._.x=ye.z+ye.parent.m,ye.m+=ye.parent.m}function pe(ye){ye.x*=R[0],ye.y=ye.depth*R[1]}return V.separation=function(ye){return arguments.length?(C=ye,V):C},V.size=function(ye){return arguments.length?(F=(R=ye)==null?pe:null,V):F?null:R},V.nodeSize=function(ye){return arguments.length?(F=(R=ye)==null?null:pe,V):F?R:null},$t(V,oe)},t.layout.cluster=function(){var oe=t.layout.hierarchy().sort(null).value(null),C=ft,R=[1,1],F=!1;function V(ne,le){var pe,ye=oe.call(this,ne,le),Te=ye[0],Ne=0;nr(Te,function(Tt){var At=Tt.children;At&&At.length?(Tt.x=function(yt){return yt.reduce(function(Ft,zt){return Ft+zt.x},0)/yt.length}(At),Tt.y=function(yt){return 1+t.max(yt,function(Ft){return Ft.y})}(At)):(Tt.x=pe?Ne+=C(Tt,pe):0,Tt.y=0,pe=Tt)});var Ge=function Tt(At){var yt=At.children;return yt&&yt.length?Tt(yt[0]):At}(Te),nt=function Tt(At){var yt,Ft=At.children;return Ft&&(yt=Ft.length)?Tt(Ft[yt-1]):At}(Te),bt=Ge.x-C(Ge,nt)/2,Ct=nt.x+C(nt,Ge)/2;return nr(Te,F?function(Tt){Tt.x=(Tt.x-Te.x)*R[0],Tt.y=(Te.y-Tt.y)*R[1]}:function(Tt){Tt.x=(Tt.x-bt)/(Ct-bt)*R[0],Tt.y=(1-(Te.y?Tt.y/Te.y:1))*R[1]}),ye}return V.separation=function(ne){return arguments.length?(C=ne,V):C},V.size=function(ne){return arguments.length?(F=(R=ne)==null,V):F?null:R},V.nodeSize=function(ne){return arguments.length?(F=(R=ne)!=null,V):F?R:null},$t(V,oe)},t.layout.treemap=function(){var oe,C=t.layout.hierarchy(),R=Math.round,F=[1,1],V=null,ne=Lr,le=!1,pe="squarify",ye=.5*(1+Math.sqrt(5));function Te(Tt,At){for(var yt,Ft,zt=-1,jt=Tt.length;++zt<jt;)Ft=(yt=Tt[zt]).value*(At<0?0:At),yt.area=isNaN(Ft)||Ft<=0?0:Ft}function Ne(Tt){var At=Tt.children;if(At&&At.length){var yt,Ft,zt,jt=ne(Tt),rr=[],hr=At.slice(),Ar=1/0,kr=pe==="slice"?jt.dx:pe==="dice"?jt.dy:pe==="slice-dice"?1&Tt.depth?jt.dy:jt.dx:Math.min(jt.dx,jt.dy);for(Te(hr,jt.dx*jt.dy/Tt.value),rr.area=0;(zt=hr.length)>0;)rr.push(yt=hr[zt-1]),rr.area+=yt.area,pe!=="squarify"||(Ft=nt(rr,kr))<=Ar?(hr.pop(),Ar=Ft):(rr.area-=rr.pop().area,bt(rr,kr,jt,!1),kr=Math.min(jt.dx,jt.dy),rr.length=rr.area=0,Ar=1/0);rr.length&&(bt(rr,kr,jt,!0),rr.length=rr.area=0),At.forEach(Ne)}}function Ge(Tt){var At=Tt.children;if(At&&At.length){var yt,Ft=ne(Tt),zt=At.slice(),jt=[];for(Te(zt,Ft.dx*Ft.dy/Tt.value),jt.area=0;yt=zt.pop();)jt.push(yt),jt.area+=yt.area,yt.z!=null&&(bt(jt,yt.z?Ft.dx:Ft.dy,Ft,!zt.length),jt.length=jt.area=0);At.forEach(Ge)}}function nt(Tt,At){for(var yt,Ft=Tt.area,zt=0,jt=1/0,rr=-1,hr=Tt.length;++rr<hr;)(yt=Tt[rr].area)&&(yt<jt&&(jt=yt),yt>zt&&(zt=yt));return At*=At,(Ft*=Ft)?Math.max(At*zt*ye/Ft,Ft/(At*jt*ye)):1/0}function bt(Tt,At,yt,Ft){var zt,jt=-1,rr=Tt.length,hr=yt.x,Ar=yt.y,kr=At?R(Tt.area/At):0;if(At==yt.dx){for((Ft||kr>yt.dy)&&(kr=yt.dy);++jt<rr;)(zt=Tt[jt]).x=hr,zt.y=Ar,zt.dy=kr,hr+=zt.dx=Math.min(yt.x+yt.dx-hr,kr?R(zt.area/kr):0);zt.z=!0,zt.dx+=yt.x+yt.dx-hr,yt.y+=kr,yt.dy-=kr}else{for((Ft||kr>yt.dx)&&(kr=yt.dx);++jt<rr;)(zt=Tt[jt]).x=hr,zt.y=Ar,zt.dx=kr,Ar+=zt.dy=Math.min(yt.y+yt.dy-Ar,kr?R(zt.area/kr):0);zt.z=!1,zt.dy+=yt.y+yt.dy-Ar,yt.x+=kr,yt.dx-=kr}}function Ct(Tt){var At=oe||C(Tt),yt=At[0];return yt.x=yt.y=0,yt.value?(yt.dx=F[0],yt.dy=F[1]):yt.dx=yt.dy=0,oe&&C.revalue(yt),Te([yt],yt.dx*yt.dy/yt.value),(oe?Ge:Ne)(yt),le&&(oe=At),At}return Ct.size=function(Tt){return arguments.length?(F=Tt,Ct):F},Ct.padding=function(Tt){if(!arguments.length)return V;function At(zt){var jt=Tt.call(Ct,zt,zt.depth);return jt==null?Lr(zt):zr(zt,typeof jt=="number"?[jt,jt,jt,jt]:jt)}function yt(zt){return zr(zt,Tt)}var Ft;return ne=(V=Tt)==null?Lr:(Ft=typeof Tt)=="function"?At:(Ft==="number"&&(Tt=[Tt,Tt,Tt,Tt]),yt),Ct},Ct.round=function(Tt){return arguments.length?(R=Tt?Math.round:Number,Ct):R!=Number},Ct.sticky=function(Tt){return arguments.length?(le=Tt,oe=null,Ct):le},Ct.ratio=function(Tt){return arguments.length?(ye=Tt,Ct):ye},Ct.mode=function(Tt){return arguments.length?(pe=Tt+"",Ct):pe},$t(Ct,C)},t.random={normal:function(oe,C){var R=arguments.length;return R<2&&(C=1),R<1&&(oe=0),function(){var F,V,ne;do ne=(F=2*Math.random()-1)*F+(V=2*Math.random()-1)*V;while(!ne||ne>1);return oe+C*F*Math.sqrt(-2*Math.log(ne)/ne)}},logNormal:function(){var oe=t.random.normal.apply(t,arguments);return function(){return Math.exp(oe())}},bates:function(oe){var C=t.random.irwinHall(oe);return function(){return C()/oe}},irwinHall:function(oe){return function(){for(var C=0,R=0;R<oe;R++)C+=Math.random();return C}}},t.scale={};var un={floor:D,ceil:D};function Tn(oe,C,R,F){var V=[],ne=[],le=0,pe=Math.min(oe.length,C.length)-1;for(oe[pe]<oe[0]&&(oe=oe.slice().reverse(),C=C.slice().reverse());++le<=pe;)V.push(R(oe[le-1],oe[le])),ne.push(F(C[le-1],C[le]));return function(ye){var Te=t.bisect(oe,ye,1,pe)-1;return ne[Te](V[Te](ye))}}function Rn(oe,C){return t.rebind(oe,C,"range","rangeRound","interpolate","clamp")}function Vn(oe,C){return mn(oe,wn(ta(oe,C)[2])),mn(oe,wn(ta(oe,C)[2])),oe}function ta(oe,C){C==null&&(C=10);var R=Yr(oe),F=R[1]-R[0],V=Math.pow(10,Math.floor(Math.log(F/C)/Math.LN10)),ne=C/F*V;return ne<=.15?V*=10:ne<=.35?V*=5:ne<=.75&&(V*=2),R[0]=Math.ceil(R[0]/V)*V,R[1]=Math.floor(R[1]/V)*V+.5*V,R[2]=V,R}function Xr(oe,C){return t.range.apply(t,ta(oe,C))}t.scale.linear=function(){return function oe(C,R,F,V){var ne,le;function pe(){var Te=Math.min(C.length,R.length)>2?Tn:on,Ne=V?Ho:zs;return ne=Te(C,R,Ne,F),le=Te(R,C,Ne,Vi),ye}function ye(Te){return ne(Te)}return ye.invert=function(Te){return le(Te)},ye.domain=function(Te){return arguments.length?(C=Te.map(Number),pe()):C},ye.range=function(Te){return arguments.length?(R=Te,pe()):R},ye.rangeRound=function(Te){return ye.range(Te).interpolate(rs)},ye.clamp=function(Te){return arguments.length?(V=Te,pe()):V},ye.interpolate=function(Te){return arguments.length?(F=Te,pe()):F},ye.ticks=function(Te){return Xr(C,Te)},ye.tickFormat=function(Te,Ne){return d3_scale_linearTickFormat(C,Te,Ne)},ye.nice=function(Te){return Vn(C,Te),pe()},ye.copy=function(){return oe(C,R,F,V)},pe()}([0,1],[0,1],Vi,!1)},t.scale.log=function(){return function oe(C,R,F,V){function ne(ye){return(F?Math.log(ye<0?0:ye):-Math.log(ye>0?0:-ye))/Math.log(R)}function le(ye){return F?Math.pow(R,ye):-Math.pow(R,-ye)}function pe(ye){return C(ne(ye))}return pe.invert=function(ye){return le(C.invert(ye))},pe.domain=function(ye){return arguments.length?(F=ye[0]>=0,C.domain((V=ye.map(Number)).map(ne)),pe):V},pe.base=function(ye){return arguments.length?(R=+ye,C.domain(V.map(ne)),pe):R},pe.nice=function(){var ye=mn(V.map(ne),F?Math:$n);return C.domain(ye),V=ye.map(le),pe},pe.ticks=function(){var ye=Yr(V),Te=[],Ne=ye[0],Ge=ye[1],nt=Math.floor(ne(Ne)),bt=Math.ceil(ne(Ge)),Ct=R%1?2:R;if(isFinite(bt-nt)){if(F){for(;nt<bt;nt++)for(var Tt=1;Tt<Ct;Tt++)Te.push(le(nt)*Tt);Te.push(le(nt))}else for(Te.push(le(nt));nt++<bt;)for(Tt=Ct-1;Tt>0;Tt--)Te.push(le(nt)*Tt);for(nt=0;Te[nt]<Ne;nt++);for(bt=Te.length;Te[bt-1]>Ge;bt--);Te=Te.slice(nt,bt)}return Te},pe.copy=function(){return oe(C.copy(),R,F,V)},Rn(pe,C)}(t.scale.linear().domain([0,1]),10,!0,[1,10])};var $n={floor:function(oe){return-Math.ceil(-oe)},ceil:function(oe){return-Math.floor(-oe)}};function Ln(oe){return function(C){return C<0?-Math.pow(-C,oe):Math.pow(C,oe)}}t.scale.pow=function(){return function oe(C,R,F){var V=Ln(R),ne=Ln(1/R);function le(pe){return C(V(pe))}return le.invert=function(pe){return ne(C.invert(pe))},le.domain=function(pe){return arguments.length?(C.domain((F=pe.map(Number)).map(V)),le):F},le.ticks=function(pe){return Xr(F,pe)},le.tickFormat=function(pe,ye){return d3_scale_linearTickFormat(F,pe,ye)},le.nice=function(pe){return le.domain(Vn(F,pe))},le.exponent=function(pe){return arguments.length?(V=Ln(R=pe),ne=Ln(1/R),C.domain(F.map(V)),le):R},le.copy=function(){return oe(C.copy(),R,F)},Rn(le,C)}(t.scale.linear(),1,[0,1])},t.scale.sqrt=function(){return t.scale.pow().exponent(.5)},t.scale.ordinal=function(){return function oe(C,R){var F,V,ne;function le(ye){return V[((F.get(ye)||(R.t==="range"?F.set(ye,C.push(ye)):NaN))-1)%V.length]}function pe(ye,Te){return t.range(C.length).map(function(Ne){return ye+Te*Ne})}return le.domain=function(ye){if(!arguments.length)return C;C=[],F=new T;for(var Te,Ne=-1,Ge=ye.length;++Ne<Ge;)F.has(Te=ye[Ne])||F.set(Te,C.push(Te));return le[R.t].apply(le,R.a)},le.range=function(ye){return arguments.length?(V=ye,ne=0,R={t:"range",a:arguments},le):V},le.rangePoints=function(ye,Te){arguments.length<2&&(Te=0);var Ne=ye[0],Ge=ye[1],nt=C.length<2?(Ne=(Ne+Ge)/2,0):(Ge-Ne)/(C.length-1+Te);return V=pe(Ne+nt*Te/2,nt),ne=0,R={t:"rangePoints",a:arguments},le},le.rangeRoundPoints=function(ye,Te){arguments.length<2&&(Te=0);var Ne=ye[0],Ge=ye[1],nt=C.length<2?(Ne=Ge=Math.round((Ne+Ge)/2),0):(Ge-Ne)/(C.length-1+Te)|0;return V=pe(Ne+Math.round(nt*Te/2+(Ge-Ne-(C.length-1+Te)*nt)/2),nt),ne=0,R={t:"rangeRoundPoints",a:arguments},le},le.rangeBands=function(ye,Te,Ne){arguments.length<2&&(Te=0),arguments.length<3&&(Ne=Te);var Ge=ye[1]<ye[0],nt=ye[Ge-0],bt=ye[1-Ge],Ct=(bt-nt)/(C.length-Te+2*Ne);return V=pe(nt+Ct*Ne,Ct),Ge&&V.reverse(),ne=Ct*(1-Te),R={t:"rangeBands",a:arguments},le},le.rangeRoundBands=function(ye,Te,Ne){arguments.length<2&&(Te=0),arguments.length<3&&(Ne=Te);var Ge=ye[1]<ye[0],nt=ye[Ge-0],bt=ye[1-Ge],Ct=Math.floor((bt-nt)/(C.length-Te+2*Ne));return V=pe(nt+Math.round((bt-nt-(C.length-Te)*Ct)/2),Ct),Ge&&V.reverse(),ne=Math.round(Ct*(1-Te)),R={t:"rangeRoundBands",a:arguments},le},le.rangeBand=function(){return ne},le.rangeExtent=function(){return Yr(R.a[0])},le.copy=function(){return oe(C,R)},le.domain(C)}([],{t:"range",a:[[]]})},t.scale.category10=function(){return t.scale.ordinal().range(jn)},t.scale.category20=function(){return t.scale.ordinal().range(Jn)},t.scale.category20b=function(){return t.scale.ordinal().range(Ta)},t.scale.category20c=function(){return t.scale.ordinal().range(Ca)};var jn=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Xt),Jn=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Xt),Ta=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Xt),Ca=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Xt);function Mn(){return 0}t.scale.quantile=function(){return function oe(C,R){var F;function V(){var le=0,pe=R.length;for(F=[];++le<pe;)F[le-1]=t.quantile(C,le/pe);return ne}function ne(le){if(!isNaN(le=+le))return R[t.bisect(F,le)]}return ne.domain=function(le){return arguments.length?(C=le.map(n).filter(a).sort(c),V()):C},ne.range=function(le){return arguments.length?(R=le,V()):R},ne.quantiles=function(){return F},ne.invertExtent=function(le){return(le=R.indexOf(le))<0?[NaN,NaN]:[le>0?F[le-1]:C[0],le<F.length?F[le]:C[C.length-1]]},ne.copy=function(){return oe(C,R)},V()}([],[])},t.scale.quantize=function(){return function oe(C,R,F){var V,ne;function le(ye){return F[Math.max(0,Math.min(ne,Math.floor(V*(ye-C))))]}function pe(){return V=F.length/(R-C),ne=F.length-1,le}return le.domain=function(ye){return arguments.length?(C=+ye[0],R=+ye[ye.length-1],pe()):[C,R]},le.range=function(ye){return arguments.length?(F=ye,pe()):F},le.invertExtent=function(ye){return[ye=(ye=F.indexOf(ye))<0?NaN:ye/V+C,ye+1/V]},le.copy=function(){return oe(C,R,F)},pe()}(0,1,[0,1])},t.scale.threshold=function(){return function oe(C,R){function F(V){if(V<=V)return R[t.bisect(C,V)]}return F.domain=function(V){return arguments.length?(C=V,F):C},F.range=function(V){return arguments.length?(R=V,F):R},F.invertExtent=function(V){return V=R.indexOf(V),[C[V-1],C[V]]},F.copy=function(){return oe(C,R)},F}([.5],[0,1])},t.scale.identity=function(){return function oe(C){function R(F){return+F}return R.invert=R,R.domain=R.range=function(F){return arguments.length?(C=F.map(R),R):C},R.ticks=function(F){return Xr(C,F)},R.tickFormat=function(F,V){return d3_scale_linearTickFormat(C,F,V)},R.copy=function(){return oe(C)},R}([0,1])},t.svg={},t.svg.arc=function(){var oe=Sa,C=da,R=Mn,F=Da,V=za,ne=Aa,le=ti;function pe(){var Te=Math.max(0,+oe.apply(this,arguments)),Ne=Math.max(0,+C.apply(this,arguments)),Ge=V.apply(this,arguments)-He,nt=ne.apply(this,arguments)-He,bt=Math.abs(nt-Ge),Ct=Ge>nt?0:1;if(Ne<Te&&(Tt=Ne,Ne=Te,Te=Tt),bt>=Ue)return ye(Ne,Ct)+(Te?ye(Te,1-Ct):"")+"Z";var Tt,At,yt,Ft,zt,jt,rr,hr,Ar,kr,Kr,Zr,hn=0,sn=0,Un=[];if((Ft=(+le.apply(this,arguments)||0)/2)&&(yt=F===Da?Math.sqrt(Te*Te+Ne*Ne):+F.apply(this,arguments),Ct||(sn*=-1),Ne&&(sn=_e(yt/Ne*Math.sin(Ft))),Te&&(hn=_e(yt/Te*Math.sin(Ft)))),Ne){zt=Ne*Math.cos(Ge+sn),jt=Ne*Math.sin(Ge+sn),rr=Ne*Math.cos(nt-sn),hr=Ne*Math.sin(nt-sn);var Wn=Math.abs(nt-Ge-2*sn)<=er?0:1;if(sn&&Qn(zt,jt,rr,hr)===Ct^Wn){var ua=(Ge+nt)/2;zt=Ne*Math.cos(ua),jt=Ne*Math.sin(ua),rr=hr=null}}else zt=jt=0;if(Te){Ar=Te*Math.cos(nt-hn),kr=Te*Math.sin(nt-hn),Kr=Te*Math.cos(Ge+hn),Zr=Te*Math.sin(Ge+hn);var Ur=Math.abs(Ge-nt+2*hn)<=er?0:1;if(hn&&Qn(Ar,kr,Kr,Zr)===1-Ct^Ur){var kn=(Ge+nt)/2;Ar=Te*Math.cos(kn),kr=Te*Math.sin(kn),Kr=Zr=null}}else Ar=kr=0;if(bt>_t&&(Tt=Math.min(Math.abs(Ne-Te)/2,+R.apply(this,arguments)))>.001){At=Te<Ne^Ct?0:1;var Xn=Tt,Gn=Tt;if(bt<er){var ea=Kr==null?[Ar,kr]:rr==null?[zt,jt]:It([zt,jt],[Kr,Zr],[rr,hr],[Ar,kr]),fa=zt-ea[0],Ma=jt-ea[1],Kn=rr-ea[0],xa=hr-ea[1],ma=1/Math.sin(Math.acos((fa*Kn+Ma*xa)/(Math.sqrt(fa*fa+Ma*Ma)*Math.sqrt(Kn*Kn+xa*xa)))/2),La=Math.sqrt(ea[0]*ea[0]+ea[1]*ea[1]);Gn=Math.min(Tt,(Te-La)/(ma-1)),Xn=Math.min(Tt,(Ne-La)/(ma+1))}if(rr!=null){var ba=Za(Kr==null?[Ar,kr]:[Kr,Zr],[zt,jt],Ne,Xn,Ct),Pa=Za([rr,hr],[Ar,kr],Ne,Xn,Ct);Tt===Xn?Un.push("M",ba[0],"A",Xn,",",Xn," 0 0,",At," ",ba[1],"A",Ne,",",Ne," 0 ",1-Ct^Qn(ba[1][0],ba[1][1],Pa[1][0],Pa[1][1]),",",Ct," ",Pa[1],"A",Xn,",",Xn," 0 0,",At," ",Pa[0]):Un.push("M",ba[0],"A",Xn,",",Xn," 0 1,",At," ",Pa[0])}else Un.push("M",zt,",",jt);if(Kr!=null){var Ua=Za([zt,jt],[Kr,Zr],Te,-Gn,Ct),di=Za([Ar,kr],rr==null?[zt,jt]:[rr,hr],Te,-Gn,Ct);Tt===Gn?Un.push("L",di[0],"A",Gn,",",Gn," 0 0,",At," ",di[1],"A",Te,",",Te," 0 ",Ct^Qn(di[1][0],di[1][1],Ua[1][0],Ua[1][1]),",",1-Ct," ",Ua[1],"A",Gn,",",Gn," 0 0,",At," ",Ua[0]):Un.push("L",di[0],"A",Gn,",",Gn," 0 0,",At," ",Ua[0])}else Un.push("L",Ar,",",kr)}else Un.push("M",zt,",",jt),rr!=null&&Un.push("A",Ne,",",Ne," 0 ",Wn,",",Ct," ",rr,",",hr),Un.push("L",Ar,",",kr),Kr!=null&&Un.push("A",Te,",",Te," 0 ",Ur,",",1-Ct," ",Kr,",",Zr);return Un.push("Z"),Un.join("")}function ye(Te,Ne){return"M0,"+Te+"A"+Te+","+Te+" 0 1,"+Ne+" 0,"+-Te+"A"+Te+","+Te+" 0 1,"+Ne+" 0,"+Te}return pe.innerRadius=function(Te){return arguments.length?(oe=_r(Te),pe):oe},pe.outerRadius=function(Te){return arguments.length?(C=_r(Te),pe):C},pe.cornerRadius=function(Te){return arguments.length?(R=_r(Te),pe):R},pe.padRadius=function(Te){return arguments.length?(F=Te==Da?Da:_r(Te),pe):F},pe.startAngle=function(Te){return arguments.length?(V=_r(Te),pe):V},pe.endAngle=function(Te){return arguments.length?(ne=_r(Te),pe):ne},pe.padAngle=function(Te){return arguments.length?(le=_r(Te),pe):le},pe.centroid=function(){var Te=(+oe.apply(this,arguments)+ +C.apply(this,arguments))/2,Ne=(+V.apply(this,arguments)+ +ne.apply(this,arguments))/2-He;return[Math.cos(Ne)*Te,Math.sin(Ne)*Te]},pe};var Da="auto";function Sa(oe){return oe.innerRadius}function da(oe){return oe.outerRadius}function za(oe){return oe.startAngle}function Aa(oe){return oe.endAngle}function ti(oe){return oe&&oe.padAngle}function Qn(oe,C,R,F){return(oe-R)*C-(C-F)*oe>0?0:1}function Za(oe,C,R,F,V){var ne=oe[0]-C[0],le=oe[1]-C[1],pe=(V?F:-F)/Math.sqrt(ne*ne+le*le),ye=pe*le,Te=-pe*ne,Ne=oe[0]+ye,Ge=oe[1]+Te,nt=C[0]+ye,bt=C[1]+Te,Ct=(Ne+nt)/2,Tt=(Ge+bt)/2,At=nt-Ne,yt=bt-Ge,Ft=At*At+yt*yt,zt=R-F,jt=Ne*bt-nt*Ge,rr=(yt<0?-1:1)*Math.sqrt(Math.max(0,zt*zt*Ft-jt*jt)),hr=(jt*yt-At*rr)/Ft,Ar=(-jt*At-yt*rr)/Ft,kr=(jt*yt+At*rr)/Ft,Kr=(-jt*At+yt*rr)/Ft,Zr=hr-Ct,hn=Ar-Tt,sn=kr-Ct,Un=Kr-Tt;return Zr*Zr+hn*hn>sn*sn+Un*Un&&(hr=kr,Ar=Kr),[[hr-ye,Ar-Te],[hr*R/zt,Ar*R/zt]]}function Gi(){return!0}function cs(oe){var C=Qr,R=rn,F=Gi,V=Eo,ne=V.key,le=.7;function pe(ye){var Te,Ne=[],Ge=[],nt=-1,bt=ye.length,Ct=_r(C),Tt=_r(R);function At(){Ne.push("M",V(oe(Ge),le))}for(;++nt<bt;)F.call(this,Te=ye[nt],nt)?Ge.push([+Ct.call(this,Te,nt),+Tt.call(this,Te,nt)]):Ge.length&&(At(),Ge=[]);return Ge.length&&At(),Ne.length?Ne.join(""):null}return pe.x=function(ye){return arguments.length?(C=ye,pe):C},pe.y=function(ye){return arguments.length?(R=ye,pe):R},pe.defined=function(ye){return arguments.length?(F=ye,pe):F},pe.interpolate=function(ye){return arguments.length?(ne=typeof ye=="function"?V=ye:(V=Xo.get(ye)||Eo).key,pe):ne},pe.tension=function(ye){return arguments.length?(le=ye,pe):le},pe}t.svg.line=function(){return cs(D)};var Xo=t.map({linear:Eo,"linear-closed":va,step:function(oe){for(var C=0,R=oe.length,F=oe[0],V=[F[0],",",F[1]];++C<R;)V.push("H",(F[0]+(F=oe[C])[0])/2,"V",F[1]);return R>1&&V.push("H",F[0]),V.join("")},"step-before":xi,"step-after":Co,basis:Zi,"basis-open":function(oe){if(oe.length<4)return Eo(oe);for(var C,R=[],F=-1,V=oe.length,ne=[0],le=[0];++F<3;)C=oe[F],ne.push(C[0]),le.push(C[1]);for(R.push(ai(so,ne)+","+ai(so,le)),--F;++F<V;)C=oe[F],ne.shift(),ne.push(C[0]),le.shift(),le.push(C[1]),Ms(R,ne,le);return R.join("")},"basis-closed":function(oe){for(var C,R,F=-1,V=oe.length,ne=V+4,le=[],pe=[];++F<4;)R=oe[F%V],le.push(R[0]),pe.push(R[1]);for(C=[ai(so,le),",",ai(so,pe)],--F;++F<ne;)R=oe[F%V],le.shift(),le.push(R[0]),pe.shift(),pe.push(R[1]),Ms(C,le,pe);return C.join("")},bundle:function(oe,C){var R=oe.length-1;if(R)for(var F,V,ne=oe[0][0],le=oe[0][1],pe=oe[R][0]-ne,ye=oe[R][1]-le,Te=-1;++Te<=R;)F=oe[Te],V=Te/R,F[0]=C*F[0]+(1-C)*(ne+V*pe),F[1]=C*F[1]+(1-C)*(le+V*ye);return Zi(oe)},cardinal:function(oe,C){return oe.length<3?Eo(oe):oe[0]+Ka(oe,Ei(oe,C))},"cardinal-open":function(oe,C){return oe.length<4?Eo(oe):oe[1]+Ka(oe.slice(1,-1),Ei(oe,C))},"cardinal-closed":function(oe,C){return oe.length<3?va(oe):oe[0]+Ka((oe.push(oe[0]),oe),Ei([oe[oe.length-2]].concat(oe,[oe[1]]),C))},monotone:function(oe){return oe.length<3?Eo(oe):oe[0]+Ka(oe,function(C){for(var R,F,V,ne,le=[],pe=function(Ne){for(var Ge=0,nt=Ne.length-1,bt=[],Ct=Ne[0],Tt=Ne[1],At=bt[0]=ys(Ct,Tt);++Ge<nt;)bt[Ge]=(At+(At=ys(Ct=Tt,Tt=Ne[Ge+1])))/2;return bt[Ge]=At,bt}(C),ye=-1,Te=C.length-1;++ye<Te;)R=ys(C[ye],C[ye+1]),v(R)<_t?pe[ye]=pe[ye+1]=0:(F=pe[ye]/R,V=pe[ye+1]/R,(ne=F*F+V*V)>9&&(ne=3*R/Math.sqrt(ne),pe[ye]=ne*F,pe[ye+1]=ne*V));for(ye=-1;++ye<=Te;)ne=(C[Math.min(Te,ye+1)][0]-C[Math.max(0,ye-1)][0])/(6*(1+pe[ye]*pe[ye])),le.push([ne||0,pe[ye]*ne||0]);return le}(oe))}});function Eo(oe){return oe.length>1?oe.join("L"):oe+"Z"}function va(oe){return oe.join("L")+"Z"}function xi(oe){for(var C=0,R=oe.length,F=oe[0],V=[F[0],",",F[1]];++C<R;)V.push("V",(F=oe[C])[1],"H",F[0]);return V.join("")}function Co(oe){for(var C=0,R=oe.length,F=oe[0],V=[F[0],",",F[1]];++C<R;)V.push("H",(F=oe[C])[0],"V",F[1]);return V.join("")}function Ka(oe,C){if(C.length<1||oe.length!=C.length&&oe.length!=C.length+2)return Eo(oe);var R=oe.length!=C.length,F="",V=oe[0],ne=oe[1],le=C[0],pe=le,ye=1;if(R&&(F+="Q"+(ne[0]-2*le[0]/3)+","+(ne[1]-2*le[1]/3)+","+ne[0]+","+ne[1],V=oe[1],ye=2),C.length>1){pe=C[1],ne=oe[ye],ye++,F+="C"+(V[0]+le[0])+","+(V[1]+le[1])+","+(ne[0]-pe[0])+","+(ne[1]-pe[1])+","+ne[0]+","+ne[1];for(var Te=2;Te<C.length;Te++,ye++)ne=oe[ye],pe=C[Te],F+="S"+(ne[0]-pe[0])+","+(ne[1]-pe[1])+","+ne[0]+","+ne[1]}if(R){var Ne=oe[ye];F+="Q"+(ne[0]+2*pe[0]/3)+","+(ne[1]+2*pe[1]/3)+","+Ne[0]+","+Ne[1]}return F}function Ei(oe,C){for(var R,F=[],V=(1-C)/2,ne=oe[0],le=oe[1],pe=1,ye=oe.length;++pe<ye;)R=ne,ne=le,le=oe[pe],F.push([V*(le[0]-R[0]),V*(le[1]-R[1])]);return F}function Zi(oe){if(oe.length<3)return Eo(oe);var C=1,R=oe.length,F=oe[0],V=F[0],ne=F[1],le=[V,V,V,(F=oe[1])[0]],pe=[ne,ne,ne,F[1]],ye=[V,",",ne,"L",ai(so,le),",",ai(so,pe)];for(oe.push(oe[R-1]);++C<=R;)F=oe[C],le.shift(),le.push(F[0]),pe.shift(),pe.push(F[1]),Ms(ye,le,pe);return oe.pop(),ye.push("L",F),ye.join("")}function ai(oe,C){return oe[0]*C[0]+oe[1]*C[1]+oe[2]*C[2]+oe[3]*C[3]}Xo.forEach(function(oe,C){C.key=oe,C.closed=/-closed$/.test(oe)});var yo=[0,2/3,1/3,0],ii=[0,1/3,2/3,0],so=[0,1/6,2/3,1/6];function Ms(oe,C,R){oe.push("C",ai(yo,C),",",ai(yo,R),",",ai(ii,C),",",ai(ii,R),",",ai(so,C),",",ai(so,R))}function ys(oe,C){return(C[1]-oe[1])/(C[0]-oe[0])}function pl(oe){for(var C,R,F,V=-1,ne=oe.length;++V<ne;)R=(C=oe[V])[0],F=C[1]-He,C[0]=R*Math.cos(F),C[1]=R*Math.sin(F);return oe}function Ni(oe){var C=Qr,R=Qr,F=0,V=rn,ne=Gi,le=Eo,pe=le.key,ye=le,Te="L",Ne=.7;function Ge(nt){var bt,Ct,Tt,At=[],yt=[],Ft=[],zt=-1,jt=nt.length,rr=_r(C),hr=_r(F),Ar=C===R?function(){return Ct}:_r(R),kr=F===V?function(){return Tt}:_r(V);function Kr(){At.push("M",le(oe(Ft),Ne),Te,ye(oe(yt.reverse()),Ne),"Z")}for(;++zt<jt;)ne.call(this,bt=nt[zt],zt)?(yt.push([Ct=+rr.call(this,bt,zt),Tt=+hr.call(this,bt,zt)]),Ft.push([+Ar.call(this,bt,zt),+kr.call(this,bt,zt)])):yt.length&&(Kr(),yt=[],Ft=[]);return yt.length&&Kr(),At.length?At.join(""):null}return Ge.x=function(nt){return arguments.length?(C=R=nt,Ge):R},Ge.x0=function(nt){return arguments.length?(C=nt,Ge):C},Ge.x1=function(nt){return arguments.length?(R=nt,Ge):R},Ge.y=function(nt){return arguments.length?(F=V=nt,Ge):V},Ge.y0=function(nt){return arguments.length?(F=nt,Ge):F},Ge.y1=function(nt){return arguments.length?(V=nt,Ge):V},Ge.defined=function(nt){return arguments.length?(ne=nt,Ge):ne},Ge.interpolate=function(nt){return arguments.length?(pe=typeof nt=="function"?le=nt:(le=Xo.get(nt)||Eo).key,ye=le.reverse||le,Te=le.closed?"M":"L",Ge):pe},Ge.tension=function(nt){return arguments.length?(Ne=nt,Ge):Ne},Ge}function dl(oe){return oe.source}function ji(oe){return oe.target}function xs(oe){return oe.radius}function la(oe){return[oe.x,oe.y]}function ya(oe){return function(){var C=oe.apply(this,arguments),R=C[0],F=C[1]-He;return[R*Math.cos(F),R*Math.sin(F)]}}function ml(){return 64}function vl(){return"circle"}function bs(oe){var C=Math.sqrt(oe/er);return"M0,"+C+"A"+C+","+C+" 0 1,1 0,"+-C+"A"+C+","+C+" 0 1,1 0,"+C+"Z"}t.svg.line.radial=function(){var oe=cs(pl);return oe.radius=oe.x,delete oe.x,oe.angle=oe.y,delete oe.y,oe},xi.reverse=Co,Co.reverse=xi,t.svg.area=function(){return Ni(D)},t.svg.area.radial=function(){var oe=Ni(pl);return oe.radius=oe.x,delete oe.x,oe.innerRadius=oe.x0,delete oe.x0,oe.outerRadius=oe.x1,delete oe.x1,oe.angle=oe.y,delete oe.y,oe.startAngle=oe.y0,delete oe.y0,oe.endAngle=oe.y1,delete oe.y1,oe},t.svg.chord=function(){var oe=dl,C=ji,R=xs,F=za,V=Aa;function ne(Te,Ne){var Ge,nt,bt=le(this,oe,Te,Ne),Ct=le(this,C,Te,Ne);return"M"+bt.p0+pe(bt.r,bt.p1,bt.a1-bt.a0)+(nt=Ct,((Ge=bt).a0==nt.a0&&Ge.a1==nt.a1?ye(bt.r,bt.p1,bt.r,bt.p0):ye(bt.r,bt.p1,Ct.r,Ct.p0)+pe(Ct.r,Ct.p1,Ct.a1-Ct.a0)+ye(Ct.r,Ct.p1,bt.r,bt.p0))+"Z")}function le(Te,Ne,Ge,nt){var bt=Ne.call(Te,Ge,nt),Ct=R.call(Te,bt,nt),Tt=F.call(Te,bt,nt)-He,At=V.call(Te,bt,nt)-He;return{r:Ct,a0:Tt,a1:At,p0:[Ct*Math.cos(Tt),Ct*Math.sin(Tt)],p1:[Ct*Math.cos(At),Ct*Math.sin(At)]}}function pe(Te,Ne,Ge){return"A"+Te+","+Te+" 0 "+ +(Ge>er)+",1 "+Ne}function ye(Te,Ne,Ge,nt){return"Q 0,0 "+nt}return ne.radius=function(Te){return arguments.length?(R=_r(Te),ne):R},ne.source=function(Te){return arguments.length?(oe=_r(Te),ne):oe},ne.target=function(Te){return arguments.length?(C=_r(Te),ne):C},ne.startAngle=function(Te){return arguments.length?(F=_r(Te),ne):F},ne.endAngle=function(Te){return arguments.length?(V=_r(Te),ne):V},ne},t.svg.diagonal=function(){var oe=dl,C=ji,R=la;function F(V,ne){var le=oe.call(this,V,ne),pe=C.call(this,V,ne),ye=(le.y+pe.y)/2,Te=[le,{x:le.x,y:ye},{x:pe.x,y:ye},pe];return"M"+(Te=Te.map(R))[0]+"C"+Te[1]+" "+Te[2]+" "+Te[3]}return F.source=function(V){return arguments.length?(oe=_r(V),F):oe},F.target=function(V){return arguments.length?(C=_r(V),F):C},F.projection=function(V){return arguments.length?(R=V,F):R},F},t.svg.diagonal.radial=function(){var oe=t.svg.diagonal(),C=la,R=oe.projection;return oe.projection=function(F){return arguments.length?R(ya(C=F)):C},oe},t.svg.symbol=function(){var oe=vl,C=ml;function R(F,V){return(Go.get(oe.call(this,F,V))||bs)(C.call(this,F,V))}return R.type=function(F){return arguments.length?(oe=_r(F),R):oe},R.size=function(F){return arguments.length?(C=_r(F),R):C},R};var Go=t.map({circle:bs,cross:function(oe){var C=Math.sqrt(oe/5)/2;return"M"+-3*C+","+-C+"H"+-C+"V"+-3*C+"H"+C+"V"+-C+"H"+3*C+"V"+C+"H"+C+"V"+3*C+"H"+-C+"V"+C+"H"+-3*C+"Z"},diamond:function(oe){var C=Math.sqrt(oe/(2*Il)),R=C*Il;return"M0,"+-C+"L"+R+",0 0,"+C+" "+-R+",0Z"},square:function(oe){var C=Math.sqrt(oe)/2;return"M"+-C+","+-C+"L"+C+","+-C+" "+C+","+C+" "+-C+","+C+"Z"},"triangle-down":function(oe){var C=Math.sqrt(oe/is),R=C*is/2;return"M0,"+R+"L"+C+","+-R+" "+-C+","+-R+"Z"},"triangle-up":function(oe){var C=Math.sqrt(oe/is),R=C*is/2;return"M0,"+-R+"L"+C+","+R+" "+-C+","+R+"Z"}});t.svg.symbolTypes=Go.keys();var is=Math.sqrt(3),Il=Math.tan(30*Be);te.transition=function(oe){for(var C,R,F=Rs||++Fs,V=el(oe),ne=[],le=Ss||{time:Date.now(),ease:Hs,delay:0,duration:250},pe=-1,ye=this.length;++pe<ye;){ne.push(C=[]);for(var Te=this[pe],Ne=-1,Ge=Te.length;++Ne<Ge;)(R=Te[Ne])&&Es(R,Ne,V,F,le),C.push(R)}return oi(ne,V,F)},te.interrupt=function(oe){return this.each(oe==null?$s:Ja(el(oe)))};var $s=Ja(el());function Ja(oe){return function(){var C,R,F;(C=this[oe])&&(F=C[R=C.active])&&(F.timer.c=null,F.timer.t=NaN,--C.count?delete C[R]:delete this[oe],C.active+=.5,F.event&&F.event.interrupt.call(this,this.__data__,F.index))}}function oi(oe,C,R){return j(oe,zi),oe.namespace=C,oe.id=R,oe}var Rs,Ss,zi=[],Fs=0;function Qs(oe,C,R,F){var V=oe.id,ne=oe.namespace;return Fe(oe,typeof R=="function"?function(le,pe,ye){le[ne][V].tween.set(C,F(R.call(le,le.__data__,pe,ye)))}:(R=F(R),function(le){le[ne][V].tween.set(C,R)}))}function Gs(oe){return oe==null&&(oe=""),function(){this.textContent=oe}}function el(oe){return oe==null?"__transition__":"__transition_"+oe+"__"}function Es(oe,C,R,F,V){var ne,le,pe,ye,Te,Ne=oe[R]||(oe[R]={active:0,count:0}),Ge=Ne[F];function nt(Ct){var Tt=Ne.active,At=Ne[Tt];for(var yt in At&&(At.timer.c=null,At.timer.t=NaN,--Ne.count,delete Ne[Tt],At.event&&At.event.interrupt.call(oe,oe.__data__,At.index)),Ne)if(+yt<F){var Ft=Ne[yt];Ft.timer.c=null,Ft.timer.t=NaN,--Ne.count,delete Ne[yt]}le.c=bt,Nr(function(){return le.c&&bt(Ct||1)&&(le.c=null,le.t=NaN),1},0,ne),Ne.active=F,Ge.event&&Ge.event.start.call(oe,oe.__data__,C),Te=[],Ge.tween.forEach(function(zt,jt){(jt=jt.call(oe,oe.__data__,C))&&Te.push(jt)}),ye=Ge.ease,pe=Ge.duration}function bt(Ct){for(var Tt=Ct/pe,At=ye(Tt),yt=Te.length;yt>0;)Te[--yt].call(oe,At);if(Tt>=1)return Ge.event&&Ge.event.end.call(oe,oe.__data__,C),--Ne.count?delete Ne[F]:delete oe[R],1}Ge||(ne=V.time,le=Nr(function(Ct){var Tt=Ge.delay;if(le.t=Tt+ne,Tt<=Ct)return nt(Ct-Tt);le.c=nt},0,ne),Ge=Ne[F]={tween:new T,time:ne,timer:le,delay:V.delay,duration:V.duration,ease:V.ease,index:C},V=null,++Ne.count)}zi.call=te.call,zi.empty=te.empty,zi.node=te.node,zi.size=te.size,t.transition=function(oe,C){return oe&&oe.transition?Rs?oe.transition(C):oe:t.selection().transition(oe)},t.transition.prototype=zi,zi.select=function(oe){var C,R,F,V=this.id,ne=this.namespace,le=[];oe=ie(oe);for(var pe=-1,ye=this.length;++pe<ye;){le.push(C=[]);for(var Te=this[pe],Ne=-1,Ge=Te.length;++Ne<Ge;)(F=Te[Ne])&&(R=oe.call(F,F.__data__,Ne,pe))?("__data__"in F&&(R.__data__=F.__data__),Es(R,Ne,ne,V,F[ne][V]),C.push(R)):C.push(null)}return oi(le,ne,V)},zi.selectAll=function(oe){var C,R,F,V,ne,le=this.id,pe=this.namespace,ye=[];oe=ae(oe);for(var Te=-1,Ne=this.length;++Te<Ne;)for(var Ge=this[Te],nt=-1,bt=Ge.length;++nt<bt;)if(F=Ge[nt]){ne=F[pe][le],R=oe.call(F,F.__data__,nt,Te),ye.push(C=[]);for(var Ct=-1,Tt=R.length;++Ct<Tt;)(V=R[Ct])&&Es(V,Ct,pe,le,ne),C.push(V)}return oi(ye,pe,le)},zi.filter=function(oe){var C,R,F=[];typeof oe!="function"&&(oe=Se(oe));for(var V=0,ne=this.length;V<ne;V++){F.push(C=[]);for(var le,pe=0,ye=(le=this[V]).length;pe<ye;pe++)(R=le[pe])&&oe.call(R,R.__data__,pe,V)&&C.push(R)}return oi(F,this.namespace,this.id)},zi.tween=function(oe,C){var R=this.id,F=this.namespace;return arguments.length<2?this.node()[F][R].tween.get(oe):Fe(this,C==null?function(V){V[F][R].tween.remove(oe)}:function(V){V[F][R].tween.set(oe,C)})},zi.attr=function(oe,C){if(arguments.length<2){for(C in oe)this.attr(C,oe[C]);return this}var R=oe=="transform"?as:Vi,F=t.ns.qualify(oe);function V(){this.removeAttribute(F)}function ne(){this.removeAttributeNS(F.space,F.local)}function le(ye){return ye==null?V:(ye+="",function(){var Te,Ne=this.getAttribute(F);return Ne!==ye&&(Te=R(Ne,ye),function(Ge){this.setAttribute(F,Te(Ge))})})}function pe(ye){return ye==null?ne:(ye+="",function(){var Te,Ne=this.getAttributeNS(F.space,F.local);return Ne!==ye&&(Te=R(Ne,ye),function(Ge){this.setAttributeNS(F.space,F.local,Te(Ge))})})}return Qs(this,"attr."+oe,C,F.local?pe:le)},zi.attrTween=function(oe,C){var R=t.ns.qualify(oe);return this.tween("attr."+oe,R.local?function(F,V){var ne=C.call(this,F,V,this.getAttributeNS(R.space,R.local));return ne&&function(le){this.setAttributeNS(R.space,R.local,ne(le))}}:function(F,V){var ne=C.call(this,F,V,this.getAttribute(R));return ne&&function(le){this.setAttribute(R,ne(le))}})},zi.style=function(oe,C,R){var F=arguments.length;if(F<3){if(typeof oe!="string"){for(R in F<2&&(C=""),oe)this.style(R,oe[R],C);return this}R=""}function V(){this.style.removeProperty(oe)}function ne(le){return le==null?V:(le+="",function(){var pe,ye=f(this).getComputedStyle(this,null).getPropertyValue(oe);return ye!==le&&(pe=Vi(ye,le),function(Te){this.style.setProperty(oe,pe(Te),R)})})}return Qs(this,"style."+oe,C,ne)},zi.styleTween=function(oe,C,R){function F(V,ne){var le=C.call(this,V,ne,f(this).getComputedStyle(this,null).getPropertyValue(oe));return le&&function(pe){this.style.setProperty(oe,le(pe),R)}}return arguments.length<3&&(R=""),this.tween("style."+oe,F)},zi.text=function(oe){return Qs(this,"text",oe,Gs)},zi.remove=function(){var oe=this.namespace;return this.each("end.transition",function(){var C;this[oe].count<2&&(C=this.parentNode)&&C.removeChild(this)})},zi.ease=function(oe){var C=this.id,R=this.namespace;return arguments.length<1?this.node()[R][C].ease:(typeof oe!="function"&&(oe=t.ease.apply(t,arguments)),Fe(this,function(F){F[R][C].ease=oe}))},zi.delay=function(oe){var C=this.id,R=this.namespace;return arguments.length<1?this.node()[R][C].delay:Fe(this,typeof oe=="function"?function(F,V,ne){F[R][C].delay=+oe.call(F,F.__data__,V,ne)}:(oe=+oe,function(F){F[R][C].delay=oe}))},zi.duration=function(oe){var C=this.id,R=this.namespace;return arguments.length<1?this.node()[R][C].duration:Fe(this,typeof oe=="function"?function(F,V,ne){F[R][C].duration=Math.max(1,oe.call(F,F.__data__,V,ne))}:(oe=Math.max(1,oe),function(F){F[R][C].duration=oe}))},zi.each=function(oe,C){var R=this.id,F=this.namespace;if(arguments.length<2){var V=Ss,ne=Rs;try{Rs=R,Fe(this,function(le,pe,ye){Ss=le[F][R],oe.call(le,le.__data__,pe,ye)})}finally{Ss=V,Rs=ne}}else Fe(this,function(le){var pe=le[F][R];(pe.event||(pe.event=t.dispatch("start","end","interrupt"))).on(oe,C)});return this},zi.transition=function(){for(var oe,C,R,F=this.id,V=++Fs,ne=this.namespace,le=[],pe=0,ye=this.length;pe<ye;pe++){le.push(oe=[]);for(var Te,Ne=0,Ge=(Te=this[pe]).length;Ne<Ge;Ne++)(C=Te[Ne])&&Es(C,Ne,ne,V,{time:(R=C[ne][F]).time,ease:R.ease,delay:R.delay+R.duration,duration:R.duration}),oe.push(C)}return oi(le,ne,V)},t.svg.axis=function(){var oe,C=t.scale.linear(),R=Ol,F=6,V=6,ne=3,le=[10],pe=null;function ye(Te){Te.each(function(){var Ne,Ge=t.select(this),nt=this.__chart__||C,bt=this.__chart__=C.copy(),Ct=pe==null?bt.ticks?bt.ticks.apply(bt,le):bt.domain():pe,Tt=oe==null?bt.tickFormat?bt.tickFormat.apply(bt,le):D:oe,At=Ge.selectAll(".tick").data(Ct,bt),yt=At.enter().insert("g",".domain").attr("class","tick").style("opacity",_t),Ft=t.transition(At.exit()).style("opacity",_t).remove(),zt=t.transition(At.order()).style("opacity",1),jt=Math.max(F,0)+ne,rr=ln(bt),hr=Ge.selectAll(".domain").data([0]),Ar=(hr.enter().append("path").attr("class","domain"),t.transition(hr));yt.append("line"),yt.append("text");var kr,Kr,Zr,hn,sn=yt.select("line"),Un=zt.select("line"),Wn=At.select("text").text(Tt),ua=yt.select("text"),Ur=zt.select("text"),kn=R==="top"||R==="left"?-1:1;if(R==="bottom"||R==="top"?(Ne=Bs,kr="x",Zr="y",Kr="x2",hn="y2",Wn.attr("dy",kn<0?"0em":".71em").style("text-anchor","middle"),Ar.attr("d","M"+rr[0]+","+kn*V+"V0H"+rr[1]+"V"+kn*V)):(Ne=Dl,kr="y",Zr="x",Kr="y2",hn="x2",Wn.attr("dy",".32em").style("text-anchor",kn<0?"end":"start"),Ar.attr("d","M"+kn*V+","+rr[0]+"H0V"+rr[1]+"H"+kn*V)),sn.attr(hn,kn*F),ua.attr(Zr,kn*jt),Un.attr(Kr,0).attr(hn,kn*F),Ur.attr(kr,0).attr(Zr,kn*jt),bt.rangeBand){var Xn=bt,Gn=Xn.rangeBand()/2;nt=bt=function(ea){return Xn(ea)+Gn}}else nt.rangeBand?nt=bt:Ft.call(Ne,bt,nt);yt.call(Ne,nt,bt),zt.call(Ne,bt,bt)})}return ye.scale=function(Te){return arguments.length?(C=Te,ye):C},ye.orient=function(Te){return arguments.length?(R=Te in Xl?Te+"":Ol,ye):R},ye.ticks=function(){return arguments.length?(le=m(arguments),ye):le},ye.tickValues=function(Te){return arguments.length?(pe=Te,ye):pe},ye.tickFormat=function(Te){return arguments.length?(oe=Te,ye):oe},ye.tickSize=function(Te){var Ne=arguments.length;return Ne?(F=+Te,V=+arguments[Ne-1],ye):F},ye.innerTickSize=function(Te){return arguments.length?(F=+Te,ye):F},ye.outerTickSize=function(Te){return arguments.length?(V=+Te,ye):V},ye.tickPadding=function(Te){return arguments.length?(ne=+Te,ye):ne},ye.tickSubdivide=function(){return arguments.length&&ye},ye};var Ol="bottom",Xl={top:1,right:1,bottom:1,left:1};function Bs(oe,C,R){oe.attr("transform",function(F){var V=C(F);return"translate("+(isFinite(V)?V:R(F))+",0)"})}function Dl(oe,C,R){oe.attr("transform",function(F){var V=C(F);return"translate(0,"+(isFinite(V)?V:R(F))+")"})}t.svg.brush=function(){var oe,C,R=$(Ne,"brushstart","brush","brushend"),F=null,V=null,ne=[0,0],le=[0,0],pe=!0,ye=!0,Te=lo[0];function Ne(Tt){Tt.each(function(){var At=t.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",Ct).on("touchstart.brush",Ct),yt=At.selectAll(".background").data([0]);yt.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),At.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var Ft=At.selectAll(".resize").data(Te,D);Ft.exit().remove(),Ft.enter().append("g").attr("class",function(hr){return"resize "+hr}).style("cursor",function(hr){return tl[hr]}).append("rect").attr("x",function(hr){return/[ew]$/.test(hr)?-3:null}).attr("y",function(hr){return/^[ns]/.test(hr)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),Ft.style("display",Ne.empty()?"none":null);var zt,jt=t.transition(At),rr=t.transition(yt);F&&(zt=ln(F),rr.attr("x",zt[0]).attr("width",zt[1]-zt[0]),nt(jt)),V&&(zt=ln(V),rr.attr("y",zt[0]).attr("height",zt[1]-zt[0]),bt(jt)),Ge(jt)})}function Ge(Tt){Tt.selectAll(".resize").attr("transform",function(At){return"translate("+ne[+/e$/.test(At)]+","+le[+/^s/.test(At)]+")"})}function nt(Tt){Tt.select(".extent").attr("x",ne[0]),Tt.selectAll(".extent,.n>rect,.s>rect").attr("width",ne[1]-ne[0])}function bt(Tt){Tt.select(".extent").attr("y",le[0]),Tt.selectAll(".extent,.e>rect,.w>rect").attr("height",le[1]-le[0])}function Ct(){var Tt,At,yt=this,Ft=t.select(t.event.target),zt=R.of(yt,arguments),jt=t.select(yt),rr=Ft.datum(),hr=!/^(n|s)$/.test(rr)&&F,Ar=!/^(e|w)$/.test(rr)&&V,kr=Ft.classed("extent"),Kr=Pt(yt),Zr=t.mouse(yt),hn=t.select(f(yt)).on("keydown.brush",Wn).on("keyup.brush",ua);if(t.event.changedTouches?hn.on("touchmove.brush",Ur).on("touchend.brush",Xn):hn.on("mousemove.brush",Ur).on("mouseup.brush",Xn),jt.interrupt().selectAll("*").interrupt(),kr)Zr[0]=ne[0]-Zr[0],Zr[1]=le[0]-Zr[1];else if(rr){var sn=+/w$/.test(rr),Un=+/^n/.test(rr);At=[ne[1-sn]-Zr[0],le[1-Un]-Zr[1]],Zr[0]=ne[sn],Zr[1]=le[Un]}else t.event.altKey&&(Tt=Zr.slice());function Wn(){t.event.keyCode==32&&(kr||(Tt=null,Zr[0]-=ne[1],Zr[1]-=le[1],kr=2),H())}function ua(){t.event.keyCode==32&&kr==2&&(Zr[0]+=ne[1],Zr[1]+=le[1],kr=0,H())}function Ur(){var Gn=t.mouse(yt),ea=!1;At&&(Gn[0]+=At[0],Gn[1]+=At[1]),kr||(t.event.altKey?(Tt||(Tt=[(ne[0]+ne[1])/2,(le[0]+le[1])/2]),Zr[0]=ne[+(Gn[0]<Tt[0])],Zr[1]=le[+(Gn[1]<Tt[1])]):Tt=null),hr&&kn(Gn,F,0)&&(nt(jt),ea=!0),Ar&&kn(Gn,V,1)&&(bt(jt),ea=!0),ea&&(Ge(jt),zt({type:"brush",mode:kr?"move":"resize"}))}function kn(Gn,ea,fa){var Ma,Kn,xa=ln(ea),ma=xa[0],La=xa[1],ba=Zr[fa],Pa=fa?le:ne,Ua=Pa[1]-Pa[0];if(kr&&(ma-=ba,La-=Ua+ba),Ma=(fa?ye:pe)?Math.max(ma,Math.min(La,Gn[fa])):Gn[fa],kr?Kn=(Ma+=ba)+Ua:(Tt&&(ba=Math.max(ma,Math.min(La,2*Tt[fa]-Ma))),ba<Ma?(Kn=Ma,Ma=ba):Kn=ba),Pa[0]!=Ma||Pa[1]!=Kn)return fa?C=null:oe=null,Pa[0]=Ma,Pa[1]=Kn,!0}function Xn(){Ur(),jt.style("pointer-events","all").selectAll(".resize").style("display",Ne.empty()?"none":null),t.select("body").style("cursor",null),hn.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),Kr(),zt({type:"brushend"})}jt.style("pointer-events","none").selectAll(".resize").style("display",null),t.select("body").style("cursor",Ft.style("cursor")),zt({type:"brushstart"}),Ur()}return Ne.event=function(Tt){Tt.each(function(){var At=R.of(this,arguments),yt={x:ne,y:le,i:oe,j:C},Ft=this.__chart__||yt;this.__chart__=yt,Rs?t.select(this).transition().each("start.brush",function(){oe=Ft.i,C=Ft.j,ne=Ft.x,le=Ft.y,At({type:"brushstart"})}).tween("brush:brush",function(){var zt=yi(ne,yt.x),jt=yi(le,yt.y);return oe=C=null,function(rr){ne=yt.x=zt(rr),le=yt.y=jt(rr),At({type:"brush",mode:"resize"})}}).each("end.brush",function(){oe=yt.i,C=yt.j,At({type:"brush",mode:"resize"}),At({type:"brushend"})}):(At({type:"brushstart"}),At({type:"brush",mode:"resize"}),At({type:"brushend"}))})},Ne.x=function(Tt){return arguments.length?(Te=lo[!(F=Tt)<<1|!V],Ne):F},Ne.y=function(Tt){return arguments.length?(Te=lo[!F<<1|!(V=Tt)],Ne):V},Ne.clamp=function(Tt){return arguments.length?(F&&V?(pe=!!Tt[0],ye=!!Tt[1]):F?pe=!!Tt:V&&(ye=!!Tt),Ne):F&&V?[pe,ye]:F?pe:V?ye:null},Ne.extent=function(Tt){var At,yt,Ft,zt,jt;return arguments.length?(F&&(At=Tt[0],yt=Tt[1],V&&(At=At[0],yt=yt[0]),oe=[At,yt],F.invert&&(At=F(At),yt=F(yt)),yt<At&&(jt=At,At=yt,yt=jt),At==ne[0]&&yt==ne[1]||(ne=[At,yt])),V&&(Ft=Tt[0],zt=Tt[1],F&&(Ft=Ft[1],zt=zt[1]),C=[Ft,zt],V.invert&&(Ft=V(Ft),zt=V(zt)),zt<Ft&&(jt=Ft,Ft=zt,zt=jt),Ft==le[0]&&zt==le[1]||(le=[Ft,zt])),Ne):(F&&(oe?(At=oe[0],yt=oe[1]):(At=ne[0],yt=ne[1],F.invert&&(At=F.invert(At),yt=F.invert(yt)),yt<At&&(jt=At,At=yt,yt=jt))),V&&(C?(Ft=C[0],zt=C[1]):(Ft=le[0],zt=le[1],V.invert&&(Ft=V.invert(Ft),zt=V.invert(zt)),zt<Ft&&(jt=Ft,Ft=zt,zt=jt))),F&&V?[[At,Ft],[yt,zt]]:F?[At,yt]:V&&[Ft,zt])},Ne.clear=function(){return Ne.empty()||(ne=[0,0],le=[0,0],oe=C=null),Ne},Ne.empty=function(){return!!F&&ne[0]==ne[1]||!!V&&le[0]==le[1]},t.rebind(Ne,R,"on")};var tl={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},lo=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];function Zl(oe){return JSON.parse(oe.responseText)}function Kl(oe){var C=h.createRange();return C.selectNode(h.body),C.createContextualFragment(oe.responseText)}t.text=jr(function(oe){return oe.responseText}),t.json=function(oe,C){return $r(oe,"application/json",Zl,C)},t.html=function(oe,C){return $r(oe,"text/html",Kl,C)},t.xml=jr(function(oe){return oe.responseXML}),typeof I=="object"&&I.exports?I.exports=t:this.d3=t}).apply(self)},{}],59:[function(r,I,B){I.exports=r("./quad")},{"./quad":60}],60:[function(r,I,B){var t=r("binary-search-bounds"),d=r("clamp"),m=r("parse-rect"),h=r("array-bounds"),e=r("pick-by-alias"),f=r("defined"),l=r("flatten-vertex-data"),o=r("is-obj"),u=r("dtype"),s=r("math-log2");function i(c,n){for(var a=n[0],g=n[1],p=1/(n[2]-a),y=1/(n[3]-g),v=new Array(c.length),b=0,x=c.length/2;b<x;b++)v[2*b]=d((c[2*b]-a)*p,0,1),v[2*b+1]=d((c[2*b+1]-g)*y,0,1);return v}I.exports=function(c,n){n||(n={}),c=l(c,"float64"),n=e(n,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var a=f(n.maxDepth,255),g=f(n.bounds,h(c,2));g[0]===g[2]&&g[2]++,g[1]===g[3]&&g[3]++;var p,y=i(c,g),v=c.length>>>1;n.dtype||(n.dtype="array"),typeof n.dtype=="string"?p=new(u(n.dtype))(v):n.dtype&&(p=n.dtype,Array.isArray(p)&&(p.length=v));for(var b=0;b<v;++b)p[b]=b;var x=[],T=[],A=[],S=[];(function U(G,X,K,Z,H,Y){if(!Z.length)return null;var $=x[H]||(x[H]=[]),z=A[H]||(A[H]=[]),j=T[H]||(T[H]=[]),W=$.length;if(++H>a||Y>1073741824){for(var ee=0;ee<Z.length;ee++)$.push(Z[ee]),z.push(Y),j.push(null,null,null,null);return W}if($.push(Z[0]),z.push(Y),Z.length<=1)return j.push(null,null,null,null),W;for(var J=.5*K,Q=G+J,te=X+J,ie=[],ae=[],he=[],se=[],de=1,ue=Z.length;de<ue;de++){var ve=Z[de],ke=y[2*ve],Ee=y[2*ve+1];ke<Q?Ee<te?ie.push(ve):ae.push(ve):Ee<te?he.push(ve):se.push(ve)}return Y<<=2,j.push(U(G,X,J,ie,H,Y),U(G,te,J,ae,H,Y+1),U(Q,X,J,he,H,Y+2),U(Q,te,J,se,H,Y+3)),W})(0,0,1,p,0,1);for(var w=0,E=0;E<x.length;E++){var k=x[E];if(p.set)p.set(k,w);else for(var L=0,M=k.length;L<M;L++)p[L+w]=k[L];var P=w+x[E].length;S[E]=[w,P],w=P}return p.range=function(){for(var U,G=[],X=arguments.length;X--;)G[X]=arguments[X];if(o(G[G.length-1])){var K=G.pop();G.length||K.x==null&&K.l==null&&K.left==null||(G=[K],U={}),U=e(K,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else U={};G.length||(G=g);var Z=m.apply(void 0,G),H=[Math.min(Z.x,Z.x+Z.width),Math.min(Z.y,Z.y+Z.height),Math.max(Z.x,Z.x+Z.width),Math.max(Z.y,Z.y+Z.height)],Y=H[0],$=H[1],z=H[2],j=H[3],W=i([Y,$,z,j],g),ee=W[0],J=W[1],Q=W[2],te=W[3],ie=f(U.level,x.length);if(U.d!=null){var ae;typeof U.d=="number"?ae=[U.d,U.d]:U.d.length&&(ae=U.d),ie=Math.min(Math.max(Math.ceil(-s(Math.abs(ae[0])/(g[2]-g[0]))),Math.ceil(-s(Math.abs(ae[1])/(g[3]-g[1])))),ie)}if(ie=Math.min(ie,x.length),U.lod)return D(ee,J,Q,te,ie);var he=[];function se(ue,ve,ke,Ee,be,xe){if(be!==null&&xe!==null&&!(ee>ue+ke||J>ve+ke||Q<ue||te<ve||Ee>=ie||be===xe)){var ce=x[Ee];xe===void 0&&(xe=ce.length);for(var ge=be;ge<xe;ge++){var we=ce[ge],Me=c[2*we],Se=c[2*we+1];Me>=Y&&Me<=z&&Se>=$&&Se<=j&&he.push(we)}var ze=T[Ee],Fe=ze[4*be+0],Ye=ze[4*be+1],rt=ze[4*be+2],Oe=ze[4*be+3],je=de(ze,be+1),We=.5*ke,qe=Ee+1;se(ue,ve,We,qe,Fe,Ye||rt||Oe||je),se(ue,ve+We,We,qe,Ye,rt||Oe||je),se(ue+We,ve,We,qe,rt,Oe||je),se(ue+We,ve+We,We,qe,Oe,je)}}function de(ue,ve){for(var ke=null,Ee=0;ke===null;)if(ke=ue[4*ve+Ee],++Ee>ue.length)return null;return ke}return se(0,0,1,0,0,1),he},p;function D(U,G,X,K,Z){for(var H=[],Y=0;Y<Z;Y++){var $=A[Y],z=S[Y][0],j=N(U,G,Y),W=N(X,K,Y),ee=t.ge($,j),J=t.gt($,W,ee,$.length-1);H[Y]=[ee+z,J+z]}return H}function N(U,G,X){for(var K=1,Z=.5,H=.5,Y=.5,$=0;$<X;$++)K<<=2,K+=U<Z?G<H?0:1:G<H?2:3,Y*=.5,Z+=U<Z?-Y:Y,H+=G<H?-Y:Y;return K}}},{"array-bounds":76,"binary-search-bounds":103,clamp:126,defined:176,dtype:181,"flatten-vertex-data":248,"is-obj":446,"math-log2":456,"parse-rect":481,"pick-by-alias":485}],61:[function(r,I,B){Object.defineProperty(B,"__esModule",{value:!0});var t=r("@turf/meta");function d(e){var f=0;if(e&&e.length>0){f+=Math.abs(m(e[0]));for(var l=1;l<e.length;l++)f-=Math.abs(m(e[l]))}return f}function m(e){var f,l,o,u,s,i,c=0,n=e.length;if(n>2){for(i=0;i<n;i++)i===n-2?(o=n-2,u=n-1,s=0):i===n-1?(o=n-1,u=0,s=1):(o=i,u=i+1,s=i+2),f=e[o],l=e[u],c+=(h(e[s][0])-h(f[0]))*Math.sin(h(l[1]));c=6378137*c*6378137/2}return c}function h(e){return e*Math.PI/180}B.default=function(e){return t.geomReduce(e,function(f,l){return f+function(o){var u,s=0;switch(o.type){case"Polygon":return d(o.coordinates);case"MultiPolygon":for(u=0;u<o.coordinates.length;u++)s+=d(o.coordinates[u]);return s;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(l)},0)}},{"@turf/meta":63}],62:[function(r,I,B){function t(n,a,g){g===void 0&&(g={});var p={type:"Feature"};return(g.id===0||g.id)&&(p.id=g.id),g.bbox&&(p.bbox=g.bbox),p.properties=a||{},p.geometry=n,p}function d(n,a,g){if(g===void 0&&(g={}),!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!c(n[0])||!c(n[1]))throw new Error("coordinates must contain numbers");return t({type:"Point",coordinates:n},a,g)}function m(n,a,g){g===void 0&&(g={});for(var p=0,y=n;p<y.length;p++){var v=y[p];if(v.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var b=0;b<v[v.length-1].length;b++)if(v[v.length-1][b]!==v[0][b])throw new Error("First and last Position are not equivalent.")}return t({type:"Polygon",coordinates:n},a,g)}function h(n,a,g){if(g===void 0&&(g={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");return t({type:"LineString",coordinates:n},a,g)}function e(n,a){a===void 0&&(a={});var g={type:"FeatureCollection"};return a.id&&(g.id=a.id),a.bbox&&(g.bbox=a.bbox),g.features=n,g}function f(n,a,g){return g===void 0&&(g={}),t({type:"MultiLineString",coordinates:n},a,g)}function l(n,a,g){return g===void 0&&(g={}),t({type:"MultiPoint",coordinates:n},a,g)}function o(n,a,g){return g===void 0&&(g={}),t({type:"MultiPolygon",coordinates:n},a,g)}function u(n,a){a===void 0&&(a="kilometers");var g=B.factors[a];if(!g)throw new Error(a+" units is invalid");return n*g}function s(n,a){a===void 0&&(a="kilometers");var g=B.factors[a];if(!g)throw new Error(a+" units is invalid");return n/g}function i(n){return 180*(n%(2*Math.PI))/Math.PI}function c(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}Object.defineProperty(B,"__esModule",{value:!0}),B.earthRadius=63710088e-1,B.factors={centimeters:100*B.earthRadius,centimetres:100*B.earthRadius,degrees:B.earthRadius/111325,feet:3.28084*B.earthRadius,inches:39.37*B.earthRadius,kilometers:B.earthRadius/1e3,kilometres:B.earthRadius/1e3,meters:B.earthRadius,metres:B.earthRadius,miles:B.earthRadius/1609.344,millimeters:1e3*B.earthRadius,millimetres:1e3*B.earthRadius,nauticalmiles:B.earthRadius/1852,radians:1,yards:1.0936*B.earthRadius},B.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/B.earthRadius,yards:1.0936133},B.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},B.feature=t,B.geometry=function(n,a,g){switch(n){case"Point":return d(a).geometry;case"LineString":return h(a).geometry;case"Polygon":return m(a).geometry;case"MultiPoint":return l(a).geometry;case"MultiLineString":return f(a).geometry;case"MultiPolygon":return o(a).geometry;default:throw new Error(n+" is invalid")}},B.point=d,B.points=function(n,a,g){return g===void 0&&(g={}),e(n.map(function(p){return d(p,a)}),g)},B.polygon=m,B.polygons=function(n,a,g){return g===void 0&&(g={}),e(n.map(function(p){return m(p,a)}),g)},B.lineString=h,B.lineStrings=function(n,a,g){return g===void 0&&(g={}),e(n.map(function(p){return h(p,a)}),g)},B.featureCollection=e,B.multiLineString=f,B.multiPoint=l,B.multiPolygon=o,B.geometryCollection=function(n,a,g){return g===void 0&&(g={}),t({type:"GeometryCollection",geometries:n},a,g)},B.round=function(n,a){if(a===void 0&&(a=0),a&&!(a>=0))throw new Error("precision must be a positive number");var g=Math.pow(10,a||0);return Math.round(n*g)/g},B.radiansToLength=u,B.lengthToRadians=s,B.lengthToDegrees=function(n,a){return i(s(n,a))},B.bearingToAzimuth=function(n){var a=n%360;return a<0&&(a+=360),a},B.radiansToDegrees=i,B.degreesToRadians=function(n){return n%360*Math.PI/180},B.convertLength=function(n,a,g){if(a===void 0&&(a="kilometers"),g===void 0&&(g="kilometers"),!(n>=0))throw new Error("length must be a positive number");return u(s(n,a),g)},B.convertArea=function(n,a,g){if(a===void 0&&(a="meters"),g===void 0&&(g="kilometers"),!(n>=0))throw new Error("area must be a positive number");var p=B.areaFactors[a];if(!p)throw new Error("invalid original units");var y=B.areaFactors[g];if(!y)throw new Error("invalid final units");return n/p*y},B.isNumber=c,B.isObject=function(n){return!!n&&n.constructor===Object},B.validateBBox=function(n){if(!n)throw new Error("bbox is required");if(!Array.isArray(n))throw new Error("bbox must be an Array");if(n.length!==4&&n.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");n.forEach(function(a){if(!c(a))throw new Error("bbox must only contain numbers")})},B.validateId=function(n){if(!n)throw new Error("id is required");if(["string","number"].indexOf(typeof n)===-1)throw new Error("id must be a number or a string")}},{}],63:[function(r,I,B){Object.defineProperty(B,"__esModule",{value:!0});var t=r("@turf/helpers");function d(u,s,i){if(u!==null)for(var c,n,a,g,p,y,v,b,x=0,T=0,A=u.type,S=A==="FeatureCollection",w=A==="Feature",E=S?u.features.length:1,k=0;k<E;k++){p=(b=!!(v=S?u.features[k].geometry:w?u.geometry:u)&&v.type==="GeometryCollection")?v.geometries.length:1;for(var L=0;L<p;L++){var M=0,P=0;if((g=b?v.geometries[L]:v)!==null){y=g.coordinates;var D=g.type;switch(x=!i||D!=="Polygon"&&D!=="MultiPolygon"?0:1,D){case null:break;case"Point":if(s(y,T,k,M,P)===!1)return!1;T++,M++;break;case"LineString":case"MultiPoint":for(c=0;c<y.length;c++){if(s(y[c],T,k,M,P)===!1)return!1;T++,D==="MultiPoint"&&M++}D==="LineString"&&M++;break;case"Polygon":case"MultiLineString":for(c=0;c<y.length;c++){for(n=0;n<y[c].length-x;n++){if(s(y[c][n],T,k,M,P)===!1)return!1;T++}D==="MultiLineString"&&M++,D==="Polygon"&&P++}D==="Polygon"&&M++;break;case"MultiPolygon":for(c=0;c<y.length;c++){for(P=0,n=0;n<y[c].length;n++){for(a=0;a<y[c][n].length-x;a++){if(s(y[c][n][a],T,k,M,P)===!1)return!1;T++}P++}M++}break;case"GeometryCollection":for(c=0;c<g.geometries.length;c++)if(d(g.geometries[c],s,i)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function m(u,s){var i;switch(u.type){case"FeatureCollection":for(i=0;i<u.features.length&&s(u.features[i].properties,i)!==!1;i++);break;case"Feature":s(u.properties,0)}}function h(u,s){if(u.type==="Feature")s(u,0);else if(u.type==="FeatureCollection")for(var i=0;i<u.features.length&&s(u.features[i],i)!==!1;i++);}function e(u,s){var i,c,n,a,g,p,y,v,b,x,T=0,A=u.type==="FeatureCollection",S=u.type==="Feature",w=A?u.features.length:1;for(i=0;i<w;i++){for(p=A?u.features[i].geometry:S?u.geometry:u,v=A?u.features[i].properties:S?u.properties:{},b=A?u.features[i].bbox:S?u.bbox:void 0,x=A?u.features[i].id:S?u.id:void 0,g=(y=!!p&&p.type==="GeometryCollection")?p.geometries.length:1,n=0;n<g;n++)if((a=y?p.geometries[n]:p)!==null)switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(s(a,T,v,b,x)===!1)return!1;break;case"GeometryCollection":for(c=0;c<a.geometries.length;c++)if(s(a.geometries[c],T,v,b,x)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(s(null,T,v,b,x)===!1)return!1;T++}}function f(u,s){e(u,function(i,c,n,a,g){var p,y=i===null?null:i.type;switch(y){case null:case"Point":case"LineString":case"Polygon":return s(t.feature(i,n,{bbox:a,id:g}),c,0)!==!1&&void 0}switch(y){case"MultiPoint":p="Point";break;case"MultiLineString":p="LineString";break;case"MultiPolygon":p="Polygon"}for(var v=0;v<i.coordinates.length;v++){var b={type:p,coordinates:i.coordinates[v]};if(s(t.feature(b,n),c,v)===!1)return!1}})}function l(u,s){f(u,function(i,c,n){var a=0;if(i.geometry){var g=i.geometry.type;if(g!=="Point"&&g!=="MultiPoint"){var p,y=0,v=0,b=0;return d(i,function(x,T,A,S,w){if(p===void 0||c>y||S>v||w>b)return p=x,y=c,v=S,b=w,void(a=0);var E=t.lineString([p,x],i.properties);if(s(E,c,n,w,a)===!1)return!1;a++,p=x})!==!1&&void 0}}})}function o(u,s){if(!u)throw new Error("geojson is required");f(u,function(i,c,n){if(i.geometry!==null){var a=i.geometry.type,g=i.geometry.coordinates;switch(a){case"LineString":if(s(i,c,n,0,0)===!1)return!1;break;case"Polygon":for(var p=0;p<g.length;p++)if(s(t.lineString(g[p],i.properties),c,n,p)===!1)return!1}}})}B.coordEach=d,B.coordReduce=function(u,s,i,c){var n=i;return d(u,function(a,g,p,y,v){n=g===0&&i===void 0?a:s(n,a,g,p,y,v)},c),n},B.propEach=m,B.propReduce=function(u,s,i){var c=i;return m(u,function(n,a){c=a===0&&i===void 0?n:s(c,n,a)}),c},B.featureEach=h,B.featureReduce=function(u,s,i){var c=i;return h(u,function(n,a){c=a===0&&i===void 0?n:s(c,n,a)}),c},B.coordAll=function(u){var s=[];return d(u,function(i){s.push(i)}),s},B.geomEach=e,B.geomReduce=function(u,s,i){var c=i;return e(u,function(n,a,g,p,y){c=a===0&&i===void 0?n:s(c,n,a,g,p,y)}),c},B.flattenEach=f,B.flattenReduce=function(u,s,i){var c=i;return f(u,function(n,a,g){c=a===0&&g===0&&i===void 0?n:s(c,n,a,g)}),c},B.segmentEach=l,B.segmentReduce=function(u,s,i){var c=i,n=!1;return l(u,function(a,g,p,y,v){c=n===!1&&i===void 0?a:s(c,a,g,p,y,v),n=!0}),c},B.lineEach=o,B.lineReduce=function(u,s,i){var c=i;return o(u,function(n,a,g,p){c=a===0&&i===void 0?n:s(c,n,a,g,p)}),c},B.findSegment=function(u,s){if(s=s||{},!t.isObject(s))throw new Error("options is invalid");var i,c=s.featureIndex||0,n=s.multiFeatureIndex||0,a=s.geometryIndex||0,g=s.segmentIndex||0,p=s.properties;switch(u.type){case"FeatureCollection":c<0&&(c=u.features.length+c),p=p||u.features[c].properties,i=u.features[c].geometry;break;case"Feature":p=p||u.properties,i=u.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=u;break;default:throw new Error("geojson is invalid")}if(i===null)return null;var y=i.coordinates;switch(i.type){case"Point":case"MultiPoint":return null;case"LineString":return g<0&&(g=y.length+g-1),t.lineString([y[g],y[g+1]],p,s);case"Polygon":return a<0&&(a=y.length+a),g<0&&(g=y[a].length+g-1),t.lineString([y[a][g],y[a][g+1]],p,s);case"MultiLineString":return n<0&&(n=y.length+n),g<0&&(g=y[n].length+g-1),t.lineString([y[n][g],y[n][g+1]],p,s);case"MultiPolygon":return n<0&&(n=y.length+n),a<0&&(a=y[n].length+a),g<0&&(g=y[n][a].length-g-1),t.lineString([y[n][a][g],y[n][a][g+1]],p,s)}throw new Error("geojson is invalid")},B.findPoint=function(u,s){if(s=s||{},!t.isObject(s))throw new Error("options is invalid");var i,c=s.featureIndex||0,n=s.multiFeatureIndex||0,a=s.geometryIndex||0,g=s.coordIndex||0,p=s.properties;switch(u.type){case"FeatureCollection":c<0&&(c=u.features.length+c),p=p||u.features[c].properties,i=u.features[c].geometry;break;case"Feature":p=p||u.properties,i=u.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=u;break;default:throw new Error("geojson is invalid")}if(i===null)return null;var y=i.coordinates;switch(i.type){case"Point":return t.point(y,p,s);case"MultiPoint":return n<0&&(n=y.length+n),t.point(y[n],p,s);case"LineString":return g<0&&(g=y.length+g),t.point(y[g],p,s);case"Polygon":return a<0&&(a=y.length+a),g<0&&(g=y[a].length+g),t.point(y[a][g],p,s);case"MultiLineString":return n<0&&(n=y.length+n),g<0&&(g=y[n].length+g),t.point(y[n][g],p,s);case"MultiPolygon":return n<0&&(n=y.length+n),a<0&&(a=y[n].length+a),g<0&&(g=y[n][a].length-g),t.point(y[n][a][g],p,s)}throw new Error("geojson is invalid")}},{"@turf/helpers":62}],64:[function(r,I,B){Object.defineProperty(B,"__esModule",{value:!0});var t=r("@turf/meta");function d(m){var h=[1/0,1/0,-1/0,-1/0];return t.coordEach(m,function(e){h[0]>e[0]&&(h[0]=e[0]),h[1]>e[1]&&(h[1]=e[1]),h[2]<e[0]&&(h[2]=e[0]),h[3]<e[1]&&(h[3]=e[1])}),h}d.default=d,B.default=d},{"@turf/meta":66}],65:[function(r,I,B){arguments[4][62][0].apply(B,arguments)},{dup:62}],66:[function(r,I,B){arguments[4][63][0].apply(B,arguments)},{"@turf/helpers":65,dup:63}],67:[function(r,I,B){Object.defineProperty(B,"__esModule",{value:!0});var t=r("@turf/meta"),d=r("@turf/helpers");B.default=function(m,h){h===void 0&&(h={});var e=0,f=0,l=0;return t.coordEach(m,function(o){e+=o[0],f+=o[1],l++}),d.point([e/l,f/l],h.properties)}},{"@turf/helpers":68,"@turf/meta":69}],68:[function(r,I,B){function t(n,a,g){g===void 0&&(g={});var p={type:"Feature"};return(g.id===0||g.id)&&(p.id=g.id),g.bbox&&(p.bbox=g.bbox),p.properties=a||{},p.geometry=n,p}function d(n,a,g){return g===void 0&&(g={}),t({type:"Point",coordinates:n},a,g)}function m(n,a,g){g===void 0&&(g={});for(var p=0,y=n;p<y.length;p++){var v=y[p];if(v.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var b=0;b<v[v.length-1].length;b++)if(v[v.length-1][b]!==v[0][b])throw new Error("First and last Position are not equivalent.")}return t({type:"Polygon",coordinates:n},a,g)}function h(n,a,g){if(g===void 0&&(g={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");return t({type:"LineString",coordinates:n},a,g)}function e(n,a){a===void 0&&(a={});var g={type:"FeatureCollection"};return a.id&&(g.id=a.id),a.bbox&&(g.bbox=a.bbox),g.features=n,g}function f(n,a,g){return g===void 0&&(g={}),t({type:"MultiLineString",coordinates:n},a,g)}function l(n,a,g){return g===void 0&&(g={}),t({type:"MultiPoint",coordinates:n},a,g)}function o(n,a,g){return g===void 0&&(g={}),t({type:"MultiPolygon",coordinates:n},a,g)}function u(n,a){a===void 0&&(a="kilometers");var g=B.factors[a];if(!g)throw new Error(a+" units is invalid");return n*g}function s(n,a){a===void 0&&(a="kilometers");var g=B.factors[a];if(!g)throw new Error(a+" units is invalid");return n/g}function i(n){return 180*(n%(2*Math.PI))/Math.PI}function c(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)&&!/^\s*$/.test(n)}Object.defineProperty(B,"__esModule",{value:!0}),B.earthRadius=63710088e-1,B.factors={centimeters:100*B.earthRadius,centimetres:100*B.earthRadius,degrees:B.earthRadius/111325,feet:3.28084*B.earthRadius,inches:39.37*B.earthRadius,kilometers:B.earthRadius/1e3,kilometres:B.earthRadius/1e3,meters:B.earthRadius,metres:B.earthRadius,miles:B.earthRadius/1609.344,millimeters:1e3*B.earthRadius,millimetres:1e3*B.earthRadius,nauticalmiles:B.earthRadius/1852,radians:1,yards:B.earthRadius/1.0936},B.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/B.earthRadius,yards:1/1.0936},B.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},B.feature=t,B.geometry=function(n,a,g){switch(n){case"Point":return d(a).geometry;case"LineString":return h(a).geometry;case"Polygon":return m(a).geometry;case"MultiPoint":return l(a).geometry;case"MultiLineString":return f(a).geometry;case"MultiPolygon":return o(a).geometry;default:throw new Error(n+" is invalid")}},B.point=d,B.points=function(n,a,g){return g===void 0&&(g={}),e(n.map(function(p){return d(p,a)}),g)},B.polygon=m,B.polygons=function(n,a,g){return g===void 0&&(g={}),e(n.map(function(p){return m(p,a)}),g)},B.lineString=h,B.lineStrings=function(n,a,g){return g===void 0&&(g={}),e(n.map(function(p){return h(p,a)}),g)},B.featureCollection=e,B.multiLineString=f,B.multiPoint=l,B.multiPolygon=o,B.geometryCollection=function(n,a,g){return g===void 0&&(g={}),t({type:"GeometryCollection",geometries:n},a,g)},B.round=function(n,a){if(a===void 0&&(a=0),a&&!(a>=0))throw new Error("precision must be a positive number");var g=Math.pow(10,a||0);return Math.round(n*g)/g},B.radiansToLength=u,B.lengthToRadians=s,B.lengthToDegrees=function(n,a){return i(s(n,a))},B.bearingToAzimuth=function(n){var a=n%360;return a<0&&(a+=360),a},B.radiansToDegrees=i,B.degreesToRadians=function(n){return n%360*Math.PI/180},B.convertLength=function(n,a,g){if(a===void 0&&(a="kilometers"),g===void 0&&(g="kilometers"),!(n>=0))throw new Error("length must be a positive number");return u(s(n,a),g)},B.convertArea=function(n,a,g){if(a===void 0&&(a="meters"),g===void 0&&(g="kilometers"),!(n>=0))throw new Error("area must be a positive number");var p=B.areaFactors[a];if(!p)throw new Error("invalid original units");var y=B.areaFactors[g];if(!y)throw new Error("invalid final units");return n/p*y},B.isNumber=c,B.isObject=function(n){return!!n&&n.constructor===Object},B.validateBBox=function(n){if(!n)throw new Error("bbox is required");if(!Array.isArray(n))throw new Error("bbox must be an Array");if(n.length!==4&&n.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");n.forEach(function(a){if(!c(a))throw new Error("bbox must only contain numbers")})},B.validateId=function(n){if(!n)throw new Error("id is required");if(["string","number"].indexOf(typeof n)===-1)throw new Error("id must be a number or a string")},B.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},B.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},B.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},B.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},B.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},B.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},B.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],69:[function(r,I,B){Object.defineProperty(B,"__esModule",{value:!0});var t=r("@turf/helpers");function d(u,s,i){if(u!==null)for(var c,n,a,g,p,y,v,b,x=0,T=0,A=u.type,S=A==="FeatureCollection",w=A==="Feature",E=S?u.features.length:1,k=0;k<E;k++){p=(b=!!(v=S?u.features[k].geometry:w?u.geometry:u)&&v.type==="GeometryCollection")?v.geometries.length:1;for(var L=0;L<p;L++){var M=0,P=0;if((g=b?v.geometries[L]:v)!==null){y=g.coordinates;var D=g.type;switch(x=!i||D!=="Polygon"&&D!=="MultiPolygon"?0:1,D){case null:break;case"Point":if(s(y,T,k,M,P)===!1)return!1;T++,M++;break;case"LineString":case"MultiPoint":for(c=0;c<y.length;c++){if(s(y[c],T,k,M,P)===!1)return!1;T++,D==="MultiPoint"&&M++}D==="LineString"&&M++;break;case"Polygon":case"MultiLineString":for(c=0;c<y.length;c++){for(n=0;n<y[c].length-x;n++){if(s(y[c][n],T,k,M,P)===!1)return!1;T++}D==="MultiLineString"&&M++,D==="Polygon"&&P++}D==="Polygon"&&M++;break;case"MultiPolygon":for(c=0;c<y.length;c++){for(P=0,n=0;n<y[c].length;n++){for(a=0;a<y[c][n].length-x;a++){if(s(y[c][n][a],T,k,M,P)===!1)return!1;T++}P++}M++}break;case"GeometryCollection":for(c=0;c<g.geometries.length;c++)if(d(g.geometries[c],s,i)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function m(u,s){var i;switch(u.type){case"FeatureCollection":for(i=0;i<u.features.length&&s(u.features[i].properties,i)!==!1;i++);break;case"Feature":s(u.properties,0)}}function h(u,s){if(u.type==="Feature")s(u,0);else if(u.type==="FeatureCollection")for(var i=0;i<u.features.length&&s(u.features[i],i)!==!1;i++);}function e(u,s){var i,c,n,a,g,p,y,v,b,x,T=0,A=u.type==="FeatureCollection",S=u.type==="Feature",w=A?u.features.length:1;for(i=0;i<w;i++){for(p=A?u.features[i].geometry:S?u.geometry:u,v=A?u.features[i].properties:S?u.properties:{},b=A?u.features[i].bbox:S?u.bbox:void 0,x=A?u.features[i].id:S?u.id:void 0,g=(y=!!p&&p.type==="GeometryCollection")?p.geometries.length:1,n=0;n<g;n++)if((a=y?p.geometries[n]:p)!==null)switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(s(a,T,v,b,x)===!1)return!1;break;case"GeometryCollection":for(c=0;c<a.geometries.length;c++)if(s(a.geometries[c],T,v,b,x)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(s(null,T,v,b,x)===!1)return!1;T++}}function f(u,s){e(u,function(i,c,n,a,g){var p,y=i===null?null:i.type;switch(y){case null:case"Point":case"LineString":case"Polygon":return s(t.feature(i,n,{bbox:a,id:g}),c,0)!==!1&&void 0}switch(y){case"MultiPoint":p="Point";break;case"MultiLineString":p="LineString";break;case"MultiPolygon":p="Polygon"}for(var v=0;v<i.coordinates.length;v++){var b={type:p,coordinates:i.coordinates[v]};if(s(t.feature(b,n),c,v)===!1)return!1}})}function l(u,s){f(u,function(i,c,n){var a=0;if(i.geometry){var g=i.geometry.type;if(g!=="Point"&&g!=="MultiPoint"){var p,y=0,v=0,b=0;return d(i,function(x,T,A,S,w){if(p===void 0||c>y||S>v||w>b)return p=x,y=c,v=S,b=w,void(a=0);var E=t.lineString([p,x],i.properties);if(s(E,c,n,w,a)===!1)return!1;a++,p=x})!==!1&&void 0}}})}function o(u,s){if(!u)throw new Error("geojson is required");f(u,function(i,c,n){if(i.geometry!==null){var a=i.geometry.type,g=i.geometry.coordinates;switch(a){case"LineString":if(s(i,c,n,0,0)===!1)return!1;break;case"Polygon":for(var p=0;p<g.length;p++)if(s(t.lineString(g[p],i.properties),c,n,p)===!1)return!1}}})}B.coordEach=d,B.coordReduce=function(u,s,i,c){var n=i;return d(u,function(a,g,p,y,v){n=g===0&&i===void 0?a:s(n,a,g,p,y,v)},c),n},B.propEach=m,B.propReduce=function(u,s,i){var c=i;return m(u,function(n,a){c=a===0&&i===void 0?n:s(c,n,a)}),c},B.featureEach=h,B.featureReduce=function(u,s,i){var c=i;return h(u,function(n,a){c=a===0&&i===void 0?n:s(c,n,a)}),c},B.coordAll=function(u){var s=[];return d(u,function(i){s.push(i)}),s},B.geomEach=e,B.geomReduce=function(u,s,i){var c=i;return e(u,function(n,a,g,p,y){c=a===0&&i===void 0?n:s(c,n,a,g,p,y)}),c},B.flattenEach=f,B.flattenReduce=function(u,s,i){var c=i;return f(u,function(n,a,g){c=a===0&&g===0&&i===void 0?n:s(c,n,a,g)}),c},B.segmentEach=l,B.segmentReduce=function(u,s,i){var c=i,n=!1;return l(u,function(a,g,p,y,v){c=n===!1&&i===void 0?a:s(c,a,g,p,y,v),n=!0}),c},B.lineEach=o,B.lineReduce=function(u,s,i){var c=i;return o(u,function(n,a,g,p){c=a===0&&i===void 0?n:s(c,n,a,g,p)}),c},B.findSegment=function(u,s){if(s=s||{},!t.isObject(s))throw new Error("options is invalid");var i,c=s.featureIndex||0,n=s.multiFeatureIndex||0,a=s.geometryIndex||0,g=s.segmentIndex||0,p=s.properties;switch(u.type){case"FeatureCollection":c<0&&(c=u.features.length+c),p=p||u.features[c].properties,i=u.features[c].geometry;break;case"Feature":p=p||u.properties,i=u.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=u;break;default:throw new Error("geojson is invalid")}if(i===null)return null;var y=i.coordinates;switch(i.type){case"Point":case"MultiPoint":return null;case"LineString":return g<0&&(g=y.length+g-1),t.lineString([y[g],y[g+1]],p,s);case"Polygon":return a<0&&(a=y.length+a),g<0&&(g=y[a].length+g-1),t.lineString([y[a][g],y[a][g+1]],p,s);case"MultiLineString":return n<0&&(n=y.length+n),g<0&&(g=y[n].length+g-1),t.lineString([y[n][g],y[n][g+1]],p,s);case"MultiPolygon":return n<0&&(n=y.length+n),a<0&&(a=y[n].length+a),g<0&&(g=y[n][a].length-g-1),t.lineString([y[n][a][g],y[n][a][g+1]],p,s)}throw new Error("geojson is invalid")},B.findPoint=function(u,s){if(s=s||{},!t.isObject(s))throw new Error("options is invalid");var i,c=s.featureIndex||0,n=s.multiFeatureIndex||0,a=s.geometryIndex||0,g=s.coordIndex||0,p=s.properties;switch(u.type){case"FeatureCollection":c<0&&(c=u.features.length+c),p=p||u.features[c].properties,i=u.features[c].geometry;break;case"Feature":p=p||u.properties,i=u.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=u;break;default:throw new Error("geojson is invalid")}if(i===null)return null;var y=i.coordinates;switch(i.type){case"Point":return t.point(y,p,s);case"MultiPoint":return n<0&&(n=y.length+n),t.point(y[n],p,s);case"LineString":return g<0&&(g=y.length+g),t.point(y[g],p,s);case"Polygon":return a<0&&(a=y.length+a),g<0&&(g=y[a].length+g),t.point(y[a][g],p,s);case"MultiLineString":return n<0&&(n=y.length+n),g<0&&(g=y[n].length+g),t.point(y[n][g],p,s);case"MultiPolygon":return n<0&&(n=y.length+n),a<0&&(a=y[n].length+a),g<0&&(g=y[n][a].length-g),t.point(y[n][a][g],p,s)}throw new Error("geojson is invalid")}},{"@turf/helpers":68}],70:[function(r,I,B){var t=typeof WeakMap=="undefined"?r("weak-map"):WeakMap,d=r("gl-buffer"),m=r("gl-vao"),h=new t;I.exports=function(e){var f=h.get(e),l=f&&(f._triangleBuffer.handle||f._triangleBuffer.buffer);if(!l||!e.isBuffer(l)){var o=d(e,new Float32Array([-1,-1,-1,4,4,-1]));(f=m(e,[{buffer:o,type:e.FLOAT,size:2}]))._triangleBuffer=o,h.set(e,f)}f.bind(),e.drawArrays(e.TRIANGLES,0,3),f.unbind()}},{"gl-buffer":261,"gl-vao":353,"weak-map":609}],71:[function(r,I,B){I.exports=function(t){var d=0,m=0,h=0,e=0;return t.map(function(f){var l=(f=f.slice())[0],o=l.toUpperCase();if(l!=o)switch(f[0]=o,l){case"a":f[6]+=h,f[7]+=e;break;case"v":f[1]+=e;break;case"h":f[1]+=h;break;default:for(var u=1;u<f.length;)f[u++]+=h,f[u++]+=e}switch(o){case"Z":h=d,e=m;break;case"H":h=f[1];break;case"V":e=f[1];break;case"M":h=d=f[1],e=m=f[2];break;default:h=f[f.length-2],e=f[f.length-1]}return f})}},{}],72:[function(r,I,B){var t=r("pad-left");I.exports=function(d,m,h){m=typeof m=="number"?m:1,h=h||": ";var e=d.split(/\r?\n/),f=String(e.length+m-1).length;return e.map(function(l,o){var u=o+m,s=String(u).length;return t(u,f-s)+h+l}).join(`
`)}},{"pad-left":479}],73:[function(r,I,B){I.exports=function(m){var h=m.length;if(h===0)return[];if(h===1)return[0];for(var e=m[0].length,f=[m[0]],l=[0],o=1;o<h;++o)if(f.push(m[o]),d(f,e)){if(l.push(o),l.length===e+1)return l}else f.pop();return l};var t=r("robust-orientation");function d(m,h){for(var e=new Array(h+1),f=0;f<m.length;++f)e[f]=m[f];for(f=0;f<=m.length;++f){for(var l=m.length;l<=h;++l){for(var o=new Array(h),u=0;u<h;++u)o[u]=Math.pow(l+1-f,u);e[l]=o}if(t.apply(void 0,e))return!0}return!1}},{"robust-orientation":534}],74:[function(r,I,B){I.exports=function(m,h){return t(h).filter(function(e){for(var f=new Array(e.length),l=0;l<e.length;++l)f[l]=h[e[l]];return d(f)*m<1})};var t=r("delaunay-triangulate"),d=r("circumradius")},{circumradius:125,"delaunay-triangulate":177}],75:[function(r,I,B){I.exports=function(m,h){return d(t(m,h))};var t=r("alpha-complex"),d=r("simplicial-complex-boundary")},{"alpha-complex":74,"simplicial-complex-boundary":542}],76:[function(r,I,B){I.exports=function(t,d){if(!t||t.length==null)throw Error("Argument should be an array");d=d==null?1:Math.floor(d);for(var m=Array(2*d),h=0;h<d;h++){for(var e=-1/0,f=1/0,l=h,o=t.length;l<o;l+=d)t[l]>e&&(e=t[l]),t[l]<f&&(f=t[l]);m[h]=f,m[d+h]=e}return m}},{}],77:[function(r,I,B){I.exports=function(t,d,m){if(typeof Array.prototype.findIndex=="function")return t.findIndex(d,m);if(typeof d!="function")throw new TypeError("predicate must be a function");var h=Object(t),e=h.length;if(e===0)return-1;for(var f=0;f<e;f++)if(d.call(m,h[f],f,h))return f;return-1}},{}],78:[function(r,I,B){var t=r("array-bounds");I.exports=function(d,m,h){if(!d||d.length==null)throw Error("Argument should be an array");m==null&&(m=1),h==null&&(h=t(d,m));for(var e=0;e<m;e++){var f=h[m+e],l=h[e],o=e,u=d.length;if(f===1/0&&l===-1/0)for(o=e;o<u;o+=m)d[o]=d[o]===f?1:d[o]===l?0:.5;else if(f===1/0)for(o=e;o<u;o+=m)d[o]=d[o]===f?1:0;else if(l===-1/0)for(o=e;o<u;o+=m)d[o]=d[o]===l?0:1;else{var s=f-l;for(o=e;o<u;o+=m)isNaN(d[o])||(d[o]=s===0?.5:(d[o]-l)/s)}}return d}},{"array-bounds":76}],79:[function(r,I,B){I.exports=function(t,d){var m=typeof t=="number",h=typeof d=="number";m&&!h?(d=t,t=0):m||h||(t=0,d=0);var e=(d|=0)-(t|=0);if(e<0)throw new Error("array length must be positive");for(var f=new Array(e),l=0,o=t;l<e;l++,o++)f[l]=o;return f}},{}],80:[function(r,I,B){(function(t){(function(){var d=r("object-assign");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function m(S,w){if(S===w)return 0;for(var E=S.length,k=w.length,L=0,M=Math.min(E,k);L<M;++L)if(S[L]!==w[L]){E=S[L],k=w[L];break}return E<k?-1:k<E?1:0}function h(S){return t.Buffer&&typeof t.Buffer.isBuffer=="function"?t.Buffer.isBuffer(S):!(S==null||!S._isBuffer)}var e=r("util/"),f=Object.prototype.hasOwnProperty,l=Array.prototype.slice,o=function(){}.name==="foo";function u(S){return Object.prototype.toString.call(S)}function s(S){return!h(S)&&typeof t.ArrayBuffer=="function"&&(typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(S):!!S&&(S instanceof DataView||!!(S.buffer&&S.buffer instanceof ArrayBuffer)))}var i=I.exports=y,c=/\s*function\s+([^\(\s]*)\s*/;function n(S){if(e.isFunction(S)){if(o)return S.name;var w=S.toString().match(c);return w&&w[1]}}function a(S,w){return typeof S=="string"?S.length<w?S:S.slice(0,w):S}function g(S){if(o||!e.isFunction(S))return e.inspect(S);var w=n(S);return"[Function"+(w?": "+w:"")+"]"}function p(S,w,E,k,L){throw new i.AssertionError({message:E,actual:S,expected:w,operator:k,stackStartFunction:L})}function y(S,w){S||p(S,!0,w,"==",i.ok)}function v(S,w,E,k){if(S===w)return!0;if(h(S)&&h(w))return m(S,w)===0;if(e.isDate(S)&&e.isDate(w))return S.getTime()===w.getTime();if(e.isRegExp(S)&&e.isRegExp(w))return S.source===w.source&&S.global===w.global&&S.multiline===w.multiline&&S.lastIndex===w.lastIndex&&S.ignoreCase===w.ignoreCase;if(S!==null&&typeof S=="object"||w!==null&&typeof w=="object"){if(s(S)&&s(w)&&u(S)===u(w)&&!(S instanceof Float32Array||S instanceof Float64Array))return m(new Uint8Array(S.buffer),new Uint8Array(w.buffer))===0;if(h(S)!==h(w))return!1;var L=(k=k||{actual:[],expected:[]}).actual.indexOf(S);return L!==-1&&L===k.expected.indexOf(w)||(k.actual.push(S),k.expected.push(w),function(M,P,D,N){if(M==null||P==null)return!1;if(e.isPrimitive(M)||e.isPrimitive(P))return M===P;if(D&&Object.getPrototypeOf(M)!==Object.getPrototypeOf(P))return!1;var U=b(M),G=b(P);if(U&&!G||!U&&G)return!1;if(U)return M=l.call(M),P=l.call(P),v(M,P,D);var X,K,Z=A(M),H=A(P);if(Z.length!==H.length)return!1;for(Z.sort(),H.sort(),K=Z.length-1;K>=0;K--)if(Z[K]!==H[K])return!1;for(K=Z.length-1;K>=0;K--)if(X=Z[K],!v(M[X],P[X],D,N))return!1;return!0}(S,w,E,k))}return E?S===w:S==w}function b(S){return Object.prototype.toString.call(S)=="[object Arguments]"}function x(S,w){if(!S||!w)return!1;if(Object.prototype.toString.call(w)=="[object RegExp]")return w.test(S);try{if(S instanceof w)return!0}catch(E){}return!Error.isPrototypeOf(w)&&w.call({},S)===!0}function T(S,w,E,k){var L;if(typeof w!="function")throw new TypeError('"block" argument must be a function');typeof E=="string"&&(k=E,E=null),L=function(D){var N;try{D()}catch(U){N=U}return N}(w),k=(E&&E.name?" ("+E.name+").":".")+(k?" "+k:"."),S&&!L&&p(L,E,"Missing expected exception"+k);var M=typeof k=="string",P=!S&&L&&!E;if((!S&&e.isError(L)&&M&&x(L,E)||P)&&p(L,E,"Got unwanted exception"+k),S&&L&&E&&!x(L,E)||!S&&L)throw L}i.AssertionError=function(S){this.name="AssertionError",this.actual=S.actual,this.expected=S.expected,this.operator=S.operator,S.message?(this.message=S.message,this.generatedMessage=!1):(this.message=function(D){return a(g(D.actual),128)+" "+D.operator+" "+a(g(D.expected),128)}(this),this.generatedMessage=!0);var w=S.stackStartFunction||p;if(Error.captureStackTrace)Error.captureStackTrace(this,w);else{var E=new Error;if(E.stack){var k=E.stack,L=n(w),M=k.indexOf(`
`+L);if(M>=0){var P=k.indexOf(`
`,M+1);k=k.substring(P+1)}this.stack=k}}},e.inherits(i.AssertionError,Error),i.fail=p,i.ok=y,i.equal=function(S,w,E){S!=w&&p(S,w,E,"==",i.equal)},i.notEqual=function(S,w,E){S==w&&p(S,w,E,"!=",i.notEqual)},i.deepEqual=function(S,w,E){v(S,w,!1)||p(S,w,E,"deepEqual",i.deepEqual)},i.deepStrictEqual=function(S,w,E){v(S,w,!0)||p(S,w,E,"deepStrictEqual",i.deepStrictEqual)},i.notDeepEqual=function(S,w,E){v(S,w,!1)&&p(S,w,E,"notDeepEqual",i.notDeepEqual)},i.notDeepStrictEqual=function S(w,E,k){v(w,E,!0)&&p(w,E,k,"notDeepStrictEqual",S)},i.strictEqual=function(S,w,E){S!==w&&p(S,w,E,"===",i.strictEqual)},i.notStrictEqual=function(S,w,E){S===w&&p(S,w,E,"!==",i.notStrictEqual)},i.throws=function(S,w,E){T(!0,S,w,E)},i.doesNotThrow=function(S,w,E){T(!1,S,w,E)},i.ifError=function(S){if(S)throw S},i.strict=d(function S(w,E){w||p(w,!0,E,"==",S)},i,{equal:i.strictEqual,deepEqual:i.deepStrictEqual,notEqual:i.notStrictEqual,notDeepEqual:i.notDeepStrictEqual}),i.strict.strict=i.strict;var A=Object.keys||function(S){var w=[];for(var E in S)f.call(S,E)&&w.push(E);return w}}).call(this)}).call(this,typeof vi!="undefined"?vi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"object-assign":476,"util/":83}],81:[function(r,I,B){typeof Object.create=="function"?I.exports=function(t,d){t.super_=d,t.prototype=Object.create(d.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:I.exports=function(t,d){t.super_=d;var m=function(){};m.prototype=d.prototype,t.prototype=new m,t.prototype.constructor=t}},{}],82:[function(r,I,B){I.exports=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}},{}],83:[function(r,I,B){(function(t,d){(function(){var m=/%[sdj%]/g;B.format=function(M){if(!p(M)){for(var P=[],D=0;D<arguments.length;D++)P.push(f(arguments[D]));return P.join(" ")}D=1;for(var N=arguments,U=N.length,G=String(M).replace(m,function(K){if(K==="%%")return"%";if(D>=U)return K;switch(K){case"%s":return String(N[D++]);case"%d":return Number(N[D++]);case"%j":try{return JSON.stringify(N[D++])}catch(Z){return"[Circular]"}default:return K}}),X=N[D];D<U;X=N[++D])a(X)||!b(X)?G+=" "+X:G+=" "+f(X);return G},B.deprecate=function(M,P){if(y(d.process))return function(){return B.deprecate(M,P).apply(this,arguments)};if(t.noDeprecation===!0)return M;var D=!1;return function(){if(!D){if(t.throwDeprecation)throw new Error(P);t.traceDeprecation?console.trace(P):console.error(P),D=!0}return M.apply(this,arguments)}};var h,e={};function f(M,P){var D={seen:[],stylize:o};return arguments.length>=3&&(D.depth=arguments[2]),arguments.length>=4&&(D.colors=arguments[3]),n(P)?D.showHidden=P:P&&B._extend(D,P),y(D.showHidden)&&(D.showHidden=!1),y(D.depth)&&(D.depth=2),y(D.colors)&&(D.colors=!1),y(D.customInspect)&&(D.customInspect=!0),D.colors&&(D.stylize=l),u(D,M,D.depth)}function l(M,P){var D=f.styles[P];return D?"["+f.colors[D][0]+"m"+M+"["+f.colors[D][1]+"m":M}function o(M,P){return M}function u(M,P,D){if(M.customInspect&&P&&A(P.inspect)&&P.inspect!==B.inspect&&(!P.constructor||P.constructor.prototype!==P)){var N=P.inspect(D,M);return p(N)||(N=u(M,N,D)),N}var U=function(z,j){if(y(j))return z.stylize("undefined","undefined");if(p(j)){var W="'"+JSON.stringify(j).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return z.stylize(W,"string")}if(g(j))return z.stylize(""+j,"number");if(n(j))return z.stylize(""+j,"boolean");if(a(j))return z.stylize("null","null")}(M,P);if(U)return U;var G=Object.keys(P),X=function(z){var j={};return z.forEach(function(W,ee){j[W]=!0}),j}(G);if(M.showHidden&&(G=Object.getOwnPropertyNames(P)),T(P)&&(G.indexOf("message")>=0||G.indexOf("description")>=0))return s(P);if(G.length===0){if(A(P)){var K=P.name?": "+P.name:"";return M.stylize("[Function"+K+"]","special")}if(v(P))return M.stylize(RegExp.prototype.toString.call(P),"regexp");if(x(P))return M.stylize(Date.prototype.toString.call(P),"date");if(T(P))return s(P)}var Z,H="",Y=!1,$=["{","}"];return c(P)&&(Y=!0,$=["[","]"]),A(P)&&(H=" [Function"+(P.name?": "+P.name:"")+"]"),v(P)&&(H=" "+RegExp.prototype.toString.call(P)),x(P)&&(H=" "+Date.prototype.toUTCString.call(P)),T(P)&&(H=" "+s(P)),G.length!==0||Y&&P.length!=0?D<0?v(P)?M.stylize(RegExp.prototype.toString.call(P),"regexp"):M.stylize("[Object]","special"):(M.seen.push(P),Z=Y?function(z,j,W,ee,J){for(var Q=[],te=0,ie=j.length;te<ie;++te)L(j,String(te))?Q.push(i(z,j,W,ee,String(te),!0)):Q.push("");return J.forEach(function(ae){ae.match(/^\d+$/)||Q.push(i(z,j,W,ee,ae,!0))}),Q}(M,P,D,X,G):G.map(function(z){return i(M,P,D,X,z,Y)}),M.seen.pop(),function(z,j,W){return z.reduce(function(ee,J){return J.indexOf(`
`)>=0,ee+J.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?W[0]+(j===""?"":j+`
 `)+" "+z.join(`,
  `)+" "+W[1]:W[0]+j+" "+z.join(", ")+" "+W[1]}(Z,H,$)):$[0]+H+$[1]}function s(M){return"["+Error.prototype.toString.call(M)+"]"}function i(M,P,D,N,U,G){var X,K,Z;if((Z=Object.getOwnPropertyDescriptor(P,U)||{value:P[U]}).get?K=Z.set?M.stylize("[Getter/Setter]","special"):M.stylize("[Getter]","special"):Z.set&&(K=M.stylize("[Setter]","special")),L(N,U)||(X="["+U+"]"),K||(M.seen.indexOf(Z.value)<0?(K=a(D)?u(M,Z.value,null):u(M,Z.value,D-1)).indexOf(`
`)>-1&&(K=G?K.split(`
`).map(function(H){return"  "+H}).join(`
`).substr(2):`
`+K.split(`
`).map(function(H){return"   "+H}).join(`
`)):K=M.stylize("[Circular]","special")),y(X)){if(G&&U.match(/^\d+$/))return K;(X=JSON.stringify(""+U)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(X=X.substr(1,X.length-2),X=M.stylize(X,"name")):(X=X.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),X=M.stylize(X,"string"))}return X+": "+K}function c(M){return Array.isArray(M)}function n(M){return typeof M=="boolean"}function a(M){return M===null}function g(M){return typeof M=="number"}function p(M){return typeof M=="string"}function y(M){return M===void 0}function v(M){return b(M)&&S(M)==="[object RegExp]"}function b(M){return typeof M=="object"&&M!==null}function x(M){return b(M)&&S(M)==="[object Date]"}function T(M){return b(M)&&(S(M)==="[object Error]"||M instanceof Error)}function A(M){return typeof M=="function"}function S(M){return Object.prototype.toString.call(M)}function w(M){return M<10?"0"+M.toString(10):M.toString(10)}B.debuglog=function(M){if(y(h)&&(h=t.env.NODE_DEBUG||""),M=M.toUpperCase(),!e[M])if(new RegExp("\\b"+M+"\\b","i").test(h)){var P=t.pid;e[M]=function(){var D=B.format.apply(B,arguments);console.error("%s %d: %s",M,P,D)}}else e[M]=function(){};return e[M]},B.inspect=f,f.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},f.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},B.isArray=c,B.isBoolean=n,B.isNull=a,B.isNullOrUndefined=function(M){return M==null},B.isNumber=g,B.isString=p,B.isSymbol=function(M){return typeof M=="symbol"},B.isUndefined=y,B.isRegExp=v,B.isObject=b,B.isDate=x,B.isError=T,B.isFunction=A,B.isPrimitive=function(M){return M===null||typeof M=="boolean"||typeof M=="number"||typeof M=="string"||typeof M=="symbol"||M===void 0},B.isBuffer=r("./support/isBuffer");var E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function k(){var M=new Date,P=[w(M.getHours()),w(M.getMinutes()),w(M.getSeconds())].join(":");return[M.getDate(),E[M.getMonth()],P].join(" ")}function L(M,P){return Object.prototype.hasOwnProperty.call(M,P)}B.log=function(){console.log("%s - %s",k(),B.format.apply(B,arguments))},B.inherits=r("inherits"),B._extend=function(M,P){if(!P||!b(P))return M;for(var D=Object.keys(P),N=D.length;N--;)M[D[N]]=P[D[N]];return M}}).call(this)}).call(this,r("_process"),typeof vi!="undefined"?vi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./support/isBuffer":82,_process:514,inherits:81}],84:[function(r,I,B){I.exports=function(t){return atob(t)}},{}],85:[function(r,I,B){I.exports=function(m,h){for(var e=h.length,f=new Array(e+1),l=0;l<e;++l){for(var o=new Array(e+1),u=0;u<=e;++u)o[u]=m[u][l];f[l]=o}for(f[e]=new Array(e+1),l=0;l<=e;++l)f[e][l]=1;var s=new Array(e+1);for(l=0;l<e;++l)s[l]=h[l];s[e]=1;var i=t(f,s),c=d(i[e+1]);c===0&&(c=1);var n=new Array(e+1);for(l=0;l<=e;++l)n[l]=d(i[l])/c;return n};var t=r("robust-linear-solve");function d(m){for(var h=0,e=0;e<m.length;++e)h+=m[e];return h}},{"robust-linear-solve":533}],86:[function(r,I,B){B.byteLength=function(u){var s=l(u),i=s[0],c=s[1];return 3*(i+c)/4-c},B.toByteArray=function(u){var s,i,c=l(u),n=c[0],a=c[1],g=new m(function(v,b,x){return 3*(b+x)/4-x}(0,n,a)),p=0,y=a>0?n-4:n;for(i=0;i<y;i+=4)s=d[u.charCodeAt(i)]<<18|d[u.charCodeAt(i+1)]<<12|d[u.charCodeAt(i+2)]<<6|d[u.charCodeAt(i+3)],g[p++]=s>>16&255,g[p++]=s>>8&255,g[p++]=255&s;return a===2&&(s=d[u.charCodeAt(i)]<<2|d[u.charCodeAt(i+1)]>>4,g[p++]=255&s),a===1&&(s=d[u.charCodeAt(i)]<<10|d[u.charCodeAt(i+1)]<<4|d[u.charCodeAt(i+2)]>>2,g[p++]=s>>8&255,g[p++]=255&s),g},B.fromByteArray=function(u){for(var s,i=u.length,c=i%3,n=[],a=0,g=i-c;a<g;a+=16383)n.push(o(u,a,a+16383>g?g:a+16383));return c===1?(s=u[i-1],n.push(t[s>>2]+t[s<<4&63]+"==")):c===2&&(s=(u[i-2]<<8)+u[i-1],n.push(t[s>>10]+t[s>>4&63]+t[s<<2&63]+"=")),n.join("")};for(var t=[],d=[],m=typeof Uint8Array!="undefined"?Uint8Array:Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,f=h.length;e<f;++e)t[e]=h[e],d[h.charCodeAt(e)]=e;function l(u){var s=u.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=u.indexOf("=");return i===-1&&(i=s),[i,i===s?0:4-i%4]}function o(u,s,i){for(var c,n,a=[],g=s;g<i;g+=3)c=(u[g]<<16&16711680)+(u[g+1]<<8&65280)+(255&u[g+2]),a.push(t[(n=c)>>18&63]+t[n>>12&63]+t[n>>6&63]+t[63&n]);return a.join("")}d["-".charCodeAt(0)]=62,d["_".charCodeAt(0)]=63},{}],87:[function(r,I,B){var t=r("./lib/rationalize");I.exports=function(d,m){return t(d[0].mul(m[1]).add(m[0].mul(d[1])),d[1].mul(m[1]))}},{"./lib/rationalize":97}],88:[function(r,I,B){I.exports=function(t,d){return t[0].mul(d[1]).cmp(d[0].mul(t[1]))}},{}],89:[function(r,I,B){var t=r("./lib/rationalize");I.exports=function(d,m){return t(d[0].mul(m[1]),d[1].mul(m[0]))}},{"./lib/rationalize":97}],90:[function(r,I,B){var t=r("./is-rat"),d=r("./lib/is-bn"),m=r("./lib/num-to-bn"),h=r("./lib/str-to-bn"),e=r("./lib/rationalize"),f=r("./div");I.exports=function l(o,u){if(t(o))return u?f(o,l(u)):[o[0].clone(),o[1].clone()];var s,i,c=0;if(d(o))s=o.clone();else if(typeof o=="string")s=h(o);else{if(o===0)return[m(0),m(1)];if(o===Math.floor(o))s=m(o);else{for(;o!==Math.floor(o);)o*=Math.pow(2,256),c-=256;s=m(o)}}if(t(u))s.mul(u[1]),i=u[0].clone();else if(d(u))i=u.clone();else if(typeof u=="string")i=h(u);else if(u)if(u===Math.floor(u))i=m(u);else{for(;u!==Math.floor(u);)u*=Math.pow(2,256),c+=256;i=m(u)}else i=m(1);return c>0?s=s.ushln(c):c<0&&(i=i.ushln(-c)),e(s,i)}},{"./div":89,"./is-rat":91,"./lib/is-bn":95,"./lib/num-to-bn":96,"./lib/rationalize":97,"./lib/str-to-bn":98}],91:[function(r,I,B){var t=r("./lib/is-bn");I.exports=function(d){return Array.isArray(d)&&d.length===2&&t(d[0])&&t(d[1])}},{"./lib/is-bn":95}],92:[function(r,I,B){var t=r("bn.js");I.exports=function(d){return d.cmp(new t(0))}},{"bn.js":106}],93:[function(r,I,B){var t=r("./bn-sign");I.exports=function(d){var m=d.length,h=d.words,e=0;if(m===1)e=h[0];else if(m===2)e=h[0]+67108864*h[1];else for(var f=0;f<m;f++){var l=h[f];e+=l*Math.pow(67108864,f)}return t(d)*e}},{"./bn-sign":92}],94:[function(r,I,B){var t=r("double-bits"),d=r("bit-twiddle").countTrailingZeros;I.exports=function(m){var h=d(t.lo(m));if(h<32)return h;var e=d(t.hi(m));return e>20?52:e+32}},{"bit-twiddle":104,"double-bits":179}],95:[function(r,I,B){r("bn.js"),I.exports=function(t){return t&&typeof t=="object"&&Boolean(t.words)}},{"bn.js":106}],96:[function(r,I,B){var t=r("bn.js"),d=r("double-bits");I.exports=function(m){var h=d.exponent(m);return h<52?new t(m):new t(m*Math.pow(2,52-h)).ushln(h-52)}},{"bn.js":106,"double-bits":179}],97:[function(r,I,B){var t=r("./num-to-bn"),d=r("./bn-sign");I.exports=function(m,h){var e=d(m),f=d(h);if(e===0)return[t(0),t(1)];if(f===0)return[t(0),t(0)];f<0&&(m=m.neg(),h=h.neg());var l=m.gcd(h);return l.cmpn(1)?[m.div(l),h.div(l)]:[m,h]}},{"./bn-sign":92,"./num-to-bn":96}],98:[function(r,I,B){var t=r("bn.js");I.exports=function(d){return new t(d)}},{"bn.js":106}],99:[function(r,I,B){var t=r("./lib/rationalize");I.exports=function(d,m){return t(d[0].mul(m[0]),d[1].mul(m[1]))}},{"./lib/rationalize":97}],100:[function(r,I,B){var t=r("./lib/bn-sign");I.exports=function(d){return t(d[0])*t(d[1])}},{"./lib/bn-sign":92}],101:[function(r,I,B){var t=r("./lib/rationalize");I.exports=function(d,m){return t(d[0].mul(m[1]).sub(d[1].mul(m[0])),d[1].mul(m[1]))}},{"./lib/rationalize":97}],102:[function(r,I,B){var t=r("./lib/bn-to-num"),d=r("./lib/ctz");I.exports=function(m){var h=m[0],e=m[1];if(h.cmpn(0)===0)return 0;var f=h.abs().divmod(e.abs()),l=f.div,o=t(l),u=f.mod,s=h.negative!==e.negative?-1:1;if(u.cmpn(0)===0)return s*o;if(o){var i=d(o)+4,c=t(u.ushln(i).divRound(e));return s*(o+c*Math.pow(2,-i))}var n=e.bitLength()-u.bitLength()+53;return c=t(u.ushln(n).divRound(e)),n<1023?s*c*Math.pow(2,-n):(c*=Math.pow(2,-1023),s*c*Math.pow(2,1023-n))}},{"./lib/bn-to-num":93,"./lib/ctz":94}],103:[function(r,I,B){function t(l,o,u,s,i){for(var c=i+1;s<=i;){var n=s+i>>>1,a=l[n];(u!==void 0?u(a,o):a-o)>=0?(c=n,i=n-1):s=n+1}return c}function d(l,o,u,s,i){for(var c=i+1;s<=i;){var n=s+i>>>1,a=l[n];(u!==void 0?u(a,o):a-o)>0?(c=n,i=n-1):s=n+1}return c}function m(l,o,u,s,i){for(var c=s-1;s<=i;){var n=s+i>>>1,a=l[n];(u!==void 0?u(a,o):a-o)<0?(c=n,s=n+1):i=n-1}return c}function h(l,o,u,s,i){for(var c=s-1;s<=i;){var n=s+i>>>1,a=l[n];(u!==void 0?u(a,o):a-o)<=0?(c=n,s=n+1):i=n-1}return c}function e(l,o,u,s,i){for(;s<=i;){var c=s+i>>>1,n=l[c],a=u!==void 0?u(n,o):n-o;if(a===0)return c;a<=0?s=c+1:i=c-1}return-1}function f(l,o,u,s,i,c){return typeof u=="function"?c(l,o,u,s===void 0?0:0|s,i===void 0?l.length-1:0|i):c(l,o,void 0,u===void 0?0:0|u,s===void 0?l.length-1:0|s)}I.exports={ge:function(l,o,u,s,i){return f(l,o,u,s,i,t)},gt:function(l,o,u,s,i){return f(l,o,u,s,i,d)},lt:function(l,o,u,s,i){return f(l,o,u,s,i,m)},le:function(l,o,u,s,i){return f(l,o,u,s,i,h)},eq:function(l,o,u,s,i){return f(l,o,u,s,i,e)}}},{}],104:[function(r,I,B){function t(m){var h=32;return(m&=-m)&&h--,65535&m&&(h-=16),16711935&m&&(h-=8),252645135&m&&(h-=4),858993459&m&&(h-=2),1431655765&m&&(h-=1),h}B.INT_BITS=32,B.INT_MAX=2147483647,B.INT_MIN=-1<<31,B.sign=function(m){return(m>0)-(m<0)},B.abs=function(m){var h=m>>31;return(m^h)-h},B.min=function(m,h){return h^(m^h)&-(m<h)},B.max=function(m,h){return m^(m^h)&-(m<h)},B.isPow2=function(m){return!(m&m-1||!m)},B.log2=function(m){var h,e;return h=(m>65535)<<4,h|=e=((m>>>=h)>255)<<3,h|=e=((m>>>=e)>15)<<2,(h|=e=((m>>>=e)>3)<<1)|(m>>>=e)>>1},B.log10=function(m){return m>=1e9?9:m>=1e8?8:m>=1e7?7:m>=1e6?6:m>=1e5?5:m>=1e4?4:m>=1e3?3:m>=100?2:m>=10?1:0},B.popCount=function(m){return 16843009*((m=(858993459&(m-=m>>>1&1431655765))+(m>>>2&858993459))+(m>>>4)&252645135)>>>24},B.countTrailingZeros=t,B.nextPow2=function(m){return m+=m===0,--m,m|=m>>>1,m|=m>>>2,m|=m>>>4,m|=m>>>8,(m|=m>>>16)+1},B.prevPow2=function(m){return m|=m>>>1,m|=m>>>2,m|=m>>>4,m|=m>>>8,(m|=m>>>16)-(m>>>1)},B.parity=function(m){return m^=m>>>16,m^=m>>>8,m^=m>>>4,27030>>>(m&=15)&1};var d=new Array(256);(function(m){for(var h=0;h<256;++h){var e=h,f=h,l=7;for(e>>>=1;e;e>>>=1)f<<=1,f|=1&e,--l;m[h]=f<<l&255}})(d),B.reverse=function(m){return d[255&m]<<24|d[m>>>8&255]<<16|d[m>>>16&255]<<8|d[m>>>24&255]},B.interleave2=function(m,h){return(m=1431655765&((m=858993459&((m=252645135&((m=16711935&((m&=65535)|m<<8))|m<<4))|m<<2))|m<<1))|(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h&=65535)|h<<8))|h<<4))|h<<2))|h<<1))<<1},B.deinterleave2=function(m,h){return(m=65535&((m=16711935&((m=252645135&((m=858993459&((m=m>>>h&1431655765)|m>>>1))|m>>>2))|m>>>4))|m>>>16))<<16>>16},B.interleave3=function(m,h,e){return m=1227133513&((m=3272356035&((m=251719695&((m=4278190335&((m&=1023)|m<<16))|m<<8))|m<<4))|m<<2),(m|=(h=1227133513&((h=3272356035&((h=251719695&((h=4278190335&((h&=1023)|h<<16))|h<<8))|h<<4))|h<<2))<<1)|(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<2},B.deinterleave3=function(m,h){return(m=1023&((m=4278190335&((m=251719695&((m=3272356035&((m=m>>>h&1227133513)|m>>>2))|m>>>4))|m>>>8))|m>>>16))<<22>>22},B.nextCombination=function(m){var h=m|m-1;return h+1|(~h&-~h)-1>>>t(m)+1}},{}],105:[function(r,I,B){var t=r("clamp");I.exports=function(e,f){f||(f={});var l,o,u,s,i,c,n,a,g,p,y,v=f.cutoff==null?.25:f.cutoff,b=f.radius==null?8:f.radius,x=f.channel||0;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!f.width||!f.height)throw Error("For raw data width and height should be provided by options");l=f.width,o=f.height,s=e,c=f.stride?f.stride:Math.floor(e.length/l/o)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(n=(a=e).getContext("2d"),l=a.width,o=a.height,g=n.getImageData(0,0,l,o),s=g.data,c=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(a=e.canvas,n=e,l=a.width,o=a.height,g=n.getImageData(0,0,l,o),s=g.data,c=4):window.ImageData&&e instanceof window.ImageData&&(g=e,l=e.width,o=e.height,s=g.data,c=4);if(u=Math.max(l,o),window.Uint8ClampedArray&&s instanceof window.Uint8ClampedArray||window.Uint8Array&&s instanceof window.Uint8Array)for(i=s,s=Array(l*o),p=0,y=i.length;p<y;p++)s[p]=i[p*c+x]/255;else if(c!==1)throw Error("Raw data can have only 1 value per pixel");var T=Array(l*o),A=Array(l*o),S=Array(u),w=Array(u),E=Array(u+1),k=Array(u);for(p=0,y=l*o;p<y;p++){var L=s[p];T[p]=L===1?0:L===0?d:Math.pow(Math.max(0,.5-L),2),A[p]=L===1?d:L===0?0:Math.pow(Math.max(0,L-.5),2)}m(T,l,o,S,w,k,E),m(A,l,o,S,w,k,E);var M=window.Float32Array?new Float32Array(l*o):new Array(l*o);for(p=0,y=l*o;p<y;p++)M[p]=t(1-((T[p]-A[p])/b+v),0,1);return M};var d=1e20;function m(e,f,l,o,u,s,i){for(var c=0;c<f;c++){for(var n=0;n<l;n++)o[n]=e[n*f+c];for(h(o,u,s,i,l),n=0;n<l;n++)e[n*f+c]=u[n]}for(n=0;n<l;n++){for(c=0;c<f;c++)o[c]=e[n*f+c];for(h(o,u,s,i,f),c=0;c<f;c++)e[n*f+c]=Math.sqrt(u[c])}}function h(e,f,l,o,u){l[0]=0,o[0]=-d,o[1]=+d;for(var s=1,i=0;s<u;s++){for(var c=(e[s]+s*s-(e[l[i]]+l[i]*l[i]))/(2*s-2*l[i]);c<=o[i];)i--,c=(e[s]+s*s-(e[l[i]]+l[i]*l[i]))/(2*s-2*l[i]);l[++i]=s,o[i]=c,o[i+1]=+d}for(s=0,i=0;s<u;s++){for(;o[i+1]<s;)i++;f[s]=(s-l[i])*(s-l[i])+e[l[i]]}}},{clamp:126}],106:[function(r,I,B){(function(t,d){function m(w,E){if(!w)throw new Error(E||"Assertion failed")}function h(w,E){w.super_=E;var k=function(){};k.prototype=E.prototype,w.prototype=new k,w.prototype.constructor=w}function e(w,E,k){if(e.isBN(w))return w;this.negative=0,this.words=null,this.length=0,this.red=null,w!==null&&(E!=="le"&&E!=="be"||(k=E,E=10),this._init(w||0,E||10,k||"be"))}var f;typeof t=="object"?t.exports=e:d.BN=e,e.BN=e,e.wordSize=26;try{f=r("buffer").Buffer}catch(w){}function l(w,E,k){for(var L=0,M=Math.min(w.length,k),P=E;P<M;P++){var D=w.charCodeAt(P)-48;L<<=4,L|=D>=49&&D<=54?D-49+10:D>=17&&D<=22?D-17+10:15&D}return L}function o(w,E,k,L){for(var M=0,P=Math.min(w.length,k),D=E;D<P;D++){var N=w.charCodeAt(D)-48;M*=L,M+=N>=49?N-49+10:N>=17?N-17+10:N}return M}e.isBN=function(w){return w instanceof e||w!==null&&typeof w=="object"&&w.constructor.wordSize===e.wordSize&&Array.isArray(w.words)},e.max=function(w,E){return w.cmp(E)>0?w:E},e.min=function(w,E){return w.cmp(E)<0?w:E},e.prototype._init=function(w,E,k){if(typeof w=="number")return this._initNumber(w,E,k);if(typeof w=="object")return this._initArray(w,E,k);E==="hex"&&(E=16),m(E===(0|E)&&E>=2&&E<=36);var L=0;(w=w.toString().replace(/\s+/g,""))[0]==="-"&&L++,E===16?this._parseHex(w,L):this._parseBase(w,E,L),w[0]==="-"&&(this.negative=1),this.strip(),k==="le"&&this._initArray(this.toArray(),E,k)},e.prototype._initNumber=function(w,E,k){w<0&&(this.negative=1,w=-w),w<67108864?(this.words=[67108863&w],this.length=1):w<4503599627370496?(this.words=[67108863&w,w/67108864&67108863],this.length=2):(m(w<9007199254740992),this.words=[67108863&w,w/67108864&67108863,1],this.length=3),k==="le"&&this._initArray(this.toArray(),E,k)},e.prototype._initArray=function(w,E,k){if(m(typeof w.length=="number"),w.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(w.length/3),this.words=new Array(this.length);for(var L=0;L<this.length;L++)this.words[L]=0;var M,P,D=0;if(k==="be")for(L=w.length-1,M=0;L>=0;L-=3)P=w[L]|w[L-1]<<8|w[L-2]<<16,this.words[M]|=P<<D&67108863,this.words[M+1]=P>>>26-D&67108863,(D+=24)>=26&&(D-=26,M++);else if(k==="le")for(L=0,M=0;L<w.length;L+=3)P=w[L]|w[L+1]<<8|w[L+2]<<16,this.words[M]|=P<<D&67108863,this.words[M+1]=P>>>26-D&67108863,(D+=24)>=26&&(D-=26,M++);return this.strip()},e.prototype._parseHex=function(w,E){this.length=Math.ceil((w.length-E)/6),this.words=new Array(this.length);for(var k=0;k<this.length;k++)this.words[k]=0;var L,M,P=0;for(k=w.length-6,L=0;k>=E;k-=6)M=l(w,k,k+6),this.words[L]|=M<<P&67108863,this.words[L+1]|=M>>>26-P&4194303,(P+=24)>=26&&(P-=26,L++);k+6!==E&&(M=l(w,E,k+6),this.words[L]|=M<<P&67108863,this.words[L+1]|=M>>>26-P&4194303),this.strip()},e.prototype._parseBase=function(w,E,k){this.words=[0],this.length=1;for(var L=0,M=1;M<=67108863;M*=E)L++;L--,M=M/E|0;for(var P=w.length-k,D=P%L,N=Math.min(P,P-D)+k,U=0,G=k;G<N;G+=L)U=o(w,G,G+L,E),this.imuln(M),this.words[0]+U<67108864?this.words[0]+=U:this._iaddn(U);if(D!==0){var X=1;for(U=o(w,G,w.length,E),G=0;G<D;G++)X*=E;this.imuln(X),this.words[0]+U<67108864?this.words[0]+=U:this._iaddn(U)}},e.prototype.copy=function(w){w.words=new Array(this.length);for(var E=0;E<this.length;E++)w.words[E]=this.words[E];w.length=this.length,w.negative=this.negative,w.red=this.red},e.prototype.clone=function(){var w=new e(null);return this.copy(w),w},e.prototype._expand=function(w){for(;this.length<w;)this.words[this.length++]=0;return this},e.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},e.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},e.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],s=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],i=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function c(w,E,k){k.negative=E.negative^w.negative;var L=w.length+E.length|0;k.length=L,L=L-1|0;var M=0|w.words[0],P=0|E.words[0],D=M*P,N=67108863&D,U=D/67108864|0;k.words[0]=N;for(var G=1;G<L;G++){for(var X=U>>>26,K=67108863&U,Z=Math.min(G,E.length-1),H=Math.max(0,G-w.length+1);H<=Z;H++){var Y=G-H|0;X+=(D=(M=0|w.words[Y])*(P=0|E.words[H])+K)/67108864|0,K=67108863&D}k.words[G]=0|K,U=0|X}return U!==0?k.words[G]=0|U:k.length--,k.strip()}e.prototype.toString=function(w,E){var k;if(E=0|E||1,(w=w||10)===16||w==="hex"){k="";for(var L=0,M=0,P=0;P<this.length;P++){var D=this.words[P],N=(16777215&(D<<L|M)).toString(16);k=(M=D>>>24-L&16777215)!=0||P!==this.length-1?u[6-N.length]+N+k:N+k,(L+=2)>=26&&(L-=26,P--)}for(M!==0&&(k=M.toString(16)+k);k.length%E!=0;)k="0"+k;return this.negative!==0&&(k="-"+k),k}if(w===(0|w)&&w>=2&&w<=36){var U=s[w],G=i[w];k="";var X=this.clone();for(X.negative=0;!X.isZero();){var K=X.modn(G).toString(w);k=(X=X.idivn(G)).isZero()?K+k:u[U-K.length]+K+k}for(this.isZero()&&(k="0"+k);k.length%E!=0;)k="0"+k;return this.negative!==0&&(k="-"+k),k}m(!1,"Base should be between 2 and 36")},e.prototype.toNumber=function(){var w=this.words[0];return this.length===2?w+=67108864*this.words[1]:this.length===3&&this.words[2]===1?w+=4503599627370496+67108864*this.words[1]:this.length>2&&m(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-w:w},e.prototype.toJSON=function(){return this.toString(16)},e.prototype.toBuffer=function(w,E){return m(f!==void 0),this.toArrayLike(f,w,E)},e.prototype.toArray=function(w,E){return this.toArrayLike(Array,w,E)},e.prototype.toArrayLike=function(w,E,k){var L=this.byteLength(),M=k||Math.max(1,L);m(L<=M,"byte array longer than desired length"),m(M>0,"Requested array length <= 0"),this.strip();var P,D,N=E==="le",U=new w(M),G=this.clone();if(N){for(D=0;!G.isZero();D++)P=G.andln(255),G.iushrn(8),U[D]=P;for(;D<M;D++)U[D]=0}else{for(D=0;D<M-L;D++)U[D]=0;for(D=0;!G.isZero();D++)P=G.andln(255),G.iushrn(8),U[M-D-1]=P}return U},Math.clz32?e.prototype._countBits=function(w){return 32-Math.clz32(w)}:e.prototype._countBits=function(w){var E=w,k=0;return E>=4096&&(k+=13,E>>>=13),E>=64&&(k+=7,E>>>=7),E>=8&&(k+=4,E>>>=4),E>=2&&(k+=2,E>>>=2),k+E},e.prototype._zeroBits=function(w){if(w===0)return 26;var E=w,k=0;return(8191&E)==0&&(k+=13,E>>>=13),(127&E)==0&&(k+=7,E>>>=7),(15&E)==0&&(k+=4,E>>>=4),(3&E)==0&&(k+=2,E>>>=2),(1&E)==0&&k++,k},e.prototype.bitLength=function(){var w=this.words[this.length-1],E=this._countBits(w);return 26*(this.length-1)+E},e.prototype.zeroBits=function(){if(this.isZero())return 0;for(var w=0,E=0;E<this.length;E++){var k=this._zeroBits(this.words[E]);if(w+=k,k!==26)break}return w},e.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},e.prototype.toTwos=function(w){return this.negative!==0?this.abs().inotn(w).iaddn(1):this.clone()},e.prototype.fromTwos=function(w){return this.testn(w-1)?this.notn(w).iaddn(1).ineg():this.clone()},e.prototype.isNeg=function(){return this.negative!==0},e.prototype.neg=function(){return this.clone().ineg()},e.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},e.prototype.iuor=function(w){for(;this.length<w.length;)this.words[this.length++]=0;for(var E=0;E<w.length;E++)this.words[E]=this.words[E]|w.words[E];return this.strip()},e.prototype.ior=function(w){return m((this.negative|w.negative)==0),this.iuor(w)},e.prototype.or=function(w){return this.length>w.length?this.clone().ior(w):w.clone().ior(this)},e.prototype.uor=function(w){return this.length>w.length?this.clone().iuor(w):w.clone().iuor(this)},e.prototype.iuand=function(w){var E;E=this.length>w.length?w:this;for(var k=0;k<E.length;k++)this.words[k]=this.words[k]&w.words[k];return this.length=E.length,this.strip()},e.prototype.iand=function(w){return m((this.negative|w.negative)==0),this.iuand(w)},e.prototype.and=function(w){return this.length>w.length?this.clone().iand(w):w.clone().iand(this)},e.prototype.uand=function(w){return this.length>w.length?this.clone().iuand(w):w.clone().iuand(this)},e.prototype.iuxor=function(w){var E,k;this.length>w.length?(E=this,k=w):(E=w,k=this);for(var L=0;L<k.length;L++)this.words[L]=E.words[L]^k.words[L];if(this!==E)for(;L<E.length;L++)this.words[L]=E.words[L];return this.length=E.length,this.strip()},e.prototype.ixor=function(w){return m((this.negative|w.negative)==0),this.iuxor(w)},e.prototype.xor=function(w){return this.length>w.length?this.clone().ixor(w):w.clone().ixor(this)},e.prototype.uxor=function(w){return this.length>w.length?this.clone().iuxor(w):w.clone().iuxor(this)},e.prototype.inotn=function(w){m(typeof w=="number"&&w>=0);var E=0|Math.ceil(w/26),k=w%26;this._expand(E),k>0&&E--;for(var L=0;L<E;L++)this.words[L]=67108863&~this.words[L];return k>0&&(this.words[L]=~this.words[L]&67108863>>26-k),this.strip()},e.prototype.notn=function(w){return this.clone().inotn(w)},e.prototype.setn=function(w,E){m(typeof w=="number"&&w>=0);var k=w/26|0,L=w%26;return this._expand(k+1),this.words[k]=E?this.words[k]|1<<L:this.words[k]&~(1<<L),this.strip()},e.prototype.iadd=function(w){var E,k,L;if(this.negative!==0&&w.negative===0)return this.negative=0,E=this.isub(w),this.negative^=1,this._normSign();if(this.negative===0&&w.negative!==0)return w.negative=0,E=this.isub(w),w.negative=1,E._normSign();this.length>w.length?(k=this,L=w):(k=w,L=this);for(var M=0,P=0;P<L.length;P++)E=(0|k.words[P])+(0|L.words[P])+M,this.words[P]=67108863&E,M=E>>>26;for(;M!==0&&P<k.length;P++)E=(0|k.words[P])+M,this.words[P]=67108863&E,M=E>>>26;if(this.length=k.length,M!==0)this.words[this.length]=M,this.length++;else if(k!==this)for(;P<k.length;P++)this.words[P]=k.words[P];return this},e.prototype.add=function(w){var E;return w.negative!==0&&this.negative===0?(w.negative=0,E=this.sub(w),w.negative^=1,E):w.negative===0&&this.negative!==0?(this.negative=0,E=w.sub(this),this.negative=1,E):this.length>w.length?this.clone().iadd(w):w.clone().iadd(this)},e.prototype.isub=function(w){if(w.negative!==0){w.negative=0;var E=this.iadd(w);return w.negative=1,E._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(w),this.negative=1,this._normSign();var k,L,M=this.cmp(w);if(M===0)return this.negative=0,this.length=1,this.words[0]=0,this;M>0?(k=this,L=w):(k=w,L=this);for(var P=0,D=0;D<L.length;D++)P=(E=(0|k.words[D])-(0|L.words[D])+P)>>26,this.words[D]=67108863&E;for(;P!==0&&D<k.length;D++)P=(E=(0|k.words[D])+P)>>26,this.words[D]=67108863&E;if(P===0&&D<k.length&&k!==this)for(;D<k.length;D++)this.words[D]=k.words[D];return this.length=Math.max(this.length,D),k!==this&&(this.negative=1),this.strip()},e.prototype.sub=function(w){return this.clone().isub(w)};var n=function(w,E,k){var L,M,P,D=w.words,N=E.words,U=k.words,G=0,X=0|D[0],K=8191&X,Z=X>>>13,H=0|D[1],Y=8191&H,$=H>>>13,z=0|D[2],j=8191&z,W=z>>>13,ee=0|D[3],J=8191&ee,Q=ee>>>13,te=0|D[4],ie=8191&te,ae=te>>>13,he=0|D[5],se=8191&he,de=he>>>13,ue=0|D[6],ve=8191&ue,ke=ue>>>13,Ee=0|D[7],be=8191&Ee,xe=Ee>>>13,ce=0|D[8],ge=8191&ce,we=ce>>>13,Me=0|D[9],Se=8191&Me,ze=Me>>>13,Fe=0|N[0],Ye=8191&Fe,rt=Fe>>>13,Oe=0|N[1],je=8191&Oe,We=Oe>>>13,qe=0|N[2],et=8191&qe,st=qe>>>13,ct=0|N[3],Pt=8191&ct,kt=ct>>>13,at=0|N[4],tt=8191&at,_t=at>>>13,er=0|N[5],tr=8191&er,Ue=er>>>13,He=0|N[6],Be=8191&He,Ke=He>>>13,_e=0|N[7],Ce=8191&_e,Le=_e>>>13,Pe=0|N[8],Xe=8191&Pe,ht=Pe>>>13,Mt=0|N[9],pt=8191&Mt,Lt=Mt>>>13;k.negative=w.negative^E.negative,k.length=19;var vt=(G+(L=Math.imul(K,Ye))|0)+((8191&(M=(M=Math.imul(K,rt))+Math.imul(Z,Ye)|0))<<13)|0;G=((P=Math.imul(Z,rt))+(M>>>13)|0)+(vt>>>26)|0,vt&=67108863,L=Math.imul(Y,Ye),M=(M=Math.imul(Y,rt))+Math.imul($,Ye)|0,P=Math.imul($,rt);var Dt=(G+(L=L+Math.imul(K,je)|0)|0)+((8191&(M=(M=M+Math.imul(K,We)|0)+Math.imul(Z,je)|0))<<13)|0;G=((P=P+Math.imul(Z,We)|0)+(M>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,L=Math.imul(j,Ye),M=(M=Math.imul(j,rt))+Math.imul(W,Ye)|0,P=Math.imul(W,rt),L=L+Math.imul(Y,je)|0,M=(M=M+Math.imul(Y,We)|0)+Math.imul($,je)|0,P=P+Math.imul($,We)|0;var xt=(G+(L=L+Math.imul(K,et)|0)|0)+((8191&(M=(M=M+Math.imul(K,st)|0)+Math.imul(Z,et)|0))<<13)|0;G=((P=P+Math.imul(Z,st)|0)+(M>>>13)|0)+(xt>>>26)|0,xt&=67108863,L=Math.imul(J,Ye),M=(M=Math.imul(J,rt))+Math.imul(Q,Ye)|0,P=Math.imul(Q,rt),L=L+Math.imul(j,je)|0,M=(M=M+Math.imul(j,We)|0)+Math.imul(W,je)|0,P=P+Math.imul(W,We)|0,L=L+Math.imul(Y,et)|0,M=(M=M+Math.imul(Y,st)|0)+Math.imul($,et)|0,P=P+Math.imul($,st)|0;var it=(G+(L=L+Math.imul(K,Pt)|0)|0)+((8191&(M=(M=M+Math.imul(K,kt)|0)+Math.imul(Z,Pt)|0))<<13)|0;G=((P=P+Math.imul(Z,kt)|0)+(M>>>13)|0)+(it>>>26)|0,it&=67108863,L=Math.imul(ie,Ye),M=(M=Math.imul(ie,rt))+Math.imul(ae,Ye)|0,P=Math.imul(ae,rt),L=L+Math.imul(J,je)|0,M=(M=M+Math.imul(J,We)|0)+Math.imul(Q,je)|0,P=P+Math.imul(Q,We)|0,L=L+Math.imul(j,et)|0,M=(M=M+Math.imul(j,st)|0)+Math.imul(W,et)|0,P=P+Math.imul(W,st)|0,L=L+Math.imul(Y,Pt)|0,M=(M=M+Math.imul(Y,kt)|0)+Math.imul($,Pt)|0,P=P+Math.imul($,kt)|0;var St=(G+(L=L+Math.imul(K,tt)|0)|0)+((8191&(M=(M=M+Math.imul(K,_t)|0)+Math.imul(Z,tt)|0))<<13)|0;G=((P=P+Math.imul(Z,_t)|0)+(M>>>13)|0)+(St>>>26)|0,St&=67108863,L=Math.imul(se,Ye),M=(M=Math.imul(se,rt))+Math.imul(de,Ye)|0,P=Math.imul(de,rt),L=L+Math.imul(ie,je)|0,M=(M=M+Math.imul(ie,We)|0)+Math.imul(ae,je)|0,P=P+Math.imul(ae,We)|0,L=L+Math.imul(J,et)|0,M=(M=M+Math.imul(J,st)|0)+Math.imul(Q,et)|0,P=P+Math.imul(Q,st)|0,L=L+Math.imul(j,Pt)|0,M=(M=M+Math.imul(j,kt)|0)+Math.imul(W,Pt)|0,P=P+Math.imul(W,kt)|0,L=L+Math.imul(Y,tt)|0,M=(M=M+Math.imul(Y,_t)|0)+Math.imul($,tt)|0,P=P+Math.imul($,_t)|0;var Nt=(G+(L=L+Math.imul(K,tr)|0)|0)+((8191&(M=(M=M+Math.imul(K,Ue)|0)+Math.imul(Z,tr)|0))<<13)|0;G=((P=P+Math.imul(Z,Ue)|0)+(M>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,L=Math.imul(ve,Ye),M=(M=Math.imul(ve,rt))+Math.imul(ke,Ye)|0,P=Math.imul(ke,rt),L=L+Math.imul(se,je)|0,M=(M=M+Math.imul(se,We)|0)+Math.imul(de,je)|0,P=P+Math.imul(de,We)|0,L=L+Math.imul(ie,et)|0,M=(M=M+Math.imul(ie,st)|0)+Math.imul(ae,et)|0,P=P+Math.imul(ae,st)|0,L=L+Math.imul(J,Pt)|0,M=(M=M+Math.imul(J,kt)|0)+Math.imul(Q,Pt)|0,P=P+Math.imul(Q,kt)|0,L=L+Math.imul(j,tt)|0,M=(M=M+Math.imul(j,_t)|0)+Math.imul(W,tt)|0,P=P+Math.imul(W,_t)|0,L=L+Math.imul(Y,tr)|0,M=(M=M+Math.imul(Y,Ue)|0)+Math.imul($,tr)|0,P=P+Math.imul($,Ue)|0;var Ut=(G+(L=L+Math.imul(K,Be)|0)|0)+((8191&(M=(M=M+Math.imul(K,Ke)|0)+Math.imul(Z,Be)|0))<<13)|0;G=((P=P+Math.imul(Z,Ke)|0)+(M>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,L=Math.imul(be,Ye),M=(M=Math.imul(be,rt))+Math.imul(xe,Ye)|0,P=Math.imul(xe,rt),L=L+Math.imul(ve,je)|0,M=(M=M+Math.imul(ve,We)|0)+Math.imul(ke,je)|0,P=P+Math.imul(ke,We)|0,L=L+Math.imul(se,et)|0,M=(M=M+Math.imul(se,st)|0)+Math.imul(de,et)|0,P=P+Math.imul(de,st)|0,L=L+Math.imul(ie,Pt)|0,M=(M=M+Math.imul(ie,kt)|0)+Math.imul(ae,Pt)|0,P=P+Math.imul(ae,kt)|0,L=L+Math.imul(J,tt)|0,M=(M=M+Math.imul(J,_t)|0)+Math.imul(Q,tt)|0,P=P+Math.imul(Q,_t)|0,L=L+Math.imul(j,tr)|0,M=(M=M+Math.imul(j,Ue)|0)+Math.imul(W,tr)|0,P=P+Math.imul(W,Ue)|0,L=L+Math.imul(Y,Be)|0,M=(M=M+Math.imul(Y,Ke)|0)+Math.imul($,Be)|0,P=P+Math.imul($,Ke)|0;var Qt=(G+(L=L+Math.imul(K,Ce)|0)|0)+((8191&(M=(M=M+Math.imul(K,Le)|0)+Math.imul(Z,Ce)|0))<<13)|0;G=((P=P+Math.imul(Z,Le)|0)+(M>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,L=Math.imul(ge,Ye),M=(M=Math.imul(ge,rt))+Math.imul(we,Ye)|0,P=Math.imul(we,rt),L=L+Math.imul(be,je)|0,M=(M=M+Math.imul(be,We)|0)+Math.imul(xe,je)|0,P=P+Math.imul(xe,We)|0,L=L+Math.imul(ve,et)|0,M=(M=M+Math.imul(ve,st)|0)+Math.imul(ke,et)|0,P=P+Math.imul(ke,st)|0,L=L+Math.imul(se,Pt)|0,M=(M=M+Math.imul(se,kt)|0)+Math.imul(de,Pt)|0,P=P+Math.imul(de,kt)|0,L=L+Math.imul(ie,tt)|0,M=(M=M+Math.imul(ie,_t)|0)+Math.imul(ae,tt)|0,P=P+Math.imul(ae,_t)|0,L=L+Math.imul(J,tr)|0,M=(M=M+Math.imul(J,Ue)|0)+Math.imul(Q,tr)|0,P=P+Math.imul(Q,Ue)|0,L=L+Math.imul(j,Be)|0,M=(M=M+Math.imul(j,Ke)|0)+Math.imul(W,Be)|0,P=P+Math.imul(W,Ke)|0,L=L+Math.imul(Y,Ce)|0,M=(M=M+Math.imul(Y,Le)|0)+Math.imul($,Ce)|0,P=P+Math.imul($,Le)|0;var Ie=(G+(L=L+Math.imul(K,Xe)|0)|0)+((8191&(M=(M=M+Math.imul(K,ht)|0)+Math.imul(Z,Xe)|0))<<13)|0;G=((P=P+Math.imul(Z,ht)|0)+(M>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,L=Math.imul(Se,Ye),M=(M=Math.imul(Se,rt))+Math.imul(ze,Ye)|0,P=Math.imul(ze,rt),L=L+Math.imul(ge,je)|0,M=(M=M+Math.imul(ge,We)|0)+Math.imul(we,je)|0,P=P+Math.imul(we,We)|0,L=L+Math.imul(be,et)|0,M=(M=M+Math.imul(be,st)|0)+Math.imul(xe,et)|0,P=P+Math.imul(xe,st)|0,L=L+Math.imul(ve,Pt)|0,M=(M=M+Math.imul(ve,kt)|0)+Math.imul(ke,Pt)|0,P=P+Math.imul(ke,kt)|0,L=L+Math.imul(se,tt)|0,M=(M=M+Math.imul(se,_t)|0)+Math.imul(de,tt)|0,P=P+Math.imul(de,_t)|0,L=L+Math.imul(ie,tr)|0,M=(M=M+Math.imul(ie,Ue)|0)+Math.imul(ae,tr)|0,P=P+Math.imul(ae,Ue)|0,L=L+Math.imul(J,Be)|0,M=(M=M+Math.imul(J,Ke)|0)+Math.imul(Q,Be)|0,P=P+Math.imul(Q,Ke)|0,L=L+Math.imul(j,Ce)|0,M=(M=M+Math.imul(j,Le)|0)+Math.imul(W,Ce)|0,P=P+Math.imul(W,Le)|0,L=L+Math.imul(Y,Xe)|0,M=(M=M+Math.imul(Y,ht)|0)+Math.imul($,Xe)|0,P=P+Math.imul($,ht)|0;var lt=(G+(L=L+Math.imul(K,pt)|0)|0)+((8191&(M=(M=M+Math.imul(K,Lt)|0)+Math.imul(Z,pt)|0))<<13)|0;G=((P=P+Math.imul(Z,Lt)|0)+(M>>>13)|0)+(lt>>>26)|0,lt&=67108863,L=Math.imul(Se,je),M=(M=Math.imul(Se,We))+Math.imul(ze,je)|0,P=Math.imul(ze,We),L=L+Math.imul(ge,et)|0,M=(M=M+Math.imul(ge,st)|0)+Math.imul(we,et)|0,P=P+Math.imul(we,st)|0,L=L+Math.imul(be,Pt)|0,M=(M=M+Math.imul(be,kt)|0)+Math.imul(xe,Pt)|0,P=P+Math.imul(xe,kt)|0,L=L+Math.imul(ve,tt)|0,M=(M=M+Math.imul(ve,_t)|0)+Math.imul(ke,tt)|0,P=P+Math.imul(ke,_t)|0,L=L+Math.imul(se,tr)|0,M=(M=M+Math.imul(se,Ue)|0)+Math.imul(de,tr)|0,P=P+Math.imul(de,Ue)|0,L=L+Math.imul(ie,Be)|0,M=(M=M+Math.imul(ie,Ke)|0)+Math.imul(ae,Be)|0,P=P+Math.imul(ae,Ke)|0,L=L+Math.imul(J,Ce)|0,M=(M=M+Math.imul(J,Le)|0)+Math.imul(Q,Ce)|0,P=P+Math.imul(Q,Le)|0,L=L+Math.imul(j,Xe)|0,M=(M=M+Math.imul(j,ht)|0)+Math.imul(W,Xe)|0,P=P+Math.imul(W,ht)|0;var wt=(G+(L=L+Math.imul(Y,pt)|0)|0)+((8191&(M=(M=M+Math.imul(Y,Lt)|0)+Math.imul($,pt)|0))<<13)|0;G=((P=P+Math.imul($,Lt)|0)+(M>>>13)|0)+(wt>>>26)|0,wt&=67108863,L=Math.imul(Se,et),M=(M=Math.imul(Se,st))+Math.imul(ze,et)|0,P=Math.imul(ze,st),L=L+Math.imul(ge,Pt)|0,M=(M=M+Math.imul(ge,kt)|0)+Math.imul(we,Pt)|0,P=P+Math.imul(we,kt)|0,L=L+Math.imul(be,tt)|0,M=(M=M+Math.imul(be,_t)|0)+Math.imul(xe,tt)|0,P=P+Math.imul(xe,_t)|0,L=L+Math.imul(ve,tr)|0,M=(M=M+Math.imul(ve,Ue)|0)+Math.imul(ke,tr)|0,P=P+Math.imul(ke,Ue)|0,L=L+Math.imul(se,Be)|0,M=(M=M+Math.imul(se,Ke)|0)+Math.imul(de,Be)|0,P=P+Math.imul(de,Ke)|0,L=L+Math.imul(ie,Ce)|0,M=(M=M+Math.imul(ie,Le)|0)+Math.imul(ae,Ce)|0,P=P+Math.imul(ae,Le)|0,L=L+Math.imul(J,Xe)|0,M=(M=M+Math.imul(J,ht)|0)+Math.imul(Q,Xe)|0,P=P+Math.imul(Q,ht)|0;var Ot=(G+(L=L+Math.imul(j,pt)|0)|0)+((8191&(M=(M=M+Math.imul(j,Lt)|0)+Math.imul(W,pt)|0))<<13)|0;G=((P=P+Math.imul(W,Lt)|0)+(M>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,L=Math.imul(Se,Pt),M=(M=Math.imul(Se,kt))+Math.imul(ze,Pt)|0,P=Math.imul(ze,kt),L=L+Math.imul(ge,tt)|0,M=(M=M+Math.imul(ge,_t)|0)+Math.imul(we,tt)|0,P=P+Math.imul(we,_t)|0,L=L+Math.imul(be,tr)|0,M=(M=M+Math.imul(be,Ue)|0)+Math.imul(xe,tr)|0,P=P+Math.imul(xe,Ue)|0,L=L+Math.imul(ve,Be)|0,M=(M=M+Math.imul(ve,Ke)|0)+Math.imul(ke,Be)|0,P=P+Math.imul(ke,Ke)|0,L=L+Math.imul(se,Ce)|0,M=(M=M+Math.imul(se,Le)|0)+Math.imul(de,Ce)|0,P=P+Math.imul(de,Le)|0,L=L+Math.imul(ie,Xe)|0,M=(M=M+Math.imul(ie,ht)|0)+Math.imul(ae,Xe)|0,P=P+Math.imul(ae,ht)|0;var Gt=(G+(L=L+Math.imul(J,pt)|0)|0)+((8191&(M=(M=M+Math.imul(J,Lt)|0)+Math.imul(Q,pt)|0))<<13)|0;G=((P=P+Math.imul(Q,Lt)|0)+(M>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,L=Math.imul(Se,tt),M=(M=Math.imul(Se,_t))+Math.imul(ze,tt)|0,P=Math.imul(ze,_t),L=L+Math.imul(ge,tr)|0,M=(M=M+Math.imul(ge,Ue)|0)+Math.imul(we,tr)|0,P=P+Math.imul(we,Ue)|0,L=L+Math.imul(be,Be)|0,M=(M=M+Math.imul(be,Ke)|0)+Math.imul(xe,Be)|0,P=P+Math.imul(xe,Ke)|0,L=L+Math.imul(ve,Ce)|0,M=(M=M+Math.imul(ve,Le)|0)+Math.imul(ke,Ce)|0,P=P+Math.imul(ke,Le)|0,L=L+Math.imul(se,Xe)|0,M=(M=M+Math.imul(se,ht)|0)+Math.imul(de,Xe)|0,P=P+Math.imul(de,ht)|0;var ir=(G+(L=L+Math.imul(ie,pt)|0)|0)+((8191&(M=(M=M+Math.imul(ie,Lt)|0)+Math.imul(ae,pt)|0))<<13)|0;G=((P=P+Math.imul(ae,Lt)|0)+(M>>>13)|0)+(ir>>>26)|0,ir&=67108863,L=Math.imul(Se,tr),M=(M=Math.imul(Se,Ue))+Math.imul(ze,tr)|0,P=Math.imul(ze,Ue),L=L+Math.imul(ge,Be)|0,M=(M=M+Math.imul(ge,Ke)|0)+Math.imul(we,Be)|0,P=P+Math.imul(we,Ke)|0,L=L+Math.imul(be,Ce)|0,M=(M=M+Math.imul(be,Le)|0)+Math.imul(xe,Ce)|0,P=P+Math.imul(xe,Le)|0,L=L+Math.imul(ve,Xe)|0,M=(M=M+Math.imul(ve,ht)|0)+Math.imul(ke,Xe)|0,P=P+Math.imul(ke,ht)|0;var Xt=(G+(L=L+Math.imul(se,pt)|0)|0)+((8191&(M=(M=M+Math.imul(se,Lt)|0)+Math.imul(de,pt)|0))<<13)|0;G=((P=P+Math.imul(de,Lt)|0)+(M>>>13)|0)+(Xt>>>26)|0,Xt&=67108863,L=Math.imul(Se,Be),M=(M=Math.imul(Se,Ke))+Math.imul(ze,Be)|0,P=Math.imul(ze,Ke),L=L+Math.imul(ge,Ce)|0,M=(M=M+Math.imul(ge,Le)|0)+Math.imul(we,Ce)|0,P=P+Math.imul(we,Le)|0,L=L+Math.imul(be,Xe)|0,M=(M=M+Math.imul(be,ht)|0)+Math.imul(xe,Xe)|0,P=P+Math.imul(xe,ht)|0;var Kt=(G+(L=L+Math.imul(ve,pt)|0)|0)+((8191&(M=(M=M+Math.imul(ve,Lt)|0)+Math.imul(ke,pt)|0))<<13)|0;G=((P=P+Math.imul(ke,Lt)|0)+(M>>>13)|0)+(Kt>>>26)|0,Kt&=67108863,L=Math.imul(Se,Ce),M=(M=Math.imul(Se,Le))+Math.imul(ze,Ce)|0,P=Math.imul(ze,Le),L=L+Math.imul(ge,Xe)|0,M=(M=M+Math.imul(ge,ht)|0)+Math.imul(we,Xe)|0,P=P+Math.imul(we,ht)|0;var or=(G+(L=L+Math.imul(be,pt)|0)|0)+((8191&(M=(M=M+Math.imul(be,Lt)|0)+Math.imul(xe,pt)|0))<<13)|0;G=((P=P+Math.imul(xe,Lt)|0)+(M>>>13)|0)+(or>>>26)|0,or&=67108863,L=Math.imul(Se,Xe),M=(M=Math.imul(Se,ht))+Math.imul(ze,Xe)|0,P=Math.imul(ze,ht);var dr=(G+(L=L+Math.imul(ge,pt)|0)|0)+((8191&(M=(M=M+Math.imul(ge,Lt)|0)+Math.imul(we,pt)|0))<<13)|0;G=((P=P+Math.imul(we,Lt)|0)+(M>>>13)|0)+(dr>>>26)|0,dr&=67108863;var vr=(G+(L=Math.imul(Se,pt))|0)+((8191&(M=(M=Math.imul(Se,Lt))+Math.imul(ze,pt)|0))<<13)|0;return G=((P=Math.imul(ze,Lt))+(M>>>13)|0)+(vr>>>26)|0,vr&=67108863,U[0]=vt,U[1]=Dt,U[2]=xt,U[3]=it,U[4]=St,U[5]=Nt,U[6]=Ut,U[7]=Qt,U[8]=Ie,U[9]=lt,U[10]=wt,U[11]=Ot,U[12]=Gt,U[13]=ir,U[14]=Xt,U[15]=Kt,U[16]=or,U[17]=dr,U[18]=vr,G!==0&&(U[19]=G,k.length++),k};function a(w,E,k){return new g().mulp(w,E,k)}function g(w,E){this.x=w,this.y=E}Math.imul||(n=c),e.prototype.mulTo=function(w,E){var k=this.length+w.length;return this.length===10&&w.length===10?n(this,w,E):k<63?c(this,w,E):k<1024?function(L,M,P){P.negative=M.negative^L.negative,P.length=L.length+M.length;for(var D=0,N=0,U=0;U<P.length-1;U++){var G=N;N=0;for(var X=67108863&D,K=Math.min(U,M.length-1),Z=Math.max(0,U-L.length+1);Z<=K;Z++){var H=U-Z,Y=(0|L.words[H])*(0|M.words[Z]),$=67108863&Y;X=67108863&($=$+X|0),N+=(G=(G=G+(Y/67108864|0)|0)+($>>>26)|0)>>>26,G&=67108863}P.words[U]=X,D=G,G=N}return D!==0?P.words[U]=D:P.length--,P.strip()}(this,w,E):a(this,w,E)},g.prototype.makeRBT=function(w){for(var E=new Array(w),k=e.prototype._countBits(w)-1,L=0;L<w;L++)E[L]=this.revBin(L,k,w);return E},g.prototype.revBin=function(w,E,k){if(w===0||w===k-1)return w;for(var L=0,M=0;M<E;M++)L|=(1&w)<<E-M-1,w>>=1;return L},g.prototype.permute=function(w,E,k,L,M,P){for(var D=0;D<P;D++)L[D]=E[w[D]],M[D]=k[w[D]]},g.prototype.transform=function(w,E,k,L,M,P){this.permute(P,w,E,k,L,M);for(var D=1;D<M;D<<=1)for(var N=D<<1,U=Math.cos(2*Math.PI/N),G=Math.sin(2*Math.PI/N),X=0;X<M;X+=N)for(var K=U,Z=G,H=0;H<D;H++){var Y=k[X+H],$=L[X+H],z=k[X+H+D],j=L[X+H+D],W=K*z-Z*j;j=K*j+Z*z,z=W,k[X+H]=Y+z,L[X+H]=$+j,k[X+H+D]=Y-z,L[X+H+D]=$-j,H!==N&&(W=U*K-G*Z,Z=U*Z+G*K,K=W)}},g.prototype.guessLen13b=function(w,E){var k=1|Math.max(E,w),L=1&k,M=0;for(k=k/2|0;k;k>>>=1)M++;return 1<<M+1+L},g.prototype.conjugate=function(w,E,k){if(!(k<=1))for(var L=0;L<k/2;L++){var M=w[L];w[L]=w[k-L-1],w[k-L-1]=M,M=E[L],E[L]=-E[k-L-1],E[k-L-1]=-M}},g.prototype.normalize13b=function(w,E){for(var k=0,L=0;L<E/2;L++){var M=8192*Math.round(w[2*L+1]/E)+Math.round(w[2*L]/E)+k;w[L]=67108863&M,k=M<67108864?0:M/67108864|0}return w},g.prototype.convert13b=function(w,E,k,L){for(var M=0,P=0;P<E;P++)M+=0|w[P],k[2*P]=8191&M,M>>>=13,k[2*P+1]=8191&M,M>>>=13;for(P=2*E;P<L;++P)k[P]=0;m(M===0),m((-8192&M)==0)},g.prototype.stub=function(w){for(var E=new Array(w),k=0;k<w;k++)E[k]=0;return E},g.prototype.mulp=function(w,E,k){var L=2*this.guessLen13b(w.length,E.length),M=this.makeRBT(L),P=this.stub(L),D=new Array(L),N=new Array(L),U=new Array(L),G=new Array(L),X=new Array(L),K=new Array(L),Z=k.words;Z.length=L,this.convert13b(w.words,w.length,D,L),this.convert13b(E.words,E.length,G,L),this.transform(D,P,N,U,L,M),this.transform(G,P,X,K,L,M);for(var H=0;H<L;H++){var Y=N[H]*X[H]-U[H]*K[H];U[H]=N[H]*K[H]+U[H]*X[H],N[H]=Y}return this.conjugate(N,U,L),this.transform(N,U,Z,P,L,M),this.conjugate(Z,P,L),this.normalize13b(Z,L),k.negative=w.negative^E.negative,k.length=w.length+E.length,k.strip()},e.prototype.mul=function(w){var E=new e(null);return E.words=new Array(this.length+w.length),this.mulTo(w,E)},e.prototype.mulf=function(w){var E=new e(null);return E.words=new Array(this.length+w.length),a(this,w,E)},e.prototype.imul=function(w){return this.clone().mulTo(w,this)},e.prototype.imuln=function(w){m(typeof w=="number"),m(w<67108864);for(var E=0,k=0;k<this.length;k++){var L=(0|this.words[k])*w,M=(67108863&L)+(67108863&E);E>>=26,E+=L/67108864|0,E+=M>>>26,this.words[k]=67108863&M}return E!==0&&(this.words[k]=E,this.length++),this},e.prototype.muln=function(w){return this.clone().imuln(w)},e.prototype.sqr=function(){return this.mul(this)},e.prototype.isqr=function(){return this.imul(this.clone())},e.prototype.pow=function(w){var E=function(P){for(var D=new Array(P.bitLength()),N=0;N<D.length;N++){var U=N/26|0,G=N%26;D[N]=(P.words[U]&1<<G)>>>G}return D}(w);if(E.length===0)return new e(1);for(var k=this,L=0;L<E.length&&E[L]===0;L++,k=k.sqr());if(++L<E.length)for(var M=k.sqr();L<E.length;L++,M=M.sqr())E[L]!==0&&(k=k.mul(M));return k},e.prototype.iushln=function(w){m(typeof w=="number"&&w>=0);var E,k=w%26,L=(w-k)/26,M=67108863>>>26-k<<26-k;if(k!==0){var P=0;for(E=0;E<this.length;E++){var D=this.words[E]&M,N=(0|this.words[E])-D<<k;this.words[E]=N|P,P=D>>>26-k}P&&(this.words[E]=P,this.length++)}if(L!==0){for(E=this.length-1;E>=0;E--)this.words[E+L]=this.words[E];for(E=0;E<L;E++)this.words[E]=0;this.length+=L}return this.strip()},e.prototype.ishln=function(w){return m(this.negative===0),this.iushln(w)},e.prototype.iushrn=function(w,E,k){var L;m(typeof w=="number"&&w>=0),L=E?(E-E%26)/26:0;var M=w%26,P=Math.min((w-M)/26,this.length),D=67108863^67108863>>>M<<M,N=k;if(L-=P,L=Math.max(0,L),N){for(var U=0;U<P;U++)N.words[U]=this.words[U];N.length=P}if(P!==0)if(this.length>P)for(this.length-=P,U=0;U<this.length;U++)this.words[U]=this.words[U+P];else this.words[0]=0,this.length=1;var G=0;for(U=this.length-1;U>=0&&(G!==0||U>=L);U--){var X=0|this.words[U];this.words[U]=G<<26-M|X>>>M,G=X&D}return N&&G!==0&&(N.words[N.length++]=G),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},e.prototype.ishrn=function(w,E,k){return m(this.negative===0),this.iushrn(w,E,k)},e.prototype.shln=function(w){return this.clone().ishln(w)},e.prototype.ushln=function(w){return this.clone().iushln(w)},e.prototype.shrn=function(w){return this.clone().ishrn(w)},e.prototype.ushrn=function(w){return this.clone().iushrn(w)},e.prototype.testn=function(w){m(typeof w=="number"&&w>=0);var E=w%26,k=(w-E)/26,L=1<<E;return!(this.length<=k)&&!!(this.words[k]&L)},e.prototype.imaskn=function(w){m(typeof w=="number"&&w>=0);var E=w%26,k=(w-E)/26;if(m(this.negative===0,"imaskn works only with positive numbers"),this.length<=k)return this;if(E!==0&&k++,this.length=Math.min(k,this.length),E!==0){var L=67108863^67108863>>>E<<E;this.words[this.length-1]&=L}return this.strip()},e.prototype.maskn=function(w){return this.clone().imaskn(w)},e.prototype.iaddn=function(w){return m(typeof w=="number"),m(w<67108864),w<0?this.isubn(-w):this.negative!==0?this.length===1&&(0|this.words[0])<w?(this.words[0]=w-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(w),this.negative=1,this):this._iaddn(w)},e.prototype._iaddn=function(w){this.words[0]+=w;for(var E=0;E<this.length&&this.words[E]>=67108864;E++)this.words[E]-=67108864,E===this.length-1?this.words[E+1]=1:this.words[E+1]++;return this.length=Math.max(this.length,E+1),this},e.prototype.isubn=function(w){if(m(typeof w=="number"),m(w<67108864),w<0)return this.iaddn(-w);if(this.negative!==0)return this.negative=0,this.iaddn(w),this.negative=1,this;if(this.words[0]-=w,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var E=0;E<this.length&&this.words[E]<0;E++)this.words[E]+=67108864,this.words[E+1]-=1;return this.strip()},e.prototype.addn=function(w){return this.clone().iaddn(w)},e.prototype.subn=function(w){return this.clone().isubn(w)},e.prototype.iabs=function(){return this.negative=0,this},e.prototype.abs=function(){return this.clone().iabs()},e.prototype._ishlnsubmul=function(w,E,k){var L,M,P=w.length+k;this._expand(P);var D=0;for(L=0;L<w.length;L++){M=(0|this.words[L+k])+D;var N=(0|w.words[L])*E;D=((M-=67108863&N)>>26)-(N/67108864|0),this.words[L+k]=67108863&M}for(;L<this.length-k;L++)D=(M=(0|this.words[L+k])+D)>>26,this.words[L+k]=67108863&M;if(D===0)return this.strip();for(m(D===-1),D=0,L=0;L<this.length;L++)D=(M=-(0|this.words[L])+D)>>26,this.words[L]=67108863&M;return this.negative=1,this.strip()},e.prototype._wordDiv=function(w,E){var k=(this.length,w.length),L=this.clone(),M=w,P=0|M.words[M.length-1];(k=26-this._countBits(P))!=0&&(M=M.ushln(k),L.iushln(k),P=0|M.words[M.length-1]);var D,N=L.length-M.length;if(E!=="mod"){(D=new e(null)).length=N+1,D.words=new Array(D.length);for(var U=0;U<D.length;U++)D.words[U]=0}var G=L.clone()._ishlnsubmul(M,1,N);G.negative===0&&(L=G,D&&(D.words[N]=1));for(var X=N-1;X>=0;X--){var K=67108864*(0|L.words[M.length+X])+(0|L.words[M.length+X-1]);for(K=Math.min(K/P|0,67108863),L._ishlnsubmul(M,K,X);L.negative!==0;)K--,L.negative=0,L._ishlnsubmul(M,1,X),L.isZero()||(L.negative^=1);D&&(D.words[X]=K)}return D&&D.strip(),L.strip(),E!=="div"&&k!==0&&L.iushrn(k),{div:D||null,mod:L}},e.prototype.divmod=function(w,E,k){return m(!w.isZero()),this.isZero()?{div:new e(0),mod:new e(0)}:this.negative!==0&&w.negative===0?(P=this.neg().divmod(w,E),E!=="mod"&&(L=P.div.neg()),E!=="div"&&(M=P.mod.neg(),k&&M.negative!==0&&M.iadd(w)),{div:L,mod:M}):this.negative===0&&w.negative!==0?(P=this.divmod(w.neg(),E),E!=="mod"&&(L=P.div.neg()),{div:L,mod:P.mod}):(this.negative&w.negative)!=0?(P=this.neg().divmod(w.neg(),E),E!=="div"&&(M=P.mod.neg(),k&&M.negative!==0&&M.isub(w)),{div:P.div,mod:M}):w.length>this.length||this.cmp(w)<0?{div:new e(0),mod:this}:w.length===1?E==="div"?{div:this.divn(w.words[0]),mod:null}:E==="mod"?{div:null,mod:new e(this.modn(w.words[0]))}:{div:this.divn(w.words[0]),mod:new e(this.modn(w.words[0]))}:this._wordDiv(w,E);var L,M,P},e.prototype.div=function(w){return this.divmod(w,"div",!1).div},e.prototype.mod=function(w){return this.divmod(w,"mod",!1).mod},e.prototype.umod=function(w){return this.divmod(w,"mod",!0).mod},e.prototype.divRound=function(w){var E=this.divmod(w);if(E.mod.isZero())return E.div;var k=E.div.negative!==0?E.mod.isub(w):E.mod,L=w.ushrn(1),M=w.andln(1),P=k.cmp(L);return P<0||M===1&&P===0?E.div:E.div.negative!==0?E.div.isubn(1):E.div.iaddn(1)},e.prototype.modn=function(w){m(w<=67108863);for(var E=(1<<26)%w,k=0,L=this.length-1;L>=0;L--)k=(E*k+(0|this.words[L]))%w;return k},e.prototype.idivn=function(w){m(w<=67108863);for(var E=0,k=this.length-1;k>=0;k--){var L=(0|this.words[k])+67108864*E;this.words[k]=L/w|0,E=L%w}return this.strip()},e.prototype.divn=function(w){return this.clone().idivn(w)},e.prototype.egcd=function(w){m(w.negative===0),m(!w.isZero());var E=this,k=w.clone();E=E.negative!==0?E.umod(w):E.clone();for(var L=new e(1),M=new e(0),P=new e(0),D=new e(1),N=0;E.isEven()&&k.isEven();)E.iushrn(1),k.iushrn(1),++N;for(var U=k.clone(),G=E.clone();!E.isZero();){for(var X=0,K=1;(E.words[0]&K)==0&&X<26;++X,K<<=1);if(X>0)for(E.iushrn(X);X-- >0;)(L.isOdd()||M.isOdd())&&(L.iadd(U),M.isub(G)),L.iushrn(1),M.iushrn(1);for(var Z=0,H=1;(k.words[0]&H)==0&&Z<26;++Z,H<<=1);if(Z>0)for(k.iushrn(Z);Z-- >0;)(P.isOdd()||D.isOdd())&&(P.iadd(U),D.isub(G)),P.iushrn(1),D.iushrn(1);E.cmp(k)>=0?(E.isub(k),L.isub(P),M.isub(D)):(k.isub(E),P.isub(L),D.isub(M))}return{a:P,b:D,gcd:k.iushln(N)}},e.prototype._invmp=function(w){m(w.negative===0),m(!w.isZero());var E=this,k=w.clone();E=E.negative!==0?E.umod(w):E.clone();for(var L,M=new e(1),P=new e(0),D=k.clone();E.cmpn(1)>0&&k.cmpn(1)>0;){for(var N=0,U=1;(E.words[0]&U)==0&&N<26;++N,U<<=1);if(N>0)for(E.iushrn(N);N-- >0;)M.isOdd()&&M.iadd(D),M.iushrn(1);for(var G=0,X=1;(k.words[0]&X)==0&&G<26;++G,X<<=1);if(G>0)for(k.iushrn(G);G-- >0;)P.isOdd()&&P.iadd(D),P.iushrn(1);E.cmp(k)>=0?(E.isub(k),M.isub(P)):(k.isub(E),P.isub(M))}return(L=E.cmpn(1)===0?M:P).cmpn(0)<0&&L.iadd(w),L},e.prototype.gcd=function(w){if(this.isZero())return w.abs();if(w.isZero())return this.abs();var E=this.clone(),k=w.clone();E.negative=0,k.negative=0;for(var L=0;E.isEven()&&k.isEven();L++)E.iushrn(1),k.iushrn(1);for(;;){for(;E.isEven();)E.iushrn(1);for(;k.isEven();)k.iushrn(1);var M=E.cmp(k);if(M<0){var P=E;E=k,k=P}else if(M===0||k.cmpn(1)===0)break;E.isub(k)}return k.iushln(L)},e.prototype.invm=function(w){return this.egcd(w).a.umod(w)},e.prototype.isEven=function(){return(1&this.words[0])==0},e.prototype.isOdd=function(){return(1&this.words[0])==1},e.prototype.andln=function(w){return this.words[0]&w},e.prototype.bincn=function(w){m(typeof w=="number");var E=w%26,k=(w-E)/26,L=1<<E;if(this.length<=k)return this._expand(k+1),this.words[k]|=L,this;for(var M=L,P=k;M!==0&&P<this.length;P++){var D=0|this.words[P];M=(D+=M)>>>26,D&=67108863,this.words[P]=D}return M!==0&&(this.words[P]=M,this.length++),this},e.prototype.isZero=function(){return this.length===1&&this.words[0]===0},e.prototype.cmpn=function(w){var E,k=w<0;if(this.negative!==0&&!k)return-1;if(this.negative===0&&k)return 1;if(this.strip(),this.length>1)E=1;else{k&&(w=-w),m(w<=67108863,"Number is too big");var L=0|this.words[0];E=L===w?0:L<w?-1:1}return this.negative!==0?0|-E:E},e.prototype.cmp=function(w){if(this.negative!==0&&w.negative===0)return-1;if(this.negative===0&&w.negative!==0)return 1;var E=this.ucmp(w);return this.negative!==0?0|-E:E},e.prototype.ucmp=function(w){if(this.length>w.length)return 1;if(this.length<w.length)return-1;for(var E=0,k=this.length-1;k>=0;k--){var L=0|this.words[k],M=0|w.words[k];if(L!==M){L<M?E=-1:L>M&&(E=1);break}}return E},e.prototype.gtn=function(w){return this.cmpn(w)===1},e.prototype.gt=function(w){return this.cmp(w)===1},e.prototype.gten=function(w){return this.cmpn(w)>=0},e.prototype.gte=function(w){return this.cmp(w)>=0},e.prototype.ltn=function(w){return this.cmpn(w)===-1},e.prototype.lt=function(w){return this.cmp(w)===-1},e.prototype.lten=function(w){return this.cmpn(w)<=0},e.prototype.lte=function(w){return this.cmp(w)<=0},e.prototype.eqn=function(w){return this.cmpn(w)===0},e.prototype.eq=function(w){return this.cmp(w)===0},e.red=function(w){return new A(w)},e.prototype.toRed=function(w){return m(!this.red,"Already a number in reduction context"),m(this.negative===0,"red works only with positives"),w.convertTo(this)._forceRed(w)},e.prototype.fromRed=function(){return m(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},e.prototype._forceRed=function(w){return this.red=w,this},e.prototype.forceRed=function(w){return m(!this.red,"Already a number in reduction context"),this._forceRed(w)},e.prototype.redAdd=function(w){return m(this.red,"redAdd works only with red numbers"),this.red.add(this,w)},e.prototype.redIAdd=function(w){return m(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,w)},e.prototype.redSub=function(w){return m(this.red,"redSub works only with red numbers"),this.red.sub(this,w)},e.prototype.redISub=function(w){return m(this.red,"redISub works only with red numbers"),this.red.isub(this,w)},e.prototype.redShl=function(w){return m(this.red,"redShl works only with red numbers"),this.red.shl(this,w)},e.prototype.redMul=function(w){return m(this.red,"redMul works only with red numbers"),this.red._verify2(this,w),this.red.mul(this,w)},e.prototype.redIMul=function(w){return m(this.red,"redMul works only with red numbers"),this.red._verify2(this,w),this.red.imul(this,w)},e.prototype.redSqr=function(){return m(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},e.prototype.redISqr=function(){return m(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},e.prototype.redSqrt=function(){return m(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},e.prototype.redInvm=function(){return m(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},e.prototype.redNeg=function(){return m(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},e.prototype.redPow=function(w){return m(this.red&&!w.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,w)};var p={k256:null,p224:null,p192:null,p25519:null};function y(w,E){this.name=w,this.p=new e(E,16),this.n=this.p.bitLength(),this.k=new e(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){y.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function b(){y.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function x(){y.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function T(){y.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function A(w){if(typeof w=="string"){var E=e._prime(w);this.m=E.p,this.prime=E}else m(w.gtn(1),"modulus must be greater than 1"),this.m=w,this.prime=null}function S(w){A.call(this,w),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new e(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}y.prototype._tmp=function(){var w=new e(null);return w.words=new Array(Math.ceil(this.n/13)),w},y.prototype.ireduce=function(w){var E,k=w;do this.split(k,this.tmp),E=(k=(k=this.imulK(k)).iadd(this.tmp)).bitLength();while(E>this.n);var L=E<this.n?-1:k.ucmp(this.p);return L===0?(k.words[0]=0,k.length=1):L>0?k.isub(this.p):k.strip(),k},y.prototype.split=function(w,E){w.iushrn(this.n,0,E)},y.prototype.imulK=function(w){return w.imul(this.k)},h(v,y),v.prototype.split=function(w,E){for(var k=Math.min(w.length,9),L=0;L<k;L++)E.words[L]=w.words[L];if(E.length=k,w.length<=9)return w.words[0]=0,void(w.length=1);var M=w.words[9];for(E.words[E.length++]=4194303&M,L=10;L<w.length;L++){var P=0|w.words[L];w.words[L-10]=(4194303&P)<<4|M>>>22,M=P}M>>>=22,w.words[L-10]=M,M===0&&w.length>10?w.length-=10:w.length-=9},v.prototype.imulK=function(w){w.words[w.length]=0,w.words[w.length+1]=0,w.length+=2;for(var E=0,k=0;k<w.length;k++){var L=0|w.words[k];E+=977*L,w.words[k]=67108863&E,E=64*L+(E/67108864|0)}return w.words[w.length-1]===0&&(w.length--,w.words[w.length-1]===0&&w.length--),w},h(b,y),h(x,y),h(T,y),T.prototype.imulK=function(w){for(var E=0,k=0;k<w.length;k++){var L=19*(0|w.words[k])+E,M=67108863&L;L>>>=26,w.words[k]=M,E=L}return E!==0&&(w.words[w.length++]=E),w},e._prime=function(w){if(p[w])return p[w];var E;if(w==="k256")E=new v;else if(w==="p224")E=new b;else if(w==="p192")E=new x;else{if(w!=="p25519")throw new Error("Unknown prime "+w);E=new T}return p[w]=E,E},A.prototype._verify1=function(w){m(w.negative===0,"red works only with positives"),m(w.red,"red works only with red numbers")},A.prototype._verify2=function(w,E){m((w.negative|E.negative)==0,"red works only with positives"),m(w.red&&w.red===E.red,"red works only with red numbers")},A.prototype.imod=function(w){return this.prime?this.prime.ireduce(w)._forceRed(this):w.umod(this.m)._forceRed(this)},A.prototype.neg=function(w){return w.isZero()?w.clone():this.m.sub(w)._forceRed(this)},A.prototype.add=function(w,E){this._verify2(w,E);var k=w.add(E);return k.cmp(this.m)>=0&&k.isub(this.m),k._forceRed(this)},A.prototype.iadd=function(w,E){this._verify2(w,E);var k=w.iadd(E);return k.cmp(this.m)>=0&&k.isub(this.m),k},A.prototype.sub=function(w,E){this._verify2(w,E);var k=w.sub(E);return k.cmpn(0)<0&&k.iadd(this.m),k._forceRed(this)},A.prototype.isub=function(w,E){this._verify2(w,E);var k=w.isub(E);return k.cmpn(0)<0&&k.iadd(this.m),k},A.prototype.shl=function(w,E){return this._verify1(w),this.imod(w.ushln(E))},A.prototype.imul=function(w,E){return this._verify2(w,E),this.imod(w.imul(E))},A.prototype.mul=function(w,E){return this._verify2(w,E),this.imod(w.mul(E))},A.prototype.isqr=function(w){return this.imul(w,w.clone())},A.prototype.sqr=function(w){return this.mul(w,w)},A.prototype.sqrt=function(w){if(w.isZero())return w.clone();var E=this.m.andln(3);if(m(E%2==1),E===3){var k=this.m.add(new e(1)).iushrn(2);return this.pow(w,k)}for(var L=this.m.subn(1),M=0;!L.isZero()&&L.andln(1)===0;)M++,L.iushrn(1);m(!L.isZero());var P=new e(1).toRed(this),D=P.redNeg(),N=this.m.subn(1).iushrn(1),U=this.m.bitLength();for(U=new e(2*U*U).toRed(this);this.pow(U,N).cmp(D)!==0;)U.redIAdd(D);for(var G=this.pow(U,L),X=this.pow(w,L.addn(1).iushrn(1)),K=this.pow(w,L),Z=M;K.cmp(P)!==0;){for(var H=K,Y=0;H.cmp(P)!==0;Y++)H=H.redSqr();m(Y<Z);var $=this.pow(G,new e(1).iushln(Z-Y-1));X=X.redMul($),G=$.redSqr(),K=K.redMul(G),Z=Y}return X},A.prototype.invm=function(w){var E=w._invmp(this.m);return E.negative!==0?(E.negative=0,this.imod(E).redNeg()):this.imod(E)},A.prototype.pow=function(w,E){if(E.isZero())return new e(1).toRed(this);if(E.cmpn(1)===0)return w.clone();var k=new Array(16);k[0]=new e(1).toRed(this),k[1]=w;for(var L=2;L<k.length;L++)k[L]=this.mul(k[L-1],w);var M=k[0],P=0,D=0,N=E.bitLength()%26;for(N===0&&(N=26),L=E.length-1;L>=0;L--){for(var U=E.words[L],G=N-1;G>=0;G--){var X=U>>G&1;M!==k[0]&&(M=this.sqr(M)),X!==0||P!==0?(P<<=1,P|=X,(++D==4||L===0&&G===0)&&(M=this.mul(M,k[P]),D=0,P=0)):D=0}N=26}return M},A.prototype.convertTo=function(w){var E=w.umod(this.m);return E===w?E.clone():E},A.prototype.convertFrom=function(w){var E=w.clone();return E.red=null,E},e.mont=function(w){return new S(w)},h(S,A),S.prototype.convertTo=function(w){return this.imod(w.ushln(this.shift))},S.prototype.convertFrom=function(w){var E=this.imod(w.mul(this.rinv));return E.red=null,E},S.prototype.imul=function(w,E){if(w.isZero()||E.isZero())return w.words[0]=0,w.length=1,w;var k=w.imul(E),L=k.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),M=k.isub(L).iushrn(this.shift),P=M;return M.cmp(this.m)>=0?P=M.isub(this.m):M.cmpn(0)<0&&(P=M.iadd(this.m)),P._forceRed(this)},S.prototype.mul=function(w,E){if(w.isZero()||E.isZero())return new e(0)._forceRed(this);var k=w.mul(E),L=k.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),M=k.isub(L).iushrn(this.shift),P=M;return M.cmp(this.m)>=0?P=M.isub(this.m):M.cmpn(0)<0&&(P=M.iadd(this.m)),P._forceRed(this)},S.prototype.invm=function(w){return this.imod(w._invmp(this.m).mul(this.r2))._forceRed(this)}})(I===void 0||I,this)},{buffer:115}],107:[function(r,I,B){I.exports=function(t){var d,m,h,e=t.length,f=0;for(d=0;d<e;++d)f+=t[d].length;var l=new Array(f),o=0;for(d=0;d<e;++d){var u=t[d],s=u.length;for(m=0;m<s;++m){var i=l[o++]=new Array(s-1),c=0;for(h=0;h<s;++h)h!==m&&(i[c++]=u[h]);if(1&m){var n=i[1];i[1]=i[0],i[0]=n}}}return l}},{}],108:[function(r,I,B){I.exports=function(i,c,n){switch(arguments.length){case 1:return u(i);case 2:return typeof c=="function"?l(i,i,c,!0):s(i,c);case 3:return l(i,c,n,!1);default:throw new Error("box-intersect: Invalid arguments")}};var t,d=r("typedarray-pool"),m=r("./lib/sweep"),h=r("./lib/intersect");function e(i,c){for(var n=0;n<i;++n)if(!(c[n]<=c[n+i]))return!0;return!1}function f(i,c,n,a){for(var g=0,p=0,y=0,v=i.length;y<v;++y){var b=i[y];if(!e(c,b)){for(var x=0;x<2*c;++x)n[g++]=b[x];a[p++]=y}}return p}function l(i,c,n,a){var g=i.length,p=c.length;if(!(g<=0||p<=0)){var y=i[0].length>>>1;if(!(y<=0)){var v,b=d.mallocDouble(2*y*g),x=d.mallocInt32(g);if((g=f(i,y,b,x))>0){if(y===1&&a)m.init(g),v=m.sweepComplete(y,n,0,g,b,x,0,g,b,x);else{var T=d.mallocDouble(2*y*p),A=d.mallocInt32(p);(p=f(c,y,T,A))>0&&(m.init(g+p),v=y===1?m.sweepBipartite(y,n,0,g,b,x,0,p,T,A):h(y,n,a,g,b,x,p,T,A),d.free(T),d.free(A))}d.free(b),d.free(x)}return v}}}function o(i,c){t.push([i,c])}function u(i){return t=[],l(i,i,o,!0),t}function s(i,c){return t=[],l(i,c,o,!1),t}},{"./lib/intersect":110,"./lib/sweep":114,"typedarray-pool":601}],109:[function(r,I,B){function t(d){return d?function(m,h,e,f,l,o,u,s,i,c,n){return l-f>i-s?function(a,g,p,y,v,b,x,T,A,S,w){for(var E=2*a,k=y,L=E*y;k<v;++k,L+=E){var M=b[g+L],P=b[g+L+a],D=x[k];e:for(var N=T,U=E*T;N<A;++N,U+=E){var G=S[g+U],X=S[g+U+a],K=w[N];if(!(X<M||P<G)){for(var Z=g+1;Z<a;++Z){var H=b[Z+L],Y=b[Z+a+L],$=S[Z+U],z=S[Z+a+U];if(Y<$||z<H)continue e}var j=p(D,K);if(j!==void 0)return j}}}}(m,h,e,f,l,o,u,s,i,c,n):function(a,g,p,y,v,b,x,T,A,S,w){for(var E=2*a,k=T,L=E*T;k<A;++k,L+=E){var M=S[g+L],P=S[g+L+a],D=w[k];e:for(var N=y,U=E*y;N<v;++N,U+=E){var G=b[g+U],X=b[g+U+a],K=x[N];if(!(P<G||X<M)){for(var Z=g+1;Z<a;++Z){var H=b[Z+U],Y=b[Z+a+U],$=S[Z+L],z=S[Z+a+L];if(Y<$||z<H)continue e}var j=p(K,D);if(j!==void 0)return j}}}}(m,h,e,f,l,o,u,s,i,c,n)}:function(m,h,e,f,l,o,u,s,i,c,n,a){return o-l>c-i?f?function(g,p,y,v,b,x,T,A,S,w,E){for(var k=2*g,L=v,M=k*v;L<b;++L,M+=k){var P=x[p+M],D=x[p+M+g],N=T[L];e:for(var U=A,G=k*A;U<S;++U,G+=k){var X=w[p+G],K=E[U];if(!(X<=P||D<X)){for(var Z=p+1;Z<g;++Z){var H=x[Z+M],Y=x[Z+g+M],$=w[Z+G],z=w[Z+g+G];if(Y<$||z<H)continue e}var j=y(K,N);if(j!==void 0)return j}}}}(m,h,e,l,o,u,s,i,c,n,a):function(g,p,y,v,b,x,T,A,S,w,E){for(var k=2*g,L=v,M=k*v;L<b;++L,M+=k){var P=x[p+M],D=x[p+M+g],N=T[L];e:for(var U=A,G=k*A;U<S;++U,G+=k){var X=w[p+G],K=E[U];if(!(X<P||D<X)){for(var Z=p+1;Z<g;++Z){var H=x[Z+M],Y=x[Z+g+M],$=w[Z+G],z=w[Z+g+G];if(Y<$||z<H)continue e}var j=y(N,K);if(j!==void 0)return j}}}}(m,h,e,l,o,u,s,i,c,n,a):f?function(g,p,y,v,b,x,T,A,S,w,E){for(var k=2*g,L=A,M=k*A;L<S;++L,M+=k){var P=w[p+M],D=E[L];e:for(var N=v,U=k*v;N<b;++N,U+=k){var G=x[p+U],X=x[p+U+g],K=T[N];if(!(P<=G||X<P)){for(var Z=p+1;Z<g;++Z){var H=x[Z+U],Y=x[Z+g+U],$=w[Z+M],z=w[Z+g+M];if(Y<$||z<H)continue e}var j=y(D,K);if(j!==void 0)return j}}}}(m,h,e,l,o,u,s,i,c,n,a):function(g,p,y,v,b,x,T,A,S,w,E){for(var k=2*g,L=A,M=k*A;L<S;++L,M+=k){var P=w[p+M],D=E[L];e:for(var N=v,U=k*v;N<b;++N,U+=k){var G=x[p+U],X=x[p+U+g],K=T[N];if(!(P<G||X<P)){for(var Z=p+1;Z<g;++Z){var H=x[Z+U],Y=x[Z+g+U],$=w[Z+M],z=w[Z+g+M];if(Y<$||z<H)continue e}var j=y(K,D);if(j!==void 0)return j}}}}(m,h,e,l,o,u,s,i,c,n,a)}}B.partial=t(!1),B.full=t(!0)},{}],110:[function(r,I,B){I.exports=function(x,T,A,S,w,E,k,L,M){(function(be,xe){var ce=8*d.log2(xe+1)*(be+1)|0,ge=d.nextPow2(6*ce);g.length<ge&&(t.free(g),g=t.mallocInt32(ge));var we=d.nextPow2(2*ce);p.length<we&&(t.free(p),p=t.mallocDouble(we))})(x,S+k);var P,D=0,N=2*x;for(y(D++,0,0,S,0,k,A?16:0,-1/0,1/0),A||y(D++,0,0,k,0,S,1,-1/0,1/0);D>0;){var U=6*(D-=1),G=g[U],X=g[U+1],K=g[U+2],Z=g[U+3],H=g[U+4],Y=g[U+5],$=2*D,z=p[$],j=p[$+1],W=1&Y,ee=!!(16&Y),J=w,Q=E,te=L,ie=M;if(W&&(J=L,Q=M,te=w,ie=E),!(2&Y&&(K=i(x,G,X,K,J,Q,j),X>=K)||4&Y&&(X=c(x,G,X,K,J,Q,z))>=K)){var ae=K-X,he=H-Z;if(ee){if(x*ae*(ae+he)<1<<22){if((P=f.scanComplete(x,G,T,X,K,J,Q,Z,H,te,ie))!==void 0)return P;continue}}else{if(x*Math.min(ae,he)<128){if((P=h(x,G,T,W,X,K,J,Q,Z,H,te,ie))!==void 0)return P;continue}if(x*ae*he<1<<22){if((P=f.scanBipartite(x,G,T,W,X,K,J,Q,Z,H,te,ie))!==void 0)return P;continue}}var se=u(x,G,X,K,J,Q,z,j);if(X<se)if(x*(se-X)<128){if((P=e(x,G+1,T,X,se,J,Q,Z,H,te,ie))!==void 0)return P}else if(G===x-2){if((P=W?f.sweepBipartite(x,T,Z,H,te,ie,X,se,J,Q):f.sweepBipartite(x,T,X,se,J,Q,Z,H,te,ie))!==void 0)return P}else y(D++,G+1,X,se,Z,H,W,-1/0,1/0),y(D++,G+1,Z,H,X,se,1^W,-1/0,1/0);if(se<K){var de=l(x,G,Z,H,te,ie),ue=te[N*de+G],ve=s(x,G,de,H,te,ie,ue);if(ve<H&&y(D++,G,se,K,ve,H,(4|W)+(ee?16:0),ue,j),Z<de&&y(D++,G,se,K,Z,de,(2|W)+(ee?16:0),z,ue),de+1===ve){if((P=ee?b(x,G,T,se,K,J,Q,de,te,ie[de]):v(x,G,T,W,se,K,J,Q,de,te,ie[de]))!==void 0)return P}else if(de<ve){var ke;if(ee){if(ke=n(x,G,se,K,J,Q,ue),se<ke){var Ee=s(x,G,se,ke,J,Q,ue);if(G===x-2){if(se<Ee&&(P=f.sweepComplete(x,T,se,Ee,J,Q,de,ve,te,ie))!==void 0||Ee<ke&&(P=f.sweepBipartite(x,T,Ee,ke,J,Q,de,ve,te,ie))!==void 0)return P}else se<Ee&&y(D++,G+1,se,Ee,de,ve,16,-1/0,1/0),Ee<ke&&(y(D++,G+1,Ee,ke,de,ve,0,-1/0,1/0),y(D++,G+1,de,ve,Ee,ke,1,-1/0,1/0))}}else ke=W?a(x,G,se,K,J,Q,ue):n(x,G,se,K,J,Q,ue),se<ke&&(G===x-2?P=W?f.sweepBipartite(x,T,de,ve,te,ie,se,ke,J,Q):f.sweepBipartite(x,T,se,ke,J,Q,de,ve,te,ie):(y(D++,G+1,se,ke,de,ve,W,-1/0,1/0),y(D++,G+1,de,ve,se,ke,1^W,-1/0,1/0)))}}}}};var t=r("typedarray-pool"),d=r("bit-twiddle"),m=r("./brute"),h=m.partial,e=m.full,f=r("./sweep"),l=r("./median"),o=r("./partition"),u=o("!(lo>=p0)&&!(p1>=hi)"),s=o("lo===p0"),i=o("lo<p0"),c=o("hi<=p0"),n=o("lo<=p0&&p0<=hi"),a=o("lo<p0&&p0<=hi"),g=t.mallocInt32(1024),p=t.mallocDouble(1024);function y(x,T,A,S,w,E,k,L,M){var P=6*x;g[P]=T,g[P+1]=A,g[P+2]=S,g[P+3]=w,g[P+4]=E,g[P+5]=k;var D=2*x;p[D]=L,p[D+1]=M}function v(x,T,A,S,w,E,k,L,M,P,D){var N=2*x,U=M*N,G=P[U+T];e:for(var X=w,K=w*N;X<E;++X,K+=N){var Z=k[K+T],H=k[K+T+x];if(!(G<Z||H<G)&&(!S||G!==Z)){for(var Y,$=L[X],z=T+1;z<x;++z){Z=k[K+z],H=k[K+z+x];var j=P[U+z],W=P[U+z+x];if(H<j||W<Z)continue e}if((Y=S?A(D,$):A($,D))!==void 0)return Y}}}function b(x,T,A,S,w,E,k,L,M,P){var D=2*x,N=L*D,U=M[N+T];e:for(var G=S,X=S*D;G<w;++G,X+=D){var K=k[G];if(K!==P){var Z=E[X+T],H=E[X+T+x];if(!(U<Z||H<U)){for(var Y=T+1;Y<x;++Y){Z=E[X+Y],H=E[X+Y+x];var $=M[N+Y],z=M[N+Y+x];if(H<$||z<Z)continue e}var j=A(K,P);if(j!==void 0)return j}}}}},{"./brute":109,"./median":111,"./partition":112,"./sweep":114,"bit-twiddle":104,"typedarray-pool":601}],111:[function(r,I,B){I.exports=function(m,h,e,f,l,o){if(f<=e+1)return e;for(var u=e,s=f,i=f+e>>>1,c=2*m,n=i,a=l[c*i+h];u<s;){if(s-u<8){d(m,h,u,s,l,o),a=l[c*i+h];break}var g=s-u,p=Math.random()*g+u|0,y=l[c*p+h],v=Math.random()*g+u|0,b=l[c*v+h],x=Math.random()*g+u|0,T=l[c*x+h];y<=b?T>=b?(n=v,a=b):y>=T?(n=p,a=y):(n=x,a=T):b>=T?(n=v,a=b):T>=y?(n=p,a=y):(n=x,a=T);for(var A=c*(s-1),S=c*n,w=0;w<c;++w,++A,++S){var E=l[A];l[A]=l[S],l[S]=E}var k=o[s-1];for(o[s-1]=o[n],o[n]=k,n=t(m,h,u,s-1,l,o,a),A=c*(s-1),S=c*n,w=0;w<c;++w,++A,++S)E=l[A],l[A]=l[S],l[S]=E;if(k=o[s-1],o[s-1]=o[n],o[n]=k,i<n){for(s=n-1;u<s&&l[c*(s-1)+h]===a;)s-=1;s+=1}else{if(!(n<i))break;for(u=n+1;u<s&&l[c*u+h]===a;)u+=1}}return t(m,h,e,i,l,o,l[c*i+h])};var t=r("./partition")("lo<p0");function d(m,h,e,f,l,o){for(var u=2*m,s=u*(e+1)+h,i=e+1;i<f;++i,s+=u)for(var c=l[s],n=i,a=u*(i-1);n>e&&l[a+h]>c;--n,a-=u){for(var g=a,p=a+u,y=0;y<u;++y,++g,++p){var v=l[g];l[g]=l[p],l[p]=v}var b=o[n];o[n]=o[n-1],o[n-1]=b}}},{"./partition":112}],112:[function(r,I,B){I.exports=function(d){return t[d]};var t={"lo===p0":function(d,m,h,e,f,l,o){for(var u=2*d,s=u*h,i=s,c=h,n=m,a=h;e>a;++a,s+=u)if(f[s+n]===o)if(c===a)c+=1,i+=u;else{for(var g=0;u>g;++g){var p=f[s+g];f[s+g]=f[i],f[i++]=p}var y=l[a];l[a]=l[c],l[c++]=y}return c},"lo<p0":function(d,m,h,e,f,l,o){for(var u=2*d,s=u*h,i=s,c=h,n=m,a=h;e>a;++a,s+=u)if(f[s+n]<o)if(c===a)c+=1,i+=u;else{for(var g=0;u>g;++g){var p=f[s+g];f[s+g]=f[i],f[i++]=p}var y=l[a];l[a]=l[c],l[c++]=y}return c},"lo<=p0":function(d,m,h,e,f,l,o){for(var u=2*d,s=u*h,i=s,c=h,n=d+m,a=h;e>a;++a,s+=u)if(f[s+n]<=o)if(c===a)c+=1,i+=u;else{for(var g=0;u>g;++g){var p=f[s+g];f[s+g]=f[i],f[i++]=p}var y=l[a];l[a]=l[c],l[c++]=y}return c},"hi<=p0":function(d,m,h,e,f,l,o){for(var u=2*d,s=u*h,i=s,c=h,n=d+m,a=h;e>a;++a,s+=u)if(f[s+n]<=o)if(c===a)c+=1,i+=u;else{for(var g=0;u>g;++g){var p=f[s+g];f[s+g]=f[i],f[i++]=p}var y=l[a];l[a]=l[c],l[c++]=y}return c},"lo<p0&&p0<=hi":function(d,m,h,e,f,l,o){for(var u=2*d,s=u*h,i=s,c=h,n=m,a=d+m,g=h;e>g;++g,s+=u){var p=f[s+n],y=f[s+a];if(p<o&&o<=y)if(c===g)c+=1,i+=u;else{for(var v=0;u>v;++v){var b=f[s+v];f[s+v]=f[i],f[i++]=b}var x=l[g];l[g]=l[c],l[c++]=x}}return c},"lo<=p0&&p0<=hi":function(d,m,h,e,f,l,o){for(var u=2*d,s=u*h,i=s,c=h,n=m,a=d+m,g=h;e>g;++g,s+=u){var p=f[s+n],y=f[s+a];if(p<=o&&o<=y)if(c===g)c+=1,i+=u;else{for(var v=0;u>v;++v){var b=f[s+v];f[s+v]=f[i],f[i++]=b}var x=l[g];l[g]=l[c],l[c++]=x}}return c},"!(lo>=p0)&&!(p1>=hi)":function(d,m,h,e,f,l,o,u){for(var s=2*d,i=s*h,c=i,n=h,a=m,g=d+m,p=h;e>p;++p,i+=s){var y=f[i+a],v=f[i+g];if(!(y>=o||u>=v))if(n===p)n+=1,c+=s;else{for(var b=0;s>b;++b){var x=f[i+b];f[i+b]=f[c],f[c++]=x}var T=l[p];l[p]=l[n],l[n++]=T}}return n}}},{}],113:[function(r,I,B){I.exports=function(o,u){u<=128?t(0,u-1,o):function s(i,c,n){var a=(c-i+1)/6|0,g=i+a,p=c-a,y=i+c>>1,v=y-a,b=y+a,x=g,T=v,A=y,S=b,w=p,E=i+1,k=c-1,L=0;f(x,T,n)&&(L=x,x=T,T=L),f(S,w,n)&&(L=S,S=w,w=L),f(x,A,n)&&(L=x,x=A,A=L),f(T,A,n)&&(L=T,T=A,A=L),f(x,S,n)&&(L=x,x=S,S=L),f(A,S,n)&&(L=A,A=S,S=L),f(T,w,n)&&(L=T,T=w,w=L),f(T,A,n)&&(L=T,T=A,A=L),f(S,w,n)&&(L=S,S=w,w=L);for(var M=n[2*T],P=n[2*T+1],D=n[2*S],N=n[2*S+1],U=2*x,G=2*A,X=2*w,K=2*g,Z=2*y,H=2*p,Y=0;Y<2;++Y){var $=n[U+Y],z=n[G+Y],j=n[X+Y];n[K+Y]=$,n[Z+Y]=z,n[H+Y]=j}m(v,i,n),m(b,c,n);for(var W=E;W<=k;++W)if(l(W,M,P,n))W!==E&&d(W,E,n),++E;else if(!l(W,D,N,n))for(;;){if(l(k,D,N,n)){l(k,M,P,n)?(h(W,E,k,n),++E,--k):(d(W,k,n),--k);break}if(--k<W)break}e(i,E-1,M,P,n),e(c,k+1,D,N,n),E-2-i<=32?t(i,E-2,n):s(i,E-2,n),c-(k+2)<=32?t(k+2,c,n):s(k+2,c,n),k-E<=32?t(E,k,n):s(E,k,n)}(0,u-1,o)};function t(o,u,s){for(var i=2*(o+1),c=o+1;c<=u;++c){for(var n=s[i++],a=s[i++],g=c,p=i-2;g-- >o;){var y=s[p-2],v=s[p-1];if(y<n||y===n&&v<a)break;s[p]=y,s[p+1]=v,p-=2}s[p]=n,s[p+1]=a}}function d(o,u,s){u*=2;var i=s[o*=2],c=s[o+1];s[o]=s[u],s[o+1]=s[u+1],s[u]=i,s[u+1]=c}function m(o,u,s){u*=2,s[o*=2]=s[u],s[o+1]=s[u+1]}function h(o,u,s,i){u*=2,s*=2;var c=i[o*=2],n=i[o+1];i[o]=i[u],i[o+1]=i[u+1],i[u]=i[s],i[u+1]=i[s+1],i[s]=c,i[s+1]=n}function e(o,u,s,i,c){u*=2,c[o*=2]=c[u],c[u]=s,c[o+1]=c[u+1],c[u+1]=i}function f(o,u,s){u*=2;var i=s[o*=2],c=s[u];return!(i<c)&&(i!==c||s[o+1]>s[u+1])}function l(o,u,s,i){var c=i[o*=2];return c<u||c===u&&i[o+1]<s}},{}],114:[function(r,I,B){I.exports={init:function(n){var a=d.nextPow2(n);h.length<a&&(t.free(h),h=t.mallocInt32(a)),e.length<a&&(t.free(e),e=t.mallocInt32(a)),f.length<a&&(t.free(f),f=t.mallocInt32(a)),l.length<a&&(t.free(l),l=t.mallocInt32(a)),o.length<a&&(t.free(o),o=t.mallocInt32(a)),u.length<a&&(t.free(u),u=t.mallocInt32(a));var g=8*a;s.length<g&&(t.free(s),s=t.mallocDouble(g))},sweepBipartite:function(n,a,g,p,y,v,b,x,T,A){for(var S=0,w=2*n,E=n-1,k=w-1,L=g;L<p;++L){var M=v[L],P=w*L;s[S++]=y[P+E],s[S++]=-(M+1),s[S++]=y[P+k],s[S++]=M}for(L=b;L<x;++L){M=A[L]+(1<<28);var D=w*L;s[S++]=T[D+E],s[S++]=-M,s[S++]=T[D+k],s[S++]=M}var N=S>>>1;m(s,N);var U=0,G=0;for(L=0;L<N;++L){var X=0|s[2*L+1];if(X>=1<<28)i(f,l,G--,X=X-(1<<28)|0);else if(X>=0)i(h,e,U--,X);else if(X<=-(1<<28)){X=-X-(1<<28)|0;for(var K=0;K<U;++K)if((Z=a(h[K],X))!==void 0)return Z;c(f,l,G++,X)}else{for(X=-X-1|0,K=0;K<G;++K){var Z;if((Z=a(X,f[K]))!==void 0)return Z}c(h,e,U++,X)}}},sweepComplete:function(n,a,g,p,y,v,b,x,T,A){for(var S=0,w=2*n,E=n-1,k=w-1,L=g;L<p;++L){var M=v[L]+1<<1,P=w*L;s[S++]=y[P+E],s[S++]=-M,s[S++]=y[P+k],s[S++]=M}for(L=b;L<x;++L){M=A[L]+1<<1;var D=w*L;s[S++]=T[D+E],s[S++]=1|-M,s[S++]=T[D+k],s[S++]=1|M}var N=S>>>1;m(s,N);var U=0,G=0,X=0;for(L=0;L<N;++L){var K=0|s[2*L+1],Z=1&K;if(L<N-1&&K>>1==s[2*L+3]>>1&&(Z=2,L+=1),K<0){for(var H=-(K>>1)-1,Y=0;Y<X;++Y)if(($=a(o[Y],H))!==void 0)return $;if(Z!==0){for(Y=0;Y<U;++Y)if(($=a(h[Y],H))!==void 0)return $}if(Z!==1)for(Y=0;Y<G;++Y){var $;if(($=a(f[Y],H))!==void 0)return $}Z===0?c(h,e,U++,H):Z===1?c(f,l,G++,H):Z===2&&c(o,u,X++,H)}else H=(K>>1)-1,Z===0?i(h,e,U--,H):Z===1?i(f,l,G--,H):Z===2&&i(o,u,X--,H)}},scanBipartite:function(n,a,g,p,y,v,b,x,T,A,S,w){var E=0,k=2*n,L=a,M=a+n,P=1,D=1;p?D=1<<28:P=1<<28;for(var N=y;N<v;++N){var U=N+P,G=k*N;s[E++]=b[G+L],s[E++]=-U,s[E++]=b[G+M],s[E++]=U}for(N=T;N<A;++N){U=N+D;var X=k*N;s[E++]=S[X+L],s[E++]=-U}var K=E>>>1;m(s,K);var Z=0;for(N=0;N<K;++N){var H=0|s[2*N+1];if(H<0){var Y=!1;if((U=-H)>=1<<28?(Y=!p,U-=1<<28):(Y=!!p,U-=1),Y)c(h,e,Z++,U);else{var $=w[U],z=k*U,j=S[z+a+1],W=S[z+a+1+n];e:for(var ee=0;ee<Z;++ee){var J=h[ee],Q=k*J;if(!(W<b[Q+a+1]||b[Q+a+1+n]<j)){for(var te=a+2;te<n;++te)if(S[z+te+n]<b[Q+te]||b[Q+te+n]<S[z+te])continue e;var ie,ae=x[J];if((ie=p?g($,ae):g(ae,$))!==void 0)return ie}}}}else i(h,e,Z--,H-P)}},scanComplete:function(n,a,g,p,y,v,b,x,T,A,S){for(var w=0,E=2*n,k=a,L=a+n,M=p;M<y;++M){var P=M+(1<<28),D=E*M;s[w++]=v[D+k],s[w++]=-P,s[w++]=v[D+L],s[w++]=P}for(M=x;M<T;++M){P=M+1;var N=E*M;s[w++]=A[N+k],s[w++]=-P}var U=w>>>1;m(s,U);var G=0;for(M=0;M<U;++M){var X=0|s[2*M+1];if(X<0)if((P=-X)>=1<<28)h[G++]=P-(1<<28);else{var K=S[P-=1],Z=E*P,H=A[Z+a+1],Y=A[Z+a+1+n];e:for(var $=0;$<G;++$){var z=h[$],j=b[z];if(j===K)break;var W=E*z;if(!(Y<v[W+a+1]||v[W+a+1+n]<H)){for(var ee=a+2;ee<n;++ee)if(A[Z+ee+n]<v[W+ee]||v[W+ee+n]<A[Z+ee])continue e;var J=g(j,K);if(J!==void 0)return J}}}else{for(P=X-(1<<28),$=G-1;$>=0;--$)if(h[$]===P){for(ee=$+1;ee<G;++ee)h[ee-1]=h[ee];break}--G}}}};var t=r("typedarray-pool"),d=r("bit-twiddle"),m=r("./sort"),h=t.mallocInt32(1024),e=t.mallocInt32(1024),f=t.mallocInt32(1024),l=t.mallocInt32(1024),o=t.mallocInt32(1024),u=t.mallocInt32(1024),s=t.mallocDouble(8192);function i(n,a,g,p){var y=a[p],v=n[g-1];n[y]=v,a[v]=y}function c(n,a,g,p){n[g]=p,a[p]=g}},{"./sort":113,"bit-twiddle":104,"typedarray-pool":601}],115:[function(r,I,B){},{}],116:[function(r,I,B){var t,d=typeof Reflect=="object"?Reflect:null,m=d&&typeof d.apply=="function"?d.apply:function(g,p,y){return Function.prototype.apply.call(g,p,y)};t=d&&typeof d.ownKeys=="function"?d.ownKeys:Object.getOwnPropertySymbols?function(g){return Object.getOwnPropertyNames(g).concat(Object.getOwnPropertySymbols(g))}:function(g){return Object.getOwnPropertyNames(g)};var h=Number.isNaN||function(g){return g!=g};function e(){e.init.call(this)}I.exports=e,I.exports.once=function(g,p){return new Promise(function(y,v){function b(){x!==void 0&&g.removeListener("error",x),y([].slice.call(arguments))}var x;p!=="error"&&(x=function(T){g.removeListener(p,b),v(T)},g.once("error",x)),g.once(p,b)})},e.EventEmitter=e,e.prototype._events=void 0,e.prototype._eventsCount=0,e.prototype._maxListeners=void 0;var f=10;function l(g){if(typeof g!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof g)}function o(g){return g._maxListeners===void 0?e.defaultMaxListeners:g._maxListeners}function u(g,p,y,v){var b,x,T,A;if(l(y),(x=g._events)===void 0?(x=g._events=Object.create(null),g._eventsCount=0):(x.newListener!==void 0&&(g.emit("newListener",p,y.listener?y.listener:y),x=g._events),T=x[p]),T===void 0)T=x[p]=y,++g._eventsCount;else if(typeof T=="function"?T=x[p]=v?[y,T]:[T,y]:v?T.unshift(y):T.push(y),(b=o(g))>0&&T.length>b&&!T.warned){T.warned=!0;var S=new Error("Possible EventEmitter memory leak detected. "+T.length+" "+String(p)+" listeners added. Use emitter.setMaxListeners() to increase limit");S.name="MaxListenersExceededWarning",S.emitter=g,S.type=p,S.count=T.length,A=S,console&&console.warn&&console.warn(A)}return g}function s(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function i(g,p,y){var v={fired:!1,wrapFn:void 0,target:g,type:p,listener:y},b=s.bind(v);return b.listener=y,v.wrapFn=b,b}function c(g,p,y){var v=g._events;if(v===void 0)return[];var b=v[p];return b===void 0?[]:typeof b=="function"?y?[b.listener||b]:[b]:y?function(x){for(var T=new Array(x.length),A=0;A<T.length;++A)T[A]=x[A].listener||x[A];return T}(b):a(b,b.length)}function n(g){var p=this._events;if(p!==void 0){var y=p[g];if(typeof y=="function")return 1;if(y!==void 0)return y.length}return 0}function a(g,p){for(var y=new Array(p),v=0;v<p;++v)y[v]=g[v];return y}Object.defineProperty(e,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(g){if(typeof g!="number"||g<0||h(g))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+g+".");f=g}}),e.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},e.prototype.setMaxListeners=function(g){if(typeof g!="number"||g<0||h(g))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+g+".");return this._maxListeners=g,this},e.prototype.getMaxListeners=function(){return o(this)},e.prototype.emit=function(g){for(var p=[],y=1;y<arguments.length;y++)p.push(arguments[y]);var v=g==="error",b=this._events;if(b!==void 0)v=v&&b.error===void 0;else if(!v)return!1;if(v){var x;if(p.length>0&&(x=p[0]),x instanceof Error)throw x;var T=new Error("Unhandled error."+(x?" ("+x.message+")":""));throw T.context=x,T}var A=b[g];if(A===void 0)return!1;if(typeof A=="function")m(A,this,p);else{var S=A.length,w=a(A,S);for(y=0;y<S;++y)m(w[y],this,p)}return!0},e.prototype.addListener=function(g,p){return u(this,g,p,!1)},e.prototype.on=e.prototype.addListener,e.prototype.prependListener=function(g,p){return u(this,g,p,!0)},e.prototype.once=function(g,p){return l(p),this.on(g,i(this,g,p)),this},e.prototype.prependOnceListener=function(g,p){return l(p),this.prependListener(g,i(this,g,p)),this},e.prototype.removeListener=function(g,p){var y,v,b,x,T;if(l(p),(v=this._events)===void 0)return this;if((y=v[g])===void 0)return this;if(y===p||y.listener===p)--this._eventsCount==0?this._events=Object.create(null):(delete v[g],v.removeListener&&this.emit("removeListener",g,y.listener||p));else if(typeof y!="function"){for(b=-1,x=y.length-1;x>=0;x--)if(y[x]===p||y[x].listener===p){T=y[x].listener,b=x;break}if(b<0)return this;b===0?y.shift():function(A,S){for(;S+1<A.length;S++)A[S]=A[S+1];A.pop()}(y,b),y.length===1&&(v[g]=y[0]),v.removeListener!==void 0&&this.emit("removeListener",g,T||p)}return this},e.prototype.off=e.prototype.removeListener,e.prototype.removeAllListeners=function(g){var p,y,v;if((y=this._events)===void 0)return this;if(y.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):y[g]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete y[g]),this;if(arguments.length===0){var b,x=Object.keys(y);for(v=0;v<x.length;++v)(b=x[v])!=="removeListener"&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(p=y[g])=="function")this.removeListener(g,p);else if(p!==void 0)for(v=p.length-1;v>=0;v--)this.removeListener(g,p[v]);return this},e.prototype.listeners=function(g){return c(this,g,!0)},e.prototype.rawListeners=function(g){return c(this,g,!1)},e.listenerCount=function(g,p){return typeof g.listenerCount=="function"?g.listenerCount(p):n.call(g,p)},e.prototype.listenerCount=n,e.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},{}],117:[function(r,I,B){(function(t){(function(){var d=r("base64-js"),m=r("ieee754");B.Buffer=e,B.SlowBuffer=function(z){return+z!=z&&(z=0),e.alloc(+z)},B.INSPECT_MAX_BYTES=50;function h(z){if(z>2147483647)throw new RangeError('The value "'+z+'" is invalid for option "size"');var j=new Uint8Array(z);return j.__proto__=e.prototype,j}function e(z,j,W){if(typeof z=="number"){if(typeof j=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return o(z)}return f(z,j,W)}function f(z,j,W){if(typeof z=="string")return function(Q,te){if(typeof te=="string"&&te!==""||(te="utf8"),!e.isEncoding(te))throw new TypeError("Unknown encoding: "+te);var ie=0|i(Q,te),ae=h(ie),he=ae.write(Q,te);return he!==ie&&(ae=ae.slice(0,he)),ae}(z,j);if(ArrayBuffer.isView(z))return u(z);if(z==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof z);if(Y(z,ArrayBuffer)||z&&Y(z.buffer,ArrayBuffer))return function(Q,te,ie){if(te<0||Q.byteLength<te)throw new RangeError('"offset" is outside of buffer bounds');if(Q.byteLength<te+(ie||0))throw new RangeError('"length" is outside of buffer bounds');var ae;return ae=te===void 0&&ie===void 0?new Uint8Array(Q):ie===void 0?new Uint8Array(Q,te):new Uint8Array(Q,te,ie),ae.__proto__=e.prototype,ae}(z,j,W);if(typeof z=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ee=z.valueOf&&z.valueOf();if(ee!=null&&ee!==z)return e.from(ee,j,W);var J=function(Q){if(e.isBuffer(Q)){var te=0|s(Q.length),ie=h(te);return ie.length===0||Q.copy(ie,0,0,te),ie}if(Q.length!==void 0)return typeof Q.length!="number"||$(Q.length)?h(0):u(Q);if(Q.type==="Buffer"&&Array.isArray(Q.data))return u(Q.data)}(z);if(J)return J;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof z[Symbol.toPrimitive]=="function")return e.from(z[Symbol.toPrimitive]("string"),j,W);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof z)}function l(z){if(typeof z!="number")throw new TypeError('"size" argument must be of type number');if(z<0)throw new RangeError('The value "'+z+'" is invalid for option "size"')}function o(z){return l(z),h(z<0?0:0|s(z))}function u(z){for(var j=z.length<0?0:0|s(z.length),W=h(j),ee=0;ee<j;ee+=1)W[ee]=255&z[ee];return W}function s(z){if(z>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|z}function i(z,j){if(e.isBuffer(z))return z.length;if(ArrayBuffer.isView(z)||Y(z,ArrayBuffer))return z.byteLength;if(typeof z!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof z);var W=z.length,ee=arguments.length>2&&arguments[2]===!0;if(!ee&&W===0)return 0;for(var J=!1;;)switch(j){case"ascii":case"latin1":case"binary":return W;case"utf8":case"utf-8":return K(z).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*W;case"hex":return W>>>1;case"base64":return Z(z).length;default:if(J)return ee?-1:K(z).length;j=(""+j).toLowerCase(),J=!0}}function c(z,j,W){var ee=!1;if((j===void 0||j<0)&&(j=0),j>this.length||((W===void 0||W>this.length)&&(W=this.length),W<=0)||(W>>>=0)<=(j>>>=0))return"";for(z||(z="utf8");;)switch(z){case"hex":return k(this,j,W);case"utf8":case"utf-8":return S(this,j,W);case"ascii":return w(this,j,W);case"latin1":case"binary":return E(this,j,W);case"base64":return A(this,j,W);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,j,W);default:if(ee)throw new TypeError("Unknown encoding: "+z);z=(z+"").toLowerCase(),ee=!0}}function n(z,j,W){var ee=z[j];z[j]=z[W],z[W]=ee}function a(z,j,W,ee,J){if(z.length===0)return-1;if(typeof W=="string"?(ee=W,W=0):W>2147483647?W=2147483647:W<-2147483648&&(W=-2147483648),$(W=+W)&&(W=J?0:z.length-1),W<0&&(W=z.length+W),W>=z.length){if(J)return-1;W=z.length-1}else if(W<0){if(!J)return-1;W=0}if(typeof j=="string"&&(j=e.from(j,ee)),e.isBuffer(j))return j.length===0?-1:g(z,j,W,ee,J);if(typeof j=="number")return j&=255,typeof Uint8Array.prototype.indexOf=="function"?J?Uint8Array.prototype.indexOf.call(z,j,W):Uint8Array.prototype.lastIndexOf.call(z,j,W):g(z,[j],W,ee,J);throw new TypeError("val must be string, number or Buffer")}function g(z,j,W,ee,J){var Q,te=1,ie=z.length,ae=j.length;if(ee!==void 0&&((ee=String(ee).toLowerCase())==="ucs2"||ee==="ucs-2"||ee==="utf16le"||ee==="utf-16le")){if(z.length<2||j.length<2)return-1;te=2,ie/=2,ae/=2,W/=2}function he(ve,ke){return te===1?ve[ke]:ve.readUInt16BE(ke*te)}if(J){var se=-1;for(Q=W;Q<ie;Q++)if(he(z,Q)===he(j,se===-1?0:Q-se)){if(se===-1&&(se=Q),Q-se+1===ae)return se*te}else se!==-1&&(Q-=Q-se),se=-1}else for(W+ae>ie&&(W=ie-ae),Q=W;Q>=0;Q--){for(var de=!0,ue=0;ue<ae;ue++)if(he(z,Q+ue)!==he(j,ue)){de=!1;break}if(de)return Q}return-1}function p(z,j,W,ee){W=Number(W)||0;var J=z.length-W;ee?(ee=Number(ee))>J&&(ee=J):ee=J;var Q=j.length;ee>Q/2&&(ee=Q/2);for(var te=0;te<ee;++te){var ie=parseInt(j.substr(2*te,2),16);if($(ie))return te;z[W+te]=ie}return te}function y(z,j,W,ee){return H(K(j,z.length-W),z,W,ee)}function v(z,j,W,ee){return H(function(J){for(var Q=[],te=0;te<J.length;++te)Q.push(255&J.charCodeAt(te));return Q}(j),z,W,ee)}function b(z,j,W,ee){return v(z,j,W,ee)}function x(z,j,W,ee){return H(Z(j),z,W,ee)}function T(z,j,W,ee){return H(function(J,Q){for(var te,ie,ae,he=[],se=0;se<J.length&&!((Q-=2)<0);++se)te=J.charCodeAt(se),ie=te>>8,ae=te%256,he.push(ae),he.push(ie);return he}(j,z.length-W),z,W,ee)}function A(z,j,W){return j===0&&W===z.length?d.fromByteArray(z):d.fromByteArray(z.slice(j,W))}function S(z,j,W){W=Math.min(z.length,W);for(var ee=[],J=j;J<W;){var Q,te,ie,ae,he=z[J],se=null,de=he>239?4:he>223?3:he>191?2:1;if(J+de<=W)switch(de){case 1:he<128&&(se=he);break;case 2:(192&(Q=z[J+1]))==128&&(ae=(31&he)<<6|63&Q)>127&&(se=ae);break;case 3:Q=z[J+1],te=z[J+2],(192&Q)==128&&(192&te)==128&&(ae=(15&he)<<12|(63&Q)<<6|63&te)>2047&&(ae<55296||ae>57343)&&(se=ae);break;case 4:Q=z[J+1],te=z[J+2],ie=z[J+3],(192&Q)==128&&(192&te)==128&&(192&ie)==128&&(ae=(15&he)<<18|(63&Q)<<12|(63&te)<<6|63&ie)>65535&&ae<1114112&&(se=ae)}se===null?(se=65533,de=1):se>65535&&(se-=65536,ee.push(se>>>10&1023|55296),se=56320|1023&se),ee.push(se),J+=de}return function(ue){var ve=ue.length;if(ve<=4096)return String.fromCharCode.apply(String,ue);for(var ke="",Ee=0;Ee<ve;)ke+=String.fromCharCode.apply(String,ue.slice(Ee,Ee+=4096));return ke}(ee)}B.kMaxLength=2147483647,e.TYPED_ARRAY_SUPPORT=function(){try{var z=new Uint8Array(1);return z.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},z.foo()===42}catch(j){return!1}}(),e.TYPED_ARRAY_SUPPORT||typeof console=="undefined"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}}),typeof Symbol!="undefined"&&Symbol.species!=null&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(z,j,W){return f(z,j,W)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(z,j,W){return function(ee,J,Q){return l(ee),ee<=0?h(ee):J!==void 0?typeof Q=="string"?h(ee).fill(J,Q):h(ee).fill(J):h(ee)}(z,j,W)},e.allocUnsafe=function(z){return o(z)},e.allocUnsafeSlow=function(z){return o(z)},e.isBuffer=function(z){return z!=null&&z._isBuffer===!0&&z!==e.prototype},e.compare=function(z,j){if(Y(z,Uint8Array)&&(z=e.from(z,z.offset,z.byteLength)),Y(j,Uint8Array)&&(j=e.from(j,j.offset,j.byteLength)),!e.isBuffer(z)||!e.isBuffer(j))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(z===j)return 0;for(var W=z.length,ee=j.length,J=0,Q=Math.min(W,ee);J<Q;++J)if(z[J]!==j[J]){W=z[J],ee=j[J];break}return W<ee?-1:ee<W?1:0},e.isEncoding=function(z){switch(String(z).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(z,j){if(!Array.isArray(z))throw new TypeError('"list" argument must be an Array of Buffers');if(z.length===0)return e.alloc(0);var W;if(j===void 0)for(j=0,W=0;W<z.length;++W)j+=z[W].length;var ee=e.allocUnsafe(j),J=0;for(W=0;W<z.length;++W){var Q=z[W];if(Y(Q,Uint8Array)&&(Q=e.from(Q)),!e.isBuffer(Q))throw new TypeError('"list" argument must be an Array of Buffers');Q.copy(ee,J),J+=Q.length}return ee},e.byteLength=i,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var z=this.length;if(z%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var j=0;j<z;j+=2)n(this,j,j+1);return this},e.prototype.swap32=function(){var z=this.length;if(z%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var j=0;j<z;j+=4)n(this,j,j+3),n(this,j+1,j+2);return this},e.prototype.swap64=function(){var z=this.length;if(z%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var j=0;j<z;j+=8)n(this,j,j+7),n(this,j+1,j+6),n(this,j+2,j+5),n(this,j+3,j+4);return this},e.prototype.toString=function(){var z=this.length;return z===0?"":arguments.length===0?S(this,0,z):c.apply(this,arguments)},e.prototype.toLocaleString=e.prototype.toString,e.prototype.equals=function(z){if(!e.isBuffer(z))throw new TypeError("Argument must be a Buffer");return this===z||e.compare(this,z)===0},e.prototype.inspect=function(){var z="",j=B.INSPECT_MAX_BYTES;return z=this.toString("hex",0,j).replace(/(.{2})/g,"$1 ").trim(),this.length>j&&(z+=" ... "),"<Buffer "+z+">"},e.prototype.compare=function(z,j,W,ee,J){if(Y(z,Uint8Array)&&(z=e.from(z,z.offset,z.byteLength)),!e.isBuffer(z))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof z);if(j===void 0&&(j=0),W===void 0&&(W=z?z.length:0),ee===void 0&&(ee=0),J===void 0&&(J=this.length),j<0||W>z.length||ee<0||J>this.length)throw new RangeError("out of range index");if(ee>=J&&j>=W)return 0;if(ee>=J)return-1;if(j>=W)return 1;if(this===z)return 0;for(var Q=(J>>>=0)-(ee>>>=0),te=(W>>>=0)-(j>>>=0),ie=Math.min(Q,te),ae=this.slice(ee,J),he=z.slice(j,W),se=0;se<ie;++se)if(ae[se]!==he[se]){Q=ae[se],te=he[se];break}return Q<te?-1:te<Q?1:0},e.prototype.includes=function(z,j,W){return this.indexOf(z,j,W)!==-1},e.prototype.indexOf=function(z,j,W){return a(this,z,j,W,!0)},e.prototype.lastIndexOf=function(z,j,W){return a(this,z,j,W,!1)},e.prototype.write=function(z,j,W,ee){if(j===void 0)ee="utf8",W=this.length,j=0;else if(W===void 0&&typeof j=="string")ee=j,W=this.length,j=0;else{if(!isFinite(j))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");j>>>=0,isFinite(W)?(W>>>=0,ee===void 0&&(ee="utf8")):(ee=W,W=void 0)}var J=this.length-j;if((W===void 0||W>J)&&(W=J),z.length>0&&(W<0||j<0)||j>this.length)throw new RangeError("Attempt to write outside buffer bounds");ee||(ee="utf8");for(var Q=!1;;)switch(ee){case"hex":return p(this,z,j,W);case"utf8":case"utf-8":return y(this,z,j,W);case"ascii":return v(this,z,j,W);case"latin1":case"binary":return b(this,z,j,W);case"base64":return x(this,z,j,W);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,z,j,W);default:if(Q)throw new TypeError("Unknown encoding: "+ee);ee=(""+ee).toLowerCase(),Q=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function w(z,j,W){var ee="";W=Math.min(z.length,W);for(var J=j;J<W;++J)ee+=String.fromCharCode(127&z[J]);return ee}function E(z,j,W){var ee="";W=Math.min(z.length,W);for(var J=j;J<W;++J)ee+=String.fromCharCode(z[J]);return ee}function k(z,j,W){var ee=z.length;(!j||j<0)&&(j=0),(!W||W<0||W>ee)&&(W=ee);for(var J="",Q=j;Q<W;++Q)J+=X(z[Q]);return J}function L(z,j,W){for(var ee=z.slice(j,W),J="",Q=0;Q<ee.length;Q+=2)J+=String.fromCharCode(ee[Q]+256*ee[Q+1]);return J}function M(z,j,W){if(z%1!=0||z<0)throw new RangeError("offset is not uint");if(z+j>W)throw new RangeError("Trying to access beyond buffer length")}function P(z,j,W,ee,J,Q){if(!e.isBuffer(z))throw new TypeError('"buffer" argument must be a Buffer instance');if(j>J||j<Q)throw new RangeError('"value" argument is out of bounds');if(W+ee>z.length)throw new RangeError("Index out of range")}function D(z,j,W,ee,J,Q){if(W+ee>z.length)throw new RangeError("Index out of range");if(W<0)throw new RangeError("Index out of range")}function N(z,j,W,ee,J){return j=+j,W>>>=0,J||D(z,0,W,4),m.write(z,j,W,ee,23,4),W+4}function U(z,j,W,ee,J){return j=+j,W>>>=0,J||D(z,0,W,8),m.write(z,j,W,ee,52,8),W+8}e.prototype.slice=function(z,j){var W=this.length;(z=~~z)<0?(z+=W)<0&&(z=0):z>W&&(z=W),(j=j===void 0?W:~~j)<0?(j+=W)<0&&(j=0):j>W&&(j=W),j<z&&(j=z);var ee=this.subarray(z,j);return ee.__proto__=e.prototype,ee},e.prototype.readUIntLE=function(z,j,W){z>>>=0,j>>>=0,W||M(z,j,this.length);for(var ee=this[z],J=1,Q=0;++Q<j&&(J*=256);)ee+=this[z+Q]*J;return ee},e.prototype.readUIntBE=function(z,j,W){z>>>=0,j>>>=0,W||M(z,j,this.length);for(var ee=this[z+--j],J=1;j>0&&(J*=256);)ee+=this[z+--j]*J;return ee},e.prototype.readUInt8=function(z,j){return z>>>=0,j||M(z,1,this.length),this[z]},e.prototype.readUInt16LE=function(z,j){return z>>>=0,j||M(z,2,this.length),this[z]|this[z+1]<<8},e.prototype.readUInt16BE=function(z,j){return z>>>=0,j||M(z,2,this.length),this[z]<<8|this[z+1]},e.prototype.readUInt32LE=function(z,j){return z>>>=0,j||M(z,4,this.length),(this[z]|this[z+1]<<8|this[z+2]<<16)+16777216*this[z+3]},e.prototype.readUInt32BE=function(z,j){return z>>>=0,j||M(z,4,this.length),16777216*this[z]+(this[z+1]<<16|this[z+2]<<8|this[z+3])},e.prototype.readIntLE=function(z,j,W){z>>>=0,j>>>=0,W||M(z,j,this.length);for(var ee=this[z],J=1,Q=0;++Q<j&&(J*=256);)ee+=this[z+Q]*J;return ee>=(J*=128)&&(ee-=Math.pow(2,8*j)),ee},e.prototype.readIntBE=function(z,j,W){z>>>=0,j>>>=0,W||M(z,j,this.length);for(var ee=j,J=1,Q=this[z+--ee];ee>0&&(J*=256);)Q+=this[z+--ee]*J;return Q>=(J*=128)&&(Q-=Math.pow(2,8*j)),Q},e.prototype.readInt8=function(z,j){return z>>>=0,j||M(z,1,this.length),128&this[z]?-1*(255-this[z]+1):this[z]},e.prototype.readInt16LE=function(z,j){z>>>=0,j||M(z,2,this.length);var W=this[z]|this[z+1]<<8;return 32768&W?4294901760|W:W},e.prototype.readInt16BE=function(z,j){z>>>=0,j||M(z,2,this.length);var W=this[z+1]|this[z]<<8;return 32768&W?4294901760|W:W},e.prototype.readInt32LE=function(z,j){return z>>>=0,j||M(z,4,this.length),this[z]|this[z+1]<<8|this[z+2]<<16|this[z+3]<<24},e.prototype.readInt32BE=function(z,j){return z>>>=0,j||M(z,4,this.length),this[z]<<24|this[z+1]<<16|this[z+2]<<8|this[z+3]},e.prototype.readFloatLE=function(z,j){return z>>>=0,j||M(z,4,this.length),m.read(this,z,!0,23,4)},e.prototype.readFloatBE=function(z,j){return z>>>=0,j||M(z,4,this.length),m.read(this,z,!1,23,4)},e.prototype.readDoubleLE=function(z,j){return z>>>=0,j||M(z,8,this.length),m.read(this,z,!0,52,8)},e.prototype.readDoubleBE=function(z,j){return z>>>=0,j||M(z,8,this.length),m.read(this,z,!1,52,8)},e.prototype.writeUIntLE=function(z,j,W,ee){z=+z,j>>>=0,W>>>=0,ee||P(this,z,j,W,Math.pow(2,8*W)-1,0);var J=1,Q=0;for(this[j]=255&z;++Q<W&&(J*=256);)this[j+Q]=z/J&255;return j+W},e.prototype.writeUIntBE=function(z,j,W,ee){z=+z,j>>>=0,W>>>=0,ee||P(this,z,j,W,Math.pow(2,8*W)-1,0);var J=W-1,Q=1;for(this[j+J]=255&z;--J>=0&&(Q*=256);)this[j+J]=z/Q&255;return j+W},e.prototype.writeUInt8=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,1,255,0),this[j]=255&z,j+1},e.prototype.writeUInt16LE=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,2,65535,0),this[j]=255&z,this[j+1]=z>>>8,j+2},e.prototype.writeUInt16BE=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,2,65535,0),this[j]=z>>>8,this[j+1]=255&z,j+2},e.prototype.writeUInt32LE=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,4,4294967295,0),this[j+3]=z>>>24,this[j+2]=z>>>16,this[j+1]=z>>>8,this[j]=255&z,j+4},e.prototype.writeUInt32BE=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,4,4294967295,0),this[j]=z>>>24,this[j+1]=z>>>16,this[j+2]=z>>>8,this[j+3]=255&z,j+4},e.prototype.writeIntLE=function(z,j,W,ee){if(z=+z,j>>>=0,!ee){var J=Math.pow(2,8*W-1);P(this,z,j,W,J-1,-J)}var Q=0,te=1,ie=0;for(this[j]=255&z;++Q<W&&(te*=256);)z<0&&ie===0&&this[j+Q-1]!==0&&(ie=1),this[j+Q]=(z/te>>0)-ie&255;return j+W},e.prototype.writeIntBE=function(z,j,W,ee){if(z=+z,j>>>=0,!ee){var J=Math.pow(2,8*W-1);P(this,z,j,W,J-1,-J)}var Q=W-1,te=1,ie=0;for(this[j+Q]=255&z;--Q>=0&&(te*=256);)z<0&&ie===0&&this[j+Q+1]!==0&&(ie=1),this[j+Q]=(z/te>>0)-ie&255;return j+W},e.prototype.writeInt8=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,1,127,-128),z<0&&(z=255+z+1),this[j]=255&z,j+1},e.prototype.writeInt16LE=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,2,32767,-32768),this[j]=255&z,this[j+1]=z>>>8,j+2},e.prototype.writeInt16BE=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,2,32767,-32768),this[j]=z>>>8,this[j+1]=255&z,j+2},e.prototype.writeInt32LE=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,4,2147483647,-2147483648),this[j]=255&z,this[j+1]=z>>>8,this[j+2]=z>>>16,this[j+3]=z>>>24,j+4},e.prototype.writeInt32BE=function(z,j,W){return z=+z,j>>>=0,W||P(this,z,j,4,2147483647,-2147483648),z<0&&(z=4294967295+z+1),this[j]=z>>>24,this[j+1]=z>>>16,this[j+2]=z>>>8,this[j+3]=255&z,j+4},e.prototype.writeFloatLE=function(z,j,W){return N(this,z,j,!0,W)},e.prototype.writeFloatBE=function(z,j,W){return N(this,z,j,!1,W)},e.prototype.writeDoubleLE=function(z,j,W){return U(this,z,j,!0,W)},e.prototype.writeDoubleBE=function(z,j,W){return U(this,z,j,!1,W)},e.prototype.copy=function(z,j,W,ee){if(!e.isBuffer(z))throw new TypeError("argument should be a Buffer");if(W||(W=0),ee||ee===0||(ee=this.length),j>=z.length&&(j=z.length),j||(j=0),ee>0&&ee<W&&(ee=W),ee===W||z.length===0||this.length===0)return 0;if(j<0)throw new RangeError("targetStart out of bounds");if(W<0||W>=this.length)throw new RangeError("Index out of range");if(ee<0)throw new RangeError("sourceEnd out of bounds");ee>this.length&&(ee=this.length),z.length-j<ee-W&&(ee=z.length-j+W);var J=ee-W;if(this===z&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(j,W,ee);else if(this===z&&W<j&&j<ee)for(var Q=J-1;Q>=0;--Q)z[Q+j]=this[Q+W];else Uint8Array.prototype.set.call(z,this.subarray(W,ee),j);return J},e.prototype.fill=function(z,j,W,ee){if(typeof z=="string"){if(typeof j=="string"?(ee=j,j=0,W=this.length):typeof W=="string"&&(ee=W,W=this.length),ee!==void 0&&typeof ee!="string")throw new TypeError("encoding must be a string");if(typeof ee=="string"&&!e.isEncoding(ee))throw new TypeError("Unknown encoding: "+ee);if(z.length===1){var J=z.charCodeAt(0);(ee==="utf8"&&J<128||ee==="latin1")&&(z=J)}}else typeof z=="number"&&(z&=255);if(j<0||this.length<j||this.length<W)throw new RangeError("Out of range index");if(W<=j)return this;var Q;if(j>>>=0,W=W===void 0?this.length:W>>>0,z||(z=0),typeof z=="number")for(Q=j;Q<W;++Q)this[Q]=z;else{var te=e.isBuffer(z)?z:e.from(z,ee),ie=te.length;if(ie===0)throw new TypeError('The value "'+z+'" is invalid for argument "value"');for(Q=0;Q<W-j;++Q)this[Q+j]=te[Q%ie]}return this};var G=/[^+/0-9A-Za-z-_]/g;function X(z){return z<16?"0"+z.toString(16):z.toString(16)}function K(z,j){var W;j=j||1/0;for(var ee=z.length,J=null,Q=[],te=0;te<ee;++te){if((W=z.charCodeAt(te))>55295&&W<57344){if(!J){if(W>56319){(j-=3)>-1&&Q.push(239,191,189);continue}if(te+1===ee){(j-=3)>-1&&Q.push(239,191,189);continue}J=W;continue}if(W<56320){(j-=3)>-1&&Q.push(239,191,189),J=W;continue}W=65536+(J-55296<<10|W-56320)}else J&&(j-=3)>-1&&Q.push(239,191,189);if(J=null,W<128){if((j-=1)<0)break;Q.push(W)}else if(W<2048){if((j-=2)<0)break;Q.push(W>>6|192,63&W|128)}else if(W<65536){if((j-=3)<0)break;Q.push(W>>12|224,W>>6&63|128,63&W|128)}else{if(!(W<1114112))throw new Error("Invalid code point");if((j-=4)<0)break;Q.push(W>>18|240,W>>12&63|128,W>>6&63|128,63&W|128)}}return Q}function Z(z){return d.toByteArray(function(j){if((j=(j=j.split("=")[0]).trim().replace(G,"")).length<2)return"";for(;j.length%4!=0;)j+="=";return j}(z))}function H(z,j,W,ee){for(var J=0;J<ee&&!(J+W>=j.length||J>=z.length);++J)j[J+W]=z[J];return J}function Y(z,j){return z instanceof j||z!=null&&z.constructor!=null&&z.constructor.name!=null&&z.constructor.name===j.name}function $(z){return z!=z}}).call(this)}).call(this,r("buffer").Buffer)},{"base64-js":86,buffer:117,ieee754:437}],118:[function(r,I,B){var t=r("./lib/monotone"),d=r("./lib/triangulation"),m=r("./lib/delaunay"),h=r("./lib/filter");function e(o){return[Math.min(o[0],o[1]),Math.max(o[0],o[1])]}function f(o,u){return o[0]-u[0]||o[1]-u[1]}function l(o,u,s){return u in o?o[u]:s}I.exports=function(o,u,s){Array.isArray(u)?(s=s||{},u=u||[]):(s=u||{},u=[]);var i=!!l(s,"delaunay",!0),c=!!l(s,"interior",!0),n=!!l(s,"exterior",!0),a=!!l(s,"infinity",!1);if(!c&&!n||o.length===0)return[];var g=t(o,u);if(i||c!==n||a){for(var p=d(o.length,function(b){return b.map(e).sort(f)}(u)),y=0;y<g.length;++y){var v=g[y];p.addTriangle(v[0],v[1],v[2])}return i&&m(o,p),n?c?a?h(p,0,a):p.cells():h(p,1,a):h(p,-1)}return g}},{"./lib/delaunay":119,"./lib/filter":120,"./lib/monotone":121,"./lib/triangulation":122}],119:[function(r,I,B){var t=r("robust-in-sphere")[4];r("binary-search-bounds");function d(m,h,e,f,l,o){var u=h.opposite(f,l);if(!(u<0)){if(l<f){var s=f;f=l,l=s,s=o,o=u,u=s}h.isConstraint(f,l)||t(m[f],m[l],m[o],m[u])<0&&e.push(f,l)}}I.exports=function(m,h){for(var e=[],f=m.length,l=h.stars,o=0;o<f;++o)for(var u=l[o],s=1;s<u.length;s+=2)if(!((a=u[s])<o)&&!h.isConstraint(o,a)){for(var i=u[s-1],c=-1,n=1;n<u.length;n+=2)if(u[n-1]===a){c=u[n];break}c<0||t(m[o],m[a],m[i],m[c])<0&&e.push(o,a)}for(;e.length>0;){for(var a=e.pop(),g=(o=e.pop(),i=-1,c=-1,u=l[o],1);g<u.length;g+=2){var p=u[g-1],y=u[g];p===a?c=y:y===a&&(i=p)}i<0||c<0||t(m[o],m[a],m[i],m[c])>=0||(h.flip(o,a),d(m,h,e,i,o,c),d(m,h,e,o,c,i),d(m,h,e,c,a,i),d(m,h,e,a,i,c))}}},{"binary-search-bounds":103,"robust-in-sphere":532}],120:[function(r,I,B){var t,d=r("binary-search-bounds");function m(e,f,l,o,u,s,i){this.cells=e,this.neighbor=f,this.flags=o,this.constraint=l,this.active=u,this.next=s,this.boundary=i}function h(e,f){return e[0]-f[0]||e[1]-f[1]||e[2]-f[2]}I.exports=function(e,f,l){var o=function(T,A){for(var S=T.cells(),w=S.length,E=0;E<w;++E){var k=(Z=S[E])[0],L=Z[1],M=Z[2];L<M?L<k&&(Z[0]=L,Z[1]=M,Z[2]=k):M<k&&(Z[0]=M,Z[1]=k,Z[2]=L)}S.sort(h);var P=new Array(w);for(E=0;E<P.length;++E)P[E]=0;var D=[],N=[],U=new Array(3*w),G=new Array(3*w),X=null;A&&(X=[]);var K=new m(S,U,G,P,D,N,X);for(E=0;E<w;++E)for(var Z=S[E],H=0;H<3;++H){k=Z[H],L=Z[(H+1)%3];var Y=U[3*E+H]=K.locate(L,k,T.opposite(L,k)),$=G[3*E+H]=T.isConstraint(k,L);Y<0&&($?N.push(E):(D.push(E),P[E]=1),A&&X.push([L,k,-1]))}return K}(e,l);if(f===0)return l?o.cells.concat(o.boundary):o.cells;for(var u=1,s=o.active,i=o.next,c=o.flags,n=o.cells,a=o.constraint,g=o.neighbor;s.length>0||i.length>0;){for(;s.length>0;){var p=s.pop();if(c[p]!==-u){c[p]=u,n[p];for(var y=0;y<3;++y){var v=g[3*p+y];v>=0&&c[v]===0&&(a[3*p+y]?i.push(v):(s.push(v),c[v]=u))}}}var b=i;i=s,s=b,i.length=0,u=-u}var x=function(T,A,S){for(var w=0,E=0;E<T.length;++E)A[E]===S&&(T[w++]=T[E]);return T.length=w,T}(n,c,f);return l?x.concat(o.boundary):x},m.prototype.locate=(t=[0,0,0],function(e,f,l){var o=e,u=f,s=l;return f<l?f<e&&(o=f,u=l,s=e):l<e&&(o=l,u=e,s=f),o<0?-1:(t[0]=o,t[1]=u,t[2]=s,d.eq(this.cells,t,h))})},{"binary-search-bounds":103}],121:[function(r,I,B){var t=r("binary-search-bounds"),d=r("robust-orientation")[3];function m(i,c,n,a,g){this.a=i,this.b=c,this.idx=n,this.lowerIds=a,this.upperIds=g}function h(i,c,n,a){this.a=i,this.b=c,this.type=n,this.idx=a}function e(i,c){var n=i.a[0]-c.a[0]||i.a[1]-c.a[1]||i.type-c.type;return n||(i.type!==0&&(n=d(i.a,i.b,c.b))?n:i.idx-c.idx)}function f(i,c){return d(i.a,i.b,c)}function l(i,c,n,a,g){for(var p=t.lt(c,a,f),y=t.gt(c,a,f),v=p;v<y;++v){for(var b=c[v],x=b.lowerIds,T=x.length;T>1&&d(n[x[T-2]],n[x[T-1]],a)>0;)i.push([x[T-1],x[T-2],g]),T-=1;x.length=T,x.push(g);var A=b.upperIds;for(T=A.length;T>1&&d(n[A[T-2]],n[A[T-1]],a)<0;)i.push([A[T-2],A[T-1],g]),T-=1;A.length=T,A.push(g)}}function o(i,c){var n;return(n=i.a[0]<c.a[0]?d(i.a,i.b,c.a):d(c.b,c.a,i.a))?n:(n=c.b[0]<i.b[0]?d(i.a,i.b,c.b):d(c.b,c.a,i.b))||i.idx-c.idx}function u(i,c,n){var a=t.le(i,n,o),g=i[a],p=g.upperIds,y=p[p.length-1];g.upperIds=[y],i.splice(a+1,0,new m(n.a,n.b,n.idx,[y],p))}function s(i,c,n){var a=n.a;n.a=n.b,n.b=a;var g=t.eq(i,n,o),p=i[g];i[g-1].upperIds=p.upperIds,i.splice(g,1)}I.exports=function(i,c){for(var n=i.length,a=c.length,g=[],p=0;p<n;++p)g.push(new h(i[p],null,0,p));for(p=0;p<a;++p){var y=c[p],v=i[y[0]],b=i[y[1]];v[0]<b[0]?g.push(new h(v,b,2,p),new h(b,v,1,p)):v[0]>b[0]&&g.push(new h(b,v,2,p),new h(v,b,1,p))}g.sort(e);for(var x=g[0].a[0]-(1+Math.abs(g[0].a[0]))*Math.pow(2,-52),T=[new m([x,1],[x,0],-1,[],[],[],[])],A=[],S=(p=0,g.length);p<S;++p){var w=g[p],E=w.type;E===0?l(A,T,i,w.a,w.idx):E===2?u(T,i,w):s(T,i,w)}return A}},{"binary-search-bounds":103,"robust-orientation":534}],122:[function(r,I,B){var t=r("binary-search-bounds");function d(e,f){this.stars=e,this.edges=f}I.exports=function(e,f){for(var l=new Array(e),o=0;o<e;++o)l[o]=[];return new d(l,f)};var m=d.prototype;function h(e,f,l){for(var o=1,u=e.length;o<u;o+=2)if(e[o-1]===f&&e[o]===l)return e[o-1]=e[u-2],e[o]=e[u-1],void(e.length=u-2)}m.isConstraint=function(){var e=[0,0];function f(l,o){return l[0]-o[0]||l[1]-o[1]}return function(l,o){return e[0]=Math.min(l,o),e[1]=Math.max(l,o),t.eq(this.edges,e,f)>=0}}(),m.removeTriangle=function(e,f,l){var o=this.stars;h(o[e],f,l),h(o[f],l,e),h(o[l],e,f)},m.addTriangle=function(e,f,l){var o=this.stars;o[e].push(f,l),o[f].push(l,e),o[l].push(e,f)},m.opposite=function(e,f){for(var l=this.stars[f],o=1,u=l.length;o<u;o+=2)if(l[o]===e)return l[o-1];return-1},m.flip=function(e,f){var l=this.opposite(e,f),o=this.opposite(f,e);this.removeTriangle(e,f,l),this.removeTriangle(f,e,o),this.addTriangle(e,o,l),this.addTriangle(f,l,o)},m.edges=function(){for(var e=this.stars,f=[],l=0,o=e.length;l<o;++l)for(var u=e[l],s=0,i=u.length;s<i;s+=2)f.push([u[s],u[s+1]]);return f},m.cells=function(){for(var e=this.stars,f=[],l=0,o=e.length;l<o;++l)for(var u=e[l],s=0,i=u.length;s<i;s+=2){var c=u[s],n=u[s+1];l<Math.min(c,n)&&f.push([l,c,n])}return f}},{"binary-search-bounds":103}],123:[function(r,I,B){I.exports=function(t){for(var d=1,m=1;m<t.length;++m)for(var h=0;h<m;++h)if(t[m]<t[h])d=-d;else if(t[h]===t[m])return 0;return d}},{}],124:[function(r,I,B){var t=r("dup"),d=r("robust-linear-solve");function m(f,l){for(var o=0,u=f.length,s=0;s<u;++s)o+=f[s]*l[s];return o}function h(f){var l=f.length;if(l===0)return[];f[0].length;var o=t([f.length+1,f.length+1],1),u=t([f.length+1],1);o[l][l]=0;for(var s=0;s<l;++s){for(var i=0;i<=s;++i)o[i][s]=o[s][i]=2*m(f[s],f[i]);u[s]=m(f[s],f[s])}var c=d(o,u),n=0,a=c[l+1];for(s=0;s<a.length;++s)n+=a[s];var g=new Array(l);for(s=0;s<l;++s){a=c[s];var p=0;for(i=0;i<a.length;++i)p+=a[i];g[s]=p/n}return g}function e(f){if(f.length===0)return[];for(var l=f[0].length,o=t([l]),u=h(f),s=0;s<f.length;++s)for(var i=0;i<l;++i)o[i]+=f[s][i]*u[s];return o}e.barycenetric=h,I.exports=e},{dup:182,"robust-linear-solve":533}],125:[function(r,I,B){I.exports=function(d){for(var m=t(d),h=0,e=0;e<d.length;++e)for(var f=d[e],l=0;l<m.length;++l)h+=Math.pow(f[l]-m[l],2);return Math.sqrt(h/d.length)};var t=r("circumcenter")},{circumcenter:124}],126:[function(r,I,B){I.exports=function(t,d,m){return d<m?t<d?d:t>m?m:t:t<m?m:t>d?d:t}},{}],127:[function(r,I,B){I.exports=function(y,v,b){var x;if(b){x=v;for(var T=new Array(v.length),A=0;A<v.length;++A){var S=v[A];T[A]=[S[0],S[1],b[A]]}v=T}for(var w=function(E,k,L){var M=c(E,[],i(E));return g(k,M,L),!!M}(y,v,!!b);p(y,v,!!b);)w=!0;if(b&&w)for(x.length=0,b.length=0,A=0;A<v.length;++A)S=v[A],x.push([S[0],S[1]]),b.push(S[2]);return w};var t=r("union-find"),d=r("box-intersect"),m=r("robust-segment-intersect"),h=r("big-rat"),e=r("big-rat/cmp"),f=r("big-rat/to-float"),l=r("rat-vec"),o=r("nextafter"),u=r("./lib/rat-seg-intersect");function s(y){var v=f(y);return[o(v,-1/0),o(v,1/0)]}function i(y){for(var v=new Array(y.length),b=0;b<y.length;++b){var x=y[b];v[b]=[o(x[0],-1/0),o(x[1],-1/0),o(x[0],1/0),o(x[1],1/0)]}return v}function c(y,v,b){for(var x=v.length,T=new t(x),A=[],S=0;S<v.length;++S){var w=v[S],E=s(w[0]),k=s(w[1]);A.push([o(E[0],-1/0),o(k[0],-1/0),o(E[1],1/0),o(k[1],1/0)])}d(A,function(N,U){T.link(N,U)});var L=!0,M=new Array(x);for(S=0;S<x;++S)(D=T.find(S))!==S&&(L=!1,y[D]=[Math.min(y[S][0],y[D][0]),Math.min(y[S][1],y[D][1])]);if(L)return null;var P=0;for(S=0;S<x;++S){var D;(D=T.find(S))===S?(M[S]=P,y[P++]=y[S]):M[S]=-1}for(y.length=P,S=0;S<x;++S)M[S]<0&&(M[S]=M[T.find(S)]);return M}function n(y,v){return y[0]-v[0]||y[1]-v[1]}function a(y,v){var b=y[0]-v[0]||y[1]-v[1];return b||(y[2]<v[2]?-1:y[2]>v[2]?1:0)}function g(y,v,b){if(y.length!==0){if(v)for(var x=0;x<y.length;++x){var T=v[(S=y[x])[0]],A=v[S[1]];S[0]=Math.min(T,A),S[1]=Math.max(T,A)}else for(x=0;x<y.length;++x){var S;T=(S=y[x])[0],A=S[1],S[0]=Math.min(T,A),S[1]=Math.max(T,A)}b?y.sort(a):y.sort(n);var w=1;for(x=1;x<y.length;++x){var E=y[x-1],k=y[x];(k[0]!==E[0]||k[1]!==E[1]||b&&k[2]!==E[2])&&(y[w++]=k)}y.length=w}}function p(y,v,b){var x=function(E,k){for(var L=new Array(k.length),M=0;M<k.length;++M){var P=k[M],D=E[P[0]],N=E[P[1]];L[M]=[o(Math.min(D[0],N[0]),-1/0),o(Math.min(D[1],N[1]),-1/0),o(Math.max(D[0],N[0]),1/0),o(Math.max(D[1],N[1]),1/0)]}return L}(y,v),T=function(E,k,L){var M=[];return d(L,function(P,D){var N=k[P],U=k[D];if(N[0]!==U[0]&&N[0]!==U[1]&&N[1]!==U[0]&&N[1]!==U[1]){var G=E[N[0]],X=E[N[1]],K=E[U[0]],Z=E[U[1]];m(G,X,K,Z)&&M.push([P,D])}}),M}(y,v,x),A=i(y),S=function(E,k,L,M){var P=[];return d(L,M,function(D,N){var U=k[D];if(U[0]!==N&&U[1]!==N){var G=E[N],X=E[U[0]],K=E[U[1]];m(X,K,G,G)&&P.push([D,N])}}),P}(y,v,x,A),w=c(y,function(E,k,L,M,P){var D,N,U=E.map(function(he){return[h(he[0]),h(he[1])]});for(D=0;D<L.length;++D){var G=L[D];N=G[0];var X=G[1],K=k[N],Z=k[X],H=u(l(E[K[0]]),l(E[K[1]]),l(E[Z[0]]),l(E[Z[1]]));if(H){var Y=E.length;E.push([f(H[0]),f(H[1])]),U.push(H),M.push([N,Y],[X,Y])}}for(M.sort(function(he,se){if(he[0]!==se[0])return he[0]-se[0];var de=U[he[1]],ue=U[se[1]];return e(de[0],ue[0])||e(de[1],ue[1])}),D=M.length-1;D>=0;--D){var $=k[N=(ie=M[D])[0]],z=$[0],j=$[1],W=E[z],ee=E[j];if((W[0]-ee[0]||W[1]-ee[1])<0){var J=z;z=j,j=J}$[0]=z;var Q,te=$[1]=ie[1];for(P&&(Q=$[2]);D>0&&M[D-1][0]===N;){var ie,ae=(ie=M[--D])[1];P?k.push([te,ae,Q]):k.push([te,ae]),te=ae}P?k.push([te,j,Q]):k.push([te,j])}return U}(y,v,T,S,b));return g(v,w,b),!!w||T.length>0||S.length>0}},{"./lib/rat-seg-intersect":128,"big-rat":90,"big-rat/cmp":88,"big-rat/to-float":102,"box-intersect":108,nextafter:473,"rat-vec":518,"robust-segment-intersect":537,"union-find":602}],128:[function(r,I,B){I.exports=function(u,s,i,c){var n=e(s,u),a=e(c,i),g=o(n,a);if(h(g)===0)return null;var p=e(u,i),y=o(a,p),v=d(y,g),b=l(n,v);return f(u,b)};var t=r("big-rat/mul"),d=r("big-rat/div"),m=r("big-rat/sub"),h=r("big-rat/sign"),e=r("rat-vec/sub"),f=r("rat-vec/add"),l=r("rat-vec/muls");function o(u,s){return m(t(u[0],s[1]),t(u[1],s[0]))}},{"big-rat/div":89,"big-rat/mul":99,"big-rat/sign":100,"big-rat/sub":101,"rat-vec/add":517,"rat-vec/muls":519,"rat-vec/sub":520}],129:[function(r,I,B){var t=r("clamp");function d(m,h){h==null&&(h=!0);var e=m[0],f=m[1],l=m[2],o=m[3];return o==null&&(o=h?1:255),h&&(e*=255,f*=255,l*=255,o*=255),16777216*(e=255&t(e,0,255))+((f=255&t(f,0,255))<<16)+((l=255&t(l,0,255))<<8)+(o=255&t(o,0,255))}I.exports=d,I.exports.to=d,I.exports.from=function(m,h){var e=(m=+m)>>>24,f=(16711680&m)>>>16,l=(65280&m)>>>8,o=255&m;return h===!1?[e,f,l,o]:[e/255,f/255,l/255,o/255]}},{clamp:126}],130:[function(r,I,B){I.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],131:[function(r,I,B){var t=r("color-rgba"),d=r("clamp"),m=r("dtype");I.exports=function(h,e){e!=="float"&&e||(e="array"),e==="uint"&&(e="uint8"),e==="uint_clamped"&&(e="uint8_clamped");var f=new(m(e))(4),l=e!=="uint8"&&e!=="uint8_clamped";return h.length&&typeof h!="string"||((h=t(h))[0]/=255,h[1]/=255,h[2]/=255),function(o){return o instanceof Uint8Array||o instanceof Uint8ClampedArray||!!(Array.isArray(o)&&(o[0]>1||o[0]===0)&&(o[1]>1||o[1]===0)&&(o[2]>1||o[2]===0)&&(!o[3]||o[3]>1))}(h)?(f[0]=h[0],f[1]=h[1],f[2]=h[2],f[3]=h[3]!=null?h[3]:255,l&&(f[0]/=255,f[1]/=255,f[2]/=255,f[3]/=255),f):(l?(f[0]=h[0],f[1]=h[1],f[2]=h[2],f[3]=h[3]!=null?h[3]:1):(f[0]=d(Math.floor(255*h[0]),0,255),f[1]=d(Math.floor(255*h[1]),0,255),f[2]=d(Math.floor(255*h[2]),0,255),f[3]=h[3]==null?255:d(Math.floor(255*h[3]),0,255)),f)}},{clamp:126,"color-rgba":133,dtype:181}],132:[function(r,I,B){(function(t){(function(){var d=r("color-name"),m=r("is-plain-obj"),h=r("defined");I.exports=function(f){var l,o,u=[],s=1;if(typeof f=="string")if(d[f])u=d[f].slice(),o="rgb";else if(f==="transparent")s=0,o="rgb",u=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(f)){var i=(a=f.slice(1)).length;s=1,i<=4?(u=[parseInt(a[0]+a[0],16),parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16)],i===4&&(s=parseInt(a[3]+a[3],16)/255)):(u=[parseInt(a[0]+a[1],16),parseInt(a[2]+a[3],16),parseInt(a[4]+a[5],16)],i===8&&(s=parseInt(a[6]+a[7],16)/255)),u[0]||(u[0]=0),u[1]||(u[1]=0),u[2]||(u[2]=0),o="rgb"}else if(l=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(f)){var c=l[1],n=c==="rgb",a=c.replace(/a$/,"");o=a,i=a==="cmyk"?4:a==="gray"?1:3,u=l[2].trim().split(/\s*,\s*/).map(function(p,y){if(/%$/.test(p))return y===i?parseFloat(p)/100:a==="rgb"?255*parseFloat(p)/100:parseFloat(p);if(a[y]==="h"){if(/deg$/.test(p))return parseFloat(p);if(e[p]!==void 0)return e[p]}return parseFloat(p)}),c===a&&u.push(1),s=n||u[i]===void 0?1:u[i],u=u.slice(0,i)}else f.length>10&&/[0-9](?:\s|\/)/.test(f)&&(u=f.match(/([0-9]+)/g).map(function(p){return parseFloat(p)}),o=f.match(/([a-z])/gi).join("").toLowerCase());else if(isNaN(f))if(m(f)){var g=h(f.r,f.red,f.R,null);g!==null?(o="rgb",u=[g,h(f.g,f.green,f.G),h(f.b,f.blue,f.B)]):(o="hsl",u=[h(f.h,f.hue,f.H),h(f.s,f.saturation,f.S),h(f.l,f.lightness,f.L,f.b,f.brightness)]),s=h(f.a,f.alpha,f.opacity,1),f.opacity!=null&&(s/=100)}else(Array.isArray(f)||t.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(f))&&(u=[f[0],f[1],f[2]],o="rgb",s=f.length===4?f[3]:1);else o="rgb",u=[f>>>16,(65280&f)>>>8,255&f];return{space:o,values:u,alpha:s}};var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this)}).call(this,typeof vi!="undefined"?vi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"color-name":130,defined:176,"is-plain-obj":447}],133:[function(r,I,B){var t=r("color-parse"),d=r("color-space/hsl"),m=r("clamp");I.exports=function(h){var e,f=t(h);return f.space?((e=Array(3))[0]=m(f.values[0],0,255),e[1]=m(f.values[1],0,255),e[2]=m(f.values[2],0,255),f.space[0]==="h"&&(e=d.rgb(e)),e.push(m(f.alpha,0,1)),e):[]}},{clamp:126,"color-parse":132,"color-space/hsl":134}],134:[function(r,I,B){var t=r("./rgb");I.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(d){var m,h,e,f,l,o=d[0]/360,u=d[1]/100,s=d[2]/100;if(u===0)return[l=255*s,l,l];m=2*s-(h=s<.5?s*(1+u):s+u-s*u),f=[0,0,0];for(var i=0;i<3;i++)(e=o+1/3*-(i-1))<0?e++:e>1&&e--,l=6*e<1?m+6*(h-m)*e:2*e<1?h:3*e<2?m+(h-m)*(2/3-e)*6:m,f[i]=255*l;return f}},t.hsl=function(d){var m,h,e=d[0]/255,f=d[1]/255,l=d[2]/255,o=Math.min(e,f,l),u=Math.max(e,f,l),s=u-o;return u===o?m=0:e===u?m=(f-l)/s:f===u?m=2+(l-e)/s:l===u&&(m=4+(e-f)/s),(m=Math.min(60*m,360))<0&&(m+=360),h=(o+u)/2,[m,100*(u===o?0:h<=.5?s/(u+o):s/(2-u-o)),100*h]}},{"./rgb":135}],135:[function(r,I,B){I.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],136:[function(r,I,B){I.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],137:[function(r,I,B){var t=r("./colorScale"),d=r("lerp");function m(f){return[f[0]/255,f[1]/255,f[2]/255,f[3]]}function h(f){for(var l,o="#",u=0;u<3;++u)o+=("00"+(l=(l=f[u]).toString(16))).substr(l.length);return o}function e(f){return"rgba("+f.join(",")+")"}I.exports=function(f){var l,o,u,s,i,c,n,a,g,p;if(f||(f={}),a=(f.nshades||72)-1,n=f.format||"hex",(c=f.colormap)||(c="jet"),typeof c=="string"){if(c=c.toLowerCase(),!t[c])throw Error(c+" not a supported colorscale");i=t[c]}else{if(!Array.isArray(c))throw Error("unsupported colormap option",c);i=c.slice()}if(i.length>a+1)throw new Error(c+" map requires nshades to be at least size "+i.length);g=Array.isArray(f.alpha)?f.alpha.length!==2?[1,1]:f.alpha.slice():typeof f.alpha=="number"?[f.alpha,f.alpha]:[1,1],l=i.map(function(T){return Math.round(T.index*a)}),g[0]=Math.min(Math.max(g[0],0),1),g[1]=Math.min(Math.max(g[1],0),1);var y=i.map(function(T,A){var S=i[A].index,w=i[A].rgb.slice();return w.length===4&&w[3]>=0&&w[3]<=1||(w[3]=g[0]+(g[1]-g[0])*S),w}),v=[];for(p=0;p<l.length-1;++p){s=l[p+1]-l[p],o=y[p],u=y[p+1];for(var b=0;b<s;b++){var x=b/s;v.push([Math.round(d(o[0],u[0],x)),Math.round(d(o[1],u[1],x)),Math.round(d(o[2],u[2],x)),d(o[3],u[3],x)])}}return v.push(i[i.length-1].rgb.concat(g[1])),n==="hex"?v=v.map(h):n==="rgbaString"?v=v.map(e):n==="float"&&(v=v.map(m)),v}},{"./colorScale":136,lerp:450}],138:[function(r,I,B){I.exports=function(l,o,u,s){var i=t(o,u,s);if(i===0){var c=d(t(l,o,u)),n=d(t(l,o,s));if(c===n){if(c===0){var a=f(l,o,u),g=f(l,o,s);return a===g?0:a?1:-1}return 0}return n===0?c>0||f(l,o,s)?-1:1:c===0?n>0||f(l,o,u)?1:-1:d(n-c)}var p=t(l,o,u);return p>0?i>0&&t(l,o,s)>0?1:-1:p<0?i>0||t(l,o,s)>0?1:-1:t(l,o,s)>0||f(l,o,u)?1:-1};var t=r("robust-orientation"),d=r("signum"),m=r("two-sum"),h=r("robust-product"),e=r("robust-sum");function f(l,o,u){var s=m(l[0],-o[0]),i=m(l[1],-o[1]),c=m(u[0],-o[0]),n=m(u[1],-o[1]),a=e(h(s,c),h(i,n));return a[a.length-1]>=0}},{"robust-orientation":534,"robust-product":535,"robust-sum":539,signum:541,"two-sum":589}],139:[function(r,I,B){I.exports=function(m,h){var e=m.length,f=m.length-h.length;if(f)return f;switch(e){case 0:return 0;case 1:return m[0]-h[0];case 2:return m[0]+m[1]-h[0]-h[1]||t(m[0],m[1])-t(h[0],h[1]);case 3:var l=m[0]+m[1],o=h[0]+h[1];if(f=l+m[2]-(o+h[2]))return f;var u=t(m[0],m[1]),s=t(h[0],h[1]);return t(u,m[2])-t(s,h[2])||t(u+m[2],l)-t(s+h[2],o);case 4:var i=m[0],c=m[1],n=m[2],a=m[3],g=h[0],p=h[1],y=h[2],v=h[3];return i+c+n+a-(g+p+y+v)||t(i,c,n,a)-t(g,p,y,v,g)||t(i+c,i+n,i+a,c+n,c+a,n+a)-t(g+p,g+y,g+v,p+y,p+v,y+v)||t(i+c+n,i+c+a,i+n+a,c+n+a)-t(g+p+y,g+p+v,g+y+v,p+y+v);default:for(var b=m.slice().sort(d),x=h.slice().sort(d),T=0;T<e;++T)if(f=b[T]-x[T])return f;return 0}};var t=Math.min;function d(m,h){return m-h}},{}],140:[function(r,I,B){var t=r("compare-cell"),d=r("cell-orientation");I.exports=function(m,h){return t(m,h)||d(m)-d(h)}},{"cell-orientation":123,"compare-cell":139}],141:[function(r,I,B){var t=r("./lib/ch1d"),d=r("./lib/ch2d"),m=r("./lib/chnd");I.exports=function(h){var e=h.length;if(e===0)return[];if(e===1)return[[0]];var f=h[0].length;return f===0?[]:f===1?t(h):f===2?d(h):m(h,f)}},{"./lib/ch1d":142,"./lib/ch2d":143,"./lib/chnd":144}],142:[function(r,I,B){I.exports=function(t){for(var d=0,m=0,h=1;h<t.length;++h)t[h][0]<t[d][0]&&(d=h),t[h][0]>t[m][0]&&(m=h);return d<m?[[d],[m]]:d>m?[[m],[d]]:[[d]]}},{}],143:[function(r,I,B){I.exports=function(d){var m=t(d),h=m.length;if(h<=2)return[];for(var e=new Array(h),f=m[h-1],l=0;l<h;++l){var o=m[l];e[l]=[f,o],f=o}return e};var t=r("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":458}],144:[function(r,I,B){I.exports=function(m,h){try{return t(m,!0)}catch(l){var e=d(m);if(e.length<=h)return[];var f=function(o,u){for(var s=o.length,i=new Array(s),c=0;c<u.length;++c)i[c]=o[u[c]];var n=u.length;for(c=0;c<s;++c)u.indexOf(c)<0&&(i[n++]=o[c]);return i}(m,e);return function(o,u){for(var s=o.length,i=u.length,c=0;c<s;++c)for(var n=o[c],a=0;a<n.length;++a){var g=n[a];if(g<i)n[a]=u[g];else{g-=i;for(var p=0;p<i;++p)g>=u[p]&&(g+=1);n[a]=g}}return o}(t(f,!0),e)}};var t=r("incremental-convex-hull"),d=r("affine-hull")},{"affine-hull":73,"incremental-convex-hull":438}],145:[function(r,I,B){I.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xE7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xE9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xE9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xE3)o.?tom(e|\xE9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],146:[function(r,I,B){I.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],147:[function(r,I,B){I.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],148:[function(r,I,B){I.exports=["normal","italic","oblique"]},{}],149:[function(r,I,B){I.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],150:[function(r,I,B){I.exports={parse:r("./parse"),stringify:r("./stringify")}},{"./parse":152,"./stringify":153}],151:[function(r,I,B){var t=r("css-font-size-keywords");I.exports={isSize:function(d){return/^[\d\.]/.test(d)||d.indexOf("/")!==-1||t.indexOf(d)!==-1}}},{"css-font-size-keywords":146}],152:[function(r,I,B){var t=r("unquote"),d=r("css-global-keywords"),m=r("css-system-font-keywords"),h=r("css-font-weight-keywords"),e=r("css-font-style-keywords"),f=r("css-font-stretch-keywords"),l=r("string-split-by"),o=r("./lib/util").isSize;I.exports=s;var u=s.cache={};function s(c){if(typeof c!="string")throw new Error("Font argument must be a string.");if(u[c])return u[c];if(c==="")throw new Error("Cannot parse an empty string.");if(m.indexOf(c)!==-1)return u[c]={system:c};for(var n,a={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},g=l(c,/\s+/);n=g.shift();){if(d.indexOf(n)!==-1)return["style","variant","weight","stretch"].forEach(function(y){a[y]=n}),u[c]=a;if(e.indexOf(n)===-1)if(n!=="normal"&&n!=="small-caps")if(f.indexOf(n)===-1){if(h.indexOf(n)===-1){if(o(n)){var p=l(n,"/");if(a.size=p[0],p[1]!=null?a.lineHeight=i(p[1]):g[0]==="/"&&(g.shift(),a.lineHeight=i(g.shift())),!g.length)throw new Error("Missing required font-family.");return a.family=l(g.join(" "),/\s*,\s*/).map(t),u[c]=a}throw new Error("Unknown or unsupported font token: "+n)}a.weight=n}else a.stretch=n;else a.variant=n;else a.style=n}throw new Error("Missing required font-size.")}function i(c){var n=parseFloat(c);return n.toString()===c?n:c}},{"./lib/util":151,"css-font-stretch-keywords":147,"css-font-style-keywords":148,"css-font-weight-keywords":149,"css-global-keywords":154,"css-system-font-keywords":155,"string-split-by":574,unquote:604}],153:[function(r,I,B){var t=r("pick-by-alias"),d=r("./lib/util").isSize,m=n(r("css-global-keywords")),h=n(r("css-system-font-keywords")),e=n(r("css-font-weight-keywords")),f=n(r("css-font-style-keywords")),l=n(r("css-font-stretch-keywords")),o={normal:1,"small-caps":1},u={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},s="1rem",i="serif";function c(a,g){if(a&&!g[a]&&!m[a])throw Error("Unknown keyword `"+a+"`");return a}function n(a){for(var g={},p=0;p<a.length;p++)g[a[p]]=1;return g}I.exports=function(a){if((a=t(a,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"})).system)return a.system&&c(a.system,h),a.system;if(c(a.style,f),c(a.variant,o),c(a.weight,e),c(a.stretch,l),a.size==null&&(a.size=s),typeof a.size=="number"&&(a.size+="px"),!d)throw Error("Bad size value `"+a.size+"`");a.family||(a.family=i),Array.isArray(a.family)&&(a.family.length||(a.family=[i]),a.family=a.family.map(function(p){return u[p]?p:'"'+p+'"'}).join(", "));var g=[];return g.push(a.style),a.variant!==a.style&&g.push(a.variant),a.weight!==a.variant&&a.weight!==a.style&&g.push(a.weight),a.stretch!==a.weight&&a.stretch!==a.variant&&a.stretch!==a.style&&g.push(a.stretch),g.push(a.size+(a.lineHeight==null||a.lineHeight==="normal"||a.lineHeight+""=="1"?"":"/"+a.lineHeight)),g.push(a.family),g.filter(Boolean).join(" ")}},{"./lib/util":151,"css-font-stretch-keywords":147,"css-font-style-keywords":148,"css-font-weight-keywords":149,"css-global-keywords":154,"css-system-font-keywords":155,"pick-by-alias":485}],154:[function(r,I,B){I.exports=["inherit","initial","unset"]},{}],155:[function(r,I,B){I.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],156:[function(r,I,B){I.exports=function(t,d,m,h,e,f){var l=e-1,o=e*e,u=l*l,s=(1+2*e)*u,i=e*u,c=o*(3-2*e),n=o*l;if(t.length){f||(f=new Array(t.length));for(var a=t.length-1;a>=0;--a)f[a]=s*t[a]+i*d[a]+c*m[a]+n*h[a];return f}return s*t+i*d+c*m+n*h},I.exports.derivative=function(t,d,m,h,e,f){var l=6*e*e-6*e,o=3*e*e-4*e+1,u=-6*e*e+6*e,s=3*e*e-2*e;if(t.length){f||(f=new Array(t.length));for(var i=t.length-1;i>=0;--i)f[i]=l*t[i]+o*d[i]+u*m[i]+s*h[i];return f}return l*t+o*d+u*m[i]+s*h}},{}],157:[function(r,I,B){var t,d=r("type/value/is"),m=r("type/value/ensure"),h=r("type/plain-function/ensure"),e=r("es5-ext/object/copy"),f=r("es5-ext/object/normalize-options"),l=r("es5-ext/object/map"),o=Function.prototype.bind,u=Object.defineProperty,s=Object.prototype.hasOwnProperty;t=function(i,c,n){var a,g=m(c)&&h(c.value);return delete(a=e(c)).writable,delete a.value,a.get=function(){return!n.overwriteDefinition&&s.call(this,i)?g:(c.value=o.call(g,n.resolveContext?n.resolveContext(this):this),u(this,i,c),this[i])},a},I.exports=function(i){var c=f(arguments[1]);return d(c.resolveContext)&&h(c.resolveContext),l(i,function(n,a){return t(a,n,c)})}},{"es5-ext/object/copy":202,"es5-ext/object/map":210,"es5-ext/object/normalize-options":211,"type/plain-function/ensure":595,"type/value/ensure":599,"type/value/is":600}],158:[function(r,I,B){var t=r("type/value/is"),d=r("type/plain-function/is"),m=r("es5-ext/object/assign"),h=r("es5-ext/object/normalize-options"),e=r("es5-ext/string/#/contains");(I.exports=function(f,l){var o,u,s,i,c;return arguments.length<2||typeof f!="string"?(i=l,l=f,f=null):i=arguments[2],t(f)?(o=e.call(f,"c"),u=e.call(f,"e"),s=e.call(f,"w")):(o=s=!0,u=!1),c={value:l,configurable:o,enumerable:u,writable:s},i?m(h(i),c):c}).gs=function(f,l,o){var u,s,i,c;return typeof f!="string"?(i=o,o=l,l=f,f=null):i=arguments[3],t(l)?d(l)?t(o)?d(o)||(i=o,o=void 0):o=void 0:(i=l,l=o=void 0):l=void 0,t(f)?(u=e.call(f,"c"),s=e.call(f,"e")):(u=!0,s=!1),c={get:l,set:o,configurable:u,enumerable:s},i?m(h(i),c):c}},{"es5-ext/object/assign":199,"es5-ext/object/normalize-options":211,"es5-ext/string/#/contains":218,"type/plain-function/is":596,"type/value/is":600}],159:[function(r,I,B){(function(t,d){d(typeof B=="object"&&I!==void 0?B:t.d3=t.d3||{})})(this,function(t){function d(M,P){return M<P?-1:M>P?1:M>=P?0:NaN}function m(M){var P;return M.length===1&&(P=M,M=function(D,N){return d(P(D),N)}),{left:function(D,N,U,G){for(U==null&&(U=0),G==null&&(G=D.length);U<G;){var X=U+G>>>1;M(D[X],N)<0?U=X+1:G=X}return U},right:function(D,N,U,G){for(U==null&&(U=0),G==null&&(G=D.length);U<G;){var X=U+G>>>1;M(D[X],N)>0?G=X:U=X+1}return U}}}var h=m(d),e=h.right,f=h.left;function l(M,P){return[M,P]}function o(M){return M===null?NaN:+M}function u(M,P){var D,N,U=M.length,G=0,X=-1,K=0,Z=0;if(P==null)for(;++X<U;)isNaN(D=o(M[X]))||(Z+=(N=D-K)*(D-(K+=N/++G)));else for(;++X<U;)isNaN(D=o(P(M[X],X,M)))||(Z+=(N=D-K)*(D-(K+=N/++G)));if(G>1)return Z/(G-1)}function s(M,P){var D=u(M,P);return D&&Math.sqrt(D)}function i(M,P){var D,N,U,G=M.length,X=-1;if(P==null){for(;++X<G;)if((D=M[X])!=null&&D>=D)for(N=U=D;++X<G;)(D=M[X])!=null&&(N>D&&(N=D),U<D&&(U=D))}else for(;++X<G;)if((D=P(M[X],X,M))!=null&&D>=D)for(N=U=D;++X<G;)(D=P(M[X],X,M))!=null&&(N>D&&(N=D),U<D&&(U=D));return[N,U]}var c=Array.prototype,n=c.slice,a=c.map;function g(M){return function(){return M}}function p(M){return M}function y(M,P,D){M=+M,P=+P,D=(U=arguments.length)<2?(P=M,M=0,1):U<3?1:+D;for(var N=-1,U=0|Math.max(0,Math.ceil((P-M)/D)),G=new Array(U);++N<U;)G[N]=M+N*D;return G}var v=Math.sqrt(50),b=Math.sqrt(10),x=Math.sqrt(2);function T(M,P,D){var N=(P-M)/Math.max(0,D),U=Math.floor(Math.log(N)/Math.LN10),G=N/Math.pow(10,U);return U>=0?(G>=v?10:G>=b?5:G>=x?2:1)*Math.pow(10,U):-Math.pow(10,-U)/(G>=v?10:G>=b?5:G>=x?2:1)}function A(M,P,D){var N=Math.abs(P-M)/Math.max(0,D),U=Math.pow(10,Math.floor(Math.log(N)/Math.LN10)),G=N/U;return G>=v?U*=10:G>=b?U*=5:G>=x&&(U*=2),P<M?-U:U}function S(M){return Math.ceil(Math.log(M.length)/Math.LN2)+1}function w(M,P,D){if(D==null&&(D=o),N=M.length){if((P=+P)<=0||N<2)return+D(M[0],0,M);if(P>=1)return+D(M[N-1],N-1,M);var N,U=(N-1)*P,G=Math.floor(U),X=+D(M[G],G,M);return X+(+D(M[G+1],G+1,M)-X)*(U-G)}}function E(M,P){var D,N,U=M.length,G=-1;if(P==null){for(;++G<U;)if((D=M[G])!=null&&D>=D)for(N=D;++G<U;)(D=M[G])!=null&&N>D&&(N=D)}else for(;++G<U;)if((D=P(M[G],G,M))!=null&&D>=D)for(N=D;++G<U;)(D=P(M[G],G,M))!=null&&N>D&&(N=D);return N}function k(M){if(!(U=M.length))return[];for(var P=-1,D=E(M,L),N=new Array(D);++P<D;)for(var U,G=-1,X=N[P]=new Array(U);++G<U;)X[G]=M[G][P];return N}function L(M){return M.length}t.bisect=e,t.bisectRight=e,t.bisectLeft=f,t.ascending=d,t.bisector=m,t.cross=function(M,P,D){var N,U,G,X,K=M.length,Z=P.length,H=new Array(K*Z);for(D==null&&(D=l),N=G=0;N<K;++N)for(X=M[N],U=0;U<Z;++U,++G)H[G]=D(X,P[U]);return H},t.descending=function(M,P){return P<M?-1:P>M?1:P>=M?0:NaN},t.deviation=s,t.extent=i,t.histogram=function(){var M=p,P=i,D=S;function N(U){var G,X,K=U.length,Z=new Array(K);for(G=0;G<K;++G)Z[G]=M(U[G],G,U);var H=P(Z),Y=H[0],$=H[1],z=D(Z,Y,$);Array.isArray(z)||(z=A(Y,$,z),z=y(Math.ceil(Y/z)*z,$,z));for(var j=z.length;z[0]<=Y;)z.shift(),--j;for(;z[j-1]>$;)z.pop(),--j;var W,ee=new Array(j+1);for(G=0;G<=j;++G)(W=ee[G]=[]).x0=G>0?z[G-1]:Y,W.x1=G<j?z[G]:$;for(G=0;G<K;++G)Y<=(X=Z[G])&&X<=$&&ee[e(z,X,0,j)].push(U[G]);return ee}return N.value=function(U){return arguments.length?(M=typeof U=="function"?U:g(U),N):M},N.domain=function(U){return arguments.length?(P=typeof U=="function"?U:g([U[0],U[1]]),N):P},N.thresholds=function(U){return arguments.length?(D=typeof U=="function"?U:Array.isArray(U)?g(n.call(U)):g(U),N):D},N},t.thresholdFreedmanDiaconis=function(M,P,D){return M=a.call(M,o).sort(d),Math.ceil((D-P)/(2*(w(M,.75)-w(M,.25))*Math.pow(M.length,-1/3)))},t.thresholdScott=function(M,P,D){return Math.ceil((D-P)/(3.5*s(M)*Math.pow(M.length,-1/3)))},t.thresholdSturges=S,t.max=function(M,P){var D,N,U=M.length,G=-1;if(P==null){for(;++G<U;)if((D=M[G])!=null&&D>=D)for(N=D;++G<U;)(D=M[G])!=null&&D>N&&(N=D)}else for(;++G<U;)if((D=P(M[G],G,M))!=null&&D>=D)for(N=D;++G<U;)(D=P(M[G],G,M))!=null&&D>N&&(N=D);return N},t.mean=function(M,P){var D,N=M.length,U=N,G=-1,X=0;if(P==null)for(;++G<N;)isNaN(D=o(M[G]))?--U:X+=D;else for(;++G<N;)isNaN(D=o(P(M[G],G,M)))?--U:X+=D;if(U)return X/U},t.median=function(M,P){var D,N=M.length,U=-1,G=[];if(P==null)for(;++U<N;)isNaN(D=o(M[U]))||G.push(D);else for(;++U<N;)isNaN(D=o(P(M[U],U,M)))||G.push(D);return w(G.sort(d),.5)},t.merge=function(M){for(var P,D,N,U=M.length,G=-1,X=0;++G<U;)X+=M[G].length;for(D=new Array(X);--U>=0;)for(P=(N=M[U]).length;--P>=0;)D[--X]=N[P];return D},t.min=E,t.pairs=function(M,P){P==null&&(P=l);for(var D=0,N=M.length-1,U=M[0],G=new Array(N<0?0:N);D<N;)G[D]=P(U,U=M[++D]);return G},t.permute=function(M,P){for(var D=P.length,N=new Array(D);D--;)N[D]=M[P[D]];return N},t.quantile=w,t.range=y,t.scan=function(M,P){if(D=M.length){var D,N,U=0,G=0,X=M[G];for(P==null&&(P=d);++U<D;)(P(N=M[U],X)<0||P(X,X)!==0)&&(X=N,G=U);return P(X,X)===0?G:void 0}},t.shuffle=function(M,P,D){for(var N,U,G=(D==null?M.length:D)-(P=P==null?0:+P);G;)U=Math.random()*G--|0,N=M[G+P],M[G+P]=M[U+P],M[U+P]=N;return M},t.sum=function(M,P){var D,N=M.length,U=-1,G=0;if(P==null)for(;++U<N;)(D=+M[U])&&(G+=D);else for(;++U<N;)(D=+P(M[U],U,M))&&(G+=D);return G},t.ticks=function(M,P,D){var N,U,G,X,K=-1;if(D=+D,(M=+M)==(P=+P)&&D>0)return[M];if((N=P<M)&&(U=M,M=P,P=U),(X=T(M,P,D))===0||!isFinite(X))return[];if(X>0)for(M=Math.ceil(M/X),P=Math.floor(P/X),G=new Array(U=Math.ceil(P-M+1));++K<U;)G[K]=(M+K)*X;else for(M=Math.floor(M*X),P=Math.ceil(P*X),G=new Array(U=Math.ceil(M-P+1));++K<U;)G[K]=(M-K)/X;return N&&G.reverse(),G},t.tickIncrement=T,t.tickStep=A,t.transpose=k,t.variance=u,t.zip=function(){return k(arguments)},Object.defineProperty(t,"__esModule",{value:!0})})},{}],160:[function(r,I,B){(function(t,d){d(typeof B=="object"&&I!==void 0?B:t.d3=t.d3||{})})(this,function(t){function d(){}function m(i,c){var n=new d;if(i instanceof d)i.each(function(v,b){n.set(b,v)});else if(Array.isArray(i)){var a,g=-1,p=i.length;if(c==null)for(;++g<p;)n.set(g,i[g]);else for(;++g<p;)n.set(c(a=i[g],g,i),a)}else if(i)for(var y in i)n.set(y,i[y]);return n}function h(){return{}}function e(i,c,n){i[c]=n}function f(){return m()}function l(i,c,n){i.set(c,n)}function o(){}d.prototype=m.prototype={constructor:d,has:function(i){return"$"+i in this},get:function(i){return this["$"+i]},set:function(i,c){return this["$"+i]=c,this},remove:function(i){var c="$"+i;return c in this&&delete this[c]},clear:function(){for(var i in this)i[0]==="$"&&delete this[i]},keys:function(){var i=[];for(var c in this)c[0]==="$"&&i.push(c.slice(1));return i},values:function(){var i=[];for(var c in this)c[0]==="$"&&i.push(this[c]);return i},entries:function(){var i=[];for(var c in this)c[0]==="$"&&i.push({key:c.slice(1),value:this[c]});return i},size:function(){var i=0;for(var c in this)c[0]==="$"&&++i;return i},empty:function(){for(var i in this)if(i[0]==="$")return!1;return!0},each:function(i){for(var c in this)c[0]==="$"&&i(this[c],c.slice(1),this)}};var u=m.prototype;function s(i,c){var n=new o;if(i instanceof o)i.each(function(p){n.add(p)});else if(i){var a=-1,g=i.length;if(c==null)for(;++a<g;)n.add(i[a]);else for(;++a<g;)n.add(c(i[a],a,i))}return n}o.prototype=s.prototype={constructor:o,has:u.has,add:function(i){return this["$"+(i+="")]=i,this},remove:u.remove,clear:u.clear,values:u.keys,size:u.size,empty:u.empty,each:u.each},t.nest=function(){var i,c,n,a=[],g=[];function p(y,v,b,x){if(v>=a.length)return i!=null&&y.sort(i),c!=null?c(y):y;for(var T,A,S,w=-1,E=y.length,k=a[v++],L=m(),M=b();++w<E;)(S=L.get(T=k(A=y[w])+""))?S.push(A):L.set(T,[A]);return L.each(function(P,D){x(M,D,p(P,v,b,x))}),M}return n={object:function(y){return p(y,0,h,e)},map:function(y){return p(y,0,f,l)},entries:function(y){return function v(b,x){if(++x>a.length)return b;var T,A=g[x-1];return c!=null&&x>=a.length?T=b.entries():(T=[],b.each(function(S,w){T.push({key:w,values:v(S,x)})})),A!=null?T.sort(function(S,w){return A(S.key,w.key)}):T}(p(y,0,f,l),0)},key:function(y){return a.push(y),n},sortKeys:function(y){return g[a.length-1]=y,n},sortValues:function(y){return i=y,n},rollup:function(y){return c=y,n}}},t.set=s,t.map=m,t.keys=function(i){var c=[];for(var n in i)c.push(n);return c},t.values=function(i){var c=[];for(var n in i)c.push(i[n]);return c},t.entries=function(i){var c=[];for(var n in i)c.push({key:n,value:i[n]});return c},Object.defineProperty(t,"__esModule",{value:!0})})},{}],161:[function(r,I,B){(function(t,d){d(typeof B=="object"&&I!==void 0?B:(t=t||self).d3=t.d3||{})})(this,function(t){function d(ce,ge,we){ce.prototype=ge.prototype=we,we.constructor=ce}function m(ce,ge){var we=Object.create(ce.prototype);for(var Me in ge)we[Me]=ge[Me];return we}function h(){}var e="\\s*([+-]?\\d+)\\s*",f="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",o=/^#([0-9a-f]{3,8})$/,u=new RegExp("^rgb\\("+[e,e,e]+"\\)$"),s=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),i=new RegExp("^rgba\\("+[e,e,e,f]+"\\)$"),c=new RegExp("^rgba\\("+[l,l,l,f]+"\\)$"),n=new RegExp("^hsl\\("+[f,l,l]+"\\)$"),a=new RegExp("^hsla\\("+[f,l,l,f]+"\\)$"),g={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function p(){return this.rgb().formatHex()}function y(){return this.rgb().formatRgb()}function v(ce){var ge,we;return ce=(ce+"").trim().toLowerCase(),(ge=o.exec(ce))?(we=ge[1].length,ge=parseInt(ge[1],16),we===6?b(ge):we===3?new S(ge>>8&15|ge>>4&240,ge>>4&15|240&ge,(15&ge)<<4|15&ge,1):we===8?x(ge>>24&255,ge>>16&255,ge>>8&255,(255&ge)/255):we===4?x(ge>>12&15|ge>>8&240,ge>>8&15|ge>>4&240,ge>>4&15|240&ge,((15&ge)<<4|15&ge)/255):null):(ge=u.exec(ce))?new S(ge[1],ge[2],ge[3],1):(ge=s.exec(ce))?new S(255*ge[1]/100,255*ge[2]/100,255*ge[3]/100,1):(ge=i.exec(ce))?x(ge[1],ge[2],ge[3],ge[4]):(ge=c.exec(ce))?x(255*ge[1]/100,255*ge[2]/100,255*ge[3]/100,ge[4]):(ge=n.exec(ce))?L(ge[1],ge[2]/100,ge[3]/100,1):(ge=a.exec(ce))?L(ge[1],ge[2]/100,ge[3]/100,ge[4]):g.hasOwnProperty(ce)?b(g[ce]):ce==="transparent"?new S(NaN,NaN,NaN,0):null}function b(ce){return new S(ce>>16&255,ce>>8&255,255&ce,1)}function x(ce,ge,we,Me){return Me<=0&&(ce=ge=we=NaN),new S(ce,ge,we,Me)}function T(ce){return ce instanceof h||(ce=v(ce)),ce?new S((ce=ce.rgb()).r,ce.g,ce.b,ce.opacity):new S}function A(ce,ge,we,Me){return arguments.length===1?T(ce):new S(ce,ge,we,Me==null?1:Me)}function S(ce,ge,we,Me){this.r=+ce,this.g=+ge,this.b=+we,this.opacity=+Me}function w(){return"#"+k(this.r)+k(this.g)+k(this.b)}function E(){var ce=this.opacity;return((ce=isNaN(ce)?1:Math.max(0,Math.min(1,ce)))===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(ce===1?")":", "+ce+")")}function k(ce){return((ce=Math.max(0,Math.min(255,Math.round(ce)||0)))<16?"0":"")+ce.toString(16)}function L(ce,ge,we,Me){return Me<=0?ce=ge=we=NaN:we<=0||we>=1?ce=ge=NaN:ge<=0&&(ce=NaN),new D(ce,ge,we,Me)}function M(ce){if(ce instanceof D)return new D(ce.h,ce.s,ce.l,ce.opacity);if(ce instanceof h||(ce=v(ce)),!ce)return new D;if(ce instanceof D)return ce;var ge=(ce=ce.rgb()).r/255,we=ce.g/255,Me=ce.b/255,Se=Math.min(ge,we,Me),ze=Math.max(ge,we,Me),Fe=NaN,Ye=ze-Se,rt=(ze+Se)/2;return Ye?(Fe=ge===ze?(we-Me)/Ye+6*(we<Me):we===ze?(Me-ge)/Ye+2:(ge-we)/Ye+4,Ye/=rt<.5?ze+Se:2-ze-Se,Fe*=60):Ye=rt>0&&rt<1?0:Fe,new D(Fe,Ye,rt,ce.opacity)}function P(ce,ge,we,Me){return arguments.length===1?M(ce):new D(ce,ge,we,Me==null?1:Me)}function D(ce,ge,we,Me){this.h=+ce,this.s=+ge,this.l=+we,this.opacity=+Me}function N(ce,ge,we){return 255*(ce<60?ge+(we-ge)*ce/60:ce<180?we:ce<240?ge+(we-ge)*(240-ce)/60:ge)}d(h,v,{copy:function(ce){return Object.assign(new this.constructor,this,ce)},displayable:function(){return this.rgb().displayable()},hex:p,formatHex:p,formatHsl:function(){return M(this).formatHsl()},formatRgb:y,toString:y}),d(S,A,m(h,{brighter:function(ce){return ce=ce==null?1/.7:Math.pow(1/.7,ce),new S(this.r*ce,this.g*ce,this.b*ce,this.opacity)},darker:function(ce){return ce=ce==null?.7:Math.pow(.7,ce),new S(this.r*ce,this.g*ce,this.b*ce,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:w,formatHex:w,formatRgb:E,toString:E})),d(D,P,m(h,{brighter:function(ce){return ce=ce==null?1/.7:Math.pow(1/.7,ce),new D(this.h,this.s,this.l*ce,this.opacity)},darker:function(ce){return ce=ce==null?.7:Math.pow(.7,ce),new D(this.h,this.s,this.l*ce,this.opacity)},rgb:function(){var ce=this.h%360+360*(this.h<0),ge=isNaN(ce)||isNaN(this.s)?0:this.s,we=this.l,Me=we+(we<.5?we:1-we)*ge,Se=2*we-Me;return new S(N(ce>=240?ce-240:ce+120,Se,Me),N(ce,Se,Me),N(ce<120?ce+240:ce-120,Se,Me),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var ce=this.opacity;return((ce=isNaN(ce)?1:Math.max(0,Math.min(1,ce)))===1?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(ce===1?")":", "+ce+")")}}));var U=Math.PI/180,G=180/Math.PI,X=6/29,K=3*X*X;function Z(ce){if(ce instanceof Y)return new Y(ce.l,ce.a,ce.b,ce.opacity);if(ce instanceof Q)return te(ce);ce instanceof S||(ce=T(ce));var ge,we,Me=W(ce.r),Se=W(ce.g),ze=W(ce.b),Fe=$((.2225045*Me+.7168786*Se+.0606169*ze)/1);return Me===Se&&Se===ze?ge=we=Fe:(ge=$((.4360747*Me+.3850649*Se+.1430804*ze)/.96422),we=$((.0139322*Me+.0971045*Se+.7141733*ze)/.82521)),new Y(116*Fe-16,500*(ge-Fe),200*(Fe-we),ce.opacity)}function H(ce,ge,we,Me){return arguments.length===1?Z(ce):new Y(ce,ge,we,Me==null?1:Me)}function Y(ce,ge,we,Me){this.l=+ce,this.a=+ge,this.b=+we,this.opacity=+Me}function $(ce){return ce>.008856451679035631?Math.pow(ce,1/3):ce/K+4/29}function z(ce){return ce>X?ce*ce*ce:K*(ce-4/29)}function j(ce){return 255*(ce<=.0031308?12.92*ce:1.055*Math.pow(ce,1/2.4)-.055)}function W(ce){return(ce/=255)<=.04045?ce/12.92:Math.pow((ce+.055)/1.055,2.4)}function ee(ce){if(ce instanceof Q)return new Q(ce.h,ce.c,ce.l,ce.opacity);if(ce instanceof Y||(ce=Z(ce)),ce.a===0&&ce.b===0)return new Q(NaN,0<ce.l&&ce.l<100?0:NaN,ce.l,ce.opacity);var ge=Math.atan2(ce.b,ce.a)*G;return new Q(ge<0?ge+360:ge,Math.sqrt(ce.a*ce.a+ce.b*ce.b),ce.l,ce.opacity)}function J(ce,ge,we,Me){return arguments.length===1?ee(ce):new Q(ce,ge,we,Me==null?1:Me)}function Q(ce,ge,we,Me){this.h=+ce,this.c=+ge,this.l=+we,this.opacity=+Me}function te(ce){if(isNaN(ce.h))return new Y(ce.l,0,0,ce.opacity);var ge=ce.h*U;return new Y(ce.l,Math.cos(ge)*ce.c,Math.sin(ge)*ce.c,ce.opacity)}d(Y,H,m(h,{brighter:function(ce){return new Y(this.l+18*(ce==null?1:ce),this.a,this.b,this.opacity)},darker:function(ce){return new Y(this.l-18*(ce==null?1:ce),this.a,this.b,this.opacity)},rgb:function(){var ce=(this.l+16)/116,ge=isNaN(this.a)?ce:ce+this.a/500,we=isNaN(this.b)?ce:ce-this.b/200;return new S(j(3.1338561*(ge=.96422*z(ge))-1.6168667*(ce=1*z(ce))-.4906146*(we=.82521*z(we))),j(-.9787684*ge+1.9161415*ce+.033454*we),j(.0719453*ge-.2289914*ce+1.4052427*we),this.opacity)}})),d(Q,J,m(h,{brighter:function(ce){return new Q(this.h,this.c,this.l+18*(ce==null?1:ce),this.opacity)},darker:function(ce){return new Q(this.h,this.c,this.l-18*(ce==null?1:ce),this.opacity)},rgb:function(){return te(this).rgb()}}));var ie=-.14861,ae=1.78277,he=-.29227,se=-.90649,de=1.97294,ue=de*se,ve=de*ae,ke=ae*he-se*ie;function Ee(ce){if(ce instanceof xe)return new xe(ce.h,ce.s,ce.l,ce.opacity);ce instanceof S||(ce=T(ce));var ge=ce.r/255,we=ce.g/255,Me=ce.b/255,Se=(ke*Me+ue*ge-ve*we)/(ke+ue-ve),ze=Me-Se,Fe=(de*(we-Se)-he*ze)/se,Ye=Math.sqrt(Fe*Fe+ze*ze)/(de*Se*(1-Se)),rt=Ye?Math.atan2(Fe,ze)*G-120:NaN;return new xe(rt<0?rt+360:rt,Ye,Se,ce.opacity)}function be(ce,ge,we,Me){return arguments.length===1?Ee(ce):new xe(ce,ge,we,Me==null?1:Me)}function xe(ce,ge,we,Me){this.h=+ce,this.s=+ge,this.l=+we,this.opacity=+Me}d(xe,be,m(h,{brighter:function(ce){return ce=ce==null?1/.7:Math.pow(1/.7,ce),new xe(this.h,this.s,this.l*ce,this.opacity)},darker:function(ce){return ce=ce==null?.7:Math.pow(.7,ce),new xe(this.h,this.s,this.l*ce,this.opacity)},rgb:function(){var ce=isNaN(this.h)?0:(this.h+120)*U,ge=+this.l,we=isNaN(this.s)?0:this.s*ge*(1-ge),Me=Math.cos(ce),Se=Math.sin(ce);return new S(255*(ge+we*(ie*Me+ae*Se)),255*(ge+we*(he*Me+se*Se)),255*(ge+we*(de*Me)),this.opacity)}})),t.color=v,t.cubehelix=be,t.gray=function(ce,ge){return new Y(ce,0,0,ge==null?1:ge)},t.hcl=J,t.hsl=P,t.lab=H,t.lch=function(ce,ge,we,Me){return arguments.length===1?ee(ce):new Q(we,ge,ce,Me==null?1:Me)},t.rgb=A,Object.defineProperty(t,"__esModule",{value:!0})})},{}],162:[function(r,I,B){(function(t,d){d(typeof B=="object"&&I!==void 0?B:(t=t||self).d3=t.d3||{})})(this,function(t){var d={value:function(){}};function m(){for(var o,u=0,s=arguments.length,i={};u<s;++u){if(!(o=arguments[u]+"")||o in i||/[\s.]/.test(o))throw new Error("illegal type: "+o);i[o]=[]}return new h(i)}function h(o){this._=o}function e(o,u){return o.trim().split(/^|\s+/).map(function(s){var i="",c=s.indexOf(".");if(c>=0&&(i=s.slice(c+1),s=s.slice(0,c)),s&&!u.hasOwnProperty(s))throw new Error("unknown type: "+s);return{type:s,name:i}})}function f(o,u){for(var s,i=0,c=o.length;i<c;++i)if((s=o[i]).name===u)return s.value}function l(o,u,s){for(var i=0,c=o.length;i<c;++i)if(o[i].name===u){o[i]=d,o=o.slice(0,i).concat(o.slice(i+1));break}return s!=null&&o.push({name:u,value:s}),o}h.prototype=m.prototype={constructor:h,on:function(o,u){var s,i=this._,c=e(o+"",i),n=-1,a=c.length;if(!(arguments.length<2)){if(u!=null&&typeof u!="function")throw new Error("invalid callback: "+u);for(;++n<a;)if(s=(o=c[n]).type)i[s]=l(i[s],o.name,u);else if(u==null)for(s in i)i[s]=l(i[s],o.name,null);return this}for(;++n<a;)if((s=(o=c[n]).type)&&(s=f(i[s],o.name)))return s},copy:function(){var o={},u=this._;for(var s in u)o[s]=u[s].slice();return new h(o)},call:function(o,u){if((s=arguments.length-2)>0)for(var s,i,c=new Array(s),n=0;n<s;++n)c[n]=arguments[n+2];if(!this._.hasOwnProperty(o))throw new Error("unknown type: "+o);for(n=0,s=(i=this._[o]).length;n<s;++n)i[n].value.apply(u,c)},apply:function(o,u,s){if(!this._.hasOwnProperty(o))throw new Error("unknown type: "+o);for(var i=this._[o],c=0,n=i.length;c<n;++c)i[c].value.apply(u,s)}},t.dispatch=m,Object.defineProperty(t,"__esModule",{value:!0})})},{}],163:[function(r,I,B){(function(t,d){typeof B=="object"&&I!==void 0?d(B,r("d3-quadtree"),r("d3-collection"),r("d3-dispatch"),r("d3-timer")):d(t.d3=t.d3||{},t.d3,t.d3,t.d3,t.d3)})(this,function(t,d,m,h,e){function f(g){return function(){return g}}function l(){return 1e-6*(Math.random()-.5)}function o(g){return g.x+g.vx}function u(g){return g.y+g.vy}function s(g){return g.index}function i(g,p){var y=g.get(p);if(!y)throw new Error("missing: "+p);return y}function c(g){return g.x}function n(g){return g.y}var a=Math.PI*(3-Math.sqrt(5));t.forceCenter=function(g,p){var y;function v(){var b,x,T=y.length,A=0,S=0;for(b=0;b<T;++b)A+=(x=y[b]).x,S+=x.y;for(A=A/T-g,S=S/T-p,b=0;b<T;++b)(x=y[b]).x-=A,x.y-=S}return g==null&&(g=0),p==null&&(p=0),v.initialize=function(b){y=b},v.x=function(b){return arguments.length?(g=+b,v):g},v.y=function(b){return arguments.length?(p=+b,v):p},v},t.forceCollide=function(g){var p,y,v=1,b=1;function x(){for(var S,w,E,k,L,M,P,D=p.length,N=0;N<b;++N)for(w=d.quadtree(p,o,u).visitAfter(T),S=0;S<D;++S)E=p[S],M=y[E.index],P=M*M,k=E.x+E.vx,L=E.y+E.vy,w.visit(U);function U(G,X,K,Z,H){var Y=G.data,$=G.r,z=M+$;if(!Y)return X>k+z||Z<k-z||K>L+z||H<L-z;if(Y.index>E.index){var j=k-Y.x-Y.vx,W=L-Y.y-Y.vy,ee=j*j+W*W;ee<z*z&&(j===0&&(ee+=(j=l())*j),W===0&&(ee+=(W=l())*W),ee=(z-(ee=Math.sqrt(ee)))/ee*v,E.vx+=(j*=ee)*(z=($*=$)/(P+$)),E.vy+=(W*=ee)*z,Y.vx-=j*(z=1-z),Y.vy-=W*z)}}}function T(S){if(S.data)return S.r=y[S.data.index];for(var w=S.r=0;w<4;++w)S[w]&&S[w].r>S.r&&(S.r=S[w].r)}function A(){if(p){var S,w,E=p.length;for(y=new Array(E),S=0;S<E;++S)w=p[S],y[w.index]=+g(w,S,p)}}return typeof g!="function"&&(g=f(g==null?1:+g)),x.initialize=function(S){p=S,A()},x.iterations=function(S){return arguments.length?(b=+S,x):b},x.strength=function(S){return arguments.length?(v=+S,x):v},x.radius=function(S){return arguments.length?(g=typeof S=="function"?S:f(+S),A(),x):g},x},t.forceLink=function(g){var p,y,v,b,x,T=s,A=function(P){return 1/Math.min(b[P.source.index],b[P.target.index])},S=f(30),w=1;function E(P){for(var D=0,N=g.length;D<w;++D)for(var U,G,X,K,Z,H,Y,$=0;$<N;++$)G=(U=g[$]).source,K=(X=U.target).x+X.vx-G.x-G.vx||l(),Z=X.y+X.vy-G.y-G.vy||l(),K*=H=((H=Math.sqrt(K*K+Z*Z))-y[$])/H*P*p[$],Z*=H,X.vx-=K*(Y=x[$]),X.vy-=Z*Y,G.vx+=K*(Y=1-Y),G.vy+=Z*Y}function k(){if(v){var P,D,N=v.length,U=g.length,G=m.map(v,T);for(P=0,b=new Array(N);P<U;++P)(D=g[P]).index=P,typeof D.source!="object"&&(D.source=i(G,D.source)),typeof D.target!="object"&&(D.target=i(G,D.target)),b[D.source.index]=(b[D.source.index]||0)+1,b[D.target.index]=(b[D.target.index]||0)+1;for(P=0,x=new Array(U);P<U;++P)D=g[P],x[P]=b[D.source.index]/(b[D.source.index]+b[D.target.index]);p=new Array(U),L(),y=new Array(U),M()}}function L(){if(v)for(var P=0,D=g.length;P<D;++P)p[P]=+A(g[P],P,g)}function M(){if(v)for(var P=0,D=g.length;P<D;++P)y[P]=+S(g[P],P,g)}return g==null&&(g=[]),E.initialize=function(P){v=P,k()},E.links=function(P){return arguments.length?(g=P,k(),E):g},E.id=function(P){return arguments.length?(T=P,E):T},E.iterations=function(P){return arguments.length?(w=+P,E):w},E.strength=function(P){return arguments.length?(A=typeof P=="function"?P:f(+P),L(),E):A},E.distance=function(P){return arguments.length?(S=typeof P=="function"?P:f(+P),M(),E):S},E},t.forceManyBody=function(){var g,p,y,v,b=f(-30),x=1,T=1/0,A=.81;function S(L){var M,P=g.length,D=d.quadtree(g,c,n).visitAfter(E);for(y=L,M=0;M<P;++M)p=g[M],D.visit(k)}function w(){if(g){var L,M,P=g.length;for(v=new Array(P),L=0;L<P;++L)M=g[L],v[M.index]=+b(M,L,g)}}function E(L){var M,P,D,N,U,G=0,X=0;if(L.length){for(D=N=U=0;U<4;++U)(M=L[U])&&(P=Math.abs(M.value))&&(G+=M.value,X+=P,D+=P*M.x,N+=P*M.y);L.x=D/X,L.y=N/X}else{(M=L).x=M.data.x,M.y=M.data.y;do G+=v[M.data.index];while(M=M.next)}L.value=G}function k(L,M,P,D){if(!L.value)return!0;var N=L.x-p.x,U=L.y-p.y,G=D-M,X=N*N+U*U;if(G*G/A<X)return X<T&&(N===0&&(X+=(N=l())*N),U===0&&(X+=(U=l())*U),X<x&&(X=Math.sqrt(x*X)),p.vx+=N*L.value*y/X,p.vy+=U*L.value*y/X),!0;if(!(L.length||X>=T)){(L.data!==p||L.next)&&(N===0&&(X+=(N=l())*N),U===0&&(X+=(U=l())*U),X<x&&(X=Math.sqrt(x*X)));do L.data!==p&&(G=v[L.data.index]*y/X,p.vx+=N*G,p.vy+=U*G);while(L=L.next)}}return S.initialize=function(L){g=L,w()},S.strength=function(L){return arguments.length?(b=typeof L=="function"?L:f(+L),w(),S):b},S.distanceMin=function(L){return arguments.length?(x=L*L,S):Math.sqrt(x)},S.distanceMax=function(L){return arguments.length?(T=L*L,S):Math.sqrt(T)},S.theta=function(L){return arguments.length?(A=L*L,S):Math.sqrt(A)},S},t.forceRadial=function(g,p,y){var v,b,x,T=f(.1);function A(w){for(var E=0,k=v.length;E<k;++E){var L=v[E],M=L.x-p||1e-6,P=L.y-y||1e-6,D=Math.sqrt(M*M+P*P),N=(x[E]-D)*b[E]*w/D;L.vx+=M*N,L.vy+=P*N}}function S(){if(v){var w,E=v.length;for(b=new Array(E),x=new Array(E),w=0;w<E;++w)x[w]=+g(v[w],w,v),b[w]=isNaN(x[w])?0:+T(v[w],w,v)}}return typeof g!="function"&&(g=f(+g)),p==null&&(p=0),y==null&&(y=0),A.initialize=function(w){v=w,S()},A.strength=function(w){return arguments.length?(T=typeof w=="function"?w:f(+w),S(),A):T},A.radius=function(w){return arguments.length?(g=typeof w=="function"?w:f(+w),S(),A):g},A.x=function(w){return arguments.length?(p=+w,A):p},A.y=function(w){return arguments.length?(y=+w,A):y},A},t.forceSimulation=function(g){var p,y=1,v=.001,b=1-Math.pow(v,1/300),x=0,T=.6,A=m.map(),S=e.timer(E),w=h.dispatch("tick","end");function E(){k(),w.call("tick",p),y<v&&(S.stop(),w.call("end",p))}function k(P){var D,N,U=g.length;P===void 0&&(P=1);for(var G=0;G<P;++G)for(y+=(x-y)*b,A.each(function(X){X(y)}),D=0;D<U;++D)(N=g[D]).fx==null?N.x+=N.vx*=T:(N.x=N.fx,N.vx=0),N.fy==null?N.y+=N.vy*=T:(N.y=N.fy,N.vy=0);return p}function L(){for(var P,D=0,N=g.length;D<N;++D){if((P=g[D]).index=D,P.fx!=null&&(P.x=P.fx),P.fy!=null&&(P.y=P.fy),isNaN(P.x)||isNaN(P.y)){var U=10*Math.sqrt(D),G=D*a;P.x=U*Math.cos(G),P.y=U*Math.sin(G)}(isNaN(P.vx)||isNaN(P.vy))&&(P.vx=P.vy=0)}}function M(P){return P.initialize&&P.initialize(g),P}return g==null&&(g=[]),L(),p={tick:k,restart:function(){return S.restart(E),p},stop:function(){return S.stop(),p},nodes:function(P){return arguments.length?(g=P,L(),A.each(M),p):g},alpha:function(P){return arguments.length?(y=+P,p):y},alphaMin:function(P){return arguments.length?(v=+P,p):v},alphaDecay:function(P){return arguments.length?(b=+P,p):+b},alphaTarget:function(P){return arguments.length?(x=+P,p):x},velocityDecay:function(P){return arguments.length?(T=1-P,p):1-T},force:function(P,D){return arguments.length>1?(D==null?A.remove(P):A.set(P,M(D)),p):A.get(P)},find:function(P,D,N){var U,G,X,K,Z,H=0,Y=g.length;for(N==null?N=1/0:N*=N,H=0;H<Y;++H)(X=(U=P-(K=g[H]).x)*U+(G=D-K.y)*G)<N&&(Z=K,N=X);return Z},on:function(P,D){return arguments.length>1?(w.on(P,D),p):w.on(P)}}},t.forceX=function(g){var p,y,v,b=f(.1);function x(A){for(var S,w=0,E=p.length;w<E;++w)(S=p[w]).vx+=(v[w]-S.x)*y[w]*A}function T(){if(p){var A,S=p.length;for(y=new Array(S),v=new Array(S),A=0;A<S;++A)y[A]=isNaN(v[A]=+g(p[A],A,p))?0:+b(p[A],A,p)}}return typeof g!="function"&&(g=f(g==null?0:+g)),x.initialize=function(A){p=A,T()},x.strength=function(A){return arguments.length?(b=typeof A=="function"?A:f(+A),T(),x):b},x.x=function(A){return arguments.length?(g=typeof A=="function"?A:f(+A),T(),x):g},x},t.forceY=function(g){var p,y,v,b=f(.1);function x(A){for(var S,w=0,E=p.length;w<E;++w)(S=p[w]).vy+=(v[w]-S.y)*y[w]*A}function T(){if(p){var A,S=p.length;for(y=new Array(S),v=new Array(S),A=0;A<S;++A)y[A]=isNaN(v[A]=+g(p[A],A,p))?0:+b(p[A],A,p)}}return typeof g!="function"&&(g=f(g==null?0:+g)),x.initialize=function(A){p=A,T()},x.strength=function(A){return arguments.length?(b=typeof A=="function"?A:f(+A),T(),x):b},x.y=function(A){return arguments.length?(g=typeof A=="function"?A:f(+A),T(),x):g},x},Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-collection":160,"d3-dispatch":162,"d3-quadtree":170,"d3-timer":175}],164:[function(r,I,B){(function(t,d){d(typeof B=="object"&&I!==void 0?B:(t=typeof globalThis!="undefined"?globalThis:t||self).d3=t.d3||{})})(this,function(t){function d(p,y){if((v=(p=y?p.toExponential(y-1):p.toExponential()).indexOf("e"))<0)return null;var v,b=p.slice(0,v);return[b.length>1?b[0]+b.slice(2):b,+p.slice(v+1)]}function m(p){return(p=d(Math.abs(p)))?p[1]:NaN}var h,e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function f(p){if(!(y=e.exec(p)))throw new Error("invalid format: "+p);var y;return new l({fill:y[1],align:y[2],sign:y[3],symbol:y[4],zero:y[5],width:y[6],comma:y[7],precision:y[8]&&y[8].slice(1),trim:y[9],type:y[10]})}function l(p){this.fill=p.fill===void 0?" ":p.fill+"",this.align=p.align===void 0?">":p.align+"",this.sign=p.sign===void 0?"-":p.sign+"",this.symbol=p.symbol===void 0?"":p.symbol+"",this.zero=!!p.zero,this.width=p.width===void 0?void 0:+p.width,this.comma=!!p.comma,this.precision=p.precision===void 0?void 0:+p.precision,this.trim=!!p.trim,this.type=p.type===void 0?"":p.type+""}function o(p,y){var v=d(p,y);if(!v)return p+"";var b=v[0],x=v[1];return x<0?"0."+new Array(-x).join("0")+b:b.length>x+1?b.slice(0,x+1)+"."+b.slice(x+1):b+new Array(x-b.length+2).join("0")}f.prototype=l.prototype,l.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,0|this.width))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var u={"%":function(p,y){return(100*p).toFixed(y)},b:function(p){return Math.round(p).toString(2)},c:function(p){return p+""},d:function(p){return Math.abs(p=Math.round(p))>=1e21?p.toLocaleString("en").replace(/,/g,""):p.toString(10)},e:function(p,y){return p.toExponential(y)},f:function(p,y){return p.toFixed(y)},g:function(p,y){return p.toPrecision(y)},o:function(p){return Math.round(p).toString(8)},p:function(p,y){return o(100*p,y)},r:o,s:function(p,y){var v=d(p,y);if(!v)return p+"";var b=v[0],x=v[1],T=x-(h=3*Math.max(-8,Math.min(8,Math.floor(x/3))))+1,A=b.length;return T===A?b:T>A?b+new Array(T-A+1).join("0"):T>0?b.slice(0,T)+"."+b.slice(T):"0."+new Array(1-T).join("0")+d(p,Math.max(0,y+T-1))[0]},X:function(p){return Math.round(p).toString(16).toUpperCase()},x:function(p){return Math.round(p).toString(16)}};function s(p){return p}var i,c=Array.prototype.map,n=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function a(p){var y,v,b=p.grouping===void 0||p.thousands===void 0?s:(y=c.call(p.grouping,Number),v=p.thousands+"",function(M,P){for(var D=M.length,N=[],U=0,G=y[0],X=0;D>0&&G>0&&(X+G+1>P&&(G=Math.max(1,P-X)),N.push(M.substring(D-=G,D+G)),!((X+=G+1)>P));)G=y[U=(U+1)%y.length];return N.reverse().join(v)}),x=p.currency===void 0?"":p.currency[0]+"",T=p.currency===void 0?"":p.currency[1]+"",A=p.decimal===void 0?".":p.decimal+"",S=p.numerals===void 0?s:function(M){return function(P){return P.replace(/[0-9]/g,function(D){return M[+D]})}}(c.call(p.numerals,String)),w=p.percent===void 0?"%":p.percent+"",E=p.minus===void 0?"-":p.minus+"",k=p.nan===void 0?"NaN":p.nan+"";function L(M){var P=(M=f(M)).fill,D=M.align,N=M.sign,U=M.symbol,G=M.zero,X=M.width,K=M.comma,Z=M.precision,H=M.trim,Y=M.type;Y==="n"?(K=!0,Y="g"):u[Y]||(Z===void 0&&(Z=12),H=!0,Y="g"),(G||P==="0"&&D==="=")&&(G=!0,P="0",D="=");var $=U==="$"?x:U==="#"&&/[boxX]/.test(Y)?"0"+Y.toLowerCase():"",z=U==="$"?T:/[%p]/.test(Y)?w:"",j=u[Y],W=/[defgprs%]/.test(Y);function ee(J){var Q,te,ie,ae=$,he=z;if(Y==="c")he=j(J)+he,J="";else{var se=(J=+J)<0||1/J<0;if(J=isNaN(J)?k:j(Math.abs(J),Z),H&&(J=function(ve){e:for(var ke,Ee=ve.length,be=1,xe=-1;be<Ee;++be)switch(ve[be]){case".":xe=ke=be;break;case"0":xe===0&&(xe=be),ke=be;break;default:if(!+ve[be])break e;xe>0&&(xe=0)}return xe>0?ve.slice(0,xe)+ve.slice(ke+1):ve}(J)),se&&+J==0&&N!=="+"&&(se=!1),ae=(se?N==="("?N:E:N==="-"||N==="("?"":N)+ae,he=(Y==="s"?n[8+h/3]:"")+he+(se&&N==="("?")":""),W){for(Q=-1,te=J.length;++Q<te;)if(48>(ie=J.charCodeAt(Q))||ie>57){he=(ie===46?A+J.slice(Q+1):J.slice(Q))+he,J=J.slice(0,Q);break}}}K&&!G&&(J=b(J,1/0));var de=ae.length+J.length+he.length,ue=de<X?new Array(X-de+1).join(P):"";switch(K&&G&&(J=b(ue+J,ue.length?X-he.length:1/0),ue=""),D){case"<":J=ae+J+he+ue;break;case"=":J=ae+ue+J+he;break;case"^":J=ue.slice(0,de=ue.length>>1)+ae+J+he+ue.slice(de);break;default:J=ue+ae+J+he}return S(J)}return Z=Z===void 0?6:/[gprs]/.test(Y)?Math.max(1,Math.min(21,Z)):Math.max(0,Math.min(20,Z)),ee.toString=function(){return M+""},ee}return{format:L,formatPrefix:function(M,P){var D=L(((M=f(M)).type="f",M)),N=3*Math.max(-8,Math.min(8,Math.floor(m(P)/3))),U=Math.pow(10,-N),G=n[8+N/3];return function(X){return D(U*X)+G}}}}function g(p){return i=a(p),t.format=i.format,t.formatPrefix=i.formatPrefix,i}g({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),t.FormatSpecifier=l,t.formatDefaultLocale=g,t.formatLocale=a,t.formatSpecifier=f,t.precisionFixed=function(p){return Math.max(0,-m(Math.abs(p)))},t.precisionPrefix=function(p,y){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(m(y)/3)))-m(Math.abs(p)))},t.precisionRound=function(p,y){return p=Math.abs(p),y=Math.abs(y)-p,Math.max(0,m(y)-m(p))+1},Object.defineProperty(t,"__esModule",{value:!0})})},{}],165:[function(r,I,B){(function(t,d){typeof B=="object"&&I!==void 0?d(B,r("d3-geo"),r("d3-array")):d(t.d3=t.d3||{},t.d3,t.d3)})(this,function(t,d,m){var h=Math.abs,e=Math.atan,f=Math.atan2,l=Math.cos,o=Math.exp,u=Math.floor,s=Math.log,i=Math.max,c=Math.min,n=Math.pow,a=Math.round,g=Math.sign||function(Re){return Re>0?1:Re<0?-1:0},p=Math.sin,y=Math.tan,v=1e-6,b=Math.PI,x=b/2,T=b/4,A=Math.SQRT1_2,S=D(2),w=D(b),E=2*b,k=180/b,L=b/180;function M(Re){return Re>1?x:Re<-1?-x:Math.asin(Re)}function P(Re){return Re>1?0:Re<-1?b:Math.acos(Re)}function D(Re){return Re>0?Math.sqrt(Re):0}function N(Re){return(o(Re)-o(-Re))/2}function U(Re){return(o(Re)+o(-Re))/2}function G(Re){var Ve=y(Re/2),$e=2*s(l(Re/2))/(Ve*Ve);function ot(mt,dt){var Et=l(mt),Zt=l(dt),$t=p(dt),Yt=Zt*Et,nr=-((1-Yt?s((1+Yt)/2)/(1-Yt):-.5)+$e/(1+Yt));return[nr*Zt*p(mt),nr*$t]}return ot.invert=function(mt,dt){var Et,Zt=D(mt*mt+dt*dt),$t=-Re/2,Yt=50;if(!Zt)return[0,0];do{var nr=$t/2,cr=l(nr),mr=p(nr),yr=mr/cr,Or=-s(h(cr));$t-=Et=(2/yr*Or-$e*yr-Zt)/(-Or/(mr*mr)+1-$e/(2*cr*cr))*(cr<0?.7:1)}while(h(Et)>v&&--Yt>0);var nn=p($t);return[f(mt*nn,Zt*l($t)),M(dt*nn/Zt)]},ot}function X(Re,Ve){var $e=l(Ve),ot=function(mt){return mt?mt/Math.sin(mt):1}(P($e*l(Re/=2)));return[2*$e*p(Re)*ot,p(Ve)*ot]}function K(Re){var Ve=p(Re),$e=l(Re),ot=Re>=0?1:-1,mt=y(ot*Re),dt=(1+Ve-$e)/2;function Et(Zt,$t){var Yt=l($t),nr=l(Zt/=2);return[(1+Yt)*p(Zt),(ot*$t>-f(nr,mt)-.001?0:10*-ot)+dt+p($t)*$e-(1+Yt)*Ve*nr]}return Et.invert=function(Zt,$t){var Yt=0,nr=0,cr=50;do{var mr=l(Yt),yr=p(Yt),Or=l(nr),nn=p(nr),gn=1+Or,Cn=gn*yr-Zt,Dn=dt+nn*$e-gn*Ve*mr-$t,Hn=gn*mr/2,zn=-yr*nn,ga=Ve*gn*yr/2,ka=$e*Or+Ve*mr*nn,Ba=zn*ga-ka*Hn,Fa=(Dn*zn-Cn*ka)/Ba/2,ja=(Cn*ga-Dn*Hn)/Ba;h(ja)>2&&(ja/=2),Yt-=Fa,nr-=ja}while((h(Fa)>v||h(ja)>v)&&--cr>0);return ot*nr>-f(l(Yt),mt)-.001?[2*Yt,nr]:null},Et}function Z(Re,Ve){var $e=y(Ve/2),ot=D(1-$e*$e),mt=1+ot*l(Re/=2),dt=p(Re)*ot/mt,Et=$e/mt,Zt=dt*dt,$t=Et*Et;return[4/3*dt*(3+Zt-3*$t),4/3*Et*(3+3*Zt-$t)]}X.invert=function(Re,Ve){if(!(Re*Re+4*Ve*Ve>b*b+v)){var $e=Re,ot=Ve,mt=25;do{var dt,Et=p($e),Zt=p($e/2),$t=l($e/2),Yt=p(ot),nr=l(ot),cr=p(2*ot),mr=Yt*Yt,yr=nr*nr,Or=Zt*Zt,nn=1-yr*$t*$t,gn=nn?P(nr*$t)*D(dt=1/nn):dt=0,Cn=2*gn*nr*Zt-Re,Dn=gn*Yt-Ve,Hn=dt*(yr*Or+gn*nr*$t*mr),zn=dt*(.5*Et*cr-2*gn*Yt*Zt),ga=.25*dt*(cr*Zt-gn*Yt*yr*Et),ka=dt*(mr*$t+gn*Or*nr),Ba=zn*ga-ka*Hn;if(!Ba)break;var Fa=(Dn*zn-Cn*ka)/Ba,ja=(Cn*ga-Dn*Hn)/Ba;$e-=Fa,ot-=ja}while((h(Fa)>v||h(ja)>v)&&--mt>0);return[$e,ot]}},Z.invert=function(Re,Ve){if(Ve*=3/8,!(Re*=3/8)&&h(Ve)>1)return null;var $e=1+Re*Re+Ve*Ve,ot=D(($e-D($e*$e-4*Ve*Ve))/2),mt=M(ot)/3,dt=ot?function(Yt){return s(Yt+D(Yt*Yt-1))}(h(Ve/ot))/3:function(Yt){return s(Yt+D(Yt*Yt+1))}(h(Re))/3,Et=l(mt),Zt=U(dt),$t=Zt*Zt-Et*Et;return[2*g(Re)*f(N(dt)*Et,.25-$t),2*g(Ve)*f(Zt*p(mt),.25+$t)]};var H=D(8),Y=s(1+S);function $(Re,Ve){var $e=h(Ve);return $e<T?[Re,s(y(T+Ve/2))]:[Re*l($e)*(2*S-1/p($e)),g(Ve)*(2*S*($e-T)-s(y($e/2)))]}function z(Re){var Ve=2*b/Re;function $e(ot,mt){var dt=d.geoAzimuthalEquidistantRaw(ot,mt);if(h(ot)>x){var Et=f(dt[1],dt[0]),Zt=D(dt[0]*dt[0]+dt[1]*dt[1]),$t=Ve*a((Et-x)/Ve)+x,Yt=f(p(Et-=$t),2-l(Et));Et=$t+M(b/Zt*p(Yt))-Yt,dt[0]=Zt*l(Et),dt[1]=Zt*p(Et)}return dt}return $e.invert=function(ot,mt){var dt=D(ot*ot+mt*mt);if(dt>x){var Et=f(mt,ot),Zt=Ve*a((Et-x)/Ve)+x,$t=Et>Zt?-1:1,Yt=dt*l(Zt-Et),nr=1/y($t*P((Yt-b)/D(b*(b-2*Yt)+dt*dt)));Et=Zt+2*e((nr+$t*D(nr*nr-3))/3),ot=dt*l(Et),mt=dt*p(Et)}return d.geoAzimuthalEquidistantRaw.invert(ot,mt)},$e}function j(Re,Ve){if(arguments.length<2&&(Ve=Re),Ve===1)return d.geoAzimuthalEqualAreaRaw;if(Ve===1/0)return W;function $e(ot,mt){var dt=d.geoAzimuthalEqualAreaRaw(ot/Ve,mt);return dt[0]*=Re,dt}return $e.invert=function(ot,mt){var dt=d.geoAzimuthalEqualAreaRaw.invert(ot/Re,mt);return dt[0]*=Ve,dt},$e}function W(Re,Ve){return[Re*l(Ve)/l(Ve/=2),2*p(Ve)]}function ee(Re,Ve,$e){var ot,mt,dt,Et=100;$e=$e===void 0?0:+$e,Ve=+Ve;do(mt=Re($e))===(dt=Re($e+v))&&(dt=mt+v),$e-=ot=-1*v*(mt-Ve)/(mt-dt);while(Et-- >0&&h(ot)>v);return Et<0?NaN:$e}function J(Re,Ve,$e){return Ve===void 0&&(Ve=40),$e===void 0&&($e=1e-12),function(ot,mt,dt,Et){var Zt,$t,Yt;dt=dt===void 0?0:+dt,Et=Et===void 0?0:+Et;for(var nr=0;nr<Ve;nr++){var cr=Re(dt,Et),mr=cr[0]-ot,yr=cr[1]-mt;if(h(mr)<$e&&h(yr)<$e)break;var Or=mr*mr+yr*yr;if(Or>Zt)dt-=$t/=2,Et-=Yt/=2;else{Zt=Or;var nn=(dt>0?-1:1)*$e,gn=(Et>0?-1:1)*$e,Cn=Re(dt+nn,Et),Dn=Re(dt,Et+gn),Hn=(Cn[0]-cr[0])/nn,zn=(Cn[1]-cr[1])/nn,ga=(Dn[0]-cr[0])/gn,ka=(Dn[1]-cr[1])/gn,Ba=ka*Hn-zn*ga,Fa=(h(Ba)<.5?.5:1)/Ba;if(dt+=$t=(yr*ga-mr*ka)*Fa,Et+=Yt=(mr*zn-yr*Hn)*Fa,h($t)<$e&&h(Yt)<$e)break}}return[dt,Et]}}function Q(){var Re=j(1.68,2);function Ve($e,ot){if($e+ot<-1.4){var mt=($e-ot+1.6)*($e+ot+1.4)/8;$e+=mt,ot-=.8*mt*p(ot+b/2)}var dt=Re($e,ot),Et=(1-l($e*ot))/12;return dt[1]<0&&(dt[0]*=1+Et),dt[1]>0&&(dt[1]*=1+Et/1.5*dt[0]*dt[0]),dt}return Ve.invert=J(Ve),Ve}function te(Re,Ve){var $e,ot=Re*p(Ve),mt=30;do Ve-=$e=(Ve+p(Ve)-ot)/(1+l(Ve));while(h($e)>v&&--mt>0);return Ve/2}function ie(Re,Ve,$e){function ot(mt,dt){return[Re*mt*l(dt=te($e,dt)),Ve*p(dt)]}return ot.invert=function(mt,dt){return dt=M(dt/Ve),[mt/(Re*l(dt)),M((2*dt+p(2*dt))/$e)]},ot}$.invert=function(Re,Ve){if((ot=h(Ve))<Y)return[Re,2*e(o(Ve))-x];var $e,ot,mt=T,dt=25;do{var Et=l(mt/2),Zt=y(mt/2);mt-=$e=(H*(mt-T)-s(Zt)-ot)/(H-Et*Et/(2*Zt))}while(h($e)>1e-12&&--dt>0);return[Re/(l(mt)*(H-1/p(mt))),g(Ve)*mt]},W.invert=function(Re,Ve){var $e=2*M(Ve/2);return[Re*l($e/2)/l($e),$e]};var ae=ie(S/x,S,b),he=2.00276,se=1.11072;function de(Re,Ve){var $e=te(b,Ve);return[he*Re/(1/l(Ve)+se/l($e)),(Ve+S*p($e))/he]}function ue(Re){var Ve=0,$e=d.geoProjectionMutator(Re),ot=$e(Ve);return ot.parallel=function(mt){return arguments.length?$e(Ve=mt*L):Ve*k},ot}function ve(Re,Ve){return[Re*l(Ve),Ve]}function ke(Re){if(!Re)return ve;var Ve=1/y(Re);function $e(ot,mt){var dt=Ve+Re-mt,Et=dt&&ot*l(mt)/dt;return[dt*p(Et),Ve-dt*l(Et)]}return $e.invert=function(ot,mt){var dt=D(ot*ot+(mt=Ve-mt)*mt),Et=Ve+Re-dt;return[dt/l(Et)*f(ot,mt),Et]},$e}function Ee(Re){function Ve($e,ot){var mt=x-ot,dt=mt&&$e*Re*p(mt)/mt;return[mt*p(dt)/Re,x-mt*l(dt)]}return Ve.invert=function($e,ot){var mt=$e*Re,dt=x-ot,Et=D(mt*mt+dt*dt),Zt=f(mt,dt);return[(Et?Et/p(Et):1)*Zt/Re,x-Et]},Ve}de.invert=function(Re,Ve){var $e,ot,mt=he*Ve,dt=Ve<0?-T:T,Et=25;do ot=mt-S*p(dt),dt-=$e=(p(2*dt)+2*dt-b*p(ot))/(2*l(2*dt)+2+b*l(ot)*S*l(dt));while(h($e)>v&&--Et>0);return ot=mt-S*p(dt),[Re*(1/l(ot)+se/l(dt))/he,ot]},ve.invert=function(Re,Ve){return[Re/l(Ve),Ve]};var be=ie(1,4/b,b);function xe(Re,Ve,$e,ot,mt,dt){var Et,Zt=l(dt);if(h(Re)>1||h(dt)>1)Et=P($e*mt+Ve*ot*Zt);else{var $t=p(Re/2),Yt=p(dt/2);Et=2*M(D($t*$t+Ve*ot*Yt*Yt))}return h(Et)>v?[Et,f(ot*p(dt),Ve*mt-$e*ot*Zt)]:[0,0]}function ce(Re,Ve,$e){return P((Re*Re+Ve*Ve-$e*$e)/(2*Re*Ve))}function ge(Re){return Re-2*b*u((Re+b)/(2*b))}function we(Re,Ve,$e){for(var ot,mt=[[Re[0],Re[1],p(Re[1]),l(Re[1])],[Ve[0],Ve[1],p(Ve[1]),l(Ve[1])],[$e[0],$e[1],p($e[1]),l($e[1])]],dt=mt[2],Et=0;Et<3;++Et,dt=ot)ot=mt[Et],dt.v=xe(ot[1]-dt[1],dt[3],dt[2],ot[3],ot[2],ot[0]-dt[0]),dt.point=[0,0];var Zt=ce(mt[0].v[0],mt[2].v[0],mt[1].v[0]),$t=ce(mt[0].v[0],mt[1].v[0],mt[2].v[0]),Yt=b-Zt;mt[2].point[1]=0,mt[0].point[0]=-(mt[1].point[0]=mt[0].v[0]/2);var nr=[mt[2].point[0]=mt[0].point[0]+mt[2].v[0]*l(Zt),2*(mt[0].point[1]=mt[1].point[1]=mt[2].v[0]*p(Zt))];return function(cr,mr){var yr,Or=p(mr),nn=l(mr),gn=new Array(3);for(yr=0;yr<3;++yr){var Cn=mt[yr];if(gn[yr]=xe(mr-Cn[1],Cn[3],Cn[2],nn,Or,cr-Cn[0]),!gn[yr][0])return Cn.point;gn[yr][1]=ge(gn[yr][1]-Cn.v[1])}var Dn=nr.slice();for(yr=0;yr<3;++yr){var Hn=yr==2?0:yr+1,zn=ce(mt[yr].v[0],gn[yr][0],gn[Hn][0]);gn[yr][1]<0&&(zn=-zn),yr?yr==1?(zn=$t-zn,Dn[0]-=gn[yr][0]*l(zn),Dn[1]-=gn[yr][0]*p(zn)):(zn=Yt-zn,Dn[0]+=gn[yr][0]*l(zn),Dn[1]+=gn[yr][0]*p(zn)):(Dn[0]+=gn[yr][0]*l(zn),Dn[1]-=gn[yr][0]*p(zn))}return Dn[0]/=3,Dn[1]/=3,Dn}}function Me(Re){return Re[0]*=L,Re[1]*=L,Re}function Se(Re,Ve,$e){var ot=d.geoCentroid({type:"MultiPoint",coordinates:[Re,Ve,$e]}),mt=[-ot[0],-ot[1]],dt=d.geoRotation(mt),Et=we(Me(dt(Re)),Me(dt(Ve)),Me(dt($e)));Et.invert=J(Et);var Zt=d.geoProjection(Et).rotate(mt),$t=Zt.center;return delete Zt.rotate,Zt.center=function(Yt){return arguments.length?$t(dt(Yt)):dt.invert($t())},Zt.clipAngle(90)}function ze(Re,Ve){var $e=D(1-p(Ve));return[2/w*Re*$e,w*(1-$e)]}function Fe(Re){var Ve=y(Re);function $e(ot,mt){return[ot,(ot?ot/p(ot):1)*(p(mt)*l(ot)-Ve*l(mt))]}return $e.invert=Ve?function(ot,mt){ot&&(mt*=p(ot)/ot);var dt=l(ot);return[ot,2*f(D(dt*dt+Ve*Ve-mt*mt)-dt,Ve-mt)]}:function(ot,mt){return[ot,M(ot?mt*y(ot)/ot:mt)]},$e}ze.invert=function(Re,Ve){var $e=($e=Ve/w-1)*$e;return[$e>0?Re*D(b/$e)/2:0,M(1-$e)]};var Ye=D(3);function rt(Re,Ve){return[Ye*Re*(2*l(2*Ve/3)-1)/w,Ye*w*p(Ve/3)]}function Oe(Re){var Ve=l(Re);function $e(ot,mt){return[ot*Ve,p(mt)/Ve]}return $e.invert=function(ot,mt){return[ot/Ve,M(mt*Ve)]},$e}function je(Re){var Ve=l(Re);function $e(ot,mt){return[ot*Ve,(1+Ve)*y(mt/2)]}return $e.invert=function(ot,mt){return[ot/Ve,2*e(mt/(1+Ve))]},$e}function We(Re,Ve){var $e=D(8/(3*b));return[$e*Re*(1-h(Ve)/b),$e*Ve]}function qe(Re,Ve){var $e=D(4-3*p(h(Ve)));return[2/D(6*b)*Re*$e,g(Ve)*D(2*b/3)*(2-$e)]}function et(Re,Ve){var $e=D(b*(4+b));return[2/$e*Re*(1+D(1-4*Ve*Ve/(b*b))),4/$e*Ve]}function st(Re,Ve){var $e=(2+x)*p(Ve);Ve/=2;for(var ot=0,mt=1/0;ot<10&&h(mt)>v;ot++){var dt=l(Ve);Ve-=mt=(Ve+p(Ve)*(dt+2)-$e)/(2*dt*(1+dt))}return[2/D(b*(4+b))*Re*(1+l(Ve)),2*D(b/(4+b))*p(Ve)]}function ct(Re,Ve){return[Re*(1+l(Ve))/D(2+b),2*Ve/D(2+b)]}function Pt(Re,Ve){for(var $e=(1+x)*p(Ve),ot=0,mt=1/0;ot<10&&h(mt)>v;ot++)Ve-=mt=(Ve+p(Ve)-$e)/(1+l(Ve));return $e=D(2+b),[Re*(1+l(Ve))/$e,2*Ve/$e]}rt.invert=function(Re,Ve){var $e=3*M(Ve/(Ye*w));return[w*Re/(Ye*(2*l(2*$e/3)-1)),$e]},We.invert=function(Re,Ve){var $e=D(8/(3*b)),ot=Ve/$e;return[Re/($e*(1-h(ot)/b)),ot]},qe.invert=function(Re,Ve){var $e=2-h(Ve)/D(2*b/3);return[Re*D(6*b)/(2*$e),g(Ve)*M((4-$e*$e)/3)]},et.invert=function(Re,Ve){var $e=D(b*(4+b))/2;return[Re*$e/(1+D(1-Ve*Ve*(4+b)/(4*b))),Ve*$e/2]},st.invert=function(Re,Ve){var $e=Ve*D((4+b)/b)/2,ot=M($e),mt=l(ot);return[Re/(2/D(b*(4+b))*(1+mt)),M((ot+$e*(mt+2))/(2+x))]},ct.invert=function(Re,Ve){var $e=D(2+b),ot=Ve*$e/2;return[$e*Re/(1+l(ot)),ot]},Pt.invert=function(Re,Ve){var $e=1+x,ot=D($e/2);return[2*Re*ot/(1+l(Ve*=ot)),M((Ve+p(Ve))/$e)]};var kt=3+2*S;function at(Re,Ve){var $e=p(Re/=2),ot=l(Re),mt=D(l(Ve)),dt=l(Ve/=2),Et=p(Ve)/(dt+S*ot*mt),Zt=D(2/(1+Et*Et)),$t=D((S*dt+(ot+$e)*mt)/(S*dt+(ot-$e)*mt));return[kt*(Zt*($t-1/$t)-2*s($t)),kt*(Zt*Et*($t+1/$t)-2*e(Et))]}at.invert=function(Re,Ve){if(!($e=Z.invert(Re/1.2,1.065*Ve)))return null;var $e,ot=$e[0],mt=$e[1],dt=20;Re/=kt,Ve/=kt;do{var Et=ot/2,Zt=mt/2,$t=p(Et),Yt=l(Et),nr=p(Zt),cr=l(Zt),mr=l(mt),yr=D(mr),Or=nr/(cr+S*Yt*yr),nn=Or*Or,gn=D(2/(1+nn)),Cn=(S*cr+(Yt+$t)*yr)/(S*cr+(Yt-$t)*yr),Dn=D(Cn),Hn=Dn-1/Dn,zn=Dn+1/Dn,ga=gn*Hn-2*s(Dn)-Re,ka=gn*Or*zn-2*e(Or)-Ve,Ba=nr&&A*yr*$t*nn/nr,Fa=(S*Yt*cr+yr)/(2*(cr+S*Yt*yr)*(cr+S*Yt*yr)*yr),ja=-.5*Or*gn*gn*gn,Si=ja*Ba,Ti=ja*Fa,ui=(ui=2*cr+S*yr*(Yt-$t))*ui*Dn,ci=(S*Yt*cr*yr+mr)/ui,ki=-S*$t*nr/(yr*ui),Hi=Hn*Si-2*ci/Dn+gn*(ci+ci/Cn),no=Hn*Ti-2*ki/Dn+gn*(ki+ki/Cn),ao=Or*zn*Si-2*Ba/(1+nn)+gn*zn*Ba+gn*Or*(ci-ci/Cn),io=Or*zn*Ti-2*Fa/(1+nn)+gn*zn*Fa+gn*Or*(ki-ki/Cn),oo=no*ao-io*Hi;if(!oo)break;var Oa=(ka*no-ga*io)/oo,ft=(ga*ao-ka*Hi)/oo;ot-=Oa,mt=i(-x,c(x,mt-ft))}while((h(Oa)>v||h(ft)>v)&&--dt>0);return h(h(mt)-x)<v?[0,mt]:dt&&[ot,mt]};var tt=l(35*L);function _t(Re,Ve){var $e=y(Ve/2);return[Re*tt*D(1-$e*$e),(1+tt)*$e]}function er(Re,Ve){var $e=Ve/2,ot=l($e);return[2*Re/w*l(Ve)*ot*ot,w*y($e)]}function tr(Re){var Ve=1-Re,$e=mt(b,0)[0]-mt(-b,0)[0],ot=D(2*(mt(0,x)[1]-mt(0,-x)[1])/$e);function mt(Zt,$t){var Yt=l($t),nr=p($t);return[Yt/(Ve+Re*Yt)*Zt,Ve*$t+Re*nr]}function dt(Zt,$t){var Yt=mt(Zt,$t);return[Yt[0]*ot,Yt[1]/ot]}function Et(Zt){return dt(0,Zt)[1]}return dt.invert=function(Zt,$t){var Yt=ee(Et,$t);return[Zt/ot*(Re+Ve/l(Yt)),Yt]},dt}function Ue(Re){return[Re[0]/2,M(y(Re[1]/2*L))*k]}function He(Re){return[2*Re[0],2*e(p(Re[1]*L))*k]}function Be(Re,Ve){var $e=2*b/Ve,ot=Re*Re;function mt(dt,Et){var Zt=d.geoAzimuthalEquidistantRaw(dt,Et),$t=Zt[0],Yt=Zt[1],nr=$t*$t+Yt*Yt;if(nr>ot){var cr=D(nr),mr=f(Yt,$t),yr=$e*a(mr/$e),Or=mr-yr,nn=Re*l(Or),gn=(Re*p(Or)-Or*p(nn))/(x-nn),Cn=Ke(Or,gn),Dn=(b-Re)/_e(Cn,nn,b);$t=cr;var Hn,zn=50;do $t-=Hn=(Re+_e(Cn,nn,$t)*Dn-cr)/(Cn($t)*Dn);while(h(Hn)>v&&--zn>0);Yt=Or*p($t),$t<x&&(Yt-=gn*($t-x));var ga=p(yr),ka=l(yr);Zt[0]=$t*ka-Yt*ga,Zt[1]=$t*ga+Yt*ka}return Zt}return mt.invert=function(dt,Et){var Zt=dt*dt+Et*Et;if(Zt>ot){var $t=D(Zt),Yt=f(Et,dt),nr=$e*a(Yt/$e),cr=Yt-nr;dt=$t*l(cr),Et=$t*p(cr);for(var mr=dt-x,yr=p(dt),Or=Et/yr,nn=dt<x?1/0:0,gn=10;;){var Cn=Re*p(Or),Dn=Re*l(Or),Hn=p(Dn),zn=x-Dn,ga=(Cn-Or*Hn)/zn,ka=Ke(Or,ga);if(h(nn)<1e-12||!--gn)break;Or-=nn=(Or*yr-ga*mr-Et)/(yr-2*mr*(zn*(Dn+Or*Cn*l(Dn)-Hn)-Cn*(Cn-Or*Hn))/(zn*zn))}dt=($t=Re+_e(ka,Dn,dt)*(b-Re)/_e(ka,Dn,b))*l(Yt=nr+Or),Et=$t*p(Yt)}return d.geoAzimuthalEquidistantRaw.invert(dt,Et)},mt}function Ke(Re,Ve){return function($e){var ot=Re*l($e);return $e<x&&(ot-=Ve),D(1+ot*ot)}}function _e(Re,Ve,$e){for(var ot=($e-Ve)/50,mt=Re(Ve)+Re($e),dt=1,Et=Ve;dt<50;++dt)mt+=2*Re(Et+=ot);return .5*mt*ot}function Ce(Re,Ve,$e,ot,mt,dt,Et,Zt){function $t(Yt,nr){if(!nr)return[Re*Yt/b,0];var cr=nr*nr,mr=Re+cr*(Ve+cr*($e+cr*ot)),yr=nr*(mt-1+cr*(dt-Zt+cr*Et)),Or=(mr*mr+yr*yr)/(2*yr),nn=Yt*M(mr/Or)/b;return[Or*p(nn),nr*(1+cr*Zt)+Or*(1-l(nn))]}return arguments.length<8&&(Zt=0),$t.invert=function(Yt,nr){var cr,mr,yr=b*Yt/Re,Or=nr,nn=50;do{var gn=Or*Or,Cn=Re+gn*(Ve+gn*($e+gn*ot)),Dn=Or*(mt-1+gn*(dt-Zt+gn*Et)),Hn=Cn*Cn+Dn*Dn,zn=2*Dn,ga=Hn/zn,ka=ga*ga,Ba=M(Cn/ga)/b,Fa=yr*Ba,ja=Cn*Cn,Si=(2*Ve+gn*(4*$e+6*gn*ot))*Or,Ti=mt+gn*(3*dt+5*gn*Et),ui=(2*(Cn*Si+Dn*(Ti-1))*zn-Hn*(2*(Ti-1)))/(zn*zn),ci=l(Fa),ki=p(Fa),Hi=ga*ci,no=ga*ki,ao=yr/b*(1/D(1-ja/ka))*(Si*ga-Cn*ui)/ka,io=no-Yt,oo=Or*(1+gn*Zt)+ga-Hi-nr,Oa=ui*ki+Hi*ao,ft=Hi*Ba,Rt=1+ui-(ui*ci-no*ao),sr=no*Ba,Vt=Oa*sr-Rt*ft;if(!Vt)break;yr-=cr=(oo*Oa-io*Rt)/Vt,Or-=mr=(io*sr-oo*ft)/Vt}while((h(cr)>v||h(mr)>v)&&--nn>0);return[yr,Or]},$t}_t.invert=function(Re,Ve){var $e=Ve/(1+tt);return[Re&&Re/(tt*D(1-$e*$e)),2*e($e)]},er.invert=function(Re,Ve){var $e=e(Ve/w),ot=l($e),mt=2*$e;return[Re*w/2/(l(mt)*ot*ot),mt]};var Le=Ce(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555),Pe=Ce(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742),Xe=Ce(5/6*b,-.62636,-.0344,0,1.3493,-.05524,0,.045);function ht(Re,Ve){var $e=Re*Re,ot=Ve*Ve;return[Re*(1-.162388*ot)*(.87-952426e-9*$e*$e),Ve*(1+ot/12)]}ht.invert=function(Re,Ve){var $e,ot=Re,mt=Ve,dt=50;do{var Et=mt*mt;mt-=$e=(mt*(1+Et/12)-Ve)/(1+Et/4)}while(h($e)>v&&--dt>0);dt=50,Re/=1-.162388*Et;do{var Zt=(Zt=ot*ot)*Zt;ot-=$e=(ot*(.87-952426e-9*Zt)-Re)/(.87-.00476213*Zt)}while(h($e)>v&&--dt>0);return[ot,mt]};var Mt=Ce(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function pt(Re){var Ve=Re(x,0)[0]-Re(-x,0)[0];function $e(ot,mt){var dt=ot>0?-.5:.5,Et=Re(ot+dt*b,mt);return Et[0]-=dt*Ve,Et}return Re.invert&&($e.invert=function(ot,mt){var dt=ot>0?-.5:.5,Et=Re.invert(ot+dt*Ve,mt),Zt=Et[0]-dt*b;return Zt<-b?Zt+=2*b:Zt>b&&(Zt-=2*b),Et[0]=Zt,Et}),$e}function Lt(Re,Ve){var $e=g(Re),ot=g(Ve),mt=l(Ve),dt=l(Re)*mt,Et=p(Re)*mt,Zt=p(ot*Ve);Re=h(f(Et,Zt)),Ve=M(dt),h(Re-x)>v&&(Re%=x);var $t=function(Yt,nr){if(nr===x)return[0,0];var cr,mr,yr=p(nr),Or=yr*yr,nn=Or*Or,gn=1+nn,Cn=1+3*nn,Dn=1-nn,Hn=M(1/D(gn)),zn=Dn+Or*gn*Hn,ga=(1-yr)/zn,ka=D(ga),Ba=ga*gn,Fa=D(Ba),ja=ka*Dn;if(Yt===0)return[0,-(ja+Or*Fa)];var Si,Ti=l(nr),ui=1/Ti,ci=2*yr*Ti,ki=(-zn*Ti-(-3*Or+Hn*Cn)*ci*(1-yr))/(zn*zn),Hi=-ui*ci,no=-ui*(Or*gn*ki+ga*Cn*ci),ao=-2*ui*(Dn*(.5*ki/ka)-2*Or*ka*ci),io=4*Yt/b;if(Yt>.222*b||nr<b/4&&Yt>.175*b){if(cr=(ja+Or*D(Ba*(1+nn)-ja*ja))/(1+nn),Yt>b/4)return[cr,cr];var oo=cr,Oa=.5*cr;cr=.5*(Oa+oo),mr=50;do{var ft=D(Ba-cr*cr),Rt=cr*(ao+Hi*ft)+no*M(cr/Fa)-io;if(!Rt)break;Rt<0?Oa=cr:oo=cr,cr=.5*(Oa+oo)}while(h(oo-Oa)>v&&--mr>0)}else{cr=v,mr=25;do{var sr=cr*cr,Vt=D(Ba-sr),lr=ao+Hi*Vt,Lr=cr*lr+no*M(cr/Fa)-io,zr=lr+(no-Hi*sr)/Vt;cr-=Si=Vt?Lr/zr:0}while(h(Si)>v&&--mr>0)}return[cr,-ja-Or*D(Ba-cr*cr)]}(Re>b/4?x-Re:Re,Ve);return Re>b/4&&(Zt=$t[0],$t[0]=-$t[1],$t[1]=-Zt),$t[0]*=$e,$t[1]*=-ot,$t}function vt(Re,Ve){var $e,ot,mt,dt,Et,Zt;if(Ve<v)return[(dt=p(Re))-($e=Ve*(Re-dt*(ot=l(Re)))/4)*ot,ot+$e*dt,1-Ve*dt*dt/2,Re-$e];if(Ve>=1-v)return $e=(1-Ve)/4,mt=1/(ot=U(Re)),[(dt=((Zt=o(2*(Zt=Re)))-1)/(Zt+1))+$e*((Et=ot*N(Re))-Re)/(ot*ot),mt-$e*dt*mt*(Et-Re),mt+$e*dt*mt*(Et+Re),2*e(o(Re))-x+$e*(Et-Re)/ot];var $t=[1,0,0,0,0,0,0,0,0],Yt=[D(Ve),0,0,0,0,0,0,0,0],nr=0;for(ot=D(1-Ve),Et=1;h(Yt[nr]/$t[nr])>v&&nr<8;)$e=$t[nr++],Yt[nr]=($e-ot)/2,$t[nr]=($e+ot)/2,ot=D($e*ot),Et*=2;mt=Et*$t[nr]*Re;do mt=(M(dt=Yt[nr]*p(ot=mt)/$t[nr])+mt)/2;while(--nr);return[p(mt),dt=l(mt),dt/l(mt-ot),mt]}function Dt(Re,Ve){if(!Ve)return Re;if(Ve===1)return s(y(Re/2+T));for(var $e=1,ot=D(1-Ve),mt=D(Ve),dt=0;h(mt)>v;dt++){if(Re%b){var Et=e(ot*y(Re)/$e);Et<0&&(Et+=b),Re+=Et+~~(Re/b)*b}else Re+=Re;mt=($e+ot)/2,ot=D($e*ot),mt=(($e=mt)-ot)/2}return Re/(n(2,dt)*$e)}function xt(Re,Ve){var $e=(S-1)/(S+1),ot=D(1-$e*$e),mt=Dt(x,ot*ot),dt=s(y(b/4+h(Ve)/2)),Et=o(-1*dt)/D($e),Zt=function(Yt,nr){var cr=Yt*Yt,mr=nr+1,yr=1-cr-nr*nr;return[.5*((Yt>=0?x:-x)-f(yr,2*Yt)),-.25*s(yr*yr+4*cr)+.5*s(mr*mr+cr)]}(Et*l(-1*Re),Et*p(-1*Re)),$t=function(Yt,nr,cr){var mr=h(Yt),yr=N(h(nr));if(mr){var Or=1/p(mr),nn=1/(y(mr)*y(mr)),gn=-(nn+cr*(yr*yr*Or*Or)-1+cr),Cn=(-gn+D(gn*gn-4*((cr-1)*nn)))/2;return[Dt(e(1/D(Cn)),cr)*g(Yt),Dt(e(D((Cn/nn-1)/cr)),1-cr)*g(nr)]}return[0,Dt(e(yr),1-cr)*g(nr)]}(Zt[0],Zt[1],ot*ot);return[-$t[1],(Ve>=0?1:-1)*(.5*mt-$t[0])]}function it(Re){var Ve=p(Re),$e=l(Re),ot=St(Re);function mt(dt,Et){var Zt=ot(dt,Et);dt=Zt[0],Et=Zt[1];var $t=p(Et),Yt=l(Et),nr=l(dt),cr=P(Ve*$t+$e*Yt*nr),mr=p(cr),yr=h(mr)>v?cr/mr:1;return[yr*$e*p(dt),(h(dt)>x?yr:-yr)*(Ve*Yt-$e*$t*nr)]}return ot.invert=St(-Re),mt.invert=function(dt,Et){var Zt=D(dt*dt+Et*Et),$t=-p(Zt),Yt=l(Zt),nr=Zt*Yt,cr=-Et*$t,mr=Zt*Ve,yr=D(nr*nr+cr*cr-mr*mr),Or=f(nr*mr+cr*yr,cr*mr-nr*yr),nn=(Zt>x?-1:1)*f(dt*$t,Zt*l(Or)*Yt+Et*p(Or)*$t);return ot.invert(nn,Or)},mt}function St(Re){var Ve=p(Re),$e=l(Re);return function(ot,mt){var dt=l(mt),Et=l(ot)*dt,Zt=p(ot)*dt,$t=p(mt);return[f(Zt,Et*$e-$t*Ve),M($t*$e+Et*Ve)]}}Lt.invert=function(Re,Ve){h(Re)>1&&(Re=2*g(Re)-Re),h(Ve)>1&&(Ve=2*g(Ve)-Ve);var $e=g(Re),ot=g(Ve),mt=-$e*Re,dt=-ot*Ve,Et=dt/mt<1,Zt=function(cr,mr){for(var yr=0,Or=1,nn=.5,gn=50;;){var Cn=nn*nn,Dn=D(nn),Hn=M(1/D(1+Cn)),zn=1-Cn+nn*(1+Cn)*Hn,ga=(1-Dn)/zn,ka=D(ga),Ba=ga*(1+Cn),Fa=ka*(1-Cn),ja=D(Ba-cr*cr),Si=mr+Fa+nn*ja;if(h(Or-yr)<1e-12||--gn==0||Si===0)break;Si>0?yr=nn:Or=nn,nn=.5*(yr+Or)}if(!gn)return null;var Ti=M(Dn),ui=l(Ti),ci=1/ui,ki=2*Dn*ui,Hi=(-zn*ui-(-3*nn+Hn*(1+3*Cn))*ki*(1-Dn))/(zn*zn);return[b/4*(cr*(-2*ci*(.5*Hi/ka*(1-Cn)-2*nn*ka*ki)+-ci*ki*ja)+-ci*(nn*(1+Cn)*Hi+ga*(1+3*Cn)*ki)*M(cr/D(Ba))),Ti]}(Et?dt:mt,Et?mt:dt),$t=Zt[0],Yt=Zt[1],nr=l(Yt);return Et&&($t=-x-$t),[$e*(f(p($t)*nr,-p(Yt))+b),ot*M(l($t)*nr)]},xt.invert=function(Re,Ve){var $e,ot,mt,dt,Et,Zt,$t=(S-1)/(S+1),Yt=D(1-$t*$t),nr=Dt(x,Yt*Yt),cr=(ot=-Re,mt=Yt*Yt,($e=.5*nr-Ve)?(dt=vt($e,mt),ot?(Zt=(Et=vt(ot,1-mt))[1]*Et[1]+mt*dt[0]*dt[0]*Et[0]*Et[0],[[dt[0]*Et[2]/Zt,dt[1]*dt[2]*Et[0]*Et[1]/Zt],[dt[1]*Et[1]/Zt,-dt[0]*dt[2]*Et[0]*Et[2]/Zt],[dt[2]*Et[1]*Et[2]/Zt,-mt*dt[0]*dt[1]*Et[0]/Zt]]):[[dt[0],0],[dt[1],0],[dt[2],0]]):[[0,(Et=vt(ot,1-mt))[0]/Et[1]],[1/Et[1],0],[Et[2]/Et[1],0]]),mr=function(yr,Or){var nn=Or[0]*Or[0]+Or[1]*Or[1];return[(yr[0]*Or[0]+yr[1]*Or[1])/nn,(yr[1]*Or[0]-yr[0]*Or[1])/nn]}(cr[0],cr[1]);return[f(mr[1],mr[0])/-1,2*e(o(-.5*s($t*mr[0]*mr[0]+$t*mr[1]*mr[1])))-x]};var Nt=M(1-1/3)*k,Ut=Oe(0);function Qt(Re){var Ve=Nt*L,$e=ze(b,Ve)[0]-ze(-b,Ve)[0],ot=Ut(0,Ve)[1],mt=ze(0,Ve)[1],dt=w-mt,Et=E/Re,Zt=4/E,$t=ot+dt*dt*4/E;function Yt(nr,cr){var mr,yr=h(cr);if(yr>Ve){var Or=c(Re-1,i(0,u((nr+b)/Et)));(mr=ze(nr+=b*(Re-1)/Re-Or*Et,yr))[0]=mr[0]*E/$e-E*(Re-1)/(2*Re)+Or*E/Re,mr[1]=ot+4*(mr[1]-mt)*dt/E,cr<0&&(mr[1]=-mr[1])}else mr=Ut(nr,cr);return mr[0]*=Zt,mr[1]/=$t,mr}return Yt.invert=function(nr,cr){nr/=Zt;var mr=h(cr*=$t);if(mr>ot){var yr=c(Re-1,i(0,u((nr+b)/Et)));nr=(nr+b*(Re-1)/Re-yr*Et)*$e/E;var Or=ze.invert(nr,.25*(mr-ot)*E/dt+mt);return Or[0]-=b*(Re-1)/Re-yr*Et,cr<0&&(Or[1]=-Or[1]),Or}return Ut.invert(nr,cr)},Yt}function Ie(Re,Ve){return[Re,1&Ve?90-v:Nt]}function lt(Re,Ve){return[Re,1&Ve?-90+v:-Nt]}function wt(Re){return[Re[0]*(1-v),Re[1]]}function Ot(Re){var Ve,$e=1+Re,ot=M(p(1/$e)),mt=2*D(b/(Ve=b+4*ot*$e)),dt=.5*mt*($e+D(Re*(2+Re))),Et=Re*Re,Zt=$e*$e;function $t(Yt,nr){var cr,mr,yr=1-p(nr);if(yr&&yr<2){var Or,nn=x-nr,gn=25;do{var Cn=p(nn),Dn=l(nn),Hn=ot+f(Cn,$e-Dn),zn=1+Zt-2*$e*Dn;nn-=Or=(nn-Et*ot-$e*Cn+zn*Hn-.5*yr*Ve)/(2*$e*Cn*Hn)}while(h(Or)>1e-12&&--gn>0);cr=mt*D(zn),mr=Yt*Hn/b}else cr=mt*(Re+yr),mr=Yt*ot/b;return[cr*p(mr),dt-cr*l(mr)]}return $t.invert=function(Yt,nr){var cr=Yt*Yt+(nr-=dt)*nr,mr=(1+Zt-cr/(mt*mt))/(2*$e),yr=P(mr),Or=p(yr),nn=ot+f(Or,$e-mr);return[M(Yt/D(cr))*b/nn,M(1-2*(yr-Et*ot-$e*Or+(1+Zt-2*$e*mr)*nn)/Ve)]},$t}function Gt(Re,Ve){return Ve>-.7109889596207567?((Re=ae(Re,Ve))[1]+=.0528035274542,Re):ve(Re,Ve)}function ir(Re,Ve){return h(Ve)>.7109889596207567?((Re=ae(Re,Ve))[1]-=Ve>0?.0528035274542:-.0528035274542,Re):ve(Re,Ve)}function Xt(Re,Ve,$e,ot){var mt=D(4*b/(2*$e+(1+Re-Ve/2)*p(2*$e)+(Re+Ve)/2*p(4*$e)+Ve/2*p(6*$e))),dt=D(ot*p($e)*D((1+Re*l(2*$e)+Ve*l(4*$e))/(1+Re+Ve))),Et=$e*$t(1);function Zt(cr){return D(1+Re*l(2*cr)+Ve*l(4*cr))}function $t(cr){var mr=cr*$e;return(2*mr+(1+Re-Ve/2)*p(2*mr)+(Re+Ve)/2*p(4*mr)+Ve/2*p(6*mr))/$e}function Yt(cr){return Zt(cr)*p(cr)}var nr=function(cr,mr){var yr=$e*ee($t,Et*p(mr)/$e,mr/b);isNaN(yr)&&(yr=$e*g(mr));var Or=mt*Zt(yr);return[Or*dt*cr/b*l(yr),Or/dt*p(yr)]};return nr.invert=function(cr,mr){var yr=ee(Yt,mr*dt/mt);return[cr*b/(l(yr)*mt*dt*Zt(yr)),M($e*$t(yr/$e)/Et)]},$e===0&&(mt=D(ot/b),(nr=function(cr,mr){return[cr*mt,p(mr)/mt]}).invert=function(cr,mr){return[cr/mt,M(mr*mt)]}),nr}function Kt(Re,Ve,$e,ot,mt){ot===void 0&&(ot=1e-8),mt===void 0&&(mt=20);var dt=Re(Ve),Et=Re(.5*(Ve+$e)),Zt=Re($e);return function $t(Yt,nr,cr,mr,yr,Or,nn,gn,Cn,Dn,Hn){if(Hn.nanEncountered)return NaN;var zn,ga,ka,Ba,Fa,ja,Si,Ti,ui,ci;if(ga=Yt(nr+.25*(zn=cr-nr)),ka=Yt(cr-.25*zn),isNaN(ga))Hn.nanEncountered=!0;else{if(!isNaN(ka))return ci=((ja=(Ba=zn*(mr+4*ga+yr)/12)+(Fa=zn*(yr+4*ka+Or)/12))-nn)/15,Dn>Cn?(Hn.maxDepthCount++,ja+ci):Math.abs(ci)<gn?ja+ci:(Ti=$t(Yt,nr,Si=nr+.5*zn,mr,ga,yr,Ba,.5*gn,Cn,Dn+1,Hn),isNaN(Ti)?(Hn.nanEncountered=!0,NaN):(ui=$t(Yt,Si,cr,yr,ka,Or,Fa,.5*gn,Cn,Dn+1,Hn),isNaN(ui)?(Hn.nanEncountered=!0,NaN):Ti+ui));Hn.nanEncountered=!0}}(Re,Ve,$e,dt,Et,Zt,(dt+4*Et+Zt)*($e-Ve)/6,ot,mt,1,{maxDepthCount:0,nanEncountered:!1})}function or(Re,Ve,$e){function ot(yr){return Re+(1-Re)*n(1-n(yr,Ve),1/Ve)}function mt(yr){return Kt(ot,0,yr,1e-4)}for(var dt=1/mt(1),Et=1e3,Zt=(1+1e-8)*dt,$t=[],Yt=0;Yt<=Et;Yt++)$t.push(mt(Yt/Et)*Zt);function nr(yr){var Or=0,nn=Et,gn=500;do $t[gn]>yr?nn=gn:Or=gn,gn=Or+nn>>1;while(gn>Or);var Cn=$t[gn+1]-$t[gn];return Cn&&(Cn=(yr-$t[gn+1])/Cn),(gn+1+Cn)/Et}var cr=2*nr(1)/b*dt/$e,mr=function(yr,Or){var nn=nr(h(p(Or))),gn=ot(nn)*yr;return nn/=cr,[gn,Or>=0?nn:-nn]};return mr.invert=function(yr,Or){var nn;return h(Or*=cr)<1&&(nn=g(Or)*M(mt(h(Or))*dt)),[yr/ot(h(Or)),nn]},mr}function dr(Re,Ve){return h(Re[0]-Ve[0])<v&&h(Re[1]-Ve[1])<v}function vr(Re,Ve){for(var $e,ot,mt,dt=-1,Et=Re.length,Zt=Re[0],$t=[];++dt<Et;){ot=(($e=Re[dt])[0]-Zt[0])/Ve,mt=($e[1]-Zt[1])/Ve;for(var Yt=0;Yt<Ve;++Yt)$t.push([Zt[0]+Yt*ot,Zt[1]+Yt*mt]);Zt=$e}return $t.push($e),$t}function ur(Re){var Ve,$e,ot,mt,dt,Et,Zt,$t=[],Yt=Re[0].length;for(Zt=0;Zt<Yt;++Zt)$e=(Ve=Re[0][Zt])[0][0],ot=Ve[0][1],mt=Ve[1][1],dt=Ve[2][0],Et=Ve[2][1],$t.push(vr([[$e+v,ot+v],[$e+v,mt-v],[dt-v,mt-v],[dt-v,Et+v]],30));for(Zt=Re[1].length-1;Zt>=0;--Zt)$e=(Ve=Re[1][Zt])[0][0],ot=Ve[0][1],mt=Ve[1][1],dt=Ve[2][0],Et=Ve[2][1],$t.push(vr([[dt-v,Et-v],[dt-v,mt+v],[$e+v,mt+v],[$e+v,ot-v]],30));return{type:"Polygon",coordinates:[m.merge($t)]}}function pr(Re,Ve,$e){var ot,mt;function dt($t,Yt){for(var nr=Yt<0?-1:1,cr=Ve[+(Yt<0)],mr=0,yr=cr.length-1;mr<yr&&$t>cr[mr][2][0];++mr);var Or=Re($t-cr[mr][1][0],Yt);return Or[0]+=Re(cr[mr][1][0],nr*Yt>nr*cr[mr][0][1]?cr[mr][0][1]:Yt)[0],Or}$e?dt.invert=$e(dt):Re.invert&&(dt.invert=function($t,Yt){for(var nr=mt[+(Yt<0)],cr=Ve[+(Yt<0)],mr=0,yr=nr.length;mr<yr;++mr){var Or=nr[mr];if(Or[0][0]<=$t&&$t<Or[1][0]&&Or[0][1]<=Yt&&Yt<Or[1][1]){var nn=Re.invert($t-Re(cr[mr][1][0],0)[0],Yt);return nn[0]+=cr[mr][1][0],dr(dt(nn[0],nn[1]),[$t,Yt])?nn:null}}});var Et=d.geoProjection(dt),Zt=Et.stream;return Et.stream=function($t){var Yt=Et.rotate(),nr=Zt($t),cr=(Et.rotate([0,0]),Zt($t));return Et.rotate(Yt),nr.sphere=function(){d.geoStream(ot,cr)},nr},Et.lobes=function($t){return arguments.length?(ot=ur($t),Ve=$t.map(function(Yt){return Yt.map(function(nr){return[[nr[0][0]*L,nr[0][1]*L],[nr[1][0]*L,nr[1][1]*L],[nr[2][0]*L,nr[2][1]*L]]})}),mt=Ve.map(function(Yt){return Yt.map(function(nr){var cr,mr=Re(nr[0][0],nr[0][1])[0],yr=Re(nr[2][0],nr[2][1])[0],Or=Re(nr[1][0],nr[0][1])[1],nn=Re(nr[1][0],nr[1][1])[1];return Or>nn&&(cr=Or,Or=nn,nn=cr),[[mr,Or],[yr,nn]]})}),Et):Ve.map(function(Yt){return Yt.map(function(nr){return[[nr[0][0]*k,nr[0][1]*k],[nr[1][0]*k,nr[1][1]*k],[nr[2][0]*k,nr[2][1]*k]]})})},Ve!=null&&Et.lobes(Ve),Et}Gt.invert=function(Re,Ve){return Ve>-.7109889596207567?ae.invert(Re,Ve-.0528035274542):ve.invert(Re,Ve)},ir.invert=function(Re,Ve){return h(Ve)>.7109889596207567?ae.invert(Re,Ve+(Ve>0?.0528035274542:-.0528035274542)):ve.invert(Re,Ve)};var br=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],Rr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],_r=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],jr=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]],$r=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]],pn=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function In(Re,Ve){return[3/E*Re*D(b*b/3-Ve*Ve),Ve]}function On(Re){function Ve($e,ot){if(h(h(ot)-x)<v)return[0,ot<0?-2:2];var mt=p(ot),dt=n((1+mt)/(1-mt),Re/2),Et=.5*(dt+1/dt)+l($e*=Re);return[2*p($e)/Et,(dt-1/dt)/Et]}return Ve.invert=function($e,ot){var mt=h(ot);if(h(mt-2)<v)return $e?null:[0,g(ot)*x];if(mt>2)return null;var dt=($e/=2)*$e,Et=(ot/=2)*ot,Zt=2*ot/(1+dt+Et);return Zt=n((1+Zt)/(1-Zt),1/Re),[f(2*$e,1-dt-Et)/Re,M((Zt-1)/(Zt+1))]},Ve}In.invert=function(Re,Ve){return[E/3*Re/D(b*b/3-Ve*Ve),Ve]};var Sn=b/S;function an(Re,Ve){return[Re*(1+D(l(Ve)))/2,Ve/(l(Ve/2)*l(Re/6))]}function Nr(Re,Ve){var $e=Re*Re,ot=Ve*Ve;return[Re*(.975534+ot*(-.0143059*$e-.119161+-.0547009*ot)),Ve*(1.00384+$e*(.0802894+-.02855*ot+199025e-9*$e)+ot*(.0998909+-.0491032*ot))]}function Pr(Re,Ve){return[p(Re)/l(Ve),y(Ve)*l(Re)]}function en(Re){var Ve=l(Re),$e=y(T+Re/2);function ot(mt,dt){var Et=dt-Re,Zt=h(Et)<v?mt*Ve:h(Zt=T+dt/2)<v||h(h(Zt)-x)<v?0:mt*Et/s(y(Zt)/$e);return[Zt,Et]}return ot.invert=function(mt,dt){var Et,Zt=dt+Re;return[h(dt)<v?mt/Ve:h(Et=T+Zt/2)<v||h(h(Et)-x)<v?0:mt*s(y(Et)/$e)/dt,Zt]},ot}function tn(Re,Ve){return[Re,1.25*s(y(T+.4*Ve))]}function Qr(Re){var Ve=Re.length-1;function $e(ot,mt){for(var dt,Et=l(mt),Zt=2/(1+Et*l(ot)),$t=Zt*Et*p(ot),Yt=Zt*p(mt),nr=Ve,cr=Re[nr],mr=cr[0],yr=cr[1];--nr>=0;)mr=(cr=Re[nr])[0]+$t*(dt=mr)-Yt*yr,yr=cr[1]+$t*yr+Yt*dt;return[mr=$t*(dt=mr)-Yt*yr,yr=$t*yr+Yt*dt]}return $e.invert=function(ot,mt){var dt=20,Et=ot,Zt=mt;do{for(var $t,Yt=Ve,nr=Re[Yt],cr=nr[0],mr=nr[1],yr=0,Or=0;--Yt>=0;)yr=cr+Et*($t=yr)-Zt*Or,Or=mr+Et*Or+Zt*$t,cr=(nr=Re[Yt])[0]+Et*($t=cr)-Zt*mr,mr=nr[1]+Et*mr+Zt*$t;var nn,gn,Cn=(yr=cr+Et*($t=yr)-Zt*Or)*yr+(Or=mr+Et*Or+Zt*$t)*Or;Et-=nn=((cr=Et*($t=cr)-Zt*mr-ot)*yr+(mr=Et*mr+Zt*$t-mt)*Or)/Cn,Zt-=gn=(mr*yr-cr*Or)/Cn}while(h(nn)+h(gn)>1e-12&&--dt>0);if(dt){var Dn=D(Et*Et+Zt*Zt),Hn=2*e(.5*Dn),zn=p(Hn);return[f(Et*zn,Dn*l(Hn)),Dn?M(Zt*zn/Dn):0]}},$e}an.invert=function(Re,Ve){var $e=h(Re),ot=h(Ve),mt=v,dt=x;ot<Sn?dt*=ot/Sn:mt+=6*P(Sn/ot);for(var Et=0;Et<25;Et++){var Zt=p(dt),$t=D(l(dt)),Yt=p(dt/2),nr=l(dt/2),cr=p(mt/6),mr=l(mt/6),yr=.5*mt*(1+$t)-$e,Or=dt/(nr*mr)-ot,nn=$t?-.25*mt*Zt/$t:0,gn=.5*(1+$t),Cn=(1+.5*dt*Yt/nr)/(nr*mr),Dn=dt/nr*(cr/6)/(mr*mr),Hn=nn*Dn-Cn*gn,zn=(yr*Dn-Or*gn)/Hn,ga=(Or*nn-yr*Cn)/Hn;if(dt-=zn,mt-=ga,h(zn)<v&&h(ga)<v)break}return[Re<0?-mt:mt,Ve<0?-dt:dt]},Nr.invert=function(Re,Ve){var $e=g(Re)*b,ot=Ve/2,mt=50;do{var dt=$e*$e,Et=ot*ot,Zt=$e*ot,$t=$e*(.975534+Et*(-.0143059*dt-.119161+-.0547009*Et))-Re,Yt=ot*(1.00384+dt*(.0802894+-.02855*Et+199025e-9*dt)+Et*(.0998909+-.0491032*Et))-Ve,nr=.975534-Et*(.119161+3*dt*.0143059+.0547009*Et),cr=-Zt*(.238322+.2188036*Et+.0286118*dt),mr=Zt*(.1605788+7961e-7*dt+-.0571*Et),yr=1.00384+dt*(.0802894+199025e-9*dt)+Et*(3*(.0998909-.02855*dt)-.245516*Et),Or=cr*mr-yr*nr,nn=(Yt*cr-$t*yr)/Or,gn=($t*mr-Yt*nr)/Or;$e-=nn,ot-=gn}while((h(nn)>v||h(gn)>v)&&--mt>0);return mt&&[$e,ot]},Pr.invert=function(Re,Ve){var $e=Re*Re,ot=Ve*Ve+1,mt=$e+ot,dt=Re?A*D((mt-D(mt*mt-4*$e))/$e):1/D(ot);return[M(Re*dt),g(Ve)*P(dt)]},tn.invert=function(Re,Ve){return[Re,2.5*e(o(.8*Ve))-.625*b]};var rn=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],An=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],En=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],Bn=[[.9245,0],[0,0],[.01943,0]],Jt=[[.721316,0],[0,0],[-.00881625,-.00617325]];function It(Re,Ve){var $e=d.geoProjection(Qr(Re)).rotate(Ve).clipAngle(90),ot=d.geoRotation(Ve),mt=$e.center;return delete $e.rotate,$e.center=function(dt){return arguments.length?mt(ot(dt)):ot.invert(mt())},$e}var qt=D(6),fr=D(7);function Tr(Re,Ve){var $e=M(7*p(Ve)/(3*qt));return[qt*Re*(2*l(2*$e/3)-1)/fr,9*p($e/3)/fr]}function Gr(Re,Ve){for(var $e,ot=(1+A)*p(Ve),mt=Ve,dt=0;dt<25&&(mt-=$e=(p(mt/2)+p(mt)-ot)/(.5*l(mt/2)+l(mt)),!(h($e)<v));dt++);return[Re*(1+2*l(mt)/l(mt/2))/(3*S),2*D(3)*p(mt/2)/D(2+S)]}function Vr(Re,Ve){for(var $e,ot=D(6/(4+b)),mt=(1+b/4)*p(Ve),dt=Ve/2,Et=0;Et<25&&(dt-=$e=(dt/2+p(dt)-mt)/(.5+l(dt)),!(h($e)<v));Et++);return[ot*(.5+l(dt))*Re/1.5,ot*dt]}function xr(Re,Ve){var $e=Ve*Ve,ot=$e*$e,mt=$e*ot;return[Re*(.84719-.13063*$e+mt*mt*(.05494*$e-.04515-.02326*ot+.00331*mt)),Ve*(1.01183+ot*ot*(.01926*$e-.02625-.00396*ot))]}function wr(Re,Ve){return[Re*(1+l(Ve))/2,2*(Ve-y(Ve/2))]}Tr.invert=function(Re,Ve){var $e=3*M(Ve*fr/9);return[Re*fr/(qt*(2*l(2*$e/3)-1)),M(3*p($e)*qt/7)]},Gr.invert=function(Re,Ve){var $e=Ve*D(2+S)/(2*D(3)),ot=2*M($e);return[3*S*Re/(1+2*l(ot)/l(ot/2)),M(($e+p(ot))/(1+A))]},Vr.invert=function(Re,Ve){var $e=D(6/(4+b)),ot=Ve/$e;return h(h(ot)-x)<v&&(ot=ot<0?-x:x),[1.5*Re/($e*(.5+l(ot))),M((ot/2+p(ot))/(1+b/4))]},xr.invert=function(Re,Ve){var $e,ot,mt,dt,Et=Ve,Zt=25;do Et-=$e=(Et*(1.01183+(mt=(ot=Et*Et)*ot)*mt*(.01926*ot-.02625-.00396*mt))-Ve)/(1.01183+mt*mt*(.21186*ot-.23625+-.05148*mt));while(h($e)>1e-12&&--Zt>0);return[Re/(.84719-.13063*(ot=Et*Et)+(dt=ot*(mt=ot*ot))*dt*(.05494*ot-.04515-.02326*mt+.00331*dt)),Et]},wr.invert=function(Re,Ve){for(var $e=Ve/2,ot=0,mt=1/0;ot<10&&h(mt)>v;++ot){var dt=l(Ve/2);Ve-=mt=(Ve-y(Ve/2)-$e)/(1-.5/(dt*dt))}return[2*Re/(1+l(Ve)),Ve]};var Sr=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function Mr(Re,Ve){var $e=p(Ve),ot=l(Ve),mt=g(Re);if(Re===0||h(Ve)===x)return[0,Ve];if(Ve===0)return[Re,0];if(h(Re)===x)return[Re*ot,x*$e];var dt=b/(2*Re)-2*Re/b,Et=2*Ve/b,Zt=(1-Et*Et)/($e-Et),$t=dt*dt,Yt=Zt*Zt,nr=1+$t/Yt,cr=1+Yt/$t,mr=(dt*$e/Zt-dt/2)/nr,yr=(Yt*$e/$t+Zt/2)/cr,Or=yr*yr-(Yt*$e*$e/$t+Zt*$e-1)/cr;return[x*(mr+D(mr*mr+ot*ot/nr)*mt),x*(yr+D(Or<0?0:Or)*g(-Ve*dt)*mt)]}Mr.invert=function(Re,Ve){var $e=(Re/=x)*Re,ot=$e+(Ve/=x)*Ve,mt=b*b;return[Re?(ot-1+D((1-ot)*(1-ot)+4*$e))/(2*Re)*x:0,ee(function(dt){return ot*(b*p(dt)-2*dt)*b+4*dt*dt*(Ve-p(dt))+2*b*dt-mt*Ve},0)]};function Ir(Re,Ve){var $e=Ve*Ve;return[Re,Ve*(1.0148+$e*$e*(.23185+$e*(.02406*$e-.14499)))]}function qr(Re,Ve){if(h(Ve)<v)return[Re,0];var $e=y(Ve),ot=Re*p(Ve);return[p(ot)/$e,Ve+(1-l(ot))/$e]}function cn(Re,Ve){var $e=Jr(Re[1],Re[0]),ot=Jr(Ve[1],Ve[0]),mt=function(Et,Zt){return f(Et[0]*Zt[1]-Et[1]*Zt[0],Et[0]*Zt[0]+Et[1]*Zt[1])}($e,ot),dt=bn($e)/bn(ot);return _n([1,0,Re[0][0],0,1,Re[0][1]],_n([dt,0,0,0,dt,0],_n([l(mt),p(mt),0,-p(mt),l(mt),0],[1,0,-Ve[0][0],0,1,-Ve[0][1]])))}function _n(Re,Ve){return[Re[0]*Ve[0]+Re[1]*Ve[3],Re[0]*Ve[1]+Re[1]*Ve[4],Re[0]*Ve[2]+Re[1]*Ve[5]+Re[2],Re[3]*Ve[0]+Re[4]*Ve[3],Re[3]*Ve[1]+Re[4]*Ve[4],Re[3]*Ve[2]+Re[4]*Ve[5]+Re[5]]}function Jr(Re,Ve){return[Re[0]-Ve[0],Re[1]-Ve[1]]}function bn(Re){return D(Re[0]*Re[0]+Re[1]*Re[1])}function Dr(Re,Ve,$e){function ot(Et,Zt){var $t,Yt=Ve(Et,Zt),nr=Yt.project([Et*k,Zt*k]);return($t=Yt.transform)?[$t[0]*nr[0]+$t[1]*nr[1]+$t[2],-($t[3]*nr[0]+$t[4]*nr[1]+$t[5])]:(nr[1]=-nr[1],nr)}(function Et(Zt,$t){if(Zt.edges=function(Or){for(var nn=Or.length,gn=[],Cn=Or[nn-1],Dn=0;Dn<nn;++Dn)gn.push([Cn,Cn=Or[Dn]]);return gn}(Zt.face),$t.face){var Yt=Zt.shared=function(Or,nn){for(var gn,Cn,Dn=Or.length,Hn=null,zn=0;zn<Dn;++zn){gn=Or[zn];for(var ga=nn.length;--ga>=0;)if(Cn=nn[ga],gn[0]===Cn[0]&&gn[1]===Cn[1]){if(Hn)return[Hn,gn];Hn=gn}}}(Zt.face,$t.face),nr=cn(Yt.map($t.project),Yt.map(Zt.project));Zt.transform=$t.transform?_n($t.transform,nr):nr;for(var cr=$t.edges,mr=0,yr=cr.length;mr<yr;++mr)Wr(Yt[0],cr[mr][1])&&Wr(Yt[1],cr[mr][0])&&(cr[mr]=Zt),Wr(Yt[0],cr[mr][0])&&Wr(Yt[1],cr[mr][1])&&(cr[mr]=Zt);for(cr=Zt.edges,mr=0,yr=cr.length;mr<yr;++mr)Wr(Yt[0],cr[mr][0])&&Wr(Yt[1],cr[mr][1])&&(cr[mr]=$t),Wr(Yt[0],cr[mr][1])&&Wr(Yt[1],cr[mr][0])&&(cr[mr]=$t)}else Zt.transform=$t.transform;return Zt.children&&Zt.children.forEach(function(Or){Et(Or,Zt)}),Zt})(Re,{transform:null}),vn(Re)&&(ot.invert=function(Et,Zt){var $t=function Yt(nr,cr){var mr=nr.project.invert,yr=nr.transform,Or=cr;if(yr&&(yr=function(Hn){var zn=1/(Hn[0]*Hn[4]-Hn[1]*Hn[3]);return[zn*Hn[4],-zn*Hn[1],zn*(Hn[1]*Hn[5]-Hn[2]*Hn[4]),-zn*Hn[3],zn*Hn[0],zn*(Hn[2]*Hn[3]-Hn[0]*Hn[5])]}(yr),Or=[yr[0]*Or[0]+yr[1]*Or[1]+yr[2],yr[3]*Or[0]+yr[4]*Or[1]+yr[5]]),mr&&nr===function(Hn){return Ve(Hn[0]*L,Hn[1]*L)}(nn=mr(Or)))return nn;for(var nn,gn=nr.children,Cn=0,Dn=gn&&gn.length;Cn<Dn;++Cn)if(nn=Yt(gn[Cn],cr))return nn}(Re,[Et,-Zt]);return $t&&($t[0]*=L,$t[1]*=L,$t)});var mt=d.geoProjection(ot),dt=mt.stream;return mt.stream=function(Et){var Zt=mt.rotate(),$t=dt(Et),Yt=(mt.rotate([0,0]),dt(Et));return mt.rotate(Zt),$t.sphere=function(){Yt.polygonStart(),Yt.lineStart(),function nr(cr,mr,yr){var Or,nn,gn=mr.edges,Cn=gn.length,Dn={type:"MultiPoint",coordinates:mr.face},Hn=mr.face.filter(function(Si){return h(Si[1])!==90}),zn=d.geoBounds({type:"MultiPoint",coordinates:Hn}),ga=!1,ka=-1,Ba=zn[1][0]-zn[0][0],Fa=Ba===180||Ba===360?[(zn[0][0]+zn[1][0])/2,(zn[0][1]+zn[1][1])/2]:d.geoCentroid(Dn);if(yr)for(;++ka<Cn&&gn[ka]!==yr;);++ka;for(var ja=0;ja<Cn;++ja)nn=gn[(ja+ka)%Cn],Array.isArray(nn)?(ga||(cr.point((Or=d.geoInterpolate(nn[0],Fa)(v))[0],Or[1]),ga=!0),cr.point((Or=d.geoInterpolate(nn[1],Fa)(v))[0],Or[1])):(ga=!1,nn!==yr&&nr(cr,nn,mr))}(Yt,Re),Yt.lineEnd(),Yt.polygonEnd()},$t},mt.angle($e==null?-30:$e*k)}function Wr(Re,Ve){return Re&&Ve&&Re[0]===Ve[0]&&Re[1]===Ve[1]}function vn(Re){return Re.project.invert||Re.children&&Re.children.some(vn)}Ir.invert=function(Re,Ve){Ve>1.790857183?Ve=1.790857183:Ve<-1.790857183&&(Ve=-1.790857183);var $e,ot=Ve;do{var mt=ot*ot;ot-=$e=(ot*(1.0148+mt*mt*(.23185+mt*(.02406*mt-.14499)))-Ve)/(1.0148+mt*mt*(5*.23185+mt*(.21654*mt-1.01493)))}while(h($e)>v);return[Re,ot]},qr.invert=function(Re,Ve){if(h(Ve)<v)return[Re,0];var $e,ot=Re*Re+Ve*Ve,mt=.5*Ve,dt=10;do{var Et=y(mt),Zt=1/l(mt),$t=ot-2*Ve*mt+mt*mt;mt-=$e=(Et*$t+2*(mt-Ve))/(2+$t*Zt*Zt+2*(mt-Ve)*Et)}while(h($e)>v&&--dt>0);return Et=y(mt),[(h(Ve)<h(mt+1/Et)?M(Re*Et):g(Ve)*g(Re)*(P(h(Re*Et))+x))/p(mt),mt]};var dn=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],Pn=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(Re){return Re.map(function(Ve){return dn[Ve]})}),sa=2/D(3);function Yn(Re,Ve){var $e=ze(Re,Ve);return[$e[0]*sa,$e[1]]}function yn(Re,Ve){for(var $e=0,ot=Re.length,mt=0;$e<ot;++$e)mt+=Re[$e]*Ve[$e];return mt}function ra(Re){return[f(Re[1],Re[0])*k,M(i(-1,c(1,Re[2])))*k]}function pa(Re){var Ve=Re[0]*L,$e=Re[1]*L,ot=l($e);return[ot*l(Ve),ot*p(Ve),p($e)]}function Qa(){}function Bi(Re,Ve){return{type:"FeatureCollection",features:Re.features.map(function($e){return li($e,Ve)})}}function li(Re,Ve){return{type:"Feature",id:Re.id,properties:Re.properties,geometry:Ai(Re.geometry,Ve)}}function Ai(Re,Ve){if(!Re)return null;if(Re.type==="GeometryCollection")return function(ot,mt){return{type:"GeometryCollection",geometries:ot.geometries.map(function(dt){return Ai(dt,mt)})}}(Re,Ve);var $e;switch(Re.type){case"Point":case"MultiPoint":$e=ko;break;case"LineString":case"MultiLineString":$e=Qo;break;case"Polygon":case"MultiPolygon":case"Sphere":$e=us;break;default:return null}return d.geoStream(Re,Ve($e)),$e.result()}Yn.invert=function(Re,Ve){return ze.invert(Re/sa,Ve)};var Ea=[],Ga=[],ko={point:function(Re,Ve){Ea.push([Re,Ve])},result:function(){var Re=Ea.length?Ea.length<2?{type:"Point",coordinates:Ea[0]}:{type:"MultiPoint",coordinates:Ea}:null;return Ea=[],Re}},Qo={lineStart:Qa,point:function(Re,Ve){Ea.push([Re,Ve])},lineEnd:function(){Ea.length&&(Ga.push(Ea),Ea=[])},result:function(){var Re=Ga.length?Ga.length<2?{type:"LineString",coordinates:Ga[0]}:{type:"MultiLineString",coordinates:Ga}:null;return Ga=[],Re}},us={polygonStart:Qa,lineStart:Qa,point:function(Re,Ve){Ea.push([Re,Ve])},lineEnd:function(){var Re=Ea.length;if(Re){do Ea.push(Ea[0].slice());while(++Re<4);Ga.push(Ea),Ea=[]}},polygonEnd:Qa,result:function(){if(!Ga.length)return null;var Re=[],Ve=[];return Ga.forEach(function($e){(function(ot){if((mt=ot.length)<4)return!1;for(var mt,dt=0,Et=ot[mt-1][1]*ot[0][0]-ot[mt-1][0]*ot[0][1];++dt<mt;)Et+=ot[dt-1][1]*ot[dt][0]-ot[dt-1][0]*ot[dt][1];return Et<=0})($e)?Re.push([$e]):Ve.push($e)}),Ve.forEach(function($e){var ot=$e[0];Re.some(function(mt){if(function(dt,Et){for(var Zt=Et[0],$t=Et[1],Yt=!1,nr=0,cr=dt.length,mr=cr-1;nr<cr;mr=nr++){var yr=dt[nr],Or=yr[0],nn=yr[1],gn=dt[mr],Cn=gn[0],Dn=gn[1];nn>$t^Dn>$t&&Zt<(Cn-Or)*($t-nn)/(Dn-nn)+Or&&(Yt=!Yt)}return Yt}(mt[0],ot))return mt.push($e),!0})||Re.push([$e])}),Ga=[],Re.length?Re.length>1?{type:"MultiPolygon",coordinates:Re}:{type:"Polygon",coordinates:Re[0]}:null}};function $i(Re){var Ve=Re(x,0)[0]-Re(-x,0)[0];function $e(ot,mt){var dt=h(ot)<x,Et=Re(dt?ot:ot>0?ot-b:ot+b,mt),Zt=(Et[0]-Et[1])*A,$t=(Et[0]+Et[1])*A;if(dt)return[Zt,$t];var Yt=Ve*A,nr=Zt>0^$t>0?-1:1;return[nr*Zt-g($t)*Yt,nr*$t-g(Zt)*Yt]}return Re.invert&&($e.invert=function(ot,mt){var dt=(ot+mt)*A,Et=(mt-ot)*A,Zt=h(dt)<.5*Ve&&h(Et)<.5*Ve;if(!Zt){var $t=Ve*A,Yt=dt>0^Et>0?-1:1,nr=-Yt*ot+(Et>0?1:-1)*$t,cr=-Yt*mt+(dt>0?1:-1)*$t;dt=(-nr-cr)*A,Et=(nr-cr)*A}var mr=Re.invert(dt,Et);return Zt||(mr[0]+=dt>0?b:-b),mr}),d.geoProjection($e).rotate([-90,-90,45]).clipAngle(179.999)}function to(){return $i(xt).scale(111.48)}function es(Re){var Ve=p(Re);function $e(ot,mt){var dt=Ve?y(ot*Ve/2)/Ve:ot/2;if(!mt)return[2*dt,-Re];var Et=2*e(dt*p(mt)),Zt=1/y(mt);return[p(Et)*Zt,mt+(1-l(Et))*Zt-Re]}return $e.invert=function(ot,mt){if(h(mt+=Re)<v)return[Ve?2*e(Ve*ot/2)/Ve:ot,0];var dt,Et=ot*ot+mt*mt,Zt=0,$t=10;do{var Yt=y(Zt),nr=1/l(Zt),cr=Et-2*mt*Zt+Zt*Zt;Zt-=dt=(Yt*cr+2*(Zt-mt))/(2+cr*nr*nr+2*(Zt-mt)*Yt)}while(h(dt)>v&&--$t>0);var mr=ot*(Yt=y(Zt)),yr=y(h(mt)<h(Zt+1/Yt)?.5*M(mr):.5*P(mr)+b/4)/p(Zt);return[Ve?2*e(Ve*yr)/Ve:2*yr,Zt]},$e}var Wa=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function jo(Re,Ve){var $e,ot=c(18,36*h(Ve)/b),mt=u(ot),dt=ot-mt,Et=($e=Wa[mt])[0],Zt=$e[1],$t=($e=Wa[++mt])[0],Yt=$e[1],nr=($e=Wa[c(19,++mt)])[0],cr=$e[1];return[Re*($t+dt*(nr-Et)/2+dt*dt*(nr-2*$t+Et)/2),(Ve>0?x:-x)*(Yt+dt*(cr-Zt)/2+dt*dt*(cr-2*Yt+Zt)/2)]}function Ao(Re,Ve){var $e=function(Et){function Zt($t,Yt){var nr=l(Yt),cr=(Et-1)/(Et-nr*l($t));return[cr*nr*p($t),cr*p(Yt)]}return Zt.invert=function($t,Yt){var nr=$t*$t+Yt*Yt,cr=D(nr),mr=(Et-D(1-nr*(Et+1)/(Et-1)))/((Et-1)/cr+cr/(Et-1));return[f($t*mr,cr*D(1-mr*mr)),cr?M(Yt*mr/cr):0]},Zt}(Re);if(!Ve)return $e;var ot=l(Ve),mt=p(Ve);function dt(Et,Zt){var $t=$e(Et,Zt),Yt=$t[1],nr=Yt*mt/(Re-1)+ot;return[$t[0]*ot/nr,Yt/nr]}return dt.invert=function(Et,Zt){var $t=(Re-1)/(Re-1-Zt*mt);return $e.invert($t*Et,$t*Zt*ot)},dt}Wa.forEach(function(Re){Re[1]*=1.0144}),jo.invert=function(Re,Ve){var $e=Ve/x,ot=90*$e,mt=c(18,h(ot/5)),dt=i(0,u(mt));do{var Et=Wa[dt][1],Zt=Wa[dt+1][1],$t=Wa[c(19,dt+2)][1],Yt=$t-Et,nr=$t-2*Zt+Et,cr=2*(h($e)-Zt)/Yt,mr=nr/Yt,yr=cr*(1-mr*cr*(1-2*mr*cr));if(yr>=0||dt===1){ot=(Ve>=0?5:-5)*(yr+mt);var Or,nn=50;do yr=(mt=c(18,h(ot)/5))-(dt=u(mt)),Et=Wa[dt][1],Zt=Wa[dt+1][1],$t=Wa[c(19,dt+2)][1],ot-=(Or=(Ve>=0?x:-x)*(Zt+yr*($t-Et)/2+yr*yr*($t-2*Zt+Et)/2)-Ve)*k;while(h(Or)>1e-12&&--nn>0);break}}while(--dt>=0);var gn=Wa[dt][0],Cn=Wa[dt+1][0],Dn=Wa[c(19,dt+2)][0];return[Re/(Cn+yr*(Dn-gn)/2+yr*yr*(Dn-2*Cn+gn)/2),ot*L]};var Mi=-179.9999,ro=179.9999,Mo=-89.9999;function zo(Re){return Re.length>0}function Vi(Re){return Re===-90||Re===90?[0,Re]:[-180,(Ve=Re,Math.floor(1e4*Ve)/1e4)];var Ve}function yi(Re){var Ve=Re[0],$e=Re[1],ot=!1;return Ve<=Mi?(Ve=-180,ot=!0):Ve>=ro&&(Ve=180,ot=!0),$e<=Mo?($e=-90,ot=!0):$e>=89.9999&&($e=90,ot=!0),ot?[Ve,$e]:Re}function Qi(Re){return Re.map(yi)}function Vs(Re,Ve,$e){for(var ot=0,mt=Re.length;ot<mt;++ot){var dt=Re[ot].slice();$e.push({index:-1,polygon:Ve,ring:dt});for(var Et=0,Zt=dt.length;Et<Zt;++Et){var $t=dt[Et],Yt=$t[0],nr=$t[1];if(Yt<=Mi||Yt>=ro||nr<=Mo||nr>=89.9999){dt[Et]=yi($t);for(var cr=Et+1;cr<Zt;++cr){var mr=dt[cr],yr=mr[0],Or=mr[1];if(yr>Mi&&yr<ro&&Or>Mo&&Or<89.9999)break}if(cr===Et+1)continue;if(Et){var nn={index:-1,polygon:Ve,ring:dt.slice(0,Et+1)};nn.ring[nn.ring.length-1]=Vi(nr),$e[$e.length-1]=nn}else $e.pop();if(cr>=Zt)break;$e.push({index:-1,polygon:Ve,ring:dt=dt.slice(cr-1)}),dt[0]=Vi(dt[0][1]),Et=-1,Zt=dt.length}}}}function Xs(Re){var Ve,$e,ot,mt,dt,Et,Zt=Re.length,$t={},Yt={};for(Ve=0;Ve<Zt;++Ve)ot=($e=Re[Ve]).ring[0],dt=$e.ring[$e.ring.length-1],ot[0]!==dt[0]||ot[1]!==dt[1]?($e.index=Ve,$t[ot]=Yt[dt]=$e):($e.polygon.push($e.ring),Re[Ve]=null);for(Ve=0;Ve<Zt;++Ve)if($e=Re[Ve]){if(ot=$e.ring[0],dt=$e.ring[$e.ring.length-1],mt=Yt[ot],Et=$t[dt],delete $t[ot],delete Yt[dt],ot[0]===dt[0]&&ot[1]===dt[1]){$e.polygon.push($e.ring);continue}mt?(delete Yt[ot],delete $t[mt.ring[0]],mt.ring.pop(),Re[mt.index]=null,$e={index:-1,polygon:mt.polygon,ring:mt.ring.concat($e.ring)},mt===Et?$e.polygon.push($e.ring):($e.index=Zt++,Re.push($t[$e.ring[0]]=Yt[$e.ring[$e.ring.length-1]]=$e))):Et?(delete $t[dt],delete Yt[Et.ring[Et.ring.length-1]],$e.ring.pop(),$e={index:Zt++,polygon:Et.polygon,ring:$e.ring.concat(Et.ring)},Re[Et.index]=null,Re.push($t[$e.ring[0]]=Yt[$e.ring[$e.ring.length-1]]=$e)):($e.ring.push($e.ring[0]),$e.polygon.push($e.ring))}}function Xa(Re){var Ve={type:"Feature",geometry:Os(Re.geometry)};return Re.id!=null&&(Ve.id=Re.id),Re.bbox!=null&&(Ve.bbox=Re.bbox),Re.properties!=null&&(Ve.properties=Re.properties),Ve}function Os(Re){if(Re==null)return Re;var Ve,$e,ot,mt;switch(Re.type){case"GeometryCollection":Ve={type:"GeometryCollection",geometries:Re.geometries.map(Os)};break;case"Point":Ve={type:"Point",coordinates:yi(Re.coordinates)};break;case"MultiPoint":case"LineString":Ve={type:Re.type,coordinates:Qi(Re.coordinates)};break;case"MultiLineString":Ve={type:"MultiLineString",coordinates:Re.coordinates.map(Qi)};break;case"Polygon":var dt=[];Vs(Re.coordinates,dt,$e=[]),Xs($e),Ve={type:"Polygon",coordinates:dt};break;case"MultiPolygon":$e=[],ot=-1,mt=Re.coordinates.length;for(var Et=new Array(mt);++ot<mt;)Vs(Re.coordinates[ot],Et[ot]=[],$e);Xs($e),Ve={type:"MultiPolygon",coordinates:Et.filter(zo)};break;default:return Re}return Re.bbox!=null&&(Ve.bbox=Re.bbox),Ve}function ms(Re,Ve){var $e=y(Ve/2),ot=p(T*$e);return[Re*(.74482-.34588*ot*ot),1.70711*$e]}function Zs(Re,Ve,$e){var ot=d.geoInterpolate(Ve,$e),mt=ot(.5),dt=d.geoRotation([-mt[0],-mt[1]])(Ve),Et=ot.distance/2,Zt=-M(p(dt[1]*L)/p(Et)),$t=[-mt[0],-mt[1],-(dt[0]>0?b-Zt:Zt)*k],Yt=d.geoProjection(Re(Et)).rotate($t),nr=d.geoRotation($t),cr=Yt.center;return delete Yt.rotate,Yt.center=function(mr){return arguments.length?cr(nr(mr)):nr.invert(cr())},Yt.clipAngle(90)}function Ks(Re){var Ve=l(Re);function $e(ot,mt){var dt=d.geoGnomonicRaw(ot,mt);return dt[0]*=Ve,dt}return $e.invert=function(ot,mt){return d.geoGnomonicRaw.invert(ot/Ve,mt)},$e}function Hs(Re,Ve){return Zs(Ks,Re,Ve)}function Js(Re){if(!(Re*=2))return d.geoAzimuthalEquidistantRaw;var Ve=-Re/2,$e=-Ve,ot=Re*Re,mt=y($e),dt=.5/p($e);function Et(Zt,$t){var Yt=P(l($t)*l(Zt-Ve)),nr=P(l($t)*l(Zt-$e));return[((Yt*=Yt)-(nr*=nr))/(2*Re),($t<0?-1:1)*D(4*ot*nr-(ot-Yt+nr)*(ot-Yt+nr))/(2*Re)]}return Et.invert=function(Zt,$t){var Yt,nr,cr=$t*$t,mr=l(D(cr+(Yt=Zt+Ve)*Yt)),yr=l(D(cr+(Yt=Zt+$e)*Yt));return[f(nr=mr-yr,Yt=(mr+yr)*mt),($t<0?-1:1)*P(D(Yt*Yt+nr*nr)*dt)]},Et}function Uo(Re,Ve){return Zs(Js,Re,Ve)}function Vo(Re,Ve){if(h(Ve)<v)return[Re,0];var $e=h(Ve/x),ot=M($e);if(h(Re)<v||h(h(Ve)-x)<v)return[0,g(Ve)*b*y(ot/2)];var mt=l(ot),dt=h(b/Re-Re/b)/2,Et=dt*dt,Zt=mt/($e+mt-1),$t=Zt*(2/$e-1),Yt=$t*$t,nr=Yt+Et,cr=Zt-Yt,mr=Et+Zt;return[g(Re)*b*(dt*cr+D(Et*cr*cr-nr*(Zt*Zt-Yt)))/nr,g(Ve)*b*($t*mr-dt*D((Et+1)*nr-mr*mr))/nr]}function ts(Re,Ve){if(h(Ve)<v)return[Re,0];var $e=h(Ve/x),ot=M($e);if(h(Re)<v||h(h(Ve)-x)<v)return[0,g(Ve)*b*y(ot/2)];var mt=l(ot),dt=h(b/Re-Re/b)/2,Et=dt*dt,Zt=mt*(D(1+Et)-dt*mt)/(1+Et*$e*$e);return[g(Re)*b*Zt,g(Ve)*b*D(1-Zt*(2*dt+Zt))]}function rs(Re,Ve){if(h(Ve)<v)return[Re,0];var $e=Ve/x,ot=M($e);if(h(Re)<v||h(h(Ve)-x)<v)return[0,b*y(ot/2)];var mt=(b/Re-Re/b)/2,dt=$e/(1+l(ot));return[b*(g(Re)*D(mt*mt+1-dt*dt)-mt),b*dt]}function ns(Re,Ve){if(!Ve)return[Re,0];var $e=h(Ve);if(!Re||$e===x)return[0,Ve];var ot=$e/x,mt=ot*ot,dt=(8*ot-mt*(mt+2)-5)/(2*mt*(ot-1)),Et=dt*dt,Zt=ot*dt,$t=mt+Et+2*Zt,Yt=ot+3*dt,nr=Re/x,cr=nr+1/nr,mr=g(h(Re)-x)*D(cr*cr-4),yr=mr*mr,Or=(mr*($t+Et-1)+2*D($t*(mt+Et*yr-1)+(1-mt)*(mt*(Yt*Yt+4*Et)+12*Zt*Et+4*Et*Et)))/(4*$t+yr);return[g(Re)*x*Or,g(Ve)*x*D(1+mr*h(Or)-Or*Or)]}function vs(Re,Ve,$e,ot){var mt=b/3;Re=i(Re,v),Ve=i(Ve,v),Re=c(Re,x),Ve=c(Ve,b-v),$e=i($e,0),$e=c($e,100-v);var dt=(ot=i(ot,v))/100,Et=P(($e/100+1)*l(mt))/mt,Zt=p(Re)/p(Et*x),$t=Ve/b,Yt=D(dt*p(Re/2)/p(Ve/2));return function(nr,cr,mr,yr,Or){function nn(gn,Cn){var Dn=mr*p(yr*Cn),Hn=D(1-Dn*Dn),zn=D(2/(1+Hn*l(gn*=Or)));return[nr*Hn*zn*p(gn),cr*Dn*zn]}return nn.invert=function(gn,Cn){var Dn=gn/nr,Hn=Cn/cr,zn=D(Dn*Dn+Hn*Hn),ga=2*M(zn/2);return[f(gn*y(ga),nr*zn)/Or,zn&&M(Cn*p(ga)/(cr*mr*zn))/yr]},nn}(Yt/D($t*Zt*Et),1/(Yt*D($t*Zt*Et)),Zt,Et,$t)}function So(){var Re=65*L,Ve=60*L,$e=20,ot=200,mt=d.geoProjectionMutator(vs),dt=mt(Re,Ve,$e,ot);return dt.poleline=function(Et){return arguments.length?mt(Re=+Et*L,Ve,$e,ot):Re*k},dt.parallels=function(Et){return arguments.length?mt(Re,Ve=+Et*L,$e,ot):Ve*k},dt.inflation=function(Et){return arguments.length?mt(Re,Ve,$e=+Et,ot):$e},dt.ratio=function(Et){return arguments.length?mt(Re,Ve,$e,ot=+Et):ot},dt.scale(163.775)}ms.invert=function(Re,Ve){var $e=Ve/1.70711,ot=p(T*$e);return[Re/(.74482-.34588*ot*ot),2*e($e)]},Vo.invert=function(Re,Ve){if(h(Ve)<v)return[Re,0];if(h(Re)<v)return[0,x*p(2*e(Ve/b))];var $e=(Re/=b)*Re,ot=(Ve/=b)*Ve,mt=$e+ot,dt=mt*mt,Et=-h(Ve)*(1+mt),Zt=Et-2*ot+$e,$t=-2*Et+1+2*ot+dt,Yt=ot/$t+(2*Zt*Zt*Zt/($t*$t*$t)-9*Et*Zt/($t*$t))/27,nr=(Et-Zt*Zt/(3*$t))/$t,cr=2*D(-nr/3),mr=P(3*Yt/(nr*cr))/3;return[b*(mt-1+D(1+2*($e-ot)+dt))/(2*Re),g(Ve)*b*(-cr*l(mr+b/3)-Zt/(3*$t))]},ts.invert=function(Re,Ve){if(!Re)return[0,x*p(2*e(Ve/b))];var $e=h(Re/b),ot=(1-$e*$e-(Ve/=b)*Ve)/(2*$e),mt=D(ot*ot+1);return[g(Re)*b*(mt-ot),g(Ve)*x*p(2*f(D((1-2*ot*$e)*(ot+mt)-$e),D(mt+ot+$e)))]},rs.invert=function(Re,Ve){if(!Ve)return[Re,0];var $e=Ve/b,ot=(b*b*(1-$e*$e)-Re*Re)/(2*b*Re);return[Re?b*(g(Re)*D(ot*ot+1)-ot):0,x*p(2*e($e))]},ns.invert=function(Re,Ve){var $e;if(!Re||!Ve)return[Re,Ve];Ve/=b;var ot=g(Re)*Re/x,mt=(ot*ot-1+4*Ve*Ve)/h(ot),dt=mt*mt,Et=2*Ve,Zt=50;do{var $t=Et*Et,Yt=(8*Et-$t*($t+2)-5)/(2*$t*(Et-1)),nr=(3*Et-$t*Et-10)/(2*$t*Et),cr=Yt*Yt,mr=Et*Yt,yr=Et+Yt,Or=yr*yr,nn=Et+3*Yt,gn=-2*yr*(4*mr*cr+(1-4*$t+3*$t*$t)*(1+nr)+cr*(14*$t-6-dt+(8*$t-8-2*dt)*nr)+mr*(12*$t-8+(10*$t-10-dt)*nr)),Cn=D(Or*($t+cr*dt-1)+(1-$t)*($t*(nn*nn+4*cr)+cr*(12*mr+4*cr)));Et-=$e=(mt*(Or+cr-1)+2*Cn-ot*(4*Or+dt))/(mt*(2*Yt*nr+2*yr*(1+nr))+gn/Cn-8*yr*(mt*(-1+cr+Or)+2*Cn)*(1+nr)/(dt+4*Or))}while($e>v&&--Zt>0);return[g(Re)*(D(mt*mt+4)+mt)*b/4,x*Et]};var Ds=4*b+3*D(3),vo=2*D(2*b*D(3)/Ds),as=ie(vo*D(3)/b,vo,Ds/6);function zs(Re,Ve){return[Re*D(1-3*Ve*Ve/(b*b)),Ve]}function Ho(Re,Ve){var $e=l(Ve),ot=l(Re)*$e,mt=1-ot,dt=l(Re=f(p(Re)*$e,-p(Ve))),Et=p(Re);return[Et*($e=D(1-ot*ot))-dt*mt,-dt*$e-Et*mt]}function qa(Re,Ve){var $e=X(Re,Ve);return[($e[0]+Re/x)/2,($e[1]+Ve)/2]}zs.invert=function(Re,Ve){return[Re/D(1-3*Ve*Ve/(b*b)),Ve]},Ho.invert=function(Re,Ve){var $e=(Re*Re+Ve*Ve)/-2,ot=D(-$e*(2+$e)),mt=Ve*$e+Re*ot,dt=Re*$e-Ve*ot,Et=D(dt*dt+mt*mt);return[f(ot*mt,Et*(1+$e)),Et?-M(ot*dt/Et):0]},qa.invert=function(Re,Ve){var $e=Re,ot=Ve,mt=25;do{var dt,Et=l(ot),Zt=p(ot),$t=p(2*ot),Yt=Zt*Zt,nr=Et*Et,cr=p($e),mr=l($e/2),yr=p($e/2),Or=yr*yr,nn=1-nr*mr*mr,gn=nn?P(Et*mr)*D(dt=1/nn):dt=0,Cn=.5*(2*gn*Et*yr+$e/x)-Re,Dn=.5*(gn*Zt+ot)-Ve,Hn=.5*dt*(nr*Or+gn*Et*mr*Yt)+.5/x,zn=dt*(cr*$t/4-gn*Zt*yr),ga=.125*dt*($t*yr-gn*Zt*nr*cr),ka=.5*dt*(Yt*mr+gn*Or*Et)+.5,Ba=zn*ga-ka*Hn,Fa=(Dn*zn-Cn*ka)/Ba,ja=(Cn*ga-Dn*Hn)/Ba;$e-=Fa,ot-=ja}while((h(Fa)>v||h(ja)>v)&&--mt>0);return[$e,ot]},t.geoNaturalEarth=d.geoNaturalEarth1,t.geoNaturalEarthRaw=d.geoNaturalEarth1Raw,t.geoAiry=function(){var Re=x,Ve=d.geoProjectionMutator(G),$e=Ve(Re);return $e.radius=function(ot){return arguments.length?Ve(Re=ot*L):Re*k},$e.scale(179.976).clipAngle(147)},t.geoAiryRaw=G,t.geoAitoff=function(){return d.geoProjection(X).scale(152.63)},t.geoAitoffRaw=X,t.geoArmadillo=function(){var Re=20*L,Ve=Re>=0?1:-1,$e=y(Ve*Re),ot=d.geoProjectionMutator(K),mt=ot(Re),dt=mt.stream;return mt.parallel=function(Et){return arguments.length?($e=y((Ve=(Re=Et*L)>=0?1:-1)*Re),ot(Re)):Re*k},mt.stream=function(Et){var Zt=mt.rotate(),$t=dt(Et),Yt=(mt.rotate([0,0]),dt(Et)),nr=mt.precision();return mt.rotate(Zt),$t.sphere=function(){Yt.polygonStart(),Yt.lineStart();for(var cr=-180*Ve;Ve*cr<180;cr+=90*Ve)Yt.point(cr,90*Ve);if(Re)for(;Ve*(cr-=3*Ve*nr)>=-180;)Yt.point(cr,Ve*-f(l(cr*L/2),$e)*k);Yt.lineEnd(),Yt.polygonEnd()},$t},mt.scale(218.695).center([0,28.0974])},t.geoArmadilloRaw=K,t.geoAugust=function(){return d.geoProjection(Z).scale(66.1603)},t.geoAugustRaw=Z,t.geoBaker=function(){return d.geoProjection($).scale(112.314)},t.geoBakerRaw=$,t.geoBerghaus=function(){var Re=5,Ve=d.geoProjectionMutator(z),$e=Ve(Re),ot=$e.stream,mt=-l(.01*L),dt=p(.01*L);return $e.lobes=function(Et){return arguments.length?Ve(Re=+Et):Re},$e.stream=function(Et){var Zt=$e.rotate(),$t=ot(Et),Yt=($e.rotate([0,0]),ot(Et));return $e.rotate(Zt),$t.sphere=function(){Yt.polygonStart(),Yt.lineStart();for(var nr=0,cr=360/Re,mr=2*b/Re,yr=90-180/Re,Or=x;nr<Re;++nr,yr-=cr,Or-=mr)Yt.point(f(dt*l(Or),mt)*k,M(dt*p(Or))*k),yr<-90?(Yt.point(-90,-180-yr-.01),Yt.point(-90,-180-yr+.01)):(Yt.point(90,yr+.01),Yt.point(90,yr-.01));Yt.lineEnd(),Yt.polygonEnd()},$t},$e.scale(87.8076).center([0,17.1875]).clipAngle(179.999)},t.geoBerghausRaw=z,t.geoBertin1953=function(){return d.geoProjection(Q()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])},t.geoBertin1953Raw=Q,t.geoBoggs=function(){return d.geoProjection(de).scale(160.857)},t.geoBoggsRaw=de,t.geoBonne=function(){return ue(ke).scale(123.082).center([0,26.1441]).parallel(45)},t.geoBonneRaw=ke,t.geoBottomley=function(){var Re=.5,Ve=d.geoProjectionMutator(Ee),$e=Ve(Re);return $e.fraction=function(ot){return arguments.length?Ve(Re=+ot):Re},$e.scale(158.837)},t.geoBottomleyRaw=Ee,t.geoBromley=function(){return d.geoProjection(be).scale(152.63)},t.geoBromleyRaw=be,t.geoChamberlin=Se,t.geoChamberlinRaw=we,t.geoChamberlinAfrica=function(){return Se([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])},t.geoCollignon=function(){return d.geoProjection(ze).scale(95.6464).center([0,30])},t.geoCollignonRaw=ze,t.geoCraig=function(){return ue(Fe).scale(249.828).clipAngle(90)},t.geoCraigRaw=Fe,t.geoCraster=function(){return d.geoProjection(rt).scale(156.19)},t.geoCrasterRaw=rt,t.geoCylindricalEqualArea=function(){return ue(Oe).parallel(38.58).scale(195.044)},t.geoCylindricalEqualAreaRaw=Oe,t.geoCylindricalStereographic=function(){return ue(je).scale(124.75)},t.geoCylindricalStereographicRaw=je,t.geoEckert1=function(){return d.geoProjection(We).scale(165.664)},t.geoEckert1Raw=We,t.geoEckert2=function(){return d.geoProjection(qe).scale(165.664)},t.geoEckert2Raw=qe,t.geoEckert3=function(){return d.geoProjection(et).scale(180.739)},t.geoEckert3Raw=et,t.geoEckert4=function(){return d.geoProjection(st).scale(180.739)},t.geoEckert4Raw=st,t.geoEckert5=function(){return d.geoProjection(ct).scale(173.044)},t.geoEckert5Raw=ct,t.geoEckert6=function(){return d.geoProjection(Pt).scale(173.044)},t.geoEckert6Raw=Pt,t.geoEisenlohr=function(){return d.geoProjection(at).scale(62.5271)},t.geoEisenlohrRaw=at,t.geoFahey=function(){return d.geoProjection(_t).scale(137.152)},t.geoFaheyRaw=_t,t.geoFoucaut=function(){return d.geoProjection(er).scale(135.264)},t.geoFoucautRaw=er,t.geoFoucautSinusoidal=function(){var Re=.5,Ve=d.geoProjectionMutator(tr),$e=Ve(Re);return $e.alpha=function(ot){return arguments.length?Ve(Re=+ot):Re},$e.scale(168.725)},t.geoFoucautSinusoidalRaw=tr,t.geoGilbert=function(Re){Re==null&&(Re=d.geoOrthographic);var Ve=Re(),$e=d.geoEquirectangular().scale(k).precision(0).clipAngle(null).translate([0,0]);function ot(dt){return Ve(Ue(dt))}function mt(dt){ot[dt]=function(){return arguments.length?(Ve[dt].apply(Ve,arguments),ot):Ve[dt]()}}return Ve.invert&&(ot.invert=function(dt){return He(Ve.invert(dt))}),ot.stream=function(dt){var Et=Ve.stream(dt),Zt=$e.stream({point:function($t,Yt){Et.point($t/2,M(y(-Yt/2*L))*k)},lineStart:function(){Et.lineStart()},lineEnd:function(){Et.lineEnd()},polygonStart:function(){Et.polygonStart()},polygonEnd:function(){Et.polygonEnd()}});return Zt.sphere=Et.sphere,Zt},ot.rotate=function(dt){return arguments.length?($e.rotate(dt),ot):$e.rotate()},ot.center=function(dt){return arguments.length?(Ve.center(Ue(dt)),ot):He(Ve.center())},mt("angle"),mt("clipAngle"),mt("clipExtent"),mt("fitExtent"),mt("fitHeight"),mt("fitSize"),mt("fitWidth"),mt("scale"),mt("translate"),mt("precision"),ot.scale(249.5)},t.geoGingery=function(){var Re=6,Ve=30*L,$e=l(Ve),ot=p(Ve),mt=d.geoProjectionMutator(Be),dt=mt(Ve,Re),Et=dt.stream,Zt=-l(.01*L),$t=p(.01*L);return dt.radius=function(Yt){return arguments.length?($e=l(Ve=Yt*L),ot=p(Ve),mt(Ve,Re)):Ve*k},dt.lobes=function(Yt){return arguments.length?mt(Ve,Re=+Yt):Re},dt.stream=function(Yt){var nr=dt.rotate(),cr=Et(Yt),mr=(dt.rotate([0,0]),Et(Yt));return dt.rotate(nr),cr.sphere=function(){mr.polygonStart(),mr.lineStart();for(var yr=0,Or=2*b/Re,nn=0;yr<Re;++yr,nn-=Or)mr.point(f($t*l(nn),Zt)*k,M($t*p(nn))*k),mr.point(f(ot*l(nn-Or/2),$e)*k,M(ot*p(nn-Or/2))*k);mr.lineEnd(),mr.polygonEnd()},cr},dt.rotate([90,-40]).scale(91.7095).clipAngle(179.999)},t.geoGingeryRaw=Be,t.geoGinzburg4=function(){return d.geoProjection(Le).scale(149.995)},t.geoGinzburg4Raw=Le,t.geoGinzburg5=function(){return d.geoProjection(Pe).scale(153.93)},t.geoGinzburg5Raw=Pe,t.geoGinzburg6=function(){return d.geoProjection(Xe).scale(130.945)},t.geoGinzburg6Raw=Xe,t.geoGinzburg8=function(){return d.geoProjection(ht).scale(131.747)},t.geoGinzburg8Raw=ht,t.geoGinzburg9=function(){return d.geoProjection(Mt).scale(131.087)},t.geoGinzburg9Raw=Mt,t.geoGringorten=function(){return d.geoProjection(pt(Lt)).scale(239.75)},t.geoGringortenRaw=Lt,t.geoGuyou=function(){return d.geoProjection(pt(xt)).scale(151.496)},t.geoGuyouRaw=xt,t.geoHammer=function(){var Re=2,Ve=d.geoProjectionMutator(j),$e=Ve(Re);return $e.coefficient=function(ot){return arguments.length?Ve(Re=+ot):Re},$e.scale(169.529)},t.geoHammerRaw=j,t.geoHammerRetroazimuthal=function(){var Re=0,Ve=d.geoProjectionMutator(it),$e=Ve(Re),ot=$e.rotate,mt=$e.stream,dt=d.geoCircle();return $e.parallel=function(Et){if(!arguments.length)return Re*k;var Zt=$e.rotate();return Ve(Re=Et*L).rotate(Zt)},$e.rotate=function(Et){return arguments.length?(ot.call($e,[Et[0],Et[1]-Re*k]),dt.center([-Et[0],-Et[1]]),$e):((Et=ot.call($e))[1]+=Re*k,Et)},$e.stream=function(Et){return(Et=mt(Et)).sphere=function(){Et.polygonStart();var Zt,$t=dt.radius(89.99)().coordinates[0],Yt=$t.length-1,nr=-1;for(Et.lineStart();++nr<Yt;)Et.point((Zt=$t[nr])[0],Zt[1]);for(Et.lineEnd(),Yt=($t=dt.radius(90.01)().coordinates[0]).length-1,Et.lineStart();--nr>=0;)Et.point((Zt=$t[nr])[0],Zt[1]);Et.lineEnd(),Et.polygonEnd()},Et},$e.scale(79.4187).parallel(45).clipAngle(179.999)},t.geoHammerRetroazimuthalRaw=it,t.geoHealpix=function(){var Re=4,Ve=d.geoProjectionMutator(Qt),$e=Ve(Re),ot=$e.stream;return $e.lobes=function(mt){return arguments.length?Ve(Re=+mt):Re},$e.stream=function(mt){var dt=$e.rotate(),Et=ot(mt),Zt=($e.rotate([0,0]),ot(mt));return $e.rotate(dt),Et.sphere=function(){var $t,Yt;d.geoStream(($t=180/Re,Yt=[].concat(m.range(-180,180+$t/2,$t).map(Ie),m.range(180,-180-$t/2,-$t).map(lt)),{type:"Polygon",coordinates:[$t===180?Yt.map(wt):Yt]}),Zt)},Et},$e.scale(239.75)},t.geoHealpixRaw=Qt,t.geoHill=function(){var Re=1,Ve=d.geoProjectionMutator(Ot),$e=Ve(Re);return $e.ratio=function(ot){return arguments.length?Ve(Re=+ot):Re},$e.scale(167.774).center([0,18.67])},t.geoHillRaw=Ot,t.geoHomolosine=function(){return d.geoProjection(ir).scale(152.63)},t.geoHomolosineRaw=ir,t.geoHufnagel=function(){var Re=1,Ve=0,$e=45*L,ot=2,mt=d.geoProjectionMutator(Xt),dt=mt(Re,Ve,$e,ot);return dt.a=function(Et){return arguments.length?mt(Re=+Et,Ve,$e,ot):Re},dt.b=function(Et){return arguments.length?mt(Re,Ve=+Et,$e,ot):Ve},dt.psiMax=function(Et){return arguments.length?mt(Re,Ve,$e=+Et*L,ot):$e*k},dt.ratio=function(Et){return arguments.length?mt(Re,Ve,$e,ot=+Et):ot},dt.scale(180.739)},t.geoHufnagelRaw=Xt,t.geoHyperelliptical=function(){var Re=0,Ve=2.5,$e=1.183136,ot=d.geoProjectionMutator(or),mt=ot(Re,Ve,$e);return mt.alpha=function(dt){return arguments.length?ot(Re=+dt,Ve,$e):Re},mt.k=function(dt){return arguments.length?ot(Re,Ve=+dt,$e):Ve},mt.gamma=function(dt){return arguments.length?ot(Re,Ve,$e=+dt):$e},mt.scale(152.63)},t.geoHyperellipticalRaw=or,t.geoInterrupt=pr,t.geoInterruptedBoggs=function(){return pr(de,br).scale(160.857)},t.geoInterruptedHomolosine=function(){return pr(ir,Rr).scale(152.63)},t.geoInterruptedMollweide=function(){return pr(ae,_r).scale(169.529)},t.geoInterruptedMollweideHemispheres=function(){return pr(ae,jr).scale(169.529).rotate([20,0])},t.geoInterruptedSinuMollweide=function(){return pr(Gt,$r,J).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},t.geoInterruptedSinusoidal=function(){return pr(ve,pn).scale(152.63).rotate([-20,0])},t.geoKavrayskiy7=function(){return d.geoProjection(In).scale(158.837)},t.geoKavrayskiy7Raw=In,t.geoLagrange=function(){var Re=.5,Ve=d.geoProjectionMutator(On),$e=Ve(Re);return $e.spacing=function(ot){return arguments.length?Ve(Re=+ot):Re},$e.scale(124.75)},t.geoLagrangeRaw=On,t.geoLarrivee=function(){return d.geoProjection(an).scale(97.2672)},t.geoLarriveeRaw=an,t.geoLaskowski=function(){return d.geoProjection(Nr).scale(139.98)},t.geoLaskowskiRaw=Nr,t.geoLittrow=function(){return d.geoProjection(Pr).scale(144.049).clipAngle(89.999)},t.geoLittrowRaw=Pr,t.geoLoximuthal=function(){return ue(en).parallel(40).scale(158.837)},t.geoLoximuthalRaw=en,t.geoMiller=function(){return d.geoProjection(tn).scale(108.318)},t.geoMillerRaw=tn,t.geoModifiedStereographic=It,t.geoModifiedStereographicRaw=Qr,t.geoModifiedStereographicAlaska=function(){return It(rn,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)},t.geoModifiedStereographicGs48=function(){return It(An,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])},t.geoModifiedStereographicGs50=function(){return It(En,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])},t.geoModifiedStereographicMiller=function(){return It(Bn,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)},t.geoModifiedStereographicLee=function(){return It(Jt,[165,10]).scale(250).clipAngle(130).center([-165,-10])},t.geoMollweide=function(){return d.geoProjection(ae).scale(169.529)},t.geoMollweideRaw=ae,t.geoMtFlatPolarParabolic=function(){return d.geoProjection(Tr).scale(164.859)},t.geoMtFlatPolarParabolicRaw=Tr,t.geoMtFlatPolarQuartic=function(){return d.geoProjection(Gr).scale(188.209)},t.geoMtFlatPolarQuarticRaw=Gr,t.geoMtFlatPolarSinusoidal=function(){return d.geoProjection(Vr).scale(166.518)},t.geoMtFlatPolarSinusoidalRaw=Vr,t.geoNaturalEarth2=function(){return d.geoProjection(xr).scale(175.295)},t.geoNaturalEarth2Raw=xr,t.geoNellHammer=function(){return d.geoProjection(wr).scale(152.63)},t.geoNellHammerRaw=wr,t.geoInterruptedQuarticAuthalic=function(){return pr(j(1/0),Sr).rotate([20,0]).scale(152.63)},t.geoNicolosi=function(){return d.geoProjection(Mr).scale(127.267)},t.geoNicolosiRaw=Mr,t.geoPatterson=function(){return d.geoProjection(Ir).scale(139.319)},t.geoPattersonRaw=Ir,t.geoPolyconic=function(){return d.geoProjection(qr).scale(103.74)},t.geoPolyconicRaw=qr,t.geoPolyhedral=Dr,t.geoPolyhedralButterfly=function(Re){Re=Re||function($e){var ot=d.geoCentroid({type:"MultiPoint",coordinates:$e});return d.geoGnomonic().scale(1).translate([0,0]).rotate([-ot[0],-ot[1]])};var Ve=Pn.map(function($e){return{face:$e,project:Re($e)}});return[-1,0,0,1,0,1,4,5].forEach(function($e,ot){var mt=Ve[$e];mt&&(mt.children||(mt.children=[])).push(Ve[ot])}),Dr(Ve[0],function($e,ot){return Ve[$e<-b/2?ot<0?6:4:$e<0?ot<0?2:0:$e<b/2?ot<0?3:1:ot<0?7:5]}).angle(-30).scale(101.858).center([0,45])},t.geoPolyhedralCollignon=function(Re){Re=Re||function($e){var ot=d.geoCentroid({type:"MultiPoint",coordinates:$e});return d.geoProjection(Yn).translate([0,0]).scale(1).rotate(ot[1]>0?[-ot[0],0]:[180-ot[0],180])};var Ve=Pn.map(function($e){return{face:$e,project:Re($e)}});return[-1,0,0,1,0,1,4,5].forEach(function($e,ot){var mt=Ve[$e];mt&&(mt.children||(mt.children=[])).push(Ve[ot])}),Dr(Ve[0],function($e,ot){return Ve[$e<-b/2?ot<0?6:4:$e<0?ot<0?2:0:$e<b/2?ot<0?3:1:ot<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])},t.geoPolyhedralWaterman=function(Re){Re=Re||function(dt){var Et=dt.length===6?d.geoCentroid({type:"MultiPoint",coordinates:dt}):dt[0];return d.geoGnomonic().scale(1).translate([0,0]).rotate([-Et[0],-Et[1]])};var Ve=Pn.map(function(dt){for(var Et,Zt=dt.map(pa),$t=Zt.length,Yt=Zt[$t-1],nr=[],cr=0;cr<$t;++cr)Et=Zt[cr],nr.push(ra([.9486832980505138*Yt[0]+.31622776601683794*Et[0],.9486832980505138*Yt[1]+.31622776601683794*Et[1],.9486832980505138*Yt[2]+.31622776601683794*Et[2]]),ra([.9486832980505138*Et[0]+.31622776601683794*Yt[0],.9486832980505138*Et[1]+.31622776601683794*Yt[1],.9486832980505138*Et[2]+.31622776601683794*Yt[2]])),Yt=Et;return nr}),$e=[],ot=[-1,0,0,1,0,1,4,5];Ve.forEach(function(dt,Et){for(var Zt,$t,Yt=Pn[Et],nr=Yt.length,cr=$e[Et]=[],mr=0;mr<nr;++mr)Ve.push([Yt[mr],dt[(2*mr+2)%(2*nr)],dt[(2*mr+1)%(2*nr)]]),ot.push(Et),cr.push((Zt=pa(dt[(2*mr+2)%(2*nr)]),$t=pa(dt[(2*mr+1)%(2*nr)]),[Zt[1]*$t[2]-Zt[2]*$t[1],Zt[2]*$t[0]-Zt[0]*$t[2],Zt[0]*$t[1]-Zt[1]*$t[0]]))});var mt=Ve.map(function(dt){return{project:Re(dt),face:dt}});return ot.forEach(function(dt,Et){var Zt=mt[dt];Zt&&(Zt.children||(Zt.children=[])).push(mt[Et])}),Dr(mt[0],function(dt,Et){var Zt=l(Et),$t=[Zt*l(dt),Zt*p(dt),p(Et)],Yt=dt<-b/2?Et<0?6:4:dt<0?Et<0?2:0:dt<b/2?Et<0?3:1:Et<0?7:5,nr=$e[Yt];return mt[yn(nr[0],$t)<0?8+3*Yt:yn(nr[1],$t)<0?8+3*Yt+1:yn(nr[2],$t)<0?8+3*Yt+2:Yt]}).angle(-30).scale(110.625).center([0,45])},t.geoProject=function(Re,Ve){var $e,ot=Ve.stream;if(!ot)throw new Error("invalid projection");switch(Re&&Re.type){case"Feature":$e=li;break;case"FeatureCollection":$e=Bi;break;default:$e=Ai}return $e(Re,ot)},t.geoGringortenQuincuncial=function(){return $i(Lt).scale(176.423)},t.geoPeirceQuincuncial=to,t.geoPierceQuincuncial=to,t.geoQuantize=function(Re,Ve){if(!(0<=(Ve=+Ve)&&Ve<=20))throw new Error("invalid digits");function $e(Yt){var nr=Yt.length,cr=2,mr=new Array(nr);for(mr[0]=+Yt[0].toFixed(Ve),mr[1]=+Yt[1].toFixed(Ve);cr<nr;)mr[cr]=Yt[cr],++cr;return mr}function ot(Yt){return Yt.map($e)}function mt(Yt){for(var nr=$e(Yt[0]),cr=[nr],mr=1;mr<Yt.length;mr++){var yr=$e(Yt[mr]);(yr.length>2||yr[0]!=nr[0]||yr[1]!=nr[1])&&(cr.push(yr),nr=yr)}return cr.length===1&&Yt.length>1&&cr.push($e(Yt[Yt.length-1])),cr}function dt(Yt){return Yt.map(mt)}function Et(Yt){if(Yt==null)return Yt;var nr;switch(Yt.type){case"GeometryCollection":nr={type:"GeometryCollection",geometries:Yt.geometries.map(Et)};break;case"Point":nr={type:"Point",coordinates:$e(Yt.coordinates)};break;case"MultiPoint":nr={type:Yt.type,coordinates:ot(Yt.coordinates)};break;case"LineString":nr={type:Yt.type,coordinates:mt(Yt.coordinates)};break;case"MultiLineString":case"Polygon":nr={type:Yt.type,coordinates:dt(Yt.coordinates)};break;case"MultiPolygon":nr={type:"MultiPolygon",coordinates:Yt.coordinates.map(dt)};break;default:return Yt}return Yt.bbox!=null&&(nr.bbox=Yt.bbox),nr}function Zt(Yt){var nr={type:"Feature",properties:Yt.properties,geometry:Et(Yt.geometry)};return Yt.id!=null&&(nr.id=Yt.id),Yt.bbox!=null&&(nr.bbox=Yt.bbox),nr}if(Re!=null)switch(Re.type){case"Feature":return Zt(Re);case"FeatureCollection":var $t={type:"FeatureCollection",features:Re.features.map(Zt)};return Re.bbox!=null&&($t.bbox=Re.bbox),$t;default:return Et(Re)}return Re},t.geoQuincuncial=$i,t.geoRectangularPolyconic=function(){return ue(es).scale(131.215)},t.geoRectangularPolyconicRaw=es,t.geoRobinson=function(){return d.geoProjection(jo).scale(152.63)},t.geoRobinsonRaw=jo,t.geoSatellite=function(){var Re=2,Ve=0,$e=d.geoProjectionMutator(Ao),ot=$e(Re,Ve);return ot.distance=function(mt){return arguments.length?$e(Re=+mt,Ve):Re},ot.tilt=function(mt){return arguments.length?$e(Re,Ve=mt*L):Ve*k},ot.scale(432.147).clipAngle(P(1/Re)*k-1e-6)},t.geoSatelliteRaw=Ao,t.geoSinuMollweide=function(){return d.geoProjection(Gt).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},t.geoSinuMollweideRaw=Gt,t.geoSinusoidal=function(){return d.geoProjection(ve).scale(152.63)},t.geoSinusoidalRaw=ve,t.geoStitch=function(Re){if(Re==null)return Re;switch(Re.type){case"Feature":return Xa(Re);case"FeatureCollection":var Ve={type:"FeatureCollection",features:Re.features.map(Xa)};return Re.bbox!=null&&(Ve.bbox=Re.bbox),Ve;default:return Os(Re)}},t.geoTimes=function(){return d.geoProjection(ms).scale(146.153)},t.geoTimesRaw=ms,t.geoTwoPointAzimuthal=Hs,t.geoTwoPointAzimuthalRaw=Ks,t.geoTwoPointAzimuthalUsa=function(){return Hs([-158,21.5],[-77,39]).clipAngle(60).scale(400)},t.geoTwoPointEquidistant=Uo,t.geoTwoPointEquidistantRaw=Js,t.geoTwoPointEquidistantUsa=function(){return Uo([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)},t.geoVanDerGrinten=function(){return d.geoProjection(Vo).scale(79.4183)},t.geoVanDerGrintenRaw=Vo,t.geoVanDerGrinten2=function(){return d.geoProjection(ts).scale(79.4183)},t.geoVanDerGrinten2Raw=ts,t.geoVanDerGrinten3=function(){return d.geoProjection(rs).scale(79.4183)},t.geoVanDerGrinten3Raw=rs,t.geoVanDerGrinten4=function(){return d.geoProjection(ns).scale(127.16)},t.geoVanDerGrinten4Raw=ns,t.geoWagner=So,t.geoWagner7=function(){return So().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)},t.geoWagnerRaw=vs,t.geoWagner4=function(){return d.geoProjection(as).scale(176.84)},t.geoWagner4Raw=as,t.geoWagner6=function(){return d.geoProjection(zs).scale(152.63)},t.geoWagner6Raw=zs,t.geoWiechel=function(){return d.geoProjection(Ho).rotate([0,-90,45]).scale(124.75).clipAngle(179.999)},t.geoWiechelRaw=Ho,t.geoWinkel3=function(){return d.geoProjection(qa).scale(158.837)},t.geoWinkel3Raw=qa,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":159,"d3-geo":166}],166:[function(r,I,B){(function(t,d){typeof B=="object"&&I!==void 0?d(B,r("d3-array")):d((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,d){function m(){return new h}function h(){this.reset()}h.prototype={constructor:h,reset:function(){this.s=this.t=0},add:function(ft){f(e,ft,this.t),f(this,e.s,this.s),this.s?this.t+=e.t:this.s=e.t},valueOf:function(){return this.s}};var e=new h;function f(ft,Rt,sr){var Vt=ft.s=Rt+sr,lr=Vt-Rt,Lr=Vt-lr;ft.t=Rt-Lr+(sr-lr)}var l=1e-6,o=Math.PI,u=o/2,s=o/4,i=2*o,c=180/o,n=o/180,a=Math.abs,g=Math.atan,p=Math.atan2,y=Math.cos,v=Math.ceil,b=Math.exp,x=Math.log,T=Math.pow,A=Math.sin,S=Math.sign||function(ft){return ft>0?1:ft<0?-1:0},w=Math.sqrt,E=Math.tan;function k(ft){return ft>1?0:ft<-1?o:Math.acos(ft)}function L(ft){return ft>1?u:ft<-1?-u:Math.asin(ft)}function M(ft){return(ft=A(ft/2))*ft}function P(){}function D(ft,Rt){ft&&U.hasOwnProperty(ft.type)&&U[ft.type](ft,Rt)}var N={Feature:function(ft,Rt){D(ft.geometry,Rt)},FeatureCollection:function(ft,Rt){for(var sr=ft.features,Vt=-1,lr=sr.length;++Vt<lr;)D(sr[Vt].geometry,Rt)}},U={Sphere:function(ft,Rt){Rt.sphere()},Point:function(ft,Rt){ft=ft.coordinates,Rt.point(ft[0],ft[1],ft[2])},MultiPoint:function(ft,Rt){for(var sr=ft.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)ft=sr[Vt],Rt.point(ft[0],ft[1],ft[2])},LineString:function(ft,Rt){G(ft.coordinates,Rt,0)},MultiLineString:function(ft,Rt){for(var sr=ft.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)G(sr[Vt],Rt,0)},Polygon:function(ft,Rt){X(ft.coordinates,Rt)},MultiPolygon:function(ft,Rt){for(var sr=ft.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)X(sr[Vt],Rt)},GeometryCollection:function(ft,Rt){for(var sr=ft.geometries,Vt=-1,lr=sr.length;++Vt<lr;)D(sr[Vt],Rt)}};function G(ft,Rt,sr){var Vt,lr=-1,Lr=ft.length-sr;for(Rt.lineStart();++lr<Lr;)Vt=ft[lr],Rt.point(Vt[0],Vt[1],Vt[2]);Rt.lineEnd()}function X(ft,Rt){var sr=-1,Vt=ft.length;for(Rt.polygonStart();++sr<Vt;)G(ft[sr],Rt,1);Rt.polygonEnd()}function K(ft,Rt){ft&&N.hasOwnProperty(ft.type)?N[ft.type](ft,Rt):D(ft,Rt)}var Z,H,Y,$,z,j=m(),W=m(),ee={point:P,lineStart:P,lineEnd:P,polygonStart:function(){j.reset(),ee.lineStart=J,ee.lineEnd=Q},polygonEnd:function(){var ft=+j;W.add(ft<0?i+ft:ft),this.lineStart=this.lineEnd=this.point=P},sphere:function(){W.add(i)}};function J(){ee.point=te}function Q(){ie(Z,H)}function te(ft,Rt){ee.point=ie,Z=ft,H=Rt,Y=ft*=n,$=y(Rt=(Rt*=n)/2+s),z=A(Rt)}function ie(ft,Rt){var sr=(ft*=n)-Y,Vt=sr>=0?1:-1,lr=Vt*sr,Lr=y(Rt=(Rt*=n)/2+s),zr=A(Rt),Yr=z*zr,ln=$*Lr+Yr*y(lr),on=Yr*Vt*A(lr);j.add(p(on,ln)),Y=ft,$=Lr,z=zr}function ae(ft){return[p(ft[1],ft[0]),L(ft[2])]}function he(ft){var Rt=ft[0],sr=ft[1],Vt=y(sr);return[Vt*y(Rt),Vt*A(Rt),A(sr)]}function se(ft,Rt){return ft[0]*Rt[0]+ft[1]*Rt[1]+ft[2]*Rt[2]}function de(ft,Rt){return[ft[1]*Rt[2]-ft[2]*Rt[1],ft[2]*Rt[0]-ft[0]*Rt[2],ft[0]*Rt[1]-ft[1]*Rt[0]]}function ue(ft,Rt){ft[0]+=Rt[0],ft[1]+=Rt[1],ft[2]+=Rt[2]}function ve(ft,Rt){return[ft[0]*Rt,ft[1]*Rt,ft[2]*Rt]}function ke(ft){var Rt=w(ft[0]*ft[0]+ft[1]*ft[1]+ft[2]*ft[2]);ft[0]/=Rt,ft[1]/=Rt,ft[2]/=Rt}var Ee,be,xe,ce,ge,we,Me,Se,ze,Fe,Ye,rt,Oe,je,We,qe,et,st,ct,Pt,kt,at,tt,_t,er,tr,Ue=m(),He={point:Be,lineStart:_e,lineEnd:Ce,polygonStart:function(){He.point=Le,He.lineStart=Pe,He.lineEnd=Xe,Ue.reset(),ee.polygonStart()},polygonEnd:function(){ee.polygonEnd(),He.point=Be,He.lineStart=_e,He.lineEnd=Ce,j<0?(Ee=-(xe=180),be=-(ce=90)):Ue>l?ce=90:Ue<-l&&(be=-90),Fe[0]=Ee,Fe[1]=xe},sphere:function(){Ee=-(xe=180),be=-(ce=90)}};function Be(ft,Rt){ze.push(Fe=[Ee=ft,xe=ft]),Rt<be&&(be=Rt),Rt>ce&&(ce=Rt)}function Ke(ft,Rt){var sr=he([ft*n,Rt*n]);if(Se){var Vt=de(Se,sr),lr=de([Vt[1],-Vt[0],0],Vt);ke(lr),lr=ae(lr);var Lr,zr=ft-ge,Yr=zr>0?1:-1,ln=lr[0]*c*Yr,on=a(zr)>180;on^(Yr*ge<ln&&ln<Yr*ft)?(Lr=lr[1]*c)>ce&&(ce=Lr):on^(Yr*ge<(ln=(ln+360)%360-180)&&ln<Yr*ft)?(Lr=-lr[1]*c)<be&&(be=Lr):(Rt<be&&(be=Rt),Rt>ce&&(ce=Rt)),on?ft<ge?ht(Ee,ft)>ht(Ee,xe)&&(xe=ft):ht(ft,xe)>ht(Ee,xe)&&(Ee=ft):xe>=Ee?(ft<Ee&&(Ee=ft),ft>xe&&(xe=ft)):ft>ge?ht(Ee,ft)>ht(Ee,xe)&&(xe=ft):ht(ft,xe)>ht(Ee,xe)&&(Ee=ft)}else ze.push(Fe=[Ee=ft,xe=ft]);Rt<be&&(be=Rt),Rt>ce&&(ce=Rt),Se=sr,ge=ft}function _e(){He.point=Ke}function Ce(){Fe[0]=Ee,Fe[1]=xe,He.point=Be,Se=null}function Le(ft,Rt){if(Se){var sr=ft-ge;Ue.add(a(sr)>180?sr+(sr>0?360:-360):sr)}else we=ft,Me=Rt;ee.point(ft,Rt),Ke(ft,Rt)}function Pe(){ee.lineStart()}function Xe(){Le(we,Me),ee.lineEnd(),a(Ue)>l&&(Ee=-(xe=180)),Fe[0]=Ee,Fe[1]=xe,Se=null}function ht(ft,Rt){return(Rt-=ft)<0?Rt+360:Rt}function Mt(ft,Rt){return ft[0]-Rt[0]}function pt(ft,Rt){return ft[0]<=ft[1]?ft[0]<=Rt&&Rt<=ft[1]:Rt<ft[0]||ft[1]<Rt}var Lt={sphere:P,point:vt,lineStart:xt,lineEnd:Nt,polygonStart:function(){Lt.lineStart=Ut,Lt.lineEnd=Qt},polygonEnd:function(){Lt.lineStart=xt,Lt.lineEnd=Nt}};function vt(ft,Rt){ft*=n;var sr=y(Rt*=n);Dt(sr*y(ft),sr*A(ft),A(Rt))}function Dt(ft,Rt,sr){++Ye,Oe+=(ft-Oe)/Ye,je+=(Rt-je)/Ye,We+=(sr-We)/Ye}function xt(){Lt.point=it}function it(ft,Rt){ft*=n;var sr=y(Rt*=n);_t=sr*y(ft),er=sr*A(ft),tr=A(Rt),Lt.point=St,Dt(_t,er,tr)}function St(ft,Rt){ft*=n;var sr=y(Rt*=n),Vt=sr*y(ft),lr=sr*A(ft),Lr=A(Rt),zr=p(w((zr=er*Lr-tr*lr)*zr+(zr=tr*Vt-_t*Lr)*zr+(zr=_t*lr-er*Vt)*zr),_t*Vt+er*lr+tr*Lr);rt+=zr,qe+=zr*(_t+(_t=Vt)),et+=zr*(er+(er=lr)),st+=zr*(tr+(tr=Lr)),Dt(_t,er,tr)}function Nt(){Lt.point=vt}function Ut(){Lt.point=Ie}function Qt(){lt(at,tt),Lt.point=vt}function Ie(ft,Rt){at=ft,tt=Rt,ft*=n,Rt*=n,Lt.point=lt;var sr=y(Rt);_t=sr*y(ft),er=sr*A(ft),tr=A(Rt),Dt(_t,er,tr)}function lt(ft,Rt){ft*=n;var sr=y(Rt*=n),Vt=sr*y(ft),lr=sr*A(ft),Lr=A(Rt),zr=er*Lr-tr*lr,Yr=tr*Vt-_t*Lr,ln=_t*lr-er*Vt,on=w(zr*zr+Yr*Yr+ln*ln),mn=L(on),wn=on&&-mn/on;ct+=wn*zr,Pt+=wn*Yr,kt+=wn*ln,rt+=mn,qe+=mn*(_t+(_t=Vt)),et+=mn*(er+(er=lr)),st+=mn*(tr+(tr=Lr)),Dt(_t,er,tr)}function wt(ft){return function(){return ft}}function Ot(ft,Rt){function sr(Vt,lr){return Vt=ft(Vt,lr),Rt(Vt[0],Vt[1])}return ft.invert&&Rt.invert&&(sr.invert=function(Vt,lr){return(Vt=Rt.invert(Vt,lr))&&ft.invert(Vt[0],Vt[1])}),sr}function Gt(ft,Rt){return[a(ft)>o?ft+Math.round(-ft/i)*i:ft,Rt]}function ir(ft,Rt,sr){return(ft%=i)?Rt||sr?Ot(Kt(ft),or(Rt,sr)):Kt(ft):Rt||sr?or(Rt,sr):Gt}function Xt(ft){return function(Rt,sr){return[(Rt+=ft)>o?Rt-i:Rt<-o?Rt+i:Rt,sr]}}function Kt(ft){var Rt=Xt(ft);return Rt.invert=Xt(-ft),Rt}function or(ft,Rt){var sr=y(ft),Vt=A(ft),lr=y(Rt),Lr=A(Rt);function zr(Yr,ln){var on=y(ln),mn=y(Yr)*on,wn=A(Yr)*on,un=A(ln),Tn=un*sr+mn*Vt;return[p(wn*lr-Tn*Lr,mn*sr-un*Vt),L(Tn*lr+wn*Lr)]}return zr.invert=function(Yr,ln){var on=y(ln),mn=y(Yr)*on,wn=A(Yr)*on,un=A(ln),Tn=un*lr-wn*Lr;return[p(wn*lr+un*Lr,mn*sr+Tn*Vt),L(Tn*sr-mn*Vt)]},zr}function dr(ft){function Rt(sr){return(sr=ft(sr[0]*n,sr[1]*n))[0]*=c,sr[1]*=c,sr}return ft=ir(ft[0]*n,ft[1]*n,ft.length>2?ft[2]*n:0),Rt.invert=function(sr){return(sr=ft.invert(sr[0]*n,sr[1]*n))[0]*=c,sr[1]*=c,sr},Rt}function vr(ft,Rt,sr,Vt,lr,Lr){if(sr){var zr=y(Rt),Yr=A(Rt),ln=Vt*sr;lr==null?(lr=Rt+Vt*i,Lr=Rt-ln/2):(lr=ur(zr,lr),Lr=ur(zr,Lr),(Vt>0?lr<Lr:lr>Lr)&&(lr+=Vt*i));for(var on,mn=lr;Vt>0?mn>Lr:mn<Lr;mn-=ln)on=ae([zr,-Yr*y(mn),-Yr*A(mn)]),ft.point(on[0],on[1])}}function ur(ft,Rt){(Rt=he(Rt))[0]-=ft,ke(Rt);var sr=k(-Rt[1]);return((-Rt[2]<0?-sr:sr)+i-l)%i}function pr(){var ft,Rt=[];return{point:function(sr,Vt,lr){ft.push([sr,Vt,lr])},lineStart:function(){Rt.push(ft=[])},lineEnd:P,rejoin:function(){Rt.length>1&&Rt.push(Rt.pop().concat(Rt.shift()))},result:function(){var sr=Rt;return Rt=[],ft=null,sr}}}function br(ft,Rt){return a(ft[0]-Rt[0])<l&&a(ft[1]-Rt[1])<l}function Rr(ft,Rt,sr,Vt){this.x=ft,this.z=Rt,this.o=sr,this.e=Vt,this.v=!1,this.n=this.p=null}function _r(ft,Rt,sr,Vt,lr){var Lr,zr,Yr=[],ln=[];if(ft.forEach(function(Rn){if(!((Vn=Rn.length-1)<=0)){var Vn,ta,Xr=Rn[0],$n=Rn[Vn];if(br(Xr,$n)){if(!Xr[2]&&!$n[2]){for(lr.lineStart(),Lr=0;Lr<Vn;++Lr)lr.point((Xr=Rn[Lr])[0],Xr[1]);return void lr.lineEnd()}$n[0]+=2*l}Yr.push(ta=new Rr(Xr,Rn,null,!0)),ln.push(ta.o=new Rr(Xr,null,ta,!1)),Yr.push(ta=new Rr($n,Rn,null,!1)),ln.push(ta.o=new Rr($n,null,ta,!0))}}),Yr.length){for(ln.sort(Rt),jr(Yr),jr(ln),Lr=0,zr=ln.length;Lr<zr;++Lr)ln[Lr].e=sr=!sr;for(var on,mn,wn=Yr[0];;){for(var un=wn,Tn=!0;un.v;)if((un=un.n)===wn)return;on=un.z,lr.lineStart();do{if(un.v=un.o.v=!0,un.e){if(Tn)for(Lr=0,zr=on.length;Lr<zr;++Lr)lr.point((mn=on[Lr])[0],mn[1]);else Vt(un.x,un.n.x,1,lr);un=un.n}else{if(Tn)for(on=un.p.z,Lr=on.length-1;Lr>=0;--Lr)lr.point((mn=on[Lr])[0],mn[1]);else Vt(un.x,un.p.x,-1,lr);un=un.p}on=(un=un.o).z,Tn=!Tn}while(!un.v);lr.lineEnd()}}}function jr(ft){if(Rt=ft.length){for(var Rt,sr,Vt=0,lr=ft[0];++Vt<Rt;)lr.n=sr=ft[Vt],sr.p=lr,lr=sr;lr.n=sr=ft[0],sr.p=lr}}Gt.invert=Gt;var $r=m();function pn(ft){return a(ft[0])<=o?ft[0]:S(ft[0])*((a(ft[0])+o)%i-o)}function In(ft,Rt){var sr=pn(Rt),Vt=Rt[1],lr=A(Vt),Lr=[A(sr),-y(sr),0],zr=0,Yr=0;$r.reset(),lr===1?Vt=u+l:lr===-1&&(Vt=-u-l);for(var ln=0,on=ft.length;ln<on;++ln)if(wn=(mn=ft[ln]).length)for(var mn,wn,un=mn[wn-1],Tn=pn(un),Rn=un[1]/2+s,Vn=A(Rn),ta=y(Rn),Xr=0;Xr<wn;++Xr,Tn=Ln,Vn=Jn,ta=Ta,un=$n){var $n=mn[Xr],Ln=pn($n),jn=$n[1]/2+s,Jn=A(jn),Ta=y(jn),Ca=Ln-Tn,Mn=Ca>=0?1:-1,Da=Mn*Ca,Sa=Da>o,da=Vn*Jn;if($r.add(p(da*Mn*A(Da),ta*Ta+da*y(Da))),zr+=Sa?Ca+Mn*i:Ca,Sa^Tn>=sr^Ln>=sr){var za=de(he(un),he($n));ke(za);var Aa=de(Lr,za);ke(Aa);var ti=(Sa^Ca>=0?-1:1)*L(Aa[2]);(Vt>ti||Vt===ti&&(za[0]||za[1]))&&(Yr+=Sa^Ca>=0?1:-1)}}return(zr<-l||zr<l&&$r<-l)^1&Yr}function On(ft,Rt,sr,Vt){return function(lr){var Lr,zr,Yr,ln=Rt(lr),on=pr(),mn=Rt(on),wn=!1,un={point:Tn,lineStart:Vn,lineEnd:ta,polygonStart:function(){un.point=Xr,un.lineStart=$n,un.lineEnd=Ln,zr=[],Lr=[]},polygonEnd:function(){un.point=Tn,un.lineStart=Vn,un.lineEnd=ta,zr=d.merge(zr);var jn=In(Lr,Vt);zr.length?(wn||(lr.polygonStart(),wn=!0),_r(zr,an,jn,sr,lr)):jn&&(wn||(lr.polygonStart(),wn=!0),lr.lineStart(),sr(null,null,1,lr),lr.lineEnd()),wn&&(lr.polygonEnd(),wn=!1),zr=Lr=null},sphere:function(){lr.polygonStart(),lr.lineStart(),sr(null,null,1,lr),lr.lineEnd(),lr.polygonEnd()}};function Tn(jn,Jn){ft(jn,Jn)&&lr.point(jn,Jn)}function Rn(jn,Jn){ln.point(jn,Jn)}function Vn(){un.point=Rn,ln.lineStart()}function ta(){un.point=Tn,ln.lineEnd()}function Xr(jn,Jn){Yr.push([jn,Jn]),mn.point(jn,Jn)}function $n(){mn.lineStart(),Yr=[]}function Ln(){Xr(Yr[0][0],Yr[0][1]),mn.lineEnd();var jn,Jn,Ta,Ca,Mn=mn.clean(),Da=on.result(),Sa=Da.length;if(Yr.pop(),Lr.push(Yr),Yr=null,Sa)if(1&Mn){if((Jn=(Ta=Da[0]).length-1)>0){for(wn||(lr.polygonStart(),wn=!0),lr.lineStart(),jn=0;jn<Jn;++jn)lr.point((Ca=Ta[jn])[0],Ca[1]);lr.lineEnd()}}else Sa>1&&2&Mn&&Da.push(Da.pop().concat(Da.shift())),zr.push(Da.filter(Sn))}return un}}function Sn(ft){return ft.length>1}function an(ft,Rt){return((ft=ft.x)[0]<0?ft[1]-u-l:u-ft[1])-((Rt=Rt.x)[0]<0?Rt[1]-u-l:u-Rt[1])}var Nr=On(function(){return!0},function(ft){var Rt,sr=NaN,Vt=NaN,lr=NaN;return{lineStart:function(){ft.lineStart(),Rt=1},point:function(Lr,zr){var Yr=Lr>0?o:-o,ln=a(Lr-sr);a(ln-o)<l?(ft.point(sr,Vt=(Vt+zr)/2>0?u:-u),ft.point(lr,Vt),ft.lineEnd(),ft.lineStart(),ft.point(Yr,Vt),ft.point(Lr,Vt),Rt=0):lr!==Yr&&ln>=o&&(a(sr-lr)<l&&(sr-=lr*l),a(Lr-Yr)<l&&(Lr-=Yr*l),Vt=function(on,mn,wn,un){var Tn,Rn,Vn=A(on-wn);return a(Vn)>l?g((A(mn)*(Rn=y(un))*A(wn)-A(un)*(Tn=y(mn))*A(on))/(Tn*Rn*Vn)):(mn+un)/2}(sr,Vt,Lr,zr),ft.point(lr,Vt),ft.lineEnd(),ft.lineStart(),ft.point(Yr,Vt),Rt=0),ft.point(sr=Lr,Vt=zr),lr=Yr},lineEnd:function(){ft.lineEnd(),sr=Vt=NaN},clean:function(){return 2-Rt}}},function(ft,Rt,sr,Vt){var lr;if(ft==null)lr=sr*u,Vt.point(-o,lr),Vt.point(0,lr),Vt.point(o,lr),Vt.point(o,0),Vt.point(o,-lr),Vt.point(0,-lr),Vt.point(-o,-lr),Vt.point(-o,0),Vt.point(-o,lr);else if(a(ft[0]-Rt[0])>l){var Lr=ft[0]<Rt[0]?o:-o;lr=sr*Lr/2,Vt.point(-Lr,lr),Vt.point(0,lr),Vt.point(Lr,lr)}else Vt.point(Rt[0],Rt[1])},[-o,-u]);function Pr(ft){var Rt=y(ft),sr=6*n,Vt=Rt>0,lr=a(Rt)>l;function Lr(ln,on){return y(ln)*y(on)>Rt}function zr(ln,on,mn){var wn=[1,0,0],un=de(he(ln),he(on)),Tn=se(un,un),Rn=un[0],Vn=Tn-Rn*Rn;if(!Vn)return!mn&&ln;var ta=Rt*Tn/Vn,Xr=-Rt*Rn/Vn,$n=de(wn,un),Ln=ve(wn,ta);ue(Ln,ve(un,Xr));var jn=$n,Jn=se(Ln,jn),Ta=se(jn,jn),Ca=Jn*Jn-Ta*(se(Ln,Ln)-1);if(!(Ca<0)){var Mn=w(Ca),Da=ve(jn,(-Jn-Mn)/Ta);if(ue(Da,Ln),Da=ae(Da),!mn)return Da;var Sa,da=ln[0],za=on[0],Aa=ln[1],ti=on[1];za<da&&(Sa=da,da=za,za=Sa);var Qn=za-da,Za=a(Qn-o)<l;if(!Za&&ti<Aa&&(Sa=Aa,Aa=ti,ti=Sa),Za||Qn<l?Za?Aa+ti>0^Da[1]<(a(Da[0]-da)<l?Aa:ti):Aa<=Da[1]&&Da[1]<=ti:Qn>o^(da<=Da[0]&&Da[0]<=za)){var Gi=ve(jn,(-Jn+Mn)/Ta);return ue(Gi,Ln),[Da,ae(Gi)]}}}function Yr(ln,on){var mn=Vt?ft:o-ft,wn=0;return ln<-mn?wn|=1:ln>mn&&(wn|=2),on<-mn?wn|=4:on>mn&&(wn|=8),wn}return On(Lr,function(ln){var on,mn,wn,un,Tn;return{lineStart:function(){un=wn=!1,Tn=1},point:function(Rn,Vn){var ta,Xr=[Rn,Vn],$n=Lr(Rn,Vn),Ln=Vt?$n?0:Yr(Rn,Vn):$n?Yr(Rn+(Rn<0?o:-o),Vn):0;if(!on&&(un=wn=$n)&&ln.lineStart(),$n!==wn&&(!(ta=zr(on,Xr))||br(on,ta)||br(Xr,ta))&&(Xr[2]=1),$n!==wn)Tn=0,$n?(ln.lineStart(),ta=zr(Xr,on),ln.point(ta[0],ta[1])):(ta=zr(on,Xr),ln.point(ta[0],ta[1],2),ln.lineEnd()),on=ta;else if(lr&&on&&Vt^$n){var jn;Ln&mn||!(jn=zr(Xr,on,!0))||(Tn=0,Vt?(ln.lineStart(),ln.point(jn[0][0],jn[0][1]),ln.point(jn[1][0],jn[1][1]),ln.lineEnd()):(ln.point(jn[1][0],jn[1][1]),ln.lineEnd(),ln.lineStart(),ln.point(jn[0][0],jn[0][1],3)))}!$n||on&&br(on,Xr)||ln.point(Xr[0],Xr[1]),on=Xr,wn=$n,mn=Ln},lineEnd:function(){wn&&ln.lineEnd(),on=null},clean:function(){return Tn|(un&&wn)<<1}}},function(ln,on,mn,wn){vr(wn,ft,sr,mn,ln,on)},Vt?[0,-ft]:[-o,ft-o])}function en(ft,Rt,sr,Vt){function lr(on,mn){return ft<=on&&on<=sr&&Rt<=mn&&mn<=Vt}function Lr(on,mn,wn,un){var Tn=0,Rn=0;if(on==null||(Tn=zr(on,wn))!==(Rn=zr(mn,wn))||ln(on,mn)<0^wn>0)do un.point(Tn===0||Tn===3?ft:sr,Tn>1?Vt:Rt);while((Tn=(Tn+wn+4)%4)!==Rn);else un.point(mn[0],mn[1])}function zr(on,mn){return a(on[0]-ft)<l?mn>0?0:3:a(on[0]-sr)<l?mn>0?2:1:a(on[1]-Rt)<l?mn>0?1:0:mn>0?3:2}function Yr(on,mn){return ln(on.x,mn.x)}function ln(on,mn){var wn=zr(on,1),un=zr(mn,1);return wn!==un?wn-un:wn===0?mn[1]-on[1]:wn===1?on[0]-mn[0]:wn===2?on[1]-mn[1]:mn[0]-on[0]}return function(on){var mn,wn,un,Tn,Rn,Vn,ta,Xr,$n,Ln,jn,Jn=on,Ta=pr(),Ca={point:Mn,lineStart:function(){Ca.point=Da,wn&&wn.push(un=[]),Ln=!0,$n=!1,ta=Xr=NaN},lineEnd:function(){mn&&(Da(Tn,Rn),Vn&&$n&&Ta.rejoin(),mn.push(Ta.result())),Ca.point=Mn,$n&&Jn.lineEnd()},polygonStart:function(){Jn=Ta,mn=[],wn=[],jn=!0},polygonEnd:function(){var Sa=function(){for(var Aa=0,ti=0,Qn=wn.length;ti<Qn;++ti)for(var Za,Gi,cs=wn[ti],Xo=1,Eo=cs.length,va=cs[0],xi=va[0],Co=va[1];Xo<Eo;++Xo)Za=xi,Gi=Co,va=cs[Xo],xi=va[0],Co=va[1],Gi<=Vt?Co>Vt&&(xi-Za)*(Vt-Gi)>(Co-Gi)*(ft-Za)&&++Aa:Co<=Vt&&(xi-Za)*(Vt-Gi)<(Co-Gi)*(ft-Za)&&--Aa;return Aa}(),da=jn&&Sa,za=(mn=d.merge(mn)).length;(da||za)&&(on.polygonStart(),da&&(on.lineStart(),Lr(null,null,1,on),on.lineEnd()),za&&_r(mn,Yr,Sa,Lr,on),on.polygonEnd()),Jn=on,mn=wn=un=null}};function Mn(Sa,da){lr(Sa,da)&&Jn.point(Sa,da)}function Da(Sa,da){var za=lr(Sa,da);if(wn&&un.push([Sa,da]),Ln)Tn=Sa,Rn=da,Vn=za,Ln=!1,za&&(Jn.lineStart(),Jn.point(Sa,da));else if(za&&$n)Jn.point(Sa,da);else{var Aa=[ta=Math.max(-1e9,Math.min(1e9,ta)),Xr=Math.max(-1e9,Math.min(1e9,Xr))],ti=[Sa=Math.max(-1e9,Math.min(1e9,Sa)),da=Math.max(-1e9,Math.min(1e9,da))];(function(Qn,Za,Gi,cs,Xo,Eo){var va,xi=Qn[0],Co=Qn[1],Ka=0,Ei=1,Zi=Za[0]-xi,ai=Za[1]-Co;if(va=Gi-xi,Zi||!(va>0)){if(va/=Zi,Zi<0){if(va<Ka)return;va<Ei&&(Ei=va)}else if(Zi>0){if(va>Ei)return;va>Ka&&(Ka=va)}if(va=Xo-xi,Zi||!(va<0)){if(va/=Zi,Zi<0){if(va>Ei)return;va>Ka&&(Ka=va)}else if(Zi>0){if(va<Ka)return;va<Ei&&(Ei=va)}if(va=cs-Co,ai||!(va>0)){if(va/=ai,ai<0){if(va<Ka)return;va<Ei&&(Ei=va)}else if(ai>0){if(va>Ei)return;va>Ka&&(Ka=va)}if(va=Eo-Co,ai||!(va<0)){if(va/=ai,ai<0){if(va>Ei)return;va>Ka&&(Ka=va)}else if(ai>0){if(va<Ka)return;va<Ei&&(Ei=va)}return Ka>0&&(Qn[0]=xi+Ka*Zi,Qn[1]=Co+Ka*ai),Ei<1&&(Za[0]=xi+Ei*Zi,Za[1]=Co+Ei*ai),!0}}}}})(Aa,ti,ft,Rt,sr,Vt)?($n||(Jn.lineStart(),Jn.point(Aa[0],Aa[1])),Jn.point(ti[0],ti[1]),za||Jn.lineEnd(),jn=!1):za&&(Jn.lineStart(),Jn.point(Sa,da),jn=!1)}ta=Sa,Xr=da,$n=za}return Ca}}var tn,Qr,rn,An=m(),En={sphere:P,point:P,lineStart:function(){En.point=Jt,En.lineEnd=Bn},lineEnd:P,polygonStart:P,polygonEnd:P};function Bn(){En.point=En.lineEnd=P}function Jt(ft,Rt){tn=ft*=n,Qr=A(Rt*=n),rn=y(Rt),En.point=It}function It(ft,Rt){ft*=n;var sr=A(Rt*=n),Vt=y(Rt),lr=a(ft-tn),Lr=y(lr),zr=Vt*A(lr),Yr=rn*sr-Qr*Vt*Lr,ln=Qr*sr+rn*Vt*Lr;An.add(p(w(zr*zr+Yr*Yr),ln)),tn=ft,Qr=sr,rn=Vt}function qt(ft){return An.reset(),K(ft,En),+An}var fr=[null,null],Tr={type:"LineString",coordinates:fr};function Gr(ft,Rt){return fr[0]=ft,fr[1]=Rt,qt(Tr)}var Vr={Feature:function(ft,Rt){return wr(ft.geometry,Rt)},FeatureCollection:function(ft,Rt){for(var sr=ft.features,Vt=-1,lr=sr.length;++Vt<lr;)if(wr(sr[Vt].geometry,Rt))return!0;return!1}},xr={Sphere:function(){return!0},Point:function(ft,Rt){return Sr(ft.coordinates,Rt)},MultiPoint:function(ft,Rt){for(var sr=ft.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)if(Sr(sr[Vt],Rt))return!0;return!1},LineString:function(ft,Rt){return Mr(ft.coordinates,Rt)},MultiLineString:function(ft,Rt){for(var sr=ft.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)if(Mr(sr[Vt],Rt))return!0;return!1},Polygon:function(ft,Rt){return Ir(ft.coordinates,Rt)},MultiPolygon:function(ft,Rt){for(var sr=ft.coordinates,Vt=-1,lr=sr.length;++Vt<lr;)if(Ir(sr[Vt],Rt))return!0;return!1},GeometryCollection:function(ft,Rt){for(var sr=ft.geometries,Vt=-1,lr=sr.length;++Vt<lr;)if(wr(sr[Vt],Rt))return!0;return!1}};function wr(ft,Rt){return!(!ft||!xr.hasOwnProperty(ft.type))&&xr[ft.type](ft,Rt)}function Sr(ft,Rt){return Gr(ft,Rt)===0}function Mr(ft,Rt){for(var sr,Vt,lr,Lr=0,zr=ft.length;Lr<zr;Lr++){if((Vt=Gr(ft[Lr],Rt))===0||Lr>0&&(lr=Gr(ft[Lr],ft[Lr-1]))>0&&sr<=lr&&Vt<=lr&&(sr+Vt-lr)*(1-Math.pow((sr-Vt)/lr,2))<1e-12*lr)return!0;sr=Vt}return!1}function Ir(ft,Rt){return!!In(ft.map(qr),cn(Rt))}function qr(ft){return(ft=ft.map(cn)).pop(),ft}function cn(ft){return[ft[0]*n,ft[1]*n]}function _n(ft,Rt,sr){var Vt=d.range(ft,Rt-l,sr).concat(Rt);return function(lr){return Vt.map(function(Lr){return[lr,Lr]})}}function Jr(ft,Rt,sr){var Vt=d.range(ft,Rt-l,sr).concat(Rt);return function(lr){return Vt.map(function(Lr){return[Lr,lr]})}}function bn(){var ft,Rt,sr,Vt,lr,Lr,zr,Yr,ln,on,mn,wn,un=10,Tn=un,Rn=90,Vn=360,ta=2.5;function Xr(){return{type:"MultiLineString",coordinates:$n()}}function $n(){return d.range(v(Vt/Rn)*Rn,sr,Rn).map(mn).concat(d.range(v(Yr/Vn)*Vn,zr,Vn).map(wn)).concat(d.range(v(Rt/un)*un,ft,un).filter(function(Ln){return a(Ln%Rn)>l}).map(ln)).concat(d.range(v(Lr/Tn)*Tn,lr,Tn).filter(function(Ln){return a(Ln%Vn)>l}).map(on))}return Xr.lines=function(){return $n().map(function(Ln){return{type:"LineString",coordinates:Ln}})},Xr.outline=function(){return{type:"Polygon",coordinates:[mn(Vt).concat(wn(zr).slice(1),mn(sr).reverse().slice(1),wn(Yr).reverse().slice(1))]}},Xr.extent=function(Ln){return arguments.length?Xr.extentMajor(Ln).extentMinor(Ln):Xr.extentMinor()},Xr.extentMajor=function(Ln){return arguments.length?(Vt=+Ln[0][0],sr=+Ln[1][0],Yr=+Ln[0][1],zr=+Ln[1][1],Vt>sr&&(Ln=Vt,Vt=sr,sr=Ln),Yr>zr&&(Ln=Yr,Yr=zr,zr=Ln),Xr.precision(ta)):[[Vt,Yr],[sr,zr]]},Xr.extentMinor=function(Ln){return arguments.length?(Rt=+Ln[0][0],ft=+Ln[1][0],Lr=+Ln[0][1],lr=+Ln[1][1],Rt>ft&&(Ln=Rt,Rt=ft,ft=Ln),Lr>lr&&(Ln=Lr,Lr=lr,lr=Ln),Xr.precision(ta)):[[Rt,Lr],[ft,lr]]},Xr.step=function(Ln){return arguments.length?Xr.stepMajor(Ln).stepMinor(Ln):Xr.stepMinor()},Xr.stepMajor=function(Ln){return arguments.length?(Rn=+Ln[0],Vn=+Ln[1],Xr):[Rn,Vn]},Xr.stepMinor=function(Ln){return arguments.length?(un=+Ln[0],Tn=+Ln[1],Xr):[un,Tn]},Xr.precision=function(Ln){return arguments.length?(ta=+Ln,ln=_n(Lr,lr,90),on=Jr(Rt,ft,ta),mn=_n(Yr,zr,90),wn=Jr(Vt,sr,ta),Xr):ta},Xr.extentMajor([[-180,-90+l],[180,90-l]]).extentMinor([[-180,-80-l],[180,80+l]])}function Dr(ft){return ft}var Wr,vn,dn,Pn,sa=m(),Yn=m(),yn={point:P,lineStart:P,lineEnd:P,polygonStart:function(){yn.lineStart=ra,yn.lineEnd=Bi},polygonEnd:function(){yn.lineStart=yn.lineEnd=yn.point=P,sa.add(a(Yn)),Yn.reset()},result:function(){var ft=sa/2;return sa.reset(),ft}};function ra(){yn.point=pa}function pa(ft,Rt){yn.point=Qa,Wr=dn=ft,vn=Pn=Rt}function Qa(ft,Rt){Yn.add(Pn*ft-dn*Rt),dn=ft,Pn=Rt}function Bi(){Qa(Wr,vn)}var li=1/0,Ai=li,Ea=-li,Ga=Ea,ko={point:function(ft,Rt){ft<li&&(li=ft),ft>Ea&&(Ea=ft),Rt<Ai&&(Ai=Rt),Rt>Ga&&(Ga=Rt)},lineStart:P,lineEnd:P,polygonStart:P,polygonEnd:P,result:function(){var ft=[[li,Ai],[Ea,Ga]];return Ea=Ga=-(Ai=li=1/0),ft}},Qo,us,$i,to,es=0,Wa=0,jo=0,Ao=0,Mi=0,ro=0,Mo=0,zo=0,Vi=0,yi={point:Qi,lineStart:Vs,lineEnd:Os,polygonStart:function(){yi.lineStart=ms,yi.lineEnd=Zs},polygonEnd:function(){yi.point=Qi,yi.lineStart=Vs,yi.lineEnd=Os},result:function(){var ft=Vi?[Mo/Vi,zo/Vi]:ro?[Ao/ro,Mi/ro]:jo?[es/jo,Wa/jo]:[NaN,NaN];return es=Wa=jo=Ao=Mi=ro=Mo=zo=Vi=0,ft}};function Qi(ft,Rt){es+=ft,Wa+=Rt,++jo}function Vs(){yi.point=Xs}function Xs(ft,Rt){yi.point=Xa,Qi($i=ft,to=Rt)}function Xa(ft,Rt){var sr=ft-$i,Vt=Rt-to,lr=w(sr*sr+Vt*Vt);Ao+=lr*($i+ft)/2,Mi+=lr*(to+Rt)/2,ro+=lr,Qi($i=ft,to=Rt)}function Os(){yi.point=Qi}function ms(){yi.point=Ks}function Zs(){Hs(Qo,us)}function Ks(ft,Rt){yi.point=Hs,Qi(Qo=$i=ft,us=to=Rt)}function Hs(ft,Rt){var sr=ft-$i,Vt=Rt-to,lr=w(sr*sr+Vt*Vt);Ao+=lr*($i+ft)/2,Mi+=lr*(to+Rt)/2,ro+=lr,Mo+=(lr=to*ft-$i*Rt)*($i+ft),zo+=lr*(to+Rt),Vi+=3*lr,Qi($i=ft,to=Rt)}function Js(ft){this._context=ft}Js.prototype={_radius:4.5,pointRadius:function(ft){return this._radius=ft,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(ft,Rt){switch(this._point){case 0:this._context.moveTo(ft,Rt),this._point=1;break;case 1:this._context.lineTo(ft,Rt);break;default:this._context.moveTo(ft+this._radius,Rt),this._context.arc(ft,Rt,this._radius,0,i)}},result:P};var Uo,Vo,ts,rs,ns,vs=m(),So={point:P,lineStart:function(){So.point=Ds},lineEnd:function(){Uo&&vo(Vo,ts),So.point=P},polygonStart:function(){Uo=!0},polygonEnd:function(){Uo=null},result:function(){var ft=+vs;return vs.reset(),ft}};function Ds(ft,Rt){So.point=vo,Vo=rs=ft,ts=ns=Rt}function vo(ft,Rt){rs-=ft,ns-=Rt,vs.add(w(rs*rs+ns*ns)),rs=ft,ns=Rt}function as(){this._string=[]}function zs(ft){return"m0,"+ft+"a"+ft+","+ft+" 0 1,1 0,"+-2*ft+"a"+ft+","+ft+" 0 1,1 0,"+2*ft+"z"}function Ho(ft){return function(Rt){var sr=new qa;for(var Vt in ft)sr[Vt]=ft[Vt];return sr.stream=Rt,sr}}function qa(){}function Re(ft,Rt,sr){var Vt=ft.clipExtent&&ft.clipExtent();return ft.scale(150).translate([0,0]),Vt!=null&&ft.clipExtent(null),K(sr,ft.stream(ko)),Rt(ko.result()),Vt!=null&&ft.clipExtent(Vt),ft}function Ve(ft,Rt,sr){return Re(ft,function(Vt){var lr=Rt[1][0]-Rt[0][0],Lr=Rt[1][1]-Rt[0][1],zr=Math.min(lr/(Vt[1][0]-Vt[0][0]),Lr/(Vt[1][1]-Vt[0][1])),Yr=+Rt[0][0]+(lr-zr*(Vt[1][0]+Vt[0][0]))/2,ln=+Rt[0][1]+(Lr-zr*(Vt[1][1]+Vt[0][1]))/2;ft.scale(150*zr).translate([Yr,ln])},sr)}function $e(ft,Rt,sr){return Ve(ft,[[0,0],Rt],sr)}function ot(ft,Rt,sr){return Re(ft,function(Vt){var lr=+Rt,Lr=lr/(Vt[1][0]-Vt[0][0]),zr=(lr-Lr*(Vt[1][0]+Vt[0][0]))/2,Yr=-Lr*Vt[0][1];ft.scale(150*Lr).translate([zr,Yr])},sr)}function mt(ft,Rt,sr){return Re(ft,function(Vt){var lr=+Rt,Lr=lr/(Vt[1][1]-Vt[0][1]),zr=-Lr*Vt[0][0],Yr=(lr-Lr*(Vt[1][1]+Vt[0][1]))/2;ft.scale(150*Lr).translate([zr,Yr])},sr)}as.prototype={_radius:4.5,_circle:zs(4.5),pointRadius:function(ft){return(ft=+ft)!==this._radius&&(this._radius=ft,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(ft,Rt){switch(this._point){case 0:this._string.push("M",ft,",",Rt),this._point=1;break;case 1:this._string.push("L",ft,",",Rt);break;default:this._circle==null&&(this._circle=zs(this._radius)),this._string.push("M",ft,",",Rt,this._circle)}},result:function(){if(this._string.length){var ft=this._string.join("");return this._string=[],ft}return null}},qa.prototype={constructor:qa,point:function(ft,Rt){this.stream.point(ft,Rt)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var dt=y(30*n);function Et(ft,Rt){return+Rt?function(sr,Vt){function lr(Lr,zr,Yr,ln,on,mn,wn,un,Tn,Rn,Vn,ta,Xr,$n){var Ln=wn-Lr,jn=un-zr,Jn=Ln*Ln+jn*jn;if(Jn>4*Vt&&Xr--){var Ta=ln+Rn,Ca=on+Vn,Mn=mn+ta,Da=w(Ta*Ta+Ca*Ca+Mn*Mn),Sa=L(Mn/=Da),da=a(a(Mn)-1)<l||a(Yr-Tn)<l?(Yr+Tn)/2:p(Ca,Ta),za=sr(da,Sa),Aa=za[0],ti=za[1],Qn=Aa-Lr,Za=ti-zr,Gi=jn*Qn-Ln*Za;(Gi*Gi/Jn>Vt||a((Ln*Qn+jn*Za)/Jn-.5)>.3||ln*Rn+on*Vn+mn*ta<dt)&&(lr(Lr,zr,Yr,ln,on,mn,Aa,ti,da,Ta/=Da,Ca/=Da,Mn,Xr,$n),$n.point(Aa,ti),lr(Aa,ti,da,Ta,Ca,Mn,wn,un,Tn,Rn,Vn,ta,Xr,$n))}}return function(Lr){var zr,Yr,ln,on,mn,wn,un,Tn,Rn,Vn,ta,Xr,$n={point:Ln,lineStart:jn,lineEnd:Ta,polygonStart:function(){Lr.polygonStart(),$n.lineStart=Ca},polygonEnd:function(){Lr.polygonEnd(),$n.lineStart=jn}};function Ln(Sa,da){Sa=sr(Sa,da),Lr.point(Sa[0],Sa[1])}function jn(){Tn=NaN,$n.point=Jn,Lr.lineStart()}function Jn(Sa,da){var za=he([Sa,da]),Aa=sr(Sa,da);lr(Tn,Rn,un,Vn,ta,Xr,Tn=Aa[0],Rn=Aa[1],un=Sa,Vn=za[0],ta=za[1],Xr=za[2],16,Lr),Lr.point(Tn,Rn)}function Ta(){$n.point=Ln,Lr.lineEnd()}function Ca(){jn(),$n.point=Mn,$n.lineEnd=Da}function Mn(Sa,da){Jn(zr=Sa,da),Yr=Tn,ln=Rn,on=Vn,mn=ta,wn=Xr,$n.point=Jn}function Da(){lr(Tn,Rn,un,Vn,ta,Xr,Yr,ln,zr,on,mn,wn,16,Lr),$n.lineEnd=Ta,Ta()}return $n}}(ft,Rt):function(sr){return Ho({point:function(Vt,lr){Vt=sr(Vt,lr),this.stream.point(Vt[0],Vt[1])}})}(ft)}var Zt=Ho({point:function(ft,Rt){this.stream.point(ft*n,Rt*n)}});function $t(ft,Rt,sr,Vt,lr){function Lr(zr,Yr){return[Rt+ft*(zr*=Vt),sr-ft*(Yr*=lr)]}return Lr.invert=function(zr,Yr){return[(zr-Rt)/ft*Vt,(sr-Yr)/ft*lr]},Lr}function Yt(ft,Rt,sr,Vt,lr,Lr){var zr=y(Lr),Yr=A(Lr),ln=zr*ft,on=Yr*ft,mn=zr/ft,wn=Yr/ft,un=(Yr*sr-zr*Rt)/ft,Tn=(Yr*Rt+zr*sr)/ft;function Rn(Vn,ta){return[ln*(Vn*=Vt)-on*(ta*=lr)+Rt,sr-on*Vn-ln*ta]}return Rn.invert=function(Vn,ta){return[Vt*(mn*Vn-wn*ta+un),lr*(Tn-wn*Vn-mn*ta)]},Rn}function nr(ft){return cr(function(){return ft})()}function cr(ft){var Rt,sr,Vt,lr,Lr,zr,Yr,ln,on,mn,wn=150,un=480,Tn=250,Rn=0,Vn=0,ta=0,Xr=0,$n=0,Ln=0,jn=1,Jn=1,Ta=null,Ca=Nr,Mn=null,Da=Dr,Sa=.5;function da(Qn){return ln(Qn[0]*n,Qn[1]*n)}function za(Qn){return(Qn=ln.invert(Qn[0],Qn[1]))&&[Qn[0]*c,Qn[1]*c]}function Aa(){var Qn=Yt(wn,0,0,jn,Jn,Ln).apply(null,Rt(Rn,Vn)),Za=(Ln?Yt:$t)(wn,un-Qn[0],Tn-Qn[1],jn,Jn,Ln);return sr=ir(ta,Xr,$n),Yr=Ot(Rt,Za),ln=Ot(sr,Yr),zr=Et(Yr,Sa),ti()}function ti(){return on=mn=null,da}return da.stream=function(Qn){return on&&mn===Qn?on:on=Zt(function(Za){return Ho({point:function(Gi,cs){var Xo=Za(Gi,cs);return this.stream.point(Xo[0],Xo[1])}})}(sr)(Ca(zr(Da(mn=Qn)))))},da.preclip=function(Qn){return arguments.length?(Ca=Qn,Ta=void 0,ti()):Ca},da.postclip=function(Qn){return arguments.length?(Da=Qn,Mn=Vt=lr=Lr=null,ti()):Da},da.clipAngle=function(Qn){return arguments.length?(Ca=+Qn?Pr(Ta=Qn*n):(Ta=null,Nr),ti()):Ta*c},da.clipExtent=function(Qn){return arguments.length?(Da=Qn==null?(Mn=Vt=lr=Lr=null,Dr):en(Mn=+Qn[0][0],Vt=+Qn[0][1],lr=+Qn[1][0],Lr=+Qn[1][1]),ti()):Mn==null?null:[[Mn,Vt],[lr,Lr]]},da.scale=function(Qn){return arguments.length?(wn=+Qn,Aa()):wn},da.translate=function(Qn){return arguments.length?(un=+Qn[0],Tn=+Qn[1],Aa()):[un,Tn]},da.center=function(Qn){return arguments.length?(Rn=Qn[0]%360*n,Vn=Qn[1]%360*n,Aa()):[Rn*c,Vn*c]},da.rotate=function(Qn){return arguments.length?(ta=Qn[0]%360*n,Xr=Qn[1]%360*n,$n=Qn.length>2?Qn[2]%360*n:0,Aa()):[ta*c,Xr*c,$n*c]},da.angle=function(Qn){return arguments.length?(Ln=Qn%360*n,Aa()):Ln*c},da.reflectX=function(Qn){return arguments.length?(jn=Qn?-1:1,Aa()):jn<0},da.reflectY=function(Qn){return arguments.length?(Jn=Qn?-1:1,Aa()):Jn<0},da.precision=function(Qn){return arguments.length?(zr=Et(Yr,Sa=Qn*Qn),ti()):w(Sa)},da.fitExtent=function(Qn,Za){return Ve(da,Qn,Za)},da.fitSize=function(Qn,Za){return $e(da,Qn,Za)},da.fitWidth=function(Qn,Za){return ot(da,Qn,Za)},da.fitHeight=function(Qn,Za){return mt(da,Qn,Za)},function(){return Rt=ft.apply(this,arguments),da.invert=Rt.invert&&za,Aa()}}function mr(ft){var Rt=0,sr=o/3,Vt=cr(ft),lr=Vt(Rt,sr);return lr.parallels=function(Lr){return arguments.length?Vt(Rt=Lr[0]*n,sr=Lr[1]*n):[Rt*c,sr*c]},lr}function yr(ft,Rt){var sr=A(ft),Vt=(sr+A(Rt))/2;if(a(Vt)<l)return function(Yr){var ln=y(Yr);function on(mn,wn){return[mn*ln,A(wn)/ln]}return on.invert=function(mn,wn){return[mn/ln,L(wn*ln)]},on}(ft);var lr=1+sr*(2*Vt-sr),Lr=w(lr)/Vt;function zr(Yr,ln){var on=w(lr-2*Vt*A(ln))/Vt;return[on*A(Yr*=Vt),Lr-on*y(Yr)]}return zr.invert=function(Yr,ln){var on=Lr-ln,mn=p(Yr,a(on))*S(on);return on*Vt<0&&(mn-=o*S(Yr)*S(on)),[mn/Vt,L((lr-(Yr*Yr+on*on)*Vt*Vt)/(2*Vt))]},zr}function Or(){return mr(yr).scale(155.424).center([0,33.6442])}function nn(){return Or().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function gn(ft){return function(Rt,sr){var Vt=y(Rt),lr=y(sr),Lr=ft(Vt*lr);return[Lr*lr*A(Rt),Lr*A(sr)]}}function Cn(ft){return function(Rt,sr){var Vt=w(Rt*Rt+sr*sr),lr=ft(Vt),Lr=A(lr),zr=y(lr);return[p(Rt*Lr,Vt*zr),L(Vt&&sr*Lr/Vt)]}}var Dn=gn(function(ft){return w(2/(1+ft))});Dn.invert=Cn(function(ft){return 2*L(ft/2)});var Hn=gn(function(ft){return(ft=k(ft))&&ft/A(ft)});function zn(ft,Rt){return[ft,x(E((u+Rt)/2))]}function ga(ft){var Rt,sr,Vt,lr=nr(ft),Lr=lr.center,zr=lr.scale,Yr=lr.translate,ln=lr.clipExtent,on=null;function mn(){var wn=o*zr(),un=lr(dr(lr.rotate()).invert([0,0]));return ln(on==null?[[un[0]-wn,un[1]-wn],[un[0]+wn,un[1]+wn]]:ft===zn?[[Math.max(un[0]-wn,on),Rt],[Math.min(un[0]+wn,sr),Vt]]:[[on,Math.max(un[1]-wn,Rt)],[sr,Math.min(un[1]+wn,Vt)]])}return lr.scale=function(wn){return arguments.length?(zr(wn),mn()):zr()},lr.translate=function(wn){return arguments.length?(Yr(wn),mn()):Yr()},lr.center=function(wn){return arguments.length?(Lr(wn),mn()):Lr()},lr.clipExtent=function(wn){return arguments.length?(wn==null?on=Rt=sr=Vt=null:(on=+wn[0][0],Rt=+wn[0][1],sr=+wn[1][0],Vt=+wn[1][1]),mn()):on==null?null:[[on,Rt],[sr,Vt]]},mn()}function ka(ft){return E((u+ft)/2)}function Ba(ft,Rt){var sr=y(ft),Vt=ft===Rt?A(ft):x(sr/y(Rt))/x(ka(Rt)/ka(ft)),lr=sr*T(ka(ft),Vt)/Vt;if(!Vt)return zn;function Lr(zr,Yr){lr>0?Yr<-u+l&&(Yr=-u+l):Yr>u-l&&(Yr=u-l);var ln=lr/T(ka(Yr),Vt);return[ln*A(Vt*zr),lr-ln*y(Vt*zr)]}return Lr.invert=function(zr,Yr){var ln=lr-Yr,on=S(Vt)*w(zr*zr+ln*ln),mn=p(zr,a(ln))*S(ln);return ln*Vt<0&&(mn-=o*S(zr)*S(ln)),[mn/Vt,2*g(T(lr/on,1/Vt))-u]},Lr}function Fa(ft,Rt){return[ft,Rt]}function ja(ft,Rt){var sr=y(ft),Vt=ft===Rt?A(ft):(sr-y(Rt))/(Rt-ft),lr=sr/Vt+ft;if(a(Vt)<l)return Fa;function Lr(zr,Yr){var ln=lr-Yr,on=Vt*zr;return[ln*A(on),lr-ln*y(on)]}return Lr.invert=function(zr,Yr){var ln=lr-Yr,on=p(zr,a(ln))*S(ln);return ln*Vt<0&&(on-=o*S(zr)*S(ln)),[on/Vt,lr-S(Vt)*w(zr*zr+ln*ln)]},Lr}Hn.invert=Cn(function(ft){return ft}),zn.invert=function(ft,Rt){return[ft,2*g(b(Rt))-u]},Fa.invert=Fa;var Si=1.340264,Ti=-.081106,ui=893e-6,ci=.003796,ki=w(3)/2;function Hi(ft,Rt){var sr=L(ki*A(Rt)),Vt=sr*sr,lr=Vt*Vt*Vt;return[ft*y(sr)/(ki*(Si+3*Ti*Vt+lr*(7*ui+9*ci*Vt))),sr*(Si+Ti*Vt+lr*(ui+ci*Vt))]}function no(ft,Rt){var sr=y(Rt),Vt=y(ft)*sr;return[sr*A(ft)/Vt,A(Rt)/Vt]}function ao(ft,Rt){var sr=Rt*Rt,Vt=sr*sr;return[ft*(.8707-.131979*sr+Vt*(Vt*(.003971*sr-.001529*Vt)-.013791)),Rt*(1.007226+sr*(.015085+Vt*(.028874*sr-.044475-.005916*Vt)))]}function io(ft,Rt){return[y(Rt)*A(ft),A(Rt)]}function oo(ft,Rt){var sr=y(Rt),Vt=1+y(ft)*sr;return[sr*A(ft)/Vt,A(Rt)/Vt]}function Oa(ft,Rt){return[x(E((u+Rt)/2)),-ft]}Hi.invert=function(ft,Rt){for(var sr,Vt=Rt,lr=Vt*Vt,Lr=lr*lr*lr,zr=0;zr<12&&(Lr=(lr=(Vt-=sr=(Vt*(Si+Ti*lr+Lr*(ui+ci*lr))-Rt)/(Si+3*Ti*lr+Lr*(7*ui+9*ci*lr)))*Vt)*lr*lr,!(a(sr)<1e-12));++zr);return[ki*ft*(Si+3*Ti*lr+Lr*(7*ui+9*ci*lr))/y(Vt),L(A(Vt)/ki)]},no.invert=Cn(g),ao.invert=function(ft,Rt){var sr,Vt=Rt,lr=25;do{var Lr=Vt*Vt,zr=Lr*Lr;Vt-=sr=(Vt*(1.007226+Lr*(.015085+zr*(.028874*Lr-.044475-.005916*zr)))-Rt)/(1.007226+Lr*(.045255+zr*(.259866*Lr-.311325-.005916*11*zr)))}while(a(sr)>l&&--lr>0);return[ft/(.8707+(Lr=Vt*Vt)*(Lr*(Lr*Lr*Lr*(.003971-.001529*Lr)-.013791)-.131979)),Vt]},io.invert=Cn(L),oo.invert=Cn(function(ft){return 2*g(ft)}),Oa.invert=function(ft,Rt){return[-Rt,2*g(b(ft))-u]},t.geoAlbers=nn,t.geoAlbersUsa=function(){var ft,Rt,sr,Vt,lr,Lr,zr=nn(),Yr=Or().rotate([154,0]).center([-2,58.5]).parallels([55,65]),ln=Or().rotate([157,0]).center([-3,19.9]).parallels([8,18]),on={point:function(un,Tn){Lr=[un,Tn]}};function mn(un){var Tn=un[0],Rn=un[1];return Lr=null,sr.point(Tn,Rn),Lr||(Vt.point(Tn,Rn),Lr)||(lr.point(Tn,Rn),Lr)}function wn(){return ft=Rt=null,mn}return mn.invert=function(un){var Tn=zr.scale(),Rn=zr.translate(),Vn=(un[0]-Rn[0])/Tn,ta=(un[1]-Rn[1])/Tn;return(ta>=.12&&ta<.234&&Vn>=-.425&&Vn<-.214?Yr:ta>=.166&&ta<.234&&Vn>=-.214&&Vn<-.115?ln:zr).invert(un)},mn.stream=function(un){return ft&&Rt===un?ft:(Tn=[zr.stream(Rt=un),Yr.stream(un),ln.stream(un)],Rn=Tn.length,ft={point:function(Vn,ta){for(var Xr=-1;++Xr<Rn;)Tn[Xr].point(Vn,ta)},sphere:function(){for(var Vn=-1;++Vn<Rn;)Tn[Vn].sphere()},lineStart:function(){for(var Vn=-1;++Vn<Rn;)Tn[Vn].lineStart()},lineEnd:function(){for(var Vn=-1;++Vn<Rn;)Tn[Vn].lineEnd()},polygonStart:function(){for(var Vn=-1;++Vn<Rn;)Tn[Vn].polygonStart()},polygonEnd:function(){for(var Vn=-1;++Vn<Rn;)Tn[Vn].polygonEnd()}});var Tn,Rn},mn.precision=function(un){return arguments.length?(zr.precision(un),Yr.precision(un),ln.precision(un),wn()):zr.precision()},mn.scale=function(un){return arguments.length?(zr.scale(un),Yr.scale(.35*un),ln.scale(un),mn.translate(zr.translate())):zr.scale()},mn.translate=function(un){if(!arguments.length)return zr.translate();var Tn=zr.scale(),Rn=+un[0],Vn=+un[1];return sr=zr.translate(un).clipExtent([[Rn-.455*Tn,Vn-.238*Tn],[Rn+.455*Tn,Vn+.238*Tn]]).stream(on),Vt=Yr.translate([Rn-.307*Tn,Vn+.201*Tn]).clipExtent([[Rn-.425*Tn+l,Vn+.12*Tn+l],[Rn-.214*Tn-l,Vn+.234*Tn-l]]).stream(on),lr=ln.translate([Rn-.205*Tn,Vn+.212*Tn]).clipExtent([[Rn-.214*Tn+l,Vn+.166*Tn+l],[Rn-.115*Tn-l,Vn+.234*Tn-l]]).stream(on),wn()},mn.fitExtent=function(un,Tn){return Ve(mn,un,Tn)},mn.fitSize=function(un,Tn){return $e(mn,un,Tn)},mn.fitWidth=function(un,Tn){return ot(mn,un,Tn)},mn.fitHeight=function(un,Tn){return mt(mn,un,Tn)},mn.scale(1070)},t.geoArea=function(ft){return W.reset(),K(ft,ee),2*W},t.geoAzimuthalEqualArea=function(){return nr(Dn).scale(124.75).clipAngle(179.999)},t.geoAzimuthalEqualAreaRaw=Dn,t.geoAzimuthalEquidistant=function(){return nr(Hn).scale(79.4188).clipAngle(179.999)},t.geoAzimuthalEquidistantRaw=Hn,t.geoBounds=function(ft){var Rt,sr,Vt,lr,Lr,zr,Yr;if(ce=xe=-(Ee=be=1/0),ze=[],K(ft,He),sr=ze.length){for(ze.sort(Mt),Rt=1,Lr=[Vt=ze[0]];Rt<sr;++Rt)pt(Vt,(lr=ze[Rt])[0])||pt(Vt,lr[1])?(ht(Vt[0],lr[1])>ht(Vt[0],Vt[1])&&(Vt[1]=lr[1]),ht(lr[0],Vt[1])>ht(Vt[0],Vt[1])&&(Vt[0]=lr[0])):Lr.push(Vt=lr);for(zr=-1/0,Rt=0,Vt=Lr[sr=Lr.length-1];Rt<=sr;Vt=lr,++Rt)lr=Lr[Rt],(Yr=ht(Vt[1],lr[0]))>zr&&(zr=Yr,Ee=lr[0],xe=Vt[1])}return ze=Fe=null,Ee===1/0||be===1/0?[[NaN,NaN],[NaN,NaN]]:[[Ee,be],[xe,ce]]},t.geoCentroid=function(ft){Ye=rt=Oe=je=We=qe=et=st=ct=Pt=kt=0,K(ft,Lt);var Rt=ct,sr=Pt,Vt=kt,lr=Rt*Rt+sr*sr+Vt*Vt;return lr<1e-12&&(Rt=qe,sr=et,Vt=st,rt<l&&(Rt=Oe,sr=je,Vt=We),(lr=Rt*Rt+sr*sr+Vt*Vt)<1e-12)?[NaN,NaN]:[p(sr,Rt)*c,L(Vt/w(lr))*c]},t.geoCircle=function(){var ft,Rt,sr=wt([0,0]),Vt=wt(90),lr=wt(6),Lr={point:function(Yr,ln){ft.push(Yr=Rt(Yr,ln)),Yr[0]*=c,Yr[1]*=c}};function zr(){var Yr=sr.apply(this,arguments),ln=Vt.apply(this,arguments)*n,on=lr.apply(this,arguments)*n;return ft=[],Rt=ir(-Yr[0]*n,-Yr[1]*n,0).invert,vr(Lr,ln,on,1),Yr={type:"Polygon",coordinates:[ft]},ft=Rt=null,Yr}return zr.center=function(Yr){return arguments.length?(sr=typeof Yr=="function"?Yr:wt([+Yr[0],+Yr[1]]),zr):sr},zr.radius=function(Yr){return arguments.length?(Vt=typeof Yr=="function"?Yr:wt(+Yr),zr):Vt},zr.precision=function(Yr){return arguments.length?(lr=typeof Yr=="function"?Yr:wt(+Yr),zr):lr},zr},t.geoClipAntimeridian=Nr,t.geoClipCircle=Pr,t.geoClipExtent=function(){var ft,Rt,sr,Vt=0,lr=0,Lr=960,zr=500;return sr={stream:function(Yr){return ft&&Rt===Yr?ft:ft=en(Vt,lr,Lr,zr)(Rt=Yr)},extent:function(Yr){return arguments.length?(Vt=+Yr[0][0],lr=+Yr[0][1],Lr=+Yr[1][0],zr=+Yr[1][1],ft=Rt=null,sr):[[Vt,lr],[Lr,zr]]}}},t.geoClipRectangle=en,t.geoConicConformal=function(){return mr(Ba).scale(109.5).parallels([30,30])},t.geoConicConformalRaw=Ba,t.geoConicEqualArea=Or,t.geoConicEqualAreaRaw=yr,t.geoConicEquidistant=function(){return mr(ja).scale(131.154).center([0,13.9389])},t.geoConicEquidistantRaw=ja,t.geoContains=function(ft,Rt){return(ft&&Vr.hasOwnProperty(ft.type)?Vr[ft.type]:wr)(ft,Rt)},t.geoDistance=Gr,t.geoEqualEarth=function(){return nr(Hi).scale(177.158)},t.geoEqualEarthRaw=Hi,t.geoEquirectangular=function(){return nr(Fa).scale(152.63)},t.geoEquirectangularRaw=Fa,t.geoGnomonic=function(){return nr(no).scale(144.049).clipAngle(60)},t.geoGnomonicRaw=no,t.geoGraticule=bn,t.geoGraticule10=function(){return bn()()},t.geoIdentity=function(){var ft,Rt,sr,Vt,lr,Lr,zr,Yr=1,ln=0,on=0,mn=1,wn=1,un=0,Tn=null,Rn=1,Vn=1,ta=Ho({point:function(jn,Jn){var Ta=Ln([jn,Jn]);this.stream.point(Ta[0],Ta[1])}}),Xr=Dr;function $n(){return Rn=Yr*mn,Vn=Yr*wn,Lr=zr=null,Ln}function Ln(jn){var Jn=jn[0]*Rn,Ta=jn[1]*Vn;if(un){var Ca=Ta*ft-Jn*Rt;Jn=Jn*ft+Ta*Rt,Ta=Ca}return[Jn+ln,Ta+on]}return Ln.invert=function(jn){var Jn=jn[0]-ln,Ta=jn[1]-on;if(un){var Ca=Ta*ft+Jn*Rt;Jn=Jn*ft-Ta*Rt,Ta=Ca}return[Jn/Rn,Ta/Vn]},Ln.stream=function(jn){return Lr&&zr===jn?Lr:Lr=ta(Xr(zr=jn))},Ln.postclip=function(jn){return arguments.length?(Xr=jn,Tn=sr=Vt=lr=null,$n()):Xr},Ln.clipExtent=function(jn){return arguments.length?(Xr=jn==null?(Tn=sr=Vt=lr=null,Dr):en(Tn=+jn[0][0],sr=+jn[0][1],Vt=+jn[1][0],lr=+jn[1][1]),$n()):Tn==null?null:[[Tn,sr],[Vt,lr]]},Ln.scale=function(jn){return arguments.length?(Yr=+jn,$n()):Yr},Ln.translate=function(jn){return arguments.length?(ln=+jn[0],on=+jn[1],$n()):[ln,on]},Ln.angle=function(jn){return arguments.length?(Rt=A(un=jn%360*n),ft=y(un),$n()):un*c},Ln.reflectX=function(jn){return arguments.length?(mn=jn?-1:1,$n()):mn<0},Ln.reflectY=function(jn){return arguments.length?(wn=jn?-1:1,$n()):wn<0},Ln.fitExtent=function(jn,Jn){return Ve(Ln,jn,Jn)},Ln.fitSize=function(jn,Jn){return $e(Ln,jn,Jn)},Ln.fitWidth=function(jn,Jn){return ot(Ln,jn,Jn)},Ln.fitHeight=function(jn,Jn){return mt(Ln,jn,Jn)},Ln},t.geoInterpolate=function(ft,Rt){var sr=ft[0]*n,Vt=ft[1]*n,lr=Rt[0]*n,Lr=Rt[1]*n,zr=y(Vt),Yr=A(Vt),ln=y(Lr),on=A(Lr),mn=zr*y(sr),wn=zr*A(sr),un=ln*y(lr),Tn=ln*A(lr),Rn=2*L(w(M(Lr-Vt)+zr*ln*M(lr-sr))),Vn=A(Rn),ta=Rn?function(Xr){var $n=A(Xr*=Rn)/Vn,Ln=A(Rn-Xr)/Vn,jn=Ln*mn+$n*un,Jn=Ln*wn+$n*Tn,Ta=Ln*Yr+$n*on;return[p(Jn,jn)*c,p(Ta,w(jn*jn+Jn*Jn))*c]}:function(){return[sr*c,Vt*c]};return ta.distance=Rn,ta},t.geoLength=qt,t.geoMercator=function(){return ga(zn).scale(961/i)},t.geoMercatorRaw=zn,t.geoNaturalEarth1=function(){return nr(ao).scale(175.295)},t.geoNaturalEarth1Raw=ao,t.geoOrthographic=function(){return nr(io).scale(249.5).clipAngle(90+l)},t.geoOrthographicRaw=io,t.geoPath=function(ft,Rt){var sr,Vt,lr=4.5;function Lr(zr){return zr&&(typeof lr=="function"&&Vt.pointRadius(+lr.apply(this,arguments)),K(zr,sr(Vt))),Vt.result()}return Lr.area=function(zr){return K(zr,sr(yn)),yn.result()},Lr.measure=function(zr){return K(zr,sr(So)),So.result()},Lr.bounds=function(zr){return K(zr,sr(ko)),ko.result()},Lr.centroid=function(zr){return K(zr,sr(yi)),yi.result()},Lr.projection=function(zr){return arguments.length?(sr=zr==null?(ft=null,Dr):(ft=zr).stream,Lr):ft},Lr.context=function(zr){return arguments.length?(Vt=zr==null?(Rt=null,new as):new Js(Rt=zr),typeof lr!="function"&&Vt.pointRadius(lr),Lr):Rt},Lr.pointRadius=function(zr){return arguments.length?(lr=typeof zr=="function"?zr:(Vt.pointRadius(+zr),+zr),Lr):lr},Lr.projection(ft).context(Rt)},t.geoProjection=nr,t.geoProjectionMutator=cr,t.geoRotation=dr,t.geoStereographic=function(){return nr(oo).scale(250).clipAngle(142)},t.geoStereographicRaw=oo,t.geoStream=K,t.geoTransform=function(ft){return{stream:Ho(ft)}},t.geoTransverseMercator=function(){var ft=ga(Oa),Rt=ft.center,sr=ft.rotate;return ft.center=function(Vt){return arguments.length?Rt([-Vt[1],Vt[0]]):[(Vt=Rt())[1],-Vt[0]]},ft.rotate=function(Vt){return arguments.length?sr([Vt[0],Vt[1],Vt.length>2?Vt[2]+90:90]):[(Vt=sr())[0],Vt[1],Vt[2]-90]},sr([0,0,90]).scale(159.155)},t.geoTransverseMercatorRaw=Oa,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":159}],167:[function(r,I,B){(function(t,d){d(typeof B=="object"&&I!==void 0?B:(t=t||self).d3=t.d3||{})})(this,function(t){function d(se,de){return se.parent===de.parent?1:2}function m(se,de){return se+de.x}function h(se,de){return Math.max(se,de.y)}function e(se){var de=0,ue=se.children,ve=ue&&ue.length;if(ve)for(;--ve>=0;)de+=ue[ve].value;else de=1;se.value=de}function f(se,de){var ue,ve,ke,Ee,be,xe=new s(se),ce=+se.value&&(xe.value=se.value),ge=[xe];for(de==null&&(de=l);ue=ge.pop();)if(ce&&(ue.value=+ue.data.value),(ke=de(ue.data))&&(be=ke.length))for(ue.children=new Array(be),Ee=be-1;Ee>=0;--Ee)ge.push(ve=ue.children[Ee]=new s(ke[Ee])),ve.parent=ue,ve.depth=ue.depth+1;return xe.eachBefore(u)}function l(se){return se.children}function o(se){se.data=se.data.data}function u(se){var de=0;do se.height=de;while((se=se.parent)&&se.height<++de)}function s(se){this.data=se,this.depth=this.height=0,this.parent=null}s.prototype=f.prototype={constructor:s,count:function(){return this.eachAfter(e)},each:function(se){var de,ue,ve,ke,Ee=this,be=[Ee];do for(de=be.reverse(),be=[];Ee=de.pop();)if(se(Ee),ue=Ee.children)for(ve=0,ke=ue.length;ve<ke;++ve)be.push(ue[ve]);while(be.length);return this},eachAfter:function(se){for(var de,ue,ve,ke=this,Ee=[ke],be=[];ke=Ee.pop();)if(be.push(ke),de=ke.children)for(ue=0,ve=de.length;ue<ve;++ue)Ee.push(de[ue]);for(;ke=be.pop();)se(ke);return this},eachBefore:function(se){for(var de,ue,ve=this,ke=[ve];ve=ke.pop();)if(se(ve),de=ve.children)for(ue=de.length-1;ue>=0;--ue)ke.push(de[ue]);return this},sum:function(se){return this.eachAfter(function(de){for(var ue=+se(de.data)||0,ve=de.children,ke=ve&&ve.length;--ke>=0;)ue+=ve[ke].value;de.value=ue})},sort:function(se){return this.eachBefore(function(de){de.children&&de.children.sort(se)})},path:function(se){for(var de=this,ue=function(Ee,be){if(Ee===be)return Ee;var xe=Ee.ancestors(),ce=be.ancestors(),ge=null;for(Ee=xe.pop(),be=ce.pop();Ee===be;)ge=Ee,Ee=xe.pop(),be=ce.pop();return ge}(de,se),ve=[de];de!==ue;)de=de.parent,ve.push(de);for(var ke=ve.length;se!==ue;)ve.splice(ke,0,se),se=se.parent;return ve},ancestors:function(){for(var se=this,de=[se];se=se.parent;)de.push(se);return de},descendants:function(){var se=[];return this.each(function(de){se.push(de)}),se},leaves:function(){var se=[];return this.eachBefore(function(de){de.children||se.push(de)}),se},links:function(){var se=this,de=[];return se.each(function(ue){ue!==se&&de.push({source:ue.parent,target:ue})}),de},copy:function(){return f(this).eachBefore(o)}};var i=Array.prototype.slice;function c(se){for(var de,ue,ve=0,ke=(se=function(be){for(var xe,ce,ge=be.length;ge;)ce=Math.random()*ge--|0,xe=be[ge],be[ge]=be[ce],be[ce]=xe;return be}(i.call(se))).length,Ee=[];ve<ke;)de=se[ve],ue&&g(ue,de)?++ve:(ue=y(Ee=n(Ee,de)),ve=0);return ue}function n(se,de){var ue,ve;if(p(de,se))return[de];for(ue=0;ue<se.length;++ue)if(a(de,se[ue])&&p(v(se[ue],de),se))return[se[ue],de];for(ue=0;ue<se.length-1;++ue)for(ve=ue+1;ve<se.length;++ve)if(a(v(se[ue],se[ve]),de)&&a(v(se[ue],de),se[ve])&&a(v(se[ve],de),se[ue])&&p(b(se[ue],se[ve],de),se))return[se[ue],se[ve],de];throw new Error}function a(se,de){var ue=se.r-de.r,ve=de.x-se.x,ke=de.y-se.y;return ue<0||ue*ue<ve*ve+ke*ke}function g(se,de){var ue=se.r-de.r+1e-6,ve=de.x-se.x,ke=de.y-se.y;return ue>0&&ue*ue>ve*ve+ke*ke}function p(se,de){for(var ue=0;ue<de.length;++ue)if(!g(se,de[ue]))return!1;return!0}function y(se){switch(se.length){case 1:return{x:(de=se[0]).x,y:de.y,r:de.r};case 2:return v(se[0],se[1]);case 3:return b(se[0],se[1],se[2])}var de}function v(se,de){var ue=se.x,ve=se.y,ke=se.r,Ee=de.x,be=de.y,xe=de.r,ce=Ee-ue,ge=be-ve,we=xe-ke,Me=Math.sqrt(ce*ce+ge*ge);return{x:(ue+Ee+ce/Me*we)/2,y:(ve+be+ge/Me*we)/2,r:(Me+ke+xe)/2}}function b(se,de,ue){var ve=se.x,ke=se.y,Ee=se.r,be=de.x,xe=de.y,ce=de.r,ge=ue.x,we=ue.y,Me=ue.r,Se=ve-be,ze=ve-ge,Fe=ke-xe,Ye=ke-we,rt=ce-Ee,Oe=Me-Ee,je=ve*ve+ke*ke-Ee*Ee,We=je-be*be-xe*xe+ce*ce,qe=je-ge*ge-we*we+Me*Me,et=ze*Fe-Se*Ye,st=(Fe*qe-Ye*We)/(2*et)-ve,ct=(Ye*rt-Fe*Oe)/et,Pt=(ze*We-Se*qe)/(2*et)-ke,kt=(Se*Oe-ze*rt)/et,at=ct*ct+kt*kt-1,tt=2*(Ee+st*ct+Pt*kt),_t=st*st+Pt*Pt-Ee*Ee,er=-(at?(tt+Math.sqrt(tt*tt-4*at*_t))/(2*at):_t/tt);return{x:ve+st+ct*er,y:ke+Pt+kt*er,r:er}}function x(se,de,ue){var ve,ke,Ee,be,xe=se.x-de.x,ce=se.y-de.y,ge=xe*xe+ce*ce;ge?(ke=de.r+ue.r,ke*=ke,be=se.r+ue.r,ke>(be*=be)?(ve=(ge+be-ke)/(2*ge),Ee=Math.sqrt(Math.max(0,be/ge-ve*ve)),ue.x=se.x-ve*xe-Ee*ce,ue.y=se.y-ve*ce+Ee*xe):(ve=(ge+ke-be)/(2*ge),Ee=Math.sqrt(Math.max(0,ke/ge-ve*ve)),ue.x=de.x+ve*xe-Ee*ce,ue.y=de.y+ve*ce+Ee*xe)):(ue.x=de.x+ue.r,ue.y=de.y)}function T(se,de){var ue=se.r+de.r-1e-6,ve=de.x-se.x,ke=de.y-se.y;return ue>0&&ue*ue>ve*ve+ke*ke}function A(se){var de=se._,ue=se.next._,ve=de.r+ue.r,ke=(de.x*ue.r+ue.x*de.r)/ve,Ee=(de.y*ue.r+ue.y*de.r)/ve;return ke*ke+Ee*Ee}function S(se){this._=se,this.next=null,this.previous=null}function w(se){if(!(ke=se.length))return 0;var de,ue,ve,ke,Ee,be,xe,ce,ge,we,Me;if((de=se[0]).x=0,de.y=0,!(ke>1))return de.r;if(ue=se[1],de.x=-ue.r,ue.x=de.r,ue.y=0,!(ke>2))return de.r+ue.r;x(ue,de,ve=se[2]),de=new S(de),ue=new S(ue),ve=new S(ve),de.next=ve.previous=ue,ue.next=de.previous=ve,ve.next=ue.previous=de;e:for(xe=3;xe<ke;++xe){x(de._,ue._,ve=se[xe]),ve=new S(ve),ce=ue.next,ge=de.previous,we=ue._.r,Me=de._.r;do if(we<=Me){if(T(ce._,ve._)){ue=ce,de.next=ue,ue.previous=de,--xe;continue e}we+=ce._.r,ce=ce.next}else{if(T(ge._,ve._)){(de=ge).next=ue,ue.previous=de,--xe;continue e}Me+=ge._.r,ge=ge.previous}while(ce!==ge.next);for(ve.previous=de,ve.next=ue,de.next=ue.previous=ue=ve,Ee=A(de);(ve=ve.next)!==ue;)(be=A(ve))<Ee&&(de=ve,Ee=be);ue=de.next}for(de=[ue._],ve=ue;(ve=ve.next)!==ue;)de.push(ve._);for(ve=c(de),xe=0;xe<ke;++xe)(de=se[xe]).x-=ve.x,de.y-=ve.y;return ve.r}function E(se){return se==null?null:k(se)}function k(se){if(typeof se!="function")throw new Error;return se}function L(){return 0}function M(se){return function(){return se}}function P(se){return Math.sqrt(se.value)}function D(se){return function(de){de.children||(de.r=Math.max(0,+se(de)||0))}}function N(se,de){return function(ue){if(ve=ue.children){var ve,ke,Ee,be=ve.length,xe=se(ue)*de||0;if(xe)for(ke=0;ke<be;++ke)ve[ke].r+=xe;if(Ee=w(ve),xe)for(ke=0;ke<be;++ke)ve[ke].r-=xe;ue.r=Ee+xe}}}function U(se){return function(de){var ue=de.parent;de.r*=se,ue&&(de.x=ue.x+se*de.x,de.y=ue.y+se*de.y)}}function G(se){se.x0=Math.round(se.x0),se.y0=Math.round(se.y0),se.x1=Math.round(se.x1),se.y1=Math.round(se.y1)}function X(se,de,ue,ve,ke){for(var Ee,be=se.children,xe=-1,ce=be.length,ge=se.value&&(ve-de)/se.value;++xe<ce;)(Ee=be[xe]).y0=ue,Ee.y1=ke,Ee.x0=de,Ee.x1=de+=Ee.value*ge}var K={depth:-1},Z={};function H(se){return se.id}function Y(se){return se.parentId}function $(se,de){return se.parent===de.parent?1:2}function z(se){var de=se.children;return de?de[0]:se.t}function j(se){var de=se.children;return de?de[de.length-1]:se.t}function W(se,de,ue){var ve=ue/(de.i-se.i);de.c-=ve,de.s+=ue,se.c+=ve,de.z+=ue,de.m+=ue}function ee(se,de,ue){return se.a.parent===de.parent?se.a:ue}function J(se,de){this._=se,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=de}function Q(se,de,ue,ve,ke){for(var Ee,be=se.children,xe=-1,ce=be.length,ge=se.value&&(ke-ue)/se.value;++xe<ce;)(Ee=be[xe]).x0=de,Ee.x1=ve,Ee.y0=ue,Ee.y1=ue+=Ee.value*ge}J.prototype=Object.create(s.prototype);var te=(1+Math.sqrt(5))/2;function ie(se,de,ue,ve,ke,Ee){for(var be,xe,ce,ge,we,Me,Se,ze,Fe,Ye,rt,Oe=[],je=de.children,We=0,qe=0,et=je.length,st=de.value;We<et;){ce=ke-ue,ge=Ee-ve;do we=je[qe++].value;while(!we&&qe<et);for(Me=Se=we,rt=we*we*(Ye=Math.max(ge/ce,ce/ge)/(st*se)),Fe=Math.max(Se/rt,rt/Me);qe<et;++qe){if(we+=xe=je[qe].value,xe<Me&&(Me=xe),xe>Se&&(Se=xe),rt=we*we*Ye,(ze=Math.max(Se/rt,rt/Me))>Fe){we-=xe;break}Fe=ze}Oe.push(be={value:we,dice:ce<ge,children:je.slice(We,qe)}),be.dice?X(be,ue,ve,ke,st?ve+=ge*we/st:Ee):Q(be,ue,ve,st?ue+=ce*we/st:ke,Ee),st-=we,We=qe}return Oe}var ae=function se(de){function ue(ve,ke,Ee,be,xe){ie(de,ve,ke,Ee,be,xe)}return ue.ratio=function(ve){return se((ve=+ve)>1?ve:1)},ue}(te),he=function se(de){function ue(ve,ke,Ee,be,xe){if((ce=ve._squarify)&&ce.ratio===de)for(var ce,ge,we,Me,Se,ze=-1,Fe=ce.length,Ye=ve.value;++ze<Fe;){for(we=(ge=ce[ze]).children,Me=ge.value=0,Se=we.length;Me<Se;++Me)ge.value+=we[Me].value;ge.dice?X(ge,ke,Ee,be,Ee+=(xe-Ee)*ge.value/Ye):Q(ge,ke,Ee,ke+=(be-ke)*ge.value/Ye,xe),Ye-=ge.value}else ve._squarify=ce=ie(de,ve,ke,Ee,be,xe),ce.ratio=de}return ue.ratio=function(ve){return se((ve=+ve)>1?ve:1)},ue}(te);t.cluster=function(){var se=d,de=1,ue=1,ve=!1;function ke(Ee){var be,xe=0;Ee.eachAfter(function(Se){var ze=Se.children;ze?(Se.x=function(Fe){return Fe.reduce(m,0)/Fe.length}(ze),Se.y=function(Fe){return 1+Fe.reduce(h,0)}(ze)):(Se.x=be?xe+=se(Se,be):0,Se.y=0,be=Se)});var ce=function(Se){for(var ze;ze=Se.children;)Se=ze[0];return Se}(Ee),ge=function(Se){for(var ze;ze=Se.children;)Se=ze[ze.length-1];return Se}(Ee),we=ce.x-se(ce,ge)/2,Me=ge.x+se(ge,ce)/2;return Ee.eachAfter(ve?function(Se){Se.x=(Se.x-Ee.x)*de,Se.y=(Ee.y-Se.y)*ue}:function(Se){Se.x=(Se.x-we)/(Me-we)*de,Se.y=(1-(Ee.y?Se.y/Ee.y:1))*ue})}return ke.separation=function(Ee){return arguments.length?(se=Ee,ke):se},ke.size=function(Ee){return arguments.length?(ve=!1,de=+Ee[0],ue=+Ee[1],ke):ve?null:[de,ue]},ke.nodeSize=function(Ee){return arguments.length?(ve=!0,de=+Ee[0],ue=+Ee[1],ke):ve?[de,ue]:null},ke},t.hierarchy=f,t.pack=function(){var se=null,de=1,ue=1,ve=L;function ke(Ee){return Ee.x=de/2,Ee.y=ue/2,se?Ee.eachBefore(D(se)).eachAfter(N(ve,.5)).eachBefore(U(1)):Ee.eachBefore(D(P)).eachAfter(N(L,1)).eachAfter(N(ve,Ee.r/Math.min(de,ue))).eachBefore(U(Math.min(de,ue)/(2*Ee.r))),Ee}return ke.radius=function(Ee){return arguments.length?(se=E(Ee),ke):se},ke.size=function(Ee){return arguments.length?(de=+Ee[0],ue=+Ee[1],ke):[de,ue]},ke.padding=function(Ee){return arguments.length?(ve=typeof Ee=="function"?Ee:M(+Ee),ke):ve},ke},t.packEnclose=c,t.packSiblings=function(se){return w(se),se},t.partition=function(){var se=1,de=1,ue=0,ve=!1;function ke(Ee){var be=Ee.height+1;return Ee.x0=Ee.y0=ue,Ee.x1=se,Ee.y1=de/be,Ee.eachBefore(function(xe,ce){return function(ge){ge.children&&X(ge,ge.x0,xe*(ge.depth+1)/ce,ge.x1,xe*(ge.depth+2)/ce);var we=ge.x0,Me=ge.y0,Se=ge.x1-ue,ze=ge.y1-ue;Se<we&&(we=Se=(we+Se)/2),ze<Me&&(Me=ze=(Me+ze)/2),ge.x0=we,ge.y0=Me,ge.x1=Se,ge.y1=ze}}(de,be)),ve&&Ee.eachBefore(G),Ee}return ke.round=function(Ee){return arguments.length?(ve=!!Ee,ke):ve},ke.size=function(Ee){return arguments.length?(se=+Ee[0],de=+Ee[1],ke):[se,de]},ke.padding=function(Ee){return arguments.length?(ue=+Ee,ke):ue},ke},t.stratify=function(){var se=H,de=Y;function ue(ve){var ke,Ee,be,xe,ce,ge,we,Me=ve.length,Se=new Array(Me),ze={};for(Ee=0;Ee<Me;++Ee)ke=ve[Ee],ce=Se[Ee]=new s(ke),(ge=se(ke,Ee,ve))!=null&&(ge+="")&&(ze[we="$"+(ce.id=ge)]=we in ze?Z:ce);for(Ee=0;Ee<Me;++Ee)if(ce=Se[Ee],(ge=de(ve[Ee],Ee,ve))!=null&&(ge+="")){if(!(xe=ze["$"+ge]))throw new Error("missing: "+ge);if(xe===Z)throw new Error("ambiguous: "+ge);xe.children?xe.children.push(ce):xe.children=[ce],ce.parent=xe}else{if(be)throw new Error("multiple roots");be=ce}if(!be)throw new Error("no root");if(be.parent=K,be.eachBefore(function(Fe){Fe.depth=Fe.parent.depth+1,--Me}).eachBefore(u),be.parent=null,Me>0)throw new Error("cycle");return be}return ue.id=function(ve){return arguments.length?(se=k(ve),ue):se},ue.parentId=function(ve){return arguments.length?(de=k(ve),ue):de},ue},t.tree=function(){var se=$,de=1,ue=1,ve=null;function ke(ce){var ge=function(Oe){for(var je,We,qe,et,st,ct=new J(Oe,0),Pt=[ct];je=Pt.pop();)if(qe=je._.children)for(je.children=new Array(st=qe.length),et=st-1;et>=0;--et)Pt.push(We=je.children[et]=new J(qe[et],et)),We.parent=je;return(ct.parent=new J(null,0)).children=[ct],ct}(ce);if(ge.eachAfter(Ee),ge.parent.m=-ge.z,ge.eachBefore(be),ve)ce.eachBefore(xe);else{var we=ce,Me=ce,Se=ce;ce.eachBefore(function(Oe){Oe.x<we.x&&(we=Oe),Oe.x>Me.x&&(Me=Oe),Oe.depth>Se.depth&&(Se=Oe)});var ze=we===Me?1:se(we,Me)/2,Fe=ze-we.x,Ye=de/(Me.x+ze+Fe),rt=ue/(Se.depth||1);ce.eachBefore(function(Oe){Oe.x=(Oe.x+Fe)*Ye,Oe.y=Oe.depth*rt})}return ce}function Ee(ce){var ge=ce.children,we=ce.parent.children,Me=ce.i?we[ce.i-1]:null;if(ge){(function(ze){for(var Fe,Ye=0,rt=0,Oe=ze.children,je=Oe.length;--je>=0;)(Fe=Oe[je]).z+=Ye,Fe.m+=Ye,Ye+=Fe.s+(rt+=Fe.c)})(ce);var Se=(ge[0].z+ge[ge.length-1].z)/2;Me?(ce.z=Me.z+se(ce._,Me._),ce.m=ce.z-Se):ce.z=Se}else Me&&(ce.z=Me.z+se(ce._,Me._));ce.parent.A=function(ze,Fe,Ye){if(Fe){for(var rt,Oe=ze,je=ze,We=Fe,qe=Oe.parent.children[0],et=Oe.m,st=je.m,ct=We.m,Pt=qe.m;We=j(We),Oe=z(Oe),We&&Oe;)qe=z(qe),(je=j(je)).a=ze,(rt=We.z+ct-Oe.z-et+se(We._,Oe._))>0&&(W(ee(We,ze,Ye),ze,rt),et+=rt,st+=rt),ct+=We.m,et+=Oe.m,Pt+=qe.m,st+=je.m;We&&!j(je)&&(je.t=We,je.m+=ct-st),Oe&&!z(qe)&&(qe.t=Oe,qe.m+=et-Pt,Ye=ze)}return Ye}(ce,Me,ce.parent.A||we[0])}function be(ce){ce._.x=ce.z+ce.parent.m,ce.m+=ce.parent.m}function xe(ce){ce.x*=de,ce.y=ce.depth*ue}return ke.separation=function(ce){return arguments.length?(se=ce,ke):se},ke.size=function(ce){return arguments.length?(ve=!1,de=+ce[0],ue=+ce[1],ke):ve?null:[de,ue]},ke.nodeSize=function(ce){return arguments.length?(ve=!0,de=+ce[0],ue=+ce[1],ke):ve?[de,ue]:null},ke},t.treemap=function(){var se=ae,de=!1,ue=1,ve=1,ke=[0],Ee=L,be=L,xe=L,ce=L,ge=L;function we(Se){return Se.x0=Se.y0=0,Se.x1=ue,Se.y1=ve,Se.eachBefore(Me),ke=[0],de&&Se.eachBefore(G),Se}function Me(Se){var ze=ke[Se.depth],Fe=Se.x0+ze,Ye=Se.y0+ze,rt=Se.x1-ze,Oe=Se.y1-ze;rt<Fe&&(Fe=rt=(Fe+rt)/2),Oe<Ye&&(Ye=Oe=(Ye+Oe)/2),Se.x0=Fe,Se.y0=Ye,Se.x1=rt,Se.y1=Oe,Se.children&&(ze=ke[Se.depth+1]=Ee(Se)/2,Fe+=ge(Se)-ze,Ye+=be(Se)-ze,(rt-=xe(Se)-ze)<Fe&&(Fe=rt=(Fe+rt)/2),(Oe-=ce(Se)-ze)<Ye&&(Ye=Oe=(Ye+Oe)/2),se(Se,Fe,Ye,rt,Oe))}return we.round=function(Se){return arguments.length?(de=!!Se,we):de},we.size=function(Se){return arguments.length?(ue=+Se[0],ve=+Se[1],we):[ue,ve]},we.tile=function(Se){return arguments.length?(se=k(Se),we):se},we.padding=function(Se){return arguments.length?we.paddingInner(Se).paddingOuter(Se):we.paddingInner()},we.paddingInner=function(Se){return arguments.length?(Ee=typeof Se=="function"?Se:M(+Se),we):Ee},we.paddingOuter=function(Se){return arguments.length?we.paddingTop(Se).paddingRight(Se).paddingBottom(Se).paddingLeft(Se):we.paddingTop()},we.paddingTop=function(Se){return arguments.length?(be=typeof Se=="function"?Se:M(+Se),we):be},we.paddingRight=function(Se){return arguments.length?(xe=typeof Se=="function"?Se:M(+Se),we):xe},we.paddingBottom=function(Se){return arguments.length?(ce=typeof Se=="function"?Se:M(+Se),we):ce},we.paddingLeft=function(Se){return arguments.length?(ge=typeof Se=="function"?Se:M(+Se),we):ge},we},t.treemapBinary=function(se,de,ue,ve,ke){var Ee,be,xe=se.children,ce=xe.length,ge=new Array(ce+1);for(ge[0]=be=Ee=0;Ee<ce;++Ee)ge[Ee+1]=be+=xe[Ee].value;(function we(Me,Se,ze,Fe,Ye,rt,Oe){if(Me>=Se-1){var je=xe[Me];return je.x0=Fe,je.y0=Ye,je.x1=rt,void(je.y1=Oe)}for(var We=ge[Me],qe=ze/2+We,et=Me+1,st=Se-1;et<st;){var ct=et+st>>>1;ge[ct]<qe?et=ct+1:st=ct}qe-ge[et-1]<ge[et]-qe&&Me+1<et&&--et;var Pt=ge[et]-We,kt=ze-Pt;if(rt-Fe>Oe-Ye){var at=(Fe*kt+rt*Pt)/ze;we(Me,et,Pt,Fe,Ye,at,Oe),we(et,Se,kt,at,Ye,rt,Oe)}else{var tt=(Ye*kt+Oe*Pt)/ze;we(Me,et,Pt,Fe,Ye,rt,tt),we(et,Se,kt,Fe,tt,rt,Oe)}})(0,ce,se.value,de,ue,ve,ke)},t.treemapDice=X,t.treemapResquarify=he,t.treemapSlice=Q,t.treemapSliceDice=function(se,de,ue,ve,ke){(1&se.depth?Q:X)(se,de,ue,ve,ke)},t.treemapSquarify=ae,Object.defineProperty(t,"__esModule",{value:!0})})},{}],168:[function(r,I,B){(function(t,d){typeof B=="object"&&I!==void 0?d(B,r("d3-color")):d((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,d){function m(te,ie,ae,he,se){var de=te*te,ue=de*te;return((1-3*te+3*de-ue)*ie+(4-6*de+3*ue)*ae+(1+3*te+3*de-3*ue)*he+ue*se)/6}function h(te){var ie=te.length-1;return function(ae){var he=ae<=0?ae=0:ae>=1?(ae=1,ie-1):Math.floor(ae*ie),se=te[he],de=te[he+1],ue=he>0?te[he-1]:2*se-de,ve=he<ie-1?te[he+2]:2*de-se;return m((ae-he/ie)*ie,ue,se,de,ve)}}function e(te){var ie=te.length;return function(ae){var he=Math.floor(((ae%=1)<0?++ae:ae)*ie),se=te[(he+ie-1)%ie],de=te[he%ie],ue=te[(he+1)%ie],ve=te[(he+2)%ie];return m((ae-he/ie)*ie,se,de,ue,ve)}}function f(te){return function(){return te}}function l(te,ie){return function(ae){return te+ae*ie}}function o(te,ie){var ae=ie-te;return ae?l(te,ae>180||ae<-180?ae-360*Math.round(ae/360):ae):f(isNaN(te)?ie:te)}function u(te){return(te=+te)==1?s:function(ie,ae){return ae-ie?function(he,se,de){return he=Math.pow(he,de),se=Math.pow(se,de)-he,de=1/de,function(ue){return Math.pow(he+ue*se,de)}}(ie,ae,te):f(isNaN(ie)?ae:ie)}}function s(te,ie){var ae=ie-te;return ae?l(te,ae):f(isNaN(te)?ie:te)}var i=function te(ie){var ae=u(ie);function he(se,de){var ue=ae((se=d.rgb(se)).r,(de=d.rgb(de)).r),ve=ae(se.g,de.g),ke=ae(se.b,de.b),Ee=s(se.opacity,de.opacity);return function(be){return se.r=ue(be),se.g=ve(be),se.b=ke(be),se.opacity=Ee(be),se+""}}return he.gamma=te,he}(1);function c(te){return function(ie){var ae,he,se=ie.length,de=new Array(se),ue=new Array(se),ve=new Array(se);for(ae=0;ae<se;++ae)he=d.rgb(ie[ae]),de[ae]=he.r||0,ue[ae]=he.g||0,ve[ae]=he.b||0;return de=te(de),ue=te(ue),ve=te(ve),he.opacity=1,function(ke){return he.r=de(ke),he.g=ue(ke),he.b=ve(ke),he+""}}}var n=c(h),a=c(e);function g(te,ie){ie||(ie=[]);var ae,he=te?Math.min(ie.length,te.length):0,se=ie.slice();return function(de){for(ae=0;ae<he;++ae)se[ae]=te[ae]*(1-de)+ie[ae]*de;return se}}function p(te){return ArrayBuffer.isView(te)&&!(te instanceof DataView)}function y(te,ie){var ae,he=ie?ie.length:0,se=te?Math.min(he,te.length):0,de=new Array(se),ue=new Array(he);for(ae=0;ae<se;++ae)de[ae]=w(te[ae],ie[ae]);for(;ae<he;++ae)ue[ae]=ie[ae];return function(ve){for(ae=0;ae<se;++ae)ue[ae]=de[ae](ve);return ue}}function v(te,ie){var ae=new Date;return te=+te,ie=+ie,function(he){return ae.setTime(te*(1-he)+ie*he),ae}}function b(te,ie){return te=+te,ie=+ie,function(ae){return te*(1-ae)+ie*ae}}function x(te,ie){var ae,he={},se={};for(ae in te!==null&&typeof te=="object"||(te={}),ie!==null&&typeof ie=="object"||(ie={}),ie)ae in te?he[ae]=w(te[ae],ie[ae]):se[ae]=ie[ae];return function(de){for(ae in he)se[ae]=he[ae](de);return se}}var T=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,A=new RegExp(T.source,"g");function S(te,ie){var ae,he,se,de=T.lastIndex=A.lastIndex=0,ue=-1,ve=[],ke=[];for(te+="",ie+="";(ae=T.exec(te))&&(he=A.exec(ie));)(se=he.index)>de&&(se=ie.slice(de,se),ve[ue]?ve[ue]+=se:ve[++ue]=se),(ae=ae[0])===(he=he[0])?ve[ue]?ve[ue]+=he:ve[++ue]=he:(ve[++ue]=null,ke.push({i:ue,x:b(ae,he)})),de=A.lastIndex;return de<ie.length&&(se=ie.slice(de),ve[ue]?ve[ue]+=se:ve[++ue]=se),ve.length<2?ke[0]?function(Ee){return function(be){return Ee(be)+""}}(ke[0].x):function(Ee){return function(){return Ee}}(ie):(ie=ke.length,function(Ee){for(var be,xe=0;xe<ie;++xe)ve[(be=ke[xe]).i]=be.x(Ee);return ve.join("")})}function w(te,ie){var ae,he=typeof ie;return ie==null||he==="boolean"?f(ie):(he==="number"?b:he==="string"?(ae=d.color(ie))?(ie=ae,i):S:ie instanceof d.color?i:ie instanceof Date?v:p(ie)?g:Array.isArray(ie)?y:typeof ie.valueOf!="function"&&typeof ie.toString!="function"||isNaN(ie)?x:b)(te,ie)}var E,k,L,M,P=180/Math.PI,D={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function N(te,ie,ae,he,se,de){var ue,ve,ke;return(ue=Math.sqrt(te*te+ie*ie))&&(te/=ue,ie/=ue),(ke=te*ae+ie*he)&&(ae-=te*ke,he-=ie*ke),(ve=Math.sqrt(ae*ae+he*he))&&(ae/=ve,he/=ve,ke/=ve),te*he<ie*ae&&(te=-te,ie=-ie,ke=-ke,ue=-ue),{translateX:se,translateY:de,rotate:Math.atan2(ie,te)*P,skewX:Math.atan(ke)*P,scaleX:ue,scaleY:ve}}function U(te,ie,ae,he){function se(de){return de.length?de.pop()+" ":""}return function(de,ue){var ve=[],ke=[];return de=te(de),ue=te(ue),function(Ee,be,xe,ce,ge,we){if(Ee!==xe||be!==ce){var Me=ge.push("translate(",null,ie,null,ae);we.push({i:Me-4,x:b(Ee,xe)},{i:Me-2,x:b(be,ce)})}else(xe||ce)&&ge.push("translate("+xe+ie+ce+ae)}(de.translateX,de.translateY,ue.translateX,ue.translateY,ve,ke),function(Ee,be,xe,ce){Ee!==be?(Ee-be>180?be+=360:be-Ee>180&&(Ee+=360),ce.push({i:xe.push(se(xe)+"rotate(",null,he)-2,x:b(Ee,be)})):be&&xe.push(se(xe)+"rotate("+be+he)}(de.rotate,ue.rotate,ve,ke),function(Ee,be,xe,ce){Ee!==be?ce.push({i:xe.push(se(xe)+"skewX(",null,he)-2,x:b(Ee,be)}):be&&xe.push(se(xe)+"skewX("+be+he)}(de.skewX,ue.skewX,ve,ke),function(Ee,be,xe,ce,ge,we){if(Ee!==xe||be!==ce){var Me=ge.push(se(ge)+"scale(",null,",",null,")");we.push({i:Me-4,x:b(Ee,xe)},{i:Me-2,x:b(be,ce)})}else xe===1&&ce===1||ge.push(se(ge)+"scale("+xe+","+ce+")")}(de.scaleX,de.scaleY,ue.scaleX,ue.scaleY,ve,ke),de=ue=null,function(Ee){for(var be,xe=-1,ce=ke.length;++xe<ce;)ve[(be=ke[xe]).i]=be.x(Ee);return ve.join("")}}}var G=U(function(te){return te==="none"?D:(E||(E=document.createElement("DIV"),k=document.documentElement,L=document.defaultView),E.style.transform=te,te=L.getComputedStyle(k.appendChild(E),null).getPropertyValue("transform"),k.removeChild(E),N(+(te=te.slice(7,-1).split(","))[0],+te[1],+te[2],+te[3],+te[4],+te[5]))},"px, ","px)","deg)"),X=U(function(te){return te==null?D:(M||(M=document.createElementNS("http://www.w3.org/2000/svg","g")),M.setAttribute("transform",te),(te=M.transform.baseVal.consolidate())?N((te=te.matrix).a,te.b,te.c,te.d,te.e,te.f):D)},", ",")",")"),K=Math.SQRT2;function Z(te){return((te=Math.exp(te))+1/te)/2}function H(te){return function(ie,ae){var he=te((ie=d.hsl(ie)).h,(ae=d.hsl(ae)).h),se=s(ie.s,ae.s),de=s(ie.l,ae.l),ue=s(ie.opacity,ae.opacity);return function(ve){return ie.h=he(ve),ie.s=se(ve),ie.l=de(ve),ie.opacity=ue(ve),ie+""}}}var Y=H(o),$=H(s);function z(te){return function(ie,ae){var he=te((ie=d.hcl(ie)).h,(ae=d.hcl(ae)).h),se=s(ie.c,ae.c),de=s(ie.l,ae.l),ue=s(ie.opacity,ae.opacity);return function(ve){return ie.h=he(ve),ie.c=se(ve),ie.l=de(ve),ie.opacity=ue(ve),ie+""}}}var j=z(o),W=z(s);function ee(te){return function ie(ae){function he(se,de){var ue=te((se=d.cubehelix(se)).h,(de=d.cubehelix(de)).h),ve=s(se.s,de.s),ke=s(se.l,de.l),Ee=s(se.opacity,de.opacity);return function(be){return se.h=ue(be),se.s=ve(be),se.l=ke(Math.pow(be,ae)),se.opacity=Ee(be),se+""}}return ae=+ae,he.gamma=ie,he}(1)}var J=ee(o),Q=ee(s);t.interpolate=w,t.interpolateArray=function(te,ie){return(p(ie)?g:y)(te,ie)},t.interpolateBasis=h,t.interpolateBasisClosed=e,t.interpolateCubehelix=J,t.interpolateCubehelixLong=Q,t.interpolateDate=v,t.interpolateDiscrete=function(te){var ie=te.length;return function(ae){return te[Math.max(0,Math.min(ie-1,Math.floor(ae*ie)))]}},t.interpolateHcl=j,t.interpolateHclLong=W,t.interpolateHsl=Y,t.interpolateHslLong=$,t.interpolateHue=function(te,ie){var ae=o(+te,+ie);return function(he){var se=ae(he);return se-360*Math.floor(se/360)}},t.interpolateLab=function(te,ie){var ae=s((te=d.lab(te)).l,(ie=d.lab(ie)).l),he=s(te.a,ie.a),se=s(te.b,ie.b),de=s(te.opacity,ie.opacity);return function(ue){return te.l=ae(ue),te.a=he(ue),te.b=se(ue),te.opacity=de(ue),te+""}},t.interpolateNumber=b,t.interpolateNumberArray=g,t.interpolateObject=x,t.interpolateRgb=i,t.interpolateRgbBasis=n,t.interpolateRgbBasisClosed=a,t.interpolateRound=function(te,ie){return te=+te,ie=+ie,function(ae){return Math.round(te*(1-ae)+ie*ae)}},t.interpolateString=S,t.interpolateTransformCss=G,t.interpolateTransformSvg=X,t.interpolateZoom=function(te,ie){var ae,he,se=te[0],de=te[1],ue=te[2],ve=ie[0],ke=ie[1],Ee=ie[2],be=ve-se,xe=ke-de,ce=be*be+xe*xe;if(ce<1e-12)he=Math.log(Ee/ue)/K,ae=function(Fe){return[se+Fe*be,de+Fe*xe,ue*Math.exp(K*Fe*he)]};else{var ge=Math.sqrt(ce),we=(Ee*Ee-ue*ue+4*ce)/(2*ue*2*ge),Me=(Ee*Ee-ue*ue-4*ce)/(2*Ee*2*ge),Se=Math.log(Math.sqrt(we*we+1)-we),ze=Math.log(Math.sqrt(Me*Me+1)-Me);he=(ze-Se)/K,ae=function(Fe){var Ye,rt=Fe*he,Oe=Z(Se),je=ue/(2*ge)*(Oe*(Ye=K*rt+Se,((Ye=Math.exp(2*Ye))-1)/(Ye+1))-function(We){return((We=Math.exp(We))-1/We)/2}(Se));return[se+je*be,de+je*xe,ue*Oe/Z(K*rt+Se)]}}return ae.duration=1e3*he,ae},t.piecewise=function(te,ie){for(var ae=0,he=ie.length-1,se=ie[0],de=new Array(he<0?0:he);ae<he;)de[ae]=te(se,se=ie[++ae]);return function(ue){var ve=Math.max(0,Math.min(he-1,Math.floor(ue*=he)));return de[ve](ue-ve)}},t.quantize=function(te,ie){for(var ae=new Array(ie),he=0;he<ie;++he)ae[he]=te(he/(ie-1));return ae},Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-color":161}],169:[function(r,I,B){(function(t,d){d(typeof B=="object"&&I!==void 0?B:(t=t||self).d3=t.d3||{})})(this,function(t){var d=Math.PI,m=2*d,h=m-1e-6;function e(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function f(){return new e}e.prototype=f.prototype={constructor:e,moveTo:function(l,o){this._+="M"+(this._x0=this._x1=+l)+","+(this._y0=this._y1=+o)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(l,o){this._+="L"+(this._x1=+l)+","+(this._y1=+o)},quadraticCurveTo:function(l,o,u,s){this._+="Q"+ +l+","+ +o+","+(this._x1=+u)+","+(this._y1=+s)},bezierCurveTo:function(l,o,u,s,i,c){this._+="C"+ +l+","+ +o+","+ +u+","+ +s+","+(this._x1=+i)+","+(this._y1=+c)},arcTo:function(l,o,u,s,i){l=+l,o=+o,u=+u,s=+s,i=+i;var c=this._x1,n=this._y1,a=u-l,g=s-o,p=c-l,y=n-o,v=p*p+y*y;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=l)+","+(this._y1=o);else if(v>1e-6)if(Math.abs(y*a-g*p)>1e-6&&i){var b=u-c,x=s-n,T=a*a+g*g,A=b*b+x*x,S=Math.sqrt(T),w=Math.sqrt(v),E=i*Math.tan((d-Math.acos((T+v-A)/(2*S*w)))/2),k=E/w,L=E/S;Math.abs(k-1)>1e-6&&(this._+="L"+(l+k*p)+","+(o+k*y)),this._+="A"+i+","+i+",0,0,"+ +(y*b>p*x)+","+(this._x1=l+L*a)+","+(this._y1=o+L*g)}else this._+="L"+(this._x1=l)+","+(this._y1=o)},arc:function(l,o,u,s,i,c){l=+l,o=+o,c=!!c;var n=(u=+u)*Math.cos(s),a=u*Math.sin(s),g=l+n,p=o+a,y=1^c,v=c?s-i:i-s;if(u<0)throw new Error("negative radius: "+u);this._x1===null?this._+="M"+g+","+p:(Math.abs(this._x1-g)>1e-6||Math.abs(this._y1-p)>1e-6)&&(this._+="L"+g+","+p),u&&(v<0&&(v=v%m+m),v>h?this._+="A"+u+","+u+",0,1,"+y+","+(l-n)+","+(o-a)+"A"+u+","+u+",0,1,"+y+","+(this._x1=g)+","+(this._y1=p):v>1e-6&&(this._+="A"+u+","+u+",0,"+ +(v>=d)+","+y+","+(this._x1=l+u*Math.cos(i))+","+(this._y1=o+u*Math.sin(i))))},rect:function(l,o,u,s){this._+="M"+(this._x0=this._x1=+l)+","+(this._y0=this._y1=+o)+"h"+ +u+"v"+ +s+"h"+-u+"Z"},toString:function(){return this._}},t.path=f,Object.defineProperty(t,"__esModule",{value:!0})})},{}],170:[function(r,I,B){(function(t,d){d(typeof B=="object"&&I!==void 0?B:(t=t||self).d3=t.d3||{})})(this,function(t){function d(s,i,c,n){if(isNaN(i)||isNaN(c))return s;var a,g,p,y,v,b,x,T,A,S=s._root,w={data:n},E=s._x0,k=s._y0,L=s._x1,M=s._y1;if(!S)return s._root=w,s;for(;S.length;)if((b=i>=(g=(E+L)/2))?E=g:L=g,(x=c>=(p=(k+M)/2))?k=p:M=p,a=S,!(S=S[T=x<<1|b]))return a[T]=w,s;if(y=+s._x.call(null,S.data),v=+s._y.call(null,S.data),i===y&&c===v)return w.next=S,a?a[T]=w:s._root=w,s;do a=a?a[T]=new Array(4):s._root=new Array(4),(b=i>=(g=(E+L)/2))?E=g:L=g,(x=c>=(p=(k+M)/2))?k=p:M=p;while((T=x<<1|b)==(A=(v>=p)<<1|y>=g));return a[A]=S,a[T]=w,s}function m(s,i,c,n,a){this.node=s,this.x0=i,this.y0=c,this.x1=n,this.y1=a}function h(s){return s[0]}function e(s){return s[1]}function f(s,i,c){var n=new l(i==null?h:i,c==null?e:c,NaN,NaN,NaN,NaN);return s==null?n:n.addAll(s)}function l(s,i,c,n,a,g){this._x=s,this._y=i,this._x0=c,this._y0=n,this._x1=a,this._y1=g,this._root=void 0}function o(s){for(var i={data:s.data},c=i;s=s.next;)c=c.next={data:s.data};return i}var u=f.prototype=l.prototype;u.copy=function(){var s,i,c=new l(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return c;if(!n.length)return c._root=o(n),c;for(s=[{source:n,target:c._root=new Array(4)}];n=s.pop();)for(var a=0;a<4;++a)(i=n.source[a])&&(i.length?s.push({source:i,target:n.target[a]=new Array(4)}):n.target[a]=o(i));return c},u.add=function(s){var i=+this._x.call(null,s),c=+this._y.call(null,s);return d(this.cover(i,c),i,c,s)},u.addAll=function(s){var i,c,n,a,g=s.length,p=new Array(g),y=new Array(g),v=1/0,b=1/0,x=-1/0,T=-1/0;for(c=0;c<g;++c)isNaN(n=+this._x.call(null,i=s[c]))||isNaN(a=+this._y.call(null,i))||(p[c]=n,y[c]=a,n<v&&(v=n),n>x&&(x=n),a<b&&(b=a),a>T&&(T=a));if(v>x||b>T)return this;for(this.cover(v,b).cover(x,T),c=0;c<g;++c)d(this,p[c],y[c],s[c]);return this},u.cover=function(s,i){if(isNaN(s=+s)||isNaN(i=+i))return this;var c=this._x0,n=this._y0,a=this._x1,g=this._y1;if(isNaN(c))a=(c=Math.floor(s))+1,g=(n=Math.floor(i))+1;else{for(var p,y,v=a-c,b=this._root;c>s||s>=a||n>i||i>=g;)switch(y=(i<n)<<1|s<c,(p=new Array(4))[y]=b,b=p,v*=2,y){case 0:a=c+v,g=n+v;break;case 1:c=a-v,g=n+v;break;case 2:a=c+v,n=g-v;break;case 3:c=a-v,n=g-v}this._root&&this._root.length&&(this._root=b)}return this._x0=c,this._y0=n,this._x1=a,this._y1=g,this},u.data=function(){var s=[];return this.visit(function(i){if(!i.length)do s.push(i.data);while(i=i.next)}),s},u.extent=function(s){return arguments.length?this.cover(+s[0][0],+s[0][1]).cover(+s[1][0],+s[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},u.find=function(s,i,c){var n,a,g,p,y,v,b,x=this._x0,T=this._y0,A=this._x1,S=this._y1,w=[],E=this._root;for(E&&w.push(new m(E,x,T,A,S)),c==null?c=1/0:(x=s-c,T=i-c,A=s+c,S=i+c,c*=c);v=w.pop();)if(!(!(E=v.node)||(a=v.x0)>A||(g=v.y0)>S||(p=v.x1)<x||(y=v.y1)<T))if(E.length){var k=(a+p)/2,L=(g+y)/2;w.push(new m(E[3],k,L,p,y),new m(E[2],a,L,k,y),new m(E[1],k,g,p,L),new m(E[0],a,g,k,L)),(b=(i>=L)<<1|s>=k)&&(v=w[w.length-1],w[w.length-1]=w[w.length-1-b],w[w.length-1-b]=v)}else{var M=s-+this._x.call(null,E.data),P=i-+this._y.call(null,E.data),D=M*M+P*P;if(D<c){var N=Math.sqrt(c=D);x=s-N,T=i-N,A=s+N,S=i+N,n=E.data}}return n},u.remove=function(s){if(isNaN(g=+this._x.call(null,s))||isNaN(p=+this._y.call(null,s)))return this;var i,c,n,a,g,p,y,v,b,x,T,A,S=this._root,w=this._x0,E=this._y0,k=this._x1,L=this._y1;if(!S)return this;if(S.length)for(;;){if((b=g>=(y=(w+k)/2))?w=y:k=y,(x=p>=(v=(E+L)/2))?E=v:L=v,i=S,!(S=S[T=x<<1|b]))return this;if(!S.length)break;(i[T+1&3]||i[T+2&3]||i[T+3&3])&&(c=i,A=T)}for(;S.data!==s;)if(n=S,!(S=S.next))return this;return(a=S.next)&&delete S.next,n?(a?n.next=a:delete n.next,this):i?(a?i[T]=a:delete i[T],(S=i[0]||i[1]||i[2]||i[3])&&S===(i[3]||i[2]||i[1]||i[0])&&!S.length&&(c?c[A]=S:this._root=S),this):(this._root=a,this)},u.removeAll=function(s){for(var i=0,c=s.length;i<c;++i)this.remove(s[i]);return this},u.root=function(){return this._root},u.size=function(){var s=0;return this.visit(function(i){if(!i.length)do++s;while(i=i.next)}),s},u.visit=function(s){var i,c,n,a,g,p,y=[],v=this._root;for(v&&y.push(new m(v,this._x0,this._y0,this._x1,this._y1));i=y.pop();)if(!s(v=i.node,n=i.x0,a=i.y0,g=i.x1,p=i.y1)&&v.length){var b=(n+g)/2,x=(a+p)/2;(c=v[3])&&y.push(new m(c,b,x,g,p)),(c=v[2])&&y.push(new m(c,n,x,b,p)),(c=v[1])&&y.push(new m(c,b,a,g,x)),(c=v[0])&&y.push(new m(c,n,a,b,x))}return this},u.visitAfter=function(s){var i,c=[],n=[];for(this._root&&c.push(new m(this._root,this._x0,this._y0,this._x1,this._y1));i=c.pop();){var a=i.node;if(a.length){var g,p=i.x0,y=i.y0,v=i.x1,b=i.y1,x=(p+v)/2,T=(y+b)/2;(g=a[0])&&c.push(new m(g,p,y,x,T)),(g=a[1])&&c.push(new m(g,x,y,v,T)),(g=a[2])&&c.push(new m(g,p,T,x,b)),(g=a[3])&&c.push(new m(g,x,T,v,b))}n.push(i)}for(;i=n.pop();)s(i.node,i.x0,i.y0,i.x1,i.y1);return this},u.x=function(s){return arguments.length?(this._x=s,this):this._x},u.y=function(s){return arguments.length?(this._y=s,this):this._y},t.quadtree=f,Object.defineProperty(t,"__esModule",{value:!0})})},{}],171:[function(r,I,B){(function(t,d){typeof B=="object"&&I!==void 0?d(B,r("d3-path")):d((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,d){function m(Ie){return function(){return Ie}}var h=Math.abs,e=Math.atan2,f=Math.cos,l=Math.max,o=Math.min,u=Math.sin,s=Math.sqrt,i=Math.PI,c=i/2,n=2*i;function a(Ie){return Ie>1?0:Ie<-1?i:Math.acos(Ie)}function g(Ie){return Ie>=1?c:Ie<=-1?-c:Math.asin(Ie)}function p(Ie){return Ie.innerRadius}function y(Ie){return Ie.outerRadius}function v(Ie){return Ie.startAngle}function b(Ie){return Ie.endAngle}function x(Ie){return Ie&&Ie.padAngle}function T(Ie,lt,wt,Ot,Gt,ir,Xt,Kt){var or=wt-Ie,dr=Ot-lt,vr=Xt-Gt,ur=Kt-ir,pr=ur*or-vr*dr;if(!(pr*pr<1e-12))return[Ie+(pr=(vr*(lt-ir)-ur*(Ie-Gt))/pr)*or,lt+pr*dr]}function A(Ie,lt,wt,Ot,Gt,ir,Xt){var Kt=Ie-wt,or=lt-Ot,dr=(Xt?ir:-ir)/s(Kt*Kt+or*or),vr=dr*or,ur=-dr*Kt,pr=Ie+vr,br=lt+ur,Rr=wt+vr,_r=Ot+ur,jr=(pr+Rr)/2,$r=(br+_r)/2,pn=Rr-pr,In=_r-br,On=pn*pn+In*In,Sn=Gt-ir,an=pr*_r-Rr*br,Nr=(In<0?-1:1)*s(l(0,Sn*Sn*On-an*an)),Pr=(an*In-pn*Nr)/On,en=(-an*pn-In*Nr)/On,tn=(an*In+pn*Nr)/On,Qr=(-an*pn+In*Nr)/On,rn=Pr-jr,An=en-$r,En=tn-jr,Bn=Qr-$r;return rn*rn+An*An>En*En+Bn*Bn&&(Pr=tn,en=Qr),{cx:Pr,cy:en,x01:-vr,y01:-ur,x11:Pr*(Gt/Sn-1),y11:en*(Gt/Sn-1)}}function S(Ie){this._context=Ie}function w(Ie){return new S(Ie)}function E(Ie){return Ie[0]}function k(Ie){return Ie[1]}function L(){var Ie=E,lt=k,wt=m(!0),Ot=null,Gt=w,ir=null;function Xt(Kt){var or,dr,vr,ur=Kt.length,pr=!1;for(Ot==null&&(ir=Gt(vr=d.path())),or=0;or<=ur;++or)!(or<ur&&wt(dr=Kt[or],or,Kt))===pr&&((pr=!pr)?ir.lineStart():ir.lineEnd()),pr&&ir.point(+Ie(dr,or,Kt),+lt(dr,or,Kt));if(vr)return ir=null,vr+""||null}return Xt.x=function(Kt){return arguments.length?(Ie=typeof Kt=="function"?Kt:m(+Kt),Xt):Ie},Xt.y=function(Kt){return arguments.length?(lt=typeof Kt=="function"?Kt:m(+Kt),Xt):lt},Xt.defined=function(Kt){return arguments.length?(wt=typeof Kt=="function"?Kt:m(!!Kt),Xt):wt},Xt.curve=function(Kt){return arguments.length?(Gt=Kt,Ot!=null&&(ir=Gt(Ot)),Xt):Gt},Xt.context=function(Kt){return arguments.length?(Kt==null?Ot=ir=null:ir=Gt(Ot=Kt),Xt):Ot},Xt}function M(){var Ie=E,lt=null,wt=m(0),Ot=k,Gt=m(!0),ir=null,Xt=w,Kt=null;function or(vr){var ur,pr,br,Rr,_r,jr=vr.length,$r=!1,pn=new Array(jr),In=new Array(jr);for(ir==null&&(Kt=Xt(_r=d.path())),ur=0;ur<=jr;++ur){if(!(ur<jr&&Gt(Rr=vr[ur],ur,vr))===$r)if($r=!$r)pr=ur,Kt.areaStart(),Kt.lineStart();else{for(Kt.lineEnd(),Kt.lineStart(),br=ur-1;br>=pr;--br)Kt.point(pn[br],In[br]);Kt.lineEnd(),Kt.areaEnd()}$r&&(pn[ur]=+Ie(Rr,ur,vr),In[ur]=+wt(Rr,ur,vr),Kt.point(lt?+lt(Rr,ur,vr):pn[ur],Ot?+Ot(Rr,ur,vr):In[ur]))}if(_r)return Kt=null,_r+""||null}function dr(){return L().defined(Gt).curve(Xt).context(ir)}return or.x=function(vr){return arguments.length?(Ie=typeof vr=="function"?vr:m(+vr),lt=null,or):Ie},or.x0=function(vr){return arguments.length?(Ie=typeof vr=="function"?vr:m(+vr),or):Ie},or.x1=function(vr){return arguments.length?(lt=vr==null?null:typeof vr=="function"?vr:m(+vr),or):lt},or.y=function(vr){return arguments.length?(wt=typeof vr=="function"?vr:m(+vr),Ot=null,or):wt},or.y0=function(vr){return arguments.length?(wt=typeof vr=="function"?vr:m(+vr),or):wt},or.y1=function(vr){return arguments.length?(Ot=vr==null?null:typeof vr=="function"?vr:m(+vr),or):Ot},or.lineX0=or.lineY0=function(){return dr().x(Ie).y(wt)},or.lineY1=function(){return dr().x(Ie).y(Ot)},or.lineX1=function(){return dr().x(lt).y(wt)},or.defined=function(vr){return arguments.length?(Gt=typeof vr=="function"?vr:m(!!vr),or):Gt},or.curve=function(vr){return arguments.length?(Xt=vr,ir!=null&&(Kt=Xt(ir)),or):Xt},or.context=function(vr){return arguments.length?(vr==null?ir=Kt=null:Kt=Xt(ir=vr),or):ir},or}function P(Ie,lt){return lt<Ie?-1:lt>Ie?1:lt>=Ie?0:NaN}function D(Ie){return Ie}S.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,lt){switch(Ie=+Ie,lt=+lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,lt):this._context.moveTo(Ie,lt);break;case 1:this._point=2;default:this._context.lineTo(Ie,lt)}}};var N=G(w);function U(Ie){this._curve=Ie}function G(Ie){function lt(wt){return new U(Ie(wt))}return lt._curve=Ie,lt}function X(Ie){var lt=Ie.curve;return Ie.angle=Ie.x,delete Ie.x,Ie.radius=Ie.y,delete Ie.y,Ie.curve=function(wt){return arguments.length?lt(G(wt)):lt()._curve},Ie}function K(){return X(L().curve(N))}function Z(){var Ie=M().curve(N),lt=Ie.curve,wt=Ie.lineX0,Ot=Ie.lineX1,Gt=Ie.lineY0,ir=Ie.lineY1;return Ie.angle=Ie.x,delete Ie.x,Ie.startAngle=Ie.x0,delete Ie.x0,Ie.endAngle=Ie.x1,delete Ie.x1,Ie.radius=Ie.y,delete Ie.y,Ie.innerRadius=Ie.y0,delete Ie.y0,Ie.outerRadius=Ie.y1,delete Ie.y1,Ie.lineStartAngle=function(){return X(wt())},delete Ie.lineX0,Ie.lineEndAngle=function(){return X(Ot())},delete Ie.lineX1,Ie.lineInnerRadius=function(){return X(Gt())},delete Ie.lineY0,Ie.lineOuterRadius=function(){return X(ir())},delete Ie.lineY1,Ie.curve=function(Xt){return arguments.length?lt(G(Xt)):lt()._curve},Ie}function H(Ie,lt){return[(lt=+lt)*Math.cos(Ie-=Math.PI/2),lt*Math.sin(Ie)]}U.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(Ie,lt){this._curve.point(lt*Math.sin(Ie),lt*-Math.cos(Ie))}};var Y=Array.prototype.slice;function $(Ie){return Ie.source}function z(Ie){return Ie.target}function j(Ie){var lt=$,wt=z,Ot=E,Gt=k,ir=null;function Xt(){var Kt,or=Y.call(arguments),dr=lt.apply(this,or),vr=wt.apply(this,or);if(ir||(ir=Kt=d.path()),Ie(ir,+Ot.apply(this,(or[0]=dr,or)),+Gt.apply(this,or),+Ot.apply(this,(or[0]=vr,or)),+Gt.apply(this,or)),Kt)return ir=null,Kt+""||null}return Xt.source=function(Kt){return arguments.length?(lt=Kt,Xt):lt},Xt.target=function(Kt){return arguments.length?(wt=Kt,Xt):wt},Xt.x=function(Kt){return arguments.length?(Ot=typeof Kt=="function"?Kt:m(+Kt),Xt):Ot},Xt.y=function(Kt){return arguments.length?(Gt=typeof Kt=="function"?Kt:m(+Kt),Xt):Gt},Xt.context=function(Kt){return arguments.length?(ir=Kt==null?null:Kt,Xt):ir},Xt}function W(Ie,lt,wt,Ot,Gt){Ie.moveTo(lt,wt),Ie.bezierCurveTo(lt=(lt+Ot)/2,wt,lt,Gt,Ot,Gt)}function ee(Ie,lt,wt,Ot,Gt){Ie.moveTo(lt,wt),Ie.bezierCurveTo(lt,wt=(wt+Gt)/2,Ot,wt,Ot,Gt)}function J(Ie,lt,wt,Ot,Gt){var ir=H(lt,wt),Xt=H(lt,wt=(wt+Gt)/2),Kt=H(Ot,wt),or=H(Ot,Gt);Ie.moveTo(ir[0],ir[1]),Ie.bezierCurveTo(Xt[0],Xt[1],Kt[0],Kt[1],or[0],or[1])}var Q={draw:function(Ie,lt){var wt=Math.sqrt(lt/i);Ie.moveTo(wt,0),Ie.arc(0,0,wt,0,n)}},te={draw:function(Ie,lt){var wt=Math.sqrt(lt/5)/2;Ie.moveTo(-3*wt,-wt),Ie.lineTo(-wt,-wt),Ie.lineTo(-wt,-3*wt),Ie.lineTo(wt,-3*wt),Ie.lineTo(wt,-wt),Ie.lineTo(3*wt,-wt),Ie.lineTo(3*wt,wt),Ie.lineTo(wt,wt),Ie.lineTo(wt,3*wt),Ie.lineTo(-wt,3*wt),Ie.lineTo(-wt,wt),Ie.lineTo(-3*wt,wt),Ie.closePath()}},ie=Math.sqrt(1/3),ae=2*ie,he={draw:function(Ie,lt){var wt=Math.sqrt(lt/ae),Ot=wt*ie;Ie.moveTo(0,-wt),Ie.lineTo(Ot,0),Ie.lineTo(0,wt),Ie.lineTo(-Ot,0),Ie.closePath()}},se=Math.sin(i/10)/Math.sin(7*i/10),de=Math.sin(n/10)*se,ue=-Math.cos(n/10)*se,ve={draw:function(Ie,lt){var wt=Math.sqrt(.8908130915292852*lt),Ot=de*wt,Gt=ue*wt;Ie.moveTo(0,-wt),Ie.lineTo(Ot,Gt);for(var ir=1;ir<5;++ir){var Xt=n*ir/5,Kt=Math.cos(Xt),or=Math.sin(Xt);Ie.lineTo(or*wt,-Kt*wt),Ie.lineTo(Kt*Ot-or*Gt,or*Ot+Kt*Gt)}Ie.closePath()}},ke={draw:function(Ie,lt){var wt=Math.sqrt(lt),Ot=-wt/2;Ie.rect(Ot,Ot,wt,wt)}},Ee=Math.sqrt(3),be={draw:function(Ie,lt){var wt=-Math.sqrt(lt/(3*Ee));Ie.moveTo(0,2*wt),Ie.lineTo(-Ee*wt,-wt),Ie.lineTo(Ee*wt,-wt),Ie.closePath()}},xe=-.5,ce=Math.sqrt(3)/2,ge=1/Math.sqrt(12),we=3*(ge/2+1),Me={draw:function(Ie,lt){var wt=Math.sqrt(lt/we),Ot=wt/2,Gt=wt*ge,ir=Ot,Xt=wt*ge+wt,Kt=-ir,or=Xt;Ie.moveTo(Ot,Gt),Ie.lineTo(ir,Xt),Ie.lineTo(Kt,or),Ie.lineTo(xe*Ot-ce*Gt,ce*Ot+xe*Gt),Ie.lineTo(xe*ir-ce*Xt,ce*ir+xe*Xt),Ie.lineTo(xe*Kt-ce*or,ce*Kt+xe*or),Ie.lineTo(xe*Ot+ce*Gt,xe*Gt-ce*Ot),Ie.lineTo(xe*ir+ce*Xt,xe*Xt-ce*ir),Ie.lineTo(xe*Kt+ce*or,xe*or-ce*Kt),Ie.closePath()}},Se=[Q,te,he,ke,ve,be,Me];function ze(){}function Fe(Ie,lt,wt){Ie._context.bezierCurveTo((2*Ie._x0+Ie._x1)/3,(2*Ie._y0+Ie._y1)/3,(Ie._x0+2*Ie._x1)/3,(Ie._y0+2*Ie._y1)/3,(Ie._x0+4*Ie._x1+lt)/6,(Ie._y0+4*Ie._y1+wt)/6)}function Ye(Ie){this._context=Ie}function rt(Ie){this._context=Ie}function Oe(Ie){this._context=Ie}function je(Ie,lt){this._basis=new Ye(Ie),this._beta=lt}Ye.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Fe(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,lt){switch(Ie=+Ie,lt=+lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,lt):this._context.moveTo(Ie,lt);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Fe(this,Ie,lt)}this._x0=this._x1,this._x1=Ie,this._y0=this._y1,this._y1=lt}},rt.prototype={areaStart:ze,areaEnd:ze,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(Ie,lt){switch(Ie=+Ie,lt=+lt,this._point){case 0:this._point=1,this._x2=Ie,this._y2=lt;break;case 1:this._point=2,this._x3=Ie,this._y3=lt;break;case 2:this._point=3,this._x4=Ie,this._y4=lt,this._context.moveTo((this._x0+4*this._x1+Ie)/6,(this._y0+4*this._y1+lt)/6);break;default:Fe(this,Ie,lt)}this._x0=this._x1,this._x1=Ie,this._y0=this._y1,this._y1=lt}},Oe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,lt){switch(Ie=+Ie,lt=+lt,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var wt=(this._x0+4*this._x1+Ie)/6,Ot=(this._y0+4*this._y1+lt)/6;this._line?this._context.lineTo(wt,Ot):this._context.moveTo(wt,Ot);break;case 3:this._point=4;default:Fe(this,Ie,lt)}this._x0=this._x1,this._x1=Ie,this._y0=this._y1,this._y1=lt}},je.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var Ie=this._x,lt=this._y,wt=Ie.length-1;if(wt>0)for(var Ot,Gt=Ie[0],ir=lt[0],Xt=Ie[wt]-Gt,Kt=lt[wt]-ir,or=-1;++or<=wt;)Ot=or/wt,this._basis.point(this._beta*Ie[or]+(1-this._beta)*(Gt+Ot*Xt),this._beta*lt[or]+(1-this._beta)*(ir+Ot*Kt));this._x=this._y=null,this._basis.lineEnd()},point:function(Ie,lt){this._x.push(+Ie),this._y.push(+lt)}};var We=function Ie(lt){function wt(Ot){return lt===1?new Ye(Ot):new je(Ot,lt)}return wt.beta=function(Ot){return Ie(+Ot)},wt}(.85);function qe(Ie,lt,wt){Ie._context.bezierCurveTo(Ie._x1+Ie._k*(Ie._x2-Ie._x0),Ie._y1+Ie._k*(Ie._y2-Ie._y0),Ie._x2+Ie._k*(Ie._x1-lt),Ie._y2+Ie._k*(Ie._y1-wt),Ie._x2,Ie._y2)}function et(Ie,lt){this._context=Ie,this._k=(1-lt)/6}et.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:qe(this,this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,lt){switch(Ie=+Ie,lt=+lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,lt):this._context.moveTo(Ie,lt);break;case 1:this._point=2,this._x1=Ie,this._y1=lt;break;case 2:this._point=3;default:qe(this,Ie,lt)}this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var st=function Ie(lt){function wt(Ot){return new et(Ot,lt)}return wt.tension=function(Ot){return Ie(+Ot)},wt}(0);function ct(Ie,lt){this._context=Ie,this._k=(1-lt)/6}ct.prototype={areaStart:ze,areaEnd:ze,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ie,lt){switch(Ie=+Ie,lt=+lt,this._point){case 0:this._point=1,this._x3=Ie,this._y3=lt;break;case 1:this._point=2,this._context.moveTo(this._x4=Ie,this._y4=lt);break;case 2:this._point=3,this._x5=Ie,this._y5=lt;break;default:qe(this,Ie,lt)}this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var Pt=function Ie(lt){function wt(Ot){return new ct(Ot,lt)}return wt.tension=function(Ot){return Ie(+Ot)},wt}(0);function kt(Ie,lt){this._context=Ie,this._k=(1-lt)/6}kt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,lt){switch(Ie=+Ie,lt=+lt,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:qe(this,Ie,lt)}this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var at=function Ie(lt){function wt(Ot){return new kt(Ot,lt)}return wt.tension=function(Ot){return Ie(+Ot)},wt}(0);function tt(Ie,lt,wt){var Ot=Ie._x1,Gt=Ie._y1,ir=Ie._x2,Xt=Ie._y2;if(Ie._l01_a>1e-12){var Kt=2*Ie._l01_2a+3*Ie._l01_a*Ie._l12_a+Ie._l12_2a,or=3*Ie._l01_a*(Ie._l01_a+Ie._l12_a);Ot=(Ot*Kt-Ie._x0*Ie._l12_2a+Ie._x2*Ie._l01_2a)/or,Gt=(Gt*Kt-Ie._y0*Ie._l12_2a+Ie._y2*Ie._l01_2a)/or}if(Ie._l23_a>1e-12){var dr=2*Ie._l23_2a+3*Ie._l23_a*Ie._l12_a+Ie._l12_2a,vr=3*Ie._l23_a*(Ie._l23_a+Ie._l12_a);ir=(ir*dr+Ie._x1*Ie._l23_2a-lt*Ie._l12_2a)/vr,Xt=(Xt*dr+Ie._y1*Ie._l23_2a-wt*Ie._l12_2a)/vr}Ie._context.bezierCurveTo(Ot,Gt,ir,Xt,Ie._x2,Ie._y2)}function _t(Ie,lt){this._context=Ie,this._alpha=lt}_t.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,lt){if(Ie=+Ie,lt=+lt,this._point){var wt=this._x2-Ie,Ot=this._y2-lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(wt*wt+Ot*Ot,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,lt):this._context.moveTo(Ie,lt);break;case 1:this._point=2;break;case 2:this._point=3;default:tt(this,Ie,lt)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var er=function Ie(lt){function wt(Ot){return lt?new _t(Ot,lt):new et(Ot,0)}return wt.alpha=function(Ot){return Ie(+Ot)},wt}(.5);function tr(Ie,lt){this._context=Ie,this._alpha=lt}tr.prototype={areaStart:ze,areaEnd:ze,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ie,lt){if(Ie=+Ie,lt=+lt,this._point){var wt=this._x2-Ie,Ot=this._y2-lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(wt*wt+Ot*Ot,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=Ie,this._y3=lt;break;case 1:this._point=2,this._context.moveTo(this._x4=Ie,this._y4=lt);break;case 2:this._point=3,this._x5=Ie,this._y5=lt;break;default:tt(this,Ie,lt)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var Ue=function Ie(lt){function wt(Ot){return lt?new tr(Ot,lt):new ct(Ot,0)}return wt.alpha=function(Ot){return Ie(+Ot)},wt}(.5);function He(Ie,lt){this._context=Ie,this._alpha=lt}He.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,lt){if(Ie=+Ie,lt=+lt,this._point){var wt=this._x2-Ie,Ot=this._y2-lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(wt*wt+Ot*Ot,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:tt(this,Ie,lt)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ie,this._y0=this._y1,this._y1=this._y2,this._y2=lt}};var Be=function Ie(lt){function wt(Ot){return lt?new He(Ot,lt):new kt(Ot,0)}return wt.alpha=function(Ot){return Ie(+Ot)},wt}(.5);function Ke(Ie){this._context=Ie}function _e(Ie){return Ie<0?-1:1}function Ce(Ie,lt,wt){var Ot=Ie._x1-Ie._x0,Gt=lt-Ie._x1,ir=(Ie._y1-Ie._y0)/(Ot||Gt<0&&-0),Xt=(wt-Ie._y1)/(Gt||Ot<0&&-0),Kt=(ir*Gt+Xt*Ot)/(Ot+Gt);return(_e(ir)+_e(Xt))*Math.min(Math.abs(ir),Math.abs(Xt),.5*Math.abs(Kt))||0}function Le(Ie,lt){var wt=Ie._x1-Ie._x0;return wt?(3*(Ie._y1-Ie._y0)/wt-lt)/2:lt}function Pe(Ie,lt,wt){var Ot=Ie._x0,Gt=Ie._y0,ir=Ie._x1,Xt=Ie._y1,Kt=(ir-Ot)/3;Ie._context.bezierCurveTo(Ot+Kt,Gt+Kt*lt,ir-Kt,Xt-Kt*wt,ir,Xt)}function Xe(Ie){this._context=Ie}function ht(Ie){this._context=new Mt(Ie)}function Mt(Ie){this._context=Ie}function pt(Ie){this._context=Ie}function Lt(Ie){var lt,wt,Ot=Ie.length-1,Gt=new Array(Ot),ir=new Array(Ot),Xt=new Array(Ot);for(Gt[0]=0,ir[0]=2,Xt[0]=Ie[0]+2*Ie[1],lt=1;lt<Ot-1;++lt)Gt[lt]=1,ir[lt]=4,Xt[lt]=4*Ie[lt]+2*Ie[lt+1];for(Gt[Ot-1]=2,ir[Ot-1]=7,Xt[Ot-1]=8*Ie[Ot-1]+Ie[Ot],lt=1;lt<Ot;++lt)wt=Gt[lt]/ir[lt-1],ir[lt]-=wt,Xt[lt]-=wt*Xt[lt-1];for(Gt[Ot-1]=Xt[Ot-1]/ir[Ot-1],lt=Ot-2;lt>=0;--lt)Gt[lt]=(Xt[lt]-Gt[lt+1])/ir[lt];for(ir[Ot-1]=(Ie[Ot]+Gt[Ot-1])/2,lt=0;lt<Ot-1;++lt)ir[lt]=2*Ie[lt+1]-Gt[lt+1];return[Gt,ir]}function vt(Ie,lt){this._context=Ie,this._t=lt}function Dt(Ie,lt){if((Gt=Ie.length)>1)for(var wt,Ot,Gt,ir=1,Xt=Ie[lt[0]],Kt=Xt.length;ir<Gt;++ir)for(Ot=Xt,Xt=Ie[lt[ir]],wt=0;wt<Kt;++wt)Xt[wt][1]+=Xt[wt][0]=isNaN(Ot[wt][1])?Ot[wt][0]:Ot[wt][1]}function xt(Ie){for(var lt=Ie.length,wt=new Array(lt);--lt>=0;)wt[lt]=lt;return wt}function it(Ie,lt){return Ie[lt]}function St(Ie){var lt=Ie.map(Nt);return xt(Ie).sort(function(wt,Ot){return lt[wt]-lt[Ot]})}function Nt(Ie){for(var lt,wt=-1,Ot=0,Gt=Ie.length,ir=-1/0;++wt<Gt;)(lt=+Ie[wt][1])>ir&&(ir=lt,Ot=wt);return Ot}function Ut(Ie){var lt=Ie.map(Qt);return xt(Ie).sort(function(wt,Ot){return lt[wt]-lt[Ot]})}function Qt(Ie){for(var lt,wt=0,Ot=-1,Gt=Ie.length;++Ot<Gt;)(lt=+Ie[Ot][1])&&(wt+=lt);return wt}Ke.prototype={areaStart:ze,areaEnd:ze,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(Ie,lt){Ie=+Ie,lt=+lt,this._point?this._context.lineTo(Ie,lt):(this._point=1,this._context.moveTo(Ie,lt))}},Xe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Pe(this,this._t0,Le(this,this._t0))}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ie,lt){var wt=NaN;if(lt=+lt,(Ie=+Ie)!==this._x1||lt!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,lt):this._context.moveTo(Ie,lt);break;case 1:this._point=2;break;case 2:this._point=3,Pe(this,Le(this,wt=Ce(this,Ie,lt)),wt);break;default:Pe(this,this._t0,wt=Ce(this,Ie,lt))}this._x0=this._x1,this._x1=Ie,this._y0=this._y1,this._y1=lt,this._t0=wt}}},(ht.prototype=Object.create(Xe.prototype)).point=function(Ie,lt){Xe.prototype.point.call(this,lt,Ie)},Mt.prototype={moveTo:function(Ie,lt){this._context.moveTo(lt,Ie)},closePath:function(){this._context.closePath()},lineTo:function(Ie,lt){this._context.lineTo(lt,Ie)},bezierCurveTo:function(Ie,lt,wt,Ot,Gt,ir){this._context.bezierCurveTo(lt,Ie,Ot,wt,ir,Gt)}},pt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var Ie=this._x,lt=this._y,wt=Ie.length;if(wt)if(this._line?this._context.lineTo(Ie[0],lt[0]):this._context.moveTo(Ie[0],lt[0]),wt===2)this._context.lineTo(Ie[1],lt[1]);else for(var Ot=Lt(Ie),Gt=Lt(lt),ir=0,Xt=1;Xt<wt;++ir,++Xt)this._context.bezierCurveTo(Ot[0][ir],Gt[0][ir],Ot[1][ir],Gt[1][ir],Ie[Xt],lt[Xt]);(this._line||this._line!==0&&wt===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(Ie,lt){this._x.push(+Ie),this._y.push(+lt)}},vt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(Ie,lt){switch(Ie=+Ie,lt=+lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ie,lt):this._context.moveTo(Ie,lt);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,lt),this._context.lineTo(Ie,lt);else{var wt=this._x*(1-this._t)+Ie*this._t;this._context.lineTo(wt,this._y),this._context.lineTo(wt,lt)}}this._x=Ie,this._y=lt}},t.arc=function(){var Ie=p,lt=y,wt=m(0),Ot=null,Gt=v,ir=b,Xt=x,Kt=null;function or(){var dr,vr,ur=+Ie.apply(this,arguments),pr=+lt.apply(this,arguments),br=Gt.apply(this,arguments)-c,Rr=ir.apply(this,arguments)-c,_r=h(Rr-br),jr=Rr>br;if(Kt||(Kt=dr=d.path()),pr<ur&&(vr=pr,pr=ur,ur=vr),pr>1e-12)if(_r>n-1e-12)Kt.moveTo(pr*f(br),pr*u(br)),Kt.arc(0,0,pr,br,Rr,!jr),ur>1e-12&&(Kt.moveTo(ur*f(Rr),ur*u(Rr)),Kt.arc(0,0,ur,Rr,br,jr));else{var $r,pn,In=br,On=Rr,Sn=br,an=Rr,Nr=_r,Pr=_r,en=Xt.apply(this,arguments)/2,tn=en>1e-12&&(Ot?+Ot.apply(this,arguments):s(ur*ur+pr*pr)),Qr=o(h(pr-ur)/2,+wt.apply(this,arguments)),rn=Qr,An=Qr;if(tn>1e-12){var En=g(tn/ur*u(en)),Bn=g(tn/pr*u(en));(Nr-=2*En)>1e-12?(Sn+=En*=jr?1:-1,an-=En):(Nr=0,Sn=an=(br+Rr)/2),(Pr-=2*Bn)>1e-12?(In+=Bn*=jr?1:-1,On-=Bn):(Pr=0,In=On=(br+Rr)/2)}var Jt=pr*f(In),It=pr*u(In),qt=ur*f(an),fr=ur*u(an);if(Qr>1e-12){var Tr,Gr=pr*f(On),Vr=pr*u(On),xr=ur*f(Sn),wr=ur*u(Sn);if(_r<i&&(Tr=T(Jt,It,xr,wr,Gr,Vr,qt,fr))){var Sr=Jt-Tr[0],Mr=It-Tr[1],Ir=Gr-Tr[0],qr=Vr-Tr[1],cn=1/u(a((Sr*Ir+Mr*qr)/(s(Sr*Sr+Mr*Mr)*s(Ir*Ir+qr*qr)))/2),_n=s(Tr[0]*Tr[0]+Tr[1]*Tr[1]);rn=o(Qr,(ur-_n)/(cn-1)),An=o(Qr,(pr-_n)/(cn+1))}}Pr>1e-12?An>1e-12?($r=A(xr,wr,Jt,It,pr,An,jr),pn=A(Gr,Vr,qt,fr,pr,An,jr),Kt.moveTo($r.cx+$r.x01,$r.cy+$r.y01),An<Qr?Kt.arc($r.cx,$r.cy,An,e($r.y01,$r.x01),e(pn.y01,pn.x01),!jr):(Kt.arc($r.cx,$r.cy,An,e($r.y01,$r.x01),e($r.y11,$r.x11),!jr),Kt.arc(0,0,pr,e($r.cy+$r.y11,$r.cx+$r.x11),e(pn.cy+pn.y11,pn.cx+pn.x11),!jr),Kt.arc(pn.cx,pn.cy,An,e(pn.y11,pn.x11),e(pn.y01,pn.x01),!jr))):(Kt.moveTo(Jt,It),Kt.arc(0,0,pr,In,On,!jr)):Kt.moveTo(Jt,It),ur>1e-12&&Nr>1e-12?rn>1e-12?($r=A(qt,fr,Gr,Vr,ur,-rn,jr),pn=A(Jt,It,xr,wr,ur,-rn,jr),Kt.lineTo($r.cx+$r.x01,$r.cy+$r.y01),rn<Qr?Kt.arc($r.cx,$r.cy,rn,e($r.y01,$r.x01),e(pn.y01,pn.x01),!jr):(Kt.arc($r.cx,$r.cy,rn,e($r.y01,$r.x01),e($r.y11,$r.x11),!jr),Kt.arc(0,0,ur,e($r.cy+$r.y11,$r.cx+$r.x11),e(pn.cy+pn.y11,pn.cx+pn.x11),jr),Kt.arc(pn.cx,pn.cy,rn,e(pn.y11,pn.x11),e(pn.y01,pn.x01),!jr))):Kt.arc(0,0,ur,an,Sn,jr):Kt.lineTo(qt,fr)}else Kt.moveTo(0,0);if(Kt.closePath(),dr)return Kt=null,dr+""||null}return or.centroid=function(){var dr=(+Ie.apply(this,arguments)+ +lt.apply(this,arguments))/2,vr=(+Gt.apply(this,arguments)+ +ir.apply(this,arguments))/2-i/2;return[f(vr)*dr,u(vr)*dr]},or.innerRadius=function(dr){return arguments.length?(Ie=typeof dr=="function"?dr:m(+dr),or):Ie},or.outerRadius=function(dr){return arguments.length?(lt=typeof dr=="function"?dr:m(+dr),or):lt},or.cornerRadius=function(dr){return arguments.length?(wt=typeof dr=="function"?dr:m(+dr),or):wt},or.padRadius=function(dr){return arguments.length?(Ot=dr==null?null:typeof dr=="function"?dr:m(+dr),or):Ot},or.startAngle=function(dr){return arguments.length?(Gt=typeof dr=="function"?dr:m(+dr),or):Gt},or.endAngle=function(dr){return arguments.length?(ir=typeof dr=="function"?dr:m(+dr),or):ir},or.padAngle=function(dr){return arguments.length?(Xt=typeof dr=="function"?dr:m(+dr),or):Xt},or.context=function(dr){return arguments.length?(Kt=dr==null?null:dr,or):Kt},or},t.area=M,t.areaRadial=Z,t.curveBasis=function(Ie){return new Ye(Ie)},t.curveBasisClosed=function(Ie){return new rt(Ie)},t.curveBasisOpen=function(Ie){return new Oe(Ie)},t.curveBundle=We,t.curveCardinal=st,t.curveCardinalClosed=Pt,t.curveCardinalOpen=at,t.curveCatmullRom=er,t.curveCatmullRomClosed=Ue,t.curveCatmullRomOpen=Be,t.curveLinear=w,t.curveLinearClosed=function(Ie){return new Ke(Ie)},t.curveMonotoneX=function(Ie){return new Xe(Ie)},t.curveMonotoneY=function(Ie){return new ht(Ie)},t.curveNatural=function(Ie){return new pt(Ie)},t.curveStep=function(Ie){return new vt(Ie,.5)},t.curveStepAfter=function(Ie){return new vt(Ie,1)},t.curveStepBefore=function(Ie){return new vt(Ie,0)},t.line=L,t.lineRadial=K,t.linkHorizontal=function(){return j(W)},t.linkRadial=function(){var Ie=j(J);return Ie.angle=Ie.x,delete Ie.x,Ie.radius=Ie.y,delete Ie.y,Ie},t.linkVertical=function(){return j(ee)},t.pie=function(){var Ie=D,lt=P,wt=null,Ot=m(0),Gt=m(n),ir=m(0);function Xt(Kt){var or,dr,vr,ur,pr,br=Kt.length,Rr=0,_r=new Array(br),jr=new Array(br),$r=+Ot.apply(this,arguments),pn=Math.min(n,Math.max(-n,Gt.apply(this,arguments)-$r)),In=Math.min(Math.abs(pn)/br,ir.apply(this,arguments)),On=In*(pn<0?-1:1);for(or=0;or<br;++or)(pr=jr[_r[or]=or]=+Ie(Kt[or],or,Kt))>0&&(Rr+=pr);for(lt!=null?_r.sort(function(Sn,an){return lt(jr[Sn],jr[an])}):wt!=null&&_r.sort(function(Sn,an){return wt(Kt[Sn],Kt[an])}),or=0,vr=Rr?(pn-br*On)/Rr:0;or<br;++or,$r=ur)dr=_r[or],ur=$r+((pr=jr[dr])>0?pr*vr:0)+On,jr[dr]={data:Kt[dr],index:or,value:pr,startAngle:$r,endAngle:ur,padAngle:In};return jr}return Xt.value=function(Kt){return arguments.length?(Ie=typeof Kt=="function"?Kt:m(+Kt),Xt):Ie},Xt.sortValues=function(Kt){return arguments.length?(lt=Kt,wt=null,Xt):lt},Xt.sort=function(Kt){return arguments.length?(wt=Kt,lt=null,Xt):wt},Xt.startAngle=function(Kt){return arguments.length?(Ot=typeof Kt=="function"?Kt:m(+Kt),Xt):Ot},Xt.endAngle=function(Kt){return arguments.length?(Gt=typeof Kt=="function"?Kt:m(+Kt),Xt):Gt},Xt.padAngle=function(Kt){return arguments.length?(ir=typeof Kt=="function"?Kt:m(+Kt),Xt):ir},Xt},t.pointRadial=H,t.radialArea=Z,t.radialLine=K,t.stack=function(){var Ie=m([]),lt=xt,wt=Dt,Ot=it;function Gt(ir){var Xt,Kt,or=Ie.apply(this,arguments),dr=ir.length,vr=or.length,ur=new Array(vr);for(Xt=0;Xt<vr;++Xt){for(var pr,br=or[Xt],Rr=ur[Xt]=new Array(dr),_r=0;_r<dr;++_r)Rr[_r]=pr=[0,+Ot(ir[_r],br,_r,ir)],pr.data=ir[_r];Rr.key=br}for(Xt=0,Kt=lt(ur);Xt<vr;++Xt)ur[Kt[Xt]].index=Xt;return wt(ur,Kt),ur}return Gt.keys=function(ir){return arguments.length?(Ie=typeof ir=="function"?ir:m(Y.call(ir)),Gt):Ie},Gt.value=function(ir){return arguments.length?(Ot=typeof ir=="function"?ir:m(+ir),Gt):Ot},Gt.order=function(ir){return arguments.length?(lt=ir==null?xt:typeof ir=="function"?ir:m(Y.call(ir)),Gt):lt},Gt.offset=function(ir){return arguments.length?(wt=ir==null?Dt:ir,Gt):wt},Gt},t.stackOffsetDiverging=function(Ie,lt){if((Kt=Ie.length)>0)for(var wt,Ot,Gt,ir,Xt,Kt,or=0,dr=Ie[lt[0]].length;or<dr;++or)for(ir=Xt=0,wt=0;wt<Kt;++wt)(Gt=(Ot=Ie[lt[wt]][or])[1]-Ot[0])>0?(Ot[0]=ir,Ot[1]=ir+=Gt):Gt<0?(Ot[1]=Xt,Ot[0]=Xt+=Gt):(Ot[0]=0,Ot[1]=Gt)},t.stackOffsetExpand=function(Ie,lt){if((Ot=Ie.length)>0){for(var wt,Ot,Gt,ir=0,Xt=Ie[0].length;ir<Xt;++ir){for(Gt=wt=0;wt<Ot;++wt)Gt+=Ie[wt][ir][1]||0;if(Gt)for(wt=0;wt<Ot;++wt)Ie[wt][ir][1]/=Gt}Dt(Ie,lt)}},t.stackOffsetNone=Dt,t.stackOffsetSilhouette=function(Ie,lt){if((wt=Ie.length)>0){for(var wt,Ot=0,Gt=Ie[lt[0]],ir=Gt.length;Ot<ir;++Ot){for(var Xt=0,Kt=0;Xt<wt;++Xt)Kt+=Ie[Xt][Ot][1]||0;Gt[Ot][1]+=Gt[Ot][0]=-Kt/2}Dt(Ie,lt)}},t.stackOffsetWiggle=function(Ie,lt){if((Gt=Ie.length)>0&&(Ot=(wt=Ie[lt[0]]).length)>0){for(var wt,Ot,Gt,ir=0,Xt=1;Xt<Ot;++Xt){for(var Kt=0,or=0,dr=0;Kt<Gt;++Kt){for(var vr=Ie[lt[Kt]],ur=vr[Xt][1]||0,pr=(ur-(vr[Xt-1][1]||0))/2,br=0;br<Kt;++br){var Rr=Ie[lt[br]];pr+=(Rr[Xt][1]||0)-(Rr[Xt-1][1]||0)}or+=ur,dr+=pr*ur}wt[Xt-1][1]+=wt[Xt-1][0]=ir,or&&(ir-=dr/or)}wt[Xt-1][1]+=wt[Xt-1][0]=ir,Dt(Ie,lt)}},t.stackOrderAppearance=St,t.stackOrderAscending=Ut,t.stackOrderDescending=function(Ie){return Ut(Ie).reverse()},t.stackOrderInsideOut=function(Ie){var lt,wt,Ot=Ie.length,Gt=Ie.map(Qt),ir=St(Ie),Xt=0,Kt=0,or=[],dr=[];for(lt=0;lt<Ot;++lt)wt=ir[lt],Xt<Kt?(Xt+=Gt[wt],or.push(wt)):(Kt+=Gt[wt],dr.push(wt));return dr.reverse().concat(or)},t.stackOrderNone=xt,t.stackOrderReverse=function(Ie){return xt(Ie).reverse()},t.symbol=function(){var Ie=m(Q),lt=m(64),wt=null;function Ot(){var Gt;if(wt||(wt=Gt=d.path()),Ie.apply(this,arguments).draw(wt,+lt.apply(this,arguments)),Gt)return wt=null,Gt+""||null}return Ot.type=function(Gt){return arguments.length?(Ie=typeof Gt=="function"?Gt:m(Gt),Ot):Ie},Ot.size=function(Gt){return arguments.length?(lt=typeof Gt=="function"?Gt:m(+Gt),Ot):lt},Ot.context=function(Gt){return arguments.length?(wt=Gt==null?null:Gt,Ot):wt},Ot},t.symbolCircle=Q,t.symbolCross=te,t.symbolDiamond=he,t.symbolSquare=ke,t.symbolStar=ve,t.symbolTriangle=be,t.symbolWye=Me,t.symbols=Se,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-path":169}],172:[function(r,I,B){(function(t,d){typeof B=="object"&&I!==void 0?d(B,r("d3-time")):d((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,d){function m(at){if(0<=at.y&&at.y<100){var tt=new Date(-1,at.m,at.d,at.H,at.M,at.S,at.L);return tt.setFullYear(at.y),tt}return new Date(at.y,at.m,at.d,at.H,at.M,at.S,at.L)}function h(at){if(0<=at.y&&at.y<100){var tt=new Date(Date.UTC(-1,at.m,at.d,at.H,at.M,at.S,at.L));return tt.setUTCFullYear(at.y),tt}return new Date(Date.UTC(at.y,at.m,at.d,at.H,at.M,at.S,at.L))}function e(at,tt,_t){return{y:at,m:tt,d:_t,H:0,M:0,S:0,L:0}}function f(at){var tt=at.dateTime,_t=at.date,er=at.time,tr=at.periods,Ue=at.days,He=at.shortDays,Be=at.months,Ke=at.shortMonths,_e=a(tr),Ce=g(tr),Le=a(Ue),Pe=g(Ue),Xe=a(He),ht=g(He),Mt=a(Be),pt=g(Be),Lt=a(Ke),vt=g(Ke),Dt={a:function(Qt){return He[Qt.getDay()]},A:function(Qt){return Ue[Qt.getDay()]},b:function(Qt){return Ke[Qt.getMonth()]},B:function(Qt){return Be[Qt.getMonth()]},c:null,d:Z,e:Z,f:j,H,I:Y,j:$,L:z,m:W,M:ee,p:function(Qt){return tr[+(Qt.getHours()>=12)]},q:function(Qt){return 1+~~(Qt.getMonth()/3)},Q:et,s:st,S:J,u:Q,U:te,V:ie,w:ae,W:he,x:null,X:null,y:se,Y:de,Z:ue,"%":qe},xt={a:function(Qt){return He[Qt.getUTCDay()]},A:function(Qt){return Ue[Qt.getUTCDay()]},b:function(Qt){return Ke[Qt.getUTCMonth()]},B:function(Qt){return Be[Qt.getUTCMonth()]},c:null,d:ve,e:ve,f:ce,H:ke,I:Ee,j:be,L:xe,m:ge,M:we,p:function(Qt){return tr[+(Qt.getUTCHours()>=12)]},q:function(Qt){return 1+~~(Qt.getUTCMonth()/3)},Q:et,s:st,S:Me,u:Se,U:ze,V:Fe,w:Ye,W:rt,x:null,X:null,y:Oe,Y:je,Z:We,"%":qe},it={a:function(Qt,Ie,lt){var wt=Xe.exec(Ie.slice(lt));return wt?(Qt.w=ht[wt[0].toLowerCase()],lt+wt[0].length):-1},A:function(Qt,Ie,lt){var wt=Le.exec(Ie.slice(lt));return wt?(Qt.w=Pe[wt[0].toLowerCase()],lt+wt[0].length):-1},b:function(Qt,Ie,lt){var wt=Lt.exec(Ie.slice(lt));return wt?(Qt.m=vt[wt[0].toLowerCase()],lt+wt[0].length):-1},B:function(Qt,Ie,lt){var wt=Mt.exec(Ie.slice(lt));return wt?(Qt.m=pt[wt[0].toLowerCase()],lt+wt[0].length):-1},c:function(Qt,Ie,lt){return Ut(Qt,tt,Ie,lt)},d:k,e:k,f:U,H:M,I:M,j:L,L:N,m:E,M:P,p:function(Qt,Ie,lt){var wt=_e.exec(Ie.slice(lt));return wt?(Qt.p=Ce[wt[0].toLowerCase()],lt+wt[0].length):-1},q:w,Q:X,s:K,S:D,u:y,U:v,V:b,w:p,W:x,x:function(Qt,Ie,lt){return Ut(Qt,_t,Ie,lt)},X:function(Qt,Ie,lt){return Ut(Qt,er,Ie,lt)},y:A,Y:T,Z:S,"%":G};function St(Qt,Ie){return function(lt){var wt,Ot,Gt,ir=[],Xt=-1,Kt=0,or=Qt.length;for(lt instanceof Date||(lt=new Date(+lt));++Xt<or;)Qt.charCodeAt(Xt)===37&&(ir.push(Qt.slice(Kt,Xt)),(Ot=o[wt=Qt.charAt(++Xt)])!=null?wt=Qt.charAt(++Xt):Ot=wt==="e"?" ":"0",(Gt=Ie[wt])&&(wt=Gt(lt,Ot)),ir.push(wt),Kt=Xt+1);return ir.push(Qt.slice(Kt,Xt)),ir.join("")}}function Nt(Qt,Ie){return function(lt){var wt,Ot,Gt=e(1900,void 0,1);if(Ut(Gt,Qt,lt+="",0)!=lt.length)return null;if("Q"in Gt)return new Date(Gt.Q);if("s"in Gt)return new Date(1e3*Gt.s+("L"in Gt?Gt.L:0));if(Ie&&!("Z"in Gt)&&(Gt.Z=0),"p"in Gt&&(Gt.H=Gt.H%12+12*Gt.p),Gt.m===void 0&&(Gt.m="q"in Gt?Gt.q:0),"V"in Gt){if(Gt.V<1||Gt.V>53)return null;"w"in Gt||(Gt.w=1),"Z"in Gt?(Ot=(wt=h(e(Gt.y,0,1))).getUTCDay(),wt=Ot>4||Ot===0?d.utcMonday.ceil(wt):d.utcMonday(wt),wt=d.utcDay.offset(wt,7*(Gt.V-1)),Gt.y=wt.getUTCFullYear(),Gt.m=wt.getUTCMonth(),Gt.d=wt.getUTCDate()+(Gt.w+6)%7):(Ot=(wt=m(e(Gt.y,0,1))).getDay(),wt=Ot>4||Ot===0?d.timeMonday.ceil(wt):d.timeMonday(wt),wt=d.timeDay.offset(wt,7*(Gt.V-1)),Gt.y=wt.getFullYear(),Gt.m=wt.getMonth(),Gt.d=wt.getDate()+(Gt.w+6)%7)}else("W"in Gt||"U"in Gt)&&("w"in Gt||(Gt.w="u"in Gt?Gt.u%7:"W"in Gt?1:0),Ot="Z"in Gt?h(e(Gt.y,0,1)).getUTCDay():m(e(Gt.y,0,1)).getDay(),Gt.m=0,Gt.d="W"in Gt?(Gt.w+6)%7+7*Gt.W-(Ot+5)%7:Gt.w+7*Gt.U-(Ot+6)%7);return"Z"in Gt?(Gt.H+=Gt.Z/100|0,Gt.M+=Gt.Z%100,h(Gt)):m(Gt)}}function Ut(Qt,Ie,lt,wt){for(var Ot,Gt,ir=0,Xt=Ie.length,Kt=lt.length;ir<Xt;){if(wt>=Kt)return-1;if((Ot=Ie.charCodeAt(ir++))===37){if(Ot=Ie.charAt(ir++),!(Gt=it[Ot in o?Ie.charAt(ir++):Ot])||(wt=Gt(Qt,lt,wt))<0)return-1}else if(Ot!=lt.charCodeAt(wt++))return-1}return wt}return Dt.x=St(_t,Dt),Dt.X=St(er,Dt),Dt.c=St(tt,Dt),xt.x=St(_t,xt),xt.X=St(er,xt),xt.c=St(tt,xt),{format:function(Qt){var Ie=St(Qt+="",Dt);return Ie.toString=function(){return Qt},Ie},parse:function(Qt){var Ie=Nt(Qt+="",!1);return Ie.toString=function(){return Qt},Ie},utcFormat:function(Qt){var Ie=St(Qt+="",xt);return Ie.toString=function(){return Qt},Ie},utcParse:function(Qt){var Ie=Nt(Qt+="",!0);return Ie.toString=function(){return Qt},Ie}}}var l,o={"-":"",_:" ",0:"0"},u=/^\s*\d+/,s=/^%/,i=/[\\^$*+?|[\]().{}]/g;function c(at,tt,_t){var er=at<0?"-":"",tr=(er?-at:at)+"",Ue=tr.length;return er+(Ue<_t?new Array(_t-Ue+1).join(tt)+tr:tr)}function n(at){return at.replace(i,"\\$&")}function a(at){return new RegExp("^(?:"+at.map(n).join("|")+")","i")}function g(at){for(var tt={},_t=-1,er=at.length;++_t<er;)tt[at[_t].toLowerCase()]=_t;return tt}function p(at,tt,_t){var er=u.exec(tt.slice(_t,_t+1));return er?(at.w=+er[0],_t+er[0].length):-1}function y(at,tt,_t){var er=u.exec(tt.slice(_t,_t+1));return er?(at.u=+er[0],_t+er[0].length):-1}function v(at,tt,_t){var er=u.exec(tt.slice(_t,_t+2));return er?(at.U=+er[0],_t+er[0].length):-1}function b(at,tt,_t){var er=u.exec(tt.slice(_t,_t+2));return er?(at.V=+er[0],_t+er[0].length):-1}function x(at,tt,_t){var er=u.exec(tt.slice(_t,_t+2));return er?(at.W=+er[0],_t+er[0].length):-1}function T(at,tt,_t){var er=u.exec(tt.slice(_t,_t+4));return er?(at.y=+er[0],_t+er[0].length):-1}function A(at,tt,_t){var er=u.exec(tt.slice(_t,_t+2));return er?(at.y=+er[0]+(+er[0]>68?1900:2e3),_t+er[0].length):-1}function S(at,tt,_t){var er=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(tt.slice(_t,_t+6));return er?(at.Z=er[1]?0:-(er[2]+(er[3]||"00")),_t+er[0].length):-1}function w(at,tt,_t){var er=u.exec(tt.slice(_t,_t+1));return er?(at.q=3*er[0]-3,_t+er[0].length):-1}function E(at,tt,_t){var er=u.exec(tt.slice(_t,_t+2));return er?(at.m=er[0]-1,_t+er[0].length):-1}function k(at,tt,_t){var er=u.exec(tt.slice(_t,_t+2));return er?(at.d=+er[0],_t+er[0].length):-1}function L(at,tt,_t){var er=u.exec(tt.slice(_t,_t+3));return er?(at.m=0,at.d=+er[0],_t+er[0].length):-1}function M(at,tt,_t){var er=u.exec(tt.slice(_t,_t+2));return er?(at.H=+er[0],_t+er[0].length):-1}function P(at,tt,_t){var er=u.exec(tt.slice(_t,_t+2));return er?(at.M=+er[0],_t+er[0].length):-1}function D(at,tt,_t){var er=u.exec(tt.slice(_t,_t+2));return er?(at.S=+er[0],_t+er[0].length):-1}function N(at,tt,_t){var er=u.exec(tt.slice(_t,_t+3));return er?(at.L=+er[0],_t+er[0].length):-1}function U(at,tt,_t){var er=u.exec(tt.slice(_t,_t+6));return er?(at.L=Math.floor(er[0]/1e3),_t+er[0].length):-1}function G(at,tt,_t){var er=s.exec(tt.slice(_t,_t+1));return er?_t+er[0].length:-1}function X(at,tt,_t){var er=u.exec(tt.slice(_t));return er?(at.Q=+er[0],_t+er[0].length):-1}function K(at,tt,_t){var er=u.exec(tt.slice(_t));return er?(at.s=+er[0],_t+er[0].length):-1}function Z(at,tt){return c(at.getDate(),tt,2)}function H(at,tt){return c(at.getHours(),tt,2)}function Y(at,tt){return c(at.getHours()%12||12,tt,2)}function $(at,tt){return c(1+d.timeDay.count(d.timeYear(at),at),tt,3)}function z(at,tt){return c(at.getMilliseconds(),tt,3)}function j(at,tt){return z(at,tt)+"000"}function W(at,tt){return c(at.getMonth()+1,tt,2)}function ee(at,tt){return c(at.getMinutes(),tt,2)}function J(at,tt){return c(at.getSeconds(),tt,2)}function Q(at){var tt=at.getDay();return tt===0?7:tt}function te(at,tt){return c(d.timeSunday.count(d.timeYear(at)-1,at),tt,2)}function ie(at,tt){var _t=at.getDay();return at=_t>=4||_t===0?d.timeThursday(at):d.timeThursday.ceil(at),c(d.timeThursday.count(d.timeYear(at),at)+(d.timeYear(at).getDay()===4),tt,2)}function ae(at){return at.getDay()}function he(at,tt){return c(d.timeMonday.count(d.timeYear(at)-1,at),tt,2)}function se(at,tt){return c(at.getFullYear()%100,tt,2)}function de(at,tt){return c(at.getFullYear()%1e4,tt,4)}function ue(at){var tt=at.getTimezoneOffset();return(tt>0?"-":(tt*=-1,"+"))+c(tt/60|0,"0",2)+c(tt%60,"0",2)}function ve(at,tt){return c(at.getUTCDate(),tt,2)}function ke(at,tt){return c(at.getUTCHours(),tt,2)}function Ee(at,tt){return c(at.getUTCHours()%12||12,tt,2)}function be(at,tt){return c(1+d.utcDay.count(d.utcYear(at),at),tt,3)}function xe(at,tt){return c(at.getUTCMilliseconds(),tt,3)}function ce(at,tt){return xe(at,tt)+"000"}function ge(at,tt){return c(at.getUTCMonth()+1,tt,2)}function we(at,tt){return c(at.getUTCMinutes(),tt,2)}function Me(at,tt){return c(at.getUTCSeconds(),tt,2)}function Se(at){var tt=at.getUTCDay();return tt===0?7:tt}function ze(at,tt){return c(d.utcSunday.count(d.utcYear(at)-1,at),tt,2)}function Fe(at,tt){var _t=at.getUTCDay();return at=_t>=4||_t===0?d.utcThursday(at):d.utcThursday.ceil(at),c(d.utcThursday.count(d.utcYear(at),at)+(d.utcYear(at).getUTCDay()===4),tt,2)}function Ye(at){return at.getUTCDay()}function rt(at,tt){return c(d.utcMonday.count(d.utcYear(at)-1,at),tt,2)}function Oe(at,tt){return c(at.getUTCFullYear()%100,tt,2)}function je(at,tt){return c(at.getUTCFullYear()%1e4,tt,4)}function We(){return"+0000"}function qe(){return"%"}function et(at){return+at}function st(at){return Math.floor(+at/1e3)}function ct(at){return l=f(at),t.timeFormat=l.format,t.timeParse=l.parse,t.utcFormat=l.utcFormat,t.utcParse=l.utcParse,l}ct({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Pt=Date.prototype.toISOString?function(at){return at.toISOString()}:t.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),kt=+new Date("2000-01-01T00:00:00.000Z")?function(at){var tt=new Date(at);return isNaN(tt)?null:tt}:t.utcParse("%Y-%m-%dT%H:%M:%S.%LZ");t.isoFormat=Pt,t.isoParse=kt,t.timeFormatDefaultLocale=ct,t.timeFormatLocale=f,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-time":173}],173:[function(r,I,B){(function(t,d){d(typeof B=="object"&&I!==void 0?B:(t=t||self).d3=t.d3||{})})(this,function(t){var d=new Date,m=new Date;function h(ge,we,Me,Se){function ze(Fe){return ge(Fe=arguments.length===0?new Date:new Date(+Fe)),Fe}return ze.floor=function(Fe){return ge(Fe=new Date(+Fe)),Fe},ze.ceil=function(Fe){return ge(Fe=new Date(Fe-1)),we(Fe,1),ge(Fe),Fe},ze.round=function(Fe){var Ye=ze(Fe),rt=ze.ceil(Fe);return Fe-Ye<rt-Fe?Ye:rt},ze.offset=function(Fe,Ye){return we(Fe=new Date(+Fe),Ye==null?1:Math.floor(Ye)),Fe},ze.range=function(Fe,Ye,rt){var Oe,je=[];if(Fe=ze.ceil(Fe),rt=rt==null?1:Math.floor(rt),!(Fe<Ye&&rt>0))return je;do je.push(Oe=new Date(+Fe)),we(Fe,rt),ge(Fe);while(Oe<Fe&&Fe<Ye);return je},ze.filter=function(Fe){return h(function(Ye){if(Ye>=Ye)for(;ge(Ye),!Fe(Ye);)Ye.setTime(Ye-1)},function(Ye,rt){if(Ye>=Ye)if(rt<0)for(;++rt<=0;)for(;we(Ye,-1),!Fe(Ye););else for(;--rt>=0;)for(;we(Ye,1),!Fe(Ye););})},Me&&(ze.count=function(Fe,Ye){return d.setTime(+Fe),m.setTime(+Ye),ge(d),ge(m),Math.floor(Me(d,m))},ze.every=function(Fe){return Fe=Math.floor(Fe),isFinite(Fe)&&Fe>0?Fe>1?ze.filter(Se?function(Ye){return Se(Ye)%Fe==0}:function(Ye){return ze.count(0,Ye)%Fe==0}):ze:null}),ze}var e=h(function(){},function(ge,we){ge.setTime(+ge+we)},function(ge,we){return we-ge});e.every=function(ge){return ge=Math.floor(ge),isFinite(ge)&&ge>0?ge>1?h(function(we){we.setTime(Math.floor(we/ge)*ge)},function(we,Me){we.setTime(+we+Me*ge)},function(we,Me){return(Me-we)/ge}):e:null};var f=e.range,l=h(function(ge){ge.setTime(ge-ge.getMilliseconds())},function(ge,we){ge.setTime(+ge+1e3*we)},function(ge,we){return(we-ge)/1e3},function(ge){return ge.getUTCSeconds()}),o=l.range,u=h(function(ge){ge.setTime(ge-ge.getMilliseconds()-1e3*ge.getSeconds())},function(ge,we){ge.setTime(+ge+6e4*we)},function(ge,we){return(we-ge)/6e4},function(ge){return ge.getMinutes()}),s=u.range,i=h(function(ge){ge.setTime(ge-ge.getMilliseconds()-1e3*ge.getSeconds()-6e4*ge.getMinutes())},function(ge,we){ge.setTime(+ge+36e5*we)},function(ge,we){return(we-ge)/36e5},function(ge){return ge.getHours()}),c=i.range,n=h(function(ge){ge.setHours(0,0,0,0)},function(ge,we){ge.setDate(ge.getDate()+we)},function(ge,we){return(we-ge-6e4*(we.getTimezoneOffset()-ge.getTimezoneOffset()))/864e5},function(ge){return ge.getDate()-1}),a=n.range;function g(ge){return h(function(we){we.setDate(we.getDate()-(we.getDay()+7-ge)%7),we.setHours(0,0,0,0)},function(we,Me){we.setDate(we.getDate()+7*Me)},function(we,Me){return(Me-we-6e4*(Me.getTimezoneOffset()-we.getTimezoneOffset()))/6048e5})}var p=g(0),y=g(1),v=g(2),b=g(3),x=g(4),T=g(5),A=g(6),S=p.range,w=y.range,E=v.range,k=b.range,L=x.range,M=T.range,P=A.range,D=h(function(ge){ge.setDate(1),ge.setHours(0,0,0,0)},function(ge,we){ge.setMonth(ge.getMonth()+we)},function(ge,we){return we.getMonth()-ge.getMonth()+12*(we.getFullYear()-ge.getFullYear())},function(ge){return ge.getMonth()}),N=D.range,U=h(function(ge){ge.setMonth(0,1),ge.setHours(0,0,0,0)},function(ge,we){ge.setFullYear(ge.getFullYear()+we)},function(ge,we){return we.getFullYear()-ge.getFullYear()},function(ge){return ge.getFullYear()});U.every=function(ge){return isFinite(ge=Math.floor(ge))&&ge>0?h(function(we){we.setFullYear(Math.floor(we.getFullYear()/ge)*ge),we.setMonth(0,1),we.setHours(0,0,0,0)},function(we,Me){we.setFullYear(we.getFullYear()+Me*ge)}):null};var G=U.range,X=h(function(ge){ge.setUTCSeconds(0,0)},function(ge,we){ge.setTime(+ge+6e4*we)},function(ge,we){return(we-ge)/6e4},function(ge){return ge.getUTCMinutes()}),K=X.range,Z=h(function(ge){ge.setUTCMinutes(0,0,0)},function(ge,we){ge.setTime(+ge+36e5*we)},function(ge,we){return(we-ge)/36e5},function(ge){return ge.getUTCHours()}),H=Z.range,Y=h(function(ge){ge.setUTCHours(0,0,0,0)},function(ge,we){ge.setUTCDate(ge.getUTCDate()+we)},function(ge,we){return(we-ge)/864e5},function(ge){return ge.getUTCDate()-1}),$=Y.range;function z(ge){return h(function(we){we.setUTCDate(we.getUTCDate()-(we.getUTCDay()+7-ge)%7),we.setUTCHours(0,0,0,0)},function(we,Me){we.setUTCDate(we.getUTCDate()+7*Me)},function(we,Me){return(Me-we)/6048e5})}var j=z(0),W=z(1),ee=z(2),J=z(3),Q=z(4),te=z(5),ie=z(6),ae=j.range,he=W.range,se=ee.range,de=J.range,ue=Q.range,ve=te.range,ke=ie.range,Ee=h(function(ge){ge.setUTCDate(1),ge.setUTCHours(0,0,0,0)},function(ge,we){ge.setUTCMonth(ge.getUTCMonth()+we)},function(ge,we){return we.getUTCMonth()-ge.getUTCMonth()+12*(we.getUTCFullYear()-ge.getUTCFullYear())},function(ge){return ge.getUTCMonth()}),be=Ee.range,xe=h(function(ge){ge.setUTCMonth(0,1),ge.setUTCHours(0,0,0,0)},function(ge,we){ge.setUTCFullYear(ge.getUTCFullYear()+we)},function(ge,we){return we.getUTCFullYear()-ge.getUTCFullYear()},function(ge){return ge.getUTCFullYear()});xe.every=function(ge){return isFinite(ge=Math.floor(ge))&&ge>0?h(function(we){we.setUTCFullYear(Math.floor(we.getUTCFullYear()/ge)*ge),we.setUTCMonth(0,1),we.setUTCHours(0,0,0,0)},function(we,Me){we.setUTCFullYear(we.getUTCFullYear()+Me*ge)}):null};var ce=xe.range;t.timeDay=n,t.timeDays=a,t.timeFriday=T,t.timeFridays=M,t.timeHour=i,t.timeHours=c,t.timeInterval=h,t.timeMillisecond=e,t.timeMilliseconds=f,t.timeMinute=u,t.timeMinutes=s,t.timeMonday=y,t.timeMondays=w,t.timeMonth=D,t.timeMonths=N,t.timeSaturday=A,t.timeSaturdays=P,t.timeSecond=l,t.timeSeconds=o,t.timeSunday=p,t.timeSundays=S,t.timeThursday=x,t.timeThursdays=L,t.timeTuesday=v,t.timeTuesdays=E,t.timeWednesday=b,t.timeWednesdays=k,t.timeWeek=p,t.timeWeeks=S,t.timeYear=U,t.timeYears=G,t.utcDay=Y,t.utcDays=$,t.utcFriday=te,t.utcFridays=ve,t.utcHour=Z,t.utcHours=H,t.utcMillisecond=e,t.utcMilliseconds=f,t.utcMinute=X,t.utcMinutes=K,t.utcMonday=W,t.utcMondays=he,t.utcMonth=Ee,t.utcMonths=be,t.utcSaturday=ie,t.utcSaturdays=ke,t.utcSecond=l,t.utcSeconds=o,t.utcSunday=j,t.utcSundays=ae,t.utcThursday=Q,t.utcThursdays=ue,t.utcTuesday=ee,t.utcTuesdays=se,t.utcWednesday=J,t.utcWednesdays=de,t.utcWeek=j,t.utcWeeks=ae,t.utcYear=xe,t.utcYears=ce,Object.defineProperty(t,"__esModule",{value:!0})})},{}],174:[function(r,I,B){arguments[4][173][0].apply(B,arguments)},{dup:173}],175:[function(r,I,B){(function(t,d){d(typeof B=="object"&&I!==void 0?B:(t=t||self).d3=t.d3||{})})(this,function(t){var d,m,h=0,e=0,f=0,l=0,o=0,u=0,s=typeof performance=="object"&&performance.now?performance:Date,i=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(x){setTimeout(x,17)};function c(){return o||(i(n),o=s.now()+u)}function n(){o=0}function a(){this._call=this._time=this._next=null}function g(x,T,A){var S=new a;return S.restart(x,T,A),S}function p(){c(),++h;for(var x,T=d;T;)(x=o-T._time)>=0&&T._call.call(null,x),T=T._next;--h}function y(){o=(l=s.now())+u,h=e=0;try{p()}finally{h=0,function(){for(var x,T,A=d,S=1/0;A;)A._call?(S>A._time&&(S=A._time),x=A,A=A._next):(T=A._next,A._next=null,A=x?x._next=T:d=T);m=x,b(S)}(),o=0}}function v(){var x=s.now(),T=x-l;T>1e3&&(u-=T,l=x)}function b(x){h||(e&&(e=clearTimeout(e)),x-o>24?(x<1/0&&(e=setTimeout(y,x-s.now()-u)),f&&(f=clearInterval(f))):(f||(l=s.now(),f=setInterval(v,1e3)),h=1,i(y)))}a.prototype=g.prototype={constructor:a,restart:function(x,T,A){if(typeof x!="function")throw new TypeError("callback is not a function");A=(A==null?c():+A)+(T==null?0:+T),this._next||m===this||(m?m._next=this:d=this,m=this),this._call=x,this._time=A,b()},stop:function(){this._call&&(this._call=null,this._time=1/0,b())}},t.interval=function(x,T,A){var S=new a,w=T;return T==null?(S.restart(x,T,A),S):(T=+T,A=A==null?c():+A,S.restart(function E(k){k+=w,S.restart(E,w+=T,A),x(k)},T,A),S)},t.now=c,t.timeout=function(x,T,A){var S=new a;return T=T==null?0:+T,S.restart(function(w){S.stop(),x(w+T)},T,A),S},t.timer=g,t.timerFlush=p,Object.defineProperty(t,"__esModule",{value:!0})})},{}],176:[function(r,I,B){I.exports=function(){for(var t=0;t<arguments.length;t++)if(arguments[t]!==void 0)return arguments[t]}},{}],177:[function(r,I,B){var t=r("incremental-convex-hull"),d=r("uniq");function m(e,f){this.point=e,this.index=f}function h(e,f){for(var l=e.point,o=f.point,u=l.length,s=0;s<u;++s){var i=o[s]-l[s];if(i)return i}return 0}I.exports=function(e,f){var l=e.length;if(l===0)return[];var o=e[0].length;if(o<1)return[];if(o===1)return function(S,w,E){if(S===1)return E?[[-1,0]]:[];var k=w.map(function(N,U){return[N[0],U]});k.sort(function(N,U){return N[0]-U[0]});for(var L=new Array(S-1),M=1;M<S;++M){var P=k[M-1],D=k[M];L[M-1]=[P[1],D[1]]}return E&&L.push([-1,L[0][1]],[L[S-1][1],-1]),L}(l,e,f);for(var u=new Array(l),s=1,i=0;i<l;++i){for(var c=e[i],n=new Array(o+1),a=0,g=0;g<o;++g){var p=c[g];n[g]=p,a+=p*p}n[o]=a,u[i]=new m(n,i),s=Math.max(a,s)}d(u,h),l=u.length;var y=new Array(l+o+1),v=new Array(l+o+1),b=(o+1)*(o+1)*s,x=new Array(o+1);for(i=0;i<=o;++i)x[i]=0;for(x[o]=b,y[0]=x.slice(),v[0]=-1,i=0;i<=o;++i)(n=x.slice())[i]=1,y[i+1]=n,v[i+1]=-1;for(i=0;i<l;++i){var T=u[i];y[i+o+1]=T.point,v[i+o+1]=T.index}var A=t(y,!1);if(A=f?A.filter(function(S){for(var w=0,E=0;E<=o;++E){var k=v[S[E]];if(k<0&&++w>=2)return!1;S[E]=k}return!0}):A.filter(function(S){for(var w=0;w<=o;++w){var E=v[S[w]];if(E<0)return!1;S[w]=E}return!0}),1&o)for(i=0;i<A.length;++i)n=(T=A[i])[0],T[0]=T[1],T[1]=n;return A}},{"incremental-convex-hull":438,uniq:603}],178:[function(r,I,B){I.exports=m;var t=(m.canvas=document.createElement("canvas")).getContext("2d"),d=h([32,126]);function m(e,f){Array.isArray(e)&&(e=e.join(", "));var l,o={},u=16,s=.05;f&&(f.length===2&&typeof f[0]=="number"?l=h(f):Array.isArray(f)?l=f:(f.o?l=h(f.o):f.pairs&&(l=f.pairs),f.fontSize&&(u=f.fontSize),f.threshold!=null&&(s=f.threshold))),l||(l=d),t.font=u+"px "+e;for(var i=0;i<l.length;i++){var c=l[i],n=t.measureText(c[0]).width+t.measureText(c[1]).width,a=t.measureText(c).width;if(Math.abs(n-a)>u*s){var g=(a-n)/u;o[c]=1e3*g}}return o}function h(e){for(var f=[],l=e[0];l<=e[1];l++)for(var o=String.fromCharCode(l),u=e[0];u<e[1];u++){var s=o+String.fromCharCode(u);f.push(s)}return f}m.createPairs=h,m.ascii=d},{}],179:[function(r,I,B){(function(t){(function(){var d=!1;if(typeof Float64Array!="undefined"){var m=new Float64Array(1),h=new Uint32Array(m.buffer);m[0]=1,d=!0,h[1]===1072693248?(I.exports=function(f){return m[0]=f,[h[0],h[1]]},I.exports.pack=function(f,l){return h[0]=f,h[1]=l,m[0]},I.exports.lo=function(f){return m[0]=f,h[0]},I.exports.hi=function(f){return m[0]=f,h[1]}):h[0]===1072693248?(I.exports=function(f){return m[0]=f,[h[1],h[0]]},I.exports.pack=function(f,l){return h[1]=f,h[0]=l,m[0]},I.exports.lo=function(f){return m[0]=f,h[1]},I.exports.hi=function(f){return m[0]=f,h[0]}):d=!1}if(!d){var e=new t(8);I.exports=function(f){return e.writeDoubleLE(f,0,!0),[e.readUInt32LE(0,!0),e.readUInt32LE(4,!0)]},I.exports.pack=function(f,l){return e.writeUInt32LE(f,0,!0),e.writeUInt32LE(l,4,!0),e.readDoubleLE(0,!0)},I.exports.lo=function(f){return e.writeDoubleLE(f,0,!0),e.readUInt32LE(0,!0)},I.exports.hi=function(f){return e.writeDoubleLE(f,0,!0),e.readUInt32LE(4,!0)}}I.exports.sign=function(f){return I.exports.hi(f)>>>31},I.exports.exponent=function(f){return(I.exports.hi(f)<<1>>>21)-1023},I.exports.fraction=function(f){var l=I.exports.lo(f),o=I.exports.hi(f),u=1048575&o;return 2146435072&o&&(u+=1<<20),[l,u]},I.exports.denormalized=function(f){return!(2146435072&I.exports.hi(f))}}).call(this)}).call(this,r("buffer").Buffer)},{buffer:117}],180:[function(r,I,B){var t=r("abs-svg-path"),d=r("normalize-svg-path"),m={M:"moveTo",C:"bezierCurveTo"};I.exports=function(h,e){h.beginPath(),d(t(e)).forEach(function(f){var l=f[0],o=f.slice(1);h[m[l]].apply(h,o)}),h.closePath()}},{"abs-svg-path":71,"normalize-svg-path":474}],181:[function(r,I,B){I.exports=function(t){switch(t){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],182:[function(r,I,B){I.exports=function(t,d){switch(d===void 0&&(d=0),typeof t){case"number":if(t>0)return function(m,h){var e,f;for(e=new Array(m),f=0;f<m;++f)e[f]=h;return e}(0|t,d);break;case"object":if(typeof t.length=="number")return function m(h,e,f){var l=0|h[f];if(l<=0)return[];var o,u=new Array(l);if(f===h.length-1)for(o=0;o<l;++o)u[o]=e;else for(o=0;o<l;++o)u[o]=m(h,e,f+1);return u}(t,d,0)}return[]}},{}],183:[function(r,I,B){function t(L,M,P){P=P||2;var D,N,U,G,X,K,Z,H=M&&M.length,Y=H?M[0]*P:L.length,$=d(L,0,Y,P,!0),z=[];if(!$||$.next===$.prev)return z;if(H&&($=function(W,ee,J,Q){var te,ie,ae,he,se,de=[];for(te=0,ie=ee.length;te<ie;te++)ae=ee[te]*Q,he=te<ie-1?ee[te+1]*Q:W.length,(se=d(W,ae,he,Q,!1))===se.next&&(se.steiner=!0),de.push(n(se));for(de.sort(u),te=0;te<de.length;te++)s(de[te],J),J=m(J,J.next);return J}(L,M,$,P)),L.length>80*P){D=U=L[0],N=G=L[1];for(var j=P;j<Y;j+=P)(X=L[j])<D&&(D=X),(K=L[j+1])<N&&(N=K),X>U&&(U=X),K>G&&(G=K);Z=(Z=Math.max(U-D,G-N))!==0?1/Z:0}return h($,z,P,D,N,Z),z}function d(L,M,P,D,N){var U,G;if(N===k(L,M,P,D)>0)for(U=M;U<P;U+=D)G=S(U,L[U],L[U+1],G);else for(U=P-D;U>=M;U-=D)G=S(U,L[U],L[U+1],G);return G&&y(G,G.next)&&(w(G),G=G.next),G}function m(L,M){if(!L)return L;M||(M=L);var P,D=L;do if(P=!1,D.steiner||!y(D,D.next)&&p(D.prev,D,D.next)!==0)D=D.next;else{if(w(D),(D=M=D.prev)===D.next)break;P=!0}while(P||D!==M);return M}function h(L,M,P,D,N,U,G){if(L){!G&&U&&function(H,Y,$,z){var j=H;do j.z===null&&(j.z=c(j.x,j.y,Y,$,z)),j.prevZ=j.prev,j.nextZ=j.next,j=j.next;while(j!==H);j.prevZ.nextZ=null,j.prevZ=null,function(W){var ee,J,Q,te,ie,ae,he,se,de=1;do{for(J=W,W=null,ie=null,ae=0;J;){for(ae++,Q=J,he=0,ee=0;ee<de&&(he++,Q=Q.nextZ);ee++);for(se=de;he>0||se>0&&Q;)he!==0&&(se===0||!Q||J.z<=Q.z)?(te=J,J=J.nextZ,he--):(te=Q,Q=Q.nextZ,se--),ie?ie.nextZ=te:W=te,te.prevZ=ie,ie=te;J=Q}ie.nextZ=null,de*=2}while(ae>1)}(j)}(L,D,N,U);for(var X,K,Z=L;L.prev!==L.next;)if(X=L.prev,K=L.next,U?f(L,D,N,U):e(L))M.push(X.i/P),M.push(L.i/P),M.push(K.i/P),w(L),L=K.next,Z=K.next;else if((L=K)===Z){G?G===1?h(L=l(m(L),M,P),M,P,D,N,U,2):G===2&&o(L,M,P,D,N,U):h(m(L),M,P,D,N,U,1);break}}}function e(L){var M=L.prev,P=L,D=L.next;if(p(M,P,D)>=0)return!1;for(var N=L.next.next;N!==L.prev;){if(a(M.x,M.y,P.x,P.y,D.x,D.y,N.x,N.y)&&p(N.prev,N,N.next)>=0)return!1;N=N.next}return!0}function f(L,M,P,D){var N=L.prev,U=L,G=L.next;if(p(N,U,G)>=0)return!1;for(var X=N.x<U.x?N.x<G.x?N.x:G.x:U.x<G.x?U.x:G.x,K=N.y<U.y?N.y<G.y?N.y:G.y:U.y<G.y?U.y:G.y,Z=N.x>U.x?N.x>G.x?N.x:G.x:U.x>G.x?U.x:G.x,H=N.y>U.y?N.y>G.y?N.y:G.y:U.y>G.y?U.y:G.y,Y=c(X,K,M,P,D),$=c(Z,H,M,P,D),z=L.prevZ,j=L.nextZ;z&&z.z>=Y&&j&&j.z<=$;){if(z!==L.prev&&z!==L.next&&a(N.x,N.y,U.x,U.y,G.x,G.y,z.x,z.y)&&p(z.prev,z,z.next)>=0||(z=z.prevZ,j!==L.prev&&j!==L.next&&a(N.x,N.y,U.x,U.y,G.x,G.y,j.x,j.y)&&p(j.prev,j,j.next)>=0))return!1;j=j.nextZ}for(;z&&z.z>=Y;){if(z!==L.prev&&z!==L.next&&a(N.x,N.y,U.x,U.y,G.x,G.y,z.x,z.y)&&p(z.prev,z,z.next)>=0)return!1;z=z.prevZ}for(;j&&j.z<=$;){if(j!==L.prev&&j!==L.next&&a(N.x,N.y,U.x,U.y,G.x,G.y,j.x,j.y)&&p(j.prev,j,j.next)>=0)return!1;j=j.nextZ}return!0}function l(L,M,P){var D=L;do{var N=D.prev,U=D.next.next;!y(N,U)&&v(N,D,D.next,U)&&T(N,U)&&T(U,N)&&(M.push(N.i/P),M.push(D.i/P),M.push(U.i/P),w(D),w(D.next),D=L=U),D=D.next}while(D!==L);return m(D)}function o(L,M,P,D,N,U){var G=L;do{for(var X=G.next.next;X!==G.prev;){if(G.i!==X.i&&g(G,X)){var K=A(G,X);return G=m(G,G.next),K=m(K,K.next),h(G,M,P,D,N,U),void h(K,M,P,D,N,U)}X=X.next}G=G.next}while(G!==L)}function u(L,M){return L.x-M.x}function s(L,M){if(M=function(D,N){var U,G=N,X=D.x,K=D.y,Z=-1/0;do{if(K<=G.y&&K>=G.next.y&&G.next.y!==G.y){var H=G.x+(K-G.y)*(G.next.x-G.x)/(G.next.y-G.y);if(H<=X&&H>Z){if(Z=H,H===X){if(K===G.y)return G;if(K===G.next.y)return G.next}U=G.x<G.next.x?G:G.next}}G=G.next}while(G!==N);if(!U)return null;if(X===Z)return U;var Y,$=U,z=U.x,j=U.y,W=1/0;G=U;do X>=G.x&&G.x>=z&&X!==G.x&&a(K<j?X:Z,K,z,j,K<j?Z:X,K,G.x,G.y)&&(Y=Math.abs(K-G.y)/(X-G.x),T(G,D)&&(Y<W||Y===W&&(G.x>U.x||G.x===U.x&&i(U,G)))&&(U=G,W=Y)),G=G.next;while(G!==$);return U}(L,M)){var P=A(M,L);m(M,M.next),m(P,P.next)}}function i(L,M){return p(L.prev,L,M.prev)<0&&p(M.next,L,L.next)<0}function c(L,M,P,D,N){return(L=1431655765&((L=858993459&((L=252645135&((L=16711935&((L=32767*(L-P)*N)|L<<8))|L<<4))|L<<2))|L<<1))|(M=1431655765&((M=858993459&((M=252645135&((M=16711935&((M=32767*(M-D)*N)|M<<8))|M<<4))|M<<2))|M<<1))<<1}function n(L){var M=L,P=L;do(M.x<P.x||M.x===P.x&&M.y<P.y)&&(P=M),M=M.next;while(M!==L);return P}function a(L,M,P,D,N,U,G,X){return(N-G)*(M-X)-(L-G)*(U-X)>=0&&(L-G)*(D-X)-(P-G)*(M-X)>=0&&(P-G)*(U-X)-(N-G)*(D-X)>=0}function g(L,M){return L.next.i!==M.i&&L.prev.i!==M.i&&!function(P,D){var N=P;do{if(N.i!==P.i&&N.next.i!==P.i&&N.i!==D.i&&N.next.i!==D.i&&v(N,N.next,P,D))return!0;N=N.next}while(N!==P);return!1}(L,M)&&(T(L,M)&&T(M,L)&&function(P,D){var N=P,U=!1,G=(P.x+D.x)/2,X=(P.y+D.y)/2;do N.y>X!=N.next.y>X&&N.next.y!==N.y&&G<(N.next.x-N.x)*(X-N.y)/(N.next.y-N.y)+N.x&&(U=!U),N=N.next;while(N!==P);return U}(L,M)&&(p(L.prev,L,M.prev)||p(L,M.prev,M))||y(L,M)&&p(L.prev,L,L.next)>0&&p(M.prev,M,M.next)>0)}function p(L,M,P){return(M.y-L.y)*(P.x-M.x)-(M.x-L.x)*(P.y-M.y)}function y(L,M){return L.x===M.x&&L.y===M.y}function v(L,M,P,D){var N=x(p(L,M,P)),U=x(p(L,M,D)),G=x(p(P,D,L)),X=x(p(P,D,M));return N!==U&&G!==X||!(N!==0||!b(L,P,M))||!(U!==0||!b(L,D,M))||!(G!==0||!b(P,L,D))||!(X!==0||!b(P,M,D))}function b(L,M,P){return M.x<=Math.max(L.x,P.x)&&M.x>=Math.min(L.x,P.x)&&M.y<=Math.max(L.y,P.y)&&M.y>=Math.min(L.y,P.y)}function x(L){return L>0?1:L<0?-1:0}function T(L,M){return p(L.prev,L,L.next)<0?p(L,M,L.next)>=0&&p(L,L.prev,M)>=0:p(L,M,L.prev)<0||p(L,L.next,M)<0}function A(L,M){var P=new E(L.i,L.x,L.y),D=new E(M.i,M.x,M.y),N=L.next,U=M.prev;return L.next=M,M.prev=L,P.next=N,N.prev=P,D.next=P,P.prev=D,U.next=D,D.prev=U,D}function S(L,M,P,D){var N=new E(L,M,P);return D?(N.next=D.next,N.prev=D,D.next.prev=N,D.next=N):(N.prev=N,N.next=N),N}function w(L){L.next.prev=L.prev,L.prev.next=L.next,L.prevZ&&(L.prevZ.nextZ=L.nextZ),L.nextZ&&(L.nextZ.prevZ=L.prevZ)}function E(L,M,P){this.i=L,this.x=M,this.y=P,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function k(L,M,P,D){for(var N=0,U=M,G=P-D;U<P;U+=D)N+=(L[G]-L[U])*(L[U+1]+L[G+1]),G=U;return N}I.exports=t,I.exports.default=t,t.deviation=function(L,M,P,D){var N=M&&M.length,U=N?M[0]*P:L.length,G=Math.abs(k(L,0,U,P));if(N)for(var X=0,K=M.length;X<K;X++){var Z=M[X]*P,H=X<K-1?M[X+1]*P:L.length;G-=Math.abs(k(L,Z,H,P))}var Y=0;for(X=0;X<D.length;X+=3){var $=D[X]*P,z=D[X+1]*P,j=D[X+2]*P;Y+=Math.abs((L[$]-L[j])*(L[z+1]-L[$+1])-(L[$]-L[z])*(L[j+1]-L[$+1]))}return G===0&&Y===0?0:Math.abs((Y-G)/G)},t.flatten=function(L){for(var M=L[0][0].length,P={vertices:[],holes:[],dimensions:M},D=0,N=0;N<L.length;N++){for(var U=0;U<L[N].length;U++)for(var G=0;G<M;G++)P.vertices.push(L[N][U][G]);N>0&&(D+=L[N-1].length,P.holes.push(D))}return P}},{}],184:[function(r,I,B){I.exports=function(d,m){var h=d.length;if(typeof m!="number"){m=0;for(var e=0;e<h;++e){var f=d[e];m=Math.max(m,f[0],f[1])}m=1+(0|m)}m|=0;var l=new Array(m);for(e=0;e<m;++e)l[e]=[];for(e=0;e<h;++e)f=d[e],l[f[0]].push(f[1]),l[f[1]].push(f[0]);for(var o=0;o<m;++o)t(l[o],function(u,s){return u-s});return l};var t=r("uniq")},{uniq:603}],185:[function(r,I,B){var t=r("strongly-connected-components");I.exports=function(d,m){var h,e=[],f=[],l=[],o={},u=[];function s(v){var b,x,T=!1;for(f.push(v),l[v]=!0,b=0;b<u[v].length;b++)(x=u[v][b])===h?(i(h,f),T=!0):l[x]||(T=s(x));if(T)(function S(w){l[w]=!1,o.hasOwnProperty(w)&&Object.keys(o[w]).forEach(function(E){delete o[w][E],l[E]&&S(E)})})(v);else for(b=0;b<u[v].length;b++){x=u[v][b];var A=o[x];A||(A={},o[x]=A),A[x]=!0}return f.pop(),T}function i(v,b){var x=[].concat(b).concat(v);m?m(s):e.push(x)}function c(v){(function(E){for(var k=0;k<d.length;k++)k<E&&(d[k]=[]),d[k]=d[k].filter(function(L){return L>=E})})(v);for(var b,x=t(d).components.filter(function(E){return E.length>1}),T=1/0,A=0;A<x.length;A++)for(var S=0;S<x[A].length;S++)x[A][S]<T&&(T=x[A][S],b=A);var w=x[b];return!!w&&{leastVertex:T,adjList:d.map(function(E,k){return w.indexOf(k)===-1?[]:E.filter(function(L){return w.indexOf(L)!==-1})})}}h=0;for(var n=d.length;h<n;){var a=c(h);if(h=a.leastVertex,u=a.adjList){for(var g=0;g<u.length;g++)for(var p=0;p<u[g].length;p++){var y=u[g][p];l[+y]=!1,o[y]={}}s(h),h+=1}else h=n}return m?void 0:e}},{"strongly-connected-components":575}],186:[function(r,I,B){var t=r("../../object/valid-value");I.exports=function(){return t(this).length=0,this}},{"../../object/valid-value":217}],187:[function(r,I,B){I.exports=r("./is-implemented")()?Array.from:r("./shim")},{"./is-implemented":188,"./shim":189}],188:[function(r,I,B){I.exports=function(){var t,d,m=Array.from;return typeof m=="function"&&(d=m(t=["raz","dwa"]),Boolean(d&&d!==t&&d[1]==="dwa"))}},{}],189:[function(r,I,B){var t=r("es6-symbol").iterator,d=r("../../function/is-arguments"),m=r("../../function/is-function"),h=r("../../number/to-pos-integer"),e=r("../../object/valid-callable"),f=r("../../object/valid-value"),l=r("../../object/is-value"),o=r("../../string/is-string"),u=Array.isArray,s=Function.prototype.call,i={configurable:!0,enumerable:!0,writable:!0,value:null},c=Object.defineProperty;I.exports=function(n){var a,g,p,y,v,b,x,T,A,S,w=arguments[1],E=arguments[2];if(n=Object(f(n)),l(w)&&e(w),this&&this!==Array&&m(this))a=this;else{if(!w){if(d(n))return(v=n.length)!==1?Array.apply(null,n):((y=new Array(1))[0]=n[0],y);if(u(n)){for(y=new Array(v=n.length),g=0;g<v;++g)y[g]=n[g];return y}}y=[]}if(!u(n)){if((A=n[t])!==void 0){for(x=e(A).call(n),a&&(y=new a),T=x.next(),g=0;!T.done;)S=w?s.call(w,E,T.value,g):T.value,a?(i.value=S,c(y,g,i)):y[g]=S,T=x.next(),++g;v=g}else if(o(n)){for(v=n.length,a&&(y=new a),g=0,p=0;g<v;++g)S=n[g],g+1<v&&(b=S.charCodeAt(0))>=55296&&b<=56319&&(S+=n[++g]),S=w?s.call(w,E,S,p):S,a?(i.value=S,c(y,p,i)):y[p]=S,++p;v=p}}if(v===void 0)for(v=h(n.length),a&&(y=new a(v)),g=0;g<v;++g)S=w?s.call(w,E,n[g],g):n[g],a?(i.value=S,c(y,g,i)):y[g]=S;return a&&(i.value=null,y.length=v),y}},{"../../function/is-arguments":190,"../../function/is-function":191,"../../number/to-pos-integer":197,"../../object/is-value":206,"../../object/valid-callable":215,"../../object/valid-value":217,"../../string/is-string":221,"es6-symbol":230}],190:[function(r,I,B){var t=Object.prototype.toString,d=t.call(function(){return arguments}());I.exports=function(m){return t.call(m)===d}},{}],191:[function(r,I,B){var t=Object.prototype.toString,d=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);I.exports=function(m){return typeof m=="function"&&d(t.call(m))}},{}],192:[function(r,I,B){I.exports=function(){}},{}],193:[function(r,I,B){I.exports=r("./is-implemented")()?Math.sign:r("./shim")},{"./is-implemented":194,"./shim":195}],194:[function(r,I,B){I.exports=function(){var t=Math.sign;return typeof t=="function"&&t(10)===1&&t(-20)===-1}},{}],195:[function(r,I,B){I.exports=function(t){return t=Number(t),isNaN(t)||t===0?t:t>0?1:-1}},{}],196:[function(r,I,B){var t=r("../math/sign"),d=Math.abs,m=Math.floor;I.exports=function(h){return isNaN(h)?0:(h=Number(h))!==0&&isFinite(h)?t(h)*m(d(h)):h}},{"../math/sign":193}],197:[function(r,I,B){var t=r("./to-integer"),d=Math.max;I.exports=function(m){return d(0,t(m))}},{"./to-integer":196}],198:[function(r,I,B){var t=r("./valid-callable"),d=r("./valid-value"),m=Function.prototype.bind,h=Function.prototype.call,e=Object.keys,f=Object.prototype.propertyIsEnumerable;I.exports=function(l,o){return function(u,s){var i,c=arguments[2],n=arguments[3];return u=Object(d(u)),t(s),i=e(u),n&&i.sort(typeof n=="function"?m.call(n,u):void 0),typeof l!="function"&&(l=i[l]),h.call(l,i,function(a,g){return f.call(u,a)?h.call(s,c,u[a],a,u,g):o})}}},{"./valid-callable":215,"./valid-value":217}],199:[function(r,I,B){I.exports=r("./is-implemented")()?Object.assign:r("./shim")},{"./is-implemented":200,"./shim":201}],200:[function(r,I,B){I.exports=function(){var t,d=Object.assign;return typeof d=="function"&&(d(t={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},{}],201:[function(r,I,B){var t=r("../keys"),d=r("../valid-value"),m=Math.max;I.exports=function(h,e){var f,l,o,u=m(arguments.length,2);for(h=Object(d(h)),o=function(s){try{h[s]=e[s]}catch(i){f||(f=i)}},l=1;l<u;++l)t(e=arguments[l]).forEach(o);if(f!==void 0)throw f;return h}},{"../keys":207,"../valid-value":217}],202:[function(r,I,B){var t=r("../array/from"),d=r("./assign"),m=r("./valid-value");I.exports=function(h){var e=Object(m(h)),f=arguments[1],l=Object(arguments[2]);if(e!==h&&!f)return e;var o={};return f?t(f,function(u){(l.ensure||u in h)&&(o[u]=h[u])}):d(o,h),o}},{"../array/from":187,"./assign":199,"./valid-value":217}],203:[function(r,I,B){var t,d,m,h,e=Object.create;r("./set-prototype-of/is-implemented")()||(t=r("./set-prototype-of/shim")),I.exports=t?t.level!==1?e:(d={},m={},h={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(f){m[f]=f!=="__proto__"?h:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(d,m),Object.defineProperty(t,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:d}),function(f,l){return e(f===null?d:f,l)}):e},{"./set-prototype-of/is-implemented":213,"./set-prototype-of/shim":214}],204:[function(r,I,B){I.exports=r("./_iterate")("forEach")},{"./_iterate":198}],205:[function(r,I,B){var t=r("./is-value"),d={function:!0,object:!0};I.exports=function(m){return t(m)&&d[typeof m]||!1}},{"./is-value":206}],206:[function(r,I,B){var t=r("../function/noop")();I.exports=function(d){return d!==t&&d!==null}},{"../function/noop":192}],207:[function(r,I,B){I.exports=r("./is-implemented")()?Object.keys:r("./shim")},{"./is-implemented":208,"./shim":209}],208:[function(r,I,B){I.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},{}],209:[function(r,I,B){var t=r("../is-value"),d=Object.keys;I.exports=function(m){return d(t(m)?Object(m):m)}},{"../is-value":206}],210:[function(r,I,B){var t=r("./valid-callable"),d=r("./for-each"),m=Function.prototype.call;I.exports=function(h,e){var f={},l=arguments[2];return t(e),d(h,function(o,u,s,i){f[u]=m.call(e,l,o,u,s,i)}),f}},{"./for-each":204,"./valid-callable":215}],211:[function(r,I,B){var t=r("./is-value"),d=Array.prototype.forEach,m=Object.create,h=function(e,f){var l;for(l in e)f[l]=e[l]};I.exports=function(e){var f=m(null);return d.call(arguments,function(l){t(l)&&h(Object(l),f)}),f}},{"./is-value":206}],212:[function(r,I,B){I.exports=r("./is-implemented")()?Object.setPrototypeOf:r("./shim")},{"./is-implemented":213,"./shim":214}],213:[function(r,I,B){var t=Object.create,d=Object.getPrototypeOf,m={};I.exports=function(){var h=Object.setPrototypeOf,e=arguments[0]||t;return typeof h=="function"&&d(h(e(null),m))===m}},{}],214:[function(r,I,B){var t,d=r("../is-object"),m=r("../valid-value"),h=Object.prototype.isPrototypeOf,e=Object.defineProperty,f={configurable:!0,enumerable:!1,writable:!0,value:void 0};t=function(l,o){if(m(l),o===null||d(o))return l;throw new TypeError("Prototype must be null or an object")},I.exports=function(l){var o,u;return l?(l.level===2?l.set?(u=l.set,o=function(s,i){return u.call(t(s,i),i),s}):o=function(s,i){return t(s,i).__proto__=i,s}:o=function s(i,c){var n;return t(i,c),(n=h.call(s.nullPolyfill,i))&&delete s.nullPolyfill.__proto__,c===null&&(c=s.nullPolyfill),i.__proto__=c,n&&e(s.nullPolyfill,"__proto__",f),i},Object.defineProperty(o,"level",{configurable:!1,enumerable:!1,writable:!1,value:l.level})):null}(function(){var l,o=Object.create(null),u={},s=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(s){try{(l=s.set).call(o,u)}catch(i){}if(Object.getPrototypeOf(o)===u)return{set:l,level:2}}return o.__proto__=u,Object.getPrototypeOf(o)===u?{level:2}:((o={}).__proto__=u,Object.getPrototypeOf(o)===u&&{level:1})}()),r("../create")},{"../create":203,"../is-object":205,"../valid-value":217}],215:[function(r,I,B){I.exports=function(t){if(typeof t!="function")throw new TypeError(t+" is not a function");return t}},{}],216:[function(r,I,B){var t=r("./is-object");I.exports=function(d){if(!t(d))throw new TypeError(d+" is not an Object");return d}},{"./is-object":205}],217:[function(r,I,B){var t=r("./is-value");I.exports=function(d){if(!t(d))throw new TypeError("Cannot use null or undefined");return d}},{"./is-value":206}],218:[function(r,I,B){I.exports=r("./is-implemented")()?String.prototype.contains:r("./shim")},{"./is-implemented":219,"./shim":220}],219:[function(r,I,B){var t="razdwatrzy";I.exports=function(){return typeof t.contains=="function"&&t.contains("dwa")===!0&&t.contains("foo")===!1}},{}],220:[function(r,I,B){var t=String.prototype.indexOf;I.exports=function(d){return t.call(this,d,arguments[1])>-1}},{}],221:[function(r,I,B){var t=Object.prototype.toString,d=t.call("");I.exports=function(m){return typeof m=="string"||m&&typeof m=="object"&&(m instanceof String||t.call(m)===d)||!1}},{}],222:[function(r,I,B){var t=Object.create(null),d=Math.random;I.exports=function(){var m;do m=d().toString(36).slice(2);while(t[m]);return m}},{}],223:[function(r,I,B){var t,d=r("es5-ext/object/set-prototype-of"),m=r("es5-ext/string/#/contains"),h=r("d"),e=r("es6-symbol"),f=r("./"),l=Object.defineProperty;t=I.exports=function(o,u){if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");f.call(this,o),u=u?m.call(u,"key+value")?"key+value":m.call(u,"key")?"key":"value":"value",l(this,"__kind__",h("",u))},d&&d(t,f),delete t.prototype.constructor,t.prototype=Object.create(f.prototype,{_resolve:h(function(o){return this.__kind__==="value"?this.__list__[o]:this.__kind__==="key+value"?[o,this.__list__[o]]:o})}),l(t.prototype,e.toStringTag,h("c","Array Iterator"))},{"./":226,d:158,"es5-ext/object/set-prototype-of":212,"es5-ext/string/#/contains":218,"es6-symbol":230}],224:[function(r,I,B){var t=r("es5-ext/function/is-arguments"),d=r("es5-ext/object/valid-callable"),m=r("es5-ext/string/is-string"),h=r("./get"),e=Array.isArray,f=Function.prototype.call,l=Array.prototype.some;I.exports=function(o,u){var s,i,c,n,a,g,p,y,v=arguments[2];if(e(o)||t(o)?s="array":m(o)?s="string":o=h(o),d(u),c=function(){n=!0},s!=="array")if(s!=="string")for(i=o.next();!i.done;){if(f.call(u,v,i.value,c),n)return;i=o.next()}else for(g=o.length,a=0;a<g&&(p=o[a],a+1<g&&(y=p.charCodeAt(0))>=55296&&y<=56319&&(p+=o[++a]),f.call(u,v,p,c),!n);++a);else l.call(o,function(b){return f.call(u,v,b,c),n})}},{"./get":225,"es5-ext/function/is-arguments":190,"es5-ext/object/valid-callable":215,"es5-ext/string/is-string":221}],225:[function(r,I,B){var t=r("es5-ext/function/is-arguments"),d=r("es5-ext/string/is-string"),m=r("./array"),h=r("./string"),e=r("./valid-iterable"),f=r("es6-symbol").iterator;I.exports=function(l){return typeof e(l)[f]=="function"?l[f]():t(l)?new m(l):d(l)?new h(l):new m(l)}},{"./array":223,"./string":228,"./valid-iterable":229,"es5-ext/function/is-arguments":190,"es5-ext/string/is-string":221,"es6-symbol":230}],226:[function(r,I,B){var t,d=r("es5-ext/array/#/clear"),m=r("es5-ext/object/assign"),h=r("es5-ext/object/valid-callable"),e=r("es5-ext/object/valid-value"),f=r("d"),l=r("d/auto-bind"),o=r("es6-symbol"),u=Object.defineProperty,s=Object.defineProperties;I.exports=t=function(i,c){if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");s(this,{__list__:f("w",e(i)),__context__:f("w",c),__nextIndex__:f("w",0)}),c&&(h(c.on),c.on("_add",this._onAdd),c.on("_delete",this._onDelete),c.on("_clear",this._onClear))},delete t.prototype.constructor,s(t.prototype,m({_next:f(function(){var i;if(this.__list__)return this.__redo__&&(i=this.__redo__.shift())!==void 0?i:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:f(function(){return this._createResult(this._next())}),_createResult:f(function(i){return i===void 0?{done:!0,value:void 0}:{done:!1,value:this._resolve(i)}}),_resolve:f(function(i){return this.__list__[i]}),_unBind:f(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:f(function(){return"[object "+(this[o.toStringTag]||"Object")+"]"})},l({_onAdd:f(function(i){i>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(c,n){c>=i&&(this.__redo__[n]=++c)},this),this.__redo__.push(i)):u(this,"__redo__",f("c",[i])))}),_onDelete:f(function(i){var c;i>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&((c=this.__redo__.indexOf(i))!==-1&&this.__redo__.splice(c,1),this.__redo__.forEach(function(n,a){n>i&&(this.__redo__[a]=--n)},this)))}),_onClear:f(function(){this.__redo__&&d.call(this.__redo__),this.__nextIndex__=0})}))),u(t.prototype,o.iterator,f(function(){return this}))},{d:158,"d/auto-bind":157,"es5-ext/array/#/clear":186,"es5-ext/object/assign":199,"es5-ext/object/valid-callable":215,"es5-ext/object/valid-value":217,"es6-symbol":230}],227:[function(r,I,B){var t=r("es5-ext/function/is-arguments"),d=r("es5-ext/object/is-value"),m=r("es5-ext/string/is-string"),h=r("es6-symbol").iterator,e=Array.isArray;I.exports=function(f){return!!d(f)&&(!!e(f)||!!m(f)||!!t(f)||typeof f[h]=="function")}},{"es5-ext/function/is-arguments":190,"es5-ext/object/is-value":206,"es5-ext/string/is-string":221,"es6-symbol":230}],228:[function(r,I,B){var t,d=r("es5-ext/object/set-prototype-of"),m=r("d"),h=r("es6-symbol"),e=r("./"),f=Object.defineProperty;t=I.exports=function(l){if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");l=String(l),e.call(this,l),f(this,"__length__",m("",l.length))},d&&d(t,e),delete t.prototype.constructor,t.prototype=Object.create(e.prototype,{_next:m(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:m(function(l){var o,u=this.__list__[l];return this.__nextIndex__===this.__length__?u:(o=u.charCodeAt(0))>=55296&&o<=56319?u+this.__list__[this.__nextIndex__++]:u})}),f(t.prototype,h.toStringTag,m("c","String Iterator"))},{"./":226,d:158,"es5-ext/object/set-prototype-of":212,"es6-symbol":230}],229:[function(r,I,B){var t=r("./is-iterable");I.exports=function(d){if(!t(d))throw new TypeError(d+" is not iterable");return d}},{"./is-iterable":227}],230:[function(r,I,B){I.exports=r("./is-implemented")()?r("ext/global-this").Symbol:r("./polyfill")},{"./is-implemented":231,"./polyfill":236,"ext/global-this":243}],231:[function(r,I,B){var t=r("ext/global-this"),d={object:!0,symbol:!0};I.exports=function(){var m,h=t.Symbol;if(typeof h!="function")return!1;m=h("test symbol");try{String(m)}catch(e){return!1}return!!d[typeof h.iterator]&&!!d[typeof h.toPrimitive]&&!!d[typeof h.toStringTag]}},{"ext/global-this":243}],232:[function(r,I,B){I.exports=function(t){return!!t&&(typeof t=="symbol"||!!t.constructor&&t.constructor.name==="Symbol"&&t[t.constructor.toStringTag]==="Symbol")}},{}],233:[function(r,I,B){var t=r("d"),d=Object.create,m=Object.defineProperty,h=Object.prototype,e=d(null);I.exports=function(f){for(var l,o,u=0;e[f+(u||"")];)++u;return e[f+=u||""]=!0,m(h,l="@@"+f,t.gs(null,function(s){o||(o=!0,m(this,l,t(s)),o=!1)})),l}},{d:158}],234:[function(r,I,B){var t=r("d"),d=r("ext/global-this").Symbol;I.exports=function(m){return Object.defineProperties(m,{hasInstance:t("",d&&d.hasInstance||m("hasInstance")),isConcatSpreadable:t("",d&&d.isConcatSpreadable||m("isConcatSpreadable")),iterator:t("",d&&d.iterator||m("iterator")),match:t("",d&&d.match||m("match")),replace:t("",d&&d.replace||m("replace")),search:t("",d&&d.search||m("search")),species:t("",d&&d.species||m("species")),split:t("",d&&d.split||m("split")),toPrimitive:t("",d&&d.toPrimitive||m("toPrimitive")),toStringTag:t("",d&&d.toStringTag||m("toStringTag")),unscopables:t("",d&&d.unscopables||m("unscopables"))})}},{d:158,"ext/global-this":243}],235:[function(r,I,B){var t=r("d"),d=r("../../../validate-symbol"),m=Object.create(null);I.exports=function(h){return Object.defineProperties(h,{for:t(function(e){return m[e]?m[e]:m[e]=h(String(e))}),keyFor:t(function(e){var f;for(f in d(e),m)if(m[f]===e)return f})})}},{"../../../validate-symbol":237,d:158}],236:[function(r,I,B){var t,d,m,h=r("d"),e=r("./validate-symbol"),f=r("ext/global-this").Symbol,l=r("./lib/private/generate-name"),o=r("./lib/private/setup/standard-symbols"),u=r("./lib/private/setup/symbol-registry"),s=Object.create,i=Object.defineProperties,c=Object.defineProperty;if(typeof f=="function")try{String(f()),m=!0}catch(n){}else f=null;d=function(n){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return t(n)},I.exports=t=function n(a){var g;if(this instanceof n)throw new TypeError("Symbol is not a constructor");return m?f(a):(g=s(d.prototype),a=a===void 0?"":String(a),i(g,{__description__:h("",a),__name__:h("",l(a))}))},o(t),u(t),i(d.prototype,{constructor:h(t),toString:h("",function(){return this.__name__})}),i(t.prototype,{toString:h(function(){return"Symbol ("+e(this).__description__+")"}),valueOf:h(function(){return e(this)})}),c(t.prototype,t.toPrimitive,h("",function(){var n=e(this);return typeof n=="symbol"?n:n.toString()})),c(t.prototype,t.toStringTag,h("c","Symbol")),c(d.prototype,t.toStringTag,h("c",t.prototype[t.toStringTag])),c(d.prototype,t.toPrimitive,h("c",t.prototype[t.toPrimitive]))},{"./lib/private/generate-name":233,"./lib/private/setup/standard-symbols":234,"./lib/private/setup/symbol-registry":235,"./validate-symbol":237,d:158,"ext/global-this":243}],237:[function(r,I,B){var t=r("./is-symbol");I.exports=function(d){if(!t(d))throw new TypeError(d+" is not a symbol");return d}},{"./is-symbol":232}],238:[function(r,I,B){I.exports=r("./is-implemented")()?WeakMap:r("./polyfill")},{"./is-implemented":239,"./polyfill":241}],239:[function(r,I,B){I.exports=function(){var t,d;if(typeof WeakMap!="function")return!1;try{t=new WeakMap([[d={},"one"],[{},"two"],[{},"three"]])}catch(m){return!1}return String(t)==="[object WeakMap]"&&typeof t.set=="function"&&t.set({},1)===t&&typeof t.delete=="function"&&typeof t.has=="function"&&t.get(d)==="one"}},{}],240:[function(r,I,B){I.exports=typeof WeakMap=="function"&&Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"},{}],241:[function(r,I,B){var t,d=r("es5-ext/object/is-value"),m=r("es5-ext/object/set-prototype-of"),h=r("es5-ext/object/valid-object"),e=r("es5-ext/object/valid-value"),f=r("es5-ext/string/random-uniq"),l=r("d"),o=r("es6-iterator/get"),u=r("es6-iterator/for-of"),s=r("es6-symbol").toStringTag,i=r("./is-native-implemented"),c=Array.isArray,n=Object.defineProperty,a=Object.prototype.hasOwnProperty,g=Object.getPrototypeOf;I.exports=t=function(){var p,y=arguments[0];if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");return p=i&&m&&WeakMap!==t?m(new WeakMap,g(this)):this,d(y)&&(c(y)||(y=o(y))),n(p,"__weakMapData__",l("c","$weakMap$"+f())),y&&u(y,function(v){e(v),p.set(v[0],v[1])}),p},i&&(m&&m(t,WeakMap),t.prototype=Object.create(WeakMap.prototype,{constructor:l(t)})),Object.defineProperties(t.prototype,{delete:l(function(p){return!!a.call(h(p),this.__weakMapData__)&&(delete p[this.__weakMapData__],!0)}),get:l(function(p){if(a.call(h(p),this.__weakMapData__))return p[this.__weakMapData__]}),has:l(function(p){return a.call(h(p),this.__weakMapData__)}),set:l(function(p,y){return n(h(p),this.__weakMapData__,l("c",y)),this}),toString:l(function(){return"[object WeakMap]"})}),n(t.prototype,s,l("c","WeakMap"))},{"./is-native-implemented":240,d:158,"es5-ext/object/is-value":206,"es5-ext/object/set-prototype-of":212,"es5-ext/object/valid-object":216,"es5-ext/object/valid-value":217,"es5-ext/string/random-uniq":222,"es6-iterator/for-of":224,"es6-iterator/get":225,"es6-symbol":230}],242:[function(r,I,B){var t=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};I.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(d){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},{}],243:[function(r,I,B){I.exports=r("./is-implemented")()?globalThis:r("./implementation")},{"./implementation":242,"./is-implemented":244}],244:[function(r,I,B){I.exports=function(){return typeof globalThis=="object"&&!!globalThis&&globalThis.Array===Array}},{}],245:[function(r,I,B){I.exports=function(t,d,m){var h=d||0,e=m||1;return[[t[12]+t[0],t[13]+t[1],t[14]+t[2],t[15]+t[3]],[t[12]-t[0],t[13]-t[1],t[14]-t[2],t[15]-t[3]],[t[12]+t[4],t[13]+t[5],t[14]+t[6],t[15]+t[7]],[t[12]-t[4],t[13]-t[5],t[14]-t[6],t[15]-t[7]],[h*t[12]+t[8],h*t[13]+t[9],h*t[14]+t[10],h*t[15]+t[11]],[e*t[12]-t[8],e*t[13]-t[9],e*t[14]-t[10],e*t[15]-t[11]]]}},{}],246:[function(r,I,B){var t=r("is-string-blank");I.exports=function(d){var m=typeof d;if(m==="string"){var h=d;if((d=+d)==0&&t(h))return!1}else if(m!=="number")return!1;return d-d<1}},{"is-string-blank":448}],247:[function(r,I,B){I.exports=function(l,o,u){switch(arguments.length){case 0:return new h([0],[0],0);case 1:return typeof l=="number"?new h(s=f(l),s,0):new h(l,f(l.length),0);case 2:if(typeof o=="number"){var s=f(l.length);return new h(l,s,+o)}u=0;case 3:if(l.length!==o.length)throw new Error("state and velocity lengths must match");return new h(l,o,u)}};var t=r("cubic-hermite"),d=r("binary-search-bounds");function m(l,o,u){return Math.min(o,Math.max(l,u))}function h(l,o,u){this.dimension=l.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var s=0;s<this.dimension;++s)this.bounds[0][s]=-1/0,this.bounds[1][s]=1/0;this._state=l.slice().reverse(),this._velocity=o.slice().reverse(),this._time=[u],this._scratch=[l.slice(),l.slice(),l.slice(),l.slice(),l.slice()]}var e=h.prototype;function f(l){for(var o=new Array(l),u=0;u<l;++u)o[u]=0;return o}e.flush=function(l){var o=d.gt(this._time,l)-1;o<=0||(this._time.splice(0,o),this._state.splice(0,o*this.dimension),this._velocity.splice(0,o*this.dimension))},e.curve=function(l){var o=this._time,u=o.length,s=d.le(o,l),i=this._scratch[0],c=this._state,n=this._velocity,a=this.dimension,g=this.bounds;if(s<0)for(var p=a-1,y=0;y<a;++y,--p)i[y]=c[p];else if(s>=u-1){p=c.length-1;var v=l-o[u-1];for(y=0;y<a;++y,--p)i[y]=c[p]+v*n[p]}else{p=a*(s+1)-1;var b=o[s],x=o[s+1]-b||1,T=this._scratch[1],A=this._scratch[2],S=this._scratch[3],w=this._scratch[4],E=!0;for(y=0;y<a;++y,--p)T[y]=c[p],S[y]=n[p]*x,A[y]=c[p+a],w[y]=n[p+a]*x,E=E&&T[y]===A[y]&&S[y]===w[y]&&S[y]===0;if(E)for(y=0;y<a;++y)i[y]=T[y];else t(T,S,A,w,(l-b)/x,i)}var k=g[0],L=g[1];for(y=0;y<a;++y)i[y]=m(k[y],L[y],i[y]);return i},e.dcurve=function(l){var o=this._time,u=o.length,s=d.le(o,l),i=this._scratch[0],c=this._state,n=this._velocity,a=this.dimension;if(s>=u-1)for(var g=c.length-1,p=(o[u-1],0);p<a;++p,--g)i[p]=n[g];else{g=a*(s+1)-1;var y=o[s],v=o[s+1]-y||1,b=this._scratch[1],x=this._scratch[2],T=this._scratch[3],A=this._scratch[4],S=!0;for(p=0;p<a;++p,--g)b[p]=c[g],T[p]=n[g]*v,x[p]=c[g+a],A[p]=n[g+a]*v,S=S&&b[p]===x[p]&&T[p]===A[p]&&T[p]===0;if(S)for(p=0;p<a;++p)i[p]=0;else for(t.derivative(b,T,x,A,(l-y)/v,i),p=0;p<a;++p)i[p]/=v}return i},e.lastT=function(){var l=this._time;return l[l.length-1]},e.stable=function(){for(var l=this._velocity,o=l.length,u=this.dimension-1;u>=0;--u)if(l[--o])return!1;return!0},e.jump=function(l){var o=this.lastT(),u=this.dimension;if(!(l<o||arguments.length!==u+1)){var s=this._state,i=this._velocity,c=s.length-this.dimension,n=this.bounds,a=n[0],g=n[1];this._time.push(o,l);for(var p=0;p<2;++p)for(var y=0;y<u;++y)s.push(s[c++]),i.push(0);for(this._time.push(l),y=u;y>0;--y)s.push(m(a[y-1],g[y-1],arguments[y])),i.push(0)}},e.push=function(l){var o=this.lastT(),u=this.dimension;if(!(l<o||arguments.length!==u+1)){var s=this._state,i=this._velocity,c=s.length-this.dimension,n=l-o,a=this.bounds,g=a[0],p=a[1],y=n>1e-6?1/n:0;this._time.push(l);for(var v=u;v>0;--v){var b=m(g[v-1],p[v-1],arguments[v]);s.push(b),i.push((b-s[c++])*y)}}},e.set=function(l){var o=this.dimension;if(!(l<this.lastT()||arguments.length!==o+1)){var u=this._state,s=this._velocity,i=this.bounds,c=i[0],n=i[1];this._time.push(l);for(var a=o;a>0;--a)u.push(m(c[a-1],n[a-1],arguments[a])),s.push(0)}},e.move=function(l){var o=this.lastT(),u=this.dimension;if(!(l<=o||arguments.length!==u+1)){var s=this._state,i=this._velocity,c=s.length-this.dimension,n=this.bounds,a=n[0],g=n[1],p=l-o,y=p>1e-6?1/p:0;this._time.push(l);for(var v=u;v>0;--v){var b=arguments[v];s.push(m(a[v-1],g[v-1],s[c++]+b)),i.push(b*y)}}},e.idle=function(l){var o=this.lastT();if(!(l<o)){var u=this.dimension,s=this._state,i=this._velocity,c=s.length-u,n=this.bounds,a=n[0],g=n[1],p=l-o;this._time.push(l);for(var y=u-1;y>=0;--y)s.push(m(a[y],g[y],s[c]+p*i[c])),i.push(0),c+=1}}},{"binary-search-bounds":103,"cubic-hermite":156}],248:[function(r,I,B){var t=r("dtype");I.exports=function(d,m,h){if(!d)throw new TypeError("must specify data as first parameter");if(h=0|+(h||0),Array.isArray(d)&&d[0]&&typeof d[0][0]=="number"){var e,f,l,o,u=d[0].length,s=d.length*u;m&&typeof m!="string"||(m=new(t(m||"float32"))(s+h));var i=m.length-h;if(s!==i)throw new Error("source length "+s+" ("+u+"x"+d.length+") does not match destination length "+i);for(e=0,l=h;e<d.length;e++)for(f=0;f<u;f++)m[l++]=d[e][f]===null?NaN:d[e][f]}else if(m&&typeof m!="string")m.set(d,h);else{var c=t(m||"float32");if(Array.isArray(d)||m==="array")for(m=new c(d.length+h),e=0,l=h,o=m.length;l<o;l++,e++)m[l]=d[e]===null?NaN:d[e];else h===0?m=new c(d):(m=new c(d.length+h)).set(d,h)}return m}},{dtype:181}],249:[function(r,I,B){var t=r("css-font/stringify"),d=[32,126];I.exports=function(m){var h=(m=m||{}).shape?m.shape:m.canvas?[m.canvas.width,m.canvas.height]:[512,512],e=m.canvas||document.createElement("canvas"),f=m.font,l=typeof m.step=="number"?[m.step,m.step]:m.step||[32,32],o=m.chars||d;if(f&&typeof f!="string"&&(f=t(f)),Array.isArray(o)){if(o.length===2&&typeof o[0]=="number"&&typeof o[1]=="number"){for(var u=[],s=o[0],i=0;s<=o[1];s++)u[i++]=String.fromCharCode(s);o=u}}else o=String(o).split("");h=h.slice(),e.width=h[0],e.height=h[1];var c=e.getContext("2d");c.fillStyle="#000",c.fillRect(0,0,e.width,e.height),c.font=f,c.textAlign="center",c.textBaseline="middle",c.fillStyle="#fff";var n=l[0]/2,a=l[1]/2;for(s=0;s<o.length;s++)c.fillText(o[s],n,a),(n+=l[0])>h[0]-l[0]/2&&(n=l[0]/2,a+=l[1]);return e}},{"css-font/stringify":153}],250:[function(r,I,B){function t(e,f){f||(f={}),(typeof e=="string"||Array.isArray(e))&&(f.family=e);var l=Array.isArray(f.family)?f.family.join(", "):f.family;if(!l)throw Error("`family` must be defined");var o=f.size||f.fontSize||f.em||48,u=f.weight||f.fontWeight||"",s=(e=[f.style||f.fontStyle||"",u,o].join(" ")+"px "+l,f.origin||"top");if(t.cache[l]&&o<=t.cache[l].em)return d(t.cache[l],s);var i=f.canvas||t.canvas,c=i.getContext("2d"),n={upper:f.upper!==void 0?f.upper:"H",lower:f.lower!==void 0?f.lower:"x",descent:f.descent!==void 0?f.descent:"p",ascent:f.ascent!==void 0?f.ascent:"h",tittle:f.tittle!==void 0?f.tittle:"i",overshoot:f.overshoot!==void 0?f.overshoot:"O"},a=Math.ceil(1.5*o);i.height=a,i.width=.5*a,c.font=e;var g={top:0};c.clearRect(0,0,a,a),c.textBaseline="top",c.fillStyle="black",c.fillText("H",0,0);var p=m(c.getImageData(0,0,a,a));c.clearRect(0,0,a,a),c.textBaseline="bottom",c.fillText("H",0,a);var y=m(c.getImageData(0,0,a,a));g.lineHeight=g.bottom=a-y+p,c.clearRect(0,0,a,a),c.textBaseline="alphabetic",c.fillText("H",0,a);var v=a-m(c.getImageData(0,0,a,a))-1+p;g.baseline=g.alphabetic=v,c.clearRect(0,0,a,a),c.textBaseline="middle",c.fillText("H",0,.5*a);var b=m(c.getImageData(0,0,a,a));g.median=g.middle=a-b-1+p-.5*a,c.clearRect(0,0,a,a),c.textBaseline="hanging",c.fillText("H",0,.5*a);var x=m(c.getImageData(0,0,a,a));g.hanging=a-x-1+p-.5*a,c.clearRect(0,0,a,a),c.textBaseline="ideographic",c.fillText("H",0,a);var T=m(c.getImageData(0,0,a,a));if(g.ideographic=a-T-1+p,n.upper&&(c.clearRect(0,0,a,a),c.textBaseline="top",c.fillText(n.upper,0,0),g.upper=m(c.getImageData(0,0,a,a)),g.capHeight=g.baseline-g.upper),n.lower&&(c.clearRect(0,0,a,a),c.textBaseline="top",c.fillText(n.lower,0,0),g.lower=m(c.getImageData(0,0,a,a)),g.xHeight=g.baseline-g.lower),n.tittle&&(c.clearRect(0,0,a,a),c.textBaseline="top",c.fillText(n.tittle,0,0),g.tittle=m(c.getImageData(0,0,a,a))),n.ascent&&(c.clearRect(0,0,a,a),c.textBaseline="top",c.fillText(n.ascent,0,0),g.ascent=m(c.getImageData(0,0,a,a))),n.descent&&(c.clearRect(0,0,a,a),c.textBaseline="top",c.fillText(n.descent,0,0),g.descent=h(c.getImageData(0,0,a,a))),n.overshoot){c.clearRect(0,0,a,a),c.textBaseline="top",c.fillText(n.overshoot,0,0);var A=h(c.getImageData(0,0,a,a));g.overshoot=A-v}for(var S in g)g[S]/=o;return g.em=o,t.cache[l]=g,d(g,s)}function d(e,f){var l={};for(var o in typeof f=="string"&&(f=e[f]),e)o!=="em"&&(l[o]=e[o]-f);return l}function m(e){for(var f=e.height,l=e.data,o=3;o<l.length;o+=4)if(l[o]!==0)return Math.floor(.25*(o-3)/f)}function h(e){for(var f=e.height,l=e.data,o=l.length-1;o>0;o-=4)if(l[o]!==0)return Math.floor(.25*(o-3)/f)}I.exports=t,t.canvas=document.createElement("canvas"),t.cache={}},{}],251:[function(r,I,B){I.exports=function(a){return new e(a||n,null)};function t(a,g,p,y,v,b){this._color=a,this.key=g,this.value=p,this.left=y,this.right=v,this._count=b}function d(a){return new t(a._color,a.key,a.value,a.left,a.right,a._count)}function m(a,g){return new t(a,g.key,g.value,g.left,g.right,g._count)}function h(a){a._count=1+(a.left?a.left._count:0)+(a.right?a.right._count:0)}function e(a,g){this._compare=a,this.root=g}var f=e.prototype;function l(a,g){var p;return g.left&&(p=l(a,g.left))?p:(p=a(g.key,g.value))||(g.right?l(a,g.right):void 0)}function o(a,g,p,y){if(g(a,y.key)<=0){var v;if(y.left&&(v=o(a,g,p,y.left))||(v=p(y.key,y.value)))return v}if(y.right)return o(a,g,p,y.right)}function u(a,g,p,y,v){var b,x=p(a,v.key),T=p(g,v.key);if(x<=0&&(v.left&&(b=u(a,g,p,y,v.left))||T>0&&(b=y(v.key,v.value))))return b;if(T>0&&v.right)return u(a,g,p,y,v.right)}function s(a,g){this.tree=a,this._stack=g}Object.defineProperty(f,"keys",{get:function(){var a=[];return this.forEach(function(g,p){a.push(g)}),a}}),Object.defineProperty(f,"values",{get:function(){var a=[];return this.forEach(function(g,p){a.push(p)}),a}}),Object.defineProperty(f,"length",{get:function(){return this.root?this.root._count:0}}),f.insert=function(a,g){for(var p=this._compare,y=this.root,v=[],b=[];y;){var x=p(a,y.key);v.push(y),b.push(x),y=x<=0?y.left:y.right}v.push(new t(0,a,g,null,null,1));for(var T=v.length-2;T>=0;--T)y=v[T],b[T]<=0?v[T]=new t(y._color,y.key,y.value,v[T+1],y.right,y._count+1):v[T]=new t(y._color,y.key,y.value,y.left,v[T+1],y._count+1);for(T=v.length-1;T>1;--T){var A=v[T-1];if(y=v[T],A._color===1||y._color===1)break;var S=v[T-2];if(S.left===A)if(A.left===y){if(!(w=S.right)||w._color!==0){S._color=0,S.left=A.right,A._color=1,A.right=S,v[T-2]=A,v[T-1]=y,h(S),h(A),T>=3&&((E=v[T-3]).left===S?E.left=A:E.right=A);break}A._color=1,S.right=m(1,w),S._color=0,T-=1}else{if(!(w=S.right)||w._color!==0){A.right=y.left,S._color=0,S.left=y.right,y._color=1,y.left=A,y.right=S,v[T-2]=y,v[T-1]=A,h(S),h(A),h(y),T>=3&&((E=v[T-3]).left===S?E.left=y:E.right=y);break}A._color=1,S.right=m(1,w),S._color=0,T-=1}else if(A.right===y){if(!(w=S.left)||w._color!==0){S._color=0,S.right=A.left,A._color=1,A.left=S,v[T-2]=A,v[T-1]=y,h(S),h(A),T>=3&&((E=v[T-3]).right===S?E.right=A:E.left=A);break}A._color=1,S.left=m(1,w),S._color=0,T-=1}else{var w;if(!(w=S.left)||w._color!==0){var E;A.left=y.right,S._color=0,S.right=y.left,y._color=1,y.right=A,y.left=S,v[T-2]=y,v[T-1]=A,h(S),h(A),h(y),T>=3&&((E=v[T-3]).right===S?E.right=y:E.left=y);break}A._color=1,S.left=m(1,w),S._color=0,T-=1}}return v[0]._color=1,new e(p,v[0])},f.forEach=function(a,g,p){if(this.root)switch(arguments.length){case 1:return l(a,this.root);case 2:return o(g,this._compare,a,this.root);case 3:return this._compare(g,p)>=0?void 0:u(g,p,this._compare,a,this.root)}},Object.defineProperty(f,"begin",{get:function(){for(var a=[],g=this.root;g;)a.push(g),g=g.left;return new s(this,a)}}),Object.defineProperty(f,"end",{get:function(){for(var a=[],g=this.root;g;)a.push(g),g=g.right;return new s(this,a)}}),f.at=function(a){if(a<0)return new s(this,[]);for(var g=this.root,p=[];;){if(p.push(g),g.left){if(a<g.left._count){g=g.left;continue}a-=g.left._count}if(!a)return new s(this,p);if(a-=1,!g.right||a>=g.right._count)break;g=g.right}return new s(this,[])},f.ge=function(a){for(var g=this._compare,p=this.root,y=[],v=0;p;){var b=g(a,p.key);y.push(p),b<=0&&(v=y.length),p=b<=0?p.left:p.right}return y.length=v,new s(this,y)},f.gt=function(a){for(var g=this._compare,p=this.root,y=[],v=0;p;){var b=g(a,p.key);y.push(p),b<0&&(v=y.length),p=b<0?p.left:p.right}return y.length=v,new s(this,y)},f.lt=function(a){for(var g=this._compare,p=this.root,y=[],v=0;p;){var b=g(a,p.key);y.push(p),b>0&&(v=y.length),p=b<=0?p.left:p.right}return y.length=v,new s(this,y)},f.le=function(a){for(var g=this._compare,p=this.root,y=[],v=0;p;){var b=g(a,p.key);y.push(p),b>=0&&(v=y.length),p=b<0?p.left:p.right}return y.length=v,new s(this,y)},f.find=function(a){for(var g=this._compare,p=this.root,y=[];p;){var v=g(a,p.key);if(y.push(p),v===0)return new s(this,y);p=v<=0?p.left:p.right}return new s(this,[])},f.remove=function(a){var g=this.find(a);return g?g.remove():this},f.get=function(a){for(var g=this._compare,p=this.root;p;){var y=g(a,p.key);if(y===0)return p.value;p=y<=0?p.left:p.right}};var i=s.prototype;function c(a,g){a.key=g.key,a.value=g.value,a.left=g.left,a.right=g.right,a._color=g._color,a._count=g._count}function n(a,g){return a<g?-1:a>g?1:0}Object.defineProperty(i,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(i,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),i.clone=function(){return new s(this.tree,this._stack.slice())},i.remove=function(){var a=this._stack;if(a.length===0)return this.tree;var g=new Array(a.length),p=a[a.length-1];g[g.length-1]=new t(p._color,p.key,p.value,p.left,p.right,p._count);for(var y=a.length-2;y>=0;--y)(p=a[y]).left===a[y+1]?g[y]=new t(p._color,p.key,p.value,g[y+1],p.right,p._count):g[y]=new t(p._color,p.key,p.value,p.left,g[y+1],p._count);if((p=g[g.length-1]).left&&p.right){var v=g.length;for(p=p.left;p.right;)g.push(p),p=p.right;var b=g[v-1];for(g.push(new t(p._color,b.key,b.value,p.left,p.right,p._count)),g[v-1].key=p.key,g[v-1].value=p.value,y=g.length-2;y>=v;--y)p=g[y],g[y]=new t(p._color,p.key,p.value,p.left,g[y+1],p._count);g[v-1].left=g[v]}if((p=g[g.length-1])._color===0){var x=g[g.length-2];for(x.left===p?x.left=null:x.right===p&&(x.right=null),g.pop(),y=0;y<g.length;++y)g[y]._count--;return new e(this.tree._compare,g[0])}if(p.left||p.right){for(p.left?c(p,p.left):p.right&&c(p,p.right),p._color=1,y=0;y<g.length-1;++y)g[y]._count--;return new e(this.tree._compare,g[0])}if(g.length===1)return new e(this.tree._compare,null);for(y=0;y<g.length;++y)g[y]._count--;var T=g[g.length-2];return function(A){for(var S,w,E,k,L=A.length-1;L>=0;--L){if(S=A[L],L===0)return void(S._color=1);if((w=A[L-1]).left===S){if((E=w.right).right&&E.right._color===0)return k=(E=w.right=d(E)).right=d(E.right),w.right=E.left,E.left=w,E.right=k,E._color=w._color,S._color=1,w._color=1,k._color=1,h(w),h(E),L>1&&((M=A[L-2]).left===w?M.left=E:M.right=E),void(A[L-1]=E);if(E.left&&E.left._color===0)return k=(E=w.right=d(E)).left=d(E.left),w.right=k.left,E.left=k.right,k.left=w,k.right=E,k._color=w._color,w._color=1,E._color=1,S._color=1,h(w),h(E),h(k),L>1&&((M=A[L-2]).left===w?M.left=k:M.right=k),void(A[L-1]=k);if(E._color===1){if(w._color===0)return w._color=1,void(w.right=m(0,E));w.right=m(0,E);continue}E=d(E),w.right=E.left,E.left=w,E._color=w._color,w._color=0,h(w),h(E),L>1&&((M=A[L-2]).left===w?M.left=E:M.right=E),A[L-1]=E,A[L]=w,L+1<A.length?A[L+1]=S:A.push(S),L+=2}else{if((E=w.left).left&&E.left._color===0)return k=(E=w.left=d(E)).left=d(E.left),w.left=E.right,E.right=w,E.left=k,E._color=w._color,S._color=1,w._color=1,k._color=1,h(w),h(E),L>1&&((M=A[L-2]).right===w?M.right=E:M.left=E),void(A[L-1]=E);if(E.right&&E.right._color===0)return k=(E=w.left=d(E)).right=d(E.right),w.left=k.right,E.right=k.left,k.right=w,k.left=E,k._color=w._color,w._color=1,E._color=1,S._color=1,h(w),h(E),h(k),L>1&&((M=A[L-2]).right===w?M.right=k:M.left=k),void(A[L-1]=k);if(E._color===1){if(w._color===0)return w._color=1,void(w.left=m(0,E));w.left=m(0,E);continue}var M;E=d(E),w.left=E.right,E.right=w,E._color=w._color,w._color=0,h(w),h(E),L>1&&((M=A[L-2]).right===w?M.right=E:M.left=E),A[L-1]=E,A[L]=w,L+1<A.length?A[L+1]=S:A.push(S),L+=2}}}(g),T.left===p?T.left=null:T.right=null,new e(this.tree._compare,g[0])},Object.defineProperty(i,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(i,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(i,"index",{get:function(){var a=0,g=this._stack;if(g.length===0){var p=this.tree.root;return p?p._count:0}g[g.length-1].left&&(a=g[g.length-1].left._count);for(var y=g.length-2;y>=0;--y)g[y+1]===g[y].right&&(++a,g[y].left&&(a+=g[y].left._count));return a},enumerable:!0}),i.next=function(){var a=this._stack;if(a.length!==0){var g=a[a.length-1];if(g.right)for(g=g.right;g;)a.push(g),g=g.left;else for(a.pop();a.length>0&&a[a.length-1].right===g;)g=a[a.length-1],a.pop()}},Object.defineProperty(i,"hasNext",{get:function(){var a=this._stack;if(a.length===0)return!1;if(a[a.length-1].right)return!0;for(var g=a.length-1;g>0;--g)if(a[g-1].left===a[g])return!0;return!1}}),i.update=function(a){var g=this._stack;if(g.length===0)throw new Error("Can't update empty node!");var p=new Array(g.length),y=g[g.length-1];p[p.length-1]=new t(y._color,y.key,a,y.left,y.right,y._count);for(var v=g.length-2;v>=0;--v)(y=g[v]).left===g[v+1]?p[v]=new t(y._color,y.key,y.value,p[v+1],y.right,y._count):p[v]=new t(y._color,y.key,y.value,y.left,p[v+1],y._count);return new e(this.tree._compare,p[0])},i.prev=function(){var a=this._stack;if(a.length!==0){var g=a[a.length-1];if(g.left)for(g=g.left;g;)a.push(g),g=g.right;else for(a.pop();a.length>0&&a[a.length-1].left===g;)g=a[a.length-1],a.pop()}},Object.defineProperty(i,"hasPrev",{get:function(){var a=this._stack;if(a.length===0)return!1;if(a[a.length-1].left)return!0;for(var g=a.length-1;g>0;--g)if(a[g-1].right===a[g])return!0;return!1}})},{}],252:[function(r,I,B){I.exports=function(t,d){if(typeof t!="string")throw new TypeError("must specify type string");if(d=d||{},typeof document=="undefined"&&!d.canvas)return null;var m=d.canvas||document.createElement("canvas");typeof d.width=="number"&&(m.width=d.width),typeof d.height=="number"&&(m.height=d.height);var h,e=d;try{var f=[t];t.indexOf("webgl")===0&&f.push("experimental-"+t);for(var l=0;l<f.length;l++)if(h=m.getContext(f[l],e))return h}catch(o){h=null}return h||null}},{}],253:[function(r,I,B){I.exports=function(v,b){var x=new o(v);return x.update(b),x};var t=r("./lib/text.js"),d=r("./lib/lines.js"),m=r("./lib/background.js"),h=r("./lib/cube.js"),e=r("./lib/ticks.js"),f=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function l(v,b){return v[0]=b[0],v[1]=b[1],v[2]=b[2],v}function o(v){this.gl=v,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=m(v)}var u=o.prototype;function s(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}u.update=function(v){function b(N,U,G){if(G in v){var X,K=v[G],Z=this[G];(N?Array.isArray(K)&&Array.isArray(K[0]):Array.isArray(K))?this[G]=X=[U(K[0]),U(K[1]),U(K[2])]:this[G]=X=[U(K),U(K),U(K)];for(var H=0;H<3;++H)if(X[H]!==Z[H])return!0}return!1}v=v||{};var x,T=b.bind(this,!1,Number),A=b.bind(this,!1,Boolean),S=b.bind(this,!1,String),w=b.bind(this,!0,function(N){if(Array.isArray(N)){if(N.length===3)return[+N[0],+N[1],+N[2],1];if(N.length===4)return[+N[0],+N[1],+N[2],+N[3]]}return[0,0,0,1]}),E=!1,k=!1;if("bounds"in v)for(var L=v.bounds,M=0;M<2;++M)for(var P=0;P<3;++P)L[M][P]!==this.bounds[M][P]&&(k=!0),this.bounds[M][P]=L[M][P];if("ticks"in v)for(x=v.ticks,E=!0,this.autoTicks=!1,M=0;M<3;++M)this.tickSpacing[M]=0;else T("tickSpacing")&&(this.autoTicks=!0,k=!0);if(this._firstInit&&("ticks"in v||"tickSpacing"in v||(this.autoTicks=!0),k=!0,E=!0,this._firstInit=!1),k&&this.autoTicks&&(x=e.create(this.bounds,this.tickSpacing),E=!0),E){for(M=0;M<3;++M)x[M].sort(function(N,U){return N.x-U.x});e.equal(x,this.ticks)?E=!1:this.ticks=x}A("tickEnable"),S("tickFont")&&(E=!0),T("tickSize"),T("tickAngle"),T("tickPad"),w("tickColor");var D=S("labels");S("labelFont")&&(D=!0),A("labelEnable"),T("labelSize"),T("labelPad"),w("labelColor"),A("lineEnable"),A("lineMirror"),T("lineWidth"),w("lineColor"),A("lineTickEnable"),A("lineTickMirror"),T("lineTickLength"),T("lineTickWidth"),w("lineTickColor"),A("gridEnable"),T("gridWidth"),w("gridColor"),A("zeroEnable"),w("zeroLineColor"),T("zeroLineWidth"),A("backgroundEnable"),w("backgroundColor"),this._text?this._text&&(D||E)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=t(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&E&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=d(this.gl,this.bounds,this.ticks))};var i=[new s,new s,new s];function c(v,b,x,T,A){for(var S=v.primalOffset,w=v.primalMinor,E=v.mirrorOffset,k=v.mirrorMinor,L=T[b],M=0;M<3;++M)if(b!==M){var P=S,D=E,N=w,U=k;L&1<<M&&(P=E,D=S,N=k,U=w),P[M]=x[0][M],D[M]=x[1][M],A[M]>0?(N[M]=-1,U[M]=0):(N[M]=0,U[M]=1)}}var n=[0,0,0],a={model:f,view:f,projection:f,_ortho:!1};u.isOpaque=function(){return!0},u.isTransparent=function(){return!1},u.drawTransparent=function(v){};var g=[0,0,0],p=[0,0,0],y=[0,0,0];u.draw=function(v){v=v||a;for(var b=this.gl,x=v.model||f,T=v.view||f,A=v.projection||f,S=this.bounds,w=v._ortho||!1,E=h(x,T,A,S,w),k=E.cubeEdges,L=E.axis,M=T[12],P=T[13],D=T[14],N=T[15],U=(w?2:1)*this.pixelRatio*(A[3]*M+A[7]*P+A[11]*D+A[15]*N)/b.drawingBufferHeight,G=0;G<3;++G)this.lastCubeProps.cubeEdges[G]=k[G],this.lastCubeProps.axis[G]=L[G];var X=i;for(G=0;G<3;++G)c(i[G],G,this.bounds,k,L);b=this.gl;var K,Z=n;for(G=0;G<3;++G)this.backgroundEnable[G]?Z[G]=L[G]:Z[G]=0;for(this._background.draw(x,T,A,S,Z,this.backgroundColor),this._lines.bind(x,T,A,this),G=0;G<3;++G){var H=[0,0,0];L[G]>0?H[G]=S[1][G]:H[G]=S[0][G];for(var Y=0;Y<2;++Y){var $=(G+1+Y)%3,z=(G+1+(1^Y))%3;this.gridEnable[$]&&this._lines.drawGrid($,z,this.bounds,H,this.gridColor[$],this.gridWidth[$]*this.pixelRatio)}for(Y=0;Y<2;++Y)$=(G+1+Y)%3,z=(G+1+(1^Y))%3,this.zeroEnable[z]&&Math.min(S[0][z],S[1][z])<=0&&Math.max(S[0][z],S[1][z])>=0&&this._lines.drawZero($,z,this.bounds,H,this.zeroLineColor[z],this.zeroLineWidth[z]*this.pixelRatio)}for(G=0;G<3;++G){this.lineEnable[G]&&this._lines.drawAxisLine(G,this.bounds,X[G].primalOffset,this.lineColor[G],this.lineWidth[G]*this.pixelRatio),this.lineMirror[G]&&this._lines.drawAxisLine(G,this.bounds,X[G].mirrorOffset,this.lineColor[G],this.lineWidth[G]*this.pixelRatio);var j=l(g,X[G].primalMinor),W=l(p,X[G].mirrorMinor),ee=this.lineTickLength;for(Y=0;Y<3;++Y){var J=U/x[5*Y];j[Y]*=ee[Y]*J,W[Y]*=ee[Y]*J}this.lineTickEnable[G]&&this._lines.drawAxisTicks(G,X[G].primalOffset,j,this.lineTickColor[G],this.lineTickWidth[G]*this.pixelRatio),this.lineTickMirror[G]&&this._lines.drawAxisTicks(G,X[G].mirrorOffset,W,this.lineTickColor[G],this.lineTickWidth[G]*this.pixelRatio)}this._lines.unbind(),this._text.bind(x,T,A,this.pixelRatio);var Q,te;function ie(ve){(te=[0,0,0])[ve]=1}function ae(ve,ke,Ee){var be=(ve+1)%3,xe=(ve+2)%3,ce=ke[be],ge=ke[xe],we=Ee[be],Me=Ee[xe];ce>0&&Me>0||ce>0&&Me<0||ce<0&&Me>0||ce<0&&Me<0?ie(be):(ge>0&&we>0||ge>0&&we<0||ge<0&&we>0||ge<0&&we<0)&&ie(xe)}for(G=0;G<3;++G){var he=X[G].primalMinor,se=X[G].mirrorMinor,de=l(y,X[G].primalOffset);for(Y=0;Y<3;++Y)this.lineTickEnable[G]&&(de[Y]+=U*he[Y]*Math.max(this.lineTickLength[Y],0)/x[5*Y]);var ue=[0,0,0];if(ue[G]=1,this.tickEnable[G]){for(this.tickAngle[G]===-3600?(this.tickAngle[G]=0,this.tickAlign[G]="auto"):this.tickAlign[G]=-1,Q=1,(K=[this.tickAlign[G],.5,Q])[0]==="auto"?K[0]=0:K[0]=parseInt(""+K[0]),te=[0,0,0],ae(G,he,se),Y=0;Y<3;++Y)de[Y]+=U*he[Y]*this.tickPad[Y]/x[5*Y];this._text.drawTicks(G,this.tickSize[G],this.tickAngle[G],de,this.tickColor[G],ue,te,K)}if(this.labelEnable[G]){for(Q=0,te=[0,0,0],this.labels[G].length>4&&(ie(G),Q=1),(K=[this.labelAlign[G],.5,Q])[0]==="auto"?K[0]=0:K[0]=parseInt(""+K[0]),Y=0;Y<3;++Y)de[Y]+=U*he[Y]*this.labelPad[Y]/x[5*Y];de[G]+=.5*(S[0][G]+S[1][G]),this._text.drawLabel(G,this.labelSize[G],this.labelAngle[G],de,this.labelColor[G],[0,0,0],te,K)}}this._text.unbind()},u.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":254,"./lib/cube.js":255,"./lib/lines.js":256,"./lib/text.js":258,"./lib/ticks.js":259}],254:[function(r,I,B){I.exports=function(f){for(var l=[],o=[],u=0,s=0;s<3;++s)for(var i=(s+1)%3,c=(s+2)%3,n=[0,0,0],a=[0,0,0],g=-1;g<=1;g+=2){o.push(u,u+2,u+1,u+1,u+2,u+3),n[s]=g,a[s]=g;for(var p=-1;p<=1;p+=2){n[i]=p;for(var y=-1;y<=1;y+=2)n[c]=y,l.push(n[0],n[1],n[2],a[0],a[1],a[2]),u+=1}var v=i;i=c,c=v}var b=t(f,new Float32Array(l)),x=t(f,new Uint16Array(o),f.ELEMENT_ARRAY_BUFFER),T=d(f,[{buffer:b,type:f.FLOAT,size:3,offset:0,stride:24},{buffer:b,type:f.FLOAT,size:3,offset:12,stride:24}],x),A=m(f);return A.attributes.position.location=0,A.attributes.normal.location=1,new h(f,b,T,A)};var t=r("gl-buffer"),d=r("gl-vao"),m=r("./shaders").bg;function h(f,l,o,u){this.gl=f,this.buffer=l,this.vao=o,this.shader=u}var e=h.prototype;e.draw=function(f,l,o,u,s,i){for(var c=!1,n=0;n<3;++n)c=c||s[n];if(c){var a=this.gl;a.enable(a.POLYGON_OFFSET_FILL),a.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:f,view:l,projection:o,bounds:u,enable:s,colors:i},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),a.disable(a.POLYGON_OFFSET_FILL)}},e.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":257,"gl-buffer":261,"gl-vao":353}],255:[function(r,I,B){I.exports=function(p,y,v,b,x){d(e,y,p),d(e,v,e);for(var T=0,A=0;A<2;++A){o[2]=b[A][2];for(var S=0;S<2;++S){o[1]=b[S][1];for(var w=0;w<2;++w)o[0]=b[w][0],s(f[T],o,e),T+=1}}var E=-1;for(A=0;A<8;++A){for(var k=f[A][3],L=0;L<3;++L)l[A][L]=f[A][L]/k;x&&(l[A][2]*=-1),k<0&&(E<0||l[A][2]<l[E][2])&&(E=A)}if(E<0){E=0;for(var M=0;M<3;++M){for(var P=(M+2)%3,D=(M+1)%3,N=-1,U=-1,G=0;G<2;++G){var X=(Z=G<<M)+(G<<P)+(1-G<<D),K=Z+(1-G<<P)+(G<<D);h(l[Z],l[X],l[K],u)<0||(G?N=1:U=1)}if(N<0||U<0)U>N&&(E|=1<<M);else{for(G=0;G<2;++G){X=(Z=G<<M)+(G<<P)+(1-G<<D),K=Z+(1-G<<P)+(G<<D);var Z,H=c([f[Z],f[X],f[K],f[Z+(1<<P)+(1<<D)]]);G?N=H:U=H}U>N&&(E|=1<<M)}}}var Y=7^E,$=-1;for(A=0;A<8;++A)A!==E&&A!==Y&&($<0||l[$][1]>l[A][1])&&($=A);var z=-1;for(A=0;A<3;++A)(W=$^1<<A)!==E&&W!==Y&&(z<0&&(z=W),(D=l[W])[0]<l[z][0]&&(z=W));var j=-1;for(A=0;A<3;++A){var W;(W=$^1<<A)!==E&&W!==Y&&W!==z&&(j<0&&(j=W),(D=l[W])[0]>l[j][0]&&(j=W))}var ee=n;ee[0]=ee[1]=ee[2]=0,ee[t.log2(z^$)]=$&z,ee[t.log2($^j)]=$&j;var J=7^j;J===E||J===Y?(J=7^z,ee[t.log2(j^J)]=J&j):ee[t.log2(z^J)]=J&z;var Q=a,te=E;for(M=0;M<3;++M)Q[M]=te&1<<M?-1:1;return g};var t=r("bit-twiddle"),d=r("gl-mat4/multiply"),m=r("split-polygon"),h=r("robust-orientation"),e=new Array(16),f=new Array(8),l=new Array(8),o=new Array(3),u=[0,0,0];function s(p,y,v){for(var b=0;b<4;++b){p[b]=v[12+b];for(var x=0;x<3;++x)p[b]+=y[x]*v[4*x+b]}}(function(){for(var p=0;p<8;++p)f[p]=[1,1,1,1],l[p]=[1,1,1]})();var i=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function c(p){for(var y=0;y<i.length;++y)if((p=m.positive(p,i[y])).length<3)return 0;var v=p[0],b=v[0]/v[3],x=v[1]/v[3],T=0;for(y=1;y+1<p.length;++y){var A=p[y],S=p[y+1],w=A[0]/A[3]-b,E=A[1]/A[3]-x,k=S[0]/S[3]-b,L=S[1]/S[3]-x;T+=Math.abs(w*L-E*k)}return T}var n=[1,1,1],a=[0,0,0],g={cubeEdges:n,axis:a}},{"bit-twiddle":104,"gl-mat4/multiply":295,"robust-orientation":534,"split-polygon":552}],256:[function(r,I,B){I.exports=function(n,a,g){var p=[],y=[0,0,0],v=[0,0,0],b=[0,0,0],x=[0,0,0];p.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var T=0;T<3;++T){for(var A=p.length/3|0,S=0;S<g[T].length;++S){var w=+g[T][S].x;p.push(w,0,1,w,1,1,w,0,-1,w,0,-1,w,1,1,w,1,-1)}var E=p.length/3|0;y[T]=A,v[T]=E-A,A=p.length/3|0;for(var k=0;k<g[T].length;++k)w=+g[T][k].x,p.push(w,0,1,w,1,1,w,0,-1,w,0,-1,w,1,1,w,1,-1);E=p.length/3|0,b[T]=A,x[T]=E-A}var L=t(n,new Float32Array(p)),M=d(n,[{buffer:L,type:n.FLOAT,size:3,stride:0,offset:0}]),P=m(n);return P.attributes.position.location=0,new i(n,L,M,P,v,y,x,b)};var t=r("gl-buffer"),d=r("gl-vao"),m=r("./shaders").line,h=[0,0,0],e=[0,0,0],f=[0,0,0],l=[0,0,0],o=[1,1];function u(n){return n[0]=n[1]=n[2]=0,n}function s(n,a){return n[0]=a[0],n[1]=a[1],n[2]=a[2],n}function i(n,a,g,p,y,v,b,x){this.gl=n,this.vertBuffer=a,this.vao=g,this.shader=p,this.tickCount=y,this.tickOffset=v,this.gridCount=b,this.gridOffset=x}var c=i.prototype;c.bind=function(n,a,g){this.shader.bind(),this.shader.uniforms.model=n,this.shader.uniforms.view=a,this.shader.uniforms.projection=g,o[0]=this.gl.drawingBufferWidth,o[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=o,this.vao.bind()},c.unbind=function(){this.vao.unbind()},c.drawAxisLine=function(n,a,g,p,y){var v=u(e);this.shader.uniforms.majorAxis=e,v[n]=a[1][n]-a[0][n],this.shader.uniforms.minorAxis=v;var b,x=s(l,g);x[n]+=a[0][n],this.shader.uniforms.offset=x,this.shader.uniforms.lineWidth=y,this.shader.uniforms.color=p,(b=u(f))[(n+2)%3]=1,this.shader.uniforms.screenAxis=b,this.vao.draw(this.gl.TRIANGLES,6),(b=u(f))[(n+1)%3]=1,this.shader.uniforms.screenAxis=b,this.vao.draw(this.gl.TRIANGLES,6)},c.drawAxisTicks=function(n,a,g,p,y){if(this.tickCount[n]){var v=u(h);v[n]=1,this.shader.uniforms.majorAxis=v,this.shader.uniforms.offset=a,this.shader.uniforms.minorAxis=g,this.shader.uniforms.color=p,this.shader.uniforms.lineWidth=y;var b=u(f);b[n]=1,this.shader.uniforms.screenAxis=b,this.vao.draw(this.gl.TRIANGLES,this.tickCount[n],this.tickOffset[n])}},c.drawGrid=function(n,a,g,p,y,v){if(this.gridCount[n]){var b=u(e);b[a]=g[1][a]-g[0][a],this.shader.uniforms.minorAxis=b;var x=s(l,p);x[a]+=g[0][a],this.shader.uniforms.offset=x;var T=u(h);T[n]=1,this.shader.uniforms.majorAxis=T;var A=u(f);A[n]=1,this.shader.uniforms.screenAxis=A,this.shader.uniforms.lineWidth=v,this.shader.uniforms.color=y,this.vao.draw(this.gl.TRIANGLES,this.gridCount[n],this.gridOffset[n])}},c.drawZero=function(n,a,g,p,y,v){var b=u(e);this.shader.uniforms.majorAxis=b,b[n]=g[1][n]-g[0][n],this.shader.uniforms.minorAxis=b;var x=s(l,p);x[n]+=g[0][n],this.shader.uniforms.offset=x;var T=u(f);T[a]=1,this.shader.uniforms.screenAxis=T,this.shader.uniforms.lineWidth=v,this.shader.uniforms.color=y,this.vao.draw(this.gl.TRIANGLES,6)},c.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":257,"gl-buffer":261,"gl-vao":353}],257:[function(r,I,B){var t=r("glslify"),d=r("gl-shader"),m=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, majorAxis, minorAxis, screenAxis;
uniform float lineWidth;
uniform vec2 screenShape;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

void main() {
  vec3 major = position.x * majorAxis;
  vec3 minor = position.y * minorAxis;

  vec3 vPosition = major + minor + offset;
  vec3 pPosition = project(vPosition);
  vec3 offset = project(vPosition + screenAxis * position.z);

  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;

  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);
}
`]),h=t([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);B.line=function(u){return d(u,m,h,null,[{name:"position",type:"vec3"}])};var e=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, axis, alignDir, alignOpt;
uniform float scale, angle, pixelScale;
uniform vec2 resolution;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

float computeViewAngle(vec3 a, vec3 b) {
  vec3 A = project(a);
  vec3 B = project(b);

  return atan(
    (B.y - A.y) * resolution.y,
    (B.x - A.x) * resolution.x
  );
}

const float PI = 3.141592;
const float TWO_PI = 2.0 * PI;
const float HALF_PI = 0.5 * PI;
const float ONE_AND_HALF_PI = 1.5 * PI;

int option = int(floor(alignOpt.x + 0.001));
float hv_ratio =       alignOpt.y;
bool enableAlign =    (alignOpt.z != 0.0);

float mod_angle(float a) {
  return mod(a, PI);
}

float positive_angle(float a) {
  return mod_angle((a < 0.0) ?
    a + TWO_PI :
    a
  );
}

float look_upwards(float a) {
  float b = positive_angle(a);
  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?
    b - PI :
    b;
}

float look_horizontal_or_vertical(float a, float ratio) {
  // ratio controls the ratio between being horizontal to (vertical + horizontal)
  // if ratio is set to 0.5 then it is 50%, 50%.
  // when using a higher ratio e.g. 0.75 the result would
  // likely be more horizontal than vertical.

  float b = positive_angle(a);

  return
    (b < (      ratio) * HALF_PI) ? 0.0 :
    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :
    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :
    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :
                                    0.0;
}

float roundTo(float a, float b) {
  return float(b * floor((a + 0.5 * b) / b));
}

float look_round_n_directions(float a, int n) {
  float b = positive_angle(a);
  float div = TWO_PI / float(n);
  float c = roundTo(b, div);
  return look_upwards(c);
}

float applyAlignOption(float rawAngle, float delta) {
  return
    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions
    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical
    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis
    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards
    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal
                    rawAngle;                // otherwise return back raw input angle
}

bool isAxisTitle = (axis.x == 0.0) &&
                   (axis.y == 0.0) &&
                   (axis.z == 0.0);

void main() {
  //Compute world offset
  float axisDistance = position.z;
  vec3 dataPosition = axisDistance * axis + offset;

  float beta = angle; // i.e. user defined attributes for each tick

  float axisAngle;
  float clipAngle;
  float flip;

  if (enableAlign) {
    axisAngle = (isAxisTitle) ? HALF_PI :
                      computeViewAngle(dataPosition, dataPosition + axis);
    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);

    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;
    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;

    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),
                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;

    beta += applyAlignOption(clipAngle, flip * PI);
  }

  //Compute plane offset
  vec2 planeCoord = position.xy * pixelScale;

  mat2 planeXform = scale * mat2(
     cos(beta), sin(beta),
    -sin(beta), cos(beta)
  );

  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;

  //Compute clip position
  vec3 clipPosition = project(dataPosition);

  //Apply text offset in clip coordinates
  clipPosition += vec3(viewOffset, 0.0);

  //Done
  gl_Position = vec4(clipPosition, 1.0);
}`]),f=t([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);B.text=function(u){return d(u,e,f,null,[{name:"position",type:"vec3"}])};var l=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec3 normal;

uniform mat4 model, view, projection;
uniform vec3 enable;
uniform vec3 bounds[2];

varying vec3 colorChannel;

void main() {

  vec3 signAxis = sign(bounds[1] - bounds[0]);

  vec3 realNormal = signAxis * normal;

  if(dot(realNormal, enable) > 0.0) {
    vec3 minRange = min(bounds[0], bounds[1]);
    vec3 maxRange = max(bounds[0], bounds[1]);
    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));
    gl_Position = projection * view * model * vec4(nPosition, 1.0);
  } else {
    gl_Position = vec4(0,0,0,0);
  }

  colorChannel = abs(realNormal);
}`]),o=t([`precision highp float;
#define GLSLIFY 1

uniform vec4 colors[3];

varying vec3 colorChannel;

void main() {
  gl_FragColor = colorChannel.x * colors[0] +
                 colorChannel.y * colors[1] +
                 colorChannel.z * colors[2];
}`]);B.bg=function(u){return d(u,l,o,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":332,glslify:434}],258:[function(r,I,B){(function(t){(function(){I.exports=function(i,c,n,a,g,p){var y=d(i),v=m(i,[{buffer:y,size:3}]),b=e(i);b.attributes.position.location=0;var x=new o(i,b,y,v);return x.update(c,n,a,g,p),x};var d=r("gl-buffer"),m=r("gl-vao"),h=r("vectorize-text"),e=r("./shaders").text,f=window||t.global||{},l=f.__TEXT_CACHE||{};f.__TEXT_CACHE={};function o(i,c,n,a){this.gl=i,this.shader=c,this.buffer=n,this.vao=a,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var u=o.prototype,s=[0,0];u.bind=function(i,c,n,a){this.vao.bind(),this.shader.bind();var g=this.shader.uniforms;g.model=i,g.view=c,g.projection=n,g.pixelScale=a,s[0]=this.gl.drawingBufferWidth,s[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=s},u.unbind=function(){this.vao.unbind()},u.update=function(i,c,n,a,g){var p=[];function y(E,k,L,M,P,D){var N=l[L];N||(N=l[L]={});var U=N[k];U||(U=N[k]=function(j,W){try{return h(j,W)}catch(ee){return console.warn('error vectorizing text:"'+j+'" error:',ee),{cells:[],positions:[]}}}(k,{triangles:!0,font:L,textAlign:"center",textBaseline:"middle",lineSpacing:P,styletags:D}));for(var G=(M||12)/12,X=U.positions,K=U.cells,Z=0,H=K.length;Z<H;++Z)for(var Y=K[Z],$=2;$>=0;--$){var z=X[Y[$]];p.push(G*z[0],-G*z[1],E)}}for(var v=[0,0,0],b=[0,0,0],x=[0,0,0],T=[0,0,0],A={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},S=0;S<3;++S){x[S]=p.length/3|0,y(.5*(i[0][S]+i[1][S]),c[S],n[S],12,1.25,A),T[S]=(p.length/3|0)-x[S],v[S]=p.length/3|0;for(var w=0;w<a[S].length;++w)a[S][w].text&&y(a[S][w].x,a[S][w].text,a[S][w].font||g,a[S][w].fontSize||12,1.25,A);b[S]=(p.length/3|0)-v[S]}this.buffer.update(p),this.tickOffset=v,this.tickCount=b,this.labelOffset=x,this.labelCount=T},u.drawTicks=function(i,c,n,a,g,p,y,v){this.tickCount[i]&&(this.shader.uniforms.axis=p,this.shader.uniforms.color=g,this.shader.uniforms.angle=n,this.shader.uniforms.scale=c,this.shader.uniforms.offset=a,this.shader.uniforms.alignDir=y,this.shader.uniforms.alignOpt=v,this.vao.draw(this.gl.TRIANGLES,this.tickCount[i],this.tickOffset[i]))},u.drawLabel=function(i,c,n,a,g,p,y,v){this.labelCount[i]&&(this.shader.uniforms.axis=p,this.shader.uniforms.color=g,this.shader.uniforms.angle=n,this.shader.uniforms.scale=c,this.shader.uniforms.offset=a,this.shader.uniforms.alignDir=y,this.shader.uniforms.alignOpt=v,this.vao.draw(this.gl.TRIANGLES,this.labelCount[i],this.labelOffset[i]))},u.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this)}).call(this,r("_process"))},{"./shaders":257,_process:514,"gl-buffer":261,"gl-vao":353,"vectorize-text":607}],259:[function(r,I,B){function t(d,m){var h=d+"",e=h.indexOf("."),f=0;e>=0&&(f=h.length-e-1);var l=Math.pow(10,f),o=Math.round(d*m*l),u=o+"";if(u.indexOf("e")>=0)return u;var s=o/l,i=o%l;o<0?(s=0|-Math.ceil(s),i=0|-i):(s=0|Math.floor(s),i|=0);var c=""+s;if(o<0&&(c="-"+c),f){for(var n=""+i;n.length<f;)n="0"+n;return c+"."+n}return c}B.create=function(d,m){for(var h=[],e=0;e<3;++e){for(var f=[],l=(d[0][e],d[1][e],0);l*m[e]<=d[1][e];++l)f.push({x:l*m[e],text:t(m[e],l)});for(l=-1;l*m[e]>=d[0][e];--l)f.push({x:l*m[e],text:t(m[e],l)});h.push(f)}return h},B.equal=function(d,m){for(var h=0;h<3;++h){if(d[h].length!==m[h].length)return!1;for(var e=0;e<d[h].length;++e){var f=d[h][e],l=m[h][e];if(f.x!==l.x||f.text!==l.text||f.font!==l.font||f.fontColor!==l.fontColor||f.fontSize!==l.fontSize||f.dx!==l.dx||f.dy!==l.dy)return!1}}return!0}},{}],260:[function(r,I,B){I.exports=function(g,p,y,v,b){var x=p.model||l,T=p.view||l,A=p.projection||l,S=p._ortho||!1,w=g.bounds,E=(b=b||m(x,T,A,w,S)).axis;h(o,T,x),h(o,A,o);for(var k=n,L=0;L<3;++L)k[L].lo=1/0,k[L].hi=-1/0,k[L].pixelsPerDataUnit=1/0;var M=t(e(o,o));e(o,o);for(var P=0;P<3;++P){var D=(P+1)%3,N=(P+2)%3,U=a;e:for(L=0;L<2;++L){var G=[];if(E[P]<0!=!!L){U[P]=w[L][P];for(var X=0;X<2;++X){U[D]=w[X^L][D];for(var K=0;K<2;++K)U[N]=w[K^X^L][N],G.push(U.slice())}var Z=S?5:4;for(X=Z;X===Z;++X){if(G.length===0)continue e;G=d.positive(G,M[X])}for(X=0;X<G.length;++X){N=G[X];var H=c(a,o,N,y,v);for(K=0;K<3;++K)k[K].lo=Math.min(k[K].lo,N[K]),k[K].hi=Math.max(k[K].hi,N[K]),K!==P&&(k[K].pixelsPerDataUnit=Math.min(k[K].pixelsPerDataUnit,Math.abs(H[K])))}}}}return k};var t=r("extract-frustum-planes"),d=r("split-polygon"),m=r("./lib/cube.js"),h=r("gl-mat4/multiply"),e=r("gl-mat4/transpose"),f=r("gl-vec4/transformMat4"),l=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),o=new Float32Array(16);function u(g,p,y){this.lo=g,this.hi=p,this.pixelsPerDataUnit=y}var s=[0,0,0,1],i=[0,0,0,1];function c(g,p,y,v,b){for(var x=0;x<3;++x){for(var T=s,A=i,S=0;S<3;++S)A[S]=T[S]=y[S];A[3]=T[3]=1,A[x]+=1,f(A,A,p),A[3]<0&&(g[x]=1/0),T[x]-=1,f(T,T,p),T[3]<0&&(g[x]=1/0);var w=(T[0]/T[3]-A[0]/A[3])*v,E=(T[1]/T[3]-A[1]/A[3])*b;g[x]=.25*Math.sqrt(w*w+E*E)}return g}var n=[new u(1/0,-1/0,1/0),new u(1/0,-1/0,1/0),new u(1/0,-1/0,1/0)],a=[0,0,0]},{"./lib/cube.js":255,"extract-frustum-planes":245,"gl-mat4/multiply":295,"gl-mat4/transpose":306,"gl-vec4/transformMat4":424,"split-polygon":552}],261:[function(r,I,B){var t=r("typedarray-pool"),d=r("ndarray-ops"),m=r("ndarray"),h=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function e(u,s,i,c,n){this.gl=u,this.type=s,this.handle=i,this.length=c,this.usage=n}var f=e.prototype;function l(u,s,i,c,n,a){var g=n.length*n.BYTES_PER_ELEMENT;if(a<0)return u.bufferData(s,n,c),g;if(g+a>i)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return u.bufferSubData(s,a,n),i}function o(u,s){for(var i=t.malloc(u.length,s),c=u.length,n=0;n<c;++n)i[n]=u[n];return i}f.bind=function(){this.gl.bindBuffer(this.type,this.handle)},f.unbind=function(){this.gl.bindBuffer(this.type,null)},f.dispose=function(){this.gl.deleteBuffer(this.handle)},f.update=function(u,s){if(typeof s!="number"&&(s=-1),this.bind(),typeof u=="object"&&u.shape!==void 0){var i=u.dtype;if(h.indexOf(i)<0&&(i="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER&&(i=gl.getExtension("OES_element_index_uint")&&i!=="uint16"?"uint32":"uint16"),i===u.dtype&&function(g,p){for(var y=1,v=p.length-1;v>=0;--v){if(p[v]!==y)return!1;y*=g[v]}return!0}(u.shape,u.stride))u.offset===0&&u.data.length===u.shape[0]?this.length=l(this.gl,this.type,this.length,this.usage,u.data,s):this.length=l(this.gl,this.type,this.length,this.usage,u.data.subarray(u.offset,u.shape[0]),s);else{var c=t.malloc(u.size,i),n=m(c,u.shape);d.assign(n,u),this.length=l(this.gl,this.type,this.length,this.usage,s<0?c:c.subarray(0,u.size),s),t.free(c)}}else if(Array.isArray(u)){var a;a=this.type===this.gl.ELEMENT_ARRAY_BUFFER?o(u,"uint16"):o(u,"float32"),this.length=l(this.gl,this.type,this.length,this.usage,s<0?a:a.subarray(0,u.length),s),t.free(a)}else if(typeof u=="object"&&typeof u.length=="number")this.length=l(this.gl,this.type,this.length,this.usage,u,s);else{if(typeof u!="number"&&u!==void 0)throw new Error("gl-buffer: Invalid data type");if(s>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");(u|=0)<=0&&(u=1),this.gl.bufferData(this.type,0|u,this.usage),this.length=u}},I.exports=function(u,s,i,c){if(i=i||u.ARRAY_BUFFER,c=c||u.DYNAMIC_DRAW,i!==u.ARRAY_BUFFER&&i!==u.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(c!==u.DYNAMIC_DRAW&&c!==u.STATIC_DRAW&&c!==u.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var n=u.createBuffer(),a=new e(u,i,n,0,c);return a.update(s),a}},{ndarray:472,"ndarray-ops":467,"typedarray-pool":601}],262:[function(r,I,B){var t=r("gl-vec3");I.exports=function(m,h){var e=m.positions,f=m.vectors,l={positions:[],vertexIntensity:[],vertexIntensityBounds:m.vertexIntensityBounds,vectors:[],cells:[],coneOffset:m.coneOffset,colormap:m.colormap};if(m.positions.length===0)return h&&(h[0]=[0,0,0],h[1]=[0,0,0]),l;for(var o=0,u=1/0,s=-1/0,i=1/0,c=-1/0,n=1/0,a=-1/0,g=null,p=null,y=[],v=1/0,b=!1,x=0;x<e.length;x++){var T=e[x];u=Math.min(T[0],u),s=Math.max(T[0],s),i=Math.min(T[1],i),c=Math.max(T[1],c),n=Math.min(T[2],n),a=Math.max(T[2],a);var A=f[x];if(t.length(A)>o&&(o=t.length(A)),x){var S=2*t.distance(g,T)/(t.length(p)+t.length(A));S?(v=Math.min(v,S),b=!1):b=!0}b||(g=T,p=A),y.push(A)}var w=[u,i,n],E=[s,c,a];h&&(h[0]=w,h[1]=E),o===0&&(o=1);var k=1/o;isFinite(v)||(v=1),l.vectorScale=v;var L=m.coneSize||.5;m.absoluteConeSize&&(L=m.absoluteConeSize*k),l.coneScale=L,x=0;for(var M=0;x<e.length;x++)for(var P=(T=e[x])[0],D=T[1],N=T[2],U=y[x],G=t.length(U)*k,X=0;X<8;X++){l.positions.push([P,D,N,M++]),l.positions.push([P,D,N,M++]),l.positions.push([P,D,N,M++]),l.positions.push([P,D,N,M++]),l.positions.push([P,D,N,M++]),l.positions.push([P,D,N,M++]),l.vectors.push(U),l.vectors.push(U),l.vectors.push(U),l.vectors.push(U),l.vectors.push(U),l.vectors.push(U),l.vertexIntensity.push(G,G,G),l.vertexIntensity.push(G,G,G);var K=l.positions.length;l.cells.push([K-6,K-5,K-4],[K-3,K-2,K-1])}return l};var d=r("./lib/shaders");I.exports.createMesh=r("./create_mesh"),I.exports.createConeMesh=function(m,h){return I.exports.createMesh(m,h,{shaders:d,traceType:"cone"})}},{"./create_mesh":263,"./lib/shaders":264,"gl-vec3":372}],263:[function(r,I,B){var t=r("gl-shader"),d=r("gl-buffer"),m=r("gl-vao"),h=r("gl-texture2d"),e=r("gl-mat4/multiply"),f=r("gl-mat4/invert"),l=r("ndarray"),o=r("colormap"),u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function s(a,g,p,y,v,b,x,T,A,S,w){this.gl=a,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=g,this.dirty=!0,this.triShader=p,this.pickShader=y,this.trianglePositions=v,this.triangleVectors=b,this.triangleColors=T,this.triangleUVs=A,this.triangleIds=x,this.triangleVAO=S,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=w,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=u,this._view=u,this._projection=u,this._resolution=[1,1]}var i=s.prototype;function c(a,g){var p=t(a,g.meshShader.vertex,g.meshShader.fragment,null,g.meshShader.attributes);return p.attributes.position.location=0,p.attributes.color.location=2,p.attributes.uv.location=3,p.attributes.vector.location=4,p}function n(a,g){var p=t(a,g.pickShader.vertex,g.pickShader.fragment,null,g.pickShader.attributes);return p.attributes.position.location=0,p.attributes.id.location=1,p.attributes.vector.location=4,p}i.isOpaque=function(){return this.opacity>=1},i.isTransparent=function(){return this.opacity<1},i.pickSlots=1,i.setPickBase=function(a){this.pickId=a},i.update=function(a){a=a||{};var g=this.gl;this.dirty=!0,"lightPosition"in a&&(this.lightPosition=a.lightPosition),"opacity"in a&&(this.opacity=a.opacity),"ambient"in a&&(this.ambientLight=a.ambient),"diffuse"in a&&(this.diffuseLight=a.diffuse),"specular"in a&&(this.specularLight=a.specular),"roughness"in a&&(this.roughness=a.roughness),"fresnel"in a&&(this.fresnel=a.fresnel),a.tubeScale!==void 0&&(this.tubeScale=a.tubeScale),a.vectorScale!==void 0&&(this.vectorScale=a.vectorScale),a.coneScale!==void 0&&(this.coneScale=a.coneScale),a.coneOffset!==void 0&&(this.coneOffset=a.coneOffset),a.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=g.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=g.LINEAR,this.texture.setPixels(function($){for(var z=o({colormap:$,nshades:256,format:"rgba"}),j=new Uint8Array(1024),W=0;W<256;++W){for(var ee=z[W],J=0;J<3;++J)j[4*W+J]=ee[J];j[4*W+3]=255*ee[3]}return l(j,[256,256,4],[4,0,1])}(a.colormap)),this.texture.generateMipmap());var p=a.cells,y=a.positions,v=a.vectors;if(y&&p&&v){var b=[],x=[],T=[],A=[],S=[];this.cells=p,this.positions=y,this.vectors=v;var w=a.meshColor||[1,1,1,1],E=a.vertexIntensity,k=1/0,L=-1/0;if(E)if(a.vertexIntensityBounds)k=+a.vertexIntensityBounds[0],L=+a.vertexIntensityBounds[1];else for(var M=0;M<E.length;++M){var P=E[M];k=Math.min(k,P),L=Math.max(L,P)}else for(M=0;M<y.length;++M)P=y[M][2],k=Math.min(k,P),L=Math.max(L,P);for(this.intensity=E||function($){for(var z=$.length,j=new Array(z),W=0;W<z;++W)j[W]=$[W][2];return j}(y),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],M=0;M<y.length;++M)for(var D=y[M],N=0;N<3;++N)!isNaN(D[N])&&isFinite(D[N])&&(this.bounds[0][N]=Math.min(this.bounds[0][N],D[N]),this.bounds[1][N]=Math.max(this.bounds[1][N],D[N]));var U=0;e:for(M=0;M<p.length;++M){var G=p[M];switch(G.length){case 3:for(N=0;N<3;++N){D=y[K=G[N]];for(var X=0;X<3;++X)if(isNaN(D[X])||!isFinite(D[X]))continue e}for(N=0;N<3;++N){var K;D=y[K=G[2-N]],b.push(D[0],D[1],D[2],D[3]);var Z=v[K];x.push(Z[0],Z[1],Z[2],Z[3]||0);var H,Y=w;Y.length===3?T.push(Y[0],Y[1],Y[2],1):T.push(Y[0],Y[1],Y[2],Y[3]),H=E?[(E[K]-k)/(L-k),0]:[(D[2]-k)/(L-k),0],A.push(H[0],H[1]),S.push(M)}U+=1}}this.triangleCount=U,this.trianglePositions.update(b),this.triangleVectors.update(x),this.triangleColors.update(T),this.triangleUVs.update(A),this.triangleIds.update(new Uint32Array(S))}},i.drawTransparent=i.draw=function(a){a=a||{};for(var g=this.gl,p=a.model||u,y=a.view||u,v=a.projection||u,b=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],x=0;x<3;++x)b[0][x]=Math.max(b[0][x],this.clipBounds[0][x]),b[1][x]=Math.min(b[1][x],this.clipBounds[1][x]);var T={model:p,view:y,projection:v,inverseModel:u.slice(),clipBounds:b,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};T.inverseModel=f(T.inverseModel,T.model),g.disable(g.CULL_FACE),this.texture.bind(0);var A=new Array(16);for(e(A,T.view,T.model),e(A,T.projection,A),f(A,A),x=0;x<3;++x)T.eyePosition[x]=A[12+x]/A[15];var S=A[15];for(x=0;x<3;++x)S+=this.lightPosition[x]*A[4*x+3];for(x=0;x<3;++x){for(var w=A[12+x],E=0;E<3;++E)w+=A[4*E+x]*this.lightPosition[E];T.lightPosition[x]=w/S}if(this.triangleCount>0){var k=this.triShader;k.bind(),k.uniforms=T,this.triangleVAO.bind(),g.drawArrays(g.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},i.drawPick=function(a){a=a||{};for(var g=this.gl,p=a.model||u,y=a.view||u,v=a.projection||u,b=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],x=0;x<3;++x)b[0][x]=Math.max(b[0][x],this.clipBounds[0][x]),b[1][x]=Math.min(b[1][x],this.clipBounds[1][x]);this._model=[].slice.call(p),this._view=[].slice.call(y),this._projection=[].slice.call(v),this._resolution=[g.drawingBufferWidth,g.drawingBufferHeight];var T={model:p,view:y,projection:v,clipBounds:b,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},A=this.pickShader;A.bind(),A.uniforms=T,this.triangleCount>0&&(this.triangleVAO.bind(),g.drawArrays(g.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind())},i.pick=function(a){if(!a||a.id!==this.pickId)return null;var g=a.value[0]+256*a.value[1]+65536*a.value[2],p=this.cells[g],y=this.positions[p[1]].slice(0,3),v={position:y,dataCoordinate:y,index:Math.floor(p[1]/48)};return this.traceType==="cone"?v.index=Math.floor(p[1]/48):this.traceType==="streamtube"&&(v.intensity=this.intensity[p[1]],v.velocity=this.vectors[p[1]].slice(0,3),v.divergence=this.vectors[p[1]][3],v.index=g),v},i.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()},I.exports=function(a,g,p){var y=p.shaders;arguments.length===1&&(a=(g=a).gl);var v=c(a,y),b=n(a,y),x=h(a,l(new Uint8Array([255,255,255,255]),[1,1,4]));x.generateMipmap(),x.minFilter=a.LINEAR_MIPMAP_LINEAR,x.magFilter=a.LINEAR;var T=d(a),A=d(a),S=d(a),w=d(a),E=d(a),k=m(a,[{buffer:T,type:a.FLOAT,size:4},{buffer:E,type:a.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:S,type:a.FLOAT,size:4},{buffer:w,type:a.FLOAT,size:2},{buffer:A,type:a.FLOAT,size:4}]),L=new s(a,x,v,b,T,A,E,S,w,k,p.traceType||"cone");return L.update(g),L}},{colormap:137,"gl-buffer":261,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-shader":332,"gl-texture2d":348,"gl-vao":353,ndarray:472}],264:[function(r,I,B){var t=r("glslify"),d=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec3 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, coneScale, coneOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * conePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(conePosition, 1.0);
  vec4 t_position  = view * conePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = conePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),m=t([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),h=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float vectorScale, coneScale, coneOffset;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);
  gl_Position = projection * view * conePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),e=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);B.meshShader={vertex:d,fragment:m,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},B.pickShader={vertex:h,fragment:e,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:434}],265:[function(r,I,B){I.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],266:[function(r,I,B){var t=r("./1.0/numbers");I.exports=function(d){return t[d]}},{"./1.0/numbers":265}],267:[function(r,I,B){I.exports=function(s){var i=s.gl,c=t(i),n=d(i,[{buffer:c,type:i.FLOAT,size:3,offset:0,stride:40},{buffer:c,type:i.FLOAT,size:4,offset:12,stride:40},{buffer:c,type:i.FLOAT,size:3,offset:28,stride:40}]),a=m(i);a.attributes.position.location=0,a.attributes.color.location=1,a.attributes.offset.location=2;var g=new e(i,c,n,a);return g.update(s),g};var t=r("gl-buffer"),d=r("gl-vao"),m=r("./shaders/index"),h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(s,i,c,n){this.gl=s,this.shader=n,this.buffer=i,this.vao=c,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var f=e.prototype;function l(s,i){for(var c=0;c<3;++c)s[0][c]=Math.min(s[0][c],i[c]),s[1][c]=Math.max(s[1][c],i[c])}f.isOpaque=function(){return!this.hasAlpha},f.isTransparent=function(){return this.hasAlpha},f.drawTransparent=f.draw=function(s){var i=this.gl,c=this.shader.uniforms;this.shader.bind();var n=c.view=s.view||h,a=c.projection=s.projection||h;c.model=s.model||h,c.clipBounds=this.clipBounds,c.opacity=this.opacity;var g=n[12],p=n[13],y=n[14],v=n[15],b=(s._ortho?2:1)*this.pixelRatio*(a[3]*g+a[7]*p+a[11]*y+a[15]*v)/i.drawingBufferHeight;this.vao.bind();for(var x=0;x<3;++x)i.lineWidth(this.lineWidth[x]*this.pixelRatio),c.capSize=this.capSize[x]*b,this.lineCount[x]&&i.drawArrays(i.LINES,this.lineOffset[x],this.lineCount[x]);this.vao.unbind()};var o=function(){for(var s=new Array(3),i=0;i<3;++i){for(var c=[],n=1;n<=2;++n)for(var a=-1;a<=1;a+=2){var g=[0,0,0];g[(n+i)%3]=a,c.push(g)}s[i]=c}return s}();function u(s,i,c,n){for(var a=o[n],g=0;g<a.length;++g){var p=a[g];s.push(i[0],i[1],i[2],c[0],c[1],c[2],c[3],p[0],p[1],p[2])}return a.length}f.update=function(s){"lineWidth"in(s=s||{})&&(this.lineWidth=s.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in s&&(this.capSize=s.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in s&&(this.opacity=+s.opacity,this.opacity<1&&(this.hasAlpha=!0));var i=s.color||[[0,0,0],[0,0,0],[0,0,0]],c=s.position,n=s.error;if(Array.isArray(i[0])||(i=[i,i,i]),c&&n){var a=[],g=c.length,p=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var y=0;y<3;++y){this.lineOffset[y]=p;e:for(var v=0;v<g;++v){for(var b=c[v],x=0;x<3;++x)if(isNaN(b[x])||!isFinite(b[x]))continue e;var T=n[v],A=i[y];if(Array.isArray(A[0])&&(A=i[v]),A.length===3?A=[A[0],A[1],A[2],1]:A.length===4&&(A=[A[0],A[1],A[2],A[3]],!this.hasAlpha&&A[3]<1&&(this.hasAlpha=!0)),!isNaN(T[0][y])&&!isNaN(T[1][y])){var S;T[0][y]<0&&((S=b.slice())[y]+=T[0][y],a.push(b[0],b[1],b[2],A[0],A[1],A[2],A[3],0,0,0,S[0],S[1],S[2],A[0],A[1],A[2],A[3],0,0,0),l(this.bounds,S),p+=2+u(a,S,A,y)),T[1][y]>0&&((S=b.slice())[y]+=T[1][y],a.push(b[0],b[1],b[2],A[0],A[1],A[2],A[3],0,0,0,S[0],S[1],S[2],A[0],A[1],A[2],A[3],0,0,0),l(this.bounds,S),p+=2+u(a,S,A,y))}}this.lineCount[y]=p-this.lineOffset[y]}this.buffer.update(a)}},f.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":269,"gl-buffer":261,"gl-vao":353}],268:[function(r,I,B){I.exports=function(t){typeof t=="string"&&(t=[t]);for(var d=[].slice.call(arguments,1),m=[],h=0;h<t.length-1;h++)m.push(t[h],d[h]||"");return m.push(t[h]),m.join("")}},{}],269:[function(r,I,B){var t=r("glslify"),d=r("gl-shader"),m=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, offset;
attribute vec4 color;
uniform mat4 model, view, projection;
uniform float capSize;
varying vec4 fragColor;
varying vec3 fragPosition;

void main() {
  vec4 worldPosition  = model * vec4(position, 1.0);
  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);
  gl_Position         = projection * view * worldPosition;
  fragColor           = color;
  fragPosition        = position;
}`]),h=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float opacity;
varying vec3 fragPosition;
varying vec4 fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  gl_FragColor = opacity * fragColor;
}`]);I.exports=function(e){return d(e,m,h,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":332,glslify:268}],270:[function(r,I,B){var t=r("gl-texture2d");I.exports=function(g,p,y,v){d||(d=g.FRAMEBUFFER_UNSUPPORTED,m=g.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,h=g.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,e=g.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var b=g.getExtension("WEBGL_draw_buffers");if(!f&&b&&function(k,L){var M=k.getParameter(L.MAX_COLOR_ATTACHMENTS_WEBGL);f=new Array(M+1);for(var P=0;P<=M;++P){for(var D=new Array(M),N=0;N<P;++N)D[N]=k.COLOR_ATTACHMENT0+N;for(N=P;N<M;++N)D[N]=k.NONE;f[P]=D}}(g,b),Array.isArray(p)&&(v=y,y=0|p[1],p=0|p[0]),typeof p!="number")throw new Error("gl-fbo: Missing shape parameter");var x=g.getParameter(g.MAX_RENDERBUFFER_SIZE);if(p<0||p>x||y<0||y>x)throw new Error("gl-fbo: Parameters are too large for FBO");var T=1;if("color"in(v=v||{})){if((T=Math.max(0|v.color,0))<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(T>1){if(!b)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(T>g.getParameter(b.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+T+" draw buffers")}}var A=g.UNSIGNED_BYTE,S=g.getExtension("OES_texture_float");if(v.float&&T>0){if(!S)throw new Error("gl-fbo: Context does not support floating point textures");A=g.FLOAT}else v.preferFloat&&T>0&&S&&(A=g.FLOAT);var w=!0;"depth"in v&&(w=!!v.depth);var E=!1;return"stencil"in v&&(E=!!v.stencil),new c(g,p,y,A,T,w,E,b)};var d,m,h,e,f=null;function l(g){return[g.getParameter(g.FRAMEBUFFER_BINDING),g.getParameter(g.RENDERBUFFER_BINDING),g.getParameter(g.TEXTURE_BINDING_2D)]}function o(g,p){g.bindFramebuffer(g.FRAMEBUFFER,p[0]),g.bindRenderbuffer(g.RENDERBUFFER,p[1]),g.bindTexture(g.TEXTURE_2D,p[2])}function u(g){switch(g){case d:throw new Error("gl-fbo: Framebuffer unsupported");case m:throw new Error("gl-fbo: Framebuffer incomplete attachment");case h:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case e:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function s(g,p,y,v,b,x){if(!v)return null;var T=t(g,p,y,b,v);return T.magFilter=g.NEAREST,T.minFilter=g.NEAREST,T.mipSamples=1,T.bind(),g.framebufferTexture2D(g.FRAMEBUFFER,x,g.TEXTURE_2D,T.handle,0),T}function i(g,p,y,v,b){var x=g.createRenderbuffer();return g.bindRenderbuffer(g.RENDERBUFFER,x),g.renderbufferStorage(g.RENDERBUFFER,v,p,y),g.framebufferRenderbuffer(g.FRAMEBUFFER,b,g.RENDERBUFFER,x),x}function c(g,p,y,v,b,x,T,A){this.gl=g,this._shape=[0|p,0|y],this._destroyed=!1,this._ext=A,this.color=new Array(b);for(var S=0;S<b;++S)this.color[S]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=v,this._useDepth=x,this._useStencil=T;var w=this,E=[0|p,0|y];Object.defineProperties(E,{0:{get:function(){return w._shape[0]},set:function(k){return w.width=k}},1:{get:function(){return w._shape[1]},set:function(k){return w.height=k}}}),this._shapeVector=E,function(k){var L=l(k.gl),M=k.gl,P=k.handle=M.createFramebuffer(),D=k._shape[0],N=k._shape[1],U=k.color.length,G=k._ext,X=k._useStencil,K=k._useDepth,Z=k._colorType;M.bindFramebuffer(M.FRAMEBUFFER,P);for(var H=0;H<U;++H)k.color[H]=s(M,D,N,Z,M.RGBA,M.COLOR_ATTACHMENT0+H);U===0?(k._color_rb=i(M,D,N,M.RGBA4,M.COLOR_ATTACHMENT0),G&&G.drawBuffersWEBGL(f[0])):U>1&&G.drawBuffersWEBGL(f[U]);var Y=M.getExtension("WEBGL_depth_texture");Y?X?k.depth=s(M,D,N,Y.UNSIGNED_INT_24_8_WEBGL,M.DEPTH_STENCIL,M.DEPTH_STENCIL_ATTACHMENT):K&&(k.depth=s(M,D,N,M.UNSIGNED_SHORT,M.DEPTH_COMPONENT,M.DEPTH_ATTACHMENT)):K&&X?k._depth_rb=i(M,D,N,M.DEPTH_STENCIL,M.DEPTH_STENCIL_ATTACHMENT):K?k._depth_rb=i(M,D,N,M.DEPTH_COMPONENT16,M.DEPTH_ATTACHMENT):X&&(k._depth_rb=i(M,D,N,M.STENCIL_INDEX,M.STENCIL_ATTACHMENT));var $=M.checkFramebufferStatus(M.FRAMEBUFFER);if($!==M.FRAMEBUFFER_COMPLETE){for(k._destroyed=!0,M.bindFramebuffer(M.FRAMEBUFFER,null),M.deleteFramebuffer(k.handle),k.handle=null,k.depth&&(k.depth.dispose(),k.depth=null),k._depth_rb&&(M.deleteRenderbuffer(k._depth_rb),k._depth_rb=null),H=0;H<k.color.length;++H)k.color[H].dispose(),k.color[H]=null;k._color_rb&&(M.deleteRenderbuffer(k._color_rb),k._color_rb=null),o(M,L),u($)}o(M,L)}(this)}var n=c.prototype;function a(g,p,y){if(g._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(g._shape[0]!==p||g._shape[1]!==y){var v=g.gl,b=v.getParameter(v.MAX_RENDERBUFFER_SIZE);if(p<0||p>b||y<0||y>b)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");g._shape[0]=p,g._shape[1]=y;for(var x=l(v),T=0;T<g.color.length;++T)g.color[T].shape=g._shape;g._color_rb&&(v.bindRenderbuffer(v.RENDERBUFFER,g._color_rb),v.renderbufferStorage(v.RENDERBUFFER,v.RGBA4,g._shape[0],g._shape[1])),g.depth&&(g.depth.shape=g._shape),g._depth_rb&&(v.bindRenderbuffer(v.RENDERBUFFER,g._depth_rb),g._useDepth&&g._useStencil?v.renderbufferStorage(v.RENDERBUFFER,v.DEPTH_STENCIL,g._shape[0],g._shape[1]):g._useDepth?v.renderbufferStorage(v.RENDERBUFFER,v.DEPTH_COMPONENT16,g._shape[0],g._shape[1]):g._useStencil&&v.renderbufferStorage(v.RENDERBUFFER,v.STENCIL_INDEX,g._shape[0],g._shape[1])),v.bindFramebuffer(v.FRAMEBUFFER,g.handle);var A=v.checkFramebufferStatus(v.FRAMEBUFFER);A!==v.FRAMEBUFFER_COMPLETE&&(g.dispose(),o(v,x),u(A)),o(v,x)}}Object.defineProperties(n,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(g){if(Array.isArray(g)||(g=[0|g,0|g]),g.length!==2)throw new Error("gl-fbo: Shape vector must be length 2");var p=0|g[0],y=0|g[1];return a(this,p,y),[p,y]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(g){return a(this,g|=0,this._shape[1]),g},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(g){return g|=0,a(this,this._shape[0],g),g},enumerable:!1}}),n.bind=function(){if(!this._destroyed){var g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,this.handle),g.viewport(0,0,this._shape[0],this._shape[1])}},n.dispose=function(){if(!this._destroyed){this._destroyed=!0;var g=this.gl;g.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(g.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var p=0;p<this.color.length;++p)this.color[p].dispose(),this.color[p]=null;this._color_rb&&(g.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":348}],271:[function(r,I,B){var t=r("sprintf-js").sprintf,d=r("gl-constants/lookup"),m=r("glsl-shader-name"),h=r("add-line-numbers");I.exports=function(e,f,l){var o=m(f)||"of unknown name (see npm glsl-shader-name)",u="unknown type";l!==void 0&&(u=l===d.FRAGMENT_SHADER?"fragment":"vertex");for(var s=t(`Error compiling %s shader %s:
`,u,o),i=t("%s%s",s,e),c=e.split(`
`),n={},a=0;a<c.length;a++){var g=c[a];if(g!==""&&g!=="\0"){var p=parseInt(g.split(":")[2]);if(isNaN(p))throw new Error(t("Could not parse error: %s",g));n[p]=g}}var y=h(f).split(`
`);for(a=0;a<y.length;a++)if(n[a+3]||n[a+2]||n[a+1]){var v=y[a];if(s+=v+`
`,n[a+1]){var b=n[a+1];b=b.substr(b.split(":",3).join(":").length+1).trim(),s+=t(`^^^ %s

`,b)}}return{long:s.trim(),short:i.trim()}}},{"add-line-numbers":72,"gl-constants/lookup":266,"glsl-shader-name":426,"sprintf-js":553}],272:[function(r,I,B){I.exports=function(i,c){var n=i.gl,a=h(n,f.vertex,f.fragment),g=h(n,f.pickVertex,f.pickFragment),p=e(n),y=e(n),v=e(n),b=e(n),x=new l(i,a,g,p,y,v,b);return x.update(c),i.addObject(x),x};var t=r("binary-search-bounds"),d=r("iota-array"),m=r("typedarray-pool"),h=r("gl-shader"),e=r("gl-buffer"),f=r("./lib/shaders");function l(i,c,n,a,g,p,y){this.plot=i,this.shader=c,this.pickShader=n,this.positionBuffer=a,this.weightBuffer=g,this.colorBuffer=p,this.idBuffer=y,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var o,u=l.prototype,s=[0,0,1,0,0,1,1,0,1,1,0,1];u.draw=(o=[1,0,0,0,1,0,0,0,1],function(){var i=this.plot,c=this.shader,n=this.bounds,a=this.numVertices;if(!(a<=0)){var g=i.gl,p=i.dataBox,y=n[2]-n[0],v=n[3]-n[1],b=p[2]-p[0],x=p[3]-p[1];o[0]=2*y/b,o[4]=2*v/x,o[6]=2*(n[0]-p[0])/b-1,o[7]=2*(n[1]-p[1])/x-1,c.bind();var T=c.uniforms;T.viewTransform=o,T.shape=this.shape;var A=c.attributes;this.positionBuffer.bind(),A.position.pointer(),this.weightBuffer.bind(),A.weight.pointer(g.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),A.color.pointer(g.UNSIGNED_BYTE,!0),g.drawArrays(g.TRIANGLES,0,a)}}),u.drawPick=function(){var i=[1,0,0,0,1,0,0,0,1],c=[0,0,0,0];return function(n){var a=this.plot,g=this.pickShader,p=this.bounds,y=this.numVertices;if(!(y<=0)){var v=a.gl,b=a.dataBox,x=p[2]-p[0],T=p[3]-p[1],A=b[2]-b[0],S=b[3]-b[1];i[0]=2*x/A,i[4]=2*T/S,i[6]=2*(p[0]-b[0])/A-1,i[7]=2*(p[1]-b[1])/S-1;for(var w=0;w<4;++w)c[w]=n>>8*w&255;this.pickOffset=n,g.bind();var E=g.uniforms;E.viewTransform=i,E.pickOffset=c,E.shape=this.shape;var k=g.attributes;return this.positionBuffer.bind(),k.position.pointer(),this.weightBuffer.bind(),k.weight.pointer(v.UNSIGNED_BYTE,!1),this.idBuffer.bind(),k.pickId.pointer(v.UNSIGNED_BYTE,!1),v.drawArrays(v.TRIANGLES,0,y),n+this.shape[0]*this.shape[1]}}}(),u.pick=function(i,c,n){var a=this.pickOffset,g=this.shape[0]*this.shape[1];if(n<a||n>=a+g)return null;var p=n-a,y=this.xData,v=this.yData;return{object:this,pointId:p,dataCoord:[y[p%this.shape[0]],v[p/this.shape[0]|0]]}},u.update=function(i){var c=(i=i||{}).shape||[0,0],n=i.x||d(c[0]),a=i.y||d(c[1]),g=i.z||new Float32Array(c[0]*c[1]),p=i.zsmooth!==!1;this.xData=n,this.yData=a;var y,v,b,x,T=i.colorLevels||[0],A=i.colorValues||[0,0,0,1],S=T.length,w=this.bounds;p?(y=w[0]=n[0],v=w[1]=a[0],b=w[2]=n[n.length-1],x=w[3]=a[a.length-1]):(y=w[0]=n[0]+(n[1]-n[0])/2,v=w[1]=a[0]+(a[1]-a[0])/2,b=w[2]=n[n.length-1]+(n[n.length-1]-n[n.length-2])/2,x=w[3]=a[a.length-1]+(a[a.length-1]-a[a.length-2])/2);var E=1/(b-y),k=1/(x-v),L=c[0],M=c[1];this.shape=[L,M];var P=(p?(L-1)*(M-1):L*M)*(s.length>>>1);this.numVertices=P;for(var D=m.mallocUint8(4*P),N=m.mallocFloat32(2*P),U=m.mallocUint8(2*P),G=m.mallocUint32(P),X=0,K=p?L-1:L,Z=p?M-1:M,H=0;H<Z;++H){var Y,$;p?(Y=k*(a[H]-v),$=k*(a[H+1]-v)):(Y=H<M-1?k*(a[H]-(a[H+1]-a[H])/2-v):k*(a[H]-(a[H]-a[H-1])/2-v),$=H<M-1?k*(a[H]+(a[H+1]-a[H])/2-v):k*(a[H]+(a[H]-a[H-1])/2-v));for(var z=0;z<K;++z){var j,W;p?(j=E*(n[z]-y),W=E*(n[z+1]-y)):(j=z<L-1?E*(n[z]-(n[z+1]-n[z])/2-y):E*(n[z]-(n[z]-n[z-1])/2-y),W=z<L-1?E*(n[z]+(n[z+1]-n[z])/2-y):E*(n[z]+(n[z]-n[z-1])/2-y));for(var ee=0;ee<s.length;ee+=2){var J,Q,te,ie,ae=s[ee],he=s[ee+1],se=g[p?(H+he)*L+(z+ae):H*L+z],de=t.le(T,se);if(de<0)J=A[0],Q=A[1],te=A[2],ie=A[3];else if(de===S-1)J=A[4*S-4],Q=A[4*S-3],te=A[4*S-2],ie=A[4*S-1];else{var ue=(se-T[de])/(T[de+1]-T[de]),ve=1-ue,ke=4*de,Ee=4*(de+1);J=ve*A[ke]+ue*A[Ee],Q=ve*A[ke+1]+ue*A[Ee+1],te=ve*A[ke+2]+ue*A[Ee+2],ie=ve*A[ke+3]+ue*A[Ee+3]}D[4*X]=255*J,D[4*X+1]=255*Q,D[4*X+2]=255*te,D[4*X+3]=255*ie,N[2*X]=.5*j+.5*W,N[2*X+1]=.5*Y+.5*$,U[2*X]=ae,U[2*X+1]=he,G[X]=H*L+z,X+=1}}}this.positionBuffer.update(N),this.weightBuffer.update(U),this.colorBuffer.update(D),this.idBuffer.update(G),m.free(N),m.free(D),m.free(U),m.free(G)},u.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":273,"binary-search-bounds":103,"gl-buffer":261,"gl-shader":332,"iota-array":441,"typedarray-pool":601}],273:[function(r,I,B){var t=r("glslify");I.exports={fragment:t([`precision lowp float;
#define GLSLIFY 1
varying vec4 fragColor;
void main() {
  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);
}
`]),vertex:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 color;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragColor;

void main() {
  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  fragColor = color;
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`]),pickFragment:t([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;
varying vec2 vWeight;

uniform vec2 shape;
uniform vec4 pickOffset;

void main() {
  vec2 d = step(.5, vWeight);
  vec4 id = fragId + pickOffset;
  id.x += d.x + d.y*shape.x;

  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  gl_FragColor = id/255.;
}
`]),pickVertex:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragId;
varying vec2 vWeight;

void main() {
  vWeight = weight;

  fragId = pickId;

  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`])}},{glslify:434}],274:[function(r,I,B){var t=r("glslify"),d=r("gl-shader"),m=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, nextPosition;
attribute float arcLength, lineWidth;
attribute vec4 color;

uniform vec2 screenShape;
uniform float pixelRatio;
uniform mat4 model, view, projection;

varying vec4 fragColor;
varying vec3 worldPosition;
varying float pixelArcLength;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  vec4 startPoint = project(position);
  vec4 endPoint   = project(nextPosition);

  vec2 A = startPoint.xy / startPoint.w;
  vec2 B =   endPoint.xy /   endPoint.w;

  float clipAngle = atan(
    (B.y - A.y) * screenShape.y,
    (B.x - A.x) * screenShape.x
  );

  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(
    sin(clipAngle),
    -cos(clipAngle)
  ) / screenShape;

  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);

  worldPosition = position;
  pixelArcLength = arcLength;
  fragColor = color;
}
`]),h=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3      clipBounds[2];
uniform sampler2D dashTexture;
uniform float     dashScale;
uniform float     opacity;

varying vec3    worldPosition;
varying float   pixelArcLength;
varying vec4    fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;
  if(dashWeight < 0.5) {
    discard;
  }
  gl_FragColor = fragColor * opacity;
}
`]),e=t([`precision highp float;
#define GLSLIFY 1

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl
vec4 packFloat(float v) {
  float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  float e = floor(log2(av));
  float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform float pickId;
uniform vec3 clipBounds[2];

varying vec3 worldPosition;
varying float pixelArcLength;
varying vec4 fragColor;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;

  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);
}`]),f=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];B.createShader=function(l){return d(l,m,h,null,f)},B.createPickShader=function(l){return d(l,m,e,null,f)}},{"gl-shader":332,glslify:276}],275:[function(r,I,B){I.exports=function(y){var v=y.gl||y.scene&&y.scene.gl,b=u(v);b.attributes.position.location=0,b.attributes.nextPosition.location=1,b.attributes.arcLength.location=2,b.attributes.lineWidth.location=3,b.attributes.color.location=4;var x=s(v);x.attributes.position.location=0,x.attributes.nextPosition.location=1,x.attributes.arcLength.location=2,x.attributes.lineWidth.location=3,x.attributes.color.location=4;for(var T=t(v),A=d(v,[{buffer:T,size:3,offset:0,stride:48},{buffer:T,size:3,offset:12,stride:48},{buffer:T,size:1,offset:24,stride:48},{buffer:T,size:1,offset:28,stride:48},{buffer:T,size:4,offset:32,stride:48}]),S=l(new Array(1024),[256,1,4]),w=0;w<1024;++w)S.data[w]=255;var E=m(v,S);E.wrap=v.REPEAT;var k=new g(v,b,x,T,A,E);return k.update(y),k};var t=r("gl-buffer"),d=r("gl-vao"),m=r("gl-texture2d"),h=new Uint8Array(4),e=new Float32Array(h.buffer),f=r("binary-search-bounds"),l=r("ndarray"),o=r("./lib/shaders"),u=o.createShader,s=o.createPickShader,i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function c(y,v){for(var b=0,x=0;x<3;++x){var T=y[x]-v[x];b+=T*T}return Math.sqrt(b)}function n(y){for(var v=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],b=0;b<3;++b)v[0][b]=Math.max(y[0][b],v[0][b]),v[1][b]=Math.min(y[1][b],v[1][b]);return v}function a(y,v,b,x){this.arcLength=y,this.position=v,this.index=b,this.dataCoordinate=x}function g(y,v,b,x,T,A){this.gl=y,this.shader=v,this.pickShader=b,this.buffer=x,this.vao=T,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=A,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var p=g.prototype;p.isTransparent=function(){return this.hasAlpha},p.isOpaque=function(){return!this.hasAlpha},p.pickSlots=1,p.setPickBase=function(y){this.pickId=y},p.drawTransparent=p.draw=function(y){if(this.vertexCount){var v=this.gl,b=this.shader,x=this.vao;b.bind(),b.uniforms={model:y.model||i,view:y.view||i,projection:y.projection||i,clipBounds:n(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[v.drawingBufferWidth,v.drawingBufferHeight],pixelRatio:this.pixelRatio},x.bind(),x.draw(v.TRIANGLE_STRIP,this.vertexCount),x.unbind()}},p.drawPick=function(y){if(this.vertexCount){var v=this.gl,b=this.pickShader,x=this.vao;b.bind(),b.uniforms={model:y.model||i,view:y.view||i,projection:y.projection||i,pickId:this.pickId,clipBounds:n(this.clipBounds),screenShape:[v.drawingBufferWidth,v.drawingBufferHeight],pixelRatio:this.pixelRatio},x.bind(),x.draw(v.TRIANGLE_STRIP,this.vertexCount),x.unbind()}},p.update=function(y){var v,b;this.dirty=!0;var x=!!y.connectGaps;"dashScale"in y&&(this.dashScale=y.dashScale),this.hasAlpha=!1,"opacity"in y&&(this.opacity=+y.opacity,this.opacity<1&&(this.hasAlpha=!0));var T=[],A=[],S=[],w=0,E=0,k=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],L=y.position||y.positions;if(L){var M=y.color||y.colors||[0,0,0,1],P=y.lineWidth||1,D=!1;e:for(v=1;v<L.length;++v){var N,U,G,X=L[v-1],K=L[v];for(A.push(w),S.push(X.slice()),b=0;b<3;++b){if(isNaN(X[b])||isNaN(K[b])||!isFinite(X[b])||!isFinite(K[b])){if(!x&&T.length>0){for(var Z=0;Z<24;++Z)T.push(T[T.length-12]);E+=2,D=!0}continue e}k[0][b]=Math.min(k[0][b],X[b],K[b]),k[1][b]=Math.max(k[1][b],X[b],K[b])}Array.isArray(M[0])?(N=M.length>v-1?M[v-1]:M.length>0?M[M.length-1]:[0,0,0,1],U=M.length>v?M[v]:M.length>0?M[M.length-1]:[0,0,0,1]):N=U=M,N.length===3&&(N=[N[0],N[1],N[2],1]),U.length===3&&(U=[U[0],U[1],U[2],1]),!this.hasAlpha&&N[3]<1&&(this.hasAlpha=!0),G=Array.isArray(P)?P.length>v-1?P[v-1]:P.length>0?P[P.length-1]:[0,0,0,1]:P;var H=w;if(w+=c(X,K),D){for(b=0;b<2;++b)T.push(X[0],X[1],X[2],K[0],K[1],K[2],H,G,N[0],N[1],N[2],N[3]);E+=2,D=!1}T.push(X[0],X[1],X[2],K[0],K[1],K[2],H,G,N[0],N[1],N[2],N[3],X[0],X[1],X[2],K[0],K[1],K[2],H,-G,N[0],N[1],N[2],N[3],K[0],K[1],K[2],X[0],X[1],X[2],w,-G,U[0],U[1],U[2],U[3],K[0],K[1],K[2],X[0],X[1],X[2],w,G,U[0],U[1],U[2],U[3]),E+=4}}if(this.buffer.update(T),A.push(w),S.push(L[L.length-1].slice()),this.bounds=k,this.vertexCount=E,this.points=S,this.arcLength=A,"dashes"in y){var Y=y.dashes.slice();for(Y.unshift(0),v=1;v<Y.length;++v)Y[v]=Y[v-1]+Y[v];var $=l(new Array(1024),[256,1,4]);for(v=0;v<256;++v){for(b=0;b<4;++b)$.set(v,0,b,0);1&f.le(Y,Y[Y.length-1]*v/255)?$.set(v,0,0,0):$.set(v,0,0,255)}this.texture.setPixels($)}},p.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},p.pick=function(y){if(!y||y.id!==this.pickId)return null;var v=function(L,M,P,D){return h[0]=D,h[1]=P,h[2]=M,h[3]=L,e[0]}(y.value[0],y.value[1],y.value[2],0),b=f.le(this.arcLength,v);if(b<0)return null;if(b===this.arcLength.length-1)return new a(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),b);for(var x=this.points[b],T=this.points[Math.min(b+1,this.points.length-1)],A=(v-this.arcLength[b])/(this.arcLength[b+1]-this.arcLength[b]),S=1-A,w=[0,0,0],E=0;E<3;++E)w[E]=S*x[E]+A*T[E];var k=Math.min(A<.5?b:b+1,this.points.length-1);return new a(v,w,k,this.points[k])}},{"./lib/shaders":274,"binary-search-bounds":103,"gl-buffer":261,"gl-texture2d":348,"gl-vao":353,ndarray:472}],276:[function(r,I,B){arguments[4][268][0].apply(B,arguments)},{dup:268}],277:[function(r,I,B){I.exports=function(t,d){var m=d[0],h=d[1],e=d[2],f=d[3],l=d[4],o=d[5],u=d[6],s=d[7],i=d[8],c=d[9],n=d[10],a=d[11],g=d[12],p=d[13],y=d[14],v=d[15];return t[0]=o*(n*v-a*y)-c*(u*v-s*y)+p*(u*a-s*n),t[1]=-(h*(n*v-a*y)-c*(e*v-f*y)+p*(e*a-f*n)),t[2]=h*(u*v-s*y)-o*(e*v-f*y)+p*(e*s-f*u),t[3]=-(h*(u*a-s*n)-o*(e*a-f*n)+c*(e*s-f*u)),t[4]=-(l*(n*v-a*y)-i*(u*v-s*y)+g*(u*a-s*n)),t[5]=m*(n*v-a*y)-i*(e*v-f*y)+g*(e*a-f*n),t[6]=-(m*(u*v-s*y)-l*(e*v-f*y)+g*(e*s-f*u)),t[7]=m*(u*a-s*n)-l*(e*a-f*n)+i*(e*s-f*u),t[8]=l*(c*v-a*p)-i*(o*v-s*p)+g*(o*a-s*c),t[9]=-(m*(c*v-a*p)-i*(h*v-f*p)+g*(h*a-f*c)),t[10]=m*(o*v-s*p)-l*(h*v-f*p)+g*(h*s-f*o),t[11]=-(m*(o*a-s*c)-l*(h*a-f*c)+i*(h*s-f*o)),t[12]=-(l*(c*y-n*p)-i*(o*y-u*p)+g*(o*n-u*c)),t[13]=m*(c*y-n*p)-i*(h*y-e*p)+g*(h*n-e*c),t[14]=-(m*(o*y-u*p)-l*(h*y-e*p)+g*(h*u-e*o)),t[15]=m*(o*n-u*c)-l*(h*n-e*c)+i*(h*u-e*o),t}},{}],278:[function(r,I,B){I.exports=function(t){var d=new Float32Array(16);return d[0]=t[0],d[1]=t[1],d[2]=t[2],d[3]=t[3],d[4]=t[4],d[5]=t[5],d[6]=t[6],d[7]=t[7],d[8]=t[8],d[9]=t[9],d[10]=t[10],d[11]=t[11],d[12]=t[12],d[13]=t[13],d[14]=t[14],d[15]=t[15],d}},{}],279:[function(r,I,B){I.exports=function(t,d){return t[0]=d[0],t[1]=d[1],t[2]=d[2],t[3]=d[3],t[4]=d[4],t[5]=d[5],t[6]=d[6],t[7]=d[7],t[8]=d[8],t[9]=d[9],t[10]=d[10],t[11]=d[11],t[12]=d[12],t[13]=d[13],t[14]=d[14],t[15]=d[15],t}},{}],280:[function(r,I,B){I.exports=function(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],281:[function(r,I,B){I.exports=function(t){var d=t[0],m=t[1],h=t[2],e=t[3],f=t[4],l=t[5],o=t[6],u=t[7],s=t[8],i=t[9],c=t[10],n=t[11],a=t[12],g=t[13],p=t[14],y=t[15];return(d*l-m*f)*(c*y-n*p)-(d*o-h*f)*(i*y-n*g)+(d*u-e*f)*(i*p-c*g)+(m*o-h*l)*(s*y-n*a)-(m*u-e*l)*(s*p-c*a)+(h*u-e*o)*(s*g-i*a)}},{}],282:[function(r,I,B){I.exports=function(t,d){var m=d[0],h=d[1],e=d[2],f=d[3],l=m+m,o=h+h,u=e+e,s=m*l,i=h*l,c=h*o,n=e*l,a=e*o,g=e*u,p=f*l,y=f*o,v=f*u;return t[0]=1-c-g,t[1]=i+v,t[2]=n-y,t[3]=0,t[4]=i-v,t[5]=1-s-g,t[6]=a+p,t[7]=0,t[8]=n+y,t[9]=a-p,t[10]=1-s-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],283:[function(r,I,B){I.exports=function(t,d,m){var h,e,f,l=m[0],o=m[1],u=m[2],s=Math.sqrt(l*l+o*o+u*u);return Math.abs(s)<1e-6?null:(l*=s=1/s,o*=s,u*=s,h=Math.sin(d),e=Math.cos(d),f=1-e,t[0]=l*l*f+e,t[1]=o*l*f+u*h,t[2]=u*l*f-o*h,t[3]=0,t[4]=l*o*f-u*h,t[5]=o*o*f+e,t[6]=u*o*f+l*h,t[7]=0,t[8]=l*u*f+o*h,t[9]=o*u*f-l*h,t[10]=u*u*f+e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}},{}],284:[function(r,I,B){I.exports=function(t,d,m){var h=d[0],e=d[1],f=d[2],l=d[3],o=h+h,u=e+e,s=f+f,i=h*o,c=h*u,n=h*s,a=e*u,g=e*s,p=f*s,y=l*o,v=l*u,b=l*s;return t[0]=1-(a+p),t[1]=c+b,t[2]=n-v,t[3]=0,t[4]=c-b,t[5]=1-(i+p),t[6]=g+y,t[7]=0,t[8]=n+v,t[9]=g-y,t[10]=1-(i+a),t[11]=0,t[12]=m[0],t[13]=m[1],t[14]=m[2],t[15]=1,t}},{}],285:[function(r,I,B){I.exports=function(t,d){return t[0]=d[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=d[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=d[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],286:[function(r,I,B){I.exports=function(t,d){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=d[0],t[13]=d[1],t[14]=d[2],t[15]=1,t}},{}],287:[function(r,I,B){I.exports=function(t,d){var m=Math.sin(d),h=Math.cos(d);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=m,t[7]=0,t[8]=0,t[9]=-m,t[10]=h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],288:[function(r,I,B){I.exports=function(t,d){var m=Math.sin(d),h=Math.cos(d);return t[0]=h,t[1]=0,t[2]=-m,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=m,t[9]=0,t[10]=h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],289:[function(r,I,B){I.exports=function(t,d){var m=Math.sin(d),h=Math.cos(d);return t[0]=h,t[1]=m,t[2]=0,t[3]=0,t[4]=-m,t[5]=h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],290:[function(r,I,B){I.exports=function(t,d,m,h,e,f,l){var o=1/(m-d),u=1/(e-h),s=1/(f-l);return t[0]=2*f*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*f*u,t[6]=0,t[7]=0,t[8]=(m+d)*o,t[9]=(e+h)*u,t[10]=(l+f)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l*f*2*s,t[15]=0,t}},{}],291:[function(r,I,B){I.exports=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],292:[function(r,I,B){I.exports={create:r("./create"),clone:r("./clone"),copy:r("./copy"),identity:r("./identity"),transpose:r("./transpose"),invert:r("./invert"),adjoint:r("./adjoint"),determinant:r("./determinant"),multiply:r("./multiply"),translate:r("./translate"),scale:r("./scale"),rotate:r("./rotate"),rotateX:r("./rotateX"),rotateY:r("./rotateY"),rotateZ:r("./rotateZ"),fromRotation:r("./fromRotation"),fromRotationTranslation:r("./fromRotationTranslation"),fromScaling:r("./fromScaling"),fromTranslation:r("./fromTranslation"),fromXRotation:r("./fromXRotation"),fromYRotation:r("./fromYRotation"),fromZRotation:r("./fromZRotation"),fromQuat:r("./fromQuat"),frustum:r("./frustum"),perspective:r("./perspective"),perspectiveFromFieldOfView:r("./perspectiveFromFieldOfView"),ortho:r("./ortho"),lookAt:r("./lookAt"),str:r("./str")}},{"./adjoint":277,"./clone":278,"./copy":279,"./create":280,"./determinant":281,"./fromQuat":282,"./fromRotation":283,"./fromRotationTranslation":284,"./fromScaling":285,"./fromTranslation":286,"./fromXRotation":287,"./fromYRotation":288,"./fromZRotation":289,"./frustum":290,"./identity":291,"./invert":293,"./lookAt":294,"./multiply":295,"./ortho":296,"./perspective":297,"./perspectiveFromFieldOfView":298,"./rotate":299,"./rotateX":300,"./rotateY":301,"./rotateZ":302,"./scale":303,"./str":304,"./translate":305,"./transpose":306}],293:[function(r,I,B){I.exports=function(t,d){var m=d[0],h=d[1],e=d[2],f=d[3],l=d[4],o=d[5],u=d[6],s=d[7],i=d[8],c=d[9],n=d[10],a=d[11],g=d[12],p=d[13],y=d[14],v=d[15],b=m*o-h*l,x=m*u-e*l,T=m*s-f*l,A=h*u-e*o,S=h*s-f*o,w=e*s-f*u,E=i*p-c*g,k=i*y-n*g,L=i*v-a*g,M=c*y-n*p,P=c*v-a*p,D=n*v-a*y,N=b*D-x*P+T*M+A*L-S*k+w*E;return N?(N=1/N,t[0]=(o*D-u*P+s*M)*N,t[1]=(e*P-h*D-f*M)*N,t[2]=(p*w-y*S+v*A)*N,t[3]=(n*S-c*w-a*A)*N,t[4]=(u*L-l*D-s*k)*N,t[5]=(m*D-e*L+f*k)*N,t[6]=(y*T-g*w-v*x)*N,t[7]=(i*w-n*T+a*x)*N,t[8]=(l*P-o*L+s*E)*N,t[9]=(h*L-m*P-f*E)*N,t[10]=(g*S-p*T+v*b)*N,t[11]=(c*T-i*S-a*b)*N,t[12]=(o*k-l*M-u*E)*N,t[13]=(m*M-h*k+e*E)*N,t[14]=(p*x-g*A-y*b)*N,t[15]=(i*A-c*x+n*b)*N,t):null}},{}],294:[function(r,I,B){var t=r("./identity");I.exports=function(d,m,h,e){var f,l,o,u,s,i,c,n,a,g,p=m[0],y=m[1],v=m[2],b=e[0],x=e[1],T=e[2],A=h[0],S=h[1],w=h[2];return Math.abs(p-A)<1e-6&&Math.abs(y-S)<1e-6&&Math.abs(v-w)<1e-6?t(d):(c=p-A,n=y-S,a=v-w,g=1/Math.sqrt(c*c+n*n+a*a),f=x*(a*=g)-T*(n*=g),l=T*(c*=g)-b*a,o=b*n-x*c,(g=Math.sqrt(f*f+l*l+o*o))?(f*=g=1/g,l*=g,o*=g):(f=0,l=0,o=0),u=n*o-a*l,s=a*f-c*o,i=c*l-n*f,(g=Math.sqrt(u*u+s*s+i*i))?(u*=g=1/g,s*=g,i*=g):(u=0,s=0,i=0),d[0]=f,d[1]=u,d[2]=c,d[3]=0,d[4]=l,d[5]=s,d[6]=n,d[7]=0,d[8]=o,d[9]=i,d[10]=a,d[11]=0,d[12]=-(f*p+l*y+o*v),d[13]=-(u*p+s*y+i*v),d[14]=-(c*p+n*y+a*v),d[15]=1,d)}},{"./identity":291}],295:[function(r,I,B){I.exports=function(t,d,m){var h=d[0],e=d[1],f=d[2],l=d[3],o=d[4],u=d[5],s=d[6],i=d[7],c=d[8],n=d[9],a=d[10],g=d[11],p=d[12],y=d[13],v=d[14],b=d[15],x=m[0],T=m[1],A=m[2],S=m[3];return t[0]=x*h+T*o+A*c+S*p,t[1]=x*e+T*u+A*n+S*y,t[2]=x*f+T*s+A*a+S*v,t[3]=x*l+T*i+A*g+S*b,x=m[4],T=m[5],A=m[6],S=m[7],t[4]=x*h+T*o+A*c+S*p,t[5]=x*e+T*u+A*n+S*y,t[6]=x*f+T*s+A*a+S*v,t[7]=x*l+T*i+A*g+S*b,x=m[8],T=m[9],A=m[10],S=m[11],t[8]=x*h+T*o+A*c+S*p,t[9]=x*e+T*u+A*n+S*y,t[10]=x*f+T*s+A*a+S*v,t[11]=x*l+T*i+A*g+S*b,x=m[12],T=m[13],A=m[14],S=m[15],t[12]=x*h+T*o+A*c+S*p,t[13]=x*e+T*u+A*n+S*y,t[14]=x*f+T*s+A*a+S*v,t[15]=x*l+T*i+A*g+S*b,t}},{}],296:[function(r,I,B){I.exports=function(t,d,m,h,e,f,l){var o=1/(d-m),u=1/(h-e),s=1/(f-l);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*s,t[11]=0,t[12]=(d+m)*o,t[13]=(e+h)*u,t[14]=(l+f)*s,t[15]=1,t}},{}],297:[function(r,I,B){I.exports=function(t,d,m,h,e){var f=1/Math.tan(d/2),l=1/(h-e);return t[0]=f/m,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(e+h)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*e*h*l,t[15]=0,t}},{}],298:[function(r,I,B){I.exports=function(t,d,m,h){var e=Math.tan(d.upDegrees*Math.PI/180),f=Math.tan(d.downDegrees*Math.PI/180),l=Math.tan(d.leftDegrees*Math.PI/180),o=Math.tan(d.rightDegrees*Math.PI/180),u=2/(l+o),s=2/(e+f);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=-(l-o)*u*.5,t[9]=(e-f)*s*.5,t[10]=h/(m-h),t[11]=-1,t[12]=0,t[13]=0,t[14]=h*m/(m-h),t[15]=0,t}},{}],299:[function(r,I,B){I.exports=function(t,d,m,h){var e,f,l,o,u,s,i,c,n,a,g,p,y,v,b,x,T,A,S,w,E,k,L,M,P=h[0],D=h[1],N=h[2],U=Math.sqrt(P*P+D*D+N*N);return Math.abs(U)<1e-6?null:(P*=U=1/U,D*=U,N*=U,e=Math.sin(m),f=Math.cos(m),l=1-f,o=d[0],u=d[1],s=d[2],i=d[3],c=d[4],n=d[5],a=d[6],g=d[7],p=d[8],y=d[9],v=d[10],b=d[11],x=P*P*l+f,T=D*P*l+N*e,A=N*P*l-D*e,S=P*D*l-N*e,w=D*D*l+f,E=N*D*l+P*e,k=P*N*l+D*e,L=D*N*l-P*e,M=N*N*l+f,t[0]=o*x+c*T+p*A,t[1]=u*x+n*T+y*A,t[2]=s*x+a*T+v*A,t[3]=i*x+g*T+b*A,t[4]=o*S+c*w+p*E,t[5]=u*S+n*w+y*E,t[6]=s*S+a*w+v*E,t[7]=i*S+g*w+b*E,t[8]=o*k+c*L+p*M,t[9]=u*k+n*L+y*M,t[10]=s*k+a*L+v*M,t[11]=i*k+g*L+b*M,d!==t&&(t[12]=d[12],t[13]=d[13],t[14]=d[14],t[15]=d[15]),t)}},{}],300:[function(r,I,B){I.exports=function(t,d,m){var h=Math.sin(m),e=Math.cos(m),f=d[4],l=d[5],o=d[6],u=d[7],s=d[8],i=d[9],c=d[10],n=d[11];return d!==t&&(t[0]=d[0],t[1]=d[1],t[2]=d[2],t[3]=d[3],t[12]=d[12],t[13]=d[13],t[14]=d[14],t[15]=d[15]),t[4]=f*e+s*h,t[5]=l*e+i*h,t[6]=o*e+c*h,t[7]=u*e+n*h,t[8]=s*e-f*h,t[9]=i*e-l*h,t[10]=c*e-o*h,t[11]=n*e-u*h,t}},{}],301:[function(r,I,B){I.exports=function(t,d,m){var h=Math.sin(m),e=Math.cos(m),f=d[0],l=d[1],o=d[2],u=d[3],s=d[8],i=d[9],c=d[10],n=d[11];return d!==t&&(t[4]=d[4],t[5]=d[5],t[6]=d[6],t[7]=d[7],t[12]=d[12],t[13]=d[13],t[14]=d[14],t[15]=d[15]),t[0]=f*e-s*h,t[1]=l*e-i*h,t[2]=o*e-c*h,t[3]=u*e-n*h,t[8]=f*h+s*e,t[9]=l*h+i*e,t[10]=o*h+c*e,t[11]=u*h+n*e,t}},{}],302:[function(r,I,B){I.exports=function(t,d,m){var h=Math.sin(m),e=Math.cos(m),f=d[0],l=d[1],o=d[2],u=d[3],s=d[4],i=d[5],c=d[6],n=d[7];return d!==t&&(t[8]=d[8],t[9]=d[9],t[10]=d[10],t[11]=d[11],t[12]=d[12],t[13]=d[13],t[14]=d[14],t[15]=d[15]),t[0]=f*e+s*h,t[1]=l*e+i*h,t[2]=o*e+c*h,t[3]=u*e+n*h,t[4]=s*e-f*h,t[5]=i*e-l*h,t[6]=c*e-o*h,t[7]=n*e-u*h,t}},{}],303:[function(r,I,B){I.exports=function(t,d,m){var h=m[0],e=m[1],f=m[2];return t[0]=d[0]*h,t[1]=d[1]*h,t[2]=d[2]*h,t[3]=d[3]*h,t[4]=d[4]*e,t[5]=d[5]*e,t[6]=d[6]*e,t[7]=d[7]*e,t[8]=d[8]*f,t[9]=d[9]*f,t[10]=d[10]*f,t[11]=d[11]*f,t[12]=d[12],t[13]=d[13],t[14]=d[14],t[15]=d[15],t}},{}],304:[function(r,I,B){I.exports=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}},{}],305:[function(r,I,B){I.exports=function(t,d,m){var h,e,f,l,o,u,s,i,c,n,a,g,p=m[0],y=m[1],v=m[2];return d===t?(t[12]=d[0]*p+d[4]*y+d[8]*v+d[12],t[13]=d[1]*p+d[5]*y+d[9]*v+d[13],t[14]=d[2]*p+d[6]*y+d[10]*v+d[14],t[15]=d[3]*p+d[7]*y+d[11]*v+d[15]):(h=d[0],e=d[1],f=d[2],l=d[3],o=d[4],u=d[5],s=d[6],i=d[7],c=d[8],n=d[9],a=d[10],g=d[11],t[0]=h,t[1]=e,t[2]=f,t[3]=l,t[4]=o,t[5]=u,t[6]=s,t[7]=i,t[8]=c,t[9]=n,t[10]=a,t[11]=g,t[12]=h*p+o*y+c*v+d[12],t[13]=e*p+u*y+n*v+d[13],t[14]=f*p+s*y+a*v+d[14],t[15]=l*p+i*y+g*v+d[15]),t}},{}],306:[function(r,I,B){I.exports=function(t,d){if(t===d){var m=d[1],h=d[2],e=d[3],f=d[6],l=d[7],o=d[11];t[1]=d[4],t[2]=d[8],t[3]=d[12],t[4]=m,t[6]=d[9],t[7]=d[13],t[8]=h,t[9]=f,t[11]=d[14],t[12]=e,t[13]=l,t[14]=o}else t[0]=d[0],t[1]=d[4],t[2]=d[8],t[3]=d[12],t[4]=d[1],t[5]=d[5],t[6]=d[9],t[7]=d[13],t[8]=d[2],t[9]=d[6],t[10]=d[10],t[11]=d[14],t[12]=d[3],t[13]=d[7],t[14]=d[11],t[15]=d[15];return t}},{}],307:[function(r,I,B){var t=r("barycentric"),d=r("polytope-closest-point/lib/closest_point_2d.js");function m(f,l){for(var o=[0,0,0,0],u=0;u<4;++u)for(var s=0;s<4;++s)o[s]+=f[4*u+s]*l[u];return o}function h(f,l,o,u,s){for(var i=m(u,m(o,m(l,[f[0],f[1],f[2],1]))),c=0;c<3;++c)i[c]/=i[3];return[.5*s[0]*(1+i[0]),.5*s[1]*(1-i[1])]}function e(f,l){for(var o=[0,0,0],u=0;u<f.length;++u)for(var s=f[u],i=l[u],c=0;c<3;++c)o[c]+=i*s[c];return o}I.exports=function(f,l,o,u,s,i){if(f.length===1)return[0,f[0].slice()];for(var c=new Array(f.length),n=0;n<f.length;++n)c[n]=h(f[n],o,u,s,i);var a=0,g=1/0;for(n=0;n<c.length;++n){for(var p=0,y=0;y<2;++y)p+=Math.pow(c[n][y]-l[y],2);p<g&&(g=p,a=n)}var v=function(x,T){if(x.length===2){for(var A=0,S=0,w=0;w<2;++w)A+=Math.pow(T[w]-x[0][w],2),S+=Math.pow(T[w]-x[1][w],2);return A=Math.sqrt(A),S=Math.sqrt(S),A+S<1e-6?[1,0]:[S/(A+S),A/(S+A)]}if(x.length===3){var E=[0,0];return d(x[0],x[1],x[2],T,E),t(x,E)}return[]}(c,l),b=0;for(n=0;n<3;++n){if(v[n]<-.001||v[n]>1.0001)return null;b+=v[n]}return Math.abs(b-1)>.001?null:[a,e(f,v),v]}},{barycentric:85,"polytope-closest-point/lib/closest_point_2d.js":498}],308:[function(r,I,B){var t=r("glslify"),d=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, normal;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model
           , view
           , projection
           , inverseModel;
uniform vec3 eyePosition
           , lightPosition;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  gl_Position      = project(position);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * vec4(position , 1.0);
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  f_color          = color;
  f_data           = position;
  f_uv             = uv;
}
`]),m=t([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness
            , fresnel
            , kambient
            , kdiffuse
            , kspecular;
uniform sampler2D texture;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (f_color.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], f_data)
  ) discard;

  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d

  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * f_color.a;
}
`]),h=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model, view, projection;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_color = color;
  f_data  = position;
  f_uv    = uv;
}`]),e=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;

  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),f=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;
attribute float pointSize;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);
  } else {
    gl_Position = projection * view * model * vec4(position, 1.0);
  }
  gl_PointSize = pointSize;
  f_color = color;
  f_uv = uv;
}`]),l=t([`precision highp float;
#define GLSLIFY 1

uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);
  if(dot(pointR, pointR) > 0.25) {
    discard;
  }
  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),o=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 id;

uniform mat4 model, view, projection;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_id        = id;
  f_position  = position;
}`]),u=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]),s=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3  position;
attribute float pointSize;
attribute vec4  id;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);
  } else {
    gl_Position  = projection * view * model * vec4(position, 1.0);
    gl_PointSize = pointSize;
  }
  f_id         = id;
  f_position   = position;
}`]),i=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
}`]),c=t([`precision highp float;
#define GLSLIFY 1

uniform vec3 contourColor;

void main() {
  gl_FragColor = vec4(contourColor, 1.0);
}
`]);B.meshShader={vertex:d,fragment:m,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},B.wireShader={vertex:h,fragment:e,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},B.pointShader={vertex:f,fragment:l,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},B.pickShader={vertex:o,fragment:u,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},B.pointPickShader={vertex:s,fragment:u,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},B.contourShader={vertex:i,fragment:c,attributes:[{name:"position",type:"vec3"}]}},{glslify:434}],309:[function(r,I,B){var t=r("gl-shader"),d=r("gl-buffer"),m=r("gl-vao"),h=r("gl-texture2d"),e=r("normals"),f=r("gl-mat4/multiply"),l=r("gl-mat4/invert"),o=r("ndarray"),u=r("colormap"),s=r("simplicial-complex-contour"),i=r("typedarray-pool"),c=r("./lib/shaders"),n=r("./lib/closest-point"),a=c.meshShader,g=c.wireShader,p=c.pointShader,y=c.pickShader,v=c.pointPickShader,b=c.contourShader,x=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function T(D,N,U,G,X,K,Z,H,Y,$,z,j,W,ee,J,Q,te,ie,ae,he,se,de,ue,ve,ke,Ee,be){this.gl=D,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=N,this.dirty=!0,this.triShader=U,this.lineShader=G,this.pointShader=X,this.pickShader=K,this.pointPickShader=Z,this.contourShader=H,this.trianglePositions=Y,this.triangleColors=z,this.triangleNormals=W,this.triangleUVs=j,this.triangleIds=$,this.triangleVAO=ee,this.triangleCount=0,this.lineWidth=1,this.edgePositions=J,this.edgeColors=te,this.edgeUVs=ie,this.edgeIds=Q,this.edgeVAO=ae,this.edgeCount=0,this.pointPositions=he,this.pointColors=de,this.pointUVs=ue,this.pointSizes=ve,this.pointIds=se,this.pointVAO=ke,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=Ee,this.contourVAO=be,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=x,this._view=x,this._projection=x,this._resolution=[1,1]}var A=T.prototype;function S(D,N){if(!N||!N.length)return 1;for(var U=0;U<N.length;++U){if(N.length<2)return 1;if(N[U][0]===D)return N[U][1];if(N[U][0]>D&&U>0){var G=(N[U][0]-D)/(N[U][0]-N[U-1][0]);return N[U][1]*(1-G)+G*N[U-1][1]}}return 1}function w(D){var N=t(D,a.vertex,a.fragment);return N.attributes.position.location=0,N.attributes.color.location=2,N.attributes.uv.location=3,N.attributes.normal.location=4,N}function E(D){var N=t(D,g.vertex,g.fragment);return N.attributes.position.location=0,N.attributes.color.location=2,N.attributes.uv.location=3,N}function k(D){var N=t(D,p.vertex,p.fragment);return N.attributes.position.location=0,N.attributes.color.location=2,N.attributes.uv.location=3,N.attributes.pointSize.location=4,N}function L(D){var N=t(D,y.vertex,y.fragment);return N.attributes.position.location=0,N.attributes.id.location=1,N}function M(D){var N=t(D,v.vertex,v.fragment);return N.attributes.position.location=0,N.attributes.id.location=1,N.attributes.pointSize.location=4,N}function P(D){var N=t(D,b.vertex,b.fragment);return N.attributes.position.location=0,N}A.isOpaque=function(){return!this.hasAlpha},A.isTransparent=function(){return this.hasAlpha},A.pickSlots=1,A.setPickBase=function(D){this.pickId=D},A.highlight=function(D){if(D&&this.contourEnable){for(var N=s(this.cells,this.intensity,D.intensity),U=N.cells,G=N.vertexIds,X=N.vertexWeights,K=U.length,Z=i.mallocFloat32(6*K),H=0,Y=0;Y<K;++Y)for(var $=U[Y],z=0;z<2;++z){var j=$[0];$.length===2&&(j=$[z]);for(var W=G[j][0],ee=G[j][1],J=X[j],Q=1-J,te=this.positions[W],ie=this.positions[ee],ae=0;ae<3;++ae)Z[H++]=J*te[ae]+Q*ie[ae]}this.contourCount=H/3|0,this.contourPositions.update(Z.subarray(0,H)),i.free(Z)}else this.contourCount=0},A.update=function(D){D=D||{};var N=this.gl;this.dirty=!0,"contourEnable"in D&&(this.contourEnable=D.contourEnable),"contourColor"in D&&(this.contourColor=D.contourColor),"lineWidth"in D&&(this.lineWidth=D.lineWidth),"lightPosition"in D&&(this.lightPosition=D.lightPosition),this.hasAlpha=!1,"opacity"in D&&(this.opacity=D.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in D&&(this.opacityscale=D.opacityscale,this.hasAlpha=!0),"ambient"in D&&(this.ambientLight=D.ambient),"diffuse"in D&&(this.diffuseLight=D.diffuse),"specular"in D&&(this.specularLight=D.specular),"roughness"in D&&(this.roughness=D.roughness),"fresnel"in D&&(this.fresnel=D.fresnel),D.texture?(this.texture.dispose(),this.texture=h(N,D.texture)):D.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=N.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=N.LINEAR,this.texture.setPixels(function(at,tt){for(var _t=u({colormap:at,nshades:256,format:"rgba"}),er=new Uint8Array(1024),tr=0;tr<256;++tr){for(var Ue=_t[tr],He=0;He<3;++He)er[4*tr+He]=Ue[He];er[4*tr+3]=tt?255*S(tr/255,tt):255*Ue[3]}return o(er,[256,256,4],[4,0,1])}(D.colormap,this.opacityscale)),this.texture.generateMipmap());var U=D.cells,G=D.positions;if(G&&U){var X=[],K=[],Z=[],H=[],Y=[],$=[],z=[],j=[],W=[],ee=[],J=[],Q=[],te=[],ie=[];this.cells=U,this.positions=G;var ae=D.vertexNormals,he=D.cellNormals,se=D.vertexNormalsEpsilon===void 0?1e-6:D.vertexNormalsEpsilon,de=D.faceNormalsEpsilon===void 0?1e-6:D.faceNormalsEpsilon;D.useFacetNormals&&!he&&(he=e.faceNormals(U,G,de)),he||ae||(ae=e.vertexNormals(U,G,se));var ue=D.vertexColors,ve=D.cellColors,ke=D.meshColor||[1,1,1,1],Ee=D.vertexUVs,be=D.vertexIntensity,xe=D.cellUVs,ce=D.cellIntensity,ge=1/0,we=-1/0;if(!Ee&&!xe)if(be)if(D.vertexIntensityBounds)ge=+D.vertexIntensityBounds[0],we=+D.vertexIntensityBounds[1];else for(var Me=0;Me<be.length;++Me){var Se=be[Me];ge=Math.min(ge,Se),we=Math.max(we,Se)}else if(ce)if(D.cellIntensityBounds)ge=+D.cellIntensityBounds[0],we=+D.cellIntensityBounds[1];else for(Me=0;Me<ce.length;++Me)Se=ce[Me],ge=Math.min(ge,Se),we=Math.max(we,Se);else for(Me=0;Me<G.length;++Me)Se=G[Me][2],ge=Math.min(ge,Se),we=Math.max(we,Se);this.intensity=be||ce||function(at){for(var tt=at.length,_t=new Array(tt),er=0;er<tt;++er)_t[er]=at[er][2];return _t}(G),this.pickVertex=!(ce||ve);var ze=D.pointSizes,Fe=D.pointSize||1;for(this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],Me=0;Me<G.length;++Me)for(var Ye=G[Me],rt=0;rt<3;++rt)!isNaN(Ye[rt])&&isFinite(Ye[rt])&&(this.bounds[0][rt]=Math.min(this.bounds[0][rt],Ye[rt]),this.bounds[1][rt]=Math.max(this.bounds[1][rt],Ye[rt]));var Oe=0,je=0,We=0;e:for(Me=0;Me<U.length;++Me){var qe=U[Me];switch(qe.length){case 1:for(Ye=G[st=qe[0]],rt=0;rt<3;++rt)if(isNaN(Ye[rt])||!isFinite(Ye[rt]))continue e;ee.push(Ye[0],Ye[1],Ye[2]),ct=ue?ue[st]:ve?ve[Me]:ke,this.opacityscale&&be?K.push(ct[0],ct[1],ct[2],this.opacity*S((be[st]-ge)/(we-ge),this.opacityscale)):ct.length===3?J.push(ct[0],ct[1],ct[2],this.opacity):(J.push(ct[0],ct[1],ct[2],ct[3]*this.opacity),ct[3]<1&&(this.hasAlpha=!0)),Pt=Ee?Ee[st]:be?[(be[st]-ge)/(we-ge),0]:xe?xe[Me]:ce?[(ce[Me]-ge)/(we-ge),0]:[(Ye[2]-ge)/(we-ge),0],Q.push(Pt[0],Pt[1]),ze?te.push(ze[st]):te.push(Fe),ie.push(Me),We+=1;break;case 2:for(rt=0;rt<2;++rt){Ye=G[st=qe[rt]];for(var et=0;et<3;++et)if(isNaN(Ye[et])||!isFinite(Ye[et]))continue e}for(rt=0;rt<2;++rt)Ye=G[st=qe[rt]],$.push(Ye[0],Ye[1],Ye[2]),ct=ue?ue[st]:ve?ve[Me]:ke,this.opacityscale&&be?K.push(ct[0],ct[1],ct[2],this.opacity*S((be[st]-ge)/(we-ge),this.opacityscale)):ct.length===3?z.push(ct[0],ct[1],ct[2],this.opacity):(z.push(ct[0],ct[1],ct[2],ct[3]*this.opacity),ct[3]<1&&(this.hasAlpha=!0)),Pt=Ee?Ee[st]:be?[(be[st]-ge)/(we-ge),0]:xe?xe[Me]:ce?[(ce[Me]-ge)/(we-ge),0]:[(Ye[2]-ge)/(we-ge),0],j.push(Pt[0],Pt[1]),W.push(Me);je+=1;break;case 3:for(rt=0;rt<3;++rt)for(Ye=G[st=qe[rt]],et=0;et<3;++et)if(isNaN(Ye[et])||!isFinite(Ye[et]))continue e;for(rt=0;rt<3;++rt){var st,ct,Pt,kt;Ye=G[st=qe[2-rt]],X.push(Ye[0],Ye[1],Ye[2]),(ct=ue?ue[st]:ve?ve[Me]:ke)?this.opacityscale&&be?K.push(ct[0],ct[1],ct[2],this.opacity*S((be[st]-ge)/(we-ge),this.opacityscale)):ct.length===3?K.push(ct[0],ct[1],ct[2],this.opacity):(K.push(ct[0],ct[1],ct[2],ct[3]*this.opacity),ct[3]<1&&(this.hasAlpha=!0)):K.push(.5,.5,.5,1),Pt=Ee?Ee[st]:be?[(be[st]-ge)/(we-ge),0]:xe?xe[Me]:ce?[(ce[Me]-ge)/(we-ge),0]:[(Ye[2]-ge)/(we-ge),0],H.push(Pt[0],Pt[1]),kt=ae?ae[st]:he[Me],Z.push(kt[0],kt[1],kt[2]),Y.push(Me)}Oe+=1}}this.pointCount=We,this.edgeCount=je,this.triangleCount=Oe,this.pointPositions.update(ee),this.pointColors.update(J),this.pointUVs.update(Q),this.pointSizes.update(te),this.pointIds.update(new Uint32Array(ie)),this.edgePositions.update($),this.edgeColors.update(z),this.edgeUVs.update(j),this.edgeIds.update(new Uint32Array(W)),this.trianglePositions.update(X),this.triangleColors.update(K),this.triangleUVs.update(H),this.triangleNormals.update(Z),this.triangleIds.update(new Uint32Array(Y))}},A.drawTransparent=A.draw=function(D){D=D||{};for(var N=this.gl,U=D.model||x,G=D.view||x,X=D.projection||x,K=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],Z=0;Z<3;++Z)K[0][Z]=Math.max(K[0][Z],this.clipBounds[0][Z]),K[1][Z]=Math.min(K[1][Z],this.clipBounds[1][Z]);var H={model:U,view:G,projection:X,inverseModel:x.slice(),clipBounds:K,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};H.inverseModel=l(H.inverseModel,H.model),N.disable(N.CULL_FACE),this.texture.bind(0);var Y=new Array(16);for(f(Y,H.view,H.model),f(Y,H.projection,Y),l(Y,Y),Z=0;Z<3;++Z)H.eyePosition[Z]=Y[12+Z]/Y[15];var $,z=Y[15];for(Z=0;Z<3;++Z)z+=this.lightPosition[Z]*Y[4*Z+3];for(Z=0;Z<3;++Z){for(var j=Y[12+Z],W=0;W<3;++W)j+=Y[4*W+Z]*this.lightPosition[W];H.lightPosition[Z]=j/z}this.triangleCount>0&&(($=this.triShader).bind(),$.uniforms=H,this.triangleVAO.bind(),N.drawArrays(N.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&this.lineWidth>0&&(($=this.lineShader).bind(),$.uniforms=H,this.edgeVAO.bind(),N.lineWidth(this.lineWidth*this.pixelRatio),N.drawArrays(N.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&(($=this.pointShader).bind(),$.uniforms=H,this.pointVAO.bind(),N.drawArrays(N.POINTS,0,this.pointCount),this.pointVAO.unbind()),this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&(($=this.contourShader).bind(),$.uniforms=H,this.contourVAO.bind(),N.drawArrays(N.LINES,0,this.contourCount),this.contourVAO.unbind())},A.drawPick=function(D){D=D||{};for(var N=this.gl,U=D.model||x,G=D.view||x,X=D.projection||x,K=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],Z=0;Z<3;++Z)K[0][Z]=Math.max(K[0][Z],this.clipBounds[0][Z]),K[1][Z]=Math.min(K[1][Z],this.clipBounds[1][Z]);this._model=[].slice.call(U),this._view=[].slice.call(G),this._projection=[].slice.call(X),this._resolution=[N.drawingBufferWidth,N.drawingBufferHeight];var H,Y={model:U,view:G,projection:X,clipBounds:K,pickId:this.pickId/255};(H=this.pickShader).bind(),H.uniforms=Y,this.triangleCount>0&&(this.triangleVAO.bind(),N.drawArrays(N.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),N.lineWidth(this.lineWidth*this.pixelRatio),N.drawArrays(N.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((H=this.pointPickShader).bind(),H.uniforms=Y,this.pointVAO.bind(),N.drawArrays(N.POINTS,0,this.pointCount),this.pointVAO.unbind())},A.pick=function(D){if(!D||D.id!==this.pickId)return null;for(var N=D.value[0]+256*D.value[1]+65536*D.value[2],U=this.cells[N],G=this.positions,X=new Array(U.length),K=0;K<U.length;++K)X[K]=G[U[K]];var Z=D.coord[0],H=D.coord[1];if(!this.pickVertex){var Y=this.positions[U[0]],$=this.positions[U[1]],z=this.positions[U[2]],j=[(Y[0]+$[0]+z[0])/3,(Y[1]+$[1]+z[1])/3,(Y[2]+$[2]+z[2])/3];return{_cellCenter:!0,position:[Z,H],index:N,cell:U,cellId:N,intensity:this.intensity[N],dataCoordinate:j}}var W=n(X,[Z*this.pixelRatio,this._resolution[1]-H*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!W)return null;var ee=W[2],J=0;for(K=0;K<U.length;++K)J+=ee[K]*this.intensity[U[K]];return{position:W[1],index:U[W[0]],cell:U,cellId:N,intensity:J,dataCoordinate:this.positions[U[W[0]]]}},A.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},I.exports=function(D,N){arguments.length===1&&(D=(N=D).gl);var U=D.getExtension("OES_standard_derivatives")||D.getExtension("MOZ_OES_standard_derivatives")||D.getExtension("WEBKIT_OES_standard_derivatives");if(!U)throw new Error("derivatives not supported");var G=w(D),X=E(D),K=k(D),Z=L(D),H=M(D),Y=P(D),$=h(D,o(new Uint8Array([255,255,255,255]),[1,1,4]));$.generateMipmap(),$.minFilter=D.LINEAR_MIPMAP_LINEAR,$.magFilter=D.LINEAR;var z=d(D),j=d(D),W=d(D),ee=d(D),J=d(D),Q=m(D,[{buffer:z,type:D.FLOAT,size:3},{buffer:J,type:D.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:j,type:D.FLOAT,size:4},{buffer:W,type:D.FLOAT,size:2},{buffer:ee,type:D.FLOAT,size:3}]),te=d(D),ie=d(D),ae=d(D),he=d(D),se=m(D,[{buffer:te,type:D.FLOAT,size:3},{buffer:he,type:D.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ie,type:D.FLOAT,size:4},{buffer:ae,type:D.FLOAT,size:2}]),de=d(D),ue=d(D),ve=d(D),ke=d(D),Ee=d(D),be=m(D,[{buffer:de,type:D.FLOAT,size:3},{buffer:Ee,type:D.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ue,type:D.FLOAT,size:4},{buffer:ve,type:D.FLOAT,size:2},{buffer:ke,type:D.FLOAT,size:1}]),xe=d(D),ce=m(D,[{buffer:xe,type:D.FLOAT,size:3}]),ge=new T(D,$,G,X,K,Z,H,Y,z,J,j,W,ee,Q,te,he,ie,ae,se,de,Ee,ue,ve,ke,be,xe,ce);return ge.update(N),ge}},{"./lib/closest-point":307,"./lib/shaders":308,colormap:137,"gl-buffer":261,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-shader":332,"gl-texture2d":348,"gl-vao":353,ndarray:472,normals:475,"simplicial-complex-contour":543,"typedarray-pool":601}],310:[function(r,I,B){I.exports=function(o){var u=o.gl,s=t(u,[0,0,0,1,1,0,1,1]),i=d(u,m.boxVert,m.lineFrag);return new h(o,s,i)};var t=r("gl-buffer"),d=r("gl-shader"),m=r("./shaders");function h(o,u,s){this.plot=o,this.vbo=u,this.shader=s}var e,f,l=h.prototype;l.bind=function(){var o=this.shader;this.vbo.bind(),this.shader.bind(),o.attributes.coord.pointer(),o.uniforms.screenBox=this.plot.screenBox},l.drawBox=(e=[0,0],f=[0,0],function(o,u,s,i,c){var n=this.plot,a=this.shader,g=n.gl;e[0]=o,e[1]=u,f[0]=s,f[1]=i,a.uniforms.lo=e,a.uniforms.hi=f,a.uniforms.color=c,g.drawArrays(g.TRIANGLE_STRIP,0,4)}),l.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":313,"gl-buffer":261,"gl-shader":332}],311:[function(r,I,B){I.exports=function(n){var a=n.gl,g=t(a),p=d(a,h.gridVert,h.gridFrag),y=d(a,h.tickVert,h.gridFrag);return new e(n,g,p,y)};var t=r("gl-buffer"),d=r("gl-shader"),m=r("binary-search-bounds"),h=r("./shaders");function e(n,a,g,p){this.plot=n,this.vbo=a,this.shader=g,this.tickShader=p,this.ticks=[[],[]]}function f(n,a){return n-a}var l,o,u,s,i,c=e.prototype;c.draw=(l=[0,0],o=[0,0],u=[0,0],function(){for(var n=this.plot,a=this.vbo,g=this.shader,p=this.ticks,y=n.gl,v=n._tickBounds,b=n.dataBox,x=n.viewBox,T=n.gridLineWidth,A=n.gridLineColor,S=n.gridLineEnable,w=n.pixelRatio,E=0;E<2;++E){var k=v[E],L=v[E+2]-k,M=.5*(b[E+2]+b[E]),P=b[E+2]-b[E];o[E]=2*L/P,l[E]=2*(k-M)/P}g.bind(),a.bind(),g.attributes.dataCoord.pointer(),g.uniforms.dataShift=l,g.uniforms.dataScale=o;var D=0;for(E=0;E<2;++E){u[0]=u[1]=0,u[E]=1,g.uniforms.dataAxis=u,g.uniforms.lineWidth=T[E]/(x[E+2]-x[E])*w,g.uniforms.color=A[E];var N=6*p[E].length;S[E]&&N&&y.drawArrays(y.TRIANGLES,D,N),D+=N}}),c.drawTickMarks=function(){var n=[0,0],a=[0,0],g=[1,0],p=[0,1],y=[0,0],v=[0,0];return function(){for(var b=this.plot,x=this.vbo,T=this.tickShader,A=this.ticks,S=b.gl,w=b._tickBounds,E=b.dataBox,k=b.viewBox,L=b.pixelRatio,M=b.screenBox,P=M[2]-M[0],D=M[3]-M[1],N=k[2]-k[0],U=k[3]-k[1],G=0;G<2;++G){var X=w[G],K=w[G+2]-X,Z=.5*(E[G+2]+E[G]),H=E[G+2]-E[G];a[G]=2*K/H,n[G]=2*(X-Z)/H}a[0]*=N/P,n[0]*=N/P,a[1]*=U/D,n[1]*=U/D,T.bind(),x.bind(),T.attributes.dataCoord.pointer();var Y=T.uniforms;Y.dataShift=n,Y.dataScale=a;var $=b.tickMarkLength,z=b.tickMarkWidth,j=b.tickMarkColor,W=6*A[0].length,ee=Math.min(m.ge(A[0],(E[0]-w[0])/(w[2]-w[0]),f),A[0].length),J=Math.min(m.gt(A[0],(E[2]-w[0])/(w[2]-w[0]),f),A[0].length),Q=0+6*ee,te=6*Math.max(0,J-ee),ie=Math.min(m.ge(A[1],(E[1]-w[1])/(w[3]-w[1]),f),A[1].length),ae=Math.min(m.gt(A[1],(E[3]-w[1])/(w[3]-w[1]),f),A[1].length),he=W+6*ie,se=6*Math.max(0,ae-ie);y[0]=2*(k[0]-$[1])/P-1,y[1]=(k[3]+k[1])/D-1,v[0]=$[1]*L/P,v[1]=z[1]*L/D,se&&(Y.color=j[1],Y.tickScale=v,Y.dataAxis=p,Y.screenOffset=y,S.drawArrays(S.TRIANGLES,he,se)),y[0]=(k[2]+k[0])/P-1,y[1]=2*(k[1]-$[0])/D-1,v[0]=z[0]*L/P,v[1]=$[0]*L/D,te&&(Y.color=j[0],Y.tickScale=v,Y.dataAxis=g,Y.screenOffset=y,S.drawArrays(S.TRIANGLES,Q,te)),y[0]=2*(k[2]+$[3])/P-1,y[1]=(k[3]+k[1])/D-1,v[0]=$[3]*L/P,v[1]=z[3]*L/D,se&&(Y.color=j[3],Y.tickScale=v,Y.dataAxis=p,Y.screenOffset=y,S.drawArrays(S.TRIANGLES,he,se)),y[0]=(k[2]+k[0])/P-1,y[1]=2*(k[3]+$[2])/D-1,v[0]=z[2]*L/P,v[1]=$[2]*L/D,te&&(Y.color=j[2],Y.tickScale=v,Y.dataAxis=g,Y.screenOffset=y,S.drawArrays(S.TRIANGLES,Q,te))}}(),c.update=(s=[1,1,-1,-1,1,-1],i=[1,-1,1,1,-1,-1],function(n){for(var a=n.ticks,g=n.bounds,p=new Float32Array(18*(a[0].length+a[1].length)),y=(this.plot.zeroLineEnable,0),v=[[],[]],b=0;b<2;++b)for(var x=v[b],T=a[b],A=g[b],S=g[b+2],w=0;w<T.length;++w){var E=(T[w].x-A)/(S-A);x.push(E);for(var k=0;k<6;++k)p[y++]=E,p[y++]=s[k],p[y++]=i[k]}this.ticks=v,this.vbo.update(p)}),c.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":313,"binary-search-bounds":103,"gl-buffer":261,"gl-shader":332}],312:[function(r,I,B){I.exports=function(o){var u=o.gl,s=t(u,[-1,-1,-1,1,1,-1,1,1]),i=d(u,m.lineVert,m.lineFrag);return new h(o,s,i)};var t=r("gl-buffer"),d=r("gl-shader"),m=r("./shaders");function h(o,u,s){this.plot=o,this.vbo=u,this.shader=s}var e,f,l=h.prototype;l.bind=function(){var o=this.shader;this.vbo.bind(),this.shader.bind(),o.attributes.coord.pointer(),o.uniforms.screenBox=this.plot.screenBox},l.drawLine=(e=[0,0],f=[0,0],function(o,u,s,i,c,n){var a=this.plot,g=this.shader,p=a.gl;e[0]=o,e[1]=u,f[0]=s,f[1]=i,g.uniforms.start=e,g.uniforms.end=f,g.uniforms.width=c*a.pixelRatio,g.uniforms.color=n,p.drawArrays(p.TRIANGLE_STRIP,0,4)}),l.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":313,"gl-buffer":261,"gl-shader":332}],313:[function(r,I,B){var t=r("glslify"),d=t([`precision lowp float;
#define GLSLIFY 1
uniform vec4 color;
void main() {
  gl_FragColor = vec4(color.xyz * color.w, color.w);
}
`]);I.exports={lineVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 start, end;
uniform float width;

vec2 perp(vec2 v) {
  return vec2(v.y, -v.x);
}

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  vec2 delta = normalize(perp(start - end));
  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));
  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);
}
`]),lineFrag:d,textVert:t([`#define GLSLIFY 1
attribute vec3 textCoordinate;

uniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;
uniform float angle;

void main() {
  float dataOffset  = textCoordinate.z;
  vec2 glyphOffset  = textCoordinate.xy;
  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +
    glyphMatrix * glyphOffset * textScale + screenOffset;
  gl_Position = vec4(screenCoordinate, 0, 1);
}
`]),textFrag:d,gridVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale;
uniform float lineWidth;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;
  gl_Position = vec4(pos, 0, 1);
}
`]),gridFrag:d,boxVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 lo, hi;

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);
}
`]),tickVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);
}
`])}},{glslify:315}],314:[function(r,I,B){I.exports=function(a){var g=a.gl,p=t(g),y=d(g,e.textVert,e.textFrag);return new f(a,p,y)};var t=r("gl-buffer"),d=r("gl-shader"),m=r("text-cache"),h=r("binary-search-bounds"),e=r("./shaders");function f(a,g,p){this.plot=a,this.vbo=g,this.shader=p,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var l,o,u,s,i,c,n=f.prototype;n.drawTicks=(l=[0,0],o=[0,0],u=[0,0],function(a){var g=this.plot,p=this.shader,y=this.tickX[a],v=this.tickOffset[a],b=g.gl,x=g.viewBox,T=g.dataBox,A=g.screenBox,S=g.pixelRatio,w=g.tickEnable,E=g.tickPad,k=g.tickColor,L=g.tickAngle,M=g.labelEnable,P=g.labelPad,D=g.labelColor,N=g.labelAngle,U=this.labelOffset[a],G=this.labelCount[a],X=h.lt(y,T[a]),K=h.le(y,T[a+2]);l[0]=l[1]=0,l[a]=1,o[a]=(x[2+a]+x[a])/(A[2+a]-A[a])-1;var Z=2/A[2+(1^a)]-A[1^a];o[1^a]=Z*x[1^a]-1,w[a]&&(o[1^a]-=Z*S*E[a],X<K&&v[K]>v[X]&&(p.uniforms.dataAxis=l,p.uniforms.screenOffset=o,p.uniforms.color=k[a],p.uniforms.angle=L[a],b.drawArrays(b.TRIANGLES,v[X],v[K]-v[X]))),M[a]&&G&&(o[1^a]-=Z*S*P[a],p.uniforms.dataAxis=u,p.uniforms.screenOffset=o,p.uniforms.color=D[a],p.uniforms.angle=N[a],b.drawArrays(b.TRIANGLES,U,G)),o[1^a]=Z*x[2+(1^a)]-1,w[a+2]&&(o[1^a]+=Z*S*E[a+2],X<K&&v[K]>v[X]&&(p.uniforms.dataAxis=l,p.uniforms.screenOffset=o,p.uniforms.color=k[a+2],p.uniforms.angle=L[a+2],b.drawArrays(b.TRIANGLES,v[X],v[K]-v[X]))),M[a+2]&&G&&(o[1^a]+=Z*S*P[a+2],p.uniforms.dataAxis=u,p.uniforms.screenOffset=o,p.uniforms.color=D[a+2],p.uniforms.angle=N[a+2],b.drawArrays(b.TRIANGLES,U,G))}),n.drawTitle=function(){var a=[0,0],g=[0,0];return function(){var p=this.plot,y=this.shader,v=p.gl,b=p.screenBox,x=p.titleCenter,T=p.titleAngle,A=p.titleColor,S=p.pixelRatio;if(this.titleCount){for(var w=0;w<2;++w)g[w]=2*(x[w]*S-b[w])/(b[2+w]-b[w])-1;y.bind(),y.uniforms.dataAxis=a,y.uniforms.screenOffset=g,y.uniforms.angle=T,y.uniforms.color=A,v.drawArrays(v.TRIANGLES,this.titleOffset,this.titleCount)}}}(),n.bind=(s=[0,0],i=[0,0],c=[0,0],function(){var a=this.plot,g=this.shader,p=a._tickBounds,y=a.dataBox,v=a.screenBox,b=a.viewBox;g.bind();for(var x=0;x<2;++x){var T=p[x],A=p[x+2]-T,S=.5*(y[x+2]+y[x]),w=y[x+2]-y[x],E=b[x],k=b[x+2]-E,L=v[x],M=v[x+2]-L;i[x]=2*A/w*k/M,s[x]=2*(T-S)/w*k/M}c[1]=2*a.pixelRatio/(v[3]-v[1]),c[0]=c[1]*(v[3]-v[1])/(v[2]-v[0]),g.uniforms.dataScale=i,g.uniforms.dataShift=s,g.uniforms.textScale=c,this.vbo.bind(),g.attributes.textCoordinate.pointer()}),n.update=function(a){var g,p,y,v,b,x=[],T=a.ticks,A=a.bounds;for(b=0;b<2;++b){var S=[Math.floor(x.length/3)],w=[-1/0],E=T[b];for(g=0;g<E.length;++g){var k=E[g],L=k.x,M=k.text,P=k.font||"sans-serif";v=k.fontSize||12;for(var D=1/(A[b+2]-A[b]),N=A[b],U=M.split(`
`),G=0;G<U.length;G++)for(y=m(P,U[G]).data,p=0;p<y.length;p+=2)x.push(y[p]*v,-y[p+1]*v-G*v*1.2,(L-N)*D);S.push(Math.floor(x.length/3)),w.push(L)}this.tickOffset[b]=S,this.tickX[b]=w}for(b=0;b<2;++b){for(this.labelOffset[b]=Math.floor(x.length/3),y=m(a.labelFont[b],a.labels[b],{textAlign:"center"}).data,v=a.labelSize[b],g=0;g<y.length;g+=2)x.push(y[g]*v,-y[g+1]*v,0);this.labelCount[b]=Math.floor(x.length/3)-this.labelOffset[b]}for(this.titleOffset=Math.floor(x.length/3),y=m(a.titleFont,a.title).data,v=a.titleSize,g=0;g<y.length;g+=2)x.push(y[g]*v,-y[g+1]*v,0);this.titleCount=Math.floor(x.length/3)-this.titleOffset,this.vbo.update(x)},n.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":313,"binary-search-bounds":103,"gl-buffer":261,"gl-shader":332,"text-cache":581}],315:[function(r,I,B){arguments[4][268][0].apply(B,arguments)},{dup:268}],316:[function(r,I,B){I.exports=function(s){var i=s.gl,c=t(i,[i.drawingBufferWidth,i.drawingBufferHeight]),n=new f(i,c);return n.grid=d(n),n.text=m(n),n.line=h(n),n.box=e(n),n.update(s),n};var t=r("gl-select-static"),d=r("./lib/grid"),m=r("./lib/text"),h=r("./lib/line"),e=r("./lib/box");function f(s,i){this.gl=s,this.pickBuffer=i,this.screenBox=[0,0,s.drawingBufferWidth,s.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var l=f.prototype;function o(s){for(var i=s.slice(),c=0;c<i.length;++c)i[c]=i[c].slice();return i}function u(s,i){return s.x-i.x}l.setDirty=function(){this.dirty=this.pickDirty=!0},l.setOverlayDirty=function(){this.dirty=!0},l.nextDepthValue=function(){return this._depthCounter++/65536},l.draw=function(){var s=this.gl,i=this.screenBox,c=this.viewBox,n=this.dataBox,a=this.pixelRatio,g=this.grid,p=this.line,y=this.text,v=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){if(this.dirty=!1,s.bindFramebuffer(s.FRAMEBUFFER,null),s.enable(s.SCISSOR_TEST),s.disable(s.DEPTH_TEST),s.depthFunc(s.LESS),s.depthMask(!1),s.enable(s.BLEND),s.blendEquation(s.FUNC_ADD,s.FUNC_ADD),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),this.borderColor){s.scissor(i[0],i[1],i[2]-i[0],i[3]-i[1]);var b=this.borderColor;s.clearColor(b[0]*b[3],b[1]*b[3],b[2]*b[3],b[3]),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)}s.scissor(c[0],c[1],c[2]-c[0],c[3]-c[1]),s.viewport(c[0],c[1],c[2]-c[0],c[3]-c[1]);var x=this.backgroundColor;s.clearColor(x[0]*x[3],x[1]*x[3],x[2]*x[3],x[3]),s.clear(s.COLOR_BUFFER_BIT),g.draw();var T=this.zeroLineEnable,A=this.zeroLineColor,S=this.zeroLineWidth;if(T[0]||T[1]){p.bind();for(var w=0;w<2;++w)if(T[w]&&n[w]<=0&&n[w+2]>=0){var E=i[w]-n[w]*(i[w+2]-i[w])/(n[w+2]-n[w]);w===0?p.drawLine(E,i[1],E,i[3],S[w],A[w]):p.drawLine(i[0],E,i[2],E,S[w],A[w])}}for(w=0;w<v.length;++w)v[w].draw();s.viewport(i[0],i[1],i[2]-i[0],i[3]-i[1]),s.scissor(i[0],i[1],i[2]-i[0],i[3]-i[1]),this.grid.drawTickMarks(),p.bind();var k=this.borderLineEnable,L=this.borderLineWidth,M=this.borderLineColor;for(k[1]&&p.drawLine(c[0],c[1]-.5*L[1]*a,c[0],c[3]+.5*L[3]*a,L[1],M[1]),k[0]&&p.drawLine(c[0]-.5*L[0]*a,c[1],c[2]+.5*L[2]*a,c[1],L[0],M[0]),k[3]&&p.drawLine(c[2],c[1]-.5*L[1]*a,c[2],c[3]+.5*L[3]*a,L[3],M[3]),k[2]&&p.drawLine(c[0]-.5*L[0]*a,c[3],c[2]+.5*L[2]*a,c[3],L[2],M[2]),y.bind(),w=0;w<2;++w)y.drawTicks(w);this.titleEnable&&y.drawTitle();var P=this.overlays;for(w=0;w<P.length;++w)P[w].draw();s.disable(s.SCISSOR_TEST),s.disable(s.BLEND),s.depthMask(!0)}},l.drawPick=function(){if(!this.static){var s=this.pickBuffer;this.gl,this._pickTimeout=null,s.begin();for(var i=1,c=this.objects,n=0;n<c.length;++n)i=c[n].drawPick(i);s.end()}},l.pick=function(s,i){if(!this.static){var c=this.pixelRatio,n=this.pickPixelRatio,a=this.viewBox,g=0|Math.round((s-a[0]/c)*n),p=0|Math.round((i-a[1]/c)*n),y=this.pickBuffer.query(g,p,this.pickRadius);if(!y)return null;for(var v=y.id+(y.value[0]<<8)+(y.value[1]<<16)+(y.value[2]<<24),b=this.objects,x=0;x<b.length;++x){var T=b[x].pick(g,p,v);if(T)return T}return null}},l.setScreenBox=function(s){var i=this.screenBox,c=this.pixelRatio;i[0]=0|Math.round(s[0]*c),i[1]=0|Math.round(s[1]*c),i[2]=0|Math.round(s[2]*c),i[3]=0|Math.round(s[3]*c),this.setDirty()},l.setDataBox=function(s){var i=this.dataBox;(i[0]!==s[0]||i[1]!==s[1]||i[2]!==s[2]||i[3]!==s[3])&&(i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],this.setDirty())},l.setViewBox=function(s){var i=this.pixelRatio,c=this.viewBox;c[0]=0|Math.round(s[0]*i),c[1]=0|Math.round(s[1]*i),c[2]=0|Math.round(s[2]*i),c[3]=0|Math.round(s[3]*i);var n=this.pickPixelRatio;this.pickBuffer.shape=[0|Math.round((s[2]-s[0])*n),0|Math.round((s[3]-s[1])*n)],this.setDirty()},l.update=function(s){s=s||{};var i=this.gl;this.pixelRatio=s.pixelRatio||1;var c=this.pixelRatio;this.pickPixelRatio=Math.max(c,1),this.setScreenBox(s.screenBox||[0,0,i.drawingBufferWidth/c,i.drawingBufferHeight/c]),this.screenBox,this.setViewBox(s.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/c,.125*(this.screenBox[3]-this.screenBox[1])/c,.875*(this.screenBox[2]-this.screenBox[0])/c,.875*(this.screenBox[3]-this.screenBox[1])/c]);var n=this.viewBox,a=(n[2]-n[0])/(n[3]-n[1]);this.setDataBox(s.dataBox||[-10,-10/a,10,10/a]),this.borderColor=s.borderColor!==!1&&(s.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(s.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(s.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(s.gridLineWidth||[1,1]).slice(),this.gridLineColor=o(s.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(s.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(s.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=o(s.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(s.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(s.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=o(s.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(s.titleCenter||[.5*(n[0]+n[2])/c,(n[3]+120)/c]).slice(),this.titleEnable=!("titleEnable"in s)||!!s.titleEnable,this.titleAngle=s.titleAngle||0,this.titleColor=(s.titleColor||[0,0,0,1]).slice(),this.labelPad=(s.labelPad||[15,15,15,15]).slice(),this.labelAngle=(s.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(s.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=o(s.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(s.tickPad||[15,15,15,15]).slice(),this.tickAngle=(s.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(s.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=o(s.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(s.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(s.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=o(s.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var g=s.ticks||[[],[]],p=this._tickBounds;p[0]=p[1]=1/0,p[2]=p[3]=-1/0;for(var y=0;y<2;++y){var v=g[y].slice(0);v.length!==0&&(v.sort(u),p[y]=Math.min(p[y],v[0].x),p[y+2]=Math.max(p[y+2],v[v.length-1].x))}this.grid.update({bounds:p,ticks:g}),this.text.update({bounds:p,ticks:g,labels:s.labels||["x","y"],labelSize:s.labelSize||[12,12],labelFont:s.labelFont||["sans-serif","sans-serif"],title:s.title||"",titleSize:s.titleSize||18,titleFont:s.titleFont||"sans-serif"}),this.static=!!s.static,this.setDirty()},l.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var s=this.objects.length-1;s>=0;--s)this.objects[s].dispose();for(this.objects.length=0,s=this.overlays.length-1;s>=0;--s)this.overlays[s].dispose();this.overlays.length=0,this.gl=null},l.addObject=function(s){this.objects.indexOf(s)<0&&(this.objects.push(s),this.setDirty())},l.removeObject=function(s){for(var i=this.objects,c=0;c<i.length;++c)if(i[c]===s){i.splice(c,1),this.setDirty();break}},l.addOverlay=function(s){this.overlays.indexOf(s)<0&&(this.overlays.push(s),this.setOverlayDirty())},l.removeOverlay=function(s){for(var i=this.overlays,c=0;c<i.length;++c)if(i[c]===s){i.splice(c,1),this.setOverlayDirty();break}}},{"./lib/box":310,"./lib/grid":311,"./lib/line":312,"./lib/text":314,"gl-select-static":331}],317:[function(r,I,B){I.exports=function(l,o){l=l||document.body,o=o||{};var u=[.01,1/0];"distanceLimits"in o&&(u[0]=o.distanceLimits[0],u[1]=o.distanceLimits[1]),"zoomMin"in o&&(u[0]=o.zoomMin),"zoomMax"in o&&(u[1]=o.zoomMax);var s=d({center:o.center||[0,0,0],up:o.up||[0,1,0],eye:o.eye||[0,0,10],mode:o.mode||"orbit",distanceLimits:u}),i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=0,n=l.clientWidth,a=l.clientHeight,g={keyBindingMode:"rotate",enableWheel:!0,view:s,element:l,delay:o.delay||16,rotateSpeed:o.rotateSpeed||1,zoomSpeed:o.zoomSpeed||1,translateSpeed:o.translateSpeed||1,flipX:!!o.flipX,flipY:!!o.flipY,modes:s.modes,_ortho:o._ortho||o.projection&&o.projection.type==="orthographic"||!1,tick:function(){var p=t(),y=this.delay,v=p-2*y;s.idle(p-y),s.recalcMatrix(v),s.flush(p-(100+2*y));for(var b=!0,x=s.computedMatrix,T=0;T<16;++T)b=b&&i[T]===x[T],i[T]=x[T];var A=l.clientWidth===n&&l.clientHeight===a;return n=l.clientWidth,a=l.clientHeight,b?!A:(c=Math.exp(s.computedRadius[0]),!0)},lookAt:function(p,y,v){s.lookAt(s.lastT(),p,y,v)},rotate:function(p,y,v){s.rotate(s.lastT(),p,y,v)},pan:function(p,y,v){s.pan(s.lastT(),p,y,v)},translate:function(p,y,v){s.translate(s.lastT(),p,y,v)}};return Object.defineProperties(g,{matrix:{get:function(){return s.computedMatrix},set:function(p){return s.setMatrix(s.lastT(),p),s.computedMatrix},enumerable:!0},mode:{get:function(){return s.getMode()},set:function(p){var y=s.computedUp.slice(),v=s.computedEye.slice(),b=s.computedCenter.slice();if(s.setMode(p),p==="turntable"){var x=t();s._active.lookAt(x,v,b,y),s._active.lookAt(x+500,v,b,[0,0,1]),s._active.flush(x)}return s.getMode()},enumerable:!0},center:{get:function(){return s.computedCenter},set:function(p){return s.lookAt(s.lastT(),null,p),s.computedCenter},enumerable:!0},eye:{get:function(){return s.computedEye},set:function(p){return s.lookAt(s.lastT(),p),s.computedEye},enumerable:!0},up:{get:function(){return s.computedUp},set:function(p){return s.lookAt(s.lastT(),null,null,p),s.computedUp},enumerable:!0},distance:{get:function(){return c},set:function(p){return s.setDistance(s.lastT(),p),p},enumerable:!0},distanceLimits:{get:function(){return s.getDistanceLimits(u)},set:function(p){return s.setDistanceLimits(p),p},enumerable:!0}}),l.addEventListener("contextmenu",function(p){return p.preventDefault(),!1}),g._lastX=-1,g._lastY=-1,g._lastMods={shift:!1,control:!1,alt:!1,meta:!1},g.enableMouseListeners=function(){function p(y,v,b,x){var T=g.keyBindingMode;if(T!==!1){var A=T==="rotate",S=T==="pan",w=T==="zoom",E=!!x.control,k=!!x.alt,L=!!x.shift,M=!!(1&y),P=!!(2&y),D=!!(4&y),N=1/l.clientHeight,U=N*(v-g._lastX),G=N*(b-g._lastY),X=g.flipX?1:-1,K=g.flipY?1:-1,Z=Math.PI*g.rotateSpeed,H=t();if(g._lastX!==-1&&g._lastY!==-1&&((A&&M&&!E&&!k&&!L||M&&!E&&!k&&L)&&s.rotate(H,X*Z*U,-K*Z*G,0),(S&&M&&!E&&!k&&!L||P||M&&E&&!k&&!L)&&s.pan(H,-g.translateSpeed*U*c,g.translateSpeed*G*c,0),w&&M&&!E&&!k&&!L||D||M&&!E&&k&&!L)){var Y=-g.zoomSpeed*G/window.innerHeight*(H-s.lastT())*100;s.pan(H,0,0,c*(Math.exp(Y)-1))}return g._lastX=v,g._lastY=b,g._lastMods=x,!0}}g.mouseListener=m(l,p),l.addEventListener("touchstart",function(y){var v=e(y.changedTouches[0],l);p(0,v[0],v[1],g._lastMods),p(1,v[0],v[1],g._lastMods)},!!f&&{passive:!0}),l.addEventListener("touchmove",function(y){var v=e(y.changedTouches[0],l);p(1,v[0],v[1],g._lastMods),y.preventDefault()},!!f&&{passive:!1}),l.addEventListener("touchend",function(y){p(0,g._lastX,g._lastY,g._lastMods)},!!f&&{passive:!0}),g.wheelListener=h(l,function(y,v){if(g.keyBindingMode!==!1&&g.enableWheel){var b=g.flipX?1:-1,x=g.flipY?1:-1,T=t();if(Math.abs(y)>Math.abs(v))s.rotate(T,0,0,-y*b*Math.PI*g.rotateSpeed/window.innerWidth);else if(!g._ortho){var A=-g.zoomSpeed*x*v/window.innerHeight*(T-s.lastT())/20;s.pan(T,0,0,c*(Math.exp(A)-1))}}},!0)},g.enableMouseListeners(),g};var t=r("right-now"),d=r("3d-view"),m=r("mouse-change"),h=r("mouse-wheel"),e=r("mouse-event-offset"),f=r("has-passive-events")},{"3d-view":55,"has-passive-events":436,"mouse-change":459,"mouse-event-offset":460,"mouse-wheel":462,"right-now":528}],318:[function(r,I,B){var t=r("glslify"),d=r("gl-shader"),m=t([`precision mediump float;
#define GLSLIFY 1
attribute vec2 position;
varying vec2 uv;
void main() {
  uv = position;
  gl_Position = vec4(position, 0, 1);
}`]),h=t([`precision mediump float;
#define GLSLIFY 1

uniform sampler2D accumBuffer;
varying vec2 uv;

void main() {
  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));
  gl_FragColor = min(vec4(1,1,1,1), accum);
}`]);I.exports=function(e){return d(e,m,h,null,[{name:"position",type:"vec2"}])}},{"gl-shader":332,glslify:434}],319:[function(r,I,B){var t=r("./camera.js"),d=r("gl-axes3d"),m=r("gl-axes3d/properties"),h=r("gl-spikes3d"),e=r("gl-select-static"),f=r("gl-fbo"),l=r("a-big-triangle"),o=r("mouse-change"),u=r("gl-mat4/perspective"),s=r("gl-mat4/ortho"),i=r("./lib/shader"),c=r("is-mobile")({tablet:!0,featureDetect:!0});function n(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function a(p){var y=Math.round(Math.log(Math.abs(p))/Math.log(10));if(y<0){var v=Math.round(Math.pow(10,-y));return Math.ceil(p*v)/v}return y>0?(v=Math.round(Math.pow(10,y)),Math.ceil(p/v)*v):Math.ceil(p)}function g(p){return typeof p!="boolean"||p}I.exports={createScene:function(p){(p=p||{}).camera=p.camera||{};var y=p.canvas;y||(y=document.createElement("canvas"),p.container?p.container.appendChild(y):document.body.appendChild(y));var v=p.gl;if(v||(p.glOptions&&(c=!!p.glOptions.preserveDrawingBuffer),v=function(ae,he){var se=null;try{(se=ae.getContext("webgl",he))||(se=ae.getContext("experimental-webgl",he))}catch(de){return null}return se}(y,p.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:c})),!v)throw new Error("webgl not supported");var b=p.bounds||[[-10,-10,-10],[10,10,10]],x=new n,T=f(v,v.drawingBufferWidth,v.drawingBufferHeight,{preferFloat:!c}),A=i(v),S=p.cameraObject&&p.cameraObject._ortho===!0||p.camera.projection&&p.camera.projection.type==="orthographic"||!1,w={eye:p.camera.eye||[2,0,0],center:p.camera.center||[0,0,0],up:p.camera.up||[0,1,0],zoomMin:p.camera.zoomMax||.1,zoomMax:p.camera.zoomMin||100,mode:p.camera.mode||"turntable",_ortho:S},E=p.axes||{},k=d(v,E);k.enable=!E.disable;var L=p.spikes||{},M=h(v,L),P=[],D=[],N=[],U=[],G=!0,X=!0,K=new Array(16),Z=new Array(16),H={view:null,projection:K,model:Z,_ortho:!1},Y=(X=!0,[v.drawingBufferWidth,v.drawingBufferHeight]),$=p.cameraObject||t(y,w),z={gl:v,contextLost:!1,pixelRatio:p.pixelRatio||1,canvas:y,selection:x,camera:$,axes:k,axesPixels:null,spikes:M,bounds:b,objects:P,shape:Y,aspect:p.aspectRatio||[1,1,1],pickRadius:p.pickRadius||10,zNear:p.zNear||.01,zFar:p.zFar||1e3,fovy:p.fovy||Math.PI/4,clearColor:p.clearColor||[0,0,0,0],autoResize:g(p.autoResize),autoBounds:g(p.autoBounds),autoScale:!!p.autoScale,autoCenter:g(p.autoCenter),clipToBounds:g(p.clipToBounds),snapToData:!!p.snapToData,onselect:p.onselect||null,onrender:p.onrender||null,onclick:p.onclick||null,cameraParams:H,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(ae){this.aspect[0]=ae.x,this.aspect[1]=ae.y,this.aspect[2]=ae.z,X=!0},setBounds:function(ae,he){this.bounds[0][ae]=he.min,this.bounds[1][ae]=he.max},setClearColor:function(ae){this.clearColor=ae},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},j=[v.drawingBufferWidth/z.pixelRatio|0,v.drawingBufferHeight/z.pixelRatio|0];function W(){if(!z._stopped&&z.autoResize){var ae=y.parentNode,he=1,se=1;ae&&ae!==document.body?(he=ae.clientWidth,se=ae.clientHeight):(he=window.innerWidth,se=window.innerHeight);var de=0|Math.ceil(he*z.pixelRatio),ue=0|Math.ceil(se*z.pixelRatio);if(de!==y.width||ue!==y.height){y.width=de,y.height=ue;var ve=y.style;ve.position=ve.position||"absolute",ve.left="0px",ve.top="0px",ve.width=he+"px",ve.height=se+"px",G=!0}}}z.autoResize&&W();function ee(){for(var ae=P.length,he=U.length,se=0;se<he;++se)N[se]=0;e:for(se=0;se<ae;++se){var de=P[se],ue=de.pickSlots;if(ue){for(var ve=0;ve<he;++ve)if(N[ve]+ue<255){D[se]=ve,de.setPickBase(N[ve]+1),N[ve]+=ue;continue e}var ke=e(v,Y);D[se]=he,U.push(ke),N.push(ue),de.setPickBase(1),he+=1}else D[se]=-1}for(;he>0&&N[he-1]===0;)N.pop(),U.pop().dispose()}function J(){if(z.contextLost)return!0;v.isContextLost()&&(z.contextLost=!0,z.mouseListener.enabled=!1,z.selection.object=null,z.oncontextloss&&z.oncontextloss())}window.addEventListener("resize",W),z.update=function(ae){z._stopped||(G=!0,X=!0)},z.add=function(ae){z._stopped||(ae.axes=k,P.push(ae),D.push(-1),G=!0,X=!0,ee())},z.remove=function(ae){if(!z._stopped){var he=P.indexOf(ae);he<0||(P.splice(he,1),D.pop(),G=!0,X=!0,ee())}},z.dispose=function(){if(!z._stopped&&(z._stopped=!0,window.removeEventListener("resize",W),y.removeEventListener("webglcontextlost",J),z.mouseListener.enabled=!1,!z.contextLost)){k.dispose(),M.dispose();for(var ae=0;ae<P.length;++ae)P[ae].dispose();for(T.dispose(),ae=0;ae<U.length;++ae)U[ae].dispose();A.dispose(),v=null,k=null,M=null,P=[]}},z._mouseRotating=!1,z._prevButtons=0,z.enableMouseListeners=function(){z.mouseListener=o(y,function(ae,he,se){if(!z._stopped){var de=U.length,ue=P.length,ve=x.object;x.distance=1/0,x.mouse[0]=he,x.mouse[1]=se,x.object=null,x.screen=null,x.dataCoordinate=x.dataPosition=null;var ke=!1;if(ae&&z._prevButtons)z._mouseRotating=!0;else{z._mouseRotating&&(X=!0),z._mouseRotating=!1;for(var Ee=0;Ee<de;++Ee){var be=U[Ee].query(he,j[1]-se-1,z.pickRadius);if(be){if(be.distance>x.distance)continue;for(var xe=0;xe<ue;++xe){var ce=P[xe];if(D[xe]===Ee){var ge=ce.pick(be);ge&&(x.buttons=ae,x.screen=be.coord,x.distance=be.distance,x.object=ce,x.index=ge.distance,x.dataPosition=ge.position,x.dataCoordinate=ge.dataCoordinate,x.data=ge,ke=!0)}}}}}ve&&ve!==x.object&&(ve.highlight&&ve.highlight(null),G=!0),x.object&&(x.object.highlight&&x.object.highlight(x.data),G=!0),(ke=ke||x.object!==ve)&&z.onselect&&z.onselect(x),1&ae&&!(1&z._prevButtons)&&z.onclick&&z.onclick(x),z._prevButtons=ae}})},y.addEventListener("webglcontextlost",J);var Q=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],te=[Q[0].slice(),Q[1].slice()];function ie(){if(!J()){W();var ae=z.camera.tick();H.view=z.camera.matrix,G=G||ae,X=X||ae,k.pixelRatio=z.pixelRatio,M.pixelRatio=z.pixelRatio;var he=P.length,se=Q[0],de=Q[1];se[0]=se[1]=se[2]=1/0,de[0]=de[1]=de[2]=-1/0;for(var ue=0;ue<he;++ue){(Fe=P[ue]).pixelRatio=z.pixelRatio,Fe.axes=z.axes,G=G||!!Fe.dirty,X=X||!!Fe.dirty;var ve=Fe.bounds;if(ve)for(var ke=ve[0],Ee=ve[1],be=0;be<3;++be)se[be]=Math.min(se[be],ke[be]),de[be]=Math.max(de[be],Ee[be])}var xe=z.bounds;if(z.autoBounds)for(be=0;be<3;++be){if(de[be]<se[be])se[be]=-1,de[be]=1;else{se[be]===de[be]&&(se[be]-=1,de[be]+=1);var ce=.05*(de[be]-se[be]);se[be]=se[be]-ce,de[be]=de[be]+ce}xe[0][be]=se[be],xe[1][be]=de[be]}var ge=!1;for(be=0;be<3;++be)ge=ge||te[0][be]!==xe[0][be]||te[1][be]!==xe[1][be],te[0][be]=xe[0][be],te[1][be]=xe[1][be];if(X=X||ge,G=G||ge){if(ge){var we=[0,0,0];for(ue=0;ue<3;++ue)we[ue]=a((xe[1][ue]-xe[0][ue])/10);k.autoTicks?k.update({bounds:xe,tickSpacing:we}):k.update({bounds:xe})}var Me=v.drawingBufferWidth,Se=v.drawingBufferHeight;for(Y[0]=Me,Y[1]=Se,j[0]=0|Math.max(Me/z.pixelRatio,1),j[1]=0|Math.max(Se/z.pixelRatio,1),function(Ye,rt){var Oe=Ye.bounds,je=Ye.cameraParams,We=je.projection,qe=je.model,et=Ye.gl.drawingBufferWidth,st=Ye.gl.drawingBufferHeight,ct=Ye.zNear,Pt=Ye.zFar,kt=Ye.fovy,at=et/st;rt?(s(We,-at,at,-1,1,ct,Pt),je._ortho=!0):(u(We,kt,at,ct,Pt),je._ortho=!1);for(var tt=0;tt<16;++tt)qe[tt]=0;qe[15]=1;var _t=0;for(tt=0;tt<3;++tt)_t=Math.max(_t,Oe[1][tt]-Oe[0][tt]);for(tt=0;tt<3;++tt)Ye.autoScale?qe[5*tt]=Ye.aspect[tt]/(Oe[1][tt]-Oe[0][tt]):qe[5*tt]=1/_t,Ye.autoCenter&&(qe[12+tt]=.5*-qe[5*tt]*(Oe[0][tt]+Oe[1][tt]))}(z,S),ue=0;ue<he;++ue)(Fe=P[ue]).axesBounds=xe,z.clipToBounds&&(Fe.clipBounds=xe);x.object&&(z.snapToData?M.position=x.dataCoordinate:M.position=x.dataPosition,M.bounds=xe),X&&(X=!1,function(){if(!J()){v.colorMask(!0,!0,!0,!0),v.depthMask(!0),v.disable(v.BLEND),v.enable(v.DEPTH_TEST),v.depthFunc(v.LEQUAL);for(var Ye=P.length,rt=U.length,Oe=0;Oe<rt;++Oe){var je=U[Oe];je.shape=j,je.begin();for(var We=0;We<Ye;++We)if(D[We]===Oe){var qe=P[We];qe.drawPick&&(qe.pixelRatio=1,qe.drawPick(H))}je.end()}}}()),z.axesPixels=m(z.axes,H,Me,Se),z.onrender&&z.onrender(),v.bindFramebuffer(v.FRAMEBUFFER,null),v.viewport(0,0,Me,Se),z.clearRGBA(),v.depthMask(!0),v.colorMask(!0,!0,!0,!0),v.enable(v.DEPTH_TEST),v.depthFunc(v.LEQUAL),v.disable(v.BLEND),v.disable(v.CULL_FACE);var ze=!1;for(k.enable&&(ze=ze||k.isTransparent(),k.draw(H)),M.axes=k,x.object&&M.draw(H),v.disable(v.CULL_FACE),ue=0;ue<he;++ue)(Fe=P[ue]).axes=k,Fe.pixelRatio=z.pixelRatio,Fe.isOpaque&&Fe.isOpaque()&&Fe.draw(H),Fe.isTransparent&&Fe.isTransparent()&&(ze=!0);if(ze){for(T.shape=Y,T.bind(),v.clear(v.DEPTH_BUFFER_BIT),v.colorMask(!1,!1,!1,!1),v.depthMask(!0),v.depthFunc(v.LESS),k.enable&&k.isTransparent()&&k.drawTransparent(H),ue=0;ue<he;++ue)(Fe=P[ue]).isOpaque&&Fe.isOpaque()&&Fe.draw(H);for(v.enable(v.BLEND),v.blendEquation(v.FUNC_ADD),v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),v.colorMask(!0,!0,!0,!0),v.depthMask(!1),v.clearColor(0,0,0,0),v.clear(v.COLOR_BUFFER_BIT),k.isTransparent()&&k.drawTransparent(H),ue=0;ue<he;++ue){var Fe;(Fe=P[ue]).isTransparent&&Fe.isTransparent()&&Fe.drawTransparent(H)}v.bindFramebuffer(v.FRAMEBUFFER,null),v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),v.disable(v.DEPTH_TEST),A.bind(),T.color[0].bind(0),A.uniforms.accumBuffer=0,l(v),v.disable(v.BLEND)}for(G=!1,ue=0;ue<he;++ue)P[ue].dirty=!1}}}return z.enableMouseListeners(),function ae(){z._stopped||z.contextLost||(ie(),requestAnimationFrame(ae))}(),z.redraw=function(){z._stopped||(G=!0,ie())},z},createCamera:t}},{"./camera.js":317,"./lib/shader":318,"a-big-triangle":70,"gl-axes3d":253,"gl-axes3d/properties":260,"gl-fbo":270,"gl-mat4/ortho":296,"gl-mat4/perspective":297,"gl-select-static":331,"gl-spikes3d":341,"is-mobile":445,"mouse-change":459}],320:[function(r,I,B){var t=r("glslify");B.pointVertex=t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;

uniform mat3 matrix;
uniform float pointSize;
uniform float pointCloud;

highp float rand(vec2 co) {
  highp float a = 12.9898;
  highp float b = 78.233;
  highp float c = 43758.5453;
  highp float d = dot(co.xy, vec2(a, b));
  highp float e = mod(d, 3.14);
  return fract(sin(e) * c);
}

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
    // if we don't jitter the point size a bit, overall point cloud
    // saturation 'jumps' on zooming, which is disturbing and confusing
  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);
  if(pointCloud != 0.0) { // pointCloud is truthy
    // get the same square surface as circle would be
    gl_PointSize *= 0.886;
  }
}`]),B.pointFragment=t([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color, borderColor;
uniform float centerFraction;
uniform float pointCloud;

void main() {
  float radius;
  vec4 baseColor;
  if(pointCloud != 0.0) { // pointCloud is truthy
    if(centerFraction == 1.0) {
      gl_FragColor = color;
    } else {
      gl_FragColor = mix(borderColor, color, centerFraction);
    }
  } else {
    radius = length(2.0 * gl_PointCoord.xy - 1.0);
    if(radius > 1.0) {
      discard;
    }
    baseColor = mix(borderColor, color, step(radius, centerFraction));
    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);
  }
}
`]),B.pickVertex=t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;

uniform mat3 matrix;
uniform float pointSize;
uniform vec4 pickOffset;

varying vec4 fragId;

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
  gl_PointSize = pointSize;

  vec4 id = pickId + pickOffset;
  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  fragId = id;
}
`]),B.pickFragment=t([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;

void main() {
  float radius = length(2.0 * gl_PointCoord.xy - 1.0);
  if(radius > 1.0) {
    discard;
  }
  gl_FragColor = fragId / 255.0;
}
`])},{glslify:434}],321:[function(r,I,B){var t=r("gl-shader"),d=r("gl-buffer"),m=r("typedarray-pool"),h=r("./lib/shader");function e(u,s,i,c,n){this.plot=u,this.offsetBuffer=s,this.pickBuffer=i,this.shader=c,this.pickShader=n,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}I.exports=function(u,s){var i=u.gl,c=d(i),n=d(i),a=t(i,h.pointVertex,h.pointFragment),g=t(i,h.pickVertex,h.pickFragment),p=new e(u,c,n,a,g);return p.update(s),u.addObject(p),p};var f,l,o=e.prototype;o.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},o.update=function(u){var s;function i(v,b){return v in u?u[v]:b}u=u||{},this.sizeMin=i("sizeMin",.5),this.sizeMax=i("sizeMax",20),this.color=i("color",[1,0,0,1]).slice(),this.areaRatio=i("areaRatio",1),this.borderColor=i("borderColor",[0,0,0,1]).slice(),this.blend=i("blend",!1);var c=u.positions.length>>>1,n=u.positions instanceof Float32Array,a=u.idToIndex instanceof Int32Array&&u.idToIndex.length>=c,g=u.positions,p=n?g:m.mallocFloat32(g.length),y=a?u.idToIndex:m.mallocInt32(c);if(n||p.set(g),!a)for(p.set(g),s=0;s<c;s++)y[s]=s;this.points=g,this.offsetBuffer.update(p),this.pickBuffer.update(y),n||m.free(p),a||m.free(y),this.pointCount=c,this.pickOffset=0},o.unifiedDraw=(f=[1,0,0,0,1,0,0,0,1],l=[0,0,0,0],function(u){var s=u!==void 0,i=s?this.pickShader:this.shader,c=this.plot.gl,n=this.plot.dataBox;if(this.pointCount===0)return u;var a=n[2]-n[0],g=n[3]-n[1],p=function(x,T){var A,S=0,w=x.length>>>1;for(A=0;A<w;A++){var E=x[2*A],k=x[2*A+1];E>=T[0]&&E<=T[2]&&k>=T[1]&&k<=T[3]&&S++}return S}(this.points,n),y=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(p,.33333)));f[0]=2/a,f[4]=2/g,f[6]=-2*n[0]/a-1,f[7]=-2*n[1]/g-1,this.offsetBuffer.bind(),i.bind(),i.attributes.position.pointer(),i.uniforms.matrix=f,i.uniforms.color=this.color,i.uniforms.borderColor=this.borderColor,i.uniforms.pointCloud=y<5,i.uniforms.pointSize=y,i.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),s&&(l[0]=255&u,l[1]=u>>8&255,l[2]=u>>16&255,l[3]=u>>24&255,this.pickBuffer.bind(),i.attributes.pickId.pointer(c.UNSIGNED_BYTE),i.uniforms.pickOffset=l,this.pickOffset=u);var v=c.getParameter(c.BLEND),b=c.getParameter(c.DITHER);return v&&!this.blend&&c.disable(c.BLEND),b&&c.disable(c.DITHER),c.drawArrays(c.POINTS,0,this.pointCount),v&&!this.blend&&c.enable(c.BLEND),b&&c.enable(c.DITHER),u+this.pointCount}),o.draw=o.unifiedDraw,o.drawPick=o.unifiedDraw,o.pick=function(u,s,i){var c=this.pickOffset,n=this.pointCount;if(i<c||i>=c+n)return null;var a=i-c,g=this.points;return{object:this,pointId:a,dataCoord:[g[2*a],g[2*a+1]]}}},{"./lib/shader":320,"gl-buffer":261,"gl-shader":332,"typedarray-pool":601}],322:[function(r,I,B){I.exports=function(t,d,m,h){var e,f,l,o,u,s=d[0],i=d[1],c=d[2],n=d[3],a=m[0],g=m[1],p=m[2],y=m[3];return(f=s*a+i*g+c*p+n*y)<0&&(f=-f,a=-a,g=-g,p=-p,y=-y),1-f>1e-6?(e=Math.acos(f),l=Math.sin(e),o=Math.sin((1-h)*e)/l,u=Math.sin(h*e)/l):(o=1-h,u=h),t[0]=o*s+u*a,t[1]=o*i+u*g,t[2]=o*c+u*p,t[3]=o*n+u*y,t}},{}],323:[function(r,I,B){I.exports=function(t){return t||t===0?t.toString():""}},{}],324:[function(r,I,B){var t=r("vectorize-text");I.exports=function(m,h,e){var f=d[h];if(f||(f=d[h]={}),m in f)return f[m];var l={textAlign:"center",textBaseline:"middle",lineHeight:1,font:h,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},o=t(m,l);l.triangles=!1;var u,s,i=t(m,l);if(e&&e!==1){for(u=0;u<o.positions.length;++u)for(s=0;s<o.positions[u].length;++s)o.positions[u][s]/=e;for(u=0;u<i.positions.length;++u)for(s=0;s<i.positions[u].length;++s)i.positions[u][s]/=e}var c=[[1/0,1/0],[-1/0,-1/0]],n=i.positions.length;for(u=0;u<n;++u){var a=i.positions[u];for(s=0;s<2;++s)c[0][s]=Math.min(c[0][s],a[s]),c[1][s]=Math.max(c[1][s],a[s])}return f[m]=[o,i,c]};var d={}},{"vectorize-text":607}],325:[function(r,I,B){var t=r("gl-shader"),d=r("glslify"),m=d([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform vec4 highlightId;
uniform float highlightScale;
uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = 1.0;
    if(distance(highlightId, id) < 0.0001) {
      scale = highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1);
    vec4 viewPosition = view * worldPosition;
    viewPosition = viewPosition / viewPosition.w;
    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),h=d([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float highlightScale, pixelRatio;
uniform vec4 highlightId;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = pixelRatio;
    if(distance(highlightId.bgr, id.bgr) < 0.001) {
      scale *= highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1.0);
    vec4 viewPosition = view * worldPosition;
    vec4 clipPosition = projection * viewPosition;
    clipPosition /= clipPosition.w;

    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),e=d([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform float highlightScale;
uniform vec4 highlightId;
uniform vec3 axes[2];
uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float scale, pixelRatio;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float lscale = pixelRatio * scale;
    if(distance(highlightId, id) < 0.0001) {
      lscale *= highlightScale;
    }

    vec4 clipCenter   = projection * view * model * vec4(position, 1);
    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;
    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = dataPosition;
  }
}
`]),f=d([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float opacity;

varying vec4 interpColor;
varying vec3 dataCoordinate;

void main() {
  if (
    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||
    interpColor.a * opacity == 0.
  ) discard;
  gl_FragColor = interpColor * opacity;
}
`]),l=d([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float pickGroup;

varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;

  gl_FragColor = vec4(pickGroup, pickId.bgr);
}`]),o=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],u={vertex:m,fragment:f,attributes:o},s={vertex:h,fragment:f,attributes:o},i={vertex:e,fragment:f,attributes:o},c={vertex:m,fragment:l,attributes:o},n={vertex:h,fragment:l,attributes:o},a={vertex:e,fragment:l,attributes:o};function g(p,y){var v=t(p,y),b=v.attributes;return b.position.location=0,b.color.location=1,b.glyph.location=2,b.id.location=3,v}B.createPerspective=function(p){return g(p,u)},B.createOrtho=function(p){return g(p,s)},B.createProject=function(p){return g(p,i)},B.createPickPerspective=function(p){return g(p,c)},B.createPickOrtho=function(p){return g(p,n)},B.createPickProject=function(p){return g(p,a)}},{"gl-shader":332,glslify:326}],326:[function(r,I,B){arguments[4][268][0].apply(B,arguments)},{dup:268}],327:[function(r,I,B){var t=r("is-string-blank"),d=r("gl-buffer"),m=r("gl-vao"),h=r("typedarray-pool"),e=r("gl-mat4/multiply"),f=r("./lib/shaders"),l=r("./lib/glyphs"),o=r("./lib/get-simple-string"),u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function s(N,U){var G=N[0],X=N[1],K=N[2],Z=N[3];return N[0]=U[0]*G+U[4]*X+U[8]*K+U[12]*Z,N[1]=U[1]*G+U[5]*X+U[9]*K+U[13]*Z,N[2]=U[2]*G+U[6]*X+U[10]*K+U[14]*Z,N[3]=U[3]*G+U[7]*X+U[11]*K+U[15]*Z,N}function i(N,U,G,X){return s(X,X),s(X,X),s(X,X)}function c(N,U){this.index=N,this.dataCoordinate=this.position=U}function n(N){return N===!0||N>1?1:N}function a(N,U,G,X,K,Z,H,Y,$,z,j,W){this.gl=N,this.pixelRatio=1,this.shader=U,this.orthoShader=G,this.projectShader=X,this.pointBuffer=K,this.colorBuffer=Z,this.glyphBuffer=H,this.idBuffer=Y,this.vao=$,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=z,this.pickOrthoShader=j,this.pickProjectShader=W,this.points=[],this._selectResult=new c(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}I.exports=function(N){var U=N.gl,G=f.createPerspective(U),X=f.createOrtho(U),K=f.createProject(U),Z=f.createPickPerspective(U),H=f.createPickOrtho(U),Y=f.createPickProject(U),$=d(U),z=d(U),j=d(U),W=d(U),ee=m(U,[{buffer:$,size:3,type:U.FLOAT},{buffer:z,size:4,type:U.FLOAT},{buffer:j,size:2,type:U.FLOAT},{buffer:W,size:4,type:U.UNSIGNED_BYTE,normalized:!0}]),J=new a(U,G,X,K,$,z,j,W,ee,Z,H,Y);return J.update(N),J};var g=a.prototype;g.pickSlots=1,g.setPickBase=function(N){this.pickId=N},g.isTransparent=function(){if(this.hasAlpha)return!0;for(var N=0;N<3;++N)if(this.axesProject[N]&&this.projectHasAlpha)return!0;return!1},g.isOpaque=function(){if(!this.hasAlpha)return!0;for(var N=0;N<3;++N)if(this.axesProject[N]&&!this.projectHasAlpha)return!0;return!1};var p=[0,0],y=[0,0,0],v=[0,0,0],b=[0,0,0,1],x=[0,0,0,1],T=u.slice(),A=[0,0,0],S=[[0,0,0],[0,0,0]];function w(N){return N[0]=N[1]=N[2]=0,N}function E(N,U){return N[0]=U[0],N[1]=U[1],N[2]=U[2],N[3]=1,N}function k(N,U,G,X){return N[0]=U[0],N[1]=U[1],N[2]=U[2],N[G]=X,N}function L(N,U,G,X){var K,Z=U.axesProject,H=U.gl,Y=N.uniforms,$=G.model||u,z=G.view||u,j=G.projection||u,W=U.axesBounds,ee=function(xe){for(var ce=S,ge=0;ge<2;++ge)for(var we=0;we<3;++we)ce[ge][we]=Math.max(Math.min(xe[ge][we],1e8),-1e8);return ce}(U.clipBounds);K=U.axes&&U.axes.lastCubeProps?U.axes.lastCubeProps.axis:[1,1,1],p[0]=2/H.drawingBufferWidth,p[1]=2/H.drawingBufferHeight,N.bind(),Y.view=z,Y.projection=j,Y.screenSize=p,Y.highlightId=U.highlightId,Y.highlightScale=U.highlightScale,Y.clipBounds=ee,Y.pickGroup=U.pickId/255,Y.pixelRatio=X;for(var J=0;J<3;++J)if(Z[J]){Y.scale=U.projectScale[J],Y.opacity=U.projectOpacity[J];for(var Q=T,te=0;te<16;++te)Q[te]=0;for(te=0;te<4;++te)Q[5*te]=1;Q[5*J]=0,K[J]<0?Q[12+J]=W[0][J]:Q[12+J]=W[1][J],e(Q,$,Q),Y.model=Q;var ie=(J+1)%3,ae=(J+2)%3,he=w(y),se=w(v);he[ie]=1,se[ae]=1;var de=i(0,0,0,E(b,he)),ue=i(0,0,0,E(x,se));if(Math.abs(de[1])>Math.abs(ue[1])){var ve=de;de=ue,ue=ve,ve=he,he=se,se=ve;var ke=ie;ie=ae,ae=ke}de[0]<0&&(he[ie]=-1),ue[1]>0&&(se[ae]=-1);var Ee=0,be=0;for(te=0;te<4;++te)Ee+=Math.pow($[4*ie+te],2),be+=Math.pow($[4*ae+te],2);he[ie]/=Math.sqrt(Ee),se[ae]/=Math.sqrt(be),Y.axes[0]=he,Y.axes[1]=se,Y.fragClipBounds[0]=k(A,ee[0],J,-1e8),Y.fragClipBounds[1]=k(A,ee[1],J,1e8),U.vao.bind(),U.vao.draw(H.TRIANGLES,U.vertexCount),U.lineWidth>0&&(H.lineWidth(U.lineWidth*X),U.vao.draw(H.LINES,U.lineVertexCount,U.vertexCount)),U.vao.unbind()}}var M=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];function P(N,U,G,X,K,Z,H){var Y=G.gl;if((Z===G.projectHasAlpha||H)&&L(U,G,X,K),Z===G.hasAlpha||H){N.bind();var $=N.uniforms;$.model=X.model||u,$.view=X.view||u,$.projection=X.projection||u,p[0]=2/Y.drawingBufferWidth,p[1]=2/Y.drawingBufferHeight,$.screenSize=p,$.highlightId=G.highlightId,$.highlightScale=G.highlightScale,$.fragClipBounds=M,$.clipBounds=G.axes.bounds,$.opacity=G.opacity,$.pickGroup=G.pickId/255,$.pixelRatio=K,G.vao.bind(),G.vao.draw(Y.TRIANGLES,G.vertexCount),G.lineWidth>0&&(Y.lineWidth(G.lineWidth*K),G.vao.draw(Y.LINES,G.lineVertexCount,G.vertexCount)),G.vao.unbind()}}function D(N,U,G,X){var K;K=Array.isArray(N)?U<N.length?N[U]:void 0:N,K=o(K);var Z=!0;t(K)&&(K="\u25BC",Z=!1);var H=l(K,G,X);return{mesh:H[0],lines:H[1],bounds:H[2],visible:Z}}g.draw=function(N){P(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,N,this.pixelRatio,!1,!1)},g.drawTransparent=function(N){P(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,N,this.pixelRatio,!0,!1)},g.drawPick=function(N){P(this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader,this.pickProjectShader,this,N,1,!0,!0)},g.pick=function(N){if(!N||N.id!==this.pickId)return null;var U=N.value[2]+(N.value[1]<<8)+(N.value[0]<<16);if(U>=this.pointCount||U<0)return null;var G=this.points[U],X=this._selectResult;X.index=U;for(var K=0;K<3;++K)X.position[K]=X.dataCoordinate[K]=G[K];return X},g.highlight=function(N){if(N){var U=N.index,G=255&U,X=U>>8&255,K=U>>16&255;this.highlightId=[G/255,X/255,K/255,0]}else this.highlightId=[1,1,1,1]},g.update=function(N){if("perspective"in(N=N||{})&&(this.useOrtho=!N.perspective),"orthographic"in N&&(this.useOrtho=!!N.orthographic),"lineWidth"in N&&(this.lineWidth=N.lineWidth),"project"in N)if(Array.isArray(N.project))this.axesProject=N.project;else{var U=!!N.project;this.axesProject=[U,U,U]}if("projectScale"in N)if(Array.isArray(N.projectScale))this.projectScale=N.projectScale.slice();else{var G=+N.projectScale;this.projectScale=[G,G,G]}if(this.projectHasAlpha=!1,"projectOpacity"in N){Array.isArray(N.projectOpacity)?this.projectOpacity=N.projectOpacity.slice():(G=+N.projectOpacity,this.projectOpacity=[G,G,G]);for(var X=0;X<3;++X)this.projectOpacity[X]=n(this.projectOpacity[X]),this.projectOpacity[X]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in N&&(this.opacity=n(N.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var K,Z,H=N.position,Y=N.font||"normal",$=N.alignment||[0,0];if($.length===2)K=$[0],Z=$[1];else for(K=[],Z=[],X=0;X<$.length;++X)K[X]=$[X][0],Z[X]=$[X][1];var z=[1/0,1/0,1/0],j=[-1/0,-1/0,-1/0],W=N.glyph,ee=N.color,J=N.size,Q=N.angle,te=N.lineColor,ie=-1,ae=0,he=0,se=0;if(H.length){se=H.length;e:for(X=0;X<se;++X){for(var de=H[X],ue=0;ue<3;++ue)if(isNaN(de[ue])||!isFinite(de[ue]))continue e;var ve=(Oe=D(W,X,Y,this.pixelRatio)).mesh,ke=Oe.lines,Ee=Oe.bounds;ae+=3*ve.cells.length,he+=2*ke.edges.length}}var be=ae+he,xe=h.mallocFloat(3*be),ce=h.mallocFloat(4*be),ge=h.mallocFloat(2*be),we=h.mallocUint32(be);if(be>0){var Me=0,Se=ae,ze=[0,0,0,1],Fe=[0,0,0,1],Ye=Array.isArray(ee)&&Array.isArray(ee[0]),rt=Array.isArray(te)&&Array.isArray(te[0]);e:for(X=0;X<se;++X){for(ie+=1,de=H[X],ue=0;ue<3;++ue){if(isNaN(de[ue])||!isFinite(de[ue]))continue e;j[ue]=Math.max(j[ue],de[ue]),z[ue]=Math.min(z[ue],de[ue])}ve=(Oe=D(W,X,Y,this.pixelRatio)).mesh,ke=Oe.lines,Ee=Oe.bounds;var Oe,je=Oe.visible;if(je)if(Array.isArray(ee)){if((We=Ye?X<ee.length?ee[X]:[0,0,0,0]:ee).length===3){for(ue=0;ue<3;++ue)ze[ue]=We[ue];ze[3]=1}else if(We.length===4){for(ue=0;ue<4;++ue)ze[ue]=We[ue];!this.hasAlpha&&We[3]<1&&(this.hasAlpha=!0)}}else ze[0]=ze[1]=ze[2]=0,ze[3]=1;else ze=[1,1,1,0];if(je)if(Array.isArray(te)){var We;if((We=rt?X<te.length?te[X]:[0,0,0,0]:te).length===3){for(ue=0;ue<3;++ue)Fe[ue]=We[ue];Fe[ue]=1}else if(We.length===4){for(ue=0;ue<4;++ue)Fe[ue]=We[ue];!this.hasAlpha&&We[3]<1&&(this.hasAlpha=!0)}}else Fe[0]=Fe[1]=Fe[2]=0,Fe[3]=1;else Fe=[1,1,1,0];var qe=.5;je?Array.isArray(J)?qe=X<J.length?+J[X]:12:J?qe=+J:this.useOrtho&&(qe=12):qe=0;var et=0;Array.isArray(Q)?et=X<Q.length?+Q[X]:0:Q&&(et=+Q);var st=Math.cos(et),ct=Math.sin(et);for(de=H[X],ue=0;ue<3;++ue)j[ue]=Math.max(j[ue],de[ue]),z[ue]=Math.min(z[ue],de[ue]);var Pt=K,kt=Z;Pt=0,Array.isArray(K)?Pt=X<K.length?K[X]:0:K&&(Pt=K),kt=0,Array.isArray(Z)?kt=X<Z.length?Z[X]:0:Z&&(kt=Z);var at=[Pt*=Pt>0?1-Ee[0][0]:Pt<0?1+Ee[1][0]:1,kt*=kt>0?1-Ee[0][1]:kt<0?1+Ee[1][1]:1],tt=ve.cells||[],_t=ve.positions||[];for(ue=0;ue<tt.length;++ue)for(var er=tt[ue],tr=0;tr<3;++tr){for(var Ue=0;Ue<3;++Ue)xe[3*Me+Ue]=de[Ue];for(Ue=0;Ue<4;++Ue)ce[4*Me+Ue]=ze[Ue];we[Me]=ie;var He=_t[er[tr]];ge[2*Me]=qe*(st*He[0]-ct*He[1]+at[0]),ge[2*Me+1]=qe*(ct*He[0]+st*He[1]+at[1]),Me+=1}for(tt=ke.edges,_t=ke.positions,ue=0;ue<tt.length;++ue)for(er=tt[ue],tr=0;tr<2;++tr){for(Ue=0;Ue<3;++Ue)xe[3*Se+Ue]=de[Ue];for(Ue=0;Ue<4;++Ue)ce[4*Se+Ue]=Fe[Ue];we[Se]=ie,He=_t[er[tr]],ge[2*Se]=qe*(st*He[0]-ct*He[1]+at[0]),ge[2*Se+1]=qe*(ct*He[0]+st*He[1]+at[1]),Se+=1}}}this.bounds=[z,j],this.points=H,this.pointCount=H.length,this.vertexCount=ae,this.lineVertexCount=he,this.pointBuffer.update(xe),this.colorBuffer.update(ce),this.glyphBuffer.update(ge),this.idBuffer.update(we),h.free(xe),h.free(ce),h.free(ge),h.free(we)},g.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":323,"./lib/glyphs":324,"./lib/shaders":325,"gl-buffer":261,"gl-mat4/multiply":295,"gl-vao":353,"is-string-blank":448,"typedarray-pool":601}],328:[function(r,I,B){var t=r("glslify");B.boxVertex=t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 vertex;

uniform vec2 cornerA, cornerB;

void main() {
  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);
}
`]),B.boxFragment=t([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color;

void main() {
  gl_FragColor = color;
}
`])},{glslify:329}],329:[function(r,I,B){arguments[4][268][0].apply(B,arguments)},{dup:268}],330:[function(r,I,B){var t=r("gl-shader"),d=r("gl-buffer"),m=r("./lib/shaders");function h(f,l,o){this.plot=f,this.boxBuffer=l,this.boxShader=o,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}I.exports=function(f,l){var o=f.gl,u=d(o,[0,0,0,1,1,0,1,1]),s=t(o,m.boxVertex,m.boxFragment),i=new h(f,u,s);return i.update(l),f.addOverlay(i),i};var e=h.prototype;e.draw=function(){if(this.enabled){var f=this.plot,l=this.selectBox,o=this.borderWidth,u=(this.innerFill,this.innerColor),s=(this.outerFill,this.outerColor),i=this.borderColor,c=f.box,n=f.screenBox,a=f.dataBox,g=f.viewBox,p=f.pixelRatio,y=(l[0]-a[0])*(g[2]-g[0])/(a[2]-a[0])+g[0],v=(l[1]-a[1])*(g[3]-g[1])/(a[3]-a[1])+g[1],b=(l[2]-a[0])*(g[2]-g[0])/(a[2]-a[0])+g[0],x=(l[3]-a[1])*(g[3]-g[1])/(a[3]-a[1])+g[1];if(y=Math.max(y,g[0]),v=Math.max(v,g[1]),b=Math.min(b,g[2]),x=Math.min(x,g[3]),!(b<y||x<v)){c.bind();var T=n[2]-n[0],A=n[3]-n[1];if(this.outerFill&&(c.drawBox(0,0,T,v,s),c.drawBox(0,v,y,x,s),c.drawBox(0,x,T,A,s),c.drawBox(b,v,T,x,s)),this.innerFill&&c.drawBox(y,v,b,x,u),o>0){var S=o*p;c.drawBox(y-S,v-S,b+S,v+S,i),c.drawBox(y-S,x-S,b+S,x+S,i),c.drawBox(y-S,v-S,y+S,x+S,i),c.drawBox(b-S,v-S,b+S,x+S,i)}}}},e.update=function(f){f=f||{},this.innerFill=!!f.innerFill,this.outerFill=!!f.outerFill,this.innerColor=(f.innerColor||[0,0,0,.5]).slice(),this.outerColor=(f.outerColor||[0,0,0,.5]).slice(),this.borderColor=(f.borderColor||[0,0,0,1]).slice(),this.borderWidth=f.borderWidth||0,this.selectBox=(f.selectBox||this.selectBox).slice()},e.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":328,"gl-buffer":261,"gl-shader":332}],331:[function(r,I,B){I.exports=function(o,u){var s=u[0],i=u[1],c=t(o,s,i,{}),n=d.mallocUint8(s*i*4);return new f(o,c,n)};var t=r("gl-fbo"),d=r("typedarray-pool"),m=r("ndarray"),h=r("bit-twiddle").nextPow2;function e(o,u,s,i,c){this.coord=[o,u],this.id=s,this.value=i,this.distance=c}function f(o,u,s){this.gl=o,this.fbo=u,this.buffer=s,this._readTimeout=null;var i=this;this._readCallback=function(){i.gl&&(u.bind(),o.readPixels(0,0,u.shape[0],u.shape[1],o.RGBA,o.UNSIGNED_BYTE,i.buffer),i._readTimeout=null)}}var l=f.prototype;Object.defineProperty(l,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(o){if(this.gl){this.fbo.shape=o;var u=this.fbo.shape[0],s=this.fbo.shape[1];if(s*u*4>this.buffer.length){d.free(this.buffer);for(var i=this.buffer=d.mallocUint8(h(s*u*4)),c=0;c<s*u*4;++c)i[c]=255}return o}}}),l.begin=function(){var o=this.gl;this.shape,o&&(this.fbo.bind(),o.clearColor(1,1,1,1),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT))},l.end=function(){var o=this.gl;o&&(o.bindFramebuffer(o.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},l.query=function(o,u,s){if(!this.gl)return null;var i=this.fbo.shape.slice();o|=0,u|=0,typeof s!="number"&&(s=1);var c=0|Math.min(Math.max(o-s,0),i[0]),n=0|Math.min(Math.max(o+s,0),i[0]),a=0|Math.min(Math.max(u-s,0),i[1]),g=0|Math.min(Math.max(u+s,0),i[1]);if(n<=c||g<=a)return null;var p=[n-c,g-a],y=m(this.buffer,[p[0],p[1],4],[4,4*i[0],1],4*(c+i[0]*a)),v=function(T,A,S){for(var w=1e8,E=-1,k=-1,L=T.shape[0],M=T.shape[1],P=0;P<L;P++)for(var D=0;D<M;D++){var N=T.get(P,D,0),U=T.get(P,D,1),G=T.get(P,D,2),X=T.get(P,D,3);if(N<255||U<255||G<255||X<255){var K=A-P,Z=S-D,H=K*K+Z*Z;H<w&&(w=H,E=P,k=D)}}return[E,k,w]}(y.hi(p[0],p[1],1),s,s),b=v[0],x=v[1];return b<0||Math.pow(this.radius,2)<v[2]?null:new e(b+c|0,x+a|0,y.get(b,x,0),[y.get(b,x,1),y.get(b,x,2),y.get(b,x,3)],Math.sqrt(v[2]))},l.dispose=function(){this.gl&&(this.fbo.dispose(),d.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":104,"gl-fbo":270,ndarray:472,"typedarray-pool":601}],332:[function(r,I,B){var t=r("./lib/create-uniforms"),d=r("./lib/create-attributes"),m=r("./lib/reflect"),h=r("./lib/shader-cache"),e=r("./lib/runtime-reflect"),f=r("./lib/GLError");function l(s){this.gl=s,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var o=l.prototype;function u(s,i){return s.name<i.name?-1:1}o.bind=function(){var s;this.program||this._relink();var i=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),c=this.gl.lastAttribCount;if(i>c)for(s=c;s<i;s++)this.gl.enableVertexAttribArray(s);else if(c>i)for(s=i;s<c;s++)this.gl.disableVertexAttribArray(s);this.gl.lastAttribCount=i,this.gl.useProgram(this.program)},o.dispose=function(){for(var s=this.gl.lastAttribCount,i=0;i<s;i++)this.gl.disableVertexAttribArray(i);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},o.update=function(s,i,c,n){if(!i||arguments.length===1){var a=s;s=a.vertex,i=a.fragment,c=a.uniforms,n=a.attributes}var g=this,p=g.gl,y=g._vref;g._vref=h.shader(p,p.VERTEX_SHADER,s),y&&y.dispose(),g.vertShader=g._vref.shader;var v=this._fref;if(g._fref=h.shader(p,p.FRAGMENT_SHADER,i),v&&v.dispose(),g.fragShader=g._fref.shader,!c||!n){var b=p.createProgram();if(p.attachShader(b,g.fragShader),p.attachShader(b,g.vertShader),p.linkProgram(b),!p.getProgramParameter(b,p.LINK_STATUS)){var x=p.getProgramInfoLog(b);throw new f(x,"Error linking program:"+x)}c=c||e.uniforms(p,b),n=n||e.attributes(p,b),p.deleteProgram(b)}(n=n.slice()).sort(u);var T,A=[],S=[],w=[];for(T=0;T<n.length;++T){var E=n[T];if(E.type.indexOf("mat")>=0){for(var k=0|E.type.charAt(E.type.length-1),L=new Array(k),M=0;M<k;++M)L[M]=w.length,S.push(E.name+"["+M+"]"),typeof E.location=="number"?w.push(E.location+M):Array.isArray(E.location)&&E.location.length===k&&typeof E.location[M]=="number"?w.push(0|E.location[M]):w.push(-1);A.push({name:E.name,type:E.type,locations:L})}else A.push({name:E.name,type:E.type,locations:[w.length]}),S.push(E.name),typeof E.location=="number"?w.push(0|E.location):w.push(-1)}var P=0;for(T=0;T<w.length;++T)if(w[T]<0){for(;w.indexOf(P)>=0;)P+=1;w[T]=P}var D=new Array(c.length);function N(){g.program=h.program(p,g._vref,g._fref,S,w);for(var U=0;U<c.length;++U)D[U]=p.getUniformLocation(g.program,c[U].name)}N(),g._relink=N,g.types={uniforms:m(c),attributes:m(n)},g.attributes=d(p,g,A,w),Object.defineProperty(g,"uniforms",t(p,g,c,D))},I.exports=function(s,i,c,n,a){var g=new l(s);return g.update(i,c,n,a),g}},{"./lib/GLError":333,"./lib/create-attributes":334,"./lib/create-uniforms":335,"./lib/reflect":336,"./lib/runtime-reflect":337,"./lib/shader-cache":338}],333:[function(r,I,B){function t(d,m,h){this.shortMessage=m||"",this.longMessage=h||"",this.rawError=d||"",this.message="gl-shader: "+(m||d||"")+(h?`
`+h:""),this.stack=new Error().stack}t.prototype=new Error,t.prototype.name="GLError",t.prototype.constructor=t,I.exports=t},{}],334:[function(r,I,B){I.exports=function(l,o,u,s){for(var i={},c=0,n=u.length;c<n;++c){var a=u[c],g=a.name,p=a.type,y=a.locations;switch(p){case"bool":case"int":case"float":e(l,o,y[0],s,1,i,g);break;default:if(p.indexOf("vec")>=0){if((v=p.charCodeAt(p.length-1)-48)<2||v>4)throw new t("","Invalid data type for attribute "+g+": "+p);e(l,o,y[0],s,v,i,g)}else{if(!(p.indexOf("mat")>=0))throw new t("","Unknown data type for attribute "+g+": "+p);var v;if((v=p.charCodeAt(p.length-1)-48)<2||v>4)throw new t("","Invalid data type for attribute "+g+": "+p);f(l,o,y,s,v,i,g)}}}return i};var t=r("./GLError");function d(l,o,u,s,i,c){this._gl=l,this._wrapper=o,this._index=u,this._locations=s,this._dimension=i,this._constFunc=c}var m=d.prototype;m.pointer=function(l,o,u,s){var i=this._gl,c=this._locations[this._index];i.vertexAttribPointer(c,this._dimension,l||i.FLOAT,!!o,u||0,s||0),i.enableVertexAttribArray(c)},m.set=function(l,o,u,s){return this._constFunc(this._locations[this._index],l,o,u,s)},Object.defineProperty(m,"location",{get:function(){return this._locations[this._index]},set:function(l){return l!==this._locations[this._index]&&(this._locations[this._index]=0|l,this._wrapper.program=null),0|l}});var h=[function(l,o,u){return u.length===void 0?l.vertexAttrib1f(o,u):l.vertexAttrib1fv(o,u)},function(l,o,u,s){return u.length===void 0?l.vertexAttrib2f(o,u,s):l.vertexAttrib2fv(o,u)},function(l,o,u,s,i){return u.length===void 0?l.vertexAttrib3f(o,u,s,i):l.vertexAttrib3fv(o,u)},function(l,o,u,s,i,c){return u.length===void 0?l.vertexAttrib4f(o,u,s,i,c):l.vertexAttrib4fv(o,u)}];function e(l,o,u,s,i,c,n){var a=h[i],g=new d(l,o,u,s,i,a);Object.defineProperty(c,n,{set:function(p){return l.disableVertexAttribArray(s[u]),a(l,s[u],p),p},get:function(){return g},enumerable:!0})}function f(l,o,u,s,i,c,n){for(var a=new Array(i),g=new Array(i),p=0;p<i;++p)e(l,o,u[p],s,i,a,p),g[p]=a[p];Object.defineProperty(a,"location",{set:function(b){if(Array.isArray(b))for(var x=0;x<i;++x)g[x].location=b[x];else for(x=0;x<i;++x)g[x].location=b+x;return b},get:function(){for(var b=new Array(i),x=0;x<i;++x)b[x]=s[u[x]];return b},enumerable:!0}),a.pointer=function(b,x,T,A){b=b||l.FLOAT,x=!!x,T=T||i*i,A=A||0;for(var S=0;S<i;++S){var w=s[u[S]];l.vertexAttribPointer(w,i,b,x,T,A+S*i),l.enableVertexAttribArray(w)}};var y=new Array(i),v=l["vertexAttrib"+i+"fv"];Object.defineProperty(c,n,{set:function(b){for(var x=0;x<i;++x){var T=s[u[x]];if(l.disableVertexAttribArray(T),Array.isArray(b[0]))v.call(l,T,b[x]);else{for(var A=0;A<i;++A)y[A]=b[i*x+A];v.call(l,T,y)}}return b},get:function(){return a},enumerable:!0})}},{"./GLError":333}],335:[function(r,I,B){var t=r("./reflect"),d=r("./GLError");function m(e){return function(){return e}}function h(e,f){for(var l=new Array(e),o=0;o<e;++o)l[o]=f;return l}I.exports=function(e,f,l,o){function u(n){return function(a){for(var g=function M(P,D){if(typeof D!="object")return[[P,D]];var N=[];for(var U in D){var G=D[U],X=P;parseInt(U)+""===U?X+="["+U+"]":X+="."+U,typeof G=="object"?N.push.apply(N,M(X,G)):N.push([X,G])}return N}("",n),p=0;p<g.length;++p){var y=g[p],v=y[0],b=y[1];if(o[b]){var x=a;if(typeof v=="string"&&(v.indexOf(".")===0||v.indexOf("[")===0)){var T=v;if(v.indexOf(".")===0&&(T=v.slice(1)),T.indexOf("]")===T.length-1){var A=T.indexOf("["),S=T.slice(0,A),w=T.slice(A+1,T.length-1);x=S?a[S][w]:a[w]}else x=a[T]}var E,k=l[b].type;switch(k){case"bool":case"int":case"sampler2D":case"samplerCube":e.uniform1i(o[b],x);break;case"float":e.uniform1f(o[b],x);break;default:var L=k.indexOf("vec");if(!(0<=L&&L<=1&&k.length===4+L)){if(k.indexOf("mat")===0&&k.length===4){if((E=k.charCodeAt(k.length-1)-48)<2||E>4)throw new d("","Invalid uniform dimension type for matrix "+name+": "+k);e["uniformMatrix"+E+"fv"](o[b],!1,x);break}throw new d("","Unknown uniform data type for "+name+": "+k)}if((E=k.charCodeAt(k.length-1)-48)<2||E>4)throw new d("","Invalid data type");switch(k.charAt(0)){case"b":case"i":e["uniform"+E+"iv"](o[b],x);break;case"v":e["uniform"+E+"fv"](o[b],x);break;default:throw new d("","Unrecognized data type for vector "+name+": "+k)}}}}}}function s(n,a,g){if(typeof g=="object"){var p=i(g);Object.defineProperty(n,a,{get:m(p),set:u(g),enumerable:!0,configurable:!1})}else o[g]?Object.defineProperty(n,a,{get:(y=g,function(v,b,x){return v.getUniform(b.program,x[y])}),set:u(g),enumerable:!0,configurable:!1}):n[a]=function(v){switch(v){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":case"float":return 0;default:var b=v.indexOf("vec");if(0<=b&&b<=1&&v.length===4+b){if((x=v.charCodeAt(v.length-1)-48)<2||x>4)throw new d("","Invalid data type");return v.charAt(0)==="b"?h(x,!1):h(x,0)}if(v.indexOf("mat")===0&&v.length===4){var x;if((x=v.charCodeAt(v.length-1)-48)<2||x>4)throw new d("","Invalid uniform dimension type for matrix "+name+": "+v);return h(x*x,0)}throw new d("","Unknown uniform data type for "+name+": "+v)}}(l[g].type);var y}function i(n){var a;if(Array.isArray(n)){a=new Array(n.length);for(var g=0;g<n.length;++g)s(a,g,n[g])}else for(var p in a={},n)s(a,p,n[p]);return a}var c=t(l,!0);return{get:m(i(c)),set:u(c),enumerable:!0,configurable:!0}}},{"./GLError":333,"./reflect":336}],336:[function(r,I,B){I.exports=function(t,d){for(var m={},h=0;h<t.length;++h)for(var e=t[h].name.split("."),f=m,l=0;l<e.length;++l){var o=e[l].split("[");if(o.length>1){o[0]in f||(f[o[0]]=[]),f=f[o[0]];for(var u=1;u<o.length;++u){var s=parseInt(o[u]);u<o.length-1||l<e.length-1?(s in f||(u<o.length-1?f[s]=[]:f[s]={}),f=f[s]):f[s]=d?h:t[h].type}}else l<e.length-1?(o[0]in f||(f[o[0]]={}),f=f[o[0]]):f[o[0]]=d?h:t[h].type}return m}},{}],337:[function(r,I,B){B.uniforms=function(h,e){for(var f=h.getProgramParameter(e,h.ACTIVE_UNIFORMS),l=[],o=0;o<f;++o){var u=h.getActiveUniform(e,o);if(u){var s=m(h,u.type);if(u.size>1)for(var i=0;i<u.size;++i)l.push({name:u.name.replace("[0]","["+i+"]"),type:s});else l.push({name:u.name,type:s})}}return l},B.attributes=function(h,e){for(var f=h.getProgramParameter(e,h.ACTIVE_ATTRIBUTES),l=[],o=0;o<f;++o){var u=h.getActiveAttrib(e,o);u&&l.push({name:u.name,type:m(h,u.type)})}return l};var t={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},d=null;function m(h,e){if(!d){var f=Object.keys(t);d={};for(var l=0;l<f.length;++l){var o=f[l];d[h[o]]=t[o]}}return d[e]}},{}],338:[function(r,I,B){B.shader=function(u,s,i){return o(u).getShaderReference(s,i)},B.program=function(u,s,i,c,n){return o(u).getProgram(s,i,c,n)};var t=r("./GLError"),d=r("gl-format-compiler-error"),m=new(typeof WeakMap=="undefined"?r("weakmap-shim"):WeakMap),h=0;function e(u,s,i,c,n,a,g){this.id=u,this.src=s,this.type=i,this.shader=c,this.count=a,this.programs=[],this.cache=g}function f(u){this.gl=u,this.shaders=[{},{}],this.programs={}}e.prototype.dispose=function(){if(--this.count==0){for(var u=this.cache,s=u.gl,i=this.programs,c=0,n=i.length;c<n;++c){var a=u.programs[i[c]];a&&(delete u.programs[c],s.deleteProgram(a))}s.deleteShader(this.shader),delete u.shaders[this.type===s.FRAGMENT_SHADER|0][this.src]}};var l=f.prototype;function o(u){var s=m.get(u);return s||(s=new f(u),m.set(u,s)),s}l.getShaderReference=function(u,s){var i=this.gl,c=this.shaders[u===i.FRAGMENT_SHADER|0],n=c[s];if(n&&i.isShader(n.shader))n.count+=1;else{var a=function(g,p,y){var v=g.createShader(p);if(g.shaderSource(v,y),g.compileShader(v),!g.getShaderParameter(v,g.COMPILE_STATUS)){var b=g.getShaderInfoLog(v);try{var x=d(b,y,p)}catch(T){throw console.warn("Failed to format compiler error: "+T),new t(b,`Error compiling shader:
`+b)}throw new t(b,x.short,x.long)}return v}(i,u,s);n=c[s]=new e(h++,s,u,a,[],1,this)}return n},l.getProgram=function(u,s,i,c){var n=[u.id,s.id,i.join(":"),c.join(":")].join("@"),a=this.programs[n];return a&&this.gl.isProgram(a)||(this.programs[n]=a=function(g,p,y,v,b){var x=g.createProgram();g.attachShader(x,p),g.attachShader(x,y);for(var T=0;T<v.length;++T)g.bindAttribLocation(x,b[T],v[T]);if(g.linkProgram(x),!g.getProgramParameter(x,g.LINK_STATUS)){var A=g.getProgramInfoLog(x);throw new t(A,"Error linking program: "+A)}return x}(this.gl,u.shader,s.shader,i,c),u.programs.push(n),s.programs.push(n)),a}},{"./GLError":333,"gl-format-compiler-error":271,"weakmap-shim":612}],339:[function(r,I,B){function t(m){this.plot=m,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}I.exports=function(m,h){var e=new t(m);return e.update(h),m.addOverlay(e),e};var d=t.prototype;d.update=function(m){m=m||{},this.enable=(m.enable||[!0,!0,!1,!1]).slice(),this.width=(m.width||[1,1,1,1]).slice(),this.color=(m.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(h){return h.slice()}),this.center=(m.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},d.draw=function(){var m=this.enable,h=this.width,e=this.color,f=this.center,l=this.plot,o=l.line,u=l.dataBox,s=l.viewBox;if(o.bind(),u[0]<=f[0]&&f[0]<=u[2]&&u[1]<=f[1]&&f[1]<=u[3]){var i=s[0]+(f[0]-u[0])/(u[2]-u[0])*(s[2]-s[0]),c=s[1]+(f[1]-u[1])/(u[3]-u[1])*(s[3]-s[1]);m[0]&&o.drawLine(i,c,s[0],c,h[0],e[0]),m[1]&&o.drawLine(i,c,i,s[1],h[1],e[1]),m[2]&&o.drawLine(i,c,s[2],c,h[2],e[2]),m[3]&&o.drawLine(i,c,i,s[3],h[3],e[3])}},d.dispose=function(){this.plot.removeOverlay(this)}},{}],340:[function(r,I,B){var t=r("glslify"),d=r("gl-shader"),m=t([`precision mediump float;
#define GLSLIFY 1

attribute vec3 position, color;
attribute float weight;

uniform mat4 model, view, projection;
uniform vec3 coordinates[3];
uniform vec4 colors[3];
uniform vec2 screenShape;
uniform float lineWidth;

varying vec4 fragColor;

void main() {
  vec3 vertexPosition = mix(coordinates[0],
    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));

  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);
  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;
  vec2 delta = weight * clipOffset * screenShape;
  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;

  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);
  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];
}
`]),h=t([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
  gl_FragColor = fragColor;
}`]);I.exports=function(e){return d(e,m,h,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":332,glslify:434}],341:[function(r,I,B){var t=r("gl-buffer"),d=r("gl-vao"),m=r("./shaders/index");I.exports=function(s,i){var c=[];function n(v,b,x,T,A,S){var w=[v,b,x,0,0,0,1];w[T+3]=1,w[T]=A,c.push.apply(c,w),w[6]=-1,c.push.apply(c,w),w[T]=S,c.push.apply(c,w),c.push.apply(c,w),w[6]=1,c.push.apply(c,w),w[T]=A,c.push.apply(c,w)}n(0,0,0,0,0,1),n(0,0,0,1,0,1),n(0,0,0,2,0,1),n(1,0,0,1,-1,1),n(1,0,0,2,-1,1),n(0,1,0,0,-1,1),n(0,1,0,2,-1,1),n(0,0,1,0,-1,1),n(0,0,1,1,-1,1);var a=t(s,c),g=d(s,[{type:s.FLOAT,buffer:a,size:3,offset:0,stride:28},{type:s.FLOAT,buffer:a,size:3,offset:12,stride:28},{type:s.FLOAT,buffer:a,size:1,offset:24,stride:28}]),p=m(s);p.attributes.position.location=0,p.attributes.color.location=1,p.attributes.weight.location=2;var y=new e(s,a,g,p);return y.update(i),y};var h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(s,i,c,n){this.gl=s,this.buffer=i,this.vao=c,this.shader=n,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var f=e.prototype,l=[0,0,0],o=[0,0,0],u=[0,0];f.isTransparent=function(){return!1},f.drawTransparent=function(s){},f.draw=function(s){var i=this.gl,c=this.vao,n=this.shader;c.bind(),n.bind();var a,g=s.model||h,p=s.view||h,y=s.projection||h;this.axes&&(a=this.axes.lastCubeProps.axis);for(var v=l,b=o,x=0;x<3;++x)a&&a[x]<0?(v[x]=this.bounds[0][x],b[x]=this.bounds[1][x]):(v[x]=this.bounds[1][x],b[x]=this.bounds[0][x]);for(u[0]=i.drawingBufferWidth,u[1]=i.drawingBufferHeight,n.uniforms.model=g,n.uniforms.view=p,n.uniforms.projection=y,n.uniforms.coordinates=[this.position,v,b],n.uniforms.colors=this.colors,n.uniforms.screenShape=u,x=0;x<3;++x)n.uniforms.lineWidth=this.lineWidth[x]*this.pixelRatio,this.enabled[x]&&(c.draw(i.TRIANGLES,6,6*x),this.drawSides[x]&&c.draw(i.TRIANGLES,12,18+12*x));c.unbind()},f.update=function(s){s&&("bounds"in s&&(this.bounds=s.bounds),"position"in s&&(this.position=s.position),"lineWidth"in s&&(this.lineWidth=s.lineWidth),"colors"in s&&(this.colors=s.colors),"enabled"in s&&(this.enabled=s.enabled),"drawSides"in s&&(this.drawSides=s.drawSides))},f.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":340,"gl-buffer":261,"gl-vao":353}],342:[function(r,I,B){var t=r("glslify"),d=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, tubeScale;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * tubePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(tubePosition, 1.0);
  vec4 t_position  = view * tubePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = tubePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),m=t([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),h=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float tubeScale;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  gl_Position = projection * view * tubePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),e=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);B.meshShader={vertex:d,fragment:m,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},B.pickShader={vertex:h,fragment:e,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:343}],343:[function(r,I,B){arguments[4][268][0].apply(B,arguments)},{dup:268}],344:[function(r,I,B){var t=r("gl-vec3"),d=r("gl-vec4"),m=["xyz","xzy","yxz","yzx","zxy","zyx"],h=function(s,i,c,n){for(var a=0,g=0;g<s.length;g++)for(var p=s[g].velocities,y=0;y<p.length;y++)a=Math.max(a,t.length(p[y]));var v=s.map(function(M){return function(P,D,N,U){for(var G=P.points,X=P.velocities,K=P.divergences,Z=[],H=[],Y=[],$=[],z=[],j=[],W=0,ee=0,J=d.create(),Q=d.create(),te=0;te<G.length;te++){var ie=G[te],ae=X[te],he=K[te];D===0&&(he=.05*N),ee=t.length(ae)/U,J=d.create(),t.copy(J,ae),J[3]=he;for(var se=0;se<8;se++)z[se]=[ie[0],ie[1],ie[2],se];if($.length>0)for(se=0;se<8;se++){var de=(se+1)%8;Z.push($[se],z[se],z[de],z[de],$[de],$[se]),Y.push(Q,J,J,J,Q,Q),j.push(W,ee,ee,ee,W,W);var ue=Z.length;H.push([ue-6,ue-5,ue-4],[ue-3,ue-2,ue-1])}var ve=$;$=z,z=ve;var ke=Q;Q=J,J=ke;var Ee=W;W=ee,ee=Ee}return{positions:Z,cells:H,vectors:Y,vertexIntensity:j}}(M,c,n,a)}),b=[],x=[],T=[],A=[];for(g=0;g<v.length;g++){var S=v[g],w=b.length;for(b=b.concat(S.positions),T=T.concat(S.vectors),A=A.concat(S.vertexIntensity),y=0;y<S.cells.length;y++){var E=S.cells[y],k=[];x.push(k);for(var L=0;L<E.length;L++)k.push(E[L]+w)}}return{positions:b,cells:x,vectors:T,vertexIntensity:A,colormap:i}},e=function(s,i){var c,n=s.length;for(c=0;c<n;c++){var a=s[c];if(a===i)return c;if(a>i)return c-1}return c},f=function(s,i,c){return s<i?i:s>c?c:s},l=function(s){var i=1/0;s.sort(function(g,p){return g-p});for(var c=s.length,n=1;n<c;n++){var a=Math.abs(s[n]-s[n-1]);a<i&&(i=a)}return i};I.exports=function(s,i){var c=s.startingPositions,n=s.maxLength||1e3,a=s.tubeSize||1,g=s.absoluteTubeSize,p=s.gridFill||"+x+y+z",y={};p.indexOf("-x")!==-1&&(y.reversedX=!0),p.indexOf("-y")!==-1&&(y.reversedY=!0),p.indexOf("-z")!==-1&&(y.reversedZ=!0),y.filled=m.indexOf(p.replace(/-/g,"").replace(/\+/g,""));var v=s.getVelocity||function(te){return function(ie,ae,he){var se=ae.vectors,de=ae.meshgrid,ue=ie[0],ve=ie[1],ke=ie[2],Ee=de[0].length,be=de[1].length,xe=de[2].length,ce=e(de[0],ue),ge=e(de[1],ve),we=e(de[2],ke),Me=ce+1,Se=ge+1,ze=we+1;if(ce=f(ce,0,Ee-1),Me=f(Me,0,Ee-1),ge=f(ge,0,be-1),Se=f(Se,0,be-1),we=f(we,0,xe-1),ze=f(ze,0,xe-1),ce<0||ge<0||we<0||Me>Ee-1||Se>be-1||ze>xe-1)return t.create();var Fe,Ye,rt,Oe,je,We,qe=de[0][ce],et=de[0][Me],st=de[1][ge],ct=de[1][Se],Pt=de[2][we],kt=(ue-qe)/(et-qe),at=(ve-st)/(ct-st),tt=(ke-Pt)/(de[2][ze]-Pt);switch(isFinite(kt)||(kt=.5),isFinite(at)||(at=.5),isFinite(tt)||(tt=.5),he.reversedX&&(ce=Ee-1-ce,Me=Ee-1-Me),he.reversedY&&(ge=be-1-ge,Se=be-1-Se),he.reversedZ&&(we=xe-1-we,ze=xe-1-ze),he.filled){case 5:je=we,We=ze,rt=ge*xe,Oe=Se*xe,Fe=ce*xe*be,Ye=Me*xe*be;break;case 4:je=we,We=ze,Fe=ce*xe,Ye=Me*xe,rt=ge*xe*Ee,Oe=Se*xe*Ee;break;case 3:rt=ge,Oe=Se,je=we*be,We=ze*be,Fe=ce*be*xe,Ye=Me*be*xe;break;case 2:rt=ge,Oe=Se,Fe=ce*be,Ye=Me*be,je=we*be*Ee,We=ze*be*Ee;break;case 1:Fe=ce,Ye=Me,je=we*Ee,We=ze*Ee,rt=ge*Ee*xe,Oe=Se*Ee*xe;break;default:Fe=ce,Ye=Me,rt=ge*Ee,Oe=Se*Ee,je=we*Ee*be,We=ze*Ee*be}var _t=se[Fe+rt+je],er=se[Fe+rt+We],tr=se[Fe+Oe+je],Ue=se[Fe+Oe+We],He=se[Ye+rt+je],Be=se[Ye+rt+We],Ke=se[Ye+Oe+je],_e=se[Ye+Oe+We],Ce=t.create(),Le=t.create(),Pe=t.create(),Xe=t.create();t.lerp(Ce,_t,He,kt),t.lerp(Le,er,Be,kt),t.lerp(Pe,tr,Ke,kt),t.lerp(Xe,Ue,_e,kt);var ht=t.create(),Mt=t.create();t.lerp(ht,Ce,Pe,at),t.lerp(Mt,Le,Xe,at);var pt=t.create();return t.lerp(pt,ht,Mt,tt),pt}(te,s,y)},b=s.getDivergence||function(te,ie){var ae=t.create(),he=1e-4;t.add(ae,te,[he,0,0]);var se=v(ae);t.subtract(se,se,ie),t.scale(se,se,1/he),t.add(ae,te,[0,he,0]);var de=v(ae);t.subtract(de,de,ie),t.scale(de,de,1/he),t.add(ae,te,[0,0,he]);var ue=v(ae);return t.subtract(ue,ue,ie),t.scale(ue,ue,1/he),t.add(ae,se,de),t.add(ae,ae,ue),ae},x=[],T=i[0][0],A=i[0][1],S=i[0][2],w=i[1][0],E=i[1][1],k=i[1][2],L=function(te){var ie=te[0],ae=te[1],he=te[2];return!(ie<T||ie>w||ae<A||ae>E||he<S||he>k)},M=10*t.distance(i[0],i[1])/n,P=M*M,D=1,N=0,U=c.length;U>1&&(D=function(te){for(var ie=[],ae=[],he=[],se={},de={},ue={},ve=te.length,ke=0;ke<ve;ke++){var Ee=te[ke],be=Ee[0],xe=Ee[1],ce=Ee[2];se[be]||(ie.push(be),se[be]=!0),de[xe]||(ae.push(xe),de[xe]=!0),ue[ce]||(he.push(ce),ue[ce]=!0)}var ge=l(ie),we=l(ae),Me=l(he),Se=Math.min(ge,we,Me);return isFinite(Se)?Se:1}(c));for(var G=0;G<U;G++){var X=t.create();t.copy(X,c[G]);var K=[X],Z=[],H=v(X),Y=X;Z.push(H);var $=[],z=b(X,H),j=t.length(z);isFinite(j)&&j>N&&(N=j),$.push(j),x.push({points:K,velocities:Z,divergences:$});for(var W=0;W<100*n&&K.length<n&&L(X);){W++;var ee=t.clone(H),J=t.squaredLength(ee);if(J===0)break;J>P&&t.scale(ee,ee,M/Math.sqrt(J)),t.add(ee,ee,X),H=v(ee),t.squaredDistance(Y,ee)-P>-1e-4*P&&(K.push(ee),Y=ee,Z.push(H),z=b(ee,H),j=t.length(z),isFinite(j)&&j>N&&(N=j),$.push(j)),X=ee}}var Q=h(x,s.colormap,N,D);return g?Q.tubeScale=g:(N===0&&(N=1),Q.tubeScale=.5*a*D/N),Q};var o=r("./lib/shaders"),u=r("gl-cone3d").createMesh;I.exports.createTubeMesh=function(s,i){return u(s,i,{shaders:o,traceType:"streamtube"})}},{"./lib/shaders":342,"gl-cone3d":262,"gl-vec3":372,"gl-vec4":408}],345:[function(r,I,B){var t=r("gl-shader"),d=r("glslify"),m=d([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute vec3 f;
attribute vec3 normal;

uniform vec3 objectOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 lightPosition, eyePosition;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 localCoordinate = vec3(uv.zw, f.x);
  worldCoordinate = objectOffset + localCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);
  vec4 clipPosition = projection * view * worldPosition;
  gl_Position = clipPosition;
  kill = f.y;
  value = f.z;
  planeCoordinate = uv.xy;

  vColor = texture2D(colormap, vec2(value, value));

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * worldPosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  lightDirection = lightPosition - cameraCoordinate.xyz;
  eyeDirection   = eyePosition - cameraCoordinate.xyz;
  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);
}
`]),h=d([`precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float beckmannSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness) {
  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 lowerBound, upperBound;
uniform float contourTint;
uniform vec4 contourColor;
uniform sampler2D colormap;
uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform float vertexColor;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  if (
    kill > 0.0 ||
    vColor.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)
  ) discard;

  vec3 N = normalize(surfaceNormal);
  vec3 V = normalize(eyeDirection);
  vec3 L = normalize(lightDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  //decide how to interpolate color \u2014 in vertex or in fragment
  vec4 surfaceColor =
    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +
    step(.5, vertexColor) * vColor;

  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;
}
`]),e=d([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute float f;

uniform vec3 objectOffset;
uniform mat3 permutation;
uniform mat4 model, view, projection;
uniform float height, zOffset;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 dataCoordinate = permutation * vec3(uv.xy, height);
  worldCoordinate = objectOffset + dataCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);

  vec4 clipPosition = projection * view * worldPosition;
  clipPosition.z += zOffset;

  gl_Position = clipPosition;
  value = f + objectOffset.z;
  kill = -1.0;
  planeCoordinate = uv.zw;

  vColor = texture2D(colormap, vec2(value, value));

  //Don't do lighting for contours
  surfaceNormal   = vec3(1,0,0);
  eyeDirection    = vec3(0,1,0);
  lightDirection  = vec3(0,0,1);
}
`]),f=d([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec2 shape;
uniform vec3 clipBounds[2];
uniform float pickId;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 surfaceNormal;

vec2 splitFloat(float v) {
  float vh = 255.0 * v;
  float upper = floor(vh);
  float lower = fract(vh);
  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);
}

void main() {
  if ((kill > 0.0) ||
      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;

  vec2 ux = splitFloat(planeCoordinate.x / shape.x);
  vec2 uy = splitFloat(planeCoordinate.y / shape.y);
  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));
}
`]);B.createShader=function(l){var o=t(l,m,h,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return o.attributes.uv.location=0,o.attributes.f.location=1,o.attributes.normal.location=2,o},B.createPickShader=function(l){var o=t(l,m,f,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return o.attributes.uv.location=0,o.attributes.f.location=1,o.attributes.normal.location=2,o},B.createContourShader=function(l){var o=t(l,e,h,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return o.attributes.uv.location=0,o.attributes.f.location=1,o},B.createPickContourShader=function(l){var o=t(l,e,f,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return o.attributes.uv.location=0,o.attributes.f.location=1,o}},{"gl-shader":332,glslify:434}],346:[function(r,I,B){I.exports=function(H){var Y=H.gl,$=p(Y),z=v(Y),j=y(Y),W=b(Y),ee=d(Y),J=m(Y,[{buffer:ee,size:4,stride:40,offset:0},{buffer:ee,size:3,stride:40,offset:16},{buffer:ee,size:3,stride:40,offset:28}]),Q=d(Y),te=m(Y,[{buffer:Q,size:4,stride:20,offset:0},{buffer:Q,size:1,stride:20,offset:16}]),ie=d(Y),ae=m(Y,[{buffer:ie,size:2,type:Y.FLOAT}]),he=h(Y,1,256,Y.RGBA,Y.UNSIGNED_BYTE);he.minFilter=Y.LINEAR,he.magFilter=Y.LINEAR;var se=new w(Y,[0,0],[[0,0,0],[0,0,0]],$,z,ee,J,he,j,W,Q,te,ie,ae,[0,0,0]),de={levels:[[],[],[]]};for(var ue in H)de[ue]=H[ue];return de.colormap=de.colormap||"jet",se.update(de),se};var t=r("bit-twiddle"),d=r("gl-buffer"),m=r("gl-vao"),h=r("gl-texture2d"),e=r("typedarray-pool"),f=r("colormap"),l=r("ndarray-ops"),o=r("ndarray-pack"),u=r("ndarray"),s=r("surface-nets"),i=r("gl-mat4/multiply"),c=r("gl-mat4/invert"),n=r("binary-search-bounds"),a=r("ndarray-gradient"),g=r("./lib/shaders"),p=g.createShader,y=g.createContourShader,v=g.createPickShader,b=g.createPickContourShader,x=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],T=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],A=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function S(H,Y,$,z,j){this.position=H,this.index=Y,this.uv=$,this.level=z,this.dataCoordinate=j}(function(){for(var H=0;H<3;++H){var Y=A[H],$=(H+2)%3;Y[(H+1)%3+0]=1,Y[$+3]=1,Y[H+6]=1}})();function w(H,Y,$,z,j,W,ee,J,Q,te,ie,ae,he,se,de){this.gl=H,this.shape=Y,this.bounds=$,this.objectOffset=de,this.intensityBounds=[],this._shader=z,this._pickShader=j,this._coordinateBuffer=W,this._vao=ee,this._colorMap=J,this._contourShader=Q,this._contourPickShader=te,this._contourBuffer=ie,this._contourVAO=ae,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new S([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=he,this._dynamicVAO=se,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[u(e.mallocFloat(1024),[0,0]),u(e.mallocFloat(1024),[0,0]),u(e.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var E=w.prototype;E.genColormap=function(H,Y){var $=!1,z=o([f({colormap:H,nshades:256,format:"rgba"}).map(function(j,W){var ee=Y?function(J,Q){if(!Q||!Q.length)return 1;for(var te=0;te<Q.length;++te){if(Q.length<2)return 1;if(Q[te][0]===J)return Q[te][1];if(Q[te][0]>J&&te>0){var ie=(Q[te][0]-J)/(Q[te][0]-Q[te-1][0]);return Q[te][1]*(1-ie)+ie*Q[te-1][1]}}return 1}(W/255,Y):j[3];return ee<1&&($=!0),[j[0],j[1],j[2],255*ee]})]);return l.divseq(z,255),this.hasAlphaScale=$,z},E.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},E.isOpaque=function(){return!this.isTransparent()},E.pickSlots=1,E.setPickBase=function(H){this.pickId=H};var k=[0,0,0],L={showSurface:!1,showContour:!1,projections:[x.slice(),x.slice(),x.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function M(H,Y){var $,z,j,W=Y.axes&&Y.axes.lastCubeProps.axis||k,ee=Y.showSurface,J=Y.showContour;for($=0;$<3;++$)for(ee=ee||Y.surfaceProject[$],z=0;z<3;++z)J=J||Y.contourProject[$][z];for($=0;$<3;++$){var Q=L.projections[$];for(z=0;z<16;++z)Q[z]=0;for(z=0;z<4;++z)Q[5*z]=1;Q[5*$]=0,Q[12+$]=Y.axesBounds[+(W[$]>0)][$],i(Q,H.model,Q);var te=L.clipBounds[$];for(j=0;j<2;++j)for(z=0;z<3;++z)te[j][z]=H.clipBounds[j][z];te[0][$]=-1e8,te[1][$]=1e8}return L.showSurface=ee,L.showContour=J,L}var P={model:x,view:x,projection:x,inverseModel:x.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},D=x.slice(),N=[1,0,0,0,1,0,0,0,1];function U(H,Y){H=H||{};var $=this.gl;$.disable($.CULL_FACE),this._colorMap.bind(0);var z=P;z.model=H.model||x,z.view=H.view||x,z.projection=H.projection||x,z.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],z.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],z.objectOffset=this.objectOffset,z.contourColor=this.contourColor[0],z.inverseModel=c(z.inverseModel,z.model);for(var j=0;j<2;++j)for(var W=z.clipBounds[j],ee=0;ee<3;++ee)W[ee]=Math.min(Math.max(this.clipBounds[j][ee],-1e8),1e8);z.kambient=this.ambientLight,z.kdiffuse=this.diffuseLight,z.kspecular=this.specularLight,z.roughness=this.roughness,z.fresnel=this.fresnel,z.opacity=this.opacity,z.height=0,z.permutation=N,z.vertexColor=this.vertexColor;var J=D;for(i(J,z.view,z.model),i(J,z.projection,J),c(J,J),j=0;j<3;++j)z.eyePosition[j]=J[12+j]/J[15];var Q=J[15];for(j=0;j<3;++j)Q+=this.lightPosition[j]*J[4*j+3];for(j=0;j<3;++j){var te=J[12+j];for(ee=0;ee<3;++ee)te+=J[4*ee+j]*this.lightPosition[ee];z.lightPosition[j]=te/Q}var ie=M(z,this);if(ie.showSurface){for(this._shader.bind(),this._shader.uniforms=z,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw($.TRIANGLES,this._vertexCount),j=0;j<3;++j)this.surfaceProject[j]&&this.vertexCount&&(this._shader.uniforms.model=ie.projections[j],this._shader.uniforms.clipBounds=ie.clipBounds[j],this._vao.draw($.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ie.showContour){var ae=this._contourShader;z.kambient=1,z.kdiffuse=0,z.kspecular=0,z.opacity=1,ae.bind(),ae.uniforms=z;var he=this._contourVAO;for(he.bind(),j=0;j<3;++j)for(ae.uniforms.permutation=A[j],$.lineWidth(this.contourWidth[j]*this.pixelRatio),ee=0;ee<this.contourLevels[j].length;++ee)ee===this.highlightLevel[j]?(ae.uniforms.contourColor=this.highlightColor[j],ae.uniforms.contourTint=this.highlightTint[j]):ee!==0&&ee-1!==this.highlightLevel[j]||(ae.uniforms.contourColor=this.contourColor[j],ae.uniforms.contourTint=this.contourTint[j]),this._contourCounts[j][ee]&&(ae.uniforms.height=this.contourLevels[j][ee],he.draw($.LINES,this._contourCounts[j][ee],this._contourOffsets[j][ee]));for(j=0;j<3;++j)for(ae.uniforms.model=ie.projections[j],ae.uniforms.clipBounds=ie.clipBounds[j],ee=0;ee<3;++ee)if(this.contourProject[j][ee]){ae.uniforms.permutation=A[ee],$.lineWidth(this.contourWidth[ee]*this.pixelRatio);for(var se=0;se<this.contourLevels[ee].length;++se)se===this.highlightLevel[ee]?(ae.uniforms.contourColor=this.highlightColor[ee],ae.uniforms.contourTint=this.highlightTint[ee]):se!==0&&se-1!==this.highlightLevel[ee]||(ae.uniforms.contourColor=this.contourColor[ee],ae.uniforms.contourTint=this.contourTint[ee]),this._contourCounts[ee][se]&&(ae.uniforms.height=this.contourLevels[ee][se],he.draw($.LINES,this._contourCounts[ee][se],this._contourOffsets[ee][se]))}for(he.unbind(),(he=this._dynamicVAO).bind(),j=0;j<3;++j)if(this._dynamicCounts[j]!==0)for(ae.uniforms.model=z.model,ae.uniforms.clipBounds=z.clipBounds,ae.uniforms.permutation=A[j],$.lineWidth(this.dynamicWidth[j]*this.pixelRatio),ae.uniforms.contourColor=this.dynamicColor[j],ae.uniforms.contourTint=this.dynamicTint[j],ae.uniforms.height=this.dynamicLevel[j],he.draw($.LINES,this._dynamicCounts[j],this._dynamicOffsets[j]),ee=0;ee<3;++ee)this.contourProject[ee][j]&&(ae.uniforms.model=ie.projections[ee],ae.uniforms.clipBounds=ie.clipBounds[ee],he.draw($.LINES,this._dynamicCounts[j],this._dynamicOffsets[j]));he.unbind()}}E.draw=function(H){return U.call(this,H,!1)},E.drawTransparent=function(H){return U.call(this,H,!0)};var G={model:x,view:x,projection:x,inverseModel:x,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function X(H,Y){return Array.isArray(H)?[Y(H[0]),Y(H[1]),Y(H[2])]:[Y(H),Y(H),Y(H)]}function K(H){return Array.isArray(H)?H.length===3?[H[0],H[1],H[2],1]:[H[0],H[1],H[2],H[3]]:[0,0,0,1]}function Z(H){if(Array.isArray(H)){if(Array.isArray(H))return[K(H[0]),K(H[1]),K(H[2])];var Y=K(H);return[Y.slice(),Y.slice(),Y.slice()]}}E.drawPick=function(H){H=H||{};var Y=this.gl;Y.disable(Y.CULL_FACE);var $=G;$.model=H.model||x,$.view=H.view||x,$.projection=H.projection||x,$.shape=this._field[2].shape,$.pickId=this.pickId/255,$.lowerBound=this.bounds[0],$.upperBound=this.bounds[1],$.objectOffset=this.objectOffset,$.permutation=N;for(var z=0;z<2;++z)for(var j=$.clipBounds[z],W=0;W<3;++W)j[W]=Math.min(Math.max(this.clipBounds[z][W],-1e8),1e8);var ee=M($,this);if(ee.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=$,this._vao.bind(),this._vao.draw(Y.TRIANGLES,this._vertexCount),z=0;z<3;++z)this.surfaceProject[z]&&(this._pickShader.uniforms.model=ee.projections[z],this._pickShader.uniforms.clipBounds=ee.clipBounds[z],this._vao.draw(Y.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ee.showContour){var J=this._contourPickShader;J.bind(),J.uniforms=$;var Q=this._contourVAO;for(Q.bind(),W=0;W<3;++W)for(Y.lineWidth(this.contourWidth[W]*this.pixelRatio),J.uniforms.permutation=A[W],z=0;z<this.contourLevels[W].length;++z)this._contourCounts[W][z]&&(J.uniforms.height=this.contourLevels[W][z],Q.draw(Y.LINES,this._contourCounts[W][z],this._contourOffsets[W][z]));for(z=0;z<3;++z)for(J.uniforms.model=ee.projections[z],J.uniforms.clipBounds=ee.clipBounds[z],W=0;W<3;++W)if(this.contourProject[z][W]){J.uniforms.permutation=A[W],Y.lineWidth(this.contourWidth[W]*this.pixelRatio);for(var te=0;te<this.contourLevels[W].length;++te)this._contourCounts[W][te]&&(J.uniforms.height=this.contourLevels[W][te],Q.draw(Y.LINES,this._contourCounts[W][te],this._contourOffsets[W][te]))}Q.unbind()}},E.pick=function(H){if(!H||H.id!==this.pickId)return null;var Y=this._field[2].shape,$=this._pickResult,z=Y[0]*(H.value[0]+(H.value[2]>>4)/16)/255,j=Math.floor(z),W=z-j,ee=Y[1]*(H.value[1]+(15&H.value[2])/16)/255,J=Math.floor(ee),Q=ee-J;j+=1,J+=1;var te=$.position;te[0]=te[1]=te[2]=0;for(var ie=0;ie<2;++ie)for(var ae=ie?W:1-W,he=0;he<2;++he)for(var se=j+ie,de=J+he,ue=ae*(he?Q:1-Q),ve=0;ve<3;++ve)te[ve]+=this._field[ve].get(se,de)*ue;for(var ke=this._pickResult.level,Ee=0;Ee<3;++Ee)if(ke[Ee]=n.le(this.contourLevels[Ee],te[Ee]),ke[Ee]<0)this.contourLevels[Ee].length>0&&(ke[Ee]=0);else if(ke[Ee]<this.contourLevels[Ee].length-1){var be=this.contourLevels[Ee][ke[Ee]],xe=this.contourLevels[Ee][ke[Ee]+1];Math.abs(be-te[Ee])>Math.abs(xe-te[Ee])&&(ke[Ee]+=1)}for($.index[0]=W<.5?j:j+1,$.index[1]=Q<.5?J:J+1,$.uv[0]=z/Y[0],$.uv[1]=ee/Y[1],ve=0;ve<3;++ve)$.dataCoordinate[ve]=this._field[ve].get($.index[0],$.index[1]);return $},E.padField=function(H,Y){var $=Y.shape.slice(),z=H.shape.slice();l.assign(H.lo(1,1).hi($[0],$[1]),Y),l.assign(H.lo(1).hi($[0],1),Y.hi($[0],1)),l.assign(H.lo(1,z[1]-1).hi($[0],1),Y.lo(0,$[1]-1).hi($[0],1)),l.assign(H.lo(0,1).hi(1,$[1]),Y.hi(1)),l.assign(H.lo(z[0]-1,1).hi(1,$[1]),Y.lo($[0]-1)),H.set(0,0,Y.get(0,0)),H.set(0,z[1]-1,Y.get(0,$[1]-1)),H.set(z[0]-1,0,Y.get($[0]-1,0)),H.set(z[0]-1,z[1]-1,Y.get($[0]-1,$[1]-1))},E.update=function(H){H=H||{},this.objectOffset=H.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in H&&(this.contourWidth=X(H.contourWidth,Number)),"showContour"in H&&(this.showContour=X(H.showContour,Boolean)),"showSurface"in H&&(this.showSurface=!!H.showSurface),"contourTint"in H&&(this.contourTint=X(H.contourTint,Boolean)),"contourColor"in H&&(this.contourColor=Z(H.contourColor)),"contourProject"in H&&(this.contourProject=X(H.contourProject,function(wt){return X(wt,Boolean)})),"surfaceProject"in H&&(this.surfaceProject=H.surfaceProject),"dynamicColor"in H&&(this.dynamicColor=Z(H.dynamicColor)),"dynamicTint"in H&&(this.dynamicTint=X(H.dynamicTint,Number)),"dynamicWidth"in H&&(this.dynamicWidth=X(H.dynamicWidth,Number)),"opacity"in H&&(this.opacity=H.opacity),"opacityscale"in H&&(this.opacityscale=H.opacityscale),"colorBounds"in H&&(this.colorBounds=H.colorBounds),"vertexColor"in H&&(this.vertexColor=H.vertexColor?1:0),"colormap"in H&&this._colorMap.setPixels(this.genColormap(H.colormap,this.opacityscale));var Y=H.field||H.coords&&H.coords[2]||null,$=!1;if(Y||(Y=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in H||"coords"in H){var z=(Y.shape[0]+2)*(Y.shape[1]+2);z>this._field[2].data.length&&(e.freeFloat(this._field[2].data),this._field[2].data=e.mallocFloat(t.nextPow2(z))),this._field[2]=u(this._field[2].data,[Y.shape[0]+2,Y.shape[1]+2]),this.padField(this._field[2],Y),this.shape=Y.shape.slice();for(var j=this.shape,W=0;W<2;++W)this._field[2].size>this._field[W].data.length&&(e.freeFloat(this._field[W].data),this._field[W].data=e.mallocFloat(this._field[2].size)),this._field[W]=u(this._field[W].data,[j[0]+2,j[1]+2]);if(H.coords){var ee=H.coords;if(!Array.isArray(ee)||ee.length!==3)throw new Error("gl-surface: invalid coordinates for x/y");for(W=0;W<2;++W){var J=ee[W];for(he=0;he<2;++he)if(J.shape[he]!==j[he])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[W],J)}}else if(H.ticks){var Q=H.ticks;if(!Array.isArray(Q)||Q.length!==2)throw new Error("gl-surface: invalid ticks");for(W=0;W<2;++W){var te=Q[W];if((Array.isArray(te)||te.length)&&(te=u(te)),te.shape[0]!==j[W])throw new Error("gl-surface: invalid tick length");var ie=u(te.data,j);ie.stride[W]=te.stride[0],ie.stride[1^W]=0,this.padField(this._field[W],ie)}}else{for(W=0;W<2;++W){var ae=[0,0];ae[W]=1,this._field[W]=u(this._field[W].data,[j[0]+2,j[1]+2],ae,0)}this._field[0].set(0,0,0);for(var he=0;he<j[0];++he)this._field[0].set(he+1,0,he);for(this._field[0].set(j[0]+1,0,j[0]-1),this._field[1].set(0,0,0),he=0;he<j[1];++he)this._field[1].set(0,he+1,he);this._field[1].set(0,j[1]+1,j[1]-1)}var se=this._field,de=u(e.mallocFloat(3*se[2].size*2),[3,j[0]+2,j[1]+2,2]);for(W=0;W<3;++W)a(de.pick(W),se[W],"mirror");var ue=u(e.mallocFloat(3*se[2].size),[j[0]+2,j[1]+2,3]);for(W=0;W<j[0]+2;++W)for(he=0;he<j[1]+2;++he){var ve=de.get(0,W,he,0),ke=de.get(0,W,he,1),Ee=de.get(1,W,he,0),be=de.get(1,W,he,1),xe=de.get(2,W,he,0),ce=de.get(2,W,he,1),ge=Ee*ce-be*xe,we=xe*ke-ce*ve,Me=ve*be-ke*Ee,Se=Math.sqrt(ge*ge+we*we+Me*Me);Se<1e-8?(Se=Math.max(Math.abs(ge),Math.abs(we),Math.abs(Me)))<1e-8?(Me=1,we=ge=0,Se=1):Se=1/Se:Se=1/Math.sqrt(Se),ue.set(W,he,0,ge*Se),ue.set(W,he,1,we*Se),ue.set(W,he,2,Me*Se)}e.free(de.data);var ze=[1/0,1/0,1/0],Fe=[-1/0,-1/0,-1/0],Ye=1/0,rt=-1/0,Oe=(j[0]-1)*(j[1]-1)*6,je=e.mallocFloat(t.nextPow2(10*Oe)),We=0,qe=0;for(W=0;W<j[0]-1;++W)e:for(he=0;he<j[1]-1;++he){for(var et=0;et<2;++et)for(var st=0;st<2;++st)for(var ct=0;ct<3;++ct){var Pt=this._field[ct].get(1+W+et,1+he+st);if(isNaN(Pt)||!isFinite(Pt))continue e}for(ct=0;ct<6;++ct){var kt=W+T[ct][0],at=he+T[ct][1],tt=this._field[0].get(kt+1,at+1),_t=this._field[1].get(kt+1,at+1);Pt=this._field[2].get(kt+1,at+1),ge=ue.get(kt+1,at+1,0),we=ue.get(kt+1,at+1,1),Me=ue.get(kt+1,at+1,2),H.intensity&&(er=H.intensity.get(kt,at));var er=H.intensity?H.intensity.get(kt,at):Pt+this.objectOffset[2];je[We++]=kt,je[We++]=at,je[We++]=tt,je[We++]=_t,je[We++]=Pt,je[We++]=0,je[We++]=er,je[We++]=ge,je[We++]=we,je[We++]=Me,ze[0]=Math.min(ze[0],tt+this.objectOffset[0]),ze[1]=Math.min(ze[1],_t+this.objectOffset[1]),ze[2]=Math.min(ze[2],Pt+this.objectOffset[2]),Ye=Math.min(Ye,er),Fe[0]=Math.max(Fe[0],tt+this.objectOffset[0]),Fe[1]=Math.max(Fe[1],_t+this.objectOffset[1]),Fe[2]=Math.max(Fe[2],Pt+this.objectOffset[2]),rt=Math.max(rt,er),qe+=1}}for(H.intensityBounds&&(Ye=+H.intensityBounds[0],rt=+H.intensityBounds[1]),W=6;W<We;W+=10)je[W]=(je[W]-Ye)/(rt-Ye);this._vertexCount=qe,this._coordinateBuffer.update(je.subarray(0,We)),e.freeFloat(je),e.free(ue.data),this.bounds=[ze,Fe],this.intensity=H.intensity||this._field[2],this.intensityBounds[0]===Ye&&this.intensityBounds[1]===rt||($=!0),this.intensityBounds=[Ye,rt]}if("levels"in H){var tr=H.levels;for(tr=Array.isArray(tr[0])?tr.slice():[[],[],tr],W=0;W<3;++W)tr[W]=tr[W].slice(),tr[W].sort(function(wt,Ot){return wt-Ot});for(W=0;W<3;++W)for(he=0;he<tr[W].length;++he)tr[W][he]-=this.objectOffset[W];e:for(W=0;W<3;++W){if(tr[W].length!==this.contourLevels[W].length){$=!0;break}for(he=0;he<tr[W].length;++he)if(tr[W][he]!==this.contourLevels[W][he]){$=!0;break e}}this.contourLevels=tr}if($){se=this._field,j=this.shape;for(var Ue=[],He=0;He<3;++He){var Be=this.contourLevels[He],Ke=[],_e=[],Ce=[0,0,0];for(W=0;W<Be.length;++W){var Le=s(this._field[He],Be[W]);Ke.push(Ue.length/5|0),qe=0;e:for(he=0;he<Le.cells.length;++he){var Pe=Le.cells[he];for(ct=0;ct<2;++ct){var Xe=Le.positions[Pe[ct]],ht=Xe[0],Mt=0|Math.floor(ht),pt=ht-Mt,Lt=Xe[1],vt=0|Math.floor(Lt),Dt=Lt-vt,xt=!1;t:for(var it=0;it<3;++it){Ce[it]=0;var St=(He+it+1)%3;for(et=0;et<2;++et){var Nt=et?pt:1-pt;for(kt=0|Math.min(Math.max(Mt+et,0),j[0]),st=0;st<2;++st){var Ut=st?Dt:1-Dt;if(at=0|Math.min(Math.max(vt+st,0),j[1]),Pt=it<2?this._field[St].get(kt,at):(this.intensity.get(kt,at)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(Pt)||isNaN(Pt)){xt=!0;break t}var Qt=Nt*Ut;Ce[it]+=Qt*Pt}}}if(xt){if(ct>0){for(var Ie=0;Ie<5;++Ie)Ue.pop();qe-=1}continue e}Ue.push(Ce[0],Ce[1],Xe[0],Xe[1],Ce[2]),qe+=1}}_e.push(qe)}this._contourOffsets[He]=Ke,this._contourCounts[He]=_e}var lt=e.mallocFloat(Ue.length);for(W=0;W<Ue.length;++W)lt[W]=Ue[W];this._contourBuffer.update(lt),e.freeFloat(lt)}},E.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var H=0;H<3;++H)e.freeFloat(this._field[H].data)},E.highlight=function(H){var Y,$;if(!H)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(Y=0;Y<3;++Y)this.enableHighlight[Y]?this.highlightLevel[Y]=H.level[Y]:this.highlightLevel[Y]=-1;for($=this.snapToData?H.dataCoordinate:H.position,Y=0;Y<3;++Y)$[Y]-=this.objectOffset[Y];if(this.enableDynamic[0]&&$[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&$[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&$[2]!==this.dynamicLevel[2]){for(var z=0,j=this.shape,W=e.mallocFloat(12*j[0]*j[1]),ee=0;ee<3;++ee)if(this.enableDynamic[ee]){this.dynamicLevel[ee]=$[ee];var J=(ee+1)%3,Q=(ee+2)%3,te=this._field[ee],ie=this._field[J],ae=this._field[Q],he=s(te,$[ee]),se=he.cells,de=he.positions;for(this._dynamicOffsets[ee]=z,Y=0;Y<se.length;++Y)for(var ue=se[Y],ve=0;ve<2;++ve){var ke=de[ue[ve]],Ee=+ke[0],be=0|Ee,xe=0|Math.min(be+1,j[0]),ce=Ee-be,ge=1-ce,we=+ke[1],Me=0|we,Se=0|Math.min(Me+1,j[1]),ze=we-Me,Fe=1-ze,Ye=ge*Fe,rt=ge*ze,Oe=ce*Fe,je=ce*ze,We=Ye*ie.get(be,Me)+rt*ie.get(be,Se)+Oe*ie.get(xe,Me)+je*ie.get(xe,Se),qe=Ye*ae.get(be,Me)+rt*ae.get(be,Se)+Oe*ae.get(xe,Me)+je*ae.get(xe,Se);if(isNaN(We)||isNaN(qe)){ve&&(z-=1);break}W[2*z+0]=We,W[2*z+1]=qe,z+=1}this._dynamicCounts[ee]=z-this._dynamicOffsets[ee]}else this.dynamicLevel[ee]=NaN,this._dynamicCounts[ee]=0;this._dynamicBuffer.update(W.subarray(0,2*z)),e.freeFloat(W)}}},{"./lib/shaders":345,"binary-search-bounds":103,"bit-twiddle":104,colormap:137,"gl-buffer":261,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-texture2d":348,"gl-vao":353,ndarray:472,"ndarray-gradient":465,"ndarray-ops":467,"ndarray-pack":468,"surface-nets":576,"typedarray-pool":601}],347:[function(r,I,B){var t=r("css-font"),d=r("pick-by-alias"),m=r("regl"),h=r("gl-util/context"),e=r("es6-weak-map"),f=r("color-normalize"),l=r("font-atlas"),o=r("typedarray-pool"),u=r("parse-rect"),s=r("is-plain-obj"),i=r("parse-unit"),c=r("to-px"),n=r("detect-kerning"),a=r("object-assign"),g=r("font-measure"),p=r("flatten-vertex-data"),y=r("bit-twiddle").nextPow2,v=new e,b=!1;if(document.body){var x=document.body.appendChild(document.createElement("div"));x.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(x).fontStretch&&(b=!0),document.body.removeChild(x)}var T=function(A){(function(S){return typeof S=="function"&&S._gl&&S.prop&&S.texture&&S.buffer})(A)?(A={regl:A},this.gl=A.regl._gl):this.gl=h(A),this.shader=v.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=A.regl||m({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),v.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(s(A)?A:{})};T.prototype.createShader=function(){var A=this.regl,S=A({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:A.prop("count"),offset:A.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:A.this("sizeBuffer")},width:{offset:0,stride:8,buffer:A.this("sizeBuffer")},char:A.this("charBuffer"),position:A.this("position")},uniforms:{atlasSize:function(w,E){return[E.atlas.width,E.atlas.height]},atlasDim:function(w,E){return[E.atlas.cols,E.atlas.rows]},atlas:function(w,E){return E.atlas.texture},charStep:function(w,E){return E.atlas.step},em:function(w,E){return E.atlas.em},color:A.prop("color"),opacity:A.prop("opacity"),viewport:A.this("viewportArray"),scale:A.this("scale"),align:A.prop("align"),baseline:A.prop("baseline"),translate:A.this("translate"),positionOffset:A.prop("positionOffset")},primitive:"points",viewport:A.this("viewport"),vert:`
			precision highp float;
			attribute float width, charOffset, char;
			attribute vec2 position;
			uniform float fontSize, charStep, em, align, baseline;
			uniform vec4 viewport;
			uniform vec4 color;
			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;
			varying vec2 charCoord, charId;
			varying float charWidth;
			varying vec4 fontColor;
			void main () {
				vec2 offset = floor(em * (vec2(align + charOffset, baseline)
					+ vec2(positionOffset.x, -positionOffset.y)))
					/ (viewport.zw * scale.xy);

				vec2 position = (position + translate) * scale;
				position += offset * scale;

				charCoord = position * viewport.zw + viewport.xy;

				gl_Position = vec4(position * 2. - 1., 0, 1);

				gl_PointSize = charStep;

				charId.x = mod(char, atlasDim.x);
				charId.y = floor(char / atlasDim.x);

				charWidth = width * em;

				fontColor = color / 255.;
			}`,frag:`
			precision highp float;
			uniform float fontSize, charStep, opacity;
			uniform vec2 atlasSize;
			uniform vec4 viewport;
			uniform sampler2D atlas;
			varying vec4 fontColor;
			varying vec2 charCoord, charId;
			varying float charWidth;

			float lightness(vec4 color) {
				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
			}

			void main () {
				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;
				float halfCharStep = floor(charStep * .5 + .5);

				// invert y and shift by 1px (FF expecially needs that)
				uv.y = charStep - uv.y;

				// ignore points outside of character bounding box
				float halfCharWidth = ceil(charWidth * .5);
				if (floor(uv.x) > halfCharStep + halfCharWidth ||
					floor(uv.x) < halfCharStep - halfCharWidth) return;

				uv += charId * charStep;
				uv = uv / atlasSize;

				vec4 color = fontColor;
				vec4 mask = texture2D(atlas, uv);

				float maskY = lightness(mask);
				// float colorY = lightness(color);
				color.a *= maskY;
				color.a *= opacity;

				// color.a += .1;

				// antialiasing, see yiq color space y-channel formula
				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);

				gl_FragColor = color;
			}`});return{regl:A,draw:S,atlas:{}}},T.prototype.update=function(A){var S=this;if(typeof A=="string")A={text:A};else if(!A)return;(A=d(A,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0)).opacity!=null&&(Array.isArray(A.opacity)?this.opacity=A.opacity.map(function(ge){return parseFloat(ge)}):this.opacity=parseFloat(A.opacity)),A.viewport!=null&&(this.viewport=u(A.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),this.viewport==null&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),A.kerning!=null&&(this.kerning=A.kerning),A.offset!=null&&(typeof A.offset=="number"&&(A.offset=[A.offset,0]),this.positionOffset=p(A.offset)),A.direction&&(this.direction=A.direction),A.range&&(this.range=A.range,this.scale=[1/(A.range[2]-A.range[0]),1/(A.range[3]-A.range[1])],this.translate=[-A.range[0],-A.range[1]]),A.scale&&(this.scale=A.scale),A.translate&&(this.translate=A.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||A.font||(A.font=T.baseFontSize+"px sans-serif");var w,E=!1,k=!1;if(A.font&&(Array.isArray(A.font)?A.font:[A.font]).forEach(function(ge,we){if(typeof ge=="string")try{ge=t.parse(ge)}catch(rt){ge=t.parse(T.baseFontSize+"px "+ge)}else ge=t.parse(t.stringify(ge));var Me=t.stringify({size:T.baseFontSize,family:ge.family,stretch:b?ge.stretch:void 0,variant:ge.variant,weight:ge.weight,style:ge.style}),Se=i(ge.size),ze=Math.round(Se[0]*c(Se[1]));if(ze!==S.fontSize[we]&&(k=!0,S.fontSize[we]=ze),!(S.font[we]&&Me==S.font[we].baseString||(E=!0,S.font[we]=T.fonts[Me],S.font[we]))){var Fe=ge.family.join(", "),Ye=[ge.style];ge.style!=ge.variant&&Ye.push(ge.variant),ge.variant!=ge.weight&&Ye.push(ge.weight),b&&ge.weight!=ge.stretch&&Ye.push(ge.stretch),S.font[we]={baseString:Me,family:Fe,weight:ge.weight,stretch:ge.stretch,style:ge.style,variant:ge.variant,width:{},kerning:{},metrics:g(Fe,{origin:"top",fontSize:T.baseFontSize,fontStyle:Ye.join(" ")})},T.fonts[Me]=S.font[we]}}),(E||k)&&this.font.forEach(function(ge,we){var Me=t.stringify({size:S.fontSize[we],family:ge.family,stretch:b?ge.stretch:void 0,variant:ge.variant,weight:ge.weight,style:ge.style});if(S.fontAtlas[we]=S.shader.atlas[Me],!S.fontAtlas[we]){var Se=ge.metrics;S.shader.atlas[Me]=S.fontAtlas[we]={fontString:Me,step:2*Math.ceil(S.fontSize[we]*Se.bottom*.5),em:S.fontSize[we],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:S.regl.texture()}}A.text==null&&(A.text=S.text)}),typeof A.text=="string"&&A.position&&A.position.length>2){for(var L=Array(.5*A.position.length),M=0;M<L.length;M++)L[M]=A.text;A.text=L}if(A.text!=null||E){if(this.textOffsets=[0],Array.isArray(A.text)){this.count=A.text[0].length,this.counts=[this.count];for(var P=1;P<A.text.length;P++)this.textOffsets[P]=this.textOffsets[P-1]+A.text[P-1].length,this.count+=A.text[P].length,this.counts.push(A.text[P].length);this.text=A.text.join("")}else this.text=A.text,this.count=this.text.length,this.counts=[this.count];w=[],this.font.forEach(function(ge,we){T.atlasContext.font=ge.baseString;for(var Me=S.fontAtlas[we],Se=0;Se<S.text.length;Se++){var ze=S.text.charAt(Se);if(Me.ids[ze]==null&&(Me.ids[ze]=Me.chars.length,Me.chars.push(ze),w.push(ze)),ge.width[ze]==null&&(ge.width[ze]=T.atlasContext.measureText(ze).width/T.baseFontSize,S.kerning)){var Fe=[];for(var Ye in ge.width)Fe.push(Ye+ze,ze+Ye);a(ge.kerning,n(ge.family,{pairs:Fe}))}}})}if(A.position)if(A.position.length>2){for(var D=!A.position[0].length,N=o.mallocFloat(2*this.count),U=0,G=0;U<this.counts.length;U++){var X=this.counts[U];if(D)for(var K=0;K<X;K++)N[G++]=A.position[2*U],N[G++]=A.position[2*U+1];else for(var Z=0;Z<X;Z++)N[G++]=A.position[U][0],N[G++]=A.position[U][1]}this.position.call?this.position({type:"float",data:N}):this.position=this.regl.buffer({type:"float",data:N}),o.freeFloat(N)}else this.position.destroy&&this.position.destroy(),this.position={constant:A.position};if(A.text||E){var H=o.mallocUint8(this.count),Y=o.mallocFloat(2*this.count);this.textWidth=[];for(var $=0,z=0;$<this.counts.length;$++){for(var j=this.counts[$],W=this.font[$]||this.font[0],ee=this.fontAtlas[$]||this.fontAtlas[0],J=0;J<j;J++){var Q=this.text.charAt(z),te=this.text.charAt(z-1);if(H[z]=ee.ids[Q],Y[2*z]=W.width[Q],J){var ie=Y[2*z-2],ae=Y[2*z],he=Y[2*z-1]+.5*ie+.5*ae;if(this.kerning){var se=W.kerning[te+Q];se&&(he+=.001*se)}Y[2*z+1]=he}else Y[2*z+1]=.5*Y[2*z];z++}this.textWidth.push(Y.length?.5*Y[2*z-2]+Y[2*z-1]:0)}A.align||(A.align=this.align),this.charBuffer({data:H,type:"uint8",usage:"stream"}),this.sizeBuffer({data:Y,type:"float",usage:"stream"}),o.freeUint8(H),o.freeFloat(Y),w.length&&this.font.forEach(function(ge,we){var Me=S.fontAtlas[we],Se=Me.step,ze=Math.floor(T.maxAtlasSize/Se),Fe=Math.min(ze,Me.chars.length),Ye=Math.ceil(Me.chars.length/Fe),rt=y(Fe*Se),Oe=y(Ye*Se);Me.width=rt,Me.height=Oe,Me.rows=Ye,Me.cols=Fe,Me.em&&Me.texture({data:l({canvas:T.atlasCanvas,font:Me.fontString,chars:Me.chars,shape:[rt,Oe],step:[Se,Se]})})})}if(A.align&&(this.align=A.align,this.alignOffset=this.textWidth.map(function(ge,we){var Me=Array.isArray(S.align)?S.align.length>1?S.align[we]:S.align[0]:S.align;if(typeof Me=="number")return Me;switch(Me){case"right":case"end":return-ge;case"center":case"centre":case"middle":return .5*-ge}return 0})),this.baseline==null&&A.baseline==null&&(A.baseline=0),A.baseline!=null&&(this.baseline=A.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(ge,we){var Me=(S.font[we]||S.font[0]).metrics,Se=0;return Se+=.5*Me.bottom,Se+=typeof ge=="number"?ge-Me.baseline:-Me[ge],Se*=-1})),A.color!=null)if(A.color||(A.color="transparent"),typeof A.color!="string"&&isNaN(A.color)){var de;if(typeof A.color[0]=="number"&&A.color.length>this.counts.length){var ue=A.color.length;de=o.mallocUint8(ue);for(var ve=(A.color.subarray||A.color.slice).bind(A.color),ke=0;ke<ue;ke+=4)de.set(f(ve(ke,ke+4),"uint8"),ke)}else{var Ee=A.color.length;de=o.mallocUint8(4*Ee);for(var be=0;be<Ee;be++)de.set(f(A.color[be]||0,"uint8"),4*be)}this.color=de}else this.color=f(A.color,"uint8");if(A.position||A.text||A.color||A.baseline||A.align||A.font||A.offset||A.opacity)if(this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2){var xe=Math.max(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(xe);for(var ce=0;ce<this.batch.length;ce++)this.batch[ce]={count:this.counts.length>1?this.counts[ce]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[ce]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(4*ce,4*ce+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[ce]:this.opacity,baseline:this.baselineOffset[ce]!=null?this.baselineOffset[ce]:this.baselineOffset[0],align:this.align?this.alignOffset[ce]!=null?this.alignOffset[ce]:this.alignOffset[0]:0,atlas:this.fontAtlas[ce]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(2*ce,2*ce+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]},T.prototype.destroy=function(){},T.prototype.kerning=!0,T.prototype.position={constant:new Float32Array(2)},T.prototype.translate=null,T.prototype.scale=null,T.prototype.font=null,T.prototype.text="",T.prototype.positionOffset=[0,0],T.prototype.opacity=1,T.prototype.color=new Uint8Array([0,0,0,255]),T.prototype.alignOffset=[0,0],T.maxAtlasSize=1024,T.atlasCanvas=document.createElement("canvas"),T.atlasContext=T.atlasCanvas.getContext("2d",{alpha:!1}),T.baseFontSize=64,T.fonts={},I.exports=T},{"bit-twiddle":104,"color-normalize":131,"css-font":150,"detect-kerning":178,"es6-weak-map":238,"flatten-vertex-data":248,"font-atlas":249,"font-measure":250,"gl-util/context":349,"is-plain-obj":447,"object-assign":476,"parse-rect":481,"parse-unit":483,"pick-by-alias":485,regl:526,"to-px":585,"typedarray-pool":601}],348:[function(r,I,B){var t=r("ndarray"),d=r("ndarray-ops"),m=r("typedarray-pool");I.exports=function(v){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(h||l(v),typeof arguments[1]=="number")return g(v,arguments[1],arguments[2],arguments[3]||v.RGBA,arguments[4]||v.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return g(v,0|arguments[1][0],0|arguments[1][1],arguments[2]||v.RGBA,arguments[3]||v.UNSIGNED_BYTE);if(typeof arguments[1]=="object"){var b=arguments[1],x=o(b)?b:b.raw;if(x)return p(v,x,0|b.width,0|b.height,arguments[2]||v.RGBA,arguments[3]||v.UNSIGNED_BYTE);if(b.shape&&b.data&&b.stride)return y(v,b)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")};var h=null,e=null,f=null;function l(v){h=[v.LINEAR,v.NEAREST_MIPMAP_LINEAR,v.LINEAR_MIPMAP_NEAREST,v.LINEAR_MIPMAP_NEAREST],e=[v.NEAREST,v.LINEAR,v.NEAREST_MIPMAP_NEAREST,v.NEAREST_MIPMAP_LINEAR,v.LINEAR_MIPMAP_NEAREST,v.LINEAR_MIPMAP_LINEAR],f=[v.REPEAT,v.CLAMP_TO_EDGE,v.MIRRORED_REPEAT]}function o(v){return typeof HTMLCanvasElement!="undefined"&&v instanceof HTMLCanvasElement||typeof HTMLImageElement!="undefined"&&v instanceof HTMLImageElement||typeof HTMLVideoElement!="undefined"&&v instanceof HTMLVideoElement||typeof ImageData!="undefined"&&v instanceof ImageData}var u=function(v,b){d.muls(v,b,255)};function s(v,b,x){var T=v.gl,A=T.getParameter(T.MAX_TEXTURE_SIZE);if(b<0||b>A||x<0||x>A)throw new Error("gl-texture2d: Invalid texture size");return v._shape=[b,x],v.bind(),T.texImage2D(T.TEXTURE_2D,0,v.format,b,x,0,v.format,v.type,null),v._mipLevels=[0],v}function i(v,b,x,T,A,S){this.gl=v,this.handle=b,this.format=A,this.type=S,this._shape=[x,T],this._mipLevels=[0],this._magFilter=v.NEAREST,this._minFilter=v.NEAREST,this._wrapS=v.CLAMP_TO_EDGE,this._wrapT=v.CLAMP_TO_EDGE,this._anisoSamples=1;var w=this,E=[this._wrapS,this._wrapT];Object.defineProperties(E,[{get:function(){return w._wrapS},set:function(L){return w.wrapS=L}},{get:function(){return w._wrapT},set:function(L){return w.wrapT=L}}]),this._wrapVector=E;var k=[this._shape[0],this._shape[1]];Object.defineProperties(k,[{get:function(){return w._shape[0]},set:function(L){return w.width=L}},{get:function(){return w._shape[1]},set:function(L){return w.height=L}}]),this._shapeVector=k}var c=i.prototype;function n(v,b){return v.length===3?b[2]===1&&b[1]===v[0]*v[2]&&b[0]===v[2]:b[0]===1&&b[1]===v[0]}function a(v){var b=v.createTexture();return v.bindTexture(v.TEXTURE_2D,b),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),b}function g(v,b,x,T,A){var S=v.getParameter(v.MAX_TEXTURE_SIZE);if(b<0||b>S||x<0||x>S)throw new Error("gl-texture2d: Invalid texture shape");if(A===v.FLOAT&&!v.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var w=a(v);return v.texImage2D(v.TEXTURE_2D,0,T,b,x,0,T,A,null),new i(v,w,b,x,T,A)}function p(v,b,x,T,A,S){var w=a(v);return v.texImage2D(v.TEXTURE_2D,0,A,A,S,b),new i(v,w,x,T,A,S)}function y(v,b){var x=b.dtype,T=b.shape.slice(),A=v.getParameter(v.MAX_TEXTURE_SIZE);if(T[0]<0||T[0]>A||T[1]<0||T[1]>A)throw new Error("gl-texture2d: Invalid texture size");var S=n(T,b.stride.slice()),w=0;x==="float32"?w=v.FLOAT:x==="float64"?(w=v.FLOAT,S=!1,x="float32"):x==="uint8"?w=v.UNSIGNED_BYTE:(w=v.UNSIGNED_BYTE,S=!1,x="uint8");var E,k,L=0;if(T.length===2)L=v.LUMINANCE,T=[T[0],T[1],1],b=t(b.data,T,[b.stride[0],b.stride[1],1],b.offset);else{if(T.length!==3)throw new Error("gl-texture2d: Invalid shape for texture");if(T[2]===1)L=v.ALPHA;else if(T[2]===2)L=v.LUMINANCE_ALPHA;else if(T[2]===3)L=v.RGB;else{if(T[2]!==4)throw new Error("gl-texture2d: Invalid shape for pixel coords");L=v.RGBA}}w!==v.FLOAT||v.getExtension("OES_texture_float")||(w=v.UNSIGNED_BYTE,S=!1);var M=b.size;if(S)E=b.offset===0&&b.data.length===M?b.data:b.data.subarray(b.offset,b.offset+M);else{var P=[T[2],T[2]*T[0],1];k=m.malloc(M,x);var D=t(k,T,P,0);x!=="float32"&&x!=="float64"||w!==v.UNSIGNED_BYTE?d.assign(D,b):u(D,b),E=k.subarray(0,M)}var N=a(v);return v.texImage2D(v.TEXTURE_2D,0,L,T[0],T[1],0,L,w,E),S||m.free(k),new i(v,N,T[0],T[1],L,w)}Object.defineProperties(c,{minFilter:{get:function(){return this._minFilter},set:function(v){this.bind();var b=this.gl;if(this.type===b.FLOAT&&h.indexOf(v)>=0&&(b.getExtension("OES_texture_float_linear")||(v=b.NEAREST)),e.indexOf(v)<0)throw new Error("gl-texture2d: Unknown filter mode "+v);return b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,v),this._minFilter=v}},magFilter:{get:function(){return this._magFilter},set:function(v){this.bind();var b=this.gl;if(this.type===b.FLOAT&&h.indexOf(v)>=0&&(b.getExtension("OES_texture_float_linear")||(v=b.NEAREST)),e.indexOf(v)<0)throw new Error("gl-texture2d: Unknown filter mode "+v);return b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,v),this._magFilter=v}},mipSamples:{get:function(){return this._anisoSamples},set:function(v){var b=this._anisoSamples;if(this._anisoSamples=0|Math.max(v,1),b!==this._anisoSamples){var x=this.gl.getExtension("EXT_texture_filter_anisotropic");x&&this.gl.texParameterf(this.gl.TEXTURE_2D,x.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(v){if(this.bind(),f.indexOf(v)<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,v),this._wrapS=v}},wrapT:{get:function(){return this._wrapT},set:function(v){if(this.bind(),f.indexOf(v)<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,v),this._wrapT=v}},wrap:{get:function(){return this._wrapVector},set:function(v){if(Array.isArray(v)||(v=[v,v]),v.length!==2)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var b=0;b<2;++b)if(f.indexOf(v[b])<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);this._wrapS=v[0],this._wrapT=v[1];var x=this.gl;return this.bind(),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,this._wrapS),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,this._wrapT),v}},shape:{get:function(){return this._shapeVector},set:function(v){if(Array.isArray(v)){if(v.length!==2)throw new Error("gl-texture2d: Invalid texture shape")}else v=[0|v,0|v];return s(this,0|v[0],0|v[1]),[0|v[0],0|v[1]]}},width:{get:function(){return this._shape[0]},set:function(v){return s(this,v|=0,this._shape[1]),v}},height:{get:function(){return this._shape[1]},set:function(v){return v|=0,s(this,this._shape[0],v),v}}}),c.bind=function(v){var b=this.gl;return v!==void 0&&b.activeTexture(b.TEXTURE0+(0|v)),b.bindTexture(b.TEXTURE_2D,this.handle),v!==void 0?0|v:b.getParameter(b.ACTIVE_TEXTURE)-b.TEXTURE0},c.dispose=function(){this.gl.deleteTexture(this.handle)},c.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var v=Math.min(this._shape[0],this._shape[1]),b=0;v>0;++b,v>>>=1)this._mipLevels.indexOf(b)<0&&this._mipLevels.push(b)},c.setPixels=function(v,b,x,T){var A=this.gl;this.bind(),Array.isArray(b)?(T=x,x=0|b[1],b=0|b[0]):(b=b||0,x=x||0),T=T||0;var S=o(v)?v:v.raw;if(S)this._mipLevels.indexOf(T)<0?(A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,this.type,S),this._mipLevels.push(T)):A.texSubImage2D(A.TEXTURE_2D,T,b,x,this.format,this.type,S);else{if(!(v.shape&&v.stride&&v.data))throw new Error("gl-texture2d: Unsupported data type");if(v.shape.length<2||b+v.shape[1]>this._shape[1]>>>T||x+v.shape[0]>this._shape[0]>>>T||b<0||x<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");(function(w,E,k,L,M,P,D,N){var U=N.dtype,G=N.shape.slice();if(G.length<2||G.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var X=0,K=0,Z=n(G,N.stride.slice());if(U==="float32"?X=w.FLOAT:U==="float64"?(X=w.FLOAT,Z=!1,U="float32"):U==="uint8"?X=w.UNSIGNED_BYTE:(X=w.UNSIGNED_BYTE,Z=!1,U="uint8"),G.length===2)K=w.LUMINANCE,G=[G[0],G[1],1],N=t(N.data,G,[N.stride[0],N.stride[1],1],N.offset);else{if(G.length!==3)throw new Error("gl-texture2d: Invalid shape for texture");if(G[2]===1)K=w.ALPHA;else if(G[2]===2)K=w.LUMINANCE_ALPHA;else if(G[2]===3)K=w.RGB;else{if(G[2]!==4)throw new Error("gl-texture2d: Invalid shape for pixel coords");K=w.RGBA}G[2]}if(K!==w.LUMINANCE&&K!==w.ALPHA||M!==w.LUMINANCE&&M!==w.ALPHA||(K=M),K!==M)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var H=N.size,Y=D.indexOf(L)<0;if(Y&&D.push(L),X===P&&Z)N.offset===0&&N.data.length===H?Y?w.texImage2D(w.TEXTURE_2D,L,M,G[0],G[1],0,M,P,N.data):w.texSubImage2D(w.TEXTURE_2D,L,E,k,G[0],G[1],M,P,N.data):Y?w.texImage2D(w.TEXTURE_2D,L,M,G[0],G[1],0,M,P,N.data.subarray(N.offset,N.offset+H)):w.texSubImage2D(w.TEXTURE_2D,L,E,k,G[0],G[1],M,P,N.data.subarray(N.offset,N.offset+H));else{var $;$=P===w.FLOAT?m.mallocFloat32(H):m.mallocUint8(H);var z=t($,G,[G[2],G[2]*G[0],1]);X===w.FLOAT&&P===w.UNSIGNED_BYTE?u(z,N):d.assign(z,N),Y?w.texImage2D(w.TEXTURE_2D,L,M,G[0],G[1],0,M,P,$.subarray(0,H)):w.texSubImage2D(w.TEXTURE_2D,L,E,k,G[0],G[1],M,P,$.subarray(0,H)),P===w.FLOAT?m.freeFloat32($):m.freeUint8($)}})(A,b,x,T,this.format,this.type,this._mipLevels,v)}}},{ndarray:472,"ndarray-ops":467,"typedarray-pool":601}],349:[function(r,I,B){(function(t){(function(){var d=r("pick-by-alias");function m(f){if(f.container)if(f.container==document.body)document.body.style.width||(f.canvas.width=f.width||f.pixelRatio*t.innerWidth),document.body.style.height||(f.canvas.height=f.height||f.pixelRatio*t.innerHeight);else{var l=f.container.getBoundingClientRect();f.canvas.width=f.width||l.right-l.left,f.canvas.height=f.height||l.bottom-l.top}}function h(f){return typeof f.getContext=="function"&&"width"in f&&"height"in f}function e(){var f=document.createElement("canvas");return f.style.position="absolute",f.style.top=0,f.style.left=0,f}I.exports=function(f){var l;if(f?typeof f=="string"&&(f={container:f}):f={},h(f)?f={container:f}:f=typeof(l=f).nodeName=="string"&&typeof l.appendChild=="function"&&typeof l.getBoundingClientRect=="function"?{container:f}:function(u){return typeof u.drawArrays=="function"||typeof u.drawElements=="function"}(f)?{gl:f}:d(f,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),f.pixelRatio||(f.pixelRatio=t.pixelRatio||1),f.gl)return f.gl;if(f.canvas&&(f.container=f.canvas.parentNode),f.container){if(typeof f.container=="string"){var o=document.querySelector(f.container);if(!o)throw Error("Element "+f.container+" is not found");f.container=o}h(f.container)?(f.canvas=f.container,f.container=f.canvas.parentNode):f.canvas||(f.canvas=e(),f.container.appendChild(f.canvas),m(f))}else if(!f.canvas){if(typeof document=="undefined")throw Error("Not DOM environment. Use headless-gl.");f.container=document.body||document.documentElement,f.canvas=e(),f.container.appendChild(f.canvas),m(f)}return f.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(u){try{f.gl=f.canvas.getContext(u,f.attrs)}catch(s){}return f.gl}),f.gl}}).call(this)}).call(this,typeof vi!="undefined"?vi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"pick-by-alias":485}],350:[function(r,I,B){I.exports=function(t,d,m){d?d.bind():t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null);var h=0|t.getParameter(t.MAX_VERTEX_ATTRIBS);if(m){if(m.length>h)throw new Error("gl-vao: Too many vertex attributes");for(var e=0;e<m.length;++e){var f=m[e];if(f.buffer){var l=f.buffer,o=f.size||4,u=f.type||t.FLOAT,s=!!f.normalized,i=f.stride||0,c=f.offset||0;l.bind(),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,o,u,s,i,c)}else{if(typeof f=="number")t.vertexAttrib1f(e,f);else if(f.length===1)t.vertexAttrib1f(e,f[0]);else if(f.length===2)t.vertexAttrib2f(e,f[0],f[1]);else if(f.length===3)t.vertexAttrib3f(e,f[0],f[1],f[2]);else{if(f.length!==4)throw new Error("gl-vao: Invalid vertex attribute");t.vertexAttrib4f(e,f[0],f[1],f[2],f[3])}t.disableVertexAttribArray(e)}}for(;e<h;++e)t.disableVertexAttribArray(e)}else for(t.bindBuffer(t.ARRAY_BUFFER,null),e=0;e<h;++e)t.disableVertexAttribArray(e)}},{}],351:[function(r,I,B){var t=r("./do-bind.js");function d(m){this.gl=m,this._elements=null,this._attributes=null,this._elementsType=m.UNSIGNED_SHORT}d.prototype.bind=function(){t(this.gl,this._elements,this._attributes)},d.prototype.update=function(m,h,e){this._elements=h,this._attributes=m,this._elementsType=e||this.gl.UNSIGNED_SHORT},d.prototype.dispose=function(){},d.prototype.unbind=function(){},d.prototype.draw=function(m,h,e){e=e||0;var f=this.gl;this._elements?f.drawElements(m,h,this._elementsType,e):f.drawArrays(m,e,h)},I.exports=function(m){return new d(m)}},{"./do-bind.js":350}],352:[function(r,I,B){var t=r("./do-bind.js");function d(h,e,f,l,o,u){this.location=h,this.dimension=e,this.a=f,this.b=l,this.c=o,this.d=u}function m(h,e,f){this.gl=h,this._ext=e,this.handle=f,this._attribs=[],this._useElements=!1,this._elementsType=h.UNSIGNED_SHORT}d.prototype.bind=function(h){switch(this.dimension){case 1:h.vertexAttrib1f(this.location,this.a);break;case 2:h.vertexAttrib2f(this.location,this.a,this.b);break;case 3:h.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:h.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},m.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var h=0;h<this._attribs.length;++h)this._attribs[h].bind(this.gl)},m.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},m.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},m.prototype.update=function(h,e,f){if(this.bind(),t(this.gl,e,h),this.unbind(),this._attribs.length=0,h)for(var l=0;l<h.length;++l){var o=h[l];typeof o=="number"?this._attribs.push(new d(l,1,o)):Array.isArray(o)&&this._attribs.push(new d(l,o.length,o[0],o[1],o[2],o[3]))}this._useElements=!!e,this._elementsType=f||this.gl.UNSIGNED_SHORT},m.prototype.draw=function(h,e,f){f=f||0;var l=this.gl;this._useElements?l.drawElements(h,e,this._elementsType,f):l.drawArrays(h,f,e)},I.exports=function(h,e){return new m(h,e,e.createVertexArrayOES())}},{"./do-bind.js":350}],353:[function(r,I,B){var t=r("./lib/vao-native.js"),d=r("./lib/vao-emulated.js");function m(h){this.bindVertexArrayOES=h.bindVertexArray.bind(h),this.createVertexArrayOES=h.createVertexArray.bind(h),this.deleteVertexArrayOES=h.deleteVertexArray.bind(h)}I.exports=function(h,e,f,l){var o,u=h.createVertexArray?new m(h):h.getExtension("OES_vertex_array_object");return(o=u?t(h,u):d(h)).update(e,f,l),o}},{"./lib/vao-emulated.js":351,"./lib/vao-native.js":352}],354:[function(r,I,B){I.exports=function(t,d,m){return t[0]=d[0]+m[0],t[1]=d[1]+m[1],t[2]=d[2]+m[2],t}},{}],355:[function(r,I,B){I.exports=function(h,e){var f=t(h[0],h[1],h[2]),l=t(e[0],e[1],e[2]);d(f,f),d(l,l);var o=m(f,l);return o>1?0:Math.acos(o)};var t=r("./fromValues"),d=r("./normalize"),m=r("./dot")},{"./dot":365,"./fromValues":371,"./normalize":382}],356:[function(r,I,B){I.exports=function(t,d){return t[0]=Math.ceil(d[0]),t[1]=Math.ceil(d[1]),t[2]=Math.ceil(d[2]),t}},{}],357:[function(r,I,B){I.exports=function(t){var d=new Float32Array(3);return d[0]=t[0],d[1]=t[1],d[2]=t[2],d}},{}],358:[function(r,I,B){I.exports=function(t,d){return t[0]=d[0],t[1]=d[1],t[2]=d[2],t}},{}],359:[function(r,I,B){I.exports=function(){var t=new Float32Array(3);return t[0]=0,t[1]=0,t[2]=0,t}},{}],360:[function(r,I,B){I.exports=function(t,d,m){var h=d[0],e=d[1],f=d[2],l=m[0],o=m[1],u=m[2];return t[0]=e*u-f*o,t[1]=f*l-h*u,t[2]=h*o-e*l,t}},{}],361:[function(r,I,B){I.exports=r("./distance")},{"./distance":362}],362:[function(r,I,B){I.exports=function(t,d){var m=d[0]-t[0],h=d[1]-t[1],e=d[2]-t[2];return Math.sqrt(m*m+h*h+e*e)}},{}],363:[function(r,I,B){I.exports=r("./divide")},{"./divide":364}],364:[function(r,I,B){I.exports=function(t,d,m){return t[0]=d[0]/m[0],t[1]=d[1]/m[1],t[2]=d[2]/m[2],t}},{}],365:[function(r,I,B){I.exports=function(t,d){return t[0]*d[0]+t[1]*d[1]+t[2]*d[2]}},{}],366:[function(r,I,B){I.exports=1e-6},{}],367:[function(r,I,B){I.exports=function(d,m){var h=d[0],e=d[1],f=d[2],l=m[0],o=m[1],u=m[2];return Math.abs(h-l)<=t*Math.max(1,Math.abs(h),Math.abs(l))&&Math.abs(e-o)<=t*Math.max(1,Math.abs(e),Math.abs(o))&&Math.abs(f-u)<=t*Math.max(1,Math.abs(f),Math.abs(u))};var t=r("./epsilon")},{"./epsilon":366}],368:[function(r,I,B){I.exports=function(t,d){return t[0]===d[0]&&t[1]===d[1]&&t[2]===d[2]}},{}],369:[function(r,I,B){I.exports=function(t,d){return t[0]=Math.floor(d[0]),t[1]=Math.floor(d[1]),t[2]=Math.floor(d[2]),t}},{}],370:[function(r,I,B){I.exports=function(d,m,h,e,f,l){var o,u;for(m||(m=3),h||(h=0),u=e?Math.min(e*m+h,d.length):d.length,o=h;o<u;o+=m)t[0]=d[o],t[1]=d[o+1],t[2]=d[o+2],f(t,t,l),d[o]=t[0],d[o+1]=t[1],d[o+2]=t[2];return d};var t=r("./create")()},{"./create":359}],371:[function(r,I,B){I.exports=function(t,d,m){var h=new Float32Array(3);return h[0]=t,h[1]=d,h[2]=m,h}},{}],372:[function(r,I,B){I.exports={EPSILON:r("./epsilon"),create:r("./create"),clone:r("./clone"),angle:r("./angle"),fromValues:r("./fromValues"),copy:r("./copy"),set:r("./set"),equals:r("./equals"),exactEquals:r("./exactEquals"),add:r("./add"),subtract:r("./subtract"),sub:r("./sub"),multiply:r("./multiply"),mul:r("./mul"),divide:r("./divide"),div:r("./div"),min:r("./min"),max:r("./max"),floor:r("./floor"),ceil:r("./ceil"),round:r("./round"),scale:r("./scale"),scaleAndAdd:r("./scaleAndAdd"),distance:r("./distance"),dist:r("./dist"),squaredDistance:r("./squaredDistance"),sqrDist:r("./sqrDist"),length:r("./length"),len:r("./len"),squaredLength:r("./squaredLength"),sqrLen:r("./sqrLen"),negate:r("./negate"),inverse:r("./inverse"),normalize:r("./normalize"),dot:r("./dot"),cross:r("./cross"),lerp:r("./lerp"),random:r("./random"),transformMat4:r("./transformMat4"),transformMat3:r("./transformMat3"),transformQuat:r("./transformQuat"),rotateX:r("./rotateX"),rotateY:r("./rotateY"),rotateZ:r("./rotateZ"),forEach:r("./forEach")}},{"./add":354,"./angle":355,"./ceil":356,"./clone":357,"./copy":358,"./create":359,"./cross":360,"./dist":361,"./distance":362,"./div":363,"./divide":364,"./dot":365,"./epsilon":366,"./equals":367,"./exactEquals":368,"./floor":369,"./forEach":370,"./fromValues":371,"./inverse":373,"./len":374,"./length":375,"./lerp":376,"./max":377,"./min":378,"./mul":379,"./multiply":380,"./negate":381,"./normalize":382,"./random":383,"./rotateX":384,"./rotateY":385,"./rotateZ":386,"./round":387,"./scale":388,"./scaleAndAdd":389,"./set":390,"./sqrDist":391,"./sqrLen":392,"./squaredDistance":393,"./squaredLength":394,"./sub":395,"./subtract":396,"./transformMat3":397,"./transformMat4":398,"./transformQuat":399}],373:[function(r,I,B){I.exports=function(t,d){return t[0]=1/d[0],t[1]=1/d[1],t[2]=1/d[2],t}},{}],374:[function(r,I,B){I.exports=r("./length")},{"./length":375}],375:[function(r,I,B){I.exports=function(t){var d=t[0],m=t[1],h=t[2];return Math.sqrt(d*d+m*m+h*h)}},{}],376:[function(r,I,B){I.exports=function(t,d,m,h){var e=d[0],f=d[1],l=d[2];return t[0]=e+h*(m[0]-e),t[1]=f+h*(m[1]-f),t[2]=l+h*(m[2]-l),t}},{}],377:[function(r,I,B){I.exports=function(t,d,m){return t[0]=Math.max(d[0],m[0]),t[1]=Math.max(d[1],m[1]),t[2]=Math.max(d[2],m[2]),t}},{}],378:[function(r,I,B){I.exports=function(t,d,m){return t[0]=Math.min(d[0],m[0]),t[1]=Math.min(d[1],m[1]),t[2]=Math.min(d[2],m[2]),t}},{}],379:[function(r,I,B){I.exports=r("./multiply")},{"./multiply":380}],380:[function(r,I,B){I.exports=function(t,d,m){return t[0]=d[0]*m[0],t[1]=d[1]*m[1],t[2]=d[2]*m[2],t}},{}],381:[function(r,I,B){I.exports=function(t,d){return t[0]=-d[0],t[1]=-d[1],t[2]=-d[2],t}},{}],382:[function(r,I,B){I.exports=function(t,d){var m=d[0],h=d[1],e=d[2],f=m*m+h*h+e*e;return f>0&&(f=1/Math.sqrt(f),t[0]=d[0]*f,t[1]=d[1]*f,t[2]=d[2]*f),t}},{}],383:[function(r,I,B){I.exports=function(t,d){d=d||1;var m=2*Math.random()*Math.PI,h=2*Math.random()-1,e=Math.sqrt(1-h*h)*d;return t[0]=Math.cos(m)*e,t[1]=Math.sin(m)*e,t[2]=h*d,t}},{}],384:[function(r,I,B){I.exports=function(t,d,m,h){var e=m[1],f=m[2],l=d[1]-e,o=d[2]-f,u=Math.sin(h),s=Math.cos(h);return t[0]=d[0],t[1]=e+l*s-o*u,t[2]=f+l*u+o*s,t}},{}],385:[function(r,I,B){I.exports=function(t,d,m,h){var e=m[0],f=m[2],l=d[0]-e,o=d[2]-f,u=Math.sin(h),s=Math.cos(h);return t[0]=e+o*u+l*s,t[1]=d[1],t[2]=f+o*s-l*u,t}},{}],386:[function(r,I,B){I.exports=function(t,d,m,h){var e=m[0],f=m[1],l=d[0]-e,o=d[1]-f,u=Math.sin(h),s=Math.cos(h);return t[0]=e+l*s-o*u,t[1]=f+l*u+o*s,t[2]=d[2],t}},{}],387:[function(r,I,B){I.exports=function(t,d){return t[0]=Math.round(d[0]),t[1]=Math.round(d[1]),t[2]=Math.round(d[2]),t}},{}],388:[function(r,I,B){I.exports=function(t,d,m){return t[0]=d[0]*m,t[1]=d[1]*m,t[2]=d[2]*m,t}},{}],389:[function(r,I,B){I.exports=function(t,d,m,h){return t[0]=d[0]+m[0]*h,t[1]=d[1]+m[1]*h,t[2]=d[2]+m[2]*h,t}},{}],390:[function(r,I,B){I.exports=function(t,d,m,h){return t[0]=d,t[1]=m,t[2]=h,t}},{}],391:[function(r,I,B){I.exports=r("./squaredDistance")},{"./squaredDistance":393}],392:[function(r,I,B){I.exports=r("./squaredLength")},{"./squaredLength":394}],393:[function(r,I,B){I.exports=function(t,d){var m=d[0]-t[0],h=d[1]-t[1],e=d[2]-t[2];return m*m+h*h+e*e}},{}],394:[function(r,I,B){I.exports=function(t){var d=t[0],m=t[1],h=t[2];return d*d+m*m+h*h}},{}],395:[function(r,I,B){I.exports=r("./subtract")},{"./subtract":396}],396:[function(r,I,B){I.exports=function(t,d,m){return t[0]=d[0]-m[0],t[1]=d[1]-m[1],t[2]=d[2]-m[2],t}},{}],397:[function(r,I,B){I.exports=function(t,d,m){var h=d[0],e=d[1],f=d[2];return t[0]=h*m[0]+e*m[3]+f*m[6],t[1]=h*m[1]+e*m[4]+f*m[7],t[2]=h*m[2]+e*m[5]+f*m[8],t}},{}],398:[function(r,I,B){I.exports=function(t,d,m){var h=d[0],e=d[1],f=d[2],l=m[3]*h+m[7]*e+m[11]*f+m[15];return l=l||1,t[0]=(m[0]*h+m[4]*e+m[8]*f+m[12])/l,t[1]=(m[1]*h+m[5]*e+m[9]*f+m[13])/l,t[2]=(m[2]*h+m[6]*e+m[10]*f+m[14])/l,t}},{}],399:[function(r,I,B){I.exports=function(t,d,m){var h=d[0],e=d[1],f=d[2],l=m[0],o=m[1],u=m[2],s=m[3],i=s*h+o*f-u*e,c=s*e+u*h-l*f,n=s*f+l*e-o*h,a=-l*h-o*e-u*f;return t[0]=i*s+a*-l+c*-u-n*-o,t[1]=c*s+a*-o+n*-l-i*-u,t[2]=n*s+a*-u+i*-o-c*-l,t}},{}],400:[function(r,I,B){I.exports=function(t,d,m){return t[0]=d[0]+m[0],t[1]=d[1]+m[1],t[2]=d[2]+m[2],t[3]=d[3]+m[3],t}},{}],401:[function(r,I,B){I.exports=function(t){var d=new Float32Array(4);return d[0]=t[0],d[1]=t[1],d[2]=t[2],d[3]=t[3],d}},{}],402:[function(r,I,B){I.exports=function(t,d){return t[0]=d[0],t[1]=d[1],t[2]=d[2],t[3]=d[3],t}},{}],403:[function(r,I,B){I.exports=function(){var t=new Float32Array(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}},{}],404:[function(r,I,B){I.exports=function(t,d){var m=d[0]-t[0],h=d[1]-t[1],e=d[2]-t[2],f=d[3]-t[3];return Math.sqrt(m*m+h*h+e*e+f*f)}},{}],405:[function(r,I,B){I.exports=function(t,d,m){return t[0]=d[0]/m[0],t[1]=d[1]/m[1],t[2]=d[2]/m[2],t[3]=d[3]/m[3],t}},{}],406:[function(r,I,B){I.exports=function(t,d){return t[0]*d[0]+t[1]*d[1]+t[2]*d[2]+t[3]*d[3]}},{}],407:[function(r,I,B){I.exports=function(t,d,m,h){var e=new Float32Array(4);return e[0]=t,e[1]=d,e[2]=m,e[3]=h,e}},{}],408:[function(r,I,B){I.exports={create:r("./create"),clone:r("./clone"),fromValues:r("./fromValues"),copy:r("./copy"),set:r("./set"),add:r("./add"),subtract:r("./subtract"),multiply:r("./multiply"),divide:r("./divide"),min:r("./min"),max:r("./max"),scale:r("./scale"),scaleAndAdd:r("./scaleAndAdd"),distance:r("./distance"),squaredDistance:r("./squaredDistance"),length:r("./length"),squaredLength:r("./squaredLength"),negate:r("./negate"),inverse:r("./inverse"),normalize:r("./normalize"),dot:r("./dot"),lerp:r("./lerp"),random:r("./random"),transformMat4:r("./transformMat4"),transformQuat:r("./transformQuat")}},{"./add":400,"./clone":401,"./copy":402,"./create":403,"./distance":404,"./divide":405,"./dot":406,"./fromValues":407,"./inverse":409,"./length":410,"./lerp":411,"./max":412,"./min":413,"./multiply":414,"./negate":415,"./normalize":416,"./random":417,"./scale":418,"./scaleAndAdd":419,"./set":420,"./squaredDistance":421,"./squaredLength":422,"./subtract":423,"./transformMat4":424,"./transformQuat":425}],409:[function(r,I,B){I.exports=function(t,d){return t[0]=1/d[0],t[1]=1/d[1],t[2]=1/d[2],t[3]=1/d[3],t}},{}],410:[function(r,I,B){I.exports=function(t){var d=t[0],m=t[1],h=t[2],e=t[3];return Math.sqrt(d*d+m*m+h*h+e*e)}},{}],411:[function(r,I,B){I.exports=function(t,d,m,h){var e=d[0],f=d[1],l=d[2],o=d[3];return t[0]=e+h*(m[0]-e),t[1]=f+h*(m[1]-f),t[2]=l+h*(m[2]-l),t[3]=o+h*(m[3]-o),t}},{}],412:[function(r,I,B){I.exports=function(t,d,m){return t[0]=Math.max(d[0],m[0]),t[1]=Math.max(d[1],m[1]),t[2]=Math.max(d[2],m[2]),t[3]=Math.max(d[3],m[3]),t}},{}],413:[function(r,I,B){I.exports=function(t,d,m){return t[0]=Math.min(d[0],m[0]),t[1]=Math.min(d[1],m[1]),t[2]=Math.min(d[2],m[2]),t[3]=Math.min(d[3],m[3]),t}},{}],414:[function(r,I,B){I.exports=function(t,d,m){return t[0]=d[0]*m[0],t[1]=d[1]*m[1],t[2]=d[2]*m[2],t[3]=d[3]*m[3],t}},{}],415:[function(r,I,B){I.exports=function(t,d){return t[0]=-d[0],t[1]=-d[1],t[2]=-d[2],t[3]=-d[3],t}},{}],416:[function(r,I,B){I.exports=function(t,d){var m=d[0],h=d[1],e=d[2],f=d[3],l=m*m+h*h+e*e+f*f;return l>0&&(l=1/Math.sqrt(l),t[0]=m*l,t[1]=h*l,t[2]=e*l,t[3]=f*l),t}},{}],417:[function(r,I,B){var t=r("./normalize"),d=r("./scale");I.exports=function(m,h){return h=h||1,m[0]=Math.random(),m[1]=Math.random(),m[2]=Math.random(),m[3]=Math.random(),t(m,m),d(m,m,h),m}},{"./normalize":416,"./scale":418}],418:[function(r,I,B){I.exports=function(t,d,m){return t[0]=d[0]*m,t[1]=d[1]*m,t[2]=d[2]*m,t[3]=d[3]*m,t}},{}],419:[function(r,I,B){I.exports=function(t,d,m,h){return t[0]=d[0]+m[0]*h,t[1]=d[1]+m[1]*h,t[2]=d[2]+m[2]*h,t[3]=d[3]+m[3]*h,t}},{}],420:[function(r,I,B){I.exports=function(t,d,m,h,e){return t[0]=d,t[1]=m,t[2]=h,t[3]=e,t}},{}],421:[function(r,I,B){I.exports=function(t,d){var m=d[0]-t[0],h=d[1]-t[1],e=d[2]-t[2],f=d[3]-t[3];return m*m+h*h+e*e+f*f}},{}],422:[function(r,I,B){I.exports=function(t){var d=t[0],m=t[1],h=t[2],e=t[3];return d*d+m*m+h*h+e*e}},{}],423:[function(r,I,B){I.exports=function(t,d,m){return t[0]=d[0]-m[0],t[1]=d[1]-m[1],t[2]=d[2]-m[2],t[3]=d[3]-m[3],t}},{}],424:[function(r,I,B){I.exports=function(t,d,m){var h=d[0],e=d[1],f=d[2],l=d[3];return t[0]=m[0]*h+m[4]*e+m[8]*f+m[12]*l,t[1]=m[1]*h+m[5]*e+m[9]*f+m[13]*l,t[2]=m[2]*h+m[6]*e+m[10]*f+m[14]*l,t[3]=m[3]*h+m[7]*e+m[11]*f+m[15]*l,t}},{}],425:[function(r,I,B){I.exports=function(t,d,m){var h=d[0],e=d[1],f=d[2],l=m[0],o=m[1],u=m[2],s=m[3],i=s*h+o*f-u*e,c=s*e+u*h-l*f,n=s*f+l*e-o*h,a=-l*h-o*e-u*f;return t[0]=i*s+a*-l+c*-u-n*-o,t[1]=c*s+a*-o+n*-l-i*-u,t[2]=n*s+a*-u+i*-o-c*-l,t[3]=d[3],t}},{}],426:[function(r,I,B){var t=r("glsl-tokenizer"),d=r("atob-lite");I.exports=function(m){for(var h=Array.isArray(m)?m:t(m),e=0;e<h.length;e++){var f=h[e];if(f.type==="preprocessor"){var l=f.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(l&&l[2]){var o=l[1],u=l[2];return(o?d(u):u).trim()}}}}},{"atob-lite":84,"glsl-tokenizer":433}],427:[function(r,I,B){I.exports=function(l){var o,u,s,i=0,c=0,n=999,a=[],g=[],p=1,y=0,v=0,b=!1,x=!1,T="",A=m,S=t;(l=l||{}).version==="300 es"&&(A=e,S=h);var w={},E={};for(i=0;i<A.length;i++)w[A[i]]=!0;for(i=0;i<S.length;i++)E[S[i]]=!0;return function(H){return g=[],H!==null?function(Y){i=0,Y.toString&&(Y=Y.toString());var $;for(T+=Y.replace(/\r\n/g,`
`),s=T.length;o=T[i],i<s;){switch($=i,n){case 0:i=D();break;case 1:case 2:i=P();break;case 3:i=N();break;case 4:i=X();break;case 11:i=G();break;case 5:i=K();break;case 9999:i=Z();break;case 9:i=M();break;case 999:i=L()}if($!==i)switch(T[$]){case`
`:y=0,++p;break;default:++y}}return c+=i,T=T.slice(i),g}(H):function(Y){return a.length&&k(a.join("")),n=10,k("(eof)"),g}()};function k(H){H.length&&g.push({type:f[n],data:H,position:v,line:p,column:y})}function L(){return a=a.length?[]:a,u==="/"&&o==="*"?(v=c+i-1,n=0,u=o,i+1):u==="/"&&o==="/"?(v=c+i-1,n=1,u=o,i+1):o==="#"?(n=2,v=c+i,i):/\s/.test(o)?(n=9,v=c+i,i):(b=/\d/.test(o),x=/[^\w_]/.test(o),v=c+i,n=b?4:x?3:9999,i)}function M(){return/[^\s]/g.test(o)?(k(a.join("")),n=999,i):(a.push(o),u=o,i+1)}function P(){return o!=="\r"&&o!==`
`||u==="\\"?(a.push(o),u=o,i+1):(k(a.join("")),n=999,i)}function D(){return o==="/"&&u==="*"?(a.push(o),k(a.join("")),n=999,i+1):(a.push(o),u=o,i+1)}function N(){if(u==="."&&/\d/.test(o))return n=5,i;if(u==="/"&&o==="*")return n=0,i;if(u==="/"&&o==="/")return n=1,i;if(o==="."&&a.length){for(;U(a););return n=5,i}if(o===";"||o===")"||o==="("){if(a.length)for(;U(a););return k(o),n=999,i+1}var H=a.length===2&&o!=="=";if(/[\w_\d\s]/.test(o)||H){for(;U(a););return n=999,i}return a.push(o),u=o,i+1}function U(H){for(var Y,$,z=0;;){if(Y=d.indexOf(H.slice(0,H.length+z).join("")),$=d[Y],Y===-1){if(z--+H.length>0)continue;$=H.slice(0,1).join("")}return k($),v+=$.length,(a=a.slice($.length)).length}}function G(){return/[^a-fA-F0-9]/.test(o)?(k(a.join("")),n=999,i):(a.push(o),u=o,i+1)}function X(){return o==="."||/[eE]/.test(o)?(a.push(o),n=5,u=o,i+1):o==="x"&&a.length===1&&a[0]==="0"?(n=11,a.push(o),u=o,i+1):/[^\d]/.test(o)?(k(a.join("")),n=999,i):(a.push(o),u=o,i+1)}function K(){return o==="f"&&(a.push(o),u=o,i+=1),/[eE]/.test(o)?(a.push(o),u=o,i+1):(o!=="-"&&o!=="+"||!/[eE]/.test(u))&&/[^\d]/.test(o)?(k(a.join("")),n=999,i):(a.push(o),u=o,i+1)}function Z(){if(/[^\d\w_]/.test(o)){var H=a.join("");return n=E[H]?8:w[H]?7:6,k(a.join("")),n=999,i}return a.push(o),u=o,i+1}};var t=r("./lib/literals"),d=r("./lib/operators"),m=r("./lib/builtins"),h=r("./lib/literals-300es"),e=r("./lib/builtins-300es"),f=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":429,"./lib/builtins-300es":428,"./lib/literals":431,"./lib/literals-300es":430,"./lib/operators":432}],428:[function(r,I,B){var t=r("./builtins");t=t.slice().filter(function(d){return!/^(gl\_|texture)/.test(d)}),I.exports=t.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":429}],429:[function(r,I,B){I.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],430:[function(r,I,B){var t=r("./literals");I.exports=t.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":431}],431:[function(r,I,B){I.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],432:[function(r,I,B){I.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],433:[function(r,I,B){var t=r("./index");I.exports=function(d,m){var h=t(m),e=[];return e=(e=e.concat(h(d))).concat(h(null))}},{"./index":427}],434:[function(r,I,B){arguments[4][268][0].apply(B,arguments)},{dup:268}],435:[function(r,I,B){(function(t){(function(){var d,m=r("is-browser");d=typeof t.matchMedia=="function"?!t.matchMedia("(hover: none)").matches:m,I.exports=d}).call(this)}).call(this,typeof vi!="undefined"?vi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"is-browser":442}],436:[function(r,I,B){var t=r("is-browser");I.exports=t&&function(){var d=!1;try{var m=Object.defineProperty({},"passive",{get:function(){d=!0}});window.addEventListener("test",null,m),window.removeEventListener("test",null,m)}catch(h){d=!1}return d}()},{"is-browser":442}],437:[function(r,I,B){B.read=function(t,d,m,h,e){var f,l,o=8*e-h-1,u=(1<<o)-1,s=u>>1,i=-7,c=m?e-1:0,n=m?-1:1,a=t[d+c];for(c+=n,f=a&(1<<-i)-1,a>>=-i,i+=o;i>0;f=256*f+t[d+c],c+=n,i-=8);for(l=f&(1<<-i)-1,f>>=-i,i+=h;i>0;l=256*l+t[d+c],c+=n,i-=8);if(f===0)f=1-s;else{if(f===u)return l?NaN:1/0*(a?-1:1);l+=Math.pow(2,h),f-=s}return(a?-1:1)*l*Math.pow(2,f-h)},B.write=function(t,d,m,h,e,f){var l,o,u,s=8*f-e-1,i=(1<<s)-1,c=i>>1,n=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,a=h?0:f-1,g=h?1:-1,p=d<0||d===0&&1/d<0?1:0;for(d=Math.abs(d),isNaN(d)||d===1/0?(o=isNaN(d)?1:0,l=i):(l=Math.floor(Math.log(d)/Math.LN2),d*(u=Math.pow(2,-l))<1&&(l--,u*=2),(d+=l+c>=1?n/u:n*Math.pow(2,1-c))*u>=2&&(l++,u/=2),l+c>=i?(o=0,l=i):l+c>=1?(o=(d*u-1)*Math.pow(2,e),l+=c):(o=d*Math.pow(2,c-1)*Math.pow(2,e),l=0));e>=8;t[m+a]=255&o,a+=g,o/=256,e-=8);for(l=l<<e|o,s+=e;s>0;t[m+a]=255&l,a+=g,l/=256,s-=8);t[m+a-g]|=128*p}},{}],438:[function(r,I,B){I.exports=function(u,s){var i=u.length;if(i===0)throw new Error("Must have at least d+1 points");var c=u[0].length;if(i<=c)throw new Error("Must input at least d+1 points");var n=u.slice(0,c+1),a=t.apply(void 0,n);if(a===0)throw new Error("Input not in general position");for(var g=new Array(c+1),p=0;p<=c;++p)g[p]=p;a<0&&(g[0]=1,g[1]=0);var y=new m(g,new Array(c+1),!1),v=y.adjacent,b=new Array(c+2);for(p=0;p<=c;++p){for(var x=g.slice(),T=0;T<=c;++T)T===p&&(x[T]=-1);var A=x[0];x[0]=x[1],x[1]=A;var S=new m(x,new Array(c+1),!0);v[p]=S,b[p]=S}for(b[c+1]=y,p=0;p<=c;++p){x=v[p].vertices;var w=v[p].adjacent;for(T=0;T<=c;++T){var E=x[T];if(E<0)w[T]=y;else for(var k=0;k<=c;++k)v[k].vertices.indexOf(E)<0&&(w[T]=v[k])}}var L=new l(c,n,b),M=!!s;for(p=c+1;p<i;++p)L.insert(u[p],M);return L.boundary()};var t=r("robust-orientation"),d=r("simplicial-complex").compareCells;function m(u,s,i){this.vertices=u,this.adjacent=s,this.boundary=i,this.lastVisited=-1}function h(u,s,i){this.vertices=u,this.cell=s,this.index=i}function e(u,s){return d(u.vertices,s.vertices)}m.prototype.flip=function(){var u=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=u;var s=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=s};var f=[];function l(u,s,i){this.dimension=u,this.vertices=s,this.simplices=i,this.interior=i.filter(function(g){return!g.boundary}),this.tuple=new Array(u+1);for(var c=0;c<=u;++c)this.tuple[c]=this.vertices[c];var n,a=f[u];a||(a=f[u]=((n=t[u+1])||(n=t),function(g){return function(){var p=this.tuple;return g.apply(this,p)}}(n))),this.orient=a}var o=l.prototype;o.handleBoundaryDegeneracy=function(u,s){var i=this.dimension,c=this.vertices.length-1,n=this.tuple,a=this.vertices,g=[u];for(u.lastVisited=-c;g.length>0;)for(var p=(u=g.pop()).adjacent,y=0;y<=i;++y){var v=p[y];if(v.boundary&&!(v.lastVisited<=-c)){for(var b=v.vertices,x=0;x<=i;++x){var T=b[x];n[x]=T<0?s:a[T]}var A=this.orient();if(A>0)return v;v.lastVisited=-c,A===0&&g.push(v)}}return null},o.walk=function(u,s){var i=this.vertices.length-1,c=this.dimension,n=this.vertices,a=this.tuple,g=s?this.interior.length*Math.random()|0:this.interior.length-1,p=this.interior[g];e:for(;!p.boundary;){for(var y=p.vertices,v=p.adjacent,b=0;b<=c;++b)a[b]=n[y[b]];for(p.lastVisited=i,b=0;b<=c;++b){var x=v[b];if(!(x.lastVisited>=i)){var T=a[b];a[b]=u;var A=this.orient();if(a[b]=T,A<0){p=x;continue e}x.boundary?x.lastVisited=-i:x.lastVisited=i}}return}return p},o.addPeaks=function(u,s){var i=this.vertices.length-1,c=this.dimension,n=this.vertices,a=this.tuple,g=this.interior,p=this.simplices,y=[s];s.lastVisited=i,s.vertices[s.vertices.indexOf(-1)]=i,s.boundary=!1,g.push(s);for(var v=[];y.length>0;){var b=(s=y.pop()).vertices,x=s.adjacent,T=b.indexOf(i);if(!(T<0)){for(var A=0;A<=c;++A)if(A!==T){var S=x[A];if(S.boundary&&!(S.lastVisited>=i)){var w=S.vertices;if(S.lastVisited!==-i){for(var E=0,k=0;k<=c;++k)w[k]<0?(E=k,a[k]=u):a[k]=n[w[k]];if(this.orient()>0){w[E]=i,S.boundary=!1,g.push(S),y.push(S),S.lastVisited=i;continue}S.lastVisited=-i}var L=S.adjacent,M=b.slice(),P=x.slice(),D=new m(M,P,!0);p.push(D);var N=L.indexOf(s);if(!(N<0))for(L[N]=D,P[T]=S,M[A]=-1,P[A]=s,x[A]=D,D.flip(),k=0;k<=c;++k){var U=M[k];if(!(U<0||U===i)){for(var G=new Array(c-1),X=0,K=0;K<=c;++K){var Z=M[K];Z<0||K===k||(G[X++]=Z)}v.push(new h(G,D,k))}}}}}}for(v.sort(e),A=0;A+1<v.length;A+=2){var H=v[A],Y=v[A+1],$=H.index,z=Y.index;$<0||z<0||(H.cell.adjacent[H.index]=Y.cell,Y.cell.adjacent[Y.index]=H.cell)}},o.insert=function(u,s){var i=this.vertices;i.push(u);var c=this.walk(u,s);if(c){for(var n=this.dimension,a=this.tuple,g=0;g<=n;++g){var p=c.vertices[g];a[g]=p<0?u:i[p]}var y=this.orient(a);y<0||(y!==0||(c=this.handleBoundaryDegeneracy(c,u)))&&this.addPeaks(u,c)}},o.boundary=function(){for(var u=this.dimension,s=[],i=this.simplices,c=i.length,n=0;n<c;++n){var a=i[n];if(a.boundary){for(var g=new Array(u),p=a.vertices,y=0,v=0,b=0;b<=u;++b)p[b]>=0?g[y++]=p[b]:v=1&b;if(v===(1&u)){var x=g[0];g[0]=g[1],g[1]=x}s.push(g)}}return s}},{"robust-orientation":534,"simplicial-complex":545}],439:[function(r,I,B){typeof Object.create=="function"?I.exports=function(t,d){d&&(t.super_=d,t.prototype=Object.create(d.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:I.exports=function(t,d){if(d){t.super_=d;var m=function(){};m.prototype=d.prototype,t.prototype=new m,t.prototype.constructor=t}}},{}],440:[function(r,I,B){var t=r("binary-search-bounds");function d(y,v,b,x,T){this.mid=y,this.left=v,this.right=b,this.leftPoints=x,this.rightPoints=T,this.count=(v?v.count:0)+(b?b.count:0)+x.length}I.exports=function(y){return!y||y.length===0?new g(null):new g(a(y))};var m=d.prototype;function h(y,v){y.mid=v.mid,y.left=v.left,y.right=v.right,y.leftPoints=v.leftPoints,y.rightPoints=v.rightPoints,y.count=v.count}function e(y,v){var b=a(v);y.mid=b.mid,y.left=b.left,y.right=b.right,y.leftPoints=b.leftPoints,y.rightPoints=b.rightPoints,y.count=b.count}function f(y,v){var b=y.intervals([]);b.push(v),e(y,b)}function l(y,v){var b=y.intervals([]),x=b.indexOf(v);return x<0?0:(b.splice(x,1),e(y,b),1)}function o(y,v,b){for(var x=0;x<y.length&&y[x][0]<=v;++x){var T=b(y[x]);if(T)return T}}function u(y,v,b){for(var x=y.length-1;x>=0&&y[x][1]>=v;--x){var T=b(y[x]);if(T)return T}}function s(y,v){for(var b=0;b<y.length;++b){var x=v(y[b]);if(x)return x}}function i(y,v){return y-v}function c(y,v){var b=y[0]-v[0];return b||y[1]-v[1]}function n(y,v){var b=y[1]-v[1];return b||y[0]-v[0]}function a(y){if(y.length===0)return null;for(var v=[],b=0;b<y.length;++b)v.push(y[b][0],y[b][1]);v.sort(i);var x=v[v.length>>1],T=[],A=[],S=[];for(b=0;b<y.length;++b){var w=y[b];w[1]<x?T.push(w):x<w[0]?A.push(w):S.push(w)}var E=S,k=S.slice();return E.sort(c),k.sort(n),new d(x,a(T),a(A),E,k)}function g(y){this.root=y}m.intervals=function(y){return y.push.apply(y,this.leftPoints),this.left&&this.left.intervals(y),this.right&&this.right.intervals(y),y},m.insert=function(y){var v=this.count-this.leftPoints.length;if(this.count+=1,y[1]<this.mid)this.left?4*(this.left.count+1)>3*(v+1)?f(this,y):this.left.insert(y):this.left=a([y]);else if(y[0]>this.mid)this.right?4*(this.right.count+1)>3*(v+1)?f(this,y):this.right.insert(y):this.right=a([y]);else{var b=t.ge(this.leftPoints,y,c),x=t.ge(this.rightPoints,y,n);this.leftPoints.splice(b,0,y),this.rightPoints.splice(x,0,y)}},m.remove=function(y){var v=this.count-this.leftPoints;if(y[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(v-1)?l(this,y):(A=this.left.remove(y))===2?(this.left=null,this.count-=1,1):(A===1&&(this.count-=1),A):0;if(y[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(v-1)?l(this,y):(A=this.right.remove(y))===2?(this.right=null,this.count-=1,1):(A===1&&(this.count-=1),A):0;if(this.count===1)return this.leftPoints[0]===y?2:0;if(this.leftPoints.length===1&&this.leftPoints[0]===y){if(this.left&&this.right){for(var b=this,x=this.left;x.right;)b=x,x=x.right;if(b===this)x.right=this.right;else{var T=this.left,A=this.right;b.count-=x.count,b.right=x.left,x.left=T,x.right=A}h(this,x),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?h(this,this.left):h(this,this.right);return 1}for(T=t.ge(this.leftPoints,y,c);T<this.leftPoints.length&&this.leftPoints[T][0]===y[0];++T)if(this.leftPoints[T]===y){for(this.count-=1,this.leftPoints.splice(T,1),A=t.ge(this.rightPoints,y,n);A<this.rightPoints.length&&this.rightPoints[A][1]===y[1];++A)if(this.rightPoints[A]===y)return this.rightPoints.splice(A,1),1}return 0},m.queryPoint=function(y,v){if(y<this.mid)return this.left&&(b=this.left.queryPoint(y,v))?b:o(this.leftPoints,y,v);if(y>this.mid){var b;return this.right&&(b=this.right.queryPoint(y,v))?b:u(this.rightPoints,y,v)}return s(this.leftPoints,v)},m.queryInterval=function(y,v,b){var x;return y<this.mid&&this.left&&(x=this.left.queryInterval(y,v,b))||v>this.mid&&this.right&&(x=this.right.queryInterval(y,v,b))?x:v<this.mid?o(this.leftPoints,v,b):y>this.mid?u(this.rightPoints,y,b):s(this.leftPoints,b)};var p=g.prototype;p.insert=function(y){this.root?this.root.insert(y):this.root=new d(y[0],null,null,[y],[y])},p.remove=function(y){if(this.root){var v=this.root.remove(y);return v===2&&(this.root=null),v!==0}return!1},p.queryPoint=function(y,v){if(this.root)return this.root.queryPoint(y,v)},p.queryInterval=function(y,v,b){if(y<=v&&this.root)return this.root.queryInterval(y,v,b)},Object.defineProperty(p,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(p,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":103}],441:[function(r,I,B){I.exports=function(t){for(var d=new Array(t),m=0;m<t;++m)d[m]=m;return d}},{}],442:[function(r,I,B){I.exports=!0},{}],443:[function(r,I,B){function t(d){return!!d.constructor&&typeof d.constructor.isBuffer=="function"&&d.constructor.isBuffer(d)}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */I.exports=function(d){return d!=null&&(t(d)||function(m){return typeof m.readFloatLE=="function"&&typeof m.slice=="function"&&t(m.slice(0,0))}(d)||!!d._isBuffer)}},{}],444:[function(r,I,B){I.exports=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],445:[function(r,I,B){I.exports=m,I.exports.isMobile=m,I.exports.default=m;var t=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,d=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function m(h){h||(h={});var e=h.ua;if(e||typeof navigator=="undefined"||(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var f=h.tablet?d.test(e):t.test(e);return!f&&h.tablet&&h.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(f=!0),f}},{}],446:[function(r,I,B){I.exports=function(t){var d=typeof t;return t!==null&&(d==="object"||d==="function")}},{}],447:[function(r,I,B){var t=Object.prototype.toString;I.exports=function(d){var m;return t.call(d)==="[object Object]"&&((m=Object.getPrototypeOf(d))===null||m===Object.getPrototypeOf({}))}},{}],448:[function(r,I,B){I.exports=function(t){for(var d,m=t.length,h=0;h<m;h++)if(((d=t.charCodeAt(h))<9||d>13)&&d!==32&&d!==133&&d!==160&&d!==5760&&d!==6158&&(d<8192||d>8205)&&d!==8232&&d!==8233&&d!==8239&&d!==8287&&d!==8288&&d!==12288&&d!==65279)return!1;return!0}},{}],449:[function(r,I,B){I.exports=function(t){return typeof t=="string"&&(t=t.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(t)&&/[\dz]$/i.test(t)&&t.length>4))}},{}],450:[function(r,I,B){I.exports=function(t,d,m){return t*(1-m)+d*m}},{}],451:[function(r,I,B){(function(t,d){typeof B=="object"&&I!==void 0?I.exports=d():(t=t||self).mapboxgl=d()})(this,function(){var t,d,m;function h(e,f){if(t)if(d){var l="var sharedChunk = {}; ("+t+")(sharedChunk); ("+d+")(sharedChunk);",o={};t(o),(m=f(o)).workerUrl=window.URL.createObjectURL(new Blob([l],{type:"text/javascript"}))}else d=f;else t=f}return h(0,function(e){function f(_,O){return _(O={exports:{}},O.exports),O.exports}var l=o;function o(_,O,q,re){this.cx=3*_,this.bx=3*(q-_)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*O,this.by=3*(re-O)-this.cy,this.ay=1-this.cy-this.by,this.p1x=_,this.p1y=re,this.p2x=q,this.p2y=re}o.prototype.sampleCurveX=function(_){return((this.ax*_+this.bx)*_+this.cx)*_},o.prototype.sampleCurveY=function(_){return((this.ay*_+this.by)*_+this.cy)*_},o.prototype.sampleCurveDerivativeX=function(_){return(3*this.ax*_+2*this.bx)*_+this.cx},o.prototype.solveCurveX=function(_,O){var q,re,fe,me,Ae;for(O===void 0&&(O=1e-6),fe=_,Ae=0;Ae<8;Ae++){if(me=this.sampleCurveX(fe)-_,Math.abs(me)<O)return fe;var De=this.sampleCurveDerivativeX(fe);if(Math.abs(De)<1e-6)break;fe-=me/De}if((fe=_)<(q=0))return q;if(fe>(re=1))return re;for(;q<re;){if(me=this.sampleCurveX(fe),Math.abs(me-_)<O)return fe;_>me?q=fe:re=fe,fe=.5*(re-q)+q}return fe},o.prototype.solve=function(_,O){return this.sampleCurveY(this.solveCurveX(_,O))};var u=s;function s(_,O){this.x=_,this.y=O}function i(_,O,q,re){var fe=new l(_,O,q,re);return function(me){return fe.solve(me)}}s.prototype={clone:function(){return new s(this.x,this.y)},add:function(_){return this.clone()._add(_)},sub:function(_){return this.clone()._sub(_)},multByPoint:function(_){return this.clone()._multByPoint(_)},divByPoint:function(_){return this.clone()._divByPoint(_)},mult:function(_){return this.clone()._mult(_)},div:function(_){return this.clone()._div(_)},rotate:function(_){return this.clone()._rotate(_)},rotateAround:function(_,O){return this.clone()._rotateAround(_,O)},matMult:function(_){return this.clone()._matMult(_)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(_){return this.x===_.x&&this.y===_.y},dist:function(_){return Math.sqrt(this.distSqr(_))},distSqr:function(_){var O=_.x-this.x,q=_.y-this.y;return O*O+q*q},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(_){return Math.atan2(this.y-_.y,this.x-_.x)},angleWith:function(_){return this.angleWithSep(_.x,_.y)},angleWithSep:function(_,O){return Math.atan2(this.x*O-this.y*_,this.x*_+this.y*O)},_matMult:function(_){var O=_[0]*this.x+_[1]*this.y,q=_[2]*this.x+_[3]*this.y;return this.x=O,this.y=q,this},_add:function(_){return this.x+=_.x,this.y+=_.y,this},_sub:function(_){return this.x-=_.x,this.y-=_.y,this},_mult:function(_){return this.x*=_,this.y*=_,this},_div:function(_){return this.x/=_,this.y/=_,this},_multByPoint:function(_){return this.x*=_.x,this.y*=_.y,this},_divByPoint:function(_){return this.x/=_.x,this.y/=_.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var _=this.y;return this.y=this.x,this.x=-_,this},_rotate:function(_){var O=Math.cos(_),q=Math.sin(_),re=O*this.x-q*this.y,fe=q*this.x+O*this.y;return this.x=re,this.y=fe,this},_rotateAround:function(_,O){var q=Math.cos(_),re=Math.sin(_),fe=O.x+q*(this.x-O.x)-re*(this.y-O.y),me=O.y+re*(this.x-O.x)+q*(this.y-O.y);return this.x=fe,this.y=me,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},s.convert=function(_){return _ instanceof s?_:Array.isArray(_)?new s(_[0],_[1]):_};var c=i(.25,.1,.25,1);function n(_,O,q){return Math.min(q,Math.max(O,_))}function a(_,O,q){var re=q-O,fe=((_-O)%re+re)%re+O;return fe===O?q:fe}function g(_){for(var O=[],q=arguments.length-1;q-- >0;)O[q]=arguments[q+1];for(var re=0,fe=O;re<fe.length;re+=1){var me=fe[re];for(var Ae in me)_[Ae]=me[Ae]}return _}var p=1;function y(){return p++}function v(){return function _(O){return O?(O^16*Math.random()>>O/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,_)}()}function b(_){return!!_&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(_)}function x(_,O){_.forEach(function(q){O[q]&&(O[q]=O[q].bind(O))})}function T(_,O){return _.indexOf(O,_.length-O.length)!==-1}function A(_,O,q){var re={};for(var fe in _)re[fe]=O.call(q||this,_[fe],fe,_);return re}function S(_,O,q){var re={};for(var fe in _)O.call(q||this,_[fe],fe,_)&&(re[fe]=_[fe]);return re}function w(_){return Array.isArray(_)?_.map(w):typeof _=="object"&&_?A(_,w):_}var E={};function k(_){E[_]||(typeof console!="undefined"&&console.warn(_),E[_]=!0)}function L(_,O,q){return(q.y-_.y)*(O.x-_.x)>(O.y-_.y)*(q.x-_.x)}function M(_){for(var O=0,q=0,re=_.length,fe=re-1,me=void 0,Ae=void 0;q<re;fe=q++)me=_[q],O+=((Ae=_[fe]).x-me.x)*(me.y+Ae.y);return O}function P(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function D(_){var O={};if(_.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(re,fe,me,Ae){var De=me||Ae;return O[fe]=!De||De.toLowerCase(),""}),O["max-age"]){var q=parseInt(O["max-age"],10);isNaN(q)?delete O["max-age"]:O["max-age"]=q}return O}var N=null;function U(_){if(N==null){var O=_.navigator?_.navigator.userAgent:null;N=!!_.safari||!(!O||!(/\b(iPad|iPhone|iPod)\b/.test(O)||O.match("Safari")&&!O.match("Chrome")))}return N}function G(_){try{var O=self[_];return O.setItem("_mapbox_test_",1),O.removeItem("_mapbox_test_"),!0}catch(q){return!1}}var X,K,Z,H,Y=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),$=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,z=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,j={now:Y,frame:function(_){var O=$(_);return{cancel:function(){return z(O)}}},getImageData:function(_,O){O===void 0&&(O=0);var q=self.document.createElement("canvas"),re=q.getContext("2d");if(!re)throw new Error("failed to create canvas 2d context");return q.width=_.width,q.height=_.height,re.drawImage(_,0,0,_.width,_.height),re.getImageData(-O,-O,_.width+2*O,_.height+2*O)},resolveURL:function(_){return X||(X=self.document.createElement("a")),X.href=_,X.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(K==null&&(K=self.matchMedia("(prefers-reduced-motion: reduce)")),K.matches)}},W={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ee={supported:!1,testSupport:function(_){J||!H||(Q?te(_):Z=_)}},J=!1,Q=!1;function te(_){var O=_.createTexture();_.bindTexture(_.TEXTURE_2D,O);try{if(_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,H),_.isContextLost())return;ee.supported=!0}catch(q){}_.deleteTexture(O),J=!0}self.document&&((H=self.document.createElement("img")).onload=function(){Z&&te(Z),Z=null,Q=!0},H.onerror=function(){J=!0,Z=null},H.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ie="01",ae=function(_,O){this._transformRequestFn=_,this._customAccessToken=O,this._createSkuToken()};function he(_){return _.indexOf("mapbox:")===0}ae.prototype._createSkuToken=function(){var _=function(){for(var O="",q=0;q<10;q++)O+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ie,O].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=_.token,this._skuTokenExpiresAt=_.tokenExpiresAt},ae.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ae.prototype.transformRequest=function(_,O){return this._transformRequestFn&&this._transformRequestFn(_,O)||{url:_}},ae.prototype.normalizeStyleURL=function(_,O){if(!he(_))return _;var q=ve(_);return q.path="/styles/v1"+q.path,this._makeAPIURL(q,this._customAccessToken||O)},ae.prototype.normalizeGlyphsURL=function(_,O){if(!he(_))return _;var q=ve(_);return q.path="/fonts/v1"+q.path,this._makeAPIURL(q,this._customAccessToken||O)},ae.prototype.normalizeSourceURL=function(_,O){if(!he(_))return _;var q=ve(_);return q.path="/v4/"+q.authority+".json",q.params.push("secure"),this._makeAPIURL(q,this._customAccessToken||O)},ae.prototype.normalizeSpriteURL=function(_,O,q,re){var fe=ve(_);return he(_)?(fe.path="/styles/v1"+fe.path+"/sprite"+O+q,this._makeAPIURL(fe,this._customAccessToken||re)):(fe.path+=""+O+q,ke(fe))},ae.prototype.normalizeTileURL=function(_,O){if(this._isSkuTokenExpired()&&this._createSkuToken(),_&&!he(_))return _;var q=ve(_),re=j.devicePixelRatio>=2||O===512?"@2x":"",fe=ee.supported?".webp":"$1";q.path=q.path.replace(/(\.(png|jpg)\d*)(?=$)/,""+re+fe),q.path=q.path.replace(/^.+\/v4\//,"/"),q.path="/v4"+q.path;var me=this._customAccessToken||function(Ae){for(var De=0,Ze=Ae;De<Ze.length;De+=1){var ut=Ze[De].match(/^access_token=(.*)$/);if(ut)return ut[1]}return null}(q.params)||W.ACCESS_TOKEN;return W.REQUIRE_ACCESS_TOKEN&&me&&this._skuToken&&q.params.push("sku="+this._skuToken),this._makeAPIURL(q,me)},ae.prototype.canonicalizeTileURL=function(_,O){var q=ve(_);if(!q.path.match(/(^\/v4\/)/)||!q.path.match(/\.[\w]+$/))return _;var re="mapbox://tiles/";re+=q.path.replace("/v4/","");var fe=q.params;return O&&(fe=fe.filter(function(me){return!me.match(/^access_token=/)})),fe.length&&(re+="?"+fe.join("&")),re},ae.prototype.canonicalizeTileset=function(_,O){for(var q=!!O&&he(O),re=[],fe=0,me=_.tiles||[];fe<me.length;fe+=1){var Ae=me[fe];de(Ae)?re.push(this.canonicalizeTileURL(Ae,q)):re.push(Ae)}return re},ae.prototype._makeAPIURL=function(_,O){var q="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",re=ve(W.API_URL);if(_.protocol=re.protocol,_.authority=re.authority,re.path!=="/"&&(_.path=""+re.path+_.path),!W.REQUIRE_ACCESS_TOKEN)return ke(_);if(!(O=O||W.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+q);if(O[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+q);return _.params=_.params.filter(function(fe){return fe.indexOf("access_token")===-1}),_.params.push("access_token="+O),ke(_)};var se=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function de(_){return se.test(_)}var ue=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ve(_){var O=_.match(ue);if(!O)throw new Error("Unable to parse URL object");return{protocol:O[1],authority:O[2],path:O[3]||"/",params:O[4]?O[4].split("&"):[]}}function ke(_){var O=_.params.length?"?"+_.params.join("&"):"";return _.protocol+"://"+_.authority+_.path+O}function Ee(_){if(!_)return null;var O,q=_.split(".");if(!q||q.length!==3)return null;try{return JSON.parse((O=q[1],decodeURIComponent(self.atob(O).split("").map(function(re){return"%"+("00"+re.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch(re){return null}}var be=function(_){this.type=_,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};be.prototype.getStorageKey=function(_){var O,q=Ee(W.ACCESS_TOKEN),re="";return q&&q.u?(O=q.u,re=self.btoa(encodeURIComponent(O).replace(/%([0-9A-F]{2})/g,function(fe,me){return String.fromCharCode(Number("0x"+me))}))):re=W.ACCESS_TOKEN||"",_?"mapbox.eventData."+_+":"+re:"mapbox.eventData:"+re},be.prototype.fetchEventData=function(){var _=G("localStorage"),O=this.getStorageKey(),q=this.getStorageKey("uuid");if(_)try{var re=self.localStorage.getItem(O);re&&(this.eventData=JSON.parse(re));var fe=self.localStorage.getItem(q);fe&&(this.anonId=fe)}catch(me){k("Unable to read from LocalStorage")}},be.prototype.saveEventData=function(){var _=G("localStorage"),O=this.getStorageKey(),q=this.getStorageKey("uuid");if(_)try{self.localStorage.setItem(q,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(O,JSON.stringify(this.eventData))}catch(re){k("Unable to write to LocalStorage")}},be.prototype.processRequests=function(_){},be.prototype.postEvent=function(_,O,q,re){var fe=this;if(W.EVENTS_URL){var me=ve(W.EVENTS_URL);me.params.push("access_token="+(re||W.ACCESS_TOKEN||""));var Ae={event:this.type,created:new Date(_).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.10.1",skuId:ie,userId:this.anonId},De=O?g(Ae,O):Ae,Ze={url:ke(me),headers:{"Content-Type":"text/plain"},body:JSON.stringify([De])};this.pendingRequest=er(Ze,function(ut){fe.pendingRequest=null,q(ut),fe.saveEventData(),fe.processRequests(re)})}},be.prototype.queueRequest=function(_,O){this.queue.push(_),this.processRequests(O)};var xe,ce,ge=function(_){function O(){_.call(this,"map.load"),this.success={},this.skuToken=""}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.postMapLoadEvent=function(q,re,fe,me){this.skuToken=fe,(W.EVENTS_URL&&me||W.ACCESS_TOKEN&&Array.isArray(q)&&q.some(function(Ae){return he(Ae)||de(Ae)}))&&this.queueRequest({id:re,timestamp:Date.now()},me)},O.prototype.processRequests=function(q){var re=this;if(!this.pendingRequest&&this.queue.length!==0){var fe=this.queue.shift(),me=fe.id,Ae=fe.timestamp;me&&this.success[me]||(this.anonId||this.fetchEventData(),b(this.anonId)||(this.anonId=v()),this.postEvent(Ae,{skuToken:this.skuToken},function(De){De||me&&(re.success[me]=!0)},q))}},O}(be),we=new(function(_){function O(q){_.call(this,"appUserTurnstile"),this._customAccessToken=q}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.postTurnstileEvent=function(q,re){W.EVENTS_URL&&W.ACCESS_TOKEN&&Array.isArray(q)&&q.some(function(fe){return he(fe)||de(fe)})&&this.queueRequest(Date.now(),re)},O.prototype.processRequests=function(q){var re=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var fe=Ee(W.ACCESS_TOKEN),me=fe?fe.u:W.ACCESS_TOKEN,Ae=me!==this.eventData.tokenU;b(this.anonId)||(this.anonId=v(),Ae=!0);var De=this.queue.shift();if(this.eventData.lastSuccess){var Ze=new Date(this.eventData.lastSuccess),ut=new Date(De),gt=(De-this.eventData.lastSuccess)/864e5;Ae=Ae||gt>=1||gt<-1||Ze.getDate()!==ut.getDate()}else Ae=!0;if(!Ae)return this.processRequests();this.postEvent(De,{"enabled.telemetry":!1},function(Bt){Bt||(re.eventData.lastSuccess=De,re.eventData.tokenU=me)},q)}},O}(be)),Me=we.postTurnstileEvent.bind(we),Se=new ge,ze=Se.postMapLoadEvent.bind(Se),Fe=500,Ye=50;function rt(){self.caches&&!xe&&(xe=self.caches.open("mapbox-tiles"))}function Oe(_,O,q){if(rt(),xe){var re={status:O.status,statusText:O.statusText,headers:new self.Headers};O.headers.forEach(function(me,Ae){return re.headers.set(Ae,me)});var fe=D(O.headers.get("Cache-Control")||"");fe["no-store"]||(fe["max-age"]&&re.headers.set("Expires",new Date(q+1e3*fe["max-age"]).toUTCString()),new Date(re.headers.get("Expires")).getTime()-q<42e4||function(me,Ae){if(ce===void 0)try{new Response(new ReadableStream),ce=!0}catch(De){ce=!1}ce?Ae(me.body):me.blob().then(Ae)}(O,function(me){var Ae=new self.Response(me,re);rt(),xe&&xe.then(function(De){return De.put(je(_.url),Ae)}).catch(function(De){return k(De.message)})}))}}function je(_){var O=_.indexOf("?");return O<0?_:_.slice(0,O)}function We(_,O){if(rt(),!xe)return O(null);var q=je(_.url);xe.then(function(re){re.match(q).then(function(fe){var me=function(Ae){if(!Ae)return!1;var De=new Date(Ae.headers.get("Expires")||0),Ze=D(Ae.headers.get("Cache-Control")||"");return De>Date.now()&&!Ze["no-cache"]}(fe);re.delete(q),me&&re.put(q,fe.clone()),O(null,fe,me)}).catch(O)}).catch(O)}var qe,et=1/0;function st(){return qe==null&&(qe=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),qe}var ct={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ct);var Pt=function(_){function O(q,re,fe){re===401&&de(fe)&&(q+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),_.call(this,q),this.status=re,this.url=fe,this.name=this.constructor.name,this.message=q}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},O}(Error),kt=P()?function(){return self.worker&&self.worker.referrer}:function(){return(self.location.protocol==="blob:"?self.parent:self).location.href};function at(_,O){var q,re=new self.AbortController,fe=new self.Request(_.url,{method:_.method||"GET",body:_.body,credentials:_.credentials,headers:_.headers,referrer:kt(),signal:re.signal}),me=!1,Ae=!1,De=(q=fe.url).indexOf("sku=")>0&&de(q);_.type==="json"&&fe.headers.set("Accept","application/json");var Ze=function(gt,Bt,Wt){if(!Ae){if(gt&&gt.message!=="SecurityError"&&k(gt),Bt&&Wt)return ut(Bt);var Ht=Date.now();self.fetch(fe).then(function(ar){if(ar.ok){var gr=De?ar.clone():null;return ut(ar,gr,Ht)}return O(new Pt(ar.statusText,ar.status,_.url))}).catch(function(ar){ar.code!==20&&O(new Error(ar.message))})}},ut=function(gt,Bt,Wt){(_.type==="arrayBuffer"?gt.arrayBuffer():_.type==="json"?gt.json():gt.text()).then(function(Ht){Ae||(Bt&&Wt&&Oe(fe,Bt,Wt),me=!0,O(null,Ht,gt.headers.get("Cache-Control"),gt.headers.get("Expires")))}).catch(function(Ht){Ae||O(new Error(Ht.message))})};return De?We(fe,Ze):Ze(null,null),{cancel:function(){Ae=!0,me||re.abort()}}}var tt=function(_,O){if(q=_.url,!(/^file:/.test(q)||/^file:/.test(kt())&&!/^\w+:/.test(q))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return at(_,O);if(P()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",_,O,void 0,!0)}var q;return function(re,fe){var me=new self.XMLHttpRequest;for(var Ae in me.open(re.method||"GET",re.url,!0),re.type==="arrayBuffer"&&(me.responseType="arraybuffer"),re.headers)me.setRequestHeader(Ae,re.headers[Ae]);return re.type==="json"&&(me.responseType="text",me.setRequestHeader("Accept","application/json")),me.withCredentials=re.credentials==="include",me.onerror=function(){fe(new Error(me.statusText))},me.onload=function(){if((me.status>=200&&me.status<300||me.status===0)&&me.response!==null){var De=me.response;if(re.type==="json")try{De=JSON.parse(me.response)}catch(Ze){return fe(Ze)}fe(null,De,me.getResponseHeader("Cache-Control"),me.getResponseHeader("Expires"))}else fe(new Pt(me.statusText,me.status,re.url))},me.send(re.body),{cancel:function(){return me.abort()}}}(_,O)},_t=function(_,O){return tt(g(_,{type:"arrayBuffer"}),O)},er=function(_,O){return tt(g(_,{method:"POST"}),O)},tr,Ue;tr=[],Ue=0;var He=function(_,O){if(ee.supported&&(_.headers||(_.headers={}),_.headers.accept="image/webp,*/*"),Ue>=W.MAX_PARALLEL_IMAGE_REQUESTS){var q={requestParameters:_,callback:O,cancelled:!1,cancel:function(){this.cancelled=!0}};return tr.push(q),q}Ue++;var re=!1,fe=function(){if(!re)for(re=!0,Ue--;tr.length&&Ue<W.MAX_PARALLEL_IMAGE_REQUESTS;){var Ae=tr.shift(),De=Ae.requestParameters,Ze=Ae.callback;Ae.cancelled||(Ae.cancel=He(De,Ze).cancel)}},me=_t(_,function(Ae,De,Ze,ut){fe(),Ae?O(Ae):De&&(st()?function(gt,Bt){var Wt=new self.Blob([new Uint8Array(gt)],{type:"image/png"});self.createImageBitmap(Wt).then(function(Ht){Bt(null,Ht)}).catch(function(Ht){Bt(new Error("Could not load image because of "+Ht.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(De,O):function(gt,Bt,Wt,Ht){var ar=new self.Image,gr=self.URL;ar.onload=function(){Bt(null,ar),gr.revokeObjectURL(ar.src)},ar.onerror=function(){return Bt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Cr=new self.Blob([new Uint8Array(gt)],{type:"image/png"});ar.cacheControl=Wt,ar.expires=Ht,ar.src=gt.byteLength?gr.createObjectURL(Cr):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(De,O,Ze,ut))});return{cancel:function(){me.cancel(),fe()}}};function Be(_,O,q){q[_]&&q[_].indexOf(O)!==-1||(q[_]=q[_]||[],q[_].push(O))}function Ke(_,O,q){if(q&&q[_]){var re=q[_].indexOf(O);re!==-1&&q[_].splice(re,1)}}var _e=function(_,O){O===void 0&&(O={}),g(this,O),this.type=_},Ce=function(_){function O(q,re){re===void 0&&(re={}),_.call(this,"error",g({error:q},re))}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O}(_e),Le=function(){};Le.prototype.on=function(_,O){return this._listeners=this._listeners||{},Be(_,O,this._listeners),this},Le.prototype.off=function(_,O){return Ke(_,O,this._listeners),Ke(_,O,this._oneTimeListeners),this},Le.prototype.once=function(_,O){return this._oneTimeListeners=this._oneTimeListeners||{},Be(_,O,this._oneTimeListeners),this},Le.prototype.fire=function(_,O){typeof _=="string"&&(_=new _e(_,O||{}));var q=_.type;if(this.listens(q)){_.target=this;for(var re=0,fe=this._listeners&&this._listeners[q]?this._listeners[q].slice():[];re<fe.length;re+=1)fe[re].call(this,_);for(var me=0,Ae=this._oneTimeListeners&&this._oneTimeListeners[q]?this._oneTimeListeners[q].slice():[];me<Ae.length;me+=1){var De=Ae[me];Ke(q,De,this._oneTimeListeners),De.call(this,_)}var Ze=this._eventedParent;Ze&&(g(_,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),Ze.fire(_))}else _ instanceof Ce&&console.error(_.error);return this},Le.prototype.listens=function(_){return this._listeners&&this._listeners[_]&&this._listeners[_].length>0||this._oneTimeListeners&&this._oneTimeListeners[_]&&this._oneTimeListeners[_].length>0||this._eventedParent&&this._eventedParent.listens(_)},Le.prototype.setEventedParent=function(_,O){return this._eventedParent=_,this._eventedParentData=O,this};var Pe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Xe=function(_,O,q,re){this.message=(_?_+": ":"")+q,re&&(this.identifier=re),O!=null&&O.__line__&&(this.line=O.__line__)};function ht(_){var O=_.key,q=_.value;return q?[new Xe(O,q,"constants have been deprecated as of v8")]:[]}function Mt(_){for(var O=[],q=arguments.length-1;q-- >0;)O[q]=arguments[q+1];for(var re=0,fe=O;re<fe.length;re+=1){var me=fe[re];for(var Ae in me)_[Ae]=me[Ae]}return _}function pt(_){return _ instanceof Number||_ instanceof String||_ instanceof Boolean?_.valueOf():_}function Lt(_){if(Array.isArray(_))return _.map(Lt);if(_ instanceof Object&&!(_ instanceof Number||_ instanceof String||_ instanceof Boolean)){var O={};for(var q in _)O[q]=Lt(_[q]);return O}return pt(_)}var vt=function(_){function O(q,re){_.call(this,re),this.message=re,this.key=q}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O}(Error),Dt=function(_,O){O===void 0&&(O=[]),this.parent=_,this.bindings={};for(var q=0,re=O;q<re.length;q+=1){var fe=re[q],me=fe[0],Ae=fe[1];this.bindings[me]=Ae}};Dt.prototype.concat=function(_){return new Dt(this,_)},Dt.prototype.get=function(_){if(this.bindings[_])return this.bindings[_];if(this.parent)return this.parent.get(_);throw new Error(_+" not found in scope.")},Dt.prototype.has=function(_){return!!this.bindings[_]||!!this.parent&&this.parent.has(_)};var xt={kind:"null"},it={kind:"number"},St={kind:"string"},Nt={kind:"boolean"},Ut={kind:"color"},Qt={kind:"object"},Ie={kind:"value"},lt={kind:"collator"},wt={kind:"formatted"},Ot={kind:"resolvedImage"};function Gt(_,O){return{kind:"array",itemType:_,N:O}}function ir(_){if(_.kind==="array"){var O=ir(_.itemType);return typeof _.N=="number"?"array<"+O+", "+_.N+">":_.itemType.kind==="value"?"array":"array<"+O+">"}return _.kind}var Xt=[xt,it,St,Nt,Ut,wt,Qt,Gt(Ie),Ot];function Kt(_,O){if(O.kind==="error")return null;if(_.kind==="array"){if(O.kind==="array"&&(O.N===0&&O.itemType.kind==="value"||!Kt(_.itemType,O.itemType))&&(typeof _.N!="number"||_.N===O.N))return null}else{if(_.kind===O.kind)return null;if(_.kind==="value"){for(var q=0,re=Xt;q<re.length;q+=1)if(!Kt(re[q],O))return null}}return"Expected "+ir(_)+" but found "+ir(O)+" instead."}function or(_,O){return O.some(function(q){return q.kind===_.kind})}function dr(_,O){return O.some(function(q){return q==="null"?_===null:q==="array"?Array.isArray(_):q==="object"?_&&!Array.isArray(_)&&typeof _=="object":q===typeof _})}var vr=f(function(_,O){var q={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function re(Ze){return(Ze=Math.round(Ze))<0?0:Ze>255?255:Ze}function fe(Ze){return Ze<0?0:Ze>1?1:Ze}function me(Ze){return Ze[Ze.length-1]==="%"?re(parseFloat(Ze)/100*255):re(parseInt(Ze))}function Ae(Ze){return Ze[Ze.length-1]==="%"?fe(parseFloat(Ze)/100):fe(parseFloat(Ze))}function De(Ze,ut,gt){return gt<0?gt+=1:gt>1&&(gt-=1),6*gt<1?Ze+(ut-Ze)*gt*6:2*gt<1?ut:3*gt<2?Ze+(ut-Ze)*(2/3-gt)*6:Ze}try{O.parseCSSColor=function(Ze){var ut,gt=Ze.replace(/ /g,"").toLowerCase();if(gt in q)return q[gt].slice();if(gt[0]==="#")return gt.length===4?(ut=parseInt(gt.substr(1),16))>=0&&ut<=4095?[(3840&ut)>>4|(3840&ut)>>8,240&ut|(240&ut)>>4,15&ut|(15&ut)<<4,1]:null:gt.length===7&&(ut=parseInt(gt.substr(1),16))>=0&&ut<=16777215?[(16711680&ut)>>16,(65280&ut)>>8,255&ut,1]:null;var Bt=gt.indexOf("("),Wt=gt.indexOf(")");if(Bt!==-1&&Wt+1===gt.length){var Ht=gt.substr(0,Bt),ar=gt.substr(Bt+1,Wt-(Bt+1)).split(","),gr=1;switch(Ht){case"rgba":if(ar.length!==4)return null;gr=Ae(ar.pop());case"rgb":return ar.length!==3?null:[me(ar[0]),me(ar[1]),me(ar[2]),gr];case"hsla":if(ar.length!==4)return null;gr=Ae(ar.pop());case"hsl":if(ar.length!==3)return null;var Cr=(parseFloat(ar[0])%360+360)%360/360,Er=Ae(ar[1]),Fr=Ae(ar[2]),Br=Fr<=.5?Fr*(Er+1):Fr+Er-Fr*Er,Hr=2*Fr-Br;return[re(255*De(Hr,Br,Cr+1/3)),re(255*De(Hr,Br,Cr)),re(255*De(Hr,Br,Cr-1/3)),gr];default:return null}}return null}}catch(Ze){}}).parseCSSColor,ur=function(_,O,q,re){re===void 0&&(re=1),this.r=_,this.g=O,this.b=q,this.a=re};ur.parse=function(_){if(_){if(_ instanceof ur)return _;if(typeof _=="string"){var O=vr(_);if(O)return new ur(O[0]/255*O[3],O[1]/255*O[3],O[2]/255*O[3],O[3])}}},ur.prototype.toString=function(){var _=this.toArray(),O=_[0],q=_[1],re=_[2],fe=_[3];return"rgba("+Math.round(O)+","+Math.round(q)+","+Math.round(re)+","+fe+")"},ur.prototype.toArray=function(){var _=this.r,O=this.g,q=this.b,re=this.a;return re===0?[0,0,0,0]:[255*_/re,255*O/re,255*q/re,re]},ur.black=new ur(0,0,0,1),ur.white=new ur(1,1,1,1),ur.transparent=new ur(0,0,0,0),ur.red=new ur(1,0,0,1);var pr=function(_,O,q){this.sensitivity=_?O?"variant":"case":O?"accent":"base",this.locale=q,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};pr.prototype.compare=function(_,O){return this.collator.compare(_,O)},pr.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var br=function(_,O,q,re,fe){this.text=_,this.image=O,this.scale=q,this.fontStack=re,this.textColor=fe},Rr=function(_){this.sections=_};Rr.fromString=function(_){return new Rr([new br(_,null,null,null,null)])},Rr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(_){return _.text.length!==0||_.image&&_.image.name.length!==0})},Rr.factory=function(_){return _ instanceof Rr?_:Rr.fromString(_)},Rr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(_){return _.text}).join("")},Rr.prototype.serialize=function(){for(var _=["format"],O=0,q=this.sections;O<q.length;O+=1){var re=q[O];if(re.image)_.push(["image",re.image.name]);else{_.push(re.text);var fe={};re.fontStack&&(fe["text-font"]=["literal",re.fontStack.split(",")]),re.scale&&(fe["font-scale"]=re.scale),re.textColor&&(fe["text-color"]=["rgba"].concat(re.textColor.toArray())),_.push(fe)}}return _};var _r=function(_){this.name=_.name,this.available=_.available};function jr(_,O,q,re){return typeof _=="number"&&_>=0&&_<=255&&typeof O=="number"&&O>=0&&O<=255&&typeof q=="number"&&q>=0&&q<=255?re===void 0||typeof re=="number"&&re>=0&&re<=1?null:"Invalid rgba value ["+[_,O,q,re].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof re=="number"?[_,O,q,re]:[_,O,q]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function $r(_){if(_===null||typeof _=="string"||typeof _=="boolean"||typeof _=="number"||_ instanceof ur||_ instanceof pr||_ instanceof Rr||_ instanceof _r)return!0;if(Array.isArray(_)){for(var O=0,q=_;O<q.length;O+=1)if(!$r(q[O]))return!1;return!0}if(typeof _=="object"){for(var re in _)if(!$r(_[re]))return!1;return!0}return!1}function pn(_){if(_===null)return xt;if(typeof _=="string")return St;if(typeof _=="boolean")return Nt;if(typeof _=="number")return it;if(_ instanceof ur)return Ut;if(_ instanceof pr)return lt;if(_ instanceof Rr)return wt;if(_ instanceof _r)return Ot;if(Array.isArray(_)){for(var O,q=_.length,re=0,fe=_;re<fe.length;re+=1){var me=pn(fe[re]);if(O){if(O===me)continue;O=Ie;break}O=me}return Gt(O||Ie,q)}return Qt}function In(_){var O=typeof _;return _===null?"":O==="string"||O==="number"||O==="boolean"?String(_):_ instanceof ur||_ instanceof Rr||_ instanceof _r?_.toString():JSON.stringify(_)}_r.prototype.toString=function(){return this.name},_r.fromString=function(_){return _?new _r({name:_,available:!1}):null},_r.prototype.serialize=function(){return["image",this.name]};var On=function(_,O){this.type=_,this.value=O};On.parse=function(_,O){if(_.length!==2)return O.error("'literal' expression requires exactly one argument, but found "+(_.length-1)+" instead.");if(!$r(_[1]))return O.error("invalid value");var q=_[1],re=pn(q),fe=O.expectedType;return re.kind!=="array"||re.N!==0||!fe||fe.kind!=="array"||typeof fe.N=="number"&&fe.N!==0||(re=fe),new On(re,q)},On.prototype.evaluate=function(){return this.value},On.prototype.eachChild=function(){},On.prototype.outputDefined=function(){return!0},On.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ur?["rgba"].concat(this.value.toArray()):this.value instanceof Rr?this.value.serialize():this.value};var Sn=function(_){this.name="ExpressionEvaluationError",this.message=_};Sn.prototype.toJSON=function(){return this.message};var an={string:St,number:it,boolean:Nt,object:Qt},Nr=function(_,O){this.type=_,this.args=O};Nr.parse=function(_,O){if(_.length<2)return O.error("Expected at least one argument.");var q,re=1,fe=_[0];if(fe==="array"){var me,Ae;if(_.length>2){var De=_[1];if(typeof De!="string"||!(De in an)||De==="object")return O.error('The item type argument of "array" must be one of string, number, boolean',1);me=an[De],re++}else me=Ie;if(_.length>3){if(_[2]!==null&&(typeof _[2]!="number"||_[2]<0||_[2]!==Math.floor(_[2])))return O.error('The length argument to "array" must be a positive integer literal',2);Ae=_[2],re++}q=Gt(me,Ae)}else q=an[fe];for(var Ze=[];re<_.length;re++){var ut=O.parse(_[re],re,Ie);if(!ut)return null;Ze.push(ut)}return new Nr(q,Ze)},Nr.prototype.evaluate=function(_){for(var O=0;O<this.args.length;O++){var q=this.args[O].evaluate(_);if(!Kt(this.type,pn(q)))return q;if(O===this.args.length-1)throw new Sn("Expected value to be of type "+ir(this.type)+", but found "+ir(pn(q))+" instead.")}return null},Nr.prototype.eachChild=function(_){this.args.forEach(_)},Nr.prototype.outputDefined=function(){return this.args.every(function(_){return _.outputDefined()})},Nr.prototype.serialize=function(){var _=this.type,O=[_.kind];if(_.kind==="array"){var q=_.itemType;if(q.kind==="string"||q.kind==="number"||q.kind==="boolean"){O.push(q.kind);var re=_.N;(typeof re=="number"||this.args.length>1)&&O.push(re)}}return O.concat(this.args.map(function(fe){return fe.serialize()}))};var Pr=function(_){this.type=wt,this.sections=_};Pr.parse=function(_,O){if(_.length<2)return O.error("Expected at least one argument.");var q=_[1];if(!Array.isArray(q)&&typeof q=="object")return O.error("First argument must be an image or text section.");for(var re=[],fe=!1,me=1;me<=_.length-1;++me){var Ae=_[me];if(fe&&typeof Ae=="object"&&!Array.isArray(Ae)){fe=!1;var De=null;if(Ae["font-scale"]&&!(De=O.parse(Ae["font-scale"],1,it)))return null;var Ze=null;if(Ae["text-font"]&&!(Ze=O.parse(Ae["text-font"],1,Gt(St))))return null;var ut=null;if(Ae["text-color"]&&!(ut=O.parse(Ae["text-color"],1,Ut)))return null;var gt=re[re.length-1];gt.scale=De,gt.font=Ze,gt.textColor=ut}else{var Bt=O.parse(_[me],1,Ie);if(!Bt)return null;var Wt=Bt.type.kind;if(Wt!=="string"&&Wt!=="value"&&Wt!=="null"&&Wt!=="resolvedImage")return O.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");fe=!0,re.push({content:Bt,scale:null,font:null,textColor:null})}}return new Pr(re)},Pr.prototype.evaluate=function(_){return new Rr(this.sections.map(function(O){var q=O.content.evaluate(_);return pn(q)===Ot?new br("",q,null,null,null):new br(In(q),null,O.scale?O.scale.evaluate(_):null,O.font?O.font.evaluate(_).join(","):null,O.textColor?O.textColor.evaluate(_):null)}))},Pr.prototype.eachChild=function(_){for(var O=0,q=this.sections;O<q.length;O+=1){var re=q[O];_(re.content),re.scale&&_(re.scale),re.font&&_(re.font),re.textColor&&_(re.textColor)}},Pr.prototype.outputDefined=function(){return!1},Pr.prototype.serialize=function(){for(var _=["format"],O=0,q=this.sections;O<q.length;O+=1){var re=q[O];_.push(re.content.serialize());var fe={};re.scale&&(fe["font-scale"]=re.scale.serialize()),re.font&&(fe["text-font"]=re.font.serialize()),re.textColor&&(fe["text-color"]=re.textColor.serialize()),_.push(fe)}return _};var en=function(_){this.type=Ot,this.input=_};en.parse=function(_,O){if(_.length!==2)return O.error("Expected two arguments.");var q=O.parse(_[1],1,St);return q?new en(q):O.error("No image name provided.")},en.prototype.evaluate=function(_){var O=this.input.evaluate(_),q=_r.fromString(O);return q&&_.availableImages&&(q.available=_.availableImages.indexOf(O)>-1),q},en.prototype.eachChild=function(_){_(this.input)},en.prototype.outputDefined=function(){return!1},en.prototype.serialize=function(){return["image",this.input.serialize()]};var tn={"to-boolean":Nt,"to-color":Ut,"to-number":it,"to-string":St},Qr=function(_,O){this.type=_,this.args=O};Qr.parse=function(_,O){if(_.length<2)return O.error("Expected at least one argument.");var q=_[0];if((q==="to-boolean"||q==="to-string")&&_.length!==2)return O.error("Expected one argument.");for(var re=tn[q],fe=[],me=1;me<_.length;me++){var Ae=O.parse(_[me],me,Ie);if(!Ae)return null;fe.push(Ae)}return new Qr(re,fe)},Qr.prototype.evaluate=function(_){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(_));if(this.type.kind==="color"){for(var O,q,re=0,fe=this.args;re<fe.length;re+=1){if(q=null,(O=fe[re].evaluate(_))instanceof ur)return O;if(typeof O=="string"){var me=_.parseColor(O);if(me)return me}else if(Array.isArray(O)&&!(q=O.length<3||O.length>4?"Invalid rbga value "+JSON.stringify(O)+": expected an array containing either three or four numeric values.":jr(O[0],O[1],O[2],O[3])))return new ur(O[0]/255,O[1]/255,O[2]/255,O[3])}throw new Sn(q||"Could not parse color from value '"+(typeof O=="string"?O:String(JSON.stringify(O)))+"'")}if(this.type.kind==="number"){for(var Ae=null,De=0,Ze=this.args;De<Ze.length;De+=1){if((Ae=Ze[De].evaluate(_))===null)return 0;var ut=Number(Ae);if(!isNaN(ut))return ut}throw new Sn("Could not convert "+JSON.stringify(Ae)+" to number.")}return this.type.kind==="formatted"?Rr.fromString(In(this.args[0].evaluate(_))):this.type.kind==="resolvedImage"?_r.fromString(In(this.args[0].evaluate(_))):In(this.args[0].evaluate(_))},Qr.prototype.eachChild=function(_){this.args.forEach(_)},Qr.prototype.outputDefined=function(){return this.args.every(function(_){return _.outputDefined()})},Qr.prototype.serialize=function(){if(this.type.kind==="formatted")return new Pr([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new en(this.args[0]).serialize();var _=["to-"+this.type.kind];return this.eachChild(function(O){_.push(O.serialize())}),_};var rn=["Unknown","Point","LineString","Polygon"],An=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};An.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},An.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?rn[this.feature.type]:this.feature.type:null},An.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},An.prototype.canonicalID=function(){return this.canonical},An.prototype.properties=function(){return this.feature&&this.feature.properties||{}},An.prototype.parseColor=function(_){var O=this._parseColorCache[_];return O||(O=this._parseColorCache[_]=ur.parse(_)),O};var En=function(_,O,q,re){this.name=_,this.type=O,this._evaluate=q,this.args=re};En.prototype.evaluate=function(_){return this._evaluate(_,this.args)},En.prototype.eachChild=function(_){this.args.forEach(_)},En.prototype.outputDefined=function(){return!1},En.prototype.serialize=function(){return[this.name].concat(this.args.map(function(_){return _.serialize()}))},En.parse=function(_,O){var q,re=_[0],fe=En.definitions[re];if(!fe)return O.error('Unknown expression "'+re+'". If you wanted a literal array, use ["literal", [...]].',0);for(var me=Array.isArray(fe)?fe[0]:fe.type,Ae=Array.isArray(fe)?[[fe[1],fe[2]]]:fe.overloads,De=Ae.filter(function(ia){var Zn=ia[0];return!Array.isArray(Zn)||Zn.length===_.length-1}),Ze=null,ut=0,gt=De;ut<gt.length;ut+=1){var Bt=gt[ut],Wt=Bt[0],Ht=Bt[1];Ze=new dn(O.registry,O.path,null,O.scope);for(var ar=[],gr=!1,Cr=1;Cr<_.length;Cr++){var Er=_[Cr],Fr=Array.isArray(Wt)?Wt[Cr-1]:Wt.type,Br=Ze.parse(Er,1+ar.length,Fr);if(!Br){gr=!0;break}ar.push(Br)}if(!gr)if(Array.isArray(Wt)&&Wt.length!==ar.length)Ze.error("Expected "+Wt.length+" arguments, but found "+ar.length+" instead.");else{for(var Hr=0;Hr<ar.length;Hr++){var fn=Array.isArray(Wt)?Wt[Hr]:Wt.type,xn=ar[Hr];Ze.concat(Hr+1).checkSubtype(fn,xn.type)}if(Ze.errors.length===0)return new En(re,me,Ht,ar)}}if(De.length===1)(q=O.errors).push.apply(q,Ze.errors);else{for(var Nn=(De.length?De:Ae).map(function(ia){var Zn,ha=ia[0];return Zn=ha,Array.isArray(Zn)?"("+Zn.map(ir).join(", ")+")":"("+ir(Zn.type)+"...)"}).join(" | "),Fn=[],qn=1;qn<_.length;qn++){var na=O.parse(_[qn],1+Fn.length);if(!na)return null;Fn.push(ir(na.type))}O.error("Expected arguments of type "+Nn+", but found ("+Fn.join(", ")+") instead.")}return null},En.register=function(_,O){for(var q in En.definitions=O,O)_[q]=En};var Bn=function(_,O,q){this.type=lt,this.locale=q,this.caseSensitive=_,this.diacriticSensitive=O};Bn.parse=function(_,O){if(_.length!==2)return O.error("Expected one argument.");var q=_[1];if(typeof q!="object"||Array.isArray(q))return O.error("Collator options argument must be an object.");var re=O.parse(q["case-sensitive"]!==void 0&&q["case-sensitive"],1,Nt);if(!re)return null;var fe=O.parse(q["diacritic-sensitive"]!==void 0&&q["diacritic-sensitive"],1,Nt);if(!fe)return null;var me=null;return q.locale&&!(me=O.parse(q.locale,1,St))?null:new Bn(re,fe,me)},Bn.prototype.evaluate=function(_){return new pr(this.caseSensitive.evaluate(_),this.diacriticSensitive.evaluate(_),this.locale?this.locale.evaluate(_):null)},Bn.prototype.eachChild=function(_){_(this.caseSensitive),_(this.diacriticSensitive),this.locale&&_(this.locale)},Bn.prototype.outputDefined=function(){return!1},Bn.prototype.serialize=function(){var _={};return _["case-sensitive"]=this.caseSensitive.serialize(),_["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(_.locale=this.locale.serialize()),["collator",_]};function Jt(_,O){_[0]=Math.min(_[0],O[0]),_[1]=Math.min(_[1],O[1]),_[2]=Math.max(_[2],O[0]),_[3]=Math.max(_[3],O[1])}function It(_,O){return!(_[0]<=O[0])&&!(_[2]>=O[2])&&!(_[1]<=O[1])&&!(_[3]>=O[3])}function qt(_,O){var q,re=(180+_[0])/360,fe=(q=_[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+q*Math.PI/360)))/360),me=Math.pow(2,O.z);return[Math.round(re*me*8192),Math.round(fe*me*8192)]}function fr(_,O,q){return O[1]>_[1]!=q[1]>_[1]&&_[0]<(q[0]-O[0])*(_[1]-O[1])/(q[1]-O[1])+O[0]}function Tr(_,O){for(var q,re,fe,me,Ae,De,Ze,ut=!1,gt=0,Bt=O.length;gt<Bt;gt++)for(var Wt=O[gt],Ht=0,ar=Wt.length;Ht<ar-1;Ht++){if(q=_,re=Wt[Ht],fe=Wt[Ht+1],me=void 0,Ae=void 0,De=void 0,Ze=void 0,me=q[0]-re[0],Ae=q[1]-re[1],De=q[0]-fe[0],Ze=q[1]-fe[1],me*Ze-De*Ae==0&&me*De<=0&&Ae*Ze<=0)return!1;fr(_,Wt[Ht],Wt[Ht+1])&&(ut=!ut)}return ut}function Gr(_,O){for(var q=0;q<O.length;q++)if(Tr(_,O[q]))return!0;return!1}function Vr(_,O,q,re){var fe=_[0]-q[0],me=_[1]-q[1],Ae=O[0]-q[0],De=O[1]-q[1],Ze=re[0]-q[0],ut=re[1]-q[1],gt=fe*ut-Ze*me,Bt=Ae*ut-Ze*De;return gt>0&&Bt<0||gt<0&&Bt>0}function xr(_,O,q){for(var re=0,fe=q;re<fe.length;re+=1)for(var me=fe[re],Ae=0;Ae<me.length-1;++Ae)if(De=_,Ze=O,ut=me[Ae],gt=me[Ae+1],Bt=void 0,Wt=void 0,Ht=void 0,ar=void 0,Ht=[Ze[0]-De[0],Ze[1]-De[1]],ar=[gt[0]-ut[0],gt[1]-ut[1]],(Bt=ar)[0]*(Wt=Ht)[1]-Bt[1]*Wt[0]!=0&&Vr(De,Ze,ut,gt)&&Vr(ut,gt,De,Ze))return!0;var De,Ze,ut,gt,Bt,Wt,Ht,ar;return!1}function wr(_,O){for(var q=0;q<_.length;++q)if(!Tr(_[q],O))return!1;for(var re=0;re<_.length-1;++re)if(xr(_[re],_[re+1],O))return!1;return!0}function Sr(_,O){for(var q=0;q<O.length;q++)if(wr(_,O[q]))return!0;return!1}function Mr(_,O,q){for(var re=[],fe=0;fe<_.length;fe++){for(var me=[],Ae=0;Ae<_[fe].length;Ae++){var De=qt(_[fe][Ae],q);Jt(O,De),me.push(De)}re.push(me)}return re}function Ir(_,O,q){for(var re=[],fe=0;fe<_.length;fe++){var me=Mr(_[fe],O,q);re.push(me)}return re}function qr(_,O,q,re){if(_[0]<q[0]||_[0]>q[2]){var fe=.5*re,me=_[0]-q[0]>fe?-re:q[0]-_[0]>fe?re:0;me===0&&(me=_[0]-q[2]>fe?-re:q[2]-_[0]>fe?re:0),_[0]+=me}Jt(O,_)}function cn(_,O,q,re){for(var fe=8192*Math.pow(2,re.z),me=[8192*re.x,8192*re.y],Ae=[],De=0,Ze=_;De<Ze.length;De+=1)for(var ut=0,gt=Ze[De];ut<gt.length;ut+=1){var Bt=gt[ut],Wt=[Bt.x+me[0],Bt.y+me[1]];qr(Wt,O,q,fe),Ae.push(Wt)}return Ae}function _n(_,O,q,re){for(var fe,me=8192*Math.pow(2,re.z),Ae=[8192*re.x,8192*re.y],De=[],Ze=0,ut=_;Ze<ut.length;Ze+=1){for(var gt=[],Bt=0,Wt=ut[Ze];Bt<Wt.length;Bt+=1){var Ht=Wt[Bt],ar=[Ht.x+Ae[0],Ht.y+Ae[1]];Jt(O,ar),gt.push(ar)}De.push(gt)}if(O[2]-O[0]<=me/2){(fe=O)[0]=fe[1]=1/0,fe[2]=fe[3]=-1/0;for(var gr=0,Cr=De;gr<Cr.length;gr+=1)for(var Er=0,Fr=Cr[gr];Er<Fr.length;Er+=1)qr(Fr[Er],O,q,me)}return De}var Jr=function(_,O){this.type=Nt,this.geojson=_,this.geometries=O};function bn(_){if(_ instanceof En&&(_.name==="get"&&_.args.length===1||_.name==="feature-state"||_.name==="has"&&_.args.length===1||_.name==="properties"||_.name==="geometry-type"||_.name==="id"||/^filter-/.test(_.name))||_ instanceof Jr)return!1;var O=!0;return _.eachChild(function(q){O&&!bn(q)&&(O=!1)}),O}function Dr(_){if(_ instanceof En&&_.name==="feature-state")return!1;var O=!0;return _.eachChild(function(q){O&&!Dr(q)&&(O=!1)}),O}function Wr(_,O){if(_ instanceof En&&O.indexOf(_.name)>=0)return!1;var q=!0;return _.eachChild(function(re){q&&!Wr(re,O)&&(q=!1)}),q}Jr.parse=function(_,O){if(_.length!==2)return O.error("'within' expression requires exactly one argument, but found "+(_.length-1)+" instead.");if($r(_[1])){var q=_[1];if(q.type==="FeatureCollection")for(var re=0;re<q.features.length;++re){var fe=q.features[re].geometry.type;if(fe==="Polygon"||fe==="MultiPolygon")return new Jr(q,q.features[re].geometry)}else if(q.type==="Feature"){var me=q.geometry.type;if(me==="Polygon"||me==="MultiPolygon")return new Jr(q,q.geometry)}else if(q.type==="Polygon"||q.type==="MultiPolygon")return new Jr(q,q)}return O.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Jr.prototype.evaluate=function(_){if(_.geometry()!=null&&_.canonicalID()!=null){if(_.geometryType()==="Point")return function(O,q){var re=[1/0,1/0,-1/0,-1/0],fe=[1/0,1/0,-1/0,-1/0],me=O.canonicalID();if(q.type==="Polygon"){var Ae=Mr(q.coordinates,fe,me),De=cn(O.geometry(),re,fe,me);if(!It(re,fe))return!1;for(var Ze=0,ut=De;Ze<ut.length;Ze+=1)if(!Tr(ut[Ze],Ae))return!1}if(q.type==="MultiPolygon"){var gt=Ir(q.coordinates,fe,me),Bt=cn(O.geometry(),re,fe,me);if(!It(re,fe))return!1;for(var Wt=0,Ht=Bt;Wt<Ht.length;Wt+=1)if(!Gr(Ht[Wt],gt))return!1}return!0}(_,this.geometries);if(_.geometryType()==="LineString")return function(O,q){var re=[1/0,1/0,-1/0,-1/0],fe=[1/0,1/0,-1/0,-1/0],me=O.canonicalID();if(q.type==="Polygon"){var Ae=Mr(q.coordinates,fe,me),De=_n(O.geometry(),re,fe,me);if(!It(re,fe))return!1;for(var Ze=0,ut=De;Ze<ut.length;Ze+=1)if(!wr(ut[Ze],Ae))return!1}if(q.type==="MultiPolygon"){var gt=Ir(q.coordinates,fe,me),Bt=_n(O.geometry(),re,fe,me);if(!It(re,fe))return!1;for(var Wt=0,Ht=Bt;Wt<Ht.length;Wt+=1)if(!Sr(Ht[Wt],gt))return!1}return!0}(_,this.geometries)}return!1},Jr.prototype.eachChild=function(){},Jr.prototype.outputDefined=function(){return!0},Jr.prototype.serialize=function(){return["within",this.geojson]};var vn=function(_,O){this.type=O.type,this.name=_,this.boundExpression=O};vn.parse=function(_,O){if(_.length!==2||typeof _[1]!="string")return O.error("'var' expression requires exactly one string literal argument.");var q=_[1];return O.scope.has(q)?new vn(q,O.scope.get(q)):O.error('Unknown variable "'+q+'". Make sure "'+q+'" has been bound in an enclosing "let" expression before using it.',1)},vn.prototype.evaluate=function(_){return this.boundExpression.evaluate(_)},vn.prototype.eachChild=function(){},vn.prototype.outputDefined=function(){return!1},vn.prototype.serialize=function(){return["var",this.name]};var dn=function(_,O,q,re,fe){O===void 0&&(O=[]),re===void 0&&(re=new Dt),fe===void 0&&(fe=[]),this.registry=_,this.path=O,this.key=O.map(function(me){return"["+me+"]"}).join(""),this.scope=re,this.errors=fe,this.expectedType=q};function Pn(_,O){for(var q,re,fe=_.length-1,me=0,Ae=fe,De=0;me<=Ae;)if(q=_[De=Math.floor((me+Ae)/2)],re=_[De+1],q<=O){if(De===fe||O<re)return De;me=De+1}else{if(!(q>O))throw new Sn("Input is not a number.");Ae=De-1}return 0}dn.prototype.parse=function(_,O,q,re,fe){return fe===void 0&&(fe={}),O?this.concat(O,q,re)._parse(_,fe):this._parse(_,fe)},dn.prototype._parse=function(_,O){function q(ut,gt,Bt){return Bt==="assert"?new Nr(gt,[ut]):Bt==="coerce"?new Qr(gt,[ut]):ut}if(_!==null&&typeof _!="string"&&typeof _!="boolean"&&typeof _!="number"||(_=["literal",_]),Array.isArray(_)){if(_.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var re=_[0];if(typeof re!="string")return this.error("Expression name must be a string, but found "+typeof re+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var fe=this.registry[re];if(fe){var me=fe.parse(_,this);if(!me)return null;if(this.expectedType){var Ae=this.expectedType,De=me.type;if(Ae.kind!=="string"&&Ae.kind!=="number"&&Ae.kind!=="boolean"&&Ae.kind!=="object"&&Ae.kind!=="array"||De.kind!=="value")if(Ae.kind!=="color"&&Ae.kind!=="formatted"&&Ae.kind!=="resolvedImage"||De.kind!=="value"&&De.kind!=="string"){if(this.checkSubtype(Ae,De))return null}else me=q(me,Ae,O.typeAnnotation||"coerce");else me=q(me,Ae,O.typeAnnotation||"assert")}if(!(me instanceof On)&&me.type.kind!=="resolvedImage"&&function ut(gt){if(gt instanceof vn)return ut(gt.boundExpression);if(gt instanceof En&&gt.name==="error"||gt instanceof Bn||gt instanceof Jr)return!1;var Bt=gt instanceof Qr||gt instanceof Nr,Wt=!0;return gt.eachChild(function(Ht){Wt=Bt?Wt&&ut(Ht):Wt&&Ht instanceof On}),Wt?bn(gt)&&Wr(gt,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}(me)){var Ze=new An;try{me=new On(me.type,me.evaluate(Ze))}catch(ut){return this.error(ut.message),null}}return me}return this.error('Unknown expression "'+re+'". If you wanted a literal array, use ["literal", [...]].',0)}return _===void 0?this.error("'undefined' value invalid. Use null instead."):typeof _=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof _+" instead.")},dn.prototype.concat=function(_,O,q){var re=typeof _=="number"?this.path.concat(_):this.path,fe=q?this.scope.concat(q):this.scope;return new dn(this.registry,re,O||null,fe,this.errors)},dn.prototype.error=function(_){for(var O=[],q=arguments.length-1;q-- >0;)O[q]=arguments[q+1];var re=""+this.key+O.map(function(fe){return"["+fe+"]"}).join("");this.errors.push(new vt(re,_))},dn.prototype.checkSubtype=function(_,O){var q=Kt(_,O);return q&&this.error(q),q};var sa=function(_,O,q){this.type=_,this.input=O,this.labels=[],this.outputs=[];for(var re=0,fe=q;re<fe.length;re+=1){var me=fe[re],Ae=me[0],De=me[1];this.labels.push(Ae),this.outputs.push(De)}};function Yn(_,O,q){return _*(1-q)+O*q}sa.parse=function(_,O){if(_.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(_.length-1)+".");if((_.length-1)%2!=0)return O.error("Expected an even number of arguments.");var q=O.parse(_[1],1,it);if(!q)return null;var re=[],fe=null;O.expectedType&&O.expectedType.kind!=="value"&&(fe=O.expectedType);for(var me=1;me<_.length;me+=2){var Ae=me===1?-1/0:_[me],De=_[me+1],Ze=me,ut=me+1;if(typeof Ae!="number")return O.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Ze);if(re.length&&re[re.length-1][0]>=Ae)return O.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Ze);var gt=O.parse(De,ut,fe);if(!gt)return null;fe=fe||gt.type,re.push([Ae,gt])}return new sa(fe,q,re)},sa.prototype.evaluate=function(_){var O=this.labels,q=this.outputs;if(O.length===1)return q[0].evaluate(_);var re=this.input.evaluate(_);if(re<=O[0])return q[0].evaluate(_);var fe=O.length;return re>=O[fe-1]?q[fe-1].evaluate(_):q[Pn(O,re)].evaluate(_)},sa.prototype.eachChild=function(_){_(this.input);for(var O=0,q=this.outputs;O<q.length;O+=1)_(q[O])},sa.prototype.outputDefined=function(){return this.outputs.every(function(_){return _.outputDefined()})},sa.prototype.serialize=function(){for(var _=["step",this.input.serialize()],O=0;O<this.labels.length;O++)O>0&&_.push(this.labels[O]),_.push(this.outputs[O].serialize());return _};var yn=Object.freeze({__proto__:null,number:Yn,color:function(_,O,q){return new ur(Yn(_.r,O.r,q),Yn(_.g,O.g,q),Yn(_.b,O.b,q),Yn(_.a,O.a,q))},array:function(_,O,q){return _.map(function(re,fe){return Yn(re,O[fe],q)})}}),ra=6/29,pa=3*ra*ra,Qa=Math.PI/180,Bi=180/Math.PI;function li(_){return _>.008856451679035631?Math.pow(_,1/3):_/pa+4/29}function Ai(_){return _>ra?_*_*_:pa*(_-4/29)}function Ea(_){return 255*(_<=.0031308?12.92*_:1.055*Math.pow(_,1/2.4)-.055)}function Ga(_){return(_/=255)<=.04045?_/12.92:Math.pow((_+.055)/1.055,2.4)}function ko(_){var O=Ga(_.r),q=Ga(_.g),re=Ga(_.b),fe=li((.4124564*O+.3575761*q+.1804375*re)/.95047),me=li((.2126729*O+.7151522*q+.072175*re)/1);return{l:116*me-16,a:500*(fe-me),b:200*(me-li((.0193339*O+.119192*q+.9503041*re)/1.08883)),alpha:_.a}}function Qo(_){var O=(_.l+16)/116,q=isNaN(_.a)?O:O+_.a/500,re=isNaN(_.b)?O:O-_.b/200;return O=1*Ai(O),q=.95047*Ai(q),re=1.08883*Ai(re),new ur(Ea(3.2404542*q-1.5371385*O-.4985314*re),Ea(-.969266*q+1.8760108*O+.041556*re),Ea(.0556434*q-.2040259*O+1.0572252*re),_.alpha)}function us(_,O,q){var re=O-_;return _+q*(re>180||re<-180?re-360*Math.round(re/360):re)}var $i={forward:ko,reverse:Qo,interpolate:function(_,O,q){return{l:Yn(_.l,O.l,q),a:Yn(_.a,O.a,q),b:Yn(_.b,O.b,q),alpha:Yn(_.alpha,O.alpha,q)}}},to={forward:function(_){var O=ko(_),q=O.l,re=O.a,fe=O.b,me=Math.atan2(fe,re)*Bi;return{h:me<0?me+360:me,c:Math.sqrt(re*re+fe*fe),l:q,alpha:_.a}},reverse:function(_){var O=_.h*Qa,q=_.c;return Qo({l:_.l,a:Math.cos(O)*q,b:Math.sin(O)*q,alpha:_.alpha})},interpolate:function(_,O,q){return{h:us(_.h,O.h,q),c:Yn(_.c,O.c,q),l:Yn(_.l,O.l,q),alpha:Yn(_.alpha,O.alpha,q)}}},es=Object.freeze({__proto__:null,lab:$i,hcl:to}),Wa=function(_,O,q,re,fe){this.type=_,this.operator=O,this.interpolation=q,this.input=re,this.labels=[],this.outputs=[];for(var me=0,Ae=fe;me<Ae.length;me+=1){var De=Ae[me],Ze=De[0],ut=De[1];this.labels.push(Ze),this.outputs.push(ut)}};function jo(_,O,q,re){var fe=re-q,me=_-q;return fe===0?0:O===1?me/fe:(Math.pow(O,me)-1)/(Math.pow(O,fe)-1)}Wa.interpolationFactor=function(_,O,q,re){var fe=0;if(_.name==="exponential")fe=jo(O,_.base,q,re);else if(_.name==="linear")fe=jo(O,1,q,re);else if(_.name==="cubic-bezier"){var me=_.controlPoints;fe=new l(me[0],me[1],me[2],me[3]).solve(jo(O,1,q,re))}return fe},Wa.parse=function(_,O){var q=_[0],re=_[1],fe=_[2],me=_.slice(3);if(!Array.isArray(re)||re.length===0)return O.error("Expected an interpolation type expression.",1);if(re[0]==="linear")re={name:"linear"};else if(re[0]==="exponential"){var Ae=re[1];if(typeof Ae!="number")return O.error("Exponential interpolation requires a numeric base.",1,1);re={name:"exponential",base:Ae}}else{if(re[0]!=="cubic-bezier")return O.error("Unknown interpolation type "+String(re[0]),1,0);var De=re.slice(1);if(De.length!==4||De.some(function(Cr){return typeof Cr!="number"||Cr<0||Cr>1}))return O.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);re={name:"cubic-bezier",controlPoints:De}}if(_.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(_.length-1)+".");if((_.length-1)%2!=0)return O.error("Expected an even number of arguments.");if(!(fe=O.parse(fe,2,it)))return null;var Ze=[],ut=null;q==="interpolate-hcl"||q==="interpolate-lab"?ut=Ut:O.expectedType&&O.expectedType.kind!=="value"&&(ut=O.expectedType);for(var gt=0;gt<me.length;gt+=2){var Bt=me[gt],Wt=me[gt+1],Ht=gt+3,ar=gt+4;if(typeof Bt!="number")return O.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Ht);if(Ze.length&&Ze[Ze.length-1][0]>=Bt)return O.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Ht);var gr=O.parse(Wt,ar,ut);if(!gr)return null;ut=ut||gr.type,Ze.push([Bt,gr])}return ut.kind==="number"||ut.kind==="color"||ut.kind==="array"&&ut.itemType.kind==="number"&&typeof ut.N=="number"?new Wa(ut,q,re,fe,Ze):O.error("Type "+ir(ut)+" is not interpolatable.")},Wa.prototype.evaluate=function(_){var O=this.labels,q=this.outputs;if(O.length===1)return q[0].evaluate(_);var re=this.input.evaluate(_);if(re<=O[0])return q[0].evaluate(_);var fe=O.length;if(re>=O[fe-1])return q[fe-1].evaluate(_);var me=Pn(O,re),Ae=O[me],De=O[me+1],Ze=Wa.interpolationFactor(this.interpolation,re,Ae,De),ut=q[me].evaluate(_),gt=q[me+1].evaluate(_);return this.operator==="interpolate"?yn[this.type.kind.toLowerCase()](ut,gt,Ze):this.operator==="interpolate-hcl"?to.reverse(to.interpolate(to.forward(ut),to.forward(gt),Ze)):$i.reverse($i.interpolate($i.forward(ut),$i.forward(gt),Ze))},Wa.prototype.eachChild=function(_){_(this.input);for(var O=0,q=this.outputs;O<q.length;O+=1)_(q[O])},Wa.prototype.outputDefined=function(){return this.outputs.every(function(_){return _.outputDefined()})},Wa.prototype.serialize=function(){var _;_=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var O=[this.operator,_,this.input.serialize()],q=0;q<this.labels.length;q++)O.push(this.labels[q],this.outputs[q].serialize());return O};var Ao=function(_,O){this.type=_,this.args=O};Ao.parse=function(_,O){if(_.length<2)return O.error("Expectected at least one argument.");var q=null,re=O.expectedType;re&&re.kind!=="value"&&(q=re);for(var fe=[],me=0,Ae=_.slice(1);me<Ae.length;me+=1){var De=Ae[me],Ze=O.parse(De,1+fe.length,q,void 0,{typeAnnotation:"omit"});if(!Ze)return null;q=q||Ze.type,fe.push(Ze)}var ut=re&&fe.some(function(gt){return Kt(re,gt.type)});return new Ao(ut?Ie:q,fe)},Ao.prototype.evaluate=function(_){for(var O,q=null,re=0,fe=0,me=this.args;fe<me.length&&(re++,(q=me[fe].evaluate(_))&&q instanceof _r&&!q.available&&(O||(O=q.name),q=null,re===this.args.length&&(q=O)),q===null);fe+=1);return q},Ao.prototype.eachChild=function(_){this.args.forEach(_)},Ao.prototype.outputDefined=function(){return this.args.every(function(_){return _.outputDefined()})},Ao.prototype.serialize=function(){var _=["coalesce"];return this.eachChild(function(O){_.push(O.serialize())}),_};var Mi=function(_,O){this.type=O.type,this.bindings=[].concat(_),this.result=O};Mi.prototype.evaluate=function(_){return this.result.evaluate(_)},Mi.prototype.eachChild=function(_){for(var O=0,q=this.bindings;O<q.length;O+=1)_(q[O][1]);_(this.result)},Mi.parse=function(_,O){if(_.length<4)return O.error("Expected at least 3 arguments, but found "+(_.length-1)+" instead.");for(var q=[],re=1;re<_.length-1;re+=2){var fe=_[re];if(typeof fe!="string")return O.error("Expected string, but found "+typeof fe+" instead.",re);if(/[^a-zA-Z0-9_]/.test(fe))return O.error("Variable names must contain only alphanumeric characters or '_'.",re);var me=O.parse(_[re+1],re+1);if(!me)return null;q.push([fe,me])}var Ae=O.parse(_[_.length-1],_.length-1,O.expectedType,q);return Ae?new Mi(q,Ae):null},Mi.prototype.outputDefined=function(){return this.result.outputDefined()},Mi.prototype.serialize=function(){for(var _=["let"],O=0,q=this.bindings;O<q.length;O+=1){var re=q[O],fe=re[0],me=re[1];_.push(fe,me.serialize())}return _.push(this.result.serialize()),_};var ro=function(_,O,q){this.type=_,this.index=O,this.input=q};ro.parse=function(_,O){if(_.length!==3)return O.error("Expected 2 arguments, but found "+(_.length-1)+" instead.");var q=O.parse(_[1],1,it),re=O.parse(_[2],2,Gt(O.expectedType||Ie));if(!q||!re)return null;var fe=re.type;return new ro(fe.itemType,q,re)},ro.prototype.evaluate=function(_){var O=this.index.evaluate(_),q=this.input.evaluate(_);if(O<0)throw new Sn("Array index out of bounds: "+O+" < 0.");if(O>=q.length)throw new Sn("Array index out of bounds: "+O+" > "+(q.length-1)+".");if(O!==Math.floor(O))throw new Sn("Array index must be an integer, but found "+O+" instead.");return q[O]},ro.prototype.eachChild=function(_){_(this.index),_(this.input)},ro.prototype.outputDefined=function(){return!1},ro.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Mo=function(_,O){this.type=Nt,this.needle=_,this.haystack=O};Mo.parse=function(_,O){if(_.length!==3)return O.error("Expected 2 arguments, but found "+(_.length-1)+" instead.");var q=O.parse(_[1],1,Ie),re=O.parse(_[2],2,Ie);return q&&re?or(q.type,[Nt,St,it,xt,Ie])?new Mo(q,re):O.error("Expected first argument to be of type boolean, string, number or null, but found "+ir(q.type)+" instead"):null},Mo.prototype.evaluate=function(_){var O=this.needle.evaluate(_),q=this.haystack.evaluate(_);if(!q)return!1;if(!dr(O,["boolean","string","number","null"]))throw new Sn("Expected first argument to be of type boolean, string, number or null, but found "+ir(pn(O))+" instead.");if(!dr(q,["string","array"]))throw new Sn("Expected second argument to be of type array or string, but found "+ir(pn(q))+" instead.");return q.indexOf(O)>=0},Mo.prototype.eachChild=function(_){_(this.needle),_(this.haystack)},Mo.prototype.outputDefined=function(){return!0},Mo.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var zo=function(_,O,q){this.type=it,this.needle=_,this.haystack=O,this.fromIndex=q};zo.parse=function(_,O){if(_.length<=2||_.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(_.length-1)+" instead.");var q=O.parse(_[1],1,Ie),re=O.parse(_[2],2,Ie);if(!q||!re)return null;if(!or(q.type,[Nt,St,it,xt,Ie]))return O.error("Expected first argument to be of type boolean, string, number or null, but found "+ir(q.type)+" instead");if(_.length===4){var fe=O.parse(_[3],3,it);return fe?new zo(q,re,fe):null}return new zo(q,re)},zo.prototype.evaluate=function(_){var O=this.needle.evaluate(_),q=this.haystack.evaluate(_);if(!dr(O,["boolean","string","number","null"]))throw new Sn("Expected first argument to be of type boolean, string, number or null, but found "+ir(pn(O))+" instead.");if(!dr(q,["string","array"]))throw new Sn("Expected second argument to be of type array or string, but found "+ir(pn(q))+" instead.");if(this.fromIndex){var re=this.fromIndex.evaluate(_);return q.indexOf(O,re)}return q.indexOf(O)},zo.prototype.eachChild=function(_){_(this.needle),_(this.haystack),this.fromIndex&&_(this.fromIndex)},zo.prototype.outputDefined=function(){return!1},zo.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var _=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),_]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Vi=function(_,O,q,re,fe,me){this.inputType=_,this.type=O,this.input=q,this.cases=re,this.outputs=fe,this.otherwise=me};Vi.parse=function(_,O){if(_.length<5)return O.error("Expected at least 4 arguments, but found only "+(_.length-1)+".");if(_.length%2!=1)return O.error("Expected an even number of arguments.");var q,re;O.expectedType&&O.expectedType.kind!=="value"&&(re=O.expectedType);for(var fe={},me=[],Ae=2;Ae<_.length-1;Ae+=2){var De=_[Ae],Ze=_[Ae+1];Array.isArray(De)||(De=[De]);var ut=O.concat(Ae);if(De.length===0)return ut.error("Expected at least one branch label.");for(var gt=0,Bt=De;gt<Bt.length;gt+=1){var Wt=Bt[gt];if(typeof Wt!="number"&&typeof Wt!="string")return ut.error("Branch labels must be numbers or strings.");if(typeof Wt=="number"&&Math.abs(Wt)>Number.MAX_SAFE_INTEGER)return ut.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Wt=="number"&&Math.floor(Wt)!==Wt)return ut.error("Numeric branch labels must be integer values.");if(q){if(ut.checkSubtype(q,pn(Wt)))return null}else q=pn(Wt);if(fe[String(Wt)]!==void 0)return ut.error("Branch labels must be unique.");fe[String(Wt)]=me.length}var Ht=O.parse(Ze,Ae,re);if(!Ht)return null;re=re||Ht.type,me.push(Ht)}var ar=O.parse(_[1],1,Ie);if(!ar)return null;var gr=O.parse(_[_.length-1],_.length-1,re);return gr?ar.type.kind!=="value"&&O.concat(1).checkSubtype(q,ar.type)?null:new Vi(q,re,ar,fe,me,gr):null},Vi.prototype.evaluate=function(_){var O=this.input.evaluate(_);return(pn(O)===this.inputType&&this.outputs[this.cases[O]]||this.otherwise).evaluate(_)},Vi.prototype.eachChild=function(_){_(this.input),this.outputs.forEach(_),_(this.otherwise)},Vi.prototype.outputDefined=function(){return this.outputs.every(function(_){return _.outputDefined()})&&this.otherwise.outputDefined()},Vi.prototype.serialize=function(){for(var _=this,O=["match",this.input.serialize()],q=[],re={},fe=0,me=Object.keys(this.cases).sort();fe<me.length;fe+=1){var Ae=me[fe];(Bt=re[this.cases[Ae]])===void 0?(re[this.cases[Ae]]=q.length,q.push([this.cases[Ae],[Ae]])):q[Bt][1].push(Ae)}for(var De=function(Ht){return _.inputType.kind==="number"?Number(Ht):Ht},Ze=0,ut=q;Ze<ut.length;Ze+=1){var gt=ut[Ze],Bt=gt[0],Wt=gt[1];Wt.length===1?O.push(De(Wt[0])):O.push(Wt.map(De)),O.push(this.outputs[outputIndex$1].serialize())}return O.push(this.otherwise.serialize()),O};var yi=function(_,O,q){this.type=_,this.branches=O,this.otherwise=q};yi.parse=function(_,O){if(_.length<4)return O.error("Expected at least 3 arguments, but found only "+(_.length-1)+".");if(_.length%2!=0)return O.error("Expected an odd number of arguments.");var q;O.expectedType&&O.expectedType.kind!=="value"&&(q=O.expectedType);for(var re=[],fe=1;fe<_.length-1;fe+=2){var me=O.parse(_[fe],fe,Nt);if(!me)return null;var Ae=O.parse(_[fe+1],fe+1,q);if(!Ae)return null;re.push([me,Ae]),q=q||Ae.type}var De=O.parse(_[_.length-1],_.length-1,q);return De?new yi(q,re,De):null},yi.prototype.evaluate=function(_){for(var O=0,q=this.branches;O<q.length;O+=1){var re=q[O],fe=re[0],me=re[1];if(fe.evaluate(_))return me.evaluate(_)}return this.otherwise.evaluate(_)},yi.prototype.eachChild=function(_){for(var O=0,q=this.branches;O<q.length;O+=1){var re=q[O],fe=re[0],me=re[1];_(fe),_(me)}_(this.otherwise)},yi.prototype.outputDefined=function(){return this.branches.every(function(_){return _[0],_[1].outputDefined()})&&this.otherwise.outputDefined()},yi.prototype.serialize=function(){var _=["case"];return this.eachChild(function(O){_.push(O.serialize())}),_};var Qi=function(_,O,q,re){this.type=_,this.input=O,this.beginIndex=q,this.endIndex=re};function Vs(_,O){return _==="=="||_==="!="?O.kind==="boolean"||O.kind==="string"||O.kind==="number"||O.kind==="null"||O.kind==="value":O.kind==="string"||O.kind==="number"||O.kind==="value"}function Xs(_,O,q,re){return re.compare(O,q)===0}function Xa(_,O,q){var re=_!=="=="&&_!=="!=";return function(){function fe(me,Ae,De){this.type=Nt,this.lhs=me,this.rhs=Ae,this.collator=De,this.hasUntypedArgument=me.type.kind==="value"||Ae.type.kind==="value"}return fe.parse=function(me,Ae){if(me.length!==3&&me.length!==4)return Ae.error("Expected two or three arguments.");var De=me[0],Ze=Ae.parse(me[1],1,Ie);if(!Ze)return null;if(!Vs(De,Ze.type))return Ae.concat(1).error('"'+De+`" comparisons are not supported for type '`+ir(Ze.type)+"'.");var ut=Ae.parse(me[2],2,Ie);if(!ut)return null;if(!Vs(De,ut.type))return Ae.concat(2).error('"'+De+`" comparisons are not supported for type '`+ir(ut.type)+"'.");if(Ze.type.kind!==ut.type.kind&&Ze.type.kind!=="value"&&ut.type.kind!=="value")return Ae.error("Cannot compare types '"+ir(Ze.type)+"' and '"+ir(ut.type)+"'.");re&&(Ze.type.kind==="value"&&ut.type.kind!=="value"?Ze=new Nr(ut.type,[Ze]):Ze.type.kind!=="value"&&ut.type.kind==="value"&&(ut=new Nr(Ze.type,[ut])));var gt=null;if(me.length===4){if(Ze.type.kind!=="string"&&ut.type.kind!=="string"&&Ze.type.kind!=="value"&&ut.type.kind!=="value")return Ae.error("Cannot use collator to compare non-string types.");if(!(gt=Ae.parse(me[3],3,lt)))return null}return new fe(Ze,ut,gt)},fe.prototype.evaluate=function(me){var Ae=this.lhs.evaluate(me),De=this.rhs.evaluate(me);if(re&&this.hasUntypedArgument){var Ze=pn(Ae),ut=pn(De);if(Ze.kind!==ut.kind||Ze.kind!=="string"&&Ze.kind!=="number")throw new Sn('Expected arguments for "'+_+'" to be (string, string) or (number, number), but found ('+Ze.kind+", "+ut.kind+") instead.")}if(this.collator&&!re&&this.hasUntypedArgument){var gt=pn(Ae),Bt=pn(De);if(gt.kind!=="string"||Bt.kind!=="string")return O(me,Ae,De)}return this.collator?q(me,Ae,De,this.collator.evaluate(me)):O(me,Ae,De)},fe.prototype.eachChild=function(me){me(this.lhs),me(this.rhs),this.collator&&me(this.collator)},fe.prototype.outputDefined=function(){return!0},fe.prototype.serialize=function(){var me=[_];return this.eachChild(function(Ae){me.push(Ae.serialize())}),me},fe}()}Qi.parse=function(_,O){if(_.length<=2||_.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(_.length-1)+" instead.");var q=O.parse(_[1],1,Ie),re=O.parse(_[2],2,it);if(!q||!re)return null;if(!or(q.type,[Gt(Ie),St,Ie]))return O.error("Expected first argument to be of type array or string, but found "+ir(q.type)+" instead");if(_.length===4){var fe=O.parse(_[3],3,it);return fe?new Qi(q.type,q,re,fe):null}return new Qi(q.type,q,re)},Qi.prototype.evaluate=function(_){var O=this.input.evaluate(_),q=this.beginIndex.evaluate(_);if(!dr(O,["string","array"]))throw new Sn("Expected first argument to be of type array or string, but found "+ir(pn(O))+" instead.");if(this.endIndex){var re=this.endIndex.evaluate(_);return O.slice(q,re)}return O.slice(q)},Qi.prototype.eachChild=function(_){_(this.input),_(this.beginIndex),this.endIndex&&_(this.endIndex)},Qi.prototype.outputDefined=function(){return!1},Qi.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var _=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),_]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Os=Xa("==",function(_,O,q){return O===q},Xs),ms=Xa("!=",function(_,O,q){return O!==q},function(_,O,q,re){return!Xs(0,O,q,re)}),Zs=Xa("<",function(_,O,q){return O<q},function(_,O,q,re){return re.compare(O,q)<0}),Ks=Xa(">",function(_,O,q){return O>q},function(_,O,q,re){return re.compare(O,q)>0}),Hs=Xa("<=",function(_,O,q){return O<=q},function(_,O,q,re){return re.compare(O,q)<=0}),Js=Xa(">=",function(_,O,q){return O>=q},function(_,O,q,re){return re.compare(O,q)>=0}),Uo=function(_,O,q,re,fe){this.type=St,this.number=_,this.locale=O,this.currency=q,this.minFractionDigits=re,this.maxFractionDigits=fe};Uo.parse=function(_,O){if(_.length!==3)return O.error("Expected two arguments.");var q=O.parse(_[1],1,it);if(!q)return null;var re=_[2];if(typeof re!="object"||Array.isArray(re))return O.error("NumberFormat options argument must be an object.");var fe=null;if(re.locale&&!(fe=O.parse(re.locale,1,St)))return null;var me=null;if(re.currency&&!(me=O.parse(re.currency,1,St)))return null;var Ae=null;if(re["min-fraction-digits"]&&!(Ae=O.parse(re["min-fraction-digits"],1,it)))return null;var De=null;return re["max-fraction-digits"]&&!(De=O.parse(re["max-fraction-digits"],1,it))?null:new Uo(q,fe,me,Ae,De)},Uo.prototype.evaluate=function(_){return new Intl.NumberFormat(this.locale?this.locale.evaluate(_):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(_):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(_):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(_):void 0}).format(this.number.evaluate(_))},Uo.prototype.eachChild=function(_){_(this.number),this.locale&&_(this.locale),this.currency&&_(this.currency),this.minFractionDigits&&_(this.minFractionDigits),this.maxFractionDigits&&_(this.maxFractionDigits)},Uo.prototype.outputDefined=function(){return!1},Uo.prototype.serialize=function(){var _={};return this.locale&&(_.locale=this.locale.serialize()),this.currency&&(_.currency=this.currency.serialize()),this.minFractionDigits&&(_["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(_["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),_]};var Vo=function(_){this.type=it,this.input=_};Vo.parse=function(_,O){if(_.length!==2)return O.error("Expected 1 argument, but found "+(_.length-1)+" instead.");var q=O.parse(_[1],1);return q?q.type.kind!=="array"&&q.type.kind!=="string"&&q.type.kind!=="value"?O.error("Expected argument of type string or array, but found "+ir(q.type)+" instead."):new Vo(q):null},Vo.prototype.evaluate=function(_){var O=this.input.evaluate(_);if(typeof O=="string"||Array.isArray(O))return O.length;throw new Sn("Expected value to be of type string or array, but found "+ir(pn(O))+" instead.")},Vo.prototype.eachChild=function(_){_(this.input)},Vo.prototype.outputDefined=function(){return!1},Vo.prototype.serialize=function(){var _=["length"];return this.eachChild(function(O){_.push(O.serialize())}),_};var ts={"==":Os,"!=":ms,">":Ks,"<":Zs,">=":Js,"<=":Hs,array:Nr,at:ro,boolean:Nr,case:yi,coalesce:Ao,collator:Bn,format:Pr,image:en,in:Mo,"index-of":zo,interpolate:Wa,"interpolate-hcl":Wa,"interpolate-lab":Wa,length:Vo,let:Mi,literal:On,match:Vi,number:Nr,"number-format":Uo,object:Nr,slice:Qi,step:sa,string:Nr,"to-boolean":Qr,"to-color":Qr,"to-number":Qr,"to-string":Qr,var:vn,within:Jr};function rs(_,O){var q=O[0],re=O[1],fe=O[2],me=O[3];q=q.evaluate(_),re=re.evaluate(_),fe=fe.evaluate(_);var Ae=me?me.evaluate(_):1,De=jr(q,re,fe,Ae);if(De)throw new Sn(De);return new ur(q/255*Ae,re/255*Ae,fe/255*Ae,Ae)}function ns(_,O){return _ in O}function vs(_,O){var q=O[_];return q===void 0?null:q}function So(_){return{type:_}}function Ds(_){return{result:"success",value:_}}function vo(_){return{result:"error",value:_}}function as(_){return _["property-type"]==="data-driven"||_["property-type"]==="cross-faded-data-driven"}function zs(_){return!!_.expression&&_.expression.parameters.indexOf("zoom")>-1}function Ho(_){return!!_.expression&&_.expression.interpolated}function qa(_){return _ instanceof Number?"number":_ instanceof String?"string":_ instanceof Boolean?"boolean":Array.isArray(_)?"array":_===null?"null":typeof _}function Re(_){return typeof _=="object"&&_!==null&&!Array.isArray(_)}function Ve(_){return _}function $e(_,O,q){return _!==void 0?_:O!==void 0?O:q!==void 0?q:void 0}function ot(_,O,q,re,fe){return $e(typeof q===fe?re[q]:void 0,_.default,O.default)}function mt(_,O,q){if(qa(q)!=="number")return $e(_.default,O.default);var re=_.stops.length;if(re===1||q<=_.stops[0][0])return _.stops[0][1];if(q>=_.stops[re-1][0])return _.stops[re-1][1];var fe=Pn(_.stops.map(function(me){return me[0]}),q);return _.stops[fe][1]}function dt(_,O,q){var re=_.base!==void 0?_.base:1;if(qa(q)!=="number")return $e(_.default,O.default);var fe=_.stops.length;if(fe===1||q<=_.stops[0][0])return _.stops[0][1];if(q>=_.stops[fe-1][0])return _.stops[fe-1][1];var me=Pn(_.stops.map(function(Bt){return Bt[0]}),q),Ae=function(Bt,Wt,Ht,ar){var gr=ar-Ht,Cr=Bt-Ht;return gr===0?0:Wt===1?Cr/gr:(Math.pow(Wt,Cr)-1)/(Math.pow(Wt,gr)-1)}(q,re,_.stops[me][0],_.stops[me+1][0]),De=_.stops[me][1],Ze=_.stops[me+1][1],ut=yn[O.type]||Ve;if(_.colorSpace&&_.colorSpace!=="rgb"){var gt=es[_.colorSpace];ut=function(Bt,Wt){return gt.reverse(gt.interpolate(gt.forward(Bt),gt.forward(Wt),Ae))}}return typeof De.evaluate=="function"?{evaluate:function(){for(var Bt=[],Wt=arguments.length;Wt--;)Bt[Wt]=arguments[Wt];var Ht=De.evaluate.apply(void 0,Bt),ar=Ze.evaluate.apply(void 0,Bt);if(Ht!==void 0&&ar!==void 0)return ut(Ht,ar,Ae)}}:ut(De,Ze,Ae)}function Et(_,O,q){return O.type==="color"?q=ur.parse(q):O.type==="formatted"?q=Rr.fromString(q.toString()):O.type==="resolvedImage"?q=_r.fromString(q.toString()):qa(q)===O.type||O.type==="enum"&&O.values[q]||(q=void 0),$e(q,_.default,O.default)}En.register(ts,{error:[{kind:"error"},[St],function(_,O){var q=O[0];throw new Sn(q.evaluate(_))}],typeof:[St,[Ie],function(_,O){return ir(pn(O[0].evaluate(_)))}],"to-rgba":[Gt(it,4),[Ut],function(_,O){return O[0].evaluate(_).toArray()}],rgb:[Ut,[it,it,it],rs],rgba:[Ut,[it,it,it,it],rs],has:{type:Nt,overloads:[[[St],function(_,O){return ns(O[0].evaluate(_),_.properties())}],[[St,Qt],function(_,O){var q=O[0],re=O[1];return ns(q.evaluate(_),re.evaluate(_))}]]},get:{type:Ie,overloads:[[[St],function(_,O){return vs(O[0].evaluate(_),_.properties())}],[[St,Qt],function(_,O){var q=O[0],re=O[1];return vs(q.evaluate(_),re.evaluate(_))}]]},"feature-state":[Ie,[St],function(_,O){return vs(O[0].evaluate(_),_.featureState||{})}],properties:[Qt,[],function(_){return _.properties()}],"geometry-type":[St,[],function(_){return _.geometryType()}],id:[Ie,[],function(_){return _.id()}],zoom:[it,[],function(_){return _.globals.zoom}],"heatmap-density":[it,[],function(_){return _.globals.heatmapDensity||0}],"line-progress":[it,[],function(_){return _.globals.lineProgress||0}],accumulated:[Ie,[],function(_){return _.globals.accumulated===void 0?null:_.globals.accumulated}],"+":[it,So(it),function(_,O){for(var q=0,re=0,fe=O;re<fe.length;re+=1)q+=fe[re].evaluate(_);return q}],"*":[it,So(it),function(_,O){for(var q=1,re=0,fe=O;re<fe.length;re+=1)q*=fe[re].evaluate(_);return q}],"-":{type:it,overloads:[[[it,it],function(_,O){var q=O[0],re=O[1];return q.evaluate(_)-re.evaluate(_)}],[[it],function(_,O){return-O[0].evaluate(_)}]]},"/":[it,[it,it],function(_,O){var q=O[0],re=O[1];return q.evaluate(_)/re.evaluate(_)}],"%":[it,[it,it],function(_,O){var q=O[0],re=O[1];return q.evaluate(_)%re.evaluate(_)}],ln2:[it,[],function(){return Math.LN2}],pi:[it,[],function(){return Math.PI}],e:[it,[],function(){return Math.E}],"^":[it,[it,it],function(_,O){var q=O[0],re=O[1];return Math.pow(q.evaluate(_),re.evaluate(_))}],sqrt:[it,[it],function(_,O){var q=O[0];return Math.sqrt(q.evaluate(_))}],log10:[it,[it],function(_,O){var q=O[0];return Math.log(q.evaluate(_))/Math.LN10}],ln:[it,[it],function(_,O){var q=O[0];return Math.log(q.evaluate(_))}],log2:[it,[it],function(_,O){var q=O[0];return Math.log(q.evaluate(_))/Math.LN2}],sin:[it,[it],function(_,O){var q=O[0];return Math.sin(q.evaluate(_))}],cos:[it,[it],function(_,O){var q=O[0];return Math.cos(q.evaluate(_))}],tan:[it,[it],function(_,O){var q=O[0];return Math.tan(q.evaluate(_))}],asin:[it,[it],function(_,O){var q=O[0];return Math.asin(q.evaluate(_))}],acos:[it,[it],function(_,O){var q=O[0];return Math.acos(q.evaluate(_))}],atan:[it,[it],function(_,O){var q=O[0];return Math.atan(q.evaluate(_))}],min:[it,So(it),function(_,O){return Math.min.apply(Math,O.map(function(q){return q.evaluate(_)}))}],max:[it,So(it),function(_,O){return Math.max.apply(Math,O.map(function(q){return q.evaluate(_)}))}],abs:[it,[it],function(_,O){var q=O[0];return Math.abs(q.evaluate(_))}],round:[it,[it],function(_,O){var q=O[0].evaluate(_);return q<0?-Math.round(-q):Math.round(q)}],floor:[it,[it],function(_,O){var q=O[0];return Math.floor(q.evaluate(_))}],ceil:[it,[it],function(_,O){var q=O[0];return Math.ceil(q.evaluate(_))}],"filter-==":[Nt,[St,Ie],function(_,O){var q=O[0],re=O[1];return _.properties()[q.value]===re.value}],"filter-id-==":[Nt,[Ie],function(_,O){var q=O[0];return _.id()===q.value}],"filter-type-==":[Nt,[St],function(_,O){var q=O[0];return _.geometryType()===q.value}],"filter-<":[Nt,[St,Ie],function(_,O){var q=O[0],re=O[1],fe=_.properties()[q.value],me=re.value;return typeof fe==typeof me&&fe<me}],"filter-id-<":[Nt,[Ie],function(_,O){var q=O[0],re=_.id(),fe=q.value;return typeof re==typeof fe&&re<fe}],"filter->":[Nt,[St,Ie],function(_,O){var q=O[0],re=O[1],fe=_.properties()[q.value],me=re.value;return typeof fe==typeof me&&fe>me}],"filter-id->":[Nt,[Ie],function(_,O){var q=O[0],re=_.id(),fe=q.value;return typeof re==typeof fe&&re>fe}],"filter-<=":[Nt,[St,Ie],function(_,O){var q=O[0],re=O[1],fe=_.properties()[q.value],me=re.value;return typeof fe==typeof me&&fe<=me}],"filter-id-<=":[Nt,[Ie],function(_,O){var q=O[0],re=_.id(),fe=q.value;return typeof re==typeof fe&&re<=fe}],"filter->=":[Nt,[St,Ie],function(_,O){var q=O[0],re=O[1],fe=_.properties()[q.value],me=re.value;return typeof fe==typeof me&&fe>=me}],"filter-id->=":[Nt,[Ie],function(_,O){var q=O[0],re=_.id(),fe=q.value;return typeof re==typeof fe&&re>=fe}],"filter-has":[Nt,[Ie],function(_,O){return O[0].value in _.properties()}],"filter-has-id":[Nt,[],function(_){return _.id()!==null&&_.id()!==void 0}],"filter-type-in":[Nt,[Gt(St)],function(_,O){return O[0].value.indexOf(_.geometryType())>=0}],"filter-id-in":[Nt,[Gt(Ie)],function(_,O){return O[0].value.indexOf(_.id())>=0}],"filter-in-small":[Nt,[St,Gt(Ie)],function(_,O){var q=O[0];return O[1].value.indexOf(_.properties()[q.value])>=0}],"filter-in-large":[Nt,[St,Gt(Ie)],function(_,O){var q=O[0],re=O[1];return function(fe,me,Ae,De){for(;Ae<=De;){var Ze=Ae+De>>1;if(me[Ze]===fe)return!0;me[Ze]>fe?De=Ze-1:Ae=Ze+1}return!1}(_.properties()[q.value],re.value,0,re.value.length-1)}],all:{type:Nt,overloads:[[[Nt,Nt],function(_,O){var q=O[0],re=O[1];return q.evaluate(_)&&re.evaluate(_)}],[So(Nt),function(_,O){for(var q=0,re=O;q<re.length;q+=1)if(!re[q].evaluate(_))return!1;return!0}]]},any:{type:Nt,overloads:[[[Nt,Nt],function(_,O){var q=O[0],re=O[1];return q.evaluate(_)||re.evaluate(_)}],[So(Nt),function(_,O){for(var q=0,re=O;q<re.length;q+=1)if(re[q].evaluate(_))return!0;return!1}]]},"!":[Nt,[Nt],function(_,O){return!O[0].evaluate(_)}],"is-supported-script":[Nt,[St],function(_,O){var q=O[0],re=_.globals&&_.globals.isSupportedScript;return!re||re(q.evaluate(_))}],upcase:[St,[St],function(_,O){return O[0].evaluate(_).toUpperCase()}],downcase:[St,[St],function(_,O){return O[0].evaluate(_).toLowerCase()}],concat:[St,So(Ie),function(_,O){return O.map(function(q){return In(q.evaluate(_))}).join("")}],"resolved-locale":[St,[lt],function(_,O){return O[0].evaluate(_).resolvedLocale()}]});var Zt=function(_,O){this.expression=_,this._warningHistory={},this._evaluator=new An,this._defaultValue=O?function(q){return q.type==="color"&&Re(q.default)?new ur(0,0,0,0):q.type==="color"?ur.parse(q.default)||null:q.default===void 0?null:q.default}(O):null,this._enumValues=O&&O.type==="enum"?O.values:null};function $t(_){return Array.isArray(_)&&_.length>0&&typeof _[0]=="string"&&_[0]in ts}function Yt(_,O){var q=new dn(ts,[],O?function(fe){var me={color:Ut,string:St,number:it,enum:St,boolean:Nt,formatted:wt,resolvedImage:Ot};return fe.type==="array"?Gt(me[fe.value]||Ie,fe.length):me[fe.type]}(O):void 0),re=q.parse(_,void 0,void 0,void 0,O&&O.type==="string"?{typeAnnotation:"coerce"}:void 0);return re?Ds(new Zt(re,O)):vo(q.errors)}Zt.prototype.evaluateWithoutErrorHandling=function(_,O,q,re,fe,me){return this._evaluator.globals=_,this._evaluator.feature=O,this._evaluator.featureState=q,this._evaluator.canonical=re,this._evaluator.availableImages=fe||null,this._evaluator.formattedSection=me,this.expression.evaluate(this._evaluator)},Zt.prototype.evaluate=function(_,O,q,re,fe,me){this._evaluator.globals=_,this._evaluator.feature=O||null,this._evaluator.featureState=q||null,this._evaluator.canonical=re,this._evaluator.availableImages=fe||null,this._evaluator.formattedSection=me||null;try{var Ae=this.expression.evaluate(this._evaluator);if(Ae==null||typeof Ae=="number"&&Ae!=Ae)return this._defaultValue;if(this._enumValues&&!(Ae in this._enumValues))throw new Sn("Expected value to be one of "+Object.keys(this._enumValues).map(function(De){return JSON.stringify(De)}).join(", ")+", but found "+JSON.stringify(Ae)+" instead.");return Ae}catch(De){return this._warningHistory[De.message]||(this._warningHistory[De.message]=!0,typeof console!="undefined"&&console.warn(De.message)),this._defaultValue}};var nr=function(_,O){this.kind=_,this._styleExpression=O,this.isStateDependent=_!=="constant"&&!Dr(O.expression)};nr.prototype.evaluateWithoutErrorHandling=function(_,O,q,re,fe,me){return this._styleExpression.evaluateWithoutErrorHandling(_,O,q,re,fe,me)},nr.prototype.evaluate=function(_,O,q,re,fe,me){return this._styleExpression.evaluate(_,O,q,re,fe,me)};var cr=function(_,O,q,re){this.kind=_,this.zoomStops=q,this._styleExpression=O,this.isStateDependent=_!=="camera"&&!Dr(O.expression),this.interpolationType=re};function mr(_,O){if((_=Yt(_,O)).result==="error")return _;var q=_.value.expression,re=bn(q);if(!re&&!as(O))return vo([new vt("","data expressions not supported")]);var fe=Wr(q,["zoom"]);if(!fe&&!zs(O))return vo([new vt("","zoom expressions not supported")]);var me=function De(Ze){var ut=null;if(Ze instanceof Mi)ut=De(Ze.result);else if(Ze instanceof Ao)for(var gt=0,Bt=Ze.args;gt<Bt.length;gt+=1){var Wt=Bt[gt];if(ut=De(Wt))break}else(Ze instanceof sa||Ze instanceof Wa)&&Ze.input instanceof En&&Ze.input.name==="zoom"&&(ut=Ze);return ut instanceof vt||Ze.eachChild(function(Ht){var ar=De(Ht);ar instanceof vt?ut=ar:!ut&&ar?ut=new vt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):ut&&ar&&ut!==ar&&(ut=new vt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),ut}(q);if(!me&&!fe)return vo([new vt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(me instanceof vt)return vo([me]);if(me instanceof Wa&&!Ho(O))return vo([new vt("",'"interpolate" expressions cannot be used with this property')]);if(!me)return Ds(new nr(re?"constant":"source",_.value));var Ae=me instanceof Wa?me.interpolation:void 0;return Ds(new cr(re?"camera":"composite",_.value,me.labels,Ae))}cr.prototype.evaluateWithoutErrorHandling=function(_,O,q,re,fe,me){return this._styleExpression.evaluateWithoutErrorHandling(_,O,q,re,fe,me)},cr.prototype.evaluate=function(_,O,q,re,fe,me){return this._styleExpression.evaluate(_,O,q,re,fe,me)},cr.prototype.interpolationFactor=function(_,O,q){return this.interpolationType?Wa.interpolationFactor(this.interpolationType,_,O,q):0};var yr=function(_,O){this._parameters=_,this._specification=O,Mt(this,function q(re,fe){var me,Ae,De,Ze=fe.type==="color",ut=re.stops&&typeof re.stops[0][0]=="object",gt=ut||re.property!==void 0,Bt=ut||!gt,Wt=re.type||(Ho(fe)?"exponential":"interval");if(Ze&&((re=Mt({},re)).stops&&(re.stops=re.stops.map(function(ia){return[ia[0],ur.parse(ia[1])]})),re.default?re.default=ur.parse(re.default):re.default=ur.parse(fe.default)),re.colorSpace&&re.colorSpace!=="rgb"&&!es[re.colorSpace])throw new Error("Unknown color space: "+re.colorSpace);if(Wt==="exponential")me=dt;else if(Wt==="interval")me=mt;else if(Wt==="categorical"){me=ot,Ae=Object.create(null);for(var Ht=0,ar=re.stops;Ht<ar.length;Ht+=1){var gr=ar[Ht];Ae[gr[0]]=gr[1]}De=typeof re.stops[0][0]}else{if(Wt!=="identity")throw new Error('Unknown function type "'+Wt+'"');me=Et}if(ut){for(var Cr={},Er=[],Fr=0;Fr<re.stops.length;Fr++){var Br=re.stops[Fr],Hr=Br[0].zoom;Cr[Hr]===void 0&&(Cr[Hr]={zoom:Hr,type:re.type,property:re.property,default:re.default,stops:[]},Er.push(Hr)),Cr[Hr].stops.push([Br[0].value,Br[1]])}for(var fn=[],xn=0,Nn=Er;xn<Nn.length;xn+=1){var Fn=Nn[xn];fn.push([Cr[Fn].zoom,q(Cr[Fn],fe)])}var qn={name:"linear"};return{kind:"composite",interpolationType:qn,interpolationFactor:Wa.interpolationFactor.bind(void 0,qn),zoomStops:fn.map(function(ia){return ia[0]}),evaluate:function(ia,Zn){var ha=ia.zoom;return dt({stops:fn,base:re.base},fe,ha).evaluate(ha,Zn)}}}if(Bt){var na=Wt==="exponential"?{name:"exponential",base:re.base!==void 0?re.base:1}:null;return{kind:"camera",interpolationType:na,interpolationFactor:Wa.interpolationFactor.bind(void 0,na),zoomStops:re.stops.map(function(ia){return ia[0]}),evaluate:function(ia){var Zn=ia.zoom;return me(re,fe,Zn,Ae,De)}}}return{kind:"source",evaluate:function(ia,Zn){var ha=Zn&&Zn.properties?Zn.properties[re.property]:void 0;return ha===void 0?$e(re.default,fe.default):me(re,fe,ha,Ae,De)}}}(this._parameters,this._specification))};function Or(_){var O=_.key,q=_.value,re=_.valueSpec||{},fe=_.objectElementValidators||{},me=_.style,Ae=_.styleSpec,De=[],Ze=qa(q);if(Ze!=="object")return[new Xe(O,q,"object expected, "+Ze+" found")];for(var ut in q){var gt=ut.split(".")[0],Bt=re[gt]||re["*"],Wt=void 0;if(fe[gt])Wt=fe[gt];else if(re[gt])Wt=sr;else if(fe["*"])Wt=fe["*"];else{if(!re["*"]){De.push(new Xe(O,q[ut],'unknown property "'+ut+'"'));continue}Wt=sr}De=De.concat(Wt({key:(O&&O+".")+ut,value:q[ut],valueSpec:Bt,style:me,styleSpec:Ae,object:q,objectKey:ut},q))}for(var Ht in re)fe[Ht]||re[Ht].required&&re[Ht].default===void 0&&q[Ht]===void 0&&De.push(new Xe(O,q,'missing required property "'+Ht+'"'));return De}function nn(_){var O=_.value,q=_.valueSpec,re=_.style,fe=_.styleSpec,me=_.key,Ae=_.arrayElementValidator||sr;if(qa(O)!=="array")return[new Xe(me,O,"array expected, "+qa(O)+" found")];if(q.length&&O.length!==q.length)return[new Xe(me,O,"array length "+q.length+" expected, length "+O.length+" found")];if(q["min-length"]&&O.length<q["min-length"])return[new Xe(me,O,"array length at least "+q["min-length"]+" expected, length "+O.length+" found")];var De={type:q.value,values:q.values};fe.$version<7&&(De.function=q.function),qa(q.value)==="object"&&(De=q.value);for(var Ze=[],ut=0;ut<O.length;ut++)Ze=Ze.concat(Ae({array:O,arrayIndex:ut,value:O[ut],valueSpec:De,style:re,styleSpec:fe,key:me+"["+ut+"]"}));return Ze}function gn(_){var O=_.key,q=_.value,re=_.valueSpec,fe=qa(q);return fe==="number"&&q!=q&&(fe="NaN"),fe!=="number"?[new Xe(O,q,"number expected, "+fe+" found")]:"minimum"in re&&q<re.minimum?[new Xe(O,q,q+" is less than the minimum value "+re.minimum)]:"maximum"in re&&q>re.maximum?[new Xe(O,q,q+" is greater than the maximum value "+re.maximum)]:[]}function Cn(_){var O,q,re,fe=_.valueSpec,me=pt(_.value.type),Ae={},De=me!=="categorical"&&_.value.property===void 0,Ze=!De,ut=qa(_.value.stops)==="array"&&qa(_.value.stops[0])==="array"&&qa(_.value.stops[0][0])==="object",gt=Or({key:_.key,value:_.value,valueSpec:_.styleSpec.function,style:_.style,styleSpec:_.styleSpec,objectElementValidators:{stops:function(Ht){if(me==="identity")return[new Xe(Ht.key,Ht.value,'identity function may not have a "stops" property')];var ar=[],gr=Ht.value;return ar=ar.concat(nn({key:Ht.key,value:gr,valueSpec:Ht.valueSpec,style:Ht.style,styleSpec:Ht.styleSpec,arrayElementValidator:Bt})),qa(gr)==="array"&&gr.length===0&&ar.push(new Xe(Ht.key,gr,"array must have at least one stop")),ar},default:function(Ht){return sr({key:Ht.key,value:Ht.value,valueSpec:fe,style:Ht.style,styleSpec:Ht.styleSpec})}}});return me==="identity"&&De&&gt.push(new Xe(_.key,_.value,'missing required property "property"')),me==="identity"||_.value.stops||gt.push(new Xe(_.key,_.value,'missing required property "stops"')),me==="exponential"&&_.valueSpec.expression&&!Ho(_.valueSpec)&&gt.push(new Xe(_.key,_.value,"exponential functions not supported")),_.styleSpec.$version>=8&&(Ze&&!as(_.valueSpec)?gt.push(new Xe(_.key,_.value,"property functions not supported")):De&&!zs(_.valueSpec)&&gt.push(new Xe(_.key,_.value,"zoom functions not supported"))),me!=="categorical"&&!ut||_.value.property!==void 0||gt.push(new Xe(_.key,_.value,'"property" property is required')),gt;function Bt(Ht){var ar=[],gr=Ht.value,Cr=Ht.key;if(qa(gr)!=="array")return[new Xe(Cr,gr,"array expected, "+qa(gr)+" found")];if(gr.length!==2)return[new Xe(Cr,gr,"array length 2 expected, length "+gr.length+" found")];if(ut){if(qa(gr[0])!=="object")return[new Xe(Cr,gr,"object expected, "+qa(gr[0])+" found")];if(gr[0].zoom===void 0)return[new Xe(Cr,gr,"object stop key must have zoom")];if(gr[0].value===void 0)return[new Xe(Cr,gr,"object stop key must have value")];if(re&&re>pt(gr[0].zoom))return[new Xe(Cr,gr[0].zoom,"stop zoom values must appear in ascending order")];pt(gr[0].zoom)!==re&&(re=pt(gr[0].zoom),q=void 0,Ae={}),ar=ar.concat(Or({key:Cr+"[0]",value:gr[0],valueSpec:{zoom:{}},style:Ht.style,styleSpec:Ht.styleSpec,objectElementValidators:{zoom:gn,value:Wt}}))}else ar=ar.concat(Wt({key:Cr+"[0]",value:gr[0],valueSpec:{},style:Ht.style,styleSpec:Ht.styleSpec},gr));return $t(Lt(gr[1]))?ar.concat([new Xe(Cr+"[1]",gr[1],"expressions are not allowed in function stops.")]):ar.concat(sr({key:Cr+"[1]",value:gr[1],valueSpec:fe,style:Ht.style,styleSpec:Ht.styleSpec}))}function Wt(Ht,ar){var gr=qa(Ht.value),Cr=pt(Ht.value),Er=Ht.value!==null?Ht.value:ar;if(O){if(gr!==O)return[new Xe(Ht.key,Er,gr+" stop domain type must match previous stop domain type "+O)]}else O=gr;if(gr!=="number"&&gr!=="string"&&gr!=="boolean")return[new Xe(Ht.key,Er,"stop domain value must be a number, string, or boolean")];if(gr!=="number"&&me!=="categorical"){var Fr="number expected, "+gr+" found";return as(fe)&&me===void 0&&(Fr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Xe(Ht.key,Er,Fr)]}return me!=="categorical"||gr!=="number"||isFinite(Cr)&&Math.floor(Cr)===Cr?me!=="categorical"&&gr==="number"&&q!==void 0&&Cr<q?[new Xe(Ht.key,Er,"stop domain values must appear in ascending order")]:(q=Cr,me==="categorical"&&Cr in Ae?[new Xe(Ht.key,Er,"stop domain values must be unique")]:(Ae[Cr]=!0,[])):[new Xe(Ht.key,Er,"integer expected, found "+Cr)]}}function Dn(_){var O=(_.expressionContext==="property"?mr:Yt)(Lt(_.value),_.valueSpec);if(O.result==="error")return O.value.map(function(re){return new Xe(""+_.key+re.key,_.value,re.message)});var q=O.value.expression||O.value._styleExpression.expression;if(_.expressionContext==="property"&&_.propertyKey==="text-font"&&!q.outputDefined())return[new Xe(_.key,_.value,'Invalid data expression for "'+_.propertyKey+'". Output values must be contained as literals within the expression.')];if(_.expressionContext==="property"&&_.propertyType==="layout"&&!Dr(q))return[new Xe(_.key,_.value,'"feature-state" data expressions are not supported with layout properties.')];if(_.expressionContext==="filter"&&!Dr(q))return[new Xe(_.key,_.value,'"feature-state" data expressions are not supported with filters.')];if(_.expressionContext&&_.expressionContext.indexOf("cluster")===0){if(!Wr(q,["zoom","feature-state"]))return[new Xe(_.key,_.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(_.expressionContext==="cluster-initial"&&!bn(q))return[new Xe(_.key,_.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Hn(_){var O=_.key,q=_.value,re=_.valueSpec,fe=[];return Array.isArray(re.values)?re.values.indexOf(pt(q))===-1&&fe.push(new Xe(O,q,"expected one of ["+re.values.join(", ")+"], "+JSON.stringify(q)+" found")):Object.keys(re.values).indexOf(pt(q))===-1&&fe.push(new Xe(O,q,"expected one of ["+Object.keys(re.values).join(", ")+"], "+JSON.stringify(q)+" found")),fe}function zn(_){if(_===!0||_===!1)return!0;if(!Array.isArray(_)||_.length===0)return!1;switch(_[0]){case"has":return _.length>=2&&_[1]!=="$id"&&_[1]!=="$type";case"in":return _.length>=3&&(typeof _[1]!="string"||Array.isArray(_[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return _.length!==3||Array.isArray(_[1])||Array.isArray(_[2]);case"any":case"all":for(var O=0,q=_.slice(1);O<q.length;O+=1){var re=q[O];if(!zn(re)&&typeof re!="boolean")return!1}return!0;default:return!0}}yr.deserialize=function(_){return new yr(_._parameters,_._specification)},yr.serialize=function(_){return{_parameters:_._parameters,_specification:_._specification}};var ga={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ka(_){if(_==null)return{filter:function(){return!0},needGeometry:!1};zn(_)||(_=Fa(_));var O=Yt(_,ga);if(O.result==="error")throw new Error(O.value.map(function(q){return q.key+": "+q.message}).join(", "));return{filter:function(q,re,fe){return O.value.evaluate(q,re,{},fe)},needGeometry:function q(re){if(!Array.isArray(re))return!1;if(re[0]==="within")return!0;for(var fe=1;fe<re.length;fe++)if(q(re[fe]))return!0;return!1}(_)}}function Ba(_,O){return _<O?-1:_>O?1:0}function Fa(_){if(!_)return!0;var O,q=_[0];return _.length<=1?q!=="any":q==="=="?ja(_[1],_[2],"=="):q==="!="?ui(ja(_[1],_[2],"==")):q==="<"||q===">"||q==="<="||q===">="?ja(_[1],_[2],q):q==="any"?(O=_.slice(1),["any"].concat(O.map(Fa))):q==="all"?["all"].concat(_.slice(1).map(Fa)):q==="none"?["all"].concat(_.slice(1).map(Fa).map(ui)):q==="in"?Si(_[1],_.slice(2)):q==="!in"?ui(Si(_[1],_.slice(2))):q==="has"?Ti(_[1]):q==="!has"?ui(Ti(_[1])):q!=="within"||_}function ja(_,O,q){switch(_){case"$type":return["filter-type-"+q,O];case"$id":return["filter-id-"+q,O];default:return["filter-"+q,_,O]}}function Si(_,O){if(O.length===0)return!1;switch(_){case"$type":return["filter-type-in",["literal",O]];case"$id":return["filter-id-in",["literal",O]];default:return O.length>200&&!O.some(function(q){return typeof q!=typeof O[0]})?["filter-in-large",_,["literal",O.sort(Ba)]]:["filter-in-small",_,["literal",O]]}}function Ti(_){switch(_){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",_]}}function ui(_){return["!",_]}function ci(_){return zn(Lt(_.value))?Dn(Mt({},_,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function O(q){var re=q.value,fe=q.key;if(qa(re)!=="array")return[new Xe(fe,re,"array expected, "+qa(re)+" found")];var me,Ae=q.styleSpec,De=[];if(re.length<1)return[new Xe(fe,re,"filter array must have at least 1 element")];switch(De=De.concat(Hn({key:fe+"[0]",value:re[0],valueSpec:Ae.filter_operator,style:q.style,styleSpec:q.styleSpec})),pt(re[0])){case"<":case"<=":case">":case">=":re.length>=2&&pt(re[1])==="$type"&&De.push(new Xe(fe,re,'"$type" cannot be use with operator "'+re[0]+'"'));case"==":case"!=":re.length!==3&&De.push(new Xe(fe,re,'filter array for operator "'+re[0]+'" must have 3 elements'));case"in":case"!in":re.length>=2&&(me=qa(re[1]))!=="string"&&De.push(new Xe(fe+"[1]",re[1],"string expected, "+me+" found"));for(var Ze=2;Ze<re.length;Ze++)me=qa(re[Ze]),pt(re[1])==="$type"?De=De.concat(Hn({key:fe+"["+Ze+"]",value:re[Ze],valueSpec:Ae.geometry_type,style:q.style,styleSpec:q.styleSpec})):me!=="string"&&me!=="number"&&me!=="boolean"&&De.push(new Xe(fe+"["+Ze+"]",re[Ze],"string, number, or boolean expected, "+me+" found"));break;case"any":case"all":case"none":for(var ut=1;ut<re.length;ut++)De=De.concat(O({key:fe+"["+ut+"]",value:re[ut],style:q.style,styleSpec:q.styleSpec}));break;case"has":case"!has":me=qa(re[1]),re.length!==2?De.push(new Xe(fe,re,'filter array for "'+re[0]+'" operator must have 2 elements')):me!=="string"&&De.push(new Xe(fe+"[1]",re[1],"string expected, "+me+" found"));break;case"within":me=qa(re[1]),re.length!==2?De.push(new Xe(fe,re,'filter array for "'+re[0]+'" operator must have 2 elements')):me!=="object"&&De.push(new Xe(fe+"[1]",re[1],"object expected, "+me+" found"))}return De}(_)}function ki(_,O){var q=_.key,re=_.style,fe=_.styleSpec,me=_.value,Ae=_.objectKey,De=fe[O+"_"+_.layerType];if(!De)return[];var Ze=Ae.match(/^(.*)-transition$/);if(O==="paint"&&Ze&&De[Ze[1]]&&De[Ze[1]].transition)return sr({key:q,value:me,valueSpec:fe.transition,style:re,styleSpec:fe});var ut,gt=_.valueSpec||De[Ae];if(!gt)return[new Xe(q,me,'unknown property "'+Ae+'"')];if(qa(me)==="string"&&as(gt)&&!gt.tokens&&(ut=/^{([^}]+)}$/.exec(me)))return[new Xe(q,me,'"'+Ae+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(ut[1])+" }`.")];var Bt=[];return _.layerType==="symbol"&&(Ae==="text-field"&&re&&!re.glyphs&&Bt.push(new Xe(q,me,'use of "text-field" requires a style "glyphs" property')),Ae==="text-font"&&Re(Lt(me))&&pt(me.type)==="identity"&&Bt.push(new Xe(q,me,'"text-font" does not support identity functions'))),Bt.concat(sr({key:_.key,value:me,valueSpec:gt,style:re,styleSpec:fe,expressionContext:"property",propertyType:O,propertyKey:Ae}))}function Hi(_){return ki(_,"paint")}function no(_){return ki(_,"layout")}function ao(_){var O=[],q=_.value,re=_.key,fe=_.style,me=_.styleSpec;q.type||q.ref||O.push(new Xe(re,q,'either "type" or "ref" is required'));var Ae,De=pt(q.type),Ze=pt(q.ref);if(q.id)for(var ut=pt(q.id),gt=0;gt<_.arrayIndex;gt++){var Bt=fe.layers[gt];pt(Bt.id)===ut&&O.push(new Xe(re,q.id,'duplicate layer id "'+q.id+'", previously used at line '+Bt.id.__line__))}if("ref"in q)["type","source","source-layer","filter","layout"].forEach(function(ar){ar in q&&O.push(new Xe(re,q[ar],'"'+ar+'" is prohibited for ref layers'))}),fe.layers.forEach(function(ar){pt(ar.id)===Ze&&(Ae=ar)}),Ae?Ae.ref?O.push(new Xe(re,q.ref,"ref cannot reference another ref layer")):De=pt(Ae.type):O.push(new Xe(re,q.ref,'ref layer "'+Ze+'" not found'));else if(De!=="background")if(q.source){var Wt=fe.sources&&fe.sources[q.source],Ht=Wt&&pt(Wt.type);Wt?Ht==="vector"&&De==="raster"?O.push(new Xe(re,q.source,'layer "'+q.id+'" requires a raster source')):Ht==="raster"&&De!=="raster"?O.push(new Xe(re,q.source,'layer "'+q.id+'" requires a vector source')):Ht!=="vector"||q["source-layer"]?Ht==="raster-dem"&&De!=="hillshade"?O.push(new Xe(re,q.source,"raster-dem source can only be used with layer type 'hillshade'.")):De!=="line"||!q.paint||!q.paint["line-gradient"]||Ht==="geojson"&&Wt.lineMetrics||O.push(new Xe(re,q,'layer "'+q.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):O.push(new Xe(re,q,'layer "'+q.id+'" must specify a "source-layer"')):O.push(new Xe(re,q.source,'source "'+q.source+'" not found'))}else O.push(new Xe(re,q,'missing required property "source"'));return O=O.concat(Or({key:re,value:q,valueSpec:me.layer,style:_.style,styleSpec:_.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return sr({key:re+".type",value:q.type,valueSpec:me.layer.type,style:_.style,styleSpec:_.styleSpec,object:q,objectKey:"type"})},filter:ci,layout:function(ar){return Or({layer:q,key:ar.key,value:ar.value,style:ar.style,styleSpec:ar.styleSpec,objectElementValidators:{"*":function(gr){return no(Mt({layerType:De},gr))}}})},paint:function(ar){return Or({layer:q,key:ar.key,value:ar.value,style:ar.style,styleSpec:ar.styleSpec,objectElementValidators:{"*":function(gr){return Hi(Mt({layerType:De},gr))}}})}}}))}function io(_){var O=_.value,q=_.key,re=qa(O);return re!=="string"?[new Xe(q,O,"string expected, "+re+" found")]:[]}var oo={promoteId:function(_){var O=_.key,q=_.value;if(qa(q)==="string")return io({key:O,value:q});var re=[];for(var fe in q)re.push.apply(re,io({key:O+"."+fe,value:q[fe]}));return re}};function Oa(_){var O=_.value,q=_.key,re=_.styleSpec,fe=_.style;if(!O.type)return[new Xe(q,O,'"type" is required')];var me,Ae=pt(O.type);switch(Ae){case"vector":case"raster":case"raster-dem":return me=Or({key:q,value:O,valueSpec:re["source_"+Ae.replace("-","_")],style:_.style,styleSpec:re,objectElementValidators:oo});case"geojson":if(me=Or({key:q,value:O,valueSpec:re.source_geojson,style:fe,styleSpec:re,objectElementValidators:oo}),O.cluster)for(var De in O.clusterProperties){var Ze=O.clusterProperties[De],ut=Ze[0],gt=Ze[1],Bt=typeof ut=="string"?[ut,["accumulated"],["get",De]]:ut;me.push.apply(me,Dn({key:q+"."+De+".map",value:gt,expressionContext:"cluster-map"})),me.push.apply(me,Dn({key:q+"."+De+".reduce",value:Bt,expressionContext:"cluster-reduce"}))}return me;case"video":return Or({key:q,value:O,valueSpec:re.source_video,style:fe,styleSpec:re});case"image":return Or({key:q,value:O,valueSpec:re.source_image,style:fe,styleSpec:re});case"canvas":return[new Xe(q,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Hn({key:q+".type",value:O.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:fe,styleSpec:re})}}function ft(_){var O=_.value,q=_.styleSpec,re=q.light,fe=_.style,me=[],Ae=qa(O);if(O===void 0)return me;if(Ae!=="object")return me=me.concat([new Xe("light",O,"object expected, "+Ae+" found")]);for(var De in O){var Ze=De.match(/^(.*)-transition$/);me=Ze&&re[Ze[1]]&&re[Ze[1]].transition?me.concat(sr({key:De,value:O[De],valueSpec:q.transition,style:fe,styleSpec:q})):re[De]?me.concat(sr({key:De,value:O[De],valueSpec:re[De],style:fe,styleSpec:q})):me.concat([new Xe(De,O[De],'unknown property "'+De+'"')])}return me}var Rt={"*":function(){return[]},array:nn,boolean:function(_){var O=_.value,q=_.key,re=qa(O);return re!=="boolean"?[new Xe(q,O,"boolean expected, "+re+" found")]:[]},number:gn,color:function(_){var O=_.key,q=_.value,re=qa(q);return re!=="string"?[new Xe(O,q,"color expected, "+re+" found")]:vr(q)===null?[new Xe(O,q,'color expected, "'+q+'" found')]:[]},constants:ht,enum:Hn,filter:ci,function:Cn,layer:ao,object:Or,source:Oa,light:ft,string:io,formatted:function(_){return io(_).length===0?[]:Dn(_)},resolvedImage:function(_){return io(_).length===0?[]:Dn(_)}};function sr(_){var O=_.value,q=_.valueSpec,re=_.styleSpec;return q.expression&&Re(pt(O))?Cn(_):q.expression&&$t(Lt(O))?Dn(_):q.type&&Rt[q.type]?Rt[q.type](_):Or(Mt({},_,{valueSpec:q.type?re[q.type]:q}))}function Vt(_){var O=_.value,q=_.key,re=io(_);return re.length||(O.indexOf("{fontstack}")===-1&&re.push(new Xe(q,O,'"glyphs" url must include a "{fontstack}" token')),O.indexOf("{range}")===-1&&re.push(new Xe(q,O,'"glyphs" url must include a "{range}" token'))),re}function lr(_,O){O===void 0&&(O=Pe);var q=[];return q=q.concat(sr({key:"",value:_,valueSpec:O.$root,styleSpec:O,style:_,objectElementValidators:{glyphs:Vt,"*":function(){return[]}}})),_.constants&&(q=q.concat(ht({key:"constants",value:_.constants,style:_,styleSpec:O}))),Lr(q)}function Lr(_){return[].concat(_).sort(function(O,q){return O.line-q.line})}function zr(_){return function(){for(var O=[],q=arguments.length;q--;)O[q]=arguments[q];return Lr(_.apply(this,O))}}lr.source=zr(Oa),lr.light=zr(ft),lr.layer=zr(ao),lr.filter=zr(ci),lr.paintProperty=zr(Hi),lr.layoutProperty=zr(no);var Yr=lr,ln=Yr.light,on=Yr.paintProperty,mn=Yr.layoutProperty;function wn(_,O){var q=!1;if(O&&O.length)for(var re=0,fe=O;re<fe.length;re+=1){var me=fe[re];_.fire(new Ce(new Error(me.message))),q=!0}return q}var un=Tn;function Tn(_,O,q){var re=this.cells=[];if(_ instanceof ArrayBuffer){this.arrayBuffer=_;var fe=new Int32Array(this.arrayBuffer);_=fe[0],O=fe[1],q=fe[2],this.d=O+2*q;for(var me=0;me<this.d*this.d;me++){var Ae=fe[3+me],De=fe[3+me+1];re.push(Ae===De?null:fe.subarray(Ae,De))}var Ze=fe[3+re.length],ut=fe[3+re.length+1];this.keys=fe.subarray(Ze,ut),this.bboxes=fe.subarray(ut),this.insert=this._insertReadonly}else{this.d=O+2*q;for(var gt=0;gt<this.d*this.d;gt++)re.push([]);this.keys=[],this.bboxes=[]}this.n=O,this.extent=_,this.padding=q,this.scale=O/_,this.uid=0;var Bt=q/O*_;this.min=-Bt,this.max=_+Bt}Tn.prototype.insert=function(_,O,q,re,fe){this._forEachCell(O,q,re,fe,this._insertCell,this.uid++),this.keys.push(_),this.bboxes.push(O),this.bboxes.push(q),this.bboxes.push(re),this.bboxes.push(fe)},Tn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Tn.prototype._insertCell=function(_,O,q,re,fe,me){this.cells[fe].push(me)},Tn.prototype.query=function(_,O,q,re,fe){var me=this.min,Ae=this.max;if(_<=me&&O<=me&&Ae<=q&&Ae<=re&&!fe)return Array.prototype.slice.call(this.keys);var De=[];return this._forEachCell(_,O,q,re,this._queryCell,De,{},fe),De},Tn.prototype._queryCell=function(_,O,q,re,fe,me,Ae,De){var Ze=this.cells[fe];if(Ze!==null)for(var ut=this.keys,gt=this.bboxes,Bt=0;Bt<Ze.length;Bt++){var Wt=Ze[Bt];if(Ae[Wt]===void 0){var Ht=4*Wt;(De?De(gt[Ht+0],gt[Ht+1],gt[Ht+2],gt[Ht+3]):_<=gt[Ht+2]&&O<=gt[Ht+3]&&q>=gt[Ht+0]&&re>=gt[Ht+1])?(Ae[Wt]=!0,me.push(ut[Wt])):Ae[Wt]=!1}}},Tn.prototype._forEachCell=function(_,O,q,re,fe,me,Ae,De){for(var Ze=this._convertToCellCoord(_),ut=this._convertToCellCoord(O),gt=this._convertToCellCoord(q),Bt=this._convertToCellCoord(re),Wt=Ze;Wt<=gt;Wt++)for(var Ht=ut;Ht<=Bt;Ht++){var ar=this.d*Ht+Wt;if((!De||De(this._convertFromCellCoord(Wt),this._convertFromCellCoord(Ht),this._convertFromCellCoord(Wt+1),this._convertFromCellCoord(Ht+1)))&&fe.call(this,_,O,q,re,ar,me,Ae,De))return}},Tn.prototype._convertFromCellCoord=function(_){return(_-this.padding)/this.scale},Tn.prototype._convertToCellCoord=function(_){return Math.max(0,Math.min(this.d-1,Math.floor(_*this.scale)+this.padding))},Tn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var _=this.cells,O=3+this.cells.length+1+1,q=0,re=0;re<this.cells.length;re++)q+=this.cells[re].length;var fe=new Int32Array(O+q+this.keys.length+this.bboxes.length);fe[0]=this.extent,fe[1]=this.n,fe[2]=this.padding;for(var me=O,Ae=0;Ae<_.length;Ae++){var De=_[Ae];fe[3+Ae]=me,fe.set(De,me),me+=De.length}return fe[3+_.length]=me,fe.set(this.keys,me),me+=this.keys.length,fe[3+_.length+1]=me,fe.set(this.bboxes,me),me+=this.bboxes.length,fe.buffer};var Rn=self.ImageData,Vn=self.ImageBitmap,ta={};function Xr(_,O,q){q===void 0&&(q={}),Object.defineProperty(O,"_classRegistryKey",{value:_,writeable:!1}),ta[_]={klass:O,omit:q.omit||[],shallow:q.shallow||[]}}for(var $n in Xr("Object",Object),un.serialize=function(_,O){var q=_.toArrayBuffer();return O&&O.push(q),{buffer:q}},un.deserialize=function(_){return new un(_.buffer)},Xr("Grid",un),Xr("Color",ur),Xr("Error",Error),Xr("ResolvedImage",_r),Xr("StylePropertyFunction",yr),Xr("StyleExpression",Zt,{omit:["_evaluator"]}),Xr("ZoomDependentExpression",cr),Xr("ZoomConstantExpression",nr),Xr("CompoundExpression",En,{omit:["_evaluate"]}),ts)ts[$n]._classRegistryKey||Xr("Expression_"+$n,ts[$n]);function Ln(_){return _&&typeof ArrayBuffer!="undefined"&&(_ instanceof ArrayBuffer||_.constructor&&_.constructor.name==="ArrayBuffer")}function jn(_){return Vn&&_ instanceof Vn}function Jn(_,O){if(_==null||typeof _=="boolean"||typeof _=="number"||typeof _=="string"||_ instanceof Boolean||_ instanceof Number||_ instanceof String||_ instanceof Date||_ instanceof RegExp)return _;if(Ln(_)||jn(_))return O&&O.push(_),_;if(ArrayBuffer.isView(_)){var q=_;return O&&O.push(q.buffer),q}if(_ instanceof Rn)return O&&O.push(_.data.buffer),_;if(Array.isArray(_)){for(var re=[],fe=0,me=_;fe<me.length;fe+=1){var Ae=me[fe];re.push(Jn(Ae,O))}return re}if(typeof _=="object"){var De=_.constructor,Ze=De._classRegistryKey;if(!Ze)throw new Error("can't serialize object of unregistered class");var ut=De.serialize?De.serialize(_,O):{};if(!De.serialize){for(var gt in _)if(_.hasOwnProperty(gt)&&!(ta[Ze].omit.indexOf(gt)>=0)){var Bt=_[gt];ut[gt]=ta[Ze].shallow.indexOf(gt)>=0?Bt:Jn(Bt,O)}_ instanceof Error&&(ut.message=_.message)}if(ut.$name)throw new Error("$name property is reserved for worker serialization logic.");return Ze!=="Object"&&(ut.$name=Ze),ut}throw new Error("can't serialize object of type "+typeof _)}function Ta(_){if(_==null||typeof _=="boolean"||typeof _=="number"||typeof _=="string"||_ instanceof Boolean||_ instanceof Number||_ instanceof String||_ instanceof Date||_ instanceof RegExp||Ln(_)||jn(_)||ArrayBuffer.isView(_)||_ instanceof Rn)return _;if(Array.isArray(_))return _.map(Ta);if(typeof _=="object"){var O=_.$name||"Object",q=ta[O].klass;if(!q)throw new Error("can't deserialize unregistered class "+O);if(q.deserialize)return q.deserialize(_);for(var re=Object.create(q.prototype),fe=0,me=Object.keys(_);fe<me.length;fe+=1){var Ae=me[fe];if(Ae!=="$name"){var De=_[Ae];re[Ae]=ta[O].shallow.indexOf(Ae)>=0?De:Ta(De)}}return re}throw new Error("can't deserialize object of type "+typeof _)}var Ca=function(){this.first=!0};Ca.prototype.update=function(_,O){var q=Math.floor(_);return this.first?(this.first=!1,this.lastIntegerZoom=q,this.lastIntegerZoomTime=0,this.lastZoom=_,this.lastFloorZoom=q,!0):(this.lastFloorZoom>q?(this.lastIntegerZoom=q+1,this.lastIntegerZoomTime=O):this.lastFloorZoom<q&&(this.lastIntegerZoom=q,this.lastIntegerZoomTime=O),_!==this.lastZoom&&(this.lastZoom=_,this.lastFloorZoom=q,!0))};var Mn={"Latin-1 Supplement":function(_){return _>=128&&_<=255},Arabic:function(_){return _>=1536&&_<=1791},"Arabic Supplement":function(_){return _>=1872&&_<=1919},"Arabic Extended-A":function(_){return _>=2208&&_<=2303},"Hangul Jamo":function(_){return _>=4352&&_<=4607},"Unified Canadian Aboriginal Syllabics":function(_){return _>=5120&&_<=5759},Khmer:function(_){return _>=6016&&_<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(_){return _>=6320&&_<=6399},"General Punctuation":function(_){return _>=8192&&_<=8303},"Letterlike Symbols":function(_){return _>=8448&&_<=8527},"Number Forms":function(_){return _>=8528&&_<=8591},"Miscellaneous Technical":function(_){return _>=8960&&_<=9215},"Control Pictures":function(_){return _>=9216&&_<=9279},"Optical Character Recognition":function(_){return _>=9280&&_<=9311},"Enclosed Alphanumerics":function(_){return _>=9312&&_<=9471},"Geometric Shapes":function(_){return _>=9632&&_<=9727},"Miscellaneous Symbols":function(_){return _>=9728&&_<=9983},"Miscellaneous Symbols and Arrows":function(_){return _>=11008&&_<=11263},"CJK Radicals Supplement":function(_){return _>=11904&&_<=12031},"Kangxi Radicals":function(_){return _>=12032&&_<=12255},"Ideographic Description Characters":function(_){return _>=12272&&_<=12287},"CJK Symbols and Punctuation":function(_){return _>=12288&&_<=12351},Hiragana:function(_){return _>=12352&&_<=12447},Katakana:function(_){return _>=12448&&_<=12543},Bopomofo:function(_){return _>=12544&&_<=12591},"Hangul Compatibility Jamo":function(_){return _>=12592&&_<=12687},Kanbun:function(_){return _>=12688&&_<=12703},"Bopomofo Extended":function(_){return _>=12704&&_<=12735},"CJK Strokes":function(_){return _>=12736&&_<=12783},"Katakana Phonetic Extensions":function(_){return _>=12784&&_<=12799},"Enclosed CJK Letters and Months":function(_){return _>=12800&&_<=13055},"CJK Compatibility":function(_){return _>=13056&&_<=13311},"CJK Unified Ideographs Extension A":function(_){return _>=13312&&_<=19903},"Yijing Hexagram Symbols":function(_){return _>=19904&&_<=19967},"CJK Unified Ideographs":function(_){return _>=19968&&_<=40959},"Yi Syllables":function(_){return _>=40960&&_<=42127},"Yi Radicals":function(_){return _>=42128&&_<=42191},"Hangul Jamo Extended-A":function(_){return _>=43360&&_<=43391},"Hangul Syllables":function(_){return _>=44032&&_<=55215},"Hangul Jamo Extended-B":function(_){return _>=55216&&_<=55295},"Private Use Area":function(_){return _>=57344&&_<=63743},"CJK Compatibility Ideographs":function(_){return _>=63744&&_<=64255},"Arabic Presentation Forms-A":function(_){return _>=64336&&_<=65023},"Vertical Forms":function(_){return _>=65040&&_<=65055},"CJK Compatibility Forms":function(_){return _>=65072&&_<=65103},"Small Form Variants":function(_){return _>=65104&&_<=65135},"Arabic Presentation Forms-B":function(_){return _>=65136&&_<=65279},"Halfwidth and Fullwidth Forms":function(_){return _>=65280&&_<=65519}};function Da(_){for(var O=0,q=_;O<q.length;O+=1)if(da(q[O].charCodeAt(0)))return!0;return!1}function Sa(_){return!Mn.Arabic(_)&&!Mn["Arabic Supplement"](_)&&!Mn["Arabic Extended-A"](_)&&!Mn["Arabic Presentation Forms-A"](_)&&!Mn["Arabic Presentation Forms-B"](_)}function da(_){return _===746||_===747||!(_<4352)&&(!!Mn["Bopomofo Extended"](_)||!!Mn.Bopomofo(_)||!(!Mn["CJK Compatibility Forms"](_)||_>=65097&&_<=65103)||!!Mn["CJK Compatibility Ideographs"](_)||!!Mn["CJK Compatibility"](_)||!!Mn["CJK Radicals Supplement"](_)||!!Mn["CJK Strokes"](_)||!(!Mn["CJK Symbols and Punctuation"](_)||_>=12296&&_<=12305||_>=12308&&_<=12319||_===12336)||!!Mn["CJK Unified Ideographs Extension A"](_)||!!Mn["CJK Unified Ideographs"](_)||!!Mn["Enclosed CJK Letters and Months"](_)||!!Mn["Hangul Compatibility Jamo"](_)||!!Mn["Hangul Jamo Extended-A"](_)||!!Mn["Hangul Jamo Extended-B"](_)||!!Mn["Hangul Jamo"](_)||!!Mn["Hangul Syllables"](_)||!!Mn.Hiragana(_)||!!Mn["Ideographic Description Characters"](_)||!!Mn.Kanbun(_)||!!Mn["Kangxi Radicals"](_)||!!Mn["Katakana Phonetic Extensions"](_)||!(!Mn.Katakana(_)||_===12540)||!(!Mn["Halfwidth and Fullwidth Forms"](_)||_===65288||_===65289||_===65293||_>=65306&&_<=65310||_===65339||_===65341||_===65343||_>=65371&&_<=65503||_===65507||_>=65512&&_<=65519)||!(!Mn["Small Form Variants"](_)||_>=65112&&_<=65118||_>=65123&&_<=65126)||!!Mn["Unified Canadian Aboriginal Syllabics"](_)||!!Mn["Unified Canadian Aboriginal Syllabics Extended"](_)||!!Mn["Vertical Forms"](_)||!!Mn["Yijing Hexagram Symbols"](_)||!!Mn["Yi Syllables"](_)||!!Mn["Yi Radicals"](_))}function za(_){return!(da(_)||function(O){return!(!Mn["Latin-1 Supplement"](O)||O!==167&&O!==169&&O!==174&&O!==177&&O!==188&&O!==189&&O!==190&&O!==215&&O!==247)||!(!Mn["General Punctuation"](O)||O!==8214&&O!==8224&&O!==8225&&O!==8240&&O!==8241&&O!==8251&&O!==8252&&O!==8258&&O!==8263&&O!==8264&&O!==8265&&O!==8273)||!!Mn["Letterlike Symbols"](O)||!!Mn["Number Forms"](O)||!(!Mn["Miscellaneous Technical"](O)||!(O>=8960&&O<=8967||O>=8972&&O<=8991||O>=8996&&O<=9e3||O===9003||O>=9085&&O<=9114||O>=9150&&O<=9165||O===9167||O>=9169&&O<=9179||O>=9186&&O<=9215))||!(!Mn["Control Pictures"](O)||O===9251)||!!Mn["Optical Character Recognition"](O)||!!Mn["Enclosed Alphanumerics"](O)||!!Mn["Geometric Shapes"](O)||!(!Mn["Miscellaneous Symbols"](O)||O>=9754&&O<=9759)||!(!Mn["Miscellaneous Symbols and Arrows"](O)||!(O>=11026&&O<=11055||O>=11088&&O<=11097||O>=11192&&O<=11243))||!!Mn["CJK Symbols and Punctuation"](O)||!!Mn.Katakana(O)||!!Mn["Private Use Area"](O)||!!Mn["CJK Compatibility Forms"](O)||!!Mn["Small Form Variants"](O)||!!Mn["Halfwidth and Fullwidth Forms"](O)||O===8734||O===8756||O===8757||O>=9984&&O<=10087||O>=10102&&O<=10131||O===65532||O===65533}(_))}function Aa(_){return _>=1424&&_<=2303||Mn["Arabic Presentation Forms-A"](_)||Mn["Arabic Presentation Forms-B"](_)}function ti(_,O){return!(!O&&Aa(_))&&!(_>=2304&&_<=3583||_>=3840&&_<=4255||Mn.Khmer(_))}function Qn(_){for(var O=0,q=_;O<q.length;O+=1)if(Aa(q[O].charCodeAt(0)))return!0;return!1}var Za="deferred",Gi="loading",cs="loaded",Xo="error",Eo=null,va="unavailable",xi=null,Co=function(_){_&&typeof _=="string"&&_.indexOf("NetworkError")>-1&&(va=Xo),Eo&&Eo(_)};function Ka(){Ei.fire(new _e("pluginStateChange",{pluginStatus:va,pluginURL:xi}))}var Ei=new Le,Zi=function(){return va},ai=function(){if(va!==Za||!xi)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");va=Gi,Ka(),xi&&_t({url:xi},function(_){_?Co(_):(va=cs,Ka())})},yo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return va===cs||yo.applyArabicShaping!=null},isLoading:function(){return va===Gi},setState:function(_){va=_.pluginStatus,xi=_.pluginURL},isParsed:function(){return yo.applyArabicShaping!=null&&yo.processBidirectionalText!=null&&yo.processStyledBidirectionalText!=null},getPluginURL:function(){return xi}},ii=function(_,O){this.zoom=_,O?(this.now=O.now,this.fadeDuration=O.fadeDuration,this.zoomHistory=O.zoomHistory,this.transition=O.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ca,this.transition={})};ii.prototype.isSupportedScript=function(_){return function(O,q){for(var re=0,fe=O;re<fe.length;re+=1)if(!ti(fe[re].charCodeAt(0),q))return!1;return!0}(_,yo.isLoaded())},ii.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ii.prototype.getCrossfadeParameters=function(){var _=this.zoom,O=_-Math.floor(_),q=this.crossFadingFactor();return _>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:O+(1-O)*q}:{fromScale:.5,toScale:1,t:1-(1-q)*O}};var so=function(_,O){this.property=_,this.value=O,this.expression=function(q,re){if(Re(q))return new yr(q,re);if($t(q)){var fe=mr(q,re);if(fe.result==="error")throw new Error(fe.value.map(function(Ae){return Ae.key+": "+Ae.message}).join(", "));return fe.value}var me=q;return typeof q=="string"&&re.type==="color"&&(me=ur.parse(q)),{kind:"constant",evaluate:function(){return me}}}(O===void 0?_.specification.default:O,_.specification)};so.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},so.prototype.possiblyEvaluate=function(_,O,q){return this.property.possiblyEvaluate(this,_,O,q)};var Ms=function(_){this.property=_,this.value=new so(_,void 0)};Ms.prototype.transitioned=function(_,O){return new pl(this.property,this.value,O,g({},_.transition,this.transition),_.now)},Ms.prototype.untransitioned=function(){return new pl(this.property,this.value,null,{},0)};var ys=function(_){this._properties=_,this._values=Object.create(_.defaultTransitionablePropertyValues)};ys.prototype.getValue=function(_){return w(this._values[_].value.value)},ys.prototype.setValue=function(_,O){this._values.hasOwnProperty(_)||(this._values[_]=new Ms(this._values[_].property)),this._values[_].value=new so(this._values[_].property,O===null?void 0:w(O))},ys.prototype.getTransition=function(_){return w(this._values[_].transition)},ys.prototype.setTransition=function(_,O){this._values.hasOwnProperty(_)||(this._values[_]=new Ms(this._values[_].property)),this._values[_].transition=w(O)||void 0},ys.prototype.serialize=function(){for(var _={},O=0,q=Object.keys(this._values);O<q.length;O+=1){var re=q[O],fe=this.getValue(re);fe!==void 0&&(_[re]=fe);var me=this.getTransition(re);me!==void 0&&(_[re+"-transition"]=me)}return _},ys.prototype.transitioned=function(_,O){for(var q=new Ni(this._properties),re=0,fe=Object.keys(this._values);re<fe.length;re+=1){var me=fe[re];q._values[me]=this._values[me].transitioned(_,O._values[me])}return q},ys.prototype.untransitioned=function(){for(var _=new Ni(this._properties),O=0,q=Object.keys(this._values);O<q.length;O+=1){var re=q[O];_._values[re]=this._values[re].untransitioned()}return _};var pl=function(_,O,q,re,fe){this.property=_,this.value=O,this.begin=fe+re.delay||0,this.end=this.begin+re.duration||0,_.specification.transition&&(re.delay||re.duration)&&(this.prior=q)};pl.prototype.possiblyEvaluate=function(_,O,q){var re=_.now||0,fe=this.value.possiblyEvaluate(_,O,q),me=this.prior;if(me){if(re>this.end)return this.prior=null,fe;if(this.value.isDataDriven())return this.prior=null,fe;if(re<this.begin)return me.possiblyEvaluate(_,O,q);var Ae=(re-this.begin)/(this.end-this.begin);return this.property.interpolate(me.possiblyEvaluate(_,O,q),fe,function(De){if(De<=0)return 0;if(De>=1)return 1;var Ze=De*De,ut=Ze*De;return 4*(De<.5?ut:3*(De-Ze)+ut-.75)}(Ae))}return fe};var Ni=function(_){this._properties=_,this._values=Object.create(_.defaultTransitioningPropertyValues)};Ni.prototype.possiblyEvaluate=function(_,O,q){for(var re=new xs(this._properties),fe=0,me=Object.keys(this._values);fe<me.length;fe+=1){var Ae=me[fe];re._values[Ae]=this._values[Ae].possiblyEvaluate(_,O,q)}return re},Ni.prototype.hasTransition=function(){for(var _=0,O=Object.keys(this._values);_<O.length;_+=1){var q=O[_];if(this._values[q].prior)return!0}return!1};var dl=function(_){this._properties=_,this._values=Object.create(_.defaultPropertyValues)};dl.prototype.getValue=function(_){return w(this._values[_].value)},dl.prototype.setValue=function(_,O){this._values[_]=new so(this._values[_].property,O===null?void 0:w(O))},dl.prototype.serialize=function(){for(var _={},O=0,q=Object.keys(this._values);O<q.length;O+=1){var re=q[O],fe=this.getValue(re);fe!==void 0&&(_[re]=fe)}return _},dl.prototype.possiblyEvaluate=function(_,O,q){for(var re=new xs(this._properties),fe=0,me=Object.keys(this._values);fe<me.length;fe+=1){var Ae=me[fe];re._values[Ae]=this._values[Ae].possiblyEvaluate(_,O,q)}return re};var ji=function(_,O,q){this.property=_,this.value=O,this.parameters=q};ji.prototype.isConstant=function(){return this.value.kind==="constant"},ji.prototype.constantOr=function(_){return this.value.kind==="constant"?this.value.value:_},ji.prototype.evaluate=function(_,O,q,re){return this.property.evaluate(this.value,this.parameters,_,O,q,re)};var xs=function(_){this._properties=_,this._values=Object.create(_.defaultPossiblyEvaluatedValues)};xs.prototype.get=function(_){return this._values[_]};var la=function(_){this.specification=_};la.prototype.possiblyEvaluate=function(_,O){return _.expression.evaluate(O)},la.prototype.interpolate=function(_,O,q){var re=yn[this.specification.type];return re?re(_,O,q):_};var ya=function(_,O){this.specification=_,this.overrides=O};ya.prototype.possiblyEvaluate=function(_,O,q,re){return _.expression.kind==="constant"||_.expression.kind==="camera"?new ji(this,{kind:"constant",value:_.expression.evaluate(O,null,{},q,re)},O):new ji(this,_.expression,O)},ya.prototype.interpolate=function(_,O,q){if(_.value.kind!=="constant"||O.value.kind!=="constant")return _;if(_.value.value===void 0||O.value.value===void 0)return new ji(this,{kind:"constant",value:void 0},_.parameters);var re=yn[this.specification.type];return re?new ji(this,{kind:"constant",value:re(_.value.value,O.value.value,q)},_.parameters):_},ya.prototype.evaluate=function(_,O,q,re,fe,me){return _.kind==="constant"?_.value:_.evaluate(O,q,re,fe,me)};var ml=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.possiblyEvaluate=function(q,re,fe,me){if(q.value===void 0)return new ji(this,{kind:"constant",value:void 0},re);if(q.expression.kind==="constant"){var Ae=q.expression.evaluate(re,null,{},fe,me),De=q.property.specification.type==="resolvedImage"&&typeof Ae!="string"?Ae.name:Ae,Ze=this._calculate(De,De,De,re);return new ji(this,{kind:"constant",value:Ze},re)}if(q.expression.kind==="camera"){var ut=this._calculate(q.expression.evaluate({zoom:re.zoom-1}),q.expression.evaluate({zoom:re.zoom}),q.expression.evaluate({zoom:re.zoom+1}),re);return new ji(this,{kind:"constant",value:ut},re)}return new ji(this,q.expression,re)},O.prototype.evaluate=function(q,re,fe,me,Ae,De){if(q.kind==="source"){var Ze=q.evaluate(re,fe,me,Ae,De);return this._calculate(Ze,Ze,Ze,re)}return q.kind==="composite"?this._calculate(q.evaluate({zoom:Math.floor(re.zoom)-1},fe,me),q.evaluate({zoom:Math.floor(re.zoom)},fe,me),q.evaluate({zoom:Math.floor(re.zoom)+1},fe,me),re):q.value},O.prototype._calculate=function(q,re,fe,me){return me.zoom>me.zoomHistory.lastIntegerZoom?{from:q,to:re}:{from:fe,to:re}},O.prototype.interpolate=function(q){return q},O}(ya),vl=function(_){this.specification=_};vl.prototype.possiblyEvaluate=function(_,O,q,re){if(_.value!==void 0){if(_.expression.kind==="constant"){var fe=_.expression.evaluate(O,null,{},q,re);return this._calculate(fe,fe,fe,O)}return this._calculate(_.expression.evaluate(new ii(Math.floor(O.zoom-1),O)),_.expression.evaluate(new ii(Math.floor(O.zoom),O)),_.expression.evaluate(new ii(Math.floor(O.zoom+1),O)),O)}},vl.prototype._calculate=function(_,O,q,re){return re.zoom>re.zoomHistory.lastIntegerZoom?{from:_,to:O}:{from:q,to:O}},vl.prototype.interpolate=function(_){return _};var bs=function(_){this.specification=_};bs.prototype.possiblyEvaluate=function(_,O,q,re){return!!_.expression.evaluate(O,null,{},q,re)},bs.prototype.interpolate=function(){return!1};var Go=function(_){for(var O in this.properties=_,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],_){var q=_[O];q.specification.overridable&&this.overridableProperties.push(O);var re=this.defaultPropertyValues[O]=new so(q,void 0),fe=this.defaultTransitionablePropertyValues[O]=new Ms(q);this.defaultTransitioningPropertyValues[O]=fe.untransitioned(),this.defaultPossiblyEvaluatedValues[O]=re.possiblyEvaluate({})}};Xr("DataDrivenProperty",ya),Xr("DataConstantProperty",la),Xr("CrossFadedDataDrivenProperty",ml),Xr("CrossFadedProperty",vl),Xr("ColorRampProperty",bs);var is=function(_){function O(q,re){if(_.call(this),this.id=q.id,this.type=q.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},q.type!=="custom"&&(q=q,this.metadata=q.metadata,this.minzoom=q.minzoom,this.maxzoom=q.maxzoom,q.type!=="background"&&(this.source=q.source,this.sourceLayer=q["source-layer"],this.filter=q.filter),re.layout&&(this._unevaluatedLayout=new dl(re.layout)),re.paint)){for(var fe in this._transitionablePaint=new ys(re.paint),q.paint)this.setPaintProperty(fe,q.paint[fe],{validate:!1});for(var me in q.layout)this.setLayoutProperty(me,q.layout[me],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new xs(re.paint)}}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},O.prototype.getLayoutProperty=function(q){return q==="visibility"?this.visibility:this._unevaluatedLayout.getValue(q)},O.prototype.setLayoutProperty=function(q,re,fe){if(fe===void 0&&(fe={}),re!=null){var me="layers."+this.id+".layout."+q;if(this._validate(mn,me,q,re,fe))return}q!=="visibility"?this._unevaluatedLayout.setValue(q,re):this.visibility=re},O.prototype.getPaintProperty=function(q){return T(q,"-transition")?this._transitionablePaint.getTransition(q.slice(0,-"-transition".length)):this._transitionablePaint.getValue(q)},O.prototype.setPaintProperty=function(q,re,fe){if(fe===void 0&&(fe={}),re!=null){var me="layers."+this.id+".paint."+q;if(this._validate(on,me,q,re,fe))return!1}if(T(q,"-transition"))return this._transitionablePaint.setTransition(q.slice(0,-"-transition".length),re||void 0),!1;var Ae=this._transitionablePaint._values[q],De=Ae.property.specification["property-type"]==="cross-faded-data-driven",Ze=Ae.value.isDataDriven(),ut=Ae.value;this._transitionablePaint.setValue(q,re),this._handleSpecialPaintPropertyUpdate(q);var gt=this._transitionablePaint._values[q].value;return gt.isDataDriven()||Ze||De||this._handleOverridablePaintPropertyUpdate(q,ut,gt)},O.prototype._handleSpecialPaintPropertyUpdate=function(q){},O.prototype._handleOverridablePaintPropertyUpdate=function(q,re,fe){return!1},O.prototype.isHidden=function(q){return!!(this.minzoom&&q<this.minzoom)||!!(this.maxzoom&&q>=this.maxzoom)||this.visibility==="none"},O.prototype.updateTransitions=function(q){this._transitioningPaint=this._transitionablePaint.transitioned(q,this._transitioningPaint)},O.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},O.prototype.recalculate=function(q,re){q.getCrossfadeParameters&&(this._crossfadeParameters=q.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(q,void 0,re)),this.paint=this._transitioningPaint.possiblyEvaluate(q,void 0,re)},O.prototype.serialize=function(){var q={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(q.layout=q.layout||{},q.layout.visibility=this.visibility),S(q,function(re,fe){return!(re===void 0||fe==="layout"&&!Object.keys(re).length||fe==="paint"&&!Object.keys(re).length)})},O.prototype._validate=function(q,re,fe,me,Ae){return Ae===void 0&&(Ae={}),(!Ae||Ae.validate!==!1)&&wn(this,q.call(Yr,{key:re,layerType:this.type,objectKey:fe,value:me,styleSpec:Pe,style:{glyphs:!0,sprite:!0}}))},O.prototype.is3D=function(){return!1},O.prototype.isTileClipped=function(){return!1},O.prototype.hasOffscreenPass=function(){return!1},O.prototype.resize=function(){},O.prototype.isStateDependent=function(){for(var q in this.paint._values){var re=this.paint.get(q);if(re instanceof ji&&as(re.property.specification)&&(re.value.kind==="source"||re.value.kind==="composite")&&re.value.isStateDependent)return!0}return!1},O}(Le),Il={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},$s=function(_,O){this._structArray=_,this._pos1=O*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Ja=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function oi(_,O){O===void 0&&(O=1);var q=0,re=0;return{members:_.map(function(fe){var me,Ae=(me=fe.type,Il[me].BYTES_PER_ELEMENT),De=q=Rs(q,Math.max(O,Ae)),Ze=fe.components||1;return re=Math.max(re,Ae),q+=Ae*Ze,{name:fe.name,type:fe.type,components:Ze,offset:De}}),size:Rs(q,Math.max(re,O)),alignment:O}}function Rs(_,O){return Math.ceil(_/O)*O}Ja.serialize=function(_,O){return _._trim(),O&&(_.isTransferred=!0,O.push(_.arrayBuffer)),{length:_.length,arrayBuffer:_.arrayBuffer}},Ja.deserialize=function(_){var O=Object.create(this.prototype);return O.arrayBuffer=_.arrayBuffer,O.length=_.length,O.capacity=_.arrayBuffer.byteLength/O.bytesPerElement,O._refreshViews(),O},Ja.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Ja.prototype.clear=function(){this.length=0},Ja.prototype.resize=function(_){this.reserve(_),this.length=_},Ja.prototype.reserve=function(_){if(_>this.capacity){this.capacity=Math.max(_,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var O=this.uint8;this._refreshViews(),O&&this.uint8.set(O)}},Ja.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Ss=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re){var fe=this.length;return this.resize(fe+1),this.emplace(fe,q,re)},O.prototype.emplace=function(q,re,fe){var me=2*q;return this.int16[me+0]=re,this.int16[me+1]=fe,q},O}(Ja);Ss.prototype.bytesPerElement=4,Xr("StructArrayLayout2i4",Ss);var zi=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re,fe,me){var Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,q,re,fe,me)},O.prototype.emplace=function(q,re,fe,me,Ae){var De=4*q;return this.int16[De+0]=re,this.int16[De+1]=fe,this.int16[De+2]=me,this.int16[De+3]=Ae,q},O}(Ja);zi.prototype.bytesPerElement=8,Xr("StructArrayLayout4i8",zi);var Fs=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re,fe,me,Ae,De){var Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,q,re,fe,me,Ae,De)},O.prototype.emplace=function(q,re,fe,me,Ae,De,Ze){var ut=6*q;return this.int16[ut+0]=re,this.int16[ut+1]=fe,this.int16[ut+2]=me,this.int16[ut+3]=Ae,this.int16[ut+4]=De,this.int16[ut+5]=Ze,q},O}(Ja);Fs.prototype.bytesPerElement=12,Xr("StructArrayLayout2i4i12",Fs);var Qs=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re,fe,me,Ae,De){var Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,q,re,fe,me,Ae,De)},O.prototype.emplace=function(q,re,fe,me,Ae,De,Ze){var ut=4*q,gt=8*q;return this.int16[ut+0]=re,this.int16[ut+1]=fe,this.uint8[gt+4]=me,this.uint8[gt+5]=Ae,this.uint8[gt+6]=De,this.uint8[gt+7]=Ze,q},O}(Ja);Qs.prototype.bytesPerElement=8,Xr("StructArrayLayout2i4ub8",Qs);var Gs=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re,fe,me,Ae,De,Ze,ut,gt,Bt){var Wt=this.length;return this.resize(Wt+1),this.emplace(Wt,q,re,fe,me,Ae,De,Ze,ut,gt,Bt)},O.prototype.emplace=function(q,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt){var Ht=9*q,ar=18*q;return this.uint16[Ht+0]=re,this.uint16[Ht+1]=fe,this.uint16[Ht+2]=me,this.uint16[Ht+3]=Ae,this.uint16[Ht+4]=De,this.uint16[Ht+5]=Ze,this.uint16[Ht+6]=ut,this.uint16[Ht+7]=gt,this.uint8[ar+16]=Bt,this.uint8[ar+17]=Wt,q},O}(Ja);Gs.prototype.bytesPerElement=18,Xr("StructArrayLayout8ui2ub18",Gs);var el=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht){var ar=this.length;return this.resize(ar+1),this.emplace(ar,q,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht)},O.prototype.emplace=function(q,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar){var gr=12*q;return this.int16[gr+0]=re,this.int16[gr+1]=fe,this.int16[gr+2]=me,this.int16[gr+3]=Ae,this.uint16[gr+4]=De,this.uint16[gr+5]=Ze,this.uint16[gr+6]=ut,this.uint16[gr+7]=gt,this.int16[gr+8]=Bt,this.int16[gr+9]=Wt,this.int16[gr+10]=Ht,this.int16[gr+11]=ar,q},O}(Ja);el.prototype.bytesPerElement=24,Xr("StructArrayLayout4i4ui4i24",el);var Es=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re,fe){var me=this.length;return this.resize(me+1),this.emplace(me,q,re,fe)},O.prototype.emplace=function(q,re,fe,me){var Ae=3*q;return this.float32[Ae+0]=re,this.float32[Ae+1]=fe,this.float32[Ae+2]=me,q},O}(Ja);Es.prototype.bytesPerElement=12,Xr("StructArrayLayout3f12",Es);var Ol=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q){var re=this.length;return this.resize(re+1),this.emplace(re,q)},O.prototype.emplace=function(q,re){var fe=1*q;return this.uint32[fe+0]=re,q},O}(Ja);Ol.prototype.bytesPerElement=4,Xr("StructArrayLayout1ul4",Ol);var Xl=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re,fe,me,Ae,De,Ze,ut,gt){var Bt=this.length;return this.resize(Bt+1),this.emplace(Bt,q,re,fe,me,Ae,De,Ze,ut,gt)},O.prototype.emplace=function(q,re,fe,me,Ae,De,Ze,ut,gt,Bt){var Wt=10*q,Ht=5*q;return this.int16[Wt+0]=re,this.int16[Wt+1]=fe,this.int16[Wt+2]=me,this.int16[Wt+3]=Ae,this.int16[Wt+4]=De,this.int16[Wt+5]=Ze,this.uint32[Ht+3]=ut,this.uint16[Wt+8]=gt,this.uint16[Wt+9]=Bt,q},O}(Ja);Xl.prototype.bytesPerElement=20,Xr("StructArrayLayout6i1ul2ui20",Xl);var Bs=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re,fe,me,Ae,De){var Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,q,re,fe,me,Ae,De)},O.prototype.emplace=function(q,re,fe,me,Ae,De,Ze){var ut=6*q;return this.int16[ut+0]=re,this.int16[ut+1]=fe,this.int16[ut+2]=me,this.int16[ut+3]=Ae,this.int16[ut+4]=De,this.int16[ut+5]=Ze,q},O}(Ja);Bs.prototype.bytesPerElement=12,Xr("StructArrayLayout2i2i2i12",Bs);var Dl=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re,fe,me,Ae){var De=this.length;return this.resize(De+1),this.emplace(De,q,re,fe,me,Ae)},O.prototype.emplace=function(q,re,fe,me,Ae,De){var Ze=4*q,ut=8*q;return this.float32[Ze+0]=re,this.float32[Ze+1]=fe,this.float32[Ze+2]=me,this.int16[ut+6]=Ae,this.int16[ut+7]=De,q},O}(Ja);Dl.prototype.bytesPerElement=16,Xr("StructArrayLayout2f1f2i16",Dl);var tl=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re,fe,me){var Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,q,re,fe,me)},O.prototype.emplace=function(q,re,fe,me,Ae){var De=12*q,Ze=3*q;return this.uint8[De+0]=re,this.uint8[De+1]=fe,this.float32[Ze+1]=me,this.float32[Ze+2]=Ae,q},O}(Ja);tl.prototype.bytesPerElement=12,Xr("StructArrayLayout2ub2f12",tl);var lo=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re,fe){var me=this.length;return this.resize(me+1),this.emplace(me,q,re,fe)},O.prototype.emplace=function(q,re,fe,me){var Ae=3*q;return this.uint16[Ae+0]=re,this.uint16[Ae+1]=fe,this.uint16[Ae+2]=me,q},O}(Ja);lo.prototype.bytesPerElement=6,Xr("StructArrayLayout3ui6",lo);var Zl=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar,gr,Cr,Er,Fr){var Br=this.length;return this.resize(Br+1),this.emplace(Br,q,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar,gr,Cr,Er,Fr)},O.prototype.emplace=function(q,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar,gr,Cr,Er,Fr,Br){var Hr=24*q,fn=12*q,xn=48*q;return this.int16[Hr+0]=re,this.int16[Hr+1]=fe,this.uint16[Hr+2]=me,this.uint16[Hr+3]=Ae,this.uint32[fn+2]=De,this.uint32[fn+3]=Ze,this.uint32[fn+4]=ut,this.uint16[Hr+10]=gt,this.uint16[Hr+11]=Bt,this.uint16[Hr+12]=Wt,this.float32[fn+7]=Ht,this.float32[fn+8]=ar,this.uint8[xn+36]=gr,this.uint8[xn+37]=Cr,this.uint8[xn+38]=Er,this.uint32[fn+10]=Fr,this.int16[Hr+22]=Br,q},O}(Ja);Zl.prototype.bytesPerElement=48,Xr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Zl);var Kl=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar,gr,Cr,Er,Fr,Br,Hr,fn,xn,Nn,Fn,qn,na,ia,Zn,ha){var ca=this.length;return this.resize(ca+1),this.emplace(ca,q,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar,gr,Cr,Er,Fr,Br,Hr,fn,xn,Nn,Fn,qn,na,ia,Zn,ha)},O.prototype.emplace=function(q,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar,gr,Cr,Er,Fr,Br,Hr,fn,xn,Nn,Fn,qn,na,ia,Zn,ha,ca){var oa=34*q,$a=17*q;return this.int16[oa+0]=re,this.int16[oa+1]=fe,this.int16[oa+2]=me,this.int16[oa+3]=Ae,this.int16[oa+4]=De,this.int16[oa+5]=Ze,this.int16[oa+6]=ut,this.int16[oa+7]=gt,this.uint16[oa+8]=Bt,this.uint16[oa+9]=Wt,this.uint16[oa+10]=Ht,this.uint16[oa+11]=ar,this.uint16[oa+12]=gr,this.uint16[oa+13]=Cr,this.uint16[oa+14]=Er,this.uint16[oa+15]=Fr,this.uint16[oa+16]=Br,this.uint16[oa+17]=Hr,this.uint16[oa+18]=fn,this.uint16[oa+19]=xn,this.uint16[oa+20]=Nn,this.uint16[oa+21]=Fn,this.uint16[oa+22]=qn,this.uint32[$a+12]=na,this.float32[$a+13]=ia,this.float32[$a+14]=Zn,this.float32[$a+15]=ha,this.float32[$a+16]=ca,q},O}(Ja);Kl.prototype.bytesPerElement=68,Xr("StructArrayLayout8i15ui1ul4f68",Kl);var oe=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q){var re=this.length;return this.resize(re+1),this.emplace(re,q)},O.prototype.emplace=function(q,re){var fe=1*q;return this.float32[fe+0]=re,q},O}(Ja);oe.prototype.bytesPerElement=4,Xr("StructArrayLayout1f4",oe);var C=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re,fe){var me=this.length;return this.resize(me+1),this.emplace(me,q,re,fe)},O.prototype.emplace=function(q,re,fe,me){var Ae=3*q;return this.int16[Ae+0]=re,this.int16[Ae+1]=fe,this.int16[Ae+2]=me,q},O}(Ja);C.prototype.bytesPerElement=6,Xr("StructArrayLayout3i6",C);var R=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re,fe){var me=this.length;return this.resize(me+1),this.emplace(me,q,re,fe)},O.prototype.emplace=function(q,re,fe,me){var Ae=2*q,De=4*q;return this.uint32[Ae+0]=re,this.uint16[De+2]=fe,this.uint16[De+3]=me,q},O}(Ja);R.prototype.bytesPerElement=8,Xr("StructArrayLayout1ul2ui8",R);var F=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re){var fe=this.length;return this.resize(fe+1),this.emplace(fe,q,re)},O.prototype.emplace=function(q,re,fe){var me=2*q;return this.uint16[me+0]=re,this.uint16[me+1]=fe,q},O}(Ja);F.prototype.bytesPerElement=4,Xr("StructArrayLayout2ui4",F);var V=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q){var re=this.length;return this.resize(re+1),this.emplace(re,q)},O.prototype.emplace=function(q,re){var fe=1*q;return this.uint16[fe+0]=re,q},O}(Ja);V.prototype.bytesPerElement=2,Xr("StructArrayLayout1ui2",V);var ne=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re){var fe=this.length;return this.resize(fe+1),this.emplace(fe,q,re)},O.prototype.emplace=function(q,re,fe){var me=2*q;return this.float32[me+0]=re,this.float32[me+1]=fe,q},O}(Ja);ne.prototype.bytesPerElement=8,Xr("StructArrayLayout2f8",ne);var le=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,re,fe,me){var Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,q,re,fe,me)},O.prototype.emplace=function(q,re,fe,me,Ae){var De=4*q;return this.float32[De+0]=re,this.float32[De+1]=fe,this.float32[De+2]=me,this.float32[De+3]=Ae,q},O}(Ja);le.prototype.bytesPerElement=16,Xr("StructArrayLayout4f16",le);var pe=function(_){function O(){_.apply(this,arguments)}_&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O;var q={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return q.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},q.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},q.x1.get=function(){return this._structArray.int16[this._pos2+2]},q.y1.get=function(){return this._structArray.int16[this._pos2+3]},q.x2.get=function(){return this._structArray.int16[this._pos2+4]},q.y2.get=function(){return this._structArray.int16[this._pos2+5]},q.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},q.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},q.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},q.anchorPoint.get=function(){return new u(this.anchorPointX,this.anchorPointY)},Object.defineProperties(O.prototype,q),O}($s);pe.prototype.size=20;var ye=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.get=function(q){return new pe(this,q)},O}(Xl);Xr("CollisionBoxArray",ye);var Te=function(_){function O(){_.apply(this,arguments)}_&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O;var q={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return q.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},q.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},q.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},q.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},q.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},q.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},q.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},q.segment.get=function(){return this._structArray.uint16[this._pos2+10]},q.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},q.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},q.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},q.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},q.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},q.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},q.placedOrientation.set=function(re){this._structArray.uint8[this._pos1+37]=re},q.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},q.hidden.set=function(re){this._structArray.uint8[this._pos1+38]=re},q.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},q.crossTileID.set=function(re){this._structArray.uint32[this._pos4+10]=re},q.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(O.prototype,q),O}($s);Te.prototype.size=48;var Ne=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.get=function(q){return new Te(this,q)},O}(Zl);Xr("PlacedSymbolArray",Ne);var Ge=function(_){function O(){_.apply(this,arguments)}_&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O;var q={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return q.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},q.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},q.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},q.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},q.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},q.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},q.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},q.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},q.key.get=function(){return this._structArray.uint16[this._pos2+8]},q.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},q.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},q.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},q.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},q.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},q.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},q.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},q.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},q.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},q.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},q.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},q.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},q.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},q.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},q.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},q.crossTileID.set=function(re){this._structArray.uint32[this._pos4+12]=re},q.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},q.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},q.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},q.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(O.prototype,q),O}($s);Ge.prototype.size=68;var nt=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.get=function(q){return new Ge(this,q)},O}(Kl);Xr("SymbolInstanceArray",nt);var bt=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.getoffsetX=function(q){return this.float32[1*q+0]},O}(oe);Xr("GlyphOffsetArray",bt);var Ct=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.getx=function(q){return this.int16[3*q+0]},O.prototype.gety=function(q){return this.int16[3*q+1]},O.prototype.gettileUnitDistanceFromAnchor=function(q){return this.int16[3*q+2]},O}(C);Xr("SymbolLineVertexArray",Ct);var Tt=function(_){function O(){_.apply(this,arguments)}_&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O;var q={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return q.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},q.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},q.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(O.prototype,q),O}($s);Tt.prototype.size=8;var At=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.get=function(q){return new Tt(this,q)},O}(R);Xr("FeatureIndexArray",At);var yt=oi([{name:"a_pos",components:2,type:"Int16"}],4).members,Ft=function(_){_===void 0&&(_=[]),this.segments=_};function zt(_,O){return 256*(_=n(Math.floor(_),0,255))+(O=n(Math.floor(O),0,255))}Ft.prototype.prepareSegment=function(_,O,q,re){var fe=this.segments[this.segments.length-1];return _>Ft.MAX_VERTEX_ARRAY_LENGTH&&k("Max vertices per segment is "+Ft.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+_),(!fe||fe.vertexLength+_>Ft.MAX_VERTEX_ARRAY_LENGTH||fe.sortKey!==re)&&(fe={vertexOffset:O.length,primitiveOffset:q.length,vertexLength:0,primitiveLength:0},re!==void 0&&(fe.sortKey=re),this.segments.push(fe)),fe},Ft.prototype.get=function(){return this.segments},Ft.prototype.destroy=function(){for(var _=0,O=this.segments;_<O.length;_+=1){var q=O[_];for(var re in q.vaos)q.vaos[re].destroy()}},Ft.simpleSegment=function(_,O,q,re){return new Ft([{vertexOffset:_,primitiveOffset:O,vertexLength:q,primitiveLength:re,vaos:{},sortKey:0}])},Ft.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Xr("SegmentVector",Ft);var jt=oi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),rr=f(function(_){_.exports=function(O,q){var re,fe,me,Ae,De,Ze,ut,gt;for(re=3&O.length,fe=O.length-re,me=q,De=3432918353,Ze=461845907,gt=0;gt<fe;)ut=255&O.charCodeAt(gt)|(255&O.charCodeAt(++gt))<<8|(255&O.charCodeAt(++gt))<<16|(255&O.charCodeAt(++gt))<<24,++gt,me=27492+(65535&(Ae=5*(65535&(me=(me^=ut=(65535&(ut=(ut=(65535&ut)*De+(((ut>>>16)*De&65535)<<16)&4294967295)<<15|ut>>>17))*Ze+(((ut>>>16)*Ze&65535)<<16)&4294967295)<<13|me>>>19))+((5*(me>>>16)&65535)<<16)&4294967295))+((58964+(Ae>>>16)&65535)<<16);switch(ut=0,re){case 3:ut^=(255&O.charCodeAt(gt+2))<<16;case 2:ut^=(255&O.charCodeAt(gt+1))<<8;case 1:me^=ut=(65535&(ut=(ut=(65535&(ut^=255&O.charCodeAt(gt)))*De+(((ut>>>16)*De&65535)<<16)&4294967295)<<15|ut>>>17))*Ze+(((ut>>>16)*Ze&65535)<<16)&4294967295}return me^=O.length,me=2246822507*(65535&(me^=me>>>16))+((2246822507*(me>>>16)&65535)<<16)&4294967295,me=3266489909*(65535&(me^=me>>>13))+((3266489909*(me>>>16)&65535)<<16)&4294967295,(me^=me>>>16)>>>0}}),hr=f(function(_){_.exports=function(O,q){for(var re,fe=O.length,me=q^fe,Ae=0;fe>=4;)re=1540483477*(65535&(re=255&O.charCodeAt(Ae)|(255&O.charCodeAt(++Ae))<<8|(255&O.charCodeAt(++Ae))<<16|(255&O.charCodeAt(++Ae))<<24))+((1540483477*(re>>>16)&65535)<<16),me=1540483477*(65535&me)+((1540483477*(me>>>16)&65535)<<16)^(re=1540483477*(65535&(re^=re>>>24))+((1540483477*(re>>>16)&65535)<<16)),fe-=4,++Ae;switch(fe){case 3:me^=(255&O.charCodeAt(Ae+2))<<16;case 2:me^=(255&O.charCodeAt(Ae+1))<<8;case 1:me=1540483477*(65535&(me^=255&O.charCodeAt(Ae)))+((1540483477*(me>>>16)&65535)<<16)}return me=1540483477*(65535&(me^=me>>>13))+((1540483477*(me>>>16)&65535)<<16),(me^=me>>>15)>>>0}}),Ar=rr,kr=rr,Kr=hr;Ar.murmur3=kr,Ar.murmur2=Kr;var Zr=function(){this.ids=[],this.positions=[],this.indexed=!1};Zr.prototype.add=function(_,O,q,re){this.ids.push(sn(_)),this.positions.push(O,q,re)},Zr.prototype.getPositions=function(_){for(var O=sn(_),q=0,re=this.ids.length-1;q<re;){var fe=q+re>>1;this.ids[fe]>=O?re=fe:q=fe+1}for(var me=[];this.ids[q]===O;){var Ae=this.positions[3*q],De=this.positions[3*q+1],Ze=this.positions[3*q+2];me.push({index:Ae,start:De,end:Ze}),q++}return me},Zr.serialize=function(_,O){var q=new Float64Array(_.ids),re=new Uint32Array(_.positions);return function fe(me,Ae,De,Ze){for(;De<Ze;){for(var ut=me[De+Ze>>1],gt=De-1,Bt=Ze+1;;){do gt++;while(me[gt]<ut);do Bt--;while(me[Bt]>ut);if(gt>=Bt)break;Un(me,gt,Bt),Un(Ae,3*gt,3*Bt),Un(Ae,3*gt+1,3*Bt+1),Un(Ae,3*gt+2,3*Bt+2)}Bt-De<Ze-Bt?(fe(me,Ae,De,Bt),De=Bt+1):(fe(me,Ae,Bt+1,Ze),Ze=Bt)}}(q,re,0,q.length-1),O&&O.push(q.buffer,re.buffer),{ids:q,positions:re}},Zr.deserialize=function(_){var O=new Zr;return O.ids=_.ids,O.positions=_.positions,O.indexed=!0,O};var hn=Math.pow(2,53)-1;function sn(_){var O=+_;return!isNaN(O)&&O<=hn?O:Ar(String(_))}function Un(_,O,q){var re=_[O];_[O]=_[q],_[q]=re}Xr("FeaturePositionMap",Zr);var Wn=function(_,O){this.gl=_.gl,this.location=O},ua=function(_){function O(q,re){_.call(this,q,re),this.current=0}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.set=function(q){this.current!==q&&(this.current=q,this.gl.uniform1i(this.location,q))},O}(Wn),Ur=function(_){function O(q,re){_.call(this,q,re),this.current=0}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.set=function(q){this.current!==q&&(this.current=q,this.gl.uniform1f(this.location,q))},O}(Wn),kn=function(_){function O(q,re){_.call(this,q,re),this.current=[0,0]}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.set=function(q){q[0]===this.current[0]&&q[1]===this.current[1]||(this.current=q,this.gl.uniform2f(this.location,q[0],q[1]))},O}(Wn),Xn=function(_){function O(q,re){_.call(this,q,re),this.current=[0,0,0]}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.set=function(q){q[0]===this.current[0]&&q[1]===this.current[1]&&q[2]===this.current[2]||(this.current=q,this.gl.uniform3f(this.location,q[0],q[1],q[2]))},O}(Wn),Gn=function(_){function O(q,re){_.call(this,q,re),this.current=[0,0,0,0]}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.set=function(q){q[0]===this.current[0]&&q[1]===this.current[1]&&q[2]===this.current[2]&&q[3]===this.current[3]||(this.current=q,this.gl.uniform4f(this.location,q[0],q[1],q[2],q[3]))},O}(Wn),ea=function(_){function O(q,re){_.call(this,q,re),this.current=ur.transparent}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.set=function(q){q.r===this.current.r&&q.g===this.current.g&&q.b===this.current.b&&q.a===this.current.a||(this.current=q,this.gl.uniform4f(this.location,q.r,q.g,q.b,q.a))},O}(Wn),fa=new Float32Array(16),Ma=function(_){function O(q,re){_.call(this,q,re),this.current=fa}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.set=function(q){if(q[12]!==this.current[12]||q[0]!==this.current[0])return this.current=q,void this.gl.uniformMatrix4fv(this.location,!1,q);for(var re=1;re<16;re++)if(q[re]!==this.current[re]){this.current=q,this.gl.uniformMatrix4fv(this.location,!1,q);break}},O}(Wn);function Kn(_){return[zt(255*_.r,255*_.g),zt(255*_.b,255*_.a)]}var xa=function(_,O,q){this.value=_,this.uniformNames=O.map(function(re){return"u_"+re}),this.type=q};xa.prototype.setUniform=function(_,O,q){_.set(q.constantOr(this.value))},xa.prototype.getBinding=function(_,O,q){return this.type==="color"?new ea(_,O):new Ur(_,O)};var ma=function(_,O){this.uniformNames=O.map(function(q){return"u_"+q}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ma.prototype.setConstantPatternPositions=function(_,O){this.pixelRatioFrom=O.pixelRatio,this.pixelRatioTo=_.pixelRatio,this.patternFrom=O.tlbr,this.patternTo=_.tlbr},ma.prototype.setUniform=function(_,O,q,re){var fe=re==="u_pattern_to"?this.patternTo:re==="u_pattern_from"?this.patternFrom:re==="u_pixel_ratio_to"?this.pixelRatioTo:re==="u_pixel_ratio_from"?this.pixelRatioFrom:null;fe&&_.set(fe)},ma.prototype.getBinding=function(_,O,q){return q.substr(0,9)==="u_pattern"?new Gn(_,O):new Ur(_,O)};var La=function(_,O,q,re){this.expression=_,this.type=q,this.maxValue=0,this.paintVertexAttributes=O.map(function(fe){return{name:"a_"+fe,type:"Float32",components:q==="color"?2:1,offset:0}}),this.paintVertexArray=new re};La.prototype.populatePaintArray=function(_,O,q,re,fe){var me=this.paintVertexArray.length,Ae=this.expression.evaluate(new ii(0),O,{},re,[],fe);this.paintVertexArray.resize(_),this._setPaintValue(me,_,Ae)},La.prototype.updatePaintArray=function(_,O,q,re){var fe=this.expression.evaluate({zoom:0},q,re);this._setPaintValue(_,O,fe)},La.prototype._setPaintValue=function(_,O,q){if(this.type==="color")for(var re=Kn(q),fe=_;fe<O;fe++)this.paintVertexArray.emplace(fe,re[0],re[1]);else{for(var me=_;me<O;me++)this.paintVertexArray.emplace(me,q);this.maxValue=Math.max(this.maxValue,Math.abs(q))}},La.prototype.upload=function(_){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=_.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},La.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var ba=function(_,O,q,re,fe,me){this.expression=_,this.uniformNames=O.map(function(Ae){return"u_"+Ae+"_t"}),this.type=q,this.useIntegerZoom=re,this.zoom=fe,this.maxValue=0,this.paintVertexAttributes=O.map(function(Ae){return{name:"a_"+Ae,type:"Float32",components:q==="color"?4:2,offset:0}}),this.paintVertexArray=new me};ba.prototype.populatePaintArray=function(_,O,q,re,fe){var me=this.expression.evaluate(new ii(this.zoom),O,{},re,[],fe),Ae=this.expression.evaluate(new ii(this.zoom+1),O,{},re,[],fe),De=this.paintVertexArray.length;this.paintVertexArray.resize(_),this._setPaintValue(De,_,me,Ae)},ba.prototype.updatePaintArray=function(_,O,q,re){var fe=this.expression.evaluate({zoom:this.zoom},q,re),me=this.expression.evaluate({zoom:this.zoom+1},q,re);this._setPaintValue(_,O,fe,me)},ba.prototype._setPaintValue=function(_,O,q,re){if(this.type==="color")for(var fe=Kn(q),me=Kn(re),Ae=_;Ae<O;Ae++)this.paintVertexArray.emplace(Ae,fe[0],fe[1],me[0],me[1]);else{for(var De=_;De<O;De++)this.paintVertexArray.emplace(De,q,re);this.maxValue=Math.max(this.maxValue,Math.abs(q),Math.abs(re))}},ba.prototype.upload=function(_){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=_.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ba.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ba.prototype.setUniform=function(_,O){var q=this.useIntegerZoom?Math.floor(O.zoom):O.zoom,re=n(this.expression.interpolationFactor(q,this.zoom,this.zoom+1),0,1);_.set(re)},ba.prototype.getBinding=function(_,O,q){return new Ur(_,O)};var Pa=function(_,O,q,re,fe,me){this.expression=_,this.type=O,this.useIntegerZoom=q,this.zoom=re,this.layerId=me,this.zoomInPaintVertexArray=new fe,this.zoomOutPaintVertexArray=new fe};Pa.prototype.populatePaintArray=function(_,O,q){var re=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(_),this.zoomOutPaintVertexArray.resize(_),this._setPaintValues(re,_,O.patterns&&O.patterns[this.layerId],q)},Pa.prototype.updatePaintArray=function(_,O,q,re,fe){this._setPaintValues(_,O,q.patterns&&q.patterns[this.layerId],fe)},Pa.prototype._setPaintValues=function(_,O,q,re){if(re&&q){var fe=q.min,me=q.mid,Ae=q.max,De=re[fe],Ze=re[me],ut=re[Ae];if(De&&Ze&&ut)for(var gt=_;gt<O;gt++)this.zoomInPaintVertexArray.emplace(gt,Ze.tl[0],Ze.tl[1],Ze.br[0],Ze.br[1],De.tl[0],De.tl[1],De.br[0],De.br[1],Ze.pixelRatio,De.pixelRatio),this.zoomOutPaintVertexArray.emplace(gt,Ze.tl[0],Ze.tl[1],Ze.br[0],Ze.br[1],ut.tl[0],ut.tl[1],ut.br[0],ut.br[1],Ze.pixelRatio,ut.pixelRatio)}},Pa.prototype.upload=function(_){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=_.createVertexBuffer(this.zoomInPaintVertexArray,jt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=_.createVertexBuffer(this.zoomOutPaintVertexArray,jt.members,this.expression.isStateDependent))},Pa.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ua=function(_,O,q,re){this.binders={},this.layoutAttributes=re,this._buffers=[];var fe=[];for(var me in _.paint._values)if(q(me)){var Ae=_.paint.get(me);if(Ae instanceof ji&&as(Ae.property.specification)){var De=Ri(me,_.type),Ze=Ae.value,ut=Ae.property.specification.type,gt=Ae.property.useIntegerZoom,Bt=Ae.property.specification["property-type"],Wt=Bt==="cross-faded"||Bt==="cross-faded-data-driven";if(Ze.kind==="constant")this.binders[me]=Wt?new ma(Ze.value,De):new xa(Ze.value,De,ut),fe.push("/u_"+me);else if(Ze.kind==="source"||Wt){var Ht=Fi(me,ut,"source");this.binders[me]=Wt?new Pa(Ze,ut,gt,O,Ht,_.id):new La(Ze,De,ut,Ht),fe.push("/a_"+me)}else{var ar=Fi(me,ut,"composite");this.binders[me]=new ba(Ze,De,ut,gt,O,ar),fe.push("/z_"+me)}}}this.cacheKey=fe.sort().join("")};Ua.prototype.getMaxValue=function(_){var O=this.binders[_];return O instanceof La||O instanceof ba?O.maxValue:0},Ua.prototype.populatePaintArrays=function(_,O,q,re,fe){for(var me in this.binders){var Ae=this.binders[me];(Ae instanceof La||Ae instanceof ba||Ae instanceof Pa)&&Ae.populatePaintArray(_,O,q,re,fe)}},Ua.prototype.setConstantPatternPositions=function(_,O){for(var q in this.binders){var re=this.binders[q];re instanceof ma&&re.setConstantPatternPositions(_,O)}},Ua.prototype.updatePaintArrays=function(_,O,q,re,fe){var me=!1;for(var Ae in _)for(var De=0,Ze=O.getPositions(Ae);De<Ze.length;De+=1){var ut=Ze[De],gt=q.feature(ut.index);for(var Bt in this.binders){var Wt=this.binders[Bt];if((Wt instanceof La||Wt instanceof ba||Wt instanceof Pa)&&Wt.expression.isStateDependent===!0){var Ht=re.paint.get(Bt);Wt.expression=Ht.value,Wt.updatePaintArray(ut.start,ut.end,gt,_[Ae],fe),me=!0}}}return me},Ua.prototype.defines=function(){var _=[];for(var O in this.binders){var q=this.binders[O];(q instanceof xa||q instanceof ma)&&_.push.apply(_,q.uniformNames.map(function(re){return"#define HAS_UNIFORM_"+re}))}return _},Ua.prototype.getPaintVertexBuffers=function(){return this._buffers},Ua.prototype.getUniforms=function(_,O){var q=[];for(var re in this.binders){var fe=this.binders[re];if(fe instanceof xa||fe instanceof ma||fe instanceof ba)for(var me=0,Ae=fe.uniformNames;me<Ae.length;me+=1){var De=Ae[me];if(O[De]){var Ze=fe.getBinding(_,O[De],De);q.push({name:De,property:re,binding:Ze})}}}return q},Ua.prototype.setUniforms=function(_,O,q,re){for(var fe=0,me=O;fe<me.length;fe+=1){var Ae=me[fe],De=Ae.name,Ze=Ae.property,ut=Ae.binding;this.binders[Ze].setUniform(ut,re,q.get(Ze),De)}},Ua.prototype.updatePaintBuffers=function(_){for(var O in this._buffers=[],this.binders){var q=this.binders[O];if(_&&q instanceof Pa){var re=_.fromScale===2?q.zoomInPaintVertexBuffer:q.zoomOutPaintVertexBuffer;re&&this._buffers.push(re)}else(q instanceof La||q instanceof ba)&&q.paintVertexBuffer&&this._buffers.push(q.paintVertexBuffer)}},Ua.prototype.upload=function(_){for(var O in this.binders){var q=this.binders[O];(q instanceof La||q instanceof ba||q instanceof Pa)&&q.upload(_)}this.updatePaintBuffers()},Ua.prototype.destroy=function(){for(var _ in this.binders){var O=this.binders[_];(O instanceof La||O instanceof ba||O instanceof Pa)&&O.destroy()}};var di=function(_,O,q,re){re===void 0&&(re=function(){return!0}),this.programConfigurations={};for(var fe=0,me=O;fe<me.length;fe+=1){var Ae=me[fe];this.programConfigurations[Ae.id]=new Ua(Ae,q,re,_)}this.needsUpload=!1,this._featureMap=new Zr,this._bufferOffset=0};function Ri(_,O){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[_]||[_.replace(O+"-","").replace(/-/g,"_")]}function Fi(_,O,q){var re={color:{source:ne,composite:le},number:{source:oe,composite:ne}},fe=function(me){return{"line-pattern":{source:Gs,composite:Gs},"fill-pattern":{source:Gs,composite:Gs},"fill-extrusion-pattern":{source:Gs,composite:Gs}}[me]}(_);return fe&&fe[q]||re[O][q]}di.prototype.populatePaintArrays=function(_,O,q,re,fe,me){for(var Ae in this.programConfigurations)this.programConfigurations[Ae].populatePaintArrays(_,O,re,fe,me);O.id!==void 0&&this._featureMap.add(O.id,q,this._bufferOffset,_),this._bufferOffset=_,this.needsUpload=!0},di.prototype.updatePaintArrays=function(_,O,q,re){for(var fe=0,me=q;fe<me.length;fe+=1){var Ae=me[fe];this.needsUpload=this.programConfigurations[Ae.id].updatePaintArrays(_,this._featureMap,O,Ae,re)||this.needsUpload}},di.prototype.get=function(_){return this.programConfigurations[_]},di.prototype.upload=function(_){if(this.needsUpload){for(var O in this.programConfigurations)this.programConfigurations[O].upload(_);this.needsUpload=!1}},di.prototype.destroy=function(){for(var _ in this.programConfigurations)this.programConfigurations[_].destroy()},Xr("ConstantBinder",xa),Xr("CrossFadedConstantBinder",ma),Xr("SourceExpressionBinder",La),Xr("CrossFadedCompositeBinder",Pa),Xr("CompositeExpressionBinder",ba),Xr("ProgramConfiguration",Ua,{omit:["_buffers"]}),Xr("ProgramConfigurationSet",di);var pi,Ci=(pi=15,{min:-1*Math.pow(2,pi-1),max:Math.pow(2,pi-1)-1});function bi(_){for(var O=8192/_.extent,q=_.loadGeometry(),re=0;re<q.length;re++)for(var fe=q[re],me=0;me<fe.length;me++){var Ae=fe[me];Ae.x=Math.round(Ae.x*O),Ae.y=Math.round(Ae.y*O),(Ae.x<Ci.min||Ae.x>Ci.max||Ae.y<Ci.min||Ae.y>Ci.max)&&(k("Geometry exceeds allowed extent, reduce your vector tile buffer size"),Ae.x=n(Ae.x,Ci.min,Ci.max),Ae.y=n(Ae.y,Ci.min,Ci.max))}return q}function Lo(_,O,q,re,fe){_.emplaceBack(2*O+(re+1)/2,2*q+(fe+1)/2)}var Ki=function(_){this.zoom=_.zoom,this.overscaling=_.overscaling,this.layers=_.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=_.index,this.hasPattern=!1,this.layoutVertexArray=new Ss,this.indexArray=new lo,this.segments=new Ft,this.programConfigurations=new di(yt,_.layers,_.zoom),this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};function Zo(_,O){for(var q=0;q<_.length;q++)if(_s(O,_[q]))return!0;for(var re=0;re<O.length;re++)if(_s(_,O[re]))return!0;return!!zl(_,O)}function qs(_,O,q){return!!_s(_,O)||!!Po(O,_,q)}function yl(_,O){if(_.length===1)return $l(O,_[0]);for(var q=0;q<O.length;q++)for(var re=O[q],fe=0;fe<re.length;fe++)if(_s(_,re[fe]))return!0;for(var me=0;me<_.length;me++)if($l(O,_[me]))return!0;for(var Ae=0;Ae<O.length;Ae++)if(zl(_,O[Ae]))return!0;return!1}function Jl(_,O,q){if(_.length>1){if(zl(_,O))return!0;for(var re=0;re<O.length;re++)if(Po(O[re],_,q))return!0}for(var fe=0;fe<_.length;fe++)if(Po(_[fe],O,q))return!0;return!1}function zl(_,O){if(_.length===0||O.length===0)return!1;for(var q=0;q<_.length-1;q++)for(var re=_[q],fe=_[q+1],me=0;me<O.length-1;me++)if(Rl(re,fe,O[me],O[me+1]))return!0;return!1}function Rl(_,O,q,re){return L(_,q,re)!==L(O,q,re)&&L(_,O,q)!==L(_,O,re)}function Po(_,O,q){var re=q*q;if(O.length===1)return _.distSqr(O[0])<re;for(var fe=1;fe<O.length;fe++)if(Tl(_,O[fe-1],O[fe])<re)return!0;return!1}function Tl(_,O,q){var re=O.distSqr(q);if(re===0)return _.distSqr(O);var fe=((_.x-O.x)*(q.x-O.x)+(_.y-O.y)*(q.y-O.y))/re;return fe<0?_.distSqr(O):fe>1?_.distSqr(q):_.distSqr(q.sub(O)._mult(fe)._add(O))}function $l(_,O){for(var q,re,fe,me=!1,Ae=0;Ae<_.length;Ae++)for(var De=0,Ze=(q=_[Ae]).length-1;De<q.length;Ze=De++)re=q[De],fe=q[Ze],re.y>O.y!=fe.y>O.y&&O.x<(fe.x-re.x)*(O.y-re.y)/(fe.y-re.y)+re.x&&(me=!me);return me}function _s(_,O){for(var q=!1,re=0,fe=_.length-1;re<_.length;fe=re++){var me=_[re],Ae=_[fe];me.y>O.y!=Ae.y>O.y&&O.x<(Ae.x-me.x)*(O.y-me.y)/(Ae.y-me.y)+me.x&&(q=!q)}return q}function Ql(_,O,q){var re=q[0],fe=q[2];if(_.x<re.x&&O.x<re.x||_.x>fe.x&&O.x>fe.x||_.y<re.y&&O.y<re.y||_.y>fe.y&&O.y>fe.y)return!1;var me=L(_,O,q[0]);return me!==L(_,O,q[1])||me!==L(_,O,q[2])||me!==L(_,O,q[3])}function Li(_,O,q){var re=O.paint.get(_).value;return re.kind==="constant"?re.value:q.programConfigurations.get(O.id).getMaxValue(_)}function qo(_){return Math.sqrt(_[0]*_[0]+_[1]*_[1])}function Yo(_,O,q,re,fe){if(!O[0]&&!O[1])return _;var me=u.convert(O)._mult(fe);q==="viewport"&&me._rotate(-re);for(var Ae=[],De=0;De<_.length;De++){var Ze=_[De];Ae.push(Ze.sub(me))}return Ae}Ki.prototype.populate=function(_,O,q){var re=this.layers[0],fe=[],me=null;re.type==="circle"&&(me=re.layout.get("circle-sort-key"));for(var Ae=0,De=_;Ae<De.length;Ae+=1){var Ze=De[Ae],ut=Ze.feature,gt=Ze.id,Bt=Ze.index,Wt=Ze.sourceLayerIndex,Ht=this.layers[0]._featureFilter.needGeometry,ar={type:ut.type,id:gt,properties:ut.properties,geometry:Ht?bi(ut):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),ar,q)){Ht||(ar.geometry=bi(ut));var gr=me?me.evaluate(ar,{},q):void 0,Cr={id:gt,properties:ut.properties,type:ut.type,sourceLayerIndex:Wt,index:Bt,geometry:ar.geometry,patterns:{},sortKey:gr};fe.push(Cr)}}me&&fe.sort(function(qn,na){return qn.sortKey-na.sortKey});for(var Er=0,Fr=fe;Er<Fr.length;Er+=1){var Br=Fr[Er],Hr=Br,fn=Hr.geometry,xn=Hr.index,Nn=Hr.sourceLayerIndex,Fn=_[xn].feature;this.addFeature(Br,fn,xn,q),O.featureIndex.insert(Fn,fn,xn,Nn,this.index)}},Ki.prototype.update=function(_,O,q){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(_,O,this.stateDependentLayers,q)},Ki.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ki.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ki.prototype.upload=function(_){this.uploaded||(this.layoutVertexBuffer=_.createVertexBuffer(this.layoutVertexArray,yt),this.indexBuffer=_.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(_),this.uploaded=!0},Ki.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ki.prototype.addFeature=function(_,O,q,re){for(var fe=0,me=O;fe<me.length;fe+=1)for(var Ae=0,De=me[fe];Ae<De.length;Ae+=1){var Ze=De[Ae],ut=Ze.x,gt=Ze.y;if(!(ut<0||ut>=8192||gt<0||gt>=8192)){var Bt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,_.sortKey),Wt=Bt.vertexLength;Lo(this.layoutVertexArray,ut,gt,-1,-1),Lo(this.layoutVertexArray,ut,gt,1,-1),Lo(this.layoutVertexArray,ut,gt,1,1),Lo(this.layoutVertexArray,ut,gt,-1,1),this.indexArray.emplaceBack(Wt,Wt+1,Wt+2),this.indexArray.emplaceBack(Wt,Wt+3,Wt+2),Bt.vertexLength+=4,Bt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,_,q,{},re)},Xr("CircleBucket",Ki,{omit:["layers"]});var du=new Go({"circle-sort-key":new ya(Pe.layout_circle["circle-sort-key"])}),Uf={paint:new Go({"circle-radius":new ya(Pe.paint_circle["circle-radius"]),"circle-color":new ya(Pe.paint_circle["circle-color"]),"circle-blur":new ya(Pe.paint_circle["circle-blur"]),"circle-opacity":new ya(Pe.paint_circle["circle-opacity"]),"circle-translate":new la(Pe.paint_circle["circle-translate"]),"circle-translate-anchor":new la(Pe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new la(Pe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new la(Pe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ya(Pe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ya(Pe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ya(Pe.paint_circle["circle-stroke-opacity"])}),layout:du},fs=typeof Float32Array!="undefined"?Float32Array:Array;function Yu(_){return _[0]=1,_[1]=0,_[2]=0,_[3]=0,_[4]=0,_[5]=1,_[6]=0,_[7]=0,_[8]=0,_[9]=0,_[10]=1,_[11]=0,_[12]=0,_[13]=0,_[14]=0,_[15]=1,_}function eu(_,O,q){var re=O[0],fe=O[1],me=O[2],Ae=O[3],De=O[4],Ze=O[5],ut=O[6],gt=O[7],Bt=O[8],Wt=O[9],Ht=O[10],ar=O[11],gr=O[12],Cr=O[13],Er=O[14],Fr=O[15],Br=q[0],Hr=q[1],fn=q[2],xn=q[3];return _[0]=Br*re+Hr*De+fn*Bt+xn*gr,_[1]=Br*fe+Hr*Ze+fn*Wt+xn*Cr,_[2]=Br*me+Hr*ut+fn*Ht+xn*Er,_[3]=Br*Ae+Hr*gt+fn*ar+xn*Fr,Br=q[4],Hr=q[5],fn=q[6],xn=q[7],_[4]=Br*re+Hr*De+fn*Bt+xn*gr,_[5]=Br*fe+Hr*Ze+fn*Wt+xn*Cr,_[6]=Br*me+Hr*ut+fn*Ht+xn*Er,_[7]=Br*Ae+Hr*gt+fn*ar+xn*Fr,Br=q[8],Hr=q[9],fn=q[10],xn=q[11],_[8]=Br*re+Hr*De+fn*Bt+xn*gr,_[9]=Br*fe+Hr*Ze+fn*Wt+xn*Cr,_[10]=Br*me+Hr*ut+fn*Ht+xn*Er,_[11]=Br*Ae+Hr*gt+fn*ar+xn*Fr,Br=q[12],Hr=q[13],fn=q[14],xn=q[15],_[12]=Br*re+Hr*De+fn*Bt+xn*gr,_[13]=Br*fe+Hr*Ze+fn*Wt+xn*Cr,_[14]=Br*me+Hr*ut+fn*Ht+xn*Er,_[15]=Br*Ae+Hr*gt+fn*ar+xn*Fr,_}Math.hypot||(Math.hypot=function(){for(var _=arguments,O=0,q=arguments.length;q--;)O+=_[q]*_[q];return Math.sqrt(O)});var Vf=eu,kl,Hf=function(_,O,q){return _[0]=O[0]-q[0],_[1]=O[1]-q[1],_[2]=O[2]-q[2],_};kl=new fs(3),fs!=Float32Array&&(kl[0]=0,kl[1]=0,kl[2]=0);function gu(_,O,q){var re=O[0],fe=O[1],me=O[2],Ae=O[3];return _[0]=q[0]*re+q[4]*fe+q[8]*me+q[12]*Ae,_[1]=q[1]*re+q[5]*fe+q[9]*me+q[13]*Ae,_[2]=q[2]*re+q[6]*fe+q[10]*me+q[14]*Ae,_[3]=q[3]*re+q[7]*fe+q[11]*me+q[15]*Ae,_}(function(){(function(){var _=new fs(4);return fs!=Float32Array&&(_[0]=0,_[1]=0,_[2]=0,_[3]=0),_})()})();var Wu=function(_){var O=_[0],q=_[1];return O*O+q*q},l0=(function(){(function(){var _=new fs(2);return fs!=Float32Array&&(_[0]=0,_[1]=0),_})()}(),function(_){function O(q){_.call(this,q,Uf)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.createBucket=function(q){return new Ki(q)},O.prototype.queryRadius=function(q){var re=q;return Li("circle-radius",this,re)+Li("circle-stroke-width",this,re)+qo(this.paint.get("circle-translate"))},O.prototype.queryIntersectsFeature=function(q,re,fe,me,Ae,De,Ze,ut){for(var gt=Yo(q,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),De.angle,Ze),Bt=this.paint.get("circle-radius").evaluate(re,fe)+this.paint.get("circle-stroke-width").evaluate(re,fe),Wt=this.paint.get("circle-pitch-alignment")==="map",Ht=Wt?gt:function(Nn,Fn){return Nn.map(function(qn){return Zh(qn,Fn)})}(gt,ut),ar=Wt?Bt*Ze:Bt,gr=0,Cr=me;gr<Cr.length;gr+=1)for(var Er=0,Fr=Cr[gr];Er<Fr.length;Er+=1){var Br=Fr[Er],Hr=Wt?Br:Zh(Br,ut),fn=ar,xn=gu([],[Br.x,Br.y,0,1],ut);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?fn*=xn[3]/De.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(fn*=De.cameraToCenterDistance/xn[3]),qs(Ht,Hr,fn))return!0}return!1},O}(is));function Zh(_,O){var q=gu([],[_.x,_.y,0,1],O);return new u(q[0]/q[3],q[1]/q[3])}var Kh=function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O}(Ki);function Gf(_,O,q,re){var fe=O.width,me=O.height;if(re){if(re instanceof Uint8ClampedArray)re=new Uint8Array(re.buffer);else if(re.length!==fe*me*q)throw new RangeError("mismatched image size")}else re=new Uint8Array(fe*me*q);return _.width=fe,_.height=me,_.data=re,_}function Jh(_,O,q){var re=O.width,fe=O.height;if(re!==_.width||fe!==_.height){var me=Gf({},{width:re,height:fe},q);qf(_,me,{x:0,y:0},{x:0,y:0},{width:Math.min(_.width,re),height:Math.min(_.height,fe)},q),_.width=re,_.height=fe,_.data=me.data}}function qf(_,O,q,re,fe,me){if(fe.width===0||fe.height===0)return O;if(fe.width>_.width||fe.height>_.height||q.x>_.width-fe.width||q.y>_.height-fe.height)throw new RangeError("out of range source coordinates for image copy");if(fe.width>O.width||fe.height>O.height||re.x>O.width-fe.width||re.y>O.height-fe.height)throw new RangeError("out of range destination coordinates for image copy");for(var Ae=_.data,De=O.data,Ze=0;Ze<fe.height;Ze++)for(var ut=((q.y+Ze)*_.width+q.x)*me,gt=((re.y+Ze)*O.width+re.x)*me,Bt=0;Bt<fe.width*me;Bt++)De[gt+Bt]=Ae[ut+Bt];return O}Xr("HeatmapBucket",Kh,{omit:["layers"]});var tu=function(_,O){Gf(this,_,1,O)};tu.prototype.resize=function(_){Jh(this,_,1)},tu.prototype.clone=function(){return new tu({width:this.width,height:this.height},new Uint8Array(this.data))},tu.copy=function(_,O,q,re,fe){qf(_,O,q,re,fe,1)};var hs=function(_,O){Gf(this,_,4,O)};hs.prototype.resize=function(_){Jh(this,_,4)},hs.prototype.replace=function(_,O){O?this.data.set(_):_ instanceof Uint8ClampedArray?this.data=new Uint8Array(_.buffer):this.data=_},hs.prototype.clone=function(){return new hs({width:this.width,height:this.height},new Uint8Array(this.data))},hs.copy=function(_,O,q,re,fe){qf(_,O,q,re,fe,4)},Xr("AlphaImage",tu),Xr("RGBAImage",hs);var u0={paint:new Go({"heatmap-radius":new ya(Pe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ya(Pe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new la(Pe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new bs(Pe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new la(Pe.paint_heatmap["heatmap-opacity"])})};function $h(_,O){for(var q=new Uint8Array(1024),re={},fe=0,me=0;fe<256;fe++,me+=4){re[O]=fe/255;var Ae=_.evaluate(re);q[me+0]=Math.floor(255*Ae.r/Ae.a),q[me+1]=Math.floor(255*Ae.g/Ae.a),q[me+2]=Math.floor(255*Ae.b/Ae.a),q[me+3]=Math.floor(255*Ae.a)}return new hs({width:256,height:1},q)}var c0=function(_){function O(q){_.call(this,q,u0),this._updateColorRamp()}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.createBucket=function(q){return new Kh(q)},O.prototype._handleSpecialPaintPropertyUpdate=function(q){q==="heatmap-color"&&this._updateColorRamp()},O.prototype._updateColorRamp=function(){var q=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=$h(q,"heatmapDensity"),this.colorRampTexture=null},O.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},O.prototype.queryRadius=function(){return 0},O.prototype.queryIntersectsFeature=function(){return!1},O.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},O}(is),f0={paint:new Go({"hillshade-illumination-direction":new la(Pe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new la(Pe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new la(Pe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new la(Pe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new la(Pe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new la(Pe.paint_hillshade["hillshade-accent-color"])})},h0=function(_){function O(q){_.call(this,q,f0)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},O}(is),Qh=oi([{name:"a_pos",components:2,type:"Int16"}],4).members,Yf=Pc,p0=Pc;function Pc(_,O,q){q=q||2;var re,fe,me,Ae,De,Ze,ut,gt=O&&O.length,Bt=gt?O[0]*q:_.length,Wt=ep(_,0,Bt,q,!0),Ht=[];if(!Wt||Wt.next===Wt.prev)return Ht;if(gt&&(Wt=function(gr,Cr,Er,Fr){var Br,Hr,fn,xn,Nn,Fn=[];for(Br=0,Hr=Cr.length;Br<Hr;Br++)fn=Cr[Br]*Fr,xn=Br<Hr-1?Cr[Br+1]*Fr:gr.length,(Nn=ep(gr,fn,xn,Fr,!1))===Nn.next&&(Nn.steiner=!0),Fn.push(_0(Nn));for(Fn.sort(y0),Br=0;Br<Fn.length;Br++)x0(Fn[Br],Er),Er=Fl(Er,Er.next);return Er}(_,O,Wt,q)),_.length>80*q){re=me=_[0],fe=Ae=_[1];for(var ar=q;ar<Bt;ar+=q)(De=_[ar])<re&&(re=De),(Ze=_[ar+1])<fe&&(fe=Ze),De>me&&(me=De),Ze>Ae&&(Ae=Ze);ut=(ut=Math.max(me-re,Ae-fe))!==0?1/ut:0}return Xu(Wt,Ht,q,re,fe,ut),Ht}function ep(_,O,q,re,fe){var me,Ae;if(fe===Zf(_,O,q,re)>0)for(me=O;me<q;me+=re)Ae=np(me,_[me],_[me+1],Ae);else for(me=q-re;me>=O;me-=re)Ae=np(me,_[me],_[me+1],Ae);return Ae&&Ic(Ae,Ae.next)&&(Ku(Ae),Ae=Ae.next),Ae}function Fl(_,O){if(!_)return _;O||(O=_);var q,re=_;do if(q=!1,re.steiner||!Ic(re,re.next)&&uo(re.prev,re,re.next)!==0)re=re.next;else{if(Ku(re),(re=O=re.prev)===re.next)break;q=!0}while(q||re!==O);return O}function Xu(_,O,q,re,fe,me,Ae){if(_){!Ae&&me&&function(gt,Bt,Wt,Ht){var ar=gt;do ar.z===null&&(ar.z=Wf(ar.x,ar.y,Bt,Wt,Ht)),ar.prevZ=ar.prev,ar.nextZ=ar.next,ar=ar.next;while(ar!==gt);ar.prevZ.nextZ=null,ar.prevZ=null,function(gr){var Cr,Er,Fr,Br,Hr,fn,xn,Nn,Fn=1;do{for(Er=gr,gr=null,Hr=null,fn=0;Er;){for(fn++,Fr=Er,xn=0,Cr=0;Cr<Fn&&(xn++,Fr=Fr.nextZ);Cr++);for(Nn=Fn;xn>0||Nn>0&&Fr;)xn!==0&&(Nn===0||!Fr||Er.z<=Fr.z)?(Br=Er,Er=Er.nextZ,xn--):(Br=Fr,Fr=Fr.nextZ,Nn--),Hr?Hr.nextZ=Br:gr=Br,Br.prevZ=Hr,Hr=Br;Er=Fr}Hr.nextZ=null,Fn*=2}while(fn>1)}(ar)}(_,re,fe,me);for(var De,Ze,ut=_;_.prev!==_.next;)if(De=_.prev,Ze=_.next,me?g0(_,re,fe,me):d0(_))O.push(De.i/q),O.push(_.i/q),O.push(Ze.i/q),Ku(_),_=Ze.next,ut=Ze.next;else if((_=Ze)===ut){Ae?Ae===1?Xu(_=m0(Fl(_),O,q),O,q,re,fe,me,2):Ae===2&&v0(_,O,q,re,fe,me):Xu(Fl(_),O,q,re,fe,me,1);break}}}function d0(_){var O=_.prev,q=_,re=_.next;if(uo(O,q,re)>=0)return!1;for(var fe=_.next.next;fe!==_.prev;){if(mu(O.x,O.y,q.x,q.y,re.x,re.y,fe.x,fe.y)&&uo(fe.prev,fe,fe.next)>=0)return!1;fe=fe.next}return!0}function g0(_,O,q,re){var fe=_.prev,me=_,Ae=_.next;if(uo(fe,me,Ae)>=0)return!1;for(var De=fe.x<me.x?fe.x<Ae.x?fe.x:Ae.x:me.x<Ae.x?me.x:Ae.x,Ze=fe.y<me.y?fe.y<Ae.y?fe.y:Ae.y:me.y<Ae.y?me.y:Ae.y,ut=fe.x>me.x?fe.x>Ae.x?fe.x:Ae.x:me.x>Ae.x?me.x:Ae.x,gt=fe.y>me.y?fe.y>Ae.y?fe.y:Ae.y:me.y>Ae.y?me.y:Ae.y,Bt=Wf(De,Ze,O,q,re),Wt=Wf(ut,gt,O,q,re),Ht=_.prevZ,ar=_.nextZ;Ht&&Ht.z>=Bt&&ar&&ar.z<=Wt;){if(Ht!==_.prev&&Ht!==_.next&&mu(fe.x,fe.y,me.x,me.y,Ae.x,Ae.y,Ht.x,Ht.y)&&uo(Ht.prev,Ht,Ht.next)>=0||(Ht=Ht.prevZ,ar!==_.prev&&ar!==_.next&&mu(fe.x,fe.y,me.x,me.y,Ae.x,Ae.y,ar.x,ar.y)&&uo(ar.prev,ar,ar.next)>=0))return!1;ar=ar.nextZ}for(;Ht&&Ht.z>=Bt;){if(Ht!==_.prev&&Ht!==_.next&&mu(fe.x,fe.y,me.x,me.y,Ae.x,Ae.y,Ht.x,Ht.y)&&uo(Ht.prev,Ht,Ht.next)>=0)return!1;Ht=Ht.prevZ}for(;ar&&ar.z<=Wt;){if(ar!==_.prev&&ar!==_.next&&mu(fe.x,fe.y,me.x,me.y,Ae.x,Ae.y,ar.x,ar.y)&&uo(ar.prev,ar,ar.next)>=0)return!1;ar=ar.nextZ}return!0}function m0(_,O,q){var re=_;do{var fe=re.prev,me=re.next.next;!Ic(fe,me)&&tp(fe,re,re.next,me)&&Zu(fe,me)&&Zu(me,fe)&&(O.push(fe.i/q),O.push(re.i/q),O.push(me.i/q),Ku(re),Ku(re.next),re=_=me),re=re.next}while(re!==_);return Fl(re)}function v0(_,O,q,re,fe,me){var Ae=_;do{for(var De=Ae.next.next;De!==Ae.prev;){if(Ae.i!==De.i&&w0(Ae,De)){var Ze=rp(Ae,De);return Ae=Fl(Ae,Ae.next),Ze=Fl(Ze,Ze.next),Xu(Ae,O,q,re,fe,me),void Xu(Ze,O,q,re,fe,me)}De=De.next}Ae=Ae.next}while(Ae!==_)}function y0(_,O){return _.x-O.x}function x0(_,O){if(O=function(re,fe){var me,Ae=fe,De=re.x,Ze=re.y,ut=-1/0;do{if(Ze<=Ae.y&&Ze>=Ae.next.y&&Ae.next.y!==Ae.y){var gt=Ae.x+(Ze-Ae.y)*(Ae.next.x-Ae.x)/(Ae.next.y-Ae.y);if(gt<=De&&gt>ut){if(ut=gt,gt===De){if(Ze===Ae.y)return Ae;if(Ze===Ae.next.y)return Ae.next}me=Ae.x<Ae.next.x?Ae:Ae.next}}Ae=Ae.next}while(Ae!==fe);if(!me)return null;if(De===ut)return me;var Bt,Wt=me,Ht=me.x,ar=me.y,gr=1/0;Ae=me;do De>=Ae.x&&Ae.x>=Ht&&De!==Ae.x&&mu(Ze<ar?De:ut,Ze,Ht,ar,Ze<ar?ut:De,Ze,Ae.x,Ae.y)&&(Bt=Math.abs(Ze-Ae.y)/(De-Ae.x),Zu(Ae,re)&&(Bt<gr||Bt===gr&&(Ae.x>me.x||Ae.x===me.x&&b0(me,Ae)))&&(me=Ae,gr=Bt)),Ae=Ae.next;while(Ae!==Wt);return me}(_,O)){var q=rp(O,_);Fl(O,O.next),Fl(q,q.next)}}function b0(_,O){return uo(_.prev,_,O.prev)<0&&uo(O.next,_,_.next)<0}function Wf(_,O,q,re,fe){return(_=1431655765&((_=858993459&((_=252645135&((_=16711935&((_=32767*(_-q)*fe)|_<<8))|_<<4))|_<<2))|_<<1))|(O=1431655765&((O=858993459&((O=252645135&((O=16711935&((O=32767*(O-re)*fe)|O<<8))|O<<4))|O<<2))|O<<1))<<1}function _0(_){var O=_,q=_;do(O.x<q.x||O.x===q.x&&O.y<q.y)&&(q=O),O=O.next;while(O!==_);return q}function mu(_,O,q,re,fe,me,Ae,De){return(fe-Ae)*(O-De)-(_-Ae)*(me-De)>=0&&(_-Ae)*(re-De)-(q-Ae)*(O-De)>=0&&(q-Ae)*(me-De)-(fe-Ae)*(re-De)>=0}function w0(_,O){return _.next.i!==O.i&&_.prev.i!==O.i&&!function(q,re){var fe=q;do{if(fe.i!==q.i&&fe.next.i!==q.i&&fe.i!==re.i&&fe.next.i!==re.i&&tp(fe,fe.next,q,re))return!0;fe=fe.next}while(fe!==q);return!1}(_,O)&&(Zu(_,O)&&Zu(O,_)&&function(q,re){var fe=q,me=!1,Ae=(q.x+re.x)/2,De=(q.y+re.y)/2;do fe.y>De!=fe.next.y>De&&fe.next.y!==fe.y&&Ae<(fe.next.x-fe.x)*(De-fe.y)/(fe.next.y-fe.y)+fe.x&&(me=!me),fe=fe.next;while(fe!==q);return me}(_,O)&&(uo(_.prev,_,O.prev)||uo(_,O.prev,O))||Ic(_,O)&&uo(_.prev,_,_.next)>0&&uo(O.prev,O,O.next)>0)}function uo(_,O,q){return(O.y-_.y)*(q.x-O.x)-(O.x-_.x)*(q.y-O.y)}function Ic(_,O){return _.x===O.x&&_.y===O.y}function tp(_,O,q,re){var fe=Dc(uo(_,O,q)),me=Dc(uo(_,O,re)),Ae=Dc(uo(q,re,_)),De=Dc(uo(q,re,O));return fe!==me&&Ae!==De||!(fe!==0||!Oc(_,q,O))||!(me!==0||!Oc(_,re,O))||!(Ae!==0||!Oc(q,_,re))||!(De!==0||!Oc(q,O,re))}function Oc(_,O,q){return O.x<=Math.max(_.x,q.x)&&O.x>=Math.min(_.x,q.x)&&O.y<=Math.max(_.y,q.y)&&O.y>=Math.min(_.y,q.y)}function Dc(_){return _>0?1:_<0?-1:0}function Zu(_,O){return uo(_.prev,_,_.next)<0?uo(_,O,_.next)>=0&&uo(_,_.prev,O)>=0:uo(_,O,_.prev)<0||uo(_,_.next,O)<0}function rp(_,O){var q=new Xf(_.i,_.x,_.y),re=new Xf(O.i,O.x,O.y),fe=_.next,me=O.prev;return _.next=O,O.prev=_,q.next=fe,fe.prev=q,re.next=q,q.prev=re,me.next=re,re.prev=me,re}function np(_,O,q,re){var fe=new Xf(_,O,q);return re?(fe.next=re.next,fe.prev=re,re.next.prev=fe,re.next=fe):(fe.prev=fe,fe.next=fe),fe}function Ku(_){_.next.prev=_.prev,_.prev.next=_.next,_.prevZ&&(_.prevZ.nextZ=_.nextZ),_.nextZ&&(_.nextZ.prevZ=_.prevZ)}function Xf(_,O,q){this.i=_,this.x=O,this.y=q,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Zf(_,O,q,re){for(var fe=0,me=O,Ae=q-re;me<q;me+=re)fe+=(_[Ae]-_[me])*(_[me+1]+_[Ae+1]),Ae=me;return fe}function T0(_,O,q,re,fe){(function me(Ae,De,Ze,ut,gt){for(;ut>Ze;){if(ut-Ze>600){var Bt=ut-Ze+1,Wt=De-Ze+1,Ht=Math.log(Bt),ar=.5*Math.exp(2*Ht/3),gr=.5*Math.sqrt(Ht*ar*(Bt-ar)/Bt)*(Wt-Bt/2<0?-1:1),Cr=Math.max(Ze,Math.floor(De-Wt*ar/Bt+gr)),Er=Math.min(ut,Math.floor(De+(Bt-Wt)*ar/Bt+gr));me(Ae,De,Cr,Er,gt)}var Fr=Ae[De],Br=Ze,Hr=ut;for(Ju(Ae,Ze,De),gt(Ae[ut],Fr)>0&&Ju(Ae,Ze,ut);Br<Hr;){for(Ju(Ae,Br,Hr),Br++,Hr--;gt(Ae[Br],Fr)<0;)Br++;for(;gt(Ae[Hr],Fr)>0;)Hr--}gt(Ae[Ze],Fr)===0?Ju(Ae,Ze,Hr):(Hr++,Ju(Ae,Hr,ut)),Hr<=De&&(Ze=Hr+1),De<=Hr&&(ut=Hr-1)}})(_,O,q||0,re||_.length-1,fe||k0)}function Ju(_,O,q){var re=_[O];_[O]=_[q],_[q]=re}function k0(_,O){return _<O?-1:_>O?1:0}function Kf(_,O){var q=_.length;if(q<=1)return[_];for(var re,fe,me=[],Ae=0;Ae<q;Ae++){var De=M(_[Ae]);De!==0&&(_[Ae].area=Math.abs(De),fe===void 0&&(fe=De<0),fe===De<0?(re&&me.push(re),re=[_[Ae]]):re.push(_[Ae]))}if(re&&me.push(re),O>1)for(var Ze=0;Ze<me.length;Ze++)me[Ze].length<=O||(T0(me[Ze],O,1,me[Ze].length-1,A0),me[Ze]=me[Ze].slice(0,O));return me}function A0(_,O){return O.area-_.area}function Jf(_,O,q){for(var re=q.patternDependencies,fe=!1,me=0,Ae=O;me<Ae.length;me+=1){var De=Ae[me].paint.get(_+"-pattern");De.isConstant()||(fe=!0);var Ze=De.constantOr(null);Ze&&(fe=!0,re[Ze.to]=!0,re[Ze.from]=!0)}return fe}function $f(_,O,q,re,fe){for(var me=fe.patternDependencies,Ae=0,De=O;Ae<De.length;Ae+=1){var Ze=De[Ae],ut=Ze.paint.get(_+"-pattern").value;if(ut.kind!=="constant"){var gt=ut.evaluate({zoom:re-1},q,{},fe.availableImages),Bt=ut.evaluate({zoom:re},q,{},fe.availableImages),Wt=ut.evaluate({zoom:re+1},q,{},fe.availableImages);gt=gt&&gt.name?gt.name:gt,Bt=Bt&&Bt.name?Bt.name:Bt,Wt=Wt&&Wt.name?Wt.name:Wt,me[gt]=!0,me[Bt]=!0,me[Wt]=!0,q.patterns[Ze.id]={min:gt,mid:Bt,max:Wt}}}return q}Pc.deviation=function(_,O,q,re){var fe=O&&O.length,me=fe?O[0]*q:_.length,Ae=Math.abs(Zf(_,0,me,q));if(fe)for(var De=0,Ze=O.length;De<Ze;De++){var ut=O[De]*q,gt=De<Ze-1?O[De+1]*q:_.length;Ae-=Math.abs(Zf(_,ut,gt,q))}var Bt=0;for(De=0;De<re.length;De+=3){var Wt=re[De]*q,Ht=re[De+1]*q,ar=re[De+2]*q;Bt+=Math.abs((_[Wt]-_[ar])*(_[Ht+1]-_[Wt+1])-(_[Wt]-_[Ht])*(_[ar+1]-_[Wt+1]))}return Ae===0&&Bt===0?0:Math.abs((Bt-Ae)/Ae)},Pc.flatten=function(_){for(var O=_[0][0].length,q={vertices:[],holes:[],dimensions:O},re=0,fe=0;fe<_.length;fe++){for(var me=0;me<_[fe].length;me++)for(var Ae=0;Ae<O;Ae++)q.vertices.push(_[fe][me][Ae]);fe>0&&(re+=_[fe-1].length,q.holes.push(re))}return q},Yf.default=p0;var rl=function(_){this.zoom=_.zoom,this.overscaling=_.overscaling,this.layers=_.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=_.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ss,this.indexArray=new lo,this.indexArray2=new F,this.programConfigurations=new di(Qh,_.layers,_.zoom),this.segments=new Ft,this.segments2=new Ft,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};rl.prototype.populate=function(_,O,q){this.hasPattern=Jf("fill",this.layers,O);for(var re=this.layers[0].layout.get("fill-sort-key"),fe=[],me=0,Ae=_;me<Ae.length;me+=1){var De=Ae[me],Ze=De.feature,ut=De.id,gt=De.index,Bt=De.sourceLayerIndex,Wt=this.layers[0]._featureFilter.needGeometry,Ht={type:Ze.type,id:ut,properties:Ze.properties,geometry:Wt?bi(Ze):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),Ht,q)){Wt||(Ht.geometry=bi(Ze));var ar=re?re.evaluate(Ht,{},q,O.availableImages):void 0,gr={id:ut,properties:Ze.properties,type:Ze.type,sourceLayerIndex:Bt,index:gt,geometry:Ht.geometry,patterns:{},sortKey:ar};fe.push(gr)}}re&&fe.sort(function(qn,na){return qn.sortKey-na.sortKey});for(var Cr=0,Er=fe;Cr<Er.length;Cr+=1){var Fr=Er[Cr],Br=Fr,Hr=Br.geometry,fn=Br.index,xn=Br.sourceLayerIndex;if(this.hasPattern){var Nn=$f("fill",this.layers,Fr,this.zoom,O);this.patternFeatures.push(Nn)}else this.addFeature(Fr,Hr,fn,q,{});var Fn=_[fn].feature;O.featureIndex.insert(Fn,Hr,fn,xn,this.index)}},rl.prototype.update=function(_,O,q){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(_,O,this.stateDependentLayers,q)},rl.prototype.addFeatures=function(_,O,q){for(var re=0,fe=this.patternFeatures;re<fe.length;re+=1){var me=fe[re];this.addFeature(me,me.geometry,me.index,O,q)}},rl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},rl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},rl.prototype.upload=function(_){this.uploaded||(this.layoutVertexBuffer=_.createVertexBuffer(this.layoutVertexArray,Qh),this.indexBuffer=_.createIndexBuffer(this.indexArray),this.indexBuffer2=_.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(_),this.uploaded=!0},rl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},rl.prototype.addFeature=function(_,O,q,re,fe){for(var me=0,Ae=Kf(O,500);me<Ae.length;me+=1){for(var De=Ae[me],Ze=0,ut=0,gt=De;ut<gt.length;ut+=1)Ze+=gt[ut].length;for(var Bt=this.segments.prepareSegment(Ze,this.layoutVertexArray,this.indexArray),Wt=Bt.vertexLength,Ht=[],ar=[],gr=0,Cr=De;gr<Cr.length;gr+=1){var Er=Cr[gr];if(Er.length!==0){Er!==De[0]&&ar.push(Ht.length/2);var Fr=this.segments2.prepareSegment(Er.length,this.layoutVertexArray,this.indexArray2),Br=Fr.vertexLength;this.layoutVertexArray.emplaceBack(Er[0].x,Er[0].y),this.indexArray2.emplaceBack(Br+Er.length-1,Br),Ht.push(Er[0].x),Ht.push(Er[0].y);for(var Hr=1;Hr<Er.length;Hr++)this.layoutVertexArray.emplaceBack(Er[Hr].x,Er[Hr].y),this.indexArray2.emplaceBack(Br+Hr-1,Br+Hr),Ht.push(Er[Hr].x),Ht.push(Er[Hr].y);Fr.vertexLength+=Er.length,Fr.primitiveLength+=Er.length}}for(var fn=Yf(Ht,ar),xn=0;xn<fn.length;xn+=3)this.indexArray.emplaceBack(Wt+fn[xn],Wt+fn[xn+1],Wt+fn[xn+2]);Bt.vertexLength+=Ze,Bt.primitiveLength+=fn.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,_,q,fe,re)},Xr("FillBucket",rl,{omit:["layers","patternFeatures"]});var M0=new Go({"fill-sort-key":new ya(Pe.layout_fill["fill-sort-key"])}),S0={paint:new Go({"fill-antialias":new la(Pe.paint_fill["fill-antialias"]),"fill-opacity":new ya(Pe.paint_fill["fill-opacity"]),"fill-color":new ya(Pe.paint_fill["fill-color"]),"fill-outline-color":new ya(Pe.paint_fill["fill-outline-color"]),"fill-translate":new la(Pe.paint_fill["fill-translate"]),"fill-translate-anchor":new la(Pe.paint_fill["fill-translate-anchor"]),"fill-pattern":new ml(Pe.paint_fill["fill-pattern"])}),layout:M0},E0=function(_){function O(q){_.call(this,q,S0)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.recalculate=function(q,re){_.prototype.recalculate.call(this,q,re);var fe=this.paint._values["fill-outline-color"];fe.value.kind==="constant"&&fe.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},O.prototype.createBucket=function(q){return new rl(q)},O.prototype.queryRadius=function(){return qo(this.paint.get("fill-translate"))},O.prototype.queryIntersectsFeature=function(q,re,fe,me,Ae,De,Ze){return yl(Yo(q,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),De.angle,Ze),me)},O.prototype.isTileClipped=function(){return!0},O}(is),ap=oi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,ip=vu;function vu(_,O,q,re,fe){this.properties={},this.extent=q,this.type=0,this._pbf=_,this._geometry=-1,this._keys=re,this._values=fe,_.readFields(C0,this,O)}function C0(_,O,q){_==1?O.id=q.readVarint():_==2?function(re,fe){for(var me=re.readVarint()+re.pos;re.pos<me;){var Ae=fe._keys[re.readVarint()],De=fe._values[re.readVarint()];fe.properties[Ae]=De}}(q,O):_==3?O.type=q.readVarint():_==4&&(O._geometry=q.pos)}function L0(_){for(var O,q,re=0,fe=0,me=_.length,Ae=me-1;fe<me;Ae=fe++)O=_[fe],re+=((q=_[Ae]).x-O.x)*(O.y+q.y);return re}vu.types=["Unknown","Point","LineString","Polygon"],vu.prototype.loadGeometry=function(){var _=this._pbf;_.pos=this._geometry;for(var O,q=_.readVarint()+_.pos,re=1,fe=0,me=0,Ae=0,De=[];_.pos<q;){if(fe<=0){var Ze=_.readVarint();re=7&Ze,fe=Ze>>3}if(fe--,re===1||re===2)me+=_.readSVarint(),Ae+=_.readSVarint(),re===1&&(O&&De.push(O),O=[]),O.push(new u(me,Ae));else{if(re!==7)throw new Error("unknown command "+re);O&&O.push(O[0].clone())}}return O&&De.push(O),De},vu.prototype.bbox=function(){var _=this._pbf;_.pos=this._geometry;for(var O=_.readVarint()+_.pos,q=1,re=0,fe=0,me=0,Ae=1/0,De=-1/0,Ze=1/0,ut=-1/0;_.pos<O;){if(re<=0){var gt=_.readVarint();q=7&gt,re=gt>>3}if(re--,q===1||q===2)(fe+=_.readSVarint())<Ae&&(Ae=fe),fe>De&&(De=fe),(me+=_.readSVarint())<Ze&&(Ze=me),me>ut&&(ut=me);else if(q!==7)throw new Error("unknown command "+q)}return[Ae,Ze,De,ut]},vu.prototype.toGeoJSON=function(_,O,q){var re,fe,me=this.extent*Math.pow(2,q),Ae=this.extent*_,De=this.extent*O,Ze=this.loadGeometry(),ut=vu.types[this.type];function gt(Ht){for(var ar=0;ar<Ht.length;ar++){var gr=Ht[ar],Cr=180-360*(gr.y+De)/me;Ht[ar]=[360*(gr.x+Ae)/me-180,360/Math.PI*Math.atan(Math.exp(Cr*Math.PI/180))-90]}}switch(this.type){case 1:var Bt=[];for(re=0;re<Ze.length;re++)Bt[re]=Ze[re][0];gt(Ze=Bt);break;case 2:for(re=0;re<Ze.length;re++)gt(Ze[re]);break;case 3:for(Ze=function(Ht){var ar=Ht.length;if(ar<=1)return[Ht];for(var gr,Cr,Er=[],Fr=0;Fr<ar;Fr++){var Br=L0(Ht[Fr]);Br!==0&&(Cr===void 0&&(Cr=Br<0),Cr===Br<0?(gr&&Er.push(gr),gr=[Ht[Fr]]):gr.push(Ht[Fr]))}return gr&&Er.push(gr),Er}(Ze),re=0;re<Ze.length;re++)for(fe=0;fe<Ze[re].length;fe++)gt(Ze[re][fe])}Ze.length===1?Ze=Ze[0]:ut="Multi"+ut;var Wt={type:"Feature",geometry:{type:ut,coordinates:Ze},properties:this.properties};return"id"in this&&(Wt.id=this.id),Wt};var op=sp;function sp(_,O){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=_,this._keys=[],this._values=[],this._features=[],_.readFields(P0,this,O),this.length=this._features.length}function P0(_,O,q){_===15?O.version=q.readVarint():_===1?O.name=q.readString():_===5?O.extent=q.readVarint():_===2?O._features.push(q.pos):_===3?O._keys.push(q.readString()):_===4&&O._values.push(function(re){for(var fe=null,me=re.readVarint()+re.pos;re.pos<me;){var Ae=re.readVarint()>>3;fe=Ae===1?re.readString():Ae===2?re.readFloat():Ae===3?re.readDouble():Ae===4?re.readVarint64():Ae===5?re.readVarint():Ae===6?re.readSVarint():Ae===7?re.readBoolean():null}return fe}(q))}function I0(_,O,q){if(_===3){var re=new op(q,q.readVarint()+q.pos);re.length&&(O[re.name]=re)}}sp.prototype.feature=function(_){if(_<0||_>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[_];var O=this._pbf.readVarint()+this._pbf.pos;return new ip(this._pbf,O,this.extent,this._keys,this._values)};var yu={VectorTile:function(_,O){this.layers=_.readFields(I0,{},O)},VectorTileFeature:ip,VectorTileLayer:op},O0=yu.VectorTileFeature.types,Qf=Math.pow(2,13);function $u(_,O,q,re,fe,me,Ae,De){_.emplaceBack(O,q,2*Math.floor(re*Qf)+Ae,fe*Qf*2,me*Qf*2,Math.round(De))}var nl=function(_){this.zoom=_.zoom,this.overscaling=_.overscaling,this.layers=_.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=_.index,this.hasPattern=!1,this.layoutVertexArray=new Fs,this.indexArray=new lo,this.programConfigurations=new di(ap,_.layers,_.zoom),this.segments=new Ft,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};function D0(_,O){return _.x===O.x&&(_.x<0||_.x>8192)||_.y===O.y&&(_.y<0||_.y>8192)}function z0(_){return _.every(function(O){return O.x<0})||_.every(function(O){return O.x>8192})||_.every(function(O){return O.y<0})||_.every(function(O){return O.y>8192})}nl.prototype.populate=function(_,O,q){this.features=[],this.hasPattern=Jf("fill-extrusion",this.layers,O);for(var re=0,fe=_;re<fe.length;re+=1){var me=fe[re],Ae=me.feature,De=me.id,Ze=me.index,ut=me.sourceLayerIndex,gt=this.layers[0]._featureFilter.needGeometry,Bt={type:Ae.type,id:De,properties:Ae.properties,geometry:gt?bi(Ae):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),Bt,q)){var Wt={id:De,sourceLayerIndex:ut,index:Ze,geometry:gt?Bt.geometry:bi(Ae),properties:Ae.properties,type:Ae.type,patterns:{}};Ae.id!==void 0&&(Wt.id=Ae.id),this.hasPattern?this.features.push($f("fill-extrusion",this.layers,Wt,this.zoom,O)):this.addFeature(Wt,Wt.geometry,Ze,q,{}),O.featureIndex.insert(Ae,Wt.geometry,Ze,ut,this.index,!0)}}},nl.prototype.addFeatures=function(_,O,q){for(var re=0,fe=this.features;re<fe.length;re+=1){var me=fe[re],Ae=me.geometry;this.addFeature(me,Ae,me.index,O,q)}},nl.prototype.update=function(_,O,q){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(_,O,this.stateDependentLayers,q)},nl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},nl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},nl.prototype.upload=function(_){this.uploaded||(this.layoutVertexBuffer=_.createVertexBuffer(this.layoutVertexArray,ap),this.indexBuffer=_.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(_),this.uploaded=!0},nl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},nl.prototype.addFeature=function(_,O,q,re,fe){for(var me=0,Ae=Kf(O,500);me<Ae.length;me+=1){for(var De=Ae[me],Ze=0,ut=0,gt=De;ut<gt.length;ut+=1)Ze+=gt[ut].length;for(var Bt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Wt=0,Ht=De;Wt<Ht.length;Wt+=1){var ar=Ht[Wt];if(ar.length!==0&&!z0(ar))for(var gr=0,Cr=0;Cr<ar.length;Cr++){var Er=ar[Cr];if(Cr>=1){var Fr=ar[Cr-1];if(!D0(Er,Fr)){Bt.vertexLength+4>Ft.MAX_VERTEX_ARRAY_LENGTH&&(Bt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Br=Er.sub(Fr)._perp()._unit(),Hr=Fr.dist(Er);gr+Hr>32768&&(gr=0),$u(this.layoutVertexArray,Er.x,Er.y,Br.x,Br.y,0,0,gr),$u(this.layoutVertexArray,Er.x,Er.y,Br.x,Br.y,0,1,gr),gr+=Hr,$u(this.layoutVertexArray,Fr.x,Fr.y,Br.x,Br.y,0,0,gr),$u(this.layoutVertexArray,Fr.x,Fr.y,Br.x,Br.y,0,1,gr);var fn=Bt.vertexLength;this.indexArray.emplaceBack(fn,fn+2,fn+1),this.indexArray.emplaceBack(fn+1,fn+2,fn+3),Bt.vertexLength+=4,Bt.primitiveLength+=2}}}}if(Bt.vertexLength+Ze>Ft.MAX_VERTEX_ARRAY_LENGTH&&(Bt=this.segments.prepareSegment(Ze,this.layoutVertexArray,this.indexArray)),O0[_.type]==="Polygon"){for(var xn=[],Nn=[],Fn=Bt.vertexLength,qn=0,na=De;qn<na.length;qn+=1){var ia=na[qn];if(ia.length!==0){ia!==De[0]&&Nn.push(xn.length/2);for(var Zn=0;Zn<ia.length;Zn++){var ha=ia[Zn];$u(this.layoutVertexArray,ha.x,ha.y,0,0,1,1,0),xn.push(ha.x),xn.push(ha.y)}}}for(var ca=Yf(xn,Nn),oa=0;oa<ca.length;oa+=3)this.indexArray.emplaceBack(Fn+ca[oa],Fn+ca[oa+2],Fn+ca[oa+1]);Bt.primitiveLength+=ca.length/3,Bt.vertexLength+=Ze}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,_,q,fe,re)},Xr("FillExtrusionBucket",nl,{omit:["layers","features"]});var R0={paint:new Go({"fill-extrusion-opacity":new la(Pe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ya(Pe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new la(Pe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new la(Pe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ml(Pe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ya(Pe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ya(Pe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new la(Pe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},F0=function(_){function O(q){_.call(this,q,R0)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.createBucket=function(q){return new nl(q)},O.prototype.queryRadius=function(){return qo(this.paint.get("fill-extrusion-translate"))},O.prototype.is3D=function(){return!0},O.prototype.queryIntersectsFeature=function(q,re,fe,me,Ae,De,Ze,ut){var gt=Yo(q,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),De.angle,Ze),Bt=this.paint.get("fill-extrusion-height").evaluate(re,fe),Wt=this.paint.get("fill-extrusion-base").evaluate(re,fe),Ht=function(gr,Cr,Er,Fr){for(var Br=[],Hr=0,fn=gr;Hr<fn.length;Hr+=1){var xn=fn[Hr],Nn=[xn.x,xn.y,Fr,1];gu(Nn,Nn,Cr),Br.push(new u(Nn[0]/Nn[3],Nn[1]/Nn[3]))}return Br}(gt,ut,0,0),ar=function(gr,Cr,Er,Fr){for(var Br=[],Hr=[],fn=Fr[8]*Cr,xn=Fr[9]*Cr,Nn=Fr[10]*Cr,Fn=Fr[11]*Cr,qn=Fr[8]*Er,na=Fr[9]*Er,ia=Fr[10]*Er,Zn=Fr[11]*Er,ha=0,ca=gr;ha<ca.length;ha+=1){for(var oa=ca[ha],$a=[],Va=[],ri=0,_a=oa;ri<_a.length;ri+=1){var Ya=_a[ri],wi=Ya.x,gi=Ya.y,Ii=Fr[0]*wi+Fr[4]*gi+Fr[12],mi=Fr[1]*wi+Fr[5]*gi+Fr[13],ho=Fr[2]*wi+Fr[6]*gi+Fr[14],Oi=Fr[3]*wi+Fr[7]*gi+Fr[15],Wo=ho+Nn,Oo=Oi+Fn,Ro=Ii+qn,os=mi+na,Jo=ho+ia,po=Oi+Zn,Fo=new u((Ii+fn)/Oo,(mi+xn)/Oo);Fo.z=Wo/Oo,$a.push(Fo);var eo=new u(Ro/po,os/po);eo.z=Jo/po,Va.push(eo)}Br.push($a),Hr.push(Va)}return[Br,Hr]}(me,Wt,Bt,ut);return function(gr,Cr,Er){var Fr=1/0;yl(Er,Cr)&&(Fr=lp(Er,Cr[0]));for(var Br=0;Br<Cr.length;Br++)for(var Hr=Cr[Br],fn=gr[Br],xn=0;xn<Hr.length-1;xn++){var Nn=Hr[xn],Fn=Hr[xn+1],qn=fn[xn],na=fn[xn+1],ia=[Nn,Fn,na,qn,Nn];Zo(Er,ia)&&(Fr=Math.min(Fr,lp(Er,ia)))}return Fr!==1/0&&Fr}(ar[0],ar[1],Ht)},O}(is);function Qu(_,O){return _.x*O.x+_.y*O.y}function lp(_,O){if(_.length===1){for(var q,re=0,fe=O[re++];!q||fe.equals(q);)if(!(q=O[re++]))return 1/0;for(;re<O.length;re++){var me=O[re],Ae=_[0],De=q.sub(fe),Ze=me.sub(fe),ut=Ae.sub(fe),gt=Qu(De,De),Bt=Qu(De,Ze),Wt=Qu(Ze,Ze),Ht=Qu(ut,De),ar=Qu(ut,Ze),gr=gt*Wt-Bt*Bt,Cr=(Wt*Ht-Bt*ar)/gr,Er=(gt*ar-Bt*Ht)/gr,Fr=1-Cr-Er,Br=fe.z*Fr+q.z*Cr+me.z*Er;if(isFinite(Br))return Br}return 1/0}for(var Hr=1/0,fn=0,xn=O;fn<xn.length;fn+=1){var Nn=xn[fn];Hr=Math.min(Hr,Nn.z)}return Hr}var up=oi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,B0=yu.VectorTileFeature.types,N0=Math.cos(Math.PI/180*37.5),cp=Math.pow(2,14)/.5,ps=function(_){this.zoom=_.zoom,this.overscaling=_.overscaling,this.layers=_.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=_.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Qs,this.indexArray=new lo,this.programConfigurations=new di(up,_.layers,_.zoom),this.segments=new Ft,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};ps.prototype.populate=function(_,O,q){this.hasPattern=Jf("line",this.layers,O);for(var re=this.layers[0].layout.get("line-sort-key"),fe=[],me=0,Ae=_;me<Ae.length;me+=1){var De=Ae[me],Ze=De.feature,ut=De.id,gt=De.index,Bt=De.sourceLayerIndex,Wt=this.layers[0]._featureFilter.needGeometry,Ht={type:Ze.type,id:ut,properties:Ze.properties,geometry:Wt?bi(Ze):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),Ht,q)){Wt||(Ht.geometry=bi(Ze));var ar=re?re.evaluate(Ht,{},q):void 0,gr={id:ut,properties:Ze.properties,type:Ze.type,sourceLayerIndex:Bt,index:gt,geometry:Ht.geometry,patterns:{},sortKey:ar};fe.push(gr)}}re&&fe.sort(function(qn,na){return qn.sortKey-na.sortKey});for(var Cr=0,Er=fe;Cr<Er.length;Cr+=1){var Fr=Er[Cr],Br=Fr,Hr=Br.geometry,fn=Br.index,xn=Br.sourceLayerIndex;if(this.hasPattern){var Nn=$f("line",this.layers,Fr,this.zoom,O);this.patternFeatures.push(Nn)}else this.addFeature(Fr,Hr,fn,q,{});var Fn=_[fn].feature;O.featureIndex.insert(Fn,Hr,fn,xn,this.index)}},ps.prototype.update=function(_,O,q){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(_,O,this.stateDependentLayers,q)},ps.prototype.addFeatures=function(_,O,q){for(var re=0,fe=this.patternFeatures;re<fe.length;re+=1){var me=fe[re];this.addFeature(me,me.geometry,me.index,O,q)}},ps.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ps.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ps.prototype.upload=function(_){this.uploaded||(this.layoutVertexBuffer=_.createVertexBuffer(this.layoutVertexArray,up),this.indexBuffer=_.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(_),this.uploaded=!0},ps.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ps.prototype.addFeature=function(_,O,q,re,fe){for(var me=this.layers[0].layout,Ae=me.get("line-join").evaluate(_,{}),De=me.get("line-cap"),Ze=me.get("line-miter-limit"),ut=me.get("line-round-limit"),gt=0,Bt=O;gt<Bt.length;gt+=1){var Wt=Bt[gt];this.addLine(Wt,_,Ae,De,Ze,ut)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,_,q,fe,re)},ps.prototype.addLine=function(_,O,q,re,fe,me){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,O.properties&&O.properties.hasOwnProperty("mapbox_clip_start")&&O.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+O.properties.mapbox_clip_start,this.clipEnd=+O.properties.mapbox_clip_end;for(var Ae=0;Ae<_.length-1;Ae++)this.totalDistance+=_[Ae].dist(_[Ae+1]);this.updateScaledDistance()}for(var De=B0[O.type]==="Polygon",Ze=_.length;Ze>=2&&_[Ze-1].equals(_[Ze-2]);)Ze--;for(var ut=0;ut<Ze-1&&_[ut].equals(_[ut+1]);)ut++;if(!(Ze<(De?3:2))){q==="bevel"&&(fe=1.05);var gt,Bt=this.overscaling<=16?122880/(512*this.overscaling):0,Wt=this.segments.prepareSegment(10*Ze,this.layoutVertexArray,this.indexArray),Ht=void 0,ar=void 0,gr=void 0,Cr=void 0;this.e1=this.e2=-1,De&&(gt=_[Ze-2],Cr=_[ut].sub(gt)._unit()._perp());for(var Er=ut;Er<Ze;Er++)if(!(ar=Er===Ze-1?De?_[ut+1]:void 0:_[Er+1])||!_[Er].equals(ar)){Cr&&(gr=Cr),gt&&(Ht=gt),gt=_[Er],Cr=ar?ar.sub(gt)._unit()._perp():gr;var Fr=(gr=gr||Cr).add(Cr);Fr.x===0&&Fr.y===0||Fr._unit();var Br=gr.x*Cr.x+gr.y*Cr.y,Hr=Fr.x*Cr.x+Fr.y*Cr.y,fn=Hr!==0?1/Hr:1/0,xn=2*Math.sqrt(2-2*Hr),Nn=Hr<N0&&Ht&&ar,Fn=gr.x*Cr.y-gr.y*Cr.x>0;if(Nn&&Er>ut){var qn=gt.dist(Ht);if(qn>2*Bt){var na=gt.sub(gt.sub(Ht)._mult(Bt/qn)._round());this.updateDistance(Ht,na),this.addCurrentVertex(na,gr,0,0,Wt),Ht=na}}var ia=Ht&&ar,Zn=ia?q:De?"butt":re;if(ia&&Zn==="round"&&(fn<me?Zn="miter":fn<=2&&(Zn="fakeround")),Zn==="miter"&&fn>fe&&(Zn="bevel"),Zn==="bevel"&&(fn>2&&(Zn="flipbevel"),fn<fe&&(Zn="miter")),Ht&&this.updateDistance(Ht,gt),Zn==="miter")Fr._mult(fn),this.addCurrentVertex(gt,Fr,0,0,Wt);else if(Zn==="flipbevel"){if(fn>100)Fr=Cr.mult(-1);else{var ha=fn*gr.add(Cr).mag()/gr.sub(Cr).mag();Fr._perp()._mult(ha*(Fn?-1:1))}this.addCurrentVertex(gt,Fr,0,0,Wt),this.addCurrentVertex(gt,Fr.mult(-1),0,0,Wt)}else if(Zn==="bevel"||Zn==="fakeround"){var ca=-Math.sqrt(fn*fn-1),oa=Fn?ca:0,$a=Fn?0:ca;if(Ht&&this.addCurrentVertex(gt,gr,oa,$a,Wt),Zn==="fakeround")for(var Va=Math.round(180*xn/Math.PI/20),ri=1;ri<Va;ri++){var _a=ri/Va;if(_a!==.5){var Ya=_a-.5;_a+=_a*Ya*(_a-1)*((1.0904+Br*(Br*(3.55645-1.43519*Br)-3.2452))*Ya*Ya+(.848013+Br*(.215638*Br-1.06021)))}var wi=Cr.sub(gr)._mult(_a)._add(gr)._unit()._mult(Fn?-1:1);this.addHalfVertex(gt,wi.x,wi.y,!1,Fn,0,Wt)}ar&&this.addCurrentVertex(gt,Cr,-oa,-$a,Wt)}else if(Zn==="butt")this.addCurrentVertex(gt,Fr,0,0,Wt);else if(Zn==="square"){var gi=Ht?1:-1;this.addCurrentVertex(gt,Fr,gi,gi,Wt)}else Zn==="round"&&(Ht&&(this.addCurrentVertex(gt,gr,0,0,Wt),this.addCurrentVertex(gt,gr,1,1,Wt,!0)),ar&&(this.addCurrentVertex(gt,Cr,-1,-1,Wt,!0),this.addCurrentVertex(gt,Cr,0,0,Wt)));if(Nn&&Er<Ze-1){var Ii=gt.dist(ar);if(Ii>2*Bt){var mi=gt.add(ar.sub(gt)._mult(Bt/Ii)._round());this.updateDistance(gt,mi),this.addCurrentVertex(mi,Cr,0,0,Wt),gt=mi}}}}},ps.prototype.addCurrentVertex=function(_,O,q,re,fe,me){me===void 0&&(me=!1);var Ae=O.x+O.y*q,De=O.y-O.x*q,Ze=-O.x+O.y*re,ut=-O.y-O.x*re;this.addHalfVertex(_,Ae,De,me,!1,q,fe),this.addHalfVertex(_,Ze,ut,me,!0,-re,fe),this.distance>cp/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(_,O,q,re,fe,me))},ps.prototype.addHalfVertex=function(_,O,q,re,fe,me,Ae){var De=_.x,Ze=_.y,ut=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((De<<1)+(re?1:0),(Ze<<1)+(fe?1:0),Math.round(63*O)+128,Math.round(63*q)+128,1+(me===0?0:me<0?-1:1)|(63&ut)<<2,ut>>6);var gt=Ae.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,gt),Ae.primitiveLength++),fe?this.e2=gt:this.e1=gt},ps.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(cp-1):this.distance},ps.prototype.updateDistance=function(_,O){this.distance+=_.dist(O),this.updateScaledDistance()},Xr("LineBucket",ps,{omit:["layers","patternFeatures"]});var j0=new Go({"line-cap":new la(Pe.layout_line["line-cap"]),"line-join":new ya(Pe.layout_line["line-join"]),"line-miter-limit":new la(Pe.layout_line["line-miter-limit"]),"line-round-limit":new la(Pe.layout_line["line-round-limit"]),"line-sort-key":new ya(Pe.layout_line["line-sort-key"])}),fp={paint:new Go({"line-opacity":new ya(Pe.paint_line["line-opacity"]),"line-color":new ya(Pe.paint_line["line-color"]),"line-translate":new la(Pe.paint_line["line-translate"]),"line-translate-anchor":new la(Pe.paint_line["line-translate-anchor"]),"line-width":new ya(Pe.paint_line["line-width"]),"line-gap-width":new ya(Pe.paint_line["line-gap-width"]),"line-offset":new ya(Pe.paint_line["line-offset"]),"line-blur":new ya(Pe.paint_line["line-blur"]),"line-dasharray":new vl(Pe.paint_line["line-dasharray"]),"line-pattern":new ml(Pe.paint_line["line-pattern"]),"line-gradient":new bs(Pe.paint_line["line-gradient"])}),layout:j0},hp=new(function(_){function O(){_.apply(this,arguments)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.possiblyEvaluate=function(q,re){return re=new ii(Math.floor(re.zoom),{now:re.now,fadeDuration:re.fadeDuration,zoomHistory:re.zoomHistory,transition:re.transition}),_.prototype.possiblyEvaluate.call(this,q,re)},O.prototype.evaluate=function(q,re,fe,me){return re=g({},re,{zoom:Math.floor(re.zoom)}),_.prototype.evaluate.call(this,q,re,fe,me)},O}(ya))(fp.paint.properties["line-width"].specification);hp.useIntegerZoom=!0;var U0=function(_){function O(q){_.call(this,q,fp)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype._handleSpecialPaintPropertyUpdate=function(q){q==="line-gradient"&&this._updateGradient()},O.prototype._updateGradient=function(){var q=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=$h(q,"lineProgress"),this.gradientTexture=null},O.prototype.recalculate=function(q,re){_.prototype.recalculate.call(this,q,re),this.paint._values["line-floorwidth"]=hp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,q)},O.prototype.createBucket=function(q){return new ps(q)},O.prototype.queryRadius=function(q){var re=q,fe=pp(Li("line-width",this,re),Li("line-gap-width",this,re)),me=Li("line-offset",this,re);return fe/2+Math.abs(me)+qo(this.paint.get("line-translate"))},O.prototype.queryIntersectsFeature=function(q,re,fe,me,Ae,De,Ze){var ut=Yo(q,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),De.angle,Ze),gt=Ze/2*pp(this.paint.get("line-width").evaluate(re,fe),this.paint.get("line-gap-width").evaluate(re,fe)),Bt=this.paint.get("line-offset").evaluate(re,fe);return Bt&&(me=function(Wt,Ht){for(var ar=[],gr=new u(0,0),Cr=0;Cr<Wt.length;Cr++){for(var Er=Wt[Cr],Fr=[],Br=0;Br<Er.length;Br++){var Hr=Er[Br-1],fn=Er[Br],xn=Er[Br+1],Nn=Br===0?gr:fn.sub(Hr)._unit()._perp(),Fn=Br===Er.length-1?gr:xn.sub(fn)._unit()._perp(),qn=Nn._add(Fn)._unit(),na=qn.x*Fn.x+qn.y*Fn.y;qn._mult(1/na),Fr.push(qn._mult(Ht)._add(fn))}ar.push(Fr)}return ar}(me,Bt*Ze)),function(Wt,Ht,ar){for(var gr=0;gr<Ht.length;gr++){var Cr=Ht[gr];if(Wt.length>=3){for(var Er=0;Er<Cr.length;Er++)if(_s(Wt,Cr[Er]))return!0}if(Jl(Wt,Cr,ar))return!0}return!1}(ut,me,gt)},O.prototype.isTileClipped=function(){return!0},O}(is);function pp(_,O){return O>0?O+2*_:_}var eh=oi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),V0=oi([{name:"a_projected_pos",components:3,type:"Float32"}],4),H0=(oi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),oi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),dp=(oi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),oi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),G0=oi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);oi([{name:"triangle",components:3,type:"Uint16"}]),oi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),oi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),oi([{type:"Float32",name:"offsetX"}]),oi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function q0(_,O,q){return _.sections.forEach(function(re){re.text=function(fe,me,Ae){var De=me.layout.get("text-transform").evaluate(Ae,{});return De==="uppercase"?fe=fe.toLocaleUpperCase():De==="lowercase"&&(fe=fe.toLocaleLowerCase()),yo.applyArabicShaping&&(fe=yo.applyArabicShaping(fe)),fe}(re.text,O,q)}),_}var ec={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},gp=function(_,O,q,re,fe){var me,Ae,De=8*fe-re-1,Ze=(1<<De)-1,ut=Ze>>1,gt=-7,Bt=q?fe-1:0,Wt=q?-1:1,Ht=_[O+Bt];for(Bt+=Wt,me=Ht&(1<<-gt)-1,Ht>>=-gt,gt+=De;gt>0;me=256*me+_[O+Bt],Bt+=Wt,gt-=8);for(Ae=me&(1<<-gt)-1,me>>=-gt,gt+=re;gt>0;Ae=256*Ae+_[O+Bt],Bt+=Wt,gt-=8);if(me===0)me=1-ut;else{if(me===Ze)return Ae?NaN:1/0*(Ht?-1:1);Ae+=Math.pow(2,re),me-=ut}return(Ht?-1:1)*Ae*Math.pow(2,me-re)},mp=function(_,O,q,re,fe,me){var Ae,De,Ze,ut=8*me-fe-1,gt=(1<<ut)-1,Bt=gt>>1,Wt=fe===23?Math.pow(2,-24)-Math.pow(2,-77):0,Ht=re?0:me-1,ar=re?1:-1,gr=O<0||O===0&&1/O<0?1:0;for(O=Math.abs(O),isNaN(O)||O===1/0?(De=isNaN(O)?1:0,Ae=gt):(Ae=Math.floor(Math.log(O)/Math.LN2),O*(Ze=Math.pow(2,-Ae))<1&&(Ae--,Ze*=2),(O+=Ae+Bt>=1?Wt/Ze:Wt*Math.pow(2,1-Bt))*Ze>=2&&(Ae++,Ze/=2),Ae+Bt>=gt?(De=0,Ae=gt):Ae+Bt>=1?(De=(O*Ze-1)*Math.pow(2,fe),Ae+=Bt):(De=O*Math.pow(2,Bt-1)*Math.pow(2,fe),Ae=0));fe>=8;_[q+Ht]=255&De,Ht+=ar,De/=256,fe-=8);for(Ae=Ae<<fe|De,ut+=fe;ut>0;_[q+Ht]=255&Ae,Ht+=ar,Ae/=256,ut-=8);_[q+Ht-ar]|=128*gr},zc=_i;function _i(_){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(_)?_:new Uint8Array(_||0),this.pos=0,this.type=0,this.length=this.buf.length}_i.Varint=0,_i.Fixed64=1,_i.Bytes=2,_i.Fixed32=5;var vp=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Al(_){return _.type===_i.Bytes?_.readVarint()+_.pos:_.pos+1}function xu(_,O,q){return q?4294967296*O+(_>>>0):4294967296*(O>>>0)+(_>>>0)}function yp(_,O,q){var re=O<=16383?1:O<=2097151?2:O<=268435455?3:Math.floor(Math.log(O)/(7*Math.LN2));q.realloc(re);for(var fe=q.pos-1;fe>=_;fe--)q.buf[fe+re]=q.buf[fe]}function Y0(_,O){for(var q=0;q<_.length;q++)O.writeVarint(_[q])}function W0(_,O){for(var q=0;q<_.length;q++)O.writeSVarint(_[q])}function X0(_,O){for(var q=0;q<_.length;q++)O.writeFloat(_[q])}function Z0(_,O){for(var q=0;q<_.length;q++)O.writeDouble(_[q])}function K0(_,O){for(var q=0;q<_.length;q++)O.writeBoolean(_[q])}function J0(_,O){for(var q=0;q<_.length;q++)O.writeFixed32(_[q])}function $0(_,O){for(var q=0;q<_.length;q++)O.writeSFixed32(_[q])}function Q0(_,O){for(var q=0;q<_.length;q++)O.writeFixed64(_[q])}function eg(_,O){for(var q=0;q<_.length;q++)O.writeSFixed64(_[q])}function Rc(_,O){return(_[O]|_[O+1]<<8|_[O+2]<<16)+16777216*_[O+3]}function bu(_,O,q){_[q]=O,_[q+1]=O>>>8,_[q+2]=O>>>16,_[q+3]=O>>>24}function xp(_,O){return(_[O]|_[O+1]<<8|_[O+2]<<16)+(_[O+3]<<24)}_i.prototype={destroy:function(){this.buf=null},readFields:function(_,O,q){for(q=q||this.length;this.pos<q;){var re=this.readVarint(),fe=re>>3,me=this.pos;this.type=7&re,_(fe,O,this),this.pos===me&&this.skip(re)}return O},readMessage:function(_,O){return this.readFields(_,O,this.readVarint()+this.pos)},readFixed32:function(){var _=Rc(this.buf,this.pos);return this.pos+=4,_},readSFixed32:function(){var _=xp(this.buf,this.pos);return this.pos+=4,_},readFixed64:function(){var _=Rc(this.buf,this.pos)+4294967296*Rc(this.buf,this.pos+4);return this.pos+=8,_},readSFixed64:function(){var _=Rc(this.buf,this.pos)+4294967296*xp(this.buf,this.pos+4);return this.pos+=8,_},readFloat:function(){var _=gp(this.buf,this.pos,!0,23,4);return this.pos+=4,_},readDouble:function(){var _=gp(this.buf,this.pos,!0,52,8);return this.pos+=8,_},readVarint:function(_){var O,q,re=this.buf;return O=127&(q=re[this.pos++]),q<128?O:(O|=(127&(q=re[this.pos++]))<<7,q<128?O:(O|=(127&(q=re[this.pos++]))<<14,q<128?O:(O|=(127&(q=re[this.pos++]))<<21,q<128?O:function(fe,me,Ae){var De,Ze,ut=Ae.buf;if(Ze=ut[Ae.pos++],De=(112&Ze)>>4,Ze<128||(Ze=ut[Ae.pos++],De|=(127&Ze)<<3,Ze<128)||(Ze=ut[Ae.pos++],De|=(127&Ze)<<10,Ze<128)||(Ze=ut[Ae.pos++],De|=(127&Ze)<<17,Ze<128)||(Ze=ut[Ae.pos++],De|=(127&Ze)<<24,Ze<128)||(Ze=ut[Ae.pos++],De|=(1&Ze)<<31,Ze<128))return xu(fe,De,me);throw new Error("Expected varint not more than 10 bytes")}(O|=(15&(q=re[this.pos]))<<28,_,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var _=this.readVarint();return _%2==1?(_+1)/-2:_/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var _=this.readVarint()+this.pos,O=this.pos;return this.pos=_,_-O>=12&&vp?function(q,re,fe){return vp.decode(q.subarray(re,fe))}(this.buf,O,_):function(q,re,fe){for(var me="",Ae=re;Ae<fe;){var De,Ze,ut,gt=q[Ae],Bt=null,Wt=gt>239?4:gt>223?3:gt>191?2:1;if(Ae+Wt>fe)break;Wt===1?gt<128&&(Bt=gt):Wt===2?(192&(De=q[Ae+1]))==128&&(Bt=(31&gt)<<6|63&De)<=127&&(Bt=null):Wt===3?(De=q[Ae+1],Ze=q[Ae+2],(192&De)==128&&(192&Ze)==128&&((Bt=(15&gt)<<12|(63&De)<<6|63&Ze)<=2047||Bt>=55296&&Bt<=57343)&&(Bt=null)):Wt===4&&(De=q[Ae+1],Ze=q[Ae+2],ut=q[Ae+3],(192&De)==128&&(192&Ze)==128&&(192&ut)==128&&((Bt=(15&gt)<<18|(63&De)<<12|(63&Ze)<<6|63&ut)<=65535||Bt>=1114112)&&(Bt=null)),Bt===null?(Bt=65533,Wt=1):Bt>65535&&(Bt-=65536,me+=String.fromCharCode(Bt>>>10&1023|55296),Bt=56320|1023&Bt),me+=String.fromCharCode(Bt),Ae+=Wt}return me}(this.buf,O,_)},readBytes:function(){var _=this.readVarint()+this.pos,O=this.buf.subarray(this.pos,_);return this.pos=_,O},readPackedVarint:function(_,O){if(this.type!==_i.Bytes)return _.push(this.readVarint(O));var q=Al(this);for(_=_||[];this.pos<q;)_.push(this.readVarint(O));return _},readPackedSVarint:function(_){if(this.type!==_i.Bytes)return _.push(this.readSVarint());var O=Al(this);for(_=_||[];this.pos<O;)_.push(this.readSVarint());return _},readPackedBoolean:function(_){if(this.type!==_i.Bytes)return _.push(this.readBoolean());var O=Al(this);for(_=_||[];this.pos<O;)_.push(this.readBoolean());return _},readPackedFloat:function(_){if(this.type!==_i.Bytes)return _.push(this.readFloat());var O=Al(this);for(_=_||[];this.pos<O;)_.push(this.readFloat());return _},readPackedDouble:function(_){if(this.type!==_i.Bytes)return _.push(this.readDouble());var O=Al(this);for(_=_||[];this.pos<O;)_.push(this.readDouble());return _},readPackedFixed32:function(_){if(this.type!==_i.Bytes)return _.push(this.readFixed32());var O=Al(this);for(_=_||[];this.pos<O;)_.push(this.readFixed32());return _},readPackedSFixed32:function(_){if(this.type!==_i.Bytes)return _.push(this.readSFixed32());var O=Al(this);for(_=_||[];this.pos<O;)_.push(this.readSFixed32());return _},readPackedFixed64:function(_){if(this.type!==_i.Bytes)return _.push(this.readFixed64());var O=Al(this);for(_=_||[];this.pos<O;)_.push(this.readFixed64());return _},readPackedSFixed64:function(_){if(this.type!==_i.Bytes)return _.push(this.readSFixed64());var O=Al(this);for(_=_||[];this.pos<O;)_.push(this.readSFixed64());return _},skip:function(_){var O=7&_;if(O===_i.Varint)for(;this.buf[this.pos++]>127;);else if(O===_i.Bytes)this.pos=this.readVarint()+this.pos;else if(O===_i.Fixed32)this.pos+=4;else{if(O!==_i.Fixed64)throw new Error("Unimplemented type: "+O);this.pos+=8}},writeTag:function(_,O){this.writeVarint(_<<3|O)},realloc:function(_){for(var O=this.length||16;O<this.pos+_;)O*=2;if(O!==this.length){var q=new Uint8Array(O);q.set(this.buf),this.buf=q,this.length=O}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(_){this.realloc(4),bu(this.buf,_,this.pos),this.pos+=4},writeSFixed32:function(_){this.realloc(4),bu(this.buf,_,this.pos),this.pos+=4},writeFixed64:function(_){this.realloc(8),bu(this.buf,-1&_,this.pos),bu(this.buf,Math.floor(_*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(_){this.realloc(8),bu(this.buf,-1&_,this.pos),bu(this.buf,Math.floor(_*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(_){(_=+_||0)>268435455||_<0?function(O,q){var re,fe;if(O>=0?(re=O%4294967296|0,fe=O/4294967296|0):(fe=~(-O/4294967296),4294967295^(re=~(-O%4294967296))?re=re+1|0:(re=0,fe=fe+1|0)),O>=18446744073709552e3||O<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");q.realloc(10),function(me,Ae,De){De.buf[De.pos++]=127&me|128,me>>>=7,De.buf[De.pos++]=127&me|128,me>>>=7,De.buf[De.pos++]=127&me|128,me>>>=7,De.buf[De.pos++]=127&me|128,me>>>=7,De.buf[De.pos]=127&me}(re,0,q),function(me,Ae){var De=(7&me)<<4;Ae.buf[Ae.pos++]|=De|((me>>>=3)?128:0),!!me&&(Ae.buf[Ae.pos++]=127&me|((me>>>=7)?128:0),!!me&&(Ae.buf[Ae.pos++]=127&me|((me>>>=7)?128:0),!!me&&(Ae.buf[Ae.pos++]=127&me|((me>>>=7)?128:0),!!me&&(Ae.buf[Ae.pos++]=127&me|((me>>>=7)?128:0),!!me&&(Ae.buf[Ae.pos++]=127&me)))))}(fe,q)}(_,this):(this.realloc(4),this.buf[this.pos++]=127&_|(_>127?128:0),_<=127||(this.buf[this.pos++]=127&(_>>>=7)|(_>127?128:0),_<=127||(this.buf[this.pos++]=127&(_>>>=7)|(_>127?128:0),_<=127||(this.buf[this.pos++]=_>>>7&127))))},writeSVarint:function(_){this.writeVarint(_<0?2*-_-1:2*_)},writeBoolean:function(_){this.writeVarint(Boolean(_))},writeString:function(_){_=String(_),this.realloc(4*_.length),this.pos++;var O=this.pos;this.pos=function(re,fe,me){for(var Ae,De,Ze=0;Ze<fe.length;Ze++){if((Ae=fe.charCodeAt(Ze))>55295&&Ae<57344){if(!De){Ae>56319||Ze+1===fe.length?(re[me++]=239,re[me++]=191,re[me++]=189):De=Ae;continue}if(Ae<56320){re[me++]=239,re[me++]=191,re[me++]=189,De=Ae;continue}Ae=De-55296<<10|Ae-56320|65536,De=null}else De&&(re[me++]=239,re[me++]=191,re[me++]=189,De=null);Ae<128?re[me++]=Ae:(Ae<2048?re[me++]=Ae>>6|192:(Ae<65536?re[me++]=Ae>>12|224:(re[me++]=Ae>>18|240,re[me++]=Ae>>12&63|128),re[me++]=Ae>>6&63|128),re[me++]=63&Ae|128)}return me}(this.buf,_,this.pos);var q=this.pos-O;q>=128&&yp(O,q,this),this.pos=O-1,this.writeVarint(q),this.pos+=q},writeFloat:function(_){this.realloc(4),mp(this.buf,_,this.pos,!0,23,4),this.pos+=4},writeDouble:function(_){this.realloc(8),mp(this.buf,_,this.pos,!0,52,8),this.pos+=8},writeBytes:function(_){var O=_.length;this.writeVarint(O),this.realloc(O);for(var q=0;q<O;q++)this.buf[this.pos++]=_[q]},writeRawMessage:function(_,O){this.pos++;var q=this.pos;_(O,this);var re=this.pos-q;re>=128&&yp(q,re,this),this.pos=q-1,this.writeVarint(re),this.pos+=re},writeMessage:function(_,O,q){this.writeTag(_,_i.Bytes),this.writeRawMessage(O,q)},writePackedVarint:function(_,O){O.length&&this.writeMessage(_,Y0,O)},writePackedSVarint:function(_,O){O.length&&this.writeMessage(_,W0,O)},writePackedBoolean:function(_,O){O.length&&this.writeMessage(_,K0,O)},writePackedFloat:function(_,O){O.length&&this.writeMessage(_,X0,O)},writePackedDouble:function(_,O){O.length&&this.writeMessage(_,Z0,O)},writePackedFixed32:function(_,O){O.length&&this.writeMessage(_,J0,O)},writePackedSFixed32:function(_,O){O.length&&this.writeMessage(_,$0,O)},writePackedFixed64:function(_,O){O.length&&this.writeMessage(_,Q0,O)},writePackedSFixed64:function(_,O){O.length&&this.writeMessage(_,eg,O)},writeBytesField:function(_,O){this.writeTag(_,_i.Bytes),this.writeBytes(O)},writeFixed32Field:function(_,O){this.writeTag(_,_i.Fixed32),this.writeFixed32(O)},writeSFixed32Field:function(_,O){this.writeTag(_,_i.Fixed32),this.writeSFixed32(O)},writeFixed64Field:function(_,O){this.writeTag(_,_i.Fixed64),this.writeFixed64(O)},writeSFixed64Field:function(_,O){this.writeTag(_,_i.Fixed64),this.writeSFixed64(O)},writeVarintField:function(_,O){this.writeTag(_,_i.Varint),this.writeVarint(O)},writeSVarintField:function(_,O){this.writeTag(_,_i.Varint),this.writeSVarint(O)},writeStringField:function(_,O){this.writeTag(_,_i.Bytes),this.writeString(O)},writeFloatField:function(_,O){this.writeTag(_,_i.Fixed32),this.writeFloat(O)},writeDoubleField:function(_,O){this.writeTag(_,_i.Fixed64),this.writeDouble(O)},writeBooleanField:function(_,O){this.writeVarintField(_,Boolean(O))}};function tg(_,O,q){_===1&&q.readMessage(rg,O)}function rg(_,O,q){if(_===3){var re=q.readMessage(ng,{}),fe=re.id,me=re.bitmap,Ae=re.width,De=re.height,Ze=re.left,ut=re.top,gt=re.advance;O.push({id:fe,bitmap:new tu({width:Ae+6,height:De+6},me),metrics:{width:Ae,height:De,left:Ze,top:ut,advance:gt}})}}function ng(_,O,q){_===1?O.id=q.readVarint():_===2?O.bitmap=q.readBytes():_===3?O.width=q.readVarint():_===4?O.height=q.readVarint():_===5?O.left=q.readSVarint():_===6?O.top=q.readSVarint():_===7&&(O.advance=q.readVarint())}function bp(_){for(var O=0,q=0,re=0,fe=_;re<fe.length;re+=1){var me=fe[re];O+=me.w*me.h,q=Math.max(q,me.w)}_.sort(function(gr,Cr){return Cr.h-gr.h});for(var Ae=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(O/.95)),q),h:1/0}],De=0,Ze=0,ut=0,gt=_;ut<gt.length;ut+=1)for(var Bt=gt[ut],Wt=Ae.length-1;Wt>=0;Wt--){var Ht=Ae[Wt];if(!(Bt.w>Ht.w||Bt.h>Ht.h)){if(Bt.x=Ht.x,Bt.y=Ht.y,Ze=Math.max(Ze,Bt.y+Bt.h),De=Math.max(De,Bt.x+Bt.w),Bt.w===Ht.w&&Bt.h===Ht.h){var ar=Ae.pop();Wt<Ae.length&&(Ae[Wt]=ar)}else Bt.h===Ht.h?(Ht.x+=Bt.w,Ht.w-=Bt.w):Bt.w===Ht.w?(Ht.y+=Bt.h,Ht.h-=Bt.h):(Ae.push({x:Ht.x+Bt.w,y:Ht.y,w:Ht.w-Bt.w,h:Bt.h}),Ht.y+=Bt.h,Ht.h-=Bt.h);break}}return{w:De,h:Ze,fill:O/(De*Ze)||0}}var Fc=function(_,O){var q=O.pixelRatio,re=O.version,fe=O.stretchX,me=O.stretchY,Ae=O.content;this.paddedRect=_,this.pixelRatio=q,this.stretchX=fe,this.stretchY=me,this.content=Ae,this.version=re},tc={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};tc.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},tc.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},tc.tlbr.get=function(){return this.tl.concat(this.br)},tc.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Fc.prototype,tc);var rc=function(_,O){var q={},re={};this.haveRenderCallbacks=[];var fe=[];this.addImages(_,q,fe),this.addImages(O,re,fe);var me=bp(fe),Ae=me.w,De=me.h,Ze=new hs({width:Ae||1,height:De||1});for(var ut in _){var gt=_[ut],Bt=q[ut].paddedRect;hs.copy(gt.data,Ze,{x:0,y:0},{x:Bt.x+1,y:Bt.y+1},gt.data)}for(var Wt in O){var Ht=O[Wt],ar=re[Wt].paddedRect,gr=ar.x+1,Cr=ar.y+1,Er=Ht.data.width,Fr=Ht.data.height;hs.copy(Ht.data,Ze,{x:0,y:0},{x:gr,y:Cr},Ht.data),hs.copy(Ht.data,Ze,{x:0,y:Fr-1},{x:gr,y:Cr-1},{width:Er,height:1}),hs.copy(Ht.data,Ze,{x:0,y:0},{x:gr,y:Cr+Fr},{width:Er,height:1}),hs.copy(Ht.data,Ze,{x:Er-1,y:0},{x:gr-1,y:Cr},{width:1,height:Fr}),hs.copy(Ht.data,Ze,{x:0,y:0},{x:gr+Er,y:Cr},{width:1,height:Fr})}this.image=Ze,this.iconPositions=q,this.patternPositions=re};rc.prototype.addImages=function(_,O,q){for(var re in _){var fe=_[re],me={x:0,y:0,w:fe.data.width+2,h:fe.data.height+2};q.push(me),O[re]=new Fc(me,fe),fe.hasRenderCallback&&this.haveRenderCallbacks.push(re)}},rc.prototype.patchUpdatedImages=function(_,O){for(var q in _.dispatchRenderCallbacks(this.haveRenderCallbacks),_.updatedImages)this.patchUpdatedImage(this.iconPositions[q],_.getImage(q),O),this.patchUpdatedImage(this.patternPositions[q],_.getImage(q),O)},rc.prototype.patchUpdatedImage=function(_,O,q){if(_&&O&&_.version!==O.version){_.version=O.version;var re=_.tl,fe=re[0],me=re[1];q.update(O.data,void 0,{x:fe,y:me})}},Xr("ImagePosition",Fc),Xr("ImageAtlas",rc);var Cs={horizontal:1,vertical:2,horizontalOnly:3},_u=function(){this.scale=1,this.fontStack="",this.imageName=null};_u.forText=function(_,O){var q=new _u;return q.scale=_||1,q.fontStack=O,q},_u.forImage=function(_){var O=new _u;return O.imageName=_,O};var Ko=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Bc(_,O,q,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar,gr){var Cr,Er=Ko.fromFeature(_,fe);Bt===Cs.vertical&&Er.verticalizePunctuation();var Fr=yo.processBidirectionalText,Br=yo.processStyledBidirectionalText;if(Fr&&Er.sections.length===1){Cr=[];for(var Hr=0,fn=Fr(Er.toString(),th(Er,ut,me,O,re,Ht,ar));Hr<fn.length;Hr+=1){var xn=fn[Hr],Nn=new Ko;Nn.text=xn,Nn.sections=Er.sections;for(var Fn=0;Fn<xn.length;Fn++)Nn.sectionIndex.push(0);Cr.push(Nn)}}else if(Br){Cr=[];for(var qn=0,na=Br(Er.text,Er.sectionIndex,th(Er,ut,me,O,re,Ht,ar));qn<na.length;qn+=1){var ia=na[qn],Zn=new Ko;Zn.text=ia[0],Zn.sectionIndex=ia[1],Zn.sections=Er.sections,Cr.push(Zn)}}else Cr=function(oa,$a){for(var Va=[],ri=oa.text,_a=0,Ya=0,wi=$a;Ya<wi.length;Ya+=1){var gi=wi[Ya];Va.push(oa.substring(_a,gi)),_a=gi}return _a<ri.length&&Va.push(oa.substring(_a,ri.length)),Va}(Er,th(Er,ut,me,O,re,Ht,ar));var ha=[],ca={positionedLines:ha,text:Er.toString(),top:gt[1],bottom:gt[1],left:gt[0],right:gt[0],writingMode:Bt,iconsInText:!1,verticalizable:!1};return function(oa,$a,Va,ri,_a,Ya,wi,gi,Ii,mi,ho,Oi){for(var Wo=0,Oo=-17,Ro=0,os=0,Jo=gi==="right"?1:gi==="left"?0:.5,po=0,Fo=0,eo=_a;Fo<eo.length;Fo+=1){var xo=eo[Fo];xo.trim();var Ra=xo.getMaxScale(),ei=24*(Ra-1),qi={positionedGlyphs:[],lineOffset:0};oa.positionedLines[po]=qi;var Yi=qi.positionedGlyphs,Ui=0;if(xo.length()){for(var Di=0;Di<xo.length();Di++){var si=xo.getSection(Di),Wi=xo.getSectionIndex(Di),ss=xo.getCharCode(Di),Ts=0,$o=null,al=null,El=null,Do=24,il=!(Ii===Cs.horizontal||!ho&&!da(ss)||ho&&(Nc[ss]||(Nl=ss,Mn.Arabic(Nl)||Mn["Arabic Supplement"](Nl)||Mn["Arabic Extended-A"](Nl)||Mn["Arabic Presentation Forms-A"](Nl)||Mn["Arabic Presentation Forms-B"](Nl))));if(si.imageName){var ol=ri[si.imageName];if(!ol)continue;El=si.imageName,oa.iconsInText=oa.iconsInText||!0,al=ol.paddedRect;var sl=ol.displaySize;si.scale=24*si.scale/Oi,$o={width:sl[0],height:sl[1],left:1,top:-3,advance:il?sl[1]:sl[0]};var fh=24-sl[1]*si.scale;Ts=ei+fh,Do=$o.advance;var Cu=il?sl[0]*si.scale-24*Ra:sl[1]*si.scale-24*Ra;Cu>0&&Cu>Ui&&(Ui=Cu)}else{var Xc=Va[si.fontStack],iu=Xc&&Xc[ss];if(iu&&iu.rect)al=iu.rect,$o=iu.metrics;else{var Zc=$a[si.fontStack],Kc=Zc&&Zc[ss];if(!Kc)continue;$o=Kc.metrics}Ts=24*(Ra-si.scale)}il?(oa.verticalizable=!0,Yi.push({glyph:ss,imageName:El,x:Wo,y:Oo+Ts,vertical:il,scale:si.scale,fontStack:si.fontStack,sectionIndex:Wi,metrics:$o,rect:al}),Wo+=Do*si.scale+mi):(Yi.push({glyph:ss,imageName:El,x:Wo,y:Oo+Ts,vertical:il,scale:si.scale,fontStack:si.fontStack,sectionIndex:Wi,metrics:$o,rect:al}),Wo+=$o.advance*si.scale+mi)}if(Yi.length!==0){var Jc=Wo-mi;Ro=Math.max(Jc,Ro),ig(Yi,0,Yi.length-1,Jo,Ui)}Wo=0;var $c=Ya*Ra+Ui;qi.lineOffset=Math.max(Ui,ei),Oo+=$c,os=Math.max($c,os),++po}else Oo+=Ya,++po}var Nl,Lu=Oo- -17,Qc=rh(wi),Pu=Qc.horizontalAlign,jl=Qc.verticalAlign;(function(ic,ef,tf,rf,oc,nf,sc,af,lc){var of=(ef-tf)*oc,Iu=0;Iu=nf!==sc?-af*rf- -17:(-rf*lc+.5)*sc;for(var Ou=0,Du=ic;Ou<Du.length;Ou+=1)for(var sf=Du[Ou],zu=0,uc=sf.positionedGlyphs;zu<uc.length;zu+=1){var Ru=uc[zu];Ru.x+=of,Ru.y+=Iu}})(oa.positionedLines,Jo,Pu,jl,Ro,os,Ya,Lu,_a.length),oa.top+=-jl*Lu,oa.bottom=oa.top+Lu,oa.left+=-Pu*Ro,oa.right=oa.left+Ro}(ca,O,q,re,Cr,Ae,De,Ze,Bt,ut,Wt,gr),!function(oa){for(var $a=0,Va=oa;$a<Va.length;$a+=1)if(Va[$a].positionedGlyphs.length!==0)return!1;return!0}(ha)&&ca}Ko.fromFeature=function(_,O){for(var q=new Ko,re=0;re<_.sections.length;re++){var fe=_.sections[re];fe.image?q.addImageSection(fe):q.addTextSection(fe,O)}return q},Ko.prototype.length=function(){return this.text.length},Ko.prototype.getSection=function(_){return this.sections[this.sectionIndex[_]]},Ko.prototype.getSectionIndex=function(_){return this.sectionIndex[_]},Ko.prototype.getCharCode=function(_){return this.text.charCodeAt(_)},Ko.prototype.verticalizePunctuation=function(){this.text=function(_){for(var O="",q=0;q<_.length;q++){var re=_.charCodeAt(q+1)||null,fe=_.charCodeAt(q-1)||null;(!re||!za(re)||ec[_[q+1]])&&(!fe||!za(fe)||ec[_[q-1]])&&ec[_[q]]?O+=ec[_[q]]:O+=_[q]}return O}(this.text)},Ko.prototype.trim=function(){for(var _=0,O=0;O<this.text.length&&Nc[this.text.charCodeAt(O)];O++)_++;for(var q=this.text.length,re=this.text.length-1;re>=0&&re>=_&&Nc[this.text.charCodeAt(re)];re--)q--;this.text=this.text.substring(_,q),this.sectionIndex=this.sectionIndex.slice(_,q)},Ko.prototype.substring=function(_,O){var q=new Ko;return q.text=this.text.substring(_,O),q.sectionIndex=this.sectionIndex.slice(_,O),q.sections=this.sections,q},Ko.prototype.toString=function(){return this.text},Ko.prototype.getMaxScale=function(){var _=this;return this.sectionIndex.reduce(function(O,q){return Math.max(O,_.sections[q].scale)},0)},Ko.prototype.addTextSection=function(_,O){this.text+=_.text,this.sections.push(_u.forText(_.scale,_.fontStack||O));for(var q=this.sections.length-1,re=0;re<_.text.length;++re)this.sectionIndex.push(q)},Ko.prototype.addImageSection=function(_){var O=_.image?_.image.name:"";if(O.length!==0){var q=this.getNextImageSectionCharCode();q?(this.text+=String.fromCharCode(q),this.sections.push(_u.forImage(O)),this.sectionIndex.push(this.sections.length-1)):k("Reached maximum number of images 6401")}else k("Can't add FormattedSection with an empty image.")},Ko.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Nc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ws={};function _p(_,O,q,re,fe,me){if(O.imageName){var Ae=re[O.imageName];return Ae?Ae.displaySize[0]*O.scale*24/me+fe:0}var De=q[O.fontStack],Ze=De&&De[_];return Ze?Ze.metrics.advance*O.scale+fe:0}function wp(_,O,q,re){var fe=Math.pow(_-O,2);return re?_<O?fe/2:2*fe:fe+Math.abs(q)*q}function ag(_,O,q){var re=0;return _===10&&(re-=1e4),q&&(re+=150),_!==40&&_!==65288||(re+=50),O!==41&&O!==65289||(re+=50),re}function Tp(_,O,q,re,fe,me){for(var Ae=null,De=wp(O,q,fe,me),Ze=0,ut=re;Ze<ut.length;Ze+=1){var gt=ut[Ze],Bt=wp(O-gt.x,q,fe,me)+gt.badness;Bt<=De&&(Ae=gt,De=Bt)}return{index:_,x:O,priorBreak:Ae,badness:De}}function th(_,O,q,re,fe,me,Ae){if(me!=="point")return[];if(!_)return[];for(var De,Ze=[],ut=function(Cr,Er,Fr,Br,Hr,fn){for(var xn=0,Nn=0;Nn<Cr.length();Nn++){var Fn=Cr.getSection(Nn);xn+=_p(Cr.getCharCode(Nn),Fn,Br,Hr,Er,fn)}return xn/Math.max(1,Math.ceil(xn/Fr))}(_,O,q,re,fe,Ae),gt=_.text.indexOf("\u200B")>=0,Bt=0,Wt=0;Wt<_.length();Wt++){var Ht=_.getSection(Wt),ar=_.getCharCode(Wt);if(Nc[ar]||(Bt+=_p(ar,Ht,re,fe,O,Ae)),Wt<_.length()-1){var gr=!!(!((De=ar)<11904)&&(Mn["Bopomofo Extended"](De)||Mn.Bopomofo(De)||Mn["CJK Compatibility Forms"](De)||Mn["CJK Compatibility Ideographs"](De)||Mn["CJK Compatibility"](De)||Mn["CJK Radicals Supplement"](De)||Mn["CJK Strokes"](De)||Mn["CJK Symbols and Punctuation"](De)||Mn["CJK Unified Ideographs Extension A"](De)||Mn["CJK Unified Ideographs"](De)||Mn["Enclosed CJK Letters and Months"](De)||Mn["Halfwidth and Fullwidth Forms"](De)||Mn.Hiragana(De)||Mn["Ideographic Description Characters"](De)||Mn["Kangxi Radicals"](De)||Mn["Katakana Phonetic Extensions"](De)||Mn.Katakana(De)||Mn["Vertical Forms"](De)||Mn["Yi Radicals"](De)||Mn["Yi Syllables"](De)));(ws[ar]||gr||Ht.imageName)&&Ze.push(Tp(Wt+1,Bt,ut,Ze,ag(ar,_.getCharCode(Wt+1),gr&&gt),!1))}}return function Cr(Er){return Er?Cr(Er.priorBreak).concat(Er.index):[]}(Tp(_.length(),Bt,ut,Ze,0,!0))}function rh(_){var O=.5,q=.5;switch(_){case"right":case"top-right":case"bottom-right":O=1;break;case"left":case"top-left":case"bottom-left":O=0}switch(_){case"bottom":case"bottom-right":case"bottom-left":q=1;break;case"top":case"top-right":case"top-left":q=0}return{horizontalAlign:O,verticalAlign:q}}function ig(_,O,q,re,fe){if(re||fe)for(var me=_[q],Ae=me.metrics.advance*me.scale,De=(_[q].x+Ae)*re,Ze=O;Ze<=q;Ze++)_[Ze].x-=De,_[Ze].y+=fe}function kp(_,O,q,re,fe,me){var Ae,De=_.image;if(De.content){var Ze=De.content,ut=De.pixelRatio||1;Ae=[Ze[0]/ut,Ze[1]/ut,De.displaySize[0]-Ze[2]/ut,De.displaySize[1]-Ze[3]/ut]}var gt,Bt,Wt,Ht,ar=O.left*me,gr=O.right*me;q==="width"||q==="both"?(Ht=fe[0]+ar-re[3],Bt=fe[0]+gr+re[1]):Bt=(Ht=fe[0]+(ar+gr-De.displaySize[0])/2)+De.displaySize[0];var Cr=O.top*me,Er=O.bottom*me;return q==="height"||q==="both"?(gt=fe[1]+Cr-re[0],Wt=fe[1]+Er+re[2]):Wt=(gt=fe[1]+(Cr+Er-De.displaySize[1])/2)+De.displaySize[1],{image:De,top:gt,right:Bt,bottom:Wt,left:Ht,collisionPadding:Ae}}ws[10]=!0,ws[32]=!0,ws[38]=!0,ws[40]=!0,ws[41]=!0,ws[43]=!0,ws[45]=!0,ws[47]=!0,ws[173]=!0,ws[183]=!0,ws[8203]=!0,ws[8208]=!0,ws[8211]=!0,ws[8231]=!0;var wu=function(_){function O(q,re,fe,me){_.call(this,q,re),this.angle=fe,me!==void 0&&(this.segment=me)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.clone=function(){return new O(this.x,this.y,this.angle,this.segment)},O}(u);Xr("Anchor",wu);function nh(_,O){var q=O.expression;if(q.kind==="constant")return{kind:"constant",layoutSize:q.evaluate(new ii(_+1))};if(q.kind==="source")return{kind:"source"};for(var re=q.zoomStops,fe=q.interpolationType,me=0;me<re.length&&re[me]<=_;)me++;for(var Ae=me=Math.max(0,me-1);Ae<re.length&&re[Ae]<_+1;)Ae++;Ae=Math.min(re.length-1,Ae);var De=re[me],Ze=re[Ae];return q.kind==="composite"?{kind:"composite",minZoom:De,maxZoom:Ze,interpolationType:fe}:{kind:"camera",minZoom:De,maxZoom:Ze,minSize:q.evaluate(new ii(De)),maxSize:q.evaluate(new ii(Ze)),interpolationType:fe}}function Ap(_,O,q){var re=O.uSize,fe=O.uSizeT,me=q.lowerSize,Ae=q.upperSize;return _.kind==="source"?me/128:_.kind==="composite"?Yn(me/128,Ae/128,fe):re}function Mp(_,O){var q=0,re=0;if(_.kind==="constant")re=_.layoutSize;else if(_.kind!=="source"){var fe=_.interpolationType,me=_.minZoom,Ae=_.maxZoom,De=fe?n(Wa.interpolationFactor(fe,O,me,Ae),0,1):0;_.kind==="camera"?re=Yn(_.minSize,_.maxSize,De):q=De}return{uSizeT:q,uSize:re}}var og=Object.freeze({__proto__:null,getSizeData:nh,evaluateSizeForFeature:Ap,evaluateSizeForZoom:Mp,SIZE_PACK_FACTOR:128});function Sp(_,O,q,re,fe){if(O.segment===void 0)return!0;for(var me=O,Ae=O.segment+1,De=0;De>-q/2;){if(--Ae<0)return!1;De-=_[Ae].dist(me),me=_[Ae]}De+=_[Ae].dist(_[Ae+1]),Ae++;for(var Ze=[],ut=0;De<q/2;){var gt=_[Ae-1],Bt=_[Ae],Wt=_[Ae+1];if(!Wt)return!1;var Ht=gt.angleTo(Bt)-Bt.angleTo(Wt);for(Ht=Math.abs((Ht+3*Math.PI)%(2*Math.PI)-Math.PI),Ze.push({distance:De,angleDelta:Ht}),ut+=Ht;De-Ze[0].distance>re;)ut-=Ze.shift().angleDelta;if(ut>fe)return!1;Ae++,De+=Bt.dist(Wt)}return!0}function Ep(_){for(var O=0,q=0;q<_.length-1;q++)O+=_[q].dist(_[q+1]);return O}function Cp(_,O,q){return _?.6*O*q:0}function Lp(_,O){return Math.max(_?_.right-_.left:0,O?O.right-O.left:0)}function sg(_,O,q,re,fe,me){for(var Ae=Cp(q,fe,me),De=Lp(q,re)*me,Ze=0,ut=Ep(_)/2,gt=0;gt<_.length-1;gt++){var Bt=_[gt],Wt=_[gt+1],Ht=Bt.dist(Wt);if(Ze+Ht>ut){var ar=(ut-Ze)/Ht,gr=Yn(Bt.x,Wt.x,ar),Cr=Yn(Bt.y,Wt.y,ar),Er=new wu(gr,Cr,Wt.angleTo(Bt),gt);return Er._round(),!Ae||Sp(_,Er,De,Ae,O)?Er:void 0}Ze+=Ht}}function lg(_,O,q,re,fe,me,Ae,De,Ze){var ut=Cp(re,me,Ae),gt=Lp(re,fe),Bt=gt*Ae,Wt=_[0].x===0||_[0].x===Ze||_[0].y===0||_[0].y===Ze;return O-Bt<O/4&&(O=Bt+O/4),function Ht(ar,gr,Cr,Er,Fr,Br,Hr,fn,xn){for(var Nn=Br/2,Fn=Ep(ar),qn=0,na=gr-Cr,ia=[],Zn=0;Zn<ar.length-1;Zn++){for(var ha=ar[Zn],ca=ar[Zn+1],oa=ha.dist(ca),$a=ca.angleTo(ha);na+Cr<qn+oa;){var Va=((na+=Cr)-qn)/oa,ri=Yn(ha.x,ca.x,Va),_a=Yn(ha.y,ca.y,Va);if(ri>=0&&ri<xn&&_a>=0&&_a<xn&&na-Nn>=0&&na+Nn<=Fn){var Ya=new wu(ri,_a,$a,Zn);Ya._round(),Er&&!Sp(ar,Ya,Br,Er,Fr)||ia.push(Ya)}}qn+=oa}return fn||ia.length||Hr||(ia=Ht(ar,qn/2,Cr,Er,Fr,Br,Hr,!0,xn)),ia}(_,Wt?O/2*De%O:(gt/2+2*me)*Ae*De%O,O,ut,q,Bt,Wt,!1,Ze)}function Pp(_,O,q,re,fe){for(var me=[],Ae=0;Ae<_.length;Ae++)for(var De=_[Ae],Ze=void 0,ut=0;ut<De.length-1;ut++){var gt=De[ut],Bt=De[ut+1];gt.x<O&&Bt.x<O||(gt.x<O?gt=new u(O,gt.y+(Bt.y-gt.y)*((O-gt.x)/(Bt.x-gt.x)))._round():Bt.x<O&&(Bt=new u(O,gt.y+(Bt.y-gt.y)*((O-gt.x)/(Bt.x-gt.x)))._round()),gt.y<q&&Bt.y<q||(gt.y<q?gt=new u(gt.x+(Bt.x-gt.x)*((q-gt.y)/(Bt.y-gt.y)),q)._round():Bt.y<q&&(Bt=new u(gt.x+(Bt.x-gt.x)*((q-gt.y)/(Bt.y-gt.y)),q)._round()),gt.x>=re&&Bt.x>=re||(gt.x>=re?gt=new u(re,gt.y+(Bt.y-gt.y)*((re-gt.x)/(Bt.x-gt.x)))._round():Bt.x>=re&&(Bt=new u(re,gt.y+(Bt.y-gt.y)*((re-gt.x)/(Bt.x-gt.x)))._round()),gt.y>=fe&&Bt.y>=fe||(gt.y>=fe?gt=new u(gt.x+(Bt.x-gt.x)*((fe-gt.y)/(Bt.y-gt.y)),fe)._round():Bt.y>=fe&&(Bt=new u(gt.x+(Bt.x-gt.x)*((fe-gt.y)/(Bt.y-gt.y)),fe)._round()),Ze&&gt.equals(Ze[Ze.length-1])||(Ze=[gt],me.push(Ze)),Ze.push(Bt)))))}return me}function Ip(_,O,q,re){var fe=[],me=_.image,Ae=me.pixelRatio,De=me.paddedRect.w-2,Ze=me.paddedRect.h-2,ut=_.right-_.left,gt=_.bottom-_.top,Bt=me.stretchX||[[0,De]],Wt=me.stretchY||[[0,Ze]],Ht=function(Ya,wi){return Ya+wi[1]-wi[0]},ar=Bt.reduce(Ht,0),gr=Wt.reduce(Ht,0),Cr=De-ar,Er=Ze-gr,Fr=0,Br=ar,Hr=0,fn=gr,xn=0,Nn=Cr,Fn=0,qn=Er;if(me.content&&re){var na=me.content;Fr=jc(Bt,0,na[0]),Hr=jc(Wt,0,na[1]),Br=jc(Bt,na[0],na[2]),fn=jc(Wt,na[1],na[3]),xn=na[0]-Fr,Fn=na[1]-Hr,Nn=na[2]-na[0]-Br,qn=na[3]-na[1]-fn}var ia=function(Ya,wi,gi,Ii){var mi=Uc(Ya.stretch-Fr,Br,ut,_.left),ho=Vc(Ya.fixed-xn,Nn,Ya.stretch,ar),Oi=Uc(wi.stretch-Hr,fn,gt,_.top),Wo=Vc(wi.fixed-Fn,qn,wi.stretch,gr),Oo=Uc(gi.stretch-Fr,Br,ut,_.left),Ro=Vc(gi.fixed-xn,Nn,gi.stretch,ar),os=Uc(Ii.stretch-Hr,fn,gt,_.top),Jo=Vc(Ii.fixed-Fn,qn,Ii.stretch,gr),po=new u(mi,Oi),Fo=new u(Oo,Oi),eo=new u(Oo,os),xo=new u(mi,os),Ra=new u(ho/Ae,Wo/Ae),ei=new u(Ro/Ae,Jo/Ae),qi=O*Math.PI/180;if(qi){var Yi=Math.sin(qi),Ui=Math.cos(qi),Di=[Ui,-Yi,Yi,Ui];po._matMult(Di),Fo._matMult(Di),xo._matMult(Di),eo._matMult(Di)}var si=Ya.stretch+Ya.fixed,Wi=gi.stretch+gi.fixed,ss=wi.stretch+wi.fixed,Ts=Ii.stretch+Ii.fixed;return{tl:po,tr:Fo,bl:xo,br:eo,tex:{x:me.paddedRect.x+1+si,y:me.paddedRect.y+1+ss,w:Wi-si,h:Ts-ss},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ra,pixelOffsetBR:ei,minFontScaleX:Nn/Ae/ut,minFontScaleY:qn/Ae/gt,isSDF:q}};if(re&&(me.stretchX||me.stretchY))for(var Zn=Op(Bt,Cr,ar),ha=Op(Wt,Er,gr),ca=0;ca<Zn.length-1;ca++)for(var oa=Zn[ca],$a=Zn[ca+1],Va=0;Va<ha.length-1;Va++){var ri=ha[Va],_a=ha[Va+1];fe.push(ia(oa,ri,$a,_a))}else fe.push(ia({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:De+1},{fixed:0,stretch:Ze+1}));return fe}function jc(_,O,q){for(var re=0,fe=0,me=_;fe<me.length;fe+=1){var Ae=me[fe];re+=Math.max(O,Math.min(q,Ae[1]))-Math.max(O,Math.min(q,Ae[0]))}return re}function Op(_,O,q){for(var re=[{fixed:-1,stretch:0}],fe=0,me=_;fe<me.length;fe+=1){var Ae=me[fe],De=Ae[0],Ze=Ae[1],ut=re[re.length-1];re.push({fixed:De-ut.stretch,stretch:ut.stretch}),re.push({fixed:De-ut.stretch,stretch:ut.stretch+(Ze-De)})}return re.push({fixed:O+1,stretch:q}),re}function Uc(_,O,q,re){return _/O*q+re}function Vc(_,O,q,re){return _-O*q/re}var Hc=function(_,O,q,re,fe,me,Ae,De,Ze,ut){if(this.boxStartIndex=_.length,Ze){var gt=me.top,Bt=me.bottom,Wt=me.collisionPadding;Wt&&(gt-=Wt[1],Bt+=Wt[3]);var Ht=Bt-gt;Ht>0&&(Ht=Math.max(10,Ht),this.circleDiameter=Ht)}else{var ar=me.top*Ae-De,gr=me.bottom*Ae+De,Cr=me.left*Ae-De,Er=me.right*Ae+De,Fr=me.collisionPadding;if(Fr&&(Cr-=Fr[0]*Ae,ar-=Fr[1]*Ae,Er+=Fr[2]*Ae,gr+=Fr[3]*Ae),ut){var Br=new u(Cr,ar),Hr=new u(Er,ar),fn=new u(Cr,gr),xn=new u(Er,gr),Nn=ut*Math.PI/180;Br._rotate(Nn),Hr._rotate(Nn),fn._rotate(Nn),xn._rotate(Nn),Cr=Math.min(Br.x,Hr.x,fn.x,xn.x),Er=Math.max(Br.x,Hr.x,fn.x,xn.x),ar=Math.min(Br.y,Hr.y,fn.y,xn.y),gr=Math.max(Br.y,Hr.y,fn.y,xn.y)}_.emplaceBack(O.x,O.y,Cr,ar,Er,gr,q,re,fe)}this.boxEndIndex=_.length},Tu=function(_,O){if(_===void 0&&(_=[]),O===void 0&&(O=ug),this.data=_,this.length=this.data.length,this.compare=O,this.length>0)for(var q=(this.length>>1)-1;q>=0;q--)this._down(q)};function ug(_,O){return _<O?-1:_>O?1:0}function cg(_,O,q){O===void 0&&(O=1),q===void 0&&(q=!1);for(var re=1/0,fe=1/0,me=-1/0,Ae=-1/0,De=_[0],Ze=0;Ze<De.length;Ze++){var ut=De[Ze];(!Ze||ut.x<re)&&(re=ut.x),(!Ze||ut.y<fe)&&(fe=ut.y),(!Ze||ut.x>me)&&(me=ut.x),(!Ze||ut.y>Ae)&&(Ae=ut.y)}var gt=me-re,Bt=Ae-fe,Wt=Math.min(gt,Bt),Ht=Wt/2,ar=new Tu([],fg);if(Wt===0)return new u(re,fe);for(var gr=re;gr<me;gr+=Wt)for(var Cr=fe;Cr<Ae;Cr+=Wt)ar.push(new ku(gr+Ht,Cr+Ht,Ht,_));for(var Er=function(Hr){for(var fn=0,xn=0,Nn=0,Fn=Hr[0],qn=0,na=Fn.length,ia=na-1;qn<na;ia=qn++){var Zn=Fn[qn],ha=Fn[ia],ca=Zn.x*ha.y-ha.x*Zn.y;xn+=(Zn.x+ha.x)*ca,Nn+=(Zn.y+ha.y)*ca,fn+=3*ca}return new ku(xn/fn,Nn/fn,0,Hr)}(_),Fr=ar.length;ar.length;){var Br=ar.pop();(Br.d>Er.d||!Er.d)&&(Er=Br,q&&console.log("found best %d after %d probes",Math.round(1e4*Br.d)/1e4,Fr)),Br.max-Er.d<=O||(Ht=Br.h/2,ar.push(new ku(Br.p.x-Ht,Br.p.y-Ht,Ht,_)),ar.push(new ku(Br.p.x+Ht,Br.p.y-Ht,Ht,_)),ar.push(new ku(Br.p.x-Ht,Br.p.y+Ht,Ht,_)),ar.push(new ku(Br.p.x+Ht,Br.p.y+Ht,Ht,_)),Fr+=4)}return q&&(console.log("num probes: "+Fr),console.log("best distance: "+Er.d)),Er.p}function fg(_,O){return O.max-_.max}function ku(_,O,q,re){this.p=new u(_,O),this.h=q,this.d=function(fe,me){for(var Ae=!1,De=1/0,Ze=0;Ze<me.length;Ze++)for(var ut=me[Ze],gt=0,Bt=ut.length,Wt=Bt-1;gt<Bt;Wt=gt++){var Ht=ut[gt],ar=ut[Wt];Ht.y>fe.y!=ar.y>fe.y&&fe.x<(ar.x-Ht.x)*(fe.y-Ht.y)/(ar.y-Ht.y)+Ht.x&&(Ae=!Ae),De=Math.min(De,Tl(fe,Ht,ar))}return(Ae?1:-1)*Math.sqrt(De)}(this.p,re),this.max=this.d+this.h*Math.SQRT2}Tu.prototype.push=function(_){this.data.push(_),this.length++,this._up(this.length-1)},Tu.prototype.pop=function(){if(this.length!==0){var _=this.data[0],O=this.data.pop();return this.length--,this.length>0&&(this.data[0]=O,this._down(0)),_}},Tu.prototype.peek=function(){return this.data[0]},Tu.prototype._up=function(_){for(var O=this.data,q=this.compare,re=O[_];_>0;){var fe=_-1>>1,me=O[fe];if(q(re,me)>=0)break;O[_]=me,_=fe}O[_]=re},Tu.prototype._down=function(_){for(var O=this.data,q=this.compare,re=this.length>>1,fe=O[_];_<re;){var me=1+(_<<1),Ae=O[me],De=me+1;if(De<this.length&&q(O[De],Ae)<0&&(me=De,Ae=O[De]),q(Ae,fe)>=0)break;O[_]=Ae,_=me}O[_]=fe};var ah=Number.POSITIVE_INFINITY;function Dp(_,O){return O[1]!==ah?function(q,re,fe){var me=0,Ae=0;switch(re=Math.abs(re),fe=Math.abs(fe),q){case"top-right":case"top-left":case"top":Ae=fe-7;break;case"bottom-right":case"bottom-left":case"bottom":Ae=7-fe}switch(q){case"top-right":case"bottom-right":case"right":me=-re;break;case"top-left":case"bottom-left":case"left":me=re}return[me,Ae]}(_,O[0],O[1]):function(q,re){var fe=0,me=0;re<0&&(re=0);var Ae=re/Math.sqrt(2);switch(q){case"top-right":case"top-left":me=Ae-7;break;case"bottom-right":case"bottom-left":me=7-Ae;break;case"bottom":me=7-re;break;case"top":me=re-7}switch(q){case"top-right":case"bottom-right":fe=-Ae;break;case"top-left":case"bottom-left":fe=Ae;break;case"left":fe=re;break;case"right":fe=-re}return[fe,me]}(_,O[0])}function ih(_){switch(_){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function zp(_,O,q,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar){var gr=function(Hr,fn,xn,Nn,Fn,qn,na,ia){for(var Zn=Nn.layout.get("text-rotate").evaluate(qn,{})*Math.PI/180,ha=[],ca=0,oa=fn.positionedLines;ca<oa.length;ca+=1)for(var $a=oa[ca],Va=0,ri=$a.positionedGlyphs;Va<ri.length;Va+=1){var _a=ri[Va];if(_a.rect){var Ya=_a.rect||{},wi=4,gi=!0,Ii=1,mi=0,ho=(Fn||ia)&&_a.vertical,Oi=_a.metrics.advance*_a.scale/2;if(ia&&fn.verticalizable){var Wo=24*(_a.scale-1),Oo=(24-_a.metrics.width*_a.scale)/2;mi=$a.lineOffset/2-(_a.imageName?-Oo:Wo)}if(_a.imageName){var Ro=na[_a.imageName];gi=Ro.sdf,wi=1/(Ii=Ro.pixelRatio)}var os=Fn?[_a.x+Oi,_a.y]:[0,0],Jo=Fn?[0,0]:[_a.x+Oi+xn[0],_a.y+xn[1]-mi],po=[0,0];ho&&(po=Jo,Jo=[0,0]);var Fo=(_a.metrics.left-wi)*_a.scale-Oi+Jo[0],eo=(-_a.metrics.top-wi)*_a.scale+Jo[1],xo=Fo+Ya.w*_a.scale/Ii,Ra=eo+Ya.h*_a.scale/Ii,ei=new u(Fo,eo),qi=new u(xo,eo),Yi=new u(Fo,Ra),Ui=new u(xo,Ra);if(ho){var Di=new u(-Oi,Oi- -17),si=-Math.PI/2,Wi=12-Oi,ss=_a.imageName?Wi:0,Ts=new u(22-Wi,-ss),$o=new(Function.prototype.bind.apply(u,[null].concat(po)));ei._rotateAround(si,Di)._add(Ts)._add($o),qi._rotateAround(si,Di)._add(Ts)._add($o),Yi._rotateAround(si,Di)._add(Ts)._add($o),Ui._rotateAround(si,Di)._add(Ts)._add($o)}if(Zn){var al=Math.sin(Zn),El=Math.cos(Zn),Do=[El,-al,al,El];ei._matMult(Do),qi._matMult(Do),Yi._matMult(Do),Ui._matMult(Do)}var il=new u(0,0),ol=new u(0,0);ha.push({tl:ei,tr:qi,bl:Yi,br:Ui,tex:Ya,writingMode:fn.writingMode,glyphOffset:os,sectionIndex:_a.sectionIndex,isSDF:gi,pixelOffsetTL:il,pixelOffsetBR:ol,minFontScaleX:0,minFontScaleY:0})}}return ha}(0,q,De,fe,me,Ae,re,_.allowVerticalPlacement),Cr=_.textSizeData,Er=null;Cr.kind==="source"?(Er=[128*fe.layout.get("text-size").evaluate(Ae,{})])[0]>32640&&k(_.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Cr.kind==="composite"&&((Er=[128*Ht.compositeTextSizes[0].evaluate(Ae,{},ar),128*Ht.compositeTextSizes[1].evaluate(Ae,{},ar)])[0]>32640||Er[1]>32640)&&k(_.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),_.addSymbols(_.text,gr,Er,De,me,Ae,ut,O,Ze.lineStartIndex,Ze.lineLength,Wt,ar);for(var Fr=0,Br=gt;Fr<Br.length;Fr+=1)Bt[Br[Fr]]=_.text.placedSymbolArray.length-1;return 4*gr.length}function Rp(_){for(var O in _)return _[O];return null}function hg(_,O,q,re){var fe=_.compareText;if(O in fe){for(var me=fe[O],Ae=me.length-1;Ae>=0;Ae--)if(re.dist(me[Ae])<q)return!0}else fe[O]=[];return fe[O].push(re),!1}var pg=yu.VectorTileFeature.types,dg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Gc(_,O,q,re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt){var Ht=De?Math.min(32640,Math.round(De[0])):0,ar=De?Math.min(32640,Math.round(De[1])):0;_.emplaceBack(O,q,Math.round(32*re),Math.round(32*fe),me,Ae,(Ht<<1)+(Ze?1:0),ar,16*ut,16*gt,256*Bt,256*Wt)}function oh(_,O,q){_.emplaceBack(O.x,O.y,q),_.emplaceBack(O.x,O.y,q),_.emplaceBack(O.x,O.y,q),_.emplaceBack(O.x,O.y,q)}function gg(_){for(var O=0,q=_.sections;O<q.length;O+=1)if(Qn(q[O].text))return!0;return!1}var Au=function(_){this.layoutVertexArray=new el,this.indexArray=new lo,this.programConfigurations=_,this.segments=new Ft,this.dynamicLayoutVertexArray=new Es,this.opacityVertexArray=new Ol,this.placedSymbolArray=new Ne};Au.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Au.prototype.upload=function(_,O,q,re){this.isEmpty()||(q&&(this.layoutVertexBuffer=_.createVertexBuffer(this.layoutVertexArray,eh.members),this.indexBuffer=_.createIndexBuffer(this.indexArray,O),this.dynamicLayoutVertexBuffer=_.createVertexBuffer(this.dynamicLayoutVertexArray,V0.members,!0),this.opacityVertexBuffer=_.createVertexBuffer(this.opacityVertexArray,dg,!0),this.opacityVertexBuffer.itemSize=1),(q||re)&&this.programConfigurations.upload(_))},Au.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Xr("SymbolBuffers",Au);var nc=function(_,O,q){this.layoutVertexArray=new _,this.layoutAttributes=O,this.indexArray=new q,this.segments=new Ft,this.collisionVertexArray=new tl};nc.prototype.upload=function(_){this.layoutVertexBuffer=_.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=_.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=_.createVertexBuffer(this.collisionVertexArray,H0.members,!0)},nc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Xr("CollisionBuffers",nc);var hi=function(_){this.collisionBoxArray=_.collisionBoxArray,this.zoom=_.zoom,this.overscaling=_.overscaling,this.layers=_.layers,this.layerIds=this.layers.map(function(Ae){return Ae.id}),this.index=_.index,this.pixelRatio=_.pixelRatio,this.sourceLayerIndex=_.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Yu([]),this.placementViewportMatrix=Yu([]);var O=this.layers[0]._unevaluatedLayout._values;this.textSizeData=nh(this.zoom,O["text-size"]),this.iconSizeData=nh(this.zoom,O["icon-size"]);var q=this.layers[0].layout,re=q.get("symbol-sort-key"),fe=q.get("symbol-z-order");this.sortFeaturesByKey=fe!=="viewport-y"&&re.constantOr(1)!==void 0;var me=fe==="viewport-y"||fe==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=me&&(q.get("text-allow-overlap")||q.get("icon-allow-overlap")||q.get("text-ignore-placement")||q.get("icon-ignore-placement")),q.get("symbol-placement")==="point"&&(this.writingModes=q.get("text-writing-mode").map(function(Ae){return Cs[Ae]})),this.stateDependentLayerIds=this.layers.filter(function(Ae){return Ae.isStateDependent()}).map(function(Ae){return Ae.id}),this.sourceID=_.sourceID};hi.prototype.createArrays=function(){this.text=new Au(new di(eh.members,this.layers,this.zoom,function(_){return/^text/.test(_)})),this.icon=new Au(new di(eh.members,this.layers,this.zoom,function(_){return/^icon/.test(_)})),this.glyphOffsetArray=new bt,this.lineVertexArray=new Ct,this.symbolInstances=new nt},hi.prototype.calculateGlyphDependencies=function(_,O,q,re,fe){for(var me=0;me<_.length;me++)if(O[_.charCodeAt(me)]=!0,(q||re)&&fe){var Ae=ec[_.charAt(me)];Ae&&(O[Ae.charCodeAt(0)]=!0)}},hi.prototype.populate=function(_,O,q){var re=this.layers[0],fe=re.layout,me=fe.get("text-font"),Ae=fe.get("text-field"),De=fe.get("icon-image"),Ze=(Ae.value.kind!=="constant"||Ae.value.value instanceof Rr&&!Ae.value.value.isEmpty()||Ae.value.value.toString().length>0)&&(me.value.kind!=="constant"||me.value.value.length>0),ut=De.value.kind!=="constant"||!!De.value.value||Object.keys(De.parameters).length>0,gt=fe.get("symbol-sort-key");if(this.features=[],Ze||ut){for(var Bt=O.iconDependencies,Wt=O.glyphDependencies,Ht=O.availableImages,ar=new ii(this.zoom),gr=0,Cr=_;gr<Cr.length;gr+=1){var Er=Cr[gr],Fr=Er.feature,Br=Er.id,Hr=Er.index,fn=Er.sourceLayerIndex,xn=re._featureFilter.needGeometry,Nn={type:Fr.type,id:Br,properties:Fr.properties,geometry:xn?bi(Fr):[]};if(re._featureFilter.filter(ar,Nn,q)){xn||(Nn.geometry=bi(Fr));var Fn=void 0;if(Ze){var qn=re.getValueAndResolveTokens("text-field",Nn,q,Ht),na=Rr.factory(qn);gg(na)&&(this.hasRTLText=!0),(!this.hasRTLText||Zi()==="unavailable"||this.hasRTLText&&yo.isParsed())&&(Fn=q0(na,re,Nn))}var ia=void 0;if(ut){var Zn=re.getValueAndResolveTokens("icon-image",Nn,q,Ht);ia=Zn instanceof _r?Zn:_r.fromString(Zn)}if(Fn||ia){var ha=this.sortFeaturesByKey?gt.evaluate(Nn,{},q):void 0,ca={id:Br,text:Fn,icon:ia,index:Hr,sourceLayerIndex:fn,geometry:bi(Fr),properties:Fr.properties,type:pg[Fr.type],sortKey:ha};if(this.features.push(ca),ia&&(Bt[ia.name]=!0),Fn){var oa=me.evaluate(Nn,{},q).join(","),$a=fe.get("text-rotation-alignment")==="map"&&fe.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Cs.vertical)>=0;for(var Va=0,ri=Fn.sections;Va<ri.length;Va+=1){var _a=ri[Va];if(_a.image)Bt[_a.image.name]=!0;else{var Ya=Da(Fn.toString()),wi=_a.fontStack||oa,gi=Wt[wi]=Wt[wi]||{};this.calculateGlyphDependencies(_a.text,gi,$a,this.allowVerticalPlacement,Ya)}}}}}}fe.get("symbol-placement")==="line"&&(this.features=function(Ii){var mi={},ho={},Oi=[],Wo=0;function Oo(Ui){Oi.push(Ii[Ui]),Wo++}function Ro(Ui,Di,si){var Wi=ho[Ui];return delete ho[Ui],ho[Di]=Wi,Oi[Wi].geometry[0].pop(),Oi[Wi].geometry[0]=Oi[Wi].geometry[0].concat(si[0]),Wi}function os(Ui,Di,si){var Wi=mi[Di];return delete mi[Di],mi[Ui]=Wi,Oi[Wi].geometry[0].shift(),Oi[Wi].geometry[0]=si[0].concat(Oi[Wi].geometry[0]),Wi}function Jo(Ui,Di,si){var Wi=si?Di[0][Di[0].length-1]:Di[0][0];return Ui+":"+Wi.x+":"+Wi.y}for(var po=0;po<Ii.length;po++){var Fo=Ii[po],eo=Fo.geometry,xo=Fo.text?Fo.text.toString():null;if(xo){var Ra=Jo(xo,eo),ei=Jo(xo,eo,!0);if(Ra in ho&&ei in mi&&ho[Ra]!==mi[ei]){var qi=os(Ra,ei,eo),Yi=Ro(Ra,ei,Oi[qi].geometry);delete mi[Ra],delete ho[ei],ho[Jo(xo,Oi[Yi].geometry,!0)]=Yi,Oi[qi].geometry=null}else Ra in ho?Ro(Ra,ei,eo):ei in mi?os(Ra,ei,eo):(Oo(po),mi[Ra]=Wo-1,ho[ei]=Wo-1)}else Oo(po)}return Oi.filter(function(Ui){return Ui.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ii,mi){return Ii.sortKey-mi.sortKey})}},hi.prototype.update=function(_,O,q){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(_,O,this.layers,q),this.icon.programConfigurations.updatePaintArrays(_,O,this.layers,q))},hi.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},hi.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},hi.prototype.upload=function(_){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(_),this.iconCollisionBox.upload(_)),this.text.upload(_,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(_,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},hi.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},hi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},hi.prototype.addToLineVertexArray=function(_,O){var q=this.lineVertexArray.length;if(_.segment!==void 0){for(var re=_.dist(O[_.segment+1]),fe=_.dist(O[_.segment]),me={},Ae=_.segment+1;Ae<O.length;Ae++)me[Ae]={x:O[Ae].x,y:O[Ae].y,tileUnitDistanceFromAnchor:re},Ae<O.length-1&&(re+=O[Ae+1].dist(O[Ae]));for(var De=_.segment||0;De>=0;De--)me[De]={x:O[De].x,y:O[De].y,tileUnitDistanceFromAnchor:fe},De>0&&(fe+=O[De-1].dist(O[De]));for(var Ze=0;Ze<O.length;Ze++){var ut=me[Ze];this.lineVertexArray.emplaceBack(ut.x,ut.y,ut.tileUnitDistanceFromAnchor)}}return{lineStartIndex:q,lineLength:this.lineVertexArray.length-q}},hi.prototype.addSymbols=function(_,O,q,re,fe,me,Ae,De,Ze,ut,gt,Bt){for(var Wt=_.indexArray,Ht=_.layoutVertexArray,ar=_.segments.prepareSegment(4*O.length,Ht,Wt,me.sortKey),gr=this.glyphOffsetArray.length,Cr=ar.vertexLength,Er=this.allowVerticalPlacement&&Ae===Cs.vertical?Math.PI/2:0,Fr=me.text&&me.text.sections,Br=0;Br<O.length;Br++){var Hr=O[Br],fn=Hr.tl,xn=Hr.tr,Nn=Hr.bl,Fn=Hr.br,qn=Hr.tex,na=Hr.pixelOffsetTL,ia=Hr.pixelOffsetBR,Zn=Hr.minFontScaleX,ha=Hr.minFontScaleY,ca=Hr.glyphOffset,oa=Hr.isSDF,$a=Hr.sectionIndex,Va=ar.vertexLength,ri=ca[1];Gc(Ht,De.x,De.y,fn.x,ri+fn.y,qn.x,qn.y,q,oa,na.x,na.y,Zn,ha),Gc(Ht,De.x,De.y,xn.x,ri+xn.y,qn.x+qn.w,qn.y,q,oa,ia.x,na.y,Zn,ha),Gc(Ht,De.x,De.y,Nn.x,ri+Nn.y,qn.x,qn.y+qn.h,q,oa,na.x,ia.y,Zn,ha),Gc(Ht,De.x,De.y,Fn.x,ri+Fn.y,qn.x+qn.w,qn.y+qn.h,q,oa,ia.x,ia.y,Zn,ha),oh(_.dynamicLayoutVertexArray,De,Er),Wt.emplaceBack(Va,Va+1,Va+2),Wt.emplaceBack(Va+1,Va+2,Va+3),ar.vertexLength+=4,ar.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ca[0]),Br!==O.length-1&&$a===O[Br+1].sectionIndex||_.programConfigurations.populatePaintArrays(Ht.length,me,me.index,{},Bt,Fr&&Fr[$a])}_.placedSymbolArray.emplaceBack(De.x,De.y,gr,this.glyphOffsetArray.length-gr,Cr,Ze,ut,De.segment,q?q[0]:0,q?q[1]:0,re[0],re[1],Ae,0,!1,0,gt)},hi.prototype._addCollisionDebugVertex=function(_,O,q,re,fe,me){return O.emplaceBack(0,0),_.emplaceBack(q.x,q.y,re,fe,Math.round(me.x),Math.round(me.y))},hi.prototype.addCollisionDebugVertices=function(_,O,q,re,fe,me,Ae){var De=fe.segments.prepareSegment(4,fe.layoutVertexArray,fe.indexArray),Ze=De.vertexLength,ut=fe.layoutVertexArray,gt=fe.collisionVertexArray,Bt=Ae.anchorX,Wt=Ae.anchorY;this._addCollisionDebugVertex(ut,gt,me,Bt,Wt,new u(_,O)),this._addCollisionDebugVertex(ut,gt,me,Bt,Wt,new u(q,O)),this._addCollisionDebugVertex(ut,gt,me,Bt,Wt,new u(q,re)),this._addCollisionDebugVertex(ut,gt,me,Bt,Wt,new u(_,re)),De.vertexLength+=4;var Ht=fe.indexArray;Ht.emplaceBack(Ze,Ze+1),Ht.emplaceBack(Ze+1,Ze+2),Ht.emplaceBack(Ze+2,Ze+3),Ht.emplaceBack(Ze+3,Ze),De.primitiveLength+=4},hi.prototype.addDebugCollisionBoxes=function(_,O,q,re){for(var fe=_;fe<O;fe++){var me=this.collisionBoxArray.get(fe),Ae=me.x1,De=me.y1,Ze=me.x2,ut=me.y2;this.addCollisionDebugVertices(Ae,De,Ze,ut,re?this.textCollisionBox:this.iconCollisionBox,me.anchorPoint,q)}},hi.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new nc(Bs,dp.members,F),this.iconCollisionBox=new nc(Bs,dp.members,F);for(var _=0;_<this.symbolInstances.length;_++){var O=this.symbolInstances.get(_);this.addDebugCollisionBoxes(O.textBoxStartIndex,O.textBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.verticalTextBoxStartIndex,O.verticalTextBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.iconBoxStartIndex,O.iconBoxEndIndex,O,!1),this.addDebugCollisionBoxes(O.verticalIconBoxStartIndex,O.verticalIconBoxEndIndex,O,!1)}},hi.prototype._deserializeCollisionBoxesForSymbol=function(_,O,q,re,fe,me,Ae,De,Ze){for(var ut={},gt=O;gt<q;gt++){var Bt=_.get(gt);ut.textBox={x1:Bt.x1,y1:Bt.y1,x2:Bt.x2,y2:Bt.y2,anchorPointX:Bt.anchorPointX,anchorPointY:Bt.anchorPointY},ut.textFeatureIndex=Bt.featureIndex;break}for(var Wt=re;Wt<fe;Wt++){var Ht=_.get(Wt);ut.verticalTextBox={x1:Ht.x1,y1:Ht.y1,x2:Ht.x2,y2:Ht.y2,anchorPointX:Ht.anchorPointX,anchorPointY:Ht.anchorPointY},ut.verticalTextFeatureIndex=Ht.featureIndex;break}for(var ar=me;ar<Ae;ar++){var gr=_.get(ar);ut.iconBox={x1:gr.x1,y1:gr.y1,x2:gr.x2,y2:gr.y2,anchorPointX:gr.anchorPointX,anchorPointY:gr.anchorPointY},ut.iconFeatureIndex=gr.featureIndex;break}for(var Cr=De;Cr<Ze;Cr++){var Er=_.get(Cr);ut.verticalIconBox={x1:Er.x1,y1:Er.y1,x2:Er.x2,y2:Er.y2,anchorPointX:Er.anchorPointX,anchorPointY:Er.anchorPointY},ut.verticalIconFeatureIndex=Er.featureIndex;break}return ut},hi.prototype.deserializeCollisionBoxes=function(_){this.collisionArrays=[];for(var O=0;O<this.symbolInstances.length;O++){var q=this.symbolInstances.get(O);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(_,q.textBoxStartIndex,q.textBoxEndIndex,q.verticalTextBoxStartIndex,q.verticalTextBoxEndIndex,q.iconBoxStartIndex,q.iconBoxEndIndex,q.verticalIconBoxStartIndex,q.verticalIconBoxEndIndex))}},hi.prototype.hasTextData=function(){return this.text.segments.get().length>0},hi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},hi.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},hi.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},hi.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},hi.prototype.addIndicesForPlacedSymbol=function(_,O){for(var q=_.placedSymbolArray.get(O),re=q.vertexStartIndex+4*q.numGlyphs,fe=q.vertexStartIndex;fe<re;fe+=4)_.indexArray.emplaceBack(fe,fe+1,fe+2),_.indexArray.emplaceBack(fe+1,fe+2,fe+3)},hi.prototype.getSortedSymbolIndexes=function(_){if(this.sortedAngle===_&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var O=Math.sin(_),q=Math.cos(_),re=[],fe=[],me=[],Ae=0;Ae<this.symbolInstances.length;++Ae){me.push(Ae);var De=this.symbolInstances.get(Ae);re.push(0|Math.round(O*De.anchorX+q*De.anchorY)),fe.push(De.featureIndex)}return me.sort(function(Ze,ut){return re[Ze]-re[ut]||fe[ut]-fe[Ze]}),me},hi.prototype.addToSortKeyRanges=function(_,O){var q=this.sortKeyRanges[this.sortKeyRanges.length-1];q&&q.sortKey===O?q.symbolInstanceEnd=_+1:this.sortKeyRanges.push({sortKey:O,symbolInstanceStart:_,symbolInstanceEnd:_+1})},hi.prototype.sortFeatures=function(_){var O=this;if(this.sortFeaturesByY&&this.sortedAngle!==_&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(_),this.sortedAngle=_,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var q=0,re=this.symbolInstanceIndexes;q<re.length;q+=1){var fe=re[q],me=this.symbolInstances.get(fe);this.featureSortOrder.push(me.featureIndex),[me.rightJustifiedTextSymbolIndex,me.centerJustifiedTextSymbolIndex,me.leftJustifiedTextSymbolIndex].forEach(function(Ae,De,Ze){Ae>=0&&Ze.indexOf(Ae)===De&&O.addIndicesForPlacedSymbol(O.text,Ae)}),me.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,me.verticalPlacedTextSymbolIndex),me.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,me.placedIconSymbolIndex),me.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,me.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Xr("SymbolBucket",hi,{omit:["layers","collisionBoxArray","features","compareText"]}),hi.MAX_GLYPHS=65535,hi.addDynamicAttributes=oh;var mg=new Go({"symbol-placement":new la(Pe.layout_symbol["symbol-placement"]),"symbol-spacing":new la(Pe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new la(Pe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ya(Pe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new la(Pe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new la(Pe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new la(Pe.layout_symbol["icon-ignore-placement"]),"icon-optional":new la(Pe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new la(Pe.layout_symbol["icon-rotation-alignment"]),"icon-size":new ya(Pe.layout_symbol["icon-size"]),"icon-text-fit":new la(Pe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new la(Pe.layout_symbol["icon-text-fit-padding"]),"icon-image":new ya(Pe.layout_symbol["icon-image"]),"icon-rotate":new ya(Pe.layout_symbol["icon-rotate"]),"icon-padding":new la(Pe.layout_symbol["icon-padding"]),"icon-keep-upright":new la(Pe.layout_symbol["icon-keep-upright"]),"icon-offset":new ya(Pe.layout_symbol["icon-offset"]),"icon-anchor":new ya(Pe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new la(Pe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new la(Pe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new la(Pe.layout_symbol["text-rotation-alignment"]),"text-field":new ya(Pe.layout_symbol["text-field"]),"text-font":new ya(Pe.layout_symbol["text-font"]),"text-size":new ya(Pe.layout_symbol["text-size"]),"text-max-width":new ya(Pe.layout_symbol["text-max-width"]),"text-line-height":new la(Pe.layout_symbol["text-line-height"]),"text-letter-spacing":new ya(Pe.layout_symbol["text-letter-spacing"]),"text-justify":new ya(Pe.layout_symbol["text-justify"]),"text-radial-offset":new ya(Pe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new la(Pe.layout_symbol["text-variable-anchor"]),"text-anchor":new ya(Pe.layout_symbol["text-anchor"]),"text-max-angle":new la(Pe.layout_symbol["text-max-angle"]),"text-writing-mode":new la(Pe.layout_symbol["text-writing-mode"]),"text-rotate":new ya(Pe.layout_symbol["text-rotate"]),"text-padding":new la(Pe.layout_symbol["text-padding"]),"text-keep-upright":new la(Pe.layout_symbol["text-keep-upright"]),"text-transform":new ya(Pe.layout_symbol["text-transform"]),"text-offset":new ya(Pe.layout_symbol["text-offset"]),"text-allow-overlap":new la(Pe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new la(Pe.layout_symbol["text-ignore-placement"]),"text-optional":new la(Pe.layout_symbol["text-optional"])}),sh={paint:new Go({"icon-opacity":new ya(Pe.paint_symbol["icon-opacity"]),"icon-color":new ya(Pe.paint_symbol["icon-color"]),"icon-halo-color":new ya(Pe.paint_symbol["icon-halo-color"]),"icon-halo-width":new ya(Pe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ya(Pe.paint_symbol["icon-halo-blur"]),"icon-translate":new la(Pe.paint_symbol["icon-translate"]),"icon-translate-anchor":new la(Pe.paint_symbol["icon-translate-anchor"]),"text-opacity":new ya(Pe.paint_symbol["text-opacity"]),"text-color":new ya(Pe.paint_symbol["text-color"],{runtimeType:Ut,getOverride:function(_){return _.textColor},hasOverride:function(_){return!!_.textColor}}),"text-halo-color":new ya(Pe.paint_symbol["text-halo-color"]),"text-halo-width":new ya(Pe.paint_symbol["text-halo-width"]),"text-halo-blur":new ya(Pe.paint_symbol["text-halo-blur"]),"text-translate":new la(Pe.paint_symbol["text-translate"]),"text-translate-anchor":new la(Pe.paint_symbol["text-translate-anchor"])}),layout:mg},Mu=function(_){this.type=_.property.overrides?_.property.overrides.runtimeType:xt,this.defaultValue=_};Mu.prototype.evaluate=function(_){if(_.formattedSection){var O=this.defaultValue.property.overrides;if(O&&O.hasOverride(_.formattedSection))return O.getOverride(_.formattedSection)}return _.feature&&_.featureState?this.defaultValue.evaluate(_.feature,_.featureState):this.defaultValue.property.specification.default},Mu.prototype.eachChild=function(_){this.defaultValue.isConstant()||_(this.defaultValue.value._styleExpression.expression)},Mu.prototype.outputDefined=function(){return!1},Mu.prototype.serialize=function(){return null},Xr("FormatSectionOverride",Mu,{omit:["defaultValue"]});var vg=function(_){function O(q){_.call(this,q,sh)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.recalculate=function(q,re){if(_.prototype.recalculate.call(this,q,re),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var fe=this.layout.get("text-writing-mode");if(fe){for(var me=[],Ae=0,De=fe;Ae<De.length;Ae+=1){var Ze=De[Ae];me.indexOf(Ze)<0&&me.push(Ze)}this.layout._values["text-writing-mode"]=me}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},O.prototype.getValueAndResolveTokens=function(q,re,fe,me){var Ae=this.layout.get(q).evaluate(re,{},fe,me),De=this._unevaluatedLayout._values[q];return De.isDataDriven()||$t(De.value)||!Ae?Ae:function(Ze,ut){return ut.replace(/{([^{}]+)}/g,function(gt,Bt){return Bt in Ze?String(Ze[Bt]):""})}(re.properties,Ae)},O.prototype.createBucket=function(q){return new hi(q)},O.prototype.queryRadius=function(){return 0},O.prototype.queryIntersectsFeature=function(){return!1},O.prototype._setPaintOverrides=function(){for(var q=0,re=sh.paint.overridableProperties;q<re.length;q+=1){var fe=re[q];if(O.hasPaintOverride(this.layout,fe)){var me=this.paint.get(fe),Ae=new Mu(me),De=new Zt(Ae,me.property.specification),Ze=null;Ze=me.value.kind==="constant"||me.value.kind==="source"?new nr("source",De):new cr("composite",De,me.value.zoomStops,me.value._interpolationType),this.paint._values[fe]=new ji(me.property,Ze,me.parameters)}}},O.prototype._handleOverridablePaintPropertyUpdate=function(q,re,fe){return!(!this.layout||re.isDataDriven()||fe.isDataDriven())&&O.hasPaintOverride(this.layout,q)},O.hasPaintOverride=function(q,re){var fe=q.get("text-field"),me=sh.paint.properties[re],Ae=!1,De=function(gt){for(var Bt=0,Wt=gt;Bt<Wt.length;Bt+=1){var Ht=Wt[Bt];if(me.overrides&&me.overrides.hasOverride(Ht))return void(Ae=!0)}};if(fe.value.kind==="constant"&&fe.value.value instanceof Rr)De(fe.value.value.sections);else if(fe.value.kind==="source"){var Ze=function(gt){if(!Ae)if(gt instanceof On&&pn(gt.value)===wt){var Bt=gt.value;De(Bt.sections)}else gt instanceof Pr?De(gt.sections):gt.eachChild(Ze)},ut=fe.value;ut._styleExpression&&Ze(ut._styleExpression.expression)}return Ae},O}(is),yg={paint:new Go({"background-color":new la(Pe.paint_background["background-color"]),"background-pattern":new vl(Pe.paint_background["background-pattern"]),"background-opacity":new la(Pe.paint_background["background-opacity"])})},xg=function(_){function O(q){_.call(this,q,yg)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O}(is),bg={paint:new Go({"raster-opacity":new la(Pe.paint_raster["raster-opacity"]),"raster-hue-rotate":new la(Pe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new la(Pe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new la(Pe.paint_raster["raster-brightness-max"]),"raster-saturation":new la(Pe.paint_raster["raster-saturation"]),"raster-contrast":new la(Pe.paint_raster["raster-contrast"]),"raster-resampling":new la(Pe.paint_raster["raster-resampling"]),"raster-fade-duration":new la(Pe.paint_raster["raster-fade-duration"])})},_g=function(_){function O(q){_.call(this,q,bg)}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O}(is),wg=function(_){function O(q){_.call(this,q,{}),this.implementation=q}return _&&(O.__proto__=_),O.prototype=Object.create(_&&_.prototype),O.prototype.constructor=O,O.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},O.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},O.prototype.recalculate=function(){},O.prototype.updateTransitions=function(){},O.prototype.hasTransition=function(){},O.prototype.serialize=function(){},O.prototype.onAdd=function(q){this.implementation.onAdd&&this.implementation.onAdd(q,q.painter.context.gl)},O.prototype.onRemove=function(q){this.implementation.onRemove&&this.implementation.onRemove(q,q.painter.context.gl)},O}(is),Tg={circle:l0,heatmap:c0,hillshade:h0,fill:E0,"fill-extrusion":F0,line:U0,symbol:vg,background:xg,raster:_g},Fp=self.HTMLImageElement,Bp=self.HTMLCanvasElement,Np=self.HTMLVideoElement,jp=self.ImageData,qc=self.ImageBitmap,ru=function(_,O,q,re){this.context=_,this.format=q,this.texture=_.gl.createTexture(),this.update(O,re)};ru.prototype.update=function(_,O,q){var re=_.width,fe=_.height,me=!(this.size&&this.size[0]===re&&this.size[1]===fe||q),Ae=this.context,De=Ae.gl;if(this.useMipmap=Boolean(O&&O.useMipmap),De.bindTexture(De.TEXTURE_2D,this.texture),Ae.pixelStoreUnpackFlipY.set(!1),Ae.pixelStoreUnpack.set(1),Ae.pixelStoreUnpackPremultiplyAlpha.set(this.format===De.RGBA&&(!O||O.premultiply!==!1)),me)this.size=[re,fe],_ instanceof Fp||_ instanceof Bp||_ instanceof Np||_ instanceof jp||qc&&_ instanceof qc?De.texImage2D(De.TEXTURE_2D,0,this.format,this.format,De.UNSIGNED_BYTE,_):De.texImage2D(De.TEXTURE_2D,0,this.format,re,fe,0,this.format,De.UNSIGNED_BYTE,_.data);else{var Ze=q||{x:0,y:0},ut=Ze.x,gt=Ze.y;_ instanceof Fp||_ instanceof Bp||_ instanceof Np||_ instanceof jp||qc&&_ instanceof qc?De.texSubImage2D(De.TEXTURE_2D,0,ut,gt,De.RGBA,De.UNSIGNED_BYTE,_):De.texSubImage2D(De.TEXTURE_2D,0,ut,gt,re,fe,De.RGBA,De.UNSIGNED_BYTE,_.data)}this.useMipmap&&this.isSizePowerOfTwo()&&De.generateMipmap(De.TEXTURE_2D)},ru.prototype.bind=function(_,O,q){var re=this.context.gl;re.bindTexture(re.TEXTURE_2D,this.texture),q!==re.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(q=re.LINEAR),_!==this.filter&&(re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MAG_FILTER,_),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MIN_FILTER,q||_),this.filter=_),O!==this.wrap&&(re.texParameteri(re.TEXTURE_2D,re.TEXTURE_WRAP_S,O),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_WRAP_T,O),this.wrap=O)},ru.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},ru.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var lh=function(_){var O=this;this._callback=_,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){O._triggered=!1,O._callback()})};lh.prototype.trigger=function(){var _=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){_._triggered=!1,_._callback()},0))},lh.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Su=function(_,O,q){this.target=_,this.parent=O,this.mapId=q,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},x(["receive","process"],this),this.invoker=new lh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=P()?_:self};function Up(_,O,q){var re=2*Math.PI*6378137/256/Math.pow(2,q);return[_*re-2*Math.PI*6378137/2,O*re-2*Math.PI*6378137/2]}Su.prototype.send=function(_,O,q,re,fe){var me=this;fe===void 0&&(fe=!1);var Ae=Math.round(1e18*Math.random()).toString(36).substring(0,10);q&&(this.callbacks[Ae]=q);var De=U(this.globalScope)?void 0:[];return this.target.postMessage({id:Ae,type:_,hasCallback:!!q,targetMapId:re,mustQueue:fe,sourceMapId:this.mapId,data:Jn(O,De)},De),{cancel:function(){q&&delete me.callbacks[Ae],me.target.postMessage({id:Ae,type:"<cancel>",targetMapId:re,sourceMapId:me.mapId})}}},Su.prototype.receive=function(_){var O=_.data,q=O.id;if(q&&(!O.targetMapId||this.mapId===O.targetMapId))if(O.type==="<cancel>"){delete this.tasks[q];var re=this.cancelCallbacks[q];delete this.cancelCallbacks[q],re&&re()}else P()||O.mustQueue?(this.tasks[q]=O,this.taskQueue.push(q),this.invoker.trigger()):this.processTask(q,O)},Su.prototype.process=function(){if(this.taskQueue.length){var _=this.taskQueue.shift(),O=this.tasks[_];delete this.tasks[_],this.taskQueue.length&&this.invoker.trigger(),O&&this.processTask(_,O)}},Su.prototype.processTask=function(_,O){var q=this;if(O.type==="<response>"){var re=this.callbacks[_];delete this.callbacks[_],re&&(O.error?re(Ta(O.error)):re(null,Ta(O.data)))}else{var fe=!1,me=U(this.globalScope)?void 0:[],Ae=O.hasCallback?function(gt,Bt){fe=!0,delete q.cancelCallbacks[_],q.target.postMessage({id:_,type:"<response>",sourceMapId:q.mapId,error:gt?Jn(gt):null,data:Jn(Bt,me)},me)}:function(gt){fe=!0},De=null,Ze=Ta(O.data);if(this.parent[O.type])De=this.parent[O.type](O.sourceMapId,Ze,Ae);else if(this.parent.getWorkerSource){var ut=O.type.split(".");De=this.parent.getWorkerSource(O.sourceMapId,ut[0],Ze.source)[ut[1]](Ze,Ae)}else Ae(new Error("Could not find function "+O.type));!fe&&De&&De.cancel&&(this.cancelCallbacks[_]=De.cancel)}},Su.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var co=function(_,O){_&&(O?this.setSouthWest(_).setNorthEast(O):_.length===4?this.setSouthWest([_[0],_[1]]).setNorthEast([_[2],_[3]]):this.setSouthWest(_[0]).setNorthEast(_[1]))};co.prototype.setNorthEast=function(_){return this._ne=_ instanceof Pi?new Pi(_.lng,_.lat):Pi.convert(_),this},co.prototype.setSouthWest=function(_){return this._sw=_ instanceof Pi?new Pi(_.lng,_.lat):Pi.convert(_),this},co.prototype.extend=function(_){var O,q,re=this._sw,fe=this._ne;if(_ instanceof Pi)O=_,q=_;else{if(!(_ instanceof co)){if(Array.isArray(_)){if(_.length===4||_.every(Array.isArray)){var me=_;return this.extend(co.convert(me))}var Ae=_;return this.extend(Pi.convert(Ae))}return this}if(O=_._sw,q=_._ne,!O||!q)return this}return re||fe?(re.lng=Math.min(O.lng,re.lng),re.lat=Math.min(O.lat,re.lat),fe.lng=Math.max(q.lng,fe.lng),fe.lat=Math.max(q.lat,fe.lat)):(this._sw=new Pi(O.lng,O.lat),this._ne=new Pi(q.lng,q.lat)),this},co.prototype.getCenter=function(){return new Pi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},co.prototype.getSouthWest=function(){return this._sw},co.prototype.getNorthEast=function(){return this._ne},co.prototype.getNorthWest=function(){return new Pi(this.getWest(),this.getNorth())},co.prototype.getSouthEast=function(){return new Pi(this.getEast(),this.getSouth())},co.prototype.getWest=function(){return this._sw.lng},co.prototype.getSouth=function(){return this._sw.lat},co.prototype.getEast=function(){return this._ne.lng},co.prototype.getNorth=function(){return this._ne.lat},co.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},co.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},co.prototype.isEmpty=function(){return!(this._sw&&this._ne)},co.prototype.contains=function(_){var O=Pi.convert(_),q=O.lng,re=O.lat,fe=this._sw.lat<=re&&re<=this._ne.lat,me=this._sw.lng<=q&&q<=this._ne.lng;return this._sw.lng>this._ne.lng&&(me=this._sw.lng>=q&&q>=this._ne.lng),fe&&me},co.convert=function(_){return!_||_ instanceof co?_:new co(_)};var Pi=function(_,O){if(isNaN(_)||isNaN(O))throw new Error("Invalid LngLat object: ("+_+", "+O+")");if(this.lng=+_,this.lat=+O,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Pi.prototype.wrap=function(){return new Pi(a(this.lng,-180,180),this.lat)},Pi.prototype.toArray=function(){return[this.lng,this.lat]},Pi.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Pi.prototype.distanceTo=function(_){var O=Math.PI/180,q=this.lat*O,re=_.lat*O,fe=Math.sin(q)*Math.sin(re)+Math.cos(q)*Math.cos(re)*Math.cos((_.lng-this.lng)*O);return 63710088e-1*Math.acos(Math.min(fe,1))},Pi.prototype.toBounds=function(_){_===void 0&&(_=0);var O=360*_/40075017,q=O/Math.cos(Math.PI/180*this.lat);return new co(new Pi(this.lng-q,this.lat-O),new Pi(this.lng+q,this.lat+O))},Pi.convert=function(_){if(_ instanceof Pi)return _;if(Array.isArray(_)&&(_.length===2||_.length===3))return new Pi(Number(_[0]),Number(_[1]));if(!Array.isArray(_)&&typeof _=="object"&&_!==null)return new Pi(Number("lng"in _?_.lng:_.lon),Number(_.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Vp=2*Math.PI*63710088e-1;function Hp(_){return Vp*Math.cos(_*Math.PI/180)}function Gp(_){return(180+_)/360}function qp(_){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+_*Math.PI/360)))/360}function Yp(_,O){return _/Hp(O)}function uh(_){var O=180-360*_;return 360/Math.PI*Math.atan(Math.exp(O*Math.PI/180))-90}var nu=function(_,O,q){q===void 0&&(q=0),this.x=+_,this.y=+O,this.z=+q};nu.fromLngLat=function(_,O){O===void 0&&(O=0);var q=Pi.convert(_);return new nu(Gp(q.lng),qp(q.lat),Yp(O,q.lat))},nu.prototype.toLngLat=function(){return new Pi(360*this.x-180,uh(this.y))},nu.prototype.toAltitude=function(){return _=this.z,O=this.y,_*Hp(uh(O));var _,O},nu.prototype.meterInMercatorCoordinateUnits=function(){return 1/Vp*(_=uh(this.y),1/Math.cos(_*Math.PI/180));var _};var au=function(_,O,q){this.z=_,this.x=O,this.y=q,this.key=ac(0,_,_,O,q)};au.prototype.equals=function(_){return this.z===_.z&&this.x===_.x&&this.y===_.y},au.prototype.url=function(_,O){var q,re,fe,me,Ae,De=(q=this.x,re=this.y,fe=this.z,me=Up(256*q,256*(re=Math.pow(2,fe)-re-1),fe),Ae=Up(256*(q+1),256*(re+1),fe),me[0]+","+me[1]+","+Ae[0]+","+Ae[1]),Ze=function(ut,gt,Bt){for(var Wt,Ht="",ar=ut;ar>0;ar--)Ht+=(gt&(Wt=1<<ar-1)?1:0)+(Bt&Wt?2:0);return Ht}(this.z,this.x,this.y);return _[(this.x+this.y)%_.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(O==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",Ze).replace("{bbox-epsg-3857}",De)},au.prototype.getTilePoint=function(_){var O=Math.pow(2,this.z);return new u(8192*(_.x*O-this.x),8192*(_.y*O-this.y))},au.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Wp=function(_,O){this.wrap=_,this.canonical=O,this.key=ac(_,O.z,O.z,O.x,O.y)},fo=function(_,O,q,re,fe){this.overscaledZ=_,this.wrap=O,this.canonical=new au(q,+re,+fe),this.key=ac(O,_,q,re,fe)};function ac(_,O,q,re,fe){(_*=2)<0&&(_=-1*_-1);var me=1<<q;return(me*me*_+me*fe+re).toString(36)+q.toString(36)+O.toString(36)}fo.prototype.equals=function(_){return this.overscaledZ===_.overscaledZ&&this.wrap===_.wrap&&this.canonical.equals(_.canonical)},fo.prototype.scaledTo=function(_){var O=this.canonical.z-_;return _>this.canonical.z?new fo(_,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new fo(_,this.wrap,_,this.canonical.x>>O,this.canonical.y>>O)},fo.prototype.calculateScaledKey=function(_,O){var q=this.canonical.z-_;return _>this.canonical.z?ac(this.wrap*+O,_,this.canonical.z,this.canonical.x,this.canonical.y):ac(this.wrap*+O,_,_,this.canonical.x>>q,this.canonical.y>>q)},fo.prototype.isChildOf=function(_){if(_.wrap!==this.wrap)return!1;var O=this.canonical.z-_.canonical.z;return _.overscaledZ===0||_.overscaledZ<this.overscaledZ&&_.canonical.x===this.canonical.x>>O&&_.canonical.y===this.canonical.y>>O},fo.prototype.children=function(_){if(this.overscaledZ>=_)return[new fo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var O=this.canonical.z+1,q=2*this.canonical.x,re=2*this.canonical.y;return[new fo(O,this.wrap,O,q,re),new fo(O,this.wrap,O,q+1,re),new fo(O,this.wrap,O,q,re+1),new fo(O,this.wrap,O,q+1,re+1)]},fo.prototype.isLessThan=function(_){return this.wrap<_.wrap||!(this.wrap>_.wrap)&&(this.overscaledZ<_.overscaledZ||!(this.overscaledZ>_.overscaledZ)&&(this.canonical.x<_.canonical.x||!(this.canonical.x>_.canonical.x)&&this.canonical.y<_.canonical.y))},fo.prototype.wrapped=function(){return new fo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},fo.prototype.unwrapTo=function(_){return new fo(this.overscaledZ,_,this.canonical.z,this.canonical.x,this.canonical.y)},fo.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},fo.prototype.toUnwrapped=function(){return new Wp(this.wrap,this.canonical)},fo.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},fo.prototype.getTilePoint=function(_){return this.canonical.getTilePoint(new nu(_.x-this.wrap,_.y))},Xr("CanonicalTileID",au),Xr("OverscaledTileID",fo,{omit:["posMatrix"]});var Ml=function(_,O,q){if(this.uid=_,O.height!==O.width)throw new RangeError("DEM tiles must be square");if(q&&q!=="mapbox"&&q!=="terrarium")return k('"'+q+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=O.height;var re=this.dim=O.height-2;this.data=new Uint32Array(O.data.buffer),this.encoding=q||"mapbox";for(var fe=0;fe<re;fe++)this.data[this._idx(-1,fe)]=this.data[this._idx(0,fe)],this.data[this._idx(re,fe)]=this.data[this._idx(re-1,fe)],this.data[this._idx(fe,-1)]=this.data[this._idx(fe,0)],this.data[this._idx(fe,re)]=this.data[this._idx(fe,re-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(re,-1)]=this.data[this._idx(re-1,0)],this.data[this._idx(-1,re)]=this.data[this._idx(0,re-1)],this.data[this._idx(re,re)]=this.data[this._idx(re-1,re-1)]};Ml.prototype.get=function(_,O){var q=new Uint8Array(this.data.buffer),re=4*this._idx(_,O);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(q[re],q[re+1],q[re+2])},Ml.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Ml.prototype._idx=function(_,O){if(_<-1||_>=this.dim+1||O<-1||O>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(O+1)*this.stride+(_+1)},Ml.prototype._unpackMapbox=function(_,O,q){return(256*_*256+256*O+q)/10-1e4},Ml.prototype._unpackTerrarium=function(_,O,q){return 256*_+O+q/256-32768},Ml.prototype.getPixels=function(){return new hs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Ml.prototype.backfillBorder=function(_,O,q){if(this.dim!==_.dim)throw new Error("dem dimension mismatch");var re=O*this.dim,fe=O*this.dim+this.dim,me=q*this.dim,Ae=q*this.dim+this.dim;switch(O){case-1:re=fe-1;break;case 1:fe=re+1}switch(q){case-1:me=Ae-1;break;case 1:Ae=me+1}for(var De=-O*this.dim,Ze=-q*this.dim,ut=me;ut<Ae;ut++)for(var gt=re;gt<fe;gt++)this.data[this._idx(gt,ut)]=_.data[this._idx(gt+De,ut+Ze)]},Xr("DEMData",Ml);var Yc=function(_){this._stringToNumber={},this._numberToString=[];for(var O=0;O<_.length;O++){var q=_[O];this._stringToNumber[q]=O,this._numberToString[O]=q}};Yc.prototype.encode=function(_){return this._stringToNumber[_]},Yc.prototype.decode=function(_){return this._numberToString[_]};var Wc=function(_,O,q,re,fe){this.type="Feature",this._vectorTileFeature=_,_._z=O,_._x=q,_._y=re,this.properties=_.properties,this.id=fe},ch={geometry:{configurable:!0}};ch.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},ch.geometry.set=function(_){this._geometry=_},Wc.prototype.toJSON=function(){var _={geometry:this.geometry};for(var O in this)O!=="_geometry"&&O!=="_vectorTileFeature"&&(_[O]=this[O]);return _},Object.defineProperties(Wc.prototype,ch);var Eu=function(){this.state={},this.stateChanges={},this.deletedStates={}};Eu.prototype.updateState=function(_,O,q){var re=String(O);if(this.stateChanges[_]=this.stateChanges[_]||{},this.stateChanges[_][re]=this.stateChanges[_][re]||{},g(this.stateChanges[_][re],q),this.deletedStates[_]===null)for(var fe in this.deletedStates[_]={},this.state[_])fe!==re&&(this.deletedStates[_][fe]=null);else if(this.deletedStates[_]&&this.deletedStates[_][re]===null)for(var me in this.deletedStates[_][re]={},this.state[_][re])q[me]||(this.deletedStates[_][re][me]=null);else for(var Ae in q)this.deletedStates[_]&&this.deletedStates[_][re]&&this.deletedStates[_][re][Ae]===null&&delete this.deletedStates[_][re][Ae]},Eu.prototype.removeFeatureState=function(_,O,q){if(this.deletedStates[_]!==null){var re=String(O);if(this.deletedStates[_]=this.deletedStates[_]||{},q&&O!==void 0)this.deletedStates[_][re]!==null&&(this.deletedStates[_][re]=this.deletedStates[_][re]||{},this.deletedStates[_][re][q]=null);else if(O!==void 0)if(this.stateChanges[_]&&this.stateChanges[_][re])for(q in this.deletedStates[_][re]={},this.stateChanges[_][re])this.deletedStates[_][re][q]=null;else this.deletedStates[_][re]=null;else this.deletedStates[_]=null}},Eu.prototype.getState=function(_,O){var q=String(O),re=this.state[_]||{},fe=this.stateChanges[_]||{},me=g({},re[q],fe[q]);if(this.deletedStates[_]===null)return{};if(this.deletedStates[_]){var Ae=this.deletedStates[_][O];if(Ae===null)return{};for(var De in Ae)delete me[De]}return me},Eu.prototype.initializeTileState=function(_,O){_.setFeatureState(this.state,O)},Eu.prototype.coalesceChanges=function(_,O){var q={};for(var re in this.stateChanges){this.state[re]=this.state[re]||{};var fe={};for(var me in this.stateChanges[re])this.state[re][me]||(this.state[re][me]={}),g(this.state[re][me],this.stateChanges[re][me]),fe[me]=this.state[re][me];q[re]=fe}for(var Ae in this.deletedStates){this.state[Ae]=this.state[Ae]||{};var De={};if(this.deletedStates[Ae]===null)for(var Ze in this.state[Ae])De[Ze]={},this.state[Ae][Ze]={};else for(var ut in this.deletedStates[Ae]){if(this.deletedStates[Ae][ut]===null)this.state[Ae][ut]={};else for(var gt=0,Bt=Object.keys(this.deletedStates[Ae][ut]);gt<Bt.length;gt+=1){var Wt=Bt[gt];delete this.state[Ae][ut][Wt]}De[ut]=this.state[Ae][ut]}q[Ae]=q[Ae]||{},g(q[Ae],De)}if(this.stateChanges={},this.deletedStates={},Object.keys(q).length!==0)for(var Ht in _)_[Ht].setFeatureState(q,O)};var Sl=function(_,O){this.tileID=_,this.x=_.canonical.x,this.y=_.canonical.y,this.z=_.canonical.z,this.grid=new un(8192,16,0),this.grid3D=new un(8192,16,0),this.featureIndexArray=new At,this.promoteId=O};function Xp(_,O,q,re,fe){return A(_,function(me,Ae){var De=O instanceof xs?O.get(Ae):null;return De&&De.evaluate?De.evaluate(q,re,fe):De})}function Zp(_){for(var O=1/0,q=1/0,re=-1/0,fe=-1/0,me=0,Ae=_;me<Ae.length;me+=1){var De=Ae[me];O=Math.min(O,De.x),q=Math.min(q,De.y),re=Math.max(re,De.x),fe=Math.max(fe,De.y)}return{minX:O,minY:q,maxX:re,maxY:fe}}function kg(_,O){return O-_}Sl.prototype.insert=function(_,O,q,re,fe,me){var Ae=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(q,re,fe);for(var De=me?this.grid3D:this.grid,Ze=0;Ze<O.length;Ze++){for(var ut=O[Ze],gt=[1/0,1/0,-1/0,-1/0],Bt=0;Bt<ut.length;Bt++){var Wt=ut[Bt];gt[0]=Math.min(gt[0],Wt.x),gt[1]=Math.min(gt[1],Wt.y),gt[2]=Math.max(gt[2],Wt.x),gt[3]=Math.max(gt[3],Wt.y)}gt[0]<8192&&gt[1]<8192&&gt[2]>=0&&gt[3]>=0&&De.insert(Ae,gt[0],gt[1],gt[2],gt[3])}},Sl.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new yu.VectorTile(new zc(this.rawTileData)).layers,this.sourceLayerCoder=new Yc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Sl.prototype.query=function(_,O,q,re){var fe=this;this.loadVTLayers();for(var me=_.params||{},Ae=8192/_.tileSize/_.scale,De=ka(me.filter),Ze=_.queryGeometry,ut=_.queryPadding*Ae,gt=Zp(Ze),Bt=this.grid.query(gt.minX-ut,gt.minY-ut,gt.maxX+ut,gt.maxY+ut),Wt=Zp(_.cameraQueryGeometry),Ht=this.grid3D.query(Wt.minX-ut,Wt.minY-ut,Wt.maxX+ut,Wt.maxY+ut,function(fn,xn,Nn,Fn){return function(qn,na,ia,Zn,ha){for(var ca=0,oa=qn;ca<oa.length;ca+=1){var $a=oa[ca];if(na<=$a.x&&ia<=$a.y&&Zn>=$a.x&&ha>=$a.y)return!0}var Va=[new u(na,ia),new u(na,ha),new u(Zn,ha),new u(Zn,ia)];if(qn.length>2){for(var ri=0,_a=Va;ri<_a.length;ri+=1)if(_s(qn,_a[ri]))return!0}for(var Ya=0;Ya<qn.length-1;Ya++)if(Ql(qn[Ya],qn[Ya+1],Va))return!0;return!1}(_.cameraQueryGeometry,fn-ut,xn-ut,Nn+ut,Fn+ut)}),ar=0,gr=Ht;ar<gr.length;ar+=1){var Cr=gr[ar];Bt.push(Cr)}Bt.sort(kg);for(var Er,Fr={},Br=function(fn){var xn=Bt[fn];if(xn!==Er){Er=xn;var Nn=fe.featureIndexArray.get(xn),Fn=null;fe.loadMatchingFeature(Fr,Nn.bucketIndex,Nn.sourceLayerIndex,Nn.featureIndex,De,me.layers,me.availableImages,O,q,re,function(qn,na,ia){return Fn||(Fn=bi(qn)),na.queryIntersectsFeature(Ze,qn,ia,Fn,fe.z,_.transform,Ae,_.pixelPosMatrix)})}},Hr=0;Hr<Bt.length;Hr++)Br(Hr);return Fr},Sl.prototype.loadMatchingFeature=function(_,O,q,re,fe,me,Ae,De,Ze,ut,gt){var Bt=this.bucketLayerIDs[O];if(!me||function(Nn,Fn){for(var qn=0;qn<Nn.length;qn++)if(Fn.indexOf(Nn[qn])>=0)return!0;return!1}(me,Bt)){var Wt=this.sourceLayerCoder.decode(q),Ht=this.vtLayers[Wt].feature(re);if(fe.filter(new ii(this.tileID.overscaledZ),Ht))for(var ar=this.getId(Ht,Wt),gr=0;gr<Bt.length;gr++){var Cr=Bt[gr];if(!(me&&me.indexOf(Cr)<0)){var Er=De[Cr];if(Er){var Fr={};ar!==void 0&&ut&&(Fr=ut.getState(Er.sourceLayer||"_geojsonTileLayer",ar));var Br=Ze[Cr];Br.paint=Xp(Br.paint,Er.paint,Ht,Fr,Ae),Br.layout=Xp(Br.layout,Er.layout,Ht,Fr,Ae);var Hr=!gt||gt(Ht,Er,Fr);if(Hr){var fn=new Wc(Ht,this.z,this.x,this.y,ar);fn.layer=Br;var xn=_[Cr];xn===void 0&&(xn=_[Cr]=[]),xn.push({featureIndex:re,feature:fn,intersectionZ:Hr})}}}}}},Sl.prototype.lookupSymbolFeatures=function(_,O,q,re,fe,me,Ae,De){var Ze={};this.loadVTLayers();for(var ut=ka(fe),gt=0,Bt=_;gt<Bt.length;gt+=1){var Wt=Bt[gt];this.loadMatchingFeature(Ze,q,re,Wt,ut,me,Ae,De,O)}return Ze},Sl.prototype.hasLayer=function(_){for(var O=0,q=this.bucketLayerIDs;O<q.length;O+=1)for(var re=0,fe=q[O];re<fe.length;re+=1)if(_===fe[re])return!0;return!1},Sl.prototype.getId=function(_,O){var q=_.id;if(this.promoteId){var re=typeof this.promoteId=="string"?this.promoteId:this.promoteId[O];typeof(q=_.properties[re])=="boolean"&&(q=Number(q))}return q},Xr("FeatureIndex",Sl,{omit:["rawTileData","sourceLayerCoder"]});var Io=function(_,O){this.tileID=_,this.uid=y(),this.uses=0,this.tileSize=O,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Io.prototype.registerFadeDuration=function(_){var O=_+this.timeAdded;O<j.now()||this.fadeEndTime&&O<this.fadeEndTime||(this.fadeEndTime=O)},Io.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Io.prototype.loadVectorData=function(_,O,q){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",_){for(var re in _.featureIndex&&(this.latestFeatureIndex=_.featureIndex,_.rawTileData?(this.latestRawTileData=_.rawTileData,this.latestFeatureIndex.rawTileData=_.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=_.collisionBoxArray,this.buckets=function(ut,gt){var Bt={};if(!gt)return Bt;for(var Wt=function(){var gr=ar[Ht],Cr=gr.layerIds.map(function(Hr){return gt.getLayer(Hr)}).filter(Boolean);if(Cr.length!==0){gr.layers=Cr,gr.stateDependentLayerIds&&(gr.stateDependentLayers=gr.stateDependentLayerIds.map(function(Hr){return Cr.filter(function(fn){return fn.id===Hr})[0]}));for(var Er=0,Fr=Cr;Er<Fr.length;Er+=1){var Br=Fr[Er];Bt[Br.id]=gr}}},Ht=0,ar=ut;Ht<ar.length;Ht+=1)Wt();return Bt}(_.buckets,O.style),this.hasSymbolBuckets=!1,this.buckets){var fe=this.buckets[re];if(fe instanceof hi){if(this.hasSymbolBuckets=!0,!q)break;fe.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var me in this.buckets){var Ae=this.buckets[me];if(Ae instanceof hi&&Ae.hasRTLText){this.hasRTLText=!0,yo.isLoading()||yo.isLoaded()||Zi()!=="deferred"||ai();break}}for(var De in this.queryPadding=0,this.buckets){var Ze=this.buckets[De];this.queryPadding=Math.max(this.queryPadding,O.style.getLayer(De).queryRadius(Ze))}_.imageAtlas&&(this.imageAtlas=_.imageAtlas),_.glyphAtlasImage&&(this.glyphAtlasImage=_.glyphAtlasImage)}else this.collisionBoxArray=new ye},Io.prototype.unloadVectorData=function(){for(var _ in this.buckets)this.buckets[_].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Io.prototype.getBucket=function(_){return this.buckets[_.id]},Io.prototype.upload=function(_){for(var O in this.buckets){var q=this.buckets[O];q.uploadPending()&&q.upload(_)}var re=_.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ru(_,this.imageAtlas.image,re.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ru(_,this.glyphAtlasImage,re.ALPHA),this.glyphAtlasImage=null)},Io.prototype.prepare=function(_){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(_,this.imageAtlasTexture)},Io.prototype.queryRenderedFeatures=function(_,O,q,re,fe,me,Ae,De,Ze,ut){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:re,cameraQueryGeometry:fe,scale:me,tileSize:this.tileSize,pixelPosMatrix:ut,transform:De,params:Ae,queryPadding:this.queryPadding*Ze},_,O,q):{}},Io.prototype.querySourceFeatures=function(_,O){var q=this.latestFeatureIndex;if(q&&q.rawTileData){var re=q.loadVTLayers(),fe=O?O.sourceLayer:"",me=re._geojsonTileLayer||re[fe];if(me)for(var Ae=ka(O&&O.filter),De=this.tileID.canonical,Ze=De.z,ut=De.x,gt=De.y,Bt={z:Ze,x:ut,y:gt},Wt=0;Wt<me.length;Wt++){var Ht=me.feature(Wt);if(Ae.filter(new ii(this.tileID.overscaledZ),Ht)){var ar=q.getId(Ht,fe),gr=new Wc(Ht,Ze,ut,gt,ar);gr.tile=Bt,_.push(gr)}}}},Io.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Io.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Io.prototype.setExpiryData=function(_){var O=this.expirationTime;if(_.cacheControl){var q=D(_.cacheControl);q["max-age"]&&(this.expirationTime=Date.now()+1e3*q["max-age"])}else _.expires&&(this.expirationTime=new Date(_.expires).getTime());if(this.expirationTime){var re=Date.now(),fe=!1;if(this.expirationTime>re)fe=!1;else if(O)if(this.expirationTime<O)fe=!0;else{var me=this.expirationTime-O;me?this.expirationTime=re+Math.max(me,3e4):fe=!0}else fe=!0;fe?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Io.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Io.prototype.setFeatureState=function(_,O){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(_).length!==0){var q=this.latestFeatureIndex.loadVTLayers();for(var re in this.buckets)if(O.style.hasLayer(re)){var fe=this.buckets[re],me=fe.layers[0].sourceLayer||"_geojsonTileLayer",Ae=q[me],De=_[me];if(Ae&&De&&Object.keys(De).length!==0){fe.update(De,Ae,this.imageAtlas&&this.imageAtlas.patternPositions||{});var Ze=O&&O.style&&O.style.getLayer(re);Ze&&(this.queryPadding=Math.max(this.queryPadding,Ze.queryRadius(fe)))}}}},Io.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Io.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<j.now()},Io.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Io.prototype.setHoldDuration=function(_){this.symbolFadeHoldUntil=j.now()+_},Io.prototype.setDependencies=function(_,O){for(var q={},re=0,fe=O;re<fe.length;re+=1)q[fe[re]]=!0;this.dependencies[_]=q},Io.prototype.hasDependency=function(_,O){for(var q=0,re=_;q<re.length;q+=1){var fe=re[q],me=this.dependencies[fe];if(me){for(var Ae=0,De=O;Ae<De.length;Ae+=1)if(me[De[Ae]])return!0}}return!1};var Bl=self.performance,Kp=function(_){this._marks={start:[_.url,"start"].join("#"),end:[_.url,"end"].join("#"),measure:_.url.toString()},Bl.mark(this._marks.start)};Kp.prototype.finish=function(){Bl.mark(this._marks.end);var _=Bl.getEntriesByName(this._marks.measure);return _.length===0&&(Bl.measure(this._marks.measure,this._marks.start,this._marks.end),_=Bl.getEntriesByName(this._marks.measure),Bl.clearMarks(this._marks.start),Bl.clearMarks(this._marks.end),Bl.clearMeasures(this._marks.measure)),_},e.Actor=Su,e.AlphaImage=tu,e.CanonicalTileID=au,e.CollisionBoxArray=ye,e.Color=ur,e.DEMData=Ml,e.DataConstantProperty=la,e.DictionaryCoder=Yc,e.EXTENT=8192,e.ErrorEvent=Ce,e.EvaluationParameters=ii,e.Event=_e,e.Evented=Le,e.FeatureIndex=Sl,e.FillBucket=rl,e.FillExtrusionBucket=nl,e.ImageAtlas=rc,e.ImagePosition=Fc,e.LineBucket=ps,e.LngLat=Pi,e.LngLatBounds=co,e.MercatorCoordinate=nu,e.ONE_EM=24,e.OverscaledTileID=fo,e.Point=u,e.Point$1=u,e.Properties=Go,e.Protobuf=zc,e.RGBAImage=hs,e.RequestManager=ae,e.RequestPerformance=Kp,e.ResourceType=ct,e.SegmentVector=Ft,e.SourceFeatureState=Eu,e.StructArrayLayout1ui2=V,e.StructArrayLayout2f1f2i16=Dl,e.StructArrayLayout2i4=Ss,e.StructArrayLayout3ui6=lo,e.StructArrayLayout4i8=zi,e.SymbolBucket=hi,e.Texture=ru,e.Tile=Io,e.Transitionable=ys,e.Uniform1f=Ur,e.Uniform1i=ua,e.Uniform2f=kn,e.Uniform3f=Xn,e.Uniform4f=Gn,e.UniformColor=ea,e.UniformMatrix4f=Ma,e.UnwrappedTileID=Wp,e.ValidationError=Xe,e.WritingMode=Cs,e.ZoomHistory=Ca,e.add=function(_,O,q){return _[0]=O[0]+q[0],_[1]=O[1]+q[1],_[2]=O[2]+q[2],_},e.addDynamicAttributes=oh,e.asyncAll=function(_,O,q){if(!_.length)return q(null,[]);var re=_.length,fe=new Array(_.length),me=null;_.forEach(function(Ae,De){O(Ae,function(Ze,ut){Ze&&(me=Ze),fe[De]=ut,--re==0&&q(me,fe)})})},e.bezier=i,e.bindAll=x,e.browser=j,e.cacheEntryPossiblyAdded=function(_){++et>Ye&&(_.getActor().send("enforceCacheSizeLimit",Fe),et=0)},e.clamp=n,e.clearTileCache=function(_){var O=self.caches.delete("mapbox-tiles");_&&O.catch(_).then(function(){return _()})},e.clipLine=Pp,e.clone=function(_){var O=new fs(16);return O[0]=_[0],O[1]=_[1],O[2]=_[2],O[3]=_[3],O[4]=_[4],O[5]=_[5],O[6]=_[6],O[7]=_[7],O[8]=_[8],O[9]=_[9],O[10]=_[10],O[11]=_[11],O[12]=_[12],O[13]=_[13],O[14]=_[14],O[15]=_[15],O},e.clone$1=w,e.clone$2=function(_){var O=new fs(3);return O[0]=_[0],O[1]=_[1],O[2]=_[2],O},e.collisionCircleLayout=G0,e.config=W,e.create=function(){var _=new fs(16);return fs!=Float32Array&&(_[1]=0,_[2]=0,_[3]=0,_[4]=0,_[6]=0,_[7]=0,_[8]=0,_[9]=0,_[11]=0,_[12]=0,_[13]=0,_[14]=0),_[0]=1,_[5]=1,_[10]=1,_[15]=1,_},e.create$1=function(){var _=new fs(9);return fs!=Float32Array&&(_[1]=0,_[2]=0,_[3]=0,_[5]=0,_[6]=0,_[7]=0),_[0]=1,_[4]=1,_[8]=1,_},e.create$2=function(){var _=new fs(4);return fs!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_},e.createCommonjsModule=f,e.createExpression=Yt,e.createLayout=oi,e.createStyleLayer=function(_){return _.type==="custom"?new wg(_):new Tg[_.type](_)},e.cross=function(_,O,q){var re=O[0],fe=O[1],me=O[2],Ae=q[0],De=q[1],Ze=q[2];return _[0]=fe*Ze-me*De,_[1]=me*Ae-re*Ze,_[2]=re*De-fe*Ae,_},e.deepEqual=function _(O,q){if(Array.isArray(O)){if(!Array.isArray(q)||O.length!==q.length)return!1;for(var re=0;re<O.length;re++)if(!_(O[re],q[re]))return!1;return!0}if(typeof O=="object"&&O!==null&&q!==null){if(typeof q!="object"||Object.keys(O).length!==Object.keys(q).length)return!1;for(var fe in O)if(!_(O[fe],q[fe]))return!1;return!0}return O===q},e.dot=function(_,O){return _[0]*O[0]+_[1]*O[1]+_[2]*O[2]},e.dot$1=function(_,O){return _[0]*O[0]+_[1]*O[1]+_[2]*O[2]+_[3]*O[3]},e.ease=c,e.emitValidationErrors=wn,e.endsWith=T,e.enforceCacheSizeLimit=function(_){rt(),xe&&xe.then(function(O){O.keys().then(function(q){for(var re=0;re<q.length-_;re++)O.delete(q[re])})})},e.evaluateSizeForFeature=Ap,e.evaluateSizeForZoom=Mp,e.evaluateVariableOffset=Dp,e.evented=Ei,e.extend=g,e.featureFilter=ka,e.filterObject=S,e.fromRotation=function(_,O){var q=Math.sin(O),re=Math.cos(O);return _[0]=re,_[1]=q,_[2]=0,_[3]=-q,_[4]=re,_[5]=0,_[6]=0,_[7]=0,_[8]=1,_},e.getAnchorAlignment=rh,e.getAnchorJustification=ih,e.getArrayBuffer=_t,e.getImage=He,e.getJSON=function(_,O){return tt(g(_,{type:"json"}),O)},e.getRTLTextPluginStatus=Zi,e.getReferrer=kt,e.getVideo=function(_,O){var q,re,fe=self.document.createElement("video");fe.muted=!0,fe.onloadstart=function(){O(null,fe)};for(var me=0;me<_.length;me++){var Ae=self.document.createElement("source");q=_[me],re=void 0,(re=self.document.createElement("a")).href=q,(re.protocol!==self.document.location.protocol||re.host!==self.document.location.host)&&(fe.crossOrigin="Anonymous"),Ae.src=_[me],fe.appendChild(Ae)}return{cancel:function(){}}},e.identity=Yu,e.invert=function(_,O){var q=O[0],re=O[1],fe=O[2],me=O[3],Ae=O[4],De=O[5],Ze=O[6],ut=O[7],gt=O[8],Bt=O[9],Wt=O[10],Ht=O[11],ar=O[12],gr=O[13],Cr=O[14],Er=O[15],Fr=q*De-re*Ae,Br=q*Ze-fe*Ae,Hr=q*ut-me*Ae,fn=re*Ze-fe*De,xn=re*ut-me*De,Nn=fe*ut-me*Ze,Fn=gt*gr-Bt*ar,qn=gt*Cr-Wt*ar,na=gt*Er-Ht*ar,ia=Bt*Cr-Wt*gr,Zn=Bt*Er-Ht*gr,ha=Wt*Er-Ht*Cr,ca=Fr*ha-Br*Zn+Hr*ia+fn*na-xn*qn+Nn*Fn;return ca?(ca=1/ca,_[0]=(De*ha-Ze*Zn+ut*ia)*ca,_[1]=(fe*Zn-re*ha-me*ia)*ca,_[2]=(gr*Nn-Cr*xn+Er*fn)*ca,_[3]=(Wt*xn-Bt*Nn-Ht*fn)*ca,_[4]=(Ze*na-Ae*ha-ut*qn)*ca,_[5]=(q*ha-fe*na+me*qn)*ca,_[6]=(Cr*Hr-ar*Nn-Er*Br)*ca,_[7]=(gt*Nn-Wt*Hr+Ht*Br)*ca,_[8]=(Ae*Zn-De*na+ut*Fn)*ca,_[9]=(re*na-q*Zn-me*Fn)*ca,_[10]=(ar*xn-gr*Hr+Er*Fr)*ca,_[11]=(Bt*Hr-gt*xn-Ht*Fr)*ca,_[12]=(De*qn-Ae*ia-Ze*Fn)*ca,_[13]=(q*ia-re*qn+fe*Fn)*ca,_[14]=(gr*Br-ar*fn-Cr*Fr)*ca,_[15]=(gt*fn-Bt*Br+Wt*Fr)*ca,_):null},e.isChar=Mn,e.isMapboxURL=he,e.keysDifference=function(_,O){var q=[];for(var re in _)re in O||q.push(re);return q},e.makeRequest=tt,e.mapObject=A,e.mercatorXfromLng=Gp,e.mercatorYfromLat=qp,e.mercatorZfromAltitude=Yp,e.mul=Vf,e.multiply=eu,e.mvt=yu,e.normalize=function(_,O){var q=O[0],re=O[1],fe=O[2],me=q*q+re*re+fe*fe;return me>0&&(me=1/Math.sqrt(me)),_[0]=O[0]*me,_[1]=O[1]*me,_[2]=O[2]*me,_},e.number=Yn,e.offscreenCanvasSupported=st,e.ortho=function(_,O,q,re,fe,me,Ae){var De=1/(O-q),Ze=1/(re-fe),ut=1/(me-Ae);return _[0]=-2*De,_[1]=0,_[2]=0,_[3]=0,_[4]=0,_[5]=-2*Ze,_[6]=0,_[7]=0,_[8]=0,_[9]=0,_[10]=2*ut,_[11]=0,_[12]=(O+q)*De,_[13]=(fe+re)*Ze,_[14]=(Ae+me)*ut,_[15]=1,_},e.parseGlyphPBF=function(_){return new zc(_).readFields(tg,[])},e.pbf=zc,e.performSymbolLayout=function(_,O,q,re,fe,me,Ae){_.createArrays();var De=512*_.overscaling;_.tilePixelRatio=8192/De,_.compareText={},_.iconsNeedLinear=!1;var Ze=_.layers[0].layout,ut=_.layers[0]._unevaluatedLayout._values,gt={};if(_.textSizeData.kind==="composite"){var Bt=_.textSizeData,Wt=Bt.minZoom,Ht=Bt.maxZoom;gt.compositeTextSizes=[ut["text-size"].possiblyEvaluate(new ii(Wt),Ae),ut["text-size"].possiblyEvaluate(new ii(Ht),Ae)]}if(_.iconSizeData.kind==="composite"){var ar=_.iconSizeData,gr=ar.minZoom,Cr=ar.maxZoom;gt.compositeIconSizes=[ut["icon-size"].possiblyEvaluate(new ii(gr),Ae),ut["icon-size"].possiblyEvaluate(new ii(Cr),Ae)]}gt.layoutTextSize=ut["text-size"].possiblyEvaluate(new ii(_.zoom+1),Ae),gt.layoutIconSize=ut["icon-size"].possiblyEvaluate(new ii(_.zoom+1),Ae),gt.textMaxSize=ut["text-size"].possiblyEvaluate(new ii(18));for(var Er=24*Ze.get("text-line-height"),Fr=Ze.get("text-rotation-alignment")==="map"&&Ze.get("symbol-placement")!=="point",Br=Ze.get("text-keep-upright"),Hr=Ze.get("text-size"),fn=function(){var Fn=Nn[xn],qn=Ze.get("text-font").evaluate(Fn,{},Ae).join(","),na=Hr.evaluate(Fn,{},Ae),ia=gt.layoutTextSize.evaluate(Fn,{},Ae),Zn=gt.layoutIconSize.evaluate(Fn,{},Ae),ha={horizontal:{},vertical:void 0},ca=Fn.text,oa=[0,0];if(ca){var $a=ca.toString(),Va=24*Ze.get("text-letter-spacing").evaluate(Fn,{},Ae),ri=function(Ra){for(var ei=0,qi=Ra;ei<qi.length;ei+=1)if(!Sa(qi[ei].charCodeAt(0)))return!1;return!0}($a)?Va:0,_a=Ze.get("text-anchor").evaluate(Fn,{},Ae),Ya=Ze.get("text-variable-anchor");if(!Ya){var wi=Ze.get("text-radial-offset").evaluate(Fn,{},Ae);oa=wi?Dp(_a,[24*wi,ah]):Ze.get("text-offset").evaluate(Fn,{},Ae).map(function(Ra){return 24*Ra})}var gi=Fr?"center":Ze.get("text-justify").evaluate(Fn,{},Ae),Ii=Ze.get("symbol-placement"),mi=Ii==="point"?24*Ze.get("text-max-width").evaluate(Fn,{},Ae):0,ho=function(){_.allowVerticalPlacement&&Da($a)&&(ha.vertical=Bc(ca,O,q,fe,qn,mi,Er,_a,"left",ri,oa,Cs.vertical,!0,Ii,ia,na))};if(!Fr&&Ya){for(var Oi=gi==="auto"?Ya.map(function(Ra){return ih(Ra)}):[gi],Wo=!1,Oo=0;Oo<Oi.length;Oo++){var Ro=Oi[Oo];if(!ha.horizontal[Ro])if(Wo)ha.horizontal[Ro]=ha.horizontal[0];else{var os=Bc(ca,O,q,fe,qn,mi,Er,"center",Ro,ri,oa,Cs.horizontal,!1,Ii,ia,na);os&&(ha.horizontal[Ro]=os,Wo=os.positionedLines.length===1)}}ho()}else{gi==="auto"&&(gi=ih(_a));var Jo=Bc(ca,O,q,fe,qn,mi,Er,_a,gi,ri,oa,Cs.horizontal,!1,Ii,ia,na);Jo&&(ha.horizontal[gi]=Jo),ho(),Da($a)&&Fr&&Br&&(ha.vertical=Bc(ca,O,q,fe,qn,mi,Er,_a,gi,ri,oa,Cs.vertical,!1,Ii,ia,na))}}var po=void 0,Fo=!1;if(Fn.icon&&Fn.icon.name){var eo=re[Fn.icon.name];eo&&(po=function(Ra,ei,qi){var Yi=rh(qi),Ui=Yi.horizontalAlign,Di=Yi.verticalAlign,si=ei[0],Wi=ei[1],ss=si-Ra.displaySize[0]*Ui,Ts=ss+Ra.displaySize[0],$o=Wi-Ra.displaySize[1]*Di;return{image:Ra,top:$o,bottom:$o+Ra.displaySize[1],left:ss,right:Ts}}(fe[Fn.icon.name],Ze.get("icon-offset").evaluate(Fn,{},Ae),Ze.get("icon-anchor").evaluate(Fn,{},Ae)),Fo=eo.sdf,_.sdfIcons===void 0?_.sdfIcons=eo.sdf:_.sdfIcons!==eo.sdf&&k("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(eo.pixelRatio!==_.pixelRatio||Ze.get("icon-rotate").constantOr(1)!==0)&&(_.iconsNeedLinear=!0))}var xo=Rp(ha.horizontal)||ha.vertical;_.iconsInText=!!xo&&xo.iconsInText,(xo||po)&&function(Ra,ei,qi,Yi,Ui,Di,si,Wi,ss,Ts,$o){var al=Di.textMaxSize.evaluate(ei,{});al===void 0&&(al=si);var El,Do=Ra.layers[0].layout,il=Do.get("icon-offset").evaluate(ei,{},$o),ol=Rp(qi.horizontal),sl=si/24,fh=Ra.tilePixelRatio*sl,Cu=Ra.tilePixelRatio*al/24,Xc=Ra.tilePixelRatio*Wi,iu=Ra.tilePixelRatio*Do.get("symbol-spacing"),Zc=Do.get("text-padding")*Ra.tilePixelRatio,Kc=Do.get("icon-padding")*Ra.tilePixelRatio,Jc=Do.get("text-max-angle")/180*Math.PI,$c=Do.get("text-rotation-alignment")==="map"&&Do.get("symbol-placement")!=="point",Nl=Do.get("icon-rotation-alignment")==="map"&&Do.get("symbol-placement")!=="point",Lu=Do.get("symbol-placement"),Qc=iu/2,Pu=Do.get("icon-text-fit");Yi&&Pu!=="none"&&(Ra.allowVerticalPlacement&&qi.vertical&&(El=kp(Yi,qi.vertical,Pu,Do.get("icon-text-fit-padding"),il,sl)),ol&&(Yi=kp(Yi,ol,Pu,Do.get("icon-text-fit-padding"),il,sl)));var jl=function(Mg,cc){cc.x<0||cc.x>=8192||cc.y<0||cc.y>=8192||function(Ji,ll,Sg,Ul,mh,ed,lf,xl,uf,fc,cf,ff,vh,td,hc,rd,nd,ad,id,od,Ls,hf,sd,bl,Eg){var yh,ou,Fu,Bu,Nu,ju=Ji.addToLineVertexArray(ll,Sg),ld=0,ud=0,cd=0,fd=0,xh=-1,bh=-1,Cl={},hd=Ar(""),_h=0,wh=0;if(xl._unevaluatedLayout.getValue("text-radial-offset")===void 0?(yh=xl.layout.get("text-offset").evaluate(Ls,{},bl).map(function(dc){return 24*dc}),_h=yh[0],wh=yh[1]):(_h=24*xl.layout.get("text-radial-offset").evaluate(Ls,{},bl),wh=ah),Ji.allowVerticalPlacement&&Ul.vertical){var pd=xl.layout.get("text-rotate").evaluate(Ls,{},bl)+90,Cg=Ul.vertical;Bu=new Hc(uf,ll,fc,cf,ff,Cg,vh,td,hc,pd),lf&&(Nu=new Hc(uf,ll,fc,cf,ff,lf,nd,ad,hc,pd))}if(mh){var Th=xl.layout.get("icon-rotate").evaluate(Ls,{}),dd=xl.layout.get("icon-text-fit")!=="none",gd=Ip(mh,Th,sd,dd),kh=lf?Ip(lf,Th,sd,dd):void 0;Fu=new Hc(uf,ll,fc,cf,ff,mh,nd,ad,!1,Th),ld=4*gd.length;var md=Ji.iconSizeData,pc=null;md.kind==="source"?(pc=[128*xl.layout.get("icon-size").evaluate(Ls,{})])[0]>32640&&k(Ji.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):md.kind==="composite"&&((pc=[128*hf.compositeIconSizes[0].evaluate(Ls,{},bl),128*hf.compositeIconSizes[1].evaluate(Ls,{},bl)])[0]>32640||pc[1]>32640)&&k(Ji.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ji.addSymbols(Ji.icon,gd,pc,od,id,Ls,!1,ll,ju.lineStartIndex,ju.lineLength,-1,bl),xh=Ji.icon.placedSymbolArray.length-1,kh&&(ud=4*kh.length,Ji.addSymbols(Ji.icon,kh,pc,od,id,Ls,Cs.vertical,ll,ju.lineStartIndex,ju.lineLength,-1,bl),bh=Ji.icon.placedSymbolArray.length-1)}for(var vd in Ul.horizontal){var pf=Ul.horizontal[vd];if(!ou){hd=Ar(pf.text);var Lg=xl.layout.get("text-rotate").evaluate(Ls,{},bl);ou=new Hc(uf,ll,fc,cf,ff,pf,vh,td,hc,Lg)}var yd=pf.positionedLines.length===1;if(cd+=zp(Ji,ll,pf,ed,xl,hc,Ls,rd,ju,Ul.vertical?Cs.horizontal:Cs.horizontalOnly,yd?Object.keys(Ul.horizontal):[vd],Cl,xh,hf,bl),yd)break}Ul.vertical&&(fd+=zp(Ji,ll,Ul.vertical,ed,xl,hc,Ls,rd,ju,Cs.vertical,["vertical"],Cl,bh,hf,bl));var Pg=ou?ou.boxStartIndex:Ji.collisionBoxArray.length,Ig=ou?ou.boxEndIndex:Ji.collisionBoxArray.length,Og=Bu?Bu.boxStartIndex:Ji.collisionBoxArray.length,Dg=Bu?Bu.boxEndIndex:Ji.collisionBoxArray.length,zg=Fu?Fu.boxStartIndex:Ji.collisionBoxArray.length,Rg=Fu?Fu.boxEndIndex:Ji.collisionBoxArray.length,Fg=Nu?Nu.boxStartIndex:Ji.collisionBoxArray.length,Bg=Nu?Nu.boxEndIndex:Ji.collisionBoxArray.length,_l=-1,df=function(dc,bd){return dc&&dc.circleDiameter?Math.max(dc.circleDiameter,bd):bd};_l=df(ou,_l),_l=df(Bu,_l),_l=df(Fu,_l);var xd=(_l=df(Nu,_l))>-1?1:0;xd&&(_l*=Eg/24),Ji.glyphOffsetArray.length>=hi.MAX_GLYPHS&&k("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ls.sortKey!==void 0&&Ji.addToSortKeyRanges(Ji.symbolInstances.length,Ls.sortKey),Ji.symbolInstances.emplaceBack(ll.x,ll.y,Cl.right>=0?Cl.right:-1,Cl.center>=0?Cl.center:-1,Cl.left>=0?Cl.left:-1,Cl.vertical||-1,xh,bh,hd,Pg,Ig,Og,Dg,zg,Rg,Fg,Bg,fc,cd,fd,ld,ud,xd,0,vh,_h,wh,_l)}(Ra,cc,Mg,qi,Yi,Ui,El,Ra.layers[0],Ra.collisionBoxArray,ei.index,ei.sourceLayerIndex,Ra.index,fh,Zc,$c,ss,Xc,Kc,Nl,il,ei,Di,Ts,$o,si)};if(Lu==="line")for(var ic=0,ef=Pp(ei.geometry,0,0,8192,8192);ic<ef.length;ic+=1)for(var tf=ef[ic],rf=lg(tf,iu,Jc,qi.vertical||ol,Yi,24,Cu,Ra.overscaling,8192),oc=0,nf=rf;oc<nf.length;oc+=1){var sc=nf[oc],af=ol;af&&hg(Ra,af.text,Qc,sc)||jl(tf,sc)}else if(Lu==="line-center")for(var lc=0,of=ei.geometry;lc<of.length;lc+=1){var Iu=of[lc];if(Iu.length>1){var Ou=sg(Iu,Jc,qi.vertical||ol,Yi,24,Cu);Ou&&jl(Iu,Ou)}}else if(ei.type==="Polygon")for(var Du=0,sf=Kf(ei.geometry,0);Du<sf.length;Du+=1){var zu=sf[Du],uc=cg(zu,16);jl(zu[0],new wu(uc.x,uc.y,0))}else if(ei.type==="LineString")for(var Ru=0,Jp=ei.geometry;Ru<Jp.length;Ru+=1){var hh=Jp[Ru];jl(hh,new wu(hh[0].x,hh[0].y,0))}else if(ei.type==="Point")for(var ph=0,$p=ei.geometry;ph<$p.length;ph+=1)for(var Ag=$p[ph],dh=0,Qp=Ag;dh<Qp.length;dh+=1){var gh=Qp[dh];jl([gh],new wu(gh.x,gh.y,0))}}(_,Fn,ha,po,re,gt,ia,Zn,oa,Fo,Ae)},xn=0,Nn=_.features;xn<Nn.length;xn+=1)fn();me&&_.generateCollisionDebugBuffers()},e.perspective=function(_,O,q,re,fe){var me,Ae=1/Math.tan(O/2);return _[0]=Ae/q,_[1]=0,_[2]=0,_[3]=0,_[4]=0,_[5]=Ae,_[6]=0,_[7]=0,_[8]=0,_[9]=0,_[11]=-1,_[12]=0,_[13]=0,_[15]=0,fe!=null&&fe!==1/0?(me=1/(re-fe),_[10]=(fe+re)*me,_[14]=2*fe*re*me):(_[10]=-1,_[14]=-2*re),_},e.pick=function(_,O){for(var q={},re=0;re<O.length;re++){var fe=O[re];fe in _&&(q[fe]=_[fe])}return q},e.plugin=yo,e.polygonIntersectsPolygon=Zo,e.postMapLoadEvent=ze,e.postTurnstileEvent=Me,e.potpack=bp,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.register=Xr,e.registerForPluginStateChange=function(_){return _({pluginStatus:va,pluginURL:xi}),Ei.on("pluginStateChange",_),_},e.rotate=function(_,O,q){var re=O[0],fe=O[1],me=O[2],Ae=O[3],De=Math.sin(q),Ze=Math.cos(q);return _[0]=re*Ze+me*De,_[1]=fe*Ze+Ae*De,_[2]=re*-De+me*Ze,_[3]=fe*-De+Ae*Ze,_},e.rotateX=function(_,O,q){var re=Math.sin(q),fe=Math.cos(q),me=O[4],Ae=O[5],De=O[6],Ze=O[7],ut=O[8],gt=O[9],Bt=O[10],Wt=O[11];return O!==_&&(_[0]=O[0],_[1]=O[1],_[2]=O[2],_[3]=O[3],_[12]=O[12],_[13]=O[13],_[14]=O[14],_[15]=O[15]),_[4]=me*fe+ut*re,_[5]=Ae*fe+gt*re,_[6]=De*fe+Bt*re,_[7]=Ze*fe+Wt*re,_[8]=ut*fe-me*re,_[9]=gt*fe-Ae*re,_[10]=Bt*fe-De*re,_[11]=Wt*fe-Ze*re,_},e.rotateZ=function(_,O,q){var re=Math.sin(q),fe=Math.cos(q),me=O[0],Ae=O[1],De=O[2],Ze=O[3],ut=O[4],gt=O[5],Bt=O[6],Wt=O[7];return O!==_&&(_[8]=O[8],_[9]=O[9],_[10]=O[10],_[11]=O[11],_[12]=O[12],_[13]=O[13],_[14]=O[14],_[15]=O[15]),_[0]=me*fe+ut*re,_[1]=Ae*fe+gt*re,_[2]=De*fe+Bt*re,_[3]=Ze*fe+Wt*re,_[4]=ut*fe-me*re,_[5]=gt*fe-Ae*re,_[6]=Bt*fe-De*re,_[7]=Wt*fe-Ze*re,_},e.scale=function(_,O,q){var re=q[0],fe=q[1],me=q[2];return _[0]=O[0]*re,_[1]=O[1]*re,_[2]=O[2]*re,_[3]=O[3]*re,_[4]=O[4]*fe,_[5]=O[5]*fe,_[6]=O[6]*fe,_[7]=O[7]*fe,_[8]=O[8]*me,_[9]=O[9]*me,_[10]=O[10]*me,_[11]=O[11]*me,_[12]=O[12],_[13]=O[13],_[14]=O[14],_[15]=O[15],_},e.scale$1=function(_,O,q){return _[0]=O[0]*q,_[1]=O[1]*q,_[2]=O[2]*q,_[3]=O[3]*q,_},e.scale$2=function(_,O,q){return _[0]=O[0]*q,_[1]=O[1]*q,_[2]=O[2]*q,_},e.setCacheLimits=function(_,O){Fe=_,Ye=O},e.setRTLTextPlugin=function(_,O,q){if(q===void 0&&(q=!1),va===Za||va===Gi||va===cs)throw new Error("setRTLTextPlugin cannot be called multiple times.");xi=j.resolveURL(_),va=Za,Eo=O,Ka(),q||ai()},e.sphericalToCartesian=function(_){var O=_[0],q=_[1],re=_[2];return q+=90,q*=Math.PI/180,re*=Math.PI/180,{x:O*Math.cos(q)*Math.sin(re),y:O*Math.sin(q)*Math.sin(re),z:O*Math.cos(re)}},e.sqrLen=Wu,e.styleSpec=Pe,e.sub=Hf,e.symbolSize=og,e.transformMat3=function(_,O,q){var re=O[0],fe=O[1],me=O[2];return _[0]=re*q[0]+fe*q[3]+me*q[6],_[1]=re*q[1]+fe*q[4]+me*q[7],_[2]=re*q[2]+fe*q[5]+me*q[8],_},e.transformMat4=gu,e.translate=function(_,O,q){var re,fe,me,Ae,De,Ze,ut,gt,Bt,Wt,Ht,ar,gr=q[0],Cr=q[1],Er=q[2];return O===_?(_[12]=O[0]*gr+O[4]*Cr+O[8]*Er+O[12],_[13]=O[1]*gr+O[5]*Cr+O[9]*Er+O[13],_[14]=O[2]*gr+O[6]*Cr+O[10]*Er+O[14],_[15]=O[3]*gr+O[7]*Cr+O[11]*Er+O[15]):(re=O[0],fe=O[1],me=O[2],Ae=O[3],De=O[4],Ze=O[5],ut=O[6],gt=O[7],Bt=O[8],Wt=O[9],Ht=O[10],ar=O[11],_[0]=re,_[1]=fe,_[2]=me,_[3]=Ae,_[4]=De,_[5]=Ze,_[6]=ut,_[7]=gt,_[8]=Bt,_[9]=Wt,_[10]=Ht,_[11]=ar,_[12]=re*gr+De*Cr+Bt*Er+O[12],_[13]=fe*gr+Ze*Cr+Wt*Er+O[13],_[14]=me*gr+ut*Cr+Ht*Er+O[14],_[15]=Ae*gr+gt*Cr+ar*Er+O[15]),_},e.triggerPluginCompletionEvent=Co,e.uniqueId=y,e.validateCustomStyleLayer=function(_){var O=[],q=_.id;return q===void 0&&O.push({message:"layers."+q+': missing required property "id"'}),_.render===void 0&&O.push({message:"layers."+q+': missing required method "render"'}),_.renderingMode&&_.renderingMode!=="2d"&&_.renderingMode!=="3d"&&O.push({message:"layers."+q+': property "renderingMode" must be either "2d" or "3d"'}),O},e.validateLight=ln,e.validateStyle=Yr,e.values=function(_){var O=[];for(var q in _)O.push(_[q]);return O},e.vectorTile=yu,e.version="1.10.1",e.warnOnce=k,e.webpSupported=ee,e.window=self,e.wrap=a}),h(0,function(e){function f(_e){var Ce=typeof _e;if(Ce==="number"||Ce==="boolean"||Ce==="string"||_e==null)return JSON.stringify(_e);if(Array.isArray(_e)){for(var Le="[",Pe=0,Xe=_e;Pe<Xe.length;Pe+=1)Le+=f(Xe[Pe])+",";return Le+"]"}for(var ht=Object.keys(_e).sort(),Mt="{",pt=0;pt<ht.length;pt++)Mt+=JSON.stringify(ht[pt])+":"+f(_e[ht[pt]])+",";return Mt+"}"}function l(_e){for(var Ce="",Le=0,Pe=e.refProperties;Le<Pe.length;Le+=1)Ce+="/"+f(_e[Pe[Le]]);return Ce}var o=function(_e){this.keyCache={},_e&&this.replace(_e)};o.prototype.replace=function(_e){this._layerConfigs={},this._layers={},this.update(_e,[])},o.prototype.update=function(_e,Ce){for(var Le=this,Pe=0,Xe=_e;Pe<Xe.length;Pe+=1){var ht=Xe[Pe];this._layerConfigs[ht.id]=ht;var Mt=this._layers[ht.id]=e.createStyleLayer(ht);Mt._featureFilter=e.featureFilter(Mt.filter),this.keyCache[ht.id]&&delete this.keyCache[ht.id]}for(var pt=0,Lt=Ce;pt<Lt.length;pt+=1){var vt=Lt[pt];delete this.keyCache[vt],delete this._layerConfigs[vt],delete this._layers[vt]}this.familiesBySource={};for(var Dt=0,xt=function(lt,wt){for(var Ot={},Gt=0;Gt<lt.length;Gt++){var ir=wt&&wt[lt[Gt].id]||l(lt[Gt]);wt&&(wt[lt[Gt].id]=ir);var Xt=Ot[ir];Xt||(Xt=Ot[ir]=[]),Xt.push(lt[Gt])}var Kt=[];for(var or in Ot)Kt.push(Ot[or]);return Kt}(e.values(this._layerConfigs),this.keyCache);Dt<xt.length;Dt+=1){var it=xt[Dt].map(function(lt){return Le._layers[lt.id]}),St=it[0];if(St.visibility!=="none"){var Nt=St.source||"",Ut=this.familiesBySource[Nt];Ut||(Ut=this.familiesBySource[Nt]={});var Qt=St.sourceLayer||"_geojsonTileLayer",Ie=Ut[Qt];Ie||(Ie=Ut[Qt]=[]),Ie.push(it)}}};var u=function(_e){var Ce={},Le=[];for(var Pe in _e){var Xe=_e[Pe],ht=Ce[Pe]={};for(var Mt in Xe){var pt=Xe[+Mt];if(pt&&pt.bitmap.width!==0&&pt.bitmap.height!==0){var Lt={x:0,y:0,w:pt.bitmap.width+2,h:pt.bitmap.height+2};Le.push(Lt),ht[Mt]={rect:Lt,metrics:pt.metrics}}}}var vt=e.potpack(Le),Dt=vt.w,xt=vt.h,it=new e.AlphaImage({width:Dt||1,height:xt||1});for(var St in _e){var Nt=_e[St];for(var Ut in Nt){var Qt=Nt[+Ut];if(Qt&&Qt.bitmap.width!==0&&Qt.bitmap.height!==0){var Ie=Ce[St][Ut].rect;e.AlphaImage.copy(Qt.bitmap,it,{x:0,y:0},{x:Ie.x+1,y:Ie.y+1},Qt.bitmap)}}}this.image=it,this.positions=Ce};e.register("GlyphAtlas",u);var s=function(_e){this.tileID=new e.OverscaledTileID(_e.tileID.overscaledZ,_e.tileID.wrap,_e.tileID.canonical.z,_e.tileID.canonical.x,_e.tileID.canonical.y),this.uid=_e.uid,this.zoom=_e.zoom,this.pixelRatio=_e.pixelRatio,this.tileSize=_e.tileSize,this.source=_e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=_e.showCollisionBoxes,this.collectResourceTiming=!!_e.collectResourceTiming,this.returnDependencies=!!_e.returnDependencies,this.promoteId=_e.promoteId};function i(_e,Ce,Le){for(var Pe=new e.EvaluationParameters(Ce),Xe=0,ht=_e;Xe<ht.length;Xe+=1)ht[Xe].recalculate(Pe,Le)}function c(_e,Ce){var Le=e.getArrayBuffer(_e.request,function(Pe,Xe,ht,Mt){Pe?Ce(Pe):Xe&&Ce(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(Xe)),rawData:Xe,cacheControl:ht,expires:Mt})});return function(){Le.cancel(),Ce()}}s.prototype.parse=function(_e,Ce,Le,Pe,Xe){var ht=this;this.status="parsing",this.data=_e,this.collisionBoxArray=new e.CollisionBoxArray;var Mt=new e.DictionaryCoder(Object.keys(_e.layers).sort()),pt=new e.FeatureIndex(this.tileID,this.promoteId);pt.bucketLayerIDs=[];var Lt,vt,Dt,xt,it={},St={featureIndex:pt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Le},Nt=Ce.familiesBySource[this.source];for(var Ut in Nt){var Qt=_e.layers[Ut];if(Qt){Qt.version===1&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+Ut+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ie=Mt.encode(Ut),lt=[],wt=0;wt<Qt.length;wt++){var Ot=Qt.feature(wt),Gt=pt.getId(Ot,Ut);lt.push({feature:Ot,id:Gt,index:wt,sourceLayerIndex:Ie})}for(var ir=0,Xt=Nt[Ut];ir<Xt.length;ir+=1){var Kt=Xt[ir],or=Kt[0];or.minzoom&&this.zoom<Math.floor(or.minzoom)||or.maxzoom&&this.zoom>=or.maxzoom||or.visibility!=="none"&&(i(Kt,this.zoom,Le),(it[or.id]=or.createBucket({index:pt.bucketLayerIDs.length,layers:Kt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ie,sourceID:this.source})).populate(lt,St,this.tileID.canonical),pt.bucketLayerIDs.push(Kt.map(function(br){return br.id})))}}}var dr=e.mapObject(St.glyphDependencies,function(br){return Object.keys(br).map(Number)});Object.keys(dr).length?Pe.send("getGlyphs",{uid:this.uid,stacks:dr},function(br,Rr){Lt||(Lt=br,vt=Rr,pr.call(ht))}):vt={};var vr=Object.keys(St.iconDependencies);vr.length?Pe.send("getImages",{icons:vr,source:this.source,tileID:this.tileID,type:"icons"},function(br,Rr){Lt||(Lt=br,Dt=Rr,pr.call(ht))}):Dt={};var ur=Object.keys(St.patternDependencies);function pr(){if(Lt)return Xe(Lt);if(vt&&Dt&&xt){var br=new u(vt),Rr=new e.ImageAtlas(Dt,xt);for(var _r in it){var jr=it[_r];jr instanceof e.SymbolBucket?(i(jr.layers,this.zoom,Le),e.performSymbolLayout(jr,vt,br.positions,Dt,Rr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):jr.hasPattern&&(jr instanceof e.LineBucket||jr instanceof e.FillBucket||jr instanceof e.FillExtrusionBucket)&&(i(jr.layers,this.zoom,Le),jr.addFeatures(St,this.tileID.canonical,Rr.patternPositions))}this.status="done",Xe(null,{buckets:e.values(it).filter(function($r){return!$r.isEmpty()}),featureIndex:pt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:br.image,imageAtlas:Rr,glyphMap:this.returnDependencies?vt:null,iconMap:this.returnDependencies?Dt:null,glyphPositions:this.returnDependencies?br.positions:null})}}ur.length?Pe.send("getImages",{icons:ur,source:this.source,tileID:this.tileID,type:"patterns"},function(br,Rr){Lt||(Lt=br,xt=Rr,pr.call(ht))}):xt={},pr.call(this)};var n=function(_e,Ce,Le,Pe){this.actor=_e,this.layerIndex=Ce,this.availableImages=Le,this.loadVectorData=Pe||c,this.loading={},this.loaded={}};n.prototype.loadTile=function(_e,Ce){var Le=this,Pe=_e.uid;this.loading||(this.loading={});var Xe=!!(_e&&_e.request&&_e.request.collectResourceTiming)&&new e.RequestPerformance(_e.request),ht=this.loading[Pe]=new s(_e);ht.abort=this.loadVectorData(_e,function(Mt,pt){if(delete Le.loading[Pe],Mt||!pt)return ht.status="done",Le.loaded[Pe]=ht,Ce(Mt);var Lt=pt.rawData,vt={};pt.expires&&(vt.expires=pt.expires),pt.cacheControl&&(vt.cacheControl=pt.cacheControl);var Dt={};if(Xe){var xt=Xe.finish();xt&&(Dt.resourceTiming=JSON.parse(JSON.stringify(xt)))}ht.vectorTile=pt.vectorTile,ht.parse(pt.vectorTile,Le.layerIndex,Le.availableImages,Le.actor,function(it,St){if(it||!St)return Ce(it);Ce(null,e.extend({rawTileData:Lt.slice(0)},St,vt,Dt))}),Le.loaded=Le.loaded||{},Le.loaded[Pe]=ht})},n.prototype.reloadTile=function(_e,Ce){var Le=this,Pe=this.loaded,Xe=_e.uid,ht=this;if(Pe&&Pe[Xe]){var Mt=Pe[Xe];Mt.showCollisionBoxes=_e.showCollisionBoxes;var pt=function(Lt,vt){var Dt=Mt.reloadCallback;Dt&&(delete Mt.reloadCallback,Mt.parse(Mt.vectorTile,ht.layerIndex,Le.availableImages,ht.actor,Dt)),Ce(Lt,vt)};Mt.status==="parsing"?Mt.reloadCallback=pt:Mt.status==="done"&&(Mt.vectorTile?Mt.parse(Mt.vectorTile,this.layerIndex,this.availableImages,this.actor,pt):pt())}},n.prototype.abortTile=function(_e,Ce){var Le=this.loading,Pe=_e.uid;Le&&Le[Pe]&&Le[Pe].abort&&(Le[Pe].abort(),delete Le[Pe]),Ce()},n.prototype.removeTile=function(_e,Ce){var Le=this.loaded,Pe=_e.uid;Le&&Le[Pe]&&delete Le[Pe],Ce()};var a=e.window.ImageBitmap,g=function(){this.loaded={}};g.prototype.loadTile=function(_e,Ce){var Le=_e.uid,Pe=_e.encoding,Xe=_e.rawImageData,ht=a&&Xe instanceof a?this.getImageData(Xe):Xe,Mt=new e.DEMData(Le,ht,Pe);this.loaded=this.loaded||{},this.loaded[Le]=Mt,Ce(null,Mt)},g.prototype.getImageData=function(_e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(_e.width,_e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=_e.width,this.offscreenCanvas.height=_e.height,this.offscreenCanvasContext.drawImage(_e,0,0,_e.width,_e.height);var Ce=this.offscreenCanvasContext.getImageData(-1,-1,_e.width+2,_e.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:Ce.width,height:Ce.height},Ce.data)},g.prototype.removeTile=function(_e){var Ce=this.loaded,Le=_e.uid;Ce&&Ce[Le]&&delete Ce[Le]};var p=function _e(Ce,Le){var Pe,Xe=Ce&&Ce.type;if(Xe==="FeatureCollection")for(Pe=0;Pe<Ce.features.length;Pe++)_e(Ce.features[Pe],Le);else if(Xe==="GeometryCollection")for(Pe=0;Pe<Ce.geometries.length;Pe++)_e(Ce.geometries[Pe],Le);else if(Xe==="Feature")_e(Ce.geometry,Le);else if(Xe==="Polygon")y(Ce.coordinates,Le);else if(Xe==="MultiPolygon")for(Pe=0;Pe<Ce.coordinates.length;Pe++)y(Ce.coordinates[Pe],Le);return Ce};function y(_e,Ce){if(_e.length!==0){v(_e[0],Ce);for(var Le=1;Le<_e.length;Le++)v(_e[Le],!Ce)}}function v(_e,Ce){for(var Le=0,Pe=0,Xe=_e.length,ht=Xe-1;Pe<Xe;ht=Pe++)Le+=(_e[Pe][0]-_e[ht][0])*(_e[ht][1]+_e[Pe][1]);Le>=0!=!!Ce&&_e.reverse()}var b=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,x=function(_e){this._feature=_e,this.extent=e.EXTENT,this.type=_e.type,this.properties=_e.tags,"id"in _e&&!isNaN(_e.id)&&(this.id=parseInt(_e.id,10))};x.prototype.loadGeometry=function(){if(this._feature.type===1){for(var _e=[],Ce=0,Le=this._feature.geometry;Ce<Le.length;Ce+=1){var Pe=Le[Ce];_e.push([new e.Point$1(Pe[0],Pe[1])])}return _e}for(var Xe=[],ht=0,Mt=this._feature.geometry;ht<Mt.length;ht+=1){for(var pt=[],Lt=0,vt=Mt[ht];Lt<vt.length;Lt+=1){var Dt=vt[Lt];pt.push(new e.Point$1(Dt[0],Dt[1]))}Xe.push(pt)}return Xe},x.prototype.toGeoJSON=function(_e,Ce,Le){return b.call(this,_e,Ce,Le)};var T=function(_e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=_e.length,this._features=_e};T.prototype.feature=function(_e){return new x(this._features[_e])};var A=e.vectorTile.VectorTileFeature,S=w;function w(_e,Ce){this.options=Ce||{},this.features=_e,this.length=_e.length}function E(_e,Ce){this.id=typeof _e.id=="number"?_e.id:void 0,this.type=_e.type,this.rawGeometry=_e.type===1?[_e.geometry]:_e.geometry,this.properties=_e.tags,this.extent=Ce||4096}w.prototype.feature=function(_e){return new E(this.features[_e],this.options.extent)},E.prototype.loadGeometry=function(){var _e=this.rawGeometry;this.geometry=[];for(var Ce=0;Ce<_e.length;Ce++){for(var Le=_e[Ce],Pe=[],Xe=0;Xe<Le.length;Xe++)Pe.push(new e.Point$1(Le[Xe][0],Le[Xe][1]));this.geometry.push(Pe)}return this.geometry},E.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var _e=this.geometry,Ce=1/0,Le=-1/0,Pe=1/0,Xe=-1/0,ht=0;ht<_e.length;ht++)for(var Mt=_e[ht],pt=0;pt<Mt.length;pt++){var Lt=Mt[pt];Ce=Math.min(Ce,Lt.x),Le=Math.max(Le,Lt.x),Pe=Math.min(Pe,Lt.y),Xe=Math.max(Xe,Lt.y)}return[Ce,Pe,Le,Xe]},E.prototype.toGeoJSON=A.prototype.toGeoJSON;var k=D,L=D,M=function(_e,Ce){Ce=Ce||{};var Le={};for(var Pe in _e)Le[Pe]=new S(_e[Pe].features,Ce),Le[Pe].name=Pe,Le[Pe].version=Ce.version,Le[Pe].extent=Ce.extent;return D({layers:Le})},P=S;function D(_e){var Ce=new e.pbf;return function(Le,Pe){for(var Xe in Le.layers)Pe.writeMessage(3,N,Le.layers[Xe])}(_e,Ce),Ce.finish()}function N(_e,Ce){var Le;Ce.writeVarintField(15,_e.version||1),Ce.writeStringField(1,_e.name||""),Ce.writeVarintField(5,_e.extent||4096);var Pe={keys:[],values:[],keycache:{},valuecache:{}};for(Le=0;Le<_e.length;Le++)Pe.feature=_e.feature(Le),Ce.writeMessage(2,U,Pe);var Xe=Pe.keys;for(Le=0;Le<Xe.length;Le++)Ce.writeStringField(3,Xe[Le]);var ht=Pe.values;for(Le=0;Le<ht.length;Le++)Ce.writeMessage(4,H,ht[Le])}function U(_e,Ce){var Le=_e.feature;Le.id!==void 0&&Ce.writeVarintField(1,Le.id),Ce.writeMessage(2,G,_e),Ce.writeVarintField(3,Le.type),Ce.writeMessage(4,Z,Le)}function G(_e,Ce){var Le=_e.feature,Pe=_e.keys,Xe=_e.values,ht=_e.keycache,Mt=_e.valuecache;for(var pt in Le.properties){var Lt=ht[pt];Lt===void 0&&(Pe.push(pt),Lt=Pe.length-1,ht[pt]=Lt),Ce.writeVarint(Lt);var vt=Le.properties[pt],Dt=typeof vt;Dt!=="string"&&Dt!=="boolean"&&Dt!=="number"&&(vt=JSON.stringify(vt));var xt=Dt+":"+vt,it=Mt[xt];it===void 0&&(Xe.push(vt),it=Xe.length-1,Mt[xt]=it),Ce.writeVarint(it)}}function X(_e,Ce){return(Ce<<3)+(7&_e)}function K(_e){return _e<<1^_e>>31}function Z(_e,Ce){for(var Le=_e.loadGeometry(),Pe=_e.type,Xe=0,ht=0,Mt=Le.length,pt=0;pt<Mt;pt++){var Lt=Le[pt],vt=1;Pe===1&&(vt=Lt.length),Ce.writeVarint(X(1,vt));for(var Dt=Pe===3?Lt.length-1:Lt.length,xt=0;xt<Dt;xt++){xt===1&&Pe!==1&&Ce.writeVarint(X(2,Dt-1));var it=Lt[xt].x-Xe,St=Lt[xt].y-ht;Ce.writeVarint(K(it)),Ce.writeVarint(K(St)),Xe+=it,ht+=St}Pe===3&&Ce.writeVarint(X(7,1))}}function H(_e,Ce){var Le=typeof _e;Le==="string"?Ce.writeStringField(1,_e):Le==="boolean"?Ce.writeBooleanField(7,_e):Le==="number"&&(_e%1!=0?Ce.writeDoubleField(3,_e):_e<0?Ce.writeSVarintField(6,_e):Ce.writeVarintField(5,_e))}function Y(_e,Ce,Le,Pe,Xe,ht){if(!(Xe-Pe<=Le)){var Mt=Pe+Xe>>1;(function pt(Lt,vt,Dt,xt,it,St){for(;it>xt;){if(it-xt>600){var Nt=it-xt+1,Ut=Dt-xt+1,Qt=Math.log(Nt),Ie=.5*Math.exp(2*Qt/3),lt=.5*Math.sqrt(Qt*Ie*(Nt-Ie)/Nt)*(Ut-Nt/2<0?-1:1),wt=Math.max(xt,Math.floor(Dt-Ut*Ie/Nt+lt)),Ot=Math.min(it,Math.floor(Dt+(Nt-Ut)*Ie/Nt+lt));pt(Lt,vt,Dt,wt,Ot,St)}var Gt=vt[2*Dt+St],ir=xt,Xt=it;for($(Lt,vt,xt,Dt),vt[2*it+St]>Gt&&$(Lt,vt,xt,it);ir<Xt;){for($(Lt,vt,ir,Xt),ir++,Xt--;vt[2*ir+St]<Gt;)ir++;for(;vt[2*Xt+St]>Gt;)Xt--}vt[2*xt+St]===Gt?$(Lt,vt,xt,Xt):(Xt++,$(Lt,vt,Xt,it)),Xt<=Dt&&(xt=Xt+1),Dt<=Xt&&(it=Xt-1)}})(_e,Ce,Mt,Pe,Xe,ht%2),Y(_e,Ce,Le,Pe,Mt-1,ht+1),Y(_e,Ce,Le,Mt+1,Xe,ht+1)}}function $(_e,Ce,Le,Pe){z(_e,Le,Pe),z(Ce,2*Le,2*Pe),z(Ce,2*Le+1,2*Pe+1)}function z(_e,Ce,Le){var Pe=_e[Ce];_e[Ce]=_e[Le],_e[Le]=Pe}function j(_e,Ce,Le,Pe){var Xe=_e-Le,ht=Ce-Pe;return Xe*Xe+ht*ht}k.fromVectorTileJs=L,k.fromGeojsonVt=M,k.GeoJSONWrapper=P;var W=function(_e){return _e[0]},ee=function(_e){return _e[1]},J=function(_e,Ce,Le,Pe,Xe){Ce===void 0&&(Ce=W),Le===void 0&&(Le=ee),Pe===void 0&&(Pe=64),Xe===void 0&&(Xe=Float64Array),this.nodeSize=Pe,this.points=_e;for(var ht=_e.length<65536?Uint16Array:Uint32Array,Mt=this.ids=new ht(_e.length),pt=this.coords=new Xe(2*_e.length),Lt=0;Lt<_e.length;Lt++)Mt[Lt]=Lt,pt[2*Lt]=Ce(_e[Lt]),pt[2*Lt+1]=Le(_e[Lt]);Y(Mt,pt,Pe,0,Mt.length-1,0)};J.prototype.range=function(_e,Ce,Le,Pe){return function(Xe,ht,Mt,pt,Lt,vt,Dt){for(var xt,it,St=[0,Xe.length-1,0],Nt=[];St.length;){var Ut=St.pop(),Qt=St.pop(),Ie=St.pop();if(Qt-Ie<=Dt)for(var lt=Ie;lt<=Qt;lt++)xt=ht[2*lt],it=ht[2*lt+1],xt>=Mt&&xt<=Lt&&it>=pt&&it<=vt&&Nt.push(Xe[lt]);else{var wt=Math.floor((Ie+Qt)/2);xt=ht[2*wt],it=ht[2*wt+1],xt>=Mt&&xt<=Lt&&it>=pt&&it<=vt&&Nt.push(Xe[wt]);var Ot=(Ut+1)%2;(Ut===0?Mt<=xt:pt<=it)&&(St.push(Ie),St.push(wt-1),St.push(Ot)),(Ut===0?Lt>=xt:vt>=it)&&(St.push(wt+1),St.push(Qt),St.push(Ot))}}return Nt}(this.ids,this.coords,_e,Ce,Le,Pe,this.nodeSize)},J.prototype.within=function(_e,Ce,Le){return function(Pe,Xe,ht,Mt,pt,Lt){for(var vt=[0,Pe.length-1,0],Dt=[],xt=pt*pt;vt.length;){var it=vt.pop(),St=vt.pop(),Nt=vt.pop();if(St-Nt<=Lt)for(var Ut=Nt;Ut<=St;Ut++)j(Xe[2*Ut],Xe[2*Ut+1],ht,Mt)<=xt&&Dt.push(Pe[Ut]);else{var Qt=Math.floor((Nt+St)/2),Ie=Xe[2*Qt],lt=Xe[2*Qt+1];j(Ie,lt,ht,Mt)<=xt&&Dt.push(Pe[Qt]);var wt=(it+1)%2;(it===0?ht-pt<=Ie:Mt-pt<=lt)&&(vt.push(Nt),vt.push(Qt-1),vt.push(wt)),(it===0?ht+pt>=Ie:Mt+pt>=lt)&&(vt.push(Qt+1),vt.push(St),vt.push(wt))}}return Dt}(this.ids,this.coords,_e,Ce,Le,this.nodeSize)};var Q={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(_e){return _e}},te=function(_e){this.options=ve(Object.create(Q),_e),this.trees=new Array(this.options.maxZoom+1)};function ie(_e,Ce,Le,Pe,Xe){return{x:_e,y:Ce,zoom:1/0,id:Le,parentId:-1,numPoints:Pe,properties:Xe}}function ae(_e,Ce){var Le=_e.geometry.coordinates,Pe=Le[0],Xe=Le[1];return{x:de(Pe),y:ue(Xe),zoom:1/0,index:Ce,parentId:-1}}function he(_e){return{type:"Feature",id:_e.id,properties:se(_e),geometry:{type:"Point",coordinates:[(Pe=_e.x,360*(Pe-.5)),(Ce=_e.y,Le=(180-360*Ce)*Math.PI/180,360*Math.atan(Math.exp(Le))/Math.PI-90)]}};var Ce,Le,Pe}function se(_e){var Ce=_e.numPoints,Le=Ce>=1e4?Math.round(Ce/1e3)+"k":Ce>=1e3?Math.round(Ce/100)/10+"k":Ce;return ve(ve({},_e.properties),{cluster:!0,cluster_id:_e.id,point_count:Ce,point_count_abbreviated:Le})}function de(_e){return _e/360+.5}function ue(_e){var Ce=Math.sin(_e*Math.PI/180),Le=.5-.25*Math.log((1+Ce)/(1-Ce))/Math.PI;return Le<0?0:Le>1?1:Le}function ve(_e,Ce){for(var Le in Ce)_e[Le]=Ce[Le];return _e}function ke(_e){return _e.x}function Ee(_e){return _e.y}function be(_e,Ce,Le,Pe,Xe,ht){var Mt=Xe-Le,pt=ht-Pe;if(Mt!==0||pt!==0){var Lt=((_e-Le)*Mt+(Ce-Pe)*pt)/(Mt*Mt+pt*pt);Lt>1?(Le=Xe,Pe=ht):Lt>0&&(Le+=Mt*Lt,Pe+=pt*Lt)}return(Mt=_e-Le)*Mt+(pt=Ce-Pe)*pt}function xe(_e,Ce,Le,Pe){var Xe={id:_e===void 0?null:_e,type:Ce,geometry:Le,tags:Pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ht){var Mt=ht.geometry,pt=ht.type;if(pt==="Point"||pt==="MultiPoint"||pt==="LineString")ce(ht,Mt);else if(pt==="Polygon"||pt==="MultiLineString")for(var Lt=0;Lt<Mt.length;Lt++)ce(ht,Mt[Lt]);else if(pt==="MultiPolygon")for(Lt=0;Lt<Mt.length;Lt++)for(var vt=0;vt<Mt[Lt].length;vt++)ce(ht,Mt[Lt][vt])}(Xe),Xe}function ce(_e,Ce){for(var Le=0;Le<Ce.length;Le+=3)_e.minX=Math.min(_e.minX,Ce[Le]),_e.minY=Math.min(_e.minY,Ce[Le+1]),_e.maxX=Math.max(_e.maxX,Ce[Le]),_e.maxY=Math.max(_e.maxY,Ce[Le+1])}function ge(_e,Ce,Le,Pe){if(Ce.geometry){var Xe=Ce.geometry.coordinates,ht=Ce.geometry.type,Mt=Math.pow(Le.tolerance/((1<<Le.maxZoom)*Le.extent),2),pt=[],Lt=Ce.id;if(Le.promoteId?Lt=Ce.properties[Le.promoteId]:Le.generateId&&(Lt=Pe||0),ht==="Point")we(Xe,pt);else if(ht==="MultiPoint")for(var vt=0;vt<Xe.length;vt++)we(Xe[vt],pt);else if(ht==="LineString")Me(Xe,pt,Mt,!1);else if(ht==="MultiLineString"){if(Le.lineMetrics){for(vt=0;vt<Xe.length;vt++)pt=[],Me(Xe[vt],pt,Mt,!1),_e.push(xe(Lt,"LineString",pt,Ce.properties));return}Se(Xe,pt,Mt,!1)}else if(ht==="Polygon")Se(Xe,pt,Mt,!0);else{if(ht!=="MultiPolygon"){if(ht==="GeometryCollection"){for(vt=0;vt<Ce.geometry.geometries.length;vt++)ge(_e,{id:Lt,geometry:Ce.geometry.geometries[vt],properties:Ce.properties},Le,Pe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(vt=0;vt<Xe.length;vt++){var Dt=[];Se(Xe[vt],Dt,Mt,!0),pt.push(Dt)}}_e.push(xe(Lt,ht,pt,Ce.properties))}}function we(_e,Ce){Ce.push(ze(_e[0])),Ce.push(Fe(_e[1])),Ce.push(0)}function Me(_e,Ce,Le,Pe){for(var Xe,ht,Mt=0,pt=0;pt<_e.length;pt++){var Lt=ze(_e[pt][0]),vt=Fe(_e[pt][1]);Ce.push(Lt),Ce.push(vt),Ce.push(0),pt>0&&(Mt+=Pe?(Xe*vt-Lt*ht)/2:Math.sqrt(Math.pow(Lt-Xe,2)+Math.pow(vt-ht,2))),Xe=Lt,ht=vt}var Dt=Ce.length-3;Ce[2]=1,function xt(it,St,Nt,Ut){for(var Qt,Ie=Ut,lt=Nt-St>>1,wt=Nt-St,Ot=it[St],Gt=it[St+1],ir=it[Nt],Xt=it[Nt+1],Kt=St+3;Kt<Nt;Kt+=3){var or=be(it[Kt],it[Kt+1],Ot,Gt,ir,Xt);if(or>Ie)Qt=Kt,Ie=or;else if(or===Ie){var dr=Math.abs(Kt-lt);dr<wt&&(Qt=Kt,wt=dr)}}Ie>Ut&&(Qt-St>3&&xt(it,St,Qt,Ut),it[Qt+2]=Ie,Nt-Qt>3&&xt(it,Qt,Nt,Ut))}(Ce,0,Dt,Le),Ce[Dt+2]=1,Ce.size=Math.abs(Mt),Ce.start=0,Ce.end=Ce.size}function Se(_e,Ce,Le,Pe){for(var Xe=0;Xe<_e.length;Xe++){var ht=[];Me(_e[Xe],ht,Le,Pe),Ce.push(ht)}}function ze(_e){return _e/360+.5}function Fe(_e){var Ce=Math.sin(_e*Math.PI/180),Le=.5-.25*Math.log((1+Ce)/(1-Ce))/Math.PI;return Le<0?0:Le>1?1:Le}function Ye(_e,Ce,Le,Pe,Xe,ht,Mt,pt){if(Pe/=Ce,ht>=(Le/=Ce)&&Mt<Pe)return _e;if(Mt<Le||ht>=Pe)return null;for(var Lt=[],vt=0;vt<_e.length;vt++){var Dt=_e[vt],xt=Dt.geometry,it=Dt.type,St=Xe===0?Dt.minX:Dt.minY,Nt=Xe===0?Dt.maxX:Dt.maxY;if(St>=Le&&Nt<Pe)Lt.push(Dt);else if(!(Nt<Le||St>=Pe)){var Ut=[];if(it==="Point"||it==="MultiPoint")rt(xt,Ut,Le,Pe,Xe);else if(it==="LineString")Oe(xt,Ut,Le,Pe,Xe,!1,pt.lineMetrics);else if(it==="MultiLineString")We(xt,Ut,Le,Pe,Xe,!1);else if(it==="Polygon")We(xt,Ut,Le,Pe,Xe,!0);else if(it==="MultiPolygon")for(var Qt=0;Qt<xt.length;Qt++){var Ie=[];We(xt[Qt],Ie,Le,Pe,Xe,!0),Ie.length&&Ut.push(Ie)}if(Ut.length){if(pt.lineMetrics&&it==="LineString"){for(Qt=0;Qt<Ut.length;Qt++)Lt.push(xe(Dt.id,it,Ut[Qt],Dt.tags));continue}it!=="LineString"&&it!=="MultiLineString"||(Ut.length===1?(it="LineString",Ut=Ut[0]):it="MultiLineString"),it!=="Point"&&it!=="MultiPoint"||(it=Ut.length===3?"Point":"MultiPoint"),Lt.push(xe(Dt.id,it,Ut,Dt.tags))}}}return Lt.length?Lt:null}function rt(_e,Ce,Le,Pe,Xe){for(var ht=0;ht<_e.length;ht+=3){var Mt=_e[ht+Xe];Mt>=Le&&Mt<=Pe&&(Ce.push(_e[ht]),Ce.push(_e[ht+1]),Ce.push(_e[ht+2]))}}function Oe(_e,Ce,Le,Pe,Xe,ht,Mt){for(var pt,Lt,vt=je(_e),Dt=Xe===0?et:st,xt=_e.start,it=0;it<_e.length-3;it+=3){var St=_e[it],Nt=_e[it+1],Ut=_e[it+2],Qt=_e[it+3],Ie=_e[it+4],lt=Xe===0?St:Nt,wt=Xe===0?Qt:Ie,Ot=!1;Mt&&(pt=Math.sqrt(Math.pow(St-Qt,2)+Math.pow(Nt-Ie,2))),lt<Le?wt>Le&&(Lt=Dt(vt,St,Nt,Qt,Ie,Le),Mt&&(vt.start=xt+pt*Lt)):lt>Pe?wt<Pe&&(Lt=Dt(vt,St,Nt,Qt,Ie,Pe),Mt&&(vt.start=xt+pt*Lt)):qe(vt,St,Nt,Ut),wt<Le&&lt>=Le&&(Lt=Dt(vt,St,Nt,Qt,Ie,Le),Ot=!0),wt>Pe&&lt<=Pe&&(Lt=Dt(vt,St,Nt,Qt,Ie,Pe),Ot=!0),!ht&&Ot&&(Mt&&(vt.end=xt+pt*Lt),Ce.push(vt),vt=je(_e)),Mt&&(xt+=pt)}var Gt=_e.length-3;St=_e[Gt],Nt=_e[Gt+1],Ut=_e[Gt+2],(lt=Xe===0?St:Nt)>=Le&&lt<=Pe&&qe(vt,St,Nt,Ut),Gt=vt.length-3,ht&&Gt>=3&&(vt[Gt]!==vt[0]||vt[Gt+1]!==vt[1])&&qe(vt,vt[0],vt[1],vt[2]),vt.length&&Ce.push(vt)}function je(_e){var Ce=[];return Ce.size=_e.size,Ce.start=_e.start,Ce.end=_e.end,Ce}function We(_e,Ce,Le,Pe,Xe,ht){for(var Mt=0;Mt<_e.length;Mt++)Oe(_e[Mt],Ce,Le,Pe,Xe,ht,!1)}function qe(_e,Ce,Le,Pe){_e.push(Ce),_e.push(Le),_e.push(Pe)}function et(_e,Ce,Le,Pe,Xe,ht){var Mt=(ht-Ce)/(Pe-Ce);return _e.push(ht),_e.push(Le+(Xe-Le)*Mt),_e.push(1),Mt}function st(_e,Ce,Le,Pe,Xe,ht){var Mt=(ht-Le)/(Xe-Le);return _e.push(Ce+(Pe-Ce)*Mt),_e.push(ht),_e.push(1),Mt}function ct(_e,Ce){for(var Le=[],Pe=0;Pe<_e.length;Pe++){var Xe,ht=_e[Pe],Mt=ht.type;if(Mt==="Point"||Mt==="MultiPoint"||Mt==="LineString")Xe=Pt(ht.geometry,Ce);else if(Mt==="MultiLineString"||Mt==="Polygon"){Xe=[];for(var pt=0;pt<ht.geometry.length;pt++)Xe.push(Pt(ht.geometry[pt],Ce))}else if(Mt==="MultiPolygon")for(Xe=[],pt=0;pt<ht.geometry.length;pt++){for(var Lt=[],vt=0;vt<ht.geometry[pt].length;vt++)Lt.push(Pt(ht.geometry[pt][vt],Ce));Xe.push(Lt)}Le.push(xe(ht.id,Mt,Xe,ht.tags))}return Le}function Pt(_e,Ce){var Le=[];Le.size=_e.size,_e.start!==void 0&&(Le.start=_e.start,Le.end=_e.end);for(var Pe=0;Pe<_e.length;Pe+=3)Le.push(_e[Pe]+Ce,_e[Pe+1],_e[Pe+2]);return Le}function kt(_e,Ce){if(_e.transformed)return _e;var Le,Pe,Xe,ht=1<<_e.z,Mt=_e.x,pt=_e.y;for(Le=0;Le<_e.features.length;Le++){var Lt=_e.features[Le],vt=Lt.geometry,Dt=Lt.type;if(Lt.geometry=[],Dt===1)for(Pe=0;Pe<vt.length;Pe+=2)Lt.geometry.push(at(vt[Pe],vt[Pe+1],Ce,ht,Mt,pt));else for(Pe=0;Pe<vt.length;Pe++){var xt=[];for(Xe=0;Xe<vt[Pe].length;Xe+=2)xt.push(at(vt[Pe][Xe],vt[Pe][Xe+1],Ce,ht,Mt,pt));Lt.geometry.push(xt)}}return _e.transformed=!0,_e}function at(_e,Ce,Le,Pe,Xe,ht){return[Math.round(Le*(_e*Pe-Xe)),Math.round(Le*(Ce*Pe-ht))]}function tt(_e,Ce,Le,Pe,Xe){for(var ht=Ce===Xe.maxZoom?0:Xe.tolerance/((1<<Ce)*Xe.extent),Mt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Le,y:Pe,z:Ce,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},pt=0;pt<_e.length;pt++){Mt.numFeatures++,_t(Mt,_e[pt],ht,Xe);var Lt=_e[pt].minX,vt=_e[pt].minY,Dt=_e[pt].maxX,xt=_e[pt].maxY;Lt<Mt.minX&&(Mt.minX=Lt),vt<Mt.minY&&(Mt.minY=vt),Dt>Mt.maxX&&(Mt.maxX=Dt),xt>Mt.maxY&&(Mt.maxY=xt)}return Mt}function _t(_e,Ce,Le,Pe){var Xe=Ce.geometry,ht=Ce.type,Mt=[];if(ht==="Point"||ht==="MultiPoint")for(var pt=0;pt<Xe.length;pt+=3)Mt.push(Xe[pt]),Mt.push(Xe[pt+1]),_e.numPoints++,_e.numSimplified++;else if(ht==="LineString")er(Mt,Xe,_e,Le,!1,!1);else if(ht==="MultiLineString"||ht==="Polygon")for(pt=0;pt<Xe.length;pt++)er(Mt,Xe[pt],_e,Le,ht==="Polygon",pt===0);else if(ht==="MultiPolygon")for(var Lt=0;Lt<Xe.length;Lt++){var vt=Xe[Lt];for(pt=0;pt<vt.length;pt++)er(Mt,vt[pt],_e,Le,!0,pt===0)}if(Mt.length){var Dt=Ce.tags||null;if(ht==="LineString"&&Pe.lineMetrics){for(var xt in Dt={},Ce.tags)Dt[xt]=Ce.tags[xt];Dt.mapbox_clip_start=Xe.start/Xe.size,Dt.mapbox_clip_end=Xe.end/Xe.size}var it={geometry:Mt,type:ht==="Polygon"||ht==="MultiPolygon"?3:ht==="LineString"||ht==="MultiLineString"?2:1,tags:Dt};Ce.id!==null&&(it.id=Ce.id),_e.features.push(it)}}function er(_e,Ce,Le,Pe,Xe,ht){var Mt=Pe*Pe;if(Pe>0&&Ce.size<(Xe?Mt:Pe))Le.numPoints+=Ce.length/3;else{for(var pt=[],Lt=0;Lt<Ce.length;Lt+=3)(Pe===0||Ce[Lt+2]>Mt)&&(Le.numSimplified++,pt.push(Ce[Lt]),pt.push(Ce[Lt+1])),Le.numPoints++;Xe&&function(vt,Dt){for(var xt=0,it=0,St=vt.length,Nt=St-2;it<St;Nt=it,it+=2)xt+=(vt[it]-vt[Nt])*(vt[it+1]+vt[Nt+1]);if(xt>0===Dt)for(it=0,St=vt.length;it<St/2;it+=2){var Ut=vt[it],Qt=vt[it+1];vt[it]=vt[St-2-it],vt[it+1]=vt[St-1-it],vt[St-2-it]=Ut,vt[St-1-it]=Qt}}(pt,ht),_e.push(pt)}}function tr(_e,Ce){var Le=(Ce=this.options=function(Xe,ht){for(var Mt in ht)Xe[Mt]=ht[Mt];return Xe}(Object.create(this.options),Ce)).debug;if(Le&&console.time("preprocess data"),Ce.maxZoom<0||Ce.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ce.promoteId&&Ce.generateId)throw new Error("promoteId and generateId cannot be used together.");var Pe=function(Xe,ht){var Mt=[];if(Xe.type==="FeatureCollection")for(var pt=0;pt<Xe.features.length;pt++)ge(Mt,Xe.features[pt],ht,pt);else Xe.type==="Feature"?ge(Mt,Xe,ht):ge(Mt,{geometry:Xe},ht);return Mt}(_e,Ce);this.tiles={},this.tileCoords=[],Le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ce.indexMaxZoom,Ce.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Pe=function(Xe,ht){var Mt=ht.buffer/ht.extent,pt=Xe,Lt=Ye(Xe,1,-1-Mt,Mt,0,-1,2,ht),vt=Ye(Xe,1,1-Mt,2+Mt,0,-1,2,ht);return(Lt||vt)&&(pt=Ye(Xe,1,-Mt,1+Mt,0,-1,2,ht)||[],Lt&&(pt=ct(Lt,1).concat(pt)),vt&&(pt=pt.concat(ct(vt,-1)))),pt}(Pe,Ce)).length&&this.splitTile(Pe,0,0,0),Le&&(Pe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ue(_e,Ce,Le){return 32*((1<<_e)*Le+Ce)+_e}function He(_e,Ce){var Le=_e.tileID.canonical;if(!this._geoJSONIndex)return Ce(null,null);var Pe=this._geoJSONIndex.getTile(Le.z,Le.x,Le.y);if(!Pe)return Ce(null,null);var Xe=new T(Pe.features),ht=k(Xe);ht.byteOffset===0&&ht.byteLength===ht.buffer.byteLength||(ht=new Uint8Array(ht)),Ce(null,{vectorTile:Xe,rawData:ht.buffer})}te.prototype.load=function(_e){var Ce=this.options,Le=Ce.log,Pe=Ce.minZoom,Xe=Ce.maxZoom,ht=Ce.nodeSize;Le&&console.time("total time");var Mt="prepare "+_e.length+" points";Le&&console.time(Mt),this.points=_e;for(var pt=[],Lt=0;Lt<_e.length;Lt++)_e[Lt].geometry&&pt.push(ae(_e[Lt],Lt));this.trees[Xe+1]=new J(pt,ke,Ee,ht,Float32Array),Le&&console.timeEnd(Mt);for(var vt=Xe;vt>=Pe;vt--){var Dt=+Date.now();pt=this._cluster(pt,vt),this.trees[vt]=new J(pt,ke,Ee,ht,Float32Array),Le&&console.log("z%d: %d clusters in %dms",vt,pt.length,+Date.now()-Dt)}return Le&&console.timeEnd("total time"),this},te.prototype.getClusters=function(_e,Ce){var Le=((_e[0]+180)%360+360)%360-180,Pe=Math.max(-90,Math.min(90,_e[1])),Xe=_e[2]===180?180:((_e[2]+180)%360+360)%360-180,ht=Math.max(-90,Math.min(90,_e[3]));if(_e[2]-_e[0]>=360)Le=-180,Xe=180;else if(Le>Xe){var Mt=this.getClusters([Le,Pe,180,ht],Ce),pt=this.getClusters([-180,Pe,Xe,ht],Ce);return Mt.concat(pt)}for(var Lt=this.trees[this._limitZoom(Ce)],vt=[],Dt=0,xt=Lt.range(de(Le),ue(ht),de(Xe),ue(Pe));Dt<xt.length;Dt+=1){var it=xt[Dt],St=Lt.points[it];vt.push(St.numPoints?he(St):this.points[St.index])}return vt},te.prototype.getChildren=function(_e){var Ce=this._getOriginId(_e),Le=this._getOriginZoom(_e),Pe="No cluster with the specified id.",Xe=this.trees[Le];if(!Xe)throw new Error(Pe);var ht=Xe.points[Ce];if(!ht)throw new Error(Pe);for(var Mt=this.options.radius/(this.options.extent*Math.pow(2,Le-1)),pt=[],Lt=0,vt=Xe.within(ht.x,ht.y,Mt);Lt<vt.length;Lt+=1){var Dt=vt[Lt],xt=Xe.points[Dt];xt.parentId===_e&&pt.push(xt.numPoints?he(xt):this.points[xt.index])}if(pt.length===0)throw new Error(Pe);return pt},te.prototype.getLeaves=function(_e,Ce,Le){Ce=Ce||10,Le=Le||0;var Pe=[];return this._appendLeaves(Pe,_e,Ce,Le,0),Pe},te.prototype.getTile=function(_e,Ce,Le){var Pe=this.trees[this._limitZoom(_e)],Xe=Math.pow(2,_e),ht=this.options,Mt=ht.extent,pt=ht.radius/Mt,Lt=(Le-pt)/Xe,vt=(Le+1+pt)/Xe,Dt={features:[]};return this._addTileFeatures(Pe.range((Ce-pt)/Xe,Lt,(Ce+1+pt)/Xe,vt),Pe.points,Ce,Le,Xe,Dt),Ce===0&&this._addTileFeatures(Pe.range(1-pt/Xe,Lt,1,vt),Pe.points,Xe,Le,Xe,Dt),Ce===Xe-1&&this._addTileFeatures(Pe.range(0,Lt,pt/Xe,vt),Pe.points,-1,Le,Xe,Dt),Dt.features.length?Dt:null},te.prototype.getClusterExpansionZoom=function(_e){for(var Ce=this._getOriginZoom(_e)-1;Ce<=this.options.maxZoom;){var Le=this.getChildren(_e);if(Ce++,Le.length!==1)break;_e=Le[0].properties.cluster_id}return Ce},te.prototype._appendLeaves=function(_e,Ce,Le,Pe,Xe){for(var ht=0,Mt=this.getChildren(Ce);ht<Mt.length;ht+=1){var pt=Mt[ht],Lt=pt.properties;if(Lt&&Lt.cluster?Xe+Lt.point_count<=Pe?Xe+=Lt.point_count:Xe=this._appendLeaves(_e,Lt.cluster_id,Le,Pe,Xe):Xe<Pe?Xe++:_e.push(pt),_e.length===Le)break}return Xe},te.prototype._addTileFeatures=function(_e,Ce,Le,Pe,Xe,ht){for(var Mt=0,pt=_e;Mt<pt.length;Mt+=1){var Lt=Ce[pt[Mt]],vt=Lt.numPoints,Dt={type:1,geometry:[[Math.round(this.options.extent*(Lt.x*Xe-Le)),Math.round(this.options.extent*(Lt.y*Xe-Pe))]],tags:vt?se(Lt):this.points[Lt.index].properties},xt=void 0;vt?xt=Lt.id:this.options.generateId?xt=Lt.index:this.points[Lt.index].id&&(xt=this.points[Lt.index].id),xt!==void 0&&(Dt.id=xt),ht.features.push(Dt)}},te.prototype._limitZoom=function(_e){return Math.max(this.options.minZoom,Math.min(_e,this.options.maxZoom+1))},te.prototype._cluster=function(_e,Ce){for(var Le=[],Pe=this.options,Xe=Pe.radius,ht=Pe.extent,Mt=Pe.reduce,pt=Xe/(ht*Math.pow(2,Ce)),Lt=0;Lt<_e.length;Lt++){var vt=_e[Lt];if(!(vt.zoom<=Ce)){vt.zoom=Ce;for(var Dt=this.trees[Ce+1],xt=Dt.within(vt.x,vt.y,pt),it=vt.numPoints||1,St=vt.x*it,Nt=vt.y*it,Ut=Mt&&it>1?this._map(vt,!0):null,Qt=(Lt<<5)+(Ce+1)+this.points.length,Ie=0,lt=xt;Ie<lt.length;Ie+=1){var wt=lt[Ie],Ot=Dt.points[wt];if(!(Ot.zoom<=Ce)){Ot.zoom=Ce;var Gt=Ot.numPoints||1;St+=Ot.x*Gt,Nt+=Ot.y*Gt,it+=Gt,Ot.parentId=Qt,Mt&&(Ut||(Ut=this._map(vt,!0)),Mt(Ut,this._map(Ot)))}}it===1?Le.push(vt):(vt.parentId=Qt,Le.push(ie(St/it,Nt/it,Qt,it,Ut)))}}return Le},te.prototype._getOriginId=function(_e){return _e-this.points.length>>5},te.prototype._getOriginZoom=function(_e){return(_e-this.points.length)%32},te.prototype._map=function(_e,Ce){if(_e.numPoints)return Ce?ve({},_e.properties):_e.properties;var Le=this.points[_e.index].properties,Pe=this.options.map(Le);return Ce&&Pe===Le?ve({},Pe):Pe},tr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},tr.prototype.splitTile=function(_e,Ce,Le,Pe,Xe,ht,Mt){for(var pt=[_e,Ce,Le,Pe],Lt=this.options,vt=Lt.debug;pt.length;){Pe=pt.pop(),Le=pt.pop(),Ce=pt.pop(),_e=pt.pop();var Dt=1<<Ce,xt=Ue(Ce,Le,Pe),it=this.tiles[xt];if(!it&&(vt>1&&console.time("creation"),it=this.tiles[xt]=tt(_e,Ce,Le,Pe,Lt),this.tileCoords.push({z:Ce,x:Le,y:Pe}),vt)){vt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ce,Le,Pe,it.numFeatures,it.numPoints,it.numSimplified),console.timeEnd("creation"));var St="z"+Ce;this.stats[St]=(this.stats[St]||0)+1,this.total++}if(it.source=_e,Xe){if(Ce===Lt.maxZoom||Ce===Xe)continue;var Nt=1<<Xe-Ce;if(Le!==Math.floor(ht/Nt)||Pe!==Math.floor(Mt/Nt))continue}else if(Ce===Lt.indexMaxZoom||it.numPoints<=Lt.indexMaxPoints)continue;if(it.source=null,_e.length!==0){vt>1&&console.time("clipping");var Ut,Qt,Ie,lt,wt,Ot,Gt=.5*Lt.buffer/Lt.extent,ir=.5-Gt,Xt=.5+Gt,Kt=1+Gt;Ut=Qt=Ie=lt=null,wt=Ye(_e,Dt,Le-Gt,Le+Xt,0,it.minX,it.maxX,Lt),Ot=Ye(_e,Dt,Le+ir,Le+Kt,0,it.minX,it.maxX,Lt),_e=null,wt&&(Ut=Ye(wt,Dt,Pe-Gt,Pe+Xt,1,it.minY,it.maxY,Lt),Qt=Ye(wt,Dt,Pe+ir,Pe+Kt,1,it.minY,it.maxY,Lt),wt=null),Ot&&(Ie=Ye(Ot,Dt,Pe-Gt,Pe+Xt,1,it.minY,it.maxY,Lt),lt=Ye(Ot,Dt,Pe+ir,Pe+Kt,1,it.minY,it.maxY,Lt),Ot=null),vt>1&&console.timeEnd("clipping"),pt.push(Ut||[],Ce+1,2*Le,2*Pe),pt.push(Qt||[],Ce+1,2*Le,2*Pe+1),pt.push(Ie||[],Ce+1,2*Le+1,2*Pe),pt.push(lt||[],Ce+1,2*Le+1,2*Pe+1)}}},tr.prototype.getTile=function(_e,Ce,Le){var Pe=this.options,Xe=Pe.extent,ht=Pe.debug;if(_e<0||_e>24)return null;var Mt=1<<_e,pt=Ue(_e,Ce=(Ce%Mt+Mt)%Mt,Le);if(this.tiles[pt])return kt(this.tiles[pt],Xe);ht>1&&console.log("drilling down to z%d-%d-%d",_e,Ce,Le);for(var Lt,vt=_e,Dt=Ce,xt=Le;!Lt&&vt>0;)vt--,Dt=Math.floor(Dt/2),xt=Math.floor(xt/2),Lt=this.tiles[Ue(vt,Dt,xt)];return Lt&&Lt.source?(ht>1&&console.log("found parent tile z%d-%d-%d",vt,Dt,xt),ht>1&&console.time("drilling down"),this.splitTile(Lt.source,vt,Dt,xt,_e,Ce,Le),ht>1&&console.timeEnd("drilling down"),this.tiles[pt]?kt(this.tiles[pt],Xe):null):null};var Be=function(_e){function Ce(Le,Pe,Xe,ht){_e.call(this,Le,Pe,Xe,He),ht&&(this.loadGeoJSON=ht)}return _e&&(Ce.__proto__=_e),Ce.prototype=Object.create(_e&&_e.prototype),Ce.prototype.constructor=Ce,Ce.prototype.loadData=function(Le,Pe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Pe,this._pendingLoadDataParams=Le,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Ce.prototype._loadData=function(){var Le=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Pe=this._pendingCallback,Xe=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ht=!!(Xe&&Xe.request&&Xe.request.collectResourceTiming)&&new e.RequestPerformance(Xe.request);this.loadGeoJSON(Xe,function(Mt,pt){if(Mt||!pt)return Pe(Mt);if(typeof pt!="object")return Pe(new Error("Input data given to '"+Xe.source+"' is not a valid GeoJSON object."));p(pt,!0);try{Le._geoJSONIndex=Xe.cluster?new te(function(Dt){var xt=Dt.superclusterOptions,it=Dt.clusterProperties;if(!it||!xt)return xt;for(var St={},Nt={},Ut={accumulated:null,zoom:0},Qt={properties:null},Ie=Object.keys(it),lt=0,wt=Ie;lt<wt.length;lt+=1){var Ot=wt[lt],Gt=it[Ot],ir=Gt[0],Xt=Gt[1],Kt=e.createExpression(Xt),or=e.createExpression(typeof ir=="string"?[ir,["accumulated"],["get",Ot]]:ir);St[Ot]=Kt.value,Nt[Ot]=or.value}return xt.map=function(dr){Qt.properties=dr;for(var vr={},ur=0,pr=Ie;ur<pr.length;ur+=1){var br=pr[ur];vr[br]=St[br].evaluate(Ut,Qt)}return vr},xt.reduce=function(dr,vr){Qt.properties=vr;for(var ur=0,pr=Ie;ur<pr.length;ur+=1){var br=pr[ur];Ut.accumulated=dr[br],dr[br]=Nt[br].evaluate(Ut,Qt)}},xt}(Xe)).load(pt.features):function(Dt,xt){return new tr(Dt,xt)}(pt,Xe.geojsonVtOptions)}catch(Dt){return Pe(Dt)}Le.loaded={};var Lt={};if(ht){var vt=ht.finish();vt&&(Lt.resourceTiming={},Lt.resourceTiming[Xe.source]=JSON.parse(JSON.stringify(vt)))}Pe(null,Lt)})}},Ce.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},Ce.prototype.reloadTile=function(Le,Pe){var Xe=this.loaded,ht=Le.uid;return Xe&&Xe[ht]?_e.prototype.reloadTile.call(this,Le,Pe):this.loadTile(Le,Pe)},Ce.prototype.loadGeoJSON=function(Le,Pe){if(Le.request)e.getJSON(Le.request,Pe);else{if(typeof Le.data!="string")return Pe(new Error("Input data given to '"+Le.source+"' is not a valid GeoJSON object."));try{return Pe(null,JSON.parse(Le.data))}catch(Xe){return Pe(new Error("Input data given to '"+Le.source+"' is not a valid GeoJSON object."))}}},Ce.prototype.removeSource=function(Le,Pe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Pe()},Ce.prototype.getClusterExpansionZoom=function(Le,Pe){try{Pe(null,this._geoJSONIndex.getClusterExpansionZoom(Le.clusterId))}catch(Xe){Pe(Xe)}},Ce.prototype.getClusterChildren=function(Le,Pe){try{Pe(null,this._geoJSONIndex.getChildren(Le.clusterId))}catch(Xe){Pe(Xe)}},Ce.prototype.getClusterLeaves=function(Le,Pe){try{Pe(null,this._geoJSONIndex.getLeaves(Le.clusterId,Le.limit,Le.offset))}catch(Xe){Pe(Xe)}},Ce}(n),Ke=function(_e){var Ce=this;this.self=_e,this.actor=new e.Actor(_e,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:n,geojson:Be},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(Le,Pe){if(Ce.workerSourceTypes[Le])throw new Error('Worker source with name "'+Le+'" already registered.');Ce.workerSourceTypes[Le]=Pe},this.self.registerRTLTextPlugin=function(Le){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=Le.applyArabicShaping,e.plugin.processBidirectionalText=Le.processBidirectionalText,e.plugin.processStyledBidirectionalText=Le.processStyledBidirectionalText}};return Ke.prototype.setReferrer=function(_e,Ce){this.referrer=Ce},Ke.prototype.setImages=function(_e,Ce,Le){for(var Pe in this.availableImages[_e]=Ce,this.workerSources[_e]){var Xe=this.workerSources[_e][Pe];for(var ht in Xe)Xe[ht].availableImages=Ce}Le()},Ke.prototype.setLayers=function(_e,Ce,Le){this.getLayerIndex(_e).replace(Ce),Le()},Ke.prototype.updateLayers=function(_e,Ce,Le){this.getLayerIndex(_e).update(Ce.layers,Ce.removedIds),Le()},Ke.prototype.loadTile=function(_e,Ce,Le){this.getWorkerSource(_e,Ce.type,Ce.source).loadTile(Ce,Le)},Ke.prototype.loadDEMTile=function(_e,Ce,Le){this.getDEMWorkerSource(_e,Ce.source).loadTile(Ce,Le)},Ke.prototype.reloadTile=function(_e,Ce,Le){this.getWorkerSource(_e,Ce.type,Ce.source).reloadTile(Ce,Le)},Ke.prototype.abortTile=function(_e,Ce,Le){this.getWorkerSource(_e,Ce.type,Ce.source).abortTile(Ce,Le)},Ke.prototype.removeTile=function(_e,Ce,Le){this.getWorkerSource(_e,Ce.type,Ce.source).removeTile(Ce,Le)},Ke.prototype.removeDEMTile=function(_e,Ce){this.getDEMWorkerSource(_e,Ce.source).removeTile(Ce)},Ke.prototype.removeSource=function(_e,Ce,Le){if(this.workerSources[_e]&&this.workerSources[_e][Ce.type]&&this.workerSources[_e][Ce.type][Ce.source]){var Pe=this.workerSources[_e][Ce.type][Ce.source];delete this.workerSources[_e][Ce.type][Ce.source],Pe.removeSource!==void 0?Pe.removeSource(Ce,Le):Le()}},Ke.prototype.loadWorkerSource=function(_e,Ce,Le){try{this.self.importScripts(Ce.url),Le()}catch(Pe){Le(Pe.toString())}},Ke.prototype.syncRTLPluginState=function(_e,Ce,Le){try{e.plugin.setState(Ce);var Pe=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&Pe!=null){this.self.importScripts(Pe);var Xe=e.plugin.isParsed();Le(Xe?void 0:new Error("RTL Text Plugin failed to import scripts from "+Pe),Xe)}}catch(ht){Le(ht.toString())}},Ke.prototype.getAvailableImages=function(_e){var Ce=this.availableImages[_e];return Ce||(Ce=[]),Ce},Ke.prototype.getLayerIndex=function(_e){var Ce=this.layerIndexes[_e];return Ce||(Ce=this.layerIndexes[_e]=new o),Ce},Ke.prototype.getWorkerSource=function(_e,Ce,Le){var Pe=this;if(this.workerSources[_e]||(this.workerSources[_e]={}),this.workerSources[_e][Ce]||(this.workerSources[_e][Ce]={}),!this.workerSources[_e][Ce][Le]){var Xe={send:function(ht,Mt,pt){Pe.actor.send(ht,Mt,pt,_e)}};this.workerSources[_e][Ce][Le]=new this.workerSourceTypes[Ce](Xe,this.getLayerIndex(_e),this.getAvailableImages(_e))}return this.workerSources[_e][Ce][Le]},Ke.prototype.getDEMWorkerSource=function(_e,Ce){return this.demWorkerSources[_e]||(this.demWorkerSources[_e]={}),this.demWorkerSources[_e][Ce]||(this.demWorkerSources[_e][Ce]=new g),this.demWorkerSources[_e][Ce]},Ke.prototype.enforceCacheSizeLimit=function(_e,Ce){e.enforceCacheSizeLimit(Ce)},typeof WorkerGlobalScope!="undefined"&&e.window!==void 0&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new Ke(e.window)),Ke}),h(0,function(e){var f=e.createCommonjsModule(function(C){function R(ne){return!F(ne)}function F(ne){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var le,pe,ye=new Blob([""],{type:"text/javascript"}),Te=URL.createObjectURL(ye);try{pe=new Worker(Te),le=!0}catch(Ne){le=!1}return pe&&pe.terminate(),URL.revokeObjectURL(Te),le}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var le=document.createElement("canvas");le.width=le.height=1;var pe=le.getContext("2d");if(!pe)return!1;var ye=pe.getImageData(0,0,1,1);return ye&&ye.width===le.width}()?function(le){return V[le]===void 0&&(V[le]=function(pe){var ye=function(Ne){var Ge=document.createElement("canvas"),nt=Object.create(R.webGLContextAttributes);return nt.failIfMajorPerformanceCaveat=Ne,Ge.probablySupportsContext?Ge.probablySupportsContext("webgl",nt)||Ge.probablySupportsContext("experimental-webgl",nt):Ge.supportsContext?Ge.supportsContext("webgl",nt)||Ge.supportsContext("experimental-webgl",nt):Ge.getContext("webgl",nt)||Ge.getContext("experimental-webgl",nt)}(pe);if(!ye)return!1;var Te=ye.createShader(ye.VERTEX_SHADER);return!Te||ye.isContextLost()?!1:(ye.shaderSource(Te,"void main() {}"),ye.compileShader(Te),ye.getShaderParameter(Te,ye.COMPILE_STATUS)===!0)}(le)),V[le]}(ne&&ne.failIfMajorPerformanceCaveat)?void 0:"insufficient WebGL support":"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support"}C.exports?C.exports=R:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=R,window.mapboxgl.notSupportedReason=F);var V={};R.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),l={create:function(C,R,F){var V=e.window.document.createElement(C);return R!==void 0&&(V.className=R),F&&F.appendChild(V),V},createNS:function(C,R){return e.window.document.createElementNS(C,R)}},o=e.window.document.documentElement.style;function u(C){if(!o)return C[0];for(var R=0;R<C.length;R++)if(C[R]in o)return C[R];return C[0]}var s,i=u(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);l.disableDrag=function(){o&&i&&(s=o[i],o[i]="none")},l.enableDrag=function(){o&&i&&(o[i]=s)};var c=u(["transform","WebkitTransform"]);l.setTransform=function(C,R){C.style[c]=R};var n=!1;try{var a=Object.defineProperty({},"passive",{get:function(){n=!0}});e.window.addEventListener("test",a,a),e.window.removeEventListener("test",a,a)}catch(C){n=!1}l.addEventListener=function(C,R,F,V){V===void 0&&(V={}),"passive"in V&&n?C.addEventListener(R,F,V):C.addEventListener(R,F,V.capture)},l.removeEventListener=function(C,R,F,V){V===void 0&&(V={}),"passive"in V&&n?C.removeEventListener(R,F,V):C.removeEventListener(R,F,V.capture)};var g=function(C){C.preventDefault(),C.stopPropagation(),e.window.removeEventListener("click",g,!0)};function p(C){var R=C.userImage;return R&&R.render&&R.render()?(C.data.replace(new Uint8Array(R.data.buffer)),!0):!1}l.suppressClick=function(){e.window.addEventListener("click",g,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",g,!0)},0)},l.mousePos=function(C,R){var F=C.getBoundingClientRect();return new e.Point(R.clientX-F.left-C.clientLeft,R.clientY-F.top-C.clientTop)},l.touchPos=function(C,R){for(var F=C.getBoundingClientRect(),V=[],ne=0;ne<R.length;ne++)V.push(new e.Point(R[ne].clientX-F.left-C.clientLeft,R[ne].clientY-F.top-C.clientTop));return V},l.mouseButton=function(C){return e.window.InstallTrigger!==void 0&&C.button===2&&C.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:C.button},l.remove=function(C){C.parentNode&&C.parentNode.removeChild(C)};var y=function(C){function R(){C.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.isLoaded=function(){return this.loaded},R.prototype.setLoaded=function(F){if(this.loaded!==F&&(this.loaded=F,F)){for(var V=0,ne=this.requestors;V<ne.length;V+=1){var le=ne[V],pe=le.ids,ye=le.callback;this._notify(pe,ye)}this.requestors=[]}},R.prototype.getImage=function(F){return this.images[F]},R.prototype.addImage=function(F,V){this._validate(F,V)&&(this.images[F]=V)},R.prototype._validate=function(F,V){var ne=!0;return this._validateStretch(V.stretchX,V.data&&V.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "stretchX" value'))),ne=!1),this._validateStretch(V.stretchY,V.data&&V.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "stretchY" value'))),ne=!1),this._validateContent(V.content,V)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "content" value'))),ne=!1),ne},R.prototype._validateStretch=function(F,V){if(!F)return!0;for(var ne=0,le=0,pe=F;le<pe.length;le+=1){var ye=pe[le];if(ye[0]<ne||ye[1]<ye[0]||V<ye[1])return!1;ne=ye[1]}return!0},R.prototype._validateContent=function(F,V){return!F||F.length===4&&!(F[0]<0||V.data.width<F[0])&&!(F[1]<0||V.data.height<F[1])&&!(F[2]<0||V.data.width<F[2])&&!(F[3]<0||V.data.height<F[3])&&!(F[2]<F[0])&&!(F[3]<F[1])},R.prototype.updateImage=function(F,V){var ne=this.images[F];V.version=ne.version+1,this.images[F]=V,this.updatedImages[F]=!0},R.prototype.removeImage=function(F){var V=this.images[F];delete this.images[F],delete this.patterns[F],V.userImage&&V.userImage.onRemove&&V.userImage.onRemove()},R.prototype.listImages=function(){return Object.keys(this.images)},R.prototype.getImages=function(F,V){var ne=!0;if(!this.isLoaded())for(var le=0,pe=F;le<pe.length;le+=1){var ye=pe[le];this.images[ye]||(ne=!1)}this.isLoaded()||ne?this._notify(F,V):this.requestors.push({ids:F,callback:V})},R.prototype._notify=function(F,V){for(var ne={},le=0,pe=F;le<pe.length;le+=1){var ye=pe[le];this.images[ye]||this.fire(new e.Event("styleimagemissing",{id:ye}));var Te=this.images[ye];Te?ne[ye]={data:Te.data.clone(),pixelRatio:Te.pixelRatio,sdf:Te.sdf,version:Te.version,stretchX:Te.stretchX,stretchY:Te.stretchY,content:Te.content,hasRenderCallback:Boolean(Te.userImage&&Te.userImage.render)}:e.warnOnce('Image "'+ye+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}V(null,ne)},R.prototype.getPixelSize=function(){var F=this.atlasImage;return{width:F.width,height:F.height}},R.prototype.getPattern=function(F){var V=this.patterns[F],ne=this.getImage(F);if(!ne)return null;if(V&&V.position.version===ne.version)return V.position;if(V)V.position.version=ne.version;else{var le={w:ne.data.width+2,h:ne.data.height+2,x:0,y:0},pe=new e.ImagePosition(le,ne);this.patterns[F]={bin:le,position:pe}}return this._updatePatternAtlas(),this.patterns[F].position},R.prototype.bind=function(F){var V=F.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(F,this.atlasImage,V.RGBA),this.atlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE)},R.prototype._updatePatternAtlas=function(){var F=[];for(var V in this.patterns)F.push(this.patterns[V].bin);var ne=e.potpack(F),le=ne.w,pe=ne.h,ye=this.atlasImage;for(var Te in ye.resize({width:le||1,height:pe||1}),this.patterns){var Ne=this.patterns[Te].bin,Ge=Ne.x+1,nt=Ne.y+1,bt=this.images[Te].data,Ct=bt.width,Tt=bt.height;e.RGBAImage.copy(bt,ye,{x:0,y:0},{x:Ge,y:nt},{width:Ct,height:Tt}),e.RGBAImage.copy(bt,ye,{x:0,y:Tt-1},{x:Ge,y:nt-1},{width:Ct,height:1}),e.RGBAImage.copy(bt,ye,{x:0,y:0},{x:Ge,y:nt+Tt},{width:Ct,height:1}),e.RGBAImage.copy(bt,ye,{x:Ct-1,y:0},{x:Ge-1,y:nt},{width:1,height:Tt}),e.RGBAImage.copy(bt,ye,{x:0,y:0},{x:Ge+Ct,y:nt},{width:1,height:Tt})}this.dirty=!0},R.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},R.prototype.dispatchRenderCallbacks=function(F){for(var V=0,ne=F;V<ne.length;V+=1){var le=ne[V];if(!this.callbackDispatchedThisFrame[le]){this.callbackDispatchedThisFrame[le]=!0;var pe=this.images[le];p(pe)&&this.updateImage(le,pe)}}},R}(e.Evented),v=T,b=T,x=1e20;function T(C,R,F,V,ne,le){this.fontSize=C||24,this.buffer=R===void 0?3:R,this.cutoff=V||.25,this.fontFamily=ne||"sans-serif",this.fontWeight=le||"normal",this.radius=F||8;var pe=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=pe,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(pe*pe),this.gridInner=new Float64Array(pe*pe),this.f=new Float64Array(pe),this.d=new Float64Array(pe),this.z=new Float64Array(pe+1),this.v=new Int16Array(pe),this.middle=Math.round(pe/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function A(C,R,F,V,ne,le,pe){for(var ye=0;ye<R;ye++){for(var Te=0;Te<F;Te++)V[Te]=C[Te*R+ye];for(S(V,ne,le,pe,F),Te=0;Te<F;Te++)C[Te*R+ye]=ne[Te]}for(Te=0;Te<F;Te++){for(ye=0;ye<R;ye++)V[ye]=C[Te*R+ye];for(S(V,ne,le,pe,R),ye=0;ye<R;ye++)C[Te*R+ye]=Math.sqrt(ne[ye])}}function S(C,R,F,V,ne){F[0]=0,V[0]=-x,V[1]=+x;for(var le=1,pe=0;le<ne;le++){for(var ye=(C[le]+le*le-(C[F[pe]]+F[pe]*F[pe]))/(2*le-2*F[pe]);ye<=V[pe];)pe--,ye=(C[le]+le*le-(C[F[pe]]+F[pe]*F[pe]))/(2*le-2*F[pe]);F[++pe]=le,V[pe]=ye,V[pe+1]=+x}for(le=0,pe=0;le<ne;le++){for(;V[pe+1]<le;)pe++;R[le]=(le-F[pe])*(le-F[pe])+C[F[pe]]}}T.prototype.draw=function(C){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(C,this.buffer,this.middle);for(var R=this.ctx.getImageData(0,0,this.size,this.size),F=new Uint8ClampedArray(this.size*this.size),V=0;V<this.size*this.size;V++){var ne=R.data[4*V+3]/255;this.gridOuter[V]=ne===1?0:ne===0?x:Math.pow(Math.max(0,.5-ne),2),this.gridInner[V]=ne===1?x:ne===0?0:Math.pow(Math.max(0,ne-.5),2)}for(A(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),A(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),V=0;V<this.size*this.size;V++){var le=this.gridOuter[V]-this.gridInner[V];F[V]=Math.max(0,Math.min(255,Math.round(255-255*(le/this.radius+this.cutoff))))}return F},v.default=b;var w=function(C,R){this.requestManager=C,this.localIdeographFontFamily=R,this.entries={}};w.prototype.setURL=function(C){this.url=C},w.prototype.getGlyphs=function(C,R){var F=this,V=[];for(var ne in C)for(var le=0,pe=C[ne];le<pe.length;le+=1){var ye=pe[le];V.push({stack:ne,id:ye})}e.asyncAll(V,function(Te,Ne){var Ge=Te.stack,nt=Te.id,bt=F.entries[Ge];bt||(bt=F.entries[Ge]={glyphs:{},requests:{},ranges:{}});var Ct=bt.glyphs[nt];if(Ct===void 0){if(Ct=F._tinySDF(bt,Ge,nt))return bt.glyphs[nt]=Ct,void Ne(null,{stack:Ge,id:nt,glyph:Ct});var Tt=Math.floor(nt/256);if(256*Tt>65535)Ne(new Error("glyphs > 65535 not supported"));else if(bt.ranges[Tt])Ne(null,{stack:Ge,id:nt,glyph:Ct});else{var At=bt.requests[Tt];At||(At=bt.requests[Tt]=[],w.loadGlyphRange(Ge,Tt,F.url,F.requestManager,function(yt,Ft){if(Ft){for(var zt in Ft)F._doesCharSupportLocalGlyph(+zt)||(bt.glyphs[+zt]=Ft[+zt]);bt.ranges[Tt]=!0}for(var jt=0,rr=At;jt<rr.length;jt+=1)(0,rr[jt])(yt,Ft);delete bt.requests[Tt]})),At.push(function(yt,Ft){yt?Ne(yt):Ft&&Ne(null,{stack:Ge,id:nt,glyph:Ft[nt]||null})})}}else Ne(null,{stack:Ge,id:nt,glyph:Ct})},function(Te,Ne){if(Te)R(Te);else if(Ne){for(var Ge={},nt=0,bt=Ne;nt<bt.length;nt+=1){var Ct=bt[nt],Tt=Ct.stack,At=Ct.id,yt=Ct.glyph;(Ge[Tt]||(Ge[Tt]={}))[At]=yt&&{id:yt.id,bitmap:yt.bitmap.clone(),metrics:yt.metrics}}R(null,Ge)}})},w.prototype._doesCharSupportLocalGlyph=function(C){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](C)||e.isChar["Hangul Syllables"](C)||e.isChar.Hiragana(C)||e.isChar.Katakana(C))},w.prototype._tinySDF=function(C,R,F){var V=this.localIdeographFontFamily;if(V&&this._doesCharSupportLocalGlyph(F)){var ne=C.tinySDF;if(!ne){var le="400";/bold/i.test(R)?le="900":/medium/i.test(R)?le="500":/light/i.test(R)&&(le="200"),ne=C.tinySDF=new w.TinySDF(24,3,8,.25,V,le)}return{id:F,bitmap:new e.AlphaImage({width:30,height:30},ne.draw(String.fromCharCode(F))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},w.loadGlyphRange=function(C,R,F,V,ne){var le=256*R,pe=le+255,ye=V.transformRequest(V.normalizeGlyphsURL(F).replace("{fontstack}",C).replace("{range}",le+"-"+pe),e.ResourceType.Glyphs);e.getArrayBuffer(ye,function(Te,Ne){if(Te)ne(Te);else if(Ne){for(var Ge={},nt=0,bt=e.parseGlyphPBF(Ne);nt<bt.length;nt+=1){var Ct=bt[nt];Ge[Ct.id]=Ct}ne(null,Ge)}})},w.TinySDF=v;var E=function(){this.specification=e.styleSpec.light.position};E.prototype.possiblyEvaluate=function(C,R){return e.sphericalToCartesian(C.expression.evaluate(R))},E.prototype.interpolate=function(C,R,F){return{x:e.number(C.x,R.x,F),y:e.number(C.y,R.y,F),z:e.number(C.z,R.z,F)}};var k=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new E,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),L=function(C){function R(F){C.call(this),this._transitionable=new e.Transitionable(k),this.setLight(F),this._transitioning=this._transitionable.untransitioned()}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getLight=function(){return this._transitionable.serialize()},R.prototype.setLight=function(F,V){if(V===void 0&&(V={}),!this._validate(e.validateLight,F,V))for(var ne in F){var le=F[ne];e.endsWith(ne,"-transition")?this._transitionable.setTransition(ne.slice(0,-"-transition".length),le):this._transitionable.setValue(ne,le)}},R.prototype.updateTransitions=function(F){this._transitioning=this._transitionable.transitioned(F,this._transitioning)},R.prototype.hasTransition=function(){return this._transitioning.hasTransition()},R.prototype.recalculate=function(F){this.properties=this._transitioning.possiblyEvaluate(F)},R.prototype._validate=function(F,V,ne){return(!ne||ne.validate!==!1)&&e.emitValidationErrors(this,F.call(e.validateStyle,e.extend({value:V,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},R}(e.Evented),M=function(C,R){this.width=C,this.height=R,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};M.prototype.getDash=function(C,R){var F=C.join(",")+String(R);return this.dashEntry[F]||(this.dashEntry[F]=this.addDash(C,R)),this.dashEntry[F]},M.prototype.getDashRanges=function(C,R,F){var V=[],ne=C.length%2==1?-C[C.length-1]*F:0,le=C[0]*F,pe=!0;V.push({left:ne,right:le,isDash:pe,zeroLength:C[0]===0});for(var ye=C[0],Te=1;Te<C.length;Te++){pe=!pe;var Ne=C[Te];ne=ye*F,le=(ye+=Ne)*F,V.push({left:ne,right:le,isDash:pe,zeroLength:Ne===0})}return V},M.prototype.addRoundDash=function(C,R,F){for(var V=R/2,ne=-F;ne<=F;ne++)for(var le=this.nextRow+F+ne,pe=this.width*le,ye=0,Te=C[ye],Ne=0;Ne<this.width;Ne++){Ne/Te.right>1&&(Te=C[++ye]);var Ge=Math.abs(Ne-Te.left),nt=Math.abs(Ne-Te.right),bt=Math.min(Ge,nt),Ct=void 0,Tt=ne/F*(V+1);if(Te.isDash){var At=V-Math.abs(Tt);Ct=Math.sqrt(bt*bt+At*At)}else Ct=V-Math.sqrt(bt*bt+Tt*Tt);this.data[pe+Ne]=Math.max(0,Math.min(255,Ct+128))}},M.prototype.addRegularDash=function(C){for(var R=C.length-1;R>=0;--R){var F=C[R],V=C[R+1];F.zeroLength?C.splice(R,1):V&&V.isDash===F.isDash&&(V.left=F.left,C.splice(R,1))}var ne=C[0],le=C[C.length-1];ne.isDash===le.isDash&&(ne.left=le.left-this.width,le.right=ne.right+this.width);for(var pe=this.width*this.nextRow,ye=0,Te=C[ye],Ne=0;Ne<this.width;Ne++){Ne/Te.right>1&&(Te=C[++ye]);var Ge=Math.abs(Ne-Te.left),nt=Math.abs(Ne-Te.right),bt=Math.min(Ge,nt),Ct=Te.isDash?bt:-bt;this.data[pe+Ne]=Math.max(0,Math.min(255,Ct+128))}},M.prototype.addDash=function(C,R){var F=R?7:0,V=2*F+1;if(this.nextRow+V>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var ne=0,le=0;le<C.length;le++)ne+=C[le];if(ne!==0){var pe=this.width/ne,ye=this.getDashRanges(C,this.width,pe);R?this.addRoundDash(ye,pe,F):this.addRegularDash(ye)}var Te={y:(this.nextRow+F+.5)/this.height,height:2*F/this.height,width:ne};return this.nextRow+=V,this.dirty=!0,Te},M.prototype.bind=function(C){var R=C.gl;this.texture?(R.bindTexture(R.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,R.texSubImage2D(R.TEXTURE_2D,0,0,0,this.width,this.height,R.ALPHA,R.UNSIGNED_BYTE,this.data))):(this.texture=R.createTexture(),R.bindTexture(R.TEXTURE_2D,this.texture),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_WRAP_S,R.REPEAT),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_WRAP_T,R.REPEAT),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MIN_FILTER,R.LINEAR),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MAG_FILTER,R.LINEAR),R.texImage2D(R.TEXTURE_2D,0,R.ALPHA,this.width,this.height,0,R.ALPHA,R.UNSIGNED_BYTE,this.data))};var P=function C(R,F){this.workerPool=R,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var V=this.workerPool.acquire(this.id),ne=0;ne<V.length;ne++){var le=V[ne],pe=new C.Actor(le,F,this.id);pe.name="Worker "+ne,this.actors.push(pe)}};function D(C,R,F){var V=function(ne,le){if(ne)return F(ne);if(le){var pe=e.pick(e.extend(le,C),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);le.vector_layers&&(pe.vectorLayers=le.vector_layers,pe.vectorLayerIds=pe.vectorLayers.map(function(ye){return ye.id})),pe.tiles=R.canonicalizeTileset(pe,C.url),F(null,pe)}};return C.url?e.getJSON(R.transformRequest(R.normalizeSourceURL(C.url),e.ResourceType.Source),V):e.browser.frame(function(){return V(null,C)})}P.prototype.broadcast=function(C,R,F){F=F||function(){},e.asyncAll(this.actors,function(V,ne){V.send(C,R,ne)},F)},P.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},P.prototype.remove=function(){this.actors.forEach(function(C){C.remove()}),this.actors=[],this.workerPool.release(this.id)},P.Actor=e.Actor;var N=function(C,R,F){this.bounds=e.LngLatBounds.convert(this.validateBounds(C)),this.minzoom=R||0,this.maxzoom=F||24};N.prototype.validateBounds=function(C){return Array.isArray(C)&&C.length===4?[Math.max(-180,C[0]),Math.max(-90,C[1]),Math.min(180,C[2]),Math.min(90,C[3])]:[-180,-90,180,90]},N.prototype.contains=function(C){var R=Math.pow(2,C.z),F=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*R),V=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*R),ne=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*R),le=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*R);return C.x>=F&&C.x<ne&&C.y>=V&&C.y<le};var U=function(C){function R(F,V,ne,le){if(C.call(this),this.id=F,this.dispatcher=ne,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(V,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},V),this._collectResourceTiming=V.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(le)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(){var F=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=D(this._options,this.map._requestManager,function(V,ne){F._tileJSONRequest=null,F._loaded=!0,V?F.fire(new e.ErrorEvent(V)):ne&&(e.extend(F,ne),ne.bounds&&(F.tileBounds=new N(ne.bounds,F.minzoom,F.maxzoom)),e.postTurnstileEvent(ne.tiles,F.map._requestManager._customAccessToken),e.postMapLoadEvent(ne.tiles,F.map._getMapId(),F.map._requestManager._skuToken,F.map._requestManager._customAccessToken),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},R.prototype.loaded=function(){return this._loaded},R.prototype.hasTile=function(F){return!this.tileBounds||this.tileBounds.contains(F.canonical)},R.prototype.onAdd=function(F){this.map=F,this.load()},R.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},R.prototype.serialize=function(){return e.extend({},this._options)},R.prototype.loadTile=function(F,V){var ne=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme)),le={request:this.map._requestManager.transformRequest(ne,e.ResourceType.Tile),uid:F.uid,tileID:F.tileID,zoom:F.tileID.overscaledZ,tileSize:this.tileSize*F.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function pe(ye,Te){return delete F.request,F.aborted?V(null):ye&&ye.status!==404?V(ye):(Te&&Te.resourceTiming&&(F.resourceTiming=Te.resourceTiming),this.map._refreshExpiredTiles&&Te&&F.setExpiryData(Te),F.loadVectorData(Te,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),V(null),void(F.reloadCallback&&(this.loadTile(F,F.reloadCallback),F.reloadCallback=null)))}le.request.collectResourceTiming=this._collectResourceTiming,F.actor&&F.state!=="expired"?F.state==="loading"?F.reloadCallback=V:F.request=F.actor.send("reloadTile",le,pe.bind(this)):(F.actor=this.dispatcher.getActor(),F.request=F.actor.send("loadTile",le,pe.bind(this)))},R.prototype.abortTile=function(F){F.request&&(F.request.cancel(),delete F.request),F.actor&&F.actor.send("abortTile",{uid:F.uid,type:this.type,source:this.id},void 0)},R.prototype.unloadTile=function(F){F.unloadVectorData(),F.actor&&F.actor.send("removeTile",{uid:F.uid,type:this.type,source:this.id},void 0)},R.prototype.hasTransition=function(){return!1},R}(e.Evented),G=function(C){function R(F,V,ne,le){C.call(this),this.id=F,this.dispatcher=ne,this.setEventedParent(le),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},V),e.extend(this,e.pick(V,["url","scheme","tileSize"]))}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(){var F=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=D(this._options,this.map._requestManager,function(V,ne){F._tileJSONRequest=null,F._loaded=!0,V?F.fire(new e.ErrorEvent(V)):ne&&(e.extend(F,ne),ne.bounds&&(F.tileBounds=new N(ne.bounds,F.minzoom,F.maxzoom)),e.postTurnstileEvent(ne.tiles),e.postMapLoadEvent(ne.tiles,F.map._getMapId(),F.map._requestManager._skuToken),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},R.prototype.loaded=function(){return this._loaded},R.prototype.onAdd=function(F){this.map=F,this.load()},R.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},R.prototype.serialize=function(){return e.extend({},this._options)},R.prototype.hasTile=function(F){return!this.tileBounds||this.tileBounds.contains(F.canonical)},R.prototype.loadTile=function(F,V){var ne=this,le=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);F.request=e.getImage(this.map._requestManager.transformRequest(le,e.ResourceType.Tile),function(pe,ye){if(delete F.request,F.aborted)F.state="unloaded",V(null);else if(pe)F.state="errored",V(pe);else if(ye){ne.map._refreshExpiredTiles&&F.setExpiryData(ye),delete ye.cacheControl,delete ye.expires;var Te=ne.map.painter.context,Ne=Te.gl;F.texture=ne.map.painter.getTileTexture(ye.width),F.texture?F.texture.update(ye,{useMipmap:!0}):(F.texture=new e.Texture(Te,ye,Ne.RGBA,{useMipmap:!0}),F.texture.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE,Ne.LINEAR_MIPMAP_NEAREST),Te.extTextureFilterAnisotropic&&Ne.texParameterf(Ne.TEXTURE_2D,Te.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Te.extTextureFilterAnisotropicMax)),F.state="loaded",e.cacheEntryPossiblyAdded(ne.dispatcher),V(null)}})},R.prototype.abortTile=function(F,V){F.request&&(F.request.cancel(),delete F.request),V()},R.prototype.unloadTile=function(F,V){F.texture&&this.map.painter.saveTileTexture(F.texture),V()},R.prototype.hasTransition=function(){return!1},R}(e.Evented),X=function(C){function R(F,V,ne,le){C.call(this,F,V,ne,le),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},V),this.encoding=V.encoding||"mapbox"}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},R.prototype.loadTile=function(F,V){var ne=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function le(pe,ye){pe&&(F.state="errored",V(pe)),ye&&(F.dem=ye,F.needsHillshadePrepare=!0,F.state="loaded",V(null))}F.request=e.getImage(this.map._requestManager.transformRequest(ne,e.ResourceType.Tile),function(pe,ye){if(delete F.request,F.aborted)F.state="unloaded",V(null);else if(pe)F.state="errored",V(pe);else if(ye){this.map._refreshExpiredTiles&&F.setExpiryData(ye),delete ye.cacheControl,delete ye.expires;var Te=e.window.ImageBitmap&&ye instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported()?ye:e.browser.getImageData(ye,1),Ne={uid:F.uid,coord:F.tileID,source:this.id,rawImageData:Te,encoding:this.encoding};F.actor&&F.state!=="expired"||(F.actor=this.dispatcher.getActor(),F.actor.send("loadDEMTile",Ne,le.bind(this)))}}.bind(this)),F.neighboringTiles=this._getNeighboringTiles(F.tileID)},R.prototype._getNeighboringTiles=function(F){var V=F.canonical,ne=Math.pow(2,V.z),le=(V.x-1+ne)%ne,pe=V.x===0?F.wrap-1:F.wrap,ye=(V.x+1+ne)%ne,Te=V.x+1===ne?F.wrap+1:F.wrap,Ne={};return Ne[new e.OverscaledTileID(F.overscaledZ,pe,V.z,le,V.y).key]={backfilled:!1},Ne[new e.OverscaledTileID(F.overscaledZ,Te,V.z,ye,V.y).key]={backfilled:!1},V.y>0&&(Ne[new e.OverscaledTileID(F.overscaledZ,pe,V.z,le,V.y-1).key]={backfilled:!1},Ne[new e.OverscaledTileID(F.overscaledZ,F.wrap,V.z,V.x,V.y-1).key]={backfilled:!1},Ne[new e.OverscaledTileID(F.overscaledZ,Te,V.z,ye,V.y-1).key]={backfilled:!1}),V.y+1<ne&&(Ne[new e.OverscaledTileID(F.overscaledZ,pe,V.z,le,V.y+1).key]={backfilled:!1},Ne[new e.OverscaledTileID(F.overscaledZ,F.wrap,V.z,V.x,V.y+1).key]={backfilled:!1},Ne[new e.OverscaledTileID(F.overscaledZ,Te,V.z,ye,V.y+1).key]={backfilled:!1}),Ne},R.prototype.unloadTile=function(F){F.demTexture&&this.map.painter.saveTileTexture(F.demTexture),F.fbo&&(F.fbo.destroy(),delete F.fbo),F.dem&&delete F.dem,delete F.neighboringTiles,F.state="unloaded",F.actor&&F.actor.send("removeDEMTile",{uid:F.uid,source:this.id})},R}(G),K=function(C){function R(F,V,ne,le){C.call(this),this.id=F,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=ne.getActor(),this.setEventedParent(le),this._data=V.data,this._options=e.extend({},V),this._collectResourceTiming=V.collectResourceTiming,this._resourceTiming=[],V.maxzoom!==void 0&&(this.maxzoom=V.maxzoom),V.type&&(this.type=V.type),V.attribution&&(this.attribution=V.attribution),this.promoteId=V.promoteId;var pe=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:V.cluster||!1,geojsonVtOptions:{buffer:(V.buffer!==void 0?V.buffer:128)*pe,tolerance:(V.tolerance!==void 0?V.tolerance:.375)*pe,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:V.lineMetrics||!1,generateId:V.generateId||!1},superclusterOptions:{maxZoom:V.clusterMaxZoom!==void 0?Math.min(V.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(V.clusterRadius||50)*pe,log:!1,generateId:V.generateId||!1},clusterProperties:V.clusterProperties},V.workerOptions)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(){var F=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(V){if(V)F.fire(new e.ErrorEvent(V));else{var ne={dataType:"source",sourceDataType:"metadata"};F._collectResourceTiming&&F._resourceTiming&&F._resourceTiming.length>0&&(ne.resourceTiming=F._resourceTiming,F._resourceTiming=[]),F.fire(new e.Event("data",ne))}})},R.prototype.onAdd=function(F){this.map=F,this.load()},R.prototype.setData=function(F){var V=this;return this._data=F,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(ne){if(ne)V.fire(new e.ErrorEvent(ne));else{var le={dataType:"source",sourceDataType:"content"};V._collectResourceTiming&&V._resourceTiming&&V._resourceTiming.length>0&&(le.resourceTiming=V._resourceTiming,V._resourceTiming=[]),V.fire(new e.Event("data",le))}}),this},R.prototype.getClusterExpansionZoom=function(F,V){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:F,source:this.id},V),this},R.prototype.getClusterChildren=function(F,V){return this.actor.send("geojson.getClusterChildren",{clusterId:F,source:this.id},V),this},R.prototype.getClusterLeaves=function(F,V,ne,le){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:F,limit:V,offset:ne},le),this},R.prototype._updateWorkerData=function(F){var V=this;this._loaded=!1;var ne=e.extend({},this.workerOptions),le=this._data;typeof le=="string"?(ne.request=this.map._requestManager.transformRequest(e.browser.resolveURL(le),e.ResourceType.Source),ne.request.collectResourceTiming=this._collectResourceTiming):ne.data=JSON.stringify(le),this.actor.send(this.type+".loadData",ne,function(pe,ye){V._removed||ye&&ye.abandoned||(V._loaded=!0,ye&&ye.resourceTiming&&ye.resourceTiming[V.id]&&(V._resourceTiming=ye.resourceTiming[V.id].slice(0)),V.actor.send(V.type+".coalesce",{source:ne.source},null),F(pe))})},R.prototype.loaded=function(){return this._loaded},R.prototype.loadTile=function(F,V){var ne=this,le=F.actor?"reloadTile":"loadTile";F.actor=this.actor;var pe={type:this.type,uid:F.uid,tileID:F.tileID,zoom:F.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};F.request=this.actor.send(le,pe,function(ye,Te){return delete F.request,F.unloadVectorData(),F.aborted?V(null):ye?V(ye):(F.loadVectorData(Te,ne.map.painter,le==="reloadTile"),V(null))})},R.prototype.abortTile=function(F){F.request&&(F.request.cancel(),delete F.request),F.aborted=!0},R.prototype.unloadTile=function(F){F.unloadVectorData(),this.actor.send("removeTile",{uid:F.uid,type:this.type,source:this.id})},R.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},R.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},R.prototype.hasTransition=function(){return!1},R}(e.Evented),Z=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),H=function(C){function R(F,V,ne,le){C.call(this),this.id=F,this.dispatcher=ne,this.coordinates=V.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(le),this.options=V}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(F,V){var ne=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(le,pe){ne._loaded=!0,le?ne.fire(new e.ErrorEvent(le)):pe&&(ne.image=pe,F&&(ne.coordinates=F),V&&V(),ne._finishLoading())})},R.prototype.loaded=function(){return this._loaded},R.prototype.updateImage=function(F){var V=this;return this.image&&F.url?(this.options.url=F.url,this.load(F.coordinates,function(){V.texture=null}),this):this},R.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},R.prototype.onAdd=function(F){this.map=F,this.load()},R.prototype.setCoordinates=function(F){var V=this;this.coordinates=F;var ne=F.map(e.MercatorCoordinate.fromLngLat);this.tileID=function(pe){for(var ye=1/0,Te=1/0,Ne=-1/0,Ge=-1/0,nt=0,bt=pe;nt<bt.length;nt+=1){var Ct=bt[nt];ye=Math.min(ye,Ct.x),Te=Math.min(Te,Ct.y),Ne=Math.max(Ne,Ct.x),Ge=Math.max(Ge,Ct.y)}var Tt=Ne-ye,At=Ge-Te,yt=Math.max(Tt,At),Ft=Math.max(0,Math.floor(-Math.log(yt)/Math.LN2)),zt=Math.pow(2,Ft);return new e.CanonicalTileID(Ft,Math.floor((ye+Ne)/2*zt),Math.floor((Te+Ge)/2*zt))}(ne),this.minzoom=this.maxzoom=this.tileID.z;var le=ne.map(function(pe){return V.tileID.getTilePoint(pe)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(le[0].x,le[0].y,0,0),this._boundsArray.emplaceBack(le[1].x,le[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(le[3].x,le[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(le[2].x,le[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},R.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var F=this.map.painter.context,V=F.gl;for(var ne in this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,Z.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(F,this.image,V.RGBA),this.texture.bind(V.LINEAR,V.CLAMP_TO_EDGE)),this.tiles){var le=this.tiles[ne];le.state!=="loaded"&&(le.state="loaded",le.texture=this.texture)}}},R.prototype.loadTile=function(F,V){this.tileID&&this.tileID.equals(F.tileID.canonical)?(this.tiles[String(F.tileID.wrap)]=F,F.buckets={},V(null)):(F.state="errored",V(null))},R.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},R.prototype.hasTransition=function(){return!1},R}(e.Evented),Y=function(C){function R(F,V,ne,le){C.call(this,F,V,ne,le),this.roundZoom=!0,this.type="video",this.options=V}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(){var F=this;this._loaded=!1;var V=this.options;this.urls=[];for(var ne=0,le=V.urls;ne<le.length;ne+=1){var pe=le[ne];this.urls.push(this.map._requestManager.transformRequest(pe,e.ResourceType.Source).url)}e.getVideo(this.urls,function(ye,Te){F._loaded=!0,ye?F.fire(new e.ErrorEvent(ye)):Te&&(F.video=Te,F.video.loop=!0,F.video.addEventListener("playing",function(){F.map.triggerRepaint()}),F.map&&F.video.play(),F._finishLoading())})},R.prototype.pause=function(){this.video&&this.video.pause()},R.prototype.play=function(){this.video&&this.video.play()},R.prototype.seek=function(F){if(this.video){var V=this.video.seekable;F<V.start(0)||F>V.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+V.start(0)+" and "+V.end(0)+"-second mark."))):this.video.currentTime=F}},R.prototype.getVideo=function(){return this.video},R.prototype.onAdd=function(F){this.map||(this.map=F,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},R.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var F=this.map.painter.context,V=F.gl;for(var ne in this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,Z.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(V.LINEAR,V.CLAMP_TO_EDGE),V.texSubImage2D(V.TEXTURE_2D,0,0,0,V.RGBA,V.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(F,this.video,V.RGBA),this.texture.bind(V.LINEAR,V.CLAMP_TO_EDGE)),this.tiles){var le=this.tiles[ne];le.state!=="loaded"&&(le.state="loaded",le.texture=this.texture)}}},R.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},R.prototype.hasTransition=function(){return this.video&&!this.video.paused},R}(H),$=function(C){function R(F,V,ne,le){C.call(this,F,V,ne,le),V.coordinates?Array.isArray(V.coordinates)&&V.coordinates.length===4&&!V.coordinates.some(function(pe){return!Array.isArray(pe)||pe.length!==2||pe.some(function(ye){return typeof ye!="number"})})||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'missing required property "coordinates"'))),V.animate&&typeof V.animate!="boolean"&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'optional "animate" property must be a boolean value'))),V.canvas?typeof V.canvas=="string"||V.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'missing required property "canvas"'))),this.options=V,this.animate=V.animate===void 0||V.animate}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},R.prototype.getCanvas=function(){return this.canvas},R.prototype.onAdd=function(F){this.map=F,this.load(),this.canvas&&this.animate&&this.play()},R.prototype.onRemove=function(){this.pause()},R.prototype.prepare=function(){var F=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,F=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,F=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var V=this.map.painter.context,ne=V.gl;for(var le in this.boundsBuffer||(this.boundsBuffer=V.createVertexBuffer(this._boundsArray,Z.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(F||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(V,this.canvas,ne.RGBA,{premultiply:!0}),this.tiles){var pe=this.tiles[le];pe.state!=="loaded"&&(pe.state="loaded",pe.texture=this.texture)}}},R.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},R.prototype.hasTransition=function(){return this._playing},R.prototype._hasInvalidDimensions=function(){for(var F=0,V=[this.canvas.width,this.canvas.height];F<V.length;F+=1){var ne=V[F];if(isNaN(ne)||ne<=0)return!0}return!1},R}(H),z={vector:U,raster:G,"raster-dem":X,geojson:K,video:Y,image:H,canvas:$};function j(C,R){var F=e.identity([]);return e.translate(F,F,[1,1,0]),e.scale(F,F,[.5*C.width,.5*C.height,1]),e.multiply(F,F,C.calculatePosMatrix(R.toUnwrapped()))}function W(C,R,F,V,ne,le){var pe=function(At,yt,Ft){if(At)for(var zt=0,jt=At;zt<jt.length;zt+=1){var rr=yt[jt[zt]];if(rr&&rr.source===Ft&&rr.type==="fill-extrusion")return!0}else for(var hr in yt){var Ar=yt[hr];if(Ar.source===Ft&&Ar.type==="fill-extrusion")return!0}return!1}(ne&&ne.layers,R,C.id),ye=le.maxPitchScaleFactor(),Te=C.tilesIn(V,ye,pe);Te.sort(ee);for(var Ne=[],Ge=0,nt=Te;Ge<nt.length;Ge+=1){var bt=nt[Ge];Ne.push({wrappedTileID:bt.tileID.wrapped().key,queryResults:bt.tile.queryRenderedFeatures(R,F,C._state,bt.queryGeometry,bt.cameraQueryGeometry,bt.scale,ne,le,ye,j(C.transform,bt.tileID))})}var Ct=function(At){for(var yt={},Ft={},zt=0,jt=At;zt<jt.length;zt+=1){var rr=jt[zt],hr=rr.queryResults,Ar=rr.wrappedTileID,kr=Ft[Ar]=Ft[Ar]||{};for(var Kr in hr)for(var Zr=hr[Kr],hn=kr[Kr]=kr[Kr]||{},sn=yt[Kr]=yt[Kr]||[],Un=0,Wn=Zr;Un<Wn.length;Un+=1){var ua=Wn[Un];hn[ua.featureIndex]||(hn[ua.featureIndex]=!0,sn.push(ua))}}return yt}(Ne);for(var Tt in Ct)Ct[Tt].forEach(function(At){var yt=At.feature,Ft=C.getFeatureState(yt.layer["source-layer"],yt.id);yt.source=yt.layer.source,yt.layer["source-layer"]&&(yt.sourceLayer=yt.layer["source-layer"]),yt.state=Ft});return Ct}function ee(C,R){var F=C.tileID,V=R.tileID;return F.overscaledZ-V.overscaledZ||F.canonical.y-V.canonical.y||F.wrap-V.wrap||F.canonical.x-V.canonical.x}var J=function(C,R){this.max=C,this.onRemove=R,this.reset()};J.prototype.reset=function(){for(var C in this.data)for(var R=0,F=this.data[C];R<F.length;R+=1){var V=F[R];V.timeout&&clearTimeout(V.timeout),this.onRemove(V.value)}return this.data={},this.order=[],this},J.prototype.add=function(C,R,F){var V=this,ne=C.wrapped().key;this.data[ne]===void 0&&(this.data[ne]=[]);var le={value:R,timeout:void 0};if(F!==void 0&&(le.timeout=setTimeout(function(){V.remove(C,le)},F)),this.data[ne].push(le),this.order.push(ne),this.order.length>this.max){var pe=this._getAndRemoveByKey(this.order[0]);pe&&this.onRemove(pe)}return this},J.prototype.has=function(C){return C.wrapped().key in this.data},J.prototype.getAndRemove=function(C){return this.has(C)?this._getAndRemoveByKey(C.wrapped().key):null},J.prototype._getAndRemoveByKey=function(C){var R=this.data[C].shift();return R.timeout&&clearTimeout(R.timeout),this.data[C].length===0&&delete this.data[C],this.order.splice(this.order.indexOf(C),1),R.value},J.prototype.getByKey=function(C){var R=this.data[C];return R?R[0].value:null},J.prototype.get=function(C){return this.has(C)?this.data[C.wrapped().key][0].value:null},J.prototype.remove=function(C,R){if(!this.has(C))return this;var F=C.wrapped().key,V=R===void 0?0:this.data[F].indexOf(R),ne=this.data[F][V];return this.data[F].splice(V,1),ne.timeout&&clearTimeout(ne.timeout),this.data[F].length===0&&delete this.data[F],this.onRemove(ne.value),this.order.splice(this.order.indexOf(F),1),this},J.prototype.setMaxSize=function(C){for(this.max=C;this.order.length>this.max;){var R=this._getAndRemoveByKey(this.order[0]);R&&this.onRemove(R)}return this},J.prototype.filter=function(C){var R=[];for(var F in this.data)for(var V=0,ne=this.data[F];V<ne.length;V+=1){var le=ne[V];C(le.value)||R.push(le)}for(var pe=0,ye=R;pe<ye.length;pe+=1){var Te=ye[pe];this.remove(Te.value.tileID,Te)}};var Q=function(C,R,F){this.context=C;var V=C.gl;this.buffer=V.createBuffer(),this.dynamicDraw=Boolean(F),this.context.unbindVAO(),C.bindElementBuffer.set(this.buffer),V.bufferData(V.ELEMENT_ARRAY_BUFFER,R.arrayBuffer,this.dynamicDraw?V.DYNAMIC_DRAW:V.STATIC_DRAW),this.dynamicDraw||delete R.arrayBuffer};Q.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Q.prototype.updateData=function(C){var R=this.context.gl;this.context.unbindVAO(),this.bind(),R.bufferSubData(R.ELEMENT_ARRAY_BUFFER,0,C.arrayBuffer)},Q.prototype.destroy=function(){var C=this.context.gl;this.buffer&&(C.deleteBuffer(this.buffer),delete this.buffer)};var te={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ie=function(C,R,F,V){this.length=R.length,this.attributes=F,this.itemSize=R.bytesPerElement,this.dynamicDraw=V,this.context=C;var ne=C.gl;this.buffer=ne.createBuffer(),C.bindVertexBuffer.set(this.buffer),ne.bufferData(ne.ARRAY_BUFFER,R.arrayBuffer,this.dynamicDraw?ne.DYNAMIC_DRAW:ne.STATIC_DRAW),this.dynamicDraw||delete R.arrayBuffer};ie.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ie.prototype.updateData=function(C){var R=this.context.gl;this.bind(),R.bufferSubData(R.ARRAY_BUFFER,0,C.arrayBuffer)},ie.prototype.enableAttributes=function(C,R){for(var F=0;F<this.attributes.length;F++){var V=this.attributes[F],ne=R.attributes[V.name];ne!==void 0&&C.enableVertexAttribArray(ne)}},ie.prototype.setVertexAttribPointers=function(C,R,F){for(var V=0;V<this.attributes.length;V++){var ne=this.attributes[V],le=R.attributes[ne.name];le!==void 0&&C.vertexAttribPointer(le,ne.components,C[te[ne.type]],!1,this.itemSize,ne.offset+this.itemSize*(F||0))}},ie.prototype.destroy=function(){var C=this.context.gl;this.buffer&&(C.deleteBuffer(this.buffer),delete this.buffer)};var ae=function(C){this.gl=C.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ae.prototype.get=function(){return this.current},ae.prototype.set=function(C){},ae.prototype.getDefault=function(){return this.default},ae.prototype.setDefault=function(){this.set(this.default)};var he=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return e.Color.transparent},R.prototype.set=function(F){var V=this.current;(F.r!==V.r||F.g!==V.g||F.b!==V.b||F.a!==V.a||this.dirty)&&(this.gl.clearColor(F.r,F.g,F.b,F.a),this.current=F,this.dirty=!1)},R}(ae),se=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return 1},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.clearDepth(F),this.current=F,this.dirty=!1)},R}(ae),de=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return 0},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.clearStencil(F),this.current=F,this.dirty=!1)},R}(ae),ue=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return[!0,!0,!0,!0]},R.prototype.set=function(F){var V=this.current;(F[0]!==V[0]||F[1]!==V[1]||F[2]!==V[2]||F[3]!==V[3]||this.dirty)&&(this.gl.colorMask(F[0],F[1],F[2],F[3]),this.current=F,this.dirty=!1)},R}(ae),ve=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!0},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.depthMask(F),this.current=F,this.dirty=!1)},R}(ae),ke=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return 255},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.stencilMask(F),this.current=F,this.dirty=!1)},R}(ae),Ee=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},R.prototype.set=function(F){var V=this.current;(F.func!==V.func||F.ref!==V.ref||F.mask!==V.mask||this.dirty)&&(this.gl.stencilFunc(F.func,F.ref,F.mask),this.current=F,this.dirty=!1)},R}(ae),be=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){var F=this.gl;return[F.KEEP,F.KEEP,F.KEEP]},R.prototype.set=function(F){var V=this.current;(F[0]!==V[0]||F[1]!==V[1]||F[2]!==V[2]||this.dirty)&&(this.gl.stencilOp(F[0],F[1],F[2]),this.current=F,this.dirty=!1)},R}(ae),xe=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;F?V.enable(V.STENCIL_TEST):V.disable(V.STENCIL_TEST),this.current=F,this.dirty=!1}},R}(ae),ce=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return[0,1]},R.prototype.set=function(F){var V=this.current;(F[0]!==V[0]||F[1]!==V[1]||this.dirty)&&(this.gl.depthRange(F[0],F[1]),this.current=F,this.dirty=!1)},R}(ae),ge=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;F?V.enable(V.DEPTH_TEST):V.disable(V.DEPTH_TEST),this.current=F,this.dirty=!1}},R}(ae),we=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.LESS},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.depthFunc(F),this.current=F,this.dirty=!1)},R}(ae),Me=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;F?V.enable(V.BLEND):V.disable(V.BLEND),this.current=F,this.dirty=!1}},R}(ae),Se=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){var F=this.gl;return[F.ONE,F.ZERO]},R.prototype.set=function(F){var V=this.current;(F[0]!==V[0]||F[1]!==V[1]||this.dirty)&&(this.gl.blendFunc(F[0],F[1]),this.current=F,this.dirty=!1)},R}(ae),ze=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return e.Color.transparent},R.prototype.set=function(F){var V=this.current;(F.r!==V.r||F.g!==V.g||F.b!==V.b||F.a!==V.a||this.dirty)&&(this.gl.blendColor(F.r,F.g,F.b,F.a),this.current=F,this.dirty=!1)},R}(ae),Fe=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.FUNC_ADD},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.blendEquation(F),this.current=F,this.dirty=!1)},R}(ae),Ye=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;F?V.enable(V.CULL_FACE):V.disable(V.CULL_FACE),this.current=F,this.dirty=!1}},R}(ae),rt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.BACK},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.cullFace(F),this.current=F,this.dirty=!1)},R}(ae),Oe=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.CCW},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.frontFace(F),this.current=F,this.dirty=!1)},R}(ae),je=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.useProgram(F),this.current=F,this.dirty=!1)},R}(ae),We=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.TEXTURE0},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.activeTexture(F),this.current=F,this.dirty=!1)},R}(ae),qe=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){var F=this.gl;return[0,0,F.drawingBufferWidth,F.drawingBufferHeight]},R.prototype.set=function(F){var V=this.current;(F[0]!==V[0]||F[1]!==V[1]||F[2]!==V[2]||F[3]!==V[3]||this.dirty)&&(this.gl.viewport(F[0],F[1],F[2],F[3]),this.current=F,this.dirty=!1)},R}(ae),et=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;V.bindFramebuffer(V.FRAMEBUFFER,F),this.current=F,this.dirty=!1}},R}(ae),st=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;V.bindRenderbuffer(V.RENDERBUFFER,F),this.current=F,this.dirty=!1}},R}(ae),ct=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;V.bindTexture(V.TEXTURE_2D,F),this.current=F,this.dirty=!1}},R}(ae),Pt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;V.bindBuffer(V.ARRAY_BUFFER,F),this.current=F,this.dirty=!1}},R}(ae),kt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){var V=this.gl;V.bindBuffer(V.ELEMENT_ARRAY_BUFFER,F),this.current=F,this.dirty=!1},R}(ae),at=function(C){function R(F){C.call(this,F),this.vao=F.extVertexArrayObject}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){this.vao&&(F!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(F),this.current=F,this.dirty=!1)},R}(ae),tt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return 4},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;V.pixelStorei(V.UNPACK_ALIGNMENT,F),this.current=F,this.dirty=!1}},R}(ae),_t=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;V.pixelStorei(V.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F),this.current=F,this.dirty=!1}},R}(ae),er=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var V=this.gl;V.pixelStorei(V.UNPACK_FLIP_Y_WEBGL,F),this.current=F,this.dirty=!1}},R}(ae),tr=function(C){function R(F,V){C.call(this,F),this.context=F,this.parent=V}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R}(ae),Ue=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.setDirty=function(){this.dirty=!0},R.prototype.set=function(F){if(F!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var V=this.gl;V.framebufferTexture2D(V.FRAMEBUFFER,V.COLOR_ATTACHMENT0,V.TEXTURE_2D,F,0),this.current=F,this.dirty=!1}},R}(tr),He=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.set=function(F){if(F!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var V=this.gl;V.framebufferRenderbuffer(V.FRAMEBUFFER,V.DEPTH_ATTACHMENT,V.RENDERBUFFER,F),this.current=F,this.dirty=!1}},R}(tr),Be=function(C,R,F,V){this.context=C,this.width=R,this.height=F;var ne=C.gl,le=this.framebuffer=ne.createFramebuffer();this.colorAttachment=new Ue(C,le),V&&(this.depthAttachment=new He(C,le))};Be.prototype.destroy=function(){var C=this.context.gl,R=this.colorAttachment.get();if(R&&C.deleteTexture(R),this.depthAttachment){var F=this.depthAttachment.get();F&&C.deleteRenderbuffer(F)}C.deleteFramebuffer(this.framebuffer)};var Ke=function(C,R,F){this.func=C,this.mask=R,this.range=F};Ke.ReadOnly=!1,Ke.ReadWrite=!0,Ke.disabled=new Ke(519,Ke.ReadOnly,[0,1]);var _e=function(C,R,F,V,ne,le){this.test=C,this.ref=R,this.mask=F,this.fail=V,this.depthFail=ne,this.pass=le};_e.disabled=new _e({func:519,mask:0},0,0,7680,7680,7680);var Ce=function(C,R,F){this.blendFunction=C,this.blendColor=R,this.mask=F};Ce.disabled=new Ce(Ce.Replace=[1,0],e.Color.transparent,[!1,!1,!1,!1]),Ce.unblended=new Ce(Ce.Replace,e.Color.transparent,[!0,!0,!0,!0]),Ce.alphaBlended=new Ce([1,771],e.Color.transparent,[!0,!0,!0,!0]);var Le=function(C,R,F){this.enable=C,this.mode=R,this.frontFace=F};Le.disabled=new Le(!1,1029,2305),Le.backCCW=new Le(!0,1029,2305);var Pe=function(C){this.gl=C,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new he(this),this.clearDepth=new se(this),this.clearStencil=new de(this),this.colorMask=new ue(this),this.depthMask=new ve(this),this.stencilMask=new ke(this),this.stencilFunc=new Ee(this),this.stencilOp=new be(this),this.stencilTest=new xe(this),this.depthRange=new ce(this),this.depthTest=new ge(this),this.depthFunc=new we(this),this.blend=new Me(this),this.blendFunc=new Se(this),this.blendColor=new ze(this),this.blendEquation=new Fe(this),this.cullFace=new Ye(this),this.cullFaceSide=new rt(this),this.frontFace=new Oe(this),this.program=new je(this),this.activeTexture=new We(this),this.viewport=new qe(this),this.bindFramebuffer=new et(this),this.bindRenderbuffer=new st(this),this.bindTexture=new ct(this),this.bindVertexBuffer=new Pt(this),this.bindElementBuffer=new kt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new at(this),this.pixelStoreUnpack=new tt(this),this.pixelStoreUnpackPremultiplyAlpha=new _t(this),this.pixelStoreUnpackFlipY=new er(this),this.extTextureFilterAnisotropic=C.getExtension("EXT_texture_filter_anisotropic")||C.getExtension("MOZ_EXT_texture_filter_anisotropic")||C.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=C.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=C.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(C.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=C.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=C.getExtension("EXT_disjoint_timer_query")};Pe.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Pe.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Pe.prototype.createIndexBuffer=function(C,R){return new Q(this,C,R)},Pe.prototype.createVertexBuffer=function(C,R,F){return new ie(this,C,R,F)},Pe.prototype.createRenderbuffer=function(C,R,F){var V=this.gl,ne=V.createRenderbuffer();return this.bindRenderbuffer.set(ne),V.renderbufferStorage(V.RENDERBUFFER,C,R,F),this.bindRenderbuffer.set(null),ne},Pe.prototype.createFramebuffer=function(C,R,F){return new Be(this,C,R,F)},Pe.prototype.clear=function(C){var R=C.color,F=C.depth,V=this.gl,ne=0;R&&(ne|=V.COLOR_BUFFER_BIT,this.clearColor.set(R),this.colorMask.set([!0,!0,!0,!0])),F!==void 0&&(ne|=V.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(F),this.depthMask.set(!0)),V.clear(ne)},Pe.prototype.setCullFace=function(C){C.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(C.mode),this.frontFace.set(C.frontFace))},Pe.prototype.setDepthMode=function(C){C.func!==this.gl.ALWAYS||C.mask?(this.depthTest.set(!0),this.depthFunc.set(C.func),this.depthMask.set(C.mask),this.depthRange.set(C.range)):this.depthTest.set(!1)},Pe.prototype.setStencilMode=function(C){C.test.func!==this.gl.ALWAYS||C.mask?(this.stencilTest.set(!0),this.stencilMask.set(C.mask),this.stencilOp.set([C.fail,C.depthFail,C.pass]),this.stencilFunc.set({func:C.test.func,ref:C.ref,mask:C.test.mask})):this.stencilTest.set(!1)},Pe.prototype.setColorMode=function(C){e.deepEqual(C.blendFunction,Ce.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(C.blendFunction),this.blendColor.set(C.blendColor)),this.colorMask.set(C.mask)},Pe.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Xe=function(C){function R(F,V,ne){var le=this;C.call(this),this.id=F,this.dispatcher=ne,this.on("data",function(pe){pe.dataType==="source"&&pe.sourceDataType==="metadata"&&(le._sourceLoaded=!0),le._sourceLoaded&&!le._paused&&pe.dataType==="source"&&pe.sourceDataType==="content"&&(le.reload(),le.transform&&le.update(le.transform))}),this.on("error",function(){le._sourceErrored=!0}),this._source=function(pe,ye,Te,Ne){var Ge=new z[ye.type](pe,ye,Te,Ne);if(Ge.id!==pe)throw new Error("Expected Source id to be "+pe+" instead of "+Ge.id);return e.bindAll(["load","abort","unload","serialize","prepare"],Ge),Ge}(F,V,ne,this),this._tiles={},this._cache=new J(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.onAdd=function(F){this.map=F,this._maxTileCacheSize=F?F._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(F)},R.prototype.onRemove=function(F){this._source&&this._source.onRemove&&this._source.onRemove(F)},R.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var F in this._tiles){var V=this._tiles[F];if(V.state!=="loaded"&&V.state!=="errored")return!1}return!0},R.prototype.getSource=function(){return this._source},R.prototype.pause=function(){this._paused=!0},R.prototype.resume=function(){if(this._paused){var F=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,F&&this.reload(),this.transform&&this.update(this.transform)}},R.prototype._loadTile=function(F,V){return this._source.loadTile(F,V)},R.prototype._unloadTile=function(F){if(this._source.unloadTile)return this._source.unloadTile(F,function(){})},R.prototype._abortTile=function(F){if(this._source.abortTile)return this._source.abortTile(F,function(){})},R.prototype.serialize=function(){return this._source.serialize()},R.prototype.prepare=function(F){for(var V in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var ne=this._tiles[V];ne.upload(F),ne.prepare(this.map.style.imageManager)}},R.prototype.getIds=function(){return e.values(this._tiles).map(function(F){return F.tileID}).sort(ht).map(function(F){return F.key})},R.prototype.getRenderableIds=function(F){var V=this,ne=[];for(var le in this._tiles)this._isIdRenderable(le,F)&&ne.push(this._tiles[le]);return F?ne.sort(function(pe,ye){var Te=pe.tileID,Ne=ye.tileID,Ge=new e.Point(Te.canonical.x,Te.canonical.y)._rotate(V.transform.angle),nt=new e.Point(Ne.canonical.x,Ne.canonical.y)._rotate(V.transform.angle);return Te.overscaledZ-Ne.overscaledZ||nt.y-Ge.y||nt.x-Ge.x}).map(function(pe){return pe.tileID.key}):ne.map(function(pe){return pe.tileID}).sort(ht).map(function(pe){return pe.key})},R.prototype.hasRenderableParent=function(F){var V=this.findLoadedParent(F,0);return!!V&&this._isIdRenderable(V.tileID.key)},R.prototype._isIdRenderable=function(F,V){return this._tiles[F]&&this._tiles[F].hasData()&&!this._coveredTiles[F]&&(V||!this._tiles[F].holdingForFade())},R.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var F in this._cache.reset(),this._tiles)this._tiles[F].state!=="errored"&&this._reloadTile(F,"reloading")},R.prototype._reloadTile=function(F,V){var ne=this._tiles[F];ne&&(ne.state!=="loading"&&(ne.state=V),this._loadTile(ne,this._tileLoaded.bind(this,ne,F,V)))},R.prototype._tileLoaded=function(F,V,ne,le){if(le)return F.state="errored",void(le.status!==404?this._source.fire(new e.ErrorEvent(le,{tile:F})):this.update(this.transform));F.timeAdded=e.browser.now(),ne==="expired"&&(F.refreshedUponExpiration=!0),this._setTileReloadTimer(V,F),this.getSource().type==="raster-dem"&&F.dem&&this._backfillDEM(F),this._state.initializeTileState(F,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:F,coord:F.tileID}))},R.prototype._backfillDEM=function(F){for(var V=this.getRenderableIds(),ne=0;ne<V.length;ne++){var le=V[ne];if(F.neighboringTiles&&F.neighboringTiles[le]){var pe=this.getTileByID(le);ye(F,pe),ye(pe,F)}}function ye(Te,Ne){Te.needsHillshadePrepare=!0;var Ge=Ne.tileID.canonical.x-Te.tileID.canonical.x,nt=Ne.tileID.canonical.y-Te.tileID.canonical.y,bt=Math.pow(2,Te.tileID.canonical.z),Ct=Ne.tileID.key;Ge===0&&nt===0||Math.abs(nt)>1||(Math.abs(Ge)>1&&(Math.abs(Ge+bt)===1?Ge+=bt:Math.abs(Ge-bt)===1&&(Ge-=bt)),Ne.dem&&Te.dem&&(Te.dem.backfillBorder(Ne.dem,Ge,nt),Te.neighboringTiles&&Te.neighboringTiles[Ct]&&(Te.neighboringTiles[Ct].backfilled=!0)))}},R.prototype.getTile=function(F){return this.getTileByID(F.key)},R.prototype.getTileByID=function(F){return this._tiles[F]},R.prototype._retainLoadedChildren=function(F,V,ne,le){for(var pe in this._tiles){var ye=this._tiles[pe];if(!(le[pe]||!ye.hasData()||ye.tileID.overscaledZ<=V||ye.tileID.overscaledZ>ne)){for(var Te=ye.tileID;ye&&ye.tileID.overscaledZ>V+1;){var Ne=ye.tileID.scaledTo(ye.tileID.overscaledZ-1);(ye=this._tiles[Ne.key])&&ye.hasData()&&(Te=Ne)}for(var Ge=Te;Ge.overscaledZ>V;)if(F[(Ge=Ge.scaledTo(Ge.overscaledZ-1)).key]){le[Te.key]=Te;break}}}},R.prototype.findLoadedParent=function(F,V){if(F.key in this._loadedParentTiles){var ne=this._loadedParentTiles[F.key];return ne&&ne.tileID.overscaledZ>=V?ne:null}for(var le=F.overscaledZ-1;le>=V;le--){var pe=F.scaledTo(le),ye=this._getLoadedTile(pe);if(ye)return ye}},R.prototype._getLoadedTile=function(F){var V=this._tiles[F.key];return V&&V.hasData()?V:this._cache.getByKey(F.wrapped().key)},R.prototype.updateCacheSize=function(F){var V=(Math.ceil(F.width/this._source.tileSize)+1)*(Math.ceil(F.height/this._source.tileSize)+1),ne=Math.floor(5*V),le=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,ne):ne;this._cache.setMaxSize(le)},R.prototype.handleWrapJump=function(F){var V=(F-(this._prevLng===void 0?F:this._prevLng))/360,ne=Math.round(V);if(this._prevLng=F,ne){var le={};for(var pe in this._tiles){var ye=this._tiles[pe];ye.tileID=ye.tileID.unwrapTo(ye.tileID.wrap+ne),le[ye.tileID.key]=ye}for(var Te in this._tiles=le,this._timers)clearTimeout(this._timers[Te]),delete this._timers[Te];for(var Ne in this._tiles){var Ge=this._tiles[Ne];this._setTileReloadTimer(Ne,Ge)}}},R.prototype.update=function(F){var V=this;if(this.transform=F,this._sourceLoaded&&!this._paused){var ne;this.updateCacheSize(F),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?ne=F.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(kr){return new e.OverscaledTileID(kr.canonical.z,kr.wrap,kr.canonical.z,kr.canonical.x,kr.canonical.y)}):(ne=F.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(ne=ne.filter(function(kr){return V._source.hasTile(kr)}))):ne=[];var le=F.coveringZoomLevel(this._source),pe=Math.max(le-R.maxOverzooming,this._source.minzoom),ye=Math.max(le+R.maxUnderzooming,this._source.minzoom),Te=this._updateRetainedTiles(ne,le);if(Mt(this._source.type)){for(var Ne={},Ge={},nt=0,bt=Object.keys(Te);nt<bt.length;nt+=1){var Ct=bt[nt],Tt=Te[Ct],At=this._tiles[Ct];if(At&&!(At.fadeEndTime&&At.fadeEndTime<=e.browser.now())){var yt=this.findLoadedParent(Tt,pe);yt&&(this._addTile(yt.tileID),Ne[yt.tileID.key]=yt.tileID),Ge[Ct]=Tt}}for(var Ft in this._retainLoadedChildren(Ge,le,ye,Te),Ne)Te[Ft]||(this._coveredTiles[Ft]=!0,Te[Ft]=Ne[Ft])}for(var zt in Te)this._tiles[zt].clearFadeHold();for(var jt=0,rr=e.keysDifference(this._tiles,Te);jt<rr.length;jt+=1){var hr=rr[jt],Ar=this._tiles[hr];Ar.hasSymbolBuckets&&!Ar.holdingForFade()?Ar.setHoldDuration(this.map._fadeDuration):Ar.hasSymbolBuckets&&!Ar.symbolFadeFinished()||this._removeTile(hr)}this._updateLoadedParentTileCache()}},R.prototype.releaseSymbolFadeTiles=function(){for(var F in this._tiles)this._tiles[F].holdingForFade()&&this._removeTile(F)},R.prototype._updateRetainedTiles=function(F,V){for(var ne={},le={},pe=Math.max(V-R.maxOverzooming,this._source.minzoom),ye=Math.max(V+R.maxUnderzooming,this._source.minzoom),Te={},Ne=0,Ge=F;Ne<Ge.length;Ne+=1){var nt=Ge[Ne],bt=this._addTile(nt);ne[nt.key]=nt,bt.hasData()||V<this._source.maxzoom&&(Te[nt.key]=nt)}this._retainLoadedChildren(Te,V,ye,ne);for(var Ct=0,Tt=F;Ct<Tt.length;Ct+=1){var At=Tt[Ct],yt=this._tiles[At.key];if(!yt.hasData()){if(V+1>this._source.maxzoom){var Ft=At.children(this._source.maxzoom)[0],zt=this.getTile(Ft);if(zt&&zt.hasData()){ne[Ft.key]=Ft;continue}}else{var jt=At.children(this._source.maxzoom);if(ne[jt[0].key]&&ne[jt[1].key]&&ne[jt[2].key]&&ne[jt[3].key])continue}for(var rr=yt.wasRequested(),hr=At.overscaledZ-1;hr>=pe;--hr){var Ar=At.scaledTo(hr);if(le[Ar.key]||(le[Ar.key]=!0,!(yt=this.getTile(Ar))&&rr&&(yt=this._addTile(Ar)),yt&&(ne[Ar.key]=Ar,rr=yt.wasRequested(),yt.hasData())))break}}}return ne},R.prototype._updateLoadedParentTileCache=function(){for(var F in this._loadedParentTiles={},this._tiles){for(var V=[],ne=void 0,le=this._tiles[F].tileID;le.overscaledZ>0;){if(le.key in this._loadedParentTiles){ne=this._loadedParentTiles[le.key];break}V.push(le.key);var pe=le.scaledTo(le.overscaledZ-1);if(ne=this._getLoadedTile(pe))break;le=pe}for(var ye=0,Te=V;ye<Te.length;ye+=1){var Ne=Te[ye];this._loadedParentTiles[Ne]=ne}}},R.prototype._addTile=function(F){var V=this._tiles[F.key];if(V)return V;(V=this._cache.getAndRemove(F))&&(this._setTileReloadTimer(F.key,V),V.tileID=F,this._state.initializeTileState(V,this.map?this.map.painter:null),this._cacheTimers[F.key]&&(clearTimeout(this._cacheTimers[F.key]),delete this._cacheTimers[F.key],this._setTileReloadTimer(F.key,V)));var ne=Boolean(V);return ne||(V=new e.Tile(F,this._source.tileSize*F.overscaleFactor()),this._loadTile(V,this._tileLoaded.bind(this,V,F.key,V.state))),V?(V.uses++,this._tiles[F.key]=V,ne||this._source.fire(new e.Event("dataloading",{tile:V,coord:V.tileID,dataType:"source"})),V):null},R.prototype._setTileReloadTimer=function(F,V){var ne=this;F in this._timers&&(clearTimeout(this._timers[F]),delete this._timers[F]);var le=V.getExpiryTimeout();le&&(this._timers[F]=setTimeout(function(){ne._reloadTile(F,"expired"),delete ne._timers[F]},le))},R.prototype._removeTile=function(F){var V=this._tiles[F];V&&(V.uses--,delete this._tiles[F],this._timers[F]&&(clearTimeout(this._timers[F]),delete this._timers[F]),V.uses>0||(V.hasData()&&V.state!=="reloading"?this._cache.add(V.tileID,V,V.getExpiryTimeout()):(V.aborted=!0,this._abortTile(V),this._unloadTile(V))))},R.prototype.clearTiles=function(){for(var F in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(F);this._cache.reset()},R.prototype.tilesIn=function(F,V,ne){var le=this,pe=[],ye=this.transform;if(!ye)return pe;for(var Te=ne?ye.getCameraQueryGeometry(F):F,Ne=F.map(function(hr){return ye.pointCoordinate(hr)}),Ge=Te.map(function(hr){return ye.pointCoordinate(hr)}),nt=this.getIds(),bt=1/0,Ct=1/0,Tt=-1/0,At=-1/0,yt=0,Ft=Ge;yt<Ft.length;yt+=1){var zt=Ft[yt];bt=Math.min(bt,zt.x),Ct=Math.min(Ct,zt.y),Tt=Math.max(Tt,zt.x),At=Math.max(At,zt.y)}for(var jt=function(hr){var Ar=le._tiles[nt[hr]];if(!Ar.holdingForFade()){var kr=Ar.tileID,Kr=Math.pow(2,ye.zoom-Ar.tileID.overscaledZ),Zr=V*Ar.queryPadding*e.EXTENT/Ar.tileSize/Kr,hn=[kr.getTilePoint(new e.MercatorCoordinate(bt,Ct)),kr.getTilePoint(new e.MercatorCoordinate(Tt,At))];if(hn[0].x-Zr<e.EXTENT&&hn[0].y-Zr<e.EXTENT&&hn[1].x+Zr>=0&&hn[1].y+Zr>=0){var sn=Ne.map(function(Wn){return kr.getTilePoint(Wn)}),Un=Ge.map(function(Wn){return kr.getTilePoint(Wn)});pe.push({tile:Ar,tileID:kr,queryGeometry:sn,cameraQueryGeometry:Un,scale:Kr})}}},rr=0;rr<nt.length;rr++)jt(rr);return pe},R.prototype.getVisibleCoordinates=function(F){for(var V=this,ne=this.getRenderableIds(F).map(function(Te){return V._tiles[Te].tileID}),le=0,pe=ne;le<pe.length;le+=1){var ye=pe[le];ye.posMatrix=this.transform.calculatePosMatrix(ye.toUnwrapped())}return ne},R.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Mt(this._source.type))for(var F in this._tiles){var V=this._tiles[F];if(V.fadeEndTime!==void 0&&V.fadeEndTime>=e.browser.now())return!0}return!1},R.prototype.setFeatureState=function(F,V,ne){F=F||"_geojsonTileLayer",this._state.updateState(F,V,ne)},R.prototype.removeFeatureState=function(F,V,ne){F=F||"_geojsonTileLayer",this._state.removeFeatureState(F,V,ne)},R.prototype.getFeatureState=function(F,V){return F=F||"_geojsonTileLayer",this._state.getState(F,V)},R.prototype.setDependencies=function(F,V,ne){var le=this._tiles[F];le&&le.setDependencies(V,ne)},R.prototype.reloadTilesForDependencies=function(F,V){for(var ne in this._tiles)this._tiles[ne].hasDependency(F,V)&&this._reloadTile(ne,"reloading");this._cache.filter(function(le){return!le.hasDependency(F,V)})},R}(e.Evented);function ht(C,R){var F=Math.abs(2*C.wrap)-+(C.wrap<0),V=Math.abs(2*R.wrap)-+(R.wrap<0);return C.overscaledZ-R.overscaledZ||V-F||R.canonical.y-C.canonical.y||R.canonical.x-C.canonical.x}function Mt(C){return C==="raster"||C==="image"||C==="video"}function pt(){return new e.window.Worker(oe.workerUrl)}Xe.maxOverzooming=10,Xe.maxUnderzooming=3;var Lt="mapboxgl_preloaded_worker_pool",vt=function(){this.active={}};vt.prototype.acquire=function(C){if(!this.workers)for(this.workers=[];this.workers.length<vt.workerCount;)this.workers.push(new pt);return this.active[C]=!0,this.workers.slice()},vt.prototype.release=function(C){delete this.active[C],this.numActive()===0&&(this.workers.forEach(function(R){R.terminate()}),this.workers=null)},vt.prototype.isPreloaded=function(){return!!this.active[Lt]},vt.prototype.numActive=function(){return Object.keys(this.active).length};var Dt,xt=Math.floor(e.browser.hardwareConcurrency/2);function it(){return Dt||(Dt=new vt),Dt}function St(C,R){var F={};for(var V in C)V!=="ref"&&(F[V]=C[V]);return e.refProperties.forEach(function(ne){ne in R&&(F[ne]=R[ne])}),F}function Nt(C){C=C.slice();for(var R=Object.create(null),F=0;F<C.length;F++)R[C[F].id]=C[F];for(var V=0;V<C.length;V++)"ref"in C[V]&&(C[V]=St(C[V],R[C[V].ref]));return C}vt.workerCount=Math.max(Math.min(xt,6),1);var Ut={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Qt(C,R,F){F.push({command:Ut.addSource,args:[C,R[C]]})}function Ie(C,R,F){R.push({command:Ut.removeSource,args:[C]}),F[C]=!0}function lt(C,R,F,V){Ie(C,F,V),Qt(C,R,F)}function wt(C,R,F){var V;for(V in C[F])if(C[F].hasOwnProperty(V)&&V!=="data"&&!e.deepEqual(C[F][V],R[F][V]))return!1;for(V in R[F])if(R[F].hasOwnProperty(V)&&V!=="data"&&!e.deepEqual(C[F][V],R[F][V]))return!1;return!0}function Ot(C,R,F,V,ne,le){var pe;for(pe in R=R||{},C=C||{})C.hasOwnProperty(pe)&&(e.deepEqual(C[pe],R[pe])||F.push({command:le,args:[V,pe,R[pe],ne]}));for(pe in R)R.hasOwnProperty(pe)&&!C.hasOwnProperty(pe)&&(e.deepEqual(C[pe],R[pe])||F.push({command:le,args:[V,pe,R[pe],ne]}))}function Gt(C){return C.id}function ir(C,R){return C[R.id]=R,C}function Xt(C,R){if(!C)return[{command:Ut.setStyle,args:[R]}];var F=[];try{if(!e.deepEqual(C.version,R.version))return[{command:Ut.setStyle,args:[R]}];e.deepEqual(C.center,R.center)||F.push({command:Ut.setCenter,args:[R.center]}),e.deepEqual(C.zoom,R.zoom)||F.push({command:Ut.setZoom,args:[R.zoom]}),e.deepEqual(C.bearing,R.bearing)||F.push({command:Ut.setBearing,args:[R.bearing]}),e.deepEqual(C.pitch,R.pitch)||F.push({command:Ut.setPitch,args:[R.pitch]}),e.deepEqual(C.sprite,R.sprite)||F.push({command:Ut.setSprite,args:[R.sprite]}),e.deepEqual(C.glyphs,R.glyphs)||F.push({command:Ut.setGlyphs,args:[R.glyphs]}),e.deepEqual(C.transition,R.transition)||F.push({command:Ut.setTransition,args:[R.transition]}),e.deepEqual(C.light,R.light)||F.push({command:Ut.setLight,args:[R.light]});var V={},ne=[];(function(pe,ye,Te,Ne){var Ge;for(Ge in ye=ye||{},pe=pe||{})pe.hasOwnProperty(Ge)&&(ye.hasOwnProperty(Ge)||Ie(Ge,Te,Ne));for(Ge in ye)ye.hasOwnProperty(Ge)&&(pe.hasOwnProperty(Ge)?e.deepEqual(pe[Ge],ye[Ge])||(pe[Ge].type==="geojson"&&ye[Ge].type==="geojson"&&wt(pe,ye,Ge)?Te.push({command:Ut.setGeoJSONSourceData,args:[Ge,ye[Ge].data]}):lt(Ge,ye,Te,Ne)):Qt(Ge,ye,Te))})(C.sources,R.sources,ne,V);var le=[];C.layers&&C.layers.forEach(function(pe){V[pe.source]?F.push({command:Ut.removeLayer,args:[pe.id]}):le.push(pe)}),F=F.concat(ne),function(pe,ye,Te){ye=ye||[];var Ne,Ge,nt,bt,Ct,Tt,At,yt=(pe=pe||[]).map(Gt),Ft=ye.map(Gt),zt=pe.reduce(ir,{}),jt=ye.reduce(ir,{}),rr=yt.slice(),hr=Object.create(null);for(Ne=0,Ge=0;Ne<yt.length;Ne++)nt=yt[Ne],jt.hasOwnProperty(nt)?Ge++:(Te.push({command:Ut.removeLayer,args:[nt]}),rr.splice(rr.indexOf(nt,Ge),1));for(Ne=0,Ge=0;Ne<Ft.length;Ne++)nt=Ft[Ft.length-1-Ne],rr[rr.length-1-Ne]!==nt&&(zt.hasOwnProperty(nt)?(Te.push({command:Ut.removeLayer,args:[nt]}),rr.splice(rr.lastIndexOf(nt,rr.length-Ge),1)):Ge++,Tt=rr[rr.length-Ne],Te.push({command:Ut.addLayer,args:[jt[nt],Tt]}),rr.splice(rr.length-Ne,0,nt),hr[nt]=!0);for(Ne=0;Ne<Ft.length;Ne++)if(bt=zt[nt=Ft[Ne]],Ct=jt[nt],!hr[nt]&&!e.deepEqual(bt,Ct))if(e.deepEqual(bt.source,Ct.source)&&e.deepEqual(bt["source-layer"],Ct["source-layer"])&&e.deepEqual(bt.type,Ct.type)){for(At in Ot(bt.layout,Ct.layout,Te,nt,null,Ut.setLayoutProperty),Ot(bt.paint,Ct.paint,Te,nt,null,Ut.setPaintProperty),e.deepEqual(bt.filter,Ct.filter)||Te.push({command:Ut.setFilter,args:[nt,Ct.filter]}),e.deepEqual(bt.minzoom,Ct.minzoom)&&e.deepEqual(bt.maxzoom,Ct.maxzoom)||Te.push({command:Ut.setLayerZoomRange,args:[nt,Ct.minzoom,Ct.maxzoom]}),bt)bt.hasOwnProperty(At)&&At!=="layout"&&At!=="paint"&&At!=="filter"&&At!=="metadata"&&At!=="minzoom"&&At!=="maxzoom"&&(At.indexOf("paint.")===0?Ot(bt[At],Ct[At],Te,nt,At.slice(6),Ut.setPaintProperty):e.deepEqual(bt[At],Ct[At])||Te.push({command:Ut.setLayerProperty,args:[nt,At,Ct[At]]}));for(At in Ct)Ct.hasOwnProperty(At)&&!bt.hasOwnProperty(At)&&At!=="layout"&&At!=="paint"&&At!=="filter"&&At!=="metadata"&&At!=="minzoom"&&At!=="maxzoom"&&(At.indexOf("paint.")===0?Ot(bt[At],Ct[At],Te,nt,At.slice(6),Ut.setPaintProperty):e.deepEqual(bt[At],Ct[At])||Te.push({command:Ut.setLayerProperty,args:[nt,At,Ct[At]]}))}else Te.push({command:Ut.removeLayer,args:[nt]}),Tt=rr[rr.lastIndexOf(nt)+1],Te.push({command:Ut.addLayer,args:[Ct,Tt]})}(le,R.layers,F)}catch(pe){console.warn("Unable to compute style diff:",pe),F=[{command:Ut.setStyle,args:[R]}]}return F}var Kt=function(C,R){this.reset(C,R)};Kt.prototype.reset=function(C,R){this.points=C||[],this._distances=[0];for(var F=1;F<this.points.length;F++)this._distances[F]=this._distances[F-1]+this.points[F].dist(this.points[F-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(R||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Kt.prototype.lerp=function(C){if(this.points.length===1)return this.points[0];C=e.clamp(C,0,1);for(var R=1,F=this._distances[R],V=C*this.paddedLength+this.padding;F<V&&R<this._distances.length;)F=this._distances[++R];var ne=R-1,le=this._distances[ne],pe=F-le,ye=pe>0?(V-le)/pe:0;return this.points[ne].mult(1-ye).add(this.points[R].mult(ye))};var or=function(C,R,F){var V=this.boxCells=[],ne=this.circleCells=[];this.xCellCount=Math.ceil(C/F),this.yCellCount=Math.ceil(R/F);for(var le=0;le<this.xCellCount*this.yCellCount;le++)V.push([]),ne.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=C,this.height=R,this.xScale=this.xCellCount/C,this.yScale=this.yCellCount/R,this.boxUid=0,this.circleUid=0};function dr(C,R,F,V,ne){var le=e.create();return R?(e.scale(le,le,[1/ne,1/ne,1]),F||e.rotateZ(le,le,V.angle)):e.multiply(le,V.labelPlaneMatrix,C),le}function vr(C,R,F,V,ne){if(R){var le=e.clone(C);return e.scale(le,le,[ne,ne,1]),F||e.rotateZ(le,le,-V.angle),le}return V.glCoordMatrix}function ur(C,R){var F=[C.x,C.y,0,1];an(F,F,R);var V=F[3];return{point:new e.Point(F[0]/V,F[1]/V),signedDistanceFromCamera:V}}function pr(C,R){return .5+C/R*.5}function br(C,R){var F=C[0]/C[3],V=C[1]/C[3];return F>=-R[0]&&F<=R[0]&&V>=-R[1]&&V<=R[1]}function Rr(C,R,F,V,ne,le,pe,ye){var Te=V?C.textSizeData:C.iconSizeData,Ne=e.evaluateSizeForZoom(Te,F.transform.zoom),Ge=[256/F.width*2+1,256/F.height*2+1],nt=V?C.text.dynamicLayoutVertexArray:C.icon.dynamicLayoutVertexArray;nt.clear();for(var bt=C.lineVertexArray,Ct=V?C.text.placedSymbolArray:C.icon.placedSymbolArray,Tt=F.transform.width/F.transform.height,At=!1,yt=0;yt<Ct.length;yt++){var Ft=Ct.get(yt);if(Ft.hidden||Ft.writingMode===e.WritingMode.vertical&&!At)Sn(Ft.numGlyphs,nt);else{At=!1;var zt=[Ft.anchorX,Ft.anchorY,0,1];if(e.transformMat4(zt,zt,R),br(zt,Ge)){var jt=zt[3],rr=pr(F.transform.cameraToCenterDistance,jt),hr=e.evaluateSizeForFeature(Te,Ne,Ft),Ar=pe?hr/rr:hr*rr,kr=new e.Point(Ft.anchorX,Ft.anchorY),Kr=ur(kr,ne).point,Zr={},hn=$r(Ft,Ar,!1,ye,R,ne,le,C.glyphOffsetArray,bt,nt,Kr,kr,Zr,Tt);At=hn.useVertical,(hn.notEnoughRoom||At||hn.needsFlipping&&$r(Ft,Ar,!0,ye,R,ne,le,C.glyphOffsetArray,bt,nt,Kr,kr,Zr,Tt).notEnoughRoom)&&Sn(Ft.numGlyphs,nt)}else Sn(Ft.numGlyphs,nt)}}V?C.text.dynamicLayoutVertexBuffer.updateData(nt):C.icon.dynamicLayoutVertexBuffer.updateData(nt)}function _r(C,R,F,V,ne,le,pe,ye,Te,Ne,Ge){var nt=ye.glyphStartIndex+ye.numGlyphs,bt=ye.lineStartIndex,Ct=ye.lineStartIndex+ye.lineLength,Tt=R.getoffsetX(ye.glyphStartIndex),At=R.getoffsetX(nt-1),yt=In(C*Tt,F,V,ne,le,pe,ye.segment,bt,Ct,Te,Ne,Ge);if(!yt)return null;var Ft=In(C*At,F,V,ne,le,pe,ye.segment,bt,Ct,Te,Ne,Ge);return Ft?{first:yt,last:Ft}:null}function jr(C,R,F,V){return C===e.WritingMode.horizontal&&Math.abs(F.y-R.y)>Math.abs(F.x-R.x)*V?{useVertical:!0}:(C===e.WritingMode.vertical?R.y<F.y:R.x>F.x)?{needsFlipping:!0}:null}function $r(C,R,F,V,ne,le,pe,ye,Te,Ne,Ge,nt,bt,Ct){var Tt,At=R/24,yt=C.lineOffsetX*At,Ft=C.lineOffsetY*At;if(C.numGlyphs>1){var zt=C.glyphStartIndex+C.numGlyphs,jt=C.lineStartIndex,rr=C.lineStartIndex+C.lineLength,hr=_r(At,ye,yt,Ft,F,Ge,nt,C,Te,le,bt);if(!hr)return{notEnoughRoom:!0};var Ar=ur(hr.first.point,pe).point,kr=ur(hr.last.point,pe).point;if(V&&!F){var Kr=jr(C.writingMode,Ar,kr,Ct);if(Kr)return Kr}Tt=[hr.first];for(var Zr=C.glyphStartIndex+1;Zr<zt-1;Zr++)Tt.push(In(At*ye.getoffsetX(Zr),yt,Ft,F,Ge,nt,C.segment,jt,rr,Te,le,bt));Tt.push(hr.last)}else{if(V&&!F){var hn=ur(nt,ne).point,sn=C.lineStartIndex+C.segment+1,Un=new e.Point(Te.getx(sn),Te.gety(sn)),Wn=ur(Un,ne),ua=Wn.signedDistanceFromCamera>0?Wn.point:pn(nt,Un,hn,1,ne),Ur=jr(C.writingMode,hn,ua,Ct);if(Ur)return Ur}var kn=In(At*ye.getoffsetX(C.glyphStartIndex),yt,Ft,F,Ge,nt,C.segment,C.lineStartIndex,C.lineStartIndex+C.lineLength,Te,le,bt);if(!kn)return{notEnoughRoom:!0};Tt=[kn]}for(var Xn=0,Gn=Tt;Xn<Gn.length;Xn+=1){var ea=Gn[Xn];e.addDynamicAttributes(Ne,ea.point,ea.angle)}return{}}function pn(C,R,F,V,ne){var le=ur(C.add(C.sub(R)._unit()),ne).point,pe=F.sub(le);return F.add(pe._mult(V/pe.mag()))}function In(C,R,F,V,ne,le,pe,ye,Te,Ne,Ge,nt){var bt=V?C-R:C+R,Ct=bt>0?1:-1,Tt=0;V&&(Ct*=-1,Tt=Math.PI),Ct<0&&(Tt+=Math.PI);for(var At=Ct>0?ye+pe:ye+pe+1,yt=ne,Ft=ne,zt=0,jt=0,rr=Math.abs(bt),hr=[];zt+jt<=rr;){if((At+=Ct)<ye||At>=Te)return null;if(Ft=yt,hr.push(yt),(yt=nt[At])===void 0){var Ar=new e.Point(Ne.getx(At),Ne.gety(At)),kr=ur(Ar,Ge);if(kr.signedDistanceFromCamera>0)yt=nt[At]=kr.point;else{var Kr=At-Ct;yt=pn(zt===0?le:new e.Point(Ne.getx(Kr),Ne.gety(Kr)),Ar,Ft,rr-zt+1,Ge)}}zt+=jt,jt=Ft.dist(yt)}var Zr=(rr-zt)/jt,hn=yt.sub(Ft),sn=hn.mult(Zr)._add(Ft);sn._add(hn._unit()._perp()._mult(F*Ct));var Un=Tt+Math.atan2(yt.y-Ft.y,yt.x-Ft.x);return hr.push(sn),{point:sn,angle:Un,path:hr}}or.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},or.prototype.insert=function(C,R,F,V,ne){this._forEachCell(R,F,V,ne,this._insertBoxCell,this.boxUid++),this.boxKeys.push(C),this.bboxes.push(R),this.bboxes.push(F),this.bboxes.push(V),this.bboxes.push(ne)},or.prototype.insertCircle=function(C,R,F,V){this._forEachCell(R-V,F-V,R+V,F+V,this._insertCircleCell,this.circleUid++),this.circleKeys.push(C),this.circles.push(R),this.circles.push(F),this.circles.push(V)},or.prototype._insertBoxCell=function(C,R,F,V,ne,le){this.boxCells[ne].push(le)},or.prototype._insertCircleCell=function(C,R,F,V,ne,le){this.circleCells[ne].push(le)},or.prototype._query=function(C,R,F,V,ne,le){if(F<0||C>this.width||V<0||R>this.height)return!ne&&[];var pe=[];if(C<=0&&R<=0&&this.width<=F&&this.height<=V){if(ne)return!0;for(var ye=0;ye<this.boxKeys.length;ye++)pe.push({key:this.boxKeys[ye],x1:this.bboxes[4*ye],y1:this.bboxes[4*ye+1],x2:this.bboxes[4*ye+2],y2:this.bboxes[4*ye+3]});for(var Te=0;Te<this.circleKeys.length;Te++){var Ne=this.circles[3*Te],Ge=this.circles[3*Te+1],nt=this.circles[3*Te+2];pe.push({key:this.circleKeys[Te],x1:Ne-nt,y1:Ge-nt,x2:Ne+nt,y2:Ge+nt})}return le?pe.filter(le):pe}var bt={hitTest:ne,seenUids:{box:{},circle:{}}};return this._forEachCell(C,R,F,V,this._queryCell,pe,bt,le),ne?pe.length>0:pe},or.prototype._queryCircle=function(C,R,F,V,ne){var le=C-F,pe=C+F,ye=R-F,Te=R+F;if(pe<0||le>this.width||Te<0||ye>this.height)return!V&&[];var Ne=[],Ge={hitTest:V,circle:{x:C,y:R,radius:F},seenUids:{box:{},circle:{}}};return this._forEachCell(le,ye,pe,Te,this._queryCellCircle,Ne,Ge,ne),V?Ne.length>0:Ne},or.prototype.query=function(C,R,F,V,ne){return this._query(C,R,F,V,!1,ne)},or.prototype.hitTest=function(C,R,F,V,ne){return this._query(C,R,F,V,!0,ne)},or.prototype.hitTestCircle=function(C,R,F,V){return this._queryCircle(C,R,F,!0,V)},or.prototype._queryCell=function(C,R,F,V,ne,le,pe,ye){var Te=pe.seenUids,Ne=this.boxCells[ne];if(Ne!==null)for(var Ge=this.bboxes,nt=0,bt=Ne;nt<bt.length;nt+=1){var Ct=bt[nt];if(!Te.box[Ct]){Te.box[Ct]=!0;var Tt=4*Ct;if(C<=Ge[Tt+2]&&R<=Ge[Tt+3]&&F>=Ge[Tt+0]&&V>=Ge[Tt+1]&&(!ye||ye(this.boxKeys[Ct]))){if(pe.hitTest)return le.push(!0),!0;le.push({key:this.boxKeys[Ct],x1:Ge[Tt],y1:Ge[Tt+1],x2:Ge[Tt+2],y2:Ge[Tt+3]})}}}var At=this.circleCells[ne];if(At!==null)for(var yt=this.circles,Ft=0,zt=At;Ft<zt.length;Ft+=1){var jt=zt[Ft];if(!Te.circle[jt]){Te.circle[jt]=!0;var rr=3*jt;if(this._circleAndRectCollide(yt[rr],yt[rr+1],yt[rr+2],C,R,F,V)&&(!ye||ye(this.circleKeys[jt]))){if(pe.hitTest)return le.push(!0),!0;var hr=yt[rr],Ar=yt[rr+1],kr=yt[rr+2];le.push({key:this.circleKeys[jt],x1:hr-kr,y1:Ar-kr,x2:hr+kr,y2:Ar+kr})}}}},or.prototype._queryCellCircle=function(C,R,F,V,ne,le,pe,ye){var Te=pe.circle,Ne=pe.seenUids,Ge=this.boxCells[ne];if(Ge!==null)for(var nt=this.bboxes,bt=0,Ct=Ge;bt<Ct.length;bt+=1){var Tt=Ct[bt];if(!Ne.box[Tt]){Ne.box[Tt]=!0;var At=4*Tt;if(this._circleAndRectCollide(Te.x,Te.y,Te.radius,nt[At+0],nt[At+1],nt[At+2],nt[At+3])&&(!ye||ye(this.boxKeys[Tt])))return le.push(!0),!0}}var yt=this.circleCells[ne];if(yt!==null)for(var Ft=this.circles,zt=0,jt=yt;zt<jt.length;zt+=1){var rr=jt[zt];if(!Ne.circle[rr]){Ne.circle[rr]=!0;var hr=3*rr;if(this._circlesCollide(Ft[hr],Ft[hr+1],Ft[hr+2],Te.x,Te.y,Te.radius)&&(!ye||ye(this.circleKeys[rr])))return le.push(!0),!0}}},or.prototype._forEachCell=function(C,R,F,V,ne,le,pe,ye){for(var Te=this._convertToXCellCoord(C),Ne=this._convertToYCellCoord(R),Ge=this._convertToXCellCoord(F),nt=this._convertToYCellCoord(V),bt=Te;bt<=Ge;bt++)for(var Ct=Ne;Ct<=nt;Ct++){var Tt=this.xCellCount*Ct+bt;if(ne.call(this,C,R,F,V,Tt,le,pe,ye))return}},or.prototype._convertToXCellCoord=function(C){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(C*this.xScale)))},or.prototype._convertToYCellCoord=function(C){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(C*this.yScale)))},or.prototype._circlesCollide=function(C,R,F,V,ne,le){var pe=V-C,ye=ne-R,Te=F+le;return Te*Te>pe*pe+ye*ye},or.prototype._circleAndRectCollide=function(C,R,F,V,ne,le,pe){var ye=(le-V)/2,Te=Math.abs(C-(V+ye));if(Te>ye+F)return!1;var Ne=(pe-ne)/2,Ge=Math.abs(R-(ne+Ne));if(Ge>Ne+F)return!1;if(Te<=ye||Ge<=Ne)return!0;var nt=Te-ye,bt=Ge-Ne;return nt*nt+bt*bt<=F*F};var On=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Sn(C,R){for(var F=0;F<C;F++){var V=R.length;R.resize(V+4),R.float32.set(On,3*V)}}function an(C,R,F){var V=R[0],ne=R[1];return C[0]=F[0]*V+F[4]*ne+F[12],C[1]=F[1]*V+F[5]*ne+F[13],C[3]=F[3]*V+F[7]*ne+F[15],C}var Nr=function(C,R,F){R===void 0&&(R=new or(C.width+200,C.height+200,25)),F===void 0&&(F=new or(C.width+200,C.height+200,25)),this.transform=C,this.grid=R,this.ignoredGrid=F,this.pitchfactor=Math.cos(C._pitch)*C.cameraToCenterDistance,this.screenRightBoundary=C.width+100,this.screenBottomBoundary=C.height+100,this.gridRightBoundary=C.width+200,this.gridBottomBoundary=C.height+200};function Pr(C,R,F){return R*(e.EXTENT/(C.tileSize*Math.pow(2,F-C.tileID.overscaledZ)))}Nr.prototype.placeCollisionBox=function(C,R,F,V,ne){var le=this.projectAndGetPerspectiveRatio(V,C.anchorPointX,C.anchorPointY),pe=F*le.perspectiveRatio,ye=C.x1*pe+le.point.x,Te=C.y1*pe+le.point.y,Ne=C.x2*pe+le.point.x,Ge=C.y2*pe+le.point.y;return!this.isInsideGrid(ye,Te,Ne,Ge)||!R&&this.grid.hitTest(ye,Te,Ne,Ge,ne)?{box:[],offscreen:!1}:{box:[ye,Te,Ne,Ge],offscreen:this.isOffscreen(ye,Te,Ne,Ge)}},Nr.prototype.placeCollisionCircles=function(C,R,F,V,ne,le,pe,ye,Te,Ne,Ge,nt,bt){var Ct=[],Tt=new e.Point(R.anchorX,R.anchorY),At=ur(Tt,le),yt=pr(this.transform.cameraToCenterDistance,At.signedDistanceFromCamera),Ft=(Ne?ne/yt:ne*yt)/e.ONE_EM,zt=ur(Tt,pe).point,jt=_r(Ft,V,R.lineOffsetX*Ft,R.lineOffsetY*Ft,!1,zt,Tt,R,F,pe,{}),rr=!1,hr=!1,Ar=!0;if(jt){for(var kr=.5*nt*yt+bt,Kr=new e.Point(-100,-100),Zr=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),hn=new Kt,sn=jt.first,Un=jt.last,Wn=[],ua=sn.path.length-1;ua>=1;ua--)Wn.push(sn.path[ua]);for(var Ur=1;Ur<Un.path.length;Ur++)Wn.push(Un.path[Ur]);var kn=2.5*kr;if(ye){var Xn=Wn.map(function(Lo){return ur(Lo,ye)});Wn=Xn.some(function(Lo){return Lo.signedDistanceFromCamera<=0})?[]:Xn.map(function(Lo){return Lo.point})}var Gn=[];if(Wn.length>0){for(var ea=Wn[0].clone(),fa=Wn[0].clone(),Ma=1;Ma<Wn.length;Ma++)ea.x=Math.min(ea.x,Wn[Ma].x),ea.y=Math.min(ea.y,Wn[Ma].y),fa.x=Math.max(fa.x,Wn[Ma].x),fa.y=Math.max(fa.y,Wn[Ma].y);Gn=ea.x>=Kr.x&&fa.x<=Zr.x&&ea.y>=Kr.y&&fa.y<=Zr.y?[Wn]:fa.x<Kr.x||ea.x>Zr.x||fa.y<Kr.y||ea.y>Zr.y?[]:e.clipLine([Wn],Kr.x,Kr.y,Zr.x,Zr.y)}for(var Kn=0,xa=Gn;Kn<xa.length;Kn+=1){var ma=xa[Kn];hn.reset(ma,.25*kr);var La=0;La=hn.length<=.5*kr?1:Math.ceil(hn.paddedLength/kn)+1;for(var ba=0;ba<La;ba++){var Pa=ba/Math.max(La-1,1),Ua=hn.lerp(Pa),di=Ua.x+100,Ri=Ua.y+100;Ct.push(di,Ri,kr,0);var Fi=di-kr,pi=Ri-kr,Ci=di+kr,bi=Ri+kr;if(Ar=Ar&&this.isOffscreen(Fi,pi,Ci,bi),hr=hr||this.isInsideGrid(Fi,pi,Ci,bi),!C&&this.grid.hitTestCircle(di,Ri,kr,Ge)&&(rr=!0,!Te))return{circles:[],offscreen:!1,collisionDetected:rr}}}}return{circles:!Te&&rr||!hr?[]:Ct,offscreen:Ar,collisionDetected:rr}},Nr.prototype.queryRenderedSymbols=function(C){if(C.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var R=[],F=1/0,V=1/0,ne=-1/0,le=-1/0,pe=0,ye=C;pe<ye.length;pe+=1){var Te=ye[pe],Ne=new e.Point(Te.x+100,Te.y+100);F=Math.min(F,Ne.x),V=Math.min(V,Ne.y),ne=Math.max(ne,Ne.x),le=Math.max(le,Ne.y),R.push(Ne)}for(var Ge={},nt={},bt=0,Ct=this.grid.query(F,V,ne,le).concat(this.ignoredGrid.query(F,V,ne,le));bt<Ct.length;bt+=1){var Tt=Ct[bt],At=Tt.key;if(Ge[At.bucketInstanceId]===void 0&&(Ge[At.bucketInstanceId]={}),!Ge[At.bucketInstanceId][At.featureIndex]){var yt=[new e.Point(Tt.x1,Tt.y1),new e.Point(Tt.x2,Tt.y1),new e.Point(Tt.x2,Tt.y2),new e.Point(Tt.x1,Tt.y2)];e.polygonIntersectsPolygon(R,yt)&&(Ge[At.bucketInstanceId][At.featureIndex]=!0,nt[At.bucketInstanceId]===void 0&&(nt[At.bucketInstanceId]=[]),nt[At.bucketInstanceId].push(At.featureIndex))}}return nt},Nr.prototype.insertCollisionBox=function(C,R,F,V,ne){var le={bucketInstanceId:F,featureIndex:V,collisionGroupID:ne};(R?this.ignoredGrid:this.grid).insert(le,C[0],C[1],C[2],C[3])},Nr.prototype.insertCollisionCircles=function(C,R,F,V,ne){for(var le=R?this.ignoredGrid:this.grid,pe={bucketInstanceId:F,featureIndex:V,collisionGroupID:ne},ye=0;ye<C.length;ye+=4)le.insertCircle(pe,C[ye],C[ye+1],C[ye+2])},Nr.prototype.projectAndGetPerspectiveRatio=function(C,R,F){var V=[R,F,0,1];return an(V,V,C),{point:new e.Point((V[0]/V[3]+1)/2*this.transform.width+100,(-V[1]/V[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/V[3]*.5}},Nr.prototype.isOffscreen=function(C,R,F,V){return F<100||C>=this.screenRightBoundary||V<100||R>this.screenBottomBoundary},Nr.prototype.isInsideGrid=function(C,R,F,V){return F>=0&&C<this.gridRightBoundary&&V>=0&&R<this.gridBottomBoundary},Nr.prototype.getViewportMatrix=function(){var C=e.identity([]);return e.translate(C,C,[-100,-100,0]),C};var en=function(C,R,F,V){this.opacity=C?Math.max(0,Math.min(1,C.opacity+(C.placed?R:-R))):V&&F?1:0,this.placed=F};en.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var tn=function(C,R,F,V,ne){this.text=new en(C?C.text:null,R,F,ne),this.icon=new en(C?C.icon:null,R,V,ne)};tn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Qr=function(C,R,F){this.text=C,this.icon=R,this.skipFade=F},rn=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},An=function(C,R,F,V,ne){this.bucketInstanceId=C,this.featureIndex=R,this.sourceLayerIndex=F,this.bucketIndex=V,this.tileID=ne},En=function(C){this.crossSourceCollisions=C,this.maxGroupID=0,this.collisionGroups={}};function Bn(C,R,F,V,ne){var le=e.getAnchorAlignment(C),pe=-(le.horizontalAlign-.5)*R,ye=-(le.verticalAlign-.5)*F,Te=e.evaluateVariableOffset(C,V);return new e.Point(pe+Te[0]*ne,ye+Te[1]*ne)}function Jt(C,R,F,V,ne,le){var pe=C.x1,ye=C.x2,Te=C.y1,Ne=C.y2,Ge=C.anchorPointX,nt=C.anchorPointY,bt=new e.Point(R,F);return V&&bt._rotate(ne?le:-le),{x1:pe+bt.x,y1:Te+bt.y,x2:ye+bt.x,y2:Ne+bt.y,anchorPointX:Ge,anchorPointY:nt}}En.prototype.get=function(C){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[C]){var R=++this.maxGroupID;this.collisionGroups[C]={ID:R,predicate:function(F){return F.collisionGroupID===R}}}return this.collisionGroups[C]};var It=function(C,R,F,V){this.transform=C.clone(),this.collisionIndex=new Nr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=R,this.retainedQueryData={},this.collisionGroups=new En(F),this.collisionCircleArrays={},this.prevPlacement=V,V&&(V.prevPlacement=void 0),this.placedOrientations={}};function qt(C,R,F,V,ne){C.emplaceBack(R?1:0,F?1:0,V||0,ne||0),C.emplaceBack(R?1:0,F?1:0,V||0,ne||0),C.emplaceBack(R?1:0,F?1:0,V||0,ne||0),C.emplaceBack(R?1:0,F?1:0,V||0,ne||0)}It.prototype.getBucketParts=function(C,R,F,V){var ne=F.getBucket(R),le=F.latestFeatureIndex;if(ne&&le&&R.id===ne.layerIds[0]){var pe=F.collisionBoxArray,ye=ne.layers[0].layout,Te=Math.pow(2,this.transform.zoom-F.tileID.overscaledZ),Ne=F.tileSize/e.EXTENT,Ge=this.transform.calculatePosMatrix(F.tileID.toUnwrapped()),nt=ye.get("text-pitch-alignment")==="map",bt=ye.get("text-rotation-alignment")==="map",Ct=Pr(F,1,this.transform.zoom),Tt=dr(Ge,nt,bt,this.transform,Ct),At=null;if(nt){var yt=vr(Ge,nt,bt,this.transform,Ct);At=e.multiply([],this.transform.labelPlaneMatrix,yt)}this.retainedQueryData[ne.bucketInstanceId]=new An(ne.bucketInstanceId,le,ne.sourceLayerIndex,ne.index,F.tileID);var Ft={bucket:ne,layout:ye,posMatrix:Ge,textLabelPlaneMatrix:Tt,labelToScreenMatrix:At,scale:Te,textPixelRatio:Ne,holdingForFade:F.holdingForFade(),collisionBoxArray:pe,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(ne.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(ne.sourceID)};if(V)for(var zt=0,jt=ne.sortKeyRanges;zt<jt.length;zt+=1){var rr=jt[zt],hr=rr.sortKey,Ar=rr.symbolInstanceStart,kr=rr.symbolInstanceEnd;C.push({sortKey:hr,symbolInstanceStart:Ar,symbolInstanceEnd:kr,parameters:Ft})}else C.push({symbolInstanceStart:0,symbolInstanceEnd:ne.symbolInstances.length,parameters:Ft})}},It.prototype.attemptAnchorPlacement=function(C,R,F,V,ne,le,pe,ye,Te,Ne,Ge,nt,bt,Ct,Tt){var At,yt=[nt.textOffset0,nt.textOffset1],Ft=Bn(C,F,V,yt,ne),zt=this.collisionIndex.placeCollisionBox(Jt(R,Ft.x,Ft.y,le,pe,this.transform.angle),Ge,ye,Te,Ne.predicate);if(!(Tt&&this.collisionIndex.placeCollisionBox(Jt(Tt,Ft.x,Ft.y,le,pe,this.transform.angle),Ge,ye,Te,Ne.predicate).box.length===0)&&zt.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[nt.crossTileID]&&this.prevPlacement.placements[nt.crossTileID]&&this.prevPlacement.placements[nt.crossTileID].text&&(At=this.prevPlacement.variableOffsets[nt.crossTileID].anchor),this.variableOffsets[nt.crossTileID]={textOffset:yt,width:F,height:V,anchor:C,textBoxScale:ne,prevAnchor:At},this.markUsedJustification(bt,C,nt,Ct),bt.allowVerticalPlacement&&(this.markUsedOrientation(bt,Ct,nt),this.placedOrientations[nt.crossTileID]=Ct),{shift:Ft,placedGlyphBoxes:zt}},It.prototype.placeLayerBucketPart=function(C,R,F){var V=this,ne=C.parameters,le=ne.bucket,pe=ne.layout,ye=ne.posMatrix,Te=ne.textLabelPlaneMatrix,Ne=ne.labelToScreenMatrix,Ge=ne.textPixelRatio,nt=ne.holdingForFade,bt=ne.collisionBoxArray,Ct=ne.partiallyEvaluatedTextSize,Tt=ne.collisionGroup,At=pe.get("text-optional"),yt=pe.get("icon-optional"),Ft=pe.get("text-allow-overlap"),zt=pe.get("icon-allow-overlap"),jt=pe.get("text-rotation-alignment")==="map",rr=pe.get("text-pitch-alignment")==="map",hr=pe.get("icon-text-fit")!=="none",Ar=pe.get("symbol-z-order")==="viewport-y",kr=Ft&&(zt||!le.hasIconData()||yt),Kr=zt&&(Ft||!le.hasTextData()||At);!le.collisionArrays&&bt&&le.deserializeCollisionBoxes(bt);var Zr=function(Ur,kn){if(!R[Ur.crossTileID])if(nt)V.placements[Ur.crossTileID]=new Qr(!1,!1,!1);else{var Xn,Gn=!1,ea=!1,fa=!0,Ma=null,Kn={box:null,offscreen:null},xa={box:null,offscreen:null},ma=null,La=null,ba=0,Pa=0,Ua=0;kn.textFeatureIndex?ba=kn.textFeatureIndex:Ur.useRuntimeCollisionCircles&&(ba=Ur.featureIndex),kn.verticalTextFeatureIndex&&(Pa=kn.verticalTextFeatureIndex);var di=kn.textBox;if(di){var Ri=function(Li){var qo=e.WritingMode.horizontal;if(le.allowVerticalPlacement&&!Li&&V.prevPlacement){var Yo=V.prevPlacement.placedOrientations[Ur.crossTileID];Yo&&(V.placedOrientations[Ur.crossTileID]=Yo,qo=Yo,V.markUsedOrientation(le,qo,Ur))}return qo},Fi=function(Li,qo){if(le.allowVerticalPlacement&&Ur.numVerticalGlyphVertices>0&&kn.verticalTextBox)for(var Yo=0,du=le.writingModes;Yo<du.length&&(du[Yo]===e.WritingMode.vertical?(Kn=qo(),xa=Kn):Kn=Li(),!(Kn&&Kn.box&&Kn.box.length));Yo+=1);else Kn=Li()};if(pe.get("text-variable-anchor")){var pi=pe.get("text-variable-anchor");if(V.prevPlacement&&V.prevPlacement.variableOffsets[Ur.crossTileID]){var Ci=V.prevPlacement.variableOffsets[Ur.crossTileID];pi.indexOf(Ci.anchor)>0&&(pi=pi.filter(function(Li){return Li!==Ci.anchor})).unshift(Ci.anchor)}var bi=function(Li,qo,Yo){for(var du=Li.x2-Li.x1,Uf=Li.y2-Li.y1,fs=Ur.textBoxScale,Yu=hr&&!zt?qo:null,eu={box:[],offscreen:!1},Vf=Ft?2*pi.length:pi.length,kl=0;kl<Vf;++kl){var Hf=pi[kl%pi.length],gu=kl>=pi.length,Wu=V.attemptAnchorPlacement(Hf,Li,du,Uf,fs,jt,rr,Ge,ye,Tt,gu,Ur,le,Yo,Yu);if(Wu&&(eu=Wu.placedGlyphBoxes)&&eu.box&&eu.box.length){Gn=!0,Ma=Wu.shift;break}}return eu};Fi(function(){return bi(di,kn.iconBox,e.WritingMode.horizontal)},function(){var Li=kn.verticalTextBox,qo=Kn&&Kn.box&&Kn.box.length;return le.allowVerticalPlacement&&!qo&&Ur.numVerticalGlyphVertices>0&&Li?bi(Li,kn.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}}),Kn&&(Gn=Kn.box,fa=Kn.offscreen);var Lo=Ri(Kn&&Kn.box);if(!Gn&&V.prevPlacement){var Ki=V.prevPlacement.variableOffsets[Ur.crossTileID];Ki&&(V.variableOffsets[Ur.crossTileID]=Ki,V.markUsedJustification(le,Ki.anchor,Ur,Lo))}}else{var Zo=function(Li,qo){var Yo=V.collisionIndex.placeCollisionBox(Li,Ft,Ge,ye,Tt.predicate);return Yo&&Yo.box&&Yo.box.length&&(V.markUsedOrientation(le,qo,Ur),V.placedOrientations[Ur.crossTileID]=qo),Yo};Fi(function(){return Zo(di,e.WritingMode.horizontal)},function(){var Li=kn.verticalTextBox;return le.allowVerticalPlacement&&Ur.numVerticalGlyphVertices>0&&Li?Zo(Li,e.WritingMode.vertical):{box:null,offscreen:null}}),Ri(Kn&&Kn.box&&Kn.box.length)}}if(Gn=(Xn=Kn)&&Xn.box&&Xn.box.length>0,fa=Xn&&Xn.offscreen,Ur.useRuntimeCollisionCircles){var qs=le.text.placedSymbolArray.get(Ur.centerJustifiedTextSymbolIndex),yl=e.evaluateSizeForFeature(le.textSizeData,Ct,qs),Jl=pe.get("text-padding"),zl=Ur.collisionCircleDiameter;ma=V.collisionIndex.placeCollisionCircles(Ft,qs,le.lineVertexArray,le.glyphOffsetArray,yl,ye,Te,Ne,F,rr,Tt.predicate,zl,Jl),Gn=Ft||ma.circles.length>0&&!ma.collisionDetected,fa=fa&&ma.offscreen}if(kn.iconFeatureIndex&&(Ua=kn.iconFeatureIndex),kn.iconBox){var Rl=function(Li){var qo=hr&&Ma?Jt(Li,Ma.x,Ma.y,jt,rr,V.transform.angle):Li;return V.collisionIndex.placeCollisionBox(qo,zt,Ge,ye,Tt.predicate)};ea=xa&&xa.box&&xa.box.length&&kn.verticalIconBox?(La=Rl(kn.verticalIconBox)).box.length>0:(La=Rl(kn.iconBox)).box.length>0,fa=fa&&La.offscreen}var Po=At||Ur.numHorizontalGlyphVertices===0&&Ur.numVerticalGlyphVertices===0,Tl=yt||Ur.numIconVertices===0;if(Po||Tl?Tl?Po||(ea=ea&&Gn):Gn=ea&&Gn:ea=Gn=ea&&Gn,Gn&&Xn&&Xn.box&&(xa&&xa.box&&Pa?V.collisionIndex.insertCollisionBox(Xn.box,pe.get("text-ignore-placement"),le.bucketInstanceId,Pa,Tt.ID):V.collisionIndex.insertCollisionBox(Xn.box,pe.get("text-ignore-placement"),le.bucketInstanceId,ba,Tt.ID)),ea&&La&&V.collisionIndex.insertCollisionBox(La.box,pe.get("icon-ignore-placement"),le.bucketInstanceId,Ua,Tt.ID),ma&&(Gn&&V.collisionIndex.insertCollisionCircles(ma.circles,pe.get("text-ignore-placement"),le.bucketInstanceId,ba,Tt.ID),F)){var $l=le.bucketInstanceId,_s=V.collisionCircleArrays[$l];_s===void 0&&(_s=V.collisionCircleArrays[$l]=new rn);for(var Ql=0;Ql<ma.circles.length;Ql+=4)_s.circles.push(ma.circles[Ql+0]),_s.circles.push(ma.circles[Ql+1]),_s.circles.push(ma.circles[Ql+2]),_s.circles.push(ma.collisionDetected?1:0)}V.placements[Ur.crossTileID]=new Qr(Gn||kr,ea||Kr,fa||le.justReloaded),R[Ur.crossTileID]=!0}};if(Ar)for(var hn=le.getSortedSymbolIndexes(this.transform.angle),sn=hn.length-1;sn>=0;--sn){var Un=hn[sn];Zr(le.symbolInstances.get(Un),le.collisionArrays[Un])}else for(var Wn=C.symbolInstanceStart;Wn<C.symbolInstanceEnd;Wn++)Zr(le.symbolInstances.get(Wn),le.collisionArrays[Wn]);if(F&&le.bucketInstanceId in this.collisionCircleArrays){var ua=this.collisionCircleArrays[le.bucketInstanceId];e.invert(ua.invProjMatrix,ye),ua.viewportMatrix=this.collisionIndex.getViewportMatrix()}le.justReloaded=!1},It.prototype.markUsedJustification=function(C,R,F,V){var ne,le={left:F.leftJustifiedTextSymbolIndex,center:F.centerJustifiedTextSymbolIndex,right:F.rightJustifiedTextSymbolIndex};ne=V===e.WritingMode.vertical?F.verticalPlacedTextSymbolIndex:le[e.getAnchorJustification(R)];for(var pe=0,ye=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex,F.verticalPlacedTextSymbolIndex];pe<ye.length;pe+=1){var Te=ye[pe];Te>=0&&(C.text.placedSymbolArray.get(Te).crossTileID=ne>=0&&Te!==ne?0:F.crossTileID)}},It.prototype.markUsedOrientation=function(C,R,F){for(var V=R===e.WritingMode.horizontal||R===e.WritingMode.horizontalOnly?R:0,ne=R===e.WritingMode.vertical?R:0,le=0,pe=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex];le<pe.length;le+=1){var ye=pe[le];C.text.placedSymbolArray.get(ye).placedOrientation=V}F.verticalPlacedTextSymbolIndex&&(C.text.placedSymbolArray.get(F.verticalPlacedTextSymbolIndex).placedOrientation=ne)},It.prototype.commit=function(C){this.commitTime=C,this.zoomAtLastRecencyCheck=this.transform.zoom;var R=this.prevPlacement,F=!1;this.prevZoomAdjustment=R?R.zoomAdjustment(this.transform.zoom):0;var V=R?R.symbolFadeChange(C):1,ne=R?R.opacities:{},le=R?R.variableOffsets:{},pe=R?R.placedOrientations:{};for(var ye in this.placements){var Te=this.placements[ye],Ne=ne[ye];Ne?(this.opacities[ye]=new tn(Ne,V,Te.text,Te.icon),F=F||Te.text!==Ne.text.placed||Te.icon!==Ne.icon.placed):(this.opacities[ye]=new tn(null,V,Te.text,Te.icon,Te.skipFade),F=F||Te.text||Te.icon)}for(var Ge in ne){var nt=ne[Ge];if(!this.opacities[Ge]){var bt=new tn(nt,V,!1,!1);bt.isHidden()||(this.opacities[Ge]=bt,F=F||nt.text.placed||nt.icon.placed)}}for(var Ct in le)this.variableOffsets[Ct]||!this.opacities[Ct]||this.opacities[Ct].isHidden()||(this.variableOffsets[Ct]=le[Ct]);for(var Tt in pe)this.placedOrientations[Tt]||!this.opacities[Tt]||this.opacities[Tt].isHidden()||(this.placedOrientations[Tt]=pe[Tt]);F?this.lastPlacementChangeTime=C:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=R?R.lastPlacementChangeTime:C)},It.prototype.updateLayerOpacities=function(C,R){for(var F={},V=0,ne=R;V<ne.length;V+=1){var le=ne[V],pe=le.getBucket(C);pe&&le.latestFeatureIndex&&C.id===pe.layerIds[0]&&this.updateBucketOpacities(pe,F,le.collisionBoxArray)}},It.prototype.updateBucketOpacities=function(C,R,F){var V=this;C.hasTextData()&&C.text.opacityVertexArray.clear(),C.hasIconData()&&C.icon.opacityVertexArray.clear(),C.hasIconCollisionBoxData()&&C.iconCollisionBox.collisionVertexArray.clear(),C.hasTextCollisionBoxData()&&C.textCollisionBox.collisionVertexArray.clear();var ne=C.layers[0].layout,le=new tn(null,0,!1,!1,!0),pe=ne.get("text-allow-overlap"),ye=ne.get("icon-allow-overlap"),Te=ne.get("text-variable-anchor"),Ne=ne.get("text-rotation-alignment")==="map",Ge=ne.get("text-pitch-alignment")==="map",nt=ne.get("icon-text-fit")!=="none",bt=new tn(null,0,pe&&(ye||!C.hasIconData()||ne.get("icon-optional")),ye&&(pe||!C.hasTextData()||ne.get("text-optional")),!0);!C.collisionArrays&&F&&(C.hasIconCollisionBoxData()||C.hasTextCollisionBoxData())&&C.deserializeCollisionBoxes(F);for(var Ct=function(Ft,zt,jt){for(var rr=0;rr<zt/4;rr++)Ft.opacityVertexArray.emplaceBack(jt)},Tt=function(Ft){var zt=C.symbolInstances.get(Ft),jt=zt.numHorizontalGlyphVertices,rr=zt.numVerticalGlyphVertices,hr=zt.crossTileID,Ar=R[hr],kr=V.opacities[hr];Ar?kr=le:kr||(kr=bt,V.opacities[hr]=kr),R[hr]=!0;var Kr=jt>0||rr>0,Zr=zt.numIconVertices>0,hn=V.placedOrientations[zt.crossTileID],sn=hn===e.WritingMode.vertical,Un=hn===e.WritingMode.horizontal||hn===e.WritingMode.horizontalOnly;if(Kr){var Wn=Mr(kr.text),ua=sn?Ir:Wn;Ct(C.text,jt,ua);var Ur=Un?Ir:Wn;Ct(C.text,rr,Ur);var kn=kr.text.isHidden();[zt.rightJustifiedTextSymbolIndex,zt.centerJustifiedTextSymbolIndex,zt.leftJustifiedTextSymbolIndex].forEach(function(Ua){Ua>=0&&(C.text.placedSymbolArray.get(Ua).hidden=kn||sn?1:0)}),zt.verticalPlacedTextSymbolIndex>=0&&(C.text.placedSymbolArray.get(zt.verticalPlacedTextSymbolIndex).hidden=kn||Un?1:0);var Xn=V.variableOffsets[zt.crossTileID];Xn&&V.markUsedJustification(C,Xn.anchor,zt,hn);var Gn=V.placedOrientations[zt.crossTileID];Gn&&(V.markUsedJustification(C,"left",zt,Gn),V.markUsedOrientation(C,Gn,zt))}if(Zr){var ea=Mr(kr.icon),fa=!(nt&&zt.verticalPlacedIconSymbolIndex&&sn);if(zt.placedIconSymbolIndex>=0){var Ma=fa?ea:Ir;Ct(C.icon,zt.numIconVertices,Ma),C.icon.placedSymbolArray.get(zt.placedIconSymbolIndex).hidden=kr.icon.isHidden()}if(zt.verticalPlacedIconSymbolIndex>=0){var Kn=fa?Ir:ea;Ct(C.icon,zt.numVerticalIconVertices,Kn),C.icon.placedSymbolArray.get(zt.verticalPlacedIconSymbolIndex).hidden=kr.icon.isHidden()}}if(C.hasIconCollisionBoxData()||C.hasTextCollisionBoxData()){var xa=C.collisionArrays[Ft];if(xa){var ma=new e.Point(0,0);if(xa.textBox||xa.verticalTextBox){var La=!0;if(Te){var ba=V.variableOffsets[hr];ba?(ma=Bn(ba.anchor,ba.width,ba.height,ba.textOffset,ba.textBoxScale),Ne&&ma._rotate(Ge?V.transform.angle:-V.transform.angle)):La=!1}xa.textBox&&qt(C.textCollisionBox.collisionVertexArray,kr.text.placed,!La||sn,ma.x,ma.y),xa.verticalTextBox&&qt(C.textCollisionBox.collisionVertexArray,kr.text.placed,!La||Un,ma.x,ma.y)}var Pa=Boolean(!Un&&xa.verticalIconBox);xa.iconBox&&qt(C.iconCollisionBox.collisionVertexArray,kr.icon.placed,Pa,nt?ma.x:0,nt?ma.y:0),xa.verticalIconBox&&qt(C.iconCollisionBox.collisionVertexArray,kr.icon.placed,!Pa,nt?ma.x:0,nt?ma.y:0)}}},At=0;At<C.symbolInstances.length;At++)Tt(At);if(C.sortFeatures(this.transform.angle),this.retainedQueryData[C.bucketInstanceId]&&(this.retainedQueryData[C.bucketInstanceId].featureSortOrder=C.featureSortOrder),C.hasTextData()&&C.text.opacityVertexBuffer&&C.text.opacityVertexBuffer.updateData(C.text.opacityVertexArray),C.hasIconData()&&C.icon.opacityVertexBuffer&&C.icon.opacityVertexBuffer.updateData(C.icon.opacityVertexArray),C.hasIconCollisionBoxData()&&C.iconCollisionBox.collisionVertexBuffer&&C.iconCollisionBox.collisionVertexBuffer.updateData(C.iconCollisionBox.collisionVertexArray),C.hasTextCollisionBoxData()&&C.textCollisionBox.collisionVertexBuffer&&C.textCollisionBox.collisionVertexBuffer.updateData(C.textCollisionBox.collisionVertexArray),C.bucketInstanceId in this.collisionCircleArrays){var yt=this.collisionCircleArrays[C.bucketInstanceId];C.placementInvProjMatrix=yt.invProjMatrix,C.placementViewportMatrix=yt.viewportMatrix,C.collisionCircleArray=yt.circles,delete this.collisionCircleArrays[C.bucketInstanceId]}},It.prototype.symbolFadeChange=function(C){return this.fadeDuration===0?1:(C-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},It.prototype.zoomAdjustment=function(C){return Math.max(0,(this.transform.zoom-C)/1.5)},It.prototype.hasTransitions=function(C){return this.stale||C-this.lastPlacementChangeTime<this.fadeDuration},It.prototype.stillRecent=function(C,R){var F=this.zoomAtLastRecencyCheck===R?1-this.zoomAdjustment(R):1;return this.zoomAtLastRecencyCheck=R,this.commitTime+this.fadeDuration*F>C},It.prototype.setStale=function(){this.stale=!0};var fr=Math.pow(2,25),Tr=Math.pow(2,24),Gr=Math.pow(2,17),Vr=Math.pow(2,16),xr=Math.pow(2,9),wr=Math.pow(2,8),Sr=Math.pow(2,1);function Mr(C){if(C.opacity===0&&!C.placed)return 0;if(C.opacity===1&&C.placed)return 4294967295;var R=C.placed?1:0,F=Math.floor(127*C.opacity);return F*fr+R*Tr+F*Gr+R*Vr+F*xr+R*wr+F*Sr+R}var Ir=0,qr=function(C){this._sortAcrossTiles=C.layout.get("symbol-z-order")!=="viewport-y"&&C.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};qr.prototype.continuePlacement=function(C,R,F,V,ne){for(var le=this._bucketParts;this._currentTileIndex<C.length;){var pe=C[this._currentTileIndex];if(R.getBucketParts(le,V,pe,this._sortAcrossTiles),this._currentTileIndex++,ne())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,le.sort(function(Te,Ne){return Te.sortKey-Ne.sortKey}));this._currentPartIndex<le.length;){var ye=le[this._currentPartIndex];if(R.placeLayerBucketPart(ye,this._seenCrossTileIDs,F),this._currentPartIndex++,ne())return!0}return!1};var cn=function(C,R,F,V,ne,le,pe){this.placement=new It(C,ne,le,pe),this._currentPlacementIndex=R.length-1,this._forceFullPlacement=F,this._showCollisionBoxes=V,this._done=!1};cn.prototype.isDone=function(){return this._done},cn.prototype.continuePlacement=function(C,R,F){for(var V=this,ne=e.browser.now(),le=function(){var Te=e.browser.now()-ne;return!V._forceFullPlacement&&Te>2};this._currentPlacementIndex>=0;){var pe=R[C[this._currentPlacementIndex]],ye=this.placement.collisionIndex.transform.zoom;if(pe.type==="symbol"&&(!pe.minzoom||pe.minzoom<=ye)&&(!pe.maxzoom||pe.maxzoom>ye)){if(this._inProgressLayer||(this._inProgressLayer=new qr(pe)),this._inProgressLayer.continuePlacement(F[pe.source],this.placement,this._showCollisionBoxes,pe,le))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},cn.prototype.commit=function(C){return this.placement.commit(C),this.placement};var _n=512/e.EXTENT/2,Jr=function(C,R,F){this.tileID=C,this.indexedSymbolInstances={},this.bucketInstanceId=F;for(var V=0;V<R.length;V++){var ne=R.get(V),le=ne.key;this.indexedSymbolInstances[le]||(this.indexedSymbolInstances[le]=[]),this.indexedSymbolInstances[le].push({crossTileID:ne.crossTileID,coord:this.getScaledCoordinates(ne,C)})}};Jr.prototype.getScaledCoordinates=function(C,R){var F=R.canonical.z-this.tileID.canonical.z,V=_n/Math.pow(2,F);return{x:Math.floor((R.canonical.x*e.EXTENT+C.anchorX)*V),y:Math.floor((R.canonical.y*e.EXTENT+C.anchorY)*V)}},Jr.prototype.findMatches=function(C,R,F){for(var V=this.tileID.canonical.z<R.canonical.z?1:Math.pow(2,this.tileID.canonical.z-R.canonical.z),ne=0;ne<C.length;ne++){var le=C.get(ne);if(!le.crossTileID){var pe=this.indexedSymbolInstances[le.key];if(pe)for(var ye=this.getScaledCoordinates(le,R),Te=0,Ne=pe;Te<Ne.length;Te+=1){var Ge=Ne[Te];if(Math.abs(Ge.coord.x-ye.x)<=V&&Math.abs(Ge.coord.y-ye.y)<=V&&!F[Ge.crossTileID]){F[Ge.crossTileID]=!0,le.crossTileID=Ge.crossTileID;break}}}}};var bn=function(){this.maxCrossTileID=0};bn.prototype.generate=function(){return++this.maxCrossTileID};var Dr=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Dr.prototype.handleWrapJump=function(C){var R=Math.round((C-this.lng)/360);if(R!==0)for(var F in this.indexes){var V=this.indexes[F],ne={};for(var le in V){var pe=V[le];pe.tileID=pe.tileID.unwrapTo(pe.tileID.wrap+R),ne[pe.tileID.key]=pe}this.indexes[F]=ne}this.lng=C},Dr.prototype.addBucket=function(C,R,F){if(this.indexes[C.overscaledZ]&&this.indexes[C.overscaledZ][C.key]){if(this.indexes[C.overscaledZ][C.key].bucketInstanceId===R.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(C.overscaledZ,this.indexes[C.overscaledZ][C.key])}for(var V=0;V<R.symbolInstances.length;V++)R.symbolInstances.get(V).crossTileID=0;this.usedCrossTileIDs[C.overscaledZ]||(this.usedCrossTileIDs[C.overscaledZ]={});var ne=this.usedCrossTileIDs[C.overscaledZ];for(var le in this.indexes){var pe=this.indexes[le];if(Number(le)>C.overscaledZ)for(var ye in pe){var Te=pe[ye];Te.tileID.isChildOf(C)&&Te.findMatches(R.symbolInstances,C,ne)}else{var Ne=pe[C.scaledTo(Number(le)).key];Ne&&Ne.findMatches(R.symbolInstances,C,ne)}}for(var Ge=0;Ge<R.symbolInstances.length;Ge++){var nt=R.symbolInstances.get(Ge);nt.crossTileID||(nt.crossTileID=F.generate(),ne[nt.crossTileID]=!0)}return this.indexes[C.overscaledZ]===void 0&&(this.indexes[C.overscaledZ]={}),this.indexes[C.overscaledZ][C.key]=new Jr(C,R.symbolInstances,R.bucketInstanceId),!0},Dr.prototype.removeBucketCrossTileIDs=function(C,R){for(var F in R.indexedSymbolInstances)for(var V=0,ne=R.indexedSymbolInstances[F];V<ne.length;V+=1){var le=ne[V];delete this.usedCrossTileIDs[C][le.crossTileID]}},Dr.prototype.removeStaleBuckets=function(C){var R=!1;for(var F in this.indexes){var V=this.indexes[F];for(var ne in V)C[V[ne].bucketInstanceId]||(this.removeBucketCrossTileIDs(F,V[ne]),delete V[ne],R=!0)}return R};var Wr=function(){this.layerIndexes={},this.crossTileIDs=new bn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Wr.prototype.addLayer=function(C,R,F){var V=this.layerIndexes[C.id];V===void 0&&(V=this.layerIndexes[C.id]=new Dr);var ne=!1,le={};V.handleWrapJump(F);for(var pe=0,ye=R;pe<ye.length;pe+=1){var Te=ye[pe],Ne=Te.getBucket(C);Ne&&C.id===Ne.layerIds[0]&&(Ne.bucketInstanceId||(Ne.bucketInstanceId=++this.maxBucketInstanceId),V.addBucket(Te.tileID,Ne,this.crossTileIDs)&&(ne=!0),le[Ne.bucketInstanceId]=!0)}return V.removeStaleBuckets(le)&&(ne=!0),ne},Wr.prototype.pruneUnusedLayers=function(C){var R={};for(var F in C.forEach(function(V){R[V]=!0}),this.layerIndexes)R[F]||delete this.layerIndexes[F]};var vn=function(C,R){return e.emitValidationErrors(C,R&&R.filter(function(F){return F.identifier!=="source.canvas"}))},dn=e.pick(Ut,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Pn=e.pick(Ut,["setCenter","setZoom","setBearing","setPitch"]),sa=function(){var C={},R=e.styleSpec.$version;for(var F in e.styleSpec.$root){var V=e.styleSpec.$root[F];if(V.required){var ne=null;(ne=F==="version"?R:V.type==="array"?[]:{})!=null&&(C[F]=ne)}}return C}(),Yn=function(C){function R(F,V){var ne=this;V===void 0&&(V={}),C.call(this),this.map=F,this.dispatcher=new P(it(),this),this.imageManager=new y,this.imageManager.setEventedParent(this),this.glyphManager=new w(F._requestManager,V.localIdeographFontFamily),this.lineAtlas=new M(256,512),this.crossTileSymbolIndex=new Wr,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var le=this;this._rtlTextPluginCallback=R.registerForPluginStateChange(function(pe){var ye={pluginStatus:pe.pluginStatus,pluginURL:pe.pluginURL};le.dispatcher.broadcast("syncRTLPluginState",ye,function(Te,Ne){if(e.triggerPluginCompletionEvent(Te),Ne&&Ne.every(function(nt){return nt}))for(var Ge in le.sourceCaches)le.sourceCaches[Ge].reload()})}),this.on("data",function(pe){if(pe.dataType==="source"&&pe.sourceDataType==="metadata"){var ye=ne.sourceCaches[pe.sourceId];if(ye){var Te=ye.getSource();if(Te&&Te.vectorLayerIds)for(var Ne in ne._layers){var Ge=ne._layers[Ne];Ge.source===Te.id&&ne._validateLayer(Ge)}}}})}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.loadURL=function(F,V){var ne=this;V===void 0&&(V={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var le=typeof V.validate=="boolean"?V.validate:!e.isMapboxURL(F);F=this.map._requestManager.normalizeStyleURL(F,V.accessToken);var pe=this.map._requestManager.transformRequest(F,e.ResourceType.Style);this._request=e.getJSON(pe,function(ye,Te){ne._request=null,ye?ne.fire(new e.ErrorEvent(ye)):Te&&ne._load(Te,le)})},R.prototype.loadJSON=function(F,V){var ne=this;V===void 0&&(V={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){ne._request=null,ne._load(F,V.validate!==!1)})},R.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(sa,!1)},R.prototype._load=function(F,V){if(!V||!vn(this,e.validateStyle(F))){for(var ne in this._loaded=!0,this.stylesheet=F,F.sources)this.addSource(ne,F.sources[ne],{validate:!1});F.sprite?this._loadSprite(F.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(F.glyphs);var le=Nt(this.stylesheet.layers);this._order=le.map(function(Ne){return Ne.id}),this._layers={},this._serializedLayers={};for(var pe=0,ye=le;pe<ye.length;pe+=1){var Te=ye[pe];(Te=e.createStyleLayer(Te)).setEventedParent(this,{layer:{id:Te.id}}),this._layers[Te.id]=Te,this._serializedLayers[Te.id]=Te.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new L(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},R.prototype._loadSprite=function(F){var V=this;this._spriteRequest=function(ne,le,pe){var ye,Te,Ne,Ge=e.browser.devicePixelRatio>1?"@2x":"",nt=e.getJSON(le.transformRequest(le.normalizeSpriteURL(ne,Ge,".json"),e.ResourceType.SpriteJSON),function(Tt,At){nt=null,Ne||(Ne=Tt,ye=At,Ct())}),bt=e.getImage(le.transformRequest(le.normalizeSpriteURL(ne,Ge,".png"),e.ResourceType.SpriteImage),function(Tt,At){bt=null,Ne||(Ne=Tt,Te=At,Ct())});function Ct(){if(Ne)pe(Ne);else if(ye&&Te){var Tt=e.browser.getImageData(Te),At={};for(var yt in ye){var Ft=ye[yt],zt=Ft.width,jt=Ft.height,rr=Ft.x,hr=Ft.y,Ar=Ft.sdf,kr=Ft.pixelRatio,Kr=Ft.stretchX,Zr=Ft.stretchY,hn=Ft.content,sn=new e.RGBAImage({width:zt,height:jt});e.RGBAImage.copy(Tt,sn,{x:rr,y:hr},{x:0,y:0},{width:zt,height:jt}),At[yt]={data:sn,pixelRatio:kr,sdf:Ar,stretchX:Kr,stretchY:Zr,content:hn}}pe(null,At)}}return{cancel:function(){nt&&(nt.cancel(),nt=null),bt&&(bt.cancel(),bt=null)}}}(F,this.map._requestManager,function(ne,le){if(V._spriteRequest=null,ne)V.fire(new e.ErrorEvent(ne));else if(le)for(var pe in le)V.imageManager.addImage(pe,le[pe]);V.imageManager.setLoaded(!0),V._availableImages=V.imageManager.listImages(),V.dispatcher.broadcast("setImages",V._availableImages),V.fire(new e.Event("data",{dataType:"style"}))})},R.prototype._validateLayer=function(F){var V=this.sourceCaches[F.source];if(V){var ne=F.sourceLayer;if(ne){var le=V.getSource();(le.type==="geojson"||le.vectorLayerIds&&le.vectorLayerIds.indexOf(ne)===-1)&&this.fire(new e.ErrorEvent(new Error('Source layer "'+ne+'" does not exist on source "'+le.id+'" as specified by style layer "'+F.id+'"')))}}},R.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var F in this.sourceCaches)if(!this.sourceCaches[F].loaded())return!1;return!!this.imageManager.isLoaded()},R.prototype._serializeLayers=function(F){for(var V=[],ne=0,le=F;ne<le.length;ne+=1){var pe=le[ne],ye=this._layers[pe];ye.type!=="custom"&&V.push(ye.serialize())}return V},R.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var F in this.sourceCaches)if(this.sourceCaches[F].hasTransition())return!0;for(var V in this._layers)if(this._layers[V].hasTransition())return!0;return!1},R.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},R.prototype.update=function(F){if(this._loaded){var V=this._changed;if(this._changed){var ne=Object.keys(this._updatedLayers),le=Object.keys(this._removedLayers);for(var pe in(ne.length||le.length)&&this._updateWorkerLayers(ne,le),this._updatedSources){var ye=this._updatedSources[pe];ye==="reload"?this._reloadSource(pe):ye==="clear"&&this._clearSource(pe)}for(var Te in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Te].updateTransitions(F);this.light.updateTransitions(F),this._resetUpdates()}for(var Ne in this.sourceCaches)this.sourceCaches[Ne].used=!1;for(var Ge=0,nt=this._order;Ge<nt.length;Ge+=1){var bt=nt[Ge],Ct=this._layers[bt];Ct.recalculate(F,this._availableImages),!Ct.isHidden(F.zoom)&&Ct.source&&(this.sourceCaches[Ct.source].used=!0)}this.light.recalculate(F),this.z=F.zoom,V&&this.fire(new e.Event("data",{dataType:"style"}))}},R.prototype._updateTilesForChangedImages=function(){var F=Object.keys(this._changedImages);if(F.length){for(var V in this.sourceCaches)this.sourceCaches[V].reloadTilesForDependencies(["icons","patterns"],F);this._changedImages={}}},R.prototype._updateWorkerLayers=function(F,V){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(F),removedIds:V})},R.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},R.prototype.setState=function(F){var V=this;if(this._checkLoaded(),vn(this,e.validateStyle(F)))return!1;(F=e.clone$1(F)).layers=Nt(F.layers);var ne=Xt(this.serialize(),F).filter(function(pe){return!(pe.command in Pn)});if(ne.length===0)return!1;var le=ne.filter(function(pe){return!(pe.command in dn)});if(le.length>0)throw new Error("Unimplemented: "+le.map(function(pe){return pe.command}).join(", ")+".");return ne.forEach(function(pe){pe.command!=="setTransition"&&V[pe.command].apply(V,pe.args)}),this.stylesheet=F,!0},R.prototype.addImage=function(F,V){if(this.getImage(F))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(F,V),this._availableImages=this.imageManager.listImages(),this._changedImages[F]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},R.prototype.updateImage=function(F,V){this.imageManager.updateImage(F,V)},R.prototype.getImage=function(F){return this.imageManager.getImage(F)},R.prototype.removeImage=function(F){if(!this.getImage(F))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(F),this._availableImages=this.imageManager.listImages(),this._changedImages[F]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},R.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},R.prototype.addSource=function(F,V,ne){var le=this;if(ne===void 0&&(ne={}),this._checkLoaded(),this.sourceCaches[F]!==void 0)throw new Error("There is already a source with this ID");if(!V.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(V).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(V.type)>=0)||!this._validate(e.validateStyle.source,"sources."+F,V,null,ne)){this.map&&this.map._collectResourceTiming&&(V.collectResourceTiming=!0);var pe=this.sourceCaches[F]=new Xe(F,V,this.dispatcher);pe.style=this,pe.setEventedParent(this,function(){return{isSourceLoaded:le.loaded(),source:pe.serialize(),sourceId:F}}),pe.onAdd(this.map),this._changed=!0}},R.prototype.removeSource=function(F){if(this._checkLoaded(),this.sourceCaches[F]===void 0)throw new Error("There is no source with this ID");for(var V in this._layers)if(this._layers[V].source===F)return this.fire(new e.ErrorEvent(new Error('Source "'+F+'" cannot be removed while layer "'+V+'" is using it.')));var ne=this.sourceCaches[F];delete this.sourceCaches[F],delete this._updatedSources[F],ne.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:F})),ne.setEventedParent(null),ne.clearTiles(),ne.onRemove&&ne.onRemove(this.map),this._changed=!0},R.prototype.setGeoJSONSourceData=function(F,V){this._checkLoaded(),this.sourceCaches[F].getSource().setData(V),this._changed=!0},R.prototype.getSource=function(F){return this.sourceCaches[F]&&this.sourceCaches[F].getSource()},R.prototype.addLayer=function(F,V,ne){ne===void 0&&(ne={}),this._checkLoaded();var le=F.id;if(this.getLayer(le))this.fire(new e.ErrorEvent(new Error('Layer with id "'+le+'" already exists on this map')));else{var pe;if(F.type==="custom"){if(vn(this,e.validateCustomStyleLayer(F)))return;pe=e.createStyleLayer(F)}else{if(typeof F.source=="object"&&(this.addSource(le,F.source),F=e.clone$1(F),F=e.extend(F,{source:le})),this._validate(e.validateStyle.layer,"layers."+le,F,{arrayIndex:-1},ne))return;pe=e.createStyleLayer(F),this._validateLayer(pe),pe.setEventedParent(this,{layer:{id:le}}),this._serializedLayers[pe.id]=pe.serialize()}var ye=V?this._order.indexOf(V):this._order.length;if(V&&ye===-1)this.fire(new e.ErrorEvent(new Error('Layer with id "'+V+'" does not exist on this map.')));else{if(this._order.splice(ye,0,le),this._layerOrderChanged=!0,this._layers[le]=pe,this._removedLayers[le]&&pe.source&&pe.type!=="custom"){var Te=this._removedLayers[le];delete this._removedLayers[le],Te.type!==pe.type?this._updatedSources[pe.source]="clear":(this._updatedSources[pe.source]="reload",this.sourceCaches[pe.source].pause())}this._updateLayer(pe),pe.onAdd&&pe.onAdd(this.map)}}},R.prototype.moveLayer=function(F,V){if(this._checkLoaded(),this._changed=!0,this._layers[F]){if(F!==V){var ne=this._order.indexOf(F);this._order.splice(ne,1);var le=V?this._order.indexOf(V):this._order.length;V&&le===-1?this.fire(new e.ErrorEvent(new Error('Layer with id "'+V+'" does not exist on this map.'))):(this._order.splice(le,0,F),this._layerOrderChanged=!0)}}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be moved.")))},R.prototype.removeLayer=function(F){this._checkLoaded();var V=this._layers[F];if(V){V.setEventedParent(null);var ne=this._order.indexOf(F);this._order.splice(ne,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[F]=V,delete this._layers[F],delete this._serializedLayers[F],delete this._updatedLayers[F],delete this._updatedPaintProps[F],V.onRemove&&V.onRemove(this.map)}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be removed.")))},R.prototype.getLayer=function(F){return this._layers[F]},R.prototype.hasLayer=function(F){return F in this._layers},R.prototype.setLayerZoomRange=function(F,V,ne){this._checkLoaded();var le=this.getLayer(F);le?le.minzoom===V&&le.maxzoom===ne||(V!=null&&(le.minzoom=V),ne!=null&&(le.maxzoom=ne),this._updateLayer(le)):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot have zoom extent.")))},R.prototype.setFilter=function(F,V,ne){ne===void 0&&(ne={}),this._checkLoaded();var le=this.getLayer(F);if(le){if(!e.deepEqual(le.filter,V))return V==null?(le.filter=void 0,void this._updateLayer(le)):void(this._validate(e.validateStyle.filter,"layers."+le.id+".filter",V,null,ne)||(le.filter=e.clone$1(V),this._updateLayer(le)))}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be filtered.")))},R.prototype.getFilter=function(F){return e.clone$1(this.getLayer(F).filter)},R.prototype.setLayoutProperty=function(F,V,ne,le){le===void 0&&(le={}),this._checkLoaded();var pe=this.getLayer(F);pe?e.deepEqual(pe.getLayoutProperty(V),ne)||(pe.setLayoutProperty(V,ne,le),this._updateLayer(pe)):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be styled.")))},R.prototype.getLayoutProperty=function(F,V){var ne=this.getLayer(F);if(ne)return ne.getLayoutProperty(V);this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style.")))},R.prototype.setPaintProperty=function(F,V,ne,le){le===void 0&&(le={}),this._checkLoaded();var pe=this.getLayer(F);pe?e.deepEqual(pe.getPaintProperty(V),ne)||(pe.setPaintProperty(V,ne,le)&&this._updateLayer(pe),this._changed=!0,this._updatedPaintProps[F]=!0):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be styled.")))},R.prototype.getPaintProperty=function(F,V){return this.getLayer(F).getPaintProperty(V)},R.prototype.setFeatureState=function(F,V){this._checkLoaded();var ne=F.source,le=F.sourceLayer,pe=this.sourceCaches[ne];if(pe!==void 0){var ye=pe.getSource().type;ye==="geojson"&&le?this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):ye!=="vector"||le?(F.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),pe.setFeatureState(le,F.id,V)):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+ne+"' does not exist in the map's style.")))},R.prototype.removeFeatureState=function(F,V){this._checkLoaded();var ne=F.source,le=this.sourceCaches[ne];if(le!==void 0){var pe=le.getSource().type,ye=pe==="vector"?F.sourceLayer:void 0;pe!=="vector"||ye?V&&typeof F.id!="string"&&typeof F.id!="number"?this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):le.removeFeatureState(ye,F.id,V):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+ne+"' does not exist in the map's style.")))},R.prototype.getFeatureState=function(F){this._checkLoaded();var V=F.source,ne=F.sourceLayer,le=this.sourceCaches[V];if(le!==void 0){if(le.getSource().type!=="vector"||ne)return F.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),le.getFeatureState(ne,F.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+V+"' does not exist in the map's style.")))},R.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},R.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(F){return F.serialize()}),layers:this._serializeLayers(this._order)},function(F){return F!==void 0})},R.prototype._updateLayer=function(F){this._updatedLayers[F.id]=!0,F.source&&!this._updatedSources[F.source]&&this.sourceCaches[F.source].getSource().type!=="raster"&&(this._updatedSources[F.source]="reload",this.sourceCaches[F.source].pause()),this._changed=!0},R.prototype._flattenAndSortRenderedFeatures=function(F){for(var V=this,ne=function(hn){return V._layers[hn].type==="fill-extrusion"},le={},pe=[],ye=this._order.length-1;ye>=0;ye--){var Te=this._order[ye];if(ne(Te)){le[Te]=ye;for(var Ne=0,Ge=F;Ne<Ge.length;Ne+=1){var nt=Ge[Ne][Te];if(nt)for(var bt=0,Ct=nt;bt<Ct.length;bt+=1){var Tt=Ct[bt];pe.push(Tt)}}}}pe.sort(function(hn,sn){return sn.intersectionZ-hn.intersectionZ});for(var At=[],yt=this._order.length-1;yt>=0;yt--){var Ft=this._order[yt];if(ne(Ft))for(var zt=pe.length-1;zt>=0;zt--){var jt=pe[zt].feature;if(le[jt.layer.id]<yt)break;At.push(jt),pe.pop()}else for(var rr=0,hr=F;rr<hr.length;rr+=1){var Ar=hr[rr][Ft];if(Ar)for(var kr=0,Kr=Ar;kr<Kr.length;kr+=1){var Zr=Kr[kr];At.push(Zr.feature)}}}return At},R.prototype.queryRenderedFeatures=function(F,V,ne){V&&V.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",V.filter,null,V);var le={};if(V&&V.layers){if(!Array.isArray(V.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var pe=0,ye=V.layers;pe<ye.length;pe+=1){var Te=ye[pe],Ne=this._layers[Te];if(!Ne)return this.fire(new e.ErrorEvent(new Error("The layer '"+Te+"' does not exist in the map's style and cannot be queried for features."))),[];le[Ne.source]=!0}}var Ge=[];for(var nt in V.availableImages=this._availableImages,this.sourceCaches)V.layers&&!le[nt]||Ge.push(W(this.sourceCaches[nt],this._layers,this._serializedLayers,F,V,ne));return this.placement&&Ge.push(function(bt,Ct,Tt,At,yt,Ft,zt){for(var jt={},rr=Ft.queryRenderedSymbols(At),hr=[],Ar=0,kr=Object.keys(rr).map(Number);Ar<kr.length;Ar+=1){var Kr=kr[Ar];hr.push(zt[Kr])}hr.sort(ee);for(var Zr=function(){var ua=sn[hn],Ur=ua.featureIndex.lookupSymbolFeatures(rr[ua.bucketInstanceId],Ct,ua.bucketIndex,ua.sourceLayerIndex,yt.filter,yt.layers,yt.availableImages,bt);for(var kn in Ur){var Xn=jt[kn]=jt[kn]||[],Gn=Ur[kn];Gn.sort(function(Kn,xa){var ma=ua.featureSortOrder;if(ma){var La=ma.indexOf(Kn.featureIndex);return ma.indexOf(xa.featureIndex)-La}return xa.featureIndex-Kn.featureIndex});for(var ea=0,fa=Gn;ea<fa.length;ea+=1){var Ma=fa[ea];Xn.push(Ma)}}},hn=0,sn=hr;hn<sn.length;hn+=1)Zr();var Un=function(ua){jt[ua].forEach(function(Ur){var kn=Ur.feature,Xn=bt[ua],Gn=Tt[Xn.source].getFeatureState(kn.layer["source-layer"],kn.id);kn.source=kn.layer.source,kn.layer["source-layer"]&&(kn.sourceLayer=kn.layer["source-layer"]),kn.state=Gn})};for(var Wn in jt)Un(Wn);return jt}(this._layers,this._serializedLayers,this.sourceCaches,F,V,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Ge)},R.prototype.querySourceFeatures=function(F,V){V&&V.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",V.filter,null,V);var ne=this.sourceCaches[F];return ne?function(le,pe){for(var ye=le.getRenderableIds().map(function(Ct){return le.getTileByID(Ct)}),Te=[],Ne={},Ge=0;Ge<ye.length;Ge++){var nt=ye[Ge],bt=nt.tileID.canonical.key;Ne[bt]||(Ne[bt]=!0,nt.querySourceFeatures(Te,pe))}return Te}(ne,V):[]},R.prototype.addSourceType=function(F,V,ne){return R.getSourceType(F)?ne(new Error('A source type called "'+F+'" already exists.')):(R.setSourceType(F,V),V.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:F,url:V.workerSourceURL},ne):ne(null,null))},R.prototype.getLight=function(){return this.light.getLight()},R.prototype.setLight=function(F,V){V===void 0&&(V={}),this._checkLoaded();var ne=this.light.getLight(),le=!1;for(var pe in F)if(!e.deepEqual(F[pe],ne[pe])){le=!0;break}if(le){var ye={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(F,V),this.light.updateTransitions(ye)}},R.prototype._validate=function(F,V,ne,le,pe){return pe===void 0&&(pe={}),(!pe||pe.validate!==!1)&&vn(this,F.call(e.validateStyle,e.extend({key:V,style:this.serialize(),value:ne,styleSpec:e.styleSpec},le)))},R.prototype._remove=function(){for(var F in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[F].setEventedParent(null);for(var V in this.sourceCaches)this.sourceCaches[V].clearTiles(),this.sourceCaches[V].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},R.prototype._clearSource=function(F){this.sourceCaches[F].clearTiles()},R.prototype._reloadSource=function(F){this.sourceCaches[F].resume(),this.sourceCaches[F].reload()},R.prototype._updateSources=function(F){for(var V in this.sourceCaches)this.sourceCaches[V].update(F)},R.prototype._generateCollisionBoxes=function(){for(var F in this.sourceCaches)this._reloadSource(F)},R.prototype._updatePlacement=function(F,V,ne,le,pe){pe===void 0&&(pe=!1);for(var ye=!1,Te=!1,Ne={},Ge=0,nt=this._order;Ge<nt.length;Ge+=1){var bt=nt[Ge],Ct=this._layers[bt];if(Ct.type==="symbol"){if(!Ne[Ct.source]){var Tt=this.sourceCaches[Ct.source];Ne[Ct.source]=Tt.getRenderableIds(!0).map(function(rr){return Tt.getTileByID(rr)}).sort(function(rr,hr){return hr.tileID.overscaledZ-rr.tileID.overscaledZ||(rr.tileID.isLessThan(hr.tileID)?-1:1)})}var At=this.crossTileSymbolIndex.addLayer(Ct,Ne[Ct.source],F.center.lng);ye=ye||At}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((pe=pe||this._layerOrderChanged||ne===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),F.zoom))&&(this.pauseablePlacement=new cn(F,this._order,pe,V,ne,le,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ne),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),Te=!0),ye&&this.pauseablePlacement.placement.setStale()),Te||ye)for(var yt=0,Ft=this._order;yt<Ft.length;yt+=1){var zt=Ft[yt],jt=this._layers[zt];jt.type==="symbol"&&this.placement.updateLayerOpacities(jt,Ne[jt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now())},R.prototype._releaseSymbolFadeTiles=function(){for(var F in this.sourceCaches)this.sourceCaches[F].releaseSymbolFadeTiles()},R.prototype.getImages=function(F,V,ne){this.imageManager.getImages(V.icons,ne),this._updateTilesForChangedImages();var le=this.sourceCaches[V.source];le&&le.setDependencies(V.tileID.key,V.type,V.icons)},R.prototype.getGlyphs=function(F,V,ne){this.glyphManager.getGlyphs(V.stacks,ne)},R.prototype.getResource=function(F,V,ne){return e.makeRequest(V,ne)},R}(e.Evented);Yn.getSourceType=function(C){return z[C]},Yn.setSourceType=function(C,R){z[C]=R},Yn.registerForPluginStateChange=e.registerForPluginStateChange;var yn=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),ra=Xa(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),pa=Xa(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Qa=Xa(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Bi=Xa(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),li=Xa("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ai=Xa(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Ea=Xa(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ga=Xa("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),ko=Xa("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Qo=Xa("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),us=Xa(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),$i=Xa(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),to=Xa(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),es=Xa(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Wa=Xa(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),jo=Xa(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Ao=Xa(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Mi=Xa(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),ro=Xa(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Mo=Xa(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define MAX_LINE_DISTANCE 32767.0
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),zo=Xa(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Vi=Xa(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),yi=Xa(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Qi=Xa(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Vs=Xa(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Xs=Xa(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Xa(C,R){var F=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,V={};return{fragmentSource:C=C.replace(F,function(ne,le,pe,ye,Te){return V[Te]=!0,le==="define"?`
#ifndef HAS_UNIFORM_u_`+Te+`
varying `+pe+" "+ye+" "+Te+`;
#else
uniform `+pe+" "+ye+" u_"+Te+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Te+`
    `+pe+" "+ye+" "+Te+" = u_"+Te+`;
#endif
`}),vertexSource:R=R.replace(F,function(ne,le,pe,ye,Te){var Ne=ye==="float"?"vec2":"vec4",Ge=Te.match(/color/)?"color":Ne;return V[Te]?le==="define"?`
#ifndef HAS_UNIFORM_u_`+Te+`
uniform lowp float u_`+Te+`_t;
attribute `+pe+" "+Ne+" a_"+Te+`;
varying `+pe+" "+ye+" "+Te+`;
#else
uniform `+pe+" "+ye+" u_"+Te+`;
#endif
`:Ge==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+Te+" = a_"+Te+`;
#else
    `+pe+" "+ye+" "+Te+" = u_"+Te+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+Te+" = unpack_mix_"+Ge+"(a_"+Te+", u_"+Te+`_t);
#else
    `+pe+" "+ye+" "+Te+" = u_"+Te+`;
#endif
`:le==="define"?`
#ifndef HAS_UNIFORM_u_`+Te+`
uniform lowp float u_`+Te+`_t;
attribute `+pe+" "+Ne+" a_"+Te+`;
#else
uniform `+pe+" "+ye+" u_"+Te+`;
#endif
`:Ge==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+pe+" "+ye+" "+Te+" = a_"+Te+`;
#else
    `+pe+" "+ye+" "+Te+" = u_"+Te+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+pe+" "+ye+" "+Te+" = unpack_mix_"+Ge+"(a_"+Te+", u_"+Te+`_t);
#else
    `+pe+" "+ye+" "+Te+" = u_"+Te+`;
#endif
`})}}var Os=Object.freeze({__proto__:null,prelude:ra,background:pa,backgroundPattern:Qa,circle:Bi,clippingMask:li,heatmap:Ai,heatmapTexture:Ea,collisionBox:Ga,collisionCircle:ko,debug:Qo,fill:us,fillOutline:$i,fillOutlinePattern:to,fillPattern:es,fillExtrusion:Wa,fillExtrusionPattern:jo,hillshadePrepare:Ao,hillshade:Mi,line:ro,lineGradient:Mo,linePattern:zo,lineSDF:Vi,raster:yi,symbolIcon:Qi,symbolSDF:Vs,symbolTextAndIcon:Xs}),ms=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};ms.prototype.bind=function(C,R,F,V,ne,le,pe,ye){this.context=C;for(var Te=this.boundPaintVertexBuffers.length!==V.length,Ne=0;!Te&&Ne<V.length;Ne++)this.boundPaintVertexBuffers[Ne]!==V[Ne]&&(Te=!0);var Ge=!this.vao||this.boundProgram!==R||this.boundLayoutVertexBuffer!==F||Te||this.boundIndexBuffer!==ne||this.boundVertexOffset!==le||this.boundDynamicVertexBuffer!==pe||this.boundDynamicVertexBuffer2!==ye;!C.extVertexArrayObject||Ge?this.freshBind(R,F,V,ne,le,pe,ye):(C.bindVertexArrayOES.set(this.vao),pe&&pe.bind(),ne&&ne.dynamicDraw&&ne.bind(),ye&&ye.bind())},ms.prototype.freshBind=function(C,R,F,V,ne,le,pe){var ye,Te=C.numAttributes,Ne=this.context,Ge=Ne.gl;if(Ne.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ne.extVertexArrayObject.createVertexArrayOES(),Ne.bindVertexArrayOES.set(this.vao),ye=0,this.boundProgram=C,this.boundLayoutVertexBuffer=R,this.boundPaintVertexBuffers=F,this.boundIndexBuffer=V,this.boundVertexOffset=ne,this.boundDynamicVertexBuffer=le,this.boundDynamicVertexBuffer2=pe;else{ye=Ne.currentNumAttributes||0;for(var nt=Te;nt<ye;nt++)Ge.disableVertexAttribArray(nt)}R.enableAttributes(Ge,C);for(var bt=0,Ct=F;bt<Ct.length;bt+=1)Ct[bt].enableAttributes(Ge,C);le&&le.enableAttributes(Ge,C),pe&&pe.enableAttributes(Ge,C),R.bind(),R.setVertexAttribPointers(Ge,C,ne);for(var Tt=0,At=F;Tt<At.length;Tt+=1){var yt=At[Tt];yt.bind(),yt.setVertexAttribPointers(Ge,C,ne)}le&&(le.bind(),le.setVertexAttribPointers(Ge,C,ne)),V&&V.bind(),pe&&(pe.bind(),pe.setVertexAttribPointers(Ge,C,ne)),Ne.currentNumAttributes=Te},ms.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Zs=function(C,R,F,V,ne){var le=C.gl;this.program=le.createProgram();var pe=F?F.defines():[];ne&&pe.push("#define OVERDRAW_INSPECTOR;");var ye=pe.concat(ra.fragmentSource,R.fragmentSource).join(`
`),Te=pe.concat(ra.vertexSource,R.vertexSource).join(`
`),Ne=le.createShader(le.FRAGMENT_SHADER);if(le.isContextLost())this.failedToCreate=!0;else{le.shaderSource(Ne,ye),le.compileShader(Ne),le.attachShader(this.program,Ne);var Ge=le.createShader(le.VERTEX_SHADER);if(le.isContextLost())this.failedToCreate=!0;else{le.shaderSource(Ge,Te),le.compileShader(Ge),le.attachShader(this.program,Ge);for(var nt=F?F.layoutAttributes:[],bt=0;bt<nt.length;bt++)le.bindAttribLocation(this.program,bt,nt[bt].name);le.linkProgram(this.program),le.deleteShader(Ge),le.deleteShader(Ne),this.numAttributes=le.getProgramParameter(this.program,le.ACTIVE_ATTRIBUTES),this.attributes={};for(var Ct={},Tt=0;Tt<this.numAttributes;Tt++){var At=le.getActiveAttrib(this.program,Tt);At&&(this.attributes[At.name]=le.getAttribLocation(this.program,At.name))}for(var yt=le.getProgramParameter(this.program,le.ACTIVE_UNIFORMS),Ft=0;Ft<yt;Ft++){var zt=le.getActiveUniform(this.program,Ft);zt&&(Ct[zt.name]=le.getUniformLocation(this.program,zt.name))}this.fixedUniforms=V(C,Ct),this.binderUniforms=F?F.getUniforms(C,Ct):[]}}};function Ks(C,R,F){var V=1/Pr(F,1,R.transform.tileZoom),ne=Math.pow(2,F.tileID.overscaledZ),le=F.tileSize*Math.pow(2,R.transform.tileZoom)/ne,pe=le*(F.tileID.canonical.x+F.tileID.wrap*ne),ye=le*F.tileID.canonical.y;return{u_image:0,u_texsize:F.imageAtlasTexture.size,u_scale:[V,C.fromScale,C.toScale],u_fade:C.t,u_pixel_coord_upper:[pe>>16,ye>>16],u_pixel_coord_lower:[65535&pe,65535&ye]}}Zs.prototype.draw=function(C,R,F,V,ne,le,pe,ye,Te,Ne,Ge,nt,bt,Ct,Tt,At){var yt,Ft=C.gl;if(!this.failedToCreate){for(var zt in C.program.set(this.program),C.setDepthMode(F),C.setStencilMode(V),C.setColorMode(ne),C.setCullFace(le),this.fixedUniforms)this.fixedUniforms[zt].set(pe[zt]);Ct&&Ct.setUniforms(C,this.binderUniforms,nt,{zoom:bt});for(var jt=(yt={},yt[Ft.LINES]=2,yt[Ft.TRIANGLES]=3,yt[Ft.LINE_STRIP]=1,yt)[R],rr=0,hr=Ge.get();rr<hr.length;rr+=1){var Ar=hr[rr],kr=Ar.vaos||(Ar.vaos={});(kr[ye]||(kr[ye]=new ms)).bind(C,this,Te,Ct?Ct.getPaintVertexBuffers():[],Ne,Ar.vertexOffset,Tt,At),Ft.drawElements(R,Ar.primitiveLength*jt,Ft.UNSIGNED_SHORT,Ar.primitiveOffset*jt*2)}}};var Hs=function(C,R,F,V){var ne=R.style.light,le=ne.properties.get("position"),pe=[le.x,le.y,le.z],ye=e.create$1();ne.properties.get("anchor")==="viewport"&&e.fromRotation(ye,-R.transform.angle),e.transformMat3(pe,pe,ye);var Te=ne.properties.get("color");return{u_matrix:C,u_lightpos:pe,u_lightintensity:ne.properties.get("intensity"),u_lightcolor:[Te.r,Te.g,Te.b],u_vertical_gradient:+F,u_opacity:V}},Js=function(C,R,F,V,ne,le,pe){return e.extend(Hs(C,R,F,V),Ks(le,R,pe),{u_height_factor:-Math.pow(2,ne.overscaledZ)/pe.tileSize/8})},Uo=function(C){return{u_matrix:C}},Vo=function(C,R,F,V){return e.extend(Uo(C),Ks(F,R,V))},ts=function(C,R){return{u_matrix:C,u_world:R}},rs=function(C,R,F,V,ne){return e.extend(Vo(C,R,F,V),{u_world:ne})},ns=function(C,R,F,V){var ne,le,pe=C.transform;if(V.paint.get("circle-pitch-alignment")==="map"){var ye=Pr(F,1,pe.zoom);ne=!0,le=[ye,ye]}else ne=!1,le=pe.pixelsToGLUnits;return{u_camera_to_center_distance:pe.cameraToCenterDistance,u_scale_with_map:+(V.paint.get("circle-pitch-scale")==="map"),u_matrix:C.translatePosMatrix(R.posMatrix,F,V.paint.get("circle-translate"),V.paint.get("circle-translate-anchor")),u_pitch_with_map:+ne,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:le}},vs=function(C,R,F){var V=Pr(F,1,R.zoom),ne=Math.pow(2,R.zoom-F.tileID.overscaledZ),le=F.tileID.overscaleFactor();return{u_matrix:C,u_camera_to_center_distance:R.cameraToCenterDistance,u_pixels_to_tile_units:V,u_extrude_scale:[R.pixelsToGLUnits[0]/(V*ne),R.pixelsToGLUnits[1]/(V*ne)],u_overscale_factor:le}},So=function(C,R,F){return{u_matrix:C,u_inv_matrix:R,u_camera_to_center_distance:F.cameraToCenterDistance,u_viewport_size:[F.width,F.height]}},Ds=function(C,R,F){return F===void 0&&(F=1),{u_matrix:C,u_color:R,u_overlay:0,u_overlay_scale:F}},vo=function(C){return{u_matrix:C}},as=function(C,R,F,V){return{u_matrix:C,u_extrude_scale:Pr(R,1,F),u_intensity:V}};function zs(C,R){var F=Math.pow(2,R.canonical.z),V=R.canonical.y;return[new e.MercatorCoordinate(0,V/F).toLngLat().lat,new e.MercatorCoordinate(0,(V+1)/F).toLngLat().lat]}var Ho=function(C,R,F){var V=C.transform;return{u_matrix:ot(C,R,F),u_ratio:1/Pr(R,1,V.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/V.pixelsToGLUnits[0],1/V.pixelsToGLUnits[1]]}},qa=function(C,R,F){return e.extend(Ho(C,R,F),{u_image:0})},Re=function(C,R,F,V){var ne=C.transform,le=$e(R,ne);return{u_matrix:ot(C,R,F),u_texsize:R.imageAtlasTexture.size,u_ratio:1/Pr(R,1,ne.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[le,V.fromScale,V.toScale],u_fade:V.t,u_units_to_pixels:[1/ne.pixelsToGLUnits[0],1/ne.pixelsToGLUnits[1]]}},Ve=function(C,R,F,V,ne){var le=C.transform,pe=C.lineAtlas,ye=$e(R,le),Te=F.layout.get("line-cap")==="round",Ne=pe.getDash(V.from,Te),Ge=pe.getDash(V.to,Te),nt=Ne.width*ne.fromScale,bt=Ge.width*ne.toScale;return e.extend(Ho(C,R,F),{u_patternscale_a:[ye/nt,-Ne.height/2],u_patternscale_b:[ye/bt,-Ge.height/2],u_sdfgamma:pe.width/(256*Math.min(nt,bt)*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ne.y,u_tex_y_b:Ge.y,u_mix:ne.t})};function $e(C,R){return 1/Pr(C,1,R.tileZoom)}function ot(C,R,F){return C.translatePosMatrix(R.tileID.posMatrix,R,F.paint.get("line-translate"),F.paint.get("line-translate-anchor"))}var mt=function(C,R,F,V,ne){return{u_matrix:C,u_tl_parent:R,u_scale_parent:F,u_buffer_scale:1,u_fade_t:V.mix,u_opacity:V.opacity*ne.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:ne.paint.get("raster-brightness-min"),u_brightness_high:ne.paint.get("raster-brightness-max"),u_saturation_factor:(pe=ne.paint.get("raster-saturation"),pe>0?1-1/(1.001-pe):-pe),u_contrast_factor:(le=ne.paint.get("raster-contrast"),le>0?1/(1-le):1+le),u_spin_weights:dt(ne.paint.get("raster-hue-rotate"))};var le,pe};function dt(C){C*=Math.PI/180;var R=Math.sin(C),F=Math.cos(C);return[(2*F+1)/3,(-Math.sqrt(3)*R-F+1)/3,(Math.sqrt(3)*R-F+1)/3]}var Et,Zt=function(C,R,F,V,ne,le,pe,ye,Te,Ne){var Ge=ne.transform;return{u_is_size_zoom_constant:+(C==="constant"||C==="source"),u_is_size_feature_constant:+(C==="constant"||C==="camera"),u_size_t:R?R.uSizeT:0,u_size:R?R.uSize:0,u_camera_to_center_distance:Ge.cameraToCenterDistance,u_pitch:Ge.pitch/360*2*Math.PI,u_rotate_symbol:+F,u_aspect_ratio:Ge.width/Ge.height,u_fade_change:ne.options.fadeDuration?ne.symbolFadeChange:1,u_matrix:le,u_label_plane_matrix:pe,u_coord_matrix:ye,u_is_text:+Te,u_pitch_with_map:+V,u_texsize:Ne,u_texture:0}},$t=function(C,R,F,V,ne,le,pe,ye,Te,Ne,Ge){var nt=ne.transform;return e.extend(Zt(C,R,F,V,ne,le,pe,ye,Te,Ne),{u_gamma_scale:V?Math.cos(nt._pitch)*nt.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+Ge})},Yt=function(C,R,F,V,ne,le,pe,ye,Te,Ne){return e.extend($t(C,R,F,V,ne,le,pe,ye,!0,Te,!0),{u_texsize_icon:Ne,u_texture_icon:1})},nr=function(C,R,F){return{u_matrix:C,u_opacity:R,u_color:F}},cr=function(C,R,F,V,ne,le){return e.extend(function(pe,ye,Te,Ne){var Ge=Te.imageManager.getPattern(pe.from.toString()),nt=Te.imageManager.getPattern(pe.to.toString()),bt=Te.imageManager.getPixelSize(),Ct=bt.width,Tt=bt.height,At=Math.pow(2,Ne.tileID.overscaledZ),yt=Ne.tileSize*Math.pow(2,Te.transform.tileZoom)/At,Ft=yt*(Ne.tileID.canonical.x+Ne.tileID.wrap*At),zt=yt*Ne.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Ge.tl,u_pattern_br_a:Ge.br,u_pattern_tl_b:nt.tl,u_pattern_br_b:nt.br,u_texsize:[Ct,Tt],u_mix:ye.t,u_pattern_size_a:Ge.displaySize,u_pattern_size_b:nt.displaySize,u_scale_a:ye.fromScale,u_scale_b:ye.toScale,u_tile_units_to_pixels:1/Pr(Ne,1,Te.transform.tileZoom),u_pixel_coord_upper:[Ft>>16,zt>>16],u_pixel_coord_lower:[65535&Ft,65535&zt]}}(V,le,F,ne),{u_matrix:C,u_opacity:R})},mr={fillExtrusion:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_lightpos:new e.Uniform3f(C,R.u_lightpos),u_lightintensity:new e.Uniform1f(C,R.u_lightintensity),u_lightcolor:new e.Uniform3f(C,R.u_lightcolor),u_vertical_gradient:new e.Uniform1f(C,R.u_vertical_gradient),u_opacity:new e.Uniform1f(C,R.u_opacity)}},fillExtrusionPattern:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_lightpos:new e.Uniform3f(C,R.u_lightpos),u_lightintensity:new e.Uniform1f(C,R.u_lightintensity),u_lightcolor:new e.Uniform3f(C,R.u_lightcolor),u_vertical_gradient:new e.Uniform1f(C,R.u_vertical_gradient),u_height_factor:new e.Uniform1f(C,R.u_height_factor),u_image:new e.Uniform1i(C,R.u_image),u_texsize:new e.Uniform2f(C,R.u_texsize),u_pixel_coord_upper:new e.Uniform2f(C,R.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,R.u_pixel_coord_lower),u_scale:new e.Uniform3f(C,R.u_scale),u_fade:new e.Uniform1f(C,R.u_fade),u_opacity:new e.Uniform1f(C,R.u_opacity)}},fill:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix)}},fillPattern:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_image:new e.Uniform1i(C,R.u_image),u_texsize:new e.Uniform2f(C,R.u_texsize),u_pixel_coord_upper:new e.Uniform2f(C,R.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,R.u_pixel_coord_lower),u_scale:new e.Uniform3f(C,R.u_scale),u_fade:new e.Uniform1f(C,R.u_fade)}},fillOutline:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_world:new e.Uniform2f(C,R.u_world)}},fillOutlinePattern:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_world:new e.Uniform2f(C,R.u_world),u_image:new e.Uniform1i(C,R.u_image),u_texsize:new e.Uniform2f(C,R.u_texsize),u_pixel_coord_upper:new e.Uniform2f(C,R.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,R.u_pixel_coord_lower),u_scale:new e.Uniform3f(C,R.u_scale),u_fade:new e.Uniform1f(C,R.u_fade)}},circle:function(C,R){return{u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(C,R.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(C,R.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(C,R.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(C,R.u_matrix)}},collisionBox:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(C,R.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(C,R.u_extrude_scale),u_overscale_factor:new e.Uniform1f(C,R.u_overscale_factor)}},collisionCircle:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_inv_matrix:new e.UniformMatrix4f(C,R.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(C,R.u_viewport_size)}},debug:function(C,R){return{u_color:new e.UniformColor(C,R.u_color),u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_overlay:new e.Uniform1i(C,R.u_overlay),u_overlay_scale:new e.Uniform1f(C,R.u_overlay_scale)}},clippingMask:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix)}},heatmap:function(C,R){return{u_extrude_scale:new e.Uniform1f(C,R.u_extrude_scale),u_intensity:new e.Uniform1f(C,R.u_intensity),u_matrix:new e.UniformMatrix4f(C,R.u_matrix)}},heatmapTexture:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_world:new e.Uniform2f(C,R.u_world),u_image:new e.Uniform1i(C,R.u_image),u_color_ramp:new e.Uniform1i(C,R.u_color_ramp),u_opacity:new e.Uniform1f(C,R.u_opacity)}},hillshade:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_image:new e.Uniform1i(C,R.u_image),u_latrange:new e.Uniform2f(C,R.u_latrange),u_light:new e.Uniform2f(C,R.u_light),u_shadow:new e.UniformColor(C,R.u_shadow),u_highlight:new e.UniformColor(C,R.u_highlight),u_accent:new e.UniformColor(C,R.u_accent)}},hillshadePrepare:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_image:new e.Uniform1i(C,R.u_image),u_dimension:new e.Uniform2f(C,R.u_dimension),u_zoom:new e.Uniform1f(C,R.u_zoom),u_maxzoom:new e.Uniform1f(C,R.u_maxzoom),u_unpack:new e.Uniform4f(C,R.u_unpack)}},line:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_ratio:new e.Uniform1f(C,R.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(C,R.u_units_to_pixels)}},lineGradient:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_ratio:new e.Uniform1f(C,R.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(C,R.u_units_to_pixels),u_image:new e.Uniform1i(C,R.u_image)}},linePattern:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_texsize:new e.Uniform2f(C,R.u_texsize),u_ratio:new e.Uniform1f(C,R.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_image:new e.Uniform1i(C,R.u_image),u_units_to_pixels:new e.Uniform2f(C,R.u_units_to_pixels),u_scale:new e.Uniform3f(C,R.u_scale),u_fade:new e.Uniform1f(C,R.u_fade)}},lineSDF:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_ratio:new e.Uniform1f(C,R.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(C,R.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(C,R.u_patternscale_a),u_patternscale_b:new e.Uniform2f(C,R.u_patternscale_b),u_sdfgamma:new e.Uniform1f(C,R.u_sdfgamma),u_image:new e.Uniform1i(C,R.u_image),u_tex_y_a:new e.Uniform1f(C,R.u_tex_y_a),u_tex_y_b:new e.Uniform1f(C,R.u_tex_y_b),u_mix:new e.Uniform1f(C,R.u_mix)}},raster:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_tl_parent:new e.Uniform2f(C,R.u_tl_parent),u_scale_parent:new e.Uniform1f(C,R.u_scale_parent),u_buffer_scale:new e.Uniform1f(C,R.u_buffer_scale),u_fade_t:new e.Uniform1f(C,R.u_fade_t),u_opacity:new e.Uniform1f(C,R.u_opacity),u_image0:new e.Uniform1i(C,R.u_image0),u_image1:new e.Uniform1i(C,R.u_image1),u_brightness_low:new e.Uniform1f(C,R.u_brightness_low),u_brightness_high:new e.Uniform1f(C,R.u_brightness_high),u_saturation_factor:new e.Uniform1f(C,R.u_saturation_factor),u_contrast_factor:new e.Uniform1f(C,R.u_contrast_factor),u_spin_weights:new e.Uniform3f(C,R.u_spin_weights)}},symbolIcon:function(C,R){return{u_is_size_zoom_constant:new e.Uniform1i(C,R.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(C,R.u_is_size_feature_constant),u_size_t:new e.Uniform1f(C,R.u_size_t),u_size:new e.Uniform1f(C,R.u_size),u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_pitch:new e.Uniform1f(C,R.u_pitch),u_rotate_symbol:new e.Uniform1i(C,R.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(C,R.u_aspect_ratio),u_fade_change:new e.Uniform1f(C,R.u_fade_change),u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(C,R.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(C,R.u_coord_matrix),u_is_text:new e.Uniform1i(C,R.u_is_text),u_pitch_with_map:new e.Uniform1i(C,R.u_pitch_with_map),u_texsize:new e.Uniform2f(C,R.u_texsize),u_texture:new e.Uniform1i(C,R.u_texture)}},symbolSDF:function(C,R){return{u_is_size_zoom_constant:new e.Uniform1i(C,R.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(C,R.u_is_size_feature_constant),u_size_t:new e.Uniform1f(C,R.u_size_t),u_size:new e.Uniform1f(C,R.u_size),u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_pitch:new e.Uniform1f(C,R.u_pitch),u_rotate_symbol:new e.Uniform1i(C,R.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(C,R.u_aspect_ratio),u_fade_change:new e.Uniform1f(C,R.u_fade_change),u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(C,R.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(C,R.u_coord_matrix),u_is_text:new e.Uniform1i(C,R.u_is_text),u_pitch_with_map:new e.Uniform1i(C,R.u_pitch_with_map),u_texsize:new e.Uniform2f(C,R.u_texsize),u_texture:new e.Uniform1i(C,R.u_texture),u_gamma_scale:new e.Uniform1f(C,R.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(C,R.u_is_halo)}},symbolTextAndIcon:function(C,R){return{u_is_size_zoom_constant:new e.Uniform1i(C,R.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(C,R.u_is_size_feature_constant),u_size_t:new e.Uniform1f(C,R.u_size_t),u_size:new e.Uniform1f(C,R.u_size),u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_pitch:new e.Uniform1f(C,R.u_pitch),u_rotate_symbol:new e.Uniform1i(C,R.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(C,R.u_aspect_ratio),u_fade_change:new e.Uniform1f(C,R.u_fade_change),u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(C,R.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(C,R.u_coord_matrix),u_is_text:new e.Uniform1i(C,R.u_is_text),u_pitch_with_map:new e.Uniform1i(C,R.u_pitch_with_map),u_texsize:new e.Uniform2f(C,R.u_texsize),u_texsize_icon:new e.Uniform2f(C,R.u_texsize_icon),u_texture:new e.Uniform1i(C,R.u_texture),u_texture_icon:new e.Uniform1i(C,R.u_texture_icon),u_gamma_scale:new e.Uniform1f(C,R.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(C,R.u_is_halo)}},background:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_opacity:new e.Uniform1f(C,R.u_opacity),u_color:new e.UniformColor(C,R.u_color)}},backgroundPattern:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_opacity:new e.Uniform1f(C,R.u_opacity),u_image:new e.Uniform1i(C,R.u_image),u_pattern_tl_a:new e.Uniform2f(C,R.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(C,R.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(C,R.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(C,R.u_pattern_br_b),u_texsize:new e.Uniform2f(C,R.u_texsize),u_mix:new e.Uniform1f(C,R.u_mix),u_pattern_size_a:new e.Uniform2f(C,R.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(C,R.u_pattern_size_b),u_scale_a:new e.Uniform1f(C,R.u_scale_a),u_scale_b:new e.Uniform1f(C,R.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(C,R.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,R.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(C,R.u_tile_units_to_pixels)}}};function yr(C,R,F,V,ne,le,pe){for(var ye=C.context,Te=ye.gl,Ne=C.useProgram("collisionBox"),Ge=[],nt=0,bt=0,Ct=0;Ct<V.length;Ct++){var Tt=V[Ct],At=R.getTile(Tt),yt=At.getBucket(F);if(yt){var Ft=Tt.posMatrix;ne[0]===0&&ne[1]===0||(Ft=C.translatePosMatrix(Tt.posMatrix,At,ne,le));var zt=pe?yt.textCollisionBox:yt.iconCollisionBox,jt=yt.collisionCircleArray;if(jt.length>0){var rr=e.create(),hr=Ft;e.mul(rr,yt.placementInvProjMatrix,C.transform.glCoordMatrix),e.mul(rr,rr,yt.placementViewportMatrix),Ge.push({circleArray:jt,circleOffset:bt,transform:hr,invTransform:rr}),bt=nt+=jt.length/4}zt&&Ne.draw(ye,Te.LINES,Ke.disabled,_e.disabled,C.colorModeForRenderPass(),Le.disabled,vs(Ft,C.transform,At),F.id,zt.layoutVertexBuffer,zt.indexBuffer,zt.segments,null,C.transform.zoom,null,null,zt.collisionVertexBuffer)}}if(pe&&Ge.length){var Ar=C.useProgram("collisionCircle"),kr=new e.StructArrayLayout2f1f2i16;kr.resize(4*nt),kr._trim();for(var Kr=0,Zr=0,hn=Ge;Zr<hn.length;Zr+=1)for(var sn=hn[Zr],Un=0;Un<sn.circleArray.length/4;Un++){var Wn=4*Un,ua=sn.circleArray[Wn+0],Ur=sn.circleArray[Wn+1],kn=sn.circleArray[Wn+2],Xn=sn.circleArray[Wn+3];kr.emplace(Kr++,ua,Ur,kn,Xn,0),kr.emplace(Kr++,ua,Ur,kn,Xn,1),kr.emplace(Kr++,ua,Ur,kn,Xn,2),kr.emplace(Kr++,ua,Ur,kn,Xn,3)}(!Et||Et.length<2*nt)&&(Et=function(ma){var La=2*ma,ba=new e.StructArrayLayout3ui6;ba.resize(La),ba._trim();for(var Pa=0;Pa<La;Pa++){var Ua=6*Pa;ba.uint16[Ua+0]=4*Pa+0,ba.uint16[Ua+1]=4*Pa+1,ba.uint16[Ua+2]=4*Pa+2,ba.uint16[Ua+3]=4*Pa+2,ba.uint16[Ua+4]=4*Pa+3,ba.uint16[Ua+5]=4*Pa+0}return ba}(nt));for(var Gn=ye.createIndexBuffer(Et,!0),ea=ye.createVertexBuffer(kr,e.collisionCircleLayout.members,!0),fa=0,Ma=Ge;fa<Ma.length;fa+=1){var Kn=Ma[fa],xa=So(Kn.transform,Kn.invTransform,C.transform);Ar.draw(ye,Te.TRIANGLES,Ke.disabled,_e.disabled,C.colorModeForRenderPass(),Le.disabled,xa,F.id,ea,Gn,e.SegmentVector.simpleSegment(0,2*Kn.circleOffset,Kn.circleArray.length,Kn.circleArray.length/2),null,C.transform.zoom,null,null,null)}ea.destroy(),Gn.destroy()}}var Or=e.identity(new Float32Array(16));function nn(C,R,F,V,ne,le){var pe=e.getAnchorAlignment(C),ye=-(pe.horizontalAlign-.5)*R,Te=-(pe.verticalAlign-.5)*F,Ne=e.evaluateVariableOffset(C,V);return new e.Point((ye/ne+Ne[0])*le,(Te/ne+Ne[1])*le)}function gn(C,R,F,V,ne,le,pe,ye,Te,Ne,Ge){var nt=C.text.placedSymbolArray,bt=C.text.dynamicLayoutVertexArray,Ct=C.icon.dynamicLayoutVertexArray,Tt={};bt.clear();for(var At=0;At<nt.length;At++){var yt=nt.get(At),Ft=C.allowVerticalPlacement&&!yt.placedOrientation,zt=yt.hidden||!yt.crossTileID||Ft?null:V[yt.crossTileID];if(zt){var jt=new e.Point(yt.anchorX,yt.anchorY),rr=ur(jt,F?ye:pe),hr=pr(le.cameraToCenterDistance,rr.signedDistanceFromCamera),Ar=ne.evaluateSizeForFeature(C.textSizeData,Ne,yt)*hr/e.ONE_EM;F&&(Ar*=C.tilePixelRatio/Te);for(var kr=zt.width,Kr=zt.height,Zr=nn(zt.anchor,kr,Kr,zt.textOffset,zt.textBoxScale,Ar),hn=F?ur(jt.add(Zr),pe).point:rr.point.add(R?Zr.rotate(-le.angle):Zr),sn=C.allowVerticalPlacement&&yt.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,Un=0;Un<yt.numGlyphs;Un++)e.addDynamicAttributes(bt,hn,sn);Ge&&yt.associatedIconIndex>=0&&(Tt[yt.associatedIconIndex]={shiftedAnchor:hn,angle:sn})}else Sn(yt.numGlyphs,bt)}if(Ge){Ct.clear();for(var Wn=C.icon.placedSymbolArray,ua=0;ua<Wn.length;ua++){var Ur=Wn.get(ua);if(Ur.hidden)Sn(Ur.numGlyphs,Ct);else{var kn=Tt[ua];if(kn)for(var Xn=0;Xn<Ur.numGlyphs;Xn++)e.addDynamicAttributes(Ct,kn.shiftedAnchor,kn.angle);else Sn(Ur.numGlyphs,Ct)}}C.icon.dynamicLayoutVertexBuffer.updateData(Ct)}C.text.dynamicLayoutVertexBuffer.updateData(bt)}function Cn(C,R,F){return F.iconsInText&&R?"symbolTextAndIcon":C?"symbolSDF":"symbolIcon"}function Dn(C,R,F,V,ne,le,pe,ye,Te,Ne,Ge,nt){for(var bt=C.context,Ct=bt.gl,Tt=C.transform,At=ye==="map",yt=Te==="map",Ft=At&&F.layout.get("symbol-placement")!=="point",zt=At&&!yt&&!Ft,jt=F.layout.get("symbol-sort-key").constantOr(1)!==void 0,rr=C.depthModeForSublayer(0,Ke.ReadOnly),hr=F.layout.get("text-variable-anchor"),Ar=[],kr=0,Kr=V;kr<Kr.length;kr+=1){var Zr=Kr[kr],hn=R.getTile(Zr),sn=hn.getBucket(F);if(sn){var Un=ne?sn.text:sn.icon;if(Un&&Un.segments.get().length){var Wn=Un.programConfigurations.get(F.id),ua=ne||sn.sdfIcons,Ur=ne?sn.textSizeData:sn.iconSizeData,kn=yt||Tt.pitch!==0,Xn=C.useProgram(Cn(ua,ne,sn),Wn),Gn=e.evaluateSizeForZoom(Ur,Tt.zoom),ea=void 0,fa=[0,0],Ma=void 0,Kn=void 0,xa=null,ma=void 0;if(ne){if(Ma=hn.glyphAtlasTexture,Kn=Ct.LINEAR,ea=hn.glyphAtlasTexture.size,sn.iconsInText){fa=hn.imageAtlasTexture.size,xa=hn.imageAtlasTexture;var La=Ur.kind==="composite"||Ur.kind==="camera";ma=kn||C.options.rotating||C.options.zooming||La?Ct.LINEAR:Ct.NEAREST}}else{var ba=F.layout.get("icon-size").constantOr(0)!==1||sn.iconsNeedLinear;Ma=hn.imageAtlasTexture,Kn=ua||C.options.rotating||C.options.zooming||ba||kn?Ct.LINEAR:Ct.NEAREST,ea=hn.imageAtlasTexture.size}var Pa=Pr(hn,1,C.transform.zoom),Ua=dr(Zr.posMatrix,yt,At,C.transform,Pa),di=vr(Zr.posMatrix,yt,At,C.transform,Pa),Ri=hr&&sn.hasTextData(),Fi=F.layout.get("icon-text-fit")!=="none"&&Ri&&sn.hasIconData();Ft&&Rr(sn,Zr.posMatrix,C,ne,Ua,di,yt,Ne);var pi=C.translatePosMatrix(Zr.posMatrix,hn,le,pe),Ci=Ft||ne&&hr||Fi?Or:Ua,bi=C.translatePosMatrix(di,hn,le,pe,!0),Lo=ua&&F.paint.get(ne?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Ki={program:Xn,buffers:Un,uniformValues:ua?sn.iconsInText?Yt(Ur.kind,Gn,zt,yt,C,pi,Ci,bi,ea,fa):$t(Ur.kind,Gn,zt,yt,C,pi,Ci,bi,ne,ea,!0):Zt(Ur.kind,Gn,zt,yt,C,pi,Ci,bi,ne,ea),atlasTexture:Ma,atlasTextureIcon:xa,atlasInterpolation:Kn,atlasInterpolationIcon:ma,isSDF:ua,hasHalo:Lo};if(jt)for(var Zo=0,qs=Un.segments.get();Zo<qs.length;Zo+=1){var yl=qs[Zo];Ar.push({segments:new e.SegmentVector([yl]),sortKey:yl.sortKey,state:Ki})}else Ar.push({segments:Un.segments,sortKey:0,state:Ki})}}}jt&&Ar.sort(function($l,_s){return $l.sortKey-_s.sortKey});for(var Jl=0,zl=Ar;Jl<zl.length;Jl+=1){var Rl=zl[Jl],Po=Rl.state;if(bt.activeTexture.set(Ct.TEXTURE0),Po.atlasTexture.bind(Po.atlasInterpolation,Ct.CLAMP_TO_EDGE),Po.atlasTextureIcon&&(bt.activeTexture.set(Ct.TEXTURE1),Po.atlasTextureIcon&&Po.atlasTextureIcon.bind(Po.atlasInterpolationIcon,Ct.CLAMP_TO_EDGE)),Po.isSDF){var Tl=Po.uniformValues;Po.hasHalo&&(Tl.u_is_halo=1,Hn(Po.buffers,Rl.segments,F,C,Po.program,rr,Ge,nt,Tl)),Tl.u_is_halo=0}Hn(Po.buffers,Rl.segments,F,C,Po.program,rr,Ge,nt,Po.uniformValues)}}function Hn(C,R,F,V,ne,le,pe,ye,Te){var Ne=V.context,Ge=Ne.gl;ne.draw(Ne,Ge.TRIANGLES,le,pe,ye,Le.disabled,Te,F.id,C.layoutVertexBuffer,C.indexBuffer,R,F.paint,V.transform.zoom,C.programConfigurations.get(F.id),C.dynamicLayoutVertexBuffer,C.opacityVertexBuffer)}function zn(C,R,F,V,ne,le,pe){var ye,Te,Ne,Ge,nt,bt=C.context.gl,Ct=F.paint.get("fill-pattern"),Tt=Ct&&Ct.constantOr(1),At=F.getCrossfadeParameters();pe?(Te=Tt&&!F.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ye=bt.LINES):(Te=Tt?"fillPattern":"fill",ye=bt.TRIANGLES);for(var yt=0,Ft=V;yt<Ft.length;yt+=1){var zt=Ft[yt],jt=R.getTile(zt);if(!Tt||jt.patternsLoaded()){var rr=jt.getBucket(F);if(rr){var hr=rr.programConfigurations.get(F.id),Ar=C.useProgram(Te,hr);Tt&&(C.context.activeTexture.set(bt.TEXTURE0),jt.imageAtlasTexture.bind(bt.LINEAR,bt.CLAMP_TO_EDGE),hr.updatePaintBuffers(At));var kr=Ct.constantOr(null);if(kr&&jt.imageAtlas){var Kr=jt.imageAtlas,Zr=Kr.patternPositions[kr.to.toString()],hn=Kr.patternPositions[kr.from.toString()];Zr&&hn&&hr.setConstantPatternPositions(Zr,hn)}var sn=C.translatePosMatrix(zt.posMatrix,jt,F.paint.get("fill-translate"),F.paint.get("fill-translate-anchor"));if(pe){Ge=rr.indexBuffer2,nt=rr.segments2;var Un=[bt.drawingBufferWidth,bt.drawingBufferHeight];Ne=Te==="fillOutlinePattern"&&Tt?rs(sn,C,At,jt,Un):ts(sn,Un)}else Ge=rr.indexBuffer,nt=rr.segments,Ne=Tt?Vo(sn,C,At,jt):Uo(sn);Ar.draw(C.context,ye,ne,C.stencilModeForClipping(zt),le,Le.disabled,Ne,F.id,rr.layoutVertexBuffer,Ge,nt,F.paint,C.transform.zoom,hr)}}}}function ga(C,R,F,V,ne,le,pe){for(var ye=C.context,Te=ye.gl,Ne=F.paint.get("fill-extrusion-pattern"),Ge=Ne.constantOr(1),nt=F.getCrossfadeParameters(),bt=F.paint.get("fill-extrusion-opacity"),Ct=0,Tt=V;Ct<Tt.length;Ct+=1){var At=Tt[Ct],yt=R.getTile(At),Ft=yt.getBucket(F);if(Ft){var zt=Ft.programConfigurations.get(F.id),jt=C.useProgram(Ge?"fillExtrusionPattern":"fillExtrusion",zt);Ge&&(C.context.activeTexture.set(Te.TEXTURE0),yt.imageAtlasTexture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE),zt.updatePaintBuffers(nt));var rr=Ne.constantOr(null);if(rr&&yt.imageAtlas){var hr=yt.imageAtlas,Ar=hr.patternPositions[rr.to.toString()],kr=hr.patternPositions[rr.from.toString()];Ar&&kr&&zt.setConstantPatternPositions(Ar,kr)}var Kr=C.translatePosMatrix(At.posMatrix,yt,F.paint.get("fill-extrusion-translate"),F.paint.get("fill-extrusion-translate-anchor")),Zr=F.paint.get("fill-extrusion-vertical-gradient"),hn=Ge?Js(Kr,C,Zr,bt,At,nt,yt):Hs(Kr,C,Zr,bt);jt.draw(ye,ye.gl.TRIANGLES,ne,le,pe,Le.backCCW,hn,F.id,Ft.layoutVertexBuffer,Ft.indexBuffer,Ft.segments,F.paint,C.transform.zoom,zt)}}}function ka(C,R,F,V,ne,le){var pe=C.context,ye=pe.gl,Te=R.fbo;if(Te){var Ne=C.useProgram("hillshade");pe.activeTexture.set(ye.TEXTURE0),ye.bindTexture(ye.TEXTURE_2D,Te.colorAttachment.get());var Ge=function(nt,bt,Ct){var Tt=Ct.paint.get("hillshade-shadow-color"),At=Ct.paint.get("hillshade-highlight-color"),yt=Ct.paint.get("hillshade-accent-color"),Ft=Ct.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ct.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ft-=nt.transform.angle);var zt=!nt.options.moving;return{u_matrix:nt.transform.calculatePosMatrix(bt.tileID.toUnwrapped(),zt),u_image:0,u_latrange:zs(nt,bt.tileID),u_light:[Ct.paint.get("hillshade-exaggeration"),Ft],u_shadow:Tt,u_highlight:At,u_accent:yt}}(C,R,F);Ne.draw(pe,ye.TRIANGLES,V,ne,le,Le.disabled,Ge,F.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments)}}function Ba(C,R,F,V,ne,le,pe){var ye=C.context,Te=ye.gl,Ne=R.dem;if(Ne&&Ne.data){var Ge=Ne.dim,nt=Ne.stride,bt=Ne.getPixels();if(ye.activeTexture.set(Te.TEXTURE1),ye.pixelStoreUnpackPremultiplyAlpha.set(!1),R.demTexture=R.demTexture||C.getTileTexture(nt),R.demTexture){var Ct=R.demTexture;Ct.update(bt,{premultiply:!1}),Ct.bind(Te.NEAREST,Te.CLAMP_TO_EDGE)}else R.demTexture=new e.Texture(ye,bt,Te.RGBA,{premultiply:!1}),R.demTexture.bind(Te.NEAREST,Te.CLAMP_TO_EDGE);ye.activeTexture.set(Te.TEXTURE0);var Tt=R.fbo;if(!Tt){var At=new e.Texture(ye,{width:Ge,height:Ge,data:null},Te.RGBA);At.bind(Te.LINEAR,Te.CLAMP_TO_EDGE),(Tt=R.fbo=ye.createFramebuffer(Ge,Ge,!0)).colorAttachment.set(At.texture)}ye.bindFramebuffer.set(Tt.framebuffer),ye.viewport.set([0,0,Ge,Ge]),C.useProgram("hillshadePrepare").draw(ye,Te.TRIANGLES,ne,le,pe,Le.disabled,function(yt,Ft,zt){var jt=Ft.stride,rr=e.create();return e.ortho(rr,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(rr,rr,[0,-e.EXTENT,0]),{u_matrix:rr,u_image:1,u_dimension:[jt,jt],u_zoom:yt.overscaledZ,u_maxzoom:zt,u_unpack:Ft.getUnpackVector()}}(R.tileID,Ne,V),F.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments),R.needsHillshadePrepare=!1}}function Fa(C,R,F,V,ne){var le=V.paint.get("raster-fade-duration");if(le>0){var pe=e.browser.now(),ye=(pe-C.timeAdded)/le,Te=R?(pe-R.timeAdded)/le:-1,Ne=F.getSource(),Ge=ne.coveringZoomLevel({tileSize:Ne.tileSize,roundZoom:Ne.roundZoom}),nt=!R||Math.abs(R.tileID.overscaledZ-Ge)>Math.abs(C.tileID.overscaledZ-Ge),bt=nt&&C.refreshedUponExpiration?1:e.clamp(nt?ye:1-Te,0,1);return C.refreshedUponExpiration&&ye>=1&&(C.refreshedUponExpiration=!1),R?{opacity:1,mix:1-bt}:{opacity:bt,mix:0}}return{opacity:1,mix:0}}var ja=new e.Color(1,0,0,1),Si=new e.Color(0,1,0,1),Ti=new e.Color(0,0,1,1),ui=new e.Color(1,0,1,1),ci=new e.Color(0,1,1,1);function ki(C){var R=C.transform.padding;Hi(C,C.transform.height-(R.top||0),3,ja),Hi(C,R.bottom||0,3,Si),no(C,R.left||0,3,Ti),no(C,C.transform.width-(R.right||0),3,ui);var F=C.transform.centerPoint;(function(V,ne,le,pe){ao(V,ne-1,le-10,2,20,pe),ao(V,ne-10,le-1,20,2,pe)})(C,F.x,C.transform.height-F.y,ci)}function Hi(C,R,F,V){ao(C,0,R+F/2,C.transform.width,F,V)}function no(C,R,F,V){ao(C,R-F/2,0,F,C.transform.height,V)}function ao(C,R,F,V,ne,le){var pe=C.context,ye=pe.gl;ye.enable(ye.SCISSOR_TEST),ye.scissor(R*e.browser.devicePixelRatio,F*e.browser.devicePixelRatio,V*e.browser.devicePixelRatio,ne*e.browser.devicePixelRatio),pe.clear({color:le}),ye.disable(ye.SCISSOR_TEST)}function io(C,R,F){var V=C.context,ne=V.gl,le=F.posMatrix,pe=C.useProgram("debug"),ye=Ke.disabled,Te=_e.disabled,Ne=C.colorModeForRenderPass();V.activeTexture.set(ne.TEXTURE0),C.emptyTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),pe.draw(V,ne.LINE_STRIP,ye,Te,Ne,Le.disabled,Ds(le,e.Color.red),"$debug",C.debugBuffer,C.tileBorderIndexBuffer,C.debugSegments);var Ge=R.getTileByID(F.key).latestRawTileData,nt=Ge&&Ge.byteLength||0,bt=Math.floor(nt/1024),Ct=R.getTile(F).tileSize,Tt=512/Math.min(Ct,512)*(F.overscaledZ/C.transform.zoom)*.5,At=F.canonical.toString();F.overscaledZ!==F.canonical.z&&(At+=" => "+F.overscaledZ),function(yt,Ft){yt.initDebugOverlayCanvas();var zt=yt.debugOverlayCanvas,jt=yt.context.gl,rr=yt.debugOverlayCanvas.getContext("2d");rr.clearRect(0,0,zt.width,zt.height),rr.shadowColor="white",rr.shadowBlur=2,rr.lineWidth=1.5,rr.strokeStyle="white",rr.textBaseline="top",rr.font="bold 36px Open Sans, sans-serif",rr.fillText(Ft,5,5),rr.strokeText(Ft,5,5),yt.debugOverlayTexture.update(zt),yt.debugOverlayTexture.bind(jt.LINEAR,jt.CLAMP_TO_EDGE)}(C,At+" "+bt+"kb"),pe.draw(V,ne.TRIANGLES,ye,Te,Ce.alphaBlended,Le.disabled,Ds(le,e.Color.transparent,Tt),"$debug",C.debugBuffer,C.quadTriangleIndexBuffer,C.debugSegments)}var oo={symbol:function(C,R,F,V,ne){if(C.renderPass==="translucent"){var le=_e.disabled,pe=C.colorModeForRenderPass();F.layout.get("text-variable-anchor")&&function(ye,Te,Ne,Ge,nt,bt,Ct){for(var Tt=Te.transform,At=nt==="map",yt=bt==="map",Ft=0,zt=ye;Ft<zt.length;Ft+=1){var jt=zt[Ft],rr=Ge.getTile(jt),hr=rr.getBucket(Ne);if(hr&&hr.text&&hr.text.segments.get().length){var Ar=hr.textSizeData,kr=e.evaluateSizeForZoom(Ar,Tt.zoom),Kr=Pr(rr,1,Te.transform.zoom),Zr=dr(jt.posMatrix,yt,At,Te.transform,Kr),hn=Ne.layout.get("icon-text-fit")!=="none"&&hr.hasIconData();if(kr){var sn=Math.pow(2,Tt.zoom-rr.tileID.overscaledZ);gn(hr,At,yt,Ct,e.symbolSize,Tt,Zr,jt.posMatrix,sn,kr,hn)}}}}(V,C,F,R,F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),ne),F.paint.get("icon-opacity").constantOr(1)!==0&&Dn(C,R,F,V,!1,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),F.layout.get("icon-rotation-alignment"),F.layout.get("icon-pitch-alignment"),F.layout.get("icon-keep-upright"),le,pe),F.paint.get("text-opacity").constantOr(1)!==0&&Dn(C,R,F,V,!0,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.layout.get("text-keep-upright"),le,pe),R.map.showCollisionBoxes&&(yr(C,R,F,V,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),!0),yr(C,R,F,V,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),!1))}},circle:function(C,R,F,V){if(C.renderPass==="translucent"){var ne=F.paint.get("circle-opacity"),le=F.paint.get("circle-stroke-width"),pe=F.paint.get("circle-stroke-opacity"),ye=F.layout.get("circle-sort-key").constantOr(1)!==void 0;if(ne.constantOr(1)!==0||le.constantOr(1)!==0&&pe.constantOr(1)!==0){for(var Te=C.context,Ne=Te.gl,Ge=C.depthModeForSublayer(0,Ke.ReadOnly),nt=_e.disabled,bt=C.colorModeForRenderPass(),Ct=[],Tt=0;Tt<V.length;Tt++){var At=V[Tt],yt=R.getTile(At),Ft=yt.getBucket(F);if(Ft){var zt=Ft.programConfigurations.get(F.id),jt={programConfiguration:zt,program:C.useProgram("circle",zt),layoutVertexBuffer:Ft.layoutVertexBuffer,indexBuffer:Ft.indexBuffer,uniformValues:ns(C,At,yt,F)};if(ye)for(var rr=0,hr=Ft.segments.get();rr<hr.length;rr+=1){var Ar=hr[rr];Ct.push({segments:new e.SegmentVector([Ar]),sortKey:Ar.sortKey,state:jt})}else Ct.push({segments:Ft.segments,sortKey:0,state:jt})}}ye&&Ct.sort(function(Xn,Gn){return Xn.sortKey-Gn.sortKey});for(var kr=0,Kr=Ct;kr<Kr.length;kr+=1){var Zr=Kr[kr],hn=Zr.state,sn=hn.programConfiguration,Un=hn.program,Wn=hn.layoutVertexBuffer,ua=hn.indexBuffer,Ur=hn.uniformValues,kn=Zr.segments;Un.draw(Te,Ne.TRIANGLES,Ge,nt,bt,Le.disabled,Ur,F.id,Wn,ua,kn,F.paint,C.transform.zoom,sn)}}}},heatmap:function(C,R,F,V){if(F.paint.get("heatmap-opacity")!==0)if(C.renderPass==="offscreen"){var ne=C.context,le=ne.gl,pe=_e.disabled,ye=new Ce([le.ONE,le.ONE],e.Color.transparent,[!0,!0,!0,!0]);(function(At,yt,Ft){var zt=At.gl;At.activeTexture.set(zt.TEXTURE1),At.viewport.set([0,0,yt.width/4,yt.height/4]);var jt=Ft.heatmapFbo;if(jt)zt.bindTexture(zt.TEXTURE_2D,jt.colorAttachment.get()),At.bindFramebuffer.set(jt.framebuffer);else{var rr=zt.createTexture();zt.bindTexture(zt.TEXTURE_2D,rr),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_WRAP_S,zt.CLAMP_TO_EDGE),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_WRAP_T,zt.CLAMP_TO_EDGE),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_MIN_FILTER,zt.LINEAR),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_MAG_FILTER,zt.LINEAR),jt=Ft.heatmapFbo=At.createFramebuffer(yt.width/4,yt.height/4,!1),function(hr,Ar,kr,Kr){var Zr=hr.gl,hn=hr.extRenderToTextureHalfFloat?hr.extTextureHalfFloat.HALF_FLOAT_OES:Zr.UNSIGNED_BYTE;Zr.texImage2D(Zr.TEXTURE_2D,0,Zr.RGBA,Ar.width/4,Ar.height/4,0,Zr.RGBA,hn,null),Kr.colorAttachment.set(kr)}(At,yt,rr,jt)}})(ne,C,F),ne.clear({color:e.Color.transparent});for(var Te=0;Te<V.length;Te++){var Ne=V[Te];if(!R.hasRenderableParent(Ne)){var Ge=R.getTile(Ne),nt=Ge.getBucket(F);if(nt){var bt=nt.programConfigurations.get(F.id),Ct=C.useProgram("heatmap",bt),Tt=C.transform.zoom;Ct.draw(ne,le.TRIANGLES,Ke.disabled,pe,ye,Le.disabled,as(Ne.posMatrix,Ge,Tt,F.paint.get("heatmap-intensity")),F.id,nt.layoutVertexBuffer,nt.indexBuffer,nt.segments,F.paint,C.transform.zoom,bt)}}}ne.viewport.set([0,0,C.width,C.height])}else C.renderPass==="translucent"&&(C.context.setColorMode(C.colorModeForRenderPass()),function(At,yt){var Ft=At.context,zt=Ft.gl,jt=yt.heatmapFbo;if(!!jt){Ft.activeTexture.set(zt.TEXTURE0),zt.bindTexture(zt.TEXTURE_2D,jt.colorAttachment.get()),Ft.activeTexture.set(zt.TEXTURE1);var rr=yt.colorRampTexture;rr||(rr=yt.colorRampTexture=new e.Texture(Ft,yt.colorRamp,zt.RGBA)),rr.bind(zt.LINEAR,zt.CLAMP_TO_EDGE),At.useProgram("heatmapTexture").draw(Ft,zt.TRIANGLES,Ke.disabled,_e.disabled,At.colorModeForRenderPass(),Le.disabled,function(hr,Ar,kr,Kr){var Zr=e.create();e.ortho(Zr,0,hr.width,hr.height,0,0,1);var hn=hr.context.gl;return{u_matrix:Zr,u_world:[hn.drawingBufferWidth,hn.drawingBufferHeight],u_image:kr,u_color_ramp:Kr,u_opacity:Ar.paint.get("heatmap-opacity")}}(At,yt,0,1),yt.id,At.viewportBuffer,At.quadTriangleIndexBuffer,At.viewportSegments,yt.paint,At.transform.zoom)}}(C,F))},line:function(C,R,F,V){if(C.renderPass==="translucent"){var ne=F.paint.get("line-opacity"),le=F.paint.get("line-width");if(ne.constantOr(1)!==0&&le.constantOr(1)!==0){var pe=C.depthModeForSublayer(0,Ke.ReadOnly),ye=C.colorModeForRenderPass(),Te=F.paint.get("line-dasharray"),Ne=F.paint.get("line-pattern"),Ge=Ne.constantOr(1),nt=F.paint.get("line-gradient"),bt=F.getCrossfadeParameters(),Ct=Ge?"linePattern":Te?"lineSDF":nt?"lineGradient":"line",Tt=C.context,At=Tt.gl,yt=!0;if(nt){Tt.activeTexture.set(At.TEXTURE0);var Ft=F.gradientTexture;if(!F.gradient)return;Ft||(Ft=F.gradientTexture=new e.Texture(Tt,F.gradient,At.RGBA)),Ft.bind(At.LINEAR,At.CLAMP_TO_EDGE)}for(var zt=0,jt=V;zt<jt.length;zt+=1){var rr=jt[zt],hr=R.getTile(rr);if(!Ge||hr.patternsLoaded()){var Ar=hr.getBucket(F);if(Ar){var kr=Ar.programConfigurations.get(F.id),Kr=C.context.program.get(),Zr=C.useProgram(Ct,kr),hn=yt||Zr.program!==Kr,sn=Ne.constantOr(null);if(sn&&hr.imageAtlas){var Un=hr.imageAtlas,Wn=Un.patternPositions[sn.to.toString()],ua=Un.patternPositions[sn.from.toString()];Wn&&ua&&kr.setConstantPatternPositions(Wn,ua)}var Ur=Ge?Re(C,hr,F,bt):Te?Ve(C,hr,F,Te,bt):nt?qa(C,hr,F):Ho(C,hr,F);Ge?(Tt.activeTexture.set(At.TEXTURE0),hr.imageAtlasTexture.bind(At.LINEAR,At.CLAMP_TO_EDGE),kr.updatePaintBuffers(bt)):Te&&(hn||C.lineAtlas.dirty)&&(Tt.activeTexture.set(At.TEXTURE0),C.lineAtlas.bind(Tt)),Zr.draw(Tt,At.TRIANGLES,pe,C.stencilModeForClipping(rr),ye,Le.disabled,Ur,F.id,Ar.layoutVertexBuffer,Ar.indexBuffer,Ar.segments,F.paint,C.transform.zoom,kr),yt=!1}}}}}},fill:function(C,R,F,V){var ne=F.paint.get("fill-color"),le=F.paint.get("fill-opacity");if(le.constantOr(1)!==0){var pe=C.colorModeForRenderPass(),ye=F.paint.get("fill-pattern"),Te=C.opaquePassEnabledForLayer()&&!ye.constantOr(1)&&ne.constantOr(e.Color.transparent).a===1&&le.constantOr(0)===1?"opaque":"translucent";if(C.renderPass===Te){var Ne=C.depthModeForSublayer(1,C.renderPass==="opaque"?Ke.ReadWrite:Ke.ReadOnly);zn(C,R,F,V,Ne,pe,!1)}if(C.renderPass==="translucent"&&F.paint.get("fill-antialias")){var Ge=C.depthModeForSublayer(F.getPaintProperty("fill-outline-color")?2:0,Ke.ReadOnly);zn(C,R,F,V,Ge,pe,!0)}}},"fill-extrusion":function(C,R,F,V){var ne=F.paint.get("fill-extrusion-opacity");if(ne!==0&&C.renderPass==="translucent"){var le=new Ke(C.context.gl.LEQUAL,Ke.ReadWrite,C.depthRangeFor3D);if(ne!==1||F.paint.get("fill-extrusion-pattern").constantOr(1))ga(C,R,F,V,le,_e.disabled,Ce.disabled),ga(C,R,F,V,le,C.stencilModeFor3D(),C.colorModeForRenderPass());else{var pe=C.colorModeForRenderPass();ga(C,R,F,V,le,_e.disabled,pe)}}},hillshade:function(C,R,F,V){if(C.renderPass==="offscreen"||C.renderPass==="translucent"){for(var ne=C.context,le=R.getSource().maxzoom,pe=C.depthModeForSublayer(0,Ke.ReadOnly),ye=C.colorModeForRenderPass(),Te=C.renderPass==="translucent"?C.stencilConfigForOverlap(V):[{},V],Ne=Te[0],Ge=0,nt=Te[1];Ge<nt.length;Ge+=1){var bt=nt[Ge],Ct=R.getTile(bt);Ct.needsHillshadePrepare&&C.renderPass==="offscreen"?Ba(C,Ct,F,le,pe,_e.disabled,ye):C.renderPass==="translucent"&&ka(C,Ct,F,pe,Ne[bt.overscaledZ],ye)}ne.viewport.set([0,0,C.width,C.height])}},raster:function(C,R,F,V){if(C.renderPass==="translucent"&&F.paint.get("raster-opacity")!==0&&V.length)for(var ne=C.context,le=ne.gl,pe=R.getSource(),ye=C.useProgram("raster"),Te=C.colorModeForRenderPass(),Ne=pe instanceof H?[{},V]:C.stencilConfigForOverlap(V),Ge=Ne[0],nt=Ne[1],bt=nt[nt.length-1].overscaledZ,Ct=!C.options.moving,Tt=0,At=nt;Tt<At.length;Tt+=1){var yt=At[Tt],Ft=C.depthModeForSublayer(yt.overscaledZ-bt,F.paint.get("raster-opacity")===1?Ke.ReadWrite:Ke.ReadOnly,le.LESS),zt=R.getTile(yt),jt=C.transform.calculatePosMatrix(yt.toUnwrapped(),Ct);zt.registerFadeDuration(F.paint.get("raster-fade-duration"));var rr=R.findLoadedParent(yt,0),hr=Fa(zt,rr,R,F,C.transform),Ar=void 0,kr=void 0,Kr=F.paint.get("raster-resampling")==="nearest"?le.NEAREST:le.LINEAR;ne.activeTexture.set(le.TEXTURE0),zt.texture.bind(Kr,le.CLAMP_TO_EDGE,le.LINEAR_MIPMAP_NEAREST),ne.activeTexture.set(le.TEXTURE1),rr?(rr.texture.bind(Kr,le.CLAMP_TO_EDGE,le.LINEAR_MIPMAP_NEAREST),Ar=Math.pow(2,rr.tileID.overscaledZ-zt.tileID.overscaledZ),kr=[zt.tileID.canonical.x*Ar%1,zt.tileID.canonical.y*Ar%1]):zt.texture.bind(Kr,le.CLAMP_TO_EDGE,le.LINEAR_MIPMAP_NEAREST);var Zr=mt(jt,kr||[0,0],Ar||1,hr,F);pe instanceof H?ye.draw(ne,le.TRIANGLES,Ft,_e.disabled,Te,Le.disabled,Zr,F.id,pe.boundsBuffer,C.quadTriangleIndexBuffer,pe.boundsSegments):ye.draw(ne,le.TRIANGLES,Ft,Ge[yt.overscaledZ],Te,Le.disabled,Zr,F.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments)}},background:function(C,R,F){var V=F.paint.get("background-color"),ne=F.paint.get("background-opacity");if(ne!==0){var le=C.context,pe=le.gl,ye=C.transform,Te=ye.tileSize,Ne=F.paint.get("background-pattern");if(!C.isPatternMissing(Ne)){var Ge=!Ne&&V.a===1&&ne===1&&C.opaquePassEnabledForLayer()?"opaque":"translucent";if(C.renderPass===Ge){var nt=_e.disabled,bt=C.depthModeForSublayer(0,Ge==="opaque"?Ke.ReadWrite:Ke.ReadOnly),Ct=C.colorModeForRenderPass(),Tt=C.useProgram(Ne?"backgroundPattern":"background"),At=ye.coveringTiles({tileSize:Te});Ne&&(le.activeTexture.set(pe.TEXTURE0),C.imageManager.bind(C.context));for(var yt=F.getCrossfadeParameters(),Ft=0,zt=At;Ft<zt.length;Ft+=1){var jt=zt[Ft],rr=C.transform.calculatePosMatrix(jt.toUnwrapped()),hr=Ne?cr(rr,ne,C,Ne,{tileID:jt,tileSize:Te},yt):nr(rr,ne,V);Tt.draw(le,pe.TRIANGLES,bt,nt,Ct,Le.disabled,hr,F.id,C.tileExtentBuffer,C.quadTriangleIndexBuffer,C.tileExtentSegments)}}}}},debug:function(C,R,F){for(var V=0;V<F.length;V++)io(C,R,F[V])},custom:function(C,R,F){var V=C.context,ne=F.implementation;if(C.renderPass==="offscreen"){var le=ne.prerender;le&&(C.setCustomLayerDefaults(),V.setColorMode(C.colorModeForRenderPass()),le.call(ne,V.gl,C.transform.customLayerMatrix()),V.setDirty(),C.setBaseState())}else if(C.renderPass==="translucent"){C.setCustomLayerDefaults(),V.setColorMode(C.colorModeForRenderPass()),V.setStencilMode(_e.disabled);var pe=ne.renderingMode==="3d"?new Ke(C.context.gl.LEQUAL,Ke.ReadWrite,C.depthRangeFor3D):C.depthModeForSublayer(0,Ke.ReadOnly);V.setDepthMode(pe),ne.render(V.gl,C.transform.customLayerMatrix()),V.setDirty(),C.setBaseState(),V.bindFramebuffer.set(null)}}},Oa=function(C,R){this.context=new Pe(C),this.transform=R,this._tileTextures={},this.setup(),this.numSublayers=Xe.maxUnderzooming+Xe.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Wr,this.gpuTimers={}};Oa.prototype.resize=function(C,R){if(this.width=C*e.browser.devicePixelRatio,this.height=R*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var F=0,V=this.style._order;F<V.length;F+=1){var ne=V[F];this.style._layers[ne].resize()}},Oa.prototype.setup=function(){var C=this.context,R=new e.StructArrayLayout2i4;R.emplaceBack(0,0),R.emplaceBack(e.EXTENT,0),R.emplaceBack(0,e.EXTENT),R.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=C.createVertexBuffer(R,yn.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var F=new e.StructArrayLayout2i4;F.emplaceBack(0,0),F.emplaceBack(e.EXTENT,0),F.emplaceBack(0,e.EXTENT),F.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=C.createVertexBuffer(F,yn.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var V=new e.StructArrayLayout4i8;V.emplaceBack(0,0,0,0),V.emplaceBack(e.EXTENT,0,e.EXTENT,0),V.emplaceBack(0,e.EXTENT,0,e.EXTENT),V.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=C.createVertexBuffer(V,Z.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var ne=new e.StructArrayLayout2i4;ne.emplaceBack(0,0),ne.emplaceBack(1,0),ne.emplaceBack(0,1),ne.emplaceBack(1,1),this.viewportBuffer=C.createVertexBuffer(ne,yn.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var le=new e.StructArrayLayout1ui2;le.emplaceBack(0),le.emplaceBack(1),le.emplaceBack(3),le.emplaceBack(2),le.emplaceBack(0),this.tileBorderIndexBuffer=C.createIndexBuffer(le);var pe=new e.StructArrayLayout3ui6;pe.emplaceBack(0,1,2),pe.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=C.createIndexBuffer(pe),this.emptyTexture=new e.Texture(C,{width:1,height:1,data:new Uint8Array([0,0,0,0])},C.gl.RGBA);var ye=this.context.gl;this.stencilClearMode=new _e({func:ye.ALWAYS,mask:0},0,255,ye.ZERO,ye.ZERO,ye.ZERO)},Oa.prototype.clearStencil=function(){var C=this.context,R=C.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var F=e.create();e.ortho(F,0,this.width,this.height,0,0,1),e.scale(F,F,[R.drawingBufferWidth,R.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(C,R.TRIANGLES,Ke.disabled,this.stencilClearMode,Ce.disabled,Le.disabled,vo(F),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Oa.prototype._renderTileClippingMasks=function(C,R){if(this.currentStencilSource!==C.source&&C.isTileClipped()&&R&&R.length){this.currentStencilSource=C.source;var F=this.context,V=F.gl;this.nextStencilID+R.length>256&&this.clearStencil(),F.setColorMode(Ce.disabled),F.setDepthMode(Ke.disabled);var ne=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var le=0,pe=R;le<pe.length;le+=1){var ye=pe[le],Te=this._tileClippingMaskIDs[ye.key]=this.nextStencilID++;ne.draw(F,V.TRIANGLES,Ke.disabled,new _e({func:V.ALWAYS,mask:0},Te,255,V.KEEP,V.KEEP,V.REPLACE),Ce.disabled,Le.disabled,vo(ye.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Oa.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var C=this.nextStencilID++,R=this.context.gl;return new _e({func:R.NOTEQUAL,mask:255},C,255,R.KEEP,R.KEEP,R.REPLACE)},Oa.prototype.stencilModeForClipping=function(C){var R=this.context.gl;return new _e({func:R.EQUAL,mask:255},this._tileClippingMaskIDs[C.key],0,R.KEEP,R.KEEP,R.REPLACE)},Oa.prototype.stencilConfigForOverlap=function(C){var R,F=this.context.gl,V=C.sort(function(Te,Ne){return Ne.overscaledZ-Te.overscaledZ}),ne=V[V.length-1].overscaledZ,le=V[0].overscaledZ-ne+1;if(le>1){this.currentStencilSource=void 0,this.nextStencilID+le>256&&this.clearStencil();for(var pe={},ye=0;ye<le;ye++)pe[ye+ne]=new _e({func:F.GEQUAL,mask:255},ye+this.nextStencilID,255,F.KEEP,F.KEEP,F.REPLACE);return this.nextStencilID+=le,[pe,V]}return[(R={},R[ne]=_e.disabled,R),V]},Oa.prototype.colorModeForRenderPass=function(){var C=this.context.gl;return this._showOverdrawInspector?new Ce([C.CONSTANT_COLOR,C.ONE],new e.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ce.unblended:Ce.alphaBlended},Oa.prototype.depthModeForSublayer=function(C,R,F){if(!this.opaquePassEnabledForLayer())return Ke.disabled;var V=1-((1+this.currentLayer)*this.numSublayers+C)*this.depthEpsilon;return new Ke(F||this.context.gl.LEQUAL,R,[V,V])},Oa.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Oa.prototype.render=function(C,R){var F=this;this.style=C,this.options=R,this.lineAtlas=C.lineAtlas,this.imageManager=C.imageManager,this.glyphManager=C.glyphManager,this.symbolFadeChange=C.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var V=this.style._order,ne=this.style.sourceCaches;for(var le in ne){var pe=ne[le];pe.used&&pe.prepare(this.context)}var ye,Te,Ne={},Ge={},nt={};for(var bt in ne){var Ct=ne[bt];Ne[bt]=Ct.getVisibleCoordinates(),Ge[bt]=Ne[bt].slice().reverse(),nt[bt]=Ct.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Tt=0;Tt<V.length;Tt++){var At=V[Tt];if(this.style._layers[At].is3D()){this.opaquePassCutoff=Tt;break}}this.renderPass="offscreen";for(var yt=0,Ft=V;yt<Ft.length;yt+=1){var zt=Ft[yt],jt=this.style._layers[zt];if(jt.hasOffscreenPass()&&!jt.isHidden(this.transform.zoom)){var rr=Ge[jt.source];(jt.type==="custom"||rr.length)&&this.renderLayer(this,ne[jt.source],jt,rr)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:R.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=R.showOverdrawInspector,this.depthRangeFor3D=[0,1-(C._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=V.length-1;this.currentLayer>=0;this.currentLayer--){var hr=this.style._layers[V[this.currentLayer]],Ar=ne[hr.source],kr=Ne[hr.source];this._renderTileClippingMasks(hr,kr),this.renderLayer(this,Ar,hr,kr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<V.length;this.currentLayer++){var Kr=this.style._layers[V[this.currentLayer]],Zr=ne[Kr.source],hn=(Kr.type==="symbol"?nt:Ge)[Kr.source];this._renderTileClippingMasks(Kr,Ne[Kr.source]),this.renderLayer(this,Zr,Kr,hn)}this.options.showTileBoundaries&&(e.values(this.style._layers).forEach(function(sn){sn.source&&!sn.isHidden(F.transform.zoom)&&(sn.source!==(Te&&Te.id)&&(Te=F.style.sourceCaches[sn.source]),(!ye||ye.getSource().maxzoom<Te.getSource().maxzoom)&&(ye=Te))}),ye&&oo.debug(this,ye,ye.getVisibleCoordinates())),this.options.showPadding&&ki(this),this.context.setDefault()},Oa.prototype.renderLayer=function(C,R,F,V){F.isHidden(this.transform.zoom)||(F.type==="background"||F.type==="custom"||V.length)&&(this.id=F.id,this.gpuTimingStart(F),oo[F.type](C,R,F,V,this.style.placement.variableOffsets),this.gpuTimingEnd())},Oa.prototype.gpuTimingStart=function(C){if(this.options.gpuTiming){var R=this.context.extTimerQuery,F=this.gpuTimers[C.id];F||(F=this.gpuTimers[C.id]={calls:0,cpuTime:0,query:R.createQueryEXT()}),F.calls++,R.beginQueryEXT(R.TIME_ELAPSED_EXT,F.query)}},Oa.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var C=this.context.extTimerQuery;C.endQueryEXT(C.TIME_ELAPSED_EXT)}},Oa.prototype.collectGpuTimers=function(){var C=this.gpuTimers;return this.gpuTimers={},C},Oa.prototype.queryGpuTimers=function(C){var R={};for(var F in C){var V=C[F],ne=this.context.extTimerQuery,le=ne.getQueryObjectEXT(V.query,ne.QUERY_RESULT_EXT)/1e6;ne.deleteQueryEXT(V.query),R[F]=le}return R},Oa.prototype.translatePosMatrix=function(C,R,F,V,ne){if(!F[0]&&!F[1])return C;var le=ne?V==="map"?this.transform.angle:0:V==="viewport"?-this.transform.angle:0;if(le){var pe=Math.sin(le),ye=Math.cos(le);F=[F[0]*ye-F[1]*pe,F[0]*pe+F[1]*ye]}var Te=[ne?F[0]:Pr(R,F[0],this.transform.zoom),ne?F[1]:Pr(R,F[1],this.transform.zoom),0],Ne=new Float32Array(16);return e.translate(Ne,C,Te),Ne},Oa.prototype.saveTileTexture=function(C){var R=this._tileTextures[C.size[0]];R?R.push(C):this._tileTextures[C.size[0]]=[C]},Oa.prototype.getTileTexture=function(C){var R=this._tileTextures[C];return R&&R.length>0?R.pop():null},Oa.prototype.isPatternMissing=function(C){if(!C)return!1;if(!C.from||!C.to)return!0;var R=this.imageManager.getPattern(C.from.toString()),F=this.imageManager.getPattern(C.to.toString());return!R||!F},Oa.prototype.useProgram=function(C,R){this.cache=this.cache||{};var F=""+C+(R?R.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[F]||(this.cache[F]=new Zs(this.context,Os[C],R,mr[C],this._showOverdrawInspector)),this.cache[F]},Oa.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Oa.prototype.setBaseState=function(){var C=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(C.FUNC_ADD)},Oa.prototype.initDebugOverlayCanvas=function(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;var C=this.context.gl;this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,C.RGBA)}},Oa.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var ft=function(C,R){this.points=C,this.planes=R};ft.fromInvProjectionMatrix=function(C,R,F){var V=Math.pow(2,F),ne=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(pe){return e.transformMat4([],pe,C)}).map(function(pe){return e.scale$1([],pe,1/pe[3]/R*V)}),le=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(pe){var ye=e.sub([],ne[pe[0]],ne[pe[1]]),Te=e.sub([],ne[pe[2]],ne[pe[1]]),Ne=e.normalize([],e.cross([],ye,Te)),Ge=-e.dot(Ne,ne[pe[1]]);return Ne.concat(Ge)});return new ft(ne,le)};var Rt=function(C,R){this.min=C,this.max=R,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};Rt.prototype.quadrant=function(C){for(var R=[C%2==0,C<2],F=e.clone$2(this.min),V=e.clone$2(this.max),ne=0;ne<R.length;ne++)F[ne]=R[ne]?this.min[ne]:this.center[ne],V[ne]=R[ne]?this.center[ne]:this.max[ne];return V[2]=this.max[2],new Rt(F,V)},Rt.prototype.distanceX=function(C){return Math.max(Math.min(this.max[0],C[0]),this.min[0])-C[0]},Rt.prototype.distanceY=function(C){return Math.max(Math.min(this.max[1],C[1]),this.min[1])-C[1]},Rt.prototype.intersects=function(C){for(var R=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],F=!0,V=0;V<C.planes.length;V++){for(var ne=C.planes[V],le=0,pe=0;pe<R.length;pe++)le+=e.dot$1(ne,R[pe])>=0;if(le===0)return 0;le!==R.length&&(F=!1)}if(F)return 2;for(var ye=0;ye<3;ye++){for(var Te=Number.MAX_VALUE,Ne=-Number.MAX_VALUE,Ge=0;Ge<C.points.length;Ge++){var nt=C.points[Ge][ye]-this.min[ye];Te=Math.min(Te,nt),Ne=Math.max(Ne,nt)}if(Ne<0||Te>this.max[ye]-this.min[ye])return 0}return 1};var sr=function(C,R,F,V){if(C===void 0&&(C=0),R===void 0&&(R=0),F===void 0&&(F=0),V===void 0&&(V=0),isNaN(C)||C<0||isNaN(R)||R<0||isNaN(F)||F<0||isNaN(V)||V<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=C,this.bottom=R,this.left=F,this.right=V};sr.prototype.interpolate=function(C,R,F){return R.top!=null&&C.top!=null&&(this.top=e.number(C.top,R.top,F)),R.bottom!=null&&C.bottom!=null&&(this.bottom=e.number(C.bottom,R.bottom,F)),R.left!=null&&C.left!=null&&(this.left=e.number(C.left,R.left,F)),R.right!=null&&C.right!=null&&(this.right=e.number(C.right,R.right,F)),this},sr.prototype.getCenter=function(C,R){var F=e.clamp((this.left+C-this.right)/2,0,C),V=e.clamp((this.top+R-this.bottom)/2,0,R);return new e.Point(F,V)},sr.prototype.equals=function(C){return this.top===C.top&&this.bottom===C.bottom&&this.left===C.left&&this.right===C.right},sr.prototype.clone=function(){return new sr(this.top,this.bottom,this.left,this.right)},sr.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Vt=function(C,R,F,V,ne){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=ne===void 0||ne,this._minZoom=C||0,this._maxZoom=R||22,this._minPitch=F==null?0:F,this._maxPitch=V==null?60:V,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new sr,this._posMatrixCache={},this._alignedPosMatrixCache={}},lr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Vt.prototype.clone=function(){var C=new Vt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return C.tileSize=this.tileSize,C.latRange=this.latRange,C.width=this.width,C.height=this.height,C._center=this._center,C.zoom=this.zoom,C.angle=this.angle,C._fov=this._fov,C._pitch=this._pitch,C._unmodified=this._unmodified,C._edgeInsets=this._edgeInsets.clone(),C._calcMatrices(),C},lr.minZoom.get=function(){return this._minZoom},lr.minZoom.set=function(C){this._minZoom!==C&&(this._minZoom=C,this.zoom=Math.max(this.zoom,C))},lr.maxZoom.get=function(){return this._maxZoom},lr.maxZoom.set=function(C){this._maxZoom!==C&&(this._maxZoom=C,this.zoom=Math.min(this.zoom,C))},lr.minPitch.get=function(){return this._minPitch},lr.minPitch.set=function(C){this._minPitch!==C&&(this._minPitch=C,this.pitch=Math.max(this.pitch,C))},lr.maxPitch.get=function(){return this._maxPitch},lr.maxPitch.set=function(C){this._maxPitch!==C&&(this._maxPitch=C,this.pitch=Math.min(this.pitch,C))},lr.renderWorldCopies.get=function(){return this._renderWorldCopies},lr.renderWorldCopies.set=function(C){C===void 0?C=!0:C===null&&(C=!1),this._renderWorldCopies=C},lr.worldSize.get=function(){return this.tileSize*this.scale},lr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},lr.size.get=function(){return new e.Point(this.width,this.height)},lr.bearing.get=function(){return-this.angle/Math.PI*180},lr.bearing.set=function(C){var R=-e.wrap(C,-180,180)*Math.PI/180;this.angle!==R&&(this._unmodified=!1,this.angle=R,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},lr.pitch.get=function(){return this._pitch/Math.PI*180},lr.pitch.set=function(C){var R=e.clamp(C,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==R&&(this._unmodified=!1,this._pitch=R,this._calcMatrices())},lr.fov.get=function(){return this._fov/Math.PI*180},lr.fov.set=function(C){C=Math.max(.01,Math.min(60,C)),this._fov!==C&&(this._unmodified=!1,this._fov=C/180*Math.PI,this._calcMatrices())},lr.zoom.get=function(){return this._zoom},lr.zoom.set=function(C){var R=Math.min(Math.max(C,this.minZoom),this.maxZoom);this._zoom!==R&&(this._unmodified=!1,this._zoom=R,this.scale=this.zoomScale(R),this.tileZoom=Math.floor(R),this.zoomFraction=R-this.tileZoom,this._constrain(),this._calcMatrices())},lr.center.get=function(){return this._center},lr.center.set=function(C){C.lat===this._center.lat&&C.lng===this._center.lng||(this._unmodified=!1,this._center=C,this._constrain(),this._calcMatrices())},lr.padding.get=function(){return this._edgeInsets.toJSON()},lr.padding.set=function(C){this._edgeInsets.equals(C)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,C,1),this._calcMatrices())},lr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Vt.prototype.isPaddingEqual=function(C){return this._edgeInsets.equals(C)},Vt.prototype.interpolatePadding=function(C,R,F){this._unmodified=!1,this._edgeInsets.interpolate(C,R,F),this._constrain(),this._calcMatrices()},Vt.prototype.coveringZoomLevel=function(C){var R=(C.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/C.tileSize));return Math.max(0,R)},Vt.prototype.getVisibleUnwrappedCoordinates=function(C){var R=[new e.UnwrappedTileID(0,C)];if(this._renderWorldCopies)for(var F=this.pointCoordinate(new e.Point(0,0)),V=this.pointCoordinate(new e.Point(this.width,0)),ne=this.pointCoordinate(new e.Point(this.width,this.height)),le=this.pointCoordinate(new e.Point(0,this.height)),pe=Math.floor(Math.min(F.x,V.x,ne.x,le.x)),ye=Math.floor(Math.max(F.x,V.x,ne.x,le.x)),Te=pe-1;Te<=ye+1;Te++)Te!==0&&R.push(new e.UnwrappedTileID(Te,C));return R},Vt.prototype.coveringTiles=function(C){var R=this.coveringZoomLevel(C),F=R;if(C.minzoom!==void 0&&R<C.minzoom)return[];C.maxzoom!==void 0&&R>C.maxzoom&&(R=C.maxzoom);var V=e.MercatorCoordinate.fromLngLat(this.center),ne=Math.pow(2,R),le=[ne*V.x,ne*V.y,0],pe=ft.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,R),ye=C.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ye=R);var Te=function(hn){return{aabb:new Rt([hn*ne,0,0],[(hn+1)*ne,ne,0]),zoom:0,x:0,y:0,wrap:hn,fullyVisible:!1}},Ne=[],Ge=[],nt=R,bt=C.reparseOverscaled?F:R;if(this._renderWorldCopies)for(var Ct=1;Ct<=3;Ct++)Ne.push(Te(-Ct)),Ne.push(Te(Ct));for(Ne.push(Te(0));Ne.length>0;){var Tt=Ne.pop(),At=Tt.x,yt=Tt.y,Ft=Tt.fullyVisible;if(!Ft){var zt=Tt.aabb.intersects(pe);if(zt===0)continue;Ft=zt===2}var jt=Tt.aabb.distanceX(le),rr=Tt.aabb.distanceY(le),hr=Math.max(Math.abs(jt),Math.abs(rr)),Ar=3+(1<<nt-Tt.zoom)-2;if(Tt.zoom===nt||hr>Ar&&Tt.zoom>=ye)Ge.push({tileID:new e.OverscaledTileID(Tt.zoom===nt?bt:Tt.zoom,Tt.wrap,Tt.zoom,At,yt),distanceSq:e.sqrLen([le[0]-.5-At,le[1]-.5-yt])});else for(var kr=0;kr<4;kr++){var Kr=(At<<1)+kr%2,Zr=(yt<<1)+(kr>>1);Ne.push({aabb:Tt.aabb.quadrant(kr),zoom:Tt.zoom+1,x:Kr,y:Zr,wrap:Tt.wrap,fullyVisible:Ft})}}return Ge.sort(function(hn,sn){return hn.distanceSq-sn.distanceSq}).map(function(hn){return hn.tileID})},Vt.prototype.resize=function(C,R){this.width=C,this.height=R,this.pixelsToGLUnits=[2/C,-2/R],this._constrain(),this._calcMatrices()},lr.unmodified.get=function(){return this._unmodified},Vt.prototype.zoomScale=function(C){return Math.pow(2,C)},Vt.prototype.scaleZoom=function(C){return Math.log(C)/Math.LN2},Vt.prototype.project=function(C){var R=e.clamp(C.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(C.lng)*this.worldSize,e.mercatorYfromLat(R)*this.worldSize)},Vt.prototype.unproject=function(C){return new e.MercatorCoordinate(C.x/this.worldSize,C.y/this.worldSize).toLngLat()},lr.point.get=function(){return this.project(this.center)},Vt.prototype.setLocationAtPoint=function(C,R){var F=this.pointCoordinate(R),V=this.pointCoordinate(this.centerPoint),ne=this.locationCoordinate(C),le=new e.MercatorCoordinate(ne.x-(F.x-V.x),ne.y-(F.y-V.y));this.center=this.coordinateLocation(le),this._renderWorldCopies&&(this.center=this.center.wrap())},Vt.prototype.locationPoint=function(C){return this.coordinatePoint(this.locationCoordinate(C))},Vt.prototype.pointLocation=function(C){return this.coordinateLocation(this.pointCoordinate(C))},Vt.prototype.locationCoordinate=function(C){return e.MercatorCoordinate.fromLngLat(C)},Vt.prototype.coordinateLocation=function(C){return C.toLngLat()},Vt.prototype.pointCoordinate=function(C){var R=[C.x,C.y,0,1],F=[C.x,C.y,1,1];e.transformMat4(R,R,this.pixelMatrixInverse),e.transformMat4(F,F,this.pixelMatrixInverse);var V=R[3],ne=F[3],le=R[0]/V,pe=F[0]/ne,ye=R[1]/V,Te=F[1]/ne,Ne=R[2]/V,Ge=F[2]/ne,nt=Ne===Ge?0:(0-Ne)/(Ge-Ne);return new e.MercatorCoordinate(e.number(le,pe,nt)/this.worldSize,e.number(ye,Te,nt)/this.worldSize)},Vt.prototype.coordinatePoint=function(C){var R=[C.x*this.worldSize,C.y*this.worldSize,0,1];return e.transformMat4(R,R,this.pixelMatrix),new e.Point(R[0]/R[3],R[1]/R[3])},Vt.prototype.getBounds=function(){return new e.LngLatBounds().extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},Vt.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Vt.prototype.setMaxBounds=function(C){C?(this.lngRange=[C.getWest(),C.getEast()],this.latRange=[C.getSouth(),C.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Vt.prototype.calculatePosMatrix=function(C,R){R===void 0&&(R=!1);var F=C.key,V=R?this._alignedPosMatrixCache:this._posMatrixCache;if(V[F])return V[F];var ne=C.canonical,le=this.worldSize/this.zoomScale(ne.z),pe=ne.x+Math.pow(2,ne.z)*C.wrap,ye=e.identity(new Float64Array(16));return e.translate(ye,ye,[pe*le,ne.y*le,0]),e.scale(ye,ye,[le/e.EXTENT,le/e.EXTENT,1]),e.multiply(ye,R?this.alignedProjMatrix:this.projMatrix,ye),V[F]=new Float32Array(ye),V[F]},Vt.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Vt.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var C,R,F,V,ne=-90,le=90,pe=-180,ye=180,Te=this.size,Ne=this._unmodified;if(this.latRange){var Ge=this.latRange;ne=e.mercatorYfromLat(Ge[1])*this.worldSize,C=(le=e.mercatorYfromLat(Ge[0])*this.worldSize)-ne<Te.y?Te.y/(le-ne):0}if(this.lngRange){var nt=this.lngRange;pe=e.mercatorXfromLng(nt[0])*this.worldSize,R=(ye=e.mercatorXfromLng(nt[1])*this.worldSize)-pe<Te.x?Te.x/(ye-pe):0}var bt=this.point,Ct=Math.max(R||0,C||0);if(Ct)return this.center=this.unproject(new e.Point(R?(ye+pe)/2:bt.x,C?(le+ne)/2:bt.y)),this.zoom+=this.scaleZoom(Ct),this._unmodified=Ne,void(this._constraining=!1);if(this.latRange){var Tt=bt.y,At=Te.y/2;Tt-At<ne&&(V=ne+At),Tt+At>le&&(V=le-At)}if(this.lngRange){var yt=bt.x,Ft=Te.x/2;yt-Ft<pe&&(F=pe+Ft),yt+Ft>ye&&(F=ye-Ft)}F===void 0&&V===void 0||(this.center=this.unproject(new e.Point(F!==void 0?F:bt.x,V!==void 0?V:bt.y))),this._unmodified=Ne,this._constraining=!1}},Vt.prototype._calcMatrices=function(){if(this.height){var C=this._fov/2,R=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(C)*this.height;var F=Math.PI/2+this._pitch,V=this._fov*(.5+R.y/this.height),ne=Math.sin(V)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-F-V,.01,Math.PI-.01)),le=this.point,pe=le.x,ye=le.y,Te=1.01*(Math.cos(Math.PI/2-this._pitch)*ne+this.cameraToCenterDistance),Ne=this.height/50,Ge=new Float64Array(16);e.perspective(Ge,this._fov,this.width/this.height,Ne,Te),Ge[8]=2*-R.x/this.width,Ge[9]=2*R.y/this.height,e.scale(Ge,Ge,[1,-1,1]),e.translate(Ge,Ge,[0,0,-this.cameraToCenterDistance]),e.rotateX(Ge,Ge,this._pitch),e.rotateZ(Ge,Ge,this.angle),e.translate(Ge,Ge,[-pe,-ye,0]),this.mercatorMatrix=e.scale([],Ge,[this.worldSize,this.worldSize,this.worldSize]),e.scale(Ge,Ge,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Ge,this.invProjMatrix=e.invert([],this.projMatrix);var nt=this.width%2/2,bt=this.height%2/2,Ct=Math.cos(this.angle),Tt=Math.sin(this.angle),At=pe-Math.round(pe)+Ct*nt+Tt*bt,yt=ye-Math.round(ye)+Ct*bt+Tt*nt,Ft=new Float64Array(Ge);if(e.translate(Ft,Ft,[At>.5?At-1:At,yt>.5?yt-1:yt,0]),this.alignedProjMatrix=Ft,Ge=e.create(),e.scale(Ge,Ge,[this.width/2,-this.height/2,1]),e.translate(Ge,Ge,[1,-1,0]),this.labelPlaneMatrix=Ge,Ge=e.create(),e.scale(Ge,Ge,[1,-1,1]),e.translate(Ge,Ge,[-1,-1,0]),e.scale(Ge,Ge,[2/this.width,2/this.height,1]),this.glCoordMatrix=Ge,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Ge=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Ge,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Vt.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var C=this.pointCoordinate(new e.Point(0,0)),R=[C.x*this.worldSize,C.y*this.worldSize,0,1];return e.transformMat4(R,R,this.pixelMatrix)[3]/this.cameraToCenterDistance},Vt.prototype.getCameraPoint=function(){var C=this._pitch,R=Math.tan(C)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,R))},Vt.prototype.getCameraQueryGeometry=function(C){var R=this.getCameraPoint();if(C.length===1)return[C[0],R];for(var F=R.x,V=R.y,ne=R.x,le=R.y,pe=0,ye=C;pe<ye.length;pe+=1){var Te=ye[pe];F=Math.min(F,Te.x),V=Math.min(V,Te.y),ne=Math.max(ne,Te.x),le=Math.max(le,Te.y)}return[new e.Point(F,V),new e.Point(ne,V),new e.Point(ne,le),new e.Point(F,le),new e.Point(F,V)]},Object.defineProperties(Vt.prototype,lr);var Lr=function(C){var R,F,V,ne,le;this._hashName=C&&encodeURIComponent(C),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(R=this._updateHashUnthrottled.bind(this),F=300,V=!1,ne=null,le=function(){ne=null,V&&(R(),ne=setTimeout(le,F),V=!1)},function(){return V=!0,ne||le(),ne})};Lr.prototype.addTo=function(C){return this._map=C,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Lr.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Lr.prototype.getHashString=function(C){var R=this._map.getCenter(),F=Math.round(100*this._map.getZoom())/100,V=Math.ceil((F*Math.LN2+Math.log(512/360/.5))/Math.LN10),ne=Math.pow(10,V),le=Math.round(R.lng*ne)/ne,pe=Math.round(R.lat*ne)/ne,ye=this._map.getBearing(),Te=this._map.getPitch(),Ne="";if(Ne+=C?"/"+le+"/"+pe+"/"+F:F+"/"+pe+"/"+le,(ye||Te)&&(Ne+="/"+Math.round(10*ye)/10),Te&&(Ne+="/"+Math.round(Te)),this._hashName){var Ge=this._hashName,nt=!1,bt=e.window.location.hash.slice(1).split("&").map(function(Ct){var Tt=Ct.split("=")[0];return Tt===Ge?(nt=!0,Tt+"="+Ne):Ct}).filter(function(Ct){return Ct});return nt||bt.push(Ge+"="+Ne),"#"+bt.join("&")}return"#"+Ne},Lr.prototype._getCurrentHash=function(){var C,R=this,F=e.window.location.hash.replace("#","");return this._hashName?(F.split("&").map(function(V){return V.split("=")}).forEach(function(V){V[0]===R._hashName&&(C=V)}),(C&&C[1]||"").split("/")):F.split("/")},Lr.prototype._onHashChange=function(){var C=this._getCurrentHash();if(C.length>=3&&!C.some(function(F){return isNaN(F)})){var R=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(C[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+C[2],+C[1]],zoom:+C[0],bearing:R,pitch:+(C[4]||0)}),!0}return!1},Lr.prototype._updateHashUnthrottled=function(){var C=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",C)}catch(R){}};var zr={linearity:.3,easing:e.bezier(0,0,.3,1)},Yr=e.extend({deceleration:2500,maxSpeed:1400},zr),ln=e.extend({deceleration:20,maxSpeed:1400},zr),on=e.extend({deceleration:1e3,maxSpeed:360},zr),mn=e.extend({deceleration:1e3,maxSpeed:90},zr),wn=function(C){this._map=C,this.clear()};function un(C,R){(!C.duration||C.duration<R.duration)&&(C.duration=R.duration,C.easing=R.easing)}function Tn(C,R,F){var V=F.maxSpeed,ne=F.linearity,le=F.deceleration,pe=e.clamp(C*ne/(R/1e3),-V,V),ye=Math.abs(pe)/(le*ne);return{easing:F.easing,duration:1e3*ye,amount:pe*(ye/2)}}wn.prototype.clear=function(){this._inertiaBuffer=[]},wn.prototype.record=function(C){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:C})},wn.prototype._drainInertiaBuffer=function(){for(var C=this._inertiaBuffer,R=e.browser.now();C.length>0&&R-C[0].time>160;)C.shift()},wn.prototype._onMoveEnd=function(C){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var R={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},F=0,V=this._inertiaBuffer;F<V.length;F+=1){var ne=V[F].settings;R.zoom+=ne.zoomDelta||0,R.bearing+=ne.bearingDelta||0,R.pitch+=ne.pitchDelta||0,ne.panDelta&&R.pan._add(ne.panDelta),ne.around&&(R.around=ne.around),ne.pinchAround&&(R.pinchAround=ne.pinchAround)}var le=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,pe={};if(R.pan.mag()){var ye=Tn(R.pan.mag(),le,e.extend({},Yr,C||{}));pe.offset=R.pan.mult(ye.amount/R.pan.mag()),pe.center=this._map.transform.center,un(pe,ye)}if(R.zoom){var Te=Tn(R.zoom,le,ln);pe.zoom=this._map.transform.zoom+Te.amount,un(pe,Te)}if(R.bearing){var Ne=Tn(R.bearing,le,on);pe.bearing=this._map.transform.bearing+e.clamp(Ne.amount,-179,179),un(pe,Ne)}if(R.pitch){var Ge=Tn(R.pitch,le,mn);pe.pitch=this._map.transform.pitch+Ge.amount,un(pe,Ge)}if(pe.zoom||pe.bearing){var nt=R.pinchAround===void 0?R.around:R.pinchAround;pe.around=nt?this._map.unproject(nt):this._map.getCenter()}return this.clear(),e.extend(pe,{noMoveStart:!0})}};var Rn=function(C){function R(V,ne,le,pe){pe===void 0&&(pe={});var ye=l.mousePos(ne.getCanvasContainer(),le),Te=ne.unproject(ye);C.call(this,V,e.extend({point:ye,lngLat:Te,originalEvent:le},pe)),this._defaultPrevented=!1,this.target=ne}C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R;var F={defaultPrevented:{configurable:!0}};return R.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(R.prototype,F),R}(e.Event),Vn=function(C){function R(V,ne,le){var pe=V==="touchend"?le.changedTouches:le.touches,ye=l.touchPos(ne.getCanvasContainer(),pe),Te=ye.map(function(nt){return ne.unproject(nt)}),Ne=ye.reduce(function(nt,bt,Ct,Tt){return nt.add(bt.div(Tt.length))},new e.Point(0,0)),Ge=ne.unproject(Ne);C.call(this,V,{points:ye,point:Ne,lngLats:Te,lngLat:Ge,originalEvent:le}),this._defaultPrevented=!1}C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R;var F={defaultPrevented:{configurable:!0}};return R.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(R.prototype,F),R}(e.Event),ta=function(C){function R(V,ne,le){C.call(this,V,{originalEvent:le}),this._defaultPrevented=!1}C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R;var F={defaultPrevented:{configurable:!0}};return R.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(R.prototype,F),R}(e.Event),Xr=function(C,R){this._map=C,this._clickTolerance=R.clickTolerance};Xr.prototype.reset=function(){delete this._mousedownPos},Xr.prototype.wheel=function(C){return this._firePreventable(new ta(C.type,this._map,C))},Xr.prototype.mousedown=function(C,R){return this._mousedownPos=R,this._firePreventable(new Rn(C.type,this._map,C))},Xr.prototype.mouseup=function(C){this._map.fire(new Rn(C.type,this._map,C))},Xr.prototype.click=function(C,R){this._mousedownPos&&this._mousedownPos.dist(R)>=this._clickTolerance||this._map.fire(new Rn(C.type,this._map,C))},Xr.prototype.dblclick=function(C){return this._firePreventable(new Rn(C.type,this._map,C))},Xr.prototype.mouseover=function(C){this._map.fire(new Rn(C.type,this._map,C))},Xr.prototype.mouseout=function(C){this._map.fire(new Rn(C.type,this._map,C))},Xr.prototype.touchstart=function(C){return this._firePreventable(new Vn(C.type,this._map,C))},Xr.prototype.touchmove=function(C){this._map.fire(new Vn(C.type,this._map,C))},Xr.prototype.touchend=function(C){this._map.fire(new Vn(C.type,this._map,C))},Xr.prototype.touchcancel=function(C){this._map.fire(new Vn(C.type,this._map,C))},Xr.prototype._firePreventable=function(C){if(this._map.fire(C),C.defaultPrevented)return{}},Xr.prototype.isEnabled=function(){return!0},Xr.prototype.isActive=function(){return!1},Xr.prototype.enable=function(){},Xr.prototype.disable=function(){};var $n=function(C){this._map=C};$n.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},$n.prototype.mousemove=function(C){this._map.fire(new Rn(C.type,this._map,C))},$n.prototype.mousedown=function(){this._delayContextMenu=!0},$n.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Rn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},$n.prototype.contextmenu=function(C){this._delayContextMenu?this._contextMenuEvent=C:this._map.fire(new Rn(C.type,this._map,C)),this._map.listens("contextmenu")&&C.preventDefault()},$n.prototype.isEnabled=function(){return!0},$n.prototype.isActive=function(){return!1},$n.prototype.enable=function(){},$n.prototype.disable=function(){};var Ln=function(C,R){this._map=C,this._el=C.getCanvasContainer(),this._container=C.getContainer(),this._clickTolerance=R.clickTolerance||1};function jn(C,R){for(var F={},V=0;V<C.length;V++)F[C[V].identifier]=R[V];return F}Ln.prototype.isEnabled=function(){return!!this._enabled},Ln.prototype.isActive=function(){return!!this._active},Ln.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Ln.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ln.prototype.mousedown=function(C,R){this.isEnabled()&&C.shiftKey&&C.button===0&&(l.disableDrag(),this._startPos=this._lastPos=R,this._active=!0)},Ln.prototype.mousemoveWindow=function(C,R){if(this._active){var F=R;if(!(this._lastPos.equals(F)||!this._box&&F.dist(this._startPos)<this._clickTolerance)){var V=this._startPos;this._lastPos=F,this._box||(this._box=l.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",C));var ne=Math.min(V.x,F.x),le=Math.max(V.x,F.x),pe=Math.min(V.y,F.y),ye=Math.max(V.y,F.y);l.setTransform(this._box,"translate("+ne+"px,"+pe+"px)"),this._box.style.width=le-ne+"px",this._box.style.height=ye-pe+"px"}}},Ln.prototype.mouseupWindow=function(C,R){var F=this;if(this._active&&C.button===0){var V=this._startPos,ne=R;if(this.reset(),l.suppressClick(),V.x!==ne.x||V.y!==ne.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:C})),{cameraAnimation:function(le){return le.fitScreenCoordinates(V,ne,F._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",C)}},Ln.prototype.keydown=function(C){this._active&&C.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",C))},Ln.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(l.remove(this._box),this._box=null),l.enableDrag(),delete this._startPos,delete this._lastPos},Ln.prototype._fireEvent=function(C,R){return this._map.fire(new e.Event(C,{originalEvent:R}))};var Jn=function(C){this.reset(),this.numTouches=C.numTouches};Jn.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Jn.prototype.touchstart=function(C,R,F){(this.centroid||F.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=C.timeStamp),F.length===this.numTouches&&(this.centroid=function(V){for(var ne=new e.Point(0,0),le=0,pe=V;le<pe.length;le+=1){var ye=pe[le];ne._add(ye)}return ne.div(V.length)}(R),this.touches=jn(F,R)))},Jn.prototype.touchmove=function(C,R,F){if(!this.aborted&&this.centroid){var V=jn(F,R);for(var ne in this.touches){var le=this.touches[ne],pe=V[ne];(!pe||pe.dist(le)>30)&&(this.aborted=!0)}}},Jn.prototype.touchend=function(C,R,F){if((!this.centroid||C.timeStamp-this.startTime>500)&&(this.aborted=!0),F.length===0){var V=!this.aborted&&this.centroid;if(this.reset(),V)return V}};var Ta=function(C){this.singleTap=new Jn(C),this.numTaps=C.numTaps,this.reset()};Ta.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Ta.prototype.touchstart=function(C,R,F){this.singleTap.touchstart(C,R,F)},Ta.prototype.touchmove=function(C,R,F){this.singleTap.touchmove(C,R,F)},Ta.prototype.touchend=function(C,R,F){var V=this.singleTap.touchend(C,R,F);if(V){var ne=C.timeStamp-this.lastTime<500,le=!this.lastTap||this.lastTap.dist(V)<30;if(ne&&le||this.reset(),this.count++,this.lastTime=C.timeStamp,this.lastTap=V,this.count===this.numTaps)return this.reset(),V}};var Ca=function(){this._zoomIn=new Ta({numTouches:1,numTaps:2}),this._zoomOut=new Ta({numTouches:2,numTaps:1}),this.reset()};Ca.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Ca.prototype.touchstart=function(C,R,F){this._zoomIn.touchstart(C,R,F),this._zoomOut.touchstart(C,R,F)},Ca.prototype.touchmove=function(C,R,F){this._zoomIn.touchmove(C,R,F),this._zoomOut.touchmove(C,R,F)},Ca.prototype.touchend=function(C,R,F){var V=this,ne=this._zoomIn.touchend(C,R,F),le=this._zoomOut.touchend(C,R,F);return ne?(this._active=!0,C.preventDefault(),setTimeout(function(){return V.reset()},0),{cameraAnimation:function(pe){return pe.easeTo({duration:300,zoom:pe.getZoom()+1,around:pe.unproject(ne)},{originalEvent:C})}}):le?(this._active=!0,C.preventDefault(),setTimeout(function(){return V.reset()},0),{cameraAnimation:function(pe){return pe.easeTo({duration:300,zoom:pe.getZoom()-1,around:pe.unproject(le)},{originalEvent:C})}}):void 0},Ca.prototype.touchcancel=function(){this.reset()},Ca.prototype.enable=function(){this._enabled=!0},Ca.prototype.disable=function(){this._enabled=!1,this.reset()},Ca.prototype.isEnabled=function(){return this._enabled},Ca.prototype.isActive=function(){return this._active};var Mn=function(C){this.reset(),this._clickTolerance=C.clickTolerance||1};Mn.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Mn.prototype._correctButton=function(C,R){return!1},Mn.prototype._move=function(C,R){return{}},Mn.prototype.mousedown=function(C,R){if(!this._lastPoint){var F=l.mouseButton(C);this._correctButton(C,F)&&(this._lastPoint=R,this._eventButton=F)}},Mn.prototype.mousemoveWindow=function(C,R){var F=this._lastPoint;if(F&&(C.preventDefault(),this._moved||!(R.dist(F)<this._clickTolerance)))return this._moved=!0,this._lastPoint=R,this._move(F,R)},Mn.prototype.mouseupWindow=function(C){l.mouseButton(C)===this._eventButton&&(this._moved&&l.suppressClick(),this.reset())},Mn.prototype.enable=function(){this._enabled=!0},Mn.prototype.disable=function(){this._enabled=!1,this.reset()},Mn.prototype.isEnabled=function(){return this._enabled},Mn.prototype.isActive=function(){return this._active};var Da=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.mousedown=function(F,V){C.prototype.mousedown.call(this,F,V),this._lastPoint&&(this._active=!0)},R.prototype._correctButton=function(F,V){return V===0&&!F.ctrlKey},R.prototype._move=function(F,V){return{around:V,panDelta:V.sub(F)}},R}(Mn),Sa=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype._correctButton=function(F,V){return V===0&&F.ctrlKey||V===2},R.prototype._move=function(F,V){var ne=.8*(V.x-F.x);if(ne)return this._active=!0,{bearingDelta:ne}},R.prototype.contextmenu=function(F){F.preventDefault()},R}(Mn),da=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype._correctButton=function(F,V){return V===0&&F.ctrlKey||V===2},R.prototype._move=function(F,V){var ne=-.5*(V.y-F.y);if(ne)return this._active=!0,{pitchDelta:ne}},R.prototype.contextmenu=function(F){F.preventDefault()},R}(Mn),za=function(C){this._minTouches=1,this._clickTolerance=C.clickTolerance||1,this.reset()};za.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},za.prototype.touchstart=function(C,R,F){return this._calculateTransform(C,R,F)},za.prototype.touchmove=function(C,R,F){if(this._active)return C.preventDefault(),this._calculateTransform(C,R,F)},za.prototype.touchend=function(C,R,F){this._calculateTransform(C,R,F),this._active&&F.length<this._minTouches&&this.reset()},za.prototype.touchcancel=function(){this.reset()},za.prototype._calculateTransform=function(C,R,F){F.length>0&&(this._active=!0);var V=jn(F,R),ne=new e.Point(0,0),le=new e.Point(0,0),pe=0;for(var ye in V){var Te=V[ye],Ne=this._touches[ye];Ne&&(ne._add(Te),le._add(Te.sub(Ne)),pe++,V[ye]=Te)}if(this._touches=V,!(pe<this._minTouches)&&le.mag()){var Ge=le.div(pe);if(this._sum._add(Ge),!(this._sum.mag()<this._clickTolerance))return{around:ne.div(pe),panDelta:Ge}}},za.prototype.enable=function(){this._enabled=!0},za.prototype.disable=function(){this._enabled=!1,this.reset()},za.prototype.isEnabled=function(){return this._enabled},za.prototype.isActive=function(){return this._active};var Aa=function(){this.reset()};function ti(C,R,F){for(var V=0;V<C.length;V++)if(C[V].identifier===F)return R[V]}Aa.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Aa.prototype._start=function(C){},Aa.prototype._move=function(C,R,F){return{}},Aa.prototype.touchstart=function(C,R,F){this._firstTwoTouches||F.length<2||(this._firstTwoTouches=[F[0].identifier,F[1].identifier],this._start([R[0],R[1]]))},Aa.prototype.touchmove=function(C,R,F){if(this._firstTwoTouches){C.preventDefault();var V=this._firstTwoTouches,ne=V[0],le=V[1],pe=ti(F,R,ne),ye=ti(F,R,le);if(pe&&ye){var Te=this._aroundCenter?null:pe.add(ye).div(2);return this._move([pe,ye],Te,C)}}},Aa.prototype.touchend=function(C,R,F){if(this._firstTwoTouches){var V=this._firstTwoTouches,ne=V[0],le=V[1],pe=ti(F,R,ne),ye=ti(F,R,le);pe&&ye||(this._active&&l.suppressClick(),this.reset())}},Aa.prototype.touchcancel=function(){this.reset()},Aa.prototype.enable=function(C){this._enabled=!0,this._aroundCenter=!!C&&C.around==="center"},Aa.prototype.disable=function(){this._enabled=!1,this.reset()},Aa.prototype.isEnabled=function(){return this._enabled},Aa.prototype.isActive=function(){return this._active};function Qn(C,R){return Math.log(C/R)/Math.LN2}var Za=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.reset=function(){C.prototype.reset.call(this),delete this._distance,delete this._startDistance},R.prototype._start=function(F){this._startDistance=this._distance=F[0].dist(F[1])},R.prototype._move=function(F,V){var ne=this._distance;if(this._distance=F[0].dist(F[1]),this._active||!(Math.abs(Qn(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qn(this._distance,ne),pinchAround:V}},R}(Aa);function Gi(C,R){return 180*C.angleWith(R)/Math.PI}var cs=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.reset=function(){C.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},R.prototype._start=function(F){this._startVector=this._vector=F[0].sub(F[1]),this._minDiameter=F[0].dist(F[1])},R.prototype._move=function(F,V){var ne=this._vector;if(this._vector=F[0].sub(F[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Gi(this._vector,ne),pinchAround:V}},R.prototype._isBelowThreshold=function(F){this._minDiameter=Math.min(this._minDiameter,F.mag());var V=25/(Math.PI*this._minDiameter)*360,ne=Gi(F,this._startVector);return Math.abs(ne)<V},R}(Aa);function Xo(C){return Math.abs(C.y)>Math.abs(C.x)}var Eo=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.reset=function(){C.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},R.prototype._start=function(F){this._lastPoints=F,Xo(F[0].sub(F[1]))&&(this._valid=!1)},R.prototype._move=function(F,V,ne){var le=F[0].sub(this._lastPoints[0]),pe=F[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(le,pe,ne.timeStamp),this._valid)return this._lastPoints=F,this._active=!0,{pitchDelta:-.5*((le.y+pe.y)/2)}},R.prototype.gestureBeginsVertically=function(F,V,ne){if(this._valid!==void 0)return this._valid;var le=F.mag()>=2,pe=V.mag()>=2;if(le||pe){if(!le||!pe)return this._firstMove===void 0&&(this._firstMove=ne),ne-this._firstMove<100&&void 0;var ye=F.y>0==V.y>0;return Xo(F)&&Xo(V)&&ye}},R}(Aa),va={panStep:100,bearingStep:15,pitchStep:10},xi=function(){var C=va;this._panStep=C.panStep,this._bearingStep=C.bearingStep,this._pitchStep=C.pitchStep};function Co(C){return C*(2-C)}xi.prototype.reset=function(){this._active=!1},xi.prototype.keydown=function(C){var R=this;if(!(C.altKey||C.ctrlKey||C.metaKey)){var F=0,V=0,ne=0,le=0,pe=0;switch(C.keyCode){case 61:case 107:case 171:case 187:F=1;break;case 189:case 109:case 173:F=-1;break;case 37:C.shiftKey?V=-1:(C.preventDefault(),le=-1);break;case 39:C.shiftKey?V=1:(C.preventDefault(),le=1);break;case 38:C.shiftKey?ne=1:(C.preventDefault(),pe=-1);break;case 40:C.shiftKey?ne=-1:(C.preventDefault(),pe=1);break;default:return}return{cameraAnimation:function(ye){var Te=ye.getZoom();ye.easeTo({duration:300,easeId:"keyboardHandler",easing:Co,zoom:F?Math.round(Te)+F*(C.shiftKey?2:1):Te,bearing:ye.getBearing()+V*R._bearingStep,pitch:ye.getPitch()+ne*R._pitchStep,offset:[-le*R._panStep,-pe*R._panStep],center:ye.getCenter()},{originalEvent:C})}}}},xi.prototype.enable=function(){this._enabled=!0},xi.prototype.disable=function(){this._enabled=!1,this.reset()},xi.prototype.isEnabled=function(){return this._enabled},xi.prototype.isActive=function(){return this._active};var Ka=function(C,R){this._map=C,this._el=C.getCanvasContainer(),this._handler=R,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Ka.prototype.setZoomRate=function(C){this._defaultZoomRate=C},Ka.prototype.setWheelZoomRate=function(C){this._wheelZoomRate=C},Ka.prototype.isEnabled=function(){return!!this._enabled},Ka.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Ka.prototype.isZooming=function(){return!!this._zooming},Ka.prototype.enable=function(C){this.isEnabled()||(this._enabled=!0,this._aroundCenter=C&&C.around==="center")},Ka.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ka.prototype.wheel=function(C){if(this.isEnabled()){var R=C.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*C.deltaY:C.deltaY,F=e.browser.now(),V=F-(this._lastWheelEventTime||0);this._lastWheelEventTime=F,R!==0&&R%4.000244140625==0?this._type="wheel":R!==0&&Math.abs(R)<4?this._type="trackpad":V>400?(this._type=null,this._lastValue=R,this._timeout=setTimeout(this._onTimeout,40,C)):this._type||(this._type=Math.abs(V*R)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,R+=this._lastValue)),C.shiftKey&&R&&(R/=4),this._type&&(this._lastWheelEvent=C,this._delta-=R,this._active||this._start(C)),C.preventDefault()}},Ka.prototype._onTimeout=function(C){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(C)},Ka.prototype._start=function(C){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var R=l.mousePos(this._el,C);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(R)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Ka.prototype.renderFrame=function(){return this._onScrollFrame()},Ka.prototype._onScrollFrame=function(){var C=this;if(this._frameId&&(this._frameId=null,this.isActive())){var R=this._map.transform;if(this._delta!==0){var F=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,V=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&V!==0&&(V=1/V);var ne=typeof this._targetZoom=="number"?R.zoomScale(this._targetZoom):R.scale;this._targetZoom=Math.min(R.maxZoom,Math.max(R.minZoom,R.scaleZoom(ne*V))),this._type==="wheel"&&(this._startZoom=R.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var le,pe=typeof this._targetZoom=="number"?this._targetZoom:R.zoom,ye=this._startZoom,Te=this._easing,Ne=!1;if(this._type==="wheel"&&ye&&Te){var Ge=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),nt=Te(Ge);le=e.number(ye,pe,nt),Ge<1?this._frameId||(this._frameId=!0):Ne=!0}else le=pe,Ne=!0;return this._active=!0,Ne&&(this._active=!1,this._finishTimeout=setTimeout(function(){C._zooming=!1,C._handler._triggerRenderFrame(),delete C._targetZoom,delete C._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ne,zoomDelta:le-R.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Ka.prototype._smoothOutEasing=function(C){var R=e.ease;if(this._prevEase){var F=this._prevEase,V=(e.browser.now()-F.start)/F.duration,ne=F.easing(V+.01)-F.easing(V),le=.27/Math.sqrt(ne*ne+1e-4)*.01,pe=Math.sqrt(.0729-le*le);R=e.bezier(le,pe,.25,1)}return this._prevEase={start:e.browser.now(),duration:C,easing:R},R},Ka.prototype.reset=function(){this._active=!1};var Ei=function(C,R){this._clickZoom=C,this._tapZoom=R};Ei.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ei.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ei.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ei.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Zi=function(){this.reset()};Zi.prototype.reset=function(){this._active=!1},Zi.prototype.dblclick=function(C,R){return C.preventDefault(),{cameraAnimation:function(F){F.easeTo({duration:300,zoom:F.getZoom()+(C.shiftKey?-1:1),around:F.unproject(R)},{originalEvent:C})}}},Zi.prototype.enable=function(){this._enabled=!0},Zi.prototype.disable=function(){this._enabled=!1,this.reset()},Zi.prototype.isEnabled=function(){return this._enabled},Zi.prototype.isActive=function(){return this._active};var ai=function(){this._tap=new Ta({numTouches:1,numTaps:1}),this.reset()};ai.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ai.prototype.touchstart=function(C,R,F){this._swipePoint||(this._tapTime&&C.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?F.length>0&&(this._swipePoint=R[0],this._swipeTouch=F[0].identifier):this._tap.touchstart(C,R,F))},ai.prototype.touchmove=function(C,R,F){if(this._tapTime){if(this._swipePoint){if(F[0].identifier!==this._swipeTouch)return;var V=R[0],ne=V.y-this._swipePoint.y;return this._swipePoint=V,C.preventDefault(),this._active=!0,{zoomDelta:ne/128}}}else this._tap.touchmove(C,R,F)},ai.prototype.touchend=function(C,R,F){this._tapTime?this._swipePoint&&F.length===0&&this.reset():this._tap.touchend(C,R,F)&&(this._tapTime=C.timeStamp)},ai.prototype.touchcancel=function(){this.reset()},ai.prototype.enable=function(){this._enabled=!0},ai.prototype.disable=function(){this._enabled=!1,this.reset()},ai.prototype.isEnabled=function(){return this._enabled},ai.prototype.isActive=function(){return this._active};var yo=function(C,R,F){this._el=C,this._mousePan=R,this._touchPan=F};yo.prototype.enable=function(C){this._inertiaOptions=C||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},yo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},yo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},yo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ii=function(C,R,F){this._pitchWithRotate=C.pitchWithRotate,this._mouseRotate=R,this._mousePitch=F};ii.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ii.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ii.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ii.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var so=function(C,R,F,V){this._el=C,this._touchZoom=R,this._touchRotate=F,this._tapDragZoom=V,this._rotationDisabled=!1,this._enabled=!0};so.prototype.enable=function(C){this._touchZoom.enable(C),this._rotationDisabled||this._touchRotate.enable(C),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},so.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},so.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},so.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},so.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},so.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Ms=function(C){return C.zoom||C.drag||C.pitch||C.rotate},ys=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R}(e.Event);function pl(C){return C.panDelta&&C.panDelta.mag()||C.zoomDelta||C.bearingDelta||C.pitchDelta}var Ni=function(C,R){this._map=C,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new wn(C),this._bearingSnap=R.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(R),e.bindAll(["handleEvent","handleWindowEvent"],this);var F=this._el;this._listeners=[[F,"touchstart",{passive:!1}],[F,"touchmove",{passive:!1}],[F,"touchend",void 0],[F,"touchcancel",void 0],[F,"mousedown",void 0],[F,"mousemove",void 0],[F,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[F,"mouseover",void 0],[F,"mouseout",void 0],[F,"dblclick",void 0],[F,"click",void 0],[F,"keydown",{capture:!1}],[F,"keyup",void 0],[F,"wheel",{passive:!1}],[F,"contextmenu",void 0],[e.window,"blur",void 0]];for(var V=0,ne=this._listeners;V<ne.length;V+=1){var le=ne[V],pe=le[0],ye=le[1],Te=le[2];l.addEventListener(pe,ye,pe===e.window.document?this.handleWindowEvent:this.handleEvent,Te)}};Ni.prototype.destroy=function(){for(var C=0,R=this._listeners;C<R.length;C+=1){var F=R[C],V=F[0],ne=F[1],le=F[2];l.removeEventListener(V,ne,V===e.window.document?this.handleWindowEvent:this.handleEvent,le)}},Ni.prototype._addDefaultHandlers=function(C){var R=this._map,F=R.getCanvasContainer();this._add("mapEvent",new Xr(R,C));var V=R.boxZoom=new Ln(R,C);this._add("boxZoom",V);var ne=new Ca,le=new Zi;R.doubleClickZoom=new Ei(le,ne),this._add("tapZoom",ne),this._add("clickZoom",le);var pe=new ai;this._add("tapDragZoom",pe);var ye=R.touchPitch=new Eo;this._add("touchPitch",ye);var Te=new Sa(C),Ne=new da(C);R.dragRotate=new ii(C,Te,Ne),this._add("mouseRotate",Te,["mousePitch"]),this._add("mousePitch",Ne,["mouseRotate"]);var Ge=new Da(C),nt=new za(C);R.dragPan=new yo(F,Ge,nt),this._add("mousePan",Ge),this._add("touchPan",nt,["touchZoom","touchRotate"]);var bt=new cs,Ct=new Za;R.touchZoomRotate=new so(F,Ct,bt,pe),this._add("touchRotate",bt,["touchPan","touchZoom"]),this._add("touchZoom",Ct,["touchPan","touchRotate"]);var Tt=R.scrollZoom=new Ka(R,this);this._add("scrollZoom",Tt,["mousePan"]);var At=R.keyboard=new xi;this._add("keyboard",At),this._add("blockableMapEvent",new $n(R));for(var yt=0,Ft=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];yt<Ft.length;yt+=1){var zt=Ft[yt];C.interactive&&C[zt]&&R[zt].enable(C[zt])}},Ni.prototype._add=function(C,R,F){this._handlers.push({handlerName:C,handler:R,allowed:F}),this._handlersById[C]=R},Ni.prototype.stop=function(){if(!this._updatingCamera){for(var C=0,R=this._handlers;C<R.length;C+=1)R[C].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Ni.prototype.isActive=function(){for(var C=0,R=this._handlers;C<R.length;C+=1)if(R[C].handler.isActive())return!0;return!1},Ni.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Ni.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Ni.prototype.isMoving=function(){return Boolean(Ms(this._eventsInProgress))||this.isZooming()},Ni.prototype._blockedByActive=function(C,R,F){for(var V in C)if(V!==F&&(!R||R.indexOf(V)<0))return!0;return!1},Ni.prototype.handleWindowEvent=function(C){this.handleEvent(C,C.type+"Window")},Ni.prototype._getMapTouches=function(C){for(var R=[],F=0,V=C;F<V.length;F+=1){var ne=V[F],le=ne.target;this._el.contains(le)&&R.push(ne)}return R},Ni.prototype.handleEvent=function(C,R){if(C.type!=="blur"){this._updatingCamera=!0;for(var F=C.type==="renderFrame"?void 0:C,V={needsRenderFrame:!1},ne={},le={},pe=C.touches?this._getMapTouches(C.touches):void 0,ye=pe?l.touchPos(this._el,pe):l.mousePos(this._el,C),Te=0,Ne=this._handlers;Te<Ne.length;Te+=1){var Ge=Ne[Te],nt=Ge.handlerName,bt=Ge.handler,Ct=Ge.allowed;if(bt.isEnabled()){var Tt=void 0;this._blockedByActive(le,Ct,nt)?bt.reset():bt[R||C.type]&&(Tt=bt[R||C.type](C,ye,pe),this.mergeHandlerResult(V,ne,Tt,nt,F),Tt&&Tt.needsRenderFrame&&this._triggerRenderFrame()),(Tt||bt.isActive())&&(le[nt]=bt)}}var At={};for(var yt in this._previousActiveHandlers)le[yt]||(At[yt]=F);this._previousActiveHandlers=le,(Object.keys(At).length||pl(V))&&(this._changes.push([V,ne,At]),this._triggerRenderFrame()),(Object.keys(le).length||pl(V))&&this._map._stop(!0),this._updatingCamera=!1;var Ft=V.cameraAnimation;Ft&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],Ft(this._map))}else this.stop()},Ni.prototype.mergeHandlerResult=function(C,R,F,V,ne){if(F){e.extend(C,F);var le={handlerName:V,originalEvent:F.originalEvent||ne};F.zoomDelta!==void 0&&(R.zoom=le),F.panDelta!==void 0&&(R.drag=le),F.pitchDelta!==void 0&&(R.pitch=le),F.bearingDelta!==void 0&&(R.rotate=le)}},Ni.prototype._applyChanges=function(){for(var C={},R={},F={},V=0,ne=this._changes;V<ne.length;V+=1){var le=ne[V],pe=le[0],ye=le[1],Te=le[2];pe.panDelta&&(C.panDelta=(C.panDelta||new e.Point(0,0))._add(pe.panDelta)),pe.zoomDelta&&(C.zoomDelta=(C.zoomDelta||0)+pe.zoomDelta),pe.bearingDelta&&(C.bearingDelta=(C.bearingDelta||0)+pe.bearingDelta),pe.pitchDelta&&(C.pitchDelta=(C.pitchDelta||0)+pe.pitchDelta),pe.around!==void 0&&(C.around=pe.around),pe.pinchAround!==void 0&&(C.pinchAround=pe.pinchAround),pe.noInertia&&(C.noInertia=pe.noInertia),e.extend(R,ye),e.extend(F,Te)}this._updateMapTransform(C,R,F),this._changes=[]},Ni.prototype._updateMapTransform=function(C,R,F){var V=this._map,ne=V.transform;if(!pl(C))return this._fireEvents(R,F);var le=C.panDelta,pe=C.zoomDelta,ye=C.bearingDelta,Te=C.pitchDelta,Ne=C.around,Ge=C.pinchAround;Ge!==void 0&&(Ne=Ge),V._stop(!0),Ne=Ne||V.transform.centerPoint;var nt=ne.pointLocation(le?Ne.sub(le):Ne);ye&&(ne.bearing+=ye),Te&&(ne.pitch+=Te),pe&&(ne.zoom+=pe),ne.setLocationAtPoint(nt,Ne),this._map._update(),C.noInertia||this._inertia.record(C),this._fireEvents(R,F)},Ni.prototype._fireEvents=function(C,R){var F=this,V=Ms(this._eventsInProgress),ne=Ms(C),le={};for(var pe in C){var ye=C[pe].originalEvent;this._eventsInProgress[pe]||(le[pe+"start"]=ye),this._eventsInProgress[pe]=C[pe]}for(var Te in!V&&ne&&this._fireEvent("movestart",ne.originalEvent),le)this._fireEvent(Te,le[Te]);for(var Ne in C.rotate&&(this._bearingChanged=!0),ne&&this._fireEvent("move",ne.originalEvent),C){var Ge=C[Ne].originalEvent;this._fireEvent(Ne,Ge)}var nt,bt={};for(var Ct in this._eventsInProgress){var Tt=this._eventsInProgress[Ct],At=Tt.handlerName,yt=Tt.originalEvent;this._handlersById[At].isActive()||(delete this._eventsInProgress[Ct],nt=R[At]||yt,bt[Ct+"end"]=nt)}for(var Ft in bt)this._fireEvent(Ft,bt[Ft]);var zt=Ms(this._eventsInProgress);if((V||ne)&&!zt){this._updatingCamera=!0;var jt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),rr=function(hr){return hr!==0&&-F._bearingSnap<hr&&hr<F._bearingSnap};jt?(rr(jt.bearing||this._map.getBearing())&&(jt.bearing=0),this._map.easeTo(jt,{originalEvent:nt})):(this._map.fire(new e.Event("moveend",{originalEvent:nt})),rr(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Ni.prototype._fireEvent=function(C,R){this._map.fire(new e.Event(C,R?{originalEvent:R}:{}))},Ni.prototype._triggerRenderFrame=function(){var C=this;this._frameId===void 0&&(this._frameId=this._map._requestRenderFrame(function(R){delete C._frameId,C.handleEvent(new ys("renderFrame",{timeStamp:R})),C._applyChanges()}))};var dl=function(C){function R(F,V){C.call(this),this._moving=!1,this._zooming=!1,this.transform=F,this._bearingSnap=V.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},R.prototype.setCenter=function(F,V){return this.jumpTo({center:F},V)},R.prototype.panBy=function(F,V,ne){return F=e.Point.convert(F).mult(-1),this.panTo(this.transform.center,e.extend({offset:F},V),ne)},R.prototype.panTo=function(F,V,ne){return this.easeTo(e.extend({center:F},V),ne)},R.prototype.getZoom=function(){return this.transform.zoom},R.prototype.setZoom=function(F,V){return this.jumpTo({zoom:F},V),this},R.prototype.zoomTo=function(F,V,ne){return this.easeTo(e.extend({zoom:F},V),ne)},R.prototype.zoomIn=function(F,V){return this.zoomTo(this.getZoom()+1,F,V),this},R.prototype.zoomOut=function(F,V){return this.zoomTo(this.getZoom()-1,F,V),this},R.prototype.getBearing=function(){return this.transform.bearing},R.prototype.setBearing=function(F,V){return this.jumpTo({bearing:F},V),this},R.prototype.getPadding=function(){return this.transform.padding},R.prototype.setPadding=function(F,V){return this.jumpTo({padding:F},V),this},R.prototype.rotateTo=function(F,V,ne){return this.easeTo(e.extend({bearing:F},V),ne)},R.prototype.resetNorth=function(F,V){return this.rotateTo(0,e.extend({duration:1e3},F),V),this},R.prototype.resetNorthPitch=function(F,V){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},F),V),this},R.prototype.snapToNorth=function(F,V){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(F,V):this},R.prototype.getPitch=function(){return this.transform.pitch},R.prototype.setPitch=function(F,V){return this.jumpTo({pitch:F},V),this},R.prototype.cameraForBounds=function(F,V){return F=e.LngLatBounds.convert(F),this._cameraForBoxAndBearing(F.getNorthWest(),F.getSouthEast(),0,V)},R.prototype._cameraForBoxAndBearing=function(F,V,ne,le){var pe={top:0,bottom:0,right:0,left:0};if(typeof(le=e.extend({padding:pe,offset:[0,0],maxZoom:this.transform.maxZoom},le)).padding=="number"){var ye=le.padding;le.padding={top:ye,bottom:ye,right:ye,left:ye}}le.padding=e.extend(pe,le.padding);var Te=this.transform,Ne=Te.padding,Ge=Te.project(e.LngLat.convert(F)),nt=Te.project(e.LngLat.convert(V)),bt=Ge.rotate(-ne*Math.PI/180),Ct=nt.rotate(-ne*Math.PI/180),Tt=new e.Point(Math.max(bt.x,Ct.x),Math.max(bt.y,Ct.y)),At=new e.Point(Math.min(bt.x,Ct.x),Math.min(bt.y,Ct.y)),yt=Tt.sub(At),Ft=(Te.width-(Ne.left+Ne.right+le.padding.left+le.padding.right))/yt.x,zt=(Te.height-(Ne.top+Ne.bottom+le.padding.top+le.padding.bottom))/yt.y;if(!(zt<0||Ft<0)){var jt=Math.min(Te.scaleZoom(Te.scale*Math.min(Ft,zt)),le.maxZoom),rr=e.Point.convert(le.offset),hr=(le.padding.left-le.padding.right)/2,Ar=(le.padding.top-le.padding.bottom)/2,kr=new e.Point(rr.x+hr,rr.y+Ar).mult(Te.scale/Te.zoomScale(jt));return{center:Te.unproject(Ge.add(nt).div(2).sub(kr)),zoom:jt,bearing:ne}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},R.prototype.fitBounds=function(F,V,ne){return this._fitInternal(this.cameraForBounds(F,V),V,ne)},R.prototype.fitScreenCoordinates=function(F,V,ne,le,pe){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(F)),this.transform.pointLocation(e.Point.convert(V)),ne,le),le,pe)},R.prototype._fitInternal=function(F,V,ne){return F?(delete(V=e.extend(F,V)).padding,V.linear?this.easeTo(V,ne):this.flyTo(V,ne)):this},R.prototype.jumpTo=function(F,V){this.stop();var ne=this.transform,le=!1,pe=!1,ye=!1;return"zoom"in F&&ne.zoom!==+F.zoom&&(le=!0,ne.zoom=+F.zoom),F.center!==void 0&&(ne.center=e.LngLat.convert(F.center)),"bearing"in F&&ne.bearing!==+F.bearing&&(pe=!0,ne.bearing=+F.bearing),"pitch"in F&&ne.pitch!==+F.pitch&&(ye=!0,ne.pitch=+F.pitch),F.padding==null||ne.isPaddingEqual(F.padding)||(ne.padding=F.padding),this.fire(new e.Event("movestart",V)).fire(new e.Event("move",V)),le&&this.fire(new e.Event("zoomstart",V)).fire(new e.Event("zoom",V)).fire(new e.Event("zoomend",V)),pe&&this.fire(new e.Event("rotatestart",V)).fire(new e.Event("rotate",V)).fire(new e.Event("rotateend",V)),ye&&this.fire(new e.Event("pitchstart",V)).fire(new e.Event("pitch",V)).fire(new e.Event("pitchend",V)),this.fire(new e.Event("moveend",V))},R.prototype.easeTo=function(F,V){var ne=this;this._stop(!1,F.easeId),((F=e.extend({offset:[0,0],duration:500,easing:e.ease},F)).animate===!1||!F.essential&&e.browser.prefersReducedMotion)&&(F.duration=0);var le=this.transform,pe=this.getZoom(),ye=this.getBearing(),Te=this.getPitch(),Ne=this.getPadding(),Ge="zoom"in F?+F.zoom:pe,nt="bearing"in F?this._normalizeBearing(F.bearing,ye):ye,bt="pitch"in F?+F.pitch:Te,Ct="padding"in F?F.padding:le.padding,Tt=e.Point.convert(F.offset),At=le.centerPoint.add(Tt),yt=le.pointLocation(At),Ft=e.LngLat.convert(F.center||yt);this._normalizeCenter(Ft);var zt,jt,rr=le.project(yt),hr=le.project(Ft).sub(rr),Ar=le.zoomScale(Ge-pe);F.around&&(zt=e.LngLat.convert(F.around),jt=le.locationPoint(zt));var kr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Ge!==pe,this._rotating=this._rotating||ye!==nt,this._pitching=this._pitching||bt!==Te,this._padding=!le.isPaddingEqual(Ct),this._easeId=F.easeId,this._prepareEase(V,F.noMoveStart,kr),clearTimeout(this._easeEndTimeoutID),this._ease(function(Kr){if(ne._zooming&&(le.zoom=e.number(pe,Ge,Kr)),ne._rotating&&(le.bearing=e.number(ye,nt,Kr)),ne._pitching&&(le.pitch=e.number(Te,bt,Kr)),ne._padding&&(le.interpolatePadding(Ne,Ct,Kr),At=le.centerPoint.add(Tt)),zt)le.setLocationAtPoint(zt,jt);else{var Zr=le.zoomScale(le.zoom-pe),hn=Ge>pe?Math.min(2,Ar):Math.max(.5,Ar),sn=Math.pow(hn,1-Kr),Un=le.unproject(rr.add(hr.mult(Kr*sn)).mult(Zr));le.setLocationAtPoint(le.renderWorldCopies?Un.wrap():Un,At)}ne._fireMoveEvents(V)},function(Kr){ne._afterEase(V,Kr)},F),this},R.prototype._prepareEase=function(F,V,ne){ne===void 0&&(ne={}),this._moving=!0,V||ne.moving||this.fire(new e.Event("movestart",F)),this._zooming&&!ne.zooming&&this.fire(new e.Event("zoomstart",F)),this._rotating&&!ne.rotating&&this.fire(new e.Event("rotatestart",F)),this._pitching&&!ne.pitching&&this.fire(new e.Event("pitchstart",F))},R.prototype._fireMoveEvents=function(F){this.fire(new e.Event("move",F)),this._zooming&&this.fire(new e.Event("zoom",F)),this._rotating&&this.fire(new e.Event("rotate",F)),this._pitching&&this.fire(new e.Event("pitch",F))},R.prototype._afterEase=function(F,V){if(!this._easeId||!V||this._easeId!==V){delete this._easeId;var ne=this._zooming,le=this._rotating,pe=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,ne&&this.fire(new e.Event("zoomend",F)),le&&this.fire(new e.Event("rotateend",F)),pe&&this.fire(new e.Event("pitchend",F)),this.fire(new e.Event("moveend",F))}},R.prototype.flyTo=function(F,V){var ne=this;if(!F.essential&&e.browser.prefersReducedMotion){var le=e.pick(F,["center","zoom","bearing","pitch","around"]);return this.jumpTo(le,V)}this.stop(),F=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},F);var pe=this.transform,ye=this.getZoom(),Te=this.getBearing(),Ne=this.getPitch(),Ge=this.getPadding(),nt="zoom"in F?e.clamp(+F.zoom,pe.minZoom,pe.maxZoom):ye,bt="bearing"in F?this._normalizeBearing(F.bearing,Te):Te,Ct="pitch"in F?+F.pitch:Ne,Tt="padding"in F?F.padding:pe.padding,At=pe.zoomScale(nt-ye),yt=e.Point.convert(F.offset),Ft=pe.centerPoint.add(yt),zt=pe.pointLocation(Ft),jt=e.LngLat.convert(F.center||zt);this._normalizeCenter(jt);var rr=pe.project(zt),hr=pe.project(jt).sub(rr),Ar=F.curve,kr=Math.max(pe.width,pe.height),Kr=kr/At,Zr=hr.mag();if("minZoom"in F){var hn=e.clamp(Math.min(F.minZoom,ye,nt),pe.minZoom,pe.maxZoom),sn=kr/pe.zoomScale(hn-ye);Ar=Math.sqrt(sn/Zr*2)}var Un=Ar*Ar;function Wn(Kn){var xa=(Kr*Kr-kr*kr+(Kn?-1:1)*Un*Un*Zr*Zr)/(2*(Kn?Kr:kr)*Un*Zr);return Math.log(Math.sqrt(xa*xa+1)-xa)}function ua(Kn){return(Math.exp(Kn)-Math.exp(-Kn))/2}function Ur(Kn){return(Math.exp(Kn)+Math.exp(-Kn))/2}var kn=Wn(0),Xn=function(Kn){return Ur(kn)/Ur(kn+Ar*Kn)},Gn=function(Kn){return kr*((Ur(kn)*(ua(xa=kn+Ar*Kn)/Ur(xa))-ua(kn))/Un)/Zr;var xa},ea=(Wn(1)-kn)/Ar;if(Math.abs(Zr)<1e-6||!isFinite(ea)){if(Math.abs(kr-Kr)<1e-6)return this.easeTo(F,V);var fa=Kr<kr?-1:1;ea=Math.abs(Math.log(Kr/kr))/Ar,Gn=function(){return 0},Xn=function(Kn){return Math.exp(fa*Ar*Kn)}}if("duration"in F)F.duration=+F.duration;else{var Ma="screenSpeed"in F?+F.screenSpeed/Ar:+F.speed;F.duration=1e3*ea/Ma}return F.maxDuration&&F.duration>F.maxDuration&&(F.duration=0),this._zooming=!0,this._rotating=Te!==bt,this._pitching=Ct!==Ne,this._padding=!pe.isPaddingEqual(Tt),this._prepareEase(V,!1),this._ease(function(Kn){var xa=Kn*ea,ma=1/Xn(xa);pe.zoom=Kn===1?nt:ye+pe.scaleZoom(ma),ne._rotating&&(pe.bearing=e.number(Te,bt,Kn)),ne._pitching&&(pe.pitch=e.number(Ne,Ct,Kn)),ne._padding&&(pe.interpolatePadding(Ge,Tt,Kn),Ft=pe.centerPoint.add(yt));var La=Kn===1?jt:pe.unproject(rr.add(hr.mult(Gn(xa))).mult(ma));pe.setLocationAtPoint(pe.renderWorldCopies?La.wrap():La,Ft),ne._fireMoveEvents(V)},function(){return ne._afterEase(V)},F),this},R.prototype.isEasing=function(){return!!this._easeFrameId},R.prototype.stop=function(){return this._stop()},R.prototype._stop=function(F,V){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var ne=this._onEaseEnd;delete this._onEaseEnd,ne.call(this,V)}if(!F){var le=this.handlers;le&&le.stop()}return this},R.prototype._ease=function(F,V,ne){ne.animate===!1||ne.duration===0?(F(1),V()):(this._easeStart=e.browser.now(),this._easeOptions=ne,this._onEaseFrame=F,this._onEaseEnd=V,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},R.prototype._renderFrameCallback=function(){var F=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(F)),F<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},R.prototype._normalizeBearing=function(F,V){F=e.wrap(F,-180,180);var ne=Math.abs(F-V);return Math.abs(F-360-V)<ne&&(F-=360),Math.abs(F+360-V)<ne&&(F+=360),F},R.prototype._normalizeCenter=function(F){var V=this.transform;if(V.renderWorldCopies&&!V.lngRange){var ne=F.lng-V.center.lng;F.lng+=ne>180?-360:ne<-180?360:0}},R}(e.Evented),ji=function(C){C===void 0&&(C={}),this.options=C,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};ji.prototype.getDefaultPosition=function(){return"bottom-right"},ji.prototype.onAdd=function(C){var R=this.options&&this.options.compact;return this._map=C,this._container=l.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=l.create("div","mapboxgl-ctrl-attrib-inner",this._container),R&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),R===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},ji.prototype.onRemove=function(){l.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},ji.prototype._updateEditLink=function(){var C=this._editLink;C||(C=this._editLink=this._container.querySelector(".mapbox-improve-map"));var R=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(C){var F=R.reduce(function(V,ne,le){return ne.value&&(V+=ne.key+"="+ne.value+(le<R.length-1?"&":"")),V},"?");C.href=e.config.FEEDBACK_URL+"/"+F+(this._map._hash?this._map._hash.getHashString(!0):""),C.rel="noopener nofollow"}},ji.prototype._updateData=function(C){!C||C.sourceDataType!=="metadata"&&C.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},ji.prototype._updateAttributions=function(){if(this._map.style){var C=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?C=C.concat(this.options.customAttribution.map(function(ye){return typeof ye!="string"?"":ye})):typeof this.options.customAttribution=="string"&&C.push(this.options.customAttribution)),this._map.style.stylesheet){var R=this._map.style.stylesheet;this.styleOwner=R.owner,this.styleId=R.id}var F=this._map.style.sourceCaches;for(var V in F){var ne=F[V];if(ne.used){var le=ne.getSource();le.attribution&&C.indexOf(le.attribution)<0&&C.push(le.attribution)}}C.sort(function(ye,Te){return ye.length-Te.length});var pe=(C=C.filter(function(ye,Te){for(var Ne=Te+1;Ne<C.length;Ne++)if(C[Ne].indexOf(ye)>=0)return!1;return!0})).join(" | ");pe!==this._attribHTML&&(this._attribHTML=pe,C.length?(this._innerContainer.innerHTML=pe,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},ji.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var xs=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};xs.prototype.onAdd=function(C){this._map=C,this._container=l.create("div","mapboxgl-ctrl");var R=l.create("a","mapboxgl-ctrl-logo");return R.target="_blank",R.rel="noopener nofollow",R.href="https://www.mapbox.com/",R.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),R.setAttribute("rel","noopener nofollow"),this._container.appendChild(R),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},xs.prototype.onRemove=function(){l.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},xs.prototype.getDefaultPosition=function(){return"bottom-left"},xs.prototype._updateLogo=function(C){C&&C.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},xs.prototype._logoRequired=function(){if(this._map.style){var C=this._map.style.sourceCaches;for(var R in C)if(C[R].getSource().mapbox_logo)return!0;return!1}},xs.prototype._updateCompact=function(){var C=this._container.children;if(C.length){var R=C[0];this._map.getCanvasContainer().offsetWidth<250?R.classList.add("mapboxgl-compact"):R.classList.remove("mapboxgl-compact")}};var la=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};la.prototype.add=function(C){var R=++this._id;return this._queue.push({callback:C,id:R,cancelled:!1}),R},la.prototype.remove=function(C){for(var R=this._currentlyRunning,F=0,V=R?this._queue.concat(R):this._queue;F<V.length;F+=1){var ne=V[F];if(ne.id===C)return void(ne.cancelled=!0)}},la.prototype.run=function(C){C===void 0&&(C=0);var R=this._currentlyRunning=this._queue;this._queue=[];for(var F=0,V=R;F<V.length;F+=1){var ne=V[F];if(!ne.cancelled&&(ne.callback(C),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},la.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ya={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},ml=e.window.HTMLImageElement,vl=e.window.HTMLElement,bs=e.window.ImageBitmap,Go={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},is=function(C){function R(V){var ne=this;if((V=e.extend({},Go,V)).minZoom!=null&&V.maxZoom!=null&&V.minZoom>V.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(V.minPitch!=null&&V.maxPitch!=null&&V.minPitch>V.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(V.minPitch!=null&&V.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(V.maxPitch!=null&&V.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var le=new Vt(V.minZoom,V.maxZoom,V.minPitch,V.maxPitch,V.renderWorldCopies);if(C.call(this,le,V),this._interactive=V.interactive,this._maxTileCacheSize=V.maxTileCacheSize,this._failIfMajorPerformanceCaveat=V.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=V.preserveDrawingBuffer,this._antialias=V.antialias,this._trackResize=V.trackResize,this._bearingSnap=V.bearingSnap,this._refreshExpiredTiles=V.refreshExpiredTiles,this._fadeDuration=V.fadeDuration,this._crossSourceCollisions=V.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=V.collectResourceTiming,this._renderTaskQueue=new la,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},ya,V.locale),this._requestManager=new e.RequestManager(V.transformRequest,V.accessToken),typeof V.container=="string"){if(this._container=e.window.document.getElementById(V.container),!this._container)throw new Error("Container '"+V.container+"' not found.")}else{if(!(V.container instanceof vl))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=V.container}if(V.maxBounds&&this.setMaxBounds(V.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return ne._update(!1)}),this.on("moveend",function(){return ne._update(!1)}),this.on("zoom",function(){return ne._update(!0)}),e.window!==void 0&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Ni(this,V);var pe=typeof V.hash=="string"&&V.hash||void 0;this._hash=V.hash&&new Lr(pe).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:V.center,zoom:V.zoom,bearing:V.bearing,pitch:V.pitch}),V.bounds&&(this.resize(),this.fitBounds(V.bounds,e.extend({},V.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=V.localIdeographFontFamily,V.style&&this.setStyle(V.style,{localIdeographFontFamily:V.localIdeographFontFamily}),V.attributionControl&&this.addControl(new ji({customAttribution:V.customAttribution})),this.addControl(new xs,V.logoPosition),this.on("style.load",function(){ne.transform.unmodified&&ne.jumpTo(ne.style.stylesheet)}),this.on("data",function(ye){ne._update(ye.dataType==="style"),ne.fire(new e.Event(ye.dataType+"data",ye))}),this.on("dataloading",function(ye){ne.fire(new e.Event(ye.dataType+"dataloading",ye))})}C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R;var F={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return R.prototype._getMapId=function(){return this._mapId},R.prototype.addControl=function(V,ne){if(ne===void 0&&V.getDefaultPosition&&(ne=V.getDefaultPosition()),ne===void 0&&(ne="top-right"),!V||!V.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var le=V.onAdd(this);this._controls.push(V);var pe=this._controlPositions[ne];return ne.indexOf("bottom")!==-1?pe.insertBefore(le,pe.firstChild):pe.appendChild(le),this},R.prototype.removeControl=function(V){if(!V||!V.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var ne=this._controls.indexOf(V);return ne>-1&&this._controls.splice(ne,1),V.onRemove(this),this},R.prototype.resize=function(V){var ne=this._containerDimensions(),le=ne[0],pe=ne[1];this._resizeCanvas(le,pe),this.transform.resize(le,pe),this.painter.resize(le,pe);var ye=!this._moving;return ye&&(this.stop(),this.fire(new e.Event("movestart",V)).fire(new e.Event("move",V))),this.fire(new e.Event("resize",V)),ye&&this.fire(new e.Event("moveend",V)),this},R.prototype.getBounds=function(){return this.transform.getBounds()},R.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},R.prototype.setMaxBounds=function(V){return this.transform.setMaxBounds(e.LngLatBounds.convert(V)),this._update()},R.prototype.setMinZoom=function(V){if((V=V==null?-2:V)>=-2&&V<=this.transform.maxZoom)return this.transform.minZoom=V,this._update(),this.getZoom()<V&&this.setZoom(V),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},R.prototype.getMinZoom=function(){return this.transform.minZoom},R.prototype.setMaxZoom=function(V){if((V=V==null?22:V)>=this.transform.minZoom)return this.transform.maxZoom=V,this._update(),this.getZoom()>V&&this.setZoom(V),this;throw new Error("maxZoom must be greater than the current minZoom")},R.prototype.getMaxZoom=function(){return this.transform.maxZoom},R.prototype.setMinPitch=function(V){if((V=V==null?0:V)<0)throw new Error("minPitch must be greater than or equal to 0");if(V>=0&&V<=this.transform.maxPitch)return this.transform.minPitch=V,this._update(),this.getPitch()<V&&this.setPitch(V),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},R.prototype.getMinPitch=function(){return this.transform.minPitch},R.prototype.setMaxPitch=function(V){if((V=V==null?60:V)>60)throw new Error("maxPitch must be less than or equal to 60");if(V>=this.transform.minPitch)return this.transform.maxPitch=V,this._update(),this.getPitch()>V&&this.setPitch(V),this;throw new Error("maxPitch must be greater than the current minPitch")},R.prototype.getMaxPitch=function(){return this.transform.maxPitch},R.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},R.prototype.setRenderWorldCopies=function(V){return this.transform.renderWorldCopies=V,this._update()},R.prototype.project=function(V){return this.transform.locationPoint(e.LngLat.convert(V))},R.prototype.unproject=function(V){return this.transform.pointLocation(e.Point.convert(V))},R.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},R.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},R.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},R.prototype._createDelegatedListener=function(V,ne,le){var pe,ye=this;if(V==="mouseenter"||V==="mouseover"){var Te=!1;return{layer:ne,listener:le,delegates:{mousemove:function(Ge){var nt=ye.getLayer(ne)?ye.queryRenderedFeatures(Ge.point,{layers:[ne]}):[];nt.length?Te||(Te=!0,le.call(ye,new Rn(V,ye,Ge.originalEvent,{features:nt}))):Te=!1},mouseout:function(){Te=!1}}}}if(V==="mouseleave"||V==="mouseout"){var Ne=!1;return{layer:ne,listener:le,delegates:{mousemove:function(Ge){(ye.getLayer(ne)?ye.queryRenderedFeatures(Ge.point,{layers:[ne]}):[]).length?Ne=!0:Ne&&(Ne=!1,le.call(ye,new Rn(V,ye,Ge.originalEvent)))},mouseout:function(Ge){Ne&&(Ne=!1,le.call(ye,new Rn(V,ye,Ge.originalEvent)))}}}}return{layer:ne,listener:le,delegates:(pe={},pe[V]=function(Ge){var nt=ye.getLayer(ne)?ye.queryRenderedFeatures(Ge.point,{layers:[ne]}):[];nt.length&&(Ge.features=nt,le.call(ye,Ge),delete Ge.features)},pe)}},R.prototype.on=function(V,ne,le){if(le===void 0)return C.prototype.on.call(this,V,ne);var pe=this._createDelegatedListener(V,ne,le);for(var ye in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[V]=this._delegatedListeners[V]||[],this._delegatedListeners[V].push(pe),pe.delegates)this.on(ye,pe.delegates[ye]);return this},R.prototype.once=function(V,ne,le){if(le===void 0)return C.prototype.once.call(this,V,ne);var pe=this._createDelegatedListener(V,ne,le);for(var ye in pe.delegates)this.once(ye,pe.delegates[ye]);return this},R.prototype.off=function(V,ne,le){var pe=this;return le===void 0?C.prototype.off.call(this,V,ne):(this._delegatedListeners&&this._delegatedListeners[V]&&function(ye){for(var Te=ye[V],Ne=0;Ne<Te.length;Ne++){var Ge=Te[Ne];if(Ge.layer===ne&&Ge.listener===le){for(var nt in Ge.delegates)pe.off(nt,Ge.delegates[nt]);return Te.splice(Ne,1),pe}}}(this._delegatedListeners),this)},R.prototype.queryRenderedFeatures=function(V,ne){if(!this.style)return[];var le;if(ne!==void 0||V===void 0||V instanceof e.Point||Array.isArray(V)||(ne=V,V=void 0),ne=ne||{},(V=V||[[0,0],[this.transform.width,this.transform.height]])instanceof e.Point||typeof V[0]=="number")le=[e.Point.convert(V)];else{var pe=e.Point.convert(V[0]),ye=e.Point.convert(V[1]);le=[pe,new e.Point(ye.x,pe.y),ye,new e.Point(pe.x,ye.y),pe]}return this.style.queryRenderedFeatures(le,ne,this.transform)},R.prototype.querySourceFeatures=function(V,ne){return this.style.querySourceFeatures(V,ne)},R.prototype.setStyle=function(V,ne){return(ne=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},ne)).diff!==!1&&ne.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&V?(this._diffStyle(V,ne),this):(this._localIdeographFontFamily=ne.localIdeographFontFamily,this._updateStyle(V,ne))},R.prototype._getUIString=function(V){var ne=this._locale[V];if(ne==null)throw new Error("Missing UI string '"+V+"'");return ne},R.prototype._updateStyle=function(V,ne){return this.style&&(this.style.setEventedParent(null),this.style._remove()),V?(this.style=new Yn(this,ne||{}),this.style.setEventedParent(this,{style:this.style}),typeof V=="string"?this.style.loadURL(V):this.style.loadJSON(V),this):(delete this.style,this)},R.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Yn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},R.prototype._diffStyle=function(V,ne){var le=this;if(typeof V=="string"){var pe=this._requestManager.normalizeStyleURL(V),ye=this._requestManager.transformRequest(pe,e.ResourceType.Style);e.getJSON(ye,function(Te,Ne){Te?le.fire(new e.ErrorEvent(Te)):Ne&&le._updateDiff(Ne,ne)})}else typeof V=="object"&&this._updateDiff(V,ne)},R.prototype._updateDiff=function(V,ne){try{this.style.setState(V)&&this._update(!0)}catch(le){e.warnOnce("Unable to perform style diff: "+(le.message||le.error||le)+".  Rebuilding the style from scratch."),this._updateStyle(V,ne)}},R.prototype.getStyle=function(){if(this.style)return this.style.serialize()},R.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},R.prototype.addSource=function(V,ne){return this._lazyInitEmptyStyle(),this.style.addSource(V,ne),this._update(!0)},R.prototype.isSourceLoaded=function(V){var ne=this.style&&this.style.sourceCaches[V];if(ne!==void 0)return ne.loaded();this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+V+"'")))},R.prototype.areTilesLoaded=function(){var V=this.style&&this.style.sourceCaches;for(var ne in V){var le=V[ne]._tiles;for(var pe in le){var ye=le[pe];if(ye.state!=="loaded"&&ye.state!=="errored")return!1}}return!0},R.prototype.addSourceType=function(V,ne,le){return this._lazyInitEmptyStyle(),this.style.addSourceType(V,ne,le)},R.prototype.removeSource=function(V){return this.style.removeSource(V),this._update(!0)},R.prototype.getSource=function(V){return this.style.getSource(V)},R.prototype.addImage=function(V,ne,le){le===void 0&&(le={});var pe=le.pixelRatio;pe===void 0&&(pe=1);var ye=le.sdf;ye===void 0&&(ye=!1);var Te=le.stretchX,Ne=le.stretchY,Ge=le.content;if(this._lazyInitEmptyStyle(),ne instanceof ml||bs&&ne instanceof bs){var nt=e.browser.getImageData(ne),bt=nt.width,Ct=nt.height,Tt=nt.data;this.style.addImage(V,{data:new e.RGBAImage({width:bt,height:Ct},Tt),pixelRatio:pe,stretchX:Te,stretchY:Ne,content:Ge,sdf:ye,version:0})}else{if(ne.width===void 0||ne.height===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var At=ne.width,yt=ne.height,Ft=ne.data,zt=ne;this.style.addImage(V,{data:new e.RGBAImage({width:At,height:yt},new Uint8Array(Ft)),pixelRatio:pe,stretchX:Te,stretchY:Ne,content:Ge,sdf:ye,version:0,userImage:zt}),zt.onAdd&&zt.onAdd(this,V)}},R.prototype.updateImage=function(V,ne){var le=this.style.getImage(V);if(!le)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var pe=ne instanceof ml||bs&&ne instanceof bs?e.browser.getImageData(ne):ne,ye=pe.width,Te=pe.height,Ne=pe.data;if(ye===void 0||Te===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(ye!==le.data.width||Te!==le.data.height)return this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var Ge=!(ne instanceof ml||bs&&ne instanceof bs);le.data.replace(Ne,Ge),this.style.updateImage(V,le)},R.prototype.hasImage=function(V){return V?!!this.style.getImage(V):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},R.prototype.removeImage=function(V){this.style.removeImage(V)},R.prototype.loadImage=function(V,ne){e.getImage(this._requestManager.transformRequest(V,e.ResourceType.Image),ne)},R.prototype.listImages=function(){return this.style.listImages()},R.prototype.addLayer=function(V,ne){return this._lazyInitEmptyStyle(),this.style.addLayer(V,ne),this._update(!0)},R.prototype.moveLayer=function(V,ne){return this.style.moveLayer(V,ne),this._update(!0)},R.prototype.removeLayer=function(V){return this.style.removeLayer(V),this._update(!0)},R.prototype.getLayer=function(V){return this.style.getLayer(V)},R.prototype.setLayerZoomRange=function(V,ne,le){return this.style.setLayerZoomRange(V,ne,le),this._update(!0)},R.prototype.setFilter=function(V,ne,le){return le===void 0&&(le={}),this.style.setFilter(V,ne,le),this._update(!0)},R.prototype.getFilter=function(V){return this.style.getFilter(V)},R.prototype.setPaintProperty=function(V,ne,le,pe){return pe===void 0&&(pe={}),this.style.setPaintProperty(V,ne,le,pe),this._update(!0)},R.prototype.getPaintProperty=function(V,ne){return this.style.getPaintProperty(V,ne)},R.prototype.setLayoutProperty=function(V,ne,le,pe){return pe===void 0&&(pe={}),this.style.setLayoutProperty(V,ne,le,pe),this._update(!0)},R.prototype.getLayoutProperty=function(V,ne){return this.style.getLayoutProperty(V,ne)},R.prototype.setLight=function(V,ne){return ne===void 0&&(ne={}),this._lazyInitEmptyStyle(),this.style.setLight(V,ne),this._update(!0)},R.prototype.getLight=function(){return this.style.getLight()},R.prototype.setFeatureState=function(V,ne){return this.style.setFeatureState(V,ne),this._update()},R.prototype.removeFeatureState=function(V,ne){return this.style.removeFeatureState(V,ne),this._update()},R.prototype.getFeatureState=function(V){return this.style.getFeatureState(V)},R.prototype.getContainer=function(){return this._container},R.prototype.getCanvasContainer=function(){return this._canvasContainer},R.prototype.getCanvas=function(){return this._canvas},R.prototype._containerDimensions=function(){var V=0,ne=0;return this._container&&(V=this._container.clientWidth||400,ne=this._container.clientHeight||300),[V,ne]},R.prototype._detectMissingCSS=function(){e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},R.prototype._setupContainer=function(){var V=this._container;V.classList.add("mapboxgl-map"),(this._missingCSSCanary=l.create("div","mapboxgl-canary",V)).style.visibility="hidden",this._detectMissingCSS();var ne=this._canvasContainer=l.create("div","mapboxgl-canvas-container",V);this._interactive&&ne.classList.add("mapboxgl-interactive"),this._canvas=l.create("canvas","mapboxgl-canvas",ne),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var le=this._containerDimensions();this._resizeCanvas(le[0],le[1]);var pe=this._controlContainer=l.create("div","mapboxgl-control-container",V),ye=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Te){ye[Te]=l.create("div","mapboxgl-ctrl-"+Te,pe)})},R.prototype._resizeCanvas=function(V,ne){var le=e.browser.devicePixelRatio||1;this._canvas.width=le*V,this._canvas.height=le*ne,this._canvas.style.width=V+"px",this._canvas.style.height=ne+"px"},R.prototype._setupPainter=function(){var V=e.extend({},f.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),ne=this._canvas.getContext("webgl",V)||this._canvas.getContext("experimental-webgl",V);ne?(this.painter=new Oa(ne,this.transform),e.webpSupported.testSupport(ne)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))},R.prototype._contextLost=function(V){V.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:V}))},R.prototype._contextRestored=function(V){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:V}))},R.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},R.prototype._update=function(V){return this.style?(this._styleDirty=this._styleDirty||V,this._sourcesDirty=!0,this.triggerRepaint(),this):this},R.prototype._requestRenderFrame=function(V){return this._update(),this._renderTaskQueue.add(V)},R.prototype._cancelRenderFrame=function(V){this._renderTaskQueue.remove(V)},R.prototype._render=function(V){var ne,le=this,pe=0,ye=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(ne=ye.createQueryEXT(),ye.beginQueryEXT(ye.TIME_ELAPSED_EXT,ne),pe=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(V),!this._removed){var Te=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ne=this.transform.zoom,Ge=e.browser.now();this.style.zoomHistory.update(Ne,Ge);var nt=new e.EvaluationParameters(Ne,{now:Ge,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),bt=nt.crossFadingFactor();bt===1&&bt===this._crossFadingFactor||(Te=!0,this._crossFadingFactor=bt),this.style.update(nt)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||Te)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ct=e.browser.now()-pe;ye.endQueryEXT(ye.TIME_ELAPSED_EXT,ne),setTimeout(function(){var At=ye.getQueryObjectEXT(ne,ye.QUERY_RESULT_EXT)/1e6;ye.deleteQueryEXT(ne),le.fire(new e.Event("gpu-timing-frame",{cpuTime:Ct,gpuTime:At}))},50)}if(this.listens("gpu-timing-layer")){var Tt=this.painter.collectGpuTimers();setTimeout(function(){var At=le.painter.queryGpuTimers(Tt);le.fire(new e.Event("gpu-timing-layer",{layerTimes:At}))},50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},R.prototype.remove=function(){this._hash&&this._hash.remove();for(var V=0,ne=this._controls;V<ne.length;V+=1)ne[V].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),e.window!==void 0&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var le=this.painter.context.gl.getExtension("WEBGL_lose_context");le&&le.loseContext(),Il(this._canvasContainer),Il(this._controlContainer),Il(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},R.prototype.triggerRepaint=function(){var V=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(ne){V._frame=null,V._render(ne)}))},R.prototype._onWindowOnline=function(){this._update()},R.prototype._onWindowResize=function(V){this._trackResize&&this.resize({originalEvent:V})._update()},F.showTileBoundaries.get=function(){return!!this._showTileBoundaries},F.showTileBoundaries.set=function(V){this._showTileBoundaries!==V&&(this._showTileBoundaries=V,this._update())},F.showPadding.get=function(){return!!this._showPadding},F.showPadding.set=function(V){this._showPadding!==V&&(this._showPadding=V,this._update())},F.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},F.showCollisionBoxes.set=function(V){this._showCollisionBoxes!==V&&(this._showCollisionBoxes=V,V?this.style._generateCollisionBoxes():this._update())},F.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},F.showOverdrawInspector.set=function(V){this._showOverdrawInspector!==V&&(this._showOverdrawInspector=V,this._update())},F.repaint.get=function(){return!!this._repaint},F.repaint.set=function(V){this._repaint!==V&&(this._repaint=V,this.triggerRepaint())},F.vertices.get=function(){return!!this._vertices},F.vertices.set=function(V){this._vertices=V,this._update()},R.prototype._setCacheLimits=function(V,ne){e.setCacheLimits(V,ne)},F.version.get=function(){return e.version},Object.defineProperties(R.prototype,F),R}(dl);function Il(C){C.parentNode&&C.parentNode.removeChild(C)}var $s={showCompass:!0,showZoom:!0,visualizePitch:!1},Ja=function(C){var R=this;this.options=e.extend({},$s,C),this._container=l.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(F){return F.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(F){return R._map.zoomIn({},{originalEvent:F})}),l.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(F){return R._map.zoomOut({},{originalEvent:F})}),l.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(F){R.options.visualizePitch?R._map.resetNorthPitch({},{originalEvent:F}):R._map.resetNorth({},{originalEvent:F})}),this._compassIcon=l.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Ja.prototype._updateZoomButtons=function(){var C=this._map.getZoom();this._zoomInButton.disabled=C===this._map.getMaxZoom(),this._zoomOutButton.disabled=C===this._map.getMinZoom()},Ja.prototype._rotateCompassArrow=function(){var C=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=C},Ja.prototype.onAdd=function(C){return this._map=C,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new oi(this._map,this._compass,this.options.visualizePitch)),this._container},Ja.prototype.onRemove=function(){l.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Ja.prototype._createButton=function(C,R){var F=l.create("button",C,this._container);return F.type="button",F.addEventListener("click",R),F},Ja.prototype._setButtonTitle=function(C,R){var F=this._map._getUIString("NavigationControl."+R);C.title=F,C.setAttribute("aria-label",F)};var oi=function(C,R,F){F===void 0&&(F=!1),this._clickTolerance=10,this.element=R,this.mouseRotate=new Sa({clickTolerance:C.dragRotate._mouseRotate._clickTolerance}),this.map=C,F&&(this.mousePitch=new da({clickTolerance:C.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener(R,"mousedown",this.mousedown),l.addEventListener(R,"touchstart",this.touchstart,{passive:!1}),l.addEventListener(R,"touchmove",this.touchmove),l.addEventListener(R,"touchend",this.touchend),l.addEventListener(R,"touchcancel",this.reset)};function Rs(C,R,F){if(C=new e.LngLat(C.lng,C.lat),R){var V=new e.LngLat(C.lng-360,C.lat),ne=new e.LngLat(C.lng+360,C.lat),le=F.locationPoint(C).distSqr(R);F.locationPoint(V).distSqr(R)<le?C=V:F.locationPoint(ne).distSqr(R)<le&&(C=ne)}for(;Math.abs(C.lng-F.center.lng)>180;){var pe=F.locationPoint(C);if(pe.x>=0&&pe.y>=0&&pe.x<=F.width&&pe.y<=F.height)break;C.lng>F.center.lng?C.lng-=360:C.lng+=360}return C}oi.prototype.down=function(C,R){this.mouseRotate.mousedown(C,R),this.mousePitch&&this.mousePitch.mousedown(C,R),l.disableDrag()},oi.prototype.move=function(C,R){var F=this.map,V=this.mouseRotate.mousemoveWindow(C,R);if(V&&V.bearingDelta&&F.setBearing(F.getBearing()+V.bearingDelta),this.mousePitch){var ne=this.mousePitch.mousemoveWindow(C,R);ne&&ne.pitchDelta&&F.setPitch(F.getPitch()+ne.pitchDelta)}},oi.prototype.off=function(){var C=this.element;l.removeEventListener(C,"mousedown",this.mousedown),l.removeEventListener(C,"touchstart",this.touchstart,{passive:!1}),l.removeEventListener(C,"touchmove",this.touchmove),l.removeEventListener(C,"touchend",this.touchend),l.removeEventListener(C,"touchcancel",this.reset),this.offTemp()},oi.prototype.offTemp=function(){l.enableDrag(),l.removeEventListener(e.window,"mousemove",this.mousemove),l.removeEventListener(e.window,"mouseup",this.mouseup)},oi.prototype.mousedown=function(C){this.down(e.extend({},C,{ctrlKey:!0,preventDefault:function(){return C.preventDefault()}}),l.mousePos(this.element,C)),l.addEventListener(e.window,"mousemove",this.mousemove),l.addEventListener(e.window,"mouseup",this.mouseup)},oi.prototype.mousemove=function(C){this.move(C,l.mousePos(this.element,C))},oi.prototype.mouseup=function(C){this.mouseRotate.mouseupWindow(C),this.mousePitch&&this.mousePitch.mouseupWindow(C),this.offTemp()},oi.prototype.touchstart=function(C){C.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=l.touchPos(this.element,C.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return C.preventDefault()}},this._startPos))},oi.prototype.touchmove=function(C){C.targetTouches.length!==1?this.reset():(this._lastPos=l.touchPos(this.element,C.targetTouches)[0],this.move({preventDefault:function(){return C.preventDefault()}},this._lastPos))},oi.prototype.touchend=function(C){C.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},oi.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Ss={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function zi(C,R,F){var V=C.classList;for(var ne in Ss)V.remove("mapboxgl-"+F+"-anchor-"+ne);V.add("mapboxgl-"+F+"-anchor-"+R)}var Fs,Qs=function(C){function R(F,V){var ne=this;if(C.call(this),(F instanceof e.window.HTMLElement||V)&&(F=e.extend({element:F},V)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=F&&F.anchor||"center",this._color=F&&F.color||"#3FB1CE",this._draggable=F&&F.draggable||!1,this._state="inactive",this._rotation=F&&F.rotation||0,this._rotationAlignment=F&&F.rotationAlignment||"auto",this._pitchAlignment=F&&F.pitchAlignment&&F.pitchAlignment!=="auto"?F.pitchAlignment:this._rotationAlignment,F&&F.element)this._element=F.element,this._offset=e.Point.convert(F&&F.offset||[0,0]);else{this._defaultMarker=!0,this._element=l.create("div"),this._element.setAttribute("aria-label","Map marker");var le=l.createNS("http://www.w3.org/2000/svg","svg");le.setAttributeNS(null,"display","block"),le.setAttributeNS(null,"height","41px"),le.setAttributeNS(null,"width","27px"),le.setAttributeNS(null,"viewBox","0 0 27 41");var pe=l.createNS("http://www.w3.org/2000/svg","g");pe.setAttributeNS(null,"stroke","none"),pe.setAttributeNS(null,"stroke-width","1"),pe.setAttributeNS(null,"fill","none"),pe.setAttributeNS(null,"fill-rule","evenodd");var ye=l.createNS("http://www.w3.org/2000/svg","g");ye.setAttributeNS(null,"fill-rule","nonzero");var Te=l.createNS("http://www.w3.org/2000/svg","g");Te.setAttributeNS(null,"transform","translate(3.0, 29.0)"),Te.setAttributeNS(null,"fill","#000000");for(var Ne=0,Ge=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Ne<Ge.length;Ne+=1){var nt=Ge[Ne],bt=l.createNS("http://www.w3.org/2000/svg","ellipse");bt.setAttributeNS(null,"opacity","0.04"),bt.setAttributeNS(null,"cx","10.5"),bt.setAttributeNS(null,"cy","5.80029008"),bt.setAttributeNS(null,"rx",nt.rx),bt.setAttributeNS(null,"ry",nt.ry),Te.appendChild(bt)}var Ct=l.createNS("http://www.w3.org/2000/svg","g");Ct.setAttributeNS(null,"fill",this._color);var Tt=l.createNS("http://www.w3.org/2000/svg","path");Tt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Ct.appendChild(Tt);var At=l.createNS("http://www.w3.org/2000/svg","g");At.setAttributeNS(null,"opacity","0.25"),At.setAttributeNS(null,"fill","#000000");var yt=l.createNS("http://www.w3.org/2000/svg","path");yt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),At.appendChild(yt);var Ft=l.createNS("http://www.w3.org/2000/svg","g");Ft.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ft.setAttributeNS(null,"fill","#FFFFFF");var zt=l.createNS("http://www.w3.org/2000/svg","g");zt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var jt=l.createNS("http://www.w3.org/2000/svg","circle");jt.setAttributeNS(null,"fill","#000000"),jt.setAttributeNS(null,"opacity","0.25"),jt.setAttributeNS(null,"cx","5.5"),jt.setAttributeNS(null,"cy","5.5"),jt.setAttributeNS(null,"r","5.4999962");var rr=l.createNS("http://www.w3.org/2000/svg","circle");rr.setAttributeNS(null,"fill","#FFFFFF"),rr.setAttributeNS(null,"cx","5.5"),rr.setAttributeNS(null,"cy","5.5"),rr.setAttributeNS(null,"r","5.4999962"),zt.appendChild(jt),zt.appendChild(rr),ye.appendChild(Te),ye.appendChild(Ct),ye.appendChild(At),ye.appendChild(Ft),ye.appendChild(zt),le.appendChild(ye),this._element.appendChild(le),this._offset=e.Point.convert(F&&F.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(hr){hr.preventDefault()}),this._element.addEventListener("mousedown",function(hr){hr.preventDefault()}),this._element.addEventListener("focus",function(){var hr=ne._map.getContainer();hr.scrollTop=0,hr.scrollLeft=0}),zi(this._element,this._anchor,"marker"),this._popup=null}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.addTo=function(F){return this.remove(),this._map=F,F.getCanvasContainer().appendChild(this._element),F.on("move",this._update),F.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},R.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),l.remove(this._element),this._popup&&this._popup.remove(),this},R.prototype.getLngLat=function(){return this._lngLat},R.prototype.setLngLat=function(F){return this._lngLat=e.LngLat.convert(F),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},R.prototype.getElement=function(){return this._element},R.prototype.setPopup=function(F){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),F){if(!("offset"in F.options)){var V=Math.sqrt(Math.pow(13.5,2)/2);F.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[V,-1*(24.6+V)],"bottom-right":[-V,-1*(24.6+V)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=F,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},R.prototype._onKeyPress=function(F){var V=F.code,ne=F.charCode||F.keyCode;V!=="Space"&&V!=="Enter"&&ne!==32&&ne!==13||this.togglePopup()},R.prototype._onMapClick=function(F){var V=F.originalEvent.target,ne=this._element;this._popup&&(V===ne||ne.contains(V))&&this.togglePopup()},R.prototype.getPopup=function(){return this._popup},R.prototype.togglePopup=function(){var F=this._popup;return F?(F.isOpen()?F.remove():F.addTo(this._map),this):this},R.prototype._update=function(F){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Rs(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var V="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?V="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(V="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var ne="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?ne="rotateX(0deg)":this._pitchAlignment==="map"&&(ne="rotateX("+this._map.getPitch()+"deg)"),F&&F.type!=="moveend"||(this._pos=this._pos.round()),l.setTransform(this._element,Ss[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+ne+" "+V)}},R.prototype.getOffset=function(){return this._offset},R.prototype.setOffset=function(F){return this._offset=e.Point.convert(F),this._update(),this},R.prototype._onMove=function(F){this._pos=F.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},R.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new e.Event("dragend")),this._state="inactive"},R.prototype._addDragHandler=function(F){this._element.contains(F.originalEvent.target)&&(F.preventDefault(),this._positionDelta=F.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},R.prototype.setDraggable=function(F){return this._draggable=!!F,this._map&&(F?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},R.prototype.isDraggable=function(){return this._draggable},R.prototype.setRotation=function(F){return this._rotation=F||0,this._update(),this},R.prototype.getRotation=function(){return this._rotation},R.prototype.setRotationAlignment=function(F){return this._rotationAlignment=F||"auto",this._update(),this},R.prototype.getRotationAlignment=function(){return this._rotationAlignment},R.prototype.setPitchAlignment=function(F){return this._pitchAlignment=F&&F!=="auto"?F:this._rotationAlignment,this._update(),this},R.prototype.getPitchAlignment=function(){return this._pitchAlignment},R}(e.Evented),Gs={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},el=0,Es=!1,Ol=function(C){function R(F){C.call(this),this.options=e.extend({},Gs,F),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.onAdd=function(F){var V;return this._map=F,this._container=l.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),V=this._setupUI,Fs!==void 0?V(Fs):e.window.navigator.permissions!==void 0?e.window.navigator.permissions.query({name:"geolocation"}).then(function(ne){Fs=ne.state!=="denied",V(Fs)}):(Fs=!!e.window.navigator.geolocation,V(Fs)),this._container},R.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),l.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,el=0,Es=!1},R.prototype._isOutOfMapMaxBounds=function(F){var V=this._map.getMaxBounds(),ne=F.coords;return V&&(ne.longitude<V.getWest()||ne.longitude>V.getEast()||ne.latitude<V.getSouth()||ne.latitude>V.getNorth())},R.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},R.prototype._onSuccess=function(F){if(this._map){if(this._isOutOfMapMaxBounds(F))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",F)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=F,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(F),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(F),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",F)),this._finish()}},R.prototype._updateCamera=function(F){var V=new e.LngLat(F.coords.longitude,F.coords.latitude),ne=F.coords.accuracy,le=this._map.getBearing(),pe=e.extend({bearing:le},this.options.fitBoundsOptions);this._map.fitBounds(V.toBounds(ne),pe,{geolocateSource:!0})},R.prototype._updateMarker=function(F){if(F){var V=new e.LngLat(F.coords.longitude,F.coords.latitude);this._accuracyCircleMarker.setLngLat(V).addTo(this._map),this._userLocationDotMarker.setLngLat(V).addTo(this._map),this._accuracy=F.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},R.prototype._updateCircleRadius=function(){var F=this._map._container.clientHeight/2,V=this._map.unproject([0,F]),ne=this._map.unproject([1,F]),le=V.distanceTo(ne),pe=Math.ceil(2*this._accuracy/le);this._circleElement.style.width=pe+"px",this._circleElement.style.height=pe+"px"},R.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},R.prototype._onError=function(F){if(this._map){if(this.options.trackUserLocation)if(F.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var V=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=V,this._geolocateButton.setAttribute("aria-label",V),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(F.code===3&&Es)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",F)),this._finish()}},R.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},R.prototype._setupUI=function(F){var V=this;if(this._container.addEventListener("contextmenu",function(pe){return pe.preventDefault()}),this._geolocateButton=l.create("button","mapboxgl-ctrl-geolocate",this._container),l.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",F===!1){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var ne=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=ne,this._geolocateButton.setAttribute("aria-label",ne)}else{var le=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=le,this._geolocateButton.setAttribute("aria-label",le)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=l.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Qs(this._dotElement),this._circleElement=l.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Qs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(pe){var ye=pe.originalEvent&&pe.originalEvent.type==="resize";pe.geolocateSource||V._watchState!=="ACTIVE_LOCK"||ye||(V._watchState="BACKGROUND",V._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),V._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),V.fire(new e.Event("trackuserlocationend")))})},R.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":el--,Es=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var F;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++el>1?(F={maximumAge:6e5,timeout:0},Es=!0):(F=this.options.positionOptions,Es=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,F)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},R.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},R}(e.Evented),Xl={maxWidth:100,unit:"metric"},Bs=function(C){this.options=e.extend({},Xl,C),e.bindAll(["_onMove","setUnit"],this)};function Dl(C,R,F){var V=F&&F.maxWidth||100,ne=C._container.clientHeight/2,le=C.unproject([0,ne]),pe=C.unproject([V,ne]),ye=le.distanceTo(pe);if(F&&F.unit==="imperial"){var Te=3.2808*ye;Te>5280?tl(R,V,Te/5280,C._getUIString("ScaleControl.Miles")):tl(R,V,Te,C._getUIString("ScaleControl.Feet"))}else F&&F.unit==="nautical"?tl(R,V,ye/1852,C._getUIString("ScaleControl.NauticalMiles")):ye>=1e3?tl(R,V,ye/1e3,C._getUIString("ScaleControl.Kilometers")):tl(R,V,ye,C._getUIString("ScaleControl.Meters"))}function tl(C,R,F,V){var ne,le,pe,ye=(ne=F,le=Math.pow(10,(""+Math.floor(ne)).length-1),pe=(pe=ne/le)>=10?10:pe>=5?5:pe>=3?3:pe>=2?2:pe>=1?1:function(Ne){var Ge=Math.pow(10,Math.ceil(-Math.log(Ne)/Math.LN10));return Math.round(Ne*Ge)/Ge}(pe),le*pe),Te=ye/F;C.style.width=R*Te+"px",C.innerHTML=ye+"&nbsp;"+V}Bs.prototype.getDefaultPosition=function(){return"bottom-left"},Bs.prototype._onMove=function(){Dl(this._map,this._container,this.options)},Bs.prototype.onAdd=function(C){return this._map=C,this._container=l.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",C.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Bs.prototype.onRemove=function(){l.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Bs.prototype.setUnit=function(C){this.options.unit=C,Dl(this._map,this._container,this.options)};var lo=function(C){this._fullscreen=!1,C&&C.container&&(C.container instanceof e.window.HTMLElement?this._container=C.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};lo.prototype.onAdd=function(C){return this._map=C,this._container||(this._container=this._map.getContainer()),this._controlContainer=l.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},lo.prototype.onRemove=function(){l.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},lo.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},lo.prototype._setupUI=function(){var C=this._fullscreenButton=l.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);l.create("span","mapboxgl-ctrl-icon",C).setAttribute("aria-hidden",!0),C.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},lo.prototype._updateTitle=function(){var C=this._getTitle();this._fullscreenButton.setAttribute("aria-label",C),this._fullscreenButton.title=C},lo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},lo.prototype._isFullscreen=function(){return this._fullscreen},lo.prototype._changeIcon=function(){(e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},lo.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Zl={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Kl=function(C){function R(F){C.call(this),this.options=e.extend(Object.create(Zl),F),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.addTo=function(F){return this._map&&this.remove(),this._map=F,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},R.prototype.isOpen=function(){return!!this._map},R.prototype.remove=function(){return this._content&&l.remove(this._content),this._container&&(l.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},R.prototype.getLngLat=function(){return this._lngLat},R.prototype.setLngLat=function(F){return this._lngLat=e.LngLat.convert(F),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},R.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},R.prototype.getElement=function(){return this._container},R.prototype.setText=function(F){return this.setDOMContent(e.window.document.createTextNode(F))},R.prototype.setHTML=function(F){var V,ne=e.window.document.createDocumentFragment(),le=e.window.document.createElement("body");for(le.innerHTML=F;V=le.firstChild;)ne.appendChild(V);return this.setDOMContent(ne)},R.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},R.prototype.setMaxWidth=function(F){return this.options.maxWidth=F,this._update(),this},R.prototype.setDOMContent=function(F){return this._createContent(),this._content.appendChild(F),this._update(),this},R.prototype.addClassName=function(F){this._container&&this._container.classList.add(F)},R.prototype.removeClassName=function(F){this._container&&this._container.classList.remove(F)},R.prototype.toggleClassName=function(F){if(this._container)return this._container.classList.toggle(F)},R.prototype._createContent=function(){this._content&&l.remove(this._content),this._content=l.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=l.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},R.prototype._onMouseUp=function(F){this._update(F.point)},R.prototype._onMouseMove=function(F){this._update(F.point)},R.prototype._onDrag=function(F){this._update(F.point)},R.prototype._update=function(F){var V=this,ne=this._lngLat||this._trackPointer;if(this._map&&ne&&this._content&&(this._container||(this._container=l.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=l.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(bt){return V._container.classList.add(bt)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Rs(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||F)){var le=this._pos=this._trackPointer&&F?F:this._map.project(this._lngLat),pe=this.options.anchor,ye=function bt(Ct){if(Ct){if(typeof Ct=="number"){var Tt=Math.round(Math.sqrt(.5*Math.pow(Ct,2)));return{center:new e.Point(0,0),top:new e.Point(0,Ct),"top-left":new e.Point(Tt,Tt),"top-right":new e.Point(-Tt,Tt),bottom:new e.Point(0,-Ct),"bottom-left":new e.Point(Tt,-Tt),"bottom-right":new e.Point(-Tt,-Tt),left:new e.Point(Ct,0),right:new e.Point(-Ct,0)}}if(Ct instanceof e.Point||Array.isArray(Ct)){var At=e.Point.convert(Ct);return{center:At,top:At,"top-left":At,"top-right":At,bottom:At,"bottom-left":At,"bottom-right":At,left:At,right:At}}return{center:e.Point.convert(Ct.center||[0,0]),top:e.Point.convert(Ct.top||[0,0]),"top-left":e.Point.convert(Ct["top-left"]||[0,0]),"top-right":e.Point.convert(Ct["top-right"]||[0,0]),bottom:e.Point.convert(Ct.bottom||[0,0]),"bottom-left":e.Point.convert(Ct["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(Ct["bottom-right"]||[0,0]),left:e.Point.convert(Ct.left||[0,0]),right:e.Point.convert(Ct.right||[0,0])}}return bt(new e.Point(0,0))}(this.options.offset);if(!pe){var Te,Ne=this._container.offsetWidth,Ge=this._container.offsetHeight;Te=le.y+ye.bottom.y<Ge?["top"]:le.y>this._map.transform.height-Ge?["bottom"]:[],le.x<Ne/2?Te.push("left"):le.x>this._map.transform.width-Ne/2&&Te.push("right"),pe=Te.length===0?"bottom":Te.join("-")}var nt=le.add(ye[pe]).round();l.setTransform(this._container,Ss[pe]+" translate("+nt.x+"px,"+nt.y+"px)"),zi(this._container,pe,"popup")}},R.prototype._onClose=function(){this.remove()},R}(e.Evented),oe={version:e.version,supported:f,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:is,NavigationControl:Ja,GeolocateControl:Ol,AttributionControl:ji,ScaleControl:Bs,FullscreenControl:lo,Popup:Kl,Marker:Qs,Style:Yn,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:function(){it().acquire(Lt)},clearPrewarmedResources:function(){var C=Dt;C&&(C.isPreloaded()&&C.numActive()===1?(C.release(Lt),Dt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(C){e.config.ACCESS_TOKEN=C},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(C){e.config.API_URL=C},get workerCount(){return vt.workerCount},set workerCount(C){vt.workerCount=C},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(C){e.config.MAX_PARALLEL_IMAGE_REQUESTS=C},clearStorage:function(C){e.clearTileCache(C)},workerUrl:""};return oe}),m})},{}],452:[function(r,I,B){var t=r("./normalize"),d=r("gl-mat4/create"),m=r("gl-mat4/clone"),h=r("gl-mat4/determinant"),e=r("gl-mat4/invert"),f=r("gl-mat4/transpose"),l={length:r("gl-vec3/length"),normalize:r("gl-vec3/normalize"),dot:r("gl-vec3/dot"),cross:r("gl-vec3/cross")},o=d(),u=d(),s=[0,0,0,0],i=[[0,0,0],[0,0,0],[0,0,0]],c=[0,0,0];function n(a,g,p,y,v){a[0]=g[0]*y+p[0]*v,a[1]=g[1]*y+p[1]*v,a[2]=g[2]*y+p[2]*v}I.exports=function(a,g,p,y,v,b){if(g||(g=[0,0,0]),p||(p=[0,0,0]),y||(y=[0,0,0]),v||(v=[0,0,0,1]),b||(b=[0,0,0,1]),!t(o,a)||(m(u,o),u[3]=0,u[7]=0,u[11]=0,u[15]=1,Math.abs(h(u)<1e-8)))return!1;var x,T,A,S,w,E,k,L=o[3],M=o[7],P=o[11],D=o[12],N=o[13],U=o[14],G=o[15];if(L!==0||M!==0||P!==0){if(s[0]=L,s[1]=M,s[2]=P,s[3]=G,!e(u,u))return!1;f(u,u),x=v,A=u,S=(T=s)[0],w=T[1],E=T[2],k=T[3],x[0]=A[0]*S+A[4]*w+A[8]*E+A[12]*k,x[1]=A[1]*S+A[5]*w+A[9]*E+A[13]*k,x[2]=A[2]*S+A[6]*w+A[10]*E+A[14]*k,x[3]=A[3]*S+A[7]*w+A[11]*E+A[15]*k}else v[0]=v[1]=v[2]=0,v[3]=1;if(g[0]=D,g[1]=N,g[2]=U,function(K,Z){K[0][0]=Z[0],K[0][1]=Z[1],K[0][2]=Z[2],K[1][0]=Z[4],K[1][1]=Z[5],K[1][2]=Z[6],K[2][0]=Z[8],K[2][1]=Z[9],K[2][2]=Z[10]}(i,o),p[0]=l.length(i[0]),l.normalize(i[0],i[0]),y[0]=l.dot(i[0],i[1]),n(i[1],i[1],i[0],1,-y[0]),p[1]=l.length(i[1]),l.normalize(i[1],i[1]),y[0]/=p[1],y[1]=l.dot(i[0],i[2]),n(i[2],i[2],i[0],1,-y[1]),y[2]=l.dot(i[1],i[2]),n(i[2],i[2],i[1],1,-y[2]),p[2]=l.length(i[2]),l.normalize(i[2],i[2]),y[1]/=p[2],y[2]/=p[2],l.cross(c,i[1],i[2]),l.dot(i[0],c)<0)for(var X=0;X<3;X++)p[X]*=-1,i[X][0]*=-1,i[X][1]*=-1,i[X][2]*=-1;return b[0]=.5*Math.sqrt(Math.max(1+i[0][0]-i[1][1]-i[2][2],0)),b[1]=.5*Math.sqrt(Math.max(1-i[0][0]+i[1][1]-i[2][2],0)),b[2]=.5*Math.sqrt(Math.max(1-i[0][0]-i[1][1]+i[2][2],0)),b[3]=.5*Math.sqrt(Math.max(1+i[0][0]+i[1][1]+i[2][2],0)),i[2][1]>i[1][2]&&(b[0]=-b[0]),i[0][2]>i[2][0]&&(b[1]=-b[1]),i[1][0]>i[0][1]&&(b[2]=-b[2]),!0}},{"./normalize":453,"gl-mat4/clone":278,"gl-mat4/create":280,"gl-mat4/determinant":281,"gl-mat4/invert":293,"gl-mat4/transpose":306,"gl-vec3/cross":360,"gl-vec3/dot":365,"gl-vec3/length":375,"gl-vec3/normalize":382}],453:[function(r,I,B){I.exports=function(t,d){var m=d[15];if(m===0)return!1;for(var h=1/m,e=0;e<16;e++)t[e]=d[e]*h;return!0}},{}],454:[function(r,I,B){var t=r("gl-vec3/lerp"),d=r("mat4-recompose"),m=r("mat4-decompose"),h=r("gl-mat4/determinant"),e=r("quat-slerp"),f=u(),l=u(),o=u();function u(){return{translate:s(),scale:s(1),skew:s(),perspective:[0,0,0,1],quaternion:[0,0,0,1]}}function s(i){return[i||0,i||0,i||0]}I.exports=function(i,c,n,a){if(h(c)===0||h(n)===0)return!1;var g=m(c,f.translate,f.scale,f.skew,f.perspective,f.quaternion),p=m(n,l.translate,l.scale,l.skew,l.perspective,l.quaternion);return!(!g||!p)&&(t(o.translate,f.translate,l.translate,a),t(o.skew,f.skew,l.skew,a),t(o.scale,f.scale,l.scale,a),t(o.perspective,f.perspective,l.perspective,a),e(o.quaternion,f.quaternion,l.quaternion,a),d(i,o.translate,o.scale,o.skew,o.perspective,o.quaternion),!0)}},{"gl-mat4/determinant":281,"gl-vec3/lerp":376,"mat4-decompose":452,"mat4-recompose":455,"quat-slerp":515}],455:[function(r,I,B){var t={identity:r("gl-mat4/identity"),translate:r("gl-mat4/translate"),multiply:r("gl-mat4/multiply"),create:r("gl-mat4/create"),scale:r("gl-mat4/scale"),fromRotationTranslation:r("gl-mat4/fromRotationTranslation")},d=(t.create(),t.create());I.exports=function(m,h,e,f,l,o){return t.identity(m),t.fromRotationTranslation(m,o,h),m[3]=l[0],m[7]=l[1],m[11]=l[2],m[15]=l[3],t.identity(d),f[2]!==0&&(d[9]=f[2],t.multiply(m,m,d)),f[1]!==0&&(d[9]=0,d[8]=f[1],t.multiply(m,m,d)),f[0]!==0&&(d[8]=0,d[4]=f[0],t.multiply(m,m,d)),t.scale(m,m,e),m}},{"gl-mat4/create":280,"gl-mat4/fromRotationTranslation":284,"gl-mat4/identity":291,"gl-mat4/multiply":295,"gl-mat4/scale":303,"gl-mat4/translate":305}],456:[function(r,I,B){I.exports=Math.log2||function(t){return Math.log(t)*Math.LOG2E}},{}],457:[function(r,I,B){var t=r("binary-search-bounds"),d=r("mat4-interpolate"),m=r("gl-mat4/invert"),h=r("gl-mat4/rotateX"),e=r("gl-mat4/rotateY"),f=r("gl-mat4/rotateZ"),l=r("gl-mat4/lookAt"),o=r("gl-mat4/translate"),u=(r("gl-mat4/scale"),r("gl-vec3/normalize")),s=[0,0,0];function i(a){this._components=a.slice(),this._time=[0],this.prevMatrix=a.slice(),this.nextMatrix=a.slice(),this.computedMatrix=a.slice(),this.computedInverse=a.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}I.exports=function(a){return new i((a=a||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};var c=i.prototype;c.recalcMatrix=function(a){var g=this._time,p=t.le(g,a),y=this.computedMatrix;if(!(p<0)){var v=this._components;if(p===g.length-1)for(var b=16*p,x=0;x<16;++x)y[x]=v[b++];else{var T=g[p+1]-g[p],A=(b=16*p,this.prevMatrix),S=!0;for(x=0;x<16;++x)A[x]=v[b++];var w=this.nextMatrix;for(x=0;x<16;++x)w[x]=v[b++],S=S&&A[x]===w[x];if(T<1e-6||S)for(x=0;x<16;++x)y[x]=A[x];else d(y,A,w,(a-g[p])/T)}var E=this.computedUp;E[0]=y[1],E[1]=y[5],E[2]=y[9],u(E,E);var k=this.computedInverse;m(k,y);var L=this.computedEye,M=k[15];L[0]=k[12]/M,L[1]=k[13]/M,L[2]=k[14]/M;var P=this.computedCenter,D=Math.exp(this.computedRadius[0]);for(x=0;x<3;++x)P[x]=L[x]-y[2+4*x]*D}},c.idle=function(a){if(!(a<this.lastT())){for(var g=this._components,p=g.length-16,y=0;y<16;++y)g.push(g[p++]);this._time.push(a)}},c.flush=function(a){var g=t.gt(this._time,a)-2;g<0||(this._time.splice(0,g),this._components.splice(0,16*g))},c.lastT=function(){return this._time[this._time.length-1]},c.lookAt=function(a,g,p,y){this.recalcMatrix(a),g=g||this.computedEye,p=p||s,y=y||this.computedUp,this.setMatrix(a,l(this.computedMatrix,g,p,y));for(var v=0,b=0;b<3;++b)v+=Math.pow(p[b]-g[b],2);v=Math.log(Math.sqrt(v)),this.computedRadius[0]=v},c.rotate=function(a,g,p,y){this.recalcMatrix(a);var v=this.computedInverse;g&&e(v,v,g),p&&h(v,v,p),y&&f(v,v,y),this.setMatrix(a,m(this.computedMatrix,v))};var n=[0,0,0];c.pan=function(a,g,p,y){n[0]=-(g||0),n[1]=-(p||0),n[2]=-(y||0),this.recalcMatrix(a);var v=this.computedInverse;o(v,v,n),this.setMatrix(a,m(v,v))},c.translate=function(a,g,p,y){n[0]=g||0,n[1]=p||0,n[2]=y||0,this.recalcMatrix(a);var v=this.computedMatrix;o(v,v,n),this.setMatrix(a,v)},c.setMatrix=function(a,g){if(!(a<this.lastT())){this._time.push(a);for(var p=0;p<16;++p)this._components.push(g[p])}},c.setDistance=function(a,g){this.computedRadius[0]=g},c.setDistanceLimits=function(a,g){var p=this._limits;p[0]=a,p[1]=g},c.getDistanceLimits=function(a){var g=this._limits;return a?(a[0]=g[0],a[1]=g[1],a):g}},{"binary-search-bounds":103,"gl-mat4/invert":293,"gl-mat4/lookAt":294,"gl-mat4/rotateX":300,"gl-mat4/rotateY":301,"gl-mat4/rotateZ":302,"gl-mat4/scale":303,"gl-mat4/translate":305,"gl-vec3/normalize":382,"mat4-interpolate":454}],458:[function(r,I,B){I.exports=function(d){var m=d.length;if(m<3){for(var h=new Array(m),e=0;e<m;++e)h[e]=e;return m===2&&d[0][0]===d[1][0]&&d[0][1]===d[1][1]?[0]:h}var f=new Array(m);for(e=0;e<m;++e)f[e]=e;f.sort(function(g,p){var y=d[g][0]-d[p][0];return y||d[g][1]-d[p][1]});var l=[f[0],f[1]],o=[f[0],f[1]];for(e=2;e<m;++e){for(var u=f[e],s=d[u],i=l.length;i>1&&t(d[l[i-2]],d[l[i-1]],s)<=0;)i-=1,l.pop();for(l.push(u),i=o.length;i>1&&t(d[o[i-2]],d[o[i-1]],s)>=0;)i-=1,o.pop();o.push(u)}h=new Array(o.length+l.length-2);for(var c=0,n=(e=0,l.length);e<n;++e)h[c++]=l[e];for(var a=o.length-2;a>0;--a)h[c++]=o[a];return h};var t=r("robust-orientation")[3]},{"robust-orientation":534}],459:[function(r,I,B){I.exports=function(d,m){m||(m=d,d=window);var h=0,e=0,f=0,l={shift:!1,alt:!1,control:!1,meta:!1},o=!1;function u(b){var x=!1;return"altKey"in b&&(x=x||b.altKey!==l.alt,l.alt=!!b.altKey),"shiftKey"in b&&(x=x||b.shiftKey!==l.shift,l.shift=!!b.shiftKey),"ctrlKey"in b&&(x=x||b.ctrlKey!==l.control,l.control=!!b.ctrlKey),"metaKey"in b&&(x=x||b.metaKey!==l.meta,l.meta=!!b.metaKey),x}function s(b,x){var T=t.x(x),A=t.y(x);"buttons"in x&&(b=0|x.buttons),(b!==h||T!==e||A!==f||u(x))&&(h=0|b,e=T||0,f=A||0,m&&m(h,e,f,l))}function i(b){s(0,b)}function c(){(h||e||f||l.shift||l.alt||l.meta||l.control)&&(e=f=0,h=0,l.shift=l.alt=l.control=l.meta=!1,m&&m(0,0,0,l))}function n(b){u(b)&&m&&m(h,e,f,l)}function a(b){t.buttons(b)===0?s(0,b):s(h,b)}function g(b){s(h|t.buttons(b),b)}function p(b){s(h&~t.buttons(b),b)}function y(){o||(o=!0,d.addEventListener("mousemove",a),d.addEventListener("mousedown",g),d.addEventListener("mouseup",p),d.addEventListener("mouseleave",i),d.addEventListener("mouseenter",i),d.addEventListener("mouseout",i),d.addEventListener("mouseover",i),d.addEventListener("blur",c),d.addEventListener("keyup",n),d.addEventListener("keydown",n),d.addEventListener("keypress",n),d!==window&&(window.addEventListener("blur",c),window.addEventListener("keyup",n),window.addEventListener("keydown",n),window.addEventListener("keypress",n)))}y();var v={element:d};return Object.defineProperties(v,{enabled:{get:function(){return o},set:function(b){b?y():function(){!o||(o=!1,d.removeEventListener("mousemove",a),d.removeEventListener("mousedown",g),d.removeEventListener("mouseup",p),d.removeEventListener("mouseleave",i),d.removeEventListener("mouseenter",i),d.removeEventListener("mouseout",i),d.removeEventListener("mouseover",i),d.removeEventListener("blur",c),d.removeEventListener("keyup",n),d.removeEventListener("keydown",n),d.removeEventListener("keypress",n),d!==window&&(window.removeEventListener("blur",c),window.removeEventListener("keyup",n),window.removeEventListener("keydown",n),window.removeEventListener("keypress",n)))}()},enumerable:!0},buttons:{get:function(){return h},enumerable:!0},x:{get:function(){return e},enumerable:!0},y:{get:function(){return f},enumerable:!0},mods:{get:function(){return l},enumerable:!0}}),v};var t=r("mouse-event")},{"mouse-event":461}],460:[function(r,I,B){var t={left:0,top:0};I.exports=function(d,m,h){m=m||d.currentTarget||d.srcElement,Array.isArray(h)||(h=[0,0]);var e=d.clientX||0,f=d.clientY||0,l=(o=m,o===window||o===document||o===document.body?t:o.getBoundingClientRect()),o;return h[0]=e-l.left,h[1]=f-l.top,h}},{}],461:[function(r,I,B){function t(d){return d.target||d.srcElement||window}B.buttons=function(d){if(typeof d=="object"){if("buttons"in d)return d.buttons;if("which"in d){if((m=d.which)===2)return 4;if(m===3)return 2;if(m>0)return 1<<m-1}else if("button"in d){var m;if((m=d.button)===1)return 4;if(m===2)return 2;if(m>=0)return 1<<m}}return 0},B.element=t,B.x=function(d){if(typeof d=="object"){if("offsetX"in d)return d.offsetX;var m=t(d).getBoundingClientRect();return d.clientX-m.left}return 0},B.y=function(d){if(typeof d=="object"){if("offsetY"in d)return d.offsetY;var m=t(d).getBoundingClientRect();return d.clientY-m.top}return 0}},{}],462:[function(r,I,B){var t=r("to-px");I.exports=function(d,m,h){typeof d=="function"&&(h=!!m,m=d,d=window);var e=t("ex",d),f=function(l){h&&l.preventDefault();var o=l.deltaX||0,u=l.deltaY||0,s=l.deltaZ||0,i=1;switch(l.deltaMode){case 1:i=e;break;case 2:i=window.innerHeight}if(u*=i,s*=i,(o*=i)||u||s)return m(o,u,s,l)};return d.addEventListener("wheel",f),f}},{"to-px":585}],463:[function(r,I,B){(function(t,d){(function(){/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/(function(m,h,e){h[m]=h[m]||e(),I!==void 0&&I.exports&&(I.exports=h[m])})("Promise",t!==void 0?t:this,function(){var m,h,e,f=Object.prototype.toString,l=d!==void 0?function(b){return d(b)}:setTimeout;try{Object.defineProperty({},"x",{}),m=function(b,x,T,A){return Object.defineProperty(b,x,{value:T,writable:!0,configurable:A!==!1})}}catch(b){m=function(x,T,A){return x[T]=A,x}}function o(b,x){e.add(b,x),h||(h=l(e.drain))}function u(b){var x,T=typeof b;return b==null||T!="object"&&T!="function"||(x=b.then),typeof x=="function"&&x}function s(){for(var b=0;b<this.chain.length;b++)i(this,this.state===1?this.chain[b].success:this.chain[b].failure,this.chain[b]);this.chain.length=0}function i(b,x,T){var A,S;try{x===!1?T.reject(b.msg):(A=x===!0?b.msg:x.call(void 0,b.msg))===T.promise?T.reject(TypeError("Promise-chain cycle")):(S=u(A))?S.call(A,T.resolve,T.reject):T.resolve(A)}catch(w){T.reject(w)}}function c(b){var x,T=this;if(!T.triggered){T.triggered=!0,T.def&&(T=T.def);try{(x=u(b))?o(function(){var A=new g(T);try{x.call(b,function(){c.apply(A,arguments)},function(){n.apply(A,arguments)})}catch(S){n.call(A,S)}}):(T.msg=b,T.state=1,T.chain.length>0&&o(s,T))}catch(A){n.call(new g(T),A)}}}function n(b){var x=this;x.triggered||(x.triggered=!0,x.def&&(x=x.def),x.msg=b,x.state=2,x.chain.length>0&&o(s,x))}function a(b,x,T,A){for(var S=0;S<x.length;S++)(function(w){b.resolve(x[w]).then(function(E){T(w,E)},A)})(S)}function g(b){this.def=b,this.triggered=!1}function p(b){this.promise=b,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function y(b){if(typeof b!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var x=new p(this);this.then=function(T,A){var S={success:typeof T!="function"||T,failure:typeof A=="function"&&A};return S.promise=new this.constructor(function(w,E){if(typeof w!="function"||typeof E!="function")throw TypeError("Not a function");S.resolve=w,S.reject=E}),x.chain.push(S),x.state!==0&&o(s,x),S.promise},this.catch=function(T){return this.then(void 0,T)};try{b.call(void 0,function(T){c.call(x,T)},function(T){n.call(x,T)})}catch(T){n.call(x,T)}}e=function(){var b,x,T;function A(S,w){this.fn=S,this.self=w,this.next=void 0}return{add:function(S,w){T=new A(S,w),x?x.next=T:b=T,x=T,T=void 0},drain:function(){var S=b;for(b=x=h=void 0;S;)S.fn.call(S.self),S=S.next}}}();var v=m({},"constructor",y,!1);return y.prototype=v,m(v,"__NPO__",0,!1),m(y,"resolve",function(b){return b&&typeof b=="object"&&b.__NPO__===1?b:new this(function(x,T){if(typeof x!="function"||typeof T!="function")throw TypeError("Not a function");x(b)})}),m(y,"reject",function(b){return new this(function(x,T){if(typeof x!="function"||typeof T!="function")throw TypeError("Not a function");T(b)})}),m(y,"all",function(b){var x=this;return f.call(b)!="[object Array]"?x.reject(TypeError("Not an array")):b.length===0?x.resolve([]):new x(function(T,A){if(typeof T!="function"||typeof A!="function")throw TypeError("Not a function");var S=b.length,w=Array(S),E=0;a(x,b,function(k,L){w[k]=L,++E===S&&T(w)},A)})}),m(y,"race",function(b){var x=this;return f.call(b)!="[object Array]"?x.reject(TypeError("Not an array")):new x(function(T,A){if(typeof T!="function"||typeof A!="function")throw TypeError("Not a function");a(x,b,function(S,w){T(w)},A)})}),y})}).call(this)}).call(this,typeof vi!="undefined"?vi:typeof self!="undefined"?self:typeof window!="undefined"?window:{},r("timers").setImmediate)},{timers:582}],464:[function(r,I,B){var t=r("typedarray-pool");I.exports=function(m){function h(i){throw new Error("ndarray-extract-contour: "+i)}typeof m!="object"&&h("Must specify arguments");var e=m.order;Array.isArray(e)||h("Must specify order");var f=m.arrayArguments||1;f<1&&h("Must have at least one array argument");var l=m.scalarArguments||0;l<0&&h("Scalar arg count must be > 0"),typeof m.vertex!="function"&&h("Must specify vertex creation function"),typeof m.cell!="function"&&h("Must specify cell creation function"),typeof m.phase!="function"&&h("Must specify phase function");for(var o=m.getters||[],u=new Array(f),s=0;s<f;++s)o.indexOf(s)>=0?u[s]=!0:u[s]=!1;return function(i,c,n,a,g,p){var y=[p,g].join(",");return(0,d[y])(i,c,n,t.mallocUint32,t.freeUint32)}(m.vertex,m.cell,m.phase,0,e,u)};var d={"false,0,1":function(m,h,e,f,l){return function(o,u,s,i){var c,n=0|o.shape[0],a=0|o.shape[1],g=o.data,p=0|o.offset,y=0|o.stride[0],v=0|o.stride[1],b=p,x=0|-y,T=0,A=0|-v,S=0,w=-y-v|0,E=0,k=0|y,L=v-y*n|0,M=0,P=0,D=0,N=2*n|0,U=f(N),G=f(N),X=0,K=0,Z=-1,H=-1,Y=0,$=0|-n,z=0|n,j=0,W=-n-1|0,ee=n-1|0,J=0,Q=0,te=0;for(M=0;M<n;++M)U[X++]=e(g[b],u,s,i),b+=k;if(b+=L,a>0){if(P=1,U[X++]=e(g[b],u,s,i),b+=k,n>0)for(M=1,c=g[b],K=U[X]=e(c,u,s,i),Y=U[X+Z],j=U[X+$],J=U[X+W],K===Y&&K===j&&K===J||(T=g[b+x],S=g[b+A],E=g[b+w],m(M,P,c,T,S,E,K,Y,j,J,u,s,i),Q=G[X]=D++),X+=1,b+=k,M=2;M<n;++M)c=g[b],K=U[X]=e(c,u,s,i),Y=U[X+Z],j=U[X+$],J=U[X+W],K===Y&&K===j&&K===J||(T=g[b+x],S=g[b+A],E=g[b+w],m(M,P,c,T,S,E,K,Y,j,J,u,s,i),Q=G[X]=D++,J!==Y&&h(G[X+Z],Q,E,T,J,Y,u,s,i)),X+=1,b+=k;for(b+=L,X=0,te=Z,Z=H,H=te,te=$,$=z,z=te,te=W,W=ee,ee=te,P=2;P<a;++P){if(U[X++]=e(g[b],u,s,i),b+=k,n>0)for(M=1,c=g[b],K=U[X]=e(c,u,s,i),Y=U[X+Z],j=U[X+$],J=U[X+W],K===Y&&K===j&&K===J||(T=g[b+x],S=g[b+A],E=g[b+w],m(M,P,c,T,S,E,K,Y,j,J,u,s,i),Q=G[X]=D++,J!==j&&h(G[X+$],Q,S,E,j,J,u,s,i)),X+=1,b+=k,M=2;M<n;++M)c=g[b],K=U[X]=e(c,u,s,i),Y=U[X+Z],j=U[X+$],J=U[X+W],K===Y&&K===j&&K===J||(T=g[b+x],S=g[b+A],E=g[b+w],m(M,P,c,T,S,E,K,Y,j,J,u,s,i),Q=G[X]=D++,J!==j&&h(G[X+$],Q,S,E,j,J,u,s,i),J!==Y&&h(G[X+Z],Q,E,T,J,Y,u,s,i)),X+=1,b+=k;1&P&&(X=0),te=Z,Z=H,H=te,te=$,$=z,z=te,te=W,W=ee,ee=te,b+=L}}l(G),l(U)}},"false,1,0":function(m,h,e,f,l){return function(o,u,s,i){var c,n=0|o.shape[0],a=0|o.shape[1],g=o.data,p=0|o.offset,y=0|o.stride[0],v=0|o.stride[1],b=p,x=0|-y,T=0,A=0|-v,S=0,w=-y-v|0,E=0,k=0|v,L=y-v*a|0,M=0,P=0,D=0,N=2*a|0,U=f(N),G=f(N),X=0,K=0,Z=-1,H=-1,Y=0,$=0|-a,z=0|a,j=0,W=-a-1|0,ee=a-1|0,J=0,Q=0,te=0;for(P=0;P<a;++P)U[X++]=e(g[b],u,s,i),b+=k;if(b+=L,n>0){if(M=1,U[X++]=e(g[b],u,s,i),b+=k,a>0)for(P=1,c=g[b],K=U[X]=e(c,u,s,i),j=U[X+$],Y=U[X+Z],J=U[X+W],K===j&&K===Y&&K===J||(T=g[b+x],S=g[b+A],E=g[b+w],m(M,P,c,T,S,E,K,j,Y,J,u,s,i),Q=G[X]=D++),X+=1,b+=k,P=2;P<a;++P)c=g[b],K=U[X]=e(c,u,s,i),j=U[X+$],Y=U[X+Z],J=U[X+W],K===j&&K===Y&&K===J||(T=g[b+x],S=g[b+A],E=g[b+w],m(M,P,c,T,S,E,K,j,Y,J,u,s,i),Q=G[X]=D++,J!==Y&&h(G[X+Z],Q,S,E,Y,J,u,s,i)),X+=1,b+=k;for(b+=L,X=0,te=$,$=z,z=te,te=Z,Z=H,H=te,te=W,W=ee,ee=te,M=2;M<n;++M){if(U[X++]=e(g[b],u,s,i),b+=k,a>0)for(P=1,c=g[b],K=U[X]=e(c,u,s,i),j=U[X+$],Y=U[X+Z],J=U[X+W],K===j&&K===Y&&K===J||(T=g[b+x],S=g[b+A],E=g[b+w],m(M,P,c,T,S,E,K,j,Y,J,u,s,i),Q=G[X]=D++,J!==j&&h(G[X+$],Q,E,T,J,j,u,s,i)),X+=1,b+=k,P=2;P<a;++P)c=g[b],K=U[X]=e(c,u,s,i),j=U[X+$],Y=U[X+Z],J=U[X+W],K===j&&K===Y&&K===J||(T=g[b+x],S=g[b+A],E=g[b+w],m(M,P,c,T,S,E,K,j,Y,J,u,s,i),Q=G[X]=D++,J!==Y&&h(G[X+Z],Q,S,E,Y,J,u,s,i),J!==j&&h(G[X+$],Q,E,T,J,j,u,s,i)),X+=1,b+=k;1&M&&(X=0),te=$,$=z,z=te,te=Z,Z=H,H=te,te=W,W=ee,ee=te,b+=L}}l(G),l(U)}}}},{"typedarray-pool":601}],465:[function(r,I,B){var t=r("dup"),d={zero:function(n,a,g,p){var y=n[0];p|=0;var v=0,b=g[0];for(v=0;v<y;++v)a[p]=0,p+=b},fdTemplate1:function(n,a,g,p,y,v,b){var x=n[0],T=g[0],A=-1*T,S=T;p|=0,b|=0;var w=0,E=T,k=v[0];for(w=0;w<x;++w)y[b]=.5*(a[p+A]-a[p+S]),p+=E,b+=k},fdTemplate2:function(n,a,g,p,y,v,b,x,T,A){var S=n[0],w=n[1],E=g[0],k=g[1],L=v[0],M=v[1],P=T[0],D=T[1],N=-1*E,U=E,G=-1*k,X=k;p|=0,b|=0,A|=0;var K=0,Z=0,H=k,Y=E-w*k,$=M,z=L-w*M,j=D,W=P-w*D;for(Z=0;Z<S;++Z){for(K=0;K<w;++K)y[b]=.5*(a[p+N]-a[p+U]),x[A]=.5*(a[p+G]-a[p+X]),p+=H,b+=$,A+=j;p+=Y,b+=z,A+=W}}},m={cdiff:function(n){var a={};return function(g,p,y){var v=g.dtype,b=g.order,x=p.dtype,T=p.order,A=y.dtype,S=y.order,w=[v,b.join(),x,T.join(),A,S.join()].join(),E=a[w];return E||(a[w]=E=n([v,b,x,T,A,S])),E(g.shape.slice(0),g.data,g.stride,0|g.offset,p.data,p.stride,0|p.offset,y.data,y.stride,0|y.offset)}},zero:function(n){var a={};return function(g){var p=g.dtype,y=g.order,v=[p,y.join()].join(),b=a[v];return b||(a[v]=b=n([p,y])),b(g.shape.slice(0),g.data,g.stride,0|g.offset)}},fdTemplate1:function(n){var a={};return function(g,p){var y=g.dtype,v=g.order,b=p.dtype,x=p.order,T=[y,v.join(),b,x.join()].join(),A=a[T];return A||(a[T]=A=n([y,v,b,x])),A(g.shape.slice(0),g.data,g.stride,0|g.offset,p.data,p.stride,0|p.offset)}},fdTemplate2:function(n){var a={};return function(g,p,y){var v=g.dtype,b=g.order,x=p.dtype,T=p.order,A=y.dtype,S=y.order,w=[v,b.join(),x,T.join(),A,S.join()].join(),E=a[w];return E||(a[w]=E=n([v,b,x,T,A,S])),E(g.shape.slice(0),g.data,g.stride,0|g.offset,p.data,p.stride,0|p.offset,y.data,y.stride,0|y.offset)}}};function h(n){return(0,m[n.funcName])(e.bind(void 0,n))}function e(n){return d[n.funcName]}function f(n){return h({funcName:n.funcName})}var l={},o={},u=f({funcName:"cdiff"}),s=f({funcName:"zero"});function i(n){return n in l?l[n]:l[n]=f({funcName:"fdTemplate"+n})}function c(n,a,g,p){return function(y,v){var b=v.shape.slice();return b[0]>2&&b[1]>2&&p(v.pick(-1,-1).lo(1,1).hi(b[0]-2,b[1]-2),y.pick(-1,-1,0).lo(1,1).hi(b[0]-2,b[1]-2),y.pick(-1,-1,1).lo(1,1).hi(b[0]-2,b[1]-2)),b[1]>2&&(g(v.pick(0,-1).lo(1).hi(b[1]-2),y.pick(0,-1,1).lo(1).hi(b[1]-2)),a(y.pick(0,-1,0).lo(1).hi(b[1]-2))),b[1]>2&&(g(v.pick(b[0]-1,-1).lo(1).hi(b[1]-2),y.pick(b[0]-1,-1,1).lo(1).hi(b[1]-2)),a(y.pick(b[0]-1,-1,0).lo(1).hi(b[1]-2))),b[0]>2&&(g(v.pick(-1,0).lo(1).hi(b[0]-2),y.pick(-1,0,0).lo(1).hi(b[0]-2)),a(y.pick(-1,0,1).lo(1).hi(b[0]-2))),b[0]>2&&(g(v.pick(-1,b[1]-1).lo(1).hi(b[0]-2),y.pick(-1,b[1]-1,0).lo(1).hi(b[0]-2)),a(y.pick(-1,b[1]-1,1).lo(1).hi(b[0]-2))),y.set(0,0,0,0),y.set(0,0,1,0),y.set(b[0]-1,0,0,0),y.set(b[0]-1,0,1,0),y.set(0,b[1]-1,0,0),y.set(0,b[1]-1,1,0),y.set(b[0]-1,b[1]-1,0,0),y.set(b[0]-1,b[1]-1,1,0),y}}I.exports=function(n,a,g){return Array.isArray(g)||(g=t(a.dimension,typeof g=="string"?g:"clamp")),a.size===0?n:a.dimension===0?(n.set(0),n):function(p){var y=p.join();if(T=o[y])return T;for(var v=p.length,b=[u,s],x=1;x<=v;++x)b.push(i(x));var T=c.apply(void 0,b);return o[y]=T,T}(g)(n,a)}},{dup:182}],466:[function(r,I,B){function t(e,f){var l=Math.floor(f),o=f-l,u=0<=l&&l<e.shape[0],s=0<=l+1&&l+1<e.shape[0];return(1-o)*(u?+e.get(l):0)+o*(s?+e.get(l+1):0)}function d(e,f,l){var o=Math.floor(f),u=f-o,s=0<=o&&o<e.shape[0],i=0<=o+1&&o+1<e.shape[0],c=Math.floor(l),n=l-c,a=0<=c&&c<e.shape[1],g=0<=c+1&&c+1<e.shape[1],p=s&&a?e.get(o,c):0,y=s&&g?e.get(o,c+1):0;return(1-n)*((1-u)*p+u*(i&&a?e.get(o+1,c):0))+n*((1-u)*y+u*(i&&g?e.get(o+1,c+1):0))}function m(e,f,l,o){var u=Math.floor(f),s=f-u,i=0<=u&&u<e.shape[0],c=0<=u+1&&u+1<e.shape[0],n=Math.floor(l),a=l-n,g=0<=n&&n<e.shape[1],p=0<=n+1&&n+1<e.shape[1],y=Math.floor(o),v=o-y,b=0<=y&&y<e.shape[2],x=0<=y+1&&y+1<e.shape[2],T=i&&g&&b?e.get(u,n,y):0,A=i&&p&&b?e.get(u,n+1,y):0,S=c&&g&&b?e.get(u+1,n,y):0,w=c&&p&&b?e.get(u+1,n+1,y):0,E=i&&g&&x?e.get(u,n,y+1):0,k=i&&p&&x?e.get(u,n+1,y+1):0;return(1-v)*((1-a)*((1-s)*T+s*S)+a*((1-s)*A+s*w))+v*((1-a)*((1-s)*E+s*(c&&g&&x?e.get(u+1,n,y+1):0))+a*((1-s)*k+s*(c&&p&&x?e.get(u+1,n+1,y+1):0)))}function h(e){var f,l,o=0|e.shape.length,u=new Array(o),s=new Array(o),i=new Array(o),c=new Array(o);for(f=0;f<o;++f)l=+arguments[f+1],u[f]=Math.floor(l),s[f]=l-u[f],i[f]=0<=u[f]&&u[f]<e.shape[f],c[f]=0<=u[f]+1&&u[f]+1<e.shape[f];var n,a,g,p=0;e:for(f=0;f<1<<o;++f){for(a=1,g=e.offset,n=0;n<o;++n)if(f&1<<n){if(!c[n])continue e;a*=s[n],g+=e.stride[n]*(u[n]+1)}else{if(!i[n])continue e;a*=1-s[n],g+=e.stride[n]*u[n]}p+=a*e.data[g]}return p}I.exports=function(e,f,l,o){switch(e.shape.length){case 0:return 0;case 1:return t(e,f);case 2:return d(e,f,l);case 3:return m(e,f,l,o);default:return h.apply(void 0,arguments)}},I.exports.d1=t,I.exports.d2=d,I.exports.d3=m},{}],467:[function(r,I,B){var t={"float64,2,1,0":function(){return function(f,l,o,u,s){var i=f[0],c=f[1],n=f[2],a=o[0],g=o[1],p=o[2];u|=0;var y=0,v=0,b=0,x=p,T=g-n*p,A=a-c*g;for(b=0;b<i;++b){for(v=0;v<c;++v){for(y=0;y<n;++y)l[u]/=s,u+=x;u+=T}u+=A}}},"uint8,2,0,1,float64,2,1,0":function(){return function(f,l,o,u,s,i,c,n){for(var a=f[0],g=f[1],p=f[2],y=o[0],v=o[1],b=o[2],x=i[0],T=i[1],A=i[2],S=u|=0,w=c|=0,E=0|f[0];E>0;){E<64?(a=E,E=0):(a=64,E-=64);for(var k=0|f[1];k>0;){k<64?(g=k,k=0):(g=64,k-=64),u=S+E*y+k*v,c=w+E*x+k*T;var L=0,M=0,P=0,D=b,N=y-p*b,U=v-a*y,G=A,X=x-p*A,K=T-a*x;for(P=0;P<g;++P){for(M=0;M<a;++M){for(L=0;L<p;++L)l[u]=s[c]*n,u+=D,c+=G;u+=N,c+=X}u+=U,c+=K}}}}},"float32,1,0,float32,1,0":function(){return function(f,l,o,u,s,i,c){var n=f[0],a=f[1],g=o[0],p=o[1],y=i[0],v=i[1];u|=0,c|=0;var b=0,x=0,T=p,A=g-a*p,S=v,w=y-a*v;for(x=0;x<n;++x){for(b=0;b<a;++b)l[u]=s[c],u+=T,c+=S;u+=A,c+=w}}},"float32,1,0,float32,0,1":function(){return function(f,l,o,u,s,i,c){for(var n=f[0],a=f[1],g=o[0],p=o[1],y=i[0],v=i[1],b=u|=0,x=c|=0,T=0|f[1];T>0;){T<64?(a=T,T=0):(a=64,T-=64);for(var A=0|f[0];A>0;){A<64?(n=A,A=0):(n=64,A-=64),u=b+T*p+A*g,c=x+T*v+A*y;var S=0,w=0,E=p,k=g-a*p,L=v,M=y-a*v;for(w=0;w<n;++w){for(S=0;S<a;++S)l[u]=s[c],u+=E,c+=L;u+=k,c+=M}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(f,l,o,u,s,i,c){for(var n=f[0],a=f[1],g=f[2],p=o[0],y=o[1],v=o[2],b=i[0],x=i[1],T=i[2],A=u|=0,S=c|=0,w=0|f[2];w>0;){w<64?(g=w,w=0):(g=64,w-=64);for(var E=0|f[0];E>0;){E<64?(n=E,E=0):(n=64,E-=64);for(var k=0|f[1];k>0;){k<64?(a=k,k=0):(a=64,k-=64),u=A+w*v+E*p+k*y,c=S+w*T+E*b+k*x;var L=0,M=0,P=0,D=v,N=p-g*v,U=y-n*p,G=T,X=b-g*T,K=x-n*b;for(P=0;P<a;++P){for(M=0;M<n;++M){for(L=0;L<g;++L)l[u]=s[c],u+=D,c+=G;u+=N,c+=X}u+=U,c+=K}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(f,l,o,u,s,i,c){var n=f[0],a=f[1],g=f[2],p=o[0],y=o[1],v=o[2],b=i[0],x=i[1],T=i[2];u|=0,c|=0;var A=0,S=0,w=0,E=v,k=p-g*v,L=y-n*p,M=T,P=b-g*T,D=x-n*b;for(w=0;w<a;++w){for(S=0;S<n;++S){for(A=0;A<g;++A)l[u]=s[c],u+=E,c+=M;u+=k,c+=P}u+=L,c+=D}}}},d=function(f,l){var o=l.join(",");return(0,t[o])()},m={mul:function(f){var l={};return function(o,u,s){var i=o.dtype,c=o.order,n=u.dtype,a=u.order,g=s.dtype,p=s.order,y=[i,c.join(),n,a.join(),g,p.join()].join(),v=l[y];return v||(l[y]=v=f([i,c,n,a,g,p])),v(o.shape.slice(0),o.data,o.stride,0|o.offset,u.data,u.stride,0|u.offset,s.data,s.stride,0|s.offset)}},muls:function(f){var l={};return function(o,u,s){var i=o.dtype,c=o.order,n=u.dtype,a=u.order,g=[i,c.join(),n,a.join()].join(),p=l[g];return p||(l[g]=p=f([i,c,n,a])),p(o.shape.slice(0),o.data,o.stride,0|o.offset,u.data,u.stride,0|u.offset,s)}},mulseq:function(f){var l={};return function(o,u){var s=o.dtype,i=o.order,c=[s,i.join()].join(),n=l[c];return n||(l[c]=n=f([s,i])),n(o.shape.slice(0),o.data,o.stride,0|o.offset,u)}},div:function(f){var l={};return function(o,u,s){var i=o.dtype,c=o.order,n=u.dtype,a=u.order,g=s.dtype,p=s.order,y=[i,c.join(),n,a.join(),g,p.join()].join(),v=l[y];return v||(l[y]=v=f([i,c,n,a,g,p])),v(o.shape.slice(0),o.data,o.stride,0|o.offset,u.data,u.stride,0|u.offset,s.data,s.stride,0|s.offset)}},divs:function(f){var l={};return function(o,u,s){var i=o.dtype,c=o.order,n=u.dtype,a=u.order,g=[i,c.join(),n,a.join()].join(),p=l[g];return p||(l[g]=p=f([i,c,n,a])),p(o.shape.slice(0),o.data,o.stride,0|o.offset,u.data,u.stride,0|u.offset,s)}},divseq:function(f){var l={};return function(o,u){var s=o.dtype,i=o.order,c=[s,i.join()].join(),n=l[c];return n||(l[c]=n=f([s,i])),n(o.shape.slice(0),o.data,o.stride,0|o.offset,u)}},assign:function(f){var l={};return function(o,u){var s=o.dtype,i=o.order,c=u.dtype,n=u.order,a=[s,i.join(),c,n.join()].join(),g=l[a];return g||(l[a]=g=f([s,i,c,n])),g(o.shape.slice(0),o.data,o.stride,0|o.offset,u.data,u.stride,0|u.offset)}}};function h(f){return l={funcName:f.funcName},(0,m[l.funcName])(d.bind(void 0,l));var l}var e={mul:"*",div:"/"};(function(){for(var f in e)B[f]=h({funcName:f}),B[f+"s"]=h({funcName:f+"s"}),B[f+"seq"]=h({funcName:f+"seq"})})(),B.assign=h({funcName:"assign"})},{}],468:[function(r,I,B){var t=r("ndarray"),d=r("./doConvert.js");I.exports=function(m,h){for(var e=[],f=m,l=1;Array.isArray(f);)e.push(f.length),l*=f.length,f=f[0];return e.length===0?t():(h||(h=t(new Float64Array(l),e)),d(h,m),h)}},{"./doConvert.js":469,ndarray:472}],469:[function(r,I,B){var t,d=function(){return function(m,h,e,f,l){var o=m[0],u=m[1],s=m[2],i=e[0],c=e[1],n=e[2],a=[0,0,0];f|=0;var g=0,p=0,y=0,v=n,b=c-s*n,x=i-u*c;for(y=0;y<o;++y){for(p=0;p<u;++p){for(g=0;g<s;++g){var T,A=l;for(T=0;T<a.length-1;++T)A=A[a[T]];h[f]=A[a[a.length-1]],f+=v,++a[2]}f+=b,a[2]-=s,++a[1]}f+=x,a[1]-=u,++a[0]}}};I.exports=(t={funcName:"convert"},function(m){var h={};return function(e,f){var l=e.dtype,o=e.order,u=[l,o.join()].join(),s=h[u];return s||(h[u]=s=m([l,o])),s(e.shape.slice(0),e.data,e.stride,0|e.offset,f)}}(d.bind(void 0,t)))},{}],470:[function(r,I,B){var t=r("typedarray-pool");function d(f){switch(f){case"uint32":return[t.mallocUint32,t.freeUint32];default:return null}}var m={"uint32,1,0":function(f,l){return function(o,u,s,i,c,n,a,g,p,y,v){var b,x,T,A,S,w,E,k,L=o*c+i,M=f(g);for(b=o+1;b<=u;++b){for(x=b,T=L+=c,S=0,w=L,A=0;A<g;++A)M[S++]=s[w],w+=p;e:for(;x-- >o;){S=0,w=T-c;t:for(A=0;A<g;++A){if((E=s[w])<(k=M[S]))break e;if(E>k)break t;w+=y,S+=v}for(S=T,w=T-c,A=0;A<g;++A)s[S]=s[w],S+=p,w+=p;T-=c}for(S=T,w=0,A=0;A<g;++A)s[S]=M[w++],S+=p}l(M)}}},h={"uint32,1,0":function(f,l,o){return function u(s,i,c,n,a,g,p,y,v,b,x){var T,A,S,w,E,k,L,M,P,D,N,U,G,X,K,Z,H,Y,$,z,j,W,ee,J,Q,te=(i-s+1)/6|0,ie=s+te,ae=i-te,he=s+i>>1,se=he-te,de=he+te,ue=ie,ve=se,ke=he,Ee=de,be=ae,xe=s+1,ce=i-1,ge=!0,we=0,Me=0,Se=0,ze=y,Fe=l(ze),Ye=l(ze);N=a*ue,U=a*ve,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=ue,ue=ve,ve=A;break e}if(Se<0)break e;Q+=b}N=a*Ee,U=a*be,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=Ee,Ee=be,be=A;break e}if(Se<0)break e;Q+=b}N=a*ue,U=a*ke,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=ue,ue=ke,ke=A;break e}if(Se<0)break e;Q+=b}N=a*ve,U=a*ke,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=ve,ve=ke,ke=A;break e}if(Se<0)break e;Q+=b}N=a*ue,U=a*Ee,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=ue,ue=Ee,Ee=A;break e}if(Se<0)break e;Q+=b}N=a*ke,U=a*Ee,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=ke,ke=Ee,Ee=A;break e}if(Se<0)break e;Q+=b}N=a*ve,U=a*be,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=ve,ve=be,be=A;break e}if(Se<0)break e;Q+=b}N=a*ve,U=a*ke,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=ve,ve=ke,ke=A;break e}if(Se<0)break e;Q+=b}N=a*Ee,U=a*be,Q=n;e:for(D=0;D<y;++D){if(M=U+Q,(Se=c[L=N+Q]-c[M])>0){A=Ee,Ee=be,be=A;break e}if(Se<0)break e;Q+=b}for(N=a*ue,U=a*ve,G=a*ke,X=a*Ee,K=a*be,Z=a*ie,H=a*he,Y=a*ae,J=0,Q=n,D=0;D<y;++D)L=N+Q,M=U+Q,P=G+Q,$=X+Q,z=K+Q,j=Z+Q,W=H+Q,ee=Y+Q,Fe[J]=c[M],Ye[J]=c[$],ge=ge&&Fe[J]===Ye[J],S=c[L],w=c[P],E=c[z],c[j]=S,c[W]=w,c[ee]=E,++J,Q+=v;for(N=a*se,U=a*s,Q=n,D=0;D<y;++D)M=U+Q,c[L=N+Q]=c[M],Q+=v;for(N=a*de,U=a*i,Q=n,D=0;D<y;++D)M=U+Q,c[L=N+Q]=c[M],Q+=v;if(ge)for(k=xe;k<=ce;++k){for(L=n+k*a,J=0,D=0;D<y&&(Se=c[L]-Fe[J])==0;++D)J+=x,L+=b;if(Se!==0)if(Se<0){if(k!==xe)for(N=a*k,U=a*xe,Q=n,D=0;D<y;++D)M=U+Q,T=c[L=N+Q],c[L]=c[M],c[M]=T,Q+=v;++xe}else for(;;){for(L=n+ce*a,J=0,D=0;D<y&&(Se=c[L]-Fe[J])==0;++D)J+=x,L+=b;if(!(Se>0)){if(Se<0){for(N=a*k,U=a*xe,G=a*ce,Q=n,D=0;D<y;++D)M=U+Q,P=G+Q,T=c[L=N+Q],c[L]=c[M],c[M]=c[P],c[P]=T,Q+=v;++xe,--ce;break}for(N=a*k,U=a*ce,Q=n,D=0;D<y;++D)M=U+Q,T=c[L=N+Q],c[L]=c[M],c[M]=T,Q+=v;--ce;break}ce--}}else for(k=xe;k<=ce;++k){for(L=n+k*a,J=0,D=0;D<y&&(we=c[L]-Fe[J])==0;++D)J+=x,L+=b;if(we<0){if(k!==xe)for(N=a*k,U=a*xe,Q=n,D=0;D<y;++D)M=U+Q,T=c[L=N+Q],c[L]=c[M],c[M]=T,Q+=v;++xe}else{for(L=n+k*a,J=0,D=0;D<y&&(Me=c[L]-Ye[J])==0;++D)J+=x,L+=b;if(Me>0)for(;;){for(L=n+ce*a,J=0,D=0;D<y&&(Se=c[L]-Ye[J])==0;++D)J+=x,L+=b;if(!(Se>0)){for(L=n+ce*a,J=0,D=0;D<y&&(Se=c[L]-Fe[J])==0;++D)J+=x,L+=b;if(Se<0){for(N=a*k,U=a*xe,G=a*ce,Q=n,D=0;D<y;++D)M=U+Q,P=G+Q,T=c[L=N+Q],c[L]=c[M],c[M]=c[P],c[P]=T,Q+=v;++xe,--ce}else{for(N=a*k,U=a*ce,Q=n,D=0;D<y;++D)M=U+Q,T=c[L=N+Q],c[L]=c[M],c[M]=T,Q+=v;--ce}break}if(--ce<k)break}}}for(N=a*s,U=a*(xe-1),J=0,Q=n,D=0;D<y;++D)M=U+Q,c[L=N+Q]=c[M],c[M]=Fe[J],++J,Q+=v;for(N=a*i,U=a*(ce+1),J=0,Q=n,D=0;D<y;++D)M=U+Q,c[L=N+Q]=c[M],c[M]=Ye[J],++J,Q+=v;if(xe-2-s<=32?f(s,xe-2,c,n,a,g,p,y,v,b,x):u(s,xe-2,c,n,a,g,p,y,v,b,x),i-(ce+2)<=32?f(ce+2,i,c,n,a,g,p,y,v,b,x):u(ce+2,i,c,n,a,g,p,y,v,b,x),ge)return o(Fe),void o(Ye);if(xe<ie&&ce>ae){e:for(;;){for(L=n+xe*a,J=0,Q=n,D=0;D<y;++D){if(c[L]!==Fe[J])break e;++J,L+=v}++xe}e:for(;;){for(L=n+ce*a,J=0,Q=n,D=0;D<y;++D){if(c[L]!==Ye[J])break e;++J,L+=v}--ce}for(k=xe;k<=ce;++k){for(L=n+k*a,J=0,D=0;D<y&&(we=c[L]-Fe[J])==0;++D)J+=x,L+=b;if(we===0){if(k!==xe)for(N=a*k,U=a*xe,Q=n,D=0;D<y;++D)M=U+Q,T=c[L=N+Q],c[L]=c[M],c[M]=T,Q+=v;++xe}else{for(L=n+k*a,J=0,D=0;D<y&&(Me=c[L]-Ye[J])==0;++D)J+=x,L+=b;if(Me===0)for(;;){for(L=n+ce*a,J=0,D=0;D<y&&(Se=c[L]-Ye[J])==0;++D)J+=x,L+=b;if(Se!==0){for(L=n+ce*a,J=0,D=0;D<y&&(Se=c[L]-Fe[J])==0;++D)J+=x,L+=b;if(Se<0){for(N=a*k,U=a*xe,G=a*ce,Q=n,D=0;D<y;++D)M=U+Q,P=G+Q,T=c[L=N+Q],c[L]=c[M],c[M]=c[P],c[P]=T,Q+=v;++xe,--ce}else{for(N=a*k,U=a*ce,Q=n,D=0;D<y;++D)M=U+Q,T=c[L=N+Q],c[L]=c[M],c[M]=T,Q+=v;--ce}break}if(--ce<k)break}}}}o(Fe),o(Ye),ce-xe<=32?f(xe,ce,c,n,a,g,p,y,v,b,x):u(xe,ce,c,n,a,g,p,y,v,b,x)}}},e={"uint32,1,0":function(f,l){return function(o){var u=o.data,s=0|o.offset,i=o.shape,c=o.stride,n=0|c[0],a=0|i[0],g=0|c[1],p=0|i[1],y=g,v=g;a<=32?f(0,a-1,u,s,n,g,a,p,y,v,1):l(0,a-1,u,s,n,g,a,p,y,v,1)}}};I.exports=function(f,l){var o=[l,f].join(","),u=e[o],s=function(c,n){var a=d(n),g=[n,c].join(","),p=m[g];return a?p(a[0],a[1]):p()}(f,l),i=function(c,n,a){var g=d(n),p=[n,c].join(","),y=h[p];return c.length>1&&g?y(a,g[0],g[1]):y(a)}(f,l,s);return u(s,i)}},{"typedarray-pool":601}],471:[function(r,I,B){var t=r("./lib/compile_sort.js"),d={};I.exports=function(m){var h=m.order,e=m.dtype,f=[h,e].join(":"),l=d[f];return l||(d[f]=l=t(h,e)),l(m),m}},{"./lib/compile_sort.js":470}],472:[function(r,I,B){var t=r("is-buffer"),d=typeof Float64Array!="undefined";function m(o,u){return o[0]-u[0]}function h(){var o,u=this.stride,s=new Array(u.length);for(o=0;o<s.length;++o)s[o]=[Math.abs(u[o]),o];s.sort(m);var i=new Array(s.length);for(o=0;o<i.length;++o)i[o]=s[o][1];return i}var e={T:function(o){function u(i){this.data=i}var s=u.prototype;return s.dtype=o,s.index=function(){return-1},s.size=0,s.dimension=-1,s.shape=s.stride=s.order=[],s.lo=s.hi=s.transpose=s.step=function(){return new u(this.data)},s.get=s.set=function(){},s.pick=function(){return null},function(i){return new u(i)}},0:function(o,u){function s(c,n){this.data=c,this.offset=n}var i=s.prototype;return i.dtype=o,i.index=function(){return this.offset},i.dimension=0,i.size=1,i.shape=i.stride=i.order=[],i.lo=i.hi=i.transpose=i.step=function(){return new s(this.data,this.offset)},i.pick=function(){return u(this.data)},i.valueOf=i.get=function(){return o==="generic"?this.data.get(this.offset):this.data[this.offset]},i.set=function(c){return o==="generic"?this.data.set(this.offset,c):this.data[this.offset]=c},function(c,n,a,g){return new s(c,g)}},1:function(o,u,s){function i(n,a,g,p){this.data=n,this.shape=[a],this.stride=[g],this.offset=0|p}var c=i.prototype;return c.dtype=o,c.dimension=1,Object.defineProperty(c,"size",{get:function(){return this.shape[0]}}),c.order=[0],c.set=function(n,a){return o==="generic"?this.data.set(this.offset+this.stride[0]*n,a):this.data[this.offset+this.stride[0]*n]=a},c.get=function(n){return o==="generic"?this.data.get(this.offset+this.stride[0]*n):this.data[this.offset+this.stride[0]*n]},c.index=function(n){return this.offset+this.stride[0]*n},c.hi=function(n){return new i(this.data,typeof n!="number"||n<0?this.shape[0]:0|n,this.stride[0],this.offset)},c.lo=function(n){var a=this.offset,g=0,p=this.shape[0],y=this.stride[0];return typeof n=="number"&&n>=0&&(a+=y*(g=0|n),p-=g),new i(this.data,p,y,a)},c.step=function(n){var a=this.shape[0],g=this.stride[0],p=this.offset,y=0,v=Math.ceil;return typeof n=="number"&&((y=0|n)<0?(p+=g*(a-1),a=v(-a/y)):a=v(a/y),g*=y),new i(this.data,a,g,p)},c.transpose=function(n){n=n===void 0?0:0|n;var a=this.shape,g=this.stride;return new i(this.data,a[n],g[n],this.offset)},c.pick=function(n){var a=[],g=[],p=this.offset;return typeof n=="number"&&n>=0?p=p+this.stride[0]*n|0:(a.push(this.shape[0]),g.push(this.stride[0])),(0,u[a.length+1])(this.data,a,g,p)},function(n,a,g,p){return new i(n,a[0],g[0],p)}},2:function(o,u,s){function i(n,a,g,p,y,v){this.data=n,this.shape=[a,g],this.stride=[p,y],this.offset=0|v}var c=i.prototype;return c.dtype=o,c.dimension=2,Object.defineProperty(c,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(c,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),c.set=function(n,a,g){return o==="generic"?this.data.set(this.offset+this.stride[0]*n+this.stride[1]*a,g):this.data[this.offset+this.stride[0]*n+this.stride[1]*a]=g},c.get=function(n,a){return o==="generic"?this.data.get(this.offset+this.stride[0]*n+this.stride[1]*a):this.data[this.offset+this.stride[0]*n+this.stride[1]*a]},c.index=function(n,a){return this.offset+this.stride[0]*n+this.stride[1]*a},c.hi=function(n,a){return new i(this.data,typeof n!="number"||n<0?this.shape[0]:0|n,typeof a!="number"||a<0?this.shape[1]:0|a,this.stride[0],this.stride[1],this.offset)},c.lo=function(n,a){var g=this.offset,p=0,y=this.shape[0],v=this.shape[1],b=this.stride[0],x=this.stride[1];return typeof n=="number"&&n>=0&&(g+=b*(p=0|n),y-=p),typeof a=="number"&&a>=0&&(g+=x*(p=0|a),v-=p),new i(this.data,y,v,b,x,g)},c.step=function(n,a){var g=this.shape[0],p=this.shape[1],y=this.stride[0],v=this.stride[1],b=this.offset,x=0,T=Math.ceil;return typeof n=="number"&&((x=0|n)<0?(b+=y*(g-1),g=T(-g/x)):g=T(g/x),y*=x),typeof a=="number"&&((x=0|a)<0?(b+=v*(p-1),p=T(-p/x)):p=T(p/x),v*=x),new i(this.data,g,p,y,v,b)},c.transpose=function(n,a){n=n===void 0?0:0|n,a=a===void 0?1:0|a;var g=this.shape,p=this.stride;return new i(this.data,g[n],g[a],p[n],p[a],this.offset)},c.pick=function(n,a){var g=[],p=[],y=this.offset;return typeof n=="number"&&n>=0?y=y+this.stride[0]*n|0:(g.push(this.shape[0]),p.push(this.stride[0])),typeof a=="number"&&a>=0?y=y+this.stride[1]*a|0:(g.push(this.shape[1]),p.push(this.stride[1])),(0,u[g.length+1])(this.data,g,p,y)},function(n,a,g,p){return new i(n,a[0],a[1],g[0],g[1],p)}},3:function(o,u,s){function i(n,a,g,p,y,v,b,x){this.data=n,this.shape=[a,g,p],this.stride=[y,v,b],this.offset=0|x}var c=i.prototype;return c.dtype=o,c.dimension=3,Object.defineProperty(c,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(c,"order",{get:function(){var n=Math.abs(this.stride[0]),a=Math.abs(this.stride[1]),g=Math.abs(this.stride[2]);return n>a?a>g?[2,1,0]:n>g?[1,2,0]:[1,0,2]:n>g?[2,0,1]:g>a?[0,1,2]:[0,2,1]}}),c.set=function(n,a,g,p){return o==="generic"?this.data.set(this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g,p):this.data[this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g]=p},c.get=function(n,a,g){return o==="generic"?this.data.get(this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g):this.data[this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g]},c.index=function(n,a,g){return this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g},c.hi=function(n,a,g){return new i(this.data,typeof n!="number"||n<0?this.shape[0]:0|n,typeof a!="number"||a<0?this.shape[1]:0|a,typeof g!="number"||g<0?this.shape[2]:0|g,this.stride[0],this.stride[1],this.stride[2],this.offset)},c.lo=function(n,a,g){var p=this.offset,y=0,v=this.shape[0],b=this.shape[1],x=this.shape[2],T=this.stride[0],A=this.stride[1],S=this.stride[2];return typeof n=="number"&&n>=0&&(p+=T*(y=0|n),v-=y),typeof a=="number"&&a>=0&&(p+=A*(y=0|a),b-=y),typeof g=="number"&&g>=0&&(p+=S*(y=0|g),x-=y),new i(this.data,v,b,x,T,A,S,p)},c.step=function(n,a,g){var p=this.shape[0],y=this.shape[1],v=this.shape[2],b=this.stride[0],x=this.stride[1],T=this.stride[2],A=this.offset,S=0,w=Math.ceil;return typeof n=="number"&&((S=0|n)<0?(A+=b*(p-1),p=w(-p/S)):p=w(p/S),b*=S),typeof a=="number"&&((S=0|a)<0?(A+=x*(y-1),y=w(-y/S)):y=w(y/S),x*=S),typeof g=="number"&&((S=0|g)<0?(A+=T*(v-1),v=w(-v/S)):v=w(v/S),T*=S),new i(this.data,p,y,v,b,x,T,A)},c.transpose=function(n,a,g){n=n===void 0?0:0|n,a=a===void 0?1:0|a,g=g===void 0?2:0|g;var p=this.shape,y=this.stride;return new i(this.data,p[n],p[a],p[g],y[n],y[a],y[g],this.offset)},c.pick=function(n,a,g){var p=[],y=[],v=this.offset;return typeof n=="number"&&n>=0?v=v+this.stride[0]*n|0:(p.push(this.shape[0]),y.push(this.stride[0])),typeof a=="number"&&a>=0?v=v+this.stride[1]*a|0:(p.push(this.shape[1]),y.push(this.stride[1])),typeof g=="number"&&g>=0?v=v+this.stride[2]*g|0:(p.push(this.shape[2]),y.push(this.stride[2])),(0,u[p.length+1])(this.data,p,y,v)},function(n,a,g,p){return new i(n,a[0],a[1],a[2],g[0],g[1],g[2],p)}},4:function(o,u,s){function i(n,a,g,p,y,v,b,x,T,A){this.data=n,this.shape=[a,g,p,y],this.stride=[v,b,x,T],this.offset=0|A}var c=i.prototype;return c.dtype=o,c.dimension=4,Object.defineProperty(c,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(c,"order",{get:s}),c.set=function(n,a,g,p,y){return o==="generic"?this.data.set(this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*p,y):this.data[this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*p]=y},c.get=function(n,a,g,p){return o==="generic"?this.data.get(this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*p):this.data[this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*p]},c.index=function(n,a,g,p){return this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*p},c.hi=function(n,a,g,p){return new i(this.data,typeof n!="number"||n<0?this.shape[0]:0|n,typeof a!="number"||a<0?this.shape[1]:0|a,typeof g!="number"||g<0?this.shape[2]:0|g,typeof p!="number"||p<0?this.shape[3]:0|p,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},c.lo=function(n,a,g,p){var y=this.offset,v=0,b=this.shape[0],x=this.shape[1],T=this.shape[2],A=this.shape[3],S=this.stride[0],w=this.stride[1],E=this.stride[2],k=this.stride[3];return typeof n=="number"&&n>=0&&(y+=S*(v=0|n),b-=v),typeof a=="number"&&a>=0&&(y+=w*(v=0|a),x-=v),typeof g=="number"&&g>=0&&(y+=E*(v=0|g),T-=v),typeof p=="number"&&p>=0&&(y+=k*(v=0|p),A-=v),new i(this.data,b,x,T,A,S,w,E,k,y)},c.step=function(n,a,g,p){var y=this.shape[0],v=this.shape[1],b=this.shape[2],x=this.shape[3],T=this.stride[0],A=this.stride[1],S=this.stride[2],w=this.stride[3],E=this.offset,k=0,L=Math.ceil;return typeof n=="number"&&((k=0|n)<0?(E+=T*(y-1),y=L(-y/k)):y=L(y/k),T*=k),typeof a=="number"&&((k=0|a)<0?(E+=A*(v-1),v=L(-v/k)):v=L(v/k),A*=k),typeof g=="number"&&((k=0|g)<0?(E+=S*(b-1),b=L(-b/k)):b=L(b/k),S*=k),typeof p=="number"&&((k=0|p)<0?(E+=w*(x-1),x=L(-x/k)):x=L(x/k),w*=k),new i(this.data,y,v,b,x,T,A,S,w,E)},c.transpose=function(n,a,g,p){n=n===void 0?0:0|n,a=a===void 0?1:0|a,g=g===void 0?2:0|g,p=p===void 0?3:0|p;var y=this.shape,v=this.stride;return new i(this.data,y[n],y[a],y[g],y[p],v[n],v[a],v[g],v[p],this.offset)},c.pick=function(n,a,g,p){var y=[],v=[],b=this.offset;return typeof n=="number"&&n>=0?b=b+this.stride[0]*n|0:(y.push(this.shape[0]),v.push(this.stride[0])),typeof a=="number"&&a>=0?b=b+this.stride[1]*a|0:(y.push(this.shape[1]),v.push(this.stride[1])),typeof g=="number"&&g>=0?b=b+this.stride[2]*g|0:(y.push(this.shape[2]),v.push(this.stride[2])),typeof p=="number"&&p>=0?b=b+this.stride[3]*p|0:(y.push(this.shape[3]),v.push(this.stride[3])),(0,u[y.length+1])(this.data,y,v,b)},function(n,a,g,p){return new i(n,a[0],a[1],a[2],a[3],g[0],g[1],g[2],g[3],p)}},5:function(o,u,s){function i(n,a,g,p,y,v,b,x,T,A,S,w){this.data=n,this.shape=[a,g,p,y,v],this.stride=[b,x,T,A,S],this.offset=0|w}var c=i.prototype;return c.dtype=o,c.dimension=5,Object.defineProperty(c,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(c,"order",{get:s}),c.set=function(n,a,g,p,y,v){return o==="generic"?this.data.set(this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*p+this.stride[4]*y,v):this.data[this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*p+this.stride[4]*y]=v},c.get=function(n,a,g,p,y){return o==="generic"?this.data.get(this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*p+this.stride[4]*y):this.data[this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*p+this.stride[4]*y]},c.index=function(n,a,g,p,y){return this.offset+this.stride[0]*n+this.stride[1]*a+this.stride[2]*g+this.stride[3]*p+this.stride[4]*y},c.hi=function(n,a,g,p,y){return new i(this.data,typeof n!="number"||n<0?this.shape[0]:0|n,typeof a!="number"||a<0?this.shape[1]:0|a,typeof g!="number"||g<0?this.shape[2]:0|g,typeof p!="number"||p<0?this.shape[3]:0|p,typeof y!="number"||y<0?this.shape[4]:0|y,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},c.lo=function(n,a,g,p,y){var v=this.offset,b=0,x=this.shape[0],T=this.shape[1],A=this.shape[2],S=this.shape[3],w=this.shape[4],E=this.stride[0],k=this.stride[1],L=this.stride[2],M=this.stride[3],P=this.stride[4];return typeof n=="number"&&n>=0&&(v+=E*(b=0|n),x-=b),typeof a=="number"&&a>=0&&(v+=k*(b=0|a),T-=b),typeof g=="number"&&g>=0&&(v+=L*(b=0|g),A-=b),typeof p=="number"&&p>=0&&(v+=M*(b=0|p),S-=b),typeof y=="number"&&y>=0&&(v+=P*(b=0|y),w-=b),new i(this.data,x,T,A,S,w,E,k,L,M,P,v)},c.step=function(n,a,g,p,y){var v=this.shape[0],b=this.shape[1],x=this.shape[2],T=this.shape[3],A=this.shape[4],S=this.stride[0],w=this.stride[1],E=this.stride[2],k=this.stride[3],L=this.stride[4],M=this.offset,P=0,D=Math.ceil;return typeof n=="number"&&((P=0|n)<0?(M+=S*(v-1),v=D(-v/P)):v=D(v/P),S*=P),typeof a=="number"&&((P=0|a)<0?(M+=w*(b-1),b=D(-b/P)):b=D(b/P),w*=P),typeof g=="number"&&((P=0|g)<0?(M+=E*(x-1),x=D(-x/P)):x=D(x/P),E*=P),typeof p=="number"&&((P=0|p)<0?(M+=k*(T-1),T=D(-T/P)):T=D(T/P),k*=P),typeof y=="number"&&((P=0|y)<0?(M+=L*(A-1),A=D(-A/P)):A=D(A/P),L*=P),new i(this.data,v,b,x,T,A,S,w,E,k,L,M)},c.transpose=function(n,a,g,p,y){n=n===void 0?0:0|n,a=a===void 0?1:0|a,g=g===void 0?2:0|g,p=p===void 0?3:0|p,y=y===void 0?4:0|y;var v=this.shape,b=this.stride;return new i(this.data,v[n],v[a],v[g],v[p],v[y],b[n],b[a],b[g],b[p],b[y],this.offset)},c.pick=function(n,a,g,p,y){var v=[],b=[],x=this.offset;return typeof n=="number"&&n>=0?x=x+this.stride[0]*n|0:(v.push(this.shape[0]),b.push(this.stride[0])),typeof a=="number"&&a>=0?x=x+this.stride[1]*a|0:(v.push(this.shape[1]),b.push(this.stride[1])),typeof g=="number"&&g>=0?x=x+this.stride[2]*g|0:(v.push(this.shape[2]),b.push(this.stride[2])),typeof p=="number"&&p>=0?x=x+this.stride[3]*p|0:(v.push(this.shape[3]),b.push(this.stride[3])),typeof y=="number"&&y>=0?x=x+this.stride[4]*y|0:(v.push(this.shape[4]),b.push(this.stride[4])),(0,u[v.length+1])(this.data,v,b,x)},function(n,a,g,p){return new i(n,a[0],a[1],a[2],a[3],a[4],g[0],g[1],g[2],g[3],g[4],p)}}};function f(o,u){var s=u===-1?"T":String(u),i=e[s];return u===-1?i(o):u===0?i(o,l[o][0]):i(o,l[o],h)}var l={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};I.exports=function(o,u,s,i){if(o===void 0)return(0,l.array[0])([]);typeof o=="number"&&(o=[o]),u===void 0&&(u=[o.length]);var c=u.length;if(s===void 0){s=new Array(c);for(var n=c-1,a=1;n>=0;--n)s[n]=a,a*=u[n]}if(i===void 0)for(i=0,n=0;n<c;++n)s[n]<0&&(i-=(u[n]-1)*s[n]);for(var g=function(y){if(t(y))return"buffer";if(d)switch(Object.prototype.toString.call(y)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(y)?"array":"generic"}(o),p=l[g];p.length<=c+1;)p.push(f(g,p.length-1));return(0,p[c+1])(o,u,s,i)}},{"is-buffer":443}],473:[function(r,I,B){var t=r("double-bits"),d=Math.pow(2,-1074);I.exports=function(m,h){if(isNaN(m)||isNaN(h))return NaN;if(m===h)return m;if(m===0)return h<0?-d:d;var e=t.hi(m),f=t.lo(m);return h>m==m>0?f===-1>>>0?(e+=1,f=0):f+=1:f===0?(f=-1>>>0,e-=1):f-=1,t.pack(f,e)}},{"double-bits":179}],474:[function(r,I,B){var t=Math.PI,d=l(120);function m(o,u,s,i){return["C",o,u,s,i,s,i]}function h(o,u,s,i,c,n){return["C",o/3+2/3*s,u/3+2/3*i,c/3+2/3*s,n/3+2/3*i,c,n]}function e(o,u,s,i,c,n,a,g,p,y){if(y)L=y[0],M=y[1],E=y[2],k=y[3];else{var v=f(o,u,-c);o=v.x,u=v.y;var b=(o-(g=(v=f(g,p,-c)).x))/2,x=(u-(p=v.y))/2,T=b*b/(s*s)+x*x/(i*i);T>1&&(s*=T=Math.sqrt(T),i*=T);var A=s*s,S=i*i,w=(n==a?-1:1)*Math.sqrt(Math.abs((A*S-A*x*x-S*b*b)/(A*x*x+S*b*b)));w==1/0&&(w=1);var E=w*s*x/i+(o+g)/2,k=w*-i*b/s+(u+p)/2,L=Math.asin(((u-k)/i).toFixed(9)),M=Math.asin(((p-k)/i).toFixed(9));(L=o<E?t-L:L)<0&&(L=2*t+L),(M=g<E?t-M:M)<0&&(M=2*t+M),a&&L>M&&(L-=2*t),!a&&M>L&&(M-=2*t)}if(Math.abs(M-L)>d){var P=M,D=g,N=p;M=L+d*(a&&M>L?1:-1);var U=e(g=E+s*Math.cos(M),p=k+i*Math.sin(M),s,i,c,0,a,D,N,[M,P,E,k])}var G=Math.tan((M-L)/4),X=4/3*s*G,K=4/3*i*G,Z=[2*o-(o+X*Math.sin(L)),2*u-(u-K*Math.cos(L)),g+X*Math.sin(M),p-K*Math.cos(M),g,p];if(y)return Z;U&&(Z=Z.concat(U));for(var H=0;H<Z.length;){var Y=f(Z[H],Z[H+1],c);Z[H++]=Y.x,Z[H++]=Y.y}return Z}function f(o,u,s){return{x:o*Math.cos(s)-u*Math.sin(s),y:o*Math.sin(s)+u*Math.cos(s)}}function l(o){return o*(t/180)}I.exports=function(o){for(var u,s=[],i=0,c=0,n=0,a=0,g=null,p=null,y=0,v=0,b=0,x=o.length;b<x;b++){var T=o[b],A=T[0];switch(A){case"M":n=T[1],a=T[2];break;case"A":(T=e(y,v,T[1],T[2],l(T[3]),T[4],T[5],T[6],T[7])).unshift("C"),T.length>7&&(s.push(T.splice(0,7)),T.unshift("C"));break;case"S":var S=y,w=v;u!="C"&&u!="S"||(S+=S-i,w+=w-c),T=["C",S,w,T[1],T[2],T[3],T[4]];break;case"T":u=="Q"||u=="T"?(g=2*y-g,p=2*v-p):(g=y,p=v),T=h(y,v,g,p,T[1],T[2]);break;case"Q":g=T[1],p=T[2],T=h(y,v,T[1],T[2],T[3],T[4]);break;case"L":T=m(y,v,T[1],T[2]);break;case"H":T=m(y,v,T[1],v);break;case"V":T=m(y,v,y,T[1]);break;case"Z":T=m(y,v,n,a)}u=A,y=T[T.length-2],v=T[T.length-1],T.length>4?(i=T[T.length-4],c=T[T.length-3]):(i=y,c=v),s.push(T)}return s}},{}],475:[function(r,I,B){B.vertexNormals=function(t,d,m){for(var h=d.length,e=new Array(h),f=m===void 0?1e-6:m,l=0;l<h;++l)e[l]=[0,0,0];for(l=0;l<t.length;++l)for(var o=t[l],u=0,s=o[o.length-1],i=o[0],c=0;c<o.length;++c){u=s,s=i,i=o[(c+1)%o.length];for(var n=d[u],a=d[s],g=d[i],p=new Array(3),y=0,v=new Array(3),b=0,x=0;x<3;++x)p[x]=n[x]-a[x],y+=p[x]*p[x],v[x]=g[x]-a[x],b+=v[x]*v[x];if(y*b>f){var T=e[s],A=1/Math.sqrt(y*b);for(x=0;x<3;++x){var S=(x+1)%3,w=(x+2)%3;T[x]+=A*(v[S]*p[w]-v[w]*p[S])}}}for(l=0;l<h;++l){T=e[l];var E=0;for(x=0;x<3;++x)E+=T[x]*T[x];if(E>f)for(A=1/Math.sqrt(E),x=0;x<3;++x)T[x]*=A;else for(x=0;x<3;++x)T[x]=0}return e},B.faceNormals=function(t,d,m){for(var h=t.length,e=new Array(h),f=m===void 0?1e-6:m,l=0;l<h;++l){for(var o=t[l],u=new Array(3),s=0;s<3;++s)u[s]=d[o[s]];var i=new Array(3),c=new Array(3);for(s=0;s<3;++s)i[s]=u[1][s]-u[0][s],c[s]=u[2][s]-u[0][s];var n=new Array(3),a=0;for(s=0;s<3;++s){var g=(s+1)%3,p=(s+2)%3;n[s]=i[g]*c[p]-i[p]*c[g],a+=n[s]*n[s]}for(a=a>f?1/Math.sqrt(a):0,s=0;s<3;++s)n[s]*=a;e[l]=n}return e}},{}],476:[function(r,I,B){var t=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable;function h(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}I.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var f={},l=0;l<10;l++)f["_"+String.fromCharCode(l)]=l;if(Object.getOwnPropertyNames(f).map(function(u){return f[u]}).join("")!=="0123456789")return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(u){o[u]=u}),Object.keys(Object.assign({},o)).join("")==="abcdefghijklmnopqrst"}catch(u){return!1}}()?Object.assign:function(e,f){for(var l,o,u=h(e),s=1;s<arguments.length;s++){for(var i in l=Object(arguments[s]))d.call(l,i)&&(u[i]=l[i]);if(t){o=t(l);for(var c=0;c<o.length;c++)m.call(l,o[c])&&(u[o[c]]=l[o[c]])}}return u}},{}],477:[function(r,I,B){I.exports=function(t,d,m,h,e,f,l,o,u,s){var i=d+f+s;if(c>0){var c=Math.sqrt(i+1);t[0]=.5*(l-u)/c,t[1]=.5*(o-h)/c,t[2]=.5*(m-f)/c,t[3]=.5*c}else{var n=Math.max(d,f,s);c=Math.sqrt(2*n-i+1),d>=n?(t[0]=.5*c,t[1]=.5*(e+m)/c,t[2]=.5*(o+h)/c,t[3]=.5*(l-u)/c):f>=n?(t[0]=.5*(m+e)/c,t[1]=.5*c,t[2]=.5*(u+l)/c,t[3]=.5*(o-h)/c):(t[0]=.5*(h+o)/c,t[1]=.5*(l+u)/c,t[2]=.5*c,t[3]=.5*(m-e)/c)}return t}},{}],478:[function(r,I,B){I.exports=function(i){var c=(i=i||{}).center||[0,0,0],n=i.rotation||[0,0,0,1],a=i.radius||1;c=[].slice.call(c,0,3),o(n=[].slice.call(n,0,4),n);var g=new u(n,c,Math.log(a));return g.setDistanceLimits(i.zoomMin,i.zoomMax),("eye"in i||"up"in i)&&g.lookAt(0,i.eye,i.center,i.up),g};var t=r("filtered-vector"),d=r("gl-mat4/lookAt"),m=r("gl-mat4/fromQuat"),h=r("gl-mat4/invert"),e=r("./lib/quatFromFrame");function f(i,c,n){return Math.sqrt(Math.pow(i,2)+Math.pow(c,2)+Math.pow(n,2))}function l(i,c,n,a){return Math.sqrt(Math.pow(i,2)+Math.pow(c,2)+Math.pow(n,2)+Math.pow(a,2))}function o(i,c){var n=c[0],a=c[1],g=c[2],p=c[3],y=l(n,a,g,p);y>1e-6?(i[0]=n/y,i[1]=a/y,i[2]=g/y,i[3]=p/y):(i[0]=i[1]=i[2]=0,i[3]=1)}function u(i,c,n){this.radius=t([n]),this.center=t(c),this.rotation=t(i),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var s=u.prototype;s.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},s.recalcMatrix=function(i){this.radius.curve(i),this.center.curve(i),this.rotation.curve(i);var c=this.computedRotation;o(c,c);var n=this.computedMatrix;m(n,c);var a=this.computedCenter,g=this.computedEye,p=this.computedUp,y=Math.exp(this.computedRadius[0]);g[0]=a[0]+y*n[2],g[1]=a[1]+y*n[6],g[2]=a[2]+y*n[10],p[0]=n[1],p[1]=n[5],p[2]=n[9];for(var v=0;v<3;++v){for(var b=0,x=0;x<3;++x)b+=n[v+4*x]*g[x];n[12+v]=-b}},s.getMatrix=function(i,c){this.recalcMatrix(i);var n=this.computedMatrix;if(c){for(var a=0;a<16;++a)c[a]=n[a];return c}return n},s.idle=function(i){this.center.idle(i),this.radius.idle(i),this.rotation.idle(i)},s.flush=function(i){this.center.flush(i),this.radius.flush(i),this.rotation.flush(i)},s.pan=function(i,c,n,a){c=c||0,n=n||0,a=a||0,this.recalcMatrix(i);var g=this.computedMatrix,p=g[1],y=g[5],v=g[9],b=f(p,y,v);p/=b,y/=b,v/=b;var x=g[0],T=g[4],A=g[8],S=x*p+T*y+A*v,w=f(x-=p*S,T-=y*S,A-=v*S);x/=w,T/=w,A/=w,g[2],g[6],g[10];var E=x*c+p*n,k=T*c+y*n,L=A*c+v*n;this.center.move(i,E,k,L);var M=Math.exp(this.computedRadius[0]);M=Math.max(1e-4,M+a),this.radius.set(i,Math.log(M))},s.rotate=function(i,c,n,a){this.recalcMatrix(i),c=c||0,n=n||0;var g=this.computedMatrix,p=g[0],y=g[4],v=g[8],b=g[1],x=g[5],T=g[9],A=g[2],S=g[6],w=g[10],E=c*p+n*b,k=c*y+n*x,L=c*v+n*T,M=-(S*L-w*k),P=-(w*E-A*L),D=-(A*k-S*E),N=Math.sqrt(Math.max(0,1-Math.pow(M,2)-Math.pow(P,2)-Math.pow(D,2))),U=l(M,P,D,N);U>1e-6?(M/=U,P/=U,D/=U,N/=U):(M=P=D=0,N=1);var G=this.computedRotation,X=G[0],K=G[1],Z=G[2],H=G[3],Y=X*N+H*M+K*D-Z*P,$=K*N+H*P+Z*M-X*D,z=Z*N+H*D+X*P-K*M,j=H*N-X*M-K*P-Z*D;if(a){M=A,P=S,D=w;var W=Math.sin(a)/f(M,P,D);M*=W,P*=W,D*=W,j=j*(N=Math.cos(c))-(Y=Y*N+j*M+$*D-z*P)*M-($=$*N+j*P+z*M-Y*D)*P-(z=z*N+j*D+Y*P-$*M)*D}var ee=l(Y,$,z,j);ee>1e-6?(Y/=ee,$/=ee,z/=ee,j/=ee):(Y=$=z=0,j=1),this.rotation.set(i,Y,$,z,j)},s.lookAt=function(i,c,n,a){this.recalcMatrix(i),n=n||this.computedCenter,c=c||this.computedEye,a=a||this.computedUp;var g=this.computedMatrix;d(g,c,n,a);var p=this.computedRotation;e(p,g[0],g[1],g[2],g[4],g[5],g[6],g[8],g[9],g[10]),o(p,p),this.rotation.set(i,p[0],p[1],p[2],p[3]);for(var y=0,v=0;v<3;++v)y+=Math.pow(n[v]-c[v],2);this.radius.set(i,.5*Math.log(Math.max(y,1e-6))),this.center.set(i,n[0],n[1],n[2])},s.translate=function(i,c,n,a){this.center.move(i,c||0,n||0,a||0)},s.setMatrix=function(i,c){var n=this.computedRotation;e(n,c[0],c[1],c[2],c[4],c[5],c[6],c[8],c[9],c[10]),o(n,n),this.rotation.set(i,n[0],n[1],n[2],n[3]);var a=this.computedMatrix;h(a,c);var g=a[15];if(Math.abs(g)>1e-6){var p=a[12]/g,y=a[13]/g,v=a[14]/g;this.recalcMatrix(i);var b=Math.exp(this.computedRadius[0]);this.center.set(i,p-a[2]*b,y-a[6]*b,v-a[10]*b),this.radius.idle(i)}else this.center.idle(i),this.radius.idle(i)},s.setDistance=function(i,c){c>0&&this.radius.set(i,Math.log(c))},s.setDistanceLimits=function(i,c){i=i>0?Math.log(i):-1/0,c=c>0?Math.log(c):1/0,c=Math.max(c,i),this.radius.bounds[0][0]=i,this.radius.bounds[1][0]=c},s.getDistanceLimits=function(i){var c=this.radius.bounds;return i?(i[0]=Math.exp(c[0][0]),i[1]=Math.exp(c[1][0]),i):[Math.exp(c[0][0]),Math.exp(c[1][0])]},s.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},s.fromJSON=function(i){var c=this.lastT(),n=i.center;n&&this.center.set(c,n[0],n[1],n[2]);var a=i.rotation;a&&this.rotation.set(c,a[0],a[1],a[2],a[3]);var g=i.distance;g&&g>0&&this.radius.set(c,Math.log(g)),this.setDistanceLimits(i.zoomMin,i.zoomMax)}},{"./lib/quatFromFrame":477,"filtered-vector":247,"gl-mat4/fromQuat":282,"gl-mat4/invert":293,"gl-mat4/lookAt":294}],479:[function(r,I,B){var t=r("repeat-string");I.exports=function(d,m,h){return t(h=h!==void 0?h+"":" ",m)+d}},{"repeat-string":527}],480:[function(r,I,B){function t(h,e){if(typeof h!="string")return[h];var f=[h];typeof e=="string"||Array.isArray(e)?e={brackets:e}:e||(e={});var l=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],o=e.escape||"___",u=!!e.flat;l.forEach(function(i){var c=new RegExp(["\\",i[0],"[^\\",i[0],"\\",i[1],"]*\\",i[1]].join("")),n=[];function a(g,p,y){var v=f.push(g.slice(i[0].length,-i[1].length))-1;return n.push(v),o+v+o}f.forEach(function(g,p){for(var y,v=0;g!=y;)if(y=g,g=g.replace(c,a),v++>1e4)throw Error("References have circular dependency. Please, check them.");f[p]=g}),n=n.reverse(),f=f.map(function(g){return n.forEach(function(p){g=g.replace(new RegExp("(\\"+o+p+"\\"+o+")","g"),i[0]+"$1"+i[1])}),g})});var s=new RegExp("\\"+o+"([0-9]+)\\"+o);return u?f:function i(c,n,a){for(var g,p=[],y=0;g=s.exec(c);){if(y++>1e4)throw Error("Circular references in parenthesis");p.push(c.slice(0,g.index)),p.push(i(n[g[1]],n)),c=c.slice(g.index+g[0].length)}return p.push(c),p}(f[0],f)}function d(h,e){if(e&&e.flat){var f,l=e&&e.escape||"___",o=h[0];if(!o)return"";for(var u=new RegExp("\\"+l+"([0-9]+)\\"+l),s=0;o!=f;){if(s++>1e4)throw Error("Circular references in "+h);f=o,o=o.replace(u,i)}return o}return h.reduce(function c(n,a){return Array.isArray(a)&&(a=a.reduce(c,"")),n+a},"");function i(c,n){if(h[n]==null)throw Error("Reference "+n+"is undefined");return h[n]}}function m(h,e){return Array.isArray(h)?d(h,e):t(h,e)}m.parse=t,m.stringify=d,I.exports=m},{}],481:[function(r,I,B){var t=r("pick-by-alias");I.exports=function(d){var m;return arguments.length>1&&(d=arguments),typeof d=="string"?d=d.split(/\s/).map(parseFloat):typeof d=="number"&&(d=[d]),d.length&&typeof d[0]=="number"?m=d.length===1?{width:d[0],height:d[0],x:0,y:0}:d.length===2?{width:d[0],height:d[1],x:0,y:0}:{x:d[0],y:d[1],width:d[2]-d[0]||0,height:d[3]-d[1]||0}:d&&(d=t(d,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),m={x:d.left||0,y:d.top||0},d.width==null?d.right?m.width=d.right-m.x:m.width=0:m.width=d.width,d.height==null?d.bottom?m.height=d.bottom-m.y:m.height=0:m.height=d.height),m}},{"pick-by-alias":485}],482:[function(r,I,B){I.exports=function(h){var e=[];return h.replace(d,function(f,l,o){var u=l.toLowerCase();for(o=function(s){var i=s.match(m);return i?i.map(Number):[]}(o),u=="m"&&o.length>2&&(e.push([l].concat(o.splice(0,2))),u="l",l=l=="m"?"l":"L");;){if(o.length==t[u])return o.unshift(l),e.push(o);if(o.length<t[u])throw new Error("malformed path data");e.push([l].concat(o.splice(0,t[u])))}}),e};var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},d=/([astvzqmhlc])([^astvzqmhlc]*)/gi,m=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},{}],483:[function(r,I,B){I.exports=function(t,d){d||(d=[0,""]),t=String(t);var m=parseFloat(t,10);return d[0]=m,d[1]=t.match(/[\d.\-\+]*\s*(.*)/)[1]||"",d}},{}],484:[function(r,I,B){(function(t){(function(){(function(){var d,m,h,e,f,l;typeof performance!="undefined"&&performance!==null&&performance.now?I.exports=function(){return performance.now()}:t!=null&&t.hrtime?(I.exports=function(){return(d()-f)/1e6},m=t.hrtime,e=(d=function(){var o;return 1e9*(o=m())[0]+o[1]})(),l=1e9*t.uptime(),f=e-l):Date.now?(I.exports=function(){return Date.now()-h},h=Date.now()):(I.exports=function(){return new Date().getTime()-h},h=new Date().getTime())}).call(this)}).call(this)}).call(this,r("_process"))},{_process:514}],485:[function(r,I,B){I.exports=function(m,h,e){var f,l,o={};if(typeof h=="string"&&(h=d(h)),Array.isArray(h)){var u={};for(l=0;l<h.length;l++)u[h[l]]=!0;h=u}for(f in h)h[f]=d(h[f]);var s={};for(f in h){var i=h[f];if(Array.isArray(i))for(l=0;l<i.length;l++){var c=i[l];if(e&&(s[c]=!0),c in m){if(o[f]=m[c],e)for(var n=l;n<i.length;n++)s[i[n]]=!0;break}}else f in m&&(h[f]&&(o[f]=m[f]),e&&(s[f]=!0))}if(e)for(f in m)s[f]||(o[f]=m[f]);return o};var t={};function d(m){return t[m]?t[m]:(typeof m=="string"&&(m=t[m]=m.split(/\s*,\s*|\s+/)),m)}},{}],486:[function(r,I,B){I.exports=function(d,m){for(var h=0|m.length,e=d.length,f=[new Array(h),new Array(h)],l=0;l<h;++l)f[0][l]=[],f[1][l]=[];for(l=0;l<e;++l){var o=d[l];f[0][o[0]].push(o),f[1][o[1]].push(o)}var u=[];for(l=0;l<h;++l)f[0][l].length+f[1][l].length===0&&u.push([l]);function s(y,v){var b=f[v][y[v]];b.splice(b.indexOf(y),1)}function i(y,v,b){for(var x,T,A,S=0;S<2;++S)if(f[S][v].length>0){x=f[S][v][0],A=S;break}T=x[1^A];for(var w=0;w<2;++w)for(var E=f[w][v],k=0;k<E.length;++k){var L=E[k],M=L[1^w];t(m[y],m[v],m[T],m[M])>0&&(x=L,T=M,A=w)}return b||x&&s(x,A),T}function c(y,v){var b=f[v][y][0],x=[y];s(b,v);for(var T=b[1^v];;){for(;T!==y;)x.push(T),T=i(x[x.length-2],T,!1);if(f[0][y].length+f[1][y].length===0)break;var A=x[x.length-1],S=y,w=x[1],E=i(A,S,!0);if(t(m[A],m[S],m[w],m[E])<0)break;x.push(y),T=i(A,S)}return x}function n(y,v){return v[1]===v[v.length-1]}for(l=0;l<h;++l)for(var a=0;a<2;++a){for(var g=[];f[a][l].length>0;){f[0][l].length;var p=c(l,a);n(0,p)?g.push.apply(g,p):(g.length>0&&u.push(g),g=p)}g.length>0&&u.push(g)}return u};var t=r("compare-angle")},{"compare-angle":138}],487:[function(r,I,B){I.exports=function(d,m){for(var h=t(d,m.length),e=new Array(m.length),f=new Array(m.length),l=[],o=0;o<m.length;++o){var u=h[o].length;f[o]=u,e[o]=!0,u<=1&&l.push(o)}for(;l.length>0;){var s=l.pop();e[s]=!1;var i=h[s];for(o=0;o<i.length;++o){var c=i[o];--f[c]==0&&l.push(c)}}var n=new Array(m.length),a=[];for(o=0;o<m.length;++o)e[o]?(s=a.length,n[o]=s,a.push(m[o])):n[o]=-1;var g=[];for(o=0;o<d.length;++o){var p=d[o];e[p[0]]&&e[p[1]]&&g.push([n[p[0]],n[p[1]]])}return[g,a]};var t=r("edges-to-adjacency-list")},{"edges-to-adjacency-list":184}],488:[function(r,I,B){I.exports=function(u,s){var i=l(u,s);u=i[0];for(var c=(s=i[1]).length,n=(u.length,t(u,s.length)),a=0;a<c;++a)if(n[a].length%2==1)throw new Error("planar-graph-to-polyline: graph must be manifold");var g=d(u,s),p=(g=g.filter(function(te){for(var ie=te.length,ae=[0],he=0;he<ie;++he){var se=s[te[he]],de=s[te[(he+1)%ie]],ue=h(-se[0],se[1]),ve=h(-se[0],de[1]),ke=h(de[0],se[1]),Ee=h(de[0],de[1]);ae=e(ae,e(e(ue,ve),e(ke,Ee)))}return ae[ae.length-1]>0})).length,y=new Array(p),v=new Array(p);for(a=0;a<p;++a){y[a]=a;var b=new Array(p),x=g[a].map(function(te){return s[te]}),T=m([x]),A=0;e:for(var S=0;S<p;++S)if(b[S]=0,a!==S){for(var w=(J=g[S]).length,E=0;E<w;++E){var k=T(s[J[E]]);if(k!==0){k<0&&(b[S]=1,A+=1);continue e}}b[S]=1,A+=1}v[a]=[A,a,b]}for(v.sort(function(te,ie){return ie[0]-te[0]}),a=0;a<p;++a){var L=(b=v[a])[1],M=b[2];for(S=0;S<p;++S)M[S]&&(y[S]=L)}var P=function(te){for(var ie=new Array(te),ae=0;ae<te;++ae)ie[ae]=[];return ie}(p);for(a=0;a<p;++a)P[a].push(y[a]),P[y[a]].push(a);var D={},N=o(c,!1);for(a=0;a<p;++a)for(w=(J=g[a]).length,S=0;S<w;++S){var U=J[S],G=J[(S+1)%w],X=Math.min(U,G)+":"+Math.max(U,G);if(X in D){var K=D[X];P[K].push(a),P[a].push(K),N[U]=N[G]=!0}else D[X]=a}function Z(te){for(var ie=te.length,ae=0;ae<ie;++ae)if(!N[te[ae]])return!1;return!0}var H=[],Y=o(p,-1);for(a=0;a<p;++a)y[a]!==a||Z(g[a])?Y[a]=-1:(H.push(a),Y[a]=0);for(i=[];H.length>0;){var $=H.pop(),z=P[$];f(z,function(te,ie){return te-ie});var j,W=z.length,ee=Y[$];if(ee===0){var J=g[$];j=[J]}for(a=0;a<W;++a){var Q=z[a];Y[Q]>=0||(Y[Q]=1^ee,H.push(Q),ee===0&&(Z(J=g[Q])||(J.reverse(),j.push(J))))}ee===0&&i.push(j)}return i};var t=r("edges-to-adjacency-list"),d=r("planar-dual"),m=r("point-in-big-polygon"),h=r("two-product"),e=r("robust-sum"),f=r("uniq"),l=r("./lib/trim-leaves");function o(u,s){for(var i=new Array(u),c=0;c<u;++c)i[c]=s;return i}},{"./lib/trim-leaves":487,"edges-to-adjacency-list":184,"planar-dual":486,"point-in-big-polygon":489,"robust-sum":539,"two-product":588,uniq:603}],489:[function(r,I,B){I.exports=function(o){for(var u=o.length,s=[],i=[],c=0;c<u;++c)for(var n=o[c],a=n.length,g=a-1,p=0;p<a;g=p++){var y=n[g],v=n[p];y[0]===v[0]?i.push([y,v]):s.push([y,v])}if(s.length===0)return i.length===0?l:(b=f(i),function(A){return b(A[0],A[1])?0:1});var b,x=d(s),T=function(A,S){return function(w){var E=h.le(S,w[0]);if(E<0)return 1;var k=A[E];if(!k){if(!(E>0&&S[E]===w[0]))return 1;k=A[E-1]}for(var L=1;k;){var M=k.key,P=t(w,M[0],M[1]);if(M[0][0]<M[1][0])if(P<0)k=k.left;else{if(!(P>0))return 0;L=-1,k=k.right}else if(P>0)k=k.left;else{if(!(P<0))return 0;L=1,k=k.right}}return L}}(x.slabs,x.coordinates);return i.length===0?T:function(A,S){return function(w){return A(w[0],w[1])?0:S(w)}}(f(i),T)};var t=r("robust-orientation")[3],d=r("slab-decomposition"),m=r("interval-tree-1d"),h=r("binary-search-bounds");function e(){return!0}function f(o){for(var u={},s=0;s<o.length;++s){var i=o[s],c=i[0][0],n=i[0][1],a=i[1][1],g=[Math.min(n,a),Math.max(n,a)];c in u?u[c].push(g):u[c]=[g]}var p={},y=Object.keys(u);for(s=0;s<y.length;++s){var v=u[y[s]];p[y[s]]=m(v)}return function(b){return function(x,T){var A=b[x];return!!A&&!!A.queryPoint(T,e)}}(p)}function l(o){return 1}},{"binary-search-bounds":103,"interval-tree-1d":440,"robust-orientation":534,"slab-decomposition":551}],490:[function(r,I,B){/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */var t,d=r("./lib/build-log"),m=r("./lib/epsilon"),h=r("./lib/intersecter"),e=r("./lib/segment-chainer"),f=r("./lib/segment-selector"),l=r("./lib/geojson"),o=!1,u=m();function s(i,c,n){var a=t.segments(i),g=t.segments(c),p=n(t.combine(a,g));return t.polygon(p)}t={buildLog:function(i){return i===!0?o=d():i===!1&&(o=!1),o!==!1&&o.list},epsilon:function(i){return u.epsilon(i)},segments:function(i){var c=h(!0,u,o);return i.regions.forEach(c.addRegion),{segments:c.calculate(i.inverted),inverted:i.inverted}},combine:function(i,c){return{combined:h(!1,u,o).calculate(i.segments,i.inverted,c.segments,c.inverted),inverted1:i.inverted,inverted2:c.inverted}},selectUnion:function(i){return{segments:f.union(i.combined,o),inverted:i.inverted1||i.inverted2}},selectIntersect:function(i){return{segments:f.intersect(i.combined,o),inverted:i.inverted1&&i.inverted2}},selectDifference:function(i){return{segments:f.difference(i.combined,o),inverted:i.inverted1&&!i.inverted2}},selectDifferenceRev:function(i){return{segments:f.differenceRev(i.combined,o),inverted:!i.inverted1&&i.inverted2}},selectXor:function(i){return{segments:f.xor(i.combined,o),inverted:i.inverted1!==i.inverted2}},polygon:function(i){return{regions:e(i.segments,u,o),inverted:i.inverted}},polygonFromGeoJSON:function(i){return l.toPolygon(t,i)},polygonToGeoJSON:function(i){return l.fromPolygon(t,u,i)},union:function(i,c){return s(i,c,t.selectUnion)},intersect:function(i,c){return s(i,c,t.selectIntersect)},difference:function(i,c){return s(i,c,t.selectDifference)},differenceRev:function(i,c){return s(i,c,t.selectDifferenceRev)},xor:function(i,c){return s(i,c,t.selectXor)}},typeof window=="object"&&(window.PolyBool=t),I.exports=t},{"./lib/build-log":491,"./lib/epsilon":492,"./lib/geojson":493,"./lib/intersecter":494,"./lib/segment-chainer":496,"./lib/segment-selector":497}],491:[function(r,I,B){I.exports=function(){var t,d=0,m=!1;function h(e,f){return t.list.push({type:e,data:f?JSON.parse(JSON.stringify(f)):void 0}),t}return t={list:[],segmentId:function(){return d++},checkIntersection:function(e,f){return h("check",{seg1:e,seg2:f})},segmentChop:function(e,f){return h("div_seg",{seg:e,pt:f}),h("chop",{seg:e,pt:f})},statusRemove:function(e){return h("pop_seg",{seg:e})},segmentUpdate:function(e){return h("seg_update",{seg:e})},segmentNew:function(e,f){return h("new_seg",{seg:e,primary:f})},segmentRemove:function(e){return h("rem_seg",{seg:e})},tempStatus:function(e,f,l){return h("temp_status",{seg:e,above:f,below:l})},rewind:function(e){return h("rewind",{seg:e})},status:function(e,f,l){return h("status",{seg:e,above:f,below:l})},vert:function(e){return e===m?t:(m=e,h("vert",{x:e}))},log:function(e){return typeof e!="string"&&(e=JSON.stringify(e,!1,"  ")),h("log",{txt:e})},reset:function(){return h("reset")},selected:function(e){return h("selected",{segs:e})},chainStart:function(e){return h("chain_start",{seg:e})},chainRemoveHead:function(e,f){return h("chain_rem_head",{index:e,pt:f})},chainRemoveTail:function(e,f){return h("chain_rem_tail",{index:e,pt:f})},chainNew:function(e,f){return h("chain_new",{pt1:e,pt2:f})},chainMatch:function(e){return h("chain_match",{index:e})},chainClose:function(e){return h("chain_close",{index:e})},chainAddHead:function(e,f){return h("chain_add_head",{index:e,pt:f})},chainAddTail:function(e,f){return h("chain_add_tail",{index:e,pt:f})},chainConnect:function(e,f){return h("chain_con",{index1:e,index2:f})},chainReverse:function(e){return h("chain_rev",{index:e})},chainJoin:function(e,f){return h("chain_join",{index1:e,index2:f})},done:function(){return h("done")}}}},{}],492:[function(r,I,B){I.exports=function(t){typeof t!="number"&&(t=1e-10);var d={epsilon:function(m){return typeof m=="number"&&(t=m),t},pointAboveOrOnLine:function(m,h,e){var f=h[0],l=h[1],o=e[0],u=e[1],s=m[0];return(o-f)*(m[1]-l)-(u-l)*(s-f)>=-t},pointBetween:function(m,h,e){var f=m[1]-h[1],l=e[0]-h[0],o=m[0]-h[0],u=e[1]-h[1],s=o*l+f*u;return!(s<t)&&!(s-(l*l+u*u)>-t)},pointsSameX:function(m,h){return Math.abs(m[0]-h[0])<t},pointsSameY:function(m,h){return Math.abs(m[1]-h[1])<t},pointsSame:function(m,h){return d.pointsSameX(m,h)&&d.pointsSameY(m,h)},pointsCompare:function(m,h){return d.pointsSameX(m,h)?d.pointsSameY(m,h)?0:m[1]<h[1]?-1:1:m[0]<h[0]?-1:1},pointsCollinear:function(m,h,e){var f=m[0]-h[0],l=m[1]-h[1],o=h[0]-e[0],u=h[1]-e[1];return Math.abs(f*u-o*l)<t},linesIntersect:function(m,h,e,f){var l=h[0]-m[0],o=h[1]-m[1],u=f[0]-e[0],s=f[1]-e[1],i=l*s-o*u;if(Math.abs(i)<t)return!1;var c=m[0]-e[0],n=m[1]-e[1],a=(u*n-s*c)/i,g=(l*n-o*c)/i,p={alongA:0,alongB:0,pt:[m[0]+a*l,m[1]+a*o]};return p.alongA=a<=-t?-2:a<t?-1:a-1<=-t?0:a-1<t?1:2,p.alongB=g<=-t?-2:g<t?-1:g-1<=-t?0:g-1<t?1:2,p},pointInsideRegion:function(m,h){for(var e=m[0],f=m[1],l=h[h.length-1][0],o=h[h.length-1][1],u=!1,s=0;s<h.length;s++){var i=h[s][0],c=h[s][1];c-f>t!=o-f>t&&(l-i)*(f-c)/(o-c)+i-e>t&&(u=!u),l=i,o=c}return u}};return d}},{}],493:[function(r,I,B){var t={toPolygon:function(d,m){function h(l){if(l.length<=0)return d.segments({inverted:!1,regions:[]});function o(i){var c=i.slice(0,i.length-1);return d.segments({inverted:!1,regions:[c]})}for(var u=o(l[0]),s=1;s<l.length;s++)u=d.selectDifference(d.combine(u,o(l[s])));return u}if(m.type==="Polygon")return d.polygon(h(m.coordinates));if(m.type==="MultiPolygon"){for(var e=d.segments({inverted:!1,regions:[]}),f=0;f<m.coordinates.length;f++)e=d.selectUnion(d.combine(e,h(m.coordinates[f])));return d.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(d,m,h){function e(g,p){return m.pointInsideRegion([.5*(g[0][0]+g[1][0]),.5*(g[0][1]+g[1][1])],p)}function f(g){return{region:g,children:[]}}h=d.polygon(d.segments(h));var l=f(null);function o(g,p){for(var y=0;y<g.children.length;y++)if(e(p,(b=g.children[y]).region))return void o(b,p);var v=f(p);for(y=0;y<g.children.length;y++){var b;e((b=g.children[y]).region,p)&&(v.children.push(b),g.children.splice(y,1),y--)}g.children.push(v)}for(var u=0;u<h.regions.length;u++){var s=h.regions[u];s.length<3||o(l,s)}function i(g,p){for(var y=0,v=g[g.length-1][0],b=g[g.length-1][1],x=[],T=0;T<g.length;T++){var A=g[T][0],S=g[T][1];x.push([A,S]),y+=S*v-A*b,v=A,b=S}return y<0!==p&&x.reverse(),x.push([x[0][0],x[0][1]]),x}var c=[];function n(g){var p=[i(g.region,!1)];c.push(p);for(var y=0;y<g.children.length;y++)p.push(a(g.children[y]))}function a(g){for(var p=0;p<g.children.length;p++)n(g.children[p]);return i(g.region,!0)}for(u=0;u<l.children.length;u++)n(l.children[u]);return c.length<=0?{type:"Polygon",coordinates:[]}:c.length==1?{type:"Polygon",coordinates:c[0]}:{type:"MultiPolygon",coordinates:c}}};I.exports=t},{}],494:[function(r,I,B){var t=r("./linked-list");I.exports=function(d,m,h){function e(i,c,n){return{id:h?h.segmentId():-1,start:i,end:c,myFill:{above:n.myFill.above,below:n.myFill.below},otherFill:null}}var f=t.create();function l(i,c){f.insertBefore(i,function(n){return function(a,g,p,y,v,b){var x=m.pointsCompare(g,v);return x!==0?x:m.pointsSame(p,b)?0:a!==y?a?1:-1:m.pointAboveOrOnLine(p,y?v:b,y?b:v)?1:-1}(i.isStart,i.pt,c,n.isStart,n.pt,n.other.pt)<0})}function o(i,c){var n=function(a,g){var p=t.node({isStart:!0,pt:a.start,seg:a,primary:g,other:null,status:null});return l(p,a.end),p}(i,c);return function(a,g,p){var y=t.node({isStart:!1,pt:g.end,seg:g,primary:p,other:a,status:null});a.other=y,l(y,a.pt)}(n,i,c),n}function u(i,c){var n=e(c,i.seg.end,i.seg);return function(a,g){h&&h.segmentChop(a.seg,g),a.other.remove(),a.seg.end=g,a.other.pt=g,l(a.other,a.pt)}(i,c),o(n,i.primary)}function s(i,c){var n=t.create();function a(k){return n.findTransition(function(L){var M,P,D,N,U,G;return M=k,P=L.ev,D=M.seg.start,N=M.seg.end,U=P.seg.start,G=P.seg.end,(m.pointsCollinear(D,U,G)?m.pointsCollinear(N,U,G)||m.pointAboveOrOnLine(N,U,G)?1:-1:m.pointAboveOrOnLine(D,U,G)?1:-1)>0})}function g(k,L){var M=k.seg,P=L.seg,D=M.start,N=M.end,U=P.start,G=P.end;h&&h.checkIntersection(M,P);var X=m.linesIntersect(D,N,U,G);if(X===!1){if(!m.pointsCollinear(D,N,U)||m.pointsSame(D,G)||m.pointsSame(N,U))return!1;var K=m.pointsSame(D,U),Z=m.pointsSame(N,G);if(K&&Z)return L;var H=!K&&m.pointBetween(D,U,G),Y=!Z&&m.pointBetween(N,U,G);if(K)return Y?u(L,N):u(k,G),L;H&&(Z||(Y?u(L,N):u(k,G)),u(L,D))}else X.alongA===0&&(X.alongB===-1?u(k,U):X.alongB===0?u(k,X.pt):X.alongB===1&&u(k,G)),X.alongB===0&&(X.alongA===-1?u(L,D):X.alongA===0?u(L,X.pt):X.alongA===1&&u(L,N));return!1}for(var p=[];!f.isEmpty();){var y=f.getHead();if(h&&h.vert(y.pt[0]),y.isStart){let k=function(){if(b){var L=g(y,b);if(L)return L}return!!x&&g(y,x)};h&&h.segmentNew(y.seg,y.primary);var v=a(y),b=v.before?v.before.ev:null,x=v.after?v.after.ev:null;h&&h.tempStatus(y.seg,!!b&&b.seg,!!x&&x.seg);var T,A=k();if(A){var S;d?(S=y.seg.myFill.below===null||y.seg.myFill.above!==y.seg.myFill.below)&&(A.seg.myFill.above=!A.seg.myFill.above):A.seg.otherFill=y.seg.myFill,h&&h.segmentUpdate(A.seg),y.other.remove(),y.remove()}if(f.getHead()!==y){h&&h.rewind(y.seg);continue}d?(S=y.seg.myFill.below===null||y.seg.myFill.above!==y.seg.myFill.below,y.seg.myFill.below=x?x.seg.myFill.above:i,y.seg.myFill.above=S?!y.seg.myFill.below:y.seg.myFill.below):y.seg.otherFill===null&&(T=x?y.primary===x.primary?x.seg.otherFill.above:x.seg.myFill.above:y.primary?c:i,y.seg.otherFill={above:T,below:T}),h&&h.status(y.seg,!!b&&b.seg,!!x&&x.seg),y.other.status=v.insert(t.node({ev:y}))}else{var w=y.status;if(w===null)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(n.exists(w.prev)&&n.exists(w.next)&&g(w.prev.ev,w.next.ev),h&&h.statusRemove(w.ev.seg),w.remove(),!y.primary){var E=y.seg.myFill;y.seg.myFill=y.seg.otherFill,y.seg.otherFill=E}p.push(y.seg)}f.getHead().remove()}return h&&h.done(),p}return d?{addRegion:function(i){for(var c,n,a,g=i[i.length-1],p=0;p<i.length;p++){c=g,g=i[p];var y=m.pointsCompare(c,g);y!==0&&o((n=y<0?c:g,a=y<0?g:c,{id:h?h.segmentId():-1,start:n,end:a,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(i){return s(i,!1)}}:{calculate:function(i,c,n,a){return i.forEach(function(g){o(e(g.start,g.end,g),!0)}),n.forEach(function(g){o(e(g.start,g.end,g),!1)}),s(c,a)}}}},{"./linked-list":495}],495:[function(r,I,B){I.exports={create:function(){var t={root:{root:!0,next:null},exists:function(d){return d!==null&&d!==t.root},isEmpty:function(){return t.root.next===null},getHead:function(){return t.root.next},insertBefore:function(d,m){for(var h=t.root,e=t.root.next;e!==null;){if(m(e))return d.prev=e.prev,d.next=e,e.prev.next=d,void(e.prev=d);h=e,e=e.next}h.next=d,d.prev=h,d.next=null},findTransition:function(d){for(var m=t.root,h=t.root.next;h!==null&&!d(h);)m=h,h=h.next;return{before:m===t.root?null:m,after:h,insert:function(e){return e.prev=m,e.next=h,m.next=e,h!==null&&(h.prev=e),e}}}};return t},node:function(t){return t.prev=null,t.next=null,t.remove=function(){t.prev.next=t.next,t.next&&(t.next.prev=t.prev),t.prev=null,t.next=null},t}}},{}],496:[function(r,I,B){I.exports=function(t,d,m){var h=[],e=[];return t.forEach(function(f){var l=f.start,o=f.end;if(d.pointsSame(l,o))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{m&&m.chainStart(f);for(var u={index:0,matches_head:!1,matches_pt1:!1},s={index:0,matches_head:!1,matches_pt1:!1},i=u,c=0;c<h.length;c++){var n=(v=h[c])[0],a=(v[1],v[v.length-1]);if(v[v.length-2],d.pointsSame(n,l)){if(k(c,!0,!0))break}else if(d.pointsSame(n,o)){if(k(c,!0,!1))break}else if(d.pointsSame(a,l)){if(k(c,!1,!0))break}else if(d.pointsSame(a,o)&&k(c,!1,!1))break}if(i===u)return h.push([l,o]),void(m&&m.chainNew(l,o));if(i===s){m&&m.chainMatch(u.index);var g=u.index,p=u.matches_pt1?o:l,y=u.matches_head,v=h[g],b=y?v[0]:v[v.length-1],x=y?v[1]:v[v.length-2],T=y?v[v.length-1]:v[0],A=y?v[v.length-2]:v[1];return d.pointsCollinear(x,b,p)&&(y?(m&&m.chainRemoveHead(u.index,p),v.shift()):(m&&m.chainRemoveTail(u.index,p),v.pop()),b=x),d.pointsSame(T,p)?(h.splice(g,1),d.pointsCollinear(A,T,b)&&(y?(m&&m.chainRemoveTail(u.index,b),v.pop()):(m&&m.chainRemoveHead(u.index,b),v.shift())),m&&m.chainClose(u.index),void e.push(v)):void(y?(m&&m.chainAddHead(u.index,p),v.unshift(p)):(m&&m.chainAddTail(u.index,p),v.push(p)))}var S=u.index,w=s.index;m&&m.chainConnect(S,w);var E=h[S].length<h[w].length;u.matches_head?s.matches_head?E?(L(S),M(S,w)):(L(w),M(w,S)):M(w,S):s.matches_head?M(S,w):E?(L(S),M(w,S)):(L(w),M(S,w))}function k(P,D,N){return i.index=P,i.matches_head=D,i.matches_pt1=N,i===u?(i=s,!1):(i=null,!0)}function L(P){m&&m.chainReverse(P),h[P].reverse()}function M(P,D){var N=h[P],U=h[D],G=N[N.length-1],X=N[N.length-2],K=U[0],Z=U[1];d.pointsCollinear(X,G,K)&&(m&&m.chainRemoveTail(P,G),N.pop(),G=X),d.pointsCollinear(G,K,Z)&&(m&&m.chainRemoveHead(D,K),U.shift()),m&&m.chainJoin(P,D),h[P]=N.concat(U),h.splice(D,1)}}),e}},{}],497:[function(r,I,B){function t(m,h,e){var f=[];return m.forEach(function(l){var o=(l.myFill.above?8:0)+(l.myFill.below?4:0)+(l.otherFill&&l.otherFill.above?2:0)+(l.otherFill&&l.otherFill.below?1:0);h[o]!==0&&f.push({id:e?e.segmentId():-1,start:l.start,end:l.end,myFill:{above:h[o]===1,below:h[o]===2},otherFill:null})}),e&&e.selected(f),f}var d={union:function(m,h){return t(m,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],h)},intersect:function(m,h){return t(m,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],h)},difference:function(m,h){return t(m,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],h)},differenceRev:function(m,h){return t(m,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],h)},xor:function(m,h){return t(m,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],h)}};I.exports=d},{}],498:[function(r,I,B){var t=new Float64Array(4),d=new Float64Array(4),m=new Float64Array(4);I.exports=function(h,e,f,l,o){t.length<l.length&&(t=new Float64Array(l.length),d=new Float64Array(l.length),m=new Float64Array(l.length));for(var u=0;u<l.length;++u)t[u]=h[u]-l[u],d[u]=e[u]-h[u],m[u]=f[u]-h[u];var s=0,i=0,c=0,n=0,a=0,g=0;for(u=0;u<l.length;++u){var p=d[u],y=m[u],v=t[u];s+=p*p,i+=p*y,c+=y*y,n+=v*p,a+=v*y,g+=v*v}var b,x,T,A,S,w=Math.abs(s*c-i*i),E=i*a-c*n,k=i*n-s*a;if(E+k<=w)if(E<0)k<0&&n<0?(k=0,-n>=s?(E=1,b=s+2*n+g):b=n*(E=-n/s)+g):(E=0,a>=0?(k=0,b=g):-a>=c?(k=1,b=c+2*a+g):b=a*(k=-a/c)+g);else if(k<0)k=0,n>=0?(E=0,b=g):-n>=s?(E=1,b=s+2*n+g):b=n*(E=-n/s)+g;else{var L=1/w;b=(E*=L)*(s*E+i*(k*=L)+2*n)+k*(i*E+c*k+2*a)+g}else E<0?(T=c+a)>(x=i+n)?(A=T-x)>=(S=s-2*i+c)?(E=1,k=0,b=s+2*n+g):b=(E=A/S)*(s*E+i*(k=1-E)+2*n)+k*(i*E+c*k+2*a)+g:(E=0,T<=0?(k=1,b=c+2*a+g):a>=0?(k=0,b=g):b=a*(k=-a/c)+g):k<0?(T=s+n)>(x=i+a)?(A=T-x)>=(S=s-2*i+c)?(k=1,E=0,b=c+2*a+g):b=(E=1-(k=A/S))*(s*E+i*k+2*n)+k*(i*E+c*k+2*a)+g:(k=0,T<=0?(E=1,b=s+2*n+g):n>=0?(E=0,b=g):b=n*(E=-n/s)+g):(A=c+a-i-n)<=0?(E=0,k=1,b=c+2*a+g):A>=(S=s-2*i+c)?(E=1,k=0,b=s+2*n+g):b=(E=A/S)*(s*E+i*(k=1-E)+2*n)+k*(i*E+c*k+2*a)+g;var M=1-E-k;for(u=0;u<l.length;++u)o[u]=M*h[u]+E*e[u]+k*f[u];return b<0?0:b}},{}],499:[function(r,I,B){var t=r("stream").Transform,d=r("stream-parser");function m(){t.call(this,{readableObjectMode:!0})}function h(e,f,l){Error.call(this),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=e,f&&(this.code=f),l&&(this.statusCode=l)}m.prototype=Object.create(t.prototype),m.prototype.constructor=m,d(m.prototype),B.ParserStream=m,B.sliceEq=function(e,f,l){for(var o=f,u=0;u<l.length;)if(e[o++]!==l[u++])return!1;return!0},B.str2arr=function(e,f){var l=[],o=0;if(f&&f==="hex")for(;o<e.length;)l.push(parseInt(e.slice(o,o+2),16)),o+=2;else for(;o<e.length;o++)l.push(255&e.charCodeAt(o));return l},B.readUInt16LE=function(e,f){return e[f]|e[f+1]<<8},B.readUInt16BE=function(e,f){return e[f+1]|e[f]<<8},B.readUInt32LE=function(e,f){return e[f]|e[f+1]<<8|e[f+2]<<16|16777216*e[f+3]},B.readUInt32BE=function(e,f){return e[f+3]|e[f+2]<<8|e[f+1]<<16|16777216*e[f]},h.prototype=Object.create(Error.prototype),h.prototype.constructor=h,B.ProbeError=h},{stream:554,"stream-parser":570}],500:[function(r,I,B){function t(h,e){var f=new Error(h);return f.code=e,f}function d(h){try{return decodeURIComponent(escape(h))}catch(e){return h}}function m(h,e,f){this.input=h.subarray(e,f),this.start=e;var l=String.fromCharCode.apply(null,this.input.subarray(0,4));if(l!=="II*\0"&&l!=="MM\0*")throw t("invalid TIFF signature","EBADDATA");this.big_endian=l[0]==="M"}m.prototype.each=function(h){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var f=this.ifds_to_read.shift();f.offset&&this.scan_ifd(f.id,f.offset,h)}},m.prototype.read_uint16=function(h){var e=this.input;if(h+2>e.length)throw t("unexpected EOF","EBADDATA");return this.big_endian?256*e[h]+e[h+1]:e[h]+256*e[h+1]},m.prototype.read_uint32=function(h){var e=this.input;if(h+4>e.length)throw t("unexpected EOF","EBADDATA");return this.big_endian?16777216*e[h]+65536*e[h+1]+256*e[h+2]+e[h+3]:e[h]+256*e[h+1]+65536*e[h+2]+16777216*e[h+3]},m.prototype.is_subifd_link=function(h,e){return h===0&&e===34665||h===0&&e===34853||h===34665&&e===40965},m.prototype.exif_format_length=function(h){switch(h){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},m.prototype.exif_format_read=function(h,e){var f;switch(h){case 1:case 2:return f=this.input[e];case 6:return(f=this.input[e])|33554430*(128&f);case 3:return f=this.read_uint16(e);case 8:return(f=this.read_uint16(e))|131070*(32768&f);case 4:return f=this.read_uint32(e);case 9:return 0|(f=this.read_uint32(e));case 5:case 10:case 11:case 12:case 7:default:return null}},m.prototype.scan_ifd=function(h,e,f){var l=this.read_uint16(e);e+=2;for(var o=0;o<l;o++){var u=this.read_uint16(e),s=this.read_uint16(e+2),i=this.read_uint32(e+4),c=this.exif_format_length(s),n=i*c,a=n<=4?e+8:this.read_uint32(e+8),g=!1;if(a+n>this.input.length)throw t("unexpected EOF","EBADDATA");for(var p=[],y=a,v=0;v<i;v++,y+=c){var b=this.exif_format_read(s,y);if(b===null){p=null;break}p.push(b)}if(Array.isArray(p)&&s===2&&(p=d(String.fromCharCode.apply(null,p)))&&p[p.length-1]==="\0"&&(p=p.slice(0,-1)),this.is_subifd_link(h,u)&&Array.isArray(p)&&Number.isInteger(p[0])&&p[0]>0&&(this.ifds_to_read.push({id:u,offset:p[0]}),g=!0),f({is_big_endian:this.big_endian,ifd:h,tag:u,format:s,count:i,entry_offset:e+this.start,data_length:n,data_offset:a+this.start,value:p,is_subifd_link:g})===!1)return void(this.aborted=!0);e+=12}h===0&&this.ifds_to_read.push({id:1,offset:this.read_uint32(e)})},I.exports.ExifParser=m,I.exports.get_orientation=function(h){var e=0;try{return new m(h,0,h.length).each(function(f){if(f.ifd===0&&f.tag===274&&Array.isArray(f.value))return e=f.value[0],!1}),e}catch(f){return-1}}},{}],501:[function(r,I,B){var t=r("./common").readUInt16BE,d=r("./common").readUInt32BE;function m(u,s){if(u.length<4+s)return null;var i=d(u,s);return u.length<i+s||i<8?null:{boxtype:String.fromCharCode.apply(null,u.slice(s+4,s+8)),data:u.slice(s+8,s+i),end:s+i}}function h(u,s){for(var i=0;;){var c=m(u,i);if(!c)break;switch(c.boxtype){case"ispe":s.sizes.push({width:d(c.data,4),height:d(c.data,8)});break;case"irot":s.transforms.push({type:"irot",value:3&c.data[0]});break;case"imir":s.transforms.push({type:"imir",value:1&c.data[0]})}i=c.end}}function e(u,s,i){for(var c=0,n=0;n<i;n++)c=256*c+(u[s+n]||0);return c}function f(u,s){for(var i=u[4]>>4&15,c=15&u[4],n=u[5]>>4&15,a=t(u,6),g=8,p=0;p<a;p++){var y=t(u,g),v=t(u,g+=2),b=e(u,g+=2,n),x=t(u,g+=n);if(g+=2,v===0&&x===1){var T=e(u,g,i),A=e(u,g+i,c);s.item_loc[y]={length:A,offset:T+b}}g+=x*(i+c)}}function l(u,s){for(var i=t(u,4),c=6,n=0;n<i;n++){var a=m(u,c);if(!a)break;if(a.boxtype==="infe"){for(var g=t(a.data,4),p="",y=8;y<a.data.length&&a.data[y];y++)p+=String.fromCharCode(a.data[y]);s.item_inf[p]=g}c=a.end}}function o(u,s){for(var i=0;;){var c=m(u,i);if(!c)break;c.boxtype==="ipco"&&h(c.data,s),i=c.end}}I.exports.unbox=m,I.exports.readSizeFromMeta=function(u){var s={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(function(y,v){for(var b=4;;){var x=m(y,b);if(!x)break;x.boxtype==="iprp"&&o(x.data,v),x.boxtype==="iloc"&&f(x.data,v),x.boxtype==="iinf"&&l(x.data,v),b=x.end}}(u,s),s.sizes.length){var i,c,n,a=(i=s.sizes,c=i.reduce(function(y,v){return y.width>v.width||y.width===v.width&&y.height>v.height?y:v}),n=i.reduce(function(y,v){return y.height>v.height||y.height===v.height&&y.width>v.width?y:v}),c.width>n.height||c.width===n.height&&c.height>n.width?c:n),g=1;s.transforms.forEach(function(y){var v={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},b={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if(y.type==="imir"&&(g=y.value===0?b[g]:v[g=v[g=b[g]]]),y.type==="irot")for(var x=0;x<y.value;x++)g=v[g]});var p=null;return s.item_inf.Exif&&(p=s.item_loc[s.item_inf.Exif]),{width:a.width,height:a.height,orientation:s.transforms.length?g:null,variants:s.sizes,exif_location:p}}},I.exports.getMimeType=function(u){var s=String.fromCharCode.apply(null,u.slice(0,4)),i={};i[s]=!0;for(var c=8;c<u.length;c+=4)i[String.fromCharCode.apply(null,u.slice(c,c+4))]=!0;if(i.mif1||i.msf1||i.miaf)return s==="avif"||s==="avis"||s==="avio"?{type:"avif",mime:"image/avif"}:s==="heic"||s==="heix"?{type:"heic",mime:"image/heic"}:s==="hevc"||s==="hevx"?{type:"heic",mime:"image/heic-sequence"}:i.avif||i.avis?{type:"avif",mime:"image/avif"}:i.heic||i.heix||i.hevc||i.hevx||i.heis?i.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":499}],502:[function(r,I,B){var t=r("../common").str2arr,d=r("../common").sliceEq,m=r("../common").readUInt32BE,h=r("../miaf_utils"),e=r("../exif_utils"),f=t("ftyp");I.exports=function(l){if(d(l,4,f)){var o=h.unbox(l,0);if(o){var u=h.getMimeType(o.data);if(u){for(var s,i=o.end;;){var c=h.unbox(l,i);if(!c)break;if(i=c.end,c.boxtype==="mdat")return;if(c.boxtype==="meta"){s=c.data;break}}if(s){var n=h.readSizeFromMeta(s);if(n){var a={width:n.width,height:n.height,type:u.type,mime:u.mime,wUnits:"px",hUnits:"px"};if(n.variants.length>1&&(a.variants=n.variants),n.orientation&&(a.orientation=n.orientation),n.exif_location&&n.exif_location.offset+n.exif_location.length<=l.length){var g=m(l,n.exif_location.offset),p=l.slice(n.exif_location.offset+g+4,n.exif_location.offset+n.exif_location.length),y=e.get_orientation(p);y>0&&(a.orientation=y)}return a}}}}}}},{"../common":499,"../exif_utils":500,"../miaf_utils":501}],503:[function(r,I,B){var t=r("../common").str2arr,d=r("../common").sliceEq,m=r("../common").readUInt16LE,h=t("BM");I.exports=function(e){if(!(e.length<26)&&d(e,0,h))return{width:m(e,18),height:m(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":499}],504:[function(r,I,B){var t=r("../common").str2arr,d=r("../common").sliceEq,m=r("../common").readUInt16LE,h=t("GIF87a"),e=t("GIF89a");I.exports=function(f){if(!(f.length<10)&&(d(f,0,h)||d(f,0,e)))return{width:m(f,6),height:m(f,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":499}],505:[function(r,I,B){var t=r("../common").readUInt16LE;I.exports=function(d){var m=t(d,0),h=t(d,2),e=t(d,4);if(m===0&&h===1&&e){for(var f=[],l={width:0,height:0},o=0;o<e;o++){var u=d[6+16*o]||256,s=d[6+16*o+1]||256,i={width:u,height:s};f.push(i),(u>l.width||s>l.height)&&(l=i)}return{width:l.width,height:l.height,variants:f,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":499}],506:[function(r,I,B){var t=r("../common").readUInt16BE,d=r("../common").str2arr,m=r("../common").sliceEq,h=r("../exif_utils"),e=d("Exif\0\0");I.exports=function(f){if(!(f.length<2)&&f[0]===255&&f[1]===216)for(var l=2;;){if(f.length-l<2||f[l++]!==255)return;for(var o,u,s=f[l++];s===255;)s=f[l++];if(208<=s&&s<=217||s===1)o=0;else{if(!(192<=s&&s<=254)||f.length-l<2)return;o=t(f,l)-2,l+=2}if(s===217||s===218)return;if(s===225&&o>=10&&m(f,l,e)&&(u=h.get_orientation(f.slice(l+6,l+o))),o>=5&&192<=s&&s<=207&&s!==196&&s!==200&&s!==204){if(f.length-l<o)return;var i={width:t(f,l+3),height:t(f,l+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return u>0&&(i.orientation=u),i}l+=o}}},{"../common":499,"../exif_utils":500}],507:[function(r,I,B){var t=r("../common").str2arr,d=r("../common").sliceEq,m=r("../common").readUInt32BE,h=t(`\x89PNG\r

`),e=t("IHDR");I.exports=function(f){if(!(f.length<24)&&d(f,0,h)&&d(f,12,e))return{width:m(f,16),height:m(f,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":499}],508:[function(r,I,B){var t=r("../common").str2arr,d=r("../common").sliceEq,m=r("../common").readUInt32BE,h=t("8BPS\0");I.exports=function(e){if(!(e.length<22)&&d(e,0,h))return{width:m(e,18),height:m(e,14),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":499}],509:[function(r,I,B){function t(u){return typeof u=="number"&&isFinite(u)&&u>0}var d=/<[-_.:a-zA-Z0-9][^>]*>/,m=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,h=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,e=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,f=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,l=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function o(u){return l.test(u)?u.match(l)[0]:"px"}I.exports=function(u){if(function(T){var A,S=0,w=T.length;for(T[0]===239&&T[1]===187&&T[2]===191&&(S=3);S<w&&((A=T[S])===32||A===9||A===13||A===10);)S++;return S!==w&&T[S]===60}(u)){for(var s="",i=0;i<u.length;i++)s+=String.fromCharCode(u[i]);var c=(s.match(d)||[""])[0];if(m.test(c)){var n=function(T){var A=T.match(h),S=T.match(e),w=T.match(f);return{width:A&&(A[1]||A[2]),height:S&&(S[1]||S[2]),viewbox:w&&(w[1]||w[2])}}(c),a=parseFloat(n.width),g=parseFloat(n.height);if(n.width&&n.height)return!t(a)||!t(g)?void 0:{width:a,height:g,type:"svg",mime:"image/svg+xml",wUnits:o(n.width),hUnits:o(n.height)};var p=(n.viewbox||"").split(" "),y={width:p[2],height:p[3]},v=parseFloat(y.width),b=parseFloat(y.height);if(t(v)&&t(b)&&o(y.width)===o(y.height)){var x=v/b;return n.width?t(a)?{width:a,height:a/x,type:"svg",mime:"image/svg+xml",wUnits:o(n.width),hUnits:o(n.width)}:void 0:n.height?t(g)?{width:g*x,height:g,type:"svg",mime:"image/svg+xml",wUnits:o(n.height),hUnits:o(n.height)}:void 0:{width:v,height:b,type:"svg",mime:"image/svg+xml",wUnits:o(y.width),hUnits:o(y.height)}}}}}},{}],510:[function(r,I,B){var t=r("../common").str2arr,d=r("../common").sliceEq,m=r("../common").readUInt16LE,h=r("../common").readUInt16BE,e=r("../common").readUInt32LE,f=r("../common").readUInt32BE,l=t("II*\0"),o=t("MM\0*");function u(c,n,a){return a?h(c,n):m(c,n)}function s(c,n,a){return a?f(c,n):e(c,n)}function i(c,n,a){var g=u(c,n+2,a);return s(c,n+4,a)!==1||g!==3&&g!==4?null:g===3?u(c,n+8,a):s(c,n+8,a)}I.exports=function(c){if(!(c.length<8)&&(d(c,0,l)||d(c,0,o))){var n=c[0]===77,a=s(c,4,n)-8;if(!(a<0)){var g=a+8;if(!(c.length-g<2)){var p=12*u(c,g+0,n);if(!(p<=0||(g+=2,c.length-g<p))){var y,v,b,x;for(y=0;y<p;y+=12)(x=u(c,g+y,n))===256?v=i(c,g+y,n):x===257&&(b=i(c,g+y,n));return v&&b?{width:v,height:b,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}:void 0}}}}}},{"../common":499}],511:[function(r,I,B){var t=r("../common").str2arr,d=r("../common").sliceEq,m=r("../common").readUInt16LE,h=r("../common").readUInt32LE,e=r("../exif_utils"),f=t("RIFF"),l=t("WEBP");function o(i,c){if(i[c+3]===157&&i[c+4]===1&&i[c+5]===42)return{width:16383&m(i,c+6),height:16383&m(i,c+8),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function u(i,c){if(i[c]===47){var n=h(i,c+1);return{width:1+(16383&n),height:1+(n>>14&16383),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function s(i,c){return{width:1+(i[c+6]<<16|i[c+5]<<8|i[c+4]),height:1+(i[c+9]<<c|i[c+8]<<8|i[c+7]),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}I.exports=function(i){if(!(i.length<16)&&(d(i,0,f)||d(i,8,l))){var c=12,n=null,a=0,g=h(i,4)+8;if(!(g>i.length)){for(;c+8<g;)if(i[c]!==0){var p=String.fromCharCode.apply(null,i.slice(c,c+4)),y=h(i,c+4);p==="VP8 "&&y>=10?n=n||o(i,c+8):p==="VP8L"&&y>=9?n=n||u(i,c+8):p==="VP8X"&&y>=10?n=n||s(i,c+8):p==="EXIF"&&(a=e.get_orientation(i.slice(c+8,c+8+y)),c=1/0),c+=8+y}else c++;if(n)return a>0&&(n.orientation=a),n}}}},{"../common":499,"../exif_utils":500}],512:[function(r,I,B){I.exports={avif:r("./parse_sync/avif"),bmp:r("./parse_sync/bmp"),gif:r("./parse_sync/gif"),ico:r("./parse_sync/ico"),jpeg:r("./parse_sync/jpeg"),png:r("./parse_sync/png"),psd:r("./parse_sync/psd"),svg:r("./parse_sync/svg"),tiff:r("./parse_sync/tiff"),webp:r("./parse_sync/webp")}},{"./parse_sync/avif":502,"./parse_sync/bmp":503,"./parse_sync/gif":504,"./parse_sync/ico":505,"./parse_sync/jpeg":506,"./parse_sync/png":507,"./parse_sync/psd":508,"./parse_sync/svg":509,"./parse_sync/tiff":510,"./parse_sync/webp":511}],513:[function(r,I,B){var t=r("./lib/parsers_sync");I.exports=function(d){return function(m){for(var h=Object.keys(t),e=0;e<h.length;e++){var f=t[h[e]](m);if(f)return f}return null}(d)},I.exports.parsers=t},{"./lib/parsers_sync":512}],514:[function(r,I,B){var t,d,m=I.exports={};function h(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function f(g){if(t===setTimeout)return setTimeout(g,0);if((t===h||!t)&&setTimeout)return t=setTimeout,setTimeout(g,0);try{return t(g,0)}catch(p){try{return t.call(null,g,0)}catch(y){return t.call(this,g,0)}}}(function(){try{t=typeof setTimeout=="function"?setTimeout:h}catch(g){t=h}try{d=typeof clearTimeout=="function"?clearTimeout:e}catch(g){d=e}})();var l,o=[],u=!1,s=-1;function i(){u&&l&&(u=!1,l.length?o=l.concat(o):s=-1,o.length&&c())}function c(){if(!u){var g=f(i);u=!0;for(var p=o.length;p;){for(l=o,o=[];++s<p;)l&&l[s].run();s=-1,p=o.length}l=null,u=!1,function(y){if(d===clearTimeout)return clearTimeout(y);if((d===e||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(y);try{d(y)}catch(v){try{return d.call(null,y)}catch(b){return d.call(this,y)}}}(g)}}function n(g,p){this.fun=g,this.array=p}function a(){}m.nextTick=function(g){var p=new Array(arguments.length-1);if(arguments.length>1)for(var y=1;y<arguments.length;y++)p[y-1]=arguments[y];o.push(new n(g,p)),o.length!==1||u||f(c)},n.prototype.run=function(){this.fun.apply(null,this.array)},m.title="browser",m.browser=!0,m.env={},m.argv=[],m.version="",m.versions={},m.on=a,m.addListener=a,m.once=a,m.off=a,m.removeListener=a,m.removeAllListeners=a,m.emit=a,m.prependListener=a,m.prependOnceListener=a,m.listeners=function(g){return[]},m.binding=function(g){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(g){throw new Error("process.chdir is not supported")},m.umask=function(){return 0}},{}],515:[function(r,I,B){I.exports=r("gl-quat/slerp")},{"gl-quat/slerp":322}],516:[function(r,I,B){(function(t){(function(){for(var d=r("performance-now"),m=typeof window=="undefined"?t:window,h=["moz","webkit"],e="AnimationFrame",f=m["request"+e],l=m["cancel"+e]||m["cancelRequest"+e],o=0;!f&&o<h.length;o++)f=m[h[o]+"Request"+e],l=m[h[o]+"Cancel"+e]||m[h[o]+"CancelRequest"+e];if(!f||!l){var u=0,s=0,i=[];f=function(c){if(i.length===0){var n=d(),a=Math.max(0,1e3/60-(n-u));u=a+n,setTimeout(function(){var g=i.slice(0);i.length=0;for(var p=0;p<g.length;p++)if(!g[p].cancelled)try{g[p].callback(u)}catch(y){setTimeout(function(){throw y},0)}},Math.round(a))}return i.push({handle:++s,callback:c,cancelled:!1}),s},l=function(c){for(var n=0;n<i.length;n++)i[n].handle===c&&(i[n].cancelled=!0)}}I.exports=function(c){return f.call(m,c)},I.exports.cancel=function(){l.apply(m,arguments)},I.exports.polyfill=function(c){c||(c=m),c.requestAnimationFrame=f,c.cancelAnimationFrame=l}}).call(this)}).call(this,typeof vi!="undefined"?vi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"performance-now":484}],517:[function(r,I,B){var t=r("big-rat/add");I.exports=function(d,m){for(var h=d.length,e=new Array(h),f=0;f<h;++f)e[f]=t(d[f],m[f]);return e}},{"big-rat/add":87}],518:[function(r,I,B){I.exports=function(d){for(var m=new Array(d.length),h=0;h<d.length;++h)m[h]=t(d[h]);return m};var t=r("big-rat")},{"big-rat":90}],519:[function(r,I,B){var t=r("big-rat"),d=r("big-rat/mul");I.exports=function(m,h){for(var e=t(h),f=m.length,l=new Array(f),o=0;o<f;++o)l[o]=d(m[o],e);return l}},{"big-rat":90,"big-rat/mul":99}],520:[function(r,I,B){var t=r("big-rat/sub");I.exports=function(d,m){for(var h=d.length,e=new Array(h),f=0;f<h;++f)e[f]=t(d[f],m[f]);return e}},{"big-rat/sub":101}],521:[function(r,I,B){var t=r("compare-cell"),d=r("compare-oriented-cell"),m=r("cell-orientation");I.exports=function(h){h.sort(d);for(var e=h.length,f=0,l=0;l<e;++l){var o=h[l],u=m(o);if(u!==0){if(f>0){var s=h[f-1];if(t(o,s)===0&&m(s)!==u){f-=1;continue}}h[f++]=o}}return h.length=f,h}},{"cell-orientation":123,"compare-cell":139,"compare-oriented-cell":140}],522:[function(r,I,B){var t=r("array-bounds"),d=r("color-normalize"),m=r("update-diff"),h=r("pick-by-alias"),e=r("object-assign"),f=r("flatten-vertex-data"),l=r("to-float32"),o=l.float32,u=l.fract32;I.exports=function(i,c){if(typeof i=="function"?(c||(c={}),c.regl=i):c=i,c.length&&(c.positions=c),!(i=c.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var n,a,g,p,y,v,b=i._gl,x={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},T=[];return p=i.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),a=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),g=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),y=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),v=i.buffer({usage:"static",type:"float",data:s}),E(c),n=i({vert:`
		precision highp float;

		attribute vec2 position, positionFract;
		attribute vec4 error;
		attribute vec4 color;

		attribute vec2 direction, lineOffset, capOffset;

		uniform vec4 viewport;
		uniform float lineWidth, capSize;
		uniform vec2 scale, scaleFract, translate, translateFract;

		varying vec4 fragColor;

		void main() {
			fragColor = color / 255.;

			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;

			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;

			vec2 position = position + dxy;

			vec2 pos = (position + translate) * scale
				+ (positionFract + translateFract) * scale
				+ (position + translate) * scaleFract
				+ (positionFract + translateFract) * scaleFract;

			pos += pixelOffset / viewport.zw;

			gl_Position = vec4(pos * 2. - 1., 0, 1);
		}
		`,frag:`
		precision highp float;

		varying vec4 fragColor;

		uniform float opacity;

		void main() {
			gl_FragColor = fragColor;
			gl_FragColor.a *= opacity;
		}
		`,uniforms:{range:i.prop("range"),lineWidth:i.prop("lineWidth"),capSize:i.prop("capSize"),opacity:i.prop("opacity"),scale:i.prop("scale"),translate:i.prop("translate"),scaleFract:i.prop("scaleFract"),translateFract:i.prop("translateFract"),viewport:function(L,M){return[M.viewport.x,M.viewport.y,L.viewportWidth,L.viewportHeight]}},attributes:{color:{buffer:p,offset:function(L,M){return 4*M.offset},divisor:1},position:{buffer:a,offset:function(L,M){return 8*M.offset},divisor:1},positionFract:{buffer:g,offset:function(L,M){return 8*M.offset},divisor:1},error:{buffer:y,offset:function(L,M){return 16*M.offset},divisor:1},direction:{buffer:v,stride:24,offset:0},lineOffset:{buffer:v,stride:24,offset:8},capOffset:{buffer:v,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:i.prop("viewport")},viewport:i.prop("viewport"),stencil:!1,instances:i.prop("count"),count:s.length}),e(A,{update:E,draw:S,destroy:k,regl:i,gl:b,canvas:b.canvas,groups:T}),A;function A(L){L?E(L):L===null&&k(),S()}function S(L){if(typeof L=="number")return w(L);L&&!Array.isArray(L)&&(L=[L]),i._refresh(),T.forEach(function(M,P){M&&(L&&(L[P]?M.draw=!0:M.draw=!1),M.draw?w(P):M.draw=!0)})}function w(L){typeof L=="number"&&(L=T[L]),L!=null&&L&&L.count&&L.color&&L.opacity&&L.positions&&L.positions.length>1&&(L.scaleRatio=[L.scale[0]*L.viewport.width,L.scale[1]*L.viewport.height],n(L),L.after&&L.after(L))}function E(L){if(L){L.length!=null?typeof L[0]=="number"&&(L=[{positions:L}]):Array.isArray(L)||(L=[L]);var M=0,P=0;if(A.groups=T=L.map(function(Z,H){var Y=T[H];return Z&&(typeof Z=="function"?Z={after:Z}:typeof Z[0]=="number"&&(Z={positions:Z}),Z=h(Z,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),Y||(T[H]=Y={id:H,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},Z=e({},x,Z)),m(Y,Z,[{lineWidth:function($){return .5*+$},capSize:function($){return .5*+$},opacity:parseFloat,errors:function($){return $=f($),P+=$.length,$},positions:function($,z){return $=f($,"float64"),z.count=Math.floor($.length/2),z.bounds=t($,2),z.offset=M,M+=z.count,$}},{color:function($,z){var j=z.count;if($||($="transparent"),!Array.isArray($)||typeof $[0]=="number"){var W=$;$=Array(j);for(var ee=0;ee<j;ee++)$[ee]=W}if($.length<j)throw Error("Not enough colors");for(var J=new Uint8Array(4*j),Q=0;Q<j;Q++){var te=d($[Q],"uint8");J.set(te,4*Q)}return J},range:function($,z,j){var W=z.bounds;return $||($=W),z.scale=[1/($[2]-$[0]),1/($[3]-$[1])],z.translate=[-$[0],-$[1]],z.scaleFract=u(z.scale),z.translateFract=u(z.translate),$},viewport:function($){var z;return Array.isArray($)?z={x:$[0],y:$[1],width:$[2]-$[0],height:$[3]-$[1]}:$?(z={x:$.x||$.left||0,y:$.y||$.top||0},$.right?z.width=$.right-z.x:z.width=$.w||$.width||0,$.bottom?z.height=$.bottom-z.y:z.height=$.h||$.height||0):z={x:0,y:0,width:b.drawingBufferWidth,height:b.drawingBufferHeight},z}}])),Y}),M||P){var D=T.reduce(function(Z,H,Y){return Z+(H?H.count:0)},0),N=new Float64Array(2*D),U=new Uint8Array(4*D),G=new Float32Array(4*D);T.forEach(function(Z,H){if(Z){var Y=Z.positions,$=Z.count,z=Z.offset,j=Z.color,W=Z.errors;$&&(U.set(j,4*z),G.set(W,4*z),N.set(Y,2*z))}});var X=o(N);a(X);var K=u(N,X);g(K),p(U),y(G)}}}function k(){a.destroy(),g.destroy(),p.destroy(),y.destroy(),v.destroy()}};var s=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":76,"color-normalize":131,"flatten-vertex-data":248,"object-assign":476,"pick-by-alias":485,"to-float32":584,"update-diff":605}],523:[function(r,I,B){var t=r("color-normalize"),d=r("array-bounds"),m=r("object-assign"),h=r("glslify"),e=r("pick-by-alias"),f=r("flatten-vertex-data"),l=r("earcut"),o=r("array-normalize"),u=r("to-float32"),s=u.float32,i=u.fract32,c=r("es6-weak-map"),n=r("parse-rect"),a=r("array-find-index");function g(p,y){if(!(this instanceof g))return new g(p,y);if(typeof p=="function"?(y||(y={}),y.regl=p):y=p,y.length&&(y.positions=y),!(p=y.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=p._gl,this.regl=p,this.passes=[],this.shaders=g.shaders.has(p)?g.shaders.get(p):g.shaders.set(p,g.createShaders(p)).get(p),this.update(y)}I.exports=g,g.dashMult=2,g.maxPatternLength=256,g.precisionThreshold=3e6,g.maxPoints=1e4,g.maxLines=2048,g.shaders=new c,g.createShaders=function(p){var y,v=p.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),b={primitive:"triangle strip",instances:p.prop("count"),count:4,offset:0,uniforms:{miterMode:function(T,A){return A.join==="round"?2:1},miterLimit:p.prop("miterLimit"),scale:p.prop("scale"),scaleFract:p.prop("scaleFract"),translateFract:p.prop("translateFract"),translate:p.prop("translate"),thickness:p.prop("thickness"),dashTexture:p.prop("dashTexture"),opacity:p.prop("opacity"),pixelRatio:p.context("pixelRatio"),id:p.prop("id"),dashLength:p.prop("dashLength"),viewport:function(T,A){return[A.viewport.x,A.viewport.y,T.viewportWidth,T.viewportHeight]},depth:p.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(T,A){return!A.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:p.prop("viewport")},viewport:p.prop("viewport")},x=p(m({vert:h([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;
attribute vec4 color;
attribute float lineEnd, lineTop;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;

varying vec4 fragColor;
varying vec2 tangent;

vec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {
	// the order is important
	return position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;
}

void main() {
	float lineStart = 1. - lineEnd;
	float lineOffset = lineTop * 2. - 1.;

	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);
	tangent = normalize(diff * scale * viewport.zw);
	vec2 normal = vec2(-tangent.y, tangent.x);

	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart
		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd

		+ thickness * normal * .5 * lineOffset / viewport.zw;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
}
`]),frag:h([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;

void main() {
	float alpha = 1.;

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:v,divisor:0,stride:8,offset:0},lineTop:{buffer:v,divisor:0,stride:8,offset:4},aCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:p.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:p.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:p.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},b));try{y=p(m({cull:{enable:!0,face:"back"},vert:h([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, nextCoord, prevCoord;
attribute vec4 aColor, bColor;
attribute float lineEnd, lineTop;

uniform vec2 scale, translate;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;
uniform float miterLimit, miterMode;

varying vec4 fragColor;
varying vec4 startCutoff, endCutoff;
varying vec2 tangent;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

const float REVERSE_THRESHOLD = -.875;
const float MIN_DIFF = 1e-6;

// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead
// TODO: precalculate dot products, normalize things beforehead etc.
// TODO: refactor to rectangular algorithm

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

bool isNaN( float val ){
  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}

void main() {
	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;

  vec2 adjustedScale;
  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;
  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;

  vec2 scaleRatio = adjustedScale * viewport.zw;
	vec2 normalWidth = thickness / scaleRatio;

	float lineStart = 1. - lineEnd;
	float lineBot = 1. - lineTop;

	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;

	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;

	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);
	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);

	vec2 prevDiff = aCoord - prevCoord;
	vec2 currDiff = bCoord - aCoord;
	vec2 nextDiff = nextCoord - bCoord;

	vec2 prevTangent = normalize(prevDiff * scaleRatio);
	vec2 currTangent = normalize(currDiff * scaleRatio);
	vec2 nextTangent = normalize(nextDiff * scaleRatio);

	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);
	vec2 currNormal = vec2(-currTangent.y, currTangent.x);
	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);

	vec2 startJoinDirection = normalize(prevTangent - currTangent);
	vec2 endJoinDirection = normalize(currTangent - nextTangent);

	// collapsed/unidirectional segment cases
	// FIXME: there should be more elegant solution
	vec2 prevTanDiff = abs(prevTangent - currTangent);
	vec2 nextTanDiff = abs(nextTangent - currTangent);
	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {
		startJoinDirection = currNormal;
	}
	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {
		endJoinDirection = currNormal;
	}
	if (aCoord == bCoord) {
		endJoinDirection = startJoinDirection;
		currNormal = prevNormal;
		currTangent = prevTangent;
	}

	tangent = currTangent;

	//calculate join shifts relative to normals
	float startJoinShift = dot(currNormal, startJoinDirection);
	float endJoinShift = dot(currNormal, endJoinDirection);

	float startMiterRatio = abs(1. / startJoinShift);
	float endMiterRatio = abs(1. / endJoinShift);

	vec2 startJoin = startJoinDirection * startMiterRatio;
	vec2 endJoin = endJoinDirection * endMiterRatio;

	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;
	startTopJoin = sign(startJoinShift) * startJoin * .5;
	startBotJoin = -startTopJoin;

	endTopJoin = sign(endJoinShift) * endJoin * .5;
	endBotJoin = -endTopJoin;

	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;
	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;
	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;
	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;

	//miter anti-clipping
	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));
	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));

	//prevent close to reverse direction switch
	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);
	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);

	if (prevReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);
		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {
		//handle miter clipping
		bTopCoord -= normalWidth * endTopJoin;
		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;
	}

	if (nextReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);
		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {
		//handle miter clipping
		aBotCoord -= normalWidth * startBotJoin;
		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;
	}

	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;
	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;

	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;
	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;

	//position is normalized 0..1 coord on the screen
	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;

	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;
	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;

	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);

	enableStartMiter = step(dot(currTangent, prevTangent), .5);
	enableEndMiter = step(dot(currTangent, nextTangent), .5);

	//bevel miter cutoffs
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}

	//round miter cutoffs
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}
}
`]),frag:h([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;
varying vec4 startCutoff, endCutoff;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

void main() {
	float alpha = 1., distToStart, distToEnd;
	float cutoff = thickness * .5;

	//bevel miter
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToStart + 1., 0.), 1.);
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToEnd + 1., 0.), 1.);
		}
	}

	// round miter
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < 0.) {
				float radius = length(gl_FragCoord.xy - startCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < 0.) {
				float radius = length(gl_FragCoord.xy - endCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}
	}

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:v,divisor:0,stride:8,offset:0},lineTop:{buffer:v,divisor:0,stride:8,offset:4},aColor:{buffer:p.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:p.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},b))}catch(T){y=x}return{fill:p({primitive:"triangle",elements:function(T,A){return A.triangles},offset:0,vert:h([`precision highp float;
#define GLSLIFY 1

attribute vec2 position, positionFract;

uniform vec4 color;
uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio, id;
uniform vec4 viewport;
uniform float opacity;

varying vec4 fragColor;

const float MAX_LINES = 256.;

void main() {
	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);

	vec2 position = position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
	fragColor.a *= opacity;
}
`]),frag:h([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
	gl_FragColor = fragColor;
}
`]),uniforms:{scale:p.prop("scale"),color:p.prop("fill"),scaleFract:p.prop("scaleFract"),translateFract:p.prop("translateFract"),translate:p.prop("translate"),opacity:p.prop("opacity"),pixelRatio:p.context("pixelRatio"),id:p.prop("id"),viewport:function(T,A){return[A.viewport.x,A.viewport.y,T.viewportWidth,T.viewportHeight]}},attributes:{position:{buffer:p.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:p.prop("positionFractBuffer"),stride:8,offset:8}},blend:b.blend,depth:{enable:!1},scissor:b.scissor,stencil:b.stencil,viewport:b.viewport}),rect:x,miter:y}},g.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},g.prototype.render=function(){for(var p,y=[],v=arguments.length;v--;)y[v]=arguments[v];y.length&&(p=this).update.apply(p,y),this.draw()},g.prototype.draw=function(){for(var p=this,y=[],v=arguments.length;v--;)y[v]=arguments[v];return(y.length?y:this.passes).forEach(function(b,x){var T;if(b&&Array.isArray(b))return(T=p).draw.apply(T,b);typeof b=="number"&&(b=p.passes[b]),b&&b.count>1&&b.opacity&&(p.regl._refresh(),b.fill&&b.triangles&&b.triangles.length>2&&p.shaders.fill(b),b.thickness&&(b.scale[0]*b.viewport.width>g.precisionThreshold||b.scale[1]*b.viewport.height>g.precisionThreshold||b.join==="rect"||!b.join&&(b.thickness<=2||b.count>=g.maxPoints)?p.shaders.rect(b):p.shaders.miter(b)))}),this},g.prototype.update=function(p){var y=this;if(p){p.length!=null?typeof p[0]=="number"&&(p=[{positions:p}]):Array.isArray(p)||(p=[p]);var v=this.regl,b=this.gl;if(p.forEach(function(w,E){var k=y.passes[E];if(w!==void 0)if(w!==null){if(typeof w[0]=="number"&&(w={positions:w}),w=e(w,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),k||(y.passes[E]=k={id:E,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:v.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:v.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:v.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:v.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},w=m({},g.defaults,w)),w.thickness!=null&&(k.thickness=parseFloat(w.thickness)),w.opacity!=null&&(k.opacity=parseFloat(w.opacity)),w.miterLimit!=null&&(k.miterLimit=parseFloat(w.miterLimit)),w.overlay!=null&&(k.overlay=!!w.overlay,E<g.maxLines&&(k.depth=2*(g.maxLines-1-E%g.maxLines)/g.maxLines-1)),w.join!=null&&(k.join=w.join),w.hole!=null&&(k.hole=w.hole),w.fill!=null&&(k.fill=w.fill?t(w.fill,"uint8"):null),w.viewport!=null&&(k.viewport=n(w.viewport)),k.viewport||(k.viewport=n([b.drawingBufferWidth,b.drawingBufferHeight])),w.close!=null&&(k.close=w.close),w.positions===null&&(w.positions=[]),w.positions){var L,M;if(w.positions.x&&w.positions.y){var P=w.positions.x,D=w.positions.y;M=k.count=Math.max(P.length,D.length),L=new Float64Array(2*M);for(var N=0;N<M;N++)L[2*N]=P[N],L[2*N+1]=D[N]}else L=f(w.positions,"float64"),M=k.count=Math.floor(L.length/2);var U=k.bounds=d(L,2);if(k.fill){for(var G=[],X={},K=0,Z=0,H=0,Y=k.count;Z<Y;Z++){var $=L[2*Z],z=L[2*Z+1];isNaN($)||isNaN(z)||$==null||z==null?($=L[2*K],z=L[2*K+1],X[Z]=K):K=Z,G[H++]=$,G[H++]=z}if(w.splitNull){k.count-1 in X||(X[k.count]=k.count-1);var j=Object.keys(X).map(Number).sort(function(_t,er){return _t-er}),W=[],ee=0,J=k.hole!=null?k.hole[0]:null;if(J!=null){var Q=a(j,function(_t){return _t>=J});(j=j.slice(0,Q)).push(J)}for(var te=function(_t){var er=G.slice(2*ee,2*j[_t]).concat(J?G.slice(2*J):[]),tr=(k.hole||[]).map(function(He){return He-J+(j[_t]-ee)}),Ue=l(er,tr);Ue=Ue.map(function(He){return He+ee+(He+ee<j[_t]?0:J-j[_t])}),W.push.apply(W,Ue),ee=j[_t]+1},ie=0;ie<j.length;ie++)te(ie);for(var ae=0,he=W.length;ae<he;ae++)X[W[ae]]!=null&&(W[ae]=X[W[ae]]);k.triangles=W}else{for(var se=l(G,k.hole||[]),de=0,ue=se.length;de<ue;de++)X[se[de]]!=null&&(se[de]=X[se[de]]);k.triangles=se}}var ve=new Float64Array(L);o(ve,2,U);var ke=new Float64Array(2*M+6);k.close?L[0]===L[2*M-2]&&L[1]===L[2*M-1]?(ke[0]=ve[2*M-4],ke[1]=ve[2*M-3]):(ke[0]=ve[2*M-2],ke[1]=ve[2*M-1]):(ke[0]=ve[0],ke[1]=ve[1]),ke.set(ve,2),k.close?L[0]===L[2*M-2]&&L[1]===L[2*M-1]?(ke[2*M+2]=ve[2],ke[2*M+3]=ve[3],k.count-=1):(ke[2*M+2]=ve[0],ke[2*M+3]=ve[1],ke[2*M+4]=ve[2],ke[2*M+5]=ve[3]):(ke[2*M+2]=ve[2*M-2],ke[2*M+3]=ve[2*M-1],ke[2*M+4]=ve[2*M-2],ke[2*M+5]=ve[2*M-1]);var Ee=s(ke);k.positionBuffer(Ee);var be=i(ke,Ee);k.positionFractBuffer(be)}if(w.range?k.range=w.range:k.range||(k.range=k.bounds),(w.range||w.positions)&&k.count){var xe=k.bounds,ce=xe[2]-xe[0],ge=xe[3]-xe[1],we=k.range[2]-k.range[0],Me=k.range[3]-k.range[1];k.scale=[ce/we,ge/Me],k.translate=[-k.range[0]/we+xe[0]/we||0,-k.range[1]/Me+xe[1]/Me||0],k.scaleFract=i(k.scale),k.translateFract=i(k.translate)}if(w.dashes){var Se,ze=0;if(!w.dashes||w.dashes.length<2)ze=1,Se=new Uint8Array([255,255,255,255,255,255,255,255]);else{ze=0;for(var Fe=0;Fe<w.dashes.length;++Fe)ze+=w.dashes[Fe];Se=new Uint8Array(ze*g.dashMult);for(var Ye=0,rt=255,Oe=0;Oe<2;Oe++)for(var je=0;je<w.dashes.length;++je){for(var We=0,qe=w.dashes[je]*g.dashMult*.5;We<qe;++We)Se[Ye++]=rt;rt^=255}}k.dashLength=ze,k.dashTexture({channels:1,data:Se,width:Se.length,height:1,mag:"linear",min:"linear"},0,0)}if(w.color){var et=k.count,st=w.color;st||(st="transparent");var ct=new Uint8Array(4*et+4);if(Array.isArray(st)&&typeof st[0]!="number"){for(var Pt=0;Pt<et;Pt++){var kt=t(st[Pt],"uint8");ct.set(kt,4*Pt)}ct.set(t(st[0],"uint8"),4*et)}else for(var at=t(st,"uint8"),tt=0;tt<et+1;tt++)ct.set(at,4*tt);k.colorBuffer({usage:"dynamic",type:"uint8",data:ct})}}else y.passes[E]=null}),p.length<this.passes.length){for(var x=p.length;x<this.passes.length;x++){var T=this.passes[x];T&&(T.colorBuffer.destroy(),T.positionBuffer.destroy(),T.dashTexture.destroy())}this.passes.length=p.length}for(var A=[],S=0;S<this.passes.length;S++)this.passes[S]!==null&&A.push(this.passes[S]);return this.passes=A,this}},g.prototype.destroy=function(){return this.passes.forEach(function(p){p.colorBuffer.destroy(),p.positionBuffer.destroy(),p.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":76,"array-find-index":77,"array-normalize":78,"color-normalize":131,earcut:183,"es6-weak-map":238,"flatten-vertex-data":248,glslify:434,"object-assign":476,"parse-rect":481,"pick-by-alias":485,"to-float32":584}],524:[function(r,I,B){function t(x,T){return function(A){if(Array.isArray(A))return A}(x)||function(A,S){var w=A==null?null:typeof Symbol!="undefined"&&A[Symbol.iterator]||A["@@iterator"];if(w!=null){var E,k,L=[],M=!0,P=!1;try{for(w=w.call(A);!(M=(E=w.next()).done)&&(L.push(E.value),!S||L.length!==S);M=!0);}catch(D){P=!0,k=D}finally{try{M||w.return==null||w.return()}finally{if(P)throw k}}return L}}(x,T)||m(x,T)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function d(x){return function(T){if(Array.isArray(T))return h(T)}(x)||function(T){if(typeof Symbol!="undefined"&&T[Symbol.iterator]!=null||T["@@iterator"]!=null)return Array.from(T)}(x)||m(x)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function m(x,T){if(x){if(typeof x=="string")return h(x,T);var A=Object.prototype.toString.call(x).slice(8,-1);return A==="Object"&&x.constructor&&(A=x.constructor.name),A==="Map"||A==="Set"?Array.from(x):A==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A)?h(x,T):void 0}}function h(x,T){(T==null||T>x.length)&&(T=x.length);for(var A=0,S=new Array(T);A<T;A++)S[A]=x[A];return S}var e=r("color-normalize"),f=r("array-bounds"),l=r("color-id"),o=r("@plotly/point-cluster"),u=r("object-assign"),s=r("glslify"),i=r("pick-by-alias"),c=r("update-diff"),n=r("flatten-vertex-data"),a=r("is-iexplorer"),g=r("to-float32"),p=r("parse-rect"),y=v;function v(x,T){var A=this;if(!(this instanceof v))return new v(x,T);typeof x=="function"?(T||(T={}),T.regl=x):(T=x,x=null),T&&T.length&&(T.positions=T);var S,w=(x=T.regl)._gl,E=[];this.tooManyColors=a,S=x.texture({data:new Uint8Array(1020),width:255,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),u(this,{regl:x,gl:w,groups:[],markerCache:[null],markerTextures:[null],palette:E,paletteIds:{},paletteTexture:S,maxColors:255,maxSize:100,canvas:w.canvas}),this.update(T);var k={uniforms:{constPointSize:!!T.constPointSize,opacity:x.prop("opacity"),paletteSize:function(P,D){return[A.tooManyColors?0:255,S.height]},pixelRatio:x.context("pixelRatio"),scale:x.prop("scale"),scaleFract:x.prop("scaleFract"),translate:x.prop("translate"),translateFract:x.prop("translateFract"),markerTexture:x.prop("markerTexture"),paletteTexture:S},attributes:{x:function(P,D){return D.xAttr||{buffer:D.positionBuffer,stride:8,offset:0}},y:function(P,D){return D.yAttr||{buffer:D.positionBuffer,stride:8,offset:4}},xFract:function(P,D){return D.xAttr?{constant:[0,0]}:{buffer:D.positionFractBuffer,stride:8,offset:0}},yFract:function(P,D){return D.yAttr?{constant:[0,0]}:{buffer:D.positionFractBuffer,stride:8,offset:4}},size:function(P,D){return D.size.length?{buffer:D.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(255*D.size/A.maxSize)]}},borderSize:function(P,D){return D.borderSize.length?{buffer:D.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(255*D.borderSize/A.maxSize)]}},colorId:function(P,D){return D.color.length?{buffer:D.colorBuffer,stride:A.tooManyColors?8:4,offset:0}:{constant:A.tooManyColors?E.slice(4*D.color,4*D.color+4):[D.color]}},borderColorId:function(P,D){return D.borderColor.length?{buffer:D.colorBuffer,stride:A.tooManyColors?8:4,offset:A.tooManyColors?4:2}:{constant:A.tooManyColors?E.slice(4*D.borderColor,4*D.borderColor+4):[D.borderColor]}},isActive:function(P,D){return D.activation===!0?{constant:[1]}:D.activation?D.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:x.prop("viewport")},viewport:x.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:x.prop("elements"),count:x.prop("count"),offset:x.prop("offset"),primitive:"points"},L=u({},k);L.frag=s([`precision highp float;
#define GLSLIFY 1

uniform float opacity;
uniform sampler2D markerTexture;

varying vec4 fragColor, fragBorderColor;
varying float fragWidth, fragBorderColorLevel, fragColorLevel;

float smoothStep(float x, float y) {
  return 1.0 / (1.0 + exp(50.0*(x - y)));
}

void main() {
  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;

  // max-distance alpha
  if (dist < 0.003) discard;

  // null-border case
  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {
    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);
    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);
  }
  else {
    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);
    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);

    vec4 color = fragBorderColor;
    color.a *= borderColorAmt;
    color = mix(color, fragColor, colorAmt);
    color.a *= opacity;

    gl_FragColor = color;
  }

}
`]),L.vert=s([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 scale, scaleFract, translate, translateFract, paletteSize;
uniform sampler2D paletteTexture;

const float maxSize = 100.;
const float borderLevel = .5;

varying vec4 fragColor, fragBorderColor;
varying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = 2. * size * pointSizeScale;
  fragPointSize = size * pixelRatio;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragColor = color;
  fragBorderColor = borderColor;
  fragWidth = 1. / gl_PointSize;

  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);
  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);
}`]),this.drawMarker=x(L);var M=u({},k);M.frag=s([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

uniform float opacity;

float smoothStep(float edge0, float edge1, float x) {
	float t;
	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
	return t * t * (3.0 - 2.0 * t);
}

void main() {
	float radius, alpha = 1.0, delta = fragWidth;

	radius = length(2.0 * gl_PointCoord.xy - 1.0);

	if (radius > 1.0 + delta) {
		discard;
	}

	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);

	float borderRadius = fragBorderRadius;
	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);
	vec4 color = mix(fragColor, fragBorderColor, ratio);
	color.a *= alpha * opacity;
	gl_FragColor = color;
}
`]),M.vert=s([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 paletteSize, scale, scaleFract, translate, translateFract;
uniform sampler2D paletteTexture;

const float maxSize = 100.;

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = (size + borderSize) * pointSizeScale;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);
  fragColor = color;
  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;
  fragWidth = 1. / gl_PointSize;
}
`]),a&&(M.frag=M.frag.replace("smoothstep","smoothStep"),L.frag=L.frag.replace("smoothstep","smoothStep")),this.drawCircle=x(M)}v.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},v.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},v.prototype.draw=function(){for(var x=this,T=arguments.length,A=new Array(T),S=0;S<T;S++)A[S]=arguments[S];var w=this.groups;if(A.length===1&&Array.isArray(A[0])&&(A[0][0]===null||Array.isArray(A[0][0]))&&(A=A[0]),this.regl._refresh(),A.length)for(var E=0;E<A.length;E++)this.drawItem(E,A[E]);else w.forEach(function(k,L){x.drawItem(L)});return this},v.prototype.drawItem=function(x,T){var A=this.groups,S=A[x];if(typeof T=="number"&&(x=T,S=A[T],T=null),S&&S.count&&S.opacity){S.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,S,T));for(var w=[],E=1;E<S.activation.length;E++)S.activation[E]&&(S.activation[E]===!0||S.activation[E].data.length)&&w.push.apply(w,d(this.getMarkerDrawOptions(E,S,T)));w.length&&this.drawMarker(w)}},v.prototype.getMarkerDrawOptions=function(x,T,A){var S=T.range,w=T.tree,E=T.viewport,k=T.activation,L=T.selectionBuffer,M=T.count;if(this.regl,!w)return A?[u({},T,{markerTexture:this.markerTextures[x],activation:k[x],count:A.length,elements:A,offset:0})]:[u({},T,{markerTexture:this.markerTextures[x],activation:k[x],offset:0})];var P=[],D=w.range(S,{lod:!0,px:[(S[2]-S[0])/E.width,(S[3]-S[1])/E.height]});if(A){for(var N=k[x].data,U=new Uint8Array(M),G=0;G<A.length;G++){var X=A[G];U[X]=N?N[X]:1}L.subdata(U)}for(var K=D.length;K--;){var Z=t(D[K],2),H=Z[0],Y=Z[1];P.push(u({},T,{markerTexture:this.markerTextures[x],activation:A?L:k[x],offset:H,count:Y-H}))}return P},v.prototype.update=function(){for(var x=this,T=arguments.length,A=new Array(T),S=0;S<T;S++)A[S]=arguments[S];if(A.length){A.length===1&&Array.isArray(A[0])&&(A=A[0]);var w=this.groups,E=this.gl,k=this.regl,L=this.maxSize,M=this.maxColors,P=this.palette;this.groups=w=A.map(function(D,N){var U=w[N];if(D===void 0)return U;D===null?D={positions:null}:typeof D=="function"?D={ondraw:D}:typeof D[0]=="number"&&(D={positions:D}),(D=i(D,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"})).positions===null&&(D.positions=[]),D.tooManyColors!=null&&(x.tooManyColors=D.tooManyColors),U||(w[N]=U={id:N,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:k.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:k.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:k.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:k.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:k.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},D=u({},v.defaults,D)),D.positions&&!("marker"in D)&&(D.marker=U.marker,delete U.marker),D.marker&&!("positions"in D)&&(D.positions=U.positions,delete U.positions);var G=0,X=0;if(c(U,D,[{snap:!0,size:function(ue,ve){return ue==null&&(ue=v.defaults.size),G+=ue&&ue.length?1:0,ue},borderSize:function(ue,ve){return ue==null&&(ue=v.defaults.borderSize),G+=ue&&ue.length?1:0,ue},opacity:parseFloat,color:function(ue,ve){return ue==null&&(ue=v.defaults.color),ue=x.updateColor(ue),X++,ue},borderColor:function(ue,ve){return ue==null&&(ue=v.defaults.borderColor),ue=x.updateColor(ue),X++,ue},bounds:function(ue,ve,ke){return"range"in ke||(ke.range=null),ue},positions:function(ue,ve,ke){var Ee=ve.snap,be=ve.positionBuffer,xe=ve.positionFractBuffer,ce=ve.selectionBuffer;if(ue.x||ue.y)return ue.x.length?ve.xAttr={buffer:k.buffer(ue.x),offset:0,stride:4,count:ue.x.length}:ve.xAttr={buffer:ue.x.buffer,offset:4*ue.x.offset||0,stride:4*(ue.x.stride||1),count:ue.x.count},ue.y.length?ve.yAttr={buffer:k.buffer(ue.y),offset:0,stride:4,count:ue.y.length}:ve.yAttr={buffer:ue.y.buffer,offset:4*ue.y.offset||0,stride:4*(ue.y.stride||1),count:ue.y.count},ve.count=Math.max(ve.xAttr.count,ve.yAttr.count),ue;ue=n(ue,"float64");var ge=ve.count=Math.floor(ue.length/2),we=ve.bounds=ge?f(ue,2):null;if(ke.range||ve.range||(delete ve.range,ke.range=we),ke.marker||ve.marker||(delete ve.marker,ke.marker=null),Ee&&(Ee===!0||ge>Ee)?ve.tree=o(ue,{bounds:we}):Ee&&Ee.length&&(ve.tree=Ee),ve.tree){var Me={primitive:"points",usage:"static",data:ve.tree,type:"uint32"};ve.elements?ve.elements(Me):ve.elements=k.elements(Me)}var Se=g.float32(ue);return be({data:Se,usage:"dynamic"}),xe({data:g.fract32(ue,Se),usage:"dynamic"}),ce({data:new Uint8Array(ge),type:"uint8",usage:"stream"}),ue}},{marker:function(ue,ve,ke){var Ee=ve.activation;if(Ee.forEach(function(Se){return Se&&Se.destroy&&Se.destroy()}),Ee.length=0,ue&&typeof ue[0]!="number"){for(var be=[],xe=0,ce=Math.min(ue.length,ve.count);xe<ce;xe++){var ge=x.addMarker(ue[xe]);be[ge]||(be[ge]=new Uint8Array(ve.count)),be[ge][xe]=1}for(var we=0;we<be.length;we++)if(be[we]){var Me={data:be[we],type:"uint8",usage:"static"};Ee[we]?Ee[we](Me):Ee[we]=k.buffer(Me),Ee[we].data=be[we]}}else Ee[x.addMarker(ue)]=!0;return ue},range:function(ue,ve,ke){var Ee=ve.bounds;if(Ee)return ue||(ue=Ee),ve.scale=[1/(ue[2]-ue[0]),1/(ue[3]-ue[1])],ve.translate=[-ue[0],-ue[1]],ve.scaleFract=g.fract(ve.scale),ve.translateFract=g.fract(ve.translate),ue},viewport:function(ue){return p(ue||[E.drawingBufferWidth,E.drawingBufferHeight])}}]),G){var K=U,Z=K.count,H=K.size,Y=K.borderSize,$=K.sizeBuffer,z=new Uint8Array(2*Z);if(H.length||Y.length)for(var j=0;j<Z;j++)z[2*j]=Math.round(255*(H[j]==null?H:H[j])/L),z[2*j+1]=Math.round(255*(Y[j]==null?Y:Y[j])/L);$({data:z,usage:"dynamic"})}if(X){var W,ee=U,J=ee.count,Q=ee.color,te=ee.borderColor,ie=ee.colorBuffer;if(x.tooManyColors){if(Q.length||te.length){W=new Uint8Array(8*J);for(var ae=0;ae<J;ae++){var he=Q[ae];W[8*ae]=P[4*he],W[8*ae+1]=P[4*he+1],W[8*ae+2]=P[4*he+2],W[8*ae+3]=P[4*he+3];var se=te[ae];W[8*ae+4]=P[4*se],W[8*ae+5]=P[4*se+1],W[8*ae+6]=P[4*se+2],W[8*ae+7]=P[4*se+3]}}}else if(Q.length||te.length){W=new Uint8Array(4*J+2);for(var de=0;de<J;de++)Q[de]!=null&&(W[4*de]=Q[de]%M,W[4*de+1]=Math.floor(Q[de]/M)),te[de]!=null&&(W[4*de+2]=te[de]%M,W[4*de+3]=Math.floor(te[de]/M))}ie({data:W||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return U})}},v.prototype.addMarker=function(x){var T,A=this.markerTextures,S=this.regl,w=this.markerCache,E=x==null?0:w.indexOf(x);if(E>=0)return E;if(x instanceof Uint8Array||x instanceof Uint8ClampedArray)T=x;else{T=new Uint8Array(x.length);for(var k=0,L=x.length;k<L;k++)T[k]=255*x[k]}var M=Math.floor(Math.sqrt(T.length));return E=A.length,w.push(x),A.push(S.texture({channels:1,data:T,radius:M,mag:"linear",min:"linear"})),E},v.prototype.updateColor=function(x){var T=this.paletteIds,A=this.palette,S=this.maxColors;Array.isArray(x)||(x=[x]);var w=[];if(typeof x[0]=="number"){var E=[];if(Array.isArray(x))for(var k=0;k<x.length;k+=4)E.push(x.slice(k,k+4));else for(var L=0;L<x.length;L+=4)E.push(x.subarray(L,L+4));x=E}for(var M=0;M<x.length;M++){var P=x[M];P=e(P,"uint8");var D=l(P,!1);if(T[D]==null){var N=A.length;T[D]=Math.floor(N/4),A[N]=P[0],A[N+1]=P[1],A[N+2]=P[2],A[N+3]=P[3]}w[M]=T[D]}return!this.tooManyColors&&A.length>4*S&&(this.tooManyColors=!0),this.updatePalette(A),w.length===1?w[0]:w},v.prototype.updatePalette=function(x){if(!this.tooManyColors){var T=this.maxColors,A=this.paletteTexture,S=Math.ceil(.25*x.length/T);if(S>1)for(var w=.25*(x=x.slice()).length%T;w<S*T;w++)x.push(0,0,0,0);A.height<S&&A.resize(T,S),A.subimage({width:Math.min(.25*x.length,T),height:S,data:x},0,0)}},v.prototype.destroy=function(){return this.groups.forEach(function(x){x.sizeBuffer.destroy(),x.positionBuffer.destroy(),x.positionFractBuffer.destroy(),x.colorBuffer.destroy(),x.activation.forEach(function(T){return T&&T.destroy&&T.destroy()}),x.selectionBuffer.destroy(),x.elements&&x.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(x){return x&&x.destroy&&x.destroy()}),this};var b=r("object-assign");I.exports=function(x,T){var A=new y(x,T),S=A.render.bind(A);return b(S,{render:S,update:A.update.bind(A),draw:A.draw.bind(A),destroy:A.destroy.bind(A),regl:A.regl,gl:A.gl,canvas:A.gl.canvas,groups:A.groups,markers:A.markerCache,palette:A.palette}),S}},{"@plotly/point-cluster":59,"array-bounds":76,"color-id":129,"color-normalize":131,"flatten-vertex-data":248,glslify:434,"is-iexplorer":444,"object-assign":476,"parse-rect":481,"pick-by-alias":485,"to-float32":584,"update-diff":605}],525:[function(r,I,B){var t=r("regl-scatter2d"),d=r("pick-by-alias"),m=r("array-bounds"),h=r("raf"),e=r("array-range"),f=r("parse-rect"),l=r("flatten-vertex-data");function o(c,n){if(!(this instanceof o))return new o(c,n);this.traces=[],this.passes={},this.regl=c,this.scatter=t(c),this.canvas=this.scatter.canvas}function u(c,n,a){return(c.id!=null?c.id:c)<<16|(255&n)<<8|255&a}function s(c,n,a){var g,p,y,v,b=c[n],x=c[a];return b.length>2?(b[0],b[2],g=b[1],p=b[3]):b.length?(g=b[0],p=b[1]):(b.x,g=b.y,b.x+b.width,p=b.y+b.height),x.length>2?(y=x[0],v=x[2],x[1],x[3]):x.length?(y=x[0],v=x[1]):(y=x.x,x.y,v=x.x+x.width,x.y+x.height),[y,g,v,p]}function i(c){if(typeof c=="number")return[c,c,c,c];if(c.length===2)return[c[0],c[1],c[0],c[1]];var n=f(c);return[n.x,n.y,n.x+n.width,n.y+n.height]}I.exports=o,o.prototype.render=function(){for(var c,n=this,a=[],g=arguments.length;g--;)a[g]=arguments[g];return a.length&&(c=this).update.apply(c,a),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?this.planned==null&&(this.planned=h(function(){n.draw(),n.dirty=!0,n.planned=null})):(this.draw(),this.dirty=!0,h(function(){n.dirty=!1})),this)},o.prototype.update=function(){for(var c,n=[],a=arguments.length;a--;)n[a]=arguments[a];if(n.length){for(var g=0;g<n.length;g++)this.updateItem(g,n[g]);this.traces=this.traces.filter(Boolean);for(var p=[],y=0,v=0;v<this.traces.length;v++){for(var b=this.traces[v],x=this.traces[v].passes,T=0;T<x.length;T++)p.push(this.passes[x[T]]);b.passOffset=y,y+=b.passes.length}return(c=this.scatter).update.apply(c,p),this}},o.prototype.updateItem=function(c,n){var a=this.regl;if(n===null)return this.traces[c]=null,this;if(!n)return this;var g,p=d(n,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),y=this.traces[c]||(this.traces[c]={id:c,buffer:a.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:f([a._gl.drawingBufferWidth,a._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(p.color!=null&&(y.color=p.color),p.size!=null&&(y.size=p.size),p.marker!=null&&(y.marker=p.marker),p.borderColor!=null&&(y.borderColor=p.borderColor),p.borderSize!=null&&(y.borderSize=p.borderSize),p.opacity!=null&&(y.opacity=p.opacity),p.viewport&&(y.viewport=f(p.viewport)),p.diagonal!=null&&(y.diagonal=p.diagonal),p.upper!=null&&(y.upper=p.upper),p.lower!=null&&(y.lower=p.lower),p.data){y.buffer(l(p.data)),y.columns=p.data.length,y.count=p.data[0].length,y.bounds=[];for(var v=0;v<y.columns;v++)y.bounds[v]=m(p.data[v],1)}p.range&&(y.range=p.range,g=y.range&&typeof y.range[0]!="number"),p.domain&&(y.domain=p.domain);var b=!1;p.padding!=null&&(Array.isArray(p.padding)&&p.padding.length===y.columns&&typeof p.padding[p.padding.length-1]=="number"?(y.padding=p.padding.map(i),b=!0):y.padding=i(p.padding));var x=y.columns,T=y.count,A=y.viewport.width,S=y.viewport.height,w=y.viewport.x,E=y.viewport.y,k=A/x,L=S/x;y.passes=[];for(var M=0;M<x;M++)for(var P=0;P<x;P++)if((y.diagonal||P!==M)&&(y.upper||!(M>P))&&(y.lower||!(M<P))){var D=u(y.id,M,P),N=this.passes[D]||(this.passes[D]={});if(p.data&&(p.transpose?N.positions={x:{buffer:y.buffer,offset:P,count:T,stride:x},y:{buffer:y.buffer,offset:M,count:T,stride:x}}:N.positions={x:{buffer:y.buffer,offset:P*T,count:T},y:{buffer:y.buffer,offset:M*T,count:T}},N.bounds=s(y.bounds,M,P)),p.domain||p.viewport||p.data){var U=b?s(y.padding,M,P):y.padding;if(y.domain){var G=s(y.domain,M,P),X=G[0],K=G[1],Z=G[2],H=G[3];N.viewport=[w+X*A+U[0],E+K*S+U[1],w+Z*A-U[2],E+H*S-U[3]]}else N.viewport=[w+P*k+k*U[0],E+M*L+L*U[1],w+(P+1)*k-k*U[2],E+(M+1)*L-L*U[3]]}p.color&&(N.color=y.color),p.size&&(N.size=y.size),p.marker&&(N.marker=y.marker),p.borderSize&&(N.borderSize=y.borderSize),p.borderColor&&(N.borderColor=y.borderColor),p.opacity&&(N.opacity=y.opacity),p.range&&(N.range=g?s(y.range,M,P):y.range||N.bounds),y.passes.push(D)}return this},o.prototype.draw=function(){for(var c,n=[],a=arguments.length;a--;)n[a]=arguments[a];if(n.length){for(var g=[],p=0;p<n.length;p++)if(typeof n[p]=="number"){var y=this.traces[n[p]],v=y.passes,b=y.passOffset;g.push.apply(g,e(b,b+v.length))}else if(n[p].length){var x=n[p],T=this.traces[p],A=T.passes,S=T.passOffset;A=A.map(function(w,E){g[S+E]=x})}(c=this.scatter).draw.apply(c,g)}else this.scatter.draw();return this},o.prototype.destroy=function(){return this.traces.forEach(function(c){c.buffer&&c.buffer.destroy&&c.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":76,"array-range":79,"flatten-vertex-data":248,"parse-rect":481,"pick-by-alias":485,raf:516,"regl-scatter2d":524}],526:[function(r,I,B){(function(t,d){typeof B=="object"&&I!==void 0?I.exports=d():t.createREGL=d()})(this,function(){function t(Be,Ke){this.id=W++,this.type=Be,this.data=Ke}function d(Be){return"["+function Ke(_e){if(_e.length===0)return[];var Ce=_e.charAt(0),Le=_e.charAt(_e.length-1);if(1<_e.length&&Ce===Le&&(Ce==='"'||Ce==="'"))return['"'+_e.substr(1,_e.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(Ce=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(_e))return Ke(_e.substr(0,Ce.index)).concat(Ke(Ce[1])).concat(Ke(_e.substr(Ce.index+Ce[0].length)));if((Ce=_e.split(".")).length===1)return['"'+_e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(_e=[],Le=0;Le<Ce.length;++Le)_e=_e.concat(Ke(Ce[Le]));return _e}(Be).join("][")+"]"}function m(Be){return typeof Be=="string"?Be.split():Be}function h(Be){return typeof Be=="string"?document.querySelector(Be):Be}function e(Be){var Ke,_e,Ce,Le,Pe=Be||{};Be={};var Xe=[],ht=[],Mt=typeof window=="undefined"?1:window.devicePixelRatio,pt=!1,Lt=function(Dt){},vt=function(){};if(typeof Pe=="string"?Ke=document.querySelector(Pe):typeof Pe=="object"&&(typeof Pe.nodeName=="string"&&typeof Pe.appendChild=="function"&&typeof Pe.getBoundingClientRect=="function"?Ke=Pe:typeof Pe.drawArrays=="function"||typeof Pe.drawElements=="function"?Ce=(Le=Pe).canvas:("gl"in Pe?Le=Pe.gl:"canvas"in Pe?Ce=h(Pe.canvas):"container"in Pe&&(_e=h(Pe.container)),"attributes"in Pe&&(Be=Pe.attributes),"extensions"in Pe&&(Xe=m(Pe.extensions)),"optionalExtensions"in Pe&&(ht=m(Pe.optionalExtensions)),"onDone"in Pe&&(Lt=Pe.onDone),"profile"in Pe&&(pt=!!Pe.profile),"pixelRatio"in Pe&&(Mt=+Pe.pixelRatio))),Ke&&(Ke.nodeName.toLowerCase()==="canvas"?Ce=Ke:_e=Ke),!Le){if(!Ce){if(!(Ke=function(Dt,xt,it){function St(){var Qt=window.innerWidth,Ie=window.innerHeight;Dt!==document.body&&(Qt=(Ie=Ut.getBoundingClientRect()).right-Ie.left,Ie=Ie.bottom-Ie.top),Ut.width=it*Qt,Ut.height=it*Ie}var Nt,Ut=document.createElement("canvas");return j(Ut.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),Dt.appendChild(Ut),Dt===document.body&&(Ut.style.position="absolute",j(Dt.style,{margin:0,padding:0})),Dt!==document.body&&typeof ResizeObserver=="function"?(Nt=new ResizeObserver(function(){setTimeout(St)})).observe(Dt):window.addEventListener("resize",St,!1),St(),{canvas:Ut,onDestroy:function(){Nt?Nt.disconnect():window.removeEventListener("resize",St),Dt.removeChild(Ut)}}}(_e||document.body,0,Mt)))return null;Ce=Ke.canvas,vt=Ke.onDestroy}Be.premultipliedAlpha===void 0&&(Be.premultipliedAlpha=!0),Le=function(Dt,xt){function it(St){try{return Dt.getContext(St,xt)}catch(Nt){return null}}return it("webgl")||it("experimental-webgl")||it("webgl-experimental")}(Ce,Be)}return Le?{gl:Le,canvas:Ce,container:_e,extensions:Xe,optionalExtensions:ht,pixelRatio:Mt,profile:pt,onDone:Lt,onDestroy:vt}:(vt(),Lt("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function f(Be,Ke){for(var _e=Array(Be),Ce=0;Ce<Be;++Ce)_e[Ce]=Ke(Ce);return _e}function l(Be){var Ke,_e;return Ke=(65535<Be)<<4,Ke|=_e=(255<(Be>>>=Ke))<<3,(Ke|=_e=(15<(Be>>>=_e))<<2)|(_e=(3<(Be>>>=_e))<<1)|Be>>>_e>>1}function o(){function Be(Ce){e:{for(var Le=16;268435456>=Le;Le*=16)if(Ce<=Le){Ce=Le;break e}Ce=0}return 0<(Le=_e[l(Ce)>>2]).length?Le.pop():new ArrayBuffer(Ce)}function Ke(Ce){_e[l(Ce.byteLength)>>2].push(Ce)}var _e=f(8,function(){return[]});return{alloc:Be,free:Ke,allocType:function(Ce,Le){var Pe=null;switch(Ce){case 5120:Pe=new Int8Array(Be(Le),0,Le);break;case 5121:Pe=new Uint8Array(Be(Le),0,Le);break;case 5122:Pe=new Int16Array(Be(2*Le),0,Le);break;case 5123:Pe=new Uint16Array(Be(2*Le),0,Le);break;case 5124:Pe=new Int32Array(Be(4*Le),0,Le);break;case 5125:Pe=new Uint32Array(Be(4*Le),0,Le);break;case 5126:Pe=new Float32Array(Be(4*Le),0,Le);break;default:return null}return Pe.length!==Le?Pe.subarray(0,Le):Pe},freeType:function(Ce){Ke(Ce.buffer)}}}function u(Be){return!!Be&&typeof Be=="object"&&Array.isArray(Be.shape)&&Array.isArray(Be.stride)&&typeof Be.offset=="number"&&Be.shape.length===Be.stride.length&&(Array.isArray(Be.data)||ae(Be.data))}function s(Be,Ke,_e,Ce,Le,Pe){for(var Xe=0;Xe<Ke;++Xe)for(var ht=Be[Xe],Mt=0;Mt<_e;++Mt)for(var pt=ht[Mt],Lt=0;Lt<Ce;++Lt)Le[Pe++]=pt[Lt]}function i(Be){return 0|de[Object.prototype.toString.call(Be)]}function c(Be,Ke){for(var _e=0;_e<Ke.length;++_e)Be[_e]=Ke[_e]}function n(Be,Ke,_e,Ce,Le,Pe,Xe){for(var ht=0,Mt=0;Mt<_e;++Mt)for(var pt=0;pt<Ce;++pt)Be[ht++]=Ke[Le*Mt+Pe*pt+Xe]}function a(Be,Ke,_e,Ce){function Le(vt){this.id=Mt++,this.buffer=Be.createBuffer(),this.type=vt,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,_e.profile&&(this.stats={size:0})}function Pe(vt,Dt,xt){vt.byteLength=Dt.byteLength,Be.bufferData(vt.type,Dt,xt)}function Xe(vt,Dt,xt,it,St,Nt){if(vt.usage=xt,Array.isArray(Dt)){if(vt.dtype=it||5126,0<Dt.length)if(Array.isArray(Dt[0])){St=Ee(Dt);for(var Ut=it=1;Ut<St.length;++Ut)it*=St[Ut];vt.dimension=it,Pe(vt,Dt=ke(Dt,St,vt.dtype),xt),Nt?vt.persistentData=Dt:te.freeType(Dt)}else typeof Dt[0]=="number"?(vt.dimension=St,c(St=te.allocType(vt.dtype,Dt.length),Dt),Pe(vt,St,xt),Nt?vt.persistentData=St:te.freeType(St)):ae(Dt[0])&&(vt.dimension=Dt[0].length,vt.dtype=it||i(Dt[0])||5126,Pe(vt,Dt=ke(Dt,[Dt.length,Dt[0].length],vt.dtype),xt),Nt?vt.persistentData=Dt:te.freeType(Dt))}else if(ae(Dt))vt.dtype=it||i(Dt),vt.dimension=St,Pe(vt,Dt,xt),Nt&&(vt.persistentData=new Uint8Array(new Uint8Array(Dt.buffer)));else if(u(Dt)){St=Dt.shape;var Qt=Dt.stride,Ie=(Ut=Dt.offset,0),lt=0,wt=0,Ot=0;St.length===1?(Ie=St[0],lt=1,wt=Qt[0],Ot=0):St.length===2&&(Ie=St[0],lt=St[1],wt=Qt[0],Ot=Qt[1]),vt.dtype=it||i(Dt.data)||5126,vt.dimension=lt,n(St=te.allocType(vt.dtype,Ie*lt),Dt.data,Ie,lt,wt,Ot,Ut),Pe(vt,St,xt),Nt?vt.persistentData=St:te.freeType(St)}else Dt instanceof ArrayBuffer&&(vt.dtype=5121,vt.dimension=St,Pe(vt,Dt,xt),Nt&&(vt.persistentData=new Uint8Array(new Uint8Array(Dt))))}function ht(vt){Ke.bufferCount--,Ce(vt),Be.deleteBuffer(vt.buffer),vt.buffer=null,delete pt[vt.id]}var Mt=0,pt={};Le.prototype.bind=function(){Be.bindBuffer(this.type,this.buffer)},Le.prototype.destroy=function(){ht(this)};var Lt=[];return _e.profile&&(Ke.getTotalBufferSize=function(){var vt=0;return Object.keys(pt).forEach(function(Dt){vt+=pt[Dt].stats.size}),vt}),{create:function(vt,Dt,xt,it){function St(Ut){var Qt=35044,Ie=null,lt=0,wt=0,Ot=1;return Array.isArray(Ut)||ae(Ut)||u(Ut)||Ut instanceof ArrayBuffer?Ie=Ut:typeof Ut=="number"?lt=0|Ut:Ut&&("data"in Ut&&(Ie=Ut.data),"usage"in Ut&&(Qt=ve[Ut.usage]),"type"in Ut&&(wt=ue[Ut.type]),"dimension"in Ut&&(Ot=0|Ut.dimension),"length"in Ut&&(lt=0|Ut.length)),Nt.bind(),Ie?Xe(Nt,Ie,Qt,wt,Ot,it):(lt&&Be.bufferData(Nt.type,lt,Qt),Nt.dtype=wt||5121,Nt.usage=Qt,Nt.dimension=Ot,Nt.byteLength=lt),_e.profile&&(Nt.stats.size=Nt.byteLength*be[Nt.dtype]),St}Ke.bufferCount++;var Nt=new Le(Dt);return pt[Nt.id]=Nt,xt||St(vt),St._reglType="buffer",St._buffer=Nt,St.subdata=function(Ut,Qt){var Ie,lt=0|(Qt||0);if(Nt.bind(),ae(Ut)||Ut instanceof ArrayBuffer)Be.bufferSubData(Nt.type,lt,Ut);else if(Array.isArray(Ut)){if(0<Ut.length)if(typeof Ut[0]=="number"){var wt=te.allocType(Nt.dtype,Ut.length);c(wt,Ut),Be.bufferSubData(Nt.type,lt,wt),te.freeType(wt)}else(Array.isArray(Ut[0])||ae(Ut[0]))&&(Ie=Ee(Ut),wt=ke(Ut,Ie,Nt.dtype),Be.bufferSubData(Nt.type,lt,wt),te.freeType(wt))}else if(u(Ut)){Ie=Ut.shape;var Ot=Ut.stride,Gt=wt=0,ir=0,Xt=0;Ie.length===1?(wt=Ie[0],Gt=1,ir=Ot[0],Xt=0):Ie.length===2&&(wt=Ie[0],Gt=Ie[1],ir=Ot[0],Xt=Ot[1]),Ie=Array.isArray(Ut.data)?Nt.dtype:i(Ut.data),n(Ie=te.allocType(Ie,wt*Gt),Ut.data,wt,Gt,ir,Xt,Ut.offset),Be.bufferSubData(Nt.type,lt,Ie),te.freeType(Ie)}return St},_e.profile&&(St.stats=Nt.stats),St.destroy=function(){ht(Nt)},St},createStream:function(vt,Dt){var xt=Lt.pop();return xt||(xt=new Le(vt)),xt.bind(),Xe(xt,Dt,35040,0,1,!1),xt},destroyStream:function(vt){Lt.push(vt)},clear:function(){he(pt).forEach(ht),Lt.forEach(ht)},getBuffer:function(vt){return vt&&vt._buffer instanceof Le?vt._buffer:null},restore:function(){he(pt).forEach(function(vt){vt.buffer=Be.createBuffer(),Be.bindBuffer(vt.type,vt.buffer),Be.bufferData(vt.type,vt.persistentData||vt.byteLength,vt.usage)})},_initBuffer:Xe}}function g(Be,Ke,_e,Ce){function Le(vt){this.id=Mt++,ht[this.id]=this,this.buffer=vt,this.primType=4,this.type=this.vertCount=0}function Pe(vt,Dt,xt,it,St,Nt,Ut){var Qt;if(vt.buffer.bind(),Dt?((Qt=Ut)||ae(Dt)&&(!u(Dt)||ae(Dt.data))||(Qt=Ke.oes_element_index_uint?5125:5123),_e._initBuffer(vt.buffer,Dt,xt,Qt,3)):(Be.bufferData(34963,Nt,xt),vt.buffer.dtype=Qt||5121,vt.buffer.usage=xt,vt.buffer.dimension=3,vt.buffer.byteLength=Nt),Qt=Ut,!Ut){switch(vt.buffer.dtype){case 5121:case 5120:Qt=5121;break;case 5123:case 5122:Qt=5123;break;case 5125:case 5124:Qt=5125}vt.buffer.dtype=Qt}vt.type=Qt,0>(Dt=St)&&(Dt=vt.buffer.byteLength,Qt===5123?Dt>>=1:Qt===5125&&(Dt>>=2)),vt.vertCount=Dt,Dt=it,0>it&&(Dt=4,(it=vt.buffer.dimension)===1&&(Dt=0),it===2&&(Dt=1),it===3&&(Dt=4)),vt.primType=Dt}function Xe(vt){Ce.elementsCount--,delete ht[vt.id],vt.buffer.destroy(),vt.buffer=null}var ht={},Mt=0,pt={uint8:5121,uint16:5123};Ke.oes_element_index_uint&&(pt.uint32=5125),Le.prototype.bind=function(){this.buffer.bind()};var Lt=[];return{create:function(vt,Dt){function xt(Nt){if(Nt)if(typeof Nt=="number")it(Nt),St.primType=4,St.vertCount=0|Nt,St.type=5121;else{var Ut=null,Qt=35044,Ie=-1,lt=-1,wt=0,Ot=0;Array.isArray(Nt)||ae(Nt)||u(Nt)?Ut=Nt:("data"in Nt&&(Ut=Nt.data),"usage"in Nt&&(Qt=ve[Nt.usage]),"primitive"in Nt&&(Ie=xe[Nt.primitive]),"count"in Nt&&(lt=0|Nt.count),"type"in Nt&&(Ot=pt[Nt.type]),"length"in Nt?wt=0|Nt.length:(wt=lt,Ot===5123||Ot===5122?wt*=2:Ot!==5125&&Ot!==5124||(wt*=4))),Pe(St,Ut,Qt,Ie,lt,wt,Ot)}else it(),St.primType=4,St.vertCount=0,St.type=5121;return xt}var it=_e.create(null,34963,!0),St=new Le(it._buffer);return Ce.elementsCount++,xt(vt),xt._reglType="elements",xt._elements=St,xt.subdata=function(Nt,Ut){return it.subdata(Nt,Ut),xt},xt.destroy=function(){Xe(St)},xt},createStream:function(vt){var Dt=Lt.pop();return Dt||(Dt=new Le(_e.create(null,34963,!0,!1)._buffer)),Pe(Dt,vt,35040,-1,-1,0,0),Dt},destroyStream:function(vt){Lt.push(vt)},getElements:function(vt){return typeof vt=="function"&&vt._elements instanceof Le?vt._elements:null},clear:function(){he(ht).forEach(Xe)}}}function p(Be){for(var Ke=te.allocType(5123,Be.length),_e=0;_e<Be.length;++_e)if(isNaN(Be[_e]))Ke[_e]=65535;else if(1/0===Be[_e])Ke[_e]=31744;else if(-1/0===Be[_e])Ke[_e]=64512;else{ce[0]=Be[_e];var Ce=(Pe=ge[0])>>>31<<15,Le=(Pe<<1>>>24)-127,Pe=Pe>>13&1023;Ke[_e]=-24>Le?Ce:-14>Le?Ce+(Pe+1024>>-14-Le):15<Le?Ce+31744:Ce+(Le+15<<10)+Pe}return Ke}function y(Be){return Array.isArray(Be)||ae(Be)}function v(Be){return"[object "+Be+"]"}function b(Be){return Array.isArray(Be)&&(Be.length===0||typeof Be[0]=="number")}function x(Be){return!(!Array.isArray(Be)||Be.length===0||!y(Be[0]))}function T(Be){return Object.prototype.toString.call(Be)}function A(Be){if(!Be)return!1;var Ke=T(Be);return 0<=We.indexOf(Ke)||b(Be)||x(Be)||u(Be)}function S(Be,Ke){Be.type===36193?(Be.data=p(Ke),te.freeType(Ke)):Be.data=Ke}function w(Be,Ke,_e,Ce,Le,Pe){if(Be=et[Be]!==void 0?et[Be]:Se[Be]*qe[Ke],Pe&&(Be*=6),Le){for(Ce=0;1<=_e;)Ce+=Be*_e*_e,_e/=2;return Ce}return Be*_e*Ce}function E(Be,Ke,_e,Ce,Le,Pe,Xe){function ht(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function Mt(Jt,It){Jt.internalformat=It.internalformat,Jt.format=It.format,Jt.type=It.type,Jt.compressed=It.compressed,Jt.premultiplyAlpha=It.premultiplyAlpha,Jt.flipY=It.flipY,Jt.unpackAlignment=It.unpackAlignment,Jt.colorSpace=It.colorSpace,Jt.width=It.width,Jt.height=It.height,Jt.channels=It.channels}function pt(Jt,It){if(typeof It=="object"&&It){"premultiplyAlpha"in It&&(Jt.premultiplyAlpha=It.premultiplyAlpha),"flipY"in It&&(Jt.flipY=It.flipY),"alignment"in It&&(Jt.unpackAlignment=It.alignment),"colorSpace"in It&&(Jt.colorSpace=Rr[It.colorSpace]),"type"in It&&(Jt.type=_r[It.type]);var qt=Jt.width,fr=Jt.height,Tr=Jt.channels,Gr=!1;"shape"in It?(qt=It.shape[0],fr=It.shape[1],It.shape.length===3&&(Tr=It.shape[2],Gr=!0)):("radius"in It&&(qt=fr=It.radius),"width"in It&&(qt=It.width),"height"in It&&(fr=It.height),"channels"in It&&(Tr=It.channels,Gr=!0)),Jt.width=0|qt,Jt.height=0|fr,Jt.channels=0|Tr,qt=!1,"format"in It&&(qt=It.format,fr=Jt.internalformat=jr[qt],Jt.format=en[fr],qt in _r&&!("type"in It)&&(Jt.type=_r[qt]),qt in $r&&(Jt.compressed=!0),qt=!0),!Gr&&qt?Jt.channels=Se[Jt.format]:Gr&&!qt&&Jt.channels!==Me[Jt.format]&&(Jt.format=Jt.internalformat=Me[Jt.channels])}}function Lt(Jt){Be.pixelStorei(37440,Jt.flipY),Be.pixelStorei(37441,Jt.premultiplyAlpha),Be.pixelStorei(37443,Jt.colorSpace),Be.pixelStorei(3317,Jt.unpackAlignment)}function vt(){ht.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Dt(Jt,It){var qt=null;if(A(It)?qt=It:It&&(pt(Jt,It),"x"in It&&(Jt.xOffset=0|It.x),"y"in It&&(Jt.yOffset=0|It.y),A(It.data)&&(qt=It.data)),It.copy){var fr=Le.viewportWidth,Tr=Le.viewportHeight;Jt.width=Jt.width||fr-Jt.xOffset,Jt.height=Jt.height||Tr-Jt.yOffset,Jt.needsCopy=!0}else if(qt){if(ae(qt))Jt.channels=Jt.channels||4,Jt.data=qt,"type"in It||Jt.type!==5121||(Jt.type=0|de[Object.prototype.toString.call(qt)]);else if(b(qt)){switch(Jt.channels=Jt.channels||4,Tr=(fr=qt).length,Jt.type){case 5121:case 5123:case 5125:case 5126:(Tr=te.allocType(Jt.type,Tr)).set(fr),Jt.data=Tr;break;case 36193:Jt.data=p(fr)}Jt.alignment=1,Jt.needsFree=!0}else if(u(qt)){fr=qt.data,Array.isArray(fr)||Jt.type!==5121||(Jt.type=0|de[Object.prototype.toString.call(fr)]),Tr=qt.shape;var Gr,Vr,xr,wr,Sr=qt.stride;Tr.length===3?(xr=Tr[2],wr=Sr[2]):wr=xr=1,Gr=Tr[0],Vr=Tr[1],Tr=Sr[0],Sr=Sr[1],Jt.alignment=1,Jt.width=Gr,Jt.height=Vr,Jt.channels=xr,Jt.format=Jt.internalformat=Me[xr],Jt.needsFree=!0,Gr=wr,qt=qt.offset,xr=Jt.width,wr=Jt.height,Vr=Jt.channels;for(var Mr=te.allocType(Jt.type===36193?5126:Jt.type,xr*wr*Vr),Ir=0,qr=0;qr<wr;++qr)for(var cn=0;cn<xr;++cn)for(var _n=0;_n<Vr;++_n)Mr[Ir++]=fr[Tr*cn+Sr*qr+Gr*_n+qt];S(Jt,Mr)}else if(T(qt)===ze||T(qt)===Fe||T(qt)===Ye)T(qt)===ze||T(qt)===Fe?Jt.element=qt:Jt.element=qt.canvas,Jt.width=Jt.element.width,Jt.height=Jt.element.height,Jt.channels=4;else if(T(qt)===rt)Jt.element=qt,Jt.width=qt.width,Jt.height=qt.height,Jt.channels=4;else if(T(qt)===Oe)Jt.element=qt,Jt.width=qt.naturalWidth,Jt.height=qt.naturalHeight,Jt.channels=4;else if(T(qt)===je)Jt.element=qt,Jt.width=qt.videoWidth,Jt.height=qt.videoHeight,Jt.channels=4;else if(x(qt)){for(fr=Jt.width||qt[0].length,Tr=Jt.height||qt.length,Sr=Jt.channels,Sr=y(qt[0][0])?Sr||qt[0][0].length:Sr||1,Gr=se.shape(qt),xr=1,wr=0;wr<Gr.length;++wr)xr*=Gr[wr];xr=te.allocType(Jt.type===36193?5126:Jt.type,xr),se.flatten(qt,Gr,"",xr),S(Jt,xr),Jt.alignment=1,Jt.width=fr,Jt.height=Tr,Jt.channels=Sr,Jt.format=Jt.internalformat=Me[Sr],Jt.needsFree=!0}}else Jt.width=Jt.width||1,Jt.height=Jt.height||1,Jt.channels=Jt.channels||4}function xt(Jt,It,qt,fr,Tr){var Gr=Jt.element,Vr=Jt.data,xr=Jt.internalformat,wr=Jt.format,Sr=Jt.type,Mr=Jt.width,Ir=Jt.height;Lt(Jt),Gr?Be.texSubImage2D(It,Tr,qt,fr,wr,Sr,Gr):Jt.compressed?Be.compressedTexSubImage2D(It,Tr,qt,fr,xr,Mr,Ir,Vr):Jt.needsCopy?(Ce(),Be.copyTexSubImage2D(It,Tr,qt,fr,Jt.xOffset,Jt.yOffset,Mr,Ir)):Be.texSubImage2D(It,Tr,qt,fr,Mr,Ir,wr,Sr,Vr)}function it(){return tn.pop()||new vt}function St(Jt){Jt.needsFree&&te.freeType(Jt.data),vt.call(Jt),tn.push(Jt)}function Nt(){ht.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function Ut(Jt,It,qt){var fr=Jt.images[0]=it();Jt.mipmask=1,fr.width=Jt.width=It,fr.height=Jt.height=qt,fr.channels=Jt.channels=4}function Qt(Jt,It){var qt=null;if(A(It))Mt(qt=Jt.images[0]=it(),Jt),Dt(qt,It),Jt.mipmask=1;else if(pt(Jt,It),Array.isArray(It.mipmap))for(var fr=It.mipmap,Tr=0;Tr<fr.length;++Tr)Mt(qt=Jt.images[Tr]=it(),Jt),qt.width>>=Tr,qt.height>>=Tr,Dt(qt,fr[Tr]),Jt.mipmask|=1<<Tr;else Mt(qt=Jt.images[0]=it(),Jt),Dt(qt,It),Jt.mipmask=1;Mt(Jt,Jt.images[0])}function Ie(Jt,It){for(var qt=Jt.images,fr=0;fr<qt.length&&qt[fr];++fr){var Tr=qt[fr],Gr=It,Vr=fr,xr=Tr.element,wr=Tr.data,Sr=Tr.internalformat,Mr=Tr.format,Ir=Tr.type,qr=Tr.width,cn=Tr.height;Lt(Tr),xr?Be.texImage2D(Gr,Vr,Mr,Mr,Ir,xr):Tr.compressed?Be.compressedTexImage2D(Gr,Vr,Sr,qr,cn,0,wr):Tr.needsCopy?(Ce(),Be.copyTexImage2D(Gr,Vr,Mr,Tr.xOffset,Tr.yOffset,qr,cn,0)):Be.texImage2D(Gr,Vr,Mr,qr,cn,0,Mr,Ir,wr||null)}}function lt(){var Jt=Qr.pop()||new Nt;ht.call(Jt);for(var It=Jt.mipmask=0;16>It;++It)Jt.images[It]=null;return Jt}function wt(Jt){for(var It=Jt.images,qt=0;qt<It.length;++qt)It[qt]&&St(It[qt]),It[qt]=null;Qr.push(Jt)}function Ot(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function Gt(Jt,It){"min"in It&&(Jt.minFilter=br[It.min],0<=we.indexOf(Jt.minFilter)&&!("faces"in It)&&(Jt.genMipmaps=!0)),"mag"in It&&(Jt.magFilter=pr[It.mag]);var qt=Jt.wrapS,fr=Jt.wrapT;if("wrap"in It){var Tr=It.wrap;typeof Tr=="string"?qt=fr=ur[Tr]:Array.isArray(Tr)&&(qt=ur[Tr[0]],fr=ur[Tr[1]])}else"wrapS"in It&&(qt=ur[It.wrapS]),"wrapT"in It&&(fr=ur[It.wrapT]);if(Jt.wrapS=qt,Jt.wrapT=fr,"anisotropic"in It&&(Jt.anisotropic=It.anisotropic),"mipmap"in It){switch(qt=!1,typeof It.mipmap){case"string":Jt.mipmapHint=vr[It.mipmap],qt=Jt.genMipmaps=!0;break;case"boolean":qt=Jt.genMipmaps=It.mipmap;break;case"object":Jt.genMipmaps=!1,qt=!0}!qt||"min"in It||(Jt.minFilter=9984)}}function ir(Jt,It){Be.texParameteri(It,10241,Jt.minFilter),Be.texParameteri(It,10240,Jt.magFilter),Be.texParameteri(It,10242,Jt.wrapS),Be.texParameteri(It,10243,Jt.wrapT),Ke.ext_texture_filter_anisotropic&&Be.texParameteri(It,34046,Jt.anisotropic),Jt.genMipmaps&&(Be.hint(33170,Jt.mipmapHint),Be.generateMipmap(It))}function Xt(Jt){ht.call(this),this.mipmask=0,this.internalformat=6408,this.id=rn++,this.refCount=1,this.target=Jt,this.texture=Be.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ot,Xe.profile&&(this.stats={size:0})}function Kt(Jt){Be.activeTexture(33984),Be.bindTexture(Jt.target,Jt.texture)}function or(){var Jt=Bn[0];Jt?Be.bindTexture(Jt.target,Jt.texture):Be.bindTexture(3553,null)}function dr(Jt){var It=Jt.texture,qt=Jt.unit,fr=Jt.target;0<=qt&&(Be.activeTexture(33984+qt),Be.bindTexture(fr,null),Bn[qt]=null),Be.deleteTexture(It),Jt.texture=null,Jt.params=null,Jt.pixels=null,Jt.refCount=0,delete An[Jt.id],Pe.textureCount--}var vr={"don't care":4352,"dont care":4352,nice:4354,fast:4353},ur={repeat:10497,clamp:33071,mirror:33648},pr={nearest:9728,linear:9729},br=j({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},pr),Rr={none:0,browser:37444},_r={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},jr={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},$r={};Ke.ext_srgb&&(jr.srgb=35904,jr.srgba=35906),Ke.oes_texture_float&&(_r.float32=_r.float=5126),Ke.oes_texture_half_float&&(_r.float16=_r["half float"]=36193),Ke.webgl_depth_texture&&(j(jr,{depth:6402,"depth stencil":34041}),j(_r,{uint16:5123,uint32:5125,"depth stencil":34042})),Ke.webgl_compressed_texture_s3tc&&j($r,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),Ke.webgl_compressed_texture_atc&&j($r,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),Ke.webgl_compressed_texture_pvrtc&&j($r,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),Ke.webgl_compressed_texture_etc1&&($r["rgb etc1"]=36196);var pn=Array.prototype.slice.call(Be.getParameter(34467));Object.keys($r).forEach(function(Jt){var It=$r[Jt];0<=pn.indexOf(It)&&(jr[Jt]=It)});var In=Object.keys(jr);_e.textureFormats=In;var On=[];Object.keys(jr).forEach(function(Jt){On[jr[Jt]]=Jt});var Sn=[];Object.keys(_r).forEach(function(Jt){Sn[_r[Jt]]=Jt});var an=[];Object.keys(pr).forEach(function(Jt){an[pr[Jt]]=Jt});var Nr=[];Object.keys(br).forEach(function(Jt){Nr[br[Jt]]=Jt});var Pr=[];Object.keys(ur).forEach(function(Jt){Pr[ur[Jt]]=Jt});var en=In.reduce(function(Jt,It){var qt=jr[It];return qt===6409||qt===6406||qt===6409||qt===6410||qt===6402||qt===34041||Ke.ext_srgb&&(qt===35904||qt===35906)?Jt[qt]=qt:qt===32855||0<=It.indexOf("rgba")?Jt[qt]=6408:Jt[qt]=6407,Jt},{}),tn=[],Qr=[],rn=0,An={},En=_e.maxTextureUnits,Bn=Array(En).map(function(){return null});return j(Xt.prototype,{bind:function(){this.bindCount+=1;var Jt=this.unit;if(0>Jt){for(var It=0;It<En;++It){var qt=Bn[It];if(qt){if(0<qt.bindCount)continue;qt.unit=-1}Bn[It]=this,Jt=It;break}Xe.profile&&Pe.maxTextureUnits<Jt+1&&(Pe.maxTextureUnits=Jt+1),this.unit=Jt,Be.activeTexture(33984+Jt),Be.bindTexture(this.target,this.texture)}return Jt},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&dr(this)}}),Xe.profile&&(Pe.getTotalTextureSize=function(){var Jt=0;return Object.keys(An).forEach(function(It){Jt+=An[It].stats.size}),Jt}),{create2D:function(Jt,It){function qt(Tr,Gr){var Vr=fr.texInfo;Ot.call(Vr);var xr=lt();return typeof Tr=="number"?Ut(xr,0|Tr,typeof Gr=="number"?0|Gr:0|Tr):Tr?(Gt(Vr,Tr),Qt(xr,Tr)):Ut(xr,1,1),Vr.genMipmaps&&(xr.mipmask=(xr.width<<1)-1),fr.mipmask=xr.mipmask,Mt(fr,xr),fr.internalformat=xr.internalformat,qt.width=xr.width,qt.height=xr.height,Kt(fr),Ie(xr,3553),ir(Vr,3553),or(),wt(xr),Xe.profile&&(fr.stats.size=w(fr.internalformat,fr.type,xr.width,xr.height,Vr.genMipmaps,!1)),qt.format=On[fr.internalformat],qt.type=Sn[fr.type],qt.mag=an[Vr.magFilter],qt.min=Nr[Vr.minFilter],qt.wrapS=Pr[Vr.wrapS],qt.wrapT=Pr[Vr.wrapT],qt}var fr=new Xt(3553);return An[fr.id]=fr,Pe.textureCount++,qt(Jt,It),qt.subimage=function(Tr,Gr,Vr,xr){Gr|=0,Vr|=0,xr|=0;var wr=it();return Mt(wr,fr),wr.width=0,wr.height=0,Dt(wr,Tr),wr.width=wr.width||(fr.width>>xr)-Gr,wr.height=wr.height||(fr.height>>xr)-Vr,Kt(fr),xt(wr,3553,Gr,Vr,xr),or(),St(wr),qt},qt.resize=function(Tr,Gr){var Vr=0|Tr,xr=0|Gr||Vr;if(Vr===fr.width&&xr===fr.height)return qt;qt.width=fr.width=Vr,qt.height=fr.height=xr,Kt(fr);for(var wr=0;fr.mipmask>>wr;++wr){var Sr=Vr>>wr,Mr=xr>>wr;if(!Sr||!Mr)break;Be.texImage2D(3553,wr,fr.format,Sr,Mr,0,fr.format,fr.type,null)}return or(),Xe.profile&&(fr.stats.size=w(fr.internalformat,fr.type,Vr,xr,!1,!1)),qt},qt._reglType="texture2d",qt._texture=fr,Xe.profile&&(qt.stats=fr.stats),qt.destroy=function(){fr.decRef()},qt},createCube:function(Jt,It,qt,fr,Tr,Gr){function Vr(Sr,Mr,Ir,qr,cn,_n){var Jr,bn=xr.texInfo;for(Ot.call(bn),Jr=0;6>Jr;++Jr)wr[Jr]=lt();if(typeof Sr!="number"&&Sr){if(typeof Sr=="object")if(Mr)Qt(wr[0],Sr),Qt(wr[1],Mr),Qt(wr[2],Ir),Qt(wr[3],qr),Qt(wr[4],cn),Qt(wr[5],_n);else if(Gt(bn,Sr),pt(xr,Sr),"faces"in Sr)for(Sr=Sr.faces,Jr=0;6>Jr;++Jr)Mt(wr[Jr],xr),Qt(wr[Jr],Sr[Jr]);else for(Jr=0;6>Jr;++Jr)Qt(wr[Jr],Sr)}else for(Sr=0|Sr||1,Jr=0;6>Jr;++Jr)Ut(wr[Jr],Sr,Sr);for(Mt(xr,wr[0]),xr.mipmask=bn.genMipmaps?(wr[0].width<<1)-1:wr[0].mipmask,xr.internalformat=wr[0].internalformat,Vr.width=wr[0].width,Vr.height=wr[0].height,Kt(xr),Jr=0;6>Jr;++Jr)Ie(wr[Jr],34069+Jr);for(ir(bn,34067),or(),Xe.profile&&(xr.stats.size=w(xr.internalformat,xr.type,Vr.width,Vr.height,bn.genMipmaps,!0)),Vr.format=On[xr.internalformat],Vr.type=Sn[xr.type],Vr.mag=an[bn.magFilter],Vr.min=Nr[bn.minFilter],Vr.wrapS=Pr[bn.wrapS],Vr.wrapT=Pr[bn.wrapT],Jr=0;6>Jr;++Jr)wt(wr[Jr]);return Vr}var xr=new Xt(34067);An[xr.id]=xr,Pe.cubeCount++;var wr=Array(6);return Vr(Jt,It,qt,fr,Tr,Gr),Vr.subimage=function(Sr,Mr,Ir,qr,cn){Ir|=0,qr|=0,cn|=0;var _n=it();return Mt(_n,xr),_n.width=0,_n.height=0,Dt(_n,Mr),_n.width=_n.width||(xr.width>>cn)-Ir,_n.height=_n.height||(xr.height>>cn)-qr,Kt(xr),xt(_n,34069+Sr,Ir,qr,cn),or(),St(_n),Vr},Vr.resize=function(Sr){if((Sr|=0)!==xr.width){Vr.width=xr.width=Sr,Vr.height=xr.height=Sr,Kt(xr);for(var Mr=0;6>Mr;++Mr)for(var Ir=0;xr.mipmask>>Ir;++Ir)Be.texImage2D(34069+Mr,Ir,xr.format,Sr>>Ir,Sr>>Ir,0,xr.format,xr.type,null);return or(),Xe.profile&&(xr.stats.size=w(xr.internalformat,xr.type,Vr.width,Vr.height,!1,!0)),Vr}},Vr._reglType="textureCube",Vr._texture=xr,Xe.profile&&(Vr.stats=xr.stats),Vr.destroy=function(){xr.decRef()},Vr},clear:function(){for(var Jt=0;Jt<En;++Jt)Be.activeTexture(33984+Jt),Be.bindTexture(3553,null),Bn[Jt]=null;he(An).forEach(dr),Pe.cubeCount=0,Pe.textureCount=0},getTexture:function(Jt){return null},restore:function(){for(var Jt=0;Jt<En;++Jt){var It=Bn[Jt];It&&(It.bindCount=0,It.unit=-1,Bn[Jt]=null)}he(An).forEach(function(qt){qt.texture=Be.createTexture(),Be.bindTexture(qt.target,qt.texture);for(var fr=0;32>fr;++fr)if((qt.mipmask&1<<fr)!=0)if(qt.target===3553)Be.texImage2D(3553,fr,qt.internalformat,qt.width>>fr,qt.height>>fr,0,qt.internalformat,qt.type,null);else for(var Tr=0;6>Tr;++Tr)Be.texImage2D(34069+Tr,fr,qt.internalformat,qt.width>>fr,qt.height>>fr,0,qt.internalformat,qt.type,null);ir(qt.texInfo,qt.target)})},refresh:function(){for(var Jt=0;Jt<En;++Jt){var It=Bn[Jt];It&&(It.bindCount=0,It.unit=-1,Bn[Jt]=null),Be.activeTexture(33984+Jt),Be.bindTexture(3553,null),Be.bindTexture(34067,null)}}}}function k(Be,Ke,_e,Ce,Le,Pe){function Xe(Xt,Kt,or){this.target=Xt,this.texture=Kt,this.renderbuffer=or;var dr=Xt=0;Kt?(Xt=Kt.width,dr=Kt.height):or&&(Xt=or.width,dr=or.height),this.width=Xt,this.height=dr}function ht(Xt){Xt&&(Xt.texture&&Xt.texture._texture.decRef(),Xt.renderbuffer&&Xt.renderbuffer._renderbuffer.decRef())}function Mt(Xt,Kt,or){Xt&&(Xt.texture?Xt.texture._texture.refCount+=1:Xt.renderbuffer._renderbuffer.refCount+=1)}function pt(Xt,Kt){Kt&&(Kt.texture?Be.framebufferTexture2D(36160,Xt,Kt.target,Kt.texture._texture.texture,0):Be.framebufferRenderbuffer(36160,Xt,36161,Kt.renderbuffer._renderbuffer.renderbuffer))}function Lt(Xt){var Kt=3553,or=null,dr=null,vr=Xt;return typeof Xt=="object"&&(vr=Xt.data,"target"in Xt&&(Kt=0|Xt.target)),(Xt=vr._reglType)==="texture2d"||Xt==="textureCube"?or=vr:Xt==="renderbuffer"&&(dr=vr,Kt=36161),new Xe(Kt,or,dr)}function vt(Xt,Kt,or,dr,vr){return or?((Xt=Ce.create2D({width:Xt,height:Kt,format:dr,type:vr}))._texture.refCount=0,new Xe(3553,Xt,null)):((Xt=Le.create({width:Xt,height:Kt,format:dr}))._renderbuffer.refCount=0,new Xe(36161,null,Xt))}function Dt(Xt){return Xt&&(Xt.texture||Xt.renderbuffer)}function xt(Xt,Kt,or){Xt&&(Xt.texture?Xt.texture.resize(Kt,or):Xt.renderbuffer&&Xt.renderbuffer.resize(Kt,or),Xt.width=Kt,Xt.height=or)}function it(){this.id=Gt++,ir[this.id]=this,this.framebuffer=Be.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function St(Xt){Xt.colorAttachments.forEach(ht),ht(Xt.depthAttachment),ht(Xt.stencilAttachment),ht(Xt.depthStencilAttachment)}function Nt(Xt){Be.deleteFramebuffer(Xt.framebuffer),Xt.framebuffer=null,Pe.framebufferCount--,delete ir[Xt.id]}function Ut(Xt){var Kt;Be.bindFramebuffer(36160,Xt.framebuffer);var or=Xt.colorAttachments;for(Kt=0;Kt<or.length;++Kt)pt(36064+Kt,or[Kt]);for(Kt=or.length;Kt<_e.maxColorAttachments;++Kt)Be.framebufferTexture2D(36160,36064+Kt,3553,null,0);Be.framebufferTexture2D(36160,33306,3553,null,0),Be.framebufferTexture2D(36160,36096,3553,null,0),Be.framebufferTexture2D(36160,36128,3553,null,0),pt(36096,Xt.depthAttachment),pt(36128,Xt.stencilAttachment),pt(33306,Xt.depthStencilAttachment),Be.checkFramebufferStatus(36160),Be.isContextLost(),Be.bindFramebuffer(36160,Ie.next?Ie.next.framebuffer:null),Ie.cur=Ie.next,Be.getError()}function Qt(Xt,Kt){function or(vr,ur){var pr,br=0,Rr=0,_r=!0,jr=!0;pr=null;var $r=!0,pn="rgba",In="uint8",On=1,Sn=null,an=null,Nr=null,Pr=!1;typeof vr=="number"?(br=0|vr,Rr=0|ur||br):vr?("shape"in vr?(br=(Rr=vr.shape)[0],Rr=Rr[1]):("radius"in vr&&(br=Rr=vr.radius),"width"in vr&&(br=vr.width),"height"in vr&&(Rr=vr.height)),("color"in vr||"colors"in vr)&&(pr=vr.color||vr.colors,Array.isArray(pr)),pr||("colorCount"in vr&&(On=0|vr.colorCount),"colorTexture"in vr&&($r=!!vr.colorTexture,pn="rgba4"),"colorType"in vr&&(In=vr.colorType,!$r)&&(In==="half float"||In==="float16"?pn="rgba16f":In!=="float"&&In!=="float32"||(pn="rgba32f")),"colorFormat"in vr&&(pn=vr.colorFormat,0<=lt.indexOf(pn)?$r=!0:0<=wt.indexOf(pn)&&($r=!1))),("depthTexture"in vr||"depthStencilTexture"in vr)&&(Pr=!(!vr.depthTexture&&!vr.depthStencilTexture)),"depth"in vr&&(typeof vr.depth=="boolean"?_r=vr.depth:(Sn=vr.depth,jr=!1)),"stencil"in vr&&(typeof vr.stencil=="boolean"?jr=vr.stencil:(an=vr.stencil,_r=!1)),"depthStencil"in vr&&(typeof vr.depthStencil=="boolean"?_r=jr=vr.depthStencil:(Nr=vr.depthStencil,jr=_r=!1))):br=Rr=1;var en=null,tn=null,Qr=null,rn=null;if(Array.isArray(pr))en=pr.map(Lt);else if(pr)en=[Lt(pr)];else for(en=Array(On),pr=0;pr<On;++pr)en[pr]=vt(br,Rr,$r,pn,In);for(br=br||en[0].width,Rr=Rr||en[0].height,Sn?tn=Lt(Sn):_r&&!jr&&(tn=vt(br,Rr,Pr,"depth","uint32")),an?Qr=Lt(an):jr&&!_r&&(Qr=vt(br,Rr,!1,"stencil","uint8")),Nr?rn=Lt(Nr):!Sn&&!an&&jr&&_r&&(rn=vt(br,Rr,Pr,"depth stencil","depth stencil")),_r=null,pr=0;pr<en.length;++pr)Mt(en[pr]),en[pr]&&en[pr].texture&&(jr=Pt[en[pr].texture._texture.format]*kt[en[pr].texture._texture.type],_r===null&&(_r=jr));return Mt(tn),Mt(Qr),Mt(rn),St(dr),dr.width=br,dr.height=Rr,dr.colorAttachments=en,dr.depthAttachment=tn,dr.stencilAttachment=Qr,dr.depthStencilAttachment=rn,or.color=en.map(Dt),or.depth=Dt(tn),or.stencil=Dt(Qr),or.depthStencil=Dt(rn),or.width=dr.width,or.height=dr.height,Ut(dr),or}var dr=new it;return Pe.framebufferCount++,or(Xt,Kt),j(or,{resize:function(vr,ur){var pr=Math.max(0|vr,1),br=Math.max(0|ur||pr,1);if(pr===dr.width&&br===dr.height)return or;for(var Rr=dr.colorAttachments,_r=0;_r<Rr.length;++_r)xt(Rr[_r],pr,br);return xt(dr.depthAttachment,pr,br),xt(dr.stencilAttachment,pr,br),xt(dr.depthStencilAttachment,pr,br),dr.width=or.width=pr,dr.height=or.height=br,Ut(dr),or},_reglType:"framebuffer",_framebuffer:dr,destroy:function(){Nt(dr),St(dr)},use:function(vr){Ie.setFBO({framebuffer:or},vr)}})}var Ie={cur:null,next:null,dirty:!1,setFBO:null},lt=["rgba"],wt=["rgba4","rgb565","rgb5 a1"];Ke.ext_srgb&&wt.push("srgba"),Ke.ext_color_buffer_half_float&&wt.push("rgba16f","rgb16f"),Ke.webgl_color_buffer_float&&wt.push("rgba32f");var Ot=["uint8"];Ke.oes_texture_half_float&&Ot.push("half float","float16"),Ke.oes_texture_float&&Ot.push("float","float32");var Gt=0,ir={};return j(Ie,{getFramebuffer:function(Xt){return typeof Xt=="function"&&Xt._reglType==="framebuffer"&&(Xt=Xt._framebuffer)instanceof it?Xt:null},create:Qt,createCube:function(Xt){function Kt(dr){var vr,ur={color:null},pr=0,br=null;vr="rgba";var Rr="uint8",_r=1;if(typeof dr=="number"?pr=0|dr:dr?("shape"in dr?pr=dr.shape[0]:("radius"in dr&&(pr=0|dr.radius),"width"in dr?pr=0|dr.width:"height"in dr&&(pr=0|dr.height)),("color"in dr||"colors"in dr)&&(br=dr.color||dr.colors,Array.isArray(br)),br||("colorCount"in dr&&(_r=0|dr.colorCount),"colorType"in dr&&(Rr=dr.colorType),"colorFormat"in dr&&(vr=dr.colorFormat)),"depth"in dr&&(ur.depth=dr.depth),"stencil"in dr&&(ur.stencil=dr.stencil),"depthStencil"in dr&&(ur.depthStencil=dr.depthStencil)):pr=1,br)if(Array.isArray(br))for(dr=[],vr=0;vr<br.length;++vr)dr[vr]=br[vr];else dr=[br];else for(dr=Array(_r),br={radius:pr,format:vr,type:Rr},vr=0;vr<_r;++vr)dr[vr]=Ce.createCube(br);for(ur.color=Array(dr.length),vr=0;vr<dr.length;++vr)_r=dr[vr],pr=pr||_r.width,ur.color[vr]={target:34069,data:dr[vr]};for(vr=0;6>vr;++vr){for(_r=0;_r<dr.length;++_r)ur.color[_r].target=34069+vr;0<vr&&(ur.depth=or[0].depth,ur.stencil=or[0].stencil,ur.depthStencil=or[0].depthStencil),or[vr]?or[vr](ur):or[vr]=Qt(ur)}return j(Kt,{width:pr,height:pr,color:dr})}var or=Array(6);return Kt(Xt),j(Kt,{faces:or,resize:function(dr){var vr=0|dr;if(vr===Kt.width)return Kt;var ur=Kt.color;for(dr=0;dr<ur.length;++dr)ur[dr].resize(vr);for(dr=0;6>dr;++dr)or[dr].resize(vr);return Kt.width=Kt.height=vr,Kt},_reglType:"framebufferCube",destroy:function(){or.forEach(function(dr){dr.destroy()})}})},clear:function(){he(ir).forEach(Nt)},restore:function(){Ie.cur=null,Ie.next=null,Ie.dirty=!0,he(ir).forEach(function(Xt){Xt.framebuffer=Be.createFramebuffer(),Ut(Xt)})}})}function L(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function M(Be,Ke,_e,Ce,Le,Pe,Xe){function ht(){this.id=++Lt,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var xt=Ke.oes_vertex_array_object;this.vao=xt?xt.createVertexArrayOES():null,vt[this.id]=this,this.buffers=[]}var Mt=_e.maxAttributes,pt=Array(Mt);for(_e=0;_e<Mt;++_e)pt[_e]=new L;var Lt=0,vt={},Dt={Record:L,scope:{},state:pt,currentVAO:null,targetVAO:null,restore:Ke.oes_vertex_array_object?function(){Ke.oes_vertex_array_object&&he(vt).forEach(function(xt){xt.refresh()})}:function(){},createVAO:function(xt){function it(Nt){var Ut;Array.isArray(Nt)?(Ut=Nt,St.elements&&St.ownsElements&&St.elements.destroy(),St.elements=null,St.ownsElements=!1,St.offset=0,St.count=0,St.instances=-1,St.primitive=4):(Nt.elements?(Ut=Nt.elements,St.ownsElements?(typeof Ut=="function"&&Ut._reglType==="elements"?St.elements.destroy():St.elements(Ut),St.ownsElements=!1):Pe.getElements(Nt.elements)?(St.elements=Nt.elements,St.ownsElements=!1):(St.elements=Pe.create(Nt.elements),St.ownsElements=!0)):(St.elements=null,St.ownsElements=!1),Ut=Nt.attributes,St.offset=0,St.count=-1,St.instances=-1,St.primitive=4,St.elements&&(St.count=St.elements._elements.vertCount,St.primitive=St.elements._elements.primType),"offset"in Nt&&(St.offset=0|Nt.offset),"count"in Nt&&(St.count=0|Nt.count),"instances"in Nt&&(St.instances=0|Nt.instances),"primitive"in Nt&&(St.primitive=xe[Nt.primitive])),Nt={};var Qt=St.attributes;Qt.length=Ut.length;for(var Ie=0;Ie<Ut.length;++Ie){var lt,wt=Ut[Ie],Ot=Qt[Ie]=new L,Gt=wt.data||wt;Array.isArray(Gt)||ae(Gt)||u(Gt)?(St.buffers[Ie]&&(lt=St.buffers[Ie],ae(Gt)&&lt._buffer.byteLength>=Gt.byteLength?lt.subdata(Gt):(lt.destroy(),St.buffers[Ie]=null)),St.buffers[Ie]||(lt=St.buffers[Ie]=Le.create(wt,34962,!1,!0)),Ot.buffer=Le.getBuffer(lt),Ot.size=0|Ot.buffer.dimension,Ot.normalized=!1,Ot.type=Ot.buffer.dtype,Ot.offset=0,Ot.stride=0,Ot.divisor=0,Ot.state=1,Nt[Ie]=1):Le.getBuffer(wt)?(Ot.buffer=Le.getBuffer(wt),Ot.size=0|Ot.buffer.dimension,Ot.normalized=!1,Ot.type=Ot.buffer.dtype,Ot.offset=0,Ot.stride=0,Ot.divisor=0,Ot.state=1):Le.getBuffer(wt.buffer)?(Ot.buffer=Le.getBuffer(wt.buffer),Ot.size=0|(+wt.size||Ot.buffer.dimension),Ot.normalized=!!wt.normalized||!1,Ot.type="type"in wt?ue[wt.type]:Ot.buffer.dtype,Ot.offset=0|(wt.offset||0),Ot.stride=0|(wt.stride||0),Ot.divisor=0|(wt.divisor||0),Ot.state=1):"x"in wt&&(Ot.x=+wt.x||0,Ot.y=+wt.y||0,Ot.z=+wt.z||0,Ot.w=+wt.w||0,Ot.state=2)}for(lt=0;lt<St.buffers.length;++lt)!Nt[lt]&&St.buffers[lt]&&(St.buffers[lt].destroy(),St.buffers[lt]=null);return St.refresh(),it}var St=new ht;return Ce.vaoCount+=1,it.destroy=function(){for(var Nt=0;Nt<St.buffers.length;++Nt)St.buffers[Nt]&&St.buffers[Nt].destroy();St.buffers.length=0,St.ownsElements&&(St.elements.destroy(),St.elements=null,St.ownsElements=!1),St.destroy()},it._vao=St,it._reglType="vao",it(xt)},getVAO:function(xt){return typeof xt=="function"&&xt._vao?xt._vao:null},destroyBuffer:function(xt){for(var it=0;it<pt.length;++it){var St=pt[it];St.buffer===xt&&(Be.disableVertexAttribArray(it),St.buffer=null)}},setVAO:Ke.oes_vertex_array_object?function(xt){if(xt!==Dt.currentVAO){var it=Ke.oes_vertex_array_object;xt?it.bindVertexArrayOES(xt.vao):it.bindVertexArrayOES(null),Dt.currentVAO=xt}}:function(xt){if(xt!==Dt.currentVAO){if(xt)xt.bindAttrs();else{for(var it=Ke.angle_instanced_arrays,St=0;St<pt.length;++St){var Nt=pt[St];Nt.buffer?(Be.enableVertexAttribArray(St),Nt.buffer.bind(),Be.vertexAttribPointer(St,Nt.size,Nt.type,Nt.normalized,Nt.stride,Nt.offfset),it&&Nt.divisor&&it.vertexAttribDivisorANGLE(St,Nt.divisor)):(Be.disableVertexAttribArray(St),Be.vertexAttrib4f(St,Nt.x,Nt.y,Nt.z,Nt.w))}Xe.elements?Be.bindBuffer(34963,Xe.elements.buffer.buffer):Be.bindBuffer(34963,null)}Dt.currentVAO=xt}},clear:Ke.oes_vertex_array_object?function(){he(vt).forEach(function(xt){xt.destroy()})}:function(){}};return ht.prototype.bindAttrs=function(){for(var xt=Ke.angle_instanced_arrays,it=this.attributes,St=0;St<it.length;++St){var Nt=it[St];Nt.buffer?(Be.enableVertexAttribArray(St),Be.bindBuffer(34962,Nt.buffer.buffer),Be.vertexAttribPointer(St,Nt.size,Nt.type,Nt.normalized,Nt.stride,Nt.offset),xt&&Nt.divisor&&xt.vertexAttribDivisorANGLE(St,Nt.divisor)):(Be.disableVertexAttribArray(St),Be.vertexAttrib4f(St,Nt.x,Nt.y,Nt.z,Nt.w))}for(xt=it.length;xt<Mt;++xt)Be.disableVertexAttribArray(xt);(xt=Pe.getElements(this.elements))?Be.bindBuffer(34963,xt.buffer.buffer):Be.bindBuffer(34963,null)},ht.prototype.refresh=function(){var xt=Ke.oes_vertex_array_object;xt&&(xt.bindVertexArrayOES(this.vao),this.bindAttrs(),Dt.currentVAO=null,xt.bindVertexArrayOES(null))},ht.prototype.destroy=function(){if(this.vao){var xt=Ke.oes_vertex_array_object;this===Dt.currentVAO&&(Dt.currentVAO=null,xt.bindVertexArrayOES(null)),xt.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),vt[this.id]&&(delete vt[this.id],--Ce.vaoCount)},Dt}function P(Be,Ke,_e,Ce){function Le(it,St,Nt,Ut){this.name=it,this.id=St,this.location=Nt,this.info=Ut}function Pe(it,St){for(var Nt=0;Nt<it.length;++Nt)if(it[Nt].id===St.id)return void(it[Nt].location=St.location);it.push(St)}function Xe(it,St,Nt){if(!(Qt=(Nt=it===35632?pt:Lt)[St])){var Ut=Ke.str(St),Qt=Be.createShader(it);Be.shaderSource(Qt,Ut),Be.compileShader(Qt),Nt[St]=Qt}return Qt}function ht(it,St){this.id=xt++,this.fragId=it,this.vertId=St,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Ce.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Mt(it,St,Nt){var Ut;Ut=Xe(35632,it.fragId);var Qt=Xe(35633,it.vertId);if(St=it.program=Be.createProgram(),Be.attachShader(St,Ut),Be.attachShader(St,Qt),Nt)for(Ut=0;Ut<Nt.length;++Ut)Qt=Nt[Ut],Be.bindAttribLocation(St,Qt[0],Qt[1]);Be.linkProgram(St),Qt=Be.getProgramParameter(St,35718),Ce.profile&&(it.stats.uniformsCount=Qt);var Ie=it.uniforms;for(Ut=0;Ut<Qt;++Ut)if(Nt=Be.getActiveUniform(St,Ut)){if(1<Nt.size)for(var lt=0;lt<Nt.size;++lt){var wt=Nt.name.replace("[0]","["+lt+"]");Pe(Ie,new Le(wt,Ke.id(wt),Be.getUniformLocation(St,wt),Nt))}lt=Nt.name,1<Nt.size&&(lt=lt.replace("[0]","")),Pe(Ie,new Le(lt,Ke.id(lt),Be.getUniformLocation(St,lt),Nt))}for(Qt=Be.getProgramParameter(St,35721),Ce.profile&&(it.stats.attributesCount=Qt),it=it.attributes,Ut=0;Ut<Qt;++Ut)(Nt=Be.getActiveAttrib(St,Ut))&&Pe(it,new Le(Nt.name,Ke.id(Nt.name),Be.getAttribLocation(St,Nt.name),Nt))}var pt={},Lt={},vt={},Dt=[],xt=0;return Ce.profile&&(_e.getMaxUniformsCount=function(){var it=0;return Dt.forEach(function(St){St.stats.uniformsCount>it&&(it=St.stats.uniformsCount)}),it},_e.getMaxAttributesCount=function(){var it=0;return Dt.forEach(function(St){St.stats.attributesCount>it&&(it=St.stats.attributesCount)}),it}),{clear:function(){var it=Be.deleteShader.bind(Be);he(pt).forEach(it),pt={},he(Lt).forEach(it),Lt={},Dt.forEach(function(St){Be.deleteProgram(St.program)}),Dt.length=0,vt={},_e.shaderCount=0},program:function(it,St,Nt,Ut){var Qt=vt[St];Qt||(Qt=vt[St]={});var Ie=Qt[it];if(Ie&&(Ie.refCount++,!Ut))return Ie;var lt=new ht(St,it);return _e.shaderCount++,Mt(lt,Nt,Ut),Ie||(Qt[it]=lt),Dt.push(lt),j(lt,{destroy:function(){if(lt.refCount--,0>=lt.refCount){Be.deleteProgram(lt.program);var wt=Dt.indexOf(lt);Dt.splice(wt,1),_e.shaderCount--}0>=Qt[lt.vertId].refCount&&(Be.deleteShader(Lt[lt.vertId]),delete Lt[lt.vertId],delete vt[lt.fragId][lt.vertId]),Object.keys(vt[lt.fragId]).length||(Be.deleteShader(pt[lt.fragId]),delete pt[lt.fragId],delete vt[lt.fragId])}})},restore:function(){pt={},Lt={};for(var it=0;it<Dt.length;++it)Mt(Dt[it],null,Dt[it].attributes.map(function(St){return[St.location,St.name]}))},shader:Xe,frag:-1,vert:-1}}function D(Be,Ke,_e,Ce,Le,Pe,Xe){function ht(Mt){var pt;pt=Ke.next===null?5121:Ke.next.colorAttachments[0].texture._texture.type;var Lt=0,vt=0,Dt=Ce.framebufferWidth,xt=Ce.framebufferHeight,it=null;return ae(Mt)?it=Mt:Mt&&(Lt=0|Mt.x,vt=0|Mt.y,Dt=0|(Mt.width||Ce.framebufferWidth-Lt),xt=0|(Mt.height||Ce.framebufferHeight-vt),it=Mt.data||null),_e(),Mt=Dt*xt*4,it||(pt===5121?it=new Uint8Array(Mt):pt===5126&&(it=it||new Float32Array(Mt))),Be.pixelStorei(3333,4),Be.readPixels(Lt,vt,Dt,xt,6408,pt,it),it}return function(Mt){return Mt&&"framebuffer"in Mt?function(pt){var Lt;return Ke.setFBO({framebuffer:pt.framebuffer},function(){Lt=ht(pt)}),Lt}(Mt):ht(Mt)}}function N(Be){return Array.prototype.slice.call(Be)}function U(Be){return N(Be).join("")}function G(Be){return Array.isArray(Be)||ae(Be)||u(Be)}function X(Be){return Be.sort(function(Ke,_e){return Ke==="viewport"?-1:_e==="viewport"?1:Ke<_e?-1:1})}function K(Be,Ke,_e,Ce){this.thisDep=Be,this.contextDep=Ke,this.propDep=_e,this.append=Ce}function Z(Be){return Be&&!(Be.thisDep||Be.contextDep||Be.propDep)}function H(Be){return new K(!1,!1,!1,Be)}function Y(Be,Ke){var _e=Be.type;if(_e===0)return new K(!0,1<=(_e=Be.data.length),2<=_e,Ke);if(_e===4)return new K((_e=Be.data).thisDep,_e.contextDep,_e.propDep,Ke);if(_e===5)return new K(!1,!1,!1,Ke);if(_e===6){for(var Ce=_e=!1,Le=!1,Pe=0;Pe<Be.data.length;++Pe){var Xe=Be.data[Pe];Xe.type===1?Le=!0:Xe.type===2?Ce=!0:Xe.type===3?_e=!0:Xe.type===0?(_e=!0,1<=(Xe=Xe.data)&&(Ce=!0),2<=Xe&&(Le=!0)):Xe.type===4&&(_e=_e||Xe.data.thisDep,Ce=Ce||Xe.data.contextDep,Le=Le||Xe.data.propDep)}return new K(_e,Ce,Le,Ke)}return new K(_e===3,_e===2,_e===1,Ke)}function $(Be,Ke,_e,Ce,Le,Pe,Xe,ht,Mt,pt,Lt,vt,Dt,xt,it){function St(It){return It.replace(".","_")}function Nt(It,qt,fr){var Tr=St(It);Qr.push(It),tn[Tr]=en[Tr]=!!fr,rn[Tr]=qt}function Ut(It,qt,fr){var Tr=St(It);Qr.push(It),Array.isArray(fr)?(en[Tr]=fr.slice(),tn[Tr]=fr.slice()):en[Tr]=tn[Tr]=fr,An[Tr]=qt}function Qt(){var It=function(){function Mr(){var Dr=[],Wr=[];return j(function(){Dr.push.apply(Dr,N(arguments))},{def:function(){var vn="v"+qr++;return Wr.push(vn),0<arguments.length&&(Dr.push(vn,"="),Dr.push.apply(Dr,N(arguments)),Dr.push(";")),vn},toString:function(){return U([0<Wr.length?"var "+Wr.join(",")+";":"",U(Dr)])}})}function Ir(){function Dr(sa,Yn){vn(sa,Yn,"=",Wr.def(sa,Yn),";")}var Wr=Mr(),vn=Mr(),dn=Wr.toString,Pn=vn.toString;return j(function(){Wr.apply(Wr,N(arguments))},{def:Wr.def,entry:Wr,exit:vn,save:Dr,set:function(sa,Yn,yn){Dr(sa,Yn),Wr(sa,Yn,"=",yn,";")},toString:function(){return dn()+Pn()}})}var qr=0,cn=[],_n=[],Jr=Mr(),bn={};return{global:Jr,link:function(Dr){for(var Wr=0;Wr<_n.length;++Wr)if(_n[Wr]===Dr)return cn[Wr];return Wr="g"+qr++,cn.push(Wr),_n.push(Dr),Wr},block:Mr,proc:function(Dr,Wr){function vn(){var Yn="a"+dn.length;return dn.push(Yn),Yn}var dn=[];Wr=Wr||0;for(var Pn=0;Pn<Wr;++Pn)vn();var sa=(Pn=Ir()).toString;return bn[Dr]=j(Pn,{arg:vn,toString:function(){return U(["function(",dn.join(),"){",sa(),"}"])}})},scope:Ir,cond:function(){var Dr=U(arguments),Wr=Ir(),vn=Ir(),dn=Wr.toString,Pn=vn.toString;return j(Wr,{then:function(){return Wr.apply(Wr,N(arguments)),this},else:function(){return vn.apply(vn,N(arguments)),this},toString:function(){var sa=Pn();return sa&&(sa="else{"+sa+"}"),U(["if(",Dr,"){",dn(),"}",sa])}})},compile:function(){var Dr=['"use strict";',Jr,"return {"];Object.keys(bn).forEach(function(vn){Dr.push('"',vn,'":',bn[vn].toString(),",")}),Dr.push("}");var Wr=U(Dr).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`);return Function.apply(null,cn.concat(Wr)).apply(null,_n)}}}(),qt=It.link,fr=It.global;It.id=Jt++,It.batchId="0";var Tr=qt(En),Gr=It.shared={props:"a0"};Object.keys(En).forEach(function(Mr){Gr[Mr]=fr.def(Tr,".",Mr)});var Vr=It.next={},xr=It.current={};Object.keys(An).forEach(function(Mr){Array.isArray(en[Mr])&&(Vr[Mr]=fr.def(Gr.next,".",Mr),xr[Mr]=fr.def(Gr.current,".",Mr))});var wr=It.constants={};Object.keys(Bn).forEach(function(Mr){wr[Mr]=fr.def(JSON.stringify(Bn[Mr]))}),It.invoke=function(Mr,Ir){switch(Ir.type){case 0:var qr=["this",Gr.context,Gr.props,It.batchId];return Mr.def(qt(Ir.data),".call(",qr.slice(0,Math.max(Ir.data.length+1,4)),")");case 1:return Mr.def(Gr.props,Ir.data);case 2:return Mr.def(Gr.context,Ir.data);case 3:return Mr.def("this",Ir.data);case 4:return Ir.data.append(It,Mr),Ir.data.ref;case 5:return Ir.data.toString();case 6:return Ir.data.map(function(cn){return It.invoke(Mr,cn)})}},It.attribCache={};var Sr={};return It.scopeAttrib=function(Mr){if((Mr=Ke.id(Mr))in Sr)return Sr[Mr];var Ir=pt.scope[Mr];return Ir||(Ir=pt.scope[Mr]=new On),Sr[Mr]=qt(Ir)},It}function Ie(It,qt){var fr=It.static,Tr=It.dynamic;if("framebuffer"in fr){var Gr=fr.framebuffer;return Gr?(Gr=ht.getFramebuffer(Gr),H(function(xr,wr){var Sr=xr.link(Gr),Mr=xr.shared;return wr.set(Mr.framebuffer,".next",Sr),Mr=Mr.context,wr.set(Mr,".framebufferWidth",Sr+".width"),wr.set(Mr,".framebufferHeight",Sr+".height"),Sr})):H(function(xr,wr){var Sr=xr.shared;return wr.set(Sr.framebuffer,".next","null"),Sr=Sr.context,wr.set(Sr,".framebufferWidth",Sr+".drawingBufferWidth"),wr.set(Sr,".framebufferHeight",Sr+".drawingBufferHeight"),"null"})}if("framebuffer"in Tr){var Vr=Tr.framebuffer;return Y(Vr,function(xr,wr){var Sr=xr.invoke(wr,Vr),Mr=xr.shared,Ir=Mr.framebuffer;return Sr=wr.def(Ir,".getFramebuffer(",Sr,")"),wr.set(Ir,".next",Sr),Mr=Mr.context,wr.set(Mr,".framebufferWidth",Sr+"?"+Sr+".width:"+Mr+".drawingBufferWidth"),wr.set(Mr,".framebufferHeight",Sr+"?"+Sr+".height:"+Mr+".drawingBufferHeight"),Sr})}return null}function lt(It,qt,fr){function Tr(Mr){if(Mr in Gr){var Ir=Ke.id(Gr[Mr]);return(Mr=H(function(){return Ir})).id=Ir,Mr}if(Mr in Vr){var qr=Vr[Mr];return Y(qr,function(cn,_n){var Jr=cn.invoke(_n,qr);return _n.def(cn.shared.strings,".id(",Jr,")")})}return null}var Gr=It.static,Vr=It.dynamic,xr=Tr("frag"),wr=Tr("vert"),Sr=null;return Z(xr)&&Z(wr)?(Sr=Lt.program(wr.id,xr.id,null,fr),It=H(function(Mr,Ir){return Mr.link(Sr)})):It=new K(xr&&xr.thisDep||wr&&wr.thisDep,xr&&xr.contextDep||wr&&wr.contextDep,xr&&xr.propDep||wr&&wr.propDep,function(Mr,Ir){var qr,cn,_n=Mr.shared.shader;return qr=xr?xr.append(Mr,Ir):Ir.def(_n,".","frag"),cn=wr?wr.append(Mr,Ir):Ir.def(_n,".","vert"),Ir.def(_n+".program("+cn+","+qr+")")}),{frag:xr,vert:wr,progVar:It,program:Sr}}function wt(It,qt){function fr(Jr,bn){if(Jr in Tr){var Dr=0|Tr[Jr];return bn?Vr.offset=Dr:Vr.instances=Dr,H(function(vn,dn){return bn&&(vn.OFFSET=Dr),Dr})}if(Jr in Gr){var Wr=Gr[Jr];return Y(Wr,function(vn,dn){var Pn=vn.invoke(dn,Wr);return bn&&(vn.OFFSET=Pn),Pn})}if(bn){if(Sr)return H(function(vn,dn){return vn.OFFSET=0});if(xr)return new K(wr.thisDep,wr.contextDep,wr.propDep,function(vn,dn){return dn.def(vn.shared.vao+".currentVAO?"+vn.shared.vao+".currentVAO.offset:0")})}else if(xr)return new K(wr.thisDep,wr.contextDep,wr.propDep,function(vn,dn){return dn.def(vn.shared.vao+".currentVAO?"+vn.shared.vao+".currentVAO.instances:-1")});return null}var Tr=It.static,Gr=It.dynamic,Vr={},xr=!1,wr=function(){if("vao"in Tr){var Jr=Tr.vao;return Jr!==null&&pt.getVAO(Jr)===null&&(Jr=pt.createVAO(Jr)),xr=!0,Vr.vao=Jr,H(function(Dr){var Wr=pt.getVAO(Jr);return Wr?Dr.link(Wr):"null"})}if("vao"in Gr){xr=!0;var bn=Gr.vao;return Y(bn,function(Dr,Wr){var vn=Dr.invoke(Wr,bn);return Wr.def(Dr.shared.vao+".getVAO("+vn+")")})}return null}(),Sr=!1,Mr=function(){if("elements"in Tr){var Jr=Tr.elements;if(Vr.elements=Jr,G(Jr)){var bn=Vr.elements=Pe.create(Jr,!0);Jr=Pe.getElements(bn),Sr=!0}else Jr&&(Jr=Pe.getElements(Jr),Sr=!0);return(bn=H(function(Wr,vn){if(Jr){var dn=Wr.link(Jr);return Wr.ELEMENTS=dn}return Wr.ELEMENTS=null})).value=Jr,bn}if("elements"in Gr){Sr=!0;var Dr=Gr.elements;return Y(Dr,function(Wr,vn){var dn=(Pn=Wr.shared).isBufferArgs,Pn=Pn.elements,sa=Wr.invoke(vn,Dr),Yn=vn.def("null");return dn=vn.def(dn,"(",sa,")"),sa=Wr.cond(dn).then(Yn,"=",Pn,".createStream(",sa,");").else(Yn,"=",Pn,".getElements(",sa,");"),vn.entry(sa),vn.exit(Wr.cond(dn).then(Pn,".destroyStream(",Yn,");")),Wr.ELEMENTS=Yn})}return xr?new K(wr.thisDep,wr.contextDep,wr.propDep,function(Wr,vn){return vn.def(Wr.shared.vao+".currentVAO?"+Wr.shared.elements+".getElements("+Wr.shared.vao+".currentVAO.elements):null")}):null}(),Ir=fr("offset",!0),qr=function(){if("primitive"in Tr){var Jr=Tr.primitive;return Vr.primitive=Jr,H(function(Dr,Wr){return xe[Jr]})}if("primitive"in Gr){var bn=Gr.primitive;return Y(bn,function(Dr,Wr){var vn=Dr.constants.primTypes,dn=Dr.invoke(Wr,bn);return Wr.def(vn,"[",dn,"]")})}return Sr?Z(Mr)?Mr.value?H(function(Dr,Wr){return Wr.def(Dr.ELEMENTS,".primType")}):H(function(){return 4}):new K(Mr.thisDep,Mr.contextDep,Mr.propDep,function(Dr,Wr){var vn=Dr.ELEMENTS;return Wr.def(vn,"?",vn,".primType:",4)}):xr?new K(wr.thisDep,wr.contextDep,wr.propDep,function(Dr,Wr){return Wr.def(Dr.shared.vao+".currentVAO?"+Dr.shared.vao+".currentVAO.primitive:4")}):null}(),cn=function(){if("count"in Tr){var Jr=0|Tr.count;return Vr.count=Jr,H(function(){return Jr})}if("count"in Gr){var bn=Gr.count;return Y(bn,function(Dr,Wr){return Dr.invoke(Wr,bn)})}return Sr?Z(Mr)?Mr?Ir?new K(Ir.thisDep,Ir.contextDep,Ir.propDep,function(Dr,Wr){return Wr.def(Dr.ELEMENTS,".vertCount-",Dr.OFFSET)}):H(function(Dr,Wr){return Wr.def(Dr.ELEMENTS,".vertCount")}):H(function(){return-1}):new K(Mr.thisDep||Ir.thisDep,Mr.contextDep||Ir.contextDep,Mr.propDep||Ir.propDep,function(Dr,Wr){var vn=Dr.ELEMENTS;return Dr.OFFSET?Wr.def(vn,"?",vn,".vertCount-",Dr.OFFSET,":-1"):Wr.def(vn,"?",vn,".vertCount:-1")}):xr?new K(wr.thisDep,wr.contextDep,wr.propDep,function(Dr,Wr){return Wr.def(Dr.shared.vao,".currentVAO?",Dr.shared.vao,".currentVAO.count:-1")}):null}(),_n=fr("instances",!1);return{elements:Mr,primitive:qr,count:cn,instances:_n,offset:Ir,vao:wr,vaoActive:xr,elementsActive:Sr,static:Vr}}function Ot(It,qt){var fr=It.static,Tr=It.dynamic,Gr={};return Object.keys(fr).forEach(function(Vr){var xr=fr[Vr],wr=Ke.id(Vr),Sr=new On;if(G(xr))Sr.state=1,Sr.buffer=Le.getBuffer(Le.create(xr,34962,!1,!0)),Sr.type=0;else if(Ir=Le.getBuffer(xr))Sr.state=1,Sr.buffer=Ir,Sr.type=0;else if("constant"in xr){var Mr=xr.constant;Sr.buffer="null",Sr.state=2,typeof Mr=="number"?Sr.x=Mr:at.forEach(function(Dr,Wr){Wr<Mr.length&&(Sr[Dr]=Mr[Wr])})}else{var Ir=G(xr.buffer)?Le.getBuffer(Le.create(xr.buffer,34962,!1,!0)):Le.getBuffer(xr.buffer),qr=0|xr.offset,cn=0|xr.stride,_n=0|xr.size,Jr=!!xr.normalized,bn=0;"type"in xr&&(bn=ue[xr.type]),xr=0|xr.divisor,Sr.buffer=Ir,Sr.state=1,Sr.size=_n,Sr.normalized=Jr,Sr.type=bn||Ir.dtype,Sr.offset=qr,Sr.stride=cn,Sr.divisor=xr}Gr[Vr]=H(function(Dr,Wr){var vn=Dr.attribCache;if(wr in vn)return vn[wr];var dn={isStream:!1};return Object.keys(Sr).forEach(function(Pn){dn[Pn]=Sr[Pn]}),Sr.buffer&&(dn.buffer=Dr.link(Sr.buffer),dn.type=dn.type||dn.buffer+".dtype"),vn[wr]=dn})}),Object.keys(Tr).forEach(function(Vr){var xr=Tr[Vr];Gr[Vr]=Y(xr,function(wr,Sr){function Mr(vn){Sr(Jr[vn],"=",Ir,".",vn,"|0;")}var Ir=wr.invoke(Sr,xr),qr=wr.shared,cn=wr.constants,_n=qr.isBufferArgs,Jr=(qr=qr.buffer,{isStream:Sr.def(!1)}),bn=new On;bn.state=1,Object.keys(bn).forEach(function(vn){Jr[vn]=Sr.def(""+bn[vn])});var Dr=Jr.buffer,Wr=Jr.type;return Sr("if(",_n,"(",Ir,")){",Jr.isStream,"=true;",Dr,"=",qr,".createStream(",34962,",",Ir,");",Wr,"=",Dr,".dtype;","}else{",Dr,"=",qr,".getBuffer(",Ir,");","if(",Dr,"){",Wr,"=",Dr,".dtype;",'}else if("constant" in ',Ir,"){",Jr.state,"=",2,";","if(typeof "+Ir+'.constant === "number"){',Jr[at[0]],"=",Ir,".constant;",at.slice(1).map(function(vn){return Jr[vn]}).join("="),"=0;","}else{",at.map(function(vn,dn){return Jr[vn]+"="+Ir+".constant.length>"+dn+"?"+Ir+".constant["+dn+"]:0;"}).join(""),"}}else{","if(",_n,"(",Ir,".buffer)){",Dr,"=",qr,".createStream(",34962,",",Ir,".buffer);","}else{",Dr,"=",qr,".getBuffer(",Ir,".buffer);","}",Wr,'="type" in ',Ir,"?",cn.glTypes,"[",Ir,".type]:",Dr,".dtype;",Jr.normalized,"=!!",Ir,".normalized;"),Mr("size"),Mr("offset"),Mr("stride"),Mr("divisor"),Sr("}}"),Sr.exit("if(",Jr.isStream,"){",qr,".destroyStream(",Dr,");","}"),Jr})}),Gr}function Gt(It,qt,fr,Tr,Gr){function Vr(bn){var Dr=wr[bn];Dr&&(Mr[bn]=Dr)}var xr=function(bn,Dr){if(typeof(Wr=bn.static).frag=="string"&&typeof Wr.vert=="string"){if(0<Object.keys(Dr.dynamic).length)return null;var Wr=Dr.static,vn=Object.keys(Wr);if(0<vn.length&&typeof Wr[vn[0]]=="number"){for(var dn=[],Pn=0;Pn<vn.length;++Pn)dn.push([0|Wr[vn[Pn]],vn[Pn]]);return dn}}return null}(It,qt),wr=function(bn,Dr,Wr){function vn(Yn){if(Yn in dn){var yn=dn[Yn];Yn=!0;var ra,pa,Qa=0|yn.x,Bi=0|yn.y;return"width"in yn?ra=0|yn.width:Yn=!1,"height"in yn?pa=0|yn.height:Yn=!1,new K(!Yn&&Dr&&Dr.thisDep,!Yn&&Dr&&Dr.contextDep,!Yn&&Dr&&Dr.propDep,function(Ai,Ea){var Ga=Ai.shared.context,ko=ra;"width"in yn||(ko=Ea.def(Ga,".","framebufferWidth","-",Qa));var Qo=pa;return"height"in yn||(Qo=Ea.def(Ga,".","framebufferHeight","-",Bi)),[Qa,Bi,ko,Qo]})}if(Yn in Pn){var li=Pn[Yn];return Yn=Y(li,function(Ai,Ea){var Ga=Ai.invoke(Ea,li),ko=Ai.shared.context,Qo=Ea.def(Ga,".x|0"),us=Ea.def(Ga,".y|0");return[Qo,us,Ea.def('"width" in ',Ga,"?",Ga,".width|0:","(",ko,".","framebufferWidth","-",Qo,")"),Ga=Ea.def('"height" in ',Ga,"?",Ga,".height|0:","(",ko,".","framebufferHeight","-",us,")")]}),Dr&&(Yn.thisDep=Yn.thisDep||Dr.thisDep,Yn.contextDep=Yn.contextDep||Dr.contextDep,Yn.propDep=Yn.propDep||Dr.propDep),Yn}return Dr?new K(Dr.thisDep,Dr.contextDep,Dr.propDep,function(Ai,Ea){var Ga=Ai.shared.context;return[0,0,Ea.def(Ga,".","framebufferWidth"),Ea.def(Ga,".","framebufferHeight")]}):null}var dn=bn.static,Pn=bn.dynamic;if(bn=vn("viewport")){var sa=bn;bn=new K(bn.thisDep,bn.contextDep,bn.propDep,function(Yn,yn){var ra=sa.append(Yn,yn),pa=Yn.shared.context;return yn.set(pa,".viewportWidth",ra[2]),yn.set(pa,".viewportHeight",ra[3]),ra})}return{viewport:bn,scissor_box:vn("scissor.box")}}(It,qr=Ie(It)),Sr=wt(It),Mr=function(bn,Dr){var Wr=bn.static,vn=bn.dynamic,dn={};return Qr.forEach(function(Pn){function sa(yn,ra){if(Pn in Wr){var pa=yn(Wr[Pn]);dn[Yn]=H(function(){return pa})}else if(Pn in vn){var Qa=vn[Pn];dn[Yn]=Y(Qa,function(Bi,li){return ra(Bi,li,Bi.invoke(li,Qa))})}}var Yn=St(Pn);switch(Pn){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return sa(function(yn){return yn},function(yn,ra,pa){return pa});case"depth.func":return sa(function(yn){return er[yn]},function(yn,ra,pa){return ra.def(yn.constants.compareFuncs,"[",pa,"]")});case"depth.range":return sa(function(yn){return yn},function(yn,ra,pa){return[ra.def("+",pa,"[0]"),ra=ra.def("+",pa,"[1]")]});case"blend.func":return sa(function(yn){return[_t["srcRGB"in yn?yn.srcRGB:yn.src],_t["dstRGB"in yn?yn.dstRGB:yn.dst],_t["srcAlpha"in yn?yn.srcAlpha:yn.src],_t["dstAlpha"in yn?yn.dstAlpha:yn.dst]]},function(yn,ra,pa){function Qa(Ea,Ga){return ra.def('"',Ea,Ga,'" in ',pa,"?",pa,".",Ea,Ga,":",pa,".",Ea)}yn=yn.constants.blendFuncs;var Bi=Qa("src","RGB"),li=Qa("dst","RGB"),Ai=(Bi=ra.def(yn,"[",Bi,"]"),ra.def(yn,"[",Qa("src","Alpha"),"]"));return[Bi,li=ra.def(yn,"[",li,"]"),Ai,yn=ra.def(yn,"[",Qa("dst","Alpha"),"]")]});case"blend.equation":return sa(function(yn){return typeof yn=="string"?[Sn[yn],Sn[yn]]:typeof yn=="object"?[Sn[yn.rgb],Sn[yn.alpha]]:void 0},function(yn,ra,pa){var Qa=yn.constants.blendEquations,Bi=ra.def(),li=ra.def();return(yn=yn.cond("typeof ",pa,'==="string"')).then(Bi,"=",li,"=",Qa,"[",pa,"];"),yn.else(Bi,"=",Qa,"[",pa,".rgb];",li,"=",Qa,"[",pa,".alpha];"),ra(yn),[Bi,li]});case"blend.color":return sa(function(yn){return f(4,function(ra){return+yn[ra]})},function(yn,ra,pa){return f(4,function(Qa){return ra.def("+",pa,"[",Qa,"]")})});case"stencil.mask":return sa(function(yn){return 0|yn},function(yn,ra,pa){return ra.def(pa,"|0")});case"stencil.func":return sa(function(yn){return[er[yn.cmp||"keep"],yn.ref||0,"mask"in yn?yn.mask:-1]},function(yn,ra,pa){return[yn=ra.def('"cmp" in ',pa,"?",yn.constants.compareFuncs,"[",pa,".cmp]",":",7680),ra.def(pa,".ref|0"),ra=ra.def('"mask" in ',pa,"?",pa,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return sa(function(yn){return[Pn==="stencil.opBack"?1029:1028,tr[yn.fail||"keep"],tr[yn.zfail||"keep"],tr[yn.zpass||"keep"]]},function(yn,ra,pa){function Qa(li){return ra.def('"',li,'" in ',pa,"?",Bi,"[",pa,".",li,"]:",7680)}var Bi=yn.constants.stencilOps;return[Pn==="stencil.opBack"?1029:1028,Qa("fail"),Qa("zfail"),Qa("zpass")]});case"polygonOffset.offset":return sa(function(yn){return[0|yn.factor,0|yn.units]},function(yn,ra,pa){return[ra.def(pa,".factor|0"),ra=ra.def(pa,".units|0")]});case"cull.face":return sa(function(yn){var ra=0;return yn==="front"?ra=1028:yn==="back"&&(ra=1029),ra},function(yn,ra,pa){return ra.def(pa,'==="front"?',1028,":",1029)});case"lineWidth":return sa(function(yn){return yn},function(yn,ra,pa){return pa});case"frontFace":return sa(function(yn){return Ue[yn]},function(yn,ra,pa){return ra.def(pa+'==="cw"?2304:2305')});case"colorMask":return sa(function(yn){return yn.map(function(ra){return!!ra})},function(yn,ra,pa){return f(4,function(Qa){return"!!"+pa+"["+Qa+"]"})});case"sample.coverage":return sa(function(yn){return["value"in yn?yn.value:1,!!yn.invert]},function(yn,ra,pa){return[ra.def('"value" in ',pa,"?+",pa,".value:1"),ra=ra.def("!!",pa,".invert")]})}}),dn}(It),Ir=lt(It,0,xr);Vr("viewport"),Vr(St("scissor.box"));var qr,cn=0<Object.keys(Mr).length;if((qr={framebuffer:qr,draw:Sr,shader:Ir,state:Mr,dirty:cn,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}}).profile=function(bn){var Dr,Wr=bn.static;if(bn=bn.dynamic,"profile"in Wr){var vn=!!Wr.profile;(Dr=H(function(Pn,sa){return vn})).enable=vn}else if("profile"in bn){var dn=bn.profile;Dr=Y(dn,function(Pn,sa){return Pn.invoke(sa,dn)})}return Dr}(It),qr.uniforms=function(bn,Dr){var Wr=bn.static,vn=bn.dynamic,dn={};return Object.keys(Wr).forEach(function(Pn){var sa,Yn=Wr[Pn];if(typeof Yn=="number"||typeof Yn=="boolean")sa=H(function(){return Yn});else if(typeof Yn=="function"){var yn=Yn._reglType;yn==="texture2d"||yn==="textureCube"?sa=H(function(ra){return ra.link(Yn)}):yn!=="framebuffer"&&yn!=="framebufferCube"||(sa=H(function(ra){return ra.link(Yn.color[0])}))}else y(Yn)&&(sa=H(function(ra){return ra.global.def("[",f(Yn.length,function(pa){return Yn[pa]}),"]")}));sa.value=Yn,dn[Pn]=sa}),Object.keys(vn).forEach(function(Pn){var sa=vn[Pn];dn[Pn]=Y(sa,function(Yn,yn){return Yn.invoke(yn,sa)})}),dn}(fr),qr.drawVAO=qr.scopeVAO=Sr.vao,!qr.drawVAO&&Ir.program&&!xr&&_e.angle_instanced_arrays&&Sr.static.elements){var _n=!0;if(It=Ir.program.attributes.map(function(bn){return bn=qt.static[bn],_n=_n&&!!bn,bn}),_n&&0<It.length){var Jr=pt.getVAO(pt.createVAO({attributes:It,elements:Sr.static.elements}));qr.drawVAO=new K(null,null,null,function(bn,Dr){return bn.link(Jr)}),qr.useVAO=!0}}return xr?qr.useVAO=!0:qr.attributes=Ot(qt),qr.context=function(bn){var Dr=bn.static,Wr=bn.dynamic,vn={};return Object.keys(Dr).forEach(function(dn){var Pn=Dr[dn];vn[dn]=H(function(sa,Yn){return typeof Pn=="number"||typeof Pn=="boolean"?""+Pn:sa.link(Pn)})}),Object.keys(Wr).forEach(function(dn){var Pn=Wr[dn];vn[dn]=Y(Pn,function(sa,Yn){return sa.invoke(Yn,Pn)})}),vn}(Tr),qr}function ir(It,qt,fr){var Tr=It.shared.context,Gr=It.scope();Object.keys(fr).forEach(function(Vr){qt.save(Tr,"."+Vr);var xr=fr[Vr].append(It,qt);Array.isArray(xr)?Gr(Tr,".",Vr,"=[",xr.join(),"];"):Gr(Tr,".",Vr,"=",xr,";")}),qt(Gr)}function Xt(It,qt,fr,Tr){var Gr,Vr=(wr=It.shared).gl,xr=wr.framebuffer;Nr&&(Gr=qt.def(wr.extensions,".webgl_draw_buffers"));var wr=(Sr=It.constants).drawBuffer,Sr=Sr.backBuffer;It=fr?fr.append(It,qt):qt.def(xr,".next"),Tr||qt("if(",It,"!==",xr,".cur){"),qt("if(",It,"){",Vr,".bindFramebuffer(",36160,",",It,".framebuffer);"),Nr&&qt(Gr,".drawBuffersWEBGL(",wr,"[",It,".colorAttachments.length]);"),qt("}else{",Vr,".bindFramebuffer(",36160,",null);"),Nr&&qt(Gr,".drawBuffersWEBGL(",Sr,");"),qt("}",xr,".cur=",It,";"),Tr||qt("}")}function Kt(It,qt,fr){var Tr=It.shared,Gr=Tr.gl,Vr=It.current,xr=It.next,wr=Tr.current,Sr=Tr.next,Mr=It.cond(wr,".dirty");Qr.forEach(function(Ir){var qr,cn;if(!((Ir=St(Ir))in fr.state))if(Ir in xr){qr=xr[Ir],cn=Vr[Ir];var _n=f(en[Ir].length,function(Jr){return Mr.def(qr,"[",Jr,"]")});Mr(It.cond(_n.map(function(Jr,bn){return Jr+"!=="+cn+"["+bn+"]"}).join("||")).then(Gr,".",An[Ir],"(",_n,");",_n.map(function(Jr,bn){return cn+"["+bn+"]="+Jr}).join(";"),";"))}else qr=Mr.def(Sr,".",Ir),_n=It.cond(qr,"!==",wr,".",Ir),Mr(_n),Ir in rn?_n(It.cond(qr).then(Gr,".enable(",rn[Ir],");").else(Gr,".disable(",rn[Ir],");"),wr,".",Ir,"=",qr,";"):_n(Gr,".",An[Ir],"(",qr,");",wr,".",Ir,"=",qr,";")}),Object.keys(fr.state).length===0&&Mr(wr,".dirty=false;"),qt(Mr)}function or(It,qt,fr,Tr){var Gr=It.shared,Vr=It.current,xr=Gr.current,wr=Gr.gl;X(Object.keys(fr)).forEach(function(Sr){var Mr=fr[Sr];if(!Tr||Tr(Mr)){var Ir=Mr.append(It,qt);if(rn[Sr]){var qr=rn[Sr];Z(Mr)?qt(wr,Ir?".enable(":".disable(",qr,");"):qt(It.cond(Ir).then(wr,".enable(",qr,");").else(wr,".disable(",qr,");")),qt(xr,".",Sr,"=",Ir,";")}else if(y(Ir)){var cn=Vr[Sr];qt(wr,".",An[Sr],"(",Ir,");",Ir.map(function(_n,Jr){return cn+"["+Jr+"]="+_n}).join(";"),";")}else qt(wr,".",An[Sr],"(",Ir,");",xr,".",Sr,"=",Ir,";")}})}function dr(It,qt){an&&(It.instancing=qt.def(It.shared.extensions,".angle_instanced_arrays"))}function vr(It,qt,fr,Tr,Gr){function Vr(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}function xr(bn){bn(Mr=qt.def(),"=",Vr(),";"),typeof Gr=="string"?bn(cn,".count+=",Gr,";"):bn(cn,".count++;"),xt&&(Tr?bn(Ir=qt.def(),"=",Jr,".getNumPendingQueries();"):bn(Jr,".beginQuery(",cn,");"))}function wr(bn){bn(cn,".cpuTime+=",Vr(),"-",Mr,";"),xt&&(Tr?bn(Jr,".pushScopeStats(",Ir,",",Jr,".getNumPendingQueries(),",cn,");"):bn(Jr,".endQuery();"))}function Sr(bn){var Dr=qt.def(_n,".profile");qt(_n,".profile=",bn,";"),qt.exit(_n,".profile=",Dr,";")}var Mr,Ir,qr=It.shared,cn=It.stats,_n=qr.current,Jr=qr.timer;if(fr=fr.profile){if(Z(fr))return void(fr.enable?(xr(qt),wr(qt.exit),Sr("true")):Sr("false"));Sr(fr=fr.append(It,qt))}else fr=qt.def(_n,".profile");xr(qr=It.block()),qt("if(",fr,"){",qr,"}"),wr(It=It.block()),qt.exit("if(",fr,"){",It,"}")}function ur(It,qt,fr,Tr,Gr){function Vr(wr,Sr,Mr){function Ir(){qt("if(!",Jr,".buffer){",cn,".enableVertexAttribArray(",_n,");}");var vn,dn=Mr.type;vn=Mr.size?qt.def(Mr.size,"||",Sr):Sr,qt("if(",Jr,".type!==",dn,"||",Jr,".size!==",vn,"||",Wr.map(function(Pn){return Jr+"."+Pn+"!=="+Mr[Pn]}).join("||"),"){",cn,".bindBuffer(",34962,",",bn,".buffer);",cn,".vertexAttribPointer(",[_n,vn,dn,Mr.normalized,Mr.stride,Mr.offset],");",Jr,".type=",dn,";",Jr,".size=",vn,";",Wr.map(function(Pn){return Jr+"."+Pn+"="+Mr[Pn]+";"}).join(""),"}"),an&&(dn=Mr.divisor,qt("if(",Jr,".divisor!==",dn,"){",It.instancing,".vertexAttribDivisorANGLE(",[_n,dn],");",Jr,".divisor=",dn,";}"))}function qr(){qt("if(",Jr,".buffer){",cn,".disableVertexAttribArray(",_n,");",Jr,".buffer=null;","}if(",at.map(function(vn,dn){return Jr+"."+vn+"!=="+Dr[dn]}).join("||"),"){",cn,".vertexAttrib4f(",_n,",",Dr,");",at.map(function(vn,dn){return Jr+"."+vn+"="+Dr[dn]+";"}).join(""),"}")}var cn=xr.gl,_n=qt.def(wr,".location"),Jr=qt.def(xr.attributes,"[",_n,"]");wr=Mr.state;var bn=Mr.buffer,Dr=[Mr.x,Mr.y,Mr.z,Mr.w],Wr=["buffer","normalized","offset","stride"];wr===1?Ir():wr===2?qr():(qt("if(",wr,"===",1,"){"),Ir(),qt("}else{"),qr(),qt("}"))}var xr=It.shared;Tr.forEach(function(wr){var Sr,Mr=wr.name,Ir=fr.attributes[Mr];if(Ir){if(!Gr(Ir))return;Sr=Ir.append(It,qt)}else{if(!Gr(He))return;var qr=It.scopeAttrib(Mr);Sr={},Object.keys(new On).forEach(function(cn){Sr[cn]=qt.def(qr,".",cn)})}Vr(It.link(wr),function(cn){switch(cn){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(wr.info.type),Sr)})}function pr(It,qt,fr,Tr,Gr,Vr){for(var xr,wr=It.shared,Sr=wr.gl,Mr={},Ir=0;Ir<Tr.length;++Ir){var qr=(Wr=Tr[Ir]).name,cn=Wr.info.type,_n=Wr.info.size,Jr=fr.uniforms[qr];if(1<_n){if(!Jr)continue;var bn=qr.replace("[0]","");if(Mr[bn])continue;Mr[bn]=1}var Dr,Wr=It.link(Wr)+".location";if(Jr){if(!Gr(Jr))continue;if(Z(Jr)){if(qr=Jr.value,cn===35678||cn===35680)qt(Sr,".uniform1i(",Wr,",",(cn=It.link(qr._texture||qr.color[0]._texture))+".bind());"),qt.exit(cn,".unbind();");else if(cn===35674||cn===35675||cn===35676)_n=It.global.def("new Float32Array(["+Array.prototype.slice.call(qr)+"])"),qr=2,cn===35675?qr=3:cn===35676&&(qr=4),qt(Sr,".uniformMatrix",qr,"fv(",Wr,",false,",_n,");");else{switch(cn){case 5126:xr="1f";break;case 35664:xr="2f";break;case 35665:xr="3f";break;case 35666:xr="4f";break;case 35670:case 5124:xr="1i";break;case 35671:case 35667:xr="2i";break;case 35672:case 35668:xr="3i";break;case 35673:xr="4i";break;case 35669:xr="4i"}1<_n?(xr+="v",qr=It.global.def("["+Array.prototype.slice.call(qr)+"]")):qr=y(qr)?Array.prototype.slice.call(qr):qr,qt(Sr,".uniform",xr,"(",Wr,",",qr,");")}continue}Dr=Jr.append(It,qt)}else{if(!Gr(He))continue;Dr=qt.def(wr.uniforms,"[",Ke.id(qr),"]")}switch(cn===35678?qt("if(",Dr,"&&",Dr,'._reglType==="framebuffer"){',Dr,"=",Dr,".color[0];","}"):cn===35680&&qt("if(",Dr,"&&",Dr,'._reglType==="framebufferCube"){',Dr,"=",Dr,".color[0];","}"),qr=1,cn){case 35678:case 35680:cn=qt.def(Dr,"._texture"),qt(Sr,".uniform1i(",Wr,",",cn,".bind());"),qt.exit(cn,".unbind();");continue;case 5124:case 35670:xr="1i";break;case 35667:case 35671:xr="2i",qr=2;break;case 35668:case 35672:xr="3i",qr=3;break;case 35669:case 35673:xr="4i",qr=4;break;case 5126:xr="1f";break;case 35664:xr="2f",qr=2;break;case 35665:xr="3f",qr=3;break;case 35666:xr="4f",qr=4;break;case 35674:xr="Matrix2fv";break;case 35675:xr="Matrix3fv";break;case 35676:xr="Matrix4fv"}if(xr.indexOf("Matrix")===-1&&1<_n&&(xr+="v",qr=1),xr.charAt(0)==="M"){qt(Sr,".uniform",xr,"(",Wr,","),Wr=Math.pow(cn-35674+2,2);var vn=It.global.def("new Float32Array(",Wr,")");Array.isArray(Dr)?qt("false,(",f(Wr,function(Pn){return vn+"["+Pn+"]="+Dr[Pn]}),",",vn,")"):qt("false,(Array.isArray(",Dr,")||",Dr," instanceof Float32Array)?",Dr,":(",f(Wr,function(Pn){return vn+"["+Pn+"]="+Dr+"["+Pn+"]"}),",",vn,")"),qt(");")}else{if(1<qr){cn=[];var dn=[];for(_n=0;_n<qr;++_n)Array.isArray(Dr)?dn.push(Dr[_n]):dn.push(qt.def(Dr+"["+_n+"]")),Vr&&cn.push(qt.def());Vr&&qt("if(!",It.batchId,"||",cn.map(function(Pn,sa){return Pn+"!=="+dn[sa]}).join("||"),"){",cn.map(function(Pn,sa){return Pn+"="+dn[sa]+";"}).join("")),qt(Sr,".uniform",xr,"(",Wr,",",dn.join(","),");")}else Vr&&(cn=qt.def(),qt("if(!",It.batchId,"||",cn,"!==",Dr,"){",cn,"=",Dr,";")),qt(Sr,".uniform",xr,"(",Wr,",",Dr,");");Vr&&qt("}")}}}function br(It,qt,fr,Tr){function Gr(dn){var Pn=cn[dn];return Pn?Pn.contextDep&&Tr.contextDynamic||Pn.propDep?Pn.append(It,fr):Pn.append(It,qt):qt.def(qr,".",dn)}function Vr(){function dn(){fr(Sr,".drawElementsInstancedANGLE(",[Jr,Dr,Wr,bn+"<<(("+Wr+"-5121)>>1)",wr],");")}function Pn(){fr(Sr,".drawArraysInstancedANGLE(",[Jr,bn,Dr,wr],");")}_n&&_n!=="null"?vn?dn():(fr("if(",_n,"){"),dn(),fr("}else{"),Pn(),fr("}")):Pn()}function xr(){function dn(){fr(Ir+".drawElements("+[Jr,Dr,Wr,bn+"<<(("+Wr+"-5121)>>1)"]+");")}function Pn(){fr(Ir+".drawArrays("+[Jr,bn,Dr]+");")}_n&&_n!=="null"?vn?dn():(fr("if(",_n,"){"),dn(),fr("}else{"),Pn(),fr("}")):Pn()}var wr,Sr,Mr=It.shared,Ir=Mr.gl,qr=Mr.draw,cn=Tr.draw,_n=function(){var dn=cn.elements,Pn=qt;return dn?((dn.contextDep&&Tr.contextDynamic||dn.propDep)&&(Pn=fr),dn=dn.append(It,Pn),cn.elementsActive&&Pn("if("+dn+")"+Ir+".bindBuffer(34963,"+dn+".buffer.buffer);")):(dn=Pn.def(),Pn(dn,"=",qr,".","elements",";","if(",dn,"){",Ir,".bindBuffer(",34963,",",dn,".buffer.buffer);}","else if(",Mr.vao,".currentVAO){",dn,"=",It.shared.elements+".getElements("+Mr.vao,".currentVAO.elements);",Pr?"":"if("+dn+")"+Ir+".bindBuffer(34963,"+dn+".buffer.buffer);","}")),dn}(),Jr=Gr("primitive"),bn=Gr("offset"),Dr=function(){var dn=cn.count,Pn=qt;return dn?((dn.contextDep&&Tr.contextDynamic||dn.propDep)&&(Pn=fr),dn=dn.append(It,Pn)):dn=Pn.def(qr,".","count"),dn}();if(typeof Dr=="number"){if(Dr===0)return}else fr("if(",Dr,"){"),fr.exit("}");an&&(wr=Gr("instances"),Sr=It.instancing);var Wr=_n+".type",vn=cn.elements&&Z(cn.elements)&&!cn.vaoActive;an&&(typeof wr!="number"||0<=wr)?typeof wr=="string"?(fr("if(",wr,">0){"),Vr(),fr("}else if(",wr,"<0){"),xr(),fr("}")):Vr():xr()}function Rr(It,qt,fr,Tr,Gr){return Gr=(qt=Qt()).proc("body",Gr),an&&(qt.instancing=Gr.def(qt.shared.extensions,".angle_instanced_arrays")),It(qt,Gr,fr,Tr),qt.compile().body}function _r(It,qt,fr,Tr){dr(It,qt),fr.useVAO?fr.drawVAO?qt(It.shared.vao,".setVAO(",fr.drawVAO.append(It,qt),");"):qt(It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"):(qt(It.shared.vao,".setVAO(null);"),ur(It,qt,fr,Tr.attributes,function(){return!0})),pr(It,qt,fr,Tr.uniforms,function(){return!0},!1),br(It,qt,qt,fr)}function jr(It,qt,fr,Tr){function Gr(){return!0}It.batchId="a1",dr(It,qt),ur(It,qt,fr,Tr.attributes,Gr),pr(It,qt,fr,Tr.uniforms,Gr,!1),br(It,qt,qt,fr)}function $r(It,qt,fr,Tr){function Gr(qr){return qr.contextDep&&xr||qr.propDep}function Vr(qr){return!Gr(qr)}dr(It,qt);var xr=fr.contextDep,wr=qt.def(),Sr=qt.def();It.shared.props=Sr,It.batchId=wr;var Mr=It.scope(),Ir=It.scope();qt(Mr.entry,"for(",wr,"=0;",wr,"<","a1",";++",wr,"){",Sr,"=","a0","[",wr,"];",Ir,"}",Mr.exit),fr.needsContext&&ir(It,Ir,fr.context),fr.needsFramebuffer&&Xt(It,Ir,fr.framebuffer),or(It,Ir,fr.state,Gr),fr.profile&&Gr(fr.profile)&&vr(It,Ir,fr,!1,!0),Tr?(fr.useVAO?fr.drawVAO?Gr(fr.drawVAO)?Ir(It.shared.vao,".setVAO(",fr.drawVAO.append(It,Ir),");"):Mr(It.shared.vao,".setVAO(",fr.drawVAO.append(It,Mr),");"):Mr(It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"):(Mr(It.shared.vao,".setVAO(null);"),ur(It,Mr,fr,Tr.attributes,Vr),ur(It,Ir,fr,Tr.attributes,Gr)),pr(It,Mr,fr,Tr.uniforms,Vr,!1),pr(It,Ir,fr,Tr.uniforms,Gr,!0),br(It,Mr,Ir,fr)):(qt=It.global.def("{}"),Tr=fr.shader.progVar.append(It,Ir),Sr=Ir.def(Tr,".id"),Mr=Ir.def(qt,"[",Sr,"]"),Ir(It.shared.gl,".useProgram(",Tr,".program);","if(!",Mr,"){",Mr,"=",qt,"[",Sr,"]=",It.link(function(qr){return Rr(jr,It,fr,qr,2)}),"(",Tr,");}",Mr,".call(this,a0[",wr,"],",wr,");"))}function pn(It,qt){function fr(xr){var wr=qt.shader[xr];wr&&Tr.set(Gr.shader,"."+xr,wr.append(It,Tr))}var Tr=It.proc("scope",3);It.batchId="a2";var Gr=It.shared,Vr=Gr.current;ir(It,Tr,qt.context),qt.framebuffer&&qt.framebuffer.append(It,Tr),X(Object.keys(qt.state)).forEach(function(xr){var wr=qt.state[xr].append(It,Tr);y(wr)?wr.forEach(function(Sr,Mr){Tr.set(It.next[xr],"["+Mr+"]",Sr)}):Tr.set(Gr.next,"."+xr,wr)}),vr(It,Tr,qt,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(xr){var wr=qt.draw[xr];wr&&Tr.set(Gr.draw,"."+xr,""+wr.append(It,Tr))}),Object.keys(qt.uniforms).forEach(function(xr){var wr=qt.uniforms[xr].append(It,Tr);Array.isArray(wr)&&(wr="["+wr.join()+"]"),Tr.set(Gr.uniforms,"["+Ke.id(xr)+"]",wr)}),Object.keys(qt.attributes).forEach(function(xr){var wr=qt.attributes[xr].append(It,Tr),Sr=It.scopeAttrib(xr);Object.keys(new On).forEach(function(Mr){Tr.set(Sr,"."+Mr,wr[Mr])})}),qt.scopeVAO&&Tr.set(Gr.vao,".targetVAO",qt.scopeVAO.append(It,Tr)),fr("vert"),fr("frag"),0<Object.keys(qt.state).length&&(Tr(Vr,".dirty=true;"),Tr.exit(Vr,".dirty=true;")),Tr("a1(",It.shared.context,",a0,",It.batchId,");")}function In(It,qt,fr){var Tr=qt.static[fr];if(Tr&&function(Ir){if(typeof Ir=="object"&&!y(Ir)){for(var qr=Object.keys(Ir),cn=0;cn<qr.length;++cn)if(ee.isDynamic(Ir[qr[cn]]))return!0;return!1}}(Tr)){var Gr=It.global,Vr=Object.keys(Tr),xr=!1,wr=!1,Sr=!1,Mr=It.global.def("{}");Vr.forEach(function(Ir){var qr=Tr[Ir];if(ee.isDynamic(qr))typeof qr=="function"&&(qr=Tr[Ir]=ee.unbox(qr)),Ir=Y(qr,null),xr=xr||Ir.thisDep,Sr=Sr||Ir.propDep,wr=wr||Ir.contextDep;else{switch(Gr(Mr,".",Ir,"="),typeof qr){case"number":Gr(qr);break;case"string":Gr('"',qr,'"');break;case"object":Array.isArray(qr)&&Gr("[",qr.join(),"]");break;default:Gr(It.link(qr))}Gr(";")}}),qt.dynamic[fr]=new ee.DynamicVariable(4,{thisDep:xr,contextDep:wr,propDep:Sr,ref:Mr,append:function(Ir,qr){Vr.forEach(function(cn){var _n=Tr[cn];ee.isDynamic(_n)&&(_n=Ir.invoke(qr,_n),qr(Mr,".",cn,"=",_n,";"))})}}),delete qt.static[fr]}}var On=pt.Record,Sn={add:32774,subtract:32778,"reverse subtract":32779};_e.ext_blend_minmax&&(Sn.min=32775,Sn.max=32776);var an=_e.angle_instanced_arrays,Nr=_e.webgl_draw_buffers,Pr=_e.oes_vertex_array_object,en={dirty:!0,profile:it.profile},tn={},Qr=[],rn={},An={};Nt("dither",3024),Nt("blend.enable",3042),Ut("blend.color","blendColor",[0,0,0,0]),Ut("blend.equation","blendEquationSeparate",[32774,32774]),Ut("blend.func","blendFuncSeparate",[1,0,1,0]),Nt("depth.enable",2929,!0),Ut("depth.func","depthFunc",513),Ut("depth.range","depthRange",[0,1]),Ut("depth.mask","depthMask",!0),Ut("colorMask","colorMask",[!0,!0,!0,!0]),Nt("cull.enable",2884),Ut("cull.face","cullFace",1029),Ut("frontFace","frontFace",2305),Ut("lineWidth","lineWidth",1),Nt("polygonOffset.enable",32823),Ut("polygonOffset.offset","polygonOffset",[0,0]),Nt("sample.alpha",32926),Nt("sample.enable",32928),Ut("sample.coverage","sampleCoverage",[1,!1]),Nt("stencil.enable",2960),Ut("stencil.mask","stencilMask",-1),Ut("stencil.func","stencilFunc",[519,0,-1]),Ut("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),Ut("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),Nt("scissor.enable",3089),Ut("scissor.box","scissor",[0,0,Be.drawingBufferWidth,Be.drawingBufferHeight]),Ut("viewport","viewport",[0,0,Be.drawingBufferWidth,Be.drawingBufferHeight]);var En={gl:Be,context:Dt,strings:Ke,next:tn,current:en,draw:vt,elements:Pe,buffer:Le,shader:Lt,attributes:pt.state,vao:pt,uniforms:Mt,framebuffer:ht,extensions:_e,timer:xt,isBufferArgs:G},Bn={primTypes:xe,compareFuncs:er,blendFuncs:_t,blendEquations:Sn,stencilOps:tr,glTypes:ue,orientationType:Ue};Nr&&(Bn.backBuffer=[1029],Bn.drawBuffer=f(Ce.maxDrawbuffers,function(It){return It===0?[0]:f(It,function(qt){return 36064+qt})}));var Jt=0;return{next:tn,current:en,procs:function(){var It=Qt(),qt=It.proc("poll"),fr=It.proc("refresh"),Tr=It.block();qt(Tr),fr(Tr);var Gr,Vr=It.shared,xr=Vr.gl,wr=Vr.next,Sr=Vr.current;Tr(Sr,".dirty=false;"),Xt(It,qt),Xt(It,fr,null,!0),an&&(Gr=It.link(an)),_e.oes_vertex_array_object&&fr(It.link(_e.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Mr=0;Mr<Ce.maxAttributes;++Mr){var Ir=fr.def(Vr.attributes,"[",Mr,"]"),qr=It.cond(Ir,".buffer");qr.then(xr,".enableVertexAttribArray(",Mr,");",xr,".bindBuffer(",34962,",",Ir,".buffer.buffer);",xr,".vertexAttribPointer(",Mr,",",Ir,".size,",Ir,".type,",Ir,".normalized,",Ir,".stride,",Ir,".offset);").else(xr,".disableVertexAttribArray(",Mr,");",xr,".vertexAttrib4f(",Mr,",",Ir,".x,",Ir,".y,",Ir,".z,",Ir,".w);",Ir,".buffer=null;"),fr(qr),an&&fr(Gr,".vertexAttribDivisorANGLE(",Mr,",",Ir,".divisor);")}return fr(It.shared.vao,".currentVAO=null;",It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"),Object.keys(rn).forEach(function(cn){var _n=rn[cn],Jr=Tr.def(wr,".",cn),bn=It.block();bn("if(",Jr,"){",xr,".enable(",_n,")}else{",xr,".disable(",_n,")}",Sr,".",cn,"=",Jr,";"),fr(bn),qt("if(",Jr,"!==",Sr,".",cn,"){",bn,"}")}),Object.keys(An).forEach(function(cn){var _n,Jr,bn=An[cn],Dr=en[cn],Wr=It.block();Wr(xr,".",bn,"("),y(Dr)?(bn=Dr.length,_n=It.global.def(wr,".",cn),Jr=It.global.def(Sr,".",cn),Wr(f(bn,function(vn){return _n+"["+vn+"]"}),");",f(bn,function(vn){return Jr+"["+vn+"]="+_n+"["+vn+"];"}).join("")),qt("if(",f(bn,function(vn){return _n+"["+vn+"]!=="+Jr+"["+vn+"]"}).join("||"),"){",Wr,"}")):(_n=Tr.def(wr,".",cn),Jr=Tr.def(Sr,".",cn),Wr(_n,");",Sr,".",cn,"=",_n,";"),qt("if(",_n,"!==",Jr,"){",Wr,"}")),fr(Wr)}),It.compile()}(),compile:function(It,qt,fr,Tr,Gr){var Vr=Qt();Vr.stats=Vr.link(Gr),Object.keys(qt.static).forEach(function(wr){In(Vr,qt,wr)}),tt.forEach(function(wr){In(Vr,It,wr)});var xr=Gt(It,qt,fr,Tr);return function(wr,Sr){var Mr=wr.proc("draw",1);dr(wr,Mr),ir(wr,Mr,Sr.context),Xt(wr,Mr,Sr.framebuffer),Kt(wr,Mr,Sr),or(wr,Mr,Sr.state),vr(wr,Mr,Sr,!1,!0);var Ir=Sr.shader.progVar.append(wr,Mr);if(Mr(wr.shared.gl,".useProgram(",Ir,".program);"),Sr.shader.program)_r(wr,Mr,Sr,Sr.shader.program);else{Mr(wr.shared.vao,".setVAO(null);");var qr=wr.global.def("{}"),cn=Mr.def(Ir,".id"),_n=Mr.def(qr,"[",cn,"]");Mr(wr.cond(_n).then(_n,".call(this,a0);").else(_n,"=",qr,"[",cn,"]=",wr.link(function(Jr){return Rr(_r,wr,Sr,Jr,1)}),"(",Ir,");",_n,".call(this,a0);"))}0<Object.keys(Sr.state).length&&Mr(wr.shared.current,".dirty=true;"),wr.shared.vao&&Mr(wr.shared.vao,".setVAO(null);")}(Vr,xr),pn(Vr,xr),function(wr,Sr){function Mr(Dr){return Dr.contextDep&&qr||Dr.propDep}var Ir=wr.proc("batch",2);wr.batchId="0",dr(wr,Ir);var qr=!1,cn=!0;Object.keys(Sr.context).forEach(function(Dr){qr=qr||Sr.context[Dr].propDep}),qr||(ir(wr,Ir,Sr.context),cn=!1);var _n=!1;if((Jr=Sr.framebuffer)?(Jr.propDep?qr=_n=!0:Jr.contextDep&&qr&&(_n=!0),_n||Xt(wr,Ir,Jr)):Xt(wr,Ir,null),Sr.state.viewport&&Sr.state.viewport.propDep&&(qr=!0),Kt(wr,Ir,Sr),or(wr,Ir,Sr.state,function(Dr){return!Mr(Dr)}),Sr.profile&&Mr(Sr.profile)||vr(wr,Ir,Sr,!1,"a1"),Sr.contextDep=qr,Sr.needsContext=cn,Sr.needsFramebuffer=_n,(cn=Sr.shader.progVar).contextDep&&qr||cn.propDep)$r(wr,Ir,Sr,null);else if(cn=cn.append(wr,Ir),Ir(wr.shared.gl,".useProgram(",cn,".program);"),Sr.shader.program)$r(wr,Ir,Sr,Sr.shader.program);else{Ir(wr.shared.vao,".setVAO(null);");var Jr=wr.global.def("{}"),bn=(_n=Ir.def(cn,".id"),Ir.def(Jr,"[",_n,"]"));Ir(wr.cond(bn).then(bn,".call(this,a0,a1);").else(bn,"=",Jr,"[",_n,"]=",wr.link(function(Dr){return Rr($r,wr,Sr,Dr,2)}),"(",cn,");",bn,".call(this,a0,a1);"))}0<Object.keys(Sr.state).length&&Ir(wr.shared.current,".dirty=true;"),wr.shared.vao&&Ir(wr.shared.vao,".setVAO(null);")}(Vr,xr),j(Vr.compile(),{destroy:function(){xr.shader.program.destroy()}})}}}function z(Be,Ke){for(var _e=0;_e<Be.length;++_e)if(Be[_e]===Ke)return _e;return-1}var j=function(Be,Ke){for(var _e=Object.keys(Ke),Ce=0;Ce<_e.length;++Ce)Be[_e[Ce]]=Ke[_e[Ce]];return Be},W=0,ee={DynamicVariable:t,define:function(Be,Ke){return new t(Be,d(Ke+""))},isDynamic:function(Be){return typeof Be=="function"&&!Be._reglType||Be instanceof t},unbox:function Be(Ke,_e){return typeof Ke=="function"?new t(0,Ke):typeof Ke=="number"||typeof Ke=="boolean"?new t(5,Ke):Array.isArray(Ke)?new t(6,Ke.map(function(Ce,Le){return Be(Ce)})):Ke instanceof t?Ke:void 0},accessor:d},J={next:typeof requestAnimationFrame=="function"?function(Be){return requestAnimationFrame(Be)}:function(Be){return setTimeout(Be,16)},cancel:typeof cancelAnimationFrame=="function"?function(Be){return cancelAnimationFrame(Be)}:clearTimeout},Q=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date},te=o();te.zero=o();var ie=function(Be,Ke){var _e=1;Ke.ext_texture_filter_anisotropic&&(_e=Be.getParameter(34047));var Ce=1,Le=1;Ke.webgl_draw_buffers&&(Ce=Be.getParameter(34852),Le=Be.getParameter(36063));var Pe=!!Ke.oes_texture_float;if(Pe){Pe=Be.createTexture(),Be.bindTexture(3553,Pe),Be.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var Xe=Be.createFramebuffer();if(Be.bindFramebuffer(36160,Xe),Be.framebufferTexture2D(36160,36064,3553,Pe,0),Be.bindTexture(3553,null),Be.checkFramebufferStatus(36160)!==36053)Pe=!1;else{Be.viewport(0,0,1,1),Be.clearColor(1,0,0,1),Be.clear(16384);var ht=te.allocType(5126,4);Be.readPixels(0,0,1,1,6408,5126,ht),Be.getError()?Pe=!1:(Be.deleteFramebuffer(Xe),Be.deleteTexture(Pe),Pe=ht[0]===1),te.freeType(ht)}}return ht=!0,typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(ht=Be.createTexture(),Xe=te.allocType(5121,36),Be.activeTexture(33984),Be.bindTexture(34067,ht),Be.texImage2D(34069,0,6408,3,3,0,6408,5121,Xe),te.freeType(Xe),Be.bindTexture(34067,null),Be.deleteTexture(ht),ht=!Be.getError()),{colorBits:[Be.getParameter(3410),Be.getParameter(3411),Be.getParameter(3412),Be.getParameter(3413)],depthBits:Be.getParameter(3414),stencilBits:Be.getParameter(3415),subpixelBits:Be.getParameter(3408),extensions:Object.keys(Ke).filter(function(Mt){return!!Ke[Mt]}),maxAnisotropic:_e,maxDrawbuffers:Ce,maxColorAttachments:Le,pointSizeDims:Be.getParameter(33901),lineWidthDims:Be.getParameter(33902),maxViewportDims:Be.getParameter(3386),maxCombinedTextureUnits:Be.getParameter(35661),maxCubeMapSize:Be.getParameter(34076),maxRenderbufferSize:Be.getParameter(34024),maxTextureUnits:Be.getParameter(34930),maxTextureSize:Be.getParameter(3379),maxAttributes:Be.getParameter(34921),maxVertexUniforms:Be.getParameter(36347),maxVertexTextureUnits:Be.getParameter(35660),maxVaryingVectors:Be.getParameter(36348),maxFragmentUniforms:Be.getParameter(36349),glsl:Be.getParameter(35724),renderer:Be.getParameter(7937),vendor:Be.getParameter(7936),version:Be.getParameter(7938),readFloat:Pe,npotTextureCube:ht}},ae=function(Be){return Be instanceof Uint8Array||Be instanceof Uint16Array||Be instanceof Uint32Array||Be instanceof Int8Array||Be instanceof Int16Array||Be instanceof Int32Array||Be instanceof Float32Array||Be instanceof Float64Array||Be instanceof Uint8ClampedArray},he=function(Be){return Object.keys(Be).map(function(Ke){return Be[Ke]})},se={shape:function(Be){for(var Ke=[];Be.length;Be=Be[0])Ke.push(Be.length);return Ke},flatten:function(Be,Ke,_e,Ce){var Le=1;if(Ke.length)for(var Pe=0;Pe<Ke.length;++Pe)Le*=Ke[Pe];else Le=0;switch(_e=Ce||te.allocType(_e,Le),Ke.length){case 0:break;case 1:for(Ce=Ke[0],Ke=0;Ke<Ce;++Ke)_e[Ke]=Be[Ke];break;case 2:for(Ce=Ke[0],Ke=Ke[1],Pe=Le=0;Pe<Ce;++Pe)for(var Xe=Be[Pe],ht=0;ht<Ke;++ht)_e[Le++]=Xe[ht];break;case 3:s(Be,Ke[0],Ke[1],Ke[2],_e,0);break;default:(function Mt(pt,Lt,vt,Dt,xt){for(var it=1,St=vt+1;St<Lt.length;++St)it*=Lt[St];var Nt=Lt[vt];if(Lt.length-vt==4){var Ut=Lt[vt+1],Qt=Lt[vt+2];for(Lt=Lt[vt+3],St=0;St<Nt;++St)s(pt[St],Ut,Qt,Lt,Dt,xt),xt+=it}else for(St=0;St<Nt;++St)Mt(pt[St],Lt,vt+1,Dt,xt),xt+=it})(Be,Ke,0,_e,0)}return _e}},de={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},ue={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},ve={dynamic:35048,stream:35040,static:35044},ke=se.flatten,Ee=se.shape,be=[];be[5120]=1,be[5122]=2,be[5124]=4,be[5121]=1,be[5123]=2,be[5125]=4,be[5126]=4;var xe={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ce=new Float32Array(1),ge=new Uint32Array(ce.buffer),we=[9984,9986,9985,9987],Me=[0,6409,6410,6407,6408],Se={};Se[6409]=Se[6406]=Se[6402]=1,Se[34041]=Se[6410]=2,Se[6407]=Se[35904]=3,Se[6408]=Se[35906]=4;var ze=v("HTMLCanvasElement"),Fe=v("OffscreenCanvas"),Ye=v("CanvasRenderingContext2D"),rt=v("ImageBitmap"),Oe=v("HTMLImageElement"),je=v("HTMLVideoElement"),We=Object.keys(de).concat([ze,Fe,Ye,rt,Oe,je]),qe=[];qe[5121]=1,qe[5126]=4,qe[36193]=2,qe[5123]=2,qe[5125]=4;var et=[];et[32854]=2,et[32855]=2,et[36194]=2,et[34041]=4,et[33776]=.5,et[33777]=.5,et[33778]=1,et[33779]=1,et[35986]=.5,et[35987]=1,et[34798]=1,et[35840]=.5,et[35841]=.25,et[35842]=.5,et[35843]=.25,et[36196]=.5;var st=[];st[32854]=2,st[32855]=2,st[36194]=2,st[33189]=2,st[36168]=1,st[34041]=4,st[35907]=4,st[34836]=16,st[34842]=8,st[34843]=6;var ct=function(Be,Ke,_e,Ce,Le){function Pe(vt){this.id=pt++,this.refCount=1,this.renderbuffer=vt,this.format=32854,this.height=this.width=0,Le.profile&&(this.stats={size:0})}function Xe(vt){var Dt=vt.renderbuffer;Be.bindRenderbuffer(36161,null),Be.deleteRenderbuffer(Dt),vt.renderbuffer=null,vt.refCount=0,delete Lt[vt.id],Ce.renderbufferCount--}var ht={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};Ke.ext_srgb&&(ht.srgba=35907),Ke.ext_color_buffer_half_float&&(ht.rgba16f=34842,ht.rgb16f=34843),Ke.webgl_color_buffer_float&&(ht.rgba32f=34836);var Mt=[];Object.keys(ht).forEach(function(vt){Mt[ht[vt]]=vt});var pt=0,Lt={};return Pe.prototype.decRef=function(){0>=--this.refCount&&Xe(this)},Le.profile&&(Ce.getTotalRenderbufferSize=function(){var vt=0;return Object.keys(Lt).forEach(function(Dt){vt+=Lt[Dt].stats.size}),vt}),{create:function(vt,Dt){function xt(St,Nt){var Ut=0,Qt=0,Ie=32854;if(typeof St=="object"&&St?("shape"in St?(Ut=0|(Qt=St.shape)[0],Qt=0|Qt[1]):("radius"in St&&(Ut=Qt=0|St.radius),"width"in St&&(Ut=0|St.width),"height"in St&&(Qt=0|St.height)),"format"in St&&(Ie=ht[St.format])):typeof St=="number"?(Ut=0|St,Qt=typeof Nt=="number"?0|Nt:Ut):St||(Ut=Qt=1),Ut!==it.width||Qt!==it.height||Ie!==it.format)return xt.width=it.width=Ut,xt.height=it.height=Qt,it.format=Ie,Be.bindRenderbuffer(36161,it.renderbuffer),Be.renderbufferStorage(36161,Ie,Ut,Qt),Le.profile&&(it.stats.size=st[it.format]*it.width*it.height),xt.format=Mt[it.format],xt}var it=new Pe(Be.createRenderbuffer());return Lt[it.id]=it,Ce.renderbufferCount++,xt(vt,Dt),xt.resize=function(St,Nt){var Ut=0|St,Qt=0|Nt||Ut;return Ut===it.width&&Qt===it.height||(xt.width=it.width=Ut,xt.height=it.height=Qt,Be.bindRenderbuffer(36161,it.renderbuffer),Be.renderbufferStorage(36161,it.format,Ut,Qt),Le.profile&&(it.stats.size=st[it.format]*it.width*it.height)),xt},xt._reglType="renderbuffer",xt._renderbuffer=it,Le.profile&&(xt.stats=it.stats),xt.destroy=function(){it.decRef()},xt},clear:function(){he(Lt).forEach(Xe)},restore:function(){he(Lt).forEach(function(vt){vt.renderbuffer=Be.createRenderbuffer(),Be.bindRenderbuffer(36161,vt.renderbuffer),Be.renderbufferStorage(36161,vt.format,vt.width,vt.height)}),Be.bindRenderbuffer(36161,null)}}},Pt=[];Pt[6408]=4,Pt[6407]=3;var kt=[];kt[5121]=1,kt[5126]=4,kt[36193]=2;var at=["x","y","z","w"],tt="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),_t={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},er={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},tr={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ue={cw:2304,ccw:2305},He=new K(!1,!1,!1,function(){});return function(Be){function Ke(){if(jr.length===0)Ie&&Ie.update(),On=null;else{On=J.next(Ke),Lt();for(var an=jr.length-1;0<=an;--an){var Nr=jr[an];Nr&&Nr(Gt,null,0)}xt.flush(),Ie&&Ie.update()}}function _e(){!On&&0<jr.length&&(On=J.next(Ke))}function Ce(){On&&(J.cancel(Ke),On=null)}function Le(an){an.preventDefault(),Ce(),$r.forEach(function(Nr){Nr()})}function Pe(an){xt.getError(),St.restore(),dr.restore(),Xt.restore(),vr.restore(),ur.restore(),pr.restore(),or.restore(),Ie&&Ie.restore(),br.procs.refresh(),_e(),pn.forEach(function(Nr){Nr()})}function Xe(an){function Nr(It,qt){var fr={},Tr={};return Object.keys(It).forEach(function(Gr){var Vr=It[Gr];if(ee.isDynamic(Vr))Tr[Gr]=ee.unbox(Vr,Gr);else{if(qt&&Array.isArray(Vr)){for(var xr=0;xr<Vr.length;++xr)if(ee.isDynamic(Vr[xr]))return void(Tr[Gr]=ee.unbox(Vr,Gr))}fr[Gr]=Vr}}),{dynamic:Tr,static:fr}}var Pr=Nr(an.context||{},!0),en=Nr(an.uniforms||{},!0),tn=Nr(an.attributes||{},!1);an=Nr(function(It){function qt(Tr){if(Tr in fr){var Gr=fr[Tr];delete fr[Tr],Object.keys(Gr).forEach(function(Vr){fr[Tr+"."+Vr]=Gr[Vr]})}}var fr=j({},It);return delete fr.uniforms,delete fr.attributes,delete fr.context,delete fr.vao,"stencil"in fr&&fr.stencil.op&&(fr.stencil.opBack=fr.stencil.opFront=fr.stencil.op,delete fr.stencil.op),qt("blend"),qt("depth"),qt("cull"),qt("stencil"),qt("polygonOffset"),qt("scissor"),qt("sample"),"vao"in It&&(fr.vao=It.vao),fr}(an),!1);var Qr={gpuTime:0,cpuTime:0,count:0},rn=br.compile(an,tn,en,Pr,Qr),An=rn.draw,En=rn.batch,Bn=rn.scope,Jt=[];return j(function(It,qt){var fr;if(typeof It=="function")return Bn.call(this,null,It,0);if(typeof qt=="function")if(typeof It=="number")for(fr=0;fr<It;++fr)Bn.call(this,null,qt,fr);else{if(!Array.isArray(It))return Bn.call(this,It,qt,0);for(fr=0;fr<It.length;++fr)Bn.call(this,It[fr],qt,fr)}else if(typeof It=="number"){if(0<It)return En.call(this,function(Tr){for(;Jt.length<Tr;)Jt.push(null);return Jt}(0|It),0|It)}else{if(!Array.isArray(It))return An.call(this,It);if(It.length)return En.call(this,It,It.length)}},{stats:Qr,destroy:function(){rn.destroy()}})}function ht(an,Nr){var Pr=0;br.procs.poll();var en=Nr.color;en&&(xt.clearColor(+en[0]||0,+en[1]||0,+en[2]||0,+en[3]||0),Pr|=16384),"depth"in Nr&&(xt.clearDepth(+Nr.depth),Pr|=256),"stencil"in Nr&&(xt.clearStencil(0|Nr.stencil),Pr|=1024),xt.clear(Pr)}function Mt(an){return jr.push(an),_e(),{cancel:function(){var Nr=z(jr,an);jr[Nr]=function Pr(){var en=z(jr,Pr);jr[en]=jr[jr.length-1],--jr.length,0>=jr.length&&Ce()}}}}function pt(){var an=Rr.viewport,Nr=Rr.scissor_box;an[0]=an[1]=Nr[0]=Nr[1]=0,Gt.viewportWidth=Gt.framebufferWidth=Gt.drawingBufferWidth=an[2]=Nr[2]=xt.drawingBufferWidth,Gt.viewportHeight=Gt.framebufferHeight=Gt.drawingBufferHeight=an[3]=Nr[3]=xt.drawingBufferHeight}function Lt(){Gt.tick+=1,Gt.time=Dt(),pt(),br.procs.poll()}function vt(){vr.refresh(),pt(),br.procs.refresh(),Ie&&Ie.update()}function Dt(){return(Q()-lt)/1e3}if(!(Be=e(Be)))return null;var xt=Be.gl,it=xt.getContextAttributes();xt.isContextLost();var St=function(an,Nr){function Pr(rn){var An;rn=rn.toLowerCase();try{An=en[rn]=an.getExtension(rn)}catch(En){}return!!An}for(var en={},tn=0;tn<Nr.extensions.length;++tn){var Qr=Nr.extensions[tn];if(!Pr(Qr))return Nr.onDestroy(),Nr.onDone('"'+Qr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Nr.optionalExtensions.forEach(Pr),{extensions:en,restore:function(){Object.keys(en).forEach(function(rn){if(en[rn]&&!Pr(rn))throw Error("(regl): error restoring extension "+rn)})}}}(xt,Be);if(!St)return null;var Nt=function(){var an={"":0},Nr=[""];return{id:function(Pr){var en=an[Pr];return en||(en=an[Pr]=Nr.length,Nr.push(Pr),en)},str:function(Pr){return Nr[Pr]}}}(),Ut={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},Qt=St.extensions,Ie=function(an,Nr){function Pr(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function en(Jt,It,qt){var fr=rn.pop()||new Pr;fr.startQueryIndex=Jt,fr.endQueryIndex=It,fr.sum=0,fr.stats=qt,An.push(fr)}if(!Nr.ext_disjoint_timer_query)return null;var tn=[],Qr=[],rn=[],An=[],En=[],Bn=[];return{beginQuery:function(Jt){var It=tn.pop()||Nr.ext_disjoint_timer_query.createQueryEXT();Nr.ext_disjoint_timer_query.beginQueryEXT(35007,It),Qr.push(It),en(Qr.length-1,Qr.length,Jt)},endQuery:function(){Nr.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:en,update:function(){var Jt,It;if((Jt=Qr.length)!==0){Bn.length=Math.max(Bn.length,Jt+1),En.length=Math.max(En.length,Jt+1),En[0]=0;var qt=Bn[0]=0;for(It=Jt=0;It<Qr.length;++It){var fr=Qr[It];Nr.ext_disjoint_timer_query.getQueryObjectEXT(fr,34919)?(qt+=Nr.ext_disjoint_timer_query.getQueryObjectEXT(fr,34918),tn.push(fr)):Qr[Jt++]=fr,En[It+1]=qt,Bn[It+1]=Jt}for(Qr.length=Jt,It=Jt=0;It<An.length;++It){var Tr=(qt=An[It]).startQueryIndex;fr=qt.endQueryIndex,qt.sum+=En[fr]-En[Tr],Tr=Bn[Tr],(fr=Bn[fr])===Tr?(qt.stats.gpuTime+=qt.sum/1e6,rn.push(qt)):(qt.startQueryIndex=Tr,qt.endQueryIndex=fr,An[Jt++]=qt)}An.length=Jt}},getNumPendingQueries:function(){return Qr.length},clear:function(){tn.push.apply(tn,Qr);for(var Jt=0;Jt<tn.length;Jt++)Nr.ext_disjoint_timer_query.deleteQueryEXT(tn[Jt]);Qr.length=0,tn.length=0},restore:function(){Qr.length=0,tn.length=0}}}(0,Qt),lt=Q(),wt=xt.drawingBufferWidth,Ot=xt.drawingBufferHeight,Gt={tick:0,time:0,viewportWidth:wt,viewportHeight:Ot,framebufferWidth:wt,framebufferHeight:Ot,drawingBufferWidth:wt,drawingBufferHeight:Ot,pixelRatio:Be.pixelRatio},ir=(wt={elements:null,primitive:4,count:-1,offset:0,instances:-1},ie(xt,Qt)),Xt=a(xt,Ut,Be,function(an){return or.destroyBuffer(an)}),Kt=g(xt,Qt,Xt,Ut),or=M(xt,Qt,ir,Ut,Xt,Kt,wt),dr=P(xt,Nt,Ut,Be),vr=E(xt,Qt,ir,function(){br.procs.poll()},Gt,Ut,Be),ur=ct(xt,Qt,0,Ut,Be),pr=k(xt,Qt,ir,vr,ur,Ut),br=$(xt,Nt,Qt,ir,Xt,Kt,0,pr,{},or,dr,wt,Gt,Ie,Be),Rr=(Nt=D(xt,pr,br.procs.poll,Gt),br.next),_r=xt.canvas,jr=[],$r=[],pn=[],In=[Be.onDestroy],On=null;_r&&(_r.addEventListener("webglcontextlost",Le,!1),_r.addEventListener("webglcontextrestored",Pe,!1));var Sn=pr.setFBO=Xe({framebuffer:ee.define.call(null,1,"framebuffer")});return vt(),it=j(Xe,{clear:function(an){if("framebuffer"in an)if(an.framebuffer&&an.framebuffer_reglType==="framebufferCube")for(var Nr=0;6>Nr;++Nr)Sn(j({framebuffer:an.framebuffer.faces[Nr]},an),ht);else Sn(an,ht);else ht(0,an)},prop:ee.define.bind(null,1),context:ee.define.bind(null,2),this:ee.define.bind(null,3),draw:Xe({}),buffer:function(an){return Xt.create(an,34962,!1,!1)},elements:function(an){return Kt.create(an,!1)},texture:vr.create2D,cube:vr.createCube,renderbuffer:ur.create,framebuffer:pr.create,framebufferCube:pr.createCube,vao:or.createVAO,attributes:it,frame:Mt,on:function(an,Nr){var Pr;switch(an){case"frame":return Mt(Nr);case"lost":Pr=$r;break;case"restore":Pr=pn;break;case"destroy":Pr=In}return Pr.push(Nr),{cancel:function(){for(var en=0;en<Pr.length;++en)if(Pr[en]===Nr){Pr[en]=Pr[Pr.length-1],Pr.pop();break}}}},limits:ir,hasExtension:function(an){return 0<=ir.extensions.indexOf(an.toLowerCase())},read:Nt,destroy:function(){jr.length=0,Ce(),_r&&(_r.removeEventListener("webglcontextlost",Le),_r.removeEventListener("webglcontextrestored",Pe)),dr.clear(),pr.clear(),ur.clear(),or.clear(),vr.clear(),Kt.clear(),Xt.clear(),Ie&&Ie.clear(),In.forEach(function(an){an()})},_gl:xt,_refresh:vt,poll:function(){Lt(),Ie&&Ie.update()},now:Dt,stats:Ut}),Be.onDone(null,it),it}})},{}],527:[function(r,I,B){var t,d="";I.exports=function(m,h){if(typeof m!="string")throw new TypeError("expected a string");if(h===1)return m;if(h===2)return m+m;var e=m.length*h;if(t!==m||t===void 0)t=m,d="";else if(d.length>=e)return d.substr(0,e);for(;e>d.length&&h>1;)1&h&&(d+=m),h>>=1,m+=m;return d=(d+=m).substr(0,e)}},{}],528:[function(r,I,B){(function(t){(function(){I.exports=t.performance&&t.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,typeof vi!="undefined"?vi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],529:[function(r,I,B){I.exports=function(t){for(var d=t.length,m=t[t.length-1],h=d,e=d-2;e>=0;--e){var f=m,l=t[e];(u=l-((m=f+l)-f))&&(t[--h]=m,m=u)}var o=0;for(e=h;e<d;++e){var u;f=t[e],(u=(l=m)-((m=f+l)-f))&&(t[o++]=u)}return t[o++]=m,t.length=o,t}},{}],530:[function(r,I,B){var t=r("two-product"),d=r("robust-sum"),m=r("robust-scale"),h=r("robust-compress");function e(s,i,c,n){return function(a){return n(s(c(a[0][0],a[1][1]),c(-a[0][1],a[1][0])))}}function f(s,i,c,n){return function(a){return n(s(i(s(c(a[1][1],a[2][2]),c(-a[1][2],a[2][1])),a[0][0]),s(i(s(c(a[1][0],a[2][2]),c(-a[1][2],a[2][0])),-a[0][1]),i(s(c(a[1][0],a[2][1]),c(-a[1][1],a[2][0])),a[0][2]))))}}function l(s){return(s===2?e:s===3?f:void 0)(d,m,t,h)}var o=[function(){return[0]},function(s){return[s[0][0]]}];function u(s,i,c,n,a,g){return function(p){switch(p.length){case 0:return s(p);case 1:return i(p);case 2:return c(p);case 3:return n(p)}var y=a[p.length];return y||(y=a[p.length]=g(p.length)),y(p)}}(function(){for(;o.length<4;)o.push(l(o.length));I.exports=u.apply(void 0,o.concat([o,l]));for(var s=0;s<o.length;++s)I.exports[s]=o[s]})()},{"robust-compress":529,"robust-scale":536,"robust-sum":539,"two-product":588}],531:[function(r,I,B){var t=r("two-product"),d=r("robust-sum");I.exports=function(m,h){for(var e=t(m[0],h[0]),f=1;f<m.length;++f)e=d(e,t(m[f],h[f]));return e}},{"robust-sum":539,"two-product":588}],532:[function(r,I,B){var t=r("two-product"),d=r("robust-sum"),m=r("robust-subtract"),h=r("robust-scale");function e(n){return(n===3?f:n===4?l:n===5?o:u)(d,m,t,h)}function f(n,a,g,p){return function(y,v,b){var x=g(y[0],y[0]),T=p(x,v[0]),A=p(x,b[0]),S=g(v[0],v[0]),w=p(S,y[0]),E=p(S,b[0]),k=g(b[0],b[0]),L=p(k,y[0]),M=p(k,v[0]),P=n(a(M,E),a(w,T)),D=a(L,A),N=a(P,D);return N[N.length-1]}}function l(n,a,g,p){return function(y,v,b,x){var T=n(g(y[0],y[0]),g(y[1],y[1])),A=p(T,v[0]),S=p(T,b[0]),w=p(T,x[0]),E=n(g(v[0],v[0]),g(v[1],v[1])),k=p(E,y[0]),L=p(E,b[0]),M=p(E,x[0]),P=n(g(b[0],b[0]),g(b[1],b[1])),D=p(P,y[0]),N=p(P,v[0]),U=p(P,x[0]),G=n(g(x[0],x[0]),g(x[1],x[1])),X=p(G,y[0]),K=p(G,v[0]),Z=p(G,b[0]),H=n(n(p(a(Z,U),v[1]),n(p(a(K,M),-b[1]),p(a(N,L),x[1]))),n(p(a(K,M),y[1]),n(p(a(X,w),-v[1]),p(a(k,A),x[1])))),Y=n(n(p(a(Z,U),y[1]),n(p(a(X,w),-b[1]),p(a(D,S),x[1]))),n(p(a(N,L),y[1]),n(p(a(D,S),-v[1]),p(a(k,A),b[1])))),$=a(H,Y);return $[$.length-1]}}function o(n,a,g,p){return function(y,v,b,x,T){var A=n(g(y[0],y[0]),n(g(y[1],y[1]),g(y[2],y[2]))),S=p(A,v[0]),w=p(A,b[0]),E=p(A,x[0]),k=p(A,T[0]),L=n(g(v[0],v[0]),n(g(v[1],v[1]),g(v[2],v[2]))),M=p(L,y[0]),P=p(L,b[0]),D=p(L,x[0]),N=p(L,T[0]),U=n(g(b[0],b[0]),n(g(b[1],b[1]),g(b[2],b[2]))),G=p(U,y[0]),X=p(U,v[0]),K=p(U,x[0]),Z=p(U,T[0]),H=n(g(x[0],x[0]),n(g(x[1],x[1]),g(x[2],x[2]))),Y=p(H,y[0]),$=p(H,v[0]),z=p(H,b[0]),j=p(H,T[0]),W=n(g(T[0],T[0]),n(g(T[1],T[1]),g(T[2],T[2]))),ee=p(W,y[0]),J=p(W,v[0]),Q=p(W,b[0]),te=p(W,x[0]),ie=n(n(n(p(n(p(a(te,j),b[1]),n(p(a(Q,Z),-x[1]),p(a(z,K),T[1]))),v[2]),n(p(n(p(a(te,j),v[1]),n(p(a(J,N),-x[1]),p(a($,D),T[1]))),-b[2]),p(n(p(a(Q,Z),v[1]),n(p(a(J,N),-b[1]),p(a(X,P),T[1]))),x[2]))),n(p(n(p(a(z,K),v[1]),n(p(a($,D),-b[1]),p(a(X,P),x[1]))),-T[2]),n(p(n(p(a(te,j),v[1]),n(p(a(J,N),-x[1]),p(a($,D),T[1]))),y[2]),p(n(p(a(te,j),y[1]),n(p(a(ee,k),-x[1]),p(a(Y,E),T[1]))),-v[2])))),n(n(p(n(p(a(J,N),y[1]),n(p(a(ee,k),-v[1]),p(a(M,S),T[1]))),x[2]),n(p(n(p(a($,D),y[1]),n(p(a(Y,E),-v[1]),p(a(M,S),x[1]))),-T[2]),p(n(p(a(z,K),v[1]),n(p(a($,D),-b[1]),p(a(X,P),x[1]))),y[2]))),n(p(n(p(a(z,K),y[1]),n(p(a(Y,E),-b[1]),p(a(G,w),x[1]))),-v[2]),n(p(n(p(a($,D),y[1]),n(p(a(Y,E),-v[1]),p(a(M,S),x[1]))),b[2]),p(n(p(a(X,P),y[1]),n(p(a(G,w),-v[1]),p(a(M,S),b[1]))),-x[2]))))),ae=n(n(n(p(n(p(a(te,j),b[1]),n(p(a(Q,Z),-x[1]),p(a(z,K),T[1]))),y[2]),p(n(p(a(te,j),y[1]),n(p(a(ee,k),-x[1]),p(a(Y,E),T[1]))),-b[2])),n(p(n(p(a(Q,Z),y[1]),n(p(a(ee,k),-b[1]),p(a(G,w),T[1]))),x[2]),p(n(p(a(z,K),y[1]),n(p(a(Y,E),-b[1]),p(a(G,w),x[1]))),-T[2]))),n(n(p(n(p(a(Q,Z),v[1]),n(p(a(J,N),-b[1]),p(a(X,P),T[1]))),y[2]),p(n(p(a(Q,Z),y[1]),n(p(a(ee,k),-b[1]),p(a(G,w),T[1]))),-v[2])),n(p(n(p(a(J,N),y[1]),n(p(a(ee,k),-v[1]),p(a(M,S),T[1]))),b[2]),p(n(p(a(X,P),y[1]),n(p(a(G,w),-v[1]),p(a(M,S),b[1]))),-T[2])))),he=a(ie,ae);return he[he.length-1]}}function u(n,a,g,p){return function(y,v,b,x,T,A){var S=n(n(g(y[0],y[0]),g(y[1],y[1])),n(g(y[2],y[2]),g(y[3],y[3]))),w=p(S,v[0]),E=p(S,b[0]),k=p(S,x[0]),L=p(S,T[0]),M=p(S,A[0]),P=n(n(g(v[0],v[0]),g(v[1],v[1])),n(g(v[2],v[2]),g(v[3],v[3]))),D=p(P,y[0]),N=p(P,b[0]),U=p(P,x[0]),G=p(P,T[0]),X=p(P,A[0]),K=n(n(g(b[0],b[0]),g(b[1],b[1])),n(g(b[2],b[2]),g(b[3],b[3]))),Z=p(K,y[0]),H=p(K,v[0]),Y=p(K,x[0]),$=p(K,T[0]),z=p(K,A[0]),j=n(n(g(x[0],x[0]),g(x[1],x[1])),n(g(x[2],x[2]),g(x[3],x[3]))),W=p(j,y[0]),ee=p(j,v[0]),J=p(j,b[0]),Q=p(j,T[0]),te=p(j,A[0]),ie=n(n(g(T[0],T[0]),g(T[1],T[1])),n(g(T[2],T[2]),g(T[3],T[3]))),ae=p(ie,y[0]),he=p(ie,v[0]),se=p(ie,b[0]),de=p(ie,x[0]),ue=p(ie,A[0]),ve=n(n(g(A[0],A[0]),g(A[1],A[1])),n(g(A[2],A[2]),g(A[3],A[3]))),ke=p(ve,y[0]),Ee=p(ve,v[0]),be=p(ve,b[0]),xe=p(ve,x[0]),ce=p(ve,T[0]),ge=n(n(n(p(n(n(p(n(p(a(ce,ue),x[1]),n(p(a(xe,te),-T[1]),p(a(de,Q),A[1]))),b[2]),p(n(p(a(ce,ue),b[1]),n(p(a(be,z),-T[1]),p(a(se,$),A[1]))),-x[2])),n(p(n(p(a(xe,te),b[1]),n(p(a(be,z),-x[1]),p(a(J,Y),A[1]))),T[2]),p(n(p(a(de,Q),b[1]),n(p(a(se,$),-x[1]),p(a(J,Y),T[1]))),-A[2]))),v[3]),n(p(n(n(p(n(p(a(ce,ue),x[1]),n(p(a(xe,te),-T[1]),p(a(de,Q),A[1]))),v[2]),p(n(p(a(ce,ue),v[1]),n(p(a(Ee,X),-T[1]),p(a(he,G),A[1]))),-x[2])),n(p(n(p(a(xe,te),v[1]),n(p(a(Ee,X),-x[1]),p(a(ee,U),A[1]))),T[2]),p(n(p(a(de,Q),v[1]),n(p(a(he,G),-x[1]),p(a(ee,U),T[1]))),-A[2]))),-b[3]),p(n(n(p(n(p(a(ce,ue),b[1]),n(p(a(be,z),-T[1]),p(a(se,$),A[1]))),v[2]),p(n(p(a(ce,ue),v[1]),n(p(a(Ee,X),-T[1]),p(a(he,G),A[1]))),-b[2])),n(p(n(p(a(be,z),v[1]),n(p(a(Ee,X),-b[1]),p(a(H,N),A[1]))),T[2]),p(n(p(a(se,$),v[1]),n(p(a(he,G),-b[1]),p(a(H,N),T[1]))),-A[2]))),x[3]))),n(n(p(n(n(p(n(p(a(xe,te),b[1]),n(p(a(be,z),-x[1]),p(a(J,Y),A[1]))),v[2]),p(n(p(a(xe,te),v[1]),n(p(a(Ee,X),-x[1]),p(a(ee,U),A[1]))),-b[2])),n(p(n(p(a(be,z),v[1]),n(p(a(Ee,X),-b[1]),p(a(H,N),A[1]))),x[2]),p(n(p(a(J,Y),v[1]),n(p(a(ee,U),-b[1]),p(a(H,N),x[1]))),-A[2]))),-T[3]),p(n(n(p(n(p(a(de,Q),b[1]),n(p(a(se,$),-x[1]),p(a(J,Y),T[1]))),v[2]),p(n(p(a(de,Q),v[1]),n(p(a(he,G),-x[1]),p(a(ee,U),T[1]))),-b[2])),n(p(n(p(a(se,$),v[1]),n(p(a(he,G),-b[1]),p(a(H,N),T[1]))),x[2]),p(n(p(a(J,Y),v[1]),n(p(a(ee,U),-b[1]),p(a(H,N),x[1]))),-T[2]))),A[3])),n(p(n(n(p(n(p(a(ce,ue),x[1]),n(p(a(xe,te),-T[1]),p(a(de,Q),A[1]))),v[2]),p(n(p(a(ce,ue),v[1]),n(p(a(Ee,X),-T[1]),p(a(he,G),A[1]))),-x[2])),n(p(n(p(a(xe,te),v[1]),n(p(a(Ee,X),-x[1]),p(a(ee,U),A[1]))),T[2]),p(n(p(a(de,Q),v[1]),n(p(a(he,G),-x[1]),p(a(ee,U),T[1]))),-A[2]))),y[3]),p(n(n(p(n(p(a(ce,ue),x[1]),n(p(a(xe,te),-T[1]),p(a(de,Q),A[1]))),y[2]),p(n(p(a(ce,ue),y[1]),n(p(a(ke,M),-T[1]),p(a(ae,L),A[1]))),-x[2])),n(p(n(p(a(xe,te),y[1]),n(p(a(ke,M),-x[1]),p(a(W,k),A[1]))),T[2]),p(n(p(a(de,Q),y[1]),n(p(a(ae,L),-x[1]),p(a(W,k),T[1]))),-A[2]))),-v[3])))),n(n(n(p(n(n(p(n(p(a(ce,ue),v[1]),n(p(a(Ee,X),-T[1]),p(a(he,G),A[1]))),y[2]),p(n(p(a(ce,ue),y[1]),n(p(a(ke,M),-T[1]),p(a(ae,L),A[1]))),-v[2])),n(p(n(p(a(Ee,X),y[1]),n(p(a(ke,M),-v[1]),p(a(D,w),A[1]))),T[2]),p(n(p(a(he,G),y[1]),n(p(a(ae,L),-v[1]),p(a(D,w),T[1]))),-A[2]))),x[3]),p(n(n(p(n(p(a(xe,te),v[1]),n(p(a(Ee,X),-x[1]),p(a(ee,U),A[1]))),y[2]),p(n(p(a(xe,te),y[1]),n(p(a(ke,M),-x[1]),p(a(W,k),A[1]))),-v[2])),n(p(n(p(a(Ee,X),y[1]),n(p(a(ke,M),-v[1]),p(a(D,w),A[1]))),x[2]),p(n(p(a(ee,U),y[1]),n(p(a(W,k),-v[1]),p(a(D,w),x[1]))),-A[2]))),-T[3])),n(p(n(n(p(n(p(a(de,Q),v[1]),n(p(a(he,G),-x[1]),p(a(ee,U),T[1]))),y[2]),p(n(p(a(de,Q),y[1]),n(p(a(ae,L),-x[1]),p(a(W,k),T[1]))),-v[2])),n(p(n(p(a(he,G),y[1]),n(p(a(ae,L),-v[1]),p(a(D,w),T[1]))),x[2]),p(n(p(a(ee,U),y[1]),n(p(a(W,k),-v[1]),p(a(D,w),x[1]))),-T[2]))),A[3]),p(n(n(p(n(p(a(xe,te),b[1]),n(p(a(be,z),-x[1]),p(a(J,Y),A[1]))),v[2]),p(n(p(a(xe,te),v[1]),n(p(a(Ee,X),-x[1]),p(a(ee,U),A[1]))),-b[2])),n(p(n(p(a(be,z),v[1]),n(p(a(Ee,X),-b[1]),p(a(H,N),A[1]))),x[2]),p(n(p(a(J,Y),v[1]),n(p(a(ee,U),-b[1]),p(a(H,N),x[1]))),-A[2]))),y[3]))),n(n(p(n(n(p(n(p(a(xe,te),b[1]),n(p(a(be,z),-x[1]),p(a(J,Y),A[1]))),y[2]),p(n(p(a(xe,te),y[1]),n(p(a(ke,M),-x[1]),p(a(W,k),A[1]))),-b[2])),n(p(n(p(a(be,z),y[1]),n(p(a(ke,M),-b[1]),p(a(Z,E),A[1]))),x[2]),p(n(p(a(J,Y),y[1]),n(p(a(W,k),-b[1]),p(a(Z,E),x[1]))),-A[2]))),-v[3]),p(n(n(p(n(p(a(xe,te),v[1]),n(p(a(Ee,X),-x[1]),p(a(ee,U),A[1]))),y[2]),p(n(p(a(xe,te),y[1]),n(p(a(ke,M),-x[1]),p(a(W,k),A[1]))),-v[2])),n(p(n(p(a(Ee,X),y[1]),n(p(a(ke,M),-v[1]),p(a(D,w),A[1]))),x[2]),p(n(p(a(ee,U),y[1]),n(p(a(W,k),-v[1]),p(a(D,w),x[1]))),-A[2]))),b[3])),n(p(n(n(p(n(p(a(be,z),v[1]),n(p(a(Ee,X),-b[1]),p(a(H,N),A[1]))),y[2]),p(n(p(a(be,z),y[1]),n(p(a(ke,M),-b[1]),p(a(Z,E),A[1]))),-v[2])),n(p(n(p(a(Ee,X),y[1]),n(p(a(ke,M),-v[1]),p(a(D,w),A[1]))),b[2]),p(n(p(a(H,N),y[1]),n(p(a(Z,E),-v[1]),p(a(D,w),b[1]))),-A[2]))),-x[3]),p(n(n(p(n(p(a(J,Y),v[1]),n(p(a(ee,U),-b[1]),p(a(H,N),x[1]))),y[2]),p(n(p(a(J,Y),y[1]),n(p(a(W,k),-b[1]),p(a(Z,E),x[1]))),-v[2])),n(p(n(p(a(ee,U),y[1]),n(p(a(W,k),-v[1]),p(a(D,w),x[1]))),b[2]),p(n(p(a(H,N),y[1]),n(p(a(Z,E),-v[1]),p(a(D,w),b[1]))),-x[2]))),A[3]))))),we=n(n(n(p(n(n(p(n(p(a(ce,ue),x[1]),n(p(a(xe,te),-T[1]),p(a(de,Q),A[1]))),b[2]),p(n(p(a(ce,ue),b[1]),n(p(a(be,z),-T[1]),p(a(se,$),A[1]))),-x[2])),n(p(n(p(a(xe,te),b[1]),n(p(a(be,z),-x[1]),p(a(J,Y),A[1]))),T[2]),p(n(p(a(de,Q),b[1]),n(p(a(se,$),-x[1]),p(a(J,Y),T[1]))),-A[2]))),y[3]),n(p(n(n(p(n(p(a(ce,ue),x[1]),n(p(a(xe,te),-T[1]),p(a(de,Q),A[1]))),y[2]),p(n(p(a(ce,ue),y[1]),n(p(a(ke,M),-T[1]),p(a(ae,L),A[1]))),-x[2])),n(p(n(p(a(xe,te),y[1]),n(p(a(ke,M),-x[1]),p(a(W,k),A[1]))),T[2]),p(n(p(a(de,Q),y[1]),n(p(a(ae,L),-x[1]),p(a(W,k),T[1]))),-A[2]))),-b[3]),p(n(n(p(n(p(a(ce,ue),b[1]),n(p(a(be,z),-T[1]),p(a(se,$),A[1]))),y[2]),p(n(p(a(ce,ue),y[1]),n(p(a(ke,M),-T[1]),p(a(ae,L),A[1]))),-b[2])),n(p(n(p(a(be,z),y[1]),n(p(a(ke,M),-b[1]),p(a(Z,E),A[1]))),T[2]),p(n(p(a(se,$),y[1]),n(p(a(ae,L),-b[1]),p(a(Z,E),T[1]))),-A[2]))),x[3]))),n(n(p(n(n(p(n(p(a(xe,te),b[1]),n(p(a(be,z),-x[1]),p(a(J,Y),A[1]))),y[2]),p(n(p(a(xe,te),y[1]),n(p(a(ke,M),-x[1]),p(a(W,k),A[1]))),-b[2])),n(p(n(p(a(be,z),y[1]),n(p(a(ke,M),-b[1]),p(a(Z,E),A[1]))),x[2]),p(n(p(a(J,Y),y[1]),n(p(a(W,k),-b[1]),p(a(Z,E),x[1]))),-A[2]))),-T[3]),p(n(n(p(n(p(a(de,Q),b[1]),n(p(a(se,$),-x[1]),p(a(J,Y),T[1]))),y[2]),p(n(p(a(de,Q),y[1]),n(p(a(ae,L),-x[1]),p(a(W,k),T[1]))),-b[2])),n(p(n(p(a(se,$),y[1]),n(p(a(ae,L),-b[1]),p(a(Z,E),T[1]))),x[2]),p(n(p(a(J,Y),y[1]),n(p(a(W,k),-b[1]),p(a(Z,E),x[1]))),-T[2]))),A[3])),n(p(n(n(p(n(p(a(ce,ue),b[1]),n(p(a(be,z),-T[1]),p(a(se,$),A[1]))),v[2]),p(n(p(a(ce,ue),v[1]),n(p(a(Ee,X),-T[1]),p(a(he,G),A[1]))),-b[2])),n(p(n(p(a(be,z),v[1]),n(p(a(Ee,X),-b[1]),p(a(H,N),A[1]))),T[2]),p(n(p(a(se,$),v[1]),n(p(a(he,G),-b[1]),p(a(H,N),T[1]))),-A[2]))),y[3]),p(n(n(p(n(p(a(ce,ue),b[1]),n(p(a(be,z),-T[1]),p(a(se,$),A[1]))),y[2]),p(n(p(a(ce,ue),y[1]),n(p(a(ke,M),-T[1]),p(a(ae,L),A[1]))),-b[2])),n(p(n(p(a(be,z),y[1]),n(p(a(ke,M),-b[1]),p(a(Z,E),A[1]))),T[2]),p(n(p(a(se,$),y[1]),n(p(a(ae,L),-b[1]),p(a(Z,E),T[1]))),-A[2]))),-v[3])))),n(n(n(p(n(n(p(n(p(a(ce,ue),v[1]),n(p(a(Ee,X),-T[1]),p(a(he,G),A[1]))),y[2]),p(n(p(a(ce,ue),y[1]),n(p(a(ke,M),-T[1]),p(a(ae,L),A[1]))),-v[2])),n(p(n(p(a(Ee,X),y[1]),n(p(a(ke,M),-v[1]),p(a(D,w),A[1]))),T[2]),p(n(p(a(he,G),y[1]),n(p(a(ae,L),-v[1]),p(a(D,w),T[1]))),-A[2]))),b[3]),p(n(n(p(n(p(a(be,z),v[1]),n(p(a(Ee,X),-b[1]),p(a(H,N),A[1]))),y[2]),p(n(p(a(be,z),y[1]),n(p(a(ke,M),-b[1]),p(a(Z,E),A[1]))),-v[2])),n(p(n(p(a(Ee,X),y[1]),n(p(a(ke,M),-v[1]),p(a(D,w),A[1]))),b[2]),p(n(p(a(H,N),y[1]),n(p(a(Z,E),-v[1]),p(a(D,w),b[1]))),-A[2]))),-T[3])),n(p(n(n(p(n(p(a(se,$),v[1]),n(p(a(he,G),-b[1]),p(a(H,N),T[1]))),y[2]),p(n(p(a(se,$),y[1]),n(p(a(ae,L),-b[1]),p(a(Z,E),T[1]))),-v[2])),n(p(n(p(a(he,G),y[1]),n(p(a(ae,L),-v[1]),p(a(D,w),T[1]))),b[2]),p(n(p(a(H,N),y[1]),n(p(a(Z,E),-v[1]),p(a(D,w),b[1]))),-T[2]))),A[3]),p(n(n(p(n(p(a(de,Q),b[1]),n(p(a(se,$),-x[1]),p(a(J,Y),T[1]))),v[2]),p(n(p(a(de,Q),v[1]),n(p(a(he,G),-x[1]),p(a(ee,U),T[1]))),-b[2])),n(p(n(p(a(se,$),v[1]),n(p(a(he,G),-b[1]),p(a(H,N),T[1]))),x[2]),p(n(p(a(J,Y),v[1]),n(p(a(ee,U),-b[1]),p(a(H,N),x[1]))),-T[2]))),y[3]))),n(n(p(n(n(p(n(p(a(de,Q),b[1]),n(p(a(se,$),-x[1]),p(a(J,Y),T[1]))),y[2]),p(n(p(a(de,Q),y[1]),n(p(a(ae,L),-x[1]),p(a(W,k),T[1]))),-b[2])),n(p(n(p(a(se,$),y[1]),n(p(a(ae,L),-b[1]),p(a(Z,E),T[1]))),x[2]),p(n(p(a(J,Y),y[1]),n(p(a(W,k),-b[1]),p(a(Z,E),x[1]))),-T[2]))),-v[3]),p(n(n(p(n(p(a(de,Q),v[1]),n(p(a(he,G),-x[1]),p(a(ee,U),T[1]))),y[2]),p(n(p(a(de,Q),y[1]),n(p(a(ae,L),-x[1]),p(a(W,k),T[1]))),-v[2])),n(p(n(p(a(he,G),y[1]),n(p(a(ae,L),-v[1]),p(a(D,w),T[1]))),x[2]),p(n(p(a(ee,U),y[1]),n(p(a(W,k),-v[1]),p(a(D,w),x[1]))),-T[2]))),b[3])),n(p(n(n(p(n(p(a(se,$),v[1]),n(p(a(he,G),-b[1]),p(a(H,N),T[1]))),y[2]),p(n(p(a(se,$),y[1]),n(p(a(ae,L),-b[1]),p(a(Z,E),T[1]))),-v[2])),n(p(n(p(a(he,G),y[1]),n(p(a(ae,L),-v[1]),p(a(D,w),T[1]))),b[2]),p(n(p(a(H,N),y[1]),n(p(a(Z,E),-v[1]),p(a(D,w),b[1]))),-T[2]))),-x[3]),p(n(n(p(n(p(a(J,Y),v[1]),n(p(a(ee,U),-b[1]),p(a(H,N),x[1]))),y[2]),p(n(p(a(J,Y),y[1]),n(p(a(W,k),-b[1]),p(a(Z,E),x[1]))),-v[2])),n(p(n(p(a(ee,U),y[1]),n(p(a(W,k),-v[1]),p(a(D,w),x[1]))),b[2]),p(n(p(a(H,N),y[1]),n(p(a(Z,E),-v[1]),p(a(D,w),b[1]))),-x[2]))),T[3]))))),Me=a(ge,we);return Me[Me.length-1]}}var s=[function(){return 0},function(){return 0},function(){return 0}];function i(n){var a=s[n.length];return a||(a=s[n.length]=e(n.length)),a.apply(void 0,n)}function c(n,a,g,p,y,v,b,x){return function(T,A,S,w,E,k){switch(arguments.length){case 0:case 1:return 0;case 2:return p(T,A);case 3:return y(T,A,S);case 4:return v(T,A,S,w);case 5:return b(T,A,S,w,E);case 6:return x(T,A,S,w,E,k)}for(var L=new Array(arguments.length),M=0;M<arguments.length;++M)L[M]=arguments[M];return n(L)}}(function(){for(;s.length<=6;)s.push(e(s.length));I.exports=c.apply(void 0,[i].concat(s));for(var n=0;n<=6;++n)I.exports[n]=s[n]})()},{"robust-scale":536,"robust-subtract":538,"robust-sum":539,"two-product":588}],533:[function(r,I,B){var t=r("robust-determinant");function d(l){var o=l===2?m:h;return o(l<3?t[l]:t)}function m(l){return function(o,u){return[l([[+u[0],+o[0][1]],[+u[1],+o[1][1]]]),l([[+o[0][0],+u[0]],[+o[1][0],+u[1]]]),l(o)]}}function h(l){return function(o,u){return[l([[+u[0],+o[0][1],+o[0][2]],[+u[1],+o[1][1],+o[1][2]],[+u[2],+o[2][1],+o[2][2]]]),l([[+o[0][0],+u[0],+o[0][2]],[+o[1][0],+u[1],+o[1][2]],[+o[2][0],+u[2],+o[2][2]]]),l([[+o[0][0],+o[0][1],+u[0]],[+o[1][0],+o[1][1],+u[1]],[+o[2][0],+o[2][1],+u[2]]]),l(o)]}}var e=[function(){return[[0]]},function(l,o){return[[o[0]],[l[0][0]]]}];function f(l,o,u,s,i,c){return function(n,a){switch(n.length){case 0:return l(n,a);case 1:return o(n,a);case 2:return u(n,a);case 3:return s(n,a)}var g=i[n.length];return g||(g=i[n.length]=c(n.length)),g(n,a)}}(function(){for(;e.length<=3;)e.push(d(e.length));I.exports=f.apply(void 0,e.concat([e,d]));for(var l=0;l<3;++l)I.exports[l]=e[l]})()},{"robust-determinant":530}],534:[function(r,I,B){var t=r("two-product"),d=r("robust-sum"),m=r("robust-scale"),h=r("robust-subtract");function e(a,g,p,y){return function(v,b,x){var T=a(a(g(b[1],x[0]),g(-x[1],b[0])),a(g(v[1],b[0]),g(-b[1],v[0]))),A=a(g(v[1],x[0]),g(-x[1],v[0])),S=y(T,A);return S[S.length-1]}}function f(a,g,p,y){return function(v,b,x,T){var A=a(a(p(a(g(x[1],T[0]),g(-T[1],x[0])),b[2]),a(p(a(g(b[1],T[0]),g(-T[1],b[0])),-x[2]),p(a(g(b[1],x[0]),g(-x[1],b[0])),T[2]))),a(p(a(g(b[1],T[0]),g(-T[1],b[0])),v[2]),a(p(a(g(v[1],T[0]),g(-T[1],v[0])),-b[2]),p(a(g(v[1],b[0]),g(-b[1],v[0])),T[2])))),S=a(a(p(a(g(x[1],T[0]),g(-T[1],x[0])),v[2]),a(p(a(g(v[1],T[0]),g(-T[1],v[0])),-x[2]),p(a(g(v[1],x[0]),g(-x[1],v[0])),T[2]))),a(p(a(g(b[1],x[0]),g(-x[1],b[0])),v[2]),a(p(a(g(v[1],x[0]),g(-x[1],v[0])),-b[2]),p(a(g(v[1],b[0]),g(-b[1],v[0])),x[2])))),w=y(A,S);return w[w.length-1]}}function l(a,g,p,y){return function(v,b,x,T,A){var S=a(a(a(p(a(p(a(g(T[1],A[0]),g(-A[1],T[0])),x[2]),a(p(a(g(x[1],A[0]),g(-A[1],x[0])),-T[2]),p(a(g(x[1],T[0]),g(-T[1],x[0])),A[2]))),b[3]),a(p(a(p(a(g(T[1],A[0]),g(-A[1],T[0])),b[2]),a(p(a(g(b[1],A[0]),g(-A[1],b[0])),-T[2]),p(a(g(b[1],T[0]),g(-T[1],b[0])),A[2]))),-x[3]),p(a(p(a(g(x[1],A[0]),g(-A[1],x[0])),b[2]),a(p(a(g(b[1],A[0]),g(-A[1],b[0])),-x[2]),p(a(g(b[1],x[0]),g(-x[1],b[0])),A[2]))),T[3]))),a(p(a(p(a(g(x[1],T[0]),g(-T[1],x[0])),b[2]),a(p(a(g(b[1],T[0]),g(-T[1],b[0])),-x[2]),p(a(g(b[1],x[0]),g(-x[1],b[0])),T[2]))),-A[3]),a(p(a(p(a(g(T[1],A[0]),g(-A[1],T[0])),b[2]),a(p(a(g(b[1],A[0]),g(-A[1],b[0])),-T[2]),p(a(g(b[1],T[0]),g(-T[1],b[0])),A[2]))),v[3]),p(a(p(a(g(T[1],A[0]),g(-A[1],T[0])),v[2]),a(p(a(g(v[1],A[0]),g(-A[1],v[0])),-T[2]),p(a(g(v[1],T[0]),g(-T[1],v[0])),A[2]))),-b[3])))),a(a(p(a(p(a(g(b[1],A[0]),g(-A[1],b[0])),v[2]),a(p(a(g(v[1],A[0]),g(-A[1],v[0])),-b[2]),p(a(g(v[1],b[0]),g(-b[1],v[0])),A[2]))),T[3]),a(p(a(p(a(g(b[1],T[0]),g(-T[1],b[0])),v[2]),a(p(a(g(v[1],T[0]),g(-T[1],v[0])),-b[2]),p(a(g(v[1],b[0]),g(-b[1],v[0])),T[2]))),-A[3]),p(a(p(a(g(x[1],T[0]),g(-T[1],x[0])),b[2]),a(p(a(g(b[1],T[0]),g(-T[1],b[0])),-x[2]),p(a(g(b[1],x[0]),g(-x[1],b[0])),T[2]))),v[3]))),a(p(a(p(a(g(x[1],T[0]),g(-T[1],x[0])),v[2]),a(p(a(g(v[1],T[0]),g(-T[1],v[0])),-x[2]),p(a(g(v[1],x[0]),g(-x[1],v[0])),T[2]))),-b[3]),a(p(a(p(a(g(b[1],T[0]),g(-T[1],b[0])),v[2]),a(p(a(g(v[1],T[0]),g(-T[1],v[0])),-b[2]),p(a(g(v[1],b[0]),g(-b[1],v[0])),T[2]))),x[3]),p(a(p(a(g(b[1],x[0]),g(-x[1],b[0])),v[2]),a(p(a(g(v[1],x[0]),g(-x[1],v[0])),-b[2]),p(a(g(v[1],b[0]),g(-b[1],v[0])),x[2]))),-T[3]))))),w=a(a(a(p(a(p(a(g(T[1],A[0]),g(-A[1],T[0])),x[2]),a(p(a(g(x[1],A[0]),g(-A[1],x[0])),-T[2]),p(a(g(x[1],T[0]),g(-T[1],x[0])),A[2]))),v[3]),p(a(p(a(g(T[1],A[0]),g(-A[1],T[0])),v[2]),a(p(a(g(v[1],A[0]),g(-A[1],v[0])),-T[2]),p(a(g(v[1],T[0]),g(-T[1],v[0])),A[2]))),-x[3])),a(p(a(p(a(g(x[1],A[0]),g(-A[1],x[0])),v[2]),a(p(a(g(v[1],A[0]),g(-A[1],v[0])),-x[2]),p(a(g(v[1],x[0]),g(-x[1],v[0])),A[2]))),T[3]),p(a(p(a(g(x[1],T[0]),g(-T[1],x[0])),v[2]),a(p(a(g(v[1],T[0]),g(-T[1],v[0])),-x[2]),p(a(g(v[1],x[0]),g(-x[1],v[0])),T[2]))),-A[3]))),a(a(p(a(p(a(g(x[1],A[0]),g(-A[1],x[0])),b[2]),a(p(a(g(b[1],A[0]),g(-A[1],b[0])),-x[2]),p(a(g(b[1],x[0]),g(-x[1],b[0])),A[2]))),v[3]),p(a(p(a(g(x[1],A[0]),g(-A[1],x[0])),v[2]),a(p(a(g(v[1],A[0]),g(-A[1],v[0])),-x[2]),p(a(g(v[1],x[0]),g(-x[1],v[0])),A[2]))),-b[3])),a(p(a(p(a(g(b[1],A[0]),g(-A[1],b[0])),v[2]),a(p(a(g(v[1],A[0]),g(-A[1],v[0])),-b[2]),p(a(g(v[1],b[0]),g(-b[1],v[0])),A[2]))),x[3]),p(a(p(a(g(b[1],x[0]),g(-x[1],b[0])),v[2]),a(p(a(g(v[1],x[0]),g(-x[1],v[0])),-b[2]),p(a(g(v[1],b[0]),g(-b[1],v[0])),x[2]))),-A[3])))),E=y(S,w);return E[E.length-1]}}function o(a){return(a===3?e:a===4?f:l)(d,t,m,h)}var u=o(3),s=o(4),i=[function(){return 0},function(){return 0},function(a,g){return g[0]-a[0]},function(a,g,p){var y,v=(a[1]-p[1])*(g[0]-p[0]),b=(a[0]-p[0])*(g[1]-p[1]),x=v-b;if(v>0){if(b<=0)return x;y=v+b}else{if(!(v<0)||b>=0)return x;y=-(v+b)}var T=33306690738754716e-32*y;return x>=T||x<=-T?x:u(a,g,p)},function(a,g,p,y){var v=a[0]-y[0],b=g[0]-y[0],x=p[0]-y[0],T=a[1]-y[1],A=g[1]-y[1],S=p[1]-y[1],w=a[2]-y[2],E=g[2]-y[2],k=p[2]-y[2],L=b*S,M=x*A,P=x*T,D=v*S,N=v*A,U=b*T,G=w*(L-M)+E*(P-D)+k*(N-U),X=7771561172376103e-31*((Math.abs(L)+Math.abs(M))*Math.abs(w)+(Math.abs(P)+Math.abs(D))*Math.abs(E)+(Math.abs(N)+Math.abs(U))*Math.abs(k));return G>X||-G>X?G:s(a,g,p,y)}];function c(a){var g=i[a.length];return g||(g=i[a.length]=o(a.length)),g.apply(void 0,a)}function n(a,g,p,y,v,b,x){return function(T,A,S,w,E){switch(arguments.length){case 0:case 1:return 0;case 2:return y(T,A);case 3:return v(T,A,S);case 4:return b(T,A,S,w);case 5:return x(T,A,S,w,E)}for(var k=new Array(arguments.length),L=0;L<arguments.length;++L)k[L]=arguments[L];return a(k)}}(function(){for(;i.length<=5;)i.push(o(i.length));I.exports=n.apply(void 0,[c].concat(i));for(var a=0;a<=5;++a)I.exports[a]=i[a]})()},{"robust-scale":536,"robust-subtract":538,"robust-sum":539,"two-product":588}],535:[function(r,I,B){var t=r("robust-sum"),d=r("robust-scale");I.exports=function(m,h){if(m.length===1)return d(h,m[0]);if(h.length===1)return d(m,h[0]);if(m.length===0||h.length===0)return[0];var e=[0];if(m.length<h.length)for(var f=0;f<m.length;++f)e=t(e,d(h,m[f]));else for(f=0;f<h.length;++f)e=t(e,d(m,h[f]));return e}},{"robust-scale":536,"robust-sum":539}],536:[function(r,I,B){var t=r("two-product"),d=r("two-sum");I.exports=function(m,h){var e=m.length;if(e===1){var f=t(m[0],h);return f[0]?f:[f[1]]}var l=new Array(2*e),o=[.1,.1],u=[.1,.1],s=0;t(m[0],h,o),o[0]&&(l[s++]=o[0]);for(var i=1;i<e;++i){t(m[i],h,u);var c=o[1];d(c,u[0],o),o[0]&&(l[s++]=o[0]);var n=u[1],a=o[1],g=n+a,p=a-(g-n);o[1]=g,p&&(l[s++]=p)}return o[1]&&(l[s++]=o[1]),s===0&&(l[s++]=0),l.length=s,l}},{"two-product":588,"two-sum":589}],537:[function(r,I,B){I.exports=function(d,m,h,e){var f=t(d,h,e),l=t(m,h,e);if(f>0&&l>0||f<0&&l<0)return!1;var o=t(h,d,m),u=t(e,d,m);return o>0&&u>0||o<0&&u<0?!1:f===0&&l===0&&o===0&&u===0?function(s,i,c,n){for(var a=0;a<2;++a){var g=s[a],p=i[a],y=Math.min(g,p),v=Math.max(g,p),b=c[a],x=n[a],T=Math.min(b,x);if(Math.max(b,x)<y||v<T)return!1}return!0}(d,m,h,e):!0};var t=r("robust-orientation")[3]},{"robust-orientation":534}],538:[function(r,I,B){I.exports=function(t,d){var m=0|t.length,h=0|d.length;if(m===1&&h===1)return function(S,w){var E=S+w,k=E-S,L=S-(E-k)+(w-k);return L?[L,E]:[E]}(t[0],-d[0]);var e,f,l=new Array(m+h),o=0,u=0,s=0,i=Math.abs,c=t[u],n=i(c),a=-d[s],g=i(a);n<g?(f=c,(u+=1)<m&&(c=t[u],n=i(c))):(f=a,(s+=1)<h&&(a=-d[s],g=i(a))),u<m&&n<g||s>=h?(e=c,(u+=1)<m&&(c=t[u],n=i(c))):(e=a,(s+=1)<h&&(a=-d[s],g=i(a)));for(var p,y,v=e+f,b=v-e,x=f-b,T=x,A=v;u<m&&s<h;)n<g?(e=c,(u+=1)<m&&(c=t[u],n=i(c))):(e=a,(s+=1)<h&&(a=-d[s],g=i(a))),(x=(f=T)-(b=(v=e+f)-e))&&(l[o++]=x),T=A-((p=A+v)-(y=p-A))+(v-y),A=p;for(;u<m;)(x=(f=T)-(b=(v=(e=c)+f)-e))&&(l[o++]=x),T=A-((p=A+v)-(y=p-A))+(v-y),A=p,(u+=1)<m&&(c=t[u]);for(;s<h;)(x=(f=T)-(b=(v=(e=a)+f)-e))&&(l[o++]=x),T=A-((p=A+v)-(y=p-A))+(v-y),A=p,(s+=1)<h&&(a=-d[s]);return T&&(l[o++]=T),A&&(l[o++]=A),o||(l[o++]=0),l.length=o,l}},{}],539:[function(r,I,B){I.exports=function(t,d){var m=0|t.length,h=0|d.length;if(m===1&&h===1)return function(S,w){var E=S+w,k=E-S,L=S-(E-k)+(w-k);return L?[L,E]:[E]}(t[0],d[0]);var e,f,l=new Array(m+h),o=0,u=0,s=0,i=Math.abs,c=t[u],n=i(c),a=d[s],g=i(a);n<g?(f=c,(u+=1)<m&&(c=t[u],n=i(c))):(f=a,(s+=1)<h&&(a=d[s],g=i(a))),u<m&&n<g||s>=h?(e=c,(u+=1)<m&&(c=t[u],n=i(c))):(e=a,(s+=1)<h&&(a=d[s],g=i(a)));for(var p,y,v=e+f,b=v-e,x=f-b,T=x,A=v;u<m&&s<h;)n<g?(e=c,(u+=1)<m&&(c=t[u],n=i(c))):(e=a,(s+=1)<h&&(a=d[s],g=i(a))),(x=(f=T)-(b=(v=e+f)-e))&&(l[o++]=x),T=A-((p=A+v)-(y=p-A))+(v-y),A=p;for(;u<m;)(x=(f=T)-(b=(v=(e=c)+f)-e))&&(l[o++]=x),T=A-((p=A+v)-(y=p-A))+(v-y),A=p,(u+=1)<m&&(c=t[u]);for(;s<h;)(x=(f=T)-(b=(v=(e=a)+f)-e))&&(l[o++]=x),T=A-((p=A+v)-(y=p-A))+(v-y),A=p,(s+=1)<h&&(a=d[s]);return T&&(l[o++]=T),A&&(l[o++]=A),o||(l[o++]=0),l.length=o,l}},{}],540:[function(r,I,B){var t=r("buffer"),d=t.Buffer;function m(e,f){for(var l in e)f[l]=e[l]}function h(e,f,l){return d(e,f,l)}d.from&&d.alloc&&d.allocUnsafe&&d.allocUnsafeSlow?I.exports=t:(m(t,B),B.Buffer=h),h.prototype=Object.create(d.prototype),m(d,h),h.from=function(e,f,l){if(typeof e=="number")throw new TypeError("Argument must not be a number");return d(e,f,l)},h.alloc=function(e,f,l){if(typeof e!="number")throw new TypeError("Argument must be a number");var o=d(e);return f!==void 0?typeof l=="string"?o.fill(f,l):o.fill(f):o.fill(0),o},h.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return d(e)},h.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(e)}},{buffer:117}],541:[function(r,I,B){I.exports=function(t){return t<0?-1:t>0?1:0}},{}],542:[function(r,I,B){I.exports=function(m){return d(t(m))};var t=r("boundary-cells"),d=r("reduce-simplicial-complex")},{"boundary-cells":107,"reduce-simplicial-complex":521}],543:[function(r,I,B){I.exports=function(e,f,l,o){if(l=l||0,o===void 0&&(o=function(p){for(var y=p.length,v=0,b=0;b<y;++b)v=0|Math.max(v,p[b].length);return v-1}(e)),e.length===0||o<1)return{cells:[],vertexIds:[],vertexWeights:[]};var u=function(p,y){for(var v=p.length,b=d.mallocUint8(v),x=0;x<v;++x)b[x]=p[x]<y|0;return b}(f,+l),s=function(p,y){for(var v=p.length,b=y*(y+1)/2*v|0,x=d.mallocUint32(2*b),T=0,A=0;A<v;++A)for(var S=p[A],w=(y=S.length,0);w<y;++w)for(var E=0;E<w;++E){var k=S[E],L=S[w];x[T++]=0|Math.min(k,L),x[T++]=0|Math.max(k,L)}m(t(x,[T/2|0,2]));var M=2;for(A=2;A<T;A+=2)x[A-2]===x[A]&&x[A-1]===x[A+1]||(x[M++]=x[A],x[M++]=x[A+1]);return t(x,[M/2|0,2])}(e,o),i=function(p,y,v,b){for(var x=p.data,T=p.shape[0],A=d.mallocDouble(T),S=0,w=0;w<T;++w){var E=x[2*w],k=x[2*w+1];if(v[E]!==v[k]){var L=y[E],M=y[k];x[2*S]=E,x[2*S+1]=k,A[S++]=(M-b)/(M-L)}}return p.shape[0]=S,t(A,[S])}(s,f,u,+l),c=function(p,y){var v=d.mallocInt32(2*y),b=p.shape[0],x=p.data;v[0]=0;for(var T=0,A=0;A<b;++A){var S=x[2*A];if(S!==T){for(v[2*T+1]=A;++T<S;)v[2*T]=A,v[2*T+1]=A;v[2*T]=A}}for(v[2*T+1]=b;++T<y;)v[2*T]=v[2*T+1]=b;return v}(s,0|f.length),n=h(o)(e,s.data,c,u),a=function(p){for(var y=0|p.shape[0],v=p.data,b=new Array(y),x=0;x<y;++x)b[x]=[v[2*x],v[2*x+1]];return b}(s),g=[].slice.call(i.data,0,i.shape[0]);return d.free(u),d.free(s.data),d.free(i.data),d.free(c),{cells:n,vertexIds:a,vertexWeights:g}};var t=r("ndarray"),d=r("typedarray-pool"),m=r("ndarray-sort"),h=r("./lib/codegen")},{"./lib/codegen":544,ndarray:472,"ndarray-sort":471,"typedarray-pool":601}],544:[function(r,I,B){I.exports=function(d){return t[d]()};var t=[function(){return function(d,m,h,e){for(var f=d.length,l=0;l<f;++l)d[l].length;return[]}},function(){function d(m,h,e,f){for(var l=0|Math.min(e,f),o=0|Math.max(e,f),u=m[2*l],s=m[2*l+1];u<s;){var i=u+s>>1,c=h[2*i+1];if(c===o)return i;o<c?s=i:u=i+1}return u}return function(m,h,e,f){for(var l=m.length,o=[],u=0;u<l;++u){var s=m[u];if(s.length===2){var i=(f[s[0]]<<0)+(f[s[1]]<<1);if(i===0||i===3)continue;switch(i){case 0:break;case 1:o.push([d(e,h,s[0],s[1])]);break;case 2:o.push([d(e,h,s[1],s[0])])}}}return o}},function(){function d(m,h,e,f){for(var l=0|Math.min(e,f),o=0|Math.max(e,f),u=m[2*l],s=m[2*l+1];u<s;){var i=u+s>>1,c=h[2*i+1];if(c===o)return i;o<c?s=i:u=i+1}return u}return function(m,h,e,f){for(var l=m.length,o=[],u=0;u<l;++u){var s=m[u],i=s.length;if(i===3){if((c=(f[s[0]]<<0)+(f[s[1]]<<1)+(f[s[2]]<<2))==0||c===7)continue;switch(c){case 0:break;case 1:o.push([d(e,h,s[0],s[2]),d(e,h,s[0],s[1])]);break;case 2:o.push([d(e,h,s[1],s[0]),d(e,h,s[1],s[2])]);break;case 3:o.push([d(e,h,s[0],s[2]),d(e,h,s[1],s[2])]);break;case 4:o.push([d(e,h,s[2],s[1]),d(e,h,s[2],s[0])]);break;case 5:o.push([d(e,h,s[2],s[1]),d(e,h,s[0],s[1])]);break;case 6:o.push([d(e,h,s[1],s[0]),d(e,h,s[2],s[0])])}}else if(i===2){var c;if((c=(f[s[0]]<<0)+(f[s[1]]<<1))==0||c===3)continue;switch(c){case 0:break;case 1:o.push([d(e,h,s[0],s[1])]);break;case 2:o.push([d(e,h,s[1],s[0])])}}}return o}},function(){function d(m,h,e,f){for(var l=0|Math.min(e,f),o=0|Math.max(e,f),u=m[2*l],s=m[2*l+1];u<s;){var i=u+s>>1,c=h[2*i+1];if(c===o)return i;o<c?s=i:u=i+1}return u}return function(m,h,e,f){for(var l=m.length,o=[],u=0;u<l;++u){var s=m[u],i=s.length;if(i===4){if((c=(f[s[0]]<<0)+(f[s[1]]<<1)+(f[s[2]]<<2)+(f[s[3]]<<3))==0||c===15)continue;switch(c){case 0:break;case 1:o.push([d(e,h,s[0],s[1]),d(e,h,s[0],s[2]),d(e,h,s[0],s[3])]);break;case 2:o.push([d(e,h,s[1],s[2]),d(e,h,s[1],s[0]),d(e,h,s[1],s[3])]);break;case 3:o.push([d(e,h,s[1],s[2]),d(e,h,s[0],s[2]),d(e,h,s[0],s[3])],[d(e,h,s[1],s[3]),d(e,h,s[1],s[2]),d(e,h,s[0],s[3])]);break;case 4:o.push([d(e,h,s[2],s[0]),d(e,h,s[2],s[1]),d(e,h,s[2],s[3])]);break;case 5:o.push([d(e,h,s[0],s[1]),d(e,h,s[2],s[1]),d(e,h,s[0],s[3])],[d(e,h,s[2],s[1]),d(e,h,s[2],s[3]),d(e,h,s[0],s[3])]);break;case 6:o.push([d(e,h,s[2],s[0]),d(e,h,s[1],s[0]),d(e,h,s[1],s[3])],[d(e,h,s[2],s[3]),d(e,h,s[2],s[0]),d(e,h,s[1],s[3])]);break;case 7:o.push([d(e,h,s[0],s[3]),d(e,h,s[1],s[3]),d(e,h,s[2],s[3])]);break;case 8:o.push([d(e,h,s[3],s[1]),d(e,h,s[3],s[0]),d(e,h,s[3],s[2])]);break;case 9:o.push([d(e,h,s[3],s[1]),d(e,h,s[0],s[1]),d(e,h,s[0],s[2])],[d(e,h,s[3],s[2]),d(e,h,s[3],s[1]),d(e,h,s[0],s[2])]);break;case 10:o.push([d(e,h,s[1],s[0]),d(e,h,s[3],s[0]),d(e,h,s[1],s[2])],[d(e,h,s[3],s[0]),d(e,h,s[3],s[2]),d(e,h,s[1],s[2])]);break;case 11:o.push([d(e,h,s[1],s[2]),d(e,h,s[0],s[2]),d(e,h,s[3],s[2])]);break;case 12:o.push([d(e,h,s[3],s[0]),d(e,h,s[2],s[0]),d(e,h,s[2],s[1])],[d(e,h,s[3],s[1]),d(e,h,s[3],s[0]),d(e,h,s[2],s[1])]);break;case 13:o.push([d(e,h,s[0],s[1]),d(e,h,s[2],s[1]),d(e,h,s[3],s[1])]);break;case 14:o.push([d(e,h,s[2],s[0]),d(e,h,s[1],s[0]),d(e,h,s[3],s[0])])}}else if(i===3){if((c=(f[s[0]]<<0)+(f[s[1]]<<1)+(f[s[2]]<<2))==0||c===7)continue;switch(c){case 0:break;case 1:o.push([d(e,h,s[0],s[2]),d(e,h,s[0],s[1])]);break;case 2:o.push([d(e,h,s[1],s[0]),d(e,h,s[1],s[2])]);break;case 3:o.push([d(e,h,s[0],s[2]),d(e,h,s[1],s[2])]);break;case 4:o.push([d(e,h,s[2],s[1]),d(e,h,s[2],s[0])]);break;case 5:o.push([d(e,h,s[2],s[1]),d(e,h,s[0],s[1])]);break;case 6:o.push([d(e,h,s[1],s[0]),d(e,h,s[2],s[0])])}}else if(i===2){var c;if((c=(f[s[0]]<<0)+(f[s[1]]<<1))==0||c===3)continue;switch(c){case 0:break;case 1:o.push([d(e,h,s[0],s[1])]);break;case 2:o.push([d(e,h,s[1],s[0])])}}}return o}}]},{}],545:[function(r,I,B){var t=r("bit-twiddle"),d=r("union-find");function m(s,i){var c=s.length,n=s.length-i.length,a=Math.min;if(n)return n;switch(c){case 0:return 0;case 1:return s[0]-i[0];case 2:return(y=s[0]+s[1]-i[0]-i[1])||a(s[0],s[1])-a(i[0],i[1]);case 3:var g=s[0]+s[1],p=i[0]+i[1];if(y=g+s[2]-(p+i[2]))return y;var y,v=a(s[0],s[1]),b=a(i[0],i[1]);return(y=a(v,s[2])-a(b,i[2]))||a(v+s[2],g)-a(b+i[2],p);default:var x=s.slice(0);x.sort();var T=i.slice(0);T.sort();for(var A=0;A<c;++A)if(n=x[A]-T[A])return n;return 0}}function h(s,i){return m(s[0],i[0])}function e(s,i){if(i){for(var c=s.length,n=new Array(c),a=0;a<c;++a)n[a]=[s[a],i[a]];for(n.sort(h),a=0;a<c;++a)s[a]=n[a][0],i[a]=n[a][1];return s}return s.sort(m),s}function f(s){if(s.length===0)return[];for(var i=1,c=s.length,n=1;n<c;++n){var a=s[n];if(m(a,s[n-1])){if(n===i){i++;continue}s[i++]=a}}return s.length=i,s}function l(s,i){for(var c=0,n=s.length-1,a=-1;c<=n;){var g=c+n>>1,p=m(s[g],i);p<=0?(p===0&&(a=g),c=g+1):p>0&&(n=g-1)}return a}function o(s,i){for(var c=new Array(s.length),n=0,a=c.length;n<a;++n)c[n]=[];for(var g=[],p=(n=0,i.length);n<p;++n)for(var y=i[n],v=y.length,b=1,x=1<<v;b<x;++b){g.length=t.popCount(b);for(var T=0,A=0;A<v;++A)b&1<<A&&(g[T++]=y[A]);var S=l(s,g);if(!(S<0))for(;c[S++].push(n),!(S>=s.length||m(s[S],g)!==0););}return c}function u(s,i){if(i<0)return[];for(var c=[],n=(1<<i+1)-1,a=0;a<s.length;++a)for(var g=s[a],p=n;p<1<<g.length;p=t.nextCombination(p)){for(var y=new Array(i+1),v=0,b=0;b<g.length;++b)p&1<<b&&(y[v++]=g[b]);c.push(y)}return e(c)}B.dimension=function(s){for(var i=0,c=Math.max,n=0,a=s.length;n<a;++n)i=c(i,s[n].length);return i-1},B.countVertices=function(s){for(var i=-1,c=Math.max,n=0,a=s.length;n<a;++n)for(var g=s[n],p=0,y=g.length;p<y;++p)i=c(i,g[p]);return i+1},B.cloneCells=function(s){for(var i=new Array(s.length),c=0,n=s.length;c<n;++c)i[c]=s[c].slice(0);return i},B.compareCells=m,B.normalize=e,B.unique=f,B.findCell=l,B.incidence=o,B.dual=function(s,i){if(!i)return o(f(u(s,0)),s);for(var c=new Array(i),n=0;n<i;++n)c[n]=[];n=0;for(var a=s.length;n<a;++n)for(var g=s[n],p=0,y=g.length;p<y;++p)c[g[p]].push(n);return c},B.explode=function(s){for(var i=[],c=0,n=s.length;c<n;++c)for(var a=s[c],g=0|a.length,p=1,y=1<<g;p<y;++p){for(var v=[],b=0;b<g;++b)p>>>b&1&&v.push(a[b]);i.push(v)}return e(i)},B.skeleton=u,B.boundary=function(s){for(var i=[],c=0,n=s.length;c<n;++c)for(var a=s[c],g=0,p=a.length;g<p;++g){for(var y=new Array(a.length-1),v=0,b=0;v<p;++v)v!==g&&(y[b++]=a[v]);i.push(y)}return e(i)},B.connectedComponents=function(s,i){return i?function(c,n){for(var a=new d(n),g=0;g<c.length;++g)for(var p=c[g],y=0;y<p.length;++y)for(var v=y+1;v<p.length;++v)a.link(p[y],p[v]);var b=[],x=a.ranks;for(g=0;g<x.length;++g)x[g]=-1;for(g=0;g<c.length;++g){var T=a.find(c[g][0]);x[T]<0?(x[T]=b.length,b.push([c[g].slice(0)])):b[x[T]].push(c[g].slice(0))}return b}(s,i):function(c){for(var n=f(e(u(c,0))),a=new d(n.length),g=0;g<c.length;++g)for(var p=c[g],y=0;y<p.length;++y)for(var v=l(n,[p[y]]),b=y+1;b<p.length;++b)a.link(v,l(n,[p[b]]));var x=[],T=a.ranks;for(g=0;g<T.length;++g)T[g]=-1;for(g=0;g<c.length;++g){var A=a.find(l(n,[c[g][0]]));T[A]<0?(T[A]=x.length,x.push([c[g].slice(0)])):x[T[A]].push(c[g].slice(0))}return x}(s)}},{"bit-twiddle":104,"union-find":602}],546:[function(r,I,B){arguments[4][104][0].apply(B,arguments)},{dup:104}],547:[function(r,I,B){arguments[4][545][0].apply(B,arguments)},{"bit-twiddle":546,dup:545,"union-find":548}],548:[function(r,I,B){function t(d){this.roots=new Array(d),this.ranks=new Array(d);for(var m=0;m<d;++m)this.roots[m]=m,this.ranks[m]=0}I.exports=t,t.prototype.length=function(){return this.roots.length},t.prototype.makeSet=function(){var d=this.roots.length;return this.roots.push(d),this.ranks.push(0),d},t.prototype.find=function(d){for(var m=this.roots;m[d]!==d;){var h=m[d];m[d]=m[h],d=h}return d},t.prototype.link=function(d,m){var h=this.find(d),e=this.find(m);if(h!==e){var f=this.ranks,l=this.roots,o=f[h],u=f[e];o<u?l[h]=e:u<o?l[e]=h:(l[e]=h,++f[h])}}},{}],549:[function(r,I,B){I.exports=function(m,h,e){for(var f=h.length,l=m.length,o=new Array(f),u=new Array(f),s=new Array(f),i=new Array(f),c=0;c<f;++c)o[c]=u[c]=-1,s[c]=1/0,i[c]=!1;for(c=0;c<l;++c){var n=m[c];if(n.length!==2)throw new Error("Input must be a graph");var a=n[1],g=n[0];u[g]!==-1?u[g]=-2:u[g]=a,o[a]!==-1?o[a]=-2:o[a]=g}function p(U){if(i[U])return 1/0;var G,X,K,Z,H,Y=o[U],$=u[U];return Y<0||$<0?1/0:(G=h[U],X=h[Y],K=h[$],Z=Math.abs(t(G,X,K)),H=Math.sqrt(Math.pow(X[0]-K[0],2)+Math.pow(X[1]-K[1],2)),Z/H)}function y(U,G){var X=E[U],K=E[G];E[U]=K,E[G]=X,k[X]=G,k[K]=U}function v(U){return s[E[U]]}function b(U){return 1&U?U-1>>1:(U>>1)-1}function x(U){for(var G=v(U);;){var X=G,K=2*U+1,Z=2*(U+1),H=U;if(K<L){var Y=v(K);Y<X&&(H=K,X=Y)}if(Z<L&&v(Z)<X&&(H=Z),H===U)return U;y(U,H),U=H}}function T(U){for(var G=v(U);U>0;){var X=b(U);if(X>=0&&G<v(X)){y(U,X),U=X;continue}return U}}function A(){if(L>0){var U=E[0];return y(0,L-1),L-=1,x(0),U}return-1}function S(U,G){var X=E[U];return s[X]===G?U:(s[X]=-1/0,T(U),A(),s[X]=G,T((L+=1)-1))}function w(U){if(!i[U]){i[U]=!0;var G=o[U],X=u[U];o[X]>=0&&(o[X]=G),u[G]>=0&&(u[G]=X),k[G]>=0&&S(k[G],p(G)),k[X]>=0&&S(k[X],p(X))}}var E=[],k=new Array(f);for(c=0;c<f;++c)(s[c]=p(c))<1/0?(k[c]=E.length,E.push(c)):k[c]=-1;var L=E.length;for(c=L>>1;c>=0;--c)x(c);for(;;){var M=A();if(M<0||s[M]>e)break;w(M)}var P=[];for(c=0;c<f;++c)i[c]||(k[c]=P.length,P.push(h[c].slice()));P.length;function D(U,G){if(U[G]<0)return G;var X=G,K=G;do{var Z=U[K];if(!i[K]||Z<0||Z===K||(Z=U[K=Z],!i[K]||Z<0||Z===K))break;K=Z,X=U[X]}while(X!==K);for(var H=G;H!==K;H=U[H])U[H]=K;return K}var N=[];return m.forEach(function(U){var G=D(o,U[0]),X=D(u,U[1]);if(G>=0&&X>=0&&G!==X){var K=k[G],Z=k[X];K!==Z&&N.push([K,Z])}}),d.unique(d.normalize(N)),{positions:P,edges:N}};var t=r("robust-orientation"),d=r("simplicial-complex")},{"robust-orientation":534,"simplicial-complex":547}],550:[function(r,I,B){I.exports=function(m,h){var e,f,l,o;if(h[0][0]<h[1][0])e=h[0],f=h[1];else{if(!(h[0][0]>h[1][0]))return d(h,m);e=h[1],f=h[0]}if(m[0][0]<m[1][0])l=m[0],o=m[1];else{if(!(m[0][0]>m[1][0]))return-d(m,h);l=m[1],o=m[0]}var u=t(e,f,o),s=t(e,f,l);if(u<0){if(s<=0)return u}else if(u>0){if(s>=0)return u}else if(s)return s;if(u=t(o,l,f),s=t(o,l,e),u<0){if(s<=0)return u}else if(u>0){if(s>=0)return u}else if(s)return s;return f[0]-o[0]};var t=r("robust-orientation");function d(m,h){var e,f,l,o;if(h[0][0]<h[1][0])e=h[0],f=h[1];else{if(!(h[0][0]>h[1][0])){var u=Math.min(m[0][1],m[1][1]),s=Math.max(m[0][1],m[1][1]),i=Math.min(h[0][1],h[1][1]),c=Math.max(h[0][1],h[1][1]);return s<i?s-i:u>c?u-c:s-c}e=h[1],f=h[0]}m[0][1]<m[1][1]?(l=m[0],o=m[1]):(l=m[1],o=m[0]);var n=t(f,e,l);return n||(n=t(f,e,o))||o-f}},{"robust-orientation":534}],551:[function(r,I,B){I.exports=function(s){for(var i=s.length,c=2*i,n=new Array(c),a=0;a<i;++a){var g=s[a],p=g[0][0]<g[1][0];n[2*a]=new u(g[0][0],g,p,a),n[2*a+1]=new u(g[1][0],g,!p,a)}n.sort(function(w,E){var k=w.x-E.x;return k||(k=w.create-E.create)||Math.min(w.segment[0][1],w.segment[1][1])-Math.min(E.segment[0][1],E.segment[1][1])});var y=d(h),v=[],b=[],x=[];for(a=0;a<c;){for(var T=n[a].x,A=[];a<c;){var S=n[a];if(S.x!==T)break;a+=1,S.segment[0][0]===S.x&&S.segment[1][0]===S.x?S.create&&(S.segment[0][1]<S.segment[1][1]?(A.push(new o(S.segment[0][1],S.index,!0,!0)),A.push(new o(S.segment[1][1],S.index,!1,!1))):(A.push(new o(S.segment[1][1],S.index,!0,!1)),A.push(new o(S.segment[0][1],S.index,!1,!0)))):y=S.create?y.insert(S.segment,S.index):y.remove(S.segment)}v.push(y.root),b.push(T),x.push(A)}return new e(v,b,x)};var t=r("binary-search-bounds"),d=r("functional-red-black-tree"),m=r("robust-orientation"),h=r("./lib/order-segments");function e(s,i,c){this.slabs=s,this.coordinates=i,this.horizontal=c}function f(s,i){return s.y-i}function l(s,i){for(var c=null;s;){var n,a,g=s.key;g[0][0]<g[1][0]?(n=g[0],a=g[1]):(n=g[1],a=g[0]);var p=m(n,a,i);if(p<0)s=s.left;else if(p>0)if(i[0]!==g[1][0])c=s,s=s.right;else{if(y=l(s.right,i))return y;s=s.left}else{if(i[0]!==g[1][0])return s;var y;if(y=l(s.right,i))return y;s=s.left}}return c}function o(s,i,c,n){this.y=s,this.index=i,this.start=c,this.closed=n}function u(s,i,c,n){this.x=s,this.segment=i,this.create=c,this.index=n}e.prototype.castUp=function(s){var i=t.le(this.coordinates,s[0]);if(i<0)return-1;this.slabs[i];var c=l(this.slabs[i],s),n=-1;if(c&&(n=c.value),this.coordinates[i]===s[0]){var a=null;if(c&&(a=c.key),i>0){var g=l(this.slabs[i-1],s);g&&(a?h(g.key,a)>0&&(a=g.key,n=g.value):(n=g.value,a=g.key))}var p=this.horizontal[i];if(p.length>0){var y=t.ge(p,s[1],f);if(y<p.length){var v=p[y];if(s[1]===v.y){if(v.closed)return v.index;for(;y<p.length-1&&p[y+1].y===s[1];)if((v=p[y+=1]).closed)return v.index;if(v.y===s[1]&&!v.start){if((y+=1)>=p.length)return n;v=p[y]}}if(v.start)if(a){var b=m(a[0],a[1],[s[0],v.y]);a[0][0]>a[1][0]&&(b=-b),b>0&&(n=v.index)}else n=v.index;else v.y!==s[1]&&(n=v.index)}}}return n}},{"./lib/order-segments":550,"binary-search-bounds":103,"functional-red-black-tree":251,"robust-orientation":534}],552:[function(r,I,B){var t=r("robust-dot-product"),d=r("robust-sum");function m(e,f){var l=d(t(e,f),[f[f.length-1]]);return l[l.length-1]}function h(e,f,l,o){var u=-f/(o-f);u<0?u=0:u>1&&(u=1);for(var s=1-u,i=e.length,c=new Array(i),n=0;n<i;++n)c[n]=u*e[n]+s*l[n];return c}I.exports=function(e,f){for(var l=[],o=[],u=m(e[e.length-1],f),s=e[e.length-1],i=e[0],c=0;c<e.length;++c,s=i){var n=m(i=e[c],f);if(u<0&&n>0||u>0&&n<0){var a=h(s,n,i,u);l.push(a),o.push(a.slice())}n<0?o.push(i.slice()):n>0?l.push(i.slice()):(l.push(i.slice()),o.push(i.slice())),u=n}return{positive:l,negative:o}},I.exports.positive=function(e,f){for(var l=[],o=m(e[e.length-1],f),u=e[e.length-1],s=e[0],i=0;i<e.length;++i,u=s){var c=m(s=e[i],f);(o<0&&c>0||o>0&&c<0)&&l.push(h(u,c,s,o)),c>=0&&l.push(s.slice()),o=c}return l},I.exports.negative=function(e,f){for(var l=[],o=m(e[e.length-1],f),u=e[e.length-1],s=e[0],i=0;i<e.length;++i,u=s){var c=m(s=e[i],f);(o<0&&c>0||o>0&&c<0)&&l.push(h(u,c,s,o)),c<=0&&l.push(s.slice()),o=c}return l}},{"robust-dot-product":531,"robust-sum":539}],553:[function(r,I,B){(function(){var t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function d(l){return h(f(l),arguments)}function m(l,o){return d.apply(null,[l].concat(o||[]))}function h(l,o){var u,s,i,c,n,a,g,p,y,v=1,b=l.length,x="";for(s=0;s<b;s++)if(typeof l[s]=="string")x+=l[s];else if(typeof l[s]=="object"){if((c=l[s]).keys)for(u=o[v],i=0;i<c.keys.length;i++){if(u==null)throw new Error(d('[sprintf] Cannot access property "%s" of undefined value "%s"',c.keys[i],c.keys[i-1]));u=u[c.keys[i]]}else u=c.param_no?o[c.param_no]:o[v++];if(t.not_type.test(c.type)&&t.not_primitive.test(c.type)&&u instanceof Function&&(u=u()),t.numeric_arg.test(c.type)&&typeof u!="number"&&isNaN(u))throw new TypeError(d("[sprintf] expecting number but found %T",u));switch(t.number.test(c.type)&&(p=u>=0),c.type){case"b":u=parseInt(u,10).toString(2);break;case"c":u=String.fromCharCode(parseInt(u,10));break;case"d":case"i":u=parseInt(u,10);break;case"j":u=JSON.stringify(u,null,c.width?parseInt(c.width):0);break;case"e":u=c.precision?parseFloat(u).toExponential(c.precision):parseFloat(u).toExponential();break;case"f":u=c.precision?parseFloat(u).toFixed(c.precision):parseFloat(u);break;case"g":u=c.precision?String(Number(u.toPrecision(c.precision))):parseFloat(u);break;case"o":u=(parseInt(u,10)>>>0).toString(8);break;case"s":u=String(u),u=c.precision?u.substring(0,c.precision):u;break;case"t":u=String(!!u),u=c.precision?u.substring(0,c.precision):u;break;case"T":u=Object.prototype.toString.call(u).slice(8,-1).toLowerCase(),u=c.precision?u.substring(0,c.precision):u;break;case"u":u=parseInt(u,10)>>>0;break;case"v":u=u.valueOf(),u=c.precision?u.substring(0,c.precision):u;break;case"x":u=(parseInt(u,10)>>>0).toString(16);break;case"X":u=(parseInt(u,10)>>>0).toString(16).toUpperCase()}t.json.test(c.type)?x+=u:(!t.number.test(c.type)||p&&!c.sign?y="":(y=p?"+":"-",u=u.toString().replace(t.sign,"")),a=c.pad_char?c.pad_char==="0"?"0":c.pad_char.charAt(1):" ",g=c.width-(y+u).length,n=c.width&&g>0?a.repeat(g):"",x+=c.align?y+u+n:a==="0"?y+n+u:n+y+u)}return x}var e=Object.create(null);function f(l){if(e[l])return e[l];for(var o,u=l,s=[],i=0;u;){if((o=t.text.exec(u))!==null)s.push(o[0]);else if((o=t.modulo.exec(u))!==null)s.push("%");else{if((o=t.placeholder.exec(u))===null)throw new SyntaxError("[sprintf] unexpected placeholder");if(o[2]){i|=1;var c=[],n=o[2],a=[];if((a=t.key.exec(n))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");for(c.push(a[1]);(n=n.substring(a[0].length))!=="";)if((a=t.key_access.exec(n))!==null)c.push(a[1]);else{if((a=t.index_access.exec(n))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");c.push(a[1])}o[2]=c}else i|=2;if(i===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");s.push({placeholder:o[0],param_no:o[1],keys:o[2],sign:o[3],pad_char:o[4],align:o[5],width:o[6],precision:o[7],type:o[8]})}u=u.substring(o[0].length)}return e[l]=s}B!==void 0&&(B.sprintf=d,B.vsprintf=m),typeof window!="undefined"&&(window.sprintf=d,window.vsprintf=m)})()},{}],554:[function(r,I,B){I.exports=d;var t=r("events").EventEmitter;function d(){t.call(this)}r("inherits")(d,t),d.Readable=r("readable-stream/lib/_stream_readable.js"),d.Writable=r("readable-stream/lib/_stream_writable.js"),d.Duplex=r("readable-stream/lib/_stream_duplex.js"),d.Transform=r("readable-stream/lib/_stream_transform.js"),d.PassThrough=r("readable-stream/lib/_stream_passthrough.js"),d.finished=r("readable-stream/lib/internal/streams/end-of-stream.js"),d.pipeline=r("readable-stream/lib/internal/streams/pipeline.js"),d.Stream=d,d.prototype.pipe=function(m,h){var e=this;function f(n){m.writable&&m.write(n)===!1&&e.pause&&e.pause()}function l(){e.readable&&e.resume&&e.resume()}e.on("data",f),m.on("drain",l),m._isStdio||h&&h.end===!1||(e.on("end",u),e.on("close",s));var o=!1;function u(){o||(o=!0,m.end())}function s(){o||(o=!0,typeof m.destroy=="function"&&m.destroy())}function i(n){if(c(),t.listenerCount(this,"error")===0)throw n}function c(){e.removeListener("data",f),m.removeListener("drain",l),e.removeListener("end",u),e.removeListener("close",s),e.removeListener("error",i),m.removeListener("error",i),e.removeListener("end",c),e.removeListener("close",c),m.removeListener("close",c)}return e.on("error",i),m.on("error",i),e.on("end",c),e.on("close",c),m.on("close",c),m.emit("pipe",e),m}},{events:116,inherits:439,"readable-stream/lib/_stream_duplex.js":556,"readable-stream/lib/_stream_passthrough.js":557,"readable-stream/lib/_stream_readable.js":558,"readable-stream/lib/_stream_transform.js":559,"readable-stream/lib/_stream_writable.js":560,"readable-stream/lib/internal/streams/end-of-stream.js":564,"readable-stream/lib/internal/streams/pipeline.js":566}],555:[function(r,I,B){var t={};function d(h,e,f){f||(f=Error);var l=function(o){var u,s;function i(c,n,a){return o.call(this,function(g,p,y){return typeof e=="string"?e:e(g,p,y)}(c,n,a))||this}return s=o,(u=i).prototype=Object.create(s.prototype),u.prototype.constructor=u,u.__proto__=s,i}(f);l.prototype.name=f.name,l.prototype.code=h,t[h]=l}function m(h,e){if(Array.isArray(h)){var f=h.length;return h=h.map(function(l){return String(l)}),f>2?"one of ".concat(e," ").concat(h.slice(0,f-1).join(", "),", or ")+h[f-1]:f===2?"one of ".concat(e," ").concat(h[0]," or ").concat(h[1]):"of ".concat(e," ").concat(h[0])}return"of ".concat(e," ").concat(String(h))}d("ERR_INVALID_OPT_VALUE",function(h,e){return'The value "'+e+'" is invalid for option "'+h+'"'},TypeError),d("ERR_INVALID_ARG_TYPE",function(h,e,f){var l,o,u;if(typeof e=="string"&&(o="not ",e.substr(0,o.length)===o)?(l="must not be",e=e.replace(/^not /,"")):l="must be",function(i,c,n){return(n===void 0||n>i.length)&&(n=i.length),i.substring(n-c.length,n)===c}(h," argument"))u="The ".concat(h," ").concat(l," ").concat(m(e,"type"));else{var s=function(i,c,n){return typeof n!="number"&&(n=0),!(n+c.length>i.length)&&i.indexOf(c,n)!==-1}(h,".")?"property":"argument";u='The "'.concat(h,'" ').concat(s," ").concat(l," ").concat(m(e,"type"))}return u+=". Received type ".concat(typeof f)},TypeError),d("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),d("ERR_METHOD_NOT_IMPLEMENTED",function(h){return"The "+h+" method is not implemented"}),d("ERR_STREAM_PREMATURE_CLOSE","Premature close"),d("ERR_STREAM_DESTROYED",function(h){return"Cannot call "+h+" after a stream was destroyed"}),d("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),d("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),d("ERR_STREAM_WRITE_AFTER_END","write after end"),d("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),d("ERR_UNKNOWN_ENCODING",function(h){return"Unknown encoding: "+h},TypeError),d("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),I.exports.codes=t},{}],556:[function(r,I,B){(function(t){(function(){var d=Object.keys||function(i){var c=[];for(var n in i)c.push(n);return c};I.exports=o;var m=r("./_stream_readable"),h=r("./_stream_writable");r("inherits")(o,m);for(var e=d(h.prototype),f=0;f<e.length;f++){var l=e[f];o.prototype[l]||(o.prototype[l]=h.prototype[l])}function o(i){if(!(this instanceof o))return new o(i);m.call(this,i),h.call(this,i),this.allowHalfOpen=!0,i&&(i.readable===!1&&(this.readable=!1),i.writable===!1&&(this.writable=!1),i.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",u)))}function u(){this._writableState.ended||t.nextTick(s,this)}function s(i){i.end()}Object.defineProperty(o.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(o.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(o.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(o.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(i){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=i,this._writableState.destroyed=i)}})}).call(this)}).call(this,r("_process"))},{"./_stream_readable":558,"./_stream_writable":560,_process:514,inherits:439}],557:[function(r,I,B){I.exports=d;var t=r("./_stream_transform");function d(m){if(!(this instanceof d))return new d(m);t.call(this,m)}r("inherits")(d,t),d.prototype._transform=function(m,h,e){e(null,m)}},{"./_stream_transform":559,inherits:439}],558:[function(r,I,B){(function(t,d){(function(){var m;I.exports=w,w.ReadableState=S,r("events").EventEmitter;var h=function(z,j){return z.listeners(j).length},e=r("./internal/streams/stream"),f=r("buffer").Buffer,l=d.Uint8Array||function(){},o,u=r("util");o=u&&u.debuglog?u.debuglog("stream"):function(){};var s,i,c,n=r("./internal/streams/buffer_list"),a=r("./internal/streams/destroy"),g=r("./internal/streams/state").getHighWaterMark,p=r("../errors").codes,y=p.ERR_INVALID_ARG_TYPE,v=p.ERR_STREAM_PUSH_AFTER_EOF,b=p.ERR_METHOD_NOT_IMPLEMENTED,x=p.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r("inherits")(w,e);var T=a.errorOrDestroy,A=["error","close","destroy","pause","resume"];function S(z,j,W){m=m||r("./_stream_duplex"),z=z||{},typeof W!="boolean"&&(W=j instanceof m),this.objectMode=!!z.objectMode,W&&(this.objectMode=this.objectMode||!!z.readableObjectMode),this.highWaterMark=g(this,z,"readableHighWaterMark",W),this.buffer=new n,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=z.emitClose!==!1,this.autoDestroy=!!z.autoDestroy,this.destroyed=!1,this.defaultEncoding=z.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,z.encoding&&(s||(s=r("string_decoder/").StringDecoder),this.decoder=new s(z.encoding),this.encoding=z.encoding)}function w(z){if(m=m||r("./_stream_duplex"),!(this instanceof w))return new w(z);var j=this instanceof m;this._readableState=new S(z,this,j),this.readable=!0,z&&(typeof z.read=="function"&&(this._read=z.read),typeof z.destroy=="function"&&(this._destroy=z.destroy)),e.call(this)}function E(z,j,W,ee,J){o("readableAddChunk",j);var Q,te=z._readableState;if(j===null)te.reading=!1,function(ie,ae){if(o("onEofChunk"),!ae.ended){if(ae.decoder){var he=ae.decoder.end();he&&he.length&&(ae.buffer.push(he),ae.length+=ae.objectMode?1:he.length)}ae.ended=!0,ae.sync?M(ie):(ae.needReadable=!1,ae.emittedReadable||(ae.emittedReadable=!0,P(ie)))}}(z,te);else if(J||(Q=function(ie,ae){var he;se=ae,f.isBuffer(se)||se instanceof l||typeof ae=="string"||ae===void 0||ie.objectMode||(he=new y("chunk",["string","Buffer","Uint8Array"],ae));var se;return he}(te,j)),Q)T(z,Q);else if(te.objectMode||j&&j.length>0)if(typeof j=="string"||te.objectMode||Object.getPrototypeOf(j)===f.prototype||(j=function(ie){return f.from(ie)}(j)),ee)te.endEmitted?T(z,new x):k(z,te,j,!0);else if(te.ended)T(z,new v);else{if(te.destroyed)return!1;te.reading=!1,te.decoder&&!W?(j=te.decoder.write(j),te.objectMode||j.length!==0?k(z,te,j,!1):D(z,te)):k(z,te,j,!1)}else ee||(te.reading=!1,D(z,te));return!te.ended&&(te.length<te.highWaterMark||te.length===0)}function k(z,j,W,ee){j.flowing&&j.length===0&&!j.sync?(j.awaitDrain=0,z.emit("data",W)):(j.length+=j.objectMode?1:W.length,ee?j.buffer.unshift(W):j.buffer.push(W),j.needReadable&&M(z)),D(z,j)}Object.defineProperty(w.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(z){this._readableState&&(this._readableState.destroyed=z)}}),w.prototype.destroy=a.destroy,w.prototype._undestroy=a.undestroy,w.prototype._destroy=function(z,j){j(z)},w.prototype.push=function(z,j){var W,ee=this._readableState;return ee.objectMode?W=!0:typeof z=="string"&&((j=j||ee.defaultEncoding)!==ee.encoding&&(z=f.from(z,j),j=""),W=!0),E(this,z,j,!1,W)},w.prototype.unshift=function(z){return E(this,z,null,!0,!1)},w.prototype.isPaused=function(){return this._readableState.flowing===!1},w.prototype.setEncoding=function(z){s||(s=r("string_decoder/").StringDecoder);var j=new s(z);this._readableState.decoder=j,this._readableState.encoding=this._readableState.decoder.encoding;for(var W=this._readableState.buffer.head,ee="";W!==null;)ee+=j.write(W.data),W=W.next;return this._readableState.buffer.clear(),ee!==""&&this._readableState.buffer.push(ee),this._readableState.length=ee.length,this};function L(z,j){return z<=0||j.length===0&&j.ended?0:j.objectMode?1:z!=z?j.flowing&&j.length?j.buffer.head.data.length:j.length:(z>j.highWaterMark&&(j.highWaterMark=function(W){return W>=1073741824?W=1073741824:(W--,W|=W>>>1,W|=W>>>2,W|=W>>>4,W|=W>>>8,W|=W>>>16,W++),W}(z)),z<=j.length?z:j.ended?j.length:(j.needReadable=!0,0))}function M(z){var j=z._readableState;o("emitReadable",j.needReadable,j.emittedReadable),j.needReadable=!1,j.emittedReadable||(o("emitReadable",j.flowing),j.emittedReadable=!0,t.nextTick(P,z))}function P(z){var j=z._readableState;o("emitReadable_",j.destroyed,j.length,j.ended),j.destroyed||!j.length&&!j.ended||(z.emit("readable"),j.emittedReadable=!1),j.needReadable=!j.flowing&&!j.ended&&j.length<=j.highWaterMark,K(z)}function D(z,j){j.readingMore||(j.readingMore=!0,t.nextTick(N,z,j))}function N(z,j){for(;!j.reading&&!j.ended&&(j.length<j.highWaterMark||j.flowing&&j.length===0);){var W=j.length;if(o("maybeReadMore read 0"),z.read(0),W===j.length)break}j.readingMore=!1}function U(z){var j=z._readableState;j.readableListening=z.listenerCount("readable")>0,j.resumeScheduled&&!j.paused?j.flowing=!0:z.listenerCount("data")>0&&z.resume()}function G(z){o("readable nexttick read 0"),z.read(0)}function X(z,j){o("resume",j.reading),j.reading||z.read(0),j.resumeScheduled=!1,z.emit("resume"),K(z),j.flowing&&!j.reading&&z.read(0)}function K(z){var j=z._readableState;for(o("flow",j.flowing);j.flowing&&z.read()!==null;);}function Z(z,j){return j.length===0?null:(j.objectMode?W=j.buffer.shift():!z||z>=j.length?(W=j.decoder?j.buffer.join(""):j.buffer.length===1?j.buffer.first():j.buffer.concat(j.length),j.buffer.clear()):W=j.buffer.consume(z,j.decoder),W);var W}function H(z){var j=z._readableState;o("endReadable",j.endEmitted),j.endEmitted||(j.ended=!0,t.nextTick(Y,j,z))}function Y(z,j){if(o("endReadableNT",z.endEmitted,z.length),!z.endEmitted&&z.length===0&&(z.endEmitted=!0,j.readable=!1,j.emit("end"),z.autoDestroy)){var W=j._writableState;(!W||W.autoDestroy&&W.finished)&&j.destroy()}}function $(z,j){for(var W=0,ee=z.length;W<ee;W++)if(z[W]===j)return W;return-1}w.prototype.read=function(z){o("read",z),z=parseInt(z,10);var j=this._readableState,W=z;if(z!==0&&(j.emittedReadable=!1),z===0&&j.needReadable&&((j.highWaterMark!==0?j.length>=j.highWaterMark:j.length>0)||j.ended))return o("read: emitReadable",j.length,j.ended),j.length===0&&j.ended?H(this):M(this),null;if((z=L(z,j))===0&&j.ended)return j.length===0&&H(this),null;var ee,J=j.needReadable;return o("need readable",J),(j.length===0||j.length-z<j.highWaterMark)&&o("length less than watermark",J=!0),j.ended||j.reading?o("reading or ended",J=!1):J&&(o("do read"),j.reading=!0,j.sync=!0,j.length===0&&(j.needReadable=!0),this._read(j.highWaterMark),j.sync=!1,j.reading||(z=L(W,j))),(ee=z>0?Z(z,j):null)===null?(j.needReadable=j.length<=j.highWaterMark,z=0):(j.length-=z,j.awaitDrain=0),j.length===0&&(j.ended||(j.needReadable=!0),W!==z&&j.ended&&H(this)),ee!==null&&this.emit("data",ee),ee},w.prototype._read=function(z){T(this,new b("_read()"))},w.prototype.pipe=function(z,j){var W=this,ee=this._readableState;switch(ee.pipesCount){case 0:ee.pipes=z;break;case 1:ee.pipes=[ee.pipes,z];break;default:ee.pipes.push(z)}ee.pipesCount+=1,o("pipe count=%d opts=%j",ee.pipesCount,j);var J=(!j||j.end!==!1)&&z!==t.stdout&&z!==t.stderr?te:ve;function Q(ke,Ee){o("onunpipe"),ke===W&&Ee&&Ee.hasUnpiped===!1&&(Ee.hasUnpiped=!0,o("cleanup"),z.removeListener("close",de),z.removeListener("finish",ue),z.removeListener("drain",ie),z.removeListener("error",se),z.removeListener("unpipe",Q),W.removeListener("end",te),W.removeListener("end",ve),W.removeListener("data",he),ae=!0,!ee.awaitDrain||z._writableState&&!z._writableState.needDrain||ie())}function te(){o("onend"),z.end()}ee.endEmitted?t.nextTick(J):W.once("end",J),z.on("unpipe",Q);var ie=function(ke){return function(){var Ee=ke._readableState;o("pipeOnDrain",Ee.awaitDrain),Ee.awaitDrain&&Ee.awaitDrain--,Ee.awaitDrain===0&&h(ke,"data")&&(Ee.flowing=!0,K(ke))}}(W);z.on("drain",ie);var ae=!1;function he(ke){o("ondata");var Ee=z.write(ke);o("dest.write",Ee),Ee===!1&&((ee.pipesCount===1&&ee.pipes===z||ee.pipesCount>1&&$(ee.pipes,z)!==-1)&&!ae&&(o("false write response, pause",ee.awaitDrain),ee.awaitDrain++),W.pause())}function se(ke){o("onerror",ke),ve(),z.removeListener("error",se),h(z,"error")===0&&T(z,ke)}function de(){z.removeListener("finish",ue),ve()}function ue(){o("onfinish"),z.removeListener("close",de),ve()}function ve(){o("unpipe"),W.unpipe(z)}return W.on("data",he),function(ke,Ee,be){if(typeof ke.prependListener=="function")return ke.prependListener(Ee,be);ke._events&&ke._events[Ee]?Array.isArray(ke._events[Ee])?ke._events[Ee].unshift(be):ke._events[Ee]=[be,ke._events[Ee]]:ke.on(Ee,be)}(z,"error",se),z.once("close",de),z.once("finish",ue),z.emit("pipe",W),ee.flowing||(o("pipe resume"),W.resume()),z},w.prototype.unpipe=function(z){var j=this._readableState,W={hasUnpiped:!1};if(j.pipesCount===0)return this;if(j.pipesCount===1)return z&&z!==j.pipes||(z||(z=j.pipes),j.pipes=null,j.pipesCount=0,j.flowing=!1,z&&z.emit("unpipe",this,W)),this;if(!z){var ee=j.pipes,J=j.pipesCount;j.pipes=null,j.pipesCount=0,j.flowing=!1;for(var Q=0;Q<J;Q++)ee[Q].emit("unpipe",this,{hasUnpiped:!1});return this}var te=$(j.pipes,z);return te===-1||(j.pipes.splice(te,1),j.pipesCount-=1,j.pipesCount===1&&(j.pipes=j.pipes[0]),z.emit("unpipe",this,W)),this},w.prototype.on=function(z,j){var W=e.prototype.on.call(this,z,j),ee=this._readableState;return z==="data"?(ee.readableListening=this.listenerCount("readable")>0,ee.flowing!==!1&&this.resume()):z==="readable"&&(ee.endEmitted||ee.readableListening||(ee.readableListening=ee.needReadable=!0,ee.flowing=!1,ee.emittedReadable=!1,o("on readable",ee.length,ee.reading),ee.length?M(this):ee.reading||t.nextTick(G,this))),W},w.prototype.addListener=w.prototype.on,w.prototype.removeListener=function(z,j){var W=e.prototype.removeListener.call(this,z,j);return z==="readable"&&t.nextTick(U,this),W},w.prototype.removeAllListeners=function(z){var j=e.prototype.removeAllListeners.apply(this,arguments);return z!=="readable"&&z!==void 0||t.nextTick(U,this),j},w.prototype.resume=function(){var z=this._readableState;return z.flowing||(o("resume"),z.flowing=!z.readableListening,function(j,W){W.resumeScheduled||(W.resumeScheduled=!0,t.nextTick(X,j,W))}(this,z)),z.paused=!1,this},w.prototype.pause=function(){return o("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(o("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},w.prototype.wrap=function(z){var j=this,W=this._readableState,ee=!1;for(var J in z.on("end",function(){if(o("wrapped end"),W.decoder&&!W.ended){var te=W.decoder.end();te&&te.length&&j.push(te)}j.push(null)}),z.on("data",function(te){o("wrapped data"),W.decoder&&(te=W.decoder.write(te)),W.objectMode&&te==null||(W.objectMode||te&&te.length)&&(j.push(te)||(ee=!0,z.pause()))}),z)this[J]===void 0&&typeof z[J]=="function"&&(this[J]=function(te){return function(){return z[te].apply(z,arguments)}}(J));for(var Q=0;Q<A.length;Q++)z.on(A[Q],this.emit.bind(this,A[Q]));return this._read=function(te){o("wrapped _read",te),ee&&(ee=!1,z.resume())},this},typeof Symbol=="function"&&(w.prototype[Symbol.asyncIterator]=function(){return i===void 0&&(i=r("./internal/streams/async_iterator")),i(this)}),Object.defineProperty(w.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(w.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(w.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(z){this._readableState&&(this._readableState.flowing=z)}}),w._fromList=Z,Object.defineProperty(w.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(w.from=function(z,j){return c===void 0&&(c=r("./internal/streams/from")),c(w,z,j)})}).call(this)}).call(this,r("_process"),typeof vi!="undefined"?vi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"../errors":555,"./_stream_duplex":556,"./internal/streams/async_iterator":561,"./internal/streams/buffer_list":562,"./internal/streams/destroy":563,"./internal/streams/from":565,"./internal/streams/state":567,"./internal/streams/stream":568,_process:514,buffer:117,events:116,inherits:439,"string_decoder/":569,util:115}],559:[function(r,I,B){I.exports=o;var t=r("../errors").codes,d=t.ERR_METHOD_NOT_IMPLEMENTED,m=t.ERR_MULTIPLE_CALLBACK,h=t.ERR_TRANSFORM_ALREADY_TRANSFORMING,e=t.ERR_TRANSFORM_WITH_LENGTH_0,f=r("./_stream_duplex");function l(i,c){var n=this._transformState;n.transforming=!1;var a=n.writecb;if(a===null)return this.emit("error",new m);n.writechunk=null,n.writecb=null,c!=null&&this.push(c),a(i);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}function o(i){if(!(this instanceof o))return new o(i);f.call(this,i),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,i&&(typeof i.transform=="function"&&(this._transform=i.transform),typeof i.flush=="function"&&(this._flush=i.flush)),this.on("prefinish",u)}function u(){var i=this;typeof this._flush!="function"||this._readableState.destroyed?s(this,null,null):this._flush(function(c,n){s(i,c,n)})}function s(i,c,n){if(c)return i.emit("error",c);if(n!=null&&i.push(n),i._writableState.length)throw new e;if(i._transformState.transforming)throw new h;return i.push(null)}r("inherits")(o,f),o.prototype.push=function(i,c){return this._transformState.needTransform=!1,f.prototype.push.call(this,i,c)},o.prototype._transform=function(i,c,n){n(new d("_transform()"))},o.prototype._write=function(i,c,n){var a=this._transformState;if(a.writecb=n,a.writechunk=i,a.writeencoding=c,!a.transforming){var g=this._readableState;(a.needTransform||g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}},o.prototype._read=function(i){var c=this._transformState;c.writechunk===null||c.transforming?c.needTransform=!0:(c.transforming=!0,this._transform(c.writechunk,c.writeencoding,c.afterTransform))},o.prototype._destroy=function(i,c){f.prototype._destroy.call(this,i,function(n){c(n)})}},{"../errors":555,"./_stream_duplex":556,inherits:439}],560:[function(r,I,B){(function(t,d){(function(){function m(N){var U=this;this.next=null,this.entry=null,this.finish=function(){(function(G,X,K){var Z=G.entry;for(G.entry=null;Z;){var H=Z.callback;X.pendingcb--,H(K),Z=Z.next}X.corkedRequestsFree.next=G})(U,N)}}var h;I.exports=w,w.WritableState=S;var e={deprecate:r("util-deprecate")},f=r("./internal/streams/stream"),l=r("buffer").Buffer,o=d.Uint8Array||function(){},u,s=r("./internal/streams/destroy"),i=r("./internal/streams/state").getHighWaterMark,c=r("../errors").codes,n=c.ERR_INVALID_ARG_TYPE,a=c.ERR_METHOD_NOT_IMPLEMENTED,g=c.ERR_MULTIPLE_CALLBACK,p=c.ERR_STREAM_CANNOT_PIPE,y=c.ERR_STREAM_DESTROYED,v=c.ERR_STREAM_NULL_VALUES,b=c.ERR_STREAM_WRITE_AFTER_END,x=c.ERR_UNKNOWN_ENCODING,T=s.errorOrDestroy;function A(){}function S(N,U,G){h=h||r("./_stream_duplex"),N=N||{},typeof G!="boolean"&&(G=U instanceof h),this.objectMode=!!N.objectMode,G&&(this.objectMode=this.objectMode||!!N.writableObjectMode),this.highWaterMark=i(this,N,"writableHighWaterMark",G),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var X=N.decodeStrings===!1;this.decodeStrings=!X,this.defaultEncoding=N.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(K){(function(Z,H){var Y=Z._writableState,$=Y.sync,z=Y.writecb;if(typeof z!="function")throw new g;if(function(W){W.writing=!1,W.writecb=null,W.length-=W.writelen,W.writelen=0}(Y),H)(function(W,ee,J,Q,te){--ee.pendingcb,J?(t.nextTick(te,Q),t.nextTick(D,W,ee),W._writableState.errorEmitted=!0,T(W,Q)):(te(Q),W._writableState.errorEmitted=!0,T(W,Q),D(W,ee))})(Z,Y,$,H,z);else{var j=M(Y)||Z.destroyed;j||Y.corked||Y.bufferProcessing||!Y.bufferedRequest||L(Z,Y),$?t.nextTick(k,Z,Y,j,z):k(Z,Y,j,z)}})(U,K)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=N.emitClose!==!1,this.autoDestroy=!!N.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new m(this)}function w(N){var U=this instanceof(h=h||r("./_stream_duplex"));if(!U&&!u.call(w,this))return new w(N);this._writableState=new S(N,this,U),this.writable=!0,N&&(typeof N.write=="function"&&(this._write=N.write),typeof N.writev=="function"&&(this._writev=N.writev),typeof N.destroy=="function"&&(this._destroy=N.destroy),typeof N.final=="function"&&(this._final=N.final)),f.call(this)}function E(N,U,G,X,K,Z,H){U.writelen=X,U.writecb=H,U.writing=!0,U.sync=!0,U.destroyed?U.onwrite(new y("write")):G?N._writev(K,U.onwrite):N._write(K,Z,U.onwrite),U.sync=!1}function k(N,U,G,X){G||function(K,Z){Z.length===0&&Z.needDrain&&(Z.needDrain=!1,K.emit("drain"))}(N,U),U.pendingcb--,X(),D(N,U)}function L(N,U){U.bufferProcessing=!0;var G=U.bufferedRequest;if(N._writev&&G&&G.next){var X=U.bufferedRequestCount,K=new Array(X),Z=U.corkedRequestsFree;Z.entry=G;for(var H=0,Y=!0;G;)K[H]=G,G.isBuf||(Y=!1),G=G.next,H+=1;K.allBuffers=Y,E(N,U,!0,U.length,K,"",Z.finish),U.pendingcb++,U.lastBufferedRequest=null,Z.next?(U.corkedRequestsFree=Z.next,Z.next=null):U.corkedRequestsFree=new m(U),U.bufferedRequestCount=0}else{for(;G;){var $=G.chunk,z=G.encoding,j=G.callback;if(E(N,U,!1,U.objectMode?1:$.length,$,z,j),G=G.next,U.bufferedRequestCount--,U.writing)break}G===null&&(U.lastBufferedRequest=null)}U.bufferedRequest=G,U.bufferProcessing=!1}function M(N){return N.ending&&N.length===0&&N.bufferedRequest===null&&!N.finished&&!N.writing}function P(N,U){N._final(function(G){U.pendingcb--,G&&T(N,G),U.prefinished=!0,N.emit("prefinish"),D(N,U)})}function D(N,U){var G=M(U);if(G&&(function(K,Z){Z.prefinished||Z.finalCalled||(typeof K._final!="function"||Z.destroyed?(Z.prefinished=!0,K.emit("prefinish")):(Z.pendingcb++,Z.finalCalled=!0,t.nextTick(P,K,Z)))}(N,U),U.pendingcb===0&&(U.finished=!0,N.emit("finish"),U.autoDestroy))){var X=N._readableState;(!X||X.autoDestroy&&X.endEmitted)&&N.destroy()}return G}r("inherits")(w,f),S.prototype.getBuffer=function(){for(var N=this.bufferedRequest,U=[];N;)U.push(N),N=N.next;return U},function(){try{Object.defineProperty(S.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(N){}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(w,Symbol.hasInstance,{value:function(N){return!!u.call(this,N)||this===w&&N&&N._writableState instanceof S}})):u=function(N){return N instanceof this},w.prototype.pipe=function(){T(this,new p)},w.prototype.write=function(N,U,G){var X,K=this._writableState,Z=!1,H=!K.objectMode&&(X=N,l.isBuffer(X)||X instanceof o);return H&&!l.isBuffer(N)&&(N=function(Y){return l.from(Y)}(N)),typeof U=="function"&&(G=U,U=null),H?U="buffer":U||(U=K.defaultEncoding),typeof G!="function"&&(G=A),K.ending?function(Y,$){var z=new b;T(Y,z),t.nextTick($,z)}(this,G):(H||function(Y,$,z,j){var W;return z===null?W=new v:typeof z=="string"||$.objectMode||(W=new n("chunk",["string","Buffer"],z)),!W||(T(Y,W),t.nextTick(j,W),!1)}(this,K,N,G))&&(K.pendingcb++,Z=function(Y,$,z,j,W,ee){if(!z){var J=function(ae,he,se){return ae.objectMode||ae.decodeStrings===!1||typeof he!="string"||(he=l.from(he,se)),he}($,j,W);j!==J&&(z=!0,W="buffer",j=J)}var Q=$.objectMode?1:j.length;$.length+=Q;var te=$.length<$.highWaterMark;if(te||($.needDrain=!0),$.writing||$.corked){var ie=$.lastBufferedRequest;$.lastBufferedRequest={chunk:j,encoding:W,isBuf:z,callback:ee,next:null},ie?ie.next=$.lastBufferedRequest:$.bufferedRequest=$.lastBufferedRequest,$.bufferedRequestCount+=1}else E(Y,$,!1,Q,j,W,ee);return te}(this,K,H,N,U,G)),Z},w.prototype.cork=function(){this._writableState.corked++},w.prototype.uncork=function(){var N=this._writableState;N.corked&&(N.corked--,N.writing||N.corked||N.bufferProcessing||!N.bufferedRequest||L(this,N))},w.prototype.setDefaultEncoding=function(N){if(typeof N=="string"&&(N=N.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((N+"").toLowerCase())>-1))throw new x(N);return this._writableState.defaultEncoding=N,this},Object.defineProperty(w.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(w.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),w.prototype._write=function(N,U,G){G(new a("_write()"))},w.prototype._writev=null,w.prototype.end=function(N,U,G){var X=this._writableState;return typeof N=="function"?(G=N,N=null,U=null):typeof U=="function"&&(G=U,U=null),N!=null&&this.write(N,U),X.corked&&(X.corked=1,this.uncork()),X.ending||function(K,Z,H){Z.ending=!0,D(K,Z),H&&(Z.finished?t.nextTick(H):K.once("finish",H)),Z.ended=!0,K.writable=!1}(this,X,G),this},Object.defineProperty(w.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(w.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(N){this._writableState&&(this._writableState.destroyed=N)}}),w.prototype.destroy=s.destroy,w.prototype._undestroy=s.undestroy,w.prototype._destroy=function(N,U){U(N)}}).call(this)}).call(this,r("_process"),typeof vi!="undefined"?vi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"../errors":555,"./_stream_duplex":556,"./internal/streams/destroy":563,"./internal/streams/state":567,"./internal/streams/stream":568,_process:514,buffer:117,inherits:439,"util-deprecate":606}],561:[function(r,I,B){(function(t){(function(){var d;function m(y,v,b){return v in y?Object.defineProperty(y,v,{value:b,enumerable:!0,configurable:!0,writable:!0}):y[v]=b,y}var h=r("./end-of-stream"),e=Symbol("lastResolve"),f=Symbol("lastReject"),l=Symbol("error"),o=Symbol("ended"),u=Symbol("lastPromise"),s=Symbol("handlePromise"),i=Symbol("stream");function c(y,v){return{value:y,done:v}}function n(y){var v=y[e];if(v!==null){var b=y[i].read();b!==null&&(y[u]=null,y[e]=null,y[f]=null,v(c(b,!1)))}}function a(y){t.nextTick(n,y)}var g=Object.getPrototypeOf(function(){}),p=Object.setPrototypeOf((m(d={get stream(){return this[i]},next:function(){var y=this,v=this[l];if(v!==null)return Promise.reject(v);if(this[o])return Promise.resolve(c(void 0,!0));if(this[i].destroyed)return new Promise(function(A,S){t.nextTick(function(){y[l]?S(y[l]):A(c(void 0,!0))})});var b,x=this[u];if(x)b=new Promise(function(A,S){return function(w,E){A.then(function(){S[o]?w(c(void 0,!0)):S[s](w,E)},E)}}(x,this));else{var T=this[i].read();if(T!==null)return Promise.resolve(c(T,!1));b=new Promise(this[s])}return this[u]=b,b}},Symbol.asyncIterator,function(){return this}),m(d,"return",function(){var y=this;return new Promise(function(v,b){y[i].destroy(null,function(x){x?b(x):v(c(void 0,!0))})})}),d),g);I.exports=function(y){var v,b=Object.create(p,(m(v={},i,{value:y,writable:!0}),m(v,e,{value:null,writable:!0}),m(v,f,{value:null,writable:!0}),m(v,l,{value:null,writable:!0}),m(v,o,{value:y._readableState.endEmitted,writable:!0}),m(v,s,{value:function(x,T){var A=b[i].read();A?(b[u]=null,b[e]=null,b[f]=null,x(c(A,!1))):(b[e]=x,b[f]=T)},writable:!0}),v));return b[u]=null,h(y,function(x){if(x&&x.code!=="ERR_STREAM_PREMATURE_CLOSE"){var T=b[f];return T!==null&&(b[u]=null,b[e]=null,b[f]=null,T(x)),void(b[l]=x)}var A=b[e];A!==null&&(b[u]=null,b[e]=null,b[f]=null,A(c(void 0,!0))),b[o]=!0}),y.on("readable",a.bind(null,b)),b}}).call(this)}).call(this,r("_process"))},{"./end-of-stream":564,_process:514}],562:[function(r,I,B){function t(l,o){var u=Object.keys(l);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(l);o&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(l,i).enumerable})),u.push.apply(u,s)}return u}function d(l,o,u){return o in l?Object.defineProperty(l,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):l[o]=u,l}function m(l,o){for(var u=0;u<o.length;u++){var s=o[u];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(l,s.key,s)}}var h=r("buffer").Buffer,e=r("util").inspect,f=e&&e.custom||"inspect";I.exports=function(){function l(){(function(s,i){if(!(s instanceof i))throw new TypeError("Cannot call a class as a function")})(this,l),this.head=null,this.tail=null,this.length=0}var o,u;return o=l,(u=[{key:"push",value:function(s){var i={data:s,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length}},{key:"unshift",value:function(s){var i={data:s,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length}},{key:"shift",value:function(){if(this.length!==0){var s=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,s}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(s){if(this.length===0)return"";for(var i=this.head,c=""+i.data;i=i.next;)c+=s+i.data;return c}},{key:"concat",value:function(s){if(this.length===0)return h.alloc(0);for(var i,c,n,a=h.allocUnsafe(s>>>0),g=this.head,p=0;g;)i=g.data,c=a,n=p,h.prototype.copy.call(i,c,n),p+=g.data.length,g=g.next;return a}},{key:"consume",value:function(s,i){var c;return s<this.head.data.length?(c=this.head.data.slice(0,s),this.head.data=this.head.data.slice(s)):c=s===this.head.data.length?this.shift():i?this._getString(s):this._getBuffer(s),c}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(s){var i=this.head,c=1,n=i.data;for(s-=n.length;i=i.next;){var a=i.data,g=s>a.length?a.length:s;if(g===a.length?n+=a:n+=a.slice(0,s),(s-=g)==0){g===a.length?(++c,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=a.slice(g));break}++c}return this.length-=c,n}},{key:"_getBuffer",value:function(s){var i=h.allocUnsafe(s),c=this.head,n=1;for(c.data.copy(i),s-=c.data.length;c=c.next;){var a=c.data,g=s>a.length?a.length:s;if(a.copy(i,i.length-s,0,g),(s-=g)==0){g===a.length?(++n,c.next?this.head=c.next:this.head=this.tail=null):(this.head=c,c.data=a.slice(g));break}++n}return this.length-=n,i}},{key:f,value:function(s,i){return e(this,function(c){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?t(Object(a),!0).forEach(function(g){d(c,g,a[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach(function(g){Object.defineProperty(c,g,Object.getOwnPropertyDescriptor(a,g))})}return c}({},i,{depth:0,customInspect:!1}))}}])&&m(o.prototype,u),l}()},{buffer:117,util:115}],563:[function(r,I,B){(function(t){(function(){function d(e,f){h(e,f),m(e)}function m(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function h(e,f){e.emit("error",f)}I.exports={destroy:function(e,f){var l=this,o=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return o||u?(f?f(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(h,this,e)):t.nextTick(h,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(s){!f&&s?l._writableState?l._writableState.errorEmitted?t.nextTick(m,l):(l._writableState.errorEmitted=!0,t.nextTick(d,l,s)):t.nextTick(d,l,s):f?(t.nextTick(m,l),f(s)):t.nextTick(m,l)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,f){var l=e._readableState,o=e._writableState;l&&l.autoDestroy||o&&o.autoDestroy?e.destroy(f):e.emit("error",f)}}}).call(this)}).call(this,r("_process"))},{_process:514}],564:[function(r,I,B){var t=r("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function d(){}I.exports=function m(h,e,f){if(typeof e=="function")return m(h,null,e);e||(e={}),f=function(y){var v=!1;return function(){if(!v){v=!0;for(var b=arguments.length,x=new Array(b),T=0;T<b;T++)x[T]=arguments[T];y.apply(this,x)}}}(f||d);var l=e.readable||e.readable!==!1&&h.readable,o=e.writable||e.writable!==!1&&h.writable,u=function(){h.writable||i()},s=h._writableState&&h._writableState.finished,i=function(){o=!1,s=!0,l||f.call(h)},c=h._readableState&&h._readableState.endEmitted,n=function(){l=!1,c=!0,o||f.call(h)},a=function(y){f.call(h,y)},g=function(){var y;return l&&!c?(h._readableState&&h._readableState.ended||(y=new t),f.call(h,y)):o&&!s?(h._writableState&&h._writableState.ended||(y=new t),f.call(h,y)):void 0},p=function(){h.req.on("finish",i)};return function(y){return y.setHeader&&typeof y.abort=="function"}(h)?(h.on("complete",i),h.on("abort",g),h.req?p():h.on("request",p)):o&&!h._writableState&&(h.on("end",u),h.on("close",u)),h.on("end",n),h.on("finish",i),e.error!==!1&&h.on("error",a),h.on("close",g),function(){h.removeListener("complete",i),h.removeListener("abort",g),h.removeListener("request",p),h.req&&h.req.removeListener("finish",i),h.removeListener("end",u),h.removeListener("close",u),h.removeListener("finish",i),h.removeListener("end",n),h.removeListener("error",a),h.removeListener("close",g)}}},{"../../../errors":555}],565:[function(r,I,B){I.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],566:[function(r,I,B){var t,d=r("../../../errors").codes,m=d.ERR_MISSING_ARGS,h=d.ERR_STREAM_DESTROYED;function e(s){if(s)throw s}function f(s,i,c,n){n=function(p){var y=!1;return function(){y||(y=!0,p.apply(void 0,arguments))}}(n);var a=!1;s.on("close",function(){a=!0}),t===void 0&&(t=r("./end-of-stream")),t(s,{readable:i,writable:c},function(p){if(p)return n(p);a=!0,n()});var g=!1;return function(p){if(!a&&!g)return g=!0,function(y){return y.setHeader&&typeof y.abort=="function"}(s)?s.abort():typeof s.destroy=="function"?s.destroy():void n(p||new h("pipe"))}}function l(s){s()}function o(s,i){return s.pipe(i)}function u(s){return s.length?typeof s[s.length-1]!="function"?e:s.pop():e}I.exports=function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];var n,a=u(i);if(Array.isArray(i[0])&&(i=i[0]),i.length<2)throw new m("streams");var g=i.map(function(p,y){var v=y<i.length-1;return f(p,v,y>0,function(b){n||(n=b),b&&g.forEach(l),v||(g.forEach(l),a(n))})});return i.reduce(o)}},{"../../../errors":555,"./end-of-stream":564}],567:[function(r,I,B){var t=r("../../../errors").codes.ERR_INVALID_OPT_VALUE;I.exports={getHighWaterMark:function(d,m,h,e){var f=function(l,o,u){return l.highWaterMark!=null?l.highWaterMark:o?l[u]:null}(m,e,h);if(f!=null){if(!isFinite(f)||Math.floor(f)!==f||f<0)throw new t(e?h:"highWaterMark",f);return Math.floor(f)}return d.objectMode?16:16384}}},{"../../../errors":555}],568:[function(r,I,B){I.exports=r("events").EventEmitter},{events:116}],569:[function(r,I,B){var t=r("safe-buffer").Buffer,d=t.isEncoding||function(c){switch((c=""+c)&&c.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function m(c){var n;switch(this.encoding=function(a){var g=function(p){if(!p)return"utf8";for(var y;;)switch(p){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return p;default:if(y)return;p=(""+p).toLowerCase(),y=!0}}(a);if(typeof g!="string"&&(t.isEncoding===d||!d(a)))throw new Error("Unknown encoding: "+a);return g||a}(c),this.encoding){case"utf16le":this.text=f,this.end=l,n=4;break;case"utf8":this.fillLast=e,n=4;break;case"base64":this.text=o,this.end=u,n=3;break;default:return this.write=s,void(this.end=i)}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(n)}function h(c){return c<=127?0:c>>5==6?2:c>>4==14?3:c>>3==30?4:c>>6==2?-1:-2}function e(c){var n=this.lastTotal-this.lastNeed,a=function(g,p,y){if((192&p[0])!=128)return g.lastNeed=0,"\uFFFD";if(g.lastNeed>1&&p.length>1){if((192&p[1])!=128)return g.lastNeed=1,"\uFFFD";if(g.lastNeed>2&&p.length>2&&(192&p[2])!=128)return g.lastNeed=2,"\uFFFD"}}(this,c);return a!==void 0?a:this.lastNeed<=c.length?(c.copy(this.lastChar,n,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(c.copy(this.lastChar,n,0,c.length),void(this.lastNeed-=c.length))}function f(c,n){if((c.length-n)%2==0){var a=c.toString("utf16le",n);if(a){var g=a.charCodeAt(a.length-1);if(g>=55296&&g<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=c[c.length-2],this.lastChar[1]=c[c.length-1],a.slice(0,-1)}return a}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=c[c.length-1],c.toString("utf16le",n,c.length-1)}function l(c){var n=c&&c.length?this.write(c):"";if(this.lastNeed){var a=this.lastTotal-this.lastNeed;return n+this.lastChar.toString("utf16le",0,a)}return n}function o(c,n){var a=(c.length-n)%3;return a===0?c.toString("base64",n):(this.lastNeed=3-a,this.lastTotal=3,a===1?this.lastChar[0]=c[c.length-1]:(this.lastChar[0]=c[c.length-2],this.lastChar[1]=c[c.length-1]),c.toString("base64",n,c.length-a))}function u(c){var n=c&&c.length?this.write(c):"";return this.lastNeed?n+this.lastChar.toString("base64",0,3-this.lastNeed):n}function s(c){return c.toString(this.encoding)}function i(c){return c&&c.length?this.write(c):""}B.StringDecoder=m,m.prototype.write=function(c){if(c.length===0)return"";var n,a;if(this.lastNeed){if((n=this.fillLast(c))===void 0)return"";a=this.lastNeed,this.lastNeed=0}else a=0;return a<c.length?n?n+this.text(c,a):this.text(c,a):n||""},m.prototype.end=function(c){var n=c&&c.length?this.write(c):"";return this.lastNeed?n+"\uFFFD":n},m.prototype.text=function(c,n){var a=function(p,y,v){var b=y.length-1;if(b<v)return 0;var x=h(y[b]);return x>=0?(x>0&&(p.lastNeed=x-1),x):--b<v||x===-2?0:(x=h(y[b]))>=0?(x>0&&(p.lastNeed=x-2),x):--b<v||x===-2?0:(x=h(y[b]))>=0?(x>0&&(x===2?x=0:p.lastNeed=x-3),x):0}(this,c,n);if(!this.lastNeed)return c.toString("utf8",n);this.lastTotal=a;var g=c.length-(a-this.lastNeed);return c.copy(this.lastChar,0,g),c.toString("utf8",n,g)},m.prototype.fillLast=function(c){if(this.lastNeed<=c.length)return c.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);c.copy(this.lastChar,this.lastTotal-this.lastNeed,0,c.length),this.lastNeed-=c.length}},{"safe-buffer":540}],570:[function(r,I,B){(function(t,d){(function(){var m=r("assert"),h=r("debug")("stream-parser");I.exports=function(a){var g=a&&typeof a._transform=="function",p=a&&typeof a._write=="function";if(!g&&!p)throw new Error("must pass a Writable or Transform stream in");h("extending Parser into stream"),a._bytes=f,a._skipBytes=l,g&&(a._passthrough=o),g?a._transform=s:a._write=u};function e(a){h("initializing parser stream"),a._parserBytesLeft=0,a._parserBuffers=[],a._parserBuffered=0,a._parserState=-1,a._parserCallback=null,typeof a.push=="function"&&(a._parserOutput=a.push.bind(a)),a._parserInit=!0}function f(a,g){m(!this._parserCallback,'there is already a "callback" set!'),m(isFinite(a)&&a>0,'can only buffer a finite number of bytes > 0, got "'+a+'"'),this._parserInit||e(this),h("buffering %o bytes",a),this._parserBytesLeft=a,this._parserCallback=g,this._parserState=0}function l(a,g){m(!this._parserCallback,'there is already a "callback" set!'),m(a>0,'can only skip > 0 bytes, got "'+a+'"'),this._parserInit||e(this),h("skipping %o bytes",a),this._parserBytesLeft=a,this._parserCallback=g,this._parserState=1}function o(a,g){m(!this._parserCallback,'There is already a "callback" set!'),m(a>0,'can only pass through > 0 bytes, got "'+a+'"'),this._parserInit||e(this),h("passing through %o bytes",a),this._parserBytesLeft=a,this._parserCallback=g,this._parserState=2}function u(a,g,p){this._parserInit||e(this),h("write(%o bytes)",a.length),typeof g=="function"&&(p=g),c(this,a,null,p)}function s(a,g,p){this._parserInit||e(this),h("transform(%o bytes)",a.length),typeof g!="function"&&(g=this._parserOutput),c(this,a,g,p)}function i(a,g,p,y){if(a._parserBytesLeft-=g.length,h("%o bytes left for stream piece",a._parserBytesLeft),a._parserState===0?(a._parserBuffers.push(g),a._parserBuffered+=g.length):a._parserState===2&&p(g),a._parserBytesLeft!==0)return y;var v=a._parserCallback;if(v&&a._parserState===0&&a._parserBuffers.length>1&&(g=d.concat(a._parserBuffers,a._parserBuffered)),a._parserState!==0&&(g=null),a._parserCallback=null,a._parserBuffered=0,a._parserState=-1,a._parserBuffers.splice(0),v){var b=[];g&&b.push(g),p&&b.push(p);var x=v.length>b.length;x&&b.push(n(y));var T=v.apply(a,b);if(!x||y===T)return y}}var c=n(function a(g,p,y,v){return g._parserBytesLeft<=0?v(new Error("got data but not currently parsing anything")):p.length<=g._parserBytesLeft?function(){return i(g,p,y,v)}:function(){var b=p.slice(0,g._parserBytesLeft);return i(g,b,y,function(x){return x?v(x):p.length>b.length?function(){return a(g,p.slice(b.length),y,v)}:void 0})}});function n(a){return function(){for(var g=a.apply(this,arguments);typeof g=="function";)g=g();return g}}}).call(this)}).call(this,r("_process"),r("buffer").Buffer)},{_process:514,assert:80,buffer:117,debug:571}],571:[function(r,I,B){(function(t){(function(){function d(){var m;try{m=B.storage.debug}catch(h){}return!m&&t!==void 0&&"env"in t&&(m=t.env.DEBUG),m}(B=I.exports=r("./debug")).log=function(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},B.formatArgs=function(m){var h=this.useColors;if(m[0]=(h?"%c":"")+this.namespace+(h?" %c":" ")+m[0]+(h?"%c ":" ")+"+"+B.humanize(this.diff),!!h){var e="color: "+this.color;m.splice(1,0,e,"color: inherit");var f=0,l=0;m[0].replace(/%[a-zA-Z%]/g,function(o){o!=="%%"&&(f++,o==="%c"&&(l=f))}),m.splice(l,0,e)}},B.save=function(m){try{m==null?B.storage.removeItem("debug"):B.storage.debug=m}catch(h){}},B.load=d,B.useColors=function(){return typeof window!="undefined"&&window.process&&window.process.type==="renderer"?!0:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},B.storage=typeof chrome!="undefined"&&chrome.storage!==void 0?chrome.storage.local:function(){try{return window.localStorage}catch(m){}}(),B.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],B.formatters.j=function(m){try{return JSON.stringify(m)}catch(h){return"[UnexpectedJSONParseError]: "+h.message}},B.enable(d())}).call(this)}).call(this,r("_process"))},{"./debug":572,_process:514}],572:[function(r,I,B){var t;function d(m){function h(){if(h.enabled){var e=h,f=+new Date,l=f-(t||f);e.diff=l,e.prev=t,e.curr=f,t=f;for(var o=new Array(arguments.length),u=0;u<o.length;u++)o[u]=arguments[u];o[0]=B.coerce(o[0]),typeof o[0]!="string"&&o.unshift("%O");var s=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(c,n){if(c==="%%")return c;s++;var a=B.formatters[n];if(typeof a=="function"){var g=o[s];c=a.call(e,g),o.splice(s,1),s--}return c}),B.formatArgs.call(e,o);var i=h.log||B.log||console.log.bind(console);i.apply(e,o)}}return h.namespace=m,h.enabled=B.enabled(m),h.useColors=B.useColors(),h.color=function(e){var f,l=0;for(f in e)l=(l<<5)-l+e.charCodeAt(f),l|=0;return B.colors[Math.abs(l)%B.colors.length]}(m),typeof B.init=="function"&&B.init(h),h}(B=I.exports=d.debug=d.default=d).coerce=function(m){return m instanceof Error?m.stack||m.message:m},B.disable=function(){B.enable("")},B.enable=function(m){B.save(m),B.names=[],B.skips=[];for(var h=(typeof m=="string"?m:"").split(/[\s,]+/),e=h.length,f=0;f<e;f++)h[f]&&((m=h[f].replace(/\*/g,".*?"))[0]==="-"?B.skips.push(new RegExp("^"+m.substr(1)+"$")):B.names.push(new RegExp("^"+m+"$")))},B.enabled=function(m){var h,e;for(h=0,e=B.skips.length;h<e;h++)if(B.skips[h].test(m))return!1;for(h=0,e=B.names.length;h<e;h++)if(B.names[h].test(m))return!0;return!1},B.humanize=r("ms"),B.names=[],B.skips=[],B.formatters={}},{ms:573}],573:[function(r,I,B){var t=1e3,d=6e4,m=60*d,h=24*m;function e(f,l,o){if(!(f<l))return f<1.5*l?Math.floor(f/l)+" "+o:Math.ceil(f/l)+" "+o+"s"}I.exports=function(f,l){l=l||{};var o,u=typeof f;if(u==="string"&&f.length>0)return function(s){if(!((s=String(s)).length>100)){var i=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(s);if(!!i){var c=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*c;case"days":case"day":case"d":return c*h;case"hours":case"hour":case"hrs":case"hr":case"h":return c*m;case"minutes":case"minute":case"mins":case"min":case"m":return c*d;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}(f);if(u==="number"&&isNaN(f)===!1)return l.long?e(o=f,h,"day")||e(o,m,"hour")||e(o,d,"minute")||e(o,t,"second")||o+" ms":function(s){return s>=h?Math.round(s/h)+"d":s>=m?Math.round(s/m)+"h":s>=d?Math.round(s/d)+"m":s>=t?Math.round(s/t)+"s":s+"ms"}(f);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(f))}},{}],574:[function(r,I,B){var t=r("parenthesis");I.exports=function(d,m,h){if(d==null)throw Error("First argument should be a string");if(m==null)throw Error("Separator should be a string or a RegExp");h?(typeof h=="string"||Array.isArray(h))&&(h={ignore:h}):h={},h.escape==null&&(h.escape=!0),h.ignore==null?h.ignore=["[]","()","{}","<>",'""',"''","``","\u201C\u201D","\xAB\xBB"]:(typeof h.ignore=="string"&&(h.ignore=[h.ignore]),h.ignore=h.ignore.map(function(i){return i.length===1&&(i+=i),i}));var e=t.parse(d,{flat:!0,brackets:h.ignore}),f=e[0].split(m);if(h.escape){for(var l=[],o=0;o<f.length;o++){var u=f[o],s=f[o+1];u[u.length-1]==="\\"&&u[u.length-2]!=="\\"?(l.push(u+m+s),o++):l.push(u)}f=l}for(o=0;o<f.length;o++)e[0]=f[o],f[o]=t.stringify(e,{flat:!0});return f}},{parenthesis:480}],575:[function(r,I,B){I.exports=function(t){for(var d=t.length,m=new Array(d),h=new Array(d),e=new Array(d),f=new Array(d),l=new Array(d),o=new Array(d),u=0;u<d;++u)m[u]=-1,h[u]=0,e[u]=!1,f[u]=0,l[u]=-1,o[u]=[];var s,i=0,c=[],n=[];function a(y){var v=[y],b=[y];for(m[y]=h[y]=i,e[y]=!0,i+=1;b.length>0;){y=b[b.length-1];var x=t[y];if(f[y]<x.length){for(var T=f[y];T<x.length;++T){var A=x[T];if(m[A]<0){m[A]=h[A]=i,e[A]=!0,i+=1,v.push(A),b.push(A);break}e[A]&&(h[y]=0|Math.min(h[y],h[A])),l[A]>=0&&o[y].push(l[A])}f[y]=T}else{if(h[y]===m[y]){var S=[],w=[],E=0;for(T=v.length-1;T>=0;--T){var k=v[T];if(e[k]=!1,S.push(k),w.push(o[k]),E+=o[k].length,l[k]=c.length,k===y){v.length=T;break}}c.push(S);var L=new Array(E);for(T=0;T<w.length;T++)for(var M=0;M<w[T].length;M++)L[--E]=w[T][M];n.push(L)}b.pop()}}}for(u=0;u<d;++u)m[u]<0&&a(u);for(u=0;u<n.length;u++){var g=n[u];if(g.length!==0){g.sort(function(y,v){return y-v}),s=[g[0]];for(var p=1;p<g.length;p++)g[p]!==g[p-1]&&s.push(g[p]);n[u]=s}}return{components:c,adjacencyList:n}}},{}],576:[function(r,I,B){I.exports=function(e,f){if(e.dimension<=0)return{positions:[],cells:[]};if(e.dimension===1)return function(u,s){for(var i=d(u,s),c=i.length,n=new Array(c),a=new Array(c),g=0;g<c;++g)n[g]=[i[g]],a[g]=[g];return{positions:n,cells:a}}(e,f);var l=e.order.join()+"-"+e.dtype,o=h[l];return f=+f||0,o||(o=h[l]=function(u,s){var i=u.length+"d",c=m[i];if(c)return c(t,u,s)}(e.order,e.dtype)),o(e,f)};var t=r("ndarray-extract-contour"),d=r("zero-crossings"),m={"2d":function(e,f,l){var o=e({order:f,scalarArguments:3,getters:l==="generic"?[0]:void 0,phase:function(u,s,i,c){return u>c|0},vertex:function(u,s,i,c,n,a,g,p,y,v,b,x,T){var A=(g<<0)+(p<<1)+(y<<2)+(v<<3)|0;if(A!==0&&A!==15)switch(A){case 0:b.push([u-.5,s-.5]);break;case 1:b.push([u-.25-.25*(c+i-2*T)/(i-c),s-.25-.25*(n+i-2*T)/(i-n)]);break;case 2:b.push([u-.75-.25*(-c-i+2*T)/(c-i),s-.25-.25*(a+c-2*T)/(c-a)]);break;case 3:b.push([u-.5,s-.5-.5*(n+i+a+c-4*T)/(i-n+c-a)]);break;case 4:b.push([u-.25-.25*(a+n-2*T)/(n-a),s-.75-.25*(-n-i+2*T)/(n-i)]);break;case 5:b.push([u-.5-.5*(c+i+a+n-4*T)/(i-c+n-a),s-.5]);break;case 6:b.push([u-.5-.25*(-c-i+a+n)/(c-i+n-a),s-.5-.25*(-n-i+a+c)/(n-i+c-a)]);break;case 7:b.push([u-.75-.25*(a+n-2*T)/(n-a),s-.75-.25*(a+c-2*T)/(c-a)]);break;case 8:b.push([u-.75-.25*(-a-n+2*T)/(a-n),s-.75-.25*(-a-c+2*T)/(a-c)]);break;case 9:b.push([u-.5-.25*(c+i+-a-n)/(i-c+a-n),s-.5-.25*(n+i+-a-c)/(i-n+a-c)]);break;case 10:b.push([u-.5-.5*(-c-i-a-n+4*T)/(c-i+a-n),s-.5]);break;case 11:b.push([u-.25-.25*(-a-n+2*T)/(a-n),s-.75-.25*(n+i-2*T)/(i-n)]);break;case 12:b.push([u-.5,s-.5-.5*(-n-i-a-c+4*T)/(n-i+a-c)]);break;case 13:b.push([u-.75-.25*(c+i-2*T)/(i-c),s-.25-.25*(-a-c+2*T)/(a-c)]);break;case 14:b.push([u-.25-.25*(-c-i+2*T)/(c-i),s-.25-.25*(-n-i+2*T)/(n-i)]);break;case 15:b.push([u-.5,s-.5])}},cell:function(u,s,i,c,n,a,g,p,y){n?p.push([u,s]):p.push([s,u])}});return function(u,s){var i=[],c=[];return o(u,i,c,s),{positions:i,cells:c}}}},h={}},{"ndarray-extract-contour":464,"zero-crossings":631}],577:[function(r,I,B){Object.defineProperty(B,"__esModule",{value:!0});var t=function(f,l){if(Array.isArray(f))return f;if(Symbol.iterator in Object(f))return function(o,u){var s=[],i=!0,c=!1,n=void 0;try{for(var a,g=o[Symbol.iterator]();!(i=(a=g.next()).done)&&(s.push(a.value),!u||s.length!==u);i=!0);}catch(p){c=!0,n=p}finally{try{!i&&g.return&&g.return()}finally{if(c)throw n}}return s}(f,l);throw new TypeError("Invalid attempt to destructure non-iterable instance")},d=2*Math.PI,m=function(f,l,o,u,s,i,c){var n=f.x,a=f.y;return{x:u*(n*=l)-s*(a*=o)+i,y:s*n+u*a+c}},h=function(f,l){var o=l===1.5707963267948966?.551915024494:l===-1.5707963267948966?-.551915024494:4/3*Math.tan(l/4),u=Math.cos(f),s=Math.sin(f),i=Math.cos(f+l),c=Math.sin(f+l);return[{x:u-s*o,y:s+u*o},{x:i+c*o,y:c-i*o},{x:i,y:c}]},e=function(f,l,o,u){var s=f*o+l*u;return s>1&&(s=1),s<-1&&(s=-1),(f*u-l*o<0?-1:1)*Math.acos(s)};B.default=function(f){var l=f.px,o=f.py,u=f.cx,s=f.cy,i=f.rx,c=f.ry,n=f.xAxisRotation,a=n===void 0?0:n,g=f.largeArcFlag,p=g===void 0?0:g,y=f.sweepFlag,v=y===void 0?0:y,b=[];if(i===0||c===0)return[];var x=Math.sin(a*d/360),T=Math.cos(a*d/360),A=T*(l-u)/2+x*(o-s)/2,S=-x*(l-u)/2+T*(o-s)/2;if(A===0&&S===0)return[];i=Math.abs(i),c=Math.abs(c);var w=Math.pow(A,2)/Math.pow(i,2)+Math.pow(S,2)/Math.pow(c,2);w>1&&(i*=Math.sqrt(w),c*=Math.sqrt(w));var E=function(X,K,Z,H,Y,$,z,j,W,ee,J,Q){var te=Math.pow(Y,2),ie=Math.pow($,2),ae=Math.pow(J,2),he=Math.pow(Q,2),se=te*ie-te*he-ie*ae;se<0&&(se=0),se/=te*he+ie*ae;var de=(se=Math.sqrt(se)*(z===j?-1:1))*Y/$*Q,ue=se*-$/Y*J,ve=ee*de-W*ue+(X+Z)/2,ke=W*de+ee*ue+(K+H)/2,Ee=(J-de)/Y,be=(Q-ue)/$,xe=(-J-de)/Y,ce=(-Q-ue)/$,ge=e(1,0,Ee,be),we=e(Ee,be,xe,ce);return j===0&&we>0&&(we-=d),j===1&&we<0&&(we+=d),[ve,ke,ge,we]}(l,o,u,s,i,c,p,v,x,T,A,S),k=t(E,4),L=k[0],M=k[1],P=k[2],D=k[3],N=Math.abs(D)/(d/4);Math.abs(1-N)<1e-7&&(N=1);var U=Math.max(Math.ceil(N),1);D/=U;for(var G=0;G<U;G++)b.push(h(P,D)),P+=D;return b.map(function(X){var K=m(X[0],i,c,T,x,L,M),Z=K.x,H=K.y,Y=m(X[1],i,c,T,x,L,M),$=Y.x,z=Y.y,j=m(X[2],i,c,T,x,L,M);return{x1:Z,y1:H,x2:$,y2:z,x:j.x,y:j.y}})},I.exports=B.default},{}],578:[function(r,I,B){var t=r("parse-svg-path"),d=r("abs-svg-path"),m=r("normalize-svg-path"),h=r("is-svg-path"),e=r("assert");I.exports=function(f){if(Array.isArray(f)&&f.length===1&&typeof f[0]=="string"&&(f=f[0]),typeof f=="string"&&(e(h(f),"String is not an SVG path."),f=t(f)),e(Array.isArray(f),"Argument should be a string or an array of path segments."),f=d(f),!(f=m(f)).length)return[0,0,0,0];for(var l=[1/0,1/0,-1/0,-1/0],o=0,u=f.length;o<u;o++)for(var s=f[o].slice(1),i=0;i<s.length;i+=2)s[i+0]<l[0]&&(l[0]=s[i+0]),s[i+1]<l[1]&&(l[1]=s[i+1]),s[i+0]>l[2]&&(l[2]=s[i+0]),s[i+1]>l[3]&&(l[3]=s[i+1]);return l}},{"abs-svg-path":71,assert:80,"is-svg-path":449,"normalize-svg-path":579,"parse-svg-path":482}],579:[function(r,I,B){I.exports=function(h){for(var e,f=[],l=0,o=0,u=0,s=0,i=null,c=null,n=0,a=0,g=0,p=h.length;g<p;g++){var y=h[g],v=y[0];switch(v){case"M":u=y[1],s=y[2];break;case"A":var b=t({px:n,py:a,cx:y[6],cy:y[7],rx:y[1],ry:y[2],xAxisRotation:y[3],largeArcFlag:y[4],sweepFlag:y[5]});if(!b.length)continue;for(var x,T=0;T<b.length;T++)x=b[T],y=["C",x.x1,x.y1,x.x2,x.y2,x.x,x.y],T<b.length-1&&f.push(y);break;case"S":var A=n,S=a;e!="C"&&e!="S"||(A+=A-l,S+=S-o),y=["C",A,S,y[1],y[2],y[3],y[4]];break;case"T":e=="Q"||e=="T"?(i=2*n-i,c=2*a-c):(i=n,c=a),y=m(n,a,i,c,y[1],y[2]);break;case"Q":i=y[1],c=y[2],y=m(n,a,y[1],y[2],y[3],y[4]);break;case"L":y=d(n,a,y[1],y[2]);break;case"H":y=d(n,a,y[1],a);break;case"V":y=d(n,a,n,y[1]);break;case"Z":y=d(n,a,u,s)}e=v,n=y[y.length-2],a=y[y.length-1],y.length>4?(l=y[y.length-4],o=y[y.length-3]):(l=n,o=a),f.push(y)}return f};var t=r("svg-arc-to-cubic-bezier");function d(h,e,f,l){return["C",h,e,f,l,f,l]}function m(h,e,f,l,o,u){return["C",h/3+2/3*f,e/3+2/3*l,o/3+2/3*f,u/3+2/3*l,o,u]}},{"svg-arc-to-cubic-bezier":577}],580:[function(r,I,B){var t,d=r("svg-path-bounds"),m=r("parse-svg-path"),h=r("draw-svg-path"),e=r("is-svg-path"),f=r("bitmap-sdf"),l=document.createElement("canvas"),o=l.getContext("2d");I.exports=function(u,s){if(!e(u))throw Error("Argument should be valid svg path string");s||(s={});var i,c;s.shape?(i=s.shape[0],c=s.shape[1]):(i=l.width=s.w||s.width||200,c=l.height=s.h||s.height||200);var n=Math.min(i,c),a=s.stroke||0,g=s.viewbox||s.viewBox||d(u),p=[i/(g[2]-g[0]),c/(g[3]-g[1])],y=Math.min(p[0]||0,p[1]||0)/2;if(o.fillStyle="black",o.fillRect(0,0,i,c),o.fillStyle="white",a&&(typeof a!="number"&&(a=1),o.strokeStyle=a>0?"white":"black",o.lineWidth=Math.abs(a)),o.translate(.5*i,.5*c),o.scale(y,y),function(){if(t!=null)return t;var x=document.createElement("canvas").getContext("2d");if(x.canvas.width=x.canvas.height=1,!window.Path2D)return t=!1;var T=new Path2D("M0,0h1v1h-1v-1Z");x.fillStyle="black",x.fill(T);var A=x.getImageData(0,0,1,1);return t=A&&A.data&&A.data[3]===255}()){var v=new Path2D(u);o.fill(v),a&&o.stroke(v)}else{var b=m(u);h(o,b),o.fill(),a&&o.stroke()}return o.setTransform(1,0,0,1,0,0),f(o,{cutoff:s.cutoff!=null?s.cutoff:.5,radius:s.radius!=null?s.radius:.5*n})}},{"bitmap-sdf":105,"draw-svg-path":180,"is-svg-path":449,"parse-svg-path":482,"svg-path-bounds":578}],581:[function(r,I,B){(function(t){(function(){I.exports=function e(f,l,o){o=o||{};var u=h[f];u||(u=h[f]={" ":{data:new Float32Array(0),shape:.2}});var s=u[l];if(!s)if(l.length<=1||!/\d/.test(l))s=u[l]=function(T){for(var A=T.cells,S=T.positions,w=new Float32Array(6*A.length),E=0,k=0,L=0;L<A.length;++L)for(var M=A[L],P=0;P<3;++P){var D=S[M[P]];w[E++]=D[0],w[E++]=D[1]+1.4,k=Math.max(D[0],k)}return{data:w,shape:k}}(d(l,{triangles:!0,font:f,textAlign:o.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var i=l.split(/(\d|\s)/),c=new Array(i.length),n=0,a=0,g=0;g<i.length;++g)c[g]=e(f,i[g]),n+=c[g].data.length,a+=c[g].shape,g>0&&(a+=.02);var p=new Float32Array(n),y=0,v=-.5*a;for(g=0;g<c.length;++g){for(var b=c[g].data,x=0;x<b.length;x+=2)p[y++]=b[x]+v,p[y++]=b[x+1];v+=c[g].shape+.02}s=u[l]={data:p,shape:a}}return s};var d=r("vectorize-text"),m=window||t.global||{},h=m.__TEXT_CACHE||{};m.__TEXT_CACHE={}}).call(this)}).call(this,r("_process"))},{_process:514,"vectorize-text":607}],582:[function(r,I,B){(function(t,d){(function(){var m=r("process/browser.js").nextTick,h=Function.prototype.apply,e=Array.prototype.slice,f={},l=0;function o(u,s){this._id=u,this._clearFn=s}B.setTimeout=function(){return new o(h.call(setTimeout,window,arguments),clearTimeout)},B.setInterval=function(){return new o(h.call(setInterval,window,arguments),clearInterval)},B.clearTimeout=B.clearInterval=function(u){u.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},B.enroll=function(u,s){clearTimeout(u._idleTimeoutId),u._idleTimeout=s},B.unenroll=function(u){clearTimeout(u._idleTimeoutId),u._idleTimeout=-1},B._unrefActive=B.active=function(u){clearTimeout(u._idleTimeoutId);var s=u._idleTimeout;s>=0&&(u._idleTimeoutId=setTimeout(function(){u._onTimeout&&u._onTimeout()},s))},B.setImmediate=typeof t=="function"?t:function(u){var s=l++,i=!(arguments.length<2)&&e.call(arguments,1);return f[s]=!0,m(function(){f[s]&&(i?u.apply(null,i):u.call(null),B.clearImmediate(s))}),s},B.clearImmediate=typeof d=="function"?d:function(u){delete f[u]}}).call(this)}).call(this,r("timers").setImmediate,r("timers").clearImmediate)},{"process/browser.js":514,timers:582}],583:[function(r,I,B){(function(t){var d=/^\s+/,m=/\s+$/,h=0,e=t.round,f=t.min,l=t.max,o=t.random;function u(W,ee){if(ee=ee||{},(W=W||"")instanceof u)return W;if(!(this instanceof u))return new u(W,ee);var J=function(Q){var te={r:0,g:0,b:0},ie=1,ae=null,he=null,se=null,de=!1,ue=!1;typeof Q=="string"&&(Q=function(be){be=be.replace(d,"").replace(m,"").toLowerCase();var xe,ce=!1;if(L[be])be=L[be],ce=!0;else if(be=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(xe=z.rgb.exec(be))?{r:xe[1],g:xe[2],b:xe[3]}:(xe=z.rgba.exec(be))?{r:xe[1],g:xe[2],b:xe[3],a:xe[4]}:(xe=z.hsl.exec(be))?{h:xe[1],s:xe[2],l:xe[3]}:(xe=z.hsla.exec(be))?{h:xe[1],s:xe[2],l:xe[3],a:xe[4]}:(xe=z.hsv.exec(be))?{h:xe[1],s:xe[2],v:xe[3]}:(xe=z.hsva.exec(be))?{h:xe[1],s:xe[2],v:xe[3],a:xe[4]}:(xe=z.hex8.exec(be))?{r:U(xe[1]),g:U(xe[2]),b:U(xe[3]),a:Z(xe[4]),format:ce?"name":"hex8"}:(xe=z.hex6.exec(be))?{r:U(xe[1]),g:U(xe[2]),b:U(xe[3]),format:ce?"name":"hex"}:(xe=z.hex4.exec(be))?{r:U(xe[1]+""+xe[1]),g:U(xe[2]+""+xe[2]),b:U(xe[3]+""+xe[3]),a:Z(xe[4]+""+xe[4]),format:ce?"name":"hex8"}:(xe=z.hex3.exec(be))?{r:U(xe[1]+""+xe[1]),g:U(xe[2]+""+xe[2]),b:U(xe[3]+""+xe[3]),format:ce?"name":"hex"}:!1}(Q)),typeof Q=="object"&&(j(Q.r)&&j(Q.g)&&j(Q.b)?(ve=Q.r,ke=Q.g,Ee=Q.b,te={r:255*D(ve,255),g:255*D(ke,255),b:255*D(Ee,255)},de=!0,ue=String(Q.r).substr(-1)==="%"?"prgb":"rgb"):j(Q.h)&&j(Q.s)&&j(Q.v)?(ae=X(Q.s),he=X(Q.v),te=function(be,xe,ce){be=6*D(be,360),xe=D(xe,100),ce=D(ce,100);var ge=t.floor(be),we=be-ge,Me=ce*(1-xe),Se=ce*(1-we*xe),ze=ce*(1-(1-we)*xe),Fe=ge%6;return{r:255*[ce,Se,Me,Me,ze,ce][Fe],g:255*[ze,ce,ce,Se,Me,Me][Fe],b:255*[Me,Me,ze,ce,ce,Se][Fe]}}(Q.h,ae,he),de=!0,ue="hsv"):j(Q.h)&&j(Q.s)&&j(Q.l)&&(ae=X(Q.s),se=X(Q.l),te=function(be,xe,ce){var ge,we,Me;function Se(Ye,rt,Oe){return Oe<0&&(Oe+=1),Oe>1&&(Oe-=1),Oe<1/6?Ye+6*(rt-Ye)*Oe:Oe<.5?rt:Oe<2/3?Ye+(rt-Ye)*(2/3-Oe)*6:Ye}if(be=D(be,360),xe=D(xe,100),ce=D(ce,100),xe===0)ge=we=Me=ce;else{var ze=ce<.5?ce*(1+xe):ce+xe-ce*xe,Fe=2*ce-ze;ge=Se(Fe,ze,be+1/3),we=Se(Fe,ze,be),Me=Se(Fe,ze,be-1/3)}return{r:255*ge,g:255*we,b:255*Me}}(Q.h,ae,se),de=!0,ue="hsl"),Q.hasOwnProperty("a")&&(ie=Q.a));var ve,ke,Ee;return ie=P(ie),{ok:de,format:Q.format||ue,r:f(255,l(te.r,0)),g:f(255,l(te.g,0)),b:f(255,l(te.b,0)),a:ie}}(W);this._originalInput=W,this._r=J.r,this._g=J.g,this._b=J.b,this._a=J.a,this._roundA=e(100*this._a)/100,this._format=ee.format||J.format,this._gradientType=ee.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=J.ok,this._tc_id=h++}function s(W,ee,J){W=D(W,255),ee=D(ee,255),J=D(J,255);var Q,te,ie=l(W,ee,J),ae=f(W,ee,J),he=(ie+ae)/2;if(ie==ae)Q=te=0;else{var se=ie-ae;switch(te=he>.5?se/(2-ie-ae):se/(ie+ae),ie){case W:Q=(ee-J)/se+(ee<J?6:0);break;case ee:Q=(J-W)/se+2;break;case J:Q=(W-ee)/se+4}Q/=6}return{h:Q,s:te,l:he}}function i(W,ee,J){W=D(W,255),ee=D(ee,255),J=D(J,255);var Q,te,ie=l(W,ee,J),ae=f(W,ee,J),he=ie,se=ie-ae;if(te=ie===0?0:se/ie,ie==ae)Q=0;else{switch(ie){case W:Q=(ee-J)/se+(ee<J?6:0);break;case ee:Q=(J-W)/se+2;break;case J:Q=(W-ee)/se+4}Q/=6}return{h:Q,s:te,v:he}}function c(W,ee,J,Q){var te=[G(e(W).toString(16)),G(e(ee).toString(16)),G(e(J).toString(16))];return Q&&te[0].charAt(0)==te[0].charAt(1)&&te[1].charAt(0)==te[1].charAt(1)&&te[2].charAt(0)==te[2].charAt(1)?te[0].charAt(0)+te[1].charAt(0)+te[2].charAt(0):te.join("")}function n(W,ee,J,Q){return[G(K(Q)),G(e(W).toString(16)),G(e(ee).toString(16)),G(e(J).toString(16))].join("")}function a(W,ee){ee=ee===0?0:ee||10;var J=u(W).toHsl();return J.s-=ee/100,J.s=N(J.s),u(J)}function g(W,ee){ee=ee===0?0:ee||10;var J=u(W).toHsl();return J.s+=ee/100,J.s=N(J.s),u(J)}function p(W){return u(W).desaturate(100)}function y(W,ee){ee=ee===0?0:ee||10;var J=u(W).toHsl();return J.l+=ee/100,J.l=N(J.l),u(J)}function v(W,ee){ee=ee===0?0:ee||10;var J=u(W).toRgb();return J.r=l(0,f(255,J.r-e(-ee/100*255))),J.g=l(0,f(255,J.g-e(-ee/100*255))),J.b=l(0,f(255,J.b-e(-ee/100*255))),u(J)}function b(W,ee){ee=ee===0?0:ee||10;var J=u(W).toHsl();return J.l-=ee/100,J.l=N(J.l),u(J)}function x(W,ee){var J=u(W).toHsl(),Q=(J.h+ee)%360;return J.h=Q<0?360+Q:Q,u(J)}function T(W){var ee=u(W).toHsl();return ee.h=(ee.h+180)%360,u(ee)}function A(W){var ee=u(W).toHsl(),J=ee.h;return[u(W),u({h:(J+120)%360,s:ee.s,l:ee.l}),u({h:(J+240)%360,s:ee.s,l:ee.l})]}function S(W){var ee=u(W).toHsl(),J=ee.h;return[u(W),u({h:(J+90)%360,s:ee.s,l:ee.l}),u({h:(J+180)%360,s:ee.s,l:ee.l}),u({h:(J+270)%360,s:ee.s,l:ee.l})]}function w(W){var ee=u(W).toHsl(),J=ee.h;return[u(W),u({h:(J+72)%360,s:ee.s,l:ee.l}),u({h:(J+216)%360,s:ee.s,l:ee.l})]}function E(W,ee,J){ee=ee||6,J=J||30;var Q=u(W).toHsl(),te=360/J,ie=[u(W)];for(Q.h=(Q.h-(te*ee>>1)+720)%360;--ee;)Q.h=(Q.h+te)%360,ie.push(u(Q));return ie}function k(W,ee){ee=ee||6;for(var J=u(W).toHsv(),Q=J.h,te=J.s,ie=J.v,ae=[],he=1/ee;ee--;)ae.push(u({h:Q,s:te,v:ie})),ie=(ie+he)%1;return ae}u.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var W=this.toRgb();return(299*W.r+587*W.g+114*W.b)/1e3},getLuminance:function(){var W,ee,J,Q=this.toRgb();return W=Q.r/255,ee=Q.g/255,J=Q.b/255,.2126*(W<=.03928?W/12.92:t.pow((W+.055)/1.055,2.4))+.7152*(ee<=.03928?ee/12.92:t.pow((ee+.055)/1.055,2.4))+.0722*(J<=.03928?J/12.92:t.pow((J+.055)/1.055,2.4))},setAlpha:function(W){return this._a=P(W),this._roundA=e(100*this._a)/100,this},toHsv:function(){var W=i(this._r,this._g,this._b);return{h:360*W.h,s:W.s,v:W.v,a:this._a}},toHsvString:function(){var W=i(this._r,this._g,this._b),ee=e(360*W.h),J=e(100*W.s),Q=e(100*W.v);return this._a==1?"hsv("+ee+", "+J+"%, "+Q+"%)":"hsva("+ee+", "+J+"%, "+Q+"%, "+this._roundA+")"},toHsl:function(){var W=s(this._r,this._g,this._b);return{h:360*W.h,s:W.s,l:W.l,a:this._a}},toHslString:function(){var W=s(this._r,this._g,this._b),ee=e(360*W.h),J=e(100*W.s),Q=e(100*W.l);return this._a==1?"hsl("+ee+", "+J+"%, "+Q+"%)":"hsla("+ee+", "+J+"%, "+Q+"%, "+this._roundA+")"},toHex:function(W){return c(this._r,this._g,this._b,W)},toHexString:function(W){return"#"+this.toHex(W)},toHex8:function(W){return function(ee,J,Q,te,ie){var ae=[G(e(ee).toString(16)),G(e(J).toString(16)),G(e(Q).toString(16)),G(K(te))];return ie&&ae[0].charAt(0)==ae[0].charAt(1)&&ae[1].charAt(0)==ae[1].charAt(1)&&ae[2].charAt(0)==ae[2].charAt(1)&&ae[3].charAt(0)==ae[3].charAt(1)?ae[0].charAt(0)+ae[1].charAt(0)+ae[2].charAt(0)+ae[3].charAt(0):ae.join("")}(this._r,this._g,this._b,this._a,W)},toHex8String:function(W){return"#"+this.toHex8(W)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(100*D(this._r,255))+"%",g:e(100*D(this._g,255))+"%",b:e(100*D(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+e(100*D(this._r,255))+"%, "+e(100*D(this._g,255))+"%, "+e(100*D(this._b,255))+"%)":"rgba("+e(100*D(this._r,255))+"%, "+e(100*D(this._g,255))+"%, "+e(100*D(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(M[c(this._r,this._g,this._b,!0)]||!1)},toFilter:function(W){var ee="#"+n(this._r,this._g,this._b,this._a),J=ee,Q=this._gradientType?"GradientType = 1, ":"";if(W){var te=u(W);J="#"+n(te._r,te._g,te._b,te._a)}return"progid:DXImageTransform.Microsoft.gradient("+Q+"startColorstr="+ee+",endColorstr="+J+")"},toString:function(W){var ee=!!W;W=W||this._format;var J=!1,Q=this._a<1&&this._a>=0;return ee||!Q||W!=="hex"&&W!=="hex6"&&W!=="hex3"&&W!=="hex4"&&W!=="hex8"&&W!=="name"?(W==="rgb"&&(J=this.toRgbString()),W==="prgb"&&(J=this.toPercentageRgbString()),W!=="hex"&&W!=="hex6"||(J=this.toHexString()),W==="hex3"&&(J=this.toHexString(!0)),W==="hex4"&&(J=this.toHex8String(!0)),W==="hex8"&&(J=this.toHex8String()),W==="name"&&(J=this.toName()),W==="hsl"&&(J=this.toHslString()),W==="hsv"&&(J=this.toHsvString()),J||this.toHexString()):W==="name"&&this._a===0?this.toName():this.toRgbString()},clone:function(){return u(this.toString())},_applyModification:function(W,ee){var J=W.apply(null,[this].concat([].slice.call(ee)));return this._r=J._r,this._g=J._g,this._b=J._b,this.setAlpha(J._a),this},lighten:function(){return this._applyModification(y,arguments)},brighten:function(){return this._applyModification(v,arguments)},darken:function(){return this._applyModification(b,arguments)},desaturate:function(){return this._applyModification(a,arguments)},saturate:function(){return this._applyModification(g,arguments)},greyscale:function(){return this._applyModification(p,arguments)},spin:function(){return this._applyModification(x,arguments)},_applyCombination:function(W,ee){return W.apply(null,[this].concat([].slice.call(ee)))},analogous:function(){return this._applyCombination(E,arguments)},complement:function(){return this._applyCombination(T,arguments)},monochromatic:function(){return this._applyCombination(k,arguments)},splitcomplement:function(){return this._applyCombination(w,arguments)},triad:function(){return this._applyCombination(A,arguments)},tetrad:function(){return this._applyCombination(S,arguments)}},u.fromRatio=function(W,ee){if(typeof W=="object"){var J={};for(var Q in W)W.hasOwnProperty(Q)&&(J[Q]=Q==="a"?W[Q]:X(W[Q]));W=J}return u(W,ee)},u.equals=function(W,ee){return!(!W||!ee)&&u(W).toRgbString()==u(ee).toRgbString()},u.random=function(){return u.fromRatio({r:o(),g:o(),b:o()})},u.mix=function(W,ee,J){J=J===0?0:J||50;var Q=u(W).toRgb(),te=u(ee).toRgb(),ie=J/100;return u({r:(te.r-Q.r)*ie+Q.r,g:(te.g-Q.g)*ie+Q.g,b:(te.b-Q.b)*ie+Q.b,a:(te.a-Q.a)*ie+Q.a})},u.readability=function(W,ee){var J=u(W),Q=u(ee);return(t.max(J.getLuminance(),Q.getLuminance())+.05)/(t.min(J.getLuminance(),Q.getLuminance())+.05)},u.isReadable=function(W,ee,J){var Q,te,ie=u.readability(W,ee);switch(te=!1,(Q=function(ae){var he,se;return he=((ae=ae||{level:"AA",size:"small"}).level||"AA").toUpperCase(),se=(ae.size||"small").toLowerCase(),he!=="AA"&&he!=="AAA"&&(he="AA"),se!=="small"&&se!=="large"&&(se="small"),{level:he,size:se}}(J)).level+Q.size){case"AAsmall":case"AAAlarge":te=ie>=4.5;break;case"AAlarge":te=ie>=3;break;case"AAAsmall":te=ie>=7}return te},u.mostReadable=function(W,ee,J){var Q,te,ie,ae,he=null,se=0;te=(J=J||{}).includeFallbackColors,ie=J.level,ae=J.size;for(var de=0;de<ee.length;de++)(Q=u.readability(W,ee[de]))>se&&(se=Q,he=u(ee[de]));return u.isReadable(W,he,{level:ie,size:ae})||!te?he:(J.includeFallbackColors=!1,u.mostReadable(W,["#fff","#000"],J))};var L=u.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},M=u.hexNames=function(W){var ee={};for(var J in W)W.hasOwnProperty(J)&&(ee[W[J]]=J);return ee}(L);function P(W){return W=parseFloat(W),(isNaN(W)||W<0||W>1)&&(W=1),W}function D(W,ee){(function(Q){return typeof Q=="string"&&Q.indexOf(".")!=-1&&parseFloat(Q)===1})(W)&&(W="100%");var J=function(Q){return typeof Q=="string"&&Q.indexOf("%")!=-1}(W);return W=f(ee,l(0,parseFloat(W))),J&&(W=parseInt(W*ee,10)/100),t.abs(W-ee)<1e-6?1:W%ee/parseFloat(ee)}function N(W){return f(1,l(0,W))}function U(W){return parseInt(W,16)}function G(W){return W.length==1?"0"+W:""+W}function X(W){return W<=1&&(W=100*W+"%"),W}function K(W){return t.round(255*parseFloat(W)).toString(16)}function Z(W){return U(W)/255}var H,Y,$,z=(Y="[\\s|\\(]+("+(H="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+H+")[,|\\s]+("+H+")\\s*\\)?",$="[\\s|\\(]+("+H+")[,|\\s]+("+H+")[,|\\s]+("+H+")[,|\\s]+("+H+")\\s*\\)?",{CSS_UNIT:new RegExp(H),rgb:new RegExp("rgb"+Y),rgba:new RegExp("rgba"+$),hsl:new RegExp("hsl"+Y),hsla:new RegExp("hsla"+$),hsv:new RegExp("hsv"+Y),hsva:new RegExp("hsva"+$),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function j(W){return!!z.CSS_UNIT.exec(W)}I!==void 0&&I.exports?I.exports=u:window.tinycolor=u})(Math)},{}],584:[function(r,I,B){I.exports=d,I.exports.float32=I.exports.float=d,I.exports.fract32=I.exports.fract=function(m,h){if(m.length){if(m instanceof Float32Array)return new Float32Array(m.length);h instanceof Float32Array||(h=d(m));for(var e=0,f=h.length;e<f;e++)h[e]=m[e]-h[e];return h}return d(m-d(m))};var t=new Float32Array(1);function d(m){return m.length?m instanceof Float32Array?m:new Float32Array(m):(t[0]=m,t[0])}},{}],585:[function(r,I,B){var t=r("parse-unit");I.exports=m;function d(h,e){var f=t(getComputedStyle(h).getPropertyValue(e));return f[0]*m(f[1],h)}function m(h,e){switch(e=e||document.body,h=(h||"px").trim().toLowerCase(),e!==window&&e!==document||(e=document.body),h){case"%":return e.clientHeight/100;case"ch":case"ex":return function(f,l){var o=document.createElement("div");o.style["font-size"]="128"+f,l.appendChild(o);var u=d(o,"font-size")/128;return l.removeChild(o),u}(h,e);case"em":return d(e,"font-size");case"rem":return d(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}},{"parse-unit":483}],586:[function(r,I,B){(function(t,d){d(typeof B=="object"&&I!==void 0?B:(t=t||self).topojson=t.topojson||{})})(this,function(t){function d(n){return n}function m(n){if(n==null)return d;var a,g,p=n.scale[0],y=n.scale[1],v=n.translate[0],b=n.translate[1];return function(x,T){T||(a=g=0);var A=2,S=x.length,w=new Array(S);for(w[0]=(a+=x[0])*p+v,w[1]=(g+=x[1])*y+b;A<S;)w[A]=x[A],++A;return w}}function h(n){var a,g=m(n.transform),p=1/0,y=p,v=-p,b=-p;function x(A){(A=g(A))[0]<p&&(p=A[0]),A[0]>v&&(v=A[0]),A[1]<y&&(y=A[1]),A[1]>b&&(b=A[1])}function T(A){switch(A.type){case"GeometryCollection":A.geometries.forEach(T);break;case"Point":x(A.coordinates);break;case"MultiPoint":A.coordinates.forEach(x)}}for(a in n.arcs.forEach(function(A){for(var S,w=-1,E=A.length;++w<E;)(S=g(A[w],w))[0]<p&&(p=S[0]),S[0]>v&&(v=S[0]),S[1]<y&&(y=S[1]),S[1]>b&&(b=S[1])}),n.objects)T(n.objects[a]);return[p,y,v,b]}function e(n,a){var g=a.id,p=a.bbox,y=a.properties==null?{}:a.properties,v=f(n,a);return g==null&&p==null?{type:"Feature",properties:y,geometry:v}:p==null?{type:"Feature",id:g,properties:y,geometry:v}:{type:"Feature",id:g,bbox:p,properties:y,geometry:v}}function f(n,a){var g=m(n.transform),p=n.arcs;function y(A,S){S.length&&S.pop();for(var w=p[A<0?~A:A],E=0,k=w.length;E<k;++E)S.push(g(w[E],E));A<0&&function(L,M){for(var P,D=L.length,N=D-M;N<--D;)P=L[N],L[N++]=L[D],L[D]=P}(S,k)}function v(A){return g(A)}function b(A){for(var S=[],w=0,E=A.length;w<E;++w)y(A[w],S);return S.length<2&&S.push(S[0]),S}function x(A){for(var S=b(A);S.length<4;)S.push(S[0]);return S}function T(A){return A.map(x)}return function A(S){var w,E=S.type;switch(E){case"GeometryCollection":return{type:E,geometries:S.geometries.map(A)};case"Point":w=v(S.coordinates);break;case"MultiPoint":w=S.coordinates.map(v);break;case"LineString":w=b(S.arcs);break;case"MultiLineString":w=S.arcs.map(b);break;case"Polygon":w=T(S.arcs);break;case"MultiPolygon":w=S.arcs.map(T);break;default:return null}return{type:E,coordinates:w}}(a)}function l(n,a){var g={},p={},y={},v=[],b=-1;function x(T,A){for(var S in T){var w=T[S];delete A[w.start],delete w.start,delete w.end,w.forEach(function(E){g[E<0?~E:E]=1}),v.push(w)}}return a.forEach(function(T,A){var S,w=n.arcs[T<0?~T:T];w.length<3&&!w[1][0]&&!w[1][1]&&(S=a[++b],a[b]=T,a[A]=S)}),a.forEach(function(T){var A,S,w=function(P){var D,N=n.arcs[P<0?~P:P],U=N[0];return n.transform?(D=[0,0],N.forEach(function(G){D[0]+=G[0],D[1]+=G[1]})):D=N[N.length-1],P<0?[D,U]:[U,D]}(T),E=w[0],k=w[1];if(A=y[E])if(delete y[A.end],A.push(T),A.end=k,S=p[k]){delete p[S.start];var L=S===A?A:A.concat(S);p[L.start=A.start]=y[L.end=S.end]=L}else p[A.start]=y[A.end]=A;else if(A=p[k])if(delete p[A.start],A.unshift(T),A.start=E,S=y[E]){delete y[S.end];var M=S===A?A:S.concat(A);p[M.start=S.start]=y[M.end=A.end]=M}else p[A.start]=y[A.end]=A;else p[(A=[T]).start=E]=y[A.end=k]=A}),x(y,p),x(p,y),a.forEach(function(T){g[T<0?~T:T]||v.push([T])}),v}function o(n,a,g){var p,y,v;if(arguments.length>1)p=u(n,a,g);else for(y=0,p=new Array(v=n.arcs.length);y<v;++y)p[y]=y;return{type:"MultiLineString",arcs:l(n,p)}}function u(n,a,g){var p,y=[],v=[];function b(A){var S=A<0?~A:A;(v[S]||(v[S]=[])).push({i:A,g:p})}function x(A){A.forEach(b)}function T(A){A.forEach(x)}return function A(S){switch(p=S,S.type){case"GeometryCollection":S.geometries.forEach(A);break;case"LineString":x(S.arcs);break;case"MultiLineString":case"Polygon":T(S.arcs);break;case"MultiPolygon":(function(w){w.forEach(T)})(S.arcs)}}(a),v.forEach(g==null?function(A){y.push(A[0].i)}:function(A){g(A[0].g,A[A.length-1].g)&&y.push(A[0].i)}),y}function s(n,a){var g={},p=[],y=[];function v(x){x.forEach(function(T){T.forEach(function(A){(g[A=A<0?~A:A]||(g[A]=[])).push(x)})}),p.push(x)}function b(x){return function(T){for(var A,S=-1,w=T.length,E=T[w-1],k=0;++S<w;)A=E,E=T[S],k+=A[0]*E[1]-A[1]*E[0];return Math.abs(k)}(f(n,{type:"Polygon",arcs:[x]}).coordinates[0])}return a.forEach(function x(T){switch(T.type){case"GeometryCollection":T.geometries.forEach(x);break;case"Polygon":v(T.arcs);break;case"MultiPolygon":T.arcs.forEach(v)}}),p.forEach(function(x){if(!x._){var T=[],A=[x];for(x._=1,y.push(T);x=A.pop();)T.push(x),x.forEach(function(S){S.forEach(function(w){g[w<0?~w:w].forEach(function(E){E._||(E._=1,A.push(E))})})})}}),p.forEach(function(x){delete x._}),{type:"MultiPolygon",arcs:y.map(function(x){var T,A=[];if(x.forEach(function(L){L.forEach(function(M){M.forEach(function(P){g[P<0?~P:P].length<2&&A.push(P)})})}),(T=(A=l(n,A)).length)>1)for(var S,w,E=1,k=b(A[0]);E<T;++E)(S=b(A[E]))>k&&(w=A[0],A[0]=A[E],A[E]=w,k=S);return A}).filter(function(x){return x.length>0})}}function i(n,a){for(var g=0,p=n.length;g<p;){var y=g+p>>>1;n[y]<a?g=y+1:p=y}return g}function c(n){if(n==null)return d;var a,g,p=n.scale[0],y=n.scale[1],v=n.translate[0],b=n.translate[1];return function(x,T){T||(a=g=0);var A=2,S=x.length,w=new Array(S),E=Math.round((x[0]-v)/p),k=Math.round((x[1]-b)/y);for(w[0]=E-a,a=E,w[1]=k-g,g=k;A<S;)w[A]=x[A],++A;return w}}t.bbox=h,t.feature=function(n,a){return typeof a=="string"&&(a=n.objects[a]),a.type==="GeometryCollection"?{type:"FeatureCollection",features:a.geometries.map(function(g){return e(n,g)})}:e(n,a)},t.merge=function(n){return f(n,s.apply(this,arguments))},t.mergeArcs=s,t.mesh=function(n){return f(n,o.apply(this,arguments))},t.meshArcs=o,t.neighbors=function(n){var a={},g=n.map(function(){return[]});function p(L,M){L.forEach(function(P){P<0&&(P=~P);var D=a[P];D?D.push(M):a[P]=[M]})}function y(L,M){L.forEach(function(P){p(P,M)})}var v={LineString:p,MultiLineString:y,Polygon:y,MultiPolygon:function(L,M){L.forEach(function(P){y(P,M)})}};for(var b in n.forEach(function L(M,P){M.type==="GeometryCollection"?M.geometries.forEach(function(D){L(D,P)}):M.type in v&&v[M.type](M.arcs,P)}),a)for(var x=a[b],T=x.length,A=0;A<T;++A)for(var S=A+1;S<T;++S){var w,E=x[A],k=x[S];(w=g[E])[b=i(w,k)]!==k&&w.splice(b,0,k),(w=g[k])[b=i(w,E)]!==E&&w.splice(b,0,E)}return g},t.quantize=function(n,a){if(n.transform)throw new Error("already quantized");if(a&&a.scale)x=n.bbox;else{if(!((g=Math.floor(a))>=2))throw new Error("n must be \u22652");var g,p=(x=n.bbox||h(n))[0],y=x[1],v=x[2],b=x[3];a={scale:[v-p?(v-p)/(g-1):1,b-y?(b-y)/(g-1):1],translate:[p,y]}}var x,T,A=c(a),S=n.objects,w={};function E(L){return A(L)}function k(L){var M;switch(L.type){case"GeometryCollection":M={type:"GeometryCollection",geometries:L.geometries.map(k)};break;case"Point":M={type:"Point",coordinates:E(L.coordinates)};break;case"MultiPoint":M={type:"MultiPoint",coordinates:L.coordinates.map(E)};break;default:return L}return L.id!=null&&(M.id=L.id),L.bbox!=null&&(M.bbox=L.bbox),L.properties!=null&&(M.properties=L.properties),M}for(T in S)w[T]=k(S[T]);return{type:"Topology",bbox:x,transform:a,objects:w,arcs:n.arcs.map(function(L){var M,P=0,D=1,N=L.length,U=new Array(N);for(U[0]=A(L[0],0);++P<N;)((M=A(L[P],P))[0]||M[1])&&(U[D++]=M);return D===1&&(U[D++]=[0,0]),U.length=D,U})}},t.transform=m,t.untransform=c,Object.defineProperty(t,"__esModule",{value:!0})})},{}],587:[function(r,I,B){I.exports=function(n){var a=(n=n||{}).center||[0,0,0],g=n.up||[0,1,0],p=n.right||u(g),y=n.radius||1,v=n.theta||0,b=n.phi||0;if(a=[].slice.call(a,0,3),g=[].slice.call(g,0,3),e(g,g),p=[].slice.call(p,0,3),e(p,p),"eye"in n){var x=n.eye,T=[x[0]-a[0],x[1]-a[1],x[2]-a[2]];h(p,T,g),l(p[0],p[1],p[2])<1e-6?p=u(g):e(p,p),y=l(T[0],T[1],T[2]);var A=f(g,T)/y,S=f(p,T)/y;b=Math.acos(A),v=Math.acos(S)}return y=Math.log(y),new s(n.zoomMin,n.zoomMax,a,g,p,y,v,b)};var t=r("filtered-vector"),d=r("gl-mat4/invert"),m=r("gl-mat4/rotate"),h=r("gl-vec3/cross"),e=r("gl-vec3/normalize"),f=r("gl-vec3/dot");function l(n,a,g){return Math.sqrt(Math.pow(n,2)+Math.pow(a,2)+Math.pow(g,2))}function o(n){return Math.min(1,Math.max(-1,n))}function u(n){var a=Math.abs(n[0]),g=Math.abs(n[1]),p=Math.abs(n[2]),y=[0,0,0];a>Math.max(g,p)?y[2]=1:g>Math.max(a,p)?y[0]=1:y[1]=1;for(var v=0,b=0,x=0;x<3;++x)v+=n[x]*n[x],b+=y[x]*n[x];for(x=0;x<3;++x)y[x]-=b/v*n[x];return e(y,y),y}function s(n,a,g,p,y,v,b,x){this.center=t(g),this.up=t(p),this.right=t(y),this.radius=t([v]),this.angle=t([b,x]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(n,a),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var T=0;T<16;++T)this.computedMatrix[T]=.5;this.recalcMatrix(0)}var i=s.prototype;i.setDistanceLimits=function(n,a){n=n>0?Math.log(n):-1/0,a=a>0?Math.log(a):1/0,a=Math.max(a,n),this.radius.bounds[0][0]=n,this.radius.bounds[1][0]=a},i.getDistanceLimits=function(n){var a=this.radius.bounds[0];return n?(n[0]=Math.exp(a[0][0]),n[1]=Math.exp(a[1][0]),n):[Math.exp(a[0][0]),Math.exp(a[1][0])]},i.recalcMatrix=function(n){this.center.curve(n),this.up.curve(n),this.right.curve(n),this.radius.curve(n),this.angle.curve(n);for(var a=this.computedUp,g=this.computedRight,p=0,y=0,v=0;v<3;++v)y+=a[v]*g[v],p+=a[v]*a[v];var b=Math.sqrt(p),x=0;for(v=0;v<3;++v)g[v]-=a[v]*y/p,x+=g[v]*g[v],a[v]/=b;var T=Math.sqrt(x);for(v=0;v<3;++v)g[v]/=T;var A=this.computedToward;h(A,a,g),e(A,A);var S=Math.exp(this.computedRadius[0]),w=this.computedAngle[0],E=this.computedAngle[1],k=Math.cos(w),L=Math.sin(w),M=Math.cos(E),P=Math.sin(E),D=this.computedCenter,N=k*M,U=L*M,G=P,X=-k*P,K=-L*P,Z=M,H=this.computedEye,Y=this.computedMatrix;for(v=0;v<3;++v){var $=N*g[v]+U*A[v]+G*a[v];Y[4*v+1]=X*g[v]+K*A[v]+Z*a[v],Y[4*v+2]=$,Y[4*v+3]=0}var z=Y[1],j=Y[5],W=Y[9],ee=Y[2],J=Y[6],Q=Y[10],te=j*Q-W*J,ie=W*ee-z*Q,ae=z*J-j*ee,he=l(te,ie,ae);for(te/=he,ie/=he,ae/=he,Y[0]=te,Y[4]=ie,Y[8]=ae,v=0;v<3;++v)H[v]=D[v]+Y[2+4*v]*S;for(v=0;v<3;++v){x=0;for(var se=0;se<3;++se)x+=Y[v+4*se]*H[se];Y[12+v]=-x}Y[15]=1},i.getMatrix=function(n,a){this.recalcMatrix(n);var g=this.computedMatrix;if(a){for(var p=0;p<16;++p)a[p]=g[p];return a}return g};var c=[0,0,0];i.rotate=function(n,a,g,p){if(this.angle.move(n,a,g),p){this.recalcMatrix(n);var y=this.computedMatrix;c[0]=y[2],c[1]=y[6],c[2]=y[10];for(var v=this.computedUp,b=this.computedRight,x=this.computedToward,T=0;T<3;++T)y[4*T]=v[T],y[4*T+1]=b[T],y[4*T+2]=x[T];for(m(y,y,p,c),T=0;T<3;++T)v[T]=y[4*T],b[T]=y[4*T+1];this.up.set(n,v[0],v[1],v[2]),this.right.set(n,b[0],b[1],b[2])}},i.pan=function(n,a,g,p){a=a||0,g=g||0,p=p||0,this.recalcMatrix(n);var y=this.computedMatrix,v=(Math.exp(this.computedRadius[0]),y[1]),b=y[5],x=y[9],T=l(v,b,x);v/=T,b/=T,x/=T;var A=y[0],S=y[4],w=y[8],E=A*v+S*b+w*x,k=l(A-=v*E,S-=b*E,w-=x*E),L=(A/=k)*a+v*g,M=(S/=k)*a+b*g,P=(w/=k)*a+x*g;this.center.move(n,L,M,P);var D=Math.exp(this.computedRadius[0]);D=Math.max(1e-4,D+p),this.radius.set(n,Math.log(D))},i.translate=function(n,a,g,p){this.center.move(n,a||0,g||0,p||0)},i.setMatrix=function(n,a,g,p){var y=1;typeof g=="number"&&(y=0|g),(y<0||y>3)&&(y=1);var v=(y+2)%3;a||(this.recalcMatrix(n),a=this.computedMatrix);var b=a[y],x=a[y+4],T=a[y+8];if(p){var A=Math.abs(b),S=Math.abs(x),w=Math.abs(T),E=Math.max(A,S,w);A===E?(b=b<0?-1:1,x=T=0):w===E?(T=T<0?-1:1,b=x=0):(x=x<0?-1:1,b=T=0)}else{var k=l(b,x,T);b/=k,x/=k,T/=k}var L,M,P=a[v],D=a[v+4],N=a[v+8],U=P*b+D*x+N*T,G=l(P-=b*U,D-=x*U,N-=T*U),X=x*(N/=G)-T*(D/=G),K=T*(P/=G)-b*N,Z=b*D-x*P,H=l(X,K,Z);if(X/=H,K/=H,Z/=H,this.center.jump(n,ke,Ee,be),this.radius.idle(n),this.up.jump(n,b,x,T),this.right.jump(n,P,D,N),y===2){var Y=a[1],$=a[5],z=a[9],j=Y*P+$*D+z*N,W=Y*X+$*K+z*Z;L=te<0?-Math.PI/2:Math.PI/2,M=Math.atan2(W,j)}else{var ee=a[2],J=a[6],Q=a[10],te=ee*b+J*x+Q*T,ie=ee*P+J*D+Q*N,ae=ee*X+J*K+Q*Z;L=Math.asin(o(te)),M=Math.atan2(ae,ie)}this.angle.jump(n,M,L),this.recalcMatrix(n);var he=a[2],se=a[6],de=a[10],ue=this.computedMatrix;d(ue,a);var ve=ue[15],ke=ue[12]/ve,Ee=ue[13]/ve,be=ue[14]/ve,xe=Math.exp(this.computedRadius[0]);this.center.jump(n,ke-he*xe,Ee-se*xe,be-de*xe)},i.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},i.idle=function(n){this.center.idle(n),this.up.idle(n),this.right.idle(n),this.radius.idle(n),this.angle.idle(n)},i.flush=function(n){this.center.flush(n),this.up.flush(n),this.right.flush(n),this.radius.flush(n),this.angle.flush(n)},i.setDistance=function(n,a){a>0&&this.radius.set(n,Math.log(a))},i.lookAt=function(n,a,g,p){this.recalcMatrix(n),a=a||this.computedEye,g=g||this.computedCenter;var y=(p=p||this.computedUp)[0],v=p[1],b=p[2],x=l(y,v,b);if(!(x<1e-6)){y/=x,v/=x,b/=x;var T=a[0]-g[0],A=a[1]-g[1],S=a[2]-g[2],w=l(T,A,S);if(!(w<1e-6)){T/=w,A/=w,S/=w;var E=this.computedRight,k=E[0],L=E[1],M=E[2],P=y*k+v*L+b*M,D=l(k-=P*y,L-=P*v,M-=P*b);if(!(D<.01&&(D=l(k=v*S-b*A,L=b*T-y*S,M=y*A-v*T))<1e-6)){k/=D,L/=D,M/=D,this.up.set(n,y,v,b),this.right.set(n,k,L,M),this.center.set(n,g[0],g[1],g[2]),this.radius.set(n,Math.log(w));var N=v*M-b*L,U=b*k-y*M,G=y*L-v*k,X=l(N,U,G),K=y*T+v*A+b*S,Z=k*T+L*A+M*S,H=(N/=X)*T+(U/=X)*A+(G/=X)*S,Y=Math.asin(o(K)),$=Math.atan2(H,Z),z=this.angle._state,j=z[z.length-1],W=z[z.length-2];j%=2*Math.PI;var ee=Math.abs(j+2*Math.PI-$),J=Math.abs(j-$),Q=Math.abs(j-2*Math.PI-$);ee<J&&(j+=2*Math.PI),Q<J&&(j-=2*Math.PI),this.angle.jump(this.angle.lastT(),j,W),this.angle.set(n,$,Y)}}}}},{"filtered-vector":247,"gl-mat4/invert":293,"gl-mat4/rotate":299,"gl-vec3/cross":360,"gl-vec3/dot":365,"gl-vec3/normalize":382}],588:[function(r,I,B){I.exports=function(d,m,h){var e=d*m,f=t*d,l=f-(f-d),o=d-l,u=t*m,s=u-(u-m),i=m-s,c=o*i-(e-l*s-o*s-l*i);return h?(h[0]=c,h[1]=e,h):[c,e]};var t=+(Math.pow(2,27)+1)},{}],589:[function(r,I,B){I.exports=function(t,d,m){var h=t+d,e=h-t,f=d-e,l=t-(h-e);return m?(m[0]=l+f,m[1]=h,m):[l+f,h]}},{}],590:[function(r,I,B){var t=r("../prototype/is");I.exports=function(d){if(typeof d!="function"||!hasOwnProperty.call(d,"length"))return!1;try{if(typeof d.length!="number"||typeof d.call!="function"||typeof d.apply!="function")return!1}catch(m){return!1}return!t(d)}},{"../prototype/is":597}],591:[function(r,I,B){var t=r("../value/is"),d=r("../object/is"),m=r("../string/coerce"),h=r("./to-short-string"),e=function(f,l){return f.replace("%v",h(l))};I.exports=function(f,l,o){if(!d(o))throw new TypeError(e(l,f));if(!t(f)){if("default"in o)return o.default;if(o.isOptional)return null}var u=m(o.errorMessage);throw t(u)||(u=l),new TypeError(e(u,f))}},{"../object/is":594,"../string/coerce":598,"../value/is":600,"./to-short-string":593}],592:[function(r,I,B){I.exports=function(t){try{return t.toString()}catch(d){try{return String(t)}catch(m){return null}}}},{}],593:[function(r,I,B){var t=r("./safe-to-string"),d=/[\n\r\u2028\u2029]/g;I.exports=function(m){var h=t(m);return h===null?"<Non-coercible to string value>":(h.length>100&&(h=h.slice(0,99)+"\u2026"),h=h.replace(d,function(e){switch(e){case`
`:return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}))}},{"./safe-to-string":592}],594:[function(r,I,B){var t=r("../value/is"),d={object:!0,function:!0,undefined:!0};I.exports=function(m){return!!t(m)&&hasOwnProperty.call(d,typeof m)}},{"../value/is":600}],595:[function(r,I,B){var t=r("../lib/resolve-exception"),d=r("./is");I.exports=function(m){return d(m)?m:t(m,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":591,"./is":596}],596:[function(r,I,B){var t=r("../function/is"),d=/^\s*class[\s{/}]/,m=Function.prototype.toString;I.exports=function(h){return!!t(h)&&!d.test(m.call(h))}},{"../function/is":590}],597:[function(r,I,B){var t=r("../object/is");I.exports=function(d){if(!t(d))return!1;try{return!!d.constructor&&d.constructor.prototype===d}catch(m){return!1}}},{"../object/is":594}],598:[function(r,I,B){var t=r("../value/is"),d=r("../object/is"),m=Object.prototype.toString;I.exports=function(h){if(!t(h))return null;if(d(h)){var e=h.toString;if(typeof e!="function"||e===m)return null}try{return""+h}catch(f){return null}}},{"../object/is":594,"../value/is":600}],599:[function(r,I,B){var t=r("../lib/resolve-exception"),d=r("./is");I.exports=function(m){return d(m)?m:t(m,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":591,"./is":600}],600:[function(r,I,B){I.exports=function(t){return t!=null}},{}],601:[function(r,I,B){(function(t){(function(){var d=r("bit-twiddle"),m=r("dup"),h=r("buffer").Buffer;t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:m([32,0]),UINT16:m([32,0]),UINT32:m([32,0]),BIGUINT64:m([32,0]),INT8:m([32,0]),INT16:m([32,0]),INT32:m([32,0]),BIGINT64:m([32,0]),FLOAT:m([32,0]),DOUBLE:m([32,0]),DATA:m([32,0]),UINT8C:m([32,0]),BUFFER:m([32,0])});var e=typeof Uint8ClampedArray!="undefined",f=typeof BigUint64Array!="undefined",l=typeof BigInt64Array!="undefined",o=t.__TYPEDARRAY_POOL;o.UINT8C||(o.UINT8C=m([32,0])),o.BIGUINT64||(o.BIGUINT64=m([32,0])),o.BIGINT64||(o.BIGINT64=m([32,0])),o.BUFFER||(o.BUFFER=m([32,0]));var u=o.DATA,s=o.BUFFER;function i(k){if(k){var L=k.length||k.byteLength,M=d.log2(L);u[M].push(k)}}function c(k){k=d.nextPow2(k);var L=d.log2(k),M=u[L];return M.length>0?M.pop():new ArrayBuffer(k)}function n(k){return new Uint8Array(c(k),0,k)}function a(k){return new Uint16Array(c(2*k),0,k)}function g(k){return new Uint32Array(c(4*k),0,k)}function p(k){return new Int8Array(c(k),0,k)}function y(k){return new Int16Array(c(2*k),0,k)}function v(k){return new Int32Array(c(4*k),0,k)}function b(k){return new Float32Array(c(4*k),0,k)}function x(k){return new Float64Array(c(8*k),0,k)}function T(k){return e?new Uint8ClampedArray(c(k),0,k):n(k)}function A(k){return f?new BigUint64Array(c(8*k),0,k):null}function S(k){return l?new BigInt64Array(c(8*k),0,k):null}function w(k){return new DataView(c(k),0,k)}function E(k){k=d.nextPow2(k);var L=d.log2(k),M=s[L];return M.length>0?M.pop():new h(k)}B.free=function(k){if(h.isBuffer(k))s[d.log2(k.length)].push(k);else{if(Object.prototype.toString.call(k)!=="[object ArrayBuffer]"&&(k=k.buffer),!k)return;var L=k.length||k.byteLength,M=0|d.log2(L);u[M].push(k)}},B.freeUint8=B.freeUint16=B.freeUint32=B.freeBigUint64=B.freeInt8=B.freeInt16=B.freeInt32=B.freeBigInt64=B.freeFloat32=B.freeFloat=B.freeFloat64=B.freeDouble=B.freeUint8Clamped=B.freeDataView=function(k){i(k.buffer)},B.freeArrayBuffer=i,B.freeBuffer=function(k){s[d.log2(k.length)].push(k)},B.malloc=function(k,L){if(L===void 0||L==="arraybuffer")return c(k);switch(L){case"uint8":return n(k);case"uint16":return a(k);case"uint32":return g(k);case"int8":return p(k);case"int16":return y(k);case"int32":return v(k);case"float":case"float32":return b(k);case"double":case"float64":return x(k);case"uint8_clamped":return T(k);case"bigint64":return S(k);case"biguint64":return A(k);case"buffer":return E(k);case"data":case"dataview":return w(k);default:return null}return null},B.mallocArrayBuffer=c,B.mallocUint8=n,B.mallocUint16=a,B.mallocUint32=g,B.mallocInt8=p,B.mallocInt16=y,B.mallocInt32=v,B.mallocFloat32=B.mallocFloat=b,B.mallocFloat64=B.mallocDouble=x,B.mallocUint8Clamped=T,B.mallocBigUint64=A,B.mallocBigInt64=S,B.mallocDataView=w,B.mallocBuffer=E,B.clearCache=function(){for(var k=0;k<32;++k)o.UINT8[k].length=0,o.UINT16[k].length=0,o.UINT32[k].length=0,o.INT8[k].length=0,o.INT16[k].length=0,o.INT32[k].length=0,o.FLOAT[k].length=0,o.DOUBLE[k].length=0,o.BIGUINT64[k].length=0,o.BIGINT64[k].length=0,o.UINT8C[k].length=0,u[k].length=0,s[k].length=0}}).call(this)}).call(this,typeof vi!="undefined"?vi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"bit-twiddle":104,buffer:117,dup:182}],602:[function(r,I,B){function t(m){this.roots=new Array(m),this.ranks=new Array(m);for(var h=0;h<m;++h)this.roots[h]=h,this.ranks[h]=0}I.exports=t;var d=t.prototype;Object.defineProperty(d,"length",{get:function(){return this.roots.length}}),d.makeSet=function(){var m=this.roots.length;return this.roots.push(m),this.ranks.push(0),m},d.find=function(m){for(var h=m,e=this.roots;e[m]!==m;)m=e[m];for(;e[h]!==m;){var f=e[h];e[h]=m,h=f}return m},d.link=function(m,h){var e=this.find(m),f=this.find(h);if(e!==f){var l=this.ranks,o=this.roots,u=l[e],s=l[f];u<s?o[e]=f:s<u?o[f]=e:(o[f]=e,++l[e])}}},{}],603:[function(r,I,B){I.exports=function(t,d,m){return t.length===0?t:d?(m||t.sort(d),function(h,e){for(var f=1,l=h.length,o=h[0],u=h[0],s=1;s<l;++s)if(u=o,e(o=h[s],u)){if(s===f){f++;continue}h[f++]=o}return h.length=f,h}(t,d)):(m||t.sort(),function(h){for(var e=1,f=h.length,l=h[0],o=h[0],u=1;u<f;++u,o=l)if(o=l,(l=h[u])!==o){if(u===e){e++;continue}h[e++]=l}return h.length=e,h}(t))}},{}],604:[function(r,I,B){var t=/[\'\"]/;I.exports=function(d){return d?(t.test(d.charAt(0))&&(d=d.substr(1)),t.test(d.charAt(d.length-1))&&(d=d.substr(0,d.length-1)),d):""}},{}],605:[function(r,I,B){I.exports=function(t,d,m){Array.isArray(m)||(m=[].slice.call(arguments,2));for(var h=0,e=m.length;h<e;h++){var f=m[h];for(var l in f)if((d[l]===void 0||Array.isArray(d[l])||t[l]!==d[l])&&l in d){var o;if(f[l]===!0)o=d[l];else if(f[l]===!1||typeof f[l]=="function"&&(o=f[l](d[l],t,d))===void 0)continue;t[l]=o}}return t}},{}],606:[function(r,I,B){(function(t){(function(){function d(m){try{if(!t.localStorage)return!1}catch(e){return!1}var h=t.localStorage[m];return h!=null&&String(h).toLowerCase()==="true"}I.exports=function(m,h){if(d("noDeprecation"))return m;var e=!1;return function(){if(!e){if(d("throwDeprecation"))throw new Error(h);d("traceDeprecation")?console.trace(h):console.warn(h),e=!0}return m.apply(this,arguments)}}}).call(this)}).call(this,typeof vi!="undefined"?vi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],607:[function(r,I,B){I.exports=function(h,e){return typeof e=="object"&&e!==null||(e={}),t(h,e.canvas||d,e.context||m,e)};var t=r("./lib/vtext"),d=null,m=null;typeof document!="undefined"&&((d=document.createElement("canvas")).width=8192,d.height=1024,m=d.getContext("2d"))},{"./lib/vtext":608}],608:[function(r,I,B){I.exports=function(i,c,n,a){var g=64,p=1.25,y={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};return a&&(a.size&&a.size>0&&(g=a.size),a.lineSpacing&&a.lineSpacing>0&&(p=a.lineSpacing),a.styletags&&a.styletags.breaklines&&(y.breaklines=!!a.styletags.breaklines),a.styletags&&a.styletags.bolds&&(y.bolds=!!a.styletags.bolds),a.styletags&&a.styletags.italics&&(y.italics=!!a.styletags.italics),a.styletags&&a.styletags.subscripts&&(y.subscripts=!!a.styletags.subscripts),a.styletags&&a.styletags.superscripts&&(y.superscripts=!!a.styletags.superscripts)),n.font=[a.fontStyle,a.fontVariant,a.fontWeight,g+"px",a.font].filter(function(v){return v}).join(" "),n.textAlign="start",n.textBaseline="alphabetic",n.direction="ltr",s(function(v,b,x,T,A,S){x=x.replace(/\n/g,""),x=S.breaklines===!0?x.replace(/\<br\>/g,`
`):x.replace(/\<br\>/g," ");var w="",E=[];for(P=0;P<x.length;++P)E[P]=w;S.bolds===!0&&(E=l("b","b|",x,E)),S.italics===!0&&(E=l("i","i|",x,E)),S.superscripts===!0&&(E=l("sup","+1",x,E)),S.subscripts===!0&&(E=l("sub","-1",x,E));var k=[],L="";for(P=0;P<x.length;++P)E[P]!==null&&(L+=x[P],k.push(E[P]));var M,P,D,N,U,G=L.split(`
`),X=G.length,K=Math.round(A*T),Z=T,H=2*T,Y=0,$=X*K+H;v.height<$&&(v.height=$),b.fillStyle="#000",b.fillRect(0,0,v.width,v.height),b.fillStyle="#fff";var z=0,j="";function W(){if(j!==""){var se=b.measureText(j).width;b.fillText(j,Z+D,H+N),D+=se}}function ee(){return Math.round(U)+"px "}function J(se,de){var ue=""+b.font;if(S.subscripts===!0){var ve=se.indexOf("-"),ke=de.indexOf("-"),Ee=ve>-1?parseInt(se[1+ve]):0,be=ke>-1?parseInt(de[1+ke]):0;Ee!==be&&(ue=ue.replace(ee(),"?px "),U*=Math.pow(.75,be-Ee),ue=ue.replace("?px ",ee())),N+=.25*K*(be-Ee)}if(S.superscripts===!0){var xe=se.indexOf("+"),ce=de.indexOf("+"),ge=xe>-1?parseInt(se[1+xe]):0,we=ce>-1?parseInt(de[1+ce]):0;ge!==we&&(ue=ue.replace(ee(),"?px "),U*=Math.pow(.75,we-ge),ue=ue.replace("?px ",ee())),N-=.25*K*(we-ge)}if(S.bolds===!0){var Me=se.indexOf("b|")>-1,Se=de.indexOf("b|")>-1;!Me&&Se&&(ue=ze?ue.replace("italic ","italic bold "):"bold "+ue),Me&&!Se&&(ue=ue.replace("bold ",""))}if(S.italics===!0){var ze=se.indexOf("i|")>-1,Fe=de.indexOf("i|")>-1;!ze&&Fe&&(ue="italic "+ue),ze&&!Fe&&(ue=ue.replace("italic ",""))}b.font=ue}for(M=0;M<X;++M){var Q=G[M]+`
`;for(D=0,N=M*K,U=T,j="",P=0;P<Q.length;++P){var te=P+z<k.length?k[P+z]:k[k.length-1];w===te?j+=Q[P]:(W(),j=Q[P],te!==void 0&&(J(w,te),w=te))}W(),z+=Q.length;var ie=0|Math.round(D+2*Z);Y<ie&&(Y=ie)}var ae=Y,he=H+K*X;return d(b.getImageData(0,0,ae,he).data,[he,ae,4]).pick(-1,-1,0).transpose(1,0)}(c,n,i,g,p,y),a,g)},I.exports.processPixels=s;var t=r("surface-nets"),d=r("ndarray"),m=r("simplify-planar-graph"),h=r("clean-pslg"),e=r("cdt2d"),f=r("planar-graph-to-polyline");function l(i,c,n,a){for(var g="<"+i+">",p="</"+i+">",y=g.length,v=p.length,b=c[0]==="+"||c[0]==="-",x=0,T=-v;x>-1&&(x=n.indexOf(g,x))!==-1&&(T=n.indexOf(p,x+y))!==-1&&!(T<=x);){for(var A=x;A<T+v;++A)if(A<x+y||A>=T)a[A]=null,n=n.substr(0,A)+" "+n.substr(A+1);else if(a[A]!==null){var S=a[A].indexOf(c[0]);S===-1?a[A]+=c:b&&(a[A]=a[A].substr(0,S+1)+(1+parseInt(a[A][S+1]))+a[A].substr(S+2))}var w=x+y,E=n.substr(w,T-w).indexOf(g);x=E!==-1?E:T+v}return a}function o(i,c){var n=t(i,128);return c?m(n.cells,n.positions,.25):{edges:n.cells,positions:n.positions}}function u(i,c,n,a){var g=o(i,a),p=function(M,P,D){for(var N=P.textAlign||"start",U=P.textBaseline||"alphabetic",G=[1<<30,1<<30],X=[0,0],K=M.length,Z=0;Z<K;++Z)for(var H=M[Z],Y=0;Y<2;++Y)G[Y]=0|Math.min(G[Y],H[Y]),X[Y]=0|Math.max(X[Y],H[Y]);var $=0;switch(N){case"center":$=-.5*(G[0]+X[0]);break;case"right":case"end":$=-X[0];break;case"left":case"start":$=-G[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+N+"'")}var z=0;switch(U){case"hanging":case"top":z=-G[1];break;case"middle":z=-.5*(G[1]+X[1]);break;case"alphabetic":case"ideographic":z=-3*D;break;case"bottom":z=-X[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+U+"'")}var j=1/D;return"lineHeight"in P?j*=+P.lineHeight:"width"in P?j=P.width/(X[0]-G[0]):"height"in P&&(j=P.height/(X[1]-G[1])),M.map(function(W){return[j*(W[0]+$),j*(W[1]+z)]})}(g.positions,c,n),y=g.edges,v=c.orientation==="ccw";if(h(p,y),c.polygons||c.polygon||c.polyline){for(var b=f(y,p),x=new Array(b.length),T=0;T<b.length;++T){for(var A=b[T],S=new Array(A.length),w=0;w<A.length;++w){for(var E=A[w],k=new Array(E.length),L=0;L<E.length;++L)k[L]=p[E[L]].slice();v&&k.reverse(),S[w]=k}x[T]=S}return x}return c.triangles||c.triangulate||c.triangle?{cells:e(p,y,{delaunay:!1,exterior:!1,interior:!0}),positions:p}:{edges:y,positions:p}}function s(i,c,n){try{return u(i,c,n,!0)}catch(a){}try{return u(i,c,n,!1)}catch(a){}return c.polygons||c.polyline||c.polygon?[]:c.triangles||c.triangulate||c.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}},{cdt2d:118,"clean-pslg":127,ndarray:472,"planar-graph-to-polyline":488,"simplify-planar-graph":549,"surface-nets":576}],609:[function(r,I,B){(function(){if(typeof ses=="undefined"||!ses.ok||ses.ok()){typeof ses!="undefined"&&(ses.weakMapPermitHostObjects=g);var t=!1;if(typeof WeakMap=="function"){var d=WeakMap;if(!(typeof navigator!="undefined"&&/Firefox/.test(navigator.userAgent))){var m=new d,h=Object.freeze({});if(m.set(h,1),m.get(h)===1)return void(I.exports=WeakMap);t=!0}}var e=Object.getOwnPropertyNames,f=Object.defineProperty,l=Object.isExtensible,o="weakmap:ident:"+Math.random()+"___";if(typeof crypto!="undefined"&&typeof crypto.getRandomValues=="function"&&typeof ArrayBuffer=="function"&&typeof Uint8Array=="function"){var u=new ArrayBuffer(25),s=new Uint8Array(u);crypto.getRandomValues(s),o="weakmap:rand:"+Array.prototype.map.call(s,function(x){return(x%36).toString(36)}).join("")+"___"}if(f(Object,"getOwnPropertyNames",{value:function(x){return e(x).filter(p)}}),"getPropertyNames"in Object){var i=Object.getPropertyNames;f(Object,"getPropertyNames",{value:function(x){return i(x).filter(p)}})}(function(){var x=Object.freeze;f(Object,"freeze",{value:function(S){return y(S),x(S)}});var T=Object.seal;f(Object,"seal",{value:function(S){return y(S),T(S)}});var A=Object.preventExtensions;f(Object,"preventExtensions",{value:function(S){return y(S),A(S)}})})();var c=!1,n=0,a=function(){this instanceof a||b();var x=[],T=[],A=n++;return Object.create(a.prototype,{get___:{value:v(function(S,w){var E,k=y(S);return k?A in k?k[A]:w:(E=x.indexOf(S))>=0?T[E]:w})},has___:{value:v(function(S){var w=y(S);return w?A in w:x.indexOf(S)>=0})},set___:{value:v(function(S,w){var E,k=y(S);return k?k[A]=w:(E=x.indexOf(S))>=0?T[E]=w:(E=x.length,T[E]=w,x[E]=S),this})},delete___:{value:v(function(S){var w,E,k=y(S);return k?A in k&&delete k[A]:!((w=x.indexOf(S))<0)&&(E=x.length-1,x[w]=void 0,T[w]=T[E],x[w]=x[E],x.length=E,T.length=E,!0)})}})};a.prototype=Object.create(Object.prototype,{get:{value:function(x,T){return this.get___(x,T)},writable:!0,configurable:!0},has:{value:function(x){return this.has___(x)},writable:!0,configurable:!0},set:{value:function(x,T){return this.set___(x,T)},writable:!0,configurable:!0},delete:{value:function(x){return this.delete___(x)},writable:!0,configurable:!0}}),typeof d=="function"?function(){function x(){this instanceof a||b();var T,A=new d,S=void 0,w=!1;return T=t?function(E,k){return A.set(E,k),A.has(E)||(S||(S=new a),S.set(E,k)),this}:function(E,k){if(w)try{A.set(E,k)}catch(L){S||(S=new a),S.set___(E,k)}else A.set(E,k);return this},Object.create(a.prototype,{get___:{value:v(function(E,k){return S?A.has(E)?A.get(E):S.get___(E,k):A.get(E,k)})},has___:{value:v(function(E){return A.has(E)||!!S&&S.has___(E)})},set___:{value:v(T)},delete___:{value:v(function(E){var k=!!A.delete(E);return S&&S.delete___(E)||k})},permitHostObjects___:{value:v(function(E){if(E!==g)throw new Error("bogus call to permitHostObjects___");w=!0})}})}t&&typeof Proxy!="undefined"&&(Proxy=void 0),x.prototype=a.prototype,I.exports=x,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy!="undefined"&&(Proxy=void 0),I.exports=a)}function g(x){x.permitHostObjects___&&x.permitHostObjects___(g)}function p(x){return!(x.substr(0,"weakmap:".length)=="weakmap:"&&x.substr(x.length-3)==="___")}function y(x){if(x!==Object(x))throw new TypeError("Not an object: "+x);var T=x[o];if(T&&T.key===x)return T;if(l(x)){T={key:x};try{return f(x,o,{value:T,writable:!1,enumerable:!1,configurable:!1}),T}catch(A){return}}}function v(x){return x.prototype=null,Object.freeze(x)}function b(){c||typeof console=="undefined"||(c=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}})()},{}],610:[function(r,I,B){var t=r("./hidden-store.js");I.exports=function(){var d={};return function(m){if((typeof m!="object"||m===null)&&typeof m!="function")throw new Error("Weakmap-shim: Key must be object");var h=m.valueOf(d);return h&&h.identity===d?h:t(m,d)}}},{"./hidden-store.js":611}],611:[function(r,I,B){I.exports=function(t,d){var m={identity:d},h=t.valueOf;return Object.defineProperty(t,"valueOf",{value:function(e){return e!==d?h.apply(this,arguments):m},writable:!0}),m}},{}],612:[function(r,I,B){var t=r("./create-store.js");I.exports=function(){var d=t();return{get:function(m,h){var e=d(m);return e.hasOwnProperty("value")?e.value:h},set:function(m,h){return d(m).value=h,this},has:function(m){return"value"in d(m)},delete:function(m){return delete d(m).value}}}},{"./create-store.js":610}],613:[function(r,I,B){var t=r("get-canvas-context");I.exports=function(d){return t("webgl",d)}},{"get-canvas-context":252}],614:[function(r,I,B){var t=r("../main"),d=r("object-assign"),m=t.instance();function h(i){this.local=this.regionalOptions[i||""]||this.regionalOptions[""]}h.prototype=new t.baseCalendar,d(h.prototype,{name:"Chinese",jdEpoch:17214255e-1,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(i,c){if(typeof i=="string"){var n=i.match(f);return n?n[0]:""}var a=this._validateYear(i),g=i.month(),p=""+this.toChineseMonth(a,g);return c&&p.length<2&&(p="0"+p),this.isIntercalaryMonth(a,g)&&(p+="i"),p},monthNames:function(i){if(typeof i=="string"){var c=i.match(l);return c?c[0]:""}var n=this._validateYear(i),a=i.month(),g=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"][this.toChineseMonth(n,a)-1];return this.isIntercalaryMonth(n,a)&&(g="\u95F0"+g),g},monthNamesShort:function(i){if(typeof i=="string"){var c=i.match(o);return c?c[0]:""}var n=this._validateYear(i),a=i.month(),g=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"][this.toChineseMonth(n,a)-1];return this.isIntercalaryMonth(n,a)&&(g="\u95F0"+g),g},parseMonth:function(i,c){i=this._validateYear(i);var n,a=parseInt(c);if(isNaN(a))c[0]==="\u95F0"&&(n=!0,c=c.substring(1)),c[c.length-1]==="\u6708"&&(c=c.substring(0,c.length-1)),a=1+["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"].indexOf(c);else{var g=c[c.length-1];n=g==="i"||g==="I"}return this.toMonthIndex(i,a,n)},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(i,c){if(i.year&&(i=i.year()),typeof i!="number"||i<1888||i>2111)throw c.replace(/\{0\}/,this.local.name);return i},toMonthIndex:function(i,c,n){var a=this.intercalaryMonth(i);if(n&&c!==a||c<1||c>12)throw t.local.invalidMonth.replace(/\{0\}/,this.local.name);return a?!n&&c<=a?c-1:c:c-1},toChineseMonth:function(i,c){i.year&&(c=(i=i.year()).month());var n=this.intercalaryMonth(i);if(c<0||c>(n?12:11))throw t.local.invalidMonth.replace(/\{0\}/,this.local.name);return n?c<n?c+1:c:c+1},intercalaryMonth:function(i){return i=this._validateYear(i),u[i-u[0]]>>13},isIntercalaryMonth:function(i,c){i.year&&(c=(i=i.year()).month());var n=this.intercalaryMonth(i);return!!n&&n===c},leapYear:function(i){return this.intercalaryMonth(i)!==0},weekOfYear:function(i,c,n){var a,g=this._validateYear(i,t.local.invalidyear),p=s[g-s[0]],y=p>>9&4095,v=p>>5&15,b=31&p;(a=m.newDate(y,v,b)).add(4-(a.dayOfWeek()||7),"d");var x=this.toJD(i,c,n)-a.toJD();return 1+Math.floor(x/7)},monthsInYear:function(i){return this.leapYear(i)?13:12},daysInMonth:function(i,c){i.year&&(c=i.month(),i=i.year()),i=this._validateYear(i);var n=u[i-u[0]];if(c>(n>>13?12:11))throw t.local.invalidMonth.replace(/\{0\}/,this.local.name);return n&1<<12-c?30:29},weekDay:function(i,c,n){return(this.dayOfWeek(i,c,n)||7)<6},toJD:function(i,c,n){var a=this._validate(i,p,n,t.local.invalidDate);i=this._validateYear(a.year()),c=a.month(),n=a.day();var g=this.isIntercalaryMonth(i,c),p=this.toChineseMonth(i,c),y=function(v,b,x,T,A){var S,w,E;if(typeof v=="object")w=v,S=b||{};else{var k;if(!(typeof v=="number"&&v>=1888&&v<=2111))throw new Error("Lunar year outside range 1888-2111");if(!(typeof b=="number"&&b>=1&&b<=12))throw new Error("Lunar month outside range 1 - 12");if(!(typeof x=="number"&&x>=1&&x<=30))throw new Error("Lunar day outside range 1 - 30");typeof T=="object"?(k=!1,S=T):(k=!!T,S=A||{}),w={year:v,month:b,day:x,isIntercalary:k}}E=w.day-1;var L,M=u[w.year-u[0]],P=M>>13;L=P&&(w.month>P||w.isIntercalary)?w.month:w.month-1;for(var D=0;D<L;D++)E+=M&1<<12-D?30:29;var N=s[w.year-s[0]],U=new Date(N>>9&4095,(N>>5&15)-1,(31&N)+E);return S.year=U.getFullYear(),S.month=1+U.getMonth(),S.day=U.getDate(),S}(i,p,n,g);return m.toJD(y.year,y.month,y.day)},fromJD:function(i){var c=m.fromJD(i),n=function(g,p,y,v){var b,x;if(typeof g=="object")b=g,x=p||{};else{if(!(typeof g=="number"&&g>=1888&&g<=2111))throw new Error("Solar year outside range 1888-2111");if(!(typeof p=="number"&&p>=1&&p<=12))throw new Error("Solar month outside range 1 - 12");if(!(typeof y=="number"&&y>=1&&y<=31))throw new Error("Solar day outside range 1 - 31");b={year:g,month:p,day:y},x=v||{}}var T=s[b.year-s[0]],A=b.year<<9|b.month<<5|b.day;x.year=A>=T?b.year:b.year-1,T=s[x.year-s[0]];var S,w=new Date(T>>9&4095,(T>>5&15)-1,31&T),E=new Date(b.year,b.month-1,b.day);S=Math.round((E-w)/864e5);var k,L=u[x.year-u[0]];for(k=0;k<13;k++){var M=L&1<<12-k?30:29;if(S<M)break;S-=M}var P=L>>13;return!P||k<P?(x.isIntercalary=!1,x.month=1+k):k===P?(x.isIntercalary=!0,x.month=k):(x.isIntercalary=!1,x.month=k),x.day=1+S,x}(c.year(),c.month(),c.day()),a=this.toMonthIndex(n.year,n.month,n.isIntercalary);return this.newDate(n.year,a,n.day)},fromString:function(i){var c=i.match(e),n=this._validateYear(+c[1]),a=+c[2],g=!!c[3],p=this.toMonthIndex(n,a,g),y=+c[4];return this.newDate(n,p,y)},add:function(i,c,n){var a=i.year(),g=i.month(),p=this.isIntercalaryMonth(a,g),y=this.toChineseMonth(a,g),v=Object.getPrototypeOf(h.prototype).add.call(this,i,c,n);if(n==="y"){var b=v.year(),x=v.month(),T=this.isIntercalaryMonth(b,y),A=p&&T?this.toMonthIndex(b,y,!0):this.toMonthIndex(b,y,!1);A!==x&&v.month(A)}return v}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,f=/^\d?\d[iI]?/m,l=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?\u6708/m,o=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?/m;t.calendars.chinese=h;var u=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],s=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904]},{"../main":628,"object-assign":476}],615:[function(r,I,B){var t=r("../main"),d=r("object-assign");function m(h){this.local=this.regionalOptions[h||""]||this.regionalOptions[""]}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Coptic",jdEpoch:18250295e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(h){var e=this._validate(h,this.minMonth,this.minDay,t.local.invalidYear);return(h=e.year()+(e.year()<0?1:0))%4==3||h%4==-1},monthsInYear:function(h){return this._validate(h,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear),13},weekOfYear:function(h,e,f){var l=this.newDate(h,e,f);return l.add(-l.dayOfWeek(),"d"),Math.floor((l.dayOfYear()-1)/7)+1},daysInMonth:function(h,e){var f=this._validate(h,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===13&&this.leapYear(f.year())?1:0)},weekDay:function(h,e,f){return(this.dayOfWeek(h,e,f)||7)<6},toJD:function(h,e,f){var l=this._validate(h,e,f,t.local.invalidDate);return(h=l.year())<0&&h++,l.day()+30*(l.month()-1)+365*(h-1)+Math.floor(h/4)+this.jdEpoch-1},fromJD:function(h){var e=Math.floor(h)+.5-this.jdEpoch,f=Math.floor((e-Math.floor((e+366)/1461))/365)+1;f<=0&&f--,e=Math.floor(h)+.5-this.newDate(f,1,1).toJD();var l=Math.floor(e/30)+1,o=e-30*(l-1)+1;return this.newDate(f,l,o)}}),t.calendars.coptic=m},{"../main":628,"object-assign":476}],616:[function(r,I,B){var t=r("../main"),d=r("object-assign");function m(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Discworld",jdEpoch:17214255e-1,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),400},weekOfYear:function(e,f,l){var o=this.newDate(e,f,l);return o.add(-o.dayOfWeek(),"d"),Math.floor((o.dayOfYear()-1)/8)+1},daysInMonth:function(e,f){var l=this._validate(e,f,this.minDay,t.local.invalidMonth);return this.daysPerMonth[l.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,f,l){return(this._validate(e,f,l,t.local.invalidDate).day()+1)%8},weekDay:function(e,f,l){var o=this.dayOfWeek(e,f,l);return o>=2&&o<=6},extraInfo:function(e,f,l){var o=this._validate(e,f,l,t.local.invalidDate);return{century:h[Math.floor((o.year()-1)/100)+1]||""}},toJD:function(e,f,l){var o=this._validate(e,f,l,t.local.invalidDate);return e=o.year()+(o.year()<0?1:0),f=o.month(),(l=o.day())+(f>1?16:0)+(f>2?32*(f-2):0)+400*(e-1)+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var f=Math.floor(e/400)+1;e-=400*(f-1),e+=e>15?16:0;var l=Math.floor(e/32)+1,o=e-32*(l-1)+1;return this.newDate(f<=0?f-1:f,l,o)}});var h={20:"Fruitbat",21:"Anchovy"};t.calendars.discworld=m},{"../main":628,"object-assign":476}],617:[function(r,I,B){var t=r("../main"),d=r("object-assign");function m(h){this.local=this.regionalOptions[h||""]||this.regionalOptions[""]}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Ethiopian",jdEpoch:17242205e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(h){var e=this._validate(h,this.minMonth,this.minDay,t.local.invalidYear);return(h=e.year()+(e.year()<0?1:0))%4==3||h%4==-1},monthsInYear:function(h){return this._validate(h,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear),13},weekOfYear:function(h,e,f){var l=this.newDate(h,e,f);return l.add(-l.dayOfWeek(),"d"),Math.floor((l.dayOfYear()-1)/7)+1},daysInMonth:function(h,e){var f=this._validate(h,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===13&&this.leapYear(f.year())?1:0)},weekDay:function(h,e,f){return(this.dayOfWeek(h,e,f)||7)<6},toJD:function(h,e,f){var l=this._validate(h,e,f,t.local.invalidDate);return(h=l.year())<0&&h++,l.day()+30*(l.month()-1)+365*(h-1)+Math.floor(h/4)+this.jdEpoch-1},fromJD:function(h){var e=Math.floor(h)+.5-this.jdEpoch,f=Math.floor((e-Math.floor((e+366)/1461))/365)+1;f<=0&&f--,e=Math.floor(h)+.5-this.newDate(f,1,1).toJD();var l=Math.floor(e/30)+1,o=e-30*(l-1)+1;return this.newDate(f,l,o)}}),t.calendars.ethiopian=m},{"../main":628,"object-assign":476}],618:[function(r,I,B){var t=r("../main"),d=r("object-assign");function m(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function h(e,f){return e-f*Math.floor(e/f)}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return this._leapYear(f.year())},_leapYear:function(e){return h(7*(e=e<0?e+1:e)+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,f,l){var o=this.newDate(e,f,l);return o.add(-o.dayOfWeek(),"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInYear:function(e){return e=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear).year(),this.toJD(e===-1?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,f){return e.year&&(f=e.month(),e=e.year()),this._validate(e,f,this.minDay,t.local.invalidMonth),f===12&&this.leapYear(e)||f===8&&h(this.daysInYear(e),10)===5?30:f===9&&h(this.daysInYear(e),10)===3?29:this.daysPerMonth[f-1]},weekDay:function(e,f,l){return this.dayOfWeek(e,f,l)!==6},extraInfo:function(e,f,l){var o=this._validate(e,f,l,t.local.invalidDate);return{yearType:(this.leapYear(o)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(o)%10-3]}},toJD:function(e,f,l){var o=this._validate(e,f,l,t.local.invalidDate);e=o.year(),f=o.month(),l=o.day();var u=e<=0?e+1:e,s=this.jdEpoch+this._delay1(u)+this._delay2(u)+l+1;if(f<7){for(var i=7;i<=this.monthsInYear(e);i++)s+=this.daysInMonth(e,i);for(i=1;i<f;i++)s+=this.daysInMonth(e,i)}else for(i=7;i<f;i++)s+=this.daysInMonth(e,i);return s},_delay1:function(e){var f=Math.floor((235*e-234)/19),l=12084+13753*f,o=29*f+Math.floor(l/25920);return h(3*(o+1),7)<3&&o++,o},_delay2:function(e){var f=this._delay1(e-1),l=this._delay1(e);return this._delay1(e+1)-l==356?2:l-f==382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var f=Math.floor(98496*(e-this.jdEpoch)/35975351)-1;e>=this.toJD(f===-1?1:f+1,7,1);)f++;for(var l=e<this.toJD(f,1,1)?7:1;e>this.toJD(f,l,this.daysInMonth(f,l));)l++;var o=e-this.toJD(f,l,1)+1;return this.newDate(f,l,o)}}),t.calendars.hebrew=m},{"../main":628,"object-assign":476}],619:[function(r,I,B){var t=r("../main"),d=r("object-assign");function m(h){this.local=this.regionalOptions[h||""]||this.regionalOptions[""]}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Islamic",jdEpoch:19484395e-1,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012Bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(h){return(11*this._validate(h,this.minMonth,this.minDay,t.local.invalidYear).year()+14)%30<11},weekOfYear:function(h,e,f){var l=this.newDate(h,e,f);return l.add(-l.dayOfWeek(),"d"),Math.floor((l.dayOfYear()-1)/7)+1},daysInYear:function(h){return this.leapYear(h)?355:354},daysInMonth:function(h,e){var f=this._validate(h,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===12&&this.leapYear(f.year())?1:0)},weekDay:function(h,e,f){return this.dayOfWeek(h,e,f)!==5},toJD:function(h,e,f){var l=this._validate(h,e,f,t.local.invalidDate);return h=l.year(),e=l.month(),h=h<=0?h+1:h,(f=l.day())+Math.ceil(29.5*(e-1))+354*(h-1)+Math.floor((3+11*h)/30)+this.jdEpoch-1},fromJD:function(h){h=Math.floor(h)+.5;var e=Math.floor((30*(h-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var f=Math.min(12,Math.ceil((h-29-this.toJD(e,1,1))/29.5)+1),l=h-this.toJD(e,f,1)+1;return this.newDate(e,f,l)}}),t.calendars.islamic=m},{"../main":628,"object-assign":476}],620:[function(r,I,B){var t=r("../main"),d=r("object-assign");function m(h){this.local=this.regionalOptions[h||""]||this.regionalOptions[""]}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Julian",jdEpoch:17214235e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(h){var e=this._validate(h,this.minMonth,this.minDay,t.local.invalidYear);return(h=e.year()<0?e.year()+1:e.year())%4==0},weekOfYear:function(h,e,f){var l=this.newDate(h,e,f);return l.add(4-(l.dayOfWeek()||7),"d"),Math.floor((l.dayOfYear()-1)/7)+1},daysInMonth:function(h,e){var f=this._validate(h,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===2&&this.leapYear(f.year())?1:0)},weekDay:function(h,e,f){return(this.dayOfWeek(h,e,f)||7)<6},toJD:function(h,e,f){var l=this._validate(h,e,f,t.local.invalidDate);return h=l.year(),e=l.month(),f=l.day(),h<0&&h++,e<=2&&(h--,e+=12),Math.floor(365.25*(h+4716))+Math.floor(30.6001*(e+1))+f-1524.5},fromJD:function(h){var e=Math.floor(h+.5)+1524,f=Math.floor((e-122.1)/365.25),l=Math.floor(365.25*f),o=Math.floor((e-l)/30.6001),u=o-Math.floor(o<14?1:13),s=f-Math.floor(u>2?4716:4715),i=e-l-Math.floor(30.6001*o);return s<=0&&s--,this.newDate(s,u,i)}}),t.calendars.julian=m},{"../main":628,"object-assign":476}],621:[function(r,I,B){var t=r("../main"),d=r("object-assign");function m(f){this.local=this.regionalOptions[f||""]||this.regionalOptions[""]}function h(f,l){return f-l*Math.floor(f/l)}function e(f,l){return h(f-1,l)+1}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(f){return this._validate(f,this.minMonth,this.minDay,t.local.invalidYear),!1},formatYear:function(f){f=this._validate(f,this.minMonth,this.minDay,t.local.invalidYear).year();var l=Math.floor(f/400);return f%=400,f+=f<0?400:0,l+"."+Math.floor(f/20)+"."+f%20},forYear:function(f){if((f=f.split(".")).length<3)throw"Invalid Mayan year";for(var l=0,o=0;o<f.length;o++){var u=parseInt(f[o],10);if(Math.abs(u)>19||o>0&&u<0)throw"Invalid Mayan year";l=20*l+u}return l},monthsInYear:function(f){return this._validate(f,this.minMonth,this.minDay,t.local.invalidYear),18},weekOfYear:function(f,l,o){return this._validate(f,l,o,t.local.invalidDate),0},daysInYear:function(f){return this._validate(f,this.minMonth,this.minDay,t.local.invalidYear),360},daysInMonth:function(f,l){return this._validate(f,l,this.minDay,t.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(f,l,o){return this._validate(f,l,o,t.local.invalidDate).day()},weekDay:function(f,l,o){return this._validate(f,l,o,t.local.invalidDate),!0},extraInfo:function(f,l,o){var u=this._validate(f,l,o,t.local.invalidDate).toJD(),s=this._toHaab(u),i=this._toTzolkin(u);return{haabMonthName:this.local.haabMonths[s[0]-1],haabMonth:s[0],haabDay:s[1],tzolkinDayName:this.local.tzolkinMonths[i[0]-1],tzolkinDay:i[0],tzolkinTrecena:i[1]}},_toHaab:function(f){var l=h((f-=this.jdEpoch)+8+340,365);return[Math.floor(l/20)+1,h(l,20)]},_toTzolkin:function(f){return[e((f-=this.jdEpoch)+20,20),e(f+4,13)]},toJD:function(f,l,o){var u=this._validate(f,l,o,t.local.invalidDate);return u.day()+20*u.month()+360*u.year()+this.jdEpoch},fromJD:function(f){f=Math.floor(f)+.5-this.jdEpoch;var l=Math.floor(f/360);f%=360,f+=f<0?360:0;var o=Math.floor(f/20),u=f%20;return this.newDate(l,o,u)}}),t.calendars.mayan=m},{"../main":628,"object-assign":476}],622:[function(r,I,B){var t=r("../main"),d=r("object-assign");function m(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}m.prototype=new t.baseCalendar;var h=t.instance("gregorian");d(m.prototype,{name:"Nanakshahi",jdEpoch:22576735e-1,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear);return h.leapYear(f.year()+(f.year()<1?1:0)+1469)},weekOfYear:function(e,f,l){var o=this.newDate(e,f,l);return o.add(1-(o.dayOfWeek()||7),"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInMonth:function(e,f){var l=this._validate(e,f,this.minDay,t.local.invalidMonth);return this.daysPerMonth[l.month()-1]+(l.month()===12&&this.leapYear(l.year())?1:0)},weekDay:function(e,f,l){return(this.dayOfWeek(e,f,l)||7)<6},toJD:function(e,f,l){var o=this._validate(e,f,l,t.local.invalidMonth);(e=o.year())<0&&e++;for(var u=o.day(),s=1;s<o.month();s++)u+=this.daysPerMonth[s-1];return u+h.toJD(e+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var f=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(f+1,1,1);)f++;for(var l=e-Math.floor(this.toJD(f,1,1)+.5)+1,o=1;l>this.daysInMonth(f,o);)l-=this.daysInMonth(f,o),o++;return this.newDate(f,o,l)}}),t.calendars.nanakshahi=m},{"../main":628,"object-assign":476}],623:[function(r,I,B){var t=r("../main"),d=r("object-assign");function m(h){this.local=this.regionalOptions[h||""]||this.regionalOptions[""]}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Nepali",jdEpoch:17007095e-1,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(h){return this.daysInYear(h)!==this.daysPerYear},weekOfYear:function(h,e,f){var l=this.newDate(h,e,f);return l.add(-l.dayOfWeek(),"d"),Math.floor((l.dayOfYear()-1)/7)+1},daysInYear:function(h){if(h=this._validate(h,this.minMonth,this.minDay,t.local.invalidYear).year(),this.NEPALI_CALENDAR_DATA[h]===void 0)return this.daysPerYear;for(var e=0,f=this.minMonth;f<=12;f++)e+=this.NEPALI_CALENDAR_DATA[h][f];return e},daysInMonth:function(h,e){return h.year&&(e=h.month(),h=h.year()),this._validate(h,e,this.minDay,t.local.invalidMonth),this.NEPALI_CALENDAR_DATA[h]===void 0?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[h][e]},weekDay:function(h,e,f){return this.dayOfWeek(h,e,f)!==6},toJD:function(h,e,f){var l=this._validate(h,e,f,t.local.invalidDate);h=l.year(),e=l.month(),f=l.day();var o=t.instance(),u=0,s=e,i=h;this._createMissingCalendarData(h);var c=h-(s>9||s===9&&f>=this.NEPALI_CALENDAR_DATA[i][0]?56:57);for(e!==9&&(u=f,s--);s!==9;)s<=0&&(s=12,i--),u+=this.NEPALI_CALENDAR_DATA[i][s],s--;return e===9?(u+=f-this.NEPALI_CALENDAR_DATA[i][0])<0&&(u+=o.daysInYear(c)):u+=this.NEPALI_CALENDAR_DATA[i][9]-this.NEPALI_CALENDAR_DATA[i][0],o.newDate(c,1,1).add(u,"d").toJD()},fromJD:function(h){var e=t.instance().fromJD(h),f=e.year(),l=e.dayOfYear(),o=f+56;this._createMissingCalendarData(o);for(var u=9,s=this.NEPALI_CALENDAR_DATA[o][0],i=this.NEPALI_CALENDAR_DATA[o][u]-s+1;l>i;)++u>12&&(u=1,o++),i+=this.NEPALI_CALENDAR_DATA[o][u];var c=this.NEPALI_CALENDAR_DATA[o][u]-(i-l);return this.newDate(o,u,c)},_createMissingCalendarData:function(h){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var f=h-1;f<h+2;f++)this.NEPALI_CALENDAR_DATA[f]===void 0&&(this.NEPALI_CALENDAR_DATA[f]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),t.calendars.nepali=m},{"../main":628,"object-assign":476}],624:[function(r,I,B){var t=r("../main"),d=r("object-assign");function m(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function h(e,f){return e-f*Math.floor(e/f)}m.prototype=new t.baseCalendar,d(m.prototype,{name:"Persian",jdEpoch:19483205e-1,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xE6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xE6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return 682*((f.year()-(f.year()>0?474:473))%2820+474+38)%2816<682},weekOfYear:function(e,f,l){var o=this.newDate(e,f,l);return o.add(-(o.dayOfWeek()+1)%7,"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInMonth:function(e,f){var l=this._validate(e,f,this.minDay,t.local.invalidMonth);return this.daysPerMonth[l.month()-1]+(l.month()===12&&this.leapYear(l.year())?1:0)},weekDay:function(e,f,l){return this.dayOfWeek(e,f,l)!==5},toJD:function(e,f,l){var o=this._validate(e,f,l,t.local.invalidDate);e=o.year(),f=o.month(),l=o.day();var u=e-(e>=0?474:473),s=474+h(u,2820);return l+(f<=7?31*(f-1):30*(f-1)+6)+Math.floor((682*s-110)/2816)+365*(s-1)+1029983*Math.floor(u/2820)+this.jdEpoch-1},fromJD:function(e){var f=(e=Math.floor(e)+.5)-this.toJD(475,1,1),l=Math.floor(f/1029983),o=h(f,1029983),u=2820;if(o!==1029982){var s=Math.floor(o/366),i=h(o,366);u=Math.floor((2134*s+2816*i+2815)/1028522)+s+1}var c=u+2820*l+474;c=c<=0?c-1:c;var n=e-this.toJD(c,1,1)+1,a=n<=186?Math.ceil(n/31):Math.ceil((n-6)/30),g=e-this.toJD(c,a,1)+1;return this.newDate(c,a,g)}}),t.calendars.persian=m,t.calendars.jalali=m},{"../main":628,"object-assign":476}],625:[function(r,I,B){var t=r("../main"),d=r("object-assign"),m=t.instance();function h(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}h.prototype=new t.baseCalendar,d(h.prototype,{name:"Taiwan",jdEpoch:24194025e-1,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(f.year()),m.leapYear(e)},weekOfYear:function(e,f,l){var o=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(o.year()),m.weekOfYear(e,o.month(),o.day())},daysInMonth:function(e,f){var l=this._validate(e,f,this.minDay,t.local.invalidMonth);return this.daysPerMonth[l.month()-1]+(l.month()===2&&this.leapYear(l.year())?1:0)},weekDay:function(e,f,l){return(this.dayOfWeek(e,f,l)||7)<6},toJD:function(e,f,l){var o=this._validate(e,f,l,t.local.invalidDate);return e=this._t2gYear(o.year()),m.toJD(e,o.month(),o.day())},fromJD:function(e){var f=m.fromJD(e),l=this._g2tYear(f.year());return this.newDate(l,f.month(),f.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),t.calendars.taiwan=h},{"../main":628,"object-assign":476}],626:[function(r,I,B){var t=r("../main"),d=r("object-assign"),m=t.instance();function h(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}h.prototype=new t.baseCalendar,d(h.prototype,{name:"Thai",jdEpoch:15230985e-1,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(f.year()),m.leapYear(e)},weekOfYear:function(e,f,l){var o=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(o.year()),m.weekOfYear(e,o.month(),o.day())},daysInMonth:function(e,f){var l=this._validate(e,f,this.minDay,t.local.invalidMonth);return this.daysPerMonth[l.month()-1]+(l.month()===2&&this.leapYear(l.year())?1:0)},weekDay:function(e,f,l){return(this.dayOfWeek(e,f,l)||7)<6},toJD:function(e,f,l){var o=this._validate(e,f,l,t.local.invalidDate);return e=this._t2gYear(o.year()),m.toJD(e,o.month(),o.day())},fromJD:function(e){var f=m.fromJD(e),l=this._g2tYear(f.year());return this.newDate(l,f.month(),f.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),t.calendars.thai=h},{"../main":628,"object-assign":476}],627:[function(r,I,B){var t=r("../main"),d=r("object-assign");function m(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}m.prototype=new t.baseCalendar,d(m.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012Bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var f=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return this.daysInYear(f.year())===355},weekOfYear:function(e,f,l){var o=this.newDate(e,f,l);return o.add(-o.dayOfWeek(),"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var f=0,l=1;l<=12;l++)f+=this.daysInMonth(e,l);return f},daysInMonth:function(e,f){for(var l=this._validate(e,f,this.minDay,t.local.invalidMonth).toJD()-24e5+.5,o=0,u=0;u<h.length;u++){if(h[u]>l)return h[o]-h[o-1];o++}return 30},weekDay:function(e,f,l){return this.dayOfWeek(e,f,l)!==5},toJD:function(e,f,l){var o=this._validate(e,f,l,t.local.invalidDate),u=12*(o.year()-1)+o.month()-15292;return o.day()+h[u-1]-1+24e5-.5},fromJD:function(e){for(var f=e-24e5+.5,l=0,o=0;o<h.length&&!(h[o]>f);o++)l++;var u=l+15292,s=Math.floor((u-1)/12),i=s+1,c=u-12*s,n=f-h[l-1]+1;return this.newDate(i,c,n)},isValid:function(e,f,l){var o=t.baseCalendar.prototype.isValid.apply(this,arguments);return o&&(o=(e=e.year!=null?e.year:e)>=1276&&e<=1500),o},_validate:function(e,f,l,o){var u=t.baseCalendar.prototype._validate.apply(this,arguments);if(u.year<1276||u.year>1500)throw o.replace(/\{0\}/,this.local.name);return u}}),t.calendars.ummalqura=m;var h=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":628,"object-assign":476}],628:[function(r,I,B){var t=r("object-assign");function d(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function m(o,u,s,i){if(this._calendar=o,this._year=u,this._month=s,this._day=i,this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day))throw(l.local.invalidDate||l.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function h(o,u){return"000000".substring(0,u-(o=""+o).length)+o}function e(){this.shortYearCutoff="+10"}function f(o){this.local=this.regionalOptions[o]||this.regionalOptions[""]}t(d.prototype,{instance:function(o,u){o=(o||"gregorian").toLowerCase(),u=u||"";var s=this._localCals[o+"-"+u];if(!s&&this.calendars[o]&&(s=new this.calendars[o](u),this._localCals[o+"-"+u]=s),!s)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,o);return s},newDate:function(o,u,s,i,c){return(i=(o!=null&&o.year?o.calendar():typeof i=="string"?this.instance(i,c):i)||this.instance()).newDate(o,u,s)},substituteDigits:function(o){return function(u){return(u+"").replace(/[0-9]/g,function(s){return o[s]})}},substituteChineseDigits:function(o,u){return function(s){for(var i="",c=0;s>0;){var n=s%10;i=(n===0?"":o[n]+u[c])+i,c++,s=Math.floor(s/10)}return i.indexOf(o[1]+u[1])===0&&(i=i.substr(1)),i||o[0]}}}),t(m.prototype,{newDate:function(o,u,s){return this._calendar.newDate(o==null?this:o,u,s)},year:function(o){return arguments.length===0?this._year:this.set(o,"y")},month:function(o){return arguments.length===0?this._month:this.set(o,"m")},day:function(o){return arguments.length===0?this._day:this.set(o,"d")},date:function(o,u,s){if(!this._calendar.isValid(o,u,s))throw(l.local.invalidDate||l.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=o,this._month=u,this._day=s,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(o,u){return this._calendar.add(this,o,u)},set:function(o,u){return this._calendar.set(this,o,u)},compareTo:function(o){if(this._calendar.name!==o._calendar.name)throw(l.local.differentCalendars||l.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,o._calendar.local.name);var u=this._year!==o._year?this._year-o._year:this._month!==o._month?this.monthOfYear()-o.monthOfYear():this._day-o._day;return u===0?0:u<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(o){return this._calendar.fromJD(o)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(o){return this._calendar.fromJSDate(o)},toString:function(){return(this.year()<0?"-":"")+h(Math.abs(this.year()),4)+"-"+h(this.month(),2)+"-"+h(this.day(),2)}}),t(e.prototype,{_validateLevel:0,newDate:function(o,u,s){return o==null?this.today():(o.year&&(this._validate(o,u,s,l.local.invalidDate||l.regionalOptions[""].invalidDate),s=o.day(),u=o.month(),o=o.year()),new m(this,o,u,s))},today:function(){return this.fromJSDate(new Date)},epoch:function(o){return this._validate(o,this.minMonth,this.minDay,l.local.invalidYear||l.regionalOptions[""].invalidYear).year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(o){var u=this._validate(o,this.minMonth,this.minDay,l.local.invalidYear||l.regionalOptions[""].invalidYear);return(u.year()<0?"-":"")+h(Math.abs(u.year()),4)},monthsInYear:function(o){return this._validate(o,this.minMonth,this.minDay,l.local.invalidYear||l.regionalOptions[""].invalidYear),12},monthOfYear:function(o,u){var s=this._validate(o,u,this.minDay,l.local.invalidMonth||l.regionalOptions[""].invalidMonth);return(s.month()+this.monthsInYear(s)-this.firstMonth)%this.monthsInYear(s)+this.minMonth},fromMonthOfYear:function(o,u){var s=(u+this.firstMonth-2*this.minMonth)%this.monthsInYear(o)+this.minMonth;return this._validate(o,s,this.minDay,l.local.invalidMonth||l.regionalOptions[""].invalidMonth),s},daysInYear:function(o){var u=this._validate(o,this.minMonth,this.minDay,l.local.invalidYear||l.regionalOptions[""].invalidYear);return this.leapYear(u)?366:365},dayOfYear:function(o,u,s){var i=this._validate(o,u,s,l.local.invalidDate||l.regionalOptions[""].invalidDate);return i.toJD()-this.newDate(i.year(),this.fromMonthOfYear(i.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(o,u,s){var i=this._validate(o,u,s,l.local.invalidDate||l.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(i))+2)%this.daysInWeek()},extraInfo:function(o,u,s){return this._validate(o,u,s,l.local.invalidDate||l.regionalOptions[""].invalidDate),{}},add:function(o,u,s){return this._validate(o,this.minMonth,this.minDay,l.local.invalidDate||l.regionalOptions[""].invalidDate),this._correctAdd(o,this._add(o,u,s),u,s)},_add:function(o,u,s){if(this._validateLevel++,s==="d"||s==="w"){var i=o.toJD()+u*(s==="w"?this.daysInWeek():1),c=o.calendar().fromJD(i);return this._validateLevel--,[c.year(),c.month(),c.day()]}try{var n=o.year()+(s==="y"?u:0),a=o.monthOfYear()+(s==="m"?u:0);c=o.day(),s==="y"?(o.month()!==this.fromMonthOfYear(n,a)&&(a=this.newDate(n,o.month(),this.minDay).monthOfYear()),a=Math.min(a,this.monthsInYear(n)),c=Math.min(c,this.daysInMonth(n,this.fromMonthOfYear(n,a)))):s==="m"&&(function(p){for(;a<p.minMonth;)n--,a+=p.monthsInYear(n);for(var y=p.monthsInYear(n);a>y-1+p.minMonth;)n++,a-=y,y=p.monthsInYear(n)}(this),c=Math.min(c,this.daysInMonth(n,this.fromMonthOfYear(n,a))));var g=[n,this.fromMonthOfYear(n,a),c];return this._validateLevel--,g}catch(p){throw this._validateLevel--,p}},_correctAdd:function(o,u,s,i){if(!(this.hasYearZero||i!=="y"&&i!=="m"||u[0]!==0&&o.year()>0==u[0]>0)){var c={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[i],n=s<0?-1:1;u=this._add(o,s*c[0]+n*c[1],c[2])}return o.date(u[0],u[1],u[2])},set:function(o,u,s){this._validate(o,this.minMonth,this.minDay,l.local.invalidDate||l.regionalOptions[""].invalidDate);var i=s==="y"?u:o.year(),c=s==="m"?u:o.month(),n=s==="d"?u:o.day();return s!=="y"&&s!=="m"||(n=Math.min(n,this.daysInMonth(i,c))),o.date(i,c,n)},isValid:function(o,u,s){this._validateLevel++;var i=this.hasYearZero||o!==0;if(i){var c=this.newDate(o,u,this.minDay);i=u>=this.minMonth&&u-this.minMonth<this.monthsInYear(c)&&s>=this.minDay&&s-this.minDay<this.daysInMonth(c)}return this._validateLevel--,i},toJSDate:function(o,u,s){var i=this._validate(o,u,s,l.local.invalidDate||l.regionalOptions[""].invalidDate);return l.instance().fromJD(this.toJD(i)).toJSDate()},fromJSDate:function(o){return this.fromJD(l.instance().fromJSDate(o).toJD())},_validate:function(o,u,s,i){if(o.year){if(this._validateLevel===0&&this.name!==o.calendar().name)throw(l.local.differentCalendars||l.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,o.calendar().local.name);return o}try{if(this._validateLevel++,this._validateLevel===1&&!this.isValid(o,u,s))throw i.replace(/\{0\}/,this.local.name);var c=this.newDate(o,u,s);return this._validateLevel--,c}catch(n){throw this._validateLevel--,n}}}),f.prototype=new e,t(f.prototype,{name:"Gregorian",jdEpoch:17214255e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(o){var u=this._validate(o,this.minMonth,this.minDay,l.local.invalidYear||l.regionalOptions[""].invalidYear);return(o=u.year()+(u.year()<0?1:0))%4==0&&(o%100!=0||o%400==0)},weekOfYear:function(o,u,s){var i=this.newDate(o,u,s);return i.add(4-(i.dayOfWeek()||7),"d"),Math.floor((i.dayOfYear()-1)/7)+1},daysInMonth:function(o,u){var s=this._validate(o,u,this.minDay,l.local.invalidMonth||l.regionalOptions[""].invalidMonth);return this.daysPerMonth[s.month()-1]+(s.month()===2&&this.leapYear(s.year())?1:0)},weekDay:function(o,u,s){return(this.dayOfWeek(o,u,s)||7)<6},toJD:function(o,u,s){var i=this._validate(o,u,s,l.local.invalidDate||l.regionalOptions[""].invalidDate);o=i.year(),u=i.month(),s=i.day(),o<0&&o++,u<3&&(u+=12,o--);var c=Math.floor(o/100),n=2-c+Math.floor(c/4);return Math.floor(365.25*(o+4716))+Math.floor(30.6001*(u+1))+s+n-1524.5},fromJD:function(o){var u=Math.floor(o+.5),s=Math.floor((u-186721625e-2)/36524.25),i=(s=u+1+s-Math.floor(s/4))+1524,c=Math.floor((i-122.1)/365.25),n=Math.floor(365.25*c),a=Math.floor((i-n)/30.6001),g=i-n-Math.floor(30.6001*a),p=a-(a>13.5?13:1),y=c-(p>2.5?4716:4715);return y<=0&&y--,this.newDate(y,p,g)},toJSDate:function(o,u,s){var i=this._validate(o,u,s,l.local.invalidDate||l.regionalOptions[""].invalidDate),c=new Date(i.year(),i.month()-1,i.day());return c.setHours(0),c.setMinutes(0),c.setSeconds(0),c.setMilliseconds(0),c.setHours(c.getHours()>12?c.getHours()+2:0),c},fromJSDate:function(o){return this.newDate(o.getFullYear(),o.getMonth()+1,o.getDate())}});var l=I.exports=new d;l.cdate=m,l.baseCalendar=e,l.calendars.gregorian=f},{"object-assign":476}],629:[function(r,I,B){var t=r("object-assign"),d=r("./main");t(d.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),d.local=d.regionalOptions[""],t(d.cdate.prototype,{formatDate:function(m,h){return typeof m!="string"&&(h=m,m=""),this._calendar.formatDate(m||"",this,h)}}),t(d.baseCalendar.prototype,{UNIX_EPOCH:d.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:d.instance().jdEpoch,TICKS_PER_DAY:864e9,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(m,h,e){if(typeof m!="string"&&(e=h,h=m,m=""),!h)return"";if(h.calendar()!==this)throw d.local.invalidFormat||d.regionalOptions[""].invalidFormat;m=m||this.local.dateFormat;for(var f,l,o,u,s=(e=e||{}).dayNamesShort||this.local.dayNamesShort,i=e.dayNames||this.local.dayNames,c=e.monthNumbers||this.local.monthNumbers,n=e.monthNamesShort||this.local.monthNamesShort,a=e.monthNames||this.local.monthNames,g=(e.calculateWeek||this.local.calculateWeek,function(E,k){for(var L=1;w+L<m.length&&m.charAt(w+L)===E;)L++;return w+=L-1,Math.floor(L/(k||1))>1}),p=function(E,k,L,M){var P=""+k;if(g(E,M))for(;P.length<L;)P="0"+P;return P},y=this,v=function(E){return typeof c=="function"?c.call(y,E,g("m")):T(p("m",E.month(),2))},b=function(E,k){return k?typeof a=="function"?a.call(y,E):a[E.month()-y.minMonth]:typeof n=="function"?n.call(y,E):n[E.month()-y.minMonth]},x=this.local.digits,T=function(E){return e.localNumbers&&x?x(E):E},A="",S=!1,w=0;w<m.length;w++)if(S)m.charAt(w)!=="'"||g("'")?A+=m.charAt(w):S=!1;else switch(m.charAt(w)){case"d":A+=T(p("d",h.day(),2));break;case"D":A+=(f="D",l=h.dayOfWeek(),o=s,u=i,g(f)?u[l]:o[l]);break;case"o":A+=p("o",h.dayOfYear(),3);break;case"w":A+=p("w",h.weekOfYear(),2);break;case"m":A+=v(h);break;case"M":A+=b(h,g("M"));break;case"y":A+=g("y",2)?h.year():(h.year()%100<10?"0":"")+h.year()%100;break;case"Y":g("Y",2),A+=h.formatYear();break;case"J":A+=h.toJD();break;case"@":A+=(h.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":A+=(h.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":g("'")?A+="'":S=!0;break;default:A+=m.charAt(w)}return A},parseDate:function(m,h,e){if(h==null)throw d.local.invalidArguments||d.regionalOptions[""].invalidArguments;if((h=typeof h=="object"?h.toString():h+"")==="")return null;m=m||this.local.dateFormat;var f=(e=e||{}).shortYearCutoff||this.shortYearCutoff;f=typeof f!="string"?f:this.today().year()%100+parseInt(f,10);for(var l=e.dayNamesShort||this.local.dayNamesShort,o=e.dayNames||this.local.dayNames,u=e.parseMonth||this.local.parseMonth,s=e.monthNumbers||this.local.monthNumbers,i=e.monthNamesShort||this.local.monthNamesShort,c=e.monthNames||this.local.monthNames,n=-1,a=-1,g=-1,p=-1,y=-1,v=!1,b=!1,x=function(N,U){for(var G=1;M+G<m.length&&m.charAt(M+G)===N;)G++;return M+=G-1,Math.floor(G/(U||1))>1},T=function(N,U){var G=x(N,U),X=[2,3,G?4:2,G?4:2,10,11,20]["oyYJ@!".indexOf(N)+1],K=new RegExp("^-?\\d{1,"+X+"}"),Z=h.substring(L).match(K);if(!Z)throw(d.local.missingNumberAt||d.regionalOptions[""].missingNumberAt).replace(/\{0\}/,L);return L+=Z[0].length,parseInt(Z[0],10)},A=this,S=function(){if(typeof s=="function"){x("m");var N=s.call(A,h.substring(L));return L+=N.length,N}return T("m")},w=function(N,U,G,X){for(var K=x(N,X)?G:U,Z=0;Z<K.length;Z++)if(h.substr(L,K[Z].length).toLowerCase()===K[Z].toLowerCase())return L+=K[Z].length,Z+A.minMonth;throw(d.local.unknownNameAt||d.regionalOptions[""].unknownNameAt).replace(/\{0\}/,L)},E=function(){if(typeof c=="function"){var N=x("M")?c.call(A,h.substring(L)):i.call(A,h.substring(L));return L+=N.length,N}return w("M",i,c)},k=function(){if(h.charAt(L)!==m.charAt(M))throw(d.local.unexpectedLiteralAt||d.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,L);L++},L=0,M=0;M<m.length;M++)if(b)m.charAt(M)!=="'"||x("'")?k():b=!1;else switch(m.charAt(M)){case"d":p=T("d");break;case"D":w("D",l,o);break;case"o":y=T("o");break;case"w":T("w");break;case"m":g=S();break;case"M":g=E();break;case"y":var P=M;v=!x("y",2),M=P,a=T("y",2);break;case"Y":a=T("Y",2);break;case"J":n=T("J")+.5,h.charAt(L)==="."&&(L++,T("J"));break;case"@":n=T("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":n=T("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":L=h.length;break;case"'":x("'")?k():b=!0;break;default:k()}if(L<h.length)throw d.local.unexpectedText||d.regionalOptions[""].unexpectedText;if(a===-1?a=this.today().year():a<100&&v&&(a+=f===-1?1900:this.today().year()-this.today().year()%100-(a<=f?0:100)),typeof g=="string"&&(g=u.call(this,a,g)),y>-1){g=1,p=y;for(var D=this.daysInMonth(a,g);p>D;D=this.daysInMonth(a,g))g++,p-=D}return n>-1?this.fromJD(n):this.newDate(a,g,p)},determineDate:function(m,h,e,f,l){e&&typeof e!="object"&&(l=f,f=e,e=null),typeof f!="string"&&(l=f,f="");var o=this;return h=h?h.newDate():null,m=m==null?h:typeof m=="string"?function(u){try{return o.parseDate(f,u,l)}catch(n){}for(var s=((u=u.toLowerCase()).match(/^c/)&&e?e.newDate():null)||o.today(),i=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,c=i.exec(u);c;)s.add(parseInt(c[1],10),c[2]||"d"),c=i.exec(u);return s}(m):typeof m=="number"?isNaN(m)||m===1/0||m===-1/0?h:o.today().add(m,"d"):o.newDate(m)}})},{"./main":628,"object-assign":476}],630:[function(r,I,B){var t,d=function(){return function(m,h,e,f,l,o){var u=m[0],s=e[0],i=[0],c=s;f|=0;var n=0,a=s;for(n=0;n<u;++n){var g=h[f]-o,p=h[f+c]-o;g>=0!=p>=0&&l.push(i[0]+.5+.5*(g+p)/(g-p)),f+=a,++i[0]}}};I.exports=(t={funcName:"zeroCrossings"},function(m){var h={};return function(e,f,l){var o=e.dtype,u=e.order,s=[o,u.join()].join(),i=h[s];return i||(h[s]=i=m([o,u])),i(e.shape.slice(0),e.data,e.stride,0|e.offset,f,l)}}(d.bind(void 0,t)))},{}],631:[function(r,I,B){I.exports=function(d,m){var h=[];return m=+m||0,t(d.hi(d.shape[0]-1),h,m),h};var t=r("./lib/zc-core")},{"./lib/zc-core":630}],632:[function(r,I,B){I.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],633:[function(r,I,B){var t=r("./arrow_paths"),d=r("../../plots/font_attributes"),m=r("../../plots/cartesian/constants"),h=r("../../plot_api/plot_template").templatedArray;r("../../constants/axis_placeable_objects"),I.exports=h("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:d({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:t.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:t.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",m.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",m.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",m.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",m.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:d({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":756,"../../plot_api/plot_template":827,"../../plots/cartesian/constants":845,"../../plots/font_attributes":867,"./arrow_paths":632}],634:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("./draw").draw;function h(f){var l=f._fullLayout;t.filterVisible(l.annotations).forEach(function(o){var u=d.getFromId(f,o.xref),s=d.getFromId(f,o.yref),i=d.getRefType(o.xref),c=d.getRefType(o.yref);o._extremes={},i==="range"&&e(o,u),c==="range"&&e(o,s)})}function e(f,l){var o,u=l._id,s=u.charAt(0),i=f[s],c=f["a"+s],n=f[s+"ref"],a=f["a"+s+"ref"],g=f["_"+s+"padplus"],p=f["_"+s+"padminus"],y={x:1,y:-1}[s]*f[s+"shift"],v=3*f.arrowsize*f.arrowwidth||0,b=v+y,x=v-y,T=3*f.startarrowsize*f.arrowwidth||0,A=T+y,S=T-y;if(a===n){var w=d.findExtremes(l,[l.r2c(i)],{ppadplus:b,ppadminus:x}),E=d.findExtremes(l,[l.r2c(c)],{ppadplus:Math.max(g,A),ppadminus:Math.max(p,S)});o={min:[w.min[0],E.min[0]],max:[w.max[0],E.max[0]]}}else A=c?A+c:A,S=c?S-c:S,o=d.findExtremes(l,[l.r2c(i)],{ppadplus:Math.max(g,b,A),ppadminus:Math.max(p,x,S)});f._extremes[u]=o}I.exports=function(f){var l=f._fullLayout;if(t.filterVisible(l.annotations).length&&f._fullData.length)return t.syncOrAsync([m,h],f)}},{"../../lib":787,"../../plots/cartesian/axes":838,"./draw":639}],635:[function(r,I,B){var t=r("../../lib"),d=r("../../registry"),m=r("../../plot_api/plot_template").arrayEditor;function h(f,l){var o,u,s,i,c,n,a,g=f._fullLayout.annotations,p=[],y=[],v=[],b=(l||[]).length;for(o=0;o<g.length;o++)if(i=(s=g[o]).clicktoshow){for(u=0;u<b;u++)if(n=(c=l[u]).xaxis,a=c.yaxis,n._id===s.xref&&a._id===s.yref&&n.d2r(c.x)===e(s._xclick,n)&&a.d2r(c.y)===e(s._yclick,a)){(s.visible?i==="onout"?y:v:p).push(o);break}u===b&&s.visible&&i==="onout"&&y.push(o)}return{on:p,off:y,explicitOff:v}}function e(f,l){return l.type==="log"?l.l2r(f):l.d2r(f)}I.exports={hasClickToShow:function(f,l){var o=h(f,l);return o.on.length>0||o.explicitOff.length>0},onClick:function(f,l){var o,u,s=h(f,l),i=s.on,c=s.off.concat(s.explicitOff),n={},a=f._fullLayout.annotations;if(!(!i.length&&!c.length)){for(o=0;o<i.length;o++)(u=m(f.layout,"annotations",a[i[o]])).modifyItem("visible",!0),t.extendFlat(n,u.getUpdateObj());for(o=0;o<c.length;o++)(u=m(f.layout,"annotations",a[c[o]])).modifyItem("visible",!1),t.extendFlat(n,u.getUpdateObj());return d.call("update",f,{},n)}}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../registry":915}],636:[function(r,I,B){var t=r("../../lib"),d=r("../color");I.exports=function(m,h,e,f){f("opacity");var l=f("bgcolor"),o=f("bordercolor"),u=d.opacity(o);f("borderpad");var s=f("borderwidth"),i=f("showarrow");if(f("text",i?" ":e._dfltTitle.annotation),f("textangle"),t.coerceFont(f,"font",e.font),f("width"),f("align"),f("height")&&f("valign"),i){var c,n,a=f("arrowside");a.indexOf("end")!==-1&&(c=f("arrowhead"),n=f("arrowsize")),a.indexOf("start")!==-1&&(f("startarrowhead",c),f("startarrowsize",n)),f("arrowcolor",u?h.bordercolor:d.defaultLine),f("arrowwidth",2*(u&&s||1)),f("standoff"),f("startstandoff")}var g=f("hovertext"),p=e.hoverlabel||{};if(g){var y=f("hoverlabel.bgcolor",p.bgcolor||(d.opacity(l)?d.rgb(l):d.defaultLine)),v=f("hoverlabel.bordercolor",p.bordercolor||d.contrast(y));t.coerceFont(f,"hoverlabel.font",{family:p.font.family,size:p.font.size,color:p.font.color||v})}f("captureevents",!!g)}},{"../../lib":787,"../color":650}],637:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib/to_log_range");I.exports=function(m,h,e,f){h=h||{};var l=e==="log"&&h.type==="linear",o=e==="linear"&&h.type==="log";if(l||o)for(var u,s,i=m._fullLayout.annotations,c=h._id.charAt(0),n=0;n<i.length;n++)u=i[n],s="annotations["+n+"].",u[c+"ref"]===h._id&&a(c),u["a"+c+"ref"]===h._id&&a("a"+c);function a(g){var p=u[g],y=null;y=l?d(p,h.range):Math.pow(10,p),t(y)||(y=null),f(s+g,y)}}},{"../../lib/to_log_range":815,"fast-isnumeric":246}],638:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("../../plots/array_container_defaults"),h=r("./common_defaults"),e=r("./attributes");function f(l,o,u){function s(E,k){return t.coerce(l,o,e,E,k)}var i=s("visible"),c=s("clicktoshow");if(i||c){h(l,o,u,s);for(var n=o.showarrow,a=["x","y"],g=[-10,-30],p={_fullLayout:u},y=0;y<2;y++){var v=a[y],b=d.coerceRef(l,o,p,v,"","paper");if(b!=="paper"&&d.getFromId(p,b)._annIndices.push(o._index),d.coercePosition(o,p,s,b,v,.5),n){var x="a"+v,T=d.coerceRef(l,o,p,x,"pixel",["pixel","paper"]);T!=="pixel"&&T!==b&&(T=o[x]="pixel");var A=T==="pixel"?g[y]:.4;d.coercePosition(o,p,s,T,x,A)}s(v+"anchor"),s(v+"shift")}if(t.noneOrAll(l,o,["x","y"]),n&&t.noneOrAll(l,o,["ax","ay"]),c){var S=s("xclick"),w=s("yclick");o._xclick=S===void 0?o.x:d.cleanPosition(S,p,o.xref),o._yclick=w===void 0?o.y:d.cleanPosition(w,p,o.yref)}}}I.exports=function(l,o){m(l,o,{name:"annotations",handleItemDefaults:f})}},{"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"./attributes":633,"./common_defaults":636}],639:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../registry"),m=r("../../plots/plots"),h=r("../../lib"),e=h.strTranslate,f=r("../../plots/cartesian/axes"),l=r("../color"),o=r("../drawing"),u=r("../fx"),s=r("../../lib/svg_text_utils"),i=r("../../lib/setcursor"),c=r("../dragelement"),n=r("../../plot_api/plot_template").arrayEditor,a=r("./draw_arrow_head");function g(v,b){var x=v._fullLayout.annotations[b]||{},T=f.getFromId(v,x.xref),A=f.getFromId(v,x.yref);T&&T.setScale(),A&&A.setScale(),y(v,x,b,!1,T,A)}function p(v,b,x,T,A){var S=A[x],w=A[x+"ref"],E=x.indexOf("y")!==-1,k=f.getRefType(w)==="domain",L=E?T.h:T.w;return v?k?S+(E?-b:b)/v._length:v.p2r(v.r2p(S)+b):S+(E?-b:b)/L}function y(v,b,x,T,A,S){var w,E,k=v._fullLayout,L=v._fullLayout._size,M=v._context.edits;T?(w="annotation-"+T,E=T+".annotations"):(w="annotation",E="annotations");var P=n(v.layout,E,b),D=P.modifyBase,N=P.modifyItem,U=P.getUpdateObj;k._infolayer.selectAll("."+w+'[data-index="'+x+'"]').remove();var G="clip"+k._uid+"_ann"+x;if(b._input&&b.visible!==!1){var X={x:{},y:{}},K=+b.textangle||0,Z=k._infolayer.append("g").classed(w,!0).attr("data-index",String(x)).style("opacity",b.opacity),H=Z.append("g").classed("annotation-text-g",!0),Y=M[b.showarrow?"annotationTail":"annotationPosition"],$=b.captureevents||M.annotationText||Y,z=H.append("g").style("pointer-events",$?"all":null).call(i,"pointer").on("click",function(){v._dragging=!1,v.emit("plotly_clickannotation",se(t.event))});b.hovertext&&z.on("mouseover",function(){var ve=b.hoverlabel,ke=ve.font,Ee=this.getBoundingClientRect(),be=v.getBoundingClientRect();u.loneHover({x0:Ee.left-be.left,x1:Ee.right-be.left,y:(Ee.top+Ee.bottom)/2-be.top,text:b.hovertext,color:ve.bgcolor,borderColor:ve.bordercolor,fontFamily:ke.family,fontSize:ke.size,fontColor:ke.color},{container:k._hoverlayer.node(),outerContainer:k._paper.node(),gd:v})}).on("mouseout",function(){u.loneUnhover(k._hoverlayer.node())});var j=b.borderwidth,W=b.borderpad,ee=j+W,J=z.append("rect").attr("class","bg").style("stroke-width",j+"px").call(l.stroke,b.bordercolor).call(l.fill,b.bgcolor),Q=b.width||b.height,te=k._topclips.selectAll("#"+G).data(Q?[0]:[]);te.enter().append("clipPath").classed("annclip",!0).attr("id",G).append("rect"),te.exit().remove();var ie=b.font,ae=k._meta?h.templateString(b.text,k._meta):b.text,he=z.append("text").classed("annotation-text",!0).text(ae);M.annotationText?he.call(s.makeEditable,{delegate:z,gd:v}).call(de).on("edit",function(ve){b.text=ve,this.call(de),N("text",ve),A&&A.autorange&&D(A._name+".autorange",!0),S&&S.autorange&&D(S._name+".autorange",!0),d.call("_guiRelayout",v,U())}):he.call(de)}else t.selectAll("#"+G).remove();function se(ve){var ke={index:x,annotation:b._input,fullAnnotation:b,event:ve};return T&&(ke.subplotId=T),ke}function de(ve){return ve.call(o.font,ie).attr({"text-anchor":{left:"start",right:"end"}[b.align]||"middle"}),s.convertToTspans(ve,v,ue),ve}function ue(){var ve=he.selectAll("a");ve.size()===1&&ve.text()===he.text()&&z.insert("a",":first-child").attr({"xlink:xlink:href":ve.attr("xlink:href"),"xlink:xlink:show":ve.attr("xlink:show")}).style({cursor:"pointer"}).node().appendChild(J.node());var ke=z.select(".annotation-text-math-group"),Ee=!ke.empty(),be=o.bBox((Ee?ke:he).node()),xe=be.width,ce=be.height,ge=b.width||xe,we=b.height||ce,Me=Math.round(ge+2*ee),Se=Math.round(we+2*ee);function ze(it,St){return St==="auto"&&(St=it<1/3?"left":it>2/3?"right":"center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[St]}for(var Fe=!1,Ye=["x","y"],rt=0;rt<Ye.length;rt++){var Oe,je,We,qe,et,st=Ye[rt],ct=b[st+"ref"]||st,Pt=b["a"+st+"ref"],kt={x:A,y:S}[st],at=(K+(st==="x"?0:-90))*Math.PI/180,tt=Me*Math.cos(at),_t=Se*Math.sin(at),er=Math.abs(tt)+Math.abs(_t),tr=b[st+"anchor"],Ue=b[st+"shift"]*(st==="x"?1:-1),He=X[st],Be=f.getRefType(ct);if(kt&&Be!=="domain"){var Ke=kt.r2fraction(b[st]);(Ke<0||Ke>1)&&(Pt===ct?((Ke=kt.r2fraction(b["a"+st]))<0||Ke>1)&&(Fe=!0):Fe=!0),Oe=kt._offset+kt.r2p(b[st]),qe=.5}else{var _e=Be==="domain";st==="x"?(We=b[st],Oe=_e?kt._offset+kt._length*We:Oe=L.l+L.w*We):(We=1-b[st],Oe=_e?kt._offset+kt._length*We:Oe=L.t+L.h*We),qe=b.showarrow?.5:We}if(b.showarrow){He.head=Oe;var Ce=b["a"+st];if(et=tt*ze(.5,b.xanchor)-_t*ze(.5,b.yanchor),Pt===ct){var Le=f.getRefType(Pt);Le==="domain"?(st==="y"&&(Ce=1-Ce),He.tail=kt._offset+kt._length*Ce):Le==="paper"?st==="y"?(Ce=1-Ce,He.tail=L.t+L.h*Ce):He.tail=L.l+L.w*Ce:He.tail=kt._offset+kt.r2p(Ce),je=et}else He.tail=Oe+Ce,je=et+Ce;He.text=He.tail+et;var Pe=k[st==="x"?"width":"height"];if(ct==="paper"&&(He.head=h.constrain(He.head,1,Pe-1)),Pt==="pixel"){var Xe=-Math.max(He.tail-3,He.text),ht=Math.min(He.tail+3,He.text)-Pe;Xe>0?(He.tail+=Xe,He.text+=Xe):ht>0&&(He.tail-=ht,He.text-=ht)}He.tail+=Ue,He.head+=Ue}else je=et=er*ze(qe,tr),He.text=Oe+et;He.text+=Ue,et+=Ue,je+=Ue,b["_"+st+"padplus"]=er/2+je,b["_"+st+"padminus"]=er/2-je,b["_"+st+"size"]=er,b["_"+st+"shift"]=et}if(Fe)z.remove();else{var Mt=0,pt=0;if(b.align!=="left"&&(Mt=(ge-xe)*(b.align==="center"?.5:1)),b.valign!=="top"&&(pt=(we-ce)*(b.valign==="middle"?.5:1)),Ee)ke.select("svg").attr({x:ee+Mt-1,y:ee+pt}).call(o.setClipUrl,Q?G:null,v);else{var Lt=ee+pt-be.top,vt=ee+Mt-be.left;he.call(s.positionText,vt,Lt).call(o.setClipUrl,Q?G:null,v)}te.select("rect").call(o.setRect,ee,ee,ge,we),J.call(o.setRect,j/2,j/2,Me-j,Se-j),z.call(o.setTranslate,Math.round(X.x.text-Me/2),Math.round(X.y.text-Se/2)),H.attr({transform:"rotate("+K+","+X.x.text+","+X.y.text+")"});var Dt,xt=function(it,St){Z.selectAll(".annotation-arrow-g").remove();var Nt=X.x.head,Ut=X.y.head,Qt=X.x.tail+it,Ie=X.y.tail+St,lt=X.x.text+it,wt=X.y.text+St,Ot=h.rotationXYMatrix(K,lt,wt),Gt=h.apply2DTransform(Ot),ir=h.apply2DTransform2(Ot),Xt=+J.attr("width"),Kt=+J.attr("height"),or=lt-.5*Xt,dr=or+Xt,vr=wt-.5*Kt,ur=vr+Kt,pr=[[or,vr,or,ur],[or,ur,dr,ur],[dr,ur,dr,vr],[dr,vr,or,vr]].map(ir);if(!pr.reduce(function(Pr,en){return Pr^!!h.segmentsIntersect(Nt,Ut,Nt+1e6,Ut+1e6,en[0],en[1],en[2],en[3])},!1)){pr.forEach(function(Pr){var en=h.segmentsIntersect(Qt,Ie,Nt,Ut,Pr[0],Pr[1],Pr[2],Pr[3]);en&&(Qt=en.x,Ie=en.y)});var br=b.arrowwidth,Rr=b.arrowcolor,_r=b.arrowside,jr=Z.append("g").style({opacity:l.opacity(Rr)}).classed("annotation-arrow-g",!0),$r=jr.append("path").attr("d","M"+Qt+","+Ie+"L"+Nt+","+Ut).style("stroke-width",br+"px").call(l.stroke,l.rgb(Rr));if(a($r,_r,b),M.annotationPosition&&$r.node().parentNode&&!T){var pn=Nt,In=Ut;if(b.standoff){var On=Math.sqrt(Math.pow(Nt-Qt,2)+Math.pow(Ut-Ie,2));pn+=b.standoff*(Qt-Nt)/On,In+=b.standoff*(Ie-Ut)/On}var Sn,an,Nr=jr.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(Qt-pn)+","+(Ie-In),transform:e(pn,In)}).style("stroke-width",br+6+"px").call(l.stroke,"rgba(0,0,0,0)").call(l.fill,"rgba(0,0,0,0)");c.init({element:Nr.node(),gd:v,prepFn:function(){var Pr=o.getTranslate(z);Sn=Pr.x,an=Pr.y,A&&A.autorange&&D(A._name+".autorange",!0),S&&S.autorange&&D(S._name+".autorange",!0)},moveFn:function(Pr,en){var tn=Gt(Sn,an),Qr=tn[0]+Pr,rn=tn[1]+en;z.call(o.setTranslate,Qr,rn),N("x",p(A,Pr,"x",L,b)),N("y",p(S,en,"y",L,b)),b.axref===b.xref&&N("ax",p(A,Pr,"ax",L,b)),b.ayref===b.yref&&N("ay",p(S,en,"ay",L,b)),jr.attr("transform",e(Pr,en)),H.attr({transform:"rotate("+K+","+Qr+","+rn+")"})},doneFn:function(){d.call("_guiRelayout",v,U());var Pr=document.querySelector(".js-notes-box-panel");Pr&&Pr.redraw(Pr.selectedObj)}})}}};b.showarrow&&xt(0,0),Y&&c.init({element:z.node(),gd:v,prepFn:function(){Dt=H.attr("transform")},moveFn:function(it,St){var Nt="pointer";if(b.showarrow)b.axref===b.xref?N("ax",p(A,it,"ax",L,b)):N("ax",b.ax+it),b.ayref===b.yref?N("ay",p(S,St,"ay",L.w,b)):N("ay",b.ay+St),xt(it,St);else{if(T)return;var Ut,Qt;if(A)Ut=p(A,it,"x",L,b);else{var Ie=b._xsize/L.w,lt=b.x+(b._xshift-b.xshift)/L.w-Ie/2;Ut=c.align(lt+it/L.w,Ie,0,1,b.xanchor)}if(S)Qt=p(S,St,"y",L,b);else{var wt=b._ysize/L.h,Ot=b.y-(b._yshift+b.yshift)/L.h-wt/2;Qt=c.align(Ot-St/L.h,wt,0,1,b.yanchor)}N("x",Ut),N("y",Qt),A&&S||(Nt=c.getCursor(A?.5:Ut,S?.5:Qt,b.xanchor,b.yanchor))}H.attr({transform:e(it,St)+Dt}),i(z,Nt)},clickFn:function(it,St){b.captureevents&&v.emit("plotly_clickannotation",se(St))},doneFn:function(){i(z),d.call("_guiRelayout",v,U());var it=document.querySelector(".js-notes-box-panel");it&&it.redraw(it.selectedObj)}})}}}I.exports={draw:function(v){var b=v._fullLayout;b._infolayer.selectAll(".annotation").remove();for(var x=0;x<b.annotations.length;x++)b.annotations[x].visible&&g(v,x);return m.previousPromises(v)},drawOne:g,drawRaw:y}},{"../../lib":787,"../../lib/setcursor":808,"../../lib/svg_text_utils":813,"../../plot_api/plot_template":827,"../../plots/cartesian/axes":838,"../../plots/plots":901,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"../fx":690,"./draw_arrow_head":640,"@plotly/d3":58}],640:[function(r,I,B){var t=r("@plotly/d3"),d=r("../color"),m=r("./arrow_paths"),h=r("../../lib"),e=h.strScale,f=h.strRotate,l=h.strTranslate;I.exports=function(o,u,s){var i,c,n,a,g=o.node(),p=m[s.arrowhead||0],y=m[s.startarrowhead||0],v=(s.arrowwidth||1)*(s.arrowsize||1),b=(s.arrowwidth||1)*(s.startarrowsize||1),x=u.indexOf("start")>=0,T=u.indexOf("end")>=0,A=p.backoff*v+s.standoff,S=y.backoff*b+s.startstandoff;if(g.nodeName==="line"){i={x:+o.attr("x1"),y:+o.attr("y1")},c={x:+o.attr("x2"),y:+o.attr("y2")};var w=i.x-c.x,E=i.y-c.y;if(a=(n=Math.atan2(E,w))+Math.PI,A&&S&&A+S>Math.sqrt(w*w+E*E))return void Z();if(A){if(A*A>w*w+E*E)return void Z();var k=A*Math.cos(n),L=A*Math.sin(n);c.x+=k,c.y+=L,o.attr({x2:c.x,y2:c.y})}if(S){if(S*S>w*w+E*E)return void Z();var M=S*Math.cos(n),P=S*Math.sin(n);i.x-=M,i.y-=P,o.attr({x1:i.x,y1:i.y})}}else if(g.nodeName==="path"){var D=g.getTotalLength(),N="";if(D<A+S)return void Z();var U=g.getPointAtLength(0),G=g.getPointAtLength(.1);n=Math.atan2(U.y-G.y,U.x-G.x),i=g.getPointAtLength(Math.min(S,D)),N="0px,"+S+"px,";var X=g.getPointAtLength(D),K=g.getPointAtLength(D-.1);a=Math.atan2(X.y-K.y,X.x-K.x),c=g.getPointAtLength(Math.max(0,D-A)),N+=D-(N?S+A:A)+"px,"+D+"px",o.style("stroke-dasharray",N)}function Z(){o.style("stroke-dasharray","0px,100px")}function H(Y,$,z,j){Y.path&&(Y.noRotate&&(z=0),t.select(g.parentNode).append("path").attr({class:o.attr("class"),d:Y.path,transform:l($.x,$.y)+f(180*z/Math.PI)+e(j)}).style({fill:d.rgb(s.arrowcolor),"stroke-width":0}))}x&&H(y,i,n,b),T&&H(p,c,a,v)}},{"../../lib":787,"../color":650,"./arrow_paths":632,"@plotly/d3":58}],641:[function(r,I,B){var t=r("./draw"),d=r("./click");I.exports={moduleType:"component",name:"annotations",layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),includeBasePlot:r("../../plots/cartesian/include_components")("annotations"),calcAutorange:r("./calc_autorange"),draw:t.draw,drawOne:t.drawOne,drawRaw:t.drawRaw,hasClickToShow:d.hasClickToShow,onClick:d.onClick,convertCoords:r("./convert_coords")}},{"../../plots/cartesian/include_components":851,"./attributes":633,"./calc_autorange":634,"./click":635,"./convert_coords":637,"./defaults":638,"./draw":639}],642:[function(r,I,B){var t=r("../annotations/attributes"),d=r("../../plot_api/edit_types").overrideAll,m=r("../../plot_api/plot_template").templatedArray;I.exports=d(m("annotation",{visible:t.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:t.xanchor,xshift:t.xshift,yanchor:t.yanchor,yshift:t.yshift,text:t.text,textangle:t.textangle,font:t.font,width:t.width,height:t.height,opacity:t.opacity,align:t.align,valign:t.valign,bgcolor:t.bgcolor,bordercolor:t.bordercolor,borderpad:t.borderpad,borderwidth:t.borderwidth,showarrow:t.showarrow,arrowcolor:t.arrowcolor,arrowhead:t.arrowhead,startarrowhead:t.startarrowhead,arrowside:t.arrowside,arrowsize:t.arrowsize,startarrowsize:t.startarrowsize,arrowwidth:t.arrowwidth,standoff:t.standoff,startstandoff:t.startstandoff,hovertext:t.hovertext,hoverlabel:t.hoverlabel,captureevents:t.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../annotations/attributes":633}],643:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes");function m(h,e){var f=e.fullSceneLayout.domain,l=e.fullLayout._size,o={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};h._xa={},t.extendFlat(h._xa,o),d.setConvert(h._xa),h._xa._offset=l.l+f.x[0]*l.w,h._xa.l2p=function(){return .5*(1+h._pdata[0]/h._pdata[3])*l.w*(f.x[1]-f.x[0])},h._ya={},t.extendFlat(h._ya,o),d.setConvert(h._ya),h._ya._offset=l.t+(1-f.y[1])*l.h,h._ya.l2p=function(){return .5*(1-h._pdata[1]/h._pdata[3])*l.h*(f.y[1]-f.y[0])}}I.exports=function(h){for(var e=h.fullSceneLayout.annotations,f=0;f<e.length;f++)m(e[f],h);h.fullLayout._infolayer.selectAll(".annotation-"+h.id).remove()}},{"../../lib":787,"../../plots/cartesian/axes":838}],644:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("../../plots/array_container_defaults"),h=r("../annotations/common_defaults"),e=r("./attributes");function f(l,o,u,s){function i(n,a){return t.coerce(l,o,e,n,a)}function c(n){var a=n+"axis",g={_fullLayout:{}};return g._fullLayout[a]=u[a],d.coercePosition(o,g,i,n,n,.5)}i("visible")&&(h(l,o,s.fullLayout,i),c("x"),c("y"),c("z"),t.noneOrAll(l,o,["x","y","z"]),o.xref="x",o.yref="y",o.zref="z",i("xanchor"),i("yanchor"),i("xshift"),i("yshift"),o.showarrow&&(o.axref="pixel",o.ayref="pixel",i("ax",-10),i("ay",-30),t.noneOrAll(l,o,["ax","ay"])))}I.exports=function(l,o,u){m(l,o,{name:"annotations",handleItemDefaults:f,fullLayout:u.fullLayout})}},{"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"../annotations/common_defaults":636,"./attributes":642}],645:[function(r,I,B){var t=r("../annotations/draw").drawRaw,d=r("../../plots/gl3d/project"),m=["x","y","z"];I.exports=function(h){for(var e=h.fullSceneLayout,f=h.dataScale,l=e.annotations,o=0;o<l.length;o++){for(var u=l[o],s=!1,i=0;i<3;i++){var c=m[i],n=u[c],a=e[c+"axis"].r2fraction(n);if(a<0||a>1){s=!0;break}}s?h.fullLayout._infolayer.select(".annotation-"+h.id+'[data-index="'+o+'"]').remove():(u._pdata=d(h.glplot.cameraParams,[e.xaxis.r2l(u.x)*f[0],e.yaxis.r2l(u.y)*f[1],e.zaxis.r2l(u.z)*f[2]]),t(h.graphDiv,u,o,h.id,u._xa,u._ya))}}},{"../../plots/gl3d/project":889,"../annotations/draw":639}],646:[function(r,I,B){var t=r("../../registry"),d=r("../../lib");I.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:r("./attributes")}}},layoutAttributes:r("./attributes"),handleDefaults:r("./defaults"),includeBasePlot:function(m,h){var e=t.subplotsRegistry.gl3d;if(!!e)for(var f=e.attrRegex,l=Object.keys(m),o=0;o<l.length;o++){var u=l[o];f.test(u)&&(m[u].annotations||[]).length&&(d.pushUnique(h._basePlotModules,e),d.pushUnique(h._subplots.gl3d,u))}},convert:r("./convert"),draw:r("./draw")}},{"../../lib":787,"../../registry":915,"./attributes":642,"./convert":643,"./defaults":644,"./draw":645}],647:[function(r,I,B){I.exports=r("world-calendars/dist/main"),r("world-calendars/dist/plus"),r("world-calendars/dist/calendars/chinese"),r("world-calendars/dist/calendars/coptic"),r("world-calendars/dist/calendars/discworld"),r("world-calendars/dist/calendars/ethiopian"),r("world-calendars/dist/calendars/hebrew"),r("world-calendars/dist/calendars/islamic"),r("world-calendars/dist/calendars/julian"),r("world-calendars/dist/calendars/mayan"),r("world-calendars/dist/calendars/nanakshahi"),r("world-calendars/dist/calendars/nepali"),r("world-calendars/dist/calendars/persian"),r("world-calendars/dist/calendars/taiwan"),r("world-calendars/dist/calendars/thai"),r("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":614,"world-calendars/dist/calendars/coptic":615,"world-calendars/dist/calendars/discworld":616,"world-calendars/dist/calendars/ethiopian":617,"world-calendars/dist/calendars/hebrew":618,"world-calendars/dist/calendars/islamic":619,"world-calendars/dist/calendars/julian":620,"world-calendars/dist/calendars/mayan":621,"world-calendars/dist/calendars/nanakshahi":622,"world-calendars/dist/calendars/nepali":623,"world-calendars/dist/calendars/persian":624,"world-calendars/dist/calendars/taiwan":625,"world-calendars/dist/calendars/thai":626,"world-calendars/dist/calendars/ummalqura":627,"world-calendars/dist/main":628,"world-calendars/dist/plus":629}],648:[function(r,I,B){var t=r("./calendars"),d=r("../../lib"),m=r("../../constants/numerical"),h=m.EPOCHJD,e=m.ONEDAY,f={valType:"enumerated",values:d.sortObjectKeys(t.calendars),editType:"calc",dflt:"gregorian"},l=function(y,v,b,x){var T={};return T[b]=f,d.coerce(y,v,T,b,x)},o={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:"##",w:"##",c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}},u={};function s(y){var v=u[y];return v||(v=u[y]=t.instance(y))}function i(y){return d.extendFlat({},f,{description:y})}function c(y){return"Sets the calendar system to use with `"+y+"` date data."}var n={xcalendar:i(c("x"))},a=d.extendFlat({},n,{ycalendar:i(c("y"))}),g=d.extendFlat({},a,{zcalendar:i(c("z"))}),p=i(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));I.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:a,bar:a,box:a,heatmap:a,contour:a,histogram:a,histogram2d:a,histogram2dcontour:a,scatter3d:g,surface:g,mesh3d:g,scattergl:a,ohlc:n,candlestick:n},layout:{calendar:i(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:p},yaxis:{calendar:p},scene:{xaxis:{calendar:p},yaxis:{calendar:p},zaxis:{calendar:p}},polar:{radialaxis:{calendar:p}}},transforms:{filter:{valuecalendar:i(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:i(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:f,handleDefaults:l,handleTraceDefaults:function(y,v,b,x){for(var T=0;T<b.length;T++)l(y,v,b[T]+"calendar",x.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:s,worldCalFmt:function(y,v,b){for(var x,T,A,S,w,E=Math.floor((v+.05)/e)+h,k=s(b).fromJD(E),L=0;(L=y.indexOf("%",L))!==-1;)(x=y.charAt(L+1))==="0"||x==="-"||x==="_"?(A=3,T=y.charAt(L+2),x==="_"&&(x="-")):(T=x,x="0",A=2),(S=o[T])?(w=S==="##"?"##":k.formatDate(S[x]),y=y.substr(0,L)+w+y.substr(L+A),L+=w.length):L+=A;return y}}},{"../../constants/numerical":763,"../../lib":787,"./calendars":647}],649:[function(r,I,B){B.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],B.defaultLine="#444",B.lightLine="#eee",B.background="#fff",B.borderLine="#BEC8D9",B.lightFraction=1e3/11},{}],650:[function(r,I,B){var t=r("tinycolor2"),d=r("fast-isnumeric"),m=r("../../lib/array").isTypedArray,h=I.exports={},e=r("./attributes");h.defaults=e.defaults;var f=h.defaultLine=e.defaultLine;h.lightLine=e.lightLine;var l=h.background=e.background;function o(u){if(d(u)||typeof u!="string")return u;var s=u.trim();if(s.substr(0,3)!=="rgb")return u;var i=s.match(/^rgba?\s*\(([^()]*)\)$/);if(!i)return u;var c=i[1].trim().split(/\s*[\s,]\s*/),n=s.charAt(3)==="a"&&c.length===4;if(!n&&c.length!==3)return u;for(var a=0;a<c.length;a++){if(!c[a].length||(c[a]=Number(c[a]),!(c[a]>=0)))return u;if(a===3)c[a]>1&&(c[a]=1);else if(c[a]>=1)return u}var g=Math.round(255*c[0])+", "+Math.round(255*c[1])+", "+Math.round(255*c[2]);return n?"rgba("+g+", "+c[3]+")":"rgb("+g+")"}h.tinyRGB=function(u){var s=u.toRgb();return"rgb("+Math.round(s.r)+", "+Math.round(s.g)+", "+Math.round(s.b)+")"},h.rgb=function(u){return h.tinyRGB(t(u))},h.opacity=function(u){return u?t(u).getAlpha():0},h.addOpacity=function(u,s){var i=t(u).toRgb();return"rgba("+Math.round(i.r)+", "+Math.round(i.g)+", "+Math.round(i.b)+", "+s+")"},h.combine=function(u,s){var i=t(u).toRgb();if(i.a===1)return t(u).toRgbString();var c=t(s||l).toRgb(),n=c.a===1?c:{r:255*(1-c.a)+c.r*c.a,g:255*(1-c.a)+c.g*c.a,b:255*(1-c.a)+c.b*c.a},a={r:n.r*(1-i.a)+i.r*i.a,g:n.g*(1-i.a)+i.g*i.a,b:n.b*(1-i.a)+i.b*i.a};return t(a).toRgbString()},h.contrast=function(u,s,i){var c=t(u);return c.getAlpha()!==1&&(c=t(h.combine(u,l))),(c.isDark()?s?c.lighten(s):l:i?c.darken(i):f).toString()},h.stroke=function(u,s){var i=t(s);u.style({stroke:h.tinyRGB(i),"stroke-opacity":i.getAlpha()})},h.fill=function(u,s){var i=t(s);u.style({fill:h.tinyRGB(i),"fill-opacity":i.getAlpha()})},h.clean=function(u){if(u&&typeof u=="object"){var s,i,c,n,a=Object.keys(u);for(s=0;s<a.length;s++)if(n=u[c=a[s]],c.substr(c.length-5)==="color")if(Array.isArray(n))for(i=0;i<n.length;i++)n[i]=o(n[i]);else u[c]=o(n);else if(c.substr(c.length-10)==="colorscale"&&Array.isArray(n))for(i=0;i<n.length;i++)Array.isArray(n[i])&&(n[i][1]=o(n[i][1]));else if(Array.isArray(n)){var g=n[0];if(!Array.isArray(g)&&g&&typeof g=="object")for(i=0;i<n.length;i++)h.clean(n[i])}else n&&typeof n=="object"&&!m(n)&&h.clean(n)}}},{"../../lib/array":769,"./attributes":649,"fast-isnumeric":246,tinycolor2:583}],651:[function(r,I,B){var t=r("../../plots/cartesian/layout_attributes"),d=r("../../plots/font_attributes"),m=r("../../lib/extend").extendFlat,h=r("../../plot_api/edit_types").overrideAll;I.exports=h({thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:t.linecolor,outlinewidth:t.linewidth,bordercolor:t.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:t.tickmode,nticks:t.nticks,tick0:t.tick0,dtick:t.dtick,tickvals:t.tickvals,ticktext:t.ticktext,ticks:m({},t.ticks,{dflt:""}),ticklabeloverflow:m({},t.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside bottom","inside bottom"],dflt:"outside"},ticklen:t.ticklen,tickwidth:t.tickwidth,tickcolor:t.tickcolor,showticklabels:t.showticklabels,tickfont:d({}),tickangle:t.tickangle,tickformat:t.tickformat,tickformatstops:t.tickformatstops,tickprefix:t.tickprefix,showtickprefix:t.showtickprefix,ticksuffix:t.ticksuffix,showticksuffix:t.showticksuffix,separatethousands:t.separatethousands,exponentformat:t.exponentformat,minexponent:t.minexponent,showexponent:t.showexponent,title:{text:{valType:"string"},font:d({}),side:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}},_deprecated:{title:{valType:"string"},titlefont:d({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/cartesian/layout_attributes":853,"../../plots/font_attributes":867}],652:[function(r,I,B){I.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],653:[function(r,I,B){var t=r("../../lib"),d=r("../../plot_api/plot_template"),m=r("../../plots/cartesian/tick_value_defaults"),h=r("../../plots/cartesian/tick_mark_defaults"),e=r("../../plots/cartesian/tick_label_defaults"),f=r("./attributes");I.exports=function(l,o,u){var s=d.newContainer(o,"colorbar"),i=l.colorbar||{};function c(x,T){return t.coerce(i,s,f,x,T)}var n=c("thicknessmode");c("thickness",n==="fraction"?30/(u.width-u.margin.l-u.margin.r):30);var a=c("lenmode");c("len",a==="fraction"?1:u.height-u.margin.t-u.margin.b),c("x"),c("xanchor"),c("xpad"),c("y"),c("yanchor"),c("ypad"),t.noneOrAll(i,s,["x","y"]),c("outlinecolor"),c("outlinewidth"),c("bordercolor"),c("borderwidth"),c("bgcolor");var g=c("ticklabelposition");c("ticklabeloverflow",g.indexOf("inside")!==-1?"hide past domain":"hide past div"),m(i,s,c,"linear");var p=u.font,y={outerTicks:!1,font:p};g.indexOf("inside")!==-1&&(y.bgColor="black"),e(i,s,c,"linear",y),h(i,s,c,"linear",y),c("title.text",u._dfltTitle.colorbar);var v=s.tickfont,b=t.extendFlat({},v,{color:p.color,size:t.bigFont(v.size)});t.coerceFont(c,"title.font",b),c("title.side")}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/cartesian/tick_label_defaults":860,"../../plots/cartesian/tick_mark_defaults":861,"../../plots/cartesian/tick_value_defaults":862,"./attributes":651}],654:[function(r,I,B){var t=r("@plotly/d3"),d=r("tinycolor2"),m=r("../../plots/plots"),h=r("../../registry"),e=r("../../plots/cartesian/axes"),f=r("../dragelement"),l=r("../../lib"),o=l.strTranslate,u=r("../../lib/extend").extendFlat,s=r("../../lib/setcursor"),i=r("../drawing"),c=r("../color"),n=r("../titles"),a=r("../../lib/svg_text_utils"),g=r("../colorscale/helpers").flipScale,p=r("../../plots/cartesian/axis_defaults"),y=r("../../plots/cartesian/position_defaults"),v=r("../../plots/cartesian/layout_attributes"),b=r("../../constants/alignment"),x=b.LINE_SPACING,T=b.FROM_TL,A=b.FROM_BR,S=r("./constants").cn;I.exports={draw:function(w){var E=w._fullLayout._infolayer.selectAll("g."+S.colorbar).data(function(k){var L,M,P,D,N=k._fullLayout,U=k.calcdata,G=[];function X(Q){return u(Q,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function K(){typeof D.calc=="function"?D.calc(k,P,L):(L._fillgradient=M.reversescale?g(M.colorscale):M.colorscale,L._zrange=[M[D.min],M[D.max]])}for(var Z=0;Z<U.length;Z++){var H=U[Z],Y=(P=H[0].trace)._module.colorbar;if(P.visible===!0&&Y)for(var $=Array.isArray(Y),z=$?Y:[Y],j=0;j<z.length;j++){var W=(D=z[j]).container;(M=W?P[W]:P)&&M.showscale&&((L=X(M.colorbar))._id="cb"+P.uid+($&&W?"-"+W:""),L._traceIndex=P.index,L._propPrefix=(W?W+".":"")+"colorbar.",L._meta=P._meta,K(),G.push(L))}}for(var ee in N._colorAxes)if((M=N[ee]).showscale){var J=N._colorAxes[ee];(L=X(M.colorbar))._id="cb"+ee,L._propPrefix=ee+".colorbar.",L._meta=N._meta,D={min:"cmin",max:"cmax"},J[0]!=="heatmap"&&(P=J[1],D.calc=P._module.colorbar.calc),K(),G.push(L)}return G}(w),function(k){return k._id});E.enter().append("g").attr("class",function(k){return k._id}).classed(S.colorbar,!0),E.each(function(k){var L=t.select(this);l.ensureSingle(L,"rect",S.cbbg),l.ensureSingle(L,"g",S.cbfills),l.ensureSingle(L,"g",S.cblines),l.ensureSingle(L,"g",S.cbaxis,function(P){P.classed(S.crisp,!0)}),l.ensureSingle(L,"g",S.cbtitleunshift,function(P){P.append("g").classed(S.cbtitle,!0)}),l.ensureSingle(L,"rect",S.cboutline);var M=function(P,D,N){var U=N._fullLayout,G=U._size,X=D._fillcolor,K=D._line,Z=D.title,H=Z.side,Y=D._zrange||t.extent((typeof X=="function"?X:K.color).domain()),$=typeof K.color=="function"?K.color:function(){return K.color},z=typeof X=="function"?X:function(){return X},j=D._levels,W=function(Oe,je,We){var qe,et,st=je._levels,ct=[],Pt=[],kt=st.end+st.size/100,at=st.size,tt=1.001*We[0]-.001*We[1],_t=1.001*We[1]-.001*We[0];for(et=0;et<1e5&&(qe=st.start+et*at,!(at>0?qe>=kt:qe<=kt));et++)qe>tt&&qe<_t&&ct.push(qe);if(je._fillgradient)Pt=[0];else if(typeof je._fillcolor=="function"){var er=je._filllevels;if(er)for(kt=er.end+er.size/100,at=er.size,et=0;et<1e5&&(qe=er.start+et*at,!(at>0?qe>=kt:qe<=kt));et++)qe>We[0]&&qe<We[1]&&Pt.push(qe);else(Pt=ct.map(function(tr){return tr-st.size/2})).push(Pt[Pt.length-1]+st.size)}else je._fillcolor&&typeof je._fillcolor=="string"&&(Pt=[0]);return st.size<0&&(ct.reverse(),Pt.reverse()),{line:ct,fill:Pt}}(0,D,Y),ee=W.fill,J=W.line,Q=Math.round(D.thickness*(D.thicknessmode==="fraction"?G.w:1)),te=Q/G.w,ie=Math.round(D.len*(D.lenmode==="fraction"?G.h:1)),ae=ie/G.h,he=D.xpad/G.w,se=(D.borderwidth+D.outlinewidth)/2,de=D.ypad/G.h,ue=Math.round(D.x*G.w+D.xpad),ve=D.x-te*({middle:.5,right:1}[D.xanchor]||0),ke=D.y+ae*(({top:-.5,bottom:.5}[D.yanchor]||0)-.5),Ee=Math.round(G.h*(1-ke)),be=Ee-ie;D._lenFrac=ae,D._thickFrac=te,D._xLeftFrac=ve,D._yBottomFrac=ke;var xe=D._axis=function(Oe,je,We){var qe=Oe._fullLayout,et={type:"linear",range:We,tickmode:je.tickmode,nticks:je.nticks,tick0:je.tick0,dtick:je.dtick,tickvals:je.tickvals,ticktext:je.ticktext,ticks:je.ticks,ticklen:je.ticklen,tickwidth:je.tickwidth,tickcolor:je.tickcolor,showticklabels:je.showticklabels,ticklabelposition:je.ticklabelposition,ticklabeloverflow:je.ticklabeloverflow,tickfont:je.tickfont,tickangle:je.tickangle,tickformat:je.tickformat,exponentformat:je.exponentformat,minexponent:je.minexponent,separatethousands:je.separatethousands,showexponent:je.showexponent,showtickprefix:je.showtickprefix,tickprefix:je.tickprefix,showticksuffix:je.showticksuffix,ticksuffix:je.ticksuffix,title:je.title,showline:!0,anchor:"free",side:"right",position:1},st={type:"linear",_id:"y"+je._id},ct={letter:"y",font:qe.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:qe.calendar};function Pt(kt,at){return l.coerce(et,st,v,kt,at)}return p(et,st,Pt,ct,qe),y(et,st,Pt,ct),st}(N,D,Y);if(xe.position=D.x+he+te,["top","bottom"].indexOf(H)!==-1&&(xe.title.side=H,xe.titlex=D.x+he,xe.titley=ke+(Z.side==="top"?ae-de:de)),K.color&&D.tickmode==="auto"){xe.tickmode="linear",xe.tick0=j.start;var ce=j.size,ge=l.constrain((Ee-be)/50,4,15)+1,we=(Y[1]-Y[0])/((D.nticks||ge)*ce);if(we>1){var Me=Math.pow(10,Math.floor(Math.log(we)/Math.LN10));ce*=Me*l.roundUp(we/Me,[2,5,10]),(Math.abs(j.start)/j.size+1e-6)%1<2e-6&&(xe.tick0=0)}xe.dtick=ce}xe.domain=[ke+de,ke+ae-de],xe.setScale(),P.attr("transform",o(Math.round(G.l),Math.round(G.t)));var Se,ze=P.select("."+S.cbtitleunshift).attr("transform",o(-Math.round(G.l),-Math.round(G.t))),Fe=P.select("."+S.cbaxis),Ye=0;function rt(Oe,je){var We={propContainer:xe,propName:D._propPrefix+"title",traceIndex:D._traceIndex,_meta:D._meta,placeholder:U._dfltTitle.colorbar,containerGroup:P.select("."+S.cbtitle)},qe=Oe.charAt(0)==="h"?Oe.substr(1):"h"+Oe;P.selectAll("."+qe+",."+qe+"-math-group").remove(),n.draw(N,Oe,u(We,je||{}))}return l.syncOrAsync([m.previousPromises,function(){if(["top","bottom"].indexOf(H)!==-1){var Oe,je=G.l+(D.x+he)*G.w,We=xe.title.font.size;Oe=H==="top"?(1-(ke+ae-de))*G.h+G.t+3+.75*We:(1-(ke+de))*G.h+G.t-3-.25*We,rt(xe._id+"title",{attributes:{x:je,y:Oe,"text-anchor":"start"}})}},function(){if(["top","bottom"].indexOf(H)!==-1){var Oe=P.select("."+S.cbtitle),je=Oe.select("text"),We=[-D.outlinewidth/2,D.outlinewidth/2],qe=Oe.select(".h"+xe._id+"title-math-group").node(),et=15.6;if(je.node()&&(et=parseInt(je.node().style.fontSize,10)*x),qe?(Ye=i.bBox(qe).height)>et&&(We[1]-=(Ye-et)/2):je.node()&&!je.classed(S.jsPlaceholder)&&(Ye=i.bBox(je.node()).height),Ye){if(Ye+=5,H==="top")xe.domain[1]-=Ye/G.h,We[1]*=-1;else{xe.domain[0]+=Ye/G.h;var st=a.lineCount(je);We[1]+=(1-st)*et}Oe.attr("transform",o(We[0],We[1])),xe.setScale()}}P.selectAll("."+S.cbfills+",."+S.cblines).attr("transform",o(0,Math.round(G.h*(1-xe.domain[1])))),Fe.attr("transform",o(0,Math.round(-G.t)));var ct=P.select("."+S.cbfills).selectAll("rect."+S.cbfill).attr("style","").data(ee);ct.enter().append("rect").classed(S.cbfill,!0).style("stroke","none"),ct.exit().remove();var Pt=Y.map(xe.c2p).map(Math.round).sort(function(er,tr){return er-tr});ct.each(function(er,tr){var Ue=[tr===0?Y[0]:(ee[tr]+ee[tr-1])/2,tr===ee.length-1?Y[1]:(ee[tr]+ee[tr+1])/2].map(xe.c2p).map(Math.round);Ue[1]=l.constrain(Ue[1]+(Ue[1]>Ue[0])?1:-1,Pt[0],Pt[1]);var He=t.select(this).attr({x:ue,width:Math.max(Q,2),y:t.min(Ue),height:Math.max(t.max(Ue)-t.min(Ue),2)});if(D._fillgradient)i.gradient(He,N,D._id,"vertical",D._fillgradient,"fill");else{var Be=z(er).replace("e-","");He.attr("fill",d(Be).toHexString())}});var kt=P.select("."+S.cblines).selectAll("path."+S.cbline).data(K.color&&K.width?J:[]);kt.enter().append("path").classed(S.cbline,!0),kt.exit().remove(),kt.each(function(er){t.select(this).attr("d","M"+ue+","+(Math.round(xe.c2p(er))+K.width/2%1)+"h"+Q).call(i.lineGroupStyle,K.width,$(er),K.dash)}),Fe.selectAll("g."+xe._id+"tick,path").remove();var at=ue+Q+(D.outlinewidth||0)/2-(D.ticks==="outside"?1:0),tt=e.calcTicks(xe),_t=e.getTickSigns(xe)[2];return e.drawTicks(N,xe,{vals:xe.ticks==="inside"?e.clipEnds(xe,tt):tt,layer:Fe,path:e.makeTickPath(xe,at,_t),transFn:e.makeTransTickFn(xe)}),e.drawLabels(N,xe,{vals:tt,layer:Fe,transFn:e.makeTransTickLabelFn(xe),labelFns:e.makeLabelFns(xe,at)})},function(){if(["top","bottom"].indexOf(H)===-1){var Oe=xe.title.font.size,je=xe._offset+xe._length/2,We=G.l+(xe.position||0)*G.w+(xe.side==="right"?10+Oe*(xe.showticklabels?1:.5):-10-Oe*(xe.showticklabels?.5:0));rt("h"+xe._id+"title",{avoid:{selection:t.select(N).selectAll("g."+xe._id+"tick"),side:H,offsetLeft:G.l,offsetTop:0,maxShift:U.width},attributes:{x:We,y:je,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}},m.previousPromises,function(){var Oe=Q+D.outlinewidth/2;if(xe.ticklabelposition.indexOf("inside")===-1&&(Oe+=i.bBox(Fe.node()).width),(Se=ze.select("text")).node()&&!Se.classed(S.jsPlaceholder)){var je,We=ze.select(".h"+xe._id+"title-math-group").node();je=We&&["top","bottom"].indexOf(H)!==-1?i.bBox(We).width:i.bBox(ze.node()).right-ue-G.l,Oe=Math.max(Oe,je)}var qe=2*D.xpad+Oe+D.borderwidth+D.outlinewidth/2,et=Ee-be;P.select("."+S.cbbg).attr({x:ue-D.xpad-(D.borderwidth+D.outlinewidth)/2,y:be-se,width:Math.max(qe,2),height:Math.max(et+2*se,2)}).call(c.fill,D.bgcolor).call(c.stroke,D.bordercolor).style("stroke-width",D.borderwidth),P.selectAll("."+S.cboutline).attr({x:ue,y:be+D.ypad+(H==="top"?Ye:0),width:Math.max(Q,2),height:Math.max(et-2*D.ypad-Ye,2)}).call(c.stroke,D.outlinecolor).style({fill:"none","stroke-width":D.outlinewidth});var st=({center:.5,right:1}[D.xanchor]||0)*qe;P.attr("transform",o(G.l-st,G.t));var ct={},Pt=T[D.yanchor],kt=A[D.yanchor];D.lenmode==="pixels"?(ct.y=D.y,ct.t=et*Pt,ct.b=et*kt):(ct.t=ct.b=0,ct.yt=D.y+D.len*Pt,ct.yb=D.y-D.len*kt);var at=T[D.xanchor],tt=A[D.xanchor];if(D.thicknessmode==="pixels")ct.x=D.x,ct.l=qe*at,ct.r=qe*tt;else{var _t=qe-Q;ct.l=_t*at,ct.r=_t*tt,ct.xl=D.x-D.thickness*at,ct.xr=D.x+D.thickness*tt}m.autoMargin(N,D._id,ct)}],N)}(L,k,w);M&&M.then&&(w._promises||[]).push(M),w._context.edits.colorbarPosition&&function(P,D,N){var U,G,X,K=N._fullLayout._size;f.init({element:P.node(),gd:N,prepFn:function(){U=P.attr("transform"),s(P)},moveFn:function(Z,H){P.attr("transform",U+o(Z,H)),G=f.align(D._xLeftFrac+Z/K.w,D._thickFrac,0,1,D.xanchor),X=f.align(D._yBottomFrac-H/K.h,D._lenFrac,0,1,D.yanchor);var Y=f.getCursor(G,X,D.xanchor,D.yanchor);s(P,Y)},doneFn:function(){if(s(P),G!==void 0&&X!==void 0){var Z={};Z[D._propPrefix+"x"]=G,Z[D._propPrefix+"y"]=X,D._traceIndex!==void 0?h.call("_guiRestyle",N,Z,D._traceIndex):h.call("_guiRelayout",N,Z)}}})}(L,k,w)}),E.exit().each(function(k){m.autoMargin(w,k._id)}).remove(),E.order()}}},{"../../constants/alignment":755,"../../lib":787,"../../lib/extend":777,"../../lib/setcursor":808,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../plots/cartesian/axis_defaults":840,"../../plots/cartesian/layout_attributes":853,"../../plots/cartesian/position_defaults":856,"../../plots/plots":901,"../../registry":915,"../color":650,"../colorscale/helpers":661,"../dragelement":669,"../drawing":672,"../titles":748,"./constants":652,"@plotly/d3":58,tinycolor2:583}],655:[function(r,I,B){var t=r("../../lib");I.exports=function(d){return t.isPlainObject(d.colorbar)}},{"../../lib":787}],656:[function(r,I,B){I.exports={moduleType:"component",name:"colorbar",attributes:r("./attributes"),supplyDefaults:r("./defaults"),draw:r("./draw").draw,hasColorbar:r("./has_colorbar")}},{"./attributes":651,"./defaults":653,"./draw":654,"./has_colorbar":655}],657:[function(r,I,B){var t=r("../colorbar/attributes"),d=r("../../lib/regex").counter,m=r("../../lib/sort_object_keys"),h=r("./scales.js").scales;m(h);function e(f){return"`"+f+"`"}I.exports=function(f,l){f=f||"";var o,u=(l=l||{}).cLetter||"c",s=("onlyIfNumerical"in l?l.onlyIfNumerical:Boolean(f),"noScale"in l?l.noScale:f==="marker.line"),i="showScaleDflt"in l?l.showScaleDflt:u==="z",c=typeof l.colorscaleDflt=="string"?h[l.colorscaleDflt]:null,n=l.editTypeOverride||"",a=f?f+".":"";"colorAttr"in l?(o=l.colorAttr,l.colorAttr):e(a+(o={z:"z",c:"color"}[u]));var g=u+"auto",p=u+"min",y=u+"max",v=u+"mid",b={};b[p]=b[y]=void 0;var x={};x[g]=!1;var T={};return o==="color"&&(T.color={valType:"color",arrayOk:!0,editType:n||"style"},l.anim&&(T.color.anim=!0)),T[g]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:b},T[p]={valType:"number",dflt:null,editType:n||"plot",impliedEdits:x},T[y]={valType:"number",dflt:null,editType:n||"plot",impliedEdits:x},T[v]={valType:"number",dflt:null,editType:"calc",impliedEdits:b},T.colorscale={valType:"colorscale",editType:"calc",dflt:c,impliedEdits:{autocolorscale:!1}},T.autocolorscale={valType:"boolean",dflt:l.autoColorDflt!==!1,editType:"calc",impliedEdits:{colorscale:void 0}},T.reversescale={valType:"boolean",dflt:!1,editType:"plot"},s||(T.showscale={valType:"boolean",dflt:i,editType:"calc"},T.colorbar=t),l.noColorAxis||(T.coloraxis={valType:"subplotid",regex:d("coloraxis"),dflt:null,editType:"calc"}),T}},{"../../lib/regex":804,"../../lib/sort_object_keys":810,"../colorbar/attributes":651,"./scales.js":665}],658:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("./helpers").extractOpts;I.exports=function(h,e,f){var l,o=h._fullLayout,u=f.vals,s=f.containerStr,i=s?d.nestedProperty(e,s).get():e,c=m(i),n=c.auto!==!1,a=c.min,g=c.max,p=c.mid,y=function(){return d.aggNums(Math.min,null,u)},v=function(){return d.aggNums(Math.max,null,u)};a===void 0?a=y():n&&(a=i._colorAx&&t(a)?Math.min(a,y()):y()),g===void 0?g=v():n&&(g=i._colorAx&&t(g)?Math.max(g,v()):v()),n&&p!==void 0&&(g-p>p-a?a=p-(g-p):g-p<p-a&&(g=p+(p-a))),a===g&&(a-=.5,g+=.5),c._sync("min",a),c._sync("max",g),c.autocolorscale&&(l=a*g<0?o.colorscale.diverging:a>=0?o.colorscale.sequential:o.colorscale.sequentialminus,c._sync("colorscale",l))}},{"../../lib":787,"./helpers":661,"fast-isnumeric":246}],659:[function(r,I,B){var t=r("../../lib"),d=r("./helpers").hasColorscale,m=r("./helpers").extractOpts;I.exports=function(h,e){function f(n,a){var g=n["_"+a];g!==void 0&&(n[a]=g)}function l(n,a){var g=a.container?t.nestedProperty(n,a.container).get():n;if(g)if(g.coloraxis)g._colorAx=e[g.coloraxis];else{var p=m(g),y=p.auto;(y||p.min===void 0)&&f(g,a.min),(y||p.max===void 0)&&f(g,a.max),p.autocolorscale&&f(g,"colorscale")}}for(var o=0;o<h.length;o++){var u=h[o],s=u._module.colorbar;if(s)if(Array.isArray(s))for(var i=0;i<s.length;i++)l(u,s[i]);else l(u,s);d(u,"marker.line")&&l(u,{container:"marker.line",min:"cmin",max:"cmax"})}for(var c in e._colorAxes)l(e[c],{min:"cmin",max:"cmax"})}},{"../../lib":787,"./helpers":661}],660:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../colorbar/has_colorbar"),h=r("../colorbar/defaults"),e=r("./scales").isValid,f=r("../../registry").traceIs;function l(o,u){var s=u.slice(0,u.length-1);return u?d.nestedProperty(o,s).get()||{}:o}I.exports=function o(u,s,i,c,n){var a=n.prefix,g=n.cLetter,p="_module"in s,y=l(u,a),v=l(s,a),b=l(s._template||{},a)||{},x=function(){return delete u.coloraxis,delete s.coloraxis,o(u,s,i,c,n)};if(p){var T=i._colorAxes||{},A=c(a+"coloraxis");if(A){var S=f(s,"contour")&&d.nestedProperty(s,"contours.coloring").get()||"heatmap",w=T[A];return void(w?(w[2].push(x),w[0]!==S&&(w[0]=!1,d.warn(["Ignoring coloraxis:",A,"setting","as it is linked to incompatible colorscales."].join(" ")))):T[A]=[S,s,[x]])}}var E=y[g+"min"],k=y[g+"max"],L=t(E)&&t(k)&&E<k;c(a+g+"auto",!L)?c(a+g+"mid"):(c(a+g+"min"),c(a+g+"max"));var M,P,D=y.colorscale,N=b.colorscale;D!==void 0&&(M=!e(D)),N!==void 0&&(M=!e(N)),c(a+"autocolorscale",M),c(a+"colorscale"),c(a+"reversescale"),a!=="marker.line."&&(a&&p&&(P=m(y)),c(a+"showscale",P)&&(a&&b&&(v._template=b),h(y,v,i)))}},{"../../lib":787,"../../registry":915,"../colorbar/defaults":653,"../colorbar/has_colorbar":655,"./scales":665,"fast-isnumeric":246}],661:[function(r,I,B){var t=r("@plotly/d3"),d=r("tinycolor2"),m=r("fast-isnumeric"),h=r("../../lib"),e=r("../color"),f=r("./scales").isValid,l=["showscale","autocolorscale","colorscale","reversescale","colorbar"],o=["min","max","mid","auto"];function u(a){var g,p,y,v=a._colorAx,b=v||a,x={};for(p=0;p<l.length;p++)x[y=l[p]]=b[y];if(v)for(g="c",p=0;p<o.length;p++)x[y=o[p]]=b["c"+y];else{var T;for(p=0;p<o.length;p++)((T="c"+(y=o[p]))in b||(T="z"+y)in b)&&(x[y]=b[T]);g=T.charAt(0)}return x._sync=function(A,S){var w=o.indexOf(A)!==-1?g+A:A;b[w]=b["_"+w]=S},x}function s(a){for(var g=u(a),p=g.min,y=g.max,v=g.reversescale?i(g.colorscale):g.colorscale,b=v.length,x=new Array(b),T=new Array(b),A=0;A<b;A++){var S=v[A];x[A]=p+S[0]*(y-p),T[A]=S[1]}return{domain:x,range:T}}function i(a){for(var g=a.length,p=new Array(g),y=g-1,v=0;y>=0;y--,v++){var b=a[y];p[v]=[1-b[0],b[1]]}return p}function c(a,g){g=g||{};for(var p=a.domain,y=a.range,v=y.length,b=new Array(v),x=0;x<v;x++){var T=d(y[x]).toRgb();b[x]=[T.r,T.g,T.b,T.a]}var A,S=t.scale.linear().domain(p).range(b).clamp(!0),w=g.noNumericCheck,E=g.returnArray;return(A=w&&E?S:w?function(k){return n(S(k))}:E?function(k){return m(k)?S(k):d(k).isValid()?k:e.defaultLine}:function(k){return m(k)?n(S(k)):d(k).isValid()?k:e.defaultLine}).domain=S.domain,A.range=function(){return y},A}function n(a){var g={r:a[0],g:a[1],b:a[2],a:a[3]};return d(g).toRgbString()}I.exports={hasColorscale:function(a,g,p){var y=g?h.nestedProperty(a,g).get()||{}:a,v=y[p||"color"],b=!1;if(h.isArrayOrTypedArray(v)){for(var x=0;x<v.length;x++)if(m(v[x])){b=!0;break}}return h.isPlainObject(y)&&(b||y.showscale===!0||m(y.cmin)&&m(y.cmax)||f(y.colorscale)||h.isPlainObject(y.colorbar))},extractOpts:u,extractScale:s,flipScale:i,makeColorScaleFunc:c,makeColorScaleFuncFromTrace:function(a,g){return c(s(a),g)}}},{"../../lib":787,"../color":650,"./scales":665,"@plotly/d3":58,"fast-isnumeric":246,tinycolor2:583}],662:[function(r,I,B){var t=r("./scales"),d=r("./helpers");I.exports={moduleType:"component",name:"colorscale",attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyLayoutDefaults:r("./layout_defaults"),handleDefaults:r("./defaults"),crossTraceDefaults:r("./cross_trace_defaults"),calc:r("./calc"),scales:t.scales,defaultScale:t.defaultScale,getScale:t.get,isValidScale:t.isValid,hasColorscale:d.hasColorscale,extractOpts:d.extractOpts,extractScale:d.extractScale,flipScale:d.flipScale,makeColorScaleFunc:d.makeColorScaleFunc,makeColorScaleFuncFromTrace:d.makeColorScaleFuncFromTrace}},{"./attributes":657,"./calc":658,"./cross_trace_defaults":659,"./defaults":660,"./helpers":661,"./layout_attributes":663,"./layout_defaults":664,"./scales":665}],663:[function(r,I,B){var t=r("../../lib/extend").extendFlat,d=r("./attributes"),m=r("./scales").scales;I.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:m.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:m.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:m.RdBu,editType:"calc"}},coloraxis:t({_isSubplotObj:!0,editType:"calc"},d("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":777,"./attributes":657,"./scales":665}],664:[function(r,I,B){var t=r("../../lib"),d=r("../../plot_api/plot_template"),m=r("./layout_attributes"),h=r("./defaults");I.exports=function(e,f){function l(g,p){return t.coerce(e,f,m,g,p)}l("colorscale.sequential"),l("colorscale.sequentialminus"),l("colorscale.diverging");var o,u,s=f._colorAxes;function i(g,p){return t.coerce(o,u,m.coloraxis,g,p)}for(var c in s){var n=s[c];if(n[0])o=e[c]||{},(u=d.newContainer(f,c,"coloraxis"))._name=c,h(o,u,f,i,{prefix:"",cLetter:"c"});else{for(var a=0;a<n[2].length;a++)n[2][a]();delete f._colorAxes[c]}}}},{"../../lib":787,"../../plot_api/plot_template":827,"./defaults":660,"./layout_attributes":663}],665:[function(r,I,B){var t=r("tinycolor2"),d={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},m=d.RdBu;function h(e){var f=0;if(!Array.isArray(e)||e.length<2||!e[0]||!e[e.length-1]||+e[0][0]!=0||+e[e.length-1][0]!=1)return!1;for(var l=0;l<e.length;l++){var o=e[l];if(o.length!==2||+o[0]<f||!t(o[1]).isValid())return!1;f=+o[0]}return!0}I.exports={scales:d,defaultScale:m,get:function(e,f){if(f||(f=m),!e)return f;function l(){try{e=d[e]||JSON.parse(e)}catch(o){e=f}}return typeof e=="string"&&(l(),typeof e=="string"&&l()),h(e)?e:f},isValid:function(e){return d[e]!==void 0||h(e)}}},{tinycolor2:583}],666:[function(r,I,B){I.exports=function(t,d,m,h,e){var f=(t-m)/(h-m),l=f+d/(h-m),o=(f+l)/2;return e==="left"||e==="bottom"?f:e==="center"||e==="middle"?o:e==="right"||e==="top"?l:f<2/3-o?f:l>4/3-o?l:o}},{}],667:[function(r,I,B){var t=r("../../lib"),d=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];I.exports=function(m,h,e,f){return m=e==="left"?0:e==="center"?1:e==="right"?2:t.constrain(Math.floor(3*m),0,2),h=f==="bottom"?0:f==="middle"?1:f==="top"?2:t.constrain(Math.floor(3*h),0,2),d[h][m]}},{"../../lib":787}],668:[function(r,I,B){B.selectMode=function(t){return t==="lasso"||t==="select"},B.drawMode=function(t){return t==="drawclosedpath"||t==="drawopenpath"||t==="drawline"||t==="drawrect"||t==="drawcircle"},B.openMode=function(t){return t==="drawline"||t==="drawopenpath"},B.rectMode=function(t){return t==="select"||t==="drawline"||t==="drawrect"||t==="drawcircle"},B.freeMode=function(t){return t==="lasso"||t==="drawclosedpath"||t==="drawopenpath"},B.selectingOrDrawing=function(t){return B.freeMode(t)||B.rectMode(t)}},{}],669:[function(r,I,B){var t=r("mouse-event-offset"),d=r("has-hover"),m=r("has-passive-events"),h=r("../../lib").removeElement,e=r("../../plots/cartesian/constants"),f=I.exports={};f.align=r("./align"),f.getCursor=r("./cursor");var l=r("./unhover");function o(){var s=document.createElement("div");s.className="dragcover";var i=s.style;return i.position="fixed",i.left=0,i.right=0,i.top=0,i.bottom=0,i.zIndex=999999999,i.background="none",document.body.appendChild(s),s}function u(s){return t(s.changedTouches?s.changedTouches[0]:s,document.body)}f.unhover=l.wrapped,f.unhoverRaw=l.raw,f.init=function(s){var i,c,n,a,g,p,y,v,b=s.gd,x=1,T=b._context.doubleClickDelay,A=s.element;b._mouseDownTime||(b._mouseDownTime=0),A.style.pointerEvents="all",A.onmousedown=w,m?(A._ontouchstart&&A.removeEventListener("touchstart",A._ontouchstart),A._ontouchstart=w,A.addEventListener("touchstart",w,{passive:!1})):A.ontouchstart=w;var S=s.clampFn||function(L,M,P){return Math.abs(L)<P&&(L=0),Math.abs(M)<P&&(M=0),[L,M]};function w(L){b._dragged=!1,b._dragging=!0;var M=u(L);i=M[0],c=M[1],y=L.target,p=L,v=L.buttons===2||L.ctrlKey,L.clientX===void 0&&L.clientY===void 0&&(L.clientX=i,L.clientY=c),(n=new Date().getTime())-b._mouseDownTime<T?x+=1:(x=1,b._mouseDownTime=n),s.prepFn&&s.prepFn(L,i,c),d&&!v?(g=o()).style.cursor=window.getComputedStyle(A).cursor:d||(g=document,a=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(A).cursor),document.addEventListener("mouseup",k),document.addEventListener("touchend",k),s.dragmode!==!1&&(L.preventDefault(),document.addEventListener("mousemove",E),document.addEventListener("touchmove",E,{passive:!1}))}function E(L){L.preventDefault();var M=u(L),P=s.minDrag||e.MINDRAG,D=S(M[0]-i,M[1]-c,P),N=D[0],U=D[1];(N||U)&&(b._dragged=!0,f.unhover(b,L)),b._dragged&&s.moveFn&&!v&&(b._dragdata={element:A,dx:N,dy:U},s.moveFn(N,U))}function k(L){if(delete b._dragdata,s.dragmode!==!1&&(L.preventDefault(),document.removeEventListener("mousemove",E),document.removeEventListener("touchmove",E)),document.removeEventListener("mouseup",k),document.removeEventListener("touchend",k),d?h(g):a&&(g.documentElement.style.cursor=a,a=null),b._dragging){if(b._dragging=!1,new Date().getTime()-b._mouseDownTime>T&&(x=Math.max(x-1,1)),b._dragged)s.doneFn&&s.doneFn();else if(s.clickFn&&s.clickFn(x,p),!v){var M;try{M=new MouseEvent("click",L)}catch(D){var P=u(L);(M=document.createEvent("MouseEvents")).initMouseEvent("click",L.bubbles,L.cancelable,L.view,L.detail,L.screenX,L.screenY,P[0],P[1],L.ctrlKey,L.altKey,L.shiftKey,L.metaKey,L.button,L.relatedTarget)}y.dispatchEvent(M)}b._dragging=!1,b._dragged=!1}else b._dragged=!1}},f.coverSlip=o},{"../../lib":787,"../../plots/cartesian/constants":845,"./align":666,"./cursor":667,"./unhover":670,"has-hover":435,"has-passive-events":436,"mouse-event-offset":460}],670:[function(r,I,B){var t=r("../../lib/events"),d=r("../../lib/throttle"),m=r("../../lib/dom").getGraphDiv,h=r("../fx/constants"),e=I.exports={};e.wrapped=function(f,l,o){(f=m(f))._fullLayout&&d.clear(f._fullLayout._uid+h.HOVERID),e.raw(f,l,o)},e.raw=function(f,l){var o=f._fullLayout,u=f._hoverdata;l||(l={}),l.target&&!f._dragged&&t.triggerHandler(f,"plotly_beforehover",l)===!1||(o._hoverlayer.selectAll("g").remove(),o._hoverlayer.selectAll("line").remove(),o._hoverlayer.selectAll("circle").remove(),f._hoverdata=void 0,l.target&&u&&f.emit("plotly_unhover",{event:l,points:u}))}},{"../../lib/dom":775,"../../lib/events":776,"../../lib/throttle":814,"../fx/constants":684}],671:[function(r,I,B){B.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},B.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],672:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=d.numberFormat,h=r("fast-isnumeric"),e=r("tinycolor2"),f=r("../../registry"),l=r("../color"),o=r("../colorscale"),u=d.strTranslate,s=r("../../lib/svg_text_utils"),i=r("../../constants/xmlns_namespaces"),c=r("../../constants/alignment").LINE_SPACING,n=r("../../constants/interactions").DESELECTDIM,a=r("../../traces/scatter/subtypes"),g=r("../../traces/scatter/make_bubble_size_func"),p=r("../../components/fx/helpers").appendArrayPointValue,y=I.exports={};y.font=function(Z,H,Y,$){d.isPlainObject(H)&&($=H.color,Y=H.size,H=H.family),H&&Z.style("font-family",H),Y+1&&Z.style("font-size",Y+"px"),$&&Z.call(l.fill,$)},y.setPosition=function(Z,H,Y){Z.attr("x",H).attr("y",Y)},y.setSize=function(Z,H,Y){Z.attr("width",H).attr("height",Y)},y.setRect=function(Z,H,Y,$,z){Z.call(y.setPosition,H,Y).call(y.setSize,$,z)},y.translatePoint=function(Z,H,Y,$){var z=Y.c2p(Z.x),j=$.c2p(Z.y);return!!(h(z)&&h(j)&&H.node())&&(H.node().nodeName==="text"?H.attr("x",z).attr("y",j):H.attr("transform",u(z,j)),!0)},y.translatePoints=function(Z,H,Y){Z.each(function($){var z=t.select(this);y.translatePoint($,z,H,Y)})},y.hideOutsideRangePoint=function(Z,H,Y,$,z,j){H.attr("display",Y.isPtWithinRange(Z,z)&&$.isPtWithinRange(Z,j)?null:"none")},y.hideOutsideRangePoints=function(Z,H){if(H._hasClipOnAxisFalse){var Y=H.xaxis,$=H.yaxis;Z.each(function(z){var j=z[0].trace,W=j.xcalendar,ee=j.ycalendar,J=f.traceIs(j,"bar-like")?".bartext":".point,.textpoint";Z.selectAll(J).each(function(Q){y.hideOutsideRangePoint(Q,t.select(this),Y,$,W,ee)})})}},y.crispRound=function(Z,H,Y){return H&&h(H)?Z._context.staticPlot?H:H<1?1:Math.round(H):Y||0},y.singleLineStyle=function(Z,H,Y,$,z){H.style("fill","none");var j=(((Z||[])[0]||{}).trace||{}).line||{},W=Y||j.width||0,ee=z||j.dash||"";l.stroke(H,$||j.color),y.dashLine(H,ee,W)},y.lineGroupStyle=function(Z,H,Y,$){Z.style("fill","none").each(function(z){var j=(((z||[])[0]||{}).trace||{}).line||{},W=H||j.width||0,ee=$||j.dash||"";t.select(this).call(l.stroke,Y||j.color).call(y.dashLine,ee,W)})},y.dashLine=function(Z,H,Y){Y=+Y||0,H=y.dashStyle(H,Y),Z.style({"stroke-dasharray":H,"stroke-width":Y+"px"})},y.dashStyle=function(Z,H){H=+H||1;var Y=Math.max(H,3);return Z==="solid"?Z="":Z==="dot"?Z=Y+"px,"+Y+"px":Z==="dash"?Z=3*Y+"px,"+3*Y+"px":Z==="longdash"?Z=5*Y+"px,"+5*Y+"px":Z==="dashdot"?Z=3*Y+"px,"+Y+"px,"+Y+"px,"+Y+"px":Z==="longdashdot"&&(Z=5*Y+"px,"+2*Y+"px,"+Y+"px,"+2*Y+"px"),Z},y.singleFillStyle=function(Z){var H=(((t.select(Z.node()).data()[0]||[])[0]||{}).trace||{}).fillcolor;H&&Z.call(l.fill,H)},y.fillGroupStyle=function(Z){Z.style("stroke-width",0).each(function(H){var Y=t.select(this);H[0].trace&&Y.call(l.fill,H[0].trace.fillcolor)})};var v=r("./symbol_defs");y.symbolNames=[],y.symbolFuncs=[],y.symbolNeedLines={},y.symbolNoDot={},y.symbolNoFill={},y.symbolList=[],Object.keys(v).forEach(function(Z){var H=v[Z],Y=H.n;y.symbolList.push(Y,String(Y),Z,Y+100,String(Y+100),Z+"-open"),y.symbolNames[Y]=Z,y.symbolFuncs[Y]=H.f,H.needLine&&(y.symbolNeedLines[Y]=!0),H.noDot?y.symbolNoDot[Y]=!0:y.symbolList.push(Y+200,String(Y+200),Z+"-dot",Y+300,String(Y+300),Z+"-open-dot"),H.noFill&&(y.symbolNoFill[Y]=!0)});var b=y.symbolNames.length;function x(Z,H){var Y=Z%100;return y.symbolFuncs[Y](H)+(Z>=200?"M0,0.5L0.5,0L0,-0.5L-0.5,0Z":"")}y.symbolNumber=function(Z){if(h(Z))Z=+Z;else if(typeof Z=="string"){var H=0;Z.indexOf("-open")>0&&(H=100,Z=Z.replace("-open","")),Z.indexOf("-dot")>0&&(H+=200,Z=Z.replace("-dot","")),(Z=y.symbolNames.indexOf(Z))>=0&&(Z+=H)}return Z%100>=b||Z>=400?0:Math.floor(Math.max(Z,0))};var T={x1:1,x2:0,y1:0,y2:0},A={x1:0,x2:0,y1:1,y2:0},S=m("~f"),w={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:T},horizontalreversed:{node:"linearGradient",attrs:T,reversed:!0},vertical:{node:"linearGradient",attrs:A},verticalreversed:{node:"linearGradient",attrs:A,reversed:!0}};y.gradient=function(Z,H,Y,$,z,j){for(var W=z.length,ee=w[$],J=new Array(W),Q=0;Q<W;Q++)ee.reversed?J[W-1-Q]=[S(100*(1-z[Q][0])),z[Q][1]]:J[Q]=[S(100*z[Q][0]),z[Q][1]];var te=H._fullLayout,ie="g"+te._uid+"-"+Y,ae=te._defs.select(".gradients").selectAll("#"+ie).data([$+J.join(";")],d.identity);ae.exit().remove(),ae.enter().append(ee.node).each(function(){var de=t.select(this);ee.attrs&&de.attr(ee.attrs),de.attr("id",ie);var ue=de.selectAll("stop").data(J);ue.exit().remove(),ue.enter().append("stop"),ue.each(function(ve){var ke=e(ve[1]);t.select(this).attr({offset:ve[0]+"%","stop-color":l.tinyRGB(ke),"stop-opacity":ke.getAlpha()})})}),Z.style(j,G(ie,H)).style(j+"-opacity",null);var he=function(de){return"."+de.attr("class").replace(/\s/g,".")},se=he(t.select(Z.node().parentNode))+">"+he(Z);te._gradientUrlQueryParts[se]=1},y.pattern=function(Z,H,Y,$,z,j,W,ee,J,Q,te,ie){var ae=H==="legend";ee&&(J==="overlay"?(Q=ee,te=l.contrast(Q)):(Q=void 0,te=ee));var he,se,de,ue,ve,ke,Ee,be,xe,ce,ge,we=Y._fullLayout,Me="p"+we._uid+"-"+$,Se={};switch(z){case"/":he=j*Math.sqrt(2),se=j*Math.sqrt(2),ke="path",Se={d:de="M-"+he/4+","+se/4+"l"+he/2+",-"+se/2+"M0,"+se+"L"+he+",0M"+he/4*3+","+se/4*5+"l"+he/2+",-"+se/2,opacity:ie,stroke:te,"stroke-width":(ue=W*j)+"px"};break;case"\\":he=j*Math.sqrt(2),se=j*Math.sqrt(2),ke="path",Se={d:de="M"+he/4*3+",-"+se/4+"l"+he/2+","+se/2+"M0,0L"+he+","+se+"M-"+he/4+","+se/4*3+"l"+he/2+","+se/2,opacity:ie,stroke:te,"stroke-width":(ue=W*j)+"px"};break;case"x":he=j*Math.sqrt(2),se=j*Math.sqrt(2),de="M-"+he/4+","+se/4+"l"+he/2+",-"+se/2+"M0,"+se+"L"+he+",0M"+he/4*3+","+se/4*5+"l"+he/2+",-"+se/2+"M"+he/4*3+",-"+se/4+"l"+he/2+","+se/2+"M0,0L"+he+","+se+"M-"+he/4+","+se/4*3+"l"+he/2+","+se/2,ue=j-j*Math.sqrt(1-W),ke="path",Se={d:de,opacity:ie,stroke:te,"stroke-width":ue+"px"};break;case"|":ke="path",ke="path",Se={d:de="M"+(he=j)/2+",0L"+he/2+","+(se=j),opacity:ie,stroke:te,"stroke-width":(ue=W*j)+"px"};break;case"-":ke="path",ke="path",Se={d:de="M0,"+(se=j)/2+"L"+(he=j)+","+se/2,opacity:ie,stroke:te,"stroke-width":(ue=W*j)+"px"};break;case"+":ke="path",de="M"+(he=j)/2+",0L"+he/2+","+(se=j)+"M0,"+se/2+"L"+he+","+se/2,ue=j-j*Math.sqrt(1-W),ke="path",Se={d:de,opacity:ie,stroke:te,"stroke-width":ue+"px"};break;case".":he=j,se=j,W<Math.PI/4?ve=Math.sqrt(W*j*j/Math.PI):(Ee=W,be=Math.PI/4,xe=1,ce=j/2,ge=j/Math.sqrt(2),ve=ce+(ge-ce)*(Ee-be)/(xe-be)),ke="circle",Se={cx:he/2,cy:se/2,r:ve,opacity:ie,fill:te}}var ze=[z||"noSh",Q||"noBg",te||"noFg",j,W].join(";"),Fe=we._defs.select(".patterns").selectAll("#"+Me).data([ze],d.identity);Fe.exit().remove(),Fe.enter().append("pattern").each(function(){var rt=t.select(this);if(rt.attr({id:Me,width:he+"px",height:se+"px",patternUnits:"userSpaceOnUse",patternTransform:ae?"scale(0.8)":""}),Q){var Oe=rt.selectAll("rect").data([0]);Oe.exit().remove(),Oe.enter().append("rect").attr({width:he+"px",height:se+"px",fill:Q})}var je=rt.selectAll(ke).data([0]);je.exit().remove(),je.enter().append(ke).attr(Se)}),Z.style("fill",G(Me,Y)).style("fill-opacity",null),Z.classed("pattern_filled",!0);var Ye="."+t.select(Z.node().parentNode).attr("class").replace(/\s/g,".")+">.pattern_filled";we._patternUrlQueryParts[Ye]=1},y.initGradients=function(Z){var H=Z._fullLayout;d.ensureSingle(H._defs,"g","gradients").selectAll("linearGradient,radialGradient").remove(),H._gradientUrlQueryParts={}},y.initPatterns=function(Z){var H=Z._fullLayout;d.ensureSingle(H._defs,"g","patterns").selectAll("pattern").remove(),H._patternUrlQueryParts={}},y.getPatternAttr=function(Z,H,Y){return Z&&d.isArrayOrTypedArray(Z)?H<Z.length?Z[H]:Y:Z},y.pointStyle=function(Z,H,Y){if(Z.size()){var $=y.makePointStyleFns(H);Z.each(function(z){y.singlePointStyle(z,t.select(this),H,$,Y)})}},y.singlePointStyle=function(Z,H,Y,$,z){var j=Y.marker,W=j.line;if(H.style("opacity",$.selectedOpacityFn?$.selectedOpacityFn(Z):Z.mo===void 0?j.opacity:Z.mo),$.ms2mrc){var ee;ee=Z.ms==="various"||j.size==="various"?3:$.ms2mrc(Z.ms),Z.mrc=ee,$.selectedSizeFn&&(ee=Z.mrc=$.selectedSizeFn(Z));var J=y.symbolNumber(Z.mx||j.symbol)||0;Z.om=J%200>=100,H.attr("d",x(J,ee))}var Q,te,ie,ae=!1;if(Z.so)ie=W.outlierwidth,te=W.outliercolor,Q=j.outliercolor;else{var he=(W||{}).width;ie=(Z.mlw+1||he+1||(Z.trace?(Z.trace.marker.line||{}).width:0)+1)-1||0,te="mlc"in Z?Z.mlcc=$.lineScale(Z.mlc):d.isArrayOrTypedArray(W.color)?l.defaultLine:W.color,d.isArrayOrTypedArray(j.color)&&(Q=l.defaultLine,ae=!0),Q="mc"in Z?Z.mcc=$.markerScale(Z.mc):j.color||"rgba(0,0,0,0)",$.selectedColorFn&&(Q=$.selectedColorFn(Z))}if(Z.om)H.call(l.stroke,Q).style({"stroke-width":(ie||1)+"px",fill:"none"});else{H.style("stroke-width",(Z.isBlank?0:ie)+"px");var se=j.gradient,de=Z.mgt;de?ae=!0:de=se&&se.type,d.isArrayOrTypedArray(de)&&(de=de[0],w[de]||(de=0));var ue=j.pattern,ve=ue&&y.getPatternAttr(ue.shape,Z.i,"");if(de&&de!=="none"){var ke=Z.mgc;ke?ae=!0:ke=se.color;var Ee=Y.uid;ae&&(Ee+="-"+Z.i),y.gradient(H,z,Ee,de,[[0,ke],[1,Q]],"fill")}else if(ve){var be=y.getPatternAttr(ue.bgcolor,Z.i,null),xe=y.getPatternAttr(ue.fgcolor,Z.i,null),ce=ue.fgopacity,ge=y.getPatternAttr(ue.size,Z.i,8),we=y.getPatternAttr(ue.solidity,Z.i,.3),Me=Z.mcc||d.isArrayOrTypedArray(ue.shape)||d.isArrayOrTypedArray(ue.bgcolor)||d.isArrayOrTypedArray(ue.size)||d.isArrayOrTypedArray(ue.solidity),Se=Y.uid;Me&&(Se+="-"+Z.i),y.pattern(H,"point",z,Se,ve,ge,we,Z.mcc,ue.fillmode,be,xe,ce)}else l.fill(H,Q);ie&&l.stroke(H,te)}},y.makePointStyleFns=function(Z){var H={},Y=Z.marker;return H.markerScale=y.tryColorscale(Y,""),H.lineScale=y.tryColorscale(Y,"line"),f.traceIs(Z,"symbols")&&(H.ms2mrc=a.isBubble(Z)?g(Z):function(){return(Y.size||6)/2}),Z.selectedpoints&&d.extendFlat(H,y.makeSelectedPointStyleFns(Z)),H},y.makeSelectedPointStyleFns=function(Z){var H={},Y=Z.selected||{},$=Z.unselected||{},z=Z.marker||{},j=Y.marker||{},W=$.marker||{},ee=z.opacity,J=j.opacity,Q=W.opacity,te=J!==void 0,ie=Q!==void 0;(d.isArrayOrTypedArray(ee)||te||ie)&&(H.selectedOpacityFn=function(be){var xe=be.mo===void 0?z.opacity:be.mo;return be.selected?te?J:xe:ie?Q:n*xe});var ae=z.color,he=j.color,se=W.color;(he||se)&&(H.selectedColorFn=function(be){var xe=be.mcc||ae;return be.selected?he||xe:se||xe});var de=z.size,ue=j.size,ve=W.size,ke=ue!==void 0,Ee=ve!==void 0;return f.traceIs(Z,"symbols")&&(ke||Ee)&&(H.selectedSizeFn=function(be){var xe=be.mrc||de/2;return be.selected?ke?ue/2:xe:Ee?ve/2:xe}),H},y.makeSelectedTextStyleFns=function(Z){var H={},Y=Z.selected||{},$=Z.unselected||{},z=Z.textfont||{},j=Y.textfont||{},W=$.textfont||{},ee=z.color,J=j.color,Q=W.color;return H.selectedTextColorFn=function(te){var ie=te.tc||ee;return te.selected?J||ie:Q||(J?ie:l.addOpacity(ie,n))},H},y.selectedPointStyle=function(Z,H){if(Z.size()&&H.selectedpoints){var Y=y.makeSelectedPointStyleFns(H),$=H.marker||{},z=[];Y.selectedOpacityFn&&z.push(function(j,W){j.style("opacity",Y.selectedOpacityFn(W))}),Y.selectedColorFn&&z.push(function(j,W){l.fill(j,Y.selectedColorFn(W))}),Y.selectedSizeFn&&z.push(function(j,W){var ee=W.mx||$.symbol||0,J=Y.selectedSizeFn(W);j.attr("d",x(y.symbolNumber(ee),J)),W.mrc2=J}),z.length&&Z.each(function(j){for(var W=t.select(this),ee=0;ee<z.length;ee++)z[ee](W,j)})}},y.tryColorscale=function(Z,H){var Y=H?d.nestedProperty(Z,H).get():Z;if(Y){var $=Y.color;if((Y.colorscale||Y._colorAx)&&d.isArrayOrTypedArray($))return o.makeColorScaleFuncFromTrace(Y)}return d.identity};var E={start:1,end:-1,middle:0,bottom:1,top:-1};function k(Z,H,Y,$){var z=t.select(Z.node().parentNode),j=H.indexOf("top")!==-1?"top":H.indexOf("bottom")!==-1?"bottom":"middle",W=H.indexOf("left")!==-1?"end":H.indexOf("right")!==-1?"start":"middle",ee=$?$/.8+1:0,J=(s.lineCount(Z)-1)*c+1,Q=E[W]*ee,te=.75*Y+E[j]*ee+(E[j]-1)*J*Y/2;Z.attr("text-anchor",W),z.attr("transform",u(Q,te))}function L(Z,H){var Y=Z.ts||H.textfont.size;return h(Y)&&Y>0?Y:0}y.textPointStyle=function(Z,H,Y){if(Z.size()){var $;if(H.selectedpoints){var z=y.makeSelectedTextStyleFns(H);$=z.selectedTextColorFn}var j=H.texttemplate,W=Y._fullLayout;Z.each(function(ee){var J=t.select(this),Q=j?d.extractOption(ee,H,"txt","texttemplate"):d.extractOption(ee,H,"tx","text");if(Q||Q===0){if(j){var te=H._module.formatLabels,ie=te?te(ee,H,W):{},ae={};p(ae,H,ee.i);var he=H._meta||{};Q=d.texttemplateString(Q,ie,W._d3locale,ae,ee,he)}var se=ee.tp||H.textposition,de=L(ee,H),ue=$?$(ee):ee.tc||H.textfont.color;J.call(y.font,ee.tf||H.textfont.family,de,ue).text(Q).call(s.convertToTspans,Y).call(k,se,de,ee.mrc)}else J.remove()})}},y.selectedTextStyle=function(Z,H){if(Z.size()&&H.selectedpoints){var Y=y.makeSelectedTextStyleFns(H);Z.each(function($){var z=t.select(this),j=Y.selectedTextColorFn($),W=$.tp||H.textposition,ee=L($,H);l.fill(z,j),k(z,W,ee,$.mrc2||$.mrc)})}};function M(Z,H,Y,$){var z=Z[0]-H[0],j=Z[1]-H[1],W=Y[0]-H[0],ee=Y[1]-H[1],J=Math.pow(z*z+j*j,.25),Q=Math.pow(W*W+ee*ee,.25),te=(Q*Q*z-J*J*W)*$,ie=(Q*Q*j-J*J*ee)*$,ae=3*Q*(J+Q),he=3*J*(J+Q);return[[t.round(H[0]+(ae&&te/ae),2),t.round(H[1]+(ae&&ie/ae),2)],[t.round(H[0]-(he&&te/he),2),t.round(H[1]-(he&&ie/he),2)]]}y.smoothopen=function(Z,H){if(Z.length<3)return"M"+Z.join("L");var Y,$="M"+Z[0],z=[];for(Y=1;Y<Z.length-1;Y++)z.push(M(Z[Y-1],Z[Y],Z[Y+1],H));for($+="Q"+z[0][0]+" "+Z[1],Y=2;Y<Z.length-1;Y++)$+="C"+z[Y-2][1]+" "+z[Y-1][0]+" "+Z[Y];return $+="Q"+z[Z.length-3][1]+" "+Z[Z.length-1]},y.smoothclosed=function(Z,H){if(Z.length<3)return"M"+Z.join("L")+"Z";var Y,$="M"+Z[0],z=Z.length-1,j=[M(Z[z],Z[0],Z[1],H)];for(Y=1;Y<z;Y++)j.push(M(Z[Y-1],Z[Y],Z[Y+1],H));for(j.push(M(Z[z-1],Z[z],Z[0],H)),Y=1;Y<=z;Y++)$+="C"+j[Y-1][1]+" "+j[Y][0]+" "+Z[Y];return $+="C"+j[z][1]+" "+j[0][0]+" "+Z[0]+"Z"};var P={hv:function(Z,H){return"H"+t.round(H[0],2)+"V"+t.round(H[1],2)},vh:function(Z,H){return"V"+t.round(H[1],2)+"H"+t.round(H[0],2)},hvh:function(Z,H){return"H"+t.round((Z[0]+H[0])/2,2)+"V"+t.round(H[1],2)+"H"+t.round(H[0],2)},vhv:function(Z,H){return"V"+t.round((Z[1]+H[1])/2,2)+"H"+t.round(H[0],2)+"V"+t.round(H[1],2)}},D=function(Z,H){return"L"+t.round(H[0],2)+","+t.round(H[1],2)};y.steps=function(Z){var H=P[Z]||D;return function(Y){for(var $="M"+t.round(Y[0][0],2)+","+t.round(Y[0][1],2),z=1;z<Y.length;z++)$+=H(Y[z-1],Y[z]);return $}},y.makeTester=function(){var Z=d.ensureSingleById(t.select("body"),"svg","js-plotly-tester",function(Y){Y.attr(i.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),H=d.ensureSingle(Z,"path","js-reference-point",function(Y){Y.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});y.tester=Z,y.testref=H},y.savedBBoxes={};var N=0;function U(Z){var H=Z.getAttribute("data-unformatted");if(H!==null)return H+Z.getAttribute("data-math")+Z.getAttribute("text-anchor")+Z.getAttribute("style")}function G(Z,H){if(!Z)return null;var Y=H._context,$=Y._exportedPlot?"":Y._baseUrl||"";return $?"url('"+$+"#"+Z+"')":"url(#"+Z+")"}y.bBox=function(Z,H,Y){var $,z,j;if(Y||(Y=U(Z)),Y){if($=y.savedBBoxes[Y])return d.extendFlat({},$)}else if(Z.childNodes.length===1){var W=Z.childNodes[0];if(Y=U(W)){var ee=+W.getAttribute("x")||0,J=+W.getAttribute("y")||0,Q=W.getAttribute("transform");if(!Q){var te=y.bBox(W,!1,Y);return ee&&(te.left+=ee,te.right+=ee),J&&(te.top+=J,te.bottom+=J),te}if(Y+="~"+ee+"~"+J+"~"+Q,$=y.savedBBoxes[Y])return d.extendFlat({},$)}}H?z=Z:(j=y.tester.node(),z=Z.cloneNode(!0),j.appendChild(z)),t.select(z).attr("transform",null).call(s.positionText,0,0);var ie=z.getBoundingClientRect(),ae=y.testref.node().getBoundingClientRect();H||j.removeChild(z);var he={height:ie.height,width:ie.width,left:ie.left-ae.left,top:ie.top-ae.top,right:ie.right-ae.left,bottom:ie.bottom-ae.top};return N>=1e4&&(y.savedBBoxes={},N=0),Y&&(y.savedBBoxes[Y]=he),N++,d.extendFlat({},he)},y.setClipUrl=function(Z,H,Y){Z.attr("clip-path",G(H,Y))},y.getTranslate=function(Z){var H=(Z[Z.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,function(Y,$,z){return[$,z].join(" ")}).split(" ");return{x:+H[0]||0,y:+H[1]||0}},y.setTranslate=function(Z,H,Y){var $=Z.attr?"attr":"getAttribute",z=Z.attr?"attr":"setAttribute",j=Z[$]("transform")||"";return H=H||0,Y=Y||0,j=j.replace(/(\btranslate\(.*?\);?)/,"").trim(),j=(j+=u(H,Y)).trim(),Z[z]("transform",j),j},y.getScale=function(Z){var H=(Z[Z.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(Y,$,z){return[$,z].join(" ")}).split(" ");return{x:+H[0]||1,y:+H[1]||1}},y.setScale=function(Z,H,Y){var $=Z.attr?"attr":"getAttribute",z=Z.attr?"attr":"setAttribute",j=Z[$]("transform")||"";return H=H||1,Y=Y||1,j=j.replace(/(\bscale\(.*?\);?)/,"").trim(),j=(j+="scale("+H+","+Y+")").trim(),Z[z]("transform",j),j};var X=/\s*sc.*/;y.setPointGroupScale=function(Z,H,Y){if(H=H||1,Y=Y||1,Z){var $=H===1&&Y===1?"":"scale("+H+","+Y+")";Z.each(function(){var z=(this.getAttribute("transform")||"").replace(X,"");z=(z+=$).trim(),this.setAttribute("transform",z)})}};var K=/translate\([^)]*\)\s*$/;y.setTextPointsScale=function(Z,H,Y){Z&&Z.each(function(){var $,z=t.select(this),j=z.select("text");if(j.node()){var W=parseFloat(j.attr("x")||0),ee=parseFloat(j.attr("y")||0),J=(z.attr("transform")||"").match(K);$=H===1&&Y===1?[]:[u(W,ee),"scale("+H+","+Y+")",u(-W,-ee)],J&&$.push(J),z.attr("transform",$.join(""))}})}},{"../../components/fx/helpers":686,"../../constants/alignment":755,"../../constants/interactions":762,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../lib/svg_text_utils":813,"../../registry":915,"../../traces/scatter/make_bubble_size_func":1219,"../../traces/scatter/subtypes":1227,"../color":650,"../colorscale":662,"./symbol_defs":673,"@plotly/d3":58,"fast-isnumeric":246,tinycolor2:583}],673:[function(r,I,B){var t=r("@plotly/d3");I.exports={circle:{n:0,f:function(d){var m=t.round(d,2);return"M"+m+",0A"+m+","+m+" 0 1,1 0,-"+m+"A"+m+","+m+" 0 0,1 "+m+",0Z"}},square:{n:1,f:function(d){var m=t.round(d,2);return"M"+m+","+m+"H-"+m+"V-"+m+"H"+m+"Z"}},diamond:{n:2,f:function(d){var m=t.round(1.3*d,2);return"M"+m+",0L0,"+m+"L-"+m+",0L0,-"+m+"Z"}},cross:{n:3,f:function(d){var m=t.round(.4*d,2),h=t.round(1.2*d,2);return"M"+h+","+m+"H"+m+"V"+h+"H-"+m+"V"+m+"H-"+h+"V-"+m+"H-"+m+"V-"+h+"H"+m+"V-"+m+"H"+h+"Z"}},x:{n:4,f:function(d){var m=t.round(.8*d/Math.sqrt(2),2),h="l"+m+","+m,e="l"+m+",-"+m,f="l-"+m+",-"+m,l="l-"+m+","+m;return"M0,"+m+h+e+f+e+f+l+f+l+h+l+h+"Z"}},"triangle-up":{n:5,f:function(d){var m=t.round(2*d/Math.sqrt(3),2);return"M-"+m+","+t.round(d/2,2)+"H"+m+"L0,-"+t.round(d,2)+"Z"}},"triangle-down":{n:6,f:function(d){var m=t.round(2*d/Math.sqrt(3),2);return"M-"+m+",-"+t.round(d/2,2)+"H"+m+"L0,"+t.round(d,2)+"Z"}},"triangle-left":{n:7,f:function(d){var m=t.round(2*d/Math.sqrt(3),2);return"M"+t.round(d/2,2)+",-"+m+"V"+m+"L-"+t.round(d,2)+",0Z"}},"triangle-right":{n:8,f:function(d){var m=t.round(2*d/Math.sqrt(3),2);return"M-"+t.round(d/2,2)+",-"+m+"V"+m+"L"+t.round(d,2)+",0Z"}},"triangle-ne":{n:9,f:function(d){var m=t.round(.6*d,2),h=t.round(1.2*d,2);return"M-"+h+",-"+m+"H"+m+"V"+h+"Z"}},"triangle-se":{n:10,f:function(d){var m=t.round(.6*d,2),h=t.round(1.2*d,2);return"M"+m+",-"+h+"V"+m+"H-"+h+"Z"}},"triangle-sw":{n:11,f:function(d){var m=t.round(.6*d,2),h=t.round(1.2*d,2);return"M"+h+","+m+"H-"+m+"V-"+h+"Z"}},"triangle-nw":{n:12,f:function(d){var m=t.round(.6*d,2),h=t.round(1.2*d,2);return"M-"+m+","+h+"V-"+m+"H"+h+"Z"}},pentagon:{n:13,f:function(d){var m=t.round(.951*d,2),h=t.round(.588*d,2),e=t.round(-d,2),f=t.round(-.309*d,2);return"M"+m+","+f+"L"+h+","+t.round(.809*d,2)+"H-"+h+"L-"+m+","+f+"L0,"+e+"Z"}},hexagon:{n:14,f:function(d){var m=t.round(d,2),h=t.round(d/2,2),e=t.round(d*Math.sqrt(3)/2,2);return"M"+e+",-"+h+"V"+h+"L0,"+m+"L-"+e+","+h+"V-"+h+"L0,-"+m+"Z"}},hexagon2:{n:15,f:function(d){var m=t.round(d,2),h=t.round(d/2,2),e=t.round(d*Math.sqrt(3)/2,2);return"M-"+h+","+e+"H"+h+"L"+m+",0L"+h+",-"+e+"H-"+h+"L-"+m+",0Z"}},octagon:{n:16,f:function(d){var m=t.round(.924*d,2),h=t.round(.383*d,2);return"M-"+h+",-"+m+"H"+h+"L"+m+",-"+h+"V"+h+"L"+h+","+m+"H-"+h+"L-"+m+","+h+"V-"+h+"Z"}},star:{n:17,f:function(d){var m=1.4*d,h=t.round(.225*m,2),e=t.round(.951*m,2),f=t.round(.363*m,2),l=t.round(.588*m,2),o=t.round(-m,2),u=t.round(-.309*m,2),s=t.round(.118*m,2),i=t.round(.809*m,2);return"M"+h+","+u+"H"+e+"L"+f+","+s+"L"+l+","+i+"L0,"+t.round(.382*m,2)+"L-"+l+","+i+"L-"+f+","+s+"L-"+e+","+u+"H-"+h+"L0,"+o+"Z"}},hexagram:{n:18,f:function(d){var m=t.round(.66*d,2),h=t.round(.38*d,2),e=t.round(.76*d,2);return"M-"+e+",0l-"+h+",-"+m+"h"+e+"l"+h+",-"+m+"l"+h+","+m+"h"+e+"l-"+h+","+m+"l"+h+","+m+"h-"+e+"l-"+h+","+m+"l-"+h+",-"+m+"h-"+e+"Z"}},"star-triangle-up":{n:19,f:function(d){var m=t.round(d*Math.sqrt(3)*.8,2),h=t.round(.8*d,2),e=t.round(1.6*d,2),f=t.round(4*d,2),l="A "+f+","+f+" 0 0 1 ";return"M-"+m+","+h+l+m+","+h+l+"0,-"+e+l+"-"+m+","+h+"Z"}},"star-triangle-down":{n:20,f:function(d){var m=t.round(d*Math.sqrt(3)*.8,2),h=t.round(.8*d,2),e=t.round(1.6*d,2),f=t.round(4*d,2),l="A "+f+","+f+" 0 0 1 ";return"M"+m+",-"+h+l+"-"+m+",-"+h+l+"0,"+e+l+m+",-"+h+"Z"}},"star-square":{n:21,f:function(d){var m=t.round(1.1*d,2),h=t.round(2*d,2),e="A "+h+","+h+" 0 0 1 ";return"M-"+m+",-"+m+e+"-"+m+","+m+e+m+","+m+e+m+",-"+m+e+"-"+m+",-"+m+"Z"}},"star-diamond":{n:22,f:function(d){var m=t.round(1.4*d,2),h=t.round(1.9*d,2),e="A "+h+","+h+" 0 0 1 ";return"M-"+m+",0"+e+"0,"+m+e+m+",0"+e+"0,-"+m+e+"-"+m+",0Z"}},"diamond-tall":{n:23,f:function(d){var m=t.round(.7*d,2),h=t.round(1.4*d,2);return"M0,"+h+"L"+m+",0L0,-"+h+"L-"+m+",0Z"}},"diamond-wide":{n:24,f:function(d){var m=t.round(1.4*d,2),h=t.round(.7*d,2);return"M0,"+h+"L"+m+",0L0,-"+h+"L-"+m+",0Z"}},hourglass:{n:25,f:function(d){var m=t.round(d,2);return"M"+m+","+m+"H-"+m+"L"+m+",-"+m+"H-"+m+"Z"},noDot:!0},bowtie:{n:26,f:function(d){var m=t.round(d,2);return"M"+m+","+m+"V-"+m+"L-"+m+","+m+"V-"+m+"Z"},noDot:!0},"circle-cross":{n:27,f:function(d){var m=t.round(d,2);return"M0,"+m+"V-"+m+"M"+m+",0H-"+m+"M"+m+",0A"+m+","+m+" 0 1,1 0,-"+m+"A"+m+","+m+" 0 0,1 "+m+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(d){var m=t.round(d,2),h=t.round(d/Math.sqrt(2),2);return"M"+h+","+h+"L-"+h+",-"+h+"M"+h+",-"+h+"L-"+h+","+h+"M"+m+",0A"+m+","+m+" 0 1,1 0,-"+m+"A"+m+","+m+" 0 0,1 "+m+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(d){var m=t.round(d,2);return"M0,"+m+"V-"+m+"M"+m+",0H-"+m+"M"+m+","+m+"H-"+m+"V-"+m+"H"+m+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(d){var m=t.round(d,2);return"M"+m+","+m+"L-"+m+",-"+m+"M"+m+",-"+m+"L-"+m+","+m+"M"+m+","+m+"H-"+m+"V-"+m+"H"+m+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(d){var m=t.round(1.3*d,2);return"M"+m+",0L0,"+m+"L-"+m+",0L0,-"+m+"ZM0,-"+m+"V"+m+"M-"+m+",0H"+m},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(d){var m=t.round(1.3*d,2),h=t.round(.65*d,2);return"M"+m+",0L0,"+m+"L-"+m+",0L0,-"+m+"ZM-"+h+",-"+h+"L"+h+","+h+"M-"+h+","+h+"L"+h+",-"+h},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(d){var m=t.round(1.4*d,2);return"M0,"+m+"V-"+m+"M"+m+",0H-"+m},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(d){var m=t.round(d,2);return"M"+m+","+m+"L-"+m+",-"+m+"M"+m+",-"+m+"L-"+m+","+m},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(d){var m=t.round(1.2*d,2),h=t.round(.85*d,2);return"M0,"+m+"V-"+m+"M"+m+",0H-"+m+"M"+h+","+h+"L-"+h+",-"+h+"M"+h+",-"+h+"L-"+h+","+h},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(d){var m=t.round(d/2,2),h=t.round(d,2);return"M"+m+","+h+"V-"+h+"m-"+h+",0V"+h+"M"+h+","+m+"H-"+h+"m0,-"+h+"H"+h},needLine:!0,noFill:!0},"y-up":{n:37,f:function(d){var m=t.round(1.2*d,2),h=t.round(1.6*d,2),e=t.round(.8*d,2);return"M-"+m+","+e+"L0,0M"+m+","+e+"L0,0M0,-"+h+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(d){var m=t.round(1.2*d,2),h=t.round(1.6*d,2),e=t.round(.8*d,2);return"M-"+m+",-"+e+"L0,0M"+m+",-"+e+"L0,0M0,"+h+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(d){var m=t.round(1.2*d,2),h=t.round(1.6*d,2),e=t.round(.8*d,2);return"M"+e+","+m+"L0,0M"+e+",-"+m+"L0,0M-"+h+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(d){var m=t.round(1.2*d,2),h=t.round(1.6*d,2),e=t.round(.8*d,2);return"M-"+e+","+m+"L0,0M-"+e+",-"+m+"L0,0M"+h+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(d){var m=t.round(1.4*d,2);return"M"+m+",0H-"+m},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(d){var m=t.round(1.4*d,2);return"M0,"+m+"V-"+m},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(d){var m=t.round(d,2);return"M"+m+",-"+m+"L-"+m+","+m},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(d){var m=t.round(d,2);return"M"+m+","+m+"L-"+m+",-"+m},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(d){var m=t.round(d,2);return"M0,0L-"+m+","+t.round(2*d,2)+"H"+m+"Z"},noDot:!0},"arrow-down":{n:46,f:function(d){var m=t.round(d,2);return"M0,0L-"+m+",-"+t.round(2*d,2)+"H"+m+"Z"},noDot:!0},"arrow-left":{n:47,f:function(d){var m=t.round(2*d,2),h=t.round(d,2);return"M0,0L"+m+",-"+h+"V"+h+"Z"},noDot:!0},"arrow-right":{n:48,f:function(d){var m=t.round(2*d,2),h=t.round(d,2);return"M0,0L-"+m+",-"+h+"V"+h+"Z"},noDot:!0},"arrow-bar-up":{n:49,f:function(d){var m=t.round(d,2);return"M-"+m+",0H"+m+"M0,0L-"+m+","+t.round(2*d,2)+"H"+m+"Z"},needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(d){var m=t.round(d,2);return"M-"+m+",0H"+m+"M0,0L-"+m+",-"+t.round(2*d,2)+"H"+m+"Z"},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(d){var m=t.round(2*d,2),h=t.round(d,2);return"M0,-"+h+"V"+h+"M0,0L"+m+",-"+h+"V"+h+"Z"},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(d){var m=t.round(2*d,2),h=t.round(d,2);return"M0,-"+h+"V"+h+"M0,0L-"+m+",-"+h+"V"+h+"Z"},needLine:!0,noDot:!0}}},{"@plotly/d3":58}],674:[function(r,I,B){I.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],675:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../registry"),m=r("../../plots/cartesian/axes"),h=r("../../lib"),e=r("./compute_error");function f(l,o,u,s){var i=o["error_"+s]||{},c=[];if(i.visible&&["linear","log"].indexOf(u.type)!==-1){for(var n=e(i),a=0;a<l.length;a++){var g=l[a],p=g.i;if(p===void 0)p=a;else if(p===null)continue;var y=g[s];if(t(u.c2l(y))){var v=n(y,p);if(t(v[0])&&t(v[1])){var b=g[s+"s"]=y-v[0],x=g[s+"h"]=y+v[1];c.push(b,x)}}}var T=u._id,A=o._extremes[T],S=m.findExtremes(u,c,h.extendFlat({tozero:A.opts.tozero},{padded:!0}));A.min=A.min.concat(S.min),A.max=A.max.concat(S.max)}}I.exports=function(l){for(var o=l.calcdata,u=0;u<o.length;u++){var s=o[u],i=s[0].trace;if(i.visible===!0&&d.traceIs(i,"errorBarsOK")){var c=m.getFromId(l,i.xaxis),n=m.getFromId(l,i.yaxis);f(s,i,c,"x"),f(s,i,n,"y")}}}},{"../../lib":787,"../../plots/cartesian/axes":838,"../../registry":915,"./compute_error":676,"fast-isnumeric":246}],676:[function(r,I,B){function t(d,m){return d==="percent"?function(h){return Math.abs(h*m/100)}:d==="constant"?function(){return Math.abs(m)}:d==="sqrt"?function(h){return Math.sqrt(Math.abs(h))}:void 0}I.exports=function(d){var m=d.type,h=d.symmetric;if(m==="data"){var e=d.array||[];if(h)return function(u,s){var i=+e[s];return[i,i]};var f=d.arrayminus||[];return function(u,s){var i=+e[s],c=+f[s];return isNaN(i)&&isNaN(c)?[NaN,NaN]:[c||0,i||0]}}var l=t(m,d.value),o=t(m,d.valueminus);return h||d.valueminus===void 0?function(u){var s=l(u);return[s,s]}:function(u){return[o(u),l(u)]}}},{}],677:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../registry"),m=r("../../lib"),h=r("../../plot_api/plot_template"),e=r("./attributes");I.exports=function(f,l,o,u){var s="error_"+u.axis,i=h.newContainer(l,s),c=f[s]||{};function n(y,v){return m.coerce(c,i,e,y,v)}if(n("visible",c.array!==void 0||c.value!==void 0||c.type==="sqrt")!==!1){var a=n("type","array"in c?"data":"percent"),g=!0;a!=="sqrt"&&(g=n("symmetric",!((a==="data"?"arrayminus":"valueminus")in c))),a==="data"?(n("array"),n("traceref"),g||(n("arrayminus"),n("tracerefminus"))):a!=="percent"&&a!=="constant"||(n("value"),g||n("valueminus"));var p="copy_"+u.inherit+"style";u.inherit&&(l["error_"+u.inherit]||{}).visible&&n(p,!(c.color||t(c.thickness)||t(c.width))),u.inherit&&i[p]||(n("color",o),n("thickness"),n("width",d.traceIs(l,"gl3d")?0:4))}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../registry":915,"./attributes":674,"fast-isnumeric":246}],678:[function(r,I,B){var t=r("../../lib"),d=r("../../plot_api/edit_types").overrideAll,m=r("./attributes"),h={error_x:t.extendFlat({},m),error_y:t.extendFlat({},m)};delete h.error_x.copy_zstyle,delete h.error_y.copy_zstyle,delete h.error_y.copy_ystyle;var e={error_x:t.extendFlat({},m),error_y:t.extendFlat({},m),error_z:t.extendFlat({},m)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,I.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:h,bar:h,histogram:h,scatter3d:d(e,"calc","nested"),scattergl:d(h,"calc","nested")}},supplyDefaults:r("./defaults"),calc:r("./calc"),makeComputeError:r("./compute_error"),plot:r("./plot"),style:r("./style"),hoverInfo:function(f,l,o){(l.error_y||{}).visible&&(o.yerr=f.yh-f.y,l.error_y.symmetric||(o.yerrneg=f.y-f.ys)),(l.error_x||{}).visible&&(o.xerr=f.xh-f.x,l.error_x.symmetric||(o.xerrneg=f.x-f.xs))}}},{"../../lib":787,"../../plot_api/edit_types":820,"./attributes":674,"./calc":675,"./compute_error":676,"./defaults":677,"./plot":679,"./style":680}],679:[function(r,I,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("../drawing"),h=r("../../traces/scatter/subtypes");I.exports=function(e,f,l,o){var u=l.xaxis,s=l.yaxis,i=o&&o.duration>0;f.each(function(c){var n,a=c[0].trace,g=a.error_x||{},p=a.error_y||{};a.ids&&(n=function(x){return x.id});var y=h.hasMarkers(a)&&a.marker.maxdisplayed>0;p.visible||g.visible||(c=[]);var v=t.select(this).selectAll("g.errorbar").data(c,n);if(v.exit().remove(),c.length){g.visible||v.selectAll("path.xerror").remove(),p.visible||v.selectAll("path.yerror").remove(),v.style("opacity",1);var b=v.enter().append("g").classed("errorbar",!0);i&&b.style("opacity",0).transition().duration(o.duration).style("opacity",1),m.setClipUrl(v,l.layerClipId,e),v.each(function(x){var T=t.select(this),A=function(M,P,D){var N={x:P.c2p(M.x),y:D.c2p(M.y)};return M.yh!==void 0&&(N.yh=D.c2p(M.yh),N.ys=D.c2p(M.ys),d(N.ys)||(N.noYS=!0,N.ys=D.c2p(M.ys,!0))),M.xh!==void 0&&(N.xh=P.c2p(M.xh),N.xs=P.c2p(M.xs),d(N.xs)||(N.noXS=!0,N.xs=P.c2p(M.xs,!0))),N}(x,u,s);if(!y||x.vis){var S,w=T.select("path.yerror");if(p.visible&&d(A.x)&&d(A.yh)&&d(A.ys)){var E=p.width;S="M"+(A.x-E)+","+A.yh+"h"+2*E+"m-"+E+",0V"+A.ys,A.noYS||(S+="m-"+E+",0h"+2*E),w.size()?i&&(w=w.transition().duration(o.duration).ease(o.easing)):w=T.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0),w.attr("d",S)}else w.remove();var k=T.select("path.xerror");if(g.visible&&d(A.y)&&d(A.xh)&&d(A.xs)){var L=(g.copy_ystyle?p:g).width;S="M"+A.xh+","+(A.y-L)+"v"+2*L+"m0,-"+L+"H"+A.xs,A.noXS||(S+="m0,-"+L+"v"+2*L),k.size()?i&&(k=k.transition().duration(o.duration).ease(o.easing)):k=T.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0),k.attr("d",S)}else k.remove()}})}})}},{"../../traces/scatter/subtypes":1227,"../drawing":672,"@plotly/d3":58,"fast-isnumeric":246}],680:[function(r,I,B){var t=r("@plotly/d3"),d=r("../color");I.exports=function(m){m.each(function(h){var e=h[0].trace,f=e.error_y||{},l=e.error_x||{},o=t.select(this);o.selectAll("path.yerror").style("stroke-width",f.thickness+"px").call(d.stroke,f.color),l.copy_ystyle&&(l=f),o.selectAll("path.xerror").style("stroke-width",l.thickness+"px").call(d.stroke,l.color)})}},{"../color":650,"@plotly/d3":58}],681:[function(r,I,B){var t=r("../../plots/font_attributes"),d=r("./layout_attributes").hoverlabel,m=r("../../lib/extend").extendFlat;I.exports={hoverlabel:{bgcolor:m({},d.bgcolor,{arrayOk:!0}),bordercolor:m({},d.bordercolor,{arrayOk:!0}),font:t({arrayOk:!0,editType:"none"}),align:m({},d.align,{arrayOk:!0}),namelength:m({},d.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":777,"../../plots/font_attributes":867,"./layout_attributes":691}],682:[function(r,I,B){var t=r("../../lib"),d=r("../../registry");function m(h,e,f,l){l=l||t.identity,Array.isArray(h)&&(e[0][f]=l(h))}I.exports=function(h){var e=h.calcdata,f=h._fullLayout;function l(c){return function(n){return t.coerceHoverinfo({hoverinfo:n},{_module:c._module},f)}}for(var o=0;o<e.length;o++){var u=e[o],s=u[0].trace;if(!d.traceIs(s,"pie-like")){var i=d.traceIs(s,"2dMap")?m:t.fillArray;i(s.hoverinfo,u,"hi",l(s)),s.hovertemplate&&i(s.hovertemplate,u,"ht"),s.hoverlabel&&(i(s.hoverlabel.bgcolor,u,"hbg"),i(s.hoverlabel.bordercolor,u,"hbc"),i(s.hoverlabel.font.size,u,"hts"),i(s.hoverlabel.font.color,u,"htc"),i(s.hoverlabel.font.family,u,"htf"),i(s.hoverlabel.namelength,u,"hnl"),i(s.hoverlabel.align,u,"hta"))}}}},{"../../lib":787,"../../registry":915}],683:[function(r,I,B){var t=r("../../registry"),d=r("./hover").hover;I.exports=function(m,h,e){var f=t.getComponentMethod("annotations","onClick")(m,m._hoverdata);function l(){m.emit("plotly_click",{points:m._hoverdata,event:h})}e!==void 0&&d(m,h,e,!0),m._hoverdata&&h&&h.target&&(f&&f.then?f.then(l):l(),h.stopImmediatePropagation&&h.stopImmediatePropagation())}},{"../../registry":915,"./hover":687}],684:[function(r,I,B){I.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],685:[function(r,I,B){var t=r("../../lib"),d=r("./attributes"),m=r("./hoverlabel_defaults");I.exports=function(h,e,f,l){var o=t.extendFlat({},l.hoverlabel);e.hovertemplate&&(o.namelength=-1),m(h,e,function(u,s){return t.coerce(h,e,d,u,s)},o)}},{"../../lib":787,"./attributes":681,"./hoverlabel_defaults":688}],686:[function(r,I,B){var t=r("../../lib");B.getSubplot=function(l){return l.subplot||l.xaxis+l.yaxis||l.geo},B.isTraceInSubplots=function(l,o){if(l.type==="splom"){for(var u=l.xaxes||[],s=l.yaxes||[],i=0;i<u.length;i++)for(var c=0;c<s.length;c++)if(o.indexOf(u[i]+s[c])!==-1)return!0;return!1}return o.indexOf(B.getSubplot(l))!==-1},B.flat=function(l,o){for(var u=new Array(l.length),s=0;s<l.length;s++)u[s]=o;return u},B.p2c=function(l,o){for(var u=new Array(l.length),s=0;s<l.length;s++)u[s]=l[s].p2c(o);return u},B.getDistanceFunction=function(l,o,u,s){return l==="closest"?s||B.quadrature(o,u):l.charAt(0)==="x"?o:u},B.getClosest=function(l,o,u){if(u.index!==!1)u.index>=0&&u.index<l.length?u.distance=0:u.index=!1;else for(var s=0;s<l.length;s++){var i=o(l[s]);i<=u.distance&&(u.index=s,u.distance=i)}return u},B.inbox=function(l,o,u){return l*o<0||l===0?u:1/0},B.quadrature=function(l,o){return function(u){var s=l(u),i=o(u);return Math.sqrt(s*s+i*i)}},B.makeEventData=function(l,o,u){var s="index"in l?l.index:l.pointNumber,i={data:o._input,fullData:o,curveNumber:o.index,pointNumber:s};if(o._indexToPoints){var c=o._indexToPoints[s];c.length===1?i.pointIndex=c[0]:i.pointIndices=c}else i.pointIndex=s;return o._module.eventData?i=o._module.eventData(i,l,o,u,s):("xVal"in l?i.x=l.xVal:"x"in l&&(i.x=l.x),"yVal"in l?i.y=l.yVal:"y"in l&&(i.y=l.y),l.xa&&(i.xaxis=l.xa),l.ya&&(i.yaxis=l.ya),l.zLabelVal!==void 0&&(i.z=l.zLabelVal)),B.appendArrayPointValue(i,o,s),i},B.appendArrayPointValue=function(l,o,u){var s=o._arrayAttrs;if(s)for(var i=0;i<s.length;i++){var c=s[i],n=m(c);if(l[n]===void 0){var a=h(t.nestedProperty(o,c).get(),u);a!==void 0&&(l[n]=a)}}},B.appendArrayMultiPointValues=function(l,o,u){var s=o._arrayAttrs;if(s)for(var i=0;i<s.length;i++){var c=s[i],n=m(c);if(l[n]===void 0){for(var a=t.nestedProperty(o,c).get(),g=new Array(u.length),p=0;p<u.length;p++)g[p]=h(a,u[p]);l[n]=g}}};var d={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function m(l){return d[l]||l}function h(l,o){return Array.isArray(o)?Array.isArray(l)&&Array.isArray(l[o[0]])?l[o[0]][o[1]]:void 0:l[o]}var e={x:!0,y:!0},f={"x unified":!0,"y unified":!0};B.isUnifiedHover=function(l){return typeof l=="string"&&!!f[l]},B.isXYhover=function(l){return typeof l=="string"&&!!e[l]}},{"../../lib":787}],687:[function(r,I,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("tinycolor2"),h=r("../../lib"),e=h.strTranslate,f=h.strRotate,l=r("../../lib/events"),o=r("../../lib/svg_text_utils"),u=r("../../lib/override_cursor"),s=r("../drawing"),i=r("../color"),c=r("../dragelement"),n=r("../../plots/cartesian/axes"),a=r("../../registry"),g=r("./helpers"),p=r("./constants"),y=r("../legend/defaults"),v=r("../legend/draw"),b=p.YANGLE,x=Math.PI*b/180,T=1/Math.sin(x),A=Math.cos(x),S=Math.sin(x),w=p.HOVERARROWSIZE,E=p.HOVERTEXTPAD,k={box:!0,ohlc:!0,violin:!0,candlestick:!0},L={scatter:!0,scattergl:!0,splom:!0};function M(j){return[j.trace.index,j.index,j.x0,j.y0,j.name,j.attr,j.xa?j.xa._id:"",j.ya?j.ya._id:""].join(",")}B.hover=function(j,W,ee,J){j=h.getGraphDiv(j),h.throttle(j._fullLayout._uid+p.HOVERID,p.HOVERMINTIME,function(){(function(Q,te,ie,ae){ie||(ie="xy");var he=Array.isArray(ie)?ie:[ie],se=Q._fullLayout,de=se._plots||[],ue=de[ie],ve=se._has("cartesian");if(ue){var ke=ue.overlays.map(function(tn){return tn.id});he=he.concat(ke)}for(var Ee=he.length,be=new Array(Ee),xe=new Array(Ee),ce=!1,ge=0;ge<Ee;ge++){var we=he[ge];if(de[we])ce=!0,be[ge]=de[we].xaxis,xe[ge]=de[we].yaxis;else{if(!se[we]||!se[we]._subplot)return void h.warn("Unrecognized subplot: "+we);var Me=se[we]._subplot;be[ge]=Me.xaxis,xe[ge]=Me.yaxis}}var Se=te.hovermode||se.hovermode;if(Se&&!ce&&(Se="closest"),["x","y","closest","x unified","y unified"].indexOf(Se)===-1||!Q.calcdata||Q.querySelector(".zoombox")||Q._dragging)return c.unhoverRaw(Q,te);var ze=se.hoverdistance;ze===-1&&(ze=1/0);var Fe=se.spikedistance;Fe===-1&&(Fe=1/0);var Ye,rt,Oe,je,We,qe,et,st,ct,Pt,kt,at,tt,_t=[],er=[],tr={hLinePoint:null,vLinePoint:null},Ue=!1;if(Array.isArray(te))for(Se="array",Oe=0;Oe<te.length;Oe++)(We=Q.calcdata[te[Oe].curveNumber||0])&&(qe=We[0].trace,We[0].trace.hoverinfo!=="skip"&&(er.push(We),qe.orientation==="h"&&(Ue=!0)));else{for(je=0;je<Q.calcdata.length;je++)We=Q.calcdata[je],(qe=We[0].trace).hoverinfo!=="skip"&&g.isTraceInSubplots(qe,he)&&(er.push(We),qe.orientation==="h"&&(Ue=!0));var He,Be;if(!te.target)He="xpx"in te?te.xpx:be[0]._length/2,Be="ypx"in te?te.ypx:xe[0]._length/2;else{if(l.triggerHandler(Q,"plotly_beforehover",te)===!1)return;var Ke=te.composedPath&&te.composedPath()[0];Ke||(Ke=te.target);var _e=Ke.getBoundingClientRect();He=te.clientX-_e.left,Be=te.clientY-_e.top,se._calcInverseTransform(Q);var Ce=h.apply3DTransform(se._invTransform)(He,Be);if(He=Ce[0],Be=Ce[1],He<0||He>be[0]._length||Be<0||Be>xe[0]._length)return c.unhoverRaw(Q,te)}if(te.pointerX=He+be[0]._offset,te.pointerY=Be+xe[0]._offset,Ye="xval"in te?g.flat(he,te.xval):g.p2c(be,He),rt="yval"in te?g.flat(he,te.yval):g.p2c(xe,Be),!d(Ye[0])||!d(rt[0]))return h.warn("Fx.hover failed",te,Q),c.unhoverRaw(Q,te)}var Le=1/0;function Pe(tn,Qr){for(je=0;je<er.length;je++)if((We=er[je])&&We[0]&&We[0].trace&&(qe=We[0].trace).visible===!0&&qe._length!==0&&["carpet","contourcarpet"].indexOf(qe._module.name)===-1){if(qe.type==="splom"?et=he[st=0]:(et=g.getSubplot(qe),st=he.indexOf(et)),ct=Se,g.isUnifiedHover(ct)&&(ct=ct.charAt(0)),at={cd:We,trace:qe,xa:be[st],ya:xe[st],maxHoverDistance:ze,maxSpikeDistance:Fe,index:!1,distance:Math.min(Le,ze),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:i.defaultLine,name:qe.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},se[et]&&(at.subplot=se[et]._subplot),se._splomScenes&&se._splomScenes[qe.uid]&&(at.scene=se._splomScenes[qe.uid]),tt=_t.length,ct==="array"){var rn=te[je];"pointNumber"in rn?(at.index=rn.pointNumber,ct="closest"):(ct="","xval"in rn&&(Pt=rn.xval,ct="x"),"yval"in rn&&(kt=rn.yval,ct=ct?"closest":"y"))}else tn!==void 0&&Qr!==void 0?(Pt=tn,kt=Qr):(Pt=Ye[st],kt=rt[st]);if(ze!==0)if(qe._module&&qe._module.hoverPoints){var An=qe._module.hoverPoints(at,Pt,kt,ct,{finiteRange:!0,hoverLayer:se._hoverlayer});if(An)for(var En,Bn=0;Bn<An.length;Bn++)En=An[Bn],d(En.x0)&&d(En.y0)&&_t.push(G(En,Se))}else h.log("Unrecognized trace type in hover:",qe);if(Se==="closest"&&_t.length>tt&&(_t.splice(0,tt),Le=_t[0].distance),ve&&Fe!==0&&_t.length===0){at.distance=Fe,at.index=!1;var Jt=qe._module.hoverPoints(at,Pt,kt,"closest",{hoverLayer:se._hoverlayer});if(Jt&&(Jt=Jt.filter(function(Vr){return Vr.spikeDistance<=Fe})),Jt&&Jt.length){var It,qt=Jt.filter(function(Vr){return Vr.xa.showspikes&&Vr.xa.spikesnap!=="hovered data"});if(qt.length){var fr=qt[0];d(fr.x0)&&d(fr.y0)&&(It=ht(fr),(!tr.vLinePoint||tr.vLinePoint.spikeDistance>It.spikeDistance)&&(tr.vLinePoint=It))}var Tr=Jt.filter(function(Vr){return Vr.ya.showspikes&&Vr.ya.spikesnap!=="hovered data"});if(Tr.length){var Gr=Tr[0];d(Gr.x0)&&d(Gr.y0)&&(It=ht(Gr),(!tr.hLinePoint||tr.hLinePoint.spikeDistance>It.spikeDistance)&&(tr.hLinePoint=It))}}}}}function Xe(tn,Qr,rn){for(var An,En=null,Bn=1/0,Jt=0;Jt<tn.length;Jt++)An=tn[Jt].spikeDistance,rn&&Jt===0&&(An=-1/0),An<=Bn&&An<=Qr&&(En=tn[Jt],Bn=An);return En}function ht(tn){return tn?{xa:tn.xa,ya:tn.ya,x:tn.xSpike!==void 0?tn.xSpike:(tn.x0+tn.x1)/2,y:tn.ySpike!==void 0?tn.ySpike:(tn.y0+tn.y1)/2,distance:tn.distance,spikeDistance:tn.spikeDistance,curveNumber:tn.trace.index,color:tn.color,pointNumber:tn.index}:null}Pe();var Mt={fullLayout:se,container:se._hoverlayer,event:te},pt=Q._spikepoints,Lt={vLinePoint:tr.vLinePoint,hLinePoint:tr.hLinePoint};Q._spikepoints=Lt;var vt=function(){_t.sort(function(tn,Qr){return tn.distance-Qr.distance}),_t=function(tn,Qr){for(var rn=Qr.charAt(0),An=[],En=[],Bn=[],Jt=0;Jt<tn.length;Jt++){var It=tn[Jt];a.traceIs(It.trace,"bar-like")||a.traceIs(It.trace,"box-violin")?Bn.push(It):It.trace[rn+"period"]?En.push(It):An.push(It)}return An.concat(En).concat(Bn)}(_t,Se)};vt();var Dt=Se.charAt(0),xt=(Dt==="x"||Dt==="y")&&_t[0]&&L[_t[0].trace.type];if(ve&&Fe!==0&&_t.length!==0){var it=Xe(_t.filter(function(tn){return tn.ya.showspikes}),Fe,xt);tr.hLinePoint=ht(it);var St=Xe(_t.filter(function(tn){return tn.xa.showspikes}),Fe,xt);tr.vLinePoint=ht(St)}if(_t.length===0){var Nt=c.unhoverRaw(Q,te);return!ve||tr.hLinePoint===null&&tr.vLinePoint===null||K(pt)&&X(Q,tr,Mt),Nt}if(ve&&K(pt)&&X(Q,tr,Mt),g.isXYhover(ct)&&_t[0].length!==0&&_t[0].trace.type!=="splom"){var Ut=_t[0],Qt=(_t=k[Ut.trace.type]?_t.filter(function(tn){return tn.trace.index===Ut.trace.index}):[Ut]).length,Ie=H("x",Ut,se),lt=H("y",Ut,se);Pe(Ie,lt);var wt,Ot=[],Gt={},ir=0,Xt=function(tn){var Qr=k[tn.trace.type]?M(tn):tn.trace.index;if(Gt[Qr]){var rn=Gt[Qr]-1,An=Ot[rn];rn>0&&Math.abs(tn.distance)<Math.abs(An.distance)&&(Ot[rn]=tn)}else ir++,Gt[Qr]=ir,Ot.push(tn)};for(wt=0;wt<Qt;wt++)Xt(_t[wt]);for(wt=_t.length-1;wt>Qt-1;wt--)Xt(_t[wt]);_t=Ot,vt()}var Kt=Q._hoverdata,or=[],dr=Y(Q),vr=$(Q);for(Oe=0;Oe<_t.length;Oe++){var ur=_t[Oe],pr=g.makeEventData(ur,ur.trace,ur.cd);if(ur.hovertemplate!==!1){var br=!1;ur.cd[ur.index]&&ur.cd[ur.index].ht&&(br=ur.cd[ur.index].ht),ur.hovertemplate=br||ur.trace.hovertemplate||!1}if(ur.xa&&ur.ya){var Rr=ur.x0+ur.xa._offset,_r=ur.x1+ur.xa._offset,jr=ur.y0+ur.ya._offset,$r=ur.y1+ur.ya._offset,pn=Math.min(Rr,_r),In=Math.max(Rr,_r),On=Math.min(jr,$r),Sn=Math.max(jr,$r);pr.bbox={x0:pn+vr,x1:In+vr,y0:On+dr,y1:Sn+dr}}ur.eventData=[pr],or.push(pr)}Q._hoverdata=or;var an=Se==="y"&&(er.length>1||_t.length>1)||Se==="closest"&&Ue&&_t.length>1,Nr=i.combine(se.plot_bgcolor||i.background,se.paper_bgcolor),Pr=D(_t,{gd:Q,hovermode:Se,rotateLabels:an,bgColor:Nr,container:se._hoverlayer,outerContainer:se._paper.node(),commonLabelOpts:se.hoverlabel,hoverdistance:se.hoverdistance});if(g.isUnifiedHover(Se)||(function(tn,Qr,rn){var An,En,Bn,Jt,It,qt,fr,Tr=0,Gr=1,Vr=tn.size(),xr=new Array(Vr),wr=0;function Sr(Dr){var Wr=Dr[0],vn=Dr[Dr.length-1];if(En=Wr.pmin-Wr.pos-Wr.dp+Wr.size,Bn=vn.pos+vn.dp+vn.size-Wr.pmax,En>.01){for(It=Dr.length-1;It>=0;It--)Dr[It].dp+=En;An=!1}if(!(Bn<.01)){if(En<-.01){for(It=Dr.length-1;It>=0;It--)Dr[It].dp-=Bn;An=!1}if(An){var dn=0;for(Jt=0;Jt<Dr.length;Jt++)(qt=Dr[Jt]).pos+qt.dp+qt.size>Wr.pmax&&dn++;for(Jt=Dr.length-1;Jt>=0&&!(dn<=0);Jt--)(qt=Dr[Jt]).pos>Wr.pmax-1&&(qt.del=!0,dn--);for(Jt=0;Jt<Dr.length&&!(dn<=0);Jt++)if((qt=Dr[Jt]).pos<Wr.pmin+1)for(qt.del=!0,dn--,Bn=2*qt.size,It=Dr.length-1;It>=0;It--)Dr[It].dp-=Bn;for(Jt=Dr.length-1;Jt>=0&&!(dn<=0);Jt--)(qt=Dr[Jt]).pos+qt.dp+qt.size>Wr.pmax&&(qt.del=!0,dn--)}}}for(tn.each(function(Dr){var Wr=Dr[Qr],vn=Wr._id.charAt(0)==="x",dn=Wr.range;wr===0&&dn&&dn[0]>dn[1]!==vn&&(Gr=-1),xr[wr++]=[{datum:Dr,traceIndex:Dr.trace.index,dp:0,pos:Dr.pos,posref:Dr.posref,size:Dr.by*(vn?T:1)/2,pmin:0,pmax:vn?rn.width:rn.height}]}),xr.sort(function(Dr,Wr){return Dr[0].posref-Wr[0].posref||Gr*(Wr[0].traceIndex-Dr[0].traceIndex)});!An&&Tr<=Vr;){for(Tr++,An=!0,Jt=0;Jt<xr.length-1;){var Mr=xr[Jt],Ir=xr[Jt+1],qr=Mr[Mr.length-1],cn=Ir[0];if((En=qr.pos+qr.dp+qr.size-cn.pos-cn.dp+cn.size)>.01&&qr.pmin===cn.pmin&&qr.pmax===cn.pmax){for(It=Ir.length-1;It>=0;It--)Ir[It].dp+=En;for(Mr.push.apply(Mr,Ir),xr.splice(Jt+1,1),fr=0,It=Mr.length-1;It>=0;It--)fr+=Mr[It].dp;for(Bn=fr/Mr.length,It=Mr.length-1;It>=0;It--)Mr[It].dp-=Bn;An=!1}else Jt++}xr.forEach(Sr)}for(Jt=xr.length-1;Jt>=0;Jt--){var _n=xr[Jt];for(It=_n.length-1;It>=0;It--){var Jr=_n[It],bn=Jr.datum;bn.offset=Jr.dp,bn.del=Jr.del}}}(Pr,an?"xa":"ya",se),U(Pr,an,se._invScaleX,se._invScaleY)),te.target&&te.target.tagName){var en=a.getComponentMethod("annotations","hasClickToShow")(Q,or);u(t.select(te.target),en?"pointer":"")}!te.target||ae||!function(tn,Qr,rn){if(!rn||rn.length!==tn._hoverdata.length)return!0;for(var An=rn.length-1;An>=0;An--){var En=rn[An],Bn=tn._hoverdata[An];if(En.curveNumber!==Bn.curveNumber||String(En.pointNumber)!==String(Bn.pointNumber)||String(En.pointNumbers)!==String(Bn.pointNumbers))return!0}return!1}(Q,0,Kt)||(Kt&&Q.emit("plotly_unhover",{event:te,points:Kt}),Q.emit("plotly_hover",{event:te,points:Q._hoverdata,xaxes:be,yaxes:xe,xvals:Ye,yvals:rt}))})(j,W,ee,J)})},B.loneHover=function(j,W){var ee=!0;Array.isArray(j)||(ee=!1,j=[j]);var J=W.gd,Q=Y(J),te=$(J),ie=D(j.map(function(se){var de=se._x0||se.x0||se.x||0,ue=se._x1||se.x1||se.x||0,ve=se._y0||se.y0||se.y||0,ke=se._y1||se.y1||se.y||0,Ee=se.eventData;if(Ee){var be=Math.min(de,ue),xe=Math.max(de,ue),ce=Math.min(ve,ke),ge=Math.max(ve,ke),we=se.trace;if(a.traceIs(we,"gl3d")){var Me=J._fullLayout[we.scene]._scene.container,Se=Me.offsetLeft,ze=Me.offsetTop;be+=Se,xe+=Se,ce+=ze,ge+=ze}Ee.bbox={x0:be+te,x1:xe+te,y0:ce+Q,y1:ge+Q},W.inOut_bbox&&W.inOut_bbox.push(Ee.bbox)}else Ee=!1;return{color:se.color||i.defaultLine,x0:se.x0||se.x||0,x1:se.x1||se.x||0,y0:se.y0||se.y||0,y1:se.y1||se.y||0,xLabel:se.xLabel,yLabel:se.yLabel,zLabel:se.zLabel,text:se.text,name:se.name,idealAlign:se.idealAlign,borderColor:se.borderColor,fontFamily:se.fontFamily,fontSize:se.fontSize,fontColor:se.fontColor,nameLength:se.nameLength,textAlign:se.textAlign,trace:se.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:se.hovertemplate||!1,hovertemplateLabels:se.hovertemplateLabels||!1,eventData:Ee}}),{gd:J,hovermode:"closest",rotateLabels:!1,bgColor:W.bgColor||i.background,container:t.select(W.container),outerContainer:W.outerContainer||W.container}),ae=0,he=0;return ie.sort(function(se,de){return se.y0-de.y0}).each(function(se,de){var ue=se.y0-se.by/2;se.offset=ue-5<ae?ae-ue+5:0,ae=ue+se.by+se.offset,de===W.anchorIndex&&(he=se.offset)}).each(function(se){se.offset-=he}),U(ie,!1,J._fullLayout._invScaleX,J._fullLayout._invScaleY),ee?ie:ie.node()};var P=/<extra>([\s\S]*)<\/extra>/;function D(j,W){var ee=W.gd,J=ee._fullLayout,Q=W.hovermode,te=W.rotateLabels,ie=W.bgColor,ae=W.container,he=W.outerContainer,se=W.commonLabelOpts||{},de=W.fontFamily||p.HOVERFONT,ue=W.fontSize||p.HOVERFONTSIZE,ve=j[0],ke=ve.xa,Ee=ve.ya,be=Q.charAt(0),xe=ve[be+"Label"],ce=z(ee,he),ge=ce.top,we=ce.width,Me=ce.height,Se=xe!==void 0&&ve.distance<=W.hoverdistance&&(Q==="x"||Q==="y");if(Se){var ze,Fe,Ye=!0;for(ze=0;ze<j.length;ze++)if(Ye&&j[ze].zLabel===void 0&&(Ye=!1),Fe=j[ze].hoverinfo||j[ze].trace.hoverinfo){var rt=Array.isArray(Fe)?Fe:Fe.split("+");if(rt.indexOf("all")===-1&&rt.indexOf(Q)===-1){Se=!1;break}}Ye&&(Se=!1)}var Oe=ae.selectAll("g.axistext").data(Se?[0]:[]);if(Oe.enter().append("g").classed("axistext",!0),Oe.exit().remove(),Oe.each(function(){var xt=t.select(this),it=h.ensureSingle(xt,"path","",function(_r){_r.style({"stroke-width":"1px"})}),St=h.ensureSingle(xt,"text","",function(_r){_r.attr("data-notex",1)}),Nt=se.bgcolor||i.defaultLine,Ut=se.bordercolor||i.contrast(Nt),Qt=i.contrast(Nt),Ie={family:se.font.family||de,size:se.font.size||ue,color:se.font.color||Qt};it.style({fill:Nt,stroke:Ut}),St.text(xe).call(s.font,Ie).call(o.positionText,0,0).call(o.convertToTspans,ee),xt.attr("transform","");var lt,wt,Ot=z(ee,St.node());if(Q==="x"){var Gt=ke.side==="top"?"-":"";St.attr("text-anchor","middle").call(o.positionText,0,ke.side==="top"?ge-Ot.bottom-w-E:ge-Ot.top+w+E),lt=ke._offset+(ve.x0+ve.x1)/2,wt=Ee._offset+(ke.side==="top"?0:Ee._length);var ir=Ot.width/2+E;lt<ir?(lt=ir,it.attr("d","M-"+(ir-w)+",0L-"+(ir-2*w)+","+Gt+w+"H"+(E+Ot.width/2)+"v"+Gt+(2*E+Ot.height)+"H-"+ir+"V"+Gt+w+"Z")):lt>J.width-ir?(lt=J.width-ir,it.attr("d","M"+(ir-w)+",0L"+ir+","+Gt+w+"v"+Gt+(2*E+Ot.height)+"H-"+ir+"V"+Gt+w+"H"+(ir-2*w)+"Z")):it.attr("d","M0,0L"+w+","+Gt+w+"H"+(E+Ot.width/2)+"v"+Gt+(2*E+Ot.height)+"H-"+(E+Ot.width/2)+"V"+Gt+w+"H-"+w+"Z")}else{var Xt,Kt,or;Ee.side==="right"?(Xt="start",Kt=1,or="",lt=ke._offset+ke._length):(Xt="end",Kt=-1,or="-",lt=ke._offset),wt=Ee._offset+(ve.y0+ve.y1)/2,St.attr("text-anchor",Xt),it.attr("d","M0,0L"+or+w+","+w+"V"+(E+Ot.height/2)+"h"+or+(2*E+Ot.width)+"V-"+(E+Ot.height/2)+"H"+or+w+"V-"+w+"Z");var dr,vr=Ot.height/2,ur=ge-Ot.top-vr,pr="clip"+J._uid+"commonlabel"+Ee._id;if(lt<Ot.width+2*E+w){dr="M-"+(w+E)+"-"+vr+"h-"+(Ot.width-E)+"V"+vr+"h"+(Ot.width-E)+"Z";var br=Ot.width-lt+E;o.positionText(St,br,ur),Xt==="end"&&St.selectAll("tspan").each(function(){var _r=t.select(this),jr=s.tester.append("text").text(_r.text()).call(s.font,Ie),$r=z(ee,jr.node());Math.round($r.width)<Math.round(Ot.width)&&_r.attr("x",br-$r.width),jr.remove()})}else o.positionText(St,Kt*(E+w),ur),dr=null;var Rr=J._topclips.selectAll("#"+pr).data(dr?[0]:[]);Rr.enter().append("clipPath").attr("id",pr).append("path"),Rr.exit().remove(),Rr.select("path").attr("d",dr),s.setClipUrl(St,dr?pr:null,ee)}xt.attr("transform",e(lt,wt))}),g.isUnifiedHover(Q)){if(ae.selectAll("g.hovertext").remove(),j.length===0)return;var je=J.hoverlabel,We=je.font,qe={showlegend:!0,legend:{title:{text:xe,font:We},font:We,bgcolor:je.bgcolor,bordercolor:je.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:J.legend?J.legend.traceorder:void 0,orientation:"v"}},et={};y(qe,et,ee._fullData);var st=et.legend;st.entries=[];for(var ct=0;ct<j.length;ct++){var Pt=N(j[ct],!0,Q,J,xe),kt=Pt[0],at=Pt[1],tt=j[ct];tt.name=at,tt.text=at!==""?at+" : "+kt:kt;var _t=tt.cd[tt.index];_t&&(_t.mc&&(tt.mc=_t.mc),_t.mcc&&(tt.mc=_t.mcc),_t.mlc&&(tt.mlc=_t.mlc),_t.mlcc&&(tt.mlc=_t.mlcc),_t.mlw&&(tt.mlw=_t.mlw),_t.mrc&&(tt.mrc=_t.mrc),_t.dir&&(tt.dir=_t.dir)),tt._distinct=!0,st.entries.push([tt])}st.entries.sort(function(xt,it){return xt[0].trace.index-it[0].trace.index}),st.layer=ae,st._inHover=!0,st._groupTitleFont=We,v(ee,st);var er,tr,Ue,He,Be=ae.select("g.legend"),Ke=z(ee,Be.node()),_e=Ke.width+2*E,Ce=Ke.height+2*E,Le=j[0],Pe=(Le.x0+Le.x1)/2,Xe=(Le.y0+Le.y1)/2,ht=!(a.traceIs(Le.trace,"bar-like")||a.traceIs(Le.trace,"box-violin"));be==="y"?ht?(tr=Xe-E,er=Xe+E):(tr=Math.min.apply(null,j.map(function(xt){return Math.min(xt.y0,xt.y1)})),er=Math.max.apply(null,j.map(function(xt){return Math.max(xt.y0,xt.y1)}))):tr=er=h.mean(j.map(function(xt){return(xt.y0+xt.y1)/2}))-Ce/2,be==="x"?ht?(Ue=Pe+E,He=Pe-E):(Ue=Math.max.apply(null,j.map(function(xt){return Math.max(xt.x0,xt.x1)})),He=Math.min.apply(null,j.map(function(xt){return Math.min(xt.x0,xt.x1)}))):Ue=He=h.mean(j.map(function(xt){return(xt.x0+xt.x1)/2}))-_e/2;var Mt,pt,Lt=ke._offset,vt=Ee._offset;return He+=Lt-_e,tr+=vt-Ce,Mt=(Ue+=Lt)+_e<we&&Ue>=0?Ue:He+_e<we&&He>=0?He:Lt+_e<we?Lt:Ue-Pe<Pe-He+_e?we-_e:0,Mt+=E,pt=(er+=vt)+Ce<Me&&er>=0?er:tr+Ce<Me&&tr>=0?tr:vt+Ce<Me?vt:er-Xe<Xe-tr+Ce?Me-Ce:0,pt+=E,Be.attr("transform",e(Mt-1,pt-1)),Be}var Dt=ae.selectAll("g.hovertext").data(j,function(xt){return M(xt)});return Dt.enter().append("g").classed("hovertext",!0).each(function(){var xt=t.select(this);xt.append("rect").call(i.fill,i.addOpacity(ie,.8)),xt.append("text").classed("name",!0),xt.append("path").style("stroke-width","1px"),xt.append("text").classed("nums",!0).call(s.font,de,ue)}),Dt.exit().remove(),Dt.each(function(xt){var it=t.select(this).attr("transform",""),St=xt.color;Array.isArray(St)&&(St=St[xt.eventData[0].pointNumber]);var Nt=xt.bgcolor||St,Ut=i.combine(i.opacity(Nt)?Nt:i.defaultLine,ie),Qt=i.combine(i.opacity(St)?St:i.defaultLine,ie),Ie=xt.borderColor||i.contrast(Ut),lt=N(xt,Se,Q,J,xe,it),wt=lt[0],Ot=lt[1],Gt=it.select("text.nums").call(s.font,xt.fontFamily||de,xt.fontSize||ue,xt.fontColor||Ie).text(wt).attr("data-notex",1).call(o.positionText,0,0).call(o.convertToTspans,ee),ir=it.select("text.name"),Xt=0,Kt=0;if(Ot&&Ot!==wt){ir.call(s.font,xt.fontFamily||de,xt.fontSize||ue,Qt).text(Ot).attr("data-notex",1).call(o.positionText,0,0).call(o.convertToTspans,ee);var or=z(ee,ir.node());Xt=or.width+2*E,Kt=or.height+2*E}else ir.remove(),it.select("rect").remove();it.select("path").style({fill:Ut,stroke:Ie});var dr=xt.xa._offset+(xt.x0+xt.x1)/2,vr=xt.ya._offset+(xt.y0+xt.y1)/2,ur=Math.abs(xt.x1-xt.x0),pr=Math.abs(xt.y1-xt.y0),br=z(ee,Gt.node()),Rr=br.width/J._invScaleX,_r=br.height/J._invScaleY;xt.ty0=(ge-br.top)/J._invScaleY,xt.bx=Rr+2*E,xt.by=Math.max(_r+2*E,Kt),xt.anchor="start",xt.txwidth=Rr,xt.tx2width=Xt,xt.offset=0;var jr,$r,pn=(Rr+w+E+Xt)*J._invScaleX;if(te)xt.pos=dr,jr=vr+pr/2+pn<=Me,$r=vr-pr/2-pn>=0,xt.idealAlign!=="top"&&jr||!$r?jr?(vr+=pr/2,xt.anchor="start"):xt.anchor="middle":(vr-=pr/2,xt.anchor="end");else if(xt.pos=vr,jr=dr+ur/2+pn<=we,$r=dr-ur/2-pn>=0,xt.idealAlign!=="left"&&jr||!$r)if(jr)dr+=ur/2,xt.anchor="start";else{xt.anchor="middle";var In=pn/2,On=dr+In-we,Sn=dr-In;On>0&&(dr-=On),Sn<0&&(dr+=-Sn)}else dr-=ur/2,xt.anchor="end";Gt.attr("text-anchor",xt.anchor),Xt&&ir.attr("text-anchor",xt.anchor),it.attr("transform",e(dr,vr)+(te?f(b):""))}),Dt}function N(j,W,ee,J,Q,te){var ie="",ae="";j.nameOverride!==void 0&&(j.name=j.nameOverride),j.name&&(j.trace._meta&&(j.name=h.templateString(j.name,j.trace._meta)),ie=Z(j.name,j.nameLength));var he=ee.charAt(0),se=he==="x"?"y":"x";j.zLabel!==void 0?(j.xLabel!==void 0&&(ae+="x: "+j.xLabel+"<br>"),j.yLabel!==void 0&&(ae+="y: "+j.yLabel+"<br>"),j.trace.type!=="choropleth"&&j.trace.type!=="choroplethmapbox"&&(ae+=(ae?"z: ":"")+j.zLabel)):W&&j[he+"Label"]===Q?ae=j[se+"Label"]||"":j.xLabel===void 0?j.yLabel!==void 0&&j.trace.type!=="scattercarpet"&&(ae=j.yLabel):ae=j.yLabel===void 0?j.xLabel:"("+j.xLabel+", "+j.yLabel+")",!j.text&&j.text!==0||Array.isArray(j.text)||(ae+=(ae?"<br>":"")+j.text),j.extraText!==void 0&&(ae+=(ae?"<br>":"")+j.extraText),te&&ae===""&&!j.hovertemplate&&(ie===""&&te.remove(),ae=ie);var de=j.hovertemplate||!1;if(de){var ue=j.hovertemplateLabels||j;j[he+"Label"]!==Q&&(ue[he+"other"]=ue[he+"Val"],ue[he+"otherLabel"]=ue[he+"Label"]),ae=(ae=h.hovertemplateString(de,ue,J._d3locale,j.eventData[0]||{},j.trace._meta)).replace(P,function(ve,ke){return ie=Z(ke,j.nameLength),""})}return[ae,ie]}function U(j,W,ee,J){var Q=function(ie){return ie*ee},te=function(ie){return ie*J};j.each(function(ie){var ae=t.select(this);if(ie.del)return ae.remove();var he=ae.select("text.nums"),se=ie.anchor,de=se==="end"?-1:1,ue={start:1,end:-1,middle:0}[se],ve=ue*(w+E),ke=ve+ue*(ie.txwidth+E),Ee=0,be=ie.offset,xe=se==="middle";xe&&(ve-=ie.tx2width/2,ke+=ie.txwidth/2+E),W&&(be*=-S,Ee=ie.offset*A),ae.select("path").attr("d",xe?"M-"+Q(ie.bx/2+ie.tx2width/2)+","+te(be-ie.by/2)+"h"+Q(ie.bx)+"v"+te(ie.by)+"h-"+Q(ie.bx)+"Z":"M0,0L"+Q(de*w+Ee)+","+te(w+be)+"v"+te(ie.by/2-w)+"h"+Q(de*ie.bx)+"v-"+te(ie.by)+"H"+Q(de*w+Ee)+"V"+te(be-w)+"Z");var ce=Ee+ve,ge=be+ie.ty0-ie.by/2+E,we=ie.textAlign||"auto";we!=="auto"&&(we==="left"&&se!=="start"?(he.attr("text-anchor","start"),ce=xe?-ie.bx/2-ie.tx2width/2+E:-ie.bx-E):we==="right"&&se!=="end"&&(he.attr("text-anchor","end"),ce=xe?ie.bx/2-ie.tx2width/2-E:ie.bx+E)),he.call(o.positionText,Q(ce),te(ge)),ie.tx2width&&(ae.select("text.name").call(o.positionText,Q(ke+ue*E+Ee),te(be+ie.ty0-ie.by/2+E)),ae.select("rect").call(s.setRect,Q(ke+(ue-1)*ie.tx2width/2+Ee),te(be-ie.by/2-1),Q(ie.tx2width),te(ie.by+2)))})}function G(j,W){var ee=j.index,J=j.trace||{},Q=j.cd[0],te=j.cd[ee]||{};function ie(ve){return ve||d(ve)&&ve===0}var ae=Array.isArray(ee)?function(ve,ke){var Ee=h.castOption(Q,ee,ve);return ie(Ee)?Ee:h.extractOption({},J,"",ke)}:function(ve,ke){return h.extractOption(te,J,ve,ke)};function he(ve,ke,Ee){var be=ae(ke,Ee);ie(be)&&(j[ve]=be)}if(he("hoverinfo","hi","hoverinfo"),he("bgcolor","hbg","hoverlabel.bgcolor"),he("borderColor","hbc","hoverlabel.bordercolor"),he("fontFamily","htf","hoverlabel.font.family"),he("fontSize","hts","hoverlabel.font.size"),he("fontColor","htc","hoverlabel.font.color"),he("nameLength","hnl","hoverlabel.namelength"),he("textAlign","hta","hoverlabel.align"),j.posref=W==="y"||W==="closest"&&J.orientation==="h"?j.xa._offset+(j.x0+j.x1)/2:j.ya._offset+(j.y0+j.y1)/2,j.x0=h.constrain(j.x0,0,j.xa._length),j.x1=h.constrain(j.x1,0,j.xa._length),j.y0=h.constrain(j.y0,0,j.ya._length),j.y1=h.constrain(j.y1,0,j.ya._length),j.xLabelVal!==void 0&&(j.xLabel="xLabel"in j?j.xLabel:n.hoverLabelText(j.xa,j.xLabelVal,J.xhoverformat),j.xVal=j.xa.c2d(j.xLabelVal)),j.yLabelVal!==void 0&&(j.yLabel="yLabel"in j?j.yLabel:n.hoverLabelText(j.ya,j.yLabelVal,J.yhoverformat),j.yVal=j.ya.c2d(j.yLabelVal)),j.zLabelVal!==void 0&&j.zLabel===void 0&&(j.zLabel=String(j.zLabelVal)),!(isNaN(j.xerr)||j.xa.type==="log"&&j.xerr<=0)){var se=n.tickText(j.xa,j.xa.c2l(j.xerr),"hover").text;j.xerrneg!==void 0?j.xLabel+=" +"+se+" / -"+n.tickText(j.xa,j.xa.c2l(j.xerrneg),"hover").text:j.xLabel+=" \xB1 "+se,W==="x"&&(j.distance+=1)}if(!(isNaN(j.yerr)||j.ya.type==="log"&&j.yerr<=0)){var de=n.tickText(j.ya,j.ya.c2l(j.yerr),"hover").text;j.yerrneg!==void 0?j.yLabel+=" +"+de+" / -"+n.tickText(j.ya,j.ya.c2l(j.yerrneg),"hover").text:j.yLabel+=" \xB1 "+de,W==="y"&&(j.distance+=1)}var ue=j.hoverinfo||j.trace.hoverinfo;return ue&&ue!=="all"&&((ue=Array.isArray(ue)?ue:ue.split("+")).indexOf("x")===-1&&(j.xLabel=void 0),ue.indexOf("y")===-1&&(j.yLabel=void 0),ue.indexOf("z")===-1&&(j.zLabel=void 0),ue.indexOf("text")===-1&&(j.text=void 0),ue.indexOf("name")===-1&&(j.name=void 0)),j}function X(j,W,ee){var J,Q,te=ee.container,ie=ee.fullLayout,ae=ie._size,he=ee.event,se=!!W.hLinePoint,de=!!W.vLinePoint;if(te.selectAll(".spikeline").remove(),de||se){var ue=i.combine(ie.plot_bgcolor,ie.paper_bgcolor);if(se){var ve,ke,Ee=W.hLinePoint;J=Ee&&Ee.xa,(Q=Ee&&Ee.ya).spikesnap==="cursor"?(ve=he.pointerX,ke=he.pointerY):(ve=J._offset+Ee.x,ke=Q._offset+Ee.y);var be,xe,ce=m.readability(Ee.color,ue)<1.5?i.contrast(ue):Ee.color,ge=Q.spikemode,we=Q.spikethickness,Me=Q.spikecolor||ce,Se=n.getPxPosition(j,Q);if(ge.indexOf("toaxis")!==-1||ge.indexOf("across")!==-1){if(ge.indexOf("toaxis")!==-1&&(be=Se,xe=ve),ge.indexOf("across")!==-1){var ze=Q._counterDomainMin,Fe=Q._counterDomainMax;Q.anchor==="free"&&(ze=Math.min(ze,Q.position),Fe=Math.max(Fe,Q.position)),be=ae.l+ze*ae.w,xe=ae.l+Fe*ae.w}te.insert("line",":first-child").attr({x1:be,x2:xe,y1:ke,y2:ke,"stroke-width":we,stroke:Me,"stroke-dasharray":s.dashStyle(Q.spikedash,we)}).classed("spikeline",!0).classed("crisp",!0),te.insert("line",":first-child").attr({x1:be,x2:xe,y1:ke,y2:ke,"stroke-width":we+2,stroke:ue}).classed("spikeline",!0).classed("crisp",!0)}ge.indexOf("marker")!==-1&&te.insert("circle",":first-child").attr({cx:Se+(Q.side!=="right"?we:-we),cy:ke,r:we,fill:Me}).classed("spikeline",!0)}if(de){var Ye,rt,Oe=W.vLinePoint;J=Oe&&Oe.xa,Q=Oe&&Oe.ya,J.spikesnap==="cursor"?(Ye=he.pointerX,rt=he.pointerY):(Ye=J._offset+Oe.x,rt=Q._offset+Oe.y);var je,We,qe=m.readability(Oe.color,ue)<1.5?i.contrast(ue):Oe.color,et=J.spikemode,st=J.spikethickness,ct=J.spikecolor||qe,Pt=n.getPxPosition(j,J);if(et.indexOf("toaxis")!==-1||et.indexOf("across")!==-1){if(et.indexOf("toaxis")!==-1&&(je=Pt,We=rt),et.indexOf("across")!==-1){var kt=J._counterDomainMin,at=J._counterDomainMax;J.anchor==="free"&&(kt=Math.min(kt,J.position),at=Math.max(at,J.position)),je=ae.t+(1-at)*ae.h,We=ae.t+(1-kt)*ae.h}te.insert("line",":first-child").attr({x1:Ye,x2:Ye,y1:je,y2:We,"stroke-width":st,stroke:ct,"stroke-dasharray":s.dashStyle(J.spikedash,st)}).classed("spikeline",!0).classed("crisp",!0),te.insert("line",":first-child").attr({x1:Ye,x2:Ye,y1:je,y2:We,"stroke-width":st+2,stroke:ue}).classed("spikeline",!0).classed("crisp",!0)}et.indexOf("marker")!==-1&&te.insert("circle",":first-child").attr({cx:Ye,cy:Pt-(J.side!=="top"?st:-st),r:st,fill:ct}).classed("spikeline",!0)}}}function K(j,W){return!W||W.vLinePoint!==j._spikepoints.vLinePoint||W.hLinePoint!==j._spikepoints.hLinePoint}function Z(j,W){return o.plainText(j||"",{len:W,allowedTags:["br","sub","sup","b","i","em"]})}function H(j,W,ee){var J=W[j+"a"],Q=W[j+"Val"],te=W.cd[0];if(J.type==="category")Q=J._categoriesMap[Q];else if(J.type==="date"){var ie=W.trace[j+"periodalignment"];if(ie){var ae=W.cd[W.index],he=ae[j+"Start"];he===void 0&&(he=ae[j]);var se=ae[j+"End"];se===void 0&&(se=ae[j]);var de=se-he;ie==="end"?Q+=de:ie==="middle"&&(Q+=de/2)}Q=J.d2c(Q)}return te&&te.t&&te.t.posLetter===J._id&&(ee.boxmode!=="group"&&ee.violinmode!=="group"||(Q+=te.t.dPos)),Q}function Y(j){return j.offsetTop+j.clientTop}function $(j){return j.offsetLeft+j.clientLeft}function z(j,W){var ee=j._fullLayout,J=W.getBoundingClientRect(),Q=J.x,te=J.y,ie=Q+J.width,ae=te+J.height,he=h.apply3DTransform(ee._invTransform)(Q,te),se=h.apply3DTransform(ee._invTransform)(ie,ae),de=he[0],ue=he[1],ve=se[0],ke=se[1];return{x:de,y:ue,width:ve-de,height:ke-ue,top:Math.min(ue,ke),left:Math.min(de,ve),right:Math.max(de,ve),bottom:Math.max(ue,ke)}}},{"../../lib":787,"../../lib/events":776,"../../lib/override_cursor":798,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"../legend/defaults":702,"../legend/draw":703,"./constants":684,"./helpers":686,"@plotly/d3":58,"fast-isnumeric":246,tinycolor2:583}],688:[function(r,I,B){var t=r("../../lib"),d=r("../color"),m=r("./helpers").isUnifiedHover;I.exports=function(h,e,f,l){function o(u){l.font[u]||(l.font[u]=e.legend?e.legend.font[u]:e.font[u])}l=l||{},e&&m(e.hovermode)&&(l.font||(l.font={}),o("size"),o("family"),o("color"),e.legend?(l.bgcolor||(l.bgcolor=d.combine(e.legend.bgcolor,e.paper_bgcolor)),l.bordercolor||(l.bordercolor=e.legend.bordercolor)):l.bgcolor||(l.bgcolor=e.paper_bgcolor)),f("hoverlabel.bgcolor",l.bgcolor),f("hoverlabel.bordercolor",l.bordercolor),f("hoverlabel.namelength",l.namelength),t.coerceFont(f,"hoverlabel.font",l.font),f("hoverlabel.align",l.align)}},{"../../lib":787,"../color":650,"./helpers":686}],689:[function(r,I,B){var t=r("../../lib"),d=r("./layout_attributes");I.exports=function(m,h){function e(f,l){return h[f]!==void 0?h[f]:t.coerce(m,h,d,f,l)}return e("clickmode"),e("hovermode")}},{"../../lib":787,"./layout_attributes":691}],690:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../dragelement"),h=r("./helpers"),e=r("./layout_attributes"),f=r("./hover");I.exports={moduleType:"component",name:"fx",constants:r("./constants"),schema:{layout:e},attributes:r("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:r("./layout_global_defaults"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc"),getDistanceFunction:h.getDistanceFunction,getClosest:h.getClosest,inbox:h.inbox,quadrature:h.quadrature,appendArrayPointValue:h.appendArrayPointValue,castHoverOption:function(l,o,u){return d.castOption(l,o,"hoverlabel."+u)},castHoverinfo:function(l,o,u){return d.castOption(l,u,"hoverinfo",function(s){return d.coerceHoverinfo({hoverinfo:s},{_module:l._module},o)})},hover:f.hover,unhover:m.unhover,loneHover:f.loneHover,loneUnhover:function(l){var o=d.isD3Selection(l)?l:t.select(l);o.selectAll("g.hovertext").remove(),o.selectAll(".spikeline").remove()},click:r("./click")}},{"../../lib":787,"../dragelement":669,"./attributes":681,"./calc":682,"./click":683,"./constants":684,"./defaults":685,"./helpers":686,"./hover":687,"./layout_attributes":691,"./layout_defaults":692,"./layout_global_defaults":693,"@plotly/d3":58}],691:[function(r,I,B){var t=r("./constants"),d=r("../../plots/font_attributes")({editType:"none"});d.family.dflt=t.HOVERFONT,d.size.dflt=t.HOVERFONTSIZE,I.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:d,align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":867,"./constants":684}],692:[function(r,I,B){var t=r("../../lib"),d=r("./layout_attributes"),m=r("./hovermode_defaults"),h=r("./hoverlabel_defaults");I.exports=function(e,f){function l(i,c){return t.coerce(e,f,d,i,c)}m(e,f)&&(l("hoverdistance"),l("spikedistance")),l("dragmode")==="select"&&l("selectdirection");var o=f._has("mapbox"),u=f._has("geo"),s=f._basePlotModules.length;f.dragmode==="zoom"&&((o||u)&&s===1||o&&u&&s===2)&&(f.dragmode="pan"),h(e,f,l)}},{"../../lib":787,"./hoverlabel_defaults":688,"./hovermode_defaults":689,"./layout_attributes":691}],693:[function(r,I,B){var t=r("../../lib"),d=r("./hoverlabel_defaults"),m=r("./layout_attributes");I.exports=function(h,e){d(h,e,function(f,l){return t.coerce(h,e,m,f,l)})}},{"../../lib":787,"./hoverlabel_defaults":688,"./layout_attributes":691}],694:[function(r,I,B){var t=r("../../lib"),d=r("../../lib/regex").counter,m=r("../../plots/domain").attributes,h=r("../../plots/cartesian/constants").idRegex,e=r("../../plot_api/plot_template"),f={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[d("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[h.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[h.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:m({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function l(s,i,c){var n=i[c+"axes"],a=Object.keys((s._splomAxes||{})[c]||{});return Array.isArray(n)?n:a.length?a:void 0}function o(s,i,c,n,a,g){var p=i(s+"gap",c),y=i("domain."+s);i(s+"side",n);for(var v=new Array(a),b=y[0],x=(y[1]-b)/(a-p),T=x*(1-p),A=0;A<a;A++){var S=b+x*A;v[g?a-1-A:A]=[S,S+T]}return v}function u(s,i,c,n,a){var g,p=new Array(c);function y(v,b){i.indexOf(b)!==-1&&n[b]===void 0?(p[v]=b,n[b]=v):p[v]=""}if(Array.isArray(s))for(g=0;g<c;g++)y(g,s[g]);else for(y(0,a),g=1;g<c;g++)y(g,a+(g+1));return p}I.exports={moduleType:"component",name:"grid",schema:{layout:{grid:f}},layoutAttributes:f,sizeDefaults:function(s,i){var c=s.grid||{},n=l(i,c,"x"),a=l(i,c,"y");if(s.grid||n||a){var g,p,y=Array.isArray(c.subplots)&&Array.isArray(c.subplots[0]),v=Array.isArray(n),b=Array.isArray(a),x=v&&n!==c.xaxes&&b&&a!==c.yaxes;y?(g=c.subplots.length,p=c.subplots[0].length):(b&&(g=a.length),v&&(p=n.length));var T=e.newContainer(i,"grid"),A=P("rows",g),S=P("columns",p);if(A*S>1){!y&&!v&&!b&&P("pattern")==="independent"&&(y=!0),T._hasSubplotGrid=y;var w,E,k=P("roworder")==="top to bottom",L=y?.2:.1,M=y?.3:.1;x&&i._splomGridDflt&&(w=i._splomGridDflt.xside,E=i._splomGridDflt.yside),T._domains={x:o("x",P,L,w,S),y:o("y",P,M,E,A,k)}}else delete i.grid}function P(D,N){return t.coerce(c,T,f,D,N)}},contentDefaults:function(s,i){var c=i.grid;if(c&&c._domains){var n,a,g,p,y,v,b,x=s.grid||{},T=i._subplots,A=c._hasSubplotGrid,S=c.rows,w=c.columns,E=c.pattern==="independent",k=c._axisMap={};if(A){var L=x.subplots||[];v=c.subplots=new Array(S);var M=1;for(n=0;n<S;n++){var P=v[n]=new Array(w),D=L[n]||[];for(a=0;a<w;a++)if(E?(y=M===1?"xy":"x"+M+"y"+M,M++):y=D[a],P[a]="",T.cartesian.indexOf(y)!==-1){if(b=y.indexOf("y"),g=y.slice(0,b),p=y.slice(b),k[g]!==void 0&&k[g]!==a||k[p]!==void 0&&k[p]!==n)continue;P[a]=y,k[g]=a,k[p]=n}}}else{var N=l(i,x,"x"),U=l(i,x,"y");c.xaxes=u(N,T.xaxis,w,k,"x"),c.yaxes=u(U,T.yaxis,S,k,"y")}var G=c._anchors={},X=c.roworder==="top to bottom";for(var K in k){var Z,H,Y,$=K.charAt(0),z=c[$+"side"];if(z.length<8)G[K]="free";else if($==="x"){if(z.charAt(0)==="t"===X?(Z=0,H=1,Y=S):(Z=S-1,H=-1,Y=-1),A){var j=k[K];for(n=Z;n!==Y;n+=H)if((y=v[n][j])&&(b=y.indexOf("y"),y.slice(0,b)===K)){G[K]=y.slice(b);break}}else for(n=Z;n!==Y;n+=H)if(p=c.yaxes[n],T.cartesian.indexOf(K+p)!==-1){G[K]=p;break}}else if(z.charAt(0)==="l"?(Z=0,H=1,Y=w):(Z=w-1,H=-1,Y=-1),A){var W=k[K];for(n=Z;n!==Y;n+=H)if((y=v[W][n])&&(b=y.indexOf("y"),y.slice(b)===K)){G[K]=y.slice(0,b);break}}else for(n=Z;n!==Y;n+=H)if(g=c.xaxes[n],T.cartesian.indexOf(g+K)!==-1){G[K]=g;break}}}}}},{"../../lib":787,"../../lib/regex":804,"../../plot_api/plot_template":827,"../../plots/cartesian/constants":845,"../../plots/domain":866}],695:[function(r,I,B){var t=r("../../plots/cartesian/constants"),d=r("../../plot_api/plot_template").templatedArray;r("../../constants/axis_placeable_objects"),I.exports=d("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",t.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",t.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":756,"../../plot_api/plot_template":827,"../../plots/cartesian/constants":845}],696:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib/to_log_range");I.exports=function(m,h,e,f){h=h||{};var l=e==="log"&&h.type==="linear",o=e==="linear"&&h.type==="log";if(l||o){for(var u,s,i=m._fullLayout.images,c=h._id.charAt(0),n=0;n<i.length;n++)if(s="images["+n+"].",(u=i[n])[c+"ref"]===h._id){var a=u[c],g=u["size"+c],p=null,y=null;if(l){p=d(a,h.range);var v=g/Math.pow(10,p)/2;y=2*Math.log(v+Math.sqrt(1+v*v))/Math.LN10}else y=(p=Math.pow(10,a))*(Math.pow(10,g/2)-Math.pow(10,-g/2));t(p)?t(y)||(y=null):(p=null,y=null),f(s+c,p),f(s+"size"+c,y)}}}},{"../../lib/to_log_range":815,"fast-isnumeric":246}],697:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("../../plots/array_container_defaults"),h=r("./attributes");function e(f,l,o){function u(p,y){return t.coerce(f,l,h,p,y)}var s=u("source");if(!u("visible",!!s))return l;u("layer"),u("xanchor"),u("yanchor"),u("sizex"),u("sizey"),u("sizing"),u("opacity");for(var i={_fullLayout:o},c=["x","y"],n=0;n<2;n++){var a=c[n],g=d.coerceRef(f,l,i,a,"paper",void 0);g!=="paper"&&d.getFromId(i,g)._imgIndices.push(l._index),d.coercePosition(l,i,u,g,a,0)}return l}I.exports=function(f,l){m(f,l,{name:"images",handleItemDefaults:e})}},{"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"./attributes":695}],698:[function(r,I,B){var t=r("@plotly/d3"),d=r("../drawing"),m=r("../../plots/cartesian/axes"),h=r("../../plots/cartesian/axis_ids"),e=r("../../constants/xmlns_namespaces");I.exports=function(f){var l,o,u=f._fullLayout,s=[],i={},c=[];for(o=0;o<u.images.length;o++){var n=u.images[o];if(n.visible)if(n.layer==="below"&&n.xref!=="paper"&&n.yref!=="paper"){l=h.ref2id(n.xref)+h.ref2id(n.yref);var a=u._plots[l];if(!a){c.push(n);continue}a.mainplot&&(l=a.mainplot.id),i[l]||(i[l]=[]),i[l].push(n)}else n.layer==="above"?s.push(n):c.push(n)}var g={left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-.5},right:{sizing:"xMax",offset:-1}},p={top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-.5},bottom:{sizing:"YMax",offset:-1}};function y(w){var E=t.select(this);if(this._imgSrc!==w.source)if(E.attr("xmlns",e.svg),w.source&&w.source.slice(0,5)==="data:")E.attr("xlink:href",w.source),this._imgSrc=w.source;else{var k=new Promise(function(L){var M=new Image;function P(){E.remove(),L()}this.img=M,M.setAttribute("crossOrigin","anonymous"),M.onerror=P,M.onload=function(){var D=document.createElement("canvas");D.width=this.width,D.height=this.height,D.getContext("2d").drawImage(this,0,0);var N=D.toDataURL("image/png");E.attr("xlink:href",N),L()},E.on("error",P),M.src=w.source,this._imgSrc=w.source}.bind(this));f._promises.push(k)}}function v(w){var E,k,L=t.select(this),M=m.getFromId(f,w.xref),P=m.getFromId(f,w.yref),D=m.getRefType(w.xref)==="domain",N=m.getRefType(w.yref)==="domain",U=u._size;E=M!==void 0?typeof w.xref=="string"&&D?M._length*w.sizex:Math.abs(M.l2p(w.sizex)-M.l2p(0)):w.sizex*U.w,k=P!==void 0?typeof w.yref=="string"&&N?P._length*w.sizey:Math.abs(P.l2p(w.sizey)-P.l2p(0)):w.sizey*U.h;var G,X,K=E*g[w.xanchor].offset,Z=k*p[w.yanchor].offset,H=g[w.xanchor].sizing+p[w.yanchor].sizing;switch(G=M!==void 0?typeof w.xref=="string"&&D?M._length*w.x+M._offset:M.r2p(w.x)+M._offset:w.x*U.w+U.l,G+=K,X=P!==void 0?typeof w.yref=="string"&&N?P._length*(1-w.y)+P._offset:P.r2p(w.y)+P._offset:U.h-w.y*U.h+U.t,X+=Z,w.sizing){case"fill":H+=" slice";break;case"stretch":H="none"}L.attr({x:G,y:X,width:E,height:k,preserveAspectRatio:H,opacity:w.opacity});var Y=(M&&m.getRefType(w.xref)!=="domain"?M._id:"")+(P&&m.getRefType(w.yref)!=="domain"?P._id:"");d.setClipUrl(L,Y?"clip"+u._uid+Y:null,f)}var b=u._imageLowerLayer.selectAll("image").data(c),x=u._imageUpperLayer.selectAll("image").data(s);b.enter().append("image"),x.enter().append("image"),b.exit().remove(),x.exit().remove(),b.each(function(w){y.bind(this)(w),v.bind(this)(w)}),x.each(function(w){y.bind(this)(w),v.bind(this)(w)});var T=Object.keys(u._plots);for(o=0;o<T.length;o++){l=T[o];var A=u._plots[l];if(A.imagelayer){var S=A.imagelayer.selectAll("image").data(i[l]||[]);S.enter().append("image"),S.exit().remove(),S.each(function(w){y.bind(this)(w),v.bind(this)(w)})}}}},{"../../constants/xmlns_namespaces":764,"../../plots/cartesian/axes":838,"../../plots/cartesian/axis_ids":842,"../drawing":672,"@plotly/d3":58}],699:[function(r,I,B){I.exports={moduleType:"component",name:"images",layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),includeBasePlot:r("../../plots/cartesian/include_components")("images"),draw:r("./draw"),convertCoords:r("./convert_coords")}},{"../../plots/cartesian/include_components":851,"./attributes":695,"./convert_coords":696,"./defaults":697,"./draw":698}],700:[function(r,I,B){var t=r("../../plots/font_attributes"),d=r("../color/attributes");I.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:d.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:t({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:t({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":867,"../color/attributes":649}],701:[function(r,I,B){I.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],702:[function(r,I,B){var t=r("../../registry"),d=r("../../lib"),m=r("../../plot_api/plot_template"),h=r("./attributes"),e=r("../../plots/layout_attributes"),f=r("./helpers");I.exports=function(l,o,u){for(var s=l.legend||{},i=0,c=!1,n="normal",a=0;a<u.length;a++){var g=u[a];g.visible&&((g.showlegend||g._dfltShowLegend&&!(g._module&&g._module.attributes&&g._module.attributes.showlegend&&g._module.attributes.showlegend.dflt===!1))&&(i++,g.showlegend&&(c=!0,(t.traceIs(g,"pie-like")||g._input.showlegend===!0)&&i++)),(t.traceIs(g,"bar")&&o.barmode==="stack"||["tonextx","tonexty"].indexOf(g.fill)!==-1)&&(n=f.isGrouped({traceorder:n})?"grouped+reversed":"reversed"),g.legendgroup!==void 0&&g.legendgroup!==""&&(n=f.isReversed({traceorder:n})?"reversed+grouped":"grouped"))}var p=d.coerce(l,o,e,"showlegend",c&&i>1);if(p!==!1||s.uirevision){var y=m.newContainer(o,"legend");if(w("uirevision",o.uirevision),p!==!1){w("bgcolor",o.paper_bgcolor),w("bordercolor"),w("borderwidth");var v,b,x,T=d.coerceFont(w,"font",o.font),A=w("orientation")==="h";if(A?(v=0,t.getComponentMethod("rangeslider","isVisible")(l.xaxis)?(b=1.1,x="bottom"):(b=-.1,x="top")):(v=1.02,b=1,x="auto"),w("traceorder",n),f.isGrouped(o.legend)&&w("tracegroupgap"),w("itemsizing"),w("itemwidth"),w("itemclick"),w("itemdoubleclick"),w("groupclick"),w("x",v),w("xanchor"),w("y",b),w("yanchor",x),w("valign"),d.noneOrAll(s,y,["x","y"]),w("title.text")){w("title.side",A?"left":"top");var S=d.extendFlat({},T,{size:d.bigFont(T.size)});d.coerceFont(w,"title.font",S)}}}function w(E,k){return d.coerce(s,y,h,E,k)}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/layout_attributes":892,"../../registry":915,"./attributes":700,"./helpers":706}],703:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../plots/plots"),h=r("../../registry"),e=r("../../lib/events"),f=r("../dragelement"),l=r("../drawing"),o=r("../color"),u=r("../../lib/svg_text_utils"),s=r("./handle_click"),i=r("./constants"),c=r("../../constants/alignment"),n=c.LINE_SPACING,a=c.FROM_TL,g=c.FROM_BR,p=r("./get_legend_data"),y=r("./style"),v=r("./helpers");function b(k,L,M,P,D){var N=M.data()[0][0].trace,U={event:D,node:M.node(),curveNumber:N.index,expandedIndex:N._expandedIndex,data:k.data,layout:k.layout,frames:k._transitionData._frames,config:k._context,fullData:k._fullData,fullLayout:k._fullLayout};N._group&&(U.group=N._group),h.traceIs(N,"pie-like")&&(U.label=M.datum()[0].label),e.triggerHandler(k,"plotly_legendclick",U)!==!1&&(P===1?L._clickTimeout=setTimeout(function(){k._fullLayout&&s(M,k,P)},k._context.doubleClickDelay):P===2&&(L._clickTimeout&&clearTimeout(L._clickTimeout),k._legendMouseDownTime=0,e.triggerHandler(k,"plotly_legenddoubleclick",U)!==!1&&s(M,k,P)))}function x(k,L,M){var P,D,N=k.data()[0][0],U=N.trace,G=h.traceIs(U,"pie-like"),X=!M._inHover&&L._context.edits.legendText&&!G,K=M._maxNameLength;N.groupTitle?(P=N.groupTitle.text,D=N.groupTitle.font):(D=M.font,M.entries?P=N.text:(P=G?N.label:U.name,U._meta&&(P=d.templateString(P,U._meta))));var Z=d.ensureSingle(k,"text","legendtext");Z.attr("text-anchor","start").call(l.font,D).text(X?T(P,K):P);var H=M.itemwidth+2*i.itemGap;u.positionText(Z,H,0),X?Z.call(u.makeEditable,{gd:L,text:P}).call(S,k,L,M).on("edit",function(Y){this.text(T(Y,K)).call(S,k,L,M);var $=N.trace._fullInput||{},z={};if(h.hasTransform($,"groupby")){var j=h.getTransformIndices($,"groupby"),W=j[j.length-1],ee=d.keyedContainer($,"transforms["+W+"].styles","target","value.name");ee.set(N.trace._group,Y),z=ee.constructUpdate()}else z.name=Y;return h.call("_guiRestyle",L,z,U.index)}):S(Z,k,L,M)}function T(k,L){var M=Math.max(4,L);if(k&&k.trim().length>=M/2)return k;for(var P=M-(k=k||"").length;P>0;P--)k+=" ";return k}function A(k,L){var M,P=L._context.doubleClickDelay,D=1,N=d.ensureSingle(k,"rect","legendtoggle",function(U){L._context.staticPlot||U.style("cursor","pointer").attr("pointer-events","all"),U.call(o.fill,"rgba(0,0,0,0)")});L._context.staticPlot||(N.on("mousedown",function(){(M=new Date().getTime())-L._legendMouseDownTime<P?D+=1:(D=1,L._legendMouseDownTime=M)}),N.on("mouseup",function(){if(!L._dragged&&!L._editing){var U=L._fullLayout.legend;new Date().getTime()-L._legendMouseDownTime>P&&(D=Math.max(D-1,1)),b(L,U,k,D,t.event)}}))}function S(k,L,M,P,D){P._inHover&&k.attr("data-notex",!0),u.convertToTspans(k,M,function(){(function(N,U,G,X){var K=N.data()[0][0];if(!G._inHover&&K&&!K.trace.showlegend)return void N.remove();var Z=N.select("g[class*=math-group]"),H=Z.node();G||(G=U._fullLayout.legend);var Y,$=G.borderwidth;Y=X===1?G.title.font:K.groupTitle?K.groupTitle.font:G.font;var z,j,W=Y.size*n;if(H){var ee=l.bBox(H);z=ee.height,j=ee.width,X===1?l.setTranslate(Z,$,$+.75*z):l.setTranslate(Z,0,.25*z)}else{var J=N.select(X===1?".legendtitletext":".legendtext"),Q=u.lineCount(J),te=J.node();if(z=W*Q,j=te?l.bBox(te).width:0,X===1)G.title.side==="left"&&(j+=2*i.itemGap),u.positionText(J,$+i.titlePad,$+W);else{var ie=2*i.itemGap+G.itemwidth;K.groupTitle&&(ie=i.itemGap,j-=G.itemwidth),u.positionText(J,ie,-W*((Q-1)/2-.3))}}X===1?(G._titleWidth=j,G._titleHeight=z):(K.lineHeight=W,K.height=Math.max(z,16)+3,K.width=j)})(L,M,P,D)})}function w(k){return d.isRightAnchor(k)?"right":d.isCenterAnchor(k)?"center":"left"}function E(k){return d.isBottomAnchor(k)?"bottom":d.isMiddleAnchor(k)?"middle":"top"}I.exports=function(k,L){return L||(L=k._fullLayout.legend||{}),function(M,P){var D,N,U=M._fullLayout,G="legend"+U._uid,X=P._inHover;if(X?(D=P.layer,G+="-hover"):D=U._infolayer,!!D){if(M._legendMouseDownTime||(M._legendMouseDownTime=0),X){if(!P.entries)return;N=p(P.entries,P)}else{if(!M.calcdata)return;N=U.showlegend&&p(M.calcdata,P)}var K=U.hiddenlabels||[];if(!(X||U.showlegend&&N.length))return D.selectAll(".legend").remove(),U._topdefs.select("#"+G).remove(),m.autoMargin(M,"legend");var Z=d.ensureSingle(D,"g","legend",function(Q){X||Q.attr("pointer-events","all")}),H=d.ensureSingleById(U._topdefs,"clipPath",G,function(Q){Q.append("rect")}),Y=d.ensureSingle(Z,"rect","bg",function(Q){Q.attr("shape-rendering","crispEdges")});Y.call(o.stroke,P.bordercolor).call(o.fill,P.bgcolor).style("stroke-width",P.borderwidth+"px");var $=d.ensureSingle(Z,"g","scrollbox"),z=P.title;if(P._titleWidth=0,P._titleHeight=0,z.text){var j=d.ensureSingle($,"text","legendtitletext");j.attr("text-anchor","start").call(l.font,z.font).text(z.text),S(j,$,M,P,1)}else $.selectAll(".legendtitletext").remove();var W=d.ensureSingle(Z,"rect","scrollbar",function(Q){Q.attr(i.scrollBarEnterAttrs).call(o.fill,i.scrollBarColor)}),ee=$.selectAll("g.groups").data(N);ee.enter().append("g").attr("class","groups"),ee.exit().remove();var J=ee.selectAll("g.traces").data(d.identity);J.enter().append("g").attr("class","traces"),J.exit().remove(),J.style("opacity",function(Q){var te=Q[0].trace;return h.traceIs(te,"pie-like")?K.indexOf(Q[0].label)!==-1?.5:1:te.visible==="legendonly"?.5:1}).each(function(){t.select(this).call(x,M,P)}).call(y,M,P).each(function(){X||t.select(this).call(A,M)}),d.syncOrAsync([m.previousPromises,function(){return function(Q,te,ie,ae){var he=Q._fullLayout;ae||(ae=he.legend);var se=he._size,de=v.isVertical(ae),ue=v.isGrouped(ae),ve=ae.borderwidth,ke=2*ve,Ee=i.itemGap,be=ae.itemwidth+2*Ee,xe=2*(ve+Ee),ce=E(ae),ge=ae.y<0||ae.y===0&&ce==="top",we=ae.y>1||ae.y===1&&ce==="bottom",Me=ae.tracegroupgap;ae._maxHeight=Math.max(ge||we?he.height/2:se.h,30);var Se=0;ae._width=0,ae._height=0;var ze=function(Be){var Ke=0,_e=0,Ce=Be.title.side;return Ce&&(Ce.indexOf("left")!==-1&&(Ke=Be._titleWidth),Ce.indexOf("top")!==-1&&(_e=Be._titleHeight)),[Ke,_e]}(ae);if(de)ie.each(function(Be){var Ke=Be[0].height;l.setTranslate(this,ve+ze[0],ve+ze[1]+ae._height+Ke/2+Ee),ae._height+=Ke,ae._width=Math.max(ae._width,Be[0].width)}),Se=be+ae._width,ae._width+=Ee+be+ke,ae._height+=xe,ue&&(te.each(function(Be,Ke){l.setTranslate(this,0,Ke*ae.tracegroupgap)}),ae._height+=(ae._lgroupsLength-1)*ae.tracegroupgap);else{var Fe=w(ae),Ye=ae.x<0||ae.x===0&&Fe==="right",rt=ae.x>1||ae.x===1&&Fe==="left",Oe=we||ge,je=he.width/2;ae._maxWidth=Math.max(Ye?Oe&&Fe==="left"?se.l+se.w:je:rt?Oe&&Fe==="right"?se.r+se.w:je:se.w,2*be);var We=0,qe=0;ie.each(function(Be){var Ke=Be[0].width+be;We=Math.max(We,Ke),qe+=Ke}),Se=null;var et=0;if(ue){var st=0,ct=0,Pt=0;te.each(function(){var Be=0,Ke=0;t.select(this).selectAll("g.traces").each(function(Ce){var Le=Ce[0].height;l.setTranslate(this,ze[0],ze[1]+ve+Ee+Le/2+Ke),Ke+=Le,Be=Math.max(Be,be+Ce[0].width)}),st=Math.max(st,Ke);var _e=Be+Ee;_e+ve+ct>ae._maxWidth&&(et=Math.max(et,ct),ct=0,Pt+=st+Me,st=Ke),l.setTranslate(this,ct,Pt),ct+=_e}),ae._width=Math.max(et,ct)+ve,ae._height=Pt+st+xe}else{var kt=ie.size(),at=qe+ke+(kt-1)*Ee<ae._maxWidth,tt=0,_t=0,er=0,tr=0;ie.each(function(Be){var Ke=Be[0].height,_e=be+Be[0].width,Ce=(at?_e:We)+Ee;Ce+ve+_t-Ee>=ae._maxWidth&&(et=Math.max(et,tr),_t=0,er+=tt,ae._height+=tt,tt=0),l.setTranslate(this,ze[0]+ve+_t,ze[1]+ve+er+Ke/2+Ee),tr=_t+_e+Ee,_t+=Ce,tt=Math.max(tt,Ke)}),at?(ae._width=_t+ke,ae._height=tt+xe):(ae._width=Math.max(et,tr)+ke,ae._height+=tt+xe)}}ae._width=Math.ceil(Math.max(ae._width+ze[0],ae._titleWidth+2*(ve+i.titlePad))),ae._height=Math.ceil(Math.max(ae._height+ze[1],ae._titleHeight+2*(ve+i.itemGap))),ae._effHeight=Math.min(ae._height,ae._maxHeight);var Ue=Q._context.edits,He=Ue.legendText||Ue.legendPosition;ie.each(function(Be){var Ke=t.select(this).select(".legendtoggle"),_e=Be[0].height,Ce=He?be:Se||be+Be[0].width;de||(Ce+=Ee/2),l.setRect(Ke,0,-_e/2,Ce,_e)})}(M,ee,J,P)},function(){if(X||!function(Oe){var je=Oe._fullLayout.legend,We=w(je),qe=E(je);return m.autoMargin(Oe,"legend",{x:je.x,y:je.y,l:je._width*a[We],r:je._width*g[We],b:je._effHeight*g[qe],t:je._effHeight*a[qe]})}(M)){var Q,te,ie,ae,he=U._size,se=P.borderwidth,de=he.l+he.w*P.x-a[w(P)]*P._width,ue=he.t+he.h*(1-P.y)-a[E(P)]*P._effHeight;if(!X&&U.margin.autoexpand){var ve=de,ke=ue;de=d.constrain(de,0,U.width-P._width),ue=d.constrain(ue,0,U.height-P._effHeight),de!==ve&&d.log("Constrain legend.x to make legend fit inside graph"),ue!==ke&&d.log("Constrain legend.y to make legend fit inside graph")}if(X||l.setTranslate(Z,de,ue),W.on(".drag",null),Z.on("wheel",null),X||P._height<=P._maxHeight||M._context.staticPlot){var Ee=P._effHeight;X&&(Ee=P._height),Y.attr({width:P._width-se,height:Ee-se,x:se/2,y:se/2}),l.setTranslate($,0,0),H.select("rect").attr({width:P._width-2*se,height:Ee-2*se,x:se,y:se}),l.setClipUrl($,G,M),l.setRect(W,0,0,0,0),delete P._scrollY}else{var be,xe,ce,ge=Math.max(i.scrollBarMinHeight,P._effHeight*P._effHeight/P._height),we=P._effHeight-ge-2*i.scrollBarMargin,Me=P._height-P._effHeight,Se=we/Me,ze=Math.min(P._scrollY||0,Me);Y.attr({width:P._width-2*se+i.scrollBarWidth+i.scrollBarMargin,height:P._effHeight-se,x:se/2,y:se/2}),H.select("rect").attr({width:P._width-2*se+i.scrollBarWidth+i.scrollBarMargin,height:P._effHeight-2*se,x:se,y:se+ze}),l.setClipUrl($,G,M),rt(ze,ge,Se),Z.on("wheel",function(){rt(ze=d.constrain(P._scrollY+t.event.deltaY/we*Me,0,Me),ge,Se),ze!==0&&ze!==Me&&t.event.preventDefault()});var Fe=t.behavior.drag().on("dragstart",function(){var Oe=t.event.sourceEvent;be=Oe.type==="touchstart"?Oe.changedTouches[0].clientY:Oe.clientY,ce=ze}).on("drag",function(){var Oe=t.event.sourceEvent;Oe.buttons===2||Oe.ctrlKey||(xe=Oe.type==="touchmove"?Oe.changedTouches[0].clientY:Oe.clientY,rt(ze=function(je,We,qe){var et=(qe-We)/Se+je;return d.constrain(et,0,Me)}(ce,be,xe),ge,Se))});W.call(Fe);var Ye=t.behavior.drag().on("dragstart",function(){var Oe=t.event.sourceEvent;Oe.type==="touchstart"&&(be=Oe.changedTouches[0].clientY,ce=ze)}).on("drag",function(){var Oe=t.event.sourceEvent;Oe.type==="touchmove"&&(xe=Oe.changedTouches[0].clientY,rt(ze=function(je,We,qe){var et=(We-qe)/Se+je;return d.constrain(et,0,Me)}(ce,be,xe),ge,Se))});$.call(Ye)}M._context.edits.legendPosition&&(Z.classed("cursor-move",!0),f.init({element:Z.node(),gd:M,prepFn:function(){var Oe=l.getTranslate(Z);ie=Oe.x,ae=Oe.y},moveFn:function(Oe,je){var We=ie+Oe,qe=ae+je;l.setTranslate(Z,We,qe),Q=f.align(We,0,he.l,he.l+he.w,P.xanchor),te=f.align(qe,0,he.t+he.h,he.t,P.yanchor)},doneFn:function(){Q!==void 0&&te!==void 0&&h.call("_guiRelayout",M,{"legend.x":Q,"legend.y":te})},clickFn:function(Oe,je){var We=D.selectAll("g.traces").filter(function(){var qe=this.getBoundingClientRect();return je.clientX>=qe.left&&je.clientX<=qe.right&&je.clientY>=qe.top&&je.clientY<=qe.bottom});We.size()>0&&b(M,Z,We,Oe,je)}}))}function rt(Oe,je,We){P._scrollY=M._fullLayout.legend._scrollY=Oe,l.setTranslate($,0,-Oe),l.setRect(W,P._width,i.scrollBarMargin+Oe*We,i.scrollBarWidth,je),H.select("rect").attr("y",se+Oe)}}],M)}}(k,L)}},{"../../constants/alignment":755,"../../lib":787,"../../lib/events":776,"../../lib/svg_text_utils":813,"../../plots/plots":901,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"./constants":701,"./get_legend_data":704,"./handle_click":705,"./helpers":706,"./style":708,"@plotly/d3":58}],704:[function(r,I,B){var t=r("../../registry"),d=r("./helpers");I.exports=function(m,h){var e,f,l=h._inHover,o=d.isGrouped(h),u=d.isReversed(h),s={},i=[],c=!1,n={},a=0,g=0;function p(U,G){if(U!==""&&d.isGrouped(h))i.indexOf(U)===-1?(i.push(U),c=!0,s[U]=[G]):s[U].push(G);else{var X="~~i"+a;i.push(X),s[X]=[G],a++}}for(e=0;e<m.length;e++){var y=m[e],v=y[0],b=v.trace,x=b.legendgroup;if(l||b.visible&&b.showlegend)if(t.traceIs(b,"pie-like"))for(n[x]||(n[x]={}),f=0;f<y.length;f++){var T=y[f].label;n[x][T]||(p(x,{label:T,color:y[f].color,i:y[f].i,trace:b,pts:y[f].pts}),n[x][T]=!0,g=Math.max(g,(T||"").length))}else p(x,v),g=Math.max(g,(b.name||"").length)}if(!i.length)return[];var A=!c||!o,S=[];for(e=0;e<i.length;e++){var w=s[i[e]];A?S.push(w[0]):S.push(w)}for(A&&(S=[S]),e=0;e<S.length;e++){var E=1/0;for(f=0;f<S[e].length;f++){var k=S[e][f].trace.legendrank;E>k&&(E=k)}S[e][0]._groupMinRank=E,S[e][0]._preGroupSort=e}var L=function(U,G){return U.trace.legendrank-G.trace.legendrank||U._preSort-G._preSort};for(S.forEach(function(U,G){U[0]._preGroupSort=G}),S.sort(function(U,G){return U[0]._groupMinRank-G[0]._groupMinRank||U[0]._preGroupSort-G[0]._preGroupSort}),e=0;e<S.length;e++){S[e].forEach(function(U,G){U._preSort=G}),S[e].sort(L);var M=S[e][0].trace,P=null;for(f=0;f<S[e].length;f++){var D=S[e][f].trace.legendgrouptitle;if(D&&D.text){P=D,l&&(D.font=h._groupTitleFont);break}}if(u&&S[e].reverse(),P){var N=!1;for(f=0;f<S[e].length;f++)if(t.traceIs(S[e][f].trace,"pie-like")){N=!0;break}S[e].unshift({i:-1,groupTitle:P,noClick:N,trace:{showlegend:M.showlegend,legendgroup:M.legendgroup,visible:h.groupclick==="toggleitem"||M.visible}})}for(f=0;f<S[e].length;f++)S[e][f]=[S[e][f]]}return h._lgroupsLength=S.length,h._maxNameLength=g,S}},{"../../registry":915,"./helpers":706}],705:[function(r,I,B){var t=r("../../lib"),d=r("../../registry"),m=!0;I.exports=function(h,e,f){var l=e._fullLayout;if(!e._dragged&&!e._editing){var o,u=l.legend.itemclick,s=l.legend.itemdoubleclick,i=l.legend.groupclick;if(f===1&&u==="toggle"&&s==="toggleothers"&&m&&e.data&&e._context.showTips&&t.notifier(t._(e,"Double-click on legend to isolate one trace"),"long"),m=!1,f===1?o=u:f===2&&(o=s),o){var c=i==="togglegroup",n=l.hiddenlabels?l.hiddenlabels.slice():[],a=h.data()[0][0];if(!a.groupTitle||!a.noClick){var g,p,y,v,b,x=e._fullData,T=a.trace,A=T.legendgroup,S={},w=[],E=[],k=[];if(d.traceIs(T,"pie-like")){var L=a.label,M=n.indexOf(L);o==="toggle"?M===-1?n.push(L):n.splice(M,1):o==="toggleothers"&&(n=[],e.calcdata[0].forEach(function(W){L!==W.label&&n.push(W.label)}),e._fullLayout.hiddenlabels&&e._fullLayout.hiddenlabels.length===n.length&&M===-1&&(n=[])),d.call("_guiRelayout",e,"hiddenlabels",n)}else{var P,D=A&&A.length,N=[];if(D)for(g=0;g<x.length;g++)(P=x[g]).visible&&P.legendgroup===A&&N.push(g);if(o==="toggle"){var U;switch(T.visible){case!0:U="legendonly";break;case!1:U=!1;break;case"legendonly":U=!0}if(D)if(c)for(g=0;g<x.length;g++)x[g].visible!==!1&&x[g].legendgroup===A&&j(x[g],U);else j(T,U);else j(T,U)}else if(o==="toggleothers"){var G,X,K,Z,H=!0;for(g=0;g<x.length;g++)if(G=x[g]===T,K=x[g].showlegend!==!0,!(G||K||(X=D&&x[g].legendgroup===A)||x[g].visible!==!0||d.traceIs(x[g],"notLegendIsolatable"))){H=!1;break}for(g=0;g<x.length;g++)if(x[g].visible!==!1&&!d.traceIs(x[g],"notLegendIsolatable"))switch(T.visible){case"legendonly":j(x[g],!0);break;case!0:Z=!!H||"legendonly",G=x[g]===T,K=x[g].showlegend!==!0&&!x[g].legendgroup,X=G||D&&x[g].legendgroup===A,j(x[g],!(!X&&!K)||Z)}}for(g=0;g<E.length;g++)if(y=E[g]){var Y=y.constructUpdate(),$=Object.keys(Y);for(p=0;p<$.length;p++)v=$[p],(S[v]=S[v]||[])[k[g]]=Y[v]}for(b=Object.keys(S),g=0;g<b.length;g++)for(v=b[g],p=0;p<w.length;p++)S[v].hasOwnProperty(p)||(S[v][p]=void 0);d.call("_guiRestyle",e,S,w)}}}}function z(W,ee,J){var Q=w.indexOf(W),te=S[ee];return te||(te=S[ee]=[]),w.indexOf(W)===-1&&(w.push(W),Q=w.length-1),te[Q]=J,Q}function j(W,ee){if(!a.groupTitle||c){var J=W._fullInput;if(d.hasTransform(J,"groupby")){var Q=E[J.index];if(!Q){var te=d.getTransformIndices(J,"groupby"),ie=te[te.length-1];Q=t.keyedContainer(J,"transforms["+ie+"].styles","target","value.visible"),E[J.index]=Q}var ae=Q.get(W._group);ae===void 0&&(ae=!0),ae!==!1&&Q.set(W._group,ee),k[J.index]=z(J.index,"visible",J.visible!==!1)}else{var he=J.visible!==!1&&ee;z(J.index,"visible",he)}}}}},{"../../lib":787,"../../registry":915}],706:[function(r,I,B){B.isGrouped=function(t){return(t.traceorder||"").indexOf("grouped")!==-1},B.isVertical=function(t){return t.orientation!=="h"},B.isReversed=function(t){return(t.traceorder||"").indexOf("reversed")!==-1}},{}],707:[function(r,I,B){I.exports={moduleType:"component",name:"legend",layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),draw:r("./draw"),style:r("./style")}},{"./attributes":700,"./defaults":702,"./draw":703,"./style":708}],708:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../registry"),m=r("../../lib"),h=m.strTranslate,e=r("../drawing"),f=r("../color"),l=r("../colorscale/helpers").extractOpts,o=r("../../traces/scatter/subtypes"),u=r("../../traces/pie/style_one"),s=r("../../traces/pie/helpers").castOption,i=r("./constants");function c(g,p){return(p?"radial":"horizontal")+(g?"":"reversed")}function n(g){var p=g[0].trace,y=p.contours,v=o.hasLines(p),b=o.hasMarkers(p),x=p.visible&&p.fill&&p.fill!=="none",T=!1,A=!1;if(y){var S=y.coloring;S==="lines"?T=!0:v=S==="none"||S==="heatmap"||y.showlines,y.type==="constraint"?x=y._operation!=="=":S!=="fill"&&S!=="heatmap"||(A=!0)}return{showMarker:b,showLine:v,showFill:x,showGradientLine:T,showGradientFill:A,anyLine:v||T,anyFill:x||A}}function a(g,p,y){return g&&m.isArrayOrTypedArray(g)?p:g>y?y:g}I.exports=function(g,p,y){var v=p._fullLayout;y||(y=v.legend);var b=y.itemsizing==="constant",x=y.itemwidth,T=(x+2*i.itemGap)/2,A=h(T,0),S=function(k,L,M,P){var D;if(k+1)D=k;else{if(!(L&&L.width>0))return 0;D=L.width}return b?P:Math.min(D,M)};function w(k,L,M){var P=k[0].trace,D=P.marker||{},N=D.line||{},U=M?P.visible&&P.type===M:d.traceIs(P,"bar"),G=t.select(L).select("g.legendpoints").selectAll("path.legend"+M).data(U?[k]:[]);G.enter().append("path").classed("legend"+M,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",A),G.exit().remove(),G.each(function(X){var K=t.select(this),Z=X[0],H=S(Z.mlw,D.line,5,2);K.style("stroke-width",H+"px");var Y=Z.mcc;if(!y._inHover&&"mc"in Z){var $=l(D),z=$.mid;z===void 0&&(z=($.max+$.min)/2),Y=e.tryColorscale(D,"")(z)}var j=Y||Z.mc||D.color,W=D.pattern,ee=W&&e.getPatternAttr(W.shape,0,"");if(ee){var J=e.getPatternAttr(W.bgcolor,0,null),Q=e.getPatternAttr(W.fgcolor,0,null),te=W.fgopacity,ie=a(W.size,8,10),ae=a(W.solidity,.5,1),he="legend-"+P.uid;K.call(e.pattern,"legend",p,he,ee,ie,ae,Y,W.fillmode,J,Q,te)}else K.call(f.fill,j);H&&f.stroke(K,Z.mlc||N.color)})}function E(k,L,M){var P=k[0],D=P.trace,N=M?D.visible&&D.type===M:d.traceIs(D,M),U=t.select(L).select("g.legendpoints").selectAll("path.legend"+M).data(N?[k]:[]);if(U.enter().append("path").classed("legend"+M,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",A),U.exit().remove(),U.size()){var G=(D.marker||{}).line,X=S(s(G.width,P.pts),G,5,2),K=m.minExtend(D,{marker:{line:{width:X}}});K.marker.line.color=G.color;var Z=m.minExtend(P,{trace:K});u(U,Z,K)}}g.each(function(k){var L=t.select(this),M=m.ensureSingle(L,"g","layers");M.style("opacity",k[0].trace.opacity);var P=y.valign,D=k[0].lineHeight,N=k[0].height;if(P!=="middle"&&D&&N){var U={top:1,bottom:-1}[P]*(.5*(D-N+3));M.attr("transform",h(0,U))}else M.attr("transform",null);M.selectAll("g.legendfill").data([k]).enter().append("g").classed("legendfill",!0),M.selectAll("g.legendlines").data([k]).enter().append("g").classed("legendlines",!0);var G=M.selectAll("g.legendsymbols").data([k]);G.enter().append("g").classed("legendsymbols",!0),G.selectAll("g.legendpoints").data([k]).enter().append("g").classed("legendpoints",!0)}).each(function(k){var L,M=k[0].trace,P=[];if(M.visible)switch(M.type){case"histogram2d":case"heatmap":P=[["M-15,-2V4H15V-2Z"]],L=!0;break;case"choropleth":case"choroplethmapbox":P=[["M-6,-6V6H6V-6Z"]],L=!0;break;case"densitymapbox":P=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],L="radial";break;case"cone":P=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],L=!1;break;case"streamtube":P=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],L=!1;break;case"surface":P=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],L=!0;break;case"mesh3d":P=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],L=!1;break;case"volume":P=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],L=!0;break;case"isosurface":P=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],L=!1}var D=t.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(P);D.enter().append("path").classed("legend3dandfriends",!0).attr("transform",A).style("stroke-miterlimit",1),D.exit().remove(),D.each(function(N,U){var G,X=t.select(this),K=l(M),Z=K.colorscale,H=K.reversescale;if(Z){if(!L){var Y=Z.length;G=U===0?Z[H?Y-1:0][1]:U===1?Z[H?0:Y-1][1]:Z[Math.floor((Y-1)/2)][1]}}else{var $=M.vertexcolor||M.facecolor||M.color;G=m.isArrayOrTypedArray($)?$[U]||$[0]:$}X.attr("d",N[0]),G?X.call(f.fill,G):X.call(function(z){if(z.size()){var j="legendfill-"+M.uid;e.gradient(z,p,j,c(H,L==="radial"),Z,"fill")}})})}).each(function(k){var L=k[0].trace,M=L.type==="waterfall";if(k[0]._distinct&&M){var P=k[0].trace[k[0].dir].marker;return k[0].mc=P.color,k[0].mlw=P.line.width,k[0].mlc=P.line.color,w(k,this,"waterfall")}var D=[];L.visible&&M&&(D=k[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var N=t.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(D);N.enter().append("path").classed("legendwaterfall",!0).attr("transform",A).style("stroke-miterlimit",1),N.exit().remove(),N.each(function(U){var G=t.select(this),X=L[U[0]].marker,K=S(void 0,X.line,5,2);G.attr("d",U[1]).style("stroke-width",K+"px").call(f.fill,X.color),K&&G.call(f.stroke,X.line.color)})}).each(function(k){w(k,this,"funnel")}).each(function(k){w(k,this)}).each(function(k){var L=k[0].trace,M=t.select(this).select("g.legendpoints").selectAll("path.legendbox").data(L.visible&&d.traceIs(L,"box-violin")?[k]:[]);M.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",A),M.exit().remove(),M.each(function(){var P=t.select(this);if(L.boxpoints!=="all"&&L.points!=="all"||f.opacity(L.fillcolor)!==0||f.opacity((L.line||{}).color)!==0){var D=S(void 0,L.line,5,2);P.style("stroke-width",D+"px").call(f.fill,L.fillcolor),D&&f.stroke(P,L.line.color)}else{var N=m.minExtend(L,{marker:{size:b?12:m.constrain(L.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});M.call(e.pointStyle,N,p)}})}).each(function(k){E(k,this,"funnelarea")}).each(function(k){E(k,this,"pie")}).each(function(k){var L,M,P=n(k),D=P.showFill,N=P.showLine,U=P.showGradientLine,G=P.showGradientFill,X=P.anyFill,K=P.anyLine,Z=k[0],H=Z.trace,Y=l(H),$=Y.colorscale,z=Y.reversescale,j=o.hasMarkers(H)||!X?"M5,0":K?"M5,-2":"M5,-3",W=t.select(this),ee=W.select(".legendfill").selectAll("path").data(D||G?[k]:[]);if(ee.enter().append("path").classed("js-fill",!0),ee.exit().remove(),ee.attr("d",j+"h"+x+"v6h-"+x+"z").call(D?e.fillGroupStyle:function(te){if(te.size()){var ie="legendfill-"+H.uid;e.gradient(te,p,ie,c(z),$,"fill")}}),N||U){var J=S(void 0,H.line,10,5);M=m.minExtend(H,{line:{width:J}}),L=[m.minExtend(Z,{trace:M})]}var Q=W.select(".legendlines").selectAll("path").data(N||U?[L]:[]);Q.enter().append("path").classed("js-line",!0),Q.exit().remove(),Q.attr("d",j+(U?"l"+x+",0.0001":"h"+x)).call(N?e.lineGroupStyle:function(te){if(te.size()){var ie="legendline-"+H.uid;e.lineGroupStyle(te),e.gradient(te,p,ie,c(z),$,"stroke")}})}).each(function(k){var L,M,P=n(k),D=P.anyFill,N=P.anyLine,U=P.showLine,G=P.showMarker,X=k[0],K=X.trace,Z=!G&&!N&&!D&&o.hasText(K);function H(Q,te,ie,ae){var he=m.nestedProperty(K,Q).get(),se=m.isArrayOrTypedArray(he)&&te?te(he):he;if(b&&se&&ae!==void 0&&(se=ae),ie){if(se<ie[0])return ie[0];if(se>ie[1])return ie[1]}return se}function Y(Q){return X._distinct&&X.index&&Q[X.index]?Q[X.index]:Q[0]}if(G||Z||U){var $={},z={};if(G){$.mc=H("marker.color",Y),$.mx=H("marker.symbol",Y),$.mo=H("marker.opacity",m.mean,[.2,1]),$.mlc=H("marker.line.color",Y),$.mlw=H("marker.line.width",m.mean,[0,5],2),z.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var j=H("marker.size",m.mean,[2,16],12);$.ms=j,z.marker.size=j}U&&(z.line={width:H("line.width",Y,[0,10],5)}),Z&&($.tx="Aa",$.tp=H("textposition",Y),$.ts=10,$.tc=H("textfont.color",Y),$.tf=H("textfont.family",Y)),L=[m.minExtend(X,$)],(M=m.minExtend(K,z)).selectedpoints=null,M.texttemplate=null}var W=t.select(this).select("g.legendpoints"),ee=W.selectAll("path.scatterpts").data(G?L:[]);ee.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",A),ee.exit().remove(),ee.call(e.pointStyle,M,p),G&&(L[0].mrc=3);var J=W.selectAll("g.pointtext").data(Z?L:[]);J.enter().append("g").classed("pointtext",!0).append("text").attr("transform",A),J.exit().remove(),J.selectAll("text").call(e.textPointStyle,M,p)}).each(function(k){var L=k[0].trace,M=t.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(L.visible&&L.type==="candlestick"?[k,k]:[]);M.enter().append("path").classed("legendcandle",!0).attr("d",function(P,D){return D?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",A).style("stroke-miterlimit",1),M.exit().remove(),M.each(function(P,D){var N=t.select(this),U=L[D?"increasing":"decreasing"],G=S(void 0,U.line,5,2);N.style("stroke-width",G+"px").call(f.fill,U.fillcolor),G&&f.stroke(N,U.line.color)})}).each(function(k){var L=k[0].trace,M=t.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(L.visible&&L.type==="ohlc"?[k,k]:[]);M.enter().append("path").classed("legendohlc",!0).attr("d",function(P,D){return D?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",A).style("stroke-miterlimit",1),M.exit().remove(),M.each(function(P,D){var N=t.select(this),U=L[D?"increasing":"decreasing"],G=S(void 0,U.line,5,2);N.style("fill","none").call(e.dashLine,U.line.dash,G),G&&f.stroke(N,U.line.color)})})}},{"../../lib":787,"../../registry":915,"../../traces/pie/helpers":1181,"../../traces/pie/style_one":1187,"../../traces/scatter/subtypes":1227,"../color":650,"../colorscale/helpers":661,"../drawing":672,"./constants":701,"@plotly/d3":58}],709:[function(r,I,B){r("./constants"),I.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":711}],710:[function(r,I,B){var t=r("../../registry"),d=r("../../plots/plots"),m=r("../../plots/cartesian/axis_ids"),h=r("../../fonts/ploticon"),e=r("../shapes/draw").eraseActiveShape,f=r("../../lib"),l=f._,o=I.exports={};function u(v,b){var x,T,A=b.currentTarget,S=A.getAttribute("data-attr"),w=A.getAttribute("data-val")||!0,E=v._fullLayout,k={},L=m.list(v,null,!0),M=E._cartesianSpikesEnabled;if(S==="zoom"){var P,D=w==="in"?.5:2,N=(1+D)/2,U=(1-D)/2;for(T=0;T<L.length;T++)if(!(x=L[T]).fixedrange)if(P=x._name,w==="auto")k[P+".autorange"]=!0;else if(w==="reset"){if(x._rangeInitial===void 0)k[P+".autorange"]=!0;else{var G=x._rangeInitial.slice();k[P+".range[0]"]=G[0],k[P+".range[1]"]=G[1]}x._showSpikeInitial!==void 0&&(k[P+".showspikes"]=x._showSpikeInitial,M!=="on"||x._showSpikeInitial||(M="off"))}else{var X=[x.r2l(x.range[0]),x.r2l(x.range[1])],K=[N*X[0]+U*X[1],N*X[1]+U*X[0]];k[P+".range[0]"]=x.l2r(K[0]),k[P+".range[1]"]=x.l2r(K[1])}}else S!=="hovermode"||w!=="x"&&w!=="y"||(w=E._isHoriz?"y":"x",A.setAttribute("data-val",w)),k[S]=w;E._cartesianSpikesEnabled=M,t.call("_guiRelayout",v,k)}function s(v,b){for(var x=b.currentTarget,T=x.getAttribute("data-attr"),A=x.getAttribute("data-val")||!0,S=v._fullLayout._subplots.gl3d||[],w={},E=T.split("."),k=0;k<S.length;k++)w[S[k]+"."+E[1]]=A;var L=A==="pan"?A:"zoom";w.dragmode=L,t.call("_guiRelayout",v,w)}function i(v,b){for(var x=b.currentTarget.getAttribute("data-attr"),T=x==="resetLastSave",A=x==="resetDefault",S=v._fullLayout,w=S._subplots.gl3d||[],E={},k=0;k<w.length;k++){var L,M=w[k],P=M+".camera",D=M+".aspectratio",N=M+".aspectmode",U=S[M]._scene;T?(E[P+".up"]=U.viewInitial.up,E[P+".eye"]=U.viewInitial.eye,E[P+".center"]=U.viewInitial.center,L=!0):A&&(E[P+".up"]=null,E[P+".eye"]=null,E[P+".center"]=null,L=!0),L&&(E[D+".x"]=U.viewInitial.aspectratio.x,E[D+".y"]=U.viewInitial.aspectratio.y,E[D+".z"]=U.viewInitial.aspectratio.z,E[N]=U.viewInitial.aspectmode)}t.call("_guiRelayout",v,E)}function c(v,b){var x=b.currentTarget,T=x._previousVal,A=v._fullLayout,S=A._subplots.gl3d||[],w=["xaxis","yaxis","zaxis"],E={},k={};if(T)k=T,x._previousVal=null;else{for(var L=0;L<S.length;L++){var M=S[L],P=A[M],D=M+".hovermode";E[D]=P.hovermode,k[D]=!1;for(var N=0;N<3;N++){var U=w[N],G=M+"."+U+".showspikes";k[G]=!1,E[G]=P[U].showspikes}}x._previousVal=E}return k}function n(v,b){for(var x=b.currentTarget,T=x.getAttribute("data-attr"),A=x.getAttribute("data-val")||!0,S=v._fullLayout,w=S._subplots.geo||[],E=0;E<w.length;E++){var k=w[E],L=S[k];if(T==="zoom"){var M=L.projection.scale,P=A==="in"?2*M:.5*M;t.call("_guiRelayout",v,k+".projection.scale",P)}}T==="reset"&&y(v,"geo")}function a(v){var b=v._fullLayout;return!b.hovermode&&(b._has("cartesian")?b._isHoriz?"y":"x":"closest")}function g(v){var b=a(v);t.call("_guiRelayout",v,"hovermode",b)}function p(v,b){for(var x=b.currentTarget.getAttribute("data-val"),T=v._fullLayout,A=T._subplots.mapbox||[],S={},w=0;w<A.length;w++){var E=A[w],k=T[E].zoom,L=x==="in"?1.05*k:k/1.05;S[E+".zoom"]=L}t.call("_guiRelayout",v,S)}function y(v,b){for(var x=v._fullLayout,T=x._subplots[b]||[],A={},S=0;S<T.length;S++)for(var w=T[S],E=x[w]._subplot.viewInitial,k=Object.keys(E),L=0;L<k.length;L++){var M=k[L];A[w+"."+M]=E[M]}t.call("_guiRelayout",v,A)}o.toImage={name:"toImage",title:function(v){var b=(v._context.toImageButtonOptions||{}).format||"png";return l(v,b==="png"?"Download plot as a png":"Download plot")},icon:h.camera,click:function(v){var b=v._context.toImageButtonOptions,x={format:b.format||"png"};f.notifier(l(v,"Taking snapshot - this may take a few seconds"),"long"),x.format!=="svg"&&f.isIE()&&(f.notifier(l(v,"IE only supports svg.  Changing format to svg."),"long"),x.format="svg"),["filename","width","height","scale"].forEach(function(T){T in b&&(x[T]=b[T])}),t.call("downloadImage",v,x).then(function(T){f.notifier(l(v,"Snapshot succeeded")+" - "+T,"long")}).catch(function(){f.notifier(l(v,"Sorry, there was a problem downloading your snapshot!"),"long")})}},o.sendDataToCloud={name:"sendDataToCloud",title:function(v){return l(v,"Edit in Chart Studio")},icon:h.disk,click:function(v){d.sendDataToCloud(v)}},o.editInChartStudio={name:"editInChartStudio",title:function(v){return l(v,"Edit in Chart Studio")},icon:h.pencil,click:function(v){d.sendDataToCloud(v)}},o.zoom2d={name:"zoom2d",_cat:"zoom",title:function(v){return l(v,"Zoom")},attr:"dragmode",val:"zoom",icon:h.zoombox,click:u},o.pan2d={name:"pan2d",_cat:"pan",title:function(v){return l(v,"Pan")},attr:"dragmode",val:"pan",icon:h.pan,click:u},o.select2d={name:"select2d",_cat:"select",title:function(v){return l(v,"Box Select")},attr:"dragmode",val:"select",icon:h.selectbox,click:u},o.lasso2d={name:"lasso2d",_cat:"lasso",title:function(v){return l(v,"Lasso Select")},attr:"dragmode",val:"lasso",icon:h.lasso,click:u},o.drawclosedpath={name:"drawclosedpath",title:function(v){return l(v,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:h.drawclosedpath,click:u},o.drawopenpath={name:"drawopenpath",title:function(v){return l(v,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:h.drawopenpath,click:u},o.drawline={name:"drawline",title:function(v){return l(v,"Draw line")},attr:"dragmode",val:"drawline",icon:h.drawline,click:u},o.drawrect={name:"drawrect",title:function(v){return l(v,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:h.drawrect,click:u},o.drawcircle={name:"drawcircle",title:function(v){return l(v,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:h.drawcircle,click:u},o.eraseshape={name:"eraseshape",title:function(v){return l(v,"Erase active shape")},icon:h.eraseshape,click:e},o.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(v){return l(v,"Zoom in")},attr:"zoom",val:"in",icon:h.zoom_plus,click:u},o.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(v){return l(v,"Zoom out")},attr:"zoom",val:"out",icon:h.zoom_minus,click:u},o.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(v){return l(v,"Autoscale")},attr:"zoom",val:"auto",icon:h.autoscale,click:u},o.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(v){return l(v,"Reset axes")},attr:"zoom",val:"reset",icon:h.home,click:u},o.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(v){return l(v,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:h.tooltip_basic,gravity:"ne",click:u},o.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(v){return l(v,"Compare data on hover")},attr:"hovermode",val:function(v){return v._fullLayout._isHoriz?"y":"x"},icon:h.tooltip_compare,gravity:"ne",click:u},o.zoom3d={name:"zoom3d",_cat:"zoom",title:function(v){return l(v,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:h.zoombox,click:s},o.pan3d={name:"pan3d",_cat:"pan",title:function(v){return l(v,"Pan")},attr:"scene.dragmode",val:"pan",icon:h.pan,click:s},o.orbitRotation={name:"orbitRotation",title:function(v){return l(v,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:h["3d_rotate"],click:s},o.tableRotation={name:"tableRotation",title:function(v){return l(v,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:h["z-axis"],click:s},o.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(v){return l(v,"Reset camera to default")},attr:"resetDefault",icon:h.home,click:i},o.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(v){return l(v,"Reset camera to last save")},attr:"resetLastSave",icon:h.movie,click:i},o.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(v){return l(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:h.tooltip_basic,gravity:"ne",click:function(v,b){var x=c(v,b);t.call("_guiRelayout",v,x)}},o.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(v){return l(v,"Zoom in")},attr:"zoom",val:"in",icon:h.zoom_plus,click:n},o.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(v){return l(v,"Zoom out")},attr:"zoom",val:"out",icon:h.zoom_minus,click:n},o.resetGeo={name:"resetGeo",_cat:"reset",title:function(v){return l(v,"Reset")},attr:"reset",val:null,icon:h.autoscale,click:n},o.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(v){return l(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:h.tooltip_basic,gravity:"ne",click:g},o.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(v){return l(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:h.tooltip_basic,gravity:"ne",click:g},o.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(v){return l(v,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:h.tooltip_basic,gravity:"ne",click:g},o.resetViewSankey={name:"resetSankeyGroup",title:function(v){return l(v,"Reset view")},icon:h.home,click:function(v){for(var b={"node.groups":[],"node.x":[],"node.y":[]},x=0;x<v._fullData.length;x++){var T=v._fullData[x]._viewInitial;b["node.groups"].push(T.node.groups.slice()),b["node.x"].push(T.node.x.slice()),b["node.y"].push(T.node.y.slice())}t.call("restyle",v,b)}},o.toggleHover={name:"toggleHover",title:function(v){return l(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:h.tooltip_basic,gravity:"ne",click:function(v,b){var x=c(v,b);x.hovermode=a(v),t.call("_guiRelayout",v,x)}},o.resetViews={name:"resetViews",title:function(v){return l(v,"Reset views")},icon:h.home,click:function(v,b){var x=b.currentTarget;x.setAttribute("data-attr","zoom"),x.setAttribute("data-val","reset"),u(v,b),x.setAttribute("data-attr","resetLastSave"),i(v,b),y(v,"geo"),y(v,"mapbox")}},o.toggleSpikelines={name:"toggleSpikelines",title:function(v){return l(v,"Toggle Spike Lines")},icon:h.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(v){var b=v._fullLayout,x=b._cartesianSpikesEnabled;b._cartesianSpikesEnabled=x==="on"?"off":"on",t.call("_guiRelayout",v,function(T){for(var A=T._fullLayout._cartesianSpikesEnabled==="on",S=m.list(T,null,!0),w={},E=0;E<S.length;E++){var k=S[E];w[k._name+".showspikes"]=!!A||k._showSpikeInitial}return w}(v))}},o.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(v){return l(v,"Reset view")},attr:"reset",icon:h.home,click:function(v){y(v,"mapbox")}},o.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(v){return l(v,"Zoom in")},attr:"zoom",val:"in",icon:h.zoom_plus,click:p},o.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(v){return l(v,"Zoom out")},attr:"zoom",val:"out",icon:h.zoom_minus,click:p}},{"../../fonts/ploticon":766,"../../lib":787,"../../plots/cartesian/axis_ids":842,"../../plots/plots":901,"../../registry":915,"../shapes/draw":734}],711:[function(r,I,B){var t=r("./buttons"),d=Object.keys(t),m=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],h=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(m),e=[];d.forEach(function(f){(function(l){if(h.indexOf(l._cat||l.name)===-1){var o=l.name,u=(l._cat||l.name).toLowerCase();e.indexOf(o)===-1&&e.push(o),e.indexOf(u)===-1&&e.push(u)}})(t[f])}),e.sort(),I.exports={DRAW_MODES:m,backButtons:h,foreButtons:e}},{"./buttons":710}],712:[function(r,I,B){var t=r("../../lib"),d=r("../color"),m=r("../../plot_api/plot_template"),h=r("./attributes");I.exports=function(e,f){var l=e.modebar||{},o=m.newContainer(f,"modebar");function u(i,c){return t.coerce(l,o,h,i,c)}u("orientation"),u("bgcolor",d.addOpacity(f.paper_bgcolor,.5));var s=d.contrast(d.rgb(f.modebar.bgcolor));u("color",d.addOpacity(s,.3)),u("activecolor",d.addOpacity(s,.7)),u("uirevision",f.uirevision),u("add"),u("remove")}},{"../../lib":787,"../../plot_api/plot_template":827,"../color":650,"./attributes":709}],713:[function(r,I,B){I.exports={moduleType:"component",name:"modebar",layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),manage:r("./manage")}},{"./attributes":709,"./defaults":712,"./manage":714}],714:[function(r,I,B){var t=r("../../plots/cartesian/axis_ids"),d=r("../../traces/scatter/subtypes"),m=r("../../registry"),h=r("../fx/helpers").isUnifiedHover,e=r("./modebar"),f=r("./buttons"),l=r("./constants").DRAW_MODES;I.exports=function(o){var u=o._fullLayout,s=o._context,i=u._modeBar;if(s.displayModeBar||s.watermark){if(!Array.isArray(s.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(s.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var c,n=s.modeBarButtons;c=Array.isArray(n)&&n.length?function(a){for(var g=0;g<a.length;g++)for(var p=a[g],y=0;y<p.length;y++){var v=p[y];if(typeof v=="string"){if(f[v]===void 0)throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "));a[g][y]=f[v]}}return a}(n):!s.displayModeBar&&s.watermark?[]:function(a){var g=a._fullLayout,p=a._fullData,y=a._context;function v(ie,ae){if(typeof ae=="string"){if(ae.toLowerCase()===ie.toLowerCase())return!0}else{var he=ae.name,se=ae._cat||ae.name;if(he===ie||se===ie.toLowerCase())return!0}return!1}var b=g.modebar.add;typeof b=="string"&&(b=[b]);var x=g.modebar.remove;typeof x=="string"&&(x=[x]);var T=y.modeBarButtonsToAdd.concat(b.filter(function(ie){for(var ae=0;ae<y.modeBarButtonsToRemove.length;ae++)if(v(ie,y.modeBarButtonsToRemove[ae]))return!1;return!0})),A=y.modeBarButtonsToRemove.concat(x.filter(function(ie){for(var ae=0;ae<y.modeBarButtonsToAdd.length;ae++)if(v(ie,y.modeBarButtonsToAdd[ae]))return!1;return!0})),S=g._has("cartesian"),w=g._has("gl3d"),E=g._has("geo"),k=g._has("pie"),L=g._has("funnelarea"),M=g._has("gl2d"),P=g._has("ternary"),D=g._has("mapbox"),N=g._has("polar"),U=g._has("sankey"),G=function(ie){for(var ae=t.list({_fullLayout:ie},null,!0),he=0;he<ae.length;he++)if(!ae[he].fixedrange)return!1;return!0}(g),X=h(g.hovermode),K=[];function Z(ie){if(ie.length){for(var ae=[],he=0;he<ie.length;he++){for(var se=ie[he],de=f[se],ue=de.name.toLowerCase(),ve=(de._cat||de.name).toLowerCase(),ke=!1,Ee=0;Ee<A.length;Ee++){var be=A[Ee].toLowerCase();if(be===ue||be===ve){ke=!0;break}}ke||ae.push(f[se])}K.push(ae)}}var H=["toImage"];y.showEditInChartStudio?H.push("editInChartStudio"):y.showSendToCloud&&H.push("sendDataToCloud"),Z(H);var Y=[],$=[],z=[],j=[];(S||M||k||L||P)+E+w+D+N>1?($=["toggleHover"],z=["resetViews"]):E?(Y=["zoomInGeo","zoomOutGeo"],$=["hoverClosestGeo"],z=["resetGeo"]):w?($=["hoverClosest3d"],z=["resetCameraDefault3d","resetCameraLastSave3d"]):D?(Y=["zoomInMapbox","zoomOutMapbox"],$=["toggleHover"],z=["resetViewMapbox"]):M?$=["hoverClosestGl2d"]:k?$=["hoverClosestPie"]:U?($=["hoverClosestCartesian","hoverCompareCartesian"],z=["resetViewSankey"]):$=["toggleHover"],S&&($=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(function(ie){for(var ae=0;ae<ie.length;ae++)if(!m.traceIs(ie[ae],"noHover"))return!1;return!0}(p)||X)&&($=[]),!S&&!M||G||(Y=["zoomIn2d","zoomOut2d","autoScale2d"],z[0]!=="resetViews"&&(z=["resetScale2d"])),w?j=["zoom3d","pan3d","orbitRotation","tableRotation"]:(S||M)&&!G||P?j=["zoom2d","pan2d"]:D||E?j=["pan2d"]:N&&(j=["zoom2d"]),function(ie){for(var ae=!1,he=0;he<ie.length&&!ae;he++){var se=ie[he];se._module&&se._module.selectPoints&&(m.traceIs(se,"scatter-like")?(d.hasMarkers(se)||d.hasText(se))&&(ae=!0):m.traceIs(se,"box-violin")&&se.boxpoints!=="all"&&se.points!=="all"||(ae=!0))}return ae}(p)&&j.push("select2d","lasso2d");var W=[],ee=function(ie){W.indexOf(ie)===-1&&$.indexOf(ie)!==-1&&W.push(ie)};if(Array.isArray(T)){for(var J=[],Q=0;Q<T.length;Q++){var te=T[Q];typeof te=="string"?(te=te.toLowerCase(),l.indexOf(te)!==-1?(g._has("mapbox")||g._has("cartesian"))&&j.push(te):te==="togglespikelines"?ee("toggleSpikelines"):te==="togglehover"?ee("toggleHover"):te==="hovercompare"?ee("hoverCompareCartesian"):te==="hoverclosest"?(ee("hoverClosestCartesian"),ee("hoverClosestGeo"),ee("hoverClosest3d"),ee("hoverClosestGl2d"),ee("hoverClosestPie")):te==="v1hovermode"&&(ee("toggleHover"),ee("hoverClosestCartesian"),ee("hoverCompareCartesian"),ee("hoverClosestGeo"),ee("hoverClosest3d"),ee("hoverClosestGl2d"),ee("hoverClosestPie"))):J.push(te)}T=J}return Z(j),Z(Y.concat(z)),Z(W),function(ie,ae){if(ae.length)if(Array.isArray(ae[0]))for(var he=0;he<ae.length;he++)ie.push(ae[he]);else ie.push(ae);return ie}(K,T)}(o),i?i.update(o,c):u._modeBar=e(o,c)}else i&&(i.destroy(),delete u._modeBar)}},{"../../plots/cartesian/axis_ids":842,"../../registry":915,"../../traces/scatter/subtypes":1227,"../fx/helpers":686,"./buttons":710,"./constants":711,"./modebar":715}],715:[function(r,I,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("../../lib"),h=r("../../fonts/ploticon"),e=new DOMParser;function f(o){this.container=o.container,this.element=document.createElement("div"),this.update(o.graphInfo,o.buttons),this.container.appendChild(this.element)}var l=f.prototype;l.update=function(o,u){this.graphInfo=o;var s=this.graphInfo._context,i=this.graphInfo._fullLayout,c="modebar-"+i._uid;this.element.setAttribute("id",c),this._uid=c,this.element.className="modebar",s.displayModeBar==="hover"&&(this.element.className+=" modebar--hover ease-bg"),i.modebar.orientation==="v"&&(this.element.className+=" vertical",u=u.reverse());var n=i.modebar,a=s.displayModeBar==="hover"?".js-plotly-plot .plotly:hover ":"";m.deleteRelatedStyleRule(c),m.addRelatedStyleRule(c,a+"#"+c+" .modebar-group","background-color: "+n.bgcolor),m.addRelatedStyleRule(c,"#"+c+" .modebar-btn .icon path","fill: "+n.color),m.addRelatedStyleRule(c,"#"+c+" .modebar-btn:hover .icon path","fill: "+n.activecolor),m.addRelatedStyleRule(c,"#"+c+" .modebar-btn.active .icon path","fill: "+n.activecolor);var g=!this.hasButtons(u),p=this.hasLogo!==s.displaylogo,y=this.locale!==s.locale;if(this.locale=s.locale,(g||p||y)&&(this.removeAllButtons(),this.updateButtons(u),s.watermark||s.displaylogo)){var v=this.getLogo();s.watermark&&(v.className=v.className+" watermark"),i.modebar.orientation==="v"?this.element.insertBefore(v,this.element.childNodes[0]):this.element.appendChild(v),this.hasLogo=!0}this.updateActiveButton()},l.updateButtons=function(o){var u=this;this.buttons=o,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(s){var i=u.createGroup();s.forEach(function(c){var n=c.name;if(!n)throw new Error("must provide button 'name' in button config");if(u.buttonsNames.indexOf(n)!==-1)throw new Error("button name '"+n+"' is taken");u.buttonsNames.push(n);var a=u.createButton(c);u.buttonElements.push(a),i.appendChild(a)}),u.element.appendChild(i)})},l.createGroup=function(){var o=document.createElement("div");return o.className="modebar-group",o},l.createButton=function(o){var u=this,s=document.createElement("a");s.setAttribute("rel","tooltip"),s.className="modebar-btn";var i=o.title;i===void 0?i=o.name:typeof i=="function"&&(i=i(this.graphInfo)),(i||i===0)&&s.setAttribute("data-title",i),o.attr!==void 0&&s.setAttribute("data-attr",o.attr);var c=o.val;if(c!==void 0&&(typeof c=="function"&&(c=c(this.graphInfo)),s.setAttribute("data-val",c)),typeof o.click!="function")throw new Error("must provide button 'click' function in button config");s.addEventListener("click",function(a){o.click(u.graphInfo,a),u.updateActiveButton(a.currentTarget)}),s.setAttribute("data-toggle",o.toggle||!1),o.toggle&&t.select(s).classed("active",!0);var n=o.icon;return typeof n=="function"?s.appendChild(n()):s.appendChild(this.createIcon(n||h.question)),s.setAttribute("data-gravity",o.gravity||"n"),s},l.createIcon=function(o){var u,s=d(o.height)?Number(o.height):o.ascent-o.descent,i="http://www.w3.org/2000/svg";if(o.path){(u=document.createElementNS(i,"svg")).setAttribute("viewBox",[0,0,o.width,s].join(" ")),u.setAttribute("class","icon");var c=document.createElementNS(i,"path");c.setAttribute("d",o.path),o.transform?c.setAttribute("transform",o.transform):o.ascent!==void 0&&c.setAttribute("transform","matrix(1 0 0 -1 0 "+o.ascent+")"),u.appendChild(c)}return o.svg&&(u=e.parseFromString(o.svg,"application/xml").childNodes[0]),u.setAttribute("height","1em"),u.setAttribute("width","1em"),u},l.updateActiveButton=function(o){var u=this.graphInfo._fullLayout,s=o!==void 0?o.getAttribute("data-attr"):null;this.buttonElements.forEach(function(i){var c=i.getAttribute("data-val")||!0,n=i.getAttribute("data-attr"),a=i.getAttribute("data-toggle")==="true",g=t.select(i);if(a)n===s&&g.classed("active",!g.classed("active"));else{var p=n===null?n:m.nestedProperty(u,n).get();g.classed("active",p===c)}})},l.hasButtons=function(o){var u=this.buttons;if(!u||o.length!==u.length)return!1;for(var s=0;s<o.length;++s){if(o[s].length!==u[s].length)return!1;for(var i=0;i<o[s].length;i++)if(o[s][i].name!==u[s][i].name)return!1}return!0},l.getLogo=function(){var o=this.createGroup(),u=document.createElement("a");return u.href="https://plotly.com/",u.target="_blank",u.setAttribute("data-title",m._(this.graphInfo,"Produced with Plotly")),u.className="modebar-btn plotlyjsicon modebar-btn--logo",u.appendChild(this.createIcon(h.newplotlylogo)),o.appendChild(u),o},l.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},l.destroy=function(){m.removeElement(this.container.querySelector(".modebar")),m.deleteRelatedStyleRule(this._uid)},I.exports=function(o,u){var s=o._fullLayout,i=new f({graphInfo:o,container:s._modebardiv.node(),buttons:u});return s._privateplot&&t.select(i.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),i}},{"../../fonts/ploticon":766,"../../lib":787,"@plotly/d3":58,"fast-isnumeric":246}],716:[function(r,I,B){var t=r("../../plots/font_attributes"),d=r("../color/attributes"),m=(0,r("../../plot_api/plot_template").templatedArray)("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});I.exports={visible:{valType:"boolean",editType:"plot"},buttons:m,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:t({editType:"plot"}),bgcolor:{valType:"color",dflt:d.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:d.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":827,"../../plots/font_attributes":867,"../color/attributes":649}],717:[function(r,I,B){I.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],718:[function(r,I,B){var t=r("../../lib"),d=r("../color"),m=r("../../plot_api/plot_template"),h=r("../../plots/array_container_defaults"),e=r("./attributes"),f=r("./constants");function l(o,u,s,i){var c=i.calendar;function n(g,p){return t.coerce(o,u,e.buttons,g,p)}if(n("visible")){var a=n("step");a!=="all"&&(!c||c==="gregorian"||a!=="month"&&a!=="year"?n("stepmode"):u.stepmode="backward",n("count")),n("label")}}I.exports=function(o,u,s,i,c){var n=o.rangeselector||{},a=m.newContainer(u,"rangeselector");function g(v,b){return t.coerce(n,a,e,v,b)}if(g("visible",h(n,a,{name:"buttons",handleItemDefaults:l,calendar:c}).length>0)){var p=function(v,b,x){for(var T=x.filter(function(E){return b[E].anchor===v._id}),A=0,S=0;S<T.length;S++){var w=b[T[S]].domain;w&&(A=Math.max(w[1],A))}return[v.domain[0],A+f.yPad]}(u,s,i);g("x",p[0]),g("y",p[1]),t.noneOrAll(o,u,["x","y"]),g("xanchor"),g("yanchor"),t.coerceFont(g,"font",s.font);var y=g("bgcolor");g("activecolor",d.contrast(y,f.lightAmount,f.darkAmount)),g("bordercolor"),g("borderwidth")}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/array_container_defaults":833,"../color":650,"./attributes":716,"./constants":717}],719:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../registry"),m=r("../../plots/plots"),h=r("../color"),e=r("../drawing"),f=r("../../lib"),l=f.strTranslate,o=r("../../lib/svg_text_utils"),u=r("../../plots/cartesian/axis_ids"),s=r("../../constants/alignment"),i=s.LINE_SPACING,c=s.FROM_TL,n=s.FROM_BR,a=r("./constants"),g=r("./get_update_object");function p(b){return b._id}function y(b,x,T){var A=f.ensureSingle(b,"rect","selector-rect",function(S){S.attr("shape-rendering","crispEdges")});A.attr({rx:a.rx,ry:a.ry}),A.call(h.stroke,x.bordercolor).call(h.fill,function(S,w){return w._isActive||w._isHovered?S.activecolor:S.bgcolor}(x,T)).style("stroke-width",x.borderwidth+"px")}function v(b,x,T,A){f.ensureSingle(b,"text","selector-text",function(S){S.attr("text-anchor","middle")}).call(e.font,x.font).text(function(S,w){return S.label?w?f.templateString(S.label,w):S.label:S.step==="all"?"all":S.count+S.step.charAt(0)}(T,A._fullLayout._meta)).call(function(S){o.convertToTspans(S,A)})}I.exports=function(b){var x=b._fullLayout._infolayer.selectAll(".rangeselector").data(function(T){for(var A=u.list(T,"x",!0),S=[],w=0;w<A.length;w++){var E=A[w];E.rangeselector&&E.rangeselector.visible&&S.push(E)}return S}(b),p);x.enter().append("g").classed("rangeselector",!0),x.exit().remove(),x.style({cursor:"pointer","pointer-events":"all"}),x.each(function(T){var A=t.select(this),S=T,w=S.rangeselector,E=A.selectAll("g.button").data(f.filterVisible(w.buttons));E.enter().append("g").classed("button",!0),E.exit().remove(),E.each(function(k){var L=t.select(this),M=g(S,k);k._isActive=function(P,D,N){if(D.step==="all")return P.autorange===!0;var U=Object.keys(N);return P.range[0]===N[U[0]]&&P.range[1]===N[U[1]]}(S,k,M),L.call(y,w,k),L.call(v,w,k,b),L.on("click",function(){b._dragged||d.call("_guiRelayout",b,M)}),L.on("mouseover",function(){k._isHovered=!0,L.call(y,w,k)}),L.on("mouseout",function(){k._isHovered=!1,L.call(y,w,k)})}),function(k,L,M,P,D){var N=0,U=0,G=M.borderwidth;L.each(function(){var $=t.select(this).select(".selector-text"),z=M.font.size*i,j=Math.max(z*o.lineCount($),16)+3;U=Math.max(U,j)}),L.each(function(){var $=t.select(this),z=$.select(".selector-rect"),j=$.select(".selector-text"),W=j.node()&&e.bBox(j.node()).width,ee=M.font.size*i,J=o.lineCount(j),Q=Math.max(W+10,a.minButtonWidth);$.attr("transform",l(G+N,G)),z.attr({x:0,y:0,width:Q,height:U}),o.positionText(j,Q/2,U/2-(J-1)*ee/2+3),N+=Q+5});var X=k._fullLayout._size,K=X.l+X.w*M.x,Z=X.t+X.h*(1-M.y),H="left";f.isRightAnchor(M)&&(K-=N,H="right"),f.isCenterAnchor(M)&&(K-=N/2,H="center");var Y="top";f.isBottomAnchor(M)&&(Z-=U,Y="bottom"),f.isMiddleAnchor(M)&&(Z-=U/2,Y="middle"),N=Math.ceil(N),U=Math.ceil(U),K=Math.round(K),Z=Math.round(Z),m.autoMargin(k,P+"-range-selector",{x:M.x,y:M.y,l:N*c[H],r:N*n[H],b:U*n[Y],t:U*c[Y]}),D.attr("transform",l(K,Z))}(b,E,w,S._name,A)})}},{"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/cartesian/axis_ids":842,"../../plots/plots":901,"../../registry":915,"../color":650,"../drawing":672,"./constants":717,"./get_update_object":720,"@plotly/d3":58}],720:[function(r,I,B){var t=r("d3-time"),d=r("../../lib").titleCase;I.exports=function(m,h){var e=m._name,f={};if(h.step==="all")f[e+".autorange"]=!0;else{var l=function(o,u){var s,i=o.range,c=new Date(o.r2l(i[1])),n=u.step,a=t["utc"+d(n)],g=u.count;switch(u.stepmode){case"backward":s=o.l2r(+a.offset(c,-g));break;case"todate":var p=a.offset(c,-g);s=o.l2r(+a.ceil(p))}var y=i[1];return[s,y]}(m,h);f[e+".range[0]"]=l[0],f[e+".range[1]"]=l[1]}return f}},{"../../lib":787,"d3-time":174}],721:[function(r,I,B){I.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:r("./attributes")}}},layoutAttributes:r("./attributes"),handleDefaults:r("./defaults"),draw:r("./draw")}},{"./attributes":716,"./defaults":718,"./draw":719}],722:[function(r,I,B){var t=r("../color/attributes");I.exports={bgcolor:{valType:"color",dflt:t.background,editType:"plot"},bordercolor:{valType:"color",dflt:t.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":649}],723:[function(r,I,B){var t=r("../../plots/cartesian/axis_ids").list,d=r("../../plots/cartesian/autorange").getAutoRange,m=r("./constants");I.exports=function(h){for(var e=t(h,"x",!0),f=0;f<e.length;f++){var l=e[f],o=l[m.name];o&&o.visible&&o.autorange&&(o._input.autorange=!0,o._input.range=o.range=d(h,l))}}},{"../../plots/cartesian/autorange":837,"../../plots/cartesian/axis_ids":842,"./constants":724}],724:[function(r,I,B){I.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],725:[function(r,I,B){var t=r("../../lib"),d=r("../../plot_api/plot_template"),m=r("../../plots/cartesian/axis_ids"),h=r("./attributes"),e=r("./oppaxis_attributes");I.exports=function(f,l,o){var u=f[o],s=l[o];if(u.rangeslider||l._requestRangeslider[s._id]){t.isPlainObject(u.rangeslider)||(u.rangeslider={});var i,c,n=u.rangeslider,a=d.newContainer(s,"rangeslider");if(A("visible")){A("bgcolor",l.plot_bgcolor),A("bordercolor"),A("borderwidth"),A("thickness"),A("autorange",!s.isValidRange(n.range)),A("range");var g=l._subplots;if(g)for(var p=g.cartesian.filter(function(w){return w.substr(0,w.indexOf("y"))===m.name2id(o)}).map(function(w){return w.substr(w.indexOf("y"),w.length)}),y=t.simpleMap(p,m.id2name),v=0;v<y.length;v++){var b=y[v];i=n[b]||{},c=d.newContainer(a,b,"yaxis");var x,T=l[b];i.range&&T.isValidRange(i.range)&&(x="fixed"),S("rangemode",x)!=="match"&&S("range",T.range.slice())}a._input=n}}function A(w,E){return t.coerce(n,a,h,w,E)}function S(w,E){return t.coerce(i,c,e,w,E)}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/cartesian/axis_ids":842,"./attributes":722,"./oppaxis_attributes":729}],726:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../registry"),m=r("../../plots/plots"),h=r("../../lib"),e=h.strTranslate,f=r("../drawing"),l=r("../color"),o=r("../titles"),u=r("../../plots/cartesian"),s=r("../../plots/cartesian/axis_ids"),i=r("../dragelement"),c=r("../../lib/setcursor"),n=r("./constants");function a(x,T,A,S){var w=h.ensureSingle(x,"rect",n.bgClassName,function(M){M.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),E=S.borderwidth%2==0?S.borderwidth:S.borderwidth-1,k=-S._offsetShift,L=f.crispRound(T,S.borderwidth);w.attr({width:S._width+E,height:S._height+E,transform:e(k,k),fill:S.bgcolor,stroke:S.bordercolor,"stroke-width":L})}function g(x,T,A,S){var w=T._fullLayout;h.ensureSingleById(w._topdefs,"clipPath",S._clipId,function(E){E.append("rect").attr({x:0,y:0})}).select("rect").attr({width:S._width,height:S._height})}function p(x,T,A,S){var w,E=T.calcdata,k=x.selectAll("g."+n.rangePlotClassName).data(A._subplotsWith,h.identity);k.enter().append("g").attr("class",function(L){return n.rangePlotClassName+" "+L}).call(f.setClipUrl,S._clipId,T),k.order(),k.exit().remove(),k.each(function(L,M){var P=t.select(this),D=M===0,N=s.getFromId(T,L,"y"),U=N._name,G=S[U],X={data:[],layout:{xaxis:{type:A.type,domain:[0,1],range:S.range.slice(),calendar:A.calendar},width:S._width,height:S._height,margin:{t:0,b:0,l:0,r:0}},_context:T._context};A.rangebreaks&&(X.layout.xaxis.rangebreaks=A.rangebreaks),X.layout[U]={type:N.type,domain:[0,1],range:G.rangemode!=="match"?G.range.slice():N.range.slice(),calendar:N.calendar},N.rangebreaks&&(X.layout[U].rangebreaks=N.rangebreaks),m.supplyDefaults(X);var K=X._fullLayout.xaxis,Z=X._fullLayout[U];K.clearCalc(),K.setScale(),Z.clearCalc(),Z.setScale();var H={id:L,plotgroup:P,xaxis:K,yaxis:Z,isRangePlot:!0};D?w=H:(H.mainplot="xy",H.mainplotinfo=w),u.rangePlot(T,H,function(Y,$){for(var z=[],j=0;j<Y.length;j++){var W=Y[j],ee=W[0].trace;ee.xaxis+ee.yaxis===$&&z.push(W)}return z}(E,L))})}function y(x,T,A,S,w){h.ensureSingle(x,"rect",n.maskMinClassName,function(E){E.attr({x:0,y:0,"shape-rendering":"crispEdges"})}).attr("height",S._height).call(l.fill,n.maskColor),h.ensureSingle(x,"rect",n.maskMaxClassName,function(E){E.attr({y:0,"shape-rendering":"crispEdges"})}).attr("height",S._height).call(l.fill,n.maskColor),w.rangemode!=="match"&&(h.ensureSingle(x,"rect",n.maskMinOppAxisClassName,function(E){E.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",S._width).call(l.fill,n.maskOppAxisColor),h.ensureSingle(x,"rect",n.maskMaxOppAxisClassName,function(E){E.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",S._width).style("border-top",n.maskOppBorder).call(l.fill,n.maskOppAxisColor))}function v(x,T,A,S){T._context.staticPlot||h.ensureSingle(x,"rect",n.slideBoxClassName,function(w){w.attr({y:0,cursor:n.slideBoxCursor,"shape-rendering":"crispEdges"})}).attr({height:S._height,fill:n.slideBoxFill})}function b(x,T,A,S){var w=h.ensureSingle(x,"g",n.grabberMinClassName),E=h.ensureSingle(x,"g",n.grabberMaxClassName),k={x:0,width:n.handleWidth,rx:n.handleRadius,fill:l.background,stroke:l.defaultLine,"stroke-width":n.handleStrokeWidth,"shape-rendering":"crispEdges"},L={y:Math.round(S._height/4),height:Math.round(S._height/2)};h.ensureSingle(w,"rect",n.handleMinClassName,function(P){P.attr(k)}).attr(L),h.ensureSingle(E,"rect",n.handleMaxClassName,function(P){P.attr(k)}).attr(L);var M={width:n.grabAreaWidth,x:0,y:0,fill:n.grabAreaFill,cursor:T._context.staticPlot?void 0:n.grabAreaCursor};h.ensureSingle(w,"rect",n.grabAreaMinClassName,function(P){P.attr(M)}).attr("height",S._height),h.ensureSingle(E,"rect",n.grabAreaMaxClassName,function(P){P.attr(M)}).attr("height",S._height)}I.exports=function(x){for(var T=x._fullLayout,A=T._rangeSliderData,S=0;S<A.length;S++){var w=A[S][n.name];w._clipId=w._id+"-"+T._uid}var E=T._infolayer.selectAll("g."+n.containerClassName).data(A,function(k){return k._name});E.exit().each(function(k){var L=k[n.name];T._topdefs.select("#"+L._clipId).remove()}).remove(),A.length!==0&&(E.enter().append("g").classed(n.containerClassName,!0).attr("pointer-events","all"),E.each(function(k){var L=t.select(this),M=k[n.name],P=T[s.id2name(k.anchor)],D=M[s.id2name(k.anchor)];if(M.range){var N,U=h.simpleMap(M.range,k.r2l),G=h.simpleMap(k.range,k.r2l);N=G[0]<G[1]?[Math.min(U[0],G[0]),Math.max(U[1],G[1])]:[Math.max(U[0],G[0]),Math.min(U[1],G[1])],M.range=M._input.range=h.simpleMap(N,k.l2r)}k.cleanRange("rangeslider.range");var X=T._size,K=k.domain;M._width=X.w*(K[1]-K[0]);var Z=Math.round(X.l+X.w*K[0]),H=Math.round(X.t+X.h*(1-k._counterDomainMin)+(k.side==="bottom"?k._depth:0)+M._offsetShift+n.extraPad);L.attr("transform",e(Z,H)),M._rl=h.simpleMap(M.range,k.r2l);var Y=M._rl[0],$=M._rl[1],z=$-Y;if(M.p2d=function(he){return he/M._width*z+Y},M.d2p=function(he){return(he-Y)/z*M._width},k.rangebreaks){var j=k.locateBreaks(Y,$);if(j.length){var W,ee,J=0;for(W=0;W<j.length;W++)J+=(ee=j[W]).max-ee.min;var Q=M._width/($-Y-J),te=[-Q*Y];for(W=0;W<j.length;W++)ee=j[W],te.push(te[te.length-1]-Q*(ee.max-ee.min));for(M.d2p=function(he){for(var se=te[0],de=0;de<j.length;de++){var ue=j[de];if(he>=ue.max)se=te[de+1];else if(he<ue.min)break}return se+Q*he},W=0;W<j.length;W++)(ee=j[W]).pmin=M.d2p(ee.min),ee.pmax=M.d2p(ee.max);M.p2d=function(he){for(var se=te[0],de=0;de<j.length;de++){var ue=j[de];if(he>=ue.pmax)se=te[de+1];else if(he<ue.pmin)break}return(he-se)/Q}}}if(D.rangemode!=="match"){var ie=P.r2l(D.range[0]),ae=P.r2l(D.range[1])-ie;M.d2pOppAxis=function(he){return(he-ie)/ae*M._height}}L.call(a,x,k,M).call(g,x,k,M).call(p,x,k,M).call(y,x,k,M,D).call(v,x,k,M).call(b,x,k,M),function(he,se,de,ue){if(se._context.staticPlot)return;var ve=he.select("rect."+n.slideBoxClassName).node(),ke=he.select("rect."+n.grabAreaMinClassName).node(),Ee=he.select("rect."+n.grabAreaMaxClassName).node();function be(){var xe=t.event,ce=xe.target,ge=xe.clientX||xe.touches[0].clientX,we=ge-he.node().getBoundingClientRect().left,Me=ue.d2p(de._rl[0]),Se=ue.d2p(de._rl[1]),ze=i.coverSlip();function Fe(rt){var Oe,je,We,qe=+(rt.clientX||rt.touches[0].clientX)-ge;switch(ce){case ve:We="ew-resize",Oe=Me+qe,je=Se+qe;break;case ke:We="col-resize",Oe=Me+qe,je=Se;break;case Ee:We="col-resize",Oe=Me,je=Se+qe;break;default:We="ew-resize",Oe=we,je=we+qe}if(je<Oe){var et=je;je=Oe,Oe=et}ue._pixelMin=Oe,ue._pixelMax=je,c(t.select(ze),We),function(st,ct,Pt,kt){function at(er){return Pt.l2r(h.constrain(er,kt._rl[0],kt._rl[1]))}var tt=at(kt.p2d(kt._pixelMin)),_t=at(kt.p2d(kt._pixelMax));window.requestAnimationFrame(function(){d.call("_guiRelayout",ct,Pt._name+".range",[tt,_t])})}(0,se,de,ue)}function Ye(){ze.removeEventListener("mousemove",Fe),ze.removeEventListener("mouseup",Ye),this.removeEventListener("touchmove",Fe),this.removeEventListener("touchend",Ye),h.removeElement(ze)}this.addEventListener("touchmove",Fe),this.addEventListener("touchend",Ye),ze.addEventListener("mousemove",Fe),ze.addEventListener("mouseup",Ye)}he.on("mousedown",be),he.on("touchstart",be)}(L,x,k,M),function(he,se,de,ue,ve,ke){var Ee=n.handleWidth/2;function be(Ye){return h.constrain(Ye,0,ue._width)}function xe(Ye){return h.constrain(Ye,0,ue._height)}function ce(Ye){return h.constrain(Ye,-Ee,ue._width+Ee)}var ge=be(ue.d2p(de._rl[0])),we=be(ue.d2p(de._rl[1]));if(he.select("rect."+n.slideBoxClassName).attr("x",ge).attr("width",we-ge),he.select("rect."+n.maskMinClassName).attr("width",ge),he.select("rect."+n.maskMaxClassName).attr("x",we).attr("width",ue._width-we),ke.rangemode!=="match"){var Me=ue._height-xe(ue.d2pOppAxis(ve._rl[1])),Se=ue._height-xe(ue.d2pOppAxis(ve._rl[0]));he.select("rect."+n.maskMinOppAxisClassName).attr("x",ge).attr("height",Me).attr("width",we-ge),he.select("rect."+n.maskMaxOppAxisClassName).attr("x",ge).attr("y",Se).attr("height",ue._height-Se).attr("width",we-ge),he.select("rect."+n.slideBoxClassName).attr("y",Me).attr("height",Se-Me)}var ze=Math.round(ce(ge-Ee))-.5,Fe=Math.round(ce(we-Ee))+.5;he.select("g."+n.grabberMinClassName).attr("transform",e(ze,.5)),he.select("g."+n.grabberMaxClassName).attr("transform",e(Fe,.5))}(L,0,k,M,P,D),k.side==="bottom"&&o.draw(x,k._id+"title",{propContainer:k,propName:k._name+".title",placeholder:T._dfltTitle.x,attributes:{x:k._offset+k._length/2,y:H+M._height+M._offsetShift+10+1.5*k.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":787,"../../lib/setcursor":808,"../../plots/cartesian":852,"../../plots/cartesian/axis_ids":842,"../../plots/plots":901,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"../titles":748,"./constants":724,"@plotly/d3":58}],727:[function(r,I,B){var t=r("../../plots/cartesian/axis_ids"),d=r("../../lib/svg_text_utils"),m=r("./constants"),h=r("../../constants/alignment").LINE_SPACING,e=m.name;function f(l){var o=l&&l[e];return o&&o.visible}B.isVisible=f,B.makeData=function(l){var o=t.list({_fullLayout:l},"x",!0),u=l.margin,s=[];if(!l._has("gl2d"))for(var i=0;i<o.length;i++){var c=o[i];if(f(c)){s.push(c);var n=c[e];n._id=e+c._id,n._height=(l.height-u.b-u.t)*n.thickness,n._offsetShift=Math.floor(n.borderwidth/2)}}l._rangeSliderData=s},B.autoMarginOpts=function(l,o){var u=l._fullLayout,s=o[e],i=o._id.charAt(0),c=0,n=0;return o.side==="bottom"&&(c=o._depth,o.title.text!==u._dfltTitle[i]&&(n=1.5*o.title.font.size+10+s._offsetShift,n+=(o.title.text.match(d.BR_TAG_ALL)||[]).length*o.title.font.size*h)),{x:0,y:o._counterDomainMin,l:0,r:0,t:0,b:s._height+c+Math.max(u.margin.b,n),pad:m.extraPad+2*s._offsetShift}}},{"../../constants/alignment":755,"../../lib/svg_text_utils":813,"../../plots/cartesian/axis_ids":842,"./constants":724}],728:[function(r,I,B){var t=r("../../lib"),d=r("./attributes"),m=r("./oppaxis_attributes"),h=r("./helpers");I.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:t.extendFlat({},d,{yaxis:m})}}},layoutAttributes:r("./attributes"),handleDefaults:r("./defaults"),calcAutorange:r("./calc_autorange"),draw:r("./draw"),isVisible:h.isVisible,makeData:h.makeData,autoMarginOpts:h.autoMarginOpts}},{"../../lib":787,"./attributes":722,"./calc_autorange":723,"./defaults":725,"./draw":726,"./helpers":727,"./oppaxis_attributes":729}],729:[function(r,I,B){I.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],730:[function(r,I,B){var t=r("../annotations/attributes"),d=r("../../traces/scatter/attributes").line,m=r("../drawing/attributes").dash,h=r("../../lib/extend").extendFlat,e=r("../../plot_api/plot_template").templatedArray;r("../../constants/axis_placeable_objects"),I.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:h({},t.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:h({},t.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:h({},d.color,{editType:"arraydraw"}),width:h({},d.width,{editType:"calc+arraydraw"}),dash:h({},m,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":756,"../../lib/extend":777,"../../plot_api/plot_template":827,"../../traces/scatter/attributes":1202,"../annotations/attributes":633,"../drawing/attributes":671}],731:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("./constants"),h=r("./helpers");function e(u){return l(u.line.width,u.xsizemode,u.x0,u.x1,u.path,!1)}function f(u){return l(u.line.width,u.ysizemode,u.y0,u.y1,u.path,!0)}function l(u,s,i,c,n,a){var g=u/2,p=a;if(s==="pixel"){var y=n?h.extractPathCoords(n,a?m.paramIsY:m.paramIsX):[i,c],v=t.aggNums(Math.max,null,y),b=t.aggNums(Math.min,null,y),x=b<0?Math.abs(b)+g:g,T=v>0?v+g:g;return{ppad:g,ppadplus:p?x:T,ppadminus:p?T:x}}return{ppad:g}}function o(u,s,i,c,n){var a=u.type==="category"||u.type==="multicategory"?u.r2c:u.d2c;if(s!==void 0)return[a(s),a(i)];if(c){var g,p,y,v,b=1/0,x=-1/0,T=c.match(m.segmentRE);for(u.type==="date"&&(a=h.decodeDate(a)),g=0;g<T.length;g++)(p=n[T[g].charAt(0)].drawn)!==void 0&&(!(y=T[g].substr(1).match(m.paramRE))||y.length<p||((v=a(y[p]))<b&&(b=v),v>x&&(x=v)));return x>=b?[b,x]:void 0}}I.exports=function(u){var s=u._fullLayout,i=t.filterVisible(s.shapes);if(i.length&&u._fullData.length)for(var c=0;c<i.length;c++){var n,a,g=i[c];g._extremes={};var p=d.getRefType(g.xref),y=d.getRefType(g.yref);if(g.xref!=="paper"&&p!=="domain"){var v=g.xsizemode==="pixel"?g.xanchor:g.x0,b=g.xsizemode==="pixel"?g.xanchor:g.x1;(a=o(n=d.getFromId(u,g.xref),v,b,g.path,m.paramIsX))&&(g._extremes[n._id]=d.findExtremes(n,a,e(g)))}if(g.yref!=="paper"&&y!=="domain"){var x=g.ysizemode==="pixel"?g.yanchor:g.y0,T=g.ysizemode==="pixel"?g.yanchor:g.y1;(a=o(n=d.getFromId(u,g.yref),x,T,g.path,m.paramIsY))&&(g._extremes[n._id]=d.findExtremes(n,a,f(g)))}}}},{"../../lib":787,"../../plots/cartesian/axes":838,"./constants":732,"./helpers":741}],732:[function(r,I,B){I.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],733:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("../../plots/array_container_defaults"),h=r("./attributes"),e=r("./helpers");function f(l,o,u){function s(D,N){return t.coerce(l,o,h,D,N)}if(s("visible")){var i=s("path"),c=s("type",i?"path":"rect");o.type!=="path"&&delete o.path,s("editable"),s("layer"),s("opacity"),s("fillcolor"),s("fillrule"),s("line.width")&&(s("line.color"),s("line.dash"));for(var n=s("xsizemode"),a=s("ysizemode"),g=["x","y"],p=0;p<2;p++){var y,v,b,x=g[p],T=x+"anchor",A=x==="x"?n:a,S={_fullLayout:u},w=d.coerceRef(l,o,S,x,void 0,"paper");if(d.getRefType(w)==="range"?((y=d.getFromId(S,w))._shapeIndices.push(o._index),b=e.rangeToShapePosition(y),v=e.shapePositionToRange(y)):v=b=t.identity,c!=="path"){var E=x+"0",k=x+"1",L=l[E],M=l[k];l[E]=v(l[E],!0),l[k]=v(l[k],!0),A==="pixel"?(s(E,0),s(k,10)):(d.coercePosition(o,S,s,w,E,.25),d.coercePosition(o,S,s,w,k,.75)),o[E]=b(o[E]),o[k]=b(o[k]),l[E]=L,l[k]=M}if(A==="pixel"){var P=l[T];l[T]=v(l[T],!0),d.coercePosition(o,S,s,w,T,.25),o[T]=b(o[T]),l[T]=P}}c==="path"?s("path"):t.noneOrAll(l,o,["x0","x1","y0","y1"])}}I.exports=function(l,o){m(l,o,{name:"shapes",handleItemDefaults:f})}},{"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"./attributes":730,"./helpers":741}],734:[function(r,I,B){var t=r("../../registry"),d=r("../../lib"),m=r("../../plots/cartesian/axes"),h=r("./draw_newshape/helpers").readPaths,e=r("./draw_newshape/display_outlines"),f=r("../../plots/cartesian/handle_outline").clearOutlineControllers,l=r("../color"),o=r("../drawing"),u=r("../../plot_api/plot_template").arrayEditor,s=r("../dragelement"),i=r("../../lib/setcursor"),c=r("./constants"),n=r("./helpers");function a(A){var S=A._fullLayout;for(var w in S._shapeUpperLayer.selectAll("path").remove(),S._shapeLowerLayer.selectAll("path").remove(),S._plots){var E=S._plots[w].shapelayer;E&&E.selectAll("path").remove()}for(var k=0;k<S.shapes.length;k++)S.shapes[k].visible&&y(A,k)}function g(A){return!!A._fullLayout._drawing}function p(A){return!A._context.edits.shapePosition}function y(A,S){A._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+S+'"]').remove();var w=n.makeOptionsAndPlotinfo(A,S),E=w.options,k=w.plotinfo;E._input&&E.visible!==!1&&(E.layer!=="below"?L(A._fullLayout._shapeUpperLayer):E.xref==="paper"||E.yref==="paper"?L(A._fullLayout._shapeLowerLayer):k._hadPlotinfo?L((k.mainplotinfo||k).shapelayer):L(A._fullLayout._shapeLowerLayer));function L(M){var P=b(A,E),D={"data-index":S,"fill-rule":E.fillrule,d:P},N=E.opacity,U=E.fillcolor,G=E.line.width?E.line.color:"rgba(0,0,0,0)",X=E.line.width,K=E.line.dash;X||E.editable!==!0||(X=5,K="solid");var Z=P[P.length-1]!=="Z",H=p(A)&&E.editable&&A._fullLayout._activeShapeIndex===S;H&&(U=Z?"rgba(0,0,0,0)":A._fullLayout.activeshape.fillcolor,N=A._fullLayout.activeshape.opacity);var Y,$=M.append("path").attr(D).style("opacity",N).call(l.stroke,G).call(l.fill,U).call(o.dashLine,K,X);if(v($,A,E),(H||A._context.edits.shapePosition)&&(Y=u(A.layout,"shapes",E)),H){$.style({cursor:"move"});var z={element:$.node(),plotinfo:k,gd:A,editHelpers:Y,isActiveShape:!0},j=h(P,A);e(j,$,z)}else A._context.edits.shapePosition?function(W,ee,J,Q,te,ie){var ae,he,se,de,ue,ve,ke,Ee,be,xe,ce,ge,we,Me,Se,ze,Fe=J.xsizemode==="pixel",Ye=J.ysizemode==="pixel",rt=J.type==="line",Oe=J.type==="path",je=ie.modifyItem,We=m.getFromId(W,J.xref),qe=m.getRefType(J.xref),et=m.getFromId(W,J.yref),st=m.getRefType(J.yref),ct=n.getDataToPixel(W,We,!1,qe),Pt=n.getDataToPixel(W,et,!0,st),kt=n.getPixelToData(W,We,!1,qe),at=n.getPixelToData(W,et,!0,st),tt=rt?function(){var Ke=Math.max(J.line.width,10),_e=te.append("g").attr("data-index",Q);_e.append("path").attr("d",ee.attr("d")).style({cursor:"move","stroke-width":Ke,"stroke-opacity":"0"});var Ce={"fill-opacity":"0"},Le=Math.max(Ke/2,10);return _e.append("circle").attr({"data-line-point":"start-point",cx:Fe?ct(J.xanchor)+J.x0:ct(J.x0),cy:Ye?Pt(J.yanchor)-J.y0:Pt(J.y0),r:Le}).style(Ce).classed("cursor-grab",!0),_e.append("circle").attr({"data-line-point":"end-point",cx:Fe?ct(J.xanchor)+J.x1:ct(J.x1),cy:Ye?Pt(J.yanchor)-J.y1:Pt(J.y1),r:Le}).style(Ce).classed("cursor-grab",!0),_e}():ee,_t={element:tt.node(),gd:W,prepFn:function(Ke){g(W)||(Fe&&(ue=ct(J.xanchor)),Ye&&(ve=Pt(J.yanchor)),J.type==="path"?Se=J.path:(ae=Fe?J.x0:ct(J.x0),he=Ye?J.y0:Pt(J.y0),se=Fe?J.x1:ct(J.x1),de=Ye?J.y1:Pt(J.y1)),ae<se?(be=ae,we="x0",xe=se,Me="x1"):(be=se,we="x1",xe=ae,Me="x0"),!Ye&&he<de||Ye&&he>de?(ke=he,ce="y0",Ee=de,ge="y1"):(ke=de,ce="y1",Ee=he,ge="y0"),er(Ke),He(te,J),function(_e,Ce,Le){var Pe=Ce.xref,Xe=Ce.yref,ht=m.getFromId(Le,Pe),Mt=m.getFromId(Le,Xe),pt="";Pe==="paper"||ht.autorange||(pt+=Pe),Xe==="paper"||Mt.autorange||(pt+=Xe),o.setClipUrl(_e,pt?"clip"+Le._fullLayout._uid+pt:null,Le)}(ee,J,W),_t.moveFn=ze==="move"?tr:Ue,_t.altKey=Ke.altKey)},doneFn:function(){g(W)||(i(ee),Be(te),v(ee,W,J),t.call("_guiRelayout",W,ie.getUpdateObj()))},clickFn:function(){g(W)||Be(te)}};function er(Ke){if(g(W))ze=null;else if(rt)ze=Ke.target.tagName==="path"?"move":Ke.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point";else{var _e=_t.element.getBoundingClientRect(),Ce=_e.right-_e.left,Le=_e.bottom-_e.top,Pe=Ke.clientX-_e.left,Xe=Ke.clientY-_e.top,ht=!Oe&&Ce>10&&Le>10&&!Ke.shiftKey?s.getCursor(Pe/Ce,1-Xe/Le):"move";i(ee,ht),ze=ht.split("-")[0]}}function tr(Ke,_e){if(J.type==="path"){var Ce=function(Xe){return Xe},Le=Ce,Pe=Ce;Fe?je("xanchor",J.xanchor=kt(ue+Ke)):(Le=function(Xe){return kt(ct(Xe)+Ke)},We&&We.type==="date"&&(Le=n.encodeDate(Le))),Ye?je("yanchor",J.yanchor=at(ve+_e)):(Pe=function(Xe){return at(Pt(Xe)+_e)},et&&et.type==="date"&&(Pe=n.encodeDate(Pe))),je("path",J.path=x(Se,Le,Pe))}else Fe?je("xanchor",J.xanchor=kt(ue+Ke)):(je("x0",J.x0=kt(ae+Ke)),je("x1",J.x1=kt(se+Ke))),Ye?je("yanchor",J.yanchor=at(ve+_e)):(je("y0",J.y0=at(he+_e)),je("y1",J.y1=at(de+_e)));ee.attr("d",b(W,J)),He(te,J)}function Ue(Ke,_e){if(Oe){var Ce=function(Ie){return Ie},Le=Ce,Pe=Ce;Fe?je("xanchor",J.xanchor=kt(ue+Ke)):(Le=function(Ie){return kt(ct(Ie)+Ke)},We&&We.type==="date"&&(Le=n.encodeDate(Le))),Ye?je("yanchor",J.yanchor=at(ve+_e)):(Pe=function(Ie){return at(Pt(Ie)+_e)},et&&et.type==="date"&&(Pe=n.encodeDate(Pe))),je("path",J.path=x(Se,Le,Pe))}else if(rt){if(ze==="resize-over-start-point"){var Xe=ae+Ke,ht=Ye?he-_e:he+_e;je("x0",J.x0=Fe?Xe:kt(Xe)),je("y0",J.y0=Ye?ht:at(ht))}else if(ze==="resize-over-end-point"){var Mt=se+Ke,pt=Ye?de-_e:de+_e;je("x1",J.x1=Fe?Mt:kt(Mt)),je("y1",J.y1=Ye?pt:at(pt))}}else{var Lt=function(Ie){return ze.indexOf(Ie)!==-1},vt=Lt("n"),Dt=Lt("s"),xt=Lt("w"),it=Lt("e"),St=vt?ke+_e:ke,Nt=Dt?Ee+_e:Ee,Ut=xt?be+Ke:be,Qt=it?xe+Ke:xe;Ye&&(vt&&(St=ke-_e),Dt&&(Nt=Ee-_e)),(!Ye&&Nt-St>10||Ye&&St-Nt>10)&&(je(ce,J[ce]=Ye?St:at(St)),je(ge,J[ge]=Ye?Nt:at(Nt))),Qt-Ut>10&&(je(we,J[we]=Fe?Ut:kt(Ut)),je(Me,J[Me]=Fe?Qt:kt(Qt)))}ee.attr("d",b(W,J)),He(te,J)}function He(Ke,_e){(Fe||Ye)&&function(){var Ce=_e.type!=="path",Le=Ke.selectAll(".visual-cue").data([0]);Le.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":1}).classed("visual-cue",!0);var Pe=ct(Fe?_e.xanchor:d.midRange(Ce?[_e.x0,_e.x1]:n.extractPathCoords(_e.path,c.paramIsX))),Xe=Pt(Ye?_e.yanchor:d.midRange(Ce?[_e.y0,_e.y1]:n.extractPathCoords(_e.path,c.paramIsY)));if(Pe=n.roundPositionForSharpStrokeRendering(Pe,1),Xe=n.roundPositionForSharpStrokeRendering(Xe,1),Fe&&Ye){var ht="M"+(Pe-1-1)+","+(Xe-1-1)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";Le.attr("d",ht)}else if(Fe){var Mt="M"+(Pe-1-1)+","+(Xe-9-1)+"v18 h2 v-18 Z";Le.attr("d",Mt)}else{var pt="M"+(Pe-9-1)+","+(Xe-1-1)+"h18 v2 h-18 Z";Le.attr("d",pt)}}()}function Be(Ke){Ke.selectAll(".visual-cue").remove()}s.init(_t),tt.node().onmousemove=er}(A,$,E,S,M,Y):E.editable===!0&&$.style("pointer-events",Z||l.opacity(U)*N<=.5?"stroke":"all");$.node().addEventListener("click",function(){return function(W,ee){if(!!p(W)){var J=+ee.node().getAttribute("data-index");if(J>=0){if(J===W._fullLayout._activeShapeIndex)return void T(W);W._fullLayout._activeShapeIndex=J,W._fullLayout._deactivateShape=T,a(W)}}}(A,$)})}}function v(A,S,w){var E=(w.xref+w.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");o.setClipUrl(A,E?"clip"+S._fullLayout._uid+E:null,S)}function b(A,S){var w,E,k,L,M,P,D,N,U=S.type,G=m.getRefType(S.xref),X=m.getRefType(S.yref),K=m.getFromId(A,S.xref),Z=m.getFromId(A,S.yref),H=A._fullLayout._size;if(K?G==="domain"?E=function(te){return K._offset+K._length*te}:(w=n.shapePositionToRange(K),E=function(te){return K._offset+K.r2p(w(te,!0))}):E=function(te){return H.l+H.w*te},Z?X==="domain"?L=function(te){return Z._offset+Z._length*(1-te)}:(k=n.shapePositionToRange(Z),L=function(te){return Z._offset+Z.r2p(k(te,!0))}):L=function(te){return H.t+H.h*(1-te)},U==="path")return K&&K.type==="date"&&(E=n.decodeDate(E)),Z&&Z.type==="date"&&(L=n.decodeDate(L)),function(te,ie,ae){var he=te.path,se=te.xsizemode,de=te.ysizemode,ue=te.xanchor,ve=te.yanchor;return he.replace(c.segmentRE,function(ke){var Ee=0,be=ke.charAt(0),xe=c.paramIsX[be],ce=c.paramIsY[be],ge=c.numParams[be],we=ke.substr(1).replace(c.paramRE,function(Me){return xe[Ee]?Me=se==="pixel"?ie(ue)+Number(Me):ie(Me):ce[Ee]&&(Me=de==="pixel"?ae(ve)-Number(Me):ae(Me)),++Ee>ge&&(Me="X"),Me});return Ee>ge&&(we=we.replace(/[\s,]*X.*/,""),d.log("Ignoring extra params in segment "+ke)),be+we})}(S,E,L);if(S.xsizemode==="pixel"){var Y=E(S.xanchor);M=Y+S.x0,P=Y+S.x1}else M=E(S.x0),P=E(S.x1);if(S.ysizemode==="pixel"){var $=L(S.yanchor);D=$-S.y0,N=$-S.y1}else D=L(S.y0),N=L(S.y1);if(U==="line")return"M"+M+","+D+"L"+P+","+N;if(U==="rect")return"M"+M+","+D+"H"+P+"V"+N+"H"+M+"Z";var z=(M+P)/2,j=(D+N)/2,W=Math.abs(z-M),ee=Math.abs(j-D),J="A"+W+","+ee,Q=z+W+","+j;return"M"+Q+J+" 0 1,1 "+(z+","+(j-ee))+J+" 0 0,1 "+Q+"Z"}function x(A,S,w){return A.replace(c.segmentRE,function(E){var k=0,L=E.charAt(0),M=c.paramIsX[L],P=c.paramIsY[L],D=c.numParams[L];return L+E.substr(1).replace(c.paramRE,function(N){return k>=D||(M[k]?N=S(N):P[k]&&(N=w(N)),k++),N})})}function T(A){p(A)&&A._fullLayout._activeShapeIndex>=0&&(f(A),delete A._fullLayout._activeShapeIndex,a(A))}I.exports={draw:a,drawOne:y,eraseActiveShape:function(A){if(!!p(A)){f(A);var S=A._fullLayout._activeShapeIndex,w=(A.layout||{}).shapes||[];if(S<w.length){for(var E=[],k=0;k<w.length;k++)k!==S&&E.push(w[k]);delete A._fullLayout._activeShapeIndex,t.call("_guiRelayout",A,{shapes:E})}}}}},{"../../lib":787,"../../lib/setcursor":808,"../../plot_api/plot_template":827,"../../plots/cartesian/axes":838,"../../plots/cartesian/handle_outline":849,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"./constants":732,"./draw_newshape/display_outlines":738,"./draw_newshape/helpers":739,"./helpers":741}],735:[function(r,I,B){var t=r("../../drawing/attributes").dash,d=r("../../../lib/extend").extendFlat;I.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:d({},t,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":777,"../../drawing/attributes":671}],736:[function(r,I,B){I.exports={CIRCLE_SIDES:32,i000:0,i090:8,i180:16,i270:24,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],737:[function(r,I,B){var t=r("../../color");I.exports=function(d,m,h){if(h("newshape.drawdirection"),h("newshape.layer"),h("newshape.fillcolor"),h("newshape.fillrule"),h("newshape.opacity"),h("newshape.line.width")){var e=(d||{}).plot_bgcolor||"#FFF";h("newshape.line.color",t.contrast(e)),h("newshape.line.dash")}h("activeshape.fillcolor"),h("activeshape.opacity")}},{"../../color":650}],738:[function(r,I,B){var t=r("../../dragelement"),d=r("../../dragelement/helpers").drawMode,m=r("../../../registry"),h=r("./constants"),e=h.i000,f=h.i090,l=h.i180,o=h.i270,u=r("../../../plots/cartesian/handle_outline").clearOutlineControllers,s=r("./helpers"),i=s.pointsShapeRectangle,c=s.pointsShapeEllipse,n=s.writePaths,a=r("./newshapes");I.exports=function g(p,y,v,b){b||(b=0);var x=v.gd;function T(){g(p,y,v,b++),c(p[0])&&A({redrawing:!0})}function A(Y){v.isActiveShape=!1;var $=a(y,v);Object.keys($).length&&m.call((Y||{}).redrawing?"relayout":"_guiRelayout",x,$)}var S,w,E,k,L,M=v.isActiveShape,P=x._fullLayout._zoomlayer,D=v.dragmode;d(D)?x._fullLayout._drawing=!0:x._fullLayout._activeShapeIndex>=0&&u(x),y.attr("d",n(p)),M&&!b&&(L=function(Y,$){for(var z=0;z<$.length;z++){var j=$[z];Y[z]=[];for(var W=0;W<j.length;W++){Y[z][W]=[];for(var ee=0;ee<j[W].length;ee++)Y[z][W][ee]=j[W][ee]}}return Y}([],p),function(Y){S=[];for(var $=0;$<p.length;$++){var z=p[$],j=!i(z)&&c(z);S[$]=[];for(var W=0;W<z.length;W++)if(z[W][0]!=="Z"&&(!j||W===e||W===f||W===l||W===o)){var ee=z[W][1],J=z[W][2],Q=Y.append("circle").classed("cursor-grab",!0).attr("data-i",$).attr("data-j",W).attr("cx",ee).attr("cy",J).attr("r",4).style({"mix-blend-mode":"luminosity",fill:"black",stroke:"white","stroke-width":1});S[$][W]={element:Q.node(),gd:x,prepFn:N,doneFn:G,clickFn:X},t.init(S[$][W])}}}(P.append("g").attr("class","outline-controllers")),function(){w=[],!!p.length&&(w[0]={element:y[0][0],gd:x,prepFn:Z,doneFn:H},t.init(w[0]))}());function N(Y){E=+Y.srcElement.getAttribute("data-i"),k=+Y.srcElement.getAttribute("data-j"),S[E][k].moveFn=U}function U(Y,$){if(p.length){var z=L[E][k][1],j=L[E][k][2],W=p[E],ee=W.length;if(i(W)){for(var J=0;J<ee;J++)if(J!==k){var Q=W[J];Q[1]===W[k][1]&&(Q[1]=z+Y),Q[2]===W[k][2]&&(Q[2]=j+$)}if(W[k][1]=z+Y,W[k][2]=j+$,!i(W))for(var te=0;te<ee;te++)for(var ie=0;ie<W[te].length;ie++)W[te][ie]=L[E][te][ie]}else W[k][1]=z+Y,W[k][2]=j+$;T()}}function G(){A()}function X(Y,$){if(Y===2){E=+$.srcElement.getAttribute("data-i"),k=+$.srcElement.getAttribute("data-j");var z=p[E];i(z)||c(z)||function(){if(p.length&&p[E]&&p[E].length){for(var j=[],W=0;W<p[E].length;W++)W!==k&&j.push(p[E][W]);j.length>1&&(j.length!==2||j[1][0]!=="Z")&&(k===0&&(j[0][0]="M"),p[E]=j,T(),A())}}()}}function K(Y,$){(function(z,j){if(p.length)for(var W=0;W<p.length;W++)for(var ee=0;ee<p[W].length;ee++)for(var J=0;J+2<p[W][ee].length;J+=2)p[W][ee][J+1]=L[W][ee][J+1]+z,p[W][ee][J+2]=L[W][ee][J+2]+j})(Y,$),T()}function Z(Y){(E=+Y.srcElement.getAttribute("data-i"))||(E=0),w[E].moveFn=K}function H(){A()}}},{"../../../plots/cartesian/handle_outline":849,"../../../registry":915,"../../dragelement":669,"../../dragelement/helpers":668,"./constants":736,"./helpers":739,"./newshapes":740}],739:[function(r,I,B){var t=r("parse-svg-path"),d=r("./constants"),m=d.CIRCLE_SIDES,h=d.SQRT2,e=r("../../../plots/cartesian/helpers"),f=e.p2r,l=e.r2p,o=[0,3,4,5,6,1,2],u=[0,3,4,1,2];function s(c,n){return Math.abs(c-n)<=1e-6}function i(c,n){var a=n[1]-c[1],g=n[2]-c[2];return Math.sqrt(a*a+g*g)}B.writePaths=function(c){var n=c.length;if(!n)return"M0,0Z";for(var a="",g=0;g<n;g++)for(var p=c[g].length,y=0;y<p;y++){var v=c[g][y][0];if(v==="Z")a+="Z";else for(var b=c[g][y].length,x=0;x<b;x++){var T=x;v==="Q"||v==="S"?T=u[x]:v==="C"&&(T=o[x]),a+=c[g][y][T],x>0&&x<b-1&&(a+=",")}}return a},B.readPaths=function(c,n,a,g){var p,y,v,b=t(c),x=[],T=-1,A=0,S=0,w=function(){y=A,v=S};w();for(var E=0;E<b.length;E++){var k,L,M,P,D=[],N=b[E][0],U=N;switch(N){case"M":T++,x[T]=[],A=+b[E][1],S=+b[E][2],D.push([U,A,S]),w();break;case"Q":case"S":k=+b[E][1],M=+b[E][2],A=+b[E][3],S=+b[E][4],D.push([U,A,S,k,M]);break;case"C":k=+b[E][1],M=+b[E][2],L=+b[E][3],P=+b[E][4],A=+b[E][5],S=+b[E][6],D.push([U,A,S,k,M,L,P]);break;case"T":case"L":A=+b[E][1],S=+b[E][2],D.push([U,A,S]);break;case"H":U="L",A=+b[E][1],D.push([U,A,S]);break;case"V":U="L",S=+b[E][1],D.push([U,A,S]);break;case"A":U="L";var G=+b[E][1],X=+b[E][2];+b[E][4]||(G=-G,X=-X);var K=A-G,Z=S;for(p=1;p<=m/2;p++){var H=2*Math.PI*p/m;D.push([U,K+G*Math.cos(H),Z+X*Math.sin(H)])}break;case"Z":A===y&&S===v||(A=y,S=v,D.push([U,A,S]))}for(var Y=(a||{}).domain,$=n._fullLayout._size,z=a&&a.xsizemode==="pixel",j=a&&a.ysizemode==="pixel",W=g===!1,ee=0;ee<D.length;ee++){for(p=0;p+2<7;p+=2){var J=D[ee][p+1],Q=D[ee][p+2];J!==void 0&&Q!==void 0&&(A=J,S=Q,a&&(a.xaxis&&a.xaxis.p2r?(W&&(J-=a.xaxis._offset),J=z?l(a.xaxis,a.xanchor)+J:f(a.xaxis,J)):(W&&(J-=$.l),Y?J=Y.x[0]+J/$.w:J/=$.w),a.yaxis&&a.yaxis.p2r?(W&&(Q-=a.yaxis._offset),Q=j?l(a.yaxis,a.yanchor)-Q:f(a.yaxis,Q)):(W&&(Q-=$.t),Q=Y?Y.y[1]-Q/$.h:1-Q/$.h)),D[ee][p+1]=J,D[ee][p+2]=Q)}x[T].push(D[ee].slice())}}return x},B.pointsShapeRectangle=function(c){if(c.length!==5)return!1;for(var n=1;n<3;n++)if(!s(c[0][n]-c[1][n],c[3][n]-c[2][n])||!s(c[0][n]-c[3][n],c[1][n]-c[2][n]))return!1;return!(!s(c[0][1],c[1][1])&&!s(c[0][1],c[3][1]))&&!!(i(c[0],c[1])*i(c[0],c[3]))},B.pointsShapeEllipse=function(c){var n=c.length;if(n!==m+1)return!1;n=m;for(var a=0;a<n;a++){var g=(2*n-a)%n,p=(n/2+g)%n,y=(n/2+a)%n;if(!s(i(c[a],c[y]),i(c[g],c[p])))return!1}return!0},B.handleEllipse=function(c,n,a){if(!c)return[n,a];var g=B.ellipseOver({x0:n[0],y0:n[1],x1:a[0],y1:a[1]}),p=(g.x1+g.x0)/2,y=(g.y1+g.y0)/2,v=(g.x1-g.x0)/2,b=(g.y1-g.y0)/2;v||(v=b/=h),b||(b=v/=h);for(var x=[],T=0;T<m;T++){var A=2*T*Math.PI/m;x.push([p+v*Math.cos(A),y+b*Math.sin(A)])}return x},B.ellipseOver=function(c){var n=c.x0,a=c.y0,g=c.x1,p=c.y1,y=g-n,v=p-a,b=((n-=y)+g)/2,x=((a-=v)+p)/2;return{x0:b-(y*=h),y0:x-(v*=h),x1:b+y,y1:x+v}}},{"../../../plots/cartesian/helpers":850,"./constants":736,"parse-svg-path":482}],740:[function(r,I,B){var t=r("../../dragelement/helpers"),d=t.drawMode,m=t.openMode,h=r("./constants"),e=h.i000,f=h.i090,l=h.i180,o=h.i270,u=h.cos45,s=h.sin45,i=r("../../../plots/cartesian/helpers"),c=i.p2r,n=i.r2p,a=r("../../../plots/cartesian/handle_outline").clearSelect,g=r("./helpers"),p=g.readPaths,y=g.writePaths,v=g.ellipseOver;I.exports=function(b,x){if(b.length){var T=b[0][0];if(T){var A=T.getAttribute("d"),S=x.gd,w=S._fullLayout.newshape,E=x.plotinfo,k=E.xaxis,L=E.yaxis,M=!!E.domain||!E.xaxis,P=!!E.domain||!E.yaxis,D=x.isActiveShape,N=x.dragmode,U=(S.layout||{}).shapes||[];if(!d(N)&&D!==void 0){var G=S._fullLayout._activeShapeIndex;if(G<U.length)switch(S._fullLayout.shapes[G].type){case"rect":N="drawrect";break;case"circle":N="drawcircle";break;case"line":N="drawline";break;case"path":var X=U[G].path||"";N=X[X.length-1]==="Z"?"drawclosedpath":"drawopenpath"}}var K,Z=m(N),H=p(A,S,E,D),Y={editable:!0,xref:M?"paper":k._id,yref:P?"paper":L._id,layer:w.layer,opacity:w.opacity,line:{color:w.line.color,width:w.line.width,dash:w.line.dash}};if(Z||(Y.fillcolor=w.fillcolor,Y.fillrule=w.fillrule),H.length===1&&(K=H[0]),K&&N==="drawrect")Y.type="rect",Y.x0=K[0][1],Y.y0=K[0][2],Y.x1=K[2][1],Y.y1=K[2][2];else if(K&&N==="drawline")Y.type="line",Y.x0=K[0][1],Y.y0=K[0][2],Y.x1=K[1][1],Y.y1=K[1][2];else if(K&&N==="drawcircle"){Y.type="circle";var $=K[e][1],z=K[f][1],j=K[l][1],W=K[o][1],ee=K[e][2],J=K[f][2],Q=K[l][2],te=K[o][2],ie=E.xaxis&&(E.xaxis.type==="date"||E.xaxis.type==="log"),ae=E.yaxis&&(E.yaxis.type==="date"||E.yaxis.type==="log");ie&&($=n(E.xaxis,$),z=n(E.xaxis,z),j=n(E.xaxis,j),W=n(E.xaxis,W)),ae&&(ee=n(E.yaxis,ee),J=n(E.yaxis,J),Q=n(E.yaxis,Q),te=n(E.yaxis,te));var he=(z+W)/2,se=(ee+Q)/2,de=v({x0:he,y0:se,x1:he+(W-z+j-$)/2*u,y1:se+(te-J+Q-ee)/2*s});ie&&(de.x0=c(E.xaxis,de.x0),de.x1=c(E.xaxis,de.x1)),ae&&(de.y0=c(E.yaxis,de.y0),de.y1=c(E.yaxis,de.y1)),Y.x0=de.x0,Y.y0=de.y0,Y.x1=de.x1,Y.y1=de.y1}else Y.type="path",k&&L&&function(ce,ge,we){var Me=ge.type==="date",Se=we.type==="date";if(!Me&&!Se)return ce;for(var ze=0;ze<ce.length;ze++)for(var Fe=0;Fe<ce[ze].length;Fe++)for(var Ye=0;Ye+2<ce[ze][Fe].length;Ye+=2)Me&&(ce[ze][Fe][Ye+1]=ce[ze][Fe][Ye+1].replace(" ","_")),Se&&(ce[ze][Fe][Ye+2]=ce[ze][Fe][Ye+2].replace(" ","_"))}(H,k,L),Y.path=y(H),K=null;a(S);for(var ue=x.editHelpers,ve=(ue||{}).modifyItem,ke=[],Ee=0;Ee<U.length;Ee++){var be=S._fullLayout.shapes[Ee];if(ke[Ee]=be._input,D!==void 0&&Ee===S._fullLayout._activeShapeIndex){var xe=Y;switch(be.type){case"line":case"rect":case"circle":ve("x0",xe.x0),ve("x1",xe.x1),ve("y0",xe.y0),ve("y1",xe.y1);break;case"path":ve("path",xe.path)}}}return D===void 0?(ke.push(Y),ke):ue?ue.getUpdateObj():{}}}}},{"../../../plots/cartesian/handle_outline":849,"../../../plots/cartesian/helpers":850,"../../dragelement/helpers":668,"./constants":736,"./helpers":739}],741:[function(r,I,B){var t=r("./constants"),d=r("../../lib");B.rangeToShapePosition=function(m){return m.type==="log"?m.r2d:function(h){return h}},B.shapePositionToRange=function(m){return m.type==="log"?m.d2r:function(h){return h}},B.decodeDate=function(m){return function(h){return h.replace&&(h=h.replace("_"," ")),m(h)}},B.encodeDate=function(m){return function(h){return m(h).replace(" ","_")}},B.extractPathCoords=function(m,h){var e=[];return m.match(t.segmentRE).forEach(function(f){var l=h[f.charAt(0)].drawn;if(l!==void 0){var o=f.substr(1).match(t.paramRE);!o||o.length<l||e.push(d.cleanNumber(o[l]))}}),e},B.getDataToPixel=function(m,h,e,f){var l,o=m._fullLayout._size;if(h)if(f==="domain")l=function(s){return h._length*(e?1-s:s)+h._offset};else{var u=B.shapePositionToRange(h);l=function(s){return h._offset+h.r2p(u(s,!0))},h.type==="date"&&(l=B.decodeDate(l))}else l=e?function(s){return o.t+o.h*(1-s)}:function(s){return o.l+o.w*s};return l},B.getPixelToData=function(m,h,e,f){var l,o=m._fullLayout._size;if(h)if(f==="domain")l=function(s){var i=(s-h._offset)/h._length;return e?1-i:i};else{var u=B.rangeToShapePosition(h);l=function(s){return u(h.p2r(s-h._offset))}}else l=e?function(s){return 1-(s-o.t)/o.h}:function(s){return(s-o.l)/o.w};return l},B.roundPositionForSharpStrokeRendering=function(m,h){var e=Math.round(h%2)===1,f=Math.round(m);return e?f+.5:f},B.makeOptionsAndPlotinfo=function(m,h){var e=m._fullLayout.shapes[h]||{},f=m._fullLayout._plots[e.xref+e.yref];return f?f._hadPlotinfo=!0:(f={},e.xref&&e.xref!=="paper"&&(f.xaxis=m._fullLayout[e.xref+"axis"]),e.yref&&e.yref!=="paper"&&(f.yaxis=m._fullLayout[e.yref+"axis"])),f.xsizemode=e.xsizemode,f.ysizemode=e.ysizemode,f.xanchor=e.xanchor,f.yanchor=e.yanchor,{options:e,plotinfo:f}}},{"../../lib":787,"./constants":732}],742:[function(r,I,B){var t=r("./draw");I.exports={moduleType:"component",name:"shapes",layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),supplyDrawNewShapeDefaults:r("./draw_newshape/defaults"),includeBasePlot:r("../../plots/cartesian/include_components")("shapes"),calcAutorange:r("./calc_autorange"),draw:t.draw,drawOne:t.drawOne}},{"../../plots/cartesian/include_components":851,"./attributes":730,"./calc_autorange":731,"./defaults":733,"./draw":734,"./draw_newshape/defaults":737}],743:[function(r,I,B){var t=r("../../plots/font_attributes"),d=r("../../plots/pad_attributes"),m=r("../../lib/extend").extendDeepAll,h=r("../../plot_api/edit_types").overrideAll,e=r("../../plots/animation_attributes"),f=r("../../plot_api/plot_template").templatedArray,l=r("./constants"),o=f("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});I.exports=h(f("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:o,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:m(d({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:t({})},font:t({}),activebgcolor:{valType:"color",dflt:l.gripBgActiveColor},bgcolor:{valType:"color",dflt:l.railBgColor},bordercolor:{valType:"color",dflt:l.railBorderColor},borderwidth:{valType:"number",min:0,dflt:l.railBorderWidth},ticklen:{valType:"number",min:0,dflt:l.tickLength},tickcolor:{valType:"color",dflt:l.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:l.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../plots/animation_attributes":832,"../../plots/font_attributes":867,"../../plots/pad_attributes":900,"./constants":744}],744:[function(r,I,B){I.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],745:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/array_container_defaults"),m=r("./attributes"),h=r("./constants").name,e=m.steps;function f(o,u,s){function i(p,y){return t.coerce(o,u,m,p,y)}for(var c=d(o,u,{name:"steps",handleItemDefaults:l}),n=0,a=0;a<c.length;a++)c[a].visible&&n++;if(n<2?u.visible=!1:i("visible")){u._stepCount=n;var g=u._visibleSteps=t.filterVisible(c);(c[i("active")]||{}).visible||(u.active=g[0]._index),i("x"),i("y"),t.noneOrAll(o,u,["x","y"]),i("xanchor"),i("yanchor"),i("len"),i("lenmode"),i("pad.t"),i("pad.r"),i("pad.b"),i("pad.l"),t.coerceFont(i,"font",s.font),i("currentvalue.visible")&&(i("currentvalue.xanchor"),i("currentvalue.prefix"),i("currentvalue.suffix"),i("currentvalue.offset"),t.coerceFont(i,"currentvalue.font",u.font)),i("transition.duration"),i("transition.easing"),i("bgcolor"),i("activebgcolor"),i("bordercolor"),i("borderwidth"),i("ticklen"),i("tickwidth"),i("tickcolor"),i("minorticklen")}}function l(o,u){function s(c,n){return t.coerce(o,u,e,c,n)}if(o.method==="skip"||Array.isArray(o.args)?s("visible"):u.visible=!1){s("method"),s("args");var i=s("label","step-"+u._index);s("value",i),s("execute")}}I.exports=function(o,u){d(o,u,{name:h,handleItemDefaults:f})}},{"../../lib":787,"../../plots/array_container_defaults":833,"./attributes":743,"./constants":744}],746:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../plots/plots"),m=r("../color"),h=r("../drawing"),e=r("../../lib"),f=e.strTranslate,l=r("../../lib/svg_text_utils"),o=r("../../plot_api/plot_template").arrayEditor,u=r("./constants"),s=r("../../constants/alignment"),i=s.LINE_SPACING,c=s.FROM_TL,n=s.FROM_BR;function a(D){return u.autoMarginIdRoot+D._index}function g(D){return D._index}function p(D,N){var U=h.tester.selectAll("g."+u.labelGroupClass).data(N._visibleSteps);U.enter().append("g").classed(u.labelGroupClass,!0);var G=0,X=0;U.each(function(ee){var J=b(t.select(this),{step:ee},N).node();if(J){var Q=h.bBox(J);X=Math.max(X,Q.height),G=Math.max(G,Q.width)}}),U.remove();var K=N._dims={};K.inputAreaWidth=Math.max(u.railWidth,u.gripHeight);var Z=D._fullLayout._size;K.lx=Z.l+Z.w*N.x,K.ly=Z.t+Z.h*(1-N.y),N.lenmode==="fraction"?K.outerLength=Math.round(Z.w*N.len):K.outerLength=N.len,K.inputAreaStart=0,K.inputAreaLength=Math.round(K.outerLength-N.pad.l-N.pad.r);var H=(K.inputAreaLength-2*u.stepInset)/(N._stepCount-1),Y=G+u.labelPadding;if(K.labelStride=Math.max(1,Math.ceil(Y/H)),K.labelHeight=X,K.currentValueMaxWidth=0,K.currentValueHeight=0,K.currentValueTotalHeight=0,K.currentValueMaxLines=1,N.currentvalue.visible){var $=h.tester.append("g");U.each(function(ee){var J=y($,N,ee.label),Q=J.node()&&h.bBox(J.node())||{width:0,height:0},te=l.lineCount(J);K.currentValueMaxWidth=Math.max(K.currentValueMaxWidth,Math.ceil(Q.width)),K.currentValueHeight=Math.max(K.currentValueHeight,Math.ceil(Q.height)),K.currentValueMaxLines=Math.max(K.currentValueMaxLines,te)}),K.currentValueTotalHeight=K.currentValueHeight+N.currentvalue.offset,$.remove()}K.height=K.currentValueTotalHeight+u.tickOffset+N.ticklen+u.labelOffset+K.labelHeight+N.pad.t+N.pad.b;var z="left";e.isRightAnchor(N)&&(K.lx-=K.outerLength,z="right"),e.isCenterAnchor(N)&&(K.lx-=K.outerLength/2,z="center");var j="top";e.isBottomAnchor(N)&&(K.ly-=K.height,j="bottom"),e.isMiddleAnchor(N)&&(K.ly-=K.height/2,j="middle"),K.outerLength=Math.ceil(K.outerLength),K.height=Math.ceil(K.height),K.lx=Math.round(K.lx),K.ly=Math.round(K.ly);var W={y:N.y,b:K.height*n[j],t:K.height*c[j]};N.lenmode==="fraction"?(W.l=0,W.xl=N.x-N.len*c[z],W.r=0,W.xr=N.x+N.len*n[z]):(W.x=N.x,W.l=K.outerLength*c[z],W.r=K.outerLength*n[z]),d.autoMargin(D,a(N),W)}function y(D,N,U){if(N.currentvalue.visible){var G,X,K=N._dims;switch(N.currentvalue.xanchor){case"right":G=K.inputAreaLength-u.currentValueInset-K.currentValueMaxWidth,X="left";break;case"center":G=.5*K.inputAreaLength,X="middle";break;default:G=u.currentValueInset,X="left"}var Z=e.ensureSingle(D,"text",u.labelClass,function(W){W.attr({"text-anchor":X,"data-notex":1})}),H=N.currentvalue.prefix?N.currentvalue.prefix:"";if(typeof U=="string")H+=U;else{var Y=N.steps[N.active].label,$=N._gd._fullLayout._meta;$&&(Y=e.templateString(Y,$)),H+=Y}N.currentvalue.suffix&&(H+=N.currentvalue.suffix),Z.call(h.font,N.currentvalue.font).text(H).call(l.convertToTspans,N._gd);var z=l.lineCount(Z),j=(K.currentValueMaxLines+1-z)*N.currentvalue.font.size*i;return l.positionText(Z,G,j),Z}}function v(D,N,U){e.ensureSingle(D,"rect",u.gripRectClass,function(G){G.call(S,N,D,U).style("pointer-events","all")}).attr({width:u.gripWidth,height:u.gripHeight,rx:u.gripRadius,ry:u.gripRadius}).call(m.stroke,U.bordercolor).call(m.fill,U.bgcolor).style("stroke-width",U.borderwidth+"px")}function b(D,N,U){var G=e.ensureSingle(D,"text",u.labelClass,function(Z){Z.attr({"text-anchor":"middle","data-notex":1})}),X=N.step.label,K=U._gd._fullLayout._meta;return K&&(X=e.templateString(X,K)),G.call(h.font,U.font).text(X).call(l.convertToTspans,U._gd),G}function x(D,N){var U=e.ensureSingle(D,"g",u.labelsClass),G=N._dims,X=U.selectAll("g."+u.labelGroupClass).data(G.labelSteps);X.enter().append("g").classed(u.labelGroupClass,!0),X.exit().remove(),X.each(function(K){var Z=t.select(this);Z.call(b,K,N),h.setTranslate(Z,k(N,K.fraction),u.tickOffset+N.ticklen+N.font.size*i+u.labelOffset+G.currentValueTotalHeight)})}function T(D,N,U,G,X){var K=Math.round(G*(U._stepCount-1)),Z=U._visibleSteps[K]._index;Z!==U.active&&A(D,N,U,Z,!0,X)}function A(D,N,U,G,X,K){var Z=U.active;U.active=G,o(D.layout,u.name,U).applyUpdate("active",G);var H=U.steps[U.active];N.call(E,U,K),N.call(y,U),D.emit("plotly_sliderchange",{slider:U,step:U.steps[U.active],interaction:X,previousActive:Z}),H&&H.method&&X&&(N._nextMethod?(N._nextMethod.step=H,N._nextMethod.doCallback=X,N._nextMethod.doTransition=K):(N._nextMethod={step:H,doCallback:X,doTransition:K},N._nextMethodRaf=window.requestAnimationFrame(function(){var Y=N._nextMethod.step;Y.method&&(Y.execute&&d.executeAPICommand(D,Y.method,Y.args),N._nextMethod=null,N._nextMethodRaf=null)})))}function S(D,N,U){var G=U.node(),X=t.select(N);function K(){return U.data()[0]}function Z(){var H=K();N.emit("plotly_sliderstart",{slider:H});var Y=U.select("."+u.gripRectClass);t.event.stopPropagation(),t.event.preventDefault(),Y.call(m.fill,H.activebgcolor);var $=L(H,t.mouse(G)[0]);function z(){var W=K(),ee=L(W,t.mouse(G)[0]);T(N,U,W,ee,!1)}function j(){var W=K();W._dragging=!1,Y.call(m.fill,W.bgcolor),X.on("mouseup",null),X.on("mousemove",null),X.on("touchend",null),X.on("touchmove",null),N.emit("plotly_sliderend",{slider:W,step:W.steps[W.active]})}T(N,U,H,$,!0),H._dragging=!0,X.on("mousemove",z),X.on("touchmove",z),X.on("mouseup",j),X.on("touchend",j)}D.on("mousedown",Z),D.on("touchstart",Z)}function w(D,N){var U=D.selectAll("rect."+u.tickRectClass).data(N._visibleSteps),G=N._dims;U.enter().append("rect").classed(u.tickRectClass,!0),U.exit().remove(),U.attr({width:N.tickwidth+"px","shape-rendering":"crispEdges"}),U.each(function(X,K){var Z=K%G.labelStride==0,H=t.select(this);H.attr({height:Z?N.ticklen:N.minorticklen}).call(m.fill,N.tickcolor),h.setTranslate(H,k(N,K/(N._stepCount-1))-.5*N.tickwidth,(Z?u.tickOffset:u.minorTickOffset)+G.currentValueTotalHeight)})}function E(D,N,U){for(var G=D.select("rect."+u.gripRectClass),X=0,K=0;K<N._stepCount;K++)if(N._visibleSteps[K]._index===N.active){X=K;break}var Z=k(N,X/(N._stepCount-1));if(!N._invokingCommand){var H=G;U&&N.transition.duration>0&&(H=H.transition().duration(N.transition.duration).ease(N.transition.easing)),H.attr("transform",f(Z-.5*u.gripWidth,N._dims.currentValueTotalHeight))}}function k(D,N){var U=D._dims;return U.inputAreaStart+u.stepInset+(U.inputAreaLength-2*u.stepInset)*Math.min(1,Math.max(0,N))}function L(D,N){var U=D._dims;return Math.min(1,Math.max(0,(N-u.stepInset-U.inputAreaStart)/(U.inputAreaLength-2*u.stepInset-2*U.inputAreaStart)))}function M(D,N,U){var G=U._dims,X=e.ensureSingle(D,"rect",u.railTouchRectClass,function(K){K.call(S,N,D,U).style("pointer-events","all")});X.attr({width:G.inputAreaLength,height:Math.max(G.inputAreaWidth,u.tickOffset+U.ticklen+G.labelHeight)}).call(m.fill,U.bgcolor).attr("opacity",0),h.setTranslate(X,0,G.currentValueTotalHeight)}function P(D,N){var U=N._dims,G=U.inputAreaLength-2*u.railInset,X=e.ensureSingle(D,"rect",u.railRectClass);X.attr({width:G,height:u.railWidth,rx:u.railRadius,ry:u.railRadius,"shape-rendering":"crispEdges"}).call(m.stroke,N.bordercolor).call(m.fill,N.bgcolor).style("stroke-width",N.borderwidth+"px"),h.setTranslate(X,u.railInset,.5*(U.inputAreaWidth-u.railWidth)+U.currentValueTotalHeight)}I.exports=function(D){var N=D._fullLayout,U=function(Y,$){for(var z=Y[u.name],j=[],W=0;W<z.length;W++){var ee=z[W];ee.visible&&(ee._gd=$,j.push(ee))}return j}(N,D),G=N._infolayer.selectAll("g."+u.containerClassName).data(U.length>0?[0]:[]);function X(Y){Y._commandObserver&&(Y._commandObserver.remove(),delete Y._commandObserver),d.autoMargin(D,a(Y))}if(G.enter().append("g").classed(u.containerClassName,!0).style("cursor","ew-resize"),G.exit().each(function(){t.select(this).selectAll("g."+u.groupClassName).each(X)}).remove(),U.length!==0){var K=G.selectAll("g."+u.groupClassName).data(U,g);K.enter().append("g").classed(u.groupClassName,!0),K.exit().each(X).remove();for(var Z=0;Z<U.length;Z++){var H=U[Z];p(D,H)}K.each(function(Y){var $=t.select(this);(function(z){var j=z._dims;j.labelSteps=[];for(var W=z._stepCount,ee=0;ee<W;ee+=j.labelStride)j.labelSteps.push({fraction:ee/(W-1),step:z._visibleSteps[ee]})})(Y),d.manageCommandObserver(D,Y,Y._visibleSteps,function(z){var j=$.data()[0];j.active!==z.index&&(j._dragging||A(D,$,j,z.index,!1,!0))}),function(z,j,W){(W.steps[W.active]||{}).visible||(W.active=W._visibleSteps[0]._index),j.call(y,W).call(P,W).call(x,W).call(w,W).call(M,z,W).call(v,z,W);var ee=W._dims;h.setTranslate(j,ee.lx+W.pad.l,ee.ly+W.pad.t),j.call(E,W,!1),j.call(y,W)}(D,t.select(this),Y)})}}},{"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"../../plot_api/plot_template":827,"../../plots/plots":901,"../color":650,"../drawing":672,"./constants":744,"@plotly/d3":58}],747:[function(r,I,B){var t=r("./constants");I.exports={moduleType:"component",name:t.name,layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),draw:r("./draw")}},{"./attributes":743,"./constants":744,"./defaults":745,"./draw":746}],748:[function(r,I,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("../../plots/plots"),h=r("../../registry"),e=r("../../lib"),f=e.strTranslate,l=r("../drawing"),o=r("../color"),u=r("../../lib/svg_text_utils"),s=r("../../constants/interactions"),i=r("../../constants/alignment").OPPOSITE_SIDE,c=/ [XY][0-9]* /;I.exports={draw:function(n,a,g){var p,y=g.propContainer,v=g.propName,b=g.placeholder,x=g.traceIndex,T=g.avoid||{},A=g.attributes,S=g.transform,w=g.containerGroup,E=n._fullLayout,k=1,L=!1,M=y.title,P=(M&&M.text?M.text:"").trim(),D=M&&M.font?M.font:{},N=D.family,U=D.size,G=D.color;v==="title.text"?p="titleText":v.indexOf("axis")!==-1?p="axisTitleText":v.indexOf(!0)&&(p="colorbarTitleText");var X=n._context.edits[p];P===""?k=0:P.replace(c," % ")===b.replace(c," % ")&&(k=.2,L=!0,X||(P="")),g._meta?P=e.templateString(P,g._meta):E._meta&&(P=e.templateString(P,E._meta));var K=P||X;w||(w=e.ensureSingle(E._infolayer,"g","g-"+a));var Z=w.selectAll("text").data(K?[0]:[]);if(Z.enter().append("text"),Z.text(P).attr("class",a),Z.exit().remove(),!K)return w;function H(z){e.syncOrAsync([Y,$],z)}function Y(z){var j;return S?(j="",S.rotate&&(j+="rotate("+[S.rotate,A.x,A.y]+")"),S.offset&&(j+=f(0,S.offset))):j=null,z.attr("transform",j),z.style({"font-family":N,"font-size":t.round(U,2)+"px",fill:o.rgb(G),opacity:k*o.opacity(G),"font-weight":m.fontWeight}).attr(A).call(u.convertToTspans,n),m.previousPromises(n)}function $(z){var j=t.select(z.node().parentNode);if(T&&T.selection&&T.side&&P){j.attr("transform",null);var W=i[T.side],ee=T.side==="left"||T.side==="top"?-1:1,J=d(T.pad)?T.pad:2,Q=l.bBox(j.node()),te={left:0,top:0,right:E.width,bottom:E.height},ie=T.maxShift||ee*(te[T.side]-Q[T.side]),ae=0;if(ie<0)ae=ie;else{var he=T.offsetLeft||0,se=T.offsetTop||0;Q.left-=he,Q.right-=he,Q.top-=se,Q.bottom-=se,T.selection.each(function(){var ue=l.bBox(this);e.bBoxIntersect(Q,ue,J)&&(ae=Math.max(ae,ee*(ue[T.side]-Q[W])+J))}),ae=Math.min(ie,ae)}if(ae>0||ie<0){var de={left:[-ae,0],right:[ae,0],top:[0,-ae],bottom:[0,ae]}[T.side];j.attr("transform",f(de[0],de[1]))}}}return Z.call(H),X&&(P?Z.on(".opacity",null):(k=0,L=!0,Z.text(b).on("mouseover.opacity",function(){t.select(this).transition().duration(s.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){t.select(this).transition().duration(s.HIDE_PLACEHOLDER).style("opacity",0)})),Z.call(u.makeEditable,{gd:n}).on("edit",function(z){x!==void 0?h.call("_guiRestyle",n,v,z,x):h.call("_guiRelayout",n,v,z)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(H)}).on("input",function(z){this.text(z||" ").call(u.positionText,A.x,A.y)})),Z.classed("js-placeholder",L),w}}},{"../../constants/alignment":755,"../../constants/interactions":762,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/plots":901,"../../registry":915,"../color":650,"../drawing":672,"@plotly/d3":58,"fast-isnumeric":246}],749:[function(r,I,B){var t=r("../../plots/font_attributes"),d=r("../color/attributes"),m=r("../../lib/extend").extendFlat,h=r("../../plot_api/edit_types").overrideAll,e=r("../../plots/pad_attributes"),f=r("../../plot_api/plot_template").templatedArray,l=f("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});I.exports=h(f("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:l,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:m(e({editType:"arraydraw"}),{}),font:t({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:d.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../plots/font_attributes":867,"../../plots/pad_attributes":900,"../color/attributes":649}],750:[function(r,I,B){I.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25C4",right:"\u25BA",up:"\u25B2",down:"\u25BC"}}},{}],751:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/array_container_defaults"),m=r("./attributes"),h=r("./constants").name,e=m.buttons;function f(o,u,s){function i(c,n){return t.coerce(o,u,m,c,n)}i("visible",d(o,u,{name:"buttons",handleItemDefaults:l}).length>0)&&(i("active"),i("direction"),i("type"),i("showactive"),i("x"),i("y"),t.noneOrAll(o,u,["x","y"]),i("xanchor"),i("yanchor"),i("pad.t"),i("pad.r"),i("pad.b"),i("pad.l"),t.coerceFont(i,"font",s.font),i("bgcolor",s.paper_bgcolor),i("bordercolor"),i("borderwidth"))}function l(o,u){function s(i,c){return t.coerce(o,u,e,i,c)}s("visible",o.method==="skip"||Array.isArray(o.args))&&(s("method"),s("args"),s("args2"),s("label"),s("execute"))}I.exports=function(o,u){d(o,u,{name:h,handleItemDefaults:f})}},{"../../lib":787,"../../plots/array_container_defaults":833,"./attributes":749,"./constants":750}],752:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../plots/plots"),m=r("../color"),h=r("../drawing"),e=r("../../lib"),f=r("../../lib/svg_text_utils"),l=r("../../plot_api/plot_template").arrayEditor,o=r("../../constants/alignment").LINE_SPACING,u=r("./constants"),s=r("./scrollbox");function i(k){return k._index}function c(k,L){return+k.attr(u.menuIndexAttrName)===L._index}function n(k,L,M,P,D,N,U,G){L.active=U,l(k.layout,u.name,L).applyUpdate("active",U),L.type==="buttons"?g(k,P,null,null,L):L.type==="dropdown"&&(D.attr(u.menuIndexAttrName,"-1"),a(k,P,D,N,L),G||g(k,P,D,N,L))}function a(k,L,M,P,D){var N=e.ensureSingle(L,"g",u.headerClassName,function(H){H.style("pointer-events","all")}),U=D._dims,G=D.active,X=D.buttons[G]||u.blankHeaderOpts,K={y:D.pad.t,yPad:0,x:D.pad.l,xPad:0,index:0},Z={width:U.headerWidth,height:U.headerHeight};N.call(p,D,X,k).call(w,D,K,Z),e.ensureSingle(L,"text",u.headerArrowClassName,function(H){H.attr("text-anchor","end").call(h.font,D.font).text(u.arrowSymbol[D.direction])}).attr({x:U.headerWidth-u.arrowOffsetX+D.pad.l,y:U.headerHeight/2+u.textOffsetY+D.pad.t}),N.on("click",function(){M.call(E,String(c(M,D)?-1:D._index)),g(k,L,M,P,D)}),N.on("mouseover",function(){N.call(x)}),N.on("mouseout",function(){N.call(T,D)}),h.setTranslate(L,U.lx,U.ly)}function g(k,L,M,P,D){M||(M=L).attr("pointer-events","all");var N=function(W){return+W.attr(u.menuIndexAttrName)==-1}(M)&&D.type!=="buttons"?[]:D.buttons,U=D.type==="dropdown"?u.dropdownButtonClassName:u.buttonClassName,G=M.selectAll("g."+U).data(e.filterVisible(N)),X=G.enter().append("g").classed(U,!0),K=G.exit();D.type==="dropdown"?(X.attr("opacity","0").transition().attr("opacity","1"),K.transition().attr("opacity","0").remove()):K.remove();var Z=0,H=0,Y=D._dims,$=["up","down"].indexOf(D.direction)!==-1;D.type==="dropdown"&&($?H=Y.headerHeight+u.gapButtonHeader:Z=Y.headerWidth+u.gapButtonHeader),D.type==="dropdown"&&D.direction==="up"&&(H=-u.gapButtonHeader+u.gapButton-Y.openHeight),D.type==="dropdown"&&D.direction==="left"&&(Z=-u.gapButtonHeader+u.gapButton-Y.openWidth);var z={x:Y.lx+Z+D.pad.l,y:Y.ly+H+D.pad.t,yPad:u.gapButton,xPad:u.gapButton,index:0},j={l:z.x+D.borderwidth,t:z.y+D.borderwidth};G.each(function(W,ee){var J=t.select(this);J.call(p,D,W,k).call(w,D,z),J.on("click",function(){t.event.defaultPrevented||(W.execute&&(W.args2&&D.active===ee?(n(k,D,0,L,M,P,-1),d.executeAPICommand(k,W.method,W.args2)):(n(k,D,0,L,M,P,ee),d.executeAPICommand(k,W.method,W.args))),k.emit("plotly_buttonclicked",{menu:D,button:W,active:D.active}))}),J.on("mouseover",function(){J.call(x)}),J.on("mouseout",function(){J.call(T,D),G.call(b,D)})}),G.call(b,D),$?(j.w=Math.max(Y.openWidth,Y.headerWidth),j.h=z.y-j.t):(j.w=z.x-j.l,j.h=Math.max(Y.openHeight,Y.headerHeight)),j.direction=D.direction,P&&(G.size()?function(W,ee,J,Q,te,ie){var ae,he,se,de=te.direction,ue=de==="up"||de==="down",ve=te._dims,ke=te.active;if(ue)for(he=0,se=0;se<ke;se++)he+=ve.heights[se]+u.gapButton;else for(ae=0,se=0;se<ke;se++)ae+=ve.widths[se]+u.gapButton;Q.enable(ie,ae,he),Q.hbar&&Q.hbar.attr("opacity","0").transition().attr("opacity","1"),Q.vbar&&Q.vbar.attr("opacity","0").transition().attr("opacity","1")}(0,0,0,P,D,j):function(W){var ee=!!W.hbar,J=!!W.vbar;ee&&W.hbar.transition().attr("opacity","0").each("end",function(){ee=!1,J||W.disable()}),J&&W.vbar.transition().attr("opacity","0").each("end",function(){J=!1,ee||W.disable()})}(P))}function p(k,L,M,P){k.call(y,L).call(v,L,M,P)}function y(k,L){e.ensureSingle(k,"rect",u.itemRectClassName,function(M){M.attr({rx:u.rx,ry:u.ry,"shape-rendering":"crispEdges"})}).call(m.stroke,L.bordercolor).call(m.fill,L.bgcolor).style("stroke-width",L.borderwidth+"px")}function v(k,L,M,P){var D=e.ensureSingle(k,"text",u.itemTextClassName,function(G){G.attr({"text-anchor":"start","data-notex":1})}),N=M.label,U=P._fullLayout._meta;U&&(N=e.templateString(N,U)),D.call(h.font,L.font).text(N).call(f.convertToTspans,P)}function b(k,L){var M=L.active;k.each(function(P,D){var N=t.select(this);D===M&&L.showactive&&N.select("rect."+u.itemRectClassName).call(m.fill,u.activeColor)})}function x(k){k.select("rect."+u.itemRectClassName).call(m.fill,u.hoverColor)}function T(k,L){k.select("rect."+u.itemRectClassName).call(m.fill,L.bgcolor)}function A(k,L){var M=L._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},P=h.tester.selectAll("g."+u.dropdownButtonClassName).data(e.filterVisible(L.buttons));P.enter().append("g").classed(u.dropdownButtonClassName,!0);var D=["up","down"].indexOf(L.direction)!==-1;P.each(function(Z,H){var Y=t.select(this);Y.call(p,L,Z,k);var $=Y.select("."+u.itemTextClassName),z=$.node()&&h.bBox($.node()).width,j=Math.max(z+u.textPadX,u.minWidth),W=L.font.size*o,ee=f.lineCount($),J=Math.max(W*ee,u.minHeight)+u.textOffsetY;J=Math.ceil(J),j=Math.ceil(j),M.widths[H]=j,M.heights[H]=J,M.height1=Math.max(M.height1,J),M.width1=Math.max(M.width1,j),D?(M.totalWidth=Math.max(M.totalWidth,j),M.openWidth=M.totalWidth,M.totalHeight+=J+u.gapButton,M.openHeight+=J+u.gapButton):(M.totalWidth+=j+u.gapButton,M.openWidth+=j+u.gapButton,M.totalHeight=Math.max(M.totalHeight,J),M.openHeight=M.totalHeight)}),D?M.totalHeight-=u.gapButton:M.totalWidth-=u.gapButton,M.headerWidth=M.width1+u.arrowPadX,M.headerHeight=M.height1,L.type==="dropdown"&&(D?(M.width1+=u.arrowPadX,M.totalHeight=M.height1):M.totalWidth=M.width1,M.totalWidth+=u.arrowPadX),P.remove();var N=M.totalWidth+L.pad.l+L.pad.r,U=M.totalHeight+L.pad.t+L.pad.b,G=k._fullLayout._size;M.lx=G.l+G.w*L.x,M.ly=G.t+G.h*(1-L.y);var X="left";e.isRightAnchor(L)&&(M.lx-=N,X="right"),e.isCenterAnchor(L)&&(M.lx-=N/2,X="center");var K="top";e.isBottomAnchor(L)&&(M.ly-=U,K="bottom"),e.isMiddleAnchor(L)&&(M.ly-=U/2,K="middle"),M.totalWidth=Math.ceil(M.totalWidth),M.totalHeight=Math.ceil(M.totalHeight),M.lx=Math.round(M.lx),M.ly=Math.round(M.ly),d.autoMargin(k,S(L),{x:L.x,y:L.y,l:N*({right:1,center:.5}[X]||0),r:N*({left:1,center:.5}[X]||0),b:U*({top:1,middle:.5}[K]||0),t:U*({bottom:1,middle:.5}[K]||0)})}function S(k){return u.autoMarginIdRoot+k._index}function w(k,L,M,P){P=P||{};var D=k.select("."+u.itemRectClassName),N=k.select("."+u.itemTextClassName),U=L.borderwidth,G=M.index,X=L._dims;h.setTranslate(k,U+M.x,U+M.y);var K=["up","down"].indexOf(L.direction)!==-1,Z=P.height||(K?X.heights[G]:X.height1);D.attr({x:0,y:0,width:P.width||(K?X.width1:X.widths[G]),height:Z});var H=L.font.size*o,Y=(f.lineCount(N)-1)*H/2;f.positionText(N,u.textOffsetX,Z/2-Y+u.textOffsetY),K?M.y+=X.heights[G]+M.yPad:M.x+=X.widths[G]+M.xPad,M.index++}function E(k,L){k.attr(u.menuIndexAttrName,L||"-1").selectAll("g."+u.dropdownButtonClassName).remove()}I.exports=function(k){var L=k._fullLayout,M=e.filterVisible(L[u.name]);function P(H){d.autoMargin(k,S(H))}var D=L._menulayer.selectAll("g."+u.containerClassName).data(M.length>0?[0]:[]);if(D.enter().append("g").classed(u.containerClassName,!0).style("cursor","pointer"),D.exit().each(function(){t.select(this).selectAll("g."+u.headerGroupClassName).each(P)}).remove(),M.length!==0){var N=D.selectAll("g."+u.headerGroupClassName).data(M,i);N.enter().append("g").classed(u.headerGroupClassName,!0);for(var U=e.ensureSingle(D,"g",u.dropdownButtonGroupClassName,function(H){H.style("pointer-events","all")}),G=0;G<M.length;G++){var X=M[G];A(k,X)}var K="updatemenus"+L._uid,Z=new s(k,U,K);N.enter().size()&&(U.node().parentNode.appendChild(U.node()),U.call(E)),N.exit().each(function(H){U.call(E),P(H)}).remove(),N.each(function(H){var Y=t.select(this),$=H.type==="dropdown"?U:null;d.manageCommandObserver(k,H,H.buttons,function(z){n(k,H,H.buttons[z.index],Y,$,Z,z.index,!0)}),H.type==="dropdown"?(a(k,Y,U,Z,H),c(U,H)&&g(k,Y,U,Z,H)):g(k,Y,null,null,H)})}}},{"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"../../plot_api/plot_template":827,"../../plots/plots":901,"../color":650,"../drawing":672,"./constants":750,"./scrollbox":754,"@plotly/d3":58}],753:[function(r,I,B){arguments[4][747][0].apply(B,arguments)},{"./attributes":749,"./constants":750,"./defaults":751,"./draw":752,dup:747}],754:[function(r,I,B){I.exports=e;var t=r("@plotly/d3"),d=r("../color"),m=r("../drawing"),h=r("../../lib");function e(f,l,o){this.gd=f,this.container=l,this.id=o,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(f,l,o){var u=this.gd._fullLayout,s=u.width,i=u.height;this.position=f;var c,n,a,g,p=this.position.l,y=this.position.w,v=this.position.t,b=this.position.h,x=this.position.direction,T=x==="down",A=x==="left",S=x==="up",w=y,E=b;T||A||x==="right"||S||(this.position.direction="down",T=!0),T||S?(n=(c=p)+w,T?(a=v,E=(g=Math.min(a+E,i))-a):E=(g=v+E)-(a=Math.max(g-E,0))):(g=(a=v)+E,A?w=(n=p+w)-(c=Math.max(n-w,0)):(c=p,w=(n=Math.min(c+w,s))-c)),this._box={l:c,t:a,w,h:E};var k=y>w,L=e.barLength+2*e.barPad,M=e.barWidth+2*e.barPad,P=p,D=v+b;D+M>i&&(D=i-M);var N=this.container.selectAll("rect.scrollbar-horizontal").data(k?[0]:[]);N.exit().on(".drag",null).remove(),N.enter().append("rect").classed("scrollbar-horizontal",!0).call(d.fill,e.barColor),k?(this.hbar=N.attr({rx:e.barRadius,ry:e.barRadius,x:P,y:D,width:L,height:M}),this._hbarXMin=P+L/2,this._hbarTranslateMax=w-L):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var U=b>E,G=e.barWidth+2*e.barPad,X=e.barLength+2*e.barPad,K=p+y,Z=v;K+G>s&&(K=s-G);var H=this.container.selectAll("rect.scrollbar-vertical").data(U?[0]:[]);H.exit().on(".drag",null).remove(),H.enter().append("rect").classed("scrollbar-vertical",!0).call(d.fill,e.barColor),U?(this.vbar=H.attr({rx:e.barRadius,ry:e.barRadius,x:K,y:Z,width:G,height:X}),this._vbarYMin=Z+X/2,this._vbarTranslateMax=E-X):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var Y=this.id,$=c-.5,z=U?n+G+.5:n+.5,j=a-.5,W=k?g+M+.5:g+.5,ee=u._topdefs.selectAll("#"+Y).data(k||U?[0]:[]);if(ee.exit().remove(),ee.enter().append("clipPath").attr("id",Y).append("rect"),k||U?(this._clipRect=ee.select("rect").attr({x:Math.floor($),y:Math.floor(j),width:Math.ceil(z)-Math.floor($),height:Math.ceil(W)-Math.floor(j)}),this.container.call(m.setClipUrl,Y,this.gd),this.bg.attr({x:p,y:v,width:y,height:b})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(m.setClipUrl,null),delete this._clipRect),k||U){var J=t.behavior.drag().on("dragstart",function(){t.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(J);var Q=t.behavior.drag().on("dragstart",function(){t.event.sourceEvent.preventDefault(),t.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));k&&this.hbar.on(".drag",null).call(Q),U&&this.vbar.on(".drag",null).call(Q)}this.setTranslate(l,o)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(m.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var f=this.translateX,l=this.translateY;this.hbar&&(f-=t.event.dx),this.vbar&&(l-=t.event.dy),this.setTranslate(f,l)},e.prototype._onBoxWheel=function(){var f=this.translateX,l=this.translateY;this.hbar&&(f+=t.event.deltaY),this.vbar&&(l+=t.event.deltaY),this.setTranslate(f,l)},e.prototype._onBarDrag=function(){var f=this.translateX,l=this.translateY;if(this.hbar){var o=f+this._hbarXMin,u=o+this._hbarTranslateMax;f=(h.constrain(t.event.x,o,u)-o)/(u-o)*(this.position.w-this._box.w)}if(this.vbar){var s=l+this._vbarYMin,i=s+this._vbarTranslateMax;l=(h.constrain(t.event.y,s,i)-s)/(i-s)*(this.position.h-this._box.h)}this.setTranslate(f,l)},e.prototype.setTranslate=function(f,l){var o=this.position.w-this._box.w,u=this.position.h-this._box.h;if(f=h.constrain(f||0,0,o),l=h.constrain(l||0,0,u),this.translateX=f,this.translateY=l,this.container.call(m.setTranslate,this._box.l-this.position.l-f,this._box.t-this.position.t-l),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+f-.5),y:Math.floor(this.position.t+l-.5)}),this.hbar){var s=f/o;this.hbar.call(m.setTranslate,f+s*this._hbarTranslateMax,l)}if(this.vbar){var i=l/u;this.vbar.call(m.setTranslate,f,l+i*this._vbarTranslateMax)}}},{"../../lib":787,"../color":650,"../drawing":672,"@plotly/d3":58}],755:[function(r,I,B){I.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],756:[function(r,I,B){I.exports={axisRefDescription:function(t,d,m){return["If set to a",t,"axis id (e.g. *"+t+"* or","*"+t+"2*), the `"+t+"` position refers to a",t,"coordinate. If set to *paper*, the `"+t+"`","position refers to the distance from the",d,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",d,"("+m+"). If set to a",t,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",d,"of the domain of that axis: e.g.,","*"+t+"2 domain* refers to the domain of the second",t," axis and a",t,"position of 0.5 refers to the","point between the",d,"and the",m,"of the domain of the","second",t,"axis."].join(" ")}}},{}],757:[function(r,I,B){I.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25B2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25BC"}}},{}],758:[function(r,I,B){I.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],759:[function(r,I,B){I.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],760:[function(r,I,B){I.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],761:[function(r,I,B){I.exports={circle:"\u25CF","circle-open":"\u25CB",square:"\u25A0","square-open":"\u25A1",diamond:"\u25C6","diamond-open":"\u25C7",cross:"+",x:"\u274C"}},{}],762:[function(r,I,B){I.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],763:[function(r,I,B){I.exports={BADNUM:void 0,FP_SAFE:1e-4*Number.MAX_VALUE,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:24405875e-1,ALMOST_EQUAL:.999999,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],764:[function(r,I,B){B.xmlns="http://www.w3.org/2000/xmlns/",B.svg="http://www.w3.org/2000/svg",B.xlink="http://www.w3.org/1999/xlink",B.svgAttrs={xmlns:B.svg,"xmlns:xlink":B.xlink}},{}],765:[function(r,I,B){B.version=r("./version").version,r("native-promise-only"),r("../build/plotcss");for(var t=r("./registry"),d=B.register=t.register,m=r("./plot_api"),h=Object.keys(m),e=0;e<h.length;e++){var f=h[e];f.charAt(0)!=="_"&&(B[f]=m[f]),d({moduleType:"apiMethod",name:f,fn:m[f]})}d(r("./traces/scatter")),d([r("./components/legend"),r("./components/fx"),r("./components/annotations"),r("./components/annotations3d"),r("./components/shapes"),r("./components/images"),r("./components/updatemenus"),r("./components/sliders"),r("./components/rangeslider"),r("./components/rangeselector"),r("./components/grid"),r("./components/errorbars"),r("./components/colorscale"),r("./components/colorbar"),r("./components/modebar")]),d([r("./locale-en"),r("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(d(window.PlotlyLocales),delete window.PlotlyLocales),B.Icons=r("./fonts/ploticon");var l=r("./components/fx"),o=r("./plots/plots");B.Plots={resize:o.resize,graphJson:o.graphJson,sendDataToCloud:o.sendDataToCloud},B.Fx={hover:l.hover,unhover:l.unhover,loneHover:l.loneHover,loneUnhover:l.loneUnhover},B.Snapshot=r("./snapshot"),B.PlotSchema=r("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":641,"./components/annotations3d":646,"./components/colorbar":656,"./components/colorscale":662,"./components/errorbars":678,"./components/fx":690,"./components/grid":694,"./components/images":699,"./components/legend":707,"./components/modebar":713,"./components/rangeselector":721,"./components/rangeslider":728,"./components/shapes":742,"./components/sliders":747,"./components/updatemenus":753,"./fonts/ploticon":766,"./locale-en":818,"./locale-en-us":817,"./plot_api":822,"./plot_api/plot_schema":826,"./plots/plots":901,"./registry":915,"./snapshot":920,"./traces/scatter":1214,"./version":1388,"native-promise-only":463}],766:[function(r,I,B){I.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'><defs><style>.cls-1 {fill: #3f4f75;} .cls-2 {fill: #80cfbe;} .cls-3 {fill: #fff;}</style></defs><title>plotly-logomark</title><g id='symbol'><rect class='cls-1' width='132' height='132' rx='6' ry='6'/><circle class='cls-2' cx='78' cy='54' r='6'/><circle class='cls-2' cx='102' cy='30' r='6'/><circle class='cls-2' cx='78' cy='30' r='6'/><circle class='cls-2' cx='54' cy='30' r='6'/><circle class='cls-2' cx='30' cy='30' r='6'/><circle class='cls-2' cx='30' cy='54' r='6'/><path class='cls-3' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/><path class='cls-3' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/><path class='cls-3' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/><path class='cls-3' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/></g></svg>"}}},{}],767:[function(r,I,B){B.isLeftAnchor=function(t){return t.xanchor==="left"||t.xanchor==="auto"&&t.x<=1/3},B.isCenterAnchor=function(t){return t.xanchor==="center"||t.xanchor==="auto"&&t.x>1/3&&t.x<2/3},B.isRightAnchor=function(t){return t.xanchor==="right"||t.xanchor==="auto"&&t.x>=2/3},B.isTopAnchor=function(t){return t.yanchor==="top"||t.yanchor==="auto"&&t.y>=2/3},B.isMiddleAnchor=function(t){return t.yanchor==="middle"||t.yanchor==="auto"&&t.y>1/3&&t.y<2/3},B.isBottomAnchor=function(t){return t.yanchor==="bottom"||t.yanchor==="auto"&&t.y<=1/3}},{}],768:[function(r,I,B){var t=r("./mod"),d=t.mod,m=t.modHalf,h=Math.PI,e=2*h;function f(s){return Math.abs(s[1]-s[0])>e-1e-14}function l(s,i){return m(i-s,e)}function o(s,i){if(f(i))return!0;var c,n;i[0]<i[1]?(c=i[0],n=i[1]):(c=i[1],n=i[0]),(c=d(c,e))>(n=d(n,e))&&(n+=e);var a=d(s,e),g=a+e;return a>=c&&a<=n||g>=c&&g<=n}function u(s,i,c,n,a,g,p){a=a||0,g=g||0;var y,v,b,x,T,A=f([c,n]);function S(L,M){return[L*Math.cos(M)+a,g-L*Math.sin(M)]}A?(y=0,v=h,b=e):c<n?(y=c,b=n):(y=n,b=c),s<i?(x=s,T=i):(x=i,T=s);var w,E=Math.abs(b-y)<=h?0:1;function k(L,M,P){return"A"+[L,L]+" "+[0,E,P]+" "+S(L,M)}return A?w=x===null?"M"+S(T,y)+k(T,v,0)+k(T,b,0)+"Z":"M"+S(x,y)+k(x,v,0)+k(x,b,0)+"ZM"+S(T,y)+k(T,v,1)+k(T,b,1)+"Z":x===null?(w="M"+S(T,y)+k(T,b,0),p&&(w+="L0,0Z")):w="M"+S(x,y)+"L"+S(T,y)+k(T,b,0)+"L"+S(x,b)+k(x,y,1)+"Z",w}I.exports={deg2rad:function(s){return s/180*h},rad2deg:function(s){return s/h*180},angleDelta:l,angleDist:function(s,i){return Math.abs(l(s,i))},isFullCircle:f,isAngleInsideSector:o,isPtInsideSector:function(s,i,c,n){return!!o(i,n)&&(c[0]<c[1]?(a=c[0],g=c[1]):(a=c[1],g=c[0]),s>=a&&s<=g);var a,g},pathArc:function(s,i,c,n,a){return u(null,s,i,c,n,a,0)},pathSector:function(s,i,c,n,a){return u(null,s,i,c,n,a,1)},pathAnnulus:function(s,i,c,n,a,g){return u(s,i,c,n,a,g,1)}}},{"./mod":794}],769:[function(r,I,B){var t=Array.isArray,d=ArrayBuffer,m=DataView;function h(l){return d.isView(l)&&!(l instanceof m)}function e(l){return t(l)||h(l)}function f(l,o,u){if(e(l)){if(e(l[0])){for(var s=u,i=0;i<l.length;i++)s=o(s,l[i].length);return s}return l.length}return 0}B.isTypedArray=h,B.isArrayOrTypedArray=e,B.isArray1D=function(l){return!e(l[0])},B.ensureArray=function(l,o){return t(l)||(l=[]),l.length=o,l},B.concat=function(){var l,o,u,s,i,c,n,a,g=[],p=!0,y=0;for(u=0;u<arguments.length;u++)(c=(s=arguments[u]).length)&&(o?g.push(s):(o=s,i=c),t(s)?l=!1:(p=!1,y?l!==s.constructor&&(l=!1):l=s.constructor),y+=c);if(!y)return[];if(!g.length)return o;if(p)return o.concat.apply(o,g);if(l){for((n=new l(y)).set(o),u=0;u<g.length;u++)s=g[u],n.set(s,i),i+=s.length;return n}for(n=new Array(y),a=0;a<o.length;a++)n[a]=o[a];for(u=0;u<g.length;u++){for(s=g[u],a=0;a<s.length;a++)n[i+a]=s[a];i+=a}return n},B.maxRowLength=function(l){return f(l,Math.max,0)},B.minRowLength=function(l){return f(l,Math.min,1/0)}},{}],770:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../constants/numerical").BADNUM,m=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;I.exports=function(h){return typeof h=="string"&&(h=h.replace(m,"")),t(h)?Number(h):d}},{"../constants/numerical":763,"fast-isnumeric":246}],771:[function(r,I,B){I.exports=function(t){var d=t._fullLayout;d._glcanvas&&d._glcanvas.size()&&d._glcanvas.each(function(m){m.regl&&m.regl.clear({color:!0,depth:!0})})}},{}],772:[function(r,I,B){I.exports=function(t){t._responsiveChartHandler&&(window.removeEventListener("resize",t._responsiveChartHandler),delete t._responsiveChartHandler)}},{}],773:[function(r,I,B){var t=r("fast-isnumeric"),d=r("tinycolor2"),m=r("../plots/attributes"),h=r("../components/colorscale/scales"),e=r("../components/color"),f=r("../constants/interactions").DESELECTDIM,l=r("./nested_property"),o=r("./regex").counter,u=r("./mod").modHalf,s=r("./array").isArrayOrTypedArray;function i(c,n){var a=B.valObjectMeta[n.valType];if(n.arrayOk&&s(c))return!0;if(a.validateFunction)return a.validateFunction(c,n);var g={},p=g,y={set:function(v){p=v}};return a.coerceFunction(c,y,g,n),p!==g}B.valObjectMeta={data_array:{coerceFunction:function(c,n,a){s(c)?n.set(c):a!==void 0&&n.set(a)}},enumerated:{coerceFunction:function(c,n,a,g){g.coerceNumber&&(c=+c),g.values.indexOf(c)===-1?n.set(a):n.set(c)},validateFunction:function(c,n){n.coerceNumber&&(c=+c);for(var a=n.values,g=0;g<a.length;g++){var p=String(a[g]);if(p.charAt(0)==="/"&&p.charAt(p.length-1)==="/"){if(new RegExp(p.substr(1,p.length-2)).test(c))return!0}else if(c===a[g])return!0}return!1}},boolean:{coerceFunction:function(c,n,a){c===!0||c===!1?n.set(c):n.set(a)}},number:{coerceFunction:function(c,n,a,g){!t(c)||g.min!==void 0&&c<g.min||g.max!==void 0&&c>g.max?n.set(a):n.set(+c)}},integer:{coerceFunction:function(c,n,a,g){c%1||!t(c)||g.min!==void 0&&c<g.min||g.max!==void 0&&c>g.max?n.set(a):n.set(+c)}},string:{coerceFunction:function(c,n,a,g){if(typeof c!="string"){var p=typeof c=="number";g.strict!==!0&&p?n.set(String(c)):n.set(a)}else g.noBlank&&!c?n.set(a):n.set(c)}},color:{coerceFunction:function(c,n,a){d(c).isValid()?n.set(c):n.set(a)}},colorlist:{coerceFunction:function(c,n,a){Array.isArray(c)&&c.length&&c.every(function(g){return d(g).isValid()})?n.set(c):n.set(a)}},colorscale:{coerceFunction:function(c,n,a){n.set(h.get(c,a))}},angle:{coerceFunction:function(c,n,a){c==="auto"?n.set("auto"):t(c)?n.set(u(+c,360)):n.set(a)}},subplotid:{coerceFunction:function(c,n,a,g){var p=g.regex||o(a);typeof c=="string"&&p.test(c)?n.set(c):n.set(a)},validateFunction:function(c,n){var a=n.dflt;return c===a||typeof c=="string"&&!!o(a).test(c)}},flaglist:{coerceFunction:function(c,n,a,g){if(typeof c=="string")if((g.extras||[]).indexOf(c)===-1){for(var p=c.split("+"),y=0;y<p.length;){var v=p[y];g.flags.indexOf(v)===-1||p.indexOf(v)<y?p.splice(y,1):y++}p.length?n.set(p.join("+")):n.set(a)}else n.set(c);else n.set(a)}},any:{coerceFunction:function(c,n,a){c===void 0?n.set(a):n.set(c)}},info_array:{coerceFunction:function(c,n,a,g){function p(D,N,U){var G,X={set:function(K){G=K}};return U===void 0&&(U=N.dflt),B.valObjectMeta[N.valType].coerceFunction(D,X,U,N),G}var y=g.dimensions===2||g.dimensions==="1-2"&&Array.isArray(c)&&Array.isArray(c[0]);if(Array.isArray(c)){var v,b,x,T,A,S,w=g.items,E=[],k=Array.isArray(w),L=k&&y&&Array.isArray(w[0]),M=y&&k&&!L,P=k&&!M?w.length:c.length;if(a=Array.isArray(a)?a:[],y)for(v=0;v<P;v++)for(E[v]=[],x=Array.isArray(c[v])?c[v]:[],A=M?w.length:k?w[v].length:x.length,b=0;b<A;b++)T=M?w[b]:k?w[v][b]:w,(S=p(x[b],T,(a[v]||[])[b]))!==void 0&&(E[v][b]=S);else for(v=0;v<P;v++)(S=p(c[v],k?w[v]:w,a[v]))!==void 0&&(E[v]=S);n.set(E)}else n.set(a)},validateFunction:function(c,n){if(!Array.isArray(c))return!1;var a=n.items,g=Array.isArray(a),p=n.dimensions===2;if(!n.freeLength&&c.length!==a.length)return!1;for(var y=0;y<c.length;y++)if(p){if(!Array.isArray(c[y])||!n.freeLength&&c[y].length!==a[y].length)return!1;for(var v=0;v<c[y].length;v++)if(!i(c[y][v],g?a[y][v]:a))return!1}else if(!i(c[y],g?a[y]:a))return!1;return!0}}},B.coerce=function(c,n,a,g,p){var y=l(a,g).get(),v=l(c,g),b=l(n,g),x=v.get(),T=n._template;if(x===void 0&&T&&(x=l(T,g).get(),T=0),p===void 0&&(p=y.dflt),y.arrayOk&&s(x))return b.set(x),x;var A=B.valObjectMeta[y.valType].coerceFunction;A(x,b,p,y);var S=b.get();return T&&S===p&&!i(x,y)&&(A(x=l(T,g).get(),b,p,y),S=b.get()),S},B.coerce2=function(c,n,a,g,p){var y=l(c,g),v=B.coerce(c,n,a,g,p),b=y.get();return b!=null&&v},B.coerceFont=function(c,n,a){var g={};return a=a||{},g.family=c(n+".family",a.family),g.size=c(n+".size",a.size),g.color=c(n+".color",a.color),g},B.coercePattern=function(c,n,a,g){if(c(n+".shape")){c(n+".solidity"),c(n+".size");var p=c(n+".fillmode")==="overlay";if(!g){var y=c(n+".bgcolor",p?a:void 0);c(n+".fgcolor",p?e.contrast(y):a)}c(n+".fgopacity",p?.5:1)}},B.coerceHoverinfo=function(c,n,a){var g,p=n._module.attributes,y=p.hoverinfo?p:m,v=y.hoverinfo;if(a._dataLength===1){var b=v.dflt==="all"?v.flags.slice():v.dflt.split("+");b.splice(b.indexOf("name"),1),g=b.join("+")}return B.coerce(c,n,y,"hoverinfo",g)},B.coerceSelectionMarkerOpacity=function(c,n){if(c.marker){var a,g,p=c.marker.opacity;p!==void 0&&(s(p)||c.selected||c.unselected||(a=p,g=f*p),n("selected.marker.opacity",a),n("unselected.marker.opacity",g))}},B.validate=i},{"../components/color":650,"../components/colorscale/scales":665,"../constants/interactions":762,"../plots/attributes":834,"./array":769,"./mod":794,"./nested_property":795,"./regex":804,"fast-isnumeric":246,tinycolor2:583}],774:[function(r,I,B){var t,d,m=r("d3-time-format").timeFormat,h=r("fast-isnumeric"),e=r("./loggers"),f=r("./mod").mod,l=r("../constants/numerical"),o=l.BADNUM,u=l.ONEDAY,s=l.ONEHOUR,i=l.ONEMIN,c=l.ONESEC,n=l.EPOCHJD,a=r("../registry"),g=r("d3-time-format").utcFormat,p=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,y=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,v=new Date().getFullYear()-70;function b(N){return N&&a.componentsRegistry.calendars&&typeof N=="string"&&N!=="gregorian"}function x(N,U){return String(N+Math.pow(10,U)).substr(1)}B.dateTick0=function(N,U){var G=function(K,Z){return b(K)?Z?a.getComponentMethod("calendars","CANONICAL_SUNDAY")[K]:a.getComponentMethod("calendars","CANONICAL_TICK")[K]:Z?"2000-01-02":"2000-01-01"}(N,!!U);if(U<2)return G;var X=B.dateTime2ms(G,N);return X+=u*(U-1),B.ms2DateTime(X,0,N)},B.dfltRange=function(N){return b(N)?a.getComponentMethod("calendars","DFLTRANGE")[N]:["2000-01-01","2001-01-01"]},B.isJSDate=function(N){return typeof N=="object"&&N!==null&&typeof N.getTime=="function"},B.dateTime2ms=function(N,U){if(B.isJSDate(N)){var G=N.getTimezoneOffset()*i,X=(N.getUTCMinutes()-N.getMinutes())*i+(N.getUTCSeconds()-N.getSeconds())*c+(N.getUTCMilliseconds()-N.getMilliseconds());if(X){var K=3*i;G=G-K/2+f(X-G+K/2,K)}return(N=Number(N)-G)>=t&&N<=d?N:o}if(typeof N!="string"&&typeof N!="number")return o;N=String(N);var Z=b(U),H=N.charAt(0);!Z||H!=="G"&&H!=="g"||(N=N.substr(1),U="");var Y=Z&&U.substr(0,7)==="chinese",$=N.match(Y?y:p);if(!$)return o;var z=$[1],j=$[3]||"1",W=Number($[5]||1),ee=Number($[7]||0),J=Number($[9]||0),Q=Number($[11]||0);if(Z){if(z.length===2)return o;var te;z=Number(z);try{var ie=a.getComponentMethod("calendars","getCal")(U);if(Y){var ae=j.charAt(j.length-1)==="i";j=parseInt(j,10),te=ie.newDate(z,ie.toMonthIndex(z,j,ae),W)}else te=ie.newDate(z,Number(j),W)}catch(se){return o}return te?(te.toJD()-n)*u+ee*s+J*i+Q*c:o}z=z.length===2?(Number(z)+2e3-v)%100+v:Number(z),j-=1;var he=new Date(Date.UTC(2e3,j,W,ee,J));return he.setUTCFullYear(z),he.getUTCMonth()!==j||he.getUTCDate()!==W?o:he.getTime()+Q*c},t=B.MIN_MS=B.dateTime2ms("-9999"),d=B.MAX_MS=B.dateTime2ms("9999-12-31 23:59:59.9999"),B.isDateTime=function(N,U){return B.dateTime2ms(N,U)!==o};var T=90*u,A=3*s,S=5*i;function w(N,U,G,X,K){if((U||G||X||K)&&(N+=" "+x(U,2)+":"+x(G,2),(X||K)&&(N+=":"+x(X,2),K))){for(var Z=4;K%10==0;)Z-=1,K/=10;N+="."+x(K,Z)}return N}B.ms2DateTime=function(N,U,G){if(typeof N!="number"||!(N>=t&&N<=d))return o;U||(U=0);var X,K,Z,H,Y,$,z=Math.floor(10*f(N+.05,1)),j=Math.round(N-z/10);if(b(G)){var W=Math.floor(j/u)+n,ee=Math.floor(f(N,u));try{X=a.getComponentMethod("calendars","getCal")(G).fromJD(W).formatDate("yyyy-mm-dd")}catch(J){X=g("G%Y-%m-%d")(new Date(j))}if(X.charAt(0)==="-")for(;X.length<11;)X="-0"+X.substr(1);else for(;X.length<10;)X="0"+X;K=U<T?Math.floor(ee/s):0,Z=U<T?Math.floor(ee%s/i):0,H=U<A?Math.floor(ee%i/c):0,Y=U<S?ee%c*10+z:0}else $=new Date(j),X=g("%Y-%m-%d")($),K=U<T?$.getUTCHours():0,Z=U<T?$.getUTCMinutes():0,H=U<A?$.getUTCSeconds():0,Y=U<S?10*$.getUTCMilliseconds()+z:0;return w(X,K,Z,H,Y)},B.ms2DateTimeLocal=function(N){if(!(N>=t+u&&N<=d-u))return o;var U=Math.floor(10*f(N+.05,1)),G=new Date(Math.round(N-U/10));return w(m("%Y-%m-%d")(G),G.getHours(),G.getMinutes(),G.getSeconds(),10*G.getUTCMilliseconds()+U)},B.cleanDate=function(N,U,G){if(N===o)return U;if(B.isJSDate(N)||typeof N=="number"&&isFinite(N)){if(b(G))return e.error("JS Dates and milliseconds are incompatible with world calendars",N),U;if(!(N=B.ms2DateTimeLocal(+N))&&U!==void 0)return U}else if(!B.isDateTime(N,G))return e.error("unrecognized date",N),U;return N};var E=/%\d?f/g,k=/%h/g,L={1:"1",2:"1",3:"2",4:"2"};function M(N,U,G,X){N=N.replace(E,function(Z){var H=Math.min(+Z.charAt(1)||6,6);return(U/1e3%1+2).toFixed(H).substr(2).replace(/0+$/,"")||"0"});var K=new Date(Math.floor(U+.05));if(N=N.replace(k,function(){return L[G("%q")(K)]}),b(X))try{N=a.getComponentMethod("calendars","worldCalFmt")(N,U,X)}catch(Z){return"Invalid"}return G(N)(K)}var P=[59,59.9,59.99,59.999,59.9999];B.formatDate=function(N,U,G,X,K,Z){if(K=b(K)&&K,!U)if(G==="y")U=Z.year;else if(G==="m")U=Z.month;else{if(G!=="d")return function(H,Y){var $=f(H+.05,u),z=x(Math.floor($/s),2)+":"+x(f(Math.floor($/i),60),2);if(Y!=="M"){h(Y)||(Y=0);var j=(100+Math.min(f(H/c,60),P[Y])).toFixed(Y).substr(1);Y>0&&(j=j.replace(/0+$/,"").replace(/[\.]$/,"")),z+=":"+j}return z}(N,G)+`
`+M(Z.dayMonthYear,N,X,K);U=Z.dayMonth+`
`+Z.year}return M(U,N,X,K)};var D=3*u;B.incrementMonth=function(N,U,G){G=b(G)&&G;var X=f(N,u);if(N=Math.round(N-X),G)try{var K=Math.round(N/u)+n,Z=a.getComponentMethod("calendars","getCal")(G),H=Z.fromJD(K);return U%12?Z.add(H,U,"m"):Z.add(H,U/12,"y"),(H.toJD()-n)*u+X}catch($){e.error("invalid ms "+N+" in calendar "+G)}var Y=new Date(N+D);return Y.setUTCMonth(Y.getUTCMonth()+U)+X-D},B.findExactDates=function(N,U){for(var G,X,K=0,Z=0,H=0,Y=0,$=b(U)&&a.getComponentMethod("calendars","getCal")(U),z=0;z<N.length;z++)if(X=N[z],h(X)){if(!(X%u))if($)try{(G=$.fromJD(X/u+n)).day()===1?G.month()===1?K++:Z++:H++}catch(W){}else(G=new Date(X)).getUTCDate()===1?G.getUTCMonth()===0?K++:Z++:H++}else Y++;H+=Z+=K;var j=N.length-Y;return{exactYears:K/j,exactMonths:Z/j,exactDays:H/j}}},{"../constants/numerical":763,"../registry":915,"./loggers":791,"./mod":794,"d3-time-format":172,"fast-isnumeric":246}],775:[function(r,I,B){var t=r("@plotly/d3"),d=r("./loggers"),m=r("./matrix"),h=r("gl-mat4");function e(s){var i=s&&s.parentNode;i&&i.removeChild(s)}function f(s,i,c){var n="plotly.js-style-"+s,a=document.getElementById(n);a||((a=document.createElement("style")).setAttribute("id",n),a.appendChild(document.createTextNode("")),document.head.appendChild(a));var g=a.sheet;g.insertRule?g.insertRule(i+"{"+c+"}",0):g.addRule?g.addRule(i,c,0):d.warn("addStyleRule failed")}function l(s){var i=window.getComputedStyle(s,null),c=i.getPropertyValue("-webkit-transform")||i.getPropertyValue("-moz-transform")||i.getPropertyValue("-ms-transform")||i.getPropertyValue("-o-transform")||i.getPropertyValue("transform");return c==="none"?null:c.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(n){return+n})}function o(s){for(var i=[];u(s);)i.push(s),s=s.parentNode;return i}function u(s){return s&&(s instanceof Element||s instanceof HTMLElement)}I.exports={getGraphDiv:function(s){var i;if(typeof s=="string"){if((i=document.getElementById(s))===null)throw new Error("No DOM element with id '"+s+"' exists on the page.");return i}if(s==null)throw new Error("DOM element provided is null or undefined");return s},isPlotDiv:function(s){var i=t.select(s);return i.node()instanceof HTMLElement&&i.size()&&i.classed("js-plotly-plot")},removeElement:e,addStyleRule:function(s,i){f("global",s,i)},addRelatedStyleRule:f,deleteRelatedStyleRule:function(s){var i="plotly.js-style-"+s,c=document.getElementById(i);c&&e(c)},getFullTransformMatrix:function(s){var i=o(s),c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return i.forEach(function(n){var a=l(n);if(a){var g=m.convertCssMatrix(a);c=h.multiply(c,c,g)}}),c},getElementTransformMatrix:l,getElementAndAncestors:o,equalDomRects:function(s,i){return s&&i&&s.x===i.x&&s.y===i.y&&s.top===i.top&&s.left===i.left&&s.right===i.right&&s.bottom===i.bottom}}},{"./loggers":791,"./matrix":793,"@plotly/d3":58,"gl-mat4":292}],776:[function(r,I,B){var t=r("events").EventEmitter,d={init:function(m){if(m._ev instanceof t)return m;var h=new t,e=new t;return m._ev=h,m._internalEv=e,m.on=h.on.bind(h),m.once=h.once.bind(h),m.removeListener=h.removeListener.bind(h),m.removeAllListeners=h.removeAllListeners.bind(h),m._internalOn=e.on.bind(e),m._internalOnce=e.once.bind(e),m._removeInternalListener=e.removeListener.bind(e),m._removeAllInternalListeners=e.removeAllListeners.bind(e),m.emit=function(f,l){typeof jQuery!="undefined"&&jQuery(m).trigger(f,l),h.emit(f,l),e.emit(f,l)},m},triggerHandler:function(m,h,e){var f,l;typeof jQuery!="undefined"&&(f=jQuery(m).triggerHandler(h,e));var o=m._ev;if(!o)return f;var u,s=o._events[h];if(!s)return f;function i(c){return c.listener?(o.removeListener(h,c.listener),c.fired?void 0:(c.fired=!0,c.listener.apply(o,[e]))):c.apply(o,[e])}for(s=Array.isArray(s)?s:[s],u=0;u<s.length-1;u++)i(s[u]);return l=i(s[u]),f!==void 0?f:l},purge:function(m){return delete m._ev,delete m.on,delete m.once,delete m.removeListener,delete m.removeAllListeners,delete m.emit,delete m._ev,delete m._internalEv,delete m._internalOn,delete m._internalOnce,delete m._removeInternalListener,delete m._removeAllInternalListeners,m}};I.exports=d},{events:116}],777:[function(r,I,B){var t=r("./is_plain_object.js"),d=Array.isArray;function m(h,e,f,l){var o,u,s,i,c,n,a=h[0],g=h.length;if(g===2&&d(a)&&d(h[1])&&a.length===0){if(function(y,v){var b,x;for(b=0;b<y.length;b++){if((x=y[b])!==null&&typeof x=="object")return!1;x!==void 0&&(v[b]=x)}return!0}(h[1],a))return a;a.splice(0,a.length)}for(var p=1;p<g;p++)for(u in o=h[p])s=a[u],i=o[u],l&&d(i)?a[u]=i:e&&i&&(t(i)||(c=d(i)))?(c?(c=!1,n=s&&d(s)?s:[]):n=s&&t(s)?s:{},a[u]=m([n,i],e,f,l)):(i!==void 0||f)&&(a[u]=i);return a}B.extendFlat=function(){return m(arguments,!1,!1,!1)},B.extendDeep=function(){return m(arguments,!0,!1,!1)},B.extendDeepAll=function(){return m(arguments,!0,!0,!1)},B.extendDeepNoArrays=function(){return m(arguments,!0,!1,!0)}},{"./is_plain_object.js":788}],778:[function(r,I,B){I.exports=function(t){for(var d={},m=[],h=0,e=0;e<t.length;e++){var f=t[e];d[f]!==1&&(d[f]=1,m[h++]=f)}return m}},{}],779:[function(r,I,B){function t(m){return m.visible===!0}function d(m){var h=m[0].trace;return h.visible===!0&&h._length!==0}I.exports=function(m){for(var h,e=(h=m,Array.isArray(h)&&Array.isArray(h[0])&&h[0][0]&&h[0][0].trace?d:t),f=[],l=0;l<m.length;l++){var o=m[l];e(o)&&f.push(o)}return f}},{}],780:[function(r,I,B){var t=r("@plotly/d3"),d=r("country-regex"),m=r("@turf/area"),h=r("@turf/centroid"),e=r("@turf/bbox"),f=r("./identity"),l=r("./loggers"),o=r("./is_plain_object"),u=r("./nested_property"),s=r("./polygon"),i=Object.keys(d),c={"ISO-3":f,"USA-states":f,"country names":function(a){for(var g=0;g<i.length;g++){var p=i[g];if(new RegExp(d[p]).test(a.trim().toLowerCase()))return p}return l.log("Unrecognized country name: "+a+"."),!1}};function n(a){var g=a.geojson,p=window.PlotlyGeoAssets||{},y=typeof g=="string"?p[g]:g;return o(y)?y:(l.error("Oops ... something went wrong when fetching "+g),!1)}I.exports={locationToFeature:function(a,g,p){if(!g||typeof g!="string")return!1;var y,v,b,x=c[a](g);if(x){if(a==="USA-states")for(y=[],b=0;b<p.length;b++)(v=p[b]).properties&&v.properties.gu&&v.properties.gu==="USA"&&y.push(v);else y=p;for(b=0;b<y.length;b++)if((v=y[b]).id===x)return v;l.log(["Location with id",x,"does not have a matching topojson feature at this resolution."].join(" "))}return!1},feature2polygons:function(a){var g,p,y,v,b=a.geometry,x=b.coordinates,T=a.id,A=[];function S(w){for(var E=0;E<w.length-1;E++)if(w[E][0]>0&&w[E+1][0]<0)return E;return null}switch(g=T==="RUS"||T==="FJI"?function(w){var E;if(S(w)===null)E=w;else for(E=new Array(w.length),v=0;v<w.length;v++)E[v]=[w[v][0]<0?w[v][0]+360:w[v][0],w[v][1]];A.push(s.tester(E))}:T==="ATA"?function(w){var E=S(w);if(E===null)return A.push(s.tester(w));var k=new Array(w.length+1),L=0;for(v=0;v<w.length;v++)v>E?k[L++]=[w[v][0]+360,w[v][1]]:v===E?(k[L++]=w[v],k[L++]=[w[v][0],-90]):k[L++]=w[v];var M=s.tester(k);M.pts.pop(),A.push(M)}:function(w){A.push(s.tester(w))},b.type){case"MultiPolygon":for(p=0;p<x.length;p++)for(y=0;y<x[p].length;y++)g(x[p][y]);break;case"Polygon":for(p=0;p<x.length;p++)g(x[p])}return A},getTraceGeojson:n,extractTraceFeature:function(a){var g=a[0].trace,p=n(g);if(!p)return!1;var y,v={},b=[];for(y=0;y<g._length;y++){var x=a[y];(x.loc||x.loc===0)&&(v[x.loc]=x)}function T(w){var E=u(w,g.featureidkey||"id").get(),k=v[E];if(k){var L=w.geometry;if(L.type==="Polygon"||L.type==="MultiPolygon"){var M={type:"Feature",id:E,geometry:L,properties:{}};M.properties.ct=function(P){var D,N=P.geometry;if(N.type==="MultiPolygon")for(var U=N.coordinates,G=0,X=0;X<U.length;X++){var K={type:"Polygon",coordinates:U[X]},Z=m.default(K);Z>G&&(G=Z,D=K)}else D=N;return h.default(D).geometry.coordinates}(M),k.fIn=w,k.fOut=M,b.push(M)}else l.log(["Location",k.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete v[E]}switch(p.type){case"FeatureCollection":var A=p.features;for(y=0;y<A.length;y++)T(A[y]);break;case"Feature":T(p);break;default:return l.warn(["Invalid GeoJSON type",(p.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var S in v)l.log(["Location *"+S+"*","does not have a matching feature with id-key","*"+g.featureidkey+"*."].join(" "));return b},fetchTraceGeoData:function(a){var g=window.PlotlyGeoAssets||{},p=[];function y(T){return new Promise(function(A,S){t.json(T,function(w,E){if(w){delete g[T];var k=w.status===404?'GeoJSON at URL "'+T+'" does not exist.':"Unexpected error while fetching from "+T;return S(new Error(k))}return g[T]=E,A(E)})})}function v(T){return new Promise(function(A,S){var w=0,E=setInterval(function(){return g[T]&&g[T]!=="pending"?(clearInterval(E),A(g[T])):w>100?(clearInterval(E),S("Unexpected error while fetching from "+T)):void w++},50)})}for(var b=0;b<a.length;b++){var x=a[b][0].trace.geojson;typeof x=="string"&&(g[x]?g[x]==="pending"&&p.push(v(x)):(g[x]="pending",p.push(y(x))))}return p},computeBbox:function(a){return e.default(a)}}},{"./identity":785,"./is_plain_object":788,"./loggers":791,"./nested_property":795,"./polygon":799,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":145}],781:[function(r,I,B){var t=r("../constants/numerical").BADNUM;B.calcTraceToLineCoords=function(d){for(var m=d[0].trace.connectgaps,h=[],e=[],f=0;f<d.length;f++){var l=d[f].lonlat;l[0]!==t?e.push(l):!m&&e.length>0&&(h.push(e),e=[])}return e.length>0&&h.push(e),h},B.makeLine=function(d){return d.length===1?{type:"LineString",coordinates:d[0]}:{type:"MultiLineString",coordinates:d}},B.makePolygon=function(d){if(d.length===1)return{type:"Polygon",coordinates:d};for(var m=new Array(d.length),h=0;h<d.length;h++)m[h]=[d[h]];return{type:"MultiPolygon",coordinates:m}},B.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":763}],782:[function(r,I,B){var t,d,m,h=r("./mod").mod;function e(l,o,u,s,i,c,n,a){var g=u-l,p=i-l,y=n-i,v=s-o,b=c-o,x=a-c,T=g*x-y*v;if(T===0)return null;var A=(p*x-y*b)/T,S=(p*v-g*b)/T;return S<0||S>1||A<0||A>1?null:{x:l+g*A,y:o+v*A}}function f(l,o,u,s,i){var c=s*l+i*o;if(c<0)return s*s+i*i;if(c>u){var n=s-l,a=i-o;return n*n+a*a}var g=s*o-i*l;return g*g/u}B.segmentsIntersect=e,B.segmentDistance=function(l,o,u,s,i,c,n,a){if(e(l,o,u,s,i,c,n,a))return 0;var g=u-l,p=s-o,y=n-i,v=a-c,b=g*g+p*p,x=y*y+v*v,T=Math.min(f(g,p,b,i-l,c-o),f(g,p,b,n-l,a-o),f(y,v,x,l-i,o-c),f(y,v,x,u-i,s-c));return Math.sqrt(T)},B.getTextLocation=function(l,o,u,s){if(l===d&&s===m||(t={},d=l,m=s),t[u])return t[u];var i=l.getPointAtLength(h(u-s/2,o)),c=l.getPointAtLength(h(u+s/2,o)),n=Math.atan((c.y-i.y)/(c.x-i.x)),a=l.getPointAtLength(h(u,o)),g={x:(4*a.x+i.x+c.x)/6,y:(4*a.y+i.y+c.y)/6,theta:n};return t[u]=g,g},B.clearLocationCache=function(){d=null},B.getVisibleSegment=function(l,o,u){var s,i,c=o.left,n=o.right,a=o.top,g=o.bottom,p=0,y=l.getTotalLength(),v=y;function b(T){var A=l.getPointAtLength(T);T===0?s=A:T===y&&(i=A);var S=A.x<c?c-A.x:A.x>n?A.x-n:0,w=A.y<a?a-A.y:A.y>g?A.y-g:0;return Math.sqrt(S*S+w*w)}for(var x=b(p);x;){if((p+=x+u)>v)return;x=b(p)}for(x=b(v);x;){if(p>(v-=x+u))return;x=b(v)}return{min:p,max:v,len:v-p,total:y,isClosed:p===0&&v===y&&Math.abs(s.x-i.x)<.1&&Math.abs(s.y-i.y)<.1}},B.findPointOnPath=function(l,o,u,s){for(var i,c,n,a=(s=s||{}).pathLength||l.getTotalLength(),g=s.tolerance||.001,p=s.iterationLimit||30,y=l.getPointAtLength(0)[u]>l.getPointAtLength(a)[u]?-1:1,v=0,b=0,x=a;v<p;){if(i=(b+x)/2,n=(c=l.getPointAtLength(i))[u]-o,Math.abs(n)<g)return c;y*n>0?x=i:b=i,v++}return c}},{"./mod":794}],783:[function(r,I,B){var t=r("fast-isnumeric"),d=r("tinycolor2"),m=r("color-normalize"),h=r("../components/colorscale"),e=r("../components/color/attributes").defaultLine,f=r("./array").isArrayOrTypedArray,l=m(e);function o(i,c){var n=i;return n[3]*=c,n}function u(i){if(t(i))return l;var c=m(i);return c.length?c:l}function s(i){return t(i)?i:1}I.exports={formatColor:function(i,c,n){var a,g,p,y,v,b=i.color,x=f(b),T=f(c),A=h.extractOpts(i),S=[];if(a=A.colorscale!==void 0?h.makeColorScaleFuncFromTrace(i):u,g=x?function(E,k){return E[k]===void 0?l:m(a(E[k]))}:u,p=T?function(E,k){return E[k]===void 0?1:s(E[k])}:s,x||T)for(var w=0;w<n;w++)y=g(b,w),v=p(c,w),S[w]=o(y,v);else S=o(m(b),c);return S},parseColorScale:function(i){var c=h.extractOpts(i),n=c.colorscale;return c.reversescale&&(n=h.flipScale(c.colorscale)),n.map(function(a){var g=a[0],p=d(a[1]).toRgb();return{index:g,rgb:[p.r,p.g,p.b,p.a]}})}}},{"../components/color/attributes":649,"../components/colorscale":662,"./array":769,"color-normalize":131,"fast-isnumeric":246,tinycolor2:583}],784:[function(r,I,B){var t=r("./identity");function d(m){return[m]}I.exports={keyFun:function(m){return m.key},repeat:d,descend:t,wrap:d,unwrap:function(m){return m[0]}}},{"./identity":785}],785:[function(r,I,B){I.exports=function(t){return t}},{}],786:[function(r,I,B){I.exports=function(t,d){if(!d)return t;var m=1/Math.abs(d),h=m>1?(m*t+m*d)/m:t+d,e=String(h).length;if(e>16){var f=String(d).length;if(e>=String(t).length+f){var l=parseFloat(h).toPrecision(12);l.indexOf("e+")===-1&&(h=+l)}}return h}},{}],787:[function(r,I,B){var t=r("@plotly/d3"),d=r("d3-time-format").utcFormat,m=r("d3-format").format,h=r("fast-isnumeric"),e=r("../constants/numerical"),f=e.FP_SAFE,l=-f,o=e.BADNUM,u=I.exports={};u.adjustFormat=function(z){return!z||/^\d[.]\df/.test(z)||/[.]\d%/.test(z)?z:z==="0.f"?"~f":/^\d%/.test(z)?"~%":/^\ds/.test(z)?"~s":!/^[~,.0$]/.test(z)&&/[&fps]/.test(z)?"~"+z:z};var s={};u.warnBadFormat=function(z){var j=String(z);s[j]||(s[j]=1,u.warn('encountered bad format: "'+j+'"'))},u.noFormat=function(z){return String(z)},u.numberFormat=function(z){var j;try{j=m(u.adjustFormat(z))}catch(W){return u.warnBadFormat(z),u.noFormat}return j},u.nestedProperty=r("./nested_property"),u.keyedContainer=r("./keyed_container"),u.relativeAttr=r("./relative_attr"),u.isPlainObject=r("./is_plain_object"),u.toLogRange=r("./to_log_range"),u.relinkPrivateKeys=r("./relink_private");var i=r("./array");u.isTypedArray=i.isTypedArray,u.isArrayOrTypedArray=i.isArrayOrTypedArray,u.isArray1D=i.isArray1D,u.ensureArray=i.ensureArray,u.concat=i.concat,u.maxRowLength=i.maxRowLength,u.minRowLength=i.minRowLength;var c=r("./mod");u.mod=c.mod,u.modHalf=c.modHalf;var n=r("./coerce");u.valObjectMeta=n.valObjectMeta,u.coerce=n.coerce,u.coerce2=n.coerce2,u.coerceFont=n.coerceFont,u.coercePattern=n.coercePattern,u.coerceHoverinfo=n.coerceHoverinfo,u.coerceSelectionMarkerOpacity=n.coerceSelectionMarkerOpacity,u.validate=n.validate;var a=r("./dates");u.dateTime2ms=a.dateTime2ms,u.isDateTime=a.isDateTime,u.ms2DateTime=a.ms2DateTime,u.ms2DateTimeLocal=a.ms2DateTimeLocal,u.cleanDate=a.cleanDate,u.isJSDate=a.isJSDate,u.formatDate=a.formatDate,u.incrementMonth=a.incrementMonth,u.dateTick0=a.dateTick0,u.dfltRange=a.dfltRange,u.findExactDates=a.findExactDates,u.MIN_MS=a.MIN_MS,u.MAX_MS=a.MAX_MS;var g=r("./search");u.findBin=g.findBin,u.sorterAsc=g.sorterAsc,u.sorterDes=g.sorterDes,u.distinctVals=g.distinctVals,u.roundUp=g.roundUp,u.sort=g.sort,u.findIndexOfMin=g.findIndexOfMin,u.sortObjectKeys=r("./sort_object_keys");var p=r("./stats");u.aggNums=p.aggNums,u.len=p.len,u.mean=p.mean,u.median=p.median,u.midRange=p.midRange,u.variance=p.variance,u.stdev=p.stdev,u.interp=p.interp;var y=r("./matrix");u.init2dArray=y.init2dArray,u.transposeRagged=y.transposeRagged,u.dot=y.dot,u.translationMatrix=y.translationMatrix,u.rotationMatrix=y.rotationMatrix,u.rotationXYMatrix=y.rotationXYMatrix,u.apply3DTransform=y.apply3DTransform,u.apply2DTransform=y.apply2DTransform,u.apply2DTransform2=y.apply2DTransform2,u.convertCssMatrix=y.convertCssMatrix,u.inverseTransformMatrix=y.inverseTransformMatrix;var v=r("./angles");u.deg2rad=v.deg2rad,u.rad2deg=v.rad2deg,u.angleDelta=v.angleDelta,u.angleDist=v.angleDist,u.isFullCircle=v.isFullCircle,u.isAngleInsideSector=v.isAngleInsideSector,u.isPtInsideSector=v.isPtInsideSector,u.pathArc=v.pathArc,u.pathSector=v.pathSector,u.pathAnnulus=v.pathAnnulus;var b=r("./anchor_utils");u.isLeftAnchor=b.isLeftAnchor,u.isCenterAnchor=b.isCenterAnchor,u.isRightAnchor=b.isRightAnchor,u.isTopAnchor=b.isTopAnchor,u.isMiddleAnchor=b.isMiddleAnchor,u.isBottomAnchor=b.isBottomAnchor;var x=r("./geometry2d");u.segmentsIntersect=x.segmentsIntersect,u.segmentDistance=x.segmentDistance,u.getTextLocation=x.getTextLocation,u.clearLocationCache=x.clearLocationCache,u.getVisibleSegment=x.getVisibleSegment,u.findPointOnPath=x.findPointOnPath;var T=r("./extend");u.extendFlat=T.extendFlat,u.extendDeep=T.extendDeep,u.extendDeepAll=T.extendDeepAll,u.extendDeepNoArrays=T.extendDeepNoArrays;var A=r("./loggers");u.log=A.log,u.warn=A.warn,u.error=A.error;var S=r("./regex");u.counterRegex=S.counter;var w=r("./throttle");u.throttle=w.throttle,u.throttleDone=w.done,u.clearThrottle=w.clear;var E=r("./dom");function k(z){var j={};for(var W in z)for(var ee=z[W],J=0;J<ee.length;J++)j[ee[J]]=+W;return j}u.getGraphDiv=E.getGraphDiv,u.isPlotDiv=E.isPlotDiv,u.removeElement=E.removeElement,u.addStyleRule=E.addStyleRule,u.addRelatedStyleRule=E.addRelatedStyleRule,u.deleteRelatedStyleRule=E.deleteRelatedStyleRule,u.getFullTransformMatrix=E.getFullTransformMatrix,u.getElementTransformMatrix=E.getElementTransformMatrix,u.getElementAndAncestors=E.getElementAndAncestors,u.equalDomRects=E.equalDomRects,u.clearResponsive=r("./clear_responsive"),u.preserveDrawingBuffer=r("./preserve_drawing_buffer"),u.makeTraceGroups=r("./make_trace_groups"),u._=r("./localize"),u.notifier=r("./notifier"),u.filterUnique=r("./filter_unique"),u.filterVisible=r("./filter_visible"),u.pushUnique=r("./push_unique"),u.increment=r("./increment"),u.cleanNumber=r("./clean_number"),u.ensureNumber=function(z){return h(z)?(z=Number(z))>f||z<l?o:z:o},u.isIndex=function(z,j){return!(j!==void 0&&z>=j)&&h(z)&&z>=0&&z%1==0},u.noop=r("./noop"),u.identity=r("./identity"),u.repeat=function(z,j){for(var W=new Array(j),ee=0;ee<j;ee++)W[ee]=z;return W},u.swapAttrs=function(z,j,W,ee){W||(W="x"),ee||(ee="y");for(var J=0;J<j.length;J++){var Q=j[J],te=u.nestedProperty(z,Q.replace("?",W)),ie=u.nestedProperty(z,Q.replace("?",ee)),ae=te.get();te.set(ie.get()),ie.set(ae)}},u.raiseToTop=function(z){z.parentNode.appendChild(z)},u.cancelTransition=function(z){return z.transition().duration(0)},u.constrain=function(z,j,W){return j>W?Math.max(W,Math.min(j,z)):Math.max(j,Math.min(W,z))},u.bBoxIntersect=function(z,j,W){return W=W||0,z.left<=j.right+W&&j.left<=z.right+W&&z.top<=j.bottom+W&&j.top<=z.bottom+W},u.simpleMap=function(z,j,W,ee,J){for(var Q=z.length,te=new Array(Q),ie=0;ie<Q;ie++)te[ie]=j(z[ie],W,ee,J);return te},u.randstr=function z(j,W,ee,J){if(ee||(ee=16),W===void 0&&(W=24),W<=0)return"0";var Q,te,ie=Math.log(Math.pow(2,W))/Math.log(ee),ae="";for(Q=2;ie===1/0;Q*=2)ie=Math.log(Math.pow(2,W/Q))/Math.log(ee)*Q;var he=ie-Math.floor(ie);for(Q=0;Q<Math.floor(ie);Q++)ae=Math.floor(Math.random()*ee).toString(ee)+ae;he&&(te=Math.pow(ee,he),ae=Math.floor(Math.random()*te).toString(ee)+ae);var se=parseInt(ae,ee);return j&&j[ae]||se!==1/0&&se>=Math.pow(2,W)?J>10?(u.warn("randstr failed uniqueness"),ae):z(j,W,ee,(J||0)+1):ae},u.OptionControl=function(z,j){z||(z={}),j||(j="opt");var W={optionList:[],_newoption:function(ee){ee[j]=z,W[ee.name]=ee,W.optionList.push(ee)}};return W["_"+j]=z,W},u.smooth=function(z,j){if((j=Math.round(j)||0)<2)return z;var W,ee,J,Q,te=z.length,ie=2*te,ae=2*j-1,he=new Array(ae),se=new Array(te);for(W=0;W<ae;W++)he[W]=(1-Math.cos(Math.PI*(W+1)/j))/(2*j);for(W=0;W<te;W++){for(Q=0,ee=0;ee<ae;ee++)(J=W+ee+1-j)<-te?J-=ie*Math.round(J/ie):J>=ie&&(J-=ie*Math.floor(J/ie)),J<0?J=-1-J:J>=te&&(J=ie-1-J),Q+=z[J]*he[ee];se[W]=Q}return se},u.syncOrAsync=function(z,j,W){var ee;function J(){return u.syncOrAsync(z,j,W)}for(;z.length;)if((ee=(0,z.splice(0,1)[0])(j))&&ee.then)return ee.then(J);return W&&W(j)},u.stripTrailingSlash=function(z){return z.substr(-1)==="/"?z.substr(0,z.length-1):z},u.noneOrAll=function(z,j,W){if(z){var ee,J=!1,Q=!0;for(ee=0;ee<W.length;ee++)z[W[ee]]!=null?J=!0:Q=!1;if(J&&!Q)for(ee=0;ee<W.length;ee++)z[W[ee]]=j[W[ee]]}},u.mergeArray=function(z,j,W,ee){var J=typeof ee=="function";if(u.isArrayOrTypedArray(z))for(var Q=Math.min(z.length,j.length),te=0;te<Q;te++){var ie=z[te];j[te][W]=J?ee(ie):ie}},u.mergeArrayCastPositive=function(z,j,W){return u.mergeArray(z,j,W,function(ee){var J=+ee;return isFinite(J)&&J>0?J:0})},u.fillArray=function(z,j,W,ee){if(ee=ee||u.identity,u.isArrayOrTypedArray(z))for(var J=0;J<j.length;J++)j[J][W]=ee(z[J])},u.castOption=function(z,j,W,ee){ee=ee||u.identity;var J=u.nestedProperty(z,W).get();return u.isArrayOrTypedArray(J)?Array.isArray(j)&&u.isArrayOrTypedArray(J[j[0]])?ee(J[j[0]][j[1]]):ee(J[j]):J},u.extractOption=function(z,j,W,ee){if(W in z)return z[W];var J=u.nestedProperty(j,ee).get();return Array.isArray(J)?void 0:J},u.tagSelected=function(z,j,W){var ee,J,Q=j.selectedpoints,te=j._indexToPoints;te&&(ee=k(te));for(var ie=0;ie<Q.length;ie++){var ae=Q[ie];if(u.isIndex(ae)||u.isArrayOrTypedArray(ae)&&u.isIndex(ae[0])&&u.isIndex(ae[1])){var he=ee?ee[ae]:ae,se=W?W[he]:he;(J=se)!==void 0&&J<z.length&&(z[se].selected=1)}}},u.selIndices2selPoints=function(z){var j=z.selectedpoints,W=z._indexToPoints;if(W){for(var ee=k(W),J=[],Q=0;Q<j.length;Q++){var te=j[Q];if(u.isIndex(te)){var ie=ee[te];u.isIndex(ie)&&J.push(ie)}}return J}return j},u.getTargetArray=function(z,j){var W=j.target;if(typeof W=="string"&&W){var ee=u.nestedProperty(z,W).get();return!!Array.isArray(ee)&&ee}return!!Array.isArray(W)&&W},u.minExtend=function(z,j){var W={};typeof j!="object"&&(j={});var ee,J,Q,te=Object.keys(z);for(ee=0;ee<te.length;ee++)Q=z[J=te[ee]],J.charAt(0)!=="_"&&typeof Q!="function"&&(J==="module"?W[J]=Q:Array.isArray(Q)?W[J]=J==="colorscale"?Q.slice():Q.slice(0,3):u.isTypedArray(Q)?W[J]=Q.subarray(0,3):W[J]=Q&&typeof Q=="object"?u.minExtend(z[J],j[J]):Q);for(te=Object.keys(j),ee=0;ee<te.length;ee++)typeof(Q=j[J=te[ee]])=="object"&&J in W&&typeof W[J]=="object"||(W[J]=Q);return W},u.titleCase=function(z){return z.charAt(0).toUpperCase()+z.substr(1)},u.containsAny=function(z,j){for(var W=0;W<j.length;W++)if(z.indexOf(j[W])!==-1)return!0;return!1},u.isIE=function(){return window.navigator.msSaveBlob!==void 0};var L=/Version\/[\d\.]+.*Safari/;u.isSafari=function(){return L.test(window.navigator.userAgent)};var M=/iPad|iPhone|iPod/;u.isIOS=function(){return M.test(window.navigator.userAgent)};var P=/Firefox\/(\d+)\.\d+/;u.getFirefoxVersion=function(){var z=P.exec(window.navigator.userAgent);if(z&&z.length===2){var j=parseInt(z[1]);if(!isNaN(j))return j}return null},u.isD3Selection=function(z){return z instanceof t.selection},u.ensureSingle=function(z,j,W,ee){var J=z.select(j+(W?"."+W:""));if(J.size())return J;var Q=z.append(j);return W&&Q.classed(W,!0),ee&&Q.call(ee),Q},u.ensureSingleById=function(z,j,W,ee){var J=z.select(j+"#"+W);if(J.size())return J;var Q=z.append(j).attr("id",W);return ee&&Q.call(ee),Q},u.objectFromPath=function(z,j){for(var W,ee=z.split("."),J=W={},Q=0;Q<ee.length;Q++){var te=ee[Q],ie=null,ae=ee[Q].match(/(.*)\[([0-9]+)\]/);ae?(te=ae[1],ie=ae[2],W=W[te]=[],Q===ee.length-1?W[ie]=j:W[ie]={},W=W[ie]):(Q===ee.length-1?W[te]=j:W[te]={},W=W[te])}return J};var D=/^([^\[\.]+)\.(.+)?/,N=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;u.expandObjectPaths=function(z){var j,W,ee,J,Q,te,ie;if(typeof z=="object"&&!Array.isArray(z))for(W in z)z.hasOwnProperty(W)&&((j=W.match(D))?(J=z[W],ee=j[1],delete z[W],z[ee]=u.extendDeepNoArrays(z[ee]||{},u.objectFromPath(W,u.expandObjectPaths(J))[ee])):(j=W.match(N))?(J=z[W],ee=j[1],Q=parseInt(j[2]),delete z[W],z[ee]=z[ee]||[],j[3]==="."?(ie=j[4],te=z[ee][Q]=z[ee][Q]||{},u.extendDeepNoArrays(te,u.objectFromPath(ie,u.expandObjectPaths(J)))):z[ee][Q]=u.expandObjectPaths(J)):z[W]=u.expandObjectPaths(z[W]));return z},u.numSeparate=function(z,j,W){if(W||(W=!1),typeof j!="string"||j.length===0)throw new Error("Separator string required for formatting!");typeof z=="number"&&(z=String(z));var ee=/(\d+)(\d{3})/,J=j.charAt(0),Q=j.charAt(1),te=z.split("."),ie=te[0],ae=te.length>1?J+te[1]:"";if(Q&&(te.length>1||ie.length>4||W))for(;ee.test(ie);)ie=ie.replace(ee,"$1"+Q+"$2");return ie+ae},u.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var U=/^\w*$/;u.templateString=function(z,j){var W={};return z.replace(u.TEMPLATE_STRING_REGEX,function(ee,J){var Q;return U.test(J)?Q=j[J]:(W[J]=W[J]||u.nestedProperty(j,J).get,Q=W[J]()),u.isValidTextValue(Q)?Q:""})};var G={max:10,count:0,name:"hovertemplate"};u.hovertemplateString=function(){return Z.apply(G,arguments)};var X={max:10,count:0,name:"texttemplate"};u.texttemplateString=function(){return Z.apply(X,arguments)};var K=/^[:|\|]/;function Z(z,j,W){var ee=this,J=arguments;j||(j={});var Q={};return z.replace(u.TEMPLATE_STRING_REGEX,function(te,ie,ae){var he,se,de,ue=ie==="_xother"||ie==="_yother",ve=ie==="_xother_"||ie==="_yother_",ke=ie==="xother_"||ie==="yother_",Ee=ie==="xother"||ie==="yother"||ue||ke||ve,be=ie;if((ue||ve)&&(be=be.substring(1)),(ke||ve)&&(be=be.substring(0,be.length-1)),Ee){if((he=j[be])===void 0)return""}else for(de=3;de<J.length;de++)if(se=J[de]){if(se.hasOwnProperty(be)){he=se[be];break}if(U.test(be)||(he=u.nestedProperty(se,be).get(),(he=Q[be]||u.nestedProperty(se,be).get())&&(Q[be]=he)),he!==void 0)break}if(he===void 0&&ee)return ee.count<ee.max&&(u.warn("Variable '"+be+"' in "+ee.name+" could not be found!"),he=te),ee.count===ee.max&&u.warn("Too many "+ee.name+" warnings - additional warnings will be suppressed"),ee.count++,te;if(ae){var xe;if(ae[0]===":"&&(he=(xe=W?W.numberFormat:u.numberFormat)(ae.replace(K,""))(he)),ae[0]==="|"){xe=W?W.timeFormat:d;var ce=u.dateTime2ms(he);he=u.formatDate(ce,ae.replace(K,""),!1,xe)}}else{var ge=be+"Label";j.hasOwnProperty(ge)&&(he=j[ge])}return Ee&&(he="("+he+")",(ue||ve)&&(he=" "+he),(ke||ve)&&(he+=" ")),he})}u.subplotSort=function(z,j){for(var W=Math.min(z.length,j.length)+1,ee=0,J=0,Q=0;Q<W;Q++){var te=z.charCodeAt(Q)||0,ie=j.charCodeAt(Q)||0,ae=te>=48&&te<=57,he=ie>=48&&ie<=57;if(ae&&(ee=10*ee+te-48),he&&(J=10*J+ie-48),!ae||!he){if(ee!==J)return ee-J;if(te!==ie)return te-ie}}return J-ee};var H=2e9;u.seedPseudoRandom=function(){H=2e9},u.pseudoRandom=function(){var z=H;return H=(69069*H+1)%4294967296,Math.abs(H-z)<429496729?u.pseudoRandom():H/4294967296},u.fillText=function(z,j,W){var ee=Array.isArray(W)?function(te){W.push(te)}:function(te){W.text=te},J=u.extractOption(z,j,"htx","hovertext");if(u.isValidTextValue(J))return ee(J);var Q=u.extractOption(z,j,"tx","text");return u.isValidTextValue(Q)?ee(Q):void 0},u.isValidTextValue=function(z){return z||z===0},u.formatPercent=function(z,j){j=j||0;for(var W=(Math.round(100*z*Math.pow(10,j))*Math.pow(.1,j)).toFixed(j)+"%",ee=0;ee<j;ee++)W.indexOf(".")!==-1&&(W=(W=W.replace("0%","%")).replace(".%","%"));return W},u.isHidden=function(z){var j=window.getComputedStyle(z).display;return!j||j==="none"},u.strTranslate=function(z,j){return z||j?"translate("+z+","+j+")":""},u.strRotate=function(z){return z?"rotate("+z+")":""},u.strScale=function(z){return z!==1?"scale("+z+")":""},u.getTextTransform=function(z){var j=z.noCenter,W=z.textX,ee=z.textY,J=z.targetX,Q=z.targetY,te=z.anchorX||0,ie=z.anchorY||0,ae=z.rotate,he=z.scale;return he?he>1&&(he=1):he=0,u.strTranslate(J-he*(W+te),Q-he*(ee+ie))+u.strScale(he)+(ae?"rotate("+ae+(j?"":" "+W+" "+ee)+")":"")},u.ensureUniformFontSize=function(z,j){var W=u.extendFlat({},j);return W.size=Math.max(j.size,z._fullLayout.uniformtext.minsize||0),W},u.join2=function(z,j,W){var ee=z.length;return ee>1?z.slice(0,-1).join(j)+W+z[ee-1]:z.join(j)},u.bigFont=function(z){return Math.round(1.2*z)};var Y=u.getFirefoxVersion(),$=Y!==null&&Y<86;u.getPositionFromD3Event=function(){return $?[t.event.layerX,t.event.layerY]:[t.event.offsetX,t.event.offsetY]}},{"../constants/numerical":763,"./anchor_utils":767,"./angles":768,"./array":769,"./clean_number":770,"./clear_responsive":772,"./coerce":773,"./dates":774,"./dom":775,"./extend":777,"./filter_unique":778,"./filter_visible":779,"./geometry2d":782,"./identity":785,"./increment":786,"./is_plain_object":788,"./keyed_container":789,"./localize":790,"./loggers":791,"./make_trace_groups":792,"./matrix":793,"./mod":794,"./nested_property":795,"./noop":796,"./notifier":797,"./preserve_drawing_buffer":801,"./push_unique":802,"./regex":804,"./relative_attr":805,"./relink_private":806,"./search":807,"./sort_object_keys":810,"./stats":811,"./throttle":814,"./to_log_range":815,"@plotly/d3":58,"d3-format":164,"d3-time-format":172,"fast-isnumeric":246}],788:[function(r,I,B){I.exports=function(t){return window&&window.process&&window.process.versions?Object.prototype.toString.call(t)==="[object Object]":Object.prototype.toString.call(t)==="[object Object]"&&Object.getPrototypeOf(t).hasOwnProperty("hasOwnProperty")}},{}],789:[function(r,I,B){var t=r("./nested_property"),d=/^\w*$/;I.exports=function(m,h,e,f){var l,o,u;e=e||"name",f=f||"value";var s={};h&&h.length?(u=t(m,h),o=u.get()):o=m,h=h||"";var i={};if(o)for(l=0;l<o.length;l++)i[o[l][e]]=l;var c=d.test(f),n={set:function(a,g){var p=g===null?4:0;if(!o){if(!u||p===4)return;o=[],u.set(o)}var y=i[a];if(y===void 0){if(p===4)return;p|=3,y=o.length,i[a]=y}else g!==(c?o[y][f]:t(o[y],f).get())&&(p|=2);var v=o[y]=o[y]||{};return v[e]=a,c?v[f]=g:t(v,f).set(g),g!==null&&(p&=-5),s[y]=s[y]|p,n},get:function(a){if(o){var g=i[a];return g===void 0?void 0:c?o[g][f]:t(o[g],f).get()}},rename:function(a,g){var p=i[a];return p===void 0||(s[p]=1|s[p],i[g]=p,delete i[a],o[p][e]=g),n},remove:function(a){var g=i[a];if(g===void 0)return n;var p=o[g];if(Object.keys(p).length>2)return s[g]=2|s[g],n.set(a,null);if(c){for(l=g;l<o.length;l++)s[l]=3|s[l];for(l=g;l<o.length;l++)i[o[l][e]]--;o.splice(g,1),delete i[a]}else t(p,f).set(null),s[g]=6|s[g];return n},constructUpdate:function(){for(var a,g,p={},y=Object.keys(s),v=0;v<y.length;v++)g=y[v],a=h+"["+g+"]",o[g]?(1&s[g]&&(p[a+"."+e]=o[g][e]),2&s[g]&&(p[a+"."+f]=c?4&s[g]?null:o[g][f]:4&s[g]?null:t(o[g],f).get())):p[a]=null;return p}};return n}},{"./nested_property":795}],790:[function(r,I,B){var t=r("../registry");I.exports=function(d,m){for(var h=d._context.locale,e=0;e<2;e++){for(var f=d._context.locales,l=0;l<2;l++){var o=(f[h]||{}).dictionary;if(o){var u=o[m];if(u)return u}f=t.localeRegistry}var s=h.split("-")[0];if(s===h)break;h=s}return m}},{"../registry":915}],791:[function(r,I,B){var t=r("../plot_api/plot_config").dfltConfig,d=r("./notifier"),m=I.exports={};m.log=function(){var h;if(t.logging>1){var e=["LOG:"];for(h=0;h<arguments.length;h++)e.push(arguments[h]);console.trace.apply(console,e)}if(t.notifyOnLogging>1){var f=[];for(h=0;h<arguments.length;h++)f.push(arguments[h]);d(f.join("<br>"),"long")}},m.warn=function(){var h;if(t.logging>0){var e=["WARN:"];for(h=0;h<arguments.length;h++)e.push(arguments[h]);console.trace.apply(console,e)}if(t.notifyOnLogging>0){var f=[];for(h=0;h<arguments.length;h++)f.push(arguments[h]);d(f.join("<br>"),"stick")}},m.error=function(){var h;if(t.logging>0){var e=["ERROR:"];for(h=0;h<arguments.length;h++)e.push(arguments[h]);console.error.apply(console,e)}if(t.notifyOnLogging>0){var f=[];for(h=0;h<arguments.length;h++)f.push(arguments[h]);d(f.join("<br>"),"stick")}}},{"../plot_api/plot_config":825,"./notifier":797}],792:[function(r,I,B){var t=r("@plotly/d3");I.exports=function(d,m,h){var e=d.selectAll("g."+h.replace(/\s/g,".")).data(m,function(l){return l[0].trace.uid});e.exit().remove(),e.enter().append("g").attr("class",h),e.order();var f=d.classed("rangeplot")?"nodeRangePlot3":"node3";return e.each(function(l){l[0][f]=t.select(this)}),e}},{"@plotly/d3":58}],793:[function(r,I,B){var t=r("gl-mat4");B.init2dArray=function(d,m){for(var h=new Array(d),e=0;e<d;e++)h[e]=new Array(m);return h},B.transposeRagged=function(d){var m,h,e=0,f=d.length;for(m=0;m<f;m++)e=Math.max(e,d[m].length);var l=new Array(e);for(m=0;m<e;m++)for(l[m]=new Array(f),h=0;h<f;h++)l[m][h]=d[h][m];return l},B.dot=function(d,m){if(!d.length||!m.length||d.length!==m.length)return null;var h,e,f=d.length;if(d[0].length)for(h=new Array(f),e=0;e<f;e++)h[e]=B.dot(d[e],m);else if(m[0].length){var l=B.transposeRagged(m);for(h=new Array(l.length),e=0;e<l.length;e++)h[e]=B.dot(d,l[e])}else for(h=0,e=0;e<f;e++)h+=d[e]*m[e];return h},B.translationMatrix=function(d,m){return[[1,0,d],[0,1,m],[0,0,1]]},B.rotationMatrix=function(d){var m=d*Math.PI/180;return[[Math.cos(m),-Math.sin(m),0],[Math.sin(m),Math.cos(m),0],[0,0,1]]},B.rotationXYMatrix=function(d,m,h){return B.dot(B.dot(B.translationMatrix(m,h),B.rotationMatrix(d)),B.translationMatrix(-m,-h))},B.apply3DTransform=function(d){return function(){var m=arguments,h=arguments.length===1?m[0]:[m[0],m[1],m[2]||0];return B.dot(d,[h[0],h[1],h[2],1]).slice(0,3)}},B.apply2DTransform=function(d){return function(){var m=arguments;m.length===3&&(m=m[0]);var h=arguments.length===1?m[0]:[m[0],m[1]];return B.dot(d,[h[0],h[1],1]).slice(0,2)}},B.apply2DTransform2=function(d){var m=B.apply2DTransform(d);return function(h){return m(h.slice(0,2)).concat(m(h.slice(2,4)))}},B.convertCssMatrix=function(d){if(d){var m=d.length;if(m===16)return d;if(m===6)return[d[0],d[1],0,0,d[2],d[3],0,0,0,0,1,0,d[4],d[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},B.inverseTransformMatrix=function(d){var m=[];return t.invert(m,d),[[m[0],m[1],m[2],m[3]],[m[4],m[5],m[6],m[7]],[m[8],m[9],m[10],m[11]],[m[12],m[13],m[14],m[15]]]}},{"gl-mat4":292}],794:[function(r,I,B){I.exports={mod:function(t,d){var m=t%d;return m<0?m+d:m},modHalf:function(t,d){return Math.abs(t)>d/2?t-Math.round(t/d)*d:t}}},{}],795:[function(r,I,B){var t=r("fast-isnumeric"),d=r("./array").isArrayOrTypedArray;function m(s,i){return function(){var c,n,a,g,p,y=s;for(g=0;g<i.length-1;g++){if((c=i[g])===-1){for(n=!0,a=[],p=0;p<y.length;p++)a[p]=m(y[p],i.slice(g+1))(),a[p]!==a[0]&&(n=!1);return n?a[0]:a}if(typeof c=="number"&&!d(y)||typeof(y=y[c])!="object"||y===null)return}if(typeof y=="object"&&y!==null&&(a=y[i[g]])!==null)return a}}I.exports=function(s,i){if(t(i))i=String(i);else if(typeof i!="string"||i.substr(i.length-4)==="[-1]")throw"bad property string";for(var c,n,a,g=0,p=i.split(".");g<p.length;){if(c=String(p[g]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/)){if(c[1])p[g]=c[1];else{if(g!==0)throw"bad property string";p.splice(0,1)}for(n=c[2].substr(1,c[2].length-2).split("]["),a=0;a<n.length;a++)g++,p.splice(g,0,Number(n[a]))}g++}return typeof s!="object"?function(y,v,b){return{set:function(){throw"bad container"},get:function(){},astr:v,parts:b,obj:y}}(s,i,p):{set:f(s,p,i),get:m(s,p),astr:i,parts:p,obj:s}};var h=/(^|\.)args\[/;function e(s,i){return s===void 0||s===null&&!i.match(h)}function f(s,i,c){return function(n){var a,g,p=s,y="",v=e(n,c);for(g=0;g<i.length-1;g++){if(typeof(a=i[g])=="number"&&!d(p))throw"array index but container is not an array";if(a===-1){if(v=!o(p,i.slice(g+1),n,c))break;return}if(!u(p,a,i[g+1],v))break;if(typeof(p=p[a])!="object"||p===null)throw"container is not an object";y=l(y,a)}if(v){if(g===i.length-1&&(delete p[i[g]],Array.isArray(p)&&+i[g]==p.length-1))for(;p.length&&p[p.length-1]===void 0;)p.pop()}else p[i[g]]=n}}function l(s,i){var c=i;return t(i)?c="["+i+"]":s&&(c="."+i),s+c}function o(s,i,c,n){var a,g=d(c),p=!0,y=c,v=n.replace("-1",0),b=!g&&e(c,v),x=i[0];for(a=0;a<s.length;a++)v=n.replace("-1",a),g&&(b=e(y=c[a%c.length],v)),b&&(p=!1),u(s,a,x,b)&&f(s[a],i,n.replace("-1",a))(y);return p}function u(s,i,c,n){if(s[i]===void 0){if(n)return!1;s[i]=typeof c=="number"?[]:{}}return!0}},{"./array":769,"fast-isnumeric":246}],796:[function(r,I,B){I.exports=function(){}},{}],797:[function(r,I,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=[];I.exports=function(h,e){if(m.indexOf(h)===-1){m.push(h);var f=1e3;d(e)?f=e:e==="long"&&(f=3e3);var l=t.select("body").selectAll(".plotly-notifier").data([0]);l.enter().append("div").classed("plotly-notifier",!0),l.selectAll(".notifier-note").data(m).enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(u){var s=t.select(this);s.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){s.transition().call(o)});for(var i=s.append("p"),c=u.split(/<br\s*\/?>/g),n=0;n<c.length;n++)n&&i.append("br"),i.append("span").text(c[n]);e==="stick"?s.transition().duration(350).style("opacity",1):s.transition().duration(700).style("opacity",1).transition().delay(f).call(o)})}function o(u){u.duration(700).style("opacity",0).each("end",function(s){var i=m.indexOf(s);i!==-1&&m.splice(i,1),t.select(this).remove()})}}},{"@plotly/d3":58,"fast-isnumeric":246}],798:[function(r,I,B){var t=r("./setcursor"),d="data-savedcursor";I.exports=function(m,h){var e=m.attr(d);if(h){if(!e){for(var f=(m.attr("class")||"").split(" "),l=0;l<f.length;l++){var o=f[l];o.indexOf("cursor-")===0&&m.attr(d,o.substr(7)).classed(o,!1)}m.attr(d)||m.attr(d,"!!")}t(m,h)}else e&&(m.attr(d,null),e==="!!"?t(m):t(m,e))}},{"./setcursor":808}],799:[function(r,I,B){var t=r("./matrix").dot,d=r("../constants/numerical").BADNUM,m=I.exports={};m.tester=function(h){var e,f=h.slice(),l=f[0][0],o=l,u=f[0][1],s=u;for(f.push(f[0]),e=1;e<f.length;e++)l=Math.min(l,f[e][0]),o=Math.max(o,f[e][0]),u=Math.min(u,f[e][1]),s=Math.max(s,f[e][1]);var i,c=!1;f.length===5&&(f[0][0]===f[1][0]?f[2][0]===f[3][0]&&f[0][1]===f[3][1]&&f[1][1]===f[2][1]&&(c=!0,i=function(g){return g[0]===f[0][0]}):f[0][1]===f[1][1]&&f[2][1]===f[3][1]&&f[0][0]===f[3][0]&&f[1][0]===f[2][0]&&(c=!0,i=function(g){return g[1]===f[0][1]}));var n=!0,a=f[0];for(e=1;e<f.length;e++)if(a[0]!==f[e][0]||a[1]!==f[e][1]){n=!1;break}return{xmin:l,xmax:o,ymin:u,ymax:s,pts:f,contains:c?function(g,p){var y=g[0],v=g[1];return!(y===d||y<l||y>o||v===d||v<u||v>s)&&(!p||!i(g))}:function(g,p){var y=g[0],v=g[1];if(y===d||y<l||y>o||v===d||v<u||v>s)return!1;var b,x,T,A,S,w=f.length,E=f[0][0],k=f[0][1],L=0;for(b=1;b<w;b++)if(x=E,T=k,E=f[b][0],k=f[b][1],!(y<(A=Math.min(x,E))||y>Math.max(x,E)||v>Math.max(T,k)))if(v<Math.min(T,k))y!==A&&L++;else{if(v===(S=E===x?v:T+(y-x)*(k-T)/(E-x)))return b!==1||!p;v<=S&&y!==A&&L++}return L%2==1},isRect:c,degenerate:n}},m.isSegmentBent=function(h,e,f,l){var o,u,s,i=h[e],c=[h[f][0]-i[0],h[f][1]-i[1]],n=t(c,c),a=Math.sqrt(n),g=[-c[1]/a,c[0]/a];for(o=e+1;o<f;o++)if(u=[h[o][0]-i[0],h[o][1]-i[1]],(s=t(u,c))<0||s>n||Math.abs(t(u,g))>l)return!0;return!1},m.filter=function(h,e){var f=[h[0]],l=0,o=0;function u(s){h.push(s);var i=f.length,c=l;f.splice(o+1);for(var n=c+1;n<h.length;n++)(n===h.length-1||m.isSegmentBent(h,c,n+1,e))&&(f.push(h[n]),f.length<i-2&&(l=n,o=f.length-1),c=n)}return h.length>1&&u(h.pop()),{addPt:u,raw:h,filtered:f}}},{"../constants/numerical":763,"./matrix":793}],800:[function(r,I,B){(function(t){(function(){var d=r("./show_no_webgl_msg"),m=r("regl");I.exports=function(h,e){var f=h._fullLayout,l=!0;return f._glcanvas.each(function(o){if(!o.regl&&(!o.pick||f._has("parcoords"))){try{o.regl=m({canvas:this,attributes:{antialias:!o.pick,preserveDrawingBuffer:!0},pixelRatio:h._context.plotGlPixelRatio||t.devicePixelRatio,extensions:e||[]})}catch(u){l=!1}o.regl||(l=!1),l&&this.addEventListener("webglcontextlost",function(u){h&&h.emit&&h.emit("plotly_webglcontextlost",{event:u,layer:o.key})},!1)}}),l||d({container:f._glcontainer.node()}),l}}).call(this)}).call(this,typeof vi!="undefined"?vi:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./show_no_webgl_msg":809,regl:526}],801:[function(r,I,B){var t=r("fast-isnumeric"),d=r("is-mobile");I.exports=function(m){var h;if(typeof(h=m&&m.hasOwnProperty("userAgent")?m.userAgent:function(){var i;return typeof navigator!="undefined"&&(i=navigator.userAgent),i&&i.headers&&typeof i.headers["user-agent"]=="string"&&(i=i.headers["user-agent"]),i}())!="string")return!0;var e=d({ua:{headers:{"user-agent":h}},tablet:!0,featureDetect:!1});if(!e){for(var f=h.split(" "),l=1;l<f.length;l++)if(f[l].indexOf("Safari")!==-1)for(var o=l-1;o>-1;o--){var u=f[o];if(u.substr(0,8)==="Version/"){var s=u.substr(8).split(".")[0];if(t(s)&&(s=+s),s>=13)return!0}}}return e}},{"fast-isnumeric":246,"is-mobile":445}],802:[function(r,I,B){I.exports=function(t,d){if(d instanceof RegExp){for(var m=d.toString(),h=0;h<t.length;h++)if(t[h]instanceof RegExp&&t[h].toString()===m)return t;t.push(d)}else!d&&d!==0||t.indexOf(d)!==-1||t.push(d);return t}},{}],803:[function(r,I,B){var t=r("../lib"),d=r("../plot_api/plot_config").dfltConfig,m={add:function(h,e,f,l,o){var u,s;h.undoQueue=h.undoQueue||{index:0,queue:[],sequence:!1},s=h.undoQueue.index,h.autoplay?h.undoQueue.inSequence||(h.autoplay=!1):(!h.undoQueue.sequence||h.undoQueue.beginSequence?(u={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},h.undoQueue.queue.splice(s,h.undoQueue.queue.length-s,u),h.undoQueue.index+=1):u=h.undoQueue.queue[s-1],h.undoQueue.beginSequence=!1,u&&(u.undo.calls.unshift(e),u.undo.args.unshift(f),u.redo.calls.push(l),u.redo.args.push(o)),h.undoQueue.queue.length>d.queueLength&&(h.undoQueue.queue.shift(),h.undoQueue.index--))},startSequence:function(h){h.undoQueue=h.undoQueue||{index:0,queue:[],sequence:!1},h.undoQueue.sequence=!0,h.undoQueue.beginSequence=!0},stopSequence:function(h){h.undoQueue=h.undoQueue||{index:0,queue:[],sequence:!1},h.undoQueue.sequence=!1,h.undoQueue.beginSequence=!1},undo:function(h){var e,f;if(!(h.undoQueue===void 0||isNaN(h.undoQueue.index)||h.undoQueue.index<=0)){for(h.undoQueue.index--,e=h.undoQueue.queue[h.undoQueue.index],h.undoQueue.inSequence=!0,f=0;f<e.undo.calls.length;f++)m.plotDo(h,e.undo.calls[f],e.undo.args[f]);h.undoQueue.inSequence=!1,h.autoplay=!1}},redo:function(h){var e,f;if(!(h.undoQueue===void 0||isNaN(h.undoQueue.index)||h.undoQueue.index>=h.undoQueue.queue.length)){for(e=h.undoQueue.queue[h.undoQueue.index],h.undoQueue.inSequence=!0,f=0;f<e.redo.calls.length;f++)m.plotDo(h,e.redo.calls[f],e.redo.args[f]);h.undoQueue.inSequence=!1,h.autoplay=!1,h.undoQueue.index++}}};m.plotDo=function(h,e,f){h.autoplay=!0,f=function(l,o){for(var u,s=[],i=0;i<o.length;i++)u=o[i],s[i]=u===l?u:typeof u=="object"?Array.isArray(u)?t.extendDeep([],u):t.extendDeepAll({},u):u;return s}(h,f),e.apply(null,f)},I.exports=m},{"../lib":787,"../plot_api/plot_config":825}],804:[function(r,I,B){B.counter=function(t,d,m,h){var e=(d||"")+(m?"":"$"),f=h===!1?"":"^";return t==="xy"?new RegExp(f+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(f+t+"([2-9]|[1-9][0-9]+)?"+e)}},{}],805:[function(r,I,B){var t=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,d=/^[^\.\[\]]+$/;I.exports=function(m,h){for(;h;){var e=m.match(t);if(e)m=e[1];else{if(!m.match(d))throw new Error("bad relativeAttr call:"+[m,h]);m=""}if(h.charAt(0)!=="^")break;h=h.slice(1)}return m&&h.charAt(0)!=="["?m+"."+h:m+h}},{}],806:[function(r,I,B){var t=r("./array").isArrayOrTypedArray,d=r("./is_plain_object");I.exports=function m(h,e){for(var f in e){var l=e[f],o=h[f];if(o!==l)if(f.charAt(0)==="_"||typeof l=="function"){if(f in h)continue;h[f]=l}else if(t(l)&&t(o)&&d(l[0])){if(f==="customdata"||f==="ids")continue;for(var u=Math.min(l.length,o.length),s=0;s<u;s++)o[s]!==l[s]&&d(l[s])&&d(o[s])&&m(o[s],l[s])}else d(l)&&d(o)&&(m(o,l),Object.keys(o).length||delete h[f])}}},{"./array":769,"./is_plain_object":788}],807:[function(r,I,B){var t=r("fast-isnumeric"),d=r("./loggers"),m=r("./identity"),h=r("../constants/numerical").BADNUM;function e(u,s){return u<s}function f(u,s){return u<=s}function l(u,s){return u>s}function o(u,s){return u>=s}B.findBin=function(u,s,i){if(t(s.start))return i?Math.ceil((u-s.start)/s.size-1e-9)-1:Math.floor((u-s.start)/s.size+1e-9);var c,n,a=0,g=s.length,p=0,y=g>1?(s[g-1]-s[0])/(g-1):1;for(n=y>=0?i?e:f:i?o:l,u+=1e-9*y*(i?-1:1)*(y>=0?1:-1);a<g&&p++<100;)n(s[c=Math.floor((a+g)/2)],u)?a=c+1:g=c;return p>90&&d.log("Long binary search..."),a-1},B.sorterAsc=function(u,s){return u-s},B.sorterDes=function(u,s){return s-u},B.distinctVals=function(u){var s,i=u.slice();for(i.sort(B.sorterAsc),s=i.length-1;s>-1&&i[s]===h;s--);for(var c,n=i[s]-i[0]||1,a=n/(s||1)/1e4,g=[],p=0;p<=s;p++){var y=i[p],v=y-c;c===void 0?(g.push(y),c=y):v>a&&(n=Math.min(n,v),g.push(y),c=y)}return{vals:g,minDiff:n}},B.roundUp=function(u,s,i){for(var c,n=0,a=s.length-1,g=0,p=i?0:1,y=i?1:0,v=i?Math.ceil:Math.floor;n<a&&g++<100;)s[c=v((n+a)/2)]<=u?n=c+p:a=c-y;return s[n]},B.sort=function(u,s){for(var i=0,c=0,n=1;n<u.length;n++){var a=s(u[n],u[n-1]);if(a<0?i=1:a>0&&(c=1),i&&c)return u.sort(s)}return c?u:u.reverse()},B.findIndexOfMin=function(u,s){s=s||m;for(var i,c=1/0,n=0;n<u.length;n++){var a=s(u[n]);a<c&&(c=a,i=n)}return i}},{"../constants/numerical":763,"./identity":785,"./loggers":791,"fast-isnumeric":246}],808:[function(r,I,B){I.exports=function(t,d){(t.attr("class")||"").split(" ").forEach(function(m){m.indexOf("cursor-")===0&&t.classed(m,!1)}),d&&t.classed("cursor-"+d,!0)}},{}],809:[function(r,I,B){var t=r("../components/color"),d=function(){};I.exports=function(m){for(var h in m)typeof m[h]=="function"&&(m[h]=d);m.destroy=function(){m.container.parentNode.removeChild(m.container)};var e=document.createElement("div");e.className="no-webgl",e.style.cursor="pointer",e.style.fontSize="24px",e.style.color=t.defaults[0],e.style.position="absolute",e.style.left=e.style.top="0px",e.style.width=e.style.height="100%",e.style["background-color"]=t.lightLine,e.style["z-index"]=30;var f=document.createElement("p");return f.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",f.style.position="relative",f.style.top="50%",f.style.left="50%",f.style.height="30%",f.style.width="50%",f.style.margin="-15% 0 0 -25%",e.appendChild(f),m.container.appendChild(e),m.container.style.background="#FFFFFF",m.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":650}],810:[function(r,I,B){I.exports=function(t){return Object.keys(t).sort()}},{}],811:[function(r,I,B){var t=r("fast-isnumeric"),d=r("./array").isArrayOrTypedArray;B.aggNums=function(m,h,e,f){var l,o;if((!f||f>e.length)&&(f=e.length),t(h)||(h=!1),d(e[0])){for(o=new Array(f),l=0;l<f;l++)o[l]=B.aggNums(m,h,e[l]);e=o}for(l=0;l<f;l++)t(h)?t(e[l])&&(h=m(+h,+e[l])):h=e[l];return h},B.len=function(m){return B.aggNums(function(h){return h+1},0,m)},B.mean=function(m,h){return h||(h=B.len(m)),B.aggNums(function(e,f){return e+f},0,m)/h},B.midRange=function(m){if(m!==void 0&&m.length!==0)return(B.aggNums(Math.max,null,m)+B.aggNums(Math.min,null,m))/2},B.variance=function(m,h,e){return h||(h=B.len(m)),t(e)||(e=B.mean(m,h)),B.aggNums(function(f,l){return f+Math.pow(l-e,2)},0,m)/h},B.stdev=function(m,h,e){return Math.sqrt(B.variance(m,h,e))},B.median=function(m){var h=m.slice().sort();return B.interp(h,.5)},B.interp=function(m,h){if(!t(h))throw"n should be a finite number";if((h=h*m.length-.5)<0)return m[0];if(h>m.length-1)return m[m.length-1];var e=h%1;return e*m[Math.ceil(h)]+(1-e)*m[Math.floor(h)]}},{"./array":769,"fast-isnumeric":246}],812:[function(r,I,B){var t=r("color-normalize");I.exports=function(d){return d?t(d):[0,0,0,1]}},{"color-normalize":131}],813:[function(r,I,B){var t=r("@plotly/d3"),d=r("../lib"),m=d.strTranslate,h=r("../constants/xmlns_namespaces"),e=r("../constants/alignment").LINE_SPACING;function f(P,D){return P.node().getBoundingClientRect()[D]}var l=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;B.convertToTspans=function(P,D,N){var U=P.text(),G=!P.attr("data-notex")&&typeof MathJax!="undefined"&&U.match(l),X=t.select(P.node().parentNode);if(!X.empty()){var K=P.attr("class")?P.attr("class").split(" ")[0]:"text";return K+="-math",X.selectAll("svg."+K).remove(),X.selectAll("g."+K+"-group").remove(),P.style("display",null).attr({"data-unformatted":U,"data-math":"N"}),G?(D&&D._promises||[]).push(new Promise(function(H){P.style("display","none");var Y=parseInt(P.node().style.fontSize,10),$={fontSize:Y};(function(z,j,W){var ee,J,Q,te;MathJax.Hub.Queue(function(){return J=d.extendDeepAll({},MathJax.Hub.config),Q=MathJax.Hub.processSectionDelay,MathJax.Hub.processSectionDelay!==void 0&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]},displayAlign:"left"})},function(){if((ee=MathJax.Hub.config.menuSettings.renderer)!=="SVG")return MathJax.Hub.setRenderer("SVG")},function(){var ie="math-output-"+d.randstr({},64);return te=t.select("body").append("div").attr({id:ie}).style({visibility:"hidden",position:"absolute"}).style({"font-size":j.fontSize+"px"}).text(z.replace(o,"\\lt ").replace(u,"\\gt ")),MathJax.Hub.Typeset(te.node())},function(){var ie=t.select("body").select("#MathJax_SVG_glyphs");if(te.select(".MathJax_SVG").empty()||!te.select("svg").node())d.log("There was an error in the tex syntax.",z),W();else{var ae=te.select("svg").node().getBoundingClientRect();W(te.select(".MathJax_SVG"),ie,ae)}if(te.remove(),ee!=="SVG")return MathJax.Hub.setRenderer(ee)},function(){return Q!==void 0&&(MathJax.Hub.processSectionDelay=Q),MathJax.Hub.Config(J)})})(G[2],$,function(z,j,W){X.selectAll("svg."+K).remove(),X.selectAll("g."+K+"-group").remove();var ee=z&&z.select("svg");if(!ee||!ee.node())return Z(),void H();var J=X.append("g").classed(K+"-group",!0).attr({"pointer-events":"none","data-unformatted":U,"data-math":"Y"});J.node().appendChild(ee.node()),j&&j.node()&&ee.node().insertBefore(j.node().cloneNode(!0),ee.node().firstChild),ee.attr({class:K,height:W.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var Q=P.node().style.fill||"black",te=ee.select("g");te.attr({fill:Q,stroke:Q});var ie=f(te,"width"),ae=f(te,"height"),he=+P.attr("x")-ie*{start:0,middle:.5,end:1}[P.attr("text-anchor")||"start"],se=-(Y||f(P,"height"))/4;K[0]==="y"?(J.attr({transform:"rotate("+[-90,+P.attr("x"),+P.attr("y")]+")"+m(-ie/2,se-ae/2)}),ee.attr({x:+P.attr("x"),y:+P.attr("y")})):K[0]==="l"?ee.attr({x:P.attr("x"),y:se-ae/2}):K[0]==="a"&&K.indexOf("atitle")!==0?ee.attr({x:0,y:se}):ee.attr({x:he,y:+P.attr("y")+se-ae/2}),N&&N.call(P,J),H(J)})})):Z(),P}function Z(){X.empty()||(K=P.attr("class")+"-math",X.select("svg."+K).remove()),P.text("").style("white-space","pre"),function(H,Y){Y=Y.replace(a," ");var $,z=!1,j=[],W=-1;function ee(){W++;var ce=document.createElementNS(h.svg,"tspan");t.select(ce).attr({class:"line",dy:W*e+"em"}),H.appendChild(ce),$=ce;var ge=j;if(j=[{node:ce}],ge.length>1)for(var we=1;we<ge.length;we++)J(ge[we])}function J(ce){var ge,we=ce.type,Me={};if(we==="a"){ge="a";var Se=ce.target,ze=ce.href,Fe=ce.popup;ze&&(Me={"xlink:xlink:show":Se==="_blank"||Se.charAt(0)!=="_"?"new":"replace",target:Se,"xlink:xlink:href":ze},Fe&&(Me.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+Fe+'");return false;'))}else ge="tspan";ce.style&&(Me.style=ce.style);var Ye=document.createElementNS(h.svg,ge);if(we==="sup"||we==="sub"){Q($,"\u200B"),$.appendChild(Ye);var rt=document.createElementNS(h.svg,"tspan");Q(rt,"\u200B"),t.select(rt).attr("dy",c[we]),Me.dy=i[we],$.appendChild(Ye),$.appendChild(rt)}else $.appendChild(Ye);t.select(Ye).attr(Me),$=ce.node=Ye,j.push(ce)}function Q(ce,ge){ce.appendChild(document.createTextNode(ge))}function te(ce){if(j.length!==1){var ge=j.pop();ce!==ge.type&&d.log("Start tag <"+ge.type+"> doesnt match end tag <"+ce+">. Pretending it did match.",Y),$=j[j.length-1].node}else d.log("Ignoring unexpected end tag </"+ce+">.",Y)}y.test(Y)?ee():($=H,j=[{node:H}]);for(var ie=Y.split(g),ae=0;ae<ie.length;ae++){var he=ie[ae],se=he.match(p),de=se&&se[2].toLowerCase(),ue=s[de];if(de==="br")ee();else if(ue===void 0)Q($,k(he));else if(se[1])te(de);else{var ve=se[4],ke={type:de},Ee=A(ve,v);if(Ee?(Ee=Ee.replace(S,"$1 fill:"),ue&&(Ee+=";"+ue)):ue&&(Ee=ue),Ee&&(ke.style=Ee),de==="a"){z=!0;var be=A(ve,b);if(be){var xe=L(be);xe&&(ke.href=xe,ke.target=A(ve,x)||"_blank",ke.popup=A(ve,T))}}J(ke)}}return z}(P.node(),U)&&P.style("pointer-events","all"),B.positionText(P),N&&N.call(P)}};var o=/(<|&lt;|&#60;)/g,u=/(>|&gt;|&#62;)/g,s={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},i={sub:"0.3em",sup:"-0.6em"},c={sub:"-0.21em",sup:"0.42em"},n=["http:","https:","mailto:","",void 0,":"],a=B.NEWLINES=/(\r\n?|\n)/g,g=/(<[^<>]*>)/,p=/<(\/?)([^ >]*)(\s+(.*))?>/i,y=/<br(\s+.*)?>/i;B.BR_TAG_ALL=/<br(\s+.*)?>/gi;var v=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,b=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,x=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,T=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function A(P,D){if(!P)return null;var N=P.match(D),U=N&&(N[3]||N[4]);return U&&k(U)}var S=/(^|;)\s*color:/;B.plainText=function(P,D){for(var N=(D=D||{}).len!==void 0&&D.len!==-1?D.len:1/0,U=D.allowedTags!==void 0?D.allowedTags:["br"],G="...".length,X=P.split(g),K=[],Z="",H=0,Y=0;Y<X.length;Y++){var $=X[Y],z=$.match(p),j=z&&z[2].toLowerCase();if(j)U.indexOf(j)!==-1&&(K.push($),Z=j);else{var W=$.length;if(H+W<N)K.push($),H+=W;else if(H<N){var ee=N-H;Z&&(Z!=="br"||ee<=G||W<=G)&&K.pop(),N>G?K.push($.substr(0,ee-G)+"..."):K.push($.substr(0,ee));break}Z=""}}return K.join("")};var w={mu:"\u03BC",amp:"&",lt:"<",gt:">",nbsp:"\xA0",times:"\xD7",plusmn:"\xB1",deg:"\xB0"},E=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function k(P){return P.replace(E,function(D,N){return(N.charAt(0)==="#"?function(U){if(!(U>1114111)){var G=String.fromCodePoint;if(G)return G(U);var X=String.fromCharCode;return U<=65535?X(U):X(55232+(U>>10),U%1024+56320)}}(N.charAt(1)==="x"?parseInt(N.substr(2),16):parseInt(N.substr(1),10)):w[N])||D})}function L(P){var D=encodeURI(decodeURI(P)),N=document.createElement("a"),U=document.createElement("a");N.href=P,U.href=D;var G=N.protocol,X=U.protocol;return n.indexOf(G)!==-1&&n.indexOf(X)!==-1?D:""}function M(P,D,N){var U,G,X,K=N.horizontalAlign,Z=N.verticalAlign||"top",H=P.node().getBoundingClientRect(),Y=D.node().getBoundingClientRect();return G=Z==="bottom"?function(){return H.bottom-U.height}:Z==="middle"?function(){return H.top+(H.height-U.height)/2}:function(){return H.top},X=K==="right"?function(){return H.right-U.width}:K==="center"?function(){return H.left+(H.width-U.width)/2}:function(){return H.left},function(){U=this.node().getBoundingClientRect();var $=X()-Y.left,z=G()-Y.top,j=N.gd||{};if(N.gd){j._fullLayout._calcInverseTransform(j);var W=d.apply3DTransform(j._fullLayout._invTransform)($,z);$=W[0],z=W[1]}return this.style({top:z+"px",left:$+"px","z-index":1e3}),this}}B.convertEntities=k,B.sanitizeHTML=function(P){P=P.replace(a," ");for(var D=document.createElement("p"),N=D,U=[],G=P.split(g),X=0;X<G.length;X++){var K=G[X],Z=K.match(p),H=Z&&Z[2].toLowerCase();if(H in s)if(Z[1])U.length&&(N=U.pop());else{var Y=Z[4],$=A(Y,v),z=$?{style:$}:{};if(H==="a"){var j=A(Y,b);if(j){var W=L(j);if(W){z.href=W;var ee=A(Y,x);ee&&(z.target=ee)}}}var J=document.createElement(H);N.appendChild(J),t.select(J).attr(z),N=J,U.push(J)}else N.appendChild(document.createTextNode(k(K)))}return D.innerHTML},B.lineCount=function(P){return P.selectAll("tspan.line").size()||1},B.positionText=function(P,D,N){return P.each(function(){var U=t.select(this);function G(Z,H){return H===void 0?(H=U.attr(Z))===null&&(U.attr(Z,0),H=0):U.attr(Z,H),H}var X=G("x",D),K=G("y",N);this.nodeName==="text"&&U.selectAll("tspan.line").attr({x:X,y:K})})},B.makeTextShadow=function(P){var D="1px ",N="1px ",U="1px ";return D+N+U+P+", -"+D+"-"+N+U+P+", "+D+"-"+N+U+P+", -"+D+N+U+P},B.makeEditable=function(P,D){var N=D.gd,U=D.delegate,G=t.dispatch("edit","input","cancel"),X=U||P;if(P.style({"pointer-events":U?"none":"all"}),P.size()!==1)throw new Error("boo");function K(){(function(){var $=t.select(N).select(".svg-container"),z=$.append("div"),j=P.node().style,W=parseFloat(j.fontSize||12),ee=D.text;ee===void 0&&(ee=P.attr("data-unformatted")),z.classed("plugin-editable editable",!0).style({position:"absolute","font-family":j.fontFamily||"Arial","font-size":W,color:D.fill||j.fill||"black",opacity:1,"background-color":D.background||"transparent",outline:"#ffffff33 1px solid",margin:[-W/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(ee).call(M(P,$,D)).on("blur",function(){N._editing=!1,P.text(this.textContent).style({opacity:1});var J,Q=t.select(this).attr("class");(J=Q?"."+Q.split(" ")[0]+"-math-group":"[class*=-math-group]")&&t.select(P.node().parentNode).select(J).style({opacity:0});var te=this.textContent;t.select(this).transition().duration(0).remove(),t.select(document).on("mouseup",null),G.edit.call(P,te)}).on("focus",function(){var J=this;N._editing=!0,t.select(document).on("mouseup",function(){if(t.event.target===J)return!1;document.activeElement===z.node()&&z.node().blur()})}).on("keyup",function(){t.event.which===27?(N._editing=!1,P.style({opacity:1}),t.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),G.cancel.call(P,this.textContent)):(G.input.call(P,this.textContent),t.select(this).call(M(P,$,D)))}).on("keydown",function(){t.event.which===13&&this.blur()}).call(Z)})(),P.style({opacity:0});var H,Y=X.attr("class");(H=Y?"."+Y.split(" ")[0]+"-math-group":"[class*=-math-group]")&&t.select(P.node().parentNode).select(H).style({opacity:0})}function Z(H){var Y=H.node(),$=document.createRange();$.selectNodeContents(Y);var z=window.getSelection();z.removeAllRanges(),z.addRange($),Y.focus()}return D.immediate?K():X.on("click",K),t.rebind(P,G,"on")}},{"../constants/alignment":755,"../constants/xmlns_namespaces":764,"../lib":787,"@plotly/d3":58}],814:[function(r,I,B){var t={};function d(m){m&&m.timer!==null&&(clearTimeout(m.timer),m.timer=null)}B.throttle=function(m,h,e){var f=t[m],l=Date.now();if(!f){for(var o in t)t[o].ts<l-6e4&&delete t[o];f=t[m]={ts:0,timer:null}}function u(){e(),f.ts=Date.now(),f.onDone&&(f.onDone(),f.onDone=null)}d(f),l>f.ts+h?u():f.timer=setTimeout(function(){u(),f.timer=null},h)},B.done=function(m){var h=t[m];return h&&h.timer?new Promise(function(e){var f=h.onDone;h.onDone=function(){f&&f(),e(),h.onDone=null}}):Promise.resolve()},B.clear=function(m){if(m)d(t[m]),delete t[m];else for(var h in t)B.clear(h)}},{}],815:[function(r,I,B){var t=r("fast-isnumeric");I.exports=function(d,m){if(d>0)return Math.log(d)/Math.LN10;var h=Math.log(Math.min(m[0],m[1]))/Math.LN10;return t(h)||(h=Math.log(Math.max(m[0],m[1]))/Math.LN10-6),h}},{"fast-isnumeric":246}],816:[function(r,I,B){var t=I.exports={},d=r("../plots/geo/constants").locationmodeToLayer,m=r("topojson-client").feature;t.getTopojsonName=function(h){return[h.scope.replace(/ /g,"-"),"_",h.resolution.toString(),"m"].join("")},t.getTopojsonPath=function(h,e){return h+e+".json"},t.getTopojsonFeatures=function(h,e){var f=d[h.locationmode],l=e.objects[f];return m(e,l).features}},{"../plots/geo/constants":869,"topojson-client":586}],817:[function(r,I,B){I.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],818:[function(r,I,B){I.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],819:[function(r,I,B){var t=r("../registry");I.exports=function(d){for(var m,h,e=t.layoutArrayContainers,f=t.layoutArrayRegexes,l=d.split("[")[0],o=0;o<f.length;o++)if((h=d.match(f[o]))&&h.index===0){m=h[0];break}if(m||(m=e[e.indexOf(l)]),!m)return!1;var u=d.substr(m.length);return u?!!(h=u.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/))&&{array:m,index:Number(h[1]),property:h[3]||""}:{array:m,index:"",property:""}}},{"../registry":915}],820:[function(r,I,B){var t=r("../lib"),d=t.extendFlat,m=t.isPlainObject,h={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},f=h.flags.slice().concat(["fullReplot"]),l=e.flags.slice().concat("layoutReplot");function o(i){for(var c={},n=0;n<i.length;n++)c[i[n]]=!1;return c}function u(i,c,n){var a=d({},i);for(var g in a){var p=a[g];m(p)&&(a[g]=s(p,c,n,g))}return n==="from-root"&&(a.editType=c),a}function s(i,c,n,a){if(i.valType){var g=d({},i);if(g.editType=c,Array.isArray(i.items)){g.items=new Array(i.items.length);for(var p=0;p<i.items.length;p++)g.items[p]=s(i.items[p],c)}return g}return u(i,c,a.charAt(0)==="_"?"nested":"from-root")}I.exports={traces:h,layout:e,traceFlags:function(){return o(f)},layoutFlags:function(){return o(l)},update:function(i,c){var n=c.editType;if(n&&n!=="none")for(var a=n.split("+"),g=0;g<a.length;g++)i[a[g]]=!0},overrideAll:u}},{"../lib":787}],821:[function(r,I,B){var t=r("fast-isnumeric"),d=r("gl-mat4/fromQuat"),m=r("../registry"),h=r("../lib"),e=r("../plots/plots"),f=r("../plots/cartesian/axis_ids"),l=r("../components/color"),o=f.cleanId,u=f.getFromTrace,s=m.traceIs;function i(x,T){var A=x[T],S=T.charAt(0);A&&A!=="paper"&&(x[T]=o(A,S,!0))}function c(x){function T(A,S){var w=x[A],E=x.title&&x.title[S];w&&!E&&(x.title||(x.title={}),x.title[S]=x[A],delete x[A])}x&&(typeof x.title!="string"&&typeof x.title!="number"||(x.title={text:x.title}),T("titlefont","font"),T("titleposition","position"),T("titleside","side"),T("titleoffset","offset"))}function n(x){if(!h.isPlainObject(x))return!1;var T=x.name;return delete x.name,delete x.showlegend,(typeof T=="string"||typeof T=="number")&&String(T)}function a(x,T,A,S){if(A&&!S)return x;if(S&&!A||!x.trim())return T;if(!T.trim())return x;var w,E=Math.min(x.length,T.length);for(w=0;w<E&&x.charAt(w)===T.charAt(w);w++);return x.substr(0,w).trim()}function g(x){var T="middle",A="center";return typeof x=="string"&&(x.indexOf("top")!==-1?T="top":x.indexOf("bottom")!==-1&&(T="bottom"),x.indexOf("left")!==-1?A="left":x.indexOf("right")!==-1&&(A="right")),T+" "+A}function p(x,T){return T in x&&typeof x[T]=="object"&&Object.keys(x[T]).length===0}B.clearPromiseQueue=function(x){Array.isArray(x._promises)&&x._promises.length>0&&h.log("Clearing previous rejected promises from queue."),x._promises=[]},B.cleanLayout=function(x){var T,A;x||(x={}),x.xaxis1&&(x.xaxis||(x.xaxis=x.xaxis1),delete x.xaxis1),x.yaxis1&&(x.yaxis||(x.yaxis=x.yaxis1),delete x.yaxis1),x.scene1&&(x.scene||(x.scene=x.scene1),delete x.scene1);var S=(e.subplotsRegistry.cartesian||{}).attrRegex,w=(e.subplotsRegistry.polar||{}).attrRegex,E=(e.subplotsRegistry.ternary||{}).attrRegex,k=(e.subplotsRegistry.gl3d||{}).attrRegex,L=Object.keys(x);for(T=0;T<L.length;T++){var M=L[T];if(S&&S.test(M)){var P=x[M];P.anchor&&P.anchor!=="free"&&(P.anchor=o(P.anchor)),P.overlaying&&(P.overlaying=o(P.overlaying)),P.type||(P.isdate?P.type="date":P.islog?P.type="log":P.isdate===!1&&P.islog===!1&&(P.type="linear")),P.autorange!=="withzero"&&P.autorange!=="tozero"||(P.autorange=!0,P.rangemode="tozero"),delete P.islog,delete P.isdate,delete P.categories,p(P,"domain")&&delete P.domain,P.autotick!==void 0&&(P.tickmode===void 0&&(P.tickmode=P.autotick?"auto":"linear"),delete P.autotick),c(P)}else if(w&&w.test(M))c(x[M].radialaxis);else if(E&&E.test(M)){var D=x[M];c(D.aaxis),c(D.baxis),c(D.caxis)}else if(k&&k.test(M)){var N=x[M],U=N.cameraposition;if(Array.isArray(U)&&U[0].length===4){var G=U[0],X=U[1],K=U[2],Z=d([],G),H=[];for(A=0;A<3;++A)H[A]=X[A]+K*Z[2+4*A];N.camera={eye:{x:H[0],y:H[1],z:H[2]},center:{x:X[0],y:X[1],z:X[2]},up:{x:0,y:0,z:1}},delete N.cameraposition}c(N.xaxis),c(N.yaxis),c(N.zaxis)}}var Y=Array.isArray(x.annotations)?x.annotations.length:0;for(T=0;T<Y;T++){var $=x.annotations[T];h.isPlainObject($)&&($.ref&&($.ref==="paper"?($.xref="paper",$.yref="paper"):$.ref==="data"&&($.xref="x",$.yref="y"),delete $.ref),i($,"xref"),i($,"yref"))}var z=Array.isArray(x.shapes)?x.shapes.length:0;for(T=0;T<z;T++){var j=x.shapes[T];h.isPlainObject(j)&&(i(j,"xref"),i(j,"yref"))}var W=Array.isArray(x.images)?x.images.length:0;for(T=0;T<W;T++){var ee=x.images[T];h.isPlainObject(ee)&&(i(ee,"xref"),i(ee,"yref"))}var J=x.legend;return J&&(J.x>3?(J.x=1.02,J.xanchor="left"):J.x<-2&&(J.x=-.02,J.xanchor="right"),J.y>3?(J.y=1.02,J.yanchor="bottom"):J.y<-2&&(J.y=-.02,J.yanchor="top")),c(x),x.dragmode==="rotate"&&(x.dragmode="orbit"),l.clean(x),x.template&&x.template.layout&&B.cleanLayout(x.template.layout),x},B.cleanData=function(x){for(var T=0;T<x.length;T++){var A,S=x[T];if(S.type==="histogramy"&&"xbins"in S&&!("ybins"in S)&&(S.ybins=S.xbins,delete S.xbins),S.error_y&&"opacity"in S.error_y){var w=l.defaults,E=S.error_y.color||(s(S,"bar")?l.defaultLine:w[T%w.length]);S.error_y.color=l.addOpacity(l.rgb(E),l.opacity(E)*S.error_y.opacity),delete S.error_y.opacity}if("bardir"in S&&(S.bardir!=="h"||!s(S,"bar")&&S.type.substr(0,9)!=="histogram"||(S.orientation="h",B.swapXYData(S)),delete S.bardir),S.type==="histogramy"&&B.swapXYData(S),S.type!=="histogramx"&&S.type!=="histogramy"||(S.type="histogram"),"scl"in S&&!("colorscale"in S)&&(S.colorscale=S.scl,delete S.scl),"reversescl"in S&&!("reversescale"in S)&&(S.reversescale=S.reversescl,delete S.reversescl),S.xaxis&&(S.xaxis=o(S.xaxis,"x")),S.yaxis&&(S.yaxis=o(S.yaxis,"y")),s(S,"gl3d")&&S.scene&&(S.scene=e.subplotsRegistry.gl3d.cleanId(S.scene)),!s(S,"pie-like")&&!s(S,"bar-like"))if(Array.isArray(S.textposition))for(A=0;A<S.textposition.length;A++)S.textposition[A]=g(S.textposition[A]);else S.textposition&&(S.textposition=g(S.textposition));var k=m.getModule(S);if(k&&k.colorbar){var L=k.colorbar.container,M=L?S[L]:S;M&&M.colorscale&&(M.colorscale==="YIGnBu"&&(M.colorscale="YlGnBu"),M.colorscale==="YIOrRd"&&(M.colorscale="YlOrRd"))}if(S.type==="surface"&&h.isPlainObject(S.contours)){var P=["x","y","z"];for(A=0;A<P.length;A++){var D=S.contours[P[A]];h.isPlainObject(D)&&(D.highlightColor&&(D.highlightcolor=D.highlightColor,delete D.highlightColor),D.highlightWidth&&(D.highlightwidth=D.highlightWidth,delete D.highlightWidth))}}if(S.type==="candlestick"||S.type==="ohlc"){var N=(S.increasing||{}).showlegend!==!1,U=(S.decreasing||{}).showlegend!==!1,G=n(S.increasing),X=n(S.decreasing);if(G!==!1&&X!==!1){var K=a(G,X,N,U);K&&(S.name=K)}else!G&&!X||S.name||(S.name=G||X)}if(Array.isArray(S.transforms)){var Z=S.transforms;for(A=0;A<Z.length;A++){var H=Z[A];if(h.isPlainObject(H))switch(H.type){case"filter":H.filtersrc&&(H.target=H.filtersrc,delete H.filtersrc),H.calendar&&(H.valuecalendar||(H.valuecalendar=H.calendar),delete H.calendar);break;case"groupby":if(H.styles=H.styles||H.style,H.styles&&!Array.isArray(H.styles)){var Y=H.styles,$=Object.keys(Y);H.styles=[];for(var z=0;z<$.length;z++)H.styles.push({target:$[z],value:Y[$[z]]})}}}}p(S,"line")&&delete S.line,"marker"in S&&(p(S.marker,"line")&&delete S.marker.line,p(S,"marker")&&delete S.marker),l.clean(S),S.autobinx&&(delete S.autobinx,delete S.xbins),S.autobiny&&(delete S.autobiny,delete S.ybins),c(S),S.colorbar&&c(S.colorbar),S.marker&&S.marker.colorbar&&c(S.marker.colorbar),S.line&&S.line.colorbar&&c(S.line.colorbar),S.aaxis&&c(S.aaxis),S.baxis&&c(S.baxis)}},B.swapXYData=function(x){var T;if(h.swapAttrs(x,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(x.z)&&Array.isArray(x.z[0])&&(x.transpose?delete x.transpose:x.transpose=!0),x.error_x&&x.error_y){var A=x.error_y,S="copy_ystyle"in A?A.copy_ystyle:!(A.color||A.thickness||A.width);h.swapAttrs(x,["error_?.copy_ystyle"]),S&&h.swapAttrs(x,["error_?.color","error_?.thickness","error_?.width"])}if(typeof x.hoverinfo=="string"){var w=x.hoverinfo.split("+");for(T=0;T<w.length;T++)w[T]==="x"?w[T]="y":w[T]==="y"&&(w[T]="x");x.hoverinfo=w.join("+")}},B.coerceTraceIndices=function(x,T){if(t(T))return[T];if(!Array.isArray(T)||!T.length)return x.data.map(function(w,E){return E});if(Array.isArray(T)){for(var A=[],S=0;S<T.length;S++)h.isIndex(T[S],x.data.length)?A.push(T[S]):h.warn("trace index (",T[S],") is not a number or is out of bounds");return A}return T},B.manageArrayContainers=function(x,T,A){var S=x.obj,w=x.parts,E=w.length,k=w[E-1],L=t(k);if(L&&T===null){var M=w.slice(0,E-1).join(".");h.nestedProperty(S,M).get().splice(k,1)}else L&&x.get()===void 0&&x.get()===void 0&&(A[x.astr]=null),x.set(T)};var y=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function v(x){var T=x.search(y);if(T>0)return x.substr(0,T)}B.hasParent=function(x,T){for(var A=v(T);A;){if(A in x)return!0;A=v(A)}return!1};var b=["x","y","z"];B.clearAxisTypes=function(x,T,A){for(var S=0;S<T.length;S++)for(var w=x._fullData[S],E=0;E<3;E++){var k=u(x,w,b[E]);if(k&&k.type!=="log"){var L=k._name,M=k._id.substr(1);if(M.substr(0,5)==="scene"){if(A[M]!==void 0)continue;L=M+"."+L}var P=L+".type";A[L]===void 0&&A[P]===void 0&&h.nestedProperty(x.layout,P).set(null)}}}},{"../components/color":650,"../lib":787,"../plots/cartesian/axis_ids":842,"../plots/plots":901,"../registry":915,"fast-isnumeric":246,"gl-mat4/fromQuat":282}],822:[function(r,I,B){var t=r("./plot_api");B._doPlot=t._doPlot,B.newPlot=t.newPlot,B.restyle=t.restyle,B.relayout=t.relayout,B.redraw=t.redraw,B.update=t.update,B._guiRestyle=t._guiRestyle,B._guiRelayout=t._guiRelayout,B._guiUpdate=t._guiUpdate,B._storeDirectGUIEdit=t._storeDirectGUIEdit,B.react=t.react,B.extendTraces=t.extendTraces,B.prependTraces=t.prependTraces,B.addTraces=t.addTraces,B.deleteTraces=t.deleteTraces,B.moveTraces=t.moveTraces,B.purge=t.purge,B.addFrames=t.addFrames,B.deleteFrames=t.deleteFrames,B.animate=t.animate,B.setPlotConfig=t.setPlotConfig,B.toImage=r("./to_image"),B.validate=r("./validate"),B.downloadImage=r("../snapshot/download");var d=r("./template_api");B.makeTemplate=d.makeTemplate,B.validateTemplate=d.validateTemplate},{"../snapshot/download":917,"./plot_api":824,"./template_api":829,"./to_image":830,"./validate":831}],823:[function(r,I,B){var t=r("../lib/is_plain_object"),d=r("../lib/noop"),m=r("../lib/loggers"),h=r("../lib/search").sorterAsc,e=r("../registry");B.containerArrayMatch=r("./container_array_match");var f=B.isAddVal=function(o){return o==="add"||t(o)},l=B.isRemoveVal=function(o){return o===null||o==="remove"};B.applyContainerArrayChanges=function(o,u,s,i,c){var n=u.astr,a=e.getComponentMethod(n,"supplyLayoutDefaults"),g=e.getComponentMethod(n,"draw"),p=e.getComponentMethod(n,"drawOne"),y=i.replot||i.recalc||a===d||g===d,v=o.layout,b=o._fullLayout;if(s[""]){Object.keys(s).length>1&&m.warn("Full array edits are incompatible with other edits",n);var x=s[""][""];if(l(x))u.set(null);else{if(!Array.isArray(x))return m.warn("Unrecognized full array edit value",n,x),!0;u.set(x)}return!y&&(a(v,b),g(o),!0)}var T,A,S,w,E,k,L,M,P=Object.keys(s).map(Number).sort(h),D=u.get(),N=D||[],U=c(b,n).get(),G=[],X=-1,K=N.length;for(T=0;T<P.length;T++)if(w=s[S=P[T]],E=Object.keys(w),k=w[""],L=f(k),S<0||S>N.length-(L?0:1))m.warn("index out of range",n,S);else if(k!==void 0)E.length>1&&m.warn("Insertion & removal are incompatible with edits to the same index.",n,S),l(k)?G.push(S):L?(k==="add"&&(k={}),N.splice(S,0,k),U&&U.splice(S,0,{})):m.warn("Unrecognized full object edit value",n,S,k),X===-1&&(X=S);else for(A=0;A<E.length;A++)M=n+"["+S+"].",c(N[S],E[A],M).set(w[E[A]]);for(T=G.length-1;T>=0;T--)N.splice(G[T],1),U&&U.splice(G[T],1);if(N.length?D||u.set(N):u.set(null),y)return!1;if(a(v,b),p!==d){var Z;if(X===-1)Z=P;else{for(K=Math.max(N.length,K),Z=[],T=0;T<P.length&&!((S=P[T])>=X);T++)Z.push(S);for(T=X;T<K;T++)Z.push(T)}for(T=0;T<Z.length;T++)p(o,Z[T])}else g(o);return!0}},{"../lib/is_plain_object":788,"../lib/loggers":791,"../lib/noop":796,"../lib/search":807,"../registry":915,"./container_array_match":819}],824:[function(r,I,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("has-hover"),h=r("../lib"),e=h.nestedProperty,f=r("../lib/events"),l=r("../lib/queue"),o=r("../registry"),u=r("./plot_schema"),s=r("../plots/plots"),i=r("../plots/cartesian/axes"),c=r("../components/drawing"),n=r("../components/color"),a=r("../plots/cartesian/graph_interact").initInteractions,g=r("../constants/xmlns_namespaces"),p=r("../plots/cartesian/select").clearSelect,y=r("./plot_config").dfltConfig,v=r("./manage_arrays"),b=r("./helpers"),x=r("./subroutines"),T=r("./edit_types"),A=r("../plots/cartesian/constants").AX_NAME_PATTERN,S=0;function w(ce){var ge=ce._fullLayout;ge._redrawFromAutoMarginCount?ge._redrawFromAutoMarginCount--:ce.emit("plotly_afterplot")}function E(ce,ge){try{ce._fullLayout._paper.style("background",ge)}catch(we){h.error(we)}}function k(ce,ge){E(ce,n.combine(ge,"white"))}function L(ce,ge){if(!ce._context){ce._context=h.extendDeep({},y);var we=t.select("base");ce._context._baseUrl=we.size()&&we.attr("href")?window.location.href.split("#")[0]:""}var Me,Se,ze,Fe=ce._context;if(ge){for(Se=Object.keys(ge),Me=0;Me<Se.length;Me++)(ze=Se[Me])!=="editable"&&ze!=="edits"&&ze in Fe&&(ze==="setBackground"&&ge[ze]==="opaque"?Fe[ze]=k:Fe[ze]=ge[ze]);ge.plot3dPixelRatio&&!Fe.plotGlPixelRatio&&(Fe.plotGlPixelRatio=Fe.plot3dPixelRatio);var Ye=ge.editable;if(Ye!==void 0)for(Fe.editable=Ye,Se=Object.keys(Fe.edits),Me=0;Me<Se.length;Me++)Fe.edits[Se[Me]]=Ye;if(ge.edits)for(Se=Object.keys(ge.edits),Me=0;Me<Se.length;Me++)(ze=Se[Me])in Fe.edits&&(Fe.edits[ze]=ge.edits[ze]);Fe._exportedPlot=ge._exportedPlot}Fe.staticPlot&&(Fe.editable=!1,Fe.edits={},Fe.autosizable=!1,Fe.scrollZoom=!1,Fe.doubleClick=!1,Fe.showTips=!1,Fe.showLink=!1,Fe.displayModeBar=!1),Fe.displayModeBar!=="hover"||m||(Fe.displayModeBar=!0),Fe.setBackground!=="transparent"&&typeof Fe.setBackground=="function"||(Fe.setBackground=E),Fe._hasZeroHeight=Fe._hasZeroHeight||ce.clientHeight===0,Fe._hasZeroWidth=Fe._hasZeroWidth||ce.clientWidth===0;var rt=Fe.scrollZoom,Oe=Fe._scrollZoom={};if(rt===!0)Oe.cartesian=1,Oe.gl3d=1,Oe.geo=1,Oe.mapbox=1;else if(typeof rt=="string"){var je=rt.split("+");for(Me=0;Me<je.length;Me++)Oe[je[Me]]=1}else rt!==!1&&(Oe.gl3d=1,Oe.geo=1,Oe.mapbox=1)}function M(ce,ge){var we,Me,Se=ge+1,ze=[];for(we=0;we<ce.length;we++)(Me=ce[we])<0?ze.push(Se+Me):ze.push(Me);return ze}function P(ce,ge,we){var Me,Se;for(Me=0;Me<ge.length;Me++){if((Se=ge[Me])!==parseInt(Se,10))throw new Error("all values in "+we+" must be integers");if(Se>=ce.data.length||Se<-ce.data.length)throw new Error(we+" must be valid indices for gd.data.");if(ge.indexOf(Se,Me+1)>-1||Se>=0&&ge.indexOf(-ce.data.length+Se)>-1||Se<0&&ge.indexOf(ce.data.length+Se)>-1)throw new Error("each index in "+we+" must be unique.")}}function D(ce,ge,we){if(!Array.isArray(ce.data))throw new Error("gd.data must be an array.");if(ge===void 0)throw new Error("currentIndices is a required argument.");if(Array.isArray(ge)||(ge=[ge]),P(ce,ge,"currentIndices"),we===void 0||Array.isArray(we)||(we=[we]),we!==void 0&&P(ce,we,"newIndices"),we!==void 0&&ge.length!==we.length)throw new Error("current and new indices must be of equal length.")}function N(ce,ge,we,Me,Se){(function(qe,et,st,ct){var Pt=h.isPlainObject(ct);if(!Array.isArray(qe.data))throw new Error("gd.data must be an array");if(!h.isPlainObject(et))throw new Error("update must be a key:value object");if(st===void 0)throw new Error("indices must be an integer or array of integers");for(var kt in P(qe,st,"indices"),et){if(!Array.isArray(et[kt])||et[kt].length!==st.length)throw new Error("attribute "+kt+" must be an array of length equal to indices array length");if(Pt&&(!(kt in ct)||!Array.isArray(ct[kt])||ct[kt].length!==et[kt].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}})(ce,ge,we,Me);for(var ze=function(qe,et,st,ct){var Pt,kt,at,tt,_t,er=h.isPlainObject(ct),tr=[];for(var Ue in Array.isArray(st)||(st=[st]),st=M(st,qe.data.length-1),et)for(var He=0;He<st.length;He++){if(Pt=qe.data[st[He]],kt=(at=e(Pt,Ue)).get(),tt=et[Ue][He],!h.isArrayOrTypedArray(tt))throw new Error("attribute: "+Ue+" index: "+He+" must be an array");if(!h.isArrayOrTypedArray(kt))throw new Error("cannot extend missing or non-array attribute: "+Ue);if(kt.constructor!==tt.constructor)throw new Error("cannot extend array with an array of a different type: "+Ue);_t=er?ct[Ue][He]:ct,d(_t)||(_t=-1),tr.push({prop:at,target:kt,insert:tt,maxp:Math.floor(_t)})}return tr}(ce,ge,we,Me),Fe={},Ye={},rt=0;rt<ze.length;rt++){var Oe=ze[rt].prop,je=ze[rt].maxp,We=Se(ze[rt].target,ze[rt].insert,je);Oe.set(We[0]),Array.isArray(Fe[Oe.astr])||(Fe[Oe.astr]=[]),Fe[Oe.astr].push(We[1]),Array.isArray(Ye[Oe.astr])||(Ye[Oe.astr]=[]),Ye[Oe.astr].push(ze[rt].target.length)}return{update:Fe,maxPoints:Ye}}function U(ce,ge){var we=new ce.constructor(ce.length+ge.length);return we.set(ce),we.set(ge,ce.length),we}function G(ce,ge,we,Me){ce=h.getGraphDiv(ce),b.clearPromiseQueue(ce);var Se={};if(typeof ge=="string")Se[ge]=we;else{if(!h.isPlainObject(ge))return h.warn("Restyle fail.",ge,we,Me),Promise.reject();Se=h.extendFlat({},ge),Me===void 0&&(Me=we)}Object.keys(Se).length&&(ce.changed=!0);var ze=b.coerceTraceIndices(ce,Me),Fe=H(ce,Se,ze),Ye=Fe.flags;Ye.calc&&(ce.calcdata=void 0),Ye.clearAxisTypes&&b.clearAxisTypes(ce,ze,{});var rt=[];Ye.fullReplot?rt.push(B._doPlot):(rt.push(s.previousPromises),s.supplyDefaults(ce),Ye.markerSize&&(s.doCalcdata(ce),j(rt)),Ye.style&&rt.push(x.doTraceStyle),Ye.colorbars&&rt.push(x.doColorBars),rt.push(w)),rt.push(s.rehover,s.redrag),l.add(ce,G,[ce,Fe.undoit,Fe.traces],G,[ce,Fe.redoit,Fe.traces]);var Oe=h.syncOrAsync(rt,ce);return Oe&&Oe.then||(Oe=Promise.resolve()),Oe.then(function(){return ce.emit("plotly_restyle",Fe.eventData),ce})}function X(ce){return ce===void 0?null:ce}function K(ce,ge){return ge?function(we,Me,Se){var ze=e(we,Me),Fe=ze.set;return ze.set=function(Ye){Z((Se||"")+Me,ze.get(),Ye,ce),Fe(Ye)},ze}:e}function Z(ce,ge,we,Me){if(Array.isArray(ge)||Array.isArray(we))for(var Se=Array.isArray(ge)?ge:[],ze=Array.isArray(we)?we:[],Fe=Math.max(Se.length,ze.length),Ye=0;Ye<Fe;Ye++)Z(ce+"["+Ye+"]",Se[Ye],ze[Ye],Me);else if(h.isPlainObject(ge)||h.isPlainObject(we)){var rt=h.isPlainObject(ge)?ge:{},Oe=h.isPlainObject(we)?we:{},je=h.extendFlat({},rt,Oe);for(var We in je)Z(ce+"."+We,rt[We],Oe[We],Me)}else Me[ce]===void 0&&(Me[ce]=X(ge))}function H(ce,ge,we){var Me,Se=ce._fullLayout,ze=ce._fullData,Fe=ce.data,Ye=Se._guiEditing,rt=K(Se._preGUI,Ye),Oe=h.extendDeepAll({},ge);Y(ge);var je,We=T.traceFlags(),qe={},et={};function st(){return we.map(function(){})}function ct(wt){var Ot=i.id2name(wt);je.indexOf(Ot)===-1&&je.push(Ot)}function Pt(wt){return"LAYOUT"+wt+".autorange"}function kt(wt){return"LAYOUT"+wt+".range"}function at(wt){for(var Ot=wt;Ot<ze.length;Ot++)if(ze[Ot]._input===Fe[wt])return ze[Ot]}function tt(wt,Ot,Gt){if(Array.isArray(wt))wt.forEach(function(Kt){tt(Kt,Ot,Gt)});else if(!(wt in ge)&&!b.hasParent(ge,wt)){var ir;if(wt.substr(0,6)==="LAYOUT")ir=rt(ce.layout,wt.replace("LAYOUT",""));else{var Xt=we[Gt];ir=K(Se._tracePreGUI[at(Xt)._fullInput.uid],Ye)(Fe[Xt],wt)}wt in et||(et[wt]=st()),et[wt][Gt]===void 0&&(et[wt][Gt]=X(ir.get())),Ot!==void 0&&ir.set(Ot)}}function _t(wt){return function(Ot){return ze[Ot][wt]}}function er(wt){return function(Ot,Gt){return Ot===!1?ze[we[Gt]][wt]:null}}for(var tr in ge){if(b.hasParent(ge,tr))throw new Error("cannot set "+tr+" and a parent attribute simultaneously");var Ue,He,Be,Ke,_e,Ce,Le=ge[tr];if(tr!=="autobinx"&&tr!=="autobiny"||(tr=tr.charAt(tr.length-1)+"bins",Le=Array.isArray(Le)?Le.map(er(tr)):Le===!1?we.map(_t(tr)):null),qe[tr]=Le,tr.substr(0,6)!=="LAYOUT"){for(et[tr]=st(),Me=0;Me<we.length;Me++)if(Ue=Fe[we[Me]],He=at(we[Me]),Ke=(Be=K(Se._tracePreGUI[He._fullInput.uid],Ye)(Ue,tr)).get(),(_e=Array.isArray(Le)?Le[Me%Le.length]:Le)!==void 0){var Pe=Be.parts[Be.parts.length-1],Xe=tr.substr(0,tr.length-Pe.length-1),ht=Xe?Xe+".":"",Mt=Xe?e(He,Xe).get():He;if((Ce=u.getTraceValObject(He,Be.parts))&&Ce.impliedEdits&&_e!==null)for(var pt in Ce.impliedEdits)tt(h.relativeAttr(tr,pt),Ce.impliedEdits[pt],Me);else if(Pe!=="thicknessmode"&&Pe!=="lenmode"||Ke===_e||_e!=="fraction"&&_e!=="pixels"||!Mt){if(tr==="type"&&(_e==="pie"!=(Ke==="pie")||_e==="funnelarea"!=(Ke==="funnelarea"))){var Lt="x",vt="y";_e!=="bar"&&Ke!=="bar"||Ue.orientation!=="h"||(Lt="y",vt="x"),h.swapAttrs(Ue,["?","?src"],"labels",Lt),h.swapAttrs(Ue,["d?","?0"],"label",Lt),h.swapAttrs(Ue,["?","?src"],"values",vt),Ke==="pie"||Ke==="funnelarea"?(e(Ue,"marker.color").set(e(Ue,"marker.colors").get()),Se._pielayer.selectAll("g.trace").remove()):o.traceIs(Ue,"cartesian")&&e(Ue,"marker.colors").set(e(Ue,"marker.color").get())}}else{var Dt=Se._size,xt=Mt.orient,it=xt==="top"||xt==="bottom";if(Pe==="thicknessmode"){var St=it?Dt.h:Dt.w;tt(ht+"thickness",Mt.thickness*(_e==="fraction"?1/St:St),Me)}else{var Nt=it?Dt.w:Dt.h;tt(ht+"len",Mt.len*(_e==="fraction"?1/Nt:Nt),Me)}}if(et[tr][Me]=X(Ke),["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(tr)!==-1){if(tr==="orientation"){Be.set(_e);var Ut=Ue.x&&!Ue.y?"h":"v";if((Be.get()||Ut)===He.orientation)continue}else tr==="orientationaxes"&&(Ue.orientation={v:"h",h:"v"}[He.orientation]);b.swapXYData(Ue),We.calc=We.clearAxisTypes=!0}else s.dataArrayContainers.indexOf(Be.parts[0])!==-1?(b.manageArrayContainers(Be,_e,et),We.calc=!0):(Ce?Ce.arrayOk&&!o.traceIs(He,"regl")&&(h.isArrayOrTypedArray(_e)||h.isArrayOrTypedArray(Ke))?We.calc=!0:T.update(We,Ce):We.calc=!0,Be.set(_e))}if(["swapxyaxes","orientationaxes"].indexOf(tr)!==-1&&i.swap(ce,we),tr==="orientationaxes"){var Qt=e(ce.layout,"hovermode"),Ie=Qt.get();Ie==="x"?Qt.set("y"):Ie==="y"?Qt.set("x"):Ie==="x unified"?Qt.set("y unified"):Ie==="y unified"&&Qt.set("x unified")}if(["orientation","type"].indexOf(tr)!==-1){for(je=[],Me=0;Me<we.length;Me++){var lt=Fe[we[Me]];o.traceIs(lt,"cartesian")&&(ct(lt.xaxis||"x"),ct(lt.yaxis||"y"))}tt(je.map(Pt),!0,0),tt(je.map(kt),[0,1],0)}}else Be=rt(ce.layout,tr.replace("LAYOUT","")),et[tr]=[X(Be.get())],Be.set(Array.isArray(Le)?Le[0]:Le),We.calc=!0}return(We.calc||We.plot)&&(We.fullReplot=!0),{flags:We,undoit:et,redoit:qe,traces:we,eventData:h.extendDeepNoArrays([],[Oe,we])}}function Y(ce){var ge,we,Me,Se=h.counterRegex("axis",".title",!1,!1),ze=/colorbar\.title$/,Fe=Object.keys(ce);for(ge=0;ge<Fe.length;ge++)we=Fe[ge],Me=ce[we],we!=="title"&&!Se.test(we)&&!ze.test(we)||typeof Me!="string"&&typeof Me!="number"?we.indexOf("titlefont")>-1?Ye(we,we.replace("titlefont","title.font")):we.indexOf("titleposition")>-1?Ye(we,we.replace("titleposition","title.position")):we.indexOf("titleside")>-1?Ye(we,we.replace("titleside","title.side")):we.indexOf("titleoffset")>-1&&Ye(we,we.replace("titleoffset","title.offset")):Ye(we,we.replace("title","title.text"));function Ye(rt,Oe){ce[Oe]=ce[rt],delete ce[rt]}}function $(ce,ge,we){ce=h.getGraphDiv(ce),b.clearPromiseQueue(ce);var Me={};if(typeof ge=="string")Me[ge]=we;else{if(!h.isPlainObject(ge))return h.warn("Relayout fail.",ge,we),Promise.reject();Me=h.extendFlat({},ge)}Object.keys(Me).length&&(ce.changed=!0);var Se=Q(ce,Me),ze=Se.flags;ze.calc&&(ce.calcdata=void 0);var Fe=[s.previousPromises];ze.layoutReplot?Fe.push(x.layoutReplot):Object.keys(Me).length&&(z(ce,ze,Se)||s.supplyDefaults(ce),ze.legend&&Fe.push(x.doLegend),ze.layoutstyle&&Fe.push(x.layoutStyles),ze.axrange&&j(Fe,Se.rangesAltered),ze.ticks&&Fe.push(x.doTicksRelayout),ze.modebar&&Fe.push(x.doModeBar),ze.camera&&Fe.push(x.doCamera),ze.colorbars&&Fe.push(x.doColorBars),Fe.push(w)),Fe.push(s.rehover,s.redrag),l.add(ce,$,[ce,Se.undoit],$,[ce,Se.redoit]);var Ye=h.syncOrAsync(Fe,ce);return Ye&&Ye.then||(Ye=Promise.resolve(ce)),Ye.then(function(){return ce.emit("plotly_relayout",Se.eventData),ce})}function z(ce,ge,we){var Me=ce._fullLayout;if(!ge.axrange)return!1;for(var Se in ge)if(Se!=="axrange"&&ge[Se])return!1;for(var ze in we.rangesAltered){var Fe=i.id2name(ze),Ye=ce.layout[Fe],rt=Me[Fe];if(rt.autorange=Ye.autorange,Ye.range&&(rt.range=Ye.range.slice()),rt.cleanRange(),rt._matchGroup){for(var Oe in rt._matchGroup)if(Oe!==ze){var je=Me[i.id2name(Oe)];je.autorange=rt.autorange,je.range=rt.range.slice(),je._input.range=rt.range.slice()}}}return!0}function j(ce,ge){var we=ge?function(Me){var Se=[],ze=!0;for(var Fe in ge){var Ye=i.getFromId(Me,Fe);if(Se.push(Fe),(Ye.ticklabelposition||"").indexOf("inside")!==-1&&Ye._anchorAxis&&Se.push(Ye._anchorAxis._id),Ye._matchGroup)for(var rt in Ye._matchGroup)ge[rt]||Se.push(rt);Ye.automargin&&(ze=!1)}return i.draw(Me,Se,{skipTitle:ze})}:function(Me){return i.draw(Me,"redraw")};ce.push(p,x.doAutoRangeAndConstraints,we,x.drawData,x.finalDraw)}var W=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,ee=/^[xyz]axis[0-9]*\.autorange$/,J=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function Q(ce,ge){var we,Me,Se,ze=ce.layout,Fe=ce._fullLayout,Ye=Fe._guiEditing,rt=K(Fe._preGUI,Ye),Oe=Object.keys(ge),je=i.list(ce),We=h.extendDeepAll({},ge),qe={};for(Y(ge),Oe=Object.keys(ge),Me=0;Me<Oe.length;Me++)if(Oe[Me].indexOf("allaxes")===0){for(Se=0;Se<je.length;Se++){var et=je[Se]._id.substr(1),st=et.indexOf("scene")!==-1?et+".":"",ct=Oe[Me].replace("allaxes",st+je[Se]._name);ge[ct]||(ge[ct]=ge[Oe[Me]])}delete ge[Oe[Me]]}var Pt=T.layoutFlags(),kt={},at={};function tt(Xt,Kt){if(Array.isArray(Xt))Xt.forEach(function(dr){tt(dr,Kt)});else if(!(Xt in ge)&&!b.hasParent(ge,Xt)){var or=rt(ze,Xt);Xt in at||(at[Xt]=X(or.get())),Kt!==void 0&&or.set(Kt)}}var _t,er={};function tr(Xt){var Kt=i.name2id(Xt.split(".")[0]);return er[Kt]=1,Kt}for(var Ue in ge){if(b.hasParent(ge,Ue))throw new Error("cannot set "+Ue+" and a parent attribute simultaneously");for(var He=rt(ze,Ue),Be=ge[Ue],Ke=He.parts.length-1;Ke>0&&typeof He.parts[Ke]!="string";)Ke--;var _e=He.parts[Ke],Ce=He.parts[Ke-1]+"."+_e,Le=He.parts.slice(0,Ke).join("."),Pe=e(ce.layout,Le).get(),Xe=e(Fe,Le).get(),ht=He.get();if(Be!==void 0){kt[Ue]=Be,at[Ue]=_e==="reverse"?Be:X(ht);var Mt=u.getLayoutValObject(Fe,He.parts);if(Mt&&Mt.impliedEdits&&Be!==null)for(var pt in Mt.impliedEdits)tt(h.relativeAttr(Ue,pt),Mt.impliedEdits[pt]);if(["width","height"].indexOf(Ue)!==-1)if(Be){tt("autosize",null);var Lt=Ue==="height"?"width":"height";tt(Lt,Fe[Lt])}else Fe[Ue]=ce._initialAutoSize[Ue];else if(Ue==="autosize")tt("width",Be?null:Fe.width),tt("height",Be?null:Fe.height);else if(Ce.match(W))tr(Ce),e(Fe,Le+"._inputRange").set(null);else if(Ce.match(ee)){tr(Ce),e(Fe,Le+"._inputRange").set(null);var vt=e(Fe,Le).get();vt._inputDomain&&(vt._input.domain=vt._inputDomain.slice())}else Ce.match(J)&&e(Fe,Le+"._inputDomain").set(null);if(_e==="type"){_t=Pe;var Dt=Xe.type==="linear"&&Be==="log",xt=Xe.type==="log"&&Be==="linear";if(Dt||xt){if(_t&&_t.range)if(Xe.autorange)Dt&&(_t.range=_t.range[1]>_t.range[0]?[1,2]:[2,1]);else{var it=_t.range[0],St=_t.range[1];Dt?(it<=0&&St<=0&&tt(Le+".autorange",!0),it<=0?it=St/1e6:St<=0&&(St=it/1e6),tt(Le+".range[0]",Math.log(it)/Math.LN10),tt(Le+".range[1]",Math.log(St)/Math.LN10)):(tt(Le+".range[0]",Math.pow(10,it)),tt(Le+".range[1]",Math.pow(10,St)))}else tt(Le+".autorange",!0);Array.isArray(Fe._subplots.polar)&&Fe._subplots.polar.length&&Fe[He.parts[0]]&&He.parts[1]==="radialaxis"&&delete Fe[He.parts[0]]._subplot.viewInitial["radialaxis.range"],o.getComponentMethod("annotations","convertCoords")(ce,Xe,Be,tt),o.getComponentMethod("images","convertCoords")(ce,Xe,Be,tt)}else tt(Le+".autorange",!0),tt(Le+".range",null);e(Fe,Le+"._inputRange").set(null)}else if(_e.match(A)){var Nt=e(Fe,Ue).get(),Ut=(Be||{}).type;Ut&&Ut!=="-"||(Ut="linear"),o.getComponentMethod("annotations","convertCoords")(ce,Nt,Ut,tt),o.getComponentMethod("images","convertCoords")(ce,Nt,Ut,tt)}var Qt=v.containerArrayMatch(Ue);if(Qt){we=Qt.array,Me=Qt.index;var Ie=Qt.property,lt=Mt||{editType:"calc"};Me!==""&&Ie===""&&(v.isAddVal(Be)?at[Ue]=null:v.isRemoveVal(Be)?at[Ue]=(e(ze,we).get()||[])[Me]:h.warn("unrecognized full object value",ge)),T.update(Pt,lt),qe[we]||(qe[we]={});var wt=qe[we][Me];wt||(wt=qe[we][Me]={}),wt[Ie]=Be,delete ge[Ue]}else _e==="reverse"?(Pe.range?Pe.range.reverse():(tt(Le+".autorange",!0),Pe.range=[1,0]),Xe.autorange?Pt.calc=!0:Pt.plot=!0):(Fe._has("scatter-like")&&Fe._has("regl")&&Ue==="dragmode"&&(Be==="lasso"||Be==="select")&&ht!=="lasso"&&ht!=="select"||Fe._has("gl2d")?Pt.plot=!0:Mt?T.update(Pt,Mt):Pt.calc=!0,He.set(Be))}}for(we in qe)v.applyContainerArrayChanges(ce,rt(ze,we),qe[we],Pt,rt)||(Pt.plot=!0);for(var Ot in er){var Gt=(_t=i.getFromId(ce,Ot))&&_t._constraintGroup;if(Gt)for(var ir in Pt.calc=!0,Gt)er[ir]||(i.getFromId(ce,ir)._constraintShrinkable=!0)}return(te(ce)||ge.height||ge.width)&&(Pt.plot=!0),(Pt.plot||Pt.calc)&&(Pt.layoutReplot=!0),{flags:Pt,rangesAltered:er,undoit:at,redoit:kt,eventData:We}}function te(ce){var ge=ce._fullLayout,we=ge.width,Me=ge.height;return ce.layout.autosize&&s.plotAutoSize(ce,ce.layout,ge),ge.width!==we||ge.height!==Me}function ie(ce,ge,we,Me){ce=h.getGraphDiv(ce),b.clearPromiseQueue(ce),h.isPlainObject(ge)||(ge={}),h.isPlainObject(we)||(we={}),Object.keys(ge).length&&(ce.changed=!0),Object.keys(we).length&&(ce.changed=!0);var Se=b.coerceTraceIndices(ce,Me),ze=H(ce,h.extendFlat({},ge),Se),Fe=ze.flags,Ye=Q(ce,h.extendFlat({},we)),rt=Ye.flags;(Fe.calc||rt.calc)&&(ce.calcdata=void 0),Fe.clearAxisTypes&&b.clearAxisTypes(ce,Se,we);var Oe=[];rt.layoutReplot?Oe.push(x.layoutReplot):Fe.fullReplot?Oe.push(B._doPlot):(Oe.push(s.previousPromises),z(ce,rt,Ye)||s.supplyDefaults(ce),Fe.style&&Oe.push(x.doTraceStyle),(Fe.colorbars||rt.colorbars)&&Oe.push(x.doColorBars),rt.legend&&Oe.push(x.doLegend),rt.layoutstyle&&Oe.push(x.layoutStyles),rt.axrange&&j(Oe,Ye.rangesAltered),rt.ticks&&Oe.push(x.doTicksRelayout),rt.modebar&&Oe.push(x.doModeBar),rt.camera&&Oe.push(x.doCamera),Oe.push(w)),Oe.push(s.rehover,s.redrag),l.add(ce,ie,[ce,ze.undoit,Ye.undoit,ze.traces],ie,[ce,ze.redoit,Ye.redoit,ze.traces]);var je=h.syncOrAsync(Oe,ce);return je&&je.then||(je=Promise.resolve(ce)),je.then(function(){return ce.emit("plotly_update",{data:ze.eventData,layout:Ye.eventData}),ce})}function ae(ce){return function(ge){ge._fullLayout._guiEditing=!0;var we=ce.apply(null,arguments);return ge._fullLayout._guiEditing=!1,we}}var he=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],se=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function de(ce,ge){for(var we=0;we<ge.length;we++){var Me=ge[we],Se=ce.match(Me.pattern);if(Se)return{head:Se[1],attr:Me.attr}}}function ue(ce,ge){var we=e(ge,ce).get();if(we!==void 0)return we;var Me=ce.split(".");for(Me.pop();Me.length>1;)if(Me.pop(),(we=e(ge,Me.join(".")+".uirevision").get())!==void 0)return we;return ge.uirevision}function ve(ce,ge){for(var we=0;we<ge.length;we++)if(ge[we]._fullInput.uid===ce)return we;return-1}function ke(ce,ge,we){for(var Me=0;Me<ge.length;Me++)if(ge[Me].uid===ce)return Me;return!ge[we]||ge[we].uid?-1:we}function Ee(ce,ge){var we=h.isPlainObject(ce),Me=Array.isArray(ce);return we||Me?(we&&h.isPlainObject(ge)||Me&&Array.isArray(ge))&&JSON.stringify(ce)===JSON.stringify(ge):ce===ge}function be(ce,ge,we,Me){var Se,ze,Fe,Ye=Me.getValObject,rt=Me.flags,Oe=Me.immutable,je=Me.inArray,We=Me.arrayIndex;function qe(){var Pe=Se.editType;je&&Pe.indexOf("arraydraw")!==-1?h.pushUnique(rt.arrays[je],We):(T.update(rt,Se),Pe!=="none"&&rt.nChanges++,Me.transition&&Se.anim&&rt.nChangesAnim++,(W.test(Fe)||ee.test(Fe))&&(rt.rangesAltered[we[0]]=1),J.test(Fe)&&e(ge,"_inputDomain").set(null),ze==="datarevision"&&(rt.newDataRevision=1))}function et(Pe){return Pe.valType==="data_array"||Pe.arrayOk}for(ze in ce){if(rt.calc&&!Me.transition)return;var st=ce[ze],ct=ge[ze],Pt=we.concat(ze);if(Fe=Pt.join("."),ze.charAt(0)!=="_"&&typeof st!="function"&&st!==ct){if((ze==="tick0"||ze==="dtick")&&we[0]!=="geo"){var kt=ge.tickmode;if(kt==="auto"||kt==="array"||!kt)continue}if((ze!=="range"||!ge.autorange)&&(ze!=="zmin"&&ze!=="zmax"||ge.type!=="contourcarpet")&&(Se=Ye(Pt))&&(!Se._compareAsJSON||JSON.stringify(st)!==JSON.stringify(ct))){var at,tt=Se.valType,_t=et(Se),er=Array.isArray(st),tr=Array.isArray(ct);if(er&&tr){var Ue="_input_"+ze,He=ce[Ue],Be=ge[Ue];if(Array.isArray(He)&&He===Be)continue}if(ct===void 0)_t&&er?rt.calc=!0:qe();else if(Se._isLinkedToArray){var Ke=[],_e=!1;je||(rt.arrays[ze]=Ke);var Ce=Math.min(st.length,ct.length),Le=Math.max(st.length,ct.length);if(Ce!==Le){if(Se.editType!=="arraydraw"){qe();continue}_e=!0}for(at=0;at<Ce;at++)be(st[at],ct[at],Pt.concat(at),h.extendFlat({inArray:ze,arrayIndex:at},Me));if(_e)for(at=Ce;at<Le;at++)Ke.push(at)}else!tt&&h.isPlainObject(st)?be(st,ct,Pt,Me):_t?er&&tr?(Oe&&(rt.calc=!0),(Oe||Me.newDataRevision)&&qe()):er!==tr?rt.calc=!0:qe():er&&tr&&st.length===ct.length&&String(st)===String(ct)||qe()}}}for(ze in ge)if(!(ze in ce)&&ze.charAt(0)!=="_"&&typeof ge[ze]!="function"){if(et(Se=Ye(we.concat(ze)))&&Array.isArray(ge[ze]))return void(rt.calc=!0);qe()}}function xe(ce){var ge=ce._fullLayout,we=ce.getBoundingClientRect();if(!h.equalDomRects(we,ge._lastBBox)){var Me=ge._invTransform=h.inverseTransformMatrix(h.getFullTransformMatrix(ce));ge._invScaleX=Math.sqrt(Me[0][0]*Me[0][0]+Me[0][1]*Me[0][1]+Me[0][2]*Me[0][2]),ge._invScaleY=Math.sqrt(Me[1][0]*Me[1][0]+Me[1][1]*Me[1][1]+Me[1][2]*Me[1][2]),ge._lastBBox=we}}B.animate=function(ce,ge,we){if(ce=h.getGraphDiv(ce),!h.isPlotDiv(ce))throw new Error("This element is not a Plotly plot: "+ce+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var Me=ce._transitionData;Me._frameQueue||(Me._frameQueue=[]);var Se=(we=s.supplyAnimationDefaults(we)).transition,ze=we.frame;function Fe(Oe){return Array.isArray(Se)?Oe>=Se.length?Se[0]:Se[Oe]:Se}function Ye(Oe){return Array.isArray(ze)?Oe>=ze.length?ze[0]:ze[Oe]:ze}function rt(Oe,je){var We=0;return function(){if(Oe&&++We===je)return Oe()}}return Me._frameWaitingCnt===void 0&&(Me._frameWaitingCnt=0),new Promise(function(Oe,je){function We(){Me._currentFrame&&Me._currentFrame.onComplete&&Me._currentFrame.onComplete();var He=Me._currentFrame=Me._frameQueue.shift();if(He){var Be=He.name?He.name.toString():null;ce._fullLayout._currentFrame=Be,Me._lastFrameAt=Date.now(),Me._timeToNext=He.frameOpts.duration,s.transition(ce,He.frame.data,He.frame.layout,b.coerceTraceIndices(ce,He.frame.traces),He.frameOpts,He.transitionOpts).then(function(){He.onComplete&&He.onComplete()}),ce.emit("plotly_animatingframe",{name:Be,frame:He.frame,animation:{frame:He.frameOpts,transition:He.transitionOpts}})}else ce.emit("plotly_animated"),window.cancelAnimationFrame(Me._animationRaf),Me._animationRaf=null}function qe(){ce.emit("plotly_animating"),Me._lastFrameAt=-1/0,Me._timeToNext=0,Me._runningTransitions=0,Me._currentFrame=null;var He=function(){Me._animationRaf=window.requestAnimationFrame(He),Date.now()-Me._lastFrameAt>Me._timeToNext&&We()};He()}var et,st,ct=0;function Pt(He){return Array.isArray(Se)?ct>=Se.length?He.transitionOpts=Se[ct]:He.transitionOpts=Se[0]:He.transitionOpts=Se,ct++,He}var kt=[],at=ge==null,tt=Array.isArray(ge);if(!at&&!tt&&h.isPlainObject(ge))kt.push({type:"object",data:Pt(h.extendFlat({},ge))});else if(at||["string","number"].indexOf(typeof ge)!==-1)for(et=0;et<Me._frames.length;et++)(st=Me._frames[et])&&(at||String(st.group)===String(ge))&&kt.push({type:"byname",name:String(st.name),data:Pt({name:st.name})});else if(tt)for(et=0;et<ge.length;et++){var _t=ge[et];["number","string"].indexOf(typeof _t)!==-1?(_t=String(_t),kt.push({type:"byname",name:_t,data:Pt({name:_t})})):h.isPlainObject(_t)&&kt.push({type:"object",data:Pt(h.extendFlat({},_t))})}for(et=0;et<kt.length;et++)if((st=kt[et]).type==="byname"&&!Me._frameHash[st.data.name])return h.warn('animate failure: frame not found: "'+st.data.name+'"'),void je();["next","immediate"].indexOf(we.mode)!==-1&&function(){if(Me._frameQueue.length!==0){for(;Me._frameQueue.length;){var He=Me._frameQueue.pop();He.onInterrupt&&He.onInterrupt()}ce.emit("plotly_animationinterrupted",[])}}(),we.direction==="reverse"&&kt.reverse();var er=ce._fullLayout._currentFrame;if(er&&we.fromcurrent){var tr=-1;for(et=0;et<kt.length;et++)if((st=kt[et]).type==="byname"&&st.name===er){tr=et;break}if(tr>0&&tr<kt.length-1){var Ue=[];for(et=0;et<kt.length;et++)st=kt[et],(kt[et].type!=="byname"||et>tr)&&Ue.push(st);kt=Ue}}kt.length>0?function(He){if(He.length!==0){for(var Be=0;Be<He.length;Be++){var Ke;Ke=He[Be].type==="byname"?s.computeFrame(ce,He[Be].name):He[Be].data;var _e=Ye(Be),Ce=Fe(Be);Ce.duration=Math.min(Ce.duration,_e.duration);var Le={frame:Ke,name:He[Be].name,frameOpts:_e,transitionOpts:Ce};Be===He.length-1&&(Le.onComplete=rt(Oe,2),Le.onInterrupt=je),Me._frameQueue.push(Le)}we.mode==="immediate"&&(Me._lastFrameAt=-1/0),Me._animationRaf||qe()}}(kt):(ce.emit("plotly_animated"),Oe())})},B.addFrames=function(ce,ge,we){if(ce=h.getGraphDiv(ce),ge==null)return Promise.resolve();if(!h.isPlotDiv(ce))throw new Error("This element is not a Plotly plot: "+ce+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var Me,Se,ze,Fe,Ye=ce._transitionData._frames,rt=ce._transitionData._frameHash;if(!Array.isArray(ge))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+ge);var Oe=Ye.length+2*ge.length,je=[],We={};for(Me=ge.length-1;Me>=0;Me--)if(h.isPlainObject(ge[Me])){var qe=ge[Me].name,et=(rt[qe]||We[qe]||{}).name,st=ge[Me].name,ct=rt[et]||We[et];et&&st&&typeof st=="number"&&ct&&S<5&&(S++,h.warn('addFrames: overwriting frame "'+(rt[et]||We[et]).name+'" with a frame whose name of type "number" also equates to "'+et+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),S===5&&h.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),We[qe]={name:qe},je.push({frame:s.supplyFrameDefaults(ge[Me]),index:we&&we[Me]!==void 0&&we[Me]!==null?we[Me]:Oe+Me})}je.sort(function(Ue,He){return Ue.index>He.index?-1:Ue.index<He.index?1:0});var Pt=[],kt=[],at=Ye.length;for(Me=je.length-1;Me>=0;Me--){if(typeof(Se=je[Me].frame).name=="number"&&h.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!Se.name)for(;rt[Se.name="frame "+ce._transitionData._counter++];);if(rt[Se.name]){for(ze=0;ze<Ye.length&&(Ye[ze]||{}).name!==Se.name;ze++);Pt.push({type:"replace",index:ze,value:Se}),kt.unshift({type:"replace",index:ze,value:Ye[ze]})}else Fe=Math.max(0,Math.min(je[Me].index,at)),Pt.push({type:"insert",index:Fe,value:Se}),kt.unshift({type:"delete",index:Fe}),at++}var tt=s.modifyFrames,_t=s.modifyFrames,er=[ce,kt],tr=[ce,Pt];return l&&l.add(ce,tt,er,_t,tr),s.modifyFrames(ce,Pt)},B.deleteFrames=function(ce,ge){if(ce=h.getGraphDiv(ce),!h.isPlotDiv(ce))throw new Error("This element is not a Plotly plot: "+ce);var we,Me,Se=ce._transitionData._frames,ze=[],Fe=[];if(!ge)for(ge=[],we=0;we<Se.length;we++)ge.push(we);for((ge=ge.slice()).sort(),we=ge.length-1;we>=0;we--)Me=ge[we],ze.push({type:"delete",index:Me}),Fe.unshift({type:"insert",index:Me,value:Se[Me]});var Ye=s.modifyFrames,rt=s.modifyFrames,Oe=[ce,Fe],je=[ce,ze];return l&&l.add(ce,Ye,Oe,rt,je),s.modifyFrames(ce,ze)},B.addTraces=function ce(ge,we,Me){ge=h.getGraphDiv(ge);var Se,ze,Fe=[],Ye=B.deleteTraces,rt=ce,Oe=[ge,Fe],je=[ge,we];for(function(We,qe,et){var st,ct;if(!Array.isArray(We.data))throw new Error("gd.data must be an array.");if(qe===void 0)throw new Error("traces must be defined.");for(Array.isArray(qe)||(qe=[qe]),st=0;st<qe.length;st++)if(typeof(ct=qe[st])!="object"||Array.isArray(ct)||ct===null)throw new Error("all values in traces array must be non-array objects");if(et===void 0||Array.isArray(et)||(et=[et]),et!==void 0&&et.length!==qe.length)throw new Error("if indices is specified, traces.length must equal indices.length")}(ge,we,Me),Array.isArray(we)||(we=[we]),we=we.map(function(We){return h.extendFlat({},We)}),b.cleanData(we),Se=0;Se<we.length;Se++)ge.data.push(we[Se]);for(Se=0;Se<we.length;Se++)Fe.push(-we.length+Se);if(Me===void 0)return ze=B.redraw(ge),l.add(ge,Ye,Oe,rt,je),ze;Array.isArray(Me)||(Me=[Me]);try{D(ge,Fe,Me)}catch(We){throw ge.data.splice(ge.data.length-we.length,we.length),We}return l.startSequence(ge),l.add(ge,Ye,Oe,rt,je),ze=B.moveTraces(ge,Fe,Me),l.stopSequence(ge),ze},B.deleteTraces=function ce(ge,we){ge=h.getGraphDiv(ge);var Me,Se,ze=[],Fe=B.addTraces,Ye=ce,rt=[ge,ze,we],Oe=[ge,we];if(we===void 0)throw new Error("indices must be an integer or array of integers.");for(Array.isArray(we)||(we=[we]),P(ge,we,"indices"),(we=M(we,ge.data.length-1)).sort(h.sorterDes),Me=0;Me<we.length;Me+=1)Se=ge.data.splice(we[Me],1)[0],ze.push(Se);var je=B.redraw(ge);return l.add(ge,Fe,rt,Ye,Oe),je},B.extendTraces=function ce(ge,we,Me,Se){function ze(Oe,je,We){var qe,et;if(h.isTypedArray(Oe))if(We<0){var st=new Oe.constructor(0),ct=U(Oe,je);We<0?(qe=ct,et=st):(qe=st,et=ct)}else if(qe=new Oe.constructor(We),et=new Oe.constructor(Oe.length+je.length-We),We===je.length)qe.set(je),et.set(Oe);else if(We<je.length){var Pt=je.length-We;qe.set(je.subarray(Pt)),et.set(Oe),et.set(je.subarray(0,Pt),Oe.length)}else{var kt=We-je.length,at=Oe.length-kt;qe.set(Oe.subarray(at)),qe.set(je,kt),et.set(Oe.subarray(0,at))}else qe=Oe.concat(je),et=We>=0&&We<qe.length?qe.splice(0,qe.length-We):[];return[qe,et]}var Fe=N(ge=h.getGraphDiv(ge),we,Me,Se,ze),Ye=B.redraw(ge),rt=[ge,Fe.update,Me,Fe.maxPoints];return l.add(ge,B.prependTraces,rt,ce,arguments),Ye},B.moveTraces=function ce(ge,we,Me){var Se,ze=[],Fe=[],Ye=ce,rt=ce,Oe=[ge=h.getGraphDiv(ge),Me,we],je=[ge,we,Me];if(D(ge,we,Me),we=Array.isArray(we)?we:[we],Me===void 0)for(Me=[],Se=0;Se<we.length;Se++)Me.push(-we.length+Se);for(Me=Array.isArray(Me)?Me:[Me],we=M(we,ge.data.length-1),Me=M(Me,ge.data.length-1),Se=0;Se<ge.data.length;Se++)we.indexOf(Se)===-1&&ze.push(ge.data[Se]);for(Se=0;Se<we.length;Se++)Fe.push({newIndex:Me[Se],trace:ge.data[we[Se]]});for(Fe.sort(function(qe,et){return qe.newIndex-et.newIndex}),Se=0;Se<Fe.length;Se+=1)ze.splice(Fe[Se].newIndex,0,Fe[Se].trace);ge.data=ze;var We=B.redraw(ge);return l.add(ge,Ye,Oe,rt,je),We},B.prependTraces=function ce(ge,we,Me,Se){function ze(Oe,je,We){var qe,et;if(h.isTypedArray(Oe))if(We<=0){var st=new Oe.constructor(0),ct=U(je,Oe);We<0?(qe=ct,et=st):(qe=st,et=ct)}else if(qe=new Oe.constructor(We),et=new Oe.constructor(Oe.length+je.length-We),We===je.length)qe.set(je),et.set(Oe);else if(We<je.length){var Pt=je.length-We;qe.set(je.subarray(0,Pt)),et.set(je.subarray(Pt)),et.set(Oe,Pt)}else{var kt=We-je.length;qe.set(je),qe.set(Oe.subarray(0,kt),je.length),et.set(Oe.subarray(kt))}else qe=je.concat(Oe),et=We>=0&&We<qe.length?qe.splice(We,qe.length):[];return[qe,et]}var Fe=N(ge=h.getGraphDiv(ge),we,Me,Se,ze),Ye=B.redraw(ge),rt=[ge,Fe.update,Me,Fe.maxPoints];return l.add(ge,B.extendTraces,rt,ce,arguments),Ye},B.newPlot=function(ce,ge,we,Me){return ce=h.getGraphDiv(ce),s.cleanPlot([],{},ce._fullData||[],ce._fullLayout||{}),s.purge(ce),B._doPlot(ce,ge,we,Me)},B._doPlot=function(ce,ge,we,Me){var Se;if(ce=h.getGraphDiv(ce),f.init(ce),h.isPlainObject(ge)){var ze=ge;ge=ze.data,we=ze.layout,Me=ze.config,Se=ze.frames}if(f.triggerHandler(ce,"plotly_beforeplot",[ge,we,Me])===!1)return Promise.reject();ge||we||h.isPlotDiv(ce)||h.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",ce),L(ce,Me),we||(we={}),t.select(ce).classed("js-plotly-plot",!0),c.makeTester(),Array.isArray(ce._promises)||(ce._promises=[]);var Fe=(ce.data||[]).length===0&&Array.isArray(ge);Array.isArray(ge)&&(b.cleanData(ge),Fe?ce.data=ge:ce.data.push.apply(ce.data,ge),ce.empty=!1),ce.layout&&!Fe||(ce.layout=b.cleanLayout(we)),s.supplyDefaults(ce);var Ye=ce._fullLayout,rt=Ye._has("cartesian");Ye._replotting=!0,(Fe||Ye._shouldCreateBgLayer)&&(function(kt){var at=t.select(kt),tt=kt._fullLayout;if(tt._calcInverseTransform=xe,tt._calcInverseTransform(kt),tt._container=at.selectAll(".plot-container").data([0]),tt._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),tt._paperdiv=tt._container.selectAll(".svg-container").data([0]),tt._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),tt._glcontainer=tt._paperdiv.selectAll(".gl-container").data([{}]),tt._glcontainer.enter().append("div").classed("gl-container",!0),tt._paperdiv.selectAll(".main-svg").remove(),tt._paperdiv.select(".modebar-container").remove(),tt._paper=tt._paperdiv.insert("svg",":first-child").classed("main-svg",!0),tt._toppaper=tt._paperdiv.append("svg").classed("main-svg",!0),tt._modebardiv=tt._paperdiv.append("div"),delete tt._modeBar,tt._hoverpaper=tt._paperdiv.append("svg").classed("main-svg",!0),!tt._uid){var _t={};t.selectAll("defs").each(function(){this.id&&(_t[this.id.split("-")[1]]=1)}),tt._uid=h.randstr(_t)}tt._paperdiv.selectAll(".main-svg").attr(g.svgAttrs),tt._defs=tt._paper.append("defs").attr("id","defs-"+tt._uid),tt._clips=tt._defs.append("g").classed("clips",!0),tt._topdefs=tt._toppaper.append("defs").attr("id","topdefs-"+tt._uid),tt._topclips=tt._topdefs.append("g").classed("clips",!0),tt._bgLayer=tt._paper.append("g").classed("bglayer",!0),tt._draggers=tt._paper.append("g").classed("draglayer",!0);var er=tt._paper.append("g").classed("layer-below",!0);tt._imageLowerLayer=er.append("g").classed("imagelayer",!0),tt._shapeLowerLayer=er.append("g").classed("shapelayer",!0),tt._cartesianlayer=tt._paper.append("g").classed("cartesianlayer",!0),tt._polarlayer=tt._paper.append("g").classed("polarlayer",!0),tt._ternarylayer=tt._paper.append("g").classed("ternarylayer",!0),tt._geolayer=tt._paper.append("g").classed("geolayer",!0),tt._funnelarealayer=tt._paper.append("g").classed("funnelarealayer",!0),tt._pielayer=tt._paper.append("g").classed("pielayer",!0),tt._iciclelayer=tt._paper.append("g").classed("iciclelayer",!0),tt._treemaplayer=tt._paper.append("g").classed("treemaplayer",!0),tt._sunburstlayer=tt._paper.append("g").classed("sunburstlayer",!0),tt._indicatorlayer=tt._toppaper.append("g").classed("indicatorlayer",!0),tt._glimages=tt._paper.append("g").classed("glimages",!0);var tr=tt._toppaper.append("g").classed("layer-above",!0);tt._imageUpperLayer=tr.append("g").classed("imagelayer",!0),tt._shapeUpperLayer=tr.append("g").classed("shapelayer",!0),tt._infolayer=tt._toppaper.append("g").classed("infolayer",!0),tt._menulayer=tt._toppaper.append("g").classed("menulayer",!0),tt._zoomlayer=tt._toppaper.append("g").classed("zoomlayer",!0),tt._hoverlayer=tt._hoverpaper.append("g").classed("hoverlayer",!0),tt._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),kt.emit("plotly_framework")}(ce),Ye._shouldCreateBgLayer&&delete Ye._shouldCreateBgLayer),c.initGradients(ce),c.initPatterns(ce),Fe&&i.saveShowSpikeInitial(ce);var Oe=!ce.calcdata||ce.calcdata.length!==(ce._fullData||[]).length;Oe&&s.doCalcdata(ce);for(var je=0;je<ce.calcdata.length;je++)ce.calcdata[je][0].trace=ce._fullData[je];ce._context.responsive?ce._responsiveChartHandler||(ce._responsiveChartHandler=function(){h.isHidden(ce)||s.resize(ce)},window.addEventListener("resize",ce._responsiveChartHandler)):h.clearResponsive(ce);var We=h.extendFlat({},Ye._size),qe=0;function et(){if(s.clearAutoMarginIds(ce),x.drawMarginPushers(ce),i.allowAutoMargin(ce),Ye._has("pie"))for(var kt=ce._fullData,at=0;at<kt.length;at++){var tt=kt[at];tt.type==="pie"&&tt.automargin&&s.allowAutoMargin(ce,"pie."+tt.uid+".automargin")}return s.doAutoMargin(ce),s.previousPromises(ce)}function st(){ce._transitioning||(x.doAutoRangeAndConstraints(ce),Fe&&i.saveRangeInitial(ce),o.getComponentMethod("rangeslider","calcAutorange")(ce))}var ct=[s.previousPromises,function(){if(Se)return B.addFrames(ce,Se)},function kt(){for(var at=Ye._basePlotModules,tt=0;tt<at.length;tt++)at[tt].drawFramework&&at[tt].drawFramework(ce);!Ye._glcanvas&&Ye._has("gl")&&(Ye._glcanvas=Ye._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(Ue){return Ue.key}),Ye._glcanvas.enter().append("canvas").attr("class",function(Ue){return"gl-canvas gl-canvas-"+Ue.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var _t=ce._context.plotGlPixelRatio;if(Ye._glcanvas){Ye._glcanvas.attr("width",Ye.width*_t).attr("height",Ye.height*_t).style("width",Ye.width+"px").style("height",Ye.height+"px");var er=Ye._glcanvas.data()[0].regl;if(er&&(Math.floor(Ye.width*_t)!==er._gl.drawingBufferWidth||Math.floor(Ye.height*_t)!==er._gl.drawingBufferHeight)){var tr="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(!qe)return h.log(tr+" Clearing graph and plotting again."),s.cleanPlot([],{},ce._fullData,Ye),s.supplyDefaults(ce),Ye=ce._fullLayout,s.doCalcdata(ce),qe++,kt();h.error(tr)}}return Ye.modebar.orientation==="h"?Ye._modebardiv.style("height",null).style("width","100%"):Ye._modebardiv.style("width",null).style("height",Ye.height+"px"),s.previousPromises(ce)},et,function(){if(s.didMarginChange(We,Ye._size))return h.syncOrAsync([et,x.layoutStyles],ce)}];rt&&ct.push(function(){if(Oe)return h.syncOrAsync([o.getComponentMethod("shapes","calcAutorange"),o.getComponentMethod("annotations","calcAutorange"),st],ce);st()}),ct.push(x.layoutStyles),rt&&ct.push(function(){return i.draw(ce,Fe?"":"redraw")},function(kt){kt._fullLayout._insideTickLabelsAutorange&&$(kt,kt._fullLayout._insideTickLabelsAutorange).then(function(){kt._fullLayout._insideTickLabelsAutorange=void 0})}),ct.push(x.drawData,x.finalDraw,a,s.addLinks,s.rehover,s.redrag,s.doAutoMargin,function(kt){kt._fullLayout._insideTickLabelsAutorange&&Fe&&i.saveRangeInitial(kt,!0)},s.previousPromises);var Pt=h.syncOrAsync(ct,ce);return Pt&&Pt.then||(Pt=Promise.resolve()),Pt.then(function(){return w(ce),ce})},B.purge=function(ce){var ge=(ce=h.getGraphDiv(ce))._fullLayout||{},we=ce._fullData||[];return s.cleanPlot([],{},we,ge),s.purge(ce),f.purge(ce),ge._container&&ge._container.remove(),delete ce._context,ce},B.react=function(ce,ge,we,Me){var Se,ze;ce=h.getGraphDiv(ce),b.clearPromiseQueue(ce);var Fe=ce._fullData,Ye=ce._fullLayout;if(h.isPlotDiv(ce)&&Fe&&Ye){if(h.isPlainObject(ge)){var rt=ge;ge=rt.data,we=rt.layout,Me=rt.config,Se=rt.frames}var Oe=!1;if(Me){var je=h.extendDeep({},ce._context);ce._context=void 0,L(ce,Me),Oe=function Le(Pe,Xe){var ht;for(ht in Pe)if(ht.charAt(0)!=="_"){var Mt=Pe[ht],pt=Xe[ht];if(Mt!==pt)if(h.isPlainObject(Mt)&&h.isPlainObject(pt)){if(Le(Mt,pt))return!0}else{if(!Array.isArray(Mt)||!Array.isArray(pt)||Mt.length!==pt.length)return!0;for(var Lt=0;Lt<Mt.length;Lt++)if(Mt[Lt]!==pt[Lt]&&(!h.isPlainObject(Mt[Lt])||!h.isPlainObject(pt[Lt])||Le(Mt[Lt],pt[Lt])))return!0}}}(je,ce._context)}ce.data=ge||[],b.cleanData(ce.data),ce.layout=we||{},b.cleanLayout(ce.layout),function(Le,Pe,Xe,ht){var Mt,pt,Lt,vt,Dt,xt,it,St,Nt=ht._preGUI,Ut=[],Qt={};for(Mt in Nt){if(Dt=de(Mt,he)){if(pt=Dt.attr||Dt.head+".uirevision",(vt=(Lt=e(ht,pt).get())&&ue(pt,Pe))&&vt===Lt&&((xt=Nt[Mt])===null&&(xt=void 0),Ee(St=(it=e(Pe,Mt)).get(),xt))){St===void 0&&Mt.substr(Mt.length-9)==="autorange"&&Ut.push(Mt.substr(0,Mt.length-10)),it.set(X(e(ht,Mt).get()));continue}}else h.warn("unrecognized GUI edit: "+Mt);delete Nt[Mt],Mt.substr(Mt.length-8,6)==="range["&&(Qt[Mt.substr(0,Mt.length-9)]=1)}for(var Ie=0;Ie<Ut.length;Ie++){var lt=Ut[Ie];if(Qt[lt]){var wt=e(Pe,lt).get();wt&&delete wt.autorange}}var Ot=ht._tracePreGUI;for(var Gt in Ot){var ir,Xt=Ot[Gt],Kt=null;for(Mt in Xt){if(!Kt){var or=ve(Gt,Xe);if(or<0){delete Ot[Gt];break}var dr=ke(Gt,Le,(ir=Xe[or]._fullInput).index);if(dr<0){delete Ot[Gt];break}Kt=Le[dr]}if(Dt=de(Mt,se)){if(Dt.attr?vt=(Lt=e(ht,Dt.attr).get())&&ue(Dt.attr,Pe):(Lt=ir.uirevision,(vt=Kt.uirevision)===void 0&&(vt=Pe.uirevision)),vt&&vt===Lt&&((xt=Xt[Mt])===null&&(xt=void 0),Ee(St=(it=e(Kt,Mt)).get(),xt))){it.set(X(e(ir,Mt).get()));continue}}else h.warn("unrecognized GUI edit: "+Mt+" in trace uid "+Gt);delete Xt[Mt]}}}(ce.data,ce.layout,Fe,Ye),s.supplyDefaults(ce,{skipUpdateCalc:!0});var We=ce._fullData,qe=ce._fullLayout,et=qe.datarevision===void 0,st=qe.transition,ct=function(Le,Pe,Xe,ht,Mt){var pt=T.layoutFlags();function Lt(vt){return u.getLayoutValObject(Xe,vt)}return pt.arrays={},pt.rangesAltered={},pt.nChanges=0,pt.nChangesAnim=0,be(Pe,Xe,[],{getValObject:Lt,flags:pt,immutable:ht,transition:Mt,gd:Le}),(pt.plot||pt.calc)&&(pt.layoutReplot=!0),Mt&&pt.nChanges&&pt.nChangesAnim&&(pt.anim=pt.nChanges===pt.nChangesAnim?"all":"some"),pt}(ce,Ye,qe,et,st),Pt=ct.newDataRevision,kt=function(Le,Pe,Xe,ht,Mt,pt){var Lt=Pe.length===Xe.length;if(!Mt&&!Lt)return{fullReplot:!0,calc:!0};var vt,Dt,xt=T.traceFlags();xt.arrays={},xt.nChanges=0,xt.nChangesAnim=0;var it={getValObject:function(Nt){var Ut=u.getTraceValObject(Dt,Nt);return!Dt._module.animatable&&Ut.anim&&(Ut.anim=!1),Ut},flags:xt,immutable:ht,transition:Mt,newDataRevision:pt,gd:Le},St={};for(vt=0;vt<Pe.length;vt++)if(Xe[vt]){if(Dt=Xe[vt]._fullInput,s.hasMakesDataTransform(Dt)&&(Dt=Xe[vt]),St[Dt.uid])continue;St[Dt.uid]=1,be(Pe[vt]._fullInput,Dt,[],it)}return(xt.calc||xt.plot)&&(xt.fullReplot=!0),Mt&&xt.nChanges&&xt.nChangesAnim&&(xt.anim=xt.nChanges===xt.nChangesAnim&&Lt?"all":"some"),xt}(ce,Fe,We,et,st,Pt);if(te(ce)&&(ct.layoutReplot=!0),kt.calc||ct.calc){ce.calcdata=void 0;for(var at=Object.getOwnPropertyNames(qe),tt=0;tt<at.length;tt++){var _t=at[tt],er=_t.substring(0,5);if(er==="xaxis"||er==="yaxis"){var tr=qe[_t]._emptyCategories;tr&&tr()}}}else s.supplyDefaultsUpdateCalc(ce.calcdata,We);var Ue=[];if(Se&&(ce._transitionData={},s.createTransitionData(ce),Ue.push(function(){return B.addFrames(ce,Se)})),qe.transition&&!Oe&&(kt.anim||ct.anim))ct.ticks&&Ue.push(x.doTicksRelayout),s.doCalcdata(ce),x.doAutoRangeAndConstraints(ce),Ue.push(function(){return s.transitionFromReact(ce,kt,ct,Ye)});else if(kt.fullReplot||ct.layoutReplot||Oe)ce._fullLayout._skipDefaults=!0,Ue.push(B._doPlot);else{for(var He in ct.arrays){var Be=ct.arrays[He];if(Be.length){var Ke=o.getComponentMethod(He,"drawOne");if(Ke!==h.noop)for(var _e=0;_e<Be.length;_e++)Ke(ce,Be[_e]);else{var Ce=o.getComponentMethod(He,"draw");if(Ce===h.noop)throw new Error("cannot draw components: "+He);Ce(ce)}}}Ue.push(s.previousPromises),kt.style&&Ue.push(x.doTraceStyle),(kt.colorbars||ct.colorbars)&&Ue.push(x.doColorBars),ct.legend&&Ue.push(x.doLegend),ct.layoutstyle&&Ue.push(x.layoutStyles),ct.axrange&&j(Ue),ct.ticks&&Ue.push(x.doTicksRelayout),ct.modebar&&Ue.push(x.doModeBar),ct.camera&&Ue.push(x.doCamera),Ue.push(w)}Ue.push(s.rehover,s.redrag),(ze=h.syncOrAsync(Ue,ce))&&ze.then||(ze=Promise.resolve(ce))}else ze=B.newPlot(ce,ge,we,Me);return ze.then(function(){return ce.emit("plotly_react",{data:ge,layout:we}),ce})},B.redraw=function(ce){if(ce=h.getGraphDiv(ce),!h.isPlotDiv(ce))throw new Error("This element is not a Plotly plot: "+ce);return b.cleanData(ce.data),b.cleanLayout(ce.layout),ce.calcdata=void 0,B._doPlot(ce).then(function(){return ce.emit("plotly_redraw"),ce})},B.relayout=$,B.restyle=G,B.setPlotConfig=function(ce){return h.extendFlat(y,ce)},B.update=ie,B._guiRelayout=ae($),B._guiRestyle=ae(G),B._guiUpdate=ae(ie),B._storeDirectGUIEdit=function(ce,ge,we){for(var Me in we)Z(Me,e(ce,Me).get(),we[Me],ge)}},{"../components/color":650,"../components/drawing":672,"../constants/xmlns_namespaces":764,"../lib":787,"../lib/events":776,"../lib/queue":803,"../plots/cartesian/axes":838,"../plots/cartesian/constants":845,"../plots/cartesian/graph_interact":848,"../plots/cartesian/select":858,"../plots/plots":901,"../registry":915,"./edit_types":820,"./helpers":821,"./manage_arrays":823,"./plot_config":825,"./plot_schema":826,"./subroutines":828,"@plotly/d3":58,"fast-isnumeric":246,"has-hover":435}],825:[function(r,I,B){var t={staticPlot:{valType:"boolean",dflt:!1},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},d={};(function m(h,e){for(var f in h){var l=h[f];l.valType?e[f]=l.dflt:(e[f]||(e[f]={}),m(l,e[f]))}})(t,d),I.exports={configAttributes:t,dfltConfig:d}},{}],826:[function(r,I,B){var t=r("../registry"),d=r("../lib"),m=r("../plots/attributes"),h=r("../plots/layout_attributes"),e=r("../plots/frame_attributes"),f=r("../plots/animation_attributes"),l=r("./plot_config").configAttributes,o=r("./edit_types"),u=d.extendDeepAll,s=d.isPlainObject,i=d.isArrayOrTypedArray,c=d.nestedProperty,n=d.valObjectMeta,a=["_isSubplotObj","_isLinkedToArray","_arrayAttrRegexps","_deprecated"];function g(A,S,w){if(!A)return!1;if(A._isLinkedToArray){if(p(S[w]))w++;else if(w<S.length)return!1}for(;w<S.length;w++){var E=A[S[w]];if(!s(E)||(A=E,w===S.length-1))break;if(A._isLinkedToArray){if(!p(S[++w]))return!1}else if(A.valType==="info_array"){var k=S[++w];if(!p(k))return!1;var L=A.items;if(Array.isArray(L)){if(k>=L.length)return!1;if(A.dimensions===2){if(w++,S.length===w)return A;var M=S[w];if(!p(M))return!1;A=L[k][M]}else A=L[k]}else A=L}}return A}function p(A){return A===Math.round(A)&&A>=0}function y(){var A,S,w={};for(A in u(w,h),t.subplotsRegistry)if((S=t.subplotsRegistry[A]).layoutAttributes)if(Array.isArray(S.attr))for(var E=0;E<S.attr.length;E++)x(w,S,S.attr[E]);else x(w,S,S.attr==="subplot"?S.name:S.attr);for(A in t.componentsRegistry){var k=(S=t.componentsRegistry[A]).schema;if(k&&(k.subplots||k.layout)){var L=k.subplots;if(L&&L.xaxis&&!L.yaxis)for(var M in L.xaxis)delete w.yaxis[M]}else S.name==="colorscale"?u(w,S.layoutAttributes):S.layoutAttributes&&T(w,S.layoutAttributes,S.name)}return{layoutAttributes:b(w)}}function v(){var A={frames:u({},e)};return b(A),A.frames}function b(A){return function(S){B.crawl(S,function(w,E,k){B.isValObject(w)?w.arrayOk!==!0&&w.valType!=="data_array"||(k[E+"src"]={valType:"string",editType:"none"}):s(w)&&(w.role="object")})}(A),function(S){B.crawl(S,function(w,E,k){if(w){var L=w._isLinkedToArray;L&&(delete w._isLinkedToArray,k[E]={items:{}},k[E].items[L]=w,k[E].role="object")}})}(A),function(S){(function w(E){for(var k in E)if(s(E[k]))w(E[k]);else if(Array.isArray(E[k]))for(var L=0;L<E[k].length;L++)w(E[k][L]);else E[k]instanceof RegExp&&(E[k]=E[k].toString())})(S)}(A),A}function x(A,S,w){var E=c(A,w),k=u({},S.layoutAttributes);k._isSubplotObj=!0,E.set(k)}function T(A,S,w){var E=c(A,w);E.set(u(E.get()||{},S))}B.IS_SUBPLOT_OBJ="_isSubplotObj",B.IS_LINKED_TO_ARRAY="_isLinkedToArray",B.DEPRECATED="_deprecated",B.UNDERSCORE_ATTRS=a,B.get=function(){var A={};t.allTypes.forEach(function(w){A[w]=function(E){var k,L;k=t.modules[E]._module,L=k.basePlotModule;var M={type:null},P=u({},m),D=u({},k.attributes);B.crawl(D,function(G,X,K,Z,H){c(P,H).set(void 0),G===void 0&&c(D,H).set(void 0)}),u(M,P),t.traceIs(E,"noOpacity")&&delete M.opacity,t.traceIs(E,"showLegend")||(delete M.showlegend,delete M.legendgroup),t.traceIs(E,"noHover")&&(delete M.hoverinfo,delete M.hoverlabel),k.selectPoints||delete M.selectedpoints,u(M,D),L.attributes&&u(M,L.attributes),M.type=E;var N={meta:k.meta||{},categories:k.categories||{},animatable:Boolean(k.animatable),type:E,attributes:b(M)};if(k.layoutAttributes){var U={};u(U,k.layoutAttributes),N.layoutAttributes=b(U)}return k.animatable||B.crawl(N,function(G){B.isValObject(G)&&"anim"in G&&delete G.anim}),N}(w)});var S={};return Object.keys(t.transformsRegistry).forEach(function(w){S[w]=function(E){var k=t.transformsRegistry[E],L=u({},k.attributes);return Object.keys(t.componentsRegistry).forEach(function(M){var P=t.componentsRegistry[M];P.schema&&P.schema.transforms&&P.schema.transforms[E]&&Object.keys(P.schema.transforms[E]).forEach(function(D){T(L,P.schema.transforms[E][D],D)})}),{attributes:b(L)}}(w)}),{defs:{valObjects:n,metaKeys:a.concat(["description","role","editType","impliedEdits"]),editType:{traces:o.traces,layout:o.layout},impliedEdits:{}},traces:A,layout:y(),transforms:S,frames:v(),animation:b(f),config:b(l)}},B.crawl=function(A,S,w,E){var k=w||0;E=E||"",Object.keys(A).forEach(function(L){var M=A[L];if(a.indexOf(L)===-1){var P=(E?E+".":"")+L;S(M,L,A,k,P),B.isValObject(M)||s(M)&&L!=="impliedEdits"&&B.crawl(M,S,k+1,P)}})},B.isValObject=function(A){return A&&A.valType!==void 0},B.findArrayAttributes=function(A){var S,w,E=[],k=[],L=[];function M(G,X,K,Z){k=k.slice(0,Z).concat([X]),L=L.slice(0,Z).concat([G&&G._isLinkedToArray]),G&&(G.valType==="data_array"||G.arrayOk===!0)&&!(k[Z-1]==="colorbar"&&(X==="ticktext"||X==="tickvals"))&&function H(Y,$,z){var j=Y[k[$]],W=z+k[$];if($===k.length-1)i(j)&&E.push(w+W);else if(L[$]){if(Array.isArray(j))for(var ee=0;ee<j.length;ee++)s(j[ee])&&H(j[ee],$+1,W+"["+ee+"].")}else s(j)&&H(j,$+1,W+".")}(S,0,"")}S=A,w="",B.crawl(m,M),A._module&&A._module.attributes&&B.crawl(A._module.attributes,M);var P=A.transforms;if(P)for(var D=0;D<P.length;D++){var N=P[D],U=N._module;U&&(w="transforms["+D+"].",S=N,B.crawl(U.attributes,M))}return E},B.getTraceValObject=function(A,S){var w,E,k=S[0],L=1;if(k==="transforms"){if(S.length===1)return m.transforms;var M=A.transforms;if(!Array.isArray(M)||!M.length)return!1;var P=S[1];if(!p(P)||P>=M.length)return!1;E=(w=(t.transformsRegistry[M[P].type]||{}).attributes)&&w[S[2]],L=3}else{var D=A._module;if(D||(D=(t.modules[A.type||m.type.dflt]||{})._module),!D)return!1;if(!(E=(w=D.attributes)&&w[k])){var N=D.basePlotModule;N&&N.attributes&&(E=N.attributes[k])}E||(E=m[k])}return g(E,S,L)},B.getLayoutValObject=function(A,S){return g(function(w,E){var k,L,M,P,D=w._basePlotModules;if(D){var N;for(k=0;k<D.length;k++){if((M=D[k]).attrRegex&&M.attrRegex.test(E)){if(M.layoutAttrOverrides)return M.layoutAttrOverrides;!N&&M.layoutAttributes&&(N=M.layoutAttributes)}var U=M.baseLayoutAttrOverrides;if(U&&E in U)return U[E]}if(N)return N}var G=w._modules;if(G){for(k=0;k<G.length;k++)if((P=G[k].layoutAttributes)&&E in P)return P[E]}for(L in t.componentsRegistry){if((M=t.componentsRegistry[L]).name==="colorscale"&&E.indexOf("coloraxis")===0)return M.layoutAttributes[E];if(!M.schema&&E===M.name)return M.layoutAttributes}return E in h&&h[E]}(A,S[0]),S,1)}},{"../lib":787,"../plots/animation_attributes":832,"../plots/attributes":834,"../plots/frame_attributes":868,"../plots/layout_attributes":892,"../registry":915,"./edit_types":820,"./plot_config":825}],827:[function(r,I,B){var t=r("../lib"),d=r("../plots/attributes"),m={name:{valType:"string",editType:"none"}};function h(f){return f&&typeof f=="string"}function e(f){var l=f.length-1;return f.charAt(l)!=="s"&&t.warn("bad argument to arrayDefaultKey: "+f),f.substr(0,f.length-1)+"defaults"}m.templateitemname={valType:"string",editType:"calc"},B.templatedArray=function(f,l){return l._isLinkedToArray=f,l.name=m.name,l.templateitemname=m.templateitemname,l},B.traceTemplater=function(f){var l,o,u={};for(l in f)o=f[l],Array.isArray(o)&&o.length&&(u[l]=0);return{newTrace:function(s){var i={type:l=t.coerce(s,{},d,"type"),_template:null};if(l in u){o=f[l];var c=u[l]%o.length;u[l]++,i._template=o[c]}return i}}},B.newContainer=function(f,l,o){var u=f._template,s=u&&(u[l]||o&&u[o]);return t.isPlainObject(s)||(s=null),f[l]={_template:s}},B.arrayTemplater=function(f,l,o){var u=f._template,s=u&&u[e(l)],i=u&&u[l];Array.isArray(i)&&i.length||(i=[]);var c={};return{newItem:function(n){var a={name:n.name,_input:n},g=a.templateitemname=n.templateitemname;if(!h(g))return a._template=s,a;for(var p=0;p<i.length;p++){var y=i[p];if(y.name===g)return c[g]=1,a._template=y,a}return a[o]=n[o]||!1,a._template=!1,a},defaultItems:function(){for(var n=[],a=0;a<i.length;a++){var g=i[a],p=g.name;if(h(p)&&!c[p]){var y={_template:g,name:p,_input:{_templateitemname:p}};y.templateitemname=g.templateitemname,n.push(y),c[p]=1}}return n}}},B.arrayDefaultKey=e,B.arrayEditor=function(f,l,o){var u=(t.nestedProperty(f,l).get()||[]).length,s=o._index,i=s>=u&&(o._input||{})._templateitemname;i&&(s=u);var c,n=l+"["+s+"]";function a(){c={},i&&(c[n]={},c[n].templateitemname=i)}function g(y,v){i?t.nestedProperty(c[n],y).set(v):c[n+"."+y]=v}function p(){var y=c;return a(),y}return a(),{modifyBase:function(y,v){c[y]=v},modifyItem:g,getUpdateObj:p,applyUpdate:function(y,v){y&&g(y,v);var b=p();for(var x in b)t.nestedProperty(f,x).set(b[x])}}}},{"../lib":787,"../plots/attributes":834}],828:[function(r,I,B){var t=r("@plotly/d3"),d=r("../registry"),m=r("../plots/plots"),h=r("../lib"),e=r("../lib/clear_gl_canvases"),f=r("../components/color"),l=r("../components/drawing"),o=r("../components/titles"),u=r("../components/modebar"),s=r("../plots/cartesian/axes"),i=r("../constants/alignment"),c=r("../plots/cartesian/constraints"),n=c.enforce,a=c.clean,g=r("../plots/cartesian/autorange").doAutoRange;function p(S,w,E){for(var k=0;k<E.length;k++){var L=E[k][0],M=E[k][1];if(!(L[0]>=S[1]||L[1]<=S[0])&&M[0]<w[1]&&M[1]>w[0])return!0}return!1}function y(S){var w,E,k,L,M,P,D=S._fullLayout,N=D._size,U=N.p,G=s.list(S,"",!0);if(D._paperdiv.style({width:S._context.responsive&&D.autosize&&!S._context._hasZeroWidth&&!S.layout.width?"100%":D.width+"px",height:S._context.responsive&&D.autosize&&!S._context._hasZeroHeight&&!S.layout.height?"100%":D.height+"px"}).selectAll(".main-svg").call(l.setSize,D.width,D.height),S._context.setBackground(S,D.paper_bgcolor),B.drawMainTitle(S),u.manage(S),!D._has("cartesian"))return m.previousPromises(S);function X(qe,et,st){var ct=qe._lw/2;return qe._id.charAt(0)==="x"?et?st==="top"?et._offset-U-ct:et._offset+et._length+U+ct:N.t+N.h*(1-(qe.position||0))+ct%1:et?st==="right"?et._offset+et._length+U+ct:et._offset-U-ct:N.l+N.w*(qe.position||0)+ct%1}for(w=0;w<G.length;w++){var K=(L=G[w])._anchorAxis;L._linepositions={},L._lw=l.crispRound(S,L.linewidth,1),L._mainLinePosition=X(L,K,L.side),L._mainMirrorPosition=L.mirror&&K?X(L,K,i.OPPOSITE_SIDE[L.side]):null}var Z=[],H=[],Y=[],$=f.opacity(D.paper_bgcolor)===1&&f.opacity(D.plot_bgcolor)===1&&D.paper_bgcolor===D.plot_bgcolor;for(E in D._plots)if((k=D._plots[E]).mainplot)k.bg&&k.bg.remove(),k.bg=void 0;else{var z=k.xaxis.domain,j=k.yaxis.domain,W=k.plotgroup;if(p(z,j,Y)){var ee=W.node(),J=k.bg=h.ensureSingle(W,"rect","bg");ee.insertBefore(J.node(),ee.childNodes[0]),H.push(E)}else W.select("rect.bg").remove(),Y.push([z,j]),$||(Z.push(E),H.push(E))}var Q,te,ie,ae,he,se,de,ue,ve,ke,Ee,be,xe,ce=D._bgLayer.selectAll(".bg").data(Z);for(ce.enter().append("rect").classed("bg",!0),ce.exit().remove(),ce.each(function(qe){D._plots[qe].bg=t.select(this)}),w=0;w<H.length;w++)k=D._plots[H[w]],M=k.xaxis,P=k.yaxis,k.bg&&M._offset!==void 0&&P._offset!==void 0&&k.bg.call(l.setRect,M._offset-U,P._offset-U,M._length+2*U,P._length+2*U).call(f.fill,D.plot_bgcolor).style("stroke-width",0);if(!D._hasOnlyLargeSploms)for(E in D._plots){k=D._plots[E],M=k.xaxis,P=k.yaxis;var ge,we,Me=k.clipId="clip"+D._uid+E+"plot",Se=h.ensureSingleById(D._clips,"clipPath",Me,function(qe){qe.classed("plotclip",!0).append("rect")});k.clipRect=Se.select("rect").attr({width:M._length,height:P._length}),l.setTranslate(k.plot,M._offset,P._offset),k._hasClipOnAxisFalse?(ge=null,we=Me):(ge=Me,we=null),l.setClipUrl(k.plot,ge,S),k.layerClipId=we}function ze(qe){return"M"+Q+","+qe+"H"+te}function Fe(qe){return"M"+M._offset+","+qe+"h"+M._length}function Ye(qe){return"M"+qe+","+ue+"V"+de}function rt(qe){return"M"+qe+","+P._offset+"v"+P._length}function Oe(qe,et,st){if(!qe.showline||E!==qe._mainSubplot)return"";if(!qe._anchorAxis)return st(qe._mainLinePosition);var ct=et(qe._mainLinePosition);return qe.mirror&&(ct+=et(qe._mainMirrorPosition)),ct}for(E in D._plots){k=D._plots[E],M=k.xaxis,P=k.yaxis;var je="M0,0";v(M,E)&&(he=x(M,"left",P,G),Q=M._offset-(he?U+he:0),se=x(M,"right",P,G),te=M._offset+M._length+(se?U+se:0),ie=X(M,P,"bottom"),ae=X(M,P,"top"),!(xe=!M._anchorAxis||E!==M._mainSubplot)||M.mirror!=="allticks"&&M.mirror!=="all"||(M._linepositions[E]=[ie,ae]),je=Oe(M,ze,Fe),xe&&M.showline&&(M.mirror==="all"||M.mirror==="allticks")&&(je+=ze(ie)+ze(ae)),k.xlines.style("stroke-width",M._lw+"px").call(f.stroke,M.showline?M.linecolor:"rgba(0,0,0,0)")),k.xlines.attr("d",je);var We="M0,0";v(P,E)&&(Ee=x(P,"bottom",M,G),de=P._offset+P._length+(Ee?U:0),be=x(P,"top",M,G),ue=P._offset-(be?U:0),ve=X(P,M,"left"),ke=X(P,M,"right"),!(xe=!P._anchorAxis||E!==P._mainSubplot)||P.mirror!=="allticks"&&P.mirror!=="all"||(P._linepositions[E]=[ve,ke]),We=Oe(P,Ye,rt),xe&&P.showline&&(P.mirror==="all"||P.mirror==="allticks")&&(We+=Ye(ve)+Ye(ke)),k.ylines.style("stroke-width",P._lw+"px").call(f.stroke,P.showline?P.linecolor:"rgba(0,0,0,0)")),k.ylines.attr("d",We)}return s.makeClipPaths(S),m.previousPromises(S)}function v(S,w){return(S.ticks||S.showline)&&(w===S._mainSubplot||S.mirror==="all"||S.mirror==="allticks")}function b(S,w,E){if(!E.showline||!E._lw)return!1;if(E.mirror==="all"||E.mirror==="allticks")return!0;var k=E._anchorAxis;if(!k)return!1;var L=i.FROM_BL[w];return E.side===w?k.domain[L]===S.domain[L]:E.mirror&&k.domain[1-L]===S.domain[1-L]}function x(S,w,E,k){if(b(S,w,E))return E._lw;for(var L=0;L<k.length;L++){var M=k[L];if(M._mainAxis===E._mainAxis&&b(S,w,M))return M._lw}return 0}function T(S,w){var E=S.title,k=S._size,L=0;switch(w==="start"?L=E.pad.l:w==="end"&&(L=-E.pad.r),E.xref){case"paper":return k.l+k.w*E.x+L;case"container":default:return S.width*E.x+L}}function A(S,w){var E=S.title,k=S._size,L=0;if(w!=="0em"&&w?w===i.CAP_SHIFT+"em"&&(L=E.pad.t):L=-E.pad.b,E.y==="auto")return k.t/2;switch(E.yref){case"paper":return k.t+k.h-k.h*E.y+L;case"container":default:return S.height-S.height*E.y+L}}B.layoutStyles=function(S){return h.syncOrAsync([m.doAutoMargin,y],S)},B.drawMainTitle=function(S){var w=S._fullLayout,E=function(L){var M=L.title,P="middle";return h.isRightAnchor(M)?P="end":h.isLeftAnchor(M)&&(P="start"),P}(w),k=function(L){var M=L.title,P="0em";return h.isTopAnchor(M)?P=i.CAP_SHIFT+"em":h.isMiddleAnchor(M)&&(P=i.MID_SHIFT+"em"),P}(w);o.draw(S,"gtitle",{propContainer:w,propName:"title.text",placeholder:w._dfltTitle.plot,attributes:{x:T(w,E),y:A(w,k),"text-anchor":E,dy:k}})},B.doTraceStyle=function(S){var w,E=S.calcdata,k=[];for(w=0;w<E.length;w++){var L=E[w],M=L[0]||{},P=M.trace||{},D=P._module||{},N=D.arraysToCalcdata;N&&N(L,P);var U=D.editStyle;U&&k.push({fn:U,cd0:M})}if(k.length){for(w=0;w<k.length;w++){var G=k[w];G.fn(S,G.cd0)}e(S),B.redrawReglTraces(S)}return m.style(S),d.getComponentMethod("legend","draw")(S),m.previousPromises(S)},B.doColorBars=function(S){return d.getComponentMethod("colorbar","draw")(S),m.previousPromises(S)},B.layoutReplot=function(S){var w=S.layout;return S.layout=void 0,d.call("_doPlot",S,"",w)},B.doLegend=function(S){return d.getComponentMethod("legend","draw")(S),m.previousPromises(S)},B.doTicksRelayout=function(S){return s.draw(S,"redraw"),S._fullLayout._hasOnlyLargeSploms&&(d.subplotsRegistry.splom.updateGrid(S),e(S),B.redrawReglTraces(S)),B.drawMainTitle(S),m.previousPromises(S)},B.doModeBar=function(S){var w=S._fullLayout;u.manage(S);for(var E=0;E<w._basePlotModules.length;E++){var k=w._basePlotModules[E].updateFx;k&&k(S)}return m.previousPromises(S)},B.doCamera=function(S){for(var w=S._fullLayout,E=w._subplots.gl3d,k=0;k<E.length;k++){var L=w[E[k]];L._scene.setViewport(L)}},B.drawData=function(S){var w=S._fullLayout;e(S);for(var E=w._basePlotModules,k=0;k<E.length;k++)E[k].plot(S);return B.redrawReglTraces(S),m.style(S),d.getComponentMethod("shapes","draw")(S),d.getComponentMethod("annotations","draw")(S),d.getComponentMethod("images","draw")(S),w._replotting=!1,m.previousPromises(S)},B.redrawReglTraces=function(S){var w=S._fullLayout;if(w._has("regl")){var E,k,L=S._fullData,M=[],P=[];for(w._hasOnlyLargeSploms&&w._splomGrid.draw(),E=0;E<L.length;E++){var D=L[E];D.visible===!0&&D._length!==0&&(D.type==="splom"?w._splomScenes[D.uid].draw():D.type==="scattergl"?h.pushUnique(M,D.xaxis+D.yaxis):D.type==="scatterpolargl"&&h.pushUnique(P,D.subplot))}for(E=0;E<M.length;E++)(k=w._plots[M[E]])._scene&&k._scene.draw();for(E=0;E<P.length;E++)(k=w[P[E]]._subplot)._scene&&k._scene.draw()}},B.doAutoRangeAndConstraints=function(S){for(var w,E=s.list(S,"",!0),k={},L=0;L<E.length;L++)if(!k[(w=E[L])._id]){k[w._id]=1,a(S,w),g(S,w);var M=w._matchGroup;if(M)for(var P in M){var D=s.getFromId(S,P);g(S,D,w.range),k[P]=1}}n(S)},B.finalDraw=function(S){d.getComponentMethod("rangeslider","draw")(S),d.getComponentMethod("rangeselector","draw")(S)},B.drawMarginPushers=function(S){d.getComponentMethod("legend","draw")(S),d.getComponentMethod("rangeselector","draw")(S),d.getComponentMethod("sliders","draw")(S),d.getComponentMethod("updatemenus","draw")(S),d.getComponentMethod("colorbar","draw")(S)}},{"../components/color":650,"../components/drawing":672,"../components/modebar":713,"../components/titles":748,"../constants/alignment":755,"../lib":787,"../lib/clear_gl_canvases":771,"../plots/cartesian/autorange":837,"../plots/cartesian/axes":838,"../plots/cartesian/constraints":846,"../plots/plots":901,"../registry":915,"@plotly/d3":58}],829:[function(r,I,B){var t=r("../lib"),d=t.isPlainObject,m=r("./plot_schema"),h=r("../plots/plots"),e=r("../plots/attributes"),f=r("./plot_template"),l=r("./plot_config").dfltConfig;function o(p,y){p=t.extendDeep({},p);var v,b,x=Object.keys(p).sort();function T(k,L,M){if(d(L)&&d(k))o(k,L);else if(Array.isArray(L)&&Array.isArray(k)){var P=f.arrayTemplater({_template:p},M);for(b=0;b<L.length;b++){var D=L[b],N=P.newItem(D)._template;N&&o(N,D)}var U=P.defaultItems();for(b=0;b<U.length;b++)L.push(U[b]._template);for(b=0;b<L.length;b++)delete L[b].templateitemname}}for(v=0;v<x.length;v++){var A=x[v],S=p[A];if(A in y?T(S,y[A],A):y[A]=S,u(A)===A)for(var w in y){var E=u(w);w===E||E!==A||w in p||T(S,y[w],A)}}}function u(p){return p.replace(/[0-9]+$/,"")}function s(p,y,v,b,x){var T=x&&v(x);for(var A in p){var S=p[A],w=n(p,A,b),E=n(p,A,x),k=v(E);if(!k){var L=u(A);L!==A&&(k=v(E=n(p,L,x)))}if((!T||T!==k)&&!(!k||k._noTemplating||k.valType==="data_array"||k.arrayOk&&Array.isArray(S)))if(!k.valType&&d(S))s(S,y,v,w,E);else if(k._isLinkedToArray&&Array.isArray(S))for(var M=!1,P=0,D={},N=0;N<S.length;N++){var U=S[N];if(d(U)){var G=U.name;if(G)D[G]||(s(U,y,v,n(S,P,w),n(S,P,E)),P++,D[G]=1);else if(!M){var X=n(p,f.arrayDefaultKey(A),b),K=n(S,P,w);s(U,y,v,K,n(S,P,E));var Z=t.nestedProperty(y,K);t.nestedProperty(y,X).set(Z.get()),Z.set(null),M=!0}}}else t.nestedProperty(y,w).set(S)}}function i(p,y){return m.getLayoutValObject(p,t.nestedProperty({},y).parts)}function c(p,y){return m.getTraceValObject(p,t.nestedProperty({},y).parts)}function n(p,y,v){return v?Array.isArray(p)?v+"["+y+"]":v+"."+y:y}function a(p){for(var y=0;y<p.length;y++)if(d(p[y]))return!0}function g(p){var y;switch(p.code){case"data":y="The template has no key data.";break;case"layout":y="The template has no key layout.";break;case"missing":y=p.path?"There are no templates for item "+p.path+" with name "+p.templateitemname:"There are no templates for trace "+p.index+", of type "+p.traceType+".";break;case"unused":y=p.path?"The template item at "+p.path+" was not used in constructing the plot.":p.dataCount?"Some of the templates of type "+p.traceType+" were not used. The template has "+p.templateCount+" traces, the data only has "+p.dataCount+" of this type.":"The template has "+p.templateCount+" traces of type "+p.traceType+" but there are none in the data.";break;case"reused":y="Some of the templates of type "+p.traceType+" were used more than once. The template has "+p.templateCount+" traces, the data has "+p.dataCount+" of this type."}return p.msg=y,p}B.makeTemplate=function(p){p=t.isPlainObject(p)?p:t.getGraphDiv(p),p=t.extendDeep({_context:l},{data:p.data,layout:p.layout}),h.supplyDefaults(p);var y=p.data||[],v=p.layout||{};v._basePlotModules=p._fullLayout._basePlotModules,v._modules=p._fullLayout._modules;var b={data:{},layout:{}};y.forEach(function(P){var D={};s(P,D,c.bind(null,P));var N=t.coerce(P,{},e,"type"),U=b.data[N];U||(U=b.data[N]=[]),U.push(D)}),s(v,b.layout,i.bind(null,v)),delete b.layout.template;var x=v.template;if(d(x)){var T,A,S,w,E,k,L=x.layout;d(L)&&o(L,b.layout);var M=x.data;if(d(M)){for(A in b.data)if(S=M[A],Array.isArray(S)){for(k=(E=b.data[A]).length,w=S.length,T=0;T<k;T++)o(S[T%w],E[T]);for(T=k;T<w;T++)E.push(t.extendDeep({},S[T]))}for(A in M)A in b.data||(b.data[A]=t.extendDeep([],M[A]))}}return b},B.validateTemplate=function(p,y){var v=t.extendDeep({},{_context:l,data:p.data,layout:p.layout}),b=v.layout||{};d(y)||(y=b.template||{});var x=y.layout,T=y.data,A=[];v.layout=b,v.layout.template=y,h.supplyDefaults(v);var S=v._fullLayout,w=v._fullData,E={};if(d(x)?(function U(G,X){for(var K in G)if(K.charAt(0)!=="_"&&d(G[K])){var Z,H=u(K),Y=[];for(Z=0;Z<X.length;Z++)Y.push(n(G,K,X[Z])),H!==K&&Y.push(n(G,H,X[Z]));for(Z=0;Z<Y.length;Z++)E[Y[Z]]=1;U(G[K],Y)}}(S,["layout"]),function U(G,X){for(var K in G)if(K.indexOf("defaults")===-1&&d(G[K])){var Z=n(G,K,X);E[Z]?U(G[K],Z):A.push({code:"unused",path:Z})}}(x,"layout")):A.push({code:"layout"}),d(T)){for(var k,L={},M=0;M<w.length;M++){var P=w[M];L[k=P.type]=(L[k]||0)+1,P._fullInput._template||A.push({code:"missing",index:P._fullInput.index,traceType:k})}for(k in T){var D=T[k].length,N=L[k]||0;D>N?A.push({code:"unused",traceType:k,templateCount:D,dataCount:N}):N>D&&A.push({code:"reused",traceType:k,templateCount:D,dataCount:N})}}else A.push({code:"data"});if(function U(G,X){for(var K in G)if(K.charAt(0)!=="_"){var Z=G[K],H=n(G,K,X);d(Z)?(Array.isArray(G)&&Z._template===!1&&Z.templateitemname&&A.push({code:"missing",path:H,templateitemname:Z.templateitemname}),U(Z,H)):Array.isArray(Z)&&a(Z)&&U(Z,H)}}({data:w,layout:S},""),A.length)return A.map(g)}},{"../lib":787,"../plots/attributes":834,"../plots/plots":901,"./plot_config":825,"./plot_schema":826,"./plot_template":827}],830:[function(r,I,B){var t=r("fast-isnumeric"),d=r("./plot_api"),m=r("../plots/plots"),h=r("../lib"),e=r("../snapshot/helpers"),f=r("../snapshot/tosvg"),l=r("../snapshot/svgtoimg"),o=r("../version").version,u={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};I.exports=function(s,i){var c,n,a,g;function p(N){return!(N in i)||h.validate(i[N],u[N])}if(i=i||{},h.isPlainObject(s)?(c=s.data||[],n=s.layout||{},a=s.config||{},g={}):(s=h.getGraphDiv(s),c=h.extendDeep([],s.data),n=h.extendDeep({},s.layout),a=s._context,g=s._fullLayout||{}),!p("width")&&i.width!==null||!p("height")&&i.height!==null)throw new Error("Height and width should be pixel values.");if(!p("format"))throw new Error("Export format is not "+h.join2(u.format.values,", "," or ")+".");var y={};function v(N,U){return h.coerce(i,y,u,N,U)}var b=v("format"),x=v("width"),T=v("height"),A=v("scale"),S=v("setBackground"),w=v("imageDataOnly"),E=document.createElement("div");E.style.position="absolute",E.style.left="-5000px",document.body.appendChild(E);var k=h.extendFlat({},n);x?k.width=x:i.width===null&&t(g.width)&&(k.width=g.width),T?k.height=T:i.height===null&&t(g.height)&&(k.height=g.height);var L=h.extendFlat({},a,{_exportedPlot:!0,staticPlot:!0,setBackground:S}),M=e.getRedrawFunc(E);function P(){return new Promise(function(N){setTimeout(N,e.getDelay(E._fullLayout))})}function D(){return new Promise(function(N,U){var G=f(E,b,A),X=E._fullLayout.width,K=E._fullLayout.height;function Z(){d.purge(E),document.body.removeChild(E)}if(b==="full-json"){var H=m.graphJson(E,!1,"keepdata","object",!0,!0);return H.version=o,H=JSON.stringify(H),Z(),N(w?H:e.encodeJSON(H))}if(Z(),b==="svg")return N(w?G:e.encodeSVG(G));var Y=document.createElement("canvas");Y.id=h.randstr(),l({format:b,width:X,height:K,scale:A,canvas:Y,svg:G,promise:!0}).then(N).catch(U)})}return new Promise(function(N,U){d.newPlot(E,c,k,L).then(M).then(P).then(D).then(function(G){N(function(X){return w?X.replace(e.IMAGE_URL_PREFIX,""):X}(G))}).catch(function(G){U(G)})})}},{"../lib":787,"../plots/plots":901,"../snapshot/helpers":919,"../snapshot/svgtoimg":921,"../snapshot/tosvg":923,"../version":1388,"./plot_api":824,"fast-isnumeric":246}],831:[function(r,I,B){var t=r("../lib"),d=r("../plots/plots"),m=r("./plot_schema"),h=r("./plot_config").dfltConfig,e=t.isPlainObject,f=Array.isArray,l=t.isArrayOrTypedArray;function o(y,v,b,x,T,A){A=A||[];for(var S=Object.keys(y),w=0;w<S.length;w++){var E=S[w];if(E!=="transforms"){var k=A.slice();k.push(E);var L=y[E],M=v[E],P=a(b,E),D=(P||{}).valType,N=D==="info_array",U=D==="colorscale",G=(P||{}).items;if(n(b,E))if(e(L)&&e(M)&&D!=="any")o(L,M,P,x,T,k);else if(N&&f(L)){L.length>M.length&&x.push(c("unused",T,k.concat(M.length)));var X,K,Z,H,Y,$=M.length,z=Array.isArray(G);if(z&&($=Math.min($,G.length)),P.dimensions===2)for(K=0;K<$;K++)if(f(L[K])){L[K].length>M[K].length&&x.push(c("unused",T,k.concat(K,M[K].length)));var j=M[K].length;for(X=0;X<(z?Math.min(j,G[K].length):j);X++)Z=z?G[K][X]:G,H=L[K][X],Y=M[K][X],t.validate(H,Z)?Y!==H&&Y!==+H&&x.push(c("dynamic",T,k.concat(K,X),H,Y)):x.push(c("value",T,k.concat(K,X),H))}else x.push(c("array",T,k.concat(K),L[K]));else for(K=0;K<$;K++)Z=z?G[K]:G,H=L[K],Y=M[K],t.validate(H,Z)?Y!==H&&Y!==+H&&x.push(c("dynamic",T,k.concat(K),H,Y)):x.push(c("value",T,k.concat(K),H))}else if(P.items&&!N&&f(L)){var W,ee,J=G[Object.keys(G)[0]],Q=[];for(W=0;W<M.length;W++){var te=M[W]._index||W;if((ee=k.slice()).push(te),e(L[te])&&e(M[W])){Q.push(te);var ie=L[te],ae=M[W];e(ie)&&ie.visible!==!1&&ae.visible===!1?x.push(c("invisible",T,ee)):o(ie,ae,J,x,T,ee)}}for(W=0;W<L.length;W++)(ee=k.slice()).push(W),e(L[W])?Q.indexOf(W)===-1&&x.push(c("unused",T,ee)):x.push(c("object",T,ee,L[W]))}else!e(L)&&e(M)?x.push(c("object",T,k,L)):l(L)||!l(M)||N||U?E in v?t.validate(L,P)?P.valType==="enumerated"&&(P.coerceNumber&&L!==+M||L!==M)&&x.push(c("dynamic",T,k,L,M)):x.push(c("value",T,k,L)):x.push(c("unused",T,k,L)):x.push(c("array",T,k,L));else x.push(c("schema",T,k))}}return x}function u(y,v){for(var b=y.layout.layoutAttributes,x=0;x<v.length;x++){var T=v[x],A=y.traces[T.type],S=A.layoutAttributes;S&&(T.subplot?t.extendFlat(b[A.attributes.subplot.dflt],S):t.extendFlat(b,S))}return b}I.exports=function(y,v){y===void 0&&(y=[]),v===void 0&&(v={});var b,x,T=m.get(),A=[],S={_context:t.extendFlat({},h)};f(y)?(S.data=t.extendDeep([],y),b=y):(S.data=[],b=[],A.push(c("array","data"))),e(v)?(S.layout=t.extendDeep({},v),x=v):(S.layout={},x={},arguments.length>1&&A.push(c("object","layout"))),d.supplyDefaults(S);for(var w=S._fullData,E=b.length,k=0;k<E;k++){var L=b[k],M=["data",k];if(e(L)){var P=w[k],D=P.type,N=T.traces[D].attributes;N.type={valType:"enumerated",values:[D]},P.visible===!1&&L.visible!==!1&&A.push(c("invisible",M)),o(L,P,N,A,M);var U=L.transforms,G=P.transforms;if(U){f(U)||A.push(c("array",M,["transforms"])),M.push("transforms");for(var X=0;X<U.length;X++){var K=["transforms",X],Z=U[X].type;if(e(U[X])){var H=T.transforms[Z]?T.transforms[Z].attributes:{};H.type={valType:"enumerated",values:Object.keys(T.transforms)},o(U[X],G[X],H,A,M,K)}else A.push(c("object",M,K))}}}else A.push(c("object",M))}var Y=S._fullLayout,$=u(T,w);return o(x,Y,$,A,"layout"),A.length===0?void 0:A};var s={object:function(y,v){return(y==="layout"&&v===""?"The layout argument":y[0]==="data"&&v===""?"Trace "+y[1]+" in the data argument":i(y)+"key "+v)+" must be linked to an object container"},array:function(y,v){return(y==="data"?"The data argument":i(y)+"key "+v)+" must be linked to an array container"},schema:function(y,v){return i(y)+"key "+v+" is not part of the schema"},unused:function(y,v,b){var x=e(b)?"container":"key";return i(y)+x+" "+v+" did not get coerced"},dynamic:function(y,v,b,x){return[i(y)+"key",v,"(set to '"+b+"')","got reset to","'"+x+"'","during defaults."].join(" ")},invisible:function(y,v){return(v?i(y)+"item "+v:"Trace "+y[1])+" got defaulted to be not visible"},value:function(y,v,b){return[i(y)+"key "+v,"is set to an invalid value ("+b+")"].join(" ")}};function i(y){return f(y)?"In data trace "+y[1]+", ":"In "+y+", "}function c(y,v,b,x,T){var A,S;b=b||"",f(v)?(A=v[0],S=v[1]):(A=v,S=null);var w=function(k){if(!f(k))return String(k);for(var L="",M=0;M<k.length;M++){var P=k[M];typeof P=="number"?L=L.substr(0,L.length-1)+"["+P+"]":L+=P,M<k.length-1&&(L+=".")}return L}(b),E=s[y](v,w,x,T);return t.log(E),{code:y,container:A,trace:S,path:b,astr:w,msg:E}}function n(y,v){var b=p(v),x=b.keyMinusId,T=b.id;return!!(x in y&&y[x]._isSubplotObj&&T)||v in y}function a(y,v){return v in y?y[v]:y[p(v).keyMinusId]}var g=t.counterRegex("([a-z]+)");function p(y){var v=y.match(g);return{keyMinusId:v&&v[1],id:v&&v[2]}}},{"../lib":787,"../plots/plots":901,"./plot_config":825,"./plot_schema":826}],832:[function(r,I,B){I.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],833:[function(r,I,B){var t=r("../lib"),d=r("../plot_api/plot_template");I.exports=function(m,h,e){var f,l,o=e.name,u=e.inclusionAttr||"visible",s=h[o],i=t.isArrayOrTypedArray(m[o])?m[o]:[],c=h[o]=[],n=d.arrayTemplater(h,o,u);for(f=0;f<i.length;f++){var a=i[f];t.isPlainObject(a)?l=n.newItem(a):(l=n.newItem({}))[u]=!1,l._index=f,l[u]!==!1&&e.handleItemDefaults(a,l,h,e),c.push(l)}var g=n.defaultItems();for(f=0;f<g.length;f++)(l=g[f])._index=c.length,e.handleItemDefaults({},l,h,e,{}),c.push(l);if(t.isArrayOrTypedArray(s)){var p=Math.min(s.length,c.length);for(f=0;f<p;f++)t.relinkPrivateKeys(c[f],s[f])}return c}},{"../lib":787,"../plot_api/plot_template":827}],834:[function(r,I,B){var t=r("./font_attributes"),d=r("../components/fx/attributes");I.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:t({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:d.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":681,"./font_attributes":867}],835:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=d.dateTime2ms,h=d.incrementMonth,e=r("../../constants/numerical").ONEAVGMONTH;I.exports=function(f,l,o,u){if(l.type!=="date")return{vals:u};var s=f[o+"periodalignment"];if(!s)return{vals:u};var i,c=f[o+"period"];if(t(c)){if((c=+c)<=0)return{vals:u}}else if(typeof c=="string"&&c.charAt(0)==="M"){var n=+c.substring(1);if(!(n>0&&Math.round(n)===n))return{vals:u};i=n}for(var a=l.calendar,g=s==="start",p=s==="end",y=f[o+"period0"],v=m(y,a)||0,b=[],x=[],T=[],A=u.length,S=0;S<A;S++){var w,E,k,L=u[S];if(i){for(w=Math.round((L-v)/(i*e)),k=h(v,i*w,a);k>L;)k=h(k,-i,a);for(;k<=L;)k=h(k,i,a);E=h(k,-i,a)}else{for(k=v+(w=Math.round((L-v)/c))*c;k>L;)k-=c;for(;k<=L;)k+=c;E=k-c}b[S]=g?E:p?k:(E+k)/2,x[S]=E,T[S]=k}return{vals:b,starts:x,ends:T}}},{"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],836:[function(r,I,B){I.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],837:[function(r,I,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("../../lib"),h=r("../../constants/numerical").FP_SAFE,e=r("../../registry"),f=r("../../components/drawing"),l=r("./axis_ids"),o=l.getFromId,u=l.isLinked;function s(x,T){var A,S,w=[],E=x._fullLayout,k=c(E,T,0),L=c(E,T,1),M=n(x,T),P=M.min,D=M.max;if(P.length===0||D.length===0)return m.simpleMap(T.range,T.r2l);var N=P[0].val,U=D[0].val;for(A=1;A<P.length&&N===U;A++)N=Math.min(N,P[A].val);for(A=1;A<D.length&&N===U;A++)U=Math.max(U,D[A].val);var G=!1;if(T.range){var X=m.simpleMap(T.range,T.r2l);G=X[1]<X[0]}T.autorange==="reversed"&&(G=!0,T.autorange=!0);var K,Z,H,Y,$,z,j=T.rangemode,W=j==="tozero",ee=j==="nonnegative",J=T._length,Q=J/10,te=0;for(A=0;A<P.length;A++)for(K=P[A],S=0;S<D.length;S++)(z=(Z=D[S]).val-K.val-i(T,K.val,Z.val))>0&&(($=J-k(K)-L(Z))>Q?z/$>te&&(H=K,Y=Z,te=z/$):z/J>te&&(H={val:K.val,nopad:1},Y={val:Z.val,nopad:1},te=z/J));if(N===U){var ie=N-1,ae=N+1;if(W)if(N===0)w=[0,1];else{var he=(N>0?D:P).reduce(function(de,ue){return Math.max(de,L(ue))},0),se=N/(1-Math.min(.5,he/J));w=N>0?[0,se]:[se,0]}else w=ee?[Math.max(0,ie),Math.max(1,ae)]:[ie,ae]}else W?(H.val>=0&&(H={val:0,nopad:1}),Y.val<=0&&(Y={val:0,nopad:1})):ee&&(H.val-te*k(H)<0&&(H={val:0,nopad:1}),Y.val<=0&&(Y={val:1,nopad:1})),te=(Y.val-H.val-i(T,K.val,Z.val))/(J-k(H)-L(Y)),w=[H.val-te*k(H),Y.val+te*L(Y)];return G&&w.reverse(),m.simpleMap(w,T.l2r||Number)}function i(x,T,A){var S=0;if(x.rangebreaks)for(var w=x.locateBreaks(T,A),E=0;E<w.length;E++){var k=w[E];S+=k.max-k.min}return S}function c(x,T,A){var S=.05*T._length,w=T._anchorAxis||{};if((T.ticklabelposition||"").indexOf("inside")!==-1||(w.ticklabelposition||"").indexOf("inside")!==-1){var E=T.autorange==="reversed";if(!E){var k=m.simpleMap(T.range,T.r2l);E=k[1]<k[0]}E&&(A=!A)}var L=0;return u(x,T._id)||(L=function(M,P,D){var N=0,U=P._id.charAt(0)==="x";for(var G in M._plots){var X=M._plots[G];if(P._id===X.xaxis._id||P._id===X.yaxis._id){var K=(U?X.yaxis:X.xaxis)||{};if((K.ticklabelposition||"").indexOf("inside")!==-1&&(!D&&(K.side==="left"||K.side==="bottom")||D&&(K.side==="top"||K.side==="right"))){if(K._vals){var Z=m.deg2rad(K._tickAngles[K._id+"tick"]||0),H=Math.abs(Math.cos(Z)),Y=Math.abs(Math.sin(Z));if(!K._vals[0].bb){var $=K._id+"tick";K._selections[$].each(function(J){var Q=t.select(this);Q.select(".text-math-group").empty()&&(J.bb=f.bBox(Q.node()))})}for(var z=0;z<K._vals.length;z++){var j=K._vals[z].bb;if(j){var W=6+j.width,ee=6+j.height;N=Math.max(N,U?Math.max(W*H,ee*Y):Math.max(ee*H,W*Y))}}}K.ticks==="inside"&&K.ticklabelposition==="inside"&&(N+=K.ticklen||0)}}}return N}(x,T,A)),S=Math.max(L,S),T.constrain==="domain"&&T._inputDomain&&(S*=(T._inputDomain[1]-T._inputDomain[0])/(T.domain[1]-T.domain[0])),function(M){return M.nopad?0:M.pad+(M.extrapad?S:L)}}I.exports={getAutoRange:s,makePadFn:c,doAutoRange:function(x,T,A){if(T.setScale(),T.autorange){T.range=A?A.slice():s(x,T),T._r=T.range.slice(),T._rl=m.simpleMap(T._r,T.r2l);var S=T._input,w={};w[T._attr+".range"]=T.range,w[T._attr+".autorange"]=T.autorange,e.call("_storeDirectGUIEdit",x.layout,x._fullLayout._preGUI,w),S.range=T.range.slice(),S.autorange=T.autorange}var E=T._anchorAxis;if(E&&E.rangeslider){var k=E.rangeslider[T._name];k&&k.rangemode==="auto"&&(k.range=s(x,T)),E._input.rangeslider[T._name]=m.extendFlat({},k)}},findExtremes:function(x,T,A){A||(A={}),x._m||x.setScale();var S,w,E,k,L,M,P,D,N,U=[],G=[],X=T.length,K=A.padded||!1,Z=A.tozero&&(x.type==="linear"||x.type==="-"),H=x.type==="log",Y=!1,$=A.vpadLinearized||!1;function z(ae){if(Array.isArray(ae))return Y=!0,function(se){return Math.max(Number(ae[se]||0),0)};var he=Math.max(Number(ae||0),0);return function(){return he}}var j=z((x._m>0?A.ppadplus:A.ppadminus)||A.ppad||0),W=z((x._m>0?A.ppadminus:A.ppadplus)||A.ppad||0),ee=z(A.vpadplus||A.vpad),J=z(A.vpadminus||A.vpad);if(!Y){if(D=1/0,N=-1/0,H)for(S=0;S<X;S++)(w=T[S])<D&&w>0&&(D=w),w>N&&w<h&&(N=w);else for(S=0;S<X;S++)(w=T[S])<D&&w>-h&&(D=w),w>N&&w<h&&(N=w);T=[D,N],X=2}var Q={tozero:Z,extrapad:K};function te(ae){E=T[ae],d(E)&&(M=j(ae),P=W(ae),$?(k=x.c2l(E)-J(ae),L=x.c2l(E)+ee(ae)):(D=E-J(ae),N=E+ee(ae),H&&D<N/10&&(D=N/10),k=x.c2l(D),L=x.c2l(N)),Z&&(k=Math.min(0,k),L=Math.max(0,L)),y(k)&&a(U,k,P,Q),y(L)&&g(G,L,M,Q))}var ie=Math.min(6,X);for(S=0;S<ie;S++)te(S);for(S=X-1;S>=ie;S--)te(S);return{min:U,max:G,opts:A}},concatExtremes:n};function n(x,T,A){var S,w,E,k=T._id,L=x._fullData,M=x._fullLayout,P=[],D=[];function N(Z,H){for(S=0;S<H.length;S++){var Y=Z[H[S]],$=(Y._extremes||{})[k];if(Y.visible===!0&&$){for(w=0;w<$.min.length;w++)E=$.min[w],a(P,E.val,E.pad,{extrapad:E.extrapad});for(w=0;w<$.max.length;w++)E=$.max[w],g(D,E.val,E.pad,{extrapad:E.extrapad})}}}if(N(L,T._traceIndices),N(M.annotations||[],T._annIndices||[]),N(M.shapes||[],T._shapeIndices||[]),T._matchGroup&&!A){for(var U in T._matchGroup)if(U!==T._id){var G=o(x,U),X=n(x,G,!0),K=T._length/G._length;for(w=0;w<X.min.length;w++)E=X.min[w],a(P,E.val,E.pad*K,{extrapad:E.extrapad});for(w=0;w<X.max.length;w++)E=X.max[w],g(D,E.val,E.pad*K,{extrapad:E.extrapad})}}return{min:P,max:D}}function a(x,T,A,S){p(x,T,A,S,v)}function g(x,T,A,S){p(x,T,A,S,b)}function p(x,T,A,S,w){for(var E=S.tozero,k=S.extrapad,L=!0,M=0;M<x.length&&L;M++){var P=x[M];if(w(P.val,T)&&P.pad>=A&&(P.extrapad||!k)){L=!1;break}w(T,P.val)&&P.pad<=A&&(k||!P.extrapad)&&(x.splice(M,1),M--)}if(L){var D=E&&T===0;x.push({val:T,pad:D?0:A,extrapad:!D&&k})}}function y(x){return d(x)&&Math.abs(x)<h}function v(x,T){return x<=T}function b(x,T){return x>=T}},{"../../components/drawing":672,"../../constants/numerical":763,"../../lib":787,"../../registry":915,"./axis_ids":842,"@plotly/d3":58,"fast-isnumeric":246}],838:[function(r,I,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("../../plots/plots"),h=r("../../registry"),e=r("../../lib"),f=e.strTranslate,l=r("../../lib/svg_text_utils"),o=r("../../components/titles"),u=r("../../components/color"),s=r("../../components/drawing"),i=r("./layout_attributes"),c=r("./clean_ticks"),n=r("../../constants/numerical"),a=n.ONEMAXYEAR,g=n.ONEAVGYEAR,p=n.ONEMINYEAR,y=n.ONEMAXQUARTER,v=n.ONEAVGQUARTER,b=n.ONEMINQUARTER,x=n.ONEMAXMONTH,T=n.ONEAVGMONTH,A=n.ONEMINMONTH,S=n.ONEWEEK,w=n.ONEDAY,E=w/2,k=n.ONEHOUR,L=n.ONEMIN,M=n.ONESEC,P=n.MINUS_SIGN,D=n.BADNUM,N={K:"zeroline"},U={K:"gridline",L:"path"},G={K:"tick",L:"path"},X={K:"tick",L:"text"},K=r("../../constants/alignment"),Z=K.MID_SHIFT,H=K.CAP_SHIFT,Y=K.LINE_SPACING,$=K.OPPOSITE_SIDE,z=I.exports={};z.setConvert=r("./set_convert");var j=r("./axis_autotype"),W=r("./axis_ids"),ee=W.idSort,J=W.isLinked;z.id2name=W.id2name,z.name2id=W.name2id,z.cleanId=W.cleanId,z.list=W.list,z.listIds=W.listIds,z.getFromId=W.getFromId,z.getFromTrace=W.getFromTrace;var Q=r("./autorange");z.getAutoRange=Q.getAutoRange,z.findExtremes=Q.findExtremes;function te(Ue){var He=1e-4*(Ue[1]-Ue[0]);return[Ue[0]-He,Ue[1]+He]}z.coerceRef=function(Ue,He,Be,Ke,_e,Ce){var Le=Ke.charAt(Ke.length-1),Pe=Be._fullLayout._subplots[Le+"axis"],Xe=Ke+"ref",ht={};return _e||(_e=Pe[0]||(typeof Ce=="string"?Ce:Ce[0])),Ce||(Ce=_e),Pe=Pe.concat(Pe.map(function(Mt){return Mt+" domain"})),ht[Xe]={valType:"enumerated",values:Pe.concat(Ce?typeof Ce=="string"?[Ce]:Ce:[]),dflt:_e},e.coerce(Ue,He,ht,Xe)},z.getRefType=function(Ue){return Ue===void 0?Ue:Ue==="paper"?"paper":Ue==="pixel"?"pixel":/( domain)$/.test(Ue)?"domain":"range"},z.coercePosition=function(Ue,He,Be,Ke,_e,Ce){var Le,Pe;if(z.getRefType(Ke)!=="range")Le=e.ensureNumber,Pe=Be(_e,Ce);else{var Xe=z.getFromId(He,Ke);Pe=Be(_e,Ce=Xe.fraction2r(Ce)),Le=Xe.cleanPos}Ue[_e]=Le(Pe)},z.cleanPosition=function(Ue,He,Be){return(Be==="paper"||Be==="pixel"?e.ensureNumber:z.getFromId(He,Be).cleanPos)(Ue)},z.redrawComponents=function(Ue,He){He=He||z.listIds(Ue);var Be=Ue._fullLayout;function Ke(_e,Ce,Le,Pe){for(var Xe=h.getComponentMethod(_e,Ce),ht={},Mt=0;Mt<He.length;Mt++)for(var pt=Be[z.id2name(He[Mt])][Le],Lt=0;Lt<pt.length;Lt++){var vt=pt[Lt];if(!ht[vt]&&(Xe(Ue,vt),ht[vt]=1,Pe))return}}Ke("annotations","drawOne","_annIndices"),Ke("shapes","drawOne","_shapeIndices"),Ke("images","draw","_imgIndices",!0)};var ie=z.getDataConversions=function(Ue,He,Be,Ke){var _e,Ce=Be==="x"||Be==="y"||Be==="z"?Be:Ke;if(Array.isArray(Ce)){if(_e={type:j(Ke,void 0,{autotypenumbers:Ue._fullLayout.autotypenumbers}),_categories:[]},z.setConvert(_e),_e.type==="category")for(var Le=0;Le<Ke.length;Le++)_e.d2c(Ke[Le])}else _e=z.getFromTrace(Ue,He,Ce);return _e?{d2c:_e.d2c,c2d:_e.c2d}:Ce==="ids"?{d2c:he,c2d:he}:{d2c:ae,c2d:ae}};function ae(Ue){return+Ue}function he(Ue){return String(Ue)}function se(Ue){return+Ue.substring(1)}z.getDataToCoordFunc=function(Ue,He,Be,Ke){return ie(Ue,He,Be,Ke).d2c},z.counterLetter=function(Ue){var He=Ue.charAt(0);return He==="x"?"y":He==="y"?"x":void 0},z.minDtick=function(Ue,He,Be,Ke){["log","category","multicategory"].indexOf(Ue.type)===-1&&Ke?Ue._minDtick===void 0?(Ue._minDtick=He,Ue._forceTick0=Be):Ue._minDtick&&((Ue._minDtick/He+1e-6)%1<2e-6&&((Be-Ue._forceTick0)/He%1+1.000001)%1<2e-6?(Ue._minDtick=He,Ue._forceTick0=Be):((He/Ue._minDtick+1e-6)%1>2e-6||((Be-Ue._forceTick0)/Ue._minDtick%1+1.000001)%1>2e-6)&&(Ue._minDtick=0)):Ue._minDtick=0},z.saveRangeInitial=function(Ue,He){for(var Be=z.list(Ue,"",!0),Ke=!1,_e=0;_e<Be.length;_e++){var Ce=Be[_e],Le=Ce._rangeInitial===void 0,Pe=Le||!(Ce.range[0]===Ce._rangeInitial[0]&&Ce.range[1]===Ce._rangeInitial[1]);(Le&&Ce.autorange===!1||He&&Pe)&&(Ce._rangeInitial=Ce.range.slice(),Ke=!0)}return Ke},z.saveShowSpikeInitial=function(Ue,He){for(var Be=z.list(Ue,"",!0),Ke=!1,_e="on",Ce=0;Ce<Be.length;Ce++){var Le=Be[Ce],Pe=Le._showSpikeInitial===void 0,Xe=Pe||Le.showspikes!==Le._showspikes;(Pe||He&&Xe)&&(Le._showSpikeInitial=Le.showspikes,Ke=!0),_e!=="on"||Le.showspikes||(_e="off")}return Ue._fullLayout._cartesianSpikesEnabled=_e,Ke},z.autoBin=function(Ue,He,Be,Ke,_e,Ce){var Le,Pe=e.aggNums(Math.min,null,Ue),Xe=e.aggNums(Math.max,null,Ue);if(He.type==="category"||He.type==="multicategory")return{start:Pe-.5,end:Xe+.5,size:Math.max(1,Math.round(Ce)||1),_dataSpan:Xe-Pe};if(_e||(_e=He.calendar),Le=He.type==="log"?{type:"linear",range:[Pe,Xe]}:{type:He.type,range:e.simpleMap([Pe,Xe],He.c2r,0,_e),calendar:_e},z.setConvert(Le),Ce=Ce&&c.dtick(Ce,Le.type))Le.dtick=Ce,Le.tick0=c.tick0(void 0,Le.type,_e);else{var ht;if(Be)ht=(Xe-Pe)/Be;else{var Mt=e.distinctVals(Ue),pt=Math.pow(10,Math.floor(Math.log(Mt.minDiff)/Math.LN10)),Lt=pt*e.roundUp(Mt.minDiff/pt,[.9,1.9,4.9,9.9],!0);ht=Math.max(Lt,2*e.stdev(Ue)/Math.pow(Ue.length,Ke?.25:.4)),d(ht)||(ht=1)}z.autoTicks(Le,ht)}var vt,Dt=Le.dtick,xt=z.tickIncrement(z.tickFirst(Le),Dt,"reverse",_e);if(typeof Dt=="number")vt=(xt=function(it,St,Nt,Ut,Qt){var Ie=0,lt=0,wt=0,Ot=0;function Gt(or){return(1+100*(or-it)/Nt.dtick)%100<2}for(var ir=0;ir<St.length;ir++)St[ir]%1==0?wt++:d(St[ir])||Ot++,Gt(St[ir])&&Ie++,Gt(St[ir]+Nt.dtick/2)&&lt++;var Xt=St.length-Ot;if(wt===Xt&&Nt.type!=="date")Nt.dtick<1?it=Ut-.5*Nt.dtick:(it-=.5)+Nt.dtick<Ut&&(it+=Nt.dtick);else if(lt<.1*Xt&&(Ie>.3*Xt||Gt(Ut)||Gt(Qt))){var Kt=Nt.dtick/2;it+=it+Kt<Ut?Kt:-Kt}return it}(xt,Ue,Le,Pe,Xe))+(1+Math.floor((Xe-xt)/Dt))*Dt;else for(Le.dtick.charAt(0)==="M"&&(xt=function(it,St,Nt,Ut,Qt){var Ie=e.findExactDates(St,Qt);if(Ie.exactDays>.8){var lt=Number(Nt.substr(1));Ie.exactYears>.8&&lt%12==0?it=z.tickIncrement(it,"M6","reverse")+1.5*w:Ie.exactMonths>.8?it=z.tickIncrement(it,"M1","reverse")+15.5*w:it-=E;var wt=z.tickIncrement(it,Nt);if(wt<=Ut)return wt}return it}(xt,Ue,Dt,Pe,_e)),vt=xt,0;vt<=Xe;)vt=z.tickIncrement(vt,Dt,!1,_e);return{start:He.c2r(xt,0,_e),end:He.c2r(vt,0,_e),size:Dt,_dataSpan:Xe-Pe}},z.prepTicks=function(Ue,He){var Be=e.simpleMap(Ue.range,Ue.r2l,void 0,void 0,He);if(Ue._dtickInit=Ue.dtick,Ue._tick0Init=Ue.tick0,Ue.tickmode==="auto"||!Ue.dtick){var Ke,_e=Ue.nticks;_e||(Ue.type==="category"||Ue.type==="multicategory"?(Ke=Ue.tickfont?e.bigFont(Ue.tickfont.size||12):15,_e=Ue._length/Ke):(Ke=Ue._id.charAt(0)==="y"?40:80,_e=e.constrain(Ue._length/Ke,4,9)+1),Ue._name==="radialaxis"&&(_e*=2)),Ue.tickmode==="array"&&(_e*=100),Ue._roughDTick=Math.abs(Be[1]-Be[0])/_e,z.autoTicks(Ue,Ue._roughDTick),Ue._minDtick>0&&Ue.dtick<2*Ue._minDtick&&(Ue.dtick=Ue._minDtick,Ue.tick0=Ue.l2r(Ue._forceTick0))}Ue.ticklabelmode==="period"&&function(Ce){var Le;function Pe(){return!(d(Ce.dtick)||Ce.dtick.charAt(0)!=="M")}var Xe=Pe(),ht=z.getTickFormat(Ce);if(ht){var Mt=Ce._dtickInit!==Ce.dtick;/%[fLQsSMX]/.test(ht)||(/%[HI]/.test(ht)?(Le=k,Mt&&!Xe&&Ce.dtick<k&&(Ce.dtick=k)):/%p/.test(ht)?(Le=E,Mt&&!Xe&&Ce.dtick<E&&(Ce.dtick=E)):/%[Aadejuwx]/.test(ht)?(Le=w,Mt&&!Xe&&Ce.dtick<w&&(Ce.dtick=w)):/%[UVW]/.test(ht)?(Le=S,Mt&&!Xe&&Ce.dtick<S&&(Ce.dtick=S)):/%[Bbm]/.test(ht)?(Le=T,Mt&&(Xe?se(Ce.dtick)<1:Ce.dtick<A)&&(Ce.dtick="M1")):/%[q]/.test(ht)?(Le=v,Mt&&(Xe?se(Ce.dtick)<3:Ce.dtick<b)&&(Ce.dtick="M3")):/%[Yy]/.test(ht)&&(Le=g,Mt&&(Xe?se(Ce.dtick)<12:Ce.dtick<p)&&(Ce.dtick="M12")))}(Xe=Pe())&&Ce.tick0===Ce._dowTick0&&(Ce.tick0=Ce._rawTick0),Ce._definedDelta=Le}(Ue),Ue.tick0||(Ue.tick0=Ue.type==="date"?"2000-01-01":0),Ue.type==="date"&&Ue.dtick<.1&&(Ue.dtick=.1),ge(Ue)},z.calcTicks=function(Ue,He){z.prepTicks(Ue,He);var Be=e.simpleMap(Ue.range,Ue.r2l,void 0,void 0,He);if(Ue.tickmode==="array")return function(ir){var Xt=ir.tickvals,Kt=ir.ticktext,or=new Array(Xt.length),dr=te(e.simpleMap(ir.range,ir.r2l)),vr=Math.min(dr[0],dr[1]),ur=Math.max(dr[0],dr[1]),pr=0;Array.isArray(Kt)||(Kt=[]);var br=ir.type==="category"?ir.d2l_noadd:ir.d2l;ir.type==="log"&&String(ir.dtick).charAt(0)!=="L"&&(ir.dtick="L"+Math.pow(10,Math.floor(Math.min(ir.range[0],ir.range[1]))-1));for(var Rr=0;Rr<Xt.length;Rr++){var _r=br(Xt[Rr]);_r>vr&&_r<ur&&(Kt[Rr]===void 0?or[pr]=z.tickText(ir,_r):or[pr]=we(ir,_r,String(Kt[Rr])),pr++)}return pr<Xt.length&&or.splice(pr,Xt.length-pr),ir.rangebreaks&&(or=or.filter(function(jr){return ir.maskBreaks(jr.x)!==D})),or}(Ue);var Ke=te(Be),_e=Ke[0],Ce=Ke[1],Le=Be[1]<Be[0],Pe=Math.min(Be[0],Be[1]),Xe=Math.max(Be[0],Be[1]),ht=Ue.type==="log"&&!(d(Ue.dtick)||Ue.dtick.charAt(0)==="L"),Mt=Ue.ticklabelmode==="period";if(Ue._tmin=z.tickFirst(Ue,He),Ue._tmin<_e!==Le)return[];Ue.type!=="category"&&Ue.type!=="multicategory"||(Ce=Le?Math.max(-.5,Ce):Math.min(Ue._categories.length-.5,Ce));var pt=Ue._tmin;Ue.rangebreaks&&Ue._tick0Init!==Ue.tick0&&(pt=_t(pt,Ue),Le||(pt=z.tickIncrement(pt,Ue.dtick,!Le,Ue.calendar))),Mt&&(pt=z.tickIncrement(pt,Ue.dtick,!Le,Ue.calendar));for(var Lt,vt=Math.max(1e3,Ue._length||0),Dt=[],xt=null;Le?pt>=Ce:pt<=Ce;pt=z.tickIncrement(pt,Ue.dtick,Le,Ue.calendar)){if(Ue.rangebreaks&&!Le){if(pt<_e)continue;if(Ue.maskBreaks(pt)===D&&_t(pt,Ue)>=Xe)break}if(Dt.length>vt||pt===xt)break;xt=pt;var it=!1;ht&&pt!==(0|pt)&&(it=!0),Dt.push({minor:it,value:pt})}if(Mt&&function(ir,Xt,Kt){for(var or=0;or<ir.length;or++){var dr=ir[or].value,vr=or,ur=or+1;or<ir.length-1?(vr=or,ur=or+1):or>0?(vr=or-1,ur=or):(vr=or,ur=or);var pr,br=ir[vr].value,Rr=ir[ur].value,_r=Math.abs(Rr-br),jr=Kt||_r,$r=0;jr>=p?$r=_r>=p&&_r<=a?_r:g:Kt===v&&jr>=b?$r=_r>=b&&_r<=y?_r:v:jr>=A?$r=_r>=A&&_r<=x?_r:T:Kt===S&&jr>=S?$r=S:jr>=w?$r=w:Kt===E&&jr>=E?$r=E:Kt===k&&jr>=k&&($r=k),$r>=_r&&($r=_r,pr=!0);var pn=dr+$r;if(Xt.rangebreaks&&$r>0){for(var In=0,On=0;On<84;On++){var Sn=(On+.5)/84;Xt.maskBreaks(dr*(1-Sn)+Sn*pn)!==D&&In++}($r*=In/84)||(ir[or].drop=!0),pr&&_r>S&&($r=_r)}($r>0||or===0)&&(ir[or].periodX=dr+$r/2)}}(Dt,Ue,Ue._definedDelta),Ue.rangebreaks){var St=Ue._id.charAt(0)==="y",Nt=1;Ue.tickmode==="auto"&&(Nt=Ue.tickfont?Ue.tickfont.size:12);var Ut=NaN;for(Lt=Dt.length-1;Lt>-1;Lt--)if(Dt[Lt].drop)Dt.splice(Lt,1);else{Dt[Lt].value=_t(Dt[Lt].value,Ue);var Qt=Ue.c2p(Dt[Lt].value);(St?Ut>Qt-Nt:Ut<Qt+Nt)?Dt.splice(Le?Lt+1:Lt,1):Ut=Qt}}tt(Ue)&&Math.abs(Be[1]-Be[0])===360&&Dt.pop(),Ue._tmax=(Dt[Dt.length-1]||{}).value,Ue._prevDateHead="",Ue._inCalcTicks=!0;var Ie,lt,wt=[];for(Lt=0;Lt<Dt.length;Lt++){var Ot=Dt[Lt].minor,Gt=Dt[Lt].value;Ie=z.tickText(Ue,Gt,!1,Ot),(lt=Dt[Lt].periodX)!==void 0&&(Ie.periodX=lt,(lt>Xe||lt<Pe)&&(lt>Xe&&(Ie.periodX=Xe),lt<Pe&&(Ie.periodX=Pe),Ie.text=" ",Ue._prevDateHead="")),wt.push(Ie)}return Ue._inCalcTicks=!1,wt};var de=[2,5,10],ue=[1,2,3,6,12],ve=[1,2,5,10,15,30],ke=[1,2,3,7,14],Ee=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],be=[-.301,0,.301,.699,1],xe=[15,30,45,90,180];function ce(Ue,He,Be){return He*e.roundUp(Ue/He,Be)}function ge(Ue){var He=Ue.dtick;if(Ue._tickexponent=0,d(He)||typeof He=="string"||(He=1),Ue.type!=="category"&&Ue.type!=="multicategory"||(Ue._tickround=null),Ue.type==="date"){var Be=Ue.r2l(Ue.tick0),Ke=Ue.l2r(Be).replace(/(^-|i)/g,""),_e=Ke.length;if(String(He).charAt(0)==="M")_e>10||Ke.substr(5)!=="01-01"?Ue._tickround="d":Ue._tickround=+He.substr(1)%12==0?"y":"m";else if(He>=w&&_e<=10||He>=15*w)Ue._tickround="d";else if(He>=L&&_e<=16||He>=k)Ue._tickround="M";else if(He>=M&&_e<=19||He>=L)Ue._tickround="S";else{var Ce=Ue.l2r(Be+He).replace(/^-/,"").length;Ue._tickround=Math.max(_e,Ce)-20,Ue._tickround<0&&(Ue._tickround=4)}}else if(d(He)||He.charAt(0)==="L"){var Le=Ue.range.map(Ue.r2d||Number);d(He)||(He=Number(He.substr(1))),Ue._tickround=2-Math.floor(Math.log(He)/Math.LN10+.01);var Pe=Math.max(Math.abs(Le[0]),Math.abs(Le[1])),Xe=Math.floor(Math.log(Pe)/Math.LN10+.01),ht=Ue.minexponent===void 0?3:Ue.minexponent;Math.abs(Xe)>ht&&(Se(Ue.exponentformat)&&!ze(Xe)?Ue._tickexponent=3*Math.round((Xe-1)/3):Ue._tickexponent=Xe)}else Ue._tickround=null}function we(Ue,He,Be){var Ke=Ue.tickfont||{};return{x:He,dx:0,dy:0,text:Be||"",fontSize:Ke.size,font:Ke.family,fontColor:Ke.color}}z.autoTicks=function(Ue,He){var Be;function Ke(Mt){return Math.pow(Mt,Math.floor(Math.log(He)/Math.LN10))}if(Ue.type==="date"){Ue.tick0=e.dateTick0(Ue.calendar,0);var _e=2*He;if(_e>g)He/=g,Be=Ke(10),Ue.dtick="M"+12*ce(He,Be,de);else if(_e>T)He/=T,Ue.dtick="M"+ce(He,1,ue);else if(_e>w){Ue.dtick=ce(He,w,Ue._hasDayOfWeekBreaks?[1,2,7,14]:ke);var Ce=z.getTickFormat(Ue),Le=Ue.ticklabelmode==="period";Le&&(Ue._rawTick0=Ue.tick0),/%[uVW]/.test(Ce)?Ue.tick0=e.dateTick0(Ue.calendar,2):Ue.tick0=e.dateTick0(Ue.calendar,1),Le&&(Ue._dowTick0=Ue.tick0)}else _e>k?Ue.dtick=ce(He,k,ue):_e>L?Ue.dtick=ce(He,L,ve):_e>M?Ue.dtick=ce(He,M,ve):(Be=Ke(10),Ue.dtick=ce(He,Be,de))}else if(Ue.type==="log"){Ue.tick0=0;var Pe=e.simpleMap(Ue.range,Ue.r2l);if(He>.7)Ue.dtick=Math.ceil(He);else if(Math.abs(Pe[1]-Pe[0])<1){var Xe=1.5*Math.abs((Pe[1]-Pe[0])/He);He=Math.abs(Math.pow(10,Pe[1])-Math.pow(10,Pe[0]))/Xe,Be=Ke(10),Ue.dtick="L"+ce(He,Be,de)}else Ue.dtick=He>.3?"D2":"D1"}else Ue.type==="category"||Ue.type==="multicategory"?(Ue.tick0=0,Ue.dtick=Math.ceil(Math.max(He,1))):tt(Ue)?(Ue.tick0=0,Be=1,Ue.dtick=ce(He,Be,xe)):(Ue.tick0=0,Be=Ke(10),Ue.dtick=ce(He,Be,de));if(Ue.dtick===0&&(Ue.dtick=1),!d(Ue.dtick)&&typeof Ue.dtick!="string"){var ht=Ue.dtick;throw Ue.dtick=1,"ax.dtick error: "+String(ht)}},z.tickIncrement=function(Ue,He,Be,Ke){var _e=Be?-1:1;if(d(He))return e.increment(Ue,_e*He);var Ce=He.charAt(0),Le=_e*Number(He.substr(1));if(Ce==="M")return e.incrementMonth(Ue,Le,Ke);if(Ce==="L")return Math.log(Math.pow(10,Ue)+Le)/Math.LN10;if(Ce==="D"){var Pe=He==="D2"?be:Ee,Xe=Ue+.01*_e,ht=e.roundUp(e.mod(Xe,1),Pe,Be);return Math.floor(Xe)+Math.log(t.round(Math.pow(10,ht),1))/Math.LN10}throw"unrecognized dtick "+String(He)},z.tickFirst=function(Ue,He){var Be=Ue.r2l||Number,Ke=e.simpleMap(Ue.range,Be,void 0,void 0,He),_e=Ke[1]<Ke[0],Ce=_e?Math.floor:Math.ceil,Le=te(Ke)[0],Pe=Ue.dtick,Xe=Be(Ue.tick0);if(d(Pe)){var ht=Ce((Le-Xe)/Pe)*Pe+Xe;return Ue.type!=="category"&&Ue.type!=="multicategory"||(ht=e.constrain(ht,0,Ue._categories.length-1)),ht}var Mt=Pe.charAt(0),pt=Number(Pe.substr(1));if(Mt==="M"){for(var Lt,vt,Dt,xt=0,it=Xe;xt<10;){if(((Lt=z.tickIncrement(it,Pe,_e,Ue.calendar))-Le)*(it-Le)<=0)return _e?Math.min(it,Lt):Math.max(it,Lt);vt=(Le-(it+Lt)/2)/(Lt-it),Dt=Mt+(Math.abs(Math.round(vt))||1)*pt,it=z.tickIncrement(it,Dt,vt<0?!_e:_e,Ue.calendar),xt++}return e.error("tickFirst did not converge",Ue),it}if(Mt==="L")return Math.log(Ce((Math.pow(10,Le)-Xe)/pt)*pt+Xe)/Math.LN10;if(Mt==="D"){var St=Pe==="D2"?be:Ee,Nt=e.roundUp(e.mod(Le,1),St,_e);return Math.floor(Le)+Math.log(t.round(Math.pow(10,Nt),1))/Math.LN10}throw"unrecognized dtick "+String(Pe)},z.tickText=function(Ue,He,Be,Ke){var _e,Ce=we(Ue,He),Le=Ue.tickmode==="array",Pe=Be||Le,Xe=Ue.type,ht=Xe==="category"?Ue.d2l_noadd:Ue.d2l;if(Le&&Array.isArray(Ue.ticktext)){var Mt=e.simpleMap(Ue.range,Ue.r2l),pt=(Math.abs(Mt[1]-Mt[0])-(Ue._lBreaks||0))/1e4;for(_e=0;_e<Ue.ticktext.length&&!(Math.abs(He-ht(Ue.tickvals[_e]))<pt);_e++);if(_e<Ue.ticktext.length)return Ce.text=String(Ue.ticktext[_e]),Ce}function Lt(xt){if(xt===void 0)return!0;if(Be)return xt==="none";var it={first:Ue._tmin,last:Ue._tmax}[xt];return xt!=="all"&&He!==it}var vt=Be?"never":Ue.exponentformat!=="none"&&Lt(Ue.showexponent)?"hide":"";if(Xe==="date"?function(xt,it,St,Nt){var Ut=xt._tickround,Qt=St&&xt.hoverformat||z.getTickFormat(xt);Nt&&(Ut=d(Ut)?4:{y:"m",m:"d",d:"M",M:"S",S:4}[Ut]);var Ie,lt=e.formatDate(it.x,Qt,Ut,xt._dateFormat,xt.calendar,xt._extraFormat),wt=lt.indexOf(`
`);if(wt!==-1&&(Ie=lt.substr(wt+1),lt=lt.substr(0,wt)),Nt&&(lt==="00:00:00"||lt==="00:00"?(lt=Ie,Ie=""):lt.length===8&&(lt=lt.replace(/:00$/,""))),Ie)if(St)Ut==="d"?lt+=", "+Ie:lt=Ie+(lt?", "+lt:"");else if(xt._inCalcTicks&&xt._prevDateHead===Ie){var Ot=er(xt),Gt=xt._realSide||xt.side;(!Ot&&Gt==="top"||Ot&&Gt==="bottom")&&(lt+="<br> ")}else xt._prevDateHead=Ie,lt+="<br>"+Ie;it.text=lt}(Ue,Ce,Be,Pe):Xe==="log"?function(xt,it,St,Nt,Ut){var Qt=xt.dtick,Ie=it.x,lt=xt.tickformat,wt=typeof Qt=="string"&&Qt.charAt(0);if(Ut==="never"&&(Ut=""),Nt&&wt!=="L"&&(Qt="L3",wt="L"),lt||wt==="L")it.text=Fe(Math.pow(10,Ie),xt,Ut,Nt);else if(d(Qt)||wt==="D"&&e.mod(Ie+.01,1)<.1){var Ot=Math.round(Ie),Gt=Math.abs(Ot),ir=xt.exponentformat;ir==="power"||Se(ir)&&ze(Ot)?(it.text=Ot===0?1:Ot===1?"10":"10<sup>"+(Ot>1?"":P)+Gt+"</sup>",it.fontSize*=1.25):(ir==="e"||ir==="E")&&Gt>2?it.text="1"+ir+(Ot>0?"+":P)+Gt:(it.text=Fe(Math.pow(10,Ie),xt,"","fakehover"),Qt==="D1"&&xt._id.charAt(0)==="y"&&(it.dy-=it.fontSize/6))}else{if(wt!=="D")throw"unrecognized dtick "+String(Qt);it.text=String(Math.round(Math.pow(10,e.mod(Ie,1)))),it.fontSize*=.75}if(xt.dtick==="D1"){var Xt=String(it.text).charAt(0);Xt!=="0"&&Xt!=="1"||(xt._id.charAt(0)==="y"?it.dx-=it.fontSize/4:(it.dy+=it.fontSize/2,it.dx+=(xt.range[1]>xt.range[0]?1:-1)*it.fontSize*(Ie<0?.5:.25)))}}(Ue,Ce,0,Pe,vt):Xe==="category"?function(xt,it){var St=xt._categories[Math.round(it.x)];St===void 0&&(St=""),it.text=String(St)}(Ue,Ce):Xe==="multicategory"?function(xt,it,St){var Nt=Math.round(it.x),Ut=xt._categories[Nt]||[],Qt=Ut[1]===void 0?"":String(Ut[1]),Ie=Ut[0]===void 0?"":String(Ut[0]);St?it.text=Ie+" - "+Qt:(it.text=Qt,it.text2=Ie)}(Ue,Ce,Be):tt(Ue)?function(xt,it,St,Nt,Ut){if(xt.thetaunit!=="radians"||St)it.text=Fe(it.x,xt,Ut,Nt);else{var Qt=it.x/180;if(Qt===0)it.text="0";else{var Ie=function(wt){function Ot(Kt,or){return Math.abs(Kt-or)<=1e-6}var Gt=function(Kt){for(var or=1;!Ot(Math.round(Kt*or)/or,Kt);)or*=10;return or}(wt),ir=wt*Gt,Xt=Math.abs(function Kt(or,dr){return Ot(dr,0)?or:Kt(dr,or%dr)}(ir,Gt));return[Math.round(ir/Xt),Math.round(Gt/Xt)]}(Qt);if(Ie[1]>=100)it.text=Fe(e.deg2rad(it.x),xt,Ut,Nt);else{var lt=it.x<0;Ie[1]===1?Ie[0]===1?it.text="\u03C0":it.text=Ie[0]+"\u03C0":it.text=["<sup>",Ie[0],"</sup>","\u2044","<sub>",Ie[1],"</sub>","\u03C0"].join(""),lt&&(it.text=P+it.text)}}}}(Ue,Ce,Be,Pe,vt):function(xt,it,St,Nt,Ut){Ut==="never"?Ut="":xt.showexponent==="all"&&Math.abs(it.x/xt.dtick)<1e-6&&(Ut="hide"),it.text=Fe(it.x,xt,Ut,Nt)}(Ue,Ce,0,Pe,vt),Ke||(Ue.tickprefix&&!Lt(Ue.showtickprefix)&&(Ce.text=Ue.tickprefix+Ce.text),Ue.ticksuffix&&!Lt(Ue.showticksuffix)&&(Ce.text+=Ue.ticksuffix)),Ue.tickson==="boundaries"||Ue.showdividers){var Dt=function(xt){var it=Ue.l2p(xt);return it>=0&&it<=Ue._length?xt:null};Ce.xbnd=[Dt(Ce.x-.5),Dt(Ce.x+Ue.dtick-.5)]}return Ce},z.hoverLabelText=function(Ue,He,Be){Be&&(Ue=e.extendFlat({},Ue,{hoverformat:Be}));var Ke=Array.isArray(He)?He[0]:He,_e=Array.isArray(He)?He[1]:void 0;if(_e!==void 0&&_e!==Ke)return z.hoverLabelText(Ue,Ke,Be)+" - "+z.hoverLabelText(Ue,_e,Be);var Ce=Ue.type==="log"&&Ke<=0,Le=z.tickText(Ue,Ue.c2l(Ce?-Ke:Ke),"hover").text;return Ce?Ke===0?"0":P+Le:Le};var Me=["f","p","n","\u03BC","m","","k","M","G","T"];function Se(Ue){return Ue==="SI"||Ue==="B"}function ze(Ue){return Ue>14||Ue<-15}function Fe(Ue,He,Be,Ke){var _e=Ue<0,Ce=He._tickround,Le=Be||He.exponentformat||"B",Pe=He._tickexponent,Xe=z.getTickFormat(He),ht=He.separatethousands;if(Ke){var Mt={exponentformat:Le,minexponent:He.minexponent,dtick:He.showexponent==="none"?He.dtick:d(Ue)&&Math.abs(Ue)||1,range:He.showexponent==="none"?He.range.map(He.r2d):[0,Ue||1]};ge(Mt),Ce=(Number(Mt._tickround)||0)+4,Pe=Mt._tickexponent,He.hoverformat&&(Xe=He.hoverformat)}if(Xe)return He._numFormat(Xe)(Ue).replace(/-/g,P);var pt,Lt=Math.pow(10,-Ce)/2;if(Le==="none"&&(Pe=0),(Ue=Math.abs(Ue))<Lt)Ue="0",_e=!1;else{if(Ue+=Lt,Pe&&(Ue*=Math.pow(10,-Pe),Ce+=Pe),Ce===0)Ue=String(Math.floor(Ue));else if(Ce<0){Ue=(Ue=String(Math.round(Ue))).substr(0,Ue.length+Ce);for(var vt=Ce;vt<0;vt++)Ue+="0"}else{var Dt=(Ue=String(Ue)).indexOf(".")+1;Dt&&(Ue=Ue.substr(0,Dt+Ce).replace(/\.?0+$/,""))}Ue=e.numSeparate(Ue,He._separators,ht)}return Pe&&Le!=="hide"&&(Se(Le)&&ze(Pe)&&(Le="power"),pt=Pe<0?P+-Pe:Le!=="power"?"+"+Pe:String(Pe),Le==="e"||Le==="E"?Ue+=Le+pt:Le==="power"?Ue+="\xD710<sup>"+pt+"</sup>":Le==="B"&&Pe===9?Ue+="B":Se(Le)&&(Ue+=Me[Pe/3+5])),_e?P+Ue:Ue}function Ye(Ue,He){for(var Be=[],Ke={},_e=0;_e<He.length;_e++){var Ce=He[_e];Ke[Ce.text2]?Ke[Ce.text2].push(Ce.x):Ke[Ce.text2]=[Ce.x]}for(var Le in Ke)Be.push(we(Ue,e.interp(Ke[Le],.5),Le));return Be}function rt(Ue){return Ue.periodX!==void 0?Ue.periodX:Ue.x}function Oe(Ue){return[Ue.text,Ue.x,Ue.axInfo,Ue.font,Ue.fontSize,Ue.fontColor].join("_")}function je(Ue){var He=Ue.title.font.size,Be=(Ue.title.text.match(l.BR_TAG_ALL)||[]).length;return Ue.title.hasOwnProperty("standoff")?Be?He*(H+Be*Y):He*H:Be?He*(Be+1)*Y:He}function We(Ue,He){var Be=Ue.l2p(He);return Be>1&&Be<Ue._length-1}function qe(Ue){var He=t.select(Ue),Be=He.select(".text-math-group");return Be.empty()?He.select("text"):Be}function et(Ue){return Ue._id+".automargin"}function st(Ue){return et(Ue)+".mirror"}function ct(Ue){return Ue._id+".rangeslider"}function Pt(Ue,He){for(var Be=0;Be<He.length;Be++)Ue.indexOf(He[Be])===-1&&Ue.push(He[Be])}function kt(Ue,He,Be){var Ke,_e,Ce=[],Le=[],Pe=Ue.layout;for(Ke=0;Ke<He.length;Ke++)Ce.push(z.getFromId(Ue,He[Ke]));for(Ke=0;Ke<Be.length;Ke++)Le.push(z.getFromId(Ue,Be[Ke]));var Xe=Object.keys(i),ht=["anchor","domain","overlaying","position","side","tickangle","editType"],Mt=["linear","log"];for(Ke=0;Ke<Xe.length;Ke++){var pt=Xe[Ke],Lt=Ce[0][pt],vt=Le[0][pt],Dt=!0,xt=!1,it=!1;if(pt.charAt(0)!=="_"&&typeof Lt!="function"&&ht.indexOf(pt)===-1){for(_e=1;_e<Ce.length&&Dt;_e++){var St=Ce[_e][pt];pt==="type"&&Mt.indexOf(Lt)!==-1&&Mt.indexOf(St)!==-1&&Lt!==St?xt=!0:St!==Lt&&(Dt=!1)}for(_e=1;_e<Le.length&&Dt;_e++){var Nt=Le[_e][pt];pt==="type"&&Mt.indexOf(vt)!==-1&&Mt.indexOf(Nt)!==-1&&vt!==Nt?it=!0:Le[_e][pt]!==vt&&(Dt=!1)}Dt&&(xt&&(Pe[Ce[0]._name].type="linear"),it&&(Pe[Le[0]._name].type="linear"),at(Pe,pt,Ce,Le,Ue._fullLayout._dfltTitle))}}for(Ke=0;Ke<Ue._fullLayout.annotations.length;Ke++){var Ut=Ue._fullLayout.annotations[Ke];He.indexOf(Ut.xref)!==-1&&Be.indexOf(Ut.yref)!==-1&&e.swapAttrs(Pe.annotations[Ke],["?"])}}function at(Ue,He,Be,Ke,_e){var Ce,Le=e.nestedProperty,Pe=Le(Ue[Be[0]._name],He).get(),Xe=Le(Ue[Ke[0]._name],He).get();for(He==="title"&&(Pe&&Pe.text===_e.x&&(Pe.text=_e.y),Xe&&Xe.text===_e.y&&(Xe.text=_e.x)),Ce=0;Ce<Be.length;Ce++)Le(Ue,Be[Ce]._name+"."+He).set(Xe);for(Ce=0;Ce<Ke.length;Ce++)Le(Ue,Ke[Ce]._name+"."+He).set(Pe)}function tt(Ue){return Ue._id==="angularaxis"}function _t(Ue,He){for(var Be=He._rangebreaks.length,Ke=0;Ke<Be;Ke++){var _e=He._rangebreaks[Ke];if(Ue>=_e.min&&Ue<_e.max)return _e.max}return Ue}function er(Ue){return(Ue.ticklabelposition||"").indexOf("inside")!==-1}function tr(Ue,He){er(Ue._anchorAxis||{})&&Ue._hideCounterAxisInsideTickLabels&&Ue._hideCounterAxisInsideTickLabels(He)}z.getTickFormat=function(Ue){var He,Be,Ke,_e,Ce,Le,Pe,Xe;function ht(Lt){return typeof Lt!="string"?Lt:Number(Lt.replace("M",""))*T}function Mt(Lt,vt){var Dt=["L","D"];if(typeof Lt==typeof vt){if(typeof Lt=="number")return Lt-vt;var xt=Dt.indexOf(Lt.charAt(0)),it=Dt.indexOf(vt.charAt(0));return xt===it?Number(Lt.replace(/(L|D)/g,""))-Number(vt.replace(/(L|D)/g,"")):xt-it}return typeof Lt=="number"?1:-1}function pt(Lt,vt){var Dt=vt[0]===null,xt=vt[1]===null,it=Mt(Lt,vt[0])>=0,St=Mt(Lt,vt[1])<=0;return(Dt||it)&&(xt||St)}if(Ue.tickformatstops&&Ue.tickformatstops.length>0)switch(Ue.type){case"date":case"linear":for(He=0;He<Ue.tickformatstops.length;He++)if((Ke=Ue.tickformatstops[He]).enabled&&(_e=Ue.dtick,Ce=Ke.dtickrange,Le=void 0,Pe=void 0,Xe=void 0,Le=ht||function(Lt){return Lt},Pe=Ce[0],Xe=Ce[1],(!Pe&&typeof Pe!="number"||Le(Pe)<=Le(_e))&&(!Xe&&typeof Xe!="number"||Le(Xe)>=Le(_e)))){Be=Ke;break}break;case"log":for(He=0;He<Ue.tickformatstops.length;He++)if((Ke=Ue.tickformatstops[He]).enabled&&pt(Ue.dtick,Ke.dtickrange)){Be=Ke;break}}return Be?Be.value:Ue.tickformat},z.getSubplots=function(Ue,He){var Be=Ue._fullLayout._subplots,Ke=Be.cartesian.concat(Be.gl2d||[]),_e=He?z.findSubplotsWithAxis(Ke,He):Ke;return _e.sort(function(Ce,Le){var Pe=Ce.substr(1).split("y"),Xe=Le.substr(1).split("y");return Pe[0]===Xe[0]?+Pe[1]-+Xe[1]:+Pe[0]-+Xe[0]}),_e},z.findSubplotsWithAxis=function(Ue,He){for(var Be=new RegExp(He._id.charAt(0)==="x"?"^"+He._id+"y":He._id+"$"),Ke=[],_e=0;_e<Ue.length;_e++){var Ce=Ue[_e];Be.test(Ce)&&Ke.push(Ce)}return Ke},z.makeClipPaths=function(Ue){var He=Ue._fullLayout;if(!He._hasOnlyLargeSploms){var Be,Ke,_e={_offset:0,_length:He.width,_id:""},Ce={_offset:0,_length:He.height,_id:""},Le=z.list(Ue,"x",!0),Pe=z.list(Ue,"y",!0),Xe=[];for(Be=0;Be<Le.length;Be++)for(Xe.push({x:Le[Be],y:Ce}),Ke=0;Ke<Pe.length;Ke++)Be===0&&Xe.push({x:_e,y:Pe[Ke]}),Xe.push({x:Le[Be],y:Pe[Ke]});var ht=He._clips.selectAll(".axesclip").data(Xe,function(Mt){return Mt.x._id+Mt.y._id});ht.enter().append("clipPath").classed("axesclip",!0).attr("id",function(Mt){return"clip"+He._uid+Mt.x._id+Mt.y._id}).append("rect"),ht.exit().remove(),ht.each(function(Mt){t.select(this).select("rect").attr({x:Mt.x._offset||0,y:Mt.y._offset||0,width:Mt.x._length||1,height:Mt.y._length||1})})}},z.draw=function(Ue,He,Be){var Ke=Ue._fullLayout;He==="redraw"&&Ke._paper.selectAll("g.subplot").each(function(Ce){var Le=Ce[0],Pe=Ke._plots[Le];if(Pe){var Xe=Pe.xaxis,ht=Pe.yaxis;Pe.xaxislayer.selectAll("."+Xe._id+"tick").remove(),Pe.yaxislayer.selectAll("."+ht._id+"tick").remove(),Pe.xaxislayer.selectAll("."+Xe._id+"tick2").remove(),Pe.yaxislayer.selectAll("."+ht._id+"tick2").remove(),Pe.xaxislayer.selectAll("."+Xe._id+"divider").remove(),Pe.yaxislayer.selectAll("."+ht._id+"divider").remove(),Pe.gridlayer&&Pe.gridlayer.selectAll("path").remove(),Pe.zerolinelayer&&Pe.zerolinelayer.selectAll("path").remove(),Ke._infolayer.select(".g-"+Xe._id+"title").remove(),Ke._infolayer.select(".g-"+ht._id+"title").remove()}});var _e=He&&He!=="redraw"?He:z.listIds(Ue);return e.syncOrAsync(_e.map(function(Ce){return function(){if(Ce){var Le=z.getFromId(Ue,Ce),Pe=z.drawOne(Ue,Le,Be);return Le._r=Le.range.slice(),Le._rl=e.simpleMap(Le._r,Le.r2l),Pe}}}))},z.drawOne=function(Ue,He,Be){var Ke,_e,Ce;Be=Be||{},He.setScale();var Le=Ue._fullLayout,Pe=He._id,Xe=Pe.charAt(0),ht=z.counterLetter(Pe),Mt=Le._plots[He._mainSubplot];if(Mt){var pt=Mt[Xe+"axislayer"],Lt=He._mainLinePosition,vt=He._mainMirrorPosition,Dt=He._vals=z.calcTicks(He),xt=[He.mirror,Lt,vt].join("_");for(Ke=0;Ke<Dt.length;Ke++)Dt[Ke].axInfo=xt;He._selections={},He._tickAngles&&(He._prevTickAngles=He._tickAngles),He._tickAngles={},He._depth=null;var it={};if(He.visible){var St,Nt,Ut=z.makeTransTickFn(He),Qt=z.makeTransTickLabelFn(He),Ie=He.ticks==="inside",lt=He.ticks==="outside";if(He.tickson==="boundaries"){var wt=function(Nr,Pr){var en,tn=[],Qr=function(rn,An){var En=rn.xbnd[An];En!==null&&tn.push(e.extendFlat({},rn,{x:En}))};if(Pr.length){for(en=0;en<Pr.length;en++)Qr(Pr[en],0);Qr(Pr[en-1],1)}return tn}(0,Dt);Nt=z.clipEnds(He,wt),St=Ie?Nt:wt}else Nt=z.clipEnds(He,Dt),St=Ie&&He.ticklabelmode!=="period"?Nt:Dt;var Ot=He._gridVals=Nt,Gt=function(Nr,Pr){var en,tn,Qr=[],rn=Pr.length&&Pr[Pr.length-1].x<Pr[0].x,An=function(Bn,Jt){var It=Bn.xbnd[Jt];It!==null&&Qr.push(e.extendFlat({},Bn,{x:It}))};if(Nr.showdividers&&Pr.length){for(en=0;en<Pr.length;en++){var En=Pr[en];En.text2!==tn&&An(En,rn?1:0),tn=En.text2}An(Pr[en-1],rn?0:1)}return Qr}(He,Dt);if(!Le._hasOnlyLargeSploms){var ir=He._subplotsWith,Xt={};for(Ke=0;Ke<ir.length;Ke++){_e=ir[Ke];var Kt=(Ce=Le._plots[_e])[ht+"axis"],or=Kt._mainAxis._id;if(!Xt[or]){Xt[or]=1;var dr=Xe==="x"?"M0,"+Kt._offset+"v"+Kt._length:"M"+Kt._offset+",0h"+Kt._length;z.drawGrid(Ue,He,{vals:Ot,counterAxis:Kt,layer:Ce.gridlayer.select("."+Pe),path:dr,transFn:Ut}),z.drawZeroLine(Ue,He,{counterAxis:Kt,layer:Ce.zerolinelayer,path:dr,transFn:Ut})}}}var vr=z.getTickSigns(He),ur=[];if(He.ticks){var pr,br,Rr,_r=z.makeTickPath(He,Lt,vr[2]);if(He._anchorAxis&&He.mirror&&He.mirror!==!0?(pr=z.makeTickPath(He,vt,vr[3]),br=_r+pr):(pr="",br=_r),He.showdividers&&lt&&He.tickson==="boundaries"){var jr={};for(Ke=0;Ke<Gt.length;Ke++)jr[Gt[Ke].x]=1;Rr=function(Nr){return jr[Nr.x]?pr:br}}else Rr=br;z.drawTicks(Ue,He,{vals:St,layer:pt,path:Rr,transFn:Ut}),He.mirror==="allticks"&&(ur=Object.keys(He._linepositions||{}))}for(Ke=0;Ke<ur.length;Ke++){_e=ur[Ke],Ce=Le._plots[_e];var $r=He._linepositions[_e]||[],pn=z.makeTickPath(He,$r[0],vr[0])+z.makeTickPath(He,$r[1],vr[1]);z.drawTicks(Ue,He,{vals:St,layer:Ce[Xe+"axislayer"],path:pn,transFn:Ut})}var In=[];if(In.push(function(){return z.drawLabels(Ue,He,{vals:Dt,layer:pt,plotinfo:Ce,transFn:Qt,labelFns:z.makeLabelFns(He,Lt)})}),He.type==="multicategory"){var On={x:2,y:10}[Xe];In.push(function(){var Nr={x:"height",y:"width"}[Xe],Pr=an()[Nr]+On+(He._tickAngles[Pe+"tick"]?He.tickfont.size*Y:0);return z.drawLabels(Ue,He,{vals:Ye(He,Dt),layer:pt,cls:Pe+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:Ut,labelFns:z.makeLabelFns(He,Lt+Pr*vr[4])})}),In.push(function(){return He._depth=vr[4]*(an("tick2")[He.side]-Lt),function(Nr,Pr,en){var tn=Pr._id+"divider",Qr=en.vals,rn=en.layer.selectAll("path."+tn).data(Qr,Oe);rn.exit().remove(),rn.enter().insert("path",":first-child").classed(tn,1).classed("crisp",1).call(u.stroke,Pr.dividercolor).style("stroke-width",s.crispRound(Nr,Pr.dividerwidth,1)+"px"),rn.attr("transform",en.transFn).attr("d",en.path)}(Ue,He,{vals:Gt,layer:pt,path:z.makeTickPath(He,Lt,vr[4],He._depth),transFn:Ut})})}else He.title.hasOwnProperty("standoff")&&In.push(function(){He._depth=vr[4]*(an()[He.side]-Lt)});var Sn=h.getComponentMethod("rangeslider","isVisible")(He);return In.push(function(){var Nr,Pr,en,tn,Qr=He.side.charAt(0),rn=$[He.side].charAt(0),An=z.getPxPosition(Ue,He),En=lt?He.ticklen:0;if((He.automargin||Sn)&&(He.type==="multicategory"?Nr=an("tick2"):(Nr=an(),Xe==="x"&&Qr==="b"&&(He._depth=Math.max(Nr.width>0?Nr.bottom-An:0,En)))),He.automargin){Pr={x:0,y:0,r:0,l:0,t:0,b:0};var Bn=[0,1];if(Xe==="x"){if(Qr==="b"?Pr[Qr]=He._depth:(Pr[Qr]=He._depth=Math.max(Nr.width>0?An-Nr.top:0,En),Bn.reverse()),Nr.width>0){var Jt=Nr.right-(He._offset+He._length);Jt>0&&(Pr.xr=1,Pr.r=Jt);var It=He._offset-Nr.left;It>0&&(Pr.xl=0,Pr.l=It)}}else if(Qr==="l"?Pr[Qr]=He._depth=Math.max(Nr.height>0?An-Nr.left:0,En):(Pr[Qr]=He._depth=Math.max(Nr.height>0?Nr.right-An:0,En),Bn.reverse()),Nr.height>0){var qt=Nr.bottom-(He._offset+He._length);qt>0&&(Pr.yb=0,Pr.b=qt);var fr=He._offset-Nr.top;fr>0&&(Pr.yt=1,Pr.t=fr)}Pr[ht]=He.anchor==="free"?He.position:He._anchorAxis.domain[Bn[0]],He.title.text!==Le._dfltTitle[Xe]&&(Pr[Qr]+=je(He)+(He.title.standoff||0)),He.mirror&&He.anchor!=="free"&&((en={x:0,y:0,r:0,l:0,t:0,b:0})[rn]=He.linewidth,He.mirror&&He.mirror!==!0&&(en[rn]+=En),He.mirror===!0||He.mirror==="ticks"?en[ht]=He._anchorAxis.domain[Bn[1]]:He.mirror!=="all"&&He.mirror!=="allticks"||(en[ht]=[He._counterDomainMin,He._counterDomainMax][Bn[1]]))}Sn&&(tn=h.getComponentMethod("rangeslider","autoMarginOpts")(Ue,He)),m.autoMargin(Ue,et(He),Pr),m.autoMargin(Ue,st(He),en),m.autoMargin(Ue,ct(He),tn)}),Be.skipTitle||Sn&&He.side==="bottom"||In.push(function(){return function(Nr,Pr){var en,tn=Nr._fullLayout,Qr=Pr._id,rn=Qr.charAt(0),An=Pr.title.font.size;if(Pr.title.hasOwnProperty("standoff"))en=Pr._depth+Pr.title.standoff+je(Pr);else{var En=er(Pr);if(Pr.type==="multicategory")en=Pr._depth;else{var Bn=1.5*An;En&&(Bn=.5*An,Pr.ticks==="outside"&&(Bn+=Pr.ticklen)),en=10+Bn+(Pr.linewidth?Pr.linewidth-1:0)}En||(en+=rn==="x"?Pr.side==="top"?An*(Pr.showticklabels?1:0):An*(Pr.showticklabels?1.5:.5):Pr.side==="right"?An*(Pr.showticklabels?1:.5):An*(Pr.showticklabels?.5:0))}var Jt,It,qt,fr,Tr=z.getPxPosition(Nr,Pr);if(rn==="x"?(It=Pr._offset+Pr._length/2,qt=Pr.side==="top"?Tr-en:Tr+en):(qt=Pr._offset+Pr._length/2,It=Pr.side==="right"?Tr+en:Tr-en,Jt={rotate:"-90",offset:0}),Pr.type!=="multicategory"){var Gr=Pr._selections[Pr._id+"tick"];if(fr={selection:Gr,side:Pr.side},Gr&&Gr.node()&&Gr.node().parentNode){var Vr=s.getTranslate(Gr.node().parentNode);fr.offsetLeft=Vr.x,fr.offsetTop=Vr.y}Pr.title.hasOwnProperty("standoff")&&(fr.pad=0)}return o.draw(Nr,Qr+"title",{propContainer:Pr,propName:Pr._name+".title.text",placeholder:tn._dfltTitle[rn],avoid:fr,transform:Jt,attributes:{x:It,y:qt,"text-anchor":"middle"}})}(Ue,He)}),e.syncOrAsync(In)}}function an(Nr){var Pr=Pe+(Nr||"tick");return it[Pr]||(it[Pr]=function(en,tn){var Qr,rn,An,En;return en._selections[tn].size()?(Qr=1/0,rn=-1/0,An=1/0,En=-1/0,en._selections[tn].each(function(){var Bn=qe(this),Jt=s.bBox(Bn.node().parentNode);Qr=Math.min(Qr,Jt.top),rn=Math.max(rn,Jt.bottom),An=Math.min(An,Jt.left),En=Math.max(En,Jt.right)})):(Qr=0,rn=0,An=0,En=0),{top:Qr,bottom:rn,left:An,right:En,height:rn-Qr,width:En-An}}(He,Pr)),it[Pr]}},z.getTickSigns=function(Ue){var He=Ue._id.charAt(0),Be={x:"top",y:"right"}[He],Ke=Ue.side===Be?1:-1,_e=[-1,1,Ke,-Ke];return Ue.ticks!=="inside"==(He==="x")&&(_e=_e.map(function(Ce){return-Ce})),Ue.side&&_e.push({l:-1,t:-1,r:1,b:1}[Ue.side.charAt(0)]),_e},z.makeTransTickFn=function(Ue){return Ue._id.charAt(0)==="x"?function(He){return f(Ue._offset+Ue.l2p(He.x),0)}:function(He){return f(0,Ue._offset+Ue.l2p(He.x))}},z.makeTransTickLabelFn=function(Ue){var He=function(_e){var Ce=_e.ticklabelposition||"",Le=function(St){return Ce.indexOf(St)!==-1},Pe=Le("top"),Xe=Le("left"),ht=Le("right"),Mt=Le("bottom"),pt=Le("inside"),Lt=Mt||Xe||Pe||ht;if(!Lt&&!pt)return[0,0];var vt=_e.side,Dt=Lt?(_e.tickwidth||0)/2:0,xt=3,it=_e.tickfont?_e.tickfont.size:12;return(Mt||Pe)&&(Dt+=it*H,xt+=(_e.linewidth||0)/2),(Xe||ht)&&(Dt+=(_e.linewidth||0)/2,xt+=3),pt&&vt==="top"&&(xt-=it*(1-H)),(Xe||Pe)&&(Dt=-Dt),vt!=="bottom"&&vt!=="right"||(xt=-xt),[Lt?Dt:0,pt?xt:0]}(Ue),Be=He[0],Ke=He[1];return Ue._id.charAt(0)==="x"?function(_e){return f(Be+Ue._offset+Ue.l2p(rt(_e)),Ke)}:function(_e){return f(Ke,Be+Ue._offset+Ue.l2p(rt(_e)))}},z.makeTickPath=function(Ue,He,Be,Ke){Ke=Ke!==void 0?Ke:Ue.ticklen;var _e=Ue._id.charAt(0),Ce=(Ue.linewidth||1)/2;return _e==="x"?"M0,"+(He+Ce*Be)+"v"+Ke*Be:"M"+(He+Ce*Be)+",0h"+Ke*Be},z.makeLabelFns=function(Ue,He,Be){var Ke=Ue.ticklabelposition||"",_e=function(Xt){return Ke.indexOf(Xt)!==-1},Ce=_e("top"),Le=_e("left"),Pe=_e("right"),Xe=_e("bottom")||Le||Ce||Pe,ht=_e("inside"),Mt=Ke==="inside"&&Ue.ticks==="inside"||!ht&&Ue.ticks==="outside"&&Ue.tickson!=="boundaries",pt=0,Lt=0,vt=Mt?Ue.ticklen:0;if(ht?vt*=-1:Xe&&(vt=0),Mt&&(pt+=vt,Be)){var Dt=e.deg2rad(Be);pt=vt*Math.cos(Dt)+1,Lt=vt*Math.sin(Dt)}Ue.showticklabels&&(Mt||Ue.showline)&&(pt+=.2*Ue.tickfont.size);var xt,it,St,Nt,Ut,Qt={labelStandoff:pt+=(Ue.linewidth||1)/2*(ht?-1:1),labelShift:Lt},Ie=0,lt=Ue.side,wt=Ue._id.charAt(0),Ot=Ue.tickangle;if(wt==="x")Nt=(Ut=!ht&&lt==="bottom"||ht&&lt==="top")?1:-1,ht&&(Nt*=-1),xt=Lt*Nt,it=He+pt*Nt,St=Ut?1:-.2,Math.abs(Ot)===90&&(ht?St+=Z:St=Ot===-90&&lt==="bottom"?H:Ot===90&&lt==="top"?Z:.5,Ie=Z/2*(Ot/90)),Qt.xFn=function(Xt){return Xt.dx+xt+Ie*Xt.fontSize},Qt.yFn=function(Xt){return Xt.dy+it+Xt.fontSize*St},Qt.anchorFn=function(Xt,Kt){if(Xe){if(Le)return"end";if(Pe)return"start"}return d(Kt)&&Kt!==0&&Kt!==180?Kt*Nt<0!==ht?"end":"start":"middle"},Qt.heightFn=function(Xt,Kt,or){return Kt<-60||Kt>60?-.5*or:Ue.side==="top"!==ht?-or:0};else if(wt==="y"){if(Nt=(Ut=!ht&&lt==="left"||ht&&lt==="right")?1:-1,ht&&(Nt*=-1),xt=pt,it=Lt*Nt,St=0,ht||Math.abs(Ot)!==90||(St=Ot===-90&&lt==="left"||Ot===90&&lt==="right"?H:.5),ht){var Gt=d(Ot)?+Ot:0;if(Gt!==0){var ir=e.deg2rad(Gt);Ie=Math.abs(Math.sin(ir))*H*Nt,St=0}}Qt.xFn=function(Xt){return Xt.dx+He-(xt+Xt.fontSize*St)*Nt+Ie*Xt.fontSize},Qt.yFn=function(Xt){return Xt.dy+it+Xt.fontSize*Z},Qt.anchorFn=function(Xt,Kt){return d(Kt)&&Math.abs(Kt)===90?"middle":Ut?"end":"start"},Qt.heightFn=function(Xt,Kt,or){return Ue.side==="right"&&(Kt*=-1),Kt<-30?-or:Kt<30?-.5*or:0}}return Qt},z.drawTicks=function(Ue,He,Be){Be=Be||{};var Ke=He._id+"tick",_e=Be.vals;He.ticklabelmode==="period"&&(_e=_e.slice()).shift();var Ce=Be.layer.selectAll("path."+Ke).data(He.ticks?_e:[],Oe);Ce.exit().remove(),Ce.enter().append("path").classed(Ke,1).classed("ticks",1).classed("crisp",Be.crisp!==!1).call(u.stroke,He.tickcolor).style("stroke-width",s.crispRound(Ue,He.tickwidth,1)+"px").attr("d",Be.path).style("display",null),tr(He,[G]),Ce.attr("transform",Be.transFn)},z.drawGrid=function(Ue,He,Be){Be=Be||{};var Ke=He._id+"grid",_e=Be.vals,Ce=Be.counterAxis;if(He.showgrid===!1)_e=[];else if(Ce&&z.shouldShowZeroLine(Ue,He,Ce))for(var Le=He.tickmode==="array",Pe=0;Pe<_e.length;Pe++){var Xe=_e[Pe].x;if(Le?!Xe:Math.abs(Xe)<He.dtick/100){if(_e=_e.slice(0,Pe).concat(_e.slice(Pe+1)),!Le)break;Pe--}}var ht=Be.layer.selectAll("path."+Ke).data(_e,Oe);ht.exit().remove(),ht.enter().append("path").classed(Ke,1).classed("crisp",Be.crisp!==!1),He._gw=s.crispRound(Ue,He.gridwidth,1),ht.attr("transform",Be.transFn).attr("d",Be.path).call(u.stroke,He.gridcolor||"#ddd").style("stroke-width",He._gw+"px").style("display",null),tr(He,[U]),typeof Be.path=="function"&&ht.attr("d",Be.path)},z.drawZeroLine=function(Ue,He,Be){Be=Be||Be;var Ke=He._id+"zl",_e=z.shouldShowZeroLine(Ue,He,Be.counterAxis),Ce=Be.layer.selectAll("path."+Ke).data(_e?[{x:0,id:He._id}]:[]);Ce.exit().remove(),Ce.enter().append("path").classed(Ke,1).classed("zl",1).classed("crisp",Be.crisp!==!1).each(function(){Be.layer.selectAll("path").sort(function(Le,Pe){return ee(Le.id,Pe.id)})}),Ce.attr("transform",Be.transFn).attr("d",Be.path).call(u.stroke,He.zerolinecolor||u.defaultLine).style("stroke-width",s.crispRound(Ue,He.zerolinewidth,He._gw||1)+"px").style("display",null),tr(He,[N])},z.drawLabels=function(Ue,He,Be){Be=Be||{};var Ke=Ue._fullLayout,_e=He._id,Ce=_e.charAt(0),Le=Be.cls||_e+"tick",Pe=Be.vals,Xe=Be.labelFns,ht=Be.secondary?0:He.tickangle,Mt=(He._prevTickAngles||{})[Le],pt=Be.layer.selectAll("g."+Le).data(He.showticklabels?Pe:[],Oe),Lt=[];function vt(Nt,Ut){Nt.each(function(Qt){var Ie=t.select(this),lt=Ie.select(".text-math-group"),wt=Xe.anchorFn(Qt,Ut),Ot=Be.transFn.call(Ie.node(),Qt)+(d(Ut)&&+Ut!=0?" rotate("+Ut+","+Xe.xFn(Qt)+","+(Xe.yFn(Qt)-Qt.fontSize/2)+")":""),Gt=l.lineCount(Ie),ir=Y*Qt.fontSize,Xt=Xe.heightFn(Qt,d(Ut)?+Ut:0,(Gt-1)*ir);if(Xt&&(Ot+=f(0,Xt)),lt.empty()){var Kt=Ie.select("text");Kt.attr({transform:Ot,"text-anchor":wt}),Kt.style("opacity",1),He._adjustTickLabelsOverflow&&He._adjustTickLabelsOverflow()}else{var or=s.bBox(lt.node()).width*{end:-.5,start:.5}[wt];lt.attr("transform",Ot+f(or,0))}})}pt.enter().append("g").classed(Le,1).append("text").attr("text-anchor","middle").each(function(Nt){var Ut=t.select(this),Qt=Ue._promises.length;Ut.call(l.positionText,Xe.xFn(Nt),Xe.yFn(Nt)).call(s.font,Nt.font,Nt.fontSize,Nt.fontColor).text(Nt.text).call(l.convertToTspans,Ue),Ue._promises[Qt]?Lt.push(Ue._promises.pop().then(function(){vt(Ut,ht)})):vt(Ut,ht)}),tr(He,[X]),pt.exit().remove(),Be.repositionOnUpdate&&pt.each(function(Nt){t.select(this).select("text").call(l.positionText,Xe.xFn(Nt),Xe.yFn(Nt))}),He._adjustTickLabelsOverflow=function(){var Nt=He.ticklabeloverflow;if(Nt&&Nt!=="allow"){var Ut=Nt.indexOf("hide")!==-1,Qt=He._id.charAt(0)==="x",Ie=0,lt=Qt?Ue._fullLayout.width:Ue._fullLayout.height;if(Nt.indexOf("domain")!==-1){var wt=e.simpleMap(He.range,He.r2l);Ie=He.l2p(wt[0])+He._offset,lt=He.l2p(wt[1])+He._offset}var Ot=Math.min(Ie,lt),Gt=Math.max(Ie,lt),ir=He.side,Xt=1/0,Kt=-1/0;for(var or in pt.each(function(ur){var pr=t.select(this);if(pr.select(".text-math-group").empty()){var br=s.bBox(pr.node()),Rr=0;Qt?(br.right>Gt||br.left<Ot)&&(Rr=1):(br.bottom>Gt||br.top+(He.tickangle?0:ur.fontSize/4)<Ot)&&(Rr=1);var _r=pr.select("text");Rr?Ut&&_r.style("opacity",0):(_r.style("opacity",1),Xt=ir==="bottom"||ir==="right"?Math.min(Xt,Qt?br.top:br.left):-1/0,Kt=ir==="top"||ir==="left"?Math.max(Kt,Qt?br.bottom:br.right):1/0)}}),Ke._plots){var dr=Ke._plots[or];if(He._id===dr.xaxis._id||He._id===dr.yaxis._id){var vr=Qt?dr.yaxis:dr.xaxis;vr&&(vr["_visibleLabelMin_"+He._id]=Xt,vr["_visibleLabelMax_"+He._id]=Kt)}}}},He._hideCounterAxisInsideTickLabels=function(Nt){var Ut=He._id.charAt(0)==="x",Qt=[];for(var Ie in Ke._plots){var lt=Ke._plots[Ie];He._id!==lt.xaxis._id&&He._id!==lt.yaxis._id||Qt.push(Ut?lt.yaxis:lt.xaxis)}Qt.forEach(function(wt,Ot){wt&&er(wt)&&(Nt||[N,U,G,X]).forEach(function(Gt){var ir=Gt.K==="tick"&&Gt.L==="text"&&He.ticklabelmode==="period",Xt=Ke._plots[He._mainSubplot];(Gt.K===N.K?Xt.zerolinelayer.selectAll("."+He._id+"zl"):Gt.K===U.K?Xt.gridlayer.selectAll("."+He._id):Xt[He._id.charAt(0)+"axislayer"]).each(function(){var Kt=t.select(this);Gt.L&&(Kt=Kt.selectAll(Gt.L)),Kt.each(function(or){var dr=He.l2p(ir?rt(or):or.x)+He._offset,vr=t.select(this);dr<He["_visibleLabelMax_"+wt._id]&&dr>He["_visibleLabelMin_"+wt._id]?vr.style("display","none"):Gt.K!=="tick"||Ot||vr.style("display",null)})})})})},vt(pt,Mt+1?Mt:ht);var Dt=null;He._selections&&(He._selections[Le]=pt);var xt=[function(){return Lt.length&&Promise.all(Lt)}];He.automargin&&Ke._redrawFromAutoMarginCount&&Mt===90?(Dt=90,xt.push(function(){vt(pt,Mt)})):xt.push(function(){if(vt(pt,ht),Pe.length&&Ce==="x"&&!d(ht)&&(He.type!=="log"||String(He.dtick).charAt(0)!=="D")){Dt=0;var Nt,Ut=0,Qt=[];if(pt.each(function(pr){Ut=Math.max(Ut,pr.fontSize);var br=He.l2p(pr.x),Rr=qe(this),_r=s.bBox(Rr.node());Qt.push({top:0,bottom:10,height:10,left:br-_r.width/2,right:br+_r.width/2+2,width:_r.width+2})}),He.tickson!=="boundaries"&&!He.showdividers||Be.secondary){var Ie=Pe.length,lt=Math.abs((Pe[Ie-1].x-Pe[0].x)*He._m)/(Ie-1),wt=He.ticklabelposition||"",Ot=function(pr){return wt.indexOf(pr)!==-1},Gt=Ot("top"),ir=Ot("left"),Xt=Ot("right"),Kt=Ot("bottom")||ir||Gt||Xt?(He.tickwidth||0)+6:0,or=lt<2.5*Ut||He.type==="multicategory";for(Nt=0;Nt<Qt.length-1;Nt++)if(e.bBoxIntersect(Qt[Nt],Qt[Nt+1],Kt)){Dt=or?90:30;break}}else{var dr=2;for(He.ticks&&(dr+=He.tickwidth/2),Nt=0;Nt<Qt.length;Nt++){var vr=Pe[Nt].xbnd,ur=Qt[Nt];if(vr[0]!==null&&ur.left-He.l2p(vr[0])<dr||vr[1]!==null&&He.l2p(vr[1])-ur.right<dr){Dt=90;break}}}Dt&&vt(pt,Dt)}}),He._tickAngles&&xt.push(function(){He._tickAngles[Le]=Dt===null?d(ht)?ht:0:Dt});var it=He._anchorAxis;it&&it.autorange&&er(He)&&!J(Ke,He._id)&&(Ke._insideTickLabelsAutorange||(Ke._insideTickLabelsAutorange={}),Ke._insideTickLabelsAutorange[it._name+".autorange"]=it.autorange,xt.push(function(){pt.each(function(Nt,Ut){var Qt=qe(this);Qt.select(".text-math-group").empty()&&(He._vals[Ut].bb=s.bBox(Qt.node()))})}));var St=e.syncOrAsync(xt);return St&&St.then&&Ue._promises.push(St),St},z.getPxPosition=function(Ue,He){var Be,Ke=Ue._fullLayout._size,_e=He._id.charAt(0),Ce=He.side;return He.anchor!=="free"?Be=He._anchorAxis:_e==="x"?Be={_offset:Ke.t+(1-(He.position||0))*Ke.h,_length:0}:_e==="y"&&(Be={_offset:Ke.l+(He.position||0)*Ke.w,_length:0}),Ce==="top"||Ce==="left"?Be._offset:Ce==="bottom"||Ce==="right"?Be._offset+Be._length:void 0},z.shouldShowZeroLine=function(Ue,He,Be){var Ke=e.simpleMap(He.range,He.r2l);return Ke[0]*Ke[1]<=0&&He.zeroline&&(He.type==="linear"||He.type==="-")&&!(He.rangebreaks&&He.maskBreaks(0)===D)&&(We(He,0)||!function(_e,Ce,Le,Pe){var Xe=Le._mainAxis;if(!Xe)return;var ht=_e._fullLayout,Mt=Ce._id.charAt(0),pt=z.counterLetter(Ce._id),Lt=Ce._offset+(Math.abs(Pe[0])<Math.abs(Pe[1])==(Mt==="x")?0:Ce._length);function vt(Nt){if(!Nt.showline||!Nt.linewidth)return!1;var Ut=Math.max((Nt.linewidth+Ce.zerolinewidth)/2,1);function Qt(wt){return typeof wt=="number"&&Math.abs(wt-Lt)<Ut}if(Qt(Nt._mainLinePosition)||Qt(Nt._mainMirrorPosition))return!0;var Ie=Nt._linepositions||{};for(var lt in Ie)if(Qt(Ie[lt][0])||Qt(Ie[lt][1]))return!0}var Dt=ht._plots[Le._mainSubplot];if(!(Dt.mainplotinfo||Dt).overlays.length)return vt(Le);for(var xt=z.list(_e,pt),it=0;it<xt.length;it++){var St=xt[it];if(St._mainAxis===Xe&&vt(St))return!0}}(Ue,He,Be,Ke)||function(_e,Ce){for(var Le=_e._fullData,Pe=Ce._mainSubplot,Xe=Ce._id.charAt(0),ht=0;ht<Le.length;ht++){var Mt=Le[ht];if(Mt.visible===!0&&Mt.xaxis+Mt.yaxis===Pe&&(h.traceIs(Mt,"bar-like")&&Mt.orientation==={x:"h",y:"v"}[Xe]||Mt.fill&&Mt.fill.charAt(Mt.fill.length-1)===Xe))return!0}return!1}(Ue,He))},z.clipEnds=function(Ue,He){return He.filter(function(Be){return We(Ue,Be.x)})},z.allowAutoMargin=function(Ue){for(var He=z.list(Ue,"",!0),Be=0;Be<He.length;Be++){var Ke=He[Be];Ke.automargin&&(m.allowAutoMargin(Ue,et(Ke)),Ke.mirror&&m.allowAutoMargin(Ue,st(Ke))),h.getComponentMethod("rangeslider","isVisible")(Ke)&&m.allowAutoMargin(Ue,ct(Ke))}},z.swap=function(Ue,He){for(var Be=function(_e,Ce){var Le,Pe,Xe=[];for(Le=0;Le<Ce.length;Le++){var ht=[],Mt=_e._fullData[Ce[Le]].xaxis,pt=_e._fullData[Ce[Le]].yaxis;if(Mt&&pt){for(Pe=0;Pe<Xe.length;Pe++)Xe[Pe].x.indexOf(Mt)===-1&&Xe[Pe].y.indexOf(pt)===-1||ht.push(Pe);if(ht.length){var Lt,vt=Xe[ht[0]];if(ht.length>1)for(Pe=1;Pe<ht.length;Pe++)Lt=Xe[ht[Pe]],Pt(vt.x,Lt.x),Pt(vt.y,Lt.y);Pt(vt.x,[Mt]),Pt(vt.y,[pt])}else Xe.push({x:[Mt],y:[pt]})}}return Xe}(Ue,He),Ke=0;Ke<Be.length;Ke++)kt(Ue,Be[Ke].x,Be[Ke].y)}},{"../../components/color":650,"../../components/drawing":672,"../../components/titles":748,"../../constants/alignment":755,"../../constants/numerical":763,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/plots":901,"../../registry":915,"./autorange":837,"./axis_autotype":839,"./axis_ids":842,"./clean_ticks":844,"./layout_attributes":853,"./set_convert":859,"@plotly/d3":58,"fast-isnumeric":246}],839:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../constants/numerical").BADNUM,h=d.isArrayOrTypedArray,e=d.isDateTime,f=d.cleanNumber,l=Math.round;function o(s,i){return i?t(s):typeof s=="number"}function u(s){return Math.max(1,(s-1)/1e3)}I.exports=function(s,i,c){var n=s,a=c.noMultiCategory;if(h(n)&&!n.length)return"-";if(!a&&function(b){return h(b[0])&&h(b[1])}(n))return"multicategory";if(a&&Array.isArray(n[0])){for(var g=[],p=0;p<n.length;p++)if(h(n[p]))for(var y=0;y<n[p].length;y++)g.push(n[p][y]);n=g}if(function(b,x){for(var T=b.length,A=u(T),S=0,w=0,E={},k=0;k<T;k+=A){var L=l(k),M=b[L],P=String(M);E[P]||(E[P]=1,e(M,x)&&S++,t(M)&&w++)}return S>2*w}(n,i))return"date";var v=c.autotypenumbers!=="strict";return function(b,x){for(var T=b.length,A=u(T),S=0,w=0,E={},k=0;k<T;k+=A){var L=l(k),M=b[L],P=String(M);if(!E[P]){E[P]=1;var D=typeof M;D==="boolean"?w++:(x?f(M)!==m:D==="number")?S++:D==="string"&&w++}}return w>2*S}(n,v)?"category":function(b,x){for(var T=b.length,A=0;A<T;A++)if(o(b[A],x))return!0;return!1}(n,v)?"linear":"-"}},{"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],840:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../registry"),m=r("../../lib"),h=r("../array_container_defaults"),e=r("./layout_attributes"),f=r("./tick_value_defaults"),l=r("./tick_mark_defaults"),o=r("./tick_label_defaults"),u=r("./category_order_defaults"),s=r("./line_grid_defaults"),i=r("./set_convert"),c=r("./constants").WEEKDAY_PATTERN,n=r("./constants").HOUR_PATTERN;function a(y,v,b){function x(M,P){return m.coerce(y,v,e.rangebreaks,M,P)}if(x("enabled")){var T=x("bounds");if(T&&T.length>=2){var A,S,w="";if(T.length===2){for(A=0;A<2;A++)if(S=p(T[A])){w=c;break}}var E=x("pattern",w);if(E===c)for(A=0;A<2;A++)(S=p(T[A]))&&(v.bounds[A]=T[A]=S-1);if(E)for(A=0;A<2;A++)switch(S=T[A],E){case c:if(!t(S)||(S=+S)!==Math.floor(S)||S<0||S>=7)return void(v.enabled=!1);v.bounds[A]=T[A]=S;break;case n:if(!t(S)||(S=+S)<0||S>24)return void(v.enabled=!1);v.bounds[A]=T[A]=S}if(b.autorange===!1){var k=b.range;if(k[0]<k[1]){if(T[0]<k[0]&&T[1]>k[1])return void(v.enabled=!1)}else if(T[0]>k[0]&&T[1]<k[1])return void(v.enabled=!1)}}else{var L=x("values");if(!L||!L.length)return void(v.enabled=!1);x("dvalue")}}}I.exports=function(y,v,b,x,T){var A,S=x.letter,w=x.font||{},E=x.splomStash||{},k=b("visible",!x.visibleDflt),L=v._template||{},M=v.type||L.type||"-";M==="date"&&(d.getComponentMethod("calendars","handleDefaults")(y,v,"calendar",x.calendar),x.noTicklabelmode||(A=b("ticklabelmode")));var P="";x.noTicklabelposition&&M!=="multicategory"||(P=m.coerce(y,v,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:A==="period"?["outside","inside"]:S==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),x.noTicklabeloverflow||b("ticklabeloverflow",P.indexOf("inside")!==-1?"hide past domain":M==="category"||M==="multicategory"?"allow":"hide past div"),i(v,T);var D=!v.isValidRange(y.range);D&&x.reverseDflt&&(D="reversed"),!b("autorange",D)||M!=="linear"&&M!=="-"||b("rangemode"),b("range"),v.cleanRange(),u(y,v,b,x),M==="category"||x.noHover||b("hoverformat");var N=b("color"),U=N!==e.color.dflt?N:w.color,G=E.label||T._dfltTitle[S];if(o(y,v,b,M,x,{pass:1}),!k)return v;b("title.text",G),m.coerceFont(b,"title.font",{family:w.family,size:m.bigFont(w.size),color:U}),f(y,v,b,M),o(y,v,b,M,x,{pass:2}),l(y,v,b,x),s(y,v,b,{dfltColor:N,bgColor:x.bgColor,showGrid:x.showGrid,attributes:e}),(v.showline||v.ticks)&&b("mirror"),x.automargin&&b("automargin");var X,K=M==="multicategory";if(x.noTickson||M!=="category"&&!K||!v.ticks&&!v.showgrid||(K&&(X="boundaries"),b("tickson",X)==="boundaries"&&delete v.ticklabelposition),K&&b("showdividers")&&(b("dividercolor"),b("dividerwidth")),M==="date")if(h(y,v,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:a}),v.rangebreaks.length){for(var Z=0;Z<v.rangebreaks.length;Z++)if(v.rangebreaks[Z].pattern===c){v._hasDayOfWeekBreaks=!0;break}if(i(v,T),T._has("scattergl")||T._has("splom"))for(var H=0;H<x.data.length;H++){var Y=x.data[H];Y.type!=="scattergl"&&Y.type!=="splom"||(Y.visible=!1,m.warn(Y.type+" traces do not work on axes with rangebreaks. Setting trace "+Y.index+" to `visible: false`."))}}else delete v.rangebreaks;return v};var g={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function p(y){if(typeof y=="string")return g[y.substr(0,3).toLowerCase()]}},{"../../lib":787,"../../registry":915,"../array_container_defaults":833,"./category_order_defaults":843,"./constants":845,"./layout_attributes":853,"./line_grid_defaults":855,"./set_convert":859,"./tick_label_defaults":860,"./tick_mark_defaults":861,"./tick_value_defaults":862,"fast-isnumeric":246}],841:[function(r,I,B){var t=r("../../constants/docs"),d=t.FORMAT_LINK,m=t.DATE_FORMAT_LINK;function h(f,l){return["Sets the "+f+" formatting rule"+(l?"for `"+l+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+d+"."].join(" ")}function e(f,l){return h(f,l)+[" And for dates see: "+m+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}I.exports={axisHoverFormat:function(f,l){return{valType:"string",dflt:"",editType:"none",description:(l?h:e)("hover text",f)+["By default the values are formatted using "+(l?"generic number format":"`"+f+"axis.hoverformat`")+"."].join(" ")}},descriptionOnlyNumbers:h,descriptionWithDates:e}},{"../../constants/docs":758}],842:[function(r,I,B){var t=r("../../registry"),d=r("./constants");function m(h,e){if(e&&e.length){for(var f=0;f<e.length;f++)if(e[f][h])return!0}return!1}B.id2name=function(h){if(typeof h=="string"&&h.match(d.AX_ID_PATTERN)){var e=h.split(" ")[0].substr(1);return e==="1"&&(e=""),h.charAt(0)+"axis"+e}},B.name2id=function(h){if(h.match(d.AX_NAME_PATTERN)){var e=h.substr(5);return e==="1"&&(e=""),h.charAt(0)+e}},B.cleanId=function(h,e,f){var l=/( domain)$/.test(h);if(typeof h=="string"&&h.match(d.AX_ID_PATTERN)&&(!e||h.charAt(0)===e)&&(!l||f)){var o=h.split(" ")[0].substr(1).replace(/^0+/,"");return o==="1"&&(o=""),h.charAt(0)+o+(l&&f?" domain":"")}},B.list=function(h,e,f){var l=h._fullLayout;if(!l)return[];var o,u=B.listIds(h,e),s=new Array(u.length);for(o=0;o<u.length;o++){var i=u[o];s[o]=l[i.charAt(0)+"axis"+i.substr(1)]}if(!f){var c=l._subplots.gl3d||[];for(o=0;o<c.length;o++){var n=l[c[o]];e?s.push(n[e+"axis"]):s.push(n.xaxis,n.yaxis,n.zaxis)}}return s},B.listIds=function(h,e){var f=h._fullLayout;if(!f)return[];var l=f._subplots;return e?l[e+"axis"]:l.xaxis.concat(l.yaxis)},B.getFromId=function(h,e,f){var l=h._fullLayout;return e=e===void 0||typeof e!="string"?e:e.replace(" domain",""),f==="x"?e=e.replace(/y[0-9]*/,""):f==="y"&&(e=e.replace(/x[0-9]*/,"")),l[B.id2name(e)]},B.getFromTrace=function(h,e,f){var l=h._fullLayout,o=null;if(t.traceIs(e,"gl3d")){var u=e.scene;u.substr(0,5)==="scene"&&(o=l[u][f+"axis"])}else o=B.getFromId(h,e[f+"axis"]||f);return o},B.idSort=function(h,e){var f=h.charAt(0),l=e.charAt(0);return f!==l?f>l?1:-1:+(h.substr(1)||1)-+(e.substr(1)||1)},B.ref2id=function(h){return!!/^[xyz]/.test(h)&&h.split(" ")[0]},B.isLinked=function(h,e){return m(e,h._axisMatchGroups)||m(e,h._axisConstraintGroups)}},{"../../registry":915,"./constants":845}],843:[function(r,I,B){I.exports=function(t,d,m,h){if(d.type==="category"){var e,f=t.categoryarray,l=Array.isArray(f)&&f.length>0;l&&(e="array");var o,u=m("categoryorder",e);u==="array"&&(o=m("categoryarray")),l||u!=="array"||(u=d.categoryorder="trace"),u==="trace"?d._initialCategories=[]:u==="array"?d._initialCategories=o.slice():(o=function(s,i){var c,n,a,g=i.dataAttr||s._id.charAt(0),p={};if(i.axData)c=i.axData;else for(c=[],n=0;n<i.data.length;n++){var y=i.data[n];y[g+"axis"]===s._id&&c.push(y)}for(n=0;n<c.length;n++){var v=c[n][g];for(a=0;a<v.length;a++){var b=v[a];b!=null&&(p[b]=1)}}return Object.keys(p)}(d,h).sort(),u==="category ascending"?d._initialCategories=o:u==="category descending"&&(d._initialCategories=o.reverse()))}}},{}],844:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../constants/numerical"),h=m.ONEDAY,e=m.ONEWEEK;B.dtick=function(f,l){var o=l==="log",u=l==="date",s=l==="category",i=u?h:1;if(!f)return i;if(t(f))return(f=Number(f))<=0?i:s?Math.max(1,Math.round(f)):u?Math.max(.1,f):f;if(typeof f!="string"||!u&&!o)return i;var c=f.charAt(0),n=f.substr(1);return(n=t(n)?Number(n):0)<=0||!(u&&c==="M"&&n===Math.round(n)||o&&c==="L"||o&&c==="D"&&(n===1||n===2))?i:f},B.tick0=function(f,l,o,u){return l==="date"?d.cleanDate(f,d.dateTick0(o,u%e==0?1:0)):u!=="D1"&&u!=="D2"?t(f)?Number(f):0:void 0}},{"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],845:[function(r,I,B){var t=r("../../lib/regex").counter;I.exports={idRegex:{x:t("x","( domain)?"),y:t("y","( domain)?")},attrRegex:t("[xy]axis"),xAxisMatch:t("xaxis"),yAxisMatch:t("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":804}],846:[function(r,I,B){var t=r("../../lib"),d=r("./autorange"),m=r("./axis_ids").id2name,h=r("./layout_attributes"),e=r("./scale_zoom"),f=r("./set_convert"),l=r("../../constants/numerical").ALMOST_EQUAL,o=r("../../constants/alignment").FROM_BL;function u(p,y,v){var b=v.axIds,x=v.layoutOut,T=v.hasImage,A=x._axisConstraintGroups,S=x._axisMatchGroups,w=y._id,E=w.charAt(0),k=((x._splomAxes||{})[E]||{})[w]||{},L=y._id,M=L.charAt(0)==="x";function P(ee,J){return t.coerce(p,y,h,ee,J)}y._matchGroup=null,y._constraintGroup=null,P("constrain",T?"domain":"range"),t.coerce(p,y,{constraintoward:{valType:"enumerated",values:M?["left","center","right"]:["bottom","middle","top"],dflt:M?"center":"middle"}},"constraintoward");var D,N,U=y.type,G=[];for(D=0;D<b.length;D++)(N=b[D])!==L&&x[m(N)].type===U&&G.push(N);var X=i(A,L);if(X){var K=[];for(D=0;D<G.length;D++)X[N=G[D]]||K.push(N);G=K}var Z,H,Y=G.length;Y&&(p.matches||k.matches)&&(Z=t.coerce(p,y,{matches:{valType:"enumerated",values:G,dflt:G.indexOf(k.matches)!==-1?k.matches:void 0}},"matches"));var $=T&&!M?y.anchor:void 0;if(Y&&!Z&&(p.scaleanchor||$)&&(H=t.coerce(p,y,{scaleanchor:{valType:"enumerated",values:G}},"scaleanchor",$)),Z){y._matchGroup=c(S,L,Z,1);var z=x[m(Z)],j=s(x,y)/s(x,z);M!==(Z.charAt(0)==="x")&&(j=(M?"x":"y")+j),c(A,L,Z,j)}else p.matches&&b.indexOf(p.matches)!==-1&&t.warn("ignored "+y._name+'.matches: "'+p.matches+'" to avoid an infinite loop');if(H){var W=P("scaleratio");W||(W=y.scaleratio=1),c(A,L,H,W)}else p.scaleanchor&&b.indexOf(p.scaleanchor)!==-1&&t.warn("ignored "+y._name+'.scaleanchor: "'+p.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function s(p,y){var v=y.domain;return v||(v=p[m(y.overlaying)].domain),v[1]-v[0]}function i(p,y){for(var v=0;v<p.length;v++)if(p[v][y])return p[v];return null}function c(p,y,v,b){var x,T,A,S,w,E=i(p,y);E===null?((E={})[y]=1,w=p.length,p.push(E)):w=p.indexOf(E);var k=Object.keys(E);for(x=0;x<p.length;x++)if(A=p[x],x!==w&&A[v]){var L=A[v];for(T=0;T<k.length;T++)A[S=k[T]]=n(L,n(b,E[S]));return void p.splice(w,1)}if(b!==1)for(T=0;T<k.length;T++){var M=k[T];E[M]=n(b,E[M])}E[v]=1}function n(p,y){var v,b,x="",T="";typeof p=="string"&&(v=(x=p.match(/^[xy]*/)[0]).length,p=+p.substr(v)),typeof y=="string"&&(b=(T=y.match(/^[xy]*/)[0]).length,y=+y.substr(b));var A=p*y;return v||b?v&&b&&x.charAt(0)!==T.charAt(0)?v===b?A:(v>b?x.substr(b):T.substr(v))+A:x+T+p*y:A}function a(p,y){for(var v=y._size,b=v.h/v.w,x={},T=Object.keys(p),A=0;A<T.length;A++){var S=T[A],w=p[S];if(typeof w=="string"){var E=w.match(/^[xy]*/)[0],k=E.length;w=+w.substr(k);for(var L=E.charAt(0)==="y"?b:1/b,M=0;M<k;M++)w*=L}x[S]=w}return x}function g(p,y){var v=p._inputDomain,b=o[p.constraintoward],x=v[0]+(v[1]-v[0])*b;p.domain=p._input.domain=[x+(v[0]-x)/y,x+(v[1]-x)/y],p.setScale()}B.handleDefaults=function(p,y,v){var b,x,T,A,S,w,E,k,L=v.axIds,M=v.axHasImage,P=y._axisConstraintGroups=[],D=y._axisMatchGroups=[];for(b=0;b<L.length;b++)u(S=p[A=m(L[b])],w=y[A],{axIds:L,layoutOut:y,hasImage:M[A]});function N(z,j){for(b=0;b<z.length;b++)for(T in x=z[b])y[m(T)][j]=x}for(N(D,"_matchGroup"),b=0;b<P.length;b++)for(T in x=P[b])if((w=y[m(T)]).fixedrange){for(var U in x){var G=m(U);(p[G]||{}).fixedrange===!1&&t.warn("fixedrange was specified as false for axis "+G+" but was overridden because another axis in its constraint group has fixedrange true"),y[G].fixedrange=!0}break}for(b=0;b<P.length;){for(T in x=P[b]){(w=y[m(T)])._matchGroup&&Object.keys(w._matchGroup).length===Object.keys(x).length&&(P.splice(b,1),b--);break}b++}N(P,"_constraintGroup");var X=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],K=!1,Z=!1;function H(){k=w[E],E==="rangebreaks"&&(Z=w._hasDayOfWeekBreaks)}for(b=0;b<D.length;b++){x=D[b];for(var Y=0;Y<X.length;Y++){var $;for(T in E=X[Y],k=null,x)if(S=p[A=m(T)],w=y[A],E in w){if(!w.matches&&($=w,E in S)){H();break}k===null&&E in S&&H()}if(E==="range"&&k&&(K=!0),E==="autorange"&&k===null&&K&&(k=!1),k===null&&E in $&&(k=$[E]),k!==null)for(T in x)(w=y[m(T)])[E]=E==="range"?k.slice():k,E==="rangebreaks"&&(w._hasDayOfWeekBreaks=Z,f(w,y))}}},B.enforce=function(p){var y,v,b,x,T,A,S,w,E=p._fullLayout,k=E._axisConstraintGroups||[];for(y=0;y<k.length;y++){b=a(k[y],E);var L=Object.keys(b),M=1/0,P=0,D=1/0,N={},U={},G=!1;for(v=0;v<L.length;v++)U[x=L[v]]=T=E[m(x)],T._inputDomain?T.domain=T._inputDomain.slice():T._inputDomain=T.domain.slice(),T._inputRange||(T._inputRange=T.range.slice()),T.setScale(),N[x]=A=Math.abs(T._m)/b[x],M=Math.min(M,A),T.constrain!=="domain"&&T._constraintShrinkable||(D=Math.min(D,A)),delete T._constraintShrinkable,P=Math.max(P,A),T.constrain==="domain"&&(G=!0);if(!(M>l*P)||G){for(v=0;v<L.length;v++)if(A=N[x=L[v]],S=(T=U[x]).constrain,A!==D||S==="domain")if(w=A/D,S==="range")e(T,w);else{var X=T._inputDomain,K=(T.domain[1]-T.domain[0])/(X[1]-X[0]),Z=(T.r2l(T.range[1])-T.r2l(T.range[0]))/(T.r2l(T._inputRange[1])-T.r2l(T._inputRange[0]));if((w/=K)*Z<1){T.domain=T._input.domain=X.slice(),e(T,w);continue}if(Z<1&&(T.range=T._input.range=T._inputRange.slice(),w*=Z),T.autorange){var H=T.r2l(T.range[0]),Y=T.r2l(T.range[1]),$=(H+Y)/2,z=$,j=$,W=Math.abs(Y-$),ee=$-W*w*1.0001,J=$+W*w*1.0001,Q=d.makePadFn(E,T,0),te=d.makePadFn(E,T,1);g(T,w);var ie,ae,he=Math.abs(T._m),se=d.concatExtremes(p,T),de=se.min,ue=se.max;for(ae=0;ae<de.length;ae++)(ie=de[ae].val-Q(de[ae])/he)>ee&&ie<z&&(z=ie);for(ae=0;ae<ue.length;ae++)(ie=ue[ae].val+te(ue[ae])/he)<J&&ie>j&&(j=ie);w/=(j-z)/(2*W),z=T.l2r(z),j=T.l2r(j),T.range=T._input.range=H<Y?[z,j]:[j,z]}g(T,w)}}}},B.getAxisGroup=function(p,y){for(var v=p._axisMatchGroups,b=0;b<v.length;b++)if(v[b][y])return"g"+b;return y},B.clean=function(p,y){if(y._inputDomain){for(var v=!1,b=y._id,x=p._fullLayout._axisConstraintGroups,T=0;T<x.length;T++)if(x[T][b]){v=!0;break}v&&y.constrain==="domain"||(y._input.domain=y.domain=y._inputDomain,delete y._inputDomain)}}},{"../../constants/alignment":755,"../../constants/numerical":763,"../../lib":787,"./autorange":837,"./axis_ids":842,"./layout_attributes":853,"./scale_zoom":857,"./set_convert":859}],847:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=d.numberFormat,h=r("tinycolor2"),e=r("has-passive-events"),f=r("../../registry"),l=d.strTranslate,o=r("../../lib/svg_text_utils"),u=r("../../components/color"),s=r("../../components/drawing"),i=r("../../components/fx"),c=r("./axes"),n=r("../../lib/setcursor"),a=r("../../components/dragelement"),g=r("../../components/dragelement/helpers"),p=g.selectingOrDrawing,y=g.freeMode,v=r("../../constants/alignment").FROM_TL,b=r("../../lib/clear_gl_canvases"),x=r("../../plot_api/subroutines").redrawReglTraces,T=r("../plots"),A=r("./axis_ids").getFromId,S=r("./select").prepSelect,w=r("./select").clearSelect,E=r("./select").selectOnClick,k=r("./scale_zoom"),L=r("./constants"),M=L.MINDRAG,P=L.MINZOOM,D=!0;function N(ie,ae,he,se){var de=d.ensureSingle(ie.draglayer,ae,he,function(ue){ue.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",ie.id)});return de.call(n,se),de.node()}function U(ie,ae,he,se,de,ue,ve){var ke=N(ie,"rect",ae,he);return t.select(ke).call(s.setRect,se,de,ue,ve),ke}function G(ie,ae){for(var he=0;he<ie.length;he++)if(!ie[he].fixedrange)return ae;return""}function X(ie,ae,he,se,de){for(var ue=0;ue<ie.length;ue++){var ve=ie[ue];if(!ve.fixedrange)if(ve.rangebreaks){var ke=ve._id.charAt(0)==="y",Ee=ke?1-ae:ae,be=ke?1-he:he;se[ve._name+".range[0]"]=ve.l2r(ve.p2l(Ee*ve._length)),se[ve._name+".range[1]"]=ve.l2r(ve.p2l(be*ve._length))}else{var xe=ve._rl[0],ce=ve._rl[1]-xe;se[ve._name+".range[0]"]=ve.l2r(xe+ce*ae),se[ve._name+".range[1]"]=ve.l2r(xe+ce*he)}}if(de&&de.length){var ge=(ae+(1-he))/2;X(de,ge,1-ge,se,[])}}function K(ie,ae){for(var he=0;he<ie.length;he++){var se=ie[he];if(!se.fixedrange)if(se.rangebreaks){var de=se._length,ue=(se.p2l(0+ae)-se.p2l(0)+(se.p2l(de+ae)-se.p2l(de)))/2;se.range=[se.l2r(se._rl[0]-ue),se.l2r(se._rl[1]-ue)]}else se.range=[se.l2r(se._rl[0]-ae/se._m),se.l2r(se._rl[1]-ae/se._m)]}}function Z(ie){return 1-(ie>=0?Math.min(ie,.9):1/(1/Math.max(ie,-.3)+3.222))}function H(ie,ae,he,se,de){return ie.append("path").attr("class","zoombox").style({fill:ae>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",l(he,se)).attr("d",de+"Z")}function Y(ie,ae,he){return ie.append("path").attr("class","zoombox-corners").style({fill:u.background,stroke:u.defaultLine,"stroke-width":1,opacity:0}).attr("transform",l(ae,he)).attr("d","M0,0Z")}function $(ie,ae,he,se,de,ue){ie.attr("d",se+"M"+he.l+","+he.t+"v"+he.h+"h"+he.w+"v-"+he.h+"h-"+he.w+"Z"),z(ie,ae,de,ue)}function z(ie,ae,he,se){he||(ie.transition().style("fill",se>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ae.transition().style("opacity",1).duration(200))}function j(ie){t.select(ie).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function W(ie){D&&ie.data&&ie._context.showTips&&(d.notifier(d._(ie,"Double-click to zoom back out"),"long"),D=!1)}function ee(ie){var ae=Math.floor(Math.min(ie.b-ie.t,ie.r-ie.l,P)/2);return"M"+(ie.l-3.5)+","+(ie.t-.5+ae)+"h3v"+-ae+"h"+ae+"v-3h-"+(ae+3)+"ZM"+(ie.r+3.5)+","+(ie.t-.5+ae)+"h-3v"+-ae+"h"+-ae+"v-3h"+(ae+3)+"ZM"+(ie.r+3.5)+","+(ie.b+.5-ae)+"h-3v"+ae+"h"+-ae+"v3h"+(ae+3)+"ZM"+(ie.l-3.5)+","+(ie.b+.5-ae)+"h3v"+ae+"h"+ae+"v3h-"+(ae+3)+"Z"}function J(ie,ae,he,se,de){for(var ue,ve,ke,Ee,be=!1,xe={},ce={},ge=(de||{}).xaHash,we=(de||{}).yaHash,Me=0;Me<ae.length;Me++){var Se=ae[Me];for(ue in he)if(Se[ue]){for(ke in Se)de&&(ge[ke]||we[ke])||(ke.charAt(0)==="x"?he:se)[ke]||(xe[ke]=ue);for(ve in se)de&&(ge[ve]||we[ve])||!Se[ve]||(be=!0)}for(ve in se)if(Se[ve])for(Ee in Se)de&&(ge[Ee]||we[Ee])||(Ee.charAt(0)==="x"?he:se)[Ee]||(ce[Ee]=ve)}be&&(d.extendFlat(xe,ce),ce={});var ze={},Fe=[];for(ke in xe){var Ye=A(ie,ke);Fe.push(Ye),ze[Ye._id]=Ye}var rt={},Oe=[];for(Ee in ce){var je=A(ie,Ee);Oe.push(je),rt[je._id]=je}return{xaHash:ze,yaHash:rt,xaxes:Fe,yaxes:Oe,xLinks:xe,yLinks:ce,isSubplotConstrained:be}}function Q(ie,ae){if(e){var he=ie.onwheel!==void 0?"wheel":"mousewheel";ie._onwheel&&ie.removeEventListener(he,ie._onwheel),ie._onwheel=ae,ie.addEventListener(he,ae,{passive:!1})}else ie.onwheel!==void 0?ie.onwheel=ae:ie.onmousewheel!==void 0?ie.onmousewheel=ae:ie.isAddedWheelEvent||(ie.isAddedWheelEvent=!0,ie.addEventListener("wheel",ae,{passive:!1}))}function te(ie){var ae=[];for(var he in ie)ae.push(ie[he]);return ae}I.exports={makeDragBox:function(ie,ae,he,se,de,ue,ve,ke){var Ee,be,xe,ce,ge,we,Me,Se,ze,Fe,Ye,rt,Oe,je,We,qe,et,st,ct,Pt,kt,at,tt,_t=ie._fullLayout._zoomlayer,er=ve+ke==="nsew",tr=(ve+ke).length===1;function Ue(){if(Ee=ae.xaxis,be=ae.yaxis,ze=Ee._length,Fe=be._length,Me=Ee._offset,Se=be._offset,(xe={})[Ee._id]=Ee,(ce={})[be._id]=be,ve&&ke)for(var ur=ae.overlays,pr=0;pr<ur.length;pr++){var br=ur[pr].xaxis;xe[br._id]=br;var Rr=ur[pr].yaxis;ce[Rr._id]=Rr}ge=te(xe),we=te(ce),Oe=G(ge,ke),je=G(we,ve),We=!je&&!Oe,rt=J(ie,ie._fullLayout._axisMatchGroups,xe,ce);var _r=(Ye=J(ie,ie._fullLayout._axisConstraintGroups,xe,ce,rt)).isSubplotConstrained||rt.isSubplotConstrained;qe=ke||_r,et=ve||_r;var jr=ie._fullLayout;st=jr._has("scattergl"),ct=jr._has("splom"),Pt=jr._has("svg")}Ue();var He=function(ur,pr,br){return ur?ur==="nsew"?br?"":pr==="pan"?"move":"crosshair":ur.toLowerCase()+"-resize":"pointer"}(je+Oe,ie._fullLayout.dragmode,er),Be=U(ae,ve+ke+"drag",He,he,se,de,ue);if(We&&!er)return Be.onmousedown=null,Be.style.pointerEvents="none",Be;var Ke,_e,Ce,Le,Pe,Xe,ht,Mt,pt,Lt,vt={element:Be,gd:ie,plotinfo:ae};function Dt(){vt.plotinfo.selection=!1,w(ie)}function xt(ur,pr){var br=vt.gd;if(br._fullLayout._activeShapeIndex>=0)br._fullLayout._deactivateShape(br);else{var Rr=br._fullLayout.clickmode;if(j(br),ur!==2||tr||ir(),er)Rr.indexOf("select")>-1&&E(pr,br,ge,we,ae.id,vt),Rr.indexOf("event")>-1&&i.click(br,pr,ae.id);else if(ur===1&&tr){var _r=ve?be:Ee,jr=ve==="s"||ke==="w"?0:1,$r=_r._name+".range["+jr+"]",pn=function(Sn,an){var Nr,Pr=Sn.range[an],en=Math.abs(Pr-Sn.range[1-an]);return Sn.type==="date"?Pr:Sn.type==="log"?(Nr=Math.ceil(Math.max(0,-Math.log(en)/Math.LN10))+3,m("."+Nr+"g")(Math.pow(10,Pr))):(Nr=Math.floor(Math.log(Math.abs(Pr))/Math.LN10)-Math.floor(Math.log(en)/Math.LN10)+4,m("."+String(Nr)+"g")(Pr))}(_r,jr),In="left",On="middle";if(_r.fixedrange)return;ve?(On=ve==="n"?"top":"bottom",_r.side==="right"&&(In="right")):ke==="e"&&(In="right"),br._context.showAxisRangeEntryBoxes&&t.select(Be).call(o.makeEditable,{gd:br,immediate:!0,background:br._fullLayout.paper_bgcolor,text:String(pn),fill:_r.tickfont?_r.tickfont.color:"#444",horizontalAlign:In,verticalAlign:On}).on("edit",function(Sn){var an=_r.d2r(Sn);an!==void 0&&f.call("_guiRelayout",br,$r,an)})}}}function it(ur,pr){if(ie._transitioningWithDuration)return!1;var br=Math.max(0,Math.min(ze,at*ur+Ke)),Rr=Math.max(0,Math.min(Fe,tt*pr+_e)),_r=Math.abs(br-Ke),jr=Math.abs(Rr-_e);function $r(){ht="",Ce.r=Ce.l,Ce.t=Ce.b,pt.attr("d","M0,0Z")}if(Ce.l=Math.min(Ke,br),Ce.r=Math.max(Ke,br),Ce.t=Math.min(_e,Rr),Ce.b=Math.max(_e,Rr),Ye.isSubplotConstrained)_r>P||jr>P?(ht="xy",_r/ze>jr/Fe?(jr=_r*Fe/ze,_e>Rr?Ce.t=_e-jr:Ce.b=_e+jr):(_r=jr*ze/Fe,Ke>br?Ce.l=Ke-_r:Ce.r=Ke+_r),pt.attr("d",ee(Ce))):$r();else if(rt.isSubplotConstrained)if(_r>P||jr>P){ht="xy";var pn=Math.min(Ce.l/ze,(Fe-Ce.b)/Fe),In=Math.max(Ce.r/ze,(Fe-Ce.t)/Fe);Ce.l=pn*ze,Ce.r=In*ze,Ce.b=(1-pn)*Fe,Ce.t=(1-In)*Fe,pt.attr("d",ee(Ce))}else $r();else!je||jr<Math.min(Math.max(.6*_r,M),P)?_r<M||!Oe?$r():(Ce.t=0,Ce.b=Fe,ht="x",pt.attr("d",function(On,Sn){return"M"+(On.l-.5)+","+(Sn-P-.5)+"h-3v"+(2*P+1)+"h3ZM"+(On.r+.5)+","+(Sn-P-.5)+"h3v"+(2*P+1)+"h-3Z"}(Ce,_e))):!Oe||_r<Math.min(.6*jr,P)?(Ce.l=0,Ce.r=ze,ht="y",pt.attr("d",function(On,Sn){return"M"+(Sn-P-.5)+","+(On.t-.5)+"v-3h"+(2*P+1)+"v3ZM"+(Sn-P-.5)+","+(On.b+.5)+"v3h"+(2*P+1)+"v-3Z"}(Ce,Ke))):(ht="xy",pt.attr("d",ee(Ce)));Ce.w=Ce.r-Ce.l,Ce.h=Ce.b-Ce.t,ht&&(Lt=!0),ie._dragged=Lt,$(Mt,pt,Ce,Pe,Xe,Le),St(),ie.emit("plotly_relayouting",kt),Xe=!0}function St(){kt={},ht!=="xy"&&ht!=="x"||(X(ge,Ce.l/ze,Ce.r/ze,kt,Ye.xaxes),Ot("x",kt)),ht!=="xy"&&ht!=="y"||(X(we,(Fe-Ce.b)/Fe,(Fe-Ce.t)/Fe,kt,Ye.yaxes),Ot("y",kt))}function Nt(){St(),j(ie),Xt(),W(ie)}vt.prepFn=function(ur,pr,br){var Rr=vt.dragmode,_r=ie._fullLayout.dragmode;_r!==Rr&&(vt.dragmode=_r),Ue(),at=ie._fullLayout._invScaleX,tt=ie._fullLayout._invScaleY,We||(er?ur.shiftKey?_r==="pan"?_r="zoom":p(_r)||(_r="pan"):ur.ctrlKey&&(_r="pan"):_r="pan"),y(_r)?vt.minDrag=1:vt.minDrag=void 0,p(_r)?(vt.xaxes=ge,vt.yaxes=we,S(ur,pr,br,vt,_r)):(vt.clickFn=xt,p(Rr)&&Dt(),We||(_r==="zoom"?(vt.moveFn=it,vt.doneFn=Nt,vt.minDrag=1,function(jr,$r,pn){var In=Be.getBoundingClientRect();Ke=$r-In.left,_e=pn-In.top,ie._fullLayout._calcInverseTransform(ie);var On=d.apply3DTransform(ie._fullLayout._invTransform)(Ke,_e);Ke=On[0],_e=On[1],Ce={l:Ke,r:Ke,w:0,t:_e,b:_e,h:0},Le=ie._hmpixcount?ie._hmlumcount/ie._hmpixcount:h(ie._fullLayout.plot_bgcolor).getLuminance(),Xe=!1,ht="xy",Lt=!1,Mt=H(_t,Le,Me,Se,Pe="M0,0H"+ze+"V"+Fe+"H0V0"),pt=Y(_t,Me,Se)}(0,pr,br)):_r==="pan"&&(vt.moveFn=wt,vt.doneFn=Xt))),ie._fullLayout._redrag=function(){var jr=ie._dragdata;if(jr&&jr.element===Be){var $r=ie._fullLayout.dragmode;p($r)||(Ue(),Kt([0,0,ze,Fe]),vt.moveFn(jr.dx,jr.dy))}}},a.init(vt);var Ut=[0,0,ze,Fe],Qt=null,Ie=L.REDRAWDELAY,lt=ae.mainplot?ie._fullLayout._plots[ae.mainplot]:ae;function wt(ur,pr){if(ur*=at,pr*=tt,!ie._transitioningWithDuration){if(ie._fullLayout._replotting=!0,Oe==="ew"||je==="ns"){var br=Oe?-ur:0,Rr=je?-pr:0;if(rt.isSubplotConstrained){if(Oe&&je){var _r=(ur/ze-pr/Fe)/2;br=-(ur=_r*ze),Rr=-(pr=-_r*Fe)}je?br=-Rr*ze/Fe:Rr=-br*Fe/ze}return Oe&&(K(ge,ur),Ot("x")),je&&(K(we,pr),Ot("y")),Kt([br,Rr,ze,Fe]),Gt(),void ie.emit("plotly_relayouting",kt)}var jr,$r,pn=Oe==="w"==(je==="n")?1:-1;if(Oe&&je&&(Ye.isSubplotConstrained||rt.isSubplotConstrained)){var In=(ur/ze+pn*pr/Fe)/2;ur=In*ze,pr=pn*In*Fe}if(Oe==="w"?ur=Nr(ge,0,ur):Oe==="e"?ur=Nr(ge,1,-ur):Oe||(ur=0),je==="n"?pr=Nr(we,1,pr):je==="s"?pr=Nr(we,0,-pr):je||(pr=0),jr=Oe==="w"?ur:0,$r=je==="n"?pr:0,Ye.isSubplotConstrained&&!rt.isSubplotConstrained||rt.isSubplotConstrained&&Oe&&je&&pn>0){var On;if(rt.isSubplotConstrained||!Oe&&je.length===1){for(On=0;On<ge.length;On++)ge[On].range=ge[On]._r.slice(),k(ge[On],1-pr/Fe);jr=(ur=pr*ze/Fe)/2}if(rt.isSubplotConstrained||!je&&Oe.length===1){for(On=0;On<we.length;On++)we[On].range=we[On]._r.slice(),k(we[On],1-ur/ze);$r=(pr=ur*Fe/ze)/2}}rt.isSubplotConstrained&&je||Ot("x"),rt.isSubplotConstrained&&Oe||Ot("y");var Sn=ze-ur,an=Fe-pr;!rt.isSubplotConstrained||Oe&&je||(Oe?($r=jr?0:ur*Fe/ze,an=Sn*Fe/ze):(jr=$r?0:pr*ze/Fe,Sn=an*ze/Fe)),Kt([jr,$r,Sn,an]),Gt(),ie.emit("plotly_relayouting",kt)}function Nr(Pr,en,tn){for(var Qr,rn,An=1-en,En=0;En<Pr.length;En++){var Bn=Pr[En];if(!Bn.fixedrange){Qr=Bn,rn=Bn._rl[An]+(Bn._rl[en]-Bn._rl[An])/Z(tn/Bn._length);var Jt=Bn.l2r(rn);Jt!==!1&&Jt!==void 0&&(Bn.range[en]=Jt)}}return Qr._length*(Qr._rl[en]-rn)/(Qr._rl[en]-Qr._rl[An])}}function Ot(ur,pr){for(var br=rt.isSubplotConstrained?{x:we,y:ge}[ur]:rt[ur+"axes"],Rr=rt.isSubplotConstrained?{x:ge,y:we}[ur]:[],_r=0;_r<br.length;_r++){var jr=br[_r],$r=jr._id,pn=rt.xLinks[$r]||rt.yLinks[$r],In=Rr[0]||xe[pn]||ce[pn];In&&(pr?(pr[jr._name+".range[0]"]=pr[In._name+".range[0]"],pr[jr._name+".range[1]"]=pr[In._name+".range[1]"]):jr.range=In.range.slice())}}function Gt(){var ur,pr=[];function br(jr){for(ur=0;ur<jr.length;ur++)jr[ur].fixedrange||pr.push(jr[ur]._id)}for(qe&&(br(ge),br(Ye.xaxes),br(rt.xaxes)),et&&(br(we),br(Ye.yaxes),br(rt.yaxes)),kt={},ur=0;ur<pr.length;ur++){var Rr=pr[ur],_r=A(ie,Rr);c.drawOne(ie,_r,{skipTitle:!0}),kt[_r._name+".range[0]"]=_r.range[0],kt[_r._name+".range[1]"]=_r.range[1]}c.redrawComponents(ie,pr)}function ir(){if(!ie._transitioningWithDuration){var ur=ie._context.doubleClick,pr=[];Oe&&(pr=pr.concat(ge)),je&&(pr=pr.concat(we)),rt.xaxes&&(pr=pr.concat(rt.xaxes)),rt.yaxes&&(pr=pr.concat(rt.yaxes));var br,Rr,_r,jr={};if(ur==="reset+autosize"){for(ur="autosize",Rr=0;Rr<pr.length;Rr++)if((br=pr[Rr])._rangeInitial&&(br.range[0]!==br._rangeInitial[0]||br.range[1]!==br._rangeInitial[1])||!br._rangeInitial&&!br.autorange){ur="reset";break}}if(ur==="autosize")for(Rr=0;Rr<pr.length;Rr++)(br=pr[Rr]).fixedrange||(jr[br._name+".autorange"]=!0);else if(ur==="reset")for((Oe||Ye.isSubplotConstrained)&&(pr=pr.concat(Ye.xaxes)),je&&!Ye.isSubplotConstrained&&(pr=pr.concat(Ye.yaxes)),Ye.isSubplotConstrained&&(Oe?je||(pr=pr.concat(we)):pr=pr.concat(ge)),Rr=0;Rr<pr.length;Rr++)(br=pr[Rr]).fixedrange||(br._rangeInitial?(_r=br._rangeInitial,jr[br._name+".range[0]"]=_r[0],jr[br._name+".range[1]"]=_r[1]):jr[br._name+".autorange"]=!0);ie.emit("plotly_doubleclick",null),f.call("_guiRelayout",ie,jr)}}function Xt(){Kt([0,0,ze,Fe]),d.syncOrAsync([T.previousPromises,function(){ie._fullLayout._replotting=!1,f.call("_guiRelayout",ie,kt)}],ie)}function Kt(ur){var pr,br,Rr,_r,jr=ie._fullLayout,$r=jr._plots,pn=jr._subplots.cartesian;if(ct&&f.subplotsRegistry.splom.drag(ie),st){for(pr=0;pr<pn.length;pr++)if(Rr=(br=$r[pn[pr]]).xaxis,_r=br.yaxis,br._scene){var In=d.simpleMap(Rr.range,Rr.r2l),On=d.simpleMap(_r.range,_r.r2l);br._scene.update({range:[In[0],On[0],In[1],On[1]]})}}if((ct||st)&&(b(ie),x(ie)),Pt){var Sn=ur[2]/Ee._length,an=ur[3]/be._length;for(pr=0;pr<pn.length;pr++){Rr=(br=$r[pn[pr]]).xaxis,_r=br.yaxis;var Nr,Pr,en,tn,Qr=(qe||rt.isSubplotConstrained)&&!Rr.fixedrange&&xe[Rr._id],rn=(et||rt.isSubplotConstrained)&&!_r.fixedrange&&ce[_r._id];if(Qr?(Nr=Sn,en=ke||rt.isSubplotConstrained?ur[0]:vr(Rr,Nr)):rt.xaHash[Rr._id]?(Nr=Sn,en=ur[0]*Rr._length/Ee._length):rt.yaHash[Rr._id]?(Nr=an,en=je==="ns"?-ur[1]*Rr._length/be._length:vr(Rr,Nr,{n:"top",s:"bottom"}[je])):en=dr(Rr,Nr=or(Rr,Sn,an)),rn?(Pr=an,tn=ve||rt.isSubplotConstrained?ur[1]:vr(_r,Pr)):rt.yaHash[_r._id]?(Pr=an,tn=ur[1]*_r._length/be._length):rt.xaHash[_r._id]?(Pr=Sn,tn=Oe==="ew"?-ur[0]*_r._length/Ee._length:vr(_r,Pr,{e:"right",w:"left"}[Oe])):tn=dr(_r,Pr=or(_r,Sn,an)),Nr||Pr){Nr||(Nr=1),Pr||(Pr=1);var An=Rr._offset-en/Nr,En=_r._offset-tn/Pr;br.clipRect.call(s.setTranslate,en,tn).call(s.setScale,Nr,Pr),br.plot.call(s.setTranslate,An,En).call(s.setScale,1/Nr,1/Pr),Nr===br.xScaleFactor&&Pr===br.yScaleFactor||(s.setPointGroupScale(br.zoomScalePts,Nr,Pr),s.setTextPointsScale(br.zoomScaleTxt,Nr,Pr)),s.hideOutsideRangePoints(br.clipOnAxisFalseTraces,br),br.xScaleFactor=Nr,br.yScaleFactor=Pr}}}}function or(ur,pr,br){return ur.fixedrange?0:qe&&Ye.xaHash[ur._id]?pr:et&&(Ye.isSubplotConstrained?Ye.xaHash:Ye.yaHash)[ur._id]?br:0}function dr(ur,pr){return pr?(ur.range=ur._r.slice(),k(ur,pr),vr(ur,pr)):0}function vr(ur,pr,br){return ur._length*(1-pr)*v[br||ur.constraintoward||"middle"]}return ve.length*ke.length!=1&&Q(Be,function(ur){if(ie._context._scrollZoom.cartesian||ie._fullLayout._enablescrollzoom){if(Dt(),ie._transitioningWithDuration)return ur.preventDefault(),void ur.stopPropagation();Ue(),clearTimeout(Qt);var pr=-ur.deltaY;if(isFinite(pr)||(pr=ur.wheelDelta/10),isFinite(pr)){var br,Rr=Math.exp(-Math.min(Math.max(pr,-20),20)/200),_r=lt.draglayer.select(".nsewdrag").node().getBoundingClientRect(),jr=(ur.clientX-_r.left)/_r.width,$r=(_r.bottom-ur.clientY)/_r.height;if(qe){for(ke||(jr=.5),br=0;br<ge.length;br++)pn(ge[br],jr,Rr);Ot("x"),Ut[2]*=Rr,Ut[0]+=Ut[2]*jr*(1/Rr-1)}if(et){for(ve||($r=.5),br=0;br<we.length;br++)pn(we[br],$r,Rr);Ot("y"),Ut[3]*=Rr,Ut[1]+=Ut[3]*(1-$r)*(1/Rr-1)}Kt(Ut),Gt(),ie.emit("plotly_relayouting",kt),Qt=setTimeout(function(){ie._fullLayout&&(Ut=[0,0,ze,Fe],Xt())},Ie),ur.preventDefault()}else d.log("Did not find wheel motion attributes: ",ur)}function pn(In,On,Sn){if(!In.fixedrange){var an=d.simpleMap(In.range,In.r2l),Nr=an[0]+(an[1]-an[0])*On;In.range=an.map(function(Pr){return In.l2r(Nr+(Pr-Nr)*Sn)})}}}),Be},makeDragger:N,makeRectDragger:U,makeZoombox:H,makeCorners:Y,updateZoombox:$,xyCorners:ee,transitionZoombox:z,removeZoombox:j,showDoubleClickNotifier:W,attachWheelEventHandler:Q}},{"../../components/color":650,"../../components/dragelement":669,"../../components/dragelement/helpers":668,"../../components/drawing":672,"../../components/fx":690,"../../constants/alignment":755,"../../lib":787,"../../lib/clear_gl_canvases":771,"../../lib/setcursor":808,"../../lib/svg_text_utils":813,"../../plot_api/subroutines":828,"../../registry":915,"../plots":901,"./axes":838,"./axis_ids":842,"./constants":845,"./scale_zoom":857,"./select":858,"@plotly/d3":58,"has-passive-events":436,tinycolor2:583}],848:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/fx"),m=r("../../components/dragelement"),h=r("../../lib/setcursor"),e=r("./dragbox").makeDragBox,f=r("./constants").DRAGGERSIZE;B.initInteractions=function(l){var o=l._fullLayout;if(l._context.staticPlot)t.select(l).selectAll(".drag").remove();else if(o._has("cartesian")||o._has("splom")){Object.keys(o._plots||{}).sort(function(s,i){if((o._plots[s].mainplot&&!0)===(o._plots[i].mainplot&&!0)){var c=s.split("y"),n=i.split("y");return c[0]===n[0]?Number(c[1]||1)-Number(n[1]||1):Number(c[0]||1)-Number(n[0]||1)}return o._plots[s].mainplot?1:-1}).forEach(function(s){var i=o._plots[s],c=i.xaxis,n=i.yaxis;if(!i.mainplot){var a=e(l,i,c._offset,n._offset,c._length,n._length,"ns","ew");a.onmousemove=function(y){l._fullLayout._rehover=function(){l._fullLayout._hoversubplot===s&&l._fullLayout._plots[s]&&d.hover(l,y,s)},d.hover(l,y,s),l._fullLayout._lasthover=a,l._fullLayout._hoversubplot=s},a.onmouseout=function(y){l._dragging||(l._fullLayout._hoversubplot=null,m.unhover(l,y))},l._context.showAxisDragHandles&&(e(l,i,c._offset-f,n._offset-f,f,f,"n","w"),e(l,i,c._offset+c._length,n._offset-f,f,f,"n","e"),e(l,i,c._offset-f,n._offset+n._length,f,f,"s","w"),e(l,i,c._offset+c._length,n._offset+n._length,f,f,"s","e"))}if(l._context.showAxisDragHandles){if(s===c._mainSubplot){var g=c._mainLinePosition;c.side==="top"&&(g-=f),e(l,i,c._offset+.1*c._length,g,.8*c._length,f,"","ew"),e(l,i,c._offset,g,.1*c._length,f,"","w"),e(l,i,c._offset+.9*c._length,g,.1*c._length,f,"","e")}if(s===n._mainSubplot){var p=n._mainLinePosition;n.side!=="right"&&(p-=f),e(l,i,p,n._offset+.1*n._length,f,.8*n._length,"ns",""),e(l,i,p,n._offset+.9*n._length,f,.1*n._length,"s",""),e(l,i,p,n._offset,f,.1*n._length,"n","")}}});var u=o._hoverlayer.node();u.onmousemove=function(s){s.target=l._fullLayout._lasthover,d.hover(l,s,o._hoversubplot)},u.onclick=function(s){s.target=l._fullLayout._lasthover,d.click(l,s)},u.onmousedown=function(s){l._fullLayout._lasthover.onmousedown(s)},B.updateFx(l)}},B.updateFx=function(l){var o=l._fullLayout,u=o.dragmode==="pan"?"move":"crosshair";h(o._draggers,u)}},{"../../components/dragelement":669,"../../components/fx":690,"../../lib/setcursor":808,"./constants":845,"./dragbox":847,"@plotly/d3":58}],849:[function(r,I,B){I.exports={clearOutlineControllers:function(t){var d=t._fullLayout._zoomlayer;d&&d.selectAll(".outline-controllers").remove()},clearSelect:function(t){var d=t._fullLayout._zoomlayer;d&&d.selectAll(".select-outline").remove(),t._fullLayout._drawing=!1}}},{}],850:[function(r,I,B){var t=r("../../lib").strTranslate;function d(m,h){switch(m.type){case"log":return m.p2d(h);case"date":return m.p2r(h,0,m.calendar);default:return m.p2r(h)}}I.exports={p2r:d,r2p:function(m,h){switch(m.type){case"log":return m.d2p(h);case"date":return m.r2p(h,0,m.calendar);default:return m.r2p(h)}},axValue:function(m){var h=m._id.charAt(0)==="y"?1:0;return function(e){return d(m,e[h])}},getTransform:function(m){return t(m.xaxis._offset,m.yaxis._offset)}}},{"../../lib":787}],851:[function(r,I,B){var t=r("../../registry"),d=r("../../lib"),m=r("./axis_ids");I.exports=function(h){return function(e,f){var l=e[h];if(Array.isArray(l))for(var o=t.subplotsRegistry.cartesian,u=o.idRegex,s=f._subplots,i=s.xaxis,c=s.yaxis,n=s.cartesian,a=f._has("cartesian")||f._has("gl2d"),g=0;g<l.length;g++){var p=l[g];if(d.isPlainObject(p)){var y=m.cleanId(p.xref,"x",!1),v=m.cleanId(p.yref,"y",!1),b=u.x.test(y),x=u.y.test(v);if(b||x){a||d.pushUnique(f._basePlotModules,o);var T=!1;b&&i.indexOf(y)===-1&&(i.push(y),T=!0),x&&c.indexOf(v)===-1&&(c.push(v),T=!0),T&&b&&x&&n.push(y+v)}}}}}},{"../../lib":787,"../../registry":915,"./axis_ids":842}],852:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../registry"),m=r("../../lib"),h=r("../plots"),e=r("../../components/drawing"),f=r("../get_data").getModuleCalcData,l=r("./axis_ids"),o=r("./constants"),u=r("../../constants/xmlns_namespaces"),s=m.ensureSingle;function i(p,y,v){return m.ensureSingle(p,y,v,function(b){b.datum(v)})}function c(p,y,v,b,x){for(var T,A,S,w=o.traceLayerClasses,E=p._fullLayout,k=E._modules,L=[],M=[],P=0;P<k.length;P++){var D=(T=k[P]).name,N=d.modules[D].categories;if(N.svg){var U=T.layerName||D+"layer",G=T.plot;S=(A=f(v,G))[0],v=A[1],S.length&&L.push({i:w.indexOf(U),className:U,plotMethod:G,cdModule:S}),N.zoomScale&&M.push("."+U)}}L.sort(function(Z,H){return Z.i-H.i});var X=y.plot.selectAll("g.mlayer").data(L,function(Z){return Z.className});if(X.enter().append("g").attr("class",function(Z){return Z.className}).classed("mlayer",!0).classed("rangeplot",y.isRangePlot),X.exit().remove(),X.order(),X.each(function(Z){var H=t.select(this),Y=Z.className;Z.plotMethod(p,y,Z.cdModule,H,b,x),o.clipOnAxisFalseQuery.indexOf("."+Y)===-1&&e.setClipUrl(H,y.layerClipId,p)}),E._has("scattergl")&&(T=d.getModule("scattergl"),S=f(v,T)[0],T.plot(p,y,S)),!p._context.staticPlot&&(y._hasClipOnAxisFalse&&(y.clipOnAxisFalseTraces=y.plot.selectAll(o.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),M.length)){var K=y.plot.selectAll(M.join(",")).selectAll(".trace");y.zoomScalePts=K.selectAll("path.point"),y.zoomScaleTxt=K.selectAll(".textpoint")}}function n(p,y){var v=y.plotgroup,b=y.id,x=o.layerValue2layerClass[y.xaxis.layer],T=o.layerValue2layerClass[y.yaxis.layer],A=p._fullLayout._hasOnlyLargeSploms;if(y.mainplot){var S=y.mainplotinfo,w=S.plotgroup,E=b+"-x",k=b+"-y";y.gridlayer=S.gridlayer,y.zerolinelayer=S.zerolinelayer,s(S.overlinesBelow,"path",E),s(S.overlinesBelow,"path",k),s(S.overaxesBelow,"g",E),s(S.overaxesBelow,"g",k),y.plot=s(S.overplot,"g",b),s(S.overlinesAbove,"path",E),s(S.overlinesAbove,"path",k),s(S.overaxesAbove,"g",E),s(S.overaxesAbove,"g",k),y.xlines=w.select(".overlines-"+x).select("."+E),y.ylines=w.select(".overlines-"+T).select("."+k),y.xaxislayer=w.select(".overaxes-"+x).select("."+E),y.yaxislayer=w.select(".overaxes-"+T).select("."+k)}else if(A)y.xlines=s(v,"path","xlines-above"),y.ylines=s(v,"path","ylines-above"),y.xaxislayer=s(v,"g","xaxislayer-above"),y.yaxislayer=s(v,"g","yaxislayer-above");else{var L=s(v,"g","layer-subplot");y.shapelayer=s(L,"g","shapelayer"),y.imagelayer=s(L,"g","imagelayer"),y.gridlayer=s(v,"g","gridlayer"),y.zerolinelayer=s(v,"g","zerolinelayer"),s(v,"path","xlines-below"),s(v,"path","ylines-below"),y.overlinesBelow=s(v,"g","overlines-below"),s(v,"g","xaxislayer-below"),s(v,"g","yaxislayer-below"),y.overaxesBelow=s(v,"g","overaxes-below"),y.plot=s(v,"g","plot"),y.overplot=s(v,"g","overplot"),y.xlines=s(v,"path","xlines-above"),y.ylines=s(v,"path","ylines-above"),y.overlinesAbove=s(v,"g","overlines-above"),s(v,"g","xaxislayer-above"),s(v,"g","yaxislayer-above"),y.overaxesAbove=s(v,"g","overaxes-above"),y.xlines=v.select(".xlines-"+x),y.ylines=v.select(".ylines-"+T),y.xaxislayer=v.select(".xaxislayer-"+x),y.yaxislayer=v.select(".yaxislayer-"+T)}A||(i(y.gridlayer,"g",y.xaxis._id),i(y.gridlayer,"g",y.yaxis._id),y.gridlayer.selectAll("g").map(function(M){return M[0]}).sort(l.idSort)),y.xlines.style("fill","none").classed("crisp",!0),y.ylines.style("fill","none").classed("crisp",!0)}function a(p,y){if(p){var v={};for(var b in p.each(function(S){var w=S[0];t.select(this).remove(),g(w,y),v[w]=!0}),y._plots)for(var x=y._plots[b].overlays||[],T=0;T<x.length;T++){var A=x[T];v[A.id]&&A.plot.selectAll(".trace").remove()}}}function g(p,y){y._draggers.selectAll("g."+p).remove(),y._defs.select("#clip"+y._uid+p+"plot").remove()}B.name="cartesian",B.attr=["xaxis","yaxis"],B.idRoot=["x","y"],B.idRegex=o.idRegex,B.attrRegex=o.attrRegex,B.attributes=r("./attributes"),B.layoutAttributes=r("./layout_attributes"),B.supplyLayoutDefaults=r("./layout_defaults"),B.transitionAxes=r("./transition_axes"),B.finalizeSubplots=function(p,y){var v,b,x,T=y._subplots,A=T.xaxis,S=T.yaxis,w=T.cartesian,E=w.concat(T.gl2d||[]),k={},L={};for(v=0;v<E.length;v++){var M=E[v].split("y");k[M[0]]=1,L["y"+M[1]]=1}for(v=0;v<A.length;v++)k[b=A[v]]||(x=(p[l.id2name(b)]||{}).anchor,o.idRegex.y.test(x)||(x="y"),w.push(b+x),E.push(b+x),L[x]||(L[x]=1,m.pushUnique(S,x)));for(v=0;v<S.length;v++)L[x=S[v]]||(b=(p[l.id2name(x)]||{}).anchor,o.idRegex.x.test(b)||(b="x"),w.push(b+x),E.push(b+x),k[b]||(k[b]=1,m.pushUnique(A,b)));if(!E.length){for(var P in b="",x="",p)o.attrRegex.test(P)&&(P.charAt(0)==="x"?(!b||+P.substr(5)<+b.substr(5))&&(b=P):(!x||+P.substr(5)<+x.substr(5))&&(x=P));b=b?l.name2id(b):"x",x=x?l.name2id(x):"y",A.push(b),S.push(x),w.push(b+x)}},B.plot=function(p,y,v,b){var x,T=p._fullLayout,A=T._subplots.cartesian,S=p.calcdata;if(!Array.isArray(y))for(y=[],x=0;x<S.length;x++)y.push(x);for(x=0;x<A.length;x++){for(var w,E=A[x],k=T._plots[E],L=[],M=0;M<S.length;M++){var P=S[M],D=P[0].trace;D.xaxis+D.yaxis===E&&((y.indexOf(D.index)!==-1||D.carpet)&&(w&&w[0].trace.xaxis+w[0].trace.yaxis===E&&["tonextx","tonexty","tonext"].indexOf(D.fill)!==-1&&L.indexOf(w)===-1&&L.push(w),L.push(P)),w=P)}c(p,k,L,v,b)}},B.clean=function(p,y,v,b){var x,T,A,S=b._plots||{},w=y._plots||{},E=b._subplots||{};if(b._hasOnlyLargeSploms&&!y._hasOnlyLargeSploms)for(A in S)(x=S[A]).plotgroup&&x.plotgroup.remove();var k=b._has&&b._has("gl"),L=y._has&&y._has("gl");if(k&&!L)for(A in S)(x=S[A])._scene&&x._scene.destroy();if(E.xaxis&&E.yaxis){var M=l.listIds({_fullLayout:b});for(T=0;T<M.length;T++){var P=M[T];y[l.id2name(P)]||b._infolayer.selectAll(".g-"+P+"title").remove()}}var D=b._has&&b._has("cartesian"),N=y._has&&y._has("cartesian");if(D&&!N)a(b._cartesianlayer.selectAll(".subplot"),b),b._defs.selectAll(".axesclip").remove(),delete b._axisConstraintGroups,delete b._axisMatchGroups;else if(E.cartesian)for(T=0;T<E.cartesian.length;T++){var U=E.cartesian[T];if(!w[U]){var G="."+U+",."+U+"-x,."+U+"-y";b._cartesianlayer.selectAll(G).remove(),g(U,b)}}},B.drawFramework=function(p){var y=p._fullLayout,v=function(x){var T,A,S,w,E,k,L=x._fullLayout,M=L._subplots.cartesian,P=M.length,D=[],N=[];for(T=0;T<P;T++){S=M[T],w=L._plots[S],E=w.xaxis,k=w.yaxis;var U=E._mainAxis,G=k._mainAxis,X=U._id+G._id,K=L._plots[X];w.overlays=[],X!==S&&K?(w.mainplot=X,w.mainplotinfo=K,N.push(S)):(w.mainplot=void 0,w.mainplotinfo=void 0,D.push(S))}for(T=0;T<N.length;T++)S=N[T],(w=L._plots[S]).mainplotinfo.overlays.push(w);var Z=D.concat(N),H=new Array(P);for(T=0;T<P;T++){S=Z[T],w=L._plots[S],E=w.xaxis,k=w.yaxis;var Y=[S,E.layer,k.layer,E.overlaying||"",k.overlaying||""];for(A=0;A<w.overlays.length;A++)Y.push(w.overlays[A].id);H[T]=Y}return H}(p),b=y._cartesianlayer.selectAll(".subplot").data(v,String);b.enter().append("g").attr("class",function(x){return"subplot "+x[0]}),b.order(),b.exit().call(a,y),b.each(function(x){var T=x[0],A=y._plots[T];A.plotgroup=t.select(this),n(p,A),A.draglayer=s(y._draggers,"g",T)})},B.rangePlot=function(p,y,v){n(p,y),c(p,y,v),h.style(p)},B.toSVG=function(p){var y=p._fullLayout._glimages,v=t.select(p).selectAll(".svg-container");v.filter(function(b,x){return x===v.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var b=this.toDataURL("image/png");y.append("svg:image").attr({xmlns:u.svg,"xlink:href":b,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})})},B.updateFx=r("./graph_interact").updateFx},{"../../components/drawing":672,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../registry":915,"../get_data":875,"../plots":901,"./attributes":836,"./axis_ids":842,"./constants":845,"./graph_interact":848,"./layout_attributes":853,"./layout_defaults":854,"./transition_axes":863,"@plotly/d3":58}],853:[function(r,I,B){var t=r("../font_attributes"),d=r("../../components/color/attributes"),m=r("../../components/drawing/attributes").dash,h=r("../../lib/extend").extendFlat,e=r("../../plot_api/plot_template").templatedArray,f=r("../../plots/cartesian/axis_format_attributes").descriptionWithDates,l=r("../../constants/numerical").ONEDAY,o=r("./constants"),u=o.HOUR_PATTERN,s=o.WEEKDAY_PATTERN;I.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:d.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:t({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[o.idRegex.x.toString(),o.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[o.idRegex.x.toString(),o.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[s,u,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:l},editType:"calc"}),tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:d.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"boolean",dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:h({},m,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:t({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:f("tick label")},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:f("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:d.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:d.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:d.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:d.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",o.idRegex.x.toString(),o.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",o.idRegex.x.toString(),o.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:t({editType:"ticks"})}}},{"../../components/color/attributes":649,"../../components/drawing/attributes":671,"../../constants/numerical":763,"../../lib/extend":777,"../../plot_api/plot_template":827,"../../plots/cartesian/axis_format_attributes":841,"../font_attributes":867,"./constants":845}],854:[function(r,I,B){var t=r("../../lib"),d=r("../../components/color"),m=r("../../components/fx/helpers").isUnifiedHover,h=r("../../components/fx/hovermode_defaults"),e=r("../../plot_api/plot_template"),f=r("../layout_attributes"),l=r("./layout_attributes"),o=r("./type_defaults"),u=r("./axis_defaults"),s=r("./constraints"),i=r("./position_defaults"),c=r("./axis_ids"),n=c.id2name,a=c.name2id,g=r("./constants").AX_ID_PATTERN,p=r("../../registry"),y=p.traceIs,v=p.getComponentMethod;function b(x,T,A){Array.isArray(x[T])?x[T].push(A):x[T]=[A]}I.exports=function(x,T,A){var S,w,E=T.autotypenumbers,k={},L={},M={},P={},D={},N={},U={},G={},X={},K={};for(S=0;S<A.length;S++){var Z=A[S];if(y(Z,"cartesian")||y(Z,"gl2d")){var H,Y;if(Z.xaxis)H=n(Z.xaxis),b(k,H,Z);else if(Z.xaxes)for(w=0;w<Z.xaxes.length;w++)b(k,n(Z.xaxes[w]),Z);if(Z.yaxis)Y=n(Z.yaxis),b(k,Y,Z);else if(Z.yaxes)for(w=0;w<Z.yaxes.length;w++)b(k,n(Z.yaxes[w]),Z);Z.type==="funnel"?Z.orientation==="h"?(H&&(L[H]=!0),Y&&(U[Y]=!0)):Y&&(M[Y]=!0):Z.type==="image"?(Y&&(G[Y]=!0),H&&(G[H]=!0)):(Y&&(D[Y]=!0,N[Y]=!0),y(Z,"carpet")&&(Z.type!=="carpet"||Z._cheater)||H&&(P[H]=!0)),Z.type==="carpet"&&Z._cheater&&H&&(L[H]=!0),y(Z,"2dMap")&&(X[H]=!0,X[Y]=!0),y(Z,"oriented")&&(K[Z.orientation==="h"?Y:H]=!0)}}var $=T._subplots,z=$.xaxis,j=$.yaxis,W=t.simpleMap(z,n),ee=t.simpleMap(j,n),J=W.concat(ee),Q=d.background;z.length&&j.length&&(Q=t.coerce(x,T,f,"plot_bgcolor"));var te,ie,ae,he,se,de=d.combine(Q,T.paper_bgcolor);function ue(){var tt=k[te]||[];se._traceIndices=tt.map(function(_t){return _t._expandedIndex}),se._annIndices=[],se._shapeIndices=[],se._imgIndices=[],se._subplotsWith=[],se._counterAxes=[],se._name=se._attr=te,se._id=ie}function ve(tt,_t){return t.coerce(he,se,l,tt,_t)}function ke(tt,_t){return t.coerce2(he,se,l,tt,_t)}function Ee(tt){return tt==="x"?j:z}function be(tt,_t){for(var er=tt==="x"?W:ee,tr=[],Ue=0;Ue<er.length;Ue++){var He=er[Ue];He===_t||(x[He]||{}).overlaying||tr.push(a(He))}return tr}var xe={x:Ee("x"),y:Ee("y")},ce=xe.x.concat(xe.y),ge={},we=[];function Me(){var tt=he.matches;g.test(tt)&&ce.indexOf(tt)===-1&&(ge[tt]=he.type,we=Object.keys(ge))}var Se=h(x,T),ze=m(Se);for(S=0;S<J.length;S++){te=J[S],ie=a(te),ae=te.charAt(0),t.isPlainObject(x[te])||(x[te]={}),he=x[te],se=e.newContainer(T,te,ae+"axis"),ue();var Fe=ae==="x"&&!P[te]&&L[te]||ae==="y"&&!D[te]&&M[te],Ye=ae==="y"&&(!N[te]&&U[te]||G[te]),rt={letter:ae,font:T.font,outerTicks:X[te],showGrid:!K[te],data:k[te]||[],bgColor:de,calendar:T.calendar,automargin:!0,visibleDflt:Fe,reverseDflt:Ye,autotypenumbersDflt:E,splomStash:((T._splomAxes||{})[ae]||{})[ie]};ve("uirevision",T.uirevision),o(he,se,ve,rt),u(he,se,ve,rt,T);var Oe=ze&&ae===Se.charAt(0),je=ke("spikecolor",ze?se.color:void 0),We=ke("spikethickness",ze?1.5:void 0),qe=ke("spikedash",ze?"dot":void 0),et=ke("spikemode",ze?"across":void 0),st=ke("spikesnap");ve("showspikes",!!(Oe||je||We||qe||et||st))||(delete se.spikecolor,delete se.spikethickness,delete se.spikedash,delete se.spikemode,delete se.spikesnap),i(he,se,ve,{letter:ae,counterAxes:xe[ae],overlayableAxes:be(ae,te),grid:T.grid}),ve("title.standoff"),Me(),se._input=he}for(S=0;S<we.length;){ie=we[S++],ae=(te=n(ie)).charAt(0),t.isPlainObject(x[te])||(x[te]={}),he=x[te],se=e.newContainer(T,te,ae+"axis"),ue();var ct={letter:ae,font:T.font,outerTicks:X[te],showGrid:!K[te],data:[],bgColor:de,calendar:T.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:E,splomStash:((T._splomAxes||{})[ae]||{})[ie]};ve("uirevision",T.uirevision),se.type=ge[ie]||"linear",u(he,se,ve,ct,T),i(he,se,ve,{letter:ae,counterAxes:xe[ae],overlayableAxes:be(ae,te),grid:T.grid}),ve("fixedrange"),Me(),se._input=he}var Pt=v("rangeslider","handleDefaults"),kt=v("rangeselector","handleDefaults");for(S=0;S<W.length;S++)te=W[S],he=x[te],se=T[te],Pt(x,T,te),se.type==="date"&&kt(he,se,T,ee,se.calendar),ve("fixedrange");for(S=0;S<ee.length;S++){te=ee[S],he=x[te],se=T[te];var at=T[n(se.anchor)];ve("fixedrange",v("rangeslider","isVisible")(at))}s.handleDefaults(x,T,{axIds:ce.concat(we).sort(c.idSort),axHasImage:G})}},{"../../components/color":650,"../../components/fx/helpers":686,"../../components/fx/hovermode_defaults":689,"../../lib":787,"../../plot_api/plot_template":827,"../../registry":915,"../layout_attributes":892,"./axis_defaults":840,"./axis_ids":842,"./constants":845,"./constraints":846,"./layout_attributes":853,"./position_defaults":856,"./type_defaults":864}],855:[function(r,I,B){var t=r("tinycolor2").mix,d=r("../../components/color/attributes").lightFraction,m=r("../../lib");I.exports=function(h,e,f,l){var o=(l=l||{}).dfltColor;function u(p,y){return m.coerce2(h,e,l.attributes,p,y)}var s=u("linecolor",o),i=u("linewidth");f("showline",l.showLine||!!s||!!i)||(delete e.linecolor,delete e.linewidth);var c=u("gridcolor",t(o,l.bgColor,l.blend||d).toRgbString()),n=u("gridwidth");if(f("showgrid",l.showGrid||!!c||!!n)||(delete e.gridcolor,delete e.gridwidth),!l.noZeroLine){var a=u("zerolinecolor",o),g=u("zerolinewidth");f("zeroline",l.showGrid||!!a||!!g)||(delete e.zerolinecolor,delete e.zerolinewidth)}}},{"../../components/color/attributes":649,"../../lib":787,tinycolor2:583}],856:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib");I.exports=function(m,h,e,f){var l,o,u,s,i=f.counterAxes||[],c=f.overlayableAxes||[],n=f.letter,a=f.grid;a&&(o=a._domains[n][a._axisMap[h._id]],l=a._anchors[h._id],o&&(u=a[n+"side"].split(" ")[0],s=a.domain[n][u==="right"||u==="top"?1:0])),o=o||[0,1],l=l||(t(m.position)?"free":i[0]||"free"),u=u||(n==="x"?"bottom":"left"),s=s||0,d.coerce(m,h,{anchor:{valType:"enumerated",values:["free"].concat(i),dflt:l}},"anchor")==="free"&&e("position",s),d.coerce(m,h,{side:{valType:"enumerated",values:n==="x"?["bottom","top"]:["left","right"],dflt:u}},"side");var g=!1;if(c.length&&(g=d.coerce(m,h,{overlaying:{valType:"enumerated",values:[!1].concat(c),dflt:!1}},"overlaying")),!g){var p=e("domain",o);p[0]>p[1]-1/4096&&(h.domain=o),d.noneOrAll(m.domain,h.domain,o)}return e("layer"),h}},{"../../lib":787,"fast-isnumeric":246}],857:[function(r,I,B){var t=r("../../constants/alignment").FROM_BL;I.exports=function(d,m,h){h===void 0&&(h=t[d.constraintoward||"center"]);var e=[d.r2l(d.range[0]),d.r2l(d.range[1])],f=e[0]+(e[1]-e[0])*h;d.range=d._input.range=[d.l2r(f+(e[0]-f)*m),d.l2r(f+(e[1]-f)*m)],d.setScale()}},{"../../constants/alignment":755}],858:[function(r,I,B){var t=r("polybooljs"),d=r("../../registry"),m=r("../../components/drawing").dashStyle,h=r("../../components/color"),e=r("../../components/fx"),f=r("../../components/fx/helpers").makeEventData,l=r("../../components/dragelement/helpers"),o=l.freeMode,u=l.rectMode,s=l.drawMode,i=l.openMode,c=l.selectMode,n=r("../../components/shapes/draw_newshape/display_outlines"),a=r("../../components/shapes/draw_newshape/helpers").handleEllipse,g=r("../../components/shapes/draw_newshape/newshapes"),p=r("../../lib"),y=r("../../lib/polygon"),v=r("../../lib/throttle"),b=r("./axis_ids").getFromId,x=r("../../lib/clear_gl_canvases"),T=r("../../plot_api/subroutines").redrawReglTraces,A=r("./constants"),S=A.MINSELECT,w=y.filter,E=y.tester,k=r("./handle_outline").clearSelect,L=r("./helpers"),M=L.p2r,P=L.axValue,D=L.getTransform;function N(W,ee,J,Q,te,ie,ae){var he,se,de,ue,ve,ke,Ee,be,xe,ce=ee._hoverdata,ge=ee._fullLayout.clickmode.indexOf("event")>-1,we=[];if(function(Ye){return Ye&&Array.isArray(Ye)&&Ye[0].hoverOnBox!==!0}(ce)){K(W,ee,ie);var Me=function(Ye,rt){var Oe,je,We=Ye[0],qe=-1,et=[];for(je=0;je<rt.length;je++)if(Oe=rt[je],We.fullData._expandedIndex===Oe.cd[0].trace._expandedIndex){if(We.hoverOnBox===!0)break;We.pointNumber!==void 0?qe=We.pointNumber:We.binNumber!==void 0&&(qe=We.binNumber,et=We.pointNumbers);break}return{pointNumber:qe,pointNumbers:et,searchInfo:Oe}}(ce,he=H(ee,J,Q,te));if(Me.pointNumbers.length>0?function(Ye,rt){var Oe,je,We,qe=[];for(We=0;We<Ye.length;We++)(Oe=Ye[We]).cd[0].trace.selectedpoints&&Oe.cd[0].trace.selectedpoints.length>0&&qe.push(Oe);if(qe.length===1&&qe[0]===rt.searchInfo&&(je=rt.searchInfo.cd[0].trace).selectedpoints.length===rt.pointNumbers.length){for(We=0;We<rt.pointNumbers.length;We++)if(je.selectedpoints.indexOf(rt.pointNumbers[We])<0)return!1;return!0}return!1}(he,Me):function(Ye){var rt,Oe,je,We=0;for(je=0;je<Ye.length;je++)if(rt=Ye[je],(Oe=rt.cd[0].trace).selectedpoints&&(Oe.selectedpoints.length>1||(We+=Oe.selectedpoints.length)>1))return!1;return We===1}(he)&&(ke=Y(Me))){for(ae&&ae.remove(),xe=0;xe<he.length;xe++)(se=he[xe])._module.selectPoints(se,!1);$(ee,he),Z(ie),ge&&ee.emit("plotly_deselect",null)}else{for(Ee=W.shiftKey&&(ke!==void 0?ke:Y(Me)),de=function(Ye,rt,Oe){return{pointNumber:Ye,searchInfo:rt,subtract:Oe}}(Me.pointNumber,Me.searchInfo,Ee),ue=X(ie.selectionDefs.concat([de])),xe=0;xe<he.length;xe++)if(ve=z(he[xe]._module.selectPoints(he[xe],ue),he[xe]),we.length)for(var Se=0;Se<ve.length;Se++)we.push(ve[Se]);else we=ve;if($(ee,he,be={points:we}),de&&ie&&ie.selectionDefs.push(de),ae){var ze=ie.mergedPolygons,Fe=i(ie.dragmode);n(j(ze,Fe),ae,ie)}ge&&ee.emit("plotly_selected",be)}}}function U(W){return"pointNumber"in W&&"searchInfo"in W}function G(W){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(ee,J,Q,te){var ie=W.searchInfo.cd[0].trace._expandedIndex;return te.cd[0].trace._expandedIndex===ie&&Q===W.pointNumber},isRect:!1,degenerate:!1,subtract:W.subtract}}function X(W){for(var ee=[],J=U(W[0])?0:W[0][0][0],Q=J,te=U(W[0])?0:W[0][0][1],ie=te,ae=0;ae<W.length;ae++)if(U(W[ae]))ee.push(G(W[ae]));else{var he=y.tester(W[ae]);he.subtract=W[ae].subtract,ee.push(he),J=Math.min(J,he.xmin),Q=Math.max(Q,he.xmax),te=Math.min(te,he.ymin),ie=Math.max(ie,he.ymax)}return{xmin:J,xmax:Q,ymin:te,ymax:ie,pts:[],contains:function(se,de,ue,ve){for(var ke=!1,Ee=0;Ee<ee.length;Ee++)ee[Ee].contains(se,de,ue,ve)&&(ke=ee[Ee].subtract===!1);return ke},isRect:!1,degenerate:!1}}function K(W,ee,J){ee._fullLayout._drawing=!1;var Q=ee._fullLayout,te=J.plotinfo,ie=J.dragmode,ae=Q._lastSelectedSubplot&&Q._lastSelectedSubplot===te.id,he=(W.shiftKey||W.altKey)&&!(s(ie)&&i(ie));ae&&he&&te.selection&&te.selection.selectionDefs&&!J.selectionDefs?(J.selectionDefs=te.selection.selectionDefs,J.mergedPolygons=te.selection.mergedPolygons):he&&te.selection||Z(J),ae||(k(ee),Q._lastSelectedSubplot=te.id)}function Z(W){var ee=W.dragmode,J=W.plotinfo,Q=W.gd;if(Q._fullLayout._activeShapeIndex>=0&&Q._fullLayout._deactivateShape(Q),s(ee)){var te=Q._fullLayout._zoomlayer.selectAll(".select-outline-"+J.id);if(te&&Q._fullLayout._drawing){var ie=g(te,W);ie&&d.call("_guiRelayout",Q,{shapes:ie}),Q._fullLayout._drawing=!1}}J.selection={},J.selection.selectionDefs=W.selectionDefs=[],J.selection.mergedPolygons=W.mergedPolygons=[]}function H(W,ee,J,Q){var te,ie,ae,he=[],se=ee.map(function(Ee){return Ee._id}),de=J.map(function(Ee){return Ee._id});for(ae=0;ae<W.calcdata.length;ae++)if((ie=(te=W.calcdata[ae])[0].trace).visible===!0&&ie._module&&ie._module.selectPoints)if(!Q||ie.subplot!==Q&&ie.geo!==Q)if(ie.type==="splom"&&ie._xaxes[se[0]]&&ie._yaxes[de[0]]){var ue=ke(ie._module,te,ee[0],J[0]);ue.scene=W._fullLayout._splomScenes[ie.uid],he.push(ue)}else if(ie.type==="sankey"){var ve=ke(ie._module,te,ee[0],J[0]);he.push(ve)}else{if(se.indexOf(ie.xaxis)===-1||de.indexOf(ie.yaxis)===-1)continue;he.push(ke(ie._module,te,b(W,ie.xaxis),b(W,ie.yaxis)))}else he.push(ke(ie._module,te,ee[0],J[0]));return he;function ke(Ee,be,xe,ce){return{_module:Ee,cd:be,xaxis:xe,yaxis:ce}}}function Y(W){var ee=W.searchInfo.cd[0].trace,J=W.pointNumber,Q=W.pointNumbers,te=Q.length>0?Q[0]:J;return!!ee.selectedpoints&&ee.selectedpoints.indexOf(te)>-1}function $(W,ee,J){var Q,te,ie,ae;for(Q=0;Q<ee.length;Q++){var he=ee[Q].cd[0].trace._fullInput,se=W._fullLayout._tracePreGUI[he.uid]||{};se.selectedpoints===void 0&&(se.selectedpoints=he._input.selectedpoints||null)}if(J){var de=J.points||[];for(Q=0;Q<ee.length;Q++)(ae=ee[Q].cd[0].trace)._input.selectedpoints=ae._fullInput.selectedpoints=[],ae._fullInput!==ae&&(ae.selectedpoints=[]);for(Q=0;Q<de.length;Q++){var ue=de[Q],ve=ue.data,ke=ue.fullData;ue.pointIndices?([].push.apply(ve.selectedpoints,ue.pointIndices),ae._fullInput!==ae&&[].push.apply(ke.selectedpoints,ue.pointIndices)):(ve.selectedpoints.push(ue.pointIndex),ae._fullInput!==ae&&ke.selectedpoints.push(ue.pointIndex))}}else for(Q=0;Q<ee.length;Q++)delete(ae=ee[Q].cd[0].trace).selectedpoints,delete ae._input.selectedpoints,ae._fullInput!==ae&&delete ae._fullInput.selectedpoints;var Ee=!1;for(Q=0;Q<ee.length;Q++){ae=(ie=(te=ee[Q]).cd)[0].trace,d.traceIs(ae,"regl")&&(Ee=!0);var be=te._module,xe=be.styleOnSelect||be.style;xe&&(xe(W,ie,ie[0].node3),ie[0].nodeRangePlot3&&xe(W,ie,ie[0].nodeRangePlot3))}Ee&&(x(W),T(W))}function z(W,ee){if(Array.isArray(W))for(var J=ee.cd,Q=ee.cd[0].trace,te=0;te<W.length;te++)W[te]=f(W[te],Q,J);return W}function j(W,ee){for(var J=[],Q=0;Q<W.length;Q++){J[Q]=[];for(var te=0;te<W[Q].length;te++){J[Q][te]=[],J[Q][te][0]=te?"L":"M";for(var ie=0;ie<W[Q][te].length;ie++)J[Q][te].push(W[Q][te][ie])}ee||J[Q].push(["Z",J[Q][0][1],J[Q][0][2]])}return J}I.exports={prepSelect:function(W,ee,J,Q,te){var ie=o(te),ae=u(te),he=i(te),se=s(te),de=c(te),ue=te==="drawcircle",ve=te==="drawline"||ue,ke=Q.gd,Ee=ke._fullLayout,be=Ee._zoomlayer,xe=Q.element.getBoundingClientRect(),ce=Q.plotinfo,ge=D(ce),we=ee-xe.left,Me=J-xe.top;Ee._calcInverseTransform(ke);var Se=p.apply3DTransform(Ee._invTransform)(we,Me);we=Se[0],Me=Se[1];var ze,Fe,Ye,rt,Oe,je,We,qe=Ee._invScaleX,et=Ee._invScaleY,st=we,ct=Me,Pt="M"+we+","+Me,kt=Q.xaxes[0]._length,at=Q.yaxes[0]._length,tt=Q.xaxes.concat(Q.yaxes),_t=W.altKey&&!(s(te)&&he);K(W,ke,Q),ie&&(ze=w([[we,Me]],A.BENDPX));var er=be.selectAll("path.select-outline-"+ce.id).data(se?[0]:[1,2]),tr=Ee.newshape;er.enter().append("path").attr("class",function(Le){return"select-outline select-outline-"+Le+" select-outline-"+ce.id}).style(se?{opacity:tr.opacity/2,fill:he?void 0:tr.fillcolor,stroke:tr.line.color,"stroke-dasharray":m(tr.line.dash,tr.line.width),"stroke-width":tr.line.width+"px"}:{}).attr("fill-rule",tr.fillrule).classed("cursor-move",!!se).attr("transform",ge).attr("d",Pt+"Z");var Ue,He=be.append("path").attr("class","zoombox-corners").style({fill:h.background,stroke:h.defaultLine,"stroke-width":1}).attr("transform",ge).attr("d","M0,0Z"),Be=Ee._uid+A.SELECTID,Ke=[],_e=H(ke,Q.xaxes,Q.yaxes,Q.subplot);function Ce(Le,Pe){return Le-Pe}Ue=ce.fillRangeItems?ce.fillRangeItems:ae?function(Le,Pe){var Xe=Le.range={};for(Oe=0;Oe<tt.length;Oe++){var ht=tt[Oe],Mt=ht._id.charAt(0);Xe[ht._id]=[M(ht,Pe[Mt+"min"]),M(ht,Pe[Mt+"max"])].sort(Ce)}}:function(Le,Pe,Xe){var ht=Le.lassoPoints={};for(Oe=0;Oe<tt.length;Oe++){var Mt=tt[Oe];ht[Mt._id]=Xe.filtered.map(P(Mt))}},Q.moveFn=function(Le,Pe){st=Math.max(0,Math.min(kt,qe*Le+we)),ct=Math.max(0,Math.min(at,et*Pe+Me));var Xe=Math.abs(st-we),ht=Math.abs(ct-Me);if(ae){var Mt,pt,Lt;if(de){var vt=Ee.selectdirection;switch(Mt=vt==="any"?ht<Math.min(.6*Xe,S)?"h":Xe<Math.min(.6*ht,S)?"v":"d":vt){case"h":pt=ue?at/2:0,Lt=at;break;case"v":pt=ue?kt/2:0,Lt=kt}}if(se)switch(Ee.newshape.drawdirection){case"vertical":Mt="h",pt=ue?at/2:0,Lt=at;break;case"horizontal":Mt="v",pt=ue?kt/2:0,Lt=kt;break;case"ortho":Xe<ht?(Mt="h",pt=Me,Lt=ct):(Mt="v",pt=we,Lt=st);break;default:Mt="d"}Mt==="h"?((rt=ve?a(ue,[st,pt],[st,Lt]):[[we,pt],[we,Lt],[st,Lt],[st,pt]]).xmin=ve?st:Math.min(we,st),rt.xmax=ve?st:Math.max(we,st),rt.ymin=Math.min(pt,Lt),rt.ymax=Math.max(pt,Lt),He.attr("d","M"+rt.xmin+","+(Me-S)+"h-4v"+2*S+"h4ZM"+(rt.xmax-1)+","+(Me-S)+"h4v"+2*S+"h-4Z")):Mt==="v"?((rt=ve?a(ue,[pt,ct],[Lt,ct]):[[pt,Me],[pt,ct],[Lt,ct],[Lt,Me]]).xmin=Math.min(pt,Lt),rt.xmax=Math.max(pt,Lt),rt.ymin=ve?ct:Math.min(Me,ct),rt.ymax=ve?ct:Math.max(Me,ct),He.attr("d","M"+(we-S)+","+rt.ymin+"v-4h"+2*S+"v4ZM"+(we-S)+","+(rt.ymax-1)+"v4h"+2*S+"v-4Z")):Mt==="d"&&((rt=ve?a(ue,[we,Me],[st,ct]):[[we,Me],[we,ct],[st,ct],[st,Me]]).xmin=Math.min(we,st),rt.xmax=Math.max(we,st),rt.ymin=Math.min(Me,ct),rt.ymax=Math.max(Me,ct),He.attr("d","M0,0Z"))}else ie&&(ze.addPt([st,ct]),rt=ze.filtered);Q.selectionDefs&&Q.selectionDefs.length?(Ye=function(Dt,xt,it){return it?t.difference({regions:Dt,inverted:!1},{regions:[xt],inverted:!1}).regions:t.union({regions:Dt,inverted:!1},{regions:[xt],inverted:!1}).regions}(Q.mergedPolygons,rt,_t),rt.subtract=_t,Fe=X(Q.selectionDefs.concat([rt]))):(Ye=[rt],Fe=E(rt)),n(j(Ye,he),er,Q),de&&v.throttle(Be,A.SELECTDELAY,function(){var Dt;Ke=[];var xt;for(Oe=0;Oe<_e.length;Oe++)if(xt=(je=_e[Oe])._module.selectPoints(je,Fe),Dt=z(xt,je),Ke.length)for(var it=0;it<Dt.length;it++)Ke.push(Dt[it]);else Ke=Dt;$(ke,_e,We={points:Ke}),Ue(We,rt,ze),Q.gd.emit("plotly_selecting",We)})},Q.clickFn=function(Le,Pe){if(He.remove(),ke._fullLayout._activeShapeIndex>=0)ke._fullLayout._deactivateShape(ke);else if(!se){var Xe=Ee.clickmode;v.done(Be).then(function(){if(v.clear(Be),Le===2){for(er.remove(),Oe=0;Oe<_e.length;Oe++)(je=_e[Oe])._module.selectPoints(je,!1);$(ke,_e),Z(Q),ke.emit("plotly_deselect",null)}else Xe.indexOf("select")>-1&&N(Pe,ke,Q.xaxes,Q.yaxes,Q.subplot,Q,er),Xe==="event"&&ke.emit("plotly_selected",void 0);e.click(ke,Pe)}).catch(p.error)}},Q.doneFn=function(){He.remove(),v.done(Be).then(function(){v.clear(Be),Q.gd.emit("plotly_selected",We),rt&&Q.selectionDefs&&(rt.subtract=_t,Q.selectionDefs.push(rt),Q.mergedPolygons.length=0,[].push.apply(Q.mergedPolygons,Ye)),Q.doneFnCompleted&&Q.doneFnCompleted(Ke)}).catch(p.error),se&&Z(Q)}},clearSelect:k,clearSelectionsCache:Z,selectOnClick:N}},{"../../components/color":650,"../../components/dragelement/helpers":668,"../../components/drawing":672,"../../components/fx":690,"../../components/fx/helpers":686,"../../components/shapes/draw_newshape/display_outlines":738,"../../components/shapes/draw_newshape/helpers":739,"../../components/shapes/draw_newshape/newshapes":740,"../../lib":787,"../../lib/clear_gl_canvases":771,"../../lib/polygon":799,"../../lib/throttle":814,"../../plot_api/subroutines":828,"../../registry":915,"./axis_ids":842,"./constants":845,"./handle_outline":849,"./helpers":850,polybooljs:490}],859:[function(r,I,B){var t=r("@plotly/d3"),d=r("d3-time-format").utcFormat,m=r("../../lib"),h=m.numberFormat,e=r("fast-isnumeric"),f=m.cleanNumber,l=m.ms2DateTime,o=m.dateTime2ms,u=m.ensureNumber,s=m.isArrayOrTypedArray,i=r("../../constants/numerical"),c=i.FP_SAFE,n=i.BADNUM,a=i.LOG_CLIP,g=i.ONEWEEK,p=i.ONEDAY,y=i.ONEHOUR,v=i.ONEMIN,b=i.ONESEC,x=r("./axis_ids"),T=r("./constants"),A=T.HOUR_PATTERN,S=T.WEEKDAY_PATTERN;function w(k){return Math.pow(10,k)}function E(k){return k!=null}I.exports=function(k,L){L=L||{};var M=k._id||"x",P=M.charAt(0);function D(J,Q){if(J>0)return Math.log(J)/Math.LN10;if(J<=0&&Q&&k.range&&k.range.length===2){var te=k.range[0],ie=k.range[1];return .5*(te+ie-2*a*Math.abs(te-ie))}return n}function N(J,Q,te,ie){if((ie||{}).msUTC&&e(J))return+J;var ae=o(J,te||k.calendar);if(ae===n){if(!e(J))return n;J=+J;var he=Math.floor(10*m.mod(J+.05,1)),se=Math.round(J-he/10);ae=o(new Date(se))+he/10}return ae}function U(J,Q,te){return l(J,Q,te||k.calendar)}function G(J){return k._categories[Math.round(J)]}function X(J){if(E(J)){if(k._categoriesMap===void 0&&(k._categoriesMap={}),k._categoriesMap[J]!==void 0)return k._categoriesMap[J];k._categories.push(typeof J=="number"?String(J):J);var Q=k._categories.length-1;return k._categoriesMap[J]=Q,Q}return n}function K(J){if(k._categoriesMap)return k._categoriesMap[J]}function Z(J){var Q=K(J);return Q!==void 0?Q:e(J)?+J:void 0}function H(J){return e(J)?+J:K(J)}function Y(J,Q,te){return t.round(te+Q*J,2)}function $(J,Q,te){return(J-te)/Q}var z=function(J){return e(J)?Y(J,k._m,k._b):n},j=function(J){return $(J,k._m,k._b)};if(k.rangebreaks){var W=P==="y";z=function(J){if(!e(J))return n;var Q=k._rangebreaks.length;if(!Q)return Y(J,k._m,k._b);var te=W;k.range[0]>k.range[1]&&(te=!te);for(var ie=te?-1:1,ae=ie*J,he=0,se=0;se<Q;se++){var de=ie*k._rangebreaks[se].min,ue=ie*k._rangebreaks[se].max;if(ae<de)break;if(!(ae>ue)){he=ae<(de+ue)/2?se:se+1;break}he=se+1}var ve=k._B[he]||0;return isFinite(ve)?Y(J,k._m2,ve):0},j=function(J){var Q=k._rangebreaks.length;if(!Q)return $(J,k._m,k._b);for(var te=0,ie=0;ie<Q&&!(J<k._rangebreaks[ie].pmin);ie++)J>k._rangebreaks[ie].pmax&&(te=ie+1);return $(J,k._m2,k._B[te])}}k.c2l=k.type==="log"?D:u,k.l2c=k.type==="log"?w:u,k.l2p=z,k.p2l=j,k.c2p=k.type==="log"?function(J,Q){return z(D(J,Q))}:z,k.p2c=k.type==="log"?function(J){return w(j(J))}:j,["linear","-"].indexOf(k.type)!==-1?(k.d2r=k.r2d=k.d2c=k.r2c=k.d2l=k.r2l=f,k.c2d=k.c2r=k.l2d=k.l2r=u,k.d2p=k.r2p=function(J){return k.l2p(f(J))},k.p2d=k.p2r=j,k.cleanPos=u):k.type==="log"?(k.d2r=k.d2l=function(J,Q){return D(f(J),Q)},k.r2d=k.r2c=function(J){return w(f(J))},k.d2c=k.r2l=f,k.c2d=k.l2r=u,k.c2r=D,k.l2d=w,k.d2p=function(J,Q){return k.l2p(k.d2r(J,Q))},k.p2d=function(J){return w(j(J))},k.r2p=function(J){return k.l2p(f(J))},k.p2r=j,k.cleanPos=u):k.type==="date"?(k.d2r=k.r2d=m.identity,k.d2c=k.r2c=k.d2l=k.r2l=N,k.c2d=k.c2r=k.l2d=k.l2r=U,k.d2p=k.r2p=function(J,Q,te){return k.l2p(N(J,0,te))},k.p2d=k.p2r=function(J,Q,te){return U(j(J),Q,te)},k.cleanPos=function(J){return m.cleanDate(J,n,k.calendar)}):k.type==="category"?(k.d2c=k.d2l=X,k.r2d=k.c2d=k.l2d=G,k.d2r=k.d2l_noadd=Z,k.r2c=function(J){var Q=H(J);return Q!==void 0?Q:k.fraction2r(.5)},k.l2r=k.c2r=u,k.r2l=H,k.d2p=function(J){return k.l2p(k.r2c(J))},k.p2d=function(J){return G(j(J))},k.r2p=k.d2p,k.p2r=j,k.cleanPos=function(J){return typeof J=="string"&&J!==""?J:u(J)}):k.type==="multicategory"&&(k.r2d=k.c2d=k.l2d=G,k.d2r=k.d2l_noadd=Z,k.r2c=function(J){var Q=Z(J);return Q!==void 0?Q:k.fraction2r(.5)},k.r2c_just_indices=K,k.l2r=k.c2r=u,k.r2l=Z,k.d2p=function(J){return k.l2p(k.r2c(J))},k.p2d=function(J){return G(j(J))},k.r2p=k.d2p,k.p2r=j,k.cleanPos=function(J){return Array.isArray(J)||typeof J=="string"&&J!==""?J:u(J)},k.setupMultiCategory=function(J){var Q,te,ie=k._traceIndices,ae=k._matchGroup;if(ae&&k._categories.length===0){for(var he in ae)if(he!==M){var se=L[x.id2name(he)];ie=ie.concat(se._traceIndices)}}var de=[[0,{}],[0,{}]],ue=[];for(Q=0;Q<ie.length;Q++){var ve=J[ie[Q]];if(P in ve){var ke=ve[P],Ee=ve._length||m.minRowLength(ke);if(s(ke[0])&&s(ke[1]))for(te=0;te<Ee;te++){var be=ke[0][te],xe=ke[1][te];E(be)&&E(xe)&&(ue.push([be,xe]),be in de[0][1]||(de[0][1][be]=de[0][0]++),xe in de[1][1]||(de[1][1][xe]=de[1][0]++))}}}for(ue.sort(function(ce,ge){var we=de[0][1],Me=we[ce[0]]-we[ge[0]];if(Me)return Me;var Se=de[1][1];return Se[ce[1]]-Se[ge[1]]}),Q=0;Q<ue.length;Q++)X(ue[Q])}),k.fraction2r=function(J){var Q=k.r2l(k.range[0]),te=k.r2l(k.range[1]);return k.l2r(Q+J*(te-Q))},k.r2fraction=function(J){var Q=k.r2l(k.range[0]),te=k.r2l(k.range[1]);return(k.r2l(J)-Q)/(te-Q)},k.cleanRange=function(J,Q){Q||(Q={}),J||(J="range");var te,ie,ae=m.nestedProperty(k,J).get();if(ie=(ie=k.type==="date"?m.dfltRange(k.calendar):P==="y"?T.DFLTRANGEY:Q.dfltRange||T.DFLTRANGEX).slice(),k.rangemode!=="tozero"&&k.rangemode!=="nonnegative"||(ie[0]=0),ae&&ae.length===2)for(k.type!=="date"||k.autorange||(ae[0]=m.cleanDate(ae[0],n,k.calendar),ae[1]=m.cleanDate(ae[1],n,k.calendar)),te=0;te<2;te++)if(k.type==="date"){if(!m.isDateTime(ae[te],k.calendar)){k[J]=ie;break}if(k.r2l(ae[0])===k.r2l(ae[1])){var he=m.constrain(k.r2l(ae[0]),m.MIN_MS+1e3,m.MAX_MS-1e3);ae[0]=k.l2r(he-1e3),ae[1]=k.l2r(he+1e3);break}}else{if(!e(ae[te])){if(!e(ae[1-te])){k[J]=ie;break}ae[te]=ae[1-te]*(te?10:.1)}if(ae[te]<-c?ae[te]=-c:ae[te]>c&&(ae[te]=c),ae[0]===ae[1]){var se=Math.max(1,Math.abs(1e-6*ae[0]));ae[0]-=se,ae[1]+=se}}else m.nestedProperty(k,J).set(ie)},k.setScale=function(J){var Q=L._size;if(k.overlaying){var te=x.getFromId({_fullLayout:L},k.overlaying);k.domain=te.domain}var ie=J&&k._r?"_r":"range",ae=k.calendar;k.cleanRange(ie);var he,se,de=k.r2l(k[ie][0],ae),ue=k.r2l(k[ie][1],ae),ve=P==="y";if(ve?(k._offset=Q.t+(1-k.domain[1])*Q.h,k._length=Q.h*(k.domain[1]-k.domain[0]),k._m=k._length/(de-ue),k._b=-k._m*ue):(k._offset=Q.l+k.domain[0]*Q.w,k._length=Q.w*(k.domain[1]-k.domain[0]),k._m=k._length/(ue-de),k._b=-k._m*de),k._rangebreaks=[],k._lBreaks=0,k._m2=0,k._B=[],k.rangebreaks&&(k._rangebreaks=k.locateBreaks(Math.min(de,ue),Math.max(de,ue)),k._rangebreaks.length)){for(he=0;he<k._rangebreaks.length;he++)se=k._rangebreaks[he],k._lBreaks+=Math.abs(se.max-se.min);var ke=ve;de>ue&&(ke=!ke),ke&&k._rangebreaks.reverse();var Ee=ke?-1:1;for(k._m2=Ee*k._length/(Math.abs(ue-de)-k._lBreaks),k._B.push(-k._m2*(ve?ue:de)),he=0;he<k._rangebreaks.length;he++)se=k._rangebreaks[he],k._B.push(k._B[k._B.length-1]-Ee*k._m2*(se.max-se.min));for(he=0;he<k._rangebreaks.length;he++)(se=k._rangebreaks[he]).pmin=z(se.min),se.pmax=z(se.max)}if(!isFinite(k._m)||!isFinite(k._b)||k._length<0)throw L._replotting=!1,new Error("Something went wrong with axis scaling")},k.maskBreaks=function(J){var Q,te,ie,ae,he,se=k.rangebreaks||[];se._cachedPatterns||(se._cachedPatterns=se.map(function(be){return be.enabled&&be.bounds?m.simpleMap(be.bounds,be.pattern?f:k.d2c):null})),se._cachedValues||(se._cachedValues=se.map(function(be){return be.enabled&&be.values?m.simpleMap(be.values,k.d2c).sort(m.sorterAsc):null}));for(var de=0;de<se.length;de++){var ue=se[de];if(ue.enabled){if(ue.bounds){var ve=ue.pattern;switch(te=(Q=se._cachedPatterns[de])[0],ie=Q[1],ve){case S:ae=(he=new Date(J)).getUTCDay(),te>ie&&(ie+=7,ae<te&&(ae+=7));break;case A:ae=(he=new Date(J)).getUTCHours()+(he.getUTCMinutes()/60+he.getUTCSeconds()/3600+he.getUTCMilliseconds()/36e5),te>ie&&(ie+=24,ae<te&&(ae+=24));break;case"":ae=J}if(ae>=te&&ae<ie)return n}else for(var ke=se._cachedValues[de],Ee=0;Ee<ke.length;Ee++)if(ie=(te=ke[Ee])+ue.dvalue,J>=te&&J<ie)return n}}return J},k.locateBreaks=function(J,Q){var te,ie,ae,he,se=[];if(!k.rangebreaks)return se;var de=k.rangebreaks.slice().sort(function(Se,ze){return Se.pattern===S&&ze.pattern===A?-1:ze.pattern===S&&Se.pattern===A?1:0}),ue=function(Se,ze){if((Se=m.constrain(Se,J,Q))!==(ze=m.constrain(ze,J,Q))){for(var Fe=!0,Ye=0;Ye<se.length;Ye++){var rt=se[Ye];Se<rt.max&&ze>=rt.min&&(Se<rt.min&&(rt.min=Se),ze>rt.max&&(rt.max=ze),Fe=!1)}Fe&&se.push({min:Se,max:ze})}};for(te=0;te<de.length;te++){var ve=de[te];if(ve.enabled)if(ve.bounds){var ke=J,Ee=Q;ve.pattern&&(ke=Math.floor(ke)),ae=(ie=m.simpleMap(ve.bounds,ve.pattern?f:k.r2l))[0],he=ie[1];var be,xe,ce=new Date(ke);switch(ve.pattern){case S:xe=g,be=(he-ae+(he<ae?7:0))*p,ke+=ae*p-(ce.getUTCDay()*p+ce.getUTCHours()*y+ce.getUTCMinutes()*v+ce.getUTCSeconds()*b+ce.getUTCMilliseconds());break;case A:xe=p,be=(he-ae+(he<ae?24:0))*y,ke+=ae*y-(ce.getUTCHours()*y+ce.getUTCMinutes()*v+ce.getUTCSeconds()*b+ce.getUTCMilliseconds());break;default:ke=Math.min(ie[0],ie[1]),be=xe=(Ee=Math.max(ie[0],ie[1]))-ke}for(var ge=ke;ge<Ee;ge+=xe)ue(ge,ge+be)}else for(var we=m.simpleMap(ve.values,k.d2c),Me=0;Me<we.length;Me++)ue(ae=we[Me],he=ae+ve.dvalue)}return se.sort(function(Se,ze){return Se.min-ze.min}),se},k.makeCalcdata=function(J,Q,te){var ie,ae,he,se,de=k.type,ue=de==="date"&&J[Q+"calendar"];if(Q in J){if(ie=J[Q],se=J._length||m.minRowLength(ie),m.isTypedArray(ie)&&(de==="linear"||de==="log")){if(se===ie.length)return ie;if(ie.subarray)return ie.subarray(0,se)}if(de==="multicategory")return function(Ee,be){for(var xe=new Array(be),ce=0;ce<be;ce++){var ge=(Ee[0]||[])[ce],we=(Ee[1]||[])[ce];xe[ce]=K([ge,we])}return xe}(ie,se);for(ae=new Array(se),he=0;he<se;he++)ae[he]=k.d2c(ie[he],0,ue,te)}else{var ve=Q+"0"in J?k.d2c(J[Q+"0"],0,ue):0,ke=J["d"+Q]?Number(J["d"+Q]):1;for(ie=J[{x:"y",y:"x"}[Q]],se=J._length||ie.length,ae=new Array(se),he=0;he<se;he++)ae[he]=ve+he*ke}if(k.rangebreaks)for(he=0;he<se;he++)ae[he]=k.maskBreaks(ae[he]);return ae},k.isValidRange=function(J){return Array.isArray(J)&&J.length===2&&e(k.r2l(J[0]))&&e(k.r2l(J[1]))},k.isPtWithinRange=function(J,Q){var te=k.c2l(J[P],null,Q),ie=k.r2l(k.range[0]),ae=k.r2l(k.range[1]);return ie<ae?ie<=te&&te<=ae:ae<=te&&te<=ie},k._emptyCategories=function(){k._categories=[],k._categoriesMap={}},k.clearCalc=function(){var J=k._matchGroup;if(J){var Q=null,te=null;for(var ie in J){var ae=L[x.id2name(ie)];if(ae._categories){Q=ae._categories,te=ae._categoriesMap;break}}Q&&te?(k._categories=Q,k._categoriesMap=te):k._emptyCategories()}else k._emptyCategories();if(k._initialCategories)for(var he=0;he<k._initialCategories.length;he++)X(k._initialCategories[he])},k.sortByInitialCategories=function(){var J=[];if(k._emptyCategories(),k._initialCategories)for(var Q=0;Q<k._initialCategories.length;Q++)X(k._initialCategories[Q]);J=J.concat(k._traceIndices);var te=k._matchGroup;for(var ie in te)if(M!==ie){var ae=L[x.id2name(ie)];ae._categories=k._categories,ae._categoriesMap=k._categoriesMap,J=J.concat(ae._traceIndices)}return J};var ee=L._d3locale;k.type==="date"&&(k._dateFormat=ee?ee.timeFormat:d,k._extraFormat=L._extraFormat),k._separators=L.separators,k._numFormat=ee?ee.numberFormat:h,delete k._minDtick,delete k._forceTick0}},{"../../constants/numerical":763,"../../lib":787,"./axis_ids":842,"./constants":845,"@plotly/d3":58,"d3-time-format":172,"fast-isnumeric":246}],860:[function(r,I,B){var t=r("../../lib"),d=r("../../components/color").contrast,m=r("./layout_attributes"),h=r("../array_container_defaults");function e(l){var o=["showexponent","showtickprefix","showticksuffix"].filter(function(u){return l[u]!==void 0});if(o.every(function(u){return l[u]===l[o[0]]})||o.length===1)return l[o[0]]}function f(l,o){function u(s,i){return t.coerce(l,o,m.tickformatstops,s,i)}u("enabled")&&(u("dtickrange"),u("value"))}I.exports=function(l,o,u,s,i,c){c&&c.pass!==1||function(n,a,g,p,y){var v=e(n);g("tickprefix")&&g("showtickprefix",v),g("ticksuffix",y.tickSuffixDflt)&&g("showticksuffix",v)}(l,0,u,0,i),c&&c.pass!==2||function(n,a,g,p,y){var v=e(n);if(g("tickprefix")&&g("showtickprefix",v),g("ticksuffix",y.tickSuffixDflt)&&g("showticksuffix",v),g("showticklabels")){var b=y.font||{},x=a.color,T=(a.ticklabelposition||"").indexOf("inside")!==-1?d(y.bgColor):x&&x!==m.color.dflt?x:b.color;if(t.coerceFont(g,"tickfont",{family:b.family,size:b.size,color:T}),g("tickangle"),p!=="category"){var A=g("tickformat");h(n,a,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:f}),a.tickformatstops.length||delete a.tickformatstops,A||p==="date"||(g("showexponent",v),g("exponentformat"),g("minexponent"),g("separatethousands"))}}}(l,o,u,s,i)}},{"../../components/color":650,"../../lib":787,"../array_container_defaults":833,"./layout_attributes":853}],861:[function(r,I,B){var t=r("../../lib"),d=r("./layout_attributes");I.exports=function(m,h,e,f){var l=t.coerce2(m,h,d,"ticklen"),o=t.coerce2(m,h,d,"tickwidth"),u=t.coerce2(m,h,d,"tickcolor",h.color);e("ticks",f.outerTicks||l||o||u?"outside":"")||(delete h.ticklen,delete h.tickwidth,delete h.tickcolor)}},{"../../lib":787,"./layout_attributes":853}],862:[function(r,I,B){var t=r("./clean_ticks"),d=r("../../lib").isArrayOrTypedArray;I.exports=function(m,h,e,f){function l(n){var a=m[n];return a!==void 0?a:(h._template||{})[n]}var o=l("tick0"),u=l("dtick"),s=l("tickvals"),i=e("tickmode",d(s)?"array":u?"linear":"auto");if(i==="auto")e("nticks");else if(i==="linear"){var c=h.dtick=t.dtick(u,f);h.tick0=t.tick0(o,f,h.calendar,c)}else f!=="multicategory"&&(e("tickvals")===void 0?h.tickmode="auto":e("ticktext"))}},{"../../lib":787,"./clean_ticks":844}],863:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../registry"),m=r("../../lib"),h=r("../../components/drawing"),e=r("./axes");I.exports=function(f,l,o,u){var s=f._fullLayout;if(l.length!==0){var i,c,n,a;u&&(i=u());var g=t.ease(o.easing);return f._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(a),a=null,function(){for(var v={},b=0;b<l.length;b++){var x=l[b],T=x.plotinfo.xaxis,A=x.plotinfo.yaxis;x.xr0&&(v[T._name+".range"]=x.xr0.slice()),x.yr0&&(v[A._name+".range"]=x.yr0.slice())}return d.call("relayout",f,v).then(function(){for(var S=0;S<l.length;S++)p(l[S].plotinfo)})}()}),c=Date.now(),a=window.requestAnimationFrame(function v(){n=Date.now();for(var b=Math.min(1,(n-c)/o.duration),x=g(b),T=0;T<l.length;T++)y(l[T],x);n-c>o.duration?(function(){for(var A={},S=0;S<l.length;S++){var w=l[S],E=w.plotinfo.xaxis,k=w.plotinfo.yaxis;w.xr1&&(A[E._name+".range"]=w.xr1.slice()),w.yr1&&(A[k._name+".range"]=w.yr1.slice())}i&&i(),d.call("relayout",f,A).then(function(){for(var L=0;L<l.length;L++)p(l[L].plotinfo)})}(),a=window.cancelAnimationFrame(v)):a=window.requestAnimationFrame(v)}),Promise.resolve()}function p(v){var b=v.xaxis,x=v.yaxis;s._defs.select("#"+v.clipId+"> rect").call(h.setTranslate,0,0).call(h.setScale,1,1),v.plot.call(h.setTranslate,b._offset,x._offset).call(h.setScale,1,1);var T=v.plot.selectAll(".scatterlayer .trace");T.selectAll(".point").call(h.setPointGroupScale,1,1),T.selectAll(".textpoint").call(h.setTextPointsScale,1,1),T.call(h.hideOutsideRangePoints,v)}function y(v,b){var x=v.plotinfo,T=x.xaxis,A=x.yaxis,S=T._length,w=A._length,E=!!v.xr1,k=!!v.yr1,L=[];if(E){var M=m.simpleMap(v.xr0,T.r2l),P=m.simpleMap(v.xr1,T.r2l),D=M[1]-M[0],N=P[1]-P[0];L[0]=(M[0]*(1-b)+b*P[0]-M[0])/(M[1]-M[0])*S,L[2]=S*(1-b+b*N/D),T.range[0]=T.l2r(M[0]*(1-b)+b*P[0]),T.range[1]=T.l2r(M[1]*(1-b)+b*P[1])}else L[0]=0,L[2]=S;if(k){var U=m.simpleMap(v.yr0,A.r2l),G=m.simpleMap(v.yr1,A.r2l),X=U[1]-U[0],K=G[1]-G[0];L[1]=(U[1]*(1-b)+b*G[1]-U[1])/(U[0]-U[1])*w,L[3]=w*(1-b+b*K/X),A.range[0]=T.l2r(U[0]*(1-b)+b*G[0]),A.range[1]=A.l2r(U[1]*(1-b)+b*G[1])}else L[1]=0,L[3]=w;e.drawOne(f,T,{skipTitle:!0}),e.drawOne(f,A,{skipTitle:!0}),e.redrawComponents(f,[T._id,A._id]);var Z=E?S/L[2]:1,H=k?w/L[3]:1,Y=E?L[0]:0,$=k?L[1]:0,z=E?L[0]/L[2]*S:0,j=k?L[1]/L[3]*w:0,W=T._offset-z,ee=A._offset-j;x.clipRect.call(h.setTranslate,Y,$).call(h.setScale,1/Z,1/H),x.plot.call(h.setTranslate,W,ee).call(h.setScale,Z,H),h.setPointGroupScale(x.zoomScalePts,1/Z,1/H),h.setTextPointsScale(x.zoomScaleTxt,1/Z,1/H)}e.redrawComponents(f)}},{"../../components/drawing":672,"../../lib":787,"../../registry":915,"./axes":838,"@plotly/d3":58}],864:[function(r,I,B){var t=r("../../registry").traceIs,d=r("./axis_autotype");function m(e){return{v:"x",h:"y"}[e.orientation||"v"]}function h(e,f){var l=m(e),o=t(e,"box-violin"),u=t(e._fullInput||{},"candlestick");return o&&!u&&f===l&&e[l]===void 0&&e[l+"0"]===void 0}I.exports=function(e,f,l,o){l("autotypenumbers",o.autotypenumbersDflt),l("type",(o.splomStash||{}).type)==="-"&&(function(u,s){if(u.type==="-"){var i,c=u._id,n=c.charAt(0);c.indexOf("scene")!==-1&&(c=n);var a=function(A,S,w){for(var E=0;E<A.length;E++){var k=A[E];if(k.type==="splom"&&k._length>0&&(k["_"+w+"axes"]||{})[S]||(k[w+"axis"]||w)===S&&(h(k,w)||(k[w]||[]).length||k[w+"0"]))return k}}(s,c,n);if(!!a){if(a.type==="histogram"&&n==={v:"y",h:"x"}[a.orientation||"v"])return void(u.type="linear");var g=n+"calendar",p=a[g],y={noMultiCategory:!t(a,"cartesian")||t(a,"noMultiCategory")};if(a.type==="box"&&a._hasPreCompStats&&n==={h:"x",v:"y"}[a.orientation||"v"]&&(y.noMultiCategory=!0),y.autotypenumbers=u.autotypenumbers,h(a,n)){var v=m(a),b=[];for(i=0;i<s.length;i++){var x=s[i];t(x,"box-violin")&&(x[n+"axis"]||n)===c&&(x[v]!==void 0?b.push(x[v][0]):x.name!==void 0?b.push(x.name):b.push("text"),x[g]!==p&&(p=void 0))}u.type=d(b,p,y)}else if(a.type==="splom"){var T=a.dimensions[a._axesDim[c]];T.visible&&(u.type=d(T.values,p,y))}else u.type=d(a[n]||[a[n+"0"]],p,y)}}}(f,o.data),f.type==="-"?f.type="linear":e.type=f.type)}},{"../../registry":915,"./axis_autotype":839}],865:[function(r,I,B){var t=r("../registry"),d=r("../lib");function m(l,o,u){var s,i,c,n=!1;if(o.type==="data")s=l._fullData[o.traces!==null?o.traces[0]:0];else{if(o.type!=="layout")return!1;s=l._fullLayout}return i=d.nestedProperty(s,o.prop).get(),(c=u[o.type]=u[o.type]||{}).hasOwnProperty(o.prop)&&c[o.prop]!==i&&(n=!0),c[o.prop]=i,{changed:n,value:i}}function h(l,o){var u=[],s=o[0],i={};if(typeof s=="string")i[s]=o[1];else{if(!d.isPlainObject(s))return u;i=s}return f(i,function(c,n,a){u.push({type:"layout",prop:c,value:a})},"",0),u}function e(l,o){var u,s,i,c,n=[];if(s=o[0],i=o[1],u=o[2],c={},typeof s=="string")c[s]=i;else{if(!d.isPlainObject(s))return n;c=s,u===void 0&&(u=i)}return u===void 0&&(u=null),f(c,function(a,g,p){var y,v;if(Array.isArray(p)){v=p.slice();var b=Math.min(v.length,l.data.length);u&&(b=Math.min(b,u.length)),y=[];for(var x=0;x<b;x++)y[x]=u?u[x]:x}else v=p,y=u?u.slice():null;if(y===null)Array.isArray(v)&&(v=v[0]);else if(Array.isArray(y)){if(!Array.isArray(v)){var T=v;v=[];for(var A=0;A<y.length;A++)v[A]=T}v.length=Math.min(y.length,v.length)}n.push({type:"data",prop:a,traces:y,value:v})},"",0),n}function f(l,o,u,s){Object.keys(l).forEach(function(i){var c=l[i];if(i[0]!=="_"){var n=u+(s>0?".":"")+i;d.isPlainObject(c)?f(c,o,n,s+1):o(n,i,c)}})}B.manageCommandObserver=function(l,o,u,s){var i={},c=!0;o&&o._commandObserver&&(i=o._commandObserver),i.cache||(i.cache={}),i.lookupTable={};var n=B.hasSimpleAPICommandBindings(l,u,i.lookupTable);if(o&&o._commandObserver){if(n)return i;if(o._commandObserver.remove)return o._commandObserver.remove(),o._commandObserver=null,i}if(n){m(l,n,i.cache),i.check=function(){if(c){var p=m(l,n,i.cache);return p.changed&&s&&i.lookupTable[p.value]!==void 0&&(i.disable(),Promise.resolve(s({value:p.value,type:n.type,prop:n.prop,traces:n.traces,index:i.lookupTable[p.value]})).then(i.enable,i.enable)),p.changed}};for(var a=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],g=0;g<a.length;g++)l._internalOn(a[g],i.check);i.remove=function(){for(var p=0;p<a.length;p++)l._removeInternalListener(a[p],i.check)}}else d.log("Unable to automatically bind plot updates to API command"),i.lookupTable={},i.remove=function(){};return i.disable=function(){c=!1},i.enable=function(){c=!0},o&&(o._commandObserver=i),i},B.hasSimpleAPICommandBindings=function(l,o,u){var s,i,c=o.length;for(s=0;s<c;s++){var n,a=o[s],g=a.method,p=a.args;if(Array.isArray(p)||(p=[]),!g)return!1;var y=B.computeAPICommandBindings(l,g,p);if(y.length!==1)return!1;if(i){if((n=y[0]).type!==i.type||n.prop!==i.prop)return!1;if(Array.isArray(i.traces)){if(!Array.isArray(n.traces))return!1;n.traces.sort();for(var v=0;v<i.traces.length;v++)if(i.traces[v]!==n.traces[v])return!1}else if(n.prop!==i.prop)return!1}else i=y[0],Array.isArray(i.traces)&&i.traces.sort();var b=(n=y[0]).value;if(Array.isArray(b)){if(b.length!==1)return!1;b=b[0]}u&&(u[b]=s)}return i},B.executeAPICommand=function(l,o,u){if(o==="skip")return Promise.resolve();var s=t.apiMethodRegistry[o],i=[l];Array.isArray(u)||(u=[]);for(var c=0;c<u.length;c++)i.push(u[c]);return s.apply(null,i).catch(function(n){return d.warn("API call to Plotly."+o+" rejected.",n),Promise.reject(n)})},B.computeAPICommandBindings=function(l,o,u){var s;switch(Array.isArray(u)||(u=[]),o){case"restyle":s=e(l,u);break;case"relayout":s=h(l,u);break;case"update":s=e(l,[u[0],u[2]]).concat(h(l,[u[1]]));break;case"animate":s=function(i,c){return Array.isArray(c[0])&&c[0].length===1&&["string","number"].indexOf(typeof c[0][0])!==-1?[{type:"layout",prop:"_currentFrame",value:c[0][0].toString()}]:[]}(0,u);break;default:s=[]}return s}},{"../lib":787,"../registry":915}],866:[function(r,I,B){var t=r("../lib/extend").extendFlat;B.attributes=function(d,m){m=m||{};var h={valType:"info_array",editType:(d=d||{}).editType,items:[{valType:"number",min:0,max:1,editType:d.editType},{valType:"number",min:0,max:1,editType:d.editType}],dflt:[0,1]},e=(d.name&&d.name,d.trace,m.description&&m.description,{x:t({},h,{}),y:t({},h,{}),editType:d.editType});return d.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:d.editType},e.column={valType:"integer",min:0,dflt:0,editType:d.editType}),e},B.defaults=function(d,m,h,e){var f=e&&e.x||[0,1],l=e&&e.y||[0,1],o=m.grid;if(o){var u=h("domain.column");u!==void 0&&(u<o.columns?f=o._domains.x[u]:delete d.domain.column);var s=h("domain.row");s!==void 0&&(s<o.rows?l=o._domains.y[s]:delete d.domain.row)}var i=h("domain.x",f),c=h("domain.y",l);i[0]<i[1]||(d.domain.x=f.slice()),c[0]<c[1]||(d.domain.y=l.slice())}},{"../lib/extend":777}],867:[function(r,I,B){I.exports=function(t){var d=t.editType,m=t.colorEditType;m===void 0&&(m=d);var h={family:{valType:"string",noBlank:!0,strict:!0,editType:d},size:{valType:"number",min:1,editType:d},color:{valType:"color",editType:m},editType:d};return t.arrayOk&&(h.family.arrayOk=!0,h.size.arrayOk=!0,h.color.arrayOk=!0),h}},{}],868:[function(r,I,B){I.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],869:[function(r,I,B){B.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},B.axesNames=["lonaxis","lataxis"],B.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},B.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},B.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},B.clipPad=.001,B.precision=.1,B.landColor="#F0DC82",B.waterColor="#3399FF",B.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},B.sphereSVG={type:"Sphere"},B.fillLayers={ocean:1,land:1,lakes:1},B.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},B.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],B.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],B.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],870:[function(r,I,B){var t=r("@plotly/d3"),d=r("d3-geo"),m=d.geoPath,h=d.geoDistance,e=r("d3-geo-projection"),f=r("../../registry"),l=r("../../lib"),o=l.strTranslate,u=r("../../components/color"),s=r("../../components/drawing"),i=r("../../components/fx"),c=r("../plots"),n=r("../cartesian/axes"),a=r("../cartesian/autorange").getAutoRange,g=r("../../components/dragelement"),p=r("../cartesian/select").prepSelect,y=r("../cartesian/select").clearSelect,v=r("../cartesian/select").selectOnClick,b=r("./zoom"),x=r("./constants"),T=r("../../lib/geo_location_utils"),A=r("../../lib/topojson_utils"),S=r("topojson-client").feature;function w(L){this.id=L.id,this.graphDiv=L.graphDiv,this.container=L.container,this.topojsonURL=L.topojsonURL,this.isStatic=L.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var E=w.prototype;function k(L,M){var P=x.clipPad,D=L[0]+P,N=L[1]-P,U=M[0]+P,G=M[1]-P;D>0&&N<0&&(N+=360);var X=(N-D)/4;return{type:"Polygon",coordinates:[[[D,U],[D,G],[D+X,G],[D+2*X,G],[D+3*X,G],[N,G],[N,U],[N-X,U],[N-2*X,U],[N-3*X,U],[D,U]]]}}I.exports=function(L){return new w(L)},E.plot=function(L,M,P){var D=this,N=M[this.id],U=[],G=!1;for(var X in x.layerNameToAdjective)if(X!=="frame"&&N["show"+X]){G=!0;break}for(var K=0;K<L.length;K++)if(L[0][0].trace.locationmode){G=!0;break}if(G){var Z=A.getTopojsonName(N);D.topojson!==null&&Z===D.topojsonName||(D.topojsonName=Z,PlotlyGeoAssets.topojson[D.topojsonName]===void 0&&U.push(D.fetchTopojson()))}U=U.concat(T.fetchTraceGeoData(L)),P.push(new Promise(function(H,Y){Promise.all(U).then(function(){D.topojson=PlotlyGeoAssets.topojson[D.topojsonName],D.update(L,M),H()}).catch(Y)}))},E.fetchTopojson=function(){var L=this,M=A.getTopojsonPath(L.topojsonURL,L.topojsonName);return new Promise(function(P,D){t.json(M,function(N,U){if(N)return N.status===404?D(new Error(["plotly.js could not find topojson file at",M,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):D(new Error(["unexpected error while fetching topojson file at",M].join(" ")));PlotlyGeoAssets.topojson[L.topojsonName]=U,P()})})},E.update=function(L,M){var P=M[this.id];this.hasChoropleth=!1;for(var D=0;D<L.length;D++){var N=L[D],U=N[0].trace;U.type==="choropleth"&&(this.hasChoropleth=!0),U.visible===!0&&U._length>0&&U._module.calcGeoJSON(N,M)}if(!this.updateProjection(L,M)){this.viewInitial&&this.scope===P.scope||this.saveViewInitial(P),this.scope=P.scope,this.updateBaseLayers(M,P),this.updateDims(M,P),this.updateFx(M,P),c.generalUpdatePerTraceModule(this.graphDiv,this,L,P);var G=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=G.selectAll(".point"),this.dataPoints.text=G.selectAll("text"),this.dataPaths.line=G.selectAll(".js-line");var X=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=X.selectAll("path"),this.render()}},E.updateProjection=function(L,M){var P=this.graphDiv,D=M[this.id],N=M._size,U=D.domain,G=D.projection,X=D.lonaxis,K=D.lataxis,Z=X._ax,H=K._ax,Y=this.projection=function(ce){var ge=ce.projection,we=ge.type,Me=x.projNames[we];Me="geo"+l.titleCase(Me);for(var Se=(d[Me]||e[Me])(),ze=ce._isSatellite?180*Math.acos(1/ge.distance)/Math.PI:ce._isClipped?x.lonaxisSpan[we]/2:null,Fe=["center","rotate","parallels","clipExtent"],Ye=function(je){return je?Se:[]},rt=0;rt<Fe.length;rt++){var Oe=Fe[rt];typeof Se[Oe]!="function"&&(Se[Oe]=Ye)}return Se.isLonLatOverEdges=function(je){if(Se(je)===null)return!0;if(ze){var We=Se.rotate();return h(je,[-We[0],-We[1]])>ze*Math.PI/180}return!1},Se.getPath=function(){return m().projection(Se)},Se.getBounds=function(je){return Se.getPath().bounds(je)},Se.precision(x.precision),ce._isSatellite&&Se.tilt(ge.tilt).distance(ge.distance),ze&&Se.clipAngle(ze-x.clipPad),Se}(D),$=[[N.l+N.w*U.x[0],N.t+N.h*(1-U.y[1])],[N.l+N.w*U.x[1],N.t+N.h*(1-U.y[0])]],z=D.center||{},j=G.rotation||{},W=X.range||[],ee=K.range||[];if(D.fitbounds){Z._length=$[1][0]-$[0][0],H._length=$[1][1]-$[0][1],Z.range=a(P,Z),H.range=a(P,H);var J=(Z.range[0]+Z.range[1])/2,Q=(H.range[0]+H.range[1])/2;if(D._isScoped)z={lon:J,lat:Q};else if(D._isClipped){z={lon:J,lat:Q},j={lon:J,lat:Q,roll:j.roll};var te=G.type,ie=x.lonaxisSpan[te]/2||180,ae=x.lataxisSpan[te]/2||90;W=[J-ie,J+ie],ee=[Q-ae,Q+ae]}else z={lon:J,lat:Q},j={lon:J,lat:j.lat,roll:j.roll}}Y.center([z.lon-j.lon,z.lat-j.lat]).rotate([-j.lon,-j.lat,j.roll]).parallels(G.parallels);var he=k(W,ee);Y.fitExtent($,he);var se=this.bounds=Y.getBounds(he),de=this.fitScale=Y.scale(),ue=Y.translate();if(D.fitbounds){var ve=Y.getBounds(k(Z.range,H.range)),ke=Math.min((se[1][0]-se[0][0])/(ve[1][0]-ve[0][0]),(se[1][1]-se[0][1])/(ve[1][1]-ve[0][1]));isFinite(ke)?Y.scale(ke*de):l.warn("Something went wrong during"+this.id+"fitbounds computations.")}else Y.scale(G.scale*de);var Ee=this.midPt=[(se[0][0]+se[1][0])/2,(se[0][1]+se[1][1])/2];if(Y.translate([ue[0]+(Ee[0]-ue[0]),ue[1]+(Ee[1]-ue[1])]).clipExtent(se),D._isAlbersUsa){var be=Y([z.lon,z.lat]),xe=Y.translate();Y.translate([xe[0]-(be[0]-xe[0]),xe[1]-(be[1]-xe[1])])}},E.updateBaseLayers=function(L,M){var P=this,D=P.topojson,N=P.layers,U=P.basePaths;function G(Y){return Y==="lonaxis"||Y==="lataxis"}function X(Y){return Boolean(x.lineLayers[Y])}function K(Y){return Boolean(x.fillLayers[Y])}var Z=(this.hasChoropleth?x.layersForChoropleth:x.layers).filter(function(Y){return X(Y)||K(Y)?M["show"+Y]:!G(Y)||M[Y].showgrid}),H=P.framework.selectAll(".layer").data(Z,String);H.exit().each(function(Y){delete N[Y],delete U[Y],t.select(this).remove()}),H.enter().append("g").attr("class",function(Y){return"layer "+Y}).each(function(Y){var $=N[Y]=t.select(this);Y==="bg"?P.bgRect=$.append("rect").style("pointer-events","all"):G(Y)?U[Y]=$.append("path").style("fill","none"):Y==="backplot"?$.append("g").classed("choroplethlayer",!0):Y==="frontplot"?$.append("g").classed("scatterlayer",!0):X(Y)?U[Y]=$.append("path").style("fill","none").style("stroke-miterlimit",2):K(Y)&&(U[Y]=$.append("path").style("stroke","none"))}),H.order(),H.each(function(Y){var $=U[Y],z=x.layerNameToAdjective[Y];Y==="frame"?$.datum(x.sphereSVG):X(Y)||K(Y)?$.datum(S(D,D.objects[Y])):G(Y)&&$.datum(function(j,W,ee){var J,Q,te,ie=W[j],ae=x.scopeDefaults[W.scope];j==="lonaxis"?(J=ae.lonaxisRange,Q=ae.lataxisRange,te=function(xe,ce){return[xe,ce]}):j==="lataxis"&&(J=ae.lataxisRange,Q=ae.lonaxisRange,te=function(xe,ce){return[ce,xe]});var he={type:"linear",range:[J[0],J[1]-1e-6],tick0:ie.tick0,dtick:ie.dtick};n.setConvert(he,ee);var se=n.calcTicks(he);W.isScoped||j!=="lonaxis"||se.pop();for(var de=se.length,ue=new Array(de),ve=0;ve<de;ve++)for(var ke=se[ve].x,Ee=ue[ve]=[],be=Q[0];be<Q[1]+2.5;be+=2.5)Ee.push(te(ke,be));return{type:"MultiLineString",coordinates:ue}}(Y,M,L)).call(u.stroke,M[Y].gridcolor).call(s.dashLine,"",M[Y].gridwidth),X(Y)?$.call(u.stroke,M[z+"color"]).call(s.dashLine,"",M[z+"width"]):K(Y)&&$.call(u.fill,M[z+"color"])})},E.updateDims=function(L,M){var P=this.bounds,D=(M.framewidth||0)/2,N=P[0][0]-D,U=P[0][1]-D,G=P[1][0]-N+D,X=P[1][1]-U+D;s.setRect(this.clipRect,N,U,G,X),this.bgRect.call(s.setRect,N,U,G,X).call(u.fill,M.bgcolor),this.xaxis._offset=N,this.xaxis._length=G,this.yaxis._offset=U,this.yaxis._length=X},E.updateFx=function(L,M){var P=this,D=P.graphDiv,N=P.bgRect,U=L.dragmode,G=L.clickmode;if(!P.isStatic){var X;U==="select"?X=function(H,Y){(H.range={})[P.id]=[Z([Y.xmin,Y.ymin]),Z([Y.xmax,Y.ymax])]}:U==="lasso"&&(X=function(H,Y,$){(H.lassoPoints={})[P.id]=$.filtered.map(Z)});var K={element:P.bgRect.node(),gd:D,plotinfo:{id:P.id,xaxis:P.xaxis,yaxis:P.yaxis,fillRangeItems:X},xaxes:[P.xaxis],yaxes:[P.yaxis],subplot:P.id,clickFn:function(H){H===2&&y(D)}};U==="pan"?(N.node().onmousedown=null,N.call(b(P,M)),N.on("dblclick.zoom",function(){var H=P.viewInitial,Y={};for(var $ in H)Y[P.id+"."+$]=H[$];f.call("_guiRelayout",D,Y),D.emit("plotly_doubleclick",null)}),D._context._scrollZoom.geo||N.on("wheel.zoom",null)):U!=="select"&&U!=="lasso"||(N.on(".zoom",null),K.prepFn=function(H,Y,$){p(H,Y,$,K,U)},g.init(K)),N.on("mousemove",function(){var H=P.projection.invert(l.getPositionFromD3Event());if(!H)return g.unhover(D,t.event);P.xaxis.p2c=function(){return H[0]},P.yaxis.p2c=function(){return H[1]},i.hover(D,t.event,P.id)}),N.on("mouseout",function(){D._dragging||g.unhover(D,t.event)}),N.on("click",function(){U!=="select"&&U!=="lasso"&&(G.indexOf("select")>-1&&v(t.event,D,[P.xaxis],[P.yaxis],P.id,K),G.indexOf("event")>-1&&i.click(D,t.event))})}function Z(H){return P.projection.invert([H[0]+P.xaxis._offset,H[1]+P.yaxis._offset])}},E.makeFramework=function(){var L=this,M=L.graphDiv,P=M._fullLayout,D="clip"+P._uid+L.id;L.clipDef=P._clips.append("clipPath").attr("id",D),L.clipRect=L.clipDef.append("rect"),L.framework=t.select(L.container).append("g").attr("class","geo "+L.id).call(s.setClipUrl,D,M),L.project=function(N){var U=L.projection(N);return U?[U[0]-L.xaxis._offset,U[1]-L.yaxis._offset]:[null,null]},L.xaxis={_id:"x",c2p:function(N){return L.project(N)[0]}},L.yaxis={_id:"y",c2p:function(N){return L.project(N)[1]}},L.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},n.setConvert(L.mockAxis,P)},E.saveViewInitial=function(L){var M,P=L.center||{},D=L.projection,N=D.rotation||{};this.viewInitial={fitbounds:L.fitbounds,"projection.scale":D.scale},M=L._isScoped?{"center.lon":P.lon,"center.lat":P.lat}:L._isClipped?{"projection.rotation.lon":N.lon,"projection.rotation.lat":N.lat}:{"center.lon":P.lon,"center.lat":P.lat,"projection.rotation.lon":N.lon},l.extendFlat(this.viewInitial,M)},E.render=function(){var L,M=this.projection,P=M.getPath();function D(U){var G=M(U.lonlat);return G?o(G[0],G[1]):null}function N(U){return M.isLonLatOverEdges(U.lonlat)?"none":null}for(L in this.basePaths)this.basePaths[L].attr("d",P);for(L in this.dataPaths)this.dataPaths[L].attr("d",function(U){return P(U.geojson)});for(L in this.dataPoints)this.dataPoints[L].attr("display",N).attr("transform",D)}},{"../../components/color":650,"../../components/dragelement":669,"../../components/drawing":672,"../../components/fx":690,"../../lib":787,"../../lib/geo_location_utils":780,"../../lib/topojson_utils":816,"../../registry":915,"../cartesian/autorange":837,"../cartesian/axes":838,"../cartesian/select":858,"../plots":901,"./constants":869,"./zoom":874,"@plotly/d3":58,"d3-geo":166,"d3-geo-projection":165,"topojson-client":586}],871:[function(r,I,B){var t=r("../../plots/get_data").getSubplotCalcData,d=r("../../lib").counterRegex,m=r("./geo"),h="geo",e=d(h),f={};f.geo={valType:"subplotid",dflt:h,editType:"calc"},I.exports={attr:h,name:h,idRoot:h,idRegex:e,attrRegex:e,attributes:f,layoutAttributes:r("./layout_attributes"),supplyLayoutDefaults:r("./layout_defaults"),plot:function(l){for(var o=l._fullLayout,u=l.calcdata,s=o._subplots.geo,i=0;i<s.length;i++){var c=s[i],n=t(u,h,c),a=o[c]._subplot;a||(a=m({id:c,graphDiv:l,container:o._geolayer.node(),topojsonURL:l._context.topojsonURL,staticPlot:l._context.staticPlot}),o[c]._subplot=a),a.plot(n,o,l._promises)}},updateFx:function(l){for(var o=l._fullLayout,u=o._subplots.geo,s=0;s<u.length;s++){var i=o[u[s]];i._subplot.updateFx(o,i)}},clean:function(l,o,u,s){for(var i=s._subplots.geo||[],c=0;c<i.length;c++){var n=i[c],a=s[n]._subplot;!o[n]&&a&&(a.framework.remove(),a.clipDef.remove())}}}},{"../../lib":787,"../../plots/get_data":875,"./geo":870,"./layout_attributes":872,"./layout_defaults":873}],872:[function(r,I,B){var t=r("../../components/color/attributes"),d=r("../domain").attributes,m=r("./constants"),h=r("../../plot_api/edit_types").overrideAll,e=r("../../lib/sort_object_keys"),f={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:t.lightLine},gridwidth:{valType:"number",min:0,dflt:1}};(I.exports=h({domain:d({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:e(m.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:e(m.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:t.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:m.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:m.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:m.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:m.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:t.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:t.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:t.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:t.background},lonaxis:f,lataxis:f},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":649,"../../lib/sort_object_keys":810,"../../plot_api/edit_types":820,"../domain":866,"./constants":869}],873:[function(r,I,B){var t=r("../../lib"),d=r("../subplot_defaults"),m=r("../get_data").getSubplotData,h=r("./constants"),e=r("./layout_attributes"),f=h.axesNames;function l(o,u,s,i){var c=m(i.fullData,"geo",i.id).map(function(j){return j._expandedIndex}),n=s("resolution"),a=s("scope"),g=h.scopeDefaults[a],p=s("projection.type",g.projType),y=u._isAlbersUsa=p==="albers usa";y&&(a=u.scope="usa");var v=u._isScoped=a!=="world",b=u._isSatellite=p==="satellite",x=u._isConic=p.indexOf("conic")!==-1||p==="albers",T=u._isClipped=!!h.lonaxisSpan[p];if(o.visible===!1){var A=t.extendDeep({},u._template);A.showcoastlines=!1,A.showcountries=!1,A.showframe=!1,A.showlakes=!1,A.showland=!1,A.showocean=!1,A.showrivers=!1,A.showsubunits=!1,A.lonaxis&&(A.lonaxis.showgrid=!1),A.lataxis&&(A.lataxis.showgrid=!1),u._template=A}for(var S=s("visible"),w=0;w<f.length;w++){var E,k=f[w],L=[30,10][w];if(v)E=g[k+"Range"];else{var M=h[k+"Span"],P=(M[p]||M["*"])/2,D=s("projection.rotation."+k.substr(0,3),g.projRotate[w]);E=[D-P,D+P]}var N=s(k+".range",E);s(k+".tick0"),s(k+".dtick",L),s(k+".showgrid",!!S&&void 0)&&(s(k+".gridcolor"),s(k+".gridwidth")),u[k]._ax={type:"linear",_id:k.slice(0,3),_traceIndices:c,setScale:t.identity,c2l:t.identity,r2l:t.identity,autorange:!0,range:N.slice(),_m:1,_input:{}}}var U=u.lonaxis.range,G=u.lataxis.range,X=U[0],K=U[1];X>0&&K<0&&(K+=360);var Z,H,Y,$=(X+K)/2;if(!y){var z=v?g.projRotate:[$,0,0];Z=s("projection.rotation.lon",z[0]),s("projection.rotation.lat",z[1]),s("projection.rotation.roll",z[2]),s("showcoastlines",!v&&S)&&(s("coastlinecolor"),s("coastlinewidth")),s("showocean",!!S&&void 0)&&s("oceancolor")}y?(H=-96.6,Y=38.7):(H=v?$:Z,Y=(G[0]+G[1])/2),s("center.lon",H),s("center.lat",Y),b&&(s("projection.tilt"),s("projection.distance")),x&&s("projection.parallels",g.projParallels||[0,60]),s("projection.scale"),s("showland",!!S&&void 0)&&s("landcolor"),s("showlakes",!!S&&void 0)&&s("lakecolor"),s("showrivers",!!S&&void 0)&&(s("rivercolor"),s("riverwidth")),s("showcountries",v&&a!=="usa"&&S)&&(s("countrycolor"),s("countrywidth")),(a==="usa"||a==="north america"&&n===50)&&(s("showsubunits",S),s("subunitcolor"),s("subunitwidth")),v||s("showframe",S)&&(s("framecolor"),s("framewidth")),s("bgcolor"),s("fitbounds")&&(delete u.projection.scale,v?(delete u.center.lon,delete u.center.lat):T?(delete u.center.lon,delete u.center.lat,delete u.projection.rotation.lon,delete u.projection.rotation.lat,delete u.lonaxis.range,delete u.lataxis.range):(delete u.center.lon,delete u.center.lat,delete u.projection.rotation.lon))}I.exports=function(o,u,s){d(o,u,s,{type:"geo",attributes:e,handleDefaults:l,fullData:s,partition:"y"})}},{"../../lib":787,"../get_data":875,"../subplot_defaults":909,"./constants":869,"./layout_attributes":872}],874:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../registry"),h=Math.PI/180,e=180/Math.PI,f={cursor:"pointer"},l={cursor:"auto"};function o(S,w){return t.behavior.zoom().translate(w.translate()).scale(w.scale())}function u(S,w,E){var k=S.id,L=S.graphDiv,M=L.layout,P=M[k],D=L._fullLayout,N=D[k],U={},G={};function X(K,Z){U[k+"."+K]=d.nestedProperty(P,K).get(),m.call("_storeDirectGUIEdit",M,D._preGUI,U);var H=d.nestedProperty(N,K);H.get()!==Z&&(H.set(Z),d.nestedProperty(P,K).set(Z),G[k+"."+K]=Z)}E(X),X("projection.scale",w.scale()/S.fitScale),X("fitbounds",!1),L.emit("plotly_relayout",G)}function s(S,w){var E=o(0,w);function k(L){var M=w.invert(S.midPt);L("center.lon",M[0]),L("center.lat",M[1])}return E.on("zoomstart",function(){t.select(this).style(f)}).on("zoom",function(){w.scale(t.event.scale).translate(t.event.translate),S.render();var L=w.invert(S.midPt);S.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":w.scale()/S.fitScale,"geo.center.lon":L[0],"geo.center.lat":L[1]})}).on("zoomend",function(){t.select(this).style(l),u(S,w,k)}),E}function i(S,w){var E,k,L,M,P,D,N,U,G,X=o(0,w);function K(H){return w.invert(H)}function Z(H){var Y=w.rotate(),$=w.invert(S.midPt);H("projection.rotation.lon",-Y[0]),H("center.lon",$[0]),H("center.lat",$[1])}return X.on("zoomstart",function(){t.select(this).style(f),E=t.mouse(this),k=w.rotate(),L=w.translate(),M=k,P=K(E)}).on("zoom",function(){if(D=t.mouse(this),function($){var z=K($);if(!z)return!0;var j=w(z);return Math.abs(j[0]-$[0])>2||Math.abs(j[1]-$[1])>2}(E))return X.scale(w.scale()),void X.translate(w.translate());w.scale(t.event.scale),w.translate([L[0],t.event.translate[1]]),P?K(D)&&(U=K(D),N=[M[0]+(U[0]-P[0]),k[1],k[2]],w.rotate(N),M=N):P=K(E=D),G=!0,S.render();var H=w.rotate(),Y=w.invert(S.midPt);S.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":w.scale()/S.fitScale,"geo.center.lon":Y[0],"geo.center.lat":Y[1],"geo.projection.rotation.lon":-H[0]})}).on("zoomend",function(){t.select(this).style(l),G&&u(S,w,Z)}),X}function c(S,w){var E,k={r:w.rotate(),k:w.scale()},L=o(0,w),M=function(K){for(var Z=0,H=arguments.length,Y=[];++Z<H;)Y.push(arguments[Z]);var $=t.dispatch.apply(null,Y);return $.of=function(z,j){return function(W){var ee;try{ee=W.sourceEvent=t.event,W.target=K,t.event=W,$[W.type].apply(z,j)}finally{t.event=ee}}},$}(L,"zoomstart","zoom","zoomend"),P=0,D=L.on;function N(K){P++||K({type:"zoomstart"})}function U(K){K({type:"zoom"})}function G(K){--P||K({type:"zoomend"})}function X(K){var Z=w.rotate();K("projection.rotation.lon",-Z[0]),K("projection.rotation.lat",-Z[1])}return L.on("zoomstart",function(){t.select(this).style(f);var K=t.mouse(this),Z=w.rotate(),H=Z,Y=w.translate(),$=a(Z);E=n(w,K),D.call(L,"zoom",function(){var z=t.mouse(this);if(w.scale(k.k=t.event.scale),E){if(n(w,z)){w.rotate(Z).translate(Y);var j=n(w,z),W=p(E,j),ee=T(g($,W)),J=k.r=y(ee,E,H);isFinite(J[0])&&isFinite(J[1])&&isFinite(J[2])||(J=H),w.rotate(J),H=J}}else E=n(w,K=z);U(M.of(this,arguments))}),N(M.of(this,arguments))}).on("zoomend",function(){t.select(this).style(l),D.call(L,"zoom",null),G(M.of(this,arguments)),u(S,w,X)}).on("zoom.redraw",function(){S.render();var K=w.rotate();S.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":w.scale()/S.fitScale,"geo.projection.rotation.lon":-K[0],"geo.projection.rotation.lat":-K[1]})}),t.rebind(L,M,"on")}function n(S,w){var E=S.invert(w);return E&&isFinite(E[0])&&isFinite(E[1])&&function(k){var L=k[0]*h,M=k[1]*h,P=Math.cos(M);return[P*Math.cos(L),P*Math.sin(L),Math.sin(M)]}(E)}function a(S){var w=.5*S[0]*h,E=.5*S[1]*h,k=.5*S[2]*h,L=Math.sin(w),M=Math.cos(w),P=Math.sin(E),D=Math.cos(E),N=Math.sin(k),U=Math.cos(k);return[M*D*U+L*P*N,L*D*U-M*P*N,M*P*U+L*D*N,M*D*N-L*P*U]}function g(S,w){var E=S[0],k=S[1],L=S[2],M=S[3],P=w[0],D=w[1],N=w[2],U=w[3];return[E*P-k*D-L*N-M*U,E*D+k*P+L*U-M*N,E*N-k*U+L*P+M*D,E*U+k*N-L*D+M*P]}function p(S,w){if(S&&w){var E=function(P,D){return[P[1]*D[2]-P[2]*D[1],P[2]*D[0]-P[0]*D[2],P[0]*D[1]-P[1]*D[0]]}(S,w),k=Math.sqrt(A(E,E)),L=.5*Math.acos(Math.max(-1,Math.min(1,A(S,w)))),M=Math.sin(L)/k;return k&&[Math.cos(L),E[2]*M,-E[1]*M,E[0]*M]}}function y(S,w,E){var k=x(w,2,S[0]);k=x(k,1,S[1]),k=x(k,0,S[2]-E[2]);var L,M,P=w[0],D=w[1],N=w[2],U=k[0],G=k[1],X=k[2],K=Math.atan2(D,P)*e,Z=Math.sqrt(P*P+D*D);Math.abs(G)>Z?(M=(G>0?90:-90)-K,L=0):(M=Math.asin(G/Z)*e-K,L=Math.sqrt(Z*Z-G*G));var H=180-M-2*K,Y=(Math.atan2(X,U)-Math.atan2(N,L))*e,$=(Math.atan2(X,U)-Math.atan2(N,-L))*e;return v(E[0],E[1],M,Y)<=v(E[0],E[1],H,$)?[M,Y,E[2]]:[H,$,E[2]]}function v(S,w,E,k){var L=b(E-S),M=b(k-w);return Math.sqrt(L*L+M*M)}function b(S){return(S%360+540)%360-180}function x(S,w,E){var k=E*h,L=S.slice(),M=w===0?1:0,P=w===2?1:2,D=Math.cos(k),N=Math.sin(k);return L[M]=S[M]*D-S[P]*N,L[P]=S[P]*D+S[M]*N,L}function T(S){return[Math.atan2(2*(S[0]*S[1]+S[2]*S[3]),1-2*(S[1]*S[1]+S[2]*S[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(S[0]*S[2]-S[3]*S[1]))))*e,Math.atan2(2*(S[0]*S[3]+S[1]*S[2]),1-2*(S[2]*S[2]+S[3]*S[3]))*e]}function A(S,w){for(var E=0,k=0,L=S.length;k<L;++k)E+=S[k]*w[k];return E}I.exports=function(S,w){var E=S.projection;return(w._isScoped?s:w._isClipped?c:i)(S,E)}},{"../../lib":787,"../../registry":915,"@plotly/d3":58}],875:[function(r,I,B){var t=r("../registry"),d=r("./cartesian/constants").SUBPLOT_PATTERN;B.getSubplotCalcData=function(m,h,e){var f=t.subplotsRegistry[h];if(!f)return[];for(var l=f.attr,o=[],u=0;u<m.length;u++){var s=m[u];s[0].trace[l]===e&&o.push(s)}return o},B.getModuleCalcData=function(m,h){var e,f=[],l=[];if(!(e=typeof h=="string"?t.getModule(h).plot:typeof h=="function"?h:h.plot))return[f,m];for(var o=0;o<m.length;o++){var u=m[o],s=u[0].trace;s.visible===!0&&s._length!==0&&(s._module.plot===e?f.push(u):l.push(u))}return[f,l]},B.getSubplotData=function(m,h,e){if(!t.subplotsRegistry[h])return[];var f,l,o,u=t.subplotsRegistry[h].attr,s=[];if(h==="gl2d"){var i=e.match(d);l="x"+i[1],o="y"+i[2]}for(var c=0;c<m.length;c++)f=m[c],h==="gl2d"&&t.traceIs(f,"gl2d")?f[u[0]]===l&&f[u[1]]===o&&s.push(f):f[u]===e&&s.push(f);return s}},{"../registry":915,"./cartesian/constants":845}],876:[function(r,I,B){var t=r("mouse-change"),d=r("mouse-wheel"),m=r("mouse-event-offset"),h=r("../cartesian/constants"),e=r("has-passive-events");function f(l,o){this.element=l,this.plot=o,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}I.exports=function(l){var o=l.mouseContainer,u=l.glplot,s=new f(o,u);function i(){l.xaxis.autorange=!1,l.yaxis.autorange=!1}function c(n,a,g){var p,y,v=l.calcDataBox(),b=u.viewBox,x=s.lastPos[0],T=s.lastPos[1],A=h.MINDRAG*u.pixelRatio,S=h.MINZOOM*u.pixelRatio;function w(D,N,U){var G=Math.min(N,U),X=Math.max(N,U);G!==X?(v[D]=G,v[D+2]=X,s.dataBox=v,l.setRanges(v)):(l.selectBox.selectBox=[0,0,1,1],l.glplot.setDirty())}switch(a*=u.pixelRatio,g*=u.pixelRatio,g=b[3]-b[1]-g,l.fullLayout.dragmode){case"zoom":if(n){var E=a/(b[2]-b[0])*(v[2]-v[0])+v[0],k=g/(b[3]-b[1])*(v[3]-v[1])+v[1];s.boxInited||(s.boxStart[0]=E,s.boxStart[1]=k,s.dragStart[0]=a,s.dragStart[1]=g),s.boxEnd[0]=E,s.boxEnd[1]=k,s.boxInited=!0,s.boxEnabled||s.boxStart[0]===s.boxEnd[0]&&s.boxStart[1]===s.boxEnd[1]||(s.boxEnabled=!0);var L=Math.abs(s.dragStart[0]-a)<S,M=Math.abs(s.dragStart[1]-g)<S;if(!function(){for(var D=l.graphDiv._fullLayout._axisConstraintGroups,N=l.xaxis._id,U=l.yaxis._id,G=0;G<D.length;G++)if(D[G][N]!==-1){if(D[G][U]!==-1)return!0;break}return!1}()||L&&M)L&&(s.boxEnd[0]=s.boxStart[0]),M&&(s.boxEnd[1]=s.boxStart[1]);else{p=s.boxEnd[0]-s.boxStart[0],y=s.boxEnd[1]-s.boxStart[1];var P=(v[3]-v[1])/(v[2]-v[0]);Math.abs(p*P)>Math.abs(y)?(s.boxEnd[1]=s.boxStart[1]+Math.abs(p)*P*(y>=0?1:-1),s.boxEnd[1]<v[1]?(s.boxEnd[1]=v[1],s.boxEnd[0]=s.boxStart[0]+(v[1]-s.boxStart[1])/Math.abs(P)):s.boxEnd[1]>v[3]&&(s.boxEnd[1]=v[3],s.boxEnd[0]=s.boxStart[0]+(v[3]-s.boxStart[1])/Math.abs(P))):(s.boxEnd[0]=s.boxStart[0]+Math.abs(y)/P*(p>=0?1:-1),s.boxEnd[0]<v[0]?(s.boxEnd[0]=v[0],s.boxEnd[1]=s.boxStart[1]+(v[0]-s.boxStart[0])*Math.abs(P)):s.boxEnd[0]>v[2]&&(s.boxEnd[0]=v[2],s.boxEnd[1]=s.boxStart[1]+(v[2]-s.boxStart[0])*Math.abs(P)))}}else s.boxEnabled?(p=s.boxStart[0]!==s.boxEnd[0],y=s.boxStart[1]!==s.boxEnd[1],p||y?(p&&(w(0,s.boxStart[0],s.boxEnd[0]),l.xaxis.autorange=!1),y&&(w(1,s.boxStart[1],s.boxEnd[1]),l.yaxis.autorange=!1),l.relayoutCallback()):l.glplot.setDirty(),s.boxEnabled=!1,s.boxInited=!1):s.boxInited&&(s.boxInited=!1);break;case"pan":s.boxEnabled=!1,s.boxInited=!1,n?(s.panning||(s.dragStart[0]=a,s.dragStart[1]=g),Math.abs(s.dragStart[0]-a)<A&&(a=s.dragStart[0]),Math.abs(s.dragStart[1]-g)<A&&(g=s.dragStart[1]),p=(x-a)*(v[2]-v[0])/(u.viewBox[2]-u.viewBox[0]),y=(T-g)*(v[3]-v[1])/(u.viewBox[3]-u.viewBox[1]),v[0]+=p,v[2]+=p,v[1]+=y,v[3]+=y,l.setRanges(v),s.panning=!0,s.lastInputTime=Date.now(),i(),l.cameraChanged(),l.handleAnnotations()):s.panning&&(s.panning=!1,l.relayoutCallback())}s.lastPos[0]=a,s.lastPos[1]=g}return s.mouseListener=t(o,c),o.addEventListener("touchstart",function(n){var a=m(n.changedTouches[0],o);c(0,a[0],a[1]),c(1,a[0],a[1]),n.preventDefault()},!!e&&{passive:!1}),o.addEventListener("touchmove",function(n){n.preventDefault();var a=m(n.changedTouches[0],o);c(1,a[0],a[1]),n.preventDefault()},!!e&&{passive:!1}),o.addEventListener("touchend",function(n){c(0,s.lastPos[0],s.lastPos[1]),n.preventDefault()},!!e&&{passive:!1}),s.wheelListener=d(o,function(n,a){if(!l.scrollZoom)return!1;var g=l.calcDataBox(),p=u.viewBox,y=s.lastPos[0],v=s.lastPos[1],b=Math.exp(5*a/(p[3]-p[1])),x=y/(p[2]-p[0])*(g[2]-g[0])+g[0],T=v/(p[3]-p[1])*(g[3]-g[1])+g[1];return g[0]=(g[0]-x)*b+x,g[2]=(g[2]-x)*b+x,g[1]=(g[1]-T)*b+T,g[3]=(g[3]-T)*b+T,l.setRanges(g),s.lastInputTime=Date.now(),i(),l.cameraChanged(),l.handleAnnotations(),l.relayoutCallback(),!0},!0),s}},{"../cartesian/constants":845,"has-passive-events":436,"mouse-change":459,"mouse-event-offset":460,"mouse-wheel":462}],877:[function(r,I,B){var t=r("../cartesian/axes"),d=r("../../lib/str2rgbarray");function m(f){this.scene=f,this.gl=f.gl,this.pixelRatio=f.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var h=m.prototype,e=["xaxis","yaxis"];h.merge=function(f){var l,o,u,s,i,c,n,a,g,p,y;for(this.titleEnable=!1,this.backgroundColor=d(f.plot_bgcolor),p=0;p<2;++p){var v=(l=e[p]).charAt(0);for(u=(o=f[this.scene[l]._name]).title.text===this.scene.fullLayout._dfltTitle[v]?"":o.title.text,y=0;y<=2;y+=2)this.labelEnable[p+y]=!1,this.labels[p+y]=u,this.labelColor[p+y]=d(o.title.font.color),this.labelFont[p+y]=o.title.font.family,this.labelSize[p+y]=o.title.font.size,this.labelPad[p+y]=this.getLabelPad(l,o),this.tickEnable[p+y]=!1,this.tickColor[p+y]=d((o.tickfont||{}).color),this.tickAngle[p+y]=o.tickangle==="auto"?0:Math.PI*-o.tickangle/180,this.tickPad[p+y]=this.getTickPad(o),this.tickMarkLength[p+y]=0,this.tickMarkWidth[p+y]=o.tickwidth||0,this.tickMarkColor[p+y]=d(o.tickcolor),this.borderLineEnable[p+y]=!1,this.borderLineColor[p+y]=d(o.linecolor),this.borderLineWidth[p+y]=o.linewidth||0;n=this.hasSharedAxis(o),i=this.hasAxisInDfltPos(l,o)&&!n,c=this.hasAxisInAltrPos(l,o)&&!n,s=o.mirror||!1,a=n?String(s).indexOf("all")!==-1:!!s,g=n?s==="allticks":String(s).indexOf("ticks")!==-1,i?this.labelEnable[p]=!0:c&&(this.labelEnable[p+2]=!0),i?this.tickEnable[p]=o.showticklabels:c&&(this.tickEnable[p+2]=o.showticklabels),(i||a)&&(this.borderLineEnable[p]=o.showline),(c||a)&&(this.borderLineEnable[p+2]=o.showline),(i||g)&&(this.tickMarkLength[p]=this.getTickMarkLength(o)),(c||g)&&(this.tickMarkLength[p+2]=this.getTickMarkLength(o)),this.gridLineEnable[p]=o.showgrid,this.gridLineColor[p]=d(o.gridcolor),this.gridLineWidth[p]=o.gridwidth,this.zeroLineEnable[p]=o.zeroline,this.zeroLineColor[p]=d(o.zerolinecolor),this.zeroLineWidth[p]=o.zerolinewidth}},h.hasSharedAxis=function(f){var l=this.scene,o=l.fullLayout._subplots.gl2d;return t.findSubplotsWithAxis(o,f).indexOf(l.id)!==0},h.hasAxisInDfltPos=function(f,l){var o=l.side;return f==="xaxis"?o==="bottom":f==="yaxis"?o==="left":void 0},h.hasAxisInAltrPos=function(f,l){var o=l.side;return f==="xaxis"?o==="top":f==="yaxis"?o==="right":void 0},h.getLabelPad=function(f,l){var o=l.title.font.size,u=l.showticklabels;return f==="xaxis"?l.side==="top"?o*(1.5+(u?1:0))-10:o*(1.5+(u?.5:0))-10:f==="yaxis"?l.side==="right"?10+o*(1.5+(u?1:.5)):10+o*(1.5+(u?.5:0)):void 0},h.getTickPad=function(f){return f.ticks==="outside"?10+f.ticklen:15},h.getTickMarkLength=function(f){if(!f.ticks)return 0;var l=f.ticklen;return f.ticks==="inside"?-l:l},I.exports=function(f){return new m(f)}},{"../../lib/str2rgbarray":812,"../cartesian/axes":838}],878:[function(r,I,B){var t=r("../../plot_api/edit_types").overrideAll,d=r("./scene2d"),m=r("../layout_attributes"),h=r("../../constants/xmlns_namespaces"),e=r("../cartesian/constants"),f=r("../cartesian"),l=r("../../components/fx/layout_attributes"),o=r("../get_data").getSubplotData;B.name="gl2d",B.attr=["xaxis","yaxis"],B.idRoot=["x","y"],B.idRegex=e.idRegex,B.attrRegex=e.attrRegex,B.attributes=r("../cartesian/attributes"),B.supplyLayoutDefaults=function(u,s,i){s._has("cartesian")||f.supplyLayoutDefaults(u,s,i)},B.layoutAttrOverrides=t(f.layoutAttributes,"plot","from-root"),B.baseLayoutAttrOverrides=t({plot_bgcolor:m.plot_bgcolor,hoverlabel:l.hoverlabel},"plot","nested"),B.plot=function(u){for(var s=u._fullLayout,i=u._fullData,c=s._subplots.gl2d,n=0;n<c.length;n++){var a=c[n],g=s._plots[a],p=o(i,"gl2d",a),y=g._scene2d;y===void 0&&(y=new d({id:a,graphDiv:u,container:u.querySelector(".gl-container"),staticPlot:u._context.staticPlot,plotGlPixelRatio:u._context.plotGlPixelRatio},s),g._scene2d=y),y.plot(p,u.calcdata,s,u.layout)}},B.clean=function(u,s,i,c){for(var n=c._subplots.gl2d||[],a=0;a<n.length;a++){var g=n[a],p=c._plots[g];if(p._scene2d){var y=o(u,"gl2d",g);y.length===0&&(p._scene2d.destroy(),delete c._plots[g])}}f.clean.apply(this,arguments)},B.drawFramework=function(u){u._context.staticPlot||f.drawFramework(u)},B.toSVG=function(u){for(var s=u._fullLayout,i=s._subplots.gl2d,c=0;c<i.length;c++){var n=s._plots[i[c]]._scene2d,a=n.toImage("png");s._glimages.append("svg:image").attr({xmlns:h.svg,"xlink:href":a,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),n.destroy()}},B.updateFx=function(u){for(var s=u._fullLayout,i=s._subplots.gl2d,c=0;c<i.length;c++)s._plots[i[c]]._scene2d.updateFx(s.dragmode)}},{"../../components/fx/layout_attributes":691,"../../constants/xmlns_namespaces":764,"../../plot_api/edit_types":820,"../cartesian":852,"../cartesian/attributes":836,"../cartesian/constants":845,"../get_data":875,"../layout_attributes":892,"./scene2d":879}],879:[function(r,I,B){var t,d,m=r("../../registry"),h=r("../../plots/cartesian/axes"),e=r("../../components/fx"),f=r("gl-plot2d"),l=r("gl-spikes2d"),o=r("gl-select-box"),u=r("webgl-context"),s=r("./convert"),i=r("./camera"),c=r("../../lib/show_no_webgl_msg"),n=r("../cartesian/constraints"),a=n.enforce,g=n.clean,p=r("../cartesian/autorange").doAutoRange,y=r("../../components/dragelement/helpers"),v=y.drawMode,b=y.selectMode,x=["xaxis","yaxis"],T=r("../cartesian/constants").SUBPLOT_PATTERN;function A(w,E){this.container=w.container,this.graphDiv=w.graphDiv,this.pixelRatio=w.plotGlPixelRatio||window.devicePixelRatio,this.id=w.id,this.staticPlot=!!w.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(E),this.makeFramework(),this.stopped||(this.glplotOptions=s(this),this.glplotOptions.merge(E),this.glplot=f(this.glplotOptions),this.camera=i(this),this.traces={},this.spikes=l(this.glplot),this.selectBox=o(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}I.exports=A;var S=A.prototype;S.makeFramework=function(){if(this.staticPlot){if(!(d||(t=document.createElement("canvas"),d=u({canvas:t,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}))))throw new Error("Error creating static canvas/context for image server");this.canvas=t,this.gl=d}else{var w=this.container.querySelector(".gl-canvas-focus"),E=u({canvas:w,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!E)return c(this),void(this.stopped=!0);this.canvas=w,this.gl=E}var k=this.canvas;k.style.width="100%",k.style.height="100%",k.style.position="absolute",k.style.top="0px",k.style.left="0px",k.style["pointer-events"]="none",this.updateSize(k);var L=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");L.style.position="absolute",L.style.top=L.style.left="0px",L.style.width=L.style.height="100%",L.style["z-index"]=20,L.style["pointer-events"]="none";var M=this.mouseContainer=document.createElement("div");M.style.position="absolute",M.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var P=this.container;P.appendChild(L),P.appendChild(M);var D=this;M.addEventListener("mouseout",function(){D.isMouseOver=!1,D.unhover()}),M.addEventListener("mouseover",function(){D.isMouseOver=!0})},S.toImage=function(w){w||(w="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(t),this.updateSize(this.canvas);var E=this.glplot.gl,k=E.drawingBufferWidth,L=E.drawingBufferHeight;E.clearColor(1,1,1,0),E.clear(E.COLOR_BUFFER_BIT|E.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),E.bindFramebuffer(E.FRAMEBUFFER,null);var M=new Uint8Array(k*L*4);E.readPixels(0,0,k,L,E.RGBA,E.UNSIGNED_BYTE,M);for(var P=0,D=L-1;P<D;++P,--D)for(var N=0;N<k;++N)for(var U=0;U<4;++U){var G=M[4*(k*P+N)+U];M[4*(k*P+N)+U]=M[4*(k*D+N)+U],M[4*(k*D+N)+U]=G}var X=document.createElement("canvas");X.width=k,X.height=L;var K,Z=X.getContext("2d"),H=Z.createImageData(k,L);switch(H.data.set(M),Z.putImageData(H,0,0),w){case"jpeg":K=X.toDataURL("image/jpeg");break;case"webp":K=X.toDataURL("image/webp");break;default:K=X.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(t),K},S.updateSize=function(w){w||(w=this.canvas);var E=this.pixelRatio,k=this.fullLayout,L=k.width,M=k.height,P=0|Math.ceil(E*L),D=0|Math.ceil(E*M);return w.width===P&&w.height===D||(w.width=P,w.height=D),w},S.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var w=[h.calcTicks(this.xaxis),h.calcTicks(this.yaxis)],E=0;E<2;++E)for(var k=0;k<w[E].length;++k)w[E][k].text=w[E][k].text+"";return w},S.updateRefs=function(w){this.fullLayout=w;var E=this.id.match(T),k="xaxis"+E[1],L="yaxis"+E[2];this.xaxis=this.fullLayout[k],this.yaxis=this.fullLayout[L]},S.relayoutCallback=function(){var w=this.graphDiv,E=this.xaxis,k=this.yaxis,L=w.layout,M={},P=M[E._name+".range"]=E.range.slice(),D=M[k._name+".range"]=k.range.slice();M[E._name+".autorange"]=E.autorange,M[k._name+".autorange"]=k.autorange,m.call("_storeDirectGUIEdit",w.layout,w._fullLayout._preGUI,M);var N=L[E._name];N.range=P,N.autorange=E.autorange;var U=L[k._name];U.range=D,U.autorange=k.autorange,M.lastInputTime=this.camera.lastInputTime,w.emit("plotly_relayout",M)},S.cameraChanged=function(){var w=this.camera;this.glplot.setDataBox(this.calcDataBox());var E=this.computeTickMarks();(function(k,L){for(var M=0;M<2;++M){var P=k[M],D=L[M];if(P.length!==D.length)return!0;for(var N=0;N<P.length;++N)if(P[N].x!==D[N].x)return!0}return!1})(E,this.glplotOptions.ticks)&&(this.glplotOptions.ticks=E,this.glplotOptions.dataBox=w.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},S.handleAnnotations=function(){for(var w=this.graphDiv,E=this.fullLayout.annotations,k=0;k<E.length;k++){var L=E[k];L.xref===this.xaxis._id&&L.yref===this.yaxis._id&&m.getComponentMethod("annotations","drawOne")(w,k)}},S.destroy=function(){if(this.glplot){var w=this.traces;w&&Object.keys(w).map(function(E){w[E].dispose(),delete w[E]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},S.plot=function(w,E,k){var L=this.glplot;this.updateRefs(k),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(w,E),this.updateFx(k.dragmode);var M=k.width,P=k.height;this.updateSize(this.canvas);var D=this.glplotOptions;D.merge(k),D.screenBox=[0,0,M,P];var N={_fullLayout:{_axisConstraintGroups:k._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:k._size}};g(N,this.xaxis),g(N,this.yaxis);var U,G,X=k._size,K=this.xaxis.domain,Z=this.yaxis.domain;for(D.viewBox=[X.l+K[0]*X.w,X.b+Z[0]*X.h,M-X.r-(1-K[1])*X.w,P-X.t-(1-Z[1])*X.h],this.mouseContainer.style.width=X.w*(K[1]-K[0])+"px",this.mouseContainer.style.height=X.h*(Z[1]-Z[0])+"px",this.mouseContainer.height=X.h*(Z[1]-Z[0]),this.mouseContainer.style.left=X.l+K[0]*X.w+"px",this.mouseContainer.style.top=X.t+(1-Z[1])*X.h+"px",G=0;G<2;++G)(U=this[x[G]])._length=D.viewBox[G+2]-D.viewBox[G],p(this.graphDiv,U),U.setScale();a(N),D.ticks=this.computeTickMarks(),D.dataBox=this.calcDataBox(),D.merge(k),L.update(D),this.glplot.draw()},S.calcDataBox=function(){var w=this.xaxis,E=this.yaxis,k=w.range,L=E.range,M=w.r2l,P=E.r2l;return[M(k[0]),P(L[0]),M(k[1]),P(L[1])]},S.setRanges=function(w){var E=this.xaxis,k=this.yaxis,L=E.l2r,M=k.l2r;E.range=[L(w[0]),L(w[2])],k.range=[M(w[1]),M(w[3])]},S.updateTraces=function(w,E){var k,L,M,P=Object.keys(this.traces);this.fullData=w;e:for(k=0;k<P.length;k++){var D=P[k],N=this.traces[D];for(L=0;L<w.length;L++)if((M=w[L]).uid===D&&M.type===N.type)continue e;N.dispose(),delete this.traces[D]}for(k=0;k<w.length;k++){M=w[k];var U=E[k],G=this.traces[M.uid];G?G.update(M,U):(G=M._module.plot(this,M,U),this.traces[M.uid]=G)}this.glplot.objects.sort(function(X,K){return X._trace.index-K._trace.index})},S.updateFx=function(w){b(w)||v(w)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor=w==="pan"?"move":w==="zoom"?"crosshair":null},S.emitPointAction=function(w,E){for(var k,L=w.trace.uid,M=w.pointIndex,P=0;P<this.fullData.length;P++)this.fullData[P].uid===L&&(k=this.fullData[P]);var D={x:w.traceCoord[0],y:w.traceCoord[1],curveNumber:k.index,pointNumber:M,data:k._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};e.appendArrayPointValue(D,k,M),this.graphDiv.emit(E,{points:[D]})},S.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var w=this.glplot,E=this.camera,k=E.mouseListener,L=this.lastButtonState===1&&k.buttons===0,M=this.fullLayout;this.lastButtonState=k.buttons,this.cameraChanged();var P,D=k.x*w.pixelRatio,N=this.canvas.height-w.pixelRatio*k.y;if(E.boxEnabled&&M.dragmode==="zoom"){this.selectBox.enabled=!0;for(var U=this.selectBox.selectBox=[Math.min(E.boxStart[0],E.boxEnd[0]),Math.min(E.boxStart[1],E.boxEnd[1]),Math.max(E.boxStart[0],E.boxEnd[0]),Math.max(E.boxStart[1],E.boxEnd[1])],G=0;G<2;G++)E.boxStart[G]===E.boxEnd[G]&&(U[G]=w.dataBox[G],U[G+2]=w.dataBox[G+2]);w.setDirty()}else if(!E.panning&&this.isMouseOver){this.selectBox.enabled=!1;var X=M._size,K=this.xaxis.domain,Z=this.yaxis.domain,H=(P=w.pick(D/w.pixelRatio+X.l+K[0]*X.w,N/w.pixelRatio-(X.t+(1-Z[1])*X.h)))&&P.object._trace.handlePick(P);if(H&&L&&this.emitPointAction(H,"plotly_click"),P&&P.object._trace.hoverinfo!=="skip"&&M.hovermode&&H&&(!this.lastPickResult||this.lastPickResult.traceUid!==H.trace.uid||this.lastPickResult.dataCoord[0]!==H.dataCoord[0]||this.lastPickResult.dataCoord[1]!==H.dataCoord[1])){var Y=H;this.lastPickResult={traceUid:H.trace?H.trace.uid:null,dataCoord:H.dataCoord.slice()},this.spikes.update({center:P.dataCoord}),Y.screenCoord=[((w.viewBox[2]-w.viewBox[0])*(P.dataCoord[0]-w.dataBox[0])/(w.dataBox[2]-w.dataBox[0])+w.viewBox[0])/w.pixelRatio,(this.canvas.height-(w.viewBox[3]-w.viewBox[1])*(P.dataCoord[1]-w.dataBox[1])/(w.dataBox[3]-w.dataBox[1])-w.viewBox[1])/w.pixelRatio],this.emitPointAction(H,"plotly_hover");var $=this.fullData[Y.trace.index]||{},z=Y.pointIndex,j=e.castHoverinfo($,M,z);if(j&&j!=="all"){var W=j.split("+");W.indexOf("x")===-1&&(Y.traceCoord[0]=void 0),W.indexOf("y")===-1&&(Y.traceCoord[1]=void 0),W.indexOf("z")===-1&&(Y.traceCoord[2]=void 0),W.indexOf("text")===-1&&(Y.textLabel=void 0),W.indexOf("name")===-1&&(Y.name=void 0)}e.loneHover({x:Y.screenCoord[0],y:Y.screenCoord[1],xLabel:this.hoverFormatter("xaxis",Y.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",Y.traceCoord[1]),zLabel:Y.traceCoord[2],text:Y.textLabel,name:Y.name,color:e.castHoverOption($,z,"bgcolor")||Y.color,borderColor:e.castHoverOption($,z,"bordercolor"),fontFamily:e.castHoverOption($,z,"font.family"),fontSize:e.castHoverOption($,z,"font.size"),fontColor:e.castHoverOption($,z,"font.color"),nameLength:e.castHoverOption($,z,"namelength"),textAlign:e.castHoverOption($,z,"align")},{container:this.svgContainer,gd:this.graphDiv})}}P||this.unhover(),w.draw()}},S.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),e.loneUnhover(this.svgContainer))},S.hoverFormatter=function(w,E){if(E!==void 0){var k=this[w];return h.tickText(k,k.c2l(E),"hover").text}}},{"../../components/dragelement/helpers":668,"../../components/fx":690,"../../lib/show_no_webgl_msg":809,"../../plots/cartesian/axes":838,"../../registry":915,"../cartesian/autorange":837,"../cartesian/constants":845,"../cartesian/constraints":846,"./camera":876,"./convert":877,"gl-plot2d":316,"gl-select-box":330,"gl-spikes2d":339,"webgl-context":613}],880:[function(r,I,B){var t=r("../../plot_api/edit_types").overrideAll,d=r("../../components/fx/layout_attributes"),m=r("./scene"),h=r("../get_data").getSubplotData,e=r("../../lib"),f=r("../../constants/xmlns_namespaces");B.name="gl3d",B.attr="scene",B.idRoot="scene",B.idRegex=B.attrRegex=e.counterRegex("scene"),B.attributes=r("./layout/attributes"),B.layoutAttributes=r("./layout/layout_attributes"),B.baseLayoutAttrOverrides=t({hoverlabel:d.hoverlabel},"plot","nested"),B.supplyLayoutDefaults=r("./layout/defaults"),B.plot=function(l){for(var o=l._fullLayout,u=l._fullData,s=o._subplots.gl3d,i=0;i<s.length;i++){var c=s[i],n=h(u,"gl3d",c),a=o[c],g=a.camera,p=a._scene;p||(p=new m({id:c,graphDiv:l,container:l.querySelector(".gl-container"),staticPlot:l._context.staticPlot,plotGlPixelRatio:l._context.plotGlPixelRatio,camera:g},o),a._scene=p),p.viewInitial||(p.viewInitial={up:{x:g.up.x,y:g.up.y,z:g.up.z},eye:{x:g.eye.x,y:g.eye.y,z:g.eye.z},center:{x:g.center.x,y:g.center.y,z:g.center.z}}),p.plot(n,o,l.layout)}},B.clean=function(l,o,u,s){for(var i=s._subplots.gl3d||[],c=0;c<i.length;c++){var n=i[c];!o[n]&&s[n]._scene&&(s[n]._scene.destroy(),s._infolayer&&s._infolayer.selectAll(".annotation-"+n).remove())}},B.toSVG=function(l){for(var o=l._fullLayout,u=o._subplots.gl3d,s=o._size,i=0;i<u.length;i++){var c=o[u[i]],n=c.domain,a=c._scene,g=a.toImage("png");o._glimages.append("svg:image").attr({xmlns:f.svg,"xlink:href":g,x:s.l+s.w*n.x[0],y:s.t+s.h*(1-n.y[1]),width:s.w*(n.x[1]-n.x[0]),height:s.h*(n.y[1]-n.y[0]),preserveAspectRatio:"none"}),a.destroy()}},B.cleanId=function(l){if(l.match(/^scene[0-9]*$/)){var o=l.substr(5);return o==="1"&&(o=""),"scene"+o}},B.updateFx=function(l){for(var o=l._fullLayout,u=o._subplots.gl3d,s=0;s<u.length;s++)o[u[s]]._scene.updateFx(o.dragmode,o.hovermode)}},{"../../components/fx/layout_attributes":691,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../plot_api/edit_types":820,"../get_data":875,"./layout/attributes":881,"./layout/defaults":885,"./layout/layout_attributes":886,"./scene":890}],881:[function(r,I,B){I.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],882:[function(r,I,B){var t=r("../../../components/color"),d=r("../../cartesian/layout_attributes"),m=r("../../../lib/extend").extendFlat,h=r("../../../plot_api/edit_types").overrideAll;I.exports=h({visible:d.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:t.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:d.color,categoryorder:d.categoryorder,categoryarray:d.categoryarray,title:{text:d.title.text,font:d.title.font},type:m({},d.type,{values:["-","linear","log","date","category"]}),autotypenumbers:d.autotypenumbers,autorange:d.autorange,rangemode:d.rangemode,range:m({},d.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:d.tickmode,nticks:d.nticks,tick0:d.tick0,dtick:d.dtick,tickvals:d.tickvals,ticktext:d.ticktext,ticks:d.ticks,mirror:d.mirror,ticklen:d.ticklen,tickwidth:d.tickwidth,tickcolor:d.tickcolor,showticklabels:d.showticklabels,tickfont:d.tickfont,tickangle:d.tickangle,tickprefix:d.tickprefix,showtickprefix:d.showtickprefix,ticksuffix:d.ticksuffix,showticksuffix:d.showticksuffix,showexponent:d.showexponent,exponentformat:d.exponentformat,minexponent:d.minexponent,separatethousands:d.separatethousands,tickformat:d.tickformat,tickformatstops:d.tickformatstops,hoverformat:d.hoverformat,showline:d.showline,linecolor:d.linecolor,linewidth:d.linewidth,showgrid:d.showgrid,gridcolor:m({},d.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:d.gridwidth,zeroline:d.zeroline,zerolinecolor:d.zerolinecolor,zerolinewidth:d.zerolinewidth,_deprecated:{title:d._deprecated.title,titlefont:d._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":650,"../../../lib/extend":777,"../../../plot_api/edit_types":820,"../../cartesian/layout_attributes":853}],883:[function(r,I,B){var t=r("tinycolor2").mix,d=r("../../../lib"),m=r("../../../plot_api/plot_template"),h=r("./axis_attributes"),e=r("../../cartesian/type_defaults"),f=r("../../cartesian/axis_defaults"),l=["xaxis","yaxis","zaxis"];I.exports=function(o,u,s){var i,c;function n(p,y){return d.coerce(i,c,h,p,y)}for(var a=0;a<l.length;a++){var g=l[a];i=o[g]||{},(c=m.newContainer(u,g))._id=g[0]+s.scene,c._name=g,e(i,c,n,s),f(i,c,n,{font:s.font,letter:g[0],data:s.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:s.bgColor,calendar:s.calendar},s.fullLayout),n("gridcolor",t(c.color,s.bgColor,13600/187).toRgbString()),n("title.text",g[0]),c.setScale=d.noop,n("showspikes")&&(n("spikesides"),n("spikethickness"),n("spikecolor",c.color)),n("showaxeslabels"),n("showbackground")&&n("backgroundcolor")}}},{"../../../lib":787,"../../../plot_api/plot_template":827,"../../cartesian/axis_defaults":840,"../../cartesian/type_defaults":864,"./axis_attributes":882,tinycolor2:583}],884:[function(r,I,B){var t=r("../../../lib/str2rgbarray"),d=r("../../../lib"),m=["xaxis","yaxis","zaxis"];function h(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}h.prototype.merge=function(e,f){for(var l=0;l<3;++l){var o=f[m[l]];o.visible?(this.labels[l]=e._meta?d.templateString(o.title.text,e._meta):o.title.text,"font"in o.title&&(o.title.font.color&&(this.labelColor[l]=t(o.title.font.color)),o.title.font.family&&(this.labelFont[l]=o.title.font.family),o.title.font.size&&(this.labelSize[l]=o.title.font.size)),"showline"in o&&(this.lineEnable[l]=o.showline),"linecolor"in o&&(this.lineColor[l]=t(o.linecolor)),"linewidth"in o&&(this.lineWidth[l]=o.linewidth),"showgrid"in o&&(this.gridEnable[l]=o.showgrid),"gridcolor"in o&&(this.gridColor[l]=t(o.gridcolor)),"gridwidth"in o&&(this.gridWidth[l]=o.gridwidth),o.type==="log"?this.zeroEnable[l]=!1:"zeroline"in o&&(this.zeroEnable[l]=o.zeroline),"zerolinecolor"in o&&(this.zeroLineColor[l]=t(o.zerolinecolor)),"zerolinewidth"in o&&(this.zeroLineWidth[l]=o.zerolinewidth),"ticks"in o&&o.ticks?this.lineTickEnable[l]=!0:this.lineTickEnable[l]=!1,"ticklen"in o&&(this.lineTickLength[l]=this._defaultLineTickLength[l]=o.ticklen),"tickcolor"in o&&(this.lineTickColor[l]=t(o.tickcolor)),"tickwidth"in o&&(this.lineTickWidth[l]=o.tickwidth),"tickangle"in o&&(this.tickAngle[l]=o.tickangle==="auto"?-3600:Math.PI*-o.tickangle/180),"showticklabels"in o&&(this.tickEnable[l]=o.showticklabels),"tickfont"in o&&(o.tickfont.color&&(this.tickColor[l]=t(o.tickfont.color)),o.tickfont.family&&(this.tickFont[l]=o.tickfont.family),o.tickfont.size&&(this.tickSize[l]=o.tickfont.size)),"mirror"in o?["ticks","all","allticks"].indexOf(o.mirror)!==-1?(this.lineTickMirror[l]=!0,this.lineMirror[l]=!0):o.mirror===!0?(this.lineTickMirror[l]=!1,this.lineMirror[l]=!0):(this.lineTickMirror[l]=!1,this.lineMirror[l]=!1):this.lineMirror[l]=!1,"showbackground"in o&&o.showbackground!==!1?(this.backgroundEnable[l]=!0,this.backgroundColor[l]=t(o.backgroundcolor)):this.backgroundEnable[l]=!1):(this.tickEnable[l]=!1,this.labelEnable[l]=!1,this.lineEnable[l]=!1,this.lineTickEnable[l]=!1,this.gridEnable[l]=!1,this.zeroEnable[l]=!1,this.backgroundEnable[l]=!1)}},I.exports=function(e,f){var l=new h;return l.merge(e,f),l}},{"../../../lib":787,"../../../lib/str2rgbarray":812}],885:[function(r,I,B){var t=r("../../../lib"),d=r("../../../components/color"),m=r("../../../registry"),h=r("../../subplot_defaults"),e=r("./axis_defaults"),f=r("./layout_attributes"),l=r("../../get_data").getSubplotData;function o(u,s,i,c){for(var n=i("bgcolor"),a=d.combine(n,c.paper_bgcolor),g=["up","center","eye"],p=0;p<g.length;p++)i("camera."+g[p]+".x"),i("camera."+g[p]+".y"),i("camera."+g[p]+".z");i("camera.projection.type");var y=!!i("aspectratio.x")&&!!i("aspectratio.y")&&!!i("aspectratio.z"),v=i("aspectmode",y?"manual":"auto");y||(u.aspectratio=s.aspectratio={x:1,y:1,z:1},v==="manual"&&(s.aspectmode="auto"),u.aspectmode=s.aspectmode);var b=l(c.fullData,"gl3d",c.id);e(u,s,{font:c.font,scene:c.id,data:b,bgColor:a,calendar:c.calendar,autotypenumbersDflt:c.autotypenumbersDflt,fullLayout:c.fullLayout}),m.getComponentMethod("annotations3d","handleDefaults")(u,s,c);var x=c.getDfltFromLayout("dragmode");if(x!==!1&&!x)if(x="orbit",u.camera&&u.camera.up){var T=u.camera.up.x,A=u.camera.up.y,S=u.camera.up.z;S!==0&&(T&&A&&S?S/Math.sqrt(T*T+A*A+S*S)>.999&&(x="turntable"):x="turntable")}else x="turntable";i("dragmode",x),i("hovermode",c.getDfltFromLayout("hovermode"))}I.exports=function(u,s,i){var c=s._basePlotModules.length>1;h(u,s,i,{type:"gl3d",attributes:f,handleDefaults:o,fullLayout:s,font:s.font,fullData:i,getDfltFromLayout:function(n){if(!c)return t.validate(u[n],f[n])?u[n]:void 0},autotypenumbersDflt:s.autotypenumbers,paper_bgcolor:s.paper_bgcolor,calendar:s.calendar})}},{"../../../components/color":650,"../../../lib":787,"../../../registry":915,"../../get_data":875,"../../subplot_defaults":909,"./axis_defaults":883,"./layout_attributes":886}],886:[function(r,I,B){var t=r("./axis_attributes"),d=r("../../domain").attributes,m=r("../../../lib/extend").extendFlat,h=r("../../../lib").counterRegex;function e(f,l,o){return{x:{valType:"number",dflt:f,editType:"camera"},y:{valType:"number",dflt:l,editType:"camera"},z:{valType:"number",dflt:o,editType:"camera"},editType:"camera"}}I.exports={_arrayAttrRegexps:[h("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:m(e(0,0,1),{}),center:m(e(0,0,0),{}),eye:m(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:d({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:t,yaxis:t,zaxis:t,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":787,"../../../lib/extend":777,"../../domain":866,"./axis_attributes":882}],887:[function(r,I,B){var t=r("../../../lib/str2rgbarray"),d=["xaxis","yaxis","zaxis"];function m(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}m.prototype.merge=function(h){for(var e=0;e<3;++e){var f=h[d[e]];f.visible?(this.enabled[e]=f.showspikes,this.colors[e]=t(f.spikecolor),this.drawSides[e]=f.spikesides,this.lineWidth[e]=f.spikethickness):(this.enabled[e]=!1,this.drawSides[e]=!1)}},I.exports=function(h){var e=new m;return e.merge(h),e}},{"../../../lib/str2rgbarray":812}],888:[function(r,I,B){I.exports=function(e){for(var f=e.axesOptions,l=e.glplot.axesPixels,o=e.fullSceneLayout,u=[[],[],[]],s=0;s<3;++s){var i=o[m[s]];if(i._length=(l[s].hi-l[s].lo)*l[s].pixelsPerDataUnit/e.dataScale[s],Math.abs(i._length)===1/0||isNaN(i._length))u[s]=[];else{i._input_range=i.range.slice(),i.range[0]=l[s].lo/e.dataScale[s],i.range[1]=l[s].hi/e.dataScale[s],i._m=1/(e.dataScale[s]*l[s].pixelsPerDataUnit),i.range[0]===i.range[1]&&(i.range[0]-=1,i.range[1]+=1);var c=i.tickmode;if(i.tickmode==="auto"){i.tickmode="linear";var n=i.nticks||d.constrain(i._length/40,4,9);t.autoTicks(i,Math.abs(i.range[1]-i.range[0])/n)}for(var a=t.calcTicks(i,{msUTC:!0}),g=0;g<a.length;++g)a[g].x=a[g].x*e.dataScale[s],i.type==="date"&&(a[g].text=a[g].text.replace(/\<br\>/g," "));u[s]=a,i.tickmode=c}}for(f.ticks=u,s=0;s<3;++s)for(h[s]=.5*(e.glplot.bounds[0][s]+e.glplot.bounds[1][s]),g=0;g<2;++g)f.bounds[g][s]=e.glplot.bounds[g][s];e.contourLevels=function(p){for(var y=new Array(3),v=0;v<3;++v){for(var b=p[v],x=new Array(b.length),T=0;T<b.length;++T)x[T]=b[T].x;y[v]=x}return y}(u)};var t=r("../../cartesian/axes"),d=r("../../../lib"),m=["xaxis","yaxis","zaxis"],h=[0,0,0]},{"../../../lib":787,"../../cartesian/axes":838}],889:[function(r,I,B){function t(d,m){var h,e,f=[0,0,0,0];for(h=0;h<4;++h)for(e=0;e<4;++e)f[e]+=d[4*h+e]*m[h];return f}I.exports=function(d,m){return t(d.projection,t(d.view,t(d.model,[m[0],m[1],m[2],1])))}},{}],890:[function(r,I,B){var t,d,m=r("gl-plot3d"),h=m.createCamera,e=m.createScene,f=r("webgl-context"),l=r("has-passive-events"),o=r("../../registry"),u=r("../../lib"),s=u.preserveDrawingBuffer(),i=r("../../plots/cartesian/axes"),c=r("../../components/fx"),n=r("../../lib/str2rgbarray"),a=r("../../lib/show_no_webgl_msg"),g=r("./project"),p=r("./layout/convert"),y=r("./layout/spikes"),v=r("./layout/tick_marks");function b(w,E){var k=document.createElement("div"),L=w.container;this.graphDiv=w.graphDiv;var M=document.createElementNS("http://www.w3.org/2000/svg","svg");M.style.position="absolute",M.style.top=M.style.left="0px",M.style.width=M.style.height="100%",M.style["z-index"]=20,M.style["pointer-events"]="none",k.appendChild(M),this.svgContainer=M,k.id=w.id,k.style.position="absolute",k.style.top=k.style.left="0px",k.style.width=k.style.height="100%",L.appendChild(k),this.fullLayout=E,this.id=w.id||"scene",this.fullSceneLayout=E[this.id],this.plotArgs=[[],{},{}],this.axesOptions=p(E,E[this.id]),this.spikeOptions=y(E[this.id]),this.container=k,this.staticMode=!!w.staticPlot,this.pixelRatio=this.pixelRatio||w.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=o.getComponentMethod("annotations3d","convert"),this.drawAnnotations=o.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var x=b.prototype;x.prepareOptions=function(){var w={canvas:this.canvas,gl:this.gl,glOptions:{preserveDrawingBuffer:s,premultipliedAlpha:!0,antialias:!0},container:this.container,axes:this.axesOptions,spikes:this.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:this.camera,pixelRatio:this.pixelRatio};if(this.staticMode){if(!(d||(t=document.createElement("canvas"),d=f({canvas:t,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}))))throw new Error("error creating static canvas/context for image server");w.gl=d,w.canvas=t}return w};var T=!0;x.tryCreatePlot=function(){var w=this.prepareOptions(),E=!0;try{this.glplot=e(w)}catch(k){if(this.staticMode||!T||s)E=!1;else{u.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{s=w.glOptions.preserveDrawingBuffer=!0,this.glplot=e(w)}catch(L){s=w.glOptions.preserveDrawingBuffer=!1,E=!1}}}return T=!1,E},x.initializeGLCamera=function(){var w=this.fullSceneLayout.camera,E=w.projection.type==="orthographic";this.camera=h(this.container,{center:[w.center.x,w.center.y,w.center.z],eye:[w.eye.x,w.eye.y,w.eye.z],up:[w.up.x,w.up.y,w.up.z],_ortho:E,zoomMin:.01,zoomMax:100,mode:"orbit"})},x.initializeGLPlot=function(){var w=this;if(w.initializeGLCamera(),!w.tryCreatePlot())return a(w);w.traces={},w.make4thDimension();var E=w.graphDiv,k=E.layout,L=function(){var P={};return w.isCameraChanged(k)&&(P[w.id+".camera"]=w.getCamera()),w.isAspectChanged(k)&&(P[w.id+".aspectratio"]=w.glplot.getAspectratio(),k[w.id].aspectmode!=="manual"&&(w.fullSceneLayout.aspectmode=k[w.id].aspectmode=P[w.id+".aspectmode"]="manual")),P},M=function(P){if(P.fullSceneLayout.dragmode!==!1){var D=L();P.saveLayout(k),P.graphDiv.emit("plotly_relayout",D)}};return w.glplot.canvas&&(w.glplot.canvas.addEventListener("mouseup",function(){M(w)}),w.glplot.canvas.addEventListener("wheel",function(P){if(E._context._scrollZoom.gl3d){if(w.camera._ortho){var D=P.deltaX>P.deltaY?1.1:1/1.1,N=w.glplot.getAspectratio();w.glplot.setAspectratio({x:D*N.x,y:D*N.y,z:D*N.z})}M(w)}},!!l&&{passive:!1}),w.glplot.canvas.addEventListener("mousemove",function(){if(w.fullSceneLayout.dragmode!==!1&&w.camera.mouseListener.buttons!==0){var P=L();w.graphDiv.emit("plotly_relayouting",P)}}),w.staticMode||w.glplot.canvas.addEventListener("webglcontextlost",function(P){E&&E.emit&&E.emit("plotly_webglcontextlost",{event:P,layer:w.id})},!1)),w.glplot.oncontextloss=function(){w.recoverContext()},w.glplot.onrender=function(){w.render()},!0},x.render=function(){var w,E=this,k=E.graphDiv,L=E.svgContainer,M=E.container.getBoundingClientRect();k._fullLayout._calcInverseTransform(k);var P=k._fullLayout._invScaleX,D=k._fullLayout._invScaleY,N=M.width*P,U=M.height*D;L.setAttributeNS(null,"viewBox","0 0 "+N+" "+U),L.setAttributeNS(null,"width",N),L.setAttributeNS(null,"height",U),v(E),E.glplot.axes.update(E.axesOptions);for(var G,X=Object.keys(E.traces),K=null,Z=E.glplot.selection,H=0;H<X.length;++H)(w=E.traces[X[H]]).data.hoverinfo!=="skip"&&w.handlePick(Z)&&(K=w),w.setContourLevels&&w.setContourLevels();function Y(de,ue,ve){var ke=E.fullSceneLayout[de+"axis"];return ke.type!=="log"&&(ue=ke.d2l(ue)),i.hoverLabelText(ke,ue,ve)}if(K!==null){var $=g(E.glplot.cameraParams,Z.dataCoordinate);w=K.data;var z,j=k._fullData[w.index],W=Z.index,ee={xLabel:Y("x",Z.traceCoordinate[0],w.xhoverformat),yLabel:Y("y",Z.traceCoordinate[1],w.yhoverformat),zLabel:Y("z",Z.traceCoordinate[2],w.zhoverformat)},J=c.castHoverinfo(j,E.fullLayout,W),Q=(J||"").split("+"),te=J&&J==="all";j.hovertemplate||te||(Q.indexOf("x")===-1&&(ee.xLabel=void 0),Q.indexOf("y")===-1&&(ee.yLabel=void 0),Q.indexOf("z")===-1&&(ee.zLabel=void 0),Q.indexOf("text")===-1&&(Z.textLabel=void 0),Q.indexOf("name")===-1&&(K.name=void 0));var ie=[];w.type==="cone"||w.type==="streamtube"?(ee.uLabel=Y("x",Z.traceCoordinate[3],w.uhoverformat),(te||Q.indexOf("u")!==-1)&&ie.push("u: "+ee.uLabel),ee.vLabel=Y("y",Z.traceCoordinate[4],w.vhoverformat),(te||Q.indexOf("v")!==-1)&&ie.push("v: "+ee.vLabel),ee.wLabel=Y("z",Z.traceCoordinate[5],w.whoverformat),(te||Q.indexOf("w")!==-1)&&ie.push("w: "+ee.wLabel),ee.normLabel=Z.traceCoordinate[6].toPrecision(3),(te||Q.indexOf("norm")!==-1)&&ie.push("norm: "+ee.normLabel),w.type==="streamtube"&&(ee.divergenceLabel=Z.traceCoordinate[7].toPrecision(3),(te||Q.indexOf("divergence")!==-1)&&ie.push("divergence: "+ee.divergenceLabel)),Z.textLabel&&ie.push(Z.textLabel),z=ie.join("<br>")):w.type==="isosurface"||w.type==="volume"?(ee.valueLabel=i.hoverLabelText(E._mockAxis,E._mockAxis.d2l(Z.traceCoordinate[3]),w.valuehoverformat),ie.push("value: "+ee.valueLabel),Z.textLabel&&ie.push(Z.textLabel),z=ie.join("<br>")):z=Z.textLabel;var ae={x:Z.traceCoordinate[0],y:Z.traceCoordinate[1],z:Z.traceCoordinate[2],data:j._input,fullData:j,curveNumber:j.index,pointNumber:W};c.appendArrayPointValue(ae,j,W),w._module.eventData&&(ae=j._module.eventData(ae,Z,j,{},W));var he={points:[ae]};if(E.fullSceneLayout.hovermode){var se=[];c.loneHover({trace:j,x:(.5+.5*$[0]/$[3])*N,y:(.5-.5*$[1]/$[3])*U,xLabel:ee.xLabel,yLabel:ee.yLabel,zLabel:ee.zLabel,text:z,name:K.name,color:c.castHoverOption(j,W,"bgcolor")||K.color,borderColor:c.castHoverOption(j,W,"bordercolor"),fontFamily:c.castHoverOption(j,W,"font.family"),fontSize:c.castHoverOption(j,W,"font.size"),fontColor:c.castHoverOption(j,W,"font.color"),nameLength:c.castHoverOption(j,W,"namelength"),textAlign:c.castHoverOption(j,W,"align"),hovertemplate:u.castOption(j,W,"hovertemplate"),hovertemplateLabels:u.extendFlat({},ae,ee),eventData:[ae]},{container:L,gd:k,inOut_bbox:se}),ae.bbox=se[0]}Z.buttons&&Z.distance<5?k.emit("plotly_click",he):k.emit("plotly_hover",he),G=he}else c.loneUnhover(L),k.emit("plotly_unhover",G);E.drawAnnotations(E)},x.recoverContext=function(){var w=this;w.glplot.dispose();var E=function(){w.glplot.gl.isContextLost()?requestAnimationFrame(E):w.initializeGLPlot()?w.plot.apply(w,w.plotArgs):u.error("Catastrophic and unrecoverable WebGL error. Context lost.")};requestAnimationFrame(E)};var A=["xaxis","yaxis","zaxis"];function S(w,E,k){for(var L=w.fullSceneLayout,M=0;M<3;M++){var P=A[M],D=P.charAt(0),N=L[P],U=E[D],G=E[D+"calendar"],X=E["_"+D+"length"];if(u.isArrayOrTypedArray(U))for(var K,Z=0;Z<(X||U.length);Z++)if(u.isArrayOrTypedArray(U[Z]))for(var H=0;H<U[Z].length;++H)K=N.d2l(U[Z][H],0,G),!isNaN(K)&&isFinite(K)&&(k[0][M]=Math.min(k[0][M],K),k[1][M]=Math.max(k[1][M],K));else K=N.d2l(U[Z],0,G),!isNaN(K)&&isFinite(K)&&(k[0][M]=Math.min(k[0][M],K),k[1][M]=Math.max(k[1][M],K));else k[0][M]=Math.min(k[0][M],0),k[1][M]=Math.max(k[1][M],X-1)}}x.plot=function(w,E,k){if(this.plotArgs=[w,E,k],!this.glplot.contextLost){var L,M,P,D,N,U,G=E[this.id],X=k[this.id];this.fullLayout=E,this.fullSceneLayout=G,this.axesOptions.merge(E,G),this.spikeOptions.merge(G),this.setViewport(G),this.updateFx(G.dragmode,G.hovermode),this.camera.enableWheel=this.graphDiv._context._scrollZoom.gl3d,this.glplot.setClearColor(n(G.bgcolor)),this.setConvert(N),w?Array.isArray(w)||(w=[w]):w=[];var K=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(P=0;P<w.length;++P)(L=w[P]).visible===!0&&L._length!==0&&S(this,L,K);(function(we,Me){for(var Se=we.fullSceneLayout,ze=Se.annotations||[],Fe=0;Fe<3;Fe++)for(var Ye=A[Fe],rt=Ye.charAt(0),Oe=Se[Ye],je=0;je<ze.length;je++){var We=ze[je];if(We.visible){var qe=Oe.r2l(We[rt]);!isNaN(qe)&&isFinite(qe)&&(Me[0][Fe]=Math.min(Me[0][Fe],qe),Me[1][Fe]=Math.max(Me[1][Fe],qe))}}})(this,K);var Z=[1,1,1];for(D=0;D<3;++D)K[1][D]===K[0][D]?Z[D]=1:Z[D]=1/(K[1][D]-K[0][D]);for(this.dataScale=Z,this.convertAnnotations(this),P=0;P<w.length;++P)(L=w[P]).visible===!0&&L._length!==0&&((M=this.traces[L.uid])?M.data.type===L.type?M.update(L):(M.dispose(),M=L._module.plot(this,L),this.traces[L.uid]=M):(M=L._module.plot(this,L),this.traces[L.uid]=M),M.name=L.name);var H=Object.keys(this.traces);e:for(P=0;P<H.length;++P){for(D=0;D<w.length;++D)if(w[D].uid===H[P]&&w[D].visible===!0&&w[D]._length!==0)continue e;(M=this.traces[H[P]]).dispose(),delete this.traces[H[P]]}this.glplot.objects.sort(function(we,Me){return we._trace.data.index-Me._trace.data.index});var Y,$=[[0,0,0],[0,0,0]],z=[],j={};for(P=0;P<3;++P){if((U=(N=G[A[P]]).type)in j?(j[U].acc*=Z[P],j[U].count+=1):j[U]={acc:Z[P],count:1},N.autorange){$[0][P]=1/0,$[1][P]=-1/0;var W=this.glplot.objects,ee=this.fullSceneLayout.annotations||[],J=N._name.charAt(0);for(D=0;D<W.length;D++){var Q=W[D],te=Q.bounds,ie=Q._trace.data._pad||0;Q.constructor.name==="ErrorBars"&&N._lowerLogErrorBound?$[0][P]=Math.min($[0][P],N._lowerLogErrorBound):$[0][P]=Math.min($[0][P],te[0][P]/Z[P]-ie),$[1][P]=Math.max($[1][P],te[1][P]/Z[P]+ie)}for(D=0;D<ee.length;D++){var ae=ee[D];if(ae.visible){var he=N.r2l(ae[J]);$[0][P]=Math.min($[0][P],he),$[1][P]=Math.max($[1][P],he)}}if("rangemode"in N&&N.rangemode==="tozero"&&($[0][P]=Math.min($[0][P],0),$[1][P]=Math.max($[1][P],0)),$[0][P]>$[1][P])$[0][P]=-1,$[1][P]=1;else{var se=$[1][P]-$[0][P];$[0][P]-=se/32,$[1][P]+=se/32}if(N.autorange==="reversed"){var de=$[0][P];$[0][P]=$[1][P],$[1][P]=de}}else{var ue=N.range;$[0][P]=N.r2l(ue[0]),$[1][P]=N.r2l(ue[1])}$[0][P]===$[1][P]&&($[0][P]-=1,$[1][P]+=1),z[P]=$[1][P]-$[0][P],this.glplot.setBounds(P,{min:$[0][P]*Z[P],max:$[1][P]*Z[P]})}var ve=G.aspectmode;if(ve==="cube")Y=[1,1,1];else if(ve==="manual"){var ke=G.aspectratio;Y=[ke.x,ke.y,ke.z]}else{if(ve!=="auto"&&ve!=="data")throw new Error("scene.js aspectRatio was not one of the enumerated types");var Ee=[1,1,1];for(P=0;P<3;++P){var be=j[U=(N=G[A[P]]).type];Ee[P]=Math.pow(be.acc,1/be.count)/Z[P]}Y=ve==="data"||Math.max.apply(null,Ee)/Math.min.apply(null,Ee)<=4?Ee:[1,1,1]}G.aspectratio.x=X.aspectratio.x=Y[0],G.aspectratio.y=X.aspectratio.y=Y[1],G.aspectratio.z=X.aspectratio.z=Y[2],this.glplot.setAspectratio(G.aspectratio),this.viewInitial.aspectratio||(this.viewInitial.aspectratio={x:G.aspectratio.x,y:G.aspectratio.y,z:G.aspectratio.z}),this.viewInitial.aspectmode||(this.viewInitial.aspectmode=G.aspectmode);var xe=G.domain||null,ce=E._size||null;if(xe&&ce){var ge=this.container.style;ge.position="absolute",ge.left=ce.l+xe.x[0]*ce.w+"px",ge.top=ce.t+(1-xe.y[1])*ce.h+"px",ge.width=ce.w*(xe.x[1]-xe.x[0])+"px",ge.height=ce.h*(xe.y[1]-xe.y[0])+"px"}this.glplot.redraw()}},x.destroy=function(){this.glplot&&(this.camera.mouseListener.enabled=!1,this.container.removeEventListener("wheel",this.camera.wheelListener),this.camera=null,this.glplot.dispose(),this.container.parentNode.removeChild(this.container),this.glplot=null)},x.getCamera=function(){var w;return this.camera.view.recalcMatrix(this.camera.view.lastT()),{up:{x:(w=this.camera).up[0],y:w.up[1],z:w.up[2]},center:{x:w.center[0],y:w.center[1],z:w.center[2]},eye:{x:w.eye[0],y:w.eye[1],z:w.eye[2]},projection:{type:w._ortho===!0?"orthographic":"perspective"}}},x.setViewport=function(w){var E,k=w.camera;this.camera.lookAt.apply(this,[[(E=k).eye.x,E.eye.y,E.eye.z],[E.center.x,E.center.y,E.center.z],[E.up.x,E.up.y,E.up.z]]),this.glplot.setAspectratio(w.aspectratio),k.projection.type==="orthographic"!==this.camera._ortho&&(this.glplot.redraw(),this.glplot.clearRGBA(),this.glplot.dispose(),this.initializeGLPlot())},x.isCameraChanged=function(w){var E=this.getCamera(),k=u.nestedProperty(w,this.id+".camera").get();function L(N,U,G,X){var K=["up","center","eye"],Z=["x","y","z"];return U[K[G]]&&N[K[G]][Z[X]]===U[K[G]][Z[X]]}var M=!1;if(k===void 0)M=!0;else{for(var P=0;P<3;P++)for(var D=0;D<3;D++)if(!L(E,k,P,D)){M=!0;break}(!k.projection||E.projection&&E.projection.type!==k.projection.type)&&(M=!0)}return M},x.isAspectChanged=function(w){var E=this.glplot.getAspectratio(),k=u.nestedProperty(w,this.id+".aspectratio").get();return k===void 0||k.x!==E.x||k.y!==E.y||k.z!==E.z},x.saveLayout=function(w){var E,k,L,M,P,D,N=this.fullLayout,U=this.isCameraChanged(w),G=this.isAspectChanged(w),X=U||G;if(X){var K={};U&&(E=this.getCamera(),L=(k=u.nestedProperty(w,this.id+".camera")).get(),K[this.id+".camera"]=L),G&&(M=this.glplot.getAspectratio(),D=(P=u.nestedProperty(w,this.id+".aspectratio")).get(),K[this.id+".aspectratio"]=D),o.call("_storeDirectGUIEdit",w,N._preGUI,K),U&&(k.set(E),u.nestedProperty(N,this.id+".camera").set(E)),G&&(P.set(M),u.nestedProperty(N,this.id+".aspectratio").set(M),this.glplot.redraw())}return X},x.updateFx=function(w,E){var k=this.camera;if(k)if(w==="orbit")k.mode="orbit",k.keyBindingMode="rotate";else if(w==="turntable"){k.up=[0,0,1],k.mode="turntable",k.keyBindingMode="rotate";var L=this.graphDiv,M=L._fullLayout,P=this.fullSceneLayout.camera,D=P.up.x,N=P.up.y,U=P.up.z;if(U/Math.sqrt(D*D+N*N+U*U)<.999){var G=this.id+".camera.up",X={x:0,y:0,z:1},K={};K[G]=X;var Z=L.layout;o.call("_storeDirectGUIEdit",Z,M._preGUI,K),P.up=X,u.nestedProperty(Z,G).set(X)}}else k.keyBindingMode=w;this.fullSceneLayout.hovermode=E},x.toImage=function(w){w||(w="png"),this.staticMode&&this.container.appendChild(t),this.glplot.redraw();var E=this.glplot.gl,k=E.drawingBufferWidth,L=E.drawingBufferHeight;E.bindFramebuffer(E.FRAMEBUFFER,null);var M=new Uint8Array(k*L*4);E.readPixels(0,0,k,L,E.RGBA,E.UNSIGNED_BYTE,M),function(G,X,K){for(var Z=0,H=K-1;Z<H;++Z,--H)for(var Y=0;Y<X;++Y)for(var $=0;$<4;++$){var z=4*(X*Z+Y)+$,j=4*(X*H+Y)+$,W=G[z];G[z]=G[j],G[j]=W}}(M,k,L),function(G,X,K){for(var Z=0;Z<K;++Z)for(var H=0;H<X;++H){var Y=4*(X*Z+H),$=G[Y+3];if($>0)for(var z=255/$,j=0;j<3;++j)G[Y+j]=Math.min(z*G[Y+j],255)}}(M,k,L);var P=document.createElement("canvas");P.width=k,P.height=L;var D,N=P.getContext("2d"),U=N.createImageData(k,L);switch(U.data.set(M),N.putImageData(U,0,0),w){case"jpeg":D=P.toDataURL("image/jpeg");break;case"webp":D=P.toDataURL("image/webp");break;default:D=P.toDataURL("image/png")}return this.staticMode&&this.container.removeChild(t),D},x.setConvert=function(){for(var w=0;w<3;w++){var E=this.fullSceneLayout[A[w]];i.setConvert(E,this.fullLayout),E.setScale=u.noop}},x.make4thDimension=function(){var w=this.graphDiv._fullLayout;this._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},i.setConvert(this._mockAxis,w)},I.exports=b},{"../../components/fx":690,"../../lib":787,"../../lib/show_no_webgl_msg":809,"../../lib/str2rgbarray":812,"../../plots/cartesian/axes":838,"../../registry":915,"./layout/convert":884,"./layout/spikes":887,"./layout/tick_marks":888,"./project":889,"gl-plot3d":319,"has-passive-events":436,"webgl-context":613}],891:[function(r,I,B){I.exports=function(t,d,m,h){h=h||t.length;for(var e=new Array(h),f=0;f<h;f++)e[f]=[t[f],d[f],m[f]];return e}},{}],892:[function(r,I,B){var t=r("./font_attributes"),d=r("./animation_attributes"),m=r("../components/color/attributes"),h=r("../components/shapes/draw_newshape/attributes"),e=r("./pad_attributes"),f=r("../lib/extend").extendFlat,l=t({editType:"calc"});l.family.dflt='"Open Sans", verdana, arial, sans-serif',l.size.dflt=12,l.color.dflt=m.defaultLine,I.exports={font:l,title:{text:{valType:"string",editType:"layoutstyle"},font:t({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:f(e({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:m.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:m.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:m.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:h.newshape,activeshape:h.activeshape,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:f({},d.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:t({editType:"layoutstyle"})}}},{"../components/color/attributes":649,"../components/shapes/draw_newshape/attributes":735,"../lib/extend":777,"./animation_attributes":832,"./font_attributes":867,"./pad_attributes":900}],893:[function(r,I,B){var t=r("../../lib/sort_object_keys"),d='\xA9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',m=['\xA9 <a target="_blank" href="https://carto.com/">Carto</a>',d].join(" "),h=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" "),e={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:d,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:m,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:m,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:h,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:h,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" "),tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},f=t(e);I.exports={requiredVersion:"1.10.1",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:e,styleValuesNonMapbox:f,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@1.10.1."].join(`
`),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join(`
`),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",f.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join(`
`),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join(`
`),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":`content: ""; cursor: pointer; position: absolute; background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;`,"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":`display:block; width: 21px; height: 21px; background-image: url('data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E')`}}},{"../../lib/sort_object_keys":810}],894:[function(r,I,B){var t=r("../../lib");I.exports=function(d,m){var h=d.split(" "),e=h[0],f=h[1],l=t.isArrayOrTypedArray(m)?t.mean(m):m,o=.5+l/100,u=1.5+l/100,s=["",""],i=[0,0];switch(e){case"top":s[0]="top",i[1]=-u;break;case"bottom":s[0]="bottom",i[1]=u}switch(f){case"left":s[1]="right",i[0]=-o;break;case"right":s[1]="left",i[0]=o}return{anchor:s[0]&&s[1]?s.join("-"):s[0]?s[0]:s[1]?s[1]:"center",offset:i}}},{"../../lib":787}],895:[function(r,I,B){var t=r("mapbox-gl/dist/mapbox-gl-unminified"),d=r("../../lib"),m=d.strTranslate,h=d.strScale,e=r("../../plots/get_data").getSubplotCalcData,f=r("../../constants/xmlns_namespaces"),l=r("@plotly/d3"),o=r("../../components/drawing"),u=r("../../lib/svg_text_utils"),s=r("./mapbox"),i=B.constants=r("./constants");function c(n){return typeof n=="string"&&(i.styleValuesMapbox.indexOf(n)!==-1||n.indexOf("mapbox://")===0)}B.name="mapbox",B.attr="subplot",B.idRoot="mapbox",B.idRegex=B.attrRegex=d.counterRegex("mapbox"),B.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},B.layoutAttributes=r("./layout_attributes"),B.supplyLayoutDefaults=r("./layout_defaults"),B.plot=function(n){var a=n._fullLayout,g=n.calcdata,p=a._subplots.mapbox;if(t.version!==i.requiredVersion)throw new Error(i.wrongVersionErrorMsg);var y=function(S,w){var E=S._fullLayout;if(S._context.mapboxAccessToken==="")return"";for(var k=[],L=[],M=!1,P=!1,D=0;D<w.length;D++){var N=E[w[D]],U=N.accesstoken;c(N.style)&&(U?d.pushUnique(k,U):(c(N._input.style)&&(d.error("Uses Mapbox map style, but did not set an access token."),M=!0),P=!0)),U&&d.pushUnique(L,U)}if(P){var G=M?i.noAccessTokenErrorMsg:i.missingStyleErrorMsg;throw d.error(G),new Error(G)}return k.length?(k.length>1&&d.warn(i.multipleTokensErrorMsg),k[0]):(L.length&&d.log(["Listed mapbox access token(s)",L.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}(n,p);t.accessToken=y;for(var v=0;v<p.length;v++){var b=p[v],x=e(g,"mapbox",b),T=a[b],A=T._subplot;A||(A=new s(n,b),a[b]._subplot=A),A.viewInitial||(A.viewInitial={center:d.extendFlat({},T.center),zoom:T.zoom,bearing:T.bearing,pitch:T.pitch}),A.plot(x,a,n._promises)}},B.clean=function(n,a,g,p){for(var y=p._subplots.mapbox||[],v=0;v<y.length;v++){var b=y[v];!a[b]&&p[b]._subplot&&p[b]._subplot.destroy()}},B.toSVG=function(n){for(var a=n._fullLayout,g=a._subplots.mapbox,p=a._size,y=0;y<g.length;y++){var v=a[g[y]],b=v.domain,x=v._subplot.toImage("png");a._glimages.append("svg:image").attr({xmlns:f.svg,"xlink:href":x,x:p.l+p.w*b.x[0],y:p.t+p.h*(1-b.y[1]),width:p.w*(b.x[1]-b.x[0]),height:p.h*(b.y[1]-b.y[0]),preserveAspectRatio:"none"});var T=l.select(v._subplot.div);if(T.select(".mapboxgl-ctrl-logo").node().offsetParent!==null){var A=a._glimages.append("g");A.attr("transform",m(p.l+p.w*b.x[0]+10,p.t+p.h*(1-b.y[0])-31)),A.append("path").attr("d",i.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),A.append("path").attr("d",i.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),A.append("path").attr("d",i.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),A.append("polygon").attr("points",i.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var S=T.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),w=a._glimages.append("g"),E=w.append("text");E.text(S).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":S});var k=o.bBox(E.node()),L=p.w*(b.x[1]-b.x[0]);if(k.width>L/2){var M=S.split("|").join("<br>");E.text(M).attr("data-unformatted",M).call(u.convertToTspans,n),k=o.bBox(E.node())}E.attr("transform",m(-3,8-k.height)),w.insert("rect",".static-attribution").attr({x:-k.width-6,y:-k.height-3,width:k.width+6,height:k.height+3,fill:"rgba(255, 255, 255, 0.75)"});var P=1;k.width+6>L&&(P=L/(k.width+6));var D=[p.l+p.w*b.x[1],p.t+p.h*(1-b.y[0])];w.attr("transform",m(D[0],D[1])+h(P))}},B.updateFx=function(n){for(var a=n._fullLayout,g=a._subplots.mapbox,p=0;p<g.length;p++)a[g[p]]._subplot.updateFx(a)}},{"../../components/drawing":672,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/get_data":875,"./constants":893,"./layout_attributes":897,"./layout_defaults":898,"./mapbox":899,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":451}],896:[function(r,I,B){var t=r("../../lib"),d=r("../../lib/svg_text_utils").sanitizeHTML,m=r("./convert_text_opts"),h=r("./constants");function e(u,s){this.subplot=u,this.uid=u.uid+"-"+s,this.index=s,this.idSource="source-"+this.uid,this.idLayer=h.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var f=e.prototype;function l(u){if(!u.visible)return!1;var s=u.source;if(Array.isArray(s)&&s.length>0){for(var i=0;i<s.length;i++)if(typeof s[i]!="string"||s[i].length===0)return!1;return!0}return t.isPlainObject(s)||typeof s=="string"&&s.length>0}function o(u){var s={},i={};switch(u.type){case"circle":t.extendFlat(i,{"circle-radius":u.circle.radius,"circle-color":u.color,"circle-opacity":u.opacity});break;case"line":t.extendFlat(i,{"line-width":u.line.width,"line-color":u.color,"line-opacity":u.opacity,"line-dasharray":u.line.dash});break;case"fill":t.extendFlat(i,{"fill-color":u.color,"fill-outline-color":u.fill.outlinecolor,"fill-opacity":u.opacity});break;case"symbol":var c=u.symbol,n=m(c.textposition,c.iconsize);t.extendFlat(s,{"icon-image":c.icon+"-15","icon-size":c.iconsize/10,"text-field":c.text,"text-size":c.textfont.size,"text-anchor":n.anchor,"text-offset":n.offset,"symbol-placement":c.placement}),t.extendFlat(i,{"icon-color":u.color,"text-color":c.textfont.color,"text-opacity":u.opacity});break;case"raster":t.extendFlat(i,{"raster-fade-duration":0,"raster-opacity":u.opacity})}return{layout:s,paint:i}}f.update=function(u){this.visible?this.needsNewImage(u)?this.updateImage(u):this.needsNewSource(u)?(this.removeLayer(),this.updateSource(u),this.updateLayer(u)):this.needsNewLayer(u)?this.updateLayer(u):this.updateStyle(u):(this.updateSource(u),this.updateLayer(u)),this.visible=l(u)},f.needsNewImage=function(u){return this.subplot.map.getSource(this.idSource)&&this.sourceType==="image"&&u.sourcetype==="image"&&(this.source!==u.source||JSON.stringify(this.coordinates)!==JSON.stringify(u.coordinates))},f.needsNewSource=function(u){return this.sourceType!==u.sourcetype||JSON.stringify(this.source)!==JSON.stringify(u.source)||this.layerType!==u.type},f.needsNewLayer=function(u){return this.layerType!==u.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},f.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},f.updateImage=function(u){this.subplot.map.getSource(this.idSource).updateImage({url:u.source,coordinates:u.coordinates});var s=this.findFollowingMapboxLayerId(this.lookupBelow());s!==null&&this.subplot.map.moveLayer(this.idLayer,s)},f.updateSource=function(u){var s=this.subplot.map;if(s.getSource(this.idSource)&&s.removeSource(this.idSource),this.sourceType=u.sourcetype,this.source=u.source,l(u)){var i=function(c){var n,a=c.sourcetype,g=c.source,p={type:a};return a==="geojson"?n="data":a==="vector"?n=typeof g=="string"?"url":"tiles":a==="raster"?(n="tiles",p.tileSize=256):a==="image"&&(n="url",p.coordinates=c.coordinates),p[n]=g,c.sourceattribution&&(p.attribution=d(c.sourceattribution)),p}(u);s.addSource(this.idSource,i)}},f.findFollowingMapboxLayerId=function(u){if(u==="traces")for(var s=this.subplot.getMapLayers(),i=0;i<s.length;i++){var c=s[i].id;if(typeof c=="string"&&c.indexOf(h.traceLayerPrefix)===0){u=c;break}}return u},f.updateLayer=function(u){var s=this.subplot,i=o(u),c=this.lookupBelow(),n=this.findFollowingMapboxLayerId(c);this.removeLayer(),l(u)&&s.addLayer({id:this.idLayer,source:this.idSource,"source-layer":u.sourcelayer||"",type:u.type,minzoom:u.minzoom,maxzoom:u.maxzoom,layout:i.layout,paint:i.paint},n),this.layerType=u.type,this.below=c},f.updateStyle=function(u){if(l(u)){var s=o(u);this.subplot.setOptions(this.idLayer,"setLayoutProperty",s.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",s.paint)}},f.removeLayer=function(){var u=this.subplot.map;u.getLayer(this.idLayer)&&u.removeLayer(this.idLayer)},f.dispose=function(){var u=this.subplot.map;u.getLayer(this.idLayer)&&u.removeLayer(this.idLayer),u.getSource(this.idSource)&&u.removeSource(this.idSource)},I.exports=function(u,s,i){var c=new e(u,s);return c.update(i),c}},{"../../lib":787,"../../lib/svg_text_utils":813,"./constants":893,"./convert_text_opts":894}],897:[function(r,I,B){var t=r("../../lib"),d=r("../../components/color").defaultLine,m=r("../domain").attributes,h=r("../font_attributes"),e=r("../../traces/scatter/attributes").textposition,f=r("../../plot_api/edit_types").overrideAll,l=r("../../plot_api/plot_template").templatedArray,o=r("./constants"),u=h({});u.family.dflt="Open Sans Regular, Arial Unicode MS Regular",(I.exports=f({_arrayAttrRegexps:[t.counterRegex("mapbox",".layers",!0)],domain:m({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:o.styleValuesMapbox.concat(o.styleValuesNonMapbox),dflt:o.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:l("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:d},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:d}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:u,textposition:t.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color":650,"../../lib":787,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../traces/scatter/attributes":1202,"../domain":866,"../font_attributes":867,"./constants":893}],898:[function(r,I,B){var t=r("../../lib"),d=r("../subplot_defaults"),m=r("../array_container_defaults"),h=r("./layout_attributes");function e(l,o,u,s){u("accesstoken",s.accessToken),u("style"),u("center.lon"),u("center.lat"),u("zoom"),u("bearing"),u("pitch"),m(l,o,{name:"layers",handleItemDefaults:f}),o._input=l}function f(l,o){function u(a,g){return t.coerce(l,o,h.layers,a,g)}if(u("visible")){var s,i=u("sourcetype"),c=i==="raster"||i==="image";u("source"),u("sourceattribution"),i==="vector"&&u("sourcelayer"),i==="image"&&u("coordinates"),c&&(s="raster");var n=u("type",s);c&&n!=="raster"&&(n=o.type="raster",t.log("Source types *raster* and *image* must drawn *raster* layer type.")),u("below"),u("color"),u("opacity"),u("minzoom"),u("maxzoom"),n==="circle"&&u("circle.radius"),n==="line"&&(u("line.width"),u("line.dash")),n==="fill"&&u("fill.outlinecolor"),n==="symbol"&&(u("symbol.icon"),u("symbol.iconsize"),u("symbol.text"),t.coerceFont(u,"symbol.textfont"),u("symbol.textposition"),u("symbol.placement"))}}I.exports=function(l,o,u){d(l,o,u,{type:"mapbox",attributes:h,handleDefaults:e,partition:"y",accessToken:o._mapboxAccessToken})}},{"../../lib":787,"../array_container_defaults":833,"../subplot_defaults":909,"./layout_attributes":897}],899:[function(r,I,B){var t=r("mapbox-gl/dist/mapbox-gl-unminified"),d=r("../../lib"),m=r("../../lib/geo_location_utils"),h=r("../../registry"),e=r("../cartesian/axes"),f=r("../../components/dragelement"),l=r("../../components/fx"),o=r("../../components/dragelement/helpers"),u=o.rectMode,s=o.drawMode,i=o.selectMode,c=r("../cartesian/select").prepSelect,n=r("../cartesian/select").clearSelect,a=r("../cartesian/select").clearSelectionsCache,g=r("../cartesian/select").selectOnClick,p=r("./constants"),y=r("./layers");function v(w,E){this.id=E,this.gd=w;var k=w._fullLayout,L=w._context;this.container=k._glcontainer.node(),this.isStatic=L.staticPlot,this.uid=k._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(k),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var b=v.prototype;b.plot=function(w,E,k){var L,M=this,P=E[M.id];M.map&&P.accesstoken!==M.accessToken&&(M.map.remove(),M.map=null,M.styleObj=null,M.traceHash={},M.layerList=[]),L=M.map?new Promise(function(D,N){M.updateMap(w,E,D,N)}):new Promise(function(D,N){M.createMap(w,E,D,N)}),k.push(L)},b.createMap=function(w,E,k,L){var M=this,P=E[M.id],D=M.styleObj=T(P.style);M.accessToken=P.accesstoken;var N=M.map=new t.Map({container:M.div,style:D.style,center:S(P.center),zoom:P.zoom,bearing:P.bearing,pitch:P.pitch,interactive:!M.isStatic,preserveDrawingBuffer:M.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new t.AttributionControl({compact:!0}));N._canvas.style.left="0px",N._canvas.style.top="0px",M.rejectOnError(L),M.isStatic||M.initFx(w,E);var U=[];U.push(new Promise(function(G){N.once("load",G)})),U=U.concat(m.fetchTraceGeoData(w)),Promise.all(U).then(function(){M.fillBelowLookup(w,E),M.updateData(w),M.updateLayout(E),M.resolveOnRender(k)}).catch(L)},b.updateMap=function(w,E,k,L){var M=this,P=M.map,D=E[this.id];M.rejectOnError(L);var N=[],U=T(D.style);JSON.stringify(M.styleObj)!==JSON.stringify(U)&&(M.styleObj=U,P.setStyle(U.style),M.traceHash={},N.push(new Promise(function(G){P.once("styledata",G)}))),N=N.concat(m.fetchTraceGeoData(w)),Promise.all(N).then(function(){M.fillBelowLookup(w,E),M.updateData(w),M.updateLayout(E),M.resolveOnRender(k)}).catch(L)},b.fillBelowLookup=function(w,E){var k,L,M=E[this.id].layers,P=this.belowLookup={},D=!1;for(k=0;k<w.length;k++){var N=w[k][0].trace,U=N._module;typeof N.below=="string"?L=N.below:U.getBelow&&(L=U.getBelow(N,this)),L===""&&(D=!0),P["trace-"+N.uid]=L||""}for(k=0;k<M.length;k++){var G=M[k];L=typeof G.below=="string"?G.below:D?"traces":"",P["layout-"+k]=L}var X,K,Z={};for(X in P)Z[L=P[X]]?Z[L].push(X):Z[L]=[X];for(L in Z){var H=Z[L];if(H.length>1)for(k=0;k<H.length;k++)(X=H[k]).indexOf("trace-")===0?(K=X.split("trace-")[1],this.traceHash[K]&&(this.traceHash[K].below=null)):X.indexOf("layout-")===0&&(K=X.split("layout-")[1],this.layerList[K]&&(this.layerList[K].below=null))}};var x={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};function T(w){var E={};return d.isPlainObject(w)?(E.id=w.id,E.style=w):typeof w=="string"?(E.id=w,p.styleValuesMapbox.indexOf(w)!==-1?E.style=A(w):p.stylesNonMapbox[w]?E.style=p.stylesNonMapbox[w]:E.style=w):(E.id=p.styleValueDflt,E.style=A(p.styleValueDflt)),E.transition={duration:0,delay:0},E}function A(w){return p.styleUrlPrefix+w+"-"+p.styleUrlSuffix}function S(w){return[w.lon,w.lat]}b.updateData=function(w){var E,k,L,M,P=this.traceHash,D=w.slice().sort(function(K,Z){return x[K[0].trace.type]-x[Z[0].trace.type]});for(L=0;L<D.length;L++){var N=D[L],U=!1;(E=P[(k=N[0].trace).uid])&&(E.type===k.type?(E.update(N),U=!0):E.dispose()),!U&&k._module&&(P[k.uid]=k._module.plot(this,N))}var G=Object.keys(P);e:for(L=0;L<G.length;L++){var X=G[L];for(M=0;M<w.length;M++)if(X===(k=w[M][0].trace).uid)continue e;(E=P[X]).dispose(),delete P[X]}},b.updateLayout=function(w){var E=this.map,k=w[this.id];this.dragging||this.wheeling||(E.setCenter(S(k.center)),E.setZoom(k.zoom),E.setBearing(k.bearing),E.setPitch(k.pitch)),this.updateLayers(w),this.updateFramework(w),this.updateFx(w),this.map.resize(),this.gd._context._scrollZoom.mapbox?E.scrollZoom.enable():E.scrollZoom.disable()},b.resolveOnRender=function(w){var E=this.map;E.on("render",function k(){E.loaded()&&(E.off("render",k),setTimeout(w,10))})},b.rejectOnError=function(w){var E=this.map;function k(){w(new Error(p.mapOnErrorMsg))}E.once("error",k),E.once("style.error",k),E.once("source.error",k),E.once("tile.error",k),E.once("layer.error",k)},b.createFramework=function(w){var E=this,k=E.div=document.createElement("div");k.id=E.uid,k.style.position="absolute",E.container.appendChild(k),E.xaxis={_id:"x",c2p:function(L){return E.project(L).x}},E.yaxis={_id:"y",c2p:function(L){return E.project(L).y}},E.updateFramework(w),E.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(E.mockAxis,w)},b.initFx=function(w,E){var k=this,L=k.gd,M=k.map;function P(){l.loneUnhover(E._hoverlayer)}function D(){var N=k.getView();L.emit("plotly_relayouting",k.getViewEditsWithDerived(N))}M.on("moveend",function(N){if(k.map){var U=L._fullLayout;if(N.originalEvent||k.wheeling){var G=U[k.id];h.call("_storeDirectGUIEdit",L.layout,U._preGUI,k.getViewEdits(G));var X=k.getView();G._input.center=G.center=X.center,G._input.zoom=G.zoom=X.zoom,G._input.bearing=G.bearing=X.bearing,G._input.pitch=G.pitch=X.pitch,L.emit("plotly_relayout",k.getViewEditsWithDerived(X))}N.originalEvent&&N.originalEvent.type==="mouseup"?k.dragging=!1:k.wheeling&&(k.wheeling=!1),U._rehover&&U._rehover()}}),M.on("wheel",function(){k.wheeling=!0}),M.on("mousemove",function(N){var U=k.div.getBoundingClientRect(),G=[N.originalEvent.offsetX,N.originalEvent.offsetY];N.target.getBoundingClientRect=function(){return U},k.xaxis.p2c=function(){return M.unproject(G).lng},k.yaxis.p2c=function(){return M.unproject(G).lat},L._fullLayout._rehover=function(){L._fullLayout._hoversubplot===k.id&&L._fullLayout[k.id]&&l.hover(L,N,k.id)},l.hover(L,N,k.id),L._fullLayout._hoversubplot=k.id}),M.on("dragstart",function(){k.dragging=!0,P()}),M.on("zoomstart",P),M.on("mouseout",function(){L._fullLayout._hoversubplot=null}),M.on("drag",D),M.on("zoom",D),M.on("dblclick",function(){var N=L._fullLayout[k.id];h.call("_storeDirectGUIEdit",L.layout,L._fullLayout._preGUI,k.getViewEdits(N));var U=k.viewInitial;M.setCenter(S(U.center)),M.setZoom(U.zoom),M.setBearing(U.bearing),M.setPitch(U.pitch);var G=k.getView();N._input.center=N.center=G.center,N._input.zoom=N.zoom=G.zoom,N._input.bearing=N.bearing=G.bearing,N._input.pitch=N.pitch=G.pitch,L.emit("plotly_doubleclick",null),L.emit("plotly_relayout",k.getViewEditsWithDerived(G))}),k.clearSelect=function(){a(k.dragOptions),n(k.dragOptions.gd)},k.onClickInPanFn=function(N){return function(U){var G=L._fullLayout.clickmode;G.indexOf("select")>-1&&g(U.originalEvent,L,[k.xaxis],[k.yaxis],k.id,N),G.indexOf("event")>-1&&l.click(L,U.originalEvent)}}},b.updateFx=function(w){var E=this,k=E.map,L=E.gd;if(!E.isStatic){var M,P=w.dragmode;M=u(P)?function(U,G){(U.range={})[E.id]=[N([G.xmin,G.ymin]),N([G.xmax,G.ymax])]}:function(U,G,X){(U.lassoPoints={})[E.id]=X.filtered.map(N)};var D=E.dragOptions;E.dragOptions=d.extendDeep(D||{},{dragmode:w.dragmode,element:E.div,gd:L,plotinfo:{id:E.id,domain:w[E.id].domain,xaxis:E.xaxis,yaxis:E.yaxis,fillRangeItems:M},xaxes:[E.xaxis],yaxes:[E.yaxis],subplot:E.id}),k.off("click",E.onClickInPanHandler),i(P)||s(P)?(k.dragPan.disable(),k.on("zoomstart",E.clearSelect),E.dragOptions.prepFn=function(U,G,X){c(U,G,X,E.dragOptions,P)},f.init(E.dragOptions)):(k.dragPan.enable(),k.off("zoomstart",E.clearSelect),E.div.onmousedown=null,E.onClickInPanHandler=E.onClickInPanFn(E.dragOptions),k.on("click",E.onClickInPanHandler))}function N(U){var G=E.map.unproject(U);return[G.lng,G.lat]}},b.updateFramework=function(w){var E=w[this.id].domain,k=w._size,L=this.div.style;L.width=k.w*(E.x[1]-E.x[0])+"px",L.height=k.h*(E.y[1]-E.y[0])+"px",L.left=k.l+E.x[0]*k.w+"px",L.top=k.t+(1-E.y[1])*k.h+"px",this.xaxis._offset=k.l+E.x[0]*k.w,this.xaxis._length=k.w*(E.x[1]-E.x[0]),this.yaxis._offset=k.t+(1-E.y[1])*k.h,this.yaxis._length=k.h*(E.y[1]-E.y[0])},b.updateLayers=function(w){var E,k=w[this.id].layers,L=this.layerList;if(k.length!==L.length){for(E=0;E<L.length;E++)L[E].dispose();for(L=this.layerList=[],E=0;E<k.length;E++)L.push(y(this,E,k[E]))}else for(E=0;E<k.length;E++)L[E].update(k[E])},b.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},b.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},b.setOptions=function(w,E,k){for(var L in k)this.map[E](w,L,k[L])},b.getMapLayers=function(){return this.map.getStyle().layers},b.addLayer=function(w,E){var k=this.map;if(typeof E=="string"){if(E==="")return void k.addLayer(w,E);for(var L=this.getMapLayers(),M=0;M<L.length;M++)if(E===L[M].id)return void k.addLayer(w,E);d.warn(["Trying to add layer with *below* value",E,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}k.addLayer(w)},b.project=function(w){return this.map.project(new t.LngLat(w[0],w[1]))},b.getView=function(){var w=this.map,E=w.getCenter(),k={lon:E.lng,lat:E.lat},L=w.getCanvas(),M=L.width,P=L.height;return{center:k,zoom:w.getZoom(),bearing:w.getBearing(),pitch:w.getPitch(),_derived:{coordinates:[w.unproject([0,0]).toArray(),w.unproject([M,0]).toArray(),w.unproject([M,P]).toArray(),w.unproject([0,P]).toArray()]}}},b.getViewEdits=function(w){for(var E=this.id,k=["center","zoom","bearing","pitch"],L={},M=0;M<k.length;M++){var P=k[M];L[E+"."+P]=w[P]}return L},b.getViewEditsWithDerived=function(w){var E=this.id,k=this.getViewEdits(w);return k[E+"._derived"]=w._derived,k},I.exports=v},{"../../components/dragelement":669,"../../components/dragelement/helpers":668,"../../components/fx":690,"../../lib":787,"../../lib/geo_location_utils":780,"../../registry":915,"../cartesian/axes":838,"../cartesian/select":858,"./constants":893,"./layers":896,"mapbox-gl/dist/mapbox-gl-unminified":451}],900:[function(r,I,B){I.exports=function(t){var d=t.editType;return{t:{valType:"number",dflt:0,editType:d},r:{valType:"number",dflt:0,editType:d},b:{valType:"number",dflt:0,editType:d},l:{valType:"number",dflt:0,editType:d},editType:d}}},{}],901:[function(r,I,B){var t=r("@plotly/d3"),d=r("d3-time-format").timeFormatLocale,m=r("d3-format").formatLocale,h=r("fast-isnumeric"),e=r("../registry"),f=r("../plot_api/plot_schema"),l=r("../plot_api/plot_template"),o=r("../lib"),u=r("../components/color"),s=r("../constants/numerical").BADNUM,i=r("./cartesian/axis_ids"),c=r("./cartesian/handle_outline").clearSelect,n=r("./animation_attributes"),a=r("./frame_attributes"),g=r("../plots/get_data").getModuleCalcData,p=o.relinkPrivateKeys,y=o._,v=I.exports={};o.extendFlat(v,e),v.attributes=r("./attributes"),v.attributes.type.values=v.allTypes,v.fontAttrs=r("./font_attributes"),v.layoutAttributes=r("./layout_attributes"),v.fontWeight="normal";var b=v.transformsRegistry,x=r("./command");v.executeAPICommand=x.executeAPICommand,v.computeAPICommandBindings=x.computeAPICommandBindings,v.manageCommandObserver=x.manageCommandObserver,v.hasSimpleAPICommandBindings=x.hasSimpleAPICommandBindings,v.redrawText=function(X){return X=o.getGraphDiv(X),new Promise(function(K){setTimeout(function(){X._fullLayout&&(e.getComponentMethod("annotations","draw")(X),e.getComponentMethod("legend","draw")(X),e.getComponentMethod("colorbar","draw")(X),K(v.previousPromises(X)))},300)})},v.resize=function(X){var K;X=o.getGraphDiv(X);var Z=new Promise(function(H,Y){X&&!o.isHidden(X)||Y(new Error("Resize must be passed a displayed plot div element.")),X._redrawTimer&&clearTimeout(X._redrawTimer),X._resolveResize&&(K=X._resolveResize),X._resolveResize=H,X._redrawTimer=setTimeout(function(){if(!X.layout||X.layout.width&&X.layout.height||o.isHidden(X))H(X);else{delete X.layout.width,delete X.layout.height;var $=X.changed;X.autoplay=!0,e.call("relayout",X,{autosize:!0}).then(function(){X.changed=$,X._resolveResize===H&&(delete X._resolveResize,H(X))})}},100)});return K&&K(Z),Z},v.previousPromises=function(X){if((X._promises||[]).length)return Promise.all(X._promises).then(function(){X._promises=[]})},v.addLinks=function(X){if(X._context.showLink||X._context.showSources){var K=X._fullLayout,Z=o.ensureSingle(K._paper,"text","js-plot-link-container",function(W){W.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:u.defaultLine,"pointer-events":"all"}).each(function(){var ee=t.select(this);ee.append("tspan").classed("js-link-to-tool",!0),ee.append("tspan").classed("js-link-spacer",!0),ee.append("tspan").classed("js-sourcelinks",!0)})}),H=Z.node(),Y={y:K._paper.attr("height")-9};document.body.contains(H)&&H.getComputedTextLength()>=K.width-20?(Y["text-anchor"]="start",Y.x=5):(Y["text-anchor"]="end",Y.x=K._paper.attr("width")-7),Z.attr(Y);var $=Z.select(".js-link-to-tool"),z=Z.select(".js-link-spacer"),j=Z.select(".js-sourcelinks");X._context.showSources&&X._context.showSources(X),X._context.showLink&&function(W,ee){ee.text("");var J=ee.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(W._context.linkText+" "+String.fromCharCode(187));if(W._context.sendData)J.on("click",function(){v.sendDataToCloud(W)});else{var Q=window.location.pathname.split("/"),te=window.location.search;J.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+Q[2].split(".")[0]+"/"+Q[1]+te})}}(X,$),z.text($.text()&&j.text()?" - ":"")}},v.sendDataToCloud=function(X){var K=(window.PLOTLYENV||{}).BASE_URL||X._context.plotlyServerURL;if(K){X.emit("plotly_beforeexport");var Z=t.select(X).append("div").attr("id","hiddenform").style("display","none"),H=Z.append("form").attr({action:K+"/external",method:"post",target:"_blank"});return H.append("input").attr({type:"text",name:"data"}).node().value=v.graphJson(X,!1,"keepdata"),H.node().submit(),Z.remove(),X.emit("plotly_afterexport"),!1}};var T=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],A=["year","month","dayMonth","dayMonthYear"];function S(X,K){var Z=X._context.locale;Z||(Z="en-US");var H=!1,Y={};function $(Q){for(var te=!0,ie=0;ie<K.length;ie++){var ae=K[ie];Y[ae]||(Q[ae]?Y[ae]=Q[ae]:te=!1)}te&&(H=!0)}for(var z=0;z<2;z++){for(var j=X._context.locales,W=0;W<2;W++){var ee=(j[Z]||{}).format;if(ee&&($(ee),H))break;j=e.localeRegistry}var J=Z.split("-")[0];if(H||J===Z)break;Z=J}return H||$(e.localeRegistry.en.format),Y}function w(X,K){var Z={_fullLayout:K},H=X._id.charAt(0)==="x",Y=X._mainAxis._anchorAxis,$="",z="",j="";if(Y&&(j=Y._mainAxis._id,$=H?X._id+j:j+X._id),!$||!K._plots[$]){$="";for(var W=X._counterAxes,ee=0;ee<W.length;ee++){var J=W[ee],Q=H?X._id+J:J+X._id;z||(z=Q);var te=i.getFromId(Z,J);if(j&&te.overlaying===j){$=Q;break}}}return $||z}function E(X){var K=X.transforms;if(Array.isArray(K)&&K.length)for(var Z=0;Z<K.length;Z++){var H=K[Z],Y=H._module||b[H.type];if(Y&&Y.makesData)return!0}return!1}function k(X,K,Z,H){for(var Y=X.transforms,$=[X],z=0;z<Y.length;z++){var j=Y[z],W=b[j.type];W&&W.transform&&($=W.transform($,{transform:j,fullTrace:X,fullData:K,layout:Z,fullLayout:H,transformIndex:z}))}return $}function L(X){return typeof X=="string"&&X.substr(X.length-2)==="px"&&parseFloat(X)}function M(X){var K=X.margin;if(!X._size){var Z=X._size={l:Math.round(K.l),r:Math.round(K.r),t:Math.round(K.t),b:Math.round(K.b),p:Math.round(K.pad)};Z.w=Math.round(X.width)-Z.l-Z.r,Z.h=Math.round(X.height)-Z.t-Z.b}X._pushmargin||(X._pushmargin={}),X._pushmarginIds||(X._pushmarginIds={})}v.supplyDefaults=function(X,K){var Z=K&&K.skipUpdateCalc,H=X._fullLayout||{};if(H._skipDefaults)delete H._skipDefaults;else{var Y,$=X._fullLayout={},z=X.layout||{},j=X._fullData||[],W=X._fullData=[],ee=X.data||[],J=X.calcdata||[],Q=X._context||{};X._transitionData||v.createTransitionData(X),$._dfltTitle={plot:y(X,"Click to enter Plot title"),x:y(X,"Click to enter X axis title"),y:y(X,"Click to enter Y axis title"),colorbar:y(X,"Click to enter Colorscale title"),annotation:y(X,"new text")},$._traceWord=y(X,"trace");var te=S(X,T);if($._mapboxAccessToken=Q.mapboxAccessToken,H._initialAutoSizeIsDone){var ie=H.width,ae=H.height;v.supplyLayoutGlobalDefaults(z,$,te),z.width||($.width=ie),z.height||($.height=ae),v.sanitizeMargins($)}else{v.supplyLayoutGlobalDefaults(z,$,te);var he=!z.width||!z.height,se=$.autosize,de=Q.autosizable;he&&(se||de)?v.plotAutoSize(X,z,$):he&&v.sanitizeMargins($),!se&&he&&(z.width=$.width,z.height=$.height)}$._d3locale=function(je,We){return je.decimal=We.charAt(0),je.thousands=We.charAt(1),{numberFormat:function(qe){try{qe=m(je).format(o.adjustFormat(qe))}catch(et){return o.warnBadFormat(qe),o.noFormat}return qe},timeFormat:d(je).utcFormat}}(te,$.separators),$._extraFormat=S(X,A),$._initialAutoSizeIsDone=!0,$._dataLength=ee.length,$._modules=[],$._visibleModules=[],$._basePlotModules=[];var ue=$._subplots=function(){var je,We,qe=e.collectableSubplotTypes,et={};if(!qe){qe=[];var st=e.subplotsRegistry;for(var ct in st){var Pt=st[ct].attr;if(Pt&&(qe.push(ct),Array.isArray(Pt)))for(We=0;We<Pt.length;We++)o.pushUnique(qe,Pt[We])}}for(je=0;je<qe.length;je++)et[qe[je]]=[];return et}(),ve=$._splomAxes={x:{},y:{}},ke=$._splomSubplots={};$._splomGridDflt={},$._scatterStackOpts={},$._firstScatter={},$._alignmentOpts={},$._colorAxes={},$._requestRangeslider={},$._traceUids=function(je,We){var qe,et,st=We.length,ct=[];for(qe=0;qe<je.length;qe++){var Pt=je[qe]._fullInput;Pt!==et&&ct.push(Pt),et=Pt}var kt=ct.length,at=new Array(st),tt={};function _t(Ue,He){at[He]=Ue,tt[Ue]=1}function er(Ue,He){if(Ue&&typeof Ue=="string"&&!tt[Ue])return _t(Ue,He),!0}for(qe=0;qe<st;qe++){var tr=We[qe].uid;typeof tr=="number"&&(tr=String(tr)),er(tr,qe)||qe<kt&&er(ct[qe].uid,qe)||_t(o.randstr(tt),qe)}return at}(j,ee),$._globalTransforms=(X._context||{}).globalTransforms,v.supplyDataDefaults(ee,W,z,$);var Ee=Object.keys(ve.x),be=Object.keys(ve.y);if(Ee.length>1&&be.length>1){for(e.getComponentMethod("grid","sizeDefaults")(z,$),Y=0;Y<Ee.length;Y++)o.pushUnique(ue.xaxis,Ee[Y]);for(Y=0;Y<be.length;Y++)o.pushUnique(ue.yaxis,be[Y]);for(var xe in ke)o.pushUnique(ue.cartesian,xe)}if($._has=v._hasPlotType.bind($),j.length===W.length)for(Y=0;Y<W.length;Y++)p(W[Y],j[Y]);v.supplyLayoutModuleDefaults(z,$,W,X._transitionData);var ce=$._visibleModules,ge=[];for(Y=0;Y<ce.length;Y++){var we=ce[Y].crossTraceDefaults;we&&o.pushUnique(ge,we)}for(Y=0;Y<ge.length;Y++)ge[Y](W,$);$._hasOnlyLargeSploms=$._basePlotModules.length===1&&$._basePlotModules[0].name==="splom"&&Ee.length>15&&be.length>15&&$.shapes.length===0&&$.images.length===0,v.linkSubplots(W,$,j,H),v.cleanPlot(W,$,j,H);var Me=!(!H._has||!H._has("gl2d")),Se=!(!$._has||!$._has("gl2d")),ze=!(!H._has||!H._has("cartesian"))||Me,Fe=!(!$._has||!$._has("cartesian"))||Se;ze&&!Fe?H._bgLayer.remove():Fe&&!ze&&($._shouldCreateBgLayer=!0),H._zoomlayer&&!X._dragging&&c({_fullLayout:H}),function(je,We){var qe,et=[];We.meta&&(qe=We._meta={meta:We.meta,layout:{meta:We.meta}});for(var st=0;st<je.length;st++){var ct=je[st];ct.meta?et[ct.index]=ct._meta={meta:ct.meta}:We.meta&&(ct._meta={meta:We.meta}),We.meta&&(ct._meta.layout={meta:We.meta})}et.length&&(qe||(qe=We._meta={}),qe.data=et)}(W,$),p($,H),e.getComponentMethod("colorscale","crossTraceDefaults")(W,$),$._preGUI||($._preGUI={}),$._tracePreGUI||($._tracePreGUI={});var Ye,rt=$._tracePreGUI,Oe={};for(Ye in rt)Oe[Ye]="old";for(Y=0;Y<W.length;Y++)Oe[Ye=W[Y]._fullInput.uid]||(rt[Ye]={}),Oe[Ye]="new";for(Ye in Oe)Oe[Ye]==="old"&&delete rt[Ye];M($),e.getComponentMethod("rangeslider","makeData")($),Z||J.length!==W.length||v.supplyDefaultsUpdateCalc(J,W)}},v.supplyDefaultsUpdateCalc=function(X,K){for(var Z=0;Z<K.length;Z++){var H=K[Z],Y=(X[Z]||[])[0];if(Y&&Y.trace){var $=Y.trace;if($._hasCalcTransform){var z,j,W,ee=$._arrayAttrs;for(z=0;z<ee.length;z++)j=ee[z],W=o.nestedProperty($,j).get().slice(),o.nestedProperty(H,j).set(W)}Y.trace=H}}},v.createTransitionData=function(X){X._transitionData||(X._transitionData={}),X._transitionData._frames||(X._transitionData._frames=[]),X._transitionData._frameHash||(X._transitionData._frameHash={}),X._transitionData._counter||(X._transitionData._counter=0),X._transitionData._interruptCallbacks||(X._transitionData._interruptCallbacks=[])},v._hasPlotType=function(X){var K,Z=this._basePlotModules||[];for(K=0;K<Z.length;K++)if(Z[K].name===X)return!0;var H=this._modules||[];for(K=0;K<H.length;K++){var Y=H[K].name;if(Y===X)return!0;var $=e.modules[Y];if($&&$.categories[X])return!0}return!1},v.cleanPlot=function(X,K,Z,H){var Y,$,z=H._basePlotModules||[];for(Y=0;Y<z.length;Y++){var j=z[Y];j.clean&&j.clean(X,K,Z,H)}var W=H._has&&H._has("gl"),ee=K._has&&K._has("gl");W&&!ee&&H._glcontainer!==void 0&&(H._glcontainer.selectAll(".gl-canvas").remove(),H._glcontainer.selectAll(".no-webgl").remove(),H._glcanvas=null);var J=!!H._infolayer;e:for(Y=0;Y<Z.length;Y++){var Q=Z[Y].uid;for($=0;$<X.length;$++)if(Q===X[$].uid)continue e;J&&H._infolayer.select(".cb"+Q).remove()}},v.linkSubplots=function(X,K,Z,H){var Y,$,z=H._plots||{},j=K._plots={},W=K._subplots,ee={_fullData:X,_fullLayout:K},J=W.cartesian.concat(W.gl2d||[]);for(Y=0;Y<J.length;Y++){var Q,te=J[Y],ie=z[te],ae=i.getFromId(ee,te,"x"),he=i.getFromId(ee,te,"y");for(ie?Q=j[te]=ie:(Q=j[te]={}).id=te,ae._counterAxes.push(he._id),he._counterAxes.push(ae._id),ae._subplotsWith.push(te),he._subplotsWith.push(te),Q.xaxis=ae,Q.yaxis=he,Q._hasClipOnAxisFalse=!1,$=0;$<X.length;$++){var se=X[$];if(se.xaxis===Q.xaxis._id&&se.yaxis===Q.yaxis._id&&se.cliponaxis===!1){Q._hasClipOnAxisFalse=!0;break}}}var de,ue=i.list(ee,null,!0);for(Y=0;Y<ue.length;Y++){var ve=null;(de=ue[Y]).overlaying&&(ve=i.getFromId(ee,de.overlaying))&&ve.overlaying&&(de.overlaying=!1,ve=null),de._mainAxis=ve||de,ve&&(de.domain=ve.domain.slice()),de._anchorAxis=de.anchor==="free"?null:i.getFromId(ee,de.anchor)}for(Y=0;Y<ue.length;Y++)if((de=ue[Y])._counterAxes.sort(i.idSort),de._subplotsWith.sort(o.subplotSort),de._mainSubplot=w(de,K),de._counterAxes.length&&(de.spikemode&&de.spikemode.indexOf("across")!==-1||de.automargin&&de.mirror&&de.anchor!=="free"||e.getComponentMethod("rangeslider","isVisible")(de))){var ke=1,Ee=0;for($=0;$<de._counterAxes.length;$++){var be=i.getFromId(ee,de._counterAxes[$]);ke=Math.min(ke,be.domain[0]),Ee=Math.max(Ee,be.domain[1])}ke<Ee&&(de._counterDomainMin=ke,de._counterDomainMax=Ee)}},v.clearExpandedTraceDefaultColors=function(X){var K,Z,H;for(Z=[],(K=X._module._colorAttrs)||(X._module._colorAttrs=K=[],f.crawl(X._module.attributes,function(Y,$,z,j){Z[j]=$,Z.length=j+1,Y.valType==="color"&&Y.dflt===void 0&&K.push(Z.join("."))})),H=0;H<K.length;H++)o.nestedProperty(X,"_input."+K[H]).get()||o.nestedProperty(X,K[H]).set(null)},v.supplyDataDefaults=function(X,K,Z,H){var Y,$,z,j=H._modules,W=H._visibleModules,ee=H._basePlotModules,J=0,Q=0;function te(xe){K.push(xe);var ce=xe._module;ce&&(o.pushUnique(j,ce),xe.visible===!0&&o.pushUnique(W,ce),o.pushUnique(ee,xe._module.basePlotModule),J++,xe._input.visible!==!1&&Q++)}H._transformModules=[];var ie={},ae=[],he=(Z.template||{}).data||{},se=l.traceTemplater(he);for(Y=0;Y<X.length;Y++){if(z=X[Y],($=se.newTrace(z)).uid=H._traceUids[Y],v.supplyTraceDefaults(z,$,Q,H,Y),$.index=Y,$._input=z,$._expandedIndex=J,$.transforms&&$.transforms.length)for(var de=z.visible!==!1&&$.visible===!1,ue=k($,K,Z,H),ve=0;ve<ue.length;ve++){var ke=ue[ve],Ee={_template:$._template,type:$.type,uid:$.uid+ve};de&&ke.visible===!1&&delete ke.visible,v.supplyTraceDefaults(ke,Ee,J,H,Y),p(Ee,ke),Ee.index=Y,Ee._input=z,Ee._fullInput=$,Ee._expandedIndex=J,Ee._expandedInput=ke,te(Ee)}else $._fullInput=$,$._expandedInput=$,te($);e.traceIs($,"carpetAxis")&&(ie[$.carpet]=$),e.traceIs($,"carpetDependent")&&ae.push(Y)}for(Y=0;Y<ae.length;Y++)if(($=K[ae[Y]]).visible){var be=ie[$.carpet];$._carpet=be,be&&be.visible?($.xaxis=be.xaxis,$.yaxis=be.yaxis):$.visible=!1}},v.supplyAnimationDefaults=function(X){var K;X=X||{};var Z={};function H(Y,$){return o.coerce(X||{},Z,n,Y,$)}if(H("mode"),H("direction"),H("fromcurrent"),Array.isArray(X.frame))for(Z.frame=[],K=0;K<X.frame.length;K++)Z.frame[K]=v.supplyAnimationFrameDefaults(X.frame[K]||{});else Z.frame=v.supplyAnimationFrameDefaults(X.frame||{});if(Array.isArray(X.transition))for(Z.transition=[],K=0;K<X.transition.length;K++)Z.transition[K]=v.supplyAnimationTransitionDefaults(X.transition[K]||{});else Z.transition=v.supplyAnimationTransitionDefaults(X.transition||{});return Z},v.supplyAnimationFrameDefaults=function(X){var K={};function Z(H,Y){return o.coerce(X||{},K,n.frame,H,Y)}return Z("duration"),Z("redraw"),K},v.supplyAnimationTransitionDefaults=function(X){var K={};function Z(H,Y){return o.coerce(X||{},K,n.transition,H,Y)}return Z("duration"),Z("easing"),K},v.supplyFrameDefaults=function(X){var K={};function Z(H,Y){return o.coerce(X,K,a,H,Y)}return Z("group"),Z("name"),Z("traces"),Z("baseframe"),Z("data"),Z("layout"),K},v.supplyTraceDefaults=function(X,K,Z,H,Y){var $,z=H.colorway||u.defaults,j=z[Z%z.length];function W(ue,ve){return o.coerce(X,K,v.attributes,ue,ve)}var ee=W("visible");W("type"),W("name",H._traceWord+" "+Y),W("uirevision",H.uirevision);var J=v.getModule(K);if(K._module=J,J){var Q=J.basePlotModule,te=Q.attr,ie=Q.attributes;if(te&&ie){var ae=H._subplots,he="";if(ee||Q.name!=="gl2d"){if(Array.isArray(te))for($=0;$<te.length;$++){var se=te[$],de=o.coerce(X,K,ie,se);ae[se]&&o.pushUnique(ae[se],de),he+=de}else he=o.coerce(X,K,ie,te);ae[Q.name]&&o.pushUnique(ae[Q.name],he)}}}return ee&&(W("customdata"),W("ids"),W("meta"),e.traceIs(K,"showLegend")?(o.coerce(X,K,J.attributes.showlegend?J.attributes:v.attributes,"showlegend"),W("legendgroup"),W("legendgrouptitle.text")&&o.coerceFont(W,"legendgrouptitle.font",o.extendFlat({},H.font,{size:Math.round(1.1*H.font.size)})),W("legendrank"),K._dfltShowLegend=!0):K._dfltShowLegend=!1,J&&J.supplyDefaults(X,K,j,H),e.traceIs(K,"noOpacity")||W("opacity"),e.traceIs(K,"notLegendIsolatable")&&(K.visible=!!K.visible),e.traceIs(K,"noHover")||(K.hovertemplate||o.coerceHoverinfo(X,K,H),K.type!=="parcats"&&e.getComponentMethod("fx","supplyDefaults")(X,K,j,H)),J&&J.selectPoints&&W("selectedpoints"),v.supplyTransformDefaults(X,K,H)),K},v.hasMakesDataTransform=E,v.supplyTransformDefaults=function(X,K,Z){if(K._length||E(X)){var H=Z._globalTransforms||[],Y=Z._transformModules||[];if(Array.isArray(X.transforms)||H.length!==0)for(var $=X.transforms||[],z=H.concat($),j=K.transforms=[],W=0;W<z.length;W++){var ee,J=z[W],Q=J.type,te=b[Q],ie=!(J._module&&J._module===te),ae=te&&typeof te.transform=="function";te||o.warn("Unrecognized transform type "+Q+"."),te&&te.supplyDefaults&&(ie||ae)?((ee=te.supplyDefaults(J,K,Z,X)).type=Q,ee._module=te,o.pushUnique(Y,te)):ee=o.extendFlat({},J),j.push(ee)}}},v.supplyLayoutGlobalDefaults=function(X,K,Z){function H(j,W){return o.coerce(X,K,v.layoutAttributes,j,W)}var Y=X.template;o.isPlainObject(Y)&&(K.template=Y,K._template=Y.layout,K._dataTemplate=Y.data),H("autotypenumbers");var $=o.coerceFont(H,"font");H("title.text",K._dfltTitle.plot),o.coerceFont(H,"title.font",{family:$.family,size:Math.round(1.4*$.size),color:$.color}),H("title.xref"),H("title.yref"),H("title.x"),H("title.y"),H("title.xanchor"),H("title.yanchor"),H("title.pad.t"),H("title.pad.r"),H("title.pad.b"),H("title.pad.l"),H("uniformtext.mode")&&H("uniformtext.minsize"),H("autosize",!(X.width&&X.height)),H("width"),H("height"),H("margin.l"),H("margin.r"),H("margin.t"),H("margin.b"),H("margin.pad"),H("margin.autoexpand"),X.width&&X.height&&v.sanitizeMargins(K),e.getComponentMethod("grid","sizeDefaults")(X,K),H("paper_bgcolor"),H("separators",Z.decimal+Z.thousands),H("hidesources"),H("colorway"),H("datarevision");var z=H("uirevision");H("editrevision",z),H("selectionrevision",z),e.getComponentMethod("modebar","supplyLayoutDefaults")(X,K),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(X,K,H),H("meta"),o.isPlainObject(X.transition)&&(H("transition.duration"),H("transition.easing"),H("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(X,K,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(X,K,H)},v.plotAutoSize=function(X,K,Z){var H,Y,$=X._context||{},z=$.frameMargins,j=o.isPlotDiv(X);if(j&&X.emit("plotly_autosize"),$.fillFrame)H=window.innerWidth,Y=window.innerHeight,document.body.style.overflow="hidden";else{var W=j?window.getComputedStyle(X):{};if(H=L(W.width)||L(W.maxWidth)||Z.width,Y=L(W.height)||L(W.maxHeight)||Z.height,h(z)&&z>0){var ee=1-2*z;H=Math.round(ee*H),Y=Math.round(ee*Y)}}var J=v.layoutAttributes.width.min,Q=v.layoutAttributes.height.min;H<J&&(H=J),Y<Q&&(Y=Q);var te=!K.width&&Math.abs(Z.width-H)>1,ie=!K.height&&Math.abs(Z.height-Y)>1;(ie||te)&&(te&&(Z.width=H),ie&&(Z.height=Y)),X._initialAutoSize||(X._initialAutoSize={width:H,height:Y}),v.sanitizeMargins(Z)},v.supplyLayoutModuleDefaults=function(X,K,Z,H){var Y,$,z,j=e.componentsRegistry,W=K._basePlotModules,ee=e.subplotsRegistry.cartesian;for(Y in j)(z=j[Y]).includeBasePlot&&z.includeBasePlot(X,K);for(var J in W.length||W.push(ee),K._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(X,K),ee.finalizeSubplots(X,K)),K._subplots)K._subplots[J].sort(o.subplotSort);for($=0;$<W.length;$++)(z=W[$]).supplyLayoutDefaults&&z.supplyLayoutDefaults(X,K,Z);var Q=K._modules;for($=0;$<Q.length;$++)(z=Q[$]).supplyLayoutDefaults&&z.supplyLayoutDefaults(X,K,Z);var te=K._transformModules;for($=0;$<te.length;$++)(z=te[$]).supplyLayoutDefaults&&z.supplyLayoutDefaults(X,K,Z,H);for(Y in j)(z=j[Y]).supplyLayoutDefaults&&z.supplyLayoutDefaults(X,K,Z)},v.purge=function(X){var K=X._fullLayout||{};K._glcontainer!==void 0&&(K._glcontainer.selectAll(".gl-canvas").remove(),K._glcontainer.remove(),K._glcanvas=null),K._modeBar&&K._modeBar.destroy(),X._transitionData&&(X._transitionData._interruptCallbacks&&(X._transitionData._interruptCallbacks.length=0),X._transitionData._animationRaf&&window.cancelAnimationFrame(X._transitionData._animationRaf)),o.clearThrottle(),o.clearResponsive(X),delete X.data,delete X.layout,delete X._fullData,delete X._fullLayout,delete X.calcdata,delete X.empty,delete X.fid,delete X.undoqueue,delete X.undonum,delete X.autoplay,delete X.changed,delete X._promises,delete X._redrawTimer,delete X._hmlumcount,delete X._hmpixcount,delete X._transitionData,delete X._transitioning,delete X._initialAutoSize,delete X._transitioningWithDuration,delete X._dragging,delete X._dragged,delete X._dragdata,delete X._hoverdata,delete X._snapshotInProgress,delete X._editing,delete X._mouseDownTime,delete X._legendMouseDownTime,X.removeAllListeners&&X.removeAllListeners()},v.style=function(X){var K,Z=X._fullLayout._visibleModules,H=[];for(K=0;K<Z.length;K++){var Y=Z[K];Y.style&&o.pushUnique(H,Y.style)}for(K=0;K<H.length;K++)H[K](X)},v.sanitizeMargins=function(X){if(X&&X.margin){var K,Z=X.width,H=X.height,Y=X.margin,$=Z-(Y.l+Y.r),z=H-(Y.t+Y.b);$<0&&(K=(Z-1)/(Y.l+Y.r),Y.l=Math.floor(K*Y.l),Y.r=Math.floor(K*Y.r)),z<0&&(K=(H-1)/(Y.t+Y.b),Y.t=Math.floor(K*Y.t),Y.b=Math.floor(K*Y.b))}},v.clearAutoMarginIds=function(X){X._fullLayout._pushmarginIds={}},v.allowAutoMargin=function(X,K){X._fullLayout._pushmarginIds[K]=1},v.autoMargin=function(X,K,Z){var H=X._fullLayout,Y=H.width,$=H.height,z=H.margin,j=o.constrain(Y-z.l-z.r,2,64),W=o.constrain($-z.t-z.b,2,64),ee=Math.max(0,Y-j),J=Math.max(0,$-W),Q=H._pushmargin,te=H._pushmarginIds;if(z.autoexpand!==!1){if(Z){var ie=Z.pad;if(ie===void 0&&(ie=Math.min(12,z.l,z.r,z.t,z.b)),ee){var ae=(Z.l+Z.r)/ee;ae>1&&(Z.l/=ae,Z.r/=ae)}if(J){var he=(Z.t+Z.b)/J;he>1&&(Z.t/=he,Z.b/=he)}var se=Z.xl!==void 0?Z.xl:Z.x,de=Z.xr!==void 0?Z.xr:Z.x,ue=Z.yt!==void 0?Z.yt:Z.y,ve=Z.yb!==void 0?Z.yb:Z.y;Q[K]={l:{val:se,size:Z.l+ie},r:{val:de,size:Z.r+ie},b:{val:ve,size:Z.b+ie},t:{val:ue,size:Z.t+ie}},te[K]=1}else delete Q[K],delete te[K];if(!H._replotting)return v.doAutoMargin(X)}},v.doAutoMargin=function(X){var K=X._fullLayout,Z=K.width,H=K.height;K._size||(K._size={}),M(K);var Y=K._size,$=K.margin,z=o.extendFlat({},Y),j=$.l,W=$.r,ee=$.t,J=$.b,Q=K._pushmargin,te=K._pushmarginIds;if(K.margin.autoexpand!==!1){for(var ie in Q)te[ie]||delete Q[ie];for(var ae in Q.base={l:{val:0,size:j},r:{val:1,size:W},t:{val:1,size:ee},b:{val:0,size:J}},Q){var he=Q[ae].l||{},se=Q[ae].b||{},de=he.val,ue=he.size,ve=se.val,ke=se.size;for(var Ee in Q){if(h(ue)&&Q[Ee].r){var be=Q[Ee].r.val,xe=Q[Ee].r.size;if(be>de){var ce=(ue*be+(xe-Z)*de)/(be-de),ge=(xe*(1-de)+(ue-Z)*(1-be))/(be-de);ce+ge>j+W&&(j=ce,W=ge)}}if(h(ke)&&Q[Ee].t){var we=Q[Ee].t.val,Me=Q[Ee].t.size;if(we>ve){var Se=(ke*we+(Me-H)*ve)/(we-ve),ze=(Me*(1-ve)+(ke-H)*(1-we))/(we-ve);Se+ze>J+ee&&(J=Se,ee=ze)}}}}}var Fe=o.constrain(Z-$.l-$.r,2,64),Ye=o.constrain(H-$.t-$.b,2,64),rt=Math.max(0,Z-Fe),Oe=Math.max(0,H-Ye);if(rt){var je=(j+W)/rt;je>1&&(j/=je,W/=je)}if(Oe){var We=(J+ee)/Oe;We>1&&(J/=We,ee/=We)}if(Y.l=Math.round(j),Y.r=Math.round(W),Y.t=Math.round(ee),Y.b=Math.round(J),Y.p=Math.round($.pad),Y.w=Math.round(Z)-Y.l-Y.r,Y.h=Math.round(H)-Y.t-Y.b,!K._replotting&&v.didMarginChange(z,Y)){"_redrawFromAutoMarginCount"in K?K._redrawFromAutoMarginCount++:K._redrawFromAutoMarginCount=1;var qe=3*(1+Object.keys(te).length);if(K._redrawFromAutoMarginCount<qe)return e.call("_doPlot",X);K._size=z,o.warn("Too many auto-margin redraws.")}(function(et){var st=i.list(et,"",!0);["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(ct){for(var Pt=0;Pt<st.length;Pt++){var kt=st[Pt][ct];kt&&kt()}})})(X)};var P=["l","r","t","b","p","w","h"];function D(X,K,Z){var H=!1,Y=[v.previousPromises,function(){if(X._transitionData)return X._transitioning=!1,function(z){var j=Promise.resolve();if(!z)return j;for(;z.length;)j=j.then(z.shift());return j}(X._transitionData._interruptCallbacks)},Z.prepareFn,v.rehover,function(){return X.emit("plotly_transitioning",[]),new Promise(function(z){X._transitioning=!0,K.duration>0&&(X._transitioningWithDuration=!0),X._transitionData._interruptCallbacks.push(function(){H=!0}),Z.redraw&&X._transitionData._interruptCallbacks.push(function(){return e.call("redraw",X)}),X._transitionData._interruptCallbacks.push(function(){X.emit("plotly_transitioninterrupted",[])});var j=0,W=0;function ee(){return j++,function(){W++,H||W!==j||function(J){!X._transitionData||(function(Q){if(Q)for(;Q.length;)Q.shift()}(X._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(Z.redraw)return e.call("redraw",X)}).then(function(){X._transitioning=!1,X._transitioningWithDuration=!1,X.emit("plotly_transitioned",[])}).then(J))}(z)}}Z.runFn(ee),setTimeout(ee())})}],$=o.syncOrAsync(Y,X);return $&&$.then||($=Promise.resolve()),$.then(function(){return X})}v.didMarginChange=function(X,K){for(var Z=0;Z<P.length;Z++){var H=P[Z],Y=X[H],$=K[H];if(!h(Y)||Math.abs($-Y)>1)return!0}return!1},v.graphJson=function(X,K,Z,H,Y,$){(Y&&K&&!X._fullData||Y&&!K&&!X._fullLayout)&&v.supplyDefaults(X);var z=Y?X._fullData:X.data,j=Y?X._fullLayout:X.layout,W=(X._transitionData||{})._frames;function ee(te,ie){if(typeof te=="function")return ie?"_function_":null;if(o.isPlainObject(te)){var ae,he={};return Object.keys(te).sort().forEach(function(se){if(["_","["].indexOf(se.charAt(0))===-1)if(typeof te[se]!="function"){if(Z==="keepdata"){if(se.substr(se.length-3)==="src")return}else if(Z==="keepstream"){if(typeof(ae=te[se+"src"])=="string"&&ae.indexOf(":")>0&&!o.isPlainObject(te.stream))return}else if(Z!=="keepall"&&typeof(ae=te[se+"src"])=="string"&&ae.indexOf(":")>0)return;he[se]=ee(te[se],ie)}else ie&&(he[se]="_function")}),he}return Array.isArray(te)?te.map(function(se){return ee(se,ie)}):o.isTypedArray(te)?o.simpleMap(te,o.identity):o.isJSDate(te)?o.ms2DateTimeLocal(+te):te}var J={data:(z||[]).map(function(te){var ie=ee(te);return K&&delete ie.fit,ie})};if(!K&&(J.layout=ee(j),Y)){var Q=j._size;J.layout.computed={margin:{b:Q.b,l:Q.l,r:Q.r,t:Q.t}}}return W&&(J.frames=ee(W)),$&&(J.config=ee(X._context,!0)),H==="object"?J:JSON.stringify(J)},v.modifyFrames=function(X,K){var Z,H,Y,$=X._transitionData._frames,z=X._transitionData._frameHash;for(Z=0;Z<K.length;Z++)switch((H=K[Z]).type){case"replace":Y=H.value;var j=($[H.index]||{}).name,W=Y.name;$[H.index]=z[W]=Y,W!==j&&(delete z[j],z[W]=Y);break;case"insert":z[(Y=H.value).name]=Y,$.splice(H.index,0,Y);break;case"delete":delete z[(Y=$[H.index]).name],$.splice(H.index,1)}return Promise.resolve()},v.computeFrame=function(X,K){var Z,H,Y,$,z=X._transitionData._frameHash;if(!K)throw new Error("computeFrame must be given a string frame name");var j=z[K.toString()];if(!j)return!1;for(var W=[j],ee=[j.name];j.baseframe&&(j=z[j.baseframe.toString()])&&ee.indexOf(j.name)===-1;)W.push(j),ee.push(j.name);for(var J={};j=W.pop();)if(j.layout&&(J.layout=v.extendLayout(J.layout,j.layout)),j.data){if(J.data||(J.data=[]),!(H=j.traces))for(H=[],Z=0;Z<j.data.length;Z++)H[Z]=Z;for(J.traces||(J.traces=[]),Z=0;Z<j.data.length;Z++)(Y=H[Z])!=null&&(($=J.traces.indexOf(Y))===-1&&($=J.data.length,J.traces[$]=Y),J.data[$]=v.extendTrace(J.data[$],j.data[Z]))}return J},v.recomputeFrameHash=function(X){for(var K=X._transitionData._frameHash={},Z=X._transitionData._frames,H=0;H<Z.length;H++){var Y=Z[H];Y&&Y.name&&(K[Y.name]=Y)}},v.extendObjectWithContainers=function(X,K,Z){var H,Y,$,z,j,W,ee,J=o.extendDeepNoArrays({},K||{}),Q=o.expandObjectPaths(J),te={};if(Z&&Z.length)for($=0;$<Z.length;$++)(Y=(H=o.nestedProperty(Q,Z[$])).get())===void 0?o.nestedProperty(te,Z[$]).set(null):(H.set(null),o.nestedProperty(te,Z[$]).set(Y));if(X=o.extendDeepNoArrays(X||{},Q),Z&&Z.length){for($=0;$<Z.length;$++)if(W=o.nestedProperty(te,Z[$]).get()){for(ee=(j=o.nestedProperty(X,Z[$])).get(),Array.isArray(ee)||(ee=[],j.set(ee)),z=0;z<W.length;z++){var ie=W[z];ee[z]=ie===null?null:v.extendObjectWithContainers(ee[z],ie)}j.set(ee)}}return X},v.dataArrayContainers=["transforms","dimensions"],v.layoutArrayContainers=e.layoutArrayContainers,v.extendTrace=function(X,K){return v.extendObjectWithContainers(X,K,v.dataArrayContainers)},v.extendLayout=function(X,K){return v.extendObjectWithContainers(X,K,v.layoutArrayContainers)},v.transition=function(X,K,Z,H,Y,$){var z={redraw:Y.redraw},j={},W=[];return z.prepareFn=function(){for(var ee=Array.isArray(K)?K.length:0,J=H.slice(0,ee),Q=0;Q<J.length;Q++){var te=J[Q],ie=X._fullData[te]._module;if(ie){if(ie.animatable){var ae=ie.basePlotModule.name;j[ae]||(j[ae]=[]),j[ae].push(te)}X.data[J[Q]]=v.extendTrace(X.data[J[Q]],K[Q])}}var he=o.expandObjectPaths(o.extendDeepNoArrays({},Z)),se=/^[xy]axis[0-9]*$/;for(var de in he)se.test(de)&&delete he[de].range;v.extendLayout(X.layout,he),delete X.calcdata,v.supplyDefaults(X),v.doCalcdata(X);var ue=o.expandObjectPaths(Z);if(ue){var ve=X._fullLayout._plots;for(var ke in ve){var Ee=ve[ke],be=Ee.xaxis,xe=Ee.yaxis,ce=be.range.slice(),ge=xe.range.slice(),we=null,Me=null,Se=null,ze=null;Array.isArray(ue[be._name+".range"])?we=ue[be._name+".range"].slice():Array.isArray((ue[be._name]||{}).range)&&(we=ue[be._name].range.slice()),Array.isArray(ue[xe._name+".range"])?Me=ue[xe._name+".range"].slice():Array.isArray((ue[xe._name]||{}).range)&&(Me=ue[xe._name].range.slice()),ce&&we&&(be.r2l(ce[0])!==be.r2l(we[0])||be.r2l(ce[1])!==be.r2l(we[1]))&&(Se={xr0:ce,xr1:we}),ge&&Me&&(xe.r2l(ge[0])!==xe.r2l(Me[0])||xe.r2l(ge[1])!==xe.r2l(Me[1]))&&(ze={yr0:ge,yr1:Me}),(Se||ze)&&W.push(o.extendFlat({plotinfo:Ee},Se,ze))}}return Promise.resolve()},z.runFn=function(ee){var J,Q,te=X._fullLayout._basePlotModules,ie=W.length;if(Z)for(Q=0;Q<te.length;Q++)te[Q].transitionAxes&&te[Q].transitionAxes(X,W,$,ee);for(var ae in ie?((J=o.extendFlat({},$)).duration=0,delete j.cartesian):J=$,j){var he=j[ae];X._fullData[he[0]]._module.basePlotModule.plot(X,he,J,ee)}},D(X,$,z)},v.transitionFromReact=function(X,K,Z,H){var Y=X._fullLayout,$=Y.transition,z={},j=[];return z.prepareFn=function(){var W=Y._plots;for(var ee in z.redraw=!1,K.anim==="some"&&(z.redraw=!0),Z.anim==="some"&&(z.redraw=!0),W){var J=W[ee],Q=J.xaxis,te=J.yaxis,ie=H[Q._name].range.slice(),ae=H[te._name].range.slice(),he=Q.range.slice(),se=te.range.slice();Q.setScale(),te.setScale();var de=null,ue=null;Q.r2l(ie[0])===Q.r2l(he[0])&&Q.r2l(ie[1])===Q.r2l(he[1])||(de={xr0:ie,xr1:he}),te.r2l(ae[0])===te.r2l(se[0])&&te.r2l(ae[1])===te.r2l(se[1])||(ue={yr0:ae,yr1:se}),(de||ue)&&j.push(o.extendFlat({plotinfo:J},de,ue))}return Promise.resolve()},z.runFn=function(W){for(var ee,J,Q,te=X._fullData,ie=X._fullLayout._basePlotModules,ae=[],he=0;he<te.length;he++)ae.push(he);function se(){if(X._fullLayout)for(var ue=0;ue<ie.length;ue++)ie[ue].transitionAxes&&ie[ue].transitionAxes(X,j,ee,W)}function de(){if(X._fullLayout)for(var ue=0;ue<ie.length;ue++)ie[ue].plot(X,Q,J,W)}j.length&&K.anim?$.ordering==="traces first"?(ee=o.extendFlat({},$,{duration:0}),Q=ae,J=$,setTimeout(se,$.duration),de()):(ee=$,Q=null,J=o.extendFlat({},$,{duration:0}),setTimeout(de,ee.duration),se()):j.length?(ee=$,se()):K.anim&&(Q=ae,J=$,de())},D(X,$,z)},v.doCalcdata=function(X,K){var Z,H,Y,$,z=i.list(X),j=X._fullData,W=X._fullLayout,ee=new Array(j.length),J=(X.calcdata||[]).slice();for(X.calcdata=ee,W._numBoxes=0,W._numViolins=0,W._violinScaleGroupStats={},X._hmpixcount=0,X._hmlumcount=0,W._piecolormap={},W._sunburstcolormap={},W._treemapcolormap={},W._iciclecolormap={},W._funnelareacolormap={},Y=0;Y<j.length;Y++)Array.isArray(K)&&K.indexOf(Y)===-1&&(ee[Y]=J[Y]);for(Y=0;Y<j.length;Y++)(Z=j[Y])._arrayAttrs=f.findArrayAttributes(Z),Z._extremes={};var Q=W._subplots.polar||[];for(Y=0;Y<Q.length;Y++)z.push(W[Q[Y]].radialaxis,W[Q[Y]].angularaxis);for(var te in W._colorAxes){var ie=W[te];ie.cauto!==!1&&(delete ie.cmin,delete ie.cmax)}var ae=!1;function he(ue){if(Z=j[ue],H=Z._module,Z.visible===!0&&Z.transforms){if(H&&H.calc){var ve=H.calc(X,Z);ve[0]&&ve[0].t&&ve[0].t._scene&&delete ve[0].t._scene.dirty}for($=0;$<Z.transforms.length;$++){var ke=Z.transforms[$];(H=b[ke.type])&&H.calcTransform&&(Z._hasCalcTransform=!0,ae=!0,H.calcTransform(X,Z,ke))}}}function se(ue,ve){if(Z=j[ue],!!(H=Z._module).isContainer===ve){var ke=[];if(Z.visible===!0&&Z._length!==0){delete Z._indexToPoints;var Ee=Z.transforms||[];for($=Ee.length-1;$>=0;$--)if(Ee[$].enabled){Z._indexToPoints=Ee[$]._indexToPoints;break}H&&H.calc&&(ke=H.calc(X,Z))}Array.isArray(ke)&&ke[0]||(ke=[{x:s,y:s}]),ke[0].t||(ke[0].t={}),ke[0].trace=Z,ee[ue]=ke}}for(U(z,j,W),Y=0;Y<j.length;Y++)se(Y,!0);for(Y=0;Y<j.length;Y++)he(Y);for(ae&&U(z,j,W),Y=0;Y<j.length;Y++)se(Y,!0);for(Y=0;Y<j.length;Y++)se(Y,!1);G(X);var de=function(ue,ve){var ke,Ee,be,xe,ce,ge=[];function we(Ke,_e,Ce){var Le=_e._id.charAt(0);if(Ke==="histogram2dcontour"){var Pe=_e._counterAxes[0],Xe=i.getFromId(ve,Pe),ht=Le==="x"||Pe==="x"&&Xe.type==="category",Mt=Le==="y"||Pe==="y"&&Xe.type==="category";return function(pt,Lt){return pt===0||Lt===0||ht&&pt===Ce[Lt].length-1||Mt&&Lt===Ce.length-1?-1:(Le==="y"?Lt:pt)-1}}return function(pt,Lt){return Le==="y"?Lt:pt}}var Me={min:function(Ke){return o.aggNums(Math.min,null,Ke)},max:function(Ke){return o.aggNums(Math.max,null,Ke)},sum:function(Ke){return o.aggNums(function(_e,Ce){return _e+Ce},null,Ke)},total:function(Ke){return o.aggNums(function(_e,Ce){return _e+Ce},null,Ke)},mean:function(Ke){return o.mean(Ke)},median:function(Ke){return o.median(Ke)}};for(ke=0;ke<ue.length;ke++){var Se=ue[ke];if(Se.type==="category"){var ze=Se.categoryorder.match(N);if(ze){var Fe=ze[1],Ye=ze[2],rt=Se._id.charAt(0),Oe=rt==="x",je=[];for(Ee=0;Ee<Se._categories.length;Ee++)je.push([Se._categories[Ee],[]]);for(Ee=0;Ee<Se._traceIndices.length;Ee++){var We=Se._traceIndices[Ee],qe=ve._fullData[We];if(qe.visible===!0){var et=qe.type;e.traceIs(qe,"histogram")&&(delete qe._xautoBinFinished,delete qe._yautoBinFinished);var st=et==="splom",ct=et==="scattergl",Pt=ve.calcdata[We];for(be=0;be<Pt.length;be++){var kt,at,tt=Pt[be];if(st){var _t=qe._axesDim[Se._id];if(!Oe){var er=qe._diag[_t][0];er&&(Se=ve._fullLayout[i.id2name(er)])}var tr=tt.trace.dimensions[_t].values;for(xe=0;xe<tr.length;xe++)for(kt=Se._categoriesMap[tr[xe]],ce=0;ce<tt.trace.dimensions.length;ce++)if(ce!==_t){var Ue=tt.trace.dimensions[ce];je[kt][1].push(Ue.values[xe])}}else if(ct){for(xe=0;xe<tt.t.x.length;xe++)Oe?(kt=tt.t.x[xe],at=tt.t.y[xe]):(kt=tt.t.y[xe],at=tt.t.x[xe]),je[kt][1].push(at);tt.t&&tt.t._scene&&delete tt.t._scene.dirty}else if(tt.hasOwnProperty("z")){at=tt.z;var He=we(qe.type,Se,at);for(xe=0;xe<at.length;xe++)for(ce=0;ce<at[xe].length;ce++)(kt=He(ce,xe))+1&&je[kt][1].push(at[xe][ce])}else for((kt=tt.p)===void 0&&(kt=tt[rt]),(at=tt.s)===void 0&&(at=tt.v),at===void 0&&(at=Oe?tt.y:tt.x),Array.isArray(at)||(at=at===void 0?[]:[at]),xe=0;xe<at.length;xe++)je[kt][1].push(at[xe])}}}Se._categoriesValue=je;var Be=[];for(Ee=0;Ee<je.length;Ee++)Be.push([je[Ee][0],Me[Fe](je[Ee][1])]);Be.sort(function(Ke,_e){return Ke[1]-_e[1]}),Se._categoriesAggregatedValue=Be,Se._initialCategories=Be.map(function(Ke){return Ke[0]}),Ye==="descending"&&Se._initialCategories.reverse(),ge=ge.concat(Se.sortByInitialCategories())}}}return ge}(z,X);if(de.length){for(W._numBoxes=0,W._numViolins=0,Y=0;Y<de.length;Y++)se(de[Y],!0);for(Y=0;Y<de.length;Y++)se(de[Y],!1);G(X)}e.getComponentMethod("fx","calc")(X),e.getComponentMethod("errorbars","calc")(X)};var N=/(total|sum|min|max|mean|median) (ascending|descending)/;function U(X,K,Z){var H={};function Y(W){W.clearCalc(),W.type==="multicategory"&&W.setupMultiCategory(K),H[W._id]=1}o.simpleMap(X,Y);for(var $=Z._axisMatchGroups||[],z=0;z<$.length;z++)for(var j in $[z])H[j]||Y(Z[i.id2name(j)])}function G(X){var K,Z,H,Y=X._fullLayout,$=Y._visibleModules,z={};for(Z=0;Z<$.length;Z++){var j=$[Z],W=j.crossTraceCalc;if(W){var ee=j.basePlotModule.name;z[ee]?o.pushUnique(z[ee],W):z[ee]=[W]}}for(H in z){var J=z[H],Q=Y._subplots[H];if(Array.isArray(Q))for(K=0;K<Q.length;K++){var te=Q[K],ie=H==="cartesian"?Y._plots[te]:Y[te];for(Z=0;Z<J.length;Z++)J[Z](X,ie,te)}else for(Z=0;Z<J.length;Z++)J[Z](X)}}v.rehover=function(X){X._fullLayout._rehover&&X._fullLayout._rehover()},v.redrag=function(X){X._fullLayout._redrag&&X._fullLayout._redrag()},v.generalUpdatePerTraceModule=function(X,K,Z,H){var Y,$=K.traceHash,z={};for(Y=0;Y<Z.length;Y++){var j=Z[Y],W=j[0].trace;W.visible&&(z[W.type]=z[W.type]||[],z[W.type].push(j))}for(var ee in $)if(!z[ee]){var J=$[ee][0];J[0].trace.visible=!1,z[ee]=[J]}for(var Q in z){var te=z[Q];te[0][0].trace._module.plot(X,K,o.filterVisible(te),H)}K.traceHash=z},v.plotBasePlot=function(X,K,Z,H,Y){var $=e.getModule(X),z=g(K.calcdata,$)[0];$.plot(K,z,H,Y)},v.cleanBasePlot=function(X,K,Z,H,Y){var $=Y._has&&Y._has(X),z=Z._has&&Z._has(X);$&&!z&&Y["_"+X+"layer"].selectAll("g.trace").remove()}},{"../components/color":650,"../constants/numerical":763,"../lib":787,"../plot_api/plot_schema":826,"../plot_api/plot_template":827,"../plots/get_data":875,"../registry":915,"./animation_attributes":832,"./attributes":834,"./cartesian/axis_ids":842,"./cartesian/handle_outline":849,"./command":865,"./font_attributes":867,"./frame_attributes":868,"./layout_attributes":892,"@plotly/d3":58,"d3-format":164,"d3-time-format":172,"fast-isnumeric":246}],902:[function(r,I,B){I.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],903:[function(r,I,B){var t=r("../../lib"),d=r("../../lib/polygon").tester,m=t.findIndexOfMin,h=t.isAngleInsideSector,e=t.angleDelta,f=t.angleDist;function l(i,c,n,a){var g,p,y=a[0],v=a[1],b=u(Math.sin(c)-Math.sin(i)),x=u(Math.cos(c)-Math.cos(i)),T=Math.tan(n),A=u(1/T),S=b/x,w=v-S*y;return A?b&&x?p=T*(g=w/(T-S)):x?(g=v*A,p=v):(g=y,p=y*T):b&&x?(g=0,p=w):x?(g=0,p=v):g=p=NaN,[g,p]}function o(i,c,n,a){return t.isFullCircle([c,n])?function(g,p){var y,v=p.length,b=new Array(v+1);for(y=0;y<v;y++){var x=p[y];b[y]=[g*Math.cos(x),g*Math.sin(x)]}return b[y]=b[0].slice(),b}(i,a):function(g,p,y,v){var b,x,T=v.length,A=[];function S(U){return[g*Math.cos(U),g*Math.sin(U)]}function w(U,G,X){return l(U,G,X,S(U))}function E(U){return t.mod(U,T)}function k(U){return h(U,[p,y])}var L=m(v,function(U){return k(U)?f(U,p):1/0}),M=w(v[L],v[E(L-1)],p);for(A.push(M),b=L,x=0;x<T;b++,x++){var P=v[E(b)];if(!k(P))break;A.push(S(P))}var D=m(v,function(U){return k(U)?f(U,y):1/0}),N=w(v[D],v[E(D+1)],y);return A.push(N),A.push([0,0]),A.push(A[0].slice()),A}(i,c,n,a)}function u(i){return Math.abs(i)>1e-10?i:0}function s(i,c,n){c=c||0,n=n||0;for(var a=i.length,g=new Array(a),p=0;p<a;p++){var y=i[p];g[p]=[c+y[0],n-y[1]]}return g}I.exports={isPtInsidePolygon:function(i,c,n,a,g){if(!h(c,a))return!1;var p,y;n[0]<n[1]?(p=n[0],y=n[1]):(p=n[1],y=n[0]);var v=d(o(p,a[0],a[1],g)),b=d(o(y,a[0],a[1],g)),x=[i*Math.cos(c),i*Math.sin(c)];return b.contains(x)&&!v.contains(x)},findPolygonOffset:function(i,c,n,a){for(var g=1/0,p=1/0,y=o(i,c,n,a),v=0;v<y.length;v++){var b=y[v];g=Math.min(g,b[0]),p=Math.min(p,-b[1])}return[g,p]},findEnclosingVertexAngles:function(i,c){var n=m(c,function(g){var p=e(g,i);return p>0?p:1/0}),a=t.mod(n+1,c.length);return[c[n],c[a]]},findIntersectionXY:l,findXYatLength:function(i,c,n,a){var g=-c*n,p=c*c+1,y=2*(c*g-n),v=g*g+n*n-i*i,b=Math.sqrt(y*y-4*p*v),x=(-y+b)/(2*p),T=(-y-b)/(2*p);return[[x,c*x+g+a],[T,c*T+g+a]]},clampTiny:u,pathPolygon:function(i,c,n,a,g,p){return"M"+s(o(i,c,n,a),g,p).join("L")},pathPolygonAnnulus:function(i,c,n,a,g,p,y){var v,b;i<c?(v=i,b=c):(v=c,b=i);var x=s(o(v,n,a,g),p,y);return"M"+s(o(b,n,a,g),p,y).reverse().join("L")+"M"+x.join("L")}}},{"../../lib":787,"../../lib/polygon":799}],904:[function(r,I,B){var t=r("../get_data").getSubplotCalcData,d=r("../../lib").counterRegex,m=r("./polar"),h=r("./constants"),e=h.attr,f=h.name,l=d(f),o={};o[e]={valType:"subplotid",dflt:f,editType:"calc"},I.exports={attr:e,name:f,idRoot:f,idRegex:l,attrRegex:l,attributes:o,layoutAttributes:r("./layout_attributes"),supplyLayoutDefaults:r("./layout_defaults"),plot:function(u){for(var s=u._fullLayout,i=u.calcdata,c=s._subplots[f],n=0;n<c.length;n++){var a=c[n],g=t(i,f,a),p=s[a]._subplot;p||(p=m(u,a),s[a]._subplot=p),p.plot(g,s,u._promises)}},clean:function(u,s,i,c){for(var n=c._subplots[f]||[],a=c._has&&c._has("gl"),g=s._has&&s._has("gl"),p=a&&!g,y=0;y<n.length;y++){var v=n[y],b=c[v]._subplot;if(!s[v]&&b)for(var x in b.framework.remove(),b.layers["radial-axis-title"].remove(),b.clipPaths)b.clipPaths[x].remove();p&&b._scene&&(b._scene.destroy(),b._scene=null)}},toSVG:r("../cartesian").toSVG}},{"../../lib":787,"../cartesian":852,"../get_data":875,"./constants":902,"./layout_attributes":905,"./layout_defaults":906,"./polar":907}],905:[function(r,I,B){var t=r("../../components/color/attributes"),d=r("../cartesian/layout_attributes"),m=r("../domain").attributes,h=r("../../lib").extendFlat,e=r("../../plot_api/edit_types").overrideAll,f=e({color:d.color,showline:h({},d.showline,{dflt:!0}),linecolor:d.linecolor,linewidth:d.linewidth,showgrid:h({},d.showgrid,{dflt:!0}),gridcolor:d.gridcolor,gridwidth:d.gridwidth},"plot","from-root"),l=e({tickmode:d.tickmode,nticks:d.nticks,tick0:d.tick0,dtick:d.dtick,tickvals:d.tickvals,ticktext:d.ticktext,ticks:d.ticks,ticklen:d.ticklen,tickwidth:d.tickwidth,tickcolor:d.tickcolor,showticklabels:d.showticklabels,showtickprefix:d.showtickprefix,tickprefix:d.tickprefix,showticksuffix:d.showticksuffix,ticksuffix:d.ticksuffix,showexponent:d.showexponent,exponentformat:d.exponentformat,minexponent:d.minexponent,separatethousands:d.separatethousands,tickfont:d.tickfont,tickangle:d.tickangle,tickformat:d.tickformat,tickformatstops:d.tickformatstops,layer:d.layer},"plot","from-root"),o={visible:h({},d.visible,{dflt:!0}),type:h({},d.type,{values:["-","linear","log","date","category"]}),autotypenumbers:d.autotypenumbers,autorange:h({},d.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:h({},d.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:d.categoryorder,categoryarray:d.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:h({},d.title.text,{editType:"plot",dflt:""}),font:h({},d.title.font,{editType:"plot"}),editType:"plot"},hoverformat:d.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:d._deprecated.title,titlefont:d._deprecated.titlefont}};h(o,f,l);var u={visible:h({},d.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:d.autotypenumbers,categoryorder:d.categoryorder,categoryarray:d.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:d.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};h(u,f,l),I.exports={domain:m({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:t.background},radialaxis:o,angularaxis:u,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":649,"../../lib":787,"../../plot_api/edit_types":820,"../cartesian/layout_attributes":853,"../domain":866}],906:[function(r,I,B){var t=r("../../lib"),d=r("../../components/color"),m=r("../../plot_api/plot_template"),h=r("../subplot_defaults"),e=r("../get_data").getSubplotData,f=r("../cartesian/tick_value_defaults"),l=r("../cartesian/tick_mark_defaults"),o=r("../cartesian/tick_label_defaults"),u=r("../cartesian/category_order_defaults"),s=r("../cartesian/line_grid_defaults"),i=r("../cartesian/axis_autotype"),c=r("./layout_attributes"),n=r("./set_convert"),a=r("./constants"),g=a.axisNames;function p(v,b,x,T){var A=x("bgcolor");T.bgColor=d.combine(A,T.paper_bgcolor);var S=x("sector");x("hole");var w,E=e(T.fullData,a.name,T.id),k=T.layoutOut;function L($,z){return x(w+"."+$,z)}for(var M=0;M<g.length;M++){w=g[M],t.isPlainObject(v[w])||(v[w]={});var P=v[w],D=m.newContainer(b,w);D._id=D._name=w,D._attr=T.id+"."+w,D._traceIndices=E.map(function($){return $._expandedIndex});var N=a.axisName2dataArray[w],U=y(P,D,L,E,N,T);u(P,D,L,{axData:E,dataAttr:N});var G,X,K=L("visible");switch(n(D,b,k),L("uirevision",b.uirevision),K&&(X=(G=L("color"))===P.color?G:T.font.color),D._m=1,w){case"radialaxis":var Z=L("autorange",!D.isValidRange(P.range));P.autorange=Z,!Z||U!=="linear"&&U!=="-"||L("rangemode"),Z==="reversed"&&(D._m=-1),L("range"),D.cleanRange("range",{dfltRange:[0,1]}),K&&(L("side"),L("angle",S[0]),L("title.text"),t.coerceFont(L,"title.font",{family:T.font.family,size:t.bigFont(T.font.size),color:X}));break;case"angularaxis":if(U==="date"){t.log("Polar plots do not support date angular axes yet.");for(var H=0;H<E.length;H++)E[H].visible=!1;U=P.type=D.type="linear"}L(U==="linear"?"thetaunit":"period");var Y=L("direction");L("rotation",{counterclockwise:0,clockwise:90}[Y])}K&&(f(P,D,L,D.type),o(P,D,L,D.type,{tickSuffixDflt:D.thetaunit==="degrees"?"\xB0":void 0}),l(P,D,L,{outerTicks:!0}),L("showticklabels")&&(t.coerceFont(L,"tickfont",{family:T.font.family,size:T.font.size,color:X}),L("tickangle"),L("tickformat")),s(P,D,L,{dfltColor:G,bgColor:T.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:c[w]}),L("layer")),U!=="category"&&L("hoverformat"),D._input=P}b.angularaxis.type==="category"&&x("gridshape")}function y(v,b,x,T,A,S){var w=x("autotypenumbers",S.autotypenumbersDflt);if(x("type")==="-"){for(var E,k=0;k<T.length;k++)if(T[k].visible){E=T[k];break}E&&E[A]&&(b.type=i(E[A],"gregorian",{noMultiCategory:!0,autotypenumbers:w})),b.type==="-"?b.type="linear":v.type=b.type}return b.type}I.exports=function(v,b,x){h(v,b,x,{type:a.name,attributes:c,handleDefaults:p,font:b.font,autotypenumbersDflt:b.autotypenumbers,paper_bgcolor:b.paper_bgcolor,fullData:x,layoutOut:b})}},{"../../components/color":650,"../../lib":787,"../../plot_api/plot_template":827,"../cartesian/axis_autotype":839,"../cartesian/category_order_defaults":843,"../cartesian/line_grid_defaults":855,"../cartesian/tick_label_defaults":860,"../cartesian/tick_mark_defaults":861,"../cartesian/tick_value_defaults":862,"../get_data":875,"../subplot_defaults":909,"./constants":902,"./layout_attributes":905,"./set_convert":908}],907:[function(r,I,B){var t=r("@plotly/d3"),d=r("tinycolor2"),m=r("../../registry"),h=r("../../lib"),e=h.strRotate,f=h.strTranslate,l=r("../../components/color"),o=r("../../components/drawing"),u=r("../plots"),s=r("../../plots/cartesian/axes"),i=r("../cartesian/set_convert"),c=r("./set_convert"),n=r("../cartesian/autorange").doAutoRange,a=r("../cartesian/dragbox"),g=r("../../components/dragelement"),p=r("../../components/fx"),y=r("../../components/titles"),v=r("../cartesian/select").prepSelect,b=r("../cartesian/select").selectOnClick,x=r("../cartesian/select").clearSelect,T=r("../../lib/setcursor"),A=r("../../lib/clear_gl_canvases"),S=r("../../plot_api/subroutines").redrawReglTraces,w=r("../../constants/alignment").MID_SHIFT,E=r("./constants"),k=r("./helpers"),L=h._,M=h.mod,P=h.deg2rad,D=h.rad2deg;function N(Z,H){this.id=H,this.gd=Z,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var Y=Z._fullLayout,$="clip"+Y._uid+H;this.clipIds.forTraces=$+"-for-traces",this.clipPaths.forTraces=Y._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=Y._polarlayer.append("g").attr("class",H),this.radialTickLayout=null,this.angularTickLayout=null}var U=N.prototype;function G(Z){var H=Z.ticks+String(Z.ticklen)+String(Z.showticklabels);return"side"in Z&&(H+=Z.side),H}function X(Z,H){return H[h.findIndexOfMin(H,function(Y){return h.angleDist(Z,Y)})]}function K(Z,H,Y){return H?(Z.attr("display",null),Z.attr(Y)):Z&&Z.attr("display","none"),Z}I.exports=function(Z,H){return new N(Z,H)},U.plot=function(Z,H){var Y=H[this.id];this._hasClipOnAxisFalse=!1;for(var $=0;$<Z.length;$++)if(Z[$][0].trace.cliponaxis===!1){this._hasClipOnAxisFalse=!0;break}this.updateLayers(H,Y),this.updateLayout(H,Y),u.generalUpdatePerTraceModule(this.gd,this,Z,Y),this.updateFx(H,Y)},U.updateLayers=function(Z,H){var Y=this.layers,$=H.radialaxis,z=H.angularaxis,j=E.layerNames,W=j.indexOf("frontplot"),ee=j.slice(0,W),J=z.layer==="below traces",Q=$.layer==="below traces";J&&ee.push("angular-line"),Q&&ee.push("radial-line"),J&&ee.push("angular-axis"),Q&&ee.push("radial-axis"),ee.push("frontplot"),J||ee.push("angular-line"),Q||ee.push("radial-line"),J||ee.push("angular-axis"),Q||ee.push("radial-axis");var te=this.framework.selectAll(".polarsublayer").data(ee,String);te.enter().append("g").attr("class",function(ie){return"polarsublayer "+ie}).each(function(ie){var ae=Y[ie]=t.select(this);switch(ie){case"frontplot":ae.append("g").classed("barlayer",!0),ae.append("g").classed("scatterlayer",!0);break;case"backplot":ae.append("g").classed("maplayer",!0);break;case"plotbg":Y.bg=ae.append("path");break;case"radial-grid":case"angular-grid":ae.style("fill","none");break;case"radial-line":ae.append("line").style("fill","none");break;case"angular-line":ae.append("path").style("fill","none")}}),te.order()},U.updateLayout=function(Z,H){var Y=this.layers,$=Z._size,z=H.radialaxis,j=H.angularaxis,W=H.domain.x,ee=H.domain.y;this.xOffset=$.l+$.w*W[0],this.yOffset=$.t+$.h*(1-ee[1]);var J=this.xLength=$.w*(W[1]-W[0]),Q=this.yLength=$.h*(ee[1]-ee[0]),te=H.sector;this.sectorInRad=te.map(P);var ie,ae,he,se,de,ue=this.sectorBBox=function(rt){var Oe,je,We,qe,et=rt[0],st=rt[1]-et,ct=M(et,360),Pt=ct+st,kt=Math.cos(P(ct)),at=Math.sin(P(ct)),tt=Math.cos(P(Pt)),_t=Math.sin(P(Pt));return qe=ct<=90&&Pt>=90||ct>90&&Pt>=450?1:at<=0&&_t<=0?0:Math.max(at,_t),Oe=ct<=180&&Pt>=180||ct>180&&Pt>=540?-1:kt>=0&&tt>=0?0:Math.min(kt,tt),je=ct<=270&&Pt>=270||ct>270&&Pt>=630?-1:at>=0&&_t>=0?0:Math.min(at,_t),We=Pt>=360?1:kt<=0&&tt<=0?0:Math.max(kt,tt),[Oe,je,We,qe]}(te),ve=ue[2]-ue[0],ke=ue[3]-ue[1],Ee=Q/J,be=Math.abs(ke/ve);Ee>be?(ie=J,de=(Q-(ae=J*be))/$.h/2,he=[W[0],W[1]],se=[ee[0]+de,ee[1]-de]):(ae=Q,de=(J-(ie=Q/be))/$.w/2,he=[W[0]+de,W[1]-de],se=[ee[0],ee[1]]),this.xLength2=ie,this.yLength2=ae,this.xDomain2=he,this.yDomain2=se;var xe=this.xOffset2=$.l+$.w*he[0],ce=this.yOffset2=$.t+$.h*(1-se[1]),ge=this.radius=ie/ve,we=this.innerRadius=H.hole*ge,Me=this.cx=xe-ge*ue[0],Se=this.cy=ce+ge*ue[3],ze=this.cxx=Me-xe,Fe=this.cyy=Se-ce;this.radialAxis=this.mockAxis(Z,H,z,{_id:"x",side:{counterclockwise:"top",clockwise:"bottom"}[z.side],_realSide:z.side,domain:[we/$.w,ge/$.w]}),this.angularAxis=this.mockAxis(Z,H,j,{side:"right",domain:[0,Math.PI],autorange:!1}),this.doAutoRange(Z,H),this.updateAngularAxis(Z,H),this.updateRadialAxis(Z,H),this.updateRadialAxisTitle(Z,H),this.xaxis=this.mockCartesianAxis(Z,H,{_id:"x",domain:he}),this.yaxis=this.mockCartesianAxis(Z,H,{_id:"y",domain:se});var Ye=this.pathSubplot();this.clipPaths.forTraces.select("path").attr("d",Ye).attr("transform",f(ze,Fe)),Y.frontplot.attr("transform",f(xe,ce)).call(o.setClipUrl,this._hasClipOnAxisFalse?null:this.clipIds.forTraces,this.gd),Y.bg.attr("d",Ye).attr("transform",f(Me,Se)).call(l.fill,H.bgcolor)},U.mockAxis=function(Z,H,Y,$){var z=h.extendFlat({},Y,$);return c(z,H,Z),z},U.mockCartesianAxis=function(Z,H,Y){var $=this,z=Y._id,j=h.extendFlat({type:"linear"},Y);i(j,Z);var W={x:[0,2],y:[1,3]};return j.setRange=function(){var ee=$.sectorBBox,J=W[z],Q=$.radialAxis._rl,te=(Q[1]-Q[0])/(1-H.hole);j.range=[ee[J[0]]*te,ee[J[1]]*te]},j.isPtWithinRange=z==="x"?function(ee){return $.isPtInside(ee)}:function(){return!0},j.setRange(),j.setScale(),j},U.doAutoRange=function(Z,H){var Y=this.gd,$=this.radialAxis,z=H.radialaxis;$.setScale(),n(Y,$);var j=$.range;z.range=j.slice(),z._input.range=j.slice(),$._rl=[$.r2l(j[0],null,"gregorian"),$.r2l(j[1],null,"gregorian")]},U.updateRadialAxis=function(Z,H){var Y=this,$=Y.gd,z=Y.layers,j=Y.radius,W=Y.innerRadius,ee=Y.cx,J=Y.cy,Q=H.radialaxis,te=M(H.sector[0],360),ie=Y.radialAxis,ae=W<j;Y.fillViewInitialKey("radialaxis.angle",Q.angle),Y.fillViewInitialKey("radialaxis.range",ie.range.slice()),ie.setGeometry(),ie.tickangle==="auto"&&te>90&&te<=270&&(ie.tickangle=180);var he=function(xe){return f(ie.l2p(xe.x)+W,0)},se=G(Q);if(Y.radialTickLayout!==se&&(z["radial-axis"].selectAll(".xtick").remove(),Y.radialTickLayout=se),ae){ie.setScale();var de=s.calcTicks(ie),ue=s.clipEnds(ie,de),ve=s.getTickSigns(ie)[2];s.drawTicks($,ie,{vals:de,layer:z["radial-axis"],path:s.makeTickPath(ie,0,ve),transFn:he,crisp:!1}),s.drawGrid($,ie,{vals:ue,layer:z["radial-grid"],path:function(xe){return Y.pathArc(ie.r2p(xe.x)+W)},transFn:h.noop,crisp:!1}),s.drawLabels($,ie,{vals:de,layer:z["radial-axis"],transFn:he,labelFns:s.makeLabelFns(ie,0)})}var ke=Y.radialAxisAngle=Y.vangles?D(X(P(Q.angle),Y.vangles)):Q.angle,Ee=f(ee,J),be=Ee+e(-ke);K(z["radial-axis"],ae&&(Q.showticklabels||Q.ticks),{transform:be}),K(z["radial-grid"],ae&&Q.showgrid,{transform:Ee}),K(z["radial-line"].select("line"),ae&&Q.showline,{x1:W,y1:0,x2:j,y2:0,transform:be}).attr("stroke-width",Q.linewidth).call(l.stroke,Q.linecolor)},U.updateRadialAxisTitle=function(Z,H,Y){var $=this.gd,z=this.radius,j=this.cx,W=this.cy,ee=H.radialaxis,J=this.id+"title",Q=Y!==void 0?Y:this.radialAxisAngle,te=P(Q),ie=Math.cos(te),ae=Math.sin(te),he=0;if(ee.title){var se=o.bBox(this.layers["radial-axis"].node()).height,de=ee.title.font.size;he=ee.side==="counterclockwise"?-se-.4*de:se+.8*de}this.layers["radial-axis-title"]=y.draw($,J,{propContainer:ee,propName:this.id+".radialaxis.title",placeholder:L($,"Click to enter radial axis title"),attributes:{x:j+z/2*ie+he*ae,y:W-z/2*ae+he*ie,"text-anchor":"middle"},transform:{rotate:-Q}})},U.updateAngularAxis=function(Z,H){var Y=this,$=Y.gd,z=Y.layers,j=Y.radius,W=Y.innerRadius,ee=Y.cx,J=Y.cy,Q=H.angularaxis,te=Y.angularAxis;Y.fillViewInitialKey("angularaxis.rotation",Q.rotation),te.setGeometry(),te.setScale();var ie=function(be){return te.t2g(be.x)};te.type==="linear"&&te.thetaunit==="radians"&&(te.tick0=D(te.tick0),te.dtick=D(te.dtick));var ae=function(be){return f(ee+j*Math.cos(be),J-j*Math.sin(be))},he=s.makeLabelFns(te,0).labelStandoff,se={xFn:function(be){var xe=ie(be);return Math.cos(xe)*he},yFn:function(be){var xe=ie(be),ce=Math.sin(xe)>0?.2:1;return-Math.sin(xe)*(he+be.fontSize*ce)+Math.abs(Math.cos(xe))*(be.fontSize*w)},anchorFn:function(be){var xe=ie(be),ce=Math.cos(xe);return Math.abs(ce)<.1?"middle":ce>0?"start":"end"},heightFn:function(be,xe,ce){var ge=ie(be);return-.5*(1+Math.sin(ge))*ce}},de=G(Q);Y.angularTickLayout!==de&&(z["angular-axis"].selectAll("."+te._id+"tick").remove(),Y.angularTickLayout=de);var ue,ve=s.calcTicks(te);if(H.gridshape==="linear"?(ue=ve.map(ie),h.angleDelta(ue[0],ue[1])<0&&(ue=ue.slice().reverse())):ue=null,Y.vangles=ue,te.type==="category"&&(ve=ve.filter(function(be){return h.isAngleInsideSector(ie(be),Y.sectorInRad)})),te.visible){var ke=te.ticks==="inside"?-1:1,Ee=(te.linewidth||1)/2;s.drawTicks($,te,{vals:ve,layer:z["angular-axis"],path:"M"+ke*Ee+",0h"+ke*te.ticklen,transFn:function(be){var xe=ie(be);return ae(xe)+e(-D(xe))},crisp:!1}),s.drawGrid($,te,{vals:ve,layer:z["angular-grid"],path:function(be){var xe=ie(be),ce=Math.cos(xe),ge=Math.sin(xe);return"M"+[ee+W*ce,J-W*ge]+"L"+[ee+j*ce,J-j*ge]},transFn:h.noop,crisp:!1}),s.drawLabels($,te,{vals:ve,layer:z["angular-axis"],repositionOnUpdate:!0,transFn:function(be){return ae(ie(be))},labelFns:se})}K(z["angular-line"].select("path"),Q.showline,{d:Y.pathSubplot(),transform:f(ee,J)}).attr("stroke-width",Q.linewidth).call(l.stroke,Q.linecolor)},U.updateFx=function(Z,H){this.gd._context.staticPlot||(this.updateAngularDrag(Z),this.updateRadialDrag(Z,H,0),this.updateRadialDrag(Z,H,1),this.updateMainDrag(Z))},U.updateMainDrag=function(Z){var H,Y,$=this,z=$.gd,j=$.layers,W=Z._zoomlayer,ee=E.MINZOOM,J=E.OFFEDGE,Q=$.radius,te=$.innerRadius,ie=$.cx,ae=$.cy,he=$.cxx,se=$.cyy,de=$.sectorInRad,ue=$.vangles,ve=$.radialAxis,ke=k.clampTiny,Ee=k.findXYatLength,be=k.findEnclosingVertexAngles,xe=E.cornerHalfWidth,ce=E.cornerLen/2,ge=a.makeDragger(j,"path","maindrag","crosshair");t.select(ge).attr("d",$.pathSubplot()).attr("transform",f(ie,ae));var we,Me,Se,ze,Fe,Ye,rt,Oe,je,We={element:ge,gd:z,subplot:$.id,plotinfo:{id:$.id,xaxis:$.xaxis,yaxis:$.yaxis},xaxes:[$.xaxis],yaxes:[$.yaxis]};function qe(Ke,_e){return Math.sqrt(Ke*Ke+_e*_e)}function et(Ke,_e){return qe(Ke-he,_e-se)}function st(Ke,_e){return Math.atan2(se-_e,Ke-he)}function ct(Ke,_e){return[Ke*Math.cos(_e),Ke*Math.sin(-_e)]}function Pt(Ke,_e){if(Ke===0)return $.pathSector(2*xe);var Ce=ce/Ke,Le=_e-Ce,Pe=_e+Ce,Xe=Math.max(0,Math.min(Ke,Q)),ht=Xe-xe,Mt=Xe+xe;return"M"+ct(ht,Le)+"A"+[ht,ht]+" 0,0,0 "+ct(ht,Pe)+"L"+ct(Mt,Pe)+"A"+[Mt,Mt]+" 0,0,1 "+ct(Mt,Le)+"Z"}function kt(Ke,_e,Ce){if(Ke===0)return $.pathSector(2*xe);var Le,Pe,Xe=ct(Ke,_e),ht=ct(Ke,Ce),Mt=ke((Xe[0]+ht[0])/2),pt=ke((Xe[1]+ht[1])/2);if(Mt&&pt){var Lt=pt/Mt,vt=-1/Lt,Dt=Ee(xe,Lt,Mt,pt);Le=Ee(ce,vt,Dt[0][0],Dt[0][1]),Pe=Ee(ce,vt,Dt[1][0],Dt[1][1])}else{var xt,it;pt?(xt=ce,it=xe):(xt=xe,it=ce),Le=[[Mt-xt,pt-it],[Mt+xt,pt-it]],Pe=[[Mt-xt,pt+it],[Mt+xt,pt+it]]}return"M"+Le.join("L")+"L"+Pe.reverse().join("L")+"Z"}function at(Ke,_e){return _e=Math.max(Math.min(_e,Q),te),Ke<J?Ke=0:Q-Ke<J?Ke=Q:_e<J?_e=0:Q-_e<J&&(_e=Q),Math.abs(_e-Ke)>ee?(Ke<_e?(Se=Ke,ze=_e):(Se=_e,ze=Ke),!0):(Se=null,ze=null,!1)}function tt(Ke,_e){Ke=Ke||Fe,_e=_e||"M0,0Z",Oe.attr("d",Ke),je.attr("d",_e),a.transitionZoombox(Oe,je,Ye,rt),Ye=!0;var Ce={};He(Ce),z.emit("plotly_relayouting",Ce)}function _t(Ke,_e){var Ce,Le,Pe=we+(Ke*=H),Xe=Me+(_e*=Y),ht=et(we,Me),Mt=Math.min(et(Pe,Xe),Q),pt=st(we,Me);at(ht,Mt)&&(Ce=Fe+$.pathSector(ze),Se&&(Ce+=$.pathSector(Se)),Le=Pt(Se,pt)+Pt(ze,pt)),tt(Ce,Le)}function er(Ke,_e,Ce,Le){var Pe=k.findIntersectionXY(Ce,Le,Ce,[Ke-he,se-_e]);return qe(Pe[0],Pe[1])}function tr(Ke,_e){var Ce,Le,Pe=we+Ke,Xe=Me+_e,ht=st(we,Me),Mt=st(Pe,Xe),pt=be(ht,ue),Lt=be(Mt,ue);at(er(we,Me,pt[0],pt[1]),Math.min(er(Pe,Xe,Lt[0],Lt[1]),Q))&&(Ce=Fe+$.pathSector(ze),Se&&(Ce+=$.pathSector(Se)),Le=[kt(Se,pt[0],pt[1]),kt(ze,pt[0],pt[1])].join(" ")),tt(Ce,Le)}function Ue(){if(a.removeZoombox(z),Se!==null&&ze!==null){var Ke={};He(Ke),a.showDoubleClickNotifier(z),m.call("_guiRelayout",z,Ke)}}function He(Ke){var _e=ve._rl,Ce=(_e[1]-_e[0])/(1-te/Q)/Q,Le=[_e[0]+(Se-te)*Ce,_e[0]+(ze-te)*Ce];Ke[$.id+".radialaxis.range"]=Le}function Be(Ke,_e){var Ce=z._fullLayout.clickmode;if(a.removeZoombox(z),Ke===2){var Le={};for(var Pe in $.viewInitial)Le[$.id+"."+Pe]=$.viewInitial[Pe];z.emit("plotly_doubleclick",null),m.call("_guiRelayout",z,Le)}Ce.indexOf("select")>-1&&Ke===1&&b(_e,z,[$.xaxis],[$.yaxis],$.id,We),Ce.indexOf("event")>-1&&p.click(z,_e,$.id)}We.prepFn=function(Ke,_e,Ce){var Le=z._fullLayout.dragmode,Pe=ge.getBoundingClientRect();z._fullLayout._calcInverseTransform(z);var Xe=z._fullLayout._invTransform;H=z._fullLayout._invScaleX,Y=z._fullLayout._invScaleY;var ht=h.apply3DTransform(Xe)(_e-Pe.left,Ce-Pe.top);if(we=ht[0],Me=ht[1],ue){var Mt=k.findPolygonOffset(Q,de[0],de[1],ue);we+=he+Mt[0],Me+=se+Mt[1]}switch(Le){case"zoom":We.moveFn=ue?tr:_t,We.clickFn=Be,We.doneFn=Ue,function(){Se=null,ze=null,Fe=$.pathSubplot(),Ye=!1;var pt=z._fullLayout[$.id];rt=d(pt.bgcolor).getLuminance(),(Oe=a.makeZoombox(W,rt,ie,ae,Fe)).attr("fill-rule","evenodd"),je=a.makeCorners(W,ie,ae),x(z)}();break;case"select":case"lasso":v(Ke,_e,Ce,We,Le)}},ge.onmousemove=function(Ke){p.hover(z,Ke,$.id),z._fullLayout._lasthover=ge,z._fullLayout._hoversubplot=$.id},ge.onmouseout=function(Ke){z._dragging||g.unhover(z,Ke)},g.init(We)},U.updateRadialDrag=function(Z,H,Y){var $=this,z=$.gd,j=$.layers,W=$.radius,ee=$.innerRadius,J=$.cx,Q=$.cy,te=$.radialAxis,ie=E.radialDragBoxSize,ae=ie/2;if(te.visible){var he,se,de,ue=P($.radialAxisAngle),ve=te._rl,ke=ve[0],Ee=ve[1],be=ve[Y],xe=.75*(ve[1]-ve[0])/(1-H.hole)/W;Y?(he=J+(W+ae)*Math.cos(ue),se=Q-(W+ae)*Math.sin(ue),de="radialdrag"):(he=J+(ee-ae)*Math.cos(ue),se=Q-(ee-ae)*Math.sin(ue),de="radialdrag-inner");var ce,ge,we,Me=a.makeRectDragger(j,de,"crosshair",-ae,-ae,ie,ie),Se={element:Me,gd:z};K(t.select(Me),te.visible&&ee<W,{transform:f(he,se)}),Se.prepFn=function(){ce=null,ge=null,we=null,Se.moveFn=ze,Se.doneFn=Fe,x(z)},Se.clampFn=function(Oe,je){return Math.sqrt(Oe*Oe+je*je)<E.MINDRAG&&(Oe=0,je=0),[Oe,je]},g.init(Se)}function ze(Oe,je){if(ce)ce(Oe,je);else{var We=[Oe,-je],qe=[Math.cos(ue),Math.sin(ue)],et=Math.abs(h.dot(We,qe)/Math.sqrt(h.dot(We,We)));isNaN(et)||(ce=et<.5?Ye:rt)}var st={};(function(ct){ge!==null?ct[$.id+".radialaxis.angle"]=ge:we!==null&&(ct[$.id+".radialaxis.range["+Y+"]"]=we)})(st),z.emit("plotly_relayouting",st)}function Fe(){ge!==null?m.call("_guiRelayout",z,$.id+".radialaxis.angle",ge):we!==null&&m.call("_guiRelayout",z,$.id+".radialaxis.range["+Y+"]",we)}function Ye(Oe,je){if(Y!==0){var We=he+Oe,qe=se+je;ge=Math.atan2(Q-qe,We-J),$.vangles&&(ge=X(ge,$.vangles)),ge=D(ge);var et=f(J,Q)+e(-ge);j["radial-axis"].attr("transform",et),j["radial-line"].select("line").attr("transform",et);var st=$.gd._fullLayout,ct=st[$.id];$.updateRadialAxisTitle(st,ct,ge)}}function rt(Oe,je){var We=h.dot([Oe,-je],[Math.cos(ue),Math.sin(ue)]);if(we=be-xe*We,xe>0==(Y?we>ke:we<Ee)){var qe=z._fullLayout,et=qe[$.id];te.range[Y]=we,te._rl[Y]=we,$.updateRadialAxis(qe,et),$.xaxis.setRange(),$.xaxis.setScale(),$.yaxis.setRange(),$.yaxis.setScale();var st=!1;for(var ct in $.traceHash){var Pt=$.traceHash[ct],kt=h.filterVisible(Pt);Pt[0][0].trace._module.plot(z,$,kt,et),m.traceIs(ct,"gl")&&kt.length&&(st=!0)}st&&(A(z),S(z))}else we=null}},U.updateAngularDrag=function(Z){var H=this,Y=H.gd,$=H.layers,z=H.radius,j=H.angularAxis,W=H.cx,ee=H.cy,J=H.cxx,Q=H.cyy,te=E.angularDragBoxSize,ie=a.makeDragger($,"path","angulardrag","move"),ae={element:ie,gd:Y};function he(Se,ze){return Math.atan2(Q+te-ze,Se-J-te)}t.select(ie).attr("d",H.pathAnnulus(z,z+te)).attr("transform",f(W,ee)).call(T,"move");var se,de,ue,ve,ke,Ee,be=$.frontplot.select(".scatterlayer").selectAll(".trace"),xe=be.selectAll(".point"),ce=be.selectAll(".textpoint");function ge(Se,ze){var Fe=H.gd._fullLayout,Ye=Fe[H.id],rt=he(se+Se*Z._invScaleX,de+ze*Z._invScaleY),Oe=D(rt-Ee);if(ve=ue+Oe,$.frontplot.attr("transform",f(H.xOffset2,H.yOffset2)+e([-Oe,J,Q])),H.vangles){ke=H.radialAxisAngle+Oe;var je=f(W,ee)+e(-Oe),We=f(W,ee)+e(-ke);$.bg.attr("transform",je),$["radial-grid"].attr("transform",je),$["radial-axis"].attr("transform",We),$["radial-line"].select("line").attr("transform",We),H.updateRadialAxisTitle(Fe,Ye,ke)}else H.clipPaths.forTraces.select("path").attr("transform",f(J,Q)+e(Oe));xe.each(function(){var kt=t.select(this),at=o.getTranslate(kt);kt.attr("transform",f(at.x,at.y)+e([Oe]))}),ce.each(function(){var kt=t.select(this),at=kt.select("text"),tt=o.getTranslate(kt);kt.attr("transform",e([Oe,at.attr("x"),at.attr("y")])+f(tt.x,tt.y))}),j.rotation=h.modHalf(ve,360),H.updateAngularAxis(Fe,Ye),H._hasClipOnAxisFalse&&!h.isFullCircle(H.sectorInRad)&&be.call(o.hideOutsideRangePoints,H);var qe=!1;for(var et in H.traceHash)if(m.traceIs(et,"gl")){var st=H.traceHash[et],ct=h.filterVisible(st);st[0][0].trace._module.plot(Y,H,ct,Ye),ct.length&&(qe=!0)}qe&&(A(Y),S(Y));var Pt={};we(Pt),Y.emit("plotly_relayouting",Pt)}function we(Se){Se[H.id+".angularaxis.rotation"]=ve,H.vangles&&(Se[H.id+".radialaxis.angle"]=ke)}function Me(){ce.select("text").attr("transform",null);var Se={};we(Se),m.call("_guiRelayout",Y,Se)}ae.prepFn=function(Se,ze,Fe){var Ye=Z[H.id];ue=Ye.angularaxis.rotation;var rt=ie.getBoundingClientRect();se=ze-rt.left,de=Fe-rt.top,Y._fullLayout._calcInverseTransform(Y);var Oe=h.apply3DTransform(Z._invTransform)(se,de);se=Oe[0],de=Oe[1],Ee=he(se,de),ae.moveFn=ge,ae.doneFn=Me,x(Y)},H.vangles&&!h.isFullCircle(H.sectorInRad)&&(ae.prepFn=h.noop,T(t.select(ie),null)),g.init(ae)},U.isPtInside=function(Z){var H=this.sectorInRad,Y=this.vangles,$=this.angularAxis.c2g(Z.theta),z=this.radialAxis,j=z.c2l(Z.r),W=z._rl;return(Y?k.isPtInsidePolygon:h.isPtInsideSector)(j,$,W,H,Y)},U.pathArc=function(Z){var H=this.sectorInRad,Y=this.vangles;return(Y?k.pathPolygon:h.pathArc)(Z,H[0],H[1],Y)},U.pathSector=function(Z){var H=this.sectorInRad,Y=this.vangles;return(Y?k.pathPolygon:h.pathSector)(Z,H[0],H[1],Y)},U.pathAnnulus=function(Z,H){var Y=this.sectorInRad,$=this.vangles;return($?k.pathPolygonAnnulus:h.pathAnnulus)(Z,H,Y[0],Y[1],$)},U.pathSubplot=function(){var Z=this.innerRadius,H=this.radius;return Z?this.pathAnnulus(Z,H):this.pathSector(H)},U.fillViewInitialKey=function(Z,H){Z in this.viewInitial||(this.viewInitial[Z]=H)}},{"../../components/color":650,"../../components/dragelement":669,"../../components/drawing":672,"../../components/fx":690,"../../components/titles":748,"../../constants/alignment":755,"../../lib":787,"../../lib/clear_gl_canvases":771,"../../lib/setcursor":808,"../../plot_api/subroutines":828,"../../plots/cartesian/axes":838,"../../registry":915,"../cartesian/autorange":837,"../cartesian/dragbox":847,"../cartesian/select":858,"../cartesian/set_convert":859,"../plots":901,"./constants":902,"./helpers":903,"./set_convert":908,"@plotly/d3":58,tinycolor2:583}],908:[function(r,I,B){var t=r("../../lib"),d=r("../cartesian/set_convert"),m=t.deg2rad,h=t.rad2deg;I.exports=function(e,f,l){switch(d(e,l),e._id){case"x":case"radialaxis":(function(o,u){var s=u._subplot;o.setGeometry=function(){var i=o._rl[0],c=o._rl[1],n=s.innerRadius,a=(s.radius-n)/(c-i),g=n/a,p=i>c?function(y){return y<=0}:function(y){return y>=0};o.c2g=function(y){var v=o.c2l(y)-i;return(p(v)?v:0)+g},o.g2c=function(y){return o.l2c(y+i-g)},o.g2p=function(y){return y*a},o.c2p=function(y){return o.g2p(o.c2g(y))}}})(e,f);break;case"angularaxis":(function(o,u){var s=o.type;if(s==="linear"){var i=o.d2c,c=o.c2d;o.d2c=function(n,a){return function(g,p){return p==="degrees"?m(g):g}(i(n),a)},o.c2d=function(n,a){return c(function(g,p){return p==="degrees"?h(g):g}(n,a))}}o.makeCalcdata=function(n,a){var g,p,y=n[a],v=n._length,b=function(w){return o.d2c(w,n.thetaunit)};if(y){if(t.isTypedArray(y)&&s==="linear"){if(v===y.length)return y;if(y.subarray)return y.subarray(0,v)}for(g=new Array(v),p=0;p<v;p++)g[p]=b(y[p])}else{var x=a+"0",T="d"+a,A=x in n?b(n[x]):0,S=n[T]?b(n[T]):(o.period||2*Math.PI)/v;for(g=new Array(v),p=0;p<v;p++)g[p]=A+p*S}return g},o.setGeometry=function(){var n,a,g,p,y=u.sector,v=y.map(m),b={clockwise:-1,counterclockwise:1}[o.direction],x=m(o.rotation),T=function(E){return b*E+x},A=function(E){return(E-x)/b};switch(s){case"linear":a=n=t.identity,p=m,g=h,o.range=t.isFullCircle(v)?[y[0],y[0]+360]:v.map(A).map(h);break;case"category":var S=o._categories.length,w=o.period?Math.max(o.period,S):S;w===0&&(w=1),a=p=function(E){return 2*E*Math.PI/w},n=g=function(E){return E*w/Math.PI/2},o.range=[0,w]}o.c2g=function(E){return T(a(E))},o.g2c=function(E){return n(A(E))},o.t2g=function(E){return T(p(E))},o.g2t=function(E){return g(A(E))}}})(e,f)}}},{"../../lib":787,"../cartesian/set_convert":859}],909:[function(r,I,B){var t=r("../lib"),d=r("../plot_api/plot_template"),m=r("./domain").defaults;I.exports=function(h,e,f,l){var o,u,s=l.type,i=l.attributes,c=l.handleDefaults,n=l.partition||"x",a=e._subplots[s],g=a.length,p=g&&a[0].replace(/\d+$/,"");function y(T,A){return t.coerce(o,u,i,T,A)}for(var v=0;v<g;v++){var b=a[v];o=h[b]?h[b]:h[b]={},u=d.newContainer(e,b,p),y("uirevision",e.uirevision);var x={};x[n]=[v/g,(v+1)/g],m(u,e,y,x),l.id=b,c(o,u,y,l)}}},{"../lib":787,"../plot_api/plot_template":827,"./domain":866}],910:[function(r,I,B){var t=r("../constants/docs");t.FORMAT_LINK,t.DATE_FORMAT_LINK;function d(m){var h=m.description?" "+m.description:"",e=m.keys||[];if(e.length>0){for(var f=[],l=0;l<e.length;l++)f[l]="`"+e[l]+"`";h+="Finally, the template string has access to ",h=e.length===1?"variable "+f[0]:"variables "+f.slice(0,-1).join(", ")+" and "+f.slice(-1)+"."}return h}B.hovertemplateAttrs=function(m,h){m=m||{},d(h=h||{});var e={valType:"string",dflt:"",editType:m.editType||"none"};return m.arrayOk!==!1&&(e.arrayOk=!0),e},B.texttemplateAttrs=function(m,h){m=m||{},d(h=h||{});var e={valType:"string",dflt:"",editType:m.editType||"calc"};return m.arrayOk!==!1&&(e.arrayOk=!0),e}},{"../constants/docs":758}],911:[function(r,I,B){var t=r("./ternary"),d=r("../../plots/get_data").getSubplotCalcData,m=r("../../lib").counterRegex;B.name="ternary";var h=B.attr="subplot";B.idRoot="ternary",B.idRegex=B.attrRegex=m("ternary"),(B.attributes={})[h]={valType:"subplotid",dflt:"ternary",editType:"calc"},B.layoutAttributes=r("./layout_attributes"),B.supplyLayoutDefaults=r("./layout_defaults"),B.plot=function(e){for(var f=e._fullLayout,l=e.calcdata,o=f._subplots.ternary,u=0;u<o.length;u++){var s=o[u],i=d(l,"ternary",s),c=f[s]._subplot;c||(c=new t({id:s,graphDiv:e,container:f._ternarylayer.node()},f),f[s]._subplot=c),c.plot(i,f,e._promises)}},B.clean=function(e,f,l,o){for(var u=o._subplots.ternary||[],s=0;s<u.length;s++){var i=u[s],c=o[i]._subplot;!f[i]&&c&&(c.plotContainer.remove(),c.clipDef.remove(),c.clipDefRelative.remove(),c.layers["a-title"].remove(),c.layers["b-title"].remove(),c.layers["c-title"].remove())}}},{"../../lib":787,"../../plots/get_data":875,"./layout_attributes":912,"./layout_defaults":913,"./ternary":914}],912:[function(r,I,B){var t=r("../../components/color/attributes"),d=r("../domain").attributes,m=r("../cartesian/layout_attributes"),h=r("../../plot_api/edit_types").overrideAll,e=r("../../lib/extend").extendFlat,f={title:{text:m.title.text,font:m.title.font},color:m.color,tickmode:m.tickmode,nticks:e({},m.nticks,{dflt:6,min:1}),tick0:m.tick0,dtick:m.dtick,tickvals:m.tickvals,ticktext:m.ticktext,ticks:m.ticks,ticklen:m.ticklen,tickwidth:m.tickwidth,tickcolor:m.tickcolor,showticklabels:m.showticklabels,showtickprefix:m.showtickprefix,tickprefix:m.tickprefix,showticksuffix:m.showticksuffix,ticksuffix:m.ticksuffix,showexponent:m.showexponent,exponentformat:m.exponentformat,minexponent:m.minexponent,separatethousands:m.separatethousands,tickfont:m.tickfont,tickangle:m.tickangle,tickformat:m.tickformat,tickformatstops:m.tickformatstops,hoverformat:m.hoverformat,showline:e({},m.showline,{dflt:!0}),linecolor:m.linecolor,linewidth:m.linewidth,showgrid:e({},m.showgrid,{dflt:!0}),gridcolor:m.gridcolor,gridwidth:m.gridwidth,layer:m.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:m._deprecated.title,titlefont:m._deprecated.titlefont}},l=I.exports=h({domain:d({name:"ternary"}),bgcolor:{valType:"color",dflt:t.background},sum:{valType:"number",dflt:1,min:0},aaxis:f,baxis:f,caxis:f},"plot","from-root");l.uirevision={valType:"any",editType:"none"},l.aaxis.uirevision=l.baxis.uirevision=l.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":649,"../../lib/extend":777,"../../plot_api/edit_types":820,"../cartesian/layout_attributes":853,"../domain":866}],913:[function(r,I,B){var t=r("../../components/color"),d=r("../../plot_api/plot_template"),m=r("../../lib"),h=r("../subplot_defaults"),e=r("../cartesian/tick_label_defaults"),f=r("../cartesian/tick_mark_defaults"),l=r("../cartesian/tick_value_defaults"),o=r("../cartesian/line_grid_defaults"),u=r("./layout_attributes"),s=["aaxis","baxis","caxis"];function i(n,a,g,p){var y,v,b,x=g("bgcolor"),T=g("sum");p.bgColor=t.combine(x,p.paper_bgcolor);for(var A=0;A<s.length;A++)v=n[y=s[A]]||{},(b=d.newContainer(a,y))._name=y,c(v,b,p,a);var S=a.aaxis,w=a.baxis,E=a.caxis;S.min+w.min+E.min>=T&&(S.min=0,w.min=0,E.min=0,n.aaxis&&delete n.aaxis.min,n.baxis&&delete n.baxis.min,n.caxis&&delete n.caxis.min)}function c(n,a,g,p){var y=u[a._name];function v(w,E){return m.coerce(n,a,y,w,E)}v("uirevision",p.uirevision),a.type="linear";var b=v("color"),x=b!==y.color.dflt?b:g.font.color,T=a._name.charAt(0).toUpperCase(),A="Component "+T,S=v("title.text",A);a._hovertitle=S===A?S:T,m.coerceFont(v,"title.font",{family:g.font.family,size:m.bigFont(g.font.size),color:x}),v("min"),l(n,a,v,"linear"),e(n,a,v,"linear",{}),f(n,a,v,{outerTicks:!0}),v("showticklabels")&&(m.coerceFont(v,"tickfont",{family:g.font.family,size:g.font.size,color:x}),v("tickangle"),v("tickformat")),o(n,a,v,{dfltColor:b,bgColor:g.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:y}),v("hoverformat"),v("layer")}I.exports=function(n,a,g){h(n,a,g,{type:"ternary",attributes:u,handleDefaults:i,font:a.font,paper_bgcolor:a.paper_bgcolor})}},{"../../components/color":650,"../../lib":787,"../../plot_api/plot_template":827,"../cartesian/line_grid_defaults":855,"../cartesian/tick_label_defaults":860,"../cartesian/tick_mark_defaults":861,"../cartesian/tick_value_defaults":862,"../subplot_defaults":909,"./layout_attributes":912}],914:[function(r,I,B){var t=r("@plotly/d3"),d=r("tinycolor2"),m=r("../../registry"),h=r("../../lib"),e=h.strTranslate,f=h._,l=r("../../components/color"),o=r("../../components/drawing"),u=r("../cartesian/set_convert"),s=r("../../lib/extend").extendFlat,i=r("../plots"),c=r("../cartesian/axes"),n=r("../../components/dragelement"),a=r("../../components/fx"),g=r("../../components/dragelement/helpers"),p=g.freeMode,y=g.rectMode,v=r("../../components/titles"),b=r("../cartesian/select").prepSelect,x=r("../cartesian/select").selectOnClick,T=r("../cartesian/select").clearSelect,A=r("../cartesian/select").clearSelectionsCache,S=r("../cartesian/constants");function w(G,X){this.id=G.id,this.graphDiv=G.graphDiv,this.init(X),this.makeFramework(X),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}I.exports=w;var E=w.prototype;E.init=function(G){this.container=G._ternarylayer,this.defs=G._defs,this.layoutId=G._uid,this.traceHash={},this.layers={}},E.plot=function(G,X){var K=X[this.id],Z=X._size;this._hasClipOnAxisFalse=!1;for(var H=0;H<G.length;H++)if(G[H][0].trace.cliponaxis===!1){this._hasClipOnAxisFalse=!0;break}this.updateLayers(K),this.adjustLayout(K,Z),i.generalUpdatePerTraceModule(this.graphDiv,this,G,K),this.layers.plotbg.select("path").call(l.fill,K.bgcolor)},E.makeFramework=function(G){var X=this.graphDiv,K=G[this.id],Z=this.clipId="clip"+this.layoutId+this.id,H=this.clipIdRelative="clip-relative"+this.layoutId+this.id;this.clipDef=h.ensureSingleById(G._clips,"clipPath",Z,function(Y){Y.append("path").attr("d","M0,0Z")}),this.clipDefRelative=h.ensureSingleById(G._clips,"clipPath",H,function(Y){Y.append("path").attr("d","M0,0Z")}),this.plotContainer=h.ensureSingle(this.container,"g",this.id),this.updateLayers(K),o.setClipUrl(this.layers.backplot,Z,X),o.setClipUrl(this.layers.grids,Z,X)},E.updateLayers=function(G){var X=this.layers,K=["draglayer","plotbg","backplot","grids"];G.aaxis.layer==="below traces"&&K.push("aaxis","aline"),G.baxis.layer==="below traces"&&K.push("baxis","bline"),G.caxis.layer==="below traces"&&K.push("caxis","cline"),K.push("frontplot"),G.aaxis.layer==="above traces"&&K.push("aaxis","aline"),G.baxis.layer==="above traces"&&K.push("baxis","bline"),G.caxis.layer==="above traces"&&K.push("caxis","cline");var Z=this.plotContainer.selectAll("g.toplevel").data(K,String),H=["agrid","bgrid","cgrid"];Z.enter().append("g").attr("class",function(Y){return"toplevel "+Y}).each(function(Y){var $=t.select(this);X[Y]=$,Y==="frontplot"?$.append("g").classed("scatterlayer",!0):Y==="backplot"?$.append("g").classed("maplayer",!0):Y==="plotbg"?$.append("path").attr("d","M0,0Z"):Y==="aline"||Y==="bline"||Y==="cline"?$.append("path"):Y==="grids"&&H.forEach(function(z){X[z]=$.append("g").classed("grid "+z,!0)})}),Z.order()};var k=Math.sqrt(4/3);E.adjustLayout=function(G,X){var K,Z,H,Y,$,z,j=this,W=G.domain,ee=(W.x[0]+W.x[1])/2,J=(W.y[0]+W.y[1])/2,Q=W.x[1]-W.x[0],te=W.y[1]-W.y[0],ie=Q*X.w,ae=te*X.h,he=G.sum,se=G.aaxis.min,de=G.baxis.min,ue=G.caxis.min;ie>k*ae?H=(Y=ae)*k:Y=(H=ie)/k,$=Q*H/ie,z=te*Y/ae,K=X.l+X.w*ee-H/2,Z=X.t+X.h*(1-J)-Y/2,j.x0=K,j.y0=Z,j.w=H,j.h=Y,j.sum=he,j.xaxis={type:"linear",range:[se+2*ue-he,he-se-2*de],domain:[ee-$/2,ee+$/2],_id:"x"},u(j.xaxis,j.graphDiv._fullLayout),j.xaxis.setScale(),j.xaxis.isPtWithinRange=function(ze){return ze.a>=j.aaxis.range[0]&&ze.a<=j.aaxis.range[1]&&ze.b>=j.baxis.range[1]&&ze.b<=j.baxis.range[0]&&ze.c>=j.caxis.range[1]&&ze.c<=j.caxis.range[0]},j.yaxis={type:"linear",range:[se,he-de-ue],domain:[J-z/2,J+z/2],_id:"y"},u(j.yaxis,j.graphDiv._fullLayout),j.yaxis.setScale(),j.yaxis.isPtWithinRange=function(){return!0};var ve=j.yaxis.domain[0],ke=j.aaxis=s({},G.aaxis,{range:[se,he-de-ue],side:"left",tickangle:(+G.aaxis.tickangle||0)-30,domain:[ve,ve+z*k],anchor:"free",position:0,_id:"y",_length:H});u(ke,j.graphDiv._fullLayout),ke.setScale();var Ee=j.baxis=s({},G.baxis,{range:[he-se-ue,de],side:"bottom",domain:j.xaxis.domain,anchor:"free",position:0,_id:"x",_length:H});u(Ee,j.graphDiv._fullLayout),Ee.setScale();var be=j.caxis=s({},G.caxis,{range:[he-se-de,ue],side:"right",tickangle:(+G.caxis.tickangle||0)+30,domain:[ve,ve+z*k],anchor:"free",position:0,_id:"y",_length:H});u(be,j.graphDiv._fullLayout),be.setScale();var xe="M"+K+","+(Z+Y)+"h"+H+"l-"+H/2+",-"+Y+"Z";j.clipDef.select("path").attr("d",xe),j.layers.plotbg.select("path").attr("d",xe);var ce="M0,"+Y+"h"+H+"l-"+H/2+",-"+Y+"Z";j.clipDefRelative.select("path").attr("d",ce);var ge=e(K,Z);j.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",ge),j.clipDefRelative.select("path").attr("transform",null);var we=e(K-Ee._offset,Z+Y);j.layers.baxis.attr("transform",we),j.layers.bgrid.attr("transform",we);var Me=e(K+H/2,Z)+"rotate(30)"+e(0,-ke._offset);j.layers.aaxis.attr("transform",Me),j.layers.agrid.attr("transform",Me);var Se=e(K+H/2,Z)+"rotate(-30)"+e(0,-be._offset);j.layers.caxis.attr("transform",Se),j.layers.cgrid.attr("transform",Se),j.drawAxes(!0),j.layers.aline.select("path").attr("d",ke.showline?"M"+K+","+(Z+Y)+"l"+H/2+",-"+Y:"M0,0").call(l.stroke,ke.linecolor||"#000").style("stroke-width",(ke.linewidth||0)+"px"),j.layers.bline.select("path").attr("d",Ee.showline?"M"+K+","+(Z+Y)+"h"+H:"M0,0").call(l.stroke,Ee.linecolor||"#000").style("stroke-width",(Ee.linewidth||0)+"px"),j.layers.cline.select("path").attr("d",be.showline?"M"+(K+H/2)+","+Z+"l"+H/2+","+Y:"M0,0").call(l.stroke,be.linecolor||"#000").style("stroke-width",(be.linewidth||0)+"px"),j.graphDiv._context.staticPlot||j.initInteractions(),o.setClipUrl(j.layers.frontplot,j._hasClipOnAxisFalse?null:j.clipId,j.graphDiv)},E.drawAxes=function(G){var X=this.graphDiv,K=this.id.substr(7)+"title",Z=this.layers,H=this.aaxis,Y=this.baxis,$=this.caxis;if(this.drawAx(H),this.drawAx(Y),this.drawAx($),G){var z=Math.max(H.showticklabels?H.tickfont.size/2:0,($.showticklabels?.75*$.tickfont.size:0)+($.ticks==="outside"?.87*$.ticklen:0)),j=(Y.showticklabels?Y.tickfont.size:0)+(Y.ticks==="outside"?Y.ticklen:0)+3;Z["a-title"]=v.draw(X,"a"+K,{propContainer:H,propName:this.id+".aaxis.title",placeholder:f(X,"Click to enter Component A title"),attributes:{x:this.x0+this.w/2,y:this.y0-H.title.font.size/3-z,"text-anchor":"middle"}}),Z["b-title"]=v.draw(X,"b"+K,{propContainer:Y,propName:this.id+".baxis.title",placeholder:f(X,"Click to enter Component B title"),attributes:{x:this.x0-j,y:this.y0+this.h+.83*Y.title.font.size+j,"text-anchor":"middle"}}),Z["c-title"]=v.draw(X,"c"+K,{propContainer:$,propName:this.id+".caxis.title",placeholder:f(X,"Click to enter Component C title"),attributes:{x:this.x0+this.w+j,y:this.y0+this.h+.83*$.title.font.size+j,"text-anchor":"middle"}})}},E.drawAx=function(G){var X,K=this.graphDiv,Z=G._name,H=Z.charAt(0),Y=G._id,$=this.layers[Z],z=H+"tickLayout",j=(X=G).ticks+String(X.ticklen)+String(X.showticklabels);this[z]!==j&&($.selectAll("."+Y+"tick").remove(),this[z]=j),G.setScale();var W=c.calcTicks(G),ee=c.clipEnds(G,W),J=c.makeTransTickFn(G),Q=c.getTickSigns(G)[2],te=h.deg2rad(30),ie=Q*(G.linewidth||1)/2,ae=Q*G.ticklen,he=this.w,se=this.h,de=H==="b"?"M0,"+ie+"l"+Math.sin(te)*ae+","+Math.cos(te)*ae:"M"+ie+",0l"+Math.cos(te)*ae+","+-Math.sin(te)*ae,ue={a:"M0,0l"+se+",-"+he/2,b:"M0,0l-"+he/2+",-"+se,c:"M0,0l-"+se+","+he/2}[H];c.drawTicks(K,G,{vals:G.ticks==="inside"?ee:W,layer:$,path:de,transFn:J,crisp:!1}),c.drawGrid(K,G,{vals:ee,layer:this.layers[H+"grid"],path:ue,transFn:J,crisp:!1}),c.drawLabels(K,G,{vals:W,layer:$,transFn:J,labelFns:c.makeLabelFns(G,0,30)})};var L=S.MINZOOM/2+.87,M="m-0.87,.5h"+L+"v3h-"+(L+5.2)+"l"+(L/2+2.6)+",-"+(.87*L+4.5)+"l2.6,1.5l-"+L/2+","+.87*L+"Z",P="m0.87,.5h-"+L+"v3h"+(L+5.2)+"l-"+(L/2+2.6)+",-"+(.87*L+4.5)+"l-2.6,1.5l"+L/2+","+.87*L+"Z",D="m0,1l"+L/2+","+.87*L+"l2.6,-1.5l-"+(L/2+2.6)+",-"+(.87*L+4.5)+"l-"+(L/2+2.6)+","+(.87*L+4.5)+"l2.6,1.5l"+L/2+",-"+.87*L+"Z",N=!0;function U(G){t.select(G).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}E.clearSelect=function(){A(this.dragOptions),T(this.dragOptions.gd)},E.initInteractions=function(){var G,X,K,Z,H,Y,$,z,j,W,ee,J,Q=this,te=Q.layers.plotbg.select("path").node(),ie=Q.graphDiv,ae=ie._fullLayout._zoomlayer;function he(ce){var ge={};return ge[Q.id+".aaxis.min"]=ce.a,ge[Q.id+".baxis.min"]=ce.b,ge[Q.id+".caxis.min"]=ce.c,ge}function se(ce,ge){var we=ie._fullLayout.clickmode;U(ie),ce===2&&(ie.emit("plotly_doubleclick",null),m.call("_guiRelayout",ie,he({a:0,b:0,c:0}))),we.indexOf("select")>-1&&ce===1&&x(ge,ie,[Q.xaxis],[Q.yaxis],Q.id,Q.dragOptions),we.indexOf("event")>-1&&a.click(ie,ge,Q.id)}function de(ce,ge){return 1-ge/Q.h}function ue(ce,ge){return 1-(ce+(Q.h-ge)/Math.sqrt(3))/Q.w}function ve(ce,ge){return(ce-(Q.h-ge)/Math.sqrt(3))/Q.w}function ke(ce,ge){var we=K+ce*G,Me=Z+ge*X,Se=Math.max(0,Math.min(1,de(0,Z),de(0,Me))),ze=Math.max(0,Math.min(1,ue(K,Z),ue(we,Me))),Fe=Math.max(0,Math.min(1,ve(K,Z),ve(we,Me))),Ye=(Se/2+Fe)*Q.w,rt=(1-Se/2-ze)*Q.w,Oe=(Ye+rt)/2,je=rt-Ye,We=(1-Se)*Q.h,qe=We-je/k;je<S.MINZOOM?($=H,ee.attr("d",j),J.attr("d","M0,0Z")):($={a:H.a+Se*Y,b:H.b+ze*Y,c:H.c+Fe*Y},ee.attr("d",j+"M"+Ye+","+We+"H"+rt+"L"+Oe+","+qe+"L"+Ye+","+We+"Z"),J.attr("d","M"+K+","+Z+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2ZM"+Ye+","+We+M+"M"+rt+","+We+P+"M"+Oe+","+qe+D)),W||(ee.transition().style("fill",z>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),J.transition().style("opacity",1).duration(200),W=!0),ie.emit("plotly_relayouting",he($))}function Ee(){U(ie),$!==H&&(m.call("_guiRelayout",ie,he($)),N&&ie.data&&ie._context.showTips&&(h.notifier(f(ie,"Double-click to zoom back out"),"long"),N=!1))}function be(ce,ge){var we=ce/Q.xaxis._m,Me=ge/Q.yaxis._m,Se=[($={a:H.a-Me,b:H.b+(we+Me)/2,c:H.c-(we-Me)/2}).a,$.b,$.c].sort(h.sorterAsc),ze=Se.indexOf($.a),Fe=Se.indexOf($.b),Ye=Se.indexOf($.c);Se[0]<0&&(Se[1]+Se[0]/2<0?(Se[2]+=Se[0]+Se[1],Se[0]=Se[1]=0):(Se[2]+=Se[0]/2,Se[1]+=Se[0]/2,Se[0]=0),$={a:Se[ze],b:Se[Fe],c:Se[Ye]},ge=(H.a-$.a)*Q.yaxis._m,ce=(H.c-$.c-H.b+$.b)*Q.xaxis._m);var rt=e(Q.x0+ce,Q.y0+ge);Q.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",rt);var Oe=e(-ce,-ge);Q.clipDefRelative.select("path").attr("transform",Oe),Q.aaxis.range=[$.a,Q.sum-$.b-$.c],Q.baxis.range=[Q.sum-$.a-$.c,$.b],Q.caxis.range=[Q.sum-$.a-$.b,$.c],Q.drawAxes(!1),Q._hasClipOnAxisFalse&&Q.plotContainer.select(".scatterlayer").selectAll(".trace").call(o.hideOutsideRangePoints,Q),ie.emit("plotly_relayouting",he($))}function xe(){m.call("_guiRelayout",ie,he($))}this.dragOptions={element:te,gd:ie,plotinfo:{id:Q.id,domain:ie._fullLayout[Q.id].domain,xaxis:Q.xaxis,yaxis:Q.yaxis},subplot:Q.id,prepFn:function(ce,ge,we){Q.dragOptions.xaxes=[Q.xaxis],Q.dragOptions.yaxes=[Q.yaxis],G=ie._fullLayout._invScaleX,X=ie._fullLayout._invScaleY;var Me=Q.dragOptions.dragmode=ie._fullLayout.dragmode;p(Me)?Q.dragOptions.minDrag=1:Q.dragOptions.minDrag=void 0,Me==="zoom"?(Q.dragOptions.moveFn=ke,Q.dragOptions.clickFn=se,Q.dragOptions.doneFn=Ee,function(Se,ze,Fe){var Ye=te.getBoundingClientRect();K=ze-Ye.left,Z=Fe-Ye.top,ie._fullLayout._calcInverseTransform(ie);var rt=ie._fullLayout._invTransform,Oe=h.apply3DTransform(rt)(K,Z);K=Oe[0],Z=Oe[1],H={a:Q.aaxis.range[0],b:Q.baxis.range[1],c:Q.caxis.range[1]},$=H,Y=Q.aaxis.range[1]-H.a,z=d(Q.graphDiv._fullLayout[Q.id].bgcolor).getLuminance(),j="M0,"+Q.h+"L"+Q.w/2+", 0L"+Q.w+","+Q.h+"Z",W=!1,ee=ae.append("path").attr("class","zoombox").attr("transform",e(Q.x0,Q.y0)).style({fill:z>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",j),J=ae.append("path").attr("class","zoombox-corners").attr("transform",e(Q.x0,Q.y0)).style({fill:l.background,stroke:l.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),Q.clearSelect(ie)}(0,ge,we)):Me==="pan"?(Q.dragOptions.moveFn=be,Q.dragOptions.clickFn=se,Q.dragOptions.doneFn=xe,H={a:Q.aaxis.range[0],b:Q.baxis.range[1],c:Q.caxis.range[1]},$=H,Q.clearSelect(ie)):(y(Me)||p(Me))&&b(ce,ge,we,Q.dragOptions,Me)}},te.onmousemove=function(ce){a.hover(ie,ce,Q.id),ie._fullLayout._lasthover=te,ie._fullLayout._hoversubplot=Q.id},te.onmouseout=function(ce){ie._dragging||n.unhover(ie,ce)},n.init(this.dragOptions)}},{"../../components/color":650,"../../components/dragelement":669,"../../components/dragelement/helpers":668,"../../components/drawing":672,"../../components/fx":690,"../../components/titles":748,"../../lib":787,"../../lib/extend":777,"../../registry":915,"../cartesian/axes":838,"../cartesian/constants":845,"../cartesian/select":858,"../cartesian/set_convert":859,"../plots":901,"@plotly/d3":58,tinycolor2:583}],915:[function(r,I,B){var t=r("./lib/loggers"),d=r("./lib/noop"),m=r("./lib/push_unique"),h=r("./lib/is_plain_object"),e=r("./lib/dom").addStyleRule,f=r("./lib/extend"),l=r("./plots/attributes"),o=r("./plots/layout_attributes"),u=f.extendFlat,s=f.extendDeepAll;function i(x){var T=x.name,A=x.categories,S=x.meta;if(B.modules[T])t.log("Type "+T+" already registered");else{B.subplotsRegistry[x.basePlotModule.name]||function(N){var U=N.name;if(B.subplotsRegistry[U])return void t.log("Plot type "+U+" already registered.");for(var G in g(N),B.subplotsRegistry[U]=N,B.componentsRegistry)v(G,N.name)}(x.basePlotModule);for(var w={},E=0;E<A.length;E++)w[A[E]]=!0,B.allCategories[A[E]]=!0;for(var k in B.modules[T]={_module:x,categories:w},S&&Object.keys(S).length&&(B.modules[T].meta=S),B.allTypes.push(T),B.componentsRegistry)p(k,T);x.layoutAttributes&&u(B.traceLayoutAttributes,x.layoutAttributes);var L=x.basePlotModule,M=L.name;if(M==="mapbox"){var P=L.constants.styleRules;for(var D in P)e(".js-plotly-plot .plotly .mapboxgl-"+D,P[D])}M!=="geo"&&M!=="mapbox"||typeof window===void 0||window.PlotlyGeoAssets!==void 0||(window.PlotlyGeoAssets={topojson:{}})}}function c(x){if(typeof x.name!="string")throw new Error("Component module *name* must be a string.");var T=x.name;for(var A in B.componentsRegistry[T]=x,x.layoutAttributes&&(x.layoutAttributes._isLinkedToArray&&m(B.layoutArrayContainers,T),g(x)),B.modules)p(T,A);for(var S in B.subplotsRegistry)v(T,S);for(var w in B.transformsRegistry)y(T,w);x.schema&&x.schema.layout&&s(o,x.schema.layout)}function n(x){if(typeof x.name!="string")throw new Error("Transform module *name* must be a string.");var T="Transform module "+x.name,A=typeof x.transform=="function",S=typeof x.calcTransform=="function";if(!A&&!S)throw new Error(T+" is missing a *transform* or *calcTransform* method.");for(var w in A&&S&&t.log([T+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),h(x.attributes)||t.log(T+" registered without an *attributes* object."),typeof x.supplyDefaults!="function"&&t.log(T+" registered without a *supplyDefaults* method."),B.transformsRegistry[x.name]=x,B.componentsRegistry)y(w,x.name)}function a(x){var T=x.name,A=T.split("-")[0],S=x.dictionary,w=x.format,E=S&&Object.keys(S).length,k=w&&Object.keys(w).length,L=B.localeRegistry,M=L[T];if(M||(L[T]=M={}),A!==T){var P=L[A];P||(L[A]=P={}),E&&P.dictionary===M.dictionary&&(P.dictionary=S),k&&P.format===M.format&&(P.format=w)}E&&(M.dictionary=S),k&&(M.format=w)}function g(x){if(x.layoutAttributes){var T=x.layoutAttributes._arrayAttrRegexps;if(T)for(var A=0;A<T.length;A++)m(B.layoutArrayRegexes,T[A])}}function p(x,T){var A=B.componentsRegistry[x].schema;if(A&&A.traces){var S=A.traces[T];S&&s(B.modules[T]._module.attributes,S)}}function y(x,T){var A=B.componentsRegistry[x].schema;if(A&&A.transforms){var S=A.transforms[T];S&&s(B.transformsRegistry[T].attributes,S)}}function v(x,T){var A=B.componentsRegistry[x].schema;if(A&&A.subplots){var S=B.subplotsRegistry[T],w=S.layoutAttributes,E=S.attr==="subplot"?S.name:S.attr;Array.isArray(E)&&(E=E[0]);var k=A.subplots[E];w&&k&&s(w,k)}}function b(x){return typeof x=="object"&&(x=x.type),x}B.modules={},B.allCategories={},B.allTypes=[],B.subplotsRegistry={},B.transformsRegistry={},B.componentsRegistry={},B.layoutArrayContainers=[],B.layoutArrayRegexes=[],B.traceLayoutAttributes={},B.localeRegistry={},B.apiMethodRegistry={},B.collectableSubplotTypes=null,B.register=function(x){if(B.collectableSubplotTypes=null,!x)throw new Error("No argument passed to Plotly.register.");x&&!Array.isArray(x)&&(x=[x]);for(var T=0;T<x.length;T++){var A=x[T];if(!A)throw new Error("Invalid module was attempted to be registered!");switch(A.moduleType){case"trace":i(A);break;case"transform":n(A);break;case"component":c(A);break;case"locale":a(A);break;case"apiMethod":var S=A.name;B.apiMethodRegistry[S]=A.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},B.getModule=function(x){var T=B.modules[b(x)];return!!T&&T._module},B.traceIs=function(x,T){if((x=b(x))==="various")return!1;var A=B.modules[x];return A||(x&&t.log("Unrecognized trace type "+x+"."),A=B.modules[l.type.dflt]),!!A.categories[T]},B.getTransformIndices=function(x,T){for(var A=[],S=x.transforms||[],w=0;w<S.length;w++)S[w].type===T&&A.push(w);return A},B.hasTransform=function(x,T){for(var A=x.transforms||[],S=0;S<A.length;S++)if(A[S].type===T)return!0;return!1},B.getComponentMethod=function(x,T){var A=B.componentsRegistry[x];return A&&A[T]||d},B.call=function(){var x=arguments[0],T=[].slice.call(arguments,1);return B.apiMethodRegistry[x].apply(null,T)}},{"./lib/dom":775,"./lib/extend":777,"./lib/is_plain_object":788,"./lib/loggers":791,"./lib/noop":796,"./lib/push_unique":802,"./plots/attributes":834,"./plots/layout_attributes":892}],916:[function(r,I,B){var t=r("../registry"),d=r("../lib"),m=d.extendFlat,h=d.extendDeep;function e(f){var l;switch(f){case"themes__thumb":l={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":l={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:l={}}return l}I.exports=function(f,l){var o,u,s=f.data,i=f.layout,c=h([],s),n=h({},i,e(l.tileClass)),a=f._context||{};if(l.width&&(n.width=l.width),l.height&&(n.height=l.height),l.tileClass==="thumbnail"||l.tileClass==="themes__thumb"){n.annotations=[];var g=Object.keys(n);for(o=0;o<g.length;o++)u=g[o],["xaxis","yaxis","zaxis"].indexOf(u.slice(0,5))>-1&&(n[g[o]].title={text:""});for(o=0;o<c.length;o++){var p=c[o];p.showscale=!1,p.marker&&(p.marker.showscale=!1),t.traceIs(p,"pie-like")&&(p.textposition="none")}}if(Array.isArray(l.annotations))for(o=0;o<l.annotations.length;o++)n.annotations.push(l.annotations[o]);var y=Object.keys(n).filter(function(A){return A.match(/^scene\d*$/)});if(y.length){var v={};for(l.tileClass==="thumbnail"&&(v={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),o=0;o<y.length;o++){var b=n[y[o]];b.xaxis||(b.xaxis={}),b.yaxis||(b.yaxis={}),b.zaxis||(b.zaxis={}),m(b.xaxis,v),m(b.yaxis,v),m(b.zaxis,v),b._scene=null}}var x=document.createElement("div");l.tileClass&&(x.className=l.tileClass);var T={gd:x,td:x,layout:n,data:c,config:{staticPlot:l.staticPlot===void 0||l.staticPlot,plotGlPixelRatio:l.plotGlPixelRatio===void 0?2:l.plotGlPixelRatio,displaylogo:l.displaylogo||!1,showLink:l.showLink||!1,showTips:l.showTips||!1,mapboxAccessToken:a.mapboxAccessToken}};return l.setBackground!=="transparent"&&(T.config.setBackground=l.setBackground||"opaque"),T.gd.defaultLayout=e(l.tileClass),T}},{"../lib":787,"../registry":915}],917:[function(r,I,B){var t=r("../lib"),d=r("../plot_api/to_image"),m=r("./filesaver"),h=r("./helpers");I.exports=function(e,f){var l;return t.isPlainObject(e)||(l=t.getGraphDiv(e)),(f=f||{}).format=f.format||"png",f.width=f.width||null,f.height=f.height||null,f.imageDataOnly=!0,new Promise(function(o,u){l&&l._snapshotInProgress&&u(new Error("Snapshotting already in progress.")),t.isIE()&&f.format!=="svg"&&u(new Error(h.MSG_IE_BAD_FORMAT)),l&&(l._snapshotInProgress=!0);var s=d(e,f),i=f.filename||e.fn||"newplot";i+="."+f.format.replace("-","."),s.then(function(c){return l&&(l._snapshotInProgress=!1),m(c,i,f.format)}).then(function(c){o(c)}).catch(function(c){l&&(l._snapshotInProgress=!1),u(c)})})}},{"../lib":787,"../plot_api/to_image":830,"./filesaver":918,"./helpers":919}],918:[function(r,I,B){var t=r("../lib"),d=r("./helpers");I.exports=function(m,h,e){var f=document.createElement("a"),l="download"in f;return new Promise(function(o,u){var s,i;if(t.isIE())return s=d.createBlob(m,"svg"),window.navigator.msSaveBlob(s,h),s=null,o(h);if(l)return s=d.createBlob(m,e),i=d.createObjectURL(s),f.href=i,f.download=h,document.body.appendChild(f),f.click(),document.body.removeChild(f),d.revokeObjectURL(i),s=null,o(h);if(t.isSafari()){var c=e==="svg"?",":";base64,";return d.octetStream(c+encodeURIComponent(m)),o(h)}u(new Error("download error"))})}},{"../lib":787,"./helpers":919}],919:[function(r,I,B){var t=r("../registry");B.getDelay=function(m){return m._has&&(m._has("gl3d")||m._has("gl2d")||m._has("mapbox"))?500:0},B.getRedrawFunc=function(m){return function(){t.getComponentMethod("colorbar","draw")(m)}},B.encodeSVG=function(m){return"data:image/svg+xml,"+encodeURIComponent(m)},B.encodeJSON=function(m){return"data:application/json,"+encodeURIComponent(m)};var d=window.URL||window.webkitURL;B.createObjectURL=function(m){return d.createObjectURL(m)},B.revokeObjectURL=function(m){return d.revokeObjectURL(m)},B.createBlob=function(m,h){if(h==="svg")return new window.Blob([m],{type:"image/svg+xml;charset=utf-8"});if(h==="full-json")return new window.Blob([m],{type:"application/json;charset=utf-8"});var e=function(f){for(var l=f.length,o=new ArrayBuffer(l),u=new Uint8Array(o),s=0;s<l;s++)u[s]=f.charCodeAt(s);return o}(window.atob(m));return new window.Blob([e],{type:"image/"+h})},B.octetStream=function(m){document.location.href="data:application/octet-stream"+m},B.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,B.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":915}],920:[function(r,I,B){var t=r("./helpers"),d={getDelay:t.getDelay,getRedrawFunc:t.getRedrawFunc,clone:r("./cloneplot"),toSVG:r("./tosvg"),svgToImg:r("./svgtoimg"),toImage:r("./toimage"),downloadImage:r("./download")};I.exports=d},{"./cloneplot":916,"./download":917,"./helpers":919,"./svgtoimg":921,"./toimage":922,"./tosvg":923}],921:[function(r,I,B){var t=r("../lib"),d=r("events").EventEmitter,m=r("./helpers");I.exports=function(h){var e=h.emitter||new d,f=new Promise(function(l,o){var u=window.Image,s=h.svg,i=h.format||"png";if(t.isIE()&&i!=="svg"){var c=new Error(m.MSG_IE_BAD_FORMAT);return o(c),h.promise?f:e.emit("error",c)}var n,a,g=h.canvas,p=h.scale||1,y=h.width||300,v=h.height||150,b=p*y,x=p*v,T=g.getContext("2d"),A=new u;i==="svg"||t.isSafari()?a=m.encodeSVG(s):(n=m.createBlob(s,"svg"),a=m.createObjectURL(n)),g.width=b,g.height=x,A.onload=function(){var S;switch(n=null,m.revokeObjectURL(a),i!=="svg"&&T.drawImage(A,0,0,b,x),i){case"jpeg":S=g.toDataURL("image/jpeg");break;case"png":S=g.toDataURL("image/png");break;case"webp":S=g.toDataURL("image/webp");break;case"svg":S=a;break;default:var w="Image format is not jpeg, png, svg or webp.";if(o(new Error(w)),!h.promise)return e.emit("error",w)}l(S),h.promise||e.emit("success",S)},A.onerror=function(S){if(n=null,m.revokeObjectURL(a),o(S),!h.promise)return e.emit("error",S)},A.src=a});return h.promise?f:e}},{"../lib":787,"./helpers":919,events:116}],922:[function(r,I,B){var t=r("events").EventEmitter,d=r("../registry"),m=r("../lib"),h=r("./helpers"),e=r("./cloneplot"),f=r("./tosvg"),l=r("./svgtoimg");I.exports=function(o,u){var s=new t,i=e(o,{format:"png"}),c=i.gd;c.style.position="absolute",c.style.left="-5000px",document.body.appendChild(c);var n=h.getRedrawFunc(c);return d.call("_doPlot",c,i.data,i.layout,i.config).then(n).then(function(){var a=h.getDelay(c._fullLayout);setTimeout(function(){var g=f(c),p=document.createElement("canvas");p.id=m.randstr(),(s=l({format:u.format,width:c._fullLayout.width,height:c._fullLayout.height,canvas:p,emitter:s,svg:g})).clean=function(){c&&document.body.removeChild(c)}},a)}).catch(function(a){s.emit("error",a)}),s}},{"../lib":787,"../registry":915,"./cloneplot":916,"./helpers":919,"./svgtoimg":921,"./tosvg":923,events:116}],923:[function(r,I,B){var t=r("@plotly/d3"),d=r("../lib"),m=r("../components/drawing"),h=r("../components/color"),e=r("../constants/xmlns_namespaces"),f=/"/g,l=new RegExp('("TOBESTRIPPED)|(TOBESTRIPPED")',"g");I.exports=function(o,u,s){var i,c,n=o._fullLayout,a=n._paper,g=n._toppaper,p=n.width,y=n.height;a.insert("rect",":first-child").call(m.setRect,0,0,p,y).call(h.fill,n.paper_bgcolor);var v=n._basePlotModules||[];for(i=0;i<v.length;i++){var b=v[i];b.toSVG&&b.toSVG(o)}if(g){var x=g.node().childNodes,T=Array.prototype.slice.call(x);for(i=0;i<T.length;i++){var A=T[i];A.childNodes.length&&a.node().appendChild(A)}}n._draggers&&n._draggers.remove(),a.node().style.background="",a.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var E=t.select(this);if(this.style.visibility!=="hidden"&&this.style.display!=="none"){E.style({visibility:null,display:null});var k=this.style.fontFamily;k&&k.indexOf('"')!==-1&&E.style("font-family",k.replace(f,"TOBESTRIPPED"))}else E.remove()});var S=[];if(n._gradientUrlQueryParts)for(c in n._gradientUrlQueryParts)S.push(c);if(n._patternUrlQueryParts)for(c in n._patternUrlQueryParts)S.push(c);S.length&&a.selectAll(S.join(",")).each(function(){var E=t.select(this),k=this.style.fill;k&&k.indexOf("url(")!==-1&&E.style("fill",k.replace(f,"TOBESTRIPPED"));var L=this.style.stroke;L&&L.indexOf("url(")!==-1&&E.style("stroke",L.replace(f,"TOBESTRIPPED"))}),u!=="pdf"&&u!=="eps"||a.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),a.node().setAttributeNS(e.xmlns,"xmlns",e.svg),a.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),u==="svg"&&s&&(a.attr("width",s*p),a.attr("height",s*y),a.attr("viewBox","0 0 "+p+" "+y));var w=new window.XMLSerializer().serializeToString(a.node());return w=function(E){var k=t.select("body").append("div").style({display:"none"}).html(""),L=E.replace(/(&[^;]*;)/gi,function(M){return M==="&lt;"?"&#60;":M==="&rt;"?"&#62;":M.indexOf("<")!==-1||M.indexOf(">")!==-1?"":k.html(M).text()});return k.remove(),L}(w),w=(w=w.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")).replace(l,"'"),d.isIE()&&(w=(w=(w=w.replace(/"/gi,"'")).replace(/(\('#)([^']*)('\))/gi,'("#$2")')).replace(/(\\')/gi,'"')),w}},{"../components/color":650,"../components/drawing":672,"../constants/xmlns_namespaces":764,"../lib":787,"@plotly/d3":58}],924:[function(r,I,B){var t=r("../../lib");I.exports=function(d,m){for(var h=0;h<d.length;h++)d[h].i=h;t.mergeArray(m.text,d,"tx"),t.mergeArray(m.hovertext,d,"htx");var e=m.marker;if(e){t.mergeArray(e.opacity,d,"mo",!0),t.mergeArray(e.color,d,"mc");var f=e.line;f&&(t.mergeArray(f.color,d,"mlc"),t.mergeArrayCastPositive(f.width,d,"mlw"))}}},{"../../lib":787}],925:[function(r,I,B){var t=r("../scatter/attributes"),d=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=r("../../plots/template_attributes").hovertemplateAttrs,h=r("../../plots/template_attributes").texttemplateAttrs,e=r("../../components/colorscale/attributes"),f=r("../../plots/font_attributes"),l=r("./constants"),o=r("../../components/drawing/attributes").pattern,u=r("../../lib/extend").extendFlat,s=f({editType:"calc",arrayOk:!0,colorEditType:"style"}),i=u({},t.marker.line.width,{dflt:0}),c=u({width:i,editType:"calc"},e("marker.line")),n=u({line:c,editType:"calc"},e("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:o});I.exports={x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,xhoverformat:d("x"),yhoverformat:d("y"),text:t.text,texttemplate:h({editType:"plot"},{keys:l.eventDataKeys}),hovertext:t.hovertext,hovertemplate:m({},{keys:l.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:u({},s,{}),insidetextfont:u({},s,{}),outsidetextfont:u({},s,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:u({},t.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:n,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:t.selected.marker.opacity,color:t.selected.marker.color,editType:"style"},textfont:t.selected.textfont,editType:"style"},unselected:{marker:{opacity:t.unselected.marker.opacity,color:t.unselected.marker.color,editType:"style"},textfont:t.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":657,"../../components/drawing/attributes":671,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/font_attributes":867,"../../plots/template_attributes":910,"../scatter/attributes":1202,"./constants":927}],926:[function(r,I,B){var t=r("../../plots/cartesian/axes"),d=r("../../plots/cartesian/align_period"),m=r("../../components/colorscale/helpers").hasColorscale,h=r("../../components/colorscale/calc"),e=r("./arrays_to_calcdata"),f=r("../scatter/calc_selection");I.exports=function(l,o){var u,s,i,c,n,a,g=t.getFromId(l,o.xaxis||"x"),p=t.getFromId(l,o.yaxis||"y"),y={msUTC:!(!o.base&&o.base!==0)};o.orientation==="h"?(u=g.makeCalcdata(o,"x",y),i=p.makeCalcdata(o,"y"),c=d(o,p,"y",i),n=!!o.yperiodalignment,a="y"):(u=p.makeCalcdata(o,"y",y),i=g.makeCalcdata(o,"x"),c=d(o,g,"x",i),n=!!o.xperiodalignment,a="x"),s=c.vals;for(var v=Math.min(s.length,u.length),b=new Array(v),x=0;x<v;x++)b[x]={p:s[x],s:u[x]},n&&(b[x].orig_p=i[x],b[x][a+"End"]=c.ends[x],b[x][a+"Start"]=c.starts[x]),o.ids&&(b[x].id=String(o.ids[x]));return m(o,"marker")&&h(l,o,{vals:o.marker.color,containerStr:"marker",cLetter:"c"}),m(o,"marker.line")&&h(l,o,{vals:o.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(b,o),f(b,o),b}},{"../../components/colorscale/calc":658,"../../components/colorscale/helpers":661,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../scatter/calc_selection":1204,"./arrays_to_calcdata":924}],927:[function(r,I,B){I.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],928:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib").isArrayOrTypedArray,m=r("../../constants/numerical").BADNUM,h=r("../../registry"),e=r("../../plots/cartesian/axes"),f=r("../../plots/cartesian/constraints").getAxisGroup,l=r("./sieve.js");function o(v,b,x,T,A){if(T.length){var S,w,E,k;switch(function(L,M){var P,D;for(P=0;P<M.length;P++){var N,U=M[P],G=U[0].trace,X=G.type==="funnel"?G._base:G.base,K=G.orientation==="h"?G.xcalendar:G.ycalendar,Z=L.type==="category"||L.type==="multicategory"?function(){return null}:L.d2c;if(d(X)){for(D=0;D<Math.min(X.length,U.length);D++)N=Z(X[D],0,K),t(N)?(U[D].b=+N,U[D].hasB=1):U[D].b=0;for(;D<U.length;D++)U[D].b=0}else{N=Z(X,0,K);var H=t(N);for(N=H?N:0,D=0;D<U.length;D++)U[D].b=N,H&&(U[D].hasB=1)}}}(x,T),A.mode){case"overlay":u(b,x,T,A);break;case"group":for(S=[],w=[],E=0;E<T.length;E++)(k=T[E])[0].trace.offset===void 0?w.push(k):S.push(k);w.length&&function(L,M,P,D,N){var U=new l(D,{posAxis:M,sepNegVal:!1,overlapNoMerge:!N.norm});(function(G,X,K,Z){for(var H=G._fullLayout,Y=K.positions,$=K.distinctPositions,z=K.minDiff,j=K.traces,W=j.length,ee=Y.length!==$.length,J=z*(1-Z.gap),Q=f(H,X._id)+j[0][0].trace.orientation,te=H._alignmentOpts[Q]||{},ie=0;ie<W;ie++){var ae,he,se=j[ie],de=se[0].trace,ue=te[de.alignmentgroup]||{},ve=Object.keys(ue.offsetGroups||{}).length,ke=(ae=ve?J/ve:ee?J/W:J)*(1-(Z.groupgap||0));he=ve?((2*de._offsetIndex+1-ve)*ae-ke)/2:ee?((2*ie+1-W)*ae-ke)/2:-ke/2;var Ee=se[0].t;Ee.barwidth=ke,Ee.poffset=he,Ee.bargroupwidth=J,Ee.bardelta=z}K.binWidth=j[0][0].t.barwidth/100,i(K),c(X,K),n(X,K,ee)})(L,M,U,N),function(G,X){for(var K=G.traces,Z=0;Z<K.length;Z++){var H=K[Z];if(H[0].trace.base===void 0)for(var Y=new l([H],{posAxis:X,sepNegVal:!0,overlapNoMerge:!0}),$=0;$<H.length;$++){var z=H[$];if(z.p!==m){var j=Y.put(z.p,z.b+z.s);j&&(z.b=j)}}}}(U,M),N.norm?(g(U),p(P,U,N)):a(P,U)}(v,b,x,w,A),S.length&&u(b,x,S,A);break;case"stack":case"relative":for(S=[],w=[],E=0;E<T.length;E++)(k=T[E])[0].trace.base===void 0?w.push(k):S.push(k);w.length&&function(L,M,P,D,N){var U=new l(D,{posAxis:M,sepNegVal:N.mode==="relative",overlapNoMerge:!(N.norm||N.mode==="stack"||N.mode==="relative")});s(M,U,N),function(H,Y,$){var z,j,W,ee,J,Q,te=y(H),ie=Y.traces;for(ee=0;ee<ie.length;ee++)if(z=ie[ee],(j=z[0].trace).type==="funnel")for(J=0;J<z.length;J++)(Q=z[J]).s!==m&&Y.put(Q.p,-.5*Q.s);for(ee=0;ee<ie.length;ee++){z=ie[ee],j=z[0].trace,W=j.type==="funnel";var ae=[];for(J=0;J<z.length;J++)if((Q=z[J]).s!==m){var he;he=W?Q.s:Q.s+Q.b;var se=Y.put(Q.p,he),de=se+he;Q.b=se,Q[te]=de,$.norm||(ae.push(de),Q.hasB&&ae.push(se))}$.norm||(j._extremes[H._id]=e.findExtremes(H,ae,{tozero:!0,padded:!0}))}}(P,U,N);for(var G=0;G<D.length;G++)for(var X=D[G],K=0;K<X.length;K++){var Z=X[K];Z.s!==m&&Z.b+Z.s===U.get(Z.p,Z.s)&&(Z._outmost=!0)}N.norm&&p(P,U,N)}(0,b,x,w,A),S.length&&u(b,x,S,A)}(function(L,M){var P,D,N,U=y(M),G={},X=1/0,K=-1/0;for(P=0;P<L.length;P++)for(N=L[P],D=0;D<N.length;D++){var Z=N[D].p;t(Z)&&(X=Math.min(X,Z),K=Math.max(K,Z))}var H=1e4/(K-X),Y=G.round=function(Q){return String(Math.round(H*(Q-X)))};for(P=0;P<L.length;P++){(N=L[P])[0].t.extents=G;var $=N[0].t.poffset,z=Array.isArray($);for(D=0;D<N.length;D++){var j=N[D],W=j[U]-j.w/2;if(t(W)){var ee=j[U]+j.w/2,J=Y(j.p);G[J]?G[J]=[Math.min(W,G[J][0]),Math.max(ee,G[J][1])]:G[J]=[W,ee]}j.p0=j.p+(z?$[D]:$),j.p1=j.p0+j.w,j.s0=j.b,j.s1=j.s0+j.s}}})(T,b)}}function u(v,b,x,T){for(var A=0;A<x.length;A++){var S=x[A],w=new l([S],{posAxis:v,sepNegVal:!1,overlapNoMerge:!T.norm});s(v,w,T),T.norm?(g(w),p(b,w,T)):a(b,w)}}function s(v,b,x){for(var T=b.minDiff,A=b.traces,S=T*(1-x.gap),w=S*(1-(x.groupgap||0)),E=-w/2,k=0;k<A.length;k++){var L=A[k][0].t;L.barwidth=w,L.poffset=E,L.bargroupwidth=S,L.bardelta=T}b.binWidth=A[0][0].t.barwidth/100,i(b),c(v,b),n(v,b)}function i(v){var b,x,T=v.traces;for(b=0;b<T.length;b++){var A,S=T[b],w=S[0],E=w.trace,k=w.t,L=E._offset||E.offset,M=k.poffset;if(d(L)){for(A=Array.prototype.slice.call(L,0,S.length),x=0;x<A.length;x++)t(A[x])||(A[x]=M);for(x=A.length;x<S.length;x++)A.push(M);k.poffset=A}else L!==void 0&&(k.poffset=L);var P=E._width||E.width,D=k.barwidth;if(d(P)){var N=Array.prototype.slice.call(P,0,S.length);for(x=0;x<N.length;x++)t(N[x])||(N[x]=D);for(x=N.length;x<S.length;x++)N.push(D);if(k.barwidth=N,L===void 0){for(A=[],x=0;x<S.length;x++)A.push(M+(D-N[x])/2);k.poffset=A}}else P!==void 0&&(k.barwidth=P,L===void 0&&(k.poffset=M+(D-P)/2))}}function c(v,b){for(var x=b.traces,T=y(v),A=0;A<x.length;A++)for(var S=x[A],w=S[0].t,E=w.poffset,k=Array.isArray(E),L=w.barwidth,M=Array.isArray(L),P=0;P<S.length;P++){var D=S[P],N=D.w=M?L[P]:L;D[T]=D.p+(k?E[P]:E)+N/2}}function n(v,b,x){var T=b.traces,A=b.minDiff/2;e.minDtick(v,b.minDiff,b.distinctPositions[0],x);for(var S=0;S<T.length;S++){var w,E,k,L,M=T[S],P=M[0],D=P.trace,N=[];for(L=0;L<M.length;L++)E=(w=M[L]).p-A,k=w.p+A,N.push(E,k);if(D.width||D.offset){var U=P.t,G=U.poffset,X=U.barwidth,K=Array.isArray(G),Z=Array.isArray(X);for(L=0;L<M.length;L++){w=M[L];var H=K?G[L]:G,Y=Z?X[L]:X;k=(E=w.p+H)+Y,N.push(E,k)}}D._extremes[v._id]=e.findExtremes(v,N,{padded:!1})}}function a(v,b){for(var x=b.traces,T=y(v),A=0;A<x.length;A++){for(var S=x[A],w=S[0].trace,E=[],k=!1,L=0;L<S.length;L++){var M=S[L],P=M.b,D=P+M.s;M[T]=D,E.push(D),M.hasB&&E.push(P),M.hasB&&M.b||(k=!0)}w._extremes[v._id]=e.findExtremes(v,E,{tozero:k,padded:!0})}}function g(v){for(var b=v.traces,x=0;x<b.length;x++)for(var T=b[x],A=0;A<T.length;A++){var S=T[A];S.s!==m&&v.put(S.p,S.b+S.s)}}function p(v,b,x){var T=b.traces,A=y(v),S=x.norm==="fraction"?1:100,w=S/1e9,E=v.l2c(v.c2l(0)),k=x.mode==="stack"?S:E;function L($){return t(v.c2l($))&&($<E-w||$>k+w||!t(E))}for(var M=0;M<T.length;M++){for(var P=T[M],D=P[0].trace,N=[],U=!1,G=!1,X=0;X<P.length;X++){var K=P[X];if(K.s!==m){var Z=Math.abs(S/b.get(K.p,K.s));K.b*=Z,K.s*=Z;var H=K.b,Y=H+K.s;K[A]=Y,N.push(Y),G=G||L(Y),K.hasB&&(N.push(H),G=G||L(H)),K.hasB&&K.b||(U=!0)}}D._extremes[v._id]=e.findExtremes(v,N,{tozero:U,padded:G})}}function y(v){return v._id.charAt(0)}I.exports={crossTraceCalc:function(v,b){for(var x=b.xaxis,T=b.yaxis,A=v._fullLayout,S=v._fullData,w=v.calcdata,E=[],k=[],L=0;L<S.length;L++){var M=S[L];if(M.visible===!0&&h.traceIs(M,"bar")&&M.xaxis===x._id&&M.yaxis===T._id&&(M.orientation==="h"?E.push(w[L]):k.push(w[L]),M._computePh))for(var P=v.calcdata[L],D=0;D<P.length;D++)typeof P[D].ph0=="function"&&(P[D].ph0=P[D].ph0()),typeof P[D].ph1=="function"&&(P[D].ph1=P[D].ph1())}var N={xCat:x.type==="category"||x.type==="multicategory",yCat:T.type==="category"||T.type==="multicategory",mode:A.barmode,norm:A.barnorm,gap:A.bargap,groupgap:A.bargroupgap};o(v,x,T,k,N),o(v,T,x,E,N)},setGroupPositions:o}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/axes":838,"../../plots/cartesian/constraints":846,"../../registry":915,"./sieve.js":938,"fast-isnumeric":246}],929:[function(r,I,B){var t=r("../../lib"),d=r("../../components/color"),m=r("../../registry"),h=r("../scatter/xy_defaults"),e=r("../scatter/period_defaults"),f=r("./style_defaults"),l=r("../../plots/cartesian/constraints").getAxisGroup,o=r("./attributes"),u=t.coerceFont;function s(c,n,a,g){var p=n.orientation,y=n[{v:"x",h:"y"}[p]+"axis"],v=l(a,y)+p,b=a._alignmentOpts||{},x=g("alignmentgroup"),T=b[v];T||(T=b[v]={});var A=T[x];A?A.traces.push(n):A=T[x]={traces:[n],alignmentIndex:Object.keys(T).length,offsetGroups:{}};var S=g("offsetgroup"),w=A.offsetGroups,E=w[S];S&&(E||(E=w[S]={offsetIndex:Object.keys(w).length}),n._offsetIndex=E.offsetIndex)}function i(c,n,a,g,p,y){var v=(y=y||{}).moduleHasSelected!==!1,b=y.moduleHasUnselected!==!1,x=y.moduleHasConstrain!==!1,T=y.moduleHasCliponaxis!==!1,A=y.moduleHasTextangle!==!1,S=y.moduleHasInsideanchor!==!1,w=!!y.hasPathbar,E=Array.isArray(p)||p==="auto",k=E||p==="inside",L=E||p==="outside";if(k||L){var M=u(g,"textfont",a.font),P=t.extendFlat({},M),D=!(c.textfont&&c.textfont.color);if(D&&delete P.color,u(g,"insidetextfont",P),w){var N=t.extendFlat({},M);D&&delete N.color,u(g,"pathbar.textfont",N)}L&&u(g,"outsidetextfont",M),v&&g("selected.textfont.color"),b&&g("unselected.textfont.color"),x&&g("constraintext"),T&&g("cliponaxis"),A&&g("textangle"),g("texttemplate")}k&&S&&g("insidetextanchor")}I.exports={supplyDefaults:function(c,n,a,g){function p(x,T){return t.coerce(c,n,o,x,T)}if(h(c,n,g,p)){e(c,n,g,p),p("xhoverformat"),p("yhoverformat"),p("orientation",n.x&&!n.y?"h":"v"),p("base"),p("offset"),p("width"),p("text"),p("hovertext"),p("hovertemplate");var y=p("textposition");i(c,n,g,p,y,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),f(c,n,p,a,g);var v=(n.marker.line||{}).color,b=m.getComponentMethod("errorbars","supplyDefaults");b(c,n,v||d.defaultLine,{axis:"y"}),b(c,n,v||d.defaultLine,{axis:"x",inherit:"y"}),t.coerceSelectionMarkerOpacity(n,p)}else n.visible=!1},crossTraceDefaults:function(c,n){var a;function g(y){return t.coerce(a._input,a,o,y)}if(n.barmode==="group")for(var p=0;p<c.length;p++)(a=c[p]).type==="bar"&&(a._input,s(0,a,n,g))},handleGroupingDefaults:s,handleText:i}},{"../../components/color":650,"../../lib":787,"../../plots/cartesian/constraints":846,"../../registry":915,"../scatter/period_defaults":1222,"../scatter/xy_defaults":1229,"./attributes":925,"./style_defaults":940}],930:[function(r,I,B){I.exports=function(t,d,m){return t.x="xVal"in d?d.xVal:d.x,t.y="yVal"in d?d.yVal:d.y,d.xa&&(t.xaxis=d.xa),d.ya&&(t.yaxis=d.ya),m.orientation==="h"?(t.label=t.y,t.value=t.x):(t.label=t.x,t.value=t.y),t}},{}],931:[function(r,I,B){var t=r("fast-isnumeric"),d=r("tinycolor2"),m=r("../../lib").isArrayOrTypedArray;B.coerceString=function(h,e,f){if(typeof e=="string"){if(e||!h.noBlank)return e}else if((typeof e=="number"||e===!0)&&!h.strict)return String(e);return f!==void 0?f:h.dflt},B.coerceNumber=function(h,e,f){if(t(e)){e=+e;var l=h.min,o=h.max;if(!(l!==void 0&&e<l||o!==void 0&&e>o))return e}return f!==void 0?f:h.dflt},B.coerceColor=function(h,e,f){return d(e).isValid()?e:f!==void 0?f:h.dflt},B.coerceEnumerated=function(h,e,f){return h.coerceNumber&&(e=+e),h.values.indexOf(e)!==-1?e:f!==void 0?f:h.dflt},B.getValue=function(h,e){var f;return Array.isArray(h)?e<h.length&&(f=h[e]):f=h,f},B.getLineWidth=function(h,e){return 0<e.mlw?e.mlw:m(h.marker.line.width)?0:h.marker.line.width}},{"../../lib":787,"fast-isnumeric":246,tinycolor2:583}],932:[function(r,I,B){var t=r("../../components/fx"),d=r("../../registry"),m=r("../../components/color"),h=r("../../lib").fillText,e=r("./helpers").getLineWidth,f=r("../../plots/cartesian/axes").hoverLabelText,l=r("../../constants/numerical").BADNUM;function o(s,i,c,n,a){var g,p,y,v,b,x,T,A=s.cd,S=A[0].trace,w=A[0].t,E=n==="closest",k=S.type==="waterfall",L=s.maxHoverDistance,M=s.maxSpikeDistance;S.orientation==="h"?(g=c,p=i,y="y",v="x",b=z,x=Y):(g=i,p=c,y="x",v="y",x=z,b=Y);var P=S[y+"period"],D=E||P;function N(ae){return G(ae,-1)}function U(ae){return G(ae,1)}function G(ae,he){var se=ae.w;return ae[y]+he*se/2}function X(ae){return ae[y+"End"]-ae[y+"Start"]}var K=E?N:P?function(ae){return ae.p-X(ae)/2}:function(ae){return Math.min(N(ae),ae.p-w.bardelta/2)},Z=E?U:P?function(ae){return ae.p+X(ae)/2}:function(ae){return Math.max(U(ae),ae.p+w.bardelta/2)};function H(ae,he,se){return a.finiteRange&&(se=0),t.inbox(ae-g,he-g,se+Math.min(1,Math.abs(he-ae)/T)-1)}function Y(ae){return H(K(ae),Z(ae),L)}function $(ae){var he=ae[v];if(k){var se=Math.abs(ae.rawS)||0;p>0?he+=se:p<0&&(he-=se)}return he}function z(ae){var he=p,se=ae.b,de=$(ae);return t.inbox(se-he,de-he,L+(de-he)/(de-se)-1)}var j=s[y+"a"],W=s[v+"a"];T=Math.abs(j.r2c(j.range[1])-j.r2c(j.range[0]));var ee=t.getDistanceFunction(n,b,x,function(ae){return(b(ae)+x(ae))/2});if(t.getClosest(A,ee,s),s.index!==!1&&A[s.index].p!==l){D||(K=function(ae){return Math.min(N(ae),ae.p-w.bargroupwidth/2)},Z=function(ae){return Math.max(U(ae),ae.p+w.bargroupwidth/2)});var J=A[s.index],Q=S.base?J.b+J.s:J.s;s[v+"0"]=s[v+"1"]=W.c2p(J[v],!0),s[v+"LabelVal"]=Q;var te=w.extents[w.extents.round(J.p)];s[y+"0"]=j.c2p(E?K(J):te[0],!0),s[y+"1"]=j.c2p(E?Z(J):te[1],!0);var ie=J.orig_p!==void 0;return s[y+"LabelVal"]=ie?J.orig_p:J.p,s.labelLabel=f(j,s[y+"LabelVal"],S[y+"hoverformat"]),s.valueLabel=f(W,s[v+"LabelVal"],S[v+"hoverformat"]),s.baseLabel=f(W,J.b,S[v+"hoverformat"]),s.spikeDistance=(function(ae){var he=p,se=ae.b,de=$(ae);return t.inbox(se-he,de-he,M+(de-he)/(de-se)-1)}(J)+function(ae){return H(N(ae),U(ae),M)}(J))/2,s[y+"Spike"]=j.c2p(J.p,!0),h(J,S,s),s.hovertemplate=S.hovertemplate,s}}function u(s,i){var c=i.mcc||s.marker.color,n=i.mlcc||s.marker.line.color,a=e(s,i);return m.opacity(c)?c:m.opacity(n)&&a?n:void 0}I.exports={hoverPoints:function(s,i,c,n,a){var g=o(s,i,c,n,a);if(g){var p=g.cd,y=p[0].trace,v=p[g.index];return g.color=u(y,v),d.getComponentMethod("errorbars","hoverInfo")(v,y,g),[g]}},hoverOnBars:o,getTraceColor:u}},{"../../components/color":650,"../../components/fx":690,"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/axes":838,"../../registry":915,"./helpers":931}],933:[function(r,I,B){I.exports={attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults").supplyDefaults,crossTraceDefaults:r("./defaults").crossTraceDefaults,supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc"),crossTraceCalc:r("./cross_trace_calc").crossTraceCalc,colorbar:r("../scatter/marker_colorbar"),arraysToCalcdata:r("./arrays_to_calcdata"),plot:r("./plot").plot,style:r("./style").style,styleOnSelect:r("./style").styleOnSelect,hoverPoints:r("./hover").hoverPoints,eventData:r("./event_data"),selectPoints:r("./select"),moduleType:"trace",name:"bar",basePlotModule:r("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":852,"../scatter/marker_colorbar":1220,"./arrays_to_calcdata":924,"./attributes":925,"./calc":926,"./cross_trace_calc":928,"./defaults":929,"./event_data":930,"./hover":932,"./layout_attributes":934,"./layout_defaults":935,"./plot":936,"./select":937,"./style":939}],934:[function(r,I,B){I.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],935:[function(r,I,B){var t=r("../../registry"),d=r("../../plots/cartesian/axes"),m=r("../../lib"),h=r("./layout_attributes");I.exports=function(e,f,l){function o(y,v){return m.coerce(e,f,h,y,v)}for(var u=!1,s=!1,i=!1,c={},n=o("barmode"),a=0;a<l.length;a++){var g=l[a];if(t.traceIs(g,"bar")&&g.visible){if(u=!0,n==="group"){var p=g.xaxis+g.yaxis;c[p]&&(i=!0),c[p]=!0}g.visible&&g.type==="histogram"&&d.getFromId({_fullLayout:f},g[g.orientation==="v"?"xaxis":"yaxis"]).type!=="category"&&(s=!0)}}u?(n!=="overlay"&&o("barnorm"),o("bargap",s&&!i?0:.2),o("bargroupgap")):delete f.barmode}},{"../../lib":787,"../../plots/cartesian/axes":838,"../../registry":915,"./layout_attributes":934}],936:[function(r,I,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("../../lib"),h=r("../../lib/svg_text_utils"),e=r("../../components/color"),f=r("../../components/drawing"),l=r("../../registry"),o=r("../../plots/cartesian/axes").tickText,u=r("./uniform_text"),s=u.recordMinTextSize,i=u.clearMinTextSize,c=r("./style"),n=r("./helpers"),a=r("./constants"),g=r("./attributes"),p=g.text,y=g.textposition,v=r("../../components/fx/helpers").appendArrayPointValue,b=a.TEXTPAD;function x(M){return M.id}function T(M){if(M.ids)return x}function A(M,P){return M<P?1:-1}function S(M,P,D,N){var U;return!P.uniformtext.mode&&w(D)?(N&&(U=N()),M.transition().duration(D.duration).ease(D.easing).each("end",function(){U&&U()}).each("interrupt",function(){U&&U()})):M}function w(M){return M&&M.duration>0}function E(M){return M==="auto"?0:M}function k(M,P){var D=Math.PI/180*P,N=Math.abs(Math.sin(D)),U=Math.abs(Math.cos(D));return{x:M.width*U+M.height*N,y:M.width*N+M.height*U}}function L(M,P,D,N,U,G){var X=!!G.isHorizontal,K=!!G.constrained,Z=G.angle||0,H=G.anchor||"end",Y=H==="end",$=H==="start",z=((G.leftToRight||0)+1)/2,j=1-z,W=U.width,ee=U.height,J=Math.abs(P-M),Q=Math.abs(N-D),te=J>2*b&&Q>2*b?b:0;J-=2*te,Q-=2*te;var ie=E(Z);Z!=="auto"||W<=J&&ee<=Q||!(W>J||ee>Q)||(W>Q||ee>J)&&W<ee==J<Q||(ie+=90);var ae=k(U,ie),he=1;K&&(he=Math.min(1,J/ae.x,Q/ae.y));var se=U.left*j+U.right*z,de=(U.top+U.bottom)/2,ue=(M+b)*j+(P-b)*z,ve=(D+N)/2,ke=0,Ee=0;if($||Y){var be=(X?ae.x:ae.y)/2,xe=X?A(M,P):A(D,N);X?$?(ue=M+xe*te,ke=-xe*be):(ue=P-xe*te,ke=xe*be):$?(ve=D+xe*te,Ee=-xe*be):(ve=N-xe*te,Ee=xe*be)}return{textX:se,textY:de,targetX:ue,targetY:ve,anchorX:ke,anchorY:Ee,scale:he,rotate:ie}}I.exports={plot:function(M,P,D,N,U,G){var X=P.xaxis,K=P.yaxis,Z=M._fullLayout;U||(U={mode:Z.barmode,norm:Z.barmode,gap:Z.bargap,groupgap:Z.bargroupgap},i("bar",Z));var H=m.makeTraceGroups(N,D,"trace bars").each(function(Y){var $=t.select(this),z=Y[0].trace,j=z.type==="waterfall",W=z.type==="funnel",ee=z.type==="bar"||W,J=0;j&&z.connector.visible&&z.connector.mode==="between"&&(J=z.connector.line.width/2);var Q=z.orientation==="h",te=w(U),ie=m.ensureSingle($,"g","points"),ae=T(z),he=ie.selectAll("g.point").data(m.identity,ae);he.enter().append("g").classed("point",!0),he.exit().remove(),he.each(function(de,ue){var ve,ke,Ee=t.select(this),be=function(Oe,je,We,qe){var et=[],st=[],ct=qe?je:We,Pt=qe?We:je;return et[0]=ct.c2p(Oe.s0,!0),st[0]=Pt.c2p(Oe.p0,!0),et[1]=ct.c2p(Oe.s1,!0),st[1]=Pt.c2p(Oe.p1,!0),qe?[et,st]:[st,et]}(de,X,K,Q),xe=be[0][0],ce=be[0][1],ge=be[1][0],we=be[1][1],Me=(Q?ce-xe:we-ge)==0;if(Me&&ee&&n.getLineWidth(z,de)&&(Me=!1),Me||(Me=!(d(xe)&&d(ce)&&d(ge)&&d(we))),de.isBlank=Me,Me&&(Q?ce=xe:we=ge),J&&!Me&&(Q?(xe-=A(xe,ce)*J,ce+=A(xe,ce)*J):(ge-=A(ge,we)*J,we+=A(ge,we)*J)),z.type==="waterfall"){if(!Me){var Se=z[de.dir].marker;ve=Se.line.width,ke=Se.color}}else ve=n.getLineWidth(z,de),ke=de.mc||z.marker.color;function ze(Oe){var je=t.round(ve/2%1,2);return U.gap===0&&U.groupgap===0?t.round(Math.round(Oe)-je,2):Oe}if(!M._context.staticPlot){var Fe=e.opacity(ke)<1||ve>.01?ze:function(Oe,je,We){return We&&Oe===je?Oe:Math.abs(Oe-je)>=2?ze(Oe):Oe>je?Math.ceil(Oe):Math.floor(Oe)};xe=Fe(xe,ce,Q),ce=Fe(ce,xe,Q),ge=Fe(ge,we,!Q),we=Fe(we,ge,!Q)}var Ye=S(m.ensureSingle(Ee,"path"),Z,U,G);if(Ye.style("vector-effect","non-scaling-stroke").attr("d",isNaN((ce-xe)*(we-ge))||Me&&M._context.staticPlot?"M0,0Z":"M"+xe+","+ge+"V"+we+"H"+ce+"V"+ge+"Z").call(f.setClipUrl,P.layerClipId,M),!Z.uniformtext.mode&&te){var rt=f.makePointStyleFns(z);f.singlePointStyle(de,Ye,z,rt,M)}(function(Oe,je,We,qe,et,st,ct,Pt,kt,at,tt){var _t,er=je.xaxis,tr=je.yaxis,Ue=Oe._fullLayout;function He(Xt,Kt,or){return m.ensureSingle(Xt,"text").text(Kt).attr({class:"bartext bartext-"+_t,"text-anchor":"middle","data-notex":1}).call(f.font,or).call(h.convertToTspans,Oe)}var Be=qe[0].trace,Ke=Be.orientation==="h",_e=function(Xt,Kt,or,dr,vr){var ur,pr=Kt[0].trace;return ur=pr.texttemplate?function(br,Rr,_r,jr,$r){var pn=Rr[0].trace,In=m.castOption(pn,_r,"texttemplate");if(!In)return"";var On,Sn,an,Nr,Pr=pn.type==="waterfall",en=pn.type==="funnel";pn.orientation==="h"?(On="y",Sn=$r,an="x",Nr=jr):(On="x",Sn=jr,an="y",Nr=$r);function tn(It){return o(Nr,Nr.c2l(It),!0).text}var Qr=Rr[_r],rn={};rn.label=Qr.p,rn.labelLabel=rn[On+"Label"]=(An=Qr.p,o(Sn,Sn.c2l(An),!0).text);var An,En=m.castOption(pn,Qr.i,"text");(En===0||En)&&(rn.text=En),rn.value=Qr.s,rn.valueLabel=rn[an+"Label"]=tn(Qr.s);var Bn={};v(Bn,pn,Qr.i),Pr&&(rn.delta=+Qr.rawS||Qr.s,rn.deltaLabel=tn(rn.delta),rn.final=Qr.v,rn.finalLabel=tn(rn.final),rn.initial=rn.final-rn.delta,rn.initialLabel=tn(rn.initial)),en&&(rn.value=Qr.s,rn.valueLabel=tn(rn.value),rn.percentInitial=Qr.begR,rn.percentInitialLabel=m.formatPercent(Qr.begR),rn.percentPrevious=Qr.difR,rn.percentPreviousLabel=m.formatPercent(Qr.difR),rn.percentTotal=Qr.sumR,rn.percenTotalLabel=m.formatPercent(Qr.sumR));var Jt=m.castOption(pn,Qr.i,"customdata");return Jt&&(rn.customdata=Jt),m.texttemplateString(In,rn,br._d3locale,Bn,rn,pn._meta||{})}(Xt,Kt,or,dr,vr):pr.textinfo?function(br,Rr,_r,jr){var $r=br[0].trace,pn=$r.orientation==="h",In=$r.type==="waterfall",On=$r.type==="funnel";function Sn(qt){return o(pn?_r:jr,+qt,!0).text}var an,Nr=$r.textinfo,Pr=br[Rr],en=Nr.split("+"),tn=[],Qr=function(qt){return en.indexOf(qt)!==-1};Qr("label")&&tn.push((rn=br[Rr].p,o(pn?jr:_r,rn,!0).text));var rn;if(Qr("text")&&((an=m.castOption($r,Pr.i,"text"))===0||an)&&tn.push(an),In){var An=+Pr.rawS||Pr.s,En=Pr.v,Bn=En-An;Qr("initial")&&tn.push(Sn(Bn)),Qr("delta")&&tn.push(Sn(An)),Qr("final")&&tn.push(Sn(En))}if(On){Qr("value")&&tn.push(Sn(Pr.s));var Jt=0;Qr("percent initial")&&Jt++,Qr("percent previous")&&Jt++,Qr("percent total")&&Jt++;var It=Jt>1;Qr("percent initial")&&(an=m.formatPercent(Pr.begR),It&&(an+=" of initial"),tn.push(an)),Qr("percent previous")&&(an=m.formatPercent(Pr.difR),It&&(an+=" of previous"),tn.push(an)),Qr("percent total")&&(an=m.formatPercent(Pr.sumR),It&&(an+=" of total"),tn.push(an))}return tn.join("<br>")}(Kt,or,dr,vr):n.getValue(pr.text,or),n.coerceString(p,ur)}(Ue,qe,et,er,tr);_t=function(Xt,Kt){var or=n.getValue(Xt.textposition,Kt);return n.coerceEnumerated(y,or)}(Be,et);var Ce=at.mode==="stack"||at.mode==="relative",Le=qe[et],Pe=!Ce||Le._outmost;if(!_e||_t==="none"||(Le.isBlank||st===ct||Pt===kt)&&(_t==="auto"||_t==="inside"))return void We.select("text").remove();var Xe=Ue.font,ht=c.getBarColor(qe[et],Be),Mt=c.getInsideTextFont(Be,et,Xe,ht),pt=c.getOutsideTextFont(Be,et,Xe),Lt=We.datum();Ke?er.type==="log"&&Lt.s0<=0&&(st=er.range[0]<er.range[1]?0:er._length):tr.type==="log"&&Lt.s0<=0&&(Pt=tr.range[0]<tr.range[1]?tr._length:0);var vt,Dt,xt,it,St,Nt=Math.abs(ct-st)-2*b,Ut=Math.abs(kt-Pt)-2*b;if(_t==="outside"&&(Pe||Le.hasB||(_t="inside")),_t==="auto")if(Pe){_t="inside",St=m.ensureUniformFontSize(Oe,Mt),vt=He(We,_e,St),Dt=f.bBox(vt.node()),xt=Dt.width,it=Dt.height;var Qt=xt<=Nt&&it<=Ut,Ie=xt<=Ut&&it<=Nt,lt=Ke?Nt>=xt*(Ut/it):Ut>=it*(Nt/xt);xt>0&&it>0&&(Qt||Ie||lt)?_t="inside":(_t="outside",vt.remove(),vt=null)}else _t="inside";if(!vt){St=m.ensureUniformFontSize(Oe,_t==="outside"?pt:Mt);var wt=(vt=He(We,_e,St)).attr("transform");if(vt.attr("transform",""),Dt=f.bBox(vt.node()),xt=Dt.width,it=Dt.height,vt.attr("transform",wt),xt<=0||it<=0)return void vt.remove()}var Ot,Gt,ir=Be.textangle;_t==="outside"?(Gt=Be.constraintext==="both"||Be.constraintext==="outside",Ot=function(Xt,Kt,or,dr,vr,ur){var pr,br=!!ur.isHorizontal,Rr=!!ur.constrained,_r=ur.angle||0,jr=vr.width,$r=vr.height,pn=Math.abs(Kt-Xt),In=Math.abs(dr-or);pr=br?In>2*b?b:0:pn>2*b?b:0;var On=1;Rr&&(On=br?Math.min(1,In/$r):Math.min(1,pn/jr));var Sn=E(_r),an=k(vr,Sn),Nr=(br?an.x:an.y)/2,Pr=(vr.left+vr.right)/2,en=(vr.top+vr.bottom)/2,tn=(Xt+Kt)/2,Qr=(or+dr)/2,rn=0,An=0,En=br?A(Kt,Xt):A(or,dr);return br?(tn=Kt-En*pr,rn=En*Nr):(Qr=dr+En*pr,An=-En*Nr),{textX:Pr,textY:en,targetX:tn,targetY:Qr,anchorX:rn,anchorY:An,scale:On,rotate:Sn}}(st,ct,Pt,kt,Dt,{isHorizontal:Ke,constrained:Gt,angle:ir})):(Gt=Be.constraintext==="both"||Be.constraintext==="inside",Ot=L(st,ct,Pt,kt,Dt,{isHorizontal:Ke,constrained:Gt,angle:ir,anchor:Be.insidetextanchor})),Ot.fontSize=St.size,s(Be.type,Ot,Ue),Le.transform=Ot,S(vt,Ue,at,tt).attr("transform",m.getTextTransform(Ot))})(M,P,Ee,Y,ue,xe,ce,ge,we,U,G),P.layerClipId&&f.hideOutsideRangePoint(de,Ee.select("text"),X,K,z.xcalendar,z.ycalendar)});var se=z.cliponaxis===!1;f.setClipUrl($,se?null:P.layerClipId,M)});l.getComponentMethod("errorbars","plot")(M,H,P,U)},toMoveInsideBar:L}},{"../../components/color":650,"../../components/drawing":672,"../../components/fx/helpers":686,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../registry":915,"./attributes":925,"./constants":927,"./helpers":931,"./style":939,"./uniform_text":941,"@plotly/d3":58,"fast-isnumeric":246}],937:[function(r,I,B){function t(d,m,h,e,f){var l=m.c2p(e?d.s0:d.p0,!0),o=m.c2p(e?d.s1:d.p1,!0),u=h.c2p(e?d.p0:d.s0,!0),s=h.c2p(e?d.p1:d.s1,!0);return f?[(l+o)/2,(u+s)/2]:e?[o,(u+s)/2]:[(l+o)/2,s]}I.exports=function(d,m){var h,e=d.cd,f=d.xaxis,l=d.yaxis,o=e[0].trace,u=o.type==="funnel",s=o.orientation==="h",i=[];if(m===!1)for(h=0;h<e.length;h++)e[h].selected=0;else for(h=0;h<e.length;h++){var c=e[h],n="ct"in c?c.ct:t(c,f,l,s,u);m.contains(n,!1,h,d)?(i.push({pointNumber:h,x:f.c2d(c.x),y:l.c2d(c.y)}),c.selected=1):c.selected=0}return i}},{}],938:[function(r,I,B){I.exports=m;var t=r("../../lib").distinctVals,d=r("../../constants/numerical").BADNUM;function m(h,e){this.traces=h,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var f=1/0,l=[],o=0;o<h.length;o++){for(var u=h[o],s=0;s<u.length;s++){var i=u[s];i.p!==d&&l.push(i.p)}u[0]&&u[0].width1&&(f=Math.min(u[0].width1,f))}this.positions=l;var c=t(l);this.distinctPositions=c.vals,c.vals.length===1&&f!==1/0?this.minDiff=f:this.minDiff=Math.min(c.minDiff,f);var n=(e.posAxis||{}).type;n!=="category"&&n!=="multicategory"||(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}m.prototype.put=function(h,e){var f=this.getLabel(h,e),l=this.bins[f]||0;return this.bins[f]=l+e,l},m.prototype.get=function(h,e){var f=this.getLabel(h,e);return this.bins[f]||0},m.prototype.getLabel=function(h,e){return(e<0&&this.sepNegVal?"v":"^")+(this.overlapNoMerge?h:Math.round(h/this.binWidth))}},{"../../constants/numerical":763,"../../lib":787}],939:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/color"),m=r("../../components/drawing"),h=r("../../lib"),e=r("../../registry"),f=r("./uniform_text").resizeText,l=r("./attributes"),o=l.textfont,u=l.insidetextfont,s=l.outsidetextfont,i=r("./helpers");function c(x,T,A){m.pointStyle(x.selectAll("path"),T,A),n(x,T,A)}function n(x,T,A){x.selectAll("text").each(function(S){var w=t.select(this),E=h.ensureUniformFontSize(A,a(w,S,T,A));m.font(w,E)})}function a(x,T,A,S){var w=S._fullLayout.font,E=A.textfont;if(x.classed("bartext-inside")){var k=b(T,A);E=p(A,T.i,w,k)}else x.classed("bartext-outside")&&(E=y(A,T.i,w));return E}function g(x,T,A){return v(o,x.textfont,T,A)}function p(x,T,A,S){var w=g(x,T,A);return(x._input.textfont===void 0||x._input.textfont.color===void 0||Array.isArray(x.textfont.color)&&x.textfont.color[T]===void 0)&&(w={color:d.contrast(S),family:w.family,size:w.size}),v(u,x.insidetextfont,T,w)}function y(x,T,A){var S=g(x,T,A);return v(s,x.outsidetextfont,T,S)}function v(x,T,A,S){T=T||{};var w=i.getValue(T.family,A),E=i.getValue(T.size,A),k=i.getValue(T.color,A);return{family:i.coerceString(x.family,w,S.family),size:i.coerceNumber(x.size,E,S.size),color:i.coerceColor(x.color,k,S.color)}}function b(x,T){return T.type==="waterfall"?T[x.dir].marker.color:x.mcc||x.mc||T.marker.color}I.exports={style:function(x){var T=t.select(x).selectAll("g.barlayer").selectAll("g.trace");f(x,T,"bar");var A=T.size(),S=x._fullLayout;T.style("opacity",function(w){return w[0].trace.opacity}).each(function(w){(S.barmode==="stack"&&A>1||S.bargap===0&&S.bargroupgap===0&&!w[0].trace.marker.line.width)&&t.select(this).attr("shape-rendering","crispEdges")}),T.selectAll("g.points").each(function(w){c(t.select(this),w[0].trace,x)}),e.getComponentMethod("errorbars","style")(T)},styleTextPoints:n,styleOnSelect:function(x,T,A){var S=T[0].trace;S.selectedpoints?function(w,E,k){m.selectedPointStyle(w.selectAll("path"),E),function(L,M,P){L.each(function(D){var N,U=t.select(this);if(D.selected){N=h.ensureUniformFontSize(P,a(U,D,M,P));var G=M.selected.textfont&&M.selected.textfont.color;G&&(N.color=G),m.font(U,N)}else m.selectedTextStyle(U,M)})}(w.selectAll("text"),E,k)}(A,S,x):(c(A,S,x),e.getComponentMethod("errorbars","style")(A))},getInsideTextFont:p,getOutsideTextFont:y,getBarColor:b,resizeText:f}},{"../../components/color":650,"../../components/drawing":672,"../../lib":787,"../../registry":915,"./attributes":925,"./helpers":931,"./uniform_text":941,"@plotly/d3":58}],940:[function(r,I,B){var t=r("../../components/color"),d=r("../../components/colorscale/helpers").hasColorscale,m=r("../../components/colorscale/defaults"),h=r("../../lib").coercePattern;I.exports=function(e,f,l,o,u){var s=l("marker.color",o),i=d(e,"marker");i&&m(e,f,u,l,{prefix:"marker.",cLetter:"c"}),l("marker.line.color",t.defaultLine),d(e,"marker.line")&&m(e,f,u,l,{prefix:"marker.line.",cLetter:"c"}),l("marker.line.width"),l("marker.opacity"),h(l,"marker.pattern",s,i),l("selected.marker.color"),l("unselected.marker.color")}},{"../../components/color":650,"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"../../lib":787}],941:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib");function m(h){return"_"+h+"Text_minsize"}I.exports={recordMinTextSize:function(h,e,f){if(f.uniformtext.mode){var l=m(h),o=f.uniformtext.minsize,u=e.scale*e.fontSize;e.hide=u<o,f[l]=f[l]||1/0,e.hide||(f[l]=Math.min(f[l],Math.max(u,o)))}},clearMinTextSize:function(h,e){e[m(h)]=void 0},resizeText:function(h,e,f){var l=h._fullLayout,o=l["_"+f+"Text_minsize"];if(o){var u,s=l.uniformtext.mode==="hide";switch(f){case"funnelarea":case"pie":case"sunburst":u="g.slice";break;case"treemap":case"icicle":u="g.slice, g.pathbar";break;default:u="g.points > g.point"}e.selectAll(u).each(function(i){var c=i.transform;c&&(c.scale=s&&c.hide?0:o/c.fontSize,t.select(this).select("text").attr("transform",d.getTextTransform(c)))})}}}},{"../../lib":787,"@plotly/d3":58}],942:[function(r,I,B){var t=r("../../plots/template_attributes").hovertemplateAttrs,d=r("../../lib/extend").extendFlat,m=r("../scatterpolar/attributes"),h=r("../bar/attributes");I.exports={r:m.r,theta:m.theta,r0:m.r0,dr:m.dr,theta0:m.theta0,dtheta:m.dtheta,thetaunit:m.thetaunit,base:d({},h.base,{}),offset:d({},h.offset,{}),width:d({},h.width,{}),text:d({},h.text,{}),hovertext:d({},h.hovertext,{}),marker:h.marker,hoverinfo:m.hoverinfo,hovertemplate:t(),selected:h.selected,unselected:h.unselected}},{"../../lib/extend":777,"../../plots/template_attributes":910,"../bar/attributes":925,"../scatterpolar/attributes":1276}],943:[function(r,I,B){var t=r("../../components/colorscale/helpers").hasColorscale,d=r("../../components/colorscale/calc"),m=r("../bar/arrays_to_calcdata"),h=r("../bar/cross_trace_calc").setGroupPositions,e=r("../scatter/calc_selection"),f=r("../../registry").traceIs,l=r("../../lib").extendFlat;I.exports={calc:function(o,u){for(var s=o._fullLayout,i=u.subplot,c=s[i].radialaxis,n=s[i].angularaxis,a=c.makeCalcdata(u,"r"),g=n.makeCalcdata(u,"theta"),p=u._length,y=new Array(p),v=a,b=g,x=0;x<p;x++)y[x]={p:b[x],s:v[x]};function T(A){var S=u[A];S!==void 0&&(u["_"+A]=Array.isArray(S)?n.makeCalcdata(u,A):n.d2c(S,u.thetaunit))}return n.type==="linear"&&(T("width"),T("offset")),t(u,"marker")&&d(o,u,{vals:u.marker.color,containerStr:"marker",cLetter:"c"}),t(u,"marker.line")&&d(o,u,{vals:u.marker.line.color,containerStr:"marker.line",cLetter:"c"}),m(y,u),e(y,u),y},crossTraceCalc:function(o,u,s){for(var i=o.calcdata,c=[],n=0;n<i.length;n++){var a=i[n],g=a[0].trace;g.visible===!0&&f(g,"bar")&&g.subplot===s&&c.push(a)}var p=l({},u.radialaxis,{_id:"x"}),y=u.angularaxis;h(o,y,p,c,{mode:u.barmode,norm:u.barnorm,gap:u.bargap,groupgap:u.bargroupgap})}}},{"../../components/colorscale/calc":658,"../../components/colorscale/helpers":661,"../../lib":787,"../../registry":915,"../bar/arrays_to_calcdata":924,"../bar/cross_trace_calc":928,"../scatter/calc_selection":1204}],944:[function(r,I,B){var t=r("../../lib"),d=r("../scatterpolar/defaults").handleRThetaDefaults,m=r("../bar/style_defaults"),h=r("./attributes");I.exports=function(e,f,l,o){function u(s,i){return t.coerce(e,f,h,s,i)}d(e,f,o,u)?(u("thetaunit"),u("base"),u("offset"),u("width"),u("text"),u("hovertext"),u("hovertemplate"),m(e,f,u,l,o),t.coerceSelectionMarkerOpacity(f,u)):f.visible=!1}},{"../../lib":787,"../bar/style_defaults":940,"../scatterpolar/defaults":1278,"./attributes":942}],945:[function(r,I,B){var t=r("../../components/fx"),d=r("../../lib"),m=r("../bar/hover").getTraceColor,h=d.fillText,e=r("../scatterpolar/hover").makeHoverPointText,f=r("../../plots/polar/helpers").isPtInsidePolygon;I.exports=function(l,o,u){var s=l.cd,i=s[0].trace,c=l.subplot,n=c.radialAxis,a=c.angularAxis,g=c.vangles,p=g?f:d.isPtInsideSector,y=l.maxHoverDistance,v=a._period||2*Math.PI,b=Math.abs(n.g2p(Math.sqrt(o*o+u*u))),x=Math.atan2(u,o);if(n.range[0]>n.range[1]&&(x+=Math.PI),t.getClosest(s,function(S){return p(b,x,[S.rp0,S.rp1],[S.thetag0,S.thetag1],g)?y+Math.min(1,Math.abs(S.thetag1-S.thetag0)/v)-1+(S.rp1-b)/(S.rp1-S.rp0)-1:1/0},l),l.index!==!1){var T=s[l.index];l.x0=l.x1=T.ct[0],l.y0=l.y1=T.ct[1];var A=d.extendFlat({},T,{r:T.s,theta:T.p});return h(T,i,l),e(A,i,c,l),l.hovertemplate=i.hovertemplate,l.color=m(i,T),l.xLabelVal=l.yLabelVal=void 0,T.s<0&&(l.idealAlign="left"),[l]}}},{"../../components/fx":690,"../../lib":787,"../../plots/polar/helpers":903,"../bar/hover":932,"../scatterpolar/hover":1280}],946:[function(r,I,B){I.exports={moduleType:"trace",name:"barpolar",basePlotModule:r("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("../scatterpolar/format_labels"),style:r("../bar/style").style,styleOnSelect:r("../bar/style").styleOnSelect,hoverPoints:r("./hover"),selectPoints:r("../bar/select"),meta:{}}},{"../../plots/polar":904,"../bar/select":937,"../bar/style":939,"../scatter/marker_colorbar":1220,"../scatterpolar/format_labels":1279,"./attributes":942,"./calc":943,"./defaults":944,"./hover":945,"./layout_attributes":947,"./layout_defaults":948,"./plot":949}],947:[function(r,I,B){I.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],948:[function(r,I,B){var t=r("../../lib"),d=r("./layout_attributes");I.exports=function(m,h,e){var f,l={};function o(i,c){return t.coerce(m[f]||{},h[f],d,i,c)}for(var u=0;u<e.length;u++){var s=e[u];s.type==="barpolar"&&s.visible===!0&&(l[f=s.subplot]||(o("barmode"),o("bargap"),l[f]=1))}}},{"../../lib":787,"./layout_attributes":947}],949:[function(r,I,B){var t=r("@plotly/d3"),d=r("fast-isnumeric"),m=r("../../lib"),h=r("../../components/drawing"),e=r("../../plots/polar/helpers");I.exports=function(f,l,o){var u=l.xaxis,s=l.yaxis,i=l.radialAxis,c=l.angularAxis,n=function(g){var p=g.cxx,y=g.cyy;return g.vangles?function(v,b,x,T){var A,S;m.angleDelta(x,T)>0?(A=x,S=T):(A=T,S=x);var w=[e.findEnclosingVertexAngles(A,g.vangles)[0],(A+S)/2,e.findEnclosingVertexAngles(S,g.vangles)[1]];return e.pathPolygonAnnulus(v,b,A,S,w,p,y)}:function(v,b,x,T){return m.pathAnnulus(v,b,x,T,p,y)}}(l),a=l.layers.frontplot.select("g.barlayer");m.makeTraceGroups(a,o,"trace bars").each(function(){var g=t.select(this),p=m.ensureSingle(g,"g","points").selectAll("g.point").data(m.identity);p.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),p.exit().remove(),p.each(function(y){var v,b=t.select(this),x=y.rp0=i.c2p(y.s0),T=y.rp1=i.c2p(y.s1),A=y.thetag0=c.c2g(y.p0),S=y.thetag1=c.c2g(y.p1);if(d(x)&&d(T)&&d(A)&&d(S)&&x!==T&&A!==S){var w=i.c2g(y.s1),E=(A+S)/2;y.ct=[u.c2p(w*Math.cos(E)),s.c2p(w*Math.sin(E))],v=n(x,T,A,S)}else v="M0,0Z";m.ensureSingle(b,"path").attr("d",v)}),h.setClipUrl(g,l._hasClipOnAxisFalse?l.clipIds.forTraces:null,f)})}},{"../../components/drawing":672,"../../lib":787,"../../plots/polar/helpers":903,"@plotly/d3":58,"fast-isnumeric":246}],950:[function(r,I,B){var t=r("../scatter/attributes"),d=r("../bar/attributes"),m=r("../../components/color/attributes"),h=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=r("../../plots/template_attributes").hovertemplateAttrs,f=r("../../lib/extend").extendFlat,l=t.marker,o=l.line;I.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,xhoverformat:h("x"),yhoverformat:h("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:f({},l.symbol,{arrayOk:!1,editType:"plot"}),opacity:f({},l.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:f({},l.size,{arrayOk:!1,editType:"calc"}),color:f({},l.color,{arrayOk:!1,editType:"style"}),line:{color:f({},o.color,{arrayOk:!1,dflt:m.defaultLine,editType:"style"}),width:f({},o.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:t.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:d.offsetgroup,alignmentgroup:d.alignmentgroup,selected:{marker:t.selected.marker,editType:"style"},unselected:{marker:t.unselected.marker,editType:"style"},text:f({},t.text,{}),hovertext:f({},t.hovertext,{}),hovertemplate:e({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":649,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../bar/attributes":925,"../scatter/attributes":1202}],951:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../plots/cartesian/axes"),m=r("../../plots/cartesian/align_period"),h=r("../../lib"),e=r("../../constants/numerical").BADNUM,f=h._;I.exports=function(p,y){var v,b,x,T,A,S,w,E=p._fullLayout,k=d.getFromId(p,y.xaxis||"x"),L=d.getFromId(p,y.yaxis||"y"),M=[],P=y.type==="violin"?"_numViolins":"_numBoxes";y.orientation==="h"?(x=k,T="x",A=L,S="y",w=!!y.yperiodalignment):(x=L,T="y",A=k,S="x",w=!!y.xperiodalignment);var D,N,U,G,X,K,Z=function(We,qe,et,st){var ct,Pt=qe+"0"in We,kt="d"+qe in We;if(qe in We||Pt&&kt){var at=et.makeCalcdata(We,qe);return[m(We,et,qe,at).vals,at]}ct=Pt?We[qe+"0"]:"name"in We&&(et.type==="category"||t(We.name)&&["linear","log"].indexOf(et.type)!==-1||h.isDateTime(We.name)&&et.type==="date")?We.name:st;for(var tt=et.type==="multicategory"?et.r2c_just_indices(ct):et.d2c(ct,0,We[qe+"calendar"]),_t=We._length,er=new Array(_t),tr=0;tr<_t;tr++)er[tr]=tt;return[er]}(y,S,A,E[P]),H=Z[0],Y=Z[1],$=h.distinctVals(H,A),z=$.vals,j=$.minDiff/2,W=(y.boxpoints||y.points)==="all"?h.identity:function(We){return We.v<D.lf||We.v>D.uf};if(y._hasPreCompStats){var ee=y[T],J=function(We){return x.d2c((y[We]||[])[v])},Q=1/0,te=-1/0;for(v=0;v<y._length;v++){var ie=H[v];if(t(ie)){if((D={}).pos=D[S]=ie,w&&Y&&(D.orig_p=Y[v]),D.q1=J("q1"),D.med=J("median"),D.q3=J("q3"),N=[],ee&&h.isArrayOrTypedArray(ee[v]))for(b=0;b<ee[v].length;b++)(K=x.d2c(ee[v][b]))!==e&&(o(X={v:K,i:[v,b]},y,[v,b]),N.push(X));if(D.pts=N.sort(u),G=(U=D[T]=N.map(s)).length,D.med!==e&&D.q1!==e&&D.q3!==e&&D.med>=D.q1&&D.q3>=D.med){var ae=J("lowerfence");D.lf=ae!==e&&ae<=D.q1?ae:i(D,U,G);var he=J("upperfence");D.uf=he!==e&&he>=D.q3?he:c(D,U,G);var se=J("mean");D.mean=se!==e?se:G?h.mean(U,G):(D.q1+D.q3)/2;var de=J("sd");D.sd=se!==e&&de>=0?de:G?h.stdev(U,G,D.mean):D.q3-D.q1,D.lo=n(D),D.uo=a(D);var ue=J("notchspan");ue=ue!==e&&ue>0?ue:g(D,G),D.ln=D.med-ue,D.un=D.med+ue;var ve=D.lf,ke=D.uf;y.boxpoints&&U.length&&(ve=Math.min(ve,U[0]),ke=Math.max(ke,U[G-1])),y.notched&&(ve=Math.min(ve,D.ln),ke=Math.max(ke,D.un)),D.min=ve,D.max=ke}else{var Ee;h.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+D.q1,"median = "+D.med,"q3 = "+D.q3].join(`
`)),Ee=D.med!==e?D.med:D.q1!==e?D.q3!==e?(D.q1+D.q3)/2:D.q1:D.q3!==e?D.q3:0,D.med=Ee,D.q1=D.q3=Ee,D.lf=D.uf=Ee,D.mean=D.sd=Ee,D.ln=D.un=Ee,D.min=D.max=Ee}Q=Math.min(Q,D.min),te=Math.max(te,D.max),D.pts2=N.filter(W),M.push(D)}}y._extremes[x._id]=d.findExtremes(x,[Q,te],{padded:!0})}else{var be=x.makeCalcdata(y,T),xe=function(We,qe){for(var et=We.length,st=new Array(et+1),ct=0;ct<et;ct++)st[ct]=We[ct]-qe;return st[et]=We[et-1]+qe,st}(z,j),ce=z.length,ge=function(We){for(var qe=new Array(We),et=0;et<We;et++)qe[et]=[];return qe}(ce);for(v=0;v<y._length;v++)if(K=be[v],t(K)){var we=h.findBin(H[v],xe);we>=0&&we<ce&&(o(X={v:K,i:v},y,v),ge[we].push(X))}var Me=1/0,Se=-1/0,ze=y.quartilemethod,Fe=ze==="exclusive",Ye=ze==="inclusive";for(v=0;v<ce;v++)if(ge[v].length>0){var rt,Oe;(D={}).pos=D[S]=z[v],N=D.pts=ge[v].sort(u),G=(U=D[T]=N.map(s)).length,D.min=U[0],D.max=U[G-1],D.mean=h.mean(U,G),D.sd=h.stdev(U,G,D.mean),D.med=h.interp(U,.5),G%2&&(Fe||Ye)?(Fe?(rt=U.slice(0,G/2),Oe=U.slice(G/2+1)):Ye&&(rt=U.slice(0,G/2+1),Oe=U.slice(G/2)),D.q1=h.interp(rt,.5),D.q3=h.interp(Oe,.5)):(D.q1=h.interp(U,.25),D.q3=h.interp(U,.75)),D.lf=i(D,U,G),D.uf=c(D,U,G),D.lo=n(D),D.uo=a(D);var je=g(D,G);D.ln=D.med-je,D.un=D.med+je,Me=Math.min(Me,D.ln),Se=Math.max(Se,D.un),D.pts2=N.filter(W),M.push(D)}y._extremes[x._id]=d.findExtremes(x,y.notched?be.concat([Me,Se]):be,{padded:!0})}return function(We,qe){if(h.isArrayOrTypedArray(qe.selectedpoints))for(var et=0;et<We.length;et++){for(var st=We[et].pts||[],ct={},Pt=0;Pt<st.length;Pt++)ct[st[Pt].i]=Pt;h.tagSelected(st,qe,ct)}}(M,y),M.length>0?(M[0].t={num:E[P],dPos:j,posLetter:S,valLetter:T,labels:{med:f(p,"median:"),min:f(p,"min:"),q1:f(p,"q1:"),q3:f(p,"q3:"),max:f(p,"max:"),mean:y.boxmean==="sd"?f(p,"mean \xB1 \u03C3:"):f(p,"mean:"),lf:f(p,"lower fence:"),uf:f(p,"upper fence:")}},E[P]++,M):[{t:{empty:!0}}]};var l={text:"tx",hovertext:"htx"};function o(p,y,v){for(var b in l)h.isArrayOrTypedArray(y[b])&&(Array.isArray(v)?h.isArrayOrTypedArray(y[b][v[0]])&&(p[l[b]]=y[b][v[0]][v[1]]):p[l[b]]=y[b][v])}function u(p,y){return p.v-y.v}function s(p){return p.v}function i(p,y,v){return v===0?p.q1:Math.min(p.q1,y[Math.min(h.findBin(2.5*p.q1-1.5*p.q3,y,!0)+1,v-1)])}function c(p,y,v){return v===0?p.q3:Math.max(p.q3,y[Math.max(h.findBin(2.5*p.q3-1.5*p.q1,y),0)])}function n(p){return 4*p.q1-3*p.q3}function a(p){return 4*p.q3-3*p.q1}function g(p,y){return y===0?0:1.57*(p.q3-p.q1)/Math.sqrt(y)}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"fast-isnumeric":246}],952:[function(r,I,B){var t=r("../../plots/cartesian/axes"),d=r("../../lib"),m=r("../../plots/cartesian/constraints").getAxisGroup,h=["v","h"];function e(f,l,o,u){var s,i,c,n=l.calcdata,a=l._fullLayout,g=u._id,p=g.charAt(0),y=[],v=0;for(s=0;s<o.length;s++)for(c=n[o[s]],i=0;i<c.length;i++)y.push(u.c2l(c[i].pos,!0)),v+=(c[i].pts2||[]).length;if(y.length){var b=d.distinctVals(y);u.type!=="category"&&u.type!=="multicategory"||(b.minDiff=1);var x=b.minDiff/2;t.minDtick(u,b.minDiff,b.vals[0],!0);var T=a[f==="violin"?"_numViolins":"_numBoxes"],A=a[f+"mode"]==="group"&&T>1,S=1-a[f+"gap"],w=1-a[f+"groupgap"];for(s=0;s<o.length;s++){var E,k,L,M,P,D,N=(c=n[o[s]])[0].trace,U=c[0].t,G=N.width,X=N.side;if(G)E=k=M=G/2,L=0;else if(E=x,A){var K=m(a,u._id)+N.orientation,Z=(a._alignmentOpts[K]||{})[N.alignmentgroup]||{},H=Object.keys(Z.offsetGroups||{}).length,Y=H||T;k=E*S*w/Y,L=2*E*(((H?N._offsetIndex:U.num)+.5)/Y-.5)*S,M=E*S/Y}else k=E*S*w,L=0,M=E;U.dPos=E,U.bPos=L,U.bdPos=k,U.wHover=M;var $,z,j,W,ee,J,Q=L+k,te=Boolean(G);if(X==="positive"?(P=E*(G?1:.5),$=Q,D=$=L):X==="negative"?(P=$=L,D=E*(G?1:.5),z=Q):(P=D=E,$=z=Q),(N.boxpoints||N.points)&&v>0){var ie=N.pointpos,ae=N.jitter,he=N.marker.size/2,se=0;ie+ae>=0&&((se=Q*(ie+ae))>P?(te=!0,ee=he,j=se):se>$&&(ee=he,j=P)),se<=P&&(j=P);var de=0;ie-ae<=0&&((de=-Q*(ie-ae))>D?(te=!0,J=he,W=de):de>z&&(J=he,W=D)),de<=D&&(W=D)}else j=P,W=D;var ue=new Array(c.length);for(i=0;i<c.length;i++)ue[i]=c[i].pos;N._extremes[g]=t.findExtremes(u,ue,{padded:te,vpadminus:W,vpadplus:j,vpadLinearized:!0,ppadminus:{x:J,y:ee}[p],ppadplus:{x:ee,y:J}[p]})}}}I.exports={crossTraceCalc:function(f,l){for(var o=f.calcdata,u=l.xaxis,s=l.yaxis,i=0;i<h.length;i++){for(var c=h[i],n=c==="h"?s:u,a=[],g=0;g<o.length;g++){var p=o[g],y=p[0].t,v=p[0].trace;v.visible!==!0||v.type!=="box"&&v.type!=="candlestick"||y.empty||(v.orientation||"v")!==c||v.xaxis!==u._id||v.yaxis!==s._id||a.push(g)}e("box",f,a,n)}},setPositionOffset:e}},{"../../lib":787,"../../plots/cartesian/axes":838,"../../plots/cartesian/constraints":846}],953:[function(r,I,B){var t=r("../../lib"),d=r("../../registry"),m=r("../../components/color"),h=r("../scatter/period_defaults"),e=r("../bar/defaults").handleGroupingDefaults,f=r("../../plots/cartesian/axis_autotype"),l=r("./attributes");function o(s,i,c,n){function a(X){var K=0;return X&&X.length&&(K+=1,t.isArrayOrTypedArray(X[0])&&X[0].length&&(K+=1)),K}function g(X){return t.validate(s[X],l[X])}var p,y=c("y"),v=c("x");if(i.type==="box"){var b=c("q1"),x=c("median"),T=c("q3");i._hasPreCompStats=b&&b.length&&x&&x.length&&T&&T.length,p=Math.min(t.minRowLength(b),t.minRowLength(x),t.minRowLength(T))}var A,S,w=a(y),E=a(v),k=w&&t.minRowLength(y),L=E&&t.minRowLength(v),M=n.calendar,P={autotypenumbers:n.autotypenumbers};if(i._hasPreCompStats)switch(String(E)+String(w)){case"00":var D=g("x0")||g("dx");A=(g("y0")||g("dy"))&&!D?"h":"v",S=p;break;case"10":A="v",S=Math.min(p,L);break;case"20":A="h",S=Math.min(p,v.length);break;case"01":A="h",S=Math.min(p,k);break;case"02":A="v",S=Math.min(p,y.length);break;case"12":A="v",S=Math.min(p,L,y.length);break;case"21":A="h",S=Math.min(p,v.length,k);break;case"11":S=0;break;case"22":var N,U=!1;for(N=0;N<v.length;N++)if(f(v[N],M,P)==="category"){U=!0;break}if(U)A="v",S=Math.min(p,L,y.length);else{for(N=0;N<y.length;N++)if(f(y[N],M,P)==="category"){U=!0;break}U?(A="h",S=Math.min(p,v.length,k)):(A="v",S=Math.min(p,L,y.length))}}else w>0?(A="v",S=E>0?Math.min(L,k):Math.min(k)):E>0?(A="h",S=Math.min(L)):S=0;if(S){i._length=S;var G=c("orientation",A);i._hasPreCompStats?G==="v"&&E===0?(c("x0",0),c("dx",1)):G==="h"&&w===0&&(c("y0",0),c("dy",1)):G==="v"&&E===0?c("x0"):G==="h"&&w===0&&c("y0"),d.getComponentMethod("calendars","handleTraceDefaults")(s,i,["x","y"],n)}else i.visible=!1}function u(s,i,c,n){var a=n.prefix,g=t.coerce2(s,i,l,"marker.outliercolor"),p=c("marker.line.outliercolor"),y="outliers";i._hasPreCompStats?y="all":(g||p)&&(y="suspectedoutliers");var v=c(a+"points",y);v?(c("jitter",v==="all"?.3:0),c("pointpos",v==="all"?-1.5:0),c("marker.symbol"),c("marker.opacity"),c("marker.size"),c("marker.color",i.line.color),c("marker.line.color"),c("marker.line.width"),v==="suspectedoutliers"&&(c("marker.line.outliercolor",i.marker.color),c("marker.line.outlierwidth")),c("selected.marker.color"),c("unselected.marker.color"),c("selected.marker.size"),c("unselected.marker.size"),c("text"),c("hovertext")):delete i.marker;var b=c("hoveron");b!=="all"&&b.indexOf("points")===-1||c("hovertemplate"),t.coerceSelectionMarkerOpacity(i,c)}I.exports={supplyDefaults:function(s,i,c,n){function a(T,A){return t.coerce(s,i,l,T,A)}if(o(s,i,a,n),i.visible!==!1){h(s,i,n,a),a("xhoverformat"),a("yhoverformat");var g=i._hasPreCompStats;g&&(a("lowerfence"),a("upperfence")),a("line.color",(s.marker||{}).color||c),a("line.width"),a("fillcolor",m.addOpacity(i.line.color,.5));var p=!1;if(g){var y=a("mean"),v=a("sd");y&&y.length&&(p=!0,v&&v.length&&(p="sd"))}a("boxmean",p),a("whiskerwidth"),a("width"),a("quartilemethod");var b=!1;if(g){var x=a("notchspan");x&&x.length&&(b=!0)}else t.validate(s.notchwidth,l.notchwidth)&&(b=!0);a("notched",b)&&a("notchwidth"),u(s,i,a,{prefix:"box"})}},crossTraceDefaults:function(s,i){var c,n;function a(y){return t.coerce(n._input,n,l,y)}for(var g=0;g<s.length;g++){var p=(n=s[g]).type;p!=="box"&&p!=="violin"||(c=n._input,i[p+"mode"]==="group"&&e(c,n,i,a))}},handleSampleDefaults:o,handlePointsDefaults:u}},{"../../components/color":650,"../../lib":787,"../../plots/cartesian/axis_autotype":839,"../../registry":915,"../bar/defaults":929,"../scatter/period_defaults":1222,"./attributes":950}],954:[function(r,I,B){I.exports=function(t,d){return d.hoverOnBox&&(t.hoverOnBox=d.hoverOnBox),"xVal"in d&&(t.x=d.xVal),"yVal"in d&&(t.y=d.yVal),d.xa&&(t.xaxis=d.xa),d.ya&&(t.yaxis=d.ya),t}},{}],955:[function(r,I,B){var t=r("../../plots/cartesian/axes"),d=r("../../lib"),m=r("../../components/fx"),h=r("../../components/color"),e=d.fillText;function f(o,u,s,i){var c,n,a,g,p,y,v,b,x,T,A,S,w,E,k=o.cd,L=o.xa,M=o.ya,P=k[0].trace,D=k[0].t,N=P.type==="violin",U=[],G=D.bdPos,X=D.wHover,K=function(se){return a.c2l(se.pos)+D.bPos-a.c2l(y)};N&&P.side!=="both"?(P.side==="positive"&&(x=function(se){var de=K(se);return m.inbox(de,de+X,T)},S=G,w=0),P.side==="negative"&&(x=function(se){var de=K(se);return m.inbox(de-X,de,T)},S=0,w=G)):(x=function(se){var de=K(se);return m.inbox(de-X,de+X,T)},S=w=G),E=N?function(se){return m.inbox(se.span[0]-p,se.span[1]-p,T)}:function(se){return m.inbox(se.min-p,se.max-p,T)},P.orientation==="h"?(p=u,y=s,v=E,b=x,c="y",a=M,n="x",g=L):(p=s,y=u,v=x,b=E,c="x",a=L,n="y",g=M);var Z=Math.min(1,G/Math.abs(a.r2c(a.range[1])-a.r2c(a.range[0])));function H(se){return(v(se)+b(se))/2}T=o.maxHoverDistance-Z,A=o.maxSpikeDistance-Z;var Y=m.getDistanceFunction(i,v,b,H);if(m.getClosest(k,Y,o),o.index===!1)return[];var $=k[o.index],z=P.line.color,j=(P.marker||{}).color;h.opacity(z)&&P.line.width?o.color=z:h.opacity(j)&&P.boxpoints?o.color=j:o.color=P.fillcolor,o[c+"0"]=a.c2p($.pos+D.bPos-w,!0),o[c+"1"]=a.c2p($.pos+D.bPos+S,!0),o[c+"LabelVal"]=$.orig_p!==void 0?$.orig_p:$.pos;var W=c+"Spike";o.spikeDistance=H($)*A/T,o[W]=a.c2p($.pos,!0);var ee={},J=["med","q1","q3","min","max"];(P.boxmean||(P.meanline||{}).visible)&&J.push("mean"),(P.boxpoints||P.points)&&J.push("lf","uf");for(var Q=0;Q<J.length;Q++){var te=J[Q];if(te in $&&!($[te]in ee)){ee[$[te]]=!0;var ie=$[te],ae=g.c2p(ie,!0),he=d.extendFlat({},o);he.attr=te,he[n+"0"]=he[n+"1"]=ae,he[n+"LabelVal"]=ie,he[n+"Label"]=(D.labels?D.labels[te]+" ":"")+t.hoverLabelText(g,ie,P[n+"hoverformat"]),he.hoverOnBox=!0,te==="mean"&&"sd"in $&&P.boxmean==="sd"&&(he[n+"err"]=$.sd),o.name="",o.spikeDistance=void 0,o[W]=void 0,he.hovertemplate=!1,U.push(he)}}return U}function l(o,u,s){for(var i,c,n,a=o.cd,g=o.xa,p=o.ya,y=a[0].trace,v=g.c2p(u),b=p.c2p(s),x=m.quadrature(function(N){var U=Math.max(3,N.mrc||0);return Math.max(Math.abs(g.c2p(N.x)-v)-U,1-3/U)},function(N){var U=Math.max(3,N.mrc||0);return Math.max(Math.abs(p.c2p(N.y)-b)-U,1-3/U)}),T=!1,A=0;A<a.length;A++){c=a[A];for(var S=0;S<(c.pts||[]).length;S++){var w=x(n=c.pts[S]);w<=o.distance&&(o.distance=w,T=[A,S])}}if(!T)return!1;n=(c=a[T[0]]).pts[T[1]];var E=g.c2p(n.x,!0),k=p.c2p(n.y,!0),L=n.mrc||1;i=d.extendFlat({},o,{index:n.i,color:(y.marker||{}).color,name:y.name,x0:E-L,x1:E+L,y0:k-L,y1:k+L,spikeDistance:o.distance,hovertemplate:y.hovertemplate});var M,P=c.orig_p,D=P!==void 0?P:c.pos;return y.orientation==="h"?(M=p,i.xLabelVal=n.x,i.yLabelVal=D):(M=g,i.xLabelVal=D,i.yLabelVal=n.y),i[M._id.charAt(0)+"Spike"]=M.c2p(c.pos,!0),e(n,y,i),i}I.exports={hoverPoints:function(o,u,s,i){var c,n=o.cd[0].trace.hoveron,a=[];return n.indexOf("boxes")!==-1&&(a=a.concat(f(o,u,s,i))),n.indexOf("points")!==-1&&(c=l(o,u,s)),i==="closest"?c?[c]:a:(c&&a.push(c),a)},hoverOnBoxes:f,hoverOnPoints:l}},{"../../components/color":650,"../../components/fx":690,"../../lib":787,"../../plots/cartesian/axes":838}],956:[function(r,I,B){I.exports={attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults").supplyDefaults,crossTraceDefaults:r("./defaults").crossTraceDefaults,supplyLayoutDefaults:r("./layout_defaults").supplyLayoutDefaults,calc:r("./calc"),crossTraceCalc:r("./cross_trace_calc").crossTraceCalc,plot:r("./plot").plot,style:r("./style").style,styleOnSelect:r("./style").styleOnSelect,hoverPoints:r("./hover").hoverPoints,eventData:r("./event_data"),selectPoints:r("./select"),moduleType:"trace",name:"box",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"./attributes":950,"./calc":951,"./cross_trace_calc":952,"./defaults":953,"./event_data":954,"./hover":955,"./layout_attributes":957,"./layout_defaults":958,"./plot":959,"./select":960,"./style":961}],957:[function(r,I,B){I.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],958:[function(r,I,B){var t=r("../../registry"),d=r("../../lib"),m=r("./layout_attributes");function h(e,f,l,o,u){for(var s=u+"Layout",i=!1,c=0;c<l.length;c++){var n=l[c];if(t.traceIs(n,s)){i=!0;break}}i&&(o(u+"mode"),o(u+"gap"),o(u+"groupgap"))}I.exports={supplyLayoutDefaults:function(e,f,l){h(0,0,l,function(o,u){return d.coerce(e,f,m,o,u)},"box")},_supply:h}},{"../../lib":787,"../../registry":915,"./layout_attributes":957}],959:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../components/drawing");function h(l,o,u,s){var i,c,n=u.orientation==="h",a=o.val,g=o.pos,p=!!g.rangebreaks,y=s.bPos,v=s.wdPos||0,b=s.bPosPxOffset||0,x=u.whiskerwidth||0,T=u.notched||!1,A=T?1-2*u.notchwidth:1;Array.isArray(s.bdPos)?(i=s.bdPos[0],c=s.bdPos[1]):(i=s.bdPos,c=s.bdPos);var S=l.selectAll("path.box").data(u.type!=="violin"||u.box.visible?d.identity:[]);S.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),S.exit().remove(),S.each(function(w){if(w.empty)return"M0,0Z";var E=g.c2l(w.pos+y,!0),k=g.l2p(E-i)+b,L=g.l2p(E+c)+b,M=p?(k+L)/2:g.l2p(E)+b,P=u.whiskerwidth,D=p?k*P+(1-P)*M:g.l2p(E-v)+b,N=p?L*P+(1-P)*M:g.l2p(E+v)+b,U=g.l2p(E-i*A)+b,G=g.l2p(E+c*A)+b,X=a.c2p(w.q1,!0),K=a.c2p(w.q3,!0),Z=d.constrain(a.c2p(w.med,!0),Math.min(X,K)+1,Math.max(X,K)-1),H=w.lf===void 0||u.boxpoints===!1,Y=a.c2p(H?w.min:w.lf,!0),$=a.c2p(H?w.max:w.uf,!0),z=a.c2p(w.ln,!0),j=a.c2p(w.un,!0);n?t.select(this).attr("d","M"+Z+","+U+"V"+G+"M"+X+","+k+"V"+L+(T?"H"+z+"L"+Z+","+G+"L"+j+","+L:"")+"H"+K+"V"+k+(T?"H"+j+"L"+Z+","+U+"L"+z+","+k:"")+"ZM"+X+","+M+"H"+Y+"M"+K+","+M+"H"+$+(x===0?"":"M"+Y+","+D+"V"+N+"M"+$+","+D+"V"+N)):t.select(this).attr("d","M"+U+","+Z+"H"+G+"M"+k+","+X+"H"+L+(T?"V"+z+"L"+G+","+Z+"L"+L+","+j:"")+"V"+K+"H"+k+(T?"V"+j+"L"+U+","+Z+"L"+k+","+z:"")+"ZM"+M+","+X+"V"+Y+"M"+M+","+K+"V"+$+(x===0?"":"M"+D+","+Y+"H"+N+"M"+D+","+$+"H"+N))})}function e(l,o,u,s){var i=o.x,c=o.y,n=s.bdPos,a=s.bPos,g=u.boxpoints||u.points;d.seedPseudoRandom();var p=l.selectAll("g.points").data(g?function(v){return v.forEach(function(b){b.t=s,b.trace=u}),v}:[]);p.enter().append("g").attr("class","points"),p.exit().remove();var y=p.selectAll("path").data(function(v){var b,x,T=v.pts2,A=Math.max((v.max-v.min)/10,v.q3-v.q1),S=1e-9*A,w=.01*A,E=[],k=0;if(u.jitter){if(A===0)for(k=1,E=new Array(T.length),b=0;b<T.length;b++)E[b]=1;else for(b=0;b<T.length;b++){var L=Math.max(0,b-5),M=T[L].v,P=Math.min(T.length-1,b+5),D=T[P].v;g!=="all"&&(T[b].v<v.lf?D=Math.min(D,v.lf):M=Math.max(M,v.uf));var N=Math.sqrt(w*(P-L)/(D-M+S))||0;N=d.constrain(Math.abs(N),0,1),E.push(N),k=Math.max(N,k)}x=2*u.jitter/(k||1)}for(b=0;b<T.length;b++){var U=T[b],G=U.v,X=u.jitter?x*E[b]*(d.pseudoRandom()-.5):0,K=v.pos+a+n*(u.pointpos+X);u.orientation==="h"?(U.y=K,U.x=G):(U.x=K,U.y=G),g==="suspectedoutliers"&&G<v.uo&&G>v.lo&&(U.so=!0)}return T});y.enter().append("path").classed("point",!0),y.exit().remove(),y.call(m.translatePoints,i,c)}function f(l,o,u,s){var i,c,n=o.val,a=o.pos,g=!!a.rangebreaks,p=s.bPos,y=s.bPosPxOffset||0,v=u.boxmean||(u.meanline||{}).visible;Array.isArray(s.bdPos)?(i=s.bdPos[0],c=s.bdPos[1]):(i=s.bdPos,c=s.bdPos);var b=l.selectAll("path.mean").data(u.type==="box"&&u.boxmean||u.type==="violin"&&u.box.visible&&u.meanline.visible?d.identity:[]);b.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),b.exit().remove(),b.each(function(x){var T=a.c2l(x.pos+p,!0),A=a.l2p(T-i)+y,S=a.l2p(T+c)+y,w=g?(A+S)/2:a.l2p(T)+y,E=n.c2p(x.mean,!0),k=n.c2p(x.mean-x.sd,!0),L=n.c2p(x.mean+x.sd,!0);u.orientation==="h"?t.select(this).attr("d","M"+E+","+A+"V"+S+(v==="sd"?"m0,0L"+k+","+w+"L"+E+","+A+"L"+L+","+w+"Z":"")):t.select(this).attr("d","M"+A+","+E+"H"+S+(v==="sd"?"m0,0L"+w+","+k+"L"+A+","+E+"L"+w+","+L+"Z":""))})}I.exports={plot:function(l,o,u,s){var i=o.xaxis,c=o.yaxis;d.makeTraceGroups(s,u,"trace boxes").each(function(n){var a,g,p=t.select(this),y=n[0],v=y.t,b=y.trace;v.wdPos=v.bdPos*b.whiskerwidth,b.visible!==!0||v.empty?p.remove():(b.orientation==="h"?(a=c,g=i):(a=i,g=c),h(p,{pos:a,val:g},b,v),e(p,{x:i,y:c},b,v),f(p,{pos:a,val:g},b,v))})},plotBoxAndWhiskers:h,plotPoints:e,plotBoxMean:f}},{"../../components/drawing":672,"../../lib":787,"@plotly/d3":58}],960:[function(r,I,B){I.exports=function(t,d){var m,h,e=t.cd,f=t.xaxis,l=t.yaxis,o=[];if(d===!1)for(m=0;m<e.length;m++)for(h=0;h<(e[m].pts||[]).length;h++)e[m].pts[h].selected=0;else for(m=0;m<e.length;m++)for(h=0;h<(e[m].pts||[]).length;h++){var u=e[m].pts[h],s=f.c2p(u.x),i=l.c2p(u.y);d.contains([s,i],null,u.i,t)?(o.push({pointNumber:u.i,x:f.c2d(u.x),y:l.c2d(u.y)}),u.selected=1):u.selected=0}return o}},{}],961:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/color"),m=r("../../components/drawing");I.exports={style:function(h,e,f){var l=f||t.select(h).selectAll("g.trace.boxes");l.style("opacity",function(o){return o[0].trace.opacity}),l.each(function(o){var u=t.select(this),s=o[0].trace,i=s.line.width;function c(g,p,y,v){g.style("stroke-width",p+"px").call(d.stroke,y).call(d.fill,v)}var n=u.selectAll("path.box");if(s.type==="candlestick")n.each(function(g){if(!g.empty){var p=t.select(this),y=s[g.dir];c(p,y.line.width,y.line.color,y.fillcolor),p.style("opacity",s.selectedpoints&&!g.selected?.3:1)}});else{c(n,i,s.line.color,s.fillcolor),u.selectAll("path.mean").style({"stroke-width":i,"stroke-dasharray":2*i+"px,"+i+"px"}).call(d.stroke,s.line.color);var a=u.selectAll("path.point");m.pointStyle(a,s,h)}})},styleOnSelect:function(h,e,f){var l=e[0].trace,o=f.selectAll("path.point");l.selectedpoints?m.selectedPointStyle(o,l):m.pointStyle(o,l,h)}}},{"../../components/color":650,"../../components/drawing":672,"@plotly/d3":58}],962:[function(r,I,B){var t=r("../../lib").extendFlat,d=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=r("../ohlc/attributes"),h=r("../box/attributes");function e(f){return{line:{color:t({},h.line.color,{dflt:f}),width:h.line.width,editType:"style"},fillcolor:h.fillcolor,editType:"style"}}I.exports={xperiod:m.xperiod,xperiod0:m.xperiod0,xperiodalignment:m.xperiodalignment,xhoverformat:d("x"),yhoverformat:d("y"),x:m.x,open:m.open,high:m.high,low:m.low,close:m.close,line:{width:t({},h.line.width,{}),editType:"style"},increasing:e(m.increasing.line.color.dflt),decreasing:e(m.decreasing.line.color.dflt),text:m.text,hovertext:m.hovertext,whiskerwidth:t({},h.whiskerwidth,{dflt:0}),hoverlabel:m.hoverlabel}},{"../../lib":787,"../../plots/cartesian/axis_format_attributes":841,"../box/attributes":950,"../ohlc/attributes":1148}],963:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("../../plots/cartesian/align_period"),h=r("../ohlc/calc").calcCommon;function e(f,l,o,u){return{min:o,q1:Math.min(f,u),med:u,q3:Math.max(f,u),max:l}}I.exports=function(f,l){var o=f._fullLayout,u=d.getFromId(f,l.xaxis),s=d.getFromId(f,l.yaxis),i=u.makeCalcdata(l,"x"),c=m(l,u,"x",i).vals,n=h(f,l,i,c,s,e);return n.length?(t.extendFlat(n[0].t,{num:o._numBoxes,dPos:t.distinctVals(c).minDiff/2,posLetter:"x",valLetter:"y"}),o._numBoxes++,n):[{t:{empty:!0}}]}},{"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../ohlc/calc":1149}],964:[function(r,I,B){var t=r("../../lib"),d=r("../../components/color"),m=r("../ohlc/ohlc_defaults"),h=r("../scatter/period_defaults"),e=r("./attributes");function f(l,o,u,s){var i=u(s+".line.color");u(s+".line.width",o.line.width),u(s+".fillcolor",d.addOpacity(i,.5))}I.exports=function(l,o,u,s){function i(c,n){return t.coerce(l,o,e,c,n)}m(l,o,i,s)?(h(l,o,s,i,{x:!0}),i("xhoverformat"),i("yhoverformat"),i("line.width"),f(l,o,i,"increasing"),f(l,o,i,"decreasing"),i("text"),i("hovertext"),i("whiskerwidth"),s._requestRangeslider[o.xaxis]=!0):o.visible=!1}},{"../../components/color":650,"../../lib":787,"../ohlc/ohlc_defaults":1153,"../scatter/period_defaults":1222,"./attributes":962}],965:[function(r,I,B){I.exports={moduleType:"trace",name:"candlestick",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:r("./attributes"),layoutAttributes:r("../box/layout_attributes"),supplyLayoutDefaults:r("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:r("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("../box/plot").plot,layerName:"boxlayer",style:r("../box/style").style,hoverPoints:r("../ohlc/hover").hoverPoints,selectPoints:r("../ohlc/select")}},{"../../plots/cartesian":852,"../box/cross_trace_calc":952,"../box/layout_attributes":957,"../box/layout_defaults":958,"../box/plot":959,"../box/style":961,"../ohlc/hover":1151,"../ohlc/select":1155,"./attributes":962,"./calc":963,"./defaults":964}],966:[function(r,I,B){var t=r("./axis_defaults"),d=r("../../plot_api/plot_template");I.exports=function(m,h,e,f,l){f("a")||(f("da"),f("a0")),f("b")||(f("db"),f("b0")),function(o,u,s,i){["aaxis","baxis"].forEach(function(c){var n=c.charAt(0),a=o[c]||{},g=d.newContainer(u,c),p={tickfont:"x",id:n+"axis",letter:n,font:u.font,name:c,data:o[n],calendar:u.calendar,dfltColor:i,bgColor:s.paper_bgcolor,autotypenumbersDflt:s.autotypenumbers,fullLayout:s};t(a,g,p),g._categories=g._categories||[],o[c]||a.type==="-"||(o[c]={type:a.type})})}(m,h,e,l)}},{"../../plot_api/plot_template":827,"./axis_defaults":971}],967:[function(r,I,B){var t=r("../../lib").isArrayOrTypedArray;I.exports=function(d){return function m(h,e){if(!t(h)||e>=10)return null;for(var f=1/0,l=-1/0,o=h.length,u=0;u<o;u++){var s=h[u];if(t(s)){var i=m(s,e+1);i&&(f=Math.min(i[0],f),l=Math.max(i[1],l))}else f=Math.min(s,f),l=Math.max(s,l)}return[f,l]}(d,0)}},{"../../lib":787}],968:[function(r,I,B){var t=r("../../plots/font_attributes"),d=r("./axis_attributes"),m=r("../../components/color/attributes"),h=t({editType:"calc"});h.family.dflt='"Open Sans", verdana, arial, sans-serif',h.size.dflt=12,h.color.dflt=m.defaultLine,I.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:d,baxis:d,font:h,color:{valType:"color",dflt:m.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":649,"../../plots/font_attributes":867,"./axis_attributes":970}],969:[function(r,I,B){var t=r("../../lib").isArrayOrTypedArray;I.exports=function(d,m,h,e){var f,l,o,u,s,i,c,n,a,g,p,y,v,b=t(h)?"a":"b",x=(b==="a"?d.aaxis:d.baxis).smoothing,T=b==="a"?d.a2i:d.b2j,A=b==="a"?h:e,S=b==="a"?e:h,w=b==="a"?m.a.length:m.b.length,E=b==="a"?m.b.length:m.a.length,k=Math.floor(b==="a"?d.b2j(S):d.a2i(S)),L=b==="a"?function($){return d.evalxy([],$,k)}:function($){return d.evalxy([],k,$)};x&&(o=Math.max(0,Math.min(E-2,k)),u=k-o,l=b==="a"?function($,z){return d.dxydi([],$,o,z,u)}:function($,z){return d.dxydj([],o,$,u,z)});var M=T(A[0]),P=T(A[1]),D=M<P?1:-1,N=1e-8*(P-M),U=D>0?Math.floor:Math.ceil,G=D>0?Math.ceil:Math.floor,X=D>0?Math.min:Math.max,K=D>0?Math.max:Math.min,Z=U(M+N),H=G(P-N),Y=[[c=L(M)]];for(f=Z;f*D<H*D;f+=D)s=[],p=K(M,f),v=(y=X(P,f+D))-p,i=Math.max(0,Math.min(w-2,Math.floor(.5*(p+y)))),n=L(y),x&&(a=l(i,p-i),g=l(i,y-i),s.push([c[0]+a[0]/3*v,c[1]+a[1]/3*v]),s.push([n[0]-g[0]/3*v,n[1]-g[1]/3*v])),s.push(n),Y.push(s),c=n;return Y}},{"../../lib":787}],970:[function(r,I,B){var t=r("../../plots/font_attributes"),d=r("../../components/color/attributes"),m=r("../../plots/cartesian/layout_attributes"),h=r("../../plots/cartesian/axis_format_attributes").descriptionWithDates,e=r("../../plot_api/edit_types").overrideAll;I.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:t({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:m.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:t({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:h("tick label")},tickformatstops:e(m.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:d.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:d.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:t({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":649,"../../plot_api/edit_types":820,"../../plots/cartesian/axis_format_attributes":841,"../../plots/cartesian/layout_attributes":853,"../../plots/font_attributes":867}],971:[function(r,I,B){var t=r("./attributes"),d=r("../../components/color").addOpacity,m=r("../../registry"),h=r("../../lib"),e=r("../../plots/cartesian/tick_value_defaults"),f=r("../../plots/cartesian/tick_label_defaults"),l=r("../../plots/cartesian/category_order_defaults"),o=r("../../plots/cartesian/set_convert"),u=r("../../plots/cartesian/axis_autotype");I.exports=function(s,i,c){var n=c.letter,a=c.font||{},g=t[n+"axis"];function p(M,P){return h.coerce(s,i,g,M,P)}function y(M,P){return h.coerce2(s,i,g,M,P)}c.name&&(i._name=c.name,i._id=c.name),p("autotypenumbers",c.autotypenumbersDflt);var v=p("type");v==="-"&&(c.data&&function(M,P){if(M.type==="-"){var D=M._id.charAt(0),N=M[D+"calendar"];M.type=u(P,N,{autotypenumbers:M.autotypenumbers})}}(i,c.data),i.type==="-"?i.type="linear":v=s.type=i.type),p("smoothing"),p("cheatertype"),p("showticklabels"),p("labelprefix",n+" = "),p("labelsuffix"),p("showtickprefix"),p("showticksuffix"),p("separatethousands"),p("tickformat"),p("exponentformat"),p("minexponent"),p("showexponent"),p("categoryorder"),p("tickmode"),p("tickvals"),p("ticktext"),p("tick0"),p("dtick"),i.tickmode==="array"&&(p("arraytick0"),p("arraydtick")),p("labelpadding"),i._hovertitle=n,v==="date"&&m.getComponentMethod("calendars","handleDefaults")(s,i,"calendar",c.calendar),o(i,c.fullLayout),i.c2p=h.identity;var b=p("color",c.dfltColor),x=b===s.color?b:a.color;p("title.text")&&(h.coerceFont(p,"title.font",{family:a.family,size:h.bigFont(a.size),color:x}),p("title.offset")),p("tickangle"),p("autorange",!i.isValidRange(s.range))&&p("rangemode"),p("range"),i.cleanRange(),p("fixedrange"),e(s,i,p,v),f(s,i,p,v,c),l(s,i,p,{data:c.data,dataAttr:n});var T=y("gridcolor",d(b,.3)),A=y("gridwidth"),S=p("showgrid");S||(delete i.gridcolor,delete i.gridwidth);var w=y("startlinecolor",b),E=y("startlinewidth",A);p("startline",i.showgrid||!!w||!!E)||(delete i.startlinecolor,delete i.startlinewidth);var k=y("endlinecolor",b),L=y("endlinewidth",A);return p("endline",i.showgrid||!!k||!!L)||(delete i.endlinecolor,delete i.endlinewidth),S?(p("minorgridcount"),p("minorgridwidth",A),p("minorgridcolor",d(T,.06)),i.minorgridcount||(delete i.minorgridwidth,delete i.minorgridcolor)):(delete i.gridcolor,delete i.gridWidth),i.showticklabels==="none"&&(delete i.tickfont,delete i.tickangle,delete i.showexponent,delete i.exponentformat,delete i.minexponent,delete i.tickformat,delete i.showticksuffix,delete i.showtickprefix),i.showticksuffix||delete i.ticksuffix,i.showtickprefix||delete i.tickprefix,p("tickmode"),i}},{"../../components/color":650,"../../lib":787,"../../plots/cartesian/axis_autotype":839,"../../plots/cartesian/category_order_defaults":843,"../../plots/cartesian/set_convert":859,"../../plots/cartesian/tick_label_defaults":860,"../../plots/cartesian/tick_value_defaults":862,"../../registry":915,"./attributes":968}],972:[function(r,I,B){var t=r("../../plots/cartesian/axes"),d=r("../../lib").isArray1D,m=r("./cheater_basis"),h=r("./array_minmax"),e=r("./calc_gridlines"),f=r("./calc_labels"),l=r("./calc_clippath"),o=r("../heatmap/clean_2d_array"),u=r("./smooth_fill_2d_array"),s=r("../heatmap/convert_column_xyz"),i=r("./set_convert");I.exports=function(c,n){var a=t.getFromId(c,n.xaxis),g=t.getFromId(c,n.yaxis),p=n.aaxis,y=n.baxis,v=n.x,b=n.y,x=[];v&&d(v)&&x.push("x"),b&&d(b)&&x.push("y"),x.length&&s(n,p,y,"a","b",x);var T=n._a=n._a||n.a,A=n._b=n._b||n.b;v=n._x||n.x,b=n._y||n.y;var S={};if(n._cheater){var w=p.cheatertype==="index"?T.length:T,E=y.cheatertype==="index"?A.length:A;v=m(w,E,n.cheaterslope)}n._x=v=o(v),n._y=b=o(b),u(v,T,A),u(b,T,A),i(n),n.setScale();var k=h(v),L=h(b),M=.5*(k[1]-k[0]),P=.5*(k[1]+k[0]),D=.5*(L[1]-L[0]),N=.5*(L[1]+L[0]);return k=[P-1.3*M,P+1.3*M],L=[N-1.3*D,N+1.3*D],n._extremes[a._id]=t.findExtremes(a,k,{padded:!0}),n._extremes[g._id]=t.findExtremes(g,L,{padded:!0}),e(n,"a","b"),e(n,"b","a"),f(n,p),f(n,y),S.clipsegments=l(n._xctrl,n._yctrl,p,y),S.x=v,S.y=b,S.a=T,S.b=A,[S]}},{"../../lib":787,"../../plots/cartesian/axes":838,"../heatmap/clean_2d_array":1071,"../heatmap/convert_column_xyz":1073,"./array_minmax":967,"./calc_clippath":973,"./calc_gridlines":974,"./calc_labels":975,"./cheater_basis":977,"./set_convert":990,"./smooth_fill_2d_array":991}],973:[function(r,I,B){I.exports=function(t,d,m,h){var e,f,l,o=[],u=!!m.smoothing,s=!!h.smoothing,i=t[0].length-1,c=t.length-1;for(e=0,f=[],l=[];e<=i;e++)f[e]=t[0][e],l[e]=d[0][e];for(o.push({x:f,y:l,bicubic:u}),e=0,f=[],l=[];e<=c;e++)f[e]=t[e][i],l[e]=d[e][i];for(o.push({x:f,y:l,bicubic:s}),e=i,f=[],l=[];e>=0;e--)f[i-e]=t[c][e],l[i-e]=d[c][e];for(o.push({x:f,y:l,bicubic:u}),e=c,f=[],l=[];e>=0;e--)f[c-e]=t[e][0],l[c-e]=d[e][0];return o.push({x:f,y:l,bicubic:s}),o}},{}],974:[function(r,I,B){var t=r("../../plots/cartesian/axes"),d=r("../../lib/extend").extendFlat;I.exports=function(m,h,e){var f,l,o,u,s,i,c,n,a,g,p,y,v,b,x=m["_"+h],T=m[h+"axis"],A=T._gridlines=[],S=T._minorgridlines=[],w=T._boundarylines=[],E=m["_"+e],k=m[e+"axis"];T.tickmode==="array"&&(T.tickvals=x.slice());var L=m._xctrl,M=m._yctrl,P=L[0].length,D=L.length,N=m._a.length,U=m._b.length;t.prepTicks(T),T.tickmode==="array"&&delete T.tickvals;var G=T.smoothing?3:1;function X(Z){var H,Y,$,z,j,W,ee,J,Q,te,ie,ae,he=[],se=[],de={};if(h==="b")for(Y=m.b2j(Z),$=Math.floor(Math.max(0,Math.min(U-2,Y))),z=Y-$,de.length=U,de.crossLength=N,de.xy=function(ue){return m.evalxy([],ue,Y)},de.dxy=function(ue,ve){return m.dxydi([],ue,$,ve,z)},H=0;H<N;H++)W=Math.min(N-2,H),ee=H-W,J=m.evalxy([],H,Y),k.smoothing&&H>0&&(Q=m.dxydi([],H-1,$,0,z),he.push(j[0]+Q[0]/3),se.push(j[1]+Q[1]/3),te=m.dxydi([],H-1,$,1,z),he.push(J[0]-te[0]/3),se.push(J[1]-te[1]/3)),he.push(J[0]),se.push(J[1]),j=J;else for(H=m.a2i(Z),W=Math.floor(Math.max(0,Math.min(N-2,H))),ee=H-W,de.length=N,de.crossLength=U,de.xy=function(ue){return m.evalxy([],H,ue)},de.dxy=function(ue,ve){return m.dxydj([],W,ue,ee,ve)},Y=0;Y<U;Y++)$=Math.min(U-2,Y),z=Y-$,J=m.evalxy([],H,Y),k.smoothing&&Y>0&&(ie=m.dxydj([],W,Y-1,ee,0),he.push(j[0]+ie[0]/3),se.push(j[1]+ie[1]/3),ae=m.dxydj([],W,Y-1,ee,1),he.push(J[0]-ae[0]/3),se.push(J[1]-ae[1]/3)),he.push(J[0]),se.push(J[1]),j=J;return de.axisLetter=h,de.axis=T,de.crossAxis=k,de.value=Z,de.constvar=e,de.index=n,de.x=he,de.y=se,de.smoothing=k.smoothing,de}function K(Z){var H,Y,$,z,j,W=[],ee=[],J={};if(J.length=x.length,J.crossLength=E.length,h==="b")for($=Math.max(0,Math.min(U-2,Z)),j=Math.min(1,Math.max(0,Z-$)),J.xy=function(Q){return m.evalxy([],Q,Z)},J.dxy=function(Q,te){return m.dxydi([],Q,$,te,j)},H=0;H<P;H++)W[H]=L[Z*G][H],ee[H]=M[Z*G][H];else for(Y=Math.max(0,Math.min(N-2,Z)),z=Math.min(1,Math.max(0,Z-Y)),J.xy=function(Q){return m.evalxy([],Z,Q)},J.dxy=function(Q,te){return m.dxydj([],Y,Q,z,te)},H=0;H<D;H++)W[H]=L[H][Z*G],ee[H]=M[H][Z*G];return J.axisLetter=h,J.axis=T,J.crossAxis=k,J.value=x[Z],J.constvar=e,J.index=Z,J.x=W,J.y=ee,J.smoothing=k.smoothing,J}if(T.tickmode==="array"){for(u=5e-15,i=(s=[Math.floor((x.length-1-T.arraytick0)/T.arraydtick*(1+u)),Math.ceil(-T.arraytick0/T.arraydtick/(1+u))].sort(function(Z,H){return Z-H}))[0]-1,c=s[1]+1,n=i;n<c;n++)(l=T.arraytick0+T.arraydtick*n)<0||l>x.length-1||A.push(d(K(l),{color:T.gridcolor,width:T.gridwidth}));for(n=i;n<c;n++)if(o=T.arraytick0+T.arraydtick*n,p=Math.min(o+T.arraydtick,x.length-1),!(o<0||o>x.length-1||p<0||p>x.length-1))for(y=x[o],v=x[p],f=0;f<T.minorgridcount;f++)(b=p-o)<=0||(g=y+(v-y)*(f+1)/(T.minorgridcount+1)*(T.arraydtick/b))<x[0]||g>x[x.length-1]||S.push(d(X(g),{color:T.minorgridcolor,width:T.minorgridwidth}));T.startline&&w.push(d(K(0),{color:T.startlinecolor,width:T.startlinewidth})),T.endline&&w.push(d(K(x.length-1),{color:T.endlinecolor,width:T.endlinewidth}))}else{for(u=5e-15,i=(s=[Math.floor((x[x.length-1]-T.tick0)/T.dtick*(1+u)),Math.ceil((x[0]-T.tick0)/T.dtick/(1+u))].sort(function(Z,H){return Z-H}))[0],c=s[1],n=i;n<=c;n++)a=T.tick0+T.dtick*n,A.push(d(X(a),{color:T.gridcolor,width:T.gridwidth}));for(n=i-1;n<c+1;n++)for(a=T.tick0+T.dtick*n,f=0;f<T.minorgridcount;f++)(g=a+T.dtick*(f+1)/(T.minorgridcount+1))<x[0]||g>x[x.length-1]||S.push(d(X(g),{color:T.minorgridcolor,width:T.minorgridwidth}));T.startline&&w.push(d(X(x[0]),{color:T.startlinecolor,width:T.startlinewidth})),T.endline&&w.push(d(X(x[x.length-1]),{color:T.endlinecolor,width:T.endlinewidth}))}}},{"../../lib/extend":777,"../../plots/cartesian/axes":838}],975:[function(r,I,B){var t=r("../../plots/cartesian/axes"),d=r("../../lib/extend").extendFlat;I.exports=function(m,h){var e,f,l,o=h._labels=[],u=h._gridlines;for(e=0;e<u.length;e++)l=u[e],["start","both"].indexOf(h.showticklabels)!==-1&&(f=t.tickText(h,l.value),d(f,{prefix:void 0,suffix:void 0,endAnchor:!0,xy:l.xy(0),dxy:l.dxy(0,0),axis:l.axis,length:l.crossAxis.length,font:l.axis.tickfont,isFirst:e===0,isLast:e===u.length-1}),o.push(f)),["end","both"].indexOf(h.showticklabels)!==-1&&(f=t.tickText(h,l.value),d(f,{endAnchor:!1,xy:l.xy(l.crossLength-1),dxy:l.dxy(l.crossLength-2,1),axis:l.axis,length:l.crossAxis.length,font:l.axis.tickfont,isFirst:e===0,isLast:e===u.length-1}),o.push(f))}},{"../../lib/extend":777,"../../plots/cartesian/axes":838}],976:[function(r,I,B){I.exports=function(t,d,m,h){var e=t[0]-d[0],f=t[1]-d[1],l=m[0]-d[0],o=m[1]-d[1],u=Math.pow(e*e+f*f,.25),s=Math.pow(l*l+o*o,.25),i=(s*s*e-u*u*l)*h,c=(s*s*f-u*u*o)*h,n=s*(u+s)*3,a=u*(u+s)*3;return[[d[0]+(n&&i/n),d[1]+(n&&c/n)],[d[0]-(a&&i/a),d[1]-(a&&c/a)]]}},{}],977:[function(r,I,B){var t=r("../../lib").isArrayOrTypedArray;I.exports=function(d,m,h){var e,f,l,o,u,s,i=[],c=t(d)?d.length:d,n=t(m)?m.length:m,a=t(d)?d:null,g=t(m)?m:null;a&&(l=(a.length-1)/(a[a.length-1]-a[0])/(c-1)),g&&(o=(g.length-1)/(g[g.length-1]-g[0])/(n-1));var p=1/0,y=-1/0;for(f=0;f<n;f++)for(i[f]=[],u=g?(g[f]-g[0])*o:f/(n-1),e=0;e<c;e++)s=(a?(a[e]-a[0])*l:e/(c-1))-u*h,p=Math.min(s,p),y=Math.max(s,y),i[f][e]=s;var v=1/(y-p),b=-p*v;for(f=0;f<n;f++)for(e=0;e<c;e++)i[f][e]=v*i[f][e]+b;return i}},{"../../lib":787}],978:[function(r,I,B){var t=r("./catmull_rom"),d=r("../../lib").ensureArray;function m(h,e,f){var l=-.5*f[0]+1.5*e[0],o=-.5*f[1]+1.5*e[1];return[(2*l+h[0])/3,(2*o+h[1])/3]}I.exports=function(h,e,f,l,o,u){var s,i,c,n,a,g,p,y,v,b,x=f[0].length,T=f.length,A=o?3*x-2:x,S=u?3*T-2:T;for(h=d(h,S),e=d(e,S),c=0;c<S;c++)h[c]=d(h[c],A),e[c]=d(e[c],A);for(i=0,n=0;i<T;i++,n+=u?3:1)for(a=h[n],g=e[n],p=f[i],y=l[i],s=0,c=0;s<x;s++,c+=o?3:1)a[c]=p[s],g[c]=y[s];if(o)for(i=0,n=0;i<T;i++,n+=u?3:1){for(s=1,c=3;s<x-1;s++,c+=3)v=t([f[i][s-1],l[i][s-1]],[f[i][s],l[i][s]],[f[i][s+1],l[i][s+1]],o),h[n][c-1]=v[0][0],e[n][c-1]=v[0][1],h[n][c+1]=v[1][0],e[n][c+1]=v[1][1];b=m([h[n][0],e[n][0]],[h[n][2],e[n][2]],[h[n][3],e[n][3]]),h[n][1]=b[0],e[n][1]=b[1],b=m([h[n][A-1],e[n][A-1]],[h[n][A-3],e[n][A-3]],[h[n][A-4],e[n][A-4]]),h[n][A-2]=b[0],e[n][A-2]=b[1]}if(u)for(c=0;c<A;c++){for(n=3;n<S-3;n+=3)v=t([h[n-3][c],e[n-3][c]],[h[n][c],e[n][c]],[h[n+3][c],e[n+3][c]],u),h[n-1][c]=v[0][0],e[n-1][c]=v[0][1],h[n+1][c]=v[1][0],e[n+1][c]=v[1][1];b=m([h[0][c],e[0][c]],[h[2][c],e[2][c]],[h[3][c],e[3][c]]),h[1][c]=b[0],e[1][c]=b[1],b=m([h[S-1][c],e[S-1][c]],[h[S-3][c],e[S-3][c]],[h[S-4][c],e[S-4][c]]),h[S-2][c]=b[0],e[S-2][c]=b[1]}if(o&&u)for(n=1;n<S;n+=(n+1)%3==0?2:1){for(c=3;c<A-3;c+=3)v=t([h[n][c-3],e[n][c-3]],[h[n][c],e[n][c]],[h[n][c+3],e[n][c+3]],o),h[n][c-1]=.5*(h[n][c-1]+v[0][0]),e[n][c-1]=.5*(e[n][c-1]+v[0][1]),h[n][c+1]=.5*(h[n][c+1]+v[1][0]),e[n][c+1]=.5*(e[n][c+1]+v[1][1]);b=m([h[n][0],e[n][0]],[h[n][2],e[n][2]],[h[n][3],e[n][3]]),h[n][1]=.5*(h[n][1]+b[0]),e[n][1]=.5*(e[n][1]+b[1]),b=m([h[n][A-1],e[n][A-1]],[h[n][A-3],e[n][A-3]],[h[n][A-4],e[n][A-4]]),h[n][A-2]=.5*(h[n][A-2]+b[0]),e[n][A-2]=.5*(e[n][A-2]+b[1])}return[h,e]}},{"../../lib":787,"./catmull_rom":976}],979:[function(r,I,B){I.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],980:[function(r,I,B){I.exports=function(t,d,m){return d&&m?function(h,e,f,l,o){var u,s,i,c,n,a;h||(h=[]),e*=3,f*=3;var g=l*l,p=1-l,y=p*p,v=p*l*2,b=-3*y,x=3*(y-v),T=3*(v-g),A=3*g,S=o*o,w=S*o,E=1-o,k=E*E,L=k*E;for(a=0;a<t.length;a++)u=b*(n=t[a])[f][e]+x*n[f][e+1]+T*n[f][e+2]+A*n[f][e+3],s=b*n[f+1][e]+x*n[f+1][e+1]+T*n[f+1][e+2]+A*n[f+1][e+3],i=b*n[f+2][e]+x*n[f+2][e+1]+T*n[f+2][e+2]+A*n[f+2][e+3],c=b*n[f+3][e]+x*n[f+3][e+1]+T*n[f+3][e+2]+A*n[f+3][e+3],h[a]=L*u+3*(k*o*s+E*S*i)+w*c;return h}:d?function(h,e,f,l,o){var u,s,i,c;h||(h=[]),e*=3;var n=l*l,a=1-l,g=a*a,p=a*l*2,y=-3*g,v=3*(g-p),b=3*(p-n),x=3*n,T=1-o;for(i=0;i<t.length;i++)u=y*(c=t[i])[f][e]+v*c[f][e+1]+b*c[f][e+2]+x*c[f][e+3],s=y*c[f+1][e]+v*c[f+1][e+1]+b*c[f+1][e+2]+x*c[f+1][e+3],h[i]=T*u+o*s;return h}:m?function(h,e,f,l,o){var u,s,i,c,n,a;h||(h=[]),f*=3;var g=o*o,p=g*o,y=1-o,v=y*y,b=v*y;for(n=0;n<t.length;n++)u=(a=t[n])[f][e+1]-a[f][e],s=a[f+1][e+1]-a[f+1][e],i=a[f+2][e+1]-a[f+2][e],c=a[f+3][e+1]-a[f+3][e],h[n]=b*u+3*(v*o*s+y*g*i)+p*c;return h}:function(h,e,f,l,o){var u,s,i,c;h||(h=[]);var n=1-o;for(i=0;i<t.length;i++)u=(c=t[i])[f][e+1]-c[f][e],s=c[f+1][e+1]-c[f+1][e],h[i]=n*u+o*s;return h}}},{}],981:[function(r,I,B){I.exports=function(t,d,m){return d&&m?function(h,e,f,l,o){var u,s,i,c,n,a;h||(h=[]),e*=3,f*=3;var g=l*l,p=g*l,y=1-l,v=y*y,b=v*y,x=o*o,T=1-o,A=T*T,S=T*o*2,w=-3*A,E=3*(A-S),k=3*(S-x),L=3*x;for(a=0;a<t.length;a++)u=w*(n=t[a])[f][e]+E*n[f+1][e]+k*n[f+2][e]+L*n[f+3][e],s=w*n[f][e+1]+E*n[f+1][e+1]+k*n[f+2][e+1]+L*n[f+3][e+1],i=w*n[f][e+2]+E*n[f+1][e+2]+k*n[f+2][e+2]+L*n[f+3][e+2],c=w*n[f][e+3]+E*n[f+1][e+3]+k*n[f+2][e+3]+L*n[f+3][e+3],h[a]=b*u+3*(v*l*s+y*g*i)+p*c;return h}:d?function(h,e,f,l,o){var u,s,i,c,n,a;h||(h=[]),e*=3;var g=o*o,p=g*o,y=1-o,v=y*y,b=v*y;for(n=0;n<t.length;n++)u=(a=t[n])[f+1][e]-a[f][e],s=a[f+1][e+1]-a[f][e+1],i=a[f+1][e+2]-a[f][e+2],c=a[f+1][e+3]-a[f][e+3],h[n]=b*u+3*(v*o*s+y*g*i)+p*c;return h}:m?function(h,e,f,l,o){var u,s,i,c;h||(h=[]),f*=3;var n=1-l,a=o*o,g=1-o,p=g*g,y=g*o*2,v=-3*p,b=3*(p-y),x=3*(y-a),T=3*a;for(i=0;i<t.length;i++)u=v*(c=t[i])[f][e]+b*c[f+1][e]+x*c[f+2][e]+T*c[f+3][e],s=v*c[f][e+1]+b*c[f+1][e+1]+x*c[f+2][e+1]+T*c[f+3][e+1],h[i]=n*u+l*s;return h}:function(h,e,f,l,o){var u,s,i,c;h||(h=[]);var n=1-l;for(i=0;i<t.length;i++)u=(c=t[i])[f+1][e]-c[f][e],s=c[f+1][e+1]-c[f][e+1],h[i]=n*u+l*s;return h}}},{}],982:[function(r,I,B){I.exports=function(t,d,m,h,e){var f=d-2,l=m-2;return h&&e?function(o,u,s){var i,c,n,a,g,p;o||(o=[]);var y=Math.max(0,Math.min(Math.floor(u),f)),v=Math.max(0,Math.min(Math.floor(s),l)),b=Math.max(0,Math.min(1,u-y)),x=Math.max(0,Math.min(1,s-v));y*=3,v*=3;var T=b*b,A=T*b,S=1-b,w=S*S,E=w*S,k=x*x,L=k*x,M=1-x,P=M*M,D=P*M;for(p=0;p<t.length;p++)i=E*(g=t[p])[v][y]+3*(w*b*g[v][y+1]+S*T*g[v][y+2])+A*g[v][y+3],c=E*g[v+1][y]+3*(w*b*g[v+1][y+1]+S*T*g[v+1][y+2])+A*g[v+1][y+3],n=E*g[v+2][y]+3*(w*b*g[v+2][y+1]+S*T*g[v+2][y+2])+A*g[v+2][y+3],a=E*g[v+3][y]+3*(w*b*g[v+3][y+1]+S*T*g[v+3][y+2])+A*g[v+3][y+3],o[p]=D*i+3*(P*x*c+M*k*n)+L*a;return o}:h?function(o,u,s){o||(o=[]);var i,c,n,a,g,p,y=Math.max(0,Math.min(Math.floor(u),f)),v=Math.max(0,Math.min(Math.floor(s),l)),b=Math.max(0,Math.min(1,u-y)),x=Math.max(0,Math.min(1,s-v));y*=3;var T=b*b,A=T*b,S=1-b,w=S*S,E=w*S,k=1-x;for(g=0;g<t.length;g++)i=k*(p=t[g])[v][y]+x*p[v+1][y],c=k*p[v][y+1]+x*p[v+1][y+1],n=k*p[v][y+2]+x*p[v+1][y+1],a=k*p[v][y+3]+x*p[v+1][y+1],o[g]=E*i+3*(w*b*c+S*T*n)+A*a;return o}:e?function(o,u,s){o||(o=[]);var i,c,n,a,g,p,y=Math.max(0,Math.min(Math.floor(u),f)),v=Math.max(0,Math.min(Math.floor(s),l)),b=Math.max(0,Math.min(1,u-y)),x=Math.max(0,Math.min(1,s-v));v*=3;var T=x*x,A=T*x,S=1-x,w=S*S,E=w*S,k=1-b;for(g=0;g<t.length;g++)i=k*(p=t[g])[v][y]+b*p[v][y+1],c=k*p[v+1][y]+b*p[v+1][y+1],n=k*p[v+2][y]+b*p[v+2][y+1],a=k*p[v+3][y]+b*p[v+3][y+1],o[g]=E*i+3*(w*x*c+S*T*n)+A*a;return o}:function(o,u,s){o||(o=[]);var i,c,n,a,g=Math.max(0,Math.min(Math.floor(u),f)),p=Math.max(0,Math.min(Math.floor(s),l)),y=Math.max(0,Math.min(1,u-g)),v=Math.max(0,Math.min(1,s-p)),b=1-v,x=1-y;for(n=0;n<t.length;n++)i=x*(a=t[n])[p][g]+y*a[p][g+1],c=x*a[p+1][g]+y*a[p+1][g+1],o[n]=b*i+v*c;return o}}},{}],983:[function(r,I,B){var t=r("../../lib"),d=r("./xy_defaults"),m=r("./ab_defaults"),h=r("./attributes"),e=r("../../components/color/attributes");I.exports=function(f,l,o,u){function s(c,n){return t.coerce(f,l,h,c,n)}l._clipPathId="clip"+l.uid+"carpet";var i=s("color",e.defaultLine);t.coerceFont(s,"font"),s("carpet"),m(f,l,u,s,i),l.a&&l.b?(l.a.length<3&&(l.aaxis.smoothing=0),l.b.length<3&&(l.baxis.smoothing=0),d(f,l,s)||(l.visible=!1),l._cheater&&s("cheaterslope")):l.visible=!1}},{"../../components/color/attributes":649,"../../lib":787,"./ab_defaults":966,"./attributes":968,"./xy_defaults":992}],984:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),plot:r("./plot"),calc:r("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":852,"./attributes":968,"./calc":972,"./defaults":983,"./plot":989}],985:[function(r,I,B){I.exports=function(t,d){for(var m,h=t._fullData.length,e=0;e<h;e++){var f=t._fullData[e];if(f.index!==d.index&&f.type==="carpet"&&(m||(m=f),f.carpet===d.carpet))return f}return m}},{}],986:[function(r,I,B){I.exports=function(t,d,m){if(t.length===0)return"";var h,e=[],f=m?3:1;for(h=0;h<t.length;h+=f)e.push(t[h]+","+d[h]),m&&h<t.length-f&&(e.push("C"),e.push([t[h+1]+","+d[h+1],t[h+2]+","+d[h+2]+" "].join(" ")));return e.join(m?"":"L")}},{}],987:[function(r,I,B){var t=r("../../lib").isArrayOrTypedArray;I.exports=function(d,m,h){var e;for(t(d)?d.length>m.length&&(d=d.slice(0,m.length)):d=[],e=0;e<m.length;e++)d[e]=h(m[e]);return d}},{"../../lib":787}],988:[function(r,I,B){I.exports=function(t,d,m,h,e,f){var l=e[0]*t.dpdx(d),o=e[1]*t.dpdy(m),u=1,s=1;if(f){var i=Math.sqrt(e[0]*e[0]+e[1]*e[1]),c=Math.sqrt(f[0]*f[0]+f[1]*f[1]),n=(e[0]*f[0]+e[1]*f[1])/i/c;s=Math.max(0,n)}var a=180*Math.atan2(o,l)/Math.PI;return a<-90?(a+=180,u=-u):a>90&&(a-=180,u=-u),{angle:a,flip:u,p:t.c2p(h,d,m),offsetMultplier:s}}},{}],989:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/drawing"),m=r("./map_1d_array"),h=r("./makepath"),e=r("./orient_text"),f=r("../../lib/svg_text_utils"),l=r("../../lib"),o=l.strRotate,u=l.strTranslate,s=r("../../constants/alignment");function i(p,y,v,b,x,T){var A="const-"+x+"-lines",S=v.selectAll("."+A).data(T);S.enter().append("path").classed(A,!0).style("vector-effect","non-scaling-stroke"),S.each(function(w){var E=w,k=E.x,L=E.y,M=m([],k,p.c2p),P=m([],L,y.c2p),D="M"+h(M,P,E.smoothing);t.select(this).attr("d",D).style("stroke-width",E.width).style("stroke",E.color).style("fill","none")}),S.exit().remove()}function c(p,y,v,b,x,T,A,S){var w=T.selectAll("text."+S).data(A);w.enter().append("text").classed(S,!0);var E=0,k={};return w.each(function(L,M){var P;if(L.axis.tickangle==="auto")P=e(b,y,v,L.xy,L.dxy);else{var D=(L.axis.tickangle+180)*Math.PI/180;P=e(b,y,v,L.xy,[Math.cos(D),Math.sin(D)])}M||(k={angle:P.angle,flip:P.flip});var N=(L.endAnchor?-1:1)*P.flip,U=t.select(this).attr({"text-anchor":N>0?"start":"end","data-notex":1}).call(d.font,L.font).text(L.text).call(f.convertToTspans,p),G=d.bBox(this);U.attr("transform",u(P.p[0],P.p[1])+o(P.angle)+u(L.axis.labelpadding*N,.3*G.height)),E=Math.max(E,G.width+L.axis.labelpadding)}),w.exit().remove(),k.maxExtent=E,k}I.exports=function(p,y,v,b){var x=y.xaxis,T=y.yaxis,A=p._fullLayout._clips;l.makeTraceGroups(b,v,"trace").each(function(S){var w=t.select(this),E=S[0],k=E.trace,L=k.aaxis,M=k.baxis,P=l.ensureSingle(w,"g","minorlayer"),D=l.ensureSingle(w,"g","majorlayer"),N=l.ensureSingle(w,"g","boundarylayer"),U=l.ensureSingle(w,"g","labellayer");w.style("opacity",k.opacity),i(x,T,D,L,"a",L._gridlines),i(x,T,D,M,"b",M._gridlines),i(x,T,P,L,"a",L._minorgridlines),i(x,T,P,M,"b",M._minorgridlines),i(x,T,N,L,"a-boundary",L._boundarylines),i(x,T,N,M,"b-boundary",M._boundarylines);var G=c(p,x,T,k,E,U,L._labels,"a-label"),X=c(p,x,T,k,E,U,M._labels,"b-label");(function(K,Z,H,Y,$,z,j,W){var ee,J,Q,te,ie=l.aggNums(Math.min,null,H.a),ae=l.aggNums(Math.max,null,H.a),he=l.aggNums(Math.min,null,H.b),se=l.aggNums(Math.max,null,H.b);ee=.5*(ie+ae),J=he,Q=H.ab2xy(ee,J,!0),te=H.dxyda_rough(ee,J),j.angle===void 0&&l.extendFlat(j,e(H,$,z,Q,H.dxydb_rough(ee,J))),g(K,Z,H,Y,Q,te,H.aaxis,$,z,j,"a-title"),ee=ie,J=.5*(he+se),Q=H.ab2xy(ee,J,!0),te=H.dxydb_rough(ee,J),W.angle===void 0&&l.extendFlat(W,e(H,$,z,Q,H.dxyda_rough(ee,J))),g(K,Z,H,Y,Q,te,H.baxis,$,z,W,"b-title")})(p,U,k,E,x,T,G,X),function(K,Z,H,Y,$){var z,j,W,ee,J=H.select("#"+K._clipPathId);J.size()||(J=H.append("clipPath").classed("carpetclip",!0));var Q=l.ensureSingle(J,"path","carpetboundary"),te=Z.clipsegments,ie=[];for(ee=0;ee<te.length;ee++)z=te[ee],j=m([],z.x,Y.c2p),W=m([],z.y,$.c2p),ie.push(h(j,W,z.bicubic));var ae="M"+ie.join("L")+"Z";J.attr("id",K._clipPathId),Q.attr("d",ae)}(k,E,A,x,T)})};var n=s.LINE_SPACING,a=(1-s.MID_SHIFT)/n+1;function g(p,y,v,b,x,T,A,S,w,E,k){var L=[];A.title.text&&L.push(A.title.text);var M=y.selectAll("text."+k).data(L),P=E.maxExtent;M.enter().append("text").classed(k,!0),M.each(function(){var D=e(v,S,w,x,T);["start","both"].indexOf(A.showticklabels)===-1&&(P=0);var N=A.title.font.size;P+=N+A.title.offset;var U=(E.angle+(E.flip<0?180:0)-D.angle+450)%360,G=U>90&&U<270,X=t.select(this);X.text(A.title.text).call(f.convertToTspans,p),G&&(P=(-f.lineCount(X)+a)*n*N-P),X.attr("transform",u(D.p[0],D.p[1])+o(D.angle)+u(0,P)).attr("text-anchor","middle").call(d.font,A.title.font)}),M.exit().remove()}},{"../../components/drawing":672,"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"./makepath":986,"./map_1d_array":987,"./orient_text":988,"@plotly/d3":58}],990:[function(r,I,B){var t=r("./constants"),d=r("../../lib/search").findBin,m=r("./compute_control_points"),h=r("./create_spline_evaluator"),e=r("./create_i_derivative_evaluator"),f=r("./create_j_derivative_evaluator");I.exports=function(l){var o=l._a,u=l._b,s=o.length,i=u.length,c=l.aaxis,n=l.baxis,a=o[0],g=o[s-1],p=u[0],y=u[i-1],v=o[o.length-1]-o[0],b=u[u.length-1]-u[0],x=v*t.RELATIVE_CULL_TOLERANCE,T=b*t.RELATIVE_CULL_TOLERANCE;a-=x,g+=x,p-=T,y+=T,l.isVisible=function(A,S){return A>a&&A<g&&S>p&&S<y},l.isOccluded=function(A,S){return A<a||A>g||S<p||S>y},l.setScale=function(){var A=l._x,S=l._y,w=m(l._xctrl,l._yctrl,A,S,c.smoothing,n.smoothing);l._xctrl=w[0],l._yctrl=w[1],l.evalxy=h([l._xctrl,l._yctrl],s,i,c.smoothing,n.smoothing),l.dxydi=e([l._xctrl,l._yctrl],c.smoothing,n.smoothing),l.dxydj=f([l._xctrl,l._yctrl],c.smoothing,n.smoothing)},l.i2a=function(A){var S=Math.max(0,Math.floor(A[0]),s-2),w=A[0]-S;return(1-w)*o[S]+w*o[S+1]},l.j2b=function(A){var S=Math.max(0,Math.floor(A[1]),s-2),w=A[1]-S;return(1-w)*u[S]+w*u[S+1]},l.ij2ab=function(A){return[l.i2a(A[0]),l.j2b(A[1])]},l.a2i=function(A){var S=Math.max(0,Math.min(d(A,o),s-2)),w=o[S],E=o[S+1];return Math.max(0,Math.min(s-1,S+(A-w)/(E-w)))},l.b2j=function(A){var S=Math.max(0,Math.min(d(A,u),i-2)),w=u[S],E=u[S+1];return Math.max(0,Math.min(i-1,S+(A-w)/(E-w)))},l.ab2ij=function(A){return[l.a2i(A[0]),l.b2j(A[1])]},l.i2c=function(A,S){return l.evalxy([],A,S)},l.ab2xy=function(A,S,w){if(!w&&(A<o[0]||A>o[s-1]|S<u[0]||S>u[i-1]))return[!1,!1];var E=l.a2i(A),k=l.b2j(S),L=l.evalxy([],E,k);if(w){var M,P,D,N,U=0,G=0,X=[];A<o[0]?(M=0,P=0,U=(A-o[0])/(o[1]-o[0])):A>o[s-1]?(M=s-2,P=1,U=(A-o[s-1])/(o[s-1]-o[s-2])):P=E-(M=Math.max(0,Math.min(s-2,Math.floor(E)))),S<u[0]?(D=0,N=0,G=(S-u[0])/(u[1]-u[0])):S>u[i-1]?(D=i-2,N=1,G=(S-u[i-1])/(u[i-1]-u[i-2])):N=k-(D=Math.max(0,Math.min(i-2,Math.floor(k)))),U&&(l.dxydi(X,M,D,P,N),L[0]+=X[0]*U,L[1]+=X[1]*U),G&&(l.dxydj(X,M,D,P,N),L[0]+=X[0]*G,L[1]+=X[1]*G)}return L},l.c2p=function(A,S,w){return[S.c2p(A[0]),w.c2p(A[1])]},l.p2x=function(A,S,w){return[S.p2c(A[0]),w.p2c(A[1])]},l.dadi=function(A){var S=Math.max(0,Math.min(o.length-2,A));return o[S+1]-o[S]},l.dbdj=function(A){var S=Math.max(0,Math.min(u.length-2,A));return u[S+1]-u[S]},l.dxyda=function(A,S,w,E){var k=l.dxydi(null,A,S,w,E),L=l.dadi(A,w);return[k[0]/L,k[1]/L]},l.dxydb=function(A,S,w,E){var k=l.dxydj(null,A,S,w,E),L=l.dbdj(S,E);return[k[0]/L,k[1]/L]},l.dxyda_rough=function(A,S,w){var E=v*(w||.1),k=l.ab2xy(A+E,S,!0),L=l.ab2xy(A-E,S,!0);return[.5*(k[0]-L[0])/E,.5*(k[1]-L[1])/E]},l.dxydb_rough=function(A,S,w){var E=b*(w||.1),k=l.ab2xy(A,S+E,!0),L=l.ab2xy(A,S-E,!0);return[.5*(k[0]-L[0])/E,.5*(k[1]-L[1])/E]},l.dpdx=function(A){return A._m},l.dpdy=function(A){return A._m}}},{"../../lib/search":807,"./compute_control_points":978,"./constants":979,"./create_i_derivative_evaluator":980,"./create_j_derivative_evaluator":981,"./create_spline_evaluator":982}],991:[function(r,I,B){var t=r("../../lib");I.exports=function(d,m,h){var e,f,l,o=[],u=[],s=d[0].length,i=d.length;function c(Z,H){var Y,$=0,z=0;return Z>0&&(Y=d[H][Z-1])!==void 0&&(z++,$+=Y),Z<s-1&&(Y=d[H][Z+1])!==void 0&&(z++,$+=Y),H>0&&(Y=d[H-1][Z])!==void 0&&(z++,$+=Y),H<i-1&&(Y=d[H+1][Z])!==void 0&&(z++,$+=Y),$/Math.max(1,z)}var n,a,g,p,y,v,b,x,T,A,S,w=0;for(e=0;e<s;e++)for(f=0;f<i;f++)d[f][e]===void 0&&(o.push(e),u.push(f),d[f][e]=c(e,f)),w=Math.max(w,Math.abs(d[f][e]));if(!o.length)return d;var E=0,k=0,L=o.length;do{for(E=0,l=0;l<L;l++){e=o[l],f=u[l];var M,P,D,N,U,G,X=0,K=0;e===0?(D=m[U=Math.min(s-1,2)],N=m[1],M=d[f][U],K+=(P=d[f][1])+(P-M)*(m[0]-N)/(N-D),X++):e===s-1&&(D=m[U=Math.max(0,s-3)],N=m[s-2],M=d[f][U],K+=(P=d[f][s-2])+(P-M)*(m[s-1]-N)/(N-D),X++),(e===0||e===s-1)&&f>0&&f<i-1&&(n=h[f+1]-h[f],K+=((a=h[f]-h[f-1])*d[f+1][e]+n*d[f-1][e])/(a+n),X++),f===0?(D=h[G=Math.min(i-1,2)],N=h[1],M=d[G][e],K+=(P=d[1][e])+(P-M)*(h[0]-N)/(N-D),X++):f===i-1&&(D=h[G=Math.max(0,i-3)],N=h[i-2],M=d[G][e],K+=(P=d[i-2][e])+(P-M)*(h[i-1]-N)/(N-D),X++),(f===0||f===i-1)&&e>0&&e<s-1&&(n=m[e+1]-m[e],K+=((a=m[e]-m[e-1])*d[f][e+1]+n*d[f][e-1])/(a+n),X++),X?K/=X:(g=m[e+1]-m[e],p=m[e]-m[e-1],x=(y=h[f+1]-h[f])*(v=h[f]-h[f-1])*(y+v),K=((b=g*p*(g+p))*(v*d[f+1][e]+y*d[f-1][e])+x*(p*d[f][e+1]+g*d[f][e-1]))/(x*(p+g)+b*(v+y))),E+=(A=(T=K-d[f][e])/w)*A,S=X?0:.85,d[f][e]+=T*(1+S)}E=Math.sqrt(E)}while(k++<100&&E>1e-5);return t.log("Smoother converged to",E,"after",k,"iterations"),d}},{"../../lib":787}],992:[function(r,I,B){var t=r("../../lib").isArray1D;I.exports=function(d,m,h){var e=h("x"),f=e&&e.length,l=h("y"),o=l&&l.length;if(!f&&!o)return!1;if(m._cheater=!e,f&&!t(e)||o&&!t(l))m._length=null;else{var u=f?e.length:1/0;o&&(u=Math.min(u,l.length)),m.a&&m.a.length&&(u=Math.min(u,m.a.length)),m.b&&m.b.length&&(u=Math.min(u,m.b.length)),m._length=u}return!0}},{"../../lib":787}],993:[function(r,I,B){var t=r("../../plots/template_attributes").hovertemplateAttrs,d=r("../scattergeo/attributes"),m=r("../../components/colorscale/attributes"),h=r("../../plots/attributes"),e=r("../../components/color/attributes").defaultLine,f=r("../../lib/extend").extendFlat,l=d.marker.line;I.exports=f({locations:{valType:"data_array",editType:"calc"},locationmode:d.locationmode,z:{valType:"data_array",editType:"calc"},geojson:f({},d.geojson,{}),featureidkey:d.featureidkey,text:f({},d.text,{}),hovertext:f({},d.hovertext,{}),marker:{line:{color:f({},l.color,{dflt:e}),width:f({},l.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:d.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:d.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:f({},h.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:t(),showlegend:f({},h.showlegend,{dflt:!1})},m("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":649,"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scattergeo/attributes":1244}],994:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../constants/numerical").BADNUM,m=r("../../components/colorscale/calc"),h=r("../scatter/arrays_to_calcdata"),e=r("../scatter/calc_selection");function f(l){return l&&typeof l=="string"}I.exports=function(l,o){var u,s=o._length,i=new Array(s);u=o.geojson?function(p){return f(p)||t(p)}:f;for(var c=0;c<s;c++){var n=i[c]={},a=o.locations[c],g=o.z[c];u(a)&&t(g)?(n.loc=a,n.z=g):(n.loc=null,n.z=d),n.index=c}return h(i,o),m(l,o,{vals:o.z,containerStr:"",cLetter:"z"}),e(i,o),i}},{"../../components/colorscale/calc":658,"../../constants/numerical":763,"../scatter/arrays_to_calcdata":1201,"../scatter/calc_selection":1204,"fast-isnumeric":246}],995:[function(r,I,B){var t=r("../../lib"),d=r("../../components/colorscale/defaults"),m=r("./attributes");I.exports=function(h,e,f,l){function o(n,a){return t.coerce(h,e,m,n,a)}var u=o("locations"),s=o("z");if(u&&u.length&&t.isArrayOrTypedArray(s)&&s.length){e._length=Math.min(u.length,s.length);var i,c=o("geojson");(typeof c=="string"&&c!==""||t.isPlainObject(c))&&(i="geojson-id"),o("locationmode",i)==="geojson-id"&&o("featureidkey"),o("text"),o("hovertext"),o("hovertemplate"),o("marker.line.width")&&o("marker.line.color"),o("marker.opacity"),d(h,e,l,o,{prefix:"",cLetter:"z"}),t.coerceSelectionMarkerOpacity(e,o)}else e.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":993}],996:[function(r,I,B){I.exports=function(t,d,m,h,e){t.location=d.location,t.z=d.z;var f=h[e];return f.fIn&&f.fIn.properties&&(t.properties=f.fIn.properties),t.ct=f.ct,t}},{}],997:[function(r,I,B){var t=r("../../plots/cartesian/axes"),d=r("./attributes"),m=r("../../lib").fillText;I.exports=function(h,e,f){var l,o,u,s,i=h.cd,c=i[0].trace,n=h.subplot,a=[e,f],g=[e+360,f];for(o=0;o<i.length;o++)if(s=!1,(l=i[o])._polygons){for(u=0;u<l._polygons.length;u++)l._polygons[u].contains(a)&&(s=!s),l._polygons[u].contains(g)&&(s=!s);if(s)break}if(s&&l)return h.x0=h.x1=h.xa.c2p(l.ct),h.y0=h.y1=h.ya.c2p(l.ct),h.index=l.index,h.location=l.loc,h.z=l.z,h.zLabel=t.tickText(n.mockAxis,n.mockAxis.c2l(l.z),"hover").text,h.hovertemplate=l.hovertemplate,function(p,y,v){if(!y.hovertemplate){var b=v.hi||y.hoverinfo,x=String(v.loc),T=b==="all"?d.hoverinfo.flags:b.split("+"),A=T.indexOf("name")!==-1,S=T.indexOf("location")!==-1,w=T.indexOf("z")!==-1,E=T.indexOf("text")!==-1,k=[];!A&&S?p.nameOverride=x:(A&&(p.nameOverride=y.name),S&&k.push(x)),w&&k.push(p.zLabel),E&&m(v,y,k),p.extraText=k.join("<br>")}}(h,c,l),[h]}},{"../../lib":787,"../../plots/cartesian/axes":838,"./attributes":993}],998:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../heatmap/colorbar"),calc:r("./calc"),calcGeoJSON:r("./plot").calcGeoJSON,plot:r("./plot").plot,style:r("./style").style,styleOnSelect:r("./style").styleOnSelect,hoverPoints:r("./hover"),eventData:r("./event_data"),selectPoints:r("./select"),moduleType:"trace",name:"choropleth",basePlotModule:r("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":871,"../heatmap/colorbar":1072,"./attributes":993,"./calc":994,"./defaults":995,"./event_data":996,"./hover":997,"./plot":999,"./select":1e3,"./style":1001}],999:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../lib/geo_location_utils"),h=r("../../lib/topojson_utils").getTopojsonFeatures,e=r("../../plots/cartesian/autorange").findExtremes,f=r("./style").style;I.exports={calcGeoJSON:function(l,o){for(var u=l[0].trace,s=o[u.geo],i=s._subplot,c=u.locationmode,n=u._length,a=c==="geojson-id"?m.extractTraceFeature(l):h(u,i.topojson),g=[],p=[],y=0;y<n;y++){var v=l[y],b=c==="geojson-id"?v.fOut:m.locationToFeature(c,v.loc,a);if(b){v.geojson=b,v.ct=b.properties.ct,v._polygons=m.feature2polygons(b);var x=m.computeBbox(b);g.push(x[0],x[2]),p.push(x[1],x[3])}else v.geojson=null}if(s.fitbounds==="geojson"&&c==="geojson-id"){var T=m.computeBbox(m.getTraceGeojson(u));g=[T[0],T[2]],p=[T[1],T[3]]}var A={padded:!0};u._extremes.lon=e(s.lonaxis._ax,g,A),u._extremes.lat=e(s.lataxis._ax,p,A)},plot:function(l,o,u){var s=o.layers.backplot.select(".choroplethlayer");d.makeTraceGroups(s,u,"trace choropleth").each(function(i){var c=t.select(this).selectAll("path.choroplethlocation").data(d.identity);c.enter().append("path").classed("choroplethlocation",!0),c.exit().remove(),f(l,i)})}}},{"../../lib":787,"../../lib/geo_location_utils":780,"../../lib/topojson_utils":816,"../../plots/cartesian/autorange":837,"./style":1001,"@plotly/d3":58}],1e3:[function(r,I,B){I.exports=function(t,d){var m,h,e,f,l,o=t.cd,u=t.xaxis,s=t.yaxis,i=[];if(d===!1)for(m=0;m<o.length;m++)o[m].selected=0;else for(m=0;m<o.length;m++)(e=(h=o[m]).ct)&&(f=u.c2p(e),l=s.c2p(e),d.contains([f,l],null,m,t)?(i.push({pointNumber:m,lon:e[0],lat:e[1]}),h.selected=1):h.selected=0);return i}},{}],1001:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/color"),m=r("../../components/drawing"),h=r("../../components/colorscale");function e(f,l){var o=l[0].trace,u=l[0].node3.selectAll(".choroplethlocation"),s=o.marker||{},i=s.line||{},c=h.makeColorScaleFuncFromTrace(o);u.each(function(n){t.select(this).attr("fill",c(n.z)).call(d.stroke,n.mlc||i.color).call(m.dashLine,"",n.mlw||i.width||0).style("opacity",s.opacity)}),m.selectedPointStyle(u,o,f)}I.exports={style:function(f,l){l&&e(f,l)},styleOnSelect:function(f,l){var o=l[0].node3,u=l[0].trace;u.selectedpoints?m.selectedPointStyle(o.selectAll(".choroplethlocation"),u,f):e(f,l)}}},{"../../components/color":650,"../../components/colorscale":662,"../../components/drawing":672,"@plotly/d3":58}],1002:[function(r,I,B){var t=r("../choropleth/attributes"),d=r("../../components/colorscale/attributes"),m=r("../../plots/template_attributes").hovertemplateAttrs,h=r("../../plots/attributes"),e=r("../../lib/extend").extendFlat;I.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},t.featureidkey,{}),below:{valType:"string",editType:"plot"},text:t.text,hovertext:t.hovertext,marker:{line:{color:e({},t.marker.line.color,{editType:"plot"}),width:e({},t.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},t.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},t.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},t.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:t.hoverinfo,hovertemplate:m({},{keys:["properties"]}),showlegend:e({},h.showlegend,{dflt:!1})},d("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../choropleth/attributes":993}],1003:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../components/colorscale"),h=r("../../components/drawing"),e=r("../../lib/geojson_utils").makeBlank,f=r("../../lib/geo_location_utils");function l(o){var u,s=o[0].trace,i=s._opts;if(s.selectedpoints){for(var c=h.makeSelectedPointStyleFns(s),n=0;n<o.length;n++){var a=o[n];a.fOut&&(a.fOut.properties.mo2=c.selectedOpacityFn(a))}u={type:"identity",property:"mo2"}}else u=d.isArrayOrTypedArray(s.marker.opacity)?{type:"identity",property:"mo"}:s.marker.opacity;return d.extendFlat(i.fill.paint,{"fill-opacity":u}),d.extendFlat(i.line.paint,{"line-opacity":u}),i}I.exports={convert:function(o){var u=o[0].trace,s=u.visible===!0&&u._length!==0,i={layout:{visibility:"none"},paint:{}},c={layout:{visibility:"none"},paint:{}},n=u._opts={fill:i,line:c,geojson:e()};if(!s)return n;var a=f.extractTraceFeature(o);if(!a)return n;var g,p,y,v=m.makeColorScaleFuncFromTrace(u),b=u.marker,x=b.line||{};d.isArrayOrTypedArray(b.opacity)&&(g=function(k){var L=k.mo;return t(L)?+d.constrain(L,0,1):0}),d.isArrayOrTypedArray(x.color)&&(p=function(k){return k.mlc}),d.isArrayOrTypedArray(x.width)&&(y=function(k){return k.mlw});for(var T=0;T<o.length;T++){var A=o[T],S=A.fOut;if(S){var w=S.properties;w.fc=v(A.z),g&&(w.mo=g(A)),p&&(w.mlc=p(A)),y&&(w.mlw=y(A)),A.ct=w.ct,A._polygons=f.feature2polygons(S)}}var E=g?{type:"identity",property:"mo"}:b.opacity;return d.extendFlat(i.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":E}),d.extendFlat(c.paint,{"line-color":p?{type:"identity",property:"mlc"}:x.color,"line-width":y?{type:"identity",property:"mlw"}:x.width,"line-opacity":E}),i.layout.visibility="visible",c.layout.visibility="visible",n.geojson={type:"FeatureCollection",features:a},l(o),n},convertOnSelect:l}},{"../../components/colorscale":662,"../../components/drawing":672,"../../lib":787,"../../lib/geo_location_utils":780,"../../lib/geojson_utils":781,"fast-isnumeric":246}],1004:[function(r,I,B){var t=r("../../lib"),d=r("../../components/colorscale/defaults"),m=r("./attributes");I.exports=function(h,e,f,l){function o(c,n){return t.coerce(h,e,m,c,n)}var u=o("locations"),s=o("z"),i=o("geojson");t.isArrayOrTypedArray(u)&&u.length&&t.isArrayOrTypedArray(s)&&s.length&&(typeof i=="string"&&i!==""||t.isPlainObject(i))?(o("featureidkey"),e._length=Math.min(u.length,s.length),o("below"),o("text"),o("hovertext"),o("hovertemplate"),o("marker.line.width")&&o("marker.line.color"),o("marker.opacity"),d(h,e,l,o,{prefix:"",cLetter:"z"}),t.coerceSelectionMarkerOpacity(e,o)):e.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":1002}],1005:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../heatmap/colorbar"),calc:r("../choropleth/calc"),plot:r("./plot"),hoverPoints:r("../choropleth/hover"),eventData:r("../choropleth/event_data"),selectPoints:r("../choropleth/select"),styleOnSelect:function(t,d){d&&d[0].trace._glTrace.updateOnSelect(d)},getBelow:function(t,d){for(var m=d.getMapLayers(),h=m.length-2;h>=0;h--){var e=m[h].id;if(typeof e=="string"&&e.indexOf("water")===0){for(var f=h+1;f<m.length;f++)if(typeof(e=m[f].id)=="string"&&e.indexOf("plotly-")===-1)return e}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:r("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":895,"../choropleth/calc":994,"../choropleth/event_data":996,"../choropleth/hover":997,"../choropleth/select":1e3,"../heatmap/colorbar":1072,"./attributes":1002,"./defaults":1004,"./plot":1006}],1006:[function(r,I,B){var t=r("./convert").convert,d=r("./convert").convertOnSelect,m=r("../../plots/mapbox/constants").traceLayerPrefix;function h(f,l){this.type="choroplethmapbox",this.subplot=f,this.uid=l,this.sourceId="source-"+l,this.layerList=[["fill",m+l+"-fill"],["line",m+l+"-line"]],this.below=null}var e=h.prototype;e.update=function(f){this._update(t(f))},e.updateOnSelect=function(f){this._update(d(f))},e._update=function(f){var l=this.subplot,o=this.layerList,u=l.belowLookup["trace-"+this.uid];l.map.getSource(this.sourceId).setData(f.geojson),u!==this.below&&(this._removeLayers(),this._addLayers(f,u),this.below=u);for(var s=0;s<o.length;s++){var i=o[s],c=i[0],n=i[1],a=f[c];l.setOptions(n,"setLayoutProperty",a.layout),a.layout.visibility==="visible"&&l.setOptions(n,"setPaintProperty",a.paint)}},e._addLayers=function(f,l){for(var o=this.subplot,u=this.layerList,s=this.sourceId,i=0;i<u.length;i++){var c=u[i],n=c[0],a=f[n];o.addLayer({type:n,id:c[1],source:s,layout:a.layout,paint:a.paint},l)}},e._removeLayers=function(){for(var f=this.subplot.map,l=this.layerList,o=l.length-1;o>=0;o--)f.removeLayer(l[o][1])},e.dispose=function(){var f=this.subplot.map;this._removeLayers(),f.removeSource(this.sourceId)},I.exports=function(f,l){var o=l[0].trace,u=new h(f,o.uid),s=u.sourceId,i=t(l),c=u.below=f.belowLookup["trace-"+o.uid];return f.map.addSource(s,{type:"geojson",data:i.geojson}),u._addLayers(i,c),l[0].trace._glTrace=u,u}},{"../../plots/mapbox/constants":893,"./convert":1003}],1007:[function(r,I,B){var t=r("../../components/colorscale/attributes"),d=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=r("../../plots/template_attributes").hovertemplateAttrs,h=r("../mesh3d/attributes"),e=r("../../plots/attributes"),f=r("../../lib/extend").extendFlat,l={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:m({editType:"calc"},{keys:["norm"]}),uhoverformat:d("u",1),vhoverformat:d("v",1),whoverformat:d("w",1),xhoverformat:d("x"),yhoverformat:d("y"),zhoverformat:d("z"),showlegend:f({},e.showlegend,{dflt:!1})};f(l,t("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(o){l[o]=h[o]}),l.hoverinfo=f({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),l.transforms=void 0,I.exports=l},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../mesh3d/attributes":1143}],1008:[function(r,I,B){var t=r("../../components/colorscale/calc");I.exports=function(d,m){for(var h=m.u,e=m.v,f=m.w,l=Math.min(m.x.length,m.y.length,m.z.length,h.length,e.length,f.length),o=-1/0,u=1/0,s=0;s<l;s++){var i=h[s],c=e[s],n=f[s],a=Math.sqrt(i*i+c*c+n*n);o=Math.max(o,a),u=Math.min(u,a)}m._len=l,m._normMax=o,t(d,m,{vals:[u,o],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":658}],1009:[function(r,I,B){var t=r("gl-cone3d"),d=r("gl-cone3d").createConeMesh,m=r("../../lib").simpleMap,h=r("../../lib/gl_format_color").parseColorScale,e=r("../../components/colorscale").extractOpts,f=r("../../plots/gl3d/zip3");function l(n,a){this.scene=n,this.uid=a,this.mesh=null,this.data=null}var o=l.prototype;o.handlePick=function(n){if(n.object===this.mesh){var a=n.index=n.data.index,g=this.data.x[a],p=this.data.y[a],y=this.data.z[a],v=this.data.u[a],b=this.data.v[a],x=this.data.w[a];n.traceCoordinate=[g,p,y,v,b,x,Math.sqrt(v*v+b*b+x*x)];var T=this.data.hovertext||this.data.text;return Array.isArray(T)&&T[a]!==void 0?n.textLabel=T[a]:T&&(n.textLabel=T),!0}};var u={xaxis:0,yaxis:1,zaxis:2},s={tip:1,tail:0,cm:.25,center:.5},i={tip:1,tail:1,cm:.75,center:.5};function c(n,a){var g=n.fullSceneLayout,p=n.dataScale,y={};function v(A,S){var w=g[S],E=p[u[S]];return m(A,function(k){return w.d2l(k)*E})}y.vectors=f(v(a.u,"xaxis"),v(a.v,"yaxis"),v(a.w,"zaxis"),a._len),y.positions=f(v(a.x,"xaxis"),v(a.y,"yaxis"),v(a.z,"zaxis"),a._len);var b=e(a);y.colormap=h(a),y.vertexIntensityBounds=[b.min/a._normMax,b.max/a._normMax],y.coneOffset=s[a.anchor],a.sizemode==="scaled"?y.coneSize=a.sizeref||.5:y.coneSize=a.sizeref&&a._normMax?a.sizeref/a._normMax:.5;var x=t(y),T=a.lightposition;return x.lightPosition=[T.x,T.y,T.z],x.ambient=a.lighting.ambient,x.diffuse=a.lighting.diffuse,x.specular=a.lighting.specular,x.roughness=a.lighting.roughness,x.fresnel=a.lighting.fresnel,x.opacity=a.opacity,a._pad=i[a.anchor]*x.vectorScale*x.coneScale*a._normMax,x}o.update=function(n){this.data=n;var a=c(this.scene,n);this.mesh.update(a)},o.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},I.exports=function(n,a){var g=n.glplot.gl,p=c(n,a),y=d(g,p),v=new l(n,a.uid);return v.mesh=y,v.data=a,y._trace=v,n.glplot.add(y),v}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gl_format_color":783,"../../plots/gl3d/zip3":891,"gl-cone3d":262}],1010:[function(r,I,B){var t=r("../../lib"),d=r("../../components/colorscale/defaults"),m=r("./attributes");I.exports=function(h,e,f,l){function o(g,p){return t.coerce(h,e,m,g,p)}var u=o("u"),s=o("v"),i=o("w"),c=o("x"),n=o("y"),a=o("z");u&&u.length&&s&&s.length&&i&&i.length&&c&&c.length&&n&&n.length&&a&&a.length?(o("sizeref"),o("sizemode"),o("anchor"),o("lighting.ambient"),o("lighting.diffuse"),o("lighting.specular"),o("lighting.roughness"),o("lighting.fresnel"),o("lightposition.x"),o("lightposition.y"),o("lightposition.z"),d(h,e,l,o,{prefix:"",cLetter:"c"}),o("text"),o("hovertext"),o("hovertemplate"),o("uhoverformat"),o("vhoverformat"),o("whoverformat"),o("xhoverformat"),o("yhoverformat"),o("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":1007}],1011:[function(r,I,B){I.exports={moduleType:"trace",name:"cone",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:r("./calc"),plot:r("./convert"),eventData:function(t,d){return t.norm=d.traceCoordinate[6],t},meta:{}}},{"../../plots/gl3d":880,"./attributes":1007,"./calc":1008,"./convert":1009,"./defaults":1010}],1012:[function(r,I,B){var t=r("../heatmap/attributes"),d=r("../scatter/attributes"),m=r("../../plots/cartesian/axis_format_attributes"),h=m.axisHoverFormat,e=m.descriptionOnlyNumbers,f=r("../../components/colorscale/attributes"),l=r("../../components/drawing/attributes").dash,o=r("../../plots/font_attributes"),u=r("../../lib/extend").extendFlat,s=r("../../constants/filter_ops"),i=s.COMPARISON_OPS2,c=s.INTERVAL_OPS,n=d.line;I.exports=u({z:t.z,x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,text:t.text,hovertext:t.hovertext,transpose:t.transpose,xtype:t.xtype,ytype:t.ytype,xhoverformat:h("x"),yhoverformat:h("y"),zhoverformat:h("z",1),hovertemplate:t.hovertemplate,hoverongaps:t.hoverongaps,connectgaps:u({},t.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:o({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:e("contour label")},operation:{valType:"enumerated",values:[].concat(i).concat(c),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:u({},n.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:l,smoothing:u({},n.smoothing,{}),editType:"plot"}},f("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":657,"../../components/drawing/attributes":671,"../../constants/filter_ops":759,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/font_attributes":867,"../heatmap/attributes":1069,"../scatter/attributes":1202}],1013:[function(r,I,B){var t=r("../../components/colorscale"),d=r("../heatmap/calc"),m=r("./set_contours"),h=r("./end_plus");I.exports=function(e,f){var l=d(e,f),o=l[0].z;m(f,o);var u,s=f.contours,i=t.extractOpts(f);if(s.coloring==="heatmap"&&i.auto&&f.autocontour===!1){var c=s.start,n=h(s),a=s.size||1,g=Math.floor((n-c)/a)+1;isFinite(a)||(a=1,g=1);var p=c-a/2;u=[p,p+g*a]}else u=o;return t.calc(e,f,{vals:u,cLetter:"z"}),l}},{"../../components/colorscale":662,"../heatmap/calc":1070,"./end_plus":1023,"./set_contours":1031}],1014:[function(r,I,B){I.exports=function(t,d){var m,h=t[0],e=h.z;switch(d.type){case"levels":var f=Math.min(e[0][0],e[0][1]);for(m=0;m<t.length;m++){var l=t[m];l.prefixBoundary=!l.edgepaths.length&&(f>l.level||l.starts.length&&f===l.level)}break;case"constraint":if(h.prefixBoundary=!1,h.edgepaths.length)return;var o=h.x.length,u=h.y.length,s=-1/0,i=1/0;for(m=0;m<u;m++)i=Math.min(i,e[m][0]),i=Math.min(i,e[m][o-1]),s=Math.max(s,e[m][0]),s=Math.max(s,e[m][o-1]);for(m=1;m<o-1;m++)i=Math.min(i,e[0][m]),i=Math.min(i,e[u-1][m]),s=Math.max(s,e[0][m]),s=Math.max(s,e[u-1][m]);var c,n,a=d.value;switch(d._operation){case">":a>s&&(h.prefixBoundary=!0);break;case"<":(a<i||h.starts.length&&a===i)&&(h.prefixBoundary=!0);break;case"[]":c=Math.min(a[0],a[1]),((n=Math.max(a[0],a[1]))<i||c>s||h.starts.length&&n===i)&&(h.prefixBoundary=!0);break;case"][":c=Math.min(a[0],a[1]),n=Math.max(a[0],a[1]),c<i&&n>s&&(h.prefixBoundary=!0)}}}},{}],1015:[function(r,I,B){var t=r("../../components/colorscale"),d=r("./make_color_map"),m=r("./end_plus");I.exports={min:"zmin",max:"zmax",calc:function(h,e,f){var l=e.contours,o=e.line,u=l.size||1,s=l.coloring,i=d(e,{isColorbar:!0});if(s==="heatmap"){var c=t.extractOpts(e);f._fillgradient=c.reversescale?t.flipScale(c.colorscale):c.colorscale,f._zrange=[c.min,c.max]}else s==="fill"&&(f._fillcolor=i);f._line={color:s==="lines"?i:o.color,width:l.showlines!==!1?o.width:0,dash:o.dash},f._levels={start:l.start,end:m(l),size:u}}}},{"../../components/colorscale":662,"./end_plus":1023,"./make_color_map":1028}],1016:[function(r,I,B){I.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],1017:[function(r,I,B){var t=r("fast-isnumeric"),d=r("./label_defaults"),m=r("../../components/color"),h=m.addOpacity,e=m.opacity,f=r("../../constants/filter_ops"),l=f.CONSTRAINT_REDUCTION,o=f.COMPARISON_OPS2;I.exports=function(u,s,i,c,n,a){var g,p,y,v=s.contours,b=i("contours.operation");v._operation=l[b],function(x,T){var A;o.indexOf(T.operation)===-1?(x("contours.value",[0,1]),Array.isArray(T.value)?T.value.length>2?T.value=T.value.slice(2):T.length===0?T.value=[0,1]:T.length<2?(A=parseFloat(T.value[0]),T.value=[A,A+1]):T.value=[parseFloat(T.value[0]),parseFloat(T.value[1])]:t(T.value)&&(A=parseFloat(T.value),T.value=[A,A+1])):(x("contours.value",0),t(T.value)||(Array.isArray(T.value)?T.value=parseFloat(T.value[0]):T.value=0))}(i,v),b==="="?g=v.showlines=!0:(g=i("contours.showlines"),y=i("fillcolor",h((u.line||{}).color||n,.5))),g&&(p=i("line.color",y&&e(y)?h(s.fillcolor,1):n),i("line.width",2),i("line.dash")),i("line.smoothing"),d(i,c,p,a)}},{"../../components/color":650,"../../constants/filter_ops":759,"./label_defaults":1027,"fast-isnumeric":246}],1018:[function(r,I,B){var t=r("../../constants/filter_ops"),d=r("fast-isnumeric");function m(f,l){var o,u=Array.isArray(l);function s(i){return d(i)?+i:null}return t.COMPARISON_OPS2.indexOf(f)!==-1?o=s(u?l[0]:l):t.INTERVAL_OPS.indexOf(f)!==-1?o=u?[s(l[0]),s(l[1])]:[s(l),s(l)]:t.SET_OPS.indexOf(f)!==-1&&(o=u?l.map(s):[s(l)]),o}function h(f){return function(l){l=m(f,l);var o=Math.min(l[0],l[1]),u=Math.max(l[0],l[1]);return{start:o,end:u,size:u-o}}}function e(f){return function(l){return{start:l=m(f,l),end:1/0,size:1/0}}}I.exports={"[]":h("[]"),"][":h("]["),">":e(">"),"<":e("<"),"=":e("=")}},{"../../constants/filter_ops":759,"fast-isnumeric":246}],1019:[function(r,I,B){I.exports=function(t,d,m,h){var e=h("contours.start"),f=h("contours.end"),l=e===!1||f===!1,o=m("contours.size");!(l?d.autocontour=!0:m("autocontour",!1))&&o||m("ncontours")}},{}],1020:[function(r,I,B){var t=r("../../lib");function d(m){return t.extendFlat({},m,{edgepaths:t.extendDeep([],m.edgepaths),paths:t.extendDeep([],m.paths),starts:t.extendDeep([],m.starts)})}I.exports=function(m,h){var e,f,l,o=function(i){return i.reverse()},u=function(i){return i};switch(h){case"=":case"<":return m;case">":for(m.length!==1&&t.warn("Contour data invalid for the specified inequality operation."),f=m[0],e=0;e<f.edgepaths.length;e++)f.edgepaths[e]=o(f.edgepaths[e]);for(e=0;e<f.paths.length;e++)f.paths[e]=o(f.paths[e]);for(e=0;e<f.starts.length;e++)f.starts[e]=o(f.starts[e]);return m;case"][":var s=o;o=u,u=s;case"[]":for(m.length!==2&&t.warn("Contour data invalid for the specified inequality range operation."),f=d(m[0]),l=d(m[1]),e=0;e<f.edgepaths.length;e++)f.edgepaths[e]=o(f.edgepaths[e]);for(e=0;e<f.paths.length;e++)f.paths[e]=o(f.paths[e]);for(e=0;e<f.starts.length;e++)f.starts[e]=o(f.starts[e]);for(;l.edgepaths.length;)f.edgepaths.push(u(l.edgepaths.shift()));for(;l.paths.length;)f.paths.push(u(l.paths.shift()));for(;l.starts.length;)f.starts.push(u(l.starts.shift()));return[f]}}},{"../../lib":787}],1021:[function(r,I,B){var t=r("../../lib"),d=r("../heatmap/xyz_defaults"),m=r("../scatter/period_defaults"),h=r("./constraint_defaults"),e=r("./contours_defaults"),f=r("./style_defaults"),l=r("./attributes");I.exports=function(o,u,s,i){function c(a,g){return t.coerce(o,u,l,a,g)}if(d(o,u,c,i)){m(o,u,i,c),c("xhoverformat"),c("yhoverformat"),c("text"),c("hovertext"),c("hovertemplate"),c("hoverongaps");var n=c("contours.type")==="constraint";c("connectgaps",t.isArray1D(u.z)),n?h(o,u,c,i,s):(e(o,u,c,function(a){return t.coerce2(o,u,l,a)}),f(o,u,c,i))}else u.visible=!1}},{"../../lib":787,"../heatmap/xyz_defaults":1083,"../scatter/period_defaults":1222,"./attributes":1012,"./constraint_defaults":1017,"./contours_defaults":1019,"./style_defaults":1033}],1022:[function(r,I,B){var t=r("../../lib"),d=r("./constraint_mapping"),m=r("./end_plus");I.exports=function(h,e,f){for(var l=h.type==="constraint"?d[h._operation](h.value):h,o=l.size,u=[],s=m(l),i=f.trace._carpetTrace,c=i?{xaxis:i.aaxis,yaxis:i.baxis,x:f.a,y:f.b}:{xaxis:e.xaxis,yaxis:e.yaxis,x:f.x,y:f.y},n=l.start;n<s;n+=o)if(u.push(t.extendFlat({level:n,crossings:{},starts:[],edgepaths:[],paths:[],z:f.z,smoothing:f.trace.line.smoothing},c)),u.length>1e3){t.warn("Too many contours, clipping at 1000",h);break}return u}},{"../../lib":787,"./constraint_mapping":1018,"./end_plus":1023}],1023:[function(r,I,B){I.exports=function(t){return t.end+t.size/1e6}},{}],1024:[function(r,I,B){var t=r("../../lib"),d=r("./constants");function m(f,l,o,u){return Math.abs(f[0]-l[0])<o&&Math.abs(f[1]-l[1])<u}function h(f,l,o,u,s){var i,c=l.join(","),n=f.crossings[c],a=function(Q,te,ie){var ae=0,he=0;return Q>20&&te?Q===208||Q===1114?ae=ie[0]===0?1:-1:he=ie[1]===0?1:-1:d.BOTTOMSTART.indexOf(Q)!==-1?he=1:d.LEFTSTART.indexOf(Q)!==-1?ae=1:d.TOPSTART.indexOf(Q)!==-1?he=-1:ae=-1,[ae,he]}(n,o,l),g=[e(f,l,[-a[0],-a[1]])],p=f.z.length,y=f.z[0].length,v=l.slice(),b=a.slice();for(i=0;i<1e4;i++){if(n>20?(n=d.CHOOSESADDLE[n][(a[0]||a[1])<0?0:1],f.crossings[c]=d.SADDLEREMAINDER[n]):delete f.crossings[c],!(a=d.NEWDELTA[n])){t.log("Found bad marching index:",n,l,f.level);break}g.push(e(f,l,a)),l[0]+=a[0],l[1]+=a[1],c=l.join(","),m(g[g.length-1],g[g.length-2],u,s)&&g.pop();var x=a[0]&&(l[0]<0||l[0]>y-2)||a[1]&&(l[1]<0||l[1]>p-2);if(l[0]===v[0]&&l[1]===v[1]&&a[0]===b[0]&&a[1]===b[1]||o&&x)break;n=f.crossings[c]}i===1e4&&t.log("Infinite loop in contour?");var T,A,S,w,E,k,L,M,P,D,N,U,G,X,K,Z=m(g[0],g[g.length-1],u,s),H=0,Y=.2*f.smoothing,$=[],z=0;for(i=1;i<g.length;i++)U=g[i],G=g[i-1],X=void 0,K=void 0,X=U[2]-G[2],K=U[3]-G[3],H+=L=Math.sqrt(X*X+K*K),$.push(L);var j=H/$.length*Y;function W(Q){return g[Q%g.length]}for(i=g.length-2;i>=z;i--)if((T=$[i])<j){for(S=0,A=i-1;A>=z&&T+$[A]<j;A--)T+=$[A];if(Z&&i===g.length-2)for(S=0;S<A&&T+$[S]<j;S++)T+=$[S];E=i-A+S+1,k=Math.floor((i+A+S+2)/2),w=Z||i!==g.length-2?Z||A!==-1?E%2?W(k):[(W(k)[0]+W(k+1)[0])/2,(W(k)[1]+W(k+1)[1])/2]:g[0]:g[g.length-1],g.splice(A+1,i-A+1,w),i=A+1,S&&(z=S),Z&&(i===g.length-2?g[S]=g[g.length-1]:i===0&&(g[g.length-1]=g[0]))}for(g.splice(0,z),i=0;i<g.length;i++)g[i].length=2;if(!(g.length<2))if(Z)g.pop(),f.paths.push(g);else{o||t.log("Unclosed interior contour?",f.level,v.join(","),g.join("L"));var ee=!1;for(M=0;M<f.edgepaths.length;M++)if(D=f.edgepaths[M],!ee&&m(D[0],g[g.length-1],u,s)){g.pop(),ee=!0;var J=!1;for(P=0;P<f.edgepaths.length;P++)if(m((N=f.edgepaths[P])[N.length-1],g[0],u,s)){J=!0,g.shift(),f.edgepaths.splice(M,1),P===M?f.paths.push(g.concat(N)):(P>M&&P--,f.edgepaths[P]=N.concat(g,D));break}J||(f.edgepaths[M]=g.concat(D))}for(M=0;M<f.edgepaths.length&&!ee;M++)m((D=f.edgepaths[M])[D.length-1],g[0],u,s)&&(g.shift(),f.edgepaths[M]=D.concat(g),ee=!0);ee||f.edgepaths.push(g)}}function e(f,l,o){var u=l[0]+Math.max(o[0],0),s=l[1]+Math.max(o[1],0),i=f.z[s][u],c=f.xaxis,n=f.yaxis;if(o[1]){var a=(f.level-i)/(f.z[s][u+1]-i);return[c.c2p((1-a)*f.x[u]+a*f.x[u+1],!0),n.c2p(f.y[s],!0),u+a,s]}var g=(f.level-i)/(f.z[s+1][u]-i);return[c.c2p(f.x[u],!0),n.c2p((1-g)*f.y[s]+g*f.y[s+1],!0),u,s+g]}I.exports=function(f,l,o){var u,s,i,c;for(l=l||.01,o=o||.01,s=0;s<f.length;s++){for(i=f[s],c=0;c<i.starts.length;c++)h(i,i.starts[c],"edge",l,o);for(u=0;Object.keys(i.crossings).length&&u<1e4;)u++,h(i,Object.keys(i.crossings)[0].split(",").map(Number),void 0,l,o);u===1e4&&t.log("Infinite loop in contour?")}}},{"../../lib":787,"./constants":1016}],1025:[function(r,I,B){var t=r("../../components/color"),d=r("../heatmap/hover");I.exports=function(m,h,e,f,l){l||(l={}),l.isContour=!0;var o=d(m,h,e,f,l);return o&&o.forEach(function(u){var s=u.trace;s.contours.type==="constraint"&&(s.fillcolor&&t.opacity(s.fillcolor)?u.color=t.addOpacity(s.fillcolor,1):s.contours.showlines&&t.opacity(s.line.color)&&(u.color=t.addOpacity(s.line.color,1)))}),o}},{"../../components/color":650,"../heatmap/hover":1076}],1026:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot").plot,style:r("./style"),colorbar:r("./colorbar"),hoverPoints:r("./hover"),moduleType:"trace",name:"contour",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":852,"./attributes":1012,"./calc":1013,"./colorbar":1015,"./defaults":1021,"./hover":1025,"./plot":1030,"./style":1032}],1027:[function(r,I,B){var t=r("../../lib");I.exports=function(d,m,h,e){if(e||(e={}),d("contours.showlabels")){var f=m.font;t.coerceFont(d,"contours.labelfont",{family:f.family,size:f.size,color:h}),d("contours.labelformat")}e.hasHover!==!1&&d("zhoverformat")}},{"../../lib":787}],1028:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/colorscale"),m=r("./end_plus");I.exports=function(h){var e=h.contours,f=e.start,l=m(e),o=e.size||1,u=Math.floor((l-f)/o)+1,s=e.coloring==="lines"?0:1,i=d.extractOpts(h);isFinite(o)||(o=1,u=1);var c,n,a=i.reversescale?d.flipScale(i.colorscale):i.colorscale,g=a.length,p=new Array(g),y=new Array(g);if(e.coloring==="heatmap"){var v=i.min,b=i.max;for(n=0;n<g;n++)c=a[n],p[n]=c[0]*(b-v)+v,y[n]=c[1];var x=t.extent([v,b,e.start,e.start+o*(u-1)]),T=x[v<b?0:1],A=x[v<b?1:0];T!==v&&(p.splice(0,0,T),y.splice(0,0,y[0])),A!==b&&(p.push(A),y.push(y[y.length-1]))}else for(n=0;n<g;n++)c=a[n],p[n]=(c[0]*(u+s-1)-s/2)*o+f,y[n]=c[1];return d.makeColorScaleFunc({domain:p,range:y},{noNumericCheck:!0})}},{"../../components/colorscale":662,"./end_plus":1023,"@plotly/d3":58}],1029:[function(r,I,B){var t=r("./constants");function d(m,h){var e=(h[0][0]>m?0:1)+(h[0][1]>m?0:2)+(h[1][1]>m?0:4)+(h[1][0]>m?0:8);return e===5||e===10?m>(h[0][0]+h[0][1]+h[1][0]+h[1][1])/4?e===5?713:1114:e===5?104:208:e===15?0:e}I.exports=function(m){var h,e,f,l,o,u,s,i,c,n=m[0].z,a=n.length,g=n[0].length,p=a===2||g===2;for(e=0;e<a-1;e++)for(l=[],e===0&&(l=l.concat(t.BOTTOMSTART)),e===a-2&&(l=l.concat(t.TOPSTART)),h=0;h<g-1;h++)for(f=l.slice(),h===0&&(f=f.concat(t.LEFTSTART)),h===g-2&&(f=f.concat(t.RIGHTSTART)),o=h+","+e,u=[[n[e][h],n[e][h+1]],[n[e+1][h],n[e+1][h+1]]],c=0;c<m.length;c++)(s=d((i=m[c]).level,u))&&(i.crossings[o]=s,f.indexOf(s)!==-1&&(i.starts.push([h,e]),p&&f.indexOf(s,f.indexOf(s)+1)!==-1&&i.starts.push([h,e])))}},{"./constants":1016}],1030:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../components/drawing"),h=r("../../components/colorscale"),e=r("../../lib/svg_text_utils"),f=r("../../plots/cartesian/axes"),l=r("../../plots/cartesian/set_convert"),o=r("../heatmap/plot"),u=r("./make_crossings"),s=r("./find_all_paths"),i=r("./empty_pathinfo"),c=r("./convert_to_constraints"),n=r("./close_boundaries"),a=r("./constants"),g=a.LABELOPTIMIZER;function p(b,x){var T,A,S,w,E,k,L,M="",P=0,D=b.edgepaths.map(function(Z,H){return H}),N=!0;function U(Z){return Math.abs(Z[1]-x[2][1])<.01}function G(Z){return Math.abs(Z[0]-x[0][0])<.01}function X(Z){return Math.abs(Z[0]-x[2][0])<.01}for(;D.length;){for(k=m.smoothopen(b.edgepaths[P],b.smoothing),M+=N?k:k.replace(/^M/,"L"),D.splice(D.indexOf(P),1),T=b.edgepaths[P][b.edgepaths[P].length-1],w=-1,S=0;S<4;S++){if(!T){d.log("Missing end?",P,b);break}for(L=T,Math.abs(L[1]-x[0][1])<.01&&!X(T)?A=x[1]:G(T)?A=x[0]:U(T)?A=x[3]:X(T)&&(A=x[2]),E=0;E<b.edgepaths.length;E++){var K=b.edgepaths[E][0];Math.abs(T[0]-A[0])<.01?Math.abs(T[0]-K[0])<.01&&(K[1]-T[1])*(A[1]-K[1])>=0&&(A=K,w=E):Math.abs(T[1]-A[1])<.01?Math.abs(T[1]-K[1])<.01&&(K[0]-T[0])*(A[0]-K[0])>=0&&(A=K,w=E):d.log("endpt to newendpt is not vert. or horz.",T,A,K)}if(T=A,w>=0)break;M+="L"+A}if(w===b.edgepaths.length){d.log("unclosed perimeter path");break}P=w,(N=D.indexOf(P)===-1)&&(P=D[0],M+="Z")}for(P=0;P<b.paths.length;P++)M+=m.smoothclosed(b.paths[P],b.smoothing);return M}function y(b,x,T,A){var S=x.width/2,w=x.height/2,E=b.x,k=b.y,L=b.theta,M=Math.cos(L)*S,P=Math.sin(L)*S,D=(E>A.center?A.right-E:E-A.left)/(M+Math.abs(Math.sin(L)*w)),N=(k>A.middle?A.bottom-k:k-A.top)/(Math.abs(P)+Math.cos(L)*w);if(D<1||N<1)return 1/0;var U=g.EDGECOST*(1/(D-1)+1/(N-1));U+=g.ANGLECOST*L*L;for(var G=E-M,X=k-P,K=E+M,Z=k+P,H=0;H<T.length;H++){var Y=T[H],$=Math.cos(Y.theta)*Y.width/2,z=Math.sin(Y.theta)*Y.width/2,j=2*d.segmentDistance(G,X,K,Z,Y.x-$,Y.y-z,Y.x+$,Y.y+z)/(x.height+Y.height),W=Y.level===x.level,ee=W?g.SAMELEVELDISTANCE:1;if(j<=ee)return 1/0;U+=g.NEIGHBORCOST*(W?g.SAMELEVELFACTOR:1)/(j-ee)}return U}function v(b){var x,T,A=b.trace._emptypoints,S=[],w=b.z.length,E=b.z[0].length,k=[];for(x=0;x<E;x++)k.push(1);for(x=0;x<w;x++)S.push(k.slice());for(x=0;x<A.length;x++)S[(T=A[x])[0]][T[1]]=0;return b.zmask=S,S}B.plot=function(b,x,T,A){var S=x.xaxis,w=x.yaxis;d.makeTraceGroups(A,T,"contour").each(function(E){var k=t.select(this),L=E[0],M=L.trace,P=L.x,D=L.y,N=M.contours,U=i(N,x,L),G=d.ensureSingle(k,"g","heatmapcoloring"),X=[];N.coloring==="heatmap"&&(X=[E]),o(b,x,X,G),u(U),s(U);var K=S.c2p(P[0],!0),Z=S.c2p(P[P.length-1],!0),H=w.c2p(D[0],!0),Y=w.c2p(D[D.length-1],!0),$=[[K,Y],[Z,Y],[Z,H],[K,H]],z=U;N.type==="constraint"&&(z=c(U,N._operation)),function(j,W,ee){var J=d.ensureSingle(j,"g","contourbg").selectAll("path").data(ee.coloring==="fill"?[0]:[]);J.enter().append("path"),J.exit().remove(),J.attr("d","M"+W.join("L")+"Z").style("stroke","none")}(k,$,N),function(j,W,ee,J){var Q=J.coloring==="fill"||J.type==="constraint"&&J._operation!=="=",te="M"+ee.join("L")+"Z";Q&&n(W,J);var ie=d.ensureSingle(j,"g","contourfill").selectAll("path").data(Q?W:[]);ie.enter().append("path"),ie.exit().remove(),ie.each(function(ae){var he=(ae.prefixBoundary?te:"")+p(ae,ee);he?t.select(this).attr("d",he).style("stroke","none"):t.select(this).remove()})}(k,z,$,N),function(j,W,ee,J,Q){var te=d.ensureSingle(j,"g","contourlines"),ie=Q.showlines!==!1,ae=Q.showlabels,he=ie&&ae,se=B.createLines(te,ie||ae,W),de=B.createLineClip(te,he,ee,J.trace.uid),ue=j.selectAll("g.contourlabels").data(ae?[0]:[]);if(ue.exit().remove(),ue.enter().append("g").classed("contourlabels",!0),ae){var ve=[],ke=[];d.clearLocationCache();var Ee=B.labelFormatter(ee,J),be=m.tester.append("text").attr("data-notex",1).call(m.font,Q.labelfont),xe=W[0].xaxis,ce=W[0].yaxis,ge=xe._length,we=ce._length,Me=xe.range,Se=ce.range,ze=d.aggNums(Math.min,null,J.x),Fe=d.aggNums(Math.max,null,J.x),Ye=d.aggNums(Math.min,null,J.y),rt=d.aggNums(Math.max,null,J.y),Oe=Math.max(xe.c2p(ze,!0),0),je=Math.min(xe.c2p(Fe,!0),ge),We=Math.max(ce.c2p(rt,!0),0),qe=Math.min(ce.c2p(Ye,!0),we),et={};Me[0]<Me[1]?(et.left=Oe,et.right=je):(et.left=je,et.right=Oe),Se[0]<Se[1]?(et.top=We,et.bottom=qe):(et.top=qe,et.bottom=We),et.middle=(et.top+et.bottom)/2,et.center=(et.left+et.right)/2,ve.push([[et.left,et.top],[et.right,et.top],[et.right,et.bottom],[et.left,et.bottom]]);var st=Math.sqrt(ge*ge+we*we),ct=a.LABELDISTANCE*st/Math.max(1,W.length/a.LABELINCREASE);se.each(function(Pt){var kt=B.calcTextOpts(Pt.level,Ee,be,ee);t.select(this).selectAll("path").each(function(){var at=d.getVisibleSegment(this,et,kt.height/2);if(at&&!(at.len<(kt.width+kt.height)*a.LABELMIN))for(var tt=Math.min(Math.ceil(at.len/ct),a.LABELMAX),_t=0;_t<tt;_t++){var er=B.findBestTextLocation(this,at,kt,ke,et);if(!er)break;B.addLabelData(er,kt,ke,ve)}})}),be.remove(),B.drawLabels(ue,ke,ee,de,he?ve:null)}ae&&!ie&&se.remove()}(k,U,b,L,N),function(j,W,ee,J,Q){var te=J.trace,ie=ee._fullLayout._clips,ae="clip"+te.uid,he=ie.selectAll("#"+ae).data(te.connectgaps?[]:[0]);if(he.enter().append("clipPath").classed("contourclip",!0).attr("id",ae),he.exit().remove(),te.connectgaps===!1){var se={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:W.xaxis,yaxis:W.yaxis,x:J.x,y:J.y,z:v(J),smoothing:0};u([se]),s([se]),n([se],{type:"levels"}),d.ensureSingle(he,"path","").attr("d",(se.prefixBoundary?"M"+Q.join("L")+"Z":"")+p(se,Q))}else ae=null;m.setClipUrl(j,ae,ee)}(k,x,b,L,$)})},B.createLines=function(b,x,T){var A=T[0].smoothing,S=b.selectAll("g.contourlevel").data(x?T:[]);if(S.exit().remove(),S.enter().append("g").classed("contourlevel",!0),x){var w=S.selectAll("path.openline").data(function(k){return k.pedgepaths||k.edgepaths});w.exit().remove(),w.enter().append("path").classed("openline",!0),w.attr("d",function(k){return m.smoothopen(k,A)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var E=S.selectAll("path.closedline").data(function(k){return k.ppaths||k.paths});E.exit().remove(),E.enter().append("path").classed("closedline",!0),E.attr("d",function(k){return m.smoothclosed(k,A)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return S},B.createLineClip=function(b,x,T,A){var S=x?"clipline"+A:null,w=T._fullLayout._clips.selectAll("#"+S).data(x?[0]:[]);return w.exit().remove(),w.enter().append("clipPath").classed("contourlineclip",!0).attr("id",S),m.setClipUrl(b,S,T),w},B.labelFormatter=function(b,x){var T=b._fullLayout,A=x.trace,S=A.contours,w={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(S.labelformat)w.tickformat=S.labelformat,l(w,T);else{var E=h.extractOpts(A);if(E&&E.colorbar&&E.colorbar._axis)w=E.colorbar._axis;else{if(S.type==="constraint"){var k=S.value;Array.isArray(k)?w.range=[k[0],k[k.length-1]]:w.range=[k,k]}else w.range=[S.start,S.end],w.nticks=(S.end-S.start)/S.size;w.range[0]===w.range[1]&&(w.range[1]+=w.range[0]||1),w.nticks||(w.nticks=1e3),l(w,T),f.prepTicks(w),w._tmin=null,w._tmax=null}}return function(L){return f.tickText(w,L).text}},B.calcTextOpts=function(b,x,T,A){var S=x(b);T.text(S).call(e.convertToTspans,A);var w=T.node(),E=m.bBox(w,!0);return{text:S,width:E.width,height:E.height,fontSize:+w.style["font-size"].replace("px",""),level:b,dy:(E.top+E.bottom)/2}},B.findBestTextLocation=function(b,x,T,A,S){var w,E,k,L,M,P=T.width;x.isClosed?(E=x.len/g.INITIALSEARCHPOINTS,w=x.min+E/2,k=x.max):(E=(x.len-P)/(g.INITIALSEARCHPOINTS+1),w=x.min+E+P/2,k=x.max-(E+P)/2);for(var D=1/0,N=0;N<g.ITERATIONS;N++){for(var U=w;U<k;U+=E){var G=d.getTextLocation(b,x.total,U,P),X=y(G,T,A,S);X<D&&(D=X,M=G,L=U)}if(D>2*g.MAXCOST)break;N&&(E/=2),k=(w=L-E/2)+1.5*E}if(D<=g.MAXCOST)return M},B.addLabelData=function(b,x,T,A){var S=x.fontSize,w=x.width+S/3,E=Math.max(0,x.height-S/3),k=b.x,L=b.y,M=b.theta,P=Math.sin(M),D=Math.cos(M),N=function(G,X){return[k+G*D-X*P,L+G*P+X*D]},U=[N(-w/2,-E/2),N(-w/2,E/2),N(w/2,E/2),N(w/2,-E/2)];T.push({text:x.text,x:k,y:L,dy:x.dy,theta:M,level:x.level,width:w,height:E}),A.push(U)},B.drawLabels=function(b,x,T,A,S){var w=b.selectAll("text").data(x,function(L){return L.text+","+L.x+","+L.y+","+L.theta});if(w.exit().remove(),w.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(L){var M=L.x+Math.sin(L.theta)*L.dy,P=L.y-Math.cos(L.theta)*L.dy;t.select(this).text(L.text).attr({x:M,y:P,transform:"rotate("+180*L.theta/Math.PI+" "+M+" "+P+")"}).call(e.convertToTspans,T)}),S){for(var E="",k=0;k<S.length;k++)E+="M"+S[k].join("L")+"Z";d.ensureSingle(A,"path","").attr("d",E)}}},{"../../components/colorscale":662,"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../plots/cartesian/set_convert":859,"../heatmap/plot":1080,"./close_boundaries":1014,"./constants":1016,"./convert_to_constraints":1020,"./empty_pathinfo":1022,"./find_all_paths":1024,"./make_crossings":1029,"@plotly/d3":58}],1031:[function(r,I,B){var t=r("../../plots/cartesian/axes"),d=r("../../lib");function m(h,e,f){var l={type:"linear",range:[h,e]};return t.autoTicks(l,(e-h)/(f||15)),l}I.exports=function(h,e){var f=h.contours;if(h.autocontour){var l=h.zmin,o=h.zmax;(h.zauto||l===void 0)&&(l=d.aggNums(Math.min,null,e)),(h.zauto||o===void 0)&&(o=d.aggNums(Math.max,null,e));var u=m(l,o,h.ncontours);f.size=u.dtick,f.start=t.tickFirst(u),u.range.reverse(),f.end=t.tickFirst(u),f.start===l&&(f.start+=f.size),f.end===o&&(f.end-=f.size),f.start>f.end&&(f.start=f.end=(f.start+f.end)/2),h._input.contours||(h._input.contours={}),d.extendFlat(h._input.contours,{start:f.start,end:f.end,size:f.size}),h._input.autocontour=!0}else if(f.type!=="constraint"){var s,i=f.start,c=f.end,n=h._input.contours;i>c&&(f.start=n.start=c,c=f.end=n.end=i,i=f.start),!(f.size>0)&&(s=i===c?1:m(i,c,h.ncontours).dtick,n.size=f.size=s)}}},{"../../lib":787,"../../plots/cartesian/axes":838}],1032:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/drawing"),m=r("../heatmap/style"),h=r("./make_color_map");I.exports=function(e){var f=t.select(e).selectAll("g.contour");f.style("opacity",function(l){return l[0].trace.opacity}),f.each(function(l){var o=t.select(this),u=l[0].trace,s=u.contours,i=u.line,c=s.size||1,n=s.start,a=s.type==="constraint",g=!a&&s.coloring==="lines",p=!a&&s.coloring==="fill",y=g||p?h(u):null;o.selectAll("g.contourlevel").each(function(x){t.select(this).selectAll("path").call(d.lineGroupStyle,i.width,g?y(x.level):i.color,i.dash)});var v=s.labelfont;if(o.selectAll("g.contourlabels text").each(function(x){d.font(t.select(this),{family:v.family,size:v.size,color:v.color||(g?y(x.level):i.color)})}),a)o.selectAll("g.contourfill path").style("fill",u.fillcolor);else if(p){var b;o.selectAll("g.contourfill path").style("fill",function(x){return b===void 0&&(b=x.level),y(x.level+.5*c)}),b===void 0&&(b=n),o.selectAll("g.contourbg path").style("fill",y(b-.5*c))}}),m(e)}},{"../../components/drawing":672,"../heatmap/style":1081,"./make_color_map":1028,"@plotly/d3":58}],1033:[function(r,I,B){var t=r("../../components/colorscale/defaults"),d=r("./label_defaults");I.exports=function(m,h,e,f,l){var o,u=e("contours.coloring"),s="";u==="fill"&&(o=e("contours.showlines")),o!==!1&&(u!=="lines"&&(s=e("line.color","#000")),e("line.width",.5),e("line.dash")),u!=="none"&&(m.showlegend!==!0&&(h.showlegend=!1),h._dfltShowLegend=!1,t(m,h,f,e,{prefix:"",cLetter:"z"})),e("line.smoothing"),d(e,f,s,l)}},{"../../components/colorscale/defaults":660,"./label_defaults":1027}],1034:[function(r,I,B){var t=r("../heatmap/attributes"),d=r("../contour/attributes"),m=r("../../components/colorscale/attributes"),h=r("../../lib/extend").extendFlat,e=d.contours;I.exports=h({carpet:{valType:"string",editType:"calc"},z:t.z,a:t.x,a0:t.x0,da:t.dx,b:t.y,b0:t.y0,db:t.dy,text:t.text,hovertext:t.hovertext,transpose:t.transpose,atype:t.xtype,btype:t.ytype,fillcolor:d.fillcolor,autocontour:d.autocontour,ncontours:d.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:d.line.color,width:d.line.width,dash:d.line.dash,smoothing:d.line.smoothing,editType:"plot"},transforms:void 0},m("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../contour/attributes":1012,"../heatmap/attributes":1069}],1035:[function(r,I,B){var t=r("../../components/colorscale/calc"),d=r("../../lib"),m=r("../heatmap/convert_column_xyz"),h=r("../heatmap/clean_2d_array"),e=r("../heatmap/interp2d"),f=r("../heatmap/find_empties"),l=r("../heatmap/make_bound_array"),o=r("./defaults"),u=r("../carpet/lookup_carpetid"),s=r("../contour/set_contours");I.exports=function(i,c){var n=c._carpetTrace=u(i,c);if(n&&n.visible&&n.visible!=="legendonly"){if(!c.a||!c.b){var a=i.data[n.index],g=i.data[c.index];g.a||(g.a=a.a),g.b||(g.b=a.b),o(g,c,c._defaultColor,i._fullLayout)}var p=function(y,v){var b,x,T,A,S,w,E,k=v._carpetTrace,L=k.aaxis,M=k.baxis;L._minDtick=0,M._minDtick=0,d.isArray1D(v.z)&&m(v,L,M,"a","b",["z"]),b=v._a=v._a||v.a,A=v._b=v._b||v.b,b=b?L.makeCalcdata(v,"_a"):[],A=A?M.makeCalcdata(v,"_b"):[],x=v.a0||0,T=v.da||1,S=v.b0||0,w=v.db||1,E=v._z=h(v._z||v.z,v.transpose),v._emptypoints=f(E),e(E,v._emptypoints);var P=d.maxRowLength(E),D=v.xtype==="scaled"?"":b,N=l(v,D,x,T,P,L),U=v.ytype==="scaled"?"":A,G=l(v,U,S,w,E.length,M),X={a:N,b:G,z:E};return v.contours.type==="levels"&&v.contours.coloring!=="none"&&t(y,v,{vals:E,containerStr:"",cLetter:"z"}),[X]}(i,c);return s(c,c._z),p}}},{"../../components/colorscale/calc":658,"../../lib":787,"../carpet/lookup_carpetid":985,"../contour/set_contours":1031,"../heatmap/clean_2d_array":1071,"../heatmap/convert_column_xyz":1073,"../heatmap/find_empties":1075,"../heatmap/interp2d":1078,"../heatmap/make_bound_array":1079,"./defaults":1036}],1036:[function(r,I,B){var t=r("../../lib"),d=r("../heatmap/xyz_defaults"),m=r("./attributes"),h=r("../contour/constraint_defaults"),e=r("../contour/contours_defaults"),f=r("../contour/style_defaults");I.exports=function(l,o,u,s){function i(c,n){return t.coerce(l,o,m,c,n)}if(i("carpet"),l.a&&l.b){if(!d(l,o,i,s,"a","b"))return void(o.visible=!1);i("text"),i("contours.type")==="constraint"?h(l,o,i,s,u,{hasHover:!1}):(e(l,o,i,function(c){return t.coerce2(l,o,m,c)}),f(l,o,i,s,{hasHover:!1}))}else o._defaultColor=u,o._length=null}},{"../../lib":787,"../contour/constraint_defaults":1017,"../contour/contours_defaults":1019,"../contour/style_defaults":1033,"../heatmap/xyz_defaults":1083,"./attributes":1034}],1037:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../contour/colorbar"),calc:r("./calc"),plot:r("./plot"),style:r("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":852,"../contour/colorbar":1015,"../contour/style":1032,"./attributes":1034,"./calc":1035,"./defaults":1036,"./plot":1038}],1038:[function(r,I,B){var t=r("@plotly/d3"),d=r("../carpet/map_1d_array"),m=r("../carpet/makepath"),h=r("../../components/drawing"),e=r("../../lib"),f=r("../contour/make_crossings"),l=r("../contour/find_all_paths"),o=r("../contour/plot"),u=r("../contour/constants"),s=r("../contour/convert_to_constraints"),i=r("../contour/empty_pathinfo"),c=r("../contour/close_boundaries"),n=r("../carpet/lookup_carpetid"),a=r("../carpet/axis_aligned_line");function g(v,b,x){var T=v.getPointAtLength(b),A=v.getPointAtLength(x),S=A.x-T.x,w=A.y-T.y,E=Math.sqrt(S*S+w*w);return[S/E,w/E]}function p(v){var b=Math.sqrt(v[0]*v[0]+v[1]*v[1]);return[v[0]/b,v[1]/b]}function y(v,b){var x=Math.abs(v[0]*b[0]+v[1]*b[1]);return Math.sqrt(1-x*x)/x}I.exports=function(v,b,x,T){var A=b.xaxis,S=b.yaxis;e.makeTraceGroups(T,x,"contour").each(function(w){var E=t.select(this),k=w[0],L=k.trace,M=L._carpetTrace=n(v,L),P=v.calcdata[M.index][0];if(M.visible&&M.visible!=="legendonly"){var D=k.a,N=k.b,U=L.contours,G=i(U,b,k),X=U.type==="constraint",K=U._operation,Z=X?K==="="?"lines":"fill":U.coloring,H=[[D[0],N[N.length-1]],[D[D.length-1],N[N.length-1]],[D[D.length-1],N[0]],[D[0],N[0]]];f(G);var Y=1e-8*(D[D.length-1]-D[0]),$=1e-8*(N[N.length-1]-N[0]);l(G,Y,$);var z,j,W,ee,J=G;U.type==="constraint"&&(J=s(G,K)),function(ae,he){var se,de,ue,ve,ke,Ee,be,xe,ce;for(se=0;se<ae.length;se++){for(ve=ae[se],ke=ve.pedgepaths=[],Ee=ve.ppaths=[],de=0;de<ve.edgepaths.length;de++){for(ce=ve.edgepaths[de],be=[],ue=0;ue<ce.length;ue++)be[ue]=he(ce[ue]);ke.push(be)}for(de=0;de<ve.paths.length;de++){for(ce=ve.paths[de],xe=[],ue=0;ue<ce.length;ue++)xe[ue]=he(ce[ue]);Ee.push(xe)}}}(G,ie);var Q=[];for(ee=P.clipsegments.length-1;ee>=0;ee--)z=P.clipsegments[ee],j=d([],z.x,A.c2p),W=d([],z.y,S.c2p),j.reverse(),W.reverse(),Q.push(m(j,W,z.bicubic));var te="M"+Q.join("L")+"Z";(function(ae,he,se,de,ue,ve){var ke,Ee,be,xe,ce=e.ensureSingle(ae,"g","contourbg").selectAll("path").data(ve!=="fill"||ue?[]:[0]);ce.enter().append("path"),ce.exit().remove();var ge=[];for(xe=0;xe<he.length;xe++)ke=he[xe],Ee=d([],ke.x,se.c2p),be=d([],ke.y,de.c2p),ge.push(m(Ee,be,ke.bicubic));ce.attr("d","M"+ge.join("L")+"Z").style("stroke","none")})(E,P.clipsegments,A,S,X,Z),function(ae,he,se,de,ue,ve,ke,Ee,be,xe,ce){var ge=xe==="fill";ge&&c(ue,ae.contours);var we=e.ensureSingle(he,"g","contourfill").selectAll("path").data(ge?ue:[]);we.enter().append("path"),we.exit().remove(),we.each(function(Me){var Se=(Me.prefixBoundary?ce:"")+function(ze,Fe,Ye,rt,Oe,je,We,qe){var et,st,ct,Pt,kt,at,tt,_t="",er=Fe.edgepaths.map(function(ht,Mt){return Mt}),tr=!0,Ue=1e-4*Math.abs(Ye[0][0]-Ye[2][0]),He=1e-4*Math.abs(Ye[0][1]-Ye[2][1]);function Be(ht){return Math.abs(ht[1]-Ye[0][1])<He}function Ke(ht){return Math.abs(ht[1]-Ye[2][1])<He}function _e(ht){return Math.abs(ht[0]-Ye[0][0])<Ue}function Ce(ht){return Math.abs(ht[0]-Ye[2][0])<Ue}function Le(ht,Mt){var pt,Lt,vt,Dt,xt="";for(Be(ht)&&!Ce(ht)||Ke(ht)&&!_e(ht)?(Dt=Oe.aaxis,vt=a(Oe,je,[ht[0],Mt[0]],.5*(ht[1]+Mt[1]))):(Dt=Oe.baxis,vt=a(Oe,je,.5*(ht[0]+Mt[0]),[ht[1],Mt[1]])),pt=1;pt<vt.length;pt++)for(xt+=Dt.smoothing?"C":"L",Lt=0;Lt<vt[pt].length;Lt++){var it=vt[pt][Lt];xt+=[We.c2p(it[0]),qe.c2p(it[1])]+" "}return xt}for(et=0,st=null;er.length;){var Pe=Fe.edgepaths[et][0];for(st&&(_t+=Le(st,Pe)),tt=h.smoothopen(Fe.edgepaths[et].map(rt),Fe.smoothing),_t+=tr?tt:tt.replace(/^M/,"L"),er.splice(er.indexOf(et),1),st=Fe.edgepaths[et][Fe.edgepaths[et].length-1],kt=-1,Pt=0;Pt<4;Pt++){if(!st){e.log("Missing end?",et,Fe);break}for(Be(st)&&!Ce(st)?ct=Ye[1]:_e(st)?ct=Ye[0]:Ke(st)?ct=Ye[3]:Ce(st)&&(ct=Ye[2]),at=0;at<Fe.edgepaths.length;at++){var Xe=Fe.edgepaths[at][0];Math.abs(st[0]-ct[0])<Ue?Math.abs(st[0]-Xe[0])<Ue&&(Xe[1]-st[1])*(ct[1]-Xe[1])>=0&&(ct=Xe,kt=at):Math.abs(st[1]-ct[1])<He?Math.abs(st[1]-Xe[1])<He&&(Xe[0]-st[0])*(ct[0]-Xe[0])>=0&&(ct=Xe,kt=at):e.log("endpt to newendpt is not vert. or horz.",st,ct,Xe)}if(kt>=0)break;_t+=Le(st,ct),st=ct}if(kt===Fe.edgepaths.length){e.log("unclosed perimeter path");break}et=kt,(tr=er.indexOf(et)===-1)&&(et=er[0],_t+=Le(st,ct)+"Z",st=null)}for(et=0;et<Fe.paths.length;et++)_t+=h.smoothclosed(Fe.paths[et].map(rt),Fe.smoothing);return _t}(0,Me,ve,ke,Ee,be,se,de);Se?t.select(this).attr("d",Se).style("stroke","none"):t.select(this).remove()})}(L,E,A,S,J,H,ie,M,P,Z,te),function(ae,he,se,de,ue,ve,ke){var Ee=e.ensureSingle(ae,"g","contourlines"),be=ue.showlines!==!1,xe=ue.showlabels,ce=be&&xe,ge=o.createLines(Ee,be||xe,he),we=o.createLineClip(Ee,ce,se,de.trace.uid),Me=ae.selectAll("g.contourlabels").data(xe?[0]:[]);if(Me.exit().remove(),Me.enter().append("g").classed("contourlabels",!0),xe){var Se=ve.xaxis,ze=ve.yaxis,Fe=Se._length,Ye=ze._length,rt=[[[0,0],[Fe,0],[Fe,Ye],[0,Ye]]],Oe=[];e.clearLocationCache();var je=o.labelFormatter(se,de),We=h.tester.append("text").attr("data-notex",1).call(h.font,ue.labelfont),qe={left:0,right:Fe,center:Fe/2,top:0,bottom:Ye,middle:Ye/2},et=Math.sqrt(Fe*Fe+Ye*Ye),st=u.LABELDISTANCE*et/Math.max(1,he.length/u.LABELINCREASE);ge.each(function(ct){var Pt=o.calcTextOpts(ct.level,je,We,se);t.select(this).selectAll("path").each(function(kt){var at=e.getVisibleSegment(this,qe,Pt.height/2);if(at&&(function(tr,Ue,He,Be,Ke,_e){for(var Ce,Le=0;Le<He.pedgepaths.length;Le++)Ue===He.pedgepaths[Le]&&(Ce=He.edgepaths[Le]);if(!Ce)return;var Pe=Ke.a[0],Xe=Ke.a[Ke.a.length-1],ht=Ke.b[0],Mt=Ke.b[Ke.b.length-1];function pt(it,St){var Nt,Ut=0;return(Math.abs(it[0]-Pe)<.1||Math.abs(it[0]-Xe)<.1)&&(Nt=p(Ke.dxydb_rough(it[0],it[1],.1)),Ut=Math.max(Ut,_e*y(St,Nt)/2)),(Math.abs(it[1]-ht)<.1||Math.abs(it[1]-Mt)<.1)&&(Nt=p(Ke.dxyda_rough(it[0],it[1],.1)),Ut=Math.max(Ut,_e*y(St,Nt)/2)),Ut}var Lt=g(tr,0,1),vt=g(tr,Be.total,Be.total-1),Dt=pt(Ce[0],Lt),xt=Be.total-pt(Ce[Ce.length-1],vt);Be.min<Dt&&(Be.min=Dt),Be.max>xt&&(Be.max=xt),Be.len=Be.max-Be.min}(this,kt,ct,at,ke,Pt.height),!(at.len<(Pt.width+Pt.height)*u.LABELMIN)))for(var tt=Math.min(Math.ceil(at.len/st),u.LABELMAX),_t=0;_t<tt;_t++){var er=o.findBestTextLocation(this,at,Pt,Oe,qe);if(!er)break;o.addLabelData(er,Pt,Oe,rt)}})}),We.remove(),o.drawLabels(Me,Oe,se,we,ce?rt:null)}xe&&!be&&ge.remove()}(E,G,v,k,U,b,M),h.setClipUrl(E,M._clipPathId,v)}function ie(ae){var he=M.ab2xy(ae[0],ae[1],!0);return[A.c2p(he[0]),S.c2p(he[1])]}})}},{"../../components/drawing":672,"../../lib":787,"../carpet/axis_aligned_line":969,"../carpet/lookup_carpetid":985,"../carpet/makepath":986,"../carpet/map_1d_array":987,"../contour/close_boundaries":1014,"../contour/constants":1016,"../contour/convert_to_constraints":1020,"../contour/empty_pathinfo":1022,"../contour/find_all_paths":1024,"../contour/make_crossings":1029,"../contour/plot":1030,"@plotly/d3":58}],1039:[function(r,I,B){var t=r("../../components/colorscale/attributes"),d=r("../../plots/template_attributes").hovertemplateAttrs,m=r("../../plots/attributes"),h=r("../scattermapbox/attributes"),e=r("../../lib/extend").extendFlat;I.exports=e({lon:h.lon,lat:h.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:h.text,hovertext:h.hovertext,hoverinfo:e({},m.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:d(),showlegend:e({},m.showlegend,{dflt:!1})},t("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scattermapbox/attributes":1267}],1040:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib").isArrayOrTypedArray,m=r("../../constants/numerical").BADNUM,h=r("../../components/colorscale/calc"),e=r("../../lib")._;I.exports=function(f,l){for(var o=l._length,u=new Array(o),s=l.z,i=d(s)&&s.length,c=0;c<o;c++){var n=u[c]={},a=l.lon[c],g=l.lat[c];if(n.lonlat=t(a)&&t(g)?[+a,+g]:[m,m],i){var p=s[c];n.z=t(p)?p:m}}return h(f,l,{vals:i?s:[0,1],containerStr:"",cLetter:"z"}),o&&(u[0].t={labels:{lat:e(f,"lat:")+" ",lon:e(f,"lon:")+" "}}),u}},{"../../components/colorscale/calc":658,"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],1041:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../components/color"),h=r("../../components/colorscale"),e=r("../../constants/numerical").BADNUM,f=r("../../lib/geojson_utils").makeBlank;I.exports=function(l){var o=l[0].trace,u=o.visible===!0&&o._length!==0,s=o._opts={heatmap:{layout:{visibility:"none"},paint:{}},geojson:f()};if(!u)return s;var i,c=[],n=o.z,a=o.radius,g=d.isArrayOrTypedArray(n)&&n.length,p=d.isArrayOrTypedArray(a);for(i=0;i<l.length;i++){var y=l[i],v=y.lonlat;if(v[0]!==e){var b={};if(g){var x=y.z;b.z=x!==e?x:0}p&&(b.r=t(a[i])&&a[i]>0?+a[i]:0),c.push({type:"Feature",geometry:{type:"Point",coordinates:v},properties:b})}}var T=h.extractOpts(o),A=T.reversescale?h.flipScale(T.colorscale):T.colorscale,S=A[0][1],w=["interpolate",["linear"],["heatmap-density"],0,m.opacity(S)<1?S:m.addOpacity(S,0)];for(i=1;i<A.length;i++)w.push(A[i][0],A[i][1]);var E=["interpolate",["linear"],["get","z"],T.min,0,T.max,1];return d.extendFlat(s.heatmap.paint,{"heatmap-weight":g?E:1/(T.max-T.min),"heatmap-color":w,"heatmap-radius":p?{type:"identity",property:"r"}:o.radius,"heatmap-opacity":o.opacity}),s.geojson={type:"FeatureCollection",features:c},s.heatmap.layout.visibility="visible",s}},{"../../components/color":650,"../../components/colorscale":662,"../../constants/numerical":763,"../../lib":787,"../../lib/geojson_utils":781,"fast-isnumeric":246}],1042:[function(r,I,B){var t=r("../../lib"),d=r("../../components/colorscale/defaults"),m=r("./attributes");I.exports=function(h,e,f,l){function o(c,n){return t.coerce(h,e,m,c,n)}var u=o("lon")||[],s=o("lat")||[],i=Math.min(u.length,s.length);i?(e._length=i,o("z"),o("radius"),o("below"),o("text"),o("hovertext"),o("hovertemplate"),d(h,e,l,o,{prefix:"",cLetter:"z"})):e.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":1039}],1043:[function(r,I,B){I.exports=function(t,d){return t.lon=d.lon,t.lat=d.lat,t.z=d.z,t}},{}],1044:[function(r,I,B){var t=r("../../plots/cartesian/axes"),d=r("../scattermapbox/hover").hoverPoints,m=r("../scattermapbox/hover").getExtraText;I.exports=function(h,e,f){var l=d(h,e,f);if(l){var o=l[0],u=o.cd,s=u[0].trace,i=u[o.index];if(delete o.color,"z"in i){var c=o.subplot.mockAxis;o.z=i.z,o.zLabel=t.tickText(c,c.c2l(i.z),"hover").text}return o.extraText=m(s,i,u[0].t.labels),[o]}}},{"../../plots/cartesian/axes":838,"../scattermapbox/hover":1272}],1045:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../heatmap/colorbar"),formatLabels:r("../scattermapbox/format_labels"),calc:r("./calc"),plot:r("./plot"),hoverPoints:r("./hover"),eventData:r("./event_data"),getBelow:function(t,d){for(var m=d.getMapLayers(),h=0;h<m.length;h++){var e=m[h],f=e.id;if(e.type==="symbol"&&typeof f=="string"&&f.indexOf("plotly-")===-1)return f}},moduleType:"trace",name:"densitymapbox",basePlotModule:r("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":895,"../heatmap/colorbar":1072,"../scattermapbox/format_labels":1271,"./attributes":1039,"./calc":1040,"./defaults":1042,"./event_data":1043,"./hover":1044,"./plot":1046}],1046:[function(r,I,B){var t=r("./convert"),d=r("../../plots/mapbox/constants").traceLayerPrefix;function m(e,f){this.type="densitymapbox",this.subplot=e,this.uid=f,this.sourceId="source-"+f,this.layerList=[["heatmap",d+f+"-heatmap"]],this.below=null}var h=m.prototype;h.update=function(e){var f=this.subplot,l=this.layerList,o=t(e),u=f.belowLookup["trace-"+this.uid];f.map.getSource(this.sourceId).setData(o.geojson),u!==this.below&&(this._removeLayers(),this._addLayers(o,u),this.below=u);for(var s=0;s<l.length;s++){var i=l[s],c=i[0],n=i[1],a=o[c];f.setOptions(n,"setLayoutProperty",a.layout),a.layout.visibility==="visible"&&f.setOptions(n,"setPaintProperty",a.paint)}},h._addLayers=function(e,f){for(var l=this.subplot,o=this.layerList,u=this.sourceId,s=0;s<o.length;s++){var i=o[s],c=i[0],n=e[c];l.addLayer({type:c,id:i[1],source:u,layout:n.layout,paint:n.paint},f)}},h._removeLayers=function(){for(var e=this.subplot.map,f=this.layerList,l=f.length-1;l>=0;l--)e.removeLayer(f[l][1])},h.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},I.exports=function(e,f){var l=f[0].trace,o=new m(e,l.uid),u=o.sourceId,s=t(f),i=o.below=e.belowLookup["trace-"+l.uid];return e.map.addSource(u,{type:"geojson",data:s.geojson}),o._addLayers(s,i),o}},{"../../plots/mapbox/constants":893,"./convert":1041}],1047:[function(r,I,B){var t=r("../../lib");I.exports=function(d,m){for(var h=0;h<d.length;h++)d[h].i=h;t.mergeArray(m.text,d,"tx"),t.mergeArray(m.hovertext,d,"htx");var e=m.marker;if(e){t.mergeArray(e.opacity,d,"mo"),t.mergeArray(e.color,d,"mc");var f=e.line;f&&(t.mergeArray(f.color,d,"mlc"),t.mergeArrayCastPositive(f.width,d,"mlw"))}}},{"../../lib":787}],1048:[function(r,I,B){var t,d=r("../bar/attributes"),m=r("../scatter/attributes").line,h=r("../../plots/attributes"),e=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,f=r("../../plots/template_attributes").hovertemplateAttrs,l=r("../../plots/template_attributes").texttemplateAttrs,o=r("./constants"),u=r("../../lib/extend").extendFlat,s=r("../../components/color");I.exports={x:d.x,x0:d.x0,dx:d.dx,y:d.y,y0:d.y0,dy:d.dy,xperiod:d.xperiod,yperiod:d.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:d.xperiodalignment,yperiodalignment:d.yperiodalignment,xhoverformat:e("x"),yhoverformat:e("y"),hovertext:d.hovertext,hovertemplate:f({},{keys:o.eventDataKeys}),hoverinfo:u({},h.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:l({editType:"plot"},{keys:o.eventDataKeys.concat(["label","value"])}),text:d.text,textposition:d.textposition,insidetextanchor:u({},d.insidetextanchor,{dflt:"middle"}),textangle:u({},d.textangle,{dflt:0}),textfont:d.textfont,insidetextfont:d.insidetextfont,outsidetextfont:d.outsidetextfont,constraintext:d.constraintext,cliponaxis:d.cliponaxis,orientation:u({},d.orientation,{}),offset:u({},d.offset,{arrayOk:!1}),width:u({},d.width,{arrayOk:!1}),marker:(t=u({},d.marker),delete t.pattern,t),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:u({},m.color,{dflt:s.defaultLine}),width:u({},m.width,{dflt:0,editType:"plot"}),dash:m.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:d.offsetgroup,alignmentgroup:d.alignmentgroup}},{"../../components/color":650,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../bar/attributes":925,"../scatter/attributes":1202,"./constants":1050}],1049:[function(r,I,B){var t=r("../../plots/cartesian/axes"),d=r("../../plots/cartesian/align_period"),m=r("./arrays_to_calcdata"),h=r("../scatter/calc_selection"),e=r("../../constants/numerical").BADNUM;function f(l){return l===e?0:l}I.exports=function(l,o){var u,s,i,c,n,a,g,p,y=t.getFromId(l,o.xaxis||"x"),v=t.getFromId(l,o.yaxis||"y");o.orientation==="h"?(u=y.makeCalcdata(o,"x"),i=v.makeCalcdata(o,"y"),c=d(o,v,"y",i),n=!!o.yperiodalignment,a="y"):(u=v.makeCalcdata(o,"y"),i=y.makeCalcdata(o,"x"),c=d(o,y,"x",i),n=!!o.xperiodalignment,a="x"),s=c.vals;var b,x=Math.min(s.length,u.length),T=new Array(x);for(o._base=[],g=0;g<x;g++){u[g]<0&&(u[g]=e);var A=!1;u[g]!==e&&g+1<x&&u[g+1]!==e&&(A=!0),p=T[g]={p:s[g],s:u[g],cNext:A},o._base[g]=-.5*p.s,n&&(T[g].orig_p=i[g],T[g][a+"End"]=c.ends[g],T[g][a+"Start"]=c.starts[g]),o.ids&&(p.id=String(o.ids[g])),g===0&&(T[0].vTotal=0),T[0].vTotal+=f(p.s),p.begR=f(p.s)/f(T[0].s)}for(g=0;g<x;g++)(p=T[g]).s!==e&&(p.sumR=p.s/T[0].vTotal,p.difR=b!==void 0?p.s/b:1,b=p.s);return m(T,o),h(T,o),T}},{"../../constants/numerical":763,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../scatter/calc_selection":1204,"./arrays_to_calcdata":1047}],1050:[function(r,I,B){I.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],1051:[function(r,I,B){var t=r("../bar/cross_trace_calc").setGroupPositions;I.exports=function(d,m){var h,e,f=d._fullLayout,l=d._fullData,o=d.calcdata,u=m.xaxis,s=m.yaxis,i=[],c=[],n=[];for(e=0;e<l.length;e++){var a=l[e],g=a.orientation==="h";a.visible===!0&&a.xaxis===u._id&&a.yaxis===s._id&&a.type==="funnel"&&(h=o[e],g?n.push(h):c.push(h),i.push(h))}var p={mode:f.funnelmode,norm:f.funnelnorm,gap:f.funnelgap,groupgap:f.funnelgroupgap};for(t(d,u,s,c,p),t(d,s,u,n,p),e=0;e<i.length;e++){h=i[e];for(var y=0;y<h.length;y++)y+1<h.length&&(h[y].nextP0=h[y+1].p0,h[y].nextS0=h[y+1].s0,h[y].nextP1=h[y+1].p1,h[y].nextS1=h[y+1].s1)}}},{"../bar/cross_trace_calc":928}],1052:[function(r,I,B){var t=r("../../lib"),d=r("../bar/defaults").handleGroupingDefaults,m=r("../bar/defaults").handleText,h=r("../scatter/xy_defaults"),e=r("../scatter/period_defaults"),f=r("./attributes"),l=r("../../components/color");I.exports={supplyDefaults:function(o,u,s,i){function c(p,y){return t.coerce(o,u,f,p,y)}if(h(o,u,i,c)){e(o,u,i,c),c("xhoverformat"),c("yhoverformat"),c("orientation",u.y&&!u.x?"v":"h"),c("offset"),c("width");var n=c("text");c("hovertext"),c("hovertemplate");var a=c("textposition");m(o,u,i,c,a,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),u.textposition==="none"||u.texttemplate||c("textinfo",Array.isArray(n)?"text+value":"value");var g=c("marker.color",s);c("marker.line.color",l.defaultLine),c("marker.line.width"),c("connector.visible")&&(c("connector.fillcolor",function(p){var y=t.isArrayOrTypedArray(p)?"#000":p;return l.addOpacity(y,.5*l.opacity(y))}(g)),c("connector.line.width")&&(c("connector.line.color"),c("connector.line.dash")))}else u.visible=!1},crossTraceDefaults:function(o,u){var s,i;function c(a){return t.coerce(i._input,i,f,a)}if(u.funnelmode==="group")for(var n=0;n<o.length;n++)s=(i=o[n])._input,d(s,i,u,c)}}},{"../../components/color":650,"../../lib":787,"../bar/defaults":929,"../scatter/period_defaults":1222,"../scatter/xy_defaults":1229,"./attributes":1048}],1053:[function(r,I,B){I.exports=function(t,d){return t.x="xVal"in d?d.xVal:d.x,t.y="yVal"in d?d.yVal:d.y,"percentInitial"in d&&(t.percentInitial=d.percentInitial),"percentPrevious"in d&&(t.percentPrevious=d.percentPrevious),"percentTotal"in d&&(t.percentTotal=d.percentTotal),d.xa&&(t.xaxis=d.xa),d.ya&&(t.yaxis=d.ya),t}},{}],1054:[function(r,I,B){var t=r("../../components/color").opacity,d=r("../bar/hover").hoverOnBars,m=r("../../lib").formatPercent;I.exports=function(h,e,f,l,o){var u=d(h,e,f,l,o);if(u){var s=u.cd,i=s[0].trace,c=i.orientation==="h",n=s[u.index];u[(c?"x":"y")+"LabelVal"]=n.s,u.percentInitial=n.begR,u.percentInitialLabel=m(n.begR,1),u.percentPrevious=n.difR,u.percentPreviousLabel=m(n.difR,1),u.percentTotal=n.sumR,u.percentTotalLabel=m(n.sumR,1);var a=n.hi||i.hoverinfo,g=[];if(a&&a!=="none"&&a!=="skip"){var p=a==="all",y=a.split("+"),v=function(b){return p||y.indexOf(b)!==-1};v("percent initial")&&g.push(u.percentInitialLabel+" of initial"),v("percent previous")&&g.push(u.percentPreviousLabel+" of previous"),v("percent total")&&g.push(u.percentTotalLabel+" of total")}return u.extraText=g.join("<br>"),u.color=function(b,x){var T=b.marker,A=x.mc||T.color,S=x.mlc||T.line.color,w=x.mlw||T.line.width;if(t(A))return A;if(t(S)&&w)return S}(i,n),[u]}}},{"../../components/color":650,"../../lib":787,"../bar/hover":932}],1055:[function(r,I,B){I.exports={attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults").supplyDefaults,crossTraceDefaults:r("./defaults").crossTraceDefaults,supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc"),crossTraceCalc:r("./cross_trace_calc"),plot:r("./plot"),style:r("./style").style,hoverPoints:r("./hover"),eventData:r("./event_data"),selectPoints:r("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:r("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"../bar/select":937,"./attributes":1048,"./calc":1049,"./cross_trace_calc":1051,"./defaults":1052,"./event_data":1053,"./hover":1054,"./layout_attributes":1056,"./layout_defaults":1057,"./plot":1058,"./style":1059}],1056:[function(r,I,B){I.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1057:[function(r,I,B){var t=r("../../lib"),d=r("./layout_attributes");I.exports=function(m,h,e){var f=!1;function l(s,i){return t.coerce(m,h,d,s,i)}for(var o=0;o<e.length;o++){var u=e[o];if(u.visible&&u.type==="funnel"){f=!0;break}}f&&(l("funnelmode"),l("funnelgap",.2),l("funnelgroupgap"))}},{"../../lib":787,"./layout_attributes":1056}],1058:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../components/drawing"),h=r("../../constants/numerical").BADNUM,e=r("../bar/plot"),f=r("../bar/uniform_text").clearMinTextSize;function l(o,u,s,i){var c=[],n=[],a=i?u:s,g=i?s:u;return c[0]=a.c2p(o.s0,!0),n[0]=g.c2p(o.p0,!0),c[1]=a.c2p(o.s1,!0),n[1]=g.c2p(o.p1,!0),c[2]=a.c2p(o.nextS0,!0),n[2]=g.c2p(o.nextP0,!0),c[3]=a.c2p(o.nextS1,!0),n[3]=g.c2p(o.nextP1,!0),i?[c,n]:[n,c]}I.exports=function(o,u,s,i){var c=o._fullLayout;f("funnel",c),function(n,a,g,p){var y=a.xaxis,v=a.yaxis;d.makeTraceGroups(p,g,"trace bars").each(function(b){var x=t.select(this),T=b[0].trace,A=d.ensureSingle(x,"g","regions");if(T.connector&&T.connector.visible){var S=T.orientation==="h",w=A.selectAll("g.region").data(d.identity);w.enter().append("g").classed("region",!0),w.exit().remove();var E=w.size();w.each(function(k,L){if(L===E-1||k.cNext){var M=l(k,y,v,S),P=M[0],D=M[1],N="";P[0]!==h&&D[0]!==h&&P[1]!==h&&D[1]!==h&&P[2]!==h&&D[2]!==h&&P[3]!==h&&D[3]!==h&&(N+=S?"M"+P[0]+","+D[1]+"L"+P[2]+","+D[2]+"H"+P[3]+"L"+P[1]+","+D[1]+"Z":"M"+P[1]+","+D[1]+"L"+P[2]+","+D[3]+"V"+D[2]+"L"+P[1]+","+D[0]+"Z"),N===""&&(N="M0,0Z"),d.ensureSingle(t.select(this),"path").attr("d",N).call(m.setClipUrl,a.layerClipId,n)}})}else A.remove()})}(o,u,s,i),function(n,a,g,p){var y=a.xaxis,v=a.yaxis;d.makeTraceGroups(p,g,"trace bars").each(function(b){var x=t.select(this),T=b[0].trace,A=d.ensureSingle(x,"g","lines");if(T.connector&&T.connector.visible&&T.connector.line.width){var S=T.orientation==="h",w=A.selectAll("g.line").data(d.identity);w.enter().append("g").classed("line",!0),w.exit().remove();var E=w.size();w.each(function(k,L){if(L===E-1||k.cNext){var M=l(k,y,v,S),P=M[0],D=M[1],N="";P[3]!==void 0&&D[3]!==void 0&&(S?(N+="M"+P[0]+","+D[1]+"L"+P[2]+","+D[2],N+="M"+P[1]+","+D[1]+"L"+P[3]+","+D[2]):(N+="M"+P[1]+","+D[1]+"L"+P[2]+","+D[3],N+="M"+P[1]+","+D[0]+"L"+P[2]+","+D[2])),N===""&&(N="M0,0Z"),d.ensureSingle(t.select(this),"path").attr("d",N).call(m.setClipUrl,a.layerClipId,n)}})}else A.remove()})}(o,u,s,i),e.plot(o,u,s,i,{mode:c.funnelmode,norm:c.funnelmode,gap:c.funnelgap,groupgap:c.funnelgroupgap})}},{"../../components/drawing":672,"../../constants/numerical":763,"../../lib":787,"../bar/plot":936,"../bar/uniform_text":941,"@plotly/d3":58}],1059:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/drawing"),m=r("../../components/color"),h=r("../../constants/interactions").DESELECTDIM,e=r("../bar/style"),f=r("../bar/uniform_text").resizeText,l=e.styleTextPoints;I.exports={style:function(o,u,s){var i=s||t.select(o).selectAll("g.funnellayer").selectAll("g.trace");f(o,i,"funnel"),i.style("opacity",function(c){return c[0].trace.opacity}),i.each(function(c){var n=t.select(this),a=c[0].trace;n.selectAll(".point > path").each(function(g){if(!g.isBlank){var p=a.marker;t.select(this).call(m.fill,g.mc||p.color).call(m.stroke,g.mlc||p.line.color).call(d.dashLine,p.line.dash,g.mlw||p.line.width).style("opacity",a.selectedpoints&&!g.selected?h:1)}}),l(n,a,o),n.selectAll(".regions").each(function(){t.select(this).selectAll("path").style("stroke-width",0).call(m.fill,a.connector.fillcolor)}),n.selectAll(".lines").each(function(){var g=a.connector.line;d.lineGroupStyle(t.select(this).selectAll("path"),g.width,g.color,g.dash)})})}}},{"../../components/color":650,"../../components/drawing":672,"../../constants/interactions":762,"../bar/style":939,"../bar/uniform_text":941,"@plotly/d3":58}],1060:[function(r,I,B){var t=r("../pie/attributes"),d=r("../../plots/attributes"),m=r("../../plots/domain").attributes,h=r("../../plots/template_attributes").hovertemplateAttrs,e=r("../../plots/template_attributes").texttemplateAttrs,f=r("../../lib/extend").extendFlat;I.exports={labels:t.labels,label0:t.label0,dlabel:t.dlabel,values:t.values,marker:{colors:t.marker.colors,line:{color:f({},t.marker.line.color,{dflt:null}),width:f({},t.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:t.text,hovertext:t.hovertext,scalegroup:f({},t.scalegroup,{}),textinfo:f({},t.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:f({},d.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:h({},{keys:["label","color","value","text","percent"]}),textposition:f({},t.textposition,{values:["inside","none"],dflt:"inside"}),textfont:t.textfont,insidetextfont:t.insidetextfont,title:{text:t.title.text,font:t.title.font,position:f({},t.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:m({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":777,"../../plots/attributes":834,"../../plots/domain":866,"../../plots/template_attributes":910,"../pie/attributes":1176}],1061:[function(r,I,B){var t=r("../../plots/plots");B.name="funnelarea",B.plot=function(d,m,h,e){t.plotBasePlot(B.name,d,m,h,e)},B.clean=function(d,m,h,e){t.cleanBasePlot(B.name,d,m,h,e)}},{"../../plots/plots":901}],1062:[function(r,I,B){var t=r("../pie/calc");I.exports={calc:function(d,m){return t.calc(d,m)},crossTraceCalc:function(d){t.crossTraceCalc(d,{type:"funnelarea"})}}},{"../pie/calc":1178}],1063:[function(r,I,B){var t=r("../../lib"),d=r("./attributes"),m=r("../../plots/domain").defaults,h=r("../bar/defaults").handleText,e=r("../pie/defaults").handleLabelsAndValues;I.exports=function(f,l,o,u){function s(b,x){return t.coerce(f,l,d,b,x)}var i=s("labels"),c=s("values"),n=e(i,c),a=n.len;if(l._hasLabels=n.hasLabels,l._hasValues=n.hasValues,!l._hasLabels&&l._hasValues&&(s("label0"),s("dlabel")),a){l._length=a,s("marker.line.width")&&s("marker.line.color",u.paper_bgcolor),s("marker.colors"),s("scalegroup");var g,p=s("text"),y=s("texttemplate");if(y||(g=s("textinfo",Array.isArray(p)?"text+percent":"percent")),s("hovertext"),s("hovertemplate"),y||g&&g!=="none"){var v=s("textposition");h(f,l,u,s,v,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}m(l,u,s),s("title.text")&&(s("title.position"),t.coerceFont(s,"title.font",u.font)),s("aspectratio"),s("baseratio")}else l.visible=!1}},{"../../lib":787,"../../plots/domain":866,"../bar/defaults":929,"../pie/defaults":1179,"./attributes":1060}],1064:[function(r,I,B){I.exports={moduleType:"trace",name:"funnelarea",basePlotModule:r("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot"),style:r("./style"),styleOne:r("../pie/style_one"),meta:{}}},{"../pie/style_one":1187,"./attributes":1060,"./base_plot":1061,"./calc":1062,"./defaults":1063,"./layout_attributes":1065,"./layout_defaults":1066,"./plot":1067,"./style":1068}],1065:[function(r,I,B){var t=r("../pie/layout_attributes").hiddenlabels;I.exports={hiddenlabels:t,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":1183}],1066:[function(r,I,B){var t=r("../../lib"),d=r("./layout_attributes");I.exports=function(m,h){function e(f,l){return t.coerce(m,h,d,f,l)}e("hiddenlabels"),e("funnelareacolorway",h.colorway),e("extendfunnelareacolors")}},{"../../lib":787,"./layout_attributes":1065}],1067:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/drawing"),m=r("../../lib"),h=m.strScale,e=m.strTranslate,f=r("../../lib/svg_text_utils"),l=r("../bar/plot").toMoveInsideBar,o=r("../bar/uniform_text"),u=o.recordMinTextSize,s=o.clearMinTextSize,i=r("../pie/helpers"),c=r("../pie/plot"),n=c.attachFxHandlers,a=c.determineInsideTextFont,g=c.layoutAreas,p=c.prerenderTitles,y=c.positionTitleOutside,v=c.formatSliceLabel;function b(x,T){return"l"+(T[0]-x[0])+","+(T[1]-x[1])}I.exports=function(x,T){var A=x._fullLayout;s("funnelarea",A),p(T,x),g(T,A._size),m.makeTraceGroups(A._funnelarealayer,T,"trace").each(function(S){var w=t.select(this),E=S[0],k=E.trace;(function(L){if(!L.length)return;var M=L[0],P=M.trace,D=P.aspectratio,N=P.baseratio;N>.999&&(N=.999);var U,G=Math.pow(N,2),X=M.vTotal,K=X,Z=X*G/(1-G)/X;function H(){var be,xe={x:be=Math.sqrt(Z),y:-be};return[xe.x,xe.y]}var Y,$,z=[];for(z.push(H()),Y=L.length-1;Y>-1;Y--)if(!($=L[Y]).hidden){var j=$.v/K;Z+=j,z.push(H())}var W=1/0,ee=-1/0;for(Y=0;Y<z.length;Y++)U=z[Y],W=Math.min(W,U[1]),ee=Math.max(ee,U[1]);for(Y=0;Y<z.length;Y++)z[Y][1]-=(ee+W)/2;var J=z[z.length-1][0],Q=M.r,te=(ee-W)/2,ie=Q/J,ae=Q/te*D;for(M.r=ae*te,Y=0;Y<z.length;Y++)z[Y][0]*=ie,z[Y][1]*=ae;var he=[-(U=z[0])[0],U[1]],se=[U[0],U[1]],de=0;for(Y=L.length-1;Y>-1;Y--)if(!($=L[Y]).hidden){var ue=z[de+=1][0],ve=z[de][1];$.TL=[-ue,ve],$.TR=[ue,ve],$.BL=he,$.BR=se,$.pxmid=(ke=$.TR,Ee=$.BR,[.5*(ke[0]+Ee[0]),.5*(ke[1]+Ee[1])]),he=$.TL,se=$.TR}var ke,Ee})(S),w.each(function(){var L=t.select(this).selectAll("g.slice").data(S);L.enter().append("g").classed("slice",!0),L.exit().remove(),L.each(function(P,D){if(P.hidden)t.select(this).selectAll("path,g").remove();else{P.pointNumber=P.i,P.curveNumber=k.index;var N=E.cx,U=E.cy,G=t.select(this),X=G.selectAll("path.surface").data([P]);X.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),G.call(n,x,S);var K="M"+(N+P.TR[0])+","+(U+P.TR[1])+b(P.TR,P.BR)+b(P.BR,P.BL)+b(P.BL,P.TL)+"Z";X.attr("d",K),v(x,P,E);var Z=i.castOption(k.textposition,P.pts),H=G.selectAll("g.slicetext").data(P.text&&Z!=="none"?[0]:[]);H.enter().append("g").classed("slicetext",!0),H.exit().remove(),H.each(function(){var Y=m.ensureSingle(t.select(this),"text","",function(te){te.attr("data-notex",1)}),$=m.ensureUniformFontSize(x,a(k,P,A.font));Y.text(P.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(d.font,$).call(f.convertToTspans,x);var z,j,W,ee=d.bBox(Y.node()),J=Math.min(P.BL[1],P.BR[1])+U,Q=Math.max(P.TL[1],P.TR[1])+U;j=Math.max(P.TL[0],P.BL[0])+N,W=Math.min(P.TR[0],P.BR[0])+N,(z=l(j,W,J,Q,ee,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"})).fontSize=$.size,u(k.type,z,A),S[D].transform=z,Y.attr("transform",m.getTextTransform(z))})}});var M=t.select(this).selectAll("g.titletext").data(k.title.text?[0]:[]);M.enter().append("g").classed("titletext",!0),M.exit().remove(),M.each(function(){var P=m.ensureSingle(t.select(this),"text","",function(U){U.attr("data-notex",1)}),D=k.title.text;k._meta&&(D=m.templateString(D,k._meta)),P.text(D).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(d.font,k.title.font).call(f.convertToTspans,x);var N=y(E,A._size);P.attr("transform",e(N.x,N.y)+h(Math.min(1,N.scale))+e(N.tx,N.ty))})})})}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../bar/plot":936,"../bar/uniform_text":941,"../pie/helpers":1181,"../pie/plot":1185,"@plotly/d3":58}],1068:[function(r,I,B){var t=r("@plotly/d3"),d=r("../pie/style_one"),m=r("../bar/uniform_text").resizeText;I.exports=function(h){var e=h._fullLayout._funnelarealayer.selectAll(".trace");m(h,e,"funnelarea"),e.each(function(f){var l=f[0].trace,o=t.select(this);o.style({opacity:l.opacity}),o.selectAll("path.surface").each(function(u){t.select(this).call(d,u,l)})})}},{"../bar/uniform_text":941,"../pie/style_one":1187,"@plotly/d3":58}],1069:[function(r,I,B){var t=r("../scatter/attributes"),d=r("../../plots/attributes"),m=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,h=r("../../plots/template_attributes").hovertemplateAttrs,e=r("../../components/colorscale/attributes"),f=r("../../lib/extend").extendFlat;I.exports=f({z:{valType:"data_array",editType:"calc"},x:f({},t.x,{impliedEdits:{xtype:"array"}}),x0:f({},t.x0,{impliedEdits:{xtype:"scaled"}}),dx:f({},t.dx,{impliedEdits:{xtype:"scaled"}}),y:f({},t.y,{impliedEdits:{ytype:"array"}}),y0:f({},t.y0,{impliedEdits:{ytype:"scaled"}}),dy:f({},t.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:f({},t.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:f({},t.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:f({},t.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:f({},t.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:f({},t.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:f({},t.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:m("x"),yhoverformat:m("y"),zhoverformat:m("z",1),hovertemplate:h(),showlegend:f({},d.showlegend,{dflt:!1})},{transforms:void 0},e("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1070:[function(r,I,B){var t=r("../../registry"),d=r("../../lib"),m=r("../../plots/cartesian/axes"),h=r("../../plots/cartesian/align_period"),e=r("../histogram2d/calc"),f=r("../../components/colorscale/calc"),l=r("./convert_column_xyz"),o=r("./clean_2d_array"),u=r("./interp2d"),s=r("./find_empties"),i=r("./make_bound_array"),c=r("../../constants/numerical").BADNUM;function n(a){for(var g=[],p=a.length,y=0;y<p;y++){var v=a[y];v!==c&&g.push(v)}return g}I.exports=function(a,g){var p,y,v,b,x,T,A,S,w,E,k,L=m.getFromId(a,g.xaxis||"x"),M=m.getFromId(a,g.yaxis||"y"),P=t.traceIs(g,"contour"),D=t.traceIs(g,"histogram"),N=t.traceIs(g,"gl2d"),U=P?"best":g.zsmooth;if(L._minDtick=0,M._minDtick=0,D)b=(k=e(a,g)).orig_x,p=k.x,y=k.x0,v=k.dx,S=k.orig_y,x=k.y,T=k.y0,A=k.dy,w=k.z;else{var G=g.z;d.isArray1D(G)?(l(g,L,M,"x","y",["z"]),p=g._x,x=g._y,G=g._z):(b=g.x?L.makeCalcdata(g,"x"):[],S=g.y?M.makeCalcdata(g,"y"):[],p=h(g,L,"x",b).vals,x=h(g,M,"y",S).vals,g._x=p,g._y=x),y=g.x0,v=g.dx,T=g.y0,A=g.dy,w=o(G,g,L,M)}function X(te){U=g._input.zsmooth=g.zsmooth=!1,d.warn('cannot use zsmooth: "fast": '+te)}if((L.rangebreaks||M.rangebreaks)&&(w=function(te,ie,ae){for(var he=[],se=-1,de=0;de<ae.length;de++)if(ie[de]!==c){se++,he[se]=[];for(var ue=0;ue<ae[de].length;ue++)te[ue]!==c&&he[se].push(ae[de][ue])}return he}(p,x,w),D||(p=n(p),x=n(x),g._x=p,g._y=x)),D||!P&&!g.connectgaps||(g._emptypoints=s(w),u(w,g._emptypoints)),U==="fast"){if(L.type==="log"||M.type==="log")X("log axis found");else if(!D){if(p.length){var K=(p[p.length-1]-p[0])/(p.length-1),Z=Math.abs(K/100);for(E=0;E<p.length-1;E++)if(Math.abs(p[E+1]-p[E]-K)>Z){X("x scale is not linear");break}}if(x.length&&U==="fast"){var H=(x[x.length-1]-x[0])/(x.length-1),Y=Math.abs(H/100);for(E=0;E<x.length-1;E++)if(Math.abs(x[E+1]-x[E]-H)>Y){X("y scale is not linear");break}}}}var $=d.maxRowLength(w),z=g.xtype==="scaled"?"":p,j=i(g,z,y,v,$,L),W=g.ytype==="scaled"?"":x,ee=i(g,W,T,A,w.length,M);N||(g._extremes[L._id]=m.findExtremes(L,j),g._extremes[M._id]=m.findExtremes(M,ee));var J={x:j,y:ee,z:w,text:g._text||g.text,hovertext:g._hovertext||g.hovertext};if(g.xperiodalignment&&b&&(J.orig_x=b),g.yperiodalignment&&S&&(J.orig_y=S),z&&z.length===j.length-1&&(J.xCenter=z),W&&W.length===ee.length-1&&(J.yCenter=W),D&&(J.xRanges=k.xRanges,J.yRanges=k.yRanges,J.pts=k.pts),P||f(a,g,{vals:w,cLetter:"z"}),P&&g.contours&&g.contours.coloring==="heatmap"){var Q={type:g.type==="contour"?"heatmap":"histogram2d",xcalendar:g.xcalendar,ycalendar:g.ycalendar};J.xfill=i(Q,z,y,v,$,L),J.yfill=i(Q,W,T,A,w.length,M)}return[J]}},{"../../components/colorscale/calc":658,"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../../registry":915,"../histogram2d/calc":1102,"./clean_2d_array":1071,"./convert_column_xyz":1073,"./find_empties":1075,"./interp2d":1078,"./make_bound_array":1079}],1071:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../constants/numerical").BADNUM;I.exports=function(h,e,f,l){var o,u,s,i,c,n;function a(x){if(t(x))return+x}if(e&&e.transpose){for(o=0,c=0;c<h.length;c++)o=Math.max(o,h[c].length);if(o===0)return!1;s=function(x){return x.length},i=function(x,T,A){return(x[A]||[])[T]}}else o=h.length,s=function(x,T){return x[T].length},i=function(x,T,A){return(x[T]||[])[A]};var g=function(x,T,A){return T===m||A===m?m:i(x,T,A)};function p(x){if(e&&e.type!=="carpet"&&e.type!=="contourcarpet"&&x&&x.type==="category"&&e["_"+x._id.charAt(0)].length){var T=x._id.charAt(0),A={},S=e["_"+T+"CategoryMap"]||e[T];for(c=0;c<S.length;c++)A[S[c]]=c;return function(w){var E=A[x._categories[w]];return E+1?E:m}}return d.identity}var y=p(f),v=p(l);l&&l.type==="category"&&(o=l._categories.length);var b=new Array(o);for(c=0;c<o;c++)for(u=f&&f.type==="category"?f._categories.length:s(h,c),b[c]=new Array(u),n=0;n<u;n++)b[c][n]=a(g(h,v(c),y(n)));return b}},{"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],1072:[function(r,I,B){I.exports={min:"zmin",max:"zmax"}},{}],1073:[function(r,I,B){var t=r("../../lib"),d=r("../../constants/numerical").BADNUM,m=r("../../plots/cartesian/align_period");I.exports=function(h,e,f,l,o,u){var s=h._length,i=e.makeCalcdata(h,l),c=f.makeCalcdata(h,o);i=m(h,e,l,i).vals,c=m(h,f,o,c).vals;var n,a,g,p,y=h.text,v=y!==void 0&&t.isArray1D(y),b=h.hovertext,x=b!==void 0&&t.isArray1D(b),T=t.distinctVals(i),A=T.vals,S=t.distinctVals(c),w=S.vals,E=[],k=w.length,L=A.length;for(n=0;n<u.length;n++)E[n]=t.init2dArray(k,L);v&&(g=t.init2dArray(k,L)),x&&(p=t.init2dArray(k,L));var M=t.init2dArray(k,L);for(n=0;n<s;n++)if(i[n]!==d&&c[n]!==d){var P=t.findBin(i[n]+T.minDiff/2,A),D=t.findBin(c[n]+S.minDiff/2,w);for(a=0;a<u.length;a++){var N=h[u[a]];E[a][D][P]=N[n],M[D][P]=n}v&&(g[D][P]=y[n]),x&&(p[D][P]=b[n])}for(h["_"+l]=A,h["_"+o]=w,a=0;a<u.length;a++)h["_"+u[a]]=E[a];v&&(h._text=g),x&&(h._hovertext=p),e&&e.type==="category"&&(h["_"+l+"CategoryMap"]=A.map(function(U){return e._categories[U]})),f&&f.type==="category"&&(h["_"+o+"CategoryMap"]=w.map(function(U){return f._categories[U]})),h._after2before=M}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835}],1074:[function(r,I,B){var t=r("../../lib"),d=r("./xyz_defaults"),m=r("../scatter/period_defaults"),h=r("./style_defaults"),e=r("../../components/colorscale/defaults"),f=r("./attributes");I.exports=function(l,o,u,s){function i(c,n){return t.coerce(l,o,f,c,n)}d(l,o,i,s)?(m(l,o,s,i),i("xhoverformat"),i("yhoverformat"),i("text"),i("hovertext"),i("hovertemplate"),h(l,o,i,s),i("hoverongaps"),i("connectgaps",t.isArray1D(o.z)&&o.zsmooth!==!1),e(l,o,s,i,{prefix:"",cLetter:"z"})):o.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"../scatter/period_defaults":1222,"./attributes":1069,"./style_defaults":1082,"./xyz_defaults":1083}],1075:[function(r,I,B){var t=r("../../lib").maxRowLength;I.exports=function(d){var m,h,e,f,l,o,u,s,i=[],c={},n=[],a=d[0],g=[],p=[0,0,0],y=t(d);for(h=0;h<d.length;h++)for(m=g,g=a,a=d[h+1]||[],e=0;e<y;e++)g[e]===void 0&&((o=(g[e-1]!==void 0?1:0)+(g[e+1]!==void 0?1:0)+(m[e]!==void 0?1:0)+(a[e]!==void 0?1:0))?(h===0&&o++,e===0&&o++,h===d.length-1&&o++,e===g.length-1&&o++,o<4&&(c[[h,e]]=[h,e,o]),i.push([h,e,o])):n.push([h,e]));for(;n.length;){for(u={},s=!1,l=n.length-1;l>=0;l--)(o=((c[[(h=(f=n[l])[0])-1,e=f[1]]]||p)[2]+(c[[h+1,e]]||p)[2]+(c[[h,e-1]]||p)[2]+(c[[h,e+1]]||p)[2])/20)&&(u[f]=[h,e,o],n.splice(l,1),s=!0);if(!s)throw"findEmpties iterated with no new neighbors";for(f in u)c[f]=u[f],i.push(u[f])}return i.sort(function(v,b){return b[2]-v[2]})}},{"../../lib":787}],1076:[function(r,I,B){var t=r("../../components/fx"),d=r("../../lib"),m=r("../../plots/cartesian/axes"),h=r("../../components/colorscale").extractOpts;I.exports=function(e,f,l,o,u){u||(u={});var s,i,c,n,a=u.isContour,g=e.cd[0],p=g.trace,y=e.xa,v=e.ya,b=g.x,x=g.y,T=g.z,A=g.xCenter,S=g.yCenter,w=g.zmask,E=p.zhoverformat,k=b,L=x;if(e.index!==!1){try{c=Math.round(e.index[1]),n=Math.round(e.index[0])}catch(z){return void d.error("Error hovering on heatmap, pointNumber must be [row,col], found:",e.index)}if(c<0||c>=T[0].length||n<0||n>T.length)return}else{if(t.inbox(f-b[0],f-b[b.length-1],0)>0||t.inbox(l-x[0],l-x[x.length-1],0)>0)return;if(a){var M;for(k=[2*b[0]-b[1]],M=1;M<b.length;M++)k.push((b[M]+b[M-1])/2);for(k.push([2*b[b.length-1]-b[b.length-2]]),L=[2*x[0]-x[1]],M=1;M<x.length;M++)L.push((x[M]+x[M-1])/2);L.push([2*x[x.length-1]-x[x.length-2]])}c=Math.max(0,Math.min(k.length-2,d.findBin(f,k))),n=Math.max(0,Math.min(L.length-2,d.findBin(l,L)))}var P,D,N=y.c2p(b[c]),U=y.c2p(b[c+1]),G=v.c2p(x[n]),X=v.c2p(x[n+1]);a?(P=g.orig_x||b,D=g.orig_y||x,U=N,s=P[c],X=G,i=D[n]):(P=g.orig_x||A||b,D=g.orig_y||S||x,s=A?P[c]:(P[c]+P[c+1])/2,i=S?D[n]:(D[n]+D[n+1])/2,y&&y.type==="category"&&(s=b[c]),v&&v.type==="category"&&(i=x[n]),p.zsmooth&&(N=U=y.c2p(s),G=X=v.c2p(i)));var K=T[n][c];if(w&&!w[n][c]&&(K=void 0),K!==void 0||p.hoverongaps){var Z;Array.isArray(g.hovertext)&&Array.isArray(g.hovertext[n])?Z=g.hovertext[n][c]:Array.isArray(g.text)&&Array.isArray(g.text[n])&&(Z=g.text[n][c]);var H=h(p),Y={type:"linear",range:[H.min,H.max],hoverformat:E,_separators:y._separators,_numFormat:y._numFormat},$=m.tickText(Y,K,"hover").text;return[d.extendFlat(e,{index:p._after2before?p._after2before[n][c]:[n,c],distance:e.maxHoverDistance,spikeDistance:e.maxSpikeDistance,x0:N,x1:U,y0:G,y1:X,xLabelVal:s,yLabelVal:i,zLabelVal:K,zLabel:$,text:Z})]}}},{"../../components/colorscale":662,"../../components/fx":690,"../../lib":787,"../../plots/cartesian/axes":838}],1077:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),colorbar:r("./colorbar"),style:r("./style"),hoverPoints:r("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":852,"./attributes":1069,"./calc":1070,"./colorbar":1072,"./defaults":1074,"./hover":1076,"./plot":1080,"./style":1081}],1078:[function(r,I,B){var t=r("../../lib"),d=[[-1,0],[1,0],[0,-1],[0,1]];function m(e){return .5-.25*Math.min(1,.5*e)}function h(e,f,l){var o,u,s,i,c,n,a,g,p,y,v,b,x,T=0;for(i=0;i<f.length;i++){for(u=(o=f[i])[0],s=o[1],v=e[u][s],y=0,p=0,c=0;c<4;c++)(a=e[u+(n=d[c])[0]])&&(g=a[s+n[1]])!==void 0&&(y===0?b=x=g:(b=Math.min(b,g),x=Math.max(x,g)),p++,y+=g);if(p===0)throw"iterateInterp2d order is wrong: no defined neighbors";e[u][s]=y/p,v===void 0?p<4&&(T=1):(e[u][s]=(1+l)*e[u][s]-l*v,x>b&&(T=Math.max(T,Math.abs(e[u][s]-v)/(x-b))))}return T}I.exports=function(e,f){var l,o=1;for(h(e,f),l=0;l<f.length&&!(f[l][2]<4);l++);for(f=f.slice(l),l=0;l<100&&o>.01;l++)o=h(e,f,m(o));return o>.01&&t.log("interp2d didn't converge quickly",o),e}},{"../../lib":787}],1079:[function(r,I,B){var t=r("../../registry"),d=r("../../lib").isArrayOrTypedArray;I.exports=function(m,h,e,f,l,o){var u,s,i,c=[],n=t.traceIs(m,"contour"),a=t.traceIs(m,"histogram"),g=t.traceIs(m,"gl2d");if(d(h)&&h.length>1&&!a&&o.type!=="category"){var p=h.length;if(!(p<=l))return n?h.slice(0,l):h.slice(0,l+1);if(n||g)c=h.slice(0,l);else if(l===1)c=[h[0]-.5,h[0]+.5];else{for(c=[1.5*h[0]-.5*h[1]],i=1;i<p;i++)c.push(.5*(h[i-1]+h[i]));c.push(1.5*h[p-1]-.5*h[p-2])}if(p<l){var y=c[c.length-1],v=y-c[c.length-2];for(i=p;i<l;i++)y+=v,c.push(y)}}else{var b=m[o._id.charAt(0)+"calendar"];for(a?u=o.r2c(e,0,b):d(h)&&h.length===1?u=h[0]:e===void 0?u=0:u=(o.type==="log"?o.d2c:o.r2c)(e,0,b),s=f||1,i=n||g?0:-.5;i<l;i++)c.push(u+s*i)}return c}},{"../../lib":787,"../../registry":915}],1080:[function(r,I,B){var t=r("@plotly/d3"),d=r("tinycolor2"),m=r("../../registry"),h=r("../../lib"),e=r("../../components/colorscale").makeColorScaleFuncFromTrace,f=r("../../constants/xmlns_namespaces");function l(s,i){var c=i.length-2,n=h.constrain(h.findBin(s,i),0,c),a=i[n],g=i[n+1],p=h.constrain(n+(s-a)/(g-a)-.5,0,c),y=Math.round(p),v=Math.abs(p-y);return p&&p!==c&&v?{bin0:y,frac:v,bin1:Math.round(y+v/(p-y))}:{bin0:y,bin1:y,frac:0}}function o(s,i){var c=i.length-1,n=h.constrain(h.findBin(s,i),0,c),a=i[n],g=(s-a)/(i[n+1]-a)||0;return g<=0?{bin0:n,bin1:n,frac:0}:g<.5?{bin0:n,bin1:n+1,frac:g}:{bin0:n+1,bin1:n,frac:1-g}}function u(s,i,c){s[i]=c[0],s[i+1]=c[1],s[i+2]=c[2],s[i+3]=Math.round(255*c[3])}I.exports=function(s,i,c,n){var a=i.xaxis,g=i.yaxis;h.makeTraceGroups(n,c,"hm").each(function(p){var y,v,b,x,T,A,S=t.select(this),w=p[0],E=w.trace,k=w.z,L=w.x,M=w.y,P=w.xCenter,D=w.yCenter,N=m.traceIs(E,"contour"),U=N?"best":E.zsmooth,G=k.length,X=h.maxRowLength(k),K=!1,Z=!1;for(A=0;y===void 0&&A<L.length-1;)y=a.c2p(L[A]),A++;for(A=L.length-1;v===void 0&&A>0;)v=a.c2p(L[A]),A--;for(v<y&&(b=v,v=y,y=b,K=!0),A=0;x===void 0&&A<M.length-1;)x=g.c2p(M[A]),A++;for(A=M.length-1;T===void 0&&A>0;)T=g.c2p(M[A]),A--;if(T<x&&(b=x,x=T,T=b,Z=!0),N&&(P=L,D=M,L=w.xfill,M=w.yfill),U!=="fast"){var H=U==="best"?0:.5;y=Math.max(-H*a._length,y),v=Math.min((1+H)*a._length,v),x=Math.max(-H*g._length,x),T=Math.min((1+H)*g._length,T)}var Y=Math.round(v-y),$=Math.round(T-x);if(Y<=0||$<=0)S.selectAll("image").data([]).exit().remove();else{var z,j;U==="fast"?(z=X,j=G):(z=Y,j=$);var W=document.createElement("canvas");W.width=z,W.height=j;var ee,J,Q=W.getContext("2d"),te=e(E,{noNumericCheck:!0,returnArray:!0});U==="fast"?(ee=K?function(Be){return X-1-Be}:h.identity,J=Z?function(Be){return G-1-Be}:h.identity):(ee=function(Be){return h.constrain(Math.round(a.c2p(L[Be])-y),0,Y)},J=function(Be){return h.constrain(Math.round(g.c2p(M[Be])-x),0,$)});var ie,ae,he,se,de,ue=J(0),ve=[ue,ue],ke=K?0:1,Ee=Z?0:1,be=0,xe=0,ce=0,ge=0;if(U){var we,Me=0;try{we=new Uint8Array(Y*$*4)}catch(Be){we=new Array(Y*$*4)}if(U==="best"){var Se,ze,Fe,Ye=P||L,rt=D||M,Oe=new Array(Ye.length),je=new Array(rt.length),We=new Array(Y),qe=P?o:l,et=D?o:l;for(A=0;A<Ye.length;A++)Oe[A]=Math.round(a.c2p(Ye[A])-y);for(A=0;A<rt.length;A++)je[A]=Math.round(g.c2p(rt[A])-x);for(A=0;A<Y;A++)We[A]=qe(A,Oe);for(ae=0;ae<$;ae++)for(ze=k[(Se=et(ae,je)).bin0],Fe=k[Se.bin1],A=0;A<Y;A++,Me+=4)u(we,Me,de=He(ze,Fe,We[A],Se))}else for(ae=0;ae<G;ae++)for(se=k[ae],ve=J(ae),A=0;A<Y;A++)de=Ue(se[A],1),u(we,Me=4*(ve*Y+ee(A)),de);var st=Q.createImageData(Y,$);try{st.data.set(we)}catch(Be){var ct=st.data,Pt=ct.length;for(ae=0;ae<Pt;ae++)ct[ae]=we[ae]}Q.putImageData(st,0,0)}else{var kt=E.xgap,at=E.ygap,tt=Math.floor(kt/2),_t=Math.floor(at/2);for(ae=0;ae<G;ae++)if(se=k[ae],ve.reverse(),ve[Ee]=J(ae+1),ve[0]!==ve[1]&&ve[0]!==void 0&&ve[1]!==void 0)for(ie=[he=ee(0),he],A=0;A<X;A++)ie.reverse(),ie[ke]=ee(A+1),ie[0]!==ie[1]&&ie[0]!==void 0&&ie[1]!==void 0&&(de=Ue(se[A],(ie[1]-ie[0])*(ve[1]-ve[0])),Q.fillStyle="rgba("+de.join(",")+")",Q.fillRect(ie[0]+tt,ve[0]+_t,ie[1]-ie[0]-kt,ve[1]-ve[0]-at))}xe=Math.round(xe/be),ce=Math.round(ce/be),ge=Math.round(ge/be);var er=d("rgb("+xe+","+ce+","+ge+")");s._hmpixcount=(s._hmpixcount||0)+be,s._hmlumcount=(s._hmlumcount||0)+be*er.getLuminance();var tr=S.selectAll("image").data(p);tr.enter().append("svg:image").attr({xmlns:f.svg,preserveAspectRatio:"none"}),tr.attr({height:$,width:Y,x:y,y:x,"xlink:href":W.toDataURL("image/png")})}function Ue(Be,Ke){if(Be!==void 0){var _e=te(Be);return _e[0]=Math.round(_e[0]),_e[1]=Math.round(_e[1]),_e[2]=Math.round(_e[2]),be+=Ke,xe+=_e[0]*Ke,ce+=_e[1]*Ke,ge+=_e[2]*Ke,_e}return[0,0,0,0]}function He(Be,Ke,_e,Ce){var Le=Be[_e.bin0];if(Le===void 0)return Ue(void 0,1);var Pe,Xe=Be[_e.bin1],ht=Ke[_e.bin0],Mt=Ke[_e.bin1],pt=Xe-Le||0,Lt=ht-Le||0;return Pe=Xe===void 0?Mt===void 0?0:ht===void 0?2*(Mt-Le):2*(2*Mt-ht-Le)/3:Mt===void 0?ht===void 0?0:2*(2*Le-Xe-ht)/3:ht===void 0?2*(2*Mt-Xe-Le)/3:Mt+Le-Xe-ht,Ue(Le+_e.frac*pt+Ce.frac*(Lt+_e.frac*Pe))}})}},{"../../components/colorscale":662,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../registry":915,"@plotly/d3":58,tinycolor2:583}],1081:[function(r,I,B){var t=r("@plotly/d3");I.exports=function(d){t.select(d).selectAll(".hm image").style("opacity",function(m){return m.trace.opacity})}},{"@plotly/d3":58}],1082:[function(r,I,B){I.exports=function(t,d,m){m("zsmooth")===!1&&(m("xgap"),m("ygap")),m("zhoverformat")}},{}],1083:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../registry");function h(e,f){var l=f(e);return(l?f(e+"type","array"):"scaled")==="scaled"&&(f(e+"0"),f("d"+e)),l}I.exports=function(e,f,l,o,u,s){var i,c,n=l("z");if(u=u||"x",s=s||"y",n===void 0||!n.length)return 0;if(d.isArray1D(e.z)){i=l(u),c=l(s);var a=d.minRowLength(i),g=d.minRowLength(c);if(a===0||g===0)return 0;f._length=Math.min(a,g,n.length)}else{if(i=h(u,l),c=h(s,l),!function(p){for(var y,v=!0,b=!1,x=!1,T=0;T<p.length;T++){if(y=p[T],!d.isArrayOrTypedArray(y)){v=!1;break}y.length>0&&(b=!0);for(var A=0;A<y.length;A++)if(t(y[A])){x=!0;break}}return v&&b&&x}(n))return 0;l("transpose"),f._length=null}return e.type==="heatmapgl"||m.getComponentMethod("calendars","handleTraceDefaults")(e,f,[u,s],o),!0}},{"../../lib":787,"../../registry":915,"fast-isnumeric":246}],1084:[function(r,I,B){for(var t=r("../heatmap/attributes"),d=r("../../components/colorscale/attributes"),m=r("../../lib/extend").extendFlat,h=r("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],f={},l=0;l<e.length;l++){var o=e[l];f[o]=t[o]}f.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},m(f,d("",{cLetter:"z",autoColorDflt:!1})),I.exports=h(f,"calc","nested")},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../heatmap/attributes":1069}],1085:[function(r,I,B){var t=r("gl-heatmap2d"),d=r("../../plots/cartesian/axes"),m=r("../../lib/str2rgbarray");function h(f,l){this.scene=f,this.uid=l,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=t(f.glplot,this.options),this.heatmap._trace=this}var e=h.prototype;e.handlePick=function(f){var l=this.options,o=l.shape,u=f.pointId,s=u%o[0],i=Math.floor(u/o[0]),c=u;return{trace:this,dataCoord:f.dataCoord,traceCoord:[l.x[s],l.y[i],l.z[c]],textLabel:this.textLabels[u],name:this.name,pointIndex:[i,s],hoverinfo:this.hoverinfo}},e.update=function(f,l){var o=l[0];this.index=f.index,this.name=f.name,this.hoverinfo=f.hoverinfo;var u=o.z;this.options.z=[].concat.apply([],u);var s=u[0].length,i=u.length;this.options.shape=[s,i],this.options.x=o.x,this.options.y=o.y,this.options.zsmooth=f.zsmooth;var c=function(y){for(var v=y.colorscale,b=y.zmin,x=y.zmax,T=v.length,A=new Array(T),S=new Array(4*T),w=0;w<T;w++){var E=v[w],k=m(E[1]);A[w]=b+E[0]*(x-b);for(var L=0;L<4;L++)S[4*w+L]=k[L]}return{colorLevels:A,colorValues:S}}(f);this.options.colorLevels=c.colorLevels,this.options.colorValues=c.colorValues,this.textLabels=[].concat.apply([],f.text),this.heatmap.update(this.options);var n,a,g=this.scene.xaxis,p=this.scene.yaxis;f.zsmooth===!1&&(n={ppad:o.x[1]-o.x[0]},a={ppad:o.y[1]-o.y[0]}),f._extremes[g._id]=d.findExtremes(g,o.x,n),f._extremes[p._id]=d.findExtremes(p,o.y,a)},e.dispose=function(){this.heatmap.dispose()},I.exports=function(f,l,o){var u=new h(f,l.uid);return u.update(l,o),u}},{"../../lib/str2rgbarray":812,"../../plots/cartesian/axes":838,"gl-heatmap2d":272}],1086:[function(r,I,B){var t=r("../../lib"),d=r("../heatmap/xyz_defaults"),m=r("../../components/colorscale/defaults"),h=r("./attributes");I.exports=function(e,f,l,o){function u(s,i){return t.coerce(e,f,h,s,i)}d(e,f,u,o)?(u("text"),u("zsmooth"),m(e,f,o,u,{prefix:"",cLetter:"z"})):f.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"../heatmap/xyz_defaults":1083,"./attributes":1084}],1087:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../heatmap/colorbar"),calc:r("../heatmap/calc"),plot:r("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:r("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":878,"../heatmap/calc":1070,"../heatmap/colorbar":1072,"./attributes":1084,"./convert":1085,"./defaults":1086}],1088:[function(r,I,B){var t=r("../bar/attributes"),d=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=r("../../plots/template_attributes").hovertemplateAttrs,h=r("./bin_attributes"),e=r("./constants"),f=r("../../lib/extend").extendFlat;I.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:d("x"),yhoverformat:d("y"),text:f({},t.text,{}),hovertext:f({},t.hovertext,{}),orientation:t.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:h("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:h("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:m({},{keys:e.eventDataKeys}),marker:t.marker,offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup,selected:t.selected,unselected:t.unselected,_deprecated:{bardir:t._deprecated.bardir}}},{"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../bar/attributes":925,"./bin_attributes":1090,"./constants":1094}],1089:[function(r,I,B){I.exports=function(t,d){for(var m=t.length,h=0,e=0;e<m;e++)d[e]?(t[e]/=d[e],h+=t[e]):t[e]=null;return h}},{}],1090:[function(r,I,B){I.exports=function(t,d){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],1091:[function(r,I,B){var t=r("fast-isnumeric");I.exports={count:function(d,m,h){return h[d]++,1},sum:function(d,m,h,e){var f=e[m];return t(f)?(f=Number(f),h[d]+=f,f):0},avg:function(d,m,h,e,f){var l=e[m];return t(l)&&(l=Number(l),h[d]+=l,f[d]++),0},min:function(d,m,h,e){var f=e[m];if(t(f)){if(f=Number(f),!t(h[d]))return h[d]=f,f;if(h[d]>f){var l=f-h[d];return h[d]=f,l}}return 0},max:function(d,m,h,e){var f=e[m];if(t(f)){if(f=Number(f),!t(h[d]))return h[d]=f,f;if(h[d]<f){var l=f-h[d];return h[d]=f,l}}return 0}}},{"fast-isnumeric":246}],1092:[function(r,I,B){var t=r("../../constants/numerical"),d=t.ONEAVGYEAR,m=t.ONEAVGMONTH,h=t.ONEDAY,e=t.ONEHOUR,f=t.ONEMIN,l=t.ONESEC,o=r("../../plots/cartesian/axes").tickIncrement;function u(n,a,g,p){if(n*a<=0)return 1/0;for(var y=Math.abs(a-n),v=g.type==="date",b=s(y,v),x=0;x<10;x++){var T=s(80*b,v);if(b===T||!i(T,n,a,v,g,p))break;b=T}return b}function s(n,a){return a&&n>l?n>h?n>1.1*d?d:n>1.1*m?m:h:n>e?e:n>f?f:l:Math.pow(10,Math.floor(Math.log(n)/Math.LN10))}function i(n,a,g,p,y,v){if(p&&n>h){var b=c(a,y,v),x=c(g,y,v),T=n===d?0:1;return b[T]!==x[T]}return Math.floor(g/n)-Math.floor(a/n)>.1}function c(n,a,g){var p=a.c2d(n,d,g).split("-");return p[0]===""&&(p.unshift(),p[0]="-"+p[0]),p}I.exports=function(n,a,g,p,y){var v,b,x=-1.1*a,T=-.1*a,A=n-T,S=g[0],w=g[1],E=Math.min(u(S+T,S+A,p,y),u(w+T,w+A,p,y)),k=Math.min(u(S+x,S+T,p,y),u(w+x,w+T,p,y));if(E>k&&k<Math.abs(w-S)/4e3?(v=E,b=!1):(v=Math.min(E,k),b=!0),p.type==="date"&&v>h){var L=v===d?1:6,M=v===d?"M12":"M1";return function(P,D){var N=p.c2d(P,d,y),U=N.indexOf("-",L);U>0&&(N=N.substr(0,U));var G=p.d2c(N,0,y);if(G<P){var X=o(G,M,!1,y);(G+X)/2<P+n&&(G=X)}return D&&b?o(G,M,!0,y):G}}return function(P,D){var N=v*Math.round(P/v);return N+v/10<P&&N+.9*v<P+n&&(N+=v),D&&b&&(N-=v),N}}},{"../../constants/numerical":763,"../../plots/cartesian/axes":838}],1093:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../registry"),h=r("../../plots/cartesian/axes"),e=r("../bar/arrays_to_calcdata"),f=r("./bin_functions"),l=r("./norm_functions"),o=r("./average"),u=r("./bin_label_vals");function s(i,c,n,a,g){var p,y,v,b,x,T,A,S=a+"bins",w=i._fullLayout,E=c["_"+a+"bingroup"],k=w._histogramBinOpts[E],L=w.barmode==="overlay",M=function(ue){return n.r2c(ue,0,b)},P=function(ue){return n.c2r(ue,0,b)},D=n.type==="date"?function(ue){return ue||ue===0?d.cleanDate(ue,null,b):null}:function(ue){return t(ue)?Number(ue):null};function N(ue,ve,ke){ve[ue+"Found"]?(ve[ue]=D(ve[ue]),ve[ue]===null&&(ve[ue]=ke[ue])):(T[ue]=ve[ue]=ke[ue],d.nestedProperty(y[0],S+"."+ue).set(ke[ue]))}if(c["_"+a+"autoBinFinished"])delete c["_"+a+"autoBinFinished"];else{y=k.traces;var U=[],G=!0,X=!1,K=!1;for(p=0;p<y.length;p++)if((v=y[p]).visible){var Z=k.dirs[p];x=v["_"+Z+"pos0"]=n.makeCalcdata(v,Z),U=d.concat(U,x),delete v["_"+a+"autoBinFinished"],c.visible===!0&&(G?G=!1:(delete v._autoBin,v["_"+a+"autoBinFinished"]=1),m.traceIs(v,"2dMap")&&(X=!0),v.type==="histogram2dcontour"&&(K=!0))}b=y[0][a+"calendar"];var H=h.autoBin(U,n,k.nbins,X,b,k.sizeFound&&k.size),Y=y[0]._autoBin={};if(T=Y[k.dirs[0]]={},K&&(k.size||(H.start=P(h.tickIncrement(M(H.start),H.size,!0,b))),k.end===void 0&&(H.end=P(h.tickIncrement(M(H.end),H.size,!1,b)))),L&&!m.traceIs(c,"2dMap")&&H._dataSpan===0&&n.type!=="category"&&n.type!=="multicategory"){if(g)return[H,x,!0];H=function(ue,ve,ke,Ee,be){var xe,ce,ge,we=ue._fullLayout,Me=function(ct,Pt){for(var kt=Pt.xaxis,at=Pt.yaxis,tt=Pt.orientation,_t=[],er=ct._fullData,tr=0;tr<er.length;tr++){var Ue=er[tr];Ue.type==="histogram"&&Ue.visible===!0&&Ue.orientation===tt&&Ue.xaxis===kt&&Ue.yaxis===at&&_t.push(Ue)}return _t}(ue,ve),Se=!1,ze=1/0,Fe=[ve];for(xe=0;xe<Me.length;xe++)if((ce=Me[xe])===ve)Se=!0;else if(Se){var Ye=s(ue,ce,ke,Ee,!0),rt=Ye[0],Oe=Ye[2];ce["_"+Ee+"autoBinFinished"]=1,ce["_"+Ee+"pos0"]=Ye[1],Oe?Fe.push(ce):ze=Math.min(ze,rt.size)}else ge=we._histogramBinOpts[ce["_"+Ee+"bingroup"]],ze=Math.min(ze,ge.size||ce[be].size);var je=new Array(Fe.length);for(xe=0;xe<Fe.length;xe++)for(var We=Fe[xe]["_"+Ee+"pos0"],qe=0;qe<We.length;qe++)if(We[qe]!==void 0){je[xe]=We[qe];break}for(isFinite(ze)||(ze=d.distinctVals(je).minDiff),xe=0;xe<Fe.length;xe++){var et=(ce=Fe[xe])[Ee+"calendar"],st={start:ke.c2r(je[xe]-ze/2,0,et),end:ke.c2r(je[xe]+ze/2,0,et),size:ze};ce._input[be]=ce[be]=st,(ge=we._histogramBinOpts[ce["_"+Ee+"bingroup"]])&&d.extendFlat(ge,st)}return ve[be]}(i,c,n,a,S)}(A=v.cumulative||{}).enabled&&A.currentbin!=="include"&&(A.direction==="decreasing"?H.start=P(h.tickIncrement(M(H.start),H.size,!0,b)):H.end=P(h.tickIncrement(M(H.end),H.size,!1,b))),k.size=H.size,k.sizeFound||(T.size=H.size,d.nestedProperty(y[0],S+".size").set(H.size)),N("start",k,H),N("end",k,H)}x=c["_"+a+"pos0"],delete c["_"+a+"pos0"];var $=c._input[S]||{},z=d.extendFlat({},k),j=k.start,W=n.r2l($.start),ee=W!==void 0;if((k.startFound||ee)&&W!==n.r2l(j)){var J=ee?W:d.aggNums(Math.min,null,x),Q={type:n.type==="category"||n.type==="multicategory"?"linear":n.type,r2l:n.r2l,dtick:k.size,tick0:j,calendar:b,range:[J,h.tickIncrement(J,k.size,!1,b)].map(n.l2r)},te=h.tickFirst(Q);te>n.r2l(J)&&(te=h.tickIncrement(te,k.size,!0,b)),z.start=n.l2r(te),ee||d.nestedProperty(c,S+".start").set(z.start)}var ie=k.end,ae=n.r2l($.end),he=ae!==void 0;if((k.endFound||he)&&ae!==n.r2l(ie)){var se=he?ae:d.aggNums(Math.max,null,x);z.end=n.l2r(se),he||d.nestedProperty(c,S+".start").set(z.end)}var de="autobin"+a;return c._input[de]===!1&&(c._input[S]=d.extendFlat({},c[S]||{}),delete c._input[de],delete c[de]),[z,x]}I.exports={calc:function(i,c){var n,a,g,p,y=[],v=[],b=h.getFromId(i,c.orientation==="h"?c.yaxis:c.xaxis),x=c.orientation==="h"?"y":"x",T={x:"y",y:"x"}[x],A=c[x+"calendar"],S=c.cumulative,w=s(i,c,b,x),E=w[0],k=w[1],L=typeof E.size=="string",M=[],P=L?M:E,D=[],N=[],U=[],G=0,X=c.histnorm,K=c.histfunc,Z=X.indexOf("density")!==-1;S.enabled&&Z&&(X=X.replace(/ ?density$/,""),Z=!1);var H,Y=K==="max"||K==="min"?null:0,$=f.count,z=l[X],j=!1,W=function(xe){return b.r2c(xe,0,A)};for(d.isArrayOrTypedArray(c[T])&&K!=="count"&&(H=c[T],j=K==="avg",$=f[K]),n=W(E.start),g=W(E.end)+(n-h.tickIncrement(n,E.size,!1,A))/1e6;n<g&&y.length<1e6&&(a=h.tickIncrement(n,E.size,!1,A),y.push((n+a)/2),v.push(Y),U.push([]),M.push(n),Z&&D.push(1/(a-n)),j&&N.push(0),!(a<=n));)n=a;M.push(n),L||b.type!=="date"||(P={start:W(P.start),end:W(P.end),size:P.size}),i._fullLayout._roundFnOpts||(i._fullLayout._roundFnOpts={});var ee=c["_"+x+"bingroup"],J={leftGap:1/0,rightGap:1/0};ee&&(i._fullLayout._roundFnOpts[ee]||(i._fullLayout._roundFnOpts[ee]=J),J=i._fullLayout._roundFnOpts[ee]);var Q,te=v.length,ie=!0,ae=J.leftGap,he=J.rightGap,se={};for(n=0;n<k.length;n++){var de=k[n];(p=d.findBin(de,P))>=0&&p<te&&(G+=$(p,n,v,H,N),ie&&U[p].length&&de!==k[U[p][0]]&&(ie=!1),U[p].push(n),se[n]=p,ae=Math.min(ae,de-M[p]),he=Math.min(he,M[p+1]-de))}J.leftGap=ae,J.rightGap=he,ie||(Q=function(xe,ce){return function(){var ge=i._fullLayout._roundFnOpts[ee];return u(ge.leftGap,ge.rightGap,M,b,A)(xe,ce)}}),j&&(G=o(v,N)),z&&z(v,G,D),S.enabled&&function(xe,ce,ge){var we,Me,Se;function ze(Ye){Se=xe[Ye],xe[Ye]/=2}function Fe(Ye){Me=xe[Ye],xe[Ye]=Se+Me/2,Se+=Me}if(ge==="half")if(ce==="increasing")for(ze(0),we=1;we<xe.length;we++)Fe(we);else for(ze(xe.length-1),we=xe.length-2;we>=0;we--)Fe(we);else if(ce==="increasing"){for(we=1;we<xe.length;we++)xe[we]+=xe[we-1];ge==="exclude"&&(xe.unshift(0),xe.pop())}else{for(we=xe.length-2;we>=0;we--)xe[we]+=xe[we+1];ge==="exclude"&&(xe.push(0),xe.shift())}}(v,S.direction,S.currentbin);var ue=Math.min(y.length,v.length),ve=[],ke=0,Ee=ue-1;for(n=0;n<ue;n++)if(v[n]){ke=n;break}for(n=ue-1;n>=ke;n--)if(v[n]){Ee=n;break}for(n=ke;n<=Ee;n++)if(t(y[n])&&t(v[n])){var be={p:y[n],s:v[n],b:0};S.enabled||(be.pts=U[n],ie?be.ph0=be.ph1=U[n].length?k[U[n][0]]:y[n]:(c._computePh=!0,be.ph0=Q(M[n]),be.ph1=Q(M[n+1],!0))),ve.push(be)}return ve.length===1&&(ve[0].width1=h.tickIncrement(ve[0].p,E.size,!1,A)-ve[0].p),e(ve,c),d.isArrayOrTypedArray(c.selectedpoints)&&d.tagSelected(ve,c,se),ve},calcAllAutoBins:s}},{"../../lib":787,"../../plots/cartesian/axes":838,"../../registry":915,"../bar/arrays_to_calcdata":924,"./average":1089,"./bin_functions":1091,"./bin_label_vals":1092,"./norm_functions":1100,"fast-isnumeric":246}],1094:[function(r,I,B){I.exports={eventDataKeys:["binNumber"]}},{}],1095:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/cartesian/axis_ids"),m=r("../../registry").traceIs,h=r("../bar/defaults").handleGroupingDefaults,e=t.nestedProperty,f=r("../../plots/cartesian/constraints").getAxisGroup,l=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],o=["x","y"];I.exports=function(u,s){var i,c,n,a,g,p,y,v=s._histogramBinOpts={},b=[],x={},T=[];function A(H,Y){return t.coerce(i._input,i,i._module.attributes,H,Y)}function S(H){return H.orientation==="v"?"x":"y"}function w(H,Y,$){var z=H.uid+"__"+$;Y||(Y=z);var j=function(Q,te){return d.getFromTrace({_fullLayout:s},Q,te).type}(H,$),W=H[$+"calendar"]||"",ee=v[Y],J=!0;ee&&(j===ee.axType&&W===ee.calendar?(J=!1,ee.traces.push(H),ee.dirs.push($)):(Y=z,j!==ee.axType&&t.warn(["Attempted to group the bins of trace",H.index,"set on a","type:"+j,"axis","with bins on","type:"+ee.axType,"axis."].join(" ")),W!==ee.calendar&&t.warn(["Attempted to group the bins of trace",H.index,"set with a",W,"calendar","with bins",ee.calendar?"on a "+ee.calendar+" calendar":"w/o a set calendar"].join(" ")))),J&&(v[Y]={traces:[H],dirs:[$],axType:j,calendar:H[$+"calendar"]||""}),H["_"+$+"bingroup"]=Y}for(g=0;g<u.length;g++)i=u[g],m(i,"histogram")&&(b.push(i),delete i._xautoBinFinished,delete i._yautoBinFinished,m(i,"2dMap")||h(i._input,i,s,A));var E=s._alignmentOpts||{};for(g=0;g<b.length;g++){if(i=b[g],n="",!m(i,"2dMap")){if(a=S(i),s.barmode==="group"&&i.alignmentgroup){var k=i[a+"axis"],L=f(s,k)+i.orientation;(E[L]||{})[i.alignmentgroup]&&(n=L)}n||s.barmode==="overlay"||(n=f(s,i.xaxis)+f(s,i.yaxis)+S(i))}n?(x[n]||(x[n]=[]),x[n].push(i)):T.push(i)}for(n in x)if((c=x[n]).length!==1){var M=!1;for(c.length&&(i=c[0],M=A("bingroup")),n=M||n,g=0;g<c.length;g++){var P=(i=c[g])._input.bingroup;P&&P!==n&&t.warn(["Trace",i.index,"must match","within bingroup",n+".","Ignoring its bingroup:",P,"setting."].join(" ")),i.bingroup=n,w(i,n,S(i))}}else T.push(c[0]);for(g=0;g<T.length;g++){i=T[g];var D=A("bingroup");if(m(i,"2dMap"))for(y=0;y<2;y++){var N=A((a=o[y])+"bingroup",D?D+"__"+a:null);w(i,N,a)}else w(i,D,S(i))}for(n in v){var U=v[n];for(c=U.traces,p=0;p<l.length;p++){var G,X,K=l[p],Z=K.name;if(Z!=="nbins"||!U.sizeFound){for(g=0;g<c.length;g++){if(i=c[g],a=U.dirs[g],G=K.aStr[a],e(i._input,G).get()!==void 0){U[Z]=A(G),U[Z+"Found"]=!0;break}(X=(i._autoBin||{})[a]||{})[Z]&&e(i,G).set(X[Z])}if(Z==="start"||Z==="end")for(;g<c.length;g++)(i=c[g])["_"+a+"bingroup"]&&A(G,(X=(i._autoBin||{})[a]||{})[Z]);Z!=="nbins"||U.sizeFound||U.nbinsFound||(i=c[0],U[Z]=A(G))}}}}},{"../../lib":787,"../../plots/cartesian/axis_ids":842,"../../plots/cartesian/constraints":846,"../../registry":915,"../bar/defaults":929}],1096:[function(r,I,B){var t=r("../../registry"),d=r("../../lib"),m=r("../../components/color"),h=r("../bar/style_defaults"),e=r("./attributes");I.exports=function(f,l,o,u){function s(b,x){return d.coerce(f,l,e,b,x)}var i=s("x"),c=s("y");s("cumulative.enabled")&&(s("cumulative.direction"),s("cumulative.currentbin")),s("text"),s("hovertext"),s("hovertemplate"),s("xhoverformat"),s("yhoverformat");var n=s("orientation",c&&!i?"h":"v"),a=n==="v"?"x":"y",g=n==="v"?"y":"x",p=i&&c?Math.min(d.minRowLength(i)&&d.minRowLength(c)):d.minRowLength(l[a]||[]);if(p){l._length=p,t.getComponentMethod("calendars","handleTraceDefaults")(f,l,["x","y"],u),l[g]&&s("histfunc"),s("histnorm"),s("autobin"+a),h(f,l,s,o,u),d.coerceSelectionMarkerOpacity(l,s);var y=(l.marker.line||{}).color,v=t.getComponentMethod("errorbars","supplyDefaults");v(f,l,y||m.defaultLine,{axis:"y"}),v(f,l,y||m.defaultLine,{axis:"x",inherit:"y"})}else l.visible=!1}},{"../../components/color":650,"../../lib":787,"../../registry":915,"../bar/style_defaults":940,"./attributes":1088}],1097:[function(r,I,B){I.exports=function(t,d,m,h,e){if(t.x="xVal"in d?d.xVal:d.x,t.y="yVal"in d?d.yVal:d.y,"zLabelVal"in d&&(t.z=d.zLabelVal),d.xa&&(t.xaxis=d.xa),d.ya&&(t.yaxis=d.ya),!(m.cumulative||{}).enabled){var f,l=Array.isArray(e)?h[0].pts[e[0]][e[1]]:h[e].pts;if(t.pointNumbers=l,t.binNumber=t.pointNumber,delete t.pointNumber,delete t.pointIndex,m._indexToPoints){f=[];for(var o=0;o<l.length;o++)f=f.concat(m._indexToPoints[l[o]])}else f=l;t.pointIndices=f}return t}},{}],1098:[function(r,I,B){var t=r("../bar/hover").hoverPoints,d=r("../../plots/cartesian/axes").hoverLabelText;I.exports=function(m,h,e,f,l){var o=t(m,h,e,f,l);if(o){var u=(m=o[0]).cd[m.index],s=m.cd[0].trace;if(!s.cumulative.enabled){var i=s.orientation==="h"?"y":"x";m[i+"Label"]=d(m[i+"a"],[u.ph0,u.ph1],s[i+"hoverformat"])}return o}}},{"../../plots/cartesian/axes":838,"../bar/hover":932}],1099:[function(r,I,B){I.exports={attributes:r("./attributes"),layoutAttributes:r("../bar/layout_attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("./cross_trace_defaults"),supplyLayoutDefaults:r("../bar/layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("../bar/cross_trace_calc").crossTraceCalc,plot:r("../bar/plot").plot,layerName:"barlayer",style:r("../bar/style").style,styleOnSelect:r("../bar/style").styleOnSelect,colorbar:r("../scatter/marker_colorbar"),hoverPoints:r("./hover"),selectPoints:r("../bar/select"),eventData:r("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:r("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":852,"../bar/cross_trace_calc":928,"../bar/layout_attributes":934,"../bar/layout_defaults":935,"../bar/plot":936,"../bar/select":937,"../bar/style":939,"../scatter/marker_colorbar":1220,"./attributes":1088,"./calc":1093,"./cross_trace_defaults":1095,"./defaults":1096,"./event_data":1097,"./hover":1098}],1100:[function(r,I,B){I.exports={percent:function(t,d){for(var m=t.length,h=100/d,e=0;e<m;e++)t[e]*=h},probability:function(t,d){for(var m=t.length,h=0;h<m;h++)t[h]/=d},density:function(t,d,m,h){var e=t.length;h=h||1;for(var f=0;f<e;f++)t[f]*=m[f]*h},"probability density":function(t,d,m,h){var e=t.length;h&&(d/=h);for(var f=0;f<e;f++)t[f]*=m[f]/d}}},{}],1101:[function(r,I,B){var t=r("../histogram/attributes"),d=r("../histogram/bin_attributes"),m=r("../heatmap/attributes"),h=r("../../plots/attributes"),e=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,f=r("../../plots/template_attributes").hovertemplateAttrs,l=r("../../components/colorscale/attributes"),o=r("../../lib/extend").extendFlat;I.exports=o({x:t.x,y:t.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:t.histnorm,histfunc:t.histfunc,nbinsx:t.nbinsx,xbins:d("x"),nbinsy:t.nbinsy,ybins:d("y"),autobinx:t.autobinx,autobiny:t.autobiny,bingroup:o({},t.bingroup,{}),xbingroup:o({},t.bingroup,{}),ybingroup:o({},t.bingroup,{}),xgap:m.xgap,ygap:m.ygap,zsmooth:m.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:f({},{keys:"z"}),showlegend:o({},h.showlegend,{dflt:!1})},l("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../heatmap/attributes":1069,"../histogram/attributes":1088,"../histogram/bin_attributes":1090}],1102:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("../histogram/bin_functions"),h=r("../histogram/norm_functions"),e=r("../histogram/average"),f=r("../histogram/bin_label_vals"),l=r("../histogram/calc").calcAllAutoBins;function o(i,c,n,a){var g,p=new Array(i);if(a)for(g=0;g<i;g++)p[g]=1/(c[g+1]-c[g]);else{var y=1/n;for(g=0;g<i;g++)p[g]=y}return p}function u(i,c){return{start:i(c.start),end:i(c.end),size:c.size}}function s(i,c,n,a,g,p){var y,v=i.length-1,b=new Array(v),x=f(n,a,i,g,p);for(y=0;y<v;y++){var T=(c||[])[y];b[y]=T===void 0?[x(i[y]),x(i[y+1],!0)]:[T,T]}return b}I.exports=function(i,c){var n,a,g,p,y=d.getFromId(i,c.xaxis),v=d.getFromId(i,c.yaxis),b=c.xcalendar,x=c.ycalendar,T=function(at){return y.r2c(at,0,b)},A=function(at){return v.r2c(at,0,x)},S=l(i,c,y,"x"),w=S[0],E=S[1],k=l(i,c,v,"y"),L=k[0],M=k[1],P=c._length;E.length>P&&E.splice(P,E.length-P),M.length>P&&M.splice(P,M.length-P);var D=[],N=[],U=[],G=typeof w.size=="string",X=typeof L.size=="string",K=[],Z=[],H=G?K:w,Y=X?Z:L,$=0,z=[],j=[],W=c.histnorm,ee=c.histfunc,J=W.indexOf("density")!==-1,Q=ee==="max"||ee==="min"?null:0,te=m.count,ie=h[W],ae=!1,he=[],se=[],de="z"in c?c.z:"marker"in c&&Array.isArray(c.marker.color)?c.marker.color:"";de&&ee!=="count"&&(ae=ee==="avg",te=m[ee]);var ue=w.size,ve=T(w.start),ke=T(w.end)+(ve-d.tickIncrement(ve,ue,!1,b))/1e6;for(n=ve;n<ke;n=d.tickIncrement(n,ue,!1,b))N.push(Q),K.push(n),ae&&U.push(0);K.push(n);var Ee,be=N.length,xe=(n-ve)/be,ce=(Ee=ve+xe/2,y.c2r(Ee,0,b)),ge=L.size,we=A(L.start),Me=A(L.end)+(we-d.tickIncrement(we,ge,!1,x))/1e6;for(n=we;n<Me;n=d.tickIncrement(n,ge,!1,x)){D.push(N.slice()),Z.push(n);var Se=new Array(be);for(a=0;a<be;a++)Se[a]=[];j.push(Se),ae&&z.push(U.slice())}Z.push(n);var ze=D.length,Fe=(n-we)/ze,Ye=function(at){return v.c2r(at,0,x)}(we+Fe/2);J&&(he=o(N.length,H,xe,G),se=o(D.length,Y,Fe,X)),G||y.type!=="date"||(H=u(T,H)),X||v.type!=="date"||(Y=u(A,Y));var rt=!0,Oe=!0,je=new Array(be),We=new Array(ze),qe=1/0,et=1/0,st=1/0,ct=1/0;for(n=0;n<P;n++){var Pt=E[n],kt=M[n];g=t.findBin(Pt,H),p=t.findBin(kt,Y),g>=0&&g<be&&p>=0&&p<ze&&($+=te(g,n,D[p],de,z[p]),j[p][g].push(n),rt&&(je[g]===void 0?je[g]=Pt:je[g]!==Pt&&(rt=!1)),Oe&&(We[p]===void 0?We[p]=kt:We[p]!==kt&&(Oe=!1)),qe=Math.min(qe,Pt-K[g]),et=Math.min(et,K[g+1]-Pt),st=Math.min(st,kt-Z[p]),ct=Math.min(ct,Z[p+1]-kt))}if(ae)for(p=0;p<ze;p++)$+=e(D[p],z[p]);if(ie)for(p=0;p<ze;p++)ie(D[p],$,he,se[p]);return{x:E,xRanges:s(K,rt&&je,qe,et,y,b),x0:ce,dx:xe,y:M,yRanges:s(Z,Oe&&We,st,ct,v,x),y0:Ye,dy:Fe,z:D,pts:j}}},{"../../lib":787,"../../plots/cartesian/axes":838,"../histogram/average":1089,"../histogram/bin_functions":1091,"../histogram/bin_label_vals":1092,"../histogram/calc":1093,"../histogram/norm_functions":1100}],1103:[function(r,I,B){var t=r("../../lib"),d=r("./sample_defaults"),m=r("../heatmap/style_defaults"),h=r("../../components/colorscale/defaults"),e=r("./attributes");I.exports=function(f,l,o,u){function s(i,c){return t.coerce(f,l,e,i,c)}d(f,l,s,u),l.visible!==!1&&(m(f,l,s,u),h(f,l,u,s,{prefix:"",cLetter:"z"}),s("hovertemplate"),s("xhoverformat"),s("yhoverformat"))}},{"../../components/colorscale/defaults":660,"../../lib":787,"../heatmap/style_defaults":1082,"./attributes":1101,"./sample_defaults":1106}],1104:[function(r,I,B){var t=r("../heatmap/hover"),d=r("../../plots/cartesian/axes").hoverLabelText;I.exports=function(m,h,e,f,l){var o=t(m,h,e,f,l);if(o){var u=(m=o[0]).index,s=u[0],i=u[1],c=m.cd[0],n=c.trace,a=c.xRanges[i],g=c.yRanges[s];return m.xLabel=d(m.xa,[a[0],a[1]],n.xhoverformat),m.yLabel=d(m.ya,[g[0],g[1]],n.yhoverformat),o}}},{"../../plots/cartesian/axes":838,"../heatmap/hover":1076}],1105:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("../histogram/cross_trace_defaults"),calc:r("../heatmap/calc"),plot:r("../heatmap/plot"),layerName:"heatmaplayer",colorbar:r("../heatmap/colorbar"),style:r("../heatmap/style"),hoverPoints:r("./hover"),eventData:r("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":852,"../heatmap/calc":1070,"../heatmap/colorbar":1072,"../heatmap/plot":1080,"../heatmap/style":1081,"../histogram/cross_trace_defaults":1095,"../histogram/event_data":1097,"./attributes":1101,"./defaults":1103,"./hover":1104}],1106:[function(r,I,B){var t=r("../../registry"),d=r("../../lib");I.exports=function(m,h,e,f){var l=e("x"),o=e("y"),u=d.minRowLength(l),s=d.minRowLength(o);u&&s?(h._length=Math.min(u,s),t.getComponentMethod("calendars","handleTraceDefaults")(m,h,["x","y"],f),(e("z")||e("marker.color"))&&e("histfunc"),e("histnorm"),e("autobinx"),e("autobiny")):h.visible=!1}},{"../../lib":787,"../../registry":915}],1107:[function(r,I,B){var t=r("../histogram2d/attributes"),d=r("../contour/attributes"),m=r("../../components/colorscale/attributes"),h=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=r("../../lib/extend").extendFlat;I.exports=e({x:t.x,y:t.y,z:t.z,marker:t.marker,histnorm:t.histnorm,histfunc:t.histfunc,nbinsx:t.nbinsx,xbins:t.xbins,nbinsy:t.nbinsy,ybins:t.ybins,autobinx:t.autobinx,autobiny:t.autobiny,bingroup:t.bingroup,xbingroup:t.xbingroup,ybingroup:t.ybingroup,autocontour:d.autocontour,ncontours:d.ncontours,contours:d.contours,line:{color:d.line.color,width:e({},d.line.width,{dflt:.5}),dash:d.line.dash,smoothing:d.line.smoothing,editType:"plot"},xhoverformat:h("x"),yhoverformat:h("y"),zhoverformat:h("z",1),hovertemplate:t.hovertemplate},m("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../contour/attributes":1012,"../histogram2d/attributes":1101}],1108:[function(r,I,B){var t=r("../../lib"),d=r("../histogram2d/sample_defaults"),m=r("../contour/contours_defaults"),h=r("../contour/style_defaults"),e=r("./attributes");I.exports=function(f,l,o,u){function s(i,c){return t.coerce(f,l,e,i,c)}d(f,l,s,u),l.visible!==!1&&(m(f,l,s,function(i){return t.coerce2(f,l,e,i)}),h(f,l,s,u),s("hovertemplate"),s("xhoverformat"),s("yhoverformat"))}},{"../../lib":787,"../contour/contours_defaults":1019,"../contour/style_defaults":1033,"../histogram2d/sample_defaults":1106,"./attributes":1107}],1109:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("../histogram/cross_trace_defaults"),calc:r("../contour/calc"),plot:r("../contour/plot").plot,layerName:"contourlayer",style:r("../contour/style"),colorbar:r("../contour/colorbar"),hoverPoints:r("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":852,"../contour/calc":1013,"../contour/colorbar":1015,"../contour/hover":1025,"../contour/plot":1030,"../contour/style":1032,"../histogram/cross_trace_defaults":1095,"./attributes":1107,"./defaults":1108}],1110:[function(r,I,B){var t=r("../../plots/template_attributes").hovertemplateAttrs,d=r("../../plots/template_attributes").texttemplateAttrs,m=r("../../components/colorscale/attributes"),h=r("../../plots/domain").attributes,e=r("../pie/attributes"),f=r("../sunburst/attributes"),l=r("../treemap/attributes"),o=r("../treemap/constants"),u=r("../../lib/extend").extendFlat;I.exports={labels:f.labels,parents:f.parents,values:f.values,branchvalues:f.branchvalues,count:f.count,level:f.level,maxdepth:f.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:l.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:u({colors:f.marker.colors,line:f.marker.line,editType:"calc"},m("marker",{colorAttr:"colors",anim:!1})),leaf:f.leaf,pathbar:l.pathbar,text:e.text,textinfo:f.textinfo,texttemplate:d({editType:"plot"},{keys:o.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:f.hoverinfo,hovertemplate:t({},{keys:o.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:l.outsidetextfont,textposition:l.textposition,sort:e.sort,root:f.root,domain:h({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/domain":866,"../../plots/template_attributes":910,"../pie/attributes":1176,"../sunburst/attributes":1314,"../treemap/attributes":1340,"../treemap/constants":1343}],1111:[function(r,I,B){var t=r("../../plots/plots");B.name="icicle",B.plot=function(d,m,h,e){t.plotBasePlot(B.name,d,m,h,e)},B.clean=function(d,m,h,e){t.cleanBasePlot(B.name,d,m,h,e)}},{"../../plots/plots":901}],1112:[function(r,I,B){var t=r("../sunburst/calc");B.calc=function(d,m){return t.calc(d,m)},B.crossTraceCalc=function(d){return t._runCrossTraceCalc("icicle",d)}},{"../sunburst/calc":1316}],1113:[function(r,I,B){var t=r("../../lib"),d=r("./attributes"),m=r("../../components/color"),h=r("../../plots/domain").defaults,e=r("../bar/defaults").handleText,f=r("../bar/constants").TEXTPAD,l=r("../../components/colorscale"),o=l.hasColorscale,u=l.handleDefaults;I.exports=function(s,i,c,n){function a(T,A){return t.coerce(s,i,d,T,A)}var g=a("labels"),p=a("parents");if(g&&g.length&&p&&p.length){var y=a("values");y&&y.length?a("branchvalues"):a("count"),a("level"),a("maxdepth"),a("tiling.orientation"),a("tiling.flip"),a("tiling.pad");var v=a("text");a("texttemplate"),i.texttemplate||a("textinfo",Array.isArray(v)?"text+label":"label"),a("hovertext"),a("hovertemplate");var b=a("pathbar.visible");e(s,i,n,a,"auto",{hasPathbar:b,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),a("textposition"),a("marker.line.width")&&a("marker.line.color",n.paper_bgcolor),a("marker.colors");var x=i._hasColorscale=o(s,"marker","colors")||(s.marker||{}).coloraxis;x&&u(s,i,n,a,{prefix:"marker.",cLetter:"c"}),a("leaf.opacity",x?1:.7),i._hovered={marker:{line:{width:2,color:m.contrast(n.paper_bgcolor)}}},b&&(a("pathbar.thickness",i.pathbar.textfont.size+2*f),a("pathbar.side"),a("pathbar.edgeshape")),a("sort"),a("root.color"),h(i,n,a),i._length=null}else i.visible=!1}},{"../../components/color":650,"../../components/colorscale":662,"../../lib":787,"../../plots/domain":866,"../bar/constants":927,"../bar/defaults":929,"./attributes":1110}],1114:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../components/drawing"),h=r("../../lib/svg_text_utils"),e=r("./partition"),f=r("./style").styleOne,l=r("../treemap/constants"),o=r("../sunburst/helpers"),u=r("../sunburst/fx"),s=r("../sunburst/plot").formatSliceLabel;I.exports=function(i,c,n,a,g){var p=g.width,y=g.height,v=g.viewX,b=g.viewY,x=g.pathSlice,T=g.toMoveInsideSlice,A=g.strTransform,S=g.hasTransition,w=g.handleSlicesExit,E=g.makeUpdateSliceInterpolator,k=g.makeUpdateTextInterpolator,L=g.prevEntry,M=i._fullLayout,P=c[0].trace,D=P.textposition.indexOf("left")!==-1,N=P.textposition.indexOf("right")!==-1,U=P.textposition.indexOf("bottom")!==-1,G=e(n,[p,y],{flipX:P.tiling.flip.indexOf("x")>-1,flipY:P.tiling.flip.indexOf("y")>-1,orientation:P.tiling.orientation,pad:{inner:P.tiling.pad},maxDepth:P._maxDepth}).descendants(),X=1/0,K=-1/0;G.forEach(function(z){var j=z.depth;j>=P._maxDepth?(z.x0=z.x1=(z.x0+z.x1)/2,z.y0=z.y1=(z.y0+z.y1)/2):(X=Math.min(X,j),K=Math.max(K,j))}),a=a.data(G,o.getPtId),P._maxVisibleLayers=isFinite(K)?K-X+1:0,a.enter().append("g").classed("slice",!0),w(a,!1,{},[p,y],x),a.order();var Z=null;if(S&&L){var H=o.getPtId(L);a.each(function(z){Z===null&&o.getPtId(z)===H&&(Z={x0:z.x0,x1:z.x1,y0:z.y0,y1:z.y1})})}var Y=function(){return Z||{x0:0,x1:p,y0:0,y1:y}},$=a;return S&&($=$.transition().each("end",function(){var z=t.select(this);o.setSliceCursor(z,i,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),$.each(function(z){z._x0=v(z.x0),z._x1=v(z.x1),z._y0=b(z.y0),z._y1=b(z.y1),z._hoverX=v(z.x1-P.tiling.pad),z._hoverY=b(U?z.y1-P.tiling.pad/2:z.y0+P.tiling.pad/2);var j=t.select(this),W=d.ensureSingle(j,"path","surface",function(te){te.style("pointer-events","all")});S?W.transition().attrTween("d",function(te){var ie=E(te,!1,Y(),[p,y],{orientation:P.tiling.orientation,flipX:P.tiling.flip.indexOf("x")>-1,flipY:P.tiling.flip.indexOf("y")>-1});return function(ae){return x(ie(ae))}}):W.attr("d",x),j.call(u,n,i,c,{styleOne:f,eventDataKeys:l.eventDataKeys,transitionTime:l.CLICK_TRANSITION_TIME,transitionEasing:l.CLICK_TRANSITION_EASING}).call(o.setSliceCursor,i,{isTransitioning:i._transitioning}),W.call(f,z,P,{hovered:!1}),z.x0===z.x1||z.y0===z.y1?z._text="":z._text=s(z,n,P,c,M)||"";var ee=d.ensureSingle(j,"g","slicetext"),J=d.ensureSingle(ee,"text","",function(te){te.attr("data-notex",1)}),Q=d.ensureUniformFontSize(i,o.determineTextFont(P,z,M.font));J.text(z._text||" ").classed("slicetext",!0).attr("text-anchor",N?"end":D?"start":"middle").call(m.font,Q).call(h.convertToTspans,i),z.textBB=m.bBox(J.node()),z.transform=T(z,{fontSize:Q.size}),z.transform.fontSize=Q.size,S?J.transition().attrTween("transform",function(te){var ie=k(te,!1,Y(),[p,y]);return function(ae){return A(ie(ae))}}):J.attr("transform",A(z))}),Z}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../sunburst/fx":1319,"../sunburst/helpers":1320,"../sunburst/plot":1324,"../treemap/constants":1343,"./partition":1118,"./style":1120,"@plotly/d3":58}],1115:[function(r,I,B){I.exports={moduleType:"trace",name:"icicle",basePlotModule:r("./base_plot"),categories:[],animatable:!0,attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot"),style:r("./style").style,colorbar:r("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1220,"./attributes":1110,"./base_plot":1111,"./calc":1112,"./defaults":1113,"./layout_attributes":1116,"./layout_defaults":1117,"./plot":1119,"./style":1120}],1116:[function(r,I,B){I.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1117:[function(r,I,B){var t=r("../../lib"),d=r("./layout_attributes");I.exports=function(m,h){function e(f,l){return t.coerce(m,h,d,f,l)}e("iciclecolorway",h.colorway),e("extendiciclecolors")}},{"../../lib":787,"./layout_attributes":1116}],1118:[function(r,I,B){var t=r("d3-hierarchy"),d=r("../treemap/flip_tree");I.exports=function(m,h,e){var f=e.flipX,l=e.flipY,o=e.orientation==="h",u=e.maxDepth,s=h[0],i=h[1];u&&(s=(m.height+1)*h[0]/Math.min(m.height+1,u),i=(m.height+1)*h[1]/Math.min(m.height+1,u));var c=t.partition().padding(e.pad.inner).size(o?[h[1],s]:[h[0],i])(m);return(o||f||l)&&d(c,h,{swapXY:o,flipX:f,flipY:l}),c}},{"../treemap/flip_tree":1348,"d3-hierarchy":167}],1119:[function(r,I,B){var t=r("../treemap/draw"),d=r("./draw_descendants");I.exports=function(m,h,e,f){return t(m,h,e,f,{type:"icicle",drawDescendants:d})}},{"../treemap/draw":1345,"./draw_descendants":1114}],1120:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/color"),m=r("../../lib"),h=r("../bar/uniform_text").resizeText;function e(f,l,o){var u=l.data.data,s=!l.children,i=u.i,c=m.castOption(o,i,"marker.line.color")||d.defaultLine,n=m.castOption(o,i,"marker.line.width")||0;f.style("stroke-width",n).call(d.fill,u.color).call(d.stroke,c).style("opacity",s?o.leaf.opacity:null)}I.exports={style:function(f){var l=f._fullLayout._iciclelayer.selectAll(".trace");h(f,l,"icicle"),l.each(function(o){var u=t.select(this),s=o[0].trace;u.style("opacity",s.opacity),u.selectAll("path.surface").each(function(i){t.select(this).call(e,i,s)})})},styleOne:e}},{"../../components/color":650,"../../lib":787,"../bar/uniform_text":941,"@plotly/d3":58}],1121:[function(r,I,B){for(var t=r("../../plots/attributes"),d=r("../../plots/template_attributes").hovertemplateAttrs,m=r("../../lib/extend").extendFlat,h=r("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],f=[],l=[],o=0;o<e.length;o++){var u=h[e[o]];f.push("For the `"+e[o]+"` colormodel, it is ["+(u.zminDflt||u.min).join(", ")+"]."),l.push("For the `"+e[o]+"` colormodel, it is ["+(u.zmaxDflt||u.max).join(", ")+"].")}I.exports=m({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:m({},t.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:d({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"./constants":1123}],1122:[function(r,I,B){var t=r("../../lib"),d=r("./constants"),m=r("fast-isnumeric"),h=r("../../plots/cartesian/axes"),e=r("../../lib").maxRowLength,f=r("./helpers").getImageSize;function l(u,s,i,c){return function(n){return t.constrain((n-u)*s,i,c)}}function o(u,s){return function(i){return t.constrain(i,u,s)}}I.exports=function(u,s){var i,c;if(s._hasZ)i=s.z.length,c=e(s.z);else if(s._hasSource){var n=f(s.source);i=n.height,c=n.width}var a,g=h.getFromId(u,s.xaxis||"x"),p=h.getFromId(u,s.yaxis||"y"),y=g.d2c(s.x0)-s.dx/2,v=p.d2c(s.y0)-s.dy/2,b=[y,y+c*s.dx],x=[v,v+i*s.dy];if(g&&g.type==="log")for(a=0;a<c;a++)b.push(y+a*s.dx);if(p&&p.type==="log")for(a=0;a<i;a++)x.push(v+a*s.dy);return s._extremes[g._id]=h.findExtremes(g,b),s._extremes[p._id]=h.findExtremes(p,x),s._scaler=function(T){var A=d.colormodel[T.colormodel],S=(A.colormodel||T.colormodel).length;T._sArray=[];for(var w=0;w<S;w++)A.min[w]!==T.zmin[w]||A.max[w]!==T.zmax[w]?T._sArray.push(l(T.zmin[w],(A.max[w]-A.min[w])/(T.zmax[w]-T.zmin[w]),A.min[w],A.max[w])):T._sArray.push(o(A.min[w],A.max[w]));return function(E){for(var k=E.slice(0,S),L=0;L<S;L++){var M=k[L];if(!m(M))return!1;k[L]=T._sArray[L](M)}return k}}(s),[{x0:y,y0:v,z:s.z,w:c,h:i}]}},{"../../lib":787,"../../plots/cartesian/axes":838,"./constants":1123,"./helpers":1126,"fast-isnumeric":246}],1123:[function(r,I,B){I.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(t){return t.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(t){return t.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(t){return t.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(t){var d=t.slice(0,3);return d[1]=d[1]+"%",d[2]=d[2]+"%",d},suffix:["\xB0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(t){var d=t.slice(0,4);return d[1]=d[1]+"%",d[2]=d[2]+"%",d},suffix:["\xB0","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],1124:[function(r,I,B){var t=r("../../lib"),d=r("./attributes"),m=r("./constants"),h=r("../../snapshot/helpers").IMAGE_URL_PREFIX;I.exports=function(e,f){function l(s,i){return t.coerce(e,f,d,s,i)}l("source"),f.source&&!f.source.match(h)&&delete f.source,f._hasSource=!!f.source;var o,u=l("z");f._hasZ=!(u===void 0||!u.length||!u[0]||!u[0].length),f._hasZ||f._hasSource?(l("x0"),l("y0"),l("dx"),l("dy"),f._hasZ?(l("colormodel","rgb"),l("zmin",(o=m.colormodel[f.colormodel]).zminDflt||o.min),l("zmax",o.zmaxDflt||o.max)):f._hasSource&&(f.colormodel="rgba256",o=m.colormodel[f.colormodel],f.zmin=o.zminDflt,f.zmax=o.zmaxDflt),l("zsmooth"),l("text"),l("hovertext"),l("hovertemplate"),f._length=null):f.visible=!1}},{"../../lib":787,"../../snapshot/helpers":919,"./attributes":1121,"./constants":1123}],1125:[function(r,I,B){I.exports=function(t,d){return"xVal"in d&&(t.x=d.xVal),"yVal"in d&&(t.y=d.yVal),d.xa&&(t.xaxis=d.xa),d.ya&&(t.yaxis=d.ya),t.color=d.color,t.colormodel=d.trace.colormodel,t.z||(t.z=d.color),t}},{}],1126:[function(r,I,B){var t=r("probe-image-size/sync"),d=r("../../snapshot/helpers").IMAGE_URL_PREFIX,m=r("buffer/").Buffer;B.getImageSize=function(h){var e=h.replace(d,""),f=new m(e,"base64");return t(f)}},{"../../snapshot/helpers":919,"buffer/":117,"probe-image-size/sync":513}],1127:[function(r,I,B){var t=r("../../components/fx"),d=r("../../lib"),m=r("./constants");I.exports=function(h,e,f){var l=h.cd[0],o=l.trace,u=h.xa,s=h.ya;if(!(t.inbox(e-l.x0,e-(l.x0+l.w*o.dx),0)>0||t.inbox(f-l.y0,f-(l.y0+l.h*o.dy),0)>0)){var i,c=Math.floor((e-l.x0)/o.dx),n=Math.floor(Math.abs(f-l.y0)/o.dy);if(o._hasZ?i=l.z[n][c]:o._hasSource&&(i=o._canvas.el.getContext("2d").getImageData(c,n,1,1).data),i){var a,g=l.hi||o.hoverinfo;if(g){var p=g.split("+");p.indexOf("all")!==-1&&(p=["color"]),p.indexOf("color")!==-1&&(a=!0)}var y,v=m.colormodel[o.colormodel],b=v.colormodel||o.colormodel,x=b.length,T=o._scaler(i),A=v.suffix,S=[];(o.hovertemplate||a)&&(S.push("["+[T[0]+A[0],T[1]+A[1],T[2]+A[2]].join(", ")),x===4&&S.push(", "+T[3]+A[3]),S.push("]"),S=S.join(""),h.extraText=b.toUpperCase()+": "+S),Array.isArray(o.hovertext)&&Array.isArray(o.hovertext[n])?y=o.hovertext[n][c]:Array.isArray(o.text)&&Array.isArray(o.text[n])&&(y=o.text[n][c]);var w=s.c2p(l.y0+(n+.5)*o.dy),E=l.x0+(c+.5)*o.dx,k=l.y0+(n+.5)*o.dy,L="["+i.slice(0,o.colormodel.length).join(", ")+"]";return[d.extendFlat(h,{index:[n,c],x0:u.c2p(l.x0+c*o.dx),x1:u.c2p(l.x0+(c+1)*o.dx),y0:w,y1:w,color:T,xVal:E,xLabelVal:E,yVal:k,yLabelVal:k,zLabelVal:L,text:y,hovertemplateLabels:{zLabel:L,colorLabel:S,"color[0]Label":T[0]+A[0],"color[1]Label":T[1]+A[1],"color[2]Label":T[2]+A[2],"color[3]Label":T[3]+A[3]}})]}}}},{"../../components/fx":690,"../../lib":787,"./constants":1123}],1128:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),style:r("./style"),hoverPoints:r("./hover"),eventData:r("./event_data"),moduleType:"trace",name:"image",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":852,"./attributes":1121,"./calc":1122,"./defaults":1124,"./event_data":1125,"./hover":1127,"./plot":1129,"./style":1130}],1129:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=d.strTranslate,h=r("../../constants/xmlns_namespaces"),e=r("./constants"),f=d.isIOS()||d.isSafari()||d.isIE();I.exports=function(l,o,u,s){var i=o.xaxis,c=o.yaxis,n=!(f||l._context._exportedPlot);d.makeTraceGroups(s,u,"im").each(function(a){var g=t.select(this),p=a[0],y=p.trace,v=(y.zsmooth==="fast"||y.zsmooth===!1&&n)&&!y._hasZ&&y._hasSource&&i.type==="linear"&&c.type==="linear";y._realImage=v;var b,x,T,A,S,w,E=p.z,k=p.x0,L=p.y0,M=p.w,P=p.h,D=y.dx,N=y.dy;for(w=0;b===void 0&&w<M;)b=i.c2p(k+w*D),w++;for(w=M;x===void 0&&w>0;)x=i.c2p(k+w*D),w--;for(w=0;A===void 0&&w<P;)A=c.c2p(L+w*N),w++;for(w=P;S===void 0&&w>0;)S=c.c2p(L+w*N),w--;x<b&&(T=x,x=b,b=T),S<A&&(T=A,A=S,S=T),!v&&(b=Math.max(-.5*i._length,b),x=Math.min(1.5*i._length,x),A=Math.max(-.5*c._length,A),S=Math.min(1.5*c._length,S));var U=Math.round(x-b),G=Math.round(S-A);if(U<=0||G<=0)g.selectAll("image").data([]).exit().remove();else{var X=g.selectAll("image").data([a]);X.enter().append("svg:image").attr({xmlns:h.svg,preserveAspectRatio:"none"}),X.exit().remove();var K=y.zsmooth===!1?e.pixelatedStyle:"";if(v){var Z=d.simpleMap(i.range,i.r2l),H=d.simpleMap(c.range,c.r2l),Y=Z[1]<Z[0],$=H[1]>H[0];if(Y||$){var z=b+U/2,j=A+G/2;K+="transform:"+m(z+"px",j+"px")+"scale("+(Y?-1:1)+","+($?-1:1)+")"+m(-z+"px",-j+"px")+";"}}X.attr("style",K);var W=new Promise(function(J){if(y._hasZ)J();else if(y._hasSource)if(y._canvas&&y._canvas.el.width===M&&y._canvas.el.height===P&&y._canvas.source===y.source)J();else{var Q=document.createElement("canvas");Q.width=M,Q.height=P;var te=Q.getContext("2d");y._image=y._image||new Image;var ie=y._image;ie.onload=function(){te.drawImage(ie,0,0),y._canvas={el:Q,source:y.source},J()},ie.setAttribute("src",y.source)}}).then(function(){var J;if(y._hasZ)J=ee(function(te,ie){return E[ie][te]}).toDataURL("image/png");else if(y._hasSource)if(v)J=y.source;else{var Q=y._canvas.el.getContext("2d").getImageData(0,0,M,P).data;J=ee(function(te,ie){var ae=4*(ie*M+te);return[Q[ae],Q[ae+1],Q[ae+2],Q[ae+3]]}).toDataURL("image/png")}X.attr({"xlink:href":J,height:G,width:U,x:b,y:A})});l._promises.push(W)}function ee(J){var Q=document.createElement("canvas");Q.width=U,Q.height=G;var te,ie=Q.getContext("2d"),ae=function(ce){return d.constrain(Math.round(i.c2p(k+ce*D)-b),0,U)},he=function(ce){return d.constrain(Math.round(c.c2p(L+ce*N)-A),0,G)},se=e.colormodel[y.colormodel],de=se.colormodel||y.colormodel,ue=se.fmt;for(w=0;w<p.w;w++){var ve=ae(w),ke=ae(w+1);if(ke!==ve&&!isNaN(ke)&&!isNaN(ve))for(var Ee=0;Ee<p.h;Ee++){var be=he(Ee),xe=he(Ee+1);xe===be||isNaN(xe)||isNaN(be)||!J(w,Ee)||(te=y._scaler(J(w,Ee)),ie.fillStyle=te?de+"("+ue(te).join(",")+")":"rgba(0,0,0,0)",ie.fillRect(ve,be,ke-ve,xe-be))}}return Q}})}},{"../../constants/xmlns_namespaces":764,"../../lib":787,"./constants":1123,"@plotly/d3":58}],1130:[function(r,I,B){var t=r("@plotly/d3");I.exports=function(d){t.select(d).selectAll(".im image").style("opacity",function(m){return m[0].trace.opacity})}},{"@plotly/d3":58}],1131:[function(r,I,B){var t=r("../../lib/extend").extendFlat,d=r("../../lib/extend").extendDeep,m=r("../../plot_api/edit_types").overrideAll,h=r("../../plots/font_attributes"),e=r("../../components/color/attributes"),f=r("../../plots/domain").attributes,l=r("../../plots/cartesian/layout_attributes"),o=r("../../plot_api/plot_template").templatedArray,u=r("../../constants/delta.js"),s=r("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,i=h({editType:"plot",colorEditType:"plot"}),c={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},n={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},a=o("step",d({},c,{range:n}));I.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:f({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:t({},i,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:s("value")},font:t({},i,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:s("value")},increasing:{symbol:{valType:"string",dflt:u.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:u.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:u.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:u.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:t({},i,{}),editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:d({},c,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:m({range:n,visible:t({},l.visible,{dflt:!0}),tickmode:l.tickmode,nticks:l.nticks,tick0:l.tick0,dtick:l.dtick,tickvals:l.tickvals,ticktext:l.ticktext,ticks:t({},l.ticks,{dflt:"outside"}),ticklen:l.ticklen,tickwidth:l.tickwidth,tickcolor:l.tickcolor,showticklabels:l.showticklabels,tickfont:h({}),tickangle:l.tickangle,tickformat:l.tickformat,tickformatstops:l.tickformatstops,tickprefix:l.tickprefix,showtickprefix:l.showtickprefix,ticksuffix:l.ticksuffix,showticksuffix:l.showticksuffix,separatethousands:l.separatethousands,exponentformat:l.exponentformat,minexponent:l.minexponent,showexponent:l.showexponent,editType:"plot"},"plot"),steps:a,threshold:{line:{color:t({},c.line.color,{}),width:t({},c.line.width,{dflt:1}),editType:"plot"},thickness:t({},c.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":649,"../../constants/delta.js":757,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../plots/cartesian/axis_format_attributes":841,"../../plots/cartesian/layout_attributes":853,"../../plots/domain":866,"../../plots/font_attributes":867}],1132:[function(r,I,B){var t=r("../../plots/plots");B.name="indicator",B.plot=function(d,m,h,e){t.plotBasePlot(B.name,d,m,h,e)},B.clean=function(d,m,h,e){t.cleanBasePlot(B.name,d,m,h,e)}},{"../../plots/plots":901}],1133:[function(r,I,B){I.exports={calc:function(t,d){var m=[],h=d.value;typeof d._lastValue!="number"&&(d._lastValue=d.value);var e=d._lastValue,f=e;return d._hasDelta&&typeof d.delta.reference=="number"&&(f=d.delta.reference),m[0]={y:h,lastY:e,delta:h-f,relativeDelta:(h-f)/f},m}}},{}],1134:[function(r,I,B){I.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],1135:[function(r,I,B){var t=r("../../lib"),d=r("./attributes"),m=r("../../plots/domain").defaults,h=r("../../plot_api/plot_template"),e=r("../../plots/array_container_defaults"),f=r("./constants.js"),l=r("../../plots/cartesian/tick_value_defaults"),o=r("../../plots/cartesian/tick_mark_defaults"),u=r("../../plots/cartesian/tick_label_defaults");function s(i,c){function n(a,g){return t.coerce(i,c,d.gauge.steps,a,g)}n("color"),n("line.color"),n("line.width"),n("range"),n("thickness")}I.exports={supplyDefaults:function(i,c,n,a){function g(L,M){return t.coerce(i,c,d,L,M)}m(c,a,g),g("mode"),c._hasNumber=c.mode.indexOf("number")!==-1,c._hasDelta=c.mode.indexOf("delta")!==-1,c._hasGauge=c.mode.indexOf("gauge")!==-1;var p=g("value");c._range=[0,typeof p=="number"?1.5*p:1];var y,v,b,x,T,A,S=new Array(2);function w(L,M){return t.coerce(b,x,d.gauge,L,M)}function E(L,M){return t.coerce(T,A,d.gauge.axis,L,M)}if(c._hasNumber&&(g("number.valueformat"),g("number.font.color",a.font.color),g("number.font.family",a.font.family),g("number.font.size"),c.number.font.size===void 0&&(c.number.font.size=f.defaultNumberFontSize,S[0]=!0),g("number.prefix"),g("number.suffix"),y=c.number.font.size),c._hasDelta&&(g("delta.font.color",a.font.color),g("delta.font.family",a.font.family),g("delta.font.size"),c.delta.font.size===void 0&&(c.delta.font.size=(c._hasNumber?.5:1)*(y||f.defaultNumberFontSize),S[1]=!0),g("delta.reference",c.value),g("delta.relative"),g("delta.valueformat",c.delta.relative?"2%":""),g("delta.increasing.symbol"),g("delta.increasing.color"),g("delta.decreasing.symbol"),g("delta.decreasing.color"),g("delta.position"),v=c.delta.font.size),c._scaleNumbers=(!c._hasNumber||S[0])&&(!c._hasDelta||S[1])||!1,g("title.font.color",a.font.color),g("title.font.family",a.font.family),g("title.font.size",.25*(y||v||f.defaultNumberFontSize)),g("title.text"),c._hasGauge){(b=i.gauge)||(b={}),x=h.newContainer(c,"gauge"),w("shape"),(c._isBullet=c.gauge.shape==="bullet")||g("title.align","center"),(c._isAngular=c.gauge.shape==="angular")||g("align","center"),w("bgcolor",a.paper_bgcolor),w("borderwidth"),w("bordercolor"),w("bar.color"),w("bar.line.color"),w("bar.line.width"),w("bar.thickness",f.valueThickness*(c.gauge.shape==="bullet"?.5:1)),e(b,x,{name:"steps",handleItemDefaults:s}),w("threshold.value"),w("threshold.thickness"),w("threshold.line.width"),w("threshold.line.color"),T={},b&&(T=b.axis||{}),A=h.newContainer(x,"axis"),E("visible"),c._range=E("range",c._range);var k={outerTicks:!0};l(T,A,E,"linear"),u(T,A,E,"linear",k),o(T,A,E,k)}else g("title.align","center"),g("align","center"),c._isAngular=c._isBullet=!1;c._length=null}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/array_container_defaults":833,"../../plots/cartesian/tick_label_defaults":860,"../../plots/cartesian/tick_mark_defaults":861,"../../plots/cartesian/tick_value_defaults":862,"../../plots/domain":866,"./attributes":1131,"./constants.js":1134}],1136:[function(r,I,B){I.exports={moduleType:"trace",name:"indicator",basePlotModule:r("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:r("./attributes"),supplyDefaults:r("./defaults").supplyDefaults,calc:r("./calc").calc,plot:r("./plot"),meta:{}}},{"./attributes":1131,"./base_plot":1132,"./calc":1133,"./defaults":1135,"./plot":1137}],1137:[function(r,I,B){var t=r("@plotly/d3"),d=r("d3-interpolate").interpolate,m=r("d3-interpolate").interpolateNumber,h=r("../../lib"),e=h.strScale,f=h.strTranslate,l=h.rad2deg,o=r("../../constants/alignment").MID_SHIFT,u=r("../../components/drawing"),s=r("./constants"),i=r("../../lib/svg_text_utils"),c=r("../../plots/cartesian/axes"),n=r("../../plots/cartesian/axis_defaults"),a=r("../../plots/cartesian/position_defaults"),g=r("../../plots/cartesian/layout_attributes"),p=r("../../components/color"),y={left:"start",center:"middle",right:"end"},v={left:0,center:.5,right:1},b=/[yzafpn\xb5mkMGTPEZY]/;function x(k){return k&&k.duration>0}function T(k){k.each(function(L){p.stroke(t.select(this),L.line.color)}).each(function(L){p.fill(t.select(this),L.color)}).style("stroke-width",function(L){return L.line.width})}function A(k,L,M){var P=k._fullLayout,D=h.extendFlat({type:"linear",ticks:"outside",range:M,showline:!0},L),N={type:"linear",_id:"x"+L._id},U={letter:"x",font:P.font,noHover:!0,noTickson:!0};function G(X,K){return h.coerce(D,N,g,X,K)}return n(D,N,G,U,P),a(D,N,G,U),N}function S(k,L,M){return[Math.min(L/k.width,M/k.height),k,L+"x"+M]}function w(k,L,M,P){var D=document.createElementNS("http://www.w3.org/2000/svg","text"),N=t.select(D);return N.text(k).attr("x",0).attr("y",0).attr("text-anchor",M).attr("data-unformatted",k).call(i.convertToTspans,P).call(u.font,L),u.bBox(N.node())}function E(k,L,M,P,D,N){var U="_cache"+L;k[U]&&k[U].key===D||(k[U]={key:D,value:M});var G=h.aggNums(N,null,[k[U].value,P],2);return k[U].value=G,G}I.exports=function(k,L,M,P){var D,N=k._fullLayout;x(M)&&P&&(D=P()),h.makeTraceGroups(N._indicatorlayer,L,"trace").each(function(U){var G,X,K,Z,H,Y=U[0].trace,$=t.select(this),z=Y._hasGauge,j=Y._isAngular,W=Y._isBullet,ee=Y.domain,J={w:N._size.w*(ee.x[1]-ee.x[0]),h:N._size.h*(ee.y[1]-ee.y[0]),l:N._size.l+N._size.w*ee.x[0],r:N._size.r+N._size.w*(1-ee.x[1]),t:N._size.t+N._size.h*(1-ee.y[1]),b:N._size.b+N._size.h*ee.y[0]},Q=J.l+J.w/2,te=J.t+J.h/2,ie=Math.min(J.w/2,J.h),ae=s.innerRadius*ie,he=Y.align||"center";if(X=te,z){if(j&&(G=Q,X=te+ie/2,K=function(xe){return function(ce,ge){var we=Math.sqrt(ce.width/2*(ce.width/2)+ce.height*ce.height);return[ge/we,ce,ge]}(xe,.9*ae)}),W){var se=s.bulletPadding,de=1-s.bulletNumberDomainSize+se;G=J.l+(de+(1-de)*v[he])*J.w,K=function(xe){return S(xe,(s.bulletNumberDomainSize-se)*J.w,J.h)}}}else G=J.l+v[he]*J.w,K=function(xe){return S(xe,J.w,J.h)};(function(xe,ce,ge,we){var Me,Se,ze,Fe=ge[0].trace,Ye=we.numbersX,rt=we.numbersY,Oe=Fe.align||"center",je=y[Oe],We=we.transitionOpts,qe=we.onComplete,et=h.ensureSingle(ce,"g","numbers"),st=[];Fe._hasNumber&&st.push("number"),Fe._hasDelta&&(st.push("delta"),Fe.delta.position==="left"&&st.reverse());var ct=et.selectAll("text").data(st);function Pt(He,Be,Ke,_e){if(!He.match("s")||Ke>=0==_e>=0||Be(Ke).slice(-1).match(b)||Be(_e).slice(-1).match(b))return Be;var Ce=He.slice().replace("s","f").replace(/\d+/,function(Pe){return parseInt(Pe)-1}),Le=A(xe,{tickformat:Ce});return function(Pe){return Math.abs(Pe)<1?c.tickText(Le,Pe).text:Be(Pe)}}ct.enter().append("text"),ct.attr("text-anchor",function(){return je}).attr("class",function(He){return He}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),ct.exit().remove();var kt,at=Fe.mode+Fe.align;if(Fe._hasDelta&&(kt=function(){var He=A(xe,{tickformat:Fe.delta.valueformat},Fe._range);He.setScale(),c.prepTicks(He);var Be=function(Xe){return c.tickText(He,Xe).text},Ke=function(Xe){return Fe.delta.relative?Xe.relativeDelta:Xe.delta},_e=function(Xe,ht){return Xe===0||typeof Xe!="number"||isNaN(Xe)?"-":(Xe>0?Fe.delta.increasing.symbol:Fe.delta.decreasing.symbol)+ht(Xe)},Ce=function(Xe){return Xe.delta>=0?Fe.delta.increasing.color:Fe.delta.decreasing.color};Fe._deltaLastValue===void 0&&(Fe._deltaLastValue=Ke(ge[0]));var Le=et.select("text.delta");function Pe(){Le.text(_e(Ke(ge[0]),Be)).call(p.fill,Ce(ge[0])).call(i.convertToTspans,xe)}return Le.call(u.font,Fe.delta.font).call(p.fill,Ce({delta:Fe._deltaLastValue})),x(We)?Le.transition().duration(We.duration).ease(We.easing).tween("text",function(){var Xe=t.select(this),ht=Ke(ge[0]),Mt=Fe._deltaLastValue,pt=Pt(Fe.delta.valueformat,Be,Mt,ht),Lt=m(Mt,ht);return Fe._deltaLastValue=ht,function(vt){Xe.text(_e(Lt(vt),pt)),Xe.call(p.fill,Ce({delta:Lt(vt)}))}}).each("end",function(){Pe(),qe&&qe()}).each("interrupt",function(){Pe(),qe&&qe()}):Pe(),Se=w(_e(Ke(ge[0]),Be),Fe.delta.font,je,xe),Le}(),at+=Fe.delta.position+Fe.delta.font.size+Fe.delta.font.family+Fe.delta.valueformat,at+=Fe.delta.increasing.symbol+Fe.delta.decreasing.symbol,ze=Se),Fe._hasNumber&&(function(){var He=A(xe,{tickformat:Fe.number.valueformat},Fe._range);He.setScale(),c.prepTicks(He);var Be=function(Pe){return c.tickText(He,Pe).text},Ke=Fe.number.suffix,_e=Fe.number.prefix,Ce=et.select("text.number");function Le(){var Pe=typeof ge[0].y=="number"?_e+Be(ge[0].y)+Ke:"-";Ce.text(Pe).call(u.font,Fe.number.font).call(i.convertToTspans,xe)}x(We)?Ce.transition().duration(We.duration).ease(We.easing).each("end",function(){Le(),qe&&qe()}).each("interrupt",function(){Le(),qe&&qe()}).attrTween("text",function(){var Pe=t.select(this),Xe=m(ge[0].lastY,ge[0].y);Fe._lastValue=ge[0].y;var ht=Pt(Fe.number.valueformat,Be,ge[0].lastY,ge[0].y);return function(Mt){Pe.text(_e+ht(Xe(Mt))+Ke)}}):Le(),Me=w(_e+Be(ge[0].y)+Ke,Fe.number.font,je,xe)}(),at+=Fe.number.font.size+Fe.number.font.family+Fe.number.valueformat+Fe.number.suffix+Fe.number.prefix,ze=Me),Fe._hasDelta&&Fe._hasNumber){var tt,_t,er=[(Me.left+Me.right)/2,(Me.top+Me.bottom)/2],tr=[(Se.left+Se.right)/2,(Se.top+Se.bottom)/2],Ue=.75*Fe.delta.font.size;Fe.delta.position==="left"&&(tt=E(Fe,"deltaPos",0,-1*(Me.width*v[Fe.align]+Se.width*(1-v[Fe.align])+Ue),at,Math.min),_t=er[1]-tr[1],ze={width:Me.width+Se.width+Ue,height:Math.max(Me.height,Se.height),left:Se.left+tt,right:Me.right,top:Math.min(Me.top,Se.top+_t),bottom:Math.max(Me.bottom,Se.bottom+_t)}),Fe.delta.position==="right"&&(tt=E(Fe,"deltaPos",0,Me.width*(1-v[Fe.align])+Se.width*v[Fe.align]+Ue,at,Math.max),_t=er[1]-tr[1],ze={width:Me.width+Se.width+Ue,height:Math.max(Me.height,Se.height),left:Me.left,right:Se.right+tt,top:Math.min(Me.top,Se.top+_t),bottom:Math.max(Me.bottom,Se.bottom+_t)}),Fe.delta.position==="bottom"&&(tt=null,_t=Se.height,ze={width:Math.max(Me.width,Se.width),height:Me.height+Se.height,left:Math.min(Me.left,Se.left),right:Math.max(Me.right,Se.right),top:Me.bottom-Me.height,bottom:Me.bottom+Se.height}),Fe.delta.position==="top"&&(tt=null,_t=Me.top,ze={width:Math.max(Me.width,Se.width),height:Me.height+Se.height,left:Math.min(Me.left,Se.left),right:Math.max(Me.right,Se.right),top:Me.bottom-Me.height-Se.height,bottom:Me.bottom}),kt.attr({dx:tt,dy:_t})}(Fe._hasNumber||Fe._hasDelta)&&et.attr("transform",function(){var He=we.numbersScaler(ze);at+=He[2];var Be,Ke=E(Fe,"numbersScale",1,He[0],at,Math.min);Fe._scaleNumbers||(Ke=1),Be=Fe._isAngular?rt-Ke*ze.bottom:rt-Ke*(ze.top+ze.bottom)/2,Fe._numbersTop=Ke*ze.top+Be;var _e=ze[Oe];Oe==="center"&&(_e=(ze.left+ze.right)/2);var Ce=Ye-Ke*_e;return Ce=E(Fe,"numbersTranslate",0,Ce,at,Math.max),f(Ce,Be)+e(Ke)})})(k,$,U,{numbersX:G,numbersY:X,numbersScaler:K,transitionOpts:M,onComplete:D}),z&&(Z={range:Y.gauge.axis.range,color:Y.gauge.bgcolor,line:{color:Y.gauge.bordercolor,width:0},thickness:1},H={range:Y.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:Y.gauge.bordercolor,width:Y.gauge.borderwidth},thickness:1});var ue=$.selectAll("g.angular").data(j?U:[]);ue.exit().remove();var ve=$.selectAll("g.angularaxis").data(j?U:[]);ve.exit().remove(),j&&function(xe,ce,ge,we){var Me,Se,ze,Fe,Ye=ge[0].trace,rt=we.size,Oe=we.radius,je=we.innerRadius,We=we.gaugeBg,qe=we.gaugeOutline,et=[rt.l+rt.w/2,rt.t+rt.h/2+Oe/2],st=we.gauge,ct=we.layer,Pt=we.transitionOpts,kt=we.onComplete,at=Math.PI/2;function tt(xt){var it=Ye.gauge.axis.range[0],St=(xt-it)/(Ye.gauge.axis.range[1]-it)*Math.PI-at;return St<-at?-at:St>at?at:St}function _t(xt){return t.svg.arc().innerRadius((je+Oe)/2-xt/2*(Oe-je)).outerRadius((je+Oe)/2+xt/2*(Oe-je)).startAngle(-at)}function er(xt){xt.attr("d",function(it){return _t(it.thickness).startAngle(tt(it.range[0])).endAngle(tt(it.range[1]))()})}st.enter().append("g").classed("angular",!0),st.attr("transform",f(et[0],et[1])),ct.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),ct.selectAll("g.xangularaxistick,path,text").remove(),(Me=A(xe,Ye.gauge.axis)).type="linear",Me.range=Ye.gauge.axis.range,Me._id="xangularaxis",Me.ticklabeloverflow="allow",Me.setScale();var tr=function(xt){return(Me.range[0]-xt.x)/(Me.range[1]-Me.range[0])*Math.PI+Math.PI},Ue={},He=c.makeLabelFns(Me,0).labelStandoff;Ue.xFn=function(xt){var it=tr(xt);return Math.cos(it)*He},Ue.yFn=function(xt){var it=tr(xt),St=Math.sin(it)>0?.2:1;return-Math.sin(it)*(He+xt.fontSize*St)+Math.abs(Math.cos(it))*(xt.fontSize*o)},Ue.anchorFn=function(xt){var it=tr(xt),St=Math.cos(it);return Math.abs(St)<.1?"middle":St>0?"start":"end"},Ue.heightFn=function(xt,it,St){var Nt=tr(xt);return-.5*(1+Math.sin(Nt))*St};var Be=function(xt){return f(et[0]+Oe*Math.cos(xt),et[1]-Oe*Math.sin(xt))};if(ze=function(xt){return Be(tr(xt))},Se=c.calcTicks(Me),Fe=c.getTickSigns(Me)[2],Me.visible){Fe=Me.ticks==="inside"?-1:1;var Ke=(Me.linewidth||1)/2;c.drawTicks(xe,Me,{vals:Se,layer:ct,path:"M"+Fe*Ke+",0h"+Fe*Me.ticklen,transFn:function(xt){var it=tr(xt);return Be(it)+"rotate("+-l(it)+")"}}),c.drawLabels(xe,Me,{vals:Se,layer:ct,transFn:ze,labelFns:Ue})}var _e=[We].concat(Ye.gauge.steps),Ce=st.selectAll("g.bg-arc").data(_e);Ce.enter().append("g").classed("bg-arc",!0).append("path"),Ce.select("path").call(er).call(T),Ce.exit().remove();var Le=_t(Ye.gauge.bar.thickness),Pe=st.selectAll("g.value-arc").data([Ye.gauge.bar]);Pe.enter().append("g").classed("value-arc",!0).append("path");var Xe=Pe.select("path");x(Pt)?(Xe.transition().duration(Pt.duration).ease(Pt.easing).each("end",function(){kt&&kt()}).each("interrupt",function(){kt&&kt()}).attrTween("d",(ht=Le,Mt=tt(ge[0].lastY),pt=tt(ge[0].y),function(){var xt=d(Mt,pt);return function(it){return ht.endAngle(xt(it))()}})),Ye._lastValue=ge[0].y):Xe.attr("d",typeof ge[0].y=="number"?Le.endAngle(tt(ge[0].y)):"M0,0Z");var ht,Mt,pt;Xe.call(T),Pe.exit().remove(),_e=[];var Lt=Ye.gauge.threshold.value;(Lt||Lt===0)&&_e.push({range:[Lt,Lt],color:Ye.gauge.threshold.color,line:{color:Ye.gauge.threshold.line.color,width:Ye.gauge.threshold.line.width},thickness:Ye.gauge.threshold.thickness});var vt=st.selectAll("g.threshold-arc").data(_e);vt.enter().append("g").classed("threshold-arc",!0).append("path"),vt.select("path").call(er).call(T),vt.exit().remove();var Dt=st.selectAll("g.gauge-outline").data([qe]);Dt.enter().append("g").classed("gauge-outline",!0).append("path"),Dt.select("path").call(er).call(T),Dt.exit().remove()}(k,0,U,{radius:ie,innerRadius:ae,gauge:ue,layer:ve,size:J,gaugeBg:Z,gaugeOutline:H,transitionOpts:M,onComplete:D});var ke=$.selectAll("g.bullet").data(W?U:[]);ke.exit().remove();var Ee=$.selectAll("g.bulletaxis").data(W?U:[]);Ee.exit().remove(),W&&function(xe,ce,ge,we){var Me,Se,ze,Fe,Ye,rt=ge[0].trace,Oe=we.gauge,je=we.layer,We=we.gaugeBg,qe=we.gaugeOutline,et=we.size,st=rt.domain,ct=we.transitionOpts,Pt=we.onComplete;Oe.enter().append("g").classed("bullet",!0),Oe.attr("transform",f(et.l,et.t)),je.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),je.selectAll("g.xbulletaxistick,path,text").remove();var kt=et.h,at=rt.gauge.bar.thickness*kt,tt=st.x[0],_t=st.x[0]+(st.x[1]-st.x[0])*(rt._hasNumber||rt._hasDelta?1-s.bulletNumberDomainSize:1);(Me=A(xe,rt.gauge.axis))._id="xbulletaxis",Me.domain=[tt,_t],Me.setScale(),Se=c.calcTicks(Me),ze=c.makeTransTickFn(Me),Fe=c.getTickSigns(Me)[2],Ye=et.t+et.h,Me.visible&&(c.drawTicks(xe,Me,{vals:Me.ticks==="inside"?c.clipEnds(Me,Se):Se,layer:je,path:c.makeTickPath(Me,Ye,Fe),transFn:ze}),c.drawLabels(xe,Me,{vals:Se,layer:je,transFn:ze,labelFns:c.makeLabelFns(Me,Ye)}));function er(Ce){Ce.attr("width",function(Le){return Math.max(0,Me.c2p(Le.range[1])-Me.c2p(Le.range[0]))}).attr("x",function(Le){return Me.c2p(Le.range[0])}).attr("y",function(Le){return .5*(1-Le.thickness)*kt}).attr("height",function(Le){return Le.thickness*kt})}var tr=[We].concat(rt.gauge.steps),Ue=Oe.selectAll("g.bg-bullet").data(tr);Ue.enter().append("g").classed("bg-bullet",!0).append("rect"),Ue.select("rect").call(er).call(T),Ue.exit().remove();var He=Oe.selectAll("g.value-bullet").data([rt.gauge.bar]);He.enter().append("g").classed("value-bullet",!0).append("rect"),He.select("rect").attr("height",at).attr("y",(kt-at)/2).call(T),x(ct)?He.select("rect").transition().duration(ct.duration).ease(ct.easing).each("end",function(){Pt&&Pt()}).each("interrupt",function(){Pt&&Pt()}).attr("width",Math.max(0,Me.c2p(Math.min(rt.gauge.axis.range[1],ge[0].y)))):He.select("rect").attr("width",typeof ge[0].y=="number"?Math.max(0,Me.c2p(Math.min(rt.gauge.axis.range[1],ge[0].y))):0),He.exit().remove();var Be=ge.filter(function(){return rt.gauge.threshold.value||rt.gauge.threshold.value===0}),Ke=Oe.selectAll("g.threshold-bullet").data(Be);Ke.enter().append("g").classed("threshold-bullet",!0).append("line"),Ke.select("line").attr("x1",Me.c2p(rt.gauge.threshold.value)).attr("x2",Me.c2p(rt.gauge.threshold.value)).attr("y1",(1-rt.gauge.threshold.thickness)/2*kt).attr("y2",(1-(1-rt.gauge.threshold.thickness)/2)*kt).call(p.stroke,rt.gauge.threshold.line.color).style("stroke-width",rt.gauge.threshold.line.width),Ke.exit().remove();var _e=Oe.selectAll("g.gauge-outline").data([qe]);_e.enter().append("g").classed("gauge-outline",!0).append("rect"),_e.select("rect").call(er).call(T),_e.exit().remove()}(k,0,U,{gauge:ke,layer:Ee,size:J,gaugeBg:Z,gaugeOutline:H,transitionOpts:M,onComplete:D});var be=$.selectAll("text.title").data(U);be.exit().remove(),be.enter().append("text").classed("title",!0),be.attr("text-anchor",function(){return W?y.right:y[Y.title.align]}).text(Y.title.text).call(u.font,Y.title.font).call(i.convertToTspans,k),be.attr("transform",function(){var xe,ce=J.l+J.w*v[Y.title.align],ge=s.titlePadding,we=u.bBox(be.node());return z?(j&&(Y.gauge.axis.visible?xe=u.bBox(ve.node()).top-ge-we.bottom:xe=J.t+J.h/2-ie/2-we.bottom-ge),W&&(xe=X-(we.top+we.bottom)/2,ce=J.l-s.bulletPadding*J.w)):xe=Y._numbersTop-ge-we.bottom,f(ce,xe)})})}},{"../../components/color":650,"../../components/drawing":672,"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../plots/cartesian/axis_defaults":840,"../../plots/cartesian/layout_attributes":853,"../../plots/cartesian/position_defaults":856,"./constants":1134,"@plotly/d3":58,"d3-interpolate":168}],1138:[function(r,I,B){var t=r("../../components/colorscale/attributes"),d=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=r("../../plots/template_attributes").hovertemplateAttrs,h=r("../mesh3d/attributes"),e=r("../../plots/attributes"),f=r("../../lib/extend").extendFlat,l=r("../../plot_api/edit_types").overrideAll,o=I.exports=l(f({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}},caps:{x:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:m(),xhoverformat:d("x"),yhoverformat:d("y"),zhoverformat:d("z"),valuehoverformat:d("value",1),showlegend:f({},e.showlegend,{dflt:!1})},t("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:h.opacity,lightposition:h.lightposition,lighting:h.lighting,flatshading:h.flatshading,contour:h.contour,hoverinfo:f({},e.hoverinfo)}),"calc","nested");o.flatshading.dflt=!0,o.lighting.facenormalsepsilon.dflt=0,o.x.editType=o.y.editType=o.z.editType=o.value.editType="calc+clearAxisTypes",o.transforms=void 0},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../mesh3d/attributes":1143}],1139:[function(r,I,B){var t=r("../../components/colorscale/calc"),d=r("../streamtube/calc").processGrid,m=r("../streamtube/calc").filter;I.exports=function(h,e){e._len=Math.min(e.x.length,e.y.length,e.z.length,e.value.length),e._x=m(e.x,e._len),e._y=m(e.y,e._len),e._z=m(e.z,e._len),e._value=m(e.value,e._len);var f=d(e);e._gridFill=f.fill,e._Xs=f.Xs,e._Ys=f.Ys,e._Zs=f.Zs,e._len=f.len;for(var l=1/0,o=-1/0,u=0;u<e._len;u++){var s=e._value[u];l=Math.min(l,s),o=Math.max(o,s)}e._minValues=l,e._maxValues=o,e._vMin=e.isomin===void 0||e.isomin===null?l:e.isomin,e._vMax=e.isomax===void 0||e.isomin===null?o:e.isomax,t(h,e,{vals:[e._vMin,e._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":658,"../streamtube/calc":1310}],1140:[function(r,I,B){var t=r("gl-mesh3d"),d=r("../../lib/gl_format_color").parseColorScale,m=r("../../lib/str2rgbarray"),h=r("../../components/colorscale").extractOpts,e=r("../../plots/gl3d/zip3"),f=function(i,c){for(var n=c.length-1;n>0;n--){var a=Math.min(c[n],c[n-1]),g=Math.max(c[n],c[n-1]);if(g>a&&a<i&&i<=g)return{id:n,distRatio:(g-i)/(g-a)}}return{id:0,distRatio:0}};function l(i,c,n){this.scene=i,this.uid=n,this.mesh=c,this.name="",this.data=null,this.showContour=!1}var o=l.prototype;o.handlePick=function(i){if(i.object===this.mesh){var c=i.data.index,n=this.data._meshX[c],a=this.data._meshY[c],g=this.data._meshZ[c],p=this.data._Ys.length,y=this.data._Zs.length,v=f(n,this.data._Xs).id,b=f(a,this.data._Ys).id,x=f(g,this.data._Zs).id,T=i.index=x+y*b+y*p*v;i.traceCoordinate=[this.data._meshX[T],this.data._meshY[T],this.data._meshZ[T],this.data._value[T]];var A=this.data.hovertext||this.data.text;return Array.isArray(A)&&A[T]!==void 0?i.textLabel=A[T]:A&&(i.textLabel=A),!0}},o.update=function(i){var c=this.scene,n=c.fullSceneLayout;function a(y,v,b,x){return v.map(function(T){return y.d2l(T,0,x)*b})}this.data=s(i);var g={positions:e(a(n.xaxis,i._meshX,c.dataScale[0],i.xcalendar),a(n.yaxis,i._meshY,c.dataScale[1],i.ycalendar),a(n.zaxis,i._meshZ,c.dataScale[2],i.zcalendar)),cells:e(i._meshI,i._meshJ,i._meshK),lightPosition:[i.lightposition.x,i.lightposition.y,i.lightposition.z],ambient:i.lighting.ambient,diffuse:i.lighting.diffuse,specular:i.lighting.specular,roughness:i.lighting.roughness,fresnel:i.lighting.fresnel,vertexNormalsEpsilon:i.lighting.vertexnormalsepsilon,faceNormalsEpsilon:i.lighting.facenormalsepsilon,opacity:i.opacity,contourEnable:i.contour.show,contourColor:m(i.contour.color).slice(0,3),contourWidth:i.contour.width,useFacetNormals:i.flatshading},p=h(i);g.vertexIntensity=i._meshIntensity,g.vertexIntensityBounds=[p.min,p.max],g.colormap=d(i),this.mesh.update(g)},o.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var u=["xyz","xzy","yxz","yzx","zxy","zyx"];function s(i){i._meshI=[],i._meshJ=[],i._meshK=[];var c,n,a,g,p,y,v,b=i.surface.show,x=i.spaceframe.show,T=i.surface.fill,A=i.spaceframe.fill,S=!1,w=!1,E=0,k=i._Xs,L=i._Ys,M=i._Zs,P=k.length,D=L.length,N=M.length,U=u.indexOf(i._gridFill.replace(/-/g,"").replace(/\+/g,"")),G=function(Oe,je,We){switch(U){case 5:return We+N*je+N*D*Oe;case 4:return We+N*Oe+N*P*je;case 3:return je+D*We+D*N*Oe;case 2:return je+D*Oe+D*P*We;case 1:return Oe+P*We+P*N*je;default:return Oe+P*je+P*D*We}},X=i._minValues,K=i._maxValues,Z=i._vMin,H=i._vMax;function Y(Oe,je,We){for(var qe=y.length,et=n;et<qe;et++)if(Oe===a[et]&&je===g[et]&&We===p[et])return et;return-1}function $(){n=c}function z(){a=[],g=[],p=[],y=[],c=0,$()}function j(Oe,je,We,qe){return a.push(Oe),g.push(je),p.push(We),y.push(qe),++c-1}function W(Oe,je,We){for(var qe=[],et=0;et<Oe.length;et++)qe[et]=Oe[et]*(1-We)+We*je[et];return qe}function ee(Oe){v=Oe}function J(Oe,je){return Oe==="all"||Oe===null||Oe.indexOf(je)>-1}function Q(Oe,je){return Oe===null?je:Oe}function te(Oe,je,We){$();var qe,et,st,ct=[je],Pt=[We];if(v>=1)ct=[je],Pt=[We];else if(v>0){var kt=function(Ke,_e){var Ce=Ke[0],Le=Ke[1],Pe=Ke[2],Xe=function(it,St,Nt){for(var Ut=[],Qt=0;Qt<it.length;Qt++)Ut[Qt]=(it[Qt]+St[Qt]+Nt[Qt])/3;return Ut}(Ce,Le,Pe),ht=Math.sqrt(1-v),Mt=W(Xe,Ce,ht),pt=W(Xe,Le,ht),Lt=W(Xe,Pe,ht),vt=_e[0],Dt=_e[1],xt=_e[2];return{xyzv:[[Ce,Le,pt],[pt,Mt,Ce],[Le,Pe,Lt],[Lt,pt,Le],[Pe,Ce,Mt],[Mt,Lt,Pe]],abc:[[vt,Dt,-1],[-1,-1,vt],[Dt,xt,-1],[-1,-1,Dt],[xt,vt,-1],[-1,-1,xt]]}}(je,We);ct=kt.xyzv,Pt=kt.abc}for(var at=0;at<ct.length;at++){je=ct[at],We=Pt[at];for(var tt=[],_t=0;_t<3;_t++){var er=je[_t][0],tr=je[_t][1],Ue=je[_t][2],He=je[_t][3],Be=We[_t]>-1?We[_t]:Y(er,tr,Ue);tt[_t]=Be>-1?Be:j(er,tr,Ue,Q(Oe,He))}qe=tt[0],et=tt[1],st=tt[2],i._meshI.push(qe),i._meshJ.push(et),i._meshK.push(st),++E}}function ie(Oe,je,We,qe){var et=Oe[3];et<We&&(et=We),et>qe&&(et=qe);for(var st=(Oe[3]-et)/(Oe[3]-je[3]+1e-9),ct=[],Pt=0;Pt<4;Pt++)ct[Pt]=(1-st)*Oe[Pt]+st*je[Pt];return ct}function ae(Oe,je,We){return Oe>=je&&Oe<=We}function he(Oe){var je=.001*(H-Z);return Oe>=Z-je&&Oe<=H+je}function se(Oe){for(var je=[],We=0;We<4;We++){var qe=Oe[We];je.push([i._x[qe],i._y[qe],i._z[qe],i._value[qe]])}return je}function de(Oe,je,We,qe,et,st){st||(st=1),We=[-1,-1,-1];var ct=!1,Pt=[ae(je[0][3],qe,et),ae(je[1][3],qe,et),ae(je[2][3],qe,et)];if(!Pt[0]&&!Pt[1]&&!Pt[2])return!1;var kt=function(tt,_t,er){return he(_t[0][3])&&he(_t[1][3])&&he(_t[2][3])?(te(tt,_t,er),!0):st<3&&de(tt,_t,er,Z,H,++st)};if(Pt[0]&&Pt[1]&&Pt[2])return kt(Oe,je,We)||ct;var at=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(tt){if(Pt[tt[0]]&&Pt[tt[1]]&&!Pt[tt[2]]){var _t=je[tt[0]],er=je[tt[1]],tr=je[tt[2]],Ue=ie(tr,_t,qe,et),He=ie(tr,er,qe,et);ct=kt(Oe,[He,Ue,_t],[-1,-1,We[tt[0]]])||ct,ct=kt(Oe,[_t,er,He],[We[tt[0]],We[tt[1]],-1])||ct,at=!0}}),at||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(tt){if(Pt[tt[0]]&&!Pt[tt[1]]&&!Pt[tt[2]]){var _t=je[tt[0]],er=je[tt[1]],tr=je[tt[2]],Ue=ie(er,_t,qe,et),He=ie(tr,_t,qe,et);ct=kt(Oe,[He,Ue,_t],[-1,-1,We[tt[0]]])||ct,at=!0}}),ct}function ue(Oe,je,We,qe){var et=!1,st=se(je),ct=[ae(st[0][3],We,qe),ae(st[1][3],We,qe),ae(st[2][3],We,qe),ae(st[3][3],We,qe)];if(!(ct[0]||ct[1]||ct[2]||ct[3]))return et;if(ct[0]&&ct[1]&&ct[2]&&ct[3])return w&&(et=function(kt,at,tt){var _t=function(er,tr,Ue){te(kt,[at[er],at[tr],at[Ue]],[tt[er],tt[tr],tt[Ue]])};_t(0,1,2),_t(3,0,1),_t(2,3,0),_t(1,2,3)}(Oe,st,je)||et),et;var Pt=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(kt){if(ct[kt[0]]&&ct[kt[1]]&&ct[kt[2]]&&!ct[kt[3]]){var at=st[kt[0]],tt=st[kt[1]],_t=st[kt[2]],er=st[kt[3]];if(w)et=te(Oe,[at,tt,_t],[je[kt[0]],je[kt[1]],je[kt[2]]])||et;else{var tr=ie(er,at,We,qe),Ue=ie(er,tt,We,qe),He=ie(er,_t,We,qe);et=te(null,[tr,Ue,He],[-1,-1,-1])||et}Pt=!0}}),Pt||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(kt){if(ct[kt[0]]&&ct[kt[1]]&&!ct[kt[2]]&&!ct[kt[3]]){var at=st[kt[0]],tt=st[kt[1]],_t=st[kt[2]],er=st[kt[3]],tr=ie(_t,at,We,qe),Ue=ie(_t,tt,We,qe),He=ie(er,tt,We,qe),Be=ie(er,at,We,qe);w?(et=te(Oe,[at,Be,tr],[je[kt[0]],-1,-1])||et,et=te(Oe,[tt,Ue,He],[je[kt[1]],-1,-1])||et):et=function(Ke,_e,Ce){var Le=function(Pe,Xe,ht){te(Ke,[_e[Pe],_e[Xe],_e[ht]],[Ce[Pe],Ce[Xe],Ce[ht]])};Le(0,1,2),Le(2,3,0)}(null,[tr,Ue,He,Be],[-1,-1,-1,-1])||et,Pt=!0}}),Pt||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(kt){if(ct[kt[0]]&&!ct[kt[1]]&&!ct[kt[2]]&&!ct[kt[3]]){var at=st[kt[0]],tt=st[kt[1]],_t=st[kt[2]],er=st[kt[3]],tr=ie(tt,at,We,qe),Ue=ie(_t,at,We,qe),He=ie(er,at,We,qe);w?(et=te(Oe,[at,tr,Ue],[je[kt[0]],-1,-1])||et,et=te(Oe,[at,Ue,He],[je[kt[0]],-1,-1])||et,et=te(Oe,[at,He,tr],[je[kt[0]],-1,-1])||et):et=te(null,[tr,Ue,He],[-1,-1,-1])||et,Pt=!0}})),et}function ve(Oe,je,We,qe,et,st,ct,Pt,kt,at,tt){var _t=!1;return S&&(J(Oe,"A")&&(_t=ue(null,[je,We,qe,st],at,tt)||_t),J(Oe,"B")&&(_t=ue(null,[We,qe,et,kt],at,tt)||_t),J(Oe,"C")&&(_t=ue(null,[We,st,ct,kt],at,tt)||_t),J(Oe,"D")&&(_t=ue(null,[qe,st,Pt,kt],at,tt)||_t),J(Oe,"E")&&(_t=ue(null,[We,qe,st,kt],at,tt)||_t)),w&&(_t=ue(Oe,[We,qe,st,kt],at,tt)||_t),_t}function ke(Oe,je,We,qe,et,st,ct,Pt){return[Pt[0]===!0||de(Oe,se([je,We,qe]),[je,We,qe],st,ct),Pt[1]===!0||de(Oe,se([qe,et,je]),[qe,et,je],st,ct)]}function Ee(Oe,je,We,qe,et,st,ct,Pt,kt){return Pt?ke(Oe,je,We,et,qe,st,ct,kt):ke(Oe,We,et,qe,je,st,ct,kt)}function be(Oe,je,We,qe,et,st,ct){var Pt,kt,at,tt,_t=!1,er=function(){_t=de(Oe,[Pt,kt,at],[-1,-1,-1],et,st)||_t,_t=de(Oe,[at,tt,Pt],[-1,-1,-1],et,st)||_t},tr=ct[0],Ue=ct[1],He=ct[2];return tr&&(Pt=W(se([G(je,We-0,qe-0)])[0],se([G(je-1,We-0,qe-0)])[0],tr),kt=W(se([G(je,We-0,qe-1)])[0],se([G(je-1,We-0,qe-1)])[0],tr),at=W(se([G(je,We-1,qe-1)])[0],se([G(je-1,We-1,qe-1)])[0],tr),tt=W(se([G(je,We-1,qe-0)])[0],se([G(je-1,We-1,qe-0)])[0],tr),er()),Ue&&(Pt=W(se([G(je-0,We,qe-0)])[0],se([G(je-0,We-1,qe-0)])[0],Ue),kt=W(se([G(je-0,We,qe-1)])[0],se([G(je-0,We-1,qe-1)])[0],Ue),at=W(se([G(je-1,We,qe-1)])[0],se([G(je-1,We-1,qe-1)])[0],Ue),tt=W(se([G(je-1,We,qe-0)])[0],se([G(je-1,We-1,qe-0)])[0],Ue),er()),He&&(Pt=W(se([G(je-0,We-0,qe)])[0],se([G(je-0,We-0,qe-1)])[0],He),kt=W(se([G(je-0,We-1,qe)])[0],se([G(je-0,We-1,qe-1)])[0],He),at=W(se([G(je-1,We-1,qe)])[0],se([G(je-1,We-1,qe-1)])[0],He),tt=W(se([G(je-1,We-0,qe)])[0],se([G(je-1,We-0,qe-1)])[0],He),er()),_t}function xe(Oe,je,We,qe,et,st,ct,Pt,kt,at,tt,_t){var er=Oe;return _t?(S&&Oe==="even"&&(er=null),ve(er,je,We,qe,et,st,ct,Pt,kt,at,tt)):(S&&Oe==="odd"&&(er=null),ve(er,kt,Pt,ct,st,et,qe,We,je,at,tt))}function ce(Oe,je,We,qe,et){for(var st=[],ct=0,Pt=0;Pt<je.length;Pt++)for(var kt=je[Pt],at=1;at<N;at++)for(var tt=1;tt<D;tt++)st.push(Ee(Oe,G(kt,tt-1,at-1),G(kt,tt-1,at),G(kt,tt,at-1),G(kt,tt,at),We,qe,(kt+tt+at)%2,et&&et[ct]?et[ct]:[])),ct++;return st}function ge(Oe,je,We,qe,et){for(var st=[],ct=0,Pt=0;Pt<je.length;Pt++)for(var kt=je[Pt],at=1;at<P;at++)for(var tt=1;tt<N;tt++)st.push(Ee(Oe,G(at-1,kt,tt-1),G(at,kt,tt-1),G(at-1,kt,tt),G(at,kt,tt),We,qe,(at+kt+tt)%2,et&&et[ct]?et[ct]:[])),ct++;return st}function we(Oe,je,We,qe,et){for(var st=[],ct=0,Pt=0;Pt<je.length;Pt++)for(var kt=je[Pt],at=1;at<D;at++)for(var tt=1;tt<P;tt++)st.push(Ee(Oe,G(tt-1,at-1,kt),G(tt-1,at,kt),G(tt,at-1,kt),G(tt,at,kt),We,qe,(tt+at+kt)%2,et&&et[ct]?et[ct]:[])),ct++;return st}function Me(Oe,je,We){for(var qe=1;qe<N;qe++)for(var et=1;et<D;et++)for(var st=1;st<P;st++)xe(Oe,G(st-1,et-1,qe-1),G(st-1,et-1,qe),G(st-1,et,qe-1),G(st-1,et,qe),G(st,et-1,qe-1),G(st,et-1,qe),G(st,et,qe-1),G(st,et,qe),je,We,(st+et+qe)%2)}function Se(Oe,je,We){S=!0,Me(Oe,je,We),S=!1}function ze(Oe,je,We,qe,et,st){for(var ct=[],Pt=0,kt=0;kt<je.length;kt++)for(var at=je[kt],tt=1;tt<N;tt++)for(var _t=1;_t<D;_t++)ct.push(be(Oe,at,_t,tt,We,qe,et[kt],st&&st[Pt]&&st[Pt])),Pt++;return ct}function Fe(Oe,je,We,qe,et,st){for(var ct=[],Pt=0,kt=0;kt<je.length;kt++)for(var at=je[kt],tt=1;tt<P;tt++)for(var _t=1;_t<N;_t++)ct.push(be(Oe,tt,at,_t,We,qe,et[kt],st&&st[Pt]&&st[Pt])),Pt++;return ct}function Ye(Oe,je,We,qe,et,st){for(var ct=[],Pt=0,kt=0;kt<je.length;kt++)for(var at=je[kt],tt=1;tt<D;tt++)for(var _t=1;_t<P;_t++)ct.push(be(Oe,_t,tt,at,We,qe,et[kt],st&&st[Pt]&&st[Pt])),Pt++;return ct}function rt(Oe,je){for(var We=[],qe=Oe;qe<je;qe++)We.push(qe);return We}return function(){if(z(),function(){for(var Pt=0;Pt<P;Pt++)for(var kt=0;kt<D;kt++)for(var at=0;at<N;at++){var tt=G(Pt,kt,at);j(i._x[tt],i._y[tt],i._z[tt],i._value[tt])}}(),x&&A&&(ee(A),w=!0,Me(null,Z,H),w=!1),b&&T){ee(T);for(var Oe=i.surface.pattern,je=i.surface.count,We=0;We<je;We++){var qe=je===1?.5:We/(je-1),et=(1-qe)*Z+qe*H,st=Math.abs(et-X)>Math.abs(et-K)?[X,et]:[et,K];Se(Oe,st[0],st[1])}}var ct=[[Math.min(Z,K),Math.max(Z,K)],[Math.min(X,H),Math.max(X,H)]];["x","y","z"].forEach(function(Pt){for(var kt=[],at=0;at<ct.length;at++){var tt=0,_t=ct[at][0],er=ct[at][1],tr=i.slices[Pt];if(tr.show&&tr.fill){ee(tr.fill);var Ue=[],He=[],Be=[];if(tr.locations.length)for(var Ke=0;Ke<tr.locations.length;Ke++){var _e=f(tr.locations[Ke],Pt==="x"?k:Pt==="y"?L:M);_e.distRatio===0?Ue.push(_e.id):_e.id>0&&(He.push(_e.id),Pt==="x"?Be.push([_e.distRatio,0,0]):Pt==="y"?Be.push([0,_e.distRatio,0]):Be.push([0,0,_e.distRatio]))}else Ue=rt(1,Pt==="x"?P-1:Pt==="y"?D-1:N-1);He.length>0&&(kt[tt]=Pt==="x"?ze(null,He,_t,er,Be,kt[tt]):Pt==="y"?Fe(null,He,_t,er,Be,kt[tt]):Ye(null,He,_t,er,Be,kt[tt]),tt++),Ue.length>0&&(kt[tt]=Pt==="x"?ce(null,Ue,_t,er,kt[tt]):Pt==="y"?ge(null,Ue,_t,er,kt[tt]):we(null,Ue,_t,er,kt[tt]),tt++)}var Ce=i.caps[Pt];Ce.show&&Ce.fill&&(ee(Ce.fill),kt[tt]=Pt==="x"?ce(null,[0,P-1],_t,er,kt[tt]):Pt==="y"?ge(null,[0,D-1],_t,er,kt[tt]):we(null,[0,N-1],_t,er,kt[tt]),tt++)}}),E===0&&z(),i._meshX=a,i._meshY=g,i._meshZ=p,i._meshIntensity=y,i._Xs=k,i._Ys=L,i._Zs=M}(),i}I.exports={findNearestOnAxis:f,generateIsoMeshes:s,createIsosurfaceTrace:function(i,c){var n=i.glplot.gl,a=t({gl:n}),g=new l(i,a,c.uid);return a._trace=g,g.update(c),i.glplot.add(a),g}}},{"../../components/colorscale":662,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../../plots/gl3d/zip3":891,"gl-mesh3d":309}],1141:[function(r,I,B){var t=r("../../lib"),d=r("../../registry"),m=r("./attributes"),h=r("../../components/colorscale/defaults");function e(f,l,o,u,s){var i=s("isomin"),c=s("isomax");c!=null&&i!=null&&i>c&&(l.isomin=null,l.isomax=null);var n=s("x"),a=s("y"),g=s("z"),p=s("value");n&&n.length&&a&&a.length&&g&&g.length&&p&&p.length?(d.getComponentMethod("calendars","handleTraceDefaults")(f,l,["x","y","z"],u),s("valuehoverformat"),["x","y","z"].forEach(function(y){s(y+"hoverformat");var v="caps."+y;s(v+".show")&&s(v+".fill");var b="slices."+y;s(b+".show")&&(s(b+".fill"),s(b+".locations"))}),s("spaceframe.show")&&s("spaceframe.fill"),s("surface.show")&&(s("surface.count"),s("surface.fill"),s("surface.pattern")),s("contour.show")&&(s("contour.color"),s("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(y){s(y)}),h(f,l,u,s,{prefix:"",cLetter:"c"}),l._length=null):l.visible=!1}I.exports={supplyDefaults:function(f,l,o,u){e(f,l,o,u,function(s,i){return t.coerce(f,l,m,s,i)})},supplyIsoDefaults:e}},{"../../components/colorscale/defaults":660,"../../lib":787,"../../registry":915,"./attributes":1138}],1142:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults").supplyDefaults,calc:r("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:r("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":880,"./attributes":1138,"./calc":1139,"./convert":1140,"./defaults":1141}],1143:[function(r,I,B){var t=r("../../components/colorscale/attributes"),d=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=r("../../plots/template_attributes").hovertemplateAttrs,h=r("../surface/attributes"),e=r("../../plots/attributes"),f=r("../../lib/extend").extendFlat;I.exports=f({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:m({editType:"calc"}),xhoverformat:d("x"),yhoverformat:d("y"),zhoverformat:d("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},t("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:h.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:f({},h.contours.x.show,{}),color:h.contours.x.color,width:h.contours.x.width,editType:"calc"},lightposition:{x:f({},h.lightposition.x,{dflt:1e5}),y:f({},h.lightposition.y,{dflt:1e5}),z:f({},h.lightposition.z,{dflt:0}),editType:"calc"},lighting:f({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},h.lighting),hoverinfo:f({},e.hoverinfo,{editType:"calc"}),showlegend:f({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../surface/attributes":1326}],1144:[function(r,I,B){var t=r("../../components/colorscale/calc");I.exports=function(d,m){m.intensity&&t(d,m,{vals:m.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":658}],1145:[function(r,I,B){var t=r("gl-mesh3d"),d=r("delaunay-triangulate"),m=r("alpha-shape"),h=r("convex-hull"),e=r("../../lib/gl_format_color").parseColorScale,f=r("../../lib/str2rgbarray"),l=r("../../components/colorscale").extractOpts,o=r("../../plots/gl3d/zip3");function u(g,p,y){this.scene=g,this.uid=y,this.mesh=p,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var s=u.prototype;function i(g){for(var p=[],y=g.length,v=0;v<y;v++)p[v]=f(g[v]);return p}function c(g,p,y,v){for(var b=[],x=p.length,T=0;T<x;T++)b[T]=g.d2l(p[T],0,v)*y;return b}function n(g){for(var p=[],y=g.length,v=0;v<y;v++)p[v]=Math.round(g[v]);return p}function a(g,p){for(var y=g.length,v=0;v<y;v++)if(g[v]<=-.5||g[v]>=p-.5)return!1;return!0}s.handlePick=function(g){if(g.object===this.mesh){var p=g.index=g.data.index;g.data._cellCenter?g.traceCoordinate=g.data.dataCoordinate:g.traceCoordinate=[this.data.x[p],this.data.y[p],this.data.z[p]];var y=this.data.hovertext||this.data.text;return Array.isArray(y)&&y[p]!==void 0?g.textLabel=y[p]:y&&(g.textLabel=y),!0}},s.update=function(g){var p=this.scene,y=p.fullSceneLayout;this.data=g;var v,b=g.x.length,x=o(c(y.xaxis,g.x,p.dataScale[0],g.xcalendar),c(y.yaxis,g.y,p.dataScale[1],g.ycalendar),c(y.zaxis,g.z,p.dataScale[2],g.zcalendar));if(g.i&&g.j&&g.k){if(g.i.length!==g.j.length||g.j.length!==g.k.length||!a(g.i,b)||!a(g.j,b)||!a(g.k,b))return;v=o(n(g.i),n(g.j),n(g.k))}else v=g.alphahull===0?h(x):g.alphahull>0?m(g.alphahull,x):function(w,E){for(var k=["x","y","z"].indexOf(w),L=[],M=E.length,P=0;P<M;P++)L[P]=[E[P][(k+1)%3],E[P][(k+2)%3]];return d(L)}(g.delaunayaxis,x);var T={positions:x,cells:v,lightPosition:[g.lightposition.x,g.lightposition.y,g.lightposition.z],ambient:g.lighting.ambient,diffuse:g.lighting.diffuse,specular:g.lighting.specular,roughness:g.lighting.roughness,fresnel:g.lighting.fresnel,vertexNormalsEpsilon:g.lighting.vertexnormalsepsilon,faceNormalsEpsilon:g.lighting.facenormalsepsilon,opacity:g.opacity,contourEnable:g.contour.show,contourColor:f(g.contour.color).slice(0,3),contourWidth:g.contour.width,useFacetNormals:g.flatshading};if(g.intensity){var A=l(g);this.color="#fff";var S=g.intensitymode;T[S+"Intensity"]=g.intensity,T[S+"IntensityBounds"]=[A.min,A.max],T.colormap=e(g)}else g.vertexcolor?(this.color=g.vertexcolor[0],T.vertexColors=i(g.vertexcolor)):g.facecolor?(this.color=g.facecolor[0],T.cellColors=i(g.facecolor)):(this.color=g.color,T.meshColor=f(g.color));this.mesh.update(T)},s.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},I.exports=function(g,p){var y=g.glplot.gl,v=t({gl:y}),b=new u(g,v,p.uid);return v._trace=b,b.update(p),g.glplot.add(v),b}},{"../../components/colorscale":662,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../../plots/gl3d/zip3":891,"alpha-shape":75,"convex-hull":141,"delaunay-triangulate":177,"gl-mesh3d":309}],1146:[function(r,I,B){var t=r("../../registry"),d=r("../../lib"),m=r("../../components/colorscale/defaults"),h=r("./attributes");I.exports=function(e,f,l,o){function u(i,c){return d.coerce(e,f,h,i,c)}function s(i){var c=i.map(function(n){var a=u(n);return a&&d.isArrayOrTypedArray(a)?a:null});return c.every(function(n){return n&&n.length===c[0].length})&&c}s(["x","y","z"])?(s(["i","j","k"]),(!f.i||f.j&&f.k)&&(!f.j||f.k&&f.i)&&(!f.k||f.i&&f.j)?(t.getComponentMethod("calendars","handleTraceDefaults")(e,f,["x","y","z"],o),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(i){u(i)}),u("contour.show")&&(u("contour.color"),u("contour.width")),"intensity"in e?(u("intensity"),u("intensitymode"),m(e,f,o,u,{prefix:"",cLetter:"c"})):(f.showscale=!1,"facecolor"in e?u("facecolor"):"vertexcolor"in e?u("vertexcolor"):u("color",l)),u("text"),u("hovertext"),u("hovertemplate"),u("xhoverformat"),u("yhoverformat"),u("zhoverformat"),f._length=null):f.visible=!1):f.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"../../registry":915,"./attributes":1143}],1147:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:r("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":880,"./attributes":1143,"./calc":1144,"./convert":1145,"./defaults":1146}],1148:[function(r,I,B){var t=r("../../lib").extendFlat,d=r("../scatter/attributes"),m=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,h=r("../../components/drawing/attributes").dash,e=r("../../components/fx/attributes"),f=r("../../constants/delta.js"),l=f.INCREASING.COLOR,o=f.DECREASING.COLOR,u=d.line;function s(i){return{line:{color:t({},u.color,{dflt:i}),width:u.width,dash:h,editType:"style"},editType:"style"}}I.exports={xperiod:d.xperiod,xperiod0:d.xperiod0,xperiodalignment:d.xperiodalignment,xhoverformat:m("x"),yhoverformat:m("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:t({},u.width,{}),dash:t({},h,{}),editType:"style"},increasing:s(l),decreasing:s(o),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:t({},e.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":671,"../../components/fx/attributes":681,"../../constants/delta.js":757,"../../lib":787,"../../plots/cartesian/axis_format_attributes":841,"../scatter/attributes":1202}],1149:[function(r,I,B){var t=r("../../lib"),d=t._,m=r("../../plots/cartesian/axes"),h=r("../../plots/cartesian/align_period"),e=r("../../constants/numerical").BADNUM;function f(o,u,s,i){return{o,h:u,l:s,c:i}}function l(o,u,s,i,c,n){for(var a=c.makeCalcdata(u,"open"),g=c.makeCalcdata(u,"high"),p=c.makeCalcdata(u,"low"),y=c.makeCalcdata(u,"close"),v=Array.isArray(u.text),b=Array.isArray(u.hovertext),x=!0,T=null,A=!!u.xperiodalignment,S=[],w=0;w<i.length;w++){var E=i[w],k=a[w],L=g[w],M=p[w],P=y[w];if(E!==e&&k!==e&&L!==e&&M!==e&&P!==e){P===k?T!==null&&P!==T&&(x=P>T):x=P>k,T=P;var D=n(k,L,M,P);D.pos=E,D.yc=(k+P)/2,D.i=w,D.dir=x?"increasing":"decreasing",D.x=D.pos,D.y=[M,L],A&&(D.orig_p=s[w]),v&&(D.tx=u.text[w]),b&&(D.htx=u.hovertext[w]),S.push(D)}else S.push({pos:E,empty:!0})}return u._extremes[c._id]=m.findExtremes(c,t.concat(p,g),{padded:!0}),S.length&&(S[0].t={labels:{open:d(o,"open:")+" ",high:d(o,"high:")+" ",low:d(o,"low:")+" ",close:d(o,"close:")+" "}}),S}I.exports={calc:function(o,u){var s=m.getFromId(o,u.xaxis),i=m.getFromId(o,u.yaxis),c=function(y,v,b){var x=b._minDiff;if(!x){var T,A=y._fullData,S=[];for(x=1/0,T=0;T<A.length;T++){var w=A[T];if(w.type==="ohlc"&&w.visible===!0&&w.xaxis===v._id){S.push(w);var E=v.makeCalcdata(w,"x");w._origX=E;var k=h(b,v,"x",E).vals;w._xcalc=k;var L=t.distinctVals(k).minDiff;L&&isFinite(L)&&(x=Math.min(x,L))}}for(x===1/0&&(x=1),T=0;T<S.length;T++)S[T]._minDiff=x}return x*b.tickwidth}(o,s,u),n=u._minDiff;u._minDiff=null;var a=u._origX;u._origX=null;var g=u._xcalc;u._xcalc=null;var p=l(o,u,a,g,i,f);return u._extremes[s._id]=m.findExtremes(s,g,{vpad:n/2}),p.length?(t.extendFlat(p[0].t,{wHover:n/2,tickLen:c}),p):[{t:{empty:!0}}]},calcCommon:l}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838}],1150:[function(r,I,B){var t=r("../../lib"),d=r("./ohlc_defaults"),m=r("../scatter/period_defaults"),h=r("./attributes");function e(f,l,o,u){o(u+".line.color"),o(u+".line.width",l.line.width),o(u+".line.dash",l.line.dash)}I.exports=function(f,l,o,u){function s(i,c){return t.coerce(f,l,h,i,c)}d(f,l,s,u)?(m(f,l,u,s,{x:!0}),s("xhoverformat"),s("yhoverformat"),s("line.width"),s("line.dash"),e(f,l,s,"increasing"),e(f,l,s,"decreasing"),s("text"),s("hovertext"),s("tickwidth"),u._requestRangeslider[l.xaxis]=!0):l.visible=!1}},{"../../lib":787,"../scatter/period_defaults":1222,"./attributes":1148,"./ohlc_defaults":1153}],1151:[function(r,I,B){var t=r("../../plots/cartesian/axes"),d=r("../../lib"),m=r("../../components/fx"),h=r("../../components/color"),e=r("../../lib").fillText,f=r("../../constants/delta.js"),l={increasing:f.INCREASING.SYMBOL,decreasing:f.DECREASING.SYMBOL};function o(i,c,n,a){var g,p,y=i.cd,v=i.xa,b=y[0].trace,x=y[0].t,T=b.type,A=T==="ohlc"?"l":"min",S=T==="ohlc"?"h":"max",w=x.bPos||0,E=x.bdPos||x.tickLen,k=x.wHover,L=Math.min(1,E/Math.abs(v.r2c(v.range[1])-v.r2c(v.range[0])));function M(K){var Z=function(H){return H.pos+w-c}(K);return m.inbox(Z-k,Z+k,g)}function P(K){var Z=K[A],H=K[S];return Z===H||m.inbox(Z-n,H-n,g)}function D(K){return(M(K)+P(K))/2}g=i.maxHoverDistance-L,p=i.maxSpikeDistance-L;var N=m.getDistanceFunction(a,M,P,D);if(m.getClosest(y,N,i),i.index===!1)return null;var U=y[i.index];if(U.empty)return null;var G=b[U.dir],X=G.line.color;return h.opacity(X)&&G.line.width?i.color=X:i.color=G.fillcolor,i.x0=v.c2p(U.pos+w-E,!0),i.x1=v.c2p(U.pos+w+E,!0),i.xLabelVal=U.orig_p!==void 0?U.orig_p:U.pos,i.spikeDistance=D(U)*p/g,i.xSpike=v.c2p(U.pos,!0),i}function u(i,c,n,a){var g=i.cd,p=i.ya,y=g[0].trace,v=g[0].t,b=[],x=o(i,c,n,a);if(!x)return[];var T=g[x.index].hi||y.hoverinfo,A=T.split("+");if(!(T==="all"||A.indexOf("y")!==-1))return[];for(var S=["high","open","close","low"],w={},E=0;E<S.length;E++){var k,L=S[E],M=y[L][x.index],P=p.c2p(M,!0);M in w?(k=w[M]).yLabel+="<br>"+v.labels[L]+t.hoverLabelText(p,M,y.yhoverformat):((k=d.extendFlat({},x)).y0=k.y1=P,k.yLabelVal=M,k.yLabel=v.labels[L]+t.hoverLabelText(p,M,y.yhoverformat),k.name="",b.push(k),w[M]=k)}return b}function s(i,c,n,a){var g=i.cd,p=i.ya,y=g[0].trace,v=g[0].t,b=o(i,c,n,a);if(!b)return[];var x=g[b.index],T=b.index=x.i,A=x.dir;function S(D){return v.labels[D]+t.hoverLabelText(p,y[D][T],y.yhoverformat)}var w=x.hi||y.hoverinfo,E=w.split("+"),k=w==="all",L=k||E.indexOf("y")!==-1,M=k||E.indexOf("text")!==-1,P=L?[S("open"),S("high"),S("low"),S("close")+"  "+l[A]]:[];return M&&e(x,y,P),b.extraText=P.join("<br>"),b.y0=b.y1=p.c2p(x.yc,!0),[b]}I.exports={hoverPoints:function(i,c,n,a){return i.cd[0].trace.hoverlabel.split?u(i,c,n,a):s(i,c,n,a)},hoverSplit:u,hoverOnPoints:s}},{"../../components/color":650,"../../components/fx":690,"../../constants/delta.js":757,"../../lib":787,"../../plots/cartesian/axes":838}],1152:[function(r,I,B){I.exports={moduleType:"trace",name:"ohlc",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc").calc,plot:r("./plot"),style:r("./style"),hoverPoints:r("./hover").hoverPoints,selectPoints:r("./select")}},{"../../plots/cartesian":852,"./attributes":1148,"./calc":1149,"./defaults":1150,"./hover":1151,"./plot":1154,"./select":1155,"./style":1156}],1153:[function(r,I,B){var t=r("../../registry"),d=r("../../lib");I.exports=function(m,h,e,f){var l=e("x"),o=e("open"),u=e("high"),s=e("low"),i=e("close");if(e("hoverlabel.split"),t.getComponentMethod("calendars","handleTraceDefaults")(m,h,["x"],f),o&&u&&s&&i){var c=Math.min(o.length,u.length,s.length,i.length);return l&&(c=Math.min(c,d.minRowLength(l))),h._length=c,c}}},{"../../lib":787,"../../registry":915}],1154:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib");I.exports=function(m,h,e,f){var l=h.yaxis,o=h.xaxis,u=!!o.rangebreaks;d.makeTraceGroups(f,e,"trace ohlc").each(function(s){var i=t.select(this),c=s[0],n=c.t;if(c.trace.visible!==!0||n.empty)i.remove();else{var a=n.tickLen,g=i.selectAll("path").data(d.identity);g.enter().append("path"),g.exit().remove(),g.attr("d",function(p){if(p.empty)return"M0,0Z";var y=o.c2p(p.pos-a,!0),v=o.c2p(p.pos+a,!0),b=u?(y+v)/2:o.c2p(p.pos,!0);return"M"+y+","+l.c2p(p.o,!0)+"H"+b+"M"+b+","+l.c2p(p.h,!0)+"V"+l.c2p(p.l,!0)+"M"+v+","+l.c2p(p.c,!0)+"H"+b})}})}},{"../../lib":787,"@plotly/d3":58}],1155:[function(r,I,B){I.exports=function(t,d){var m,h=t.cd,e=t.xaxis,f=t.yaxis,l=[],o=h[0].t.bPos||0;if(d===!1)for(m=0;m<h.length;m++)h[m].selected=0;else for(m=0;m<h.length;m++){var u=h[m];d.contains([e.c2p(u.pos+o),f.c2p(u.yc)],null,u.i,t)?(l.push({pointNumber:u.i,x:e.c2d(u.pos),y:f.c2d(u.yc)}),u.selected=1):u.selected=0}return l}},{}],1156:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/drawing"),m=r("../../components/color");I.exports=function(h,e,f){var l=f||t.select(h).selectAll("g.ohlclayer").selectAll("g.trace");l.style("opacity",function(o){return o[0].trace.opacity}),l.each(function(o){var u=o[0].trace;t.select(this).selectAll("path").each(function(s){if(!s.empty){var i=u[s.dir].line;t.select(this).style("fill","none").call(m.stroke,i.color).call(d.dashLine,i.dash,i.width).style("opacity",u.selectedpoints&&!s.selected?.3:1)}})})}},{"../../components/color":650,"../../components/drawing":672,"@plotly/d3":58}],1157:[function(r,I,B){var t=r("../../lib/extend").extendFlat,d=r("../../plots/attributes"),m=r("../../plots/font_attributes"),h=r("../../components/colorscale/attributes"),e=r("../../plots/template_attributes").hovertemplateAttrs,f=r("../../plots/domain").attributes,l=t({editType:"calc"},h("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});I.exports={domain:f({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:t({},d.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:m({editType:"calc"}),tickfont:m({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:l,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/domain":866,"../../plots/font_attributes":867,"../../plots/template_attributes":910}],1158:[function(r,I,B){var t=r("../../plots/get_data").getModuleCalcData,d=r("./plot");B.name="parcats",B.plot=function(m,h,e,f){var l=t(m.calcdata,"parcats");if(l.length){var o=l[0];d(m,o,e,f)}},B.clean=function(m,h,e,f){var l=f._has&&f._has("parcats"),o=h._has&&h._has("parcats");l&&!o&&f._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":875,"./plot":1163}],1159:[function(r,I,B){var t=r("../../lib/gup").wrap,d=r("../../components/colorscale/helpers").hasColorscale,m=r("../../components/colorscale/calc"),h=r("../../lib/filter_unique.js"),e=r("../../components/drawing"),f=r("../../lib"),l=r("fast-isnumeric");function o(i,c,n){i.valueInds.push(c),i.count+=n}function u(i,c,n){return{categoryInds:i,color:c,rawColor:n,valueInds:[],count:0}}function s(i,c,n){i.valueInds.push(c),i.count+=n}I.exports=function(i,c){var n=f.filterVisible(c.dimensions);if(n.length===0)return[];var a,g,p,y=n.map(function(Y){var $;if(Y.categoryorder==="trace")$=null;else if(Y.categoryorder==="array")$=Y.categoryarray;else{$=h(Y.values);for(var z=!0,j=0;j<$.length;j++)if(!l($[j])){z=!1;break}$.sort(z?f.sorterAsc:void 0),Y.categoryorder==="category descending"&&($=$.reverse())}return function(W,ee){ee=ee==null?[]:ee.map(function(de){return de});var J={},Q={},te=[];ee.forEach(function(de,ue){J[de]=0,Q[de]=ue});for(var ie=0;ie<W.length;ie++){var ae,he=W[ie];J[he]===void 0?(J[he]=1,ae=ee.push(he)-1,Q[he]=ae):(J[he]++,ae=Q[he]),te.push(ae)}var se=ee.map(function(de){return J[de]});return{uniqueValues:ee,uniqueCounts:se,inds:te}}(Y.values,$)});a=f.isArrayOrTypedArray(c.counts)?c.counts:[c.counts],function(Y){var $;if(function(z){for(var j=new Array(z.length),W=0;W<z.length;W++){if(z[W]<0||z[W]>=z.length||j[z[W]]!==void 0)return!1;j[z[W]]=!0}return!0}(Y.map(function(z){return z.displayindex})))for($=0;$<Y.length;$++)Y[$]._displayindex=Y[$].displayindex;else for($=0;$<Y.length;$++)Y[$]._displayindex=$}(n),n.forEach(function(Y,$){(function(z,j){z._categoryarray=j.uniqueValues,z.ticktext===null||z.ticktext===void 0?z._ticktext=[]:z._ticktext=z.ticktext.slice();for(var W=z._ticktext.length;W<j.uniqueValues.length;W++)z._ticktext.push(j.uniqueValues[W])})(Y,y[$])});var v,b=c.line;b?(d(c,"line")&&m(i,c,{vals:c.line.color,containerStr:"line",cLetter:"c"}),v=e.tryColorscale(b)):v=f.identity;var x,T,A,S,w,E=n[0].values.length,k={},L=y.map(function(Y){return Y.inds});for(p=0,x=0;x<E;x++){var M=[];for(T=0;T<L.length;T++)M.push(L[T][x]);g=a[x%a.length],p+=g;var P=(A=x,S=void 0,w=void 0,f.isArrayOrTypedArray(b.color)?w=S=b.color[A%b.color.length]:S=b.color,{color:v(S),rawColor:w}),D=M+"-"+P.rawColor;k[D]===void 0&&(k[D]=u(M,P.color,P.rawColor)),s(k[D],x,g)}var N,U=n.map(function(Y,$){return function(z,j,W,ee,J){return{dimensionInd:z,containerInd:j,displayInd:W,dimensionLabel:ee,count:J,categories:[],dragX:null}}($,Y._index,Y._displayindex,Y.label,p)});for(x=0;x<E;x++)for(g=a[x%a.length],T=0;T<U.length;T++){var G=U[T].containerInd,X=y[T].inds[x],K=U[T].categories;if(K[X]===void 0){var Z=c.dimensions[G]._categoryarray[X],H=c.dimensions[G]._ticktext[X];K[X]={dimensionInd:T,categoryInd:N=X,categoryValue:Z,displayInd:N,categoryLabel:H,valueInds:[],count:0,dragY:null}}o(K[X],x,g)}return t(function(Y,$,z){var j=Y.map(function(W){return W.categories.length}).reduce(function(W,ee){return Math.max(W,ee)});return{dimensions:Y,paths:$,trace:void 0,maxCats:j,count:z}}(U,k,p))}},{"../../components/colorscale/calc":658,"../../components/colorscale/helpers":661,"../../components/drawing":672,"../../lib":787,"../../lib/filter_unique.js":778,"../../lib/gup":784,"fast-isnumeric":246}],1160:[function(r,I,B){var t=r("../../lib"),d=r("../../components/colorscale/helpers").hasColorscale,m=r("../../components/colorscale/defaults"),h=r("../../plots/domain").defaults,e=r("../../plots/array_container_defaults"),f=r("./attributes"),l=r("../parcoords/merge_length");function o(u,s){function i(v,b){return t.coerce(u,s,f.dimensions,v,b)}var c=i("values"),n=i("visible");if(c&&c.length||(n=s.visible=!1),n){i("label"),i("displayindex",s._index);var a,g=u.categoryarray,p=Array.isArray(g)&&g.length>0;p&&(a="array");var y=i("categoryorder",a);y==="array"?(i("categoryarray"),i("ticktext")):(delete u.categoryarray,delete u.ticktext),p||y!=="array"||(s.categoryorder="trace")}}I.exports=function(u,s,i,c){function n(v,b){return t.coerce(u,s,f,v,b)}var a=e(u,s,{name:"dimensions",handleItemDefaults:o}),g=function(v,b,x,T,A){A("line.shape"),A("line.hovertemplate");var S=A("line.color",T.colorway[0]);if(d(v,"line")&&t.isArrayOrTypedArray(S)){if(S.length)return A("line.colorscale"),m(v,b,T,A,{prefix:"line.",cLetter:"c"}),S.length;b.line.color=x}return 1/0}(u,s,i,c,n);h(s,c,n),Array.isArray(a)&&a.length||(s.visible=!1),l(s,a,"values",g),n("hoveron"),n("hovertemplate"),n("arrangement"),n("bundlecolors"),n("sortpaths"),n("counts");var p={family:c.font.family,size:Math.round(c.font.size),color:c.font.color};t.coerceFont(n,"labelfont",p);var y={family:c.font.family,size:Math.round(c.font.size/1.2),color:c.font.color};t.coerceFont(n,"tickfont",y)}},{"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/domain":866,"../parcoords/merge_length":1173,"./attributes":1157}],1161:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:r("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1157,"./base_plot":1158,"./calc":1159,"./defaults":1160,"./plot":1163}],1162:[function(r,I,B){var t=r("@plotly/d3"),d=r("d3-interpolate").interpolateNumber,m=r("../../plot_api/plot_api"),h=r("../../components/fx"),e=r("../../lib"),f=e.strTranslate,l=r("../../components/drawing"),o=r("tinycolor2"),u=r("../../lib/svg_text_utils");function s(z,j,W,ee){var J=z.map(K.bind(0,j,W)),Q=ee.selectAll("g.parcatslayer").data([null]);Q.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var te=Q.selectAll("g.trace.parcats").data(J,i),ie=te.enter().append("g").attr("class","trace parcats");te.attr("transform",function(be){return f(be.x,be.y)}),ie.append("g").attr("class","paths");var ae=te.select("g.paths").selectAll("path.path").data(function(be){return be.paths},i);ae.attr("fill",function(be){return be.model.color});var he=ae.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(be){return be.model.color}).attr("fill-opacity",0);b(he),ae.attr("d",function(be){return be.svgD}),he.empty()||ae.sort(n),ae.exit().remove(),ae.on("mouseover",a).on("mouseout",g).on("click",v),ie.append("g").attr("class","dimensions");var se=te.select("g.dimensions").selectAll("g.dimension").data(function(be){return be.dimensions},i);se.enter().append("g").attr("class","dimension"),se.attr("transform",function(be){return f(be.x,0)}),se.exit().remove();var de=se.selectAll("g.category").data(function(be){return be.categories},i),ue=de.enter().append("g").attr("class","category");de.attr("transform",function(be){return f(0,be.y)}),ue.append("rect").attr("class","catrect").attr("pointer-events","none"),de.select("rect.catrect").attr("fill","none").attr("width",function(be){return be.width}).attr("height",function(be){return be.height}),T(ue);var ve=de.selectAll("rect.bandrect").data(function(be){return be.bands},i);ve.each(function(){e.raiseToTop(this)}),ve.attr("fill",function(be){return be.color});var ke=ve.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(be){return be.color}).attr("fill-opacity",0);ve.attr("fill",function(be){return be.color}).attr("width",function(be){return be.width}).attr("height",function(be){return be.height}).attr("y",function(be){return be.y}).attr("cursor",function(be){return be.parcatsViewModel.arrangement==="fixed"?"default":be.parcatsViewModel.arrangement==="perpendicular"?"ns-resize":"move"}),A(ke),ve.exit().remove(),ue.append("text").attr("class","catlabel").attr("pointer-events","none");var Ee=j._fullLayout.paper_bgcolor;de.select("text.catlabel").attr("text-anchor",function(be){return c(be)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",u.makeTextShadow(Ee)).style("fill","rgb(0, 0, 0)").attr("x",function(be){return c(be)?be.width+5:-5}).attr("y",function(be){return be.height/2}).text(function(be){return be.model.categoryLabel}).each(function(be){l.font(t.select(this),be.parcatsViewModel.categorylabelfont),u.convertToTspans(t.select(this),j)}),ue.append("text").attr("class","dimlabel"),de.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(be){return be.parcatsViewModel.arrangement==="fixed"?"default":"ew-resize"}).attr("x",function(be){return be.width/2}).attr("y",-5).text(function(be,xe){return xe===0?be.parcatsViewModel.model.dimensions[be.model.dimensionInd].dimensionLabel:null}).each(function(be){l.font(t.select(this),be.parcatsViewModel.labelfont)}),de.selectAll("rect.bandrect").on("mouseover",L).on("mouseout",M),de.exit().remove(),se.call(t.behavior.drag().origin(function(be){return{x:be.x,y:0}}).on("dragstart",P).on("drag",D).on("dragend",N)),te.each(function(be){be.traceSelection=t.select(this),be.pathSelection=t.select(this).selectAll("g.paths").selectAll("path.path"),be.dimensionSelection=t.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),te.exit().remove()}function i(z){return z.key}function c(z){var j=z.parcatsViewModel.dimensions.length,W=z.parcatsViewModel.dimensions[j-1].model.dimensionInd;return z.model.dimensionInd===W}function n(z,j){return z.model.rawColor>j.model.rawColor?1:z.model.rawColor<j.model.rawColor?-1:0}function a(z){if(!z.parcatsViewModel.dragDimension&&z.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){e.raiseToTop(this),x(t.select(this));var j=p(z),W=y(z);if(z.parcatsViewModel.graphDiv.emit("plotly_hover",{points:j,event:t.event,constraints:W}),z.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var ee,J,Q,te=t.mouse(this)[0],ie=z.parcatsViewModel.graphDiv,ae=z.parcatsViewModel.trace,he=ie._fullLayout,se=he._paperdiv.node().getBoundingClientRect(),de=z.parcatsViewModel.graphDiv.getBoundingClientRect();for(Q=0;Q<z.leftXs.length-1;Q++)if(z.leftXs[Q]+z.dimWidths[Q]-2<=te&&te<=z.leftXs[Q+1]+2){var ue=z.parcatsViewModel.dimensions[Q],ve=z.parcatsViewModel.dimensions[Q+1];ee=(ue.x+ue.width+ve.x)/2,J=(z.topYs[Q]+z.topYs[Q+1]+z.height)/2;break}var ke=z.parcatsViewModel.x+ee,Ee=z.parcatsViewModel.y+J,be=o.mostReadable(z.model.color,["black","white"]),xe=z.model.count,ce=xe/z.parcatsViewModel.model.count,ge={countLabel:xe,probabilityLabel:ce.toFixed(3)},we=[];z.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&we.push(["Count:",ge.countLabel].join(" ")),z.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&we.push(["P:",ge.probabilityLabel].join(" "));var Me=we.join("<br>"),Se=t.mouse(ie)[0];h.loneHover({trace:ae,x:ke-se.left+de.left,y:Ee-se.top+de.top,text:Me,color:z.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:be,idealAlign:Se<ke?"right":"left",hovertemplate:(ae.line||{}).hovertemplate,hovertemplateLabels:ge,eventData:[{data:ae._input,fullData:ae,count:xe,probability:ce}]},{container:he._hoverlayer.node(),outerContainer:he._paper.node(),gd:ie})}}}function g(z){if(!z.parcatsViewModel.dragDimension&&(b(t.select(this)),h.loneUnhover(z.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),z.parcatsViewModel.pathSelection.sort(n),z.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1)){var j=p(z),W=y(z);z.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:j,event:t.event,constraints:W})}}function p(z){for(var j=[],W=U(z.parcatsViewModel),ee=0;ee<z.model.valueInds.length;ee++){var J=z.model.valueInds[ee];j.push({curveNumber:W,pointNumber:J})}return j}function y(z){for(var j={},W=z.parcatsViewModel.model.dimensions,ee=0;ee<W.length;ee++){var J=W[ee],Q=J.categories[z.model.categoryInds[ee]];j[J.containerInd]=Q.categoryValue}return z.model.rawColor!==void 0&&(j.color=z.model.rawColor),j}function v(z){if(z.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var j=p(z),W=y(z);z.parcatsViewModel.graphDiv.emit("plotly_click",{points:j,event:t.event,constraints:W})}}function b(z){z.attr("fill",function(j){return j.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function x(z){z.attr("fill-opacity",.8).attr("stroke",function(j){return o.mostReadable(j.model.color,["black","white"])}).attr("stroke-width",.3)}function T(z){z.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function A(z){z.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function S(z){var j=z.parcatsViewModel.pathSelection,W=z.categoryViewModel.model.dimensionInd,ee=z.categoryViewModel.model.categoryInd;return j.filter(function(J){return J.model.categoryInds[W]===ee&&J.model.color===z.color})}function w(z,j,W){var ee=t.select(z).datum(),J=ee.categoryViewModel.model,Q=ee.parcatsViewModel.graphDiv,te=t.select(z.parentNode).selectAll("rect.bandrect"),ie=[];te.each(function(he){S(he).each(function(se){Array.prototype.push.apply(ie,p(se))})});var ae={};ae[J.dimensionInd]=J.categoryValue,Q.emit(j,{points:ie,event:W,constraints:ae})}function E(z,j,W){var ee=t.select(z).datum(),J=ee.categoryViewModel.model,Q=ee.parcatsViewModel.graphDiv,te=S(ee),ie=[];te.each(function(he){Array.prototype.push.apply(ie,p(he))});var ae={};ae[J.dimensionInd]=J.categoryValue,ee.rawColor!==void 0&&(ae.color=ee.rawColor),Q.emit(j,{points:ie,event:W,constraints:ae})}function k(z,j,W){z._fullLayout._calcInverseTransform(z);var ee,J,Q=z._fullLayout._invScaleX,te=z._fullLayout._invScaleY,ie=t.select(W.parentNode).select("rect.catrect"),ae=ie.node().getBoundingClientRect(),he=ie.datum(),se=he.parcatsViewModel,de=se.model.dimensions[he.model.dimensionInd],ue=se.trace,ve=ae.top+ae.height/2;se.dimensions.length>1&&de.displayInd===se.dimensions.length-1?(ee=ae.left,J="left"):(ee=ae.left+ae.width,J="right");var ke=he.model.count,Ee=he.model.categoryLabel,be=ke/he.parcatsViewModel.model.count,xe={countLabel:ke,categoryLabel:Ee,probabilityLabel:be.toFixed(3)},ce=[];he.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&ce.push(["Count:",xe.countLabel].join(" ")),he.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&ce.push(["P("+xe.categoryLabel+"):",xe.probabilityLabel].join(" "));var ge=ce.join("<br>");return{trace:ue,x:Q*(ee-j.left),y:te*(ve-j.top),text:ge,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:J,hovertemplate:ue.hovertemplate,hovertemplateLabels:xe,eventData:[{data:ue._input,fullData:ue,count:ke,category:Ee,probability:be}]}}function L(z){if(!z.parcatsViewModel.dragDimension&&z.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){if(t.mouse(this)[1]<-1)return;var j,W=z.parcatsViewModel.graphDiv,ee=W._fullLayout,J=ee._paperdiv.node().getBoundingClientRect(),Q=z.parcatsViewModel.hoveron;Q==="color"?(function(te){var ie=t.select(te).datum(),ae=S(ie);x(ae),ae.each(function(){e.raiseToTop(this)}),t.select(te.parentNode).selectAll("rect.bandrect").filter(function(he){return he.color===ie.color}).each(function(){e.raiseToTop(this),t.select(this).attr("stroke","black").attr("stroke-width",1.5)})}(this),E(this,"plotly_hover",t.event)):(function(te){t.select(te.parentNode).selectAll("rect.bandrect").each(function(ie){var ae=S(ie);x(ae),ae.each(function(){e.raiseToTop(this)})}),t.select(te.parentNode).select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}(this),w(this,"plotly_hover",t.event)),z.parcatsViewModel.hoverinfoItems.indexOf("none")===-1&&(Q==="category"?j=k(W,J,this):Q==="color"?j=function(te,ie,ae){te._fullLayout._calcInverseTransform(te);var he,se,de=te._fullLayout._invScaleX,ue=te._fullLayout._invScaleY,ve=ae.getBoundingClientRect(),ke=t.select(ae).datum(),Ee=ke.categoryViewModel,be=Ee.parcatsViewModel,xe=be.model.dimensions[Ee.model.dimensionInd],ce=be.trace,ge=ve.y+ve.height/2;be.dimensions.length>1&&xe.displayInd===be.dimensions.length-1?(he=ve.left,se="left"):(he=ve.left+ve.width,se="right");var we=Ee.model.categoryLabel,Me=ke.parcatsViewModel.model.count,Se=0;ke.categoryViewModel.bands.forEach(function(st){st.color===ke.color&&(Se+=st.count)});var ze=Ee.model.count,Fe=0;be.pathSelection.each(function(st){st.model.color===ke.color&&(Fe+=st.model.count)});var Ye=Se/Me,rt=Se/Fe,Oe=Se/ze,je={countLabel:Me,categoryLabel:we,probabilityLabel:Ye.toFixed(3)},We=[];Ee.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&We.push(["Count:",je.countLabel].join(" ")),Ee.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&(We.push("P(color \u2229 "+we+"): "+je.probabilityLabel),We.push("P("+we+" | color): "+rt.toFixed(3)),We.push("P(color | "+we+"): "+Oe.toFixed(3)));var qe=We.join("<br>"),et=o.mostReadable(ke.color,["black","white"]);return{trace:ce,x:de*(he-ie.left),y:ue*(ge-ie.top),text:qe,color:ke.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:et,fontSize:10,idealAlign:se,hovertemplate:ce.hovertemplate,hovertemplateLabels:je,eventData:[{data:ce._input,fullData:ce,category:we,count:Me,probability:Ye,categorycount:ze,colorcount:Fe,bandcolorcount:Se}]}}(W,J,this):Q==="dimension"&&(j=function(te,ie,ae){var he=[];return t.select(ae.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){he.push(k(te,ie,this))}),he}(W,J,this)),j&&h.loneHover(j,{container:ee._hoverlayer.node(),outerContainer:ee._paper.node(),gd:W}))}}function M(z){var j=z.parcatsViewModel;!j.dragDimension&&(b(j.pathSelection),T(j.dimensionSelection.selectAll("g.category")),A(j.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),h.loneUnhover(j.graphDiv._fullLayout._hoverlayer.node()),j.pathSelection.sort(n),j.hoverinfoItems.indexOf("skip")===-1)&&(z.parcatsViewModel.hoveron==="color"?E(this,"plotly_unhover",t.event):w(this,"plotly_unhover",t.event))}function P(z){z.parcatsViewModel.arrangement!=="fixed"&&(z.dragDimensionDisplayInd=z.model.displayInd,z.initialDragDimensionDisplayInds=z.parcatsViewModel.model.dimensions.map(function(j){return j.displayInd}),z.dragHasMoved=!1,z.dragCategoryDisplayInd=null,t.select(this).selectAll("g.category").select("rect.catrect").each(function(j){var W=t.mouse(this)[0],ee=t.mouse(this)[1];-2<=W&&W<=j.width+2&&-2<=ee&&ee<=j.height+2&&(z.dragCategoryDisplayInd=j.model.displayInd,z.initialDragCategoryDisplayInds=z.model.categories.map(function(J){return J.displayInd}),j.model.dragY=j.y,e.raiseToTop(this.parentNode),t.select(this.parentNode).selectAll("rect.bandrect").each(function(J){J.y<ee&&ee<=J.y+J.height&&(z.potentialClickBand=this)}))}),z.parcatsViewModel.dragDimension=z,h.loneUnhover(z.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function D(z){if(z.parcatsViewModel.arrangement!=="fixed"&&(z.dragHasMoved=!0,z.dragDimensionDisplayInd!==null)){var j=z.dragDimensionDisplayInd,W=j-1,ee=j+1,J=z.parcatsViewModel.dimensions[j];if(z.dragCategoryDisplayInd!==null){var Q=J.categories[z.dragCategoryDisplayInd];Q.model.dragY+=t.event.dy;var te=Q.model.dragY,ie=Q.model.displayInd,ae=J.categories,he=ae[ie-1],se=ae[ie+1];he!==void 0&&te<he.y+he.height/2&&(Q.model.displayInd=he.model.displayInd,he.model.displayInd=ie),se!==void 0&&te+Q.height>se.y+se.height/2&&(Q.model.displayInd=se.model.displayInd,se.model.displayInd=ie),z.dragCategoryDisplayInd=Q.model.displayInd}if(z.dragCategoryDisplayInd===null||z.parcatsViewModel.arrangement==="freeform"){J.model.dragX=t.event.x;var de=z.parcatsViewModel.dimensions[W],ue=z.parcatsViewModel.dimensions[ee];de!==void 0&&J.model.dragX<de.x+de.width&&(J.model.displayInd=de.model.displayInd,de.model.displayInd=j),ue!==void 0&&J.model.dragX+J.width>ue.x&&(J.model.displayInd=ue.model.displayInd,ue.model.displayInd=z.dragDimensionDisplayInd),z.dragDimensionDisplayInd=J.model.displayInd}Y(z.parcatsViewModel),H(z.parcatsViewModel),X(z.parcatsViewModel),G(z.parcatsViewModel)}}function N(z){if(z.parcatsViewModel.arrangement!=="fixed"&&z.dragDimensionDisplayInd!==null){t.select(this).selectAll("text").attr("font-weight","normal");var j={},W=U(z.parcatsViewModel),ee=z.parcatsViewModel.model.dimensions.map(function(se){return se.displayInd}),J=z.initialDragDimensionDisplayInds.some(function(se,de){return se!==ee[de]});J&&ee.forEach(function(se,de){var ue=z.parcatsViewModel.model.dimensions[de].containerInd;j["dimensions["+ue+"].displayindex"]=se});var Q=!1;if(z.dragCategoryDisplayInd!==null){var te=z.model.categories.map(function(se){return se.displayInd});if(Q=z.initialDragCategoryDisplayInds.some(function(se,de){return se!==te[de]})){var ie=z.model.categories.slice().sort(function(se,de){return se.displayInd-de.displayInd}),ae=ie.map(function(se){return se.categoryValue}),he=ie.map(function(se){return se.categoryLabel});j["dimensions["+z.model.containerInd+"].categoryarray"]=[ae],j["dimensions["+z.model.containerInd+"].ticktext"]=[he],j["dimensions["+z.model.containerInd+"].categoryorder"]="array"}}z.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1&&!z.dragHasMoved&&z.potentialClickBand&&(z.parcatsViewModel.hoveron==="color"?E(z.potentialClickBand,"plotly_click",t.event.sourceEvent):w(z.potentialClickBand,"plotly_click",t.event.sourceEvent)),z.model.dragX=null,z.dragCategoryDisplayInd!==null&&(z.parcatsViewModel.dimensions[z.dragDimensionDisplayInd].categories[z.dragCategoryDisplayInd].model.dragY=null,z.dragCategoryDisplayInd=null),z.dragDimensionDisplayInd=null,z.parcatsViewModel.dragDimension=null,z.dragHasMoved=null,z.potentialClickBand=null,Y(z.parcatsViewModel),H(z.parcatsViewModel),t.transition().duration(300).ease("cubic-in-out").each(function(){X(z.parcatsViewModel,!0),G(z.parcatsViewModel,!0)}).each("end",function(){(J||Q)&&m.restyle(z.parcatsViewModel.graphDiv,j,[W])})}}function U(z){for(var j,W=z.graphDiv._fullData,ee=0;ee<W.length;ee++)if(z.key===W[ee].uid){j=ee;break}return j}function G(z,j){var W;j===void 0&&(j=!1),z.pathSelection.data(function(ee){return ee.paths},i),(W=z.pathSelection,j?W.transition():W).attr("d",function(ee){return ee.svgD})}function X(z,j){function W(te){return j?te.transition():te}j===void 0&&(j=!1),z.dimensionSelection.data(function(te){return te.dimensions},i);var ee=z.dimensionSelection.selectAll("g.category").data(function(te){return te.categories},i);W(z.dimensionSelection).attr("transform",function(te){return f(te.x,0)}),W(ee).attr("transform",function(te){return f(0,te.y)}),ee.select(".dimlabel").text(function(te,ie){return ie===0?te.parcatsViewModel.model.dimensions[te.model.dimensionInd].dimensionLabel:null}),ee.select(".catlabel").attr("text-anchor",function(te){return c(te)?"start":"end"}).attr("x",function(te){return c(te)?te.width+5:-5}).each(function(te){var ie,ae;c(te)?(ie=te.width+5,ae="start"):(ie=-5,ae="end"),t.select(this).selectAll("tspan").attr("x",ie).attr("text-anchor",ae)});var J=ee.selectAll("rect.bandrect").data(function(te){return te.bands},i),Q=J.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(te){return te.color}).attr("fill-opacity",0);J.attr("fill",function(te){return te.color}).attr("width",function(te){return te.width}).attr("height",function(te){return te.height}).attr("y",function(te){return te.y}),A(Q),J.each(function(){e.raiseToTop(this)}),J.exit().remove()}function K(z,j,W){var ee,J=W[0],Q=j.margin||{l:80,r:80,t:100,b:80},te=J.trace,ie=te.domain,ae=j.width,he=j.height,se=Math.floor(ae*(ie.x[1]-ie.x[0])),de=Math.floor(he*(ie.y[1]-ie.y[0])),ue=ie.x[0]*ae+Q.l,ve=j.height-ie.y[1]*j.height+Q.t,ke=te.line.shape;ee=te.hoverinfo==="all"?["count","probability"]:(te.hoverinfo||"").split("+");var Ee={trace:te,key:te.uid,model:J,x:ue,y:ve,width:se,height:de,hoveron:te.hoveron,hoverinfoItems:ee,arrangement:te.arrangement,bundlecolors:te.bundlecolors,sortpaths:te.sortpaths,labelfont:te.labelfont,categorylabelfont:te.tickfont,pathShape:ke,dragDimension:null,margin:Q,paths:[],dimensions:[],graphDiv:z,traceSelection:null,pathSelection:null,dimensionSelection:null};return J.dimensions&&(Y(Ee),H(Ee)),Ee}function Z(z,j,W,ee,J){var Q,te,ie=[],ae=[];for(te=0;te<W.length-1;te++)Q=d(W[te]+z[te],z[te+1]),ie.push(Q(J)),ae.push(Q(1-J));var he="M "+z[0]+","+j[0];for(he+="l"+W[0]+",0 ",te=1;te<W.length;te++)he+="C"+ie[te-1]+","+j[te-1]+" "+ae[te-1]+","+j[te]+" "+z[te]+","+j[te],he+="l"+W[te]+",0 ";for(he+="l0,"+ee+" ",he+="l -"+W[W.length-1]+",0 ",te=W.length-2;te>=0;te--)he+="C"+ae[te]+","+(j[te+1]+ee)+" "+ie[te]+","+(j[te]+ee)+" "+(z[te]+W[te])+","+(j[te]+ee),he+="l-"+W[te]+",0 ";return he+="Z"}function H(z){var j=z.dimensions,W=z.model,ee=j.map(function(We){return We.categories.map(function(qe){return qe.y})}),J=z.model.dimensions.map(function(We){return We.categories.map(function(qe){return qe.displayInd})}),Q=z.model.dimensions.map(function(We){return We.displayInd}),te=z.dimensions.map(function(We){return We.model.dimensionInd}),ie=j.map(function(We){return We.x}),ae=j.map(function(We){return We.width}),he=[];for(var se in W.paths)W.paths.hasOwnProperty(se)&&he.push(W.paths[se]);function de(We){var qe=We.categoryInds.map(function(et,st){return J[st][et]});return te.map(function(et){return qe[et]})}he.sort(function(We,qe){var et=de(We),st=de(qe);return z.sortpaths==="backward"&&(et.reverse(),st.reverse()),et.push(We.valueInds[0]),st.push(qe.valueInds[0]),z.bundlecolors&&(et.unshift(We.rawColor),st.unshift(qe.rawColor)),et<st?-1:et>st?1:0});for(var ue=new Array(he.length),ve=j[0].model.count,ke=j[0].categories.map(function(We){return We.height}).reduce(function(We,qe){return We+qe}),Ee=0;Ee<he.length;Ee++){var be,xe=he[Ee];be=ve>0?ke*(xe.count/ve):0;for(var ce,ge=new Array(ee.length),we=0;we<xe.categoryInds.length;we++){var Me=xe.categoryInds[we],Se=J[we][Me],ze=Q[we];ge[ze]=ee[ze][Se],ee[ze][Se]+=be;var Fe=z.dimensions[ze].categories[Se],Ye=Fe.bands.length,rt=Fe.bands[Ye-1];if(rt===void 0||xe.rawColor!==rt.rawColor){var Oe=rt===void 0?0:rt.y+rt.height;Fe.bands.push({key:Oe,color:xe.color,rawColor:xe.rawColor,height:be,width:Fe.width,count:xe.count,y:Oe,categoryViewModel:Fe,parcatsViewModel:z})}else{var je=Fe.bands[Ye-1];je.height+=be,je.count+=xe.count}}ce=z.pathShape==="hspline"?Z(ie,ge,ae,be,.5):Z(ie,ge,ae,be,0),ue[Ee]={key:xe.valueInds[0],model:xe,height:be,leftXs:ie,topYs:ge,dimWidths:ae,svgD:ce,parcatsViewModel:z}}z.paths=ue}function Y(z){var j=z.model.dimensions.map(function(te){return{displayInd:te.displayInd,dimensionInd:te.dimensionInd}});j.sort(function(te,ie){return te.displayInd-ie.displayInd});var W=[];for(var ee in j){var J=j[ee].dimensionInd,Q=z.model.dimensions[J];W.push($(z,Q))}z.dimensions=W}function $(z,j){var W,ee=z.model.dimensions.length,J=j.displayInd;W=40+(ee>1?(z.width-80-16)/(ee-1):0)*J;var Q,te,ie,ae,he,se=[],de=z.model.maxCats,ue=j.categories.length,ve=j.count,ke=z.height-8*(de-1),Ee=8*(de-ue)/2,be=j.categories.map(function(xe){return{displayInd:xe.displayInd,categoryInd:xe.categoryInd}});for(be.sort(function(xe,ce){return xe.displayInd-ce.displayInd}),he=0;he<ue;he++)ae=be[he].categoryInd,te=j.categories[ae],Q=ve>0?te.count/ve*ke:0,ie={key:te.valueInds[0],model:te,width:16,height:Q,y:te.dragY!==null?te.dragY:Ee,bands:[],parcatsViewModel:z},Ee=Ee+Q+8,se.push(ie);return{key:j.dimensionInd,x:j.dragX!==null?j.dragX:W,y:0,width:16,model:j,categories:se,parcatsViewModel:z,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}I.exports=function(z,j,W,ee){s(W,z,ee,j)}},{"../../components/drawing":672,"../../components/fx":690,"../../lib":787,"../../lib/svg_text_utils":813,"../../plot_api/plot_api":824,"@plotly/d3":58,"d3-interpolate":168,tinycolor2:583}],1163:[function(r,I,B){var t=r("./parcats");I.exports=function(d,m,h,e){var f=d._fullLayout,l=f._paper,o=f._size;t(d,l,m,{width:o.w,height:o.h,margin:{t:o.t,r:o.r,b:o.b,l:o.l}},h,e)}},{"./parcats":1162}],1164:[function(r,I,B){var t=r("../../components/colorscale/attributes"),d=r("../../plots/cartesian/layout_attributes"),m=r("../../plots/font_attributes"),h=r("../../plots/domain").attributes,e=r("../../lib/extend").extendFlat,f=r("../../plot_api/plot_template").templatedArray;I.exports={domain:h({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:m({editType:"plot"}),tickfont:m({editType:"plot"}),rangefont:m({editType:"plot"}),dimensions:f("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},d.tickvals,{editType:"plot"}),ticktext:e({},d.ticktext,{editType:"plot"}),tickformat:e({},d.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},t("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"}))}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/plot_template":827,"../../plots/cartesian/layout_attributes":853,"../../plots/domain":866,"../../plots/font_attributes":867}],1165:[function(r,I,B){var t=r("./constants"),d=r("@plotly/d3"),m=r("../../lib/gup").keyFun,h=r("../../lib/gup").repeat,e=r("../../lib").sorterAsc,f=r("../../lib").strTranslate,l=t.bar.snapRatio;function o(k,L){return k*(1-l)+L*l}var u=t.bar.snapClose;function s(k,L){return k*(1-u)+L*u}function i(k,L,M,P){if(function($,z){for(var j=0;j<z.length;j++)if($>=z[j][0]&&$<=z[j][1])return!0;return!1}(M,P))return M;var D=k?-1:1,N=0,U=L.length-1;if(D<0){var G=N;N=U,U=G}for(var X=L[N],K=X,Z=N;D*Z<D*U;Z+=D){var H=Z+D,Y=L[H];if(D*M<D*s(X,Y))return o(X,K);if(D*M<D*Y||H===U)return o(Y,X);K=X,X=Y}}function c(k){k.attr("x",-t.bar.captureWidth/2).attr("width",t.bar.captureWidth)}function n(k){k.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function a(k){if(!k.brush.filterSpecified)return"0,"+k.height;for(var L,M,P,D=g(k.brush.filter.getConsolidated(),k.height),N=[0],U=D.length?D[0][0]:null,G=0;G<D.length;G++)M=(L=D[G])[1]-L[0],N.push(U),N.push(M),(P=G+1)<D.length&&(U=D[P][0]-L[1]);return N.push(k.height),N}function g(k,L){return k.map(function(M){return M.map(function(P){return Math.max(0,P*L)}).sort(e)})}function p(){d.select(document.body).style("cursor",null)}function y(k){k.attr("stroke-dasharray",a)}function v(k,L){var M=d.select(k).selectAll(".highlight, .highlight-shadow");y(L?M.transition().duration(t.bar.snapDuration).each("end",L):M)}function b(k,L){var M,P=k.brush,D=NaN,N={};if(P.filterSpecified){var U=k.height,G=P.filter.getConsolidated(),X=g(G,U),K=NaN,Z=NaN,H=NaN;for(M=0;M<=X.length;M++){var Y=X[M];if(Y&&Y[0]<=L&&L<=Y[1]){K=M;break}if(Z=M?M-1:NaN,Y&&Y[0]>L){H=M;break}}if(D=K,isNaN(D)&&(D=isNaN(Z)||isNaN(H)?isNaN(Z)?H:Z:L-X[Z][1]<X[H][0]-L?Z:H),!isNaN(D)){var $=X[D],z=function(J,Q){var te=t.bar.handleHeight;if(!(Q>J[1]+te||Q<J[0]-te))return Q>=.9*J[1]+.1*J[0]?"n":Q<=.9*J[0]+.1*J[1]?"s":"ns"}($,L);z&&(N.interval=G[D],N.intervalPix=$,N.region=z)}}if(k.ordinal&&!N.region){var j=k.unitTickvals,W=k.unitToPaddedPx.invert(L);for(M=0;M<j.length;M++){var ee=[.25*j[Math.max(M-1,0)]+.75*j[M],.25*j[Math.min(M+1,j.length-1)]+.75*j[M]];if(W>=ee[0]&&W<=ee[1]){N.clickableOrdinalRange=ee;break}}}return N}function x(k,L){d.event.sourceEvent.stopPropagation();var M=L.height-d.mouse(k)[1]-2*t.verticalPadding,P=L.brush.svgBrush;P.wasDragged=!0,P._dragging=!0,P.grabbingBar?P.newExtent=[M-P.grabPoint,M+P.barLength-P.grabPoint].map(L.unitToPaddedPx.invert):P.newExtent=[P.startExtent,L.unitToPaddedPx.invert(M)].sort(e),L.brush.filterSpecified=!0,P.extent=P.stayingIntervals.concat([P.newExtent]),P.brushCallback(L),v(k.parentNode)}function T(k,L){var M=b(L,L.height-d.mouse(k)[1]-2*t.verticalPadding),P="crosshair";M.clickableOrdinalRange?P="pointer":M.region&&(P=M.region+"-resize"),d.select(document.body).style("cursor",P)}function A(k){k.on("mousemove",function(L){d.event.preventDefault(),L.parent.inBrushDrag||T(this,L)}).on("mouseleave",function(L){L.parent.inBrushDrag||p()}).call(d.behavior.drag().on("dragstart",function(L){(function(M,P){d.event.sourceEvent.stopPropagation();var D=P.height-d.mouse(M)[1]-2*t.verticalPadding,N=P.unitToPaddedPx.invert(D),U=P.brush,G=b(P,D),X=G.interval,K=U.svgBrush;if(K.wasDragged=!1,K.grabbingBar=G.region==="ns",K.grabbingBar){var Z=X.map(P.unitToPaddedPx);K.grabPoint=D-Z[0]-t.verticalPadding,K.barLength=Z[1]-Z[0]}K.clickableOrdinalRange=G.clickableOrdinalRange,K.stayingIntervals=P.multiselect&&U.filterSpecified?U.filter.getConsolidated():[],X&&(K.stayingIntervals=K.stayingIntervals.filter(function(H){return H[0]!==X[0]&&H[1]!==X[1]})),K.startExtent=G.region?X[G.region==="s"?1:0]:N,P.parent.inBrushDrag=!0,K.brushStartCallback()})(this,L)}).on("drag",function(L){x(this,L)}).on("dragend",function(L){(function(M,P){var D=P.brush,N=D.filter,U=D.svgBrush;U._dragging||(T(M,P),x(M,P),P.brush.svgBrush.wasDragged=!1),U._dragging=!1,d.event.sourceEvent.stopPropagation();var G=U.grabbingBar;if(U.grabbingBar=!1,U.grabLocation=void 0,P.parent.inBrushDrag=!1,p(),!U.wasDragged)return U.wasDragged=void 0,U.clickableOrdinalRange?D.filterSpecified&&P.multiselect?U.extent.push(U.clickableOrdinalRange):(U.extent=[U.clickableOrdinalRange],D.filterSpecified=!0):G?(U.extent=U.stayingIntervals,U.extent.length===0&&w(D)):w(D),U.brushCallback(P),v(M.parentNode),void U.brushEndCallback(D.filterSpecified?N.getConsolidated():[]);var X=function(){N.set(N.getConsolidated())};if(P.ordinal){var K=P.unitTickvals;K[K.length-1]<K[0]&&K.reverse(),U.newExtent=[i(0,K,U.newExtent[0],U.stayingIntervals),i(1,K,U.newExtent[1],U.stayingIntervals)];var Z=U.newExtent[1]>U.newExtent[0];U.extent=U.stayingIntervals.concat(Z?[U.newExtent]:[]),U.extent.length||w(D),U.brushCallback(P),Z?v(M.parentNode,X):(X(),v(M.parentNode))}else X();U.brushEndCallback(D.filterSpecified?N.getConsolidated():[])})(this,L)}))}function S(k,L){return k[0]-L[0]}function w(k){k.filterSpecified=!1,k.svgBrush.extent=[[-1/0,1/0]]}function E(k){for(var L,M=k.slice(),P=[],D=M.shift();D;){for(L=D.slice();(D=M.shift())&&D[0]<=L[1];)L[1]=Math.max(L[1],D[1]);P.push(L)}return P.length===1&&P[0][0]>P[0][1]&&(P=[]),P}I.exports={makeBrush:function(k,L,M,P,D,N){var U,G=function(){var X,K,Z=[];return{set:function(H){(Z=H.map(function(Y){return Y.slice().sort(e)}).sort(S)).length===1&&Z[0][0]===-1/0&&Z[0][1]===1/0&&(Z=[[0,-1]]),X=E(Z),K=Z.reduce(function(Y,$){return[Math.min(Y[0],$[0]),Math.max(Y[1],$[1])]},[1/0,-1/0])},get:function(){return Z.slice()},getConsolidated:function(){return X},getBounds:function(){return K}}}();return G.set(M),{filter:G,filterSpecified:L,svgBrush:{extent:[],brushStartCallback:P,brushCallback:(U=D,function(X){var K=X.brush,Z=function(H){return H.svgBrush.extent.map(function(Y){return Y.slice()})}(K).slice();K.filter.set(Z),U()}),brushEndCallback:N}}},ensureAxisBrush:function(k,L){var M=k.selectAll("."+t.cn.axisBrush).data(h,m);M.enter().append("g").classed(t.cn.axisBrush,!0),function(P,D){var N=P.selectAll(".background").data(h);N.enter().append("rect").classed("background",!0).call(c).call(n).style("pointer-events","auto").attr("transform",f(0,t.verticalPadding)),N.call(A).attr("height",function(X){return X.height-t.verticalPadding});var U=P.selectAll(".highlight-shadow").data(h);U.enter().append("line").classed("highlight-shadow",!0).attr("x",-t.bar.width/2).attr("stroke-width",t.bar.width+t.bar.strokeWidth).attr("stroke",D).attr("opacity",t.bar.strokeOpacity).attr("stroke-linecap","butt"),U.attr("y1",function(X){return X.height}).call(y);var G=P.selectAll(".highlight").data(h);G.enter().append("line").classed("highlight",!0).attr("x",-t.bar.width/2).attr("stroke-width",t.bar.width-t.bar.strokeWidth).attr("stroke",t.bar.fillColor).attr("opacity",t.bar.fillOpacity).attr("stroke-linecap","butt"),G.attr("y1",function(X){return X.height}).call(y)}(M,L)},cleanRanges:function(k,L){if(Array.isArray(k[0])?(k=k.map(function(P){return P.sort(e)}),k=L.multiselect?E(k.sort(S)):[k[0]]):k=[k.sort(e)],L.tickvals){var M=L.tickvals.slice().sort(e);if(!(k=k.map(function(P){var D=[i(0,M,P[0],[]),i(1,M,P[1],[])];if(D[1]>D[0])return D}).filter(function(P){return P})).length)return}return k.length>1?k:k[0]}}},{"../../lib":787,"../../lib/gup":784,"./constants":1168,"@plotly/d3":58}],1166:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../plots/get_data").getModuleCalcData,m=r("./plot"),h=r("../../constants/xmlns_namespaces");B.name="parcoords",B.plot=function(e){var f=d(e.calcdata,"parcoords")[0];f.length&&m(e,f)},B.clean=function(e,f,l,o){var u=o._has&&o._has("parcoords"),s=f._has&&f._has("parcoords");u&&!s&&(o._paperdiv.selectAll(".parcoords").remove(),o._glimages.selectAll("*").remove())},B.toSVG=function(e){var f=e._fullLayout._glimages,l=t.select(e).selectAll(".svg-container");l.filter(function(o,u){return u===l.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var o=this.toDataURL("image/png");f.append("svg:image").attr({xmlns:h.svg,"xlink:href":o,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})}),window.setTimeout(function(){t.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":764,"../../plots/get_data":875,"./plot":1175,"@plotly/d3":58}],1167:[function(r,I,B){var t=r("../../lib").isArrayOrTypedArray,d=r("../../components/colorscale"),m=r("../../lib/gup").wrap;I.exports=function(h,e){var f,l;return d.hasColorscale(e,"line")&&t(e.line.color)?(f=e.line.color,l=d.extractOpts(e.line).colorscale,d.calc(h,e,{vals:f,containerStr:"line",cLetter:"c"})):(f=function(o){for(var u=new Array(o),s=0;s<o;s++)u[s]=.5;return u}(e._length),l=[[0,e.line.color],[1,e.line.color]]),m({lineColor:f,cscale:l})}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gup":784}],1168:[function(r,I,B){I.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,deselectedLineColor:"#777",bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],1169:[function(r,I,B){var t=r("../../lib"),d=r("../../components/colorscale/helpers").hasColorscale,m=r("../../components/colorscale/defaults"),h=r("../../plots/domain").defaults,e=r("../../plots/array_container_defaults"),f=r("../../plots/cartesian/axes"),l=r("./attributes"),o=r("./axisbrush"),u=r("./constants").maxDimensionCount,s=r("./merge_length");function i(c,n,a,g){function p(T,A){return t.coerce(c,n,l.dimensions,T,A)}var y=p("values"),v=p("visible");if(y&&y.length||(v=n.visible=!1),v){p("label"),p("tickvals"),p("ticktext"),p("tickformat");var b=p("range");n._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:b},f.setConvert(n._ax,g.layout),p("multiselect");var x=p("constraintrange");x&&(n.constraintrange=o.cleanRanges(x,n))}}I.exports=function(c,n,a,g){function p(T,A){return t.coerce(c,n,l,T,A)}var y=c.dimensions;Array.isArray(y)&&y.length>u&&(t.log("parcoords traces support up to "+u+" dimensions at the moment"),y.splice(u));var v=e(c,n,{name:"dimensions",layout:g,handleItemDefaults:i}),b=function(T,A,S,w,E){var k=E("line.color",S);if(d(T,"line")&&t.isArrayOrTypedArray(k)){if(k.length)return E("line.colorscale"),m(T,A,w,E,{prefix:"line.",cLetter:"c"}),k.length;A.line.color=S}return 1/0}(c,n,a,g,p);h(n,g,p),Array.isArray(v)&&v.length||(n.visible=!1),s(n,v,"values",b);var x={family:g.font.family,size:Math.round(g.font.size/1.2),color:g.font.color};t.coerceFont(p,"labelfont",x),t.coerceFont(p,"tickfont",x),t.coerceFont(p,"rangefont",x),p("labelangle"),p("labelside")}},{"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"../../plots/domain":866,"./attributes":1164,"./axisbrush":1165,"./constants":1168,"./merge_length":1173}],1170:[function(r,I,B){var t=r("../../lib").isTypedArray;B.convertTypedArray=function(d){return t(d)?Array.prototype.slice.call(d):d},B.isOrdinal=function(d){return!!d.tickvals},B.isVisible=function(d){return d.visible||!("visible"in d)}},{"../../lib":787}],1171:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:r("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":1164,"./base_plot":1166,"./calc":1167,"./defaults":1169,"./plot":1175}],1172:[function(r,I,B){var t=r("glslify"),d=t([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

attribute vec4 p01_04, p05_08, p09_12, p13_16,
               p17_20, p21_24, p25_28, p29_32,
               p33_36, p37_40, p41_44, p45_48,
               p49_52, p53_56, p57_60, colors;

uniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,
             loA, hiA, loB, hiB, loC, hiC, loD, hiD;

uniform vec2 resolution, viewBoxPos, viewBoxSize;
uniform float maskHeight;
uniform float drwLayer; // 0: context, 1: focus, 2: pick
uniform vec4 contextColor;
uniform sampler2D maskTexture, palette;

bool isPick    = (drwLayer > 1.5);
bool isContext = (drwLayer < 0.5);

const vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);
const vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);

float val(mat4 p, mat4 v) {
    return dot(matrixCompMult(p, v) * UNITS, UNITS);
}

float axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {
    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);
    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);
    return y1 * (1.0 - ratio) + y2 * ratio;
}

int iMod(int a, int b) {
    return a - b * (a / b);
}

bool fOutside(float p, float lo, float hi) {
    return (lo < hi) && (lo > p || p > hi);
}

bool vOutside(vec4 p, vec4 lo, vec4 hi) {
    return (
        fOutside(p[0], lo[0], hi[0]) ||
        fOutside(p[1], lo[1], hi[1]) ||
        fOutside(p[2], lo[2], hi[2]) ||
        fOutside(p[3], lo[3], hi[3])
    );
}

bool mOutside(mat4 p, mat4 lo, mat4 hi) {
    return (
        vOutside(p[0], lo[0], hi[0]) ||
        vOutside(p[1], lo[1], hi[1]) ||
        vOutside(p[2], lo[2], hi[2]) ||
        vOutside(p[3], lo[3], hi[3])
    );
}

bool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {
    return mOutside(A, loA, hiA) ||
           mOutside(B, loB, hiB) ||
           mOutside(C, loC, hiC) ||
           mOutside(D, loD, hiD);
}

bool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {
    mat4 pnts[4];
    pnts[0] = A;
    pnts[1] = B;
    pnts[2] = C;
    pnts[3] = D;

    for(int i = 0; i < 4; ++i) {
        for(int j = 0; j < 4; ++j) {
            for(int k = 0; k < 4; ++k) {
                if(0 == iMod(
                    int(255.0 * texture2D(maskTexture,
                        vec2(
                            (float(i * 2 + j / 2) + 0.5) / 8.0,
                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight
                        ))[3]
                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),
                    2
                )) return true;
            }
        }
    }
    return false;
}

vec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {
    float x = 0.5 * sign(v) + 0.5;
    float y = axisY(x, A, B, C, D);
    float z = 1.0 - abs(v);

    z += isContext ? 0.0 : 2.0 * float(
        outsideBoundingBox(A, B, C, D) ||
        outsideRasterMask(A, B, C, D)
    );

    return vec4(
        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,
        z,
        1.0
    );
}

void main() {
    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);
    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);
    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);
    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);

    float v = colors[3];

    gl_Position = position(isContext, v, A, B, C, D);

    fragColor =
        isContext ? vec4(contextColor) :
        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));
}
`]),m=t([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
    gl_FragColor = fragColor;
}
`]),h=r("./constants").maxDimensionCount,e=r("../../lib"),f=new Uint8Array(4),l=new Uint8Array(4),o={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function u(v,b,x,T,A){var S=v._gl;S.enable(S.SCISSOR_TEST),S.scissor(b,x,T,A),v.clear({color:[0,0,0,0],depth:1})}function s(v,b,x,T,A,S){var w=S.key;x.drawCompleted||(function(E){E.read({x:0,y:0,width:1,height:1,data:f})}(v),x.drawCompleted=!0),function E(k){var L=Math.min(T,A-k*T);k===0&&(window.cancelAnimationFrame(x.currentRafs[w]),delete x.currentRafs[w],u(v,S.scissorX,S.scissorY,S.scissorWidth,S.viewBoxSize[1])),x.clearOnly||(S.count=2*L,S.offset=2*k*T,b(S),k*T+L<A&&(x.currentRafs[w]=window.requestAnimationFrame(function(){E(k+1)})),x.drawCompleted=!1)}(0)}function i(v,b){for(var x=new Array(256),T=0;T<256;T++)x[T]=v(T/255).concat(b);return x}function c(v,b){return(v>>>8*b)%256/255}function n(v,b,x){for(var T=new Array(8*b),A=0,S=0;S<b;S++)for(var w=0;w<2;w++)for(var E=0;E<4;E++){var k=4*v+E,L=x[64*S+k];k===63&&w===0&&(L*=-1),T[A++]=L}return T}function a(v){var b="0"+v;return b.substr(b.length-2)}function g(v){return v<h?"p"+a(v+1)+"_"+a(v+4):"colors"}function p(v,b,x,T,A,S,w,E,k,L,M,P,D,N){for(var U=[[],[]],G=0;G<64;G++)U[0][G]=G===A?1:0,U[1][G]=G===S?1:0;w*=N,E*=N,k*=N,L*=N;var X=v.lines.canvasOverdrag*N,K=v.domain,Z=v.canvasWidth*N,H=v.canvasHeight*N,Y=v.pad.l*N,$=v.pad.b*N,z=v.layoutHeight*N,j=v.layoutWidth*N,W=v.deselectedLines.color;return e.extendFlat({key:M,resolution:[Z,H],viewBoxPos:[w+X,E],viewBoxSize:[k,L],i0:A,i1:S,dim0A:U[0].slice(0,16),dim0B:U[0].slice(16,32),dim0C:U[0].slice(32,48),dim0D:U[0].slice(48,64),dim1A:U[1].slice(0,16),dim1B:U[1].slice(16,32),dim1C:U[1].slice(32,48),dim1D:U[1].slice(48,64),drwLayer:P,contextColor:[W[0]/255,W[1]/255,W[2]/255,W[3]<1?W[3]:Math.max(1/255,Math.pow(1/v.lines.color.length,1/3))],scissorX:(T===b?0:w+X)+(Y-X)+j*K.x[0],scissorWidth:(T===x?Z-w+X:k+.5)+(T===b?w+X:0),scissorY:E+$+z*K.y[0],scissorHeight:L,viewportX:Y-X+j*K.x[0],viewportY:$+z*K.y[0],viewportWidth:Z,viewportHeight:H},D)}function y(v){var b=Math.max(0,Math.floor(2047*v[0]),0),x=Math.min(2047,Math.ceil(2047*v[1]),2047);return[Math.min(b,x),Math.max(b,x)]}I.exports=function(v,b){var x,T,A,S,w,E=b.context,k=b.pick,L=b.regl,M=L._gl,P=M.getParameter(M.ALIASED_LINE_WIDTH_RANGE),D=Math.max(P[0],Math.min(P[1],b.viewModel.plotGlPixelRatio)),N={currentRafs:{},drawCompleted:!0,clearOnly:!1},U=function(H){for(var Y={},$=0;$<=h;$+=4)Y[g($)]=H.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return Y}(L),G=L.texture(o),X=[];Z(b);var K=L({profile:!1,blend:{enable:E,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!E,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:L.prop("scissorX"),y:L.prop("scissorY"),width:L.prop("scissorWidth"),height:L.prop("scissorHeight")}},viewport:{x:L.prop("viewportX"),y:L.prop("viewportY"),width:L.prop("viewportWidth"),height:L.prop("viewportHeight")},dither:!1,vert:d,frag:m,primitive:"lines",lineWidth:D,attributes:U,uniforms:{resolution:L.prop("resolution"),viewBoxPos:L.prop("viewBoxPos"),viewBoxSize:L.prop("viewBoxSize"),dim0A:L.prop("dim0A"),dim1A:L.prop("dim1A"),dim0B:L.prop("dim0B"),dim1B:L.prop("dim1B"),dim0C:L.prop("dim0C"),dim1C:L.prop("dim1C"),dim0D:L.prop("dim0D"),dim1D:L.prop("dim1D"),loA:L.prop("loA"),hiA:L.prop("hiA"),loB:L.prop("loB"),hiB:L.prop("hiB"),loC:L.prop("loC"),hiC:L.prop("hiC"),loD:L.prop("loD"),hiD:L.prop("hiD"),palette:G,contextColor:L.prop("contextColor"),maskTexture:L.prop("maskTexture"),drwLayer:L.prop("drwLayer"),maskHeight:L.prop("maskHeight")},offset:L.prop("offset"),count:L.prop("count")});function Z(H){x=H.model,T=H.viewModel,A=T.dimensions.slice(),S=A[0]?A[0].values.length:0;var Y=x.lines,$=k?Y.color.map(function(j,W){return W/Y.color.length}):Y.color,z=function(j,W,ee){for(var J,Q=new Array(j*(h+4)),te=0,ie=0;ie<j;ie++){for(var ae=0;ae<h;ae++)Q[te++]=ae<W.length?W[ae].paddedUnitValues[ie]:.5;Q[te++]=c(ie,2),Q[te++]=c(ie,1),Q[te++]=c(ie,0),Q[te++]=(J=ee[ie],Math.max(1e-6,Math.min(.999999,J)))}return Q}(S,A,$);(function(j,W,ee){for(var J=0;J<=h;J+=4)j[g(J)](n(J/4,W,ee))})(U,S,z),E||k||(G=L.texture(e.extendFlat({data:i(x.unitToColor,255)},o)))}return{render:function(H,Y,$){var z,j,W,ee=H.length,J=1/0,Q=-1/0;for(z=0;z<ee;z++)H[z].dim0.canvasX<J&&(J=H[z].dim0.canvasX,j=z),H[z].dim1.canvasX>Q&&(Q=H[z].dim1.canvasX,W=z);ee===0&&u(L,0,0,x.canvasWidth,x.canvasHeight);var te=function(be){var xe,ce,ge,we=[[],[]];for(ge=0;ge<64;ge++){var Me=!be&&ge<A.length?A[ge].brush.filter.getBounds():[-1/0,1/0];we[0][ge]=Me[0],we[1][ge]=Me[1]}var Se=new Array(16384);for(xe=0;xe<16384;xe++)Se[xe]=255;if(!be)for(xe=0;xe<A.length;xe++){var ze=xe%8,Fe=(xe-ze)/8,Ye=Math.pow(2,ze),rt=A[xe].brush.filter.get();if(!(rt.length<2)){var Oe=y(rt[0])[1];for(ce=1;ce<rt.length;ce++){var je=y(rt[ce]);for(ge=Oe+1;ge<je[0];ge++)Se[8*ge+Fe]&=~Ye;Oe=Math.max(Oe,je[1])}}}var We={shape:[8,2048],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:Se};return w?w(We):w=L.texture(We),{maskTexture:w,maskHeight:2048,loA:we[0].slice(0,16),loB:we[0].slice(16,32),loC:we[0].slice(32,48),loD:we[0].slice(48,64),hiA:we[1].slice(0,16),hiB:we[1].slice(16,32),hiC:we[1].slice(32,48),hiD:we[1].slice(48,64)}}(E);for(z=0;z<ee;z++){var ie=H[z],ae=ie.dim0.crossfilterDimensionIndex,he=ie.dim1.crossfilterDimensionIndex,se=ie.canvasX,de=ie.canvasY,ue=se+ie.panelSizeX,ve=ie.plotGlPixelRatio;if(Y||!X[ae]||X[ae][0]!==se||X[ae][1]!==ue){X[ae]=[se,ue];var ke=p(x,j,W,z,ae,he,se,de,ie.panelSizeX,ie.panelSizeY,ie.dim0.crossfilterDimensionIndex,E?0:k?2:1,te,ve);N.clearOnly=$;var Ee=Y?x.lines.blockLineCount:S;s(L,K,N,Ee,S,ke)}}},readPixel:function(H,Y){return L.read({x:H,y:Y,width:1,height:1,data:l}),l},readPixels:function(H,Y,$,z){var j=new Uint8Array(4*$*z);return L.read({x:H,y:Y,width:$,height:z,data:j}),j},destroy:function(){for(var H in v.style["pointer-events"]="none",G.destroy(),w&&w.destroy(),U)U[H].destroy()},update:Z}}},{"../../lib":787,"./constants":1168,glslify:434}],1173:[function(r,I,B){I.exports=function(t,d,m,h){var e,f;for(h||(h=1/0),e=0;e<d.length;e++)(f=d[e]).visible&&(h=Math.min(h,f[m].length));for(h===1/0&&(h=0),t._length=h,e=0;e<d.length;e++)(f=d[e]).visible&&(f._length=h);return h}},{}],1174:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=d.numberFormat,h=r("color-rgba"),e=r("../../plots/cartesian/axes"),f=d.strRotate,l=d.strTranslate,o=r("../../lib/svg_text_utils"),u=r("../../components/drawing"),s=r("../../components/colorscale"),i=r("../../lib/gup"),c=i.keyFun,n=i.repeat,a=i.unwrap,g=r("./helpers"),p=r("./constants"),y=r("./axisbrush"),v=r("./lines");function b(X,K,Z){return d.aggNums(X,null,K,Z)}function x(X,K){return A(b(Math.min,X,K),b(Math.max,X,K))}function T(X){var K=X.range;return K?A(K[0],K[1]):x(X.values,X._length)}function A(X,K){return!isNaN(X)&&isFinite(X)||(X=0),!isNaN(K)&&isFinite(K)||(K=0),X===K&&(X===0?(X-=1,K+=1):(X*=.9,K*=1.1)),[X,K]}function S(X,K,Z,H,Y){var $,z,j=T(Z);return H?t.scale.ordinal().domain(H.map(($=m(Z.tickformat),z=Y,z?function(W,ee){var J=z[ee];return J==null?$(W):J}:$))).range(H.map(function(W){var ee=(W-j[0])/(j[1]-j[0]);return X-K+ee*(2*K-X)})):t.scale.linear().domain(j).range([X-K,K])}function w(X){if(X.tickvals){var K=T(X);return t.scale.ordinal().domain(X.tickvals).range(X.tickvals.map(function(Z){return(Z-K[0])/(K[1]-K[0])}))}}function E(X){var K=X.map(function(Y){return Y[0]}),Z=X.map(function(Y){var $=h(Y[1]);return t.rgb("rgb("+$[0]+","+$[1]+","+$[2]+")")}),H="rgb".split("").map(function(Y){return t.scale.linear().clamp(!0).domain(K).range(Z.map(($=Y,function(z){return z[$]})));var $});return function(Y){return H.map(function($){return $(Y)})}}function k(X){return X.dimensions.some(function(K){return K.brush.filterSpecified})}function L(X,K,Z){var H=a(K),Y=H.trace,$=g.convertTypedArray(H.lineColor),z=Y.line,j={color:h(p.deselectedLineColor)},W=s.extractOpts(z),ee=W.reversescale?s.flipScale(H.cscale):H.cscale,J=Y.domain,Q=Y.dimensions,te=X.width,ie=Y.labelangle,ae=Y.labelside,he=Y.labelfont,se=Y.tickfont,de=Y.rangefont,ue=d.extendDeepNoArrays({},z,{color:$.map(t.scale.linear().domain(T({values:$,range:[W.min,W.max],_length:Y._length}))),blockLineCount:p.blockLineCount,canvasOverdrag:p.overdrag*p.canvasPixelRatio}),ve=Math.floor(te*(J.x[1]-J.x[0])),ke=Math.floor(X.height*(J.y[1]-J.y[0])),Ee=X.margin||{l:80,r:80,t:100,b:80},be=ve,xe=ke;return{key:Z,colCount:Q.filter(g.isVisible).length,dimensions:Q,tickDistance:p.tickDistance,unitToColor:E(ee),lines:ue,deselectedLines:j,labelAngle:ie,labelSide:ae,labelFont:he,tickFont:se,rangeFont:de,layoutWidth:te,layoutHeight:X.height,domain:J,translateX:J.x[0]*te,translateY:X.height-J.y[1]*X.height,pad:Ee,canvasWidth:be*p.canvasPixelRatio+2*ue.canvasOverdrag,canvasHeight:xe*p.canvasPixelRatio,width:be,height:xe,canvasPixelRatio:p.canvasPixelRatio}}function M(X,K,Z){var H=Z.width,Y=Z.height,$=Z.dimensions,z=Z.canvasPixelRatio,j=function(te){return H*te/Math.max(1,Z.colCount-1)},W=p.verticalPadding/Y,ee=function(te,ie){return t.scale.linear().range([ie,te-ie])}(Y,p.verticalPadding),J={key:Z.key,xScale:j,model:Z,inBrushDrag:!1},Q={};return J.dimensions=$.filter(g.isVisible).map(function(te,ie){var ae=function(Se,ze){return t.scale.linear().domain(T(Se)).range([ze,1-ze])}(te,W),he=Q[te.label];Q[te.label]=(he||0)+1;var se=te.label+(he?"__"+he:""),de=te.constraintrange,ue=de&&de.length;ue&&!Array.isArray(de[0])&&(de=[de]);var ve=ue?de.map(function(Se){return Se.map(ae)}):[[-1/0,1/0]],ke=te.values;ke.length>te._length&&(ke=ke.slice(0,te._length));var Ee,be=te.tickvals;function xe(Se,ze){return{val:Se,text:Ee[ze]}}function ce(Se,ze){return Se.val-ze.val}if(Array.isArray(be)&&be.length){Ee=te.ticktext,Array.isArray(Ee)&&Ee.length?Ee.length>be.length?Ee=Ee.slice(0,be.length):be.length>Ee.length&&(be=be.slice(0,Ee.length)):Ee=be.map(m(te.tickformat));for(var ge=1;ge<be.length;ge++)if(be[ge]<be[ge-1]){for(var we=be.map(xe).sort(ce),Me=0;Me<be.length;Me++)be[Me]=we[Me].val,Ee[Me]=we[Me].text;break}}else be=void 0;return ke=g.convertTypedArray(ke),{key:se,label:te.label,tickFormat:te.tickformat,tickvals:be,ticktext:Ee,ordinal:g.isOrdinal(te),multiselect:te.multiselect,xIndex:ie,crossfilterDimensionIndex:ie,visibleIndex:te._index,height:Y,values:ke,paddedUnitValues:ke.map(ae),unitTickvals:be&&be.map(ae),xScale:j,x:j(ie),canvasX:j(ie)*z,unitToPaddedPx:ee,domainScale:S(Y,p.verticalPadding,te,be,Ee),ordinalScale:w(te),parent:J,model:Z,brush:y.makeBrush(X,ue,ve,function(){X.linePickActive(!1)},function(){var Se=J;Se.focusLayer&&Se.focusLayer.render(Se.panels,!0);var ze=k(Se);!X.contextShown()&&ze?(Se.contextLayer&&Se.contextLayer.render(Se.panels,!0),X.contextShown(!0)):X.contextShown()&&!ze&&(Se.contextLayer&&Se.contextLayer.render(Se.panels,!0,!0),X.contextShown(!1))},function(Se){if(J.focusLayer.render(J.panels,!0),J.pickLayer&&J.pickLayer.render(J.panels,!0),X.linePickActive(!0),K&&K.filterChanged){var ze=ae.invert,Fe=Se.map(function(Ye){return Ye.map(ze).sort(d.sorterAsc)}).sort(function(Ye,rt){return Ye[0]-rt[0]});K.filterChanged(J.key,te._index,Fe)}})}}),J}function P(X){X.classed(p.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function D(X,K){var Z=K==="top"?1:-1,H=X*Math.PI/180;return{dir:Z,dx:Math.sin(H),dy:Math.cos(H),degrees:X}}function N(X,K,Z){for(var H=K.panels||(K.panels=[]),Y=X.data(),$=0;$<Y.length-1;$++){var z=H[$]||(H[$]={}),j=Y[$],W=Y[$+1];z.dim0=j,z.dim1=W,z.canvasX=j.canvasX,z.panelSizeX=W.canvasX-j.canvasX,z.panelSizeY=K.model.canvasHeight,z.y=0,z.canvasY=0,z.plotGlPixelRatio=Z}}function U(X,K){return e.tickText(X._ax,K,!1).text}function G(X,K){if(X.ordinal)return"";var Z=X.domainScale.domain(),H=Z[K?Z.length-1:0];return U(X.model.dimensions[X.visibleIndex],H)}I.exports=function(X,K,Z,H){var Y=X._fullLayout,$=Y._toppaper,z=Y._glcontainer,j=X._context.plotGlPixelRatio,W=X._fullLayout.paper_bgcolor;(function(Me){for(var Se=0;Se<Me.length;Se++)for(var ze=0;ze<Me[Se].length;ze++)for(var Fe=Me[Se][ze].trace,Ye=Fe.dimensions,rt=0;rt<Ye.length;rt++){var Oe=Ye[rt].values,je=Ye[rt]._ax;je&&(je.range?je.range=A(je.range[0],je.range[1]):je.range=x(Oe,Fe._length),je.dtick||(je.dtick=.01*(Math.abs(je.range[1]-je.range[0])||1)),je.tickformat=Ye[rt].tickformat,e.calcTicks(je),je.cleanRange())}})(K);var ee,J,Q=(ee=!0,J=!1,{linePickActive:function(Me){return arguments.length?ee=!!Me:ee},contextShown:function(Me){return arguments.length?J=!!Me:J}}),te=K.filter(function(Me){return a(Me).trace.visible}).map(L.bind(0,Z)).map(M.bind(0,Q,H));z.each(function(Me,Se){return d.extendFlat(Me,te[Se])});var ie=z.selectAll(".gl-canvas").each(function(Me){Me.viewModel=te[0],Me.viewModel.plotGlPixelRatio=j,Me.viewModel.paperColor=W,Me.model=Me.viewModel?Me.viewModel.model:null}),ae=null;ie.filter(function(Me){return Me.pick}).style("pointer-events","auto").on("mousemove",function(Me){if(Q.linePickActive()&&Me.lineLayer&&H&&H.hover){var Se=t.event,ze=this.width,Fe=this.height,Ye=t.mouse(this),rt=Ye[0],Oe=Ye[1];if(rt<0||Oe<0||rt>=ze||Oe>=Fe)return;var je=Me.lineLayer.readPixel(rt,Fe-1-Oe),We=je[3]!==0,qe=We?je[2]+256*(je[1]+256*je[0]):null,et={x:rt,y:Oe,clientX:Se.clientX,clientY:Se.clientY,dataIndex:Me.model.key,curveNumber:qe};qe!==ae&&(We?H.hover(et):H.unhover&&H.unhover(et),ae=qe)}}),ie.style("opacity",function(Me){return Me.pick?0:1}),$.style("background","rgba(255, 255, 255, 0)");var he=$.selectAll("."+p.cn.parcoords).data(te,c);he.exit().remove(),he.enter().append("g").classed(p.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),he.attr("transform",function(Me){return l(Me.model.translateX,Me.model.translateY)});var se=he.selectAll("."+p.cn.parcoordsControlView).data(n,c);se.enter().append("g").classed(p.cn.parcoordsControlView,!0),se.attr("transform",function(Me){return l(Me.model.pad.l,Me.model.pad.t)});var de=se.selectAll("."+p.cn.yAxis).data(function(Me){return Me.dimensions},c);de.enter().append("g").classed(p.cn.yAxis,!0),se.each(function(Me){N(de,Me,j)}),ie.each(function(Me){if(Me.viewModel){!Me.lineLayer||H?Me.lineLayer=v(this,Me):Me.lineLayer.update(Me),(Me.key||Me.key===0)&&(Me.viewModel[Me.key]=Me.lineLayer);var Se=!Me.context||H;Me.lineLayer.render(Me.viewModel.panels,Se)}}),de.attr("transform",function(Me){return l(Me.xScale(Me.xIndex),0)}),de.call(t.behavior.drag().origin(function(Me){return Me}).on("drag",function(Me){var Se=Me.parent;Q.linePickActive(!1),Me.x=Math.max(-p.overdrag,Math.min(Me.model.width+p.overdrag,t.event.x)),Me.canvasX=Me.x*Me.model.canvasPixelRatio,de.sort(function(ze,Fe){return ze.x-Fe.x}).each(function(ze,Fe){ze.xIndex=Fe,ze.x=Me===ze?ze.x:ze.xScale(ze.xIndex),ze.canvasX=ze.x*ze.model.canvasPixelRatio}),N(de,Se,j),de.filter(function(ze){return Math.abs(Me.xIndex-ze.xIndex)!==0}).attr("transform",function(ze){return l(ze.xScale(ze.xIndex),0)}),t.select(this).attr("transform",l(Me.x,0)),de.each(function(ze,Fe,Ye){Ye===Me.parent.key&&(Se.dimensions[Fe]=ze)}),Se.contextLayer&&Se.contextLayer.render(Se.panels,!1,!k(Se)),Se.focusLayer.render&&Se.focusLayer.render(Se.panels)}).on("dragend",function(Me){var Se=Me.parent;Me.x=Me.xScale(Me.xIndex),Me.canvasX=Me.x*Me.model.canvasPixelRatio,N(de,Se,j),t.select(this).attr("transform",function(ze){return l(ze.x,0)}),Se.contextLayer&&Se.contextLayer.render(Se.panels,!1,!k(Se)),Se.focusLayer&&Se.focusLayer.render(Se.panels),Se.pickLayer&&Se.pickLayer.render(Se.panels,!0),Q.linePickActive(!0),H&&H.axesMoved&&H.axesMoved(Se.key,Se.dimensions.map(function(ze){return ze.crossfilterDimensionIndex}))})),de.exit().remove();var ue=de.selectAll("."+p.cn.axisOverlays).data(n,c);ue.enter().append("g").classed(p.cn.axisOverlays,!0),ue.selectAll("."+p.cn.axis).remove();var ve=ue.selectAll("."+p.cn.axis).data(n,c);ve.enter().append("g").classed(p.cn.axis,!0),ve.each(function(Me){var Se=Me.model.height/Me.model.tickDistance,ze=Me.domainScale,Fe=ze.domain();t.select(this).call(t.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(Se,Me.tickFormat).tickValues(Me.ordinal?Fe:null).tickFormat(function(Ye){return g.isOrdinal(Me)?Ye:U(Me.model.dimensions[Me.visibleIndex],Ye)}).scale(ze)),u.font(ve.selectAll("text"),Me.model.tickFont)}),ve.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),ve.selectAll("text").style("text-shadow",o.makeTextShadow(W)).style("cursor","default");var ke=ue.selectAll("."+p.cn.axisHeading).data(n,c);ke.enter().append("g").classed(p.cn.axisHeading,!0);var Ee=ke.selectAll("."+p.cn.axisTitle).data(n,c);Ee.enter().append("text").classed(p.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events","auto"),Ee.text(function(Me){return Me.label}).each(function(Me){var Se=t.select(this);u.font(Se,Me.model.labelFont),o.convertToTspans(Se,X)}).attr("transform",function(Me){var Se=D(Me.model.labelAngle,Me.model.labelSide),ze=p.axisTitleOffset;return(Se.dir>0?"":l(0,2*ze+Me.model.height))+f(Se.degrees)+l(-ze*Se.dx,-ze*Se.dy)}).attr("text-anchor",function(Me){var Se=D(Me.model.labelAngle,Me.model.labelSide);return 2*Math.abs(Se.dx)>Math.abs(Se.dy)?Se.dir*Se.dx<0?"start":"end":"middle"});var be=ue.selectAll("."+p.cn.axisExtent).data(n,c);be.enter().append("g").classed(p.cn.axisExtent,!0);var xe=be.selectAll("."+p.cn.axisExtentTop).data(n,c);xe.enter().append("g").classed(p.cn.axisExtentTop,!0),xe.attr("transform",l(0,-p.axisExtentOffset));var ce=xe.selectAll("."+p.cn.axisExtentTopText).data(n,c);ce.enter().append("text").classed(p.cn.axisExtentTopText,!0).call(P),ce.text(function(Me){return G(Me,!0)}).each(function(Me){u.font(t.select(this),Me.model.rangeFont)});var ge=be.selectAll("."+p.cn.axisExtentBottom).data(n,c);ge.enter().append("g").classed(p.cn.axisExtentBottom,!0),ge.attr("transform",function(Me){return l(0,Me.model.height+p.axisExtentOffset)});var we=ge.selectAll("."+p.cn.axisExtentBottomText).data(n,c);we.enter().append("text").classed(p.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(P),we.text(function(Me){return G(Me,!1)}).each(function(Me){u.font(t.select(this),Me.model.rangeFont)}),y.ensureAxisBrush(ue,W)}},{"../../components/colorscale":662,"../../components/drawing":672,"../../lib":787,"../../lib/gup":784,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"./axisbrush":1165,"./constants":1168,"./helpers":1170,"./lines":1172,"@plotly/d3":58,"color-rgba":133}],1175:[function(r,I,B){var t=r("./parcoords"),d=r("../../lib/prepare_regl"),m=r("./helpers").isVisible;function h(e,f,l){var o=f.indexOf(l),u=e.indexOf(o);return u===-1&&(u+=f.length),u}I.exports=function(e,f){var l=e._fullLayout;if(d(e)){var o={},u={},s={},i={},c=l._size;f.forEach(function(n,a){var g=n[0].trace;s[a]=g.index;var p=i[a]=g._fullInput.index;o[a]=e.data[p].dimensions,u[a]=e.data[p].dimensions.slice()}),t(e,f,{width:c.w,height:c.h,margin:{t:c.t,r:c.r,b:c.b,l:c.l}},{filterChanged:function(n,a,g){var p=u[n][a],y=g.map(function(S){return S.slice()}),v="dimensions["+a+"].constraintrange",b=l._tracePreGUI[e._fullData[s[n]]._fullInput.uid];if(b[v]===void 0){var x=p.constraintrange;b[v]=x||null}var T=e._fullData[s[n]].dimensions[a];y.length?(y.length===1&&(y=y[0]),p.constraintrange=y,T.constraintrange=y.slice(),y=[y]):(delete p.constraintrange,delete T.constraintrange,y=null);var A={};A[v]=y,e.emit("plotly_restyle",[A,[i[n]]])},hover:function(n){e.emit("plotly_hover",n)},unhover:function(n){e.emit("plotly_unhover",n)},axesMoved:function(n,a){var g=function(p,y){return function(v,b){return h(p,y,v)-h(p,y,b)}}(a,u[n].filter(m));o[n].sort(g),u[n].filter(function(p){return!m(p)}).sort(function(p){return u[n].indexOf(p)}).forEach(function(p){o[n].splice(o[n].indexOf(p),1),o[n].splice(u[n].indexOf(p),0,p)}),e.emit("plotly_restyle",[{dimensions:[o[n]]},[i[n]]])}})}}},{"../../lib/prepare_regl":800,"./helpers":1170,"./parcoords":1174}],1176:[function(r,I,B){var t=r("../../plots/attributes"),d=r("../../plots/domain").attributes,m=r("../../plots/font_attributes"),h=r("../../components/color/attributes"),e=r("../../plots/template_attributes").hovertemplateAttrs,f=r("../../plots/template_attributes").texttemplateAttrs,l=r("../../lib/extend").extendFlat,o=m({editType:"plot",arrayOk:!0,colorEditType:"plot"});I.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:h.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:l({},t.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:f({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:l({},o,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:l({},o,{}),outsidetextfont:l({},o,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:l({},o,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:d({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:l({},o,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":649,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/domain":866,"../../plots/font_attributes":867,"../../plots/template_attributes":910}],1177:[function(r,I,B){var t=r("../../plots/plots");B.name="pie",B.plot=function(d,m,h,e){t.plotBasePlot(B.name,d,m,h,e)},B.clean=function(d,m,h,e){t.cleanBasePlot(B.name,d,m,h,e)}},{"../../plots/plots":901}],1178:[function(r,I,B){var t=r("fast-isnumeric"),d=r("tinycolor2"),m=r("../../components/color"),h={};function e(l){return function(o,u){return!!o&&!!(o=d(o)).isValid()&&(o=m.addOpacity(o,o.getAlpha()),l[u]||(l[u]=o),o)}}function f(l,o){var u,s=JSON.stringify(l),i=o[s];if(!i){for(i=l.slice(),u=0;u<l.length;u++)i.push(d(l[u]).lighten(20).toHexString());for(u=0;u<l.length;u++)i.push(d(l[u]).darken(20).toHexString());o[s]=i}return i}I.exports={calc:function(l,o){var u,s,i=[],c=l._fullLayout,n=c.hiddenlabels||[],a=o.labels,g=o.marker.colors||[],p=o.values,y=o._length,v=o._hasValues&&y;if(o.dlabel)for(a=new Array(y),u=0;u<y;u++)a[u]=String(o.label0+u*o.dlabel);var b={},x=e(c["_"+o.type+"colormap"]),T=0,A=!1;for(u=0;u<y;u++){var S,w,E;if(v){if(S=p[u],!t(S)||(S=+S)<0)continue}else S=1;(w=a[u])!==void 0&&w!==""||(w=u);var k=b[w=String(w)];k===void 0?(b[w]=i.length,(E=n.indexOf(w)!==-1)||(T+=S),i.push({v:S,label:w,color:x(g[u],w),i:u,pts:[u],hidden:E})):(A=!0,(s=i[k]).v+=S,s.pts.push(u),s.hidden||(T+=S),s.color===!1&&g[u]&&(s.color=x(g[u],w)))}return(o.type==="funnelarea"?A:o.sort)&&i.sort(function(L,M){return M.v-L.v}),i[0]&&(i[0].vTotal=T),i},crossTraceCalc:function(l,o){var u=(o||{}).type;u||(u="pie");var s=l._fullLayout,i=l.calcdata,c=s[u+"colorway"],n=s["_"+u+"colormap"];s["extend"+u+"colors"]&&(c=f(c,h));for(var a=0,g=0;g<i.length;g++){var p=i[g];if(p[0].trace.type===u)for(var y=0;y<p.length;y++){var v=p[y];v.color===!1&&(n[v.label]?v.color=n[v.label]:(n[v.label]=v.color=c[a%c.length],a++))}}},makePullColorFn:e,generateExtendedColors:f}},{"../../components/color":650,"fast-isnumeric":246,tinycolor2:583}],1179:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("./attributes"),h=r("../../plots/domain").defaults,e=r("../bar/defaults").handleText;function f(l,o){var u=Array.isArray(l),s=d.isArrayOrTypedArray(o),i=Math.min(u?l.length:1/0,s?o.length:1/0);if(isFinite(i)||(i=0),i&&s){for(var c,n=0;n<i;n++){var a=o[n];if(t(a)&&a>0){c=!0;break}}c||(i=0)}return{hasLabels:u,hasValues:s,len:i}}I.exports={handleLabelsAndValues:f,supplyDefaults:function(l,o,u,s){function i(x,T){return d.coerce(l,o,m,x,T)}var c=f(i("labels"),i("values")),n=c.len;if(o._hasLabels=c.hasLabels,o._hasValues=c.hasValues,!o._hasLabels&&o._hasValues&&(i("label0"),i("dlabel")),n){o._length=n,i("marker.line.width")&&i("marker.line.color"),i("marker.colors"),i("scalegroup");var a,g=i("text"),p=i("texttemplate");if(p||(a=i("textinfo",Array.isArray(g)?"text+percent":"percent")),i("hovertext"),i("hovertemplate"),p||a&&a!=="none"){var y=i("textposition");e(l,o,s,i,y,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),(Array.isArray(y)||y==="auto"||y==="outside")&&i("automargin"),(y==="inside"||y==="auto"||Array.isArray(y))&&i("insidetextorientation")}h(o,s,i);var v=i("hole");if(i("title.text")){var b=i("title.position",v?"middle center":"top center");v||b!=="middle center"||(o.title.position="top center"),d.coerceFont(i,"title.font",s.font)}i("sort"),i("direction"),i("rotation"),i("pull")}else o.visible=!1}}},{"../../lib":787,"../../plots/domain":866,"../bar/defaults":929,"./attributes":1176,"fast-isnumeric":246}],1180:[function(r,I,B){var t=r("../../components/fx/helpers").appendArrayMultiPointValues;I.exports=function(d,m){var h={curveNumber:m.index,pointNumbers:d.pts,data:m._input,fullData:m,label:d.label,color:d.color,value:d.v,percent:d.percent,text:d.text,bbox:d.bbox,v:d.v};return d.pts.length===1&&(h.pointNumber=h.i=d.pts[0]),t(h,m,d.pts),m.type==="funnelarea"&&(delete h.v,delete h.i),h}},{"../../components/fx/helpers":686}],1181:[function(r,I,B){var t=r("../../lib");function d(m){return m.indexOf("e")!==-1?m.replace(/[.]?0+e/,"e"):m.indexOf(".")!==-1?m.replace(/[.]?0+$/,""):m}B.formatPiePercent=function(m,h){var e=d((100*m).toPrecision(3));return t.numSeparate(e,h)+"%"},B.formatPieValue=function(m,h){var e=d(m.toPrecision(10));return t.numSeparate(e,h)},B.getFirstFilled=function(m,h){if(Array.isArray(m))for(var e=0;e<h.length;e++){var f=m[h[e]];if(f||f===0||f==="")return f}},B.castOption=function(m,h){return Array.isArray(m)?B.getFirstFilled(m,h):m||void 0},B.getRotationAngle=function(m){return(m==="auto"?0:m)*Math.PI/180}},{"../../lib":787}],1182:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults").supplyDefaults,supplyLayoutDefaults:r("./layout_defaults"),layoutAttributes:r("./layout_attributes"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot").plot,style:r("./style"),styleOne:r("./style_one"),moduleType:"trace",name:"pie",basePlotModule:r("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":1176,"./base_plot":1177,"./calc":1178,"./defaults":1179,"./layout_attributes":1183,"./layout_defaults":1184,"./plot":1185,"./style":1186,"./style_one":1187}],1183:[function(r,I,B){I.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1184:[function(r,I,B){var t=r("../../lib"),d=r("./layout_attributes");I.exports=function(m,h){function e(f,l){return t.coerce(m,h,d,f,l)}e("hiddenlabels"),e("piecolorway",h.colorway),e("extendpiecolors")}},{"../../lib":787,"./layout_attributes":1183}],1185:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../plots/plots"),m=r("../../components/fx"),h=r("../../components/color"),e=r("../../components/drawing"),f=r("../../lib"),l=f.strScale,o=f.strTranslate,u=r("../../lib/svg_text_utils"),s=r("../bar/uniform_text"),i=s.recordMinTextSize,c=s.clearMinTextSize,n=r("../bar/constants").TEXTPAD,a=r("./helpers"),g=r("./event_data"),p=r("../../lib").isValidTextValue;function y(K,Z,H){var Y=H[0],$=Y.cx,z=Y.cy,j=Y.trace,W=j.type==="funnelarea";"_hasHoverLabel"in j||(j._hasHoverLabel=!1),"_hasHoverEvent"in j||(j._hasHoverEvent=!1),K.on("mouseover",function(ee){var J=Z._fullLayout,Q=Z._fullData[j.index];if(!Z._dragging&&J.hovermode!==!1){var te=Q.hoverinfo;if(Array.isArray(te)&&(te=m.castHoverinfo({hoverinfo:[a.castOption(te,ee.pts)],_module:j._module},J,0)),te==="all"&&(te="label+text+value+percent+name"),Q.hovertemplate||te!=="none"&&te!=="skip"&&te){var ie=ee.rInscribed||0,ae=$+ee.pxmid[0]*(1-ie),he=z+ee.pxmid[1]*(1-ie),se=J.separators,de=[];if(te&&te.indexOf("label")!==-1&&de.push(ee.label),ee.text=a.castOption(Q.hovertext||Q.text,ee.pts),te&&te.indexOf("text")!==-1){var ue=ee.text;f.isValidTextValue(ue)&&de.push(ue)}ee.value=ee.v,ee.valueLabel=a.formatPieValue(ee.v,se),te&&te.indexOf("value")!==-1&&de.push(ee.valueLabel),ee.percent=ee.v/Y.vTotal,ee.percentLabel=a.formatPiePercent(ee.percent,se),te&&te.indexOf("percent")!==-1&&de.push(ee.percentLabel);var ve=Q.hoverlabel,ke=ve.font,Ee=[];m.loneHover({trace:j,x0:ae-ie*Y.r,x1:ae+ie*Y.r,y:he,_x0:W?$+ee.TL[0]:ae-ie*Y.r,_x1:W?$+ee.TR[0]:ae+ie*Y.r,_y0:W?z+ee.TL[1]:he-ie*Y.r,_y1:W?z+ee.BL[1]:he+ie*Y.r,text:de.join("<br>"),name:Q.hovertemplate||te.indexOf("name")!==-1?Q.name:void 0,idealAlign:ee.pxmid[0]<0?"left":"right",color:a.castOption(ve.bgcolor,ee.pts)||ee.color,borderColor:a.castOption(ve.bordercolor,ee.pts),fontFamily:a.castOption(ke.family,ee.pts),fontSize:a.castOption(ke.size,ee.pts),fontColor:a.castOption(ke.color,ee.pts),nameLength:a.castOption(ve.namelength,ee.pts),textAlign:a.castOption(ve.align,ee.pts),hovertemplate:a.castOption(Q.hovertemplate,ee.pts),hovertemplateLabels:ee,eventData:[g(ee,Q)]},{container:J._hoverlayer.node(),outerContainer:J._paper.node(),gd:Z,inOut_bbox:Ee}),ee.bbox=Ee[0],j._hasHoverLabel=!0}j._hasHoverEvent=!0,Z.emit("plotly_hover",{points:[g(ee,Q)],event:t.event})}}),K.on("mouseout",function(ee){var J=Z._fullLayout,Q=Z._fullData[j.index],te=t.select(this).datum();j._hasHoverEvent&&(ee.originalEvent=t.event,Z.emit("plotly_unhover",{points:[g(te,Q)],event:t.event}),j._hasHoverEvent=!1),j._hasHoverLabel&&(m.loneUnhover(J._hoverlayer.node()),j._hasHoverLabel=!1)}),K.on("click",function(ee){var J=Z._fullLayout,Q=Z._fullData[j.index];Z._dragging||J.hovermode===!1||(Z._hoverdata=[g(ee,Q)],m.click(Z,t.event))})}function v(K,Z,H){var Y=a.castOption(K.insidetextfont.color,Z.pts);!Y&&K._input.textfont&&(Y=a.castOption(K._input.textfont.color,Z.pts));var $=a.castOption(K.insidetextfont.family,Z.pts)||a.castOption(K.textfont.family,Z.pts)||H.family,z=a.castOption(K.insidetextfont.size,Z.pts)||a.castOption(K.textfont.size,Z.pts)||H.size;return{color:Y||h.contrast(Z.color),family:$,size:z}}function b(K,Z){for(var H,Y,$=0;$<K.length;$++)if((Y=(H=K[$][0]).trace).title.text){var z=Y.title.text;Y._meta&&(z=f.templateString(z,Y._meta));var j=e.tester.append("text").attr("data-notex",1).text(z).call(e.font,Y.title.font).call(u.convertToTspans,Z),W=e.bBox(j.node(),!0);H.titleBox={width:W.width,height:W.height},j.remove()}}function x(K,Z,H){var Y=H.r||Z.rpx1,$=Z.rInscribed;if(Z.startangle===Z.stopangle)return{rCenter:1-$,scale:0,rotate:0,textPosAngle:0};var z,j=Z.ring,W=j===1&&Math.abs(Z.startangle-Z.stopangle)===2*Math.PI,ee=Z.halfangle,J=Z.midangle,Q=H.trace.insidetextorientation,te=Q==="horizontal",ie=Q==="tangential",ae=Q==="radial",he=Q==="auto",se=[];if(!he){var de,ue=function(ce,ge){if(function(ze,Fe){var Ye=ze.startangle,rt=ze.stopangle;return Ye>Fe&&Fe>rt||Ye<Fe&&Fe<rt}(Z,ce)){var we=Math.abs(ce-Z.startangle),Me=Math.abs(ce-Z.stopangle),Se=we<Me?we:Me;(z=ge==="tan"?A(K,Y,j,Se,0):T(K,Y,j,Se,Math.PI/2)).textPosAngle=ce,se.push(z)}};if(te||ie){for(de=4;de>=-4;de-=2)ue(Math.PI*de,"tan");for(de=4;de>=-4;de-=2)ue(Math.PI*(de+1),"tan")}if(te||ae){for(de=4;de>=-4;de-=2)ue(Math.PI*(de+1.5),"rad");for(de=4;de>=-4;de-=2)ue(Math.PI*(de+.5),"rad")}}if(W||he||te){var ve=Math.sqrt(K.width*K.width+K.height*K.height);if((z={scale:$*Y*2/ve,rCenter:1-$,rotate:0}).textPosAngle=(Z.startangle+Z.stopangle)/2,z.scale>=1)return z;se.push(z)}(he||ae)&&((z=T(K,Y,j,ee,J)).textPosAngle=(Z.startangle+Z.stopangle)/2,se.push(z)),(he||ie)&&((z=A(K,Y,j,ee,J)).textPosAngle=(Z.startangle+Z.stopangle)/2,se.push(z));for(var ke=0,Ee=0,be=0;be<se.length;be++){var xe=se[be].scale;if(Ee<xe&&(Ee=xe,ke=be),!he&&Ee>=1)break}return se[ke]}function T(K,Z,H,Y,$){Z=Math.max(0,Z-2*n);var z=K.width/K.height,j=E(z,Y,Z,H);return{scale:2*j/K.height,rCenter:S(z,j/Z),rotate:w($)}}function A(K,Z,H,Y,$){Z=Math.max(0,Z-2*n);var z=K.height/K.width,j=E(z,Y,Z,H);return{scale:2*j/K.width,rCenter:S(z,j/Z),rotate:w($+Math.PI/2)}}function S(K,Z){return Math.cos(Z)-K*Z}function w(K){return(180/Math.PI*K+720)%180-90}function E(K,Z,H,Y){var $=K+1/(2*Math.tan(Z));return H*Math.min(1/(Math.sqrt($*$+.5)+$),Y/(Math.sqrt(K*K+Y/2)+K))}function k(K,Z){return K.v!==Z.vTotal||Z.trace.hole?Math.min(1/(1+1/Math.sin(K.halfangle)),K.ring/2):1}function L(K,Z){var H=Z.pxmid[0],Y=Z.pxmid[1],$=K.width/2,z=K.height/2;return H<0&&($*=-1),Y<0&&(z*=-1),{scale:1,rCenter:1,rotate:0,x:$+Math.abs(z)*($>0?1:-1)/2,y:z/(1+H*H/(Y*Y)),outside:!0}}function M(K,Z){var H,Y,$,z=K.trace,j={x:K.cx,y:K.cy},W={tx:0,ty:0};W.ty+=z.title.font.size,$=D(z),z.title.position.indexOf("top")!==-1?(j.y-=(1+$)*K.r,W.ty-=K.titleBox.height):z.title.position.indexOf("bottom")!==-1&&(j.y+=(1+$)*K.r);var ee,J,Q=(ee=K.r,J=K.trace.aspectratio,ee/(J===void 0?1:J)),te=Z.w*(z.domain.x[1]-z.domain.x[0])/2;return z.title.position.indexOf("left")!==-1?(te+=Q,j.x-=(1+$)*Q,W.tx+=K.titleBox.width/2):z.title.position.indexOf("center")!==-1?te*=2:z.title.position.indexOf("right")!==-1&&(te+=Q,j.x+=(1+$)*Q,W.tx-=K.titleBox.width/2),H=te/K.titleBox.width,Y=P(K,Z)/K.titleBox.height,{x:j.x,y:j.y,scale:Math.min(H,Y),tx:W.tx,ty:W.ty}}function P(K,Z){var H=K.trace,Y=Z.h*(H.domain.y[1]-H.domain.y[0]);return Math.min(K.titleBox.height,Y/2)}function D(K){var Z,H=K.pull;if(!H)return 0;if(Array.isArray(H))for(H=0,Z=0;Z<K.pull.length;Z++)K.pull[Z]>H&&(H=K.pull[Z]);return H}function N(K,Z){for(var H=[],Y=0;Y<K.length;Y++){var $=K[Y][0],z=$.trace,j=z.domain,W=Z.w*(j.x[1]-j.x[0]),ee=Z.h*(j.y[1]-j.y[0]);z.title.text&&z.title.position!=="middle center"&&(ee-=P($,Z));var J=W/2,Q=ee/2;z.type!=="funnelarea"||z.scalegroup||(Q/=z.aspectratio),$.r=Math.min(J,Q)/(1+D(z)),$.cx=Z.l+Z.w*(z.domain.x[1]+z.domain.x[0])/2,$.cy=Z.t+Z.h*(1-z.domain.y[0])-ee/2,z.title.text&&z.title.position.indexOf("bottom")!==-1&&($.cy-=P($,Z)),z.scalegroup&&H.indexOf(z.scalegroup)===-1&&H.push(z.scalegroup)}(function(te,ie){for(var ae,he,se,de=0;de<ie.length;de++){var ue=1/0,ve=ie[de];for(he=0;he<te.length;he++)if(ae=te[he][0],(se=ae.trace).scalegroup===ve){var ke;if(se.type==="pie")ke=ae.r*ae.r;else if(se.type==="funnelarea"){var Ee,be;se.aspectratio>1?(Ee=ae.r,be=Ee/se.aspectratio):(be=ae.r,Ee=be*se.aspectratio),Ee*=(1+se.baseratio)/2,ke=Ee*be}ue=Math.min(ue,ke/ae.vTotal)}for(he=0;he<te.length;he++)if(ae=te[he][0],(se=ae.trace).scalegroup===ve){var xe=ue*ae.vTotal;se.type==="funnelarea"&&(xe/=(1+se.baseratio)/2,xe/=se.aspectratio),ae.r=Math.sqrt(xe)}}})(K,H)}function U(K,Z){return[K*Math.sin(Z),-K*Math.cos(Z)]}function G(K,Z,H){var Y=K._fullLayout,$=H.trace,z=$.texttemplate,j=$.textinfo;if(!z&&j&&j!=="none"){var W,ee=j.split("+"),J=function(ke){return ee.indexOf(ke)!==-1},Q=J("label"),te=J("text"),ie=J("value"),ae=J("percent"),he=Y.separators;if(W=Q?[Z.label]:[],te){var se=a.getFirstFilled($.text,Z.pts);p(se)&&W.push(se)}ie&&W.push(a.formatPieValue(Z.v,he)),ae&&W.push(a.formatPiePercent(Z.v/H.vTotal,he)),Z.text=W.join("<br>")}if(z){var de=f.castOption($,Z.i,"texttemplate");if(de){var ue=function(ke){return{label:ke.label,value:ke.v,valueLabel:a.formatPieValue(ke.v,Y.separators),percent:ke.v/H.vTotal,percentLabel:a.formatPiePercent(ke.v/H.vTotal,Y.separators),color:ke.color,text:ke.text,customdata:f.castOption($,ke.i,"customdata")}}(Z),ve=a.getFirstFilled($.text,Z.pts);(p(ve)||ve==="")&&(ue.text=ve),Z.text=f.texttemplateString(de,ue,K._fullLayout._d3locale,ue,$._meta||{})}else Z.text=""}}function X(K,Z){var H=K.rotate*Math.PI/180,Y=Math.cos(H),$=Math.sin(H),z=(Z.left+Z.right)/2,j=(Z.top+Z.bottom)/2;K.textX=z*Y-j*$,K.textY=z*$+j*Y,K.noCenter=!0}I.exports={plot:function(K,Z){var H=K._fullLayout,Y=H._size;c("pie",H),b(Z,K),N(Z,Y);var $=f.makeTraceGroups(H._pielayer,Z,"trace").each(function(z){var j=t.select(this),W=z[0],ee=W.trace;(function(J){var Q,te,ie,ae=J[0],he=ae.r,se=ae.trace,de=a.getRotationAngle(se.rotation),ue=2*Math.PI/ae.vTotal,ve="px0",ke="px1";if(se.direction==="counterclockwise"){for(Q=0;Q<J.length&&J[Q].hidden;Q++);if(Q===J.length)return;de+=ue*J[Q].v,ue*=-1,ve="px1",ke="px0"}for(ie=U(he,de),Q=0;Q<J.length;Q++)(te=J[Q]).hidden||(te[ve]=ie,te.startangle=de,de+=ue*te.v/2,te.pxmid=U(he,de),te.midangle=de,de+=ue*te.v/2,ie=U(he,de),te.stopangle=de,te[ke]=ie,te.largeArc=te.v>ae.vTotal/2?1:0,te.halfangle=Math.PI*Math.min(te.v/ae.vTotal,.5),te.ring=1-se.hole,te.rInscribed=k(te,ae))})(z),j.attr("stroke-linejoin","round"),j.each(function(){var J=t.select(this).selectAll("g.slice").data(z);J.enter().append("g").classed("slice",!0),J.exit().remove();var Q=[[[],[]],[[],[]]],te=!1;J.each(function(ke,Ee){if(ke.hidden)t.select(this).selectAll("path,g").remove();else{ke.pointNumber=ke.i,ke.curveNumber=ee.index,Q[ke.pxmid[1]<0?0:1][ke.pxmid[0]<0?0:1].push(ke);var be=W.cx,xe=W.cy,ce=t.select(this),ge=ce.selectAll("path.surface").data([ke]);if(ge.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),ce.call(y,K,z),ee.pull){var we=+a.castOption(ee.pull,ke.pts)||0;we>0&&(be+=we*ke.pxmid[0],xe+=we*ke.pxmid[1])}ke.cxFinal=be,ke.cyFinal=xe;var Me=ee.hole;if(ke.v===W.vTotal){var Se="M"+(be+ke.px0[0])+","+(xe+ke.px0[1])+Oe(ke.px0,ke.pxmid,!0,1)+Oe(ke.pxmid,ke.px0,!0,1)+"Z";Me?ge.attr("d","M"+(be+Me*ke.px0[0])+","+(xe+Me*ke.px0[1])+Oe(ke.px0,ke.pxmid,!1,Me)+Oe(ke.pxmid,ke.px0,!1,Me)+"Z"+Se):ge.attr("d",Se)}else{var ze=Oe(ke.px0,ke.px1,!0,1);if(Me){var Fe=1-Me;ge.attr("d","M"+(be+Me*ke.px1[0])+","+(xe+Me*ke.px1[1])+Oe(ke.px1,ke.px0,!1,Me)+"l"+Fe*ke.px0[0]+","+Fe*ke.px0[1]+ze+"Z")}else ge.attr("d","M"+be+","+xe+"l"+ke.px0[0]+","+ke.px0[1]+ze+"Z")}G(K,ke,W);var Ye=a.castOption(ee.textposition,ke.pts),rt=ce.selectAll("g.slicetext").data(ke.text&&Ye!=="none"?[0]:[]);rt.enter().append("g").classed("slicetext",!0),rt.exit().remove(),rt.each(function(){var je=f.ensureSingle(t.select(this),"text","",function(at){at.attr("data-notex",1)}),We=f.ensureUniformFontSize(K,Ye==="outside"?function(at,tt,_t){var er=a.castOption(at.outsidetextfont.color,tt.pts)||a.castOption(at.textfont.color,tt.pts)||_t.color,tr=a.castOption(at.outsidetextfont.family,tt.pts)||a.castOption(at.textfont.family,tt.pts)||_t.family,Ue=a.castOption(at.outsidetextfont.size,tt.pts)||a.castOption(at.textfont.size,tt.pts)||_t.size;return{color:er,family:tr,size:Ue}}(ee,ke,H.font):v(ee,ke,H.font));je.text(ke.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,We).call(u.convertToTspans,K);var qe,et=e.bBox(je.node());if(Ye==="outside")qe=L(et,ke);else if(qe=x(et,ke,W),Ye==="auto"&&qe.scale<1){var st=f.ensureUniformFontSize(K,ee.outsidetextfont);je.call(e.font,st),qe=L(et=e.bBox(je.node()),ke)}var ct=qe.textPosAngle,Pt=ct===void 0?ke.pxmid:U(W.r,ct);if(qe.targetX=be+Pt[0]*qe.rCenter+(qe.x||0),qe.targetY=xe+Pt[1]*qe.rCenter+(qe.y||0),X(qe,et),qe.outside){var kt=qe.targetY;ke.yLabelMin=kt-et.height/2,ke.yLabelMid=kt,ke.yLabelMax=kt+et.height/2,ke.labelExtraX=0,ke.labelExtraY=0,te=!0}qe.fontSize=We.size,i(ee.type,qe,H),z[Ee].transform=qe,je.attr("transform",f.getTextTransform(qe))})}function Oe(je,We,qe,et){var st=et*(We[0]-je[0]),ct=et*(We[1]-je[1]);return"a"+et*W.r+","+et*W.r+" 0 "+ke.largeArc+(qe?" 1 ":" 0 ")+st+","+ct}});var ie=t.select(this).selectAll("g.titletext").data(ee.title.text?[0]:[]);if(ie.enter().append("g").classed("titletext",!0),ie.exit().remove(),ie.each(function(){var ke,Ee=f.ensureSingle(t.select(this),"text","",function(xe){xe.attr("data-notex",1)}),be=ee.title.text;ee._meta&&(be=f.templateString(be,ee._meta)),Ee.text(be).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,ee.title.font).call(u.convertToTspans,K),ke=ee.title.position==="middle center"?function(xe){var ce=Math.sqrt(xe.titleBox.width*xe.titleBox.width+xe.titleBox.height*xe.titleBox.height);return{x:xe.cx,y:xe.cy,scale:xe.trace.hole*xe.r*2/ce,tx:0,ty:-xe.titleBox.height/2+xe.trace.title.font.size}}(W):M(W,Y),Ee.attr("transform",o(ke.x,ke.y)+l(Math.min(1,ke.scale))+o(ke.tx,ke.ty))}),te&&function(ke,Ee){var be,xe,ce,ge,we,Me,Se,ze,Fe,Ye,rt,Oe,je;function We(ct,Pt){return ct.pxmid[1]-Pt.pxmid[1]}function qe(ct,Pt){return Pt.pxmid[1]-ct.pxmid[1]}function et(ct,Pt){Pt||(Pt={});var kt,at,tt,_t,er=Pt.labelExtraY+(xe?Pt.yLabelMax:Pt.yLabelMin),tr=xe?ct.yLabelMin:ct.yLabelMax,Ue=xe?ct.yLabelMax:ct.yLabelMin,He=ct.cyFinal+we(ct.px0[1],ct.px1[1]),Be=er-tr;if(Be*Se>0&&(ct.labelExtraY=Be),Array.isArray(Ee.pull))for(at=0;at<Ye.length;at++)(tt=Ye[at])===ct||(a.castOption(Ee.pull,ct.pts)||0)>=(a.castOption(Ee.pull,tt.pts)||0)||((ct.pxmid[1]-tt.pxmid[1])*Se>0?(Be=tt.cyFinal+we(tt.px0[1],tt.px1[1])-tr-ct.labelExtraY)*Se>0&&(ct.labelExtraY+=Be):(Ue+ct.labelExtraY-He)*Se>0&&(kt=3*Me*Math.abs(at-Ye.indexOf(ct)),(_t=tt.cxFinal+ge(tt.px0[0],tt.px1[0])+kt-(ct.cxFinal+ct.pxmid[0])-ct.labelExtraX)*Me>0&&(ct.labelExtraX+=_t)))}for(xe=0;xe<2;xe++)for(ce=xe?We:qe,we=xe?Math.max:Math.min,Se=xe?1:-1,be=0;be<2;be++){for(ge=be?Math.max:Math.min,Me=be?1:-1,(ze=ke[xe][be]).sort(ce),Fe=ke[1-xe][be],Ye=Fe.concat(ze),Oe=[],rt=0;rt<ze.length;rt++)ze[rt].yLabelMid!==void 0&&Oe.push(ze[rt]);for(je=!1,rt=0;xe&&rt<Fe.length;rt++)if(Fe[rt].yLabelMid!==void 0){je=Fe[rt];break}for(rt=0;rt<Oe.length;rt++){var st=rt&&Oe[rt-1];je&&!rt&&(st=je),et(Oe[rt],st)}}}(Q,ee),function(ke,Ee){ke.each(function(be){var xe=t.select(this);if(be.labelExtraX||be.labelExtraY){var ce=xe.select("g.slicetext text");be.transform.targetX+=be.labelExtraX,be.transform.targetY+=be.labelExtraY,ce.attr("transform",f.getTextTransform(be.transform));var ge=be.cxFinal+be.pxmid[0],we="M"+ge+","+(be.cyFinal+be.pxmid[1]),Me=(be.yLabelMax-be.yLabelMin)*(be.pxmid[0]<0?-1:1)/4;if(be.labelExtraX){var Se=be.labelExtraX*be.pxmid[1]/be.pxmid[0],ze=be.yLabelMid+be.labelExtraY-(be.cyFinal+be.pxmid[1]);Math.abs(Se)>Math.abs(ze)?we+="l"+ze*be.pxmid[0]/be.pxmid[1]+","+ze+"H"+(ge+be.labelExtraX+Me):we+="l"+be.labelExtraX+","+Se+"v"+(ze-Se)+"h"+Me}else we+="V"+(be.yLabelMid+be.labelExtraY)+"h"+Me;f.ensureSingle(xe,"path","textline").call(h.stroke,Ee.outsidetextfont.color).attr({"stroke-width":Math.min(2,Ee.outsidetextfont.size/8),d:we,fill:"none"})}else xe.select("path.textline").remove()})}(J,ee),te&&ee.automargin){var ae=e.bBox(j.node()),he=ee.domain,se=Y.w*(he.x[1]-he.x[0]),de=Y.h*(he.y[1]-he.y[0]),ue=(.5*se-W.r)/Y.w,ve=(.5*de-W.r)/Y.h;d.autoMargin(K,"pie."+ee.uid+".automargin",{xl:he.x[0]-ue,xr:he.x[1]+ue,yb:he.y[0]-ve,yt:he.y[1]+ve,l:Math.max(W.cx-W.r-ae.left,0),r:Math.max(ae.right-(W.cx+W.r),0),b:Math.max(ae.bottom-(W.cy+W.r),0),t:Math.max(W.cy-W.r-ae.top,0),pad:5})}})});setTimeout(function(){$.selectAll("tspan").each(function(){var z=t.select(this);z.attr("dy")&&z.attr("dy",z.attr("dy"))})},0)},formatSliceLabel:G,transformInsideText:x,determineInsideTextFont:v,positionTitleOutside:M,prerenderTitles:b,layoutAreas:N,attachFxHandlers:y,computeTransform:X}},{"../../components/color":650,"../../components/drawing":672,"../../components/fx":690,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/plots":901,"../bar/constants":927,"../bar/uniform_text":941,"./event_data":1180,"./helpers":1181,"@plotly/d3":58}],1186:[function(r,I,B){var t=r("@plotly/d3"),d=r("./style_one"),m=r("../bar/uniform_text").resizeText;I.exports=function(h){var e=h._fullLayout._pielayer.selectAll(".trace");m(h,e,"pie"),e.each(function(f){var l=f[0].trace,o=t.select(this);o.style({opacity:l.opacity}),o.selectAll("path.surface").each(function(u){t.select(this).call(d,u,l)})})}},{"../bar/uniform_text":941,"./style_one":1187,"@plotly/d3":58}],1187:[function(r,I,B){var t=r("../../components/color"),d=r("./helpers").castOption;I.exports=function(m,h,e){var f=e.marker.line,l=d(f.color,h.pts)||t.defaultLine,o=d(f.width,h.pts)||0;m.style("stroke-width",o).call(t.fill,h.color).call(t.stroke,l)}},{"../../components/color":650,"./helpers":1181}],1188:[function(r,I,B){var t=r("../scatter/attributes");I.exports={x:t.x,y:t.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:t.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":1202}],1189:[function(r,I,B){var t=r("gl-pointcloud2d"),d=r("../../lib/str2rgbarray"),m=r("../../plots/cartesian/autorange").findExtremes,h=r("../scatter/get_trace_color");function e(l,o){this.scene=l,this.uid=o,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=t(l.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var f=e.prototype;f.handlePick=function(l){var o=this.idToIndex[l.pointId];return{trace:this,dataCoord:l.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*o],this.pickXYData[2*o+1]]:[this.pickXData[o],this.pickYData[o]],textLabel:Array.isArray(this.textLabels)?this.textLabels[o]:this.textLabels,color:this.color,name:this.name,pointIndex:o,hoverinfo:this.hoverinfo}},f.update=function(l){this.index=l.index,this.textLabels=l.text,this.name=l.name,this.hoverinfo=l.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(l),this.color=h(l,{})},f.updateFast=function(l){var o,u,s,i,c,n,a=this.xData=this.pickXData=l.x,g=this.yData=this.pickYData=l.y,p=this.pickXYData=l.xy,y=l.xbounds&&l.ybounds,v=l.indices,b=this.bounds;if(p){if(s=p,o=p.length>>>1,y)b[0]=l.xbounds[0],b[2]=l.xbounds[1],b[1]=l.ybounds[0],b[3]=l.ybounds[1];else for(n=0;n<o;n++)i=s[2*n],c=s[2*n+1],i<b[0]&&(b[0]=i),i>b[2]&&(b[2]=i),c<b[1]&&(b[1]=c),c>b[3]&&(b[3]=c);if(v)u=v;else for(u=new Int32Array(o),n=0;n<o;n++)u[n]=n}else for(o=a.length,s=new Float32Array(2*o),u=new Int32Array(o),n=0;n<o;n++)i=a[n],c=g[n],u[n]=n,s[2*n]=i,s[2*n+1]=c,i<b[0]&&(b[0]=i),i>b[2]&&(b[2]=i),c<b[1]&&(b[1]=c),c>b[3]&&(b[3]=c);this.idToIndex=u,this.pointcloudOptions.idToIndex=u,this.pointcloudOptions.positions=s;var x=d(l.marker.color),T=d(l.marker.border.color),A=l.opacity*l.marker.opacity;x[3]*=A,this.pointcloudOptions.color=x;var S=l.marker.blend;S===null&&(S=a.length<100||g.length<100),this.pointcloudOptions.blend=S,T[3]*=A,this.pointcloudOptions.borderColor=T;var w=l.marker.sizemin,E=Math.max(l.marker.sizemax,l.marker.sizemin);this.pointcloudOptions.sizeMin=w,this.pointcloudOptions.sizeMax=E,this.pointcloudOptions.areaRatio=l.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var k=this.scene.xaxis,L=this.scene.yaxis,M=E/2||.5;l._extremes[k._id]=m(k,[b[0],b[2]],{ppad:M}),l._extremes[L._id]=m(L,[b[1],b[3]],{ppad:M})},f.dispose=function(){this.pointcloud.dispose()},I.exports=function(l,o){var u=new e(l,o.uid);return u.update(o),u}},{"../../lib/str2rgbarray":812,"../../plots/cartesian/autorange":837,"../scatter/get_trace_color":1212,"gl-pointcloud2d":321}],1190:[function(r,I,B){var t=r("../../lib"),d=r("./attributes");I.exports=function(m,h,e){function f(l,o){return t.coerce(m,h,d,l,o)}f("x"),f("y"),f("xbounds"),f("ybounds"),m.xy&&m.xy instanceof Float32Array&&(h.xy=m.xy),m.indices&&m.indices instanceof Int32Array&&(h.indices=m.indices),f("text"),f("marker.color",e),f("marker.opacity"),f("marker.blend"),f("marker.sizemin"),f("marker.sizemax"),f("marker.border.color",e),f("marker.border.arearatio"),h._length=null}},{"../../lib":787,"./attributes":1188}],1191:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("../scatter3d/calc"),plot:r("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:r("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":878,"../scatter3d/calc":1231,"./attributes":1188,"./convert":1189,"./defaults":1190}],1192:[function(r,I,B){var t=r("../../plots/font_attributes"),d=r("../../plots/attributes"),m=r("../../components/color/attributes"),h=r("../../components/fx/attributes"),e=r("../../plots/domain").attributes,f=r("../../plots/template_attributes").hovertemplateAttrs,l=r("../../components/colorscale/attributes"),o=r("../../plot_api/plot_template").templatedArray,u=r("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,s=r("../../lib/extend").extendFlat,i=r("../../plot_api/edit_types").overrideAll;(I.exports=i({hoverinfo:s({},d.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:h.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:u("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:t({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:m.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:h.hoverlabel,hovertemplate:f({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:m.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:h.hoverlabel,hovertemplate:f({},{keys:["value","label"]}),colorscales:o("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:s(l().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested")).transforms=void 0},{"../../components/color/attributes":649,"../../components/colorscale/attributes":657,"../../components/fx/attributes":681,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/domain":866,"../../plots/font_attributes":867,"../../plots/template_attributes":910}],1193:[function(r,I,B){var t=r("../../plot_api/edit_types").overrideAll,d=r("../../plots/get_data").getModuleCalcData,m=r("./plot"),h=r("../../components/fx/layout_attributes"),e=r("../../lib/setcursor"),f=r("../../components/dragelement"),l=r("../../plots/cartesian/select").prepSelect,o=r("../../lib"),u=r("../../registry");function s(i,c){var n=i._fullData[c],a=i._fullLayout,g=a.dragmode,p=a.dragmode==="pan"?"move":"crosshair",y=n._bgRect;if(g!=="pan"&&g!=="zoom"){e(y,p);var v={_id:"x",c2p:o.identity,_offset:n._sankey.translateX,_length:n._sankey.width},b={_id:"y",c2p:o.identity,_offset:n._sankey.translateY,_length:n._sankey.height},x={gd:i,element:y.node(),plotinfo:{id:c,xaxis:v,yaxis:b,fillRangeItems:o.noop},subplot:c,xaxes:[v],yaxes:[b],doneFnCompleted:function(T){var A,S=i._fullData[c],w=S.node.groups.slice(),E=[];function k(D){for(var N=S._sankey.graph.nodes,U=0;U<N.length;U++)if(N[U].pointNumber===D)return N[U]}for(var L=0;L<T.length;L++){var M=k(T[L].pointNumber);if(M)if(M.group){for(var P=0;P<M.childrenNodes.length;P++)E.push(M.childrenNodes[P].pointNumber);w[M.pointNumber-S.node._count]=!1}else E.push(M.pointNumber)}A=w.filter(Boolean).concat([E]),u.call("_guiRestyle",i,{"node.groups":[A]},c)},prepFn:function(T,A,S){l(T,A,S,x,g)}};f.init(x)}}B.name="sankey",B.baseLayoutAttrOverrides=t({hoverlabel:h.hoverlabel},"plot","nested"),B.plot=function(i){var c=d(i.calcdata,"sankey")[0];m(i,c),B.updateFx(i)},B.clean=function(i,c,n,a){var g=a._has&&a._has("sankey"),p=c._has&&c._has("sankey");g&&!p&&(a._paperdiv.selectAll(".sankey").remove(),a._paperdiv.selectAll(".bgsankey").remove())},B.updateFx=function(i){for(var c=0;c<i._fullData.length;c++)s(i,c)}},{"../../components/dragelement":669,"../../components/fx/layout_attributes":691,"../../lib":787,"../../lib/setcursor":808,"../../plot_api/edit_types":820,"../../plots/cartesian/select":858,"../../plots/get_data":875,"../../registry":915,"./plot":1198}],1194:[function(r,I,B){var t=r("strongly-connected-components"),d=r("../../lib"),m=r("../../lib/gup").wrap,h=d.isArrayOrTypedArray,e=d.isIndex,f=r("../../components/colorscale");function l(o){var u,s=o.node,i=o.link,c=[],n=h(i.color),a=h(i.customdata),g={},p={},y=i.colorscales.length;for(u=0;u<y;u++){var v=i.colorscales[u],b=f.extractScale(v,{cLetter:"c"}),x=f.makeColorScaleFunc(b);p[v.label]=x}var T=0;for(u=0;u<i.value.length;u++)i.source[u]>T&&(T=i.source[u]),i.target[u]>T&&(T=i.target[u]);var A,S=T+1;o.node._count=S;var w=o.node.groups,E={};for(u=0;u<w.length;u++){var k=w[u];for(A=0;A<k.length;A++){var L=k[A],M=S+u;E.hasOwnProperty(L)?d.warn("Node "+L+" is already part of a group."):E[L]=M}}var P={source:[],target:[]};for(u=0;u<i.value.length;u++){var D=i.value[u],N=i.source[u],U=i.target[u];if(D>0&&e(N,S)&&e(U,S)&&(!E.hasOwnProperty(N)||!E.hasOwnProperty(U)||E[N]!==E[U])){E.hasOwnProperty(U)&&(U=E[U]),E.hasOwnProperty(N)&&(N=E[N]),U=+U,g[N=+N]=g[U]=!0;var G="";i.label&&i.label[u]&&(G=i.label[u]);var X=null;G&&p.hasOwnProperty(G)&&(X=p[G]),c.push({pointNumber:u,label:G,color:n?i.color[u]:i.color,customdata:a?i.customdata[u]:i.customdata,concentrationscale:X,source:N,target:U,value:+D}),P.source.push(N),P.target.push(U)}}var K=S+w.length,Z=h(s.color),H=h(s.customdata),Y=[];for(u=0;u<K;u++)if(g[u]){var $=s.label[u];Y.push({group:u>S-1,childrenNodes:[],pointNumber:u,label:$,color:Z?s.color[u]:s.color,customdata:H?s.customdata[u]:s.customdata})}var z=!1;return function(j,W,ee){for(var J=d.init2dArray(j,0),Q=0;Q<Math.min(W.length,ee.length);Q++)if(d.isIndex(W[Q],j)&&d.isIndex(ee[Q],j)){if(W[Q]===ee[Q])return!0;J[W[Q]].push(ee[Q])}return t(J).components.some(function(te){return te.length>1})}(K,P.source,P.target)&&(z=!0),{circular:z,links:c,nodes:Y,groups:w,groupLookup:E}}I.exports=function(o,u){var s=l(u);return m({circular:s.circular,_nodes:s.nodes,_links:s.links,_groups:s.groups,_groupLookup:s.groupLookup})}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gup":784,"strongly-connected-components":575}],1195:[function(r,I,B){I.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],1196:[function(r,I,B){var t=r("../../lib"),d=r("./attributes"),m=r("../../components/color"),h=r("tinycolor2"),e=r("../../plots/domain").defaults,f=r("../../components/fx/hoverlabel_defaults"),l=r("../../plot_api/plot_template"),o=r("../../plots/array_container_defaults");function u(s,i){function c(n,a){return t.coerce(s,i,d.link.colorscales,n,a)}c("label"),c("cmin"),c("cmax"),c("colorscale")}I.exports=function(s,i,c,n){function a(E,k){return t.coerce(s,i,d,E,k)}var g=t.extendDeep(n.hoverlabel,s.hoverlabel),p=s.node,y=l.newContainer(i,"node");function v(E,k){return t.coerce(p,y,d.node,E,k)}v("label"),v("groups"),v("x"),v("y"),v("pad"),v("thickness"),v("line.color"),v("line.width"),v("hoverinfo",s.hoverinfo),f(p,y,v,g),v("hovertemplate");var b=n.colorway;v("color",y.label.map(function(E,k){return m.addOpacity(function(L){return b[L%b.length]}(k),.8)})),v("customdata");var x=s.link||{},T=l.newContainer(i,"link");function A(E,k){return t.coerce(x,T,d.link,E,k)}A("label"),A("source"),A("target"),A("value"),A("line.color"),A("line.width"),A("hoverinfo",s.hoverinfo),f(x,T,A,g),A("hovertemplate");var S,w=h(n.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";A("color",t.repeat(w,T.value.length)),A("customdata"),o(x,T,{name:"colorscales",handleItemDefaults:u}),e(i,n,a),a("orientation"),a("valueformat"),a("valuesuffix"),y.x.length&&y.y.length&&(S="freeform"),a("arrangement",S),t.coerceFont(a,"textfont",t.extendFlat({},n.font)),i._length=null}},{"../../components/color":650,"../../components/fx/hoverlabel_defaults":688,"../../lib":787,"../../plot_api/plot_template":827,"../../plots/array_container_defaults":833,"../../plots/domain":866,"./attributes":1192,tinycolor2:583}],1197:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),moduleType:"trace",name:"sankey",basePlotModule:r("./base_plot"),selectPoints:r("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":1192,"./base_plot":1193,"./calc":1194,"./defaults":1196,"./plot":1198,"./select.js":1200}],1198:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=d.numberFormat,h=r("./render"),e=r("../../components/fx"),f=r("../../components/color"),l=r("./constants").cn,o=d._;function u(x){return x!==""}function s(x,T){return x.filter(function(A){return A.key===T.traceId})}function i(x,T){t.select(x).select("path").style("fill-opacity",T),t.select(x).select("rect").style("fill-opacity",T)}function c(x){t.select(x).select("text.name").style("fill","black")}function n(x){return function(T){return x.node.sourceLinks.indexOf(T.link)!==-1||x.node.targetLinks.indexOf(T.link)!==-1}}function a(x){return function(T){return T.node.sourceLinks.indexOf(x.link)!==-1||T.node.targetLinks.indexOf(x.link)!==-1}}function g(x,T,A){T&&A&&s(A,T).selectAll("."+l.sankeyLink).filter(n(T)).call(y.bind(0,T,A,!1))}function p(x,T,A){T&&A&&s(A,T).selectAll("."+l.sankeyLink).filter(n(T)).call(v.bind(0,T,A,!1))}function y(x,T,A,S){var w=S.datum().link.label;S.style("fill-opacity",function(E){if(!E.link.concentrationscale)return .4}),w&&s(T,x).selectAll("."+l.sankeyLink).filter(function(E){return E.link.label===w}).style("fill-opacity",function(E){if(!E.link.concentrationscale)return .4}),A&&s(T,x).selectAll("."+l.sankeyNode).filter(a(x)).call(g)}function v(x,T,A,S){var w=S.datum().link.label;S.style("fill-opacity",function(E){return E.tinyColorAlpha}),w&&s(T,x).selectAll("."+l.sankeyLink).filter(function(E){return E.link.label===w}).style("fill-opacity",function(E){return E.tinyColorAlpha}),A&&s(T,x).selectAll(l.sankeyNode).filter(a(x)).call(p)}function b(x,T){var A=x.hoverlabel||{},S=d.nestedProperty(A,T).get();return!Array.isArray(S)&&S}I.exports=function(x,T){for(var A=x._fullLayout,S=A._paper,w=A._size,E=0;E<x._fullData.length;E++)if(x._fullData[E].visible&&x._fullData[E].type===l.sankey&&!x._fullData[E]._viewInitial){var k=x._fullData[E].node;x._fullData[E]._viewInitial={node:{groups:k.groups.slice(),x:k.x.slice(),y:k.y.slice()}}}var L=o(x,"source:")+" ",M=o(x,"target:")+" ",P=o(x,"concentration:")+" ",D=o(x,"incoming flow count:")+" ",N=o(x,"outgoing flow count:")+" ";h(x,S,T,{width:w.w,height:w.h,margin:{t:w.t,r:w.r,b:w.b,l:w.l}},{linkEvents:{hover:function(U,G,X){x._fullLayout.hovermode!==!1&&(t.select(U).call(y.bind(0,G,X,!0)),G.link.trace.link.hoverinfo!=="skip"&&(G.link.fullData=G.link.trace,x.emit("plotly_hover",{event:t.event,points:[G.link]})))},follow:function(U,G){if(x._fullLayout.hovermode!==!1){var X=G.link.trace.link;if(X.hoverinfo!=="none"&&X.hoverinfo!=="skip"){for(var K=[],Z=0,H=0;H<G.flow.links.length;H++){var Y=G.flow.links[H];if(x._fullLayout.hovermode!=="closest"||G.link.pointNumber===Y.pointNumber){G.link.pointNumber===Y.pointNumber&&(Z=H),Y.fullData=Y.trace,X=G.link.trace.link;var $=j(Y),z={valueLabel:m(G.valueFormat)(Y.value)+G.valueSuffix};K.push({x:$[0],y:$[1],name:z.valueLabel,text:[Y.label||"",L+Y.source.label,M+Y.target.label,Y.concentrationscale?P+m("%0.2f")(Y.flow.labelConcentration):""].filter(u).join("<br>"),color:b(X,"bgcolor")||f.addOpacity(Y.color,1),borderColor:b(X,"bordercolor"),fontFamily:b(X,"font.family"),fontSize:b(X,"font.size"),fontColor:b(X,"font.color"),nameLength:b(X,"namelength"),textAlign:b(X,"align"),idealAlign:t.event.x<$[0]?"right":"left",hovertemplate:X.hovertemplate,hovertemplateLabels:z,eventData:[Y]})}}e.loneHover(K,{container:A._hoverlayer.node(),outerContainer:A._paper.node(),gd:x,anchorIndex:Z}).each(function(){G.link.concentrationscale||i(this,.65),c(this)})}}function j(W){var ee,J;W.circular?(ee=(W.circularPathData.leftInnerExtent+W.circularPathData.rightInnerExtent)/2,J=W.circularPathData.verticalFullExtent):(ee=(W.source.x1+W.target.x0)/2,J=(W.y0+W.y1)/2);var Q=[ee,J];return W.trace.orientation==="v"&&Q.reverse(),Q[0]+=G.parent.translateX,Q[1]+=G.parent.translateY,Q}},unhover:function(U,G,X){x._fullLayout.hovermode!==!1&&(t.select(U).call(v.bind(0,G,X,!0)),G.link.trace.link.hoverinfo!=="skip"&&(G.link.fullData=G.link.trace,x.emit("plotly_unhover",{event:t.event,points:[G.link]})),e.loneUnhover(A._hoverlayer.node()))},select:function(U,G){var X=G.link;X.originalEvent=t.event,x._hoverdata=[X],e.click(x,{target:!0})}},nodeEvents:{hover:function(U,G,X){x._fullLayout.hovermode!==!1&&(t.select(U).call(g,G,X),G.node.trace.node.hoverinfo!=="skip"&&(G.node.fullData=G.node.trace,x.emit("plotly_hover",{event:t.event,points:[G.node]})))},follow:function(U,G){if(x._fullLayout.hovermode!==!1){var X=G.node.trace.node;if(X.hoverinfo!=="none"&&X.hoverinfo!=="skip"){var K=t.select(U).select("."+l.nodeRect),Z=x._fullLayout._paperdiv.node().getBoundingClientRect(),H=K.node().getBoundingClientRect(),Y=H.left-2-Z.left,$=H.right+2-Z.left,z=H.top+H.height/4-Z.top,j={valueLabel:m(G.valueFormat)(G.node.value)+G.valueSuffix};G.node.fullData=G.node.trace,x._fullLayout._calcInverseTransform(x);var W=x._fullLayout._invScaleX,ee=x._fullLayout._invScaleY,J=e.loneHover({x0:W*Y,x1:W*$,y:ee*z,name:m(G.valueFormat)(G.node.value)+G.valueSuffix,text:[G.node.label,D+G.node.targetLinks.length,N+G.node.sourceLinks.length].filter(u).join("<br>"),color:b(X,"bgcolor")||G.tinyColorHue,borderColor:b(X,"bordercolor"),fontFamily:b(X,"font.family"),fontSize:b(X,"font.size"),fontColor:b(X,"font.color"),nameLength:b(X,"namelength"),textAlign:b(X,"align"),idealAlign:"left",hovertemplate:X.hovertemplate,hovertemplateLabels:j,eventData:[G.node]},{container:A._hoverlayer.node(),outerContainer:A._paper.node(),gd:x});i(J,.85),c(J)}}},unhover:function(U,G,X){x._fullLayout.hovermode!==!1&&(t.select(U).call(p,G,X),G.node.trace.node.hoverinfo!=="skip"&&(G.node.fullData=G.node.trace,x.emit("plotly_unhover",{event:t.event,points:[G.node]})),e.loneUnhover(A._hoverlayer.node()))},select:function(U,G,X){var K=G.node;K.originalEvent=t.event,x._hoverdata=[K],t.select(U).call(p,G,X),e.click(x,{target:!0})}}})}},{"../../components/color":650,"../../components/fx":690,"../../lib":787,"./constants":1195,"./render":1199,"@plotly/d3":58}],1199:[function(r,I,B){var t=r("d3-force"),d=r("d3-interpolate").interpolateNumber,m=r("@plotly/d3"),h=r("@plotly/d3-sankey"),e=r("@plotly/d3-sankey-circular"),f=r("./constants"),l=r("tinycolor2"),o=r("../../components/color"),u=r("../../components/drawing"),s=r("../../lib"),i=s.strTranslate,c=s.strRotate,n=r("../../lib/gup"),a=n.keyFun,g=n.repeat,p=n.unwrap,y=r("../../lib/svg_text_utils"),v=r("../../registry"),b=r("../../constants/alignment"),x=b.CAP_SHIFT,T=b.LINE_SPACING;function A(H,Y,$){var z,j=p(Y),W=j.trace,ee=W.domain,J=W.orientation==="h",Q=W.node.pad,te=W.node.thickness,ie=H.width*(ee.x[1]-ee.x[0]),ae=H.height*(ee.y[1]-ee.y[0]),he=j._nodes,se=j._links,de=j.circular;(z=de?e.sankeyCircular().circularLinkGap(0):h.sankey()).iterations(f.sankeyIterations).size(J?[ie,ae]:[ae,ie]).nodeWidth(te).nodePadding(Q).nodeId(function(Se){return Se.pointNumber}).nodes(he).links(se);var ue,ve,ke,Ee=z();for(var be in z.nodePadding()<Q&&s.warn("node.pad was reduced to ",z.nodePadding()," to fit within the figure."),j._groupLookup){var xe,ce=parseInt(j._groupLookup[be]);for(ue=0;ue<Ee.nodes.length;ue++)if(Ee.nodes[ue].pointNumber===ce){xe=Ee.nodes[ue];break}if(xe){var ge={pointNumber:parseInt(be),x0:xe.x0,x1:xe.x1,y0:xe.y0,y1:xe.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};Ee.nodes.unshift(ge),xe.childrenNodes.unshift(ge)}}if(function(){for(ue=0;ue<Ee.nodes.length;ue++){var Se,ze,Fe=Ee.nodes[ue],Ye={};for(ve=0;ve<Fe.targetLinks.length;ve++)Se=(ze=Fe.targetLinks[ve]).source.pointNumber+":"+ze.target.pointNumber,Ye.hasOwnProperty(Se)||(Ye[Se]=[]),Ye[Se].push(ze);var rt=Object.keys(Ye);for(ve=0;ve<rt.length;ve++){var Oe=Ye[Se=rt[ve]],je=0,We={};for(ke=0;ke<Oe.length;ke++)We[(ze=Oe[ke]).label]||(We[ze.label]=0),We[ze.label]+=ze.value,je+=ze.value;for(ke=0;ke<Oe.length;ke++)(ze=Oe[ke]).flow={value:je,labelConcentration:We[ze.label]/je,concentration:ze.value/je,links:Oe},ze.concentrationscale&&(ze.color=l(ze.concentrationscale(ze.flow.labelConcentration)))}var qe=0;for(ve=0;ve<Fe.sourceLinks.length;ve++)qe+=Fe.sourceLinks[ve].value;for(ve=0;ve<Fe.sourceLinks.length;ve++)(ze=Fe.sourceLinks[ve]).concentrationOut=ze.value/qe;var et=0;for(ve=0;ve<Fe.targetLinks.length;ve++)et+=Fe.targetLinks[ve].value;for(ve=0;ve<Fe.targetLinks.length;ve++)(ze=Fe.targetLinks[ve]).concenrationIn=ze.value/et}}(),W.node.x.length&&W.node.y.length){for(ue=0;ue<Math.min(W.node.x.length,W.node.y.length,Ee.nodes.length);ue++)if(W.node.x[ue]&&W.node.y[ue]){var we=[W.node.x[ue]*ie,W.node.y[ue]*ae];Ee.nodes[ue].x0=we[0]-te/2,Ee.nodes[ue].x1=we[0]+te/2;var Me=Ee.nodes[ue].y1-Ee.nodes[ue].y0;Ee.nodes[ue].y0=we[1]-Me/2,Ee.nodes[ue].y1=we[1]+Me/2}W.arrangement==="snap"&&function(Se){Se.forEach(function(ze){var Fe,Ye,rt,Oe=0,je=ze.length;for(ze.sort(function(We,qe){return We.y0-qe.y0}),rt=0;rt<je;++rt)(Fe=ze[rt]).y0>=Oe||(Ye=Oe-Fe.y0)>1e-6&&(Fe.y0+=Ye,Fe.y1+=Ye),Oe=Fe.y1+Q})}(function(Se){var ze,Fe,Ye=Se.map(function(qe,et){return{x0:qe.x0,index:et}}).sort(function(qe,et){return qe.x0-et.x0}),rt=[],Oe=-1,je=-1/0;for(ue=0;ue<Ye.length;ue++){var We=Se[Ye[ue].index];We.x0>je+te&&(Oe+=1,ze=We.x0),je=We.x0,rt[Oe]||(rt[Oe]=[]),rt[Oe].push(We),Fe=ze-We.x0,We.x0+=Fe,We.x1+=Fe}return rt}(he=Ee.nodes)),z.update(Ee)}return{circular:de,key:$,trace:W,guid:s.randstr(),horizontal:J,width:ie,height:ae,nodePad:W.node.pad,nodeLineColor:W.node.line.color,nodeLineWidth:W.node.line.width,linkLineColor:W.link.line.color,linkLineWidth:W.link.line.width,valueFormat:W.valueformat,valueSuffix:W.valuesuffix,textFont:W.textfont,translateX:ee.x[0]*H.width+H.margin.l,translateY:H.height-ee.y[1]*H.height+H.margin.t,dragParallel:J?ae:ie,dragPerpendicular:J?ie:ae,arrangement:W.arrangement,sankey:z,graph:Ee,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function S(H,Y,$){var z=l(Y.color),j=Y.source.label+"|"+Y.target.label+"__"+$;return Y.trace=H.trace,Y.curveNumber=H.trace.index,{circular:H.circular,key:j,traceId:H.key,pointNumber:Y.pointNumber,link:Y,tinyColorHue:o.tinyRGB(z),tinyColorAlpha:z.getAlpha(),linkPath:w,linkLineColor:H.linkLineColor,linkLineWidth:H.linkLineWidth,valueFormat:H.valueFormat,valueSuffix:H.valueSuffix,sankey:H.sankey,parent:H,interactionState:H.interactionState,flow:Y.flow}}function w(){return function(H){if(H.link.circular)return Y=H.link,$=Y.width/2,z=Y.circularPathData,Y.circularLinkType==="top"?"M "+z.targetX+" "+(z.targetY+$)+" L"+z.rightInnerExtent+" "+(z.targetY+$)+"A"+(z.rightLargeArcRadius+$)+" "+(z.rightSmallArcRadius+$)+" 0 0 1 "+(z.rightFullExtent-$)+" "+(z.targetY-z.rightSmallArcRadius)+"L"+(z.rightFullExtent-$)+" "+z.verticalRightInnerExtent+"A"+(z.rightLargeArcRadius+$)+" "+(z.rightLargeArcRadius+$)+" 0 0 1 "+z.rightInnerExtent+" "+(z.verticalFullExtent-$)+"L"+z.leftInnerExtent+" "+(z.verticalFullExtent-$)+"A"+(z.leftLargeArcRadius+$)+" "+(z.leftLargeArcRadius+$)+" 0 0 1 "+(z.leftFullExtent+$)+" "+z.verticalLeftInnerExtent+"L"+(z.leftFullExtent+$)+" "+(z.sourceY-z.leftSmallArcRadius)+"A"+(z.leftLargeArcRadius+$)+" "+(z.leftSmallArcRadius+$)+" 0 0 1 "+z.leftInnerExtent+" "+(z.sourceY+$)+"L"+z.sourceX+" "+(z.sourceY+$)+"L"+z.sourceX+" "+(z.sourceY-$)+"L"+z.leftInnerExtent+" "+(z.sourceY-$)+"A"+(z.leftLargeArcRadius-$)+" "+(z.leftSmallArcRadius-$)+" 0 0 0 "+(z.leftFullExtent-$)+" "+(z.sourceY-z.leftSmallArcRadius)+"L"+(z.leftFullExtent-$)+" "+z.verticalLeftInnerExtent+"A"+(z.leftLargeArcRadius-$)+" "+(z.leftLargeArcRadius-$)+" 0 0 0 "+z.leftInnerExtent+" "+(z.verticalFullExtent+$)+"L"+z.rightInnerExtent+" "+(z.verticalFullExtent+$)+"A"+(z.rightLargeArcRadius-$)+" "+(z.rightLargeArcRadius-$)+" 0 0 0 "+(z.rightFullExtent+$)+" "+z.verticalRightInnerExtent+"L"+(z.rightFullExtent+$)+" "+(z.targetY-z.rightSmallArcRadius)+"A"+(z.rightLargeArcRadius-$)+" "+(z.rightSmallArcRadius-$)+" 0 0 0 "+z.rightInnerExtent+" "+(z.targetY-$)+"L"+z.targetX+" "+(z.targetY-$)+"Z":"M "+z.targetX+" "+(z.targetY-$)+" L"+z.rightInnerExtent+" "+(z.targetY-$)+"A"+(z.rightLargeArcRadius+$)+" "+(z.rightSmallArcRadius+$)+" 0 0 0 "+(z.rightFullExtent-$)+" "+(z.targetY+z.rightSmallArcRadius)+"L"+(z.rightFullExtent-$)+" "+z.verticalRightInnerExtent+"A"+(z.rightLargeArcRadius+$)+" "+(z.rightLargeArcRadius+$)+" 0 0 0 "+z.rightInnerExtent+" "+(z.verticalFullExtent+$)+"L"+z.leftInnerExtent+" "+(z.verticalFullExtent+$)+"A"+(z.leftLargeArcRadius+$)+" "+(z.leftLargeArcRadius+$)+" 0 0 0 "+(z.leftFullExtent+$)+" "+z.verticalLeftInnerExtent+"L"+(z.leftFullExtent+$)+" "+(z.sourceY+z.leftSmallArcRadius)+"A"+(z.leftLargeArcRadius+$)+" "+(z.leftSmallArcRadius+$)+" 0 0 0 "+z.leftInnerExtent+" "+(z.sourceY-$)+"L"+z.sourceX+" "+(z.sourceY-$)+"L"+z.sourceX+" "+(z.sourceY+$)+"L"+z.leftInnerExtent+" "+(z.sourceY+$)+"A"+(z.leftLargeArcRadius-$)+" "+(z.leftSmallArcRadius-$)+" 0 0 1 "+(z.leftFullExtent-$)+" "+(z.sourceY+z.leftSmallArcRadius)+"L"+(z.leftFullExtent-$)+" "+z.verticalLeftInnerExtent+"A"+(z.leftLargeArcRadius-$)+" "+(z.leftLargeArcRadius-$)+" 0 0 1 "+z.leftInnerExtent+" "+(z.verticalFullExtent-$)+"L"+z.rightInnerExtent+" "+(z.verticalFullExtent-$)+"A"+(z.rightLargeArcRadius-$)+" "+(z.rightLargeArcRadius-$)+" 0 0 1 "+(z.rightFullExtent+$)+" "+z.verticalRightInnerExtent+"L"+(z.rightFullExtent+$)+" "+(z.targetY+z.rightSmallArcRadius)+"A"+(z.rightLargeArcRadius-$)+" "+(z.rightSmallArcRadius-$)+" 0 0 1 "+z.rightInnerExtent+" "+(z.targetY+$)+"L"+z.targetX+" "+(z.targetY+$)+"Z";var Y,$,z,j=H.link.source.x1,W=H.link.target.x0,ee=d(j,W),J=ee(.5),Q=ee(.5),te=H.link.y0-H.link.width/2,ie=H.link.y0+H.link.width/2,ae=H.link.y1-H.link.width/2,he=H.link.y1+H.link.width/2;return"M"+j+","+te+"C"+J+","+te+" "+Q+","+ae+" "+W+","+ae+"L"+W+","+he+"C"+Q+","+he+" "+J+","+ie+" "+j+","+ie+"Z"}}function E(H,Y){var $=l(Y.color),z=f.nodePadAcross,j=H.nodePad/2;Y.dx=Y.x1-Y.x0,Y.dy=Y.y1-Y.y0;var W=Y.dx,ee=Math.max(.5,Y.dy),J="node_"+Y.pointNumber;return Y.group&&(J=s.randstr()),Y.trace=H.trace,Y.curveNumber=H.trace.index,{index:Y.pointNumber,key:J,partOfGroup:Y.partOfGroup||!1,group:Y.group,traceId:H.key,trace:H.trace,node:Y,nodePad:H.nodePad,nodeLineColor:H.nodeLineColor,nodeLineWidth:H.nodeLineWidth,textFont:H.textFont,size:H.horizontal?H.height:H.width,visibleWidth:Math.ceil(W),visibleHeight:ee,zoneX:-z,zoneY:-j,zoneWidth:W+2*z,zoneHeight:ee+2*j,labelY:H.horizontal?Y.dy/2+1:Y.dx/2+1,left:Y.originalLayer===1,sizeAcross:H.width,forceLayouts:H.forceLayouts,horizontal:H.horizontal,darkBackground:$.getBrightness()<=128,tinyColorHue:o.tinyRGB($),tinyColorAlpha:$.getAlpha(),valueFormat:H.valueFormat,valueSuffix:H.valueSuffix,sankey:H.sankey,graph:H.graph,arrangement:H.arrangement,uniqueNodeLabelPathId:[H.guid,H.key,J].join("_"),interactionState:H.interactionState,figure:H}}function k(H){H.attr("transform",function(Y){return i(Y.node.x0.toFixed(3),Y.node.y0.toFixed(3))})}function L(H){H.call(k)}function M(H,Y){H.call(L),Y.attr("d",w())}function P(H){H.attr("width",function(Y){return Y.node.x1-Y.node.x0}).attr("height",function(Y){return Y.visibleHeight})}function D(H){return H.link.width>1||H.linkLineWidth>0}function N(H){return i(H.translateX,H.translateY)+(H.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function U(H,Y,$){H.on(".basic",null).on("mouseover.basic",function(z){z.interactionState.dragInProgress||z.partOfGroup||($.hover(this,z,Y),z.interactionState.hovered=[this,z])}).on("mousemove.basic",function(z){z.interactionState.dragInProgress||z.partOfGroup||($.follow(this,z),z.interactionState.hovered=[this,z])}).on("mouseout.basic",function(z){z.interactionState.dragInProgress||z.partOfGroup||($.unhover(this,z,Y),z.interactionState.hovered=!1)}).on("click.basic",function(z){z.interactionState.hovered&&($.unhover(this,z,Y),z.interactionState.hovered=!1),z.interactionState.dragInProgress||z.partOfGroup||$.select(this,z,Y)})}function G(H,Y,$,z){var j=m.behavior.drag().origin(function(W){return{x:W.node.x0+W.visibleWidth/2,y:W.node.y0+W.visibleHeight/2}}).on("dragstart",function(W){if(W.arrangement!=="fixed"&&(s.ensureSingle(z._fullLayout._infolayer,"g","dragcover",function(J){z._fullLayout._dragCover=J}),s.raiseToTop(this),W.interactionState.dragInProgress=W.node,K(W.node),W.interactionState.hovered&&($.nodeEvents.unhover.apply(0,W.interactionState.hovered),W.interactionState.hovered=!1),W.arrangement==="snap")){var ee=W.traceId+"|"+W.key;W.forceLayouts[ee]?W.forceLayouts[ee].alpha(1):function(J,Q,te,ie){(function(he){for(var se=0;se<he.length;se++)he[se].y=(he[se].y0+he[se].y1)/2,he[se].x=(he[se].x0+he[se].x1)/2})(te.graph.nodes);var ae=te.graph.nodes.filter(function(he){return he.originalX===te.node.originalX}).filter(function(he){return!he.partOfGroup});te.forceLayouts[Q]=t.forceSimulation(ae).alphaDecay(0).force("collide",t.forceCollide().radius(function(he){return he.dy/2+te.nodePad/2}).strength(1).iterations(f.forceIterations)).force("constrain",function(he,se,de,ue){return function(){for(var ve=0,ke=0;ke<de.length;ke++){var Ee=de[ke];Ee===ue.interactionState.dragInProgress?(Ee.x=Ee.lastDraggedX,Ee.y=Ee.lastDraggedY):(Ee.vx=(Ee.originalX-Ee.x)/f.forceTicksPerFrame,Ee.y=Math.min(ue.size-Ee.dy/2,Math.max(Ee.dy/2,Ee.y))),ve=Math.max(ve,Math.abs(Ee.vx),Math.abs(Ee.vy))}!ue.interactionState.dragInProgress&&ve<.1&&ue.forceLayouts[se].alpha()>0&&ue.forceLayouts[se].alpha(0)}}(0,Q,ae,te)).stop()}(0,ee,W),function(J,Q,te,ie,ae){window.requestAnimationFrame(function he(){var se;for(se=0;se<f.forceTicksPerFrame;se++)te.forceLayouts[ie].tick();if(function(ue){for(var ve=0;ve<ue.length;ve++)ue[ve].y0=ue[ve].y-ue[ve].dy/2,ue[ve].y1=ue[ve].y0+ue[ve].dy,ue[ve].x0=ue[ve].x-ue[ve].dx/2,ue[ve].x1=ue[ve].x0+ue[ve].dx}(te.graph.nodes),te.sankey.update(te.graph),M(J.filter(Z(te)),Q),te.forceLayouts[ie].alpha()>0)window.requestAnimationFrame(he);else{var de=te.node.originalX;te.node.x0=de-te.visibleWidth/2,te.node.x1=de+te.visibleWidth/2,X(te,ae)}})}(H,Y,W,ee,z)}}).on("drag",function(W){if(W.arrangement!=="fixed"){var ee=m.event.x,J=m.event.y;W.arrangement==="snap"?(W.node.x0=ee-W.visibleWidth/2,W.node.x1=ee+W.visibleWidth/2,W.node.y0=J-W.visibleHeight/2,W.node.y1=J+W.visibleHeight/2):(W.arrangement==="freeform"&&(W.node.x0=ee-W.visibleWidth/2,W.node.x1=ee+W.visibleWidth/2),J=Math.max(0,Math.min(W.size-W.visibleHeight/2,J)),W.node.y0=J-W.visibleHeight/2,W.node.y1=J+W.visibleHeight/2),K(W.node),W.arrangement!=="snap"&&(W.sankey.update(W.graph),M(H.filter(Z(W)),Y))}}).on("dragend",function(W){if(W.arrangement!=="fixed"){W.interactionState.dragInProgress=!1;for(var ee=0;ee<W.node.childrenNodes.length;ee++)W.node.childrenNodes[ee].x=W.node.x,W.node.childrenNodes[ee].y=W.node.y;W.arrangement!=="snap"&&X(W,z)}});H.on(".drag",null).call(j)}function X(H,Y){for(var $=[],z=[],j=0;j<H.graph.nodes.length;j++){var W=(H.graph.nodes[j].x0+H.graph.nodes[j].x1)/2,ee=(H.graph.nodes[j].y0+H.graph.nodes[j].y1)/2;$.push(W/H.figure.width),z.push(ee/H.figure.height)}v.call("_guiRestyle",Y,{"node.x":[$],"node.y":[z]},H.trace.index).then(function(){Y._fullLayout._dragCover&&Y._fullLayout._dragCover.remove()})}function K(H){H.lastDraggedX=H.x0+H.dx/2,H.lastDraggedY=H.y0+H.dy/2}function Z(H){return function(Y){return Y.node.originalX===H.node.originalX}}I.exports=function(H,Y,$,z,j){var W=!1;s.ensureSingle(H._fullLayout._infolayer,"g","first-render",function(){W=!0});var ee=H._fullLayout._dragCover,J=$.filter(function(ue){return p(ue).trace.visible}).map(A.bind(null,z)),Q=Y.selectAll("."+f.cn.sankey).data(J,a);Q.exit().remove(),Q.enter().append("g").classed(f.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",N),Q.each(function(ue,ve){H._fullData[ve]._sankey=ue;var ke="bgsankey-"+ue.trace.uid+"-"+ve;s.ensureSingle(H._fullLayout._draggers,"rect",ke),H._fullData[ve]._bgRect=m.select("."+ke),H._fullData[ve]._bgRect.style("pointer-events","all").attr("width",ue.width).attr("height",ue.height).attr("x",ue.translateX).attr("y",ue.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),Q.transition().ease(f.ease).duration(f.duration).attr("transform",N);var te=Q.selectAll("."+f.cn.sankeyLinks).data(g,a);te.enter().append("g").classed(f.cn.sankeyLinks,!0).style("fill","none");var ie=te.selectAll("."+f.cn.sankeyLink).data(function(ue){return ue.graph.links.filter(function(ve){return ve.value}).map(S.bind(null,ue))},a);ie.enter().append("path").classed(f.cn.sankeyLink,!0).call(U,Q,j.linkEvents),ie.style("stroke",function(ue){return D(ue)?o.tinyRGB(l(ue.linkLineColor)):ue.tinyColorHue}).style("stroke-opacity",function(ue){return D(ue)?o.opacity(ue.linkLineColor):ue.tinyColorAlpha}).style("fill",function(ue){return ue.tinyColorHue}).style("fill-opacity",function(ue){return ue.tinyColorAlpha}).style("stroke-width",function(ue){return D(ue)?ue.linkLineWidth:1}).attr("d",w()),ie.style("opacity",function(){return H._context.staticPlot||W||ee?1:0}).transition().ease(f.ease).duration(f.duration).style("opacity",1),ie.exit().transition().ease(f.ease).duration(f.duration).style("opacity",0).remove();var ae=Q.selectAll("."+f.cn.sankeyNodeSet).data(g,a);ae.enter().append("g").classed(f.cn.sankeyNodeSet,!0),ae.style("cursor",function(ue){switch(ue.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var he=ae.selectAll("."+f.cn.sankeyNode).data(function(ue){var ve=ue.graph.nodes;return function(ke){var Ee,be=[];for(Ee=0;Ee<ke.length;Ee++)ke[Ee].originalX=(ke[Ee].x0+ke[Ee].x1)/2,ke[Ee].originalY=(ke[Ee].y0+ke[Ee].y1)/2,be.indexOf(ke[Ee].originalX)===-1&&be.push(ke[Ee].originalX);for(be.sort(function(xe,ce){return xe-ce}),Ee=0;Ee<ke.length;Ee++)ke[Ee].originalLayerIndex=be.indexOf(ke[Ee].originalX),ke[Ee].originalLayer=ke[Ee].originalLayerIndex/(be.length-1)}(ve),ve.map(E.bind(null,ue))},a);he.enter().append("g").classed(f.cn.sankeyNode,!0).call(k).style("opacity",function(ue){return!H._context.staticPlot&&!W||ue.partOfGroup?0:1}),he.call(U,Q,j.nodeEvents).call(G,ie,j,H),he.transition().ease(f.ease).duration(f.duration).call(k).style("opacity",function(ue){return ue.partOfGroup?0:1}),he.exit().transition().ease(f.ease).duration(f.duration).style("opacity",0).remove();var se=he.selectAll("."+f.cn.nodeRect).data(g);se.enter().append("rect").classed(f.cn.nodeRect,!0).call(P),se.style("stroke-width",function(ue){return ue.nodeLineWidth}).style("stroke",function(ue){return o.tinyRGB(l(ue.nodeLineColor))}).style("stroke-opacity",function(ue){return o.opacity(ue.nodeLineColor)}).style("fill",function(ue){return ue.tinyColorHue}).style("fill-opacity",function(ue){return ue.tinyColorAlpha}),se.transition().ease(f.ease).duration(f.duration).call(P);var de=he.selectAll("."+f.cn.nodeLabel).data(g);de.enter().append("text").classed(f.cn.nodeLabel,!0).style("cursor","default"),de.attr("data-notex",1).text(function(ue){return ue.node.label}).each(function(ue){var ve=m.select(this);u.font(ve,ue.textFont),y.convertToTspans(ve,H)}).style("text-shadow",y.makeTextShadow(H._fullLayout.paper_bgcolor)).attr("text-anchor",function(ue){return ue.horizontal&&ue.left?"end":"start"}).attr("transform",function(ue){var ve=m.select(this),ke=y.lineCount(ve),Ee=ue.textFont.size*((ke-1)*T-x),be=ue.nodeLineWidth/2+3,xe=((ue.horizontal?ue.visibleHeight:ue.visibleWidth)-Ee)/2;ue.horizontal&&(ue.left?be=-be:be+=ue.visibleWidth);var ce=ue.horizontal?"":"scale(-1,1)"+c(90);return i(ue.horizontal?be:xe,ue.horizontal?xe:be)+ce}),de.transition().ease(f.ease).duration(f.duration)}},{"../../components/color":650,"../../components/drawing":672,"../../constants/alignment":755,"../../lib":787,"../../lib/gup":784,"../../lib/svg_text_utils":813,"../../registry":915,"./constants":1195,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":163,"d3-interpolate":168,tinycolor2:583}],1200:[function(r,I,B){I.exports=function(t,d){for(var m=[],h=t.cd[0].trace,e=h._sankey.graph.nodes,f=0;f<e.length;f++){var l=e[f];if(!l.partOfGroup){var o=[(l.x0+l.x1)/2,(l.y0+l.y1)/2];h.orientation==="v"&&o.reverse(),d&&d.contains(o,!1,f,t)&&m.push({pointNumber:l.pointNumber})}}return m}},{}],1201:[function(r,I,B){var t=r("../../lib");I.exports=function(d,m){for(var h=0;h<d.length;h++)d[h].i=h;t.mergeArray(m.text,d,"tx"),t.mergeArray(m.texttemplate,d,"txt"),t.mergeArray(m.hovertext,d,"htx"),t.mergeArray(m.customdata,d,"data"),t.mergeArray(m.textposition,d,"tp"),m.textfont&&(t.mergeArrayCastPositive(m.textfont.size,d,"ts"),t.mergeArray(m.textfont.color,d,"tc"),t.mergeArray(m.textfont.family,d,"tf"));var e=m.marker;if(e){t.mergeArrayCastPositive(e.size,d,"ms"),t.mergeArrayCastPositive(e.opacity,d,"mo"),t.mergeArray(e.symbol,d,"mx"),t.mergeArray(e.color,d,"mc");var f=e.line;e.line&&(t.mergeArray(f.color,d,"mlc"),t.mergeArrayCastPositive(f.width,d,"mlw"));var l=e.gradient;l&&l.type!=="none"&&(t.mergeArray(l.type,d,"mgt"),t.mergeArray(l.color,d,"mgc"))}}},{"../../lib":787}],1202:[function(r,I,B){var t=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,d=r("../../plots/template_attributes").texttemplateAttrs,m=r("../../plots/template_attributes").hovertemplateAttrs,h=r("../../components/colorscale/attributes"),e=r("../../plots/font_attributes"),f=r("../../components/drawing/attributes").dash,l=r("../../components/drawing"),o=r("./constants"),u=r("../../lib/extend").extendFlat;I.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:{valType:"any",dflt:0,editType:"calc"},yperiod:{valType:"any",dflt:0,editType:"calc"},xperiod0:{valType:"any",editType:"calc"},yperiod0:{valType:"any",editType:"calc"},xperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},yperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},xhoverformat:t("x"),yhoverformat:t("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:d({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:m({},{keys:o.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:u({},f,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},marker:u({symbol:{valType:"enumerated",values:l.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:u({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},h("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},h("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:e({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":657,"../../components/drawing":672,"../../components/drawing/attributes":671,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/font_attributes":867,"../../plots/template_attributes":910,"./constants":1206}],1203:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../plots/cartesian/axes"),h=r("../../plots/cartesian/align_period"),e=r("../../constants/numerical").BADNUM,f=r("./subtypes"),l=r("./colorscale_calc"),o=r("./arrays_to_calcdata"),u=r("./calc_selection");function s(g,p,y,v,b,x,T){var A=p._length,S=g._fullLayout,w=y._id,E=v._id,k=S._firstScatter[n(p)]===p.uid,L=(a(p,S,y,v)||{}).orientation,M=p.fill;y._minDtick=0,v._minDtick=0;var P={padded:!0},D={padded:!0};T&&(P.ppad=D.ppad=T);var N=A<2||b[0]!==b[A-1]||x[0]!==x[A-1];N&&(M==="tozerox"||M==="tonextx"&&(k||L==="h"))?P.tozero=!0:(p.error_y||{}).visible||M!=="tonexty"&&M!=="tozeroy"&&(f.hasMarkers(p)||f.hasText(p))||(P.padded=!1,P.ppad=0),N&&(M==="tozeroy"||M==="tonexty"&&(k||L==="v"))?D.tozero=!0:M!=="tonextx"&&M!=="tozerox"||(D.padded=!1),w&&(p._extremes[w]=m.findExtremes(y,b,P)),E&&(p._extremes[E]=m.findExtremes(v,x,D))}function i(g,p){if(f.hasMarkers(g)){var y,v=g.marker,b=1.6*(g.marker.sizeref||1);if(y=g.marker.sizemode==="area"?function(w){return Math.max(Math.sqrt((w||0)/b),3)}:function(w){return Math.max((w||0)/b,3)},d.isArrayOrTypedArray(v.size)){var x={type:"linear"};m.setConvert(x);for(var T=x.makeCalcdata(g.marker,"size"),A=new Array(p),S=0;S<p;S++)A[S]=y(T[S]);return A}return y(v.size)}}function c(g,p){var y=n(p),v=g._firstScatter;v[y]||(v[y]=p.uid)}function n(g){var p=g.stackgroup;return g.xaxis+g.yaxis+g.type+(p?"-"+p:"")}function a(g,p,y,v){var b=g.stackgroup;if(b){var x=p._scatterStackOpts[y._id+v._id][b],T=x.orientation==="v"?v:y;return T.type==="linear"||T.type==="log"?x:void 0}}I.exports={calc:function(g,p){var y,v,b,x,T,A,S=g._fullLayout,w=m.getFromId(g,p.xaxis||"x"),E=m.getFromId(g,p.yaxis||"y"),k=w.makeCalcdata(p,"x"),L=E.makeCalcdata(p,"y"),M=h(p,w,"x",k),P=h(p,E,"y",L),D=M.vals,N=P.vals,U=p._length,G=new Array(U),X=p.ids,K=a(p,S,w,E),Z=!1;c(S,p);var H,Y="x",$="y";K?(d.pushUnique(K.traceIndices,p._expandedIndex),(y=K.orientation==="v")?($="s",H="x"):(Y="s",H="y"),T=K.stackgaps==="interpolate"):s(g,p,w,E,D,N,i(p,U));var z=!!p.xperiodalignment,j=!!p.yperiodalignment;for(v=0;v<U;v++){var W=G[v]={},ee=t(D[v]),J=t(N[v]);ee&&J?(W[Y]=D[v],W[$]=N[v],z&&(W.orig_x=k[v],W.xEnd=M.ends[v],W.xStart=M.starts[v]),j&&(W.orig_y=L[v],W.yEnd=P.ends[v],W.yStart=P.starts[v])):K&&(y?ee:J)?(W[H]=y?D[v]:N[v],W.gap=!0,T?(W.s=e,Z=!0):W.s=0):W[Y]=W[$]=e,X&&(W.id=String(X[v]))}if(o(G,p),l(g,p),u(G,p),K){for(v=0;v<G.length;)G[v][H]===e?G.splice(v,1):v++;if(d.sort(G,function(ae,he){return ae[H]-he[H]||ae.i-he.i}),Z){for(v=0;v<G.length-1&&G[v].gap;)v++;for((A=G[v].s)||(A=G[v].s=0),b=0;b<v;b++)G[b].s=A;for(x=G.length-1;x>v&&G[x].gap;)x--;for(A=G[x].s,b=G.length-1;b>x;b--)G[b].s=A;for(;v<x;)if(G[++v].gap){for(b=v+1;G[b].gap;)b++;for(var Q=G[v-1][H],te=G[v-1].s,ie=(G[b].s-te)/(G[b][H]-Q);v<b;)G[v].s=te+(G[v][H]-Q)*ie,v++}}}return G},calcMarkerSize:i,calcAxisExpansion:s,setFirstScatter:c,getStackOpts:a}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"./arrays_to_calcdata":1201,"./calc_selection":1204,"./colorscale_calc":1205,"./subtypes":1227,"fast-isnumeric":246}],1204:[function(r,I,B){var t=r("../../lib");I.exports=function(d,m){t.isArrayOrTypedArray(m.selectedpoints)&&t.tagSelected(d,m)}},{"../../lib":787}],1205:[function(r,I,B){var t=r("../../components/colorscale/helpers").hasColorscale,d=r("../../components/colorscale/calc"),m=r("./subtypes");I.exports=function(h,e){m.hasLines(e)&&t(e,"line")&&d(h,e,{vals:e.line.color,containerStr:"line",cLetter:"c"}),m.hasMarkers(e)&&(t(e,"marker")&&d(h,e,{vals:e.marker.color,containerStr:"marker",cLetter:"c"}),t(e,"marker.line")&&d(h,e,{vals:e.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":658,"../../components/colorscale/helpers":661,"./subtypes":1227}],1206:[function(r,I,B){I.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],1207:[function(r,I,B){var t=r("./calc");function d(m,h,e,f,l,o,u){l[f]=!0;var s={i:null,gap:!0,s:0};if(s[u]=e,m.splice(h,0,s),h&&e===m[h-1][u]){var i=m[h-1];s.s=i.s,s.i=i.i,s.gap=i.gap}else o&&(s.s=function(c,n,a,g){var p=c[n-1],y=c[n+1];return y?p?p.s+(y.s-p.s)*(a-p[g])/(y[g]-p[g]):y.s:p.s}(m,h,e,u));h||(m[0].t=m[1].t,m[0].trace=m[1].trace,delete m[1].t,delete m[1].trace)}I.exports=function(m,h){var e=h.xaxis,f=h.yaxis,l=e._id+f._id,o=m._fullLayout._scatterStackOpts[l];if(o){var u,s,i,c,n,a,g,p,y,v,b,x,T,A,S,w=m.calcdata;for(var E in o){var k=(v=o[E]).traceIndices;if(k.length){for(b=v.stackgaps==="interpolate",x=v.groupnorm,v.orientation==="v"?(T="x",A="y"):(T="y",A="x"),S=new Array(k.length),u=0;u<S.length;u++)S[u]=!1;a=w[k[0]];var L=new Array(a.length);for(u=0;u<a.length;u++)L[u]=a[u][T];for(u=1;u<k.length;u++){for(n=w[k[u]],s=i=0;s<n.length;s++){for(g=n[s][T];g>L[i]&&i<L.length;i++)d(n,s,L[i],u,S,b,T),s++;if(g!==L[i]){for(c=0;c<u;c++)d(w[k[c]],i,g,c,S,b,T);L.splice(i,0,g)}i++}for(;i<L.length;i++)d(n,s,L[i],u,S,b,T),s++}var M=L.length;for(s=0;s<a.length;s++){for(p=a[s][A]=a[s].s,u=1;u<k.length;u++)(n=w[k[u]])[0].trace._rawLength=n[0].trace._length,n[0].trace._length=M,p+=n[s].s,n[s][A]=p;if(x)for(y=(x==="fraction"?p:p/100)||1,u=0;u<k.length;u++){var P=w[k[u]][s];P[A]/=y,P.sNorm=P.s/y}}for(u=0;u<k.length;u++){var D=(n=w[k[u]])[0].trace,N=t.calcMarkerSize(D,D._rawLength),U=Array.isArray(N);if(N&&S[u]||U){var G=N;for(N=new Array(M),s=0;s<M;s++)N[s]=n[s].gap?0:U?G[n[s].i]:G}var X=new Array(M),K=new Array(M);for(s=0;s<M;s++)X[s]=n[s].x,K[s]=n[s].y;t.calcAxisExpansion(m,D,e,f,X,K,N),n[0].t.orientation=v.orientation}}}}}},{"./calc":1203}],1208:[function(r,I,B){I.exports=function(t){for(var d=0;d<t.length;d++){var m=t[d];if(m.type==="scatter"){var h=m.fill;if(h!=="none"&&h!=="toself"&&(m.opacity=void 0,h==="tonexty"||h==="tonextx"))for(var e=d-1;e>=0;e--){var f=t[e];if(f.type==="scatter"&&f.xaxis===m.xaxis&&f.yaxis===m.yaxis){f.opacity=void 0;break}}}}}},{}],1209:[function(r,I,B){var t=r("../../lib"),d=r("../../registry"),m=r("./attributes"),h=r("./constants"),e=r("./subtypes"),f=r("./xy_defaults"),l=r("./period_defaults"),o=r("./stack_defaults"),u=r("./marker_defaults"),s=r("./line_defaults"),i=r("./line_shape_defaults"),c=r("./text_defaults"),n=r("./fillcolor_defaults");I.exports=function(a,g,p,y){function v(k,L){return t.coerce(a,g,m,k,L)}var b=f(a,g,y,v);if(b||(g.visible=!1),g.visible){l(a,g,y,v),v("xhoverformat"),v("yhoverformat");var x=o(a,g,y,v),T=!x&&b<h.PTS_LINESONLY?"lines+markers":"lines";v("text"),v("hovertext"),v("mode",T),e.hasLines(g)&&(s(a,g,p,y,v),i(a,g,v),v("connectgaps"),v("line.simplify")),e.hasMarkers(g)&&u(a,g,p,y,v,{gradient:!0}),e.hasText(g)&&(v("texttemplate"),c(a,g,y,v));var A=[];(e.hasMarkers(g)||e.hasText(g))&&(v("cliponaxis"),v("marker.maxdisplayed"),A.push("points")),v("fill",x?x.fillDflt:"none"),g.fill!=="none"&&(n(a,g,p,v),e.hasLines(g)||i(a,g,v));var S=(g.line||{}).color,w=(g.marker||{}).color;g.fill!=="tonext"&&g.fill!=="toself"||A.push("fills"),v("hoveron",A.join("+")||"points"),g.hoveron!=="fills"&&v("hovertemplate");var E=d.getComponentMethod("errorbars","supplyDefaults");E(a,g,S||w||p,{axis:"y"}),E(a,g,S||w||p,{axis:"x",inherit:"y"}),t.coerceSelectionMarkerOpacity(g,v)}}},{"../../lib":787,"../../registry":915,"./attributes":1202,"./constants":1206,"./fillcolor_defaults":1210,"./line_defaults":1215,"./line_shape_defaults":1217,"./marker_defaults":1221,"./period_defaults":1222,"./stack_defaults":1225,"./subtypes":1227,"./text_defaults":1228,"./xy_defaults":1229}],1210:[function(r,I,B){var t=r("../../components/color"),d=r("../../lib").isArrayOrTypedArray;I.exports=function(m,h,e,f){var l=!1;if(h.marker){var o=h.marker.color,u=(h.marker.line||{}).color;o&&!d(o)?l=o:u&&!d(u)&&(l=u)}f("fillcolor",t.addOpacity((h.line||{}).color||l||e,.5))}},{"../../components/color":650,"../../lib":787}],1211:[function(r,I,B){var t=r("../../plots/cartesian/axes");I.exports=function(d,m,h){var e={},f={_fullLayout:h},l=t.getFromTrace(f,m,"x"),o=t.getFromTrace(f,m,"y");return e.xLabel=t.tickText(l,l.c2l(d.x),!0).text,e.yLabel=t.tickText(o,o.c2l(d.y),!0).text,e}},{"../../plots/cartesian/axes":838}],1212:[function(r,I,B){var t=r("../../components/color"),d=r("./subtypes");I.exports=function(m,h){var e,f;if(m.mode==="lines")return(e=m.line.color)&&t.opacity(e)?e:m.fillcolor;if(m.mode==="none")return m.fill?m.fillcolor:"";var l=h.mcc||(m.marker||{}).color,o=h.mlcc||((m.marker||{}).line||{}).color;return(f=l&&t.opacity(l)?l:o&&t.opacity(o)&&(h.mlw||((m.marker||{}).line||{}).width)?o:"")?t.opacity(f)<.3?t.addOpacity(f,.3):f:(e=(m.line||{}).color)&&t.opacity(e)&&d.hasLines(m)&&m.line.width?e:m.fillcolor}},{"../../components/color":650,"./subtypes":1227}],1213:[function(r,I,B){var t=r("../../lib"),d=r("../../components/fx"),m=r("../../registry"),h=r("./get_trace_color"),e=r("../../components/color"),f=t.fillText;I.exports=function(l,o,u,s){var i=l.cd,c=i[0].trace,n=l.xa,a=l.ya,g=n.c2p(o),p=a.c2p(u),y=[g,p],v=c.hoveron||"",b=c.mode.indexOf("markers")!==-1?3:.5,x=!!c.xperiodalignment,T=!!c.yperiodalignment;if(v.indexOf("points")!==-1){var A=function(se){var de=Math.max(b,se.mrc||0),ue=n.c2p(se.x)-g,ve=a.c2p(se.y)-p;return Math.max(Math.sqrt(ue*ue+ve*ve)-de,1-b/de)},S=d.getDistanceFunction(s,function(se){if(x){var de=n.c2p(se.xStart),ue=n.c2p(se.xEnd);return g>=Math.min(de,ue)&&g<=Math.max(de,ue)?0:1/0}var ve=Math.max(3,se.mrc||0),ke=1-1/ve,Ee=Math.abs(n.c2p(se.x)-g);return Ee<ve?ke*Ee/ve:Ee-ve+ke},function(se){if(T){var de=a.c2p(se.yStart),ue=a.c2p(se.yEnd);return p>=Math.min(de,ue)&&p<=Math.max(de,ue)?0:1/0}var ve=Math.max(3,se.mrc||0),ke=1-1/ve,Ee=Math.abs(a.c2p(se.y)-p);return Ee<ve?ke*Ee/ve:Ee-ve+ke},A);if(d.getClosest(i,S,l),l.index!==!1){var w=i[l.index],E=n.c2p(w.x,!0),k=a.c2p(w.y,!0),L=w.mrc||1;l.index=w.i;var M=i[0].t.orientation,P=M&&(w.sNorm||w.s),D=M==="h"?P:w.orig_x!==void 0?w.orig_x:w.x,N=M==="v"?P:w.orig_y!==void 0?w.orig_y:w.y;return t.extendFlat(l,{color:h(c,w),x0:E-L,x1:E+L,xLabelVal:D,y0:k-L,y1:k+L,yLabelVal:N,spikeDistance:A(w),hovertemplate:c.hovertemplate}),f(w,c,l),m.getComponentMethod("errorbars","hoverInfo")(w,c,l),[l]}}if(v.indexOf("fills")!==-1&&c._polygons){var U,G,X,K,Z,H,Y,$,z,j=c._polygons,W=[],ee=!1,J=1/0,Q=-1/0,te=1/0,ie=-1/0;for(U=0;U<j.length;U++)(X=j[U]).contains(y)&&(ee=!ee,W.push(X),te=Math.min(te,X.ymin),ie=Math.max(ie,X.ymax));if(ee){var ae=((te=Math.max(te,0))+(ie=Math.min(ie,a._length)))/2;for(U=0;U<W.length;U++)for(K=W[U].pts,G=1;G<K.length;G++)($=K[G-1][1])>ae!=(z=K[G][1])>=ae&&(H=K[G-1][0],Y=K[G][0],z-$&&(Z=H+(Y-H)*(ae-$)/(z-$),J=Math.min(J,Z),Q=Math.max(Q,Z)));J=Math.max(J,0),Q=Math.min(Q,n._length);var he=e.defaultLine;return e.opacity(c.fillcolor)?he=c.fillcolor:e.opacity((c.line||{}).color)&&(he=c.line.color),t.extendFlat(l,{distance:l.maxHoverDistance,x0:J,x1:Q,y0:ae,y1:ae,color:he,hovertemplate:!1}),delete l.index,c.text&&!Array.isArray(c.text)?l.text=String(c.text):l.text=c.name,[l]}}}},{"../../components/color":650,"../../components/fx":690,"../../lib":787,"../../registry":915,"./get_trace_color":1212}],1214:[function(r,I,B){var t=r("./subtypes");I.exports={hasLines:t.hasLines,hasMarkers:t.hasMarkers,hasText:t.hasText,isBubble:t.isBubble,attributes:r("./attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("./cross_trace_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./cross_trace_calc"),arraysToCalcdata:r("./arrays_to_calcdata"),plot:r("./plot"),colorbar:r("./marker_colorbar"),formatLabels:r("./format_labels"),style:r("./style").style,styleOnSelect:r("./style").styleOnSelect,hoverPoints:r("./hover"),selectPoints:r("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"./arrays_to_calcdata":1201,"./attributes":1202,"./calc":1203,"./cross_trace_calc":1207,"./cross_trace_defaults":1208,"./defaults":1209,"./format_labels":1211,"./hover":1213,"./marker_colorbar":1220,"./plot":1223,"./select":1224,"./style":1226,"./subtypes":1227}],1215:[function(r,I,B){var t=r("../../lib").isArrayOrTypedArray,d=r("../../components/colorscale/helpers").hasColorscale,m=r("../../components/colorscale/defaults");I.exports=function(h,e,f,l,o,u){var s=(h.marker||{}).color;o("line.color",f),d(h,"line")?m(h,e,l,o,{prefix:"line.",cLetter:"c"}):o("line.color",!t(s)&&s||f),o("line.width"),(u||{}).noDash||o("line.dash")}},{"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"../../lib":787}],1216:[function(r,I,B){var t=r("../../constants/numerical"),d=t.BADNUM,m=t.LOG_CLIP,h=m+.5,e=m-.5,f=r("../../lib"),l=f.segmentsIntersect,o=f.constrain,u=r("./constants");I.exports=function(s,i){var c,n,a,g,p,y,v,b,x,T,A,S,w,E,k,L,M,P,D=i.xaxis,N=i.yaxis,U=D.type==="log",G=N.type==="log",X=D._length,K=N._length,Z=i.connectGaps,H=i.baseTolerance,Y=i.shape,$=Y==="linear",z=i.fill&&i.fill!=="none",j=[],W=u.minTolerance,ee=s.length,J=new Array(ee),Q=0;function te(qe){var et=s[qe];if(!et)return!1;var st=i.linearized?D.l2p(et.x):D.c2p(et.x),ct=i.linearized?N.l2p(et.y):N.c2p(et.y);if(st===d){if(U&&(st=D.c2p(et.x,!0)),st===d)return!1;G&&ct===d&&(st*=Math.abs(D._m*K*(D._m>0?h:e)/(N._m*X*(N._m>0?h:e)))),st*=1e3}if(ct===d){if(G&&(ct=N.c2p(et.y,!0)),ct===d)return!1;ct*=1e3}return[st,ct]}function ie(qe,et,st,ct){var Pt=st-qe,kt=ct-et,at=.5-qe,tt=.5-et,_t=Pt*Pt+kt*kt,er=Pt*at+kt*tt;if(er>0&&er<_t){var tr=at*kt-tt*Pt;if(tr*tr<_t)return!0}}function ae(qe,et){var st=qe[0]/X,ct=qe[1]/K,Pt=Math.max(0,-st,st-1,-ct,ct-1);return Pt&&M!==void 0&&ie(st,ct,M,P)&&(Pt=0),Pt&&et&&ie(st,ct,et[0]/X,et[1]/K)&&(Pt=0),(1+u.toleranceGrowth*Pt)*H}function he(qe,et){var st=qe[0]-et[0],ct=qe[1]-et[1];return Math.sqrt(st*st+ct*ct)}var se,de,ue,ve,ke,Ee,be,xe=u.maxScreensAway,ce=-X*xe,ge=X*(1+xe),we=-K*xe,Me=K*(1+xe),Se=[[ce,we,ge,we],[ge,we,ge,Me],[ge,Me,ce,Me],[ce,Me,ce,we]];function ze(qe){if(qe[0]<ce||qe[0]>ge||qe[1]<we||qe[1]>Me)return[o(qe[0],ce,ge),o(qe[1],we,Me)]}function Fe(qe,et){return qe[0]===et[0]&&(qe[0]===ce||qe[0]===ge)||qe[1]===et[1]&&(qe[1]===we||qe[1]===Me)||void 0}function Ye(qe,et,st){return function(ct,Pt){var kt=ze(ct),at=ze(Pt),tt=[];if(kt&&at&&Fe(kt,at))return tt;kt&&tt.push(kt),at&&tt.push(at);var _t=2*f.constrain((ct[qe]+Pt[qe])/2,et,st)-((kt||ct)[qe]+(at||Pt)[qe]);return _t&&((kt&&at?_t>0==kt[qe]>at[qe]?kt:at:kt||at)[qe]+=_t),tt}}function rt(qe){var et=qe[0],st=qe[1],ct=et===J[Q-1][0],Pt=st===J[Q-1][1];if(!ct||!Pt)if(Q>1){var kt=et===J[Q-2][0],at=st===J[Q-2][1];ct&&(et===ce||et===ge)&&kt?at?Q--:J[Q-1]=qe:Pt&&(st===we||st===Me)&&at?kt?Q--:J[Q-1]=qe:J[Q++]=qe}else J[Q++]=qe}function Oe(qe){J[Q-1][0]!==qe[0]&&J[Q-1][1]!==qe[1]&&rt([ue,ve]),rt(qe),ke=null,ue=ve=0}function je(qe){if(M=qe[0]/X,P=qe[1]/K,se=qe[0]<ce?ce:qe[0]>ge?ge:0,de=qe[1]<we?we:qe[1]>Me?Me:0,se||de){if(Q)if(ke){var et=be(ke,qe);et.length>1&&(Oe(et[0]),J[Q++]=et[1])}else Ee=be(J[Q-1],qe)[0],J[Q++]=Ee;else J[Q++]=[se||qe[0],de||qe[1]];var st=J[Q-1];se&&de&&(st[0]!==se||st[1]!==de)?(ke&&(ue!==se&&ve!==de?rt(ue&&ve?(ct=ke,kt=(Pt=qe)[0]-ct[0],at=(Pt[1]-ct[1])/kt,(ct[1]*Pt[0]-Pt[1]*ct[0])/kt>0?[at>0?ce:ge,Me]:[at>0?ge:ce,we]):[ue||se,ve||de]):ue&&ve&&rt([ue,ve])),rt([se,de])):ue-se&&ve-de&&rt([se||ue,de||ve]),ke=qe,ue=se,ve=de}else ke&&Oe(be(ke,qe)[0]),J[Q++]=qe;var ct,Pt,kt,at}for(Y==="linear"||Y==="spline"?be=function(qe,et){for(var st=[],ct=0,Pt=0;Pt<4;Pt++){var kt=Se[Pt],at=l(qe[0],qe[1],et[0],et[1],kt[0],kt[1],kt[2],kt[3]);at&&(!ct||Math.abs(at.x-st[0][0])>1||Math.abs(at.y-st[0][1])>1)&&(at=[at.x,at.y],ct&&he(at,qe)<he(st[0],qe)?st.unshift(at):st.push(at),ct++)}return st}:Y==="hv"||Y==="vh"?be=function(qe,et){var st=[],ct=ze(qe),Pt=ze(et);return ct&&Pt&&Fe(ct,Pt)||(ct&&st.push(ct),Pt&&st.push(Pt)),st}:Y==="hvh"?be=Ye(0,ce,ge):Y==="vhv"&&(be=Ye(1,we,Me)),c=0;c<ee;c++)if(n=te(c)){for(Q=0,ke=null,je(n),c++;c<ee;c++){if(!(g=te(c))){if(Z)continue;break}if($&&i.simplify){var We=te(c+1);if(T=he(g,n),z&&(Q===0||Q===ee-1)||!(T<ae(g,We)*W)){for(b=[(g[0]-n[0])/T,(g[1]-n[1])/T],p=n,A=T,S=E=k=0,v=!1,a=g,c++;c<s.length;c++){if(y=We,We=te(c+1),!y){if(Z)continue;break}if(L=(x=[y[0]-n[0],y[1]-n[1]])[0]*b[1]-x[1]*b[0],E=Math.min(E,L),(k=Math.max(k,L))-E>ae(y,We))break;a=y,(w=x[0]*b[0]+x[1]*b[1])>A?(A=w,g=y,v=!1):w<S&&(S=w,p=y,v=!0)}if(v?(je(g),a!==p&&je(p)):(p!==n&&je(p),a!==g&&je(g)),je(a),c>=s.length||!y)break;je(y),n=y}}else je(g)}ke&&rt([ue||ke[0],ve||ke[1]]),j.push(J.slice(0,Q))}return j}},{"../../constants/numerical":763,"../../lib":787,"./constants":1206}],1217:[function(r,I,B){I.exports=function(t,d,m){m("line.shape")==="spline"&&m("line.smoothing")}},{}],1218:[function(r,I,B){var t={tonextx:1,tonexty:1,tonext:1};I.exports=function(d,m,h){var e,f,l,o,u,s={},i=!1,c=-1,n=0,a=-1;for(f=0;f<h.length;f++)(l=(e=h[f][0].trace).stackgroup||"")?l in s?u=s[l]:(u=s[l]=n,n++):e.fill in t&&a>=0?u=a:(u=a=n,n++),u<c&&(i=!0),e._groupIndex=c=u;var g=h.slice();i&&g.sort(function(y,v){var b=y[0].trace,x=v[0].trace;return b._groupIndex-x._groupIndex||b.index-x.index});var p={};for(f=0;f<g.length;f++)l=(e=g[f][0].trace).stackgroup||"",e.visible===!0?(e._nexttrace=null,e.fill in t&&(o=p[l],e._prevtrace=o||null,o&&(o._nexttrace=e)),e._ownfill=e.fill&&(e.fill.substr(0,6)==="tozero"||e.fill==="toself"||e.fill.substr(0,2)==="to"&&!e._prevtrace),p[l]=e):e._prevtrace=e._nexttrace=e._ownfill=null;return g}},{}],1219:[function(r,I,B){var t=r("fast-isnumeric");I.exports=function(d,m){m||(m=2);var h=d.marker,e=h.sizeref||1,f=h.sizemin||0,l=h.sizemode==="area"?function(o){return Math.sqrt(o/e)}:function(o){return o/e};return function(o){var u=l(o/m);return t(u)&&u>0?Math.max(u,f):0}}},{"fast-isnumeric":246}],1220:[function(r,I,B){I.exports={container:"marker",min:"cmin",max:"cmax"}},{}],1221:[function(r,I,B){var t=r("../../components/color"),d=r("../../components/colorscale/helpers").hasColorscale,m=r("../../components/colorscale/defaults"),h=r("./subtypes");I.exports=function(e,f,l,o,u,s){var i=h.isBubble(e),c=(e.line||{}).color;s=s||{},c&&(l=c),u("marker.symbol"),u("marker.opacity",i?.7:1),u("marker.size"),u("marker.color",l),d(e,"marker")&&m(e,f,o,u,{prefix:"marker.",cLetter:"c"}),s.noSelect||(u("selected.marker.color"),u("unselected.marker.color"),u("selected.marker.size"),u("unselected.marker.size")),s.noLine||(u("marker.line.color",c&&!Array.isArray(c)&&f.marker.color!==c?c:i?t.background:t.defaultLine),d(e,"marker.line")&&m(e,f,o,u,{prefix:"marker.line.",cLetter:"c"}),u("marker.line.width",i?1:0)),i&&(u("marker.sizeref"),u("marker.sizemin"),u("marker.sizemode")),s.gradient&&u("marker.gradient.type")!=="none"&&u("marker.gradient.color")}},{"../../components/color":650,"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"./subtypes":1227}],1222:[function(r,I,B){var t=r("../../lib").dateTick0,d=r("../../constants/numerical").ONEWEEK;function m(h,e){return t(e,h%d==0?1:0)}I.exports=function(h,e,f,l,o){if(o||(o={x:!0,y:!0}),o.x){var u=l("xperiod");u&&(l("xperiod0",m(u,e.xcalendar)),l("xperiodalignment"))}if(o.y){var s=l("yperiod");s&&(l("yperiod0",m(s,e.ycalendar)),l("yperiodalignment"))}}},{"../../constants/numerical":763,"../../lib":787}],1223:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../registry"),m=r("../../lib"),h=m.ensureSingle,e=m.identity,f=r("../../components/drawing"),l=r("./subtypes"),o=r("./line_points"),u=r("./link_traces"),s=r("../../lib/polygon").tester;function i(c,n,a,g,p,y,v){var b;(function(ge,we,Me,Se,ze){var Fe=Me.xaxis,Ye=Me.yaxis,rt=t.extent(m.simpleMap(Fe.range,Fe.r2c)),Oe=t.extent(m.simpleMap(Ye.range,Ye.r2c)),je=Se[0].trace;if(!!l.hasMarkers(je)){var We=je.marker.maxdisplayed;if(We!==0){var qe=Se.filter(function(Pt){return Pt.x>=rt[0]&&Pt.x<=rt[1]&&Pt.y>=Oe[0]&&Pt.y<=Oe[1]}),et=Math.ceil(qe.length/We),st=0;ze.forEach(function(Pt,kt){var at=Pt[0].trace;l.hasMarkers(at)&&at.marker.maxdisplayed>0&&kt<we&&st++});var ct=Math.round(st*et/3+Math.floor(st/3)*et/7.1);Se.forEach(function(Pt){delete Pt.vis}),qe.forEach(function(Pt,kt){Math.round((kt+ct)%et)===0&&(Pt.vis=!0)})}}})(0,n,a,g,p);var x=!!v&&v.duration>0;function T(ge){return x?ge.transition():ge}var A=a.xaxis,S=a.yaxis,w=g[0].trace,E=w.line,k=t.select(y),L=h(k,"g","errorbars"),M=h(k,"g","lines"),P=h(k,"g","points"),D=h(k,"g","text");if(d.getComponentMethod("errorbars","plot")(c,L,a,v),w.visible===!0){var N,U;T(k).style("opacity",w.opacity);var G=w.fill.charAt(w.fill.length-1);G!=="x"&&G!=="y"&&(G=""),g[0][a.isRangePlot?"nodeRangePlot3":"node3"]=k;var X,K,Z="",H=[],Y=w._prevtrace;Y&&(Z=Y._prevRevpath||"",U=Y._nextFill,H=Y._polygons);var $,z,j,W,ee,J,Q,te="",ie="",ae=[],he=m.noop;if(N=w._ownFill,l.hasLines(w)||w.fill!=="none"){for(U&&U.datum(g),["hv","vh","hvh","vhv"].indexOf(E.shape)!==-1?($=f.steps(E.shape),z=f.steps(E.shape.split("").reverse().join(""))):$=z=E.shape==="spline"?function(ge){var we=ge[ge.length-1];return ge.length>1&&ge[0][0]===we[0]&&ge[0][1]===we[1]?f.smoothclosed(ge.slice(1),E.smoothing):f.smoothopen(ge,E.smoothing)}:function(ge){return"M"+ge.join("L")},j=function(ge){return z(ge.reverse())},ae=o(g,{xaxis:A,yaxis:S,connectGaps:w.connectgaps,baseTolerance:Math.max(E.width||1,3)/4,shape:E.shape,simplify:E.simplify,fill:w.fill}),Q=w._polygons=new Array(ae.length),b=0;b<ae.length;b++)w._polygons[b]=s(ae[b]);ae.length&&(W=ae[0][0],J=(ee=ae[ae.length-1])[ee.length-1]),he=function(ge){return function(we){if(X=$(we),K=j(we),te?G?(te+="L"+X.substr(1),ie=K+"L"+ie.substr(1)):(te+="Z"+X,ie=K+"Z"+ie):(te=X,ie=K),l.hasLines(w)&&we.length>1){var Me=t.select(this);if(Me.datum(g),ge)T(Me.style("opacity",0).attr("d",X).call(f.lineGroupStyle)).style("opacity",1);else{var Se=T(Me);Se.attr("d",X),f.singleLineStyle(g,Se)}}}}}var se=M.selectAll(".js-line").data(ae);T(se.exit()).style("opacity",0).remove(),se.each(he(!1)),se.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(f.lineGroupStyle).each(he(!0)),f.setClipUrl(se,a.layerClipId,c),ae.length?(N?(N.datum(g),W&&J&&(G?(G==="y"?W[1]=J[1]=S.c2p(0,!0):G==="x"&&(W[0]=J[0]=A.c2p(0,!0)),T(N).attr("d","M"+J+"L"+W+"L"+te.substr(1)).call(f.singleFillStyle)):T(N).attr("d",te+"Z").call(f.singleFillStyle))):U&&(w.fill.substr(0,6)==="tonext"&&te&&Z?(w.fill==="tonext"?T(U).attr("d",te+"Z"+Z+"Z").call(f.singleFillStyle):T(U).attr("d",te+"L"+Z.substr(1)+"Z").call(f.singleFillStyle),w._polygons=w._polygons.concat(H)):(ue(U),w._polygons=null)),w._prevRevpath=ie,w._prevPolygons=Q):(N?ue(N):U&&ue(U),w._polygons=w._prevRevpath=w._prevPolygons=null),P.datum(g),D.datum(g),function(ge,we,Me){var Se,ze=Me[0].trace,Fe=l.hasMarkers(ze),Ye=l.hasText(ze),rt=xe(ze),Oe=ce,je=ce;if(Fe||Ye){var We=e,qe=ze.stackgroup,et=qe&&c._fullLayout._scatterStackOpts[A._id+S._id][qe].stackgaps==="infer zero";ze.marker.maxdisplayed||ze._needsCull?We=et?ke:ve:qe&&!et&&(We=Ee),Fe&&(Oe=We),Ye&&(je=We)}var st,ct=(Se=ge.selectAll("path.point").data(Oe,rt)).enter().append("path").classed("point",!0);x&&ct.call(f.pointStyle,ze,c).call(f.translatePoints,A,S).style("opacity",0).transition().style("opacity",1),Se.order(),Fe&&(st=f.makePointStyleFns(ze)),Se.each(function(Pt){var kt=t.select(this),at=T(kt);f.translatePoint(Pt,at,A,S)?(f.singlePointStyle(Pt,at,ze,st,c),a.layerClipId&&f.hideOutsideRangePoint(Pt,at,A,S,ze.xcalendar,ze.ycalendar),ze.customdata&&kt.classed("plotly-customdata",Pt.data!==null&&Pt.data!==void 0)):at.remove()}),x?Se.exit().transition().style("opacity",0).remove():Se.exit().remove(),(Se=we.selectAll("g").data(je,rt)).enter().append("g").classed("textpoint",!0).append("text"),Se.order(),Se.each(function(Pt){var kt=t.select(this),at=T(kt.select("text"));f.translatePoint(Pt,at,A,S)?a.layerClipId&&f.hideOutsideRangePoint(Pt,kt,A,S,ze.xcalendar,ze.ycalendar):kt.remove()}),Se.selectAll("text").call(f.textPointStyle,ze,c).each(function(Pt){var kt=A.c2p(Pt.x),at=S.c2p(Pt.y);t.select(this).selectAll("tspan.line").each(function(){T(t.select(this)).attr({x:kt,y:at})})}),Se.exit().remove()}(P,D,g);var de=w.cliponaxis===!1?null:a.layerClipId;f.setClipUrl(P,de,c),f.setClipUrl(D,de,c)}function ue(ge){T(ge).attr("d","M0,0Z")}function ve(ge){return ge.filter(function(we){return!we.gap&&we.vis})}function ke(ge){return ge.filter(function(we){return we.vis})}function Ee(ge){return ge.filter(function(we){return!we.gap})}function be(ge){return ge.id}function xe(ge){if(ge.ids)return be}function ce(){return!1}}I.exports=function(c,n,a,g,p,y){var v,b,x=!p,T=!!p&&p.duration>0,A=u(c,n,a);(v=g.selectAll("g.trace").data(A,function(S){return S[0].trace.uid})).enter().append("g").attr("class",function(S){return"trace scatter trace"+S[0].trace.uid}).style("stroke-miterlimit",2),v.order(),function(S,w,E){w.each(function(k){var L=h(t.select(this),"g","fills");f.setClipUrl(L,E.layerClipId,S);var M=k[0].trace,P=[];M._ownfill&&P.push("_ownFill"),M._nexttrace&&P.push("_nextFill");var D=L.selectAll("g").data(P,e);D.enter().append("g"),D.exit().each(function(N){M[N]=null}).remove(),D.order().each(function(N){M[N]=h(t.select(this),"path","js-fill")})})}(c,v,n),T?(y&&(b=y()),t.transition().duration(p.duration).ease(p.easing).each("end",function(){b&&b()}).each("interrupt",function(){b&&b()}).each(function(){g.selectAll("g.trace").each(function(S,w){i(c,w,n,S,A,this,p)})})):v.each(function(S,w){i(c,w,n,S,A,this,p)}),x&&v.exit().remove(),g.selectAll("path:not([d])").remove()}},{"../../components/drawing":672,"../../lib":787,"../../lib/polygon":799,"../../registry":915,"./line_points":1216,"./link_traces":1218,"./subtypes":1227,"@plotly/d3":58}],1224:[function(r,I,B){var t=r("./subtypes");I.exports=function(d,m){var h,e,f,l,o=d.cd,u=d.xaxis,s=d.yaxis,i=[],c=o[0].trace;if(!t.hasMarkers(c)&&!t.hasText(c))return[];if(m===!1)for(h=0;h<o.length;h++)o[h].selected=0;else for(h=0;h<o.length;h++)e=o[h],f=u.c2p(e.x),l=s.c2p(e.y),e.i!==null&&m.contains([f,l],!1,h,d)?(i.push({pointNumber:e.i,x:u.c2d(e.x),y:s.c2d(e.y)}),e.selected=1):e.selected=0;return i}},{"./subtypes":1227}],1225:[function(r,I,B){var t=["orientation","groupnorm","stackgaps"];I.exports=function(d,m,h,e){var f=h._scatterStackOpts,l=e("stackgroup");if(l){var o=m.xaxis+m.yaxis,u=f[o];u||(u=f[o]={});var s=u[l],i=!1;s?s.traces.push(m):(s=u[l]={traceIndices:[],traces:[m]},i=!0);for(var c={orientation:m.x&&!m.y?"h":"v"},n=0;n<t.length;n++){var a=t[n],g=a+"Found";if(!s[g]){var p=d[a]!==void 0,y=a==="orientation";if((p||i)&&(s[a]=e(a,c[a]),y&&(s.fillDflt=s[a]==="h"?"tonextx":"tonexty"),p&&(s[g]=!0,!i&&(delete s.traces[0][a],y))))for(var v=0;v<s.traces.length-1;v++){var b=s.traces[v];b._input.fill!==b.fill&&(b.fill=s.fillDflt)}}}return s}}},{}],1226:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/drawing"),m=r("../../registry");function h(f,l,o){d.pointStyle(f.selectAll("path.point"),l,o)}function e(f,l,o){d.textPointStyle(f.selectAll("text"),l,o)}I.exports={style:function(f){var l=t.select(f).selectAll("g.trace.scatter");l.style("opacity",function(o){return o[0].trace.opacity}),l.selectAll("g.points").each(function(o){h(t.select(this),o.trace||o[0].trace,f)}),l.selectAll("g.text").each(function(o){e(t.select(this),o.trace||o[0].trace,f)}),l.selectAll("g.trace path.js-line").call(d.lineGroupStyle),l.selectAll("g.trace path.js-fill").call(d.fillGroupStyle),m.getComponentMethod("errorbars","style")(l)},stylePoints:h,styleText:e,styleOnSelect:function(f,l,o){var u=l[0].trace;u.selectedpoints?(d.selectedPointStyle(o.selectAll("path.point"),u),d.selectedTextStyle(o.selectAll("text"),u)):(h(o,u,f),e(o,u,f))}}},{"../../components/drawing":672,"../../registry":915,"@plotly/d3":58}],1227:[function(r,I,B){var t=r("../../lib");I.exports={hasLines:function(d){return d.visible&&d.mode&&d.mode.indexOf("lines")!==-1},hasMarkers:function(d){return d.visible&&(d.mode&&d.mode.indexOf("markers")!==-1||d.type==="splom")},hasText:function(d){return d.visible&&d.mode&&d.mode.indexOf("text")!==-1},isBubble:function(d){return t.isPlainObject(d.marker)&&t.isArrayOrTypedArray(d.marker.size)}}},{"../../lib":787}],1228:[function(r,I,B){var t=r("../../lib");I.exports=function(d,m,h,e,f){f=f||{},e("textposition"),t.coerceFont(e,"textfont",h.font),f.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":787}],1229:[function(r,I,B){var t=r("../../lib"),d=r("../../registry");I.exports=function(m,h,e,f){var l,o=f("x"),u=f("y");if(d.getComponentMethod("calendars","handleTraceDefaults")(m,h,["x","y"],e),o){var s=t.minRowLength(o);u?l=Math.min(s,t.minRowLength(u)):(l=s,f("y0"),f("dy"))}else{if(!u)return 0;l=t.minRowLength(u),f("x0"),f("dx")}return h._length=l,l}},{"../../lib":787,"../../registry":915}],1230:[function(r,I,B){var t=r("../scatter/attributes"),d=r("../../components/colorscale/attributes"),m=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,h=r("../../plots/template_attributes").hovertemplateAttrs,e=r("../../plots/template_attributes").texttemplateAttrs,f=r("../../plots/attributes"),l=r("../../constants/gl3d_dashes"),o=r("../../constants/gl3d_markers"),u=r("../../lib/extend").extendFlat,s=r("../../plot_api/edit_types").overrideAll,i=r("../../lib/sort_object_keys"),c=t.line,n=t.marker,a=n.line,g=u({width:c.width,dash:{valType:"enumerated",values:i(l),dflt:"solid"}},d("line")),p=I.exports=s({x:t.x,y:t.y,z:{valType:"data_array"},text:u({},t.text,{}),texttemplate:e({},{}),hovertext:u({},t.hovertext,{}),hovertemplate:h(),xhoverformat:m("x"),yhoverformat:m("y"),zhoverformat:m("z"),mode:u({},t.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},y:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},z:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}},connectgaps:t.connectgaps,line:g,marker:u({symbol:{valType:"enumerated",values:i(o),dflt:"circle",arrayOk:!0},size:u({},n.size,{dflt:8}),sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode,opacity:u({},n.opacity,{arrayOk:!1}),colorbar:n.colorbar,line:u({width:u({},a.width,{arrayOk:!1})},d("marker.line"))},d("marker")),textposition:u({},t.textposition,{dflt:"top center"}),textfont:{color:t.textfont.color,size:t.textfont.size,family:u({},t.textfont.family,{arrayOk:!1})},hoverinfo:u({},f.hoverinfo)},"calc","nested");p.x.editType=p.y.editType=p.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":657,"../../constants/gl3d_dashes":760,"../../constants/gl3d_markers":761,"../../lib/extend":777,"../../lib/sort_object_keys":810,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1231:[function(r,I,B){var t=r("../scatter/arrays_to_calcdata"),d=r("../scatter/colorscale_calc");I.exports=function(m,h){var e=[{x:!1,y:!1,trace:h,t:{}}];return t(e,h),d(m,h),e}},{"../scatter/arrays_to_calcdata":1201,"../scatter/colorscale_calc":1205}],1232:[function(r,I,B){var t=r("../../registry");function d(m,h,e,f){if(!h||!h.visible)return null;for(var l=t.getComponentMethod("errorbars","makeComputeError")(h),o=new Array(m.length),u=0;u<m.length;u++){var s=l(+m[u],u);if(f.type==="log"){var i=f.c2l(m[u]),c=m[u]-s[0],n=m[u]+s[1];if(o[u]=[(f.c2l(c,!0)-i)*e,(f.c2l(n,!0)-i)*e],c>0){var a=f.c2l(c);f._lowerLogErrorBound||(f._lowerLogErrorBound=a),f._lowerErrorBound=Math.min(f._lowerLogErrorBound,a)}}else o[u]=[-s[0]*e,s[1]*e]}return o}I.exports=function(m,h,e){var f=[d(m.x,m.error_x,h[0],e.xaxis),d(m.y,m.error_y,h[1],e.yaxis),d(m.z,m.error_z,h[2],e.zaxis)],l=function(n){for(var a=0;a<n.length;a++)if(n[a])return n[a].length;return 0}(f);if(l===0)return null;for(var o=new Array(l),u=0;u<l;u++){for(var s=[[0,0,0],[0,0,0]],i=0;i<3;i++)if(f[i])for(var c=0;c<2;c++)s[c][i]=f[i][u][c];o[u]=s}return o}},{"../../registry":915}],1233:[function(r,I,B){var t=r("gl-line3d"),d=r("gl-scatter3d"),m=r("gl-error3d"),h=r("gl-mesh3d"),e=r("delaunay-triangulate"),f=r("../../lib"),l=r("../../lib/str2rgbarray"),o=r("../../lib/gl_format_color").formatColor,u=r("../scatter/make_bubble_size_func"),s=r("../../constants/gl3d_dashes"),i=r("../../constants/gl3d_markers"),c=r("../../plots/cartesian/axes"),n=r("../../components/fx/helpers").appendArrayPointValue,a=r("./calc_errors");function g(E,k){this.scene=E,this.uid=k,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var p=g.prototype;function y(E){return E==null?0:E.indexOf("left")>-1?-1:E.indexOf("right")>-1?1:0}function v(E){return E==null?0:E.indexOf("top")>-1?-1:E.indexOf("bottom")>-1?1:0}function b(E,k){return k(4*E)}function x(E){return i[E]}function T(E,k,L,M,P){var D=null;if(f.isArrayOrTypedArray(E)){D=[];for(var N=0;N<k;N++)E[N]===void 0?D[N]=M:D[N]=L(E[N],P)}else D=L(E,f.identity);return D}function A(E,k){var L,M,P,D,N,U,G=[],X=E.fullSceneLayout,K=E.dataScale,Z=X.xaxis,H=X.yaxis,Y=X.zaxis,$=k.marker,z=k.line,j=k.x||[],W=k.y||[],ee=k.z||[],J=j.length,Q=k.xcalendar,te=k.ycalendar,ie=k.zcalendar;for(N=0;N<J;N++)L=Z.d2l(j[N],0,Q)*K[0],M=H.d2l(W[N],0,te)*K[1],P=Y.d2l(ee[N],0,ie)*K[2],G[N]=[L,M,P];if(Array.isArray(k.text))U=k.text;else if(k.text!==void 0)for(U=new Array(J),N=0;N<J;N++)U[N]=k.text;function ae(Se,ze){var Fe=X[Se];return c.tickText(Fe,Fe.d2l(ze),!0).text}var he=k.texttemplate;if(he){var se=E.fullLayout._d3locale,de=Array.isArray(he),ue=de?Math.min(he.length,J):J,ve=de?function(Se){return he[Se]}:function(){return he};for(U=new Array(ue),N=0;N<ue;N++){var ke={x:j[N],y:W[N],z:ee[N]},Ee={xLabel:ae("xaxis",j[N]),yLabel:ae("yaxis",W[N]),zLabel:ae("zaxis",ee[N])},be={};n(be,k,N);var xe=k._meta||{};U[N]=f.texttemplateString(ve(N),Ee,se,be,ke,xe)}}if(D={position:G,mode:k.mode,text:U},"line"in k&&(D.lineColor=o(z,1,J),D.lineWidth=z.width,D.lineDashes=z.dash),"marker"in k){var ce=u(k);D.scatterColor=o($,1,J),D.scatterSize=T($.size,J,b,20,ce),D.scatterMarker=T($.symbol,J,x,"\u25CF"),D.scatterLineWidth=$.line.width,D.scatterLineColor=o($.line,1,J),D.scatterAngle=0}"textposition"in k&&(D.textOffset=function(Se){var ze=[0,0];if(Array.isArray(Se))for(var Fe=0;Fe<Se.length;Fe++)ze[Fe]=[0,0],Se[Fe]&&(ze[Fe][0]=y(Se[Fe]),ze[Fe][1]=v(Se[Fe]));else ze[0]=y(Se),ze[1]=v(Se);return ze}(k.textposition),D.textColor=o(k.textfont,1,J),D.textSize=T(k.textfont.size,J,f.identity,12),D.textFont=k.textfont.family,D.textAngle=0);var ge=["x","y","z"];for(D.project=[!1,!1,!1],D.projectScale=[1,1,1],D.projectOpacity=[1,1,1],N=0;N<3;++N){var we=k.projection[ge[N]];(D.project[N]=we.show)&&(D.projectOpacity[N]=we.opacity,D.projectScale[N]=we.scale)}D.errorBounds=a(k,K,X);var Me=function(Se){for(var ze=[0,0,0],Fe=[[0,0,0],[0,0,0],[0,0,0]],Ye=[1,1,1],rt=0;rt<3;rt++){var Oe=Se[rt];Oe&&Oe.copy_zstyle!==!1&&Se[2].visible!==!1&&(Oe=Se[2]),Oe&&Oe.visible&&(ze[rt]=Oe.width/2,Fe[rt]=l(Oe.color),Ye[rt]=Oe.thickness)}return{capSize:ze,color:Fe,lineWidth:Ye}}([k.error_x,k.error_y,k.error_z]);return D.errorColor=Me.color,D.errorLineWidth=Me.lineWidth,D.errorCapSize=Me.capSize,D.delaunayAxis=k.surfaceaxis,D.delaunayColor=l(k.surfacecolor),D}function S(E){if(f.isArrayOrTypedArray(E)){var k=E[0];return f.isArrayOrTypedArray(k)&&(E=k),"rgb("+E.slice(0,3).map(function(L){return Math.round(255*L)})+")"}return null}function w(E){return f.isArrayOrTypedArray(E)?E.length===4&&typeof E[0]=="number"?S(E):E.map(S):null}p.handlePick=function(E){if(E.object&&(E.object===this.linePlot||E.object===this.delaunayMesh||E.object===this.textMarkers||E.object===this.scatterPlot)){var k=E.index=E.data.index;return E.object.highlight&&E.object.highlight(null),this.scatterPlot&&(E.object=this.scatterPlot,this.scatterPlot.highlight(E.data)),E.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[k]||this.textLabels[k]===0)&&(E.textLabel=this.textLabels[k]):E.textLabel=this.textLabels),E.traceCoordinate=[this.data.x[k],this.data.y[k],this.data.z[k]],!0}},p.update=function(E){var k,L,M,P,D=this.scene.glplot.gl,N=s.solid;this.data=E;var U=A(this.scene,E);"mode"in U&&(this.mode=U.mode),"lineDashes"in U&&U.lineDashes in s&&(N=s[U.lineDashes]),this.color=w(U.scatterColor)||w(U.lineColor),this.dataPoints=U.position,k={gl:this.scene.glplot.gl,position:U.position,color:U.lineColor,lineWidth:U.lineWidth||1,dashes:N[0],dashScale:N[1],opacity:E.opacity,connectGaps:E.connectgaps},this.mode.indexOf("lines")!==-1?this.linePlot?this.linePlot.update(k):(this.linePlot=t(k),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var G=E.opacity;if(E.marker&&E.marker.opacity&&(G*=E.marker.opacity),L={gl:this.scene.glplot.gl,position:U.position,color:U.scatterColor,size:U.scatterSize,glyph:U.scatterMarker,opacity:G,orthographic:!0,lineWidth:U.scatterLineWidth,lineColor:U.scatterLineColor,project:U.project,projectScale:U.projectScale,projectOpacity:U.projectOpacity},this.mode.indexOf("markers")!==-1?this.scatterPlot?this.scatterPlot.update(L):(this.scatterPlot=d(L),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),P={gl:this.scene.glplot.gl,position:U.position,glyph:U.text,color:U.textColor,size:U.textSize,angle:U.textAngle,alignment:U.textOffset,font:U.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:E.opacity},this.textLabels=E.hovertext||E.text,this.mode.indexOf("text")!==-1?this.textMarkers?this.textMarkers.update(P):(this.textMarkers=d(P),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),M={gl:this.scene.glplot.gl,position:U.position,color:U.errorColor,error:U.errorBounds,lineWidth:U.errorLineWidth,capSize:U.errorCapSize,opacity:E.opacity},this.errorBars?U.errorBounds?this.errorBars.update(M):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):U.errorBounds&&(this.errorBars=m(M),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),U.delaunayAxis>=0){var X=function(K,Z,H){var Y,$=(H+1)%3,z=(H+2)%3,j=[],W=[];for(Y=0;Y<K.length;++Y){var ee=K[Y];!isNaN(ee[$])&&isFinite(ee[$])&&!isNaN(ee[z])&&isFinite(ee[z])&&(j.push([ee[$],ee[z]]),W.push(Y))}var J=e(j);for(Y=0;Y<J.length;++Y)for(var Q=J[Y],te=0;te<Q.length;++te)Q[te]=W[Q[te]];return{positions:K,cells:J,meshColor:Z}}(U.position,U.delaunayColor,U.delaunayAxis);X.opacity=E.opacity,this.delaunayMesh?this.delaunayMesh.update(X):(X.gl=D,this.delaunayMesh=h(X),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},p.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},I.exports=function(E,k){var L=new g(E,k.uid);return L.update(k),L}},{"../../components/fx/helpers":686,"../../constants/gl3d_dashes":760,"../../constants/gl3d_markers":761,"../../lib":787,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../../plots/cartesian/axes":838,"../scatter/make_bubble_size_func":1219,"./calc_errors":1232,"delaunay-triangulate":177,"gl-error3d":267,"gl-line3d":275,"gl-mesh3d":309,"gl-scatter3d":327}],1234:[function(r,I,B){var t=r("../../registry"),d=r("../../lib"),m=r("../scatter/subtypes"),h=r("../scatter/marker_defaults"),e=r("../scatter/line_defaults"),f=r("../scatter/text_defaults"),l=r("./attributes");I.exports=function(o,u,s,i){function c(b,x){return d.coerce(o,u,l,b,x)}if(function(b,x,T,A){var S=0,w=T("x"),E=T("y"),k=T("z");return t.getComponentMethod("calendars","handleTraceDefaults")(b,x,["x","y","z"],A),w&&E&&k&&(S=Math.min(w.length,E.length,k.length),x._length=x._xlength=x._ylength=x._zlength=S),S}(o,u,c,i)){c("text"),c("hovertext"),c("hovertemplate"),c("xhoverformat"),c("yhoverformat"),c("zhoverformat"),c("mode"),m.hasLines(u)&&(c("connectgaps"),e(o,u,s,i,c)),m.hasMarkers(u)&&h(o,u,s,i,c,{noSelect:!0}),m.hasText(u)&&(c("texttemplate"),f(o,u,i,c,{noSelect:!0}));var n=(u.line||{}).color,a=(u.marker||{}).color;c("surfaceaxis")>=0&&c("surfacecolor",n||a);for(var g=["x","y","z"],p=0;p<3;++p){var y="projection."+g[p];c(y+".show")&&(c(y+".opacity"),c(y+".scale"))}var v=t.getComponentMethod("errorbars","supplyDefaults");v(o,u,n||a||s,{axis:"z"}),v(o,u,n||a||s,{axis:"y",inherit:"z"}),v(o,u,n||a||s,{axis:"x",inherit:"z"})}else u.visible=!1}},{"../../lib":787,"../../registry":915,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1230}],1235:[function(r,I,B){I.exports={plot:r("./convert"),attributes:r("./attributes"),markerSymbols:r("../../constants/gl3d_markers"),supplyDefaults:r("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:r("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":761,"../../plots/gl3d":880,"./attributes":1230,"./calc":1231,"./convert":1233,"./defaults":1234}],1236:[function(r,I,B){var t=r("../scatter/attributes"),d=r("../../plots/attributes"),m=r("../../plots/template_attributes").hovertemplateAttrs,h=r("../../plots/template_attributes").texttemplateAttrs,e=r("../../components/colorscale/attributes"),f=r("../../lib/extend").extendFlat,l=t.marker,o=t.line,u=l.line;I.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:f({},t.mode,{dflt:"markers"}),text:f({},t.text,{}),texttemplate:h({editType:"plot"},{keys:["a","b","text"]}),hovertext:f({},t.hovertext,{}),line:{color:o.color,width:o.width,dash:o.dash,shape:f({},o.shape,{values:["linear","spline"]}),smoothing:o.smoothing,editType:"calc"},connectgaps:t.connectgaps,fill:f({},t.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:t.fillcolor,marker:f({symbol:l.symbol,opacity:l.opacity,maxdisplayed:l.maxdisplayed,size:l.size,sizeref:l.sizeref,sizemin:l.sizemin,sizemode:l.sizemode,line:f({width:u.width,editType:"calc"},e("marker.line")),gradient:l.gradient,editType:"calc"},e("marker")),textfont:t.textfont,textposition:t.textposition,selected:t.selected,unselected:t.unselected,hoverinfo:f({},d.hoverinfo,{flags:["a","b","text","name"]}),hoveron:t.hoveron,hovertemplate:m()}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1237:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../scatter/colorscale_calc"),m=r("../scatter/arrays_to_calcdata"),h=r("../scatter/calc_selection"),e=r("../scatter/calc").calcMarkerSize,f=r("../carpet/lookup_carpetid");I.exports=function(l,o){var u=o._carpetTrace=f(l,o);if(u&&u.visible&&u.visible!=="legendonly"){var s;o.xaxis=u.xaxis,o.yaxis=u.yaxis;var i,c,n=o._length,a=new Array(n),g=!1;for(s=0;s<n;s++)if(i=o.a[s],c=o.b[s],t(i)&&t(c)){var p=u.ab2xy(+i,+c,!0),y=u.isVisible(+i,+c);y||(g=!0),a[s]={x:p[0],y:p[1],a:i,b:c,vis:y}}else a[s]={x:!1,y:!1};return o._needsCull=g,a[0].carpet=u,a[0].trace=o,e(o,n),d(l,o),m(a,o),h(a,o),a}}},{"../carpet/lookup_carpetid":985,"../scatter/arrays_to_calcdata":1201,"../scatter/calc":1203,"../scatter/calc_selection":1204,"../scatter/colorscale_calc":1205,"fast-isnumeric":246}],1238:[function(r,I,B){var t=r("../../lib"),d=r("../scatter/constants"),m=r("../scatter/subtypes"),h=r("../scatter/marker_defaults"),e=r("../scatter/line_defaults"),f=r("../scatter/line_shape_defaults"),l=r("../scatter/text_defaults"),o=r("../scatter/fillcolor_defaults"),u=r("./attributes");I.exports=function(s,i,c,n){function a(b,x){return t.coerce(s,i,u,b,x)}a("carpet"),i.xaxis="x",i.yaxis="y";var g=a("a"),p=a("b"),y=Math.min(g.length,p.length);if(y){i._length=y,a("text"),a("texttemplate"),a("hovertext"),a("mode",y<d.PTS_LINESONLY?"lines+markers":"lines"),m.hasLines(i)&&(e(s,i,c,n,a),f(s,i,a),a("connectgaps")),m.hasMarkers(i)&&h(s,i,c,n,a,{gradient:!0}),m.hasText(i)&&l(s,i,n,a);var v=[];(m.hasMarkers(i)||m.hasText(i))&&(a("marker.maxdisplayed"),v.push("points")),a("fill"),i.fill!=="none"&&(o(s,i,c,a),m.hasLines(i)||f(s,i,a)),i.fill!=="tonext"&&i.fill!=="toself"||v.push("fills"),a("hoveron",v.join("+")||"points")!=="fills"&&a("hovertemplate"),t.coerceSelectionMarkerOpacity(i,a)}else i.visible=!1}},{"../../lib":787,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/line_shape_defaults":1217,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1236}],1239:[function(r,I,B){I.exports=function(t,d,m,h,e){var f=h[e];return t.a=f.a,t.b=f.b,t.y=f.y,t}},{}],1240:[function(r,I,B){I.exports=function(t,d){var m={},h=d._carpet,e=h.ab2ij([t.a,t.b]),f=Math.floor(e[0]),l=e[0]-f,o=Math.floor(e[1]),u=e[1]-o,s=h.evalxy([],f,o,l,u);return m.yLabel=s[1].toFixed(3),m}},{}],1241:[function(r,I,B){var t=r("../scatter/hover"),d=r("../../lib").fillText;I.exports=function(m,h,e,f){var l=t(m,h,e,f);if(l&&l[0].index!==!1){var o=l[0];if(o.index===void 0){var u=1-o.y0/m.ya._length,s=m.xa._length,i=s*u/2,c=s-i;return o.x0=Math.max(Math.min(o.x0,c),i),o.x1=Math.max(Math.min(o.x1,c),i),l}var n=o.cd[o.index];o.a=n.a,o.b=n.b,o.xLabelVal=void 0,o.yLabelVal=void 0;var a=o.trace,g=a._carpet,p=a._module.formatLabels(n,a);o.yLabel=p.yLabel,delete o.text;var y=[];if(!a.hovertemplate){var v=(n.hi||a.hoverinfo).split("+");v.indexOf("all")!==-1&&(v=["a","b","text"]),v.indexOf("a")!==-1&&b(g.aaxis,n.a),v.indexOf("b")!==-1&&b(g.baxis,n.b),y.push("y: "+o.yLabel),v.indexOf("text")!==-1&&d(n,a,y),o.extraText=y.join("<br>")}return l}function b(x,T){var A;A=x.labelprefix&&x.labelprefix.length>0?x.labelprefix.replace(/ = $/,""):x._hovertitle,y.push(A+": "+T.toFixed(3)+x.labelsuffix)}}},{"../../lib":787,"../scatter/hover":1213}],1242:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),plot:r("./plot"),style:r("../scatter/style").style,styleOnSelect:r("../scatter/style").styleOnSelect,hoverPoints:r("./hover"),selectPoints:r("../scatter/select"),eventData:r("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:r("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"../scatter/marker_colorbar":1220,"../scatter/select":1224,"../scatter/style":1226,"./attributes":1236,"./calc":1237,"./defaults":1238,"./event_data":1239,"./format_labels":1240,"./hover":1241,"./plot":1243}],1243:[function(r,I,B){var t=r("../scatter/plot"),d=r("../../plots/cartesian/axes"),m=r("../../components/drawing");I.exports=function(h,e,f,l){var o,u,s,i=f[0][0].carpet,c={xaxis:d.getFromId(h,i.xaxis||"x"),yaxis:d.getFromId(h,i.yaxis||"y"),plot:e.plot};for(t(h,c,f,l),o=0;o<f.length;o++)u=f[o][0].trace,s=l.selectAll("g.trace"+u.uid+" .js-line"),m.setClipUrl(s,f[o][0].carpet._clipPathId,h)}},{"../../components/drawing":672,"../../plots/cartesian/axes":838,"../scatter/plot":1223}],1244:[function(r,I,B){var t=r("../../plots/template_attributes").hovertemplateAttrs,d=r("../../plots/template_attributes").texttemplateAttrs,m=r("../scatter/attributes"),h=r("../../plots/attributes"),e=r("../../components/colorscale/attributes"),f=r("../../components/drawing/attributes").dash,l=r("../../lib/extend").extendFlat,o=r("../../plot_api/edit_types").overrideAll,u=m.marker,s=m.line,i=u.line;I.exports=o({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:l({},m.mode,{dflt:"markers"}),text:l({},m.text,{}),texttemplate:d({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:l({},m.hovertext,{}),textfont:m.textfont,textposition:m.textposition,line:{color:s.color,width:s.width,dash:f},connectgaps:m.connectgaps,marker:l({symbol:u.symbol,opacity:u.opacity,size:u.size,sizeref:u.sizeref,sizemin:u.sizemin,sizemode:u.sizemode,colorbar:u.colorbar,line:l({width:i.width},e("marker.line")),gradient:u.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:m.fillcolor,selected:m.selected,unselected:m.unselected,hoverinfo:l({},h.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:t()},"calc","nested")},{"../../components/colorscale/attributes":657,"../../components/drawing/attributes":671,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1245:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../constants/numerical").BADNUM,m=r("../scatter/colorscale_calc"),h=r("../scatter/arrays_to_calcdata"),e=r("../scatter/calc_selection"),f=r("../../lib")._;function l(o){return o&&typeof o=="string"}I.exports=function(o,u){var s,i=Array.isArray(u.locations),c=i?u.locations.length:u._length,n=new Array(c);s=u.geojson?function(b){return l(b)||t(b)}:l;for(var a=0;a<c;a++){var g=n[a]={};if(i){var p=u.locations[a];g.loc=s(p)?p:null}else{var y=u.lon[a],v=u.lat[a];t(y)&&t(v)?g.lonlat=[+y,+v]:g.lonlat=[d,d]}}return h(n,u),m(o,u),e(n,u),c&&(n[0].t={labels:{lat:f(o,"lat:")+" ",lon:f(o,"lon:")+" "}}),n}},{"../../constants/numerical":763,"../../lib":787,"../scatter/arrays_to_calcdata":1201,"../scatter/calc_selection":1204,"../scatter/colorscale_calc":1205,"fast-isnumeric":246}],1246:[function(r,I,B){var t=r("../../lib"),d=r("../scatter/subtypes"),m=r("../scatter/marker_defaults"),h=r("../scatter/line_defaults"),e=r("../scatter/text_defaults"),f=r("../scatter/fillcolor_defaults"),l=r("./attributes");I.exports=function(o,u,s,i){function c(b,x){return t.coerce(o,u,l,b,x)}var n,a=c("locations");if(a&&a.length){var g,p=c("geojson");(typeof p=="string"&&p!==""||t.isPlainObject(p))&&(g="geojson-id"),c("locationmode",g)==="geojson-id"&&c("featureidkey"),n=a.length}else{var y=c("lon")||[],v=c("lat")||[];n=Math.min(y.length,v.length)}n?(u._length=n,c("text"),c("hovertext"),c("hovertemplate"),c("mode"),d.hasLines(u)&&(h(o,u,s,i,c),c("connectgaps")),d.hasMarkers(u)&&m(o,u,s,i,c,{gradient:!0}),d.hasText(u)&&(c("texttemplate"),e(o,u,i,c)),c("fill"),u.fill!=="none"&&f(o,u,s,c),t.coerceSelectionMarkerOpacity(u,c)):u.visible=!1}},{"../../lib":787,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1244}],1247:[function(r,I,B){I.exports=function(t,d,m,h,e){t.lon=d.lon,t.lat=d.lat,t.location=d.loc?d.loc:null;var f=h[e];return f.fIn&&f.fIn.properties&&(t.properties=f.fIn.properties),t}},{}],1248:[function(r,I,B){var t=r("../../plots/cartesian/axes");I.exports=function(d,m,h){var e={},f=h[m.geo]._subplot.mockAxis,l=d.lonlat;return e.lonLabel=t.tickText(f,f.c2l(l[0]),!0).text,e.latLabel=t.tickText(f,f.c2l(l[1]),!0).text,e}},{"../../plots/cartesian/axes":838}],1249:[function(r,I,B){var t=r("../../components/fx"),d=r("../../constants/numerical").BADNUM,m=r("../scatter/get_trace_color"),h=r("../../lib").fillText,e=r("./attributes");I.exports=function(f,l,o){var u=f.cd,s=u[0].trace,i=f.xa,c=f.ya,n=f.subplot,a=n.projection.isLonLatOverEdges,g=n.project;if(t.getClosest(u,function(A){var S=A.lonlat;if(S[0]===d||a(S))return 1/0;var w=g(S),E=g([l,o]),k=Math.abs(w[0]-E[0]),L=Math.abs(w[1]-E[1]),M=Math.max(3,A.mrc||0);return Math.max(Math.sqrt(k*k+L*L)-M,1-3/M)},f),f.index!==!1){var p=u[f.index],y=p.lonlat,v=[i.c2p(y),c.c2p(y)],b=p.mrc||1;f.x0=v[0]-b,f.x1=v[0]+b,f.y0=v[1]-b,f.y1=v[1]+b,f.loc=p.loc,f.lon=y[0],f.lat=y[1];var x={};x[s.geo]={_subplot:n};var T=s._module.formatLabels(p,s,x);return f.lonLabel=T.lonLabel,f.latLabel=T.latLabel,f.color=m(s,p),f.extraText=function(A,S,w,E){if(A.hovertemplate)return;var k=S.hi||A.hoverinfo,L=k==="all"?e.hoverinfo.flags:k.split("+"),M=L.indexOf("location")!==-1&&Array.isArray(A.locations),P=L.indexOf("lon")!==-1,D=L.indexOf("lat")!==-1,N=L.indexOf("text")!==-1,U=[];function G(X){return X+"\xB0"}return M?U.push(S.loc):P&&D?U.push("("+G(w.latLabel)+", "+G(w.lonLabel)+")"):P?U.push(E.lon+G(w.lonLabel)):D&&U.push(E.lat+G(w.latLabel)),N&&h(S,A,U),U.join("<br>")}(s,p,f,u[0].t.labels),f.hovertemplate=s.hovertemplate,[f]}}},{"../../components/fx":690,"../../constants/numerical":763,"../../lib":787,"../scatter/get_trace_color":1212,"./attributes":1244}],1250:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),calcGeoJSON:r("./plot").calcGeoJSON,plot:r("./plot").plot,style:r("./style"),styleOnSelect:r("../scatter/style").styleOnSelect,hoverPoints:r("./hover"),eventData:r("./event_data"),selectPoints:r("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:r("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":871,"../scatter/marker_colorbar":1220,"../scatter/style":1226,"./attributes":1244,"./calc":1245,"./defaults":1246,"./event_data":1247,"./format_labels":1248,"./hover":1249,"./plot":1251,"./select":1252,"./style":1253}],1251:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../lib/topojson_utils").getTopojsonFeatures,h=r("../../lib/geojson_utils"),e=r("../../lib/geo_location_utils"),f=r("../../plots/cartesian/autorange").findExtremes,l=r("../../constants/numerical").BADNUM,o=r("../scatter/calc").calcMarkerSize,u=r("../scatter/subtypes"),s=r("./style");I.exports={calcGeoJSON:function(i,c){var n,a,g=i[0].trace,p=c[g.geo],y=p._subplot,v=g._length;if(Array.isArray(g.locations)){var b=g.locationmode,x=b==="geojson-id"?e.extractTraceFeature(i):m(g,y.topojson);for(n=0;n<v;n++){a=i[n];var T=b==="geojson-id"?a.fOut:e.locationToFeature(b,a.loc,x);a.lonlat=T?T.properties.ct:[l,l]}}var A,S,w={padded:!0};if(p.fitbounds==="geojson"&&g.locationmode==="geojson-id"){var E=e.computeBbox(e.getTraceGeojson(g));A=[E[0],E[2]],S=[E[1],E[3]]}else{for(A=new Array(v),S=new Array(v),n=0;n<v;n++)a=i[n],A[n]=a.lonlat[0],S[n]=a.lonlat[1];w.ppad=o(g,v)}g._extremes.lon=f(p.lonaxis._ax,A,w),g._extremes.lat=f(p.lataxis._ax,S,w)},plot:function(i,c,n){var a=c.layers.frontplot.select(".scatterlayer"),g=d.makeTraceGroups(a,n,"trace scattergeo");function p(y,v){y.lonlat[0]===l&&t.select(v).remove()}g.selectAll("*").remove(),g.each(function(y){var v=t.select(this),b=y[0].trace;if(u.hasLines(b)||b.fill!=="none"){var x=h.calcTraceToLineCoords(y),T=b.fill!=="none"?h.makePolygon(x):h.makeLine(x);v.selectAll("path.js-line").data([{geojson:T,trace:b}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}u.hasMarkers(b)&&v.selectAll("path.point").data(d.identity).enter().append("path").classed("point",!0).each(function(A){p(A,this)}),u.hasText(b)&&v.selectAll("g").data(d.identity).enter().append("g").append("text").each(function(A){p(A,this)}),s(i,y)})}}},{"../../constants/numerical":763,"../../lib":787,"../../lib/geo_location_utils":780,"../../lib/geojson_utils":781,"../../lib/topojson_utils":816,"../../plots/cartesian/autorange":837,"../scatter/calc":1203,"../scatter/subtypes":1227,"./style":1253,"@plotly/d3":58}],1252:[function(r,I,B){var t=r("../scatter/subtypes"),d=r("../../constants/numerical").BADNUM;I.exports=function(m,h){var e,f,l,o,u,s=m.cd,i=m.xaxis,c=m.yaxis,n=[],a=s[0].trace;if(!t.hasMarkers(a)&&!t.hasText(a))return[];if(h===!1)for(u=0;u<s.length;u++)s[u].selected=0;else for(u=0;u<s.length;u++)(f=(e=s[u]).lonlat)[0]!==d&&(l=i.c2p(f),o=c.c2p(f),h.contains([l,o],null,u,m)?(n.push({pointNumber:u,lon:f[0],lat:f[1]}),e.selected=1):e.selected=0);return n}},{"../../constants/numerical":763,"../scatter/subtypes":1227}],1253:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/drawing"),m=r("../../components/color"),h=r("../scatter/style"),e=h.stylePoints,f=h.styleText;I.exports=function(l,o){o&&function(u,s){var i=s[0].trace,c=s[0].node3;c.style("opacity",s[0].trace.opacity),e(c,i,u),f(c,i,u),c.selectAll("path.js-line").style("fill","none").each(function(n){var a=t.select(this),g=n.trace,p=g.line||{};a.call(m.stroke,p.color).call(d.dashLine,p.dash||"",p.width||0),g.fill!=="none"&&a.call(m.fill,g.fillcolor)})}(l,o)}},{"../../components/color":650,"../../components/drawing":672,"../scatter/style":1226,"@plotly/d3":58}],1254:[function(r,I,B){var t=r("../../plots/attributes"),d=r("../scatter/attributes"),m=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,h=r("../../components/colorscale/attributes"),e=r("../../lib/sort_object_keys"),f=r("../../lib/extend").extendFlat,l=r("../../plot_api/edit_types").overrideAll,o=r("./constants").DASHES,u=d.line,s=d.marker,i=s.line,c=I.exports=l({x:d.x,x0:d.x0,dx:d.dx,y:d.y,y0:d.y0,dy:d.dy,xperiod:d.xperiod,yperiod:d.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:d.xperiodalignment,yperiodalignment:d.yperiodalignment,xhoverformat:m("x"),yhoverformat:m("y"),text:d.text,hovertext:d.hovertext,textposition:d.textposition,textfont:d.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:u.color,width:u.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:e(o),dflt:"solid"}},marker:f({},h("marker"),{symbol:s.symbol,size:s.size,sizeref:s.sizeref,sizemin:s.sizemin,sizemode:s.sizemode,opacity:s.opacity,colorbar:s.colorbar,line:f({},h("marker.line"),{width:i.width})}),connectgaps:d.connectgaps,fill:f({},d.fill,{dflt:"none"}),fillcolor:d.fillcolor,selected:{marker:d.selected.marker,textfont:d.selected.textfont},unselected:{marker:d.unselected.marker,textfont:d.unselected.textfont},opacity:t.opacity},"calc","nested");c.x.editType=c.y.editType=c.x0.editType=c.y0.editType="calc+clearAxisTypes",c.hovertemplate=d.hovertemplate,c.texttemplate=d.texttemplate},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../lib/sort_object_keys":810,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../scatter/attributes":1202,"./constants":1256}],1255:[function(r,I,B){var t=r("@plotly/point-cluster"),d=r("../../lib"),m=r("../../plots/cartesian/axis_ids"),h=r("../../plots/cartesian/autorange").findExtremes,e=r("../../plots/cartesian/align_period"),f=r("../scatter/calc"),l=f.calcMarkerSize,o=f.calcAxisExpansion,u=f.setFirstScatter,s=r("../scatter/colorscale_calc"),i=r("./convert"),c=r("./scene_update"),n=r("../../constants/numerical").BADNUM,a=r("./constants").TOO_MANY_POINTS;function g(p,y,v){var b=p._extremes[y._id],x=h(y,v._bnds,{padded:!0});b.min=b.min.concat(x.min),b.max=b.max.concat(x.max)}I.exports=function(p,y){var v,b=p._fullLayout,x=m.getFromId(p,y.xaxis),T=m.getFromId(p,y.yaxis),A=b._plots[y.xaxis+y.yaxis],S=y._length,w=S>=a,E=2*S,k={},L=x.makeCalcdata(y,"x"),M=T.makeCalcdata(y,"y"),P=e(y,x,"x",L),D=e(y,T,"y",M),N=P.vals,U=D.vals;y._x=N,y._y=U,y.xperiodalignment&&(y._origX=L,y._xStarts=P.starts,y._xEnds=P.ends),y.yperiodalignment&&(y._origY=M,y._yStarts=D.starts,y._yEnds=D.ends);var G=new Array(E),X=new Array(S);for(v=0;v<S;v++)G[2*v]=N[v]===n?NaN:N[v],G[2*v+1]=U[v]===n?NaN:U[v],X[v]=v;if(x.type==="log")for(v=0;v<E;v+=2)G[v]=x.c2l(G[v]);if(T.type==="log")for(v=1;v<E;v+=2)G[v]=T.c2l(G[v]);w&&x.type!=="log"&&T.type!=="log"?k.tree=t(G):k.ids=X,s(p,y);var K,Z=function(Y,$,z,j,W,ee){var J=i.style(Y,z);if(J.marker&&(J.marker.positions=j),J.line&&j.length>1&&d.extendFlat(J.line,i.linePositions(Y,z,j)),J.errorX||J.errorY){var Q=i.errorBarPositions(Y,z,j,W,ee);J.errorX&&d.extendFlat(J.errorX,Q.x),J.errorY&&d.extendFlat(J.errorY,Q.y)}return J.text&&(d.extendFlat(J.text,{positions:j},i.textPosition(Y,z,J.text,J.marker)),d.extendFlat(J.textSel,{positions:j},i.textPosition(Y,z,J.text,J.markerSel)),d.extendFlat(J.textUnsel,{positions:j},i.textPosition(Y,z,J.text,J.markerUnsel))),J}(p,0,y,G,N,U),H=c(p,A);return u(b,y),w?Z.marker&&(K=Z.marker.sizeAvg||Math.max(Z.marker.size,3)):K=l(y,S),o(p,y,x,T,N,U,K),Z.errorX&&g(y,x,Z.errorX),Z.errorY&&g(y,T,Z.errorY),Z.fill&&!H.fill2d&&(H.fill2d=!0),Z.marker&&!H.scatter2d&&(H.scatter2d=!0),Z.line&&!H.line2d&&(H.line2d=!0),!Z.errorX&&!Z.errorY||H.error2d||(H.error2d=!0),Z.text&&!H.glText&&(H.glText=!0),Z.marker&&(Z.marker.snap=S),H.lineOptions.push(Z.line),H.errorXOptions.push(Z.errorX),H.errorYOptions.push(Z.errorY),H.fillOptions.push(Z.fill),H.markerOptions.push(Z.marker),H.markerSelectedOptions.push(Z.markerSel),H.markerUnselectedOptions.push(Z.markerUnsel),H.textOptions.push(Z.text),H.textSelectedOptions.push(Z.textSel),H.textUnselectedOptions.push(Z.textUnsel),H.selectBatch.push([]),H.unselectBatch.push([]),k._scene=H,k.index=H.count,k.x=N,k.y=U,k.positions=G,H.count++,[{x:!1,y:!1,t:k,trace:y}]}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/autorange":837,"../../plots/cartesian/axis_ids":842,"../scatter/calc":1203,"../scatter/colorscale_calc":1205,"./constants":1256,"./convert":1257,"./scene_update":1265,"@plotly/point-cluster":59}],1256:[function(r,I,B){I.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],1257:[function(r,I,B){var t=r("fast-isnumeric"),d=r("svg-path-sdf"),m=r("color-normalize"),h=r("../../registry"),e=r("../../lib"),f=r("../../components/drawing"),l=r("../../plots/cartesian/axis_ids"),o=r("../../lib/gl_format_color").formatColor,u=r("../scatter/subtypes"),s=r("../scatter/make_bubble_size_func"),i=r("./helpers"),c=r("./constants"),n=r("../../constants/interactions").DESELECTDIM,a={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},g=r("../../components/fx/helpers").appendArrayPointValue;function p(L,M){var P,D=L._fullLayout,N=M._length,U=M.textfont,G=M.textposition,X=Array.isArray(G)?G:[G],K=U.color,Z=U.size,H=U.family,Y={},$=L._context.plotGlPixelRatio,z=M.texttemplate;if(z){Y.text=[];var j=D._d3locale,W=Array.isArray(z),ee=W?Math.min(z.length,N):N,J=W?function(de){return z[de]}:function(){return z};for(P=0;P<ee;P++){var Q={i:P},te=M._module.formatLabels(Q,M,D),ie={};g(ie,M,P);var ae=M._meta||{};Y.text.push(e.texttemplateString(J(P),te,j,ie,Q,ae))}}else Array.isArray(M.text)&&M.text.length<N?Y.text=M.text.slice():Y.text=M.text;if(Array.isArray(Y.text))for(P=Y.text.length;P<N;P++)Y.text[P]="";for(Y.opacity=M.opacity,Y.font={},Y.align=[],Y.baseline=[],P=0;P<X.length;P++){var he=X[P].split(/\s+/);switch(he[1]){case"left":Y.align.push("right");break;case"right":Y.align.push("left");break;default:Y.align.push(he[1])}switch(he[0]){case"top":Y.baseline.push("bottom");break;case"bottom":Y.baseline.push("top");break;default:Y.baseline.push(he[0])}}if(Array.isArray(K))for(Y.color=new Array(N),P=0;P<N;P++)Y.color[P]=K[P];else Y.color=K;if(e.isArrayOrTypedArray(Z)||Array.isArray(H))for(Y.font=new Array(N),P=0;P<N;P++){var se=Y.font[P]={};se.size=(e.isTypedArray(Z)?Z[P]:Array.isArray(Z)?t(Z[P])?Z[P]:0:Z)*$,se.family=Array.isArray(H)?H[P]:H}else Y.font={size:Z*$,family:H};return Y}function y(L){var M,P,D=L._length,N=L.marker,U={},G=e.isArrayOrTypedArray(N.symbol),X=e.isArrayOrTypedArray(N.color),K=e.isArrayOrTypedArray(N.line.color),Z=e.isArrayOrTypedArray(N.opacity),H=e.isArrayOrTypedArray(N.size),Y=e.isArrayOrTypedArray(N.line.width);if(G||(P=i.isOpenSymbol(N.symbol)),G||X||K||Z){U.colors=new Array(D),U.borderColors=new Array(D);var $=o(N,N.opacity,D),z=o(N.line,N.opacity,D);if(!Array.isArray(z[0])){var j=z;for(z=Array(D),M=0;M<D;M++)z[M]=j}if(!Array.isArray($[0])){var W=$;for($=Array(D),M=0;M<D;M++)$[M]=W}for(U.colors=$,U.borderColors=z,M=0;M<D;M++){if(G){var ee=N.symbol[M];P=i.isOpenSymbol(ee)}P&&(z[M]=$[M].slice(),$[M]=$[M].slice(),$[M][3]=0)}U.opacity=L.opacity}else P?(U.color=m(N.color,"uint8"),U.color[3]=0,U.borderColor=m(N.color,"uint8")):(U.color=m(N.color,"uint8"),U.borderColor=m(N.line.color,"uint8")),U.opacity=L.opacity*N.opacity;if(G)for(U.markers=new Array(D),M=0;M<D;M++)U.markers[M]=k(N.symbol[M]);else U.marker=k(N.symbol);var J,Q=s(L,1);if(H||Y){var te,ie=U.sizes=new Array(D),ae=U.borderSizes=new Array(D),he=0;if(H){for(M=0;M<D;M++)ie[M]=Q(N.size[M]),he+=ie[M];te=he/D}else for(J=Q(N.size),M=0;M<D;M++)ie[M]=J;if(Y)for(M=0;M<D;M++)ae[M]=N.line.width[M];else for(J=N.line.width,M=0;M<D;M++)ae[M]=J;U.sizeAvg=te}else U.size=Q(N&&N.size||10),U.borderSizes=Q(N.line.width);return U}function v(L,M){var P=L.marker,D={};return M&&(M.marker&&M.marker.symbol?D=y(e.extendFlat({},P,M.marker)):M.marker&&(M.marker.size&&(D.size=M.marker.size),M.marker.color&&(D.colors=M.marker.color),M.marker.opacity!==void 0&&(D.opacity=M.marker.opacity))),D}function b(L,M,P){var D={};if(!P)return D;if(P.textfont){var N={opacity:1,text:M.text,texttemplate:M.texttemplate,textposition:M.textposition,textfont:e.extendFlat({},M.textfont)};P.textfont&&e.extendFlat(N.textfont,P.textfont),D=p(L,N)}return D}function x(L,M,P){var D={capSize:2*M.width*P,lineWidth:M.thickness*P,color:M.color};return M.copy_ystyle&&(D=L.error_y),D}var T=c.SYMBOL_SDF_SIZE,A=c.SYMBOL_SIZE,S=c.SYMBOL_STROKE,w={},E=f.symbolFuncs[0](.05*A);function k(L){if(L==="circle")return null;var M,P,D=f.symbolNumber(L),N=f.symbolFuncs[D%100],U=!!f.symbolNoDot[D%100],G=!!f.symbolNoFill[D%100],X=i.isDotSymbol(L);return w[L]?w[L]:(M=X&&!U?N(1.1*A)+E:N(A),P=d(M,{w:T,h:T,viewBox:[-A,-A,A,A],stroke:G?S:-S}),w[L]=P,P||null)}I.exports={style:function(L,M){var P,D={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},N=L._context.plotGlPixelRatio;if(M.visible!==!0)return D;if(u.hasText(M)&&(D.text=p(L,M),D.textSel=b(L,M,M.selected),D.textUnsel=b(L,M,M.unselected)),u.hasMarkers(M)&&(D.marker=y(M),D.markerSel=v(M,M.selected),D.markerUnsel=v(M,M.unselected),!M.unselected&&e.isArrayOrTypedArray(M.marker.opacity))){var U=M.marker.opacity;for(D.markerUnsel.opacity=new Array(U.length),P=0;P<U.length;P++)D.markerUnsel.opacity[P]=n*U[P]}if(u.hasLines(M)){D.line={overlay:!0,thickness:M.line.width*N,color:M.line.color,opacity:M.opacity};var G=(c.DASHES[M.line.dash]||[1]).slice();for(P=0;P<G.length;++P)G[P]*=M.line.width*N;D.line.dashes=G}return M.error_x&&M.error_x.visible&&(D.errorX=x(M,M.error_x,N)),M.error_y&&M.error_y.visible&&(D.errorY=x(M,M.error_y,N)),M.fill&&M.fill!=="none"&&(D.fill={closed:!0,fill:M.fillcolor,thickness:0}),D},markerStyle:y,markerSelection:v,linePositions:function(L,M,P){var D,N,U=P.length,G=U/2;if(u.hasLines(M)&&G)if(M.line.shape==="hv"){for(D=[],N=0;N<G-1;N++)isNaN(P[2*N])||isNaN(P[2*N+1])?D.push(NaN,NaN,NaN,NaN):(D.push(P[2*N],P[2*N+1]),isNaN(P[2*N+2])||isNaN(P[2*N+3])?D.push(NaN,NaN):D.push(P[2*N+2],P[2*N+1]));D.push(P[U-2],P[U-1])}else if(M.line.shape==="hvh"){for(D=[],N=0;N<G-1;N++)if(isNaN(P[2*N])||isNaN(P[2*N+1])||isNaN(P[2*N+2])||isNaN(P[2*N+3]))isNaN(P[2*N])||isNaN(P[2*N+1])?D.push(NaN,NaN):D.push(P[2*N],P[2*N+1]),D.push(NaN,NaN);else{var X=(P[2*N]+P[2*N+2])/2;D.push(P[2*N],P[2*N+1],X,P[2*N+1],X,P[2*N+3])}D.push(P[U-2],P[U-1])}else if(M.line.shape==="vhv"){for(D=[],N=0;N<G-1;N++)if(isNaN(P[2*N])||isNaN(P[2*N+1])||isNaN(P[2*N+2])||isNaN(P[2*N+3]))isNaN(P[2*N])||isNaN(P[2*N+1])?D.push(NaN,NaN):D.push(P[2*N],P[2*N+1]),D.push(NaN,NaN);else{var K=(P[2*N+1]+P[2*N+3])/2;D.push(P[2*N],P[2*N+1],P[2*N],K,P[2*N+2],K)}D.push(P[U-2],P[U-1])}else if(M.line.shape==="vh"){for(D=[],N=0;N<G-1;N++)isNaN(P[2*N])||isNaN(P[2*N+1])?D.push(NaN,NaN,NaN,NaN):(D.push(P[2*N],P[2*N+1]),isNaN(P[2*N+2])||isNaN(P[2*N+3])?D.push(NaN,NaN):D.push(P[2*N],P[2*N+3]));D.push(P[U-2],P[U-1])}else D=P;var Z=!1;for(N=0;N<D.length;N++)if(isNaN(D[N])){Z=!0;break}var H=Z||D.length>c.TOO_MANY_POINTS||u.hasMarkers(M)?"rect":"round";if(Z&&M.connectgaps){var Y=D[0],$=D[1];for(N=0;N<D.length;N+=2)isNaN(D[N])||isNaN(D[N+1])?(D[N]=Y,D[N+1]=$):(Y=D[N],$=D[N+1])}return{join:H,positions:D}},errorBarPositions:function(L,M,P,D,N){var U=h.getComponentMethod("errorbars","makeComputeError"),G=l.getFromId(L,M.xaxis),X=l.getFromId(L,M.yaxis),K=P.length/2,Z={};function H(Y,$){var z=$._id.charAt(0),j=M["error_"+z];if(j&&j.visible&&($.type==="linear"||$.type==="log")){for(var W=U(j),ee={x:0,y:1}[z],J={x:[0,1,2,3],y:[2,3,0,1]}[z],Q=new Float64Array(4*K),te=1/0,ie=-1/0,ae=0,he=0;ae<K;ae++,he+=4){var se=Y[ae];if(t(se)){var de=P[2*ae+ee],ue=W(se,ae),ve=ue[0],ke=ue[1];if(t(ve)&&t(ke)){var Ee=se-ve,be=se+ke;Q[he+J[0]]=de-$.c2l(Ee),Q[he+J[1]]=$.c2l(be)-de,Q[he+J[2]]=0,Q[he+J[3]]=0,te=Math.min(te,se-ve),ie=Math.max(ie,se+ke)}}}Z[z]={positions:P,errors:Q,_bnds:[te,ie]}}}return H(D,G),H(N,X),Z},textPosition:function(L,M,P,D){var N,U=M._length,G={};if(u.hasMarkers(M)){var X=P.font,K=P.align,Z=P.baseline;for(G.offset=new Array(U),N=0;N<U;N++){var H=D.sizes?D.sizes[N]:D.size,Y=Array.isArray(X)?X[N].size:X.size,$=Array.isArray(K)?K.length>1?K[N]:K[0]:K,z=Array.isArray(Z)?Z.length>1?Z[N]:Z[0]:Z,j=a[$],W=a[z],ee=H?H/.8+1:0,J=-W*ee-.5*W;G.offset[N]=[j*ee/Y,J/Y]}}return G}}},{"../../components/drawing":672,"../../components/fx/helpers":686,"../../constants/interactions":762,"../../lib":787,"../../lib/gl_format_color":783,"../../plots/cartesian/axis_ids":842,"../../registry":915,"../scatter/make_bubble_size_func":1219,"../scatter/subtypes":1227,"./constants":1256,"./helpers":1261,"color-normalize":131,"fast-isnumeric":246,"svg-path-sdf":580}],1258:[function(r,I,B){var t=r("../../lib"),d=r("../../registry"),m=r("./helpers"),h=r("./attributes"),e=r("../scatter/constants"),f=r("../scatter/subtypes"),l=r("../scatter/xy_defaults"),o=r("../scatter/period_defaults"),u=r("../scatter/marker_defaults"),s=r("../scatter/line_defaults"),i=r("../scatter/fillcolor_defaults"),c=r("../scatter/text_defaults");I.exports=function(n,a,g,p){function y(E,k){return t.coerce(n,a,h,E,k)}var v=!!n.marker&&m.isOpenSymbol(n.marker.symbol),b=f.isBubble(n),x=l(n,a,p,y);if(x){o(n,a,p,y),y("xhoverformat"),y("yhoverformat");var T=x<e.PTS_LINESONLY?"lines+markers":"lines";y("text"),y("hovertext"),y("hovertemplate"),y("mode",T),f.hasLines(a)&&(y("connectgaps"),s(n,a,g,p,y),y("line.shape")),f.hasMarkers(a)&&(u(n,a,g,p,y),y("marker.line.width",v||b?1:0)),f.hasText(a)&&(y("texttemplate"),c(n,a,p,y));var A=(a.line||{}).color,S=(a.marker||{}).color;y("fill"),a.fill!=="none"&&i(n,a,g,y);var w=d.getComponentMethod("errorbars","supplyDefaults");w(n,a,A||S||g,{axis:"y"}),w(n,a,A||S||g,{axis:"x",inherit:"y"}),t.coerceSelectionMarkerOpacity(a,y)}else a.visible=!1}},{"../../lib":787,"../../registry":915,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/period_defaults":1222,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"../scatter/xy_defaults":1229,"./attributes":1254,"./helpers":1261}],1259:[function(r,I,B){var t=r("../../lib"),d=r("../../components/color"),m=r("../../constants/interactions").DESELECTDIM;I.exports={styleTextSelection:function(h){var e,f,l=h[0],o=l.trace,u=l.t,s=u._scene,i=u.index,c=s.selectBatch[i],n=s.unselectBatch[i],a=s.textOptions[i],g=s.textSelectedOptions[i]||{},p=s.textUnselectedOptions[i]||{},y=t.extendFlat({},a);if(c.length||n.length){var v=g.color,b=p.color,x=a.color,T=Array.isArray(x);for(y.color=new Array(o._length),e=0;e<c.length;e++)f=c[e],y.color[f]=v||(T?x[f]:x);for(e=0;e<n.length;e++){f=n[e];var A=T?x[f]:x;y.color[f]=b||(v?A:d.addOpacity(A,m))}}s.glText[i].update(y)}}},{"../../components/color":650,"../../constants/interactions":762,"../../lib":787}],1260:[function(r,I,B){var t=r("../scatter/format_labels");I.exports=function(d,m,h){var e=d.i;return"x"in d||(d.x=m._x[e]),"y"in d||(d.y=m._y[e]),t(d,m,h)}},{"../scatter/format_labels":1211}],1261:[function(r,I,B){var t=r("./constants");B.isOpenSymbol=function(d){return typeof d=="string"?t.OPEN_RE.test(d):d%200>100},B.isDotSymbol=function(d){return typeof d=="string"?t.DOT_RE.test(d):d>200}},{"./constants":1256}],1262:[function(r,I,B){var t=r("../../registry"),d=r("../../lib"),m=r("../scatter/get_trace_color");function h(e,f,l,o){var u=e.xa,s=e.ya,i=e.distance,c=e.dxy,n=e.index,a={pointNumber:n,x:f[n],y:l[n]};a.tx=Array.isArray(o.text)?o.text[n]:o.text,a.htx=Array.isArray(o.hovertext)?o.hovertext[n]:o.hovertext,a.data=Array.isArray(o.customdata)?o.customdata[n]:o.customdata,a.tp=Array.isArray(o.textposition)?o.textposition[n]:o.textposition;var g=o.textfont;g&&(a.ts=d.isArrayOrTypedArray(g.size)?g.size[n]:g.size,a.tc=Array.isArray(g.color)?g.color[n]:g.color,a.tf=Array.isArray(g.family)?g.family[n]:g.family);var p=o.marker;p&&(a.ms=d.isArrayOrTypedArray(p.size)?p.size[n]:p.size,a.mo=d.isArrayOrTypedArray(p.opacity)?p.opacity[n]:p.opacity,a.mx=d.isArrayOrTypedArray(p.symbol)?p.symbol[n]:p.symbol,a.mc=d.isArrayOrTypedArray(p.color)?p.color[n]:p.color);var y=p&&p.line;y&&(a.mlc=Array.isArray(y.color)?y.color[n]:y.color,a.mlw=d.isArrayOrTypedArray(y.width)?y.width[n]:y.width);var v=p&&p.gradient;v&&v.type!=="none"&&(a.mgt=Array.isArray(v.type)?v.type[n]:v.type,a.mgc=Array.isArray(v.color)?v.color[n]:v.color);var b=u.c2p(a.x,!0),x=s.c2p(a.y,!0),T=a.mrc||1,A=o.hoverlabel;A&&(a.hbg=Array.isArray(A.bgcolor)?A.bgcolor[n]:A.bgcolor,a.hbc=Array.isArray(A.bordercolor)?A.bordercolor[n]:A.bordercolor,a.hts=d.isArrayOrTypedArray(A.font.size)?A.font.size[n]:A.font.size,a.htc=Array.isArray(A.font.color)?A.font.color[n]:A.font.color,a.htf=Array.isArray(A.font.family)?A.font.family[n]:A.font.family,a.hnl=d.isArrayOrTypedArray(A.namelength)?A.namelength[n]:A.namelength);var S=o.hoverinfo;S&&(a.hi=Array.isArray(S)?S[n]:S);var w=o.hovertemplate;w&&(a.ht=Array.isArray(w)?w[n]:w);var E={};E[e.index]=a;var k=o._origX,L=o._origY,M=d.extendFlat({},e,{color:m(o,a),x0:b-T,x1:b+T,xLabelVal:k?k[n]:a.x,y0:x-T,y1:x+T,yLabelVal:L?L[n]:a.y,cd:E,distance:i,spikeDistance:c,hovertemplate:a.ht});return a.htx?M.text=a.htx:a.tx?M.text=a.tx:o.text&&(M.text=o.text),d.fillText(a,o,M),t.getComponentMethod("errorbars","hoverInfo")(a,o,M),M}I.exports={hoverPoints:function(e,f,l,o){var u,s,i,c,n,a,g,p,y,v,b=e.cd,x=b[0].t,T=b[0].trace,A=e.xa,S=e.ya,w=x.x,E=x.y,k=A.c2p(f),L=S.c2p(l),M=e.distance;if(x.tree){var P=A.p2c(k-M),D=A.p2c(k+M),N=S.p2c(L-M),U=S.p2c(L+M);u=o==="x"?x.tree.range(Math.min(P,D),Math.min(S._rl[0],S._rl[1]),Math.max(P,D),Math.max(S._rl[0],S._rl[1])):x.tree.range(Math.min(P,D),Math.min(N,U),Math.max(P,D),Math.max(N,U))}else u=x.ids;var G=M;if(o==="x"){var X=!!T.xperiodalignment,K=!!T.yperiodalignment;for(a=0;a<u.length;a++){if(c=w[s=u[a]],g=Math.abs(A.c2p(c)-k),X){var Z=A.c2p(T._xStarts[s]),H=A.c2p(T._xEnds[s]);g=k>=Math.min(Z,H)&&k<=Math.max(Z,H)?0:1/0}if(g<G){if(G=g,n=E[s],p=S.c2p(n)-L,K){var Y=S.c2p(T._yStarts[s]),$=S.c2p(T._yEnds[s]);p=L>=Math.min(Y,$)&&L<=Math.max(Y,$)?0:1/0}v=Math.sqrt(g*g+p*p),i=u[a]}}}else for(a=u.length-1;a>-1;a--)c=w[s=u[a]],n=E[s],g=A.c2p(c)-k,p=S.c2p(n)-L,(y=Math.sqrt(g*g+p*p))<G&&(G=v=y,i=s);return e.index=i,e.distance=G,e.dxy=v,i===void 0?[e]:[h(e,w,E,T)]},calcHover:h}},{"../../lib":787,"../../registry":915,"../scatter/get_trace_color":1212}],1263:[function(r,I,B){var t=r("./hover");I.exports={moduleType:"trace",name:"scattergl",basePlotModule:r("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:r("./attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("../scatter/cross_trace_defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),plot:r("./plot"),hoverPoints:t.hoverPoints,selectPoints:r("./select"),meta:{}}},{"../../plots/cartesian":852,"../scatter/cross_trace_defaults":1208,"../scatter/marker_colorbar":1220,"./attributes":1254,"./calc":1255,"./defaults":1258,"./format_labels":1260,"./hover":1262,"./plot":1264,"./select":1266}],1264:[function(r,I,B){var t=r("regl-scatter2d"),d=r("regl-line2d"),m=r("regl-error2d"),h=r("gl-text"),e=r("../../lib"),f=r("../../components/dragelement/helpers").selectMode,l=r("../../lib/prepare_regl"),o=r("../scatter/subtypes"),u=r("../scatter/link_traces"),s=r("./edit_style").styleTextSelection;function i(c,n,a,g){var p=c._size,y=c.width*g,v=c.height*g,b=p.l*g,x=p.b*g,T=p.r*g,A=p.t*g,S=p.w*g,w=p.h*g;return[b+n.domain[0]*S,x+a.domain[0]*w,y-T-(1-n.domain[1])*S,v-A-(1-a.domain[1])*w]}I.exports=function(c,n,a){if(a.length){var g,p,y=c._fullLayout,v=n._scene,b=n.xaxis,x=n.yaxis;if(v)if(l(c,["ANGLE_instanced_arrays","OES_element_index_uint"])){var T=v.count,A=y._glcanvas.data()[0].regl;if(u(c,n,a),v.dirty){if(v.error2d===!0&&(v.error2d=m(A)),v.line2d===!0&&(v.line2d=d(A)),v.scatter2d===!0&&(v.scatter2d=t(A)),v.fill2d===!0&&(v.fill2d=d(A)),v.glText===!0)for(v.glText=new Array(T),g=0;g<T;g++)v.glText[g]=new h(A);if(v.glText){if(T>v.glText.length){var S=T-v.glText.length;for(g=0;g<S;g++)v.glText.push(new h(A))}else if(T<v.glText.length){var w=v.glText.length-T;v.glText.splice(T,w).forEach(function(J){J.destroy()})}for(g=0;g<T;g++)v.glText[g].update(v.textOptions[g])}if(v.line2d&&(v.line2d.update(v.lineOptions),v.lineOptions=v.lineOptions.map(function(J){if(J&&J.positions){for(var Q=J.positions,te=0;te<Q.length&&(isNaN(Q[te])||isNaN(Q[te+1]));)te+=2;for(var ie=Q.length-2;ie>te&&(isNaN(Q[ie])||isNaN(Q[ie+1]));)ie-=2;J.positions=Q.slice(te,ie+2)}return J}),v.line2d.update(v.lineOptions)),v.error2d){var E=(v.errorXOptions||[]).concat(v.errorYOptions||[]);v.error2d.update(E)}v.scatter2d&&v.scatter2d.update(v.markerOptions),v.fillOrder=e.repeat(null,T),v.fill2d&&(v.fillOptions=v.fillOptions.map(function(J,Q){var te=a[Q];if(J&&te&&te[0]&&te[0].trace){var ie,ae,he=te[0],se=he.trace,de=he.t,ue=v.lineOptions[Q],ve=[];se._ownfill&&ve.push(Q),se._nexttrace&&ve.push(Q+1),ve.length&&(v.fillOrder[Q]=ve);var ke,Ee,be=[],xe=ue&&ue.positions||de.positions;if(se.fill==="tozeroy"){for(ke=0;ke<xe.length&&isNaN(xe[ke+1]);)ke+=2;for(Ee=xe.length-2;Ee>ke&&isNaN(xe[Ee+1]);)Ee-=2;xe[ke+1]!==0&&(be=[xe[ke],0]),be=be.concat(xe.slice(ke,Ee+2)),xe[Ee+1]!==0&&(be=be.concat([xe[Ee],0]))}else if(se.fill==="tozerox"){for(ke=0;ke<xe.length&&isNaN(xe[ke]);)ke+=2;for(Ee=xe.length-2;Ee>ke&&isNaN(xe[Ee]);)Ee-=2;xe[ke]!==0&&(be=[0,xe[ke+1]]),be=be.concat(xe.slice(ke,Ee+2)),xe[Ee]!==0&&(be=be.concat([0,xe[Ee+1]]))}else if(se.fill==="toself"||se.fill==="tonext"){for(be=[],ie=0,J.splitNull=!0,ae=0;ae<xe.length;ae+=2)(isNaN(xe[ae])||isNaN(xe[ae+1]))&&((be=be.concat(xe.slice(ie,ae))).push(xe[ie],xe[ie+1]),be.push(null,null),ie=ae+2);be=be.concat(xe.slice(ie)),ie&&be.push(xe[ie],xe[ie+1])}else{var ce=se._nexttrace;if(ce){var ge=v.lineOptions[Q+1];if(ge){var we=ge.positions;if(se.fill==="tonexty"){for(be=xe.slice(),Q=Math.floor(we.length/2);Q--;){var Me=we[2*Q],Se=we[2*Q+1];isNaN(Me)||isNaN(Se)||be.push(Me,Se)}J.fill=ce.fillcolor}}}}if(se._prevtrace&&se._prevtrace.fill==="tonext"){var ze=v.lineOptions[Q-1].positions,Fe=be.length/2,Ye=[ie=Fe];for(ae=0;ae<ze.length;ae+=2)(isNaN(ze[ae])||isNaN(ze[ae+1]))&&(Ye.push(ae/2+Fe+1),ie=ae+2);be=be.concat(ze),J.hole=Ye}return J.fillmode=se.fill,J.opacity=se.opacity,J.positions=be,J}}),v.fill2d.update(v.fillOptions))}var k=y.dragmode,L=f(k),M=y.clickmode.indexOf("select")>-1;for(g=0;g<T;g++){var P=a[g][0],D=P.trace,N=P.t,U=N.index,G=D._length,X=N.x,K=N.y;if(D.selectedpoints||L||M){if(L||(L=!0),D.selectedpoints){var Z=v.selectBatch[U]=e.selIndices2selPoints(D),H={};for(p=0;p<Z.length;p++)H[Z[p]]=1;var Y=[];for(p=0;p<G;p++)H[p]||Y.push(p);v.unselectBatch[U]=Y}var $=N.xpx=new Array(G),z=N.ypx=new Array(G);for(p=0;p<G;p++)$[p]=b.c2p(X[p]),z[p]=x.c2p(K[p])}else N.xpx=N.ypx=null}if(L){if(v.select2d||(v.select2d=t(y._glcanvas.data()[1].regl)),v.scatter2d){var j=new Array(T);for(g=0;g<T;g++)j[g]=v.selectBatch[g].length||v.unselectBatch[g].length?v.markerUnselectedOptions[g]:{};v.scatter2d.update(j)}v.select2d&&(v.select2d.update(v.markerOptions),v.select2d.update(v.markerSelectedOptions)),v.glText&&a.forEach(function(J){var Q=((J||[])[0]||{}).trace||{};o.hasText(Q)&&s(J)})}else v.scatter2d&&v.scatter2d.update(v.markerOptions);var W={viewport:i(y,b,x,c._context.plotGlPixelRatio),range:[(b._rl||b.range)[0],(x._rl||x.range)[0],(b._rl||b.range)[1],(x._rl||x.range)[1]]},ee=e.repeat(W,v.count);v.fill2d&&v.fill2d.update(ee),v.line2d&&v.line2d.update(ee),v.error2d&&v.error2d.update(ee.concat(ee)),v.scatter2d&&v.scatter2d.update(ee),v.select2d&&v.select2d.update(ee),v.glText&&v.glText.forEach(function(J){J.update(W)})}else v.init()}}},{"../../components/dragelement/helpers":668,"../../lib":787,"../../lib/prepare_regl":800,"../scatter/link_traces":1218,"../scatter/subtypes":1227,"./edit_style":1259,"gl-text":347,"regl-error2d":522,"regl-line2d":523,"regl-scatter2d":524}],1265:[function(r,I,B){var t=r("../../lib");I.exports=function(d,m){var h=m._scene,e={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},f={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return m._scene||((h=m._scene={}).init=function(){t.extendFlat(h,f,e)},h.init(),h.update=function(l){var o=t.repeat(l,h.count);if(h.fill2d&&h.fill2d.update(o),h.scatter2d&&h.scatter2d.update(o),h.line2d&&h.line2d.update(o),h.error2d&&h.error2d.update(o.concat(o)),h.select2d&&h.select2d.update(o),h.glText)for(var u=0;u<h.count;u++)h.glText[u].update(l)},h.draw=function(){for(var l=h.count,o=h.fill2d,u=h.error2d,s=h.line2d,i=h.scatter2d,c=h.glText,n=h.select2d,a=h.selectBatch,g=h.unselectBatch,p=0;p<l;p++){if(o&&h.fillOrder[p]&&o.draw(h.fillOrder[p]),s&&h.lineOptions[p]&&s.draw(p),u&&(h.errorXOptions[p]&&u.draw(p),h.errorYOptions[p]&&u.draw(p+l)),i&&h.markerOptions[p])if(g[p].length){var y=t.repeat([],h.count);y[p]=g[p],i.draw(y)}else a[p].length||i.draw(p);c[p]&&h.textOptions[p]&&c[p].render()}n&&n.draw(a),h.dirty=!1},h.destroy=function(){h.fill2d&&h.fill2d.destroy&&h.fill2d.destroy(),h.scatter2d&&h.scatter2d.destroy&&h.scatter2d.destroy(),h.error2d&&h.error2d.destroy&&h.error2d.destroy(),h.line2d&&h.line2d.destroy&&h.line2d.destroy(),h.select2d&&h.select2d.destroy&&h.select2d.destroy(),h.glText&&h.glText.forEach(function(l){l.destroy&&l.destroy()}),h.lineOptions=null,h.fillOptions=null,h.markerOptions=null,h.markerSelectedOptions=null,h.markerUnselectedOptions=null,h.errorXOptions=null,h.errorYOptions=null,h.textOptions=null,h.textSelectedOptions=null,h.textUnselectedOptions=null,h.selectBatch=null,h.unselectBatch=null,m._scene=null}),h.dirty||t.extendFlat(h,e),h}},{"../../lib":787}],1266:[function(r,I,B){var t=r("../scatter/subtypes"),d=r("./edit_style").styleTextSelection;I.exports=function(m,h){var e=m.cd,f=m.xaxis,l=m.yaxis,o=[],u=e[0].trace,s=e[0].t,i=u._length,c=s.x,n=s.y,a=s._scene,g=s.index;if(!a)return o;var p=t.hasText(u),y=t.hasMarkers(u),v=!y&&!p;if(u.visible!==!0||v)return o;var b=[],x=[];if(h!==!1&&!h.degenerate)for(var T=0;T<i;T++)h.contains([s.xpx[T],s.ypx[T]],!1,T,m)?(b.push(T),o.push({pointNumber:T,x:f.c2d(c[T]),y:l.c2d(n[T])})):x.push(T);if(y){var A=a.scatter2d;if(b.length||x.length){if(!a.selectBatch[g].length&&!a.unselectBatch[g].length){var S=new Array(a.count);S[g]=a.markerUnselectedOptions[g],A.update.apply(A,S)}}else{var w=new Array(a.count);w[g]=a.markerOptions[g],A.update.apply(A,w)}}return a.selectBatch[g]=b,a.unselectBatch[g]=x,p&&d(e),o}},{"../scatter/subtypes":1227,"./edit_style":1259}],1267:[function(r,I,B){var t=r("../../plots/template_attributes").hovertemplateAttrs,d=r("../../plots/template_attributes").texttemplateAttrs,m=r("../scattergeo/attributes"),h=r("../scatter/attributes"),e=r("../../plots/mapbox/layout_attributes"),f=r("../../plots/attributes"),l=r("../../components/colorscale/attributes"),o=r("../../lib/extend").extendFlat,u=r("../../plot_api/edit_types").overrideAll,s=m.line,i=m.marker;I.exports=u({lon:m.lon,lat:m.lat,mode:o({},h.mode,{dflt:"markers"}),text:o({},h.text,{}),texttemplate:d({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:o({},h.hovertext,{}),line:{color:s.color,width:s.width},connectgaps:h.connectgaps,marker:o({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:i.opacity,size:i.size,sizeref:i.sizeref,sizemin:i.sizemin,sizemode:i.sizemode},l("marker")),fill:m.fill,fillcolor:h.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:h.selected.marker},unselected:{marker:h.unselected.marker},hoverinfo:o({},f.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:t()},"calc","nested")},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/mapbox/layout_attributes":897,"../../plots/template_attributes":910,"../scatter/attributes":1202,"../scattergeo/attributes":1244}],1268:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../lib"),m=r("../../constants/numerical").BADNUM,h=r("../../lib/geojson_utils"),e=r("../../components/colorscale"),f=r("../../components/drawing"),l=r("../scatter/make_bubble_size_func"),o=r("../scatter/subtypes"),u=r("../../plots/mapbox/convert_text_opts"),s=r("../../components/fx/helpers").appendArrayPointValue,i=r("../../lib/svg_text_utils").NEWLINES,c=r("../../lib/svg_text_utils").BR_TAG_ALL;function n(){return{geojson:h.makeBlank(),layout:{visibility:"none"},paint:{}}}function a(y,v){return d.isArrayOrTypedArray(y)?v?function(b){return t(y[b])?+y[b]:0}:function(b){return y[b]}:y?function(){return y}:g}function g(){return""}function p(y){return y[0]===m}I.exports=function(y,v){var b,x=v[0].trace,T=x.visible===!0&&x._length!==0,A=x.fill!=="none",S=o.hasLines(x),w=o.hasMarkers(x),E=o.hasText(x),k=w&&x.marker.symbol==="circle",L=w&&x.marker.symbol!=="circle",M=n(),P=n(),D=n(),N=n(),U={fill:M,line:P,circle:D,symbol:N};if(!T)return U;if((A||S)&&(b=h.calcTraceToLineCoords(v)),A&&(M.geojson=h.makePolygon(b),M.layout.visibility="visible",d.extendFlat(M.paint,{"fill-color":x.fillcolor})),S&&(P.geojson=h.makeLine(b),P.layout.visibility="visible",d.extendFlat(P.paint,{"line-width":x.line.width,"line-color":x.line.color,"line-opacity":x.opacity})),k){var G=function(Z){var H,Y,$,z,j=Z[0].trace,W=j.marker,ee=j.selectedpoints,J=d.isArrayOrTypedArray(W.color),Q=d.isArrayOrTypedArray(W.size),te=d.isArrayOrTypedArray(W.opacity);function ie(Ee){return j.opacity*Ee}J&&(Y=e.hasColorscale(j,"marker")?e.makeColorScaleFuncFromTrace(W):d.identity),Q&&($=l(j)),te&&(z=function(Ee){return ie(t(Ee)?+d.constrain(Ee,0,1):0)});var ae,he=[];for(H=0;H<Z.length;H++){var se=Z[H],de=se.lonlat;if(!p(de)){var ue={};Y&&(ue.mcc=se.mcc=Y(se.mc)),$&&(ue.mrc=se.mrc=$(se.ms)),z&&(ue.mo=z(se.mo)),ee&&(ue.selected=se.selected||0),he.push({type:"Feature",geometry:{type:"Point",coordinates:de},properties:ue})}}if(ee)for(ae=f.makeSelectedPointStyleFns(j),H=0;H<he.length;H++){var ve=he[H].properties;ae.selectedOpacityFn&&(ve.mo=ie(ae.selectedOpacityFn(ve))),ae.selectedColorFn&&(ve.mcc=ae.selectedColorFn(ve)),ae.selectedSizeFn&&(ve.mrc=ae.selectedSizeFn(ve))}return{geojson:{type:"FeatureCollection",features:he},mcc:J||ae&&ae.selectedColorFn?{type:"identity",property:"mcc"}:W.color,mrc:Q||ae&&ae.selectedSizeFn?{type:"identity",property:"mrc"}:(ke=W.size,ke/2),mo:te||ae&&ae.selectedOpacityFn?{type:"identity",property:"mo"}:ie(W.opacity)};var ke}(v);D.geojson=G.geojson,D.layout.visibility="visible",d.extendFlat(D.paint,{"circle-color":G.mcc,"circle-radius":G.mrc,"circle-opacity":G.mo})}if((L||E)&&(N.geojson=function(Z,H){for(var Y=H._fullLayout,$=Z[0].trace,z=$.marker||{},j=z.symbol,W=z.angle,ee=j!=="circle"?a(j):g,J=W!=="auto"?a(W,!0):g,Q=o.hasText($)?a($.text):g,te=[],ie=0;ie<Z.length;ie++){var ae=Z[ie];if(!p(ae.lonlat)){var he,se=$.texttemplate;if(se){var de=Array.isArray(se)?se[ie]||"":se,ue=$._module.formatLabels(ae,$,Y),ve={};s(ve,$,ae.i);var ke=$._meta||{};he=d.texttemplateString(de,ue,Y._d3locale,ve,ae,ke)}else he=Q(ie);he&&(he=he.replace(i,"").replace(c,`
`)),te.push({type:"Feature",geometry:{type:"Point",coordinates:ae.lonlat},properties:{symbol:ee(ie),angle:J(ie),text:he}})}}return{type:"FeatureCollection",features:te}}(v,y),d.extendFlat(N.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),L&&(d.extendFlat(N.layout,{"icon-size":x.marker.size/10}),"angle"in x.marker&&x.marker.angle!=="auto"&&d.extendFlat(N.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),N.layout["icon-allow-overlap"]=x.marker.allowoverlap,d.extendFlat(N.paint,{"icon-opacity":x.opacity*x.marker.opacity,"icon-color":x.marker.color})),E)){var X=(x.marker||{}).size,K=u(x.textposition,X);d.extendFlat(N.layout,{"text-size":x.textfont.size,"text-anchor":K.anchor,"text-offset":K.offset}),d.extendFlat(N.paint,{"text-color":x.textfont.color,"text-opacity":x.opacity})}return U}},{"../../components/colorscale":662,"../../components/drawing":672,"../../components/fx/helpers":686,"../../constants/numerical":763,"../../lib":787,"../../lib/geojson_utils":781,"../../lib/svg_text_utils":813,"../../plots/mapbox/convert_text_opts":894,"../scatter/make_bubble_size_func":1219,"../scatter/subtypes":1227,"fast-isnumeric":246}],1269:[function(r,I,B){var t=r("../../lib"),d=r("../scatter/subtypes"),m=r("../scatter/marker_defaults"),h=r("../scatter/line_defaults"),e=r("../scatter/text_defaults"),f=r("../scatter/fillcolor_defaults"),l=r("./attributes");I.exports=function(o,u,s,i){function c(a,g){return t.coerce(o,u,l,a,g)}if(function(a,g,p){var y=p("lon")||[],v=p("lat")||[],b=Math.min(y.length,v.length);return g._length=b,b}(0,u,c)){if(c("text"),c("texttemplate"),c("hovertext"),c("hovertemplate"),c("mode"),c("below"),d.hasLines(u)&&(h(o,u,s,i,c,{noDash:!0}),c("connectgaps")),d.hasMarkers(u)){m(o,u,s,i,c,{noLine:!0}),c("marker.allowoverlap"),c("marker.angle");var n=u.marker;n.symbol!=="circle"&&(t.isArrayOrTypedArray(n.size)&&(n.size=n.size[0]),t.isArrayOrTypedArray(n.color)&&(n.color=n.color[0]))}d.hasText(u)&&e(o,u,i,c,{noSelect:!0}),c("fill"),u.fill!=="none"&&f(o,u,s,c),t.coerceSelectionMarkerOpacity(u,c)}else u.visible=!1}},{"../../lib":787,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1267}],1270:[function(r,I,B){I.exports=function(t,d){return t.lon=d.lon,t.lat=d.lat,t}},{}],1271:[function(r,I,B){var t=r("../../plots/cartesian/axes");I.exports=function(d,m,h){var e={},f=h[m.subplot]._subplot.mockAxis,l=d.lonlat;return e.lonLabel=t.tickText(f,f.c2l(l[0]),!0).text,e.latLabel=t.tickText(f,f.c2l(l[1]),!0).text,e}},{"../../plots/cartesian/axes":838}],1272:[function(r,I,B){var t=r("../../components/fx"),d=r("../../lib"),m=r("../scatter/get_trace_color"),h=d.fillText,e=r("../../constants/numerical").BADNUM;function f(l,o,u){if(!l.hovertemplate){var s=(o.hi||l.hoverinfo).split("+"),i=s.indexOf("all")!==-1,c=s.indexOf("lon")!==-1,n=s.indexOf("lat")!==-1,a=o.lonlat,g=[];return i||c&&n?g.push("("+p(a[1])+", "+p(a[0])+")"):c?g.push(u.lon+p(a[0])):n&&g.push(u.lat+p(a[1])),(i||s.indexOf("text")!==-1)&&h(o,l,g),g.join("<br>")}function p(y){return y+"\xB0"}}I.exports={hoverPoints:function(l,o,u){var s=l.cd,i=s[0].trace,c=l.xa,n=l.ya,a=l.subplot,g=360*(o>=0?Math.floor((o+180)/360):Math.ceil((o-180)/360)),p=o-g;if(t.getClosest(s,function(E){var k=E.lonlat;if(k[0]===e)return 1/0;var L=d.modHalf(k[0],360),M=k[1],P=a.project([L,M]),D=P.x-c.c2p([p,M]),N=P.y-n.c2p([L,u]),U=Math.max(3,E.mrc||0);return Math.max(Math.sqrt(D*D+N*N)-U,1-3/U)},l),l.index!==!1){var y=s[l.index],v=y.lonlat,b=[d.modHalf(v[0],360)+g,v[1]],x=c.c2p(b),T=n.c2p(b),A=y.mrc||1;l.x0=x-A,l.x1=x+A,l.y0=T-A,l.y1=T+A;var S={};S[i.subplot]={_subplot:a};var w=i._module.formatLabels(y,i,S);return l.lonLabel=w.lonLabel,l.latLabel=w.latLabel,l.color=m(i,y),l.extraText=f(i,y,s[0].t.labels),l.hovertemplate=i.hovertemplate,[l]}},getExtraText:f}},{"../../components/fx":690,"../../constants/numerical":763,"../../lib":787,"../scatter/get_trace_color":1212}],1273:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("../scattergeo/calc"),plot:r("./plot"),hoverPoints:r("./hover").hoverPoints,eventData:r("./event_data"),selectPoints:r("./select"),styleOnSelect:function(t,d){d&&d[0].trace._glTrace.update(d)},moduleType:"trace",name:"scattermapbox",basePlotModule:r("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":895,"../scatter/marker_colorbar":1220,"../scattergeo/calc":1245,"./attributes":1267,"./defaults":1269,"./event_data":1270,"./format_labels":1271,"./hover":1272,"./plot":1274,"./select":1275}],1274:[function(r,I,B){var t=r("./convert"),d=r("../../plots/mapbox/constants").traceLayerPrefix,m=["fill","line","circle","symbol"];function h(f,l){this.type="scattermapbox",this.subplot=f,this.uid=l,this.sourceIds={fill:"source-"+l+"-fill",line:"source-"+l+"-line",circle:"source-"+l+"-circle",symbol:"source-"+l+"-symbol"},this.layerIds={fill:d+l+"-fill",line:d+l+"-line",circle:d+l+"-circle",symbol:d+l+"-symbol"},this.below=null}var e=h.prototype;e.addSource=function(f,l){this.subplot.map.addSource(this.sourceIds[f],{type:"geojson",data:l.geojson})},e.setSourceData=function(f,l){this.subplot.map.getSource(this.sourceIds[f]).setData(l.geojson)},e.addLayer=function(f,l,o){this.subplot.addLayer({type:f,id:this.layerIds[f],source:this.sourceIds[f],layout:l.layout,paint:l.paint},o)},e.update=function(f){var l,o,u,s=this.subplot,i=s.map,c=t(s.gd,f),n=s.belowLookup["trace-"+this.uid];if(n!==this.below){for(l=m.length-1;l>=0;l--)o=m[l],i.removeLayer(this.layerIds[o]);for(l=0;l<m.length;l++)u=c[o=m[l]],this.addLayer(o,u,n);this.below=n}for(l=0;l<m.length;l++)u=c[o=m[l]],s.setOptions(this.layerIds[o],"setLayoutProperty",u.layout),u.layout.visibility==="visible"&&(this.setSourceData(o,u),s.setOptions(this.layerIds[o],"setPaintProperty",u.paint));f[0].trace._glTrace=this},e.dispose=function(){for(var f=this.subplot.map,l=m.length-1;l>=0;l--){var o=m[l];f.removeLayer(this.layerIds[o]),f.removeSource(this.sourceIds[o])}},I.exports=function(f,l){for(var o=l[0].trace,u=new h(f,o.uid),s=t(f.gd,l),i=u.below=f.belowLookup["trace-"+o.uid],c=0;c<m.length;c++){var n=m[c],a=s[n];u.addSource(n,a),u.addLayer(n,a,i)}return l[0].trace._glTrace=u,u}},{"../../plots/mapbox/constants":893,"./convert":1268}],1275:[function(r,I,B){var t=r("../../lib"),d=r("../scatter/subtypes"),m=r("../../constants/numerical").BADNUM;I.exports=function(h,e){var f,l=h.cd,o=h.xaxis,u=h.yaxis,s=[],i=l[0].trace;if(!d.hasMarkers(i))return[];if(e===!1)for(f=0;f<l.length;f++)l[f].selected=0;else for(f=0;f<l.length;f++){var c=l[f],n=c.lonlat;if(n[0]!==m){var a=[t.modHalf(n[0],360),n[1]],g=[o.c2p(a),u.c2p(a)];e.contains(g,null,f,h)?(s.push({pointNumber:f,lon:n[0],lat:n[1]}),c.selected=1):c.selected=0}}return s}},{"../../constants/numerical":763,"../../lib":787,"../scatter/subtypes":1227}],1276:[function(r,I,B){var t=r("../../plots/template_attributes").hovertemplateAttrs,d=r("../../plots/template_attributes").texttemplateAttrs,m=r("../../lib/extend").extendFlat,h=r("../scatter/attributes"),e=r("../../plots/attributes"),f=h.line;I.exports={mode:h.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:h.text,texttemplate:d({editType:"plot"},{keys:["r","theta","text"]}),hovertext:h.hovertext,line:{color:f.color,width:f.width,dash:f.dash,shape:m({},f.shape,{values:["linear","spline"]}),smoothing:f.smoothing,editType:"calc"},connectgaps:h.connectgaps,marker:h.marker,cliponaxis:m({},h.cliponaxis,{dflt:!1}),textposition:h.textposition,textfont:h.textfont,fill:m({},h.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:h.fillcolor,hoverinfo:m({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:h.hoveron,hovertemplate:t(),selected:h.selected,unselected:h.unselected}},{"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1277:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../../constants/numerical").BADNUM,m=r("../../plots/cartesian/axes"),h=r("../scatter/colorscale_calc"),e=r("../scatter/arrays_to_calcdata"),f=r("../scatter/calc_selection"),l=r("../scatter/calc").calcMarkerSize;I.exports=function(o,u){for(var s=o._fullLayout,i=u.subplot,c=s[i].radialaxis,n=s[i].angularaxis,a=c.makeCalcdata(u,"r"),g=n.makeCalcdata(u,"theta"),p=u._length,y=new Array(p),v=0;v<p;v++){var b=a[v],x=g[v],T=y[v]={};t(b)&&t(x)?(T.r=b,T.theta=x):T.r=d}var A=l(u,p);return u._extremes.x=m.findExtremes(c,a,{ppad:A}),h(o,u),e(y,u),f(y,u),y}},{"../../constants/numerical":763,"../../plots/cartesian/axes":838,"../scatter/arrays_to_calcdata":1201,"../scatter/calc":1203,"../scatter/calc_selection":1204,"../scatter/colorscale_calc":1205,"fast-isnumeric":246}],1278:[function(r,I,B){var t=r("../../lib"),d=r("../scatter/subtypes"),m=r("../scatter/marker_defaults"),h=r("../scatter/line_defaults"),e=r("../scatter/line_shape_defaults"),f=r("../scatter/text_defaults"),l=r("../scatter/fillcolor_defaults"),o=r("../scatter/constants").PTS_LINESONLY,u=r("./attributes");function s(i,c,n,a){var g,p=a("r"),y=a("theta");if(p)y?g=Math.min(p.length,y.length):(g=p.length,a("theta0"),a("dtheta"));else{if(!y)return 0;g=c.theta.length,a("r0"),a("dr")}return c._length=g,g}I.exports={handleRThetaDefaults:s,supplyDefaults:function(i,c,n,a){function g(v,b){return t.coerce(i,c,u,v,b)}var p=s(i,c,a,g);if(p){g("thetaunit"),g("mode",p<o?"lines+markers":"lines"),g("text"),g("hovertext"),c.hoveron!=="fills"&&g("hovertemplate"),d.hasLines(c)&&(h(i,c,n,a,g),e(i,c,g),g("connectgaps")),d.hasMarkers(c)&&m(i,c,n,a,g,{gradient:!0}),d.hasText(c)&&(g("texttemplate"),f(i,c,a,g));var y=[];(d.hasMarkers(c)||d.hasText(c))&&(g("cliponaxis"),g("marker.maxdisplayed"),y.push("points")),g("fill"),c.fill!=="none"&&(l(i,c,n,g),d.hasLines(c)||e(i,c,g)),c.fill!=="tonext"&&c.fill!=="toself"||y.push("fills"),g("hoveron",y.join("+")||"points"),t.coerceSelectionMarkerOpacity(c,g)}else c.visible=!1}}},{"../../lib":787,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/line_shape_defaults":1217,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1276}],1279:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes");I.exports=function(m,h,e){var f,l,o={},u=e[h.subplot]._subplot;u?(f=u.radialAxis,l=u.angularAxis):(f=(u=e[h.subplot]).radialaxis,l=u.angularaxis);var s=f.c2l(m.r);o.rLabel=d.tickText(f,s,!0).text;var i=l.thetaunit==="degrees"?t.rad2deg(m.theta):m.theta;return o.thetaLabel=d.tickText(l,i,!0).text,o}},{"../../lib":787,"../../plots/cartesian/axes":838}],1280:[function(r,I,B){var t=r("../scatter/hover");function d(m,h,e,f){var l=e.radialAxis,o=e.angularAxis;l._hovertitle="r",o._hovertitle="\u03B8";var u={};u[h.subplot]={_subplot:e};var s=h._module.formatLabels(m,h,u);f.rLabel=s.rLabel,f.thetaLabel=s.thetaLabel;var i=m.hi||h.hoverinfo,c=[];function n(g,p){c.push(g._hovertitle+": "+p)}if(!h.hovertemplate){var a=i.split("+");a.indexOf("all")!==-1&&(a=["r","theta","text"]),a.indexOf("r")!==-1&&n(l,f.rLabel),a.indexOf("theta")!==-1&&n(o,f.thetaLabel),a.indexOf("text")!==-1&&f.text&&(c.push(f.text),delete f.text),f.extraText=c.join("<br>")}}I.exports={hoverPoints:function(m,h,e,f){var l=t(m,h,e,f);if(l&&l[0].index!==!1){var o=l[0];if(o.index===void 0)return l;var u=m.subplot,s=o.cd[o.index],i=o.trace;if(u.isPtInside(s))return o.xLabelVal=void 0,o.yLabelVal=void 0,d(s,i,u,o),o.hovertemplate=i.hovertemplate,l}},makeHoverPointText:d}},{"../scatter/hover":1213}],1281:[function(r,I,B){I.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:r("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:r("./attributes"),supplyDefaults:r("./defaults").supplyDefaults,colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),plot:r("./plot"),style:r("../scatter/style").style,styleOnSelect:r("../scatter/style").styleOnSelect,hoverPoints:r("./hover").hoverPoints,selectPoints:r("../scatter/select"),meta:{}}},{"../../plots/polar":904,"../scatter/marker_colorbar":1220,"../scatter/select":1224,"../scatter/style":1226,"./attributes":1276,"./calc":1277,"./defaults":1278,"./format_labels":1279,"./hover":1280,"./plot":1282}],1282:[function(r,I,B){var t=r("../scatter/plot"),d=r("../../constants/numerical").BADNUM;I.exports=function(m,h,e){for(var f=h.layers.frontplot.select("g.scatterlayer"),l={xaxis:h.xaxis,yaxis:h.yaxis,plot:h.framework,layerClipId:h._hasClipOnAxisFalse?h.clipIds.forTraces:null},o=h.radialAxis,u=h.angularAxis,s=0;s<e.length;s++)for(var i=e[s],c=0;c<i.length;c++){var n=i[c],a=n.r;if(a===d)n.x=n.y=d;else{var g=o.c2g(a),p=u.c2g(n.theta);n.x=g*Math.cos(p),n.y=g*Math.sin(p)}}t(m,l,e,f)}},{"../../constants/numerical":763,"../scatter/plot":1223}],1283:[function(r,I,B){var t=r("../scatterpolar/attributes"),d=r("../scattergl/attributes"),m=r("../../plots/template_attributes").texttemplateAttrs;I.exports={mode:t.mode,r:t.r,theta:t.theta,r0:t.r0,dr:t.dr,theta0:t.theta0,dtheta:t.dtheta,thetaunit:t.thetaunit,text:t.text,texttemplate:m({editType:"plot"},{keys:["r","theta","text"]}),hovertext:t.hovertext,hovertemplate:t.hovertemplate,line:d.line,connectgaps:d.connectgaps,marker:d.marker,fill:d.fill,fillcolor:d.fillcolor,textposition:d.textposition,textfont:d.textfont,hoverinfo:t.hoverinfo,selected:t.selected,unselected:t.unselected}},{"../../plots/template_attributes":910,"../scattergl/attributes":1254,"../scatterpolar/attributes":1276}],1284:[function(r,I,B){var t=r("../scatter/colorscale_calc"),d=r("../scatter/calc").calcMarkerSize,m=r("../scattergl/convert"),h=r("../../plots/cartesian/axes"),e=r("../scattergl/constants").TOO_MANY_POINTS;I.exports=function(f,l){var o=f._fullLayout,u=l.subplot,s=o[u].radialaxis,i=o[u].angularaxis,c=l._r=s.makeCalcdata(l,"r"),n=l._theta=i.makeCalcdata(l,"theta"),a=l._length,g={};a<c.length&&(c=c.slice(0,a)),a<n.length&&(n=n.slice(0,a)),g.r=c,g.theta=n,t(f,l);var p,y=g.opts=m.style(f,l);return a<e?p=d(l,a):y.marker&&(p=2*(y.marker.sizeAvg||Math.max(y.marker.size,3))),l._extremes.x=h.findExtremes(s,c,{ppad:p}),[{x:!1,y:!1,t:g,trace:l}]}},{"../../plots/cartesian/axes":838,"../scatter/calc":1203,"../scatter/colorscale_calc":1205,"../scattergl/constants":1256,"../scattergl/convert":1257}],1285:[function(r,I,B){var t=r("../../lib"),d=r("../scatter/subtypes"),m=r("../scatterpolar/defaults").handleRThetaDefaults,h=r("../scatter/marker_defaults"),e=r("../scatter/line_defaults"),f=r("../scatter/text_defaults"),l=r("../scatter/fillcolor_defaults"),o=r("../scatter/constants").PTS_LINESONLY,u=r("./attributes");I.exports=function(s,i,c,n){function a(p,y){return t.coerce(s,i,u,p,y)}var g=m(s,i,n,a);g?(a("thetaunit"),a("mode",g<o?"lines+markers":"lines"),a("text"),a("hovertext"),i.hoveron!=="fills"&&a("hovertemplate"),d.hasLines(i)&&(e(s,i,c,n,a),a("connectgaps")),d.hasMarkers(i)&&h(s,i,c,n,a),d.hasText(i)&&(a("texttemplate"),f(s,i,n,a)),a("fill"),i.fill!=="none"&&l(s,i,c,a),t.coerceSelectionMarkerOpacity(i,a)):i.visible=!1}},{"../../lib":787,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"../scatterpolar/defaults":1278,"./attributes":1283}],1286:[function(r,I,B){var t=r("../scatterpolar/format_labels");I.exports=function(d,m,h){var e=d.i;return"r"in d||(d.r=m._r[e]),"theta"in d||(d.theta=m._theta[e]),t(d,m,h)}},{"../scatterpolar/format_labels":1279}],1287:[function(r,I,B){var t=r("../scattergl/hover"),d=r("../scatterpolar/hover").makeHoverPointText;I.exports={hoverPoints:function(m,h,e,f){var l=m.cd[0].t,o=l.r,u=l.theta,s=t.hoverPoints(m,h,e,f);if(s&&s[0].index!==!1){var i=s[0];if(i.index===void 0)return s;var c=m.subplot,n=i.cd[i.index],a=i.trace;if(n.r=o[i.index],n.theta=u[i.index],c.isPtInside(n))return i.xLabelVal=void 0,i.yLabelVal=void 0,d(n,a,c,i),s}}}},{"../scattergl/hover":1262,"../scatterpolar/hover":1280}],1288:[function(r,I,B){I.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:r("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),plot:r("./plot"),hoverPoints:r("./hover").hoverPoints,selectPoints:r("../scattergl/select"),meta:{}}},{"../../plots/polar":904,"../scatter/marker_colorbar":1220,"../scattergl/select":1266,"./attributes":1283,"./calc":1284,"./defaults":1285,"./format_labels":1286,"./hover":1287,"./plot":1289}],1289:[function(r,I,B){var t=r("@plotly/point-cluster"),d=r("fast-isnumeric"),m=r("../scattergl/plot"),h=r("../scattergl/scene_update"),e=r("../scattergl/convert"),f=r("../../lib"),l=r("../scattergl/constants").TOO_MANY_POINTS;I.exports=function(o,u,s){if(s.length){var i=u.radialAxis,c=u.angularAxis,n=h(o,u);return s.forEach(function(a){if(a&&a[0]&&a[0].trace){var g,p=a[0],y=p.trace,v=p.t,b=y._length,x=v.r,T=v.theta,A=v.opts,S=x.slice(),w=T.slice();for(g=0;g<x.length;g++)u.isPtInside({r:x[g],theta:T[g]})||(S[g]=NaN,w[g]=NaN);var E=new Array(2*b),k=Array(b),L=Array(b);for(g=0;g<b;g++){var M,P,D=S[g];if(d(D)){var N=i.c2g(D),U=c.c2g(w[g],y.thetaunit);M=N*Math.cos(U),P=N*Math.sin(U)}else M=P=NaN;k[g]=E[2*g]=M,L[g]=E[2*g+1]=P}v.tree=t(E),A.marker&&b>=l&&(A.marker.cluster=v.tree),A.marker&&(A.markerSel.positions=A.markerUnsel.positions=A.marker.positions=E),A.line&&E.length>1&&f.extendFlat(A.line,e.linePositions(o,y,E)),A.text&&(f.extendFlat(A.text,{positions:E},e.textPosition(o,y,A.text,A.marker)),f.extendFlat(A.textSel,{positions:E},e.textPosition(o,y,A.text,A.markerSel)),f.extendFlat(A.textUnsel,{positions:E},e.textPosition(o,y,A.text,A.markerUnsel))),A.fill&&!n.fill2d&&(n.fill2d=!0),A.marker&&!n.scatter2d&&(n.scatter2d=!0),A.line&&!n.line2d&&(n.line2d=!0),A.text&&!n.glText&&(n.glText=!0),n.lineOptions.push(A.line),n.fillOptions.push(A.fill),n.markerOptions.push(A.marker),n.markerSelectedOptions.push(A.markerSel),n.markerUnselectedOptions.push(A.markerUnsel),n.textOptions.push(A.text),n.textSelectedOptions.push(A.textSel),n.textUnselectedOptions.push(A.textUnsel),n.selectBatch.push([]),n.unselectBatch.push([]),v.x=k,v.y=L,v.rawx=k,v.rawy=L,v.r=x,v.theta=T,v.positions=E,v._scene=n,v.index=n.count,n.count++}}),m(o,u,s)}}},{"../../lib":787,"../scattergl/constants":1256,"../scattergl/convert":1257,"../scattergl/plot":1264,"../scattergl/scene_update":1265,"@plotly/point-cluster":59,"fast-isnumeric":246}],1290:[function(r,I,B){var t=r("../../plots/template_attributes").hovertemplateAttrs,d=r("../../plots/template_attributes").texttemplateAttrs,m=r("../scatter/attributes"),h=r("../../plots/attributes"),e=r("../../components/colorscale/attributes"),f=r("../../components/drawing/attributes").dash,l=r("../../lib/extend").extendFlat,o=m.marker,u=m.line,s=o.line;I.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:l({},m.mode,{dflt:"markers"}),text:l({},m.text,{}),texttemplate:d({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:l({},m.hovertext,{}),line:{color:u.color,width:u.width,dash:f,shape:l({},u.shape,{values:["linear","spline"]}),smoothing:u.smoothing,editType:"calc"},connectgaps:m.connectgaps,cliponaxis:m.cliponaxis,fill:l({},m.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:m.fillcolor,marker:l({symbol:o.symbol,opacity:o.opacity,maxdisplayed:o.maxdisplayed,size:o.size,sizeref:o.sizeref,sizemin:o.sizemin,sizemode:o.sizemode,line:l({width:s.width,editType:"calc"},e("marker.line")),gradient:o.gradient,editType:"calc"},e("marker")),textfont:m.textfont,textposition:m.textposition,selected:m.selected,unselected:m.unselected,hoverinfo:l({},h.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:m.hoveron,hovertemplate:t()}},{"../../components/colorscale/attributes":657,"../../components/drawing/attributes":671,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1291:[function(r,I,B){var t=r("fast-isnumeric"),d=r("../scatter/colorscale_calc"),m=r("../scatter/arrays_to_calcdata"),h=r("../scatter/calc_selection"),e=r("../scatter/calc").calcMarkerSize,f=["a","b","c"],l={a:["b","c"],b:["a","c"],c:["a","b"]};I.exports=function(o,u){var s,i,c,n,a,g,p=o._fullLayout[u.subplot].sum,y=u.sum||p,v={a:u.a,b:u.b,c:u.c};for(s=0;s<f.length;s++)if(!v[c=f[s]]){for(a=v[l[c][0]],g=v[l[c][1]],n=new Array(a.length),i=0;i<a.length;i++)n[i]=y-a[i]-g[i];v[c]=n}var b,x,T,A,S,w,E=u._length,k=new Array(E);for(s=0;s<E;s++)b=v.a[s],x=v.b[s],T=v.c[s],t(b)&&t(x)&&t(T)?((A=p/((b=+b)+(x=+x)+(T=+T)))!=1&&(b*=A,x*=A,T*=A),w=b,S=T-x,k[s]={x:S,y:w,a:b,b:x,c:T}):k[s]={x:!1,y:!1};return e(u,E),d(o,u),m(k,u),h(k,u),k}},{"../scatter/arrays_to_calcdata":1201,"../scatter/calc":1203,"../scatter/calc_selection":1204,"../scatter/colorscale_calc":1205,"fast-isnumeric":246}],1292:[function(r,I,B){var t=r("../../lib"),d=r("../scatter/constants"),m=r("../scatter/subtypes"),h=r("../scatter/marker_defaults"),e=r("../scatter/line_defaults"),f=r("../scatter/line_shape_defaults"),l=r("../scatter/text_defaults"),o=r("../scatter/fillcolor_defaults"),u=r("./attributes");I.exports=function(s,i,c,n){function a(x,T){return t.coerce(s,i,u,x,T)}var g,p=a("a"),y=a("b"),v=a("c");if(p?(g=p.length,y?(g=Math.min(g,y.length),v&&(g=Math.min(g,v.length))):g=v?Math.min(g,v.length):0):y&&v&&(g=Math.min(y.length,v.length)),g){i._length=g,a("sum"),a("text"),a("hovertext"),i.hoveron!=="fills"&&a("hovertemplate"),a("mode",g<d.PTS_LINESONLY?"lines+markers":"lines"),m.hasLines(i)&&(e(s,i,c,n,a),f(s,i,a),a("connectgaps")),m.hasMarkers(i)&&h(s,i,c,n,a,{gradient:!0}),m.hasText(i)&&(a("texttemplate"),l(s,i,n,a));var b=[];(m.hasMarkers(i)||m.hasText(i))&&(a("cliponaxis"),a("marker.maxdisplayed"),b.push("points")),a("fill"),i.fill!=="none"&&(o(s,i,c,a),m.hasLines(i)||f(s,i,a)),i.fill!=="tonext"&&i.fill!=="toself"||b.push("fills"),a("hoveron",b.join("+")||"points"),t.coerceSelectionMarkerOpacity(i,a)}else i.visible=!1}},{"../../lib":787,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/line_shape_defaults":1217,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1290}],1293:[function(r,I,B){I.exports=function(t,d,m,h,e){if(d.xa&&(t.xaxis=d.xa),d.ya&&(t.yaxis=d.ya),h[e]){var f=h[e];t.a=f.a,t.b=f.b,t.c=f.c}else t.a=d.a,t.b=d.b,t.c=d.c;return t}},{}],1294:[function(r,I,B){var t=r("../../plots/cartesian/axes");I.exports=function(d,m,h){var e={},f=h[m.subplot]._subplot;return e.aLabel=t.tickText(f.aaxis,d.a,!0).text,e.bLabel=t.tickText(f.baxis,d.b,!0).text,e.cLabel=t.tickText(f.caxis,d.c,!0).text,e}},{"../../plots/cartesian/axes":838}],1295:[function(r,I,B){var t=r("../scatter/hover");I.exports=function(d,m,h,e){var f=t(d,m,h,e);if(f&&f[0].index!==!1){var l=f[0];if(l.index===void 0){var o=1-l.y0/d.ya._length,u=d.xa._length,s=u*o/2,i=u-s;return l.x0=Math.max(Math.min(l.x0,i),s),l.x1=Math.max(Math.min(l.x1,i),s),f}var c=l.cd[l.index],n=l.trace,a=l.subplot;l.a=c.a,l.b=c.b,l.c=c.c,l.xLabelVal=void 0,l.yLabelVal=void 0;var g={};g[n.subplot]={_subplot:a};var p=n._module.formatLabels(c,n,g);l.aLabel=p.aLabel,l.bLabel=p.bLabel,l.cLabel=p.cLabel;var y=c.hi||n.hoverinfo,v=[];if(!n.hovertemplate){var b=y.split("+");b.indexOf("all")!==-1&&(b=["a","b","c"]),b.indexOf("a")!==-1&&x(a.aaxis,l.aLabel),b.indexOf("b")!==-1&&x(a.baxis,l.bLabel),b.indexOf("c")!==-1&&x(a.caxis,l.cLabel)}return l.extraText=v.join("<br>"),l.hovertemplate=n.hovertemplate,f}function x(T,A){v.push(T._hovertitle+": "+A)}}},{"../scatter/hover":1213}],1296:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),plot:r("./plot"),style:r("../scatter/style").style,styleOnSelect:r("../scatter/style").styleOnSelect,hoverPoints:r("./hover"),selectPoints:r("../scatter/select"),eventData:r("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:r("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":911,"../scatter/marker_colorbar":1220,"../scatter/select":1224,"../scatter/style":1226,"./attributes":1290,"./calc":1291,"./defaults":1292,"./event_data":1293,"./format_labels":1294,"./hover":1295,"./plot":1297}],1297:[function(r,I,B){var t=r("../scatter/plot");I.exports=function(d,m,h){var e=m.plotContainer;e.select(".scatterlayer").selectAll("*").remove();var f={xaxis:m.xaxis,yaxis:m.yaxis,plot:e,layerClipId:m._hasClipOnAxisFalse?m.clipIdRelative:null},l=m.layers.frontplot.select("g.scatterlayer");t(d,f,h,l)}},{"../scatter/plot":1223}],1298:[function(r,I,B){var t=r("../scatter/attributes"),d=r("../../components/colorscale/attributes"),m=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,h=r("../../plots/template_attributes").hovertemplateAttrs,e=r("../scattergl/attributes"),f=r("../../plots/cartesian/constants").idRegex,l=r("../../plot_api/plot_template").templatedArray,o=r("../../lib/extend").extendFlat,u=t.marker,s=u.line,i=o(d("marker.line",{editTypeOverride:"calc"}),{width:o({},s.width,{editType:"calc"}),editType:"calc"}),c=o(d("marker"),{symbol:u.symbol,size:o({},u.size,{editType:"markerSize"}),sizeref:u.sizeref,sizemin:u.sizemin,sizemode:u.sizemode,opacity:u.opacity,colorbar:u.colorbar,line:i,editType:"calc"});function n(a){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:f[a],editType:"plot"}}}c.color.editType=c.cmin.editType=c.cmax.editType="style",I.exports={dimensions:l("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:o({},e.text,{}),hovertext:o({},e.hovertext,{}),hovertemplate:h(),xhoverformat:m("x"),yhoverformat:m("y"),marker:c,xaxes:n("x"),yaxes:n("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:e.selected.marker,editType:"calc"},unselected:{marker:e.unselected.marker,editType:"calc"},opacity:e.opacity}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/plot_template":827,"../../plots/cartesian/axis_format_attributes":841,"../../plots/cartesian/constants":845,"../../plots/template_attributes":910,"../scatter/attributes":1202,"../scattergl/attributes":1254}],1299:[function(r,I,B){var t=r("regl-line2d"),d=r("../../registry"),m=r("../../lib/prepare_regl"),h=r("../../plots/get_data").getModuleCalcData,e=r("../../plots/cartesian"),f=r("../../plots/cartesian/axis_ids").getFromId,l=r("../../plots/cartesian/axes").shouldShowZeroLine;function o(s,i,c){for(var n=c.matrixOptions.data.length,a=i._visibleDims,g=c.viewOpts.ranges=new Array(n),p=0;p<a.length;p++){var y=a[p],v=g[p]=new Array(4),b=f(s,i._diag[y][0]);b&&(v[0]=b.r2l(b.range[0]),v[2]=b.r2l(b.range[1]));var x=f(s,i._diag[y][1]);x&&(v[1]=x.r2l(x.range[0]),v[3]=x.r2l(x.range[1]))}c.selectBatch.length||c.unselectBatch.length?c.matrix.update({ranges:g},{ranges:g}):c.matrix.update({ranges:g})}function u(s){var i=s._fullLayout,c=i._glcanvas.data()[0].regl,n=i._splomGrid;n||(n=i._splomGrid=t(c)),n.update(function(a){var g,p=a._context.plotGlPixelRatio,y=a._fullLayout,v=y._size,b=[0,0,y.width*p,y.height*p],x={};function T(Z,H,Y,$,z,j){Y*=p,$*=p,z*=p,j*=p;var W=H[Z+"color"],ee=H[Z+"width"],J=String(W+ee);J in x?x[J].data.push(NaN,NaN,Y,$,z,j):x[J]={data:[Y,$,z,j],join:"rect",thickness:ee*p,color:W,viewport:b,range:b,overlay:!1}}for(g in y._splomSubplots){var A,S,w=y._plots[g],E=w.xaxis,k=w.yaxis,L=E._gridVals,M=k._gridVals,P=E._offset,D=E._length,N=k._length,U=v.b+k.domain[0]*v.h,G=-k._m,X=-G*k.r2l(k.range[0],k.calendar);if(E.showgrid)for(g=0;g<L.length;g++)A=P+E.l2p(L[g].x),T("grid",E,A,U,A,U+N);if(k.showgrid)for(g=0;g<M.length;g++)S=U+X+G*M[g].x,T("grid",k,P,S,P+D,S);l(a,E,k)&&(A=P+E.l2p(0),T("zeroline",E,A,U,A,U+N)),l(a,k,E)&&T("zeroline",k,P,S=U+X+0,P+D,S)}var K=[];for(g in x)K.push(x[g]);return K}(s))}I.exports={name:"splom",attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:function(s){var i=s._fullLayout,c=d.getModule("splom"),n=h(s.calcdata,c)[0];m(s,["ANGLE_instanced_arrays","OES_element_index_uint"])&&(i._hasOnlyLargeSploms&&u(s),c.plot(s,{},n))},drag:function(s){var i=s.calcdata,c=s._fullLayout;c._hasOnlyLargeSploms&&u(s);for(var n=0;n<i.length;n++){var a=i[n][0].trace,g=c._splomScenes[a.uid];a.type==="splom"&&g&&g.matrix&&o(s,a,g)}},updateGrid:u,clean:function(s,i,c,n){var a,g={};if(n._splomScenes){for(a=0;a<s.length;a++){var p=s[a];p.type==="splom"&&(g[p.uid]=1)}for(a=0;a<c.length;a++){var y=c[a];if(!g[y.uid]){var v=n._splomScenes[y.uid];v&&v.destroy&&v.destroy(),n._splomScenes[y.uid]=null,delete n._splomScenes[y.uid]}}}Object.keys(n._splomScenes||{}).length===0&&delete n._splomScenes,n._splomGrid&&!i._hasOnlyLargeSploms&&n._hasOnlyLargeSploms&&(n._splomGrid.destroy(),n._splomGrid=null,delete n._splomGrid),e.clean(s,i,c,n)},updateFx:e.updateFx,toSVG:e.toSVG}},{"../../lib/prepare_regl":800,"../../plots/cartesian":852,"../../plots/cartesian/axes":838,"../../plots/cartesian/axis_ids":842,"../../plots/get_data":875,"../../registry":915,"regl-line2d":523}],1300:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/cartesian/axis_ids"),m=r("../scatter/calc").calcMarkerSize,h=r("../scatter/calc").calcAxisExpansion,e=r("../scatter/colorscale_calc"),f=r("../scattergl/convert").markerSelection,l=r("../scattergl/convert").markerStyle,o=r("./scene_update"),u=r("../../constants/numerical").BADNUM,s=r("../scattergl/constants").TOO_MANY_POINTS;I.exports=function(i,c){var n,a,g,p,y,v,b=c.dimensions,x=c._length,T={},A=T.cdata=[],S=T.data=[],w=c._visibleDims=[];function E(L,M){for(var P=L.makeCalcdata({v:M.values,vcalendar:c.calendar},"v"),D=0;D<P.length;D++)P[D]=P[D]===u?NaN:P[D];A.push(P),S.push(L.type==="log"?t.simpleMap(P,L.c2l):P)}for(n=0;n<b.length;n++)if((g=b[n]).visible){if(p=d.getFromId(i,c._diag[n][0]),y=d.getFromId(i,c._diag[n][1]),p&&y&&p.type!==y.type){t.log("Skipping splom dimension "+n+" with conflicting axis types");continue}p?(E(p,g),y&&y.type==="category"&&(y._categories=p._categories.slice())):E(y,g),w.push(n)}for(e(i,c),t.extendFlat(T,l(c)),v=A.length*x>s?T.sizeAvg||Math.max(T.size,3):m(c,x),a=0;a<w.length;a++)g=b[n=w[a]],p=d.getFromId(i,c._diag[n][0])||{},y=d.getFromId(i,c._diag[n][1])||{},h(i,c,p,y,A[a],A[a],v);var k=o(i,c);return k.matrix||(k.matrix=!0),k.matrixOptions=T,k.selectedOptions=f(c,c.selected),k.unselectedOptions=f(c,c.unselected),[{x:!1,y:!1,t:{},trace:c}]}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/axis_ids":842,"../scatter/calc":1203,"../scatter/colorscale_calc":1205,"../scattergl/constants":1256,"../scattergl/convert":1257,"./scene_update":1307}],1301:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/array_container_defaults"),m=r("./attributes"),h=r("../scatter/subtypes"),e=r("../scatter/marker_defaults"),f=r("../parcoords/merge_length"),l=r("../scattergl/helpers").isOpenSymbol;function o(u,s){function i(n,a){return t.coerce(u,s,m.dimensions,n,a)}i("label");var c=i("values");c&&c.length?i("visible"):s.visible=!1,i("axis.type"),i("axis.matches")}I.exports=function(u,s,i,c){function n(x,T){return t.coerce(u,s,m,x,T)}var a=d(u,s,{name:"dimensions",handleItemDefaults:o}),g=n("diagonal.visible"),p=n("showupperhalf"),y=n("showlowerhalf");if(f(s,a,"values")&&(g||p||y)){n("text"),n("hovertext"),n("hovertemplate"),n("xhoverformat"),n("yhoverformat"),e(u,s,i,c,n);var v=l(s.marker.symbol),b=h.isBubble(s);n("marker.line.width",v||b?1:0),function(x,T,A,S){var w,E,k=T.dimensions,L=k.length,M=T.showupperhalf,P=T.showlowerhalf,D=T.diagonal.visible,N=new Array(L),U=new Array(L);for(w=0;w<L;w++){var G=w?w+1:"";N[w]="x"+G,U[w]="y"+G}var X=S("xaxes",N),K=S("yaxes",U),Z=T._diag=new Array(L);T._xaxes={},T._yaxes={};var H=[],Y=[];function $(ae,he,se,de){if(ae){var ue=ae.charAt(0),ve=A._splomAxes[ue];if(T["_"+ue+"axes"][ae]=1,de.push(ae),!(ae in ve)){var ke=ve[ae]={};se&&(ke.label=se.label||"",se.visible&&se.axis&&(se.axis.type&&(ke.type=se.axis.type),se.axis.matches&&(ke.matches=he)))}}}var z=!D&&!P,j=!D&&!M;for(T._axesDim={},w=0;w<L;w++){var W=k[w],ee=w===0,J=w===L-1,Q=ee&&z||J&&j?void 0:X[w],te=ee&&j||J&&z?void 0:K[w];$(Q,te,W,H),$(te,Q,W,Y),Z[w]=[Q,te],T._axesDim[Q]=w,T._axesDim[te]=w}for(w=0;w<H.length;w++)for(E=0;E<Y.length;E++){var ie=H[w]+Y[E];w>E&&M||w<E&&P?A._splomSubplots[ie]=1:w!==E||!D&&P&&M||(A._splomSubplots[ie]=1)}(!P||!D&&M&&P)&&(A._splomGridDflt.xside="bottom",A._splomGridDflt.yside="left")}(0,s,c,n),t.coerceSelectionMarkerOpacity(s,n)}else s.visible=!1}},{"../../lib":787,"../../plots/array_container_defaults":833,"../parcoords/merge_length":1173,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scattergl/helpers":1261,"./attributes":1298}],1302:[function(r,I,B){var t=r("../../lib"),d=r("../scatter/colorscale_calc"),m=r("../scattergl/convert").markerStyle;I.exports=function(h,e){var f=e.trace,l=h._fullLayout._splomScenes[f.uid];if(l){d(h,f),t.extendFlat(l.matrixOptions,m(f));var o=t.extendFlat({},l.matrixOptions,l.viewOpts);l.matrix.update(o,null)}}},{"../../lib":787,"../scatter/colorscale_calc":1205,"../scattergl/convert":1257}],1303:[function(r,I,B){B.getDimIndex=function(t,d){for(var m=d._id,h={x:0,y:1}[m.charAt(0)],e=t._visibleDims,f=0;f<e.length;f++){var l=e[f];if(t._diag[l][h]===m)return f}return!1}},{}],1304:[function(r,I,B){var t=r("./helpers"),d=r("../scattergl/hover").calcHover;I.exports={hoverPoints:function(m,h,e){var f=m.cd[0].trace,l=m.scene.matrixOptions.cdata,o=m.xa,u=m.ya,s=o.c2p(h),i=u.c2p(e),c=m.distance,n=t.getDimIndex(f,o),a=t.getDimIndex(f,u);if(n===!1||a===!1)return[m];for(var g,p,y=l[n],v=l[a],b=c,x=0;x<y.length;x++){var T=y[x],A=v[x],S=o.c2p(T)-s,w=u.c2p(A)-i,E=Math.sqrt(S*S+w*w);E<b&&(b=p=E,g=x)}return m.index=g,m.distance=b,m.dxy=p,g===void 0?[m]:[d(m,y,v,f)]}}},{"../scattergl/hover":1262,"./helpers":1303}],1305:[function(r,I,B){var t=r("../../registry"),d=r("../../components/grid");I.exports={moduleType:"trace",name:"splom",basePlotModule:r("./base_plot"),categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),calc:r("./calc"),plot:r("./plot"),hoverPoints:r("./hover").hoverPoints,selectPoints:r("./select"),editStyle:r("./edit_style"),meta:{}},t.register(d)},{"../../components/grid":694,"../../registry":915,"../scatter/marker_colorbar":1220,"./attributes":1298,"./base_plot":1299,"./calc":1300,"./defaults":1301,"./edit_style":1302,"./hover":1304,"./plot":1306,"./select":1308}],1306:[function(r,I,B){var t=r("regl-splom"),d=r("../../lib"),m=r("../../plots/cartesian/axis_ids"),h=r("../../components/dragelement/helpers").selectMode;function e(f,l){var o,u,s,i,c,n=f._fullLayout,a=n._size,g=l.trace,p=l.t,y=n._splomScenes[g.uid],v=y.matrixOptions,b=v.cdata,x=n._glcanvas.data()[0].regl,T=n.dragmode;if(b.length!==0){v.lower=g.showupperhalf,v.upper=g.showlowerhalf,v.diagonal=g.diagonal.visible;var A=g._visibleDims,S=b.length,w=y.viewOpts={};for(w.ranges=new Array(S),w.domains=new Array(S),c=0;c<A.length;c++){s=A[c];var E=w.ranges[c]=new Array(4),k=w.domains[c]=new Array(4);(o=m.getFromId(f,g._diag[s][0]))&&(E[0]=o._rl[0],E[2]=o._rl[1],k[0]=o.domain[0],k[2]=o.domain[1]),(u=m.getFromId(f,g._diag[s][1]))&&(E[1]=u._rl[0],E[3]=u._rl[1],k[1]=u.domain[0],k[3]=u.domain[1])}var L=f._context.plotGlPixelRatio,M=a.l*L,P=a.b*L,D=a.w*L,N=a.h*L;w.viewport=[M,P,D+M,N+P],y.matrix===!0&&(y.matrix=t(x));var U=n.clickmode.indexOf("select")>-1,G=!0;if(h(T)||!!g.selectedpoints||U){var X=g._length;if(g.selectedpoints){y.selectBatch=g.selectedpoints;var K=g.selectedpoints,Z={};for(s=0;s<K.length;s++)Z[K[s]]=!0;var H=[];for(s=0;s<X;s++)Z[s]||H.push(s);y.unselectBatch=H}var Y=p.xpx=new Array(S),$=p.ypx=new Array(S);for(c=0;c<A.length;c++){if(s=A[c],o=m.getFromId(f,g._diag[s][0]))for(Y[c]=new Array(X),i=0;i<X;i++)Y[c][i]=o.c2p(b[c][i]);if(u=m.getFromId(f,g._diag[s][1]))for($[c]=new Array(X),i=0;i<X;i++)$[c][i]=u.c2p(b[c][i])}if(y.selectBatch.length||y.unselectBatch.length){var z=d.extendFlat({},v,y.unselectedOptions,w),j=d.extendFlat({},v,y.selectedOptions,w);y.matrix.update(z,j),G=!1}}else p.xpx=p.ypx=null;if(G){var W=d.extendFlat({},v,w);y.matrix.update(W,null)}}}I.exports=function(f,l,o){if(o.length)for(var u=0;u<o.length;u++)e(f,o[u][0])}},{"../../components/dragelement/helpers":668,"../../lib":787,"../../plots/cartesian/axis_ids":842,"regl-splom":525}],1307:[function(r,I,B){var t=r("../../lib");I.exports=function(d,m){var h=d._fullLayout,e=m.uid,f=h._splomScenes;f||(f=h._splomScenes={});var l={dirty:!0,selectBatch:[],unselectBatch:[]},o=f[m.uid];return o||((o=f[e]=t.extendFlat({},l,{matrix:!1,selectBatch:[],unselectBatch:[]})).draw=function(){o.matrix&&o.matrix.draw&&(o.selectBatch.length||o.unselectBatch.length?o.matrix.draw(o.unselectBatch,o.selectBatch):o.matrix.draw()),o.dirty=!1},o.destroy=function(){o.matrix&&o.matrix.destroy&&o.matrix.destroy(),o.matrixOptions=null,o.selectBatch=null,o.unselectBatch=null,o=null}),o.dirty||t.extendFlat(o,l),o}},{"../../lib":787}],1308:[function(r,I,B){var t=r("../../lib"),d=r("../scatter/subtypes"),m=r("./helpers");I.exports=function(h,e){var f=h.cd,l=f[0].trace,o=f[0].t,u=h.scene,s=u.matrixOptions.cdata,i=h.xaxis,c=h.yaxis,n=[];if(!u)return n;var a=!d.hasMarkers(l)&&!d.hasText(l);if(l.visible!==!0||a)return n;var g=m.getDimIndex(l,i),p=m.getDimIndex(l,c);if(g===!1||p===!1)return n;var y=o.xpx[g],v=o.ypx[p],b=s[g],x=s[p],T=[],A=[];if(e!==!1&&!e.degenerate)for(var S=0;S<b.length;S++)e.contains([y[S],v[S]],null,S,h)?(T.push(S),n.push({pointNumber:S,x:b[S],y:x[S]})):A.push(S);var w=u.matrixOptions;return T.length||A.length?u.selectBatch.length||u.unselectBatch.length||u.matrix.update(u.unselectedOptions,t.extendFlat({},w,u.selectedOptions,u.viewOpts)):u.matrix.update(w,null),u.selectBatch=T,u.unselectBatch=A,n}},{"../../lib":787,"../scatter/subtypes":1227,"./helpers":1303}],1309:[function(r,I,B){var t=r("../../components/colorscale/attributes"),d=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,m=r("../../plots/template_attributes").hovertemplateAttrs,h=r("../mesh3d/attributes"),e=r("../../plots/attributes"),f=r("../../lib/extend").extendFlat,l={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:m({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:d("u",1),vhoverformat:d("v",1),whoverformat:d("w",1),xhoverformat:d("x"),yhoverformat:d("y"),zhoverformat:d("z"),showlegend:f({},e.showlegend,{dflt:!1})};f(l,t("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(o){l[o]=h[o]}),l.hoverinfo=f({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),l.transforms=void 0,I.exports=l},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../mesh3d/attributes":1143}],1310:[function(r,I,B){var t=r("../../lib"),d=r("../../components/colorscale/calc");function m(f){var l,o,u,s,i,c,n,a,g,p,y,v,b=f._x,x=f._y,T=f._z,A=f._len,S=-1/0,w=1/0,E=-1/0,k=1/0,L=-1/0,M=1/0,P="";for(A&&(n=b[0],g=x[0],y=T[0]),A>1&&(a=b[A-1],p=x[A-1],v=T[A-1]),l=0;l<A;l++)S=Math.max(S,b[l]),w=Math.min(w,b[l]),E=Math.max(E,x[l]),k=Math.min(k,x[l]),L=Math.max(L,T[l]),M=Math.min(M,T[l]),s||b[l]===n||(s=!0,P+="x"),i||x[l]===g||(i=!0,P+="y"),c||T[l]===y||(c=!0,P+="z");s||(P+="x"),i||(P+="y"),c||(P+="z");var D=h(f._x),N=h(f._y),U=h(f._z);P=(P=(P=P.replace("x",(n>a?"-":"+")+"x")).replace("y",(g>p?"-":"+")+"y")).replace("z",(y>v?"-":"+")+"z");var G=function(){A=0,D=[],N=[],U=[]};(!A||A<D.length*N.length*U.length)&&G();var X=function(ue){return ue==="x"?b:ue==="y"?x:T},K=function(ue){return ue==="x"?D:ue==="y"?N:U},Z=function(ue){return ue[A-1]<ue[0]?-1:1},H=X(P[1]),Y=X(P[3]),$=X(P[5]),z=K(P[1]).length,j=K(P[3]).length,W=K(P[5]).length,ee=!1,J=function(ue,ve,ke){return z*(j*ue+ve)+ke},Q=Z(X(P[1])),te=Z(X(P[3])),ie=Z(X(P[5]));for(l=0;l<W-1;l++){for(o=0;o<j-1;o++){for(u=0;u<z-1;u++){var ae=J(l,o,u),he=J(l,o,u+1),se=J(l,o+1,u),de=J(l+1,o,u);if(H[ae]*Q<H[he]*Q&&Y[ae]*te<Y[se]*te&&$[ae]*ie<$[de]*ie||(ee=!0),ee)break}if(ee)break}if(ee)break}return ee&&(t.warn("Encountered arbitrary coordinates! Unable to input data grid."),G()),{xMin:w,yMin:k,zMin:M,xMax:S,yMax:E,zMax:L,Xs:D,Ys:N,Zs:U,len:A,fill:P}}function h(f){return t.distinctVals(f).vals}function e(f,l){if(l===void 0&&(l=f.length),t.isTypedArray(f))return f.subarray(0,l);for(var o=[],u=0;u<l;u++)o[u]=+f[u];return o}I.exports={calc:function(f,l){l._len=Math.min(l.u.length,l.v.length,l.w.length,l.x.length,l.y.length,l.z.length),l._u=e(l.u,l._len),l._v=e(l.v,l._len),l._w=e(l.w,l._len),l._x=e(l.x,l._len),l._y=e(l.y,l._len),l._z=e(l.z,l._len);var o=m(l);l._gridFill=o.fill,l._Xs=o.Xs,l._Ys=o.Ys,l._Zs=o.Zs,l._len=o.len;var u,s,i,c=0;l.starts&&(u=e(l.starts.x||[]),s=e(l.starts.y||[]),i=e(l.starts.z||[]),c=Math.min(u.length,s.length,i.length)),l._startsX=u||[],l._startsY=s||[],l._startsZ=i||[];var n,a=0,g=1/0;for(n=0;n<l._len;n++){var p=l._u[n],y=l._v[n],v=l._w[n],b=Math.sqrt(p*p+y*y+v*v);a=Math.max(a,b),g=Math.min(g,b)}for(d(f,l,{vals:[g,a],containerStr:"",cLetter:"c"}),n=0;n<c;n++){var x=u[n];o.xMax=Math.max(o.xMax,x),o.xMin=Math.min(o.xMin,x);var T=s[n];o.yMax=Math.max(o.yMax,T),o.yMin=Math.min(o.yMin,T);var A=i[n];o.zMax=Math.max(o.zMax,A),o.zMin=Math.min(o.zMin,A)}l._slen=c,l._normMax=a,l._xbnds=[o.xMin,o.xMax],l._ybnds=[o.yMin,o.yMax],l._zbnds=[o.zMin,o.zMax]},filter:e,processGrid:m}},{"../../components/colorscale/calc":658,"../../lib":787}],1311:[function(r,I,B){var t=r("gl-streamtube3d"),d=t.createTubeMesh,m=r("../../lib"),h=r("../../lib/gl_format_color").parseColorScale,e=r("../../components/colorscale").extractOpts,f=r("../../plots/gl3d/zip3"),l={xaxis:0,yaxis:1,zaxis:2};function o(n,a){this.scene=n,this.uid=a,this.mesh=null,this.data=null}var u=o.prototype;function s(n){var a=n.length;return a>2?n.slice(1,a-1):a===2?[(n[0]+n[1])/2]:n}function i(n){var a=n.length;return a===1?[.5,.5]:[n[1]-n[0],n[a-1]-n[a-2]]}function c(n,a){var g=n.fullSceneLayout,p=n.dataScale,y=a._len,v={};function b(z,j){var W=g[j],ee=p[l[j]];return m.simpleMap(z,function(J){return W.d2l(J)*ee})}if(v.vectors=f(b(a._u,"xaxis"),b(a._v,"yaxis"),b(a._w,"zaxis"),y),!y)return{positions:[],cells:[]};var x=b(a._Xs,"xaxis"),T=b(a._Ys,"yaxis"),A=b(a._Zs,"zaxis");if(v.meshgrid=[x,T,A],v.gridFill=a._gridFill,a._slen)v.startingPositions=f(b(a._startsX,"xaxis"),b(a._startsY,"yaxis"),b(a._startsZ,"zaxis"));else{for(var S=T[0],w=s(x),E=s(A),k=new Array(w.length*E.length),L=0,M=0;M<w.length;M++)for(var P=0;P<E.length;P++)k[L++]=[w[M],S,E[P]];v.startingPositions=k}v.colormap=h(a),v.tubeSize=a.sizeref,v.maxLength=a.maxdisplayed;var D=b(a._xbnds,"xaxis"),N=b(a._ybnds,"yaxis"),U=b(a._zbnds,"zaxis"),G=i(x),X=i(T),K=i(A),Z=[[D[0]-G[0],N[0]-X[0],U[0]-K[0]],[D[1]+G[1],N[1]+X[1],U[1]+K[1]]],H=t(v,Z),Y=e(a);H.vertexIntensityBounds=[Y.min/a._normMax,Y.max/a._normMax];var $=a.lightposition;return H.lightPosition=[$.x,$.y,$.z],H.ambient=a.lighting.ambient,H.diffuse=a.lighting.diffuse,H.specular=a.lighting.specular,H.roughness=a.lighting.roughness,H.fresnel=a.lighting.fresnel,H.opacity=a.opacity,a._pad=H.tubeScale*a.sizeref*2,H}u.handlePick=function(n){var a=this.scene.fullSceneLayout,g=this.scene.dataScale;function p(b,x){var T=a[x],A=g[l[x]];return T.l2c(b)/A}if(n.object===this.mesh){var y=n.data.position,v=n.data.velocity;return n.traceCoordinate=[p(y[0],"xaxis"),p(y[1],"yaxis"),p(y[2],"zaxis"),p(v[0],"xaxis"),p(v[1],"yaxis"),p(v[2],"zaxis"),n.data.intensity*this.data._normMax,n.data.divergence],n.textLabel=this.data.hovertext||this.data.text,!0}},u.update=function(n){this.data=n;var a=c(this.scene,n);this.mesh.update(a)},u.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},I.exports=function(n,a){var g=n.glplot.gl,p=c(n,a),y=d(g,p),v=new o(n,a.uid);return v.mesh=y,v.data=a,y._trace=v,n.glplot.add(y),v}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gl_format_color":783,"../../plots/gl3d/zip3":891,"gl-streamtube3d":344}],1312:[function(r,I,B){var t=r("../../lib"),d=r("../../components/colorscale/defaults"),m=r("./attributes");I.exports=function(h,e,f,l){function o(g,p){return t.coerce(h,e,m,g,p)}var u=o("u"),s=o("v"),i=o("w"),c=o("x"),n=o("y"),a=o("z");u&&u.length&&s&&s.length&&i&&i.length&&c&&c.length&&n&&n.length&&a&&a.length?(o("starts.x"),o("starts.y"),o("starts.z"),o("maxdisplayed"),o("sizeref"),o("lighting.ambient"),o("lighting.diffuse"),o("lighting.specular"),o("lighting.roughness"),o("lighting.fresnel"),o("lightposition.x"),o("lightposition.y"),o("lightposition.z"),d(h,e,l,o,{prefix:"",cLetter:"c"}),o("text"),o("hovertext"),o("hovertemplate"),o("uhoverformat"),o("vhoverformat"),o("whoverformat"),o("xhoverformat"),o("yhoverformat"),o("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":1309}],1313:[function(r,I,B){I.exports={moduleType:"trace",name:"streamtube",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:r("./calc").calc,plot:r("./convert"),eventData:function(t,d){return t.tubex=t.x,t.tubey=t.y,t.tubez=t.z,t.tubeu=d.traceCoordinate[3],t.tubev=d.traceCoordinate[4],t.tubew=d.traceCoordinate[5],t.norm=d.traceCoordinate[6],t.divergence=d.traceCoordinate[7],delete t.x,delete t.y,delete t.z,t},meta:{}}},{"../../plots/gl3d":880,"./attributes":1309,"./calc":1310,"./convert":1311,"./defaults":1312}],1314:[function(r,I,B){var t=r("../../plots/attributes"),d=r("../../plots/template_attributes").hovertemplateAttrs,m=r("../../plots/template_attributes").texttemplateAttrs,h=r("../../components/colorscale/attributes"),e=r("../../plots/domain").attributes,f=r("../pie/attributes"),l=r("./constants"),o=r("../../lib/extend").extendFlat;I.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:o({colors:{valType:"data_array",editType:"calc"},line:{color:o({},f.marker.line.color,{dflt:null}),width:o({},f.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},h("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:f.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:m({editType:"plot"},{keys:l.eventDataKeys.concat(["label","value"])}),hovertext:f.hovertext,hoverinfo:o({},t.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:d({},{keys:l.eventDataKeys}),textfont:f.textfont,insidetextorientation:f.insidetextorientation,insidetextfont:f.insidetextfont,outsidetextfont:o({},f.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:f.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/domain":866,"../../plots/template_attributes":910,"../pie/attributes":1176,"./constants":1317}],1315:[function(r,I,B){var t=r("../../plots/plots");B.name="sunburst",B.plot=function(d,m,h,e){t.plotBasePlot(B.name,d,m,h,e)},B.clean=function(d,m,h,e){t.cleanBasePlot(B.name,d,m,h,e)}},{"../../plots/plots":901}],1316:[function(r,I,B){var t=r("d3-hierarchy"),d=r("fast-isnumeric"),m=r("../../lib"),h=r("../../components/colorscale").makeColorScaleFuncFromTrace,e=r("../pie/calc").makePullColorFn,f=r("../pie/calc").generateExtendedColors,l=r("../../components/colorscale").calc,o=r("../../constants/numerical").ALMOST_EQUAL,u={},s={},i={};B.calc=function(c,n){var a,g,p,y,v,b,x=c._fullLayout,T=n.ids,A=m.isArrayOrTypedArray(T),S=n.labels,w=n.parents,E=n.values,k=m.isArrayOrTypedArray(E),L=[],M={},P={},D=function(te){return te||typeof te=="number"},N=function(te){return!k||d(E[te])&&E[te]>=0};A?(a=Math.min(T.length,w.length),g=function(te){return D(T[te])&&N(te)},p=function(te){return String(T[te])}):(a=Math.min(S.length,w.length),g=function(te){return D(S[te])&&N(te)},p=function(te){return String(S[te])}),k&&(a=Math.min(a,E.length));for(var U=0;U<a;U++)if(g(U)){var G=p(U),X=D(w[U])?String(w[U]):"",K={i:U,id:G,pid:X,label:D(S[U])?String(S[U]):""};k&&(K.v=+E[U]),L.push(K),v=G,M[y=X]?M[y].push(v):M[y]=[v],P[v]=1}if(M[""]){if(M[""].length>1){for(var Z=m.randstr(),H=0;H<L.length;H++)L[H].pid===""&&(L[H].pid=Z);L.unshift({hasMultipleRoots:!0,id:Z,pid:"",label:""})}}else{var Y,$=[];for(Y in M)P[Y]||$.push(Y);if($.length!==1)return m.warn(["Multiple implied roots, cannot build",n.type,"hierarchy of",n.name+".","These roots include:",$.join(", ")].join(" "));Y=$[0],L.unshift({hasImpliedRoot:!0,id:Y,pid:"",label:Y})}try{b=t.stratify().id(function(te){return te.id}).parentId(function(te){return te.pid})(L)}catch(te){return m.warn(["Failed to build",n.type,"hierarchy of",n.name+".","Error:",te.message].join(" "))}var z=t.hierarchy(b),j=!1;if(k)switch(n.branchvalues){case"remainder":z.sum(function(te){return te.data.v});break;case"total":z.each(function(te){var ie=te.data.data,ae=ie.v;if(te.children){var he=te.children.reduce(function(se,de){return se+de.data.data.v},0);if((ie.hasImpliedRoot||ie.hasMultipleRoots)&&(ae=he),ae<he*o)return j=!0,m.warn(["Total value for node",te.data.data.id,"of",n.name,"is smaller than the sum of its children.",`
parent value =`,ae,`
children sum =`,he].join(" "))}te.value=ae})}else(function te(ie,ae,he){var se=0,de=ie.children;if(de){for(var ue=de.length,ve=0;ve<ue;ve++)se+=te(de[ve],ae,he);he.branches&&se++}else he.leaves&&se++;return ie.value=ie.data.data.value=se,ae._values||(ae._values=[]),ae._values[ie.data.data.i]=se,se})(z,n,{branches:n.count.indexOf("branches")!==-1,leaves:n.count.indexOf("leaves")!==-1});if(!j){var W,ee;n.sort&&z.sort(function(te,ie){return ie.value-te.value});var J=n.marker.colors||[],Q=!!J.length;return n._hasColorscale?(Q||(J=k?n.values:n._values),l(c,n,{vals:J,containerStr:"marker",cLetter:"c"}),ee=h(n.marker)):W=e(x["_"+n.type+"colormap"]),z.each(function(te){var ie=te.data.data;ie.color=n._hasColorscale?ee(J[ie.i]):W(J[ie.i],ie.id)}),L[0].hierarchy=z,L}},B._runCrossTraceCalc=function(c,n){var a=n._fullLayout,g=n.calcdata,p=a[c+"colorway"],y=a["_"+c+"colormap"];a["extend"+c+"colors"]&&(p=f(p,c==="icicle"?i:c==="treemap"?s:u));var v,b=0;function x(S){var w=S.data.data,E=w.id;w.color===!1&&(y[E]?w.color=y[E]:S.parent?S.parent.parent?w.color=S.parent.data.data.color:(y[E]=w.color=p[b%p.length],b++):w.color=v)}for(var T=0;T<g.length;T++){var A=g[T][0];A.trace.type===c&&A.hierarchy&&(v=A.trace.root.color,A.hierarchy.each(x))}},B.crossTraceCalc=function(c){return B._runCrossTraceCalc("sunburst",c)}},{"../../components/colorscale":662,"../../constants/numerical":763,"../../lib":787,"../pie/calc":1178,"d3-hierarchy":167,"fast-isnumeric":246}],1317:[function(r,I,B){I.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1318:[function(r,I,B){var t=r("../../lib"),d=r("./attributes"),m=r("../../plots/domain").defaults,h=r("../bar/defaults").handleText,e=r("../../components/colorscale"),f=e.hasColorscale,l=e.handleDefaults;I.exports=function(o,u,s,i){function c(v,b){return t.coerce(o,u,d,v,b)}var n=c("labels"),a=c("parents");if(n&&n.length&&a&&a.length){var g=c("values");g&&g.length?c("branchvalues"):c("count"),c("level"),c("maxdepth"),c("marker.line.width")&&c("marker.line.color",i.paper_bgcolor),c("marker.colors");var p=u._hasColorscale=f(o,"marker","colors")||(o.marker||{}).coloraxis;p&&l(o,u,i,c,{prefix:"marker.",cLetter:"c"}),c("leaf.opacity",p?1:.7);var y=c("text");c("texttemplate"),u.texttemplate||c("textinfo",Array.isArray(y)?"text+label":"label"),c("hovertext"),c("hovertemplate"),h(o,u,i,c,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),c("insidetextorientation"),c("sort"),c("rotation"),c("root.color"),m(u,i,c),u._length=null}else u.visible=!1}},{"../../components/colorscale":662,"../../lib":787,"../../plots/domain":866,"../bar/defaults":929,"./attributes":1314}],1319:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../registry"),m=r("../../components/fx/helpers").appendArrayPointValue,h=r("../../components/fx"),e=r("../../lib"),f=r("../../lib/events"),l=r("./helpers"),o=r("../pie/helpers").formatPieValue;function u(s,i,c){for(var n=s.data.data,a={curveNumber:i.index,pointNumber:n.i,data:i._input,fullData:i},g=0;g<c.length;g++){var p=c[g];p in s&&(a[p]=s[p])}return"parentString"in s&&!l.isHierarchyRoot(s)&&(a.parent=s.parentString),m(a,i,n.i),a}I.exports=function(s,i,c,n,a){var g=n[0],p=g.trace,y=g.hierarchy,v=p.type==="sunburst",b=p.type==="treemap"||p.type==="icicle";"_hasHoverLabel"in p||(p._hasHoverLabel=!1),"_hasHoverEvent"in p||(p._hasHoverEvent=!1),s.on("mouseover",function(x){var T=c._fullLayout;if(!c._dragging&&T.hovermode!==!1){var A,S=c._fullData[p.index],w=x.data.data,E=w.i,k=l.isHierarchyRoot(x),L=l.getParent(y,x),M=l.getValue(x),P=function(Q){return e.castOption(S,E,Q)},D=P("hovertemplate"),N=h.castHoverinfo(S,T,E),U=T.separators;if(D||N&&N!=="none"&&N!=="skip"){var G,X;v&&(G=g.cx+x.pxmid[0]*(1-x.rInscribed),X=g.cy+x.pxmid[1]*(1-x.rInscribed)),b&&(G=x._hoverX,X=x._hoverY);var K,Z={},H=[],Y=[],$=function(Q){return H.indexOf(Q)!==-1};N&&(H=N==="all"?S._module.attributes.hoverinfo.flags:N.split("+")),Z.label=w.label,$("label")&&Z.label&&Y.push(Z.label),w.hasOwnProperty("v")&&(Z.value=w.v,Z.valueLabel=o(Z.value,U),$("value")&&Y.push(Z.valueLabel)),Z.currentPath=x.currentPath=l.getPath(x.data),$("current path")&&!k&&Y.push(Z.currentPath);var z=[],j=function(){z.indexOf(K)===-1&&(Y.push(K),z.push(K))};Z.percentParent=x.percentParent=M/l.getValue(L),Z.parent=x.parentString=l.getPtLabel(L),$("percent parent")&&(K=l.formatPercent(Z.percentParent,U)+" of "+Z.parent,j()),Z.percentEntry=x.percentEntry=M/l.getValue(i),Z.entry=x.entry=l.getPtLabel(i),!$("percent entry")||k||x.onPathbar||(K=l.formatPercent(Z.percentEntry,U)+" of "+Z.entry,j()),Z.percentRoot=x.percentRoot=M/l.getValue(y),Z.root=x.root=l.getPtLabel(y),$("percent root")&&!k&&(K=l.formatPercent(Z.percentRoot,U)+" of "+Z.root,j()),Z.text=P("hovertext")||P("text"),$("text")&&(K=Z.text,e.isValidTextValue(K)&&Y.push(K)),A=[u(x,S,a.eventDataKeys)];var W={trace:S,y:X,_x0:x._x0,_x1:x._x1,_y0:x._y0,_y1:x._y1,text:Y.join("<br>"),name:D||$("name")?S.name:void 0,color:P("hoverlabel.bgcolor")||w.color,borderColor:P("hoverlabel.bordercolor"),fontFamily:P("hoverlabel.font.family"),fontSize:P("hoverlabel.font.size"),fontColor:P("hoverlabel.font.color"),nameLength:P("hoverlabel.namelength"),textAlign:P("hoverlabel.align"),hovertemplate:D,hovertemplateLabels:Z,eventData:A};v&&(W.x0=G-x.rInscribed*x.rpx1,W.x1=G+x.rInscribed*x.rpx1,W.idealAlign=x.pxmid[0]<0?"left":"right"),b&&(W.x=G,W.idealAlign=G<0?"left":"right");var ee=[];h.loneHover(W,{container:T._hoverlayer.node(),outerContainer:T._paper.node(),gd:c,inOut_bbox:ee}),A[0].bbox=ee[0],p._hasHoverLabel=!0}if(b){var J=s.select("path.surface");a.styleOne(J,x,S,{hovered:!0})}p._hasHoverEvent=!0,c.emit("plotly_hover",{points:A||[u(x,S,a.eventDataKeys)],event:t.event})}}),s.on("mouseout",function(x){var T=c._fullLayout,A=c._fullData[p.index],S=t.select(this).datum();if(p._hasHoverEvent&&(x.originalEvent=t.event,c.emit("plotly_unhover",{points:[u(S,A,a.eventDataKeys)],event:t.event}),p._hasHoverEvent=!1),p._hasHoverLabel&&(h.loneUnhover(T._hoverlayer.node()),p._hasHoverLabel=!1),b){var w=s.select("path.surface");a.styleOne(w,S,A,{hovered:!1})}}),s.on("click",function(x){var T=c._fullLayout,A=c._fullData[p.index],S=v&&(l.isHierarchyRoot(x)||l.isLeaf(x)),w=l.getPtId(x),E=l.isEntry(x)?l.findEntryWithChild(y,w):l.findEntryWithLevel(y,w),k=l.getPtId(E),L={points:[u(x,A,a.eventDataKeys)],event:t.event};S||(L.nextLevel=k);var M=f.triggerHandler(c,"plotly_"+p.type+"click",L);if(M!==!1&&T.hovermode&&(c._hoverdata=[u(x,A,a.eventDataKeys)],h.click(c,t.event)),!S&&M!==!1&&!c._dragging&&!c._transitioning){d.call("_storeDirectGUIEdit",A,T._tracePreGUI[A.uid],{level:A.level});var P={data:[{level:k}],traces:[p.index]},D={frame:{redraw:!1,duration:a.transitionTime},transition:{duration:a.transitionTime,easing:a.transitionEasing},mode:"immediate",fromcurrent:!0};h.loneUnhover(T._hoverlayer.node()),d.call("animate",c,P,D)}})}},{"../../components/fx":690,"../../components/fx/helpers":686,"../../lib":787,"../../lib/events":776,"../../registry":915,"../pie/helpers":1181,"./helpers":1320,"@plotly/d3":58}],1320:[function(r,I,B){var t=r("../../lib"),d=r("../../components/color"),m=r("../../lib/setcursor"),h=r("../pie/helpers");function e(f){return f.data.data.pid}B.findEntryWithLevel=function(f,l){var o;return l&&f.eachAfter(function(u){if(B.getPtId(u)===l)return o=u.copy()}),o||f},B.findEntryWithChild=function(f,l){var o;return f.eachAfter(function(u){for(var s=u.children||[],i=0;i<s.length;i++){var c=s[i];if(B.getPtId(c)===l)return o=u.copy()}}),o||f},B.isEntry=function(f){return!f.parent},B.isLeaf=function(f){return!f.children},B.getPtId=function(f){return f.data.data.id},B.getPtLabel=function(f){return f.data.data.label},B.getValue=function(f){return f.value},B.isHierarchyRoot=function(f){return e(f)===""},B.setSliceCursor=function(f,l,o){var u=o.isTransitioning;if(!u){var s=f.datum();u=o.hideOnRoot&&B.isHierarchyRoot(s)||o.hideOnLeaves&&B.isLeaf(s)}m(f,u?null:"pointer")},B.getInsideTextFontKey=function(f,l,o,u,s){var i=(s||{}).onPathbar?"pathbar.textfont":"insidetextfont",c=o.data.data.i;return t.castOption(l,c,i+"."+f)||t.castOption(l,c,"textfont."+f)||u.size},B.getOutsideTextFontKey=function(f,l,o,u){var s=o.data.data.i;return t.castOption(l,s,"outsidetextfont."+f)||t.castOption(l,s,"textfont."+f)||u.size},B.isOutsideText=function(f,l){return!f._hasColorscale&&B.isHierarchyRoot(l)},B.determineTextFont=function(f,l,o,u){return B.isOutsideText(f,l)?function(s,i,c){return{color:B.getOutsideTextFontKey("color",s,i,c),family:B.getOutsideTextFontKey("family",s,i,c),size:B.getOutsideTextFontKey("size",s,i,c)}}(f,l,o):function(s,i,c,n){var a=(n||{}).onPathbar,g=i.data.data,p=g.i,y=t.castOption(s,p,(a?"pathbar.textfont":"insidetextfont")+".color");return!y&&s._input.textfont&&(y=t.castOption(s._input,p,"textfont.color")),{color:y||d.contrast(g.color),family:B.getInsideTextFontKey("family",s,i,c,n),size:B.getInsideTextFontKey("size",s,i,c,n)}}(f,l,o,u)},B.hasTransition=function(f){return!!(f&&f.duration>0)},B.getMaxDepth=function(f){return f.maxdepth>=0?f.maxdepth:1/0},B.isHeader=function(f,l){return!(B.isLeaf(f)||f.depth===l._maxDepth-1)},B.getParent=function(f,l){return B.findEntryWithLevel(f,e(l))},B.listPath=function(f,l){var o=f.parent;if(!o)return[];var u=l?[o.data[l]]:[o];return B.listPath(o,l).concat(u)},B.getPath=function(f){return B.listPath(f,"label").join("/")+"/"},B.formatValue=h.formatPieValue,B.formatPercent=function(f,l){var o=t.formatPercent(f,0);return o==="0%"&&(o=h.formatPiePercent(f,l)),o}},{"../../components/color":650,"../../lib":787,"../../lib/setcursor":808,"../pie/helpers":1181}],1321:[function(r,I,B){I.exports={moduleType:"trace",name:"sunburst",basePlotModule:r("./base_plot"),categories:[],animatable:!0,attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot").plot,style:r("./style").style,colorbar:r("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1220,"./attributes":1314,"./base_plot":1315,"./calc":1316,"./defaults":1318,"./layout_attributes":1322,"./layout_defaults":1323,"./plot":1324,"./style":1325}],1322:[function(r,I,B){I.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1323:[function(r,I,B){var t=r("../../lib"),d=r("./layout_attributes");I.exports=function(m,h){function e(f,l){return t.coerce(m,h,d,f,l)}e("sunburstcolorway",h.colorway),e("extendsunburstcolors")}},{"../../lib":787,"./layout_attributes":1322}],1324:[function(r,I,B){var t=r("@plotly/d3"),d=r("d3-hierarchy"),m=r("d3-interpolate").interpolate,h=r("../../components/drawing"),e=r("../../lib"),f=r("../../lib/svg_text_utils"),l=r("../bar/uniform_text"),o=l.recordMinTextSize,u=l.clearMinTextSize,s=r("../pie/plot"),i=r("../pie/helpers").getRotationAngle,c=s.computeTransform,n=s.transformInsideText,a=r("./style").styleOne,g=r("../bar/style").resizeText,p=r("./fx"),y=r("./constants"),v=r("./helpers");function b(T,A,S,w){var E=T._fullLayout,k=!E.uniformtext.mode&&v.hasTransition(w),L=t.select(S).selectAll("g.slice"),M=A[0],P=M.trace,D=M.hierarchy,N=v.findEntryWithLevel(D,P.level),U=v.getMaxDepth(P),G=E._size,X=P.domain,K=G.w*(X.x[1]-X.x[0]),Z=G.h*(X.y[1]-X.y[0]),H=.5*Math.min(K,Z),Y=M.cx=G.l+G.w*(X.x[1]+X.x[0])/2,$=M.cy=G.t+G.h*(1-X.y[0])-Z/2;if(!N)return L.remove();var z=null,j={};k&&L.each(function(xe){j[v.getPtId(xe)]={rpx0:xe.rpx0,rpx1:xe.rpx1,x0:xe.x0,x1:xe.x1,transform:xe.transform},!z&&v.isEntry(xe)&&(z=xe)});var W=function(xe){return d.partition().size([2*Math.PI,xe.height+1])(xe)}(N).descendants(),ee=N.height+1,J=0,Q=U;M.hasMultipleRoots&&v.isHierarchyRoot(N)&&(W=W.slice(1),ee-=1,J=1,Q+=1),W=W.filter(function(xe){return xe.y1<=Q});var te=i(P.rotation);te&&W.forEach(function(xe){xe.x0+=te,xe.x1+=te});var ie=Math.min(ee,U),ae=function(xe){return(xe-J)/ie*H},he=function(xe,ce){return[xe*Math.cos(ce),-xe*Math.sin(ce)]},se=function(xe){return e.pathAnnulus(xe.rpx0,xe.rpx1,xe.x0,xe.x1,Y,$)},de=function(xe){return Y+x(xe)[0]*(xe.transform.rCenter||0)+(xe.transform.x||0)},ue=function(xe){return $+x(xe)[1]*(xe.transform.rCenter||0)+(xe.transform.y||0)};(L=L.data(W,v.getPtId)).enter().append("g").classed("slice",!0),k?L.exit().transition().each(function(){var xe=t.select(this);xe.select("path.surface").transition().attrTween("d",function(ce){var ge=function(we){var Me,Se=v.getPtId(we),ze=j[Se],Fe=j[v.getPtId(N)];if(Fe){var Ye=(we.x1>Fe.x1?2*Math.PI:0)+te;Me=we.rpx1<Fe.rpx1?{x0:we.x0,x1:we.x1,rpx0:0,rpx1:0}:{x0:Ye,x1:Ye,rpx0:we.rpx0,rpx1:we.rpx1}}else{var rt,Oe=v.getPtId(we.parent);L.each(function(st){if(v.getPtId(st)===Oe)return rt=st});var je,We=rt.children;We.forEach(function(st,ct){if(v.getPtId(st)===Se)return je=ct});var qe=We.length,et=m(rt.x0,rt.x1);Me={rpx0:H,rpx1:H,x0:et(je/qe),x1:et((je+1)/qe)}}return m(ze,Me)}(ce);return function(we){return se(ge(we))}}),xe.select("g.slicetext").attr("opacity",0)}).remove():L.exit().remove(),L.order();var ve=null;if(k&&z){var ke=v.getPtId(z);L.each(function(xe){ve===null&&v.getPtId(xe)===ke&&(ve=xe.x1)})}var Ee=L;function be(xe){var ce=xe.parent,ge=j[v.getPtId(ce)],we={};if(ge){var Me=ce.children,Se=Me.indexOf(xe),ze=Me.length,Fe=m(ge.x0,ge.x1);we.x0=Fe(Se/ze),we.x1=Fe(Se/ze)}else we.x0=we.x1=0;return we}k&&(Ee=Ee.transition().each("end",function(){var xe=t.select(this);v.setSliceCursor(xe,T,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),Ee.each(function(xe){var ce=t.select(this),ge=e.ensureSingle(ce,"path","surface",function(Ye){Ye.style("pointer-events","all")});xe.rpx0=ae(xe.y0),xe.rpx1=ae(xe.y1),xe.xmid=(xe.x0+xe.x1)/2,xe.pxmid=he(xe.rpx1,xe.xmid),xe.midangle=-(xe.xmid-Math.PI/2),xe.startangle=-(xe.x0-Math.PI/2),xe.stopangle=-(xe.x1-Math.PI/2),xe.halfangle=.5*Math.min(e.angleDelta(xe.x0,xe.x1)||Math.PI,Math.PI),xe.ring=1-xe.rpx0/xe.rpx1,xe.rInscribed=function(Ye){return Ye.rpx0===0&&e.isFullCircle([Ye.x0,Ye.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(Ye.halfangle)),Ye.ring/2))}(xe),k?ge.transition().attrTween("d",function(Ye){var rt=function(Oe){var je,We=j[v.getPtId(Oe)],qe={x0:Oe.x0,x1:Oe.x1,rpx0:Oe.rpx0,rpx1:Oe.rpx1};if(We)je=We;else if(z)if(Oe.parent)if(ve){var et=(Oe.x1>ve?2*Math.PI:0)+te;je={x0:et,x1:et}}else je={rpx0:H,rpx1:H},e.extendFlat(je,be(Oe));else je={rpx0:0,rpx1:0};else je={x0:te,x1:te};return m(je,qe)}(Ye);return function(Oe){return se(rt(Oe))}}):ge.attr("d",se),ce.call(p,N,T,A,{eventDataKeys:y.eventDataKeys,transitionTime:y.CLICK_TRANSITION_TIME,transitionEasing:y.CLICK_TRANSITION_EASING}).call(v.setSliceCursor,T,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:T._transitioning}),ge.call(a,xe,P);var we=e.ensureSingle(ce,"g","slicetext"),Me=e.ensureSingle(we,"text","",function(Ye){Ye.attr("data-notex",1)}),Se=e.ensureUniformFontSize(T,v.determineTextFont(P,xe,E.font));Me.text(B.formatSliceLabel(xe,N,P,A,E)).classed("slicetext",!0).attr("text-anchor","middle").call(h.font,Se).call(f.convertToTspans,T);var ze=h.bBox(Me.node());xe.transform=n(ze,xe,M),xe.transform.targetX=de(xe),xe.transform.targetY=ue(xe);var Fe=function(Ye,rt){var Oe=Ye.transform;return c(Oe,rt),Oe.fontSize=Se.size,o(P.type,Oe,E),e.getTextTransform(Oe)};k?Me.transition().attrTween("transform",function(Ye){var rt=function(Oe){var je,We=j[v.getPtId(Oe)],qe=Oe.transform;if(We)je=We;else if(je={rpx1:Oe.rpx1,transform:{textPosAngle:qe.textPosAngle,scale:0,rotate:qe.rotate,rCenter:qe.rCenter,x:qe.x,y:qe.y}},z)if(Oe.parent)if(ve){var et=Oe.x1>ve?2*Math.PI:0;je.x0=je.x1=et}else e.extendFlat(je,be(Oe));else je.x0=je.x1=te;else je.x0=je.x1=te;var st=m(je.transform.textPosAngle,Oe.transform.textPosAngle),ct=m(je.rpx1,Oe.rpx1),Pt=m(je.x0,Oe.x0),kt=m(je.x1,Oe.x1),at=m(je.transform.scale,qe.scale),tt=m(je.transform.rotate,qe.rotate),_t=qe.rCenter===0?3:je.transform.rCenter===0?1/3:1,er=m(je.transform.rCenter,qe.rCenter);return function(tr){var Ue=ct(tr),He=Pt(tr),Be=kt(tr),Ke=function(Ce){return er(Math.pow(Ce,_t))}(tr),_e={pxmid:he(Ue,(He+Be)/2),rpx1:Ue,transform:{textPosAngle:st(tr),rCenter:Ke,x:qe.x,y:qe.y}};return o(P.type,qe,E),{transform:{targetX:de(_e),targetY:ue(_e),scale:at(tr),rotate:tt(tr),rCenter:Ke}}}}(Ye);return function(Oe){return Fe(rt(Oe),ze)}}):Me.attr("transform",Fe(xe,ze))})}function x(T){return A=T.rpx1,S=T.transform.textPosAngle,[A*Math.sin(S),-A*Math.cos(S)];var A,S}B.plot=function(T,A,S,w){var E,k,L=T._fullLayout,M=L._sunburstlayer,P=!S,D=!L.uniformtext.mode&&v.hasTransition(S);u("sunburst",L),(E=M.selectAll("g.trace.sunburst").data(A,function(N){return N[0].trace.uid})).enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),E.order(),D?(w&&(k=w()),t.transition().duration(S.duration).ease(S.easing).each("end",function(){k&&k()}).each("interrupt",function(){k&&k()}).each(function(){M.selectAll("g.trace").each(function(N){b(T,N,this,S)})})):(E.each(function(N){b(T,N,this,S)}),L.uniformtext.mode&&g(T,L._sunburstlayer.selectAll(".trace"),"sunburst")),P&&E.exit().remove()},B.formatSliceLabel=function(T,A,S,w,E){var k=S.texttemplate,L=S.textinfo;if(!(k||L&&L!=="none"))return"";var M=E.separators,P=w[0],D=T.data.data,N=P.hierarchy,U=v.isHierarchyRoot(T),G=v.getParent(N,T),X=v.getValue(T);if(!k){var K,Z=L.split("+"),H=function(te){return Z.indexOf(te)!==-1},Y=[];if(H("label")&&D.label&&Y.push(D.label),D.hasOwnProperty("v")&&H("value")&&Y.push(v.formatValue(D.v,M)),!U){H("current path")&&Y.push(v.getPath(T.data));var $=0;H("percent parent")&&$++,H("percent entry")&&$++,H("percent root")&&$++;var z=$>1;if($){var j,W=function(te){K=v.formatPercent(j,M),z&&(K+=" of "+te),Y.push(K)};H("percent parent")&&!U&&(j=X/v.getValue(G),W("parent")),H("percent entry")&&(j=X/v.getValue(A),W("entry")),H("percent root")&&(j=X/v.getValue(N),W("root"))}}return H("text")&&(K=e.castOption(S,D.i,"text"),e.isValidTextValue(K)&&Y.push(K)),Y.join("<br>")}var ee=e.castOption(S,D.i,"texttemplate");if(!ee)return"";var J={};D.label&&(J.label=D.label),D.hasOwnProperty("v")&&(J.value=D.v,J.valueLabel=v.formatValue(D.v,M)),J.currentPath=v.getPath(T.data),U||(J.percentParent=X/v.getValue(G),J.percentParentLabel=v.formatPercent(J.percentParent,M),J.parent=v.getPtLabel(G)),J.percentEntry=X/v.getValue(A),J.percentEntryLabel=v.formatPercent(J.percentEntry,M),J.entry=v.getPtLabel(A),J.percentRoot=X/v.getValue(N),J.percentRootLabel=v.formatPercent(J.percentRoot,M),J.root=v.getPtLabel(N),D.hasOwnProperty("color")&&(J.color=D.color);var Q=e.castOption(S,D.i,"text");return(e.isValidTextValue(Q)||Q==="")&&(J.text=Q),J.customdata=e.castOption(S,D.i,"customdata"),e.texttemplateString(ee,J,E._d3locale,J,S._meta||{})}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../bar/style":939,"../bar/uniform_text":941,"../pie/helpers":1181,"../pie/plot":1185,"./constants":1317,"./fx":1319,"./helpers":1320,"./style":1325,"@plotly/d3":58,"d3-hierarchy":167,"d3-interpolate":168}],1325:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/color"),m=r("../../lib"),h=r("../bar/uniform_text").resizeText;function e(f,l,o){var u=l.data.data,s=!l.children,i=u.i,c=m.castOption(o,i,"marker.line.color")||d.defaultLine,n=m.castOption(o,i,"marker.line.width")||0;f.style("stroke-width",n).call(d.fill,u.color).call(d.stroke,c).style("opacity",s?o.leaf.opacity:null)}I.exports={style:function(f){var l=f._fullLayout._sunburstlayer.selectAll(".trace");h(f,l,"sunburst"),l.each(function(o){var u=t.select(this),s=o[0].trace;u.style("opacity",s.opacity),u.selectAll("path.surface").each(function(i){t.select(this).call(e,i,s)})})},styleOne:e}},{"../../components/color":650,"../../lib":787,"../bar/uniform_text":941,"@plotly/d3":58}],1326:[function(r,I,B){var t=r("../../components/color"),d=r("../../components/colorscale/attributes"),m=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,h=r("../../plots/template_attributes").hovertemplateAttrs,e=r("../../plots/attributes"),f=r("../../lib/extend").extendFlat,l=r("../../plot_api/edit_types").overrideAll;function o(s){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:{valType:"boolean",dflt:!1},y:{valType:"boolean",dflt:!1},z:{valType:"boolean",dflt:!1}},color:{valType:"color",dflt:t.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:t.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var u=I.exports=l(f({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:h(),xhoverformat:m("x"),yhoverformat:m("y"),zhoverformat:m("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},d("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:o(),y:o(),z:o()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:f({},d.zauto,{}),zmin:f({},d.zmin,{}),zmax:f({},d.zmax,{})},hoverinfo:f({},e.hoverinfo),showlegend:f({},e.showlegend,{dflt:!1})}),"calc","nested");u.x.editType=u.y.editType=u.z.editType="calc+clearAxisTypes",u.transforms=void 0},{"../../components/color":650,"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910}],1327:[function(r,I,B){var t=r("../../components/colorscale/calc");I.exports=function(d,m){m.surfacecolor?t(d,m,{vals:m.surfacecolor,containerStr:"",cLetter:"c"}):t(d,m,{vals:m.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":658}],1328:[function(r,I,B){var t=r("gl-surface3d"),d=r("ndarray"),m=r("ndarray-linear-interpolate").d2,h=r("../heatmap/interp2d"),e=r("../heatmap/find_empties"),f=r("../../lib").isArrayOrTypedArray,l=r("../../lib/gl_format_color").parseColorScale,o=r("../../lib/str2rgbarray"),u=r("../../components/colorscale").extractOpts;function s(S,w,E){this.scene=S,this.uid=E,this.surface=w,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var i=s.prototype;i.getXat=function(S,w,E,k){var L=f(this.data.x)?f(this.data.x[0])?this.data.x[w][S]:this.data.x[S]:S;return E===void 0?L:k.d2l(L,0,E)},i.getYat=function(S,w,E,k){var L=f(this.data.y)?f(this.data.y[0])?this.data.y[w][S]:this.data.y[w]:w;return E===void 0?L:k.d2l(L,0,E)},i.getZat=function(S,w,E,k){var L=this.data.z[w][S];return L===null&&this.data.connectgaps&&this.data._interpolatedZ&&(L=this.data._interpolatedZ[w][S]),E===void 0?L:k.d2l(L,0,E)},i.handlePick=function(S){if(S.object===this.surface){var w=(S.data.index[0]-1)/this.dataScaleX-1,E=(S.data.index[1]-1)/this.dataScaleY-1,k=Math.max(Math.min(Math.round(w),this.data.z[0].length-1),0),L=Math.max(Math.min(Math.round(E),this.data._ylength-1),0);S.index=[k,L],S.traceCoordinate=[this.getXat(k,L),this.getYat(k,L),this.getZat(k,L)],S.dataCoordinate=[this.getXat(k,L,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(k,L,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(k,L,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var M=0;M<3;M++){var P=S.dataCoordinate[M];P!=null&&(S.dataCoordinate[M]*=this.scene.dataScale[M])}var D=this.data.hovertext||this.data.text;return Array.isArray(D)&&D[L]&&D[L][k]!==void 0?S.textLabel=D[L][k]:S.textLabel=D||"",S.data.dataCoordinate=S.dataCoordinate.slice(),this.surface.highlight(S.data),this.scene.glplot.spikes.position=S.dataCoordinate,!0}};var c=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function n(S,w){if(S<w)return 0;for(var E=0;Math.floor(S%w)===0;)S/=w,E++;return E}function a(S){for(var w=[],E=0;E<c.length;E++){var k=c[E];w.push(n(S,k))}return w}function g(S){for(var w=a(S),E=S,k=0;k<c.length;k++)if(w[k]>0){E=c[k];break}return E}function p(S,w){if(!(S<1||w<1)){for(var E=a(S),k=a(w),L=1,M=0;M<c.length;M++)L*=Math.pow(c[M],Math.max(E[M],k[M]));return L}}i.calcXnums=function(S){var w,E=[];for(w=1;w<S;w++){var k=this.getXat(w-1,0),L=this.getXat(w,0);E[w-1]=L!==k&&k!=null&&L!=null?Math.abs(L-k):0}var M=0;for(w=1;w<S;w++)M+=E[w-1];for(w=1;w<S;w++)E[w-1]===0?E[w-1]=1:E[w-1]=Math.round(M/E[w-1]);return E},i.calcYnums=function(S){var w,E=[];for(w=1;w<S;w++){var k=this.getYat(0,w-1),L=this.getYat(0,w);E[w-1]=L!==k&&k!=null&&L!=null?Math.abs(L-k):0}var M=0;for(w=1;w<S;w++)M+=E[w-1];for(w=1;w<S;w++)E[w-1]===0?E[w-1]=1:E[w-1]=Math.round(M/E[w-1]);return E};var y=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],v=y[9],b=y[13];function x(S,w,E){var k=E[8]+E[2]*w[0]+E[5]*w[1];return S[0]=(E[6]+E[0]*w[0]+E[3]*w[1])/k,S[1]=(E[7]+E[1]*w[0]+E[4]*w[1])/k,S}function T(S,w,E){return function(k,L,M,P){for(var D=[0,0],N=k.shape[0],U=k.shape[1],G=0;G<N;G++)for(var X=0;X<U;X++)M(D,[G,X],P),k.set(G,X,m(L,D[0],D[1]))}(S,w,x,E),S}function A(S,w){for(var E=!1,k=0;k<S.length;k++)if(w===S[k]){E=!0;break}E===!1&&S.push(w)}i.estimateScale=function(S,w){for(var E=1+function(L){if(L.length!==0){for(var M=1,P=0;P<L.length;P++)M=p(M,L[P]);return M}}(w===0?this.calcXnums(S):this.calcYnums(S));E<v;)E*=2;for(;E>b;)E--,E/=g(E),++E<v&&(E=b);var k=Math.round(E/S);return k>1?k:1},i.refineCoords=function(S){for(var w=this.dataScaleX,E=this.dataScaleY,k=S[0].shape[0],L=S[0].shape[1],M=0|Math.floor(S[0].shape[0]*w+1),P=0|Math.floor(S[0].shape[1]*E+1),D=1+k+1,N=1+L+1,U=d(new Float32Array(D*N),[D,N]),G=[1/w,0,0,0,1/E,0,0,0,1],X=0;X<S.length;++X){this.surface.padField(U,S[X]);var K=d(new Float32Array(M*P),[M,P]);T(K,U,G),S[X]=K}},i.setContourLevels=function(){var S,w,E,k=[[],[],[]],L=[!1,!1,!1],M=!1;for(S=0;S<3;++S)if(this.showContour[S]&&(M=!0,this.contourSize[S]>0&&this.contourStart[S]!==null&&this.contourEnd[S]!==null&&this.contourEnd[S]>this.contourStart[S]))for(L[S]=!0,w=this.contourStart[S];w<this.contourEnd[S];w+=this.contourSize[S])E=w*this.scene.dataScale[S],A(k[S],E);if(M){var P=[[],[],[]];for(S=0;S<3;++S)this.showContour[S]&&(P[S]=L[S]?k[S]:this.scene.contourLevels[S]);this.surface.update({levels:P})}},i.update=function(S){var w,E,k,L,M=this.scene,P=M.fullSceneLayout,D=this.surface,N=l(S),U=M.dataScale,G=S.z[0].length,X=S._ylength,K=M.contourLevels;this.data=S;var Z=[];for(w=0;w<3;w++)for(Z[w]=[],E=0;E<G;E++)Z[w][E]=[];for(E=0;E<G;E++)for(k=0;k<X;k++)Z[0][E][k]=this.getXat(E,k,S.xcalendar,P.xaxis),Z[1][E][k]=this.getYat(E,k,S.ycalendar,P.yaxis),Z[2][E][k]=this.getZat(E,k,S.zcalendar,P.zaxis);if(S.connectgaps)for(S._emptypoints=e(Z[2]),h(Z[2],S._emptypoints),S._interpolatedZ=[],E=0;E<G;E++)for(S._interpolatedZ[E]=[],k=0;k<X;k++)S._interpolatedZ[E][k]=Z[2][E][k];for(w=0;w<3;w++)for(E=0;E<G;E++)for(k=0;k<X;k++)(L=Z[w][E][k])==null?Z[w][E][k]=NaN:L=Z[w][E][k]*=U[w];for(w=0;w<3;w++)for(E=0;E<G;E++)for(k=0;k<X;k++)(L=Z[w][E][k])!=null&&(this.minValues[w]>L&&(this.minValues[w]=L),this.maxValues[w]<L&&(this.maxValues[w]=L));for(w=0;w<3;w++)this.objectOffset[w]=.5*(this.minValues[w]+this.maxValues[w]);for(w=0;w<3;w++)for(E=0;E<G;E++)for(k=0;k<X;k++)(L=Z[w][E][k])!=null&&(Z[w][E][k]-=this.objectOffset[w]);var H=[d(new Float32Array(G*X),[G,X]),d(new Float32Array(G*X),[G,X]),d(new Float32Array(G*X),[G,X])];for(w=0;w<3;w++)for(E=0;E<G;E++)for(k=0;k<X;k++)H[w].set(E,k,Z[w][E][k]);Z=[];var Y={colormap:N,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!S.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:S.opacityscale,opacity:S.opacity},$=u(S);if(Y.intensityBounds=[$.min,$.max],S.surfacecolor){var z=d(new Float32Array(G*X),[G,X]);for(E=0;E<G;E++)for(k=0;k<X;k++)z.set(E,k,S.surfacecolor[k][E]);H.push(z)}else Y.intensityBounds[0]*=U[2],Y.intensityBounds[1]*=U[2];(b<H[0].shape[0]||b<H[0].shape[1])&&(this.refineData=!1),this.refineData===!0&&(this.dataScaleX=this.estimateScale(H[0].shape[0],0),this.dataScaleY=this.estimateScale(H[0].shape[1],1),this.dataScaleX===1&&this.dataScaleY===1||this.refineCoords(H)),S.surfacecolor&&(Y.intensity=H.pop());var j=[!0,!0,!0],W=["x","y","z"];for(w=0;w<3;++w){var ee=S.contours[W[w]];j[w]=ee.highlight,Y.showContour[w]=ee.show||ee.highlight,Y.showContour[w]&&(Y.contourProject[w]=[ee.project.x,ee.project.y,ee.project.z],ee.show?(this.showContour[w]=!0,Y.levels[w]=K[w],D.highlightColor[w]=Y.contourColor[w]=o(ee.color),ee.usecolormap?D.highlightTint[w]=Y.contourTint[w]=0:D.highlightTint[w]=Y.contourTint[w]=1,Y.contourWidth[w]=ee.width,this.contourStart[w]=ee.start,this.contourEnd[w]=ee.end,this.contourSize[w]=ee.size):(this.showContour[w]=!1,this.contourStart[w]=null,this.contourEnd[w]=null,this.contourSize[w]=0),ee.highlight&&(Y.dynamicColor[w]=o(ee.highlightcolor),Y.dynamicWidth[w]=ee.highlightwidth))}(function(J){var Q=J[0].rgb,te=J[J.length-1].rgb;return Q[0]===te[0]&&Q[1]===te[1]&&Q[2]===te[2]&&Q[3]===te[3]})(N)&&(Y.vertexColor=!0),Y.objectOffset=this.objectOffset,Y.coords=H,D.update(Y),D.visible=S.visible,D.enableDynamic=j,D.enableHighlight=j,D.snapToData=!0,"lighting"in S&&(D.ambientLight=S.lighting.ambient,D.diffuseLight=S.lighting.diffuse,D.specularLight=S.lighting.specular,D.roughness=S.lighting.roughness,D.fresnel=S.lighting.fresnel),"lightposition"in S&&(D.lightPosition=[S.lightposition.x,S.lightposition.y,S.lightposition.z])},i.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},I.exports=function(S,w){var E=S.glplot.gl,k=t({gl:E}),L=new s(S,k,w.uid);return k._trace=L,L.update(w),S.glplot.add(k),L}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../heatmap/find_empties":1075,"../heatmap/interp2d":1078,"gl-surface3d":346,ndarray:472,"ndarray-linear-interpolate":466}],1329:[function(r,I,B){var t=r("../../registry"),d=r("../../lib"),m=r("../../components/colorscale/defaults"),h=r("./attributes");function e(l,o,u,s){var i=s("opacityscale");i==="max"?o.opacityscale=[[0,.1],[1,1]]:i==="min"?o.opacityscale=[[0,1],[1,.1]]:i==="extremes"?o.opacityscale=function(c,n){for(var a=[],g=0;g<32;g++){var p=g/31,y=n+(1-n)*(1-Math.pow(Math.sin(c*p*Math.PI),2));a.push([p,Math.max(0,Math.min(1,y))])}return a}(1,.1):function(c){var n=0;if(!Array.isArray(c)||c.length<2||!c[0]||!c[c.length-1]||+c[0][0]!=0||+c[c.length-1][0]!=1)return!1;for(var a=0;a<c.length;a++){var g=c[a];if(g.length!==2||+g[0]<n)return!1;n=+g[0]}return!0}(i)||(o.opacityscale=void 0)}function f(l,o,u){o in l&&!(u in l)&&(l[u]=l[o])}I.exports={supplyDefaults:function(l,o,u,s){var i,c;function n(A,S){return d.coerce(l,o,h,A,S)}var a=n("x"),g=n("y"),p=n("z");if(!p||!p.length||a&&a.length<1||g&&g.length<1)o.visible=!1;else{o._xlength=Array.isArray(a)&&d.isArrayOrTypedArray(a[0])?p.length:p[0].length,o._ylength=p.length,t.getComponentMethod("calendars","handleTraceDefaults")(l,o,["x","y","z"],s),n("text"),n("hovertext"),n("hovertemplate"),n("xhoverformat"),n("yhoverformat"),n("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(A){n(A)});var y=n("surfacecolor"),v=["x","y","z"];for(i=0;i<3;++i){var b="contours."+v[i],x=n(b+".show"),T=n(b+".highlight");if(x||T)for(c=0;c<3;++c)n(b+".project."+v[c]);x&&(n(b+".color"),n(b+".width"),n(b+".usecolormap")),T&&(n(b+".highlightcolor"),n(b+".highlightwidth")),n(b+".start"),n(b+".end"),n(b+".size")}y||(f(l,"zmin","cmin"),f(l,"zmax","cmax"),f(l,"zauto","cauto")),m(l,o,s,n,{prefix:"",cLetter:"c"}),e(l,o,s,n),o._length=null}},opacityscaleDefaults:e}},{"../../components/colorscale/defaults":660,"../../lib":787,"../../registry":915,"./attributes":1326}],1330:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:r("./calc"),plot:r("./convert"),moduleType:"trace",name:"surface",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":880,"./attributes":1326,"./calc":1327,"./convert":1328,"./defaults":1329}],1331:[function(r,I,B){var t=r("../../components/annotations/attributes"),d=r("../../lib/extend").extendFlat,m=r("../../plot_api/edit_types").overrideAll,h=r("../../plots/font_attributes"),e=r("../../plots/domain").attributes,f=r("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers;(I.exports=m({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:f("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:d({},t.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:d({},h({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:f("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:d({},t.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:d({},h({arrayOk:!0}))}},"calc","from-root")).transforms=void 0},{"../../components/annotations/attributes":633,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/cartesian/axis_format_attributes":841,"../../plots/domain":866,"../../plots/font_attributes":867}],1332:[function(r,I,B){var t=r("../../plots/get_data").getModuleCalcData,d=r("./plot");B.name="table",B.plot=function(m){var h=t(m.calcdata,"table")[0];h.length&&d(m,h)},B.clean=function(m,h,e,f){var l=f._has&&f._has("table"),o=h._has&&h._has("table");l&&!o&&f._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":875,"./plot":1339}],1333:[function(r,I,B){var t=r("../../lib/gup").wrap;I.exports=function(){return t({})}},{"../../lib/gup":784}],1334:[function(r,I,B){I.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1335:[function(r,I,B){var t=r("./constants"),d=r("../../lib/extend").extendFlat,m=r("fast-isnumeric");function h(i){if(Array.isArray(i)){for(var c=0,n=0;n<i.length;n++)c=Math.max(c,h(i[n]));return c}return i}function e(i,c){return i+c}function f(i){var c,n=i.slice(),a=1/0,g=0;for(c=0;c<n.length;c++)Array.isArray(n[c])||(n[c]=[n[c]]),a=Math.min(a,n[c].length),g=Math.max(g,n[c].length);if(a!==g)for(c=0;c<n.length;c++){var p=g-n[c].length;p&&(n[c]=n[c].concat(l(p)))}return n}function l(i){for(var c=new Array(i),n=0;n<i;n++)c[n]="";return c}function o(i){return i.calcdata.columns.reduce(function(c,n){return n.xIndex<i.xIndex?c+n.columnWidth:c},0)}function u(i,c){return Object.keys(i).map(function(n){return d({},i[n],{auxiliaryBlocks:c})})}function s(i,c){for(var n,a={},g=0,p=0,y={firstRowIndex:null,lastRowIndex:null,rows:[]},v=0,b=0,x=0;x<i.length;x++)n=i[x],y.rows.push({rowIndex:x,rowHeight:n}),((p+=n)>=c||x===i.length-1)&&(a[g]=y,y.key=b++,y.firstRowIndex=v,y.lastRowIndex=x,y={firstRowIndex:null,lastRowIndex:null,rows:[]},g+=p,v=x+1,p=0);return a}I.exports=function(i,c){var n=f(c.cells.values),a=function(U){return U.slice(c.header.values.length,U.length)},g=f(c.header.values);g.length&&!g[0].length&&(g[0]=[""],g=f(g));var p=g.concat(a(n).map(function(){return l((g[0]||[""]).length)})),y=c.domain,v=Math.floor(i._fullLayout._size.w*(y.x[1]-y.x[0])),b=Math.floor(i._fullLayout._size.h*(y.y[1]-y.y[0])),x=c.header.values.length?p[0].map(function(){return c.header.height}):[t.emptyHeaderHeight],T=n.length?n[0].map(function(){return c.cells.height}):[],A=x.reduce(e,0),S=s(T,b-A+t.uplift),w=u(s(x,A),[]),E=u(S,w),k={},L=c._fullInput.columnorder.concat(a(n.map(function(U,G){return G}))),M=p.map(function(U,G){var X=Array.isArray(c.columnwidth)?c.columnwidth[Math.min(G,c.columnwidth.length-1)]:c.columnwidth;return m(X)?Number(X):1}),P=M.reduce(e,0);M=M.map(function(U){return U/P*v});var D=Math.max(h(c.header.line.width),h(c.cells.line.width)),N={key:c.uid+i._context.staticPlot,translateX:y.x[0]*i._fullLayout._size.w,translateY:i._fullLayout._size.h*(1-y.y[1]),size:i._fullLayout._size,width:v,maxLineWidth:D,height:b,columnOrder:L,groupHeight:b,rowBlocks:E,headerRowBlocks:w,scrollY:0,cells:d({},c.cells,{values:n}),headerCells:d({},c.header,{values:p}),gdColumns:p.map(function(U){return U[0]}),gdColumnsOriginalOrder:p.map(function(U){return U[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:p.map(function(U,G){var X=k[U];return k[U]=(X||0)+1,{key:U+"__"+k[U],label:U,specIndex:G,xIndex:L[G],xScale:o,x:void 0,calcdata:void 0,columnWidth:M[G]}})};return N.columns.forEach(function(U){U.calcdata=N,U.x=o(U)}),N}},{"../../lib/extend":777,"./constants":1334,"fast-isnumeric":246}],1336:[function(r,I,B){var t=r("../../lib/extend").extendFlat;B.splitToPanels=function(d){var m=[0,0],h=t({},d,{key:"header",type:"header",page:0,prevPages:m,currentRepaint:[null,null],dragHandle:!0,values:d.calcdata.headerCells.values[d.specIndex],rowBlocks:d.calcdata.headerRowBlocks,calcdata:t({},d.calcdata,{cells:d.calcdata.headerCells})});return[t({},d,{key:"cells1",type:"cells",page:0,prevPages:m,currentRepaint:[null,null],dragHandle:!1,values:d.calcdata.cells.values[d.specIndex],rowBlocks:d.calcdata.rowBlocks}),t({},d,{key:"cells2",type:"cells",page:1,prevPages:m,currentRepaint:[null,null],dragHandle:!1,values:d.calcdata.cells.values[d.specIndex],rowBlocks:d.calcdata.rowBlocks}),h]},B.splitToCells=function(d){var m=function(h){var e=h.rowBlocks[h.page],f=e?e.rows[0].rowIndex:0,l=e?f+e.rows.length:0;return[f,l]}(d);return(d.values||[]).slice(m[0],m[1]).map(function(h,e){return{keyWithinBlock:e+(typeof h=="string"&&h.match(/[<$&> ]/)?"_keybuster_"+Math.random():""),key:m[0]+e,column:d,calcdata:d.calcdata,page:d.page,rowBlocks:d.rowBlocks,value:h}})}},{"../../lib/extend":777}],1337:[function(r,I,B){var t=r("../../lib"),d=r("./attributes"),m=r("../../plots/domain").defaults;I.exports=function(h,e,f,l){function o(u,s){return t.coerce(h,e,d,u,s)}m(e,l,o),o("columnwidth"),o("header.values"),o("header.format"),o("header.align"),o("header.prefix"),o("header.suffix"),o("header.height"),o("header.line.width"),o("header.line.color"),o("header.fill.color"),t.coerceFont(o,"header.font",t.extendFlat({},l.font)),function(u,s){for(var i=u.columnorder||[],c=u.header.values.length,n=i.slice(0,c),a=n.slice().sort(function(y,v){return y-v}),g=n.map(function(y){return a.indexOf(y)}),p=g.length;p<c;p++)g.push(p);s("columnorder",g)}(e,o),o("cells.values"),o("cells.format"),o("cells.align"),o("cells.prefix"),o("cells.suffix"),o("cells.height"),o("cells.line.width"),o("cells.line.color"),o("cells.fill.color"),t.coerceFont(o,"cells.font",t.extendFlat({},l.font)),e._length=null}},{"../../lib":787,"../../plots/domain":866,"./attributes":1331}],1338:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),moduleType:"trace",name:"table",basePlotModule:r("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1331,"./base_plot":1332,"./calc":1333,"./defaults":1337,"./plot":1339}],1339:[function(r,I,B){var t=r("./constants"),d=r("@plotly/d3"),m=r("../../lib").numberFormat,h=r("../../lib/gup"),e=r("../../components/drawing"),f=r("../../lib/svg_text_utils"),l=r("../../lib").raiseToTop,o=r("../../lib").strTranslate,u=r("../../lib").cancelTransition,s=r("./data_preparation_helper"),i=r("./data_split_helpers"),c=r("../../components/color");function n(H){return Math.ceil(H.calcdata.maxLineWidth/2)}function a(H,Y){return"clip"+H._fullLayout._uid+"_scrollAreaBottomClip_"+Y.key}function g(H,Y){return"clip"+H._fullLayout._uid+"_columnBoundaryClippath_"+Y.calcdata.key+"_"+Y.specIndex}function p(H){return[].concat.apply([],H.map(function(Y){return Y})).map(function(Y){return Y.__data__})}function y(H,Y,$){var z=H.selectAll("."+t.cn.scrollbarKit).data(h.repeat,h.keyFun);z.enter().append("g").classed(t.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),z.each(function(Q){var te=Q.scrollbarState;te.totalHeight=function(ie){var ae=ie.rowBlocks;return G(ae,ae.length-1)+(ae.length?X(ae[ae.length-1],1/0):1)}(Q),te.scrollableAreaHeight=Q.groupHeight-E(Q),te.currentlyVisibleHeight=Math.min(te.totalHeight,te.scrollableAreaHeight),te.ratio=te.currentlyVisibleHeight/te.totalHeight,te.barLength=Math.max(te.ratio*te.currentlyVisibleHeight,t.goldenRatio*t.scrollbarWidth),te.barWiggleRoom=te.currentlyVisibleHeight-te.barLength,te.wiggleRoom=Math.max(0,te.totalHeight-te.scrollableAreaHeight),te.topY=te.barWiggleRoom===0?0:Q.scrollY/te.wiggleRoom*te.barWiggleRoom,te.bottomY=te.topY+te.barLength,te.dragMultiplier=te.wiggleRoom/te.barWiggleRoom}).attr("transform",function(Q){var te=Q.width+t.scrollbarWidth/2+t.scrollbarOffset;return o(te,E(Q))});var j=z.selectAll("."+t.cn.scrollbar).data(h.repeat,h.keyFun);j.enter().append("g").classed(t.cn.scrollbar,!0);var W=j.selectAll("."+t.cn.scrollbarSlider).data(h.repeat,h.keyFun);W.enter().append("g").classed(t.cn.scrollbarSlider,!0),W.attr("transform",function(Q){return o(0,Q.scrollbarState.topY||0)});var ee=W.selectAll("."+t.cn.scrollbarGlyph).data(h.repeat,h.keyFun);ee.enter().append("line").classed(t.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",t.scrollbarWidth).attr("stroke-linecap","round").attr("y1",t.scrollbarWidth/2),ee.attr("y2",function(Q){return Q.scrollbarState.barLength-t.scrollbarWidth/2}).attr("stroke-opacity",function(Q){return Q.columnDragInProgress||!Q.scrollbarState.barWiggleRoom||$?0:.4}),ee.transition().delay(0).duration(0),ee.transition().delay(t.scrollbarHideDelay).duration(t.scrollbarHideDuration).attr("stroke-opacity",0);var J=j.selectAll("."+t.cn.scrollbarCaptureZone).data(h.repeat,h.keyFun);J.enter().append("line").classed(t.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",t.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(Q){var te=d.event.y,ie=this.getBoundingClientRect(),ae=Q.scrollbarState,he=te-ie.top,se=d.scale.linear().domain([0,ae.scrollableAreaHeight]).range([0,ae.totalHeight]).clamp(!0);ae.topY<=he&&he<=ae.bottomY||L(Y,H,null,se(he-ae.barLength/2))(Q)}).call(d.behavior.drag().origin(function(Q){return d.event.stopPropagation(),Q.scrollbarState.scrollbarScrollInProgress=!0,Q}).on("drag",L(Y,H)).on("dragend",function(){})),J.attr("y2",function(Q){return Q.scrollbarState.scrollableAreaHeight}),Y._context.staticPlot&&(ee.remove(),J.remove())}function v(H,Y,$,z){var j=function(ee){var J=ee.selectAll("."+t.cn.columnCell).data(i.splitToCells,function(Q){return Q.keyWithinBlock});return J.enter().append("g").classed(t.cn.columnCell,!0),J.exit().remove(),J}(function(ee){var J=ee.selectAll("."+t.cn.columnCells).data(h.repeat,h.keyFun);return J.enter().append("g").classed(t.cn.columnCells,!0),J.exit().remove(),J}($));(function(ee){ee.each(function(J,Q){var te=J.calcdata.cells.font,ie=J.column.specIndex,ae={size:T(te.size,ie,Q),color:T(te.color,ie,Q),family:T(te.family,ie,Q)};J.rowNumber=J.key,J.align=T(J.calcdata.cells.align,ie,Q),J.cellBorderWidth=T(J.calcdata.cells.line.width,ie,Q),J.font=ae})})(j),function(ee){ee.attr("width",function(J){return J.column.columnWidth}).attr("stroke-width",function(J){return J.cellBorderWidth}).each(function(J){var Q=d.select(this);c.stroke(Q,T(J.calcdata.cells.line.color,J.column.specIndex,J.rowNumber)),c.fill(Q,T(J.calcdata.cells.fill.color,J.column.specIndex,J.rowNumber))})}(function(ee){var J=ee.selectAll("."+t.cn.cellRect).data(h.repeat,function(Q){return Q.keyWithinBlock});return J.enter().append("rect").classed(t.cn.cellRect,!0),J}(j));var W=function(ee){var J=ee.selectAll("."+t.cn.cellText).data(h.repeat,function(Q){return Q.keyWithinBlock});return J.enter().append("text").classed(t.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){d.event.stopPropagation()}),J}(function(ee){var J=ee.selectAll("."+t.cn.cellTextHolder).data(h.repeat,function(Q){return Q.keyWithinBlock});return J.enter().append("g").classed(t.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),J}(j));(function(ee){ee.each(function(J){e.font(d.select(this),J.font)})})(W),b(W,Y,z,H),U(j)}function b(H,Y,$,z){H.text(function(j){var W=j.column.specIndex,ee=j.rowNumber,J=j.value,Q=typeof J=="string",te=Q&&J.match(/<br>/i),ie=!Q||te;j.mayHaveMarkup=Q&&J.match(/[<&>]/);var ae,he=typeof(ae=J)=="string"&&ae.match(t.latexCheck);j.latex=he;var se,de,ue=he?"":T(j.calcdata.cells.prefix,W,ee)||"",ve=he?"":T(j.calcdata.cells.suffix,W,ee)||"",ke=he?null:T(j.calcdata.cells.format,W,ee)||null,Ee=ue+(ke?m(ke)(j.value):j.value)+ve;if(j.wrappingNeeded=!j.wrapped&&!ie&&!he&&(se=x(Ee)),j.cellHeightMayIncrease=te||he||j.mayHaveMarkup||(se===void 0?x(Ee):se),j.needsConvertToTspans=j.mayHaveMarkup||j.wrappingNeeded||j.latex,j.wrappingNeeded){var be=(t.wrapSplitCharacter===" "?Ee.replace(/<a href=/gi,"<a_href="):Ee).split(t.wrapSplitCharacter),xe=t.wrapSplitCharacter===" "?be.map(function(ce){return ce.replace(/<a_href=/gi,"<a href=")}):be;j.fragments=xe.map(function(ce){return{text:ce,width:null}}),j.fragments.push({fragment:t.wrapSpacer,width:null}),de=xe.join(t.lineBreaker)+t.lineBreaker+t.wrapSpacer}else delete j.fragments,de=Ee;return de}).attr("dy",function(j){return j.needsConvertToTspans?0:"0.75em"}).each(function(j){var W=d.select(this),ee=j.wrappingNeeded?P:D;j.needsConvertToTspans?f.convertToTspans(W,z,ee($,this,Y,z,j)):d.select(this.parentNode).attr("transform",function(J){return o(N(J),t.cellPad)}).attr("text-anchor",function(J){return{left:"start",center:"middle",right:"end"}[J.align]})})}function x(H){return H.indexOf(t.wrapSplitCharacter)!==-1}function T(H,Y,$){if(Array.isArray(H)){var z=H[Math.min(Y,H.length-1)];return Array.isArray(z)?z[Math.min($,z.length-1)]:z}return H}function A(H,Y,$){H.transition().ease(t.releaseTransitionEase).duration(t.releaseTransitionDuration).attr("transform",o(Y.x,$))}function S(H){return H.type==="cells"}function w(H){return H.type==="header"}function E(H){return(H.rowBlocks.length?H.rowBlocks[0].auxiliaryBlocks:[]).reduce(function(Y,$){return Y+X($,1/0)},0)}function k(H,Y,$){var z=p(Y)[0];if(z!==void 0){var j=z.rowBlocks,W=z.calcdata,ee=G(j,j.length),J=z.calcdata.groupHeight-E(z),Q=W.scrollY=Math.max(0,Math.min(ee-J,W.scrollY)),te=function(ie,ae,he){for(var se=[],de=0,ue=0;ue<ie.length;ue++){for(var ve=ie[ue],ke=ve.rows,Ee=0,be=0;be<ke.length;be++)Ee+=ke[be].rowHeight;ve.allRowsHeight=Ee,ae<de+Ee&&ae+he>de&&se.push(ue),de+=Ee}return se}(j,Q,J);te.length===1&&(te[0]===j.length-1?te.unshift(te[0]-1):te.push(te[0]+1)),te[0]%2&&te.reverse(),Y.each(function(ie,ae){ie.page=te[ae],ie.scrollY=Q}),Y.attr("transform",function(ie){var ae=G(ie.rowBlocks,ie.page)-ie.scrollY;return o(0,ae)}),H&&(M(H,$,Y,te,z.prevPages,z,0),M(H,$,Y,te,z.prevPages,z,1),y($,H))}}function L(H,Y,$,z){return function(j){var W=j.calcdata?j.calcdata:j,ee=Y.filter(function(ie){return W.key===ie.key}),J=$||W.scrollbarState.dragMultiplier,Q=W.scrollY;W.scrollY=z===void 0?W.scrollY+J*d.event.dy:z;var te=ee.selectAll("."+t.cn.yColumn).selectAll("."+t.cn.columnBlock).filter(S);return k(H,te,ee),W.scrollY===Q}}function M(H,Y,$,z,j,W,ee){z[ee]!==j[ee]&&(clearTimeout(W.currentRepaint[ee]),W.currentRepaint[ee]=setTimeout(function(){var J=$.filter(function(Q,te){return te===ee&&z[te]!==j[te]});v(H,Y,J,$),j[ee]=z[ee]}))}function P(H,Y,$,z){return function(){var j=d.select(Y.parentNode);j.each(function(W){var ee=W.fragments;j.selectAll("tspan.line").each(function(de,ue){ee[ue].width=this.getComputedTextLength()});var J,Q,te=ee[ee.length-1].width,ie=ee.slice(0,-1),ae=[],he=0,se=W.column.columnWidth-2*t.cellPad;for(W.value="";ie.length;)he+(Q=(J=ie.shift()).width+te)>se&&(W.value+=ae.join(t.wrapSpacer)+t.lineBreaker,ae=[],he=0),ae.push(J.text),he+=Q;he&&(W.value+=ae.join(t.wrapSpacer)),W.wrapped=!0}),j.selectAll("tspan.line").remove(),b(j.select("."+t.cn.cellText),$,H,z),d.select(Y.parentNode.parentNode).call(U)}}function D(H,Y,$,z,j){return function(){if(!j.settledY){var W=d.select(Y.parentNode),ee=Z(j),J=j.key-ee.firstRowIndex,Q=ee.rows[J].rowHeight,te=j.cellHeightMayIncrease?Y.parentNode.getBoundingClientRect().height+2*t.cellPad:Q,ie=Math.max(te,Q);ie-ee.rows[J].rowHeight&&(ee.rows[J].rowHeight=ie,H.selectAll("."+t.cn.columnCell).call(U),k(null,H.filter(S),0),y($,z,!0)),W.attr("transform",function(){var ae=this.parentNode.getBoundingClientRect(),he=d.select(this.parentNode).select("."+t.cn.cellRect).node().getBoundingClientRect(),se=this.transform.baseVal.consolidate(),de=he.top-ae.top+(se?se.matrix.f:t.cellPad);return o(N(j,d.select(this.parentNode).select("."+t.cn.cellTextHolder).node().getBoundingClientRect().width),de)}),j.settledY=!0}}}function N(H,Y){switch(H.align){case"left":return t.cellPad;case"right":return H.column.columnWidth-(Y||0)-t.cellPad;case"center":return(H.column.columnWidth-(Y||0))/2;default:return t.cellPad}}function U(H){H.attr("transform",function(Y){var $=Y.rowBlocks[0].auxiliaryBlocks.reduce(function(j,W){return j+X(W,1/0)},0),z=X(Z(Y),Y.key);return o(0,z+$)}).selectAll("."+t.cn.cellRect).attr("height",function(Y){return($=Z(Y),z=Y.key,$.rows[z-$.firstRowIndex]).rowHeight;var $,z})}function G(H,Y){for(var $=0,z=Y-1;z>=0;z--)$+=K(H[z]);return $}function X(H,Y){for(var $=0,z=0;z<H.rows.length&&H.rows[z].rowIndex<Y;z++)$+=H.rows[z].rowHeight;return $}function K(H){var Y=H.allRowsHeight;if(Y!==void 0)return Y;for(var $=0,z=0;z<H.rows.length;z++)$+=H.rows[z].rowHeight;return H.allRowsHeight=$,$}function Z(H){return H.rowBlocks[H.page]}I.exports=function(H,Y){var $=!H._context.staticPlot,z=H._fullLayout._paper.selectAll("."+t.cn.table).data(Y.map(function(ve){var ke=h.unwrap(ve).trace;return s(H,ke)}),h.keyFun);z.exit().remove(),z.enter().append("g").classed(t.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),z.attr("width",function(ve){return ve.width+ve.size.l+ve.size.r}).attr("height",function(ve){return ve.height+ve.size.t+ve.size.b}).attr("transform",function(ve){return o(ve.translateX,ve.translateY)});var j=z.selectAll("."+t.cn.tableControlView).data(h.repeat,h.keyFun),W=j.enter().append("g").classed(t.cn.tableControlView,!0).style("box-sizing","content-box");if($){var ee="onwheel"in document?"wheel":"mousewheel";W.on("mousemove",function(ve){j.filter(function(ke){return ve===ke}).call(y,H)}).on(ee,function(ve){if(!ve.scrollbarState.wheeling){ve.scrollbarState.wheeling=!0;var ke=ve.scrollY+d.event.deltaY;L(H,j,null,ke)(ve)||(d.event.stopPropagation(),d.event.preventDefault()),ve.scrollbarState.wheeling=!1}}).call(y,H,!0)}j.attr("transform",function(ve){return o(ve.size.l,ve.size.t)});var J=j.selectAll("."+t.cn.scrollBackground).data(h.repeat,h.keyFun);J.enter().append("rect").classed(t.cn.scrollBackground,!0).attr("fill","none"),J.attr("width",function(ve){return ve.width}).attr("height",function(ve){return ve.height}),j.each(function(ve){e.setClipUrl(d.select(this),a(H,ve),H)});var Q=j.selectAll("."+t.cn.yColumn).data(function(ve){return ve.columns},h.keyFun);Q.enter().append("g").classed(t.cn.yColumn,!0),Q.exit().remove(),Q.attr("transform",function(ve){return o(ve.x,0)}),$&&Q.call(d.behavior.drag().origin(function(ve){return A(d.select(this),ve,-t.uplift),l(this),ve.calcdata.columnDragInProgress=!0,y(j.filter(function(ke){return ve.calcdata.key===ke.key}),H),ve}).on("drag",function(ve){var ke=d.select(this),Ee=function(be){return(ve===be?d.event.x:be.x)+be.columnWidth/2};ve.x=Math.max(-t.overdrag,Math.min(ve.calcdata.width+t.overdrag-ve.columnWidth,d.event.x)),p(Q).filter(function(be){return be.calcdata.key===ve.calcdata.key}).sort(function(be,xe){return Ee(be)-Ee(xe)}).forEach(function(be,xe){be.xIndex=xe,be.x=ve===be?be.x:be.xScale(be)}),Q.filter(function(be){return ve!==be}).transition().ease(t.transitionEase).duration(t.transitionDuration).attr("transform",function(be){return o(be.x,0)}),ke.call(u).attr("transform",o(ve.x,-t.uplift))}).on("dragend",function(ve){var ke=d.select(this),Ee=ve.calcdata;ve.x=ve.xScale(ve),ve.calcdata.columnDragInProgress=!1,A(ke,ve,0),function(be,xe,ce){var ge=xe.gdColumnsOriginalOrder;xe.gdColumns.sort(function(we,Me){return ce[ge.indexOf(we)]-ce[ge.indexOf(Me)]}),xe.columnorder=ce,be.emit("plotly_restyle")}(H,Ee,Ee.columns.map(function(be){return be.xIndex}))})),Q.each(function(ve){e.setClipUrl(d.select(this),g(H,ve),H)});var te=Q.selectAll("."+t.cn.columnBlock).data(i.splitToPanels,h.keyFun);te.enter().append("g").classed(t.cn.columnBlock,!0).attr("id",function(ve){return ve.key}),te.style("cursor",function(ve){return ve.dragHandle?"ew-resize":ve.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var ie=te.filter(w),ae=te.filter(S);$&&ae.call(d.behavior.drag().origin(function(ve){return d.event.stopPropagation(),ve}).on("drag",L(H,j,-1)).on("dragend",function(){})),v(H,j,ie,te),v(H,j,ae,te);var he=j.selectAll("."+t.cn.scrollAreaClip).data(h.repeat,h.keyFun);he.enter().append("clipPath").classed(t.cn.scrollAreaClip,!0).attr("id",function(ve){return a(H,ve)});var se=he.selectAll("."+t.cn.scrollAreaClipRect).data(h.repeat,h.keyFun);se.enter().append("rect").classed(t.cn.scrollAreaClipRect,!0).attr("x",-t.overdrag).attr("y",-t.uplift).attr("fill","none"),se.attr("width",function(ve){return ve.width+2*t.overdrag}).attr("height",function(ve){return ve.height+t.uplift}),Q.selectAll("."+t.cn.columnBoundary).data(h.repeat,h.keyFun).enter().append("g").classed(t.cn.columnBoundary,!0);var de=Q.selectAll("."+t.cn.columnBoundaryClippath).data(h.repeat,h.keyFun);de.enter().append("clipPath").classed(t.cn.columnBoundaryClippath,!0),de.attr("id",function(ve){return g(H,ve)});var ue=de.selectAll("."+t.cn.columnBoundaryRect).data(h.repeat,h.keyFun);ue.enter().append("rect").classed(t.cn.columnBoundaryRect,!0).attr("fill","none"),ue.attr("width",function(ve){return ve.columnWidth+2*n(ve)}).attr("height",function(ve){return ve.calcdata.height+2*n(ve)+t.uplift}).attr("x",function(ve){return-n(ve)}).attr("y",function(ve){return-n(ve)}),k(null,ae,j)}},{"../../components/color":650,"../../components/drawing":672,"../../lib":787,"../../lib/gup":784,"../../lib/svg_text_utils":813,"./constants":1334,"./data_preparation_helper":1335,"./data_split_helpers":1336,"@plotly/d3":58}],1340:[function(r,I,B){var t=r("../../plots/template_attributes").hovertemplateAttrs,d=r("../../plots/template_attributes").texttemplateAttrs,m=r("../../components/colorscale/attributes"),h=r("../../plots/domain").attributes,e=r("../pie/attributes"),f=r("../sunburst/attributes"),l=r("./constants"),o=r("../../lib/extend").extendFlat;I.exports={labels:f.labels,parents:f.parents,values:f.values,branchvalues:f.branchvalues,count:f.count,level:f.level,maxdepth:f.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:o({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:f.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:f.marker.line,editType:"calc"},m("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:o({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:f.textinfo,texttemplate:d({editType:"plot"},{keys:l.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:f.hoverinfo,hovertemplate:t({},{keys:l.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:o({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:f.root,domain:h({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/domain":866,"../../plots/template_attributes":910,"../pie/attributes":1176,"../sunburst/attributes":1314,"./constants":1343}],1341:[function(r,I,B){var t=r("../../plots/plots");B.name="treemap",B.plot=function(d,m,h,e){t.plotBasePlot(B.name,d,m,h,e)},B.clean=function(d,m,h,e){t.cleanBasePlot(B.name,d,m,h,e)}},{"../../plots/plots":901}],1342:[function(r,I,B){var t=r("../sunburst/calc");B.calc=function(d,m){return t.calc(d,m)},B.crossTraceCalc=function(d){return t._runCrossTraceCalc("treemap",d)}},{"../sunburst/calc":1316}],1343:[function(r,I,B){I.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1344:[function(r,I,B){var t=r("../../lib"),d=r("./attributes"),m=r("../../components/color"),h=r("../../plots/domain").defaults,e=r("../bar/defaults").handleText,f=r("../bar/constants").TEXTPAD,l=r("../../components/colorscale"),o=l.hasColorscale,u=l.handleDefaults;I.exports=function(s,i,c,n){function a(S,w){return t.coerce(s,i,d,S,w)}var g=a("labels"),p=a("parents");if(g&&g.length&&p&&p.length){var y=a("values");y&&y.length?a("branchvalues"):a("count"),a("level"),a("maxdepth"),a("tiling.packing")==="squarify"&&a("tiling.squarifyratio"),a("tiling.flip"),a("tiling.pad");var v=a("text");a("texttemplate"),i.texttemplate||a("textinfo",Array.isArray(v)?"text+label":"label"),a("hovertext"),a("hovertemplate");var b=a("pathbar.visible");e(s,i,n,a,"auto",{hasPathbar:b,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),a("textposition");var x=i.textposition.indexOf("bottom")!==-1;a("marker.line.width")&&a("marker.line.color",n.paper_bgcolor);var T=a("marker.colors");(i._hasColorscale=o(s,"marker","colors")||(s.marker||{}).coloraxis)?u(s,i,n,a,{prefix:"marker.",cLetter:"c"}):a("marker.depthfade",!(T||[]).length);var A=2*i.textfont.size;a("marker.pad.t",x?A/4:A),a("marker.pad.l",A/4),a("marker.pad.r",A/4),a("marker.pad.b",x?A:A/4),i._hovered={marker:{line:{width:2,color:m.contrast(n.paper_bgcolor)}}},b&&(a("pathbar.thickness",i.pathbar.textfont.size+2*f),a("pathbar.side"),a("pathbar.edgeshape")),a("sort"),a("root.color"),h(i,n,a),i._length=null}else i.visible=!1}},{"../../components/color":650,"../../components/colorscale":662,"../../lib":787,"../../plots/domain":866,"../bar/constants":927,"../bar/defaults":929,"./attributes":1340}],1345:[function(r,I,B){var t=r("@plotly/d3"),d=r("../sunburst/helpers"),m=r("../bar/uniform_text").clearMinTextSize,h=r("../bar/style").resizeText,e=r("./plot_one");I.exports=function(f,l,o,u,s){var i,c,n=s.type,a=s.drawDescendants,g=f._fullLayout,p=g["_"+n+"layer"],y=!o;m(n,g),(i=p.selectAll("g.trace."+n).data(l,function(v){return v[0].trace.uid})).enter().append("g").classed("trace",!0).classed(n,!0),i.order(),!g.uniformtext.mode&&d.hasTransition(o)?(u&&(c=u()),t.transition().duration(o.duration).ease(o.easing).each("end",function(){c&&c()}).each("interrupt",function(){c&&c()}).each(function(){p.selectAll("g.trace").each(function(v){e(f,v,this,o,a)})})):(i.each(function(v){e(f,v,this,o,a)}),g.uniformtext.mode&&h(f,p.selectAll(".trace"),n)),y&&i.exit().remove()}},{"../bar/style":939,"../bar/uniform_text":941,"../sunburst/helpers":1320,"./plot_one":1354,"@plotly/d3":58}],1346:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../components/drawing"),h=r("../../lib/svg_text_utils"),e=r("./partition"),f=r("./style").styleOne,l=r("./constants"),o=r("../sunburst/helpers"),u=r("../sunburst/fx");I.exports=function(s,i,c,n,a){var g=a.barDifY,p=a.width,y=a.height,v=a.viewX,b=a.viewY,x=a.pathSlice,T=a.toMoveInsideSlice,A=a.strTransform,S=a.hasTransition,w=a.handleSlicesExit,E=a.makeUpdateSliceInterpolator,k=a.makeUpdateTextInterpolator,L={},M=s._fullLayout,P=i[0],D=P.trace,N=P.hierarchy,U=p/D._entryDepth,G=o.listPath(c.data,"id"),X=e(N.copy(),[p,y],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();(X=X.filter(function(Z){var H=G.indexOf(Z.data.id);return H!==-1&&(Z.x0=U*H,Z.x1=U*(H+1),Z.y0=g,Z.y1=g+y,Z.onPathbar=!0,!0)})).reverse(),(n=n.data(X,o.getPtId)).enter().append("g").classed("pathbar",!0),w(n,!0,L,[p,y],x),n.order();var K=n;S&&(K=K.transition().each("end",function(){var Z=t.select(this);o.setSliceCursor(Z,s,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),K.each(function(Z){Z._x0=v(Z.x0),Z._x1=v(Z.x1),Z._y0=b(Z.y0),Z._y1=b(Z.y1),Z._hoverX=v(Z.x1-Math.min(p,y)/2),Z._hoverY=b(Z.y1-y/2);var H=t.select(this),Y=d.ensureSingle(H,"path","surface",function(W){W.style("pointer-events","all")});S?Y.transition().attrTween("d",function(W){var ee=E(W,!0,L,[p,y]);return function(J){return x(ee(J))}}):Y.attr("d",x),H.call(u,c,s,i,{styleOne:f,eventDataKeys:l.eventDataKeys,transitionTime:l.CLICK_TRANSITION_TIME,transitionEasing:l.CLICK_TRANSITION_EASING}).call(o.setSliceCursor,s,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:s._transitioning}),Y.call(f,Z,D,{hovered:!1}),Z._text=(o.getPtLabel(Z)||"").split("<br>").join(" ")||"";var $=d.ensureSingle(H,"g","slicetext"),z=d.ensureSingle($,"text","",function(W){W.attr("data-notex",1)}),j=d.ensureUniformFontSize(s,o.determineTextFont(D,Z,M.font,{onPathbar:!0}));z.text(Z._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(m.font,j).call(h.convertToTspans,s),Z.textBB=m.bBox(z.node()),Z.transform=T(Z,{fontSize:j.size,onPathbar:!0}),Z.transform.fontSize=j.size,S?z.transition().attrTween("transform",function(W){var ee=k(W,!0,L,[p,y]);return function(J){return A(ee(J))}}):z.attr("transform",A(Z))})}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../sunburst/fx":1319,"../sunburst/helpers":1320,"./constants":1343,"./partition":1352,"./style":1355,"@plotly/d3":58}],1347:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../components/drawing"),h=r("../../lib/svg_text_utils"),e=r("./partition"),f=r("./style").styleOne,l=r("./constants"),o=r("../sunburst/helpers"),u=r("../sunburst/fx"),s=r("../sunburst/plot").formatSliceLabel;I.exports=function(i,c,n,a,g){var p=g.width,y=g.height,v=g.viewX,b=g.viewY,x=g.pathSlice,T=g.toMoveInsideSlice,A=g.strTransform,S=g.hasTransition,w=g.handleSlicesExit,E=g.makeUpdateSliceInterpolator,k=g.makeUpdateTextInterpolator,L=g.prevEntry,M=i._fullLayout,P=c[0].trace,D=P.textposition.indexOf("left")!==-1,N=P.textposition.indexOf("right")!==-1,U=P.textposition.indexOf("bottom")!==-1,G=!U&&!P.marker.pad.t||U&&!P.marker.pad.b,X=e(n,[p,y],{packing:P.tiling.packing,squarifyratio:P.tiling.squarifyratio,flipX:P.tiling.flip.indexOf("x")>-1,flipY:P.tiling.flip.indexOf("y")>-1,pad:{inner:P.tiling.pad,top:P.marker.pad.t,left:P.marker.pad.l,right:P.marker.pad.r,bottom:P.marker.pad.b}}).descendants(),K=1/0,Z=-1/0;X.forEach(function(j){var W=j.depth;W>=P._maxDepth?(j.x0=j.x1=(j.x0+j.x1)/2,j.y0=j.y1=(j.y0+j.y1)/2):(K=Math.min(K,W),Z=Math.max(Z,W))}),a=a.data(X,o.getPtId),P._maxVisibleLayers=isFinite(Z)?Z-K+1:0,a.enter().append("g").classed("slice",!0),w(a,!1,{},[p,y],x),a.order();var H=null;if(S&&L){var Y=o.getPtId(L);a.each(function(j){H===null&&o.getPtId(j)===Y&&(H={x0:j.x0,x1:j.x1,y0:j.y0,y1:j.y1})})}var $=function(){return H||{x0:0,x1:p,y0:0,y1:y}},z=a;return S&&(z=z.transition().each("end",function(){var j=t.select(this);o.setSliceCursor(j,i,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),z.each(function(j){var W=o.isHeader(j,P);j._x0=v(j.x0),j._x1=v(j.x1),j._y0=b(j.y0),j._y1=b(j.y1),j._hoverX=v(j.x1-P.marker.pad.r),j._hoverY=b(U?j.y1-P.marker.pad.b/2:j.y0+P.marker.pad.t/2);var ee=t.select(this),J=d.ensureSingle(ee,"path","surface",function(ae){ae.style("pointer-events","all")});S?J.transition().attrTween("d",function(ae){var he=E(ae,!1,$(),[p,y]);return function(se){return x(he(se))}}):J.attr("d",x),ee.call(u,n,i,c,{styleOne:f,eventDataKeys:l.eventDataKeys,transitionTime:l.CLICK_TRANSITION_TIME,transitionEasing:l.CLICK_TRANSITION_EASING}).call(o.setSliceCursor,i,{isTransitioning:i._transitioning}),J.call(f,j,P,{hovered:!1}),j.x0===j.x1||j.y0===j.y1?j._text="":j._text=W?G?"":o.getPtLabel(j)||"":s(j,n,P,c,M)||"";var Q=d.ensureSingle(ee,"g","slicetext"),te=d.ensureSingle(Q,"text","",function(ae){ae.attr("data-notex",1)}),ie=d.ensureUniformFontSize(i,o.determineTextFont(P,j,M.font));te.text(j._text||" ").classed("slicetext",!0).attr("text-anchor",N?"end":D||W?"start":"middle").call(m.font,ie).call(h.convertToTspans,i),j.textBB=m.bBox(te.node()),j.transform=T(j,{fontSize:ie.size,isHeader:W}),j.transform.fontSize=ie.size,S?te.transition().attrTween("transform",function(ae){var he=k(ae,!1,$(),[p,y]);return function(se){return A(he(se))}}):te.attr("transform",A(j))}),H}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../sunburst/fx":1319,"../sunburst/helpers":1320,"../sunburst/plot":1324,"./constants":1343,"./partition":1352,"./style":1355,"@plotly/d3":58}],1348:[function(r,I,B){I.exports=function t(d,m,h){var e;h.swapXY&&(e=d.x0,d.x0=d.y0,d.y0=e,e=d.x1,d.x1=d.y1,d.y1=e),h.flipX&&(e=d.x0,d.x0=m[0]-d.x1,d.x1=m[0]-e),h.flipY&&(e=d.y0,d.y0=m[1]-d.y1,d.y1=m[1]-e);var f=d.children;if(f)for(var l=0;l<f.length;l++)t(f[l],m,h)}},{}],1349:[function(r,I,B){I.exports={moduleType:"trace",name:"treemap",basePlotModule:r("./base_plot"),categories:[],animatable:!0,attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot"),style:r("./style").style,colorbar:r("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1220,"./attributes":1340,"./base_plot":1341,"./calc":1342,"./defaults":1344,"./layout_attributes":1350,"./layout_defaults":1351,"./plot":1353,"./style":1355}],1350:[function(r,I,B){I.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1351:[function(r,I,B){var t=r("../../lib"),d=r("./layout_attributes");I.exports=function(m,h){function e(f,l){return t.coerce(m,h,d,f,l)}e("treemapcolorway",h.colorway),e("extendtreemapcolors")}},{"../../lib":787,"./layout_attributes":1350}],1352:[function(r,I,B){var t=r("d3-hierarchy"),d=r("./flip_tree");I.exports=function(m,h,e){var f,l=e.flipX,o=e.flipY,u=e.packing==="dice-slice",s=e.pad[o?"bottom":"top"],i=e.pad[l?"right":"left"],c=e.pad[l?"left":"right"],n=e.pad[o?"top":"bottom"];u&&(f=i,i=s,s=f,f=c,c=n,n=f);var a=t.treemap().tile(function(g,p){switch(g){case"squarify":return t.treemapSquarify.ratio(p);case"binary":return t.treemapBinary;case"dice":return t.treemapDice;case"slice":return t.treemapSlice;default:return t.treemapSliceDice}}(e.packing,e.squarifyratio)).paddingInner(e.pad.inner).paddingLeft(i).paddingRight(c).paddingTop(s).paddingBottom(n).size(u?[h[1],h[0]]:h)(m);return(u||l||o)&&d(a,h,{swapXY:u,flipX:l,flipY:o}),a}},{"./flip_tree":1348,"d3-hierarchy":167}],1353:[function(r,I,B){var t=r("./draw"),d=r("./draw_descendants");I.exports=function(m,h,e,f){return t(m,h,e,f,{type:"treemap",drawDescendants:d})}},{"./draw":1345,"./draw_descendants":1347}],1354:[function(r,I,B){var t=r("@plotly/d3"),d=r("d3-interpolate").interpolate,m=r("../sunburst/helpers"),h=r("../../lib"),e=r("../bar/constants").TEXTPAD,f=r("../bar/plot").toMoveInsideBar,l=r("../bar/uniform_text").recordMinTextSize,o=r("./constants"),u=r("./draw_ancestors");function s(i){return m.isHierarchyRoot(i)?"":m.getPtId(i)}I.exports=function(i,c,n,a,g){var p=i._fullLayout,y=c[0],v=y.trace,b=v.type==="icicle",x=y.hierarchy,T=m.findEntryWithLevel(x,v.level),A=t.select(n),S=A.selectAll("g.pathbar"),w=A.selectAll("g.slice");if(!T)return S.remove(),void w.remove();var E=m.isHierarchyRoot(T),k=!p.uniformtext.mode&&m.hasTransition(a),L=m.getMaxDepth(v),M=p._size,P=v.domain,D=M.w*(P.x[1]-P.x[0]),N=M.h*(P.y[1]-P.y[0]),U=D,G=v.pathbar.thickness,X=v.marker.line.width+o.gapWithPathbar,K=v.pathbar.visible?v.pathbar.side.indexOf("bottom")>-1?N+X:-(G+X):0,Z={x0:U,x1:U,y0:K,y1:K+G},H=function(Se,ze,Fe){var Ye=v.tiling.pad,rt=function(qe){return qe-Ye<=ze.x0},Oe=function(qe){return qe+Ye>=ze.x1},je=function(qe){return qe-Ye<=ze.y0},We=function(qe){return qe+Ye>=ze.y1};return Se.x0===ze.x0&&Se.x1===ze.x1&&Se.y0===ze.y0&&Se.y1===ze.y1?{x0:Se.x0,x1:Se.x1,y0:Se.y0,y1:Se.y1}:{x0:rt(Se.x0-Ye)?0:Oe(Se.x0-Ye)?Fe[0]:Se.x0,x1:rt(Se.x1+Ye)?0:Oe(Se.x1+Ye)?Fe[0]:Se.x1,y0:je(Se.y0-Ye)?0:We(Se.y0-Ye)?Fe[1]:Se.y0,y1:je(Se.y1+Ye)?0:We(Se.y1+Ye)?Fe[1]:Se.y1}},Y=null,$={},z={},j=null,W=function(Se,ze){return ze?$[s(Se)]:z[s(Se)]},ee=function(Se,ze,Fe,Ye){if(ze)return $[s(x)]||Z;var rt=z[v.level]||Fe;return function(Oe){return Oe.data.depth-T.data.depth<L}(Se)?H(Se,rt,Ye):{}};y.hasMultipleRoots&&E&&L++,v._maxDepth=L,v._backgroundColor=p.paper_bgcolor,v._entryDepth=T.data.depth,v._atRootLevel=E;var J=-D/2+M.l+M.w*(P.x[1]+P.x[0])/2,Q=-N/2+M.t+M.h*(1-(P.y[1]+P.y[0])/2),te=function(Se){return J+Se},ie=function(Se){return Q+Se},ae=ie(0),he=te(0),se=function(Se){return he+Se},de=function(Se){return ae+Se};function ue(Se,ze){return Se+","+ze}var ve=se(0),ke=function(Se){Se.x=Math.max(ve,Se.x)},Ee=v.pathbar.edgeshape,be=function(Se,ze){var Fe=Se.x0,Ye=Se.x1,rt=Se.y0,Oe=Se.y1,je=Se.textBB,We=function(_t){return v.textposition.indexOf(_t)!==-1},qe=We("bottom"),et=We("top")||ze.isHeader&&!qe?"start":qe?"end":"middle",st=We("right"),ct=We("left")||ze.onPathbar?-1:st?1:0,Pt=v[b?"tiling":"marker"].pad;if(ze.isHeader){if((Fe+=(b?Pt:Pt.l)-e)>=(Ye-=(b?Pt:Pt.r)-e)){var kt=(Fe+Ye)/2;Fe=kt,Ye=kt}var at;qe?rt<(at=Oe-(b?Pt:Pt.b))&&at<Oe&&(rt=at):rt<(at=rt+(b?Pt:Pt.t))&&at<Oe&&(Oe=at)}var tt=f(Fe,Ye,rt,Oe,je,{isHorizontal:!1,constrained:!0,angle:0,anchor:et,leftToRight:ct});return tt.fontSize=ze.fontSize,tt.targetX=te(tt.targetX),tt.targetY=ie(tt.targetY),isNaN(tt.targetX)||isNaN(tt.targetY)?{}:(Fe!==Ye&&rt!==Oe&&l(v.type,tt,p),{scale:tt.scale,rotate:tt.rotate,textX:tt.textX,textY:tt.textY,anchorX:tt.anchorX,anchorY:tt.anchorY,targetX:tt.targetX,targetY:tt.targetY})},xe=function(Se,ze){for(var Fe,Ye=0,rt=Se;!Fe&&Ye<L;)Ye++,(rt=rt.parent)?Fe=W(rt,ze):Ye=L;return Fe||{}},ce=function(Se,ze,Fe,Ye,rt){var Oe,je=W(Se,ze);if(je)Oe=je;else if(ze)Oe=Z;else if(Y)if(Se.parent){var We=j||Fe;We&&!ze?Oe=H(Se,We,Ye):(Oe={},h.extendFlat(Oe,xe(Se,ze)))}else Oe=h.extendFlat({},Se),b&&(rt.orientation==="h"?rt.flipX?Oe.x0=Se.x1:Oe.x1=0:rt.flipY?Oe.y0=Se.y1:Oe.y1=0);else Oe={};return d(Oe,{x0:Se.x0,x1:Se.x1,y0:Se.y0,y1:Se.y1})},ge=function(Se,ze,Fe,Ye){var rt=W(Se,ze),Oe={},je=ee(Se,ze,Fe,Ye);h.extendFlat(Oe,{transform:be({x0:je.x0,x1:je.x1,y0:je.y0,y1:je.y1,textBB:Se.textBB,_text:Se._text},{isHeader:m.isHeader(Se,v)})}),rt?Oe=rt:Se.parent&&h.extendFlat(Oe,xe(Se,ze));var We=Se.transform;return Se.x0!==Se.x1&&Se.y0!==Se.y1&&l(v.type,We,p),d(Oe,{transform:{scale:We.scale,rotate:We.rotate,textX:We.textX,textY:We.textY,anchorX:We.anchorX,anchorY:We.anchorY,targetX:We.targetX,targetY:We.targetY}})},we=function(Se,ze,Fe,Ye,rt){var Oe=Ye[0],je=Ye[1];k?Se.exit().transition().each(function(){var We=t.select(this);We.select("path.surface").transition().attrTween("d",function(qe){var et=function(st,ct,Pt,kt){var at,tt=W(st,ct);if(ct)at=Z;else{var _t=W(T,ct);at=_t?H(st,_t,kt):{}}return d(tt,at)}(qe,ze,0,[Oe,je]);return function(st){return rt(et(st))}}),We.select("g.slicetext").attr("opacity",0)}).remove():Se.exit().remove()},Me=function(Se){var ze=Se.transform;return Se.x0!==Se.x1&&Se.y0!==Se.y1&&l(v.type,ze,p),h.getTextTransform({textX:ze.textX,textY:ze.textY,anchorX:ze.anchorX,anchorY:ze.anchorY,targetX:ze.targetX,targetY:ze.targetY,scale:ze.scale,rotate:ze.rotate})};k&&(S.each(function(Se){$[s(Se)]={x0:Se.x0,x1:Se.x1,y0:Se.y0,y1:Se.y1},Se.transform&&($[s(Se)].transform={textX:Se.transform.textX,textY:Se.transform.textY,anchorX:Se.transform.anchorX,anchorY:Se.transform.anchorY,targetX:Se.transform.targetX,targetY:Se.transform.targetY,scale:Se.transform.scale,rotate:Se.transform.rotate})}),w.each(function(Se){z[s(Se)]={x0:Se.x0,x1:Se.x1,y0:Se.y0,y1:Se.y1},Se.transform&&(z[s(Se)].transform={textX:Se.transform.textX,textY:Se.transform.textY,anchorX:Se.transform.anchorX,anchorY:Se.transform.anchorY,targetX:Se.transform.targetX,targetY:Se.transform.targetY,scale:Se.transform.scale,rotate:Se.transform.rotate}),!Y&&m.isEntry(Se)&&(Y=Se)})),j=g(i,c,T,w,{width:D,height:N,viewX:te,viewY:ie,pathSlice:function(Se){var ze=te(Se.x0),Fe=te(Se.x1),Ye=ie(Se.y0),rt=ie(Se.y1),Oe=Fe-ze,je=rt-Ye;return!Oe||!je?"":"M"+ue(ze,Ye+0)+"L"+ue(Fe-0,Ye)+"L"+ue(Fe,rt-0)+"L"+ue(ze+0,rt)+"Z"},toMoveInsideSlice:be,prevEntry:Y,makeUpdateSliceInterpolator:ce,makeUpdateTextInterpolator:ge,handleSlicesExit:we,hasTransition:k,strTransform:Me}),v.pathbar.visible?u(i,c,T,S,{barDifY:K,width:U,height:G,viewX:se,viewY:de,pathSlice:function(Se){var ze=se(Math.max(Math.min(Se.x0,Se.x0),0)),Fe=se(Math.min(Math.max(Se.x1,Se.x1),U)),Ye=de(Se.y0),rt=de(Se.y1),Oe=G/2,je={},We={};je.x=ze,We.x=Fe,je.y=We.y=(Ye+rt)/2;var qe={x:ze,y:Ye},et={x:Fe,y:Ye},st={x:Fe,y:rt},ct={x:ze,y:rt};return Ee===">"?(qe.x-=Oe,et.x-=Oe,st.x-=Oe,ct.x-=Oe):Ee==="/"?(st.x-=Oe,ct.x-=Oe,je.x-=Oe/2,We.x-=Oe/2):Ee==="\\"?(qe.x-=Oe,et.x-=Oe,je.x-=Oe/2,We.x-=Oe/2):Ee==="<"&&(je.x-=Oe,We.x-=Oe),ke(qe),ke(ct),ke(je),ke(et),ke(st),ke(We),"M"+ue(qe.x,qe.y)+"L"+ue(et.x,et.y)+"L"+ue(We.x,We.y)+"L"+ue(st.x,st.y)+"L"+ue(ct.x,ct.y)+"L"+ue(je.x,je.y)+"Z"},toMoveInsideSlice:be,makeUpdateSliceInterpolator:ce,makeUpdateTextInterpolator:ge,handleSlicesExit:we,hasTransition:k,strTransform:Me}):S.remove()}},{"../../lib":787,"../bar/constants":927,"../bar/plot":936,"../bar/uniform_text":941,"../sunburst/helpers":1320,"./constants":1343,"./draw_ancestors":1346,"@plotly/d3":58,"d3-interpolate":168}],1355:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/color"),m=r("../../lib"),h=r("../sunburst/helpers"),e=r("../bar/uniform_text").resizeText;function f(l,o,u,s){var i,c,n=(s||{}).hovered,a=o.data.data,g=a.i,p=a.color,y=h.isHierarchyRoot(o),v=1;if(n)i=u._hovered.marker.line.color,c=u._hovered.marker.line.width;else if(y&&p===u.root.color)v=100,i="rgba(0,0,0,0)",c=0;else if(i=m.castOption(u,g,"marker.line.color")||d.defaultLine,c=m.castOption(u,g,"marker.line.width")||0,!u._hasColorscale&&!o.onPathbar){var b=u.marker.depthfade;if(b){var x,T=d.combine(d.addOpacity(u._backgroundColor,.75),p);if(b===!0){var A=h.getMaxDepth(u);x=isFinite(A)?h.isLeaf(o)?0:u._maxVisibleLayers-(o.data.depth-u._entryDepth):o.data.height+1}else x=o.data.depth-u._entryDepth,u._atRootLevel||x++;if(x>0)for(var S=0;S<x;S++){var w=.5*S/x;p=d.combine(d.addOpacity(T,w),p)}}}l.style("stroke-width",c).call(d.fill,p).call(d.stroke,i).style("opacity",v)}I.exports={style:function(l){var o=l._fullLayout._treemaplayer.selectAll(".trace");e(l,o,"treemap"),o.each(function(u){var s=t.select(this),i=u[0].trace;s.style("opacity",i.opacity),s.selectAll("path.surface").each(function(c){t.select(this).call(f,c,i,{hovered:!1})})})},styleOne:f}},{"../../components/color":650,"../../lib":787,"../bar/uniform_text":941,"../sunburst/helpers":1320,"@plotly/d3":58}],1356:[function(r,I,B){var t=r("../box/attributes"),d=r("../../lib/extend").extendFlat,m=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat;I.exports={y:t.y,x:t.x,x0:t.x0,y0:t.y0,xhoverformat:m("x"),yhoverformat:m("y"),name:d({},t.name,{}),orientation:d({},t.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:t.fillcolor,points:d({},t.boxpoints,{}),jitter:d({},t.jitter,{}),pointpos:d({},t.pointpos,{}),width:d({},t.width,{}),marker:t.marker,text:t.text,hovertext:t.hovertext,hovertemplate:t.hovertemplate,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup,selected:t.selected,unselected:t.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../box/attributes":950}],1357:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("../box/calc"),h=r("./helpers"),e=r("../../constants/numerical").BADNUM;function f(o,u,s){var i=u.max-u.min;if(!i)return o.bandwidth?o.bandwidth:0;if(o.bandwidth)return Math.max(o.bandwidth,i/1e4);var c=s.length,n=t.stdev(s,c-1,u.mean);return Math.max(function(a,g,p){return 1.059*Math.min(g,p/1.349)*Math.pow(a,-.2)}(c,n,u.q3-u.q1),i/100)}function l(o,u,s,i){var c,n=o.spanmode,a=o.span||[],g=[u.min,u.max],p=[u.min-2*i,u.max+2*i];function y(b){var x=a[b],T=s.type==="multicategory"?s.r2c(x):s.d2c(x,0,o[u.valLetter+"calendar"]);return T===e?p[b]:T}var v={type:"linear",range:c=n==="soft"?p:n==="hard"?g:[y(0),y(1)]};return d.setConvert(v),v.cleanRange(),c}I.exports=function(o,u){var s=m(o,u);if(s[0].t.empty)return s;for(var i=o._fullLayout,c=d.getFromId(o,u[u.orientation==="h"?"xaxis":"yaxis"]),n=1/0,a=-1/0,g=0,p=0,y=0;y<s.length;y++){var v=s[y],b=v.pts.map(h.extractVal),x=v.bandwidth=f(u,v,b),T=v.span=l(u,v,c,x);if(v.min===v.max&&x===0)T=v.span=[v.min,v.max],v.density=[{v:1,t:T[0]}],v.bandwidth=x,g=Math.max(g,1);else{var A=T[1]-T[0],S=Math.ceil(A/(x/3)),w=A/S;if(!isFinite(w)||!isFinite(S))return t.error("Something went wrong with computing the violin span"),s[0].t.empty=!0,s;var E=h.makeKDE(v,u,b);v.density=new Array(S);for(var k=0,L=T[0];L<T[1]+w/2;k++,L+=w){var M=E(L);v.density[k]={v:M,t:L},g=Math.max(g,M)}}p=Math.max(p,b.length),n=Math.min(n,T[0]),a=Math.max(a,T[1])}var P=d.findExtremes(c,[n,a],{padded:!0});if(u._extremes[c._id]=P,u.width)s[0].t.maxKDE=g;else{var D=i._violinScaleGroupStats,N=u.scalegroup,U=D[N];U?(U.maxKDE=Math.max(U.maxKDE,g),U.maxCount=Math.max(U.maxCount,p)):D[N]={maxKDE:g,maxCount:p}}return s[0].t.labels.kde=t._(o,"kde:"),s}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/axes":838,"../box/calc":951,"./helpers":1360}],1358:[function(r,I,B){var t=r("../box/cross_trace_calc").setPositionOffset,d=["v","h"];I.exports=function(m,h){for(var e=m.calcdata,f=h.xaxis,l=h.yaxis,o=0;o<d.length;o++){for(var u=d[o],s=u==="h"?l:f,i=[],c=0;c<e.length;c++){var n=e[c],a=n[0].t,g=n[0].trace;g.visible!==!0||g.type!=="violin"||a.empty||g.orientation!==u||g.xaxis!==f._id||g.yaxis!==l._id||i.push(c)}t("violin",m,i,s)}}},{"../box/cross_trace_calc":952}],1359:[function(r,I,B){var t=r("../../lib"),d=r("../../components/color"),m=r("../box/defaults"),h=r("./attributes");I.exports=function(e,f,l,o){function u(A,S){return t.coerce(e,f,h,A,S)}function s(A,S){return t.coerce2(e,f,h,A,S)}if(m.handleSampleDefaults(e,f,u,o),f.visible!==!1){u("bandwidth"),u("side"),u("width")||(u("scalegroup",f.name),u("scalemode"));var i,c=u("span");Array.isArray(c)&&(i="manual"),u("spanmode",i);var n=u("line.color",(e.marker||{}).color||l),a=u("line.width"),g=u("fillcolor",d.addOpacity(f.line.color,.5));m.handlePointsDefaults(e,f,u,{prefix:""});var p=s("box.width"),y=s("box.fillcolor",g),v=s("box.line.color",n),b=s("box.line.width",a);u("box.visible",Boolean(p||y||v||b))||(f.box={visible:!1});var x=s("meanline.color",n),T=s("meanline.width",a);u("meanline.visible",Boolean(x||T))||(f.meanline={visible:!1})}}},{"../../components/color":650,"../../lib":787,"../box/defaults":953,"./attributes":1356}],1360:[function(r,I,B){var t=r("../../lib"),d=function(m){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*m*m)};B.makeKDE=function(m,h,e){var f=e.length,l=d,o=m.bandwidth,u=1/(f*o);return function(s){for(var i=0,c=0;c<f;c++)i+=l((s-e[c])/o);return u*i}},B.getPositionOnKdePath=function(m,h,e){var f,l;h.orientation==="h"?(f="y",l="x"):(f="x",l="y");var o=t.findPointOnPath(m.path,e,l,{pathLength:m.pathLength}),u=m.posCenterPx,s=o[f];return[s,h.side==="both"?2*u-s:u]},B.getKdeValue=function(m,h,e){var f=m.pts.map(B.extractVal);return B.makeKDE(m,h,f)(e)/m.posDensityScale},B.extractVal=function(m){return m.v}},{"../../lib":787}],1361:[function(r,I,B){var t=r("../../lib"),d=r("../../plots/cartesian/axes"),m=r("../box/hover"),h=r("./helpers");I.exports=function(e,f,l,o,u){u||(u={});var s,i,c=u.hoverLayer,n=e.cd,a=n[0].trace,g=a.hoveron,p=g.indexOf("violins")!==-1,y=g.indexOf("kde")!==-1,v=[];if(p||y){var b=m.hoverOnBoxes(e,f,l,o);if(y&&b.length>0){var x,T,A,S,w,E=e.xa,k=e.ya;a.orientation==="h"?(w=f,x="y",A=k,T="x",S=E):(w=l,x="x",A=E,T="y",S=k);var L=n[e.index];if(w>=L.span[0]&&w<=L.span[1]){var M=t.extendFlat({},e),P=S.c2p(w,!0),D=h.getKdeValue(L,a,w),N=h.getPositionOnKdePath(L,a,P),U=A._offset,G=A._length;M[x+"0"]=N[0],M[x+"1"]=N[1],M[T+"0"]=M[T+"1"]=P,M[T+"Label"]=T+": "+d.hoverLabelText(S,w,a[T+"hoverformat"])+", "+n[0].t.labels.kde+" "+D.toFixed(3),M.spikeDistance=b[0].spikeDistance;var X=x+"Spike";M[X]=b[0][X],b[0].spikeDistance=void 0,b[0][X]=void 0,M.hovertemplate=!1,v.push(M),(i={stroke:e.color})[x+"1"]=t.constrain(U+N[0],U,U+G),i[x+"2"]=t.constrain(U+N[1],U,U+G),i[T+"1"]=i[T+"2"]=S._offset+P}}p&&(v=v.concat(b))}g.indexOf("points")!==-1&&(s=m.hoverOnPoints(e,f,l));var K=c.selectAll(".violinline-"+a.uid).data(i?[0]:[]);return K.enter().append("line").classed("violinline-"+a.uid,!0).attr("stroke-width",1.5),K.exit().remove(),K.attr(i),o==="closest"?s?[s]:v:(s&&v.push(s),v)}},{"../../lib":787,"../../plots/cartesian/axes":838,"../box/hover":955,"./helpers":1360}],1362:[function(r,I,B){I.exports={attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc"),crossTraceCalc:r("./cross_trace_calc"),plot:r("./plot"),style:r("./style"),styleOnSelect:r("../scatter/style").styleOnSelect,hoverPoints:r("./hover"),selectPoints:r("../box/select"),moduleType:"trace",name:"violin",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"../box/defaults":953,"../box/select":960,"../scatter/style":1226,"./attributes":1356,"./calc":1357,"./cross_trace_calc":1358,"./defaults":1359,"./hover":1361,"./layout_attributes":1363,"./layout_defaults":1364,"./plot":1365,"./style":1366}],1363:[function(r,I,B){var t=r("../box/layout_attributes"),d=r("../../lib").extendFlat;I.exports={violinmode:d({},t.boxmode,{}),violingap:d({},t.boxgap,{}),violingroupgap:d({},t.boxgroupgap,{})}},{"../../lib":787,"../box/layout_attributes":957}],1364:[function(r,I,B){var t=r("../../lib"),d=r("./layout_attributes"),m=r("../box/layout_defaults");I.exports=function(h,e,f){m._supply(h,e,f,function(l,o){return t.coerce(h,e,d,l,o)},"violin")}},{"../../lib":787,"../box/layout_defaults":958,"./layout_attributes":1363}],1365:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../components/drawing"),h=r("../box/plot"),e=r("../scatter/line_points"),f=r("./helpers");I.exports=function(l,o,u,s){var i=l._fullLayout,c=o.xaxis,n=o.yaxis;function a(g){var p=e(g,{xaxis:c,yaxis:n,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return m.smoothopen(p[0],1)}d.makeTraceGroups(s,u,"trace violins").each(function(g){var p=t.select(this),y=g[0],v=y.t,b=y.trace;if(b.visible!==!0||v.empty)p.remove();else{var x=v.bPos,T=v.bdPos,A=o[v.valLetter+"axis"],S=o[v.posLetter+"axis"],w=b.side==="both",E=w||b.side==="positive",k=w||b.side==="negative",L=p.selectAll("path.violin").data(d.identity);L.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),L.exit().remove(),L.each(function(K){var Z,H,Y,$,z,j,W,ee,J=t.select(this),Q=K.density,te=Q.length,ie=S.c2l(K.pos+x,!0),ae=S.l2p(ie);if(b.width)Z=v.maxKDE/T;else{var he=i._violinScaleGroupStats[b.scalegroup];Z=b.scalemode==="count"?he.maxKDE/T*(he.maxCount/K.pts.length):he.maxKDE/T}if(E){for(W=new Array(te),z=0;z<te;z++)(ee=W[z]={})[v.posLetter]=ie+Q[z].v/Z,ee[v.valLetter]=A.c2l(Q[z].t,!0);H=a(W)}if(k){for(W=new Array(te),j=0,z=te-1;j<te;j++,z--)(ee=W[j]={})[v.posLetter]=ie-Q[z].v/Z,ee[v.valLetter]=A.c2l(Q[z].t,!0);Y=a(W)}if(w)$=H+"L"+Y.substr(1)+"Z";else{var se=[ae,A.c2p(Q[0].t)],de=[ae,A.c2p(Q[te-1].t)];b.orientation==="h"&&(se.reverse(),de.reverse()),$=E?"M"+se+"L"+H.substr(1)+"L"+de:"M"+de+"L"+Y.substr(1)+"L"+se}J.attr("d",$),K.posCenterPx=ae,K.posDensityScale=Z*T,K.path=J.node(),K.pathLength=K.path.getTotalLength()/(w?2:1)});var M,P,D,N=b.box,U=N.width,G=(N.line||{}).width;w?(M=T*U,P=0):E?(M=[0,T*U/2],P=G*{x:1,y:-1}[v.posLetter]):(M=[T*U/2,0],P=G*{x:-1,y:1}[v.posLetter]),h.plotBoxAndWhiskers(p,{pos:S,val:A},b,{bPos:x,bdPos:M,bPosPxOffset:P}),h.plotBoxMean(p,{pos:S,val:A},b,{bPos:x,bdPos:M,bPosPxOffset:P}),!b.box.visible&&b.meanline.visible&&(D=d.identity);var X=p.selectAll("path.meanline").data(D||[]);X.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),X.exit().remove(),X.each(function(K){var Z=A.c2p(K.mean,!0),H=f.getPositionOnKdePath(K,b,Z);t.select(this).attr("d",b.orientation==="h"?"M"+Z+","+H[0]+"V"+H[1]:"M"+H[0]+","+Z+"H"+H[1])}),h.plotPoints(p,{x:c,y:n},b,v)}})}},{"../../components/drawing":672,"../../lib":787,"../box/plot":959,"../scatter/line_points":1216,"./helpers":1360,"@plotly/d3":58}],1366:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/color"),m=r("../scatter/style").stylePoints;I.exports=function(h){var e=t.select(h).selectAll("g.trace.violins");e.style("opacity",function(f){return f[0].trace.opacity}),e.each(function(f){var l=f[0].trace,o=t.select(this),u=l.box||{},s=u.line||{},i=l.meanline||{},c=i.width;o.selectAll("path.violin").style("stroke-width",l.line.width+"px").call(d.stroke,l.line.color).call(d.fill,l.fillcolor),o.selectAll("path.box").style("stroke-width",s.width+"px").call(d.stroke,s.color).call(d.fill,u.fillcolor);var n={"stroke-width":c+"px","stroke-dasharray":2*c+"px,"+c+"px"};o.selectAll("path.mean").style(n).call(d.stroke,i.color),o.selectAll("path.meanline").style(n).call(d.stroke,i.color),m(o,l,h)})}},{"../../components/color":650,"../scatter/style":1226,"@plotly/d3":58}],1367:[function(r,I,B){var t=r("../../components/colorscale/attributes"),d=r("../isosurface/attributes"),m=r("../surface/attributes"),h=r("../../plots/attributes"),e=r("../../lib/extend").extendFlat,f=r("../../plot_api/edit_types").overrideAll,l=I.exports=f(e({x:d.x,y:d.y,z:d.z,value:d.value,isomin:d.isomin,isomax:d.isomax,surface:d.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:d.slices,caps:d.caps,text:d.text,hovertext:d.hovertext,xhoverformat:d.xhoverformat,yhoverformat:d.yhoverformat,zhoverformat:d.zhoverformat,valuehoverformat:d.valuehoverformat,hovertemplate:d.hovertemplate},t("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:d.colorbar,opacity:d.opacity,opacityscale:m.opacityscale,lightposition:d.lightposition,lighting:d.lighting,flatshading:d.flatshading,contour:d.contour,hoverinfo:e({},h.hoverinfo),showlegend:e({},h.showlegend,{dflt:!1})}),"calc","nested");l.x.editType=l.y.editType=l.z.editType=l.value.editType="calc+clearAxisTypes",l.transforms=void 0},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../isosurface/attributes":1138,"../surface/attributes":1326}],1368:[function(r,I,B){var t=r("gl-mesh3d"),d=r("../../lib/gl_format_color").parseColorScale,m=r("../../lib/str2rgbarray"),h=r("../../components/colorscale").extractOpts,e=r("../../plots/gl3d/zip3"),f=r("../isosurface/convert").findNearestOnAxis,l=r("../isosurface/convert").generateIsoMeshes;function o(s,i,c){this.scene=s,this.uid=c,this.mesh=i,this.name="",this.data=null,this.showContour=!1}var u=o.prototype;u.handlePick=function(s){if(s.object===this.mesh){var i=s.data.index,c=this.data._meshX[i],n=this.data._meshY[i],a=this.data._meshZ[i],g=this.data._Ys.length,p=this.data._Zs.length,y=f(c,this.data._Xs).id,v=f(n,this.data._Ys).id,b=f(a,this.data._Zs).id,x=s.index=b+p*v+p*g*y;s.traceCoordinate=[this.data._meshX[x],this.data._meshY[x],this.data._meshZ[x],this.data._value[x]];var T=this.data.hovertext||this.data.text;return Array.isArray(T)&&T[x]!==void 0?s.textLabel=T[x]:T&&(s.textLabel=T),!0}},u.update=function(s){var i=this.scene,c=i.fullSceneLayout;function n(p,y,v,b){return y.map(function(x){return p.d2l(x,0,b)*v})}this.data=l(s);var a={positions:e(n(c.xaxis,s._meshX,i.dataScale[0],s.xcalendar),n(c.yaxis,s._meshY,i.dataScale[1],s.ycalendar),n(c.zaxis,s._meshZ,i.dataScale[2],s.zcalendar)),cells:e(s._meshI,s._meshJ,s._meshK),lightPosition:[s.lightposition.x,s.lightposition.y,s.lightposition.z],ambient:s.lighting.ambient,diffuse:s.lighting.diffuse,specular:s.lighting.specular,roughness:s.lighting.roughness,fresnel:s.lighting.fresnel,vertexNormalsEpsilon:s.lighting.vertexnormalsepsilon,faceNormalsEpsilon:s.lighting.facenormalsepsilon,opacity:s.opacity,opacityscale:s.opacityscale,contourEnable:s.contour.show,contourColor:m(s.contour.color).slice(0,3),contourWidth:s.contour.width,useFacetNormals:s.flatshading},g=h(s);a.vertexIntensity=s._meshIntensity,a.vertexIntensityBounds=[g.min,g.max],a.colormap=d(s),this.mesh.update(a)},u.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},I.exports=function(s,i){var c=s.glplot.gl,n=t({gl:c}),a=new o(s,n,i.uid);return n._trace=a,a.update(i),s.glplot.add(n),a}},{"../../components/colorscale":662,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../../plots/gl3d/zip3":891,"../isosurface/convert":1140,"gl-mesh3d":309}],1369:[function(r,I,B){var t=r("../../lib"),d=r("./attributes"),m=r("../isosurface/defaults").supplyIsoDefaults,h=r("../surface/defaults").opacityscaleDefaults;I.exports=function(e,f,l,o){function u(s,i){return t.coerce(e,f,d,s,i)}m(e,f,l,o,u),h(e,f,o,u)}},{"../../lib":787,"../isosurface/defaults":1141,"../surface/defaults":1329,"./attributes":1367}],1370:[function(r,I,B){I.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:r("./convert"),moduleType:"trace",name:"volume",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":880,"../isosurface/calc":1139,"./attributes":1367,"./convert":1368,"./defaults":1369}],1371:[function(r,I,B){var t=r("../bar/attributes"),d=r("../scatter/attributes").line,m=r("../../plots/attributes"),h=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=r("../../plots/template_attributes").hovertemplateAttrs,f=r("../../plots/template_attributes").texttemplateAttrs,l=r("./constants"),o=r("../../lib/extend").extendFlat,u=r("../../components/color");function s(i){return{marker:{color:o({},t.marker.color,{arrayOk:!1,editType:"style"}),line:{color:o({},t.marker.line.color,{arrayOk:!1,editType:"style"}),width:o({},t.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}I.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,xhoverformat:h("x"),yhoverformat:h("y"),hovertext:t.hovertext,hovertemplate:e({},{keys:l.eventDataKeys}),hoverinfo:o({},m.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:f({editType:"plot"},{keys:l.eventDataKeys.concat(["label"])}),text:t.text,textposition:t.textposition,insidetextanchor:t.insidetextanchor,textangle:t.textangle,textfont:t.textfont,insidetextfont:t.insidetextfont,outsidetextfont:t.outsidetextfont,constraintext:t.constraintext,cliponaxis:t.cliponaxis,orientation:t.orientation,offset:t.offset,width:t.width,increasing:s(),decreasing:s(),totals:s(),connector:{line:{color:o({},d.color,{dflt:u.defaultLine}),width:o({},d.width,{editType:"plot"}),dash:d.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup}},{"../../components/color":650,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../bar/attributes":925,"../scatter/attributes":1202,"./constants":1373}],1372:[function(r,I,B){var t=r("../../plots/cartesian/axes"),d=r("../../plots/cartesian/align_period"),m=r("../../lib").mergeArray,h=r("../scatter/calc_selection"),e=r("../../constants/numerical").BADNUM;function f(o){return o==="a"||o==="absolute"}function l(o){return o==="t"||o==="total"}I.exports=function(o,u){var s,i,c,n,a,g,p=t.getFromId(o,u.xaxis||"x"),y=t.getFromId(o,u.yaxis||"y");u.orientation==="h"?(s=p.makeCalcdata(u,"x"),c=y.makeCalcdata(u,"y"),n=d(u,y,"y",c),a=!!u.yperiodalignment,g="y"):(s=y.makeCalcdata(u,"y"),c=p.makeCalcdata(u,"x"),n=d(u,p,"x",c),a=!!u.xperiodalignment,g="x"),i=n.vals;for(var v,b=Math.min(i.length,s.length),x=new Array(b),T=0,A=!1,S=0;S<b;S++){var w=s[S]||0,E=!1;(s[S]!==e||l(u.measure[S])||f(u.measure[S]))&&S+1<b&&(s[S+1]!==e||l(u.measure[S+1])||f(u.measure[S+1]))&&(E=!0);var k=x[S]={i:S,p:i[S],s:w,rawS:w,cNext:E};f(u.measure[S])?(T=k.s,k.isSum=!0,k.dir="totals",k.s=T):l(u.measure[S])?(k.isSum=!0,k.dir="totals",k.s=T):(k.isSum=!1,k.dir=k.rawS<0?"decreasing":"increasing",v=k.s,k.s=T+v,T+=v),k.dir==="totals"&&(A=!0),a&&(x[S].orig_p=c[S],x[S][g+"End"]=n.ends[S],x[S][g+"Start"]=n.starts[S]),u.ids&&(k.id=String(u.ids[S])),k.v=(u.base||0)+T}return x.length&&(x[0].hasTotals=A),m(u.text,x,"tx"),m(u.hovertext,x,"htx"),h(x,u),x}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../scatter/calc_selection":1204}],1373:[function(r,I,B){I.exports={eventDataKeys:["initial","delta","final"]}},{}],1374:[function(r,I,B){var t=r("../bar/cross_trace_calc").setGroupPositions;I.exports=function(d,m){var h,e,f=d._fullLayout,l=d._fullData,o=d.calcdata,u=m.xaxis,s=m.yaxis,i=[],c=[],n=[];for(e=0;e<l.length;e++){var a=l[e];a.visible===!0&&a.xaxis===u._id&&a.yaxis===s._id&&a.type==="waterfall"&&(h=o[e],a.orientation==="h"?n.push(h):c.push(h),i.push(h))}var g={mode:f.waterfallmode,norm:f.waterfallnorm,gap:f.waterfallgap,groupgap:f.waterfallgroupgap};for(t(d,u,s,c,g),t(d,s,u,n,g),e=0;e<i.length;e++){h=i[e];for(var p=0;p<h.length;p++){var y=h[p];y.isSum===!1&&(y.s0+=p===0?0:h[p-1].s),p+1<h.length&&(h[p].nextP0=h[p+1].p0,h[p].nextS0=h[p+1].s0)}}}},{"../bar/cross_trace_calc":928}],1375:[function(r,I,B){var t=r("../../lib"),d=r("../bar/defaults").handleGroupingDefaults,m=r("../bar/defaults").handleText,h=r("../scatter/xy_defaults"),e=r("../scatter/period_defaults"),f=r("./attributes"),l=r("../../components/color"),o=r("../../constants/delta.js"),u=o.INCREASING.COLOR,s=o.DECREASING.COLOR;function i(c,n,a){c(n+".marker.color",a),c(n+".marker.line.color",l.defaultLine),c(n+".marker.line.width")}I.exports={supplyDefaults:function(c,n,a,g){function p(v,b){return t.coerce(c,n,f,v,b)}if(h(c,n,g,p)){e(c,n,g,p),p("xhoverformat"),p("yhoverformat"),p("measure"),p("orientation",n.x&&!n.y?"h":"v"),p("base"),p("offset"),p("width"),p("text"),p("hovertext"),p("hovertemplate");var y=p("textposition");m(c,n,g,p,y,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),n.textposition!=="none"&&(p("texttemplate"),n.texttemplate||p("textinfo")),i(p,"increasing",u),i(p,"decreasing",s),i(p,"totals","#4499FF"),p("connector.visible")&&(p("connector.mode"),p("connector.line.width")&&(p("connector.line.color"),p("connector.line.dash")))}else n.visible=!1},crossTraceDefaults:function(c,n){var a,g;function p(v){return t.coerce(g._input,g,f,v)}if(n.waterfallmode==="group")for(var y=0;y<c.length;y++)a=(g=c[y])._input,d(a,g,n,p)}}},{"../../components/color":650,"../../constants/delta.js":757,"../../lib":787,"../bar/defaults":929,"../scatter/period_defaults":1222,"../scatter/xy_defaults":1229,"./attributes":1371}],1376:[function(r,I,B){I.exports=function(t,d){return t.x="xVal"in d?d.xVal:d.x,t.y="yVal"in d?d.yVal:d.y,"initial"in d&&(t.initial=d.initial),"delta"in d&&(t.delta=d.delta),"final"in d&&(t.final=d.final),d.xa&&(t.xaxis=d.xa),d.ya&&(t.yaxis=d.ya),t}},{}],1377:[function(r,I,B){var t=r("../../plots/cartesian/axes").hoverLabelText,d=r("../../components/color").opacity,m=r("../bar/hover").hoverOnBars,h=r("../../constants/delta.js"),e=h.INCREASING.SYMBOL,f=h.DECREASING.SYMBOL;I.exports=function(l,o,u,s,i){var c=m(l,o,u,s,i);if(c){var n=c.cd,a=n[0].trace,g=a.orientation==="h",p=g?"x":"y",y=g?l.xa:l.ya,v=n[c.index],b=v.isSum?v.b+v.s:v.rawS;if(!v.isSum){c.initial=v.b+v.s-b,c.delta=b,c.final=c.initial+c.delta;var x=k(Math.abs(c.delta));c.deltaLabel=b<0?"("+x+")":x,c.finalLabel=k(c.final),c.initialLabel=k(c.initial)}var T=v.hi||a.hoverinfo,A=[];if(T&&T!=="none"&&T!=="skip"){var S=T==="all",w=T.split("+"),E=function(L){return S||w.indexOf(L)!==-1};v.isSum||(!E("final")||E(g?"x":"y")||A.push(c.finalLabel),E("delta")&&(b<0?A.push(c.deltaLabel+" "+f):A.push(c.deltaLabel+" "+e)),E("initial")&&A.push("Initial: "+c.initialLabel))}return A.length&&(c.extraText=A.join("<br>")),c.color=function(L,M){var P=L[M.dir].marker,D=P.color,N=P.line.color,U=P.line.width;if(d(D))return D;if(d(N)&&U)return N}(a,v),[c]}function k(L){return t(y,L,a[p+"hoverformat"])}}},{"../../components/color":650,"../../constants/delta.js":757,"../../plots/cartesian/axes":838,"../bar/hover":932}],1378:[function(r,I,B){I.exports={attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults").supplyDefaults,crossTraceDefaults:r("./defaults").crossTraceDefaults,supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc"),crossTraceCalc:r("./cross_trace_calc"),plot:r("./plot"),style:r("./style").style,hoverPoints:r("./hover"),eventData:r("./event_data"),selectPoints:r("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:r("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"../bar/select":937,"./attributes":1371,"./calc":1372,"./cross_trace_calc":1374,"./defaults":1375,"./event_data":1376,"./hover":1377,"./layout_attributes":1379,"./layout_defaults":1380,"./plot":1381,"./style":1382}],1379:[function(r,I,B){I.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1380:[function(r,I,B){var t=r("../../lib"),d=r("./layout_attributes");I.exports=function(m,h,e){var f=!1;function l(s,i){return t.coerce(m,h,d,s,i)}for(var o=0;o<e.length;o++){var u=e[o];if(u.visible&&u.type==="waterfall"){f=!0;break}}f&&(l("waterfallmode"),l("waterfallgap",.2),l("waterfallgroupgap"))}},{"../../lib":787,"./layout_attributes":1379}],1381:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../lib"),m=r("../../components/drawing"),h=r("../../constants/numerical").BADNUM,e=r("../bar/plot"),f=r("../bar/uniform_text").clearMinTextSize;I.exports=function(l,o,u,s){var i=l._fullLayout;f("waterfall",i),e.plot(l,o,u,s,{mode:i.waterfallmode,norm:i.waterfallmode,gap:i.waterfallgap,groupgap:i.waterfallgroupgap}),function(c,n,a,g){var p=n.xaxis,y=n.yaxis;d.makeTraceGroups(g,a,"trace bars").each(function(v){var b=t.select(this),x=v[0].trace,T=d.ensureSingle(b,"g","lines");if(x.connector&&x.connector.visible){var A=x.orientation==="h",S=x.connector.mode,w=T.selectAll("g.line").data(d.identity);w.enter().append("g").classed("line",!0),w.exit().remove();var E=w.size();w.each(function(k,L){if(L===E-1||k.cNext){var M=function(U,G,X,K){var Z=[],H=[],Y=K?G:X,$=K?X:G;return Z[0]=Y.c2p(U.s0,!0),H[0]=$.c2p(U.p0,!0),Z[1]=Y.c2p(U.s1,!0),H[1]=$.c2p(U.p1,!0),Z[2]=Y.c2p(U.nextS0,!0),H[2]=$.c2p(U.nextP0,!0),K?[Z,H]:[H,Z]}(k,p,y,A),P=M[0],D=M[1],N="";P[0]!==h&&D[0]!==h&&P[1]!==h&&D[1]!==h&&(S==="spanning"&&!k.isSum&&L>0&&(N+=A?"M"+P[0]+","+D[1]+"V"+D[0]:"M"+P[1]+","+D[0]+"H"+P[0]),S!=="between"&&(k.isSum||L<E-1)&&(N+=A?"M"+P[1]+","+D[0]+"V"+D[1]:"M"+P[0]+","+D[1]+"H"+P[1]),P[2]!==h&&D[2]!==h&&(N+=A?"M"+P[1]+","+D[1]+"V"+D[2]:"M"+P[1]+","+D[1]+"H"+P[2])),N===""&&(N="M0,0Z"),d.ensureSingle(t.select(this),"path").attr("d",N).call(m.setClipUrl,n.layerClipId,c)}})}else T.remove()})}(l,o,u,s)}},{"../../components/drawing":672,"../../constants/numerical":763,"../../lib":787,"../bar/plot":936,"../bar/uniform_text":941,"@plotly/d3":58}],1382:[function(r,I,B){var t=r("@plotly/d3"),d=r("../../components/drawing"),m=r("../../components/color"),h=r("../../constants/interactions").DESELECTDIM,e=r("../bar/style"),f=r("../bar/uniform_text").resizeText,l=e.styleTextPoints;I.exports={style:function(o,u,s){var i=s||t.select(o).selectAll("g.waterfalllayer").selectAll("g.trace");f(o,i,"waterfall"),i.style("opacity",function(c){return c[0].trace.opacity}),i.each(function(c){var n=t.select(this),a=c[0].trace;n.selectAll(".point > path").each(function(g){if(!g.isBlank){var p=a[g.dir].marker;t.select(this).call(m.fill,p.color).call(m.stroke,p.line.color).call(d.dashLine,p.line.dash,p.line.width).style("opacity",a.selectedpoints&&!g.selected?h:1)}}),l(n,a,o),n.selectAll(".lines").each(function(){var g=a.connector.line;d.lineGroupStyle(t.select(this).selectAll("path"),g.width,g.color,g.dash)})})}}},{"../../components/color":650,"../../components/drawing":672,"../../constants/interactions":762,"../bar/style":939,"../bar/uniform_text":941,"@plotly/d3":58}],1383:[function(r,I,B){var t=r("../plots/cartesian/axes"),d=r("../lib"),m=r("../plot_api/plot_schema"),h=r("./helpers").pointsAccessorFunction,e=r("../constants/numerical").BADNUM;B.moduleType="transform",B.name="aggregate";var f=B.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},l=f.aggregations;function o(c,n,a,g){if(g.enabled){for(var p=g.target,y=d.nestedProperty(n,p),v=y.get(),b=function(A,S){var w=A.func,E=S.d2c,k=S.c2d;switch(w){case"count":return u;case"first":return s;case"last":return i;case"sum":return function(L,M){for(var P=0,D=0;D<M.length;D++){var N=E(L[M[D]]);N!==e&&(P+=N)}return k(P)};case"avg":return function(L,M){for(var P=0,D=0,N=0;N<M.length;N++){var U=E(L[M[N]]);U!==e&&(P+=U,D++)}return D?k(P/D):e};case"min":return function(L,M){for(var P=1/0,D=0;D<M.length;D++){var N=E(L[M[D]]);N!==e&&(P=Math.min(P,N))}return P===1/0?e:k(P)};case"max":return function(L,M){for(var P=-1/0,D=0;D<M.length;D++){var N=E(L[M[D]]);N!==e&&(P=Math.max(P,N))}return P===-1/0?e:k(P)};case"range":return function(L,M){for(var P=1/0,D=-1/0,N=0;N<M.length;N++){var U=E(L[M[N]]);U!==e&&(P=Math.min(P,U),D=Math.max(D,U))}return D===-1/0||P===1/0?e:k(D-P)};case"change":return function(L,M){var P=E(L[M[0]]),D=E(L[M[M.length-1]]);return P===e||D===e?e:k(D-P)};case"median":return function(L,M){for(var P=[],D=0;D<M.length;D++){var N=E(L[M[D]]);N!==e&&P.push(N)}if(!P.length)return e;P.sort(d.sorterAsc);var U=(P.length-1)/2;return k((P[Math.floor(U)]+P[Math.ceil(U)])/2)};case"mode":return function(L,M){for(var P={},D=0,N=e,U=0;U<M.length;U++){var G=E(L[M[U]]);if(G!==e){var X=P[G]=(P[G]||0)+1;X>D&&(D=X,N=G)}}return D?k(N):e};case"rms":return function(L,M){for(var P=0,D=0,N=0;N<M.length;N++){var U=E(L[M[N]]);U!==e&&(P+=U*U,D++)}return D?k(Math.sqrt(P/D)):e};case"stddev":return function(L,M){var P,D=0,N=0,U=1,G=e;for(P=0;P<M.length&&G===e;P++)G=E(L[M[P]]);if(G===e)return e;for(;P<M.length;P++){var X=E(L[M[P]]);if(X!==e){var K=X-G;D+=K,N+=K*K,U++}}var Z=A.funcmode==="sample"?U-1:U;return Z?Math.sqrt((N-D*D/U)/Z):0}}}(g,t.getDataConversions(c,n,p,v)),x=new Array(a.length),T=0;T<a.length;T++)x[T]=b(v,a[T]);y.set(x),g.func==="count"&&d.pushUnique(n._arrayAttrs,p)}}function u(c,n){return n.length}function s(c,n){return c[n[0]]}function i(c,n){return c[n[n.length-1]]}B.supplyDefaults=function(c,n){var a,g={};function p(k,L){return d.coerce(c,g,f,k,L)}if(!p("enabled"))return g;var y=m.findArrayAttributes(n),v={};for(a=0;a<y.length;a++)v[y[a]]=1;var b=p("groups");if(!Array.isArray(b)){if(!v[b])return g.enabled=!1,g;v[b]=0}var x,T=c.aggregations||[],A=g.aggregations=new Array(T.length);function S(k,L){return d.coerce(T[a],x,l,k,L)}for(a=0;a<T.length;a++){x={_index:a};var w=S("target"),E=S("func");S("enabled")&&w&&(v[w]||E==="count"&&v[w]===void 0)?(E==="stddev"&&S("funcmode"),v[w]=0,A[a]=x):A[a]={enabled:!1,_index:a}}for(a=0;a<y.length;a++)v[y[a]]&&A.push({target:y[a],func:l.func.dflt,enabled:!0,_index:-1});return g},B.calcTransform=function(c,n,a){if(a.enabled){var g=a.groups,p=d.getTargetArray(n,{target:g});if(p){var y,v,b,x,T={},A={},S=[],w=h(n.transforms,a),E=p.length;for(n._length&&(E=Math.min(E,n._length)),y=0;y<E;y++)(b=T[v=p[y]])===void 0?(T[v]=S.length,x=[y],S.push(x),A[T[v]]=w(y)):(S[b].push(y),A[T[v]]=(A[T[v]]||[]).concat(w(y)));a._indexToPoints=A;var k=a.aggregations;for(y=0;y<k.length;y++)o(c,n,S,k[y]);typeof g=="string"&&o(c,n,S,{target:g,func:"first",enabled:!0}),n._length=S.length}}}},{"../constants/numerical":763,"../lib":787,"../plot_api/plot_schema":826,"../plots/cartesian/axes":838,"./helpers":1386}],1384:[function(r,I,B){var t=r("../lib"),d=r("../registry"),m=r("../plots/cartesian/axes"),h=r("./helpers").pointsAccessorFunction,e=r("../constants/filter_ops"),f=e.COMPARISON_OPS,l=e.INTERVAL_OPS,o=e.SET_OPS;B.moduleType="transform",B.name="filter",B.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(f).concat(l).concat(o),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},B.supplyDefaults=function(u){var s={};function i(a,g){return t.coerce(u,s,B.attributes,a,g)}if(i("enabled")){var c=i("target");if(t.isArrayOrTypedArray(c)&&c.length===0)return s.enabled=!1,s;i("preservegaps"),i("operation"),i("value");var n=d.getComponentMethod("calendars","handleDefaults");n(u,s,"valuecalendar",null),n(u,s,"targetcalendar",null)}return s},B.calcTransform=function(u,s,i){if(i.enabled){var c=t.getTargetArray(s,i);if(c){var n=i.target,a=c.length;s._length&&(a=Math.min(a,s._length));var g=i.targetcalendar,p=s._arrayAttrs,y=i.preservegaps;if(typeof n=="string"){var v=t.nestedProperty(s,n+"calendar").get();v&&(g=v)}var b,x,T=function(M,P,D){var N=M.operation,U=M.value,G=Array.isArray(U);function X(Y){return Y.indexOf(N)!==-1}var K,Z=function(Y){return P(Y,0,M.valuecalendar)},H=function(Y){return P(Y,0,D)};switch(X(f)?K=Z(G?U[0]:U):X(l)?K=G?[Z(U[0]),Z(U[1])]:[Z(U),Z(U)]:X(o)&&(K=G?U.map(Z):[Z(U)]),N){case"=":return function(Y){return H(Y)===K};case"!=":return function(Y){return H(Y)!==K};case"<":return function(Y){return H(Y)<K};case"<=":return function(Y){return H(Y)<=K};case">":return function(Y){return H(Y)>K};case">=":return function(Y){return H(Y)>=K};case"[]":return function(Y){var $=H(Y);return $>=K[0]&&$<=K[1]};case"()":return function(Y){var $=H(Y);return $>K[0]&&$<K[1]};case"[)":return function(Y){var $=H(Y);return $>=K[0]&&$<K[1]};case"(]":return function(Y){var $=H(Y);return $>K[0]&&$<=K[1]};case"][":return function(Y){var $=H(Y);return $<=K[0]||$>=K[1]};case")(":return function(Y){var $=H(Y);return $<K[0]||$>K[1]};case"](":return function(Y){var $=H(Y);return $<=K[0]||$>K[1]};case")[":return function(Y){var $=H(Y);return $<K[0]||$>=K[1]};case"{}":return function(Y){return K.indexOf(H(Y))!==-1};case"}{":return function(Y){return K.indexOf(H(Y))===-1}}}(i,m.getDataToCoordFunc(u,s,n,c),g),A={},S={},w=0;y?(b=function(M){A[M.astr]=t.extendDeep([],M.get()),M.set(new Array(a))},x=function(M,P){var D=A[M.astr][P];M.get()[P]=D}):(b=function(M){A[M.astr]=t.extendDeep([],M.get()),M.set([])},x=function(M,P){var D=A[M.astr][P];M.get().push(D)}),L(b);for(var E=h(s.transforms,i),k=0;k<a;k++)T(c[k])?(L(x,k),S[w++]=E(k)):y&&w++;i._indexToPoints=S,s._length=w}}function L(M,P){for(var D=0;D<p.length;D++)M(t.nestedProperty(s,p[D]),P)}}},{"../constants/filter_ops":759,"../lib":787,"../plots/cartesian/axes":838,"../registry":915,"./helpers":1386}],1385:[function(r,I,B){var t=r("../lib"),d=r("../plot_api/plot_schema"),m=r("../plots/plots"),h=r("./helpers").pointsAccessorFunction;function e(f,l){var o,u,s,i,c,n,a,g,p,y,v=l.transform,b=l.transformIndex,x=f.transforms[b].groups,T=h(f.transforms,v);if(!t.isArrayOrTypedArray(x)||x.length===0)return[f];var A=t.filterUnique(x),S=new Array(A.length),w=x.length,E=d.findArrayAttributes(f),k=v.styles||[],L={};for(o=0;o<k.length;o++)L[k[o].target]=k[o].value;v.styles&&(y=t.keyedContainer(v,"styles","target","value.name"));var M={},P={};for(o=0;o<A.length;o++){M[n=A[o]]=o,P[n]=0,(a=S[o]=t.extendDeepNoArrays({},f))._group=n,a.transforms[b]._indexToPoints={};var D=null;for(y&&(D=y.get(n)),a.name=D||D===""?D:t.templateString(v.nameformat,{trace:f.name,group:n}),g=a.transforms,a.transforms=[],u=0;u<g.length;u++)a.transforms[u]=t.extendDeepNoArrays({},g[u]);for(u=0;u<E.length;u++)t.nestedProperty(a,E[u]).set([])}for(s=0;s<E.length;s++){for(i=E[s],u=0,p=[];u<A.length;u++)p[u]=t.nestedProperty(S[u],i).get();for(c=t.nestedProperty(f,i).get(),u=0;u<w;u++)p[M[x[u]]].push(c[u])}for(u=0;u<w;u++)(a=S[M[x[u]]]).transforms[b]._indexToPoints[P[x[u]]]=T(u),P[x[u]]++;for(o=0;o<A.length;o++)n=A[o],a=S[o],m.clearExpandedTraceDefaultColors(a),a=t.extendDeepNoArrays(a,L[n]||{});return S}B.moduleType="transform",B.name="groupby",B.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},B.supplyDefaults=function(f,l,o){var u,s={};function i(p,y){return t.coerce(f,s,B.attributes,p,y)}if(!i("enabled"))return s;i("groups"),i("nameformat",o._dataLength>1?"%{group} (%{trace})":"%{group}");var c=f.styles,n=s.styles=[];if(c)for(u=0;u<c.length;u++){var a=n[u]={};t.coerce(c[u],n[u],B.attributes.styles,"target");var g=t.coerce(c[u],n[u],B.attributes.styles,"value");t.isPlainObject(g)?a.value=t.extendDeep({},g):g&&delete a.value}return s},B.transform=function(f,l){var o,u,s,i=[];for(u=0;u<f.length;u++)for(o=e(f[u],l),s=0;s<o.length;s++)i.push(o[s]);return i}},{"../lib":787,"../plot_api/plot_schema":826,"../plots/plots":901,"./helpers":1386}],1386:[function(r,I,B){B.pointsAccessorFunction=function(t,d){for(var m,h,e=0;e<t.length&&(m=t[e])!==d;e++)m._indexToPoints&&m.enabled!==!1&&(h=m._indexToPoints);return h?function(f){return h[f]}:function(f){return[f]}}},{}],1387:[function(r,I,B){var t=r("../lib"),d=r("../plots/cartesian/axes"),m=r("./helpers").pointsAccessorFunction,h=r("../constants/numerical").BADNUM;B.moduleType="transform",B.name="sort",B.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},B.supplyDefaults=function(e){var f={};function l(o,u){return t.coerce(e,f,B.attributes,o,u)}return l("enabled")&&(l("target"),l("order")),f},B.calcTransform=function(e,f,l){if(l.enabled){var o=t.getTargetArray(f,l);if(o){var u=l.target,s=o.length;f._length&&(s=Math.min(s,f._length));var i,c,n=f._arrayAttrs,a=function(x,T,A,S){var w,E=new Array(S),k=new Array(S);for(w=0;w<S;w++)E[w]={v:T[w],i:w};for(E.sort(function(L,M){switch(L.order){case"ascending":return function(P,D){var N=M(P.v),U=M(D.v);return N===h?1:U===h?-1:N-U};case"descending":return function(P,D){var N=M(P.v),U=M(D.v);return N===h?1:U===h?-1:U-N}}}(x,A)),w=0;w<S;w++)k[w]=E[w].i;return k}(l,o,d.getDataToCoordFunc(e,f,u,o),s),g=m(f.transforms,l),p={};for(i=0;i<n.length;i++){var y=t.nestedProperty(f,n[i]),v=y.get(),b=new Array(s);for(c=0;c<s;c++)b[c]=v[a[c]];y.set(b)}for(c=0;c<s;c++)p[c]=g(a[c]);l._indexToPoints=p,f._length=s}}}},{"../constants/numerical":763,"../lib":787,"../plots/cartesian/axes":838,"./helpers":1386}],1388:[function(r,I,B){B.version="2.5.1"},{}]},{},[27])(27)})})(Jd);var Yl=Kd(Jd.exports),$d={exports:{}},Qd={exports:{}};(function(Je,Qe){(function(r,I){Je.exports=I()})(typeof window!="undefined"?window:vi,function(){if(typeof window=="undefined")return null;var r=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")(),I=r.requestAnimationFrame||r.mozRequestAnimationFrame||r.webkitRequestAnimationFrame||function(f){return r.setTimeout(f,20)},B=r.cancelAnimationFrame||r.mozCancelAnimationFrame||r.webkitCancelAnimationFrame||function(f){r.clearTimeout(f)};function t(f,l){var o=Object.prototype.toString.call(f),u=o==="[object Array]"||o==="[object NodeList]"||o==="[object HTMLCollection]"||o==="[object Object]"||typeof jQuery!="undefined"&&f instanceof jQuery||typeof Elements!="undefined"&&f instanceof Elements,s=0,i=f.length;if(u)for(;s<i;s++)l(f[s]);else l(f)}function d(f){if(!f.getBoundingClientRect)return{width:f.offsetWidth,height:f.offsetHeight};var l=f.getBoundingClientRect();return{width:Math.round(l.width),height:Math.round(l.height)}}function m(f,l){Object.keys(l).forEach(function(o){f.style[o]=l[o]})}var h=function(f,l){var o=0;function u(){var i=[];this.add=function(a){i.push(a)};var c,n;this.call=function(a){for(c=0,n=i.length;c<n;c++)i[c].call(this,a)},this.remove=function(a){var g=[];for(c=0,n=i.length;c<n;c++)i[c]!==a&&g.push(i[c]);i=g},this.length=function(){return i.length}}function s(i,c){if(!!i){if(i.resizedAttached){i.resizedAttached.add(c);return}i.resizedAttached=new u,i.resizedAttached.add(c),i.resizeSensor=document.createElement("div"),i.resizeSensor.dir="ltr",i.resizeSensor.className="resize-sensor";var n={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},a={position:"absolute",left:"0px",top:"0px",transition:"0s"};m(i.resizeSensor,n);var g=document.createElement("div");g.className="resize-sensor-expand",m(g,n);var p=document.createElement("div");m(p,a),g.appendChild(p);var y=document.createElement("div");y.className="resize-sensor-shrink",m(y,n);var v=document.createElement("div");m(v,a),m(v,{width:"200%",height:"200%"}),y.appendChild(v),i.resizeSensor.appendChild(g),i.resizeSensor.appendChild(y),i.appendChild(i.resizeSensor);var b=window.getComputedStyle(i),x=b?b.getPropertyValue("position"):null;x!=="absolute"&&x!=="relative"&&x!=="fixed"&&x!=="sticky"&&(i.style.position="relative");var T=!1,A=0,S=d(i),w=0,E=0,k=!0;o=0;var L=function(){var U=i.offsetWidth,G=i.offsetHeight;p.style.width=U+10+"px",p.style.height=G+10+"px",g.scrollLeft=U+10,g.scrollTop=G+10,y.scrollLeft=U+10,y.scrollTop=G+10},M=function(){if(k){var U=i.offsetWidth===0&&i.offsetHeight===0;if(U){o||(o=I(function(){o=0,M()}));return}else k=!1}L()};i.resizeSensor.resetSensor=M;var P=function(){A=0,!!T&&(w=S.width,E=S.height,i.resizedAttached&&i.resizedAttached.call(S))},D=function(){S=d(i),T=S.width!==w||S.height!==E,T&&!A&&(A=I(P)),M()},N=function(U,G,X){U.attachEvent?U.attachEvent("on"+G,X):U.addEventListener(G,X)};N(g,"scroll",D),N(y,"scroll",D),o=I(function(){o=0,M()})}}t(f,function(i){s(i,l)}),this.detach=function(i){o||(B(o),o=0),h.detach(f,i)},this.reset=function(){f.resizeSensor.resetSensor()}};if(h.reset=function(f){t(f,function(l){l.resizeSensor.resetSensor()})},h.detach=function(f,l){t(f,function(o){!o||o.resizedAttached&&typeof l=="function"&&(o.resizedAttached.remove(l),o.resizedAttached.length())||o.resizeSensor&&(o.contains(o.resizeSensor)&&o.removeChild(o.resizeSensor),delete o.resizeSensor,delete o.resizedAttached)})},typeof MutationObserver!="undefined"){var e=new MutationObserver(function(f){for(var l in f)if(f.hasOwnProperty(l))for(var o=f[l].addedNodes,u=0;u<o.length;u++)o[u].resizeSensor&&h.reset(o[u])});document.addEventListener("DOMContentLoaded",function(f){e.observe(document.body,{childList:!0,subtree:!0})})}return h})})(Qd);var Vm="Expected a function",e0=0/0,Hm="[object Symbol]",Gm=/^\s+|\s+$/g,qm=/^[-+]0x[0-9a-f]+$/i,Ym=/^0b[01]+$/i,Wm=/^0o[0-7]+$/i,Xm=parseInt,Zm=typeof vi=="object"&&vi&&vi.Object===Object&&vi,Km=typeof self=="object"&&self&&self.Object===Object&&self,Jm=Zm||Km||Function("return this")(),$m=Object.prototype,Qm=$m.toString,ev=Math.max,tv=Math.min,Yh=function(){return Jm.Date.now()};function rv(Je,Qe,r){var I,B,t,d,m,h,e=0,f=!1,l=!1,o=!0;if(typeof Je!="function")throw new TypeError(Vm);Qe=t0(Qe)||0,Wh(r)&&(f=!!r.leading,l="maxWait"in r,t=l?ev(t0(r.maxWait)||0,Qe):t,o="trailing"in r?!!r.trailing:o);function u(v){var b=I,x=B;return I=B=void 0,e=v,d=Je.apply(x,b),d}function s(v){return e=v,m=setTimeout(n,Qe),f?u(v):d}function i(v){var b=v-h,x=v-e,T=Qe-b;return l?tv(T,t-x):T}function c(v){var b=v-h,x=v-e;return h===void 0||b>=Qe||b<0||l&&x>=t}function n(){var v=Yh();if(c(v))return a(v);m=setTimeout(n,i(v))}function a(v){return m=void 0,o&&I?u(v):(I=B=void 0,d)}function g(){m!==void 0&&clearTimeout(m),e=0,I=h=B=m=void 0}function p(){return m===void 0?d:a(Yh())}function y(){var v=Yh(),b=c(v);if(I=arguments,B=this,h=v,b){if(m===void 0)return s(h);if(l)return m=setTimeout(n,Qe),u(h)}return m===void 0&&(m=setTimeout(n,Qe)),d}return y.cancel=g,y.flush=p,y}function Wh(Je){var Qe=typeof Je;return!!Je&&(Qe=="object"||Qe=="function")}function nv(Je){return!!Je&&typeof Je=="object"}function av(Je){return typeof Je=="symbol"||nv(Je)&&Qm.call(Je)==Hm}function t0(Je){if(typeof Je=="number")return Je;if(av(Je))return e0;if(Wh(Je)){var Qe=typeof Je.valueOf=="function"?Je.valueOf():Je;Je=Wh(Qe)?Qe+"":Qe}if(typeof Je!="string")return Je===0?Je:+Je;Je=Je.replace(Gm,"");var r=Ym.test(Je);return r||Wm.test(Je)?Xm(Je.slice(2),r?2:8):qm.test(Je)?e0:+Je}var iv=rv;(function(Je,Qe){(function(r,I){Je.exports=I(Qd.exports,iv)})(vi,function(r,I){return function(B){function t(m){if(d[m])return d[m].exports;var h=d[m]={exports:{},id:m,loaded:!1};return B[m].call(h.exports,h,h.exports,t),h.loaded=!0,h.exports}var d={};return t.m=B,t.c=d,t.p="/",t(0)}([function(B,t,d){var m,h,e;(function(f,l){h=[B,t,d(10),d(38),d(39),d(9),d(37)],m=l,e=typeof m=="function"?m.apply(t,h):m,e!==void 0&&(B.exports=e)})(this,function(f,l,o,u,s){function i(S){return S&&S.__esModule?S:{default:S}}function c(S){if(!S)return{delay:A,initial:!1};var w=S.initial,E=w!==void 0&&w,k=(0,y.default)(S).map(function(L){return parseInt(L)}).find(function(L){return!isNaN(L)});return k=k||A,{delay:k,initial:E}}function n(S,w){var E={root:document.documentElement},k=new IntersectionObserver(function(L,M){L.forEach(function(P){P.isIntersecting&&(w(),M.disconnect())})},E);return k.observe(S),k}function a(S,w){var E=w.value,k=w.arg,L=w.options,M=function(){return E(S)};switch(k){case"debounce":M=T(function(){return E(S)},L.delay);break;case"throttle":M=T(function(){return E(S)},L.delay,{leading:!0,trailing:!0,maxWait:L.delay})}var P=new v.default(S,M);return L.initial&&E(S),P}function g(S,w,E){var k=w.value,L=w.arg,M=w.modifiers,P=E.context;if(!k||typeof k!="function")return void console.warn("v-resize should received a function as value");var D=c(M);return P&&P.$el===S&&P.$once("hook:deactivated",function(){p(S),P.$once("hook:activated",function(){g(S,{value:k,arg:L,modifiers:M},{context:P})})}),S.offsetParent?void a(S,{value:k,arg:L,options:D}):(D.initial=!0,void(S.__visibility__listener__=n(S,function(){return a(S,{value:k,arg:L,options:D})})))}function p(S){S.__visibility__listener__&&S.__visibility__listener__.disconnect(),S.resizeSensor&&v.default.detach(S)}Object.defineProperty(l,"__esModule",{value:!0});var y=i(o),v=i(u),b=i(s),x=b.default.debounce,T=x===void 0?b.default:x,A=150;l.default={inserted:g,unbind:p},f.exports=l.default})},function(B,t){var d=B.exports={version:"2.4.0"};typeof __e=="number"&&(__e=d)},function(B,t,d){B.exports=!d(3)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(B,t){B.exports=function(d){try{return!!d()}catch(m){return!0}}},function(B,t){var d=B.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=d)},function(B,t){B.exports=function(d){return typeof d=="object"?d!==null:typeof d=="function"}},function(B,t){B.exports=function(d){if(d==null)throw TypeError("Can't call method on  "+d);return d}},function(B,t){var d=Math.ceil,m=Math.floor;B.exports=function(h){return isNaN(h=+h)?0:(h>0?m:d)(h)}},function(B,t,d){var m=d(23),h=d(6);B.exports=function(e){return m(h(e))}},function(B,t,d){var m,h,e;(function(f,l){h=[],m=l,e=typeof m=="function"?m.apply(t,h):m,e!==void 0&&(B.exports=e)})(this,function(){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(f){if(this==null)throw new TypeError('"this" is null or not defined');var l=Object(this),o=l.length>>>0;if(typeof f!="function")throw new TypeError("predicate must be a function");for(var u=arguments[1],s=0;s<o;){var i=l[s];if(f.call(u,i,s,l))return i;s++}},configurable:!0,writable:!0})})},function(B,t,d){B.exports={default:d(11),__esModule:!0}},function(B,t,d){d(36),B.exports=d(1).Object.keys},function(B,t){B.exports=function(d){if(typeof d!="function")throw TypeError(d+" is not a function!");return d}},function(B,t,d){var m=d(5);B.exports=function(h){if(!m(h))throw TypeError(h+" is not an object!");return h}},function(B,t,d){var m=d(8),h=d(32),e=d(31);B.exports=function(f){return function(l,o,u){var s,i=m(l),c=h(i.length),n=e(u,c);if(f&&o!=o){for(;c>n;)if(s=i[n++],s!=s)return!0}else for(;c>n;n++)if((f||n in i)&&i[n]===o)return f||n||0;return!f&&-1}}},function(B,t){var d={}.toString;B.exports=function(m){return d.call(m).slice(8,-1)}},function(B,t,d){var m=d(12);B.exports=function(h,e,f){if(m(h),e===void 0)return h;switch(f){case 1:return function(l){return h.call(e,l)};case 2:return function(l,o){return h.call(e,l,o)};case 3:return function(l,o,u){return h.call(e,l,o,u)}}return function(){return h.apply(e,arguments)}}},function(B,t,d){var m=d(5),h=d(4).document,e=m(h)&&m(h.createElement);B.exports=function(f){return e?h.createElement(f):{}}},function(B,t){B.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(B,t,d){var m=d(4),h=d(1),e=d(16),f=d(21),l="prototype",o=function(u,s,i){var c,n,a,g=u&o.F,p=u&o.G,y=u&o.S,v=u&o.P,b=u&o.B,x=u&o.W,T=p?h:h[s]||(h[s]={}),A=T[l],S=p?m:y?m[s]:(m[s]||{})[l];p&&(i=s);for(c in i)n=!g&&S&&S[c]!==void 0,n&&c in T||(a=n?S[c]:i[c],T[c]=p&&typeof S[c]!="function"?i[c]:b&&n?e(a,m):x&&S[c]==a?function(w){var E=function(k,L,M){if(this instanceof w){switch(arguments.length){case 0:return new w;case 1:return new w(k);case 2:return new w(k,L)}return new w(k,L,M)}return w.apply(this,arguments)};return E[l]=w[l],E}(a):v&&typeof a=="function"?e(Function.call,a):a,v&&((T.virtual||(T.virtual={}))[c]=a,u&o.R&&A&&!A[c]&&f(A,c,a)))};o.F=1,o.G=2,o.S=4,o.P=8,o.B=16,o.W=32,o.U=64,o.R=128,B.exports=o},function(B,t){var d={}.hasOwnProperty;B.exports=function(m,h){return d.call(m,h)}},function(B,t,d){var m=d(24),h=d(28);B.exports=d(2)?function(e,f,l){return m.f(e,f,h(1,l))}:function(e,f,l){return e[f]=l,e}},function(B,t,d){B.exports=!d(2)&&!d(3)(function(){return Object.defineProperty(d(17)("div"),"a",{get:function(){return 7}}).a!=7})},function(B,t,d){var m=d(15);B.exports=Object("z").propertyIsEnumerable(0)?Object:function(h){return m(h)=="String"?h.split(""):Object(h)}},function(B,t,d){var m=d(13),h=d(22),e=d(34),f=Object.defineProperty;t.f=d(2)?Object.defineProperty:function(l,o,u){if(m(l),o=e(o,!0),m(u),h)try{return f(l,o,u)}catch(s){}if("get"in u||"set"in u)throw TypeError("Accessors not supported!");return"value"in u&&(l[o]=u.value),l}},function(B,t,d){var m=d(20),h=d(8),e=d(14)(!1),f=d(29)("IE_PROTO");B.exports=function(l,o){var u,s=h(l),i=0,c=[];for(u in s)u!=f&&m(s,u)&&c.push(u);for(;o.length>i;)m(s,u=o[i++])&&(~e(c,u)||c.push(u));return c}},function(B,t,d){var m=d(25),h=d(18);B.exports=Object.keys||function(e){return m(e,h)}},function(B,t,d){var m=d(19),h=d(1),e=d(3);B.exports=function(f,l){var o=(h.Object||{})[f]||Object[f],u={};u[f]=l(o),m(m.S+m.F*e(function(){o(1)}),"Object",u)}},function(B,t){B.exports=function(d,m){return{enumerable:!(1&d),configurable:!(2&d),writable:!(4&d),value:m}}},function(B,t,d){var m=d(30)("keys"),h=d(35);B.exports=function(e){return m[e]||(m[e]=h(e))}},function(B,t,d){var m=d(4),h="__core-js_shared__",e=m[h]||(m[h]={});B.exports=function(f){return e[f]||(e[f]={})}},function(B,t,d){var m=d(7),h=Math.max,e=Math.min;B.exports=function(f,l){return f=m(f),f<0?h(f+l,0):e(f,l)}},function(B,t,d){var m=d(7),h=Math.min;B.exports=function(e){return e>0?h(m(e),9007199254740991):0}},function(B,t,d){var m=d(6);B.exports=function(h){return Object(m(h))}},function(B,t,d){var m=d(5);B.exports=function(h,e){if(!m(h))return h;var f,l;if(e&&typeof(f=h.toString)=="function"&&!m(l=f.call(h))||typeof(f=h.valueOf)=="function"&&!m(l=f.call(h))||!e&&typeof(f=h.toString)=="function"&&!m(l=f.call(h)))return l;throw TypeError("Can't convert object to primitive value")}},function(B,t){var d=0,m=Math.random();B.exports=function(h){return"Symbol(".concat(h===void 0?"":h,")_",(++d+m).toString(36))}},function(B,t,d){var m=d(33),h=d(26);d(27)("keys",function(){return function(e){return h(m(e))}})},function(B,t){(function(d,m){function h(g){this.time=g.time,this.target=g.target,this.rootBounds=g.rootBounds,this.boundingClientRect=g.boundingClientRect,this.intersectionRect=g.intersectionRect||c(),this.isIntersecting=!!g.intersectionRect;var p=this.boundingClientRect,y=p.width*p.height,v=this.intersectionRect,b=v.width*v.height;y?this.intersectionRatio=b/y:this.intersectionRatio=this.isIntersecting?1:0}function e(g,p){var y=p||{};if(typeof g!="function")throw new Error("callback must be a function");if(y.root&&y.root.nodeType!=1)throw new Error("root must be an Element");this._checkForIntersections=l(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=g,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(y.rootMargin),this.thresholds=this._initThresholds(y.threshold),this.root=y.root||null,this.rootMargin=this._rootMarginValues.map(function(v){return v.value+v.unit}).join(" ")}function f(){return d.performance&&performance.now&&performance.now()}function l(g,p){var y=null;return function(){y||(y=setTimeout(function(){g(),y=null},p))}}function o(g,p,y,v){typeof g.addEventListener=="function"?g.addEventListener(p,y,v||!1):typeof g.attachEvent=="function"&&g.attachEvent("on"+p,y)}function u(g,p,y,v){typeof g.removeEventListener=="function"?g.removeEventListener(p,y,v||!1):typeof g.detatchEvent=="function"&&g.detatchEvent("on"+p,y)}function s(g,p){var y=Math.max(g.top,p.top),v=Math.min(g.bottom,p.bottom),b=Math.max(g.left,p.left),x=Math.min(g.right,p.right),T=x-b,A=v-y;return T>=0&&A>=0&&{top:y,bottom:v,left:b,right:x,width:T,height:A}}function i(g){var p;try{p=g.getBoundingClientRect()}catch(y){}return p?(p.width&&p.height||(p={top:p.top,right:p.right,bottom:p.bottom,left:p.left,width:p.right-p.left,height:p.bottom-p.top}),p):c()}function c(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function n(g,p){for(var y=p;y;){if(y==g)return!0;y=a(y)}return!1}function a(g){var p=g.parentNode;return p&&p.nodeType==11&&p.host?p.host:p}if("IntersectionObserver"in d&&"IntersectionObserverEntry"in d&&"intersectionRatio"in d.IntersectionObserverEntry.prototype)return void("isIntersecting"in d.IntersectionObserverEntry.prototype||Object.defineProperty(d.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}}));e.prototype.THROTTLE_TIMEOUT=100,e.prototype.POLL_INTERVAL=null,e.prototype.USE_MUTATION_OBSERVER=!0,e.prototype.observe=function(g){var p=this._observationTargets.some(function(y){return y.element==g});if(!p){if(!g||g.nodeType!=1)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:g,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},e.prototype.unobserve=function(g){this._observationTargets=this._observationTargets.filter(function(p){return p.element!=g}),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},e.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},e.prototype.takeRecords=function(){var g=this._queuedEntries.slice();return this._queuedEntries=[],g},e.prototype._initThresholds=function(g){var p=g||[0];return Array.isArray(p)||(p=[p]),p.sort().filter(function(y,v,b){if(typeof y!="number"||isNaN(y)||y<0||y>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return y!==b[v-1]})},e.prototype._parseRootMargin=function(g){var p=g||"0px",y=p.split(/\s+/).map(function(v){var b=/^(-?\d*\.?\d+)(px|%)$/.exec(v);if(!b)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(b[1]),unit:b[2]}});return y[1]=y[1]||y[0],y[2]=y[2]||y[0],y[3]=y[3]||y[1],y},e.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(o(d,"resize",this._checkForIntersections,!0),o(m,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in d&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(m,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},e.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,u(d,"resize",this._checkForIntersections,!0),u(m,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},e.prototype._checkForIntersections=function(){var g=this._rootIsInDom(),p=g?this._getRootRect():c();this._observationTargets.forEach(function(y){var v=y.element,b=i(v),x=this._rootContainsTarget(v),T=y.entry,A=g&&x&&this._computeTargetAndRootIntersection(v,p),S=y.entry=new h({time:f(),target:v,boundingClientRect:b,rootBounds:p,intersectionRect:A});T?g&&x?this._hasCrossedThreshold(T,S)&&this._queuedEntries.push(S):T&&T.isIntersecting&&this._queuedEntries.push(S):this._queuedEntries.push(S)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},e.prototype._computeTargetAndRootIntersection=function(g,p){if(d.getComputedStyle(g).display!="none"){for(var y=i(g),v=y,b=a(g),x=!1;!x;){var T=null,A=b.nodeType==1?d.getComputedStyle(b):{};if(A.display=="none")return;if(b==this.root||b==m?(x=!0,T=p):b!=m.body&&b!=m.documentElement&&A.overflow!="visible"&&(T=i(b)),T&&(v=s(T,v),!v))break;b=a(b)}return v}},e.prototype._getRootRect=function(){var g;if(this.root)g=i(this.root);else{var p=m.documentElement,y=m.body;g={top:0,left:0,right:p.clientWidth||y.clientWidth,width:p.clientWidth||y.clientWidth,bottom:p.clientHeight||y.clientHeight,height:p.clientHeight||y.clientHeight}}return this._expandRectByRootMargin(g)},e.prototype._expandRectByRootMargin=function(g){var p=this._rootMarginValues.map(function(v,b){return v.unit=="px"?v.value:v.value*(b%2?g.width:g.height)/100}),y={top:g.top-p[0],right:g.right+p[1],bottom:g.bottom+p[2],left:g.left-p[3]};return y.width=y.right-y.left,y.height=y.bottom-y.top,y},e.prototype._hasCrossedThreshold=function(g,p){var y=g&&g.isIntersecting?g.intersectionRatio||0:-1,v=p.isIntersecting?p.intersectionRatio||0:-1;if(y!==v)for(var b=0;b<this.thresholds.length;b++){var x=this.thresholds[b];if(x==y||x==v||x<y!=x<v)return!0}},e.prototype._rootIsInDom=function(){return!this.root||n(m,this.root)},e.prototype._rootContainsTarget=function(g){return n(this.root||m,g)},e.prototype._registerInstance=function(){},e.prototype._unregisterInstance=function(){},d.IntersectionObserver=e,d.IntersectionObserverEntry=h})(window,document)},function(B,t){B.exports=r},function(B,t){B.exports=I}])})})($d);var ov=Kd($d.exports);const sv=["AfterExport","AfterPlot","Animated","AnimatingFrame","AnimationInterrupted","AutoSize","BeforeExport","ButtonClicked","Click","ClickAnnotation","Deselect","DoubleClick","Framework","Hover","LegendClick","LegendDoubleClick","Relayout","Restyle","Redraw","Selected","Selecting","SliderChange","SliderEnd","SliderStart","Transitioning","TransitionInterrupted","Unhover"],r0=sv.map(Je=>Je.toLocaleLowerCase()).map(Je=>({completeName:"plotly_"+Je,handler:Qe=>(...r)=>{Qe.$emit.apply(Qe,[Je,...r])}})),lv=["restyle","relayout","update","addTraces","deleteTraces","moveTraces","extendTraces","prependTraces","purge"],uv=lv.reduce((Je,Qe)=>(Je[Qe]=function(...r){return Yl[Qe].apply(Yl,[this.$el,...r])},Je),{});function cv(Je){const Qe=Object.create(null);return function(I){return Qe[I]||(Qe[I]=Je(I))}}const fv=/-(\w)/g,hv=cv(Je=>Je.replace(fv,(Qe,r)=>r?r.toUpperCase():""));var pv=function(){var Je=this,Qe=Je.$createElement,r=Je._self._c||Qe;return r("div",{directives:[{name:"resize",rawName:"v-resize:debounce.100",value:Je.onResize,expression:"onResize",arg:"debounce",modifiers:{"100":!0}}],attrs:{id:Je.id}})},dv=[];function gv(Je,Qe,r,I,B,t,d,m){var h=typeof Je=="function"?Je.options:Je;Qe&&(h.render=Qe,h.staticRenderFns=r,h._compiled=!0),I&&(h.functional=!0),t&&(h._scopeId="data-v-"+t);var e;if(d?(e=function(o){o=o||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!o&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(o=__VUE_SSR_CONTEXT__),B&&B.call(this,o),o&&o._registeredComponents&&o._registeredComponents.add(d)},h._ssrRegister=e):B&&(e=m?function(){B.call(this,(h.functional?this.parent:this).$root.$options.shadowRoot)}:B),e)if(h.functional){h._injectStyles=e;var f=h.render;h.render=function(u,s){return e.call(s),f(u,s)}}else{var l=h.beforeCreate;h.beforeCreate=l?[].concat(l,e):[e]}return{exports:Je,options:h}}const n0={};typeof window!="undefined"&&(n0.resize=ov);const mv={name:"plotly",inheritAttrs:!1,directives:n0,props:{data:{type:Array},layout:{type:Object},id:{type:String,required:!1,default:null}},data(){return{scheduled:null,innerLayout:Nf({},this.layout)}},mounted(){Yl.newPlot(this.$el,this.data,this.innerLayout,this.options),r0.forEach(Je=>{this.$el.on(Je.completeName,Je.handler(this))})},watch:{data:{handler(){this.schedule({replot:!0})},deep:!0},options:{handler(Je,Qe){JSON.stringify(Je)!==JSON.stringify(Qe)&&this.schedule({replot:!0})},deep:!0},layout(Je){this.innerLayout=Nf({},Je),this.schedule({replot:!1})}},computed:{options(){const Je=Object.keys(this.$attrs).reduce((Qe,r)=>(Qe[hv(r)]=this.$attrs[r],Qe),{});return Nf({responsive:!1},Je)}},beforeDestroy(){r0.forEach(Je=>this.$el.removeAllListeners(Je.completeName)),Yl.purge(this.$el)},methods:Um(Nf({},uv),{onResize(){Yl.Plots.resize(this.$el)},schedule(Je){const{scheduled:Qe}=this;if(Qe){Qe.replot=Qe.replot||Je.replot;return}this.scheduled=Je,this.$nextTick(()=>{const{scheduled:{replot:r}}=this;if(this.scheduled=null,r){this.react();return}this.relayout(this.innerLayout)})},toImage(Je){const Qe=Object.assign(this.getPrintOptions(),Je);return Yl.toImage(this.$el,Qe)},downloadImage(Je){const Qe=`plot--${new Date().toISOString()}`,r=Object.assign(this.getPrintOptions(),{filename:Qe},Je);return Yl.downloadImage(this.$el,r)},getPrintOptions(){const{$el:Je}=this;return{format:"png",width:Je.clientWidth,height:Je.clientHeight}},react(){Yl.react(this.$el,this.data,this.innerLayout,this.options)}})},a0={};var vv=gv(mv,pv,dv,!1,yv,null,null,null);function yv(Je){for(let Qe in a0)this[Qe]=a0[Qe]}var i0=function(){return vv.exports}();function Wl(Je={},Qe={},r={},I=!1){return{name:Je.name,mixins:[Uu],props:{plotlyOptions:{type:Object,default:function(){return{}}}},render(t){const d=new Ps(this.$props),m=d.getRowKeys(),h=d.getColKeys(),e=I?h:m;e.length===0&&e.push([]);const f=I?m:h;f.length===0&&f.push([]);let l=this.$props.aggregatorName;const o=uu[l]([])().numInputs||0;o!==0&&(l+=` of ${this.$props.vals.slice(0,o).join(", ")}`);const u=e.map(a=>{const g=[],p=[];for(const v of f){const b=parseFloat(d.getAggregator(I?v:a,I?a:v).value());g.push(isFinite(b)?b:null),p.push(v.join("-")||" ")}const y={name:a.join("-")||l};return Qe.type==="pie"?(y.values=g,y.labels=p.length>1?p:[l]):(y.x=I?g:p,y.y=I?p:g),Object.assign(y,Qe)});let s=l;const i=I?this.$props.rows.join("-"):this.$props.cols.join("-"),c=I?this.$props.cols.join("-"):this.$props.rows.join("-");i!==""&&(s+=` vs ${i}`),c!==""&&(s+=` by ${c}`);const n={title:s,hovermode:"closest",width:window.innerWidth/1.5,height:window.innerHeight/1.4-50};if(Qe.type==="pie"){const a=Math.ceil(Math.sqrt(u.length)),g=Math.ceil(u.length/a);n.grid={columns:a,rows:g},u.forEach((p,y)=>{p.domain={row:Math.floor(y/a),column:y-a*Math.floor(y/a)},u.length>1&&(p.title=p.name)}),u[0].labels.length===1&&(n.showlegend=!1)}else n.xaxis={title:I?l:null,automargin:!0},n.yaxis={title:I?null:l,automargin:!0};return t(i0,{props:{data:u,layout:ul(ul(ul({},n),r),this.$props.plotlyOptions)}})}}}function xv(Je={}){return{name:Je.name,mixins:[Uu],props:{plotlyOptions:{type:Object,default:function(){return{}}}},render(r){const I=new Ps(this.$props),B=I.getRowKeys(),t=I.getColKeys();B.length===0&&B.push([]),t.length===0&&t.push([]);const d={x:[],y:[],text:[],type:"scatter",mode:"markers"};B.map(h=>{t.map(e=>{const f=I.getAggregator(h,e).value();f!==null&&(d.x.push(e.join("-")),d.y.push(h.join("-")),d.text.push(f))})});const m={title:this.$props.rows.join("-")+" vs "+this.$props.cols.join("-"),hovermode:"closest",xaxis:{title:this.$props.cols.join("-"),automargin:!0},yaxis:{title:this.$props.rows.join("-"),automargin:!0},width:window.innerWidth/1.5,height:window.innerHeight/1.4-50};return r(i0,{props:{data:[d],layout:ul(ul({},m),this.$props.plotlyOptions)}})}}}var o0={"Grouped Column Chart":Wl({name:"vue-grouped-column-chart"},{type:"bar"},{barmode:"group"}),"Stacked Column Chart":Wl({name:"vue-stacked-column-chart"},{type:"bar"},{barmode:"relative"}),"Grouped Bar Chart":Wl({name:"groupd-bar-chart"},{type:"bar",orientation:"h"},{barmode:"group"},!0),"Stacked Bar Chart":Wl({name:"vue-stacked-bar-chart"},{type:"bar",orientation:"h"},{barmode:"relative"},!0),"Line Chart":Wl({name:"vue-line-chart"},{connectgaps:!0}),"Dot Chart":Wl({name:"vue-dot-chart"},{mode:"markers"},{},!0),"Area Chart":Wl({name:"vue-area-chart"},{stackgroup:1}),"Scatter Chart":xv({name:"vue-scatter-chart"}),"Multiple Pie Chart":Wl({name:"vue-multiple-pie-chart"},{type:"pie",scalegroup:1,hoverinfo:"label+value",textinfo:"none"},{},!0)},s0={name:"vue-pivottable-ui",mixins:[Uu],props:{hiddenAttributes:{type:Array,default:function(){return[]}},hiddenFromAggregators:{type:Array,default:function(){return[]}},hiddenFromDragDrop:{type:Array,default:function(){return[]}},sortonlyFromDragDrop:{type:Array,default:function(){return[]}},disabledFromDragDrop:{type:Array,default:function(){return[]}},rowLimit:{type:Number,default:0},colLimit:{type:Number,default:0},menuLimit:{type:Number,default:500}},computed:{rendererItems(){return Object.assign({},bf,o0)},numValsAllowed(){return uu[this.propsData.aggregatorName||this.aggregatorName]([])().numInputs||0},rowAttrs(){return this.propsData.rows.filter(Je=>!this.hiddenAttributes.includes(Je)&&!this.hiddenFromDragDrop.includes(Je))},colAttrs(){return this.propsData.cols.filter(Je=>!this.hiddenAttributes.includes(Je)&&!this.hiddenFromDragDrop.includes(Je))},unusedAttrs(){return this.propsData.attributes.filter(Je=>!this.propsData.rows.includes(Je)&&!this.propsData.cols.includes(Je)&&!this.hiddenAttributes.includes(Je)&&!this.hiddenFromDragDrop.includes(Je)).sort(Ad(this.unusedOrder))},config(){return{derivedAttributes:this.derivedAttributes,hiddenAttributes:this.hiddenAttributes,hiddenFromAggregators:[],hiddenFromDragDrop:[],menuLimit:500,cols:["Party"],rows:["Province"],vals:[],rowOrder:"key_a_to_z",colOrder:"key_a_to_z",exclusions:{},inclusions:{},unusedAttrsVertical:85,autoSortUnusedAttrs:!1,showUI:!0,sorters:{},inclusionsInfo:{},aggregatorName:"Count",rendererName:"Table"}}},data(){return{propsData:{aggregatorName:"",rendererName:"",rowOrder:"key_a_to_z",colOrder:"key_a_to_z",vals:[],cols:[],rows:[],attributes:[],valueFilter:{},renderer:null},pivotData:[],openStatus:{},attrValues:{},unusedOrder:[],zIndices:{},maxZIndex:1e3,openDropdown:!1,materializedInput:[],sortIcons:{key_a_to_z:{rowSymbol:"\u2195",colSymbol:"\u2194",next:"value_a_to_z"},value_a_to_z:{rowSymbol:"\u2193",colSymbol:"\u2192",next:"value_z_to_a"},value_z_to_a:{rowSymbol:"\u2191",colSymbol:"\u2190",next:"key_a_to_z"}}}},beforeUpdated(Je){this.materializeInput(Je.data)},watch:{data:{handler(Je){this.init()},immediate:!0,deep:!0},attributes:{handler(Je){this.propsData.attributes=Je.length>0?Je:Object.keys(this.attrValues)},deep:!0},propsData:{handler(Je){if(this.pivotData.length===0)return;const Qe=gf(ul({},this.$props),{data:this.materializedInput,rowOrder:Je.rowOrder,colOrder:Je.colOrder,valueFilter:Je.valueFilter,rows:Je.rows,cols:Je.cols,rendererName:Je.rendererName,aggregatorName:this.aggregatorName,vals:this.vals});this.$emit("onRefresh",Qe)},immediate:!1,deep:!0}},methods:{init(){this.materializeInput(this.data),this.propsData.vals=this.vals.slice(),this.propsData.rows=this.rows,this.propsData.cols=this.cols,this.propsData.attributes=this.attributes.length>0?this.attributes:Object.keys(this.attrValues),this.unusedOrder=this.unusedAttrs,Object.keys(this.attrValues).map(this.assignValue),Object.keys(this.openStatus).map(this.assignValue),this.propsData.colOrder=this.colOrder,this.propsData.rowOrder=this.rowOrder,this.propsData.valueFilter=this.valueFilter},assignValue(Je){this.$set(this.propsData.valueFilter,Je,{})},propUpdater(Je){return Qe=>{this.propsData[Je]=Qe}},updateValueFilter({attribute:Je,valueFilter:Qe}){this.$set(this.propsData.valueFilter,Je,Qe)},moveFilterBoxToTop({attribute:Je}){this.maxZIndex+=1,this.zIndices[Je]=this.maxZIndex+1},openFilterBox({attribute:Je,open:Qe}){this.openStatus[Je]=Qe},materializeInput(Je){if(this.pivotData===Je)return;this.pivotData=Je;const Qe={},r=[];let I=0;Ps.forEachRecord(this.data,this.derivedAttributes,function(B){r.push(B);for(const t of Object.keys(B))t in Qe||(Qe[t]={},I>0&&(Qe[t].null=I));for(const t in Qe){const d=t in B?B[t]:"null";d in Qe[t]||(Qe[t][d]=0),Qe[t][d]++}I++}),this.materializedInput=r,this.attrValues=Qe},makeDnDCell(Je,Qe,r,I){const B=this.$scopedSlots.pvtAttr;return I(zm,{attrs:{draggable:"li[data-id]",group:"sharted",ghostClass:".pvtPlaceholder",filter:".pvtFilterBox",preventOnFilter:!1,tag:"td"},props:{value:Je},staticClass:r,on:{sort:Qe.bind(this)}},[Je.map(t=>I(Jg,{[B?"scopedSlots":void 0]:{pvtAttr:d=>I("slot",B(d))},props:{sortable:this.sortonlyFromDragDrop.includes(t)||!this.disabledFromDragDrop.includes(t),draggable:!this.sortonlyFromDragDrop.includes(t)&&!this.disabledFromDragDrop.includes(t),name:t,key:t,attrValues:this.attrValues[t],sorter:yf(this.sorters,t),menuLimit:this.menuLimit,zIndex:this.zIndices[t]||this.maxZIndex,valueFilter:this.propsData.valueFilter[t],open:this.openStatus[t],unused:this.unusedAttrs.includes(t)},domProps:{},on:{"update:filter":this.updateValueFilter,"moveToTop:filterbox":this.moveFilterBoxToTop,"open:filterbox":this.openFilterBox}}))])},rendererCell(Je,Qe){return this.$slots.rendererCell?Qe("td",{staticClass:["pvtRenderers pvtVals pvtText"]},this.$slots.rendererCell):Qe("td",{staticClass:["pvtRenderers"]},[Qe(Ah,{props:{values:Object.keys(this.rendererItems)},domProps:{value:Je},on:{input:r=>{this.propUpdater("rendererName")(r),this.propUpdater("renderer",this.rendererItems[r])}}})])},aggregatorCell(Je,Qe,r){return this.$slots.aggregatorCell?r("td",{staticClass:["pvtVals pvtText"]},this.$slots.aggregatorCell):r("td",{staticClass:["pvtVals"]},[r("div",[r(Ah,{style:{display:"inline-block"},props:{values:Object.keys(uu)},domProps:{value:Je},on:{input:I=>{this.propUpdater("aggregatorName")(I)}}}),r("a",{staticClass:["pvtRowOrder"],attrs:{role:"button"},on:{click:()=>{this.propUpdater("rowOrder")(this.sortIcons[this.propsData.rowOrder].next)}}},this.sortIcons[this.propsData.rowOrder].rowSymbol),r("a",{staticClass:["pvtColOrder"],attrs:{role:"button"},on:{click:()=>{this.propUpdater("colOrder")(this.sortIcons[this.propsData.colOrder].next)}}},this.sortIcons[this.propsData.colOrder].colSymbol)]),this.numValsAllowed>0?new Array(this.numValsAllowed).fill().map((I,B)=>[r(Ah,{props:{values:Object.keys(this.attrValues).filter(t=>!this.hiddenAttributes.includes(t)&&!this.hiddenFromAggregators.includes(t))},domProps:{value:Qe[B]},on:{input:t=>{this.propsData.vals.splice(B,1,t)}}})]):void 0])},outputCell(Je,Qe,r){return r("td",{staticClass:["pvtOutput"]},[Qe?r(o0[Je.rendererName],{props:Je}):r(_f,{props:gf(ul({},Je),{tableMaxWidth:this.tableMaxWidth})})])}},render(Je){if(this.data.length<1)return;const Qe=this.$scopedSlots.output,r=this.$slots.output,I=this.propsData.rendererName||this.rendererName,B=this.propsData.aggregatorName||this.aggregatorName,t=this.propsData.vals,d=this.makeDnDCell(this.unusedAttrs,i=>{const c=i.item.getAttribute("data-id");this.sortonlyFromDragDrop.includes(c)&&(!i.from.classList.contains("pvtUnused")||!i.to.classList.contains("pvtUnused"))||(i.from.classList.contains("pvtUnused")&&this.unusedOrder.splice(i.oldIndex,1),i.to.classList.contains("pvtUnused")&&this.unusedOrder.splice(i.newIndex,0,c))},"pvtAxisContainer pvtUnused pvtHorizList",Je),m=this.makeDnDCell(this.colAttrs,i=>{const c=i.item.getAttribute("data-id");this.sortonlyFromDragDrop.includes(c)&&(!i.from.classList.contains("pvtCols")||!i.to.classList.contains("pvtCols"))||(i.from.classList.contains("pvtCols")&&this.propsData.cols.splice(i.oldIndex,1),i.to.classList.contains("pvtCols")&&this.propsData.cols.splice(i.newIndex,0,c))},"pvtAxisContainer pvtHorizList pvtCols",Je),h=this.makeDnDCell(this.rowAttrs,i=>{const c=i.item.getAttribute("data-id");this.sortonlyFromDragDrop.includes(c)&&(!i.from.classList.contains("pvtRows")||!i.to.classList.contains("pvtRows"))||(i.from.classList.contains("pvtRows")&&this.propsData.rows.splice(i.oldIndex,1),i.to.classList.contains("pvtRows")&&this.propsData.rows.splice(i.newIndex,0,c))},"pvtAxisContainer pvtVertList pvtRows",Je),e=gf(ul({},this.$props),{data:this.materializedInput,rowOrder:this.propsData.rowOrder,colOrder:this.propsData.colOrder,valueFilter:this.propsData.valueFilter,rows:this.propsData.rows,cols:this.propsData.cols,rendererName:I,aggregatorName:B,vals:t}),f=new Ps(e),l=Qe&&this.colLimit>0&&this.rowLimit>0&&(f.getColKeys().length>this.colLimit||f.getRowKeys().length>this.rowLimit),o=this.rendererCell(I,Je),u=this.aggregatorCell(B,t,Je),s=this.outputCell(e,I.indexOf("Chart")>-1,Je);return Je("table",{staticClass:["pvtUi"]},[Je("tbody",[Je("tr",[o,d]),Je("tr",[u,m]),Je("tr",[h,r?Je("td",{staticClass:"pvtOutput"},r):void 0,Qe&&l?Je("td",{staticClass:"pvtOutput"},Qe({pivotData:new Ps(e)})):void 0,!r&&!l&&s])])])}};const bv={aggregatorTemplates:bo,aggregators:uu,derivers:Xg,locales:qg,naturalSort:su,numberFormat:mf,getSort:yf,sortAs:Ad,PivotData:Ps},Xh={VuePivottable:_f,VuePivottableUi:s0};typeof window!="undefined"&&window.Vue&&window.Vue.use(_f);const _v=Je=>{for(const Qe in Xh)Je.component(Xh[Qe].name,Xh[Qe])};exports.PivotUtilities=bv;exports.VuePivottable=_f;exports.VuePivottableUi=s0;exports.addVueGlobalUse=_v;
